
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 29
DI Scenario: LD
Start Time: 2026-01-03 21:46:07
================================================================================
Loading data from data/DH_data_full_seed29.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.135', '1.289'] (k=0.313)
  Product 1: ['1.000', '1.084', '1.175'] (k=0.198)
  Product 2: ['1.000', '1.046', '1.095'] (k=0.112)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=950, max=1770
  DC capacity (MC): min=539, max=737

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.14, max=34.00, count=82
  Deviation (μ̂): min=4.00, max=9.92

Costs:
  Plant fixed cost: min=5193, max=8376
  DC fixed cost: min=3911, max=5831
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.318', '1.736'] (k=0.680)
    Product 1: ['1.000', '1.385', '1.918'] (k=0.803)
    Product 2: ['1.000', '1.419', '2.013'] (k=0.863)
  MD:
    Product 0: ['1.000', '1.293', '1.671'] (k=0.633)
    Product 1: ['1.000', '1.164', '1.354'] (k=0.374)
    Product 2: ['1.000', '1.171', '1.372'] (k=0.390)
  LD:
    Product 0: ['1.000', '1.135', '1.289'] (k=0.313)
    Product 1: ['1.000', '1.084', '1.175'] (k=0.198)
    Product 2: ['1.000', '1.046', '1.095'] (k=0.112)
  Mixed:
    Product 0: ['1.000', '1.318', '1.736'] (k=0.680)
    Product 1: ['1.000', '1.164', '1.354'] (k=0.374)
    Product 2: ['1.000', '1.046', '1.095'] (k=0.112)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0xf346acd2
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.08s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -301867.2051
Found heuristic solution: objective -189524.3450

Root relaxation: objective 6.541611e+04, 4854 iterations, 0.19 seconds (0.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 65416.1083    0  650 -189524.35 65416.1083   135%     -    0s
H    0     0                    -178318.9856 65416.1083   137%     -    0s
H    0     0                    -162818.7317 63345.2553   139%     -    0s
H    0     0                    -157417.0856 63345.2553   140%     -    0s
     0     0 63345.2553    0  875 -157417.09 63345.2553   140%     -    0s
     0     0 63238.0598    0  879 -157417.09 63238.0598   140%     -    0s
     0     0 63233.9091    0  883 -157417.09 63233.9091   140%     -    0s
     0     0 63233.7201    0  879 -157417.09 63233.7201   140%     -    0s
H    0     0                    -155736.8487 60526.4276   139%     -    1s
H    0     0                    -152568.4453 60526.4276   140%     -    1s
H    0     0                    -134767.7103 60526.4276   145%     -    1s
     0     0 60526.4276    0 1064 -134767.71 60526.4276   145%     -    1s
H    0     0                    -134339.0171 60524.5750   145%     -    1s
H    0     0                    -113086.9118 60358.2511   153%     -    2s
H    0     0                    -107685.2658 60358.2511   156%     -    2s
     0     0 60345.5052    0 1075 -107685.27 60345.5052   156%     -    2s
     0     0 60345.5052    0 1093 -107685.27 60345.5052   156%     -    2s
     0     0 59757.7282    0 1095 -107685.27 59757.7282   155%     -    2s
     0     0 59757.7282    0 1095 -107685.27 59757.7282   155%     -    2s
     0     0 57776.9187    0 1197 -107685.27 57776.9187   154%     -    3s
H    0     0                    -107603.8907 56627.6756   153%     -    3s
H    0     0                    -57717.27840 56627.6756   198%     -    3s
H    0     0                    -52277.78235 56627.6756   208%     -    3s
H    0     0                    -45183.36732 56627.6756   225%     -    3s
H    0     0                    -15270.14727 56627.6756   471%     -    3s
     0     0 56627.6756    0 1273 -15270.147 56627.6756   471%     -    3s
     0     0 56571.3941    0 1282 -15270.147 56571.3941   470%     -    3s
     0     0 56571.3941    0 1288 -15270.147 56571.3941   470%     -    3s
     0     0 56571.3941    0 1286 -15270.147 56571.3941   470%     -    3s
     0     0 55405.8643    0 1360 -15270.147 55405.8643   463%     -    5s
     0     0 55405.8643    0 1360 -15270.147 55405.8643   463%     -    5s
     0     2 55405.8643    0 1360 -15270.147 55405.8643   463%     -    6s
     7    16 54449.4977    3  999 -15270.147 55100.0214   461%  3470   10s
H   95   237                    -15202.04951 51195.7648   437%  2492   13s
H   99   237                    -15185.94480 51195.7648   437%  2431   13s
H  101   237                    -15034.85239 51195.7648   441%  2409   13s
H  101   237                    -14418.45020 51195.7648   455%  2409   13s
H  124   237                    -12681.78172 51195.7648   504%  2086   13s
   367   405 37714.7699   11  586 -12681.782 51195.7648   504%  1006   15s
H  379   405                    -7619.999216 51195.7648   772%   996   15s
H  382   405                    13281.472308 51195.7648   285%   995   15s
H  510   615                    13327.750066 51195.7648   284%   834   16s
H  529   615                    13559.662901 51195.7648   278%   817   16s
H  531   615                    13740.674882 51195.7648   273%   816   16s
H  552   615                    14084.481640 51195.7648   263%   807   16s
H  599   615                    14173.718545 51195.7648   261%   767   16s
H  720   751                    15916.820060 51195.7648   222%   686   17s
H  726   751                    15948.138143 51195.7648   221%   682   17s
H  745   751                    16034.072901 51195.7648   219%   675   17s
H  746   751                    16465.701485 51195.7648   211%   674   17s
H  750   751                    16902.301880 51195.7648   203%   671   17s
H  877   849                    16947.032574 48340.7773   185%   628   18s
H  891   849                    17266.619436 48340.7773   180%   627   18s
H  909   849                    17272.593411 47434.1972   175%   621   18s
H 1015   974                    17283.820445 46933.2706   172%   595   19s
H 1017   974                    17288.447994 46933.2706   171%   594   19s
H 1026   974                    17307.395331 46933.2706   171%   594   19s
  1178  1163 21458.6018   34  507 17307.3953 46462.4517   168%   560   20s
H 1445  1329                    17329.222558 46245.7341   167%   510   21s
H 1462  1329                    17392.750221 46245.7341   166%   509   21s
  2597  2078 30158.9829   27  576 17392.7502 45233.9898   160%   420   25s
H 2745  2154                    17513.603551 45065.2131   157%   419   26s
H 3015  2315                    17630.344203 44491.3537   152%   407   28s
H 3016  2310                    17808.722168 44491.3537   150%   407   28s
H 3102  2310                    17816.254892 44080.8423   147%   405   28s
  3998  2828 28076.2484    6 1360 17816.2549 43863.8539   146%   387   40s
  4018  2841 27511.8148   18  701 17816.2549 27511.8148  54.4%   385   45s
  4265  2932 19894.0549   24  396 17816.2549 24383.5856  36.9%   391   50s
H 4296  2779                    19879.655153 24188.5614  21.7%   390   50s
H 4618  2511                    20058.750703 24081.4332  20.1%   374   50s
H 4626  2380                    20318.262998 24081.4332  18.5%   374   50s
H 4647  2251                    20363.197834 24081.4332  18.3%   373   50s
H 4653  2133                    20412.010174 24081.4332  18.0%   372   50s
H 4663  2018                    20481.428328 24081.4332  17.6%   372   50s
H 4832  1858                    20481.985467 23593.5797  15.2%   361   51s
H 4841  1756                    20555.762527 23099.5859  12.4%   361   51s
H 4859  1655                    20563.866415 23099.5859  12.3%   360   51s
H 4882  1557                    20564.018726 23099.5859  12.3%   358   51s
H 5115  1490                    20990.439699 23099.5859  10.0%   343   51s
H 5446  1202                    21025.717907 23099.5859  9.86%   324   51s
H 5468  1056                    21025.745419 23099.5859  9.86%   322   51s
H 5482   978                    21026.044338 23099.5859  9.86%   322   51s
H 5488   906                    21034.967946 23099.5859  9.82%   321   51s
* 5736   724              64    21038.473968 22148.9154  5.28%   308   52s
* 5789   600              52    21040.744671 22148.9154  5.27%   306   52s
* 5813   532              57    21044.717742 22148.9035  5.25%   305   52s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 36
  MIR: 149
  Flow cover: 308
  RLT: 13
  Relax-and-lift: 91

Explored 5846 nodes (1793665 simplex iterations) in 52.30 seconds (116.33 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21044.7 21040.7 21038.5 ... 20563.9

Optimal solution found (tolerance 1.00e-06)
Best objective 2.104471774247e+04, best bound 2.104471774247e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 52.30s
  Master Objective (UB) = 21044.72, θ = 147271.41
  Upper Bound (UB) = 21044.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 147271.41
  [DEBUG]   ✓ Scenario 0: θ = 147271.41 ≤ Q = 147271.41 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x22cc53a5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x22cc53a5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.251128e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6482051.4105
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.180004e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118000.38    0  122 6482051.41 -118000.38   102%     -    0s
H    0     0                    -83152.72111 -118000.38  41.9%     -    0s
H    0     0                    -83825.94695 -118000.38  40.8%     -    0s
*    0     0               0    -86531.62091 -86531.621  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 204

Explored 1 nodes (386 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -86531.6 -83825.9 -83152.7 ... 1.25113e+13
No other solutions better than -86531.6

Optimal solution found (tolerance 1.00e-06)
Best objective -8.653162091471e+04, best bound -8.653162091471e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 112750.08
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -86531.62
  [DEBUG]   S×d_nominal = 199281.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 199281.70 + -86531.62 = 112750.08
  [DEBUG]   Current θ from Master = 147271.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34521.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13476.62
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 34521.3337, Absolute Gap = 34521.3337, Relative Gap = 1.640380
  Not converged yet (gap = 34521.33 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0x8385c309
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -13476.6 (0.01s)
MIP start from previous solve produced solution with objective -13476.6 (0.02s)
Loaded MIP start from previous solve with objective -13476.6

Presolve removed 13767 rows and 5586 columns
Presolve time: 0.32s
Presolved: 18196 rows, 9154 columns, 100768 nonzeros
Variable types: 6895 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.115667e+04, 9658 iterations, 1.02 seconds (2.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21156.6695    0  287 -13476.616 21156.6695   257%     -    1s
H    0     0                    -12804.74412 21156.6695   265%     -    1s
H    0     0                    -11798.95597 21156.6695   279%     -    1s
     0     0 15270.8104    0  439 -11798.956 15270.8104   229%     -    2s
H    0     0                    -11673.36614 15269.8890   231%     -    2s
H    0     0                    -11672.46092 15269.8890   231%     -    2s
H    0     0                    -11371.19670 15269.8890   234%     -    2s
     0     0 15029.3305    0  450 -11371.197 15029.3305   232%     -    2s
     0     0 15029.1873    0  450 -11371.197 15029.1873   232%     -    2s
     0     0 9281.82344    0  674 -11371.197 9281.82344   182%     -    4s
H    0     0                    -11367.56064 9278.18305   182%     -    4s
H    0     0                    -11304.70428 9278.18305   182%     -    4s
H    0     0                    -11300.81135 9278.18305   182%     -    4s
     0     0 8913.55586    0  695 -11300.811 8913.55586   179%     -    5s
     0     0 8875.84045    0  686 -11300.811 8875.84045   179%     -    5s
     0     0 8861.96966    0  693 -11300.811 8861.96966   178%     -    5s
     0     0 8861.56405    0  699 -11300.811 8861.56405   178%     -    5s
     0     0 5674.75728    0  709 -11300.811 5674.75728   150%     -    7s
H    0     0                    -11276.70177 5670.30152   150%     -    8s
     0     0 5368.38848    0  639 -11276.702 5368.38848   148%     -    8s
     0     0 5286.02860    0  663 -11276.702 5286.02860   147%     -    8s
     0     0 5281.71604    0  663 -11276.702 5281.71604   147%     -    8s
     0     0 5281.52655    0  654 -11276.702 5281.52655   147%     -    8s
     0     0 3525.50598    0  367 -11276.702 3525.50598   131%     -   11s
H    0     0                    -11098.60349 3196.35813   129%     -   12s
H    0     0                    -11081.04708 3196.35813   129%     -   12s
H    0     0                    -11039.98965 3196.35813   129%     -   12s
     0     0 3196.35813    0  495 -11039.990 3196.35813   129%     -   12s
     0     0 3111.83789    0  516 -11039.990 3111.83789   128%     -   13s
     0     0 3094.81698    0  616 -11039.990 3094.81698   128%     -   13s
     0     0 3088.01490    0  517 -11039.990 3088.01490   128%     -   13s
     0     0 3086.82368    0  709 -11039.990 3086.82368   128%     -   13s
H    0     0                    -11030.41920 2265.41609   121%     -   15s
H    0     0                    -10904.18308 2265.41609   121%     -   15s
     0     0 2265.41609    0  746 -10904.183 2265.41609   121%     -   15s
H    0     0                    -10573.20845 2265.24886   121%     -   15s
H    0     0                    -10463.49258 2265.24886   122%     -   15s
H    0     0                    -10428.07522 2265.24886   122%     -   15s
     0     0 2005.48841    0  562 -10428.075 2005.48841   119%     -   16s
     0     0 1925.38373    0  592 -10428.075 1925.38373   118%     -   17s
     0     0 1871.91040    0  820 -10428.075 1871.91040   118%     -   17s
     0     0 1855.17076    0  844 -10428.075 1855.17076   118%     -   17s
     0     0 1853.70267    0  855 -10428.075 1853.70267   118%     -   18s
     0     0 1432.56860    0  576 -10428.075 1432.56860   114%     -   19s
H    0     0                    -10394.72360 1431.92546   114%     -   20s
     0     0 1320.82229    0  566 -10394.724 1320.82229   113%     -   20s
     0     0 1275.19523    0  582 -10394.724 1275.19523   112%     -   21s
     0     0 1271.44104    0  586 -10394.724 1271.44104   112%     -   21s
     0     0  959.00063    0  565 -10394.724  959.00063   109%     -   22s
H    0     0                    -10355.66703  958.57091   109%     -   22s
H    0     0                    -10283.09602  958.57091   109%     -   22s
H    0     0                    -10267.61667  958.57091   109%     -   22s
H    0     0                    -10236.19954  958.57091   109%     -   22s
H    0     0                    -10225.70034  958.57091   109%     -   22s
     0     0  908.72974    0  673 -10225.700  908.72974   109%     -   23s
     0     0  876.46049    0  589 -10225.700  876.46049   109%     -   23s
     0     0  871.39162    0  585 -10225.700  871.39162   109%     -   23s
     0     0  705.73313    0  833 -10225.700  705.73313   107%     -   25s
H    0     0                    -10218.21984  704.32708   107%     -   25s
H    0     0                    -10217.52514  704.32708   107%     -   25s
H    0     0                    -10214.80714  704.32708   107%     -   25s
     0     0  679.49371    0  478 -10214.807  679.49371   107%     -   25s
     0     0  670.57860    0  470 -10214.807  670.57860   107%     -   25s
     0     0  668.50611    0  474 -10214.807  668.50611   107%     -   25s
     0     0  606.51994    0  650 -10214.807  606.51994   106%     -   26s
     0     0  596.17879    0  745 -10214.807  596.17879   106%     -   27s
     0     0  584.41497    0  843 -10214.807  584.41497   106%     -   27s
     0     0  582.33665    0  745 -10214.807  582.33665   106%     -   27s
H    0     0                    -9682.443087  410.04600   104%     -   28s
H    0     0                    -9610.270015  410.04600   104%     -   28s
     0     0  410.04600    0  645 -9610.2700  410.04600   104%     -   28s
H    0     0                    -9597.684467  408.12281   104%     -   29s
H    0     0                    -9585.515837  408.12281   104%     -   29s
H    0     0                    -9517.873720  408.12281   104%     -   29s
     0     0  357.30204    0  646 -9517.8737  357.30204   104%     -   30s
     0     0  336.30612    0  654 -9517.8737  336.30612   104%     -   30s
     0     0  323.56493    0  655 -9517.8737  323.56493   103%     -   30s
     0     0  321.07023    0  660 -9517.8737  321.07023   103%     -   30s
     0     0  267.62010    0  499 -9517.8737  267.62010   103%     -   31s
     0     0  255.71829    0  493 -9517.8737  255.71829   103%     -   31s
     0     0  249.23977    0  488 -9517.8737  249.23977   103%     -   32s
     0     0  216.30549    0  499 -9517.8737  216.30549   102%     -   32s
     0     0  207.37541    0  667 -9517.8737  207.37541   102%     -   33s
     0     0  205.39665    0  677 -9517.8737  205.39665   102%     -   33s
     0     0  184.94253    0  488 -9517.8737  184.94253   102%     -   33s
     0     0  181.64046    0  488 -9517.8737  181.64046   102%     -   34s
H    0     0                    -9487.971031  179.39465   102%     -   36s
H    0     0                    -9483.788423  179.39465   102%     -   38s
H    0     0                    -9355.777090  179.39465   102%     -   38s
H    0     2                    -9075.583121  179.39465   102%     -   38s
     0     2  179.39465    0  488 -9075.5831  179.39465   102%     -   38s
     3     8  -36.18413    2  734 -9075.5831   51.49124   101%  1131   40s
    31    64 -625.22425    5  600 -9075.5831 -350.87839  96.1%  2002   45s
H   33    64                    -8949.794377 -350.87839  96.1%  1926   45s
H   51    64                    -8860.233681 -556.54634  93.7%  1615   45s
H  101   127                    -8828.805283 -556.54634  93.7%  1491   49s
H  113   127                    -8820.585349 -556.54634  93.7%  1447   49s
   134   211 -1973.6193    8  508 -8820.5853 -556.54634  93.7%  1355   51s
H  358   296                    -8812.050302 -1110.8324  87.4%   766   53s
H  389   296                    -8810.037417 -1110.8324  87.4%   757   53s
   582   413 -5471.6393   12  332 -8810.0374 -1691.6254  80.8%   617   55s
H  826   457                    -8677.420146 -1779.1915  79.5%   576   58s
  1076   528 -5651.7573    9  205 -8677.4201 -2936.6561  66.2%   533   60s
H 1082   528                    -8250.704313 -2936.6561  64.4%   531   60s
H 1147   528                    -8245.901868 -2936.6561  64.4%   517   60s
H 1410   573                    -8243.932194 -3072.4698  62.7%   486   64s
H 1459   573                    -8239.096925 -3072.4698  62.7%   478   64s
  1470   590 -7185.9435   19  200 -8239.0969 -3072.4698  62.7%   479   65s
  2537   751 infeasible   36      -8239.0969 -4943.9079  40.0%   383   70s
  4162   412 infeasible   12      -8239.0969 -6647.8240  19.3%   344   75s
* 5194     0              26    -8235.680110 -7472.9549  9.26%   305   76s

Cutting planes:
  Learned: 3
  Gomory: 6
  MIR: 1980
  Flow cover: 1205
  RLT: 29
  Relax-and-lift: 429

Explored 5238 nodes (1644945 simplex iterations) in 76.50 seconds (172.30 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8235.68 -8239.1 -8243.93 ... -8828.81
No other solutions better than -8235.68

Optimal solution found (tolerance 1.00e-06)
Best objective -8.235680109992e+03, best bound -8.235680109992e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 76.51s
  Master Objective (UB) = -8235.68, θ = 114112.23
  Upper Bound (UB) = -8235.68

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 114112.23
  [DEBUG]   ✓ Scenario 0: θ = 114112.23 ≤ Q = 114112.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 114112.23 ≤ Q = 114112.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x19cd19df
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe632e621
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.191150e+13
Presolve removed 2590 rows and 1883 columns
Presolve time: 0.00s
Presolved: 503 rows, 506 columns, 1418 nonzeros
Found heuristic solution: objective 6100899.6449
Variable types: 342 continuous, 164 integer (164 binary)

Root relaxation: objective -1.241423e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124142.31    0  130 6100899.64 -124142.31   102%     -    0s
H    0     0                    -89524.05755 -124142.31  38.7%     -    0s
H    0     0                    -90595.69261 -124142.31  37.0%     -    0s
H    0     0                    -100250.7479 -124142.31  23.8%     -    0s
H    0     0                    -109395.8319 -124142.31  13.5%     -    0s
H    0     0                    -114894.5620 -116622.92  1.50%     -    0s
     0     0 -116622.92    0   88 -114894.56 -116622.92  1.50%     -    0s
     0     0 -116386.69    0   87 -114894.56 -116386.69  1.30%     -    0s
     0     0 -115969.66    0   40 -114894.56 -115969.66  0.94%     -    0s
H    0     0                    -115743.8135 -115965.76  0.19%     -    0s
     0     0 -115903.90    0   24 -115743.81 -115903.90  0.14%     -    0s
     0     0 -115885.89    0   21 -115743.81 -115885.89  0.12%     -    0s
     0     0 -115874.70    0   22 -115743.81 -115874.70  0.11%     -    0s
H    0     0                    -115755.9962 -115874.70  0.10%     -    0s
     0     0 -115848.29    0   13 -115756.00 -115848.29  0.08%     -    0s
     0     0 -115835.09    0   11 -115756.00 -115835.09  0.07%     -    0s
H    0     0                    -115786.0803 -115835.09  0.04%     -    0s
     0     0 -115804.76    0    6 -115786.08 -115804.76  0.02%     -    0s
H    0     0                    -115798.2629 -115800.92  0.00%     -    0s
     0     0 -115798.85    0    2 -115798.26 -115798.85  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 3
  MIR: 3
  Flow cover: 8
  Relax-and-lift: 2

Explored 1 nodes (725 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -115798 -115786 -115756 ... -89524.1
No other solutions better than -115798

Optimal solution found (tolerance 1.00e-06)
Best objective -1.157982629448e+05, best bound -1.157982629448e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 89173.37
  Scenario: 45 demand increases, 15 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115798.26
  [DEBUG]   S×d_nominal = 204971.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204971.63 + -115798.26 = 89173.37
  [DEBUG]   Current θ from Master = 114112.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24938.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33174.54
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 5240.9359, Absolute Gap = 5240.9359, Relative Gap = 0.636370
  Not converged yet (gap = 5240.94 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 15 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0xafca7df5
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -33174.5 (0.02s)
Loaded MIP start from previous solve with objective -33174.5

Presolve removed 20624 rows and 8374 columns
Presolve time: 0.42s
Presolved: 26629 rows, 12606 columns, 163799 nonzeros
Variable types: 10347 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29109    7.3277136e+03   0.000000e+00   4.607174e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19055    8.5352064e+03   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 8.535206e+03, 19055 iterations, 4.93 seconds (9.84 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8535.20641    0  218 -33174.539 8535.20641   126%     -    5s
H    0     0                    -31257.65933 8535.20641   127%     -    5s
H    0     0                    -15103.90992 8535.20641   157%     -    5s
H    0     0                    -14514.80389 8535.20641   159%     -    5s
H    0     0                    -14356.77026 8535.20641   159%     -    5s
H    0     0                    -14350.64980 8535.20641   159%     -    5s
H    0     0                    -14022.66284 8535.20641   161%     -    5s
H    0     0                    -13939.55948 8535.20641   161%     -    5s
     0     0 4634.18860    0  417 -13939.559 4634.18860   133%     -    8s
     0     0 4521.14704    0  424 -13939.559 4521.14704   132%     -    9s
     0     0 4520.05334    0  422 -13939.559 4520.05334   132%     -    9s
     0     0 4519.94633    0  424 -13939.559 4519.94633   132%     -    9s
H    0     0                    -13938.06611 2089.09669   115%     -   12s
H    0     0                    -13936.89043 2089.09669   115%     -   12s
H    0     0                    -13932.14856 2089.09669   115%     -   12s
H    0     0                    -11563.48688 2089.09669   118%     -   12s
H    0     0                    -10781.87236 2089.09669   119%     -   12s
H    0     0                    -10781.46057 2089.09669   119%     -   12s
     0     0 2089.09669    0  454 -10781.461 2089.09669   119%     -   12s
H    0     0                    -10487.68657 2088.98909   120%     -   12s
H    0     0                    -10326.26909 2088.98909   120%     -   12s
     0     0 1538.52887    0  477 -10326.269 1538.52887   115%     -   14s
     0     0 1435.55756    0  469 -10326.269 1435.55756   114%     -   14s
     0     0 1415.02547    0  481 -10326.269 1415.02547   114%     -   15s
     0     0 1410.54693    0  481 -10326.269 1410.54693   114%     -   15s
     0     0 1410.50151    0  481 -10326.269 1410.50151   114%     -   15s
     0     0  236.45862    0  492 -10326.269  236.45862   102%     -   18s
H    0     0                    -10113.67727  235.94928   102%     -   18s
H    0     0                    -10031.15272  235.94928   102%     -   18s
H    0     0                    -9960.051826  235.94928   102%     -   18s
H    0     0                    -9955.835452  235.94928   102%     -   18s
H    0     0                    -9929.792930  235.94928   102%     -   18s
H    0     0                    -9928.074173  235.94928   102%     -   18s
     0     0   64.26282    0  500 -9928.0742   64.26282   101%     -   19s
     0     0  -51.34701    0  497 -9928.0742  -51.34701  99.5%     -   19s
     0     0 -104.01149    0  516 -9928.0742 -104.01149  99.0%     -   20s
     0     0 -111.42752    0  523 -9928.0742 -111.42752  98.9%     -   20s
     0     0 -113.63170    0  521 -9928.0742 -113.63170  98.9%     -   20s
H    0     0                    -9906.698095 -134.01831  98.6%     -   20s
H    0     0                    -9906.109920 -134.01831  98.6%     -   20s
     0     0 -134.01831    0  526 -9906.1099 -134.01831  98.6%     -   20s
     0     0 -134.22461    0  526 -9906.1099 -134.22461  98.6%     -   20s
H    0     0                    -9891.843271 -134.22461  98.6%     -   22s
     0     0 -814.34524    0  553 -9891.8433 -814.34524  91.8%     -   24s
     0     0 -986.35570    0  565 -9891.8433 -986.35570  90.0%     -   25s
     0     0 -1043.4217    0  559 -9891.8433 -1043.4217  89.5%     -   26s
     0     0 -1091.7481    0  560 -9891.8433 -1091.7481  89.0%     -   26s
     0     0 -1112.1907    0  567 -9891.8433 -1112.1907  88.8%     -   26s
     0     0 -1126.6452    0  576 -9891.8433 -1126.6452  88.6%     -   26s
     0     0 -1128.1525    0  577 -9891.8433 -1128.1525  88.6%     -   26s
     0     0 -1136.5366    0  580 -9891.8433 -1136.5366  88.5%     -   27s
     0     0 -1136.7377    0  578 -9891.8433 -1136.7377  88.5%     -   27s
     0     0 -1298.0106    0  570 -9891.8433 -1298.0106  86.9%     -   28s
H    0     0                    -9883.598118 -1298.8182  86.9%     -   28s
     0     0 -1327.3553    0  589 -9883.5981 -1327.3553  86.6%     -   28s
     0     0 -1334.2507    0  583 -9883.5981 -1334.2507  86.5%     -   29s
     0     0 -1338.2645    0  586 -9883.5981 -1338.2645  86.5%     -   29s
     0     0 -1338.4114    0  585 -9883.5981 -1338.4114  86.5%     -   29s
     0     0 -1426.1829    0  586 -9883.5981 -1426.1829  85.6%     -   30s
     0     0 -1440.6905    0  594 -9883.5981 -1440.6905  85.4%     -   30s
     0     0 -1450.5205    0  598 -9883.5981 -1450.5205  85.3%     -   31s
     0     0 -1453.1084    0  596 -9883.5981 -1453.1084  85.3%     -   31s
     0     0 -1454.1738    0  595 -9883.5981 -1454.1738  85.3%     -   31s
     0     0 -1534.9049    0  568 -9883.5981 -1534.9049  84.5%     -   32s
     0     0 -1547.3380    0  582 -9883.5981 -1547.3380  84.3%     -   32s
     0     0 -1556.4833    0  596 -9883.5981 -1556.4833  84.3%     -   33s
     0     0 -1557.9990    0  593 -9883.5981 -1557.9990  84.2%     -   33s
     0     0 -1560.1835    0  599 -9883.5981 -1560.1835  84.2%     -   33s
     0     0 -1561.3525    0  607 -9883.5981 -1561.3525  84.2%     -   33s
     0     0 -1601.9765    0  586 -9883.5981 -1601.9765  83.8%     -   34s
H    0     0                    -9882.435090 -1602.1197  83.8%     -   34s
H    0     0                    -9873.406531 -1602.1197  83.8%     -   34s
     0     0 -1608.0503    0  589 -9873.4065 -1608.0503  83.7%     -   34s
     0     0 -1612.9055    0  593 -9873.4065 -1612.9055  83.7%     -   34s
     0     0 -1613.7378    0  590 -9873.4065 -1613.7378  83.7%     -   35s
     0     0 -1628.2510    0  593 -9873.4065 -1628.2510  83.5%     -   35s
     0     0 -1633.3393    0  599 -9873.4065 -1633.3393  83.5%     -   36s
     0     0 -1636.0687    0  592 -9873.4065 -1636.0687  83.4%     -   36s
     0     0 -1636.9932    0  592 -9873.4065 -1636.9932  83.4%     -   36s
     0     0 -1640.4329    0  597 -9873.4065 -1640.4329  83.4%     -   36s
     0     0 -1641.9894    0  603 -9873.4065 -1641.9894  83.4%     -   37s
     0     0 -1642.3976    0  604 -9873.4065 -1642.3976  83.4%     -   37s
     0     0 -1649.3627    0  599 -9873.4065 -1649.3627  83.3%     -   37s
     0     0 -1651.5684    0  597 -9873.4065 -1651.5684  83.3%     -   38s
     0     0 -1652.4346    0  602 -9873.4065 -1652.4346  83.3%     -   38s
     0     0 -1654.3509    0  601 -9873.4065 -1654.3509  83.2%     -   38s
     0     0 -1654.5026    0  601 -9873.4065 -1654.5026  83.2%     -   39s
H    0     0                    -9840.131426 -1654.5144  83.2%     -   44s
H    0     0                    -9836.217772 -1654.5144  83.2%     -   44s
H    0     0                    -9833.730365 -1654.5144  83.2%     -   44s
H    0     0                    -9827.682725 -1654.5144  83.2%     -   44s
H    0     2                    -9823.559422 -1654.5144  83.2%     -   48s
     0     2 -1654.5144    0  601 -9823.5594 -1654.5144  83.2%     -   48s
     3     8 -1941.7014    2  575 -9823.5594 -1840.4431  81.3%  1469   50s
    31    64 -2579.1941    5  585 -9823.5594 -2335.4306  76.2%  2972   55s
   259   266 -3445.3421    9  571 -9823.5594 -2580.9292  73.7%  1048   61s
H  278   266                    -9819.096814 -2580.9292  73.7%  1055   61s
H  283   266                    -9810.647072 -2580.9292  73.7%  1051   61s
   364   338 -4040.9222   10  475 -9810.6471 -3207.4141  67.3%  1037   67s
   475   425 -4021.6323   11  541 -9810.6471 -3207.4141  67.3%  1057   71s
   565   480 -8064.2493   12  522 -9810.6471 -3207.4141  67.3%  1051   77s
   605   511 -6181.8934   13  540 -9810.6471 -3236.1892  67.0%  1053   80s
   746   580 -6819.8692   14  427 -9810.6471 -3236.1892  67.0%  1074   86s
   850   630 -7121.5760   15  276 -9810.6471 -3402.0065  65.3%  1089   90s
   948   674 -7470.5086   16  523 -9810.6471 -3418.0493  65.2%  1090   96s
  1057   724 -8087.0387   17  480 -9810.6471 -3613.0218  63.2%  1107  101s
  1163   761 -9666.4931   19  452 -9810.6471 -3613.0218  63.2%  1122  107s
  1271   825 -4462.7947    7  431 -9810.6471 -3613.0218  63.2%  1129  113s
  1340   847 -5271.5829    9  407 -9810.6471 -3667.3800  62.6%  1122  117s
  1426   868 -6295.5373   12  281 -9810.6471 -3680.6006  62.5%  1123  120s
  1512   901 -6649.0703   14  202 -9810.6471 -3772.8909  61.5%  1122  126s
  1696   937 -8571.2831   16   92 -9810.6471 -3772.8909  61.5%  1109  132s
  1824   944 infeasible   21      -9810.6471 -3772.8909  61.5%  1083  135s
  2080  1004 infeasible   17      -9810.6471 -3772.8909  61.5%  1062  142s
  2125  1020 -7300.6446   17  193 -9810.6471 -3772.8909  61.5%  1065  145s
  2272  1078 -8563.3390   20  492 -9810.6471 -4037.9052  58.8%  1064  154s
  2426  1121 -9051.3425   22  317 -9810.6471 -4037.9052  58.8%  1056  159s
  2568  1146 infeasible   23      -9810.6471 -4309.9178  56.1%  1053  164s
  2711  1220 -7807.1054    9  383 -9810.6471 -4332.5635  55.8%  1053  168s
  2865  1261 -9206.1411   12  245 -9810.6471 -4359.6144  55.6%  1051  172s
  3041  1296 -7727.2764   15  456 -9810.6471 -4359.6144  55.6%  1049  176s
  3213  1317     cutoff   17      -9810.6471 -4359.6144  55.6%  1044  181s
  3399  1371     cutoff   20      -9810.6471 -4545.1781  53.7%  1038  186s
  3567  1396 -7802.7932    8  448 -9810.6471 -4667.8918  52.4%  1044  191s
  3748  1417     cutoff   11      -9810.6471 -4667.8918  52.4%  1046  196s
  3855  1470 -9365.2822   11  361 -9810.6471 -4780.8684  51.3%  1052  200s
  4009  1467 -6546.1436   12  331 -9810.6471 -4780.8684  51.3%  1058  205s
  4257  1498 -8554.7311   14  238 -9810.6471 -4780.8684  51.3%  1051  210s
  4471  1538 -8537.5234   11  377 -9810.6471 -4865.5857  50.4%  1053  215s
  4779  1572 -9152.7305   12  276 -9810.6471 -4954.2731  49.5%  1046  222s
  4838  1579     cutoff   13      -9810.6471 -5007.4868  49.0%  1046  227s
  4925  1605 infeasible   13      -9810.6471 -5007.4868  49.0%  1040  233s
  5087  1639 -8910.8801   12  289 -9810.6471 -5082.2491  48.2%  1034  237s
  5327  1682 -6969.1509   12  316 -9810.6471 -5082.2491  48.2%  1029  243s
  5609  1704     cutoff   15      -9810.6471 -5098.3265  48.0%  1022  248s
  5734  1750 -9115.3287   15  277 -9810.6471 -5098.3265  48.0%  1020  253s
  6047  1782 -8705.6016   12  271 -9810.6471 -5220.5577  46.8%  1015  261s
  6369  1798 -8884.0666   14  400 -9810.6471 -5418.1714  44.8%  1015  267s
  6713  1832 -6416.9448   14  427 -9810.6471 -5483.7285  44.1%  1015  273s
  7049  1847 -9456.3523   17  258 -9810.6471 -5614.3381  42.8%  1014  281s
  7438  1870 infeasible   12      -9810.6471 -5680.4201  42.1%  1011  288s
  7914  1888 -9751.5816   22  398 -9810.6471 -5878.3707  40.1%  1000  297s
  8271  1889     cutoff   11      -9810.6471 -5960.3220  39.2%   999  304s
  8741  1900     cutoff   15      -9810.6471 -6021.7298  38.6%   992  312s
  9264  1877     cutoff   14      -9810.6471 -6229.0074  36.5%   983  320s
  9615  1851     cutoff   14      -9810.6471 -6271.5116  36.1%   983  328s
 10168  1808 -8638.7569   16  356 -9810.6471 -6366.9804  35.1%   975  336s
 10630  1727     cutoff   20      -9810.6471 -6597.0280  32.8%   977  345s
 11156  1630     cutoff   17      -9810.6471 -6755.2832  31.1%   977  356s
 11674  1535     cutoff   18      -9810.6471 -6907.6679  29.6%   979  365s
 12257  1374     cutoff   19      -9810.6471 -7099.9659  27.6%   976  375s
 12887  1111 -8799.3234   15  296 -9810.6471 -7370.9801  24.9%   973  386s
 13642   770 -8871.4118   13  418 -9810.6471 -7705.3023  21.5%   963  396s
 14476   688 infeasible   23      -9810.6471 -8040.7128  18.0%   950  405s
 14690    91     cutoff   12      -9810.6471 -8040.7128  18.0%   949  415s

Cutting planes:
  Implied bound: 9
  MIR: 432
  Flow cover: 839
  RLT: 34
  Relax-and-lift: 71

Explored 15980 nodes (14428471 simplex iterations) in 416.07 seconds (1307.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -9810.65 -9819.1 -9823.56 ... -9883.6
No other solutions better than -9810.65

Optimal solution found (tolerance 1.00e-06)
Best objective -9.810647071833e+03, best bound -9.810647071833e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 416.16s
  Master Objective (UB) = -9810.65, θ = 112217.89
  Upper Bound (UB) = -9810.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112217.89
  [DEBUG]   ✓ Scenario 0: θ = 112217.89 ≤ Q = 112217.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112217.89 ≤ Q = 112217.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112217.89 ≤ Q = 112217.89 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4132314
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x04132314
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.182094e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 5917674.4511
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.276226e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127622.62    0  129 5917674.45 -127622.62   102%     -    0s
H    0     0                    -94752.64942 -127622.62  34.7%     -    0s
H    0     0                    -95869.17770 -127622.62  33.1%     -    0s
H    0     0                    -103314.7164 -111448.02  7.87%     -    0s
H    0     0                    -105999.7395 -111448.02  5.14%     -    0s
     0     0 -111448.02    0   84 -105999.74 -111448.02  5.14%     -    0s
H    0     0                    -108873.0445 -111401.67  2.32%     -    0s
H    0     0                    -109225.5380 -111401.67  1.99%     -    0s
H    0     0                    -109995.5776 -111401.67  1.28%     -    0s
H    0     0                    -110348.0711 -111401.67  0.95%     -    0s
     0     0 -111351.17    0   84 -110348.07 -111351.17  0.91%     -    0s
     0     0 -111348.03    0   84 -110348.07 -111348.03  0.91%     -    0s
     0     0 -110711.91    0   32 -110348.07 -110711.91  0.33%     -    0s
     0     0 -110684.87    0   28 -110348.07 -110684.87  0.31%     -    0s
     0     0 -110684.80    0   27 -110348.07 -110684.80  0.31%     -    0s
H    0     0                    -110385.2828 -110654.21  0.24%     -    0s
     0     0 -110654.21    0   25 -110385.28 -110654.21  0.24%     -    0s
     0     0 -110654.21    0   24 -110385.28 -110654.21  0.24%     -    0s
     0     0 -110654.21    0   24 -110385.28 -110654.21  0.24%     -    0s
     0     0 -110529.58    0   21 -110385.28 -110529.58  0.13%     -    0s
     0     0 -110529.58    0   19 -110385.28 -110529.58  0.13%     -    0s
H    0     0                    -110426.4766 -110529.58  0.09%     -    0s
     0     0 -110460.58    0    6 -110426.48 -110460.58  0.03%     -    0s
H    0     0                    -110428.7463 -110459.56  0.03%     -    0s
H    0     0                    -110435.7096 -110459.56  0.02%     -    0s
     0     0 -110437.64    0    3 -110435.71 -110437.64  0.00%     -    0s
H    0     0                    -110435.8141 -110437.64  0.00%     -    0s
     0     0 -110436.27    0    1 -110435.81 -110436.27  0.00%     -    0s
     0     0 -110436.08    0    1 -110435.81 -110436.08  0.00%     -    0s
     0     2 -110436.08    0    1 -110435.81 -110436.08  0.00%     -    0s

Explored 3 nodes (780 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -110436 -110436 -110429 ... -103315
No other solutions better than -110436

Optimal solution found (tolerance 1.00e-06)
Best objective -1.104358141197e+05, best bound -1.104358141197e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 94137.43
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110435.81
  [DEBUG]   S×d_nominal = 204573.24
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204573.24 + -110435.81 = 94137.43
  [DEBUG]   Current θ from Master = 112217.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18080.47 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27891.11
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3665.9689, Absolute Gap = 3665.9689, Relative Gap = 0.373672
  Not converged yet (gap = 3665.97 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0x56d534cb
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -27891.1 (0.03s)
MIP start from previous solve produced solution with objective -27891.1 (0.03s)
Loaded MIP start from previous solve with objective -27891.1

Presolve removed 27492 rows and 11162 columns
Presolve time: 0.57s
Presolved: 35051 rows, 16058 columns, 216579 nonzeros
Variable types: 13799 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35051 rows, 16058 columns, 216579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41078   -3.5000723e+03   0.000000e+00   5.407909e+06      5s
Concurrent spin time: 0.52s

Solved with dual simplex

Root relaxation: objective 8.430570e+03, 25679 iterations, 8.34 seconds (16.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8430.57015    0  229 -27891.112 8430.57015   130%     -    9s
H    0     0                    -26697.51719 8430.57015   132%     -    9s
H    0     0                    -14605.66523 8430.57015   158%     -    9s
H    0     0                    -13238.17083 8430.57015   164%     -    9s
H    0     0                    -10440.29157 8430.57015   181%     -    9s
H    0     0                    -10156.62998 8430.57015   183%     -    9s
H    0     0                    -10136.89832 8430.57015   183%     -    9s
H    0     0                    -10087.05737 8430.57015   184%     -    9s
H    0     0                    -9898.950766 8430.57015   185%     -    9s
H    0     0                    -9898.277492 8430.57015   185%     -    9s
H    0     0                    -9896.931838 8430.57015   185%     -    9s
H    0     0                    -9880.365635 8430.57015   185%     -   10s
     0     0 4672.37261    0  417 -9880.3656 4672.37261   147%     -   14s
     0     0 4506.45015    0  425 -9880.3656 4506.45015   146%     -   17s
     0     0 4506.45015    0  432 -9880.3656 4506.45015   146%     -   18s
     0     0 4506.45015    0  429 -9880.3656 4506.45015   146%     -   18s
     0     0 4506.45015    0  429 -9880.3656 4506.45015   146%     -   18s
     0     0 1982.72437    0  466 -9880.3656 1982.72437   120%     -   24s
     0     0 1426.65348    0  460 -9880.3656 1426.65348   114%     -   27s
     0     0 1364.84003    0  472 -9880.3656 1364.84003   114%     -   27s
     0     0 1313.24299    0  476 -9880.3656 1313.24299   113%     -   28s
     0     0 1291.42259    0  493 -9880.3656 1291.42259   113%     -   29s
     0     0 1290.61070    0  494 -9880.3656 1290.61070   113%     -   29s
     0     0 1284.47755    0  489 -9880.3656 1284.47755   113%     -   29s
     0     0 1284.14845    0  500 -9880.3656 1284.14845   113%     -   29s
     0     0  243.65537    0  443 -9880.3656  243.65537   102%     -   37s
     0     0  131.29021    0  438 -9880.3656  131.29021   101%     -   38s
     0     0  -11.71114    0  452 -9880.3656  -11.71114   100%     -   40s
     0     0  -38.59579    0  466 -9880.3656  -38.59579   100%     -   40s
     0     0  -60.03512    0  464 -9880.3656  -60.03512  99.4%     -   41s
     0     0  -64.20607    0  458 -9880.3656  -64.20607  99.4%     -   41s
     0     0  -64.91220    0  461 -9880.3656  -64.91220  99.3%     -   41s
     0     0 -624.67515    0  457 -9880.3656 -624.67515  93.7%     -   49s
     0     0 -835.35136    0  534 -9880.3656 -835.35136  91.5%     -   50s
     0     0 -1002.1465    0  515 -9880.3656 -1002.1465  89.9%     -   52s
     0     0 -1056.6298    0  520 -9880.3656 -1056.6298  89.3%     -   53s
     0     0 -1086.2701    0  521 -9880.3656 -1086.2701  89.0%     -   54s
     0     0 -1098.7433    0  526 -9880.3656 -1098.7433  88.9%     -   54s
     0     0 -1106.2813    0  526 -9880.3656 -1106.2813  88.8%     -   55s
     0     0 -1110.2225    0  530 -9880.3656 -1110.2225  88.8%     -   55s
     0     0 -1111.4711    0  533 -9880.3656 -1111.4711  88.8%     -   55s
     0     0 -1111.6858    0  536 -9880.3656 -1111.6858  88.7%     -   55s
     0     0 -1234.1793    0  487 -9880.3656 -1234.1793  87.5%     -   57s
     0     0 -1262.2331    0  487 -9880.3656 -1262.2331  87.2%     -   58s
     0     0 -1286.1663    0  483 -9880.3656 -1286.1663  87.0%     -   59s
     0     0 -1289.2831    0  484 -9880.3656 -1289.2831  87.0%     -   59s
     0     0 -1290.6609    0  489 -9880.3656 -1290.6609  86.9%     -   59s
     0     0 -1290.8938    0  491 -9880.3656 -1290.8938  86.9%     -   59s
     0     0 -1336.8109    0  559 -9880.3656 -1336.8109  86.5%     -   60s
     0     0 -1347.0672    0  496 -9880.3656 -1347.0672  86.4%     -   62s
     0     0 -1352.7978    0  560 -9880.3656 -1352.7978  86.3%     -   62s
     0     0 -1354.1379    0  570 -9880.3656 -1354.1379  86.3%     -   63s
     0     0 -1390.0642    0  487 -9880.3656 -1390.0642  85.9%     -   64s
     0     0 -1397.9117    0  576 -9880.3656 -1397.9117  85.9%     -   64s
     0     0 -1399.7939    0  504 -9880.3656 -1399.7939  85.8%     -   65s
     0     0 -1401.9368    0  503 -9880.3656 -1401.9368  85.8%     -   65s
     0     0 -1403.7877    0  496 -9880.3656 -1403.7877  85.8%     -   65s
     0     0 -1404.2381    0  503 -9880.3656 -1404.2381  85.8%     -   65s
     0     0 -1414.5823    0  505 -9880.3656 -1414.5823  85.7%     -   66s
     0     0 -1418.4457    0  502 -9880.3656 -1418.4457  85.6%     -   68s
     0     0 -1419.1234    0  504 -9880.3656 -1419.1234  85.6%     -   68s
     0     0 -1427.0197    0  557 -9880.3656 -1427.0197  85.6%     -   68s
     0     0 -1429.4985    0  579 -9880.3656 -1429.4985  85.5%     -   69s
     0     0 -1430.6890    0  581 -9880.3656 -1430.6890  85.5%     -   69s
     0     0 -1444.9035    0  510 -9880.3656 -1444.9035  85.4%     -   70s
     0     0 -1448.2454    0  499 -9880.3656 -1448.2454  85.3%     -   70s
     0     0 -1449.1125    0  501 -9880.3656 -1449.1125  85.3%     -   71s
     0     0 -1455.1008    0  574 -9880.3656 -1455.1008  85.3%     -   72s
     0     0 -1457.7856    0  577 -9880.3656 -1457.7856  85.2%     -   72s
     0     0 -1458.1302    0  574 -9880.3656 -1458.1302  85.2%     -   72s
     0     0 -1459.2897    0  592 -9880.3656 -1459.2897  85.2%     -   73s
     0     0 -1461.1883    0  592 -9880.3656 -1461.1883  85.2%     -   73s
     0     0 -1462.0147    0  586 -9880.3656 -1462.0147  85.2%     -   74s
     0     0 -1464.3508    0  586 -9880.3656 -1464.3508  85.2%     -   74s
     0     2 -1464.3508    0  586 -9880.3656 -1464.3508  85.2%     -   85s
     7    16 -2006.2799    3  552 -9880.3656 -1932.2260  80.4%  2396   92s
    15    32 -2203.5226    4  567 -9880.3656 -2006.5430  79.7%  2274   96s
    31    64 -2231.2689    5  556 -9880.3656 -2203.5671  77.7%  3770  103s
    63    96 -2314.4729    6  581 -9880.3656 -2254.5509  77.2%  3410  106s
   127   167 -2552.5109    8  491 -9880.3656 -2254.5509  77.2%  2410  111s
   166   218 -2810.5627    8  419 -9880.3656 -2254.5509  77.2%  2117  115s
   286   297 -2762.2768   10  475 -9880.3656 -2314.5052  76.6%  1722  123s
   339   348 -4074.5869   11  474 -9880.3656 -2717.9015  72.5%  1766  126s
   392   403 -3324.0127   11  456 -9880.3656 -2717.9015  72.5%  1820  131s
   514   483 -5908.4411   12  431 -9880.3656 -2717.9015  72.5%  1818  140s
   630   551 -5864.6141   13  368 -9880.3656 -2811.0544  71.5%  1893  148s
   679   580 -4582.8847   14  449 -9880.3656 -2811.0544  71.5%  1904  153s
   728   600 -5224.5943   15  362 -9880.3656 -2811.0544  71.5%  1966  158s
   786   637 -5974.1976   15  411 -9880.3656 -2931.1925  70.3%  1969  163s
   835   656 -6143.5162   16  324 -9880.3656 -2931.1925  70.3%  2038  169s
   876   694 -9113.1521   16  279 -9880.3656 -2931.1925  70.3%  2089  174s
   932   731 -6809.8626   17  301 -9880.3656 -2931.1925  70.3%  2062  180s
   991   756 -6950.0773   17  312 -9880.3656 -2931.1925  70.3%  2023  187s
  1070   811 -7501.5016   19  448 -9880.3656 -2931.1925  70.3%  1965  193s
  1153   842 -8050.4265   19  285 -9880.3656 -3104.8895  68.6%  1917  199s
  1254   881 -7647.4958   21  423 -9880.3656 -3212.2649  67.5%  1858  205s
  1343   922 -7724.0246   22  427 -9880.3656 -3303.3243  66.6%  1813  210s
  1563  1041 -8315.3477   27  419 -9880.3656 -3515.1785  64.4%  1686  218s
  1671  1067 infeasible   28      -9880.3656 -3515.1785  64.4%  1646  223s
  1763  1097 -8877.4950   29  337 -9880.3656 -3515.1785  64.4%  1613  227s
  1850  1137     cutoff   30      -9880.3656 -3750.5329  62.0%  1600  232s
  1964  1181 -5953.6244   10  296 -9880.3656 -3760.8282  61.9%  1575  237s
  2068  1244 -7557.5185   12  181 -9880.3656 -3933.1441  60.2%  1566  243s
  2204  1319 -8780.1740   19  157 -9880.3656 -3997.0361  59.5%  1539  248s
  2368  1347     cutoff   26      -9880.3656 -3997.0361  59.5%  1501  254s
  2547  1403 -8347.8232    9  168 -9880.3656 -4158.4554  57.9%  1477  261s
  2731  1438 -8066.4780   11  339 -9880.3656 -4298.7882  56.5%  1451  267s
  2881  1465 -9045.9287   13  278 -9880.3656 -4298.7882  56.5%  1449  272s
  2980  1514     cutoff   14      -9880.3656 -4298.7882  56.5%  1442  280s
  3144  1604 -5164.3285   11  246 -9880.3656 -4298.7882  56.5%  1430  286s
  3373  1681 -8395.0633   13  137 -9880.3656 -4298.7882  56.5%  1398  292s
  3594  1710 -8693.3455   15  185 -9880.3656 -4539.7403  54.1%  1377  301s
  3820  1766 -6012.1541   14  303 -9880.3656 -4585.6700  53.6%  1369  308s
  4019  1802 -8136.1876   20  175 -9880.3656 -4691.5122  52.5%  1363  316s
  4300  1806 -9573.4872   29  158 -9880.3656 -4726.1306  52.2%  1342  325s
  4521  1812 -8164.0656   12  396 -9880.3656 -4795.2138  51.5%  1342  335s
  4729  1822     cutoff   15      -9880.3656 -4795.2138  51.5%  1348  346s
  4882  1865 -8299.0963   14  312 -9880.3656 -4985.6927  49.5%  1350  355s
  5144  1940     cutoff   16      -9880.3656 -5005.2486  49.3%  1343  366s
  5452  1944 -9048.5290   15  287 -9880.3656 -5005.2486  49.3%  1332  373s
  5512  1957 -9786.6324   16  286 -9880.3656 -5005.2486  49.3%  1335  381s
  5589  1967     cutoff   17      -9880.3656 -5005.2486  49.3%  1336  387s
  5662  1972     cutoff   16      -9880.3656 -5264.0183  46.7%  1335  397s
  5811  2018 -7842.6612   16  267 -9880.3656 -5282.4744  46.5%  1332  406s
  6035  2038 -9258.7996   23  239 -9880.3656 -5282.4744  46.5%  1326  415s
  6215  2065     cutoff   15      -9880.3656 -5288.7219  46.5%  1328  426s
  6542  2090 -9509.5270   16  437 -9880.3656 -5424.7085  45.1%  1324  436s
  6774  2128 -8510.0878   14  290 -9880.3656 -5552.3799  43.8%  1323  447s
  7172  2205 -6200.6982   15  231 -9880.3656 -5552.3799  43.8%  1312  458s
  7610  2296 -8978.7300   26  228 -9880.3656 -5743.1373  41.9%  1297  468s
  8092  2350 -7789.0511   15  185 -9880.3656 -5900.1605  40.3%  1281  479s
  8625  2354     cutoff   20      -9880.3656 -6103.4854  38.2%  1260  489s
  9028  2422     cutoff   14      -9880.3656 -6155.0471  37.7%  1253  500s
  9613  2475 -8875.6049   20  344 -9880.3656 -6404.1798  35.2%  1233  516s
 10171  2463     cutoff   18      -9880.3656 -6460.4236  34.6%  1220  529s
 10709  2407 -8411.7692   21  167 -9880.3656 -6750.7086  31.7%  1213  545s
 11288  2319     cutoff   14      -9880.3656 -6971.9317  29.4%  1206  558s
 12001  2202     cutoff   16      -9880.3656 -7157.7292  27.6%  1190  573s
 12723  2030 -9168.7285   20   70 -9880.3656 -7538.9960  23.7%  1177  588s
 13604  1834 -9836.2615   22  255 -9880.3656 -7757.1295  21.5%  1153  602s
 14595  1818 -9579.9101   24  268 -9880.3656 -7971.2946  19.3%  1124  614s
 14736  1651     cutoff   25      -9880.3656 -7971.2946  19.3%  1120  627s
 15538  1365     cutoff   27      -9880.3656 -8182.9894  17.2%  1095  640s
 16659   821     cutoff   19      -9880.3656 -8361.4081  15.4%  1060  656s
 18445    27     cutoff   23      -9880.3656 -8901.6445  9.91%  1002  666s

Cutting planes:
  Learned: 1
  Cover: 1
  Implied bound: 18
  MIR: 530
  Flow cover: 1108
  RLT: 34
  Relax-and-lift: 76

Explored 20225 nodes (19096059 simplex iterations) in 667.39 seconds (2002.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -9880.37 -9896.93 -9898.28 ... -14605.7
No other solutions better than -9880.37

Optimal solution found (tolerance 1.00e-06)
Best objective -9.880365634988e+03, best bound -9.880365634988e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 667.46s
  Master Objective (UB) = -9880.37, θ = 112926.30
  Upper Bound (UB) = -9880.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112926.30
  [DEBUG]   ✓ Scenario 0: θ = 112926.30 ≤ Q = 112926.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112926.30 ≤ Q = 112926.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112926.30 ≤ Q = 112926.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 112926.30 ≤ Q = 112926.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6963f24f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6963f24f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.184101e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 5915446.6418
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.241332e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124133.19    0  122 5915446.64 -124133.19   102%     -    0s
H    0     0                    -88968.82944 -124133.19  39.5%     -    0s
H    0     0                    -89897.84730 -124133.19  38.1%     -    0s
H    0     0                    -92244.49148 -124133.19  34.6%     -    0s
H    0     0                    -93309.77890 -104949.84  12.5%     -    0s
     0     0 -104949.84    0  119 -93309.779 -104949.84  12.5%     -    0s
H    0     0                    -103125.9504 -104940.26  1.76%     -    0s
H    0     0                    -103453.3695 -104940.26  1.44%     -    0s
     0     0 -104442.86    0   75 -103453.37 -104442.86  0.96%     -    0s
     0     0 -104403.23    0   76 -103453.37 -104403.23  0.92%     -    0s
     0     0 -104403.17    0   76 -103453.37 -104403.17  0.92%     -    0s
H    0     0                    -103641.0619 -104403.17  0.74%     -    0s
H    0     0                    -103940.4484 -104403.17  0.45%     -    0s
     0     0 -104211.62    0   18 -103940.45 -104211.62  0.26%     -    0s
H    0     0                    -103982.8239 -104206.32  0.21%     -    0s
     0     0 -104128.31    0   27 -103982.82 -104128.31  0.14%     -    0s
     0     0 -104124.09    0   25 -103982.82 -104124.09  0.14%     -    0s
     0     0 -104121.49    0   19 -103982.82 -104121.49  0.13%     -    0s
     0     0 -104086.83    0   14 -103982.82 -104086.83  0.10%     -    0s
     0     0 -104086.83    0   48 -103982.82 -104086.83  0.10%     -    0s
*    0     0               0    -104020.6366 -104020.64  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 12
  MIR: 43
  Flow cover: 7
  RLT: 5

Explored 1 nodes (886 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104021 -103983 -103940 ... -89897.8
No other solutions better than -104021

Optimal solution found (tolerance 1.00e-06)
Best objective -1.040206366175e+05, best bound -1.040206366175e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 101077.56
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104020.64
  [DEBUG]   S×d_nominal = 205098.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205098.20 + -104020.64 = 101077.56
  [DEBUG]   Current θ from Master = 112926.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11848.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21729.10
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3596.2503, Absolute Gap = 3596.2503, Relative Gap = 0.363979
  Not converged yet (gap = 3596.25 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0x5ddddb0f
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34360 rows and 13950 columns
Presolve time: 0.69s
Presolved: 43473 rows, 19510 columns, 269359 nonzeros
Variable types: 17251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -184823.6323

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43473 rows, 19510 columns, 269359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25887   -4.5932680e+03   0.000000e+00   1.716369e+10      5s
   37531    2.1949272e+03   0.000000e+00   2.136433e+05     10s
   47412    4.1918520e+03   0.000000e+00   5.379776e+05     15s
Concurrent spin time: 5.14s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.397661e+03, 39946 iterations, 22.67 seconds (41.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8397.66148    0  231 -184823.63 8397.66148   105%     -   23s
H    0     0                    -176569.7370 8397.66148   105%     -   23s
H    0     0                    -89084.90645 8397.66148   109%     -   23s
H    0     0                    -63520.17603 8397.66148   113%     -   23s
H    0     0                    -28684.10643 8397.66148   129%     -   24s
H    0     0                    -14974.77354 8397.66148   156%     -   24s
H    0     0                    -14174.78966 8397.66148   159%     -   24s
H    0     0                    -14174.06184 8397.66148   159%     -   24s
H    0     0                    -14086.47380 8397.66148   160%     -   24s
H    0     0                    -14062.70014 4781.39299   134%     -   33s
     0     0 4372.81363    0  430 -14062.700 4372.81363   131%     -   33s
     0     0 4339.42199    0  419 -14062.700 4339.42199   131%     -   37s
     0     0 4339.42199    0  423 -14062.700 4339.42199   131%     -   37s
     0     0 4339.42199    0  421 -14062.700 4339.42199   131%     -   37s
     0     0 4339.42199    0  421 -14062.700 4339.42199   131%     -   37s
H    0     0                    -10923.03352 2227.98357   120%     -   45s
H    0     0                    -10912.65566 2227.98357   120%     -   45s
     0     0 2214.29464    0  406 -10912.656 2214.29464   120%     -   45s
H    0     0                    -10090.81522 2214.29464   122%     -   45s
H    0     0                    -10068.30316 2214.29464   122%     -   45s
H    0     0                    -10046.51922 2214.29464   122%     -   45s
H    0     0                    -10029.55498 2214.29464   122%     -   45s
H    0     0                    -10021.36992 2214.29464   122%     -   45s
H    0     0                    -10010.92836 2214.29464   122%     -   45s
H    0     0                    -9999.088217 1301.43349   113%     -   51s
H    0     0                    -9992.042059 1301.43349   113%     -   51s
     0     0 1301.43349    0  472 -9992.0421 1301.43349   113%     -   51s
     0     0 1087.38510    0  468 -9992.0421 1087.38510   111%     -   54s
     0     0 1077.75627    0  474 -9992.0421 1077.75627   111%     -   55s
     0     0 1000.46466    0  474 -9992.0421 1000.46466   110%     -   56s
     0     0  967.58149    0  490 -9992.0421  967.58149   110%     -   57s
     0     0  965.50204    0  487 -9992.0421  965.50204   110%     -   57s
     0     0  964.32256    0  489 -9992.0421  964.32256   110%     -   57s
     0     0  964.30611    0  489 -9992.0421  964.30611   110%     -   57s
     0     0  121.92198    0  508 -9992.0421  121.92198   101%     -   65s
     0     0 -147.26185    0  526 -9992.0421 -147.26185  98.5%     -   69s
     0     0 -249.55605    0  511 -9992.0421 -249.55605  97.5%     -   72s
     0     0 -345.53028    0  518 -9992.0421 -345.53028  96.5%     -   74s
     0     0 -373.67025    0  515 -9992.0421 -373.67025  96.3%     -   74s
     0     0 -387.91483    0  518 -9992.0421 -387.91483  96.1%     -   75s
     0     0 -394.47683    0  516 -9992.0421 -394.47683  96.1%     -   75s
     0     0 -394.74778    0  507 -9992.0421 -394.74778  96.0%     -   76s
     0     0 -800.19301    0  526 -9992.0421 -800.19301  92.0%     -   83s
     0     0 -954.17393    0  538 -9992.0421 -954.17393  90.5%     -   86s
     0     0 -1059.6141    0  538 -9992.0421 -1059.6141  89.4%     -   87s
     0     0 -1108.3074    0  516 -9992.0421 -1108.3074  88.9%     -   88s
     0     0 -1154.2502    0  546 -9992.0421 -1154.2502  88.4%     -   89s
     0     0 -1158.7637    0  549 -9992.0421 -1158.7637  88.4%     -   90s
     0     0 -1193.9192    0  530 -9992.0421 -1193.9192  88.1%     -   91s
     0     0 -1203.3138    0  550 -9992.0421 -1203.3138  88.0%     -   91s
     0     0 -1207.5893    0  548 -9992.0421 -1207.5893  87.9%     -   92s
     0     0 -1209.1037    0  550 -9992.0421 -1209.1037  87.9%     -   92s
     0     0 -1210.9889    0  549 -9992.0421 -1210.9889  87.9%     -   92s
     0     0 -1211.0876    0  550 -9992.0421 -1211.0876  87.9%     -   92s
     0     0 -1316.9400    0  557 -9992.0421 -1316.9400  86.8%     -   95s
     0     0 -1342.6345    0  559 -9992.0421 -1342.6345  86.6%     -   97s
     0     0 -1370.8061    0  560 -9992.0421 -1370.8061  86.3%     -   97s
     0     0 -1386.6280    0  566 -9992.0421 -1386.6280  86.1%     -   98s
     0     0 -1389.7194    0  575 -9992.0421 -1389.7194  86.1%     -   99s
     0     0 -1391.4866    0  569 -9992.0421 -1391.4866  86.1%     -   99s
     0     0 -1392.1101    0  571 -9992.0421 -1392.1101  86.1%     -   99s
     0     0 -1500.8582    0  562 -9992.0421 -1500.8582  85.0%     -  102s
     0     0 -1516.5593    0  558 -9992.0421 -1516.5593  84.8%     -  104s
     0     0 -1520.1321    0  570 -9992.0421 -1520.1321  84.8%     -  104s
     0     0 -1522.2227    0  568 -9992.0421 -1522.2227  84.8%     -  104s
     0     0 -1523.2306    0  578 -9992.0421 -1523.2306  84.8%     -  105s
     0     0 -1557.3952    0  563 -9992.0421 -1557.3952  84.4%     -  106s
     0     0 -1564.8069    0  568 -9992.0421 -1564.8069  84.3%     -  107s
     0     0 -1567.3849    0  568 -9992.0421 -1567.3849  84.3%     -  107s
     0     0 -1569.3773    0  569 -9992.0421 -1569.3773  84.3%     -  107s
     0     0 -1570.6027    0  570 -9992.0421 -1570.6027  84.3%     -  108s
     0     0 -1587.9450    0  574 -9992.0421 -1587.9450  84.1%     -  109s
     0     0 -1591.2597    0  569 -9992.0421 -1591.2597  84.1%     -  110s
     0     0 -1592.2110    0  573 -9992.0421 -1592.2110  84.1%     -  110s
     0     0 -1601.0837    0  563 -9992.0421 -1601.0837  84.0%     -  111s
     0     0 -1605.4043    0  579 -9992.0421 -1605.4043  83.9%     -  112s
     0     0 -1606.9371    0  579 -9992.0421 -1606.9371  83.9%     -  112s
     0     0 -1608.3013    0  578 -9992.0421 -1608.3013  83.9%     -  113s
     0     0 -1617.4379    0  569 -9992.0421 -1617.4379  83.8%     -  114s
     0     0 -1618.9253    0  572 -9992.0421 -1618.9253  83.8%     -  115s
     0     0 -1619.7230    0  578 -9992.0421 -1619.7230  83.8%     -  116s
     0     0 -1627.7275    0  577 -9992.0421 -1627.7275  83.7%     -  117s
     0     0 -1632.6790    0  573 -9992.0421 -1632.6790  83.7%     -  117s
     0     0 -1634.3818    0  575 -9992.0421 -1634.3818  83.6%     -  118s
     0     0 -1634.6791    0  573 -9992.0421 -1634.6791  83.6%     -  118s
     0     0 -1644.9026    0  578 -9992.0421 -1644.9026  83.5%     -  119s
     0     0 -1645.1126    0  584 -9992.0421 -1645.1126  83.5%     -  122s
     0     0 -1653.8860    0  579 -9992.0421 -1653.8860  83.4%     -  123s
     0     0 -1655.7845    0  580 -9992.0421 -1655.7845  83.4%     -  124s
     0     0 -1656.2757    0  586 -9992.0421 -1656.2757  83.4%     -  124s
     0     0 -1663.2975    0  589 -9992.0421 -1663.2975  83.4%     -  126s
     0     0 -1667.1943    0  579 -9992.0421 -1667.1943  83.3%     -  126s
     0     0 -1668.5097    0  587 -9992.0421 -1668.5097  83.3%     -  127s
     0     0 -1672.3079    0  591 -9992.0421 -1672.3079  83.3%     -  127s
     0     0 -1672.6527    0  591 -9992.0421 -1672.6527  83.3%     -  128s
     0     2 -1672.7264    0  591 -9992.0421 -1672.7264  83.3%     -  147s
     3     8 -2106.2180    2  563 -9992.0421 -1706.3347  82.9%  2631  152s
     7    16 -2269.9507    3  582 -9992.0421 -2092.6029  79.1%  2899  157s
    15    32 -2487.5104    4  575 -9992.0421 -2276.6170  77.2%  3588  164s
    31    51 -3548.3137    5  422 -9992.0421 -2487.9341  75.1%  6907  175s
    50    83 -3228.9843    6  547 -9992.0421 -2487.9341  75.1%  6490  181s
    82   169 -3364.6395    7  541 -9992.0421 -2487.9341  75.1%  4942  191s
   168   268 -5438.5996    9  179 -9992.0421 -2487.9341  75.1%  3370  197s
   287   317 -3493.8428    9  537 -9992.0421 -2487.9341  75.1%  2447  204s
   389   345 -5714.1787   12  524 -9992.0421 -2487.9341  75.1%  2165  211s
   456   365 -4088.1338   12  513 -9992.0421 -2487.9341  75.1%  2019  218s
   524   389 -4529.2322   13  483 -9992.0421 -2487.9341  75.1%  2050  224s
   577   413 -5570.8911   13  495 -9992.0421 -2487.9341  75.1%  2027  230s
   642   439 -4555.7144   14  413 -9992.0421 -2727.2663  72.7%  1982  237s
   677   467 -6072.7050   15  431 -9992.0421 -2727.2663  72.7%  1991  243s
   720   494 -6250.9357   16  420 -9992.0421 -2727.2663  72.7%  2019  250s
   773   535 -6115.1456   16  415 -9992.0421 -2727.2663  72.7%  2013  255s
   824   557 -6445.4195   17  423 -9992.0421 -2727.2663  72.7%  2034  260s
   876   567 -8254.5222   17  357 -9992.0421 -2727.2663  72.7%  2020  267s
   928   598 -6261.1849   17  345 -9992.0421 -2727.2663  72.7%  2019  274s
   994   618 -6542.1495   18  347 -9992.0421 -2727.2663  72.7%  2021  281s
  1050   657     cutoff   17      -9992.0421 -2727.2663  72.7%  2027  288s
  1113   688 -6598.6836   19  345 -9992.0421 -2727.2663  72.7%  2028  294s
  1178   737 -8043.3756   20  321 -9992.0421 -3017.7449  69.8%  2022  301s
  1263   774 -9585.8892   21  319 -9992.0421 -3022.4856  69.8%  2006  308s
  1378   827 -7634.2654   22  331 -9992.0421 -3022.4856  69.8%  1946  315s
  1481   887 -8870.8856   23  333 -9992.0421 -3022.4856  69.8%  1917  323s
  1596   938 infeasible   23      -9992.0421 -3390.0311  66.1%  1888  331s
  1709   991 -8773.6771   24  320 -9992.0421 -3444.3033  65.5%  1855  339s
  1840  1028 -9725.1123   27  307 -9992.0421 -3504.9921  64.9%  1827  349s
  1943  1049 -9481.1875   28  301 -9992.0421 -3549.6186  64.5%  1831  358s
  2054  1063 -5706.1260   12  408 -9992.0421 -3549.6186  64.5%  1830  367s
  2134  1105 -8395.4312   13  318 -9992.0421 -3648.8902  63.5%  1824  375s
  2231  1161 -8617.6852   14  308 -9992.0421 -3853.1687  61.4%  1823  385s
  2357  1209 -8948.4292   16  235 -9992.0421 -4121.3972  58.8%  1804  395s
  2484  1300 -6888.5779   15  371 -9992.0421 -4166.6027  58.3%  1798  404s
  2621  1366 -8319.1328   18  345 -9992.0421 -4172.9676  58.2%  1795  414s
  2753  1443 -9047.6903   22  310 -9992.0421 -4172.9676  58.2%  1808  423s
  2979  1485 -9883.9352   28  287 -9992.0421 -4172.9676  58.2%  1757  433s
  3204  1526 -9934.0697   29  272 -9992.0421 -4389.8811  56.1%  1719  443s
  3412  1616 -9343.5394   11  129 -9992.0421 -4419.7425  55.8%  1712  453s
  3556  1677 -9311.8446   12  372 -9992.0421 -4504.8995  54.9%  1739  462s
  3653  1746 -9529.2942   13  329 -9992.0421 -4551.5440  54.4%  1746  475s
  3853  1824 -9615.0752   14  322 -9992.0421 -4594.7901  54.0%  1734  487s
  4101  1847     cutoff   16      -9992.0421 -4626.4477  53.7%  1716  495s
  4154  1873 -5497.2111    9  335 -9992.0421 -4626.4477  53.7%  1717  503s
  4204  1915 -6294.3418   11  447 -9992.0421 -4626.4477  53.7%  1722  517s
  4332  1989     cutoff   13      -9992.0421 -4626.4477  53.7%  1711  531s
  4538  2044 -8322.5004   17  354 -9992.0421 -4741.9302  52.5%  1707  547s
  4754  2092 -9416.3492   29  246 -9992.0421 -4887.2889  51.1%  1712  560s
  4942  2157 -7906.9244   15  343 -9992.0421 -4902.5280  50.9%  1716  573s
  5186  2209 -8710.6823   19  331 -9992.0421 -4925.1732  50.7%  1722  587s
  5453  2225 -8298.2457   13  441 -9992.0421 -4925.1732  50.7%  1727  604s
  5739  2269     cutoff   14      -9992.0421 -5057.3852  49.4%  1731  620s
  6068  2272     cutoff   21      -9992.0421 -5057.3852  49.4%  1731  635s
  6322  2324     cutoff   20      -9992.0421 -5290.2011  47.1%  1721  652s
  6639  2327 infeasible   18      -9992.0421 -5374.3573  46.2%  1727  669s
  6976  2330 -9591.5708   13  432 -9992.0421 -5518.5491  44.8%  1733  687s
  7258  2356 -9787.3641   14  231 -9992.0421 -5618.2764  43.8%  1741  707s
  7625  2365     cutoff   14      -9992.0421 -5767.8044  42.3%  1742  726s
  7940  2332     cutoff   15      -9992.0421 -5832.5603  41.6%  1736  744s
  8342  2330     cutoff   12      -9992.0421 -6042.1381  39.5%  1740  761s
  8825  2321 -9208.4399   12  391 -9992.0421 -6152.8522  38.4%  1731  784s
  9321  2303 -8382.5734   14  378 -9992.0421 -6293.8876  37.0%  1723  804s
  9885  2317 -8701.6752   11  104 -9992.0421 -6492.2673  35.0%  1711  824s
 10357  2223     cutoff   15      -9992.0421 -6606.4255  33.9%  1704  847s
 10983  2143     cutoff   17      -9992.0421 -6900.1315  30.9%  1690  870s
 11607  2062     cutoff   13      -9992.0421 -7158.5798  28.4%  1678  893s
 12234  2039     cutoff   15      -9992.0421 -7334.4249  26.6%  1666  919s
 12987  1931 infeasible   36      -9992.0421 -7762.7398  22.3%  1636  944s
 13857  1961 -8777.1106   29  275 -9992.0421 -7944.3228  20.5%  1600  965s
 14436  1848 -8922.1971   25  349 -9992.0421 -8065.2946  19.3%  1575  989s
 15502  1434 -9333.8469   17  289 -9992.0421 -8290.3304  17.0%  1526 1019s
 16615   769     cutoff   25      -9992.0421 -8496.5782  15.0%  1482 1045s
 17879     0 -9660.2968   26  378 -9992.0421 -8949.6730  10.4%  1432 1065s

Cutting planes:
  Gomory: 1
  Implied bound: 31
  MIR: 694
  Flow cover: 1513
  RLT: 35
  Relax-and-lift: 98

Explored 18922 nodes (26272377 simplex iterations) in 1065.87 seconds (3208.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -9992.04 -9999.09 -10010.9 ... -10923
No other solutions better than -9992.04

Optimal solution found (tolerance 1.00e-06)
Warning: max constraint violation (1.5534e-09) exceeds tolerance
Best objective -9.992042058653e+03, best bound -9.992042058653e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1065.91s
  Master Objective (UB) = -9992.04, θ = 111505.20
  Upper Bound (UB) = -9992.04

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111505.20
  [DEBUG]   ✓ Scenario 0: θ = 111505.20 ≤ Q = 111505.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111505.20 ≤ Q = 111505.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 111505.20 ≤ Q = 111505.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 111505.20 ≤ Q = 111505.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 111505.20 ≤ Q = 111505.20 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1ef63134
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe109cecc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.179058e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 5862852.2848
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.249001e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124900.14    0  123 5862852.28 -124900.14   102%     -    0s
H    0     0                    -89596.12518 -124900.14  39.4%     -    0s
H    0     0                    -90540.25853 -124900.14  37.9%     -    0s
H    0     0                    -91856.88803 -124900.14  36.0%     -    0s
H    0     0                    -93490.59567 -105816.41  13.2%     -    0s
H    0     0                    -94130.76883 -105816.41  12.4%     -    0s
     0     0 -105816.41    0   64 -94130.769 -105816.41  12.4%     -    0s
H    0     0                    -103740.0502 -105773.36  1.96%     -    0s
H    0     0                    -104083.7987 -105773.36  1.62%     -    0s
H    0     0                    -104131.7535 -105773.36  1.58%     -    0s
H    0     0                    -104475.5020 -105773.36  1.24%     -    0s
     0     0 -105175.95    0   46 -104475.50 -105175.95  0.67%     -    0s
H    0     0                    -104520.5135 -105146.66  0.60%     -    0s
     0     0 -105146.66    0   38 -104520.51 -105146.66  0.60%     -    0s
     0     0 -105127.36    0   39 -104520.51 -105127.36  0.58%     -    0s
     0     0 -104868.82    0   27 -104520.51 -104868.82  0.33%     -    0s
     0     0 -104814.09    0   32 -104520.51 -104814.09  0.28%     -    0s
     0     0 -104801.47    0   31 -104520.51 -104801.47  0.27%     -    0s
     0     0 -104734.93    0   19 -104520.51 -104734.93  0.21%     -    0s
     0     0 -104717.98    0   20 -104520.51 -104717.98  0.19%     -    0s
     0     0 -104674.48    0   15 -104520.51 -104674.48  0.15%     -    0s
     0     0 -104674.48    0   20 -104520.51 -104674.48  0.15%     -    0s
     0     0 -104558.06    0    3 -104520.51 -104558.06  0.04%     -    0s
H    0     0                    -104554.6198 -104555.23  0.00%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 3
  MIR: 5
  Flow cover: 6
  RLT: 1
  Relax-and-lift: 5

Explored 1 nodes (814 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104555 -104521 -104476 ... 5.86285e+06
No other solutions better than -104555

Optimal solution found (tolerance 1.00e-06)
Best objective -1.045546198242e+05, best bound -1.045546198242e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 99749.46
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104554.62
  [DEBUG]   S×d_nominal = 204304.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204304.08 + -104554.62 = 99749.46
  [DEBUG]   Current θ from Master = 111505.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11755.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21747.78
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3484.5739, Absolute Gap = 3484.5739, Relative Gap = 0.348735
  Not converged yet (gap = 3484.57 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264941 nonzeros
Model fingerprint: 0x4fc2a4d5
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 41248 rows and 16748 columns
Presolve time: 0.87s
Presolved: 51875 rows, 22952 columns, 322079 nonzeros
Variable types: 20693 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -184823.6323

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 51875 rows, 22952 columns, 322079 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30353   -9.5976310e+03   0.000000e+00   2.377968e+06      5s
   40617    2.3296832e+03   0.000000e+00   7.007360e+06     10s
   49736    4.9356729e+03   0.000000e+00   5.378281e+05     15s
   59127    7.4165901e+03   0.000000e+00   2.043876e+06     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 8.307118e+03, 40412 iterations, 19.16 seconds (37.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8307.11783    0  232 -184823.63 8307.11783   104%     -   20s
H    0     0                    -177052.2168 8307.11783   105%     -   20s
H    0     0                    -148939.2003 8307.11783   106%     -   20s
H    0     0                    -99043.77300 8307.11783   108%     -   20s
H    0     0                    -82462.67326 8307.11783   110%     -   20s
H    0     0                    -81350.92875 8307.11783   110%     -   20s
H    0     0                    -78639.20889 8307.11783   111%     -   20s
H    0     0                    -75390.39771 8307.11783   111%     -   20s
H    0     0                    -75333.23520 8307.11783   111%     -   20s
H    0     0                    -69893.73916 8307.11783   112%     -   20s
H    0     0                    -18411.54557 8307.11783   145%     -   20s
H    0     0                    -17898.76829 8307.11783   146%     -   21s
H    0     0                    -17808.30576 8307.11783   147%     -   21s
H    0     0                    -16583.10544 8307.11783   150%     -   21s
H    0     0                    -16538.44034 8307.11783   150%     -   21s
H    0     0                    -16527.28908 8307.11783   150%     -   21s
H    0     0                    -16488.91284 8307.11783   150%     -   21s
H    0     0                    -16486.79008 8307.11783   150%     -   21s
H    0     0                    -16478.86570 8307.11783   150%     -   21s
H    0     0                    -16465.41004 8307.11783   150%     -   21s
H    0     0                    -16462.05836 8307.11783   150%     -   21s
H    0     0                    -15533.71105 4729.90644   130%     -   34s
H    0     0                    -15141.31057 4729.90644   131%     -   34s
H    0     0                    -15067.76233 4729.90644   131%     -   34s
     0     0 4540.17347    0  421 -15067.762 4540.17347   130%     -   34s
     0     0 4540.17347    0  414 -15067.762 4540.17347   130%     -   35s
     0     0 4540.17347    0  416 -15067.762 4540.17347   130%     -   37s
     0     0 4540.17347    0  413 -15067.762 4540.17347   130%     -   38s
     0     0 4540.17347    0  422 -15067.762 4540.17347   130%     -   39s
     0     0 4540.17347    0  424 -15067.762 4540.17347   130%     -   39s
     0     0 4540.17347    0  424 -15067.762 4540.17347   130%     -   39s
H    0     0                    -15049.09287 2074.37423   114%     -   50s
H    0     0                    -15044.41003 2074.37423   114%     -   50s
H    0     0                    -15034.03217 2074.37423   114%     -   50s
H    0     0                    -14951.99349 2074.37423   114%     -   50s
H    0     0                    -14948.97274 2074.37423   114%     -   50s
H    0     0                    -14934.60655 2074.37423   114%     -   50s
H    0     0                    -14860.21380 2074.37423   114%     -   50s
H    0     0                    -14786.29039 2074.37423   114%     -   50s
H    0     0                    -14771.70088 2074.37423   114%     -   50s
H    0     0                    -14751.92616 2074.37423   114%     -   50s
     0     0 2074.37423    0  460 -14751.926 2074.37423   114%     -   50s
H    0     0                    -11881.64100 2074.27542   117%     -   51s
H    0     0                    -11726.92089 2074.27542   118%     -   51s
H    0     0                    -11627.80326 2074.27542   118%     -   51s
H    0     0                    -11572.00696 2074.27542   118%     -   51s
     0     0 1550.79358    0  463 -11572.007 1550.79358   113%     -   55s
     0     0 1430.36217    0  465 -11572.007 1430.36217   112%     -   58s
     0     0 1367.92693    0  470 -11572.007 1367.92693   112%     -   60s
     0     0 1304.60108    0  467 -11572.007 1304.60108   111%     -   61s
     0     0 1271.51636    0  482 -11572.007 1271.51636   111%     -   62s
H    0     0                    -10873.18584 1247.92443   111%     -   64s
H    0     0                    -10833.92743 1247.92443   112%     -   64s
     0     0 1247.92443    0  484 -10833.927 1247.92443   112%     -   64s
H    0     0                    -10810.98657 1247.62668   112%     -   64s
     0     0 1247.62668    0  485 -10810.987 1247.62668   112%     -   64s
H    0     0                    -10747.55155 1247.62668   112%     -   69s
H    0     0                    -10701.43146 1247.62668   112%     -   69s
H    0     0                    -10475.68119  357.65680   103%     -   75s
H    0     0                    -10434.56615  357.65680   103%     -   75s
H    0     0                    -10415.85483  357.65680   103%     -   75s
H    0     0                    -10394.54084  357.65680   103%     -   75s
     0     0  357.65680    0  426 -10394.541  357.65680   103%     -   75s
     0     0  -75.50214    0  416 -10394.541  -75.50214  99.3%     -   80s
     0     0 -194.14665    0  421 -10394.541 -194.14665  98.1%     -   82s
     0     0 -232.63458    0  427 -10394.541 -232.63458  97.8%     -   84s
     0     0 -281.10992    0  444 -10394.541 -281.10992  97.3%     -   86s
     0     0 -319.00008    0  443 -10394.541 -319.00008  96.9%     -   87s
     0     0 -374.67072    0  452 -10394.541 -374.67072  96.4%     -   89s
     0     0 -376.58108    0  458 -10394.541 -376.58108  96.4%     -   90s
     0     0 -380.98835    0  442 -10394.541 -380.98835  96.3%     -   90s
     0     0 -386.28236    0  452 -10394.541 -386.28236  96.3%     -   90s
     0     0 -386.69682    0  458 -10394.541 -386.69682  96.3%     -   90s
     0     0 -756.11712    0  536 -10394.541 -756.11712  92.7%     -   98s
     0     0 -889.11596    0  536 -10394.541 -889.11596  91.4%     -  100s
     0     0 -926.22888    0  540 -10394.541 -926.22888  91.1%     -  102s
     0     0 -941.29825    0  557 -10394.541 -941.29825  90.9%     -  103s
     0     0 -944.19360    0  564 -10394.541 -944.19360  90.9%     -  104s
     0     0 -948.88987    0  562 -10394.541 -948.88987  90.9%     -  104s
     0     0 -951.77320    0  569 -10394.541 -951.77320  90.8%     -  105s
     0     0 -954.69285    0  560 -10394.541 -954.69285  90.8%     -  105s
     0     0 -955.20016    0  562 -10394.541 -955.20016  90.8%     -  105s
     0     0 -1140.8393    0  553 -10394.541 -1140.8393  89.0%     -  110s
     0     0 -1174.1794    0  479 -10394.541 -1174.1794  88.7%     -  112s
     0     0 -1179.7406    0  557 -10394.541 -1179.7406  88.7%     -  112s
     0     0 -1186.9389    0  565 -10394.541 -1186.9389  88.6%     -  113s
     0     0 -1220.0251    0  561 -10394.541 -1220.0251  88.3%     -  114s
     0     0 -1222.1572    0  561 -10394.541 -1222.1572  88.2%     -  114s
     0     0 -1222.6649    0  563 -10394.541 -1222.6649  88.2%     -  114s
     0     0 -1286.7690    0  563 -10394.541 -1286.7690  87.6%     -  117s
     0     0 -1296.1356    0  567 -10394.541 -1296.1356  87.5%     -  119s
     0     0 -1304.6617    0  576 -10394.541 -1304.6617  87.4%     -  119s
     0     0 -1305.3353    0  512 -10394.541 -1305.3353  87.4%     -  120s
     0     0 -1333.2664    0  563 -10394.541 -1333.2664  87.2%     -  122s
     0     0 -1340.0192    0  568 -10394.541 -1340.0192  87.1%     -  123s
     0     0 -1341.1681    0  575 -10394.541 -1341.1681  87.1%     -  123s
     0     0 -1368.1028    0  562 -10394.541 -1368.1028  86.8%     -  125s
     0     0 -1376.7632    0  571 -10394.541 -1376.7632  86.8%     -  126s
     0     0 -1377.7123    0  568 -10394.541 -1377.7123  86.7%     -  127s
     0     0 -1398.0017    0  582 -10394.541 -1398.0017  86.6%     -  129s
     0     0 -1401.6134    0  585 -10394.541 -1401.6134  86.5%     -  130s
     0     0 -1403.8905    0  583 -10394.541 -1403.8905  86.5%     -  130s
     0     0 -1405.0413    0  581 -10394.541 -1405.0413  86.5%     -  131s
     0     0 -1407.7269    0  515 -10394.541 -1407.7269  86.5%     -  132s
     0     0 -1409.3404    0  575 -10394.541 -1409.3404  86.4%     -  133s
     0     0 -1411.8143    0  580 -10394.541 -1411.8143  86.4%     -  134s
     0     0 -1412.9685    0  576 -10394.541 -1412.9685  86.4%     -  134s
     0     0 -1418.2626    0  587 -10394.541 -1418.2626  86.4%     -  136s
     0     0 -1419.4906    0  588 -10394.541 -1419.4906  86.3%     -  137s
     0     0 -1423.2694    0  599 -10394.541 -1423.2694  86.3%     -  138s
H    0     0                    -10391.59201 -1423.3923  86.3%     -  141s
H    0     0                    -10371.62081 -1423.3923  86.3%     -  142s
H    0     0                    -10365.71677 -1423.3923  86.3%     -  142s
H    0     0                    -10364.78354 -1423.3923  86.3%     -  143s
H    0     0                    -10346.97934 -1423.3923  86.2%     -  143s
H    0     0                    -10345.75985 -1423.3923  86.2%     -  143s
     0     0 -1424.5513    0  596 -10345.760 -1424.5513  86.2%     -  143s
     0     0 -1431.7897    0  587 -10345.760 -1431.7897  86.2%     -  145s
     0     0 -1431.8752    0  587 -10345.760 -1431.8752  86.2%     -  146s
     0     2 -1432.2421    0  587 -10345.760 -1432.2421  86.2%     -  168s
     1     4 -1541.6800    1  565 -10345.760 -1432.5971  86.2%  1670  173s
     3     8 -1917.3027    2  561 -10345.760 -1542.4717  85.1%  5610  179s
     7    16 -2048.2035    3  575 -10345.760 -1917.9661  81.5%  4691  184s
    15    32 -2131.3970    4  575 -10345.760 -2048.2171  80.2%  5182  190s
    31    50 -8001.6663    5  143 -10345.760 -2131.4581  79.4%  6466  201s
    49    82 -3493.4272    6  305 -10345.760 -2131.4581  79.4%  7597  207s
    81   149 -3551.6714    7  371 -10345.760 -2131.4581  79.4%  5931  212s
   150   290 -3570.5767    8  296 -10345.760 -2131.4581  79.4%  3842  216s
   333   341 -4055.2726   10  354 -10345.760 -2131.4581  79.4%  2282  225s
   376   366 -4335.6612    9  195 -10345.760 -2131.4581  79.4%  2248  231s
   417   378 -4341.9832   11  362 -10345.760 -2131.4581  79.4%  2210  238s
   465   396 -4406.8561   11  341 -10345.760 -2131.4581  79.4%  2118  245s
   519   407 -4304.8252   11  350 -10345.760 -2131.4581  79.4%  2127  252s
   566   425 -5477.5198   11  187 -10345.760 -2131.4581  79.4%  2142  258s
   624   442 -5529.7185   12  358 -10345.760 -2131.4581  79.4%  2198  264s
   678   467 -5764.5223   12  194 -10345.760 -2131.4581  79.4%  2281  270s
   725   488 -6612.5153   16  159 -10345.760 -2131.4581  79.4%  2335  276s
   783   510 -6951.0248   16  172 -10345.760 -2131.4581  79.4%  2382  283s
   846   531 -8736.2431   16  109 -10345.760 -2131.4581  79.4%  2383  290s
   911   579 -9180.9587   18  126 -10345.760 -2131.4581  79.4%  2385  297s
   985   588 -9521.4519   20  111 -10345.760 -2131.4581  79.4%  2369  304s
  1070   600     cutoff   22      -10345.760 -2131.4581  79.4%  2319  311s
  1114   614 -5179.1077    9  392 -10345.760 -2131.4581  79.4%  2380  319s
  1166   657 -5469.4285   10  397 -10345.760 -2131.4581  79.4%  2421  326s
  1223   687 -5892.6140   11  373 -10345.760 -2131.4581  79.4%  2476  333s
  1289   737 -6008.0856   12  364 -10345.760 -2131.4581  79.4%  2466  340s
  1379   788 -6338.4672   14  284 -10345.760 -2131.4581  79.4%  2419  349s
  1474   797 -7833.4804   15   90 -10345.760 -2131.4581  79.4%  2375  356s
  1579   832 -9654.0235   17   65 -10345.760 -2774.5282  73.2%  2353  364s
  1677   879 -5041.5701   13  333 -10345.760 -2774.5566  73.2%  2332  372s
  1780   920 -5766.2039   16  311 -10345.760 -2774.5566  73.2%  2338  380s
  1881   949 -6019.1219   18  273 -10345.760 -2774.5566  73.2%  2334  388s
  1962   981 -6307.6513   20  204 -10345.760 -2774.5566  73.2%  2381  396s
  2069  1011 -7591.1338   21  108 -10345.760 -3311.8312  68.0%  2427  405s
  2145  1065 -7240.3911   22  203 -10345.760 -3311.8312  68.0%  2506  413s
  2269  1109 -7344.5297   23  199 -10345.760 -3311.8312  68.0%  2519  423s
  2395  1122 -7808.2095   27  191 -10345.760 -3311.8312  68.0%  2530  432s
  2515  1143 infeasible   28      -10345.760 -3311.8312  68.0%  2548  442s
  2610  1185 -8405.4679   29  260 -10345.760 -3311.8312  68.0%  2617  451s
  2706  1228 -9249.8261   34  167 -10345.760 -3311.8312  68.0%  2666  460s
  2857  1255     cutoff   39      -10345.760 -3311.8312  68.0%  2631  470s
  2984  1269 -6420.8586   11  382 -10345.760 -3311.8312  68.0%  2636  480s
  3034  1281 -6638.5710   12  364 -10345.760 -3311.8312  68.0%  2649  493s
  3090  1305 -6786.2885   13  273 -10345.760 -3311.8312  68.0%  2678  504s
  3155  1322 -6966.2108   14  374 -10345.760 -3311.8312  68.0%  2704  512s
  3232  1341 -7190.0158   15  355 -10345.760 -3311.8312  68.0%  2737  522s
  3335  1377 -7309.6465   16  211 -10345.760 -3816.0789  63.1%  2751  533s
  3455  1409 -7625.2129   17  413 -10345.760 -3816.0789  63.1%  2774  543s
  3573  1460 -7742.7848   18  171 -10345.760 -3816.0789  63.1%  2798  556s
  3738  1504 -8949.0836   25  236 -10345.760 -4129.8649  60.1%  2760  568s
  3881  1545     cutoff   31      -10345.760 -4129.8649  60.1%  2737  580s
  4074  1583     cutoff   11      -10345.760 -5014.2696  51.5%  2749  591s
H 4176  1583                    -10236.20271 -5160.8827  49.6%  2774  591s
* 4180  1583              31    -10213.34618 -5160.8827  49.5%  2772  591s
  4249  1641 -6585.1684   13  445 -10213.346 -5160.8827  49.5%  2758  604s
  4443  1703 -7613.3898   17  365 -10213.346 -5311.8019  48.0%  2792  617s
H 4688  1736                    -10163.77055 -5377.0932  47.1%  2803  630s
H 4690  1736                    -10100.77132 -5377.0932  46.8%  2803  630s
H 4704  1736                    -10092.77253 -5377.0932  46.7%  2804  630s
H 4750  1736                    -10080.00200 -5377.0932  46.7%  2802  630s
  4798  1757 -8900.8515   22  257 -10080.002 -5377.0932  46.7%  2813  645s
  5152  1761     cutoff   21      -10080.002 -5791.5594  42.5%  2757  660s
  5460  1779     cutoff   13      -10080.002 -5807.1672  42.4%  2745  676s
  5849  1805     cutoff   15      -10080.002 -5932.5722  41.1%  2710  691s
* 6071  1804              22    -10078.69722 -6030.1643  40.2%  2695  691s
* 6086  1804              33    -10073.57910 -6030.1643  40.1%  2689  691s
  6241  1829 -7803.8418   16  299 -10073.579 -6030.1643  40.1%  2690  706s
  6604  1863 -8301.5640   18  375 -10073.579 -6043.2791  40.0%  2685  723s
  6933  1905 -9199.2598   20  260 -10073.579 -6250.5500  38.0%  2693  738s
  7213  1936     cutoff   23      -10073.579 -6343.2682  37.0%  2696  754s
  7585  1956 -8326.8326   19  318 -10073.579 -6389.7586  36.6%  2694  771s
  8078  1981 -8151.6588   13  204 -10073.579 -6559.5335  34.9%  2669  787s
  8553  1965 -9826.9771   26  103 -10073.579 -6668.5946  33.8%  2655  805s
  8986  1950 infeasible   14      -10073.579 -6669.6911  33.8%  2639  828s
  9433  1972 -8161.2352   17  393 -10073.579 -6869.8910  31.8%  2641  852s
  9891  1949 -9372.6880   27  237 -10073.579 -6933.7595  31.2%  2637  873s
 10349  1895 -9922.7986   16  260 -10073.579 -7074.9027  29.8%  2641  895s
 10861  1835     cutoff   16      -10073.579 -7332.1839  27.2%  2637  917s
 11404  1751     cutoff   27      -10073.579 -7332.3120  27.2%  2630  939s
 11982  1666     cutoff   18      -10073.579 -7697.8435  23.6%  2620  962s
 12575  1448     cutoff   21      -10073.579 -7853.5563  22.0%  2606  988s
 13296  1240     cutoff   22      -10073.579 -8131.7293  19.3%  2573 1012s
 14153  1045 -9306.1039   25  140 -10073.579 -8479.5945  15.8%  2523 1043s
 15112   716     cutoff   29      -10073.579 -8705.9584  13.6%  2454 1066s
 16440   170     cutoff   26      -10073.579 -9075.3050  9.91%  2352 1086s
 17999     0 -9950.0873   29  153 -10073.579 -9378.4896  6.90%  2225 1094s
*18348     0              26    -10067.22144 -9511.5842  5.52%  2192 1094s

Cutting planes:
  Learned: 1
  Implied bound: 16
  MIR: 735
  Flow cover: 1519
  RLT: 31
  Relax-and-lift: 121

Explored 18389 nodes (40409167 simplex iterations) in 1094.66 seconds (3355.68 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10067.2 -10073.6 -10078.7 ... -10345.8
No other solutions better than -10067.2

Optimal solution found (tolerance 1.00e-06)
Best objective -1.006722144240e+04, best bound -1.006722144240e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1094.72s
  Master Objective (UB) = -10067.22, θ = 110906.63
  Upper Bound (UB) = -10067.22

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110906.63
  [DEBUG]   ✓ Scenario 0: θ = 110906.63 ≤ Q = 110906.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110906.63 ≤ Q = 110906.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110906.63 ≤ Q = 110906.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110906.63 ≤ Q = 110906.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110906.63 ≤ Q = 110906.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110906.63 ≤ Q = 110906.63 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6d055172
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6d055172
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.171319e+13
Presolve removed 2598 rows and 1891 columns
Presolve time: 0.00s
Presolved: 495 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 5841872.8994
Variable types: 335 continuous, 163 integer (163 binary)
Found heuristic solution: objective 5841539.2414

Root relaxation: objective -1.260909e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126090.95    0  121 5841539.24 -126090.95   102%     -    0s
H    0     0                    -95705.32086 -126090.95  31.7%     -    0s
H    0     0                    -96286.46985 -126090.95  31.0%     -    0s
H    0     0                    -96764.47904 -125957.40  30.2%     -    0s
H    0     0                    -108852.3478 -109904.66  0.97%     -    0s
     0     0 -109904.66    0   78 -108852.35 -109904.66  0.97%     -    0s
H    0     0                    -108984.8382 -109895.93  0.84%     -    0s
     0     0 -109410.67    0   75 -108984.84 -109410.67  0.39%     -    0s
     0     0 -109410.02    0   74 -108984.84 -109410.02  0.39%     -    0s
     0     0 -109284.51    0   28 -108984.84 -109284.51  0.27%     -    0s
     0     0 -109284.14    0   27 -108984.84 -109284.14  0.27%     -    0s
     0     0 -109253.95    0   39 -108984.84 -109253.95  0.25%     -    0s
     0     0 -109252.87    0   37 -108984.84 -109252.87  0.25%     -    0s
     0     0 -109251.79    0   36 -108984.84 -109251.79  0.24%     -    0s
     0     0 -109156.43    0   14 -108984.84 -109156.43  0.16%     -    0s
     0     0 -109156.43    0   15 -108984.84 -109156.43  0.16%     -    0s
     0     0 -109027.41    0    4 -108984.84 -109027.41  0.04%     -    0s
H    0     0                    -109026.9683 -109027.36  0.00%     -    0s
H    0     0                    -109027.2137 -109027.36  0.00%     -    0s
     0     0     cutoff    0      -109027.21 -109027.21  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 3
  MIR: 2
  Flow cover: 12
  Relax-and-lift: 3

Explored 1 nodes (776 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -109027 -108985 -96764.5 ... 1.17132e+13
No other solutions better than -109027

Optimal solution found (tolerance 1.00e-06)
Best objective -1.090272137015e+05, best bound -1.090272137015e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 95489.47
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109027.21
  [DEBUG]   S×d_nominal = 204516.68
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 204516.68 + -109027.21 = 95489.47
  [DEBUG]   Current θ from Master = 110906.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15417.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25484.39
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3409.3945, Absolute Gap = 3409.3945, Relative Gap = 0.338663
  Not converged yet (gap = 3409.39 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308178 nonzeros
Model fingerprint: 0x579415f4
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 48116 rows and 19536 columns
Presolve time: 1.09s
Presolved: 60297 rows, 26404 columns, 374859 nonzeros
Variable types: 24145 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -184823.6323

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60297 rows, 26404 columns, 374859 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37386   -3.8848096e+04   0.000000e+00   2.563323e+06      5s
   47225   -1.7624279e+04   0.000000e+00   1.627369e+06     10s
   56750   -1.8284575e+03   0.000000e+00   1.603379e+06     15s
   64233   -7.8918826e+02   0.000000e+00   5.855207e+06     20s
   71532    6.1234534e+02   0.000000e+00   4.912272e+05     25s
   78614    1.6372751e+03   0.000000e+00   5.312469e+06     30s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 8.307118e+03, 53407 iterations, 33.30 seconds (66.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8307.11783    0  232 -184823.63 8307.11783   104%     -   34s
H    0     0                    -178963.6501 8307.11783   105%     -   34s
H    0     0                    -101712.3135 8307.11783   108%     -   35s
H    0     0                    -69826.59024 8307.11783   112%     -   35s
H    0     0                    -68099.87505 8307.11783   112%     -   35s
H    0     0                    -63944.34339 8307.11783   113%     -   35s
H    0     0                    -39931.28355 8307.11783   121%     -   35s
H    0     0                    -31103.70226 8307.11783   127%     -   35s
H    0     0                    -27409.71861 8307.11783   130%     -   35s
H    0     0                    -19595.04518 8307.11783   142%     -   35s
H    0     0                    -15627.68989 8307.11783   153%     -   35s
H    0     0                    -15596.05099 8307.11783   153%     -   35s
H    0     0                    -15510.50483 8307.11783   154%     -   35s
H    0     0                    -15500.66809 8307.11783   154%     -   35s
H    0     0                    -15500.56813 8307.11783   154%     -   35s
H    0     0                    -14935.91500 8307.11783   156%     -   36s
H    0     0                    -13940.58103 8307.11783   160%     -   36s
H    0     0                    -13940.03104 8307.11783   160%     -   36s
H    0     0                    -13922.02604 8307.11783   160%     -   36s
H    0     0                    -13875.61584 8307.11783   160%     -   36s
H    0     0                    -13836.16948 8307.11783   160%     -   36s
H    0     0                    -13833.96934 8307.11783   160%     -   36s
H    0     0                    -13832.69439 8307.11783   160%     -   36s
H    0     0                    -13820.92243 8307.11783   160%     -   36s
     0     0 4132.23019    0  429 -13820.922 4132.23019   130%     -   57s
H    0     0                    -13814.84362 4132.23019   130%     -   57s
H    0     0                    -13809.11755 4132.23019   130%     -   57s
     0     0 4132.23019    0  431 -13809.118 4132.23019   130%     -   61s
     0     0 4132.23019    0  428 -13809.118 4132.23019   130%     -   61s
     0     0 4132.23019    0  428 -13809.118 4132.23019   130%     -   61s
     0     0 4132.23019    0  432 -13809.118 4132.23019   130%     -   62s
     0     0 4132.23019    0  434 -13809.118 4132.23019   130%     -   62s
     0     0 4132.23019    0  441 -13809.118 4132.23019   130%     -   63s
     0     0 4132.23019    0  441 -13809.118 4132.23019   130%     -   63s
H    0     0                    -13708.12137 1911.80808   114%     -   79s
H    0     0                    -13701.24216 1911.80808   114%     -   79s
     0     0 1873.25800    0  425 -13701.242 1873.25800   114%     -   79s
H    0     0                    -11502.65502 1873.25800   116%     -   79s
H    0     0                    -11404.41185 1873.25800   116%     -   79s
     0     0 1310.10314    0  500 -11404.412 1310.10314   111%     -   84s
     0     0 1223.88805    0  498 -11404.412 1223.88805   111%     -   87s
     0     0 1190.57979    0  497 -11404.412 1190.57979   110%     -   89s
     0     0 1179.78459    0  500 -11404.412 1179.78459   110%     -   90s
     0     0 1175.39774    0  501 -11404.412 1175.39774   110%     -   91s
     0     0 1173.01141    0  498 -11404.412 1173.01141   110%     -   92s
     0     0 1171.35509    0  499 -11404.412 1171.35509   110%     -   92s
     0     0 1170.62837    0  499 -11404.412 1170.62837   110%     -   92s
H    0     0                    -10532.21433 1170.62837   111%     -   95s
H    0     0                    -10526.64992 1170.62837   111%     -   95s
H    0     0                    -10521.85789 1170.62837   111%     -   95s
H    0     0                    -10521.26971 1170.62837   111%     -   95s
H    0     0                    -10519.68559 1170.62837   111%     -   95s
H    0     0                    -10517.69969 1170.62837   111%     -   95s
H    0     0                    -10513.48331 1170.62837   111%     -   95s
     0     0  358.21980    0  435 -10513.483  358.21980   103%     -  106s
H    0     0                    -10499.61627  357.96926   103%     -  107s
H    0     0                    -10486.92153  357.96926   103%     -  107s
     0     0 -131.72848    0  438 -10486.922 -131.72848  98.7%     -  114s
     0     0 -259.83531    0  445 -10486.922 -259.83531  97.5%     -  117s
     0     0 -301.68228    0  462 -10486.922 -301.68228  97.1%     -  119s
     0     0 -315.26694    0  454 -10486.922 -315.26694  97.0%     -  120s
     0     0 -328.40499    0  453 -10486.922 -328.40499  96.9%     -  121s
     0     0 -354.56722    0  479 -10486.922 -354.56722  96.6%     -  122s
     0     0 -369.68751    0  472 -10486.922 -369.68751  96.5%     -  123s
     0     0 -380.67213    0  465 -10486.922 -380.67213  96.4%     -  123s
     0     0 -381.95866    0  471 -10486.922 -381.95866  96.4%     -  123s
     0     0 -388.04080    0  475 -10486.922 -388.04080  96.3%     -  124s
     0     0 -390.05689    0  474 -10486.922 -390.05689  96.3%     -  124s
     0     0 -393.17478    0  470 -10486.922 -393.17478  96.3%     -  125s
     0     0 -395.95373    0  471 -10486.922 -395.95373  96.2%     -  125s
     0     0 -396.20044    0  475 -10486.922 -396.20044  96.2%     -  125s
     0     0 -907.77036    0  462 -10486.922 -907.77036  91.3%     -  136s
     0     0 -1007.2419    0  387 -10486.922 -1007.2419  90.4%     -  138s
     0     0 -1148.7494    0  476 -10486.922 -1148.7494  89.0%     -  142s
     0     0 -1187.1476    0  553 -10486.922 -1187.1476  88.7%     -  143s
     0     0 -1208.7663    0  479 -10486.922 -1208.7663  88.5%     -  145s
     0     0 -1232.8048    0  476 -10486.922 -1232.8048  88.2%     -  145s
     0     0 -1241.0763    0  478 -10486.922 -1241.0763  88.2%     -  146s
     0     0 -1244.4980    0  552 -10486.922 -1244.4980  88.1%     -  147s
     0     0 -1245.5557    0  555 -10486.922 -1245.5557  88.1%     -  147s
     0     0 -1382.4025    0  556 -10486.922 -1382.4025  86.8%     -  151s
     0     0 -1397.4065    0  554 -10486.922 -1397.4065  86.7%     -  153s
     0     0 -1408.2774    0  562 -10486.922 -1408.2774  86.6%     -  154s
     0     0 -1409.8632    0  561 -10486.922 -1409.8632  86.6%     -  154s
     0     0 -1410.4671    0  562 -10486.922 -1410.4671  86.6%     -  154s
     0     0 -1466.5600    0  492 -10486.922 -1466.5600  86.0%     -  157s
     0     0 -1477.4329    0  497 -10486.922 -1477.4329  85.9%     -  159s
     0     0 -1482.0383    0  509 -10486.922 -1482.0383  85.9%     -  159s
     0     0 -1484.2421    0  509 -10486.922 -1484.2421  85.8%     -  160s
     0     0 -1484.6256    0  511 -10486.922 -1484.6256  85.8%     -  160s
     0     0 -1503.5357    0  495 -10486.922 -1503.5357  85.7%     -  162s
     0     0 -1515.4534    0  494 -10486.922 -1515.4534  85.5%     -  163s
     0     0 -1518.9450    0  496 -10486.922 -1518.9450  85.5%     -  163s
     0     0 -1527.8067    0  496 -10486.922 -1527.8067  85.4%     -  164s
     0     0 -1528.3491    0  490 -10486.922 -1528.3491  85.4%     -  164s
H    0     0                    -10425.31583 -1539.4760  85.2%     -  166s
H    0     0                    -10403.87731 -1539.4760  85.2%     -  166s
     0     0 -1539.4760    0  508 -10403.877 -1539.4760  85.2%     -  166s
     0     0 -1540.5942    0  505 -10403.877 -1540.5942  85.2%     -  167s
     0     0 -1573.3377    0  545 -10403.877 -1573.3377  84.9%     -  170s
     0     0 -1578.5980    0  559 -10403.877 -1578.5980  84.8%     -  171s
     0     0 -1582.5658    0  505 -10403.877 -1582.5658  84.8%     -  172s
     0     0 -1583.5139    0  504 -10403.877 -1583.5139  84.8%     -  172s
     0     0 -1590.4924    0  579 -10403.877 -1590.4924  84.7%     -  174s
H    0     0                    -10394.54084 -1590.8924  84.7%     -  174s
     0     0 -1591.3867    0  575 -10394.541 -1591.3867  84.7%     -  175s
     0     0 -1599.2448    0  562 -10394.541 -1599.2448  84.6%     -  177s
     0     0 -1600.9924    0  574 -10394.541 -1600.9924  84.6%     -  178s
     0     0 -1601.3847    0  567 -10394.541 -1601.3847  84.6%     -  178s
     0     0 -1608.9205    0  571 -10394.541 -1608.9205  84.5%     -  180s
     0     0 -1611.7334    0  504 -10394.541 -1611.7334  84.5%     -  181s
     0     0 -1612.2591    0  589 -10394.541 -1612.2591  84.5%     -  181s
     0     0 -1616.0287    0  586 -10394.541 -1616.0287  84.5%     -  182s
     0     0 -1616.5841    0  586 -10394.541 -1616.5841  84.4%     -  184s
H    0     0                    -10345.75985 -1616.5841  84.4%     -  210s
     0     2 -1616.5841    0  586 -10345.760 -1616.5841  84.4%     -  212s
     1     3 -2554.9542    1  424 -10345.760 -1616.5841  84.4%  5621  216s
     2     6 -2753.0698    2  422 -10345.760 -1616.5841  84.4%  4846  220s
     5    12 -2906.1772    3  430 -10345.760 -1954.9116  81.1%  4142  226s
    11    24 -3009.0632    4  431 -10345.760 -2107.7510  79.6%  5155  232s
    23    39 -6519.5208    5  166 -10345.760 -2306.9527  77.7%  6495  244s
    38    71 -3399.2698    6  459 -10345.760 -2307.1254  77.7%  8939  274s
    70   166 -3504.9751    7  509 -10345.760 -2455.9739  76.3%  7653  284s
   167   252 -3530.2108    8  505 -10345.760 -2455.9739  76.3%  5021  290s
   278   282 -3899.9039   10  495 -10345.760 -2455.9739  76.3%  3658  298s
   362   293 -3958.1521   11  494 -10345.760 -2455.9739  76.3%  3267  305s
   432   306 -4360.6901   12  411 -10345.760 -2455.9739  76.3%  3201  313s
   496   329 -5691.9818   11  165 -10345.760 -2455.9739  76.3%  3298  320s
   533   362 -6415.6581   12  155 -10345.760 -2455.9739  76.3%  3432  328s
   574   387 -7181.1412   12  161 -10345.760 -2455.9739  76.3%  3597  335s
   611   413 -8748.7847   13  153 -10345.760 -2455.9739  76.3%  3711  342s
   661   443 -8988.6189   14  141 -10345.760 -2455.9739  76.3%  3653  351s
   711   474 -9835.6001   16  155 -10345.760 -2455.9739  76.3%  3706  358s
   768   508 -8878.5180   19  112 -10345.760 -2455.9739  76.3%  3719  366s
   822   515 -9253.8109   20  195 -10345.760 -2455.9739  76.3%  3729  373s
   890   527 -9256.4357   21  102 -10345.760 -2455.9739  76.3%  3655  381s
   948   546 -10126.617   23  248 -10345.760 -2455.9739  76.3%  3662  389s
   997   572     cutoff   25      -10345.760 -2455.9739  76.3%  3767  397s
  1033   604 -7010.6773    7  314 -10345.760 -2455.9739  76.3%  3892  405s
  1075   632 -7336.3317    8  312 -10345.760 -2455.9739  76.3%  3966  413s
  1133   665     cutoff    9      -10345.760 -2455.9739  76.3%  3990  420s
  1202   691 -7385.2682    9  300 -10345.760 -2455.9739  76.3%  3989  427s
  1287   702 -7471.5661    8  298 -10345.760 -2455.9739  76.3%  3929  436s
  1362   729 -8458.8830   10  131 -10345.760 -2455.9739  76.3%  3971  445s
  1429   748 -9937.3205   13  126 -10345.760 -2725.4906  73.7%  3959  455s
  1468   772     cutoff   11      -10345.760 -2725.4906  73.7%  4023  464s
  1520   781     cutoff   19      -10345.760 -2725.4906  73.7%  4031  473s
  1611   784 -9598.0267   21  172 -10345.760 -2725.4906  73.7%  3947  483s
  1681   810     cutoff   22      -10345.760 -2725.4906  73.7%  3982  493s
  1745   835     cutoff   24      -10345.760 -2725.4906  73.7%  4065  504s
  1812   878 -4531.0535    8  436 -10345.760 -3057.0457  70.5%  4148  514s
  1873   929 -5877.5203    9  329 -10345.760 -3057.0457  70.5%  4176  525s
  1990   963 -8833.4261   11  130 -10345.760 -3057.0457  70.5%  4147  537s
  2103  1012 -8695.7993   10  311 -10345.760 -3232.2894  68.8%  4142  548s
  2255  1042 -9361.4859   11  289 -10345.760 -3232.2894  68.8%  4069  561s
  2380  1091     cutoff   13      -10345.760 -3232.2894  68.8%  4051  573s
  2506  1139     cutoff   12      -10345.760 -3275.0986  68.3%  4065  585s
  2639  1172 -4942.0307    8  355 -10345.760 -3275.0986  68.3%  4057  597s
  2786  1212 -7850.8974   10  294 -10345.760 -3543.8518  65.7%  4023  611s
  2913  1261 -9614.3818   13  267 -10345.760 -3744.0681  63.8%  4058  627s
  3028  1303     cutoff   13      -10345.760 -4144.0894  59.9%  4116  640s
  3189  1360 -7638.5989   12  297 -10345.760 -4144.0894  59.9%  4130  655s
  3354  1377 -9537.9355   14  242 -10345.760 -4144.0894  59.9%  4134  667s
  3401  1403 -10150.313   15  221 -10345.760 -4144.0894  59.9%  4165  682s
  3457  1428     cutoff   16      -10345.760 -4144.0894  59.9%  4182  696s
  3549  1458 -5722.7353   13  492 -10345.760 -4144.0894  59.9%  4199  712s
  3663  1515 -6082.0969   14  384 -10345.760 -4184.6916  59.6%  4220  732s
  3810  1546 -7050.5196   15  305 -10345.760 -4388.4433  57.6%  4262  749s
  3999  1606 -8272.6584   18  200 -10345.760 -4388.4433  57.6%  4238  766s
  4161  1669 -9576.2933   23  150 -10345.760 -4404.5869  57.4%  4263  785s
  4362  1719 -7309.3806   13  320 -10345.760 -4404.5869  57.4%  4266  805s
  4565  1768 -9461.3304   18  167 -10345.760 -4829.8338  53.3%  4289  827s
  4831  1842 -8835.1068   14  157 -10345.760 -4829.8338  53.3%  4263  849s
  5108  1877 infeasible   21      -10345.760 -5158.2059  50.1%  4239  868s
  5303  1918 infeasible   11      -10345.760 -5174.0868  50.0%  4245  890s
  5610  1942 -10137.836   16   43 -10345.760 -5251.3394  49.2%  4220  916s
  5842  1985 -8479.8174   16  269 -10345.760 -5484.7878  47.0%  4220  939s
  6167  2038 -6567.1096   14  308 -10345.760 -5659.8202  45.3%  4191  964s
  6428  2124 -9847.2244   22   57 -10345.760 -5659.8202  45.3%  4186  997s
  6775  2159     cutoff    9      -10345.760 -5822.3005  43.7%  4156 1019s
  6917  2221 -6948.5511   19  398 -10345.760 -5822.3005  43.7%  4146 1044s
  7228  2254 -9455.9914   26  192 -10345.760 -5822.3005  43.7%  4119 1072s
  7555  2280 -8211.3453   21  304 -10345.760 -6096.5297  41.1%  4135 1102s
  7895  2276 -9300.8905   16  250 -10345.760 -6210.7385  40.0%  4156 1132s
  8209  2258 -9517.5376   12  298 -10345.760 -6269.0144  39.4%  4165 1163s
  8620  2290     cutoff   17      -10345.760 -6420.9154  37.9%  4153 1193s
  9032  2283 -9364.7204   15  410 -10345.760 -6618.7514  36.0%  4159 1227s
  9549  2253 -9648.0063   13  103 -10345.760 -6782.9599  34.4%  4132 1258s
  9972  2189 -9119.6270   26  230 -10345.760 -6850.5488  33.8%  4114 1293s
 10397  2148 -9490.9497   11  426 -10345.760 -7008.7078  32.3%  4133 1328s
 10982  2074 -8467.5493   22  372 -10345.760 -7207.3107  30.3%  4110 1370s
 11558  2063 infeasible   15      -10345.760 -7346.0012  29.0%  4092 1412s
 12122  1941     cutoff   21      -10345.760 -7497.3140  27.5%  4082 1448s
 12801  1917 -9384.4771   19  218 -10345.760 -7807.6043  24.5%  4045 1493s
 13390  1810     cutoff   14      -10345.760 -7919.7673  23.4%  4039 1537s
 14116  1735 -9574.9603   15  112 -10345.760 -8114.4418  21.6%  4008 1582s
 14328  1590 -10155.010   24   77 -10345.760 -8197.0982  20.8%  3994 1625s
 14900  1352 -8819.2449   25  438 -10345.760 -8260.2506  20.2%  3953 1672s
 15875   939     cutoff   12      -10345.760 -8508.8229  17.8%  3878 1716s
 17035   318     cutoff   23      -10345.760 -8736.9048  15.6%  3759 1757s
 18640     0     cutoff   22      -10345.760 -9300.9809  10.1%  3563 1778s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 22
  MIR: 938
  Flow cover: 1894
  RLT: 39
  Relax-and-lift: 113

Explored 19375 nodes (67137676 simplex iterations) in 1778.28 seconds (5659.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10345.8 -10394.5 -10403.9 ... -10521.3
No other solutions better than -10345.8

Optimal solution found (tolerance 1.00e-06)
Best objective -1.034575985392e+04, best bound -1.034575985392e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1778.39s
  Master Objective (UB) = -10345.76, θ = 111781.39
  Upper Bound (UB) = -10345.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111781.39
  [DEBUG]   ✓ Scenario 0: θ = 111781.39 ≤ Q = 111781.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111781.39 ≤ Q = 111781.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 111781.39 ≤ Q = 111781.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 111781.39 ≤ Q = 111781.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 111781.39 ≤ Q = 111781.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 111781.39 ≤ Q = 111781.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 111781.39 ≤ Q = 111781.39 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x306eb1f0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcf914e10
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.181751e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 5917293.1588
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.235773e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123577.28    0  123 5917293.16 -123577.28   102%     -    0s
H    0     0                    -88381.94377 -123577.28  39.8%     -    0s
H    0     0                    -89310.96162 -123577.28  38.4%     -    0s
H    0     0                    -90183.07009 -102361.11  13.5%     -    0s
H    0     0                    -91359.33559 -102361.11  12.0%     -    0s
     0     0 -102361.11    0  125 -91359.336 -102361.11  12.0%     -    0s
H    0     0                    -97230.90184 -102351.73  5.27%     -    0s
     0     0 -101650.98    0  129 -97230.902 -101650.98  4.55%     -    0s
H    0     0                    -99625.55832 -101639.68  2.02%     -    0s
     0     0 -101613.98    0  129 -99625.558 -101613.98  2.00%     -    0s
H    0     0                    -99678.47374 -101613.98  1.94%     -    0s
H    0     0                    -99680.92085 -101319.38  1.64%     -    0s
     0     0 -101319.38    0  110 -99680.921 -101319.38  1.64%     -    0s
H    0     0                    -99881.91611 -101257.16  1.38%     -    0s
     0     0 -101257.16    0  119 -99881.916 -101257.16  1.38%     -    0s
     0     0 -101239.74    0  125 -99881.916 -101239.74  1.36%     -    0s
     0     0 -101229.21    0  100 -99881.916 -101229.21  1.35%     -    0s
     0     0 -101145.97    0   92 -99881.916 -101145.97  1.27%     -    0s
     0     0 -101112.70    0  117 -99881.916 -101112.70  1.23%     -    0s
H    0     0                    -99959.43035 -101112.70  1.15%     -    0s
     0     0 -100999.44    0  118 -99959.430 -100999.44  1.04%     -    0s
     0     0 -100997.05    0  118 -99959.430 -100997.05  1.04%     -    0s
     0     2 -100996.41    0  118 -99959.430 -100996.41  1.04%     -    0s
H   30    21                    -99991.79977 -100789.22  0.80%  17.3    0s
H   35    21                    -100077.0763 -100778.83  0.70%  15.6    0s
H  267   153                    -100119.1672 -100610.03  0.49%   7.2    0s
H  284   153                    -100170.7167 -100610.03  0.44%   7.2    0s
H  304   153                    -100193.3115 -100602.49  0.41%   7.2    0s
* 1691    57              26    -100196.0849 -100400.25  0.20%   5.1    0s

Cutting planes:
  Gomory: 40
  MIR: 218
  Flow cover: 11
  RLT: 36
  Relax-and-lift: 4
  BQP: 1

Explored 1954 nodes (10761 simplex iterations) in 0.26 seconds (0.29 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -100196 -100193 -100171 ... -99678.5
No other solutions better than -100196

Optimal solution found (tolerance 1.00e-06)
Best objective -1.001960848976e+05, best bound -1.001960848976e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 103128.41
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100196.08
  [DEBUG]   S×d_nominal = 203324.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 203324.50 + -100196.08 = 103128.41
  [DEBUG]   Current θ from Master = 111781.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8652.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18998.74
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3130.8561, Absolute Gap = 3130.8561, Relative Gap = 0.302622
  Not converged yet (gap = 3130.86 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351415 nonzeros
Model fingerprint: 0xf2a6593d
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54984 rows and 22324 columns
Presolve time: 1.13s
Presolved: 68719 rows, 29856 columns, 427639 nonzeros
Variable types: 27597 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -184823.6323

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68719 rows, 29856 columns, 427639 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35379   -7.6560486e+04   0.000000e+00   6.582107e+07      5s
   47725   -2.2510144e+04   0.000000e+00   2.528124e+07     10s
   56841   -3.7073894e+03   0.000000e+00   7.617611e+07     15s
   64302   -8.1731431e+02   0.000000e+00   8.564265e+06     20s
   70358    9.4036718e+02   0.000000e+00   1.858838e+07     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 8.307118e+03, 51123 iterations, 26.72 seconds (56.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8307.11783    0  232 -184823.63 8307.11783   104%     -   28s
H    0     0                    -173501.0216 8307.11783   105%     -   28s
H    0     0                    -93108.08937 8307.11783   109%     -   28s
H    0     0                    -92868.17026 8307.11783   109%     -   28s
H    0     0                    -92843.37323 8307.11783   109%     -   28s
H    0     0                    -92836.52081 8307.11783   109%     -   28s
H    0     0                    -92829.88138 8307.11783   109%     -   28s
H    0     0                    -92764.47239 8307.11783   109%     -   28s
H    0     0                    -92763.16672 8307.11783   109%     -   28s
H    0     0                    -86008.91011 8307.11783   110%     -   29s
H    0     0                    -32392.12838 8307.11783   126%     -   29s
H    0     0                    -28221.39839 8307.11783   129%     -   29s
H    0     0                    -19414.41222 8307.11783   143%     -   29s
H    0     0                    -16941.10795 8307.11783   149%     -   29s
H    0     0                    -16910.82604 8307.11783   149%     -   29s
H    0     0                    -16848.22032 8307.11783   149%     -   29s
H    0     0                    -16842.07698 8307.11783   149%     -   29s
H    0     0                    -16016.37876 8307.11783   152%     -   30s
H    0     0                    -15441.01346 8307.11783   154%     -   30s
H    0     0                    -15388.55160 8307.11783   154%     -   30s
H    0     0                    -15387.19297 8307.11783   154%     -   30s
H    0     0                    -15378.40775 8307.11783   154%     -   30s
H    0     0                    -14981.04643 4682.98597   131%     -   45s
H    0     0                    -14734.64174 4682.98597   132%     -   45s
     0     0 4550.94729    0  413 -14734.642 4550.94729   131%     -   45s
     0     0 4479.75615    0  425 -14734.642 4479.75615   130%     -   50s
     0     0 4479.75615    0  423 -14734.642 4479.75615   130%     -   51s
     0     0 4479.75615    0  427 -14734.642 4479.75615   130%     -   52s
     0     0 4479.75615    0  431 -14734.642 4479.75615   130%     -   54s
     0     0 4479.75615    0  427 -14734.642 4479.75615   130%     -   54s
     0     0 4479.75615    0  442 -14734.642 4479.75615   130%     -   56s
     0     0 4479.75615    0  443 -14734.642 4479.75615   130%     -   56s
H    0     0                    -14690.50616 1824.67637   112%     -   71s
H    0     0                    -14669.67350 1824.67637   112%     -   71s
H    0     0                    -14642.52154 1824.67637   112%     -   71s
H    0     0                    -14635.16910 1824.67637   112%     -   71s
H    0     0                    -14634.75865 1824.67637   112%     -   71s
H    0     0                    -14624.79124 1824.67637   112%     -   71s
     0     0 1824.67637    0  441 -14624.791 1824.67637   112%     -   71s
H    0     0                    -11491.68049 1823.86285   116%     -   71s
H    0     0                    -11484.73566 1823.86285   116%     -   72s
H    0     0                    -11480.61372 1823.86285   116%     -   72s
H    0     0                    -11467.74661 1823.86285   116%     -   72s
H    0     0                    -11465.77216 1823.86285   116%     -   72s
     0     0 1524.14862    0  465 -11465.772 1524.14862   113%     -   76s
     0     0 1501.43102    0  475 -11465.772 1501.43102   113%     -   77s
     0     0 1416.44949    0  480 -11465.772 1416.44949   112%     -   81s
     0     0 1412.08932    0  479 -11465.772 1412.08932   112%     -   81s
     0     0 1393.87604    0  476 -11465.772 1393.87604   112%     -   81s
     0     0 1392.38186    0  477 -11465.772 1392.38186   112%     -   82s
     0     0 1389.64419    0  480 -11465.772 1389.64419   112%     -   82s
     0     0 1370.89025    0  474 -11465.772 1370.89025   112%     -   83s
     0     0 1365.79157    0  478 -11465.772 1365.79157   112%     -   84s
     0     0 1365.44139    0  478 -11465.772 1365.44139   112%     -   84s
     0     0   62.85824    0  465 -11465.772   62.85824   101%     -  100s
H    0     0                    -10814.92001 -430.35914  96.0%     -  109s
H    0     0                    -10671.01805 -430.35914  96.0%     -  109s
H    0     0                    -10647.50122 -430.35914  96.0%     -  109s
H    0     0                    -10645.16172 -430.35914  96.0%     -  109s
H    0     0                    -10635.47472 -430.35914  96.0%     -  109s
H    0     0                    -10630.31899 -430.35914  96.0%     -  109s
H    0     0                    -10627.19451 -430.35914  96.0%     -  109s
H    0     0                    -10618.99457 -430.35914  95.9%     -  109s
H    0     0                    -10587.72825 -430.35914  95.9%     -  109s
H    0     0                    -10573.13725 -430.35914  95.9%     -  109s
H    0     0                    -10568.21330 -430.35914  95.9%     -  109s
H    0     0                    -10563.25226 -430.35914  95.9%     -  109s
H    0     0                    -10559.20224 -430.35914  95.9%     -  109s
H    0     0                    -10558.23480 -430.35914  95.9%     -  109s
     0     0 -430.35914    0  509 -10558.235 -430.35914  95.9%     -  109s
     0     0 -515.17460    0  503 -10558.235 -515.17460  95.1%     -  112s
     0     0 -553.70466    0  516 -10558.235 -553.70466  94.8%     -  114s
     0     0 -600.00480    0  520 -10558.235 -600.00480  94.3%     -  117s
     0     0 -618.68236    0  531 -10558.235 -618.68236  94.1%     -  118s
     0     0 -631.75600    0  537 -10558.235 -631.75600  94.0%     -  119s
     0     0 -634.76196    0  534 -10558.235 -634.76196  94.0%     -  119s
     0     0 -636.72835    0  532 -10558.235 -636.72835  94.0%     -  120s
     0     0 -643.14360    0  537 -10558.235 -643.14360  93.9%     -  120s
     0     0 -643.29183    0  539 -10558.235 -643.29183  93.9%     -  121s
     0     0 -1021.7881    0  521 -10558.235 -1021.7881  90.3%     -  130s
H    0     0                    -10551.17320 -1112.1397  89.5%     -  134s
H    0     0                    -10550.37178 -1112.1397  89.5%     -  134s
     0     0 -1112.1397    0  530 -10550.372 -1112.1397  89.5%     -  134s
     0     0 -1210.7420    0  546 -10550.372 -1210.7420  88.5%     -  139s
     0     0 -1241.4723    0  548 -10550.372 -1241.4723  88.2%     -  141s
     0     0 -1250.3405    0  556 -10550.372 -1250.3405  88.1%     -  142s
     0     0 -1256.5096    0  555 -10550.372 -1256.5096  88.1%     -  142s
     0     0 -1261.8036    0  559 -10550.372 -1261.8036  88.0%     -  143s
     0     0 -1266.2470    0  564 -10550.372 -1266.2470  88.0%     -  144s
     0     0 -1267.3762    0  564 -10550.372 -1267.3762  88.0%     -  144s
     0     0 -1460.5492    0  536 -10550.372 -1460.5492  86.2%     -  150s
     0     0 -1487.6145    0  537 -10550.372 -1487.6145  85.9%     -  153s
     0     0 -1495.3896    0  541 -10550.372 -1495.3896  85.8%     -  153s
     0     0 -1505.9251    0  556 -10550.372 -1505.9251  85.7%     -  154s
     0     0 -1508.6637    0  558 -10550.372 -1508.6637  85.7%     -  155s
     0     0 -1509.5433    0  561 -10550.372 -1509.5433  85.7%     -  155s
     0     0 -1585.1785    0  547 -10550.372 -1585.1785  85.0%     -  160s
     0     0 -1604.4528    0  557 -10550.372 -1604.4528  84.8%     -  163s
     0     0 -1606.4379    0  565 -10550.372 -1606.4379  84.8%     -  164s
     0     0 -1607.0695    0  565 -10550.372 -1607.0695  84.8%     -  164s
     0     0 -1629.9808    0  564 -10550.372 -1629.9808  84.6%     -  167s
     0     0 -1647.1455    0  573 -10550.372 -1647.1455  84.4%     -  170s
     0     0 -1651.9417    0  580 -10550.372 -1651.9417  84.3%     -  171s
     0     0 -1653.3148    0  577 -10550.372 -1653.3148  84.3%     -  171s
     0     0 -1653.8495    0  578 -10550.372 -1653.8495  84.3%     -  172s
     0     0 -1669.0738    0  577 -10550.372 -1669.0738  84.2%     -  174s
     0     0 -1670.6150    0  593 -10550.372 -1670.6150  84.2%     -  176s
     0     0 -1671.6220    0  583 -10550.372 -1671.6220  84.2%     -  177s
     0     0 -1687.7587    0  502 -10550.372 -1687.7587  84.0%     -  179s
     0     0 -1691.5015    0  588 -10550.372 -1691.5015  84.0%     -  181s
     0     0 -1692.4702    0  584 -10550.372 -1692.4702  84.0%     -  181s
     0     0 -1701.7526    0  586 -10550.372 -1701.7526  83.9%     -  183s
     0     0 -1703.3690    0  585 -10550.372 -1703.3690  83.9%     -  185s
     0     0 -1703.6168    0  588 -10550.372 -1703.6168  83.9%     -  185s
     0     0 -1709.2546    0  584 -10550.372 -1709.2546  83.8%     -  187s
     0     0 -1711.2920    0  601 -10550.372 -1711.2920  83.8%     -  188s
     0     0 -1712.1678    0  608 -10550.372 -1712.1678  83.8%     -  189s
     0     0 -1714.4346    0  596 -10550.372 -1714.4346  83.8%     -  190s
H    0     0                    -10546.46352 -1715.7794  83.7%     -  196s
     0     0 -1715.7794    0  598 -10546.464 -1715.7794  83.7%     -  196s
     0     0 -1718.2645    0  597 -10546.464 -1718.2645  83.7%     -  198s
     0     0 -1718.8946    0  597 -10546.464 -1718.8946  83.7%     -  199s
     0     2 -1718.8946    0  597 -10546.464 -1718.8946  83.7%     -  240s
     1     4 -1889.4489    1  562 -10546.464 -1718.8946  83.7%  4895  246s
     3     8 -1938.3288    2  575 -10546.464 -1890.2302  82.1%  5365  255s
     7    16 -1991.4065    3  591 -10546.464 -1939.8685  81.6%  7156  262s
    15    32 -2116.4923    4  578 -10546.464 -1991.5324  81.1%  5482  269s
    31    48 -3345.9550    5  375 -10546.464 -2116.5097  79.9%  8470  285s
H   47    80                    -10545.50410 -2116.5097  79.9%  8799  294s
H   49    80                    -10537.37503 -2116.5097  79.9%  8553  294s
H   58    80                    -10533.05540 -2116.5097  79.9%  8198  294s
H   61    80                    -10531.47128 -2116.5097  79.9%  8034  294s
    79   164 -5838.6879    7  415 -10531.471 -2116.5097  79.9%  7351  307s
   163   254 -5842.8598    8  416 -10531.471 -2116.5097  79.9%  6455  315s
   263   329 -6027.1818    9  403 -10531.471 -2116.5097  79.9%  4926  322s
   367   350 -6389.1677   10  253 -10531.471 -2132.1368  79.8%  4056  330s
   450   378 -6983.0544    9  229 -10531.471 -2132.1368  79.8%  3674  337s
   516   399 -7310.0712   10  483 -10531.471 -2132.6865  79.7%  3542  345s
   553   437 -7365.4183    9  227 -10531.471 -2132.6865  79.7%  3506  355s
   615   459 -7171.6370   11  230 -10531.471 -2132.6865  79.7%  3375  363s
   653   472 -7893.8988   12  327 -10531.471 -2132.6865  79.7%  3320  371s
   710   474 -7789.7147   11  242 -10531.471 -2132.6865  79.7%  3215  378s
   766   483 -8134.9984   11  324 -10531.471 -2132.6865  79.7%  3137  386s
   819   498 -8835.3055   12  218 -10531.471 -2132.6865  79.7%  3108  394s
   860   514 -8730.2383   13  225 -10531.471 -2132.6865  79.7%  3086  402s
   908   526 -9437.3717   14  209 -10531.471 -2399.7439  77.2%  3054  410s
   954   537 -9755.5684   14  188 -10531.471 -2399.7439  77.2%  3031  418s
  1010   548 -10279.359   13  234 -10531.471 -2399.7439  77.2%  3014  426s
  1064   543 -9693.0694   15  229 -10531.471 -2399.7439  77.2%  2963  434s
  1125   559 -9624.1063   14  340 -10531.471 -2399.7439  77.2%  2916  443s
  1175   584     cutoff   16      -10531.471 -2399.7439  77.2%  2900  452s
  1232   602 -6444.8248   14  376 -10531.471 -2479.5365  76.5%  2875  462s
  1294   607 -7069.4114   15  263 -10531.471 -2479.8758  76.5%  2846  472s
  1370   618 -7099.2350   16  289 -10531.471 -2479.8758  76.5%  2801  482s
  1433   630 -7422.7499   17  198 -10531.471 -2479.8758  76.5%  2813  493s
  1495   660 -8005.4846   20  167 -10531.471 -2479.8758  76.5%  2826  504s
  1555   693 -9162.1213   23   75 -10531.471 -2479.8758  76.5%  2818  515s
  1625   731     cutoff   29      -10531.471 -2479.8758  76.5%  2819  527s
  1719   772 -5671.1068    9  325 -10531.471 -2479.8758  76.5%  2793  538s
  1803   785 -6355.6357   10  329 -10531.471 -2479.8758  76.5%  2795  551s
  1896   811 -6698.7250   11  404 -10531.471 -2479.8758  76.5%  2792  567s
  2007   861 -6946.8913   10  240 -10531.471 -2479.8758  76.5%  2777  580s
  2137   885 -7456.3552   11  227 -10531.471 -2479.8758  76.5%  2740  596s
  2289   905 infeasible   11      -10531.471 -2479.8758  76.5%  2692  611s
  2392   917     cutoff   15      -10531.471 -3431.3892  67.4%  2704  624s
  2442   923 -6806.1442    6  188 -10531.471 -3431.3892  67.4%  2723  637s
  2494   940 -7067.6448    7  175 -10531.471 -4072.7247  61.3%  2730  650s
  2565   946 -7504.0229    8  171 -10531.471 -4072.7247  61.3%  2734  663s
H 2590   946                    -10486.75640 -4072.7247  61.2%  2733  663s
  2680   959 -7883.0236    9  162 -10486.756 -4072.7247  61.2%  2708  680s
  2825   998 -8369.7172   16  258 -10486.756 -4656.9563  55.6%  2716  699s
  2983  1024 -9029.9100   22  160 -10486.756 -4656.9563  55.6%  2723  718s
  3157  1082 -9854.2963   28  153 -10486.756 -4926.0159  53.0%  2721  737s
  3396  1096 -7291.9725   10  393 -10486.756 -4945.6194  52.8%  2696  755s
  3592  1135 -9866.7267   13  454 -10486.756 -5173.8400  50.7%  2706  772s
  3758  1135     cutoff   14      -10486.756 -5470.4960  47.8%  2721  794s
  3893  1158     cutoff   13      -10486.756 -5470.4960  47.8%  2734  817s
  4119  1193 -8872.8771    9  190 -10486.756 -5818.4337  44.5%  2713  840s
  4324  1211 -7514.8624   12  219 -10486.756 -5975.5813  43.0%  2714  864s
  4593  1225 -10242.841   19  165 -10486.756 -5984.5257  42.9%  2700  886s
  4861  1267 -10287.525   12  398 -10486.756 -6197.9401  40.9%  2701  908s
H 4907  1267                    -10482.29078 -6354.1888  39.4%  2692  908s
  5128  1278 infeasible   15      -10482.291 -6385.8650  39.1%  2696  934s
  5427  1282 -9938.3423   17   70 -10482.291 -6584.3933  37.2%  2678  960s
  5733  1300     cutoff   11      -10482.291 -6634.3799  36.7%  2675  986s
  6043  1292 -8680.6798   12  225 -10482.291 -6634.3799  36.7%  2678 1009s
H 6078  1292                    -10443.89450 -6634.3799  36.5%  2675 1009s
H 6189  1292                    -10407.80355 -6817.4855  34.5%  2676 1009s
  6217  1277     cutoff   14      -10407.804 -6817.4855  34.5%  2674 1040s
  6534  1277     cutoff   14      -10407.804 -6938.7199  33.3%  2682 1069s
  6925  1288     cutoff   15      -10407.804 -7103.4246  31.7%  2666 1092s
H 6926  1288                    -10396.30279 -7103.4246  31.7%  2666 1092s
H 6932  1288                    -10373.10289 -7103.4246  31.5%  2665 1092s
  6996  1244 -9439.6188   14  287 -10373.103 -7103.4246  31.5%  2666 1125s
  7442  1195 -9483.0043   11  312 -10373.103 -7220.7948  30.4%  2645 1159s
  7930  1103 -9526.9221   24  235 -10373.103 -7513.8261  27.6%  2623 1195s
  8473  1073     cutoff   13      -10373.103 -7724.4401  25.5%  2591 1228s
  8681   988     cutoff    9      -10373.103 -7724.4401  25.5%  2596 1280s
  9161   862     cutoff   14      -10373.103 -8060.9267  22.3%  2588 1317s
  9557   683 infeasible   16      -10373.103 -8146.6443  21.5%  2595 1355s
 10131   583     cutoff   11      -10373.103 -8466.7828  18.4%  2572 1392s
 10940   398 -10365.320   29  151 -10373.103 -8897.8310  14.2%  2487 1430s
 11878    68     cutoff   26      -10373.103 -9297.5251  10.4%  2387 1456s
 12728    25     cutoff   20      -10373.103 -9622.5907  7.24%  2286 1479s
 13083     0     cutoff   40      -10373.103 -10354.474  0.18%  2227 1480s

Cutting planes:
  Gomory: 2
  Implied bound: 36
  MIR: 865
  Flow cover: 1826
  RLT: 39
  Relax-and-lift: 175

Explored 13140 nodes (29386798 simplex iterations) in 1480.09 seconds (4312.31 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10373.1 -10396.3 -10407.8 ... -10545.5
No other solutions better than -10373.1

Optimal solution found (tolerance 1.00e-06)
Best objective -1.037310289446e+04, best bound -1.037310289446e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1480.15s
  Master Objective (UB) = -10373.10, θ = 113548.55
  Upper Bound (UB) = -10373.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113548.55
  [DEBUG]   ✓ Scenario 0: θ = 113548.55 ≤ Q = 113548.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113548.55 ≤ Q = 113548.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113548.55 ≤ Q = 113548.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113548.55 ≤ Q = 113548.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113548.55 ≤ Q = 113548.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113548.55 ≤ Q = 113548.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113548.55 ≤ Q = 113548.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113548.55 ≤ Q = 113548.55 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x32ce4aa9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcd31b557
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.181406e+13
Presolve removed 2596 rows and 1888 columns
Presolve time: 0.00s
Presolved: 497 rows, 501 columns, 1402 nonzeros
Found heuristic solution: objective 5984143.4085
Variable types: 338 continuous, 163 integer (163 binary)
Found heuristic solution: objective 5983806.2019

Root relaxation: objective -1.212615e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -121261.53    0  122 5983806.20 -121261.53   102%     -    0s
H    0     0                    -81343.90552 -121261.53  49.1%     -    0s
H    0     0                    -81544.23582 -98313.584  20.6%     -    0s
H    0     0                    -89519.30702 -98313.584  9.82%     -    0s
     0     0 -98313.584    0  128 -89519.307 -98313.584  9.82%     -    0s
H    0     0                    -94527.65546 -98261.365  3.95%     -    0s
H    0     0                    -95868.68960 -98261.365  2.50%     -    0s
     0     0 -97726.516    0  131 -95868.690 -97726.516  1.94%     -    0s
H    0     0                    -96211.53515 -97718.990  1.57%     -    0s
     0     0 -97703.930    0  130 -96211.535 -97703.930  1.55%     -    0s
H    0     0                    -96222.67671 -97299.938  1.12%     -    0s
     0     0 -97299.938    0  126 -96222.677 -97299.938  1.12%     -    0s
H    0     0                    -96237.54737 -97282.506  1.09%     -    0s
     0     0 -97282.506    0  126 -96237.547 -97282.506  1.09%     -    0s
     0     0 -97097.976    0  126 -96237.547 -97097.976  0.89%     -    0s
     0     0 -97044.252    0  124 -96237.547 -97044.252  0.84%     -    0s
     0     0 -97039.490    0  124 -96237.547 -97039.490  0.83%     -    0s
     0     0 -96693.992    0   79 -96237.547 -96693.992  0.47%     -    0s
H    0     0                    -96253.53235 -96692.945  0.46%     -    0s
     0     0 -96681.044    0   80 -96253.532 -96681.044  0.44%     -    0s
     0     0 -96634.156    0   74 -96253.532 -96634.156  0.40%     -    0s
     0     0 -96620.932    0   74 -96253.532 -96620.932  0.38%     -    0s
     0     2 -96620.932    0   74 -96253.532 -96620.932  0.38%     -    0s
H   35    10                    -96255.93708 -96489.542  0.24%   7.5    0s
H  254    98                    -96262.18383 -96317.287  0.06%   4.7    0s
*  681    16              35    -96262.68513 -96292.053  0.03%   4.5    0s
*  693    16              33    -96264.93064 -96292.053  0.03%   4.5    0s

Cutting planes:
  Gomory: 21
  Implied bound: 10
  MIR: 168
  Flow cover: 14
  RLT: 67
  Relax-and-lift: 5
  BQP: 2

Explored 751 nodes (4167 simplex iterations) in 0.13 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -96264.9 -96262.7 -96262.2 ... -89519.3
No other solutions better than -96264.9

Optimal solution found (tolerance 1.00e-06)
Best objective -9.626493064271e+04, best bound -9.626493064271e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 106531.18
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96264.93
  [DEBUG]   S×d_nominal = 202796.11
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202796.11 + -96264.93 = 106531.18
  [DEBUG]   Current θ from Master = 113548.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7017.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17390.47
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 3103.5131, Absolute Gap = 3103.5131, Relative Gap = 0.299188
  Not converged yet (gap = 3103.51 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394652 nonzeros
Model fingerprint: 0x4ea1584b
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61852 rows and 25112 columns
Presolve time: 1.13s
Presolved: 77141 rows, 33308 columns, 473219 nonzeros
Variable types: 31049 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77141 rows, 33308 columns, 473219 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33910   -1.3796919e+04   0.000000e+00   1.019381e+08      5s
   46428   -2.7408007e+03   0.000000e+00   3.651386e+06     10s
   54349    8.1505442e+02   0.000000e+00   6.336282e+06     15s
   62044    2.0834708e+03   0.000000e+00   9.317761e+06     20s
   68732    2.6576141e+03   0.000000e+00   3.341709e+06     25s
Concurrent spin time: 5.00s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.061727e+04, 60980 iterations, 32.88 seconds (64.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10617.2736    0  216 -196434.75 10617.2736   105%     -   34s
H    0     0                    -191173.4707 10617.2736   106%     -   34s
H    0     0                    -107020.1977 10617.2736   110%     -   34s
H    0     0                    -106992.0703 10617.2736   110%     -   34s
H    0     0                    -105042.0709 10617.2736   110%     -   34s
H    0     0                    -59088.83999 10617.2736   118%     -   35s
H    0     0                    -11695.54921 10617.2736   191%     -   35s
H    0     0                    -11617.62895 10617.2736   191%     -   35s
H    0     0                    -11353.45449 10617.2736   194%     -   35s
H    0     0                    -11264.48193 5824.28170   152%     -   46s
H    0     0                    -11218.22414 5824.28170   152%     -   46s
H    0     0                    -11218.05551 5824.28170   152%     -   46s
H    0     0                    -11217.42065 5824.28170   152%     -   46s
     0     0 5823.98055    0  280 -11217.421 5823.98055   152%     -   46s
     0     0 5387.13595    0  426 -11217.421 5387.13595   148%     -   54s
     0     0 5387.13595    0  433 -11217.421 5387.13595   148%     -   56s
     0     0 5387.13595    0  438 -11217.421 5387.13595   148%     -   56s
H    0     0                    -11210.37449 3048.83449   127%     -   67s
     0     0 3048.83449    0  357 -11210.374 3048.83449   127%     -   67s
     0     0 2552.77132    0  483 -11210.374 2552.77132   123%     -   75s
     0     0 2412.87361    0  493 -11210.374 2412.87361   122%     -   81s
     0     0 2284.22145    0  487 -11210.374 2284.22145   120%     -   88s
     0     0 2184.65088    0  473 -11210.374 2184.65088   119%     -   92s
     0     0 2167.28726    0  484 -11210.374 2167.28726   119%     -   93s
     0     0 2159.51075    0  497 -11210.374 2159.51075   119%     -   94s
     0     0 2113.34956    0  416 -11210.374 2113.34956   119%     -   96s
     0     0 2070.81982    0  429 -11210.374 2070.81982   118%     -   98s
     0     0 2064.43793    0  425 -11210.374 2064.43793   118%     -  100s
     0     0 2062.46231    0  431 -11210.374 2062.46231   118%     -  101s
     0     0 2062.34881    0  433 -11210.374 2062.34881   118%     -  101s
     0     0  -25.04812    0  516 -11210.374  -25.04812   100%     -  117s
     0     0 -803.73967    0  529 -11210.374 -803.73967  92.8%     -  125s
     0     0 -1074.4724    0  530 -11210.374 -1074.4724  90.4%     -  129s
H    0     0                    -11179.50305 -1154.9822  89.7%     -  132s
     0     0 -1154.9822    0  483 -11179.503 -1154.9822  89.7%     -  132s
     0     0 -1214.4535    0  551 -11179.503 -1214.4535  89.1%     -  134s
     0     0 -1236.0369    0  553 -11179.503 -1236.0369  88.9%     -  136s
     0     0 -1241.9779    0  550 -11179.503 -1241.9779  88.9%     -  136s
     0     0 -1245.0482    0  550 -11179.503 -1245.0482  88.9%     -  137s
     0     0 -1247.6005    0  551 -11179.503 -1247.6005  88.8%     -  137s
     0     0 -1256.5329    0  555 -11179.503 -1256.5329  88.8%     -  138s
     0     0 -1257.7938    0  554 -11179.503 -1257.7938  88.7%     -  139s
H    0     0                    -11104.35954 -2277.2219  79.5%     -  152s
     0     0 -2277.2219    0  553 -11104.360 -2277.2219  79.5%     -  152s
     0     0 -2669.2903    0  579 -11104.360 -2669.2903  76.0%     -  157s
     0     0 -2790.2923    0  593 -11104.360 -2790.2923  74.9%     -  160s
     0     0 -2826.1307    0  596 -11104.360 -2826.1307  74.5%     -  161s
     0     0 -2835.5565    0  597 -11104.360 -2835.5565  74.5%     -  162s
     0     0 -2842.3262    0  608 -11104.360 -2842.3262  74.4%     -  163s
     0     0 -2846.0911    0  602 -11104.360 -2846.0911  74.4%     -  163s
     0     0 -2848.0010    0  607 -11104.360 -2848.0010  74.4%     -  164s
     0     0 -3153.1919    0  569 -11104.360 -3153.1919  71.6%     -  172s
     0     0 -3190.9215    0  583 -11104.360 -3190.9215  71.3%     -  174s
     0     0 -3198.7718    0  584 -11104.360 -3198.7718  71.2%     -  175s
     0     0 -3199.7213    0  579 -11104.360 -3199.7213  71.2%     -  176s
     0     0 -3279.8969    0  583 -11104.360 -3279.8969  70.5%     -  181s
     0     0 -3302.0455    0  605 -11104.360 -3302.0455  70.3%     -  185s
     0     0 -3306.2877    0  604 -11104.360 -3306.2877  70.2%     -  186s
     0     0 -3308.2559    0  610 -11104.360 -3308.2559  70.2%     -  187s
     0     0 -3399.5001    0  585 -11104.360 -3399.5001  69.4%     -  192s
     0     0 -3407.0954    0  601 -11104.360 -3407.0954  69.3%     -  194s
     0     0 -3411.9822    0  600 -11104.360 -3411.9822  69.3%     -  195s
     0     0 -3415.1257    0  597 -11104.360 -3415.1257  69.2%     -  196s
     0     0 -3416.6534    0  601 -11104.360 -3416.6534  69.2%     -  196s
     0     0 -3440.6846    0  604 -11104.360 -3440.6846  69.0%     -  199s
     0     0 -3443.5972    0  608 -11104.360 -3443.5972  69.0%     -  207s
     0     0 -3447.2282    0  612 -11104.360 -3447.2282  69.0%     -  208s
     0     0 -3448.2272    0  616 -11104.360 -3448.2272  68.9%     -  208s
     0     0 -3469.6627    0  586 -11104.360 -3469.6627  68.8%     -  211s
     0     0 -3471.7812    0  583 -11104.360 -3471.7812  68.7%     -  212s
     0     0 -3490.8780    0  593 -11104.360 -3490.8780  68.6%     -  214s
     0     0 -3499.9871    0  601 -11104.360 -3499.9871  68.5%     -  216s
     0     0 -3503.8883    0  593 -11104.360 -3503.8883  68.4%     -  217s
     0     0 -3505.9480    0  591 -11104.360 -3505.9480  68.4%     -  218s
     0     0 -3531.8308    0  579 -11104.360 -3531.8308  68.2%     -  221s
     0     0 -3538.5666    0  578 -11104.360 -3538.5666  68.1%     -  222s
     0     0 -3541.0949    0  584 -11104.360 -3541.0949  68.1%     -  223s
     0     0 -3542.4089    0  591 -11104.360 -3542.4089  68.1%     -  224s
     0     0 -3578.1523    0  582 -11104.360 -3578.1523  67.8%     -  227s
     0     0 -3581.5214    0  591 -11104.360 -3581.5214  67.7%     -  227s
     0     0 -3583.8689    0  590 -11104.360 -3583.8689  67.7%     -  228s
     0     0 -3585.1251    0  593 -11104.360 -3585.1251  67.7%     -  229s
     0     0 -3605.4071    0  589 -11104.360 -3605.4071  67.5%     -  231s
     0     0 -3610.7158    0  587 -11104.360 -3610.7158  67.5%     -  232s
     0     0 -3611.9931    0  597 -11104.360 -3611.9931  67.5%     -  233s
     0     0 -3617.6476    0  602 -11104.360 -3617.6476  67.4%     -  235s
     0     0 -3618.3613    0  603 -11104.360 -3618.3613  67.4%     -  236s
     0     0 -3620.5805    0  597 -11104.360 -3620.5805  67.4%     -  238s
     0     0 -3620.6581    0  597 -11104.360 -3620.6581  67.4%     -  240s
     0     2 -3621.3979    0  597 -11104.360 -3621.3979  67.4%     -  284s
     1     3 -4100.6058    1  546 -11104.360 -3621.3979  67.4%  9100  291s
     2     6 -5179.4623    2  457 -11104.360 -3621.3979  67.4%  8795  302s
     5    12 -5570.9120    3  464 -11104.360 -4246.4211  61.8%  8591  307s
    11    24 -6020.8976    4  530 -11104.360 -4341.6639  60.9%  7747  316s
    23    36 -4971.5744    4  548 -11104.360 -4547.0599  59.1% 11065  334s
    35    68 -5863.1085    5  373 -11104.360 -4547.0599  59.1% 11180  374s
    67   184 -5886.3026    6  368 -11104.360 -4876.9641  56.1% 12562  389s
   183   265 -6825.9707    8  424 -11104.360 -4877.8088  56.1%  6877  399s
   272   344 -6526.7675    9  416 -11104.360 -4877.8088  56.1%  5534  407s
   353   392 -6728.8628   10  398 -11104.360 -4877.8088  56.1%  5015  414s
   420   432 -7253.5327   11  425 -11104.360 -4877.8088  56.1%  4846  422s
   488   455 -7482.7914   12  420 -11104.360 -4877.8088  56.1%  4633  429s
   525   486 -7385.1200   12  409 -11104.360 -4877.8088  56.1%  4737  438s
   576   507 -7706.3070   15  342 -11104.360 -4877.8088  56.1%  4670  446s
   611   532 -7939.5771   13  394 -11104.360 -4877.8088  56.1%  4683  455s
   650   554 -7884.5001   13  394 -11104.360 -4877.8088  56.1%  4753  463s
   686   575 -8812.6770   13  471 -11104.360 -4877.8088  56.1%  4790  471s
   719   606 -8084.0102   14  411 -11104.360 -4877.8088  56.1%  4829  478s
   754   629 -10448.703   14  385 -11104.360 -4877.8088  56.1%  4913  486s
   789   661 -11026.328   15  378 -11104.360 -4877.8088  56.1%  4932  493s
   825   688     cutoff   15      -11104.360 -4877.8088  56.1%  5022  502s
   884   725 -9236.4994   21  278 -11104.360 -4877.8088  56.1%  4983  512s
   945   747 -9642.2717   22  321 -11104.360 -4877.8088  56.1%  4974  521s
  1009   784 -9847.0255   23  323 -11104.360 -4877.8088  56.1%  4933  529s
  1078   819 -11089.720   24  105 -11104.360 -4877.8088  56.1%  4874  540s
  1152   860 -10144.716   24  338 -11104.360 -4877.8088  56.1%  4824  549s
  1223   905     cutoff   25      -11104.360 -4877.8088  56.1%  4862  559s
  1308   954 -10474.932   26  320 -11104.360 -4877.8088  56.1%  4827  568s
  1391   973 infeasible   27      -11104.360 -5162.3749  53.5%  4797  580s
  1500  1007 -9748.1079   16  320 -11104.360 -5162.3749  53.5%  4759  591s
  1596  1043 -10033.565   17  314 -11104.360 -5162.3749  53.5%  4779  602s
  1693  1083 -10577.447   17  297 -11104.360 -5162.3749  53.5%  4814  614s
  1797  1134 -10342.732   18  212 -11104.360 -5162.3749  53.5%  4839  626s
  1900  1146 -10825.890   19  211 -11104.360 -5162.3749  53.5%  4900  637s
  2031  1159     cutoff   20      -11104.360 -5617.1184  49.4%  4848  652s
  2152  1188 -9303.5194   11  315 -11104.360 -5617.1184  49.4%  4899  665s
  2260  1235 -10956.979   13  284 -11104.360 -5813.2848  47.6%  4935  679s
  2377  1255     cutoff   15      -11104.360 -5813.2848  47.6%  5010  695s
  2507  1274 -9176.1175   14  381 -11104.360 -6003.4414  45.9%  5020  707s
  2552  1288 -9349.9955   15  386 -11104.360 -6003.4414  45.9%  5072  721s
  2620  1314 -9586.4987   16  414 -11104.360 -6003.4414  45.9%  5076  736s
  2710  1371 -10302.814   17  398 -11104.360 -6003.4414  45.9%  5124  752s
  2825  1438     cutoff   18      -11104.360 -6003.4414  45.9%  5146  769s
  2980  1504 -10892.025   19  358 -11104.360 -6003.4414  45.9%  5146  787s
  3166  1546 -10463.042   17  273 -11104.360 -6056.5813  45.5%  5110  806s
  3355  1567 -7067.6280   13  333 -11104.360 -6206.6190  44.1%  5077  822s
  3464  1620 -8354.3504   14  241 -11104.360 -6344.6574  42.9%  5072  840s
  3598  1687 -9187.8320   17  367 -11104.360 -6344.6574  42.9%  5087  861s
  3810  1767     cutoff   20      -11104.360 -6344.6574  42.9%  5049  882s
  3994  1812 -9964.5915   11  357 -11104.360 -6364.0596  42.7%  5063  904s
  4213  1926 -8777.2734   14  193 -11104.360 -6403.2696  42.3%  5012  923s
  4484  2023 -10244.595   18   95 -11104.360 -6403.2696  42.3%  4937  946s
  4772  2111 -10697.513   13  319 -11104.360 -6637.7321  40.2%  4877  971s
  5089  2162 infeasible   12      -11104.360 -6728.1911  39.4%  4808  997s
  5358  2195     cutoff   13      -11104.360 -6765.2745  39.1%  4797 1024s
  5595  2215 -10699.838   16  253 -11104.360 -6835.6937  38.4%  4821 1050s
  5749  2289 -9851.0736   12  313 -11104.360 -6872.2135  38.1%  4841 1074s
  6057  2363 -10014.947   13  298 -11104.360 -6930.6018  37.6%  4810 1101s
  6406  2399 -9141.0573   10  358 -11104.360 -6931.6458  37.6%  4765 1130s
  6708  2475 infeasible   13      -11104.360 -6943.0815  37.5%  4777 1159s
  7011  2527     cutoff   13      -11104.360 -7062.2621  36.4%  4786 1188s
  7307  2560 -10844.851   18  179 -11104.360 -7127.9510  35.8%  4796 1224s
  7686  2601 -8426.5225   10  295 -11104.360 -7221.5689  35.0%  4774 1257s
  7889  2647     cutoff   14      -11104.360 -7293.0978  34.3%  4800 1293s
  8253  2636 -9937.6621   17  299 -11104.360 -7344.3100  33.9%  4818 1328s
  8632  2656 -10070.546   20  258 -11104.360 -7409.0740  33.3%  4828 1364s
  9045  2646 -9451.1468   14  342 -11104.360 -7475.3823  32.7%  4825 1394s
  9118  2650 -9317.7818   14  353 -11104.360 -7475.3823  32.7%  4830 1424s
  9199  2646 -9515.6025   15  351 -11104.360 -7475.3823  32.7%  4828 1462s
  9443  2628     cutoff   20      -11104.360 -7557.6796  31.9%  4830 1505s
  9824  2613     cutoff   16      -11104.360 -7642.2592  31.2%  4851 1553s
 10207  2570     cutoff   14      -11104.360 -7677.2988  30.9%  4884 1598s
 10675  2538 -10717.551   15  391 -11104.360 -7765.0401  30.1%  4887 1644s
 11172  2502     cutoff   16      -11104.360 -7932.7841  28.6%  4888 1689s
 11707  2423     cutoff   12      -11104.360 -8020.3862  27.8%  4895 1741s
 12207  2337     cutoff   20      -11104.360 -8115.0614  26.9%  4913 1790s
 12760  2210     cutoff   33      -11104.360 -8346.3204  24.8%  4920 1838s
 13379  2009     cutoff   13      -11104.360 -8473.5684  23.7%  4918 1891s
 13980  1974 -10614.240   18  319 -11104.360 -8673.8755  21.9%  4925 1938s
 14121  1795     cutoff   26      -11104.360 -8827.8164  20.5%  4931 1998s
 14660  1552 -10175.760   27  237 -11104.360 -8890.4473  19.9%  4919 2062s
 15547   932     cutoff   19      -11104.360 -9218.1142  17.0%  4864 2124s
 16781     0 infeasible   25      -11104.360 -9648.9516  13.1%  4709 2167s

Cutting planes:
  Learned: 1
  Gomory: 7
  Implied bound: 22
  MIR: 2299
  Flow cover: 2452
  RLT: 38
  Relax-and-lift: 352

Explored 18136 nodes (81256219 simplex iterations) in 2167.06 seconds (7007.23 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11104.4 -11179.5 -11210.4 ... -11695.5
No other solutions better than -11104.4

Optimal solution found (tolerance 1.00e-06)
Best objective -1.110435953848e+04, best bound -1.110435953848e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 2167.23s
  Master Objective (UB) = -11104.36, θ = 113653.52
  Upper Bound (UB) = -11104.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113653.52
  [DEBUG]   ✓ Scenario 0: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113653.52 ≤ Q = 113653.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113653.52 ≤ Q = 113653.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113653.52 ≤ Q = 113653.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1bbae156
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe4451eaa
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.250724e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6322849.8926
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.247365e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124736.50    0  123 6322849.89 -124736.50   102%     -    0s
H    0     0                    -89502.92020 -124736.50  39.4%     -    0s
H    0     0                    -90429.30814 -124736.50  37.9%     -    0s
     0     0 -105313.40    0   42 -90429.308 -105313.40  16.5%     -    0s
H    0     0                    -104616.6493 -105306.31  0.66%     -    0s
     0     0 -105151.78    0   31 -104616.65 -105151.78  0.51%     -    0s
     0     0 -105049.21    0   16 -104616.65 -105049.21  0.41%     -    0s
     0     0 -105049.16    0   16 -104616.65 -105049.16  0.41%     -    0s
H    0     0                    -104954.5482 -105049.16  0.09%     -    0s
     0     0 -104967.02    0    4 -104954.55 -104967.02  0.01%     -    0s
     0     0 -104958.33    0    4 -104954.55 -104958.33  0.00%     -    0s
     0     0 -104956.80    0    2 -104954.55 -104956.80  0.00%     -    0s

Explored 1 nodes (500 simplex iterations) in 0.04 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -104955 -104743 -104568 ... 1.25072e+13
No other solutions better than -104955

Optimal solution found (tolerance 1.00e-06)
Best objective -1.049545482214e+05, best bound -1.049545482214e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 101435.79
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104954.55
  [DEBUG]   S×d_nominal = 206390.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206390.34 + -104954.55 = 101435.79
  [DEBUG]   Current θ from Master = 113653.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12217.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23322.09
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 2372.2564, Absolute Gap = 2372.2564, Relative Gap = 0.213633
  Not converged yet (gap = 2372.26 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437889 nonzeros
Model fingerprint: 0x2b5a044b
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68720 rows and 27900 columns
Presolve time: 1.28s
Presolved: 85563 rows, 36760 columns, 522559 nonzeros
Variable types: 34501 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367655.1550
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.802e+06
 Factor NZ  : 8.188e+06 (roughly 120 MB of memory)
 Factor Ops : 1.461e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72375061e+07  1.51267865e+08  8.65e+04 2.12e+01  7.14e+04     3s
   1  -1.26706995e+07  1.33137327e+08  5.88e+04 6.09e+01  4.81e+04     3s
   2  -4.28401458e+06  1.03616633e+08  1.97e+04 3.07e-11  1.71e+04     3s
   3  -6.96763607e+05  6.92908826e+07  1.32e+03 9.27e-01  1.51e+03     3s
   4  -4.57238445e+05  3.71857935e+07  3.51e+02 3.53e-01  4.96e+02     3s
   5  -3.97492301e+05  2.47554533e+07  2.02e+02 2.05e-01  2.95e+02     3s
   6  -3.16404602e+05  1.92353145e+07  6.83e+01 1.51e-01  1.67e+02     3s
   7  -2.07982453e+05  1.42517689e+07  9.37e+00 1.07e-01  9.70e+01     3s
   8  -1.19113177e+05  8.92132575e+06  5.27e-01 6.47e-02  5.77e+01     3s
   9  -9.12978917e+04  4.11438378e+06  3.43e-01 2.93e-02  2.68e+01     3s
  10  -6.25965362e+04  1.76228641e+06  1.62e-01 1.23e-02  1.16e+01     3s
  11  -3.95630414e+04  5.19463319e+05  8.23e-02 3.52e-03  3.56e+00     3s
  12  -2.55770138e+04  1.96391099e+05  3.72e-02 1.25e-03  1.41e+00     3s
  13  -1.99227715e+04  1.49055663e+05  2.77e-02 7.51e-04  1.07e+00     3s
  14  -1.47735529e+04  9.19877079e+04  2.07e-02 1.86e-03  6.79e-01     3s
  15  -1.04619057e+04  6.52048338e+04  1.62e-02 1.26e-03  4.81e-01     3s
  16  -6.58393566e+03  5.32423224e+04  1.28e-02 9.80e-04  3.81e-01     3s
  17  -3.97045328e+03  3.42694227e+04  1.07e-02 5.72e-04  2.43e-01     3s
  18   6.94218649e+02  2.95462373e+04  7.14e-03 4.46e-04  1.84e-01     4s
  19   2.17945012e+03  2.62170920e+04  6.07e-03 3.66e-04  1.53e-01     4s
  20   4.09743922e+03  2.43414399e+04  4.78e-03 3.20e-04  1.29e-01     4s
  21   5.02138580e+03  2.17785793e+04  4.16e-03 2.57e-04  1.07e-01     4s
  22   5.61691938e+03  1.99187209e+04  3.81e-03 2.06e-04  9.10e-02     4s
  23   7.02220792e+03  1.85782791e+04  2.96e-03 1.70e-04  7.35e-02     4s
  24   8.35025032e+03  1.75881959e+04  2.19e-03 1.43e-04  5.88e-02     4s
  25   9.16443726e+03  1.69295311e+04  1.74e-03 1.26e-04  4.94e-02     4s
  26   9.78162544e+03  1.56129793e+04  1.40e-03 9.05e-05  3.71e-02     4s
  27   1.02946001e+04  1.52285010e+04  1.12e-03 7.86e-05  3.14e-02     4s
  28   1.05970975e+04  1.49498402e+04  9.69e-04 7.13e-05  2.77e-02     4s
  29   1.07699244e+04  1.45466266e+04  8.76e-04 5.97e-05  2.40e-02     4s
  30   1.11696649e+04  1.39145697e+04  6.62e-04 4.07e-05  1.75e-02     4s
  31   1.14170857e+04  1.35443379e+04  5.32e-04 2.98e-05  1.35e-02     4s
  32   1.16061651e+04  1.32106625e+04  4.34e-04 2.00e-05  1.02e-02     4s
  33   1.18259112e+04  1.29648403e+04  3.13e-04 1.34e-05  7.24e-03     4s
  34   1.19663478e+04  1.28389167e+04  2.44e-04 9.95e-06  5.55e-03     4s
  35   1.20463646e+04  1.27423252e+04  1.99e-04 7.54e-06  4.43e-03     5s
  36   1.21026427e+04  1.26869113e+04  1.70e-04 6.11e-06  3.72e-03     5s
  37   1.21945757e+04  1.26615234e+04  1.25e-04 5.40e-06  2.97e-03     5s
  38   1.22232553e+04  1.25669991e+04  1.11e-04 2.92e-06  2.19e-03     5s
  39   1.23080901e+04  1.25378681e+04  6.94e-05 2.07e-06  1.46e-03     5s
  40   1.23701633e+04  1.25129789e+04  4.06e-05 1.36e-06  9.08e-04     5s
  41   1.24066322e+04  1.25031624e+04  2.40e-05 1.10e-06  6.14e-04     5s
  42   1.24248160e+04  1.24790123e+04  1.61e-05 4.10e-07  3.45e-04     5s
  43   1.24503377e+04  1.24710822e+04  5.53e-06 9.59e-07  1.32e-04     5s
  44   1.24581134e+04  1.24663958e+04  2.30e-06 3.21e-07  5.27e-05     5s
  45   1.24617814e+04  1.24641202e+04  8.18e-07 1.92e-07  1.49e-05     5s
  46   1.24639018e+04  1.24639530e+04  1.86e-08 5.79e-08  3.26e-07     5s
  47   1.24639519e+04  1.24639522e+04  2.68e-08 4.06e-11  2.11e-09     5s
  48   1.24639522e+04  1.24639522e+04  1.20e-08 1.49e-11  1.44e-10     5s

Barrier solved model in 48 iterations and 5.34 seconds (8.18 work units)
Optimal objective 1.24639522e+04


Root crossover log...

   74003 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    3526 PPushes remaining with PInf 3.2615086e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.5105599e+01      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35154    1.2463952e+04   0.000000e+00   2.510560e+01      7s
   35161    1.2463952e+04   0.000000e+00   0.000000e+00      7s
   35161    1.2463952e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.246395e+04, 35161 iterations, 4.81 seconds (9.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12463.9522    0  273 -196434.75 12463.9522   106%     -    7s
H    0     0                    -188769.0132 12463.9522   107%     -    7s
H    0     0                    -126627.2226 12463.9522   110%     -    7s
H    0     0                    -112293.9633 12463.9522   111%     -    7s
H    0     0                    -107859.4131 12463.9522   112%     -    7s
H    0     0                    -92913.22276 12463.9522   113%     -    7s
H    0     0                    -60934.17379 12463.9522   120%     -    7s
H    0     0                    -21254.14136 12463.9522   159%     -    7s
H    0     0                    -20389.21019 12463.9522   161%     -    7s
H    0     0                    -18844.54465 12463.9522   166%     -    8s
H    0     0                    -18709.30937 12463.9522   167%     -    8s
H    0     0                    -18256.24567 7093.52021   139%     -   25s
H    0     0                    -18177.11129 7093.52021   139%     -   25s
H    0     0                    -16876.34650 7093.52021   142%     -   25s
H    0     0                    -16872.45357 7093.52021   142%     -   25s
H    0     0                    -16537.22517 7093.52021   143%     -   25s
H    0     0                    -16533.33223 7093.52021   143%     -   25s
     0     0 7085.37223    0  397 -16533.332 7085.37223   143%     -   25s
H    0     0                    -16462.01830 7085.37223   143%     -   26s
     0     0 6957.39991    0  370 -16462.018 6957.39991   142%     -   30s
     0     0 6953.48113    0  379 -16462.018 6953.48113   142%     -   32s
     0     0 6832.77239    0  379 -16462.018 6832.77239   142%     -   32s
     0     0 6658.83850    0  381 -16462.018 6658.83850   140%     -   38s
     0     0 6620.29630    0  539 -16462.018 6620.29630   140%     -   42s
     0     0 6600.47822    0  541 -16462.018 6600.47822   140%     -   44s
     0     0 6600.47822    0  541 -16462.018 6600.47822   140%     -   49s
     0     0 6600.47822    0  547 -16462.018 6600.47822   140%     -   50s
     0     0 6600.47822    0  547 -16462.018 6600.47822   140%     -   50s
     0     0 2710.25041    0  495 -16462.018 2710.25041   116%     -   76s
     0     0 2308.18131    0  431 -16462.018 2308.18131   114%     -   87s
H    0     0                    -12908.82789 2267.50768   118%     -   92s
H    0     0                    -12072.01175 2267.50768   119%     -   92s
H    0     0                    -11966.71094 2267.50768   119%     -   92s
     0     0 2267.50768    0  501 -11966.711 2267.50768   119%     -   92s
     0     0 2204.98179    0  497 -11966.711 2204.98179   118%     -   97s
H    0     0                    -11926.15011 2161.57326   118%     -  101s
H    0     0                    -11925.34662 2161.57326   118%     -  101s
     0     0 2161.57326    0  498 -11925.347 2161.57326   118%     -  101s
     0     0 2144.39080    0  498 -11925.347 2144.39080   118%     -  104s
     0     0 2131.43423    0  498 -11925.347 2131.43423   118%     -  107s
     0     0 2007.37590    0  518 -11925.347 2007.37590   117%     -  116s
     0     0 1975.22046    0  589 -11925.347 1975.22046   117%     -  122s
     0     0 1943.17877    0  561 -11925.347 1943.17877   116%     -  126s
     0     0 1924.13202    0  509 -11925.347 1924.13202   116%     -  129s
     0     0 1913.71311    0  598 -11925.347 1913.71311   116%     -  131s
H    0     0                    -11823.07566 1908.48450   116%     -  133s
H    0     0                    -11653.72653 1908.48450   116%     -  133s
H    0     0                    -11649.83360 1908.48450   116%     -  133s
     0     0 1908.48450    0  510 -11649.834 1908.48450   116%     -  133s
     0     0 1908.26403    0  515 -11649.834 1908.26403   116%     -  133s
H    0     0                    -11636.63756  -86.03958  99.3%     -  171s
H    0     0                    -11620.00702  -86.03958  99.3%     -  171s
H    0     0                    -11586.25511  -86.03958  99.3%     -  171s
     0     0  -86.03958    0  495 -11586.255  -86.03958  99.3%     -  171s
     0     0 -450.50289    0  518 -11586.255 -450.50289  96.1%     -  183s
     0     0 -625.30660    0  532 -11586.255 -625.30660  94.6%     -  190s
     0     0 -663.09052    0  533 -11586.255 -663.09052  94.3%     -  195s
     0     0 -673.12388    0  533 -11586.255 -673.12388  94.2%     -  198s
     0     0 -675.96555    0  540 -11586.255 -675.96555  94.2%     -  199s
     0     0 -677.62865    0  538 -11586.255 -677.62865  94.2%     -  200s
     0     0 -1899.1180    0  491 -11586.255 -1899.1180  83.6%     -  227s
     0     0 -2181.8944    0  570 -11586.255 -2181.8944  81.2%     -  235s
     0     0 -2212.5725    0  500 -11586.255 -2212.5725  80.9%     -  238s
     0     0 -2234.4129    0  564 -11586.255 -2234.4129  80.7%     -  241s
     0     0 -2333.4705    0  561 -11586.255 -2333.4705  79.9%     -  246s
     0     0 -2350.0635    0  581 -11586.255 -2350.0635  79.7%     -  249s
     0     0 -2360.9381    0  588 -11586.255 -2360.9381  79.6%     -  251s
     0     0 -2366.8266    0  590 -11586.255 -2366.8266  79.6%     -  252s
     0     0 -2379.1787    0  589 -11586.255 -2379.1787  79.5%     -  255s
     0     0 -2386.4956    0  586 -11586.255 -2386.4956  79.4%     -  256s
     0     0 -2386.8180    0  587 -11586.255 -2386.8180  79.4%     -  257s
     0     0 -2658.3325    0  580 -11586.255 -2658.3325  77.1%     -  267s
     0     0 -2703.6093    0  570 -11586.255 -2703.6093  76.7%     -  270s
     0     0 -2735.8066    0  577 -11586.255 -2735.8066  76.4%     -  274s
     0     0 -2742.0849    0  649 -11586.255 -2742.0849  76.3%     -  276s
     0     0 -2746.0620    0  572 -11586.255 -2746.0620  76.3%     -  278s
     0     0 -2753.3428    0  624 -11586.255 -2753.3428  76.2%     -  280s
     0     0 -2754.9281    0  645 -11586.255 -2754.9281  76.2%     -  280s
     0     0 -2913.6466    0  624 -11586.255 -2913.6466  74.9%     -  288s
     0     0 -2949.0002    0  623 -11586.255 -2949.0002  74.5%     -  297s
     0     0 -2979.7078    0  563 -11586.255 -2979.7078  74.3%     -  300s
     0     0 -3003.7122    0  555 -11586.255 -3003.7122  74.1%     -  302s
     0     0 -3011.7193    0  557 -11586.255 -3011.7193  74.0%     -  304s
     0     0 -3014.3657    0  559 -11586.255 -3014.3657  74.0%     -  305s
     0     0 -3015.4597    0  564 -11586.255 -3015.4597  74.0%     -  306s
     0     0 -3151.5321    0  565 -11586.255 -3151.5321  72.8%     -  314s
     0     0 -3192.5423    0  555 -11586.255 -3192.5423  72.4%     -  317s
     0     0 -3200.6179    0  570 -11586.255 -3200.6179  72.4%     -  318s
     0     0 -3204.2268    0  567 -11586.255 -3204.2268  72.3%     -  320s
     0     0 -3206.7158    0  567 -11586.255 -3206.7158  72.3%     -  320s
     0     0 -3208.0875    0  571 -11586.255 -3208.0875  72.3%     -  320s
     0     0 -3249.7952    0  616 -11586.255 -3249.7952  72.0%     -  325s
H    0     0                    -11585.45162 -3250.2540  71.9%     -  333s
     0     0 -3258.5962    0  630 -11585.452 -3258.5962  71.9%     -  335s
     0     0 -3261.8582    0  562 -11585.452 -3261.8582  71.8%     -  336s
     0     0 -3262.7936    0  565 -11585.452 -3262.7936  71.8%     -  337s
     0     0 -3288.0777    0  550 -11585.452 -3288.0777  71.6%     -  341s
     0     0 -3303.2640    0  550 -11585.452 -3303.2640  71.5%     -  344s
     0     0 -3305.8503    0  564 -11585.452 -3305.8503  71.5%     -  344s
     0     0 -3306.6789    0  563 -11585.452 -3306.6789  71.5%     -  345s
     0     0 -3322.4124    0  565 -11585.452 -3322.4124  71.3%     -  349s
     0     0 -3326.5784    0  573 -11585.452 -3326.5784  71.3%     -  350s
     0     0 -3327.7623    0  583 -11585.452 -3327.7623  71.3%     -  351s
     0     0 -3338.4327    0  651 -11585.452 -3338.4327  71.2%     -  354s
     0     0 -3340.0234    0  583 -11585.452 -3340.0234  71.2%     -  355s
     0     0 -3357.9881    0  579 -11585.452 -3357.9881  71.0%     -  358s
     0     0 -3358.0986    0  579 -11585.452 -3358.0986  71.0%     -  361s
     0     2 -3358.5593    0  579 -11585.452 -3358.5593  71.0%     -  434s
     1     3 -3547.6990    1  541 -11585.452 -3359.2188  71.0%  6444  441s
     2     5 -4317.5312    2  515 -11585.452 -3359.2188  71.0%  9472  453s
     4    10 -4833.8335    2  532 -11585.452 -3553.6516  69.3% 10218  466s
     9    20 -5049.7453    3  518 -11585.452 -4251.7684  63.3%  9824  479s
    19    40 -5099.4169    4  515 -11585.452 -4305.1620  62.8%  8487  490s
    39    52 -5496.3172    5  573 -11585.452 -4413.4536  61.9% 10912  512s
    51    76 -5916.4985    6  543 -11585.452 -4413.4536  61.9% 11263  531s
    75   162 -6379.6968    7  485 -11585.452 -4413.4536  61.9% 10299  553s
   161   241 -6601.8736   10  430 -11585.452 -4413.4536  61.9%  8324  568s
   246   290 -7503.2253   12  375 -11585.452 -4413.4536  61.9%  6630  581s
   314   322 -10426.981   14  349 -11585.452 -4413.4536  61.9%  5899  594s
   378   367 -10474.906   15  372 -11585.452 -4413.4536  61.9%  5422  606s
   442   430 -10931.875   18  320 -11585.452 -4413.4536  61.9%  5111  620s
   505   454 -11275.708   21  340 -11585.452 -4413.4536  61.9%  4899  633s
   551   473     cutoff   22      -11585.452 -4413.4536  61.9%  4701  645s
   584   519 -11422.505   21  311 -11585.452 -4413.4536  61.9%  4663  655s
   634   540     cutoff   22      -11585.452 -4413.4536  61.9%  4521  665s
   669   567 -5930.5366    7  481 -11585.452 -4413.4536  61.9%  4446  676s
   710   590 -6509.0306    8  483 -11585.452 -4413.4536  61.9%  4377  686s
   749   616 -6788.7690    9  449 -11585.452 -4413.4536  61.9%  4292  699s
   793   642 -6807.3953   10  445 -11585.452 -4413.4536  61.9%  4259  710s
   835   672 -6919.9276   11  434 -11585.452 -4413.4536  61.9%  4163  722s
   885   721 -9132.1218   32  277 -11585.452 -4413.4536  61.9%  4034  733s
   946   758 -7299.0418   12  435 -11585.452 -4413.4536  61.9%  3883  745s
   999   805 -7634.7785   13  429 -11585.452 -4413.4536  61.9%  3796  758s
  1074   829 -9341.4147   14  431 -11585.452 -4413.4536  61.9%  3703  772s
  1179   866 -9650.6274   15  454 -11585.452 -4413.4536  61.9%  3511  787s
  1270   918 -9707.1066   16  383 -11585.452 -4413.4536  61.9%  3408  804s
  1396   938 -9804.6370   17  367 -11585.452 -4413.4536  61.9%  3255  817s
  1434   961 -9941.8043   18  369 -11585.452 -4413.4536  61.9%  3242  831s
  1481   992     cutoff   19      -11585.452 -4413.4536  61.9%  3258  847s
  1535  1014 -10390.824   20  373 -11585.452 -4413.4536  61.9%  3241  862s
  1570  1041 -10516.125   22  469 -11585.452 -4413.4536  61.9%  3253  878s
  1641  1068 -11172.612   25  226 -11585.452 -4413.4536  61.9%  3215  894s
  1714  1115 -8502.4034   11  526 -11585.452 -4413.4536  61.9%  3191  911s
  1787  1148 -8766.7476   13  498 -11585.452 -4413.4536  61.9%  3182  931s
  1889  1164     cutoff   15      -11585.452 -4413.4536  61.9%  3134  951s
  1956  1195 -9072.4276   14  400 -11585.452 -4413.4536  61.9%  3140  972s
  2013  1240 -9871.6390   16  394 -11585.452 -4646.1499  59.9%  3177  994s
  2086  1287 -10338.944   17  443 -11585.452 -4646.9132  59.9%  3211 1013s
  2157  1324 -10789.484   19  308 -11585.452 -4646.9132  59.9%  3254 1039s
  2239  1378     cutoff   22      -11585.452 -4646.9132  59.9%  3284 1062s
  2337  1433     cutoff   17      -11585.452 -5061.0049  56.3%  3290 1083s
  2458  1486 -6383.8673    8  413 -11585.452 -5558.4201  52.0%  3292 1108s
  2586  1548 -8561.9452   10  390 -11585.452 -5558.4201  52.0%  3297 1137s
  2726  1601     cutoff   12      -11585.452 -5865.6312  49.4%  3297 1169s
  2855  1626     cutoff   12      -11585.452 -5865.6312  49.4%  3307 1196s
  2926  1666     cutoff   11      -11585.452 -5865.6312  49.4%  3324 1223s
  3040  1731 -6663.7159   12  495 -11585.452 -6109.4406  47.3%  3344 1254s
  3171  1808 -7094.0572   14  415 -11585.452 -6109.4406  47.3%  3357 1288s
  3319  1869 -7259.3158   15  468 -11585.452 -6109.4406  47.3%  3378 1323s
  3512  1960 -8694.4481   20  405 -11585.452 -6109.4406  47.3%  3344 1359s
  3702  2025 -10711.485   24  346 -11585.452 -6139.3603  47.0%  3355 1396s
  3869  2098 infeasible   59      -11585.452 -6338.6445  45.3%  3379 1432s
  4037  2142 -7880.0253   10  285 -11585.452 -6379.8684  44.9%  3423 1471s
  4230  2201 -8819.5253   11  277 -11585.452 -6389.2282  44.9%  3439 1514s
  4393  2232 -10955.761   13  196 -11585.452 -6485.8580  44.0%  3477 1555s
  4570  2274 -11262.279   13  205 -11585.452 -6485.8580  44.0%  3511 1598s
  4741  2319 -10413.271   14  450 -11585.452 -6543.4624  43.5%  3565 1636s
  4861  2385     cutoff   15      -11585.452 -6543.4624  43.5%  3587 1685s
  5051  2458 -7535.5990    8  315 -11585.452 -6606.6005  43.0%  3626 1733s
  5313  2512 -9548.7999   11  179 -11585.452 -6630.5944  42.8%  3622 1785s
  5550  2594 -11182.626   41  418 -11585.452 -6681.1604  42.3%  3651 1837s
  5823  2649     cutoff   12      -11585.452 -6782.3480  41.5%  3666 1893s
  6060  2774 -10196.380   39  456 -11585.452 -6816.6907  41.2%  3698 1949s
  6396  2775 -9464.2985   12  579 -11585.452 -6823.3670  41.1%  3692 2053s
  6398  2776 -10357.387   12  468 -11585.452 -6823.3670  41.1%  3691 2066s
  6399  2777 -9132.4947   18  462 -11585.452 -6823.3670  41.1%  3690 2107s
  6400  2778 -11260.752   23  510 -11585.452 -6823.3670  41.1%  3690 2142s
  6401  2778 -7629.6194   25  589 -11585.452 -6823.3670  41.1%  3689 2158s
  6402  2779 -8279.9989   13  519 -11585.452 -6823.3670  41.1%  3689 2167s
  6403  2780 -10713.641   26  563 -11585.452 -6823.3670  41.1%  3688 2174s
  6404  2780 -9657.7741    9  562 -11585.452 -6823.3670  41.1%  3687 2180s
  6406  2782 -8842.3362   14  607 -11585.452 -6823.3670  41.1%  3686 2190s
  6408  2783 -7888.1643   12  570 -11585.452 -6823.3670  41.1%  3685 2196s
  6409  2784 -7890.8819   14  569 -11585.452 -6823.3670  41.1%  3685 2201s
  6410  2784 -8511.5752   10  582 -11585.452 -6823.3670  41.1%  3684 2215s
  6412  2786 -9762.0152   30  578 -11585.452 -6823.3670  41.1%  3683 2222s
  6413  2786 -11183.213   35  585 -11585.452 -6823.3670  41.1%  3682 2234s
  6414  2787 -9720.7789   12  643 -11585.452 -6823.3670  41.1%  3682 2238s
  6415  2788 -9111.9887   13  548 -11585.452 -6823.3670  41.1%  3681 2241s
  6416  2788 -9308.6689   19  573 -11585.452 -6823.3670  41.1%  3681 2245s
  6417  2789 -9705.7749   30  572 -11585.452 -6823.3670  41.1%  3680 2250s
  6418  2790 -7171.9684   10  689 -11585.452 -6823.3670  41.1%  3679 2259s
  6419  2790 -10626.056   60  582 -11585.452 -6823.3670  41.1%  3679 2261s
  6420  2791 -9493.3140   11  587 -11585.452 -6823.3670  41.1%  3678 2266s
  6421  2792 -7917.7150   23  574 -11585.452 -6823.3670  41.1%  3678 2276s
  6422  2792 -11489.166   48  578 -11585.452 -6823.3670  41.1%  3677 2281s
  6423  2793 -9659.0068   18  580 -11585.452 -6823.3670  41.1%  3676 2296s
  6424  2794 -7491.5155   10  666 -11585.452 -6823.3670  41.1%  3676 2302s
  6425  2794 -9575.3484   25  583 -11585.452 -6823.3670  41.1%  3675 2312s
  6426  2795 -9348.3210   19  583 -11585.452 -6823.3670  41.1%  3675 2325s
  6427  2796 -10705.429   57  583 -11585.452 -6823.3670  41.1%  3674 2367s
  6428  2798 -6823.3670   10  554 -11585.452 -6823.3670  41.1%  3716 2382s
  6429  2800 -6823.3670   11  510 -11585.452 -6823.3670  41.1%  3717 2403s
  6431  2803 -6823.3670   12  510 -11585.452 -6823.3670  41.1%  3718 2427s
  6435  2811 -6823.3670   12  595 -11585.452 -6823.3670  41.1%  3722 2457s
  6444  2826 -6823.3670   13  520 -11585.452 -6823.3670  41.1%  3729 2494s
  6462  2836 -9635.3440   15  186 -11585.452 -6823.3670  41.1%  3766 2539s
  6478  2863 -6823.3670   15  656 -11585.452 -6823.3670  41.1%  3805 2566s
  6510  2923 -6823.3670   16  489 -11585.452 -6823.3670  41.1%  3826 2593s
  6611  2913 -8603.1411   17  487 -11585.452 -6823.3670  41.1%  3863 2622s
  6648  2920 -8730.5289   18  470 -11585.452 -6823.3670  41.1%  3863 2643s
  6700  2907 -9263.7311   20  295 -11585.452 -6823.3670  41.1%  3863 2659s
  6761  2892 -10617.758   21  552 -11585.452 -6823.3670  41.1%  3848 2678s
  6823  2869     cutoff   22      -11585.452 -6823.3670  41.1%  3842 2695s
  6888  2866 -10706.804   20  520 -11585.452 -6823.3670  41.1%  3838 2715s
  6948  2842     cutoff   21      -11585.452 -6823.3670  41.1%  3836 2731s
  7004  2814 -9721.6958   20  426 -11585.452 -6823.3670  41.1%  3830 2748s
  7059  2799 -11490.468   17  253 -11585.452 -6823.3670  41.1%  3820 2768s
  7110  2794     cutoff   18      -11585.452 -6823.3670  41.1%  3817 2787s
  7156  2788 -9577.6231   20  375 -11585.452 -6823.3670  41.1%  3818 2803s
  7194  2772 -10118.736   21  269 -11585.452 -6823.3670  41.1%  3821 2825s
  7251  2758     cutoff   22      -11585.452 -6823.3670  41.1%  3821 2848s
  7314  2755 -10831.245   25  252 -11585.452 -6823.3670  41.1%  3823 2866s
  7374  2738 -11171.410   27  259 -11585.452 -6823.3670  41.1%  3822 2886s
  7430  2730     cutoff   28      -11585.452 -6823.3670  41.1%  3822 2905s
  7478  2717 -10007.528   17  366 -11585.452 -6823.3670  41.1%  3828 2925s
  7541  2697 -11421.597   19  341 -11585.452 -6823.3670  41.1%  3831 2944s
  7608  2691     cutoff   21      -11585.452 -6823.3670  41.1%  3826 2964s
  7691  2677 -11170.535   19  455 -11585.452 -6823.3670  41.1%  3823 2986s
  7793  2654     cutoff   22      -11585.452 -6823.3670  41.1%  3808 3007s
  7842  2645 -11475.234   17   98 -11585.452 -6823.3670  41.1%  3806 3041s
  7929  2627 -8359.7864   18  438 -11585.452 -6823.3670  41.1%  3796 3067s
  8010  2619 -11132.126   20  412 -11585.452 -6823.3670  41.1%  3797 3100s
  8091  2584 -11164.756   21  411 -11585.452 -6823.3670  41.1%  3807 3127s
  8212  2550 -10496.362   23  413 -11585.452 -6823.3670  41.1%  3802 3152s
  8333  2509 -11165.634   25  267 -11585.452 -6823.3670  41.1%  3794 3181s
  8480  2459 -11077.572   21   41 -11585.452 -6823.3670  41.1%  3785 3209s
  8588  2420 -10029.609   22  384 -11585.452 -6823.3670  41.1%  3779 3236s
  8725  2385     cutoff   24      -11585.452 -6823.3670  41.1%  3768 3269s
  8872  2342 -10450.872   19  294 -11585.452 -6823.3670  41.1%  3758 3304s
  9027  2261 -10992.066   22  366 -11585.452 -6823.3670  41.1%  3752 3332s
  9233  2180 -10771.049   22  326 -11585.452 -7449.3894  35.7%  3729 3361s
  9303  2155     cutoff   23      -11585.452 -7449.3894  35.7%  3732 3385s
  9372  2110     cutoff   24      -11585.452 -8152.1575  29.6%  3733 3415s
  9451  2035 -10993.469   19  549 -11585.452 -8152.1575  29.6%  3733 3445s
  9627  1893     cutoff   20      -11585.452 -8152.1575  29.6%  3710 3476s
  9809  1733     cutoff   21      -11585.452 -8152.1575  29.6%  3676 3505s
 10023  1611     cutoff   25      -11585.452 -8152.1575  29.6%  3634 3534s
 10120  1575 -10025.580   19  483 -11585.452 -8819.0542  23.9%  3618 3560s
 10157  1561 -10969.773   20  239 -11585.452 -9821.4237  15.2%  3619 3584s
 10186  1543 -11181.601   22  532 -11585.452 -9964.5864  14.0%  3620 3599s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 36
  Projected implied bound: 320
  MIR: 1214
  Flow cover: 2202
  RLT: 72
  Relax-and-lift: 287

Explored 10217 nodes (37387219 simplex iterations) in 3599.29 seconds (9786.31 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11585.5 -11586.3 -11620 ... -11966.7
No other solutions better than -11585.5

Optimal solution found (tolerance 1.00e-06)
Best objective -1.158545162317e+04, best bound -1.158545162317e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3599.36s
  Master Objective (UB) = -11585.45, θ = 112849.47
  Upper Bound (UB) = -11585.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112849.47
  [DEBUG]   ✓ Scenario 0: θ = 112849.47 ≤ Q = 112849.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112849.47 ≤ Q = 112849.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 112849.47 ≤ Q = 112849.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 112849.47 ≤ Q = 112849.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 112849.47 ≤ Q = 112849.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 112849.47 ≤ Q = 112849.47 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 112849.47 ≤ Q = 112849.47 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xe9c4768
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf163b898
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.249579e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6277467.4926
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.251332e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -125133.20    0  123 6277467.49 -125133.20   102%     -    0s
H    0     0                    -89854.38680 -125133.20  39.3%     -    0s
H    0     0                    -90780.77473 -125133.20  37.8%     -    0s
     0     0 -97260.288    0   64 -90780.775 -97260.288  7.14%     -    0s
H    0     0                    -93052.20197 -97236.417  4.50%     -    0s
H    0     0                    -95752.03179 -97236.417  1.55%     -    0s
H    0     0                    -96721.18074 -97236.417  0.53%     -    0s
     0     0 -97016.034    0    7 -96721.181 -97016.034  0.30%     -    0s
     0     0 -97015.645    0    6 -96721.181 -97015.645  0.30%     -    0s
H    0     0                    -96979.22318 -97013.501  0.04%     -    0s
     0     0 -97010.823    0    2 -96979.223 -97010.823  0.03%     -    0s
     0     0 -97005.506    0    9 -96979.223 -97005.506  0.03%     -    0s
     0     0 -96998.088    0    4 -96979.223 -96998.088  0.02%     -    0s
     0     0 -96983.583    0    2 -96979.223 -96983.583  0.00%     -    0s
     0     0 -96982.427    0    1 -96979.223 -96982.427  0.00%     -    0s
     0     0     cutoff    0      -96979.223 -96979.223  0.00%     -    0s

Explored 1 nodes (493 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -96979.2 -96973.5 -96926.8 ... 1.24958e+13
No other solutions better than -96979.2

Optimal solution found (tolerance 1.00e-06)
Best objective -9.697922318306e+04, best bound -9.697922318306e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 109018.65
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96979.22
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -96979.22 = 109018.65
  [DEBUG]   Current θ from Master = 112849.47
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3830.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -15416.28
  Lower Bound (LB) = -13476.62
  Gap (UB-LB) = 1891.1644, Absolute Gap = 1891.1644, Relative Gap = 0.163236
  Not converged yet (gap = 1891.16 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481126 nonzeros
Model fingerprint: 0xd65001f6
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75608 rows and 30698 columns
Presolve time: 1.49s
Presolved: 93965 rows, 40202 columns, 570277 nonzeros
Variable types: 37943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367252.2753
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.354e+06
 Factor NZ  : 9.517e+06 (roughly 130 MB of memory)
 Factor Ops : 1.813e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72732388e+07  1.64137902e+08  8.66e+04 1.76e+01  7.11e+04     3s
   1  -1.27256657e+07  1.44443075e+08  5.88e+04 5.97e+01  4.78e+04     3s
   2  -4.71234108e+06  1.13042419e+08  2.15e+04 1.78e-11  1.85e+04     3s
   3  -7.14885202e+05  7.56760449e+07  1.37e+03 7.21e-01  1.54e+03     3s
   4  -4.59286375e+05  3.48791962e+07  3.54e+02 1.92e-01  4.55e+02     3s
   5  -3.96470920e+05  2.22691884e+07  2.05e+02 1.03e-01  2.64e+02     3s
   6  -3.00391489e+05  1.89754097e+07  8.51e+01 8.32e-02  1.64e+02     3s
   7  -1.79417204e+05  1.35992511e+07  9.56e+00 5.59e-02  8.49e+01     3s
   8  -1.24434277e+05  8.99736172e+06  3.27e+00 3.61e-02  5.41e+01     3s
   9  -9.13395852e+04  4.77173107e+06  1.88e+00 1.87e-02  2.86e+01     3s
  10  -6.32245014e+04  1.76767559e+06  9.03e-01 6.61e-03  1.07e+01     3s
  11  -3.70757733e+04  5.81162151e+05  4.16e-01 2.04e-03  3.60e+00     3s
  12  -2.57546518e+04  2.44938451e+05  1.96e-01 8.81e-04  1.57e+00     3s
  13  -1.97459638e+04  1.46156472e+05  1.43e-01 5.97e-04  9.64e-01     3s
  14  -1.56166643e+04  9.89832756e+04  1.08e-01 8.84e-04  6.66e-01     4s
  15  -1.07847158e+04  6.99830518e+04  8.22e-02 2.77e-03  4.69e-01     4s
  16  -6.17667775e+03  5.36554757e+04  6.29e-02 2.33e-03  3.47e-01     4s
  17  -3.11625758e+03  4.44244412e+04  5.09e-02 2.10e-03  2.76e-01     4s
  18  -9.16232626e+02  3.28800318e+04  4.28e-02 2.13e-03  1.96e-01     4s
  19   1.40645312e+03  2.76767418e+04  3.48e-02 1.19e-03  1.53e-01     4s
  20   3.20250017e+03  2.41618231e+04  2.86e-02 1.04e-03  1.22e-01     4s
  21   4.48842920e+03  2.22041018e+04  2.42e-02 9.33e-04  1.03e-01     4s
  22   6.97250046e+03  1.94279745e+04  1.61e-02 8.41e-04  7.23e-02     4s
  23   7.46384440e+03  1.75612274e+04  1.47e-02 6.23e-04  5.86e-02     4s
  24   7.96288059e+03  1.67165069e+04  1.32e-02 5.11e-04  5.08e-02     4s
  25   9.03672879e+03  1.56184501e+04  1.00e-02 3.75e-04  3.82e-02     4s
  26   9.44069430e+03  1.52612433e+04  8.78e-03 3.31e-04  3.38e-02     4s
  27   1.01035962e+04  1.50109745e+04  6.92e-03 2.98e-04  2.85e-02     4s
  28   1.06490866e+04  1.46459663e+04  5.29e-03 2.52e-04  2.32e-02     4s
  29   1.08886847e+04  1.42300324e+04  4.64e-03 2.02e-04  1.94e-02     4s
  30   1.13129818e+04  1.40059704e+04  3.38e-03 1.84e-04  1.56e-02     5s
  31   1.14774271e+04  1.35271406e+04  2.95e-03 1.23e-04  1.19e-02     5s
  32   1.16683499e+04  1.33895378e+04  2.41e-03 1.05e-04  9.99e-03     5s
  33   1.18608307e+04  1.31847713e+04  1.88e-03 7.80e-05  7.68e-03     5s
  34   1.19561998e+04  1.30300010e+04  1.62e-03 5.63e-05  6.23e-03     5s
  35   1.20559616e+04  1.30072973e+04  1.37e-03 5.33e-05  5.52e-03     5s
  36   1.21514794e+04  1.29131813e+04  1.13e-03 4.14e-05  4.42e-03     5s
  37   1.21850034e+04  1.28820103e+04  1.04e-03 3.70e-05  4.05e-03     5s
  38   1.22545343e+04  1.28031356e+04  8.61e-04 2.65e-05  3.18e-03     5s
  39   1.23428897e+04  1.27433089e+04  6.39e-04 2.00e-05  2.32e-03     5s
  40   1.24457340e+04  1.26701405e+04  3.69e-04 8.75e-06  1.30e-03     5s
  41   1.24580508e+04  1.26428995e+04  3.41e-04 4.78e-06  1.07e-03     5s
  42   1.25277282e+04  1.26270238e+04  1.81e-04 2.54e-06  5.76e-04     5s
  43   1.25566986e+04  1.26210723e+04  1.15e-04 1.73e-06  3.74e-04     5s
  44   1.25925471e+04  1.26165114e+04  3.10e-05 1.11e-06  1.39e-04     6s
  45   1.26052276e+04  1.26089971e+04  4.53e-06 1.74e-07  2.19e-05     6s
  46   1.26068157e+04  1.26075252e+04  1.35e-06 8.81e-07  4.12e-06     6s
  47   1.26074363e+04  1.26075032e+04  6.47e-08 1.24e-07  3.88e-07     6s
  48   1.26074972e+04  1.26074972e+04  1.67e-09 7.90e-09  3.89e-10     6s

Barrier solved model in 48 iterations and 5.76 seconds (8.53 work units)
Optimal objective 1.26074972e+04


Root crossover log...

   75215 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    7192 PPushes remaining with PInf 4.2054056e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.5323856e+02      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39367    1.2607497e+04   0.000000e+00   3.532386e+02      8s
   39387    1.2607497e+04   0.000000e+00   0.000000e+00      8s
   39387    1.2607497e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 1.260750e+04, 39387 iterations, 5.99 seconds (10.61 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12607.4972    0  430 -196434.75 12607.4972   106%     -    8s
H    0     0                    -189785.2457 12607.4972   107%     -    8s
H    0     0                    -153237.0018 12607.4972   108%     -    9s
H    0     0                    -136933.1637 12607.4972   109%     -    9s
H    0     0                    -134625.6596 12607.4972   109%     -    9s
H    0     0                    -133581.6711 12607.4972   109%     -    9s
H    0     0                    -133061.7527 12607.4972   109%     -    9s
H    0     0                    -133058.7077 12607.4972   109%     -    9s
H    0     0                    -86645.12913 12607.4972   115%     -    9s
H    0     0                    -74714.92519 12607.4972   117%     -    9s
H    0     0                    -70915.83612 12607.4972   118%     -    9s
H    0     0                    -70610.32455 12607.4972   118%     -    9s
H    0     0                    -48976.42475 12607.4972   126%     -   20s
H    0     0                    -45970.57180 12607.4972   127%     -   21s
H    0     0                    -39096.45059 12607.4972   132%     -   21s
H    0     0                    -37934.56478 12607.4972   133%     -   21s
H    0     0                    -37645.28524 12607.4972   133%     -   21s
H    0     0                    -37350.97488 12607.4972   134%     -   21s
H    0     0                    -37288.11852 12607.4972   134%     -   21s
H    0     0                    -37035.12878 12607.4972   134%     -   21s
H    0     0                    -22871.28797 7956.06774   135%     -   41s
H    0     0                    -22601.82044 7956.06774   135%     -   41s
H    0     0                    -22597.92750 7956.06774   135%     -   41s
H    0     0                    -22597.48812 7956.06774   135%     -   41s
H    0     0                    -22593.59519 7956.06774   135%     -   41s
     0     0 6854.56970    0  651 -22593.595 6854.56970   130%     -   41s
H    0     0                    -19097.80756 6854.56970   136%     -   41s
H    0     0                    -18283.10681 6854.56970   137%     -   41s
H    0     0                    -18278.38550 6854.56970   138%     -   42s
H    0     0                    -18081.28810 6854.56970   138%     -   42s
H    0     0                    -18053.50279 6854.56970   138%     -   42s
H    0     0                    -18049.60985 6854.56970   138%     -   42s
H    0     0                    -17969.87612 6854.56970   138%     -   42s
H    0     0                    -17962.35431 6854.56970   138%     -   42s
H    0     0                    -17855.16876 6854.56970   138%     -   42s
H    0     0                    -17849.90876 6854.56970   138%     -   42s
H    0     0                    -17844.02005 6854.56970   138%     -   42s
H    0     0                    -17832.82704 6854.56970   138%     -   42s
H    0     0                    -17790.74500 6854.56970   139%     -   42s
H    0     0                    -17783.87642 6854.56970   139%     -   42s
H    0     0                    -17772.91102 6854.56970   139%     -   42s
     0     0 6620.00598    0  591 -17772.911 6620.00598   137%     -   56s
     0     0 6620.00598    0  622 -17772.911 6620.00598   137%     -   64s
     0     0 6620.00598    0  625 -17772.911 6620.00598   137%     -   67s
     0     0 6615.95920    0  623 -17772.911 6615.95920   137%     -   68s
     0     0 6615.82783    0  622 -17772.911 6615.82783   137%     -   69s
H    0     0                    -12489.53060 4311.03432   135%     -  109s
H    0     0                    -12417.84752 4311.03432   135%     -  109s
     0     0 3721.45321    0  251 -12417.848 3721.45321   130%     -  109s
     0     0 3123.81811    0  723 -12417.848 3123.81811   125%     -  153s
     0     0 2910.04477    0  618 -12417.848 2910.04477   123%     -  179s
     0     0 2288.25943    0  613 -12417.848 2288.25943   118%     -  206s
     0     0 2166.14242    0  621 -12417.848 2166.14242   117%     -  219s
H    0     0                    -12278.67004 2093.67169   117%     -  229s
H    0     0                    -12274.77710 2093.67169   117%     -  229s
     0     0 2093.67169    0  691 -12274.777 2093.67169   117%     -  229s
     0     0 1973.43445    0  617 -12274.777 1973.43445   116%     -  237s
     0     0 1969.04149    0  630 -12274.777 1969.04149   116%     -  241s
     0     0 1886.27967    0  621 -12274.777 1886.27967   115%     -  251s
     0     0 1875.35134    0  548 -12274.777 1875.35134   115%     -  255s
     0     0 1875.14354    0  610 -12274.777 1875.14354   115%     -  256s
H    0     0                    -12064.94343 -180.26685  98.5%     -  317s
H    0     0                    -12040.67560 -180.26685  98.5%     -  317s
H    0     0                    -11965.82154 -180.26685  98.5%     -  317s
     0     0 -180.26685    0  597 -11965.822 -180.26685  98.5%     -  317s
H    0     0                    -11918.07636 -180.66343  98.5%     -  317s
     0     0 -473.59556    0  435 -11918.076 -473.59556  96.0%     -  339s
     0     0 -554.52251    0  370 -11918.076 -554.52251  95.3%     -  352s
     0     0 -578.93187    0  623 -11918.076 -578.93187  95.1%     -  359s
     0     0 -735.57604    0  598 -11918.076 -735.57604  93.8%     -  371s
     0     0 -809.20425    0  607 -11918.076 -809.20425  93.2%     -  380s
     0     0 -847.29557    0  619 -11918.076 -847.29557  92.9%     -  386s
     0     0 -1062.7677    0  680 -11918.076 -1062.7677  91.1%     -  394s
     0     0 -1091.4499    0  623 -11918.076 -1091.4499  90.8%     -  397s
     0     0 -1136.7237    0  552 -11918.076 -1136.7237  90.5%     -  401s
     0     0 -1197.3091    0  700 -11918.076 -1197.3091  90.0%     -  405s
     0     0 -1210.5794    0  641 -11918.076 -1210.5794  89.8%     -  407s
     0     0 -1213.8201    0  638 -11918.076 -1213.8201  89.8%     -  409s
     0     0 -1221.0052    0  644 -11918.076 -1221.0052  89.8%     -  410s
     0     0 -1222.2332    0  647 -11918.076 -1222.2332  89.7%     -  411s
     0     0 -2021.1568    0  467 -11918.076 -2021.1568  83.0%     -  432s
     0     0 -2178.0220    0  561 -11918.076 -2178.0220  81.7%     -  439s
     0     0 -2251.1777    0  566 -11918.076 -2251.1777  81.1%     -  445s
     0     0 -2281.0057    0  566 -11918.076 -2281.0057  80.9%     -  449s
     0     0 -2285.8108    0  569 -11918.076 -2285.8108  80.8%     -  451s
     0     0 -2352.7873    0  639 -11918.076 -2352.7873  80.3%     -  455s
     0     0 -2388.1210    0  561 -11918.076 -2388.1210  80.0%     -  458s
     0     0 -2418.6407    0  574 -11918.076 -2418.6407  79.7%     -  460s
     0     0 -2432.9249    0  578 -11918.076 -2432.9249  79.6%     -  463s
     0     0 -2434.4330    0  576 -11918.076 -2434.4330  79.6%     -  464s
     0     0 -2805.3036    0  550 -11918.076 -2805.3036  76.5%     -  476s
     0     0 -2858.1418    0  546 -11918.076 -2858.1418  76.0%     -  480s
     0     0 -2900.7254    0  548 -11918.076 -2900.7254  75.7%     -  484s
     0     0 -2923.2017    0  553 -11918.076 -2923.2017  75.5%     -  486s
     0     0 -2926.0861    0  557 -11918.076 -2926.0861  75.4%     -  488s
     0     0 -2931.4391    0  558 -11918.076 -2931.4391  75.4%     -  489s
     0     0 -2932.3771    0  555 -11918.076 -2932.3771  75.4%     -  490s
     0     0 -3038.2926    0  556 -11918.076 -3038.2926  74.5%     -  497s
H    0     0                    -11894.11889 -3038.8497  74.5%     -  497s
     0     0 -3058.9624    0  576 -11894.119 -3058.9624  74.3%     -  500s
     0     0 -3062.1954    0  580 -11894.119 -3062.1954  74.3%     -  501s
     0     0 -3064.5367    0  576 -11894.119 -3064.5367  74.2%     -  501s
     0     0 -3136.0362    0  575 -11894.119 -3136.0362  73.6%     -  512s
     0     0 -3145.1248    0  573 -11894.119 -3145.1248  73.6%     -  514s
     0     0 -3151.8172    0  585 -11894.119 -3151.8172  73.5%     -  516s
H    0     0                    -11885.81927 -3154.1532  73.5%     -  517s
H    0     0                    -11878.12973 -3154.1532  73.4%     -  517s
H    0     0                    -11866.27608 -3154.1532  73.4%     -  517s
H    0     0                    -11858.73424 -3154.1532  73.4%     -  517s
     0     0 -3154.1532    0  579 -11858.734 -3154.1532  73.4%     -  517s
     0     0 -3186.8599    0  654 -11858.734 -3186.8599  73.1%     -  524s
     0     0 -3201.4680    0  661 -11858.734 -3201.4680  73.0%     -  533s
     0     0 -3207.3342    0  669 -11858.734 -3207.3342  73.0%     -  535s
     0     0 -3209.7382    0  665 -11858.734 -3209.7382  72.9%     -  536s
     0     0 -3248.0536    0  601 -11858.734 -3248.0536  72.6%     -  541s
H    0     0                    -11854.39523 -3250.2699  72.6%     -  542s
     0     0 -3267.2914    0  585 -11854.395 -3267.2914  72.4%     -  545s
     0     0 -3271.0410    0  593 -11854.395 -3271.0410  72.4%     -  546s
     0     0 -3272.6747    0  589 -11854.395 -3272.6747  72.4%     -  547s
     0     0 -3318.7687    0  586 -11854.395 -3318.7687  72.0%     -  553s
H    0     0                    -11813.63327 -3319.2586  71.9%     -  554s
H    0     0                    -11702.12360 -3319.2586  71.6%     -  555s
     0     0 -3326.7457    0  607 -11702.124 -3326.7457  71.6%     -  556s
     0     0 -3327.7142    0  601 -11702.124 -3327.7142  71.6%     -  557s
     0     0 -3353.3412    0  579 -11702.124 -3353.3412  71.3%     -  562s
     0     0 -3356.2645    0  597 -11702.124 -3356.2645  71.3%     -  564s
     0     0 -3359.5559    0  590 -11702.124 -3359.5559  71.3%     -  564s
     0     0 -3362.5530    0  600 -11702.124 -3362.5530  71.3%     -  565s
     0     0 -3364.0577    0  600 -11702.124 -3364.0577  71.3%     -  566s
     0     0 -3404.2524    0  660 -11702.124 -3404.2524  70.9%     -  572s
     0     0 -3419.2024    0  569 -11702.124 -3419.2024  70.8%     -  576s
     0     0 -3424.6194    0  659 -11702.124 -3424.6194  70.7%     -  577s
     0     0 -3426.2183    0  584 -11702.124 -3426.2183  70.7%     -  578s
     0     0 -3440.5595    0  670 -11702.124 -3440.5595  70.6%     -  581s
     0     0 -3442.8448    0  671 -11702.124 -3442.8448  70.6%     -  583s
     0     0 -3446.0615    0  595 -11702.124 -3446.0615  70.6%     -  586s
H    0     0                    -11635.83407 -3446.4520  70.4%     -  587s
     0     0 -3449.6510    0  599 -11635.834 -3449.6510  70.4%     -  589s
     0     0 -3450.7040    0  600 -11635.834 -3450.7040  70.3%     -  589s
     0     0 -3452.3820    0  610 -11635.834 -3452.3820  70.3%     -  592s
     0     0 -3454.3092    0  612 -11635.834 -3454.3092  70.3%     -  593s
     0     0 -3455.5184    0  609 -11635.834 -3455.5184  70.3%     -  596s
     0     0 -3455.6485    0  609 -11635.834 -3455.6485  70.3%     -  599s
     0     2 -3455.6485    0  609 -11635.834 -3455.6485  70.3%     -  696s
     1     3 -3524.0488    1  509 -11635.834 -3455.6711  70.3%  3520  700s
     2     6 -3608.6493    2  510 -11635.834 -3455.6711  70.3%  3774  705s
     5    10 -3960.4134    2  590 -11635.834 -3573.7947  69.3%  5036  718s
     9    19 -4553.3893    3  552 -11635.834 -3573.7947  69.3%  7452  731s
    18    28 -4819.1048    4  643 -11635.834 -3961.1844  66.0%  8151  781s
    27    55 -5379.6197    4  530 -11635.834 -4015.7240  65.5%  8585  883s
    54    86 -5392.5815    5  524 -11635.834 -4015.7240  65.5% 33599  915s
    85   202 -5407.7646    6  533 -11635.834 -4015.7240  65.5% 23674  950s
   201   277 -6001.0205   10  429 -11635.834 -4015.7240  65.5% 12450  971s
   276   325 -6105.2319   17  441 -11635.834 -4015.7240  65.5% 10246  989s
   342   356 -6470.9595   14  338 -11635.834 -4015.7240  65.5%  9005 1007s
   389   387 -6937.1781   15  409 -11635.834 -4015.7240  65.5%  8536 1022s
H  405   387                    -11619.20353 -4015.7240  65.4%  8464 1022s
   420   427 -7083.0685   16  412 -11619.204 -4015.7240  65.4%  8433 1041s
   462   465 -7394.9732   17  339 -11619.204 -4015.7240  65.4%  8179 1056s
   510   497 -7652.0376   18  408 -11619.204 -4015.7240  65.4%  7956 1076s
   560   536 -7886.3819   19  402 -11619.204 -4015.7240  65.4%  7698 1096s
   603   569 -9219.7352   21  404 -11619.204 -4015.7240  65.4%  7586 1113s
   654   603 -9736.6214   22  300 -11619.204 -4015.7240  65.4%  7348 1132s
   706   642 -9905.2839   24  300 -11619.204 -4015.7240  65.4%  7148 1150s
   773   673 -11285.404   27  136 -11619.204 -4015.7240  65.4%  6866 1168s
   826   692 -11379.028   29  134 -11619.204 -4015.7240  65.4%  6755 1186s
   863   714 -11410.460   30  115 -11619.204 -4015.7240  65.4%  6706 1204s
   901   744 -11414.057   31  119 -11619.204 -4015.7240  65.4%  6673 1223s
   937   765 -11463.700   32  116 -11619.204 -4015.7240  65.4%  6604 1239s
   980   794 -9857.6281   14  185 -11619.204 -4015.7240  65.4%  6492 1257s
  1052   823 -11466.139   16  146 -11619.204 -4015.7240  65.4%  6299 1274s
  1107   860 -10944.869   16  156 -11619.204 -4015.7240  65.4%  6233 1295s
  1168   901 -10076.675   19  422 -11619.204 -4015.7240  65.4%  6131 1313s
  1215   968 -10260.792   20  401 -11619.204 -4015.7240  65.4%  6079 1331s
  1301  1025 -10731.019   23  321 -11619.204 -4015.7240  65.4%  5901 1350s
  1406  1041 -11474.013   28  132 -11619.204 -4015.7240  65.4%  5683 1376s
  1521  1071 -11215.625   23  302 -11619.204 -4015.7240  65.4%  5489 1401s
  1616  1131     cutoff   24      -11619.204 -4015.7240  65.4%  5401 1428s
  1715  1164 -6394.3018   10  439 -11619.204 -4015.7240  65.4%  5323 1455s
  1790  1200 -7009.9670   11  355 -11619.204 -4799.4503  58.7%  5319 1484s
  1872  1260 -7270.7504   12  348 -11619.204 -4799.4503  58.7%  5314 1514s
  1966  1283 -8309.7478   13  301 -11619.204 -4799.4503  58.7%  5303 1536s
  1999  1320     cutoff   20      -11619.204 -4799.4503  58.7%  5323 1561s
  2086  1380 -8809.6810   12  350 -11619.204 -4900.0225  57.8%  5266 1586s
  2178  1421 -11199.531   14  474 -11619.204 -4900.0225  57.8%  5225 1617s
  2319  1472 -9278.9202   13  500 -11619.204 -4900.0225  57.8%  5113 1647s
  2411  1510 -9992.6822   13  345 -11619.204 -4900.0225  57.8%  5101 1682s
  2527  1559 -9261.3621   16  369 -11619.204 -4900.0225  57.8%  5093 1717s
  2630  1590     cutoff   18      -11619.204 -4900.0225  57.8%  5113 1756s
  2724  1629     cutoff   16      -11619.204 -4900.0225  57.8%  5162 1800s
  2856  1700     cutoff   19      -11619.204 -5122.7370  55.9%  5126 1843s
  2987  1760 -6119.0628   11  442 -11619.204 -5319.1547  54.2%  5112 1889s
  3135  1781 -7075.1201   12  413 -11619.204 -5319.1547  54.2%  5086 1927s
  3178  1803 -7290.9294   13  404 -11619.204 -5319.1547  54.2%  5104 1968s
  3218  1833 -8178.4617   14  312 -11619.204 -5319.1547  54.2%  5116 2003s
  3276  1850 -10951.198   15   75 -11619.204 -5319.1547  54.2%  5100 2039s
  3337  1876 -11409.859   16   61 -11619.204 -5433.1894  53.2%  5104 2077s
  3427  1907     cutoff   17      -11619.204 -5433.1894  53.2%  5093 2121s
  3525  1949     cutoff   17      -11619.204 -5536.0758  52.4%  5085 2171s
  3649  2004 -9039.2711   18  498 -11619.204 -5536.0758  52.4%  5079 2225s
  3838  2074 -10880.199   23  436 -11619.204 -5536.0758  52.4%  5026 2277s
  4004  2122 -7710.0660    8  199 -11619.204 -5627.4296  51.6%  5042 2332s
  4200  2156 -10815.455   10   56 -11619.204 -5641.1379  51.4%  5066 2390s
  4395  2182     cutoff   11      -11619.204 -5641.1379  51.4%  5096 2442s
  4508  2227 -10710.977   11  396 -11619.204 -5641.1379  51.4%  5128 2510s
  4669  2256 infeasible   11      -11619.204 -5718.4381  50.8%  5184 2581s
  4855  2302 -8277.6164   13  408 -11619.204 -5763.4989  50.4%  5242 2645s
  5071  2358     cutoff   15      -11619.204 -5763.4989  50.4%  5276 2719s
  5293  2381     cutoff   18      -11619.204 -5901.9139  49.2%  5331 2794s
  5368  2399 -10769.823   17  371 -11619.204 -5901.9139  49.2%  5343 2868s
  5474  2443 infeasible   18      -11619.204 -5901.9139  49.2%  5342 2941s
  5598  2480 -7246.2690   15  395 -11619.204 -5901.9139  49.2%  5371 3060s
  5824  2525 -10794.387   16  535 -11619.204 -5901.9139  49.2%  5370 3149s
  6032  2573 -6820.2712   15  422 -11619.204 -5901.9139  49.2%  5381 3257s
  6218  2619     cutoff   17      -11619.204 -6001.7646  48.3%  5429 3344s
  6476  2671     cutoff   20      -11619.204 -6001.7646  48.3%  5424 3436s
  6784  2722 -9209.2974   11  302 -11619.204 -6122.5332  47.3%  5420 3540s
  7085  2737 -9267.9144   12  317 -11619.204 -6122.5332  47.3%  5443 3600s

Cutting planes:
  Learned: 1
  Gomory: 10
  Implied bound: 231
  MIR: 3403
  Flow cover: 3602
  RLT: 197
  Relax-and-lift: 1217

Explored 7316 nodes (40452752 simplex iterations) in 3600.08 seconds (9502.27 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11619.2 -11635.8 -11702.1 ... -11894.1

Time limit reached
Best objective -1.161920352911e+04, best bound -6.177786614158e+03, gap 46.8312%
  WARNING: Time limit reached. Using best solution found (gap: 46.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -11619.20, θ = 113468.98
  Upper Bound (UB) = -11619.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113468.98
  [DEBUG]   ✓ Scenario 0: θ = 113468.98 ≤ Q = 113468.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113468.98 ≤ Q = 113468.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113468.98 ≤ Q = 113468.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113468.98 ≤ Q = 113468.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113468.98 ≤ Q = 113468.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6fb06319
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6fb06319
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.247290e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6302244.8151
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.246256e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124625.58    0  123 6302244.82 -124625.58   102%     -    0s
H    0     0                    -89415.16207 -124625.58  39.4%     -    0s
H    0     0                    -90335.15048 -124625.58  38.0%     -    0s
     0     0 -94156.542    0   89 -90335.150 -94156.542  4.23%     -    0s
H    0     0                    -92328.20143 -94150.199  1.97%     -    0s
H    0     0                    -92673.62717 -94150.199  1.59%     -    0s
     0     0 -93878.770    0   89 -92673.627 -93878.770  1.30%     -    0s
     0     0 -93855.247    0   90 -92673.627 -93855.247  1.28%     -    0s
     0     0 -93854.174    0   90 -92673.627 -93854.174  1.27%     -    0s
     0     0 -93655.639    0   87 -92673.627 -93655.639  1.06%     -    0s
     0     0 -93596.002    0   87 -92673.627 -93596.002  1.00%     -    0s
H    0     0                    -92956.35346 -93596.002  0.69%     -    0s
H    0     0                    -92984.56102 -93596.002  0.66%     -    0s
H    0     0                    -93275.94357 -93596.002  0.34%     -    0s
H    0     0                    -93295.48626 -93596.002  0.32%     -    0s
     0     2 -93596.002    0   87 -93295.486 -93596.002  0.32%     -    0s
H   31     8                    -93298.16293 -93408.897  0.12%   5.7    0s
H   33     8                    -93320.10817 -93401.871  0.09%   5.5    0s
H   89     7                    -93330.65445 -93366.820  0.04%   4.4    0s

Cutting planes:
  Gomory: 12
  MIR: 169

Explored 118 nodes (953 simplex iterations) in 0.10 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -93330.7 -93320.1 -93298.2 ... -90335.2
No other solutions better than -93330.7

Optimal solution found (tolerance 1.00e-06)
Best objective -9.333065444850e+04, best bound -9.333065444850e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 112763.27
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93330.65
  [DEBUG]   S×d_nominal = 206093.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 206093.93 + -93330.65 = 112763.27
  [DEBUG]   Current θ from Master = 113468.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 705.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12324.91
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 705.7033, Absolute Gap = 705.7033, Relative Gap = 0.060736
  Not converged yet (gap = 705.70 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524363 nonzeros
Model fingerprint: 0x334d67d0
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82476 rows and 33486 columns
Presolve time: 2.04s
Presolved: 102387 rows, 43654 columns, 619475 nonzeros
Variable types: 41395 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367905.1658
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 719
 AA' NZ     : 3.057e+06
 Factor NZ  : 7.663e+06 (roughly 120 MB of memory)
 Factor Ops : 1.556e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72942571e+07  1.76560228e+08  8.67e+04 1.64e+01  7.07e+04     3s
   1  -1.28225742e+07  1.55610901e+08  5.90e+04 5.77e+01  4.77e+04     3s
   2  -4.61809224e+06  1.22298857e+08  2.08e+04 8.97e-01  1.78e+04     3s
   3  -7.93417607e+05  8.39524797e+07  1.58e+03 1.36e+00  1.71e+03     3s
   4  -5.10980913e+05  5.95112963e+07  4.37e+02 8.39e-01  6.48e+02     4s
   5  -4.34841880e+05  3.36892899e+07  2.13e+02 4.11e-01  3.26e+02     4s
   6  -3.66292326e+05  2.71555328e+07  1.01e+02 3.16e-01  2.11e+02     4s
   7  -3.20799645e+05  1.97625277e+07  5.11e+01 2.16e-01  1.36e+02     4s
   8  -1.83407781e+05  1.11499411e+07  4.02e-01 1.13e-01  6.06e+01     4s
   9  -1.33148041e+05  7.20802232e+06  1.87e-01 7.30e-02  3.92e+01     4s
  10  -8.34938173e+04  2.68885621e+06  9.09e-02 2.63e-02  1.48e+01     4s
  11  -4.19544684e+04  1.00072430e+06  3.23e-02 9.26e-03  5.56e+00     4s
  12  -2.90532940e+04  3.82326432e+05  1.39e-02 3.36e-03  2.19e+00     4s
  13  -2.02048344e+04  2.16411322e+05  7.40e-03 1.91e-03  1.26e+00     4s
  14  -1.49114416e+04  1.25061228e+05  5.01e-03 1.25e-03  7.46e-01     4s
  15  -1.11757590e+04  8.76479805e+04  3.91e-03 9.44e-04  5.27e-01     4s
  16  -6.10983737e+03  6.38564934e+04  2.74e-03 6.63e-04  3.73e-01     4s
  17  -2.29453354e+03  4.21173322e+04  2.05e-03 4.91e-04  2.37e-01     4s
  18  -3.17176150e+02  3.25614737e+04  1.72e-03 3.48e-04  1.75e-01     4s
  19   2.27750542e+03  2.87313247e+04  1.31e-03 2.83e-04  1.41e-01     4s
  20   3.83490209e+03  2.40559963e+04  1.06e-03 2.07e-04  1.08e-01     4s
  21   5.41368847e+03  1.92722196e+04  8.29e-04 2.03e-04  7.39e-02     5s
  22   6.98943957e+03  1.77536882e+04  6.12e-04 1.63e-04  5.74e-02     5s
  23   7.61062039e+03  1.62696432e+04  5.30e-04 1.22e-04  4.61e-02     5s
  24   8.31318735e+03  1.54457533e+04  4.38e-04 1.00e-04  3.80e-02     5s
  25   8.72752498e+03  1.47515123e+04  3.80e-04 8.12e-05  3.21e-02     5s
  26   9.00870549e+03  1.41191924e+04  3.45e-04 6.39e-05  2.72e-02     5s
  27   9.44781907e+03  1.38236795e+04  2.90e-04 5.57e-05  2.33e-02     5s
  28   9.86031268e+03  1.34672683e+04  2.35e-04 4.58e-05  1.92e-02     5s
  29   9.98815672e+03  1.32898147e+04  2.19e-04 4.09e-05  1.76e-02     5s
  30   1.02100954e+04  1.28863826e+04  1.91e-04 3.06e-05  1.43e-02     5s
  31   1.04497005e+04  1.26790182e+04  1.61e-04 2.53e-05  1.19e-02     5s
  32   1.06855903e+04  1.25507866e+04  1.30e-04 2.18e-05  9.94e-03     5s
  33   1.07942616e+04  1.23311957e+04  1.16e-04 1.57e-05  8.19e-03     5s
  34   1.08671063e+04  1.23010834e+04  1.07e-04 1.49e-05  7.64e-03     5s
  35   1.09915338e+04  1.21518467e+04  9.08e-05 1.10e-05  6.18e-03     5s
  36   1.11137611e+04  1.20780502e+04  7.54e-05 8.99e-06  5.14e-03     6s
  37   1.12101509e+04  1.19689778e+04  6.20e-05 6.20e-06  4.04e-03     6s
  38   1.13132676e+04  1.18716115e+04  4.98e-05 3.65e-06  2.98e-03     6s
  39   1.13749839e+04  1.18320965e+04  4.20e-05 2.72e-06  2.44e-03     6s
  40   1.14999581e+04  1.18087934e+04  2.72e-05 2.00e-06  1.65e-03     6s
  41   1.15231033e+04  1.17785710e+04  2.45e-05 1.30e-06  1.36e-03     6s
  42   1.15534555e+04  1.17663083e+04  2.10e-05 1.29e-06  1.13e-03     6s
  43   1.15632503e+04  1.17582380e+04  1.97e-05 1.00e-06  1.04e-03     6s
  44   1.15792536e+04  1.17498015e+04  1.78e-05 6.60e-07  9.09e-04     6s
  45   1.16190498e+04  1.17450112e+04  1.31e-05 5.13e-07  6.71e-04     6s
  46   1.16407907e+04  1.17423813e+04  1.05e-05 4.34e-07  5.41e-04     6s
  47   1.16773436e+04  1.17391138e+04  6.00e-06 3.14e-07  3.29e-04     6s
  48   1.16888669e+04  1.17358619e+04  4.65e-06 2.93e-07  2.50e-04     6s
  49   1.17006848e+04  1.17328932e+04  3.24e-06 2.12e-07  1.72e-04     6s
  50   1.17030583e+04  1.17318351e+04  2.95e-06 1.54e-07  1.53e-04     7s
  51   1.17054217e+04  1.17310230e+04  2.68e-06 8.60e-08  1.36e-04     7s
  52   1.17095902e+04  1.17304199e+04  2.19e-06 1.22e-07  1.11e-04     7s
  53   1.17145839e+04  1.17303989e+04  1.62e-06 1.19e-07  8.43e-05     7s
  54   1.17277004e+04  1.17291119e+04  9.88e-08 8.60e-09  7.52e-06     7s
  55   1.17282456e+04  1.17288782e+04  5.22e-08 1.49e-10  3.37e-06     7s
  56   1.17282743e+04  1.17288725e+04  4.82e-08 1.01e-10  3.19e-06     7s
  57   1.17287962e+04  1.17288652e+04  1.32e-08 6.33e-11  3.68e-07     7s
  58   1.17287988e+04  1.17288650e+04  9.84e-07 7.95e-09  3.53e-07     7s
  59   1.17287993e+04  1.17288649e+04  1.62e-06 7.55e-09  3.50e-07     7s
  60   1.17288129e+04  1.17288628e+04  7.77e-06 5.89e-07  2.66e-07     7s
  61   1.17288310e+04  1.17288626e+04  4.77e-06 1.24e-07  1.69e-07     7s
  62   1.17288611e+04  1.17288625e+04  2.98e-07 2.98e-09  7.46e-09     7s
  63   1.17288619e+04  1.17288625e+04  1.28e-07 1.43e-08  2.93e-09     7s
  64   1.17288624e+04  1.17288625e+04  1.87e-08 6.77e-10  1.72e-10     8s

Barrier solved model in 64 iterations and 7.51 seconds (11.14 work units)
Optimal objective 1.17288624e+04


Root crossover log...

   78710 DPushes remaining with DInf 0.0000000e+00                 8s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    6391 PPushes remaining with PInf 2.7056848e-05                10s
      66 PPushes remaining with PInf 7.9940981e-06                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2752991e+02     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39589    1.1728862e+04   0.000000e+00   2.275299e+02     10s
   39592    1.1728862e+04   0.000000e+00   0.000000e+00     10s
   39592    1.1728862e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.172886e+04, 39592 iterations, 7.49 seconds (14.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11728.8625    0  476 -196434.75 11728.8625   106%     -   10s
H    0     0                    -150283.2006 11728.8625   108%     -   10s
H    0     0                    -145484.8301 11728.8625   108%     -   10s
H    0     0                    -104985.4493 11728.8625   111%     -   10s
H    0     0                    -92098.86964 11728.8625   113%     -   11s
H    0     0                    -62508.96251 11728.8625   119%     -   11s
H    0     0                    -45739.19467 11728.8625   126%     -   11s
H    0     0                    -45584.06829 11728.8625   126%     -   11s
H    0     0                    -23336.54000 11728.8625   150%     -   13s
H    0     0                    -22861.34610 11728.8625   151%     -   13s
H    0     0                    -22842.26073 11728.8625   151%     -   13s
H    0     0                    -22832.11059 11728.8625   151%     -   13s
H    0     0                    -22809.59548 11728.8625   151%     -   13s
H    0     0                    -22803.07372 11728.8625   151%     -   13s
H    0     0                    -21076.19118 7501.64464   136%     -   40s
H    0     0                    -20892.68814 7501.64464   136%     -   40s
H    0     0                    -20819.00193 7501.64464   136%     -   40s
     0     0 7479.29682    0  625 -20819.002 7479.29682   136%     -   40s
H    0     0                    -20808.39300 7479.29682   136%     -   40s
     0     0 7069.15895    0  651 -20808.393 7069.15895   134%     -   60s
     0     0 6915.75787    0  642 -20808.393 6915.75787   133%     -   69s
     0     0 6796.72608    0  633 -20808.393 6796.72608   133%     -   74s
     0     0 6716.41920    0  625 -20808.393 6716.41920   132%     -   80s
     0     0 6713.65615    0  623 -20808.393 6713.65615   132%     -   82s
     0     0 6712.07746    0  621 -20808.393 6712.07746   132%     -   84s
     0     0 6711.83453    0  616 -20808.393 6711.83453   132%     -   85s
     0     0 6702.02929    0  628 -20808.393 6702.02929   132%     -   87s
H    0     0                    -20186.71413 4120.17959   120%     -  125s
H    0     0                    -19274.78937 4120.17959   121%     -  125s
H    0     0                    -18872.57639 4120.17959   122%     -  125s
H    0     0                    -18806.19600 4120.17959   122%     -  125s
H    0     0                    -18449.44453 4120.17959   122%     -  125s
H    0     0                    -18437.85084 4120.17959   122%     -  125s
H    0     0                    -18418.45995 4120.17959   122%     -  125s
H    0     0                    -18396.55578 4120.17959   122%     -  125s
H    0     0                    -18394.72087 4120.17959   122%     -  125s
H    0     0                    -17292.80097 4120.17959   124%     -  125s
H    0     0                    -17277.28536 4120.17959   124%     -  125s
     0     0 4120.17959    0  732 -17277.285 4120.17959   124%     -  130s
H    0     0                    -12888.72047 4119.38232   132%     -  130s
H    0     0                    -12675.76240 4119.38232   132%     -  130s
H    0     0                    -12561.62805 4119.38232   133%     -  130s
H    0     0                    -12479.92221 4119.38232   133%     -  131s
H    0     0                    -12474.03050 4119.38232   133%     -  131s
H    0     0                    -12391.43593 4119.38232   133%     -  131s
     0     0 3392.79322    0  787 -12391.436 3392.79322   127%     -  164s
     0     0 3182.02284    0  790 -12391.436 3182.02284   126%     -  186s
     0     0 3064.32857    0  771 -12391.436 3064.32857   125%     -  201s
     0     0 2885.48797    0  785 -12391.436 2885.48797   123%     -  219s
     0     0 2866.70876    0  780 -12391.436 2866.70876   123%     -  226s
     0     0 2847.58888    0  783 -12391.436 2847.58888   123%     -  233s
     0     0 2830.04228    0  787 -12391.436 2830.04228   123%     -  238s
     0     0 2822.34574    0  767 -12391.436 2822.34574   123%     -  240s
     0     0 2818.06032    0  772 -12391.436 2818.06032   123%     -  241s
     0     0 2817.27759    0  780 -12391.436 2817.27759   123%     -  242s
     0     0  386.72115    0  537 -12391.436  386.72115   103%     -  301s
H    0     0                    -11918.64027  385.91044   103%     -  301s
     0     0 -269.01949    0  641 -11918.640 -269.01949  97.7%     -  330s
H    0     0                    -11814.11337 -602.63287  94.9%     -  355s
H    0     0                    -11811.84467 -602.63287  94.9%     -  355s
H    0     0                    -11810.22044 -602.63287  94.9%     -  355s
H    0     0                    -11807.95174 -602.63287  94.9%     -  355s
H    0     0                    -11799.41669 -602.63287  94.9%     -  355s
     0     0 -602.63287    0  471 -11799.417 -602.63287  94.9%     -  355s
     0     0 -791.96432    0  709 -11799.417 -791.96432  93.3%     -  376s
     0     0 -942.34244    0  482 -11799.417 -942.34244  92.0%     -  388s
H    0     0                    -11761.94530 -996.07708  91.5%     -  401s
H    0     0                    -11758.05236 -996.07708  91.5%     -  401s
     0     0 -996.07708    0  709 -11758.052 -996.07708  91.5%     -  401s
     0     0 -1066.4298    0  477 -11758.052 -1066.4298  90.9%     -  411s
     0     0 -1079.1822    0  462 -11758.052 -1079.1822  90.8%     -  414s
H    0     0                    -11655.99709 -1142.7688  90.2%     -  425s
H    0     0                    -11635.83407 -1142.7688  90.2%     -  425s
     0     0 -1142.7688    0  760 -11635.834 -1142.7688  90.2%     -  425s
     0     0 -1165.4689    0  488 -11635.834 -1165.4689  90.0%     -  431s
     0     0 -1225.5318    0  471 -11635.834 -1225.5318  89.5%     -  436s
     0     0 -1276.0554    0  705 -11635.834 -1276.0554  89.0%     -  441s
     0     0 -1297.6983    0  551 -11635.834 -1297.6983  88.8%     -  444s
     0     0 -1310.0898    0  569 -11635.834 -1310.0898  88.7%     -  446s
     0     0 -1310.4384    0  567 -11635.834 -1310.4384  88.7%     -  446s
     0     0 -2199.1308    0  474 -11635.834 -2199.1308  81.1%     -  470s
     0     0 -2380.9558    0  510 -11635.834 -2380.9558  79.5%     -  482s
     0     0 -2516.1749    0  538 -11635.834 -2516.1749  78.4%     -  490s
     0     0 -2545.3014    0  694 -11635.834 -2545.3014  78.1%     -  494s
     0     0 -2566.8653    0  563 -11635.834 -2566.8653  77.9%     -  496s
     0     0 -2574.8321    0  482 -11635.834 -2574.8321  77.9%     -  498s
     0     0 -2603.2568    0  559 -11635.834 -2603.2568  77.6%     -  502s
     0     0 -2606.5192    0  489 -11635.834 -2606.5192  77.6%     -  504s
     0     0 -2626.2996    0  500 -11635.834 -2626.2996  77.4%     -  516s
     0     0 -2628.8982    0  488 -11635.834 -2628.8982  77.4%     -  518s
     0     0 -2629.0028    0  483 -11635.834 -2629.0028  77.4%     -  518s
     0     0 -2789.3693    0  552 -11635.834 -2789.3693  76.0%     -  529s
     0     0 -2855.5811    0  883 -11635.834 -2855.5811  75.5%     -  539s
     0     0 -2870.5987    0  570 -11635.834 -2870.5987  75.3%     -  542s
     0     0 -2875.4640    0  661 -11635.834 -2875.4640  75.3%     -  544s
     0     0 -2879.5535    0  754 -11635.834 -2879.5535  75.3%     -  546s
     0     0 -2888.3212    0  761 -11635.834 -2888.3212  75.2%     -  549s
     0     0 -2915.5871    0  640 -11635.834 -2915.5871  74.9%     -  553s
     0     0 -2924.1118    0  648 -11635.834 -2924.1118  74.9%     -  555s
     0     0 -2926.0497    0  651 -11635.834 -2926.0497  74.9%     -  555s
     0     0 -3063.9562    0  810 -11635.834 -3063.9562  73.7%     -  569s
     0     0 -3076.0892    0  804 -11635.834 -3076.0892  73.6%     -  579s
     0     0 -3078.5909    0  797 -11635.834 -3078.5909  73.5%     -  582s
     0     0 -3085.5813    0  741 -11635.834 -3085.5813  73.5%     -  585s
     0     0 -3086.9413    0  739 -11635.834 -3086.9413  73.5%     -  586s
     0     0 -3119.0322    0  557 -11635.834 -3119.0322  73.2%     -  592s
     0     0 -3131.6310    0  666 -11635.834 -3131.6310  73.1%     -  597s
     0     0 -3134.5897    0  671 -11635.834 -3134.5897  73.1%     -  599s
     0     0 -3135.9409    0  667 -11635.834 -3135.9409  73.0%     -  600s
     0     0 -3208.1483    0  805 -11635.834 -3208.1483  72.4%     -  611s
     0     0 -3219.4942    0  707 -11635.834 -3219.4942  72.3%     -  616s
     0     0 -3221.0218    0  709 -11635.834 -3221.0218  72.3%     -  619s
     0     0 -3290.6765    0  703 -11635.834 -3290.6765  71.7%     -  627s
     0     0 -3298.0826    0  574 -11635.834 -3298.0826  71.7%     -  630s
     0     0 -3304.0741    0  576 -11635.834 -3304.0741  71.6%     -  632s
     0     0 -3305.4527    0  577 -11635.834 -3305.4527  71.6%     -  633s
     0     0 -3323.2984    0  483 -11635.834 -3323.2984  71.4%     -  638s
     0     0 -3326.6000    0  571 -11635.834 -3326.6000  71.4%     -  641s
     0     0 -3328.2417    0  584 -11635.834 -3328.2417  71.4%     -  643s
     0     0 -3343.8435    0  659 -11635.834 -3343.8435  71.3%     -  648s
     0     0 -3347.5083    0  652 -11635.834 -3347.5083  71.2%     -  651s
     0     0 -3349.1883    0  649 -11635.834 -3349.1883  71.2%     -  651s
     0     0 -3353.1996    0  574 -11635.834 -3353.1996  71.2%     -  655s
     0     0 -3353.2714    0  574 -11635.834 -3353.2714  71.2%     -  659s
     0     2 -3353.2920    0  574 -11635.834 -3353.2920  71.2%     -  821s
     1     3 -4230.7346    1  616 -11635.834 -3353.2920  71.2% 10002  831s
     2     6 -4485.5575    2  460 -11635.834 -3353.2920  71.2%  7690  837s
     5     9 -4607.1399    2  587 -11635.834 -3476.6879  70.1%  8969  860s
     8    16 -6528.1949    4  324 -11635.834 -3476.6879  70.1% 12594  872s
    15    32 -5097.3589    3  454 -11635.834 -3839.3885  67.0% 11148  887s
    31    50 -8442.2361    6  185 -11635.834 -3967.9210  65.9% 15056  931s
    49    78 -5311.7154    5  464 -11635.834 -3967.9210  65.9% 14016  949s
    81   146 -5368.2893    6  437 -11635.834 -3967.9210  65.9% 11643  968s
   151   199 -5407.1004    7  432 -11635.834 -3967.9210  65.9%  8633  982s
H  152   199                    -11623.48292 -3967.9210  65.9%  8576  982s
   208   248 -5414.1241    8  437 -11623.483 -3967.9210  65.9%  7620  998s
   283   292 -5823.3281    8  358 -11623.483 -3967.9210  65.9%  7114 1015s
   355   329 -5944.3577    9  355 -11623.483 -3967.9210  65.9%  6751 1030s
   416   359 -6087.8089    9  365 -11623.483 -3967.9210  65.9%  6611 1045s
   478   374 -6235.2460   11  415 -11623.483 -3967.9210  65.9%  6588 1062s
   531   390 -6438.1595   12  411 -11623.483 -3967.9210  65.9%  6634 1079s
   568   405 -7693.3398   13  285 -11623.483 -3967.9210  65.9%  6796 1096s
   607   428 -8900.4093   14  381 -11623.483 -3967.9210  65.9%  6954 1112s
   644   459 -9241.5512   15  288 -11623.483 -3967.9210  65.9%  6898 1127s
   699   466 infeasible   16      -11623.483 -3967.9210  65.9%  6912 1144s
   757   496 -9245.4850   16  289 -11623.483 -3967.9210  65.9%  6799 1161s
   817   517 -9624.1385   17  306 -11623.483 -3967.9210  65.9%  6831 1177s
   864   547 infeasible   18      -11623.483 -3967.9210  65.9%  6973 1195s
   917   595 -9735.2031   19  276 -11623.483 -3967.9210  65.9%  6944 1211s
   985   620 -10076.369   20  314 -11623.483 -3967.9210  65.9%  6937 1237s
  1016   639 -11483.341   31  228 -11623.483 -3967.9210  65.9%  6961 1267s
  1071   696 -10143.953   20  292 -11623.483 -3967.9210  65.9%  6893 1286s
  1150   739 -11135.848   21  266 -11623.483 -3967.9210  65.9%  6837 1301s
  1247   763 infeasible   22      -11623.483 -3967.9210  65.9%  6615 1319s
  1341   766 -11503.004   38  400 -11623.483 -3967.9210  65.9%  6442 1341s
  1420   770 infeasible   22      -11623.483 -3967.9210  65.9%  6379 1364s
  1470   779 infeasible   23      -11623.483 -3967.9210  65.9%  6458 1385s
  1507   794 infeasible   24      -11623.483 -3967.9210  65.9%  6535 1407s
  1557   827 -9711.8865   16  240 -11623.483 -3967.9210  65.9%  6622 1433s
  1608   849 -10221.942   18  187 -11623.483 -3967.9210  65.9%  6704 1457s
  1701   858 infeasible   19      -11623.483 -3967.9210  65.9%  6674 1485s
  1786   874 -11400.881   18  178 -11623.483 -3967.9210  65.9%  6749 1511s
  1832   894 -9654.4355    8  305 -11623.483 -3967.9210  65.9%  6915 1559s
  1878   918 infeasible    9      -11623.483 -3967.9210  65.9%  6913 1590s
  1952   935 -10298.982   10  283 -11623.483 -3967.9210  65.9%  7070 1616s
  2017   959     cutoff   11      -11623.483 -3967.9210  65.9%  7188 1647s
  2051   991 -10710.644   13  281 -11623.483 -3967.9210  65.9%  7327 1702s
  2095  1004 -11227.650   15  362 -11623.483 -3967.9210  65.9%  7448 1732s
  2184  1018 -8470.3132   15  511 -11623.483 -4324.8004  62.8%  7419 1763s
  2258  1036 -8825.3769   16  496 -11623.483 -4324.8956  62.8%  7463 1797s
  2336  1075 -10065.778   18  403 -11623.483 -4324.8956  62.8%  7530 1827s
  2430  1099 -10270.188   20  401 -11623.483 -4324.8956  62.8%  7619 1863s
  2531  1124 -10561.461   21  409 -11623.483 -4324.8956  62.8%  7667 1898s
  2612  1137 infeasible   22      -11623.483 -5097.6725  56.1%  7833 1940s
  2698  1162 -9153.8100    9  659 -11623.483 -5097.6725  56.1%  7868 1980s
  2823  1187     cutoff   11      -11623.483 -5411.0888  53.4%  7923 2023s
  2917  1220 -10489.226    9  694 -11623.483 -5411.0888  53.4%  8004 2064s
  3010  1264     cutoff   10      -11623.483 -5417.9771  53.4%  8153 2107s
  3130  1287 -8229.5157    6  339 -11623.483 -5417.9771  53.4%  8261 2156s
  3231  1332 -10552.228    8  297 -11623.483 -5417.9771  53.4%  8407 2214s
  3340  1353 infeasible   13      -11623.483 -5417.9771  53.4%  8541 2265s
  3471  1385 -10040.689   16  620 -11623.483 -5417.9771  53.4%  8642 2313s
  3613  1417 -10484.139   17  147 -11623.483 -5417.9771  53.4%  8683 2368s
  3773  1456 -11492.801   29   71 -11623.483 -5417.9771  53.4%  8754 2423s
  3934  1475 -11583.172   44   63 -11623.483 -5491.0202  52.8%  8835 2483s
  4079  1487 -10038.568   16  183 -11623.483 -5491.0202  52.8%  8801 2544s
  4224  1522 -8535.2456   14  523 -11623.483 -5896.5275  49.3%  8865 2607s
  4340  1576 -9322.5497   16  555 -11623.483 -5896.5633  49.3%  8993 2674s
  4511  1627 infeasible   19      -11623.483 -5896.5633  49.3%  9029 2739s
  4731  1669 infeasible   22      -11623.483 -5896.5633  49.3%  9061 2808s
  4951  1704 infeasible   23      -11623.483 -5896.5633  49.3%  9100 2876s
  5156  1720 infeasible   16      -11623.483 -6892.6384  40.7%  9218 2950s
  5357  1777 -9362.5696   13  460 -11623.483 -6941.9014  40.3%  9231 3027s
  5582  1834 -10628.671   14  335 -11623.483 -7108.4060  38.8%  9297 3110s
  5833  1924 -11498.602   17  319 -11623.483 -7116.5339  38.8%  9360 3200s
  6130  1982 -10627.659   11  520 -11623.483 -7116.5339  38.8%  9229 3294s
  6406  1987 -11564.011   25  279 -11623.483 -7304.6841  37.2%  9132 3374s
  6654  2060 -10183.617   14  655 -11623.483 -7337.3626  36.9%  9178 3464s
  6913  2133 -10804.267   23  512 -11623.483 -7459.0078  35.8%  9240 3562s
  7259  2134 -11336.820   25  291 -11623.483 -7504.6839  35.4%  9262 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 232
  MIR: 3395
  Flow cover: 3982
  RLT: 220
  Relax-and-lift: 1610

Explored 7435 nodes (69357895 simplex iterations) in 3600.06 seconds (9722.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11623.5 -11635.8 -11656 ... -11814.1

Time limit reached
Best objective -1.162348292017e+04, best bound -7.554533529414e+03, gap 35.0063%
  WARNING: Time limit reached. Using best solution found (gap: 35.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -11623.48, θ = 113460.17
  Upper Bound (UB) = -11623.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113460.17
  [DEBUG]   ✓ Scenario 0: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113460.17 ≤ Q = 113460.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113460.17 ≤ Q = 113460.17 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x565b7cad
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x565b7cad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.248434e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6309039.5001
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.245212e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124521.18    0  123 6309039.50 -124521.18   102%     -    0s
H    0     0                    -89303.80006 -124521.18  39.4%     -    0s
H    0     0                    -90230.18799 -124521.18  38.0%     -    0s
     0     0 -94440.140    0   81 -90230.188 -94440.140  4.67%     -    0s
H    0     0                    -91638.22135 -94391.465  3.00%     -    0s
     0     0 -94326.210    0   43 -91638.221 -94326.210  2.93%     -    0s
H    0     0                    -93700.36102 -94298.065  0.64%     -    0s
H    0     0                    -93992.57531 -94298.065  0.33%     -    0s
H    0     0                    -94024.75945 -94298.065  0.29%     -    0s
     0     0 -94178.088    0   35 -94024.759 -94178.088  0.16%     -    0s
     0     0 -94100.406    0   17 -94024.759 -94100.406  0.08%     -    0s
     0     0 -94077.653    0   11 -94024.759 -94077.653  0.06%     -    0s
     0     0 -94073.901    0    8 -94024.759 -94073.901  0.05%     -    0s
     0     0 -94072.068    0    7 -94024.759 -94072.068  0.05%     -    0s
H    0     0                    -94043.00769 -94067.804  0.03%     -    0s
     0     0 -94067.804    0    7 -94043.008 -94067.804  0.03%     -    0s
     0     0 -94051.954    0    4 -94043.008 -94051.954  0.01%     -    0s
     0     0 -94051.954    0    5 -94043.008 -94051.954  0.01%     -    0s
     0     0 -94047.572    0    3 -94043.008 -94047.572  0.00%     -    0s
H    0     0                    -94045.98078 -94047.572  0.00%     -    0s
     0     0     cutoff    0      -94045.981 -94045.981  0.00%     -    0s

Cutting planes:
  MIR: 2
  RLT: 1

Explored 1 nodes (508 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -94046 -94043 -94024.8 ... 1.24843e+13
No other solutions better than -94046

Optimal solution found (tolerance 1.00e-06)
Best objective -9.404598078395e+04, best bound -9.404598078395e+04, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 111951.89
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94045.98
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -94045.98 = 111951.89
  [DEBUG]   Current θ from Master = 113460.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1508.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13131.76
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 701.4239, Absolute Gap = 701.4239, Relative Gap = 0.060345
  Not converged yet (gap = 701.42 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567600 nonzeros
Model fingerprint: 0x535c6741
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89344 rows and 36274 columns
Presolve time: 2.18s
Presolved: 110809 rows, 47106 columns, 668573 nonzeros
Variable types: 44847 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -367859.4339
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 712
 AA' NZ     : 3.489e+06
 Factor NZ  : 8.916e+06 (roughly 140 MB of memory)
 Factor Ops : 1.994e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73131242e+07  1.88829759e+08  8.68e+04 1.96e+01  7.04e+04     3s
   1  -1.29081033e+07  1.66619777e+08  5.91e+04 5.55e+01  4.75e+04     3s
   2  -4.95271862e+06  1.31537612e+08  2.25e+04 8.78e-01  1.91e+04     4s
   3  -8.39191274e+05  9.20792402e+07  1.75e+03 1.23e+00  1.85e+03     4s
   4  -4.84590406e+05  4.12527445e+07  3.55e+02 2.75e-01  4.56e+02     4s
   5  -4.21619547e+05  2.59926562e+07  2.16e+02 1.53e-01  2.69e+02     4s
   6  -3.36503847e+05  2.03249618e+07  8.36e+01 1.13e-01  1.52e+02     4s
   7  -2.06770163e+05  1.51290717e+07  1.36e+01 7.81e-02  8.26e+01     4s
   8  -1.35192124e+05  7.44922511e+06  2.19e+00 3.87e-02  3.81e+01     4s
   9  -9.03709701e+04  4.65597003e+06  1.17e+00 2.37e-02  2.36e+01     4s
  10  -6.89082922e+04  2.60842672e+06  6.28e-01 1.30e-02  1.33e+01     4s
  11  -4.42133706e+04  7.44697350e+05  3.38e-01 3.52e-03  3.90e+00     4s
  12  -3.10853233e+04  2.99757780e+05  1.91e-01 1.33e-03  1.63e+00     4s
  13  -2.21695478e+04  1.55797389e+05  1.07e-01 7.20e-04  8.78e-01     4s
  14  -1.72349272e+04  9.66184813e+04  8.12e-02 5.69e-04  5.62e-01     4s
  15  -1.39193432e+04  6.72531430e+04  6.59e-02 1.20e-03  4.01e-01     4s
  16  -8.28272626e+03  5.38285216e+04  4.52e-02 1.07e-03  3.06e-01     4s
  17  -7.04460117e+03  4.98015175e+04  4.20e-02 9.48e-04  2.80e-01     4s
  18  -3.32497785e+03  3.46436653e+04  3.30e-02 1.35e-03  1.87e-01     4s
  19  -1.28636649e+03  2.71040657e+04  2.76e-02 1.15e-03  1.40e-01     4s
  20   3.96771043e+02  2.30264575e+04  2.36e-02 8.77e-04  1.12e-01     5s
  21   1.41516845e+03  2.00901173e+04  2.11e-02 6.76e-04  9.21e-02     5s
  22   2.74627813e+03  1.91049262e+04  1.80e-02 6.00e-04  8.07e-02     5s
  23   3.41979994e+03  1.86404166e+04  1.64e-02 5.67e-04  7.51e-02     5s
  24   4.21483287e+03  1.72410363e+04  1.46e-02 4.58e-04  6.43e-02     5s
  25   5.26778082e+03  1.59950774e+04  1.22e-02 3.54e-04  5.29e-02     5s
  26   6.80487465e+03  1.47661407e+04  8.92e-03 2.59e-04  3.93e-02     5s
  27   7.41523113e+03  1.36696061e+04  7.60e-03 5.10e-04  3.09e-02     5s
  28   7.98631091e+03  1.34747574e+04  6.45e-03 4.68e-04  2.71e-02     5s
  29   8.37852823e+03  1.31129762e+04  5.63e-03 3.91e-04  2.34e-02     5s
  30   8.86011189e+03  1.27290769e+04  4.61e-03 3.38e-04  1.91e-02     5s
  31   8.90992738e+03  1.23739691e+04  4.51e-03 2.81e-04  1.71e-02     5s
  32   9.33174480e+03  1.20751467e+04  3.64e-03 2.20e-04  1.35e-02     5s
  33   9.55351163e+03  1.19187808e+04  3.19e-03 1.68e-04  1.17e-02     5s
  34   9.95017504e+03  1.16748080e+04  2.39e-03 1.16e-04  8.51e-03     6s
  35   1.01896763e+04  1.15869018e+04  1.91e-03 9.59e-05  6.89e-03     6s
  36   1.03168859e+04  1.15405320e+04  1.66e-03 8.02e-05  6.04e-03     6s
  37   1.04407992e+04  1.14637395e+04  1.40e-03 6.36e-05  5.05e-03     6s
  38   1.04663571e+04  1.14196982e+04  1.35e-03 5.42e-05  4.70e-03     6s
  39   1.06236973e+04  1.13616282e+04  1.05e-03 4.04e-05  3.64e-03     6s
  40   1.07073987e+04  1.13354245e+04  8.81e-04 3.47e-05  3.10e-03     6s
  41   1.07612602e+04  1.12544592e+04  7.77e-04 4.07e-05  2.43e-03     6s
  42   1.08553569e+04  1.12268258e+04  5.86e-04 2.57e-05  1.83e-03     6s
  43   1.09168917e+04  1.12227475e+04  4.69e-04 2.36e-05  1.51e-03     6s
  44   1.10595483e+04  1.11866978e+04  1.95e-04 4.67e-05  6.27e-04     6s
  45   1.11008270e+04  1.11774113e+04  1.19e-04 2.36e-05  3.78e-04     6s
  46   1.11146757e+04  1.11759662e+04  9.32e-05 2.00e-05  3.02e-04     6s
  47   1.11177153e+04  1.11739805e+04  8.77e-05 1.50e-05  2.78e-04     6s
  48   1.11243007e+04  1.11703794e+04  7.62e-05 4.42e-06  2.27e-04     7s
  49   1.11625143e+04  1.11699987e+04  8.87e-06 3.62e-06  3.69e-05     7s
  50   1.11668635e+04  1.11680329e+04  1.83e-06 5.56e-08  5.77e-06     7s
  51   1.11680041e+04  1.11680097e+04  3.35e-09 1.03e-07  2.75e-08     7s
  52   1.11680079e+04  1.11680080e+04  2.92e-09 9.22e-09  2.58e-10     7s

Barrier solved model in 52 iterations and 6.87 seconds (10.20 work units)
Optimal objective 1.11680079e+04


Root crossover log...

   84280 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    4702 PPushes remaining with PInf 1.4084775e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.4400395e-11      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38299    1.1168008e+04   0.000000e+00   0.000000e+00      9s
   38299    1.1168008e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 1.116801e+04, 38299 iterations, 6.19 seconds (10.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11168.0079    0  522 -196434.75 11168.0079   106%     -    9s
H    0     0                    -81192.20724 11168.0079   114%     -    9s
H    0     0                    -80469.59067 11168.0079   114%     -   10s
H    0     0                    -75067.94463 11168.0079   115%     -   10s
H    0     0                    -66148.00066 11168.0079   117%     -   10s
H    0     0                    -53315.60411 11168.0079   121%     -   10s
H    0     0                    -52716.72204 11168.0079   121%     -   10s
H    0     0                    -52688.71775 11168.0079   121%     -   10s
H    0     0                    -47439.74077 11168.0079   124%     -   10s
H    0     0                    -32477.07711 6978.89481   121%     -   53s
H    0     0                    -29548.04937 6978.89481   124%     -   53s
H    0     0                    -29326.70185 6978.89481   124%     -   53s
H    0     0                    -29315.76393 6978.89481   124%     -   53s
H    0     0                    -29292.55280 6978.89481   124%     -   53s
H    0     0                    -29281.61488 6978.89481   124%     -   53s
H    0     0                    -29256.44989 6978.89481   124%     -   53s
H    0     0                    -29239.20171 6978.89481   124%     -   53s
H    0     0                    -29212.61054 6978.89481   124%     -   53s
H    0     0                    -29201.56091 6978.89481   124%     -   53s
H    0     0                    -29189.30718 6978.89481   124%     -   53s
H    0     0                    -29183.13430 6978.89481   124%     -   53s
     0     0 6978.89481    0  674 -29183.134 6978.89481   124%     -   53s
H    0     0                    -29166.17136 6976.64859   124%     -   54s
H    0     0                    -29162.98832 6976.64859   124%     -   54s
H    0     0                    -29156.57342 6976.64859   124%     -   54s
H    0     0                    -29151.34234 6976.64859   124%     -   54s
H    0     0                    -29136.40583 6976.64859   124%     -   54s
H    0     0                    -29136.29456 6976.64859   124%     -   54s
H    0     0                    -29135.54924 6976.64859   124%     -   54s
H    0     0                    -29125.76915 6976.64859   124%     -   54s
     0     0 6537.70112    0  659 -29125.769 6537.70112   122%     -   68s
     0     0 6487.93170    0  650 -29125.769 6487.93170   122%     -   74s
     0     0 6455.57404    0  730 -29125.769 6455.57404   122%     -   85s
     0     0 6455.57404    0  732 -29125.769 6455.57404   122%     -   90s
     0     0 6455.57404    0  712 -29125.769 6455.57404   122%     -  100s
     0     0 6455.45005    0  716 -29125.769 6455.45005   122%     -  102s
     0     0 6455.14750    0  716 -29125.769 6455.14750   122%     -  103s
H    0     0                    -28857.09449 4147.16442   114%     -  157s
H    0     0                    -28856.31563 4147.16442   114%     -  157s
H    0     0                    -24525.63665 4147.16442   117%     -  157s
H    0     0                    -18479.45063 4147.16442   122%     -  157s
H    0     0                    -17829.19293 4147.16442   123%     -  157s
H    0     0                    -15722.29059 4147.16442   126%     -  157s
H    0     0                    -12104.18697 4147.16442   134%     -  157s
H    0     0                    -12088.77978 4147.16442   134%     -  157s
H    0     0                    -11806.07404 4147.16442   135%     -  157s
     0     0 4112.88762    0  701 -11806.074 4112.88762   135%     -  157s
H    0     0                    -11713.39306 4112.88762   135%     -  158s
     0     0 3016.89416    0  750 -11713.393 3016.89416   126%     -  199s
     0     0 2747.30668    0  685 -11713.393 2747.30668   123%     -  231s
     0     0 2614.94339    0  761 -11713.393 2614.94339   122%     -  252s
     0     0 2536.88341    0  641 -11713.393 2536.88341   122%     -  265s
     0     0 2379.06547    0  755 -11713.393 2379.06547   120%     -  285s
     0     0 2290.33860    0  732 -11713.393 2290.33860   120%     -  295s
     0     0 2250.79472    0  752 -11713.393 2250.79472   119%     -  304s
     0     0 2159.93852    0  744 -11713.393 2159.93852   118%     -  318s
     0     0 2007.58790    0  776 -11713.393 2007.58790   117%     -  331s
     0     0 1940.29951    0  756 -11713.393 1940.29951   117%     -  341s
     0     0 1920.04718    0  770 -11713.393 1920.04718   116%     -  347s
     0     0 1918.32415    0  768 -11713.393 1918.32415   116%     -  349s
H    0     0                    -11635.83407 1910.64070   116%     -  354s
     0     0 1910.64070    0  755 -11635.834 1910.64070   116%     -  354s
     0     0 1910.51178    0  751 -11635.834 1910.51178   116%     -  355s
     0     0 -382.54769    0  603 -11635.834 -382.54769  96.7%     -  412s
     0     0 -950.57232    0  702 -11635.834 -950.57232  91.8%     -  446s
     0     0 -1352.5321    0  720 -11635.834 -1352.5321  88.4%     -  473s
     0     0 -1587.7748    0  861 -11635.834 -1587.7748  86.4%     -  494s
     0     0 -1713.4829    0  802 -11635.834 -1713.4829  85.3%     -  510s
     0     0 -1733.6217    0  783 -11635.834 -1733.6217  85.1%     -  516s
     0     0 -1750.0848    0  718 -11635.834 -1750.0848  85.0%     -  520s
     0     0 -1760.5786    0  718 -11635.834 -1760.5786  84.9%     -  522s
     0     0 -1777.8426    0  851 -11635.834 -1777.8426  84.7%     -  525s
     0     0 -1782.7360    0  651 -11635.834 -1782.7360  84.7%     -  527s
     0     0 -1851.0434    0  858 -11635.834 -1851.0434  84.1%     -  532s
     0     0 -1864.9210    0  719 -11635.834 -1864.9210  84.0%     -  536s
     0     0 -1871.8707    0  724 -11635.834 -1871.8707  83.9%     -  537s
     0     0 -1874.1865    0  721 -11635.834 -1874.1865  83.9%     -  538s
     0     0 -1875.1583    0  721 -11635.834 -1875.1583  83.9%     -  539s
     0     0 -2432.8667    0  637 -11635.834 -2432.8667  79.1%     -  564s
     0     0 -2612.1523    0  627 -11635.834 -2612.1523  77.6%     -  574s
     0     0 -2654.6719    0  636 -11635.834 -2654.6719  77.2%     -  582s
     0     0 -2703.9158    0  639 -11635.834 -2703.9158  76.8%     -  588s
     0     0 -2719.1655    0  643 -11635.834 -2719.1655  76.6%     -  591s
     0     0 -2751.9594    0  567 -11635.834 -2751.9594  76.3%     -  594s
     0     0 -2764.2526    0  570 -11635.834 -2764.2526  76.2%     -  595s
     0     0 -2765.0853    0  565 -11635.834 -2765.0853  76.2%     -  597s
     0     0 -2881.7630    0  557 -11635.834 -2881.7630  75.2%     -  606s
     0     0 -2904.1722    0  642 -11635.834 -2904.1722  75.0%     -  611s
     0     0 -2908.5419    0  633 -11635.834 -2908.5419  75.0%     -  614s
     0     0 -2927.0065    0  559 -11635.834 -2927.0065  74.8%     -  616s
     0     0 -2928.3859    0  563 -11635.834 -2928.3859  74.8%     -  617s
     0     0 -3047.4015    0  721 -11635.834 -3047.4015  73.8%     -  625s
     0     0 -3078.4037    0  627 -11635.834 -3078.4037  73.5%     -  636s
     0     0 -3089.6473    0  648 -11635.834 -3089.6473  73.4%     -  638s
     0     0 -3091.5610    0  645 -11635.834 -3091.5610  73.4%     -  639s
     0     0 -3199.3727    0  556 -11635.834 -3199.3727  72.5%     -  648s
     0     0 -3208.2587    0  553 -11635.834 -3208.2587  72.4%     -  652s
     0     0 -3228.1907    0  551 -11635.834 -3228.1907  72.3%     -  655s
     0     0 -3229.3154    0  559 -11635.834 -3229.3154  72.2%     -  656s
     0     0 -3308.1097    0  635 -11635.834 -3308.1097  71.6%     -  666s
     0     0 -3321.9925    0  653 -11635.834 -3321.9925  71.5%     -  670s
     0     0 -3327.3744    0  561 -11635.834 -3327.3744  71.4%     -  673s
     0     0 -3328.4435    0  564 -11635.834 -3328.4435  71.4%     -  674s
     0     0 -3363.8440    0  743 -11635.834 -3363.8440  71.1%     -  682s
     0     0 -3371.5822    0  740 -11635.834 -3371.5822  71.0%     -  686s
     0     0 -3376.1441    0  749 -11635.834 -3376.1441  71.0%     -  688s
     0     0 -3376.5896    0  737 -11635.834 -3376.5896  71.0%     -  689s
     0     0 -3416.5567    0  543 -11635.834 -3416.5567  70.6%     -  697s
     0     0 -3425.3498    0  566 -11635.834 -3425.3498  70.6%     -  701s
     0     0 -3429.6333    0  559 -11635.834 -3429.6333  70.5%     -  702s
     0     0 -3431.0015    0  568 -11635.834 -3431.0015  70.5%     -  703s
     0     0 -3452.6568    0  571 -11635.834 -3452.6568  70.3%     -  709s
     0     0 -3455.0341    0  558 -11635.834 -3455.0341  70.3%     -  711s
     0     0 -3458.1229    0  565 -11635.834 -3458.1229  70.3%     -  715s
     0     0 -3460.4480    0  563 -11635.834 -3460.4480  70.3%     -  820s
     0     0 -3464.7059    0  564 -11635.834 -3464.7059  70.2%     -  823s
     0     0 -3465.8206    0  564 -11635.834 -3465.8206  70.2%     -  827s
     0     2 -3466.1277    0  564 -11635.834 -3466.1277  70.2%     -  973s
     1     3 -3572.6087    1  471 -11635.834 -3466.1277  70.2%  4179  977s
     2     4 -3687.8706    1  562 -11635.834 -3572.6886  69.3%  6162  984s
     3     6 -4205.0389    2  566 -11635.834 -3573.4160  69.3%  6368 1014s
     5    10 -4479.8635    3  550 -11635.834 -3688.5979  68.3% 10995 1033s
     9    19 -4640.9256    4  572 -11635.834 -4205.8137  63.9% 10216 1053s
    18    38 -5744.0235    4  538 -11635.834 -4323.7895  62.8% 10128 1077s
    37    51 -6012.7875    5  634 -11635.834 -4607.4228  60.4% 15258 1126s
    50    77 -7961.2703    6  298 -11635.834 -4607.4228  60.4% 15625 1158s
    76   193 -8037.2057    7  278 -11635.834 -4607.4228  60.4% 12406 1188s
   192   250 -8401.9472   12  260 -11635.834 -4607.4228  60.4%  7252 1203s
   249   322 -8695.2133   13  259 -11635.834 -4607.4228  60.4%  6765 1216s
   323   376 -9236.7260   15  182 -11635.834 -4607.4228  60.4%  6489 1232s
   386   430 -11063.689   17  137 -11635.834 -4607.4228  60.4%  6245 1247s
   456   466 infeasible   22      -11635.834 -4607.4228  60.4%  6022 1262s
   522   486     cutoff   23      -11635.834 -4607.4228  60.4%  5942 1276s
   576   513 -9142.7693   12  195 -11635.834 -4607.4228  60.4%  5891 1289s
   635   541 infeasible   24      -11635.834 -4607.4228  60.4%  5820 1302s
   702   546 infeasible   14      -11635.834 -4607.4228  60.4%  5683 1318s
   771   536 -9197.9826   13  141 -11635.834 -4607.4228  60.4%  5630 1332s
   828   537 -10329.179   14  123 -11635.834 -4607.4228  60.4%  5538 1348s
   881   549 infeasible   15      -11635.834 -4607.4228  60.4%  5534 1364s
   925   562 -9810.9127   15  122 -11635.834 -4607.4228  60.4%  5637 1379s
   960   605 -9989.4063   16  143 -11635.834 -4607.4228  60.4%  5749 1394s
  1013   633 -10797.361   17  130 -11635.834 -4607.4228  60.4%  5789 1435s
  1047   665 -11149.702   18  125 -11635.834 -4607.4228  60.4%  5823 1500s
  1091   699 -11436.488   19  102 -11635.834 -4607.4228  60.4%  5841 1514s
  1135   703 -11465.405   20  108 -11635.834 -4607.4228  60.4%  5827 1530s
  1207   694     cutoff   21      -11635.834 -4607.4228  60.4%  5721 1548s
  1287   692 -11458.118   20  108 -11635.834 -4607.4228  60.4%  5531 1570s
  1331   707 infeasible   21      -11635.834 -4607.4228  60.4%  5581 1589s
  1391   734 infeasible   22      -11635.834 -4607.4228  60.4%  5516 1610s
  1473   751 -11566.905   21  108 -11635.834 -4607.4228  60.4%  5489 1635s
  1522   773     cutoff   22      -11635.834 -4607.4228  60.4%  5509 1658s
  1601   794 -8425.9578    7  201 -11635.834 -4607.4228  60.4%  5475 1681s
  1673   808 -7877.5372    7  218 -11635.834 -4607.4228  60.4%  5510 1707s
  1727   827 -8641.5763    8  197 -11635.834 -4607.4228  60.4%  5576 1743s
  1784   856     cutoff   21      -11635.834 -4607.4228  60.4%  5640 1764s
  1857   875 -9120.6049   22  383 -11635.834 -4607.4228  60.4%  5694 1791s
  1926   904 -9535.8486   23  390 -11635.834 -4607.4228  60.4%  5767 1816s
  1980   942 -9653.8154   24  379 -11635.834 -4607.4228  60.4%  5874 1844s
  2050  1002 -10205.451   27  225 -11635.834 -4607.4228  60.4%  5954 1871s
  2130  1060 -11447.268   35  112 -11635.834 -4848.0994  58.3%  6018 1903s
  2241  1091 infeasible   44      -11635.834 -4848.2673  58.3%  5984 1934s
  2334  1114 -10094.060    8  462 -11635.834 -4848.2673  58.3%  6016 1964s
  2391  1145 -10914.621    9  185 -11635.834 -4848.2673  58.3%  6096 1997s
  2461  1193 -10370.185   10  450 -11635.834 -4848.2673  58.3%  6196 2029s
  2553  1230 -11081.446   13  509 -11635.834 -4848.2673  58.3%  6310 2073s
  2632  1257 infeasible   15      -11635.834 -4848.2673  58.3%  6392 2109s
  2701  1289 -6547.0998    9  496 -11635.834 -4848.2673  58.3%  6496 2146s
  2790  1313 -9877.8922    7  539 -11635.834 -5066.3426  56.5%  6589 2186s
  2856  1359 -8500.5587   10  221 -11635.834 -5066.3426  56.5%  6647 2227s
  2936  1389 -11060.883   14   96 -11635.834 -5066.3426  56.5%  6689 2267s
  3046  1433 -7627.3192   13  289 -11635.834 -5066.3426  56.5%  6748 2316s
  3152  1509 -9362.1244   16  260 -11635.834 -5066.3426  56.5%  6791 2359s
  3266  1589 infeasible   18      -11635.834 -5066.3426  56.5%  6836 2404s
  3472  1669 -9346.2683   11  314 -11635.834 -5066.3426  56.5%  6730 2451s
  3655  1722 -10176.952   13  289 -11635.834 -5066.3426  56.5%  6735 2504s
  3770  1785 -10731.884   20  379 -11635.834 -5537.5276  52.4%  6873 2558s
  3894  1823 -11474.959   23  376 -11635.834 -5538.0065  52.4%  6984 2612s
  4056  1859 infeasible   24      -11635.834 -6094.2316  47.6%  7032 2670s
  4219  1917 -8109.7718   10  253 -11635.834 -6094.2316  47.6%  7117 2730s
  4329  1975     cutoff   14      -11635.834 -6094.2316  47.6%  7249 2793s
  4534  2044 -9041.7952    8  203 -11635.834 -6533.7596  43.8%  7318 2852s
  4691  2128 -8793.4104    9  274 -11635.834 -6682.8101  42.6%  7401 2915s
  4957  2248 -10796.417   10  243 -11635.834 -6723.4723  42.2%  7445 2977s
  5248  2249 -8860.9849   14  564 -11635.834 -6736.7196  42.1%  7427 3447s
  5250  2250 -6953.6986   12  444 -11635.834 -6736.7196  42.1%  7424 3468s
  5251  2251 -9548.7551   21  467 -11635.834 -6736.7196  42.1%  7423 3526s
  5252  2252 -10125.368   15  561 -11635.834 -6736.7196  42.1%  7421 3564s
  5253  2252 -9892.1301   26  575 -11635.834 -6736.7196  42.1%  7420 3592s

Cutting planes:
  Implied bound: 68
  Projected implied bound: 282
  MIR: 979
  Flow cover: 1028
  RLT: 83
  Relax-and-lift: 245

Explored 5253 nodes (39930018 simplex iterations) in 3600.06 seconds (8952.74 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11635.8 -11713.4 -11806.1 ... -28856.3

Time limit reached
Best objective -1.163583406704e+04, best bound -6.736719646553e+03, gap 42.1037%
  WARNING: Time limit reached. Using best solution found (gap: 42.10%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.28s
  Master Objective (UB) = -11635.83, θ = 113322.28
  Upper Bound (UB) = -11635.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113322.28
  [DEBUG]   ✓ Scenario 0: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113322.28 ≤ Q = 113322.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113322.28 ≤ Q = 113322.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5db889d2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa247762e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.249579e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6287478.4687
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.246796e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124679.56    0  123 6287478.47 -124679.56   102%     -    0s
H    0     0                    -89432.96300 -124679.56  39.4%     -    0s
H    0     0                    -90368.07118 -124679.56  38.0%     -    0s
     0     0 -96596.973    0   75 -90368.071 -96596.973  6.89%     -    0s
H    0     0                    -94997.62506 -96583.192  1.67%     -    0s
H    0     0                    -95612.13026 -96583.192  1.02%     -    0s
     0     0 -96300.911    0   75 -95612.130 -96300.911  0.72%     -    0s
     0     0 -96289.150    0   75 -95612.130 -96289.150  0.71%     -    0s
     0     0 -96008.380    0   77 -95612.130 -96008.380  0.41%     -    0s
     0     0 -95960.131    0   71 -95612.130 -95960.131  0.36%     -    0s
     0     0 -95959.696    0   69 -95612.130 -95959.696  0.36%     -    0s
     0     0 -95957.535    0   69 -95612.130 -95957.535  0.36%     -    0s
     0     0 -95880.247    0   46 -95612.130 -95880.247  0.28%     -    0s
     0     0 -95861.359    0   57 -95612.130 -95861.359  0.26%     -    0s
     0     0 -95797.089    0   61 -95612.130 -95797.089  0.19%     -    0s
     0     0 -95796.656    0   61 -95612.130 -95796.656  0.19%     -    0s
     0     0 -95796.656    0   55 -95612.130 -95796.656  0.19%     -    0s
     0     0 -95796.656    0   21 -95612.130 -95796.656  0.19%     -    0s
H    0     0                    -95667.31043 -95796.656  0.14%     -    0s
     0     0 -95796.656    0   53 -95667.310 -95796.656  0.14%     -    0s
     0     0 -95795.242    0   53 -95667.310 -95795.242  0.13%     -    0s
     0     0 -95780.585    0   54 -95667.310 -95780.585  0.12%     -    0s
     0     0 -95765.209    0   54 -95667.310 -95765.209  0.10%     -    0s
     0     0 -95721.403    0   49 -95667.310 -95721.403  0.06%     -    0s
     0     0 -95713.724    0   49 -95667.310 -95713.724  0.05%     -    0s
     0     0 -95712.928    0   49 -95667.310 -95712.928  0.05%     -    0s
     0     0 -95712.697    0   49 -95667.310 -95712.697  0.05%     -    0s
     0     0 -95694.994    0   49 -95667.310 -95694.994  0.03%     -    0s
     0     0 -95694.407    0   49 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95694.407    0   38 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95694.407    0   39 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95694.407    0   38 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95694.407    0   37 -95667.310 -95694.407  0.03%     -    0s
     0     0 -95688.664    0   38 -95667.310 -95688.664  0.02%     -    0s
     0     0 -95687.535    0   38 -95667.310 -95687.535  0.02%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 4
  MIR: 50
  Flow cover: 31
  RLT: 6

Explored 1 nodes (1177 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -95667.3 -95612.1 -91498.7 ... 1.24958e+13
No other solutions better than -95667.3

Optimal solution found (tolerance 1.00e-06)
Best objective -9.566731042924e+04, best bound -9.566731042924e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 110330.56
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95667.31
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -95667.31 = 110330.56
  [DEBUG]   Current θ from Master = 113322.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2991.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14627.56
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 689.0727, Absolute Gap = 689.0727, Relative Gap = 0.059220
  Not converged yet (gap = 689.07 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610837 nonzeros
Model fingerprint: 0x9eea4196
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 96232 rows and 39072 columns
Presolve time: 2.03s
Presolved: 119211 rows, 50548 columns, 733216 nonzeros
Variable types: 48289 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.87s

Barrier statistics:
 Dense cols : 751
 AA' NZ     : 4.216e+06
 Factor NZ  : 9.853e+06 (roughly 150 MB of memory)
 Factor Ops : 2.097e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72931646e+07  1.99075691e+08  8.77e+04 1.91e+01  6.98e+04     4s
   1  -1.30268406e+07  1.75124903e+08  6.09e+04 5.12e+01  4.81e+04     4s
   2  -5.46549466e+06  1.38413345e+08  2.49e+04 2.34e+00  2.08e+04     4s
   3  -7.25090060e+05  9.89577424e+07  1.35e+03 9.66e-01  1.51e+03     4s
   4  -5.20831940e+05  7.60658757e+07  5.00e+02 6.59e-01  7.24e+02     4s
   5  -4.54096972e+05  4.29723757e+07  2.79e+02 3.13e-01  3.88e+02     4s
   6  -3.70783902e+05  3.28196041e+07  9.96e+01 2.23e-01  2.16e+02     4s
   7  -3.17521721e+05  2.48919420e+07  4.05e+01 1.63e-01  1.39e+02     5s
   8  -2.27414325e+05  1.83571116e+07  1.88e+00 1.15e-01  8.62e+01     5s
   9  -1.42332388e+05  8.94149834e+06  1.85e-01 5.53e-02  4.17e+01     5s
  10  -1.03038749e+05  3.22502729e+06  7.78e-02 1.90e-02  1.53e+01     5s
  11  -7.26728486e+04  1.16428811e+06  3.02e-02 6.55e-03  5.68e+00     5s
  12  -4.25738176e+04  3.92424716e+05  9.06e-03 2.33e-03  2.00e+00     5s
  13  -3.34067106e+04  2.34337756e+05  6.34e-03 1.46e-03  1.23e+00     5s
  14  -2.46216091e+04  1.57552218e+05  4.57e-03 1.25e-03  8.36e-01     5s
  15  -1.90267521e+04  1.09719675e+05  3.60e-03 1.63e-03  5.91e-01     5s
  16  -1.33591166e+04  6.82739940e+04  2.70e-03 1.16e-03  3.74e-01     5s
  17  -1.01043342e+04  4.86846819e+04  2.23e-03 7.78e-04  2.70e-01     5s
  18  -6.66882144e+03  4.12503028e+04  1.76e-03 6.33e-04  2.20e-01     5s
  19  -2.96085187e+03  3.17256742e+04  1.28e-03 4.31e-04  1.59e-01     5s
  20  -1.16176206e+03  2.79567947e+04  1.07e-03 3.59e-04  1.34e-01     5s
  21  -3.30607724e+02  2.66563823e+04  9.72e-04 3.35e-04  1.24e-01     6s
  22   2.56960623e+03  2.06321825e+04  6.63e-04 2.18e-04  8.29e-02     6s
  23   3.82216889e+03  1.72160867e+04  5.41e-04 1.48e-04  6.14e-02     6s
  24   5.91509045e+03  1.50102071e+04  3.52e-04 1.02e-04  4.17e-02     6s
  25   7.43740225e+03  1.33082194e+04  2.21e-04 6.48e-05  2.69e-02     6s
  26   7.96991556e+03  1.17916552e+04  1.78e-04 3.17e-05  1.75e-02     6s
  27   8.30424136e+03  1.15347634e+04  1.50e-04 2.64e-05  1.48e-02     6s
  28   8.64298002e+03  1.12833083e+04  1.22e-04 2.13e-05  1.21e-02     6s
  29   8.92044295e+03  1.10087846e+04  1.00e-04 1.57e-05  9.58e-03     6s
  30   9.17757269e+03  1.07154644e+04  7.82e-05 1.03e-05  7.05e-03     6s
  31   9.35358690e+03  1.05885773e+04  6.38e-05 7.92e-06  5.66e-03     6s
  32   9.47421863e+03  1.04950735e+04  5.30e-05 6.39e-06  4.68e-03     6s
  33   9.59743973e+03  1.04103632e+04  4.28e-05 5.58e-06  3.73e-03     7s
  34   9.70197315e+03  1.03832531e+04  3.41e-05 5.26e-06  3.13e-03     7s
  35   9.73462167e+03  1.03170095e+04  3.11e-05 3.85e-06  2.67e-03     7s
  36   9.79650448e+03  1.03077649e+04  2.60e-05 3.65e-06  2.35e-03     7s
  37   9.80520876e+03  1.02758617e+04  2.52e-05 2.85e-06  2.16e-03     7s
  38   9.88760100e+03  1.02423564e+04  1.84e-05 2.54e-06  1.63e-03     7s
  39   9.91912600e+03  1.02139969e+04  1.58e-05 2.95e-06  1.35e-03     7s
  40   9.95441204e+03  1.01976678e+04  1.28e-05 2.16e-06  1.12e-03     7s
  41   9.99638095e+03  1.01617254e+04  9.26e-06 1.24e-06  7.58e-04     7s
  42   1.00175052e+04  1.01482098e+04  7.56e-06 9.68e-07  6.00e-04     7s
  43   1.00274570e+04  1.01456248e+04  6.78e-06 7.90e-07  5.42e-04     7s
  44   1.00482147e+04  1.01339273e+04  5.12e-06 1.21e-06  3.93e-04     8s
  45   1.00768027e+04  1.01309220e+04  2.93e-06 9.67e-07  2.48e-04     8s
  46   1.01038190e+04  1.01210623e+04  7.59e-07 3.45e-07  7.91e-05     8s
  47   1.01129940e+04  1.01160160e+04  1.38e-07 2.59e-07  1.39e-05     8s
  48   1.01151748e+04  1.01154159e+04  1.44e-08 3.00e-08  1.11e-06     8s
  49   1.01153133e+04  1.01153298e+04  3.71e-08 3.83e-09  7.60e-08     8s
  50   1.01153296e+04  1.01153296e+04  3.21e-08 4.65e-11  2.72e-10     8s

Barrier solved model in 50 iterations and 8.13 seconds (12.46 work units)
Optimal objective 1.01153296e+04


Root crossover log...

  100251 DPushes remaining with DInf 0.0000000e+00                 8s
   17743 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    7794 PPushes remaining with PInf 3.4400030e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.7001124e+00     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54690    1.0115330e+04   0.000000e+00   4.700112e+00     13s
   54697    1.0115330e+04   0.000000e+00   0.000000e+00     13s
   54697    1.0115330e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.011533e+04, 54697 iterations, 10.03 seconds (20.86 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10115.3296    0  336 -196434.75 10115.3296   105%     -   13s
H    0     0                    -158573.8730 10115.3296   106%     -   13s
H    0     0                    -137050.4107 10115.3296   107%     -   13s
H    0     0                    -136245.0229 10115.3296   107%     -   14s
H    0     0                    -136101.3973 10115.3296   107%     -   14s
H    0     0                    -97569.63505 10115.3296   110%     -   14s
H    0     0                    -97311.15877 10115.3296   110%     -   14s
H    0     0                    -36209.47732 10115.3296   128%     -   14s
H    0     0                    -28959.88895 10115.3296   135%     -   14s
H    0     0                    -12587.55482 10115.3296   180%     -   14s
H    0     0                    -12303.00996 10115.3296   182%     -   14s
H    0     0                    -12166.97611 5511.98084   145%     -   48s
H    0     0                    -11901.65974 5511.98084   146%     -   48s
H    0     0                    -11825.35572 5511.98084   147%     -   48s
     0     0 5416.24965    0  374 -11825.356 5416.24965   146%     -   48s
     0     0 4504.01586    0  398 -11825.356 4504.01586   138%     -   63s
     0     0 4479.54291    0  403 -11825.356 4479.54291   138%     -   66s
     0     0 4473.49867    0  398 -11825.356 4473.49867   138%     -   68s
     0     0 4469.04714    0  399 -11825.356 4469.04714   138%     -   72s
     0     0 4469.04714    0  397 -11825.356 4469.04714   138%     -   74s
     0     0 4469.04714    0  395 -11825.356 4469.04714   138%     -   75s
     0     0 4469.04714    0  488 -11825.356 4469.04714   138%     -   77s
     0     0 4469.04714    0  486 -11825.356 4469.04714   138%     -   79s
     0     0 4466.00167    0  493 -11825.356 4466.00167   138%     -   80s
     0     0 4464.01502    0  497 -11825.356 4464.01502   138%     -   81s
     0     0 4464.00079    0  497 -11825.356 4464.00079   138%     -   81s
     0     0 2120.98462    0  461 -11825.356 2120.98462   118%     -  114s
     0     0 1802.70235    0  481 -11825.356 1802.70235   115%     -  138s
     0     0 1657.11455    0  487 -11825.356 1657.11455   114%     -  152s
     0     0 1638.90030    0  493 -11825.356 1638.90030   114%     -  159s
     0     0 1525.09619    0  536 -11825.356 1525.09619   113%     -  174s
     0     0 1467.60340    0  392 -11825.356 1467.60340   112%     -  186s
H    0     0                    -11791.42291 1441.66742   112%     -  196s
H    0     0                    -11778.91407 1441.66742   112%     -  196s
     0     0 1441.66742    0  483 -11778.914 1441.66742   112%     -  196s
     0     0 1358.23585    0  387 -11778.914 1358.23585   112%     -  208s
     0     0 1349.79365    0  464 -11778.914 1349.79365   111%     -  213s
H    0     0                    -11673.35475 1193.74311   110%     -  228s
H    0     0                    -11655.99709 1193.74311   110%     -  228s
     0     0 1193.74311    0  468 -11655.997 1193.74311   110%     -  228s
     0     0 1124.48073    0  518 -11655.997 1124.48073   110%     -  235s
     0     0 1028.86019    0  511 -11655.997 1028.86019   109%     -  241s
     0     0 1022.60548    0  507 -11655.997 1022.60548   109%     -  242s
     0     0  976.94177    0  515 -11655.997  976.94177   108%     -  246s
     0     0  967.15510    0  525 -11655.997  967.15510   108%     -  248s
     0     0  964.86800    0  526 -11655.997  964.86800   108%     -  249s
     0     0  964.75275    0  529 -11655.997  964.75275   108%     -  251s
     0     0 -1004.8976    0  572 -11655.997 -1004.8976  91.4%     -  288s
     0     0 -1449.4458    0  571 -11655.997 -1449.4458  87.6%     -  308s
     0     0 -1569.9278    0  569 -11655.997 -1569.9278  86.5%     -  316s
     0     0 -1603.8807    0  534 -11655.997 -1603.8807  86.2%     -  322s
     0     0 -1629.8185    0  590 -11655.997 -1629.8185  86.0%     -  327s
     0     0 -1718.3024    0  591 -11655.997 -1718.3024  85.3%     -  335s
     0     0 -1785.4932    0  593 -11655.997 -1785.4932  84.7%     -  342s
     0     0 -1794.6093    0  604 -11655.997 -1794.6093  84.6%     -  343s
     0     0 -1828.2095    0  535 -11655.997 -1828.2095  84.3%     -  347s
     0     0 -1842.0696    0  537 -11655.997 -1842.0696  84.2%     -  350s
     0     0 -1843.8440    0  598 -11655.997 -1843.8440  84.2%     -  352s
     0     0 -1843.9665    0  602 -11655.997 -1843.9665  84.2%     -  353s
     0     0 -2329.1872    0  554 -11655.997 -2329.1872  80.0%     -  370s
     0     0 -2511.1829    0  565 -11655.997 -2511.1829  78.5%     -  380s
     0     0 -2714.8604    0  586 -11655.997 -2714.8604  76.7%     -  387s
     0     0 -2746.2529    0  584 -11655.997 -2746.2529  76.4%     -  390s
     0     0 -2797.4282    0  564 -11655.997 -2797.4282  76.0%     -  394s
     0     0 -2800.8294    0  570 -11655.997 -2800.8294  76.0%     -  395s
     0     0 -2803.6500    0  570 -11655.997 -2803.6500  75.9%     -  396s
     0     0 -2804.9712    0  569 -11655.997 -2804.9712  75.9%     -  396s
     0     0 -3018.6955    0  568 -11655.997 -3018.6955  74.1%     -  408s
     0     0 -3052.8820    0  576 -11655.997 -3052.8820  73.8%     -  412s
     0     0 -3064.3471    0  577 -11655.997 -3064.3471  73.7%     -  414s
     0     0 -3067.3837    0  575 -11655.997 -3067.3837  73.7%     -  416s
     0     0 -3074.4609    0  648 -11655.997 -3074.4609  73.6%     -  419s
     0     0 -3076.2804    0  654 -11655.997 -3076.2804  73.6%     -  420s
     0     0 -3168.4691    0  635 -11655.997 -3168.4691  72.8%     -  428s
     0     0 -3179.7817    0  647 -11655.997 -3179.7817  72.7%     -  433s
     0     0 -3192.8781    0  640 -11655.997 -3192.8781  72.6%     -  435s
     0     0 -3197.7429    0  638 -11655.997 -3197.7429  72.6%     -  437s
     0     0 -3198.0867    0  644 -11655.997 -3198.0867  72.6%     -  438s
     0     0 -3228.0174    0  680 -11655.997 -3228.0174  72.3%     -  444s
     0     0 -3264.7238    0  575 -11655.997 -3264.7238  72.0%     -  447s
     0     0 -3270.5374    0  595 -11655.997 -3270.5374  71.9%     -  449s
     0     0 -3271.3933    0  598 -11655.997 -3271.3933  71.9%     -  450s
     0     0 -3304.8751    0  581 -11655.997 -3304.8751  71.6%     -  455s
     0     0 -3310.6793    0  580 -11655.997 -3310.6793  71.6%     -  463s
     0     0 -3312.1152    0  582 -11655.997 -3312.1152  71.6%     -  464s
     0     0 -3337.6595    0  633 -11655.997 -3337.6595  71.4%     -  469s
     0     0 -3348.4669    0  593 -11655.997 -3348.4669  71.3%     -  473s
     0     0 -3354.6419    0  586 -11655.997 -3354.6419  71.2%     -  475s
     0     0 -3358.3222    0  589 -11655.997 -3358.3222  71.2%     -  476s
     0     0 -3360.6588    0  584 -11655.997 -3360.6588  71.2%     -  477s
     0     0 -3364.0451    0  589 -11655.997 -3364.0451  71.1%     -  478s
     0     0 -3365.6197    0  588 -11655.997 -3365.6197  71.1%     -  479s
     0     0 -3382.4655    0  558 -11655.997 -3382.4655  71.0%     -  484s
     0     0 -3393.3977    0  561 -11655.997 -3393.3977  70.9%     -  489s
     0     0 -3394.8389    0  579 -11655.997 -3394.8389  70.9%     -  490s
     0     0 -3409.6149    0  573 -11655.997 -3409.6149  70.7%     -  494s
     0     0 -3411.5754    0  582 -11655.997 -3411.5754  70.7%     -  495s
     0     0 -3433.1668    0  566 -11655.997 -3433.1668  70.5%     -  501s
     0     0 -3436.9215    0  572 -11655.997 -3436.9215  70.5%     -  504s
     0     0 -3438.5391    0  570 -11655.997 -3438.5391  70.5%     -  505s
     0     0 -3446.9190    0  582 -11655.997 -3446.9190  70.4%     -  508s
     0     0 -3450.5913    0  578 -11655.997 -3450.5913  70.4%     -  510s
     0     0 -3453.1885    0  575 -11655.997 -3453.1885  70.4%     -  512s
     0     0 -3455.7345    0  584 -11655.997 -3455.7345  70.4%     -  513s
     0     0 -3456.4114    0  591 -11655.997 -3456.4114  70.3%     -  513s
     0     0 -3461.4353    0  582 -11655.997 -3461.4353  70.3%     -  517s
     0     0 -3461.4889    0  582 -11655.997 -3461.4889  70.3%     -  521s
     0     2 -3463.2740    0  582 -11655.997 -3463.2740  70.3%     -  694s
     1     3 -4225.8110    1  605 -11655.997 -3463.7407  70.3% 19182  703s
     2     4 -3957.8588    1  566 -11655.997 -3957.8588  66.0% 18152  718s
     3     6 -4177.1194    2  622 -11655.997 -3958.2889  66.0% 15350  747s
     5    12 -4875.3376    3  467 -11655.997 -3958.2889  66.0% 20259  762s
    11    24 -5286.4031    4  449 -11655.997 -4350.7102  62.7% 13913  780s
    23    36 -4829.4808    5  576 -11655.997 -4593.1785  60.6% 16832  827s
    35    68 -5248.0067    6  571 -11655.997 -4593.1785  60.6% 18448  924s
    67   169 -5483.0691    7  556 -11655.997 -4727.4070  59.4% 21239  964s
   168   223 -5560.1914   12  554 -11655.997 -4727.5301  59.4% 12699  985s
   222   296 -6744.0697   13  531 -11655.997 -4727.5301  59.4% 10680 1007s
   295   356 -6798.9426   15  535 -11655.997 -4727.5301  59.4%  9286 1029s
   358   416 -7054.5082   16  536 -11655.997 -4727.5301  59.4%  8695 1048s
   431   449 -7178.3189   18  541 -11655.997 -4727.5301  59.4%  8381 1064s
   498   481 -8018.6618   19  387 -11655.997 -4727.5301  59.4%  8270 1082s
   562   531 -11352.458   20  269 -11655.997 -4727.5301  59.4%  8374 1101s
   620   558     cutoff   22      -11655.997 -4727.5301  59.4%  8508 1116s
   673   609 -6291.1618   10  440 -11655.997 -4727.5301  59.4%  8421 1139s
   753   640 -6868.4655   12  425 -11655.997 -4727.5301  59.4%  8186 1156s
   820   675 -7015.3653   14  443 -11655.997 -4727.5301  59.4%  8016 1172s
   887   716 -7310.8007   16  427 -11655.997 -4727.5301  59.4%  7945 1189s
   960   769 -8239.8791   19  407 -11655.997 -5159.4623  55.7%  7821 1207s
  1035   816 -8277.9295   21  406 -11655.997 -5159.4623  55.7%  7720 1224s
  1110   878 -10378.531   23  178 -11655.997 -5159.4623  55.7%  7615 1241s
  1188   960 -11070.053   28  367 -11655.997 -5159.4623  55.7%  7554 1261s
  1292  1023 -11241.600   32  165 -11655.997 -5159.4623  55.7%  7366 1278s
  1410  1041 -11339.536   36  155 -11655.997 -5159.4623  55.7%  7132 1300s
  1505  1044 -6135.8181   14  459 -11655.997 -5159.4623  55.7%  7023 1321s
  1597  1065 -6884.9718   16  434 -11655.997 -5159.4623  55.7%  7018 1342s
  1636  1071 -7155.6853   17  337 -11655.997 -5159.4623  55.7%  7104 1363s
  1694  1089 -8953.6576   18  482 -11655.997 -5159.4623  55.7%  7201 1386s
  1738  1119 -9220.7479   19  426 -11655.997 -5159.4623  55.7%  7326 1408s
  1781  1138 -11160.646   20  375 -11655.997 -5159.4623  55.7%  7430 1429s
  1842  1152 -11249.658   21  370 -11655.997 -5310.2667  54.4%  7456 1453s
  1906  1173 infeasible   22      -11655.997 -5611.0771  51.9%  7527 1477s
  1951  1187 infeasible   21      -11655.997 -5611.0771  51.9%  7636 1505s
  2005  1211 -10352.634   14  463 -11655.997 -5674.8292  51.3%  7718 1532s
  2073  1216 -10394.366   15  460 -11655.997 -5674.8292  51.3%  7740 1562s
  2152  1247 infeasible   16      -11655.997 -5674.8292  51.3%  7789 1594s
  2239  1268 -9542.9080   10  291 -11655.997 -5692.5127  51.2%  7857 1627s
  2330  1292 -10351.055   11  256 -11655.997 -5692.5127  51.2%  7913 1662s
  2421  1327     cutoff   12      -11655.997 -5692.5127  51.2%  7995 1698s
  2486  1356 infeasible   12      -11655.997 -5692.5127  51.2%  8147 1736s
  2569  1390 -9875.7738    8  390 -11655.997 -5692.5127  51.2%  8280 1782s
  2683  1435 infeasible    9      -11655.997 -5833.7443  50.0%  8341 1818s
  2843  1460 -9881.2227    9  625 -11655.997 -5833.7443  50.0%  8315 1856s
  2970  1476     cutoff   10      -11655.997 -6036.2874  48.2%  8358 1901s
  3064  1520 -8145.3701    7  197 -11655.997 -6036.2874  48.2%  8386 1950s
  3164  1562     cutoff   11      -11655.997 -6036.2874  48.2%  8493 1995s
  3285  1619 -11213.633   12  127 -11655.997 -6109.9774  47.6%  8553 2037s
  3433  1716 -9967.6497   11  182 -11655.997 -6109.9774  47.6%  8572 2082s
  3613  1772 -7455.4766   12  341 -11655.997 -6131.7096  47.4%  8535 2129s
  3801  1806 -8678.7989   13  327 -11655.997 -6131.7096  47.4%  8480 2177s
  3960  1873 -10220.878   17  230 -11655.997 -6131.7096  47.4%  8527 2229s
  4097  1893 -11537.221   32   79 -11655.997 -6327.0325  45.7%  8649 2286s
  4254  1925 -9056.8309    8  537 -11655.997 -6404.6788  45.1%  8769 2346s
  4418  1945 -10131.675    9  521 -11655.997 -6404.6788  45.1%  8837 2407s
  4600  1983 infeasible   12      -11655.997 -6404.6788  45.1%  8896 2463s
  4772  2007 -8285.3033   19  254 -11655.997 -6404.6788  45.1%  8975 2526s
  5009  2036 -10249.882   22  270 -11655.997 -6404.6788  45.1%  8962 2585s
  5131  2060 infeasible   21      -11655.997 -6492.5790  44.3%  8995 2648s
  5171  2070 -9471.8548   11  262 -11655.997 -6492.5790  44.3%  9035 2701s
  5229  2064 -9623.0349   12  335 -11655.997 -6492.5790  44.3%  9082 2765s
  5297  2072 -11006.473   13  307 -11655.997 -6492.5790  44.3%  9142 2817s
  5369  2087 -11198.203   14  231 -11655.997 -6492.5790  44.3%  9157 2882s
  5472  2114 infeasible   15      -11655.997 -6666.1762  42.8%  9172 2962s
  5654  2137 -8225.6610   18  237 -11655.997 -6666.1762  42.8%  9182 3039s
  5886  2166 -10557.929   21  281 -11655.997 -6666.1762  42.8%  9258 3125s
  6142  2221 -11091.565   10  263 -11655.997 -6777.8703  41.9%  9300 3201s
  6360  2231 -10904.610   18  482 -11655.997 -6926.3692  40.6%  9304 3287s
  6608  2259 infeasible   20      -11655.997 -6960.1713  40.3%  9418 3373s
  6836  2297 -11177.954   20  189 -11655.997 -7055.4719  39.5%  9520 3465s
  7094  2319 infeasible   17      -11655.997 -7096.9815  39.1%  9601 3563s
  7408  2307 -11084.645   20  336 -11655.997 -7108.7991  39.0%  9641 3600s

Cutting planes:
  Learned: 2
  Implied bound: 160
  MIR: 3502
  Flow cover: 3740
  Inf proof: 1
  RLT: 88
  Relax-and-lift: 549

Explored 7531 nodes (73042226 simplex iterations) in 3600.08 seconds (9720.68 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11656 -11673.4 -11778.9 ... -28959.9

Time limit reached
Best objective -1.165599709062e+04, best bound -7.108799052933e+03, gap 39.0117%
  WARNING: Time limit reached. Using best solution found (gap: 39.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -11656.00, θ = 113171.61
  Upper Bound (UB) = -11656.00

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113171.61
  [DEBUG]   ✓ Scenario 0: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113171.61 ≤ Q = 113171.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113171.61 ≤ Q = 113171.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4f9bf910
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4f9bf910
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.249579e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6295728.6281
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.248517e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124851.67    0  123 6295728.63 -124851.67   102%     -    0s
H    0     0                    -89665.10801 -124851.67  39.2%     -    0s
H    0     0                    -90571.71523 -124851.67  37.8%     -    0s
     0     0 -96811.755    0   77 -90571.715 -96811.755  6.89%     -    0s
H    0     0                    -94867.13268 -96791.419  2.03%     -    0s
H    0     0                    -95239.04908 -96791.419  1.63%     -    0s
H    0     0                    -95496.19047 -96791.419  1.36%     -    0s
H    0     0                    -95868.10688 -96791.419  0.96%     -    0s
     0     0 -96503.118    0   73 -95868.107 -96503.118  0.66%     -    0s
H    0     0                    -95875.02926 -96463.061  0.61%     -    0s
     0     0 -96463.061    0   72 -95875.029 -96463.061  0.61%     -    0s
     0     0 -96167.591    0   51 -95875.029 -96167.591  0.31%     -    0s
     0     0 -96150.634    0   41 -95875.029 -96150.634  0.29%     -    0s
     0     0 -96136.262    0   38 -95875.029 -96136.262  0.27%     -    0s
     0     0 -96130.396    0   34 -95875.029 -96130.396  0.27%     -    0s
     0     0 -96069.559    0   35 -95875.029 -96069.559  0.20%     -    0s
     0     0 -96064.589    0   35 -95875.029 -96064.589  0.20%     -    0s
     0     0 -96059.687    0   36 -95875.029 -96059.687  0.19%     -    0s
     0     0 -95929.788    0   13 -95875.029 -95929.788  0.06%     -    0s
     0     0 -95896.743    0    6 -95875.029 -95896.743  0.02%     -    0s
     0     0 -95876.218    0    2 -95875.029 -95876.218  0.00%     -    0s
     0     0     cutoff    0      -95875.029 -95875.029  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 3
  MIR: 1
  Flow cover: 2
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (748 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -95875 -95868.1 -95800.2 ... 1.24958e+13
No other solutions better than -95875

Optimal solution found (tolerance 1.00e-06)
Best objective -9.587502925618e+04, best bound -9.587502925618e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 110122.84
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95875.03
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -95875.03 = 110122.84
  [DEBUG]   Current θ from Master = 113171.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3048.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14704.76
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 668.9097, Absolute Gap = 668.9097, Relative Gap = 0.057388
  Not converged yet (gap = 668.91 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654074 nonzeros
Model fingerprint: 0x9d9ea9e8
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 103100 rows and 41860 columns
Presolve time: 2.36s
Presolved: 127633 rows, 54000 columns, 785114 nonzeros
Variable types: 51741 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 752
 AA' NZ     : 4.745e+06
 Factor NZ  : 1.128e+07 (roughly 170 MB of memory)
 Factor Ops : 2.638e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73076423e+07  2.11362100e+08  8.78e+04 1.86e+01  6.95e+04     4s
   1  -1.30933394e+07  1.85921028e+08  6.11e+04 4.89e+01  4.80e+04     4s
   2  -5.95439440e+06  1.45631199e+08  2.71e+04 4.78e+00  2.24e+04     4s
   3  -7.42017693e+05  1.06237737e+08  1.40e+03 1.39e+00  1.55e+03     4s
   4  -4.93016580e+05  7.96383885e+07  4.06e+02 9.01e-01  6.45e+02     4s
   5  -4.45412848e+05  4.70600773e+07  2.64e+02 4.67e-01  3.81e+02     4s
   6  -3.65696056e+05  3.64732445e+07  8.39e+01 3.44e-01  2.11e+02     4s
   7  -3.09204475e+05  2.63631051e+07  2.23e+01 2.36e-01  1.27e+02     4s
   8  -2.14177403e+05  1.63186646e+07  1.47e-07 1.41e-01  7.09e+01     5s
   9  -1.37225624e+05  6.32926857e+06  1.78e-07 5.35e-02  2.77e+01     5s
  10  -9.68910705e+04  2.47789718e+06  1.29e-07 2.01e-02  1.10e+01     5s
  11  -7.37317612e+04  1.33334008e+06  8.69e-08 1.13e-02  6.03e+00     5s
  12  -5.28177647e+04  6.39254692e+05  4.79e-08 5.36e-03  2.97e+00     5s
  13  -3.37704893e+04  2.53924411e+05  2.84e-08 2.21e-03  1.23e+00     5s
  14  -2.45863247e+04  1.57656801e+05  2.11e-08 1.30e-03  7.81e-01     5s
  15  -1.97162225e+04  1.08168256e+05  1.72e-08 1.45e-03  5.48e-01     5s
  16  -1.31908138e+04  6.68295960e+04  1.22e-08 9.25e-04  3.43e-01     5s
  17  -8.93181039e+03  4.58690775e+04  9.35e-09 6.23e-04  2.35e-01     5s
  18  -5.23437994e+03  3.77629297e+04  7.20e-09 4.83e-04  1.84e-01     5s
  19  -3.02098490e+03  3.01970701e+04  5.94e-09 3.58e-04  1.42e-01     5s
  20  -1.48969468e+03  2.38673583e+04  5.13e-09 2.49e-04  1.09e-01     5s
  21   8.24980292e+02  2.02631740e+04  4.00e-09 1.87e-04  8.33e-02     6s
  22   2.86018247e+03  1.75067781e+04  3.07e-09 1.35e-04  6.28e-02     6s
  23   4.89150894e+03  1.54026067e+04  2.16e-09 9.48e-05  4.51e-02     6s
  24   5.61624952e+03  1.34481306e+04  1.85e-09 6.36e-05  3.36e-02     6s
  25   6.63288119e+03  1.28427225e+04  1.43e-09 5.10e-05  2.66e-02     6s
  26   7.29866590e+03  1.19378269e+04  1.16e-09 3.30e-05  1.99e-02     6s
  27   7.99860057e+03  1.15930989e+04  8.90e-10 2.58e-05  1.54e-02     6s
  28   8.36959916e+03  1.11710378e+04  7.36e-10 1.77e-05  1.20e-02     6s
  29   8.56552505e+03  1.10487736e+04  6.55e-10 1.54e-05  1.06e-02     6s
  30   8.88762336e+03  1.08717671e+04  5.22e-10 1.20e-05  8.51e-03     6s
  31   9.04555240e+03  1.08342033e+04  4.59e-10 1.14e-05  7.67e-03     6s
  32   9.14063015e+03  1.08064817e+04  4.17e-10 1.09e-05  7.14e-03     7s
  33   9.27155862e+03  1.06432512e+04  3.65e-10 8.06e-06  5.88e-03     7s
  34   9.38896933e+03  1.05264197e+04  3.15e-10 6.12e-06  4.88e-03     7s
  35   9.47122906e+03  1.04266008e+04  2.78e-10 4.51e-06  4.10e-03     7s
  36   9.52331660e+03  1.03993793e+04  3.57e-09 4.09e-06  3.76e-03     7s
  37   9.61447798e+03  1.03509277e+04  7.92e-09 3.28e-06  3.16e-03     7s
  38   9.70774244e+03  1.03027756e+04  8.99e-09 2.62e-06  2.55e-03     7s
  39   9.82870805e+03  1.02640239e+04  2.40e-08 1.82e-06  1.87e-03     7s
  40   9.84473859e+03  1.02535538e+04  6.33e-08 1.66e-06  1.75e-03     7s
  41   9.91173921e+03  1.02100865e+04  5.92e-08 1.81e-06  1.28e-03     7s
  42   9.98681859e+03  1.01888308e+04  1.45e-07 1.12e-06  8.66e-04     8s
  43   1.00371001e+04  1.01765228e+04  1.58e-07 7.83e-07  5.98e-04     8s
  44   1.00534287e+04  1.01750917e+04  2.58e-07 6.99e-07  5.22e-04     8s
  45   1.00702144e+04  1.01685886e+04  2.47e-07 4.88e-07  4.22e-04     8s
  46   1.00786920e+04  1.01651997e+04  2.45e-07 4.20e-07  3.71e-04     8s
  47   1.01172058e+04  1.01565331e+04  2.24e-07 1.64e-07  1.69e-04     8s
  48   1.01292219e+04  1.01531492e+04  1.48e-07 8.72e-08  1.03e-04     8s
  49   1.01463143e+04  1.01510943e+04  5.30e-08 2.19e-08  2.05e-05     8s
  50   1.01498054e+04  1.01504822e+04  2.17e-08 3.93e-09  2.90e-06     8s
  51   1.01503217e+04  1.01503308e+04  1.33e-08 5.06e-10  3.93e-08     9s
  52   1.01503288e+04  1.01503292e+04  7.56e-08 2.76e-11  1.70e-09     9s
  53   1.01503292e+04  1.01503292e+04  1.61e-08 1.66e-11  9.17e-11     9s

Barrier solved model in 53 iterations and 8.76 seconds (13.68 work units)
Optimal objective 1.01503292e+04


Root crossover log...

  107405 DPushes remaining with DInf 0.0000000e+00                 9s
   30337 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    4508 PPushes remaining with PInf 2.2530924e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2015090e+00     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53569    1.0150329e+04   0.000000e+00   1.201509e+00     13s
   53571    1.0150329e+04   0.000000e+00   0.000000e+00     13s
   53571    1.0150329e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.015033e+04, 53571 iterations, 9.96 seconds (21.22 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10150.3292    0  337 -196434.75 10150.3292   105%     -   13s
H    0     0                    -111369.9618 10150.3292   109%     -   14s
H    0     0                    -111365.4802 10150.3292   109%     -   14s
H    0     0                    -111279.8022 10150.3292   109%     -   14s
H    0     0                    -90339.46814 10150.3292   111%     -   14s
H    0     0                    -12657.83077 10150.3292   180%     -   14s
H    0     0                    -12552.68789 10150.3292   181%     -   14s
H    0     0                    -12538.01324 10150.3292   181%     -   14s
H    0     0                    -12532.59837 10150.3292   181%     -   14s
H    0     0                    -12526.07362 10150.3292   181%     -   14s
H    0     0                    -12355.72160 10150.3292   182%     -   17s
H    0     0                    -11898.26557 5870.74569   149%     -   64s
     0     0 5805.19856    0  287 -11898.266 5805.19856   149%     -   65s
     0     0 4594.97658    0  387 -11898.266 4594.97658   139%     -   93s
H    0     0                    -11796.35893 4594.97658   139%     -   96s
     0     0 4594.97658    0  393 -11796.359 4594.97658   139%     -   96s
     0     0 4594.97658    0  382 -11796.359 4594.97658   139%     -  101s
H    0     0                    -11789.31277 4594.97658   139%     -  105s
     0     0 4594.97658    0  393 -11789.313 4594.97658   139%     -  105s
     0     0 2455.06980    0  396 -11789.313 2455.06980   121%     -  121s
     0     0 2455.06980    0  399 -11789.313 2455.06980   121%     -  125s
     0     0 2455.06980    0  400 -11789.313 2455.06980   121%     -  125s
     0     0 2454.66227    0  474 -11789.313 2454.66227   121%     -  156s
     0     0 1984.57427    0  504 -11789.313 1984.57427   117%     -  172s
     0     0 1912.45307    0  521 -11789.313 1912.45307   116%     -  179s
     0     0 1867.83406    0  512 -11789.313 1867.83406   116%     -  184s
     0     0 1850.94809    0  506 -11789.313 1850.94809   116%     -  188s
     0     0 1707.34098    0  491 -11789.313 1707.34098   114%     -  196s
     0     0 1633.21570    0  503 -11789.313 1633.21570   114%     -  203s
     0     0 1594.37092    0  503 -11789.313 1594.37092   114%     -  210s
     0     0 1401.84483    0  526 -11789.313 1401.84483   112%     -  221s
     0     0 1385.28300    0  519 -11789.313 1385.28300   112%     -  225s
     0     0 1318.92848    0  510 -11789.313 1318.92848   111%     -  229s
     0     0 1306.89813    0  517 -11789.313 1306.89813   111%     -  232s
     0     0 1301.87920    0  517 -11789.313 1301.87920   111%     -  233s
     0     0 1301.67529    0  523 -11789.313 1301.67529   111%     -  234s
     0     0 -254.61886    0  509 -11789.313 -254.61886  97.8%     -  270s
     0     0 -900.55060    0  567 -11789.313 -900.55060  92.4%     -  296s
     0     0 -1170.2139    0  568 -11789.313 -1170.2139  90.1%     -  312s
     0     0 -1303.4113    0  556 -11789.313 -1303.4113  88.9%     -  321s
     0     0 -1346.8009    0  560 -11789.313 -1346.8009  88.6%     -  326s
     0     0 -1366.6954    0  573 -11789.313 -1366.6954  88.4%     -  328s
     0     0 -1372.9505    0  570 -11789.313 -1372.9505  88.4%     -  329s
     0     0 -1374.5235    0  574 -11789.313 -1374.5235  88.3%     -  330s
     0     0 -1399.8260    0  580 -11789.313 -1399.8260  88.1%     -  334s
     0     0 -1469.1473    0  575 -11789.313 -1469.1473  87.5%     -  337s
     0     0 -1478.0291    0  581 -11789.313 -1478.0291  87.5%     -  341s
     0     0 -1521.1245    0  570 -11789.313 -1521.1245  87.1%     -  343s
     0     0 -1521.8502    0  575 -11789.313 -1521.8502  87.1%     -  344s
     0     0 -2409.3189    0  554 -11789.313 -2409.3189  79.6%     -  375s
     0     0 -2571.7007    0  553 -11789.313 -2571.7007  78.2%     -  383s
     0     0 -2622.9321    0  567 -11789.313 -2622.9321  77.8%     -  388s
     0     0 -2654.4401    0  642 -11789.313 -2654.4401  77.5%     -  391s
     0     0 -2663.4573    0  584 -11789.313 -2663.4573  77.4%     -  394s
     0     0 -2704.8144    0  572 -11789.313 -2704.8144  77.1%     -  399s
H    0     0                    -11786.08579 -2726.2258  76.9%     -  401s
H    0     0                    -11785.32350 -2726.2258  76.9%     -  401s
     0     0 -2726.2258    0  659 -11785.323 -2726.2258  76.9%     -  401s
     0     0 -2733.9133    0  646 -11785.323 -2733.9133  76.8%     -  403s
     0     0 -2736.0719    0  657 -11785.323 -2736.0719  76.8%     -  404s
     0     0 -2736.6566    0  660 -11785.323 -2736.6566  76.8%     -  405s
     0     0 -2873.7434    0  575 -11785.323 -2873.7434  75.6%     -  416s
H    0     0                    -11765.16048 -2876.7033  75.5%     -  417s
     0     0 -2926.6115    0  580 -11765.160 -2926.6115  75.1%     -  422s
     0     0 -2945.3629    0  642 -11765.160 -2945.3629  75.0%     -  425s
     0     0 -2951.1685    0  582 -11765.160 -2951.1685  74.9%     -  427s
     0     0 -2954.7812    0  512 -11765.160 -2954.7812  74.9%     -  428s
     0     0 -2974.5141    0  633 -11765.160 -2974.5141  74.7%     -  433s
     0     0 -2976.8035    0  580 -11765.160 -2976.8035  74.7%     -  433s
     0     0 -2978.3561    0  581 -11765.160 -2978.3561  74.7%     -  434s
     0     0 -3143.9360    0  613 -11765.160 -3143.9360  73.3%     -  446s
H    0     0                    -11747.60407 -3144.1170  73.2%     -  452s
     0     0 -3169.6343    0  580 -11747.604 -3169.6343  73.0%     -  456s
     0     0 -3178.7020    0  575 -11747.604 -3178.7020  72.9%     -  458s
     0     0 -3185.7498    0  591 -11747.604 -3185.7498  72.9%     -  461s
     0     0 -3187.4789    0  593 -11747.604 -3187.4789  72.9%     -  462s
     0     0 -3253.4814    0  574 -11747.604 -3253.4814  72.3%     -  468s
     0     0 -3273.0420    0  578 -11747.604 -3273.0420  72.1%     -  473s
     0     0 -3279.9533    0  584 -11747.604 -3279.9533  72.1%     -  474s
     0     0 -3286.8071    0  659 -11747.604 -3286.8071  72.0%     -  476s
     0     0 -3287.7425    0  664 -11747.604 -3287.7425  72.0%     -  477s
     0     0 -3326.3480    0  582 -11747.604 -3326.3480  71.7%     -  483s
     0     0 -3339.6349    0  586 -11747.604 -3339.6349  71.6%     -  503s
     0     0 -3341.4473    0  590 -11747.604 -3341.4473  71.6%     -  504s
     0     0 -3351.9485    0  591 -11747.604 -3351.9485  71.5%     -  509s
     0     0 -3355.6454    0  602 -11747.604 -3355.6454  71.4%     -  511s
     0     0 -3357.6557    0  604 -11747.604 -3357.6557  71.4%     -  512s
     0     0 -3362.9978    0  609 -11747.604 -3362.9978  71.4%     -  516s
     0     0 -3364.8290    0  600 -11747.604 -3364.8290  71.4%     -  518s
     0     0 -3368.7760    0  612 -11747.604 -3368.7760  71.3%     -  522s
     0     0 -3369.1646    0  612 -11747.604 -3369.1646  71.3%     -  526s
     0     2 -3369.1646    0  612 -11747.604 -3369.1646  71.3%     -  640s
     1     3 -3902.1319    1  645 -11747.604 -3369.1646  71.3% 27528  666s
     2     4 -3815.5606    1  575 -11747.604 -3815.5606  67.5% 20860  679s
     3     8 -4112.6013    2  660 -11747.604 -3815.9805  67.5% 17741  692s
     7    16 -4387.9596    3  631 -11747.604 -3943.7561  66.4% 11348  708s
    15    32 -4473.2620    4  549 -11747.604 -4129.7092  64.8% 10806  723s
    31    48 -6345.2165    5  381 -11747.604 -4213.0367  64.1% 12694  755s
    47    79 -6394.7748    6  433 -11747.604 -4213.0367  64.1% 15035  779s
    78   196 -6424.0872    7  428 -11747.604 -4213.0367  64.1% 12941  802s
   199   265 -6691.7824   10  340 -11747.604 -4213.0367  64.1%  7578  819s
H  216   265                    -11722.82692 -4213.0367  64.1%  7241  819s
   270   306 -6826.4597   13  333 -11722.827 -4213.0367  64.1%  6470  832s
   313   332 -7763.4752   14  275 -11722.827 -4213.0367  64.1%  6639  844s
   360   351 -7976.9164   15  268 -11722.827 -4213.0367  64.1%  6655  858s
   414   367 -8515.6032   17  228 -11722.827 -4213.0367  64.1%  6924  871s
   446   373 -8606.0878   18  228 -11722.827 -4213.0367  64.1%  7083  887s
   484   392 -9052.5990   19  226 -11722.827 -4213.0367  64.1%  7142  899s
   517   407 -9209.4036   20  215 -11722.827 -4213.0367  64.1%  7373  915s
   552   425 -9219.4651   21  223 -11722.827 -4213.0367  64.1%  7456  928s
   592   450 -9938.4856   20  130 -11722.827 -4213.0367  64.1%  7458  941s
   637   474     cutoff   21      -11722.827 -4213.0367  64.1%  7474  953s
   686   474 -11400.257   22  130 -11722.827 -4213.0367  64.1%  7453  970s
   742   461 -11045.161   21  228 -11722.827 -4213.0367  64.1%  7176  985s
   799   470 -11174.531   22  221 -11722.827 -4213.0367  64.1%  7064 1000s
   856   490 infeasible   23      -11722.827 -4213.0367  64.1%  6960 1017s
   923   505 -11287.988   27  233 -11722.827 -4213.0367  64.1%  6925 1032s
   994   527     cutoff   30      -11722.827 -4213.0367  64.1%  6834 1058s
  1072   560 -11022.400   41  257 -11722.827 -4213.0367  64.1%  6702 1074s
  1175   555 -11635.587   37  213 -11722.827 -4213.0367  64.1%  6501 1093s
  1264   567 infeasible   38      -11722.827 -4213.0367  64.1%  6426 1112s
  1323   570 -6946.5139    6  216 -11722.827 -4213.0367  64.1%  6492 1133s
  1388   584 infeasible   12      -11722.827 -4213.0367  64.1%  6559 1153s
  1448   600 -11413.183    6  310 -11722.827 -4213.0367  64.1%  6693 1175s
  1500   613     cutoff    7      -11722.827 -4213.0367  64.1%  6785 1195s
  1559   648 -6668.2582    6  264 -11722.827 -4213.0367  64.1%  6881 1216s
  1620   676 -8914.1211    8  187 -11722.827 -4213.0367  64.1%  7010 1237s
  1694   724     cutoff   12      -11722.827 -4213.0367  64.1%  7039 1260s
  1809   735 infeasible   11      -11722.827 -4375.7580  62.7%  6915 1281s
  1853   763 -4623.8485    6  547 -11722.827 -4376.5216  62.7%  6950 1303s
  1919   782 -5819.0877    7  520 -11722.827 -4376.5216  62.7%  6961 1325s
  1991   808 -7002.0510    8  478 -11722.827 -4376.5216  62.7%  6976 1352s
  2061   847 -7150.9198    9  474 -11722.827 -4376.5216  62.7%  7018 1380s
  2171   868 -7500.6614   10  465 -11722.827 -4376.5216  62.7%  6971 1406s
  2240   899 -10571.472   11  408 -11722.827 -4376.5216  62.7%  7041 1436s
  2314   920 -10638.579   12  399 -11722.827 -4376.5216  62.7%  7120 1463s
  2403   946 -10748.631   13  358 -11722.827 -4376.5216  62.7%  7146 1490s
  2502   993 -11366.852   15  353 -11722.827 -4376.5216  62.7%  7236 1526s
  2595  1024 -10694.109   12  214 -11722.827 -4376.5216  62.7%  7352 1557s
  2699  1035 -11543.454   19  152 -11722.827 -4376.5216  62.7%  7468 1586s
  2758  1073 infeasible   15      -11722.827 -4796.9681  59.1%  7530 1621s
  2852  1130 -10980.258   13  327 -11722.827 -5029.7079  57.1%  7600 1657s
  3001  1146 -8872.5178    7  370 -11722.827 -5029.7079  57.1%  7571 1696s
  3141  1177 -9288.1334    8  379 -11722.827 -5029.7079  57.1%  7613 1732s
  3292  1239 -10918.351   11  219 -11722.827 -5029.7079  57.1%  7682 1773s
  3466  1285 infeasible   12      -11722.827 -5029.7079  57.1%  7718 1817s
  3663  1352 -11509.524   12  315 -11722.827 -6467.4835  44.8%  7714 1861s
  3842  1394 infeasible   11      -11722.827 -6670.1080  43.1%  7782 1909s
  4028  1438 -10322.256   16  344 -11722.827 -6670.1080  43.1%  7806 1959s
  4203  1483 -10875.747   20  239 -11722.827 -6670.1080  43.1%  7887 2010s
  4410  1500 infeasible   15      -11722.827 -6900.7475  41.1%  7929 2053s
  4525  1538 -9611.6080   12  322 -11722.827 -6900.7475  41.1%  7943 2110s
  4708  1569 infeasible   14      -11722.827 -6931.4894  40.9%  7984 2164s
  4908  1607 infeasible   11      -11722.827 -7079.0360  39.6%  8072 2219s
  5133  1641 -10119.273   14  288 -11722.827 -7079.0360  39.6%  8141 2278s
  5409  1687 -10687.566   13  281 -11722.827 -7334.1270  37.4%  8140 2338s
  5716  1748 infeasible   13      -11722.827 -7334.1270  37.4%  8126 2409s
  6026  1815 infeasible   13      -11722.827 -7515.1946  35.9%  8106 2474s
  6313  1903 -11514.757   14  164 -11722.827 -7531.2818  35.8%  8121 2543s
  6580  1904 -9161.3662   10  612 -11722.827 -7640.2358  34.8%  8106 2762s
  6582  1905 -11381.128   39  191 -11722.827 -7640.2358  34.8%  8103 2777s
  6583  1906 -11362.441   15  392 -11722.827 -7640.2358  34.8%  8102 2851s
  6584  1907 -10291.357   16  539 -11722.827 -7640.2358  34.8%  8101 2891s
  6585  1907 -11487.696   28  589 -11722.827 -7640.2358  34.8%  8100 2924s
  6586  1908 -9534.2502   11  592 -11722.827 -7640.2358  34.8%  8098 2944s
  6587  1909 -8203.1227   15  540 -11722.827 -7640.2358  34.8%  8097 2964s
  6588  1909 -8621.7942   14  619 -11722.827 -7640.2358  34.8%  8096 2978s
  6589  1910 -10226.005   16  619 -11722.827 -7640.2358  34.8%  8095 2986s
  6590  1911 -8334.3690   13  572 -11722.827 -7640.2358  34.8%  8093 2993s
  6591  1911 -8461.4966   12  573 -11722.827 -7640.2358  34.8%  8092 3011s
  6592  1912 -10319.459   24  590 -11722.827 -7640.2358  34.8%  8091 3015s
  6594  1913 -10791.686   13  590 -11722.827 -7640.2358  34.8%  8089 3024s
  6595  1914 -9762.5481   17  646 -11722.827 -7640.2358  34.8%  8087 3039s
  6596  1915 -11325.343   18  633 -11722.827 -7640.2358  34.8%  8086 3044s
  6597  1915 -11656.918   32  674 -11722.827 -7640.2358  34.8%  8085 3049s
  6598  1916 -10325.374   13  679 -11722.827 -7640.2358  34.8%  8084 3056s
  6599  1917 -9818.2142   18  630 -11722.827 -7640.2358  34.8%  8082 3074s
  6600  1917 -9406.5147   12  640 -11722.827 -7640.2358  34.8%  8081 3081s
  6601  1918 -8410.0294   11  638 -11722.827 -7640.2358  34.8%  8080 3088s
  6602  1919 -10652.888   17  645 -11722.827 -7640.2358  34.8%  8079 3101s
  6603  1919 -10390.566   28  582 -11722.827 -7640.2358  34.8%  8077 3110s
  6604  1920 -10655.494   21  594 -11722.827 -7640.2358  34.8%  8076 3125s
  6605  1921 -9815.2378   15  592 -11722.827 -7640.2358  34.8%  8075 3133s
  6606  1921 -9977.9155   11  674 -11722.827 -7640.2358  34.8%  8074 3148s
  6607  1922 -11062.118   20  674 -11722.827 -7640.2358  34.8%  8073 3163s
  6608  1923 -10606.689   31  674 -11722.827 -7640.2358  34.8%  8071 3231s
  6609  1926 -7640.2358   14  607 -11722.827 -7640.2358  34.8%  8123 3252s
  6611  1929 -7640.2358   15  417 -11722.827 -7640.2358  34.8%  8123 3285s
  6614  1934 -7640.2358   16  416 -11722.827 -7640.2358  34.8%  8126 3318s
  6620  1945 -7640.2358   16  568 -11722.827 -7640.2358  34.8%  8137 3344s
  6633  1952 -7640.2358   17  552 -11722.827 -7640.2358  34.8%  8153 3600s

Cutting planes:
  Gomory: 3
  Implied bound: 11
  Projected implied bound: 75
  MIR: 1093
  Flow cover: 1640
  RLT: 22
  Relax-and-lift: 185

Explored 6645 nodes (54850020 simplex iterations) in 3600.06 seconds (9203.99 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11722.8 -11747.6 -11765.2 ... -12526.1

Time limit reached
Best objective -1.172282692458e+04, best bound -7.640235830550e+03, gap 34.8260%
  WARNING: Time limit reached. Using best solution found (gap: 34.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -11722.83, θ = 113408.25
  Upper Bound (UB) = -11722.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113408.25
  [DEBUG]   ✓ Scenario 0: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113408.25 ≤ Q = 113408.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 113408.25 ≤ Q = 113408.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7b246be5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x84db941b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.248434e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6304794.6327
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.245722e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124572.25    0  123 6304794.63 -124572.25   102%     -    0s
H    0     0                    -89334.71816 -124572.25  39.4%     -    0s
H    0     0                    -90417.14139 -124572.25  37.8%     -    0s
     0     0 -94192.245    0   84 -90417.141 -94192.245  4.18%     -    0s
H    0     0                    -93363.94675 -94181.620  0.88%     -    0s
     0     0 -93951.475    0   82 -93363.947 -93951.475  0.63%     -    0s
H    0     0                    -93683.21268 -93913.748  0.25%     -    0s
     0     0 -93753.012    0   61 -93683.213 -93753.012  0.07%     -    0s
     0     0 -93726.161    0   51 -93683.213 -93726.161  0.05%     -    0s
     0     0 -93719.504    0   47 -93683.213 -93719.504  0.04%     -    0s
     0     0 -93719.504    0    7 -93683.213 -93719.504  0.04%     -    0s
     0     0 -93712.106    0    8 -93683.213 -93712.106  0.03%     -    0s
     0     0 -93711.933    0    8 -93683.213 -93711.933  0.03%     -    0s
     0     0 -93696.822    0    5 -93683.213 -93696.822  0.01%     -    0s
     0     0 -93696.822    0    5 -93683.213 -93696.822  0.01%     -    0s
     0     0 -93685.691    0    4 -93683.213 -93685.691  0.00%     -    0s
     0     0 -93684.162    0    4 -93683.213 -93684.162  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 3
  Flow cover: 2
  RLT: 2

Explored 1 nodes (559 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -93683.2 -93597.4 -93524 ... 1.24843e+13
No other solutions better than -93683.2

Optimal solution found (tolerance 1.00e-06)
Best objective -9.368321267500e+04, best bound -9.368321267500e+04, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 112314.66
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93683.21
  [DEBUG]   S×d_nominal = 205997.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205997.87 + -93683.21 = 112314.66
  [DEBUG]   Current θ from Master = 113408.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1093.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12816.43
  Lower Bound (LB) = -12324.91
  Gap (UB-LB) = 602.0799, Absolute Gap = 602.0799, Relative Gap = 0.051360
  Not converged yet (gap = 602.08 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697311 nonzeros
Model fingerprint: 0x8a39cf20
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 109988 rows and 44658 columns
Presolve time: 2.40s
Presolved: 136035 rows, 57442 columns, 836457 nonzeros
Variable types: 55183 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.97s

Barrier statistics:
 Dense cols : 746
 AA' NZ     : 5.365e+06
 Factor NZ  : 1.253e+07 (roughly 180 MB of memory)
 Factor Ops : 2.886e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73178949e+07  2.23098270e+08  8.79e+04 1.83e+01  6.91e+04     5s
   1  -1.31505949e+07  1.96176596e+08  6.13e+04 4.83e+01  4.78e+04     5s
   2  -6.28643178e+06  1.53852883e+08  2.86e+04 6.08e+00  2.35e+04     5s
   3  -7.64487270e+05  1.14479941e+08  1.49e+03 1.30e+00  1.62e+03     5s
   4  -5.01076710e+05  8.42610763e+07  4.28e+02 7.91e-01  6.56e+02     5s
   5  -4.52481342e+05  5.08824855e+07  2.80e+02 4.20e-01  3.94e+02     5s
   6  -3.74413627e+05  3.86524406e+07  9.52e+01 2.99e-01  2.17e+02     5s
   7  -3.25013953e+05  2.85914316e+07  3.50e+01 2.12e-01  1.36e+02     5s
   8  -2.41902492e+05  1.79497096e+07  1.52e+00 1.29e-01  7.39e+01     5s
   9  -1.67743776e+05  8.19480820e+06  2.44e-01 5.71e-02  3.37e+01     5s
  10  -1.04634333e+05  2.20253734e+06  7.93e-02 1.40e-02  9.29e+00     5s
  11  -7.12968609e+04  9.93649578e+05  3.64e-02 6.27e-03  4.29e+00     5s
  12  -4.41047343e+04  3.53137037e+05  1.31e-02 2.07e-03  1.60e+00     5s
  13  -3.31421945e+04  2.02294229e+05  8.76e-03 1.19e-03  9.48e-01     6s
  14  -2.30642259e+04  1.34122725e+05  6.24e-03 8.87e-04  6.33e-01     6s
  15  -1.71446136e+04  9.13051707e+04  4.89e-03 5.80e-04  4.37e-01     6s
  16  -1.22341165e+04  6.30449513e+04  3.85e-03 3.77e-04  3.03e-01     6s
  17  -7.49445879e+03  4.39849693e+04  2.89e-03 2.45e-04  2.07e-01     6s
  18  -4.84775688e+03  3.52811405e+04  2.38e-03 1.81e-04  1.62e-01     6s
  19  -1.37150231e+03  2.85937286e+04  1.79e-03 1.32e-04  1.21e-01     6s
  20   3.74737741e+02  2.42863168e+04  1.49e-03 1.04e-04  9.63e-02     6s
  21   2.73598367e+03  2.04339767e+04  1.13e-03 7.64e-05  7.13e-02     6s
  22   4.90738400e+03  1.87954950e+04  8.26e-04 6.23e-05  5.59e-02     6s
  23   6.13103257e+03  1.69577150e+04  6.61e-04 4.65e-05  4.36e-02     6s
  24   7.52617026e+03  1.48427293e+04  4.76e-04 2.86e-05  2.95e-02     7s
  25   8.77842351e+03  1.34547565e+04  3.13e-04 1.72e-05  1.88e-02     7s
  26   9.19483845e+03  1.29910579e+04  2.59e-04 1.35e-05  1.53e-02     7s
  27   9.33231782e+03  1.27013597e+04  2.42e-04 1.10e-05  1.36e-02     7s
  28   9.81157785e+03  1.23946043e+04  1.81e-04 8.51e-06  1.04e-02     7s
  29   9.93265558e+03  1.21631951e+04  1.64e-04 7.12e-06  8.98e-03     7s
  30   1.02272331e+04  1.19929034e+04  1.26e-04 5.70e-06  7.11e-03     7s
  31   1.04216750e+04  1.17831676e+04  1.00e-04 4.59e-06  5.48e-03     7s
  32   1.05581614e+04  1.17044941e+04  8.31e-05 3.60e-06  4.62e-03     7s
  33   1.06601898e+04  1.16034144e+04  7.05e-05 2.84e-06  3.80e-03     7s
  34   1.07712668e+04  1.15847192e+04  5.67e-05 3.25e-06  3.28e-03     8s
  35   1.08745799e+04  1.15034951e+04  4.31e-05 2.94e-06  2.53e-03     8s
  36   1.09483354e+04  1.14263318e+04  3.42e-05 4.04e-06  1.92e-03     8s
  37   1.09730941e+04  1.14137636e+04  3.11e-05 3.74e-06  1.77e-03     8s
  38   1.09880422e+04  1.13907013e+04  2.92e-05 2.61e-06  1.62e-03     8s
  39   1.10430608e+04  1.13550581e+04  2.26e-05 1.21e-06  1.26e-03     8s
  40   1.10630716e+04  1.13401760e+04  2.03e-05 1.01e-06  1.12e-03     8s
  41   1.10951209e+04  1.13132911e+04  1.63e-05 6.23e-07  8.78e-04     8s
  42   1.11316529e+04  1.12861110e+04  1.20e-05 3.40e-07  6.22e-04     8s
  43   1.11614314e+04  1.12704192e+04  8.46e-06 6.91e-07  4.39e-04     8s
  44   1.11810472e+04  1.12665157e+04  6.26e-06 6.34e-07  3.44e-04     9s
  45   1.12047954e+04  1.12519675e+04  3.47e-06 2.08e-07  1.90e-04     9s
  46   1.12082747e+04  1.12458051e+04  3.09e-06 1.16e-07  1.51e-04     9s
  47   1.12306826e+04  1.12403207e+04  5.73e-07 3.89e-08  3.88e-05     9s
  48   1.12368947e+04  1.12376541e+04  7.66e-08 2.14e-09  3.06e-06     9s
  49   1.12373370e+04  1.12373399e+04  3.12e-09 3.98e-11  1.14e-08     9s
  50   1.12373393e+04  1.12373393e+04  4.72e-09 3.39e-11  3.02e-10     9s

Barrier solved model in 50 iterations and 9.09 seconds (14.74 work units)
Optimal objective 1.12373393e+04


Root crossover log...

  114305 DPushes remaining with DInf 0.0000000e+00                 9s
   49253 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   10105 PPushes remaining with PInf 3.9245752e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2177302e+04     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64333    1.1237339e+04   0.000000e+00   1.217730e+04     15s
   64416    1.1237339e+04   0.000000e+00   0.000000e+00     15s
   64416    1.1237339e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 2.36s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.123734e+04, 64416 iterations, 14.43 seconds (27.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11237.3393    0  336 -196434.75 11237.3393   106%     -   18s
H    0     0                    -112033.7445 11237.3393   110%     -   18s
H    0     0                    -111691.0130 11237.3393   110%     -   18s
H    0     0                    -97698.89403 11237.3393   112%     -   18s
H    0     0                    -97696.67649 11237.3393   112%     -   18s
H    0     0                    -36605.28442 11237.3393   131%     -   18s
H    0     0                    -34757.34209 11237.3393   132%     -   18s
H    0     0                    -18450.94104 11237.3393   161%     -   18s
H    0     0                    -17951.83352 11237.3393   163%     -   19s
     0     0 5789.97655    0  380 -17951.834 5789.97655   132%     -   52s
     0     0 5789.97655    0  380 -17951.834 5789.97655   132%     -   52s
H    0     0                    -17410.29813 5789.78855   133%     -   53s
H    0     0                    -17382.19390 5789.78855   133%     -   53s
H    0     0                    -17350.88390 5789.78855   133%     -   53s
     0     0 5007.51548    0  385 -17350.884 5007.51548   129%     -   73s
     0     0 4845.47839    0  401 -17350.884 4845.47839   128%     -   81s
     0     0 4802.35360    0  400 -17350.884 4802.35360   128%     -   86s
     0     0 4801.26133    0  400 -17350.884 4801.26133   128%     -   87s
     0     0 4800.97552    0  400 -17350.884 4800.97552   128%     -   88s
     0     0 2617.63922    0  480 -17350.884 2617.63922   115%     -  130s
     0     0 2617.34965    0  483 -17350.884 2617.34965   115%     -  131s
     0     0 2360.04459    0  506 -17350.884 2360.04459   114%     -  152s
     0     0 2133.41510    0  499 -17350.884 2133.41510   112%     -  165s
     0     0 2071.30499    0  497 -17350.884 2071.30499   112%     -  175s
     0     0 2060.09432    0  508 -17350.884 2060.09432   112%     -  178s
     0     0 2031.19140    0  490 -17350.884 2031.19140   112%     -  184s
     0     0 2020.72252    0  487 -17350.884 2020.72252   112%     -  188s
     0     0 1952.81621    0  514 -17350.884 1952.81621   111%     -  196s
     0     0 1941.74488    0  511 -17350.884 1941.74488   111%     -  200s
     0     0 1940.09955    0  510 -17350.884 1940.09955   111%     -  204s
     0     0 1924.88037    0  511 -17350.884 1924.88037   111%     -  209s
     0     0 1921.38712    0  518 -17350.884 1921.38712   111%     -  211s
     0     0 1919.64918    0  510 -17350.884 1919.64918   111%     -  212s
     0     0 1919.63952    0  514 -17350.884 1919.63952   111%     -  213s
     0     0   74.76260    0  522 -17350.884   74.76260   100%     -  260s
     0     0 -375.74818    0  584 -17350.884 -375.74818  97.8%     -  279s
     0     0 -619.32937    0  567 -17350.884 -619.32937  96.4%     -  290s
     0     0 -651.38576    0  569 -17350.884 -651.38576  96.2%     -  297s
     0     0 -681.90046    0  565 -17350.884 -681.90046  96.1%     -  303s
     0     0 -789.48717    0  566 -17350.884 -789.48717  95.4%     -  314s
     0     0 -842.79321    0  573 -17350.884 -842.79321  95.1%     -  321s
     0     0 -952.87344    0  575 -17350.884 -952.87344  94.5%     -  332s
     0     0 -960.95213    0  576 -17350.884 -960.95213  94.5%     -  337s
     0     0 -965.45192    0  578 -17350.884 -965.45192  94.4%     -  340s
     0     0 -976.25091    0  582 -17350.884 -976.25091  94.4%     -  343s
     0     0 -981.92505    0  582 -17350.884 -981.92505  94.3%     -  346s
     0     0 -1069.0452    0  595 -17350.884 -1069.0452  93.8%     -  355s
     0     0 -1081.0277    0  587 -17350.884 -1081.0277  93.8%     -  359s
     0     0 -1081.8880    0  586 -17350.884 -1081.8880  93.8%     -  361s
     0     0 -1811.4825    0  561 -17350.884 -1811.4825  89.6%     -  387s
H    0     0                    -11871.39870 -1811.7790  84.7%     -  388s
H    0     0                    -11747.60407 -1811.7790  84.6%     -  388s
     0     0 -2124.4564    0  646 -11747.604 -2124.4564  81.9%     -  402s
     0     0 -2245.7561    0  631 -11747.604 -2245.7561  80.9%     -  412s
     0     0 -2272.2527    0  636 -11747.604 -2272.2527  80.7%     -  416s
     0     0 -2283.9822    0  645 -11747.604 -2283.9822  80.6%     -  419s
     0     0 -2286.8251    0  634 -11747.604 -2286.8251  80.5%     -  421s
     0     0 -2296.6834    0  647 -11747.604 -2296.6834  80.4%     -  422s
     0     0 -2299.1825    0  650 -11747.604 -2299.1825  80.4%     -  423s
     0     0 -2367.7269    0  643 -11747.604 -2367.7269  79.8%     -  429s
     0     0 -2383.5418    0  645 -11747.604 -2383.5418  79.7%     -  433s
     0     0 -2395.5923    0  649 -11747.604 -2395.5923  79.6%     -  436s
     0     0 -2405.5823    0  650 -11747.604 -2405.5823  79.5%     -  439s
     0     0 -2410.2301    0  655 -11747.604 -2410.2301  79.5%     -  440s
     0     0 -2432.1865    0  649 -11747.604 -2432.1865  79.3%     -  444s
     0     0 -2445.5442    0  662 -11747.604 -2445.5442  79.2%     -  447s
     0     0 -2450.5136    0  659 -11747.604 -2450.5136  79.1%     -  449s
     0     0 -2455.2082    0  592 -11747.604 -2455.2082  79.1%     -  450s
     0     0 -2470.6968    0  666 -11747.604 -2470.6968  79.0%     -  453s
     0     0 -2471.8009    0  659 -11747.604 -2471.8009  79.0%     -  454s
     0     0 -2746.7638    0  564 -11747.604 -2746.7638  76.6%     -  465s
     0     0 -2809.7263    0  573 -11747.604 -2809.7263  76.1%     -  471s
     0     0 -2831.1672    0  562 -11747.604 -2831.1672  75.9%     -  474s
     0     0 -2840.6958    0  555 -11747.604 -2840.6958  75.8%     -  476s
     0     0 -2844.4694    0  566 -11747.604 -2844.4694  75.8%     -  478s
     0     0 -2846.9988    0  569 -11747.604 -2846.9988  75.8%     -  479s
     0     0 -2847.0979    0  570 -11747.604 -2847.0979  75.8%     -  480s
     0     0 -2947.3981    0  574 -11747.604 -2947.3981  74.9%     -  491s
     0     0 -2981.0959    0  582 -11747.604 -2981.0959  74.6%     -  502s
     0     0 -2996.6894    0  582 -11747.604 -2996.6894  74.5%     -  505s
     0     0 -3004.9941    0  569 -11747.604 -3004.9941  74.4%     -  507s
     0     0 -3007.7011    0  576 -11747.604 -3007.7011  74.4%     -  508s
     0     0 -3011.1901    0  570 -11747.604 -3011.1901  74.4%     -  509s
     0     0 -3011.8309    0  573 -11747.604 -3011.8309  74.4%     -  510s
     0     0 -3085.2184    0  586 -11747.604 -3085.2184  73.7%     -  517s
     0     0 -3094.2246    0  596 -11747.604 -3094.2246  73.7%     -  520s
     0     0 -3098.5665    0  597 -11747.604 -3098.5665  73.6%     -  522s
     0     0 -3099.8557    0  590 -11747.604 -3099.8557  73.6%     -  524s
     0     0 -3125.8545    0  578 -11747.604 -3125.8545  73.4%     -  529s
     0     0 -3135.5847    0  581 -11747.604 -3135.5847  73.3%     -  533s
     0     0 -3139.7456    0  585 -11747.604 -3139.7456  73.3%     -  534s
     0     0 -3144.1301    0  593 -11747.604 -3144.1301  73.2%     -  535s
     0     0 -3150.3983    0  577 -11747.604 -3150.3983  73.2%     -  537s
     0     0 -3152.2656    0  578 -11747.604 -3152.2656  73.2%     -  538s
     0     0 -3176.5379    0  579 -11747.604 -3176.5379  73.0%     -  544s
     0     0 -3214.3598    0  622 -11747.604 -3214.3598  72.6%     -  550s
     0     0 -3221.2500    0  567 -11747.604 -3221.2500  72.6%     -  552s
     0     0 -3228.8409    0  644 -11747.604 -3228.8409  72.5%     -  555s
     0     0 -3230.2214    0  641 -11747.604 -3230.2214  72.5%     -  556s
     0     0 -3248.0531    0  626 -11747.604 -3248.0531  72.4%     -  563s
     0     0 -3260.1060    0  623 -11747.604 -3260.1060  72.2%     -  568s
     0     0 -3265.4021    0  637 -11747.604 -3265.4021  72.2%     -  570s
     0     0 -3267.4138    0  637 -11747.604 -3267.4138  72.2%     -  572s
     0     0 -3290.9586    0  565 -11747.604 -3290.9586  72.0%     -  578s
     0     0 -3294.0234    0  573 -11747.604 -3294.0234  72.0%     -  581s
     0     0 -3296.0641    0  577 -11747.604 -3296.0641  71.9%     -  583s
     0     0 -3310.6263    0  583 -11747.604 -3310.6263  71.8%     -  588s
     0     0 -3313.2755    0  587 -11747.604 -3313.2755  71.8%     -  599s
     0     0 -3314.8411    0  590 -11747.604 -3314.8411  71.8%     -  600s
     0     0 -3320.2432    0  583 -11747.604 -3320.2432  71.7%     -  604s
     0     0 -3320.4504    0  583 -11747.604 -3320.4504  71.7%     -  609s
     0     2 -3320.4504    0  583 -11747.604 -3320.4504  71.7%     -  722s
     1     3 -4165.6432    1  541 -11747.604 -3320.6183  71.7% 24263  748s
     2     6 -4311.0094    2  515 -11747.604 -3320.6183  71.7% 15164  763s
     5    10 -3986.0344    2  577 -11747.604 -3843.6787  67.3% 12453  789s
     9    19 -4123.3644    3  576 -11747.604 -3986.1569  66.1% 13529  804s
    18    37 -4506.5290    4  586 -11747.604 -3998.5582  66.0% 11452  824s
    36    50 -5773.8929    5  313 -11747.604 -4331.3406  63.1% 16166  887s
    49    77 -5534.2754    6  575 -11747.604 -4331.3406  63.1% 19588  921s
    76   190 -6286.3784    7  465 -11747.604 -4331.3406  63.1% 15552  955s
   189   248 -7191.1913    9  269 -11747.604 -4331.3406  63.1%  9649  973s
   247   315 -6454.9412   10  529 -11747.604 -4331.3406  63.1%  8713  990s
   316   382 -6618.5445   11  516 -11747.604 -4331.3406  63.1%  7993 1006s
   387   434 -6852.2040   12  455 -11747.604 -4331.3406  63.1%  7462 1024s
   453   450 -7046.2948   10  331 -11747.604 -4331.3406  63.1%  7349 1038s
   492   470 -7147.6429   13  434 -11747.604 -4331.3406  63.1%  7272 1054s
   532   483 -9744.8017   10  282 -11747.604 -4331.3406  63.1%  7128 1067s
   565   501 -7804.8540   14  402 -11747.604 -4331.3406  63.1%  7026 1082s
   604   511     cutoff   11      -11747.604 -4331.3406  63.1%  6913 1098s
   640   523 -7837.8989   15  338 -11747.604 -4331.3406  63.1%  6800 1115s
   681   534 -10700.200   16  160 -11747.604 -4331.3406  63.1%  6708 1131s
   728   544 -10810.919   17  124 -11747.604 -4331.3406  63.1%  6579 1145s
   760   566 -10963.535   18  149 -11747.604 -4331.3406  63.1%  6491 1160s
   812   587 -11227.832   20  134 -11747.604 -4331.3406  63.1%  6358 1175s
   875   596 -11584.482   22  135 -11747.604 -4331.3406  63.1%  6218 1191s
   916   594     cutoff   23      -11747.604 -4331.3406  63.1%  6166 1208s
   969   598     cutoff   24      -11747.604 -4331.3406  63.1%  6101 1227s
  1030   608 -6202.0012   10  533 -11747.604 -4331.3406  63.1%  6073 1246s
  1084   644 -6306.4519   11  536 -11747.604 -4331.3406  63.1%  6048 1267s
  1141   681 -7102.4140   12  413 -11747.604 -4331.3406  63.1%  6095 1286s
  1200   730 -7244.6668   13  497 -11747.604 -4331.3406  63.1%  6143 1307s
  1275   756 -7298.2857   14  483 -11747.604 -4331.3406  63.1%  6111 1325s
  1357   786 -7539.2390   15  476 -11747.604 -4331.3406  63.1%  6012 1347s
  1429   832 -7815.4706   16  489 -11747.604 -4331.3406  63.1%  6027 1369s
  1513   881 -8011.1311   17  474 -11747.604 -4331.3406  63.1%  6034 1390s
  1615   979 -8128.3081   18  480 -11747.604 -4331.3406  63.1%  5981 1412s
  1747  1016 infeasible   19      -11747.604 -4331.3406  63.1%  5883 1435s
  1892  1029 infeasible   19      -11747.604 -4331.3406  63.1%  5831 1464s
  1979  1065 -11112.182   18  117 -11747.604 -4331.3406  63.1%  5945 1493s
  2053  1108 -11442.664   16  399 -11747.604 -4331.3406  63.1%  6146 1517s
  2152  1113 infeasible   17      -11747.604 -4331.3406  63.1%  6304 1547s
  2253  1155 -7088.2044    8  574 -11747.604 -4331.3406  63.1%  6450 1577s
  2359  1177 -8531.6964   13  405 -11747.604 -4331.3406  63.1%  6563 1605s
  2481  1191 -9515.5351   15  376 -11747.604 -4331.3406  63.1%  6655 1640s
  2553  1231 -11126.497   16  281 -11747.604 -4331.3406  63.1%  6861 1679s
  2649  1269 infeasible   17      -11747.604 -4730.7702  59.7%  6900 1715s
  2747  1300 -8471.2151    7  514 -11747.604 -4771.9885  59.4%  7102 1759s
  2864  1340 -8532.4139    8  496 -11747.604 -4771.9885  59.4%  7212 1797s
  2983  1375 -9953.8946   10  535 -11747.604 -4771.9885  59.4%  7355 1837s
  3117  1396 infeasible   12      -11747.604 -4771.9885  59.4%  7454 1878s
  3236  1425 -9414.2293    8  424 -11747.604 -4771.9885  59.4%  7579 1926s
  3340  1482 -10017.537    9  428 -11747.604 -4771.9885  59.4%  7657 1972s
  3501  1529 -11296.129   12  382 -11747.604 -5580.7550  52.5%  7684 2014s
  3636  1619 -7841.0502    9  269 -11747.604 -5580.7550  52.5%  7785 2061s
  3815  1681 -10242.973   11  263 -11747.604 -5580.7550  52.5%  7832 2112s
  4001  1735     cutoff   16      -11747.604 -5580.7550  52.5%  7867 2160s
  4213  1796 -10763.429   16  274 -11747.604 -6405.3881  45.5%  7848 2209s
  4393  1816 -11037.692   20  223 -11747.604 -6405.3881  45.5%  7906 2258s
  4543  1841 -11706.196   22  195 -11747.604 -6685.4399  43.1%  7930 2320s
  4687  1898 -7798.9146   11  405 -11747.604 -6685.4399  43.1%  7981 2376s
  4882  1953 -8885.7143   13  307 -11747.604 -6685.4399  43.1%  8027 2434s
  5068  1970 infeasible   19      -11747.604 -6868.4532  41.5%  8099 2485s
  5115  1989 -9090.2914   11  275 -11747.604 -6868.4532  41.5%  8141 2530s
  5166  2000 -9339.9868   12  332 -11747.604 -6868.4532  41.5%  8171 2585s
  5257  2095 -10654.267   11  355 -11747.604 -6932.4935  41.0%  8225 2645s
H 5301  2091                    -11723.75430 -6932.4935  40.9%  8237 2645s
  5433  2092 -8550.4273   17  583 -11723.754 -6989.4735  40.4%  8134 2892s
  5435  2093 -9936.9098    9  194 -11723.754 -6989.4735  40.4%  8131 2908s
  5436  2094 -9549.1395   18  457 -11723.754 -6989.4735  40.4%  8130 2989s
  5437  2095 -11203.247   22  392 -11723.754 -6989.4735  40.4%  8128 3048s
  5438  2095 -10270.877   11  541 -11723.754 -6989.4735  40.4%  8127 3086s
  5439  2096 -9221.7576   17  516 -11723.754 -6989.4735  40.4%  8125 3110s
  5440  2097 -10206.637   18  556 -11723.754 -6989.4735  40.4%  8124 3129s
  5441  2097 -11291.807   12  559 -11723.754 -6989.4735  40.4%  8122 3142s
  5442  2098 -9058.5921   19  568 -11723.754 -6989.4735  40.4%  8121 3153s
  5443  2099 -10450.875   25  592 -11723.754 -6989.4735  40.4%  8119 3162s
  5444  2099 -9058.5921   19  602 -11723.754 -6989.4735  40.4%  8118 3174s
  5445  2100 -11512.376   17  575 -11723.754 -6989.4735  40.4%  8116 3203s
  5446  2101 -11332.946   42  684 -11723.754 -6989.4735  40.4%  8115 3210s
  5447  2101 -8673.3168    8  601 -11723.754 -6989.4735  40.4%  8113 3217s
  5448  2102 -8240.2488   16  550 -11723.754 -6989.4735  40.4%  8112 3225s
  5449  2103 -9090.4481   12  551 -11723.754 -6989.4735  40.4%  8110 3242s
  5450  2103 -9077.8492   14  566 -11723.754 -6989.4735  40.4%  8109 3248s
  5451  2104 -7734.9805   16  616 -11723.754 -6989.4735  40.4%  8107 3255s
  5453  2105 -11288.609   38  556 -11723.754 -6989.4735  40.4%  8105 3266s
  5454  2106 -10200.120   10  630 -11723.754 -6989.4735  40.4%  8103 3274s
  5455  2107 -11094.513   39  614 -11723.754 -6989.4735  40.4%  8102 3288s
  5456  2107 -10416.532   28  627 -11723.754 -6989.4735  40.4%  8100 3295s
  5457  2108 -11148.787   43  622 -11723.754 -6989.4735  40.4%  8099 3306s
  5458  2109 -9385.2808   16  627 -11723.754 -6989.4735  40.4%  8097 3314s
  5459  2109 -8357.3311   12  564 -11723.754 -6989.4735  40.4%  8096 3337s
  5460  2110 -9560.5769   10  618 -11723.754 -6989.4735  40.4%  8094 3346s
  5461  2111 -11002.591   16  543 -11723.754 -6989.4735  40.4%  8093 3360s
  5462  2111 -8049.9740   11  562 -11723.754 -6989.4735  40.4%  8091 3367s
  5463  2112 -7354.3870   10  576 -11723.754 -6989.4735  40.4%  8090 3378s
  5464  2113 -7679.6190    9  576 -11723.754 -6989.4735  40.4%  8088 3396s
  5465  2113 -9878.6322   35  576 -11723.754 -6989.4735  40.4%  8087 3518s
  5466  2116 -6989.4735   15  549 -11723.754 -6989.4735  40.4%  8162 3546s
  5467  2119 -6989.4735   16  288 -11723.754 -6989.4735  40.4%  8164 3573s
  5470  2122 -6989.4735   17  300 -11723.754 -6989.4735  40.4%  8165 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 9
  Projected implied bound: 181
  MIR: 1490
  Mixing: 2
  Flow cover: 1889
  RLT: 16
  Relax-and-lift: 202

Explored 5474 nodes (45358310 simplex iterations) in 3600.10 seconds (9463.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11723.8 -11747.6 -11871.4 ... -36605.3

Time limit reached
Best objective -1.172375429619e+04, best bound -6.989473488042e+03, gap 40.3820%
  WARNING: Time limit reached. Using best solution found (gap: 40.38%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.36s
  Master Objective (UB) = -11723.75, θ = 113364.43
  Upper Bound (UB) = -11723.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113364.43
  [DEBUG]   ✓ Scenario 0: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113364.43 ≤ Q = 113364.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 113364.43 ≤ Q = 113364.43 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6d8e0c57
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9271f3a9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.247290e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6312593.9448
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.241705e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124170.48    0  123 6312593.94 -124170.48   102%     -    0s
H    0     0                    -88936.23155 -124170.48  39.6%     -    0s
H    0     0                    -89856.21995 -124170.48  38.2%     -    0s
     0     0 -93268.022    0   41 -89856.220 -93268.022  3.80%     -    0s
H    0     0                    -91558.56151 -93239.909  1.84%     -    0s
H    0     0                    -91699.66626 -93239.909  1.68%     -    0s
H    0     0                    -92016.85367 -93239.909  1.33%     -    0s
H    0     0                    -92157.95842 -93239.909  1.17%     -    0s
     0     0 -93048.161    0   42 -92157.958 -93048.161  0.97%     -    0s
H    0     0                    -92401.81916 -93046.519  0.70%     -    0s
     0     0 -93031.835    0   42 -92401.819 -93031.835  0.68%     -    0s
     0     0 -92960.627    0   41 -92401.819 -92960.627  0.60%     -    0s
     0     0 -92930.460    0   41 -92401.819 -92930.460  0.57%     -    0s
     0     2 -92930.460    0   41 -92401.819 -92930.460  0.57%     -    0s
H   34     7                    -92406.65896 -92819.985  0.45%   7.5    0s
H   70    36                    -92450.41886 -92678.903  0.25%   5.5    0s
*  160    52              21    -92494.95540 -92643.818  0.16%   3.8    0s
*  257    21              20    -92498.46552 -92577.886  0.09%   3.3    0s
*  271    21              21    -92517.19098 -92577.886  0.07%   3.2    0s
*  292     1              23    -92522.08005 -92544.972  0.02%   3.2    0s

Cutting planes:
  Gomory: 21
  Implied bound: 3
  MIR: 152
  Flow cover: 2
  RLT: 2

Explored 303 nodes (1408 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -92522.1 -92517.2 -92498.5 ... -89856.2
No other solutions better than -92522.1

Optimal solution found (tolerance 1.00e-06)
Best objective -9.252208004589e+04, best bound -9.252208004589e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 113035.69
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92522.08
  [DEBUG]   S×d_nominal = 205557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205557.77 + -92522.08 = 113035.69
  [DEBUG]   Current θ from Master = 113364.43
  [DEBUG]   ⚠️  Z_SP ≤ θ by 328.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12052.49
  Lower Bound (LB) = -12052.49
  Gap (UB-LB) = 328.7329, Absolute Gap = 328.7329, Relative Gap = 0.028040
  Not converged yet (gap = 328.73 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740548 nonzeros
Model fingerprint: 0x1c3db795
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 116876 rows and 47456 columns
Presolve time: 2.61s
Presolved: 144437 rows, 60884 columns, 888190 nonzeros
Variable types: 58625 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 746
 AA' NZ     : 5.964e+06
 Factor NZ  : 1.422e+07 (roughly 200 MB of memory)
 Factor Ops : 3.601e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73309560e+07  2.34414368e+08  8.79e+04 1.71e+01  6.87e+04     4s
   1  -1.32021608e+07  2.06056412e+08  6.15e+04 4.80e+01  4.77e+04     4s
   2  -6.51119726e+06  1.61921503e+08  2.96e+04 7.41e+00  2.42e+04     5s
   3  -7.86094241e+05  1.21074613e+08  1.57e+03 1.31e+00  1.67e+03     5s
   4  -5.07877152e+05  8.96802666e+07  4.36e+02 8.00e-01  6.61e+02     5s
   5  -4.60564577e+05  5.44044704e+07  2.80e+02 4.24e-01  3.95e+02     5s
   6  -3.85529530e+05  4.17348943e+07  1.03e+02 3.05e-01  2.25e+02     5s
   7  -3.49335942e+05  3.18348299e+07  5.53e+01 2.25e-01  1.54e+02     5s
   8  -2.68911100e+05  1.92736779e+07  1.82e+00 1.28e-01  7.50e+01     5s
   9  -1.82784901e+05  8.66798411e+06  4.18e-01 5.61e-02  3.37e+01     5s
  10  -1.16396295e+05  2.89776436e+06  1.09e-01 1.75e-02  1.14e+01     5s
  11  -7.93057444e+04  1.07991917e+06  4.64e-02 6.36e-03  4.40e+00     5s
  12  -4.60942233e+04  3.73653264e+05  1.38e-02 2.16e-03  1.59e+00     5s
  13  -3.42112147e+04  1.91717785e+05  8.99e-03 1.16e-03  8.57e-01     5s
  14  -2.42884443e+04  1.26252194e+05  6.63e-03 1.40e-03  5.71e-01     5s
  15  -1.79911150e+04  9.40138318e+04  5.25e-03 1.01e-03  4.25e-01     6s
  16  -1.20778684e+04  6.29594535e+04  3.96e-03 8.71e-04  2.85e-01     6s
  17  -7.22682830e+03  4.10418207e+04  2.95e-03 5.03e-04  1.83e-01     6s
  18  -3.99742770e+03  3.81699586e+04  2.30e-03 4.56e-04  1.60e-01     6s
  19  -1.93643807e+03  2.91775047e+04  1.91e-03 3.13e-04  1.18e-01     6s
  20   4.42418592e+02  2.72869596e+04  1.50e-03 2.87e-04  1.02e-01     6s
  21   1.71766560e+03  2.15901213e+04  1.29e-03 1.95e-04  7.54e-02     6s
  22   4.27940623e+03  1.94089299e+04  9.06e-04 1.54e-04  5.74e-02     6s
  23   6.04474072e+03  1.63558120e+04  6.59e-04 9.48e-05  3.91e-02     6s
  24   7.41901361e+03  1.46096257e+04  4.81e-04 6.08e-05  2.73e-02     6s
  25   8.15163748e+03  1.34945646e+04  3.87e-04 3.94e-05  2.03e-02     7s
  26   8.77608349e+03  1.29266735e+04  3.10e-04 2.85e-05  1.57e-02     7s
  27   9.10353837e+03  1.24099868e+04  2.70e-04 1.89e-05  1.25e-02     7s
  28   9.73725436e+03  1.21916966e+04  1.90e-04 1.49e-05  9.31e-03     7s
  29   9.87012000e+03  1.19171754e+04  1.74e-04 1.02e-05  7.77e-03     7s
  30   1.00531573e+04  1.18984548e+04  1.52e-04 9.85e-06  7.00e-03     7s
  31   1.03704773e+04  1.17386469e+04  1.10e-04 7.37e-06  5.19e-03     7s
  32   1.05218314e+04  1.16606497e+04  9.13e-05 6.17e-06  4.32e-03     7s
  33   1.06072116e+04  1.16207245e+04  8.02e-05 5.54e-06  3.85e-03     7s
  34   1.06297630e+04  1.15237375e+04  7.73e-05 5.70e-06  3.39e-03     8s
  35   1.06679976e+04  1.14548395e+04  7.24e-05 4.40e-06  2.99e-03     8s
  36   1.07147928e+04  1.14241629e+04  6.59e-05 3.98e-06  2.69e-03     8s
  37   1.08234037e+04  1.13947743e+04  5.23e-05 3.83e-06  2.17e-03     8s
  38   1.08699565e+04  1.13558923e+04  4.63e-05 6.65e-06  1.84e-03     8s
  39   1.09444745e+04  1.13343286e+04  3.69e-05 6.65e-06  1.48e-03     8s
  40   1.09945987e+04  1.13255172e+04  3.04e-05 6.05e-06  1.26e-03     8s
  41   1.10154066e+04  1.13161057e+04  2.78e-05 5.45e-06  1.14e-03     8s
  42   1.10579406e+04  1.12992733e+04  2.23e-05 5.63e-06  9.16e-04     9s
  43   1.10694307e+04  1.12971743e+04  2.09e-05 5.37e-06  8.64e-04     9s
  44   1.11102442e+04  1.12834295e+04  1.56e-05 4.04e-06  6.57e-04     9s
  45   1.11476779e+04  1.12721757e+04  1.10e-05 2.49e-06  4.72e-04     9s
  46   1.11716349e+04  1.12629419e+04  8.00e-06 1.79e-06  3.46e-04     9s
  47   1.11845867e+04  1.12592289e+04  6.36e-06 1.55e-06  2.83e-04     9s
  48   1.12026944e+04  1.12481806e+04  4.08e-06 9.29e-07  1.73e-04     9s
  49   1.12053376e+04  1.12475420e+04  3.76e-06 8.70e-07  1.60e-04     9s
  50   1.12056595e+04  1.12465494e+04  3.72e-06 7.86e-07  1.55e-04    10s
  51   1.12223335e+04  1.12424517e+04  1.76e-06 3.80e-07  7.63e-05    10s
  52   1.12325492e+04  1.12394952e+04  5.15e-07 1.48e-07  2.64e-05    10s
  53   1.12360387e+04  1.12374915e+04  1.28e-07 6.05e-08  5.52e-06    10s
  54   1.12373045e+04  1.12373514e+04  3.20e-08 3.67e-10  1.79e-07    10s
  55   1.12373362e+04  1.12373394e+04  1.65e-06 3.30e-07  1.18e-08    10s
  56   1.12373393e+04  1.12373393e+04  7.16e-09 6.40e-08  3.76e-11    10s

Barrier solved model in 56 iterations and 10.14 seconds (17.12 work units)
Optimal objective 1.12373393e+04


Root crossover log...

  121327 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    3878 PPushes remaining with PInf 5.4843395e-06                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7516905e-10     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57425    1.1237339e+04   0.000000e+00   0.000000e+00     14s
   57425    1.1237339e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 2.38s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.123734e+04, 57425 iterations, 13.23 seconds (23.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11237.3393    0  336 -196434.75 11237.3393   106%     -   17s
H    0     0                    -66934.48074 11237.3393   117%     -   17s
H    0     0                    -29352.15936 11237.3393   138%     -   18s
H    0     0                    -23498.26140 11237.3393   148%     -   18s
H    0     0                    -20769.37960 11237.3393   154%     -   18s
H    0     0                    -20684.76819 11237.3393   154%     -   18s
H    0     0                    -18032.40948 11237.3393   162%     -   19s
     0     0 5390.84967    0  363 -18032.409 5390.84967   130%     -   64s
     0     0 5390.84967    0  363 -18032.409 5390.84967   130%     -   64s
H    0     0                    -17542.74051 5390.53751   131%     -   65s
H    0     0                    -17538.73483 5390.53751   131%     -   65s
     0     0 4937.64635    0  372 -17538.735 4937.64635   128%     -   82s
     0     0 4930.22018    0  381 -17538.735 4930.22018   128%     -   85s
     0     0 4841.02477    0  435 -17538.735 4841.02477   128%     -   91s
     0     0 4838.60065    0  436 -17538.735 4838.60065   128%     -   94s
     0     0 4817.21007    0  407 -17538.735 4817.21007   127%     -   96s
     0     0 4801.84108    0  409 -17538.735 4801.84108   127%     -   98s
     0     0 4706.65140    0  404 -17538.735 4706.65140   127%     -  104s
     0     0 4687.17922    0  398 -17538.735 4687.17922   127%     -  107s
     0     0 4676.65890    0  501 -17538.735 4676.65890   127%     -  110s
     0     0 4676.24110    0  497 -17538.735 4676.24110   127%     -  113s
     0     0 2468.54651    0  426 -17538.735 2468.54651   114%     -  138s
H    0     0                    -11943.15534 2467.85752   121%     -  138s
H    0     0                    -11879.51326 2467.85752   121%     -  138s
     0     0 2127.84225    0  419 -11879.513 2127.84225   118%     -  154s
     0     0 1986.88875    0  438 -11879.513 1986.88875   117%     -  160s
     0     0 1901.11962    0  446 -11879.513 1901.11962   116%     -  173s
     0     0 1840.92560    0  445 -11879.513 1840.92560   115%     -  182s
     0     0 1838.83373    0  441 -11879.513 1838.83373   115%     -  185s
     0     0 1804.77274    0  431 -11879.513 1804.77274   115%     -  189s
     0     0 1798.96915    0  431 -11879.513 1798.96915   115%     -  191s
     0     0 1796.15298    0  429 -11879.513 1796.15298   115%     -  193s
     0     0 1756.53219    0  424 -11879.513 1756.53219   115%     -  197s
     0     0 1741.59380    0  430 -11879.513 1741.59380   115%     -  202s
     0     0 1735.78847    0  427 -11879.513 1735.78847   115%     -  205s
     0     0 1530.12518    0  538 -11879.513 1530.12518   113%     -  223s
     0     0 1386.91659    0  559 -11879.513 1386.91659   112%     -  235s
     0     0 1329.73827    0  508 -11879.513 1329.73827   111%     -  240s
     0     0 1310.44511    0  522 -11879.513 1310.44511   111%     -  243s
     0     0 1308.15493    0  520 -11879.513 1308.15493   111%     -  244s
     0     0 1307.67797    0  526 -11879.513 1307.67797   111%     -  246s
     0     0 -577.66659    0  522 -11879.513 -577.66659  95.1%     -  291s
H    0     0                    -11876.33158 -578.87680  95.1%     -  292s
     0     0 -883.61285    0  612 -11876.332 -883.61285  92.6%     -  309s
     0     0 -979.22802    0  609 -11876.332 -979.22802  91.8%     -  320s
     0     0 -1036.5529    0  611 -11876.332 -1036.5529  91.3%     -  328s
     0     0 -1061.8650    0  605 -11876.332 -1061.8650  91.1%     -  334s
     0     0 -1079.1081    0  598 -11876.332 -1079.1081  90.9%     -  339s
     0     0 -1100.3646    0  592 -11876.332 -1100.3646  90.7%     -  343s
     0     0 -1113.9108    0  594 -11876.332 -1113.9108  90.6%     -  348s
     0     0 -1119.3792    0  607 -11876.332 -1119.3792  90.6%     -  351s
     0     0 -1121.0927    0  607 -11876.332 -1121.0927  90.6%     -  352s
     0     0 -1123.5655    0  614 -11876.332 -1123.5655  90.5%     -  353s
     0     0 -1125.2425    0  613 -11876.332 -1125.2425  90.5%     -  354s
     0     0 -1125.3412    0  613 -11876.332 -1125.3412  90.5%     -  355s
     0     0 -2073.4327    0  553 -11876.332 -2073.4327  82.5%     -  400s
     0     0 -2243.0078    0  559 -11876.332 -2243.0078  81.1%     -  414s
     0     0 -2283.8874    0  551 -11876.332 -2283.8874  80.8%     -  420s
     0     0 -2317.8201    0  550 -11876.332 -2317.8201  80.5%     -  426s
     0     0 -2325.7004    0  566 -11876.332 -2325.7004  80.4%     -  429s
     0     0 -2332.3298    0  572 -11876.332 -2332.3298  80.4%     -  431s
     0     0 -2415.4896    0  558 -11876.332 -2415.4896  79.7%     -  439s
     0     0 -2434.0209    0  560 -11876.332 -2434.0209  79.5%     -  442s
     0     0 -2438.6438    0  562 -11876.332 -2438.6438  79.5%     -  444s
     0     0 -2440.7771    0  565 -11876.332 -2440.7771  79.4%     -  445s
     0     0 -2442.8576    0  567 -11876.332 -2442.8576  79.4%     -  446s
     0     0 -2446.5752    0  565 -11876.332 -2446.5752  79.4%     -  449s
     0     0 -2447.2013    0  568 -11876.332 -2447.2013  79.4%     -  451s
     0     0 -2639.8159    0  607 -11876.332 -2639.8159  77.8%     -  467s
     0     0 -2756.2582    0  638 -11876.332 -2756.2582  76.8%     -  478s
     0     0 -2763.6119    0  557 -11876.332 -2763.6119  76.7%     -  482s
     0     0 -2764.9779    0  566 -11876.332 -2764.9779  76.7%     -  483s
     0     0 -2919.4645    0  557 -11876.332 -2919.4645  75.4%     -  496s
H    0     0                    -11838.38739 -2921.0173  75.3%     -  498s
H    0     0                    -11833.96672 -2921.0173  75.3%     -  498s
H    0     0                    -11767.84193 -2921.0173  75.2%     -  499s
H    0     0                    -11763.94899 -2921.0173  75.2%     -  499s
     0     0 -2942.1331    0  563 -11763.949 -2942.1331  75.0%     -  503s
     0     0 -2946.6203    0  571 -11763.949 -2946.6203  75.0%     -  507s
     0     0 -2950.7829    0  578 -11763.949 -2950.7829  74.9%     -  509s
     0     0 -2951.7099    0  573 -11763.949 -2951.7099  74.9%     -  510s
     0     0 -2993.4700    0  546 -11763.949 -2993.4700  74.6%     -  518s
     0     0 -3006.7593    0  557 -11763.949 -3006.7593  74.4%     -  524s
     0     0 -3011.5294    0  568 -11763.949 -3011.5294  74.4%     -  526s
     0     0 -3018.9447    0  567 -11763.949 -3018.9447  74.3%     -  529s
     0     0 -3019.0604    0  571 -11763.949 -3019.0604  74.3%     -  529s
     0     0 -3103.3181    0  550 -11763.949 -3103.3181  73.6%     -  541s
     0     0 -3112.4634    0  558 -11763.949 -3112.4634  73.5%     -  546s
     0     0 -3120.1435    0  562 -11763.949 -3120.1435  73.5%     -  549s
     0     0 -3122.8566    0  571 -11763.949 -3122.8566  73.5%     -  552s
     0     0 -3135.5679    0  556 -11763.949 -3135.5679  73.3%     -  554s
     0     0 -3137.1301    0  569 -11763.949 -3137.1301  73.3%     -  556s
     0     0 -3171.1854    0  569 -11763.949 -3171.1854  73.0%     -  564s
     0     0 -3175.5935    0  570 -11763.949 -3175.5935  73.0%     -  567s
     0     0 -3191.1689    0  573 -11763.949 -3191.1689  72.9%     -  570s
     0     0 -3198.9877    0  574 -11763.949 -3198.9877  72.8%     -  573s
     0     0 -3200.0861    0  576 -11763.949 -3200.0861  72.8%     -  574s
     0     0 -3265.3884    0  556 -11763.949 -3265.3884  72.2%     -  586s
     0     0 -3283.0702    0  566 -11763.949 -3283.0702  72.1%     -  593s
     0     0 -3292.5109    0  573 -11763.949 -3292.5109  72.0%     -  596s
     0     0 -3295.2689    0  574 -11763.949 -3295.2689  72.0%     -  598s
     0     0 -3295.4948    0  577 -11763.949 -3295.4948  72.0%     -  598s
     0     0 -3317.1393    0  581 -11763.949 -3317.1393  71.8%     -  606s
     0     0 -3336.7895    0  576 -11763.949 -3336.7895  71.6%     -  610s
     0     0 -3341.0633    0  575 -11763.949 -3341.0633  71.6%     -  612s
     0     0 -3343.9597    0  583 -11763.949 -3343.9597  71.6%     -  614s
     0     0 -3346.3326    0  595 -11763.949 -3346.3326  71.6%     -  615s
     0     0 -3353.6758    0  647 -11763.949 -3353.6758  71.5%     -  618s
     0     0 -3354.9495    0  597 -11763.949 -3354.9495  71.5%     -  619s
     0     0 -3371.2728    0  578 -11763.949 -3371.2728  71.3%     -  625s
     0     0 -3373.5824    0  586 -11763.949 -3373.5824  71.3%     -  628s
     0     0 -3378.3066    0  585 -11763.949 -3378.3066  71.3%     -  630s
     0     0 -3379.6536    0  591 -11763.949 -3379.6536  71.3%     -  631s
     0     0 -3401.0641    0  574 -11763.949 -3401.0641  71.1%     -  642s
     0     0 -3405.5050    0  576 -11763.949 -3405.5050  71.1%     -  646s
     0     0 -3407.1015    0  587 -11763.949 -3407.1015  71.0%     -  647s
     0     0 -3412.2928    0  578 -11763.949 -3412.2928  71.0%     -  651s
     0     0 -3414.1475    0  587 -11763.949 -3414.1475  71.0%     -  654s
     0     0 -3421.1993    0  580 -11763.949 -3421.1993  70.9%     -  658s
     0     0 -3422.5624    0  587 -11763.949 -3422.5624  70.9%     -  660s
     0     0 -3424.5460    0  580 -11763.949 -3424.5460  70.9%     -  663s
     0     0 -3426.0431    0  580 -11763.949 -3426.0431  70.9%     -  670s
H    0     0                    -11755.63452 -3426.0431  70.9%     -  809s
H    0     0                    -11748.30980 -3426.0431  70.8%     -  809s
     0     2 -3426.0431    0  580 -11748.310 -3426.0431  70.8%     -  884s
     1     4 -3715.9585    1  546 -11748.310 -3426.0431  70.8%  7476  892s
     3     8 -3813.1015    2  617 -11748.310 -3593.1774  69.4%  6852  925s
     7    16 -3846.8744    3  633 -11748.310 -3633.6985  69.1%  9811  947s
    15    32 -4126.6953    4  689 -11748.310 -3696.1132  68.5% 11778  970s
    31    48 -4811.3476    5  444 -11748.310 -3767.1077  67.9% 15559 1017s
    47    74 -5169.0552    6  444 -11748.310 -3767.1077  67.9% 17297 1049s
    73   171 -4180.4594    7  545 -11748.310 -3767.1077  67.9% 13916 1075s
   171   196 -5541.1473    9  370 -11748.310 -3767.1077  67.9%  9659 1094s
H  184   196                    -11747.60407 -3767.1077  67.9%  9262 1094s
   202   226 -4530.2157    9  533 -11747.604 -3767.1077  67.9%  9048 1117s
   232   283 -4685.9373   10  529 -11747.604 -3767.1077  67.9%  8539 1139s
   289   323 -4889.0364   11  526 -11747.604 -3767.1077  67.9%  7866 1164s
   340   355 -6918.5927   11  359 -11747.604 -3767.1077  67.9%  7390 1185s
   393   395 -4983.0300   13  507 -11747.604 -3767.1077  67.9%  7010 1207s
   445   407 -5073.8248   14  512 -11747.604 -3767.1077  67.9%  6762 1227s
   485   426 -6876.6812   11  361 -11747.604 -3767.1077  67.9%  6673 1247s
   526   433 -7788.2687   12  198 -11747.604 -3767.1077  67.9%  6523 1268s
   557   441 -8877.3756   12  245 -11747.604 -3767.1077  67.9%  6430 1287s
   596   435 -9633.3828   13  191 -11747.604 -3767.1077  67.9%  6474 1308s
   644   443 infeasible   15      -11747.604 -3767.1077  67.9%  6406 1328s
   678   457 -10330.415   13  333 -11747.604 -3767.1077  67.9%  6474 1348s
   718   476 -11166.438   14  145 -11747.604 -3767.1077  67.9%  6429 1367s
   764   484     cutoff   14      -11747.604 -3767.1077  67.9%  6336 1384s
   806   489 infeasible   18      -11747.604 -3767.1077  67.9%  6220 1402s
   862   489 -10084.524   15  203 -11747.604 -3767.1077  67.9%  6050 1424s
   916   515 -11042.261   16  151 -11747.604 -3767.1077  67.9%  5902 1448s
   975   541     cutoff   17      -11747.604 -3767.1077  67.9%  5795 1470s
  1038   560 infeasible   17      -11747.604 -3767.1077  67.9%  5700 1506s
  1114   583 -7230.0774   16  505 -11747.604 -3767.1077  67.9%  5540 1544s
  1195   608 -7488.8353   17  483 -11747.604 -3767.1077  67.9%  5418 1569s
  1295   639 -9469.2876   17  507 -11747.604 -3767.1077  67.9%  5215 1598s
  1378   661 infeasible   18      -11747.604 -3767.1077  67.9%  5112 1629s
  1446   668 -7612.8135   18  567 -11747.604 -3767.1077  67.9%  5100 1658s
  1517   677 -8859.2341   11  496 -11747.604 -3767.1077  67.9%  5038 1694s
  1573   692 -6310.5623    8  425 -11747.604 -3767.1077  67.9%  5034 1728s
  1616   712     cutoff   13      -11747.604 -3839.2910  67.3%  5092 1762s
  1675   726 -4688.2045    6  551 -11747.604 -3840.3192  67.3%  5181 1793s
  1712   744 -4940.0398    7  584 -11747.604 -3840.3192  67.3%  5240 1826s
  1775   757 -8096.3346    8  497 -11747.604 -3840.3192  67.3%  5258 1861s
  1837   778 -8322.0094    9  493 -11747.604 -3840.3192  67.3%  5281 1898s
  1922   785 -8734.9172   12  425 -11747.604 -3840.3192  67.3%  5295 1950s
  1967   799 -8837.4154   13  420 -11747.604 -3840.3192  67.3%  5318 1990s
  2022   802 -8864.9053   14  422 -11747.604 -3840.3192  67.3%  5308 2029s
  2073   808 -9093.1410   15  420 -11747.604 -3840.3192  67.3%  5341 2076s
  2117   829 -9153.2012   16  419 -11747.604 -3840.3192  67.3%  5368 2116s
  2155   853 -10596.078   17  425 -11747.604 -3840.3192  67.3%  5408 2157s
  2203   863 -11675.342   18  386 -11747.604 -3840.3192  67.3%  5466 2199s
  2275   871 infeasible   19      -11747.604 -3908.3255  66.7%  5600 2242s
  2337   889 -10912.634   19  398 -11747.604 -3908.3255  66.7%  5636 2290s
  2398   902     cutoff   20      -11747.604 -3908.3255  66.7%  5692 2338s
  2467   922 -11137.208   13  572 -11747.604 -3908.3255  66.7%  5729 2391s
  2547   940     cutoff   14      -11747.604 -3908.3255  66.7%  5765 2449s
  2619   974 infeasible   14      -11747.604 -4012.5696  65.8%  5767 2506s
  2707   993 -4866.9455    6  436 -11747.604 -4012.5696  65.8%  5780 2566s
  2807  1019 -5013.0649    7  429 -11747.604 -4134.3182  64.8%  5817 2633s
  2904  1054 -5540.3904    9  451 -11747.604 -4134.3182  64.8%  5874 2694s
  3073  1088 -7086.7427   13  325 -11747.604 -4134.3182  64.8%  6068 2768s
  3179  1147 -9030.4892   19  242 -11747.604 -4134.3182  64.8%  6105 2830s
  3374  1248 -10634.431   32  197 -11747.604 -4134.3182  64.8%  6353 2906s
  3567  1267 infeasible   50      -11747.604 -4870.2487  58.5%  6282 2971s
  3687  1306 -9407.2823   15  380 -11747.604 -4870.2487  58.5%  6305 3041s
  3831  1393 -11511.068   19  389 -11747.604 -4870.2487  58.5%  6458 3122s
  3985  1434 -7574.4305   16  399 -11747.604 -5738.4438  51.2%  6494 3234s
  4177  1494 -9392.2719   20  408 -11747.604 -5738.4438  51.2%  6457 3324s
  4381  1561 infeasible   34      -11747.604 -6115.2734  47.9%  6614 3415s
  4591  1618 infeasible   13      -11747.604 -6131.8304  47.8%  6616 3507s
  4810  1646 -10797.469    8  225 -11747.604 -6246.6608  46.8%  6659 3592s
  4987  1637 infeasible    9      -11747.604 -6246.6608  46.8%  6618 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 284
  MIR: 3881
  Flow cover: 3995
  RLT: 95
  Relax-and-lift: 728

Explored 5010 nodes (33757379 simplex iterations) in 3600.07 seconds (9541.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11747.6 -11748.3 -11755.6 ... -11943.2

Time limit reached
Best objective -1.174760406942e+04, best bound -6.246660825533e+03, gap 46.8261%
  WARNING: Time limit reached. Using best solution found (gap: 46.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -11747.60, θ = 113315.96
  Upper Bound (UB) = -11747.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113315.96
  [DEBUG]   ✓ Scenario 0: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113315.96 ≤ Q = 113315.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113315.96 ≤ Q = 113315.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113315.96 ≤ Q = 113315.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 113315.96 ≤ Q = 113315.96 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2e368748
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd1c978b8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.251128e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6296838.6415
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.245901e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124590.08    0  123 6296838.64 -124590.08   102%     -    0s
H    0     0                    -89358.32857 -124590.08  39.4%     -    0s
H    0     0                    -90293.43675 -124590.08  38.0%     -    0s
     0     0 -93873.856    0   69 -90293.437 -93873.856  3.97%     -    0s
H    0     0                    -93447.17034 -93851.485  0.43%     -    0s
     0     0 -93722.816    0   67 -93447.170 -93722.816  0.29%     -    0s
     0     0 -93720.466    0   67 -93447.170 -93720.466  0.29%     -    0s
     0     0 -93689.918    0   95 -93447.170 -93689.918  0.26%     -    0s
     0     0 -93621.253    0   23 -93447.170 -93621.253  0.19%     -    0s
     0     0 -93613.427    0   21 -93447.170 -93613.427  0.18%     -    0s
     0     0 -93513.505    0   14 -93447.170 -93513.505  0.07%     -    0s
     0     0 -93453.178    0   10 -93447.170 -93453.178  0.01%     -    0s
     0     0 -93453.178    0   11 -93447.170 -93453.178  0.01%     -    0s
     0     0 -93453.178    0    9 -93447.170 -93453.178  0.01%     -    0s
     0     0 -93453.178    0   10 -93447.170 -93453.178  0.01%     -    0s
     0     0 -93447.318    0    2 -93447.170 -93447.318  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 27
  MIR: 61
  Flow cover: 8
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (779 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -93447.2 -90293.4 -89358.3 ... 1.25113e+13
No other solutions better than -93447.2

Optimal solution found (tolerance 1.00e-06)
Best objective -9.344717034422e+04, best bound -9.344717034422e+04, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 112469.56
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93447.17
  [DEBUG]   S×d_nominal = 205916.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205916.73 + -93447.17 = 112469.56
  [DEBUG]   Current θ from Master = 113315.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 846.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12594.01
  Lower Bound (LB) = -12052.49
  Gap (UB-LB) = 304.8831, Absolute Gap = 304.8831, Relative Gap = 0.025953
  Not converged yet (gap = 304.88 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783785 nonzeros
Model fingerprint: 0x0ad31420
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-03, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 123744 rows and 50244 columns
Presolve time: 2.86s
Presolved: 152859 rows, 64336 columns, 940039 nonzeros
Variable types: 62077 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366196.7547
Found heuristic solution: objective -196434.7452

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 746
 AA' NZ     : 6.604e+06
 Factor NZ  : 1.572e+07 (roughly 200 MB of memory)
 Factor Ops : 4.131e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73431152e+07  2.45786275e+08  8.80e+04 1.67e+01  6.84e+04     5s
   1  -1.32585783e+07  2.15960196e+08  6.17e+04 4.76e+01  4.76e+04     5s
   2  -6.70171154e+06  1.69900540e+08  3.04e+04 8.52e+00  2.47e+04     5s
   3  -8.01421268e+05  1.27370840e+08  1.62e+03 1.60e+00  1.71e+03     5s
   4  -5.12425446e+05  9.36778796e+07  4.42e+02 9.53e-01  6.60e+02     5s
   5  -4.64391881e+05  5.72972009e+07  2.83e+02 5.25e-01  3.96e+02     5s
   6  -3.90807751e+05  4.37811407e+07  1.07e+02 3.76e-01  2.26e+02     5s
   7  -3.56285738e+05  3.34552092e+07  5.96e+01 2.75e-01  1.55e+02     5s
   8  -2.76126685e+05  2.14988542e+07  2.11e+00 1.66e-01  7.91e+01     6s
   9  -2.00243382e+05  1.19888028e+07  5.91e-01 9.12e-02  4.39e+01     6s
  10  -1.29305615e+05  3.45377965e+06  7.89e-02 2.40e-02  1.29e+01     6s
  11  -8.52723601e+04  1.55991314e+06  3.53e-02 1.06e-02  5.90e+00     6s
  12  -7.01208861e+04  1.13876836e+06  2.32e-02 7.65e-03  4.34e+00     6s
  13  -4.99729208e+04  4.77568586e+05  1.05e-02 3.17e-03  1.89e+00     6s
  14  -3.14817795e+04  2.32985765e+05  5.37e-03 1.57e-03  9.49e-01     6s
  15  -2.34906677e+04  1.55988994e+05  4.03e-03 9.46e-04  6.44e-01     6s
  16  -1.55778678e+04  1.09898784e+05  2.83e-03 6.36e-04  4.50e-01     6s
  17  -9.64299977e+03  6.76772538e+04  1.99e-03 3.74e-04  2.77e-01     6s
  18  -6.42363533e+03  4.96789674e+04  1.57e-03 2.61e-04  2.01e-01     7s
  19  -3.96486164e+03  4.05483363e+04  1.28e-03 2.02e-04  1.60e-01     7s
  20  -1.42243749e+03  3.27445080e+04  1.02e-03 1.94e-04  1.23e-01     7s
  21   1.23388676e+03  2.86052076e+04  7.50e-04 1.61e-04  9.82e-02     7s
  22   2.64908021e+03  2.72057945e+04  6.18e-04 1.48e-04  8.81e-02     7s
  23   4.28838920e+03  2.13764343e+04  4.81e-04 9.61e-05  6.13e-02     7s
  24   5.44129266e+03  1.99555040e+04  3.91e-04 8.23e-05  5.21e-02     7s
  25   6.35927404e+03  1.85883846e+04  3.22e-04 7.00e-05  4.39e-02     7s
  26   8.00854797e+03  1.60062917e+04  2.07e-04 4.48e-05  2.87e-02     7s
  27   8.77018709e+03  1.43635343e+04  1.58e-04 2.99e-05  2.01e-02     8s
  28   9.17154481e+03  1.32160450e+04  1.32e-04 1.92e-05  1.45e-02     8s
  29   9.60697794e+03  1.28785870e+04  1.05e-04 1.55e-05  1.17e-02     8s
  30   9.88436376e+03  1.24110377e+04  8.75e-05 1.11e-05  9.06e-03     8s
  31   1.00165842e+04  1.21259026e+04  7.96e-05 8.16e-06  7.57e-03     8s
  32   1.02658669e+04  1.19733917e+04  6.31e-05 6.91e-06  6.12e-03     8s
  33   1.04736089e+04  1.18278796e+04  5.05e-05 5.52e-06  4.86e-03     8s
  34   1.06231325e+04  1.17185347e+04  4.12e-05 4.40e-06  3.93e-03     8s
  35   1.06379340e+04  1.16696343e+04  4.02e-05 3.92e-06  3.70e-03     9s
  36   1.07588921e+04  1.15846639e+04  3.24e-05 3.05e-06  2.96e-03     9s
  37   1.08747891e+04  1.15309163e+04  2.46e-05 2.53e-06  2.35e-03     9s
  38   1.09159066e+04  1.14398567e+04  2.20e-05 1.63e-06  1.88e-03     9s
  39   1.09974130e+04  1.14121750e+04  1.68e-05 1.36e-06  1.49e-03     9s
  40   1.10353328e+04  1.14013518e+04  1.43e-05 1.29e-06  1.31e-03     9s
  41   1.11005993e+04  1.13845695e+04  1.03e-05 1.12e-06  1.02e-03     9s
  42   1.11198105e+04  1.13581438e+04  9.08e-06 8.55e-07  8.55e-04    10s
  43   1.11516615e+04  1.13530514e+04  7.16e-06 7.90e-07  7.22e-04    10s
  44   1.11741255e+04  1.13387774e+04  5.73e-06 6.45e-07  5.91e-04    10s
  45   1.11969451e+04  1.13305898e+04  4.28e-06 5.66e-07  4.79e-04    10s
  46   1.12190049e+04  1.13082263e+04  2.92e-06 7.80e-07  3.20e-04    10s
  47   1.12441849e+04  1.13031496e+04  1.42e-06 6.84e-07  2.12e-04    10s
  48   1.12464378e+04  1.12886080e+04  1.29e-06 4.12e-07  1.51e-04    10s
  49   1.12490657e+04  1.12769276e+04  1.14e-06 1.78e-07  9.99e-05    10s
  50   1.12671389e+04  1.12729160e+04  1.62e-07 1.47e-07  2.07e-05    11s
  51   1.12700558e+04  1.12709273e+04  4.74e-08 2.89e-08  3.13e-06    11s
  52   1.12700832e+04  1.12709128e+04  7.04e-08 3.32e-08  2.98e-06    11s
  53   1.12704759e+04  1.12706280e+04  1.89e-08 5.99e-10  5.46e-07    11s
  54   1.12706149e+04  1.12706216e+04  7.71e-09 4.92e-09  2.41e-08    11s
  55   1.12706212e+04  1.12706216e+04  5.41e-07 2.09e-07  1.34e-09    11s
  56   1.12706216e+04  1.12706216e+04  2.23e-08 6.62e-08  5.08e-11    11s

Barrier solved model in 56 iterations and 11.27 seconds (18.24 work units)
Optimal objective 1.12706216e+04


Root crossover log...

  128155 DPushes remaining with DInf 0.0000000e+00                11s
    4823 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    4559 PPushes remaining with PInf 1.2070310e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7438050e-10     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62591    1.1270622e+04   0.000000e+00   0.000000e+00     16s
   62591    1.1270622e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 1.98s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 1.127062e+04, 62591 iterations, 14.84 seconds (27.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11270.6216    0  340 -196434.75 11270.6216   106%     -   19s
H    0     0                    -117628.6099 11270.6216   110%     -   19s
H    0     0                    -116668.4692 11270.6216   110%     -   19s
H    0     0                    -89440.62089 11270.6216   113%     -   19s
H    0     0                    -45912.14253 11270.6216   125%     -   19s
H    0     0                    -41255.29122 11270.6216   127%     -   19s
H    0     0                    -27406.91857 11270.6216   141%     -   20s
H    0     0                    -18060.86144 11270.6216   162%     -   20s
H    0     0                    -18036.30241 11270.6216   162%     -   20s
H    0     0                    -18032.40948 11270.6216   163%     -   20s
     0     0 5810.67969    0  479 -18032.409 5810.67969   132%     -   64s
     0     0 5810.67969    0  479 -18032.409 5810.67969   132%     -   64s
H    0     0                    -17853.82888 5810.67263   133%     -   65s
H    0     0                    -17529.75734 5810.67263   133%     -   65s
H    0     0                    -17462.11522 5810.67263   133%     -   65s
     0     0 5486.61930    0  469 -17462.115 5486.61930   131%     -   83s
     0     0 5449.37944    0  486 -17462.115 5449.37944   131%     -   91s
     0     0 5443.34157    0  481 -17462.115 5443.34157   131%     -   94s
     0     0 5366.01404    0  474 -17462.115 5366.01404   131%     -  105s
     0     0 5355.57956    0  484 -17462.115 5355.57956   131%     -  108s
     0     0 5218.80124    0  483 -17462.115 5218.80124   130%     -  109s
     0     0 5218.80124    0  483 -17462.115 5218.80124   130%     -  110s
     0     0 2837.92762    0  498 -17462.115 2837.92762   116%     -  161s
H    0     0                    -11961.69545 2837.86460   124%     -  162s
H    0     0                    -11933.38223 2837.86460   124%     -  162s
H    0     0                    -11916.02457 2837.86460   124%     -  162s
H    0     0                    -11915.82582 2837.86460   124%     -  162s
H    0     0                    -11898.46816 2837.86460   124%     -  162s
     0     0 2310.40496    0  483 -11898.468 2310.40496   119%     -  194s
     0     0 2104.74475    0  485 -11898.468 2104.74475   118%     -  208s
     0     0 2028.75973    0  481 -11898.468 2028.75973   117%     -  218s
     0     0 2025.76331    0  500 -11898.468 2025.76331   117%     -  223s
     0     0 1987.46752    0  491 -11898.468 1987.46752   117%     -  232s
     0     0 1951.06139    0  505 -11898.468 1951.06139   116%     -  240s
     0     0 1889.77308    0  522 -11898.468 1889.77308   116%     -  251s
     0     0 1879.07434    0  524 -11898.468 1879.07434   116%     -  258s
     0     0 1856.67352    0  524 -11898.468 1856.67352   116%     -  262s
     0     0 1842.63217    0  523 -11898.468 1842.63217   115%     -  267s
     0     0 1835.81831    0  527 -11898.468 1835.81831   115%     -  272s
     0     0 1834.80715    0  528 -11898.468 1834.80715   115%     -  273s
     0     0  171.42889    0  430 -11898.468  171.42889   101%     -  320s
     0     0 -245.28923    0  629 -11898.468 -245.28923  97.9%     -  345s
     0     0 -508.70720    0  538 -11898.468 -508.70720  95.7%     -  362s
     0     0 -668.14166    0  619 -11898.468 -668.14166  94.4%     -  375s
     0     0 -692.74459    0  543 -11898.468 -692.74459  94.2%     -  381s
     0     0 -716.29644    0  472 -11898.468 -716.29644  94.0%     -  392s
     0     0 -875.88831    0  616 -11898.468 -875.88831  92.6%     -  405s
     0     0 -970.98953    0  628 -11898.468 -970.98953  91.8%     -  415s
     0     0 -975.15547    0  641 -11898.468 -975.15547  91.8%     -  418s
     0     0 -985.67415    0  633 -11898.468 -985.67415  91.7%     -  424s
     0     0 -992.96238    0  641 -11898.468 -992.96238  91.7%     -  427s
     0     0 -997.74438    0  646 -11898.468 -997.74438  91.6%     -  431s
     0     0 -1007.3835    0  545 -11898.468 -1007.3835  91.5%     -  436s
     0     0 -1008.6821    0  639 -11898.468 -1008.6821  91.5%     -  438s
     0     0 -1856.1714    0  558 -11898.468 -1856.1714  84.4%     -  469s
     0     0 -2087.9952    0  553 -11898.468 -2087.9952  82.5%     -  483s
     0     0 -2191.6780    0  575 -11898.468 -2191.6780  81.6%     -  492s
     0     0 -2341.2342    0  599 -11898.468 -2341.2342  80.3%     -  501s
     0     0 -2378.9152    0  585 -11898.468 -2378.9152  80.0%     -  507s
     0     0 -2399.3938    0  574 -11898.468 -2399.3938  79.8%     -  511s
     0     0 -2404.3389    0  592 -11898.468 -2404.3389  79.8%     -  514s
     0     0 -2407.5481    0  587 -11898.468 -2407.5481  79.8%     -  515s
     0     0 -2407.7030    0  589 -11898.468 -2407.7030  79.8%     -  516s
     0     0 -2656.4530    0  553 -11898.468 -2656.4530  77.7%     -  533s
     0     0 -2712.3164    0  582 -11898.468 -2712.3164  77.2%     -  539s
     0     0 -2736.1432    0  584 -11898.468 -2736.1432  77.0%     -  544s
     0     0 -2749.4105    0  584 -11898.468 -2749.4105  76.9%     -  547s
     0     0 -2751.3122    0  588 -11898.468 -2751.3122  76.9%     -  548s
     0     0 -2880.6824    0  554 -11898.468 -2880.6824  75.8%     -  560s
H    0     0                    -11851.28695 -2881.1057  75.7%     -  564s
H    0     0                    -11823.04176 -2881.1057  75.6%     -  564s
     0     0 -2911.4387    0  572 -11823.042 -2911.4387  75.4%     -  569s
     0     0 -2919.7058    0  583 -11823.042 -2919.7058  75.3%     -  572s
     0     0 -2926.6017    0  576 -11823.042 -2926.6017  75.2%     -  575s
     0     0 -2929.1115    0  579 -11823.042 -2929.1115  75.2%     -  576s
     0     0 -2929.6411    0  578 -11823.042 -2929.6411  75.2%     -  577s
     0     0 -2974.5226    0  665 -11823.042 -2974.5226  74.8%     -  586s
     0     0 -3007.2785    0  665 -11823.042 -3007.2785  74.6%     -  592s
     0     0 -3014.3493    0  662 -11823.042 -3014.3493  74.5%     -  595s
     0     0 -3020.3314    0  577 -11823.042 -3020.3314  74.5%     -  598s
     0     0 -3023.2358    0  573 -11823.042 -3023.2358  74.4%     -  601s
     0     0 -3026.5718    0  578 -11823.042 -3026.5718  74.4%     -  603s
     0     0 -3027.9266    0  587 -11823.042 -3027.9266  74.4%     -  605s
     0     0 -3107.1520    0  573 -11823.042 -3107.1520  73.7%     -  615s
H    0     0                    -11812.02181 -3107.2465  73.7%     -  616s
     0     0 -3125.8607    0  575 -11812.022 -3125.8607  73.5%     -  619s
     0     0 -3129.2679    0  575 -11812.022 -3129.2679  73.5%     -  621s
     0     0 -3134.0387    0  575 -11812.022 -3134.0387  73.5%     -  623s
     0     0 -3138.2614    0  584 -11812.022 -3138.2614  73.4%     -  625s
     0     0 -3138.4983    0  581 -11812.022 -3138.4983  73.4%     -  626s
     0     0 -3187.1997    0  590 -11812.022 -3187.1997  73.0%     -  634s
     0     0 -3205.9502    0  656 -11812.022 -3205.9502  72.9%     -  640s
     0     0 -3210.0295    0  597 -11812.022 -3210.0295  72.8%     -  643s
     0     0 -3212.5778    0  596 -11812.022 -3212.5778  72.8%     -  644s
     0     0 -3213.1478    0  598 -11812.022 -3213.1478  72.8%     -  645s
     0     0 -3238.8436    0  591 -11812.022 -3238.8436  72.6%     -  652s
     0     0 -3245.5841    0  605 -11812.022 -3245.5841  72.5%     -  662s
     0     0 -3248.5569    0  602 -11812.022 -3248.5569  72.5%     -  665s
     0     0 -3255.7690    0  596 -11812.022 -3255.7690  72.4%     -  668s
     0     0 -3272.2989    0  592 -11812.022 -3272.2989  72.3%     -  672s
     0     0 -3273.6155    0  599 -11812.022 -3273.6155  72.3%     -  674s
     0     0 -3285.8963    0  728 -11812.022 -3285.8963  72.2%     -  681s
     0     0 -3292.1122    0  724 -11812.022 -3292.1122  72.1%     -  684s
     0     0 -3293.0884    0  595 -11812.022 -3293.0884  72.1%     -  686s
     0     0 -3299.1634    0  596 -11812.022 -3299.1634  72.1%     -  697s
     0     0 -3300.1069    0  685 -11812.022 -3300.1069  72.1%     -  700s
     0     0 -3305.0582    0  602 -11812.022 -3305.0582  72.0%     -  704s
     0     0 -3305.8160    0  602 -11812.022 -3305.8160  72.0%     -  706s
     0     0 -3309.0393    0  602 -11812.022 -3309.0393  72.0%     -  710s
     0     0 -3310.1771    0  595 -11812.022 -3310.1771  72.0%     -  712s
     0     0 -3312.7483    0  600 -11812.022 -3312.7483  72.0%     -  715s
     0     0 -3312.7704    0  600 -11812.022 -3312.7704  72.0%     -  722s
H    0     0                    -11765.76401 -3312.7704  71.8%     -  840s
     0     2 -3312.7704    0  600 -11765.764 -3312.7704  71.8%     -  843s
     1     4 -3344.3688    1  586 -11765.764 -3312.7704  71.8%  2814  846s
     3     6 -3401.7607    2  566 -11765.764 -3344.8199  71.6%  4203  858s
     5     8 -3605.8551    2  575 -11765.764 -3350.7319  71.5%  6262  871s
     7    14 -3737.6865    3  591 -11765.764 -3410.0149  71.0%  6150  888s
    13    25 -4804.6716    4  533 -11765.764 -3521.4108  70.1%  9440  913s
    24    36 -5025.4086    4  441 -11765.764 -3691.5566  68.6% 15179  970s
    35    65 -5102.0291    5  543 -11765.764 -3793.2176  67.8% 14851 1179s
H   49    65                    -11761.87108 -3793.2228  67.7% 13671 1179s
H   53    65                    -11752.08220 -3793.2228  67.7% 13492 1179s
    64    97 -5227.0804    6  475 -11752.082 -3793.2228  67.7% 20331 1328s
H   96   210                    -11727.64723 -3793.2228  67.7% 18971 1397s
   209   306 -5669.8768    8  443 -11727.647 -3793.2228  67.7% 12125 1430s
   305   384 -5782.3859    9  440 -11727.647 -3793.2228  67.7% 10110 1467s
   383   473 -6020.2728   11  434 -11727.647 -3793.2228  67.7%  9271 1489s
   472   528 -7942.0213   12  170 -11727.647 -3793.2228  67.7%  8614 1507s
   550   579 -8578.6802   13  179 -11727.647 -3793.2228  67.7%  8335 1526s
   635   631 -8677.3715   14  184 -11727.647 -3793.2228  67.7%  8014 1544s
   722   684 -9641.9889   17  164 -11727.647 -3793.2228  67.7%  7815 1563s
   811   702 -10107.477   22  150 -11727.647 -3793.2228  67.7%  7612 1577s
   861   721     cutoff   23      -11727.647 -3793.2228  67.7%  7692 1596s
   920   738 -9497.3162   29  278 -11727.647 -3793.2228  67.7%  7736 1614s
   969   790 -9593.9876   31  230 -11727.647 -3793.2228  67.7%  7766 1632s
  1035   822 -10085.679   35  162 -11727.647 -3793.2228  67.7%  7773 1651s
  1087   848 -11329.024   36  126 -11727.647 -3793.2228  67.7%  7715 1667s
  1137   869 infeasible   38      -11727.647 -3793.2228  67.7%  7679 1687s
  1200   887 infeasible   18      -11727.647 -3793.2228  67.7%  7702 1709s
  1268   914 infeasible   20      -11727.647 -3793.2228  67.7%  7675 1731s
  1347   928 -11295.049   14  389 -11727.647 -3793.2228  67.7%  7721 1753s
  1393   956 -8219.3959   12  438 -11727.647 -3793.2228  67.7%  7803 1778s
  1451   985     cutoff   15      -11727.647 -3793.2228  67.7%  7893 1799s
  1519  1008 -8947.4575   13  272 -11727.647 -3793.2228  67.7%  7835 1823s
  1592  1025 -10670.392   14  134 -11727.647 -3793.2228  67.7%  7919 1849s
  1669  1054 infeasible   17      -11727.647 -3793.2228  67.7%  7969 1876s
  1740  1090 -6819.2575    9  387 -11727.647 -3793.2228  67.7%  8130 1903s
  1840  1107 -8055.7825   10  360 -11727.647 -3793.2228  67.7%  8146 1934s
  1929  1147 infeasible   11      -11727.647 -3793.2228  67.7%  8277 1964s
  2007  1169 -8659.5786   11  221 -11727.647 -3793.2228  67.7%  8447 1994s
  2070  1218 -11105.970   12  360 -11727.647 -3793.2228  67.7%  8540 2027s
  2167  1256 -10822.591   11  300 -11727.647 -3793.2228  67.7%  8616 2068s
  2269  1295     cutoff   13      -11727.647 -3793.2228  67.7%  8650 2105s
  2375  1312 -6907.0180    7  317 -11727.647 -3989.0044  66.0%  8725 2143s
  2414  1330 -7476.8623    8  214 -11727.647 -3990.2965  66.0%  8812 2182s
  2454  1350 -8231.4156    9  185 -11727.647 -4624.0665  60.6%  8902 2221s
  2504  1370 -8940.8736   10  197 -11727.647 -4624.0665  60.6%  8975 2278s
  2578  1409     cutoff   13      -11727.647 -4624.0665  60.6%  9064 2320s
  2645  1454 -11321.407   15   79 -11727.647 -4624.0665  60.6%  9184 2357s
  2742  1490 -7797.4292    9  483 -11727.647 -4624.0665  60.6%  9298 2399s
  2872  1555 -10725.862   11  406 -11727.647 -4624.0665  60.6%  9291 2449s
  3018  1598 -10805.568   12  398 -11727.647 -4624.0665  60.6%  9257 2504s
  3135  1652 -8992.5421   18  349 -11727.647 -4624.0665  60.6%  9372 2556s
  3276  1699 -10918.659   20  176 -11727.647 -4624.0665  60.6%  9403 2606s
  3431  1752 infeasible   27      -11727.647 -4624.0665  60.6%  9385 2660s
  3575  1764 -8577.9645   11  313 -11727.647 -4624.0665  60.6%  9453 2714s
  3674  1811 -11371.807   12  198 -11727.647 -4624.0665  60.6%  9471 2770s
  3806  1867 -9368.4820   12  166 -11727.647 -5180.9890  55.8%  9557 2832s
  3963  1882 -6516.8639    9  395 -11727.647 -5650.8378  51.8%  9696 2893s
  4137  1906 -8694.6581   13  164 -11727.647 -5650.8378  51.8%  9789 2958s
  4288  1951 -10253.326   17  195 -11727.647 -5668.2714  51.7%  9935 3027s
  4457  1997 -11398.861   38  212 -11727.647 -5668.2714  51.7% 10047 3101s
  4625  2032 -11483.138   12  417 -11727.647 -5668.2714  51.7% 10213 3173s
  4824  2043 -11560.974   13  459 -11727.647 -5979.5911  49.0% 10256 3252s
  4948  2072 -9235.0154   10  433 -11727.647 -5979.5911  49.0% 10322 3336s
  5085  2111     cutoff   13      -11727.647 -5979.5911  49.0% 10441 3420s
  5218  2217 infeasible   13      -11727.647 -6191.6705  47.2% 10585 3506s
  5446  2306 -8243.7139   10  368 -11727.647 -6227.3644  46.9% 10625 3594s

Cutting planes:
  Learned: 1
  Gomory: 4
  Implied bound: 227
  MIR: 4530
  Flow cover: 4719
  RLT: 87
  Relax-and-lift: 688

Explored 5714 nodes (61245513 simplex iterations) in 3600.10 seconds (10015.53 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11727.6 -11752.1 -11761.9 ... -11916

Time limit reached
Best objective -1.172764723301e+04, best bound -6.227364448428e+03, gap 46.9001%
  WARNING: Time limit reached. Using best solution found (gap: 46.90%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -11727.65, θ = 113360.53
  Upper Bound (UB) = -11727.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 113360.53
  [DEBUG]   ✓ Scenario 0: θ = 113360.53 ≤ Q = 113360.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 113360.53 ≤ Q = 113360.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 113360.53 ≤ Q = 113360.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 113360.53 ≤ Q = 113360.53 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 113360.53 ≤ Q = 113360.53 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3e2e4e30
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3e2e4e30
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.247290e+13
Presolve removed 2589 rows and 1882 columns
Presolve time: 0.00s
Presolved: 504 rows, 507 columns, 1421 nonzeros
Found heuristic solution: objective 6317657.5273
Variable types: 343 continuous, 164 integer (164 binary)

Root relaxation: objective -1.238498e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123849.82    0  123 6317657.53 -123849.82   102%     -    0s
H    0     0                    -88637.88995 -123849.82  39.7%     -    0s
H    0     0                    -89557.87836 -123849.82  38.3%     -    0s
     0     0 -92612.094    0   41 -89557.878 -92612.094  3.41%     -    0s
H    0     0                    -90659.96594 -92575.531  2.11%     -    0s
H    0     0                    -91186.12296 -92575.531  1.52%     -    0s
     0     0 -92553.714    0   42 -91186.123 -92553.714  1.50%     -    0s
H    0     0                    -91374.99516 -92553.714  1.29%     -    0s
     0     0 -92541.880    0   42 -91374.995 -92541.880  1.28%     -    0s
H    0     0                    -91516.09991 -92541.880  1.12%     -    0s
H    0     0                    -91716.68895 -92541.880  0.90%     -    0s
H    0     0                    -91756.14022 -92541.880  0.86%     -    0s
     0     2 -92541.880    0   42 -91756.140 -92541.880  0.86%     -    0s
H   40    29                    -91770.76340 -92308.903  0.59%   6.2    0s
H   42    28                    -91890.10089 -92308.903  0.46%   6.0    0s
*   71    18               7    -91947.59383 -92296.437  0.38%   6.5    0s

Cutting planes:
  Gomory: 1
  MIR: 139

Explored 600 nodes (2328 simplex iterations) in 0.07 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -91947.6 -91890.1 -91770.8 ... -88637.9
No other solutions better than -91947.6

Optimal solution found (tolerance 1.00e-06)
Best objective -9.194759383267e+04, best bound -9.194759383267e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 113307.94
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91947.59
  [DEBUG]   S×d_nominal = 205255.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205255.54 + -91947.59 = 113307.94
  [DEBUG]   Current θ from Master = 113360.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 52.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11780.24
  Lower Bound (LB) = -11780.24
  Gap (UB-LB) = 52.5883, Absolute Gap = 52.5883, Relative Gap = 0.004484
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 18
Total Time: 41210.52s
Converged: True
Final Lower Bound: -11780.2355
Final Upper Bound: -11727.6472
Final Gap: 52.588265
Number of Critical Scenarios: 18
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 5, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 8 customers  Mode 2: 42 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 18
Start Time: 2026-01-03 21:46:07
End Time: 2026-01-04 09:12:57
Total Time: 41210.52s
Optimal Value: -11780.24
Lower Bound: -11780.24
Upper Bound: -11727.65
Gap: 52.588265
Plants Opened: {0: [1], 1: [0], 2: [2]} (3 plants)
DCs Opened: [2, 5, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed29_LD_gamma20_20260104_091258.csv

Total Execution Time: 41211.29 seconds
End Time: 2026-01-04 09:12:58

All tasks completed successfully!

