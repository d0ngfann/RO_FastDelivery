
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 31
DI Scenario: LD
Start Time: 2026-01-04 01:15:03
================================================================================
Loading data from data/DH_data_full_seed31.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.027', '1.054'] (k=0.065)
  Product 1: ['1.000', '1.079', '1.163'] (k=0.187)
  Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=953, max=1707
  DC capacity (MC): min=537, max=893

Demand Structure (s_rk matrix):
  Total customer-product pairs: 83/150 (44.7% sparse)
  Average products per customer: 1.66

Demand (only non-zero entries):
  Nominal (μ): min=8.03, max=34.96, count=83
  Deviation (μ̂): min=4.06, max=9.95

Costs:
  Plant fixed cost: min=5416, max=9026
  DC fixed cost: min=3584, max=5357
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
    Product 1: ['1.000', '1.357', '1.840'] (k=0.752)
    Product 2: ['1.000', '1.369', '1.875'] (k=0.775)
  MD:
    Product 0: ['1.000', '1.211', '1.467'] (k=0.473)
    Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
    Product 2: ['1.000', '1.303', '1.698'] (k=0.653)
  LD:
    Product 0: ['1.000', '1.027', '1.054'] (k=0.065)
    Product 1: ['1.000', '1.079', '1.163'] (k=0.187)
    Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
  Mixed:
    Product 0: ['1.000', '1.311', '1.718'] (k=0.667)
    Product 1: ['1.000', '1.270', '1.614'] (k=0.590)
    Product 2: ['1.000', '1.119', '1.251'] (k=0.276)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48759 nonzeros
Model fingerprint: 0xcddb1cf5
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11748 rows and 2748 columns
Presolve time: 0.07s
Presolved: 4925 rows, 5752 columns, 34182 nonzeros
Variable types: 3493 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -323337.3007
Found heuristic solution: objective -197738.4924

Root relaxation: objective 7.152200e+04, 4685 iterations, 0.16 seconds (0.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 71522.0020    0  589 -197738.49 71522.0020   136%     -    0s
H    0     0                    -194959.3856 71522.0020   137%     -    0s
     0     0 69761.6998    0  754 -194959.39 69761.6998   136%     -    0s
H    0     0                    -173694.5833 69761.2367   140%     -    0s
     0     0 69734.2056    0  864 -173694.58 69734.2056   140%     -    0s
     0     0 69733.7571    0  867 -173694.58 69733.7571   140%     -    0s
     0     0 69733.6543    0  868 -173694.58 69733.6543   140%     -    0s
     0     0 67421.7052    0 1018 -173694.58 67421.7052   139%     -    1s
     0     0 66630.8382    0 1107 -173694.58 66630.8382   138%     -    1s
     0     0 66630.8382    0 1118 -173694.58 66630.8382   138%     -    1s
     0     0 66630.8382    0 1117 -173694.58 66630.8382   138%     -    1s
H    0     0                    -153576.3518 64390.4918   142%     -    3s
H    0     0                    -147546.9223 64390.4918   144%     -    3s
H    0     0                    -120637.9686 64390.4918   153%     -    3s
H    0     0                    -112468.1628 64262.1495   157%     -    3s
H    0     0                    -112142.7815 64262.1495   157%     -    3s
H    0     0                    -13817.77094 64262.1495   565%     -    3s
     0     0 64262.1495    0 1292 -13817.771 64262.1495   565%     -    3s
     0     0 63666.1080    0 1183 -13817.771 63666.1080   561%     -    3s
     0     0 63664.7089    0 1289 -13817.771 63664.7089   561%     -    3s
     0     0 62676.0397    0 1305 -13817.771 62676.0397   554%     -    4s
     0     0 62671.2213    0 1309 -13817.771 62671.2213   554%     -    4s
     0     0 62671.2213    0 1304 -13817.771 62671.2213   554%     -    4s
H    0     0                    -13661.97128 60015.0113   539%     -    5s
H    0     0                    -13491.78379 60015.0113   545%     -    5s
H    0     0                    -13010.07101 60015.0113   561%     -    5s
H    0     0                    -12903.42872 60015.0113   565%     -    5s
H    0     0                    -12599.32371 60015.0113   576%     -    5s
H    0     0                    -7751.858661 60015.0113   874%     -    5s
H    0     0                    -7744.071734 60015.0113   875%     -    5s
H    0     0                    -3217.690278 60015.0113  1965%     -    5s
H    0     0                    -3196.029497 60015.0113  1978%     -    5s
H    0     0                    -1755.404810 60015.0113  3519%     -    5s
H    0     0                    -677.4944989 60015.0113  8958%     -    5s
H    0     0                     299.5336883 60015.0113      -     -    5s
H    0     0                     862.1367824 60015.0113  6861%     -    5s
H    0     0                     883.6395360 60015.0113  6692%     -    5s
H    0     0                     949.4131998 60015.0113  6221%     -    5s
     0     0 60015.0113    0 1366  949.41320 60015.0113  6221%     -    5s
     0     0 60015.0113    0 1366  949.41320 60015.0113  6221%     -    6s
     0     2 60015.0113    0 1366  949.41320 60015.0113  6221%     -    6s
    15    32 56704.7896    4 1002  949.41320 60015.0113  6221%  2588   10s
H   95   246                    1116.3100695 54627.8881  4794%  1785   12s
H  100   246                    1187.0273478 54627.8881  4502%  1725   12s
H  373   384                    4001.9861280 54627.8881  1265%   762   13s
H  388   470                    11236.460148 54627.8881   386%   756   13s
H  426   470                    13364.749766 54627.8881   309%   724   13s
H  444   470                    13968.644442 54627.8881   291%   709   13s
H  509   531                    17406.406646 54627.8881   214%   666   14s
H  636   670                    18963.187072 54473.2529   187%   613   15s
H  640   670                    19298.879547 54473.2529   182%   614   15s
H  641   670                    21337.010662 54473.2529   155%   614   15s
H  647   670                    22033.667563 54473.2529   147%   614   15s
H  817   794                    22138.020256 54473.2529   146%   553   15s
H  818   794                    22269.746935 54473.2529   145%   553   15s
H  830   794                    22703.490420 54473.2529   140%   548   15s
H 1062  1027                    22849.181825 54337.5711   138%   500   16s
H 1090  1027                    23090.764837 54337.5711   135%   493   16s
H 1738  1564                    23156.090618 53125.3016   129%   434   18s
H 1743  1564                    23236.251929 53125.3016   129%   434   18s
H 1748  1564                    23236.456242 53125.3016   129%   434   18s
H 1784  1564                    23301.782023 53125.3016   128%   431   18s
  1897  1613 29681.1358   29  466 23301.7820 53125.3016   128%   425   20s
H 1921  1613                    23340.786188 53125.3016   128%   427   20s
H 2541  2253                    23364.921468 53125.3016   127%   384   21s
H 3801  2902                    23594.745850 50508.9939   114%   353   24s
  3877  2971 29281.2767   17  524 23594.7458 50508.9939   114%   352   25s
  4201  3052 39967.4738   21 1366 23594.7458 50508.9939   114%   355   43s
  4208  3057 35072.4087   17  557 23594.7458 35072.4087  48.6%   355   45s
  4226  3072 32826.4000   15  523 23594.7458 32826.4000  39.1%   357   50s
H 4472  2941                    24583.826640 29147.8423  18.6%   356   52s
H 4474  2794                    24698.768923 29147.8423  18.0%   356   52s
H 4484  2652                    25205.951886 29147.8423  15.6%   356   52s
H 4510  2511                    25462.826832 29147.8423  14.5%   354   52s
H 4620  2292                    25466.248636 29069.8943  14.2%   349   52s
H 4629  2170                    25492.510881 29069.8943  14.0%   348   52s
H 4630  2057                    25705.305846 29069.8943  13.1%   348   52s

Cutting planes:
  Implied bound: 2
  Projected implied bound: 53
  MIR: 180
  Flow cover: 350
  Zero half: 5
  RLT: 28
  Relax-and-lift: 67

Explored 4878 nodes (1657257 simplex iterations) in 53.61 seconds (113.89 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25705.3 25492.5 25466.2 ... 23340.8

Optimal solution found (tolerance 1.00e-06)
Best objective 2.570530584606e+04, best bound 2.570530584606e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 53.62s
  Master Objective (UB) = 25705.31, θ = 153321.67
  Upper Bound (UB) = 25705.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153321.67
  [DEBUG]   ✓ Scenario 0: θ = 153321.67 ≤ Q = 153321.67 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6101cd33
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6101cd33
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.314856e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 7056559.4451
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.189826e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118982.65    0  122 7056559.45 -118982.65   102%     -    0s
H    0     0                    -83789.88213 -118982.65  42.0%     -    0s
H    0     0                    -85181.96356 -118982.65  39.7%     -    0s
H    0     0                    -87430.55877 -87430.559  0.00%     -    0s
     0     0          -    0      -87430.559 -87430.559  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (379 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -87430.6 -85182 -83789.9 ... 1.31486e+13
No other solutions better than -87430.6

Optimal solution found (tolerance 1.00e-06)
Best objective -8.743055877476e+04, best bound -8.743055877476e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 117605.11
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -87430.56
  [DEBUG]   S×d_nominal = 205035.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205035.67 + -87430.56 = 117605.11
  [DEBUG]   Current θ from Master = 153321.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 35716.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -10011.25
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 35716.5604, Absolute Gap = 35716.5604, Relative Gap = 1.389463
  Not converged yet (gap = 35716.56 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91999 nonzeros
Model fingerprint: 0x5f2788cd
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -10011.3 (0.01s)
MIP start from previous solve produced solution with objective -10011.3 (0.01s)
Loaded MIP start from previous solve with objective -10011.3

Presolve removed 13595 rows and 5514 columns
Presolve time: 0.31s
Presolved: 18368 rows, 9226 columns, 101748 nonzeros
Variable types: 6967 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.478529e+04, 8472 iterations, 1.03 seconds (2.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 24785.2935    0  293 -10011.255 24785.2935   348%     -    1s
H    0     0                    -9355.955667 24785.2935   365%     -    1s
H    0     0                    -9009.300402 24785.2935   375%     -    1s
H    0     0                    -8961.557765 24785.2935   377%     -    1s
     0     0 18977.9183    0  559 -8961.5578 18977.9183   312%     -    3s
H    0     0                    -8938.998102 18975.7704   312%     -    3s
H    0     0                    -8872.930462 18975.7704   314%     -    3s
     0     0 18918.4751    0  564 -8872.9305 18918.4751   313%     -    3s
     0     0 18918.4751    0  563 -8872.9305 18918.4751   313%     -    3s
     0     0 13092.0099    0  647 -8872.9305 13092.0099   248%     -    5s
H    0     0                    -8872.676205 13081.6085   247%     -    5s
H    0     0                    -8866.677565 13081.6085   248%     -    5s
     0     0 12782.7356    0  726 -8866.6776 12782.7356   244%     -    5s
     0     0 12753.5486    0  743 -8866.6776 12753.5486   244%     -    6s
     0     0 12753.4439    0  741 -8866.6776 12753.4439   244%     -    6s
     0     0 8022.11403    0  654 -8866.6776 8022.11403   190%     -    9s
H    0     0                    -8822.975414 8020.36446   191%     -    9s
     0     0 7487.17311    0  831 -8822.9754 7487.17311   185%     -   10s
     0     0 7392.68717    0  781 -8822.9754 7392.68717   184%     -   10s
     0     0 7380.36580    0  723 -8822.9754 7380.36580   184%     -   11s
     0     0 7374.63526    0  777 -8822.9754 7374.63526   184%     -   11s
     0     0 7374.22450    0  778 -8822.9754 7374.22450   184%     -   11s
H    0     0                    -8821.165490 7374.22450   184%     -   12s
     0     0 5297.56224    0  753 -8821.1655 5297.56224   160%     -   14s
     0     0 5032.78292    0  842 -8821.1655 5032.78292   157%     -   15s
     0     0 4862.26472    0  859 -8821.1655 4862.26472   155%     -   16s
     0     0 4833.20523    0  865 -8821.1655 4833.20523   155%     -   16s
     0     0 4803.35091    0  859 -8821.1655 4803.35091   154%     -   17s
     0     0 4797.28540    0  864 -8821.1655 4797.28540   154%     -   17s
     0     0 4088.23054    0  582 -8821.1655 4088.23054   146%     -   19s
     0     0 3919.00280    0  689 -8821.1655 3919.00280   144%     -   20s
     0     0 3887.94509    0  680 -8821.1655 3887.94509   144%     -   20s
     0     0 3883.07340    0  604 -8821.1655 3883.07340   144%     -   20s
     0     0 3673.33191    0  693 -8821.1655 3673.33191   142%     -   21s
     0     0 3611.26089    0  668 -8821.1655 3611.26089   141%     -   22s
     0     0 3588.54287    0  681 -8821.1655 3588.54287   141%     -   23s
     0     0 3586.48900    0  679 -8821.1655 3586.48900   141%     -   23s
     0     0 3470.26038    0  745 -8821.1655 3470.26038   139%     -   24s
     0     0 3424.16938    0  602 -8821.1655 3424.16938   139%     -   25s
     0     0 3409.65044    0  741 -8821.1655 3409.65044   139%     -   25s
     0     0 3406.65631    0  600 -8821.1655 3406.65631   139%     -   25s
     0     0 3311.42494    0  728 -8821.1655 3311.42494   138%     -   26s
     0     0 3286.47142    0  841 -8821.1655 3286.47142   137%     -   27s
     0     0 3282.18732    0  838 -8821.1655 3282.18732   137%     -   27s
     0     0 3207.01358    0  673 -8821.1655 3207.01358   136%     -   28s
     0     0 3194.77579    0  667 -8821.1655 3194.77579   136%     -   29s
     0     0 3189.62523    0  664 -8821.1655 3189.62523   136%     -   29s
     0     0 3172.11901    0  573 -8821.1655 3172.11901   136%     -   29s
     0     0 3164.71881    0  585 -8821.1655 3164.71881   136%     -   30s
     0     0 3152.77121    0  584 -8821.1655 3152.77121   136%     -   31s
     0     0 3152.66845    0  584 -8821.1655 3152.66845   136%     -   31s
     0     2 3151.90667    0  584 -8821.1655 3151.90667   136%     -   35s
    15    32  212.06017    4  645 -8821.1655 2687.42140   130%  1594   40s
    95   127 -3184.1012    7  537 -8821.1655 2532.71852   129%  1325   45s
H  446   322                    -8680.404374 1125.92627   113%   608   49s
H  459   322                    -8607.946585 1125.92627   113%   597   49s
   494   338     cutoff   11      -8607.9466 1125.92627   113%   593   50s
H  511   338                    -8579.390820 1125.92627   113%   587   50s
H  920   511                    -8455.323035  203.98681   102%   501   54s
   950   539 -7830.6970   12  192 -8455.3230  203.98681   102%   505   55s
H 1546   762                    -8446.230035 -1450.1798  82.8%   393   58s
H 1551   762                    -8440.999255 -1450.1798  82.8%   393   58s
  1771   829 -5476.0018   11  267 -8440.9993 -1551.8886  81.6%   375   60s
  2620   928     cutoff   10      -8440.9993 -3104.1975  63.2%   332   65s
H 2624   928                    -8439.474033 -3104.1975  63.2%   331   65s
H 2626   928                    -8437.121116 -3104.1975  63.2%   331   65s
H 2635   928                    -8436.302096 -3104.1975  63.2%   331   65s
H 2637   928                    -8415.606694 -3104.1975  63.1%   331   65s
  3379  1133 -6228.5018   12  242 -8415.6067 -3104.1975  63.1%   304   70s
H 3941  1267                    -8385.077005 -4857.4880  42.1%   290   72s
H 3963  1267                    -8379.598420 -4857.4880  42.0%   289   72s
H 4049  1267                    -8369.332728 -4957.4242  40.8%   288   72s
H 4063  1267                    -8340.493998 -4957.4242  40.6%   287   72s
H 4084  1308                    -8310.624161 -4957.4242  40.3%   286   73s
H 4150  1308                    -8298.750354 -5009.7997  39.6%   284   73s
  4808  1714 -6374.8911   12  173 -8298.7504 -5345.7607  35.6%   264   75s
H 5843  1925                    -8290.246127 -5522.5113  33.4%   233   76s
  5923  1885 -7161.8130   16  584 -8290.2461 -5522.5113  33.4%   231   88s
  5925  1886 -6633.6539   11  126 -8290.2461 -5522.5113  33.4%   231   90s
  5928  1888 -5903.8452   14  545 -8290.2461 -5522.5113  33.4%   231   95s
  5935  1893 -8075.7856   37  657 -8290.2461 -5522.5113  33.4%   231  100s
  5938  1895 -6251.3470   21  585 -8290.2461 -5522.5113  33.4%   231  105s
  5940  1899 -5522.5113   16  454 -8290.2461 -5522.5113  33.4%   236  111s
  5954  1923 -5522.5113   19  495 -8290.2461 -5522.5113  33.4%   238  115s
H 5982  1847                    -8286.535938 -5522.5113  33.4%   243  116s
H 5990  1755                    -8275.436101 -5522.5113  33.3%   244  116s
H 5995  1667                    -8261.248813 -5522.5113  33.2%   244  116s
  6067  1730 -5522.5113   23  349 -8261.2488 -5522.5113  33.2%   252  120s
H 6075  1646                    -8247.660132 -5522.5113  33.0%   253  120s
H 6081  1566                    -8192.383595 -5522.5113  32.6%   253  120s
H 6290  1484                    -8191.185213 -5522.5113  32.6%   264  125s
H 6640  1330                    -8188.189918 -5522.5113  32.6%   278  129s
  6652  1329 -5522.5113   24  316 -8188.1899 -5522.5113  32.6%   279  130s
H 6736  1238                    -8187.076458 -5522.5113  32.5%   280  131s
H 6739  1174                    -8163.190999 -5522.5113  32.3%   280  131s
H 6878  1060                    -8159.131536 -5522.5113  32.3%   284  133s
H 6881  1002                    -8157.723418 -5522.5113  32.3%   284  133s
H 6897   942                    -8153.187521 -5522.5113  32.3%   285  133s
  6961   919 -5522.5113   27  341 -8153.1875 -5522.5113  32.3%   287  135s
  7335   755 -7369.2918   30  187 -8153.1875 -5522.5113  32.3%   295  141s
  7799   423 -8031.9380   25  303 -8153.1875 -5753.2805  29.4%   299  145s
* 8046   272              64    -8148.273248 -8116.6583  0.39%   293  147s

Cutting planes:
  MIR: 252
  Flow cover: 495
  Zero half: 4
  RLT: 10
  Relax-and-lift: 36

Explored 8118 nodes (2404655 simplex iterations) in 147.82 seconds (333.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8148.27 -8153.19 -8157.72 ... -8247.66
No other solutions better than -8148.27

Optimal solution found (tolerance 1.00e-06)
Best objective -8.148273248442e+03, best bound -8.148273248442e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 147.83s
  Master Objective (UB) = -8148.27, θ = 112933.08
  Upper Bound (UB) = -8148.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 112933.08
  [DEBUG]   ✓ Scenario 0: θ = 112933.08 ≤ Q = 112933.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 112933.08 ≤ Q = 112933.08 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x163374e9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe9cc8b17
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.525041e+13
Presolve removed 2586 rows and 1880 columns
Presolve time: 0.00s
Presolved: 507 rows, 509 columns, 1429 nonzeros
Found heuristic solution: objective 8483359.2974
Variable types: 343 continuous, 166 integer (166 binary)

Root relaxation: objective -1.293438e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129343.83    0  127 8483359.30 -129343.83   102%     -    0s
H    0     0                    -89757.43731 -129343.83  44.1%     -    0s
H    0     0                    -91050.36416 -129343.83  42.1%     -    0s
H    0     0                    -105372.7920 -129343.83  22.7%     -    0s
H    0     0                    -110445.5097 -114207.73  3.41%     -    0s
H    0     0                    -111512.2467 -114207.73  2.42%     -    0s
     0     0 -114207.73    0   54 -111512.25 -114207.73  2.42%     -    0s
H    0     0                    -112550.5646 -114178.68  1.45%     -    0s
H    0     0                    -112884.2901 -114178.68  1.15%     -    0s
H    0     0                    -113188.1649 -113949.56  0.67%     -    0s
     0     0 -113949.56    0   52 -113188.16 -113949.56  0.67%     -    0s
     0     0 -113935.72    0   52 -113188.16 -113935.72  0.66%     -    0s
     0     0 -113458.98    0   26 -113188.16 -113458.98  0.24%     -    0s
     0     0 -113443.43    0   24 -113188.16 -113443.43  0.23%     -    0s
     0     0 -113379.81    0   25 -113188.16 -113379.81  0.17%     -    0s
     0     0 -113373.68    0   23 -113188.16 -113373.68  0.16%     -    0s
     0     0 -113366.39    0   24 -113188.16 -113366.39  0.16%     -    0s
     0     0 -113291.75    0   10 -113188.16 -113291.75  0.09%     -    0s
     0     0 -113291.75    0   15 -113188.16 -113291.75  0.09%     -    0s
     0     0 -113231.86    0    9 -113188.16 -113231.86  0.04%     -    0s
H    0     0                    -113194.6865 -113231.86  0.03%     -    0s
     0     0 -113230.48    0    5 -113194.69 -113230.48  0.03%     -    0s
H    0     0                    -113225.3765 -113227.56  0.00%     -    0s
     0     0 -113227.56    0    4 -113225.38 -113227.56  0.00%     -    0s
     0     0 -113226.20    0    2 -113225.38 -113226.20  0.00%     -    0s
     0     0     cutoff    0      -113225.38 -113225.38  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 1
  MIR: 6
  Flow cover: 7

Explored 1 nodes (687 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -113225 -113195 -113188 ... -91050.4
No other solutions better than -113225

Optimal solution found (tolerance 1.00e-06)
Best objective -1.132253765018e+05, best bound -1.132253765018e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 88041.04
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113225.38
  [DEBUG]   S×d_nominal = 201266.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 201266.42 + -113225.38 = 88041.04
  [DEBUG]   Current θ from Master = 112933.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24892.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33040.31
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1862.9813, Absolute Gap = 1862.9813, Relative Gap = 0.228635
  Not converged yet (gap = 1862.98 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135239 nonzeros
Model fingerprint: 0xc2c1bbf9
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -33040.3 (0.02s)
Loaded MIP start from previous solve with objective -33040.3

Presolve removed 20361 rows and 8271 columns
Presolve time: 0.42s
Presolved: 26892 rows, 12709 columns, 165584 nonzeros
Variable types: 10450 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36374    1.0430949e+04   0.000000e+00   7.421450e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20516    1.2976113e+04   0.000000e+00   0.000000e+00      8s

Root relaxation: objective 1.297611e+04, 20516 iterations, 7.17 seconds (12.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 12976.1131    0  126 -33040.310 12976.1131   139%     -    7s
H    0     0                    -32187.98314 12976.1131   140%     -    7s
H    0     0                    -32166.11945 12976.1131   140%     -    7s
H    0     0                    -14202.66830 12976.1131   191%     -    8s
H    0     0                    -13347.62744 12976.1131   197%     -    8s
H    0     0                    -13289.81215 9550.42870   172%     -   10s
H    0     0                    -13256.32151 9550.42870   172%     -   10s
     0     0 9550.42870    0  430 -13256.322 9550.42870   172%     -   10s
H    0     0                    -11269.80023 9550.03935   185%     -   10s
H    0     0                    -11232.92988 9550.03935   185%     -   10s
H    0     0                    -11027.56861 9550.03935   187%     -   10s
H    0     0                    -10946.38683 9550.03935   187%     -   10s
     0     0 9320.13685    0  421 -10946.387 9320.13685   185%     -   11s
     0     0 9024.90312    0  424 -10946.387 9024.90312   182%     -   11s
     0     0 9024.75950    0  424 -10946.387 9024.75950   182%     -   12s
     0     0 6937.57242    0  528 -10946.387 6937.57242   163%     -   16s
H    0     0                    -9908.210027 6937.57242   170%     -   16s
H    0     0                    -9900.131876 6937.57242   170%     -   16s
     0     0 6331.20758    0  622 -9900.1319 6331.20758   164%     -   18s
     0     0 6268.15256    0  630 -9900.1319 6268.15256   163%     -   18s
     0     0 6246.66524    0  631 -9900.1319 6246.66524   163%     -   18s
     0     0 6233.71441    0  635 -9900.1319 6233.71441   163%     -   19s
     0     0 6232.92513    0  637 -9900.1319 6232.92513   163%     -   19s
     0     0 6232.78313    0  634 -9900.1319 6232.78313   163%     -   19s
H    0     0                    -9619.061144 4859.82242   151%     -   24s
H    0     0                    -9246.712140 4859.82242   153%     -   24s
H    0     0                    -9105.868760 4859.82242   153%     -   24s
H    0     0                    -8901.782090 4859.82242   155%     -   24s
     0     0 4859.82242    0  524 -8901.7821 4859.82242   155%     -   24s
H    0     0                    -8863.442485 4859.41459   155%     -   24s
     0     0 4529.88394    0  519 -8863.4425 4529.88394   151%     -   25s
     0     0 4428.42528    0  527 -8863.4425 4428.42528   150%     -   26s
     0     0 4406.49054    0  535 -8863.4425 4406.49054   150%     -   26s
     0     0 4402.59887    0  538 -8863.4425 4402.59887   150%     -   26s
     0     0 4398.12712    0  540 -8863.4425 4398.12712   150%     -   26s
     0     0 4398.06109    0  542 -8863.4425 4398.06109   150%     -   26s
H    0     0                    -8829.228311 4398.06109   150%     -   29s
     0     0 3891.17947    0  549 -8829.2283 3891.17947   144%     -   30s
     0     0 3741.24454    0  620 -8829.2283 3741.24454   142%     -   32s
     0     0 3703.50292    0  555 -8829.2283 3703.50292   142%     -   32s
     0     0 3696.35714    0  562 -8829.2283 3696.35714   142%     -   33s
     0     0 3693.75721    0  562 -8829.2283 3693.75721   142%     -   33s
     0     0 3692.60892    0  564 -8829.2283 3692.60892   142%     -   33s
     0     0 3592.76044    0  611 -8829.2283 3592.76044   141%     -   34s
     0     0 3560.59121    0  618 -8829.2283 3560.59121   140%     -   34s
     0     0 3546.84892    0  622 -8829.2283 3546.84892   140%     -   35s
     0     0 3543.59495    0  628 -8829.2283 3543.59495   140%     -   35s
     0     0 3539.32630    0  621 -8829.2283 3539.32630   140%     -   35s
     0     0 3535.33955    0  621 -8829.2283 3535.33955   140%     -   35s
     0     0 3534.75650    0  629 -8829.2283 3534.75650   140%     -   35s
     0     0 3466.53546    0  561 -8829.2283 3466.53546   139%     -   36s
H    0     0                    -8827.418387 3466.07383   139%     -   37s
     0     0 3442.21819    0  572 -8827.4184 3442.21819   139%     -   38s
     0     0 3433.35150    0  582 -8827.4184 3433.35150   139%     -   38s
     0     0 3429.57518    0  586 -8827.4184 3429.57518   139%     -   38s
     0     0 3429.33827    0  587 -8827.4184 3429.33827   139%     -   38s
     0     0 3358.12697    0  563 -8827.4184 3358.12697   138%     -   39s
     0     0 3349.99308    0  573 -8827.4184 3349.99308   138%     -   40s
     0     0 3346.14534    0  575 -8827.4184 3346.14534   138%     -   40s
     0     0 3345.13160    0  573 -8827.4184 3345.13160   138%     -   40s
     0     0 3328.24160    0  581 -8827.4184 3328.24160   138%     -   40s
H    0     0                    -8821.165490 3327.61601   138%     -   41s
     0     0 3314.98232    0  654 -8821.1655 3314.98232   138%     -   41s
     0     0 3310.64280    0  582 -8821.1655 3310.64280   138%     -   41s
     0     0 3309.65462    0  586 -8821.1655 3309.65462   138%     -   41s
     0     0 3289.61028    0  580 -8821.1655 3289.61028   137%     -   42s
     0     0 3285.43421    0  589 -8821.1655 3285.43421   137%     -   42s
     0     0 3283.81052    0  587 -8821.1655 3283.81052   137%     -   42s
     0     0 3282.96419    0  591 -8821.1655 3282.96419   137%     -   42s
     0     0 3272.72430    0  584 -8821.1655 3272.72430   137%     -   43s
     0     0 3269.30926    0  587 -8821.1655 3269.30926   137%     -   44s
     0     0 3267.49672    0  595 -8821.1655 3267.49672   137%     -   45s
     0     0 3266.81689    0  590 -8821.1655 3266.81689   137%     -   45s
     0     0 3263.27581    0  597 -8821.1655 3263.27581   137%     -   45s
     0     0 3262.51423    0  607 -8821.1655 3262.51423   137%     -   46s
     0     0 3261.06777    0  609 -8821.1655 3261.06777   137%     -   46s
     0     0 3260.56922    0  609 -8821.1655 3260.56922   137%     -   47s
     0     2 3260.56922    0  609 -8821.1655 3260.56922   137%     -   55s
     7    16 2738.56808    3  595 -8821.1655 2814.81605   132%  1221   60s
    31    64 2513.78956    5  706 -8821.1655 2667.52527   130%  1777   66s
   151   227 1821.68048    8  750 -8821.1655 2510.22485   128%  1264   72s
   230   282  679.37375    8  705 -8821.1655 2510.22485   128%  1067   75s
   365   330  -67.70292    9  481 -8821.1655 2256.87971   126%   995   82s
   422   373 1668.98831   10  759 -8821.1655 2256.87971   126%  1034   85s
   520   468  259.71816   11  668 -8821.1655 2256.87971   126%  1079   90s
   643   580 -1418.5495   13  619 -8821.1655 1878.35209   121%  1108   95s
   792   688 -4048.4442   15  595 -8821.1655 1878.35209   121%  1071  103s
   828   727 -3372.7138   15  594 -8821.1655 1878.35209   121%  1058  105s
   957   838 -4294.8435   18  520 -8821.1655 1878.35209   121%  1010  111s
  1103  1011 -5802.4862   20  353 -8821.1655 1532.62939   117%   982  115s
  1356  1196 -6065.4430   22  320 -8821.1655 1532.62939   117%   890  120s
  1632  1341 -455.38184   10  457 -8821.1655 1417.36424   116%   828  127s
  1800  1385 -3342.4856   12  309 -8821.1655 1417.36424   116%   805  132s
  1997  1489 -7783.7750   14  173 -8821.1655 1334.50764   115%   788  138s
  2092  1555 -8328.0235   15  139 -8821.1655 1203.25303   114%   780  141s
  2363  1698 -3970.4690   14  451 -8821.1655 1024.68237   112%   772  147s
  2517  1774 -6736.8442   16  423 -8821.1655 1024.68237   112%   768  151s
  2654  1869 -8687.7858   17  395 -8821.1655 1024.68237   112%   758  155s
  2991  2028 -975.00262   11  326 -8821.1655  827.79150   109%   747  164s
  3111  2145 -3306.0050   12  334 -8821.1655  827.79150   109%   737  167s
  3292  2306     cutoff   14      -8821.1655  827.79150   109%   730  171s
  3540  2431 -1717.3813   12  212 -8821.1655  827.79150   109%   716  175s
  4021  2575 -7986.3403   20  379 -8821.1655  678.54930   108%   699  181s
  4208  2665 -5400.3585   26  609 -8821.1655  660.00005   107%   697  217s
  4210  2666 -3991.0872   16  126 -8821.1655  660.00005   107%   697  226s
  4211  2667 -1220.8410   13  533 -8821.1655  660.00005   107%   697  230s
  4213  2668 -1002.0256   11  565 -8821.1655  660.00005   107%   697  236s
  4217  2671 -1951.5371   16  666 -8821.1655  660.00005   107%   696  240s
  4224  2676 -1603.9711   14  663 -8821.1655  660.00005   107%   695  245s
  4229  2679 -3293.7865   15  664 -8821.1655  660.00005   107%   694  251s
  4232  2681 -4088.1721   17  673 -8821.1655  660.00005   107%   693  255s
  4235  2683 -8399.2319   23  675 -8821.1655  660.00005   107%   693  260s
  4236  2684 -776.92194    8  675 -8821.1655  660.00005   107%   693  269s
  4237  2684 -1351.0581   10  675 -8821.1655  660.00005   107%   693  274s
  4238  2688  660.00005   14  378 -8821.1655  660.00005   107%   706  280s
  4244  2698 -976.96338   16  541 -8821.1655  660.00005   107%   707  288s
  4252  2711 -1423.7753   17  484 -8821.1655  660.00005   107%   710  295s
  4268  2731 -6175.3858   18  322 -8821.1655  403.94970   105%   726  301s
  4300  2748 -7901.8242   19  527 -8821.1655  218.43247   102%   734  305s
  4373  2790     cutoff   21      -8821.1655 -494.02966  94.4%   750  314s
  4442  2785 -871.50673   21  497 -8821.1655 -494.02966  94.4%   755  317s
  4525  2787 -1557.2398   22  458 -8821.1655 -494.02966  94.4%   761  322s
  4673  2800     cutoff   25      -8821.1655 -758.86447  91.4%   770  328s
  4751  2807 -2855.2627   27  262 -8821.1655 -776.11821  91.2%   770  331s
  4913  2806 -3611.9675   32   97 -8821.1655 -871.86954  90.1%   771  336s
  5004  2801 -4374.7586   36  137 -8821.1655 -871.86954  90.1%   768  340s
  5152  2791     cutoff   42      -8821.1655 -1263.9232  85.7%   773  347s
  5239  2789 -7316.2359   23  127 -8821.1655 -1263.9416  85.7%   773  351s
  5400  2784 -3355.1239   24  337 -8821.1655 -1421.3595  83.9%   777  357s
  5440  2792 -3481.8466   25  370 -8821.1655 -1429.4501  83.8%   778  361s
  5541  2790 -3884.2902   27  287 -8821.1655 -1429.4501  83.8%   779  367s
  5597  2789 -4019.8863   28  263 -8821.1655 -1429.4501  83.8%   780  370s
  5656  2788 -4428.1252   29  300 -8821.1655 -1998.8541  77.3%   780  376s
  5719  2773 -4598.1639   30  305 -8821.1655 -2018.1453  77.1%   780  381s
  5870  2798 -5833.3544   36  195 -8821.1655 -2018.1453  77.1%   782  387s
  5966  2794 -3641.3245   28  458 -8821.1655 -2018.1453  77.1%   783  392s
  6089  2793 -4291.9551   30  369 -8821.1655 -2166.5709  75.4%   782  396s
  6235  2780     cutoff   33      -8821.1655 -2209.1621  75.0%   780  400s
  6403  2739 -6212.5116   36  245 -8821.1655 -2392.9629  72.9%   777  405s
  6667  2713 -5657.0229   27  192 -8821.1655 -2525.0543  71.4%   780  414s
  6813  2679     cutoff   31      -8821.1655 -2745.3317  68.9%   783  419s
  6960  2661     cutoff   24      -8821.1655 -2815.9033  68.1%   782  424s
  7128  2660     cutoff   35      -8821.1655 -3045.3296  65.5%   783  430s
  7324  2617     cutoff   32      -8821.1655 -3128.1552  64.5%   783  437s
  7504  2582 -6444.6283   30  329 -8821.1655 -3195.1391  63.8%   785  443s
  7738  2506 -7827.9964   28  505 -8821.1655 -3502.0306  60.3%   784  448s
  7962  2409 infeasible   28      -8821.1655 -3791.1392  57.0%   784  453s
  8155  2334 -8102.3451   31  502 -8821.1655 -3872.5480  56.1%   783  458s
  8405  2288     cutoff   35      -8821.1655 -4139.6430  53.1%   779  464s
  8665  2186 -5981.0502   29  335 -8821.1655 -4246.2063  51.9%   777  471s
  8979  2078 -6272.0660   33  266 -8821.1655 -4336.1381  50.8%   773  478s
  9280  1889     cutoff   24      -8821.1655 -4560.7041  48.3%   771  484s
H 9398  1715                    -8803.038214 -4560.7041  48.2%   770  484s
  9588  1549 -7991.7302   25  428 -8803.0382 -4560.7041  48.2%   765  490s
  9980  1315 -8510.8858   30  420 -8803.0382 -5109.4665  42.0%   761  497s
 10383  1031     cutoff   26      -8803.0382 -5441.6192  38.2%   756  503s
 11079   961     cutoff   27      -8803.0382 -6075.2659  31.0%   732  511s
*11293   761              82    -8802.848545 -6075.2659  31.0%   722  511s
*11810   692              86    -8799.505568 -6075.2659  31.0%   700  511s
 11981  1456 -8049.7179   26  447 -8799.5056 -6075.2659  31.0%   695  515s
*12051  1456             112    -8692.468949 -6075.2659  30.1%   691  515s
*12099  1456             112    -8682.504525 -6445.3242  25.8%   689  515s
*12108  1456             115    -8651.091397 -6445.3242  25.5%   688  515s
*12439  1456              90    -8622.646263 -6652.0760  22.9%   671  515s
*13510  2855              81    -8602.338610 -7161.2138  16.8%   624  517s
H13545  2855                    -8571.886493 -7161.2138  16.5%   622  517s
*13588  2855              84    -8511.813498 -7161.2138  15.9%   621  517s
H13603  2855                    -8503.414152 -7161.2138  15.8%   620  517s
*15424  3009              93    -8499.162621 -7904.5596  7.00%   549  518s
*15491  3009              90    -8492.280949 -7904.5596  6.92%   547  518s
H15610  3009                    -8487.595950 -7904.5596  6.87%   543  518s
H17645  2758                    -8485.444050 -8287.8084  2.33%   483  519s
H19157  2729                    -8483.086722 -8316.6382  1.96%   446  519s
*19784  2729              81    -8463.519996 -8322.0547  1.67%   433  519s
 20223  2635     cutoff   56      -8463.5200 -8348.3058  1.36%   424  520s
*20509  2613              90    -8448.987672 -8348.3058  1.19%   418  520s
*28176   413              75    -8446.304885 -8428.1272  0.22%   309  522s

Cutting planes:
  MIR: 446
  Mixing: 1
  Flow cover: 1559
  Zero half: 10
  RLT: 14
  Relax-and-lift: 67

Explored 29963 nodes (8799430 simplex iterations) in 522.87 seconds (1308.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8446.3 -8448.99 -8463.52 ... -8511.81
No other solutions better than -8446.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.446304885021e+03, best bound -8.446304885021e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 522.89s
  Master Objective (UB) = -8446.30, θ = 108106.61
  Upper Bound (UB) = -8446.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 108106.61
  [DEBUG]   ✓ Scenario 0: θ = 108106.61 ≤ Q = 108106.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 108106.61 ≤ Q = 108106.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 108106.61 ≤ Q = 108106.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6f9d6cab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6f9d6cab
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.448600e+13
Presolve removed 2586 rows and 1880 columns
Presolve time: 0.00s
Presolved: 507 rows, 509 columns, 1429 nonzeros
Found heuristic solution: objective 8129235.5346
Variable types: 343 continuous, 166 integer (166 binary)

Root relaxation: objective -1.195364e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119536.44    0  131 8129235.53 -119536.44   101%     -    0s
H    0     0                    -83002.91883 -119536.44  44.0%     -    0s
H    0     0                    -84323.11710 -119536.44  41.8%     -    0s
H    0     0                    -96035.63427 -119536.44  24.5%     -    0s
H    0     0                    -96642.12338 -119536.44  23.7%     -    0s
H    0     0                    -98073.48415 -106794.53  8.89%     -    0s
H    0     0                    -99613.87940 -106794.53  7.21%     -    0s
H    0     0                    -103409.5635 -106794.53  3.27%     -    0s
     0     0 -106794.53    0  121 -103409.56 -106794.53  3.27%     -    0s
     0     0 -106676.08    0  123 -103409.56 -106676.08  3.16%     -    0s
     0     0 -106199.62    0  111 -103409.56 -106199.62  2.70%     -    0s
H    0     0                    -104557.9198 -106166.02  1.54%     -    0s
     0     0 -106166.02    0  112 -104557.92 -106166.02  1.54%     -    0s
     0     0 -106166.02    0  113 -104557.92 -106166.02  1.54%     -    0s
     0     0 -105812.56    0   93 -104557.92 -105812.56  1.20%     -    0s
     0     0 -105704.97    0   89 -104557.92 -105704.97  1.10%     -    0s
     0     0 -105677.89    0   91 -104557.92 -105677.89  1.07%     -    0s
     0     0 -105673.28    0   91 -104557.92 -105673.28  1.07%     -    0s
     0     0 -105494.87    0   92 -104557.92 -105494.87  0.90%     -    0s
     0     0 -105464.34    0   94 -104557.92 -105464.34  0.87%     -    0s
     0     0 -105463.95    0   94 -104557.92 -105463.95  0.87%     -    0s
     0     0 -105337.76    0   88 -104557.92 -105337.76  0.75%     -    0s
     0     0 -105318.69    0   91 -104557.92 -105318.69  0.73%     -    0s
     0     0 -105315.49    0   92 -104557.92 -105315.49  0.72%     -    0s
     0     0 -105271.74    0   87 -104557.92 -105271.74  0.68%     -    0s
     0     0 -105255.59    0   87 -104557.92 -105255.59  0.67%     -    0s
     0     2 -105255.59    0   87 -104557.92 -105255.59  0.67%     -    0s
H  515   182                    -104577.2184 -104897.60  0.31%   6.2    0s
* 1175   142              40    -104577.7301 -104794.10  0.21%   6.0    0s

Cutting planes:
  Gomory: 49
  Implied bound: 10
  MIR: 178
  Flow cover: 11
  RLT: 85
  BQP: 4

Explored 1669 nodes (10969 simplex iterations) in 0.22 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104578 -104558 -103410 ... 8.12924e+06
No other solutions better than -104578

Optimal solution found (tolerance 1.00e-06)
Best objective -1.045777301328e+05, best bound -1.045777301328e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 86001.59
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104577.73
  [DEBUG]   S×d_nominal = 190579.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 190579.32 + -104577.73 = 86001.59
  [DEBUG]   Current θ from Master = 108106.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22105.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30551.32
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1564.9497, Absolute Gap = 1564.9497, Relative Gap = 0.185282
  Not converged yet (gap = 1564.95 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178479 nonzeros
Model fingerprint: 0x7a6e497f
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -30551.3 (0.02s)
Loaded MIP start from previous solve with objective -30551.3

Presolve removed 27128 rows and 11018 columns
Presolve time: 0.56s
Presolved: 35415 rows, 16202 columns, 218999 nonzeros
Variable types: 13943 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35415 rows, 16202 columns, 218999 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   49439    7.3228496e+03   0.000000e+00   1.046805e+07      5s
   61232    1.0256018e+04   0.000000e+00   9.725042e+04     10s
Concurrent spin time: 0.24s

Solved with dual simplex

Root relaxation: objective 1.051664e+04, 28216 iterations, 9.55 seconds (18.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10516.6381    0  303 -30551.323 10516.6381   134%     -   10s
H    0     0                    -30494.85158 10516.6381   134%     -   10s
H    0     0                    -26818.36859 10516.6381   139%     -   11s
H    0     0                    -20160.17503 10516.6381   152%     -   11s
H    0     0                    -19408.94970 10516.6381   154%     -   11s
H    0     0                    -19407.54446 10516.6381   154%     -   11s
H    0     0                    -19404.79836 10516.6381   154%     -   11s
H    0     0                    -19402.29580 10516.6381   154%     -   11s
H    0     0                    -19401.96243 10516.6381   154%     -   11s
H    0     0                    -19383.53085 10516.6381   154%     -   11s
H    0     0                    -18002.97313 7602.34686   142%     -   15s
H    0     0                    -17625.55683 7602.34686   143%     -   15s
H    0     0                    -17619.78712 7602.34686   143%     -   15s
H    0     0                    -17228.11456 7602.34686   144%     -   15s
H    0     0                    -17223.07107 7602.34686   144%     -   15s
H    0     0                    -17218.27040 7602.34686   144%     -   15s
     0     0 7602.34686    0  419 -17218.270 7602.34686   144%     -   15s
     0     0 6886.74089    0  427 -17218.270 6886.74089   140%     -   17s
     0     0 6672.91776    0  429 -17218.270 6672.91776   139%     -   18s
     0     0 6623.27238    0  450 -17218.270 6623.27238   138%     -   19s
     0     0 6623.27238    0  451 -17218.270 6623.27238   138%     -   19s
     0     0 6623.23630    0  453 -17218.270 6623.23630   138%     -   19s
     0     0 4086.76252    0  581 -17218.270 4086.76252   124%     -   24s
H    0     0                    -15153.34118 4086.76252   127%     -   24s
     0     0 3857.78059    0  571 -15153.341 3857.78059   125%     -   26s
     0     0 3388.01435    0  578 -15153.341 3388.01435   122%     -   28s
     0     0 3360.02467    0  577 -15153.341 3360.02467   122%     -   29s
     0     0 3305.65228    0  583 -15153.341 3305.65228   122%     -   29s
     0     0 3300.17089    0  583 -15153.341 3300.17089   122%     -   30s
     0     0 3258.13584    0  581 -15153.341 3258.13584   122%     -   30s
     0     0 3248.74499    0  585 -15153.341 3248.74499   121%     -   30s
     0     0 3245.64041    0  577 -15153.341 3245.64041   121%     -   30s
     0     0 3243.49879    0  576 -15153.341 3243.49879   121%     -   31s
     0     0 3243.14257    0  575 -15153.341 3243.14257   121%     -   31s
H    0     0                    -15061.55514 3243.14257   122%     -   33s
H    0     0                    -14484.52656 3243.14257   122%     -   33s
H    0     0                    -14102.79159 3243.14257   123%     -   33s
H    0     0                    -13308.58567 3243.14257   124%     -   33s
     0     0 1994.44209    0  513 -13308.586 1994.44209   115%     -   36s
H    0     0                    -12798.05733 1992.47428   116%     -   36s
H    0     0                    -12680.46440 1992.47428   116%     -   36s
H    0     0                    -12641.56516 1992.47428   116%     -   36s
     0     0 1667.56044    0  588 -12641.565 1667.56044   113%     -   39s
     0     0 1562.62930    0  542 -12641.565 1562.62930   112%     -   41s
     0     0 1442.18258    0  516 -12641.565 1442.18258   111%     -   42s
     0     0 1424.88956    0  511 -12641.565 1424.88956   111%     -   43s
     0     0 1401.59362    0  567 -12641.565 1401.59362   111%     -   43s
     0     0 1399.10230    0  519 -12641.565 1399.10230   111%     -   43s
     0     0 1395.66934    0  523 -12641.565 1395.66934   111%     -   43s
     0     0 1394.43575    0  535 -12641.565 1394.43575   111%     -   43s
     0     0 1394.34482    0  529 -12641.565 1394.34482   111%     -   44s
H    0     0                    -12354.18197 1086.75344   109%     -   48s
     0     0 1086.75344    0  529 -12354.182 1086.75344   109%     -   48s
     0     0  972.94249    0  583 -12354.182  972.94249   108%     -   49s
H    0     0                    -11339.26680  910.47540   108%     -   50s
H    0     0                    -10906.19416  910.47540   108%     -   50s
H    0     0                    -10903.85421  910.47540   108%     -   50s
H    0     0                    -10881.29454  910.47540   108%     -   50s
     0     0  910.47540    0  537 -10881.295  910.47540   108%     -   50s
     0     0  884.86202    0  629 -10881.295  884.86202   108%     -   51s
     0     0  860.36131    0  545 -10881.295  860.36131   108%     -   52s
     0     0  852.78057    0  543 -10881.295  852.78057   108%     -   52s
     0     0  849.87146    0  550 -10881.295  849.87146   108%     -   52s
     0     0  848.34346    0  551 -10881.295  848.34346   108%     -   52s
     0     0  847.82927    0  550 -10881.295  847.82927   108%     -   52s
     0     0  799.71254    0  607 -10881.295  799.71254   107%     -   54s
H    0     0                    -10359.70713  798.23697   108%     -   54s
     0     0  781.95989    0  681 -10359.707  781.95989   108%     -   54s
     0     0  776.64171    0  628 -10359.707  776.64171   107%     -   55s
     0     0  774.96806    0  620 -10359.707  774.96806   107%     -   55s
     0     0  773.27336    0  625 -10359.707  773.27336   107%     -   55s
     0     0  772.77404    0  630 -10359.707  772.77404   107%     -   55s
H    0     0                    -9337.556818  645.39450   107%     -   57s
H    0     0                    -8917.889054  645.39450   107%     -   57s
     0     0  645.39450    0  564 -8917.8891  645.39450   107%     -   57s
H    0     0                    -8895.329391  644.69928   107%     -   58s
     0     0  625.11951    0  569 -8895.3294  625.11951   107%     -   59s
     0     0  620.60441    0  576 -8895.3294  620.60441   107%     -   59s
     0     0  617.92678    0  570 -8895.3294  617.92678   107%     -   59s
     0     0  616.80371    0  577 -8895.3294  616.80371   107%     -   59s
     0     0  572.81709    0  565 -8895.3294  572.81709   106%     -   61s
     0     0  553.80121    0  560 -8895.3294  553.80121   106%     -   61s
H    0     0                    -8829.228311  549.77535   106%     -   61s
     0     0  549.77535    0  570 -8829.2283  549.77535   106%     -   62s
     0     0  548.85281    0  575 -8829.2283  548.85281   106%     -   62s
     0     0  489.12235    0  555 -8829.2283  489.12235   106%     -   63s
H    0     0                    -8822.975414  488.35918   106%     -   63s
     0     0  476.83608    0  562 -8822.9754  476.83608   105%     -   64s
     0     0  472.81527    0  622 -8822.9754  472.81527   105%     -   64s
     0     0  472.34978    0  624 -8822.9754  472.34978   105%     -   64s
     0     0  450.62446    0  583 -8822.9754  450.62446   105%     -   65s
     0     0  445.66070    0  583 -8822.9754  445.66070   105%     -   66s
     0     0  444.97920    0  583 -8822.9754  444.97920   105%     -   66s
     0     0  422.09676    0  588 -8822.9754  422.09676   105%     -   67s
     0     0  408.32202    0  578 -8822.9754  408.32202   105%     -   70s
     0     0  405.03189    0  584 -8822.9754  405.03189   105%     -   70s
     0     0  404.45890    0  590 -8822.9754  404.45890   105%     -   70s
     0     0  342.92686    0  578 -8822.9754  342.92686   104%     -   72s
     0     0  336.40857    0  651 -8822.9754  336.40857   104%     -   72s
     0     0  334.39255    0  586 -8822.9754  334.39255   104%     -   72s
     0     0  333.45138    0  590 -8822.9754  333.45138   104%     -   73s
     0     0  318.67809    0  598 -8822.9754  318.67809   104%     -   74s
     0     0  313.98109    0  582 -8822.9754  313.98109   104%     -   74s
     0     0  311.73161    0  592 -8822.9754  311.73161   104%     -   74s
     0     0  310.89526    0  601 -8822.9754  310.89526   104%     -   74s
     0     0  306.29088    0  670 -8822.9754  306.29088   103%     -   75s
     0     0  304.24862    0  675 -8822.9754  304.24862   103%     -   76s
     0     0  303.23913    0  678 -8822.9754  303.23913   103%     -   76s
     0     0  296.44339    0  584 -8822.9754  296.44339   103%     -   77s
     0     0  292.43083    0  582 -8822.9754  292.43083   103%     -   77s
     0     0  291.82602    0  595 -8822.9754  291.82602   103%     -   77s
     0     0  290.23135    0  586 -8822.9754  290.23135   103%     -   78s
     0     0  289.76966    0  586 -8822.9754  289.76966   103%     -   79s
     0     2  289.76966    0  586 -8822.9754  289.76966   103%     -   92s
     3     8  156.55741    2  644 -8822.9754  215.20495   102%  1656   98s
     7    16   34.35322    3  687 -8822.9754  156.47541   102%  2690  102s
    15    32    0.26783    4  694 -8822.9754   33.98161   100%  3249  106s
    31    51 -6505.4244    5  212 -8822.9754   -3.32760   100%  3158  113s
    50    83 -2099.0758    6  473 -8822.9754   -3.32760   100%  4608  116s
    82   134 -2105.8191    7  388 -8822.9754   -3.32760   100%  3687  120s
   226   267 -4400.0093    8  190 -8822.9754   -3.32760   100%  2075  127s
   315   293 -2298.0727    9  509 -8822.9754   -3.32760   100%  1719  134s
   396   307 -2545.8381   10  518 -8822.9754   -3.32760   100%  1585  141s
   454   340 -7818.8815    9  157 -8822.9754   -3.32760   100%  1620  146s
   522   367 -2713.9987   10  470 -8822.9754   -3.32760   100%  1639  150s
   584   399 -4440.4874    9  183 -8822.9754   -3.32760   100%  1677  157s
   648   428 -3620.5966   12  381 -8822.9754   -3.32760   100%  1708  160s
   755   491 -4112.4114   13  368 -8822.9754 -294.63220  96.7%  1828  169s
   792   528 -4273.7177   13  361 -8822.9754 -294.63220  96.7%  1866  173s
   849   554 -3890.0315   11  331 -8822.9754 -294.63220  96.7%  1909  176s
   893   593 -4817.4153   14  359 -8822.9754 -294.63220  96.7%  1947  180s
   958   622 -5054.0825   13  473 -8822.9754 -294.63220  96.7%  1962  186s
  1011   651 -5059.1657   14  424 -8822.9754 -294.63220  96.7%  1997  190s
  1070   686 -8183.8708   15  212 -8822.9754 -294.63220  96.7%  1996  198s
  1137   734 -5332.9969   15  337 -8822.9754 -294.63220  96.7%  2039  204s
  1213   780 -5797.1766   16  285 -8822.9754 -1021.5023  88.4%  2050  208s
  1289   831 -6149.5534   16  331 -8822.9754 -1021.5023  88.4%  2052  214s
  1384   865 -6222.8286   17  254 -8822.9754 -1521.8718  82.8%  2057  221s
  1450   905     cutoff   18      -8822.9754 -1691.3353  80.8%  2066  227s
  1550   939 -7594.2672   23  277 -8822.9754 -1752.4177  80.1%  2054  232s
  1654   990 -8016.3638   26  132 -8822.9754 -1886.9162  78.6%  2073  239s
  1771  1047 -3306.1387   10  390 -8822.9754 -1886.9162  78.6%  2082  245s
  1883  1068 -4642.4365   12  377 -8822.9754 -1886.9162  78.6%  2097  250s
  1936  1100 -4979.1465   13  376 -8822.9754 -1920.0845  78.2%  2095  256s
  2022  1153 -5181.0829   14  362 -8822.9754 -2029.2521  77.0%  2097  262s
  2147  1209 -5232.3883   15  375 -8822.9754 -2079.5303  76.4%  2090  268s
  2294  1257 -5729.7242   19  422 -8822.9754 -2079.5303  76.4%  2065  274s
  2461  1360 -6505.1100   25  440 -8822.9754 -2079.5303  76.4%  2044  281s
  2621  1451 -8114.5344   30  347 -8822.9754 -2164.4127  75.5%  2039  288s
  2830  1552 -4948.1905   12  399 -8822.9754 -2164.4127  75.5%  2001  295s
  3031  1642 -8004.8286   17  183 -8822.9754 -2227.6008  74.8%  1981  300s
  3205  1748     cutoff   11      -8822.9754 -2248.1173  74.5%  1989  308s
  3410  1803     cutoff   12      -8822.9754 -2376.8543  73.1%  1972  314s
  3657  1886 -3831.7138    8  446 -8822.9754 -2376.8543  73.1%  1945  321s
  3849  1953 -5508.7330   15  350 -8822.9754 -2693.6400  69.5%  1954  329s
  3986  1975 -6272.3392   22  326 -8822.9754 -2718.9031  69.2%  1956  336s
  4028  2004 -6480.5253   23  268 -8822.9754 -2729.0728  69.1%  1965  342s
  4079  2022 -6567.2594   24  268 -8822.9754 -2729.0728  69.1%  1967  350s
  4151  2042 -7034.6939   25  306 -8822.9754 -2729.0728  69.1%  1968  358s
  4213  2077 -7135.2087   26  267 -8822.9754 -2729.0728  69.1%  1978  363s
  4310  2124     cutoff   12      -8822.9754 -2859.0924  67.6%  1966  371s
  4429  2217 -4286.2135    8  542 -8822.9754 -2989.4117  66.1%  1961  379s
  4643  2292 -5346.6576   12  517 -8822.9754 -3011.5094  65.9%  1949  387s
  4885  2403 -6707.7599   22  429 -8822.9754 -3159.9183  64.2%  1947  396s
  5160  2404 -5496.3508   12  586 -8822.9754 -3159.9183  64.2%  1933  455s
  5162  2405 -6408.0557   21  303 -8822.9754 -3159.9183  64.2%  1932  467s
  5163  2406 -5376.7806   12  618 -8822.9754 -3159.9183  64.2%  1931  478s
  5164  2407 -4132.0655   11  576 -8822.9754 -3159.9183  64.2%  1931  485s
  5166  2408 -6490.3131   23  626 -8822.9754 -3159.9183  64.2%  1930  492s
  5168  2409 -6149.2920   21  564 -8822.9754 -3159.9183  64.2%  1930  495s
  5172  2412 -4544.7620   22  656 -8822.9754 -3159.9183  64.2%  1928  501s
  5173  2413 -4342.6229   17  726 -8822.9754 -3159.9183  64.2%  1928  506s
  5176  2415 -4752.7248    9  634 -8822.9754 -3159.9183  64.2%  1927  512s
  5178  2416 -4052.8032   15  639 -8822.9754 -3159.9183  64.2%  1926  515s
  5181  2418 -7515.5965   16  646 -8822.9754 -3159.9183  64.2%  1925  520s
  5183  2419 -7821.4680   28  637 -8822.9754 -3159.9183  64.2%  1924  526s
  5184  2420 -8584.2736    9  656 -8822.9754 -3159.9183  64.2%  1924  531s
  5187  2422 -3777.7300   11  634 -8822.9754 -3159.9183  64.2%  1923  539s
  5188  2423 -6762.9217   24  634 -8822.9754 -3159.9183  64.2%  1922  551s
  5189  2423 -7217.6141   16  634 -8822.9754 -3159.9183  64.2%  1922  562s
  5190  2427 -3159.9183   11  682 -8822.9754 -3159.9183  64.2%  1944  571s
  5192  2430 -3159.9183   12  677 -8822.9754 -3159.9183  64.2%  1944  576s
  5196  2437 -3159.9183   13  667 -8822.9754 -3159.9183  64.2%  1947  583s
  5204  2448 -3159.9183   14  703 -8822.9754 -3159.9183  64.2%  1949  588s
  5220  2464 -3159.9183   15  769 -8822.9754 -3159.9183  64.2%  1969  600s
  5246  2477 -3159.9183   16  769 -8822.9754 -3159.9183  64.2%  1985  607s
  5278  2499 -3159.9183   17  768 -8822.9754 -3159.9183  64.2%  1996  618s
  5310  2527 -3159.9183   18  712 -8822.9754 -3159.9183  64.2%  1996  623s
  5357  2563 -3940.6541   18  503 -8822.9754 -3159.9183  64.2%  1994  630s
  5428  2575 -3159.9183   19  693 -8822.9754 -3159.9183  64.2%  1994  637s
  5508  2573 -4283.2812   19  704 -8822.9754 -3159.9183  64.2%  1998  645s
  5575  2583 -3159.9183   20  643 -8822.9754 -3159.9183  64.2%  2004  653s
  5647  2592 -3485.4336   21  723 -8822.9754 -3159.9183  64.2%  2015  658s
  5688  2601 -3664.8225   21  622 -8822.9754 -3159.9183  64.2%  2017  664s
  5761  2600 -5031.8063   22  710 -8822.9754 -3159.9183  64.2%  2015  670s
  5851  2590 -5030.4760   22  670 -8822.9754 -3159.9183  64.2%  2008  676s
  5939  2575 -6289.1871   23  652 -8822.9754 -3159.9183  64.2%  2000  683s
  5995  2585 -6028.8042   23  736 -8822.9754 -3250.5728  63.2%  1997  689s
  6070  2579 infeasible   24      -8822.9754 -3250.5728  63.2%  1992  695s
  6156  2589 -6973.3753   26  557 -8822.9754 -3303.6794  62.6%  1987  703s
  6241  2572 -7561.4282   26  599 -8822.9754 -3303.6794  62.6%  1981  711s
  6296  2579 -7146.0124   27  509 -8822.9754 -3453.9814  60.9%  1978  716s
  6392  2576     cutoff   28      -8822.9754 -3453.9814  60.9%  1967  723s
  6467  2573 -8778.7945   29  214 -8822.9754 -3544.0145  59.8%  1963  729s
  6583  2556     cutoff   30      -8822.9754 -3590.1513  59.3%  1953  737s
  6710  2524     cutoff   32      -8822.9754 -3590.1513  59.3%  1941  744s
  6758  2541     cutoff   33      -8822.9754 -3590.1513  59.3%  1937  751s
  6830  2540 -6092.9922   23  482 -8822.9754 -3590.1513  59.3%  1932  758s
  6950  2549     cutoff   25      -8822.9754 -3767.4113  57.3%  1920  766s
  7075  2550 -7727.6313   28  270 -8822.9754 -4068.6314  53.9%  1911  774s
  7203  2566 -5588.2975   17  512 -8822.9754 -4186.1185  52.6%  1908  783s
  7334  2571 -6164.0831   20  475 -8822.9754 -4268.2786  51.6%  1900  791s
  7479  2585 -6547.0761   23  422 -8822.9754 -4268.2786  51.6%  1891  800s
  7622  2587 -6832.9878   25  275 -8822.9754 -4281.0145  51.5%  1881  809s
  7816  2539 -7506.6960   29  483 -8822.9754 -4281.0145  51.5%  1864  818s
  7988  2513 -8723.7305   36  171 -8822.9754 -4572.9653  48.2%  1856  828s
  8161  2474 -7999.7837   22  231 -8822.9754 -4603.7656  47.8%  1849  836s
  8361  2402     cutoff   21      -8822.9754 -4732.4584  46.4%  1835  847s
  8557  2356 -7932.1316   22  544 -8822.9754 -4908.2284  44.4%  1827  857s
  8700  2347     cutoff   23      -8822.9754 -4908.2284  44.4%  1820  868s
  8904  2315     cutoff   26      -8822.9754 -4908.2284  44.4%  1814  878s
  9122  2273 -8168.0775   27  531 -8822.9754 -5299.0528  39.9%  1805  889s
  9363  2205 -8724.8272   20  188 -8822.9754 -5566.5967  36.9%  1793  899s
  9629  2104 -7905.9468   19  292 -8822.9754 -5699.3211  35.4%  1779  910s
  9937  1977 -7857.0098   25  367 -8822.9754 -5699.3211  35.4%  1758  922s
 10156  1907 -8593.2165   30  264 -8822.9754 -6123.6230  30.6%  1747  933s
 10484  1725 -8729.8471   25  265 -8822.9754 -6144.5606  30.4%  1724  944s
 10885  1491 -7863.9125   32  434 -8822.9754 -6365.0671  27.9%  1695  957s
 11338  1196 -8247.6622   36  309 -8822.9754 -6365.0671  27.9%  1661  972s
 11815   693 -7856.9460   32  435 -8822.9754 -6943.4531  21.3%  1628  983s
 12441   129 -8207.8112   30  580 -8822.9754 -7243.8116  17.9%  1577  994s
 13022     2     cutoff   28      -8822.9754 -7585.8132  14.0%  1528 1002s

Cutting planes:
  Learned: 2
  MIR: 548
  Flow cover: 1229
  Zero half: 8
  RLT: 20
  Relax-and-lift: 44

Explored 13209 nodes (20103649 simplex iterations) in 1002.85 seconds (2689.20 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8822.98 -8829.23 -8895.33 ... -11339.3
No other solutions better than -8822.98

Optimal solution found (tolerance 1.00e-06)
Best objective -8.822975414480e+03, best bound -8.822975414480e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1002.87s
  Master Objective (UB) = -8822.98, θ = 118742.27
  Upper Bound (UB) = -8822.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118742.27
  [DEBUG]   ✓ Scenario 0: θ = 118742.27 ≤ Q = 118742.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118742.27 ≤ Q = 118742.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118742.27 ≤ Q = 118742.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118742.27 ≤ Q = 118742.27 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4e40166b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4e40166b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.312391e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6961376.4863
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.231742e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123174.25    0  123 6961376.49 -123174.25   102%     -    0s
H    0     0                    -87675.76419 -123174.25  40.5%     -    0s
H    0     0                    -88921.95777 -123174.25  38.5%     -    0s
     0     0 -102825.79    0   83 -88921.958 -102825.79  15.6%     -    0s
H    0     0                    -100414.5251 -102806.45  2.38%     -    0s
     0     0 -102607.20    0   84 -100414.53 -102607.20  2.18%     -    0s
H    0     0                    -101140.4453 -102573.14  1.42%     -    0s
     0     0 -102573.14    0   84 -101140.45 -102573.14  1.42%     -    0s
     0     0 -102573.14    0   84 -101140.45 -102573.14  1.42%     -    0s
     0     0 -101971.38    0   68 -101140.45 -101971.38  0.82%     -    0s
H    0     0                    -101159.5325 -101860.23  0.69%     -    0s
     0     0 -101860.23    0   56 -101159.53 -101860.23  0.69%     -    0s
     0     0 -101849.12    0   62 -101159.53 -101849.12  0.68%     -    0s
     0     0 -101624.72    0   43 -101159.53 -101624.72  0.46%     -    0s
     0     0 -101492.73    0   47 -101159.53 -101492.73  0.33%     -    0s
     0     0 -101492.72    0   45 -101159.53 -101492.72  0.33%     -    0s
     0     0 -101488.05    0   48 -101159.53 -101488.05  0.32%     -    0s
H    0     0                    -101165.1213 -101488.05  0.32%     -    0s
     0     0 -101387.70    0   23 -101165.12 -101387.70  0.22%     -    0s
     0     0 -101373.46    0   23 -101165.12 -101373.46  0.21%     -    0s
     0     0 -101291.69    0   26 -101165.12 -101291.69  0.13%     -    0s
     0     0 -101269.81    0   14 -101165.12 -101269.81  0.10%     -    0s
     0     0 -101184.62    0    2 -101165.12 -101184.62  0.02%     -    0s
H    0     0                    -101175.4540 -101184.49  0.01%     -    0s
*    0     0               0    -101183.3141 -101183.31  0.00%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 5
  MIR: 2
  Flow cover: 3
  Relax-and-lift: 6

Explored 1 nodes (890 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -101183 -101175 -101165 ... 1.31239e+13
No other solutions better than -101183

Optimal solution found (tolerance 1.00e-06)
Best objective -1.011833140992e+05, best bound -1.011833140992e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 108792.20
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101183.31
  [DEBUG]   S×d_nominal = 209975.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209975.52 + -101183.31 = 108792.20
  [DEBUG]   Current θ from Master = 118742.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9950.07 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18773.04
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1188.2791, Absolute Gap = 1188.2791, Relative Gap = 0.134680
  Not converged yet (gap = 1188.28 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221719 nonzeros
Model fingerprint: 0x84906270
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33915 rows and 13775 columns
Presolve time: 0.71s
Presolved: 43918 rows, 19685 columns, 272354 nonzeros
Variable types: 17426 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43918 rows, 19685 columns, 272354 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27265    1.5531185e+02   0.000000e+00   3.752478e+06      5s
   37023    3.1138831e+03   0.000000e+00   5.287463e+05     10s
   45863    8.6317692e+03   0.000000e+00   1.712886e+06     15s
Concurrent spin time: 0.21s

Solved with dual simplex

Root relaxation: objective 1.051664e+04, 36678 iterations, 14.69 seconds (30.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10516.6381    0  303 -226690.33 10516.6381   105%     -   15s
H    0     0                    -211155.5873 10516.6381   105%     -   15s
H    0     0                    -152519.6491 10516.6381   107%     -   16s
H    0     0                    -127585.2245 10516.6381   108%     -   16s
H    0     0                    -126773.8515 10516.6381   108%     -   16s
H    0     0                    -126576.3263 10516.6381   108%     -   16s
H    0     0                    -126204.4884 10516.6381   108%     -   16s
H    0     0                    -125978.4613 10516.6381   108%     -   16s
H    0     0                    -124229.1324 10516.6381   108%     -   16s
H    0     0                    -124189.7070 10516.6381   108%     -   16s
H    0     0                    -123633.9618 10516.6381   109%     -   16s
H    0     0                    -123361.7181 10516.6381   109%     -   16s
H    0     0                    -123246.2255 10516.6381   109%     -   16s
H    0     0                    -123223.7012 10516.6381   109%     -   16s
H    0     0                    -123221.6448 10516.6381   109%     -   16s
H    0     0                    -67473.21620 10516.6381   116%     -   16s
H    0     0                    -67327.18705 10516.6381   116%     -   16s
H    0     0                    -18196.24125 10516.6381   158%     -   16s
H    0     0                    -15332.20483 10516.6381   169%     -   16s
H    0     0                    -14942.34937 10516.6381   170%     -   16s
H    0     0                    -14908.85874 10516.6381   171%     -   16s
H    0     0                    -14720.33400 10516.6381   171%     -   16s
H    0     0                    -9372.703270 7980.06698   185%     -   22s
H    0     0                    -9111.358914 7980.06698   188%     -   22s
H    0     0                    -9082.244588 7980.06698   188%     -   22s
H    0     0                    -9045.374233 7980.06698   188%     -   22s
H    0     0                    -8964.192459 7980.06698   189%     -   22s
     0     0 7980.06698    0  418 -8964.1925 7980.06698   189%     -   22s
     0     0 7593.42192    0  408 -8964.1925 7593.42192   185%     -   25s
     0     0 7546.82764    0  413 -8964.1925 7546.82764   184%     -   25s
     0     0 7176.64157    0  432 -8964.1925 7176.64157   180%     -   26s
     0     0 6933.89851    0  420 -8964.1925 6933.89851   177%     -   28s
     0     0 6927.23779    0  341 -8964.1925 6927.23779   177%     -   28s
     0     0 6927.23779    0  345 -8964.1925 6927.23779   177%     -   29s
     0     0 6927.23779    0  345 -8964.1925 6927.23779   177%     -   29s
     0     0 4110.85376    0  584 -8964.1925 4110.85376   146%     -   36s
H    0     0                    -8921.909924 4110.85376   146%     -   36s
     0     0 3629.45543    0  578 -8921.9099 3629.45543   141%     -   39s
     0     0 3124.15282    0  597 -8921.9099 3124.15282   135%     -   41s
     0     0 3082.09785    0  529 -8921.9099 3082.09785   135%     -   43s
     0     0 3005.71542    0  534 -8921.9099 3005.71542   134%     -   45s
     0     0 3002.16700    0  537 -8921.9099 3002.16700   134%     -   45s
     0     0 2995.51593    0  541 -8921.9099 2995.51593   134%     -   46s
     0     0 2995.49973    0  537 -8921.9099 2995.49973   134%     -   46s
     0     0 1485.95420    0  534 -8921.9099 1485.95420   117%     -   56s
     0     0 1175.82598    0  529 -8921.9099 1175.82598   113%     -   60s
     0     0 1059.07233    0  627 -8921.9099 1059.07233   112%     -   63s
     0     0  976.19983    0  558 -8921.9099  976.19983   111%     -   66s
     0     0  945.05978    0  549 -8921.9099  945.05978   111%     -   67s
     0     0  937.04787    0  555 -8921.9099  937.04787   111%     -   68s
     0     0  929.42653    0  555 -8921.9099  929.42653   110%     -   68s
     0     0  925.32198    0  565 -8921.9099  925.32198   110%     -   69s
     0     0  925.16287    0  562 -8921.9099  925.16287   110%     -   69s
H    0     0                    -8919.569968  925.16287   110%     -   71s
H    0     0                    -8911.270067  552.59054   106%     -   75s
H    0     0                    -8906.778228  552.59054   106%     -   75s
H    0     0                    -8900.545688  552.59054   106%     -   75s
     0     0  552.59054    0  631 -8900.5457  552.59054   106%     -   75s
     0     0  344.30257    0  640 -8900.5457  344.30257   104%     -   78s
     0     0  292.12073    0  620 -8900.5457  292.12073   103%     -   80s
     0     0  276.08330    0  631 -8900.5457  276.08330   103%     -   81s
     0     0  274.15734    0  632 -8900.5457  274.15734   103%     -   81s
     0     0  272.56304    0  626 -8900.5457  272.56304   103%     -   81s
     0     0  267.37090    0  635 -8900.5457  267.37090   103%     -   82s
     0     0  267.12661    0  641 -8900.5457  267.12661   103%     -   82s
     0     0  188.36659    0  564 -8900.5457  188.36659   102%     -   85s
     0     0  169.97892    0  553 -8900.5457  169.97892   102%     -   86s
     0     0  166.74557    0  562 -8900.5457  166.74557   102%     -   86s
     0     0  163.19110    0  572 -8900.5457  163.19110   102%     -   86s
     0     0  162.58636    0  565 -8900.5457  162.58636   102%     -   87s
     0     0   36.20190    0  636 -8900.5457   36.20190   100%     -   89s
     0     0   20.98891    0  572 -8900.5457   20.98891   100%     -   91s
     0     0   18.00311    0  577 -8900.5457   18.00311   100%     -   92s
     0     0   16.48907    0  582 -8900.5457   16.48907   100%     -   92s
     0     0   14.39734    0  584 -8900.5457   14.39734   100%     -   92s
     0     0   13.94203    0  588 -8900.5457   13.94203   100%     -   92s
     0     0   -5.54947    0  647 -8900.5457   -5.54947   100%     -   94s
     0     0  -11.43710    0  589 -8900.5457  -11.43710   100%     -   94s
     0     0  -12.63626    0  574 -8900.5457  -12.63626   100%     -   95s
     0     0  -29.77080    0  586 -8900.5457  -29.77080   100%     -   96s
     0     0  -36.22598    0  583 -8900.5457  -36.22598   100%     -   97s
     0     0  -38.72634    0  581 -8900.5457  -38.72634   100%     -   97s
     0     0  -40.50853    0  584 -8900.5457  -40.50853   100%     -   98s
     0     0  -40.74101    0  585 -8900.5457  -40.74101   100%     -   98s
     0     0  -53.37990    0  569 -8900.5457  -53.37990  99.4%     -  100s
     0     0  -56.31449    0  570 -8900.5457  -56.31449  99.4%     -  100s
     0     0  -57.83266    0  640 -8900.5457  -57.83266  99.4%     -  101s
     0     0  -58.40111    0  567 -8900.5457  -58.40111  99.3%     -  101s
     0     0  -72.33513    0  554 -8900.5457  -72.33513  99.2%     -  102s
     0     0  -75.11660    0  561 -8900.5457  -75.11660  99.2%     -  103s
     0     0  -76.91784    0  567 -8900.5457  -76.91784  99.1%     -  103s
     0     0  -77.70156    0  559 -8900.5457  -77.70156  99.1%     -  103s
     0     0  -84.67975    0  572 -8900.5457  -84.67975  99.0%     -  105s
     0     0  -94.97736    0  578 -8900.5457  -94.97736  98.9%     -  105s
     0     0  -95.40421    0  582 -8900.5457  -95.40421  98.9%     -  105s
     0     0  -97.13002    0  584 -8900.5457  -97.13002  98.9%     -  106s
     0     0  -97.47800    0  573 -8900.5457  -97.47800  98.9%     -  109s
     0     0 -103.34780    0  583 -8900.5457 -103.34780  98.8%     -  110s
     0     0 -103.76351    0  583 -8900.5457 -103.76351  98.8%     -  111s
     0     2 -103.83922    0  583 -8900.5457 -103.83922  98.8%     -  130s
     3     8 -229.92242    2  569 -8900.5457 -185.76364  97.9%  2051  138s
     7    16 -590.41075    3  650 -8900.5457 -232.89616  97.4%  4553  142s
    15    32 -833.36694    4  636 -8900.5457 -610.08616  93.1%  4022  146s
    31    54 -2338.3417    5  516 -8900.5457 -834.17822  90.6%  5698  157s
    53    86 -3126.2776    6  361 -8900.5457 -834.49291  90.6%  5972  162s
    85   189 -3181.9705    7  355 -8900.5457 -834.49291  90.6%  4668  171s
   205   245 -3353.6220   10  346 -8900.5457 -834.49291  90.6%  2715  179s
   290   286 -3338.6879   10  335 -8900.5457 -834.49291  90.6%  2338  185s
   368   338 -3417.2766   11  329 -8900.5457 -834.49291  90.6%  2312  190s
   447   374 -3613.2883   13  415 -8900.5457 -834.49291  90.6%  2197  197s
   518   402 -4197.9444   14  402 -8900.5457 -1018.0665  88.6%  2138  201s
   554   437 -4513.4478   14  388 -8900.5457 -1018.0665  88.6%  2131  206s
   596   465 -5157.8445   14  311 -8900.5457 -1018.0665  88.6%  2141  211s
   632   501 -4733.9932   15  306 -8900.5457 -1018.0665  88.6%  2111  215s
   680   529 -5855.5709   15  307 -8900.5457 -1018.0665  88.6%  2071  221s
   736   558 -4780.5819   16  299 -8900.5457 -1018.0665  88.6%  2040  226s
   787   593 -4960.0132   17  386 -8900.5457 -1018.0665  88.6%  2021  232s
   846   633 -8316.0869   16  154 -8900.5457 -1018.0665  88.6%  1992  239s
   898   677 -5318.7726   18  364 -8900.5457 -1208.2133  86.4%  1981  246s
   968   722 -4862.2482   17  306 -8900.5457 -1208.2133  86.4%  1965  252s
  1037   780 -5086.9651   18  374 -8900.5457 -1385.7841  84.4%  1960  257s
  1117   825 -5521.3442   18  394 -8900.5457 -1385.7841  84.4%  1921  265s
  1214   872 -5122.8828   19  294 -8900.5457 -1421.5489  84.0%  1871  272s
  1314   917 -5513.1915   19  362 -8900.5457 -1424.7585  84.0%  1840  279s
  1408   974 -5913.1249   22  277 -8900.5457 -1456.8051  83.6%  1830  286s
  1504  1045 -7204.8084   23  120 -8900.5457 -1456.8051  83.6%  1836  293s
  1609  1112 -7168.3884   23  346 -8900.5457 -1456.8051  83.6%  1835  300s
  1721  1208 -7215.1068   24  115 -8900.5457 -1456.8051  83.6%  1815  308s
  1868  1285 -7517.8650   26  344 -8900.5457 -1456.8051  83.6%  1773  316s
  1989  1343 -8105.7398   30  474 -8900.5457 -1456.8051  83.6%  1752  324s
  2080  1432 -7860.7151   29  334 -8900.5457 -1456.8051  83.6%  1738  329s
  2209  1517     cutoff   30      -8900.5457 -1456.8051  83.6%  1706  338s
  2388  1637 -8313.4686   32  399 -8900.5457 -1456.8051  83.6%  1676  345s
  2611  1786 -4013.5727   10  408 -8900.5457 -1795.2623  79.8%  1623  351s
  2830  1936 -5258.1807   13  440 -8900.5457 -1799.4266  79.8%  1577  360s
  3079  1964     cutoff   17      -8900.5457 -1799.4266  79.8%  1531  370s
  3223  2062 -6553.4584   18  285 -8900.5457 -2390.1684  73.1%  1515  378s
  3386  2151 -7614.4084   23  175 -8900.5457 -2402.2396  73.0%  1511  388s
  3547  2237 -8655.7432   29  249 -8900.5457 -2402.2396  73.0%  1511  400s
  3742  2336 -8267.7728   10  163 -8900.5457 -2559.8256  71.2%  1513  408s
  3911  2454 -4251.4699   14  466 -8900.5457 -2586.4868  70.9%  1524  419s
  4085  2455 -7655.1239   23  583 -8900.5457 -2701.9846  69.6%  1531  452s
  4087  2456 -7456.9416   35  303 -8900.5457 -2701.9846  69.6%  1530  473s
  4088  2457 -6476.2579   24  567 -8900.5457 -2701.9846  69.6%  1529  487s
  4089  2458 -6117.5062   19  643 -8900.5457 -2701.9846  69.6%  1529  499s
  4090  2458 -4956.7964   14  597 -8900.5457 -2701.9846  69.6%  1529  506s
  4091  2459 -6948.5768   16  614 -8900.5457 -2701.9846  69.6%  1528  510s
  4095  2462 -6679.3089   20  647 -8900.5457 -2701.9846  69.6%  1527  516s
  4096  2462 -8549.5309   44  703 -8900.5457 -2701.9846  69.6%  1527  521s
  4099  2464 -8076.8579   40  641 -8900.5457 -2701.9846  69.6%  1525  526s
  4101  2466 -7523.9151   42  663 -8900.5457 -2701.9846  69.6%  1525  532s
  4102  2466 -8475.5220   39  639 -8900.5457 -2701.9846  69.6%  1524  536s
  4104  2468 -7311.5026   24  592 -8900.5457 -2701.9846  69.6%  1524  540s
  4106  2469 -8473.1441   38  711 -8900.5457 -2701.9846  69.6%  1523  545s
  4108  2470 -6273.8842   25  594 -8900.5457 -2701.9846  69.6%  1522  552s
  4109  2471 -7462.8046   39  736 -8900.5457 -2701.9846  69.6%  1522  555s
  4111  2472 -5227.0945   21  671 -8900.5457 -2701.9846  69.6%  1521  561s
  4113  2474 -7749.6981   22  681 -8900.5457 -2701.9846  69.6%  1520  599s
  4114  2474 -7316.4335   31  681 -8900.5457 -2701.9846  69.6%  1520  614s
  4115  2478 -2701.9846   14  664 -8900.5457 -2701.9846  69.6%  1556  620s
  4117  2481 -2701.9846   15  676 -8900.5457 -2701.9846  69.6%  1558  625s
  4121  2488 -2701.9846   16  674 -8900.5457 -2701.9846  69.6%  1561  631s
  4129  2499 -2701.9846   17  692 -8900.5457 -2701.9846  69.6%  1565  639s
  4145  2509 -8384.6801   18  141 -8900.5457 -2701.9846  69.6%  1596  654s
  4163  2526 -2701.9846   19  637 -8900.5457 -2701.9846  69.6%  1620  661s
  4195  2557 -2701.9846   20  564 -8900.5457 -2701.9846  69.6%  1626  672s
  4290  2544 -2701.9846   22  567 -8900.5457 -2701.9846  69.6%  1631  685s
  4380  2519 -3544.5078   24  553 -8900.5457 -2701.9846  69.6%  1637  694s
  4437  2519 -3911.3138   25  507 -8900.5457 -2701.9846  69.6%  1647  701s
  4498  2512 -4131.0051   26  593 -8900.5457 -2701.9846  69.6%  1658  708s
  4542  2528 -4194.5736   27  593 -8900.5457 -2701.9846  69.6%  1672  713s
  4590  2546 -4325.1181   28  583 -8900.5457 -2701.9846  69.6%  1673  722s
  4652  2534 -4382.0400   29  593 -8900.5457 -2701.9846  69.6%  1671  730s
  4700  2545 -4590.0148   30  515 -8900.5457 -2701.9846  69.6%  1680  737s
  4746  2565 -4906.6750   31  420 -8900.5457 -2701.9846  69.6%  1690  745s
  4793  2573 -4987.5371   32  434 -8900.5457 -2701.9846  69.6%  1693  753s
  4851  2575 -5706.3395   33  339 -8900.5457 -2701.9846  69.6%  1702  760s
  4886  2591 -7738.1111   34  316 -8900.5457 -2701.9846  69.6%  1705  769s
  4932  2587 -7768.7169   35  310 -8900.5457 -2701.9846  69.6%  1709  777s
  4991  2591 -7774.6801   36  305 -8900.5457 -2701.9846  69.6%  1708  784s
  5034  2594     cutoff   37      -8900.5457 -2701.9846  69.6%  1720  794s
  5098  2592     cutoff   37      -8900.5457 -2701.9846  69.6%  1728  801s
  5173  2583     cutoff   36      -8900.5457 -2701.9846  69.6%  1729  810s
  5249  2578 -6352.5197   25  676 -8900.5457 -2701.9846  69.6%  1735  819s
  5311  2597 -7049.0095   26  694 -8900.5457 -2932.8244  67.0%  1738  827s
  5389  2606 -7049.4853   27  695 -8900.5457 -2933.3079  67.0%  1742  838s
  5486  2616 -7132.4385   28  692 -8900.5457 -2933.3079  67.0%  1743  846s
  5578  2603 -7135.0483   29  639 -8900.5457 -2933.3079  67.0%  1744  856s
  5673  2603 -7380.6839   30  651 -8900.5457 -2933.3079  67.0%  1747  866s
  5779  2588     cutoff   32      -8900.5457 -2933.3079  67.0%  1755  876s
  5892  2570     cutoff   31      -8900.5457 -3542.3101  60.2%  1758  887s
  6004  2571 -7051.1610   24  460 -8900.5457 -3542.3101  60.2%  1769  898s
  6097  2568 -8054.2073   26  330 -8900.5457 -3542.3101  60.2%  1784  909s
  6211  2561 -8616.3719   29  313 -8900.5457 -3547.1769  60.1%  1792  920s
  6354  2526 -8439.1091   28  325 -8900.5457 -3547.1769  60.1%  1798  928s
  6402  2534 -8556.8652   29  322 -8900.5457 -4258.8290  52.2%  1804  939s
  6515  2492 -7787.0512   31  473 -8900.5457 -4359.9511  51.0%  1804  952s
  6661  2472 -8588.3112   34  273 -8900.5457 -4419.4655  50.3%  1803  963s
  6799  2460 -6971.6308   27  327 -8900.5457 -4511.3159  49.3%  1813  976s
  6973  2417 -8077.7692   30  462 -8900.5457 -4657.5158  47.7%  1814  990s
  7158  2367     cutoff   34      -8900.5457 -4715.2390  47.0%  1815 1002s
  7204  2352     cutoff   34      -8900.5457 -4918.8823  44.7%  1819 1012s
  7267  2335     cutoff   34      -8900.5457 -4939.5170  44.5%  1822 1022s
  7358  2296     cutoff   27      -8900.5457 -5055.6150  43.2%  1827 1036s
  7489  2253 -7533.2085   35  370 -8900.5457 -5073.8964  43.0%  1834 1052s
  7685  2168 -8609.4975   40  307 -8900.5457 -5073.8964  43.0%  1836 1068s
  7856  2124 -7691.5636   29  377 -8900.5457 -5378.6169  39.6%  1842 1084s
  8091  2025 -8741.1089   36  261 -8900.5457 -5828.3139  34.5%  1846 1099s
  8347  1927 -8174.0161   29  371 -8900.5457 -6077.7627  31.7%  1849 1116s
  8661  1774 -7655.3138   27  404 -8900.5457 -6319.6360  29.0%  1839 1134s
  8993  1612     cutoff   38      -8900.5457 -6662.4612  25.1%  1830 1150s
  9263  1403     cutoff   42      -8900.5457 -6684.2433  24.9%  1821 1168s
  9683  1035 infeasible   35      -8900.5457 -6995.2612  21.4%  1797 1185s
 10210   495     cutoff   29      -8900.5457 -7353.1928  17.4%  1759 1200s

Cutting planes:
  Learned: 2
  Gomory: 1
  MIR: 560
  Mixing: 1
  Flow cover: 1337
  Zero half: 9
  RLT: 19
  Relax-and-lift: 72

Explored 10847 nodes (18513133 simplex iterations) in 1203.59 seconds (3249.67 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8900.55 -8906.78 -8911.27 ... -9372.7
No other solutions better than -8900.55

Optimal solution found (tolerance 1.00e-06)
Best objective -8.900545687825e+03, best bound -8.900545687825e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1203.66s
  Master Objective (UB) = -8900.55, θ = 118138.07
  Upper Bound (UB) = -8900.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118138.07
  [DEBUG]   ✓ Scenario 0: θ = 118138.07 ≤ Q = 118138.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118138.07 ≤ Q = 118138.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118138.07 ≤ Q = 118138.07 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118138.07 ≤ Q = 118138.07 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118138.07 ≤ Q = 118138.07 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x389a1c79
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc765e387
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.307725e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6924454.4207
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.231205e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123120.46    0  123 6924454.42 -123120.46   102%     -    0s
H    0     0                    -87675.24809 -123120.46  40.4%     -    0s
H    0     0                    -88994.38245 -123120.46  38.3%     -    0s
     0     0 -95625.905    0   86 -88994.382 -95625.905  7.45%     -    0s
H    0     0                    -92321.37793 -95603.737  3.56%     -    0s
     0     0 -95365.467    0   87 -92321.378 -95365.467  3.30%     -    0s
     0     0 -95318.571    0   87 -92321.378 -95318.571  3.25%     -    0s
     0     0 -95305.057    0   87 -92321.378 -95305.057  3.23%     -    0s
H    0     0                    -93540.18691 -95305.057  1.89%     -    0s
H    0     0                    -93651.50719 -95305.057  1.77%     -    0s
     0     0 -95094.100    0   89 -93651.507 -95094.100  1.54%     -    0s
H    0     0                    -93662.04717 -95054.406  1.49%     -    0s
     0     0 -95054.406    0   89 -93662.047 -95054.406  1.49%     -    0s
     0     0 -94927.791    0   91 -93662.047 -94927.791  1.35%     -    0s
     0     0 -94895.825    0   91 -93662.047 -94895.825  1.32%     -    0s
H    0     0                    -93719.23764 -94884.265  1.24%     -    0s
     0     2 -94884.265    0   91 -93719.238 -94884.265  1.24%     -    0s
H   29    16                    -94404.99399 -94646.235  0.26%  13.1    0s

Cutting planes:
  Gomory: 17
  MIR: 148

Explored 86 nodes (1160 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -94405 -93719.2 -93662 ... 1.30772e+13
No other solutions better than -94405

Optimal solution found (tolerance 1.00e-06)
Best objective -9.440499399066e+04, best bound -9.440499399066e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 114973.32
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94404.99
  [DEBUG]   S×d_nominal = 209378.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209378.32 + -94404.99 = 114973.32
  [DEBUG]   Current θ from Master = 118138.07
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3164.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12065.29
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1110.7089, Absolute Gap = 1110.7089, Relative Gap = 0.124791
  Not converged yet (gap = 1110.71 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264959 nonzeros
Model fingerprint: 0x25209ebf
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40722 rows and 16542 columns
Presolve time: 0.84s
Presolved: 52401 rows, 23158 columns, 325649 nonzeros
Variable types: 20899 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 52401 rows, 23158 columns, 325649 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28139   -1.2649691e+04   0.000000e+00   6.187925e+06      5s
   39106   -7.1594417e+02   0.000000e+00   5.838572e+06     10s
   47297    2.6781052e+03   0.000000e+00   9.187937e+05     15s
   55366    6.9732819e+03   0.000000e+00   3.888864e+05     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.030074e+04, 40409 iterations, 19.55 seconds (39.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10300.7430    0  323 -226690.33 10300.7430   105%     -   20s
H    0     0                    -215363.9660 10300.7430   105%     -   20s
H    0     0                    -105645.2498 10300.7430   110%     -   21s
H    0     0                    -105524.5856 10300.7430   110%     -   21s
H    0     0                    -61367.85730 10300.7430   117%     -   21s
H    0     0                    -24542.03661 10300.7430   142%     -   21s
H    0     0                    -19126.07216 10300.7430   154%     -   21s
H    0     0                    -15876.39835 10300.7430   165%     -   21s
H    0     0                    -14840.84781 10300.7430   169%     -   21s
H    0     0                    -14822.60785 10300.7430   169%     -   22s
H    0     0                    -14802.50820 10300.7430   170%     -   22s
     0     0 6703.37285    0  438 -14802.508 6703.37285   145%     -   30s
H    0     0                    -9613.836110 6703.14615   170%     -   30s
H    0     0                    -9389.382926 6703.14615   171%     -   30s
H    0     0                    -9070.675448 6703.14615   174%     -   30s
     0     0 6396.19499    0  456 -9070.6754 6396.19499   171%     -   32s
     0     0 6329.04587    0  445 -9070.6754 6329.04587   170%     -   34s
     0     0 6154.23974    0  444 -9070.6754 6154.23974   168%     -   35s
     0     0 6142.67393    0  443 -9070.6754 6142.67393   168%     -   36s
     0     0 6137.05726    0  448 -9070.6754 6137.05726   168%     -   36s
     0     0 6137.05726    0  449 -9070.6754 6137.05726   168%     -   37s
     0     0 6137.05726    0  458 -9070.6754 6137.05726   168%     -   37s
     0     0 6137.05726    0  456 -9070.6754 6137.05726   168%     -   38s
     0     0 6137.04671    0  454 -9070.6754 6137.04671   168%     -   39s
     0     0 3537.07633    0  521 -9070.6754 3537.07633   139%     -   50s
     0     0 3219.21445    0  571 -9070.6754 3219.21445   135%     -   54s
     0     0 3113.66934    0  577 -9070.6754 3113.66934   134%     -   56s
     0     0 3041.05942    0  589 -9070.6754 3041.05942   134%     -   57s
     0     0 3033.00728    0  598 -9070.6754 3033.00728   133%     -   58s
     0     0 3031.73749    0  594 -9070.6754 3031.73749   133%     -   58s
     0     0 3007.99735    0  589 -9070.6754 3007.99735   133%     -   59s
     0     0 2983.77515    0  585 -9070.6754 2983.77515   133%     -   60s
     0     0 2981.76089    0  592 -9070.6754 2981.76089   133%     -   60s
     0     0 2981.71626    0  592 -9070.6754 2981.71626   133%     -   60s
H    0     0                    -9041.233060 2981.71626   133%     -   64s
     0     0 1955.04480    0  514 -9041.2331 1955.04480   122%     -   72s
H    0     0                    -9028.392914 1691.96561   119%     -   77s
H    0     0                    -9019.800061 1691.96561   119%     -   77s
     0     0 1691.96561    0  500 -9019.8001 1691.96561   119%     -   77s
     0     0 1496.66896    0  525 -9019.8001 1496.66896   117%     -   82s
     0     0 1460.46942    0  537 -9019.8001 1460.46942   116%     -   83s
     0     0 1453.40712    0  529 -9019.8001 1453.40712   116%     -   84s
     0     0 1452.32643    0  533 -9019.8001 1452.32643   116%     -   84s
     0     0 1439.08204    0  516 -9019.8001 1439.08204   116%     -   85s
     0     0 1436.87474    0  514 -9019.8001 1436.87474   116%     -   86s
     0     0 1436.77845    0  521 -9019.8001 1436.77845   116%     -   86s
     0     0 1086.61403    0  590 -9019.8001 1086.61403   112%     -   96s
     0     0  967.56173    0  531 -9019.8001  967.56173   111%     -  100s
     0     0  947.85657    0  536 -9019.8001  947.85657   111%     -  101s
     0     0  943.28586    0  536 -9019.8001  943.28586   110%     -  102s
     0     0  915.22281    0  539 -9019.8001  915.22281   110%     -  103s
     0     0  910.62100    0  545 -9019.8001  910.62100   110%     -  103s
H    0     0                    -8996.610569  901.78747   110%     -  104s
     0     0  901.78747    0  547 -8996.6106  901.78747   110%     -  104s
     0     0  897.18526    0  542 -8996.6106  897.18526   110%     -  105s
     0     0  891.44841    0  544 -8996.6106  891.44841   110%     -  106s
H    0     0                    -8974.050906  890.69764   110%     -  106s
     0     0  890.69764    0  548 -8974.0509  890.69764   110%     -  106s
     0     0  774.85735    0  532 -8974.0509  774.85735   109%     -  110s
     0     0  752.88609    0  531 -8974.0509  752.88609   108%     -  111s
     0     0  744.11150    0  538 -8974.0509  744.11150   108%     -  112s
H    0     0                    -8967.798010  735.23940   108%     -  113s
     0     0  735.23940    0  626 -8967.7980  735.23940   108%     -  113s
     0     0  728.93760    0  540 -8967.7980  728.93760   108%     -  114s
     0     0  727.79293    0  541 -8967.7980  727.79293   108%     -  114s
     0     0  670.61805    0  520 -8967.7980  670.61805   107%     -  117s
     0     0  656.70635    0  545 -8967.7980  656.70635   107%     -  120s
     0     0  650.97721    0  552 -8967.7980  650.97721   107%     -  120s
     0     0  649.47196    0  547 -8967.7980  649.47196   107%     -  121s
     0     0  648.39699    0  557 -8967.7980  648.39699   107%     -  121s
     0     0  627.19860    0  546 -8967.7980  627.19860   107%     -  123s
     0     0  617.33645    0  553 -8967.7980  617.33645   107%     -  125s
     0     0  614.72075    0  561 -8967.7980  614.72075   107%     -  125s
     0     0  614.41889    0  559 -8967.7980  614.41889   107%     -  126s
     0     0  556.22920    0  556 -8967.7980  556.22920   106%     -  130s
H    0     0                    -8958.340621  555.92547   106%     -  133s
H    0     0                    -8906.778228  555.92547   106%     -  134s
     0     0  527.47768    0  559 -8906.7782  527.47768   106%     -  135s
     0     0  522.74027    0  559 -8906.7782  522.74027   106%     -  135s
     0     0  522.14581    0  571 -8906.7782  522.14581   106%     -  136s
     0     0  379.77307    0  562 -8906.7782  379.77307   104%     -  140s
     0     0  372.18566    0  585 -8906.7782  372.18566   104%     -  141s
     0     0  369.20916    0  585 -8906.7782  369.20916   104%     -  142s
     0     0  364.41594    0  585 -8906.7782  364.41594   104%     -  143s
     0     0  363.47112    0  573 -8906.7782  363.47112   104%     -  143s
H    0     0                    -8905.017171  333.32519   104%     -  145s
     0     0  333.32519    0  651 -8905.0172  333.32519   104%     -  145s
     0     0  326.61062    0  655 -8905.0172  326.61062   104%     -  146s
     0     0  324.75336    0  578 -8905.0172  324.75336   104%     -  146s
     0     0  324.14682    0  577 -8905.0172  324.14682   104%     -  147s
     0     0  295.13384    0  655 -8905.0172  295.13384   103%     -  149s
     0     0  289.04766    0  581 -8905.0172  289.04766   103%     -  150s
     0     0  285.32494    0  578 -8905.0172  285.32494   103%     -  151s
     0     0  283.88173    0  653 -8905.0172  283.88173   103%     -  151s
     0     0  283.64108    0  652 -8905.0172  283.64108   103%     -  152s
     0     0  266.97693    0  593 -8905.0172  266.97693   103%     -  153s
     0     0  265.13786    0  589 -8905.0172  265.13786   103%     -  154s
     0     0  264.82380    0  592 -8905.0172  264.82380   103%     -  154s
     0     0  264.20346    0  591 -8905.0172  264.20346   103%     -  155s
     0     0  263.98225    0  591 -8905.0172  263.98225   103%     -  156s
     0     0  262.92026    0  588 -8905.0172  262.92026   103%     -  156s
     0     0  262.69083    0  588 -8905.0172  262.69083   103%     -  157s
     0     0  262.66806    0  586 -8905.0172  262.66806   103%     -  157s
     0     0  262.43469    0  586 -8905.0172  262.43469   103%     -  159s
     0     2  262.43469    0  586 -8905.0172  262.43469   103%     -  183s
     1     4  200.44038    1  577 -8905.0172  261.71243   103%  1543  186s
     3     8  171.26221    2  571 -8905.0172  200.06534   102%  2553  191s
     7    16   39.46911    3  702 -8905.0172  170.69140   102%  4102  199s
    15    32 -165.68136    4  631 -8905.0172   38.01999   100%  5345  204s
    31    49 -4495.2441    5  211 -8905.0172 -166.26179  98.1%  5550  219s
    48    81 -1901.2130    6  549 -8905.0172 -166.43647  98.1%  8226  232s
    80   225 -2062.2823    7  530 -8905.0172 -166.43647  98.1%  6096  244s
   224   257 -2211.1241   12  575 -8905.0172 -166.43647  98.1%  3446  250s
   256   291 -2257.9274   11  497 -8905.0172 -166.43647  98.1%  3303  260s
   301   320 -3657.3393   10  363 -8905.0172 -166.43647  98.1%  3248  268s
   335   347 -2898.3639   12  470 -8905.0172 -166.43647  98.1%  3182  276s
   380   372 -3175.0221   12  486 -8905.0172 -166.43647  98.1%  3008  283s
   416   402 -2282.5433   13  578 -8905.0172 -166.43647  98.1%  2939  291s
   461   429 -6533.3463   13  228 -8905.0172 -166.43647  98.1%  2835  299s
   500   454 -3514.1643   13  372 -8905.0172 -166.43647  98.1%  2723  307s
   550   492 -5288.6924   13  464 -8905.0172 -166.43647  98.1%  2680  315s
   602   512 -3765.0256   14  389 -8905.0172 -166.43647  98.1%  2592  323s
   659   523 -7018.3075   14  303 -8905.0172 -166.43647  98.1%  2532  331s
   725   531 -3812.1261   15  330 -8905.0172 -166.43647  98.1%  2435  339s
   789   540 -4151.1279   16  317 -8905.0172 -537.33820  94.0%  2415  347s
   836   559 -4548.0621   17  378 -8905.0172 -537.33820  94.0%  2530  354s
   881   590     cutoff   15      -8905.0172 -537.33820  94.0%  2613  362s
   941   619 -4714.6284   19  432 -8905.0172 -537.33820  94.0%  2670  369s
  1012   658 -4727.2734   20  417 -8905.0172 -537.33820  94.0%  2706  377s
  1073   704 -4784.8137   21  326 -8905.0172 -537.33820  94.0%  2764  384s
  1147   736 -5717.3442   22  228 -8905.0172 -537.33820  94.0%  2776  393s
  1219   783 -8176.3227   21  142 -8905.0172 -537.33820  94.0%  2797  403s
  1290   826     cutoff   22      -8905.0172 -636.84003  92.8%  2865  413s
  1395   875 -6144.0807   23  245 -8905.0172 -636.86263  92.8%  2829  421s
  1486   923 -6433.6121   24  263 -8905.0172 -636.86263  92.8%  2810  429s
  1578   962 -8271.1743   24  141 -8905.0172 -636.86263  92.8%  2825  438s
  1669  1012     cutoff   24      -8905.0172 -909.59296  89.8%  2854  446s
  1765  1038 -6633.3550   26  236 -8905.0172 -909.59296  89.8%  2876  457s
  1813  1090 -6751.2370   27  372 -8905.0172 -909.59296  89.8%  2926  467s
  1891  1134 -7165.9497   28  370 -8905.0172 -1095.4394  87.7%  2980  478s
  2001  1181 -7260.0199   28  305 -8905.0172 -1095.4394  87.7%  2983  488s
  2114  1237 -7531.3153   29  329 -8905.0172 -1095.4394  87.7%  3006  498s
  2212  1304     cutoff   29      -8905.0172 -1095.4394  87.7%  3063  510s
  2333  1371 -7464.5924   30  313 -8905.0172 -1095.4394  87.7%  3093  521s
  2498  1447 infeasible   30      -8905.0172 -1095.4394  87.7%  3068  533s
  2683  1510 -8124.2646   32  181 -8905.0172 -1095.4394  87.7%  3040  545s
  2871  1542     cutoff   13      -8905.0172 -1651.8672  81.5%  3014  558s
  2983  1597 -4816.1532    8  277 -8905.0172 -1904.5774  78.6%  3049  571s
  3149  1669 -6311.3455    9  270 -8905.0172 -1904.5774  78.6%  3052  584s
  3303  1730 -5999.7996   10  142 -8905.0172 -1904.5774  78.6%  3085  598s
  3495  1823 -6895.1168   11  114 -8905.0172 -2084.9855  76.6%  3096  611s
  3718  1871     cutoff   21      -8905.0172 -2084.9855  76.6%  3091  623s
  3858  1968 -5066.8977    8  189 -8905.0172 -2084.9855  76.6%  3095  637s
  4111  2073 -4278.7246   10  246 -8905.0172 -2095.2164  76.5%  3087  652s
  4394  2181 -6524.7839   14  286 -8905.0172 -2095.2164  76.5%  3068  668s
  4653  2306 -7935.3566   20  359 -8905.0172 -2211.5730  75.2%  3032  683s
  4955  2307 -7799.7718   20  586 -8905.0172 -2399.9996  73.0%  3010  796s
  4957  2308 -4710.1607   12  323 -8905.0172 -2399.9996  73.0%  3008  824s
  4958  2309 -5104.6369   14  537 -8905.0172 -2399.9996  73.0%  3008  842s
  4959  2310 -3352.6130   10  613 -8905.0172 -2399.9996  73.0%  3007  853s
  4960  2310 -5410.4870   13  528 -8905.0172 -2399.9996  73.0%  3007  859s
  4961  2311 -8466.1215   26  523 -8905.0172 -2399.9996  73.0%  3006  866s
  4962  2312 -7734.0286   18  673 -8905.0172 -2399.9996  73.0%  3005  873s
  4963  2312 -4885.9966   11  532 -8905.0172 -2399.9996  73.0%  3005  877s
  4964  2313 -6121.7228   17  552 -8905.0172 -2399.9996  73.0%  3004  880s
  4967  2315 -4187.4568   13  573 -8905.0172 -2399.9996  73.0%  3002  885s
  4970  2317 -5774.7770   20  565 -8905.0172 -2399.9996  73.0%  3001  896s
  4972  2318 -5296.4510   16  563 -8905.0172 -2399.9996  73.0%  2999  900s
  4975  2320 -4872.6484   11  702 -8905.0172 -2399.9996  73.0%  2998  911s
  4977  2322 -4753.6019   12  641 -8905.0172 -2399.9996  73.0%  2996  915s
  4980  2324 -8175.6996   34  660 -8905.0172 -2399.9996  73.0%  2995  925s
  4983  2326 -6575.7766   25  724 -8905.0172 -2399.9996  73.0%  2993  931s
  4984  2326 -5065.7779   20  662 -8905.0172 -2399.9996  73.0%  2992  936s
  4986  2328 -7720.6941   17  675 -8905.0172 -2399.9996  73.0%  2991  942s
  4987  2328 -6276.4028   14  664 -8905.0172 -2399.9996  73.0%  2990  950s
  4989  2330 -7133.2695   19  678 -8905.0172 -2399.9996  73.0%  2989  958s
  4990  2330 -5550.8465   14  677 -8905.0172 -2399.9996  73.0%  2989  961s
  4991  2331 -8126.2953   13  685 -8905.0172 -2399.9996  73.0%  2988  965s
  4992  2332 -6313.4685   20  685 -8905.0172 -2399.9996  73.0%  2987  994s
  4993  2332 -8163.0053   19  685 -8905.0172 -2399.9996  73.0%  2987 1014s
  4994  2336 -2399.9996   10  658 -8905.0172 -2399.9996  73.0%  3026 1024s
  4996  2339 -2399.9996   11  630 -8905.0172 -2399.9996  73.0%  3026 1032s
  5000  2346 -2399.9996   12  661 -8905.0172 -2399.9996  73.0%  3029 1043s
  5008  2355 -2399.9996   13  666 -8905.0172 -2399.9996  73.0%  3035 1056s
  5024  2359     cutoff   14      -8905.0172 -2399.9996  73.0%  3055 1075s
  5039  2378 -4554.7785   15  293 -8905.0172 -2399.9996  73.0%  3078 1117s
  5069  2440 -4919.9163   16  299 -8905.0172 -2399.9996  73.0%  3114 1133s
  5176  2448 -6072.6931   18  292 -8905.0172 -2399.9996  73.0%  3145 1142s
  5263  2438 -7683.6785   21  260 -8905.0172 -2399.9996  73.0%  3161 1152s
  5301  2435 -7909.6259   22  266 -8905.0172 -2399.9996  73.0%  3162 1163s
  5341  2428 infeasible   21      -8905.0172 -2399.9996  73.0%  3159 1173s
  5392  2417     cutoff   20      -8905.0172 -2399.9996  73.0%  3172 1184s
  5440  2406 -7321.0690   19  259 -8905.0172 -2399.9996  73.0%  3181 1194s
  5492  2396     cutoff   20      -8905.0172 -2399.9996  73.0%  3203 1204s
  5544  2403 -8855.4644   21  241 -8905.0172 -2399.9996  73.0%  3218 1214s
  5582  2416     cutoff   22      -8905.0172 -2399.9996  73.0%  3223 1222s
  5617  2419 -7958.6831   20  238 -8905.0172 -2399.9996  73.0%  3232 1228s
  5660  2416 -8836.5394   21  245 -8905.0172 -2399.9996  73.0%  3228 1240s
  5708  2412     cutoff   22      -8905.0172 -2399.9996  73.0%  3224 1249s
  5764  2421 -7599.3109   18  272 -8905.0172 -2399.9996  73.0%  3229 1259s
  5823  2433 -8813.6137   19  340 -8905.0172 -2399.9996  73.0%  3234 1271s
  5891  2420 infeasible   20      -8905.0172 -2399.9996  73.0%  3223 1281s
  5969  2436 -5760.8655   15  619 -8905.0172 -2399.9996  73.0%  3221 1292s
  6037  2435 -6910.0356   17  326 -8905.0172 -2399.9996  73.0%  3220 1302s
  6135  2427 -6033.3949   16  541 -8905.0172 -2399.9996  73.0%  3206 1326s
  6234  2418 -6189.3113   17  547 -8905.0172 -2399.9996  73.0%  3197 1338s
  6331  2414 -6189.3141   18  542 -8905.0172 -2399.9996  73.0%  3200 1350s
  6415  2420 -7399.6301   23  289 -8905.0172 -2399.9996  73.0%  3207 1362s
  6513  2403     cutoff   26      -8905.0172 -2399.9996  73.0%  3209 1375s
  6627  2396     cutoff   29      -8905.0172 -2786.2835  68.7%  3205 1388s
  6719  2369 -6734.7704   19  592 -8905.0172 -2786.2835  68.7%  3220 1401s
  6832  2353 -8064.9206   20  441 -8905.0172 -2786.2835  68.7%  3231 1413s
  6940  2342 -7933.6530   20  296 -8905.0172 -2865.9648  67.8%  3240 1426s
  7077  2303 -8677.1824   16  347 -8905.0172 -2865.9648  67.8%  3240 1439s
  7140  2306     cutoff   17      -8905.0172 -4168.0378  53.2%  3251 1453s
  7219  2294     cutoff   26      -8905.0172 -4283.1314  51.9%  3257 1467s
  7325  2271 -8668.8030   23  337 -8905.0172 -4283.1314  51.9%  3257 1481s
  7431  2212     cutoff   23      -8905.0172 -4545.2369  49.0%  3254 1495s
  7562  2181 -6514.5835   21  535 -8905.0172 -5033.4930  43.5%  3259 1511s
  7706  2139 -7908.1909   26  209 -8905.0172 -5280.8379  40.7%  3266 1528s
  7894  2069 -6259.0940   29  273 -8905.0172 -5352.9280  39.9%  3265 1545s
  8040  2020 -8282.2673   35  229 -8905.0172 -5352.9280  39.9%  3274 1563s
  8192  1955 -8597.4306   20  321 -8905.0172 -5365.9238  39.7%  3290 1582s
  8408  1873 infeasible   20      -8905.0172 -5880.1763  34.0%  3282 1600s
  8661  1728 -8476.9581   25  492 -8905.0172 -6032.8561  32.3%  3270 1619s
  8937  1513 infeasible   28      -8905.0172 -6434.2264  27.7%  3257 1637s
  9265  1261 -8766.1151   36  314 -8905.0172 -6649.9973  25.3%  3225 1656s
  9570   920 -8593.3147   26  157 -8905.0172 -6913.8545  22.4%  3181 1672s
  9995   665     cutoff   29      -8905.0172 -7298.3575  18.0%  3100 1683s

Cutting planes:
  MIR: 604
  Flow cover: 1443
  Zero half: 11
  RLT: 25
  Relax-and-lift: 92

Explored 10189 nodes (31356898 simplex iterations) in 1683.22 seconds (4572.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8905.02 -8906.78 -8958.34 ... -9070.68
No other solutions better than -8905.02

Optimal solution found (tolerance 1.00e-06)
Best objective -8.905017171015e+03, best bound -8.905017171015e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1683.24s
  Master Objective (UB) = -8905.02, θ = 118532.35
  Upper Bound (UB) = -8905.02

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118532.35
  [DEBUG]   ✓ Scenario 0: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118532.35 ≤ Q = 118532.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118532.35 ≤ Q = 118532.35 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5f1fb872
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5f1fb872
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.311291e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6939907.1923
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.234589e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123458.89    0  123 6939907.19 -123458.89   102%     -    0s
H    0     0                    -87946.16375 -123458.89  40.4%     -    0s
H    0     0                    -89145.37128 -123458.89  38.5%     -    0s
     0     0 -95396.094    0   46 -89145.371 -95396.094  7.01%     -    0s
H    0     0                    -93384.74267 -95371.805  2.13%     -    0s
H    0     0                    -93696.47155 -95371.805  1.79%     -    0s
H    0     0                    -93900.71592 -95371.805  1.57%     -    0s
H    0     0                    -94212.44480 -95371.805  1.23%     -    0s
     0     0 -95249.952    0   44 -94212.445 -95249.952  1.10%     -    0s
     0     0 -95227.389    0   44 -94212.445 -95227.389  1.08%     -    0s
H    0     0                    -94227.68064 -95227.389  1.06%     -    0s
     0     2 -95227.389    0   44 -94227.681 -95227.389  1.06%     -    0s
H    4     7                    -94270.39399 -95210.944  1.00%   4.5    0s
H  229    95                    -94288.88554 -94828.320  0.57%   4.0    0s
H  473   219                    -94304.54225 -94828.320  0.56%   4.0    0s
H  478   219                    -94315.09769 -94828.320  0.54%   4.0    0s
H  578   219                    -94333.77440 -94828.320  0.52%   3.7    0s

Cutting planes:
  Gomory: 16
  Implied bound: 11
  MIR: 141

Explored 4195 nodes (15034 simplex iterations) in 0.17 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -94333.8 -94315.1 -94304.5 ... -87946.2
No other solutions better than -94333.8

Optimal solution found (tolerance 1.00e-06)
Best objective -9.433377439760e+04, best bound -9.433377439760e+04, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 115641.74
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94333.77
  [DEBUG]   S×d_nominal = 209975.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209975.52 + -94333.77 = 115641.74
  [DEBUG]   Current θ from Master = 118532.35
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2890.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11795.62
  Lower Bound (LB) = -10011.25
  Gap (UB-LB) = 1106.2374, Absolute Gap = 1106.2374, Relative Gap = 0.124226
  Not converged yet (gap = 1106.24 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308199 nonzeros
Model fingerprint: 0x221b0b32
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47509 rows and 19299 columns
Presolve time: 1.01s
Presolved: 60904 rows, 26641 columns, 379004 nonzeros
Variable types: 24382 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60904 rows, 26641 columns, 379004 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28893   -3.0816997e+04   0.000000e+00   1.205077e+08      5s
   39575   -1.8238491e+03   0.000000e+00   4.379806e+06     10s
   46887    1.3203703e+03   0.000000e+00   2.035328e+06     15s
   53918    6.0564150e+03   0.000000e+00   3.036382e+07     20s
   60029    6.8724021e+03   0.000000e+00   2.261186e+06     25s
   66375    7.3525158e+03   0.000000e+00   4.084607e+05     30s
   72272    7.5433943e+03   0.000000e+00   4.115565e+06     35s
   79118    9.8590179e+03   0.000000e+00   1.410760e+06     40s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.027470e+04, 57501 iterations, 39.72 seconds (77.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10274.7043    0  327 -226690.33 10274.7043   105%     -   41s
H    0     0                    -217296.4619 10274.7043   105%     -   41s
H    0     0                    -89498.04001 10274.7043   111%     -   41s
H    0     0                    -89140.96715 10274.7043   112%     -   41s
H    0     0                    -89125.67224 10274.7043   112%     -   41s
H    0     0                    -67837.96553 10274.7043   115%     -   41s
H    0     0                    -15785.84855 10274.7043   165%     -   41s
H    0     0                    -14802.50820 10274.7043   169%     -   41s
H    0     0                    -9366.678081 6418.90183   169%     -   54s
H    0     0                    -9196.206547 6418.90183   170%     -   54s
H    0     0                    -9140.052924 6418.90183   170%     -   54s
H    0     0                    -9093.235112 6418.90183   171%     -   54s
     0     0 6415.62551    0  443 -9093.2351 6415.62551   171%     -   54s
     0     0 6043.23644    0  456 -9093.2351 6043.23644   166%     -   59s
     0     0 6026.19651    0  455 -9093.2351 6026.19651   166%     -   59s
     0     0 5995.92599    0  450 -9093.2351 5995.92599   166%     -   60s
     0     0 5995.92599    0  454 -9093.2351 5995.92599   166%     -   61s
     0     0 5995.92599    0  452 -9093.2351 5995.92599   166%     -   61s
     0     0 3759.92489    0  586 -9093.2351 3759.92489   141%     -   74s
     0     0 3347.02433    0  580 -9093.2351 3347.02433   137%     -   79s
     0     0 3306.51476    0  587 -9093.2351 3306.51476   136%     -   81s
     0     0 3211.15536    0  588 -9093.2351 3211.15536   135%     -   84s
     0     0 3102.49218    0  582 -9093.2351 3102.49218   134%     -   86s
     0     0 3034.62012    0  577 -9093.2351 3034.62012   133%     -   87s
     0     0 3019.48884    0  583 -9093.2351 3019.48884   133%     -   88s
     0     0 3009.06929    0  584 -9093.2351 3009.06929   133%     -   89s
     0     0 2994.61633    0  575 -9093.2351 2994.61633   133%     -   89s
     0     0 2967.80425    0  582 -9093.2351 2967.80425   133%     -   90s
     0     0 2962.49252    0  584 -9093.2351 2962.49252   133%     -   91s
     0     0 2962.08902    0  584 -9093.2351 2962.08902   133%     -   91s
H    0     0                    -9090.895155 1914.63556   121%     -  101s
     0     0 1914.63556    0  410 -9090.8952 1914.63556   121%     -  101s
H    0     0                    -9042.359725 1549.17625   117%     -  105s
     0     0 1549.17625    0  491 -9042.3597 1549.17625   117%     -  105s
     0     0 1468.18343    0  488 -9042.3597 1468.18343   116%     -  107s
     0     0 1446.33462    0  441 -9042.3597 1446.33462   116%     -  108s
     0     0 1403.70959    0  437 -9042.3597 1403.70959   116%     -  110s
     0     0 1390.36649    0  436 -9042.3597 1390.36649   115%     -  111s
     0     0 1324.89679    0  487 -9042.3597 1324.89679   115%     -  113s
     0     0 1310.07573    0  429 -9042.3597 1310.07573   114%     -  114s
     0     0 1305.68317    0  492 -9042.3597 1305.68317   114%     -  114s
     0     0 1305.20106    0  435 -9042.3597 1305.20106   114%     -  115s
     0     0  936.26701    0  511 -9042.3597  936.26701   110%     -  122s
H    0     0                    -8990.357673  935.65705   110%     -  122s
     0     0  806.33932    0  454 -8990.3577  806.33932   109%     -  126s
     0     0  704.18114    0  519 -8990.3577  704.18114   108%     -  129s
     0     0  655.91619    0  535 -8990.3577  655.91619   107%     -  131s
     0     0  623.55871    0  521 -8990.3577  623.55871   107%     -  132s
     0     0  598.45516    0  541 -8990.3577  598.45516   107%     -  133s
     0     0  588.18199    0  549 -8990.3577  588.18199   107%     -  134s
     0     0  582.81214    0  545 -8990.3577  582.81214   106%     -  134s
     0     0  580.59661    0  546 -8990.3577  580.59661   106%     -  135s
     0     0  579.79716    0  544 -8990.3577  579.79716   106%     -  135s
     0     0  461.51941    0  619 -8990.3577  461.51941   105%     -  139s
     0     0  421.83331    0  618 -8990.3577  421.83331   105%     -  142s
     0     0  407.49961    0  561 -8990.3577  407.49961   105%     -  144s
     0     0  400.76061    0  565 -8990.3577  400.76061   104%     -  144s
     0     0  399.90902    0  565 -8990.3577  399.90902   104%     -  144s
     0     0  287.50826    0  689 -8990.3577  287.50826   103%     -  148s
     0     0  276.72443    0  554 -8990.3577  276.72443   103%     -  151s
     0     0  275.04405    0  553 -8990.3577  275.04405   103%     -  151s
     0     0  274.54925    0  564 -8990.3577  274.54925   103%     -  152s
     0     0  165.75991    0  650 -8990.3577  165.75991   102%     -  156s
     0     0  148.39196    0  655 -8990.3577  148.39196   102%     -  157s
     0     0  136.29278    0  579 -8990.3577  136.29278   102%     -  158s
     0     0  132.92180    0  656 -8990.3577  132.92180   101%     -  159s
     0     0  132.32771    0  585 -8990.3577  132.32771   101%     -  159s
     0     0  102.15236    0  661 -8990.3577  102.15236   101%     -  162s
     0     0   96.01447    0  669 -8990.3577   96.01447   101%     -  163s
     0     0   95.03866    0  666 -8990.3577   95.03866   101%     -  164s
     0     0   77.91342    0  606 -8990.3577   77.91342   101%     -  165s
     0     0   74.99704    0  607 -8990.3577   74.99704   101%     -  166s
     0     0   74.52505    0  609 -8990.3577   74.52505   101%     -  166s
     0     0   60.79179    0  599 -8990.3577   60.79179   101%     -  168s
     0     0   60.23047    0  603 -8990.3577   60.23047   101%     -  169s
     0     0   53.68969    0  608 -8990.3577   53.68969   101%     -  170s
     0     0   52.52052    0  610 -8990.3577   52.52052   101%     -  171s
     0     0   47.79268    0  611 -8990.3577   47.79268   101%     -  172s
     0     0   47.27232    0  623 -8990.3577   47.27232   101%     -  176s
     0     0   38.71338    0  615 -8990.3577   38.71338   100%     -  179s
     0     0   38.61198    0  615 -8990.3577   38.61198   100%     -  181s
     0     2   38.12455    0  615 -8990.3577   38.12455   100%     -  217s
     1     4  -66.76407    1  582 -8990.3577   37.14702   100%  1860  220s
     3     7 -333.32197    2  596 -8990.3577  -68.85308  99.2%  4103  226s
     6    14 -508.37987    3  601 -8990.3577  -86.13593  99.0%  5279  234s
    13    28 -607.77904    4  598 -8990.3577 -510.58768  94.3%  5929  245s
    27    46 -3819.2936    5  272 -8990.3577 -607.88524  93.2%  7894  378s
    45    78 -4327.3273    6  263 -8990.3577 -607.88524  93.2%  8558  386s
    77   188 -4672.9269    7  264 -8990.3577 -607.88524  93.2%  6365  400s
   187   260 -5578.3806   11  209 -8990.3577 -607.88524  93.2%  3501  409s
   269   319 -6593.8936   14  199 -8990.3577 -607.88524  93.2%  2845  417s
   357   350 -8171.4847   16  197 -8990.3577 -607.88524  93.2%  2595  425s
   421   370 -8193.5493   17  202 -8990.3577 -607.88524  93.2%  2537  433s
   500   394 infeasible   19      -8990.3577 -607.88524  93.2%  2453  442s
   560   430 -7658.1174   10  223 -8990.3577 -607.88524  93.2%  2695  450s
   616   467 -8331.3773   12  164 -8990.3577 -607.88524  93.2%  2714  457s
   673   491 -8965.5847   16  159 -8990.3577 -607.88524  93.2%  2670  465s
   729   518 infeasible   16      -8990.3577 -607.88524  93.2%  2674  473s
   796   548 -6189.5754   13  302 -8990.3577 -607.88524  93.2%  2656  481s
   855   576 -6695.3424   14  295 -8990.3577 -607.88524  93.2%  2624  489s
   922   604 -8713.3018   16  206 -8990.3577 -607.88524  93.2%  2591  495s
  1006   650 -8307.9697   17  189 -8990.3577 -607.88524  93.2%  2545  507s
  1064   686 -8392.1418   18  185 -8990.3577 -825.72370  90.8%  2518  515s
  1130   723 infeasible   19      -8990.3577 -825.72370  90.8%  2487  525s
  1193   763     cutoff   16      -8990.3577 -825.72370  90.8%  2478  534s
  1279   771 -5764.6702   15  490 -8990.3577 -825.72370  90.8%  2438  543s
  1369   793 -7338.1032   16  491 -8990.3577 -825.72370  90.8%  2407  553s
  1447   834 -7542.5735   17  358 -8990.3577 -825.72370  90.8%  2399  564s
  1548   880 -7987.3834   19  370 -8990.3577 -826.98096  90.8%  2371  575s
  1651   902 -8981.1438   21  308 -8990.3577 -826.98096  90.8%  2343  587s
  1756   952 -5298.0594    9  386 -8990.3577 -826.98096  90.8%  2323  599s
  1872   968 -5452.2517   10  375 -8990.3577 -1122.1948  87.5%  2300  608s
  1915  1028 -5919.0265   11  389 -8990.3577 -1122.1948  87.5%  2313  618s
  1995  1084 -6535.1181   12  325 -8990.3577 -1122.1948  87.5%  2309  629s
  2106  1167 infeasible   13      -8990.3577 -1839.5288  79.5%  2284  639s
  2233  1259 -8021.4666   17  325 -8990.3577 -1839.5288  79.5%  2241  651s
  2386  1315 infeasible   25      -8990.3577 -1940.9481  78.4%  2192  663s
  2527  1369 -4664.2769   13  406 -8990.3577 -1940.9481  78.4%  2161  676s
  2686  1444 -5195.3144   15  461 -8990.3577 -1940.9481  78.4%  2131  689s
  2858  1519 -6815.2019   18  279 -8990.3577 -2443.9185  72.8%  2091  703s
  3037  1553 -7884.7651   21  194 -8990.3577 -2443.9185  72.8%  2052  715s
  3130  1639 infeasible   24      -8990.3577 -2500.4582  72.2%  2060  729s
  3299  1688 -5070.9239   11  391 -8990.3577 -2500.4582  72.2%  2042  746s
  3482  1793 -7506.2830   15  250 -8990.3577 -2828.1166  68.5%  2031  763s
  3696  1855 -7105.9169   14  476 -8990.3577 -2828.1166  68.5%  2022  780s
  3888  1895 -7491.5600   15  438 -8990.3577 -2828.1166  68.5%  2019  796s
  4078  1962 -8635.3802   18  327 -8990.3577 -3023.1704  66.4%  2024  817s
  4271  2002 -7314.5622    9  431 -8990.3577 -3023.1704  66.4%  2031  835s
  4462  2069 infeasible   11      -8990.3577 -3251.1638  63.8%  2023  851s
  4730  2115 -8796.6154   16  128 -8990.3577 -3251.1638  63.8%  1995  870s
  4992  2127 infeasible   15      -8990.3577 -3330.6544  63.0%  1994  890s
  5246  2205 -7940.6661   10  534 -8990.3577 -3406.8974  62.1%  1994  910s
  5491  2237     cutoff   25      -8990.3577 -3597.3241  60.0%  2000  930s
  5673  2306 -6105.3001   16  282 -8990.3577 -3619.3506  59.7%  2013  952s
  5910  2365 infeasible   18      -8990.3577 -3651.4271  59.4%  2024  976s
  6228  2432 -8473.4137   17  108 -8990.3577 -3723.3804  58.6%  2018 1002s
  6498  2473 infeasible   19      -8990.3577 -3723.3804  58.6%  2023 1028s
  6851  2537 infeasible   26      -8990.3577 -3841.1273  57.3%  2013 1053s
  7082  2585 -7524.9411   16  408 -8990.3577 -3968.3513  55.9%  2022 1076s
  7340  2688 infeasible   19      -8990.3577 -4039.5285  55.1%  2020 1102s
  7713  2689 -5566.2081   12  615 -8990.3577 -4106.7110  54.3%  2016 1161s
  7715  2690 -6010.7062   17  327 -8990.3577 -4106.7110  54.3%  2015 1214s
  7716  2691 -7712.8519   17  631 -8990.3577 -4106.7110  54.3%  2015 1240s
  7717  2692 -5787.7087   13  595 -8990.3577 -4106.7110  54.3%  2015 1258s
  7718  2692 -7858.2642   16  611 -8990.3577 -4106.7110  54.3%  2014 1272s
  7719  2693 -7101.5988   18  610 -8990.3577 -4106.7110  54.3%  2014 1279s
  7720  2694 -8039.5402   16  538 -8990.3577 -4106.7110  54.3%  2014 1284s
  7721  2694 -5557.8274   17  561 -8990.3577 -4106.7110  54.3%  2014 1288s
  7722  2695 -4426.2718   10  584 -8990.3577 -4106.7110  54.3%  2013 1292s
  7723  2696 -4953.2712   12  590 -8990.3577 -4106.7110  54.3%  2013 1296s
  7724  2696 -5482.9635   17  570 -8990.3577 -4106.7110  54.3%  2013 1305s
  7725  2697 -8054.9650   14  649 -8990.3577 -4106.7110  54.3%  2012 1310s
  7728  2699 -8117.2948   14  678 -8990.3577 -4106.7110  54.3%  2012 1316s
  7729  2700 -5162.0499   13  680 -8990.3577 -4106.7110  54.3%  2011 1320s
  7730  2700 -6238.8371   18  725 -8990.3577 -4106.7110  54.3%  2011 1332s
  7731  2701 -6626.5558   17  679 -8990.3577 -4106.7110  54.3%  2011 1336s
  7732  2702 -7922.4962   17  596 -8990.3577 -4106.7110  54.3%  2011 1346s
  7733  2702 -6520.4725   20  592 -8990.3577 -4106.7110  54.3%  2010 1351s
  7734  2703 -8212.7499   18  726 -8990.3577 -4106.7110  54.3%  2010 1364s
  7735  2704 -8924.1147   16  740 -8990.3577 -4106.7110  54.3%  2010 1367s
  7736  2704 -6504.1579   19  803 -8990.3577 -4106.7110  54.3%  2010 1371s
  7737  2705 -6631.4139   15  677 -8990.3577 -4106.7110  54.3%  2009 1384s
  7738  2706 -6155.6192   14  678 -8990.3577 -4106.7110  54.3%  2009 1387s
  7739  2706 -8426.2297   26  682 -8990.3577 -4106.7110  54.3%  2009 1395s
  7741  2708 -5801.8323   21  694 -8990.3577 -4106.7110  54.3%  2008 1405s
  7742  2708 -8073.3832   24  694 -8990.3577 -4106.7110  54.3%  2008 1457s
  7743  2709 -8362.3234   28  694 -8990.3577 -4106.7110  54.3%  2008 1481s
  7744  2713 -4106.7110   16  688 -8990.3577 -4106.7110  54.3%  2038 1493s
  7746  2715 -4106.7110   17  391 -8990.3577 -4106.7110  54.3%  2039 1503s
  7749  2721 -4106.7110   18  372 -8990.3577 -4106.7110  54.3%  2041 1514s
  7756  2733 -4106.7110   19  507 -8990.3577 -4106.7110  54.3%  2044 1528s
  7770  2738 -5054.8841   20  213 -8990.3577 -4106.7110  54.3%  2063 1555s
  7787  2748 -4462.9258   20  369 -8990.3577 -4106.7110  54.3%  2075 1587s
  7818  2760 -7050.0473   21  300 -8990.3577 -4106.7110  54.3%  2102 1604s
  7861  2774 -8071.3677   22  294 -8990.3577 -4106.7110  54.3%  2146 1619s
  7932  2771 -8247.1314   25  274 -8990.3577 -4106.7110  54.3%  2166 1631s
  7973  2779 infeasible   26      -8990.3577 -4106.7110  54.3%  2173 1644s
  8047  2771     cutoff   24      -8990.3577 -4106.7110  54.3%  2184 1661s
  8108  2784 -5394.9550   27  187 -8990.3577 -4106.7110  54.3%  2190 1672s
  8175  2796 -6032.6756   29  284 -8990.3577 -4106.7110  54.3%  2197 1684s
  8244  2804 infeasible   33      -8990.3577 -4106.7110  54.3%  2201 1694s
  8332  2794 -7073.4997   34  289 -8990.3577 -4106.7110  54.3%  2202 1706s
  8392  2794 -8115.1653   38  146 -8990.3577 -4106.7110  54.3%  2210 1716s
  8456  2794     cutoff   39      -8990.3577 -4106.7110  54.3%  2216 1727s
  8520  2789     cutoff   29      -8990.3577 -4106.7110  54.3%  2221 1738s
  8583  2781 -6572.8083   27  585 -8990.3577 -4106.7110  54.3%  2226 1749s
  8643  2778 -6721.2791   28  452 -8990.3577 -4106.7110  54.3%  2232 1761s
  8708  2789 -7223.6659   30  155 -8990.3577 -4106.7110  54.3%  2240 1771s
  8785  2766 -7863.1614   33  383 -8990.3577 -4106.7110  54.3%  2244 1783s
  8835  2766 -7982.0954   35  165 -8990.3577 -4106.7110  54.3%  2250 1796s
  8891  2769 infeasible   37      -8990.3577 -4106.7110  54.3%  2254 1809s
  8964  2775 -7023.6730   32  414 -8990.3577 -4106.7110  54.3%  2259 1823s
  9052  2773 -7343.5199   34  363 -8990.3577 -4106.7110  54.3%  2264 1835s
  9135  2784 -8042.4999   39  252 -8990.3577 -4106.7110  54.3%  2272 1851s
  9224  2803 -8692.6051   40  233 -8990.3577 -4106.7110  54.3%  2280 1866s
  9340  2773 -6622.2070   23  519 -8990.3577 -4106.7110  54.3%  2283 1881s
  9436  2745 -7262.9720   24  495 -8990.3577 -4106.7110  54.3%  2295 1899s
  9515  2729     cutoff   24      -8990.3577 -4127.3748  54.1%  2307 1915s
  9601  2715 -6767.6375   28  519 -8990.3577 -4127.3748  54.1%  2321 1932s
  9691  2690 -7078.3632   30  433 -8990.3577 -4127.3748  54.1%  2333 1950s
  9792  2661     cutoff   35      -8990.3577 -4127.3748  54.1%  2344 1968s
  9893  2613 -5924.6138   26  479 -8990.3577 -4127.3748  54.1%  2360 1989s
  9977  2602 -6408.3087   27  430 -8990.3577 -5061.5482  43.7%  2375 2006s
 10046  2579 -7089.9046   30  343 -8990.3577 -5234.7880  41.8%  2385 2025s
 10164  2547 -7788.0694   34  258 -8990.3577 -5461.3080  39.3%  2397 2044s
 10266  2528 -8544.5745   35  333 -8990.3577 -5461.3080  39.3%  2416 2064s
 10419  2485     cutoff   39      -8990.3577 -5512.8101  38.7%  2426 2088s
 10568  2430 infeasible   25      -8990.3577 -5775.4194  35.8%  2441 2111s
 10733  2348     cutoff   29      -8990.3577 -5803.6464  35.4%  2458 2135s
 10875  2266 -7467.9977   27  457 -8990.3577 -5947.7876  33.8%  2476 2159s
 10955  2217 -7608.7947   28  363 -8990.3577 -5947.7876  33.8%  2485 2179s
 11057  2162 -7648.5286   29  444 -8990.3577 -5947.7876  33.8%  2493 2201s
 11147  2089 -7776.5560   30  438 -8990.3577 -6409.3221  28.7%  2500 2224s
 11277  1997 -7817.1368   31  293 -8990.3577 -6424.2726  28.5%  2500 2246s
 11416  1890     cutoff   31      -8990.3577 -6778.4902  24.6%  2509 2272s
 11585  1762 -8341.9478   28  384 -8990.3577 -6800.2107  24.4%  2513 2301s
 11792  1544 -8522.3299   29  439 -8990.3577 -6800.2107  24.4%  2512 2330s
 12061  1302 infeasible   31      -8990.3577 -7329.9109  18.5%  2508 2356s
 12263  1202 -8896.9286   31  570 -8990.3577 -7466.1930  17.0%  2492 2362s

Cutting planes:
  Learned: 3
  MIR: 559
  Mixing: 1
  Flow cover: 1453
  GUB cover: 1
  Zero half: 9
  RLT: 29
  Relax-and-lift: 75

Explored 12302 nodes (30848287 simplex iterations) in 2362.90 seconds (6287.95 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8990.36 -9042.36 -9090.9 ... -67838
No other solutions better than -8990.36

Optimal solution found (tolerance 1.00e-06)
Best objective -8.990357673137e+03, best bound -8.990357673137e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2363.00s
  Master Objective (UB) = -8990.36, θ = 118067.80
  Upper Bound (UB) = -8990.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118067.80
  [DEBUG]   ✓ Scenario 0: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118067.80 ≤ Q = 118067.80 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1d00815d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe2ff7ea3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.307725e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6912950.1954
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.234900e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123490.01    0  123 6912950.20 -123490.01   102%     -    0s
H    0     0                    -88054.89868 -123490.01  40.2%     -    0s
H    0     0                    -89385.02407 -123490.01  38.2%     -    0s
     0     0 -93626.083    0   88 -89385.024 -93626.083  4.74%     -    0s
H    0     0                    -91455.58074 -93586.423  2.33%     -    0s
     0     0 -93380.173    0   88 -91455.581 -93380.173  2.10%     -    0s
H    0     0                    -91790.85665 -93326.365  1.67%     -    0s
     0     0 -93300.683    0   88 -91790.857 -93300.683  1.64%     -    0s
     0     0 -93217.019    0   88 -91790.857 -93217.019  1.55%     -    0s
     0     0 -93212.870    0   88 -91790.857 -93212.870  1.55%     -    0s
     0     2 -93212.870    0   88 -91790.857 -93212.870  1.55%     -    0s
H   36    64                    -91823.43659 -92858.129  1.13%  12.1    0s
H   45    64                    -91977.35823 -92858.129  0.96%  11.6    0s
H  418   379                    -92052.82063 -92824.806  0.84%   4.6    0s
H  423   379                    -92089.64945 -92824.806  0.80%   4.6    0s
H  438   379                    -92144.02693 -92824.806  0.74%   4.6    0s
H  463   379                    -92146.66719 -92824.806  0.74%   4.5    0s
H  528   379                    -92183.42394 -92824.806  0.70%   4.4    0s
H  893   552                    -92228.31280 -92824.806  0.65%   3.9    0s
H  977   552                    -92237.80137 -92824.806  0.64%   4.0    0s
* 2496   715              30    -92270.74236 -92450.954  0.20%   4.1    0s
* 3365   247              20    -92282.69022 -92421.781  0.15%   4.2    0s

Cutting planes:
  Gomory: 21
  Implied bound: 4
  MIR: 183

Explored 4282 nodes (17946 simplex iterations) in 0.13 seconds (0.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -92282.7 -92270.7 -92237.8 ... -91977.4
No other solutions better than -92282.7

Optimal solution found (tolerance 1.00e-06)
Best objective -9.228269022331e+04, best bound -9.228269022331e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 117349.44
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -92282.69
  [DEBUG]   S×d_nominal = 209632.13
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209632.13 + -92282.69 = 117349.44
  [DEBUG]   Current θ from Master = 118067.80
  [DEBUG]   ⚠️  Z_SP ≤ θ by 718.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9708.72
  Lower Bound (LB) = -9708.72
  Gap (UB-LB) = 718.3619, Absolute Gap = 718.3619, Relative Gap = 0.079904
  Not converged yet (gap = 718.36 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351439 nonzeros
Model fingerprint: 0x2dcbab45
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54296 rows and 22056 columns
Presolve time: 1.19s
Presolved: 69407 rows, 30124 columns, 432359 nonzeros
Variable types: 27865 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 69407 rows, 30124 columns, 432359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30079   -8.7350474e+04   0.000000e+00   6.652248e+07      5s
   43015   -7.4769939e+03   0.000000e+00   9.967414e+05     10s
   50877   -3.7978605e+03   0.000000e+00   2.635567e+06     15s
   57992   -2.1955543e+03   0.000000e+00   5.157845e+07     20s
   64126   -1.0707441e+03   0.000000e+00   2.057584e+07     25s
   69559   -9.6457242e+02   0.000000e+00   8.232889e+05     30s
   74391   -9.4846943e+02   0.000000e+00   2.787763e+06     35s
Concurrent spin time: 0.55s

Solved with dual simplex

Root relaxation: objective 1.025231e+04, 64738 iterations, 38.37 seconds (78.61 work units)
Total elapsed time = 40.24s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10252.3108    0  327 -226690.33 10252.3108   105%     -   40s
H    0     0                    -210558.3658 10252.3108   105%     -   40s
H    0     0                    -171422.3646 10252.3108   106%     -   40s
H    0     0                    -101509.1658 10252.3108   110%     -   40s
H    0     0                    -100883.7917 10252.3108   110%     -   40s
H    0     0                    -67688.54141 10252.3108   115%     -   40s
H    0     0                    -19236.31650 10252.3108   153%     -   40s
H    0     0                    -17913.10378 10252.3108   157%     -   40s
H    0     0                    -15614.07972 10252.3108   166%     -   40s
H    0     0                    -14802.50820 10252.3108   169%     -   40s
H    0     0                    -12460.49749 6764.73753   154%     -   57s
H    0     0                    -9093.235112 6764.73753   174%     -   57s
     0     0 6559.02586    0  180 -9093.2351 6559.02586   172%     -   57s
     0     0 4921.52591    0  175 -9093.2351 4921.52591   154%     -   62s
     0     0 4921.52591    0  175 -9093.2351 4921.52591   154%     -   62s
     0     0 4813.64342    0  507 -9093.2351 4813.64342   153%     -   71s
H    0     0                    -9041.233060 4812.02519   153%     -   71s
     0     0 4506.12718    0  514 -9041.2331 4506.12718   150%     -   76s
     0     0 4467.46553    0  514 -9041.2331 4467.46553   149%     -   78s
     0     0 4396.25268    0  509 -9041.2331 4396.25268   149%     -   80s
     0     0 4373.27509    0  509 -9041.2331 4373.27509   148%     -   81s
     0     0 4289.67168    0  513 -9041.2331 4289.67168   147%     -   83s
     0     0 4246.77810    0  526 -9041.2331 4246.77810   147%     -   85s
     0     0 4219.61557    0  531 -9041.2331 4219.61557   147%     -   85s
     0     0 4215.64593    0  529 -9041.2331 4215.64593   147%     -   86s
     0     0 4212.29151    0  529 -9041.2331 4212.29151   147%     -   86s
     0     0 4211.92363    0  529 -9041.2331 4211.92363   147%     -   87s
     0     0 2145.62623    0  485 -9041.2331 2145.62623   124%     -  102s
H    0     0                    -9035.820881 1654.74118   118%     -  109s
     0     0 1654.74118    0  560 -9035.8209 1654.74118   118%     -  109s
     0     0 1588.48432    0  551 -9035.8209 1588.48432   118%     -  112s
     0     0 1563.73636    0  558 -9035.8209 1563.73636   117%     -  114s
     0     0 1544.71419    0  560 -9035.8209 1544.71419   117%     -  116s
     0     0 1522.78247    0  552 -9035.8209 1522.78247   117%     -  118s
     0     0 1520.22781    0  567 -9035.8209 1520.22781   117%     -  118s
     0     0 1510.93796    0  566 -9035.8209 1510.93796   117%     -  119s
     0     0 1510.71082    0  561 -9035.8209 1510.71082   117%     -  119s
     0     0 1007.48876    0  598 -9035.8209 1007.48876   111%     -  134s
     0     0  819.22159    0  551 -9035.8209  819.22159   109%     -  139s
     0     0  766.19821    0  625 -9035.8209  766.19821   108%     -  142s
     0     0  740.69482    0  615 -9035.8209  740.69482   108%     -  144s
     0     0  725.67035    0  622 -9035.8209  725.67035   108%     -  145s
     0     0  720.58068    0  635 -9035.8209  720.58068   108%     -  146s
     0     0  719.50401    0  640 -9035.8209  719.50401   108%     -  146s
     0     0  612.26760    0  633 -9035.8209  612.26760   107%     -  151s
H    0     0                    -9033.480925  562.37821   106%     -  154s
     0     0  562.37821    0  563 -9033.4809  562.37821   106%     -  154s
     0     0  528.11068    0  569 -9033.4809  528.11068   106%     -  155s
     0     0  521.23280    0  576 -9033.4809  521.23280   106%     -  156s
     0     0  509.25957    0  579 -9033.4809  509.25957   106%     -  158s
     0     0  508.23662    0  577 -9033.4809  508.23662   106%     -  159s
     0     0  447.98076    0  571 -9033.4809  447.98076   105%     -  164s
     0     0  307.63114    0  633 -9033.4809  307.63114   103%     -  170s
     0     0  288.34773    0  641 -9033.4809  288.34773   103%     -  172s
     0     0  280.69455    0  651 -9033.4809  280.69455   103%     -  174s
     0     0  277.73245    0  659 -9033.4809  277.73245   103%     -  174s
     0     0  276.34219    0  659 -9033.4809  276.34219   103%     -  175s
     0     0  275.49660    0  655 -9033.4809  275.49660   103%     -  175s
     0     0  247.71780    0  635 -9033.4809  247.71780   103%     -  178s
     0     0  218.68787    0  648 -9033.4809  218.68787   102%     -  181s
     0     0  211.66855    0  584 -9033.4809  211.66855   102%     -  182s
     0     0  208.38579    0  658 -9033.4809  208.38579   102%     -  183s
     0     0  207.07465    0  663 -9033.4809  207.07465   102%     -  184s
     0     0  207.01061    0  656 -9033.4809  207.01061   102%     -  184s
     0     0  170.81881    0  647 -9033.4809  170.81881   102%     -  188s
     0     0  157.32002    0  646 -9033.4809  157.32002   102%     -  190s
     0     0  155.31789    0  644 -9033.4809  155.31789   102%     -  191s
     0     0  153.99549    0  648 -9033.4809  153.99549   102%     -  191s
     0     0  153.72209    0  653 -9033.4809  153.72209   102%     -  191s
     0     0  132.79173    0  587 -9033.4809  132.79173   101%     -  194s
     0     0  120.37522    0  662 -9033.4809  120.37522   101%     -  196s
     0     0  116.44124    0  659 -9033.4809  116.44124   101%     -  197s
     0     0  114.12514    0  663 -9033.4809  114.12514   101%     -  198s
     0     0  112.73598    0  657 -9033.4809  112.73598   101%     -  199s
     0     0  112.49214    0  655 -9033.4809  112.49214   101%     -  199s
     0     0  103.03360    0  583 -9033.4809  103.03360   101%     -  201s
     0     0   96.54943    0  666 -9033.4809   96.54943   101%     -  203s
     0     0   96.54943    0  662 -9033.4809   96.54943   101%     -  204s
     0     0   96.12932    0  663 -9033.4809   96.12932   101%     -  204s
     0     0   87.94579    0  664 -9033.4809   87.94579   101%     -  207s
     0     0   86.39325    0  672 -9033.4809   86.39325   101%     -  209s
     0     0   85.62065    0  672 -9033.4809   85.62065   101%     -  209s
     0     0   77.75516    0  661 -9033.4809   77.75516   101%     -  211s
     0     0   74.46826    0  669 -9033.4809   74.46826   101%     -  213s
     0     0   72.75965    0  666 -9033.4809   72.75965   101%     -  213s
     0     0   71.90315    0  667 -9033.4809   71.90315   101%     -  214s
     0     0   71.51323    0  674 -9033.4809   71.51323   101%     -  216s
     0     0   69.73555    0  668 -9033.4809   69.73555   101%     -  217s
     0     0   69.73555    0  670 -9033.4809   69.73555   101%     -  218s
     0     0   68.63013    0  670 -9033.4809   68.63013   101%     -  220s
     0     2   66.82186    0  670 -9033.4809   66.82186   101%     -  320s
     1     4 -192.26878    1  661 -9033.4809   66.81260   101%  8129  326s
     3     8 -343.30833    2  656 -9033.4809 -192.39993  97.9%  7760  331s
     7    16 -426.05110    3  714 -9033.4809 -345.76968  96.2%  6824  339s
    15    32 -658.40142    4  753 -9033.4809 -426.59477  95.3%  6719  348s
    31    50 -7629.7060    5  213 -9033.4809 -658.41300  92.7%  8129  373s
    49    82 -2083.8571    6  426 -9033.4809 -658.41300  92.7% 11445  381s
    81   159 -2179.0405    7  407 -9033.4809 -658.41300  92.7%  8234  390s
   158   273 -2219.6617    8  405 -9033.4809 -658.41300  92.7%  4974  400s
   278   322 -2352.4269   10  345 -9033.4809 -658.41300  92.7%  3369  407s
   368   353 -2830.2418    9  384 -9033.4809 -658.41300  92.7%  2830  415s
   427   387 -2361.2637   11  323 -9033.4809 -658.41300  92.7%  2707  424s
   480   411 -2454.5427   11  410 -9033.4809 -658.41300  92.7%  2646  431s
   526   459 -8104.8910   11  184 -9033.4809 -658.41300  92.7%  2577  440s
   592   494 -3951.0493   16  223 -9033.4809 -658.41300  92.7%  2453  446s
   663   519 -2988.2182   12  384 -9033.4809 -658.41300  92.7%  2346  454s
   736   556 -4471.8624   19  346 -9033.4809 -658.41300  92.7%  2222  462s
   793   586 -3128.0398   12  394 -9033.4809 -658.41300  92.7%  2185  469s
   855   623 -3833.6920   13  303 -9033.4809 -658.41300  92.7%  2162  480s
   925   660 -5257.2578   13  422 -9033.4809 -658.41300  92.7%  2119  489s
  1000   725 -4139.7621   14  298 -9033.4809 -658.41300  92.7%  2097  496s
  1091   751 -4028.1679   14  292 -9033.4809 -658.41300  92.7%  2038  504s
  1159   785 -4436.9662   15  435 -9033.4809 -658.41300  92.7%  2005  513s
  1251   819 -5080.3078   16  212 -9033.4809 -658.41300  92.7%  1983  522s
  1359   845 -4505.3862   16  365 -9033.4809 -658.41300  92.7%  1931  531s
  1451   887 -7033.5500   17  187 -9033.4809 -658.41300  92.7%  1935  541s
  1529   955 -7262.0743   18  271 -9033.4809 -658.41300  92.7%  1948  551s
  1637  1005 -7632.8882   20  391 -9033.4809 -658.41300  92.7%  1922  563s
  1763  1040 -8270.5264   22  272 -9033.4809 -658.41300  92.7%  1904  574s
  1896  1075 -8760.0852   25  318 -9033.4809 -658.41300  92.7%  1863  585s
  1992  1124     cutoff   25      -9033.4809 -658.41300  92.7%  1859  596s
  2075  1177 -4948.2907   14  321 -9033.4809 -658.41300  92.7%  1890  609s
  2172  1219 -6635.5183   16  313 -9033.4809 -658.41300  92.7%  1904  622s
  2291  1254 -7890.8815   18  268 -9033.4809 -702.73888  92.2%  1896  634s
  2387  1279 -8300.9978   19  322 -9033.4809 -702.73888  92.2%  1874  646s
  2426  1313     cutoff   19      -9033.4809 -702.73888  92.2%  1894  659s
  2472  1353 -8796.6526   21  325 -9033.4809 -702.73888  92.2%  1920  671s
  2530  1413     cutoff   22      -9033.4809 -702.73888  92.2%  1937  682s
  2640  1492 -5239.9508   10  389 -9033.4809 -702.73888  92.2%  1936  696s
  2777  1568     cutoff   11      -9033.4809 -702.73888  92.2%  1925  710s
  2928  1631     cutoff    9      -9033.4809 -702.73888  92.2%  1913  727s
  3089  1719 -5459.7565   16  609 -9033.4809 -702.73888  92.2%  1908  743s
  3225  1780 -5670.6954   19  560 -9033.4809 -702.73888  92.2%  1917  760s
  3415  1820 -7109.9917   21  518 -9033.4809 -1780.5882  80.3%  1903  776s
  3529  1891     cutoff   23      -9033.4809 -1780.5882  80.3%  1910  792s
  3657  1996     cutoff   44      -9033.4809 -1998.3605  77.9%  1929  809s
  3833  2080 -8936.5317   20   40 -9033.4809 -2451.3554  72.9%  1937  827s
  4021  2176 -8422.2054   10  108 -9033.4809 -2451.3554  72.9%  1948  845s
  4227  2245     cutoff   12      -9033.4809 -2452.2376  72.9%  1951  866s
  4425  2333 -5018.4601   13  239 -9033.4809 -2489.7500  72.4%  1967  885s
  4649  2450 -6955.9619   18  328 -9033.4809 -2540.8094  71.9%  1975  907s
  4918  2451 -6651.9237   21  670 -9033.4809 -2643.3986  70.7%  1961  990s
  4920  2452 -7932.2837   35  327 -9033.4809 -2643.3986  70.7%  1960 1037s
  4921  2453 -3387.4245   12  617 -9033.4809 -2643.3986  70.7%  1959 1068s
  4922  2454 -3648.6773   19  580 -9033.4809 -2643.3986  70.7%  1959 1085s
  4923  2454 -6533.0045   22  625 -9033.4809 -2643.3986  70.7%  1959 1098s
  4924  2455 -8060.4331   38  625 -9033.4809 -2643.3986  70.7%  1958 1105s
  4925  2456 -8303.5132   29  643 -9033.4809 -2643.3986  70.7%  1958 1113s
  4926  2456 -5453.6437   30  623 -9033.4809 -2643.3986  70.7%  1957 1118s
  4927  2457 -7963.6060   24  565 -9033.4809 -2643.3986  70.7%  1957 1121s
  4929  2458 -7515.3775   18  646 -9033.4809 -2643.3986  70.7%  1956 1126s
  4930  2459 -5220.9394   16  660 -9033.4809 -2643.3986  70.7%  1956 1132s
  4931  2460 -7588.5606   29  630 -9033.4809 -2643.3986  70.7%  1956 1144s
  4932  2460 -6410.2130   14  554 -9033.4809 -2643.3986  70.7%  1955 1148s
  4933  2461 -4053.9852   13  634 -9033.4809 -2643.3986  70.7%  1955 1151s
  4934  2462 -8605.2329   33  649 -9033.4809 -2643.3986  70.7%  1954 1155s
  4935  2462 -8395.7799   44  694 -9033.4809 -2643.3986  70.7%  1954 1167s
  4937  2464 -4219.4142   18  628 -9033.4809 -2643.3986  70.7%  1953 1171s
  4938  2464 -5258.2291   17  703 -9033.4809 -2643.3986  70.7%  1953 1176s
  4939  2465 -3906.1343   15  643 -9033.4809 -2643.3986  70.7%  1952 1187s
  4940  2466 -4060.6053   11  723 -9033.4809 -2643.3986  70.7%  1952 1190s
  4941  2466 -8788.8742   29  593 -9033.4809 -2643.3986  70.7%  1952 1195s
  4942  2467 -8303.5132   29  728 -9033.4809 -2643.3986  70.7%  1951 1204s
  4943  2468 -8786.5038   21  735 -9033.4809 -2643.3986  70.7%  1951 1207s
  4944  2468 -7988.1934   43  660 -9033.4809 -2643.3986  70.7%  1950 1211s
  4945  2469 -7745.4597   37  726 -9033.4809 -2643.3986  70.7%  1950 1223s
  4946  2470 -8367.6377   22  754 -9033.4809 -2643.3986  70.7%  1950 1228s
  4947  2470 -3648.6773   19  660 -9033.4809 -2643.3986  70.7%  1949 1235s
  4948  2471 -7712.6990   36  735 -9033.4809 -2643.3986  70.7%  1949 1240s
  4949  2472 -8473.3497   15  669 -9033.4809 -2643.3986  70.7%  1948 1246s
  4950  2472 -7054.1208   31  669 -9033.4809 -2643.3986  70.7%  1948 1295s
  4951  2473 -8203.3413   25  669 -9033.4809 -2643.3986  70.7%  1948 1317s
  4952  2477 -2643.3986   15  731 -9033.4809 -2643.3986  70.7%  1997 1339s
  4954  2480 -2643.3986   16  649 -9033.4809 -2643.3986  70.7%  1998 1353s
  4958  2487 -2643.3986   17  641 -9033.4809 -2643.3986  70.7%  2003 1368s
  4966  2500 -2643.3986   18  644 -9033.4809 -2643.3986  70.7%  2011 1380s
  4982  2510 -2666.3718   19  446 -9033.4809 -2643.3986  70.7%  2048 1408s
  5003  2516 -5571.0238   20  310 -9033.4809 -2643.3986  70.7%  2079 1424s
  5035  2558 -6831.0623   21  287 -9033.4809 -2643.3986  70.7%  2103 1456s
  5110  2601 infeasible   23      -9033.4809 -2643.3986  70.7%  2154 1469s
  5206  2595 -8321.2040   27  224 -9033.4809 -2643.3986  70.7%  2162 1481s
  5274  2602     cutoff   29      -9033.4809 -2643.3986  70.7%  2168 1499s
  5355  2594 infeasible   25      -9033.4809 -2643.3986  70.7%  2170 1512s
  5399  2603 -5764.4949   24  575 -9033.4809 -2643.3986  70.7%  2181 1526s
  5469  2591 -6529.0535   25  460 -9033.4809 -2643.3986  70.7%  2184 1537s
  5515  2592 -7037.2947   26  280 -9033.4809 -2643.3986  70.7%  2192 1549s
  5571  2584 -8678.2963   27  214 -9033.4809 -2643.3986  70.7%  2200 1561s
  5615  2591     cutoff   28      -9033.4809 -2643.3986  70.7%  2203 1578s
  5665  2589 -8952.9886   28  289 -9033.4809 -2643.3986  70.7%  2213 1590s
  5721  2583     cutoff   29      -9033.4809 -2643.3986  70.7%  2216 1605s
  5784  2589 -7858.4560   29  259 -9033.4809 -2643.3986  70.7%  2218 1616s
  5844  2591 -8498.4856   31  318 -9033.4809 -2643.3986  70.7%  2223 1627s
  5925  2583 -7788.2366   23  243 -9033.4809 -2643.3986  70.7%  2222 1643s
  6002  2567 -8428.2687   25  162 -9033.4809 -2643.3986  70.7%  2220 1656s
  6073  2555 -8863.8640   28  209 -9033.4809 -2643.3986  70.7%  2221 1668s
  6147  2546 -4733.8970   21  490 -9033.4809 -2643.3986  70.7%  2221 1685s
  6192  2552 -5182.4004   22  480 -9033.4809 -2643.3986  70.7%  2222 1699s
  6246  2571 -5519.6788   23  454 -9033.4809 -2643.3986  70.7%  2232 1712s
H 6286  2433                    -9005.486824 -2643.3986  70.6%  2233 1712s
  6319  2446 -7764.8974   24  224 -9005.4868 -2643.3986  70.6%  2240 1726s
  6373  2457 -8027.7199   25  222 -9005.4868 -2643.3986  70.6%  2245 1740s
  6466  2438     cutoff   27      -9005.4868 -2643.3986  70.6%  2242 1756s
  6573  2435 -7167.9973   24  462 -9005.4868 -2643.3986  70.6%  2241 1772s
  6673  2423 -7301.3365   26  478 -9005.4868 -2643.3986  70.6%  2245 1789s
  6767  2426 -7800.7561   27  428 -9005.4868 -2643.3986  70.6%  2260 1812s
  6876  2421 -8597.7392   30  188 -9005.4868 -2643.3986  70.6%  2267 1830s
  7004  2395     cutoff   26      -9005.4868 -2643.3986  70.6%  2269 1847s
  7071  2408 -3715.0212   21  611 -9005.4868 -2643.3986  70.6%  2276 1862s
  7165  2421 -4064.2395   23  604 -9005.4868 -2643.3986  70.6%  2282 1881s
  7274  2414 -6037.7908   26  432 -9005.4868 -2643.3986  70.6%  2288 1903s
  7413  2399 -6954.2328   28  499 -9005.4868 -3146.9557  65.1%  2293 1923s
  7557  2391 -7997.0016   31  427 -9005.4868 -3146.9557  65.1%  2301 1947s
  7714  2344     cutoff   30      -9005.4868 -3715.9037  58.7%  2302 1975s
  7805  2345 -4207.6606   22  564 -9005.4868 -3715.9037  58.7%  2310 1997s
  7951  2304 -4847.4381   24  525 -9005.4868 -3715.9037  58.7%  2317 2018s
  8064  2306 -7451.1274   25  392 -9005.4868 -3715.9037  58.7%  2319 2044s
  8267  2280 -6401.4234   24  397 -9005.4868 -3715.9037  58.7%  2319 2072s
  8472  2232 -7758.6874   27  182 -9005.4868 -4130.0650  54.1%  2324 2099s
  8660  2205     cutoff   27      -9005.4868 -4717.2112  47.6%  2334 2131s
  8911  2124 -6537.0868   27  443 -9005.4868 -4717.2112  47.6%  2328 2158s
  9090  2112 -7538.9157   28  507 -9005.4868 -4950.8971  45.0%  2325 2194s
  9315  2052 infeasible   34      -9005.4868 -4950.8971  45.0%  2330 2231s
  9555  2000 -7091.7262   26  344 -9005.4868 -5294.6848  41.2%  2337 2265s
  9784  1923     cutoff   30      -9005.4868 -5515.5457  38.8%  2349 2303s
 10043  1841 -8481.8309   28  291 -9005.4868 -5603.4950  37.8%  2355 2338s
 10295  1762     cutoff   30      -9005.4868 -5787.0278  35.7%  2358 2373s
 10573  1684     cutoff   34      -9005.4868 -5993.5481  33.4%  2370 2412s
 10928  1539 -8923.5170   30  451 -9005.4868 -6160.7815  31.6%  2368 2449s
 11307  1378     cutoff   25      -9005.4868 -6324.6288  29.8%  2365 2488s
 11716  1228 -7729.7442   30  113 -9005.4868 -6465.9984  28.2%  2360 2531s
 12137  1115 -8814.4242   28  408 -9005.4868 -6653.5505  26.1%  2356 2567s
 12241  1087     cutoff   29      -9005.4868 -6768.9939  24.8%  2353 2606s
 12568   955     cutoff   26      -9005.4868 -6786.8610  24.6%  2343 2645s
 13030   788 infeasible   33      -9005.4868 -6930.7286  23.0%  2333 2689s
 13544   474     cutoff   33      -9005.4868 -7270.0250  19.3%  2316 2734s
 14329    49     cutoff   33      -9005.4868 -7605.3613  15.5%  2264 2769s
 15127     0     cutoff   35      -9005.4868 -7644.7592  15.1%  2192 2781s

Cutting planes:
  Learned: 1
  MIR: 930
  Flow cover: 2110
  Zero half: 17
  RLT: 33
  Relax-and-lift: 141

Explored 15222 nodes (33510672 simplex iterations) in 2781.64 seconds (7537.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -9005.49 -9033.48 -9035.82 ... -19236.3
No other solutions better than -9005.49

Optimal solution found (tolerance 1.00e-06)
Best objective -9.005486823818e+03, best bound -9.005486823818e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2781.69s
  Master Objective (UB) = -9005.49, θ = 118426.27
  Upper Bound (UB) = -9005.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118426.27
  [DEBUG]   ✓ Scenario 0: θ = 118426.27 ≤ Q = 118426.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118426.27 ≤ Q = 118426.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118426.27 ≤ Q = 118426.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118426.27 ≤ Q = 118426.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118426.27 ≤ Q = 118426.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118426.27 ≤ Q = 118426.27 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6cf4522c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6cf4522c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.303058e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6911482.2125
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.233202e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123320.21    0  122 6911482.21 -123320.21   102%     -    0s
H    0     0                    -87850.27619 -123320.21  40.4%     -    0s
H    0     0                    -89049.48371 -123320.21  38.5%     -    0s
     0     0 -92649.422    0   46 -89049.484 -92649.422  4.04%     -    0s
H    0     0                    -90104.23236 -92627.311  2.80%     -    0s
H    0     0                    -90415.96124 -92627.311  2.45%     -    0s
H    0     0                    -91086.29002 -92627.311  1.69%     -    0s
H    0     0                    -91398.01890 -92627.311  1.34%     -    0s
     0     0 -92489.449    0   46 -91398.019 -92489.449  1.19%     -    0s
     0     0 -92451.734    0   46 -91398.019 -92451.734  1.15%     -    0s
H    0     0                    -91410.86830 -92447.935  1.13%     -    0s
     0     2 -92447.935    0   46 -91410.868 -92447.935  1.13%     -    0s
H  124    93                    -91445.01656 -92060.537  0.67%   6.5    0s
H  139    93                    -91473.07547 -92060.537  0.64%   6.2    0s
H  180    93                    -91536.45588 -92060.537  0.57%   5.6    0s

Cutting planes:
  Gomory: 16
  Implied bound: 10
  MIR: 144

Explored 1971 nodes (8752 simplex iterations) in 0.13 seconds (0.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -91536.5 -91473.1 -91445 ... 1.30306e+13
No other solutions better than -91536.5

Optimal solution found (tolerance 1.00e-06)
Best objective -9.153645588196e+04, best bound -9.153645588196e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 118216.30
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91536.46
  [DEBUG]   S×d_nominal = 209752.76
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209752.76 + -91536.46 = 118216.30
  [DEBUG]   Current θ from Master = 118426.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 209.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9215.45
  Lower Bound (LB) = -9215.45
  Gap (UB-LB) = 209.9648, Absolute Gap = 209.9648, Relative Gap = 0.023315
  Not converged yet (gap = 209.96 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394679 nonzeros
Model fingerprint: 0xc38288c0
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [6e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61083 rows and 24813 columns
Presolve time: 1.16s
Presolved: 77910 rows, 33607 columns, 477884 nonzeros
Variable types: 31348 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -409717.4995
Found heuristic solution: objective -226690.3294

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77910 rows, 33607 columns, 477884 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32560   -9.4187058e+04   0.000000e+00   2.259131e+09      5s
   46905   -3.1899818e+03   0.000000e+00   1.579731e+06     10s
   55602   -3.8463893e+02   0.000000e+00   6.023626e+06     15s
   63151    1.9076232e+03   0.000000e+00   3.423319e+06     20s
   69365    3.0601388e+03   0.000000e+00   1.787308e+08     25s
   77019    5.4037010e+03   0.000000e+00   2.245013e+06     30s
   82422    5.7691671e+03   0.000000e+00   3.899394e+06     35s
   87523    5.8489133e+03   0.000000e+00   2.997542e+06     40s
   93136    6.1508464e+03   0.000000e+00   5.014995e+07     45s
   98065    6.4514264e+03   0.000000e+00   3.569424e+07     50s
  103653    6.8937657e+03   0.000000e+00   5.373288e+05     55s
  108264    8.3891950e+03   0.000000e+00   1.465576e+06     60s
  114647    1.0338397e+04   0.000000e+00   5.035837e+07     65s
  119471    1.0479699e+04   0.000000e+00   2.757122e+06     70s
Concurrent spin time: 0.02s

Solved with dual simplex

Root relaxation: objective 1.099494e+04, 86498 iterations, 72.42 seconds (138.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10994.9353    0  480 -226690.33 10994.9353   105%     -   74s
H    0     0                    -210558.3658 10994.9353   105%     -   74s
H    0     0                    -162984.1044 10994.9353   107%     -   74s
H    0     0                    -47738.66202 10994.9353   123%     -   74s
H    0     0                    -47724.97959 10994.9353   123%     -   74s
H    0     0                    -47699.42388 10994.9353   123%     -   74s
H    0     0                    -47683.72919 10994.9353   123%     -   74s
H    0     0                    -47671.32622 10994.9353   123%     -   74s
H    0     0                    -47668.92122 10994.9353   123%     -   74s
H    0     0                    -26438.07550 10994.9353   142%     -   74s
H    0     0                    -25681.29072 10994.9353   143%     -   75s
H    0     0                    -25511.38715 10994.9353   143%     -   75s
H    0     0                    -25408.24163 10994.9353   143%     -   75s
H    0     0                    -25104.97606 10994.9353   144%     -   75s
H    0     0                    -25014.86779 10994.9353   144%     -   75s
H    0     0                    -25000.04919 10994.9353   144%     -   75s
H    0     0                    -24995.24098 10994.9353   144%     -   75s
H    0     0                    -24978.38590 10994.9353   144%     -   75s
H    0     0                    -19969.29294 7308.21802   137%     -   94s
H    0     0                    -19383.99738 7308.21802   138%     -   94s
     0     0 7307.86322    0  368 -19383.997 7307.86322   138%     -   94s
     0     0 6464.85380    0  471 -19383.997 6464.85380   133%     -  105s
     0     0 6464.85380    0  471 -19383.997 6464.85380   133%     -  106s
     0     0 6464.85380    0  472 -19383.997 6464.85380   133%     -  108s
     0     0 6464.85380    0  480 -19383.997 6464.85380   133%     -  110s
     0     0 6464.85380    0  484 -19383.997 6464.85380   133%     -  112s
     0     0 6464.85380    0  474 -19383.997 6464.85380   133%     -  113s
     0     0 6464.85380    0  484 -19383.997 6464.85380   133%     -  113s
     0     0 6464.85380    0  475 -19383.997 6464.85380   133%     -  114s
     0     0 6464.85380    0  478 -19383.997 6464.85380   133%     -  114s
     0     0 6464.84832    0  481 -19383.997 6464.84832   133%     -  115s
H    0     0                    -13230.38026 3987.30593   130%     -  129s
H    0     0                    -13222.58551 3987.30593   130%     -  129s
H    0     0                    -13214.19114 3987.30593   130%     -  129s
H    0     0                    -13203.39006 3987.30593   130%     -  129s
H    0     0                    -13203.18134 3987.30593   130%     -  129s
H    0     0                    -13202.27726 3987.30593   130%     -  129s
     0     0 3987.30593    0  543 -13202.277 3987.30593   130%     -  130s
     0     0 3681.28211    0  426 -13202.277 3681.28211   128%     -  135s
H    0     0                    -13090.30886 3568.67595   127%     -  138s
H    0     0                    -13063.96053 3568.67595   127%     -  138s
H    0     0                    -13051.41834 3568.67595   127%     -  138s
     0     0 3568.67595    0  537 -13051.418 3568.67595   127%     -  138s
     0     0 3537.45410    0  533 -13051.418 3537.45410   127%     -  140s
     0     0 3513.96752    0  549 -13051.418 3513.96752   127%     -  141s
     0     0 3387.26577    0  539 -13051.418 3387.26577   126%     -  145s
     0     0 3382.82815    0  547 -13051.418 3382.82815   126%     -  146s
     0     0 3294.50642    0  536 -13051.418 3294.50642   125%     -  148s
     0     0 3274.94604    0  547 -13051.418 3274.94604   125%     -  150s
     0     0 3167.90583    0  611 -13051.418 3167.90583   124%     -  153s
     0     0 3151.08691    0  610 -13051.418 3151.08691   124%     -  154s
H    0     0                    -13049.80734 3149.11782   124%     -  154s
     0     0 3149.11782    0  615 -13049.807 3149.11782   124%     -  154s
     0     0 3148.97869    0  613 -13049.807 3148.97869   124%     -  155s
H    0     0                    -12961.76724 1735.44043   113%     -  176s
H    0     0                    -12908.98648 1735.44043   113%     -  176s
H    0     0                    -12905.55094 1735.44043   113%     -  176s
H    0     0                    -12891.11061 1735.44043   113%     -  176s
H    0     0                    -12882.63183 1735.44043   113%     -  176s
     0     0 1735.44043    0  502 -12882.632 1735.44043   113%     -  177s
H    0     0                    -12840.72201 1734.77418   114%     -  177s
H    0     0                    -12810.01033 1734.77418   114%     -  177s
H    0     0                    -12808.39933 1734.77418   114%     -  177s
     0     0 1493.39074    0  502 -12808.399 1493.39074   112%     -  184s
     0     0 1442.07767    0  673 -12808.399 1442.07767   111%     -  188s
     0     0 1432.82591    0  525 -12808.399 1432.82591   111%     -  190s
     0     0 1427.21856    0  523 -12808.399 1427.21856   111%     -  191s
     0     0 1426.44153    0  523 -12808.399 1426.44153   111%     -  191s
     0     0 1026.87587    0  545 -12808.399 1026.87587   108%     -  206s
     0     0  957.13529    0  561 -12808.399  957.13529   107%     -  210s
     0     0  786.99044    0  535 -12808.399  786.99044   106%     -  216s
     0     0  751.92438    0  550 -12808.399  751.92438   106%     -  219s
     0     0  725.19138    0  546 -12808.399  725.19138   106%     -  221s
     0     0  720.45634    0  539 -12808.399  720.45634   106%     -  222s
     0     0  715.40729    0  555 -12808.399  715.40729   106%     -  223s
     0     0  713.67320    0  557 -12808.399  713.67320   106%     -  224s
     0     0  710.63961    0  616 -12808.399  710.63961   106%     -  224s
     0     0  705.49476    0  627 -12808.399  705.49476   106%     -  225s
     0     0  701.90506    0  685 -12808.399  701.90506   105%     -  226s
     0     0  700.59320    0  775 -12808.399  700.59320   105%     -  227s
H    0     0                    -12788.80265  590.37011   105%     -  232s
     0     0  590.37011    0  606 -12788.803  590.37011   105%     -  232s
     0     0  562.20276    0  539 -12788.803  562.20276   104%     -  235s
     0     0  553.15146    0  651 -12788.803  553.15146   104%     -  236s
     0     0  548.03929    0  552 -12788.803  548.03929   104%     -  238s
     0     0  544.20900    0  550 -12788.803  544.20900   104%     -  238s
     0     0  543.27530    0  558 -12788.803  543.27530   104%     -  239s
     0     0  492.72652    0  568 -12788.803  492.72652   104%     -  244s
H    0     0                    -9970.945830  492.53567   105%     -  251s
H    0     0                    -9806.023584  492.53567   105%     -  251s
H    0     0                    -9744.156837  492.53567   105%     -  251s
H    0     0                    -9581.930931  492.53567   105%     -  252s
H    0     0                    -9523.112795  492.53567   105%     -  252s
H    0     0                    -9449.025438  492.53567   105%     -  252s
H    0     0                    -9396.530155  492.53567   105%     -  252s
H    0     0                    -9370.107652  492.53567   105%     -  252s
H    0     0                    -9354.245885  492.53567   105%     -  252s
H    0     0                    -9327.609318  492.53567   105%     -  252s
H    0     0                    -9283.297899  492.53567   105%     -  252s
     0     0  475.91463    0  567 -9283.2979  475.91463   105%     -  255s
     0     0  470.86752    0  565 -9283.2979  470.86752   105%     -  256s
     0     0  468.73240    0  568 -9283.2979  468.73240   105%     -  257s
     0     0  465.40077    0  567 -9283.2979  465.40077   105%     -  258s
     0     0  459.29900    0  576 -9283.2979  459.29900   105%     -  259s
     0     0  457.38252    0  575 -9283.2979  457.38252   105%     -  259s
     0     0  457.15039    0  577 -9283.2979  457.15039   105%     -  260s
     0     0  322.52542    0  709 -9283.2979  322.52542   103%     -  266s
     0     0  308.83449    0  713 -9283.2979  308.83449   103%     -  268s
     0     0  302.81166    0  572 -9283.2979  302.81166   103%     -  269s
     0     0  300.29178    0  555 -9283.2979  300.29178   103%     -  271s
     0     0  299.32129    0  625 -9283.2979  299.32129   103%     -  271s
     0     0  256.82778    0  644 -9283.2979  256.82778   103%     -  276s
H    0     0                    -9264.443080  256.79148   103%     -  279s
     0     0  241.75671    0  729 -9264.4431  241.75671   103%     -  282s
     0     0  238.13202    0  735 -9264.4431  238.13202   103%     -  283s
     0     0  235.05298    0  577 -9264.4431  235.05298   103%     -  285s
     0     0  231.73087    0  732 -9264.4431  231.73087   103%     -  286s
     0     0  231.22778    0  733 -9264.4431  231.22778   102%     -  286s
     0     0  213.25578    0  586 -9264.4431  213.25578   102%     -  290s
     0     0  211.07253    0  586 -9264.4431  211.07253   102%     -  291s
     0     0  209.28481    0  591 -9264.4431  209.28481   102%     -  291s
     0     0  208.41411    0  589 -9264.4431  208.41411   102%     -  292s
     0     0  179.57960    0  645 -9264.4431  179.57960   102%     -  296s
H    0     0                    -9237.804387  179.33499   102%     -  300s
H    0     0                    -9200.934031  179.33499   102%     -  301s
     0     0  169.30255    0  577 -9200.9340  169.30255   102%     -  303s
     0     0  165.93580    0  585 -9200.9340  165.93580   102%     -  304s
     0     0  164.29200    0  583 -9200.9340  164.29200   102%     -  304s
     0     0  164.08066    0  581 -9200.9340  164.08066   102%     -  305s
     0     0  105.31695    0  566 -9200.9340  105.31695   101%     -  308s
     0     0   96.95682    0  587 -9200.9340   96.95682   101%     -  310s
     0     0   95.02927    0  585 -9200.9340   95.02927   101%     -  311s
     0     0   93.74082    0  582 -9200.9340   93.74082   101%     -  311s
     0     0   69.86785    0  564 -9200.9340   69.86785   101%     -  314s
     0     0   59.84249    0  579 -9200.9340   59.84249   101%     -  315s
     0     0   53.49034    0  658 -9200.9340   53.49034   101%     -  317s
     0     0   50.16501    0  659 -9200.9340   50.16501   101%     -  318s
     0     0   49.80623    0  586 -9200.9340   49.80623   101%     -  318s
     0     0   36.58337    0  583 -9200.9340   36.58337   100%     -  321s
H    0     0                    -9194.913155   36.53269   100%     -  322s
H    0     0                    -9194.227585   36.53269   100%     -  322s
H    0     0                    -9179.781459   36.53269   100%     -  322s
     0     0   34.82678    0  587 -9179.7815   34.82678   100%     -  322s
     0     0   34.19841    0  588 -9179.7815   34.19841   100%     -  323s
     0     0   31.17434    0  674 -9179.7815   31.17434   100%     -  324s
     0     0   30.00679    0  581 -9179.7815   30.00679   100%     -  326s
     0     0   27.95732    0  584 -9179.7815   27.95732   100%     -  327s
     0     0   26.80068    0  586 -9179.7815   26.80068   100%     -  329s
     0     0   25.45338    0  576 -9179.7815   25.45338   100%     -  331s
     0     0   23.88985    0  576 -9179.7815   23.88985   100%     -  333s
H    0     0                    -9170.250979   23.33281   100%     -  408s
H    0     2                    -9049.719641   23.33281   100%     -  462s
     0     2   23.33281    0  576 -9049.7196   23.33281   100%     -  462s
     1     4 -192.59748    1  556 -9049.7196   23.33281   100%  2595  465s
     3     8 -526.20589    2  557 -9049.7196 -196.01829  97.8%  3822  472s
     7    16 -588.32571    3  561 -9049.7196 -527.02175  94.2%  5680  484s
    15    32 -634.80431    4  744 -9049.7196 -588.96984  93.5%  7384  496s
    31    49 -7739.4434    5  201 -9049.7196 -634.90474  93.0% 10587  517s
H   48    80                    -9045.429402 -634.90474  93.0% 11140  536s
H   54    80                    -9040.017223 -634.90474  93.0% 10855  536s
    79   171 -3029.4594    7  259 -9040.0172 -634.90474  93.0%  9468  561s
H  176   236                    -9033.480925 -634.90474  93.0%  5146  572s
   261   255 -5530.5954   11  240 -9033.4809 -634.90474  93.0%  3946  593s
   338   289 -3885.1046   11  208 -9033.4809 -634.90474  93.0%  3551  603s
   403   328 -5785.0824   10  157 -9033.4809 -634.90474  93.0%  3529  614s
   468   365 -4051.1017   12  203 -9033.4809 -634.90474  93.0%  3763  623s
   540   400 -6030.4016   13  198 -9033.4809 -634.90474  93.0%  3705  632s
   614   438 -5809.0260   12  233 -9033.4809 -634.90474  93.0%  3669  642s
   691   467 -8201.3608   14  123 -9033.4809 -634.90474  93.0%  3688  650s
   775   492 -8671.5582   15  198 -9033.4809 -634.90474  93.0%  3622  660s
   844   517 -8951.4643   15  145 -9033.4809 -634.90474  93.0%  3614  670s
   910   563 -6001.1276   17  331 -9033.4809 -634.90474  93.0%  3657  679s
   982   586 -3731.8352   15  306 -9033.4809 -634.90474  93.0%  3750  689s
  1021   623 -4052.4470   16  305 -9033.4809 -634.90474  93.0%  3786  698s
  1064   662 -4399.0212   18  434 -9033.4809 -634.90474  93.0%  3894  708s
  1125   696 -5887.1959   20  254 -9033.4809 -634.90474  93.0%  4000  718s
  1213   725 -7000.6250   21  118 -9033.4809 -634.90474  93.0%  3987  729s
  1288   776 -7158.6670   22  294 -9033.4809 -634.90474  93.0%  4009  740s
  1373   828 -7358.5272   25  194 -9033.4809 -634.90474  93.0%  4020  752s
  1469   862 -7835.1916   29   86 -9033.4809 -634.90474  93.0%  3997  764s
  1575   898     cutoff   34      -9033.4809 -634.90474  93.0%  4018  776s
  1656   955 -3622.2737    9  274 -9033.4809 -634.90474  93.0%  4113  787s
  1745  1028 -4080.4269   10  243 -9033.4809 -634.90474  93.0%  4184  799s
  1860  1087 -5042.1552   12  231 -9033.4809 -634.90474  93.0%  4172  811s
  1984  1128 -5741.4848   14  282 -9033.4809 -634.90474  93.0%  4174  825s
  2130  1159 -5860.5026   15  200 -9033.4809 -634.90474  93.0%  4103  839s
  2267  1176     cutoff   16      -9033.4809 -768.46884  91.5%  4089  852s
  2317  1204 -5833.1585   15  184 -9033.4809 -768.46884  91.5%  4125  866s
  2414  1260     cutoff   16      -9033.4809 -768.46884  91.5%  4123  881s
  2524  1297     cutoff   18      -9033.4809 -768.46884  91.5%  4110  896s
  2619  1344 -8729.1587   21  181 -9033.4809 -1340.1127  85.2%  4119  911s
  2748  1380 -7176.0575   24  235 -9033.4809 -1917.1725  78.8%  4126  926s
  2854  1453 -4316.3502    7  704 -9033.4809 -1917.1725  78.8%  4140  942s
  2973  1522 -5704.6084   10  241 -9033.4809 -1917.1725  78.8%  4180  958s
  3093  1584 -8030.6731    8  609 -9033.4809 -1917.1725  78.8%  4236  975s
  3257  1620 -8678.1120    9  495 -9033.4809 -1917.1725  78.8%  4239  993s
  3368  1660 -8832.3266   10  629 -9033.4809 -1917.1725  78.8%  4227 1012s
  3522  1724     cutoff   12      -9033.4809 -1917.1725  78.8%  4237 1033s
  3692  1814 -6623.5811   10  538 -9033.4809 -1917.1725  78.8%  4257 1054s
  3893  1901 -6270.7132   10  535 -9033.4809 -1917.1725  78.8%  4269 1074s
  4067  1979     cutoff   12      -9033.4809 -2654.3134  70.6%  4338 1098s
  4268  2046 -7783.7367   11  513 -9033.4809 -2654.3134  70.6%  4362 1121s
  4517  2111 -7518.1849   11  251 -9033.4809 -2671.5375  70.4%  4361 1145s
  4714  2208 -8781.8389   14  242 -9033.4809 -2744.9653  69.6%  4397 1168s
  4925  2284     cutoff   10      -9033.4809 -2986.6674  66.9%  4420 1194s
  5127  2285 -3549.4859   10  576 -9033.4809 -3147.5986  65.2%  4416 1387s
  5129  2286 -7057.2089   21  327 -9033.4809 -3147.5986  65.2%  4415 1455s
  5130  2287 -5801.0011   13  603 -9033.4809 -3147.5986  65.2%  4414 1490s
  5131  2288 -5146.6632   10  425 -9033.4809 -3147.5986  65.2%  4413 1512s
  5132  2288 -7106.3237   28  548 -9033.4809 -3147.5986  65.2%  4412 1526s
  5133  2289 -8579.8230   32  611 -9033.4809 -3147.5986  65.2%  4411 1538s
  5134  2290 -6894.4755   20  628 -9033.4809 -3147.5986  65.2%  4410 1547s
  5135  2290 -3870.2866    9  640 -9033.4809 -3147.5986  65.2%  4410 1554s
  5136  2291 -8117.1817   17  641 -9033.4809 -3147.5986  65.2%  4409 1558s
  5137  2292 -7278.4592   24  569 -9033.4809 -3147.5986  65.2%  4408 1563s
  5138  2292 -8874.3574   35  630 -9033.4809 -3147.5986  65.2%  4407 1566s
  5139  2293 -7937.0549   23  563 -9033.4809 -3147.5986  65.2%  4406 1571s
  5140  2294 -3650.1741    9  651 -9033.4809 -3147.5986  65.2%  4405 1583s
  5141  2294 -8723.8812   10  565 -9033.4809 -3147.5986  65.2%  4404 1589s
  5142  2295 -6570.4890   11  582 -9033.4809 -3147.5986  65.2%  4404 1595s
  5143  2296 -7345.3630   14  585 -9033.4809 -3147.5986  65.2%  4403 1604s
  5144  2296 -6715.8408   23  579 -9033.4809 -3147.5986  65.2%  4402 1609s
  5145  2297 -7243.8629   15  601 -9033.4809 -3147.5986  65.2%  4401 1618s
  5146  2298 -6909.7143   23  573 -9033.4809 -3147.5986  65.2%  4400 1622s
  5147  2298 -7573.9783   25  587 -9033.4809 -3147.5986  65.2%  4399 1625s
  5149  2300 -8470.9160   29  644 -9033.4809 -3147.5986  65.2%  4398 1638s
  5150  2300 -5963.6892   19  594 -9033.4809 -3147.5986  65.2%  4397 1642s
  5151  2301 -8896.6264   37  592 -9033.4809 -3147.5986  65.2%  4396 1647s
  5152  2302 -5391.6555   13  601 -9033.4809 -3147.5986  65.2%  4395 1658s
  5153  2302 -4894.2988   14  597 -9033.4809 -3147.5986  65.2%  4394 1663s
  5154  2303 -6160.5276   19  674 -9033.4809 -3147.5986  65.2%  4393 1671s
  5155  2304 -7936.5117   23  608 -9033.4809 -3147.5986  65.2%  4392 1675s
  5156  2304 -6009.9021   20  585 -9033.4809 -3147.5986  65.2%  4392 1680s
  5157  2305 -3922.6979   12  585 -9033.4809 -3147.5986  65.2%  4391 1750s
  5158  2306 -7985.3649   18  585 -9033.4809 -3147.5986  65.2%  4390 1789s
  5159  2309 -3147.5986   12  573 -9033.4809 -3147.5986  65.2%  4442 1802s
  5161  2313 -3147.5986   13  600 -9033.4809 -3147.5986  65.2%  4443 1819s
  5165  2319 -3147.5986   14  648 -9033.4809 -3147.5986  65.2%  4448 1836s
  5173  2333 -3147.5986   15  717 -9033.4809 -3147.5986  65.2%  4453 1855s
  5189  2342 -3147.5986   16  617 -9033.4809 -3147.5986  65.2%  4481 1892s
  5205  2365 -3147.5986   17  394 -9033.4809 -3147.5986  65.2%  4507 1916s
  5236  2420 -3147.5986   18  459 -9033.4809 -3147.5986  65.2%  4522 1947s
  5346  2406 -3878.4810   21  442 -9033.4809 -3147.5986  65.2%  4506 1960s
  5423  2385 -4641.2184   21  349 -9033.4809 -3147.5986  65.2%  4493 1974s
  5489  2379 -4423.1126   20  474 -9033.4809 -3147.5986  65.2%  4480 1995s
  5544  2378 -4416.7372   22  538 -9033.4809 -3147.5986  65.2%  4493 2009s
  5594  2378 -5530.0631   22  518 -9033.4809 -3147.5986  65.2%  4522 2022s
  5637  2381 -6128.3335   24  407 -9033.4809 -3147.5986  65.2%  4555 2036s
  5680  2397 -6377.3653   23  504 -9033.4809 -3147.5986  65.2%  4563 2056s
  5736  2415 -7051.2697   24  391 -9033.4809 -3147.5986  65.2%  4596 2074s
  5816  2406 -7336.5331   25  357 -9033.4809 -3147.5986  65.2%  4602 2095s
  5890  2384 -7565.7306   27  371 -9033.4809 -3147.5986  65.2%  4599 2107s
  5974  2369     cutoff   29      -9033.4809 -3147.5986  65.2%  4595 2119s
  6033  2364     cutoff   28      -9033.4809 -3147.5986  65.2%  4587 2137s
  6102  2346 -5312.3284   21  562 -9033.4809 -3147.5986  65.2%  4582 2151s
  6168  2342 -5827.7142   22  453 -9033.4809 -3147.5986  65.2%  4579 2163s
  6219  2340 -7924.3605   23  466 -9033.4809 -3147.5986  65.2%  4580 2176s
  6290  2343 -8322.1092   24  572 -9033.4809 -3147.5986  65.2%  4584 2192s
  6364  2337     cutoff   34      -9033.4809 -3147.5986  65.2%  4579 2206s
  6435  2332 -8539.4250   25   64 -9033.4809 -3147.5986  65.2%  4576 2222s
  6536  2313 -7800.1766   21  231 -9033.4809 -3147.5986  65.2%  4563 2238s
  6620  2315     cutoff   22      -9033.4809 -3147.5986  65.2%  4553 2254s
  6715  2309 -5947.7229   23  524 -9033.4809 -3147.5986  65.2%  4552 2274s
  6830  2281 -6194.5603   24  388 -9033.4809 -3147.5986  65.2%  4535 2292s
  6942  2252     cutoff   28      -9033.4809 -3147.5986  65.2%  4536 2309s
  6984  2260 -6536.0283   27  361 -9033.4809 -3147.5986  65.2%  4554 2325s
  7025  2275 -6753.5645   29  305 -9033.4809 -3147.5986  65.2%  4558 2345s
  7098  2279 -7912.1413   33  233 -9033.4809 -3147.5986  65.2%  4556 2365s
  7199  2285 -8644.0320   38  251 -9033.4809 -3147.5986  65.2%  4547 2386s
  7304  2282 -6558.4396   23  402 -9033.4809 -3147.5986  65.2%  4541 2405s
  7393  2286 -7197.4975   26  264 -9033.4809 -3147.5986  65.2%  4550 2425s
  7513  2283 -8050.7248   30  250 -9033.4809 -3147.5986  65.2%  4556 2448s
  7676  2234 -8570.3641   37  312 -9033.4809 -3487.0246  61.4%  4534 2471s
  7827  2232 -7970.3498   19  247 -9033.4809 -3660.5543  59.5%  4541 2495s
  7960  2242 -8816.1370   22  223 -9033.4809 -4122.9820  54.4%  4554 2521s
  8122  2222 -5886.7098   21  461 -9033.4809 -4122.9820  54.4%  4557 2546s
  8322  2193 -8206.5030   25  199 -9033.4809 -4122.9820  54.4%  4553 2572s
  8537  2143 -7472.3122   26  206 -9033.4809 -4750.9620  47.4%  4537 2601s
  8750  2079     cutoff   28      -9033.4809 -4750.9620  47.4%  4534 2629s
  8897  2049 -7334.9927   29  208 -9033.4809 -4992.3180  44.7%  4522 2657s
  9104  2015 -7473.0325   30  190 -9033.4809 -4992.3180  44.7%  4514 2688s
  9318  1992     cutoff   36      -9033.4809 -4992.3180  44.7%  4507 2719s
  9574  1926 infeasible   38      -9033.4809 -4992.3180  44.7%  4492 2749s
  9803  1917 -7606.9131   28  542 -9033.4809 -5707.7092  36.8%  4468 2783s
 10047  1915 -8038.5249   31  541 -9033.4809 -5707.7092  36.8%  4452 2815s
 10336  1840     cutoff   25      -9033.4809 -5964.4513  34.0%  4431 2853s
 10662  1744     cutoff   32      -9033.4809 -6016.0124  33.4%  4398 2889s
 10971  1695 -8613.0559   23  428 -9033.4809 -6333.9879  29.9%  4391 2926s
 11291  1632 -8185.4694   34  346 -9033.4809 -6350.0531  29.7%  4374 2962s
 11677  1496 -8975.7421   47  308 -9033.4809 -6578.0267  27.2%  4352 3002s
 12089  1337 -8432.2284   30  502 -9033.4809 -6793.3359  24.8%  4334 3040s
 12584  1304 -8232.5278   36  273 -9033.4809 -6948.2656  23.1%  4293 3083s
 13091  1241     cutoff   29      -9033.4809 -7169.6135  20.6%  4253 3124s
 13618  1191 -8787.5708   30  155 -9033.4809 -7308.9956  19.1%  4206 3158s
 13762  1131     cutoff   31      -9033.4809 -7308.9956  19.1%  4196 3198s
 13960  1000 -8985.6760   28  278 -9033.4809 -7462.0956  17.4%  4170 3241s
 14514   697 -8471.5807   34  349 -9033.4809 -7604.7078  15.8%  4107 3284s
 15285   121 -8213.3847   32  438 -9033.4809 -7908.6298  12.5%  4011 3322s
 16182     0     cutoff   34      -9033.4809 -8232.8080  8.86%  3866 3334s

Cutting planes:
  Projected implied bound: 96
  MIR: 1139
  Mixing: 1
  Flow cover: 2117
  Zero half: 11
  RLT: 35
  Relax-and-lift: 177

Explored 16412 nodes (63097405 simplex iterations) in 3334.97 seconds (9315.70 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -9033.48 -9040.02 -9045.43 ... -9237.8
No other solutions better than -9033.48

Optimal solution found (tolerance 1.00e-06)
Best objective -9.033480924887e+03, best bound -9.033480924887e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3335.01s
  Master Objective (UB) = -9033.48, θ = 118024.68
  Upper Bound (UB) = -9033.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118024.68
  [DEBUG]   ✓ Scenario 0: θ = 118024.68 ≤ Q = 118024.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118024.68 ≤ Q = 118024.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118024.68 ≤ Q = 118024.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118024.68 ≤ Q = 118024.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118024.68 ≤ Q = 118024.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x385555d8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x385555d8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.307725e+13
Presolve removed 2583 rows and 1876 columns
Presolve time: 0.00s
Presolved: 510 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6933595.0559
Variable types: 347 continuous, 166 integer (166 binary)

Root relaxation: objective -1.229061e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -122906.09    0  122 6933595.06 -122906.09   102%     -    0s
H    0     0                    -87504.69046 -122906.09  40.5%     -    0s
H    0     0                    -88870.81088 -122906.09  38.3%     -    0s
     0     0 -92308.678    0   88 -88870.811 -92308.678  3.87%     -    0s
H    0     0                    -90063.80669 -92298.595  2.48%     -    0s
     0     0 -92041.278    0   87 -90063.807 -92041.278  2.20%     -    0s
     0     0 -92012.667    0   86 -90063.807 -92012.667  2.16%     -    0s
     0     0 -91999.802    0   87 -90063.807 -91999.802  2.15%     -    0s
H    0     0                    -90376.32968 -91999.802  1.80%     -    0s
     0     0 -91895.321    0   85 -90376.330 -91895.321  1.68%     -    0s
     0     0 -91894.802    0   85 -90376.330 -91894.802  1.68%     -    0s
H    0     0                    -90401.90640 -91894.697  1.65%     -    0s
     0     2 -91894.697    0   85 -90401.906 -91894.697  1.65%     -    0s
H   31    57                    -90412.66310 -91748.821  1.48%  11.8    0s
H   33    57                    -90561.06361 -91748.821  1.31%  11.7    0s
H   47    50                    -91351.12370 -91706.497  0.39%   9.9    0s
H  186    31                    -91519.23561 -91696.463  0.19%   7.1    0s
*  281    22              21    -91529.92361 -91646.721  0.13%   5.7    0s

Cutting planes:
  Gomory: 26
  Implied bound: 3
  MIR: 156

Explored 342 nodes (2202 simplex iterations) in 0.11 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -91529.9 -91351.1 -90561.1 ... 6.9336e+06
No other solutions better than -91529.9

Optimal solution found (tolerance 1.00e-06)
Best objective -9.152992361273e+04, best bound -9.152992361273e+04, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 117504.95
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91529.92
  [DEBUG]   S×d_nominal = 209034.88
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 209034.88 + -91529.92 = 117504.95
  [DEBUG]   Current θ from Master = 118024.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 519.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9553.21
  Lower Bound (LB) = -9215.45
  Gap (UB-LB) = 181.9707, Absolute Gap = 181.9707, Relative Gap = 0.020144
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 9
Total Time: 13098.27s
Converged: True
Final Lower Bound: -9215.4516
Final Upper Bound: -9033.4809
Final Gap: 181.970698
Number of Critical Scenarios: 9
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 4, 6] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 5 customers  Mode 1: 11 customers  Mode 2: 34 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 9
Start Time: 2026-01-04 01:15:03
End Time: 2026-01-04 04:53:21
Total Time: 13098.27s
Optimal Value: -9215.45
Lower Bound: -9215.45
Upper Bound: -9033.48
Gap: 181.970698
Plants Opened: {0: [1], 1: [2], 2: [0]} (3 plants)
DCs Opened: [1, 4, 6] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed31_LD_gamma20_20260104_045321.csv

Total Execution Time: 13098.71 seconds
End Time: 2026-01-04 04:53:21

All tasks completed successfully!

