
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 15
DI Scenario: Mixed
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed15.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
  Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
  Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=903, max=1768
  DC capacity (MC): min=414, max=867

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.05, max=34.96, count=80
  Deviation (μ̂): min=4.07, max=9.96

Costs:
  Plant fixed cost: min=5260, max=9753
  DC fixed cost: min=3497, max=5949
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.335', '1.783'] (k=0.713)
    Product 2: ['1.000', '1.424', '2.029'] (k=0.873)
  MD:
    Product 0: ['1.000', '1.250', '1.561'] (k=0.549)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.287', '1.656'] (k=0.622)
  LD:
    Product 0: ['1.000', '1.113', '1.238'] (k=0.263)
    Product 1: ['1.000', '1.016', '1.032'] (k=0.039)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
  Mixed:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x914adfc2
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.12s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -275591.6030
Found heuristic solution: objective -194606.4683

Root relaxation: objective 1.273263e+05, 4933 iterations, 0.33 seconds (0.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 127326.276    0  488 -194606.47 127326.276   165%     -    0s
H    0     0                    -190113.0011 127326.276   167%     -    0s
H    0     0                    -182945.2676 115543.077   163%     -    1s
     0     0 115543.077    0  801 -182945.27 115543.077   163%     -    1s
H    0     0                    -180810.3891 115296.558   164%     -    1s
     0     0 115296.558    0  739 -180810.39 115296.558   164%     -    1s
     0     0 115276.943    0  739 -180810.39 115276.943   164%     -    1s
     0     0 110047.625    0  951 -180810.39 110047.625   161%     -    3s
H    0     0                    -160627.4455 109824.821   168%     -    3s
     0     0 109824.821    0  963 -160627.45 109824.821   168%     -    3s
     0     0 109791.409    0  958 -160627.45 109791.409   168%     -    3s
     0     0 109786.079    0  950 -160627.45 109786.079   168%     -    3s
     0     0 109785.132    0  953 -160627.45 109785.132   168%     -    3s
     0     0 105189.565    0 1082 -160627.45 105189.565   165%     -    5s
H    0     0                    -144564.5046 104687.351   172%     -    6s
     0     0 104687.351    0 1071 -144564.50 104687.351   172%     -    6s
     0     0 104581.125    0 1075 -144564.50 104581.125   172%     -    6s
H    0     0                    -144397.1873 104561.303   172%     -    6s
     0     0 104561.303    0 1086 -144397.19 104561.303   172%     -    6s
     0     0 104557.003    0 1085 -144397.19 104557.003   172%     -    6s
H    0     0                    -144186.4748 104557.003   173%     -    7s
H    0     0                    -121024.1656 104557.003   186%     -    7s
H    0     0                    -120327.6575 104557.003   187%     -    7s
H    0     0                    -120089.4365 104557.003   187%     -    7s
H    0     0                    -118250.0213 104557.003   188%     -    7s
H    0     0                    -117501.3949 104557.003   189%     -    7s
H    0     0                    32264.560766 104557.003   224%     -    7s
     0     0 101645.407    0 1069 32264.5608 101645.407   215%     -    9s
     0     0 101254.907    0 1117 32264.5608 101254.907   214%     -   10s
H    0     0                    32862.676745 101182.875   208%     -   10s
     0     0 101182.875    0 1124 32862.6767 101182.875   208%     -   10s
H    0     0                    33393.582718 101169.201   203%     -   10s
H    0     0                    36190.853604 101169.201   180%     -   10s
     0     0 101169.201    0 1126 36190.8536 101169.201   180%     -   10s
H    0     0                    37521.375551 101167.077   170%     -   10s
     0     0 101167.077    0 1122 37521.3756 101167.077   170%     -   10s
H    0     0                    37589.868120 101167.077   169%     -   11s
H    0     0                    38328.392443 99548.1410   160%     -   12s
H    0     0                    38695.502938 99548.1410   157%     -   12s
H    0     0                    38762.224150 99548.1410   157%     -   12s
H    0     0                    38763.995506 99548.1410   157%     -   12s
     0     0 99548.1410    0 1116 38763.9955 99548.1410   157%     -   12s
     0     0 99289.3814    0 1128 38763.9955 99289.3814   156%     -   13s
     0     0 99245.2776    0 1116 38763.9955 99245.2776   156%     -   13s
     0     0 99238.5630    0 1138 38763.9955 99238.5630   156%     -   13s
H    0     0                    40596.617083 98093.3003   142%     -   15s
H    0     0                    44387.035546 98093.3003   121%     -   15s
H    0     0                    45762.637070 98093.3003   114%     -   15s
H    0     0                    45864.385176 98093.3003   114%     -   15s
H    0     0                    45888.904639 98093.3003   114%     -   15s
     0     0 98093.3003    0 1030 45888.9046 98093.3003   114%     -   15s
     0     0 97839.8481    0 1176 45888.9046 97839.8481   113%     -   16s
     0     0 97758.4115    0 1198 45888.9046 97758.4115   113%     -   16s
     0     0 97744.9018    0 1193 45888.9046 97744.9018   113%     -   16s
     0     0 96033.5953    0 1047 45888.9046 96033.5953   109%     -   18s
     0     0 95734.9490    0  986 45888.9046 95734.9490   109%     -   19s
     0     0 95642.2762    0  985 45888.9046 95642.2762   108%     -   20s
     0     0 95631.4262    0 1107 45888.9046 95631.4262   108%     -   20s
     0     0 94728.5848    0 1043 45888.9046 94728.5848   106%     -   22s
     0     0 94543.5123    0 1064 45888.9046 94543.5123   106%     -   22s
     0     0 94502.9143    0 1060 45888.9046 94502.9143   106%     -   23s
     0     0 94490.8351    0 1063 45888.9046 94490.8351   106%     -   23s
     0     0 93921.6583    0  995 45888.9046 93921.6583   105%     -   25s
     0     0 93763.2175    0 1044 45888.9046 93763.2175   104%     -   25s
     0     0 93723.0048    0 1045 45888.9046 93723.0048   104%     -   26s
     0     0 93713.9014    0 1071 45888.9046 93713.9014   104%     -   26s
     0     0 92657.9867    0 1001 45888.9046 92657.9867   102%     -   28s
     0     0 92429.9333    0 1036 45888.9046 92429.9333   101%     -   30s
     0     0 92371.7487    0 1073 45888.9046 92371.7487   101%     -   30s
     0     0 92358.2169    0 1075 45888.9046 92358.2169   101%     -   30s
H    0     0                    46044.266208 88594.5239  92.4%     -   34s
H    0     0                    46079.259510 88594.5239  92.3%     -   34s
H    0     0                    46184.907872 88594.5239  91.8%     -   34s
H    0     0                    46264.318419 88594.5239  91.5%     -   34s
     0     0 88594.5239    0  965 46264.3184 88594.5239  91.5%     -   34s
     0     0 88128.2768    0 1026 46264.3184 88128.2768  90.5%     -   35s
     0     0 87966.1262    0 1024 46264.3184 87966.1262  90.1%     -   36s
     0     0 87933.9810    0 1024 46264.3184 87933.9810  90.1%     -   36s
     0     0 87926.3721    0 1043 46264.3184 87926.3721  90.1%     -   36s
     0     0 81943.1327    0  799 46264.3184 81943.1327  77.1%     -   40s
     0     0 80967.0598    0  865 46264.3184 80967.0598  75.0%     -   41s
     0     0 80724.4771    0  766 46264.3184 80724.4771  74.5%     -   42s
     0     0 80639.2495    0  873 46264.3184 80639.2495  74.3%     -   42s
     0     0 80603.5337    0  869 46264.3184 80603.5337  74.2%     -   43s
     0     0 77684.2118    0  853 46264.3184 77684.2118  67.9%     -   45s
     0     0 76970.7085    0  847 46264.3184 76970.7085  66.4%     -   46s
     0     0 76752.2242    0  831 46264.3184 76752.2242  65.9%     -   47s
H    0     0                    46521.795756 76706.1760  64.9%     -   47s
     0     0 76706.1760    0  833 46521.7958 76706.1760  64.9%     -   47s
     0     0 76686.0103    0  799 46521.7958 76686.0103  64.8%     -   48s
     0     0 75924.8725    0  780 46521.7958 75924.8725  63.2%     -   49s
     0     0 75699.7371    0  818 46521.7958 75699.7371  62.7%     -   50s
     0     0 75629.1211    0  773 46521.7958 75629.1211  62.6%     -   50s
     0     0 75578.6452    0  837 46521.7958 75578.6452  62.5%     -   51s
     0     0 75554.6792    0  825 46521.7958 75554.6792  62.4%     -   51s
     0     0 75014.7011    0  781 46521.7958 75014.7011  61.2%     -   52s
     0     0 74862.3184    0  805 46521.7958 74862.3184  60.9%     -   53s
     0     0 74831.1587    0  799 46521.7958 74831.1587  60.9%     -   53s
H    0     0                    46559.453360 74470.5653  59.9%     -   55s
     0     0 74470.5653    0  874 46559.4534 74470.5653  59.9%     -   55s
     0     0 74470.2278    0  874 46559.4534 74470.2278  59.9%     -   55s
     0     2 74470.2278    0  874 46559.4534 74470.2278  59.9%     -   59s
     1     4 74156.6609    1  758 46559.4534 74470.2278  59.9%  1968   60s
    15    32 72800.8529    4  516 46559.4534 73358.2885  57.6%  2778   66s
    63    96 72257.0611    6  308 46559.4534 72747.2440  56.2%  2409   70s
H  129   235                    46645.018496 72747.0592  56.0%  1604   72s
   403   451 63366.3419   14  235 46645.0185 72747.0592  56.0%   891   75s
H  508   546                    50282.679835 72747.0592  44.7%   831   77s
H  545   627                    50515.994558 72747.0592  44.0%   806   78s
H  571   627                    52978.536158 72747.0592  37.3%   785   78s
H  577   627                    53669.767769 72747.0592  35.5%   787   78s
   760   741 59815.1058   24  190 53669.7678 72747.0592  35.5%   694   81s
H  774   741                    53839.672973 72747.0592  35.1%   685   81s
H  803   741                    54059.950174 72747.0592  34.6%   678   81s
H  942   913                    54283.804650 72016.3222  32.7%   656   83s
  1202  1186 57254.4956   38  151 54283.8046 72014.1836  32.7%   581   85s
  1915  1657 68609.0551    7  264 54283.8046 71770.3213  32.2%   461   90s
H 2172  1749                    54309.657520 71770.3213  32.2%   462   93s
  2182  1802 60231.5538   10  299 54309.6575 71770.3213  32.2%   462   95s
H 2485  1950                    54430.963991 71378.7320  31.1%   459   98s
  2642  1972 54683.3590   28  263 54430.9640 71378.7320  31.1%   456  101s
  3016  2312 60281.1748   11  166 54430.9640 70905.3661  30.3%   447  106s
  3576  2636     cutoff   14      54430.9640 70428.0022  29.4%   433  110s
  3935  2792 60465.3424   28  874 54430.9640 70428.0022  29.4%   435  127s
  3950  2802 62561.4875   10  436 54430.9640 70428.0022  29.4%   433  130s
  3967  2813 58741.0765   18  493 54430.9640 70353.5317  29.3%   432  135s
H 4340  2859                    54652.478368 65124.1337  19.2%   425  139s
H 4342  2724                    54852.948884 65124.1337  18.7%   425  139s
H 4454  2583                    54869.239646 65124.1337  18.7%   419  139s
  4558  2587 61818.4000   18  279 54869.2396 63912.8512  16.5%   413  140s
H 4967  2430                    55005.986779 63590.4484  15.6%   392  141s
H 4980  2311                    55121.141831 63590.4484  15.4%   392  141s
H 5133  2174                    55206.008748 63590.4484  15.2%   384  142s
H 5171  2058                    55449.088502 63590.4484  14.7%   382  142s
H 5327  1930                    55602.070206 62299.0978  12.0%   377  142s
* 5490  1776              63    56215.277894 61687.5013  9.73%   371  143s
H 5547  1677                    56344.713860 61687.5013  9.48%   368  143s
  5895  1546 57259.9886   24  220 56344.7139 61104.2170  8.45%   356  145s
H 7795   447                    56472.140486 57574.6849  1.95%   295  148s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  Projected implied bound: 14
  MIR: 115
  Flow cover: 390
  RLT: 1
  Relax-and-lift: 59

Explored 8215 nodes (2417420 simplex iterations) in 148.55 seconds (181.41 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 56472.1 56344.7 56215.3 ... 54852.9

Optimal solution found (tolerance 1.00e-06)
Best objective 5.647214048618e+04, best bound 5.647214048618e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 148.56s
  Master Objective (UB) = 56472.14, θ = 213603.42
  Upper Bound (UB) = 56472.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 213603.42
  [DEBUG]   ✓ Scenario 0: θ = 213603.42 ≤ Q = 213603.42 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7cd1ad2e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7cd1ad2e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.458933e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 7064166.1510
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.575799e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157579.90    0  123 7064166.15 -157579.90   102%     -    0s
H    0     0                    -122575.5094 -157579.90  28.6%     -    0s
H    0     0                    -122872.1130 -157579.90  28.2%     -    0s
*    0     0               0    -126813.2059 -126813.21  0.00%     -    0s

Cutting planes:
  Gomory: 8
  MIR: 198

Explored 1 nodes (387 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -126813 -122872 -122576 ... 1.45893e+13
No other solutions better than -126813

Optimal solution found (tolerance 1.00e-06)
Best objective -1.268132058900e+05, best bound -1.268132058900e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 180465.45
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126813.21
  [DEBUG]   S×d_nominal = 307278.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307278.66 + -126813.21 = 180465.45
  [DEBUG]   Current θ from Master = 213603.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33137.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23334.17
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 33137.9737, Absolute Gap = 33137.9737, Relative Gap = 0.586802
  Not converged yet (gap = 33137.97 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x97df98cd
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 23334.2 (0.02s)
Loaded MIP start from previous solve with objective 23334.2

Presolve removed 14231 rows and 5770 columns
Presolve time: 0.48s
Presolved: 17732 rows, 8970 columns, 98128 nonzeros
Variable types: 6711 continuous, 2259 integer (2259 binary)

Root relaxation: objective 7.153925e+04, 11258 iterations, 2.10 seconds (2.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 71539.2520    0  238 23334.1668 71539.2520   207%     -    2s
H    0     0                    24239.208430 71539.2520   195%     -    2s
H    0     0                    24571.041218 71539.2520   191%     -    3s
H    0     0                    24721.105616 71539.2520   189%     -    3s
H    0     0                    24950.478245 71539.2520   187%     -    3s
H    0     0                    25126.161339 71539.2520   185%     -    3s
H    0     0                    25238.389915 71539.2520   183%     -    3s
H    0     0                    25310.534011 71539.2520   183%     -    3s
H    0     0                    25377.619296 71539.2520   182%     -    3s
H    0     0                    25469.788528 71539.2520   181%     -    3s
H    0     0                    25523.628302 71539.2520   180%     -    3s
H    0     0                    25714.210035 71539.2520   178%     -    3s
H    0     0                    25973.888007 71539.2520   175%     -    3s
H    0     0                    26302.849573 71539.2520   172%     -    3s
H    0     0                    27471.905952 71539.2520   160%     -    3s
H    0     0                    27483.657635 71539.2520   160%     -    3s
H    0     0                    27663.830692 71539.2520   159%     -    3s
     0     0 61524.6492    0  487 27663.8307 61524.6492   122%     -    4s
H    0     0                    27858.446872 61521.2463   121%     -    5s
     0     0 61218.7962    0  501 27858.4469 61218.7962   120%     -    5s
     0     0 61211.6118    0  495 27858.4469 61211.6118   120%     -    5s
     0     0 61207.1925    0  492 27858.4469 61207.1925   120%     -    5s
     0     0 61206.5275    0  497 27858.4469 61206.5275   120%     -    5s
     0     0 54794.7133    0  525 27858.4469 54794.7133  96.7%     -    7s
H    0     0                    28667.688797 54791.3513  91.1%     -    7s
H    0     0                    28826.223691 54791.3513  90.1%     -    8s
H    0     0                    30083.399553 54791.3513  82.1%     -    8s
     0     0 54396.6076    0  524 30083.3996 54396.6076  80.8%     -    8s
     0     0 54293.9067    0  529 30083.3996 54293.9067  80.5%     -    8s
     0     0 54207.6880    0  543 30083.3996 54207.6880  80.2%     -    8s
     0     0 54157.1766    0  558 30083.3996 54157.1766  80.0%     -    9s
     0     0 54152.7897    0  558 30083.3996 54152.7897  80.0%     -    9s
     0     0 54151.6405    0  561 30083.3996 54151.6405  80.0%     -    9s
H    0     0                    31253.137894 54151.6405  73.3%     -   10s
H    0     0                    31393.179382 54151.6405  72.5%     -   10s
H    0     0                    32648.331889 54151.6405  65.9%     -   10s
H    0     0                    32834.110366 54151.6405  64.9%     -   10s
     0     0 50580.5302    0  351 32834.1104 50580.5302  54.0%     -   12s
     0     0 50015.1151    0  370 32834.1104 50015.1151  52.3%     -   13s
     0     0 49895.5397    0  465 32834.1104 49895.5397  52.0%     -   13s
     0     0 49869.1865    0  390 32834.1104 49869.1865  51.9%     -   13s
     0     0 49862.1938    0  401 32834.1104 49862.1938  51.9%     -   14s
     0     0 49859.7602    0  405 32834.1104 49859.7602  51.9%     -   14s
H    0     0                    32862.507625 49859.7602  51.7%     -   15s
H    0     0                    32866.062075 49859.7602  51.7%     -   15s
H    0     0                    32889.950248 49859.7602  51.6%     -   15s
     0     0 48587.3759    0  444 32889.9502 48587.3759  47.7%     -   17s
H    0     0                    32913.504887 48586.1181  47.6%     -   18s
H    0     0                    32918.536187 48586.1181  47.6%     -   18s
     0     0 48121.7586    0  463 32918.5362 48121.7586  46.2%     -   19s
     0     0 47977.7391    0  476 32918.5362 47977.7391  45.7%     -   19s
     0     0 47874.7454    0  565 32918.5362 47874.7454  45.4%     -   20s
     0     0 47841.1974    0  459 32918.5362 47841.1974  45.3%     -   20s
     0     0 47833.7121    0  485 32918.5362 47833.7121  45.3%     -   20s
H    0     0                    32946.083987 47830.7170  45.2%     -   20s
     0     0 47830.7170    0  475 32946.0840 47830.7170  45.2%     -   20s
     0     0 47449.9802    0  542 32946.0840 47449.9802  44.0%     -   22s
     0     0 47301.9474    0  521 32946.0840 47301.9474  43.6%     -   22s
     0     0 47280.6245    0  636 32946.0840 47280.6245  43.5%     -   23s
     0     0 47272.8694    0  630 32946.0840 47272.8694  43.5%     -   23s
     0     0 47268.2968    0  654 32946.0840 47268.2968  43.5%     -   23s
     0     0 47022.8939    0  471 32946.0840 47022.8939  42.7%     -   24s
     0     0 46959.4736    0  471 32946.0840 46959.4736  42.5%     -   25s
     0     0 46938.2092    0  470 32946.0840 46938.2092  42.5%     -   25s
     0     0 46932.1160    0  481 32946.0840 46932.1160  42.5%     -   26s
     0     0 46815.2949    0  456 32946.0840 46815.2949  42.1%     -   27s
     0     0 46777.5455    0  454 32946.0840 46777.5455  42.0%     -   27s
     0     0 46769.8362    0  453 32946.0840 46769.8362  42.0%     -   27s
     0     0 46763.3125    0  447 32946.0840 46763.3125  41.9%     -   27s
     0     0 46688.4012    0  451 32946.0840 46688.4012  41.7%     -   28s
H    0     0                    32947.421146 46644.9843  41.6%     -   29s
     0     0 46644.9843    0  444 32947.4211 46644.9843  41.6%     -   29s
     0     0 46638.7800    0  448 32947.4211 46638.7800  41.6%     -   29s
     0     0 46597.4760    0  455 32947.4211 46597.4760  41.4%     -   30s
     0     0 46591.2336    0  452 32947.4211 46591.2336  41.4%     -   30s
     0     0 46568.1198    0  528 32947.4211 46568.1198  41.3%     -   31s
     0     0 46561.9162    0  531 32947.4211 46561.9162  41.3%     -   32s
     0     0 46547.6411    0  468 32947.4211 46547.6411  41.3%     -   32s
     0     0 46546.6935    0  468 32947.4211 46546.6935  41.3%     -   33s
     0     2 46546.4956    0  468 32947.4211 46546.4956  41.3%     -   38s
     7    16 45432.4997    3  340 32947.4211 46426.6948  40.9%   893   40s
    63    96 43838.0731    6  327 32947.4211 45536.8755  38.2%  1128   45s
   134   186 42373.3055    8  317 32947.4211 45530.2280  38.2%   950   50s
H  234   227                    32973.296146 45530.2280  38.1%   797   51s
   554   518 35570.7192   15  289 32973.2961 45075.9944  36.7%   562   55s
H  583   518                    32975.728012 45075.9944  36.7%   548   55s
H  755   667                    33051.005387 44649.6307  35.1%   479   57s
  1038   901 33728.9874   26  242 33051.0054 44505.9367  34.7%   404   60s
  1433  1264 40990.9748   10  286 33051.0054 43906.4855  32.8%   352   65s
  2156  1946 34006.4812   31   99 33051.0054 43833.6524  32.6%   291   70s
  2787  2310 35788.7925   10  341 33051.0054 43444.2935  31.4%   269   75s
  3436  2568 38875.2410    8  233 33051.0054 43081.3945  30.3%   257   80s
  4039  2840     cutoff   11      33051.0054 42710.8905  29.2%   263   87s
  4462  2963 35276.4703   73  468 33051.0054 42252.0394  27.8%   258   98s
  4464  2964 34964.8315   38  128 33051.0054 42252.0394  27.8%   258  100s
  4467  2966 33452.9327   16  412 33051.0054 42252.0394  27.8%   258  105s
  4475  2972 33251.2285   19  440 33051.0054 42252.0394  27.8%   257  110s
  4485  2978 38956.3444   12  476 33051.0054 42252.0394  27.8%   257  116s
  4489  2981 37024.7046   49  487 33051.0054 42252.0394  27.8%   257  120s
  4494  2984 37693.5877   23  486 33051.0054 42252.0394  27.8%   256  127s
  4496  2989 42252.0394   10  447 33051.0054 42252.0394  27.8%   263  132s
  4502  2999 42252.0394   12  418 33051.0054 42252.0394  27.8%   263  136s
  4558  3048 41015.2987   15  389 33051.0054 42252.0394  27.8%   273  140s
  4699  3103 39956.0409   18  306 33051.0054 42252.0394  27.8%   288  145s
H 4741  2961                    33066.412910 42252.0394  27.8%   290  147s
  4888  2974 38068.6359   20  250 33066.4129 42054.1907  27.2%   295  150s
  5084  2954 36170.8585   24  190 33066.4129 41479.2646  25.4%   299  155s
  5474  2888 34442.5839   20  283 33066.4129 40716.4523  23.1%   301  161s
  5825  2792 38430.4399   20  299 33066.4129 40262.6619  21.8%   300  165s
  6310  2544 33841.9206   21  255 33066.4129 38945.7682  17.8%   303  171s
  7273  2236 35287.2693   23  303 33066.4129 37166.9619  12.4%   289  176s
*10317  1312              55    33069.310379 33288.0537  0.66%   217  178s
*10373  1159              59    33075.302101 33276.4430  0.61%   216  178s
H10819   882                    33132.081796 33252.8595  0.36%   207  178s
 11924    10 33136.4543   66    4 33132.0818 33165.0740  0.10%   189  180s

Cutting planes:
  Gomory: 2
  MIR: 164
  Flow cover: 734
  RLT: 5
  Relax-and-lift: 70

Explored 12142 nodes (2297780 simplex iterations) in 181.49 seconds (275.64 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 33132.1 33075.3 33069.3 ... 32918.5

Optimal solution found (tolerance 1.00e-06)
Best objective 3.313208179590e+04, best bound 3.313208179590e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 181.50s
  Master Objective (UB) = 33132.08, θ = 168354.84
  Upper Bound (UB) = 33132.08

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 168354.84
  [DEBUG]   ✓ Scenario 0: θ = 168354.84 ≤ Q = 168354.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 168354.84 ≤ Q = 168354.84 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1c02a120
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1c02a120
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.528078e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 7763950.4078
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.506106e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -150610.58    0  131 7763950.41 -150610.58   102%     -    0s
H    0     0                    -112725.0085 -150610.58  33.6%     -    0s
H    0     0                    -132829.4554 -150610.58  13.4%     -    0s
H    0     0                    -133540.5089 -139995.70  4.83%     -    0s
H    0     0                    -136386.1844 -139995.70  2.65%     -    0s
     0     0 -139995.70    0   90 -136386.18 -139995.70  2.65%     -    0s
     0     0 -139407.19    0   84 -136386.18 -139407.19  2.22%     -    0s
H    0     0                    -136631.0642 -139407.19  2.03%     -    0s
H    0     0                    -137100.4455 -139407.19  1.68%     -    0s
     0     0 -139238.10    0   59 -137100.45 -139238.10  1.56%     -    0s
H    0     0                    -138866.0229 -139223.83  0.26%     -    0s
     0     0 -139179.90    0   52 -138866.02 -139179.90  0.23%     -    0s
     0     0 -139063.74    0   33 -138866.02 -139063.74  0.14%     -    0s
     0     0 -139042.68    0   28 -138866.02 -139042.68  0.13%     -    0s
     0     0 -139019.20    0   26 -138866.02 -139019.20  0.11%     -    0s
     0     0 -139003.19    0   24 -138866.02 -139003.19  0.10%     -    0s
     0     0 -138988.62    0   23 -138866.02 -138988.62  0.09%     -    0s
     0     0 -138976.81    0   22 -138866.02 -138976.81  0.08%     -    0s
     0     0 -138966.59    0   21 -138866.02 -138966.59  0.07%     -    0s
     0     0 -138961.18    0   18 -138866.02 -138961.18  0.07%     -    0s
     0     0 -138960.16    0   18 -138866.02 -138960.16  0.07%     -    0s
     0     0 -138937.06    0   15 -138866.02 -138937.06  0.05%     -    0s
     0     0 -138909.85    0   10 -138866.02 -138909.85  0.03%     -    0s
     0     0 -138909.49    0    9 -138866.02 -138909.49  0.03%     -    0s
     0     0 -138906.59    0   10 -138866.02 -138906.59  0.03%     -    0s
     0     0 -138869.48    0    5 -138866.02 -138869.48  0.00%     -    0s

Cutting planes:
  Gomory: 14
  Implied bound: 5
  MIR: 54
  RLT: 71
  Relax-and-lift: 6

Explored 1 nodes (747 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -138866 -137100 -136631 ... 1.52808e+13
No other solutions better than -138866

Optimal solution found (tolerance 1.00e-06)
Best objective -1.388660228992e+05, best bound -1.388660228992e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 142211.66
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138866.02
  [DEBUG]   S×d_nominal = 281077.69
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 281077.69 + -138866.02 = 142211.66
  [DEBUG]   Current θ from Master = 168354.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 26143.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6988.91
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 9797.9150, Absolute Gap = 9797.9150, Relative Gap = 0.295723
  Not converged yet (gap = 9797.92 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xdf9f4666
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 6988.91 (0.03s)
MIP start from previous solve produced solution with objective 6988.91 (0.03s)
Loaded MIP start from previous solve with objective 6988.91

Presolve removed 21310 rows and 8660 columns
Presolve time: 0.66s
Presolved: 25943 rows, 12320 columns, 159749 nonzeros
Variable types: 10061 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   45906    5.6455862e+04   0.000000e+00   2.255742e+05      5s
Concurrent spin time: 0.10s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   18985    5.7630921e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 5.763092e+04, 18985 iterations, 5.90 seconds (7.80 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57630.9213    0  126 6988.90778 57630.9213   725%     -    6s
H    0     0                    20695.233311 57630.9213   178%     -    6s
H    0     0                    21114.123899 57630.9213   173%     -    6s
H    0     0                    26836.942850 57630.9213   115%     -    7s
H    0     0                    27065.667395 57630.9213   113%     -    7s
     0     0 52409.5915    0  270 27065.6674 52409.5915  93.6%     -   10s
     0     0 51695.7570    0  292 27065.6674 51695.7570  91.0%     -   11s
     0     0 51678.3789    0  302 27065.6674 51678.3789  90.9%     -   11s
     0     0 51668.7901    0  300 27065.6674 51668.7901  90.9%     -   11s
     0     0 51667.7465    0  302 27065.6674 51667.7465  90.9%     -   12s
     0     0 49485.8835    0  291 27065.6674 49485.8835  82.8%     -   14s
H    0     0                    29644.689156 49485.8835  66.9%     -   14s
H    0     0                    29760.897137 49485.8835  66.3%     -   14s
H    0     0                    29767.156858 49485.8835  66.2%     -   14s
H    0     0                    29861.071051 49485.8835  65.7%     -   14s
     0     0 48612.0169    0  309 29861.0711 48612.0169  62.8%     -   15s
     0     0 48358.3214    0  305 29861.0711 48358.3214  61.9%     -   16s
     0     0 48314.9447    0  315 29861.0711 48314.9447  61.8%     -   16s
     0     0 48285.1022    0  309 29861.0711 48285.1022  61.7%     -   16s
     0     0 48266.5185    0  309 29861.0711 48266.5185  61.6%     -   16s
     0     0 48265.7937    0  311 29861.0711 48265.7937  61.6%     -   16s
H    0     0                    29911.006623 46972.4866  57.0%     -   20s
     0     0 46972.4866    0  391 29911.0066 46972.4866  57.0%     -   20s
H    0     0                    29930.326802 46696.6549  56.0%     -   22s
H    0     0                    29932.031743 46696.6549  56.0%     -   22s
     0     0 46696.6549    0  339 29932.0317 46696.6549  56.0%     -   22s
     0     0 46576.8456    0  384 29932.0317 46576.8456  55.6%     -   23s
     0     0 46418.6661    0  357 29932.0317 46418.6661  55.1%     -   23s
     0     0 46401.2018    0  354 29932.0317 46401.2018  55.0%     -   23s
     0     0 46389.7100    0  359 29932.0317 46389.7100  55.0%     -   24s
     0     0 46387.8111    0  364 29932.0317 46387.8111  55.0%     -   24s
     0     0 46387.4482    0  407 29932.0317 46387.4482  55.0%     -   24s
H    0     0                    29934.774430 45640.4046  52.5%     -   28s
H    0     0                    29959.387070 45640.4046  52.3%     -   28s
     0     0 45640.4046    0  387 29959.3871 45640.4046  52.3%     -   28s
     0     0 45387.1425    0  435 29959.3871 45387.1425  51.5%     -   30s
     0     0 45314.0962    0  450 29959.3871 45314.0962  51.3%     -   31s
     0     0 45252.2382    0  450 29959.3871 45252.2382  51.0%     -   31s
     0     0 45235.9873    0  459 29959.3871 45235.9873  51.0%     -   32s
     0     0 45230.9195    0  459 29959.3871 45230.9195  51.0%     -   32s
     0     0 45228.9270    0  461 29959.3871 45228.9270  51.0%     -   32s
     0     0 45227.7701    0  461 29959.3871 45227.7701  51.0%     -   32s
     0     0 45085.9208    0  406 29959.3871 45085.9208  50.5%     -   34s
     0     0 45050.9562    0  460 29959.3871 45050.9562  50.4%     -   34s
     0     0 45027.9046    0  446 29959.3871 45027.9046  50.3%     -   35s
     0     0 45023.8755    0  459 29959.3871 45023.8755  50.3%     -   35s
     0     0 45009.8411    0  455 29959.3871 45009.8411  50.2%     -   35s
     0     0 45002.8113    0  459 29959.3871 45002.8113  50.2%     -   36s
     0     0 45001.2707    0  464 29959.3871 45001.2707  50.2%     -   36s
     0     0 44910.3637    0  411 29959.3871 44910.3637  49.9%     -   37s
     0     0 44875.2212    0  416 29959.3871 44875.2212  49.8%     -   37s
     0     0 44873.2899    0  467 29959.3871 44873.2899  49.8%     -   37s
     0     0 44872.3491    0  422 29959.3871 44872.3491  49.8%     -   37s
     0     0 44806.2415    0  415 29959.3871 44806.2415  49.6%     -   38s
     0     0 44795.0911    0  429 29959.3871 44795.0911  49.5%     -   39s
     0     0 44771.0738    0  423 29959.3871 44771.0738  49.4%     -   39s
     0     0 44769.1338    0  427 29959.3871 44769.1338  49.4%     -   39s
     0     0 44766.7564    0  431 29959.3871 44766.7564  49.4%     -   39s
     0     0 44766.5526    0  480 29959.3871 44766.5526  49.4%     -   39s
     0     0 44721.2062    0  435 29959.3871 44721.2062  49.3%     -   40s
     0     0 44708.9846    0  427 29959.3871 44708.9846  49.2%     -   41s
     0     0 44707.2021    0  437 29959.3871 44707.2021  49.2%     -   41s
     0     0 44705.7260    0  435 29959.3871 44705.7260  49.2%     -   41s
     0     0 44672.0351    0  433 29959.3871 44672.0351  49.1%     -   42s
     0     0 44657.9691    0  434 29959.3871 44657.9691  49.1%     -   42s
     0     0 44653.9344    0  438 29959.3871 44653.9344  49.0%     -   42s
     0     0 44652.5884    0  441 29959.3871 44652.5884  49.0%     -   43s
     0     0 44636.6091    0  430 29959.3871 44636.6091  49.0%     -   43s
H    0     0                    29964.792623 44633.4441  49.0%     -   44s
H    0     0                    29970.907704 44633.4441  48.9%     -   44s
     0     0 44633.4441    0  428 29970.9077 44633.4441  48.9%     -   44s
     0     0 44631.4978    0  483 29970.9077 44631.4978  48.9%     -   44s
     0     0 44631.2314    0  490 29970.9077 44631.2314  48.9%     -   44s
     0     0 44627.2318    0  437 29970.9077 44627.2318  48.9%     -   45s
     0     0 44625.8923    0  440 29970.9077 44625.8923  48.9%     -   45s
     0     0 44621.7579    0  435 29970.9077 44621.7579  48.9%     -   45s
     0     0 44620.0821    0  492 29970.9077 44620.0821  48.9%     -   46s
     0     0 44619.5165    0  491 29970.9077 44619.5165  48.9%     -   47s
     0     0 44617.4063    0  491 29970.9077 44617.4063  48.9%     -   47s
     0     2 44617.4063    0  491 29970.9077 44617.4063  48.9%     -   55s
     7    16 44353.1569    3  485 29970.9077 44539.1679  48.6%  1459   61s
    31    64 43705.3081    5  472 29970.9077 44226.4721  47.6%  2726   67s
H   38    64                    29972.906740 44226.4721  47.6%  2549   67s
H   45    64                    29995.603295 44226.4721  47.4%  2368   67s
    95   130 43630.9924    7  465 29995.6033 43714.0778  45.7%  2094   72s
H   98   130                    30014.980712 43714.0778  45.6%  2043   72s
   129   215 43629.1494    8  466 30014.9807 43714.0778  45.6%  1652   76s
H  214   270                    30030.089804 43714.0778  45.6%  1551   79s
H  221   270                    30112.692049 43714.0778  45.2%  1551   79s
   275   325 42574.7096   11  481 30112.6920 43714.0778  45.2%  1481   82s
   338   380 36965.7979   11  433 30112.6920 43714.0778  45.2%  1494   85s
   482   501 41577.3008   12  413 30112.6920 43714.0778  45.2%  1390   91s
   543   564 42025.6139   13  471 30112.6920 43714.0778  45.2%  1431   95s
   696   686 41980.7609   14  481 30112.6920 43714.0778  45.2%  1321  102s
   852   797 41211.8143   15  409 30112.6920 43714.0778  45.2%  1239  107s
H  856   797                    30139.391761 43714.0778  45.0%  1239  107s
   992   932 39456.1357   16  386 30139.3918 43662.3253  44.9%  1190  112s
  1079   996 39787.6305   17  367 30139.3918 43662.3253  44.9%  1164  115s
  1259  1133 39326.7317   20  355 30139.3918 43634.8252  44.8%  1124  121s
  1480  1247 37581.3809   24  274 30139.3918 43610.0047  44.7%  1071  128s
H 1505  1247                    30155.027224 43564.0470  44.5%  1065  128s
  1573  1338 36170.6169   26  193 30155.0272 43528.9008  44.4%  1059  131s
H 1718  1396                    30187.090938 43528.9008  44.2%  1025  134s
  1802  1516 33810.6538   28  149 30187.0909 43386.7964  43.7%  1010  137s
  2124  1737 40101.2507    8  288 30187.0909 43229.9575  43.2%   955  143s
  2291  1840 38449.5234   10  273 30187.0909 43125.1103  42.9%   930  146s
H 2292  1840                    30193.116085 43125.1103  42.8%   929  146s
H 2304  1839                    30196.959264 43125.1103  42.8%   929  146s
H 2316  1838                    30215.343262 43125.1103  42.7%   932  146s
H 2332  1837                    30221.566711 43125.1103  42.7%   927  146s
  2654  1958 37307.2205   10  237 30221.5667 43125.1103  42.7%   882  153s
  2719  2030 34546.0045   11  215 30221.5667 43085.9402  42.6%   887  156s
  2845  2081 36024.4137   11  235 30221.5667 43000.1855  42.3%   896  160s
  3053  2192 37332.7946   12  269 30221.5667 43000.1855  42.3%   888  167s
  3164  2270 35866.9952   13  251 30221.5667 42992.3515  42.3%   880  171s
  3300  2381 33786.1706   15  216 30221.5667 42992.3515  42.3%   885  175s
  3674  2569 34087.5419   13  205 30221.5667 42708.4262  41.3%   877  184s
  3873  2669 32497.3392   15  296 30221.5667 42686.2486  41.2%   874  188s
  4048  2782 41055.8805   10  313 30221.5667 42686.2486  41.2%   880  194s
  4295  2834 39562.1576   15  250 30221.5667 42605.1154  41.0%   874  199s
  4488  2913 33581.6999   20  176 30221.5667 42560.2946  40.8%   864  204s
  4680  2948 34794.2794   12  241 30221.5667 42559.4613  40.8%   868  209s
  4896  3012 31012.3085   14  189 30221.5667 42539.4683  40.8%   874  215s
  5116  3114 31121.6360   10  222 30221.5667 42318.5160  40.0%   877  220s
  5366  3115 31863.5420   45  491 30221.5667 42025.4019  39.1%   878  234s
  5368  3116 31731.4590   20  126 30221.5667 42025.4019  39.1%   878  240s
  5369  3117 40934.5417    9  353 30221.5667 42025.4019  39.1%   878  246s
  5371  3118 31448.4736   54  428 30221.5667 42025.4019  39.1%   877  250s
  5376  3122 35111.3583   33  425 30221.5667 42025.4019  39.1%   876  255s
  5379  3124 32738.1600   25  452 30221.5667 42025.4019  39.1%   876  260s
  5384  3127 31338.8625   50  426 30221.5667 42025.4019  39.1%   875  266s
  5389  3130 36230.4406   25  530 30221.5667 42025.4019  39.1%   874  271s
  5392  3132 31405.7709   17  442 30221.5667 42025.4019  39.1%   874  275s
  5397  3136 33556.8896   22  452 30221.5667 42025.4019  39.1%   873  280s
  5400  3138 31839.5760   42  454 30221.5667 42025.4019  39.1%   873  285s
  5403  3140 38305.9308   19  562 30221.5667 42025.4019  39.1%   872  296s
  5404  3140 38896.1171   16  562 30221.5667 42025.4019  39.1%   872  304s
  5405  3144 42025.4019   16  498 30221.5667 42025.4019  39.1%   884  309s
  5407  3147 42025.4019   17  430 30221.5667 42025.4019  39.1%   885  314s
  5411  3154 42025.4019   18  379 30221.5667 42025.4019  39.1%   887  317s
  5419  3167 42025.4019   19  325 30221.5667 42025.4019  39.1%   890  321s
  5435  3194 40800.0455   20  299 30221.5667 42025.4019  39.1%   899  325s
  5499  3257 36705.4525   22  295 30221.5667 42025.4019  39.1%   923  332s
  5561  3275 36527.7116   23  312 30221.5667 42025.4019  39.1%   927  335s
  5713  3261 36102.6283   25  300 30221.5667 41536.4635  37.4%   934  341s
  5848  3262 34683.0157   27  262 30221.5667 40738.4325  34.8%   941  347s
  5932  3246 34294.4896   28  244 30221.5667 40377.2652  33.6%   939  350s
  6053  3229 32759.7353   29  209 30221.5667 40358.1352  33.5%   942  357s
  6095  3223     cutoff   29      30221.5667 40358.1352  33.5%   942  363s
  6145  3216 31548.9813   30  221 30221.5667 39865.6226  31.9%   944  367s
  6251  3201     cutoff   31      30221.5667 39865.6226  31.9%   943  373s
  6315  3178     cutoff   32      30221.5667 39232.6287  29.8%   941  376s
  6425  3156 36426.4099   24  236 30221.5667 39229.8420  29.8%   941  382s
  6476  3136 36087.9479   25  241 30221.5667 39229.8420  29.8%   941  387s
  6596  3112 31937.2578   27  190 30221.5667 39229.8420  29.8%   938  392s
  6662  3090     cutoff   28      30221.5667 39229.8420  29.8%   935  399s
  6741  3059 32308.1496   28  230 30221.5667 37522.9546  24.2%   937  401s
  6866  3035 34963.4290   26  267 30221.5667 37522.9546  24.2%   938  408s
  6925  3003 34945.8211   27  238 30221.5667 37522.9546  24.2%   936  412s
  7005  2976 34264.4499   28  229 30221.5667 37181.7372  23.0%   934  417s
  7091  2971 33498.1808   29  172 30221.5667 36598.2291  21.1%   932  421s
  7172  2946 32872.8052   30  166 30221.5667 36519.8569  20.8%   930  425s
  7404  2898 31934.7408   32  132 30221.5667 36438.3521  20.6%   919  434s
  7554  2863     cutoff   33      30221.5667 36438.3521  20.6%   913  440s
* 7575  2698              91    30326.877972 36438.3521  20.2%   912  440s
* 7729  2496              84    30489.226597 35980.8870  18.0%   904  440s
  7739  2469 31364.0786   28  302 30489.2266 35357.5096  16.0%   903  445s
* 8014  2235             102    30884.582448 34825.2797  12.8%   891  445s
  8333  2113 infeasible   26      30884.5824 34005.0335  10.1%   874  452s
H 8346  1974                    31476.875923 34005.0335  8.03%   873  452s
  8847  1638 infeasible   49      31476.8759 33730.6081  7.16%   834  455s
* 9384  1339              63    31531.973434 33411.5685  5.96%   788  457s
* 9418  1205              58    31571.673793 33411.5685  5.83%   786  457s
*10028   647              58    31588.176290 31664.7772  0.24%   739  457s

Cutting planes:
  Learned: 1
  Gomory: 5
  MIR: 215
  Flow cover: 805
  RLT: 9
  Relax-and-lift: 58

Explored 10081 nodes (7477210 simplex iterations) in 457.83 seconds (814.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 31588.2 31571.7 31532 ... 30197

Optimal solution found (tolerance 1.00e-06)
Best objective 3.158817628999e+04, best bound 3.158817628999e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 457.84s
  Master Objective (UB) = 31588.18, θ = 174709.60
  Upper Bound (UB) = 31588.18

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 174709.60
  [DEBUG]   ✓ Scenario 0: θ = 174709.60 ≤ Q = 174709.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 174709.60 ≤ Q = 174709.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 174709.60 ≤ Q = 174709.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4f6d7b50
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4f6d7b50
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.402487e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6808385.2092
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.607292e+05, 264 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160729.15    0  126 6808385.21 -160729.15   102%     -    0s
H    0     0                    -125505.8286 -160729.15  28.1%     -    0s
H    0     0                    -126274.7479 -160729.15  27.3%     -    0s
H    0     0                    -133289.7946 -160729.15  20.6%     -    0s
H    0     0                    -137424.4755 -160729.15  17.0%     -    0s
     0     0 -147423.67    0   85 -137424.48 -147423.67  7.28%     -    0s
H    0     0                    -142056.5450 -147405.17  3.77%     -    0s
H    0     0                    -145109.8477 -147405.17  1.58%     -    0s
H    0     0                    -145437.6178 -147405.17  1.35%     -    0s
     0     0 -146980.85    0   79 -145437.62 -146980.85  1.06%     -    0s
     0     0 -146968.60    0   79 -145437.62 -146968.60  1.05%     -    0s
     0     0 -146357.83    0   62 -145437.62 -146357.83  0.63%     -    0s
H    0     0                    -145703.9785 -146316.32  0.42%     -    0s
     0     0 -146147.88    0   45 -145703.98 -146147.88  0.30%     -    0s
     0     0 -146144.61    0   44 -145703.98 -146144.61  0.30%     -    0s
     0     0 -146099.39    0   42 -145703.98 -146099.39  0.27%     -    0s
     0     0 -146093.08    0   42 -145703.98 -146093.08  0.27%     -    0s
     0     0 -146081.18    0   40 -145703.98 -146081.18  0.26%     -    0s
     0     0 -146071.81    0   39 -145703.98 -146071.81  0.25%     -    0s
     0     0 -146066.71    0   39 -145703.98 -146066.71  0.25%     -    0s
     0     0 -146066.46    0   39 -145703.98 -146066.46  0.25%     -    0s
     0     0 -145813.44    0   17 -145703.98 -145813.44  0.08%     -    0s
     0     0 -145812.02    0   16 -145703.98 -145812.02  0.07%     -    0s
     0     0 -145793.78    0   16 -145703.98 -145793.78  0.06%     -    0s
     0     0 -145739.22    0    7 -145703.98 -145739.22  0.02%     -    0s
     0     0 -145733.32    0    9 -145703.98 -145733.32  0.02%     -    0s
     0     0 -145732.88    0    8 -145703.98 -145732.88  0.02%     -    0s
     0     0     cutoff    0      -145703.98 -145703.98  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 3
  MIR: 5
  Flow cover: 2
  RLT: 2
  Relax-and-lift: 2

Explored 1 nodes (773 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145704 -145661 -145586 ... 6.80839e+06
No other solutions better than -145704

Optimal solution found (tolerance 1.00e-06)
Best objective -1.457039784846e+05, best bound -1.457039784846e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 152566.23
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145703.98
  [DEBUG]   S×d_nominal = 298270.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298270.21 + -145703.98 = 152566.23
  [DEBUG]   Current θ from Master = 174709.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22143.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9444.81
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 8254.0095, Absolute Gap = 8254.0095, Relative Gap = 0.261301
  Not converged yet (gap = 8254.01 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x73a9d74d
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 9444.81 (0.04s)
Loaded MIP start from previous solve with objective 9444.81

Presolve removed 28400 rows and 11540 columns
Presolve time: 1.68s
Presolved: 34143 rows, 15680 columns, 211199 nonzeros
Variable types: 13421 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34143 rows, 15680 columns, 211199 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32336    1.6254318e+04   0.000000e+00   1.376496e+07      5s
   44405    5.1387866e+04   0.000000e+00   4.407278e+06     10s
Concurrent spin time: 0.44s

Solved with dual simplex

Root relaxation: objective 5.742105e+04, 21514 iterations, 9.52 seconds (12.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57421.0538    0  197 9444.81092 57421.0538   508%     -   11s
H    0     0                    22208.774385 57421.0538   159%     -   11s
H    0     0                    25496.080354 57421.0538   125%     -   11s
H    0     0                    25500.173466 57421.0538   125%     -   11s
H    0     0                    25811.794414 57421.0538   122%     -   11s
H    0     0                    26115.119879 57421.0538   120%     -   11s
H    0     0                    26601.251138 57421.0538   116%     -   11s
H    0     0                    26743.549932 57421.0538   115%     -   11s
H    0     0                    26743.559900 57421.0538   115%     -   11s
H    0     0                    27047.005710 57421.0538   112%     -   13s
     0     0 50678.0008    0  248 27047.0057 50678.0008  87.4%     -   17s
H    0     0                    27568.316822 50678.0008  83.8%     -   18s
H    0     0                    27584.162543 50678.0008  83.7%     -   18s
     0     0 50677.0929    0  249 27584.1625 50677.0929  83.7%     -   20s
     0     0 50677.0929    0  256 27584.1625 50677.0929  83.7%     -   21s
     0     0 50677.0929    0  257 27584.1625 50677.0929  83.7%     -   22s
     0     0 50677.0929    0  257 27584.1625 50677.0929  83.7%     -   22s
     0     0 48692.4354    0  337 27584.1625 48692.4354  76.5%     -   26s
     0     0 48286.1755    0  334 27584.1625 48286.1755  75.1%     -   28s
H    0     0                    27704.678159 48160.5093  73.8%     -   29s
H    0     0                    27720.523880 48160.5093  73.7%     -   29s
H    0     0                    28237.518778 48160.5093  70.6%     -   29s
     0     0 48160.5093    0  333 28237.5188 48160.5093  70.6%     -   29s
     0     0 48106.1534    0  333 28237.5188 48106.1534  70.4%     -   29s
     0     0 48069.9690    0  339 28237.5188 48069.9690  70.2%     -   30s
     0     0 48061.1172    0  341 28237.5188 48061.1172  70.2%     -   30s
     0     0 48059.3539    0  344 28237.5188 48059.3539  70.2%     -   30s
     0     0 48058.3967    0  343 28237.5188 48058.3967  70.2%     -   30s
H    0     0                    28361.638687 48058.3967  69.4%     -   34s
H    0     0                    28398.492294 46714.9286  64.5%     -   37s
H    0     0                    28444.341968 46714.9286  64.2%     -   37s
     0     0 46714.9286    0  323 28444.3420 46714.9286  64.2%     -   37s
H    0     0                    28567.505385 46714.8419  63.5%     -   37s
     0     0 46229.1500    0  357 28567.5054 46229.1500  61.8%     -   40s
     0     0 46116.5040    0  357 28567.5054 46116.5040  61.4%     -   42s
     0     0 46032.0006    0  403 28567.5054 46032.0006  61.1%     -   43s
     0     0 46010.2446    0  376 28567.5054 46010.2446  61.1%     -   43s
     0     0 45994.9706    0  385 28567.5054 45994.9706  61.0%     -   44s
     0     0 45991.3997    0  385 28567.5054 45991.3997  61.0%     -   44s
     0     0 45988.5409    0  383 28567.5054 45988.5409  61.0%     -   44s
     0     0 45988.3487    0  384 28567.5054 45988.3487  61.0%     -   44s
     0     0 45550.5680    0  452 28567.5054 45550.5680  59.4%     -   51s
     0     0 45361.7464    0  410 28567.5054 45361.7464  58.8%     -   53s
     0     0 45275.6459    0  425 28567.5054 45275.6459  58.5%     -   54s
     0     0 45250.2523    0  426 28567.5054 45250.2523  58.4%     -   55s
     0     0 45222.0749    0  428 28567.5054 45222.0749  58.3%     -   56s
     0     0 45212.6665    0  441 28567.5054 45212.6665  58.3%     -   56s
     0     0 45207.2176    0  484 28567.5054 45207.2176  58.2%     -   57s
     0     0 45201.8309    0  441 28567.5054 45201.8309  58.2%     -   57s
     0     0 45198.2984    0  441 28567.5054 45198.2984  58.2%     -   57s
     0     0 45196.8216    0  441 28567.5054 45196.8216  58.2%     -   57s
     0     0 45196.0499    0  491 28567.5054 45196.0499  58.2%     -   57s
     0     0 45140.2416    0  482 28567.5054 45140.2416  58.0%     -   60s
     0     0 45119.5023    0  436 28567.5054 45119.5023  57.9%     -   61s
     0     0 45113.3846    0  436 28567.5054 45113.3846  57.9%     -   61s
     0     0 45111.2503    0  435 28567.5054 45111.2503  57.9%     -   61s
     0     0 45110.8255    0  433 28567.5054 45110.8255  57.9%     -   62s
     0     0 45001.7488    0  477 28567.5054 45001.7488  57.5%     -   63s
     0     0 44937.8050    0  476 28567.5054 44937.8050  57.3%     -   65s
     0     0 44916.0914    0  488 28567.5054 44916.0914  57.2%     -   65s
     0     0 44910.2325    0  485 28567.5054 44910.2325  57.2%     -   66s
     0     0 44908.4174    0  490 28567.5054 44908.4174  57.2%     -   66s
     0     0 44907.5072    0  489 28567.5054 44907.5072  57.2%     -   66s
     0     0 44844.4039    0  487 28567.5054 44844.4039  57.0%     -   68s
     0     0 44837.5900    0  489 28567.5054 44837.5900  57.0%     -   69s
     0     0 44836.4487    0  491 28567.5054 44836.4487  56.9%     -   69s
     0     0 44814.6176    0  489 28567.5054 44814.6176  56.9%     -   70s
H    0     0                    28633.214234 44814.4551  56.5%     -   70s
     0     0 44807.6276    0  446 28633.2142 44807.6276  56.5%     -   71s
     0     0 44804.9003    0  451 28633.2142 44804.9003  56.5%     -   71s
     0     0 44804.5441    0  452 28633.2142 44804.5441  56.5%     -   71s
     0     0 44743.5692    0  479 28633.2142 44743.5692  56.3%     -   72s
     0     0 44739.9557    0  483 28633.2142 44739.9557  56.3%     -   73s
     0     0 44738.1486    0  475 28633.2142 44738.1486  56.2%     -   74s
     0     0 44736.5613    0  490 28633.2142 44736.5613  56.2%     -   74s
     0     0 44729.6272    0  496 28633.2142 44729.6272  56.2%     -   75s
H    0     0                    28724.235116 44729.2337  55.7%     -   75s
     0     0 44723.1253    0  491 28724.2351 44723.1253  55.7%     -   76s
     0     0 44721.2917    0  490 28724.2351 44721.2917  55.7%     -   76s
     0     0 44720.9786    0  491 28724.2351 44720.9786  55.7%     -   76s
     0     0 44714.3251    0  443 28724.2351 44714.3251  55.7%     -   77s
H    0     0                    29007.864828 44714.2136  54.1%     -   77s
     0     0 44709.9997    0  491 29007.8648 44709.9997  54.1%     -   78s
     0     0 44708.8333    0  486 29007.8648 44708.8333  54.1%     -   78s
     0     0 44704.7371    0  551 29007.8648 44704.7371  54.1%     -   79s
     0     0 44704.5905    0  551 29007.8648 44704.5905  54.1%     -   80s
H    0     0                    29037.631211 44704.5905  54.0%     -   92s
     0     2 44704.5905    0  551 29037.6312 44704.5905  54.0%     -   93s
     1     4 44675.5489    1  539 29037.6312 44704.5905  54.0%   273   95s
     7    16 44373.7547    3  516 29037.6312 44590.4842  53.6%  1734  100s
    31    64 43886.1945    5  484 29037.6312 44186.0623  52.2%  3836  108s
    63    96 43726.3621    6  528 29037.6312 43916.0418  51.2%  3117  110s
   193   248 43289.0978    9  462 29037.6312 43915.8405  51.2%  1527  119s
   247   297 43299.0149    9  404 29037.6312 43915.8405  51.2%  1470  123s
H  280   297                    29049.824345 43915.8405  51.2%  1430  123s
   296   361 43224.8346   10  416 29049.8243 43915.8405  51.2%  1443  127s
   360   395 43191.1258   11  459 29049.8243 43915.8405  51.2%  1435  130s
H  368   395                    29164.359220 43915.8405  50.6%  1430  130s
   394   458 42932.9180   12  446 29164.3592 43915.8405  50.6%  1399  136s
   494   532 42854.7709   13  460 29164.3592 43915.8405  50.6%  1334  142s
H  533   532                    29293.532512 43915.8405  49.9%  1336  142s
   537   587 41695.4678   13  362 29293.5325 43915.8405  49.9%  1339  146s
H  583   587                    29325.733288 43915.8405  49.8%  1310  146s
   596   663 42526.6860   14  453 29325.7333 43915.8405  49.8%  1293  150s
   774   771 40960.3528   15  385 29325.7333 43915.8405  49.8%  1158  158s
   830   814 42073.8937   16  455 29325.7333 43859.6004  49.6%  1140  163s
   879   858 41162.4345   18  466 29325.7333 43859.6004  49.6%  1167  167s
   935   920 41039.1255   19  465 29325.7333 43859.6004  49.6%  1182  171s
  1007   991 40892.2877   21  447 29325.7333 43859.6004  49.6%  1162  176s
  1082  1084 40625.2284   22  393 29325.7333 43805.8527  49.4%  1140  181s
  1220  1156 40694.1862   23  399 29325.7333 43805.8527  49.4%  1090  187s
H 1236  1156                    29335.633879 43805.8527  49.3%  1085  187s
  1263  1256 40519.4137   24  400 29335.6339 43725.8674  49.1%  1079  191s
  1497  1516 40321.5300   28  391 29335.6339 43725.8674  49.1%  1010  198s
  1635  1603 40077.5984   32  425 29335.6339 43725.8674  49.1%   978  202s
  1736  1722 40050.4492   33  427 29335.6339 43725.8674  49.1%   977  206s
  1858  1861 39519.2109   36  327 29335.6339 43725.8674  49.1%   964  211s
  2097  2085 39302.2444   40  384 29335.6339 43725.8674  49.1%   927  218s
  2257  2239 38999.3934   45  324 29335.6339 43577.6893  48.5%   905  223s
  2435  2434 38428.5450   47  307 29335.6339 43577.6893  48.5%   888  226s
  2656  2611 38606.3942   49  303 29335.6339 43577.6893  48.5%   854  231s
  2869  2825 37837.3024   56  213 29335.6339 43577.6893  48.5%   831  236s
  3416  3370 34752.9823   69  274 29335.6339 43577.6893  48.5%   769  244s
  3734  3696     cutoff   76      29335.6339 43577.6893  48.5%   738  250s
H 4185  3805                    29563.483730 43577.6893  47.4%   694  254s
H 4197  3804                    29620.494229 43577.6893  47.1%   693  254s
H 4201  3801                    29712.516908 43577.6893  46.7%   693  254s
H 4302  3796                    29750.050105 43577.6893  46.5%   685  254s
  4309  3999 33540.6783   88  167 29750.0501 43577.6893  46.5%   685  260s
  4632  4141 37267.1513   51  318 29750.0501 43577.6893  46.5%   669  266s
H 4898  4127                    29894.845270 43577.6893  45.8%   666  270s
  4899  4128 42766.4121    7  551 29894.8453 43577.6893  45.8%   666  290s
  4901  4129 41666.1545   15  197 29894.8453 43577.6893  45.8%   666  301s
H 4901  3922                    29919.567296 43577.6893  45.6%   666  309s
  4902  3923 34262.2699   90  373 29919.5673 43577.6893  45.6%   665  311s
  4903  3924 36377.4667   63  394 29919.5673 43577.6893  45.6%   665  315s
  4905  3925 40519.4011   25  447 29919.5673 43577.6893  45.6%   665  321s
  4907  3926 31979.6970   44  490 29919.5673 43577.6893  45.6%   665  325s
  4912  3930 32860.3528   31  490 29919.5673 43577.6893  45.6%   664  331s
  4913  3930 41320.6687   14  440 29919.5673 43577.6893  45.6%   664  335s
  4917  3933 41205.9451   18  441 29919.5673 43577.6893  45.6%   663  340s
  4920  3935 36731.1100   62  562 29919.5673 43577.6893  45.6%   663  345s
H 4921  3739                    29930.507194 43577.6893  45.6%   663  349s
  4922  3739 40429.3530   37  510 29930.5072 43577.6893  45.6%   663  351s
  4925  3741 40534.3280   13  520 29930.5072 43577.6893  45.6%   662  356s
  4928  3743 41666.1545   15  524 29930.5072 43577.6893  45.6%   662  362s
  4931  3745 31748.4934   61  512 29930.5072 43577.6893  45.6%   661  368s
  4933  3747 42281.1008   16  538 29930.5072 43577.6893  45.6%   661  370s
H 4933  3559                    30145.836978 43577.6893  44.6%   661  372s
H 4933  3380                    30147.160081 43577.6893  44.5%   661  372s
  4935  3381 33684.2808   50  517 30147.1601 43577.6893  44.5%   661  376s
  4937  3382 36253.7004   67  525 30147.1601 43577.6893  44.5%   661  380s
  4939  3384 37577.8948   10  518 30147.1601 43577.6893  44.5%   660  396s
  4940  3384 42187.4796   13  518 30147.1601 43577.6893  44.5%   660  416s
  4941  3388 43577.6893   15  494 30147.1601 43577.6893  44.5%   676  422s
  4943  3391 43577.6893   16  493 30147.1601 43577.6893  44.5%   677  431s
  4947  3398 43562.1952   17  558 30147.1601 43577.6893  44.5%   678  447s
  4955  3411 43468.9613   18  538 30147.1601 43561.1113  44.5%   685  459s
  4971  3424 42187.0868   19  480 30147.1601 43468.7069  44.2%   700  473s
  4989  3450 38513.9176   20  354 30147.1601 43467.4263  44.2%   726  482s
H 4991  3279                    30161.420813 43467.4263  44.1%   726  482s
  5021  3371 38292.9559   21  340 30161.4208 43467.4263  44.1%   735  491s
  5123  3368 37379.0787   24  335 30161.4208 43467.4263  44.1%   771  497s
H 5135  3203                    30189.300274 43467.4263  44.0%   772  497s
  5156  3232 37548.2279   22  332 30189.3003 43467.4263  44.0%   776  503s
  5228  3227 36964.2039   25  338 30189.3003 43467.4263  44.0%   784  509s
  5268  3230 35865.4849   25  305 30189.3003 43467.4263  44.0%   790  525s
  5322  3237 35150.7547   24  226 30189.3003 43467.4263  44.0%   795  532s
  5403  3239 35212.9506   24  381 30189.3003 43467.4263  44.0%   802  543s
  5464  3253 31260.3520   24  252 30189.3003 42911.0729  42.1%   815  551s
  5535  3263 36422.1594   26  315 30189.3003 42911.0302  42.1%   828  560s
  5594  3287 35660.2703   26  409 30189.3003 42911.0302  42.1%   840  567s
  5657  3307 35970.4850   27  296 30189.3003 42911.0302  42.1%   850  575s
  5719  3323 35897.2336   28  292 30189.3003 42911.0302  42.1%   860  584s
  5791  3360 34840.6824   30  216 30189.3003 42911.0302  42.1%   869  591s
  5871  3385 34340.4495   32  279 30189.3003 42911.0302  42.1%   875  597s
  5950  3409 33594.9971   35  292 30189.3003 42911.0302  42.1%   880  605s
  6043  3409 32611.1839   37  227 30189.3003 42770.1947  41.7%   886  614s
  6147  3396     cutoff   40      30189.3003 41720.9911  38.2%   891  621s
H 6168  3236                    30288.531870 41720.4438  37.7%   894  621s
  6183  3262 35524.1732   22  276 30288.5319 41720.4438  37.7%   896  631s
  6291  3272 34673.1881   23  277 30288.5319 41720.4438  37.7%   902  640s
  6397  3305 33281.6604   25  401 30288.5319 41720.4438  37.7%   909  647s
  6493  3347 30602.9006   27  351 30288.5319 41720.4438  37.7%   914  657s
  6611  3358     cutoff   29      30288.5319 41720.4438  37.7%   919  665s
  6739  3337 39812.1979   25  347 30288.5319 41720.4438  37.7%   925  674s
H 6740  3190                    30300.204267 41720.4438  37.7%   925  674s
H 6773  3040                    30303.810366 41720.4438  37.7%   928  674s
  6837  3056 39392.5738   26  317 30303.8104 41720.4438  37.7%   931  686s
  6956  3072 38708.0482   29  295 30303.8104 41720.4438  37.7%   943  695s
  7067  3079 38026.0771   34  152 30303.8104 41661.6654  37.5%   956  703s
  7206  3078 33091.7996   39   37 30303.8104 41048.5119  35.5%   963  712s
  7364  3083 30678.1131   52   22 30303.8104 41048.5119  35.5%   971  723s
H 7526  2912                    30801.410386 41048.5119  33.3%   979  733s
  7573  2945     cutoff   69      30801.4104 41048.5119  33.3%   983  746s
  7715  2950 33629.7517   26  218 30801.4104 40325.9407  30.9%   994  755s
H 7765  2809                    30891.932370 40325.9407  30.5%   998  755s
  7855  2827 32861.1191   29  185 30891.9324 40325.9407  30.5%  1004  764s
  7958  2854     cutoff   28      30891.9324 40325.9407  30.5%  1011  776s
  8154  2836 35304.5603   31  314 30891.9324 39720.0216  28.6%  1017  785s
  8362  2811 34583.4813   33  203 30891.9324 39720.0216  28.6%  1024  795s
  8559  2777 infeasible   36      30891.9324 39576.6615  28.1%  1034  807s
  8804  2735 37719.4053   34  305 30891.9324 39528.0450  28.0%  1040  820s
  9038  2685 31786.3763   40  116 30891.9324 39528.0450  28.0%  1050  833s
  9234  2679 34874.0192   23  289 30891.9324 39058.2875  26.4%  1060  846s
  9476  2653 infeasible   29      30891.9324 39025.8707  26.3%  1071  857s
  9764  2628 infeasible   30      30891.9324 39003.4118  26.3%  1077  872s
 10113  2553 33107.9270   29  240 30891.9324 39003.4118  26.3%  1081  887s
 10439  2478 32105.0402   29  299 30891.9324 38722.0455  25.3%  1089  902s
H10479  2339                    30939.151636 38722.0455  25.2%  1090  902s
H10503  2218                    30963.275903 38722.0455  25.1%  1090  902s
 10753  2191 34580.4686   25  391 30963.2759 38722.0455  25.1%  1095  916s
 11046  2134 32853.5146   28  373 30963.2759 38200.7657  23.4%  1104  931s
 11387  2052 36891.9338   27  327 30963.2759 38003.9404  22.7%  1110  948s
 11708  2079     cutoff   31      30963.2759 37755.0356  21.9%  1122  968s
 12031  2108 31511.5238   34  196 30963.2759 37654.3717  21.6%  1129  986s
 12427  2118 34195.4366   24  327 30963.2759 37547.1561  21.3%  1139 1008s
 12779  2123 32758.2219   29  267 30963.2759 37245.4155  20.3%  1149 1030s
H12806  2120                    31007.372511 37245.4155  20.1%  1150 1030s
H12830  2119                    31016.107598 37245.4155  20.1%  1150 1030s
H12854  2113                    31051.100900 37245.4155  19.9%  1151 1030s
 13037  2086     cutoff   30      31051.1009 37169.5107  19.7%  1153 1047s
 13506  2072     cutoff   38      31051.1009 36773.8434  18.4%  1158 1065s
 14001  2042 31905.5288   26  288 31051.1009 36595.1097  17.9%  1164 1083s
 14475  1996     cutoff   32      31051.1009 36301.2606  16.9%  1172 1103s
 14861  1951 31696.8809   25  201 31051.1009 36076.9285  16.2%  1178 1124s
 15374  1897     cutoff   30      31051.1009 35779.6291  15.2%  1180 1145s
 15949  1840 31452.9287   31  258 31051.1009 35549.5215  14.5%  1185 1168s
 16470  1767     cutoff   29      31051.1009 35253.9662  13.5%  1190 1190s
 17086  1630     cutoff   28      31051.1009 34978.7952  12.6%  1196 1214s
 17722  1484 32169.7723   29  242 31051.1009 34662.2543  11.6%  1200 1239s
 18486  1216 33069.7709   41  254 31051.1009 34276.4675  10.4%  1199 1265s
 19317   765 31822.2600   35  321 31051.1009 33972.0946  9.41%  1195 1289s
 20364   121     cutoff   25      31051.1009 33315.0833  7.29%  1180 1312s
 21496     0 infeasible   27      31051.1009 32771.3358  5.54%  1146 1315s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 413
  Flow cover: 1477
  RLT: 19
  Relax-and-lift: 101

Explored 21715 nodes (24770223 simplex iterations) in 1315.26 seconds (2546.80 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 31051.1 31016.1 31007.4 ... 30288.5

Optimal solution found (tolerance 1.00e-06)
Best objective 3.105110090033e+04, best bound 3.105110090033e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1315.29s
  Master Objective (UB) = 31051.10, θ = 174527.66
  Upper Bound (UB) = 31051.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 174527.66
  [DEBUG]   ✓ Scenario 0: θ = 174527.66 ≤ Q = 174527.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 174527.66 ≤ Q = 174527.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 174527.66 ≤ Q = 174527.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 174527.66 ≤ Q = 174527.66 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5df70eaa
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa208f156
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.372649e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6660285.1123
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.595624e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159562.41    0  127 6660285.11 -159562.41   102%     -    0s
H    0     0                    -122987.7052 -159562.41  29.7%     -    0s
H    0     0                    -123250.9578 -159562.41  29.5%     -    0s
H    0     0                    -128671.9690 -159562.41  24.0%     -    0s
H    0     0                    -129307.8931 -140201.55  8.42%     -    0s
     0     0 -140201.55    0   92 -129307.89 -140201.55  8.42%     -    0s
H    0     0                    -138051.0536 -140189.34  1.55%     -    0s
     0     0 -139897.88    0   93 -138051.05 -139897.88  1.34%     -    0s
     0     0 -139695.75    0   74 -138051.05 -139695.75  1.19%     -    0s
H    0     0                    -138543.9584 -139688.24  0.83%     -    0s
     0     0 -139625.28    0   72 -138543.96 -139625.28  0.78%     -    0s
     0     0 -139618.35    0   72 -138543.96 -139618.35  0.78%     -    0s
H    0     0                    -138828.4866 -139618.35  0.57%     -    0s
H    0     0                    -138832.5190 -139618.35  0.57%     -    0s
     0     0 -139430.58    0   73 -138832.52 -139430.58  0.43%     -    0s
H    0     0                    -138883.9175 -139428.46  0.39%     -    0s
     0     0 -139386.49    0   84 -138883.92 -139386.49  0.36%     -    0s
     0     0 -139384.68    0   81 -138883.92 -139384.68  0.36%     -    0s
     0     0 -139383.72    0   80 -138883.92 -139383.72  0.36%     -    0s
     0     0 -139350.16    0   79 -138883.92 -139350.16  0.34%     -    0s
     0     0 -139347.33    0   79 -138883.92 -139347.33  0.33%     -    0s
     0     2 -139347.33    0   79 -138883.92 -139347.33  0.33%     -    0s
*  512     0              46    -138888.2606 -138888.26  0.00%   4.2    0s

Cutting planes:
  Gomory: 16
  Implied bound: 4
  MIR: 100
  Flow cover: 12
  RLT: 47

Explored 513 nodes (2770 simplex iterations) in 0.36 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -138888 -138884 -138833 ... 6.66029e+06
No other solutions better than -138888

Optimal solution found (tolerance 1.00e-06)
Best objective -1.388882606276e+05, best bound -1.388882606276e+05, gap 0.0000%
  Subproblem solved in 0.40s
  Worst-case operational profit (Z_SP) = 159371.79
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138888.26
  [DEBUG]   S×d_nominal = 298260.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298260.05 + -138888.26 = 159371.79
  [DEBUG]   Current θ from Master = 174527.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15155.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15895.23
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 7716.9341, Absolute Gap = 7716.9341, Relative Gap = 0.248524
  Not converged yet (gap = 7716.93 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0xa736d3e4
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35510 rows and 14430 columns
Presolve time: 1.11s
Presolved: 42323 rows, 19030 columns, 262589 nonzeros
Variable types: 16771 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339436.1647
Found heuristic solution: objective -222884.1918

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42323 rows, 19030 columns, 262589 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27485    1.0753303e+04   0.000000e+00   1.852164e+06      5s
   40447    5.2891764e+04   0.000000e+00   1.289739e+07     10s
   50629    5.6476509e+04   0.000000e+00   2.271830e+05     15s
Concurrent spin time: 1.16s

Solved with dual simplex

Root relaxation: objective 5.665977e+04, 27783 iterations, 15.14 seconds (19.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56659.7657    0  132 -222884.19 56659.7657   125%     -   16s
H    0     0                    -214188.8014 56659.7657   126%     -   16s
H    0     0                    -140128.8675 56659.7657   140%     -   17s
H    0     0                    -139301.1124 56659.7657   141%     -   17s
H    0     0                    -134454.1981 56659.7657   142%     -   17s
H    0     0                    -129155.0824 56659.7657   144%     -   17s
H    0     0                    -128808.9737 56659.7657   144%     -   17s
H    0     0                    -125976.2969 56659.7657   145%     -   17s
H    0     0                    -29786.23542 56659.7657   290%     -   17s
H    0     0                    -10721.01848 56659.7657   628%     -   17s
H    0     0                    -6828.272480 56659.7657   930%     -   17s
H    0     0                    -4780.433033 56659.7657  1285%     -   17s
H    0     0                    21742.180587 56659.7657   161%     -   17s
H    0     0                    22465.205449 56659.7657   152%     -   17s
H    0     0                    22918.529348 56659.7657   147%     -   17s
H    0     0                    22924.893378 56659.7657   147%     -   18s
H    0     0                    22968.878266 56659.7657   147%     -   18s
H    0     0                    23459.751783 56659.7657   142%     -   18s
H    0     0                    24071.827276 56659.7657   135%     -   18s
     0     0 52048.7771    0  299 24071.8273 52048.7771   116%     -   25s
H    0     0                    24451.887907 52048.6333   113%     -   25s
     0     0 51570.7926    0  243 24451.8879 51570.7926   111%     -   28s
     0     0 51488.2031    0  247 24451.8879 51488.2031   111%     -   28s
     0     0 51472.9343    0  279 24451.8879 51472.9343   111%     -   29s
     0     0 51472.5436    0  280 24451.8879 51472.5436   111%     -   29s
     0     0 49221.1281    0  295 24451.8879 49221.1281   101%     -   36s
     0     0 48465.8748    0  337 24451.8879 48465.8748  98.2%     -   40s
H    0     0                    24544.672223 48279.0404  96.7%     -   41s
     0     0 48279.0404    0  282 24544.6722 48279.0404  96.7%     -   41s
     0     0 48223.4290    0  289 24544.6722 48223.4290  96.5%     -   42s
     0     0 48199.9334    0  283 24544.6722 48199.9334  96.4%     -   43s
     0     0 48113.0298    0  289 24544.6722 48113.0298  96.0%     -   43s
     0     0 48076.5087    0  344 24544.6722 48076.5087  95.9%     -   44s
     0     0 48072.1292    0  343 24544.6722 48072.1292  95.9%     -   44s
     0     0 48072.1208    0  343 24544.6722 48072.1208  95.9%     -   45s
     0     0 46483.6935    0  332 24544.6722 46483.6935  89.4%     -   55s
     0     0 46047.1623    0  400 24544.6722 46047.1623  87.6%     -   60s
H    0     0                    25874.065942 45887.5751  77.3%     -   63s
H    0     0                    26941.298685 45887.5751  70.3%     -   63s
H    0     0                    26996.818454 45887.5751  70.0%     -   63s
H    0     0                    27012.906894 45887.5751  69.9%     -   63s
H    0     0                    27151.145175 45887.5751  69.0%     -   63s
H    0     0                    27177.945844 45887.5751  68.8%     -   63s
H    0     0                    27221.034245 45887.5751  68.6%     -   63s
H    0     0                    27221.075415 45887.5751  68.6%     -   63s
H    0     0                    27279.323659 45887.5751  68.2%     -   63s
     0     0 45887.5751    0  368 27279.3237 45887.5751  68.2%     -   63s
     0     0 45829.3519    0  367 27279.3237 45829.3519  68.0%     -   64s
     0     0 45803.0306    0  365 27279.3237 45803.0306  67.9%     -   64s
     0     0 45767.7443    0  376 27279.3237 45767.7443  67.8%     -   66s
     0     0 45756.7194    0  368 27279.3237 45756.7194  67.7%     -   66s
     0     0 45748.7668    0  366 27279.3237 45748.7668  67.7%     -   66s
     0     0 45740.4483    0  369 27279.3237 45740.4483  67.7%     -   67s
H    0     0                    27301.512450 45735.2493  67.5%     -   67s
     0     0 45735.2493    0  371 27301.5125 45735.2493  67.5%     -   67s
     0     0 45734.9509    0  373 27301.5125 45734.9509  67.5%     -   67s
H    0     0                    27376.004256 45734.9509  67.1%     -   72s
H    0     0                    27532.705146 45734.9509  66.1%     -   72s
H    0     0                    27538.666237 45734.9509  66.1%     -   72s
     0     0 45227.4391    0  380 27538.6662 45227.4391  64.2%     -   75s
H    0     0                    27843.263906 45227.3854  62.4%     -   75s
H    0     0                    27957.691160 45227.3854  61.8%     -   76s
H    0     0                    27979.982968 45227.3854  61.6%     -   76s
H    0     0                    28031.403415 45227.3854  61.3%     -   76s
H    0     0                    28031.489940 45227.3854  61.3%     -   76s
H    0     0                    28045.861140 45227.3854  61.3%     -   76s
H    0     0                    28064.932342 45227.3854  61.2%     -   76s
H    0     0                    28092.081339 45227.3854  61.0%     -   76s
H    0     0                    28094.447226 45227.3854  61.0%     -   76s
     0     0 45035.1563    0  391 28094.4472 45035.1563  60.3%     -   78s
     0     0 44934.1571    0  432 28094.4472 44934.1571  59.9%     -   79s
     0     0 44860.0611    0  438 28094.4472 44860.0611  59.7%     -   80s
     0     0 44832.9703    0  439 28094.4472 44832.9703  59.6%     -   81s
     0     0 44822.2854    0  444 28094.4472 44822.2854  59.5%     -   82s
     0     0 44819.0162    0  450 28094.4472 44819.0162  59.5%     -   82s
     0     0 44815.4977    0  449 28094.4472 44815.4977  59.5%     -   82s
     0     0 44812.2521    0  452 28094.4472 44812.2521  59.5%     -   83s
     0     0 44811.1331    0  454 28094.4472 44811.1331  59.5%     -   83s
     0     0 44720.1519    0  452 28094.4472 44720.1519  59.2%     -   86s
H    0     0                    28137.276590 44696.1742  58.9%     -   87s
H    0     0                    28234.505600 44696.1742  58.3%     -   87s
H    0     0                    28323.524437 44696.1742  57.8%     -   87s
H    0     0                    28354.303522 44696.1742  57.6%     -   87s
     0     0 44696.1742    0  460 28354.3035 44696.1742  57.6%     -   87s
     0     0 44687.0381    0  471 28354.3035 44687.0381  57.6%     -   87s
     0     0 44684.5358    0  466 28354.3035 44684.5358  57.6%     -   88s
     0     0 44683.4504    0  467 28354.3035 44683.4504  57.6%     -   88s
     0     0 44631.1035    0  468 28354.3035 44631.1035  57.4%     -   90s
     0     0 44618.0082    0  469 28354.3035 44618.0082  57.4%     -   91s
     0     0 44608.4636    0  467 28354.3035 44608.4636  57.3%     -   91s
     0     0 44603.7163    0  470 28354.3035 44603.7163  57.3%     -   92s
     0     0 44603.2185    0  474 28354.3035 44603.2185  57.3%     -   92s
     0     0 44588.3036    0  412 28354.3035 44588.3036  57.3%     -   93s
     0     0 44581.0622    0  417 28354.3035 44581.0622  57.2%     -   94s
     0     0 44579.3326    0  417 28354.3035 44579.3326  57.2%     -   94s
     0     0 44579.3019    0  415 28354.3035 44579.3019  57.2%     -   94s
     0     0 44575.6926    0  418 28354.3035 44575.6926  57.2%     -   95s
H    0     0                    28390.762678 44575.2357  57.0%     -   96s
H    0     0                    28603.029749 44575.2357  55.8%     -   96s
H    0     0                    28612.429152 44575.2357  55.8%     -   96s
H    0     0                    28618.101079 44575.2357  55.8%     -   96s
H    0     0                    28842.836536 44575.2357  54.5%     -   96s
     0     0 44567.5938    0  421 28842.8365 44567.5938  54.5%     -   96s
     0     0 44565.7905    0  414 28842.8365 44565.7905  54.5%     -   96s
     0     0 44565.5730    0  415 28842.8365 44565.5730  54.5%     -   96s
     0     0 44561.2417    0  415 28842.8365 44561.2417  54.5%     -   97s
     0     0 44560.3002    0  407 28842.8365 44560.3002  54.5%     -   97s
     0     0 44558.3119    0  412 28842.8365 44558.3119  54.5%     -   98s
     0     0 44557.4374    0  412 28842.8365 44557.4374  54.5%     -   99s
H    0     0                    28884.816120 44557.4046  54.3%     -  114s
     0     2 44557.4046    0  412 28884.8161 44557.4046  54.3%     -  115s
     7    16 43953.1404    3  454 28884.8161 44210.3758  53.1%  2111  123s
    15    32 43818.9367    4  445 28884.8161 43952.7068  52.2%  2469  130s
    31    64 43673.6668    5  431 28884.8161 43818.5533  51.7%  3925  137s
H   34    64                    28934.308449 43818.5533  51.4%  3655  137s
H   38    64                    29110.076853 43818.5533  50.5%  3419  137s
H   95   173                    29130.479378 43672.8870  49.9%  2185  146s
H   97   173                    29151.171542 43672.8870  49.8%  2173  146s
H   98   173                    29188.626700 43672.8870  49.6%  2163  146s
H  101   173                    29223.750885 43672.8870  49.4%  2128  146s
   172   258 43273.5969    8  437 29223.7509 43672.8870  49.4%  1639  151s
   257   320 43004.6114    9  431 29223.7509 43672.8870  49.4%  1396  156s
H  261   320                    29226.249830 43672.8870  49.4%  1392  156s
   319   385 42776.9496   10  435 29226.2498 43672.8870  49.4%  1299  160s
   456   536 42396.1175   11  441 29226.2498 43672.8870  49.4%  1170  169s
   535   568 42639.8655   11  373 29226.2498 43672.8870  49.4%  1107  172s
   567   599 42353.3705   12  427 29226.2498 43672.8870  49.4%  1093  177s
   600   637 42255.0371   13  352 29226.2498 43672.8870  49.4%  1076  181s
   675   710 42021.8585   14  422 29226.2498 43672.8870  49.4%  1069  190s
   711   745 41812.4527   15  352 29226.2498 43672.8870  49.4%  1081  195s
   781   815 41682.8210   16  415 29226.2498 43672.8870  49.4%  1081  201s
H  805   815                    29259.521804 43672.8870  49.3%  1079  201s
   820   905 41289.7135   16  399 29259.5218 43672.8870  49.3%  1069  206s
   918   988 41499.9409   17  348 29259.5218 43672.8870  49.3%  1015  211s
  1014  1052 41197.7416   19  405 29259.5218 43672.8870  49.3%   986  217s
H 1021  1052                    29310.293437 43672.8870  49.0%   989  217s
  1106  1110 40803.1187   19  410 29310.2934 43616.0156  48.8%   961  221s
  1190  1180 40476.1086   20  397 29310.2934 43512.0209  48.5%   962  226s
  1266  1249 39412.5876   20  369 29310.2934 43512.0209  48.5%   970  231s
  1339  1320 38194.1336   21  375 29310.2934 43512.0209  48.5%   978  239s
  1422  1395 39772.4195   21  345 29310.2934 43512.0209  48.5%   988  245s
  1507  1488 38487.2032   22  335 29310.2934 43508.1990  48.4%   992  250s
  1604  1564 37833.4208   22  333 29310.2934 43508.1990  48.4%   987  259s
  1698  1696 37762.0443   23  333 29310.2934 43508.1990  48.4%   977  263s
  1838  1820 37420.8026   26  323 29310.2934 43508.1990  48.4%   951  268s
  1978  1941 37020.4435   27  221 29310.2934 43508.1990  48.4%   928  273s
  2109  1970 36786.0769   29  229 29310.2934 43403.4111  48.1%   918  280s
  2150  2032 36658.5527   31  385 29310.2934 43403.4111  48.1%   926  286s
  2214  2113 36432.5972   33  277 29310.2934 43403.4111  48.1%   933  292s
  2307  2215 36093.1839   35  271 29310.2934 43403.4111  48.1%   933  298s
  2423  2295 35444.1483   37  260 29310.2934 43403.4111  48.1%   929  304s
  2521  2423 35108.4341   39  264 29310.2934 43403.4111  48.1%   927  310s
  2695  2580 31045.0221   41  326 29310.2934 43348.7259  47.9%   912  317s
  2894  2809 32297.9317   41  320 29310.2934 43348.7259  47.9%   894  322s
  3153  3069 29572.5800   43  240 29310.2934 43348.7259  47.9%   866  329s
  3473  3284 30302.2251   45  318 29310.2934 43348.7259  47.9%   829  339s
  3775  3506 41969.6251   10  293 29310.2934 43281.4367  47.7%   807  348s
  4068  3507 39072.5621   44  412 29310.2934 43266.3932  47.6%   787  383s
  4070  3508 38014.5818   32  132 29310.2934 43266.3932  47.6%   787  413s
  4071  3509 38796.2729   39  330 29310.2934 43266.3932  47.6%   787  425s
  4072  3510 29593.1625   48  384 29310.2934 43266.3932  47.6%   787  431s
  4073  3510 33503.6383   19  384 29310.2934 43266.3932  47.6%   787  437s
  4074  3511 30828.0448   42  383 29310.2934 43266.3932  47.6%   786  442s
  4075  3512 39948.2927   13  401 29310.2934 43266.3932  47.6%   786  445s
  4077  3513 35816.7678   61  407 29310.2934 43266.3932  47.6%   786  450s
  4081  3516 37412.9296   39  455 29310.2934 43266.3932  47.6%   785  456s
  4085  3518 35910.8540   25  453 29310.2934 43266.3932  47.6%   784  463s
  4086  3519 38764.7149   43  468 29310.2934 43266.3932  47.6%   784  465s
  4089  3521 36859.3078   33  456 29310.2934 43266.3932  47.6%   783  470s
  4092  3523 34979.8542   26  499 29310.2934 43266.3932  47.6%   783  477s
  4094  3524 38034.0409   24  482 29310.2934 43266.3932  47.6%   782  480s
  4097  3526 42011.6926   10  486 29310.2934 43266.3932  47.6%   782  486s
  4098  3527 37009.6368   56  465 29310.2934 43266.3932  47.6%   782  492s
  4101  3529 40957.2047   16  485 29310.2934 43266.3932  47.6%   781  495s
  4104  3531 31700.0545  100  477 29310.2934 43266.3932  47.6%   781  501s
  4105  3532 35526.2175   36  476 29310.2934 43266.3932  47.6%   780  505s
  4107  3533 33082.1665   48  481 29310.2934 43266.3932  47.6%   780  510s
  4109  3534 31281.9887   24  477 29310.2934 43266.3932  47.6%   780  516s
  4111  3536 41549.1658    8  475 29310.2934 43266.3932  47.6%   779  521s
  4113  3537 38417.7999   47  470 29310.2934 43266.3932  47.6%   779  525s
  4114  3538 40886.1891   23  470 29310.2934 43266.3932  47.6%   779  553s
  4115  3538 39076.0008   43  470 29310.2934 43266.3932  47.6%   779  572s
  4116  3542 43266.3932   16  467 29310.2934 43266.3932  47.6%   806  579s
  4118  3545 43266.3932   17  472 29310.2934 43266.3932  47.6%   807  590s
  4122  3552 43266.3932   18  471 29310.2934 43266.3932  47.6%   809  605s
  4130  3565 43266.3932   19  469 29310.2934 43266.3932  47.6%   817  620s
  4146  3580 39472.8786   20  206 29310.2934 43266.3932  47.6%   837  647s
  4166  3605 41655.1685   21  370 29310.2934 43266.3932  47.6%   860  664s
  4198  3688 37660.6885   22  349 29310.2934 43266.3932  47.6%   894  683s
  4305  3716 35244.4094   25  286 29310.2934 43266.3932  47.6%   962  699s
  4406  3738 35304.7992   23  322 29310.2934 43266.3932  47.6%   980  712s
  4492  3771 36330.2097   25  265 29310.2934 43266.3932  47.6%   994  721s
  4574  3787 35047.0452   26  277 29310.2934 43266.3932  47.6%  1005  734s
  4655  3782 34681.5450   27  289 29310.2934 43266.3932  47.6%  1016  741s
  4693  3790 33879.5798   27  278 29310.2934 43266.3932  47.6%  1021  750s
  4737  3801 33391.5588   28  167 29310.2934 43020.8665  46.8%  1025  758s
  4775  3800 34213.4957   27  273 29310.2934 43020.8665  46.8%  1031  770s
  4827  3794 32515.1847   28  226 29310.2934 43020.8665  46.8%  1038  784s
  4876  3802 31858.3602   29  219 29310.2934 43020.8665  46.8%  1045  793s
  4921  3805 30594.8596   28  212 29310.2934 42645.2260  45.5%  1055  804s
  4967  3803     cutoff   28      29310.2934 42645.2260  45.5%  1066  817s
  5022  3810 31667.0784   30  203 29310.2934 42645.2260  45.5%  1074  829s
  5063  3813     cutoff   31      29310.2934 42460.6650  44.9%  1083  840s
  5115  3818     cutoff   31      29310.2934 42460.6650  44.9%  1088  852s
  5154  3831 38177.3854   23  383 29310.2934 42460.6650  44.9%  1100  863s
  5187  3839 33815.8502   23  331 29310.2934 42460.6650  44.9%  1104  870s
  5227  3855 33802.0053   24  473 29310.2934 42460.6650  44.9%  1111  882s
  5272  3894 32022.1453   24  383 29310.2934 41994.1913  43.3%  1117  891s
  5351  3930 33748.3704   24  374 29310.2934 41994.1913  43.3%  1121  904s
  5433  3976 31084.1148   25  342 29310.2934 41994.1913  43.3%  1127  918s
  5534  3997 31573.2764   25  309 29310.2934 41994.1913  43.3%  1131  932s
  5656  4028 31035.5537   26  290 29310.2934 41994.1913  43.3%  1132  947s
  5792  4056 30520.9498   27  297 29310.2934 41994.1913  43.3%  1136  962s
  5934  4062 29725.8840   28  298 29310.2934 41994.1913  43.3%  1142  977s
  6077  4099     cutoff   30      29310.2934 41994.1913  43.3%  1149  989s
  6223  4145 39381.7430   26  392 29310.2934 41421.5069  41.3%  1153 1005s
  6380  4182     cutoff   28      29310.2934 41405.9921  41.3%  1157 1020s
  6546  4210 34380.9955   31  272 29310.2934 41405.9921  41.3%  1162 1037s
  6763  4184 33702.0850   37  187 29310.2934 41405.9921  41.3%  1158 1055s
  6972  4141 30557.5281   46  128 29310.2934 40799.9729  39.2%  1158 1066s
  7009  4159 30313.0355   47  120 29310.2934 40799.9729  39.2%  1163 1082s
  7074  4158 29938.3000   48  109 29310.2934 40799.9729  39.2%  1165 1095s
  7165  4176 29923.6988   49   96 29310.2934 40799.9729  39.2%  1164 1108s
  7265  4194 29919.9709   50   95 29310.2934 40547.7463  38.3%  1169 1125s
  7453  4199 29871.1900   51   95 29310.2934 40495.1582  38.2%  1167 1141s
  7607  4207 29862.9146   52   91 29310.2934 40322.9783  37.6%  1176 1162s
  7848  4200 29442.9878   57   78 29310.2934 39897.8999  36.1%  1179 1180s
  8055  4176 31567.1887   26  288 29310.2934 39628.6476  35.2%  1189 1201s
  8287  4157 30607.3547   29  306 29310.2934 39628.6476  35.2%  1202 1223s
  8547  4090 29699.1645   24  346 29310.2934 39330.0374  34.2%  1215 1244s
  8723  4084     cutoff   25      29310.2934 39330.0374  34.2%  1222 1265s
  8924  4044 29843.8594   26  265 29310.2934 38869.1422  32.6%  1236 1287s
  9208  4023 32317.8976   24  304 29310.2934 38869.1422  32.6%  1244 1312s
  9527  3942 29641.5295   30  326 29310.2934 37426.1129  27.7%  1249 1338s
  9881  3886 30039.1342   27  293 29310.2934 37401.2456  27.6%  1253 1367s
 10188  3864 30776.4928   29  248 29310.2934 36348.9830  24.0%  1266 1392s
 10519  3775     cutoff   30      29310.2934 35995.5008  22.8%  1274 1416s
 10864  3655 30866.6105   28  291 29310.2934 35855.2858  22.3%  1286 1443s
 11229  3552 infeasible   31      29310.2934 35534.2745  21.2%  1296 1469s
 11615  3496     cutoff   32      29310.2934 35428.1565  20.9%  1303 1498s
 12058  3387 29730.3927   31  278 29310.2934 35125.7810  19.8%  1307 1530s
 12474  3316 32191.4166   26  340 29310.2934 34842.1989  18.9%  1312 1558s
 12938  3194     cutoff   37      29310.2934 34678.5746  18.3%  1316 1589s
 13398  3070 29858.0829   28  423 29310.2934 34484.9161  17.7%  1323 1623s
 13875  2925     cutoff   30      29310.2934 34258.0984  16.9%  1331 1653s
 14281  2787 32545.2000   27  312 29310.2934 34155.7962  16.5%  1336 1682s
 14382  2746     cutoff   28      29310.2934 34057.5717  16.2%  1337 1712s
 14819  2632 31502.6499   30  266 29310.2934 33995.2209  16.0%  1342 1747s
 15478  2649 31258.9800   26  293 29310.2934 33653.8791  14.8%  1339 1786s
 16176  2624 infeasible   30      29310.2934 33431.0352  14.1%  1338 1823s
 16845  2566 infeasible   33      29310.2934 33311.5526  13.7%  1341 1864s
 17541  2515 30261.3784   29  271 29310.2934 32998.2364  12.6%  1345 1903s
 18419  2275     cutoff   37      29310.2934 32815.7455  12.0%  1335 1942s
 19276  2079 infeasible   29      29310.2934 32498.9170  10.9%  1328 1982s
 20317  1756     cutoff   33      29310.2934 32189.9696  9.82%  1313 2024s
 21427  1272     cutoff   31      29310.2934 31936.1054  8.96%  1298 2065s
 23462  1943     cutoff   70      29310.2934 31095.0513  6.09%  1234 2094s
 27334  4148 29360.4749   66   63 29310.2934 30539.8201  4.19%  1084 2104s
*28729  4071              99    29409.573434 30509.3020  3.74%  1035 2104s
 32006  4690     cutoff   76      29409.5734 29836.4877  1.45%   936 2114s
 37606  4937 29430.0566   73   18 29409.5734 29685.6167  0.94%   808 2117s
 40585  5388     cutoff   71      29409.5734 29628.6609  0.74%   754 2121s
 43882  5630 29419.8011   80   20 29409.5734 29607.3018  0.67%   703 2126s
 47439  5787 29553.5510   68   40 29409.5734 29573.9910  0.56%   656 2132s
H48980  5631                    29414.869330 29571.8719  0.53%   637 2132s
 49560  5587 29467.3620   65   49 29414.8693 29562.0171  0.50%   631 2135s
*50297  5290              90    29424.132808 29558.9872  0.46%   623 2135s
 53483  4687     cutoff   57      29424.1328 29531.3202  0.36%   590 2141s
*54143  4386              82    29431.218773 29530.5517  0.34%   584 2141s
*54212  4178              83    29435.884304 29530.5517  0.32%   583 2141s
*57914  1896              82    29459.610597 29514.8131  0.19%   550 2144s
 58324    80     cutoff   63      29459.6106 29496.8007  0.13%   546 2147s

Cutting planes:
  Learned: 2
  Gomory: 1
  MIR: 567
  Flow cover: 2056
  RLT: 24
  Relax-and-lift: 115

Explored 60544 nodes (32030908 simplex iterations) in 2147.92 seconds (4079.72 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 29459.6 29459.6 29435.9 ... 29226.2

Optimal solution found (tolerance 1.00e-06)
Best objective 2.945961059653e+04, best bound 2.945961059653e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 2147.99s
  Master Objective (UB) = 29459.61, θ = 156744.63
  Upper Bound (UB) = 29459.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156744.63
  [DEBUG]   ✓ Scenario 0: θ = 156744.63 ≤ Q = 156744.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156744.63 ≤ Q = 156745.03 (slack: 0.40)
  [DEBUG]   ✓ Scenario 2: θ = 156744.63 ≤ Q = 156744.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156744.63 ≤ Q = 156744.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156744.63 ≤ Q = 156744.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x54ccd9e6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x54ccd9e6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.455807e+13
Presolve removed 2610 rows and 1903 columns
Presolve time: 0.01s
Presolved: 483 rows, 486 columns, 1362 nonzeros
Found heuristic solution: objective 7436288.3010
Variable types: 327 continuous, 159 integer (159 binary)
Found heuristic solution: objective 7436024.8840

Root relaxation: objective -1.376883e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137688.27    0  122 7436024.88 -137688.27   102%     -    0s
H    0     0                    -108874.2858 -137688.27  26.5%     -    0s
H    0     0                    -109137.7028 -137688.27  26.2%     -    0s
H    0     0                    -111513.1125 -124811.31  11.9%     -    0s
H    0     0                    -112023.3881 -124811.31  11.4%     -    0s
H    0     0                    -112286.8050 -124811.31  11.2%     -    0s
     0     0 -124811.31    0  126 -112286.81 -124811.31  11.2%     -    0s
H    0     0                    -121987.5543 -124744.32  2.26%     -    0s
H    0     0                    -122813.6517 -124744.32  1.57%     -    0s
     0     0 -124012.34    0  122 -122813.65 -124012.34  0.98%     -    0s
     0     0 -123964.28    0  122 -122813.65 -123964.28  0.94%     -    0s
     0     0 -123955.72    0  122 -122813.65 -123955.72  0.93%     -    0s
     0     0 -123558.70    0   90 -122813.65 -123558.70  0.61%     -    0s
     0     0 -123425.57    0   71 -122813.65 -123425.57  0.50%     -    0s
     0     0 -123340.45    0   65 -122813.65 -123340.45  0.43%     -    0s
     0     0 -123330.61    0   70 -122813.65 -123330.61  0.42%     -    0s
     0     0 -123089.12    0   41 -122813.65 -123089.12  0.22%     -    0s
     0     0 -123087.94    0   40 -122813.65 -123087.94  0.22%     -    0s
     0     0 -123062.61    0   34 -122813.65 -123062.61  0.20%     -    0s
     0     0 -123062.17    0   29 -122813.65 -123062.17  0.20%     -    0s
     0     0 -123023.55    0   36 -122813.65 -123023.55  0.17%     -    0s
     0     0 -123022.31    0   36 -122813.65 -123022.31  0.17%     -    0s
     0     0 -123022.31    0   47 -122813.65 -123022.31  0.17%     -    0s
     0     0 -123022.31    0   47 -122813.65 -123022.31  0.17%     -    0s
     0     0 -123022.31    0   32 -122813.65 -123022.31  0.17%     -    0s
     0     0 -123022.31    0   30 -122813.65 -123022.31  0.17%     -    0s
     0     0 -123015.83    0   18 -122813.65 -123015.83  0.16%     -    0s
     0     0 -122947.40    0   14 -122813.65 -122947.40  0.11%     -    0s
     0     0 -122893.82    0    8 -122813.65 -122893.82  0.07%     -    0s
     0     0 -122854.66    0    6 -122813.65 -122854.66  0.03%     -    0s
     0     0 -122846.44    0    6 -122813.65 -122846.44  0.03%     -    0s
     0     0 -122839.56    0    5 -122813.65 -122839.56  0.02%     -    0s
     0     0 -122832.89    0    4 -122813.65 -122832.89  0.02%     -    0s
H    0     0                    -122820.2790 -122832.89  0.01%     -    0s
     0     0 -122826.37    0    4 -122820.28 -122826.37  0.00%     -    0s
     0     0 -122821.73    0    1 -122820.28 -122821.73  0.00%     -    0s
     0     0     cutoff    0      -122820.28 -122820.28  0.00%     -    0s

Explored 1 nodes (1272 simplex iterations) in 0.16 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -122820 -122814 -122764 ... 7.43602e+06
No other solutions better than -122820

Optimal solution found (tolerance 1.00e-06)
Best objective -1.228202790299e+05, best bound -1.228202790299e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 141037.92
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122820.28
  [DEBUG]   S×d_nominal = 263858.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 263858.20 + -122820.28 = 141037.92
  [DEBUG]   Current θ from Master = 156744.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15706.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13752.90
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 6125.4438, Absolute Gap = 6125.4438, Relative Gap = 0.207927
  Not converged yet (gap = 6125.44 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0xcbb503f9
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42580 rows and 17300 columns
Presolve time: 1.35s
Presolved: 50543 rows, 22400 columns, 314099 nonzeros
Variable types: 20141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339436.1647
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50543 rows, 22400 columns, 314099 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28526   -3.1763314e+04   0.000000e+00   5.818426e+06      5s
   41213    3.2406135e+04   0.000000e+00   2.054236e+08     10s
   49583    4.3326288e+04   0.000000e+00   5.176920e+10     15s
   54519    4.5678992e+04   0.000000e+00   1.715052e+06     20s
   58580    4.5822458e+04   0.000000e+00   1.183368e+07     25s
Concurrent spin time: 0.63s

Solved with dual simplex

Root relaxation: objective 5.489372e+04, 39088 iterations, 26.16 seconds (35.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54893.7213    0  120 -239613.87 54893.7213   123%     -   28s
H    0     0                    -230918.4802 54893.7213   124%     -   28s
H    0     0                    -136867.5218 54893.7213   140%     -   28s
H    0     0                    -136214.3606 54893.7213   140%     -   28s
H    0     0                    -84679.11513 54893.7213   165%     -   28s
H    0     0                    -83280.57487 54893.7213   166%     -   28s
H    0     0                    -83030.84514 54893.7213   166%     -   28s
H    0     0                    -82890.06657 54893.7213   166%     -   28s
H    0     0                    -44195.25309 54893.7213   224%     -   28s
H    0     0                    -43997.14705 54893.7213   225%     -   28s
H    0     0                    -6438.375993 54893.7213   953%     -   28s
H    0     0                    -6240.044459 54893.7213   980%     -   28s
H    0     0                    6933.0861433 54893.7213   692%     -   29s
H    0     0                    14676.923746 54893.7213   274%     -   29s
H    0     0                    16021.461987 54893.7213   243%     -   29s
H    0     0                    21288.573689 54893.7213   158%     -   29s
H    0     0                    21425.986371 54893.7213   156%     -   29s
H    0     0                    22815.733404 54893.7213   141%     -   29s
H    0     0                    24071.827276 54893.7213   128%     -   29s
H    0     0                    24112.575722 54893.7213   128%     -   29s
H    0     0                    24231.271590 54893.7213   127%     -   29s
H    0     0                    24248.369345 54893.7213   126%     -   29s
H    0     0                    24302.761963 54893.7213   126%     -   29s
H    0     0                    24353.505522 49592.1040   104%     -   38s
     0     0 49592.1040    0  184 24353.5055 49592.1040   104%     -   39s
     0     0 49119.9157    0  174 24353.5055 49119.9157   102%     -   43s
     0     0 49107.5317    0  216 24353.5055 49107.5317   102%     -   43s
     0     0 49106.6248    0  174 24353.5055 49106.6248   102%     -   44s
     0     0 49101.8471    0  177 24353.5055 49101.8471   102%     -   44s
     0     0 49100.9849    0  295 24353.5055 49100.9849   102%     -   44s
     0     0 49100.9849    0  295 24353.5055 49100.9849   102%     -   44s
     0     0 47105.5193    0  336 24353.5055 47105.5193  93.4%     -   53s
     0     0 46412.4642    0  333 24353.5055 46412.4642  90.6%     -   57s
     0     0 46066.4684    0  346 24353.5055 46066.4684  89.2%     -   61s
     0     0 45977.5935    0  345 24353.5055 45977.5935  88.8%     -   63s
     0     0 45962.3963    0  353 24353.5055 45962.3963  88.7%     -   64s
     0     0 45949.1689    0  363 24353.5055 45949.1689  88.7%     -   65s
     0     0 45890.5759    0  353 24353.5055 45890.5759  88.4%     -   66s
H    0     0                    24361.644239 45825.1282  88.1%     -   68s
H    0     0                    24388.498823 45825.1282  87.9%     -   68s
     0     0 45825.1282    0  353 24388.4988 45825.1282  87.9%     -   68s
     0     0 45822.1572    0  356 24388.4988 45822.1572  87.9%     -   68s
     0     0 45819.9508    0  363 24388.4988 45819.9508  87.9%     -   69s
     0     0 45819.5415    0  363 24388.4988 45819.5415  87.9%     -   69s
     0     0 44098.5242    0  385 24388.4988 44098.5242  80.8%     -   83s
H    0     0                    24533.024659 44098.0134  79.7%     -   84s
     0     0 43643.2719    0  354 24533.0247 43643.2719  77.9%     -   89s
     0     0 43488.4935    0  353 24533.0247 43488.4935  77.3%     -   92s
     0     0 43422.8582    0  371 24533.0247 43422.8582  77.0%     -   94s
     0     0 43378.8038    0  371 24533.0247 43378.8038  76.8%     -   95s
     0     0 43361.2392    0  371 24533.0247 43361.2392  76.7%     -   96s
     0     0 43353.7205    0  370 24533.0247 43353.7205  76.7%     -   96s
     0     0 43348.4777    0  372 24533.0247 43348.4777  76.7%     -   97s
     0     0 43333.9360    0  379 24533.0247 43333.9360  76.6%     -   97s
     0     0 43331.1385    0  377 24533.0247 43331.1385  76.6%     -   97s
     0     0 43320.9026    0  379 24533.0247 43320.9026  76.6%     -   98s
     0     0 43318.1100    0  378 24533.0247 43318.1100  76.6%     -   98s
     0     0 43317.5912    0  380 24533.0247 43317.5912  76.6%     -   98s
     0     0 42899.2227    0  390 24533.0247 42899.2227  74.9%     -  106s
     0     0 42773.0370    0  381 24533.0247 42773.0370  74.3%     -  110s
     0     0 42736.3429    0  386 24533.0247 42736.3429  74.2%     -  112s
     0     0 42709.0226    0  394 24533.0247 42709.0226  74.1%     -  114s
     0     0 42691.7558    0  383 24533.0247 42691.7558  74.0%     -  115s
     0     0 42680.1880    0  388 24533.0247 42680.1880  74.0%     -  116s
     0     0 42672.4549    0  379 24533.0247 42672.4549  73.9%     -  117s
     0     0 42669.2309    0  328 24533.0247 42669.2309  73.9%     -  117s
     0     0 42667.7751    0  383 24533.0247 42667.7751  73.9%     -  117s
     0     0 42666.4623    0  379 24533.0247 42666.4623  73.9%     -  118s
     0     0 42519.1366    0  391 24533.0247 42519.1366  73.3%     -  122s
H    0     0                    24544.672223 42493.7537  73.1%     -  124s
     0     0 42493.7537    0  391 24544.6722 42493.7537  73.1%     -  124s
     0     0 42483.5521    0  389 24544.6722 42483.5521  73.1%     -  125s
     0     0 42479.5708    0  387 24544.6722 42479.5708  73.1%     -  125s
     0     0 42479.0122    0  403 24544.6722 42479.0122  73.1%     -  126s
     0     0 42454.6563    0  459 24544.6722 42454.6563  73.0%     -  127s
     0     0 42451.1642    0  457 24544.6722 42451.1642  73.0%     -  129s
     0     0 42448.0876    0  458 24544.6722 42448.0876  72.9%     -  129s
     0     0 42444.6629    0  457 24544.6722 42444.6629  72.9%     -  130s
     0     0 42444.1512    0  457 24544.6722 42444.1512  72.9%     -  130s
     0     0 42408.2937    0  455 24544.6722 42408.2937  72.8%     -  133s
     0     0 42397.4889    0  460 24544.6722 42397.4889  72.7%     -  134s
     0     0 42393.9595    0  463 24544.6722 42393.9595  72.7%     -  135s
     0     0 42393.0006    0  463 24544.6722 42393.0006  72.7%     -  135s
     0     0 42378.7015    0  459 24544.6722 42378.7015  72.7%     -  138s
     0     0 42369.9111    0  463 24544.6722 42369.9111  72.6%     -  140s
     0     0 42365.4600    0  463 24544.6722 42365.4600  72.6%     -  140s
     0     0 42363.0491    0  457 24544.6722 42363.0491  72.6%     -  141s
     0     0 42361.3824    0  462 24544.6722 42361.3824  72.6%     -  141s
     0     0 42358.7353    0  459 24544.6722 42358.7353  72.6%     -  142s
     0     0 42357.3655    0  456 24544.6722 42357.3655  72.6%     -  142s
     0     0 42350.5302    0  395 24544.6722 42350.5302  72.5%     -  144s
     0     0 42349.4667    0  451 24544.6722 42349.4667  72.5%     -  144s
     0     0 42337.8602    0  454 24544.6722 42337.8602  72.5%     -  146s
     0     0 42333.2522    0  455 24544.6722 42333.2522  72.5%     -  147s
     0     0 42332.1811    0  451 24544.6722 42332.1811  72.5%     -  147s
     0     0 42314.5374    0  440 24544.6722 42314.5374  72.4%     -  150s
     0     0 42309.2979    0  392 24544.6722 42309.2979  72.4%     -  151s
     0     0 42308.3409    0  458 24544.6722 42308.3409  72.4%     -  152s
     0     0 42299.4727    0  457 24544.6722 42299.4727  72.3%     -  153s
     0     0 42297.4284    0  459 24544.6722 42297.4284  72.3%     -  154s
     0     0 42297.0799    0  456 24544.6722 42297.0799  72.3%     -  154s
     0     0 42289.0370    0  454 24544.6722 42289.0370  72.3%     -  156s
     0     0 42287.3987    0  453 24544.6722 42287.3987  72.3%     -  156s
     0     0 42285.2174    0  459 24544.6722 42285.2174  72.3%     -  158s
     0     0 42285.1174    0  459 24544.6722 42285.1174  72.3%     -  159s
H    0     0                    24552.769673 42283.6386  72.2%     -  194s
     0     2 42283.6386    0  459 24552.7697 42283.6386  72.2%     -  194s
     1     4 42248.6279    1  339 24552.7697 42283.6386  72.2%   803  197s
     3     8 42049.8914    2  409 24552.7697 42240.9757  72.0%  2551  201s
     7    16 41852.9672    3  476 24552.7697 42048.8058  71.3%  3672  208s
    15    32 41769.8182    4  476 24552.7697 41852.8520  70.5%  4965  219s
    31    50 38782.2251    5  250 24552.7697 41768.9917  70.1%  8004  235s
    49    82 40703.8062    6  448 24552.7697 41768.9917  70.1%  7116  243s
    81   132 40655.4350    7  448 24552.7697 41768.9917  70.1%  5434  253s
   131   249 40537.2613    8  385 24552.7697 41768.9917  70.1%  3723  265s
   250   309 40535.6196    9  381 24552.7697 41768.9917  70.1%  2777  276s
   316   371 39931.3668   11  425 24552.7697 41768.9917  70.1%  2723  286s
   392   450 39156.3860   11  355 24552.7697 41768.9917  70.1%  2487  296s
   488   504 39207.3211    9  269 24552.7697 41768.9917  70.1%  2225  312s
   556   578 30658.2014   18  259 24552.7697 41768.9917  70.1%  2129  322s
   651   643 34485.4551   12  385 24552.7697 41768.9917  70.1%  1979  330s
   756   703 33725.9895   12  364 24552.7697 41768.9917  70.1%  1826  340s
   845   728 35157.5184   10  346 24552.7697 41768.9917  70.1%  1757  349s
   876   768 32964.2310   12  288 24552.7697 41768.9917  70.1%  1750  356s
   918   797 34359.0491   13  387 24552.7697 41768.9917  70.1%  1729  361s
   953   838 33733.3481   13  306 24552.7697 41768.9917  70.1%  1715  369s
   996   876 33807.5182   14  373 24552.7697 41768.9917  70.1%  1702  378s
  1048   926 33625.3106   15  239 24552.7697 41768.9917  70.1%  1654  384s
  1102   979 33548.5604   16  239 24552.7697 41768.9917  70.1%  1614  391s
  1169  1024 33369.6997   17  246 24552.7697 41768.9917  70.1%  1569  400s
  1245  1079 33425.5826   17  226 24552.7697 41768.9917  70.1%  1552  411s
  1330  1112 33231.8587   18  248 24552.7697 41142.9134  67.6%  1517  422s
  1425  1147 33285.3945   18  219 24552.7697 41142.9134  67.6%  1503  433s
  1496  1212 32708.3840   19  231 24552.7697 41142.9134  67.6%  1499  445s
  1583  1273 33162.4738   19  207 24552.7697 41142.9134  67.6%  1491  454s
  1680  1342 32947.8925   20  218 24552.7697 41068.3116  67.3%  1488  467s
  1767  1424 32608.6861   20  218 24552.7697 41068.3116  67.3%  1487  477s
  1875  1534 31990.6353   21  233 24552.7697 41068.3116  67.3%  1484  486s
  1999  1660 31331.2414   21  232 24552.7697 41068.3116  67.3%  1449  498s
  2149  1700 32215.3737   22  299 24552.7697 41068.3116  67.3%  1391  504s
  2197  1816 31974.5893   22  232 24552.7697 41068.3116  67.3%  1384  515s
  2335  1970 31629.4803   23  286 24552.7697 40937.0598  66.7%  1344  524s
  2563  2168 31210.0761   23  299 24552.7697 40937.0598  66.7%  1290  538s
  2838  2294 30770.5374   25  231 24552.7697 40884.8299  66.5%  1231  552s
  3086  2381 27488.0183   24  206 24552.7697 40884.8299  66.5%  1203  566s
  3227  2542 30110.1556   27  298 24552.7697 40745.0498  65.9%  1223  581s
  3426  2691     cutoff   32      24552.7697 40745.0498  65.9%  1226  594s
  3652  2692 27700.0538   39  459 24552.7697 40552.7779  65.2%  1215  637s
  3654  2693 26967.2228   26  120 24552.7697 40552.7779  65.2%  1214  665s
  3655  2694 28643.7487   19  355 24552.7697 40552.7779  65.2%  1214  678s
  3656  2695 30465.9046   23  372 24552.7697 40552.7779  65.2%  1213  686s
  3657  2695 40193.8368   13  420 24552.7697 40552.7779  65.2%  1213  695s
  3658  2696 35788.4940   15  444 24552.7697 40552.7779  65.2%  1213  702s
  3659  2697 32813.6203   19  418 24552.7697 40552.7779  65.2%  1212  707s
  3660  2697 29325.6482   20  465 24552.7697 40552.7779  65.2%  1212  711s
  3663  2699 27023.7911   44  478 24552.7697 40552.7779  65.2%  1211  715s
  3665  2701 31009.3913   24  409 24552.7697 40552.7779  65.2%  1210  723s
  3666  2701 30475.8019   23  499 24552.7697 40552.7779  65.2%  1210  727s
  3668  2703 26929.5784   28  463 24552.7697 40552.7779  65.2%  1210  731s
  3670  2704 40552.7779    8  458 24552.7697 40552.7779  65.2%  1209  735s
  3673  2706 27189.8161   42  463 24552.7697 40552.7779  65.2%  1208  743s
  3674  2707 35788.4940   15  513 24552.7697 40552.7779  65.2%  1208  745s
  3676  2708 30626.5348   17  521 24552.7697 40552.7779  65.2%  1207  753s
  3677  2709 38513.4180    7  516 24552.7697 40552.7779  65.2%  1207  755s
  3680  2711 27663.3459   22  472 24552.7697 40552.7779  65.2%  1206  764s
  3681  2711 27800.2312   27  470 24552.7697 40552.7779  65.2%  1205  766s
  3682  2712 28334.7105   25  481 24552.7697 40552.7779  65.2%  1205  771s
  3684  2713 31074.0057   25  458 24552.7697 40552.7779  65.2%  1204  778s
  3686  2715 26087.0102   45  471 24552.7697 40552.7779  65.2%  1204  782s
  3687  2715 29651.6200   20  474 24552.7697 40552.7779  65.2%  1203  786s
  3689  2717 30547.8187   19  471 24552.7697 40552.7779  65.2%  1203  791s
  3690  2717 29849.0947   28  471 24552.7697 40552.7779  65.2%  1202  822s
  3691  2718 26368.6254   24  471 24552.7697 40552.7779  65.2%  1202  840s
  3692  2722 40552.7779   13  459 24552.7697 40552.7779  65.2%  1240  853s
  3694  2725 40552.7779   14  449 24552.7697 40552.7779  65.2%  1241  868s
  3698  2732 40552.7779   15  452 24552.7697 40552.7779  65.2%  1244  883s
  3706  2745 40552.7779   16  411 24552.7697 40552.7779  65.2%  1255  904s
  3722  2764 40085.4540   17  417 24552.7697 40552.7779  65.2%  1305  929s
  3746  2788 40475.9474   18  262 24552.7697 40552.7779  65.2%  1337  944s
  3778  2859 39277.5870   19  314 24552.7697 40552.7779  65.2%  1373  965s
  3864  2905 37015.8517   21  364 24552.7697 40552.7779  65.2%  1442  981s
  3944  2918 35044.0567   21  300 24552.7697 40552.7779  65.2%  1506  994s
  4001  2941 32380.3364   22  299 24552.7697 40552.7779  65.2%  1553 1007s
  4079  2959 30872.6159   22  346 24552.7697 40552.7779  65.2%  1598 1026s
  4173  2961 36437.9844   21  393 24552.7697 40552.7779  65.2%  1631 1039s
  4255  2958 36292.3717   21  248 24552.7697 40552.7779  65.2%  1667 1052s
  4290  2974 27325.6828   22  302 24552.7697 40552.7779  65.2%  1704 1068s
  4330  2999 29092.1040   22  292 24552.7697 40552.7779  65.2%  1734 1081s
  4388  3008 31452.8064   23  294 24552.7697 40552.7779  65.2%  1750 1095s
  4455  3026 31138.3047   24  295 24552.7697 40552.7779  65.2%  1768 1107s
  4528  3031 30234.2426   25  278 24552.7697 40552.7779  65.2%  1786 1117s
  4599  3033 29374.0558   27  297 24552.7697 40552.7779  65.2%  1804 1130s
  4667  3042 29151.9130   29  250 24552.7697 40552.7779  65.2%  1817 1144s
  4753  3030     cutoff   30      24552.7697 40552.7779  65.2%  1830 1157s
  4872  3022     cutoff   31      24552.7697 40552.7779  65.2%  1844 1173s
  4973  3010     cutoff   36      24552.7697 40538.6406  65.1%  1859 1188s
  5062  3020 33193.8497   19  377 24552.7697 40538.6406  65.1%  1898 1202s
  5157  3012 30409.6353   21  277 24552.7697 39247.1654  59.8%  1929 1217s
  5208  3034 29333.0513   22  292 24552.7697 39247.1654  59.8%  1955 1231s
  5283  3048 28750.6537   23  266 24552.7697 39247.1654  59.8%  1965 1247s
  5420  3060 26443.7804   25  221 24552.7697 39247.1654  59.8%  1968 1262s
  5563  3059     cutoff   28      24552.7697 39247.1654  59.8%  1978 1279s
  5714  3040 29551.8936   22  309 24552.7697 37605.0583  53.2%  2000 1295s
  5874  3035 28632.3869   24  234 24552.7697 37490.4382  52.7%  2025 1313s
  6004  3023 25298.2805   27  164 24552.7697 37307.5542  51.9%  2047 1333s
  6150  3011 29310.9488   21  241 24552.7697 37279.0185  51.8%  2075 1351s
  6299  2990 26192.5848   23  201 24552.7697 37279.0185  51.8%  2115 1366s
  6402  2980 30451.5238   20  177 24552.7697 37279.0185  51.8%  2140 1385s
  6575  2971 28716.0178   22  271 24552.7697 37246.0187  51.7%  2158 1402s
  6727  2961 25575.8755   26  160 24552.7697 37246.0187  51.7%  2188 1422s
  6936  2926     cutoff   24      24552.7697 37246.0187  51.7%  2198 1442s
  7168  2926 29906.4283   21  375 24552.7697 36258.7743  47.7%  2212 1462s
  7367  2902     cutoff   25      24552.7697 36222.0267  47.5%  2234 1483s
  7570  2853 27665.9628   22  309 24552.7697 36222.0267  47.5%  2248 1506s
H 7588  2710                    24948.514660 36222.0267  45.2%  2251 1506s
  7698  2742 27460.5939   23  226 24948.5147 36222.0267  45.2%  2261 1529s
H 7708  2609                    25037.376402 36222.0267  44.7%  2260 1529s
H 7787  2460                    25538.650118 36222.0267  41.8%  2267 1529s
  7933  2451 32726.4362   24  275 25538.6501 36222.0267  41.8%  2278 1551s
  8198  2387     cutoff   32      25538.6501 34990.2953  37.0%  2297 1575s
  8439  2343 25957.9876   25  300 25538.6501 34210.1799  34.0%  2325 1601s
  8687  2288 30272.3397   24  366 25538.6501 33542.7874  31.3%  2351 1624s
  8889  2272 26077.3757   27  252 25538.6501 33231.6178  30.1%  2368 1650s
  9208  2197     cutoff   31      25538.6501 33222.8816  30.1%  2380 1675s
  9523  2130 26666.0928   28  195 25538.6501 32540.8831  27.4%  2397 1702s
  9886  1967 28763.8129   25  327 25538.6501 32373.6663  26.8%  2415 1730s
 10182  1936 27233.3784   25  232 25538.6501 32368.8015  26.7%  2428 1759s
 10554  1838 26379.3500   29  267 25538.6501 32083.8094  25.6%  2444 1790s
 10906  1830 26525.0926   24  296 25538.6501 32083.8094  25.6%  2467 1820s
 11387  1821 27562.1609   25  240 25538.6501 31517.8326  23.4%  2467 1851s
 11828  1825 26569.9383   26  229 25538.6501 31471.8486  23.2%  2482 1885s
 12241  1792 27693.0680   24  302 25538.6501 31119.5440  21.9%  2500 1918s
 12701  1793     cutoff   24      25538.6501 30928.0492  21.1%  2521 1954s
 12787  1771 27650.5626   22  297 25538.6501 30897.5514  21.0%  2530 1988s
 13207  1750 27170.9796   23  246 25538.6501 30871.8788  20.9%  2540 2025s
 13548  1700     cutoff   25      25538.6501 30509.1292  19.5%  2550 2066s
 14157  1644     cutoff   36      25538.6501 30332.9432  18.8%  2556 2107s
 14796  1525     cutoff   26      25538.6501 30166.7574  18.1%  2559 2145s
 15458  1378 27282.7008   24  281 25538.6501 29913.0773  17.1%  2558 2183s
 16189  1178     cutoff   29      25538.6501 29614.7116  16.0%  2556 2224s
 17027   852     cutoff   27      25538.6501 29167.8804  14.2%  2540 2260s
 18026   199     cutoff   26      25538.6501 28536.9627  11.7%  2504 2298s
*18985   199              44    25567.872043 28438.4372  11.2%  2442 2298s
 19348     0     cutoff   27      25567.8720 27689.7920  8.30%  2418 2307s

Cutting planes:
  Gomory: 1
  MIR: 700
  Mixing: 3
  Flow cover: 2072
  RLT: 30
  Relax-and-lift: 160

Explored 19731 nodes (47105960 simplex iterations) in 2307.92 seconds (4527.55 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25567.9 25538.7 25037.4 ... 24353.5

Optimal solution found (tolerance 1.00e-06)
Best objective 2.556787204259e+04, best bound 2.556787204259e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2307.94s
  Master Objective (UB) = 25567.87, θ = 179208.19
  Upper Bound (UB) = 25567.87

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179208.19
  [DEBUG]   ✓ Scenario 0: θ = 179208.19 ≤ Q = 179208.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 179208.19 ≤ Q = 179208.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179208.19 ≤ Q = 179208.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179208.19 ≤ Q = 179208.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179208.19 ≤ Q = 179208.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 179208.19 ≤ Q = 179208.19 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7dc68884
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8239777c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.450964e+13
Presolve removed 2601 rows and 1893 columns
Presolve time: 0.01s
Presolved: 492 rows, 496 columns, 1387 nonzeros
Found heuristic solution: objective 7019510.3233
Variable types: 336 continuous, 160 integer (160 binary)

Root relaxation: objective -1.630480e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163047.99    0  128 7019510.32 -163047.99   102%     -    0s
H    0     0                    -124793.0170 -163047.99  30.7%     -    0s
H    0     0                    -125082.9406 -163047.99  30.4%     -    0s
H    0     0                    -127619.4194 -163047.99  27.8%     -    0s
H    0     0                    -146478.9733 -163047.99  11.3%     -    0s
     0     0 -149177.70    0   90 -146478.97 -149177.70  1.84%     -    0s
H    0     0                    -147572.8695 -149075.04  1.02%     -    0s
     0     0 -148815.05    0   88 -147572.87 -148815.05  0.84%     -    0s
     0     0 -148806.98    0   89 -147572.87 -148806.98  0.84%     -    0s
     0     0 -148805.57    0   90 -147572.87 -148805.57  0.84%     -    0s
     0     0 -148237.06    0   48 -147572.87 -148237.06  0.45%     -    0s
     0     0 -147966.93    0   50 -147572.87 -147966.93  0.27%     -    0s
     0     0 -147958.60    0   46 -147572.87 -147958.60  0.26%     -    0s
     0     0 -147957.59    0   45 -147572.87 -147957.59  0.26%     -    0s
     0     0 -147924.40    0   48 -147572.87 -147924.40  0.24%     -    0s
     0     0 -147923.27    0   46 -147572.87 -147923.27  0.24%     -    0s
     0     0 -147916.64    0   44 -147572.87 -147916.64  0.23%     -    0s
     0     0 -147914.95    0   21 -147572.87 -147914.95  0.23%     -    0s
     0     0 -147787.04    0   35 -147572.87 -147787.04  0.15%     -    0s
     0     0 -147778.01    0   15 -147572.87 -147778.01  0.14%     -    0s
H    0     0                    -147602.8673 -147751.18  0.10%     -    0s
     0     0 -147695.88    0   15 -147602.87 -147695.88  0.06%     -    0s
     0     0 -147678.52    0    8 -147602.87 -147678.52  0.05%     -    0s
     0     0 -147675.80    0    9 -147602.87 -147675.80  0.05%     -    0s
     0     0 -147641.85    0    6 -147602.87 -147641.85  0.03%     -    0s
     0     0 -147641.85    0   10 -147602.87 -147641.85  0.03%     -    0s
H    0     0                    -147615.9784 -147641.85  0.02%     -    0s
*    0     0               0    -147629.3529 -147629.35  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 3
  Flow cover: 4
  RLT: 1

Explored 1 nodes (791 simplex iterations) in 0.12 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -147629 -147616 -147603 ... 7.01951e+06
No other solutions better than -147629

Optimal solution found (tolerance 1.00e-06)
Best objective -1.476293529204e+05, best bound -1.476293529204e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 160293.29
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147629.35
  [DEBUG]   S×d_nominal = 307922.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307922.64 + -147629.35 = 160293.29
  [DEBUG]   Current θ from Master = 179208.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18914.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6652.96
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 2233.7053, Absolute Gap = 2233.7053, Relative Gap = 0.087364
  Not converged yet (gap = 2233.71 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0x72486822
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49670 rows and 20180 columns
Presolve time: 1.68s
Presolved: 58743 rows, 25760 columns, 365549 nonzeros
Variable types: 23501 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339436.1647
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58743 rows, 25760 columns, 365549 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26196   -7.9757550e+04   0.000000e+00   5.865045e+07      5s
   39392    1.8311849e+04   0.000000e+00   1.390737e+07     10s
   48478    3.5241826e+04   0.000000e+00   8.541490e+05     15s
   54854    3.8928403e+04   0.000000e+00   2.565362e+06     20s
   61628    4.3208271e+04   0.000000e+00   4.758837e+06     25s
   67974    4.5840312e+04   0.000000e+00   7.310329e+06     30s
   74596    4.8970758e+04   0.000000e+00   1.196582e+06     35s
Concurrent spin time: 7.57s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 5.489372e+04, 47807 iterations, 39.24 seconds (51.12 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54893.7213    0  120 -239613.87 54893.7213   123%     -   41s
H    0     0                    -230918.4802 54893.7213   124%     -   41s
H    0     0                    -114486.4977 54893.7213   148%     -   42s
H    0     0                    -111306.6168 54893.7213   149%     -   42s
H    0     0                    -110985.5095 54893.7213   149%     -   42s
H    0     0                    -44608.21479 54893.7213   223%     -   42s
H    0     0                    -44248.07777 54893.7213   224%     -   42s
H    0     0                    -6438.375993 54893.7213   953%     -   42s
H    0     0                    -6240.044459 54893.7213   980%     -   42s
H    0     0                    20555.123279 54893.7213   167%     -   43s
H    0     0                    21425.986371 54893.7213   156%     -   43s
H    0     0                    23222.095070 54893.7213   136%     -   43s
H    0     0                    23263.464267 54893.7213   136%     -   43s
H    0     0                    23263.600437 54893.7213   136%     -   43s
H    0     0                    23286.505319 54893.7213   136%     -   43s
H    0     0                    24159.193522 54893.7213   127%     -   43s
H    0     0                    24226.022988 54893.7213   127%     -   43s
H    0     0                    24302.761963 54893.7213   126%     -   43s
H    0     0                    24337.755265 49965.8449   105%     -   53s
H    0     0                    24388.498823 49965.8449   105%     -   53s
     0     0 49750.6012    0  156 24388.4988 49750.6012   104%     -   53s
     0     0 49067.6900    0  183 24388.4988 49067.6900   101%     -   59s
     0     0 49067.6900    0  175 24388.4988 49067.6900   101%     -   60s
     0     0 49067.6900    0  183 24388.4988 49067.6900   101%     -   60s
     0     0 49067.6900    0  183 24388.4988 49067.6900   101%     -   60s
H    0     0                    24533.024659 47266.8888  92.7%     -   70s
     0     0 47204.7695    0  267 24533.0247 47204.7695  92.4%     -   70s
     0     0 46782.0254    0  334 24533.0247 46782.0254  90.7%     -   78s
     0     0 46505.2800    0  327 24533.0247 46505.2800  89.6%     -   83s
     0     0 46452.1188    0  340 24533.0247 46452.1188  89.3%     -   84s
     0     0 46400.9549    0  331 24533.0247 46400.9549  89.1%     -   85s
     0     0 46390.5737    0  335 24533.0247 46390.5737  89.1%     -   86s
     0     0 46383.5506    0  341 24533.0247 46383.5506  89.1%     -   86s
     0     0 46382.2177    0  341 24533.0247 46382.2177  89.1%     -   87s
     0     0 46378.7856    0  283 24533.0247 46378.7856  89.0%     -   87s
     0     0 46378.2120    0  342 24533.0247 46378.2120  89.0%     -   87s
     0     0 44482.4999    0  332 24533.0247 44482.4999  81.3%     -  102s
     0     0 43964.2261    0  336 24533.0247 43964.2261  79.2%     -  109s
     0     0 43793.4024    0  347 24533.0247 43793.4024  78.5%     -  112s
     0     0 43649.5763    0  353 24533.0247 43649.5763  77.9%     -  116s
     0     0 43629.4532    0  353 24533.0247 43629.4532  77.8%     -  117s
     0     0 43613.6117    0  364 24533.0247 43613.6117  77.8%     -  118s
     0     0 43599.8339    0  363 24533.0247 43599.8339  77.7%     -  119s
     0     0 43594.6749    0  361 24533.0247 43594.6749  77.7%     -  120s
     0     0 43593.3599    0  364 24533.0247 43593.3599  77.7%     -  120s
     0     0 43588.8968    0  356 24533.0247 43588.8968  77.7%     -  121s
     0     0 43587.6704    0  358 24533.0247 43587.6704  77.7%     -  121s
     0     0 43586.5554    0  363 24533.0247 43586.5554  77.7%     -  121s
     0     0 43128.4127    0  393 24533.0247 43128.4127  75.8%     -  134s
     0     0 42925.8079    0  390 24533.0247 42925.8079  75.0%     -  141s
     0     0 42876.3935    0  377 24533.0247 42876.3935  74.8%     -  143s
     0     0 42807.8051    0  389 24533.0247 42807.8051  74.5%     -  146s
     0     0 42754.7454    0  392 24533.0247 42754.7454  74.3%     -  149s
     0     0 42744.7941    0  437 24533.0247 42744.7941  74.2%     -  151s
     0     0 42712.4418    0  448 24533.0247 42712.4418  74.1%     -  153s
     0     0 42708.2122    0  447 24533.0247 42708.2122  74.1%     -  154s
     0     0 42695.1214    0  443 24533.0247 42695.1214  74.0%     -  156s
     0     0 42688.1195    0  448 24533.0247 42688.1195  74.0%     -  157s
     0     0 42679.7170    0  405 24533.0247 42679.7170  74.0%     -  157s
     0     0 42677.5370    0  406 24533.0247 42677.5370  74.0%     -  158s
     0     0 42677.1260    0  407 24533.0247 42677.1260  74.0%     -  159s
     0     0 42581.9898    0  463 24533.0247 42581.9898  73.6%     -  164s
     0     0 42537.9536    0  455 24533.0247 42537.9536  73.4%     -  167s
     0     0 42520.9104    0  465 24533.0247 42520.9104  73.3%     -  169s
     0     0 42507.7398    0  461 24533.0247 42507.7398  73.3%     -  170s
     0     0 42497.0625    0  464 24533.0247 42497.0625  73.2%     -  171s
     0     0 42494.7135    0  466 24533.0247 42494.7135  73.2%     -  171s
     0     0 42494.5148    0  464 24533.0247 42494.5148  73.2%     -  172s
     0     0 42422.1600    0  415 24533.0247 42422.1600  72.9%     -  175s
     0     0 42396.1902    0  416 24533.0247 42396.1902  72.8%     -  178s
     0     0 42390.0257    0  417 24533.0247 42390.0257  72.8%     -  178s
     0     0 42385.2137    0  466 24533.0247 42385.2137  72.8%     -  179s
     0     0 42384.1242    0  425 24533.0247 42384.1242  72.8%     -  179s
     0     0 42344.4309    0  462 24533.0247 42344.4309  72.6%     -  183s
     0     0 42337.9248    0  467 24533.0247 42337.9248  72.6%     -  185s
     0     0 42335.3458    0  455 24533.0247 42335.3458  72.6%     -  185s
H    0     0                    24544.672223 42333.6222  72.5%     -  186s
     0     0 42333.6222    0  468 24544.6722 42333.6222  72.5%     -  186s
     0     0 42332.7268    0  468 24544.6722 42332.7268  72.5%     -  186s
     0     0 42272.4612    0  417 24544.6722 42272.4612  72.2%     -  190s
     0     0 42262.0912    0  459 24544.6722 42262.0912  72.2%     -  191s
     0     0 42257.9774    0  460 24544.6722 42257.9774  72.2%     -  193s
     0     0 42254.8298    0  424 24544.6722 42254.8298  72.2%     -  193s
     0     0 42253.4574    0  420 24544.6722 42253.4574  72.1%     -  194s
     0     0 42249.6200    0  458 24544.6722 42249.6200  72.1%     -  195s
     0     0 42247.6289    0  457 24544.6722 42247.6289  72.1%     -  195s
     0     0 42246.6422    0  470 24544.6722 42246.6422  72.1%     -  196s
     0     0 42238.8072    0  436 24544.6722 42238.8072  72.1%     -  198s
     0     0 42236.3061    0  428 24544.6722 42236.3061  72.1%     -  199s
     0     0 42235.9919    0  428 24544.6722 42235.9919  72.1%     -  199s
     0     0 42234.8274    0  424 24544.6722 42234.8274  72.1%     -  200s
     0     0 42234.5897    0  424 24544.6722 42234.5897  72.1%     -  201s
     0     0 42234.1092    0  422 24544.6722 42234.1092  72.1%     -  202s
     0     0 42234.0284    0  422 24544.6722 42234.0284  72.1%     -  204s
H    0     2                    24552.769673 42234.0284  72.0%     -  269s
     0     2 42234.0284    0  422 24552.7697 42234.0284  72.0%     -  269s
     1     4 42167.0422    1  399 24552.7697 42233.9685  72.0%  3596  273s
     3     8 42049.5522    2  407 24552.7697 42166.8687  71.7%  3475  278s
     7    16 41857.8275    3  455 24552.7697 42082.5696  71.4%  4417  287s
    15    32 41673.3401    4  471 24552.7697 41877.7058  70.6%  4894  296s
    31    48 40062.3874    5  382 24552.7697 41750.3732  70.0%  7318  318s
    47    80 40916.4557    6  396 24552.7697 41750.3732  70.0%  6845  336s
    79   112 40868.9084    7  381 24552.7697 41750.3732  70.0%  5639  351s
   111   144 40765.5506    8  377 24552.7697 41750.3732  70.0%  4458  362s
   143   176 40829.8884    8  372 24552.7697 41750.3732  70.0%  3722  375s
   175   208 40750.8513    9  377 24552.7697 41750.3732  70.0%  3286  392s
   207   240 40819.0886    9  363 24552.7697 41750.3732  70.0%  3051  407s
   239   272 40425.9445    9  380 24552.7697 41750.3732  70.0%  2876  422s
   271   330 40682.2135   10  365 24552.7697 41750.3732  70.0%  2778  436s
   329   362 40666.9239   10  370 24552.7697 41750.3732  70.0%  2600  447s
   361   420 40483.6427    9  368 24552.7697 41750.3732  70.0%  2555  459s
   419   528 40744.3521   10  369 24552.7697 41750.3732  70.0%  2363  475s
   527   651 40738.7823   10  361 24552.7697 41750.3732  70.0%  2169  488s
   650   769 40314.6898   10  373 24552.7697 41750.3732  70.0%  1998  502s
   768   892 40579.1500   12  362 24552.7697 41750.3732  70.0%  1858  512s
   891  1025 39823.6932   11  341 24552.7697 41750.3732  70.0%  1755  519s
  1028  1130 39876.2093   12  372 24552.7697 41750.3732  70.0%  1628  527s
  1151  1269 40148.1520   13  357 24552.7697 41750.3732  70.0%  1577  538s
  1305  1421 40227.9770   13  358 24552.7697 41750.3732  70.0%  1496  550s
  1472  1509 38694.3918   12  225 24552.7697 41750.3732  70.0%  1417  562s
  1626  1537 40058.1425   14  308 24552.7697 41750.3732  70.0%  1376  576s
  1718  1596 39999.8296   14  293 24552.7697 41750.3732  70.0%  1419  590s
  1800  1683 37125.4819   14  379 24552.7697 41672.8542  69.7%  1473  604s
  1922  1745 37388.3839   14  344 24552.7697 41672.8542  69.7%  1484  618s
  2024  1778 38526.6751   15  335 24552.7697 41672.8542  69.7%  1520  635s
  2105  1814 38830.5089   15  321 24552.7697 41672.8542  69.7%  1574  650s
  2186  1846 34003.3654   17  320 24552.7697 41403.8141  68.6%  1626  665s
  2254  1931 32217.4376   17  247 24552.7697 41403.8141  68.6%  1655  682s
  2363  1984 33991.9221   16  372 24552.7697 41325.0252  68.3%  1673  699s
  2457  2077 36792.7505   16  304 24552.7697 41325.0252  68.3%  1705  715s
  2560  2182 33874.8996   11  299 24552.7697 41124.5279  67.5%  1736  731s
  2673  2282 33934.8255   18  321 24552.7697 41124.5279  67.5%  1747  746s
  2812  2390 33152.5975   22  192 24552.7697 41124.5279  67.5%  1761  763s
  3002  2485 32573.8632   25  195 24552.7697 41095.6331  67.4%  1750  781s
  3153  2603 32106.9082   24  205 24552.7697 41023.1433  67.1%  1754  801s
  3326  2762 31973.7568   28  293 24552.7697 40963.0600  66.8%  1766  820s
  3533  2947 31900.4294   27  231 24552.7697 40963.0600  66.8%  1760  840s
  3760  2948 38457.5240   13  422 24552.7697 40899.9222  66.6%  1752  889s
  3762  2949 25928.8988   29  120 24552.7697 40899.9222  66.6%  1752  925s
  3763  2950 30884.6662   61  339 24552.7697 40899.9222  66.6%  1751  951s
  3764  2951 32146.6747   27  415 24552.7697 40899.9222  66.6%  1751  964s
  3765  2951 36501.2213   34  394 24552.7697 40899.9222  66.6%  1750  975s
  3766  2952 27603.6043   43  382 24552.7697 40899.9222  66.6%  1750  986s
  3767  2953 29916.0872   55  465 24552.7697 40899.9222  66.6%  1749  992s
  3768  2953 39827.5750    9  489 24552.7697 40899.9222  66.6%  1749  998s
  3769  2954 30523.2987   35  469 24552.7697 40899.9222  66.6%  1748 1002s
  3770  2955 27485.0119   86  469 24552.7697 40899.9222  66.6%  1748 1005s
  3773  2957 39457.4526    8  506 24552.7697 40899.9222  66.6%  1746 1010s
  3775  2958 27630.8172   22  470 24552.7697 40899.9222  66.6%  1746 1019s
  3776  2959 33434.3070   12  471 24552.7697 40899.9222  66.6%  1745 1022s
  3778  2960 38151.2668   17  463 24552.7697 40899.9222  66.6%  1744 1025s
  3779  2961 31024.3810   41  486 24552.7697 40899.9222  66.6%  1744 1032s
  3780  2961 26059.6161   34  484 24552.7697 40899.9222  66.6%  1743 1035s
  3783  2963 34028.8400   20  487 24552.7697 40899.9222  66.6%  1742 1044s
  3784  2964 39842.7043    9  489 24552.7697 40899.9222  66.6%  1741 1047s
  3786  2965 32320.6672   46  495 24552.7697 40899.9222  66.6%  1740 1051s
  3787  2966 26438.7114   20  500 24552.7697 40899.9222  66.6%  1740 1056s
  3789  2967 36446.4043   21  493 24552.7697 40899.9222  66.6%  1739 1060s
  3790  2968 37677.0632   22  490 24552.7697 40899.9222  66.6%  1739 1067s
  3792  2969 38678.0441   24  532 24552.7697 40899.9222  66.6%  1738 1072s
  3793  2970 39164.3880   12  494 24552.7697 40899.9222  66.6%  1737 1079s
  3794  2971 34348.8565   39  539 24552.7697 40899.9222  66.6%  1737 1082s
  3795  2971 40049.9913   12  546 24552.7697 40899.9222  66.6%  1736 1085s
  3796  2972 33734.2486   13  539 24552.7697 40899.9222  66.6%  1736 1092s
  3797  2973 36698.5477   10  548 24552.7697 40899.9222  66.6%  1735 1095s
  3798  2973 32617.6852   28  483 24552.7697 40899.9222  66.6%  1735 1100s
  3800  2975 33641.7499   37  489 24552.7697 40899.9222  66.6%  1734 1108s
  3801  2975 28145.3543   51  489 24552.7697 40899.9222  66.6%  1734 1141s
  3802  2976 39833.3099   11  489 24552.7697 40899.9222  66.6%  1733 1165s
  3803  2980 40899.9222   14  479 24552.7697 40899.9222  66.6%  1787 1194s
  3805  2983 40899.9222   15  470 24552.7697 40899.9222  66.6%  1788 1208s
  3809  2990 40899.9222   16  460 24552.7697 40899.9222  66.6%  1793 1227s
  3817  3003 40899.9222   17  476 24552.7697 40899.9222  66.6%  1806 1252s
  3833  3014 40698.8368   18  459 24552.7697 40899.9222  66.6%  1850 1295s
  3849  3040 38886.1809   19  504 24552.7697 40899.9222  66.6%  1879 1331s
  3881  3131 38456.6770   20  450 24552.7697 40899.9222  66.6%  1944 1363s
  3982  3132 37614.9417   23  423 24552.7697 40899.9222  66.6%  2073 1384s
  4017  3165 37331.1472   24  420 24552.7697 40899.9222  66.6%  2105 1410s
  4083  3200 37004.3374   23  352 24552.7697 40899.9222  66.6%  2145 1431s
  4170  3220 33595.8872   25  338 24552.7697 40899.9222  66.6%  2168 1451s
H 4178  3068                    24790.288701 40899.9222  65.0%  2170 1451s
  4258  3086 34039.2763   24  380 24790.2887 40899.9222  65.0%  2180 1469s
  4356  3086 35723.2232   24  374 24790.2887 40899.9222  65.0%  2182 1487s
  4446  3079 34555.5788   26  357 24790.2887 40899.9222  65.0%  2187 1512s
  4521  3097 35587.1324   27  354 24790.2887 40811.7692  64.6%  2194 1532s
  4597  3087 34444.7596   29  278 24790.2887 40811.7692  64.6%  2202 1553s
  4666  3089 30897.9345   30  287 24790.2887 40811.7692  64.6%  2213 1571s
  4726  3105 32532.7410   28  340 24790.2887 40811.7692  64.6%  2227 1591s
  4798  3124 31593.5943   29  332 24790.2887 40811.7692  64.6%  2240 1612s
  4866  3140 30311.5031   31  342 24790.2887 40811.7692  64.6%  2260 1630s
  4940  3173 27720.1760   30  332 24790.2887 40811.7692  64.6%  2271 1649s
  5017  3182 30230.7502   33  287 24790.2887 40811.7692  64.6%  2281 1663s
H 5029  3036                    24903.000923 40811.7692  63.9%  2279 1663s
  5076  3088 30119.4982   32  396 24903.0009 40811.7692  63.9%  2285 1683s
  5181  3112 29258.2366   37  222 24903.0009 40341.9581  62.0%  2285 1702s
  5299  3106     cutoff   36      24903.0009 40341.9581  62.0%  2284 1726s
  5404  3122 infeasible   39      24903.0009 40341.9581  62.0%  2293 1750s
  5508  3150 31197.1277   22  317 24903.0009 40341.9581  62.0%  2305 1773s
  5613  3179 30237.2531   24  288 24903.0009 40341.9581  62.0%  2319 1796s
  5727  3200 29248.6003   28  301 24903.0009 40341.9581  62.0%  2332 1820s
  5842  3180 28911.2851   29  257 24903.0009 40341.9581  62.0%  2344 1838s
  5883  3180 28601.6348   30  208 24903.0009 38700.7846  55.4%  2348 1857s
H 5900  3040                    25538.650118 38700.7846  51.5%  2351 1857s
  5931  3065 28179.6717   31  210 25538.6501 38685.5444  51.5%  2357 1885s
  6049  3049     cutoff   39      25538.6501 38685.5444  51.5%  2374 1907s
  6090  3063 infeasible   38      25538.6501 38685.5444  51.5%  2383 1926s
  6125  3087     cutoff   38      25538.6501 38685.5444  51.5%  2393 1944s
  6168  3098 32818.7840   22  379 25538.6501 38685.5444  51.5%  2399 1972s
  6236  3105 28338.4230   25  240 25538.6501 38685.5444  51.5%  2403 1997s
  6333  3137     cutoff   27      25538.6501 38074.3766  49.1%  2409 2025s
  6450  3142     cutoff   32      25538.6501 37643.1115  47.4%  2426 2052s
  6578  3151 32420.9168   21  222 25538.6501 37643.1115  47.4%  2433 2085s
  6728  3219 27050.9153   22  203 25538.6501 37533.9005  47.0%  2449 2120s
  6909  3259 30187.4658   23  308 25538.6501 37533.9005  47.0%  2456 2155s
  7105  3193 26704.2494   27   98 25538.6501 37232.2888  45.8%  2463 2194s
  7284  3184 31791.3984   23  422 25538.6501 37172.0806  45.6%  2487 2236s
  7442  3220 28703.6933   26  293 25538.6501 36881.8910  44.4%  2522 2278s
  7657  3174 infeasible   33      25538.6501 36798.9304  44.1%  2531 2308s
  7776  3186 25783.2252   40  125 25538.6501 36798.9304  44.1%  2526 2348s
  8000  3217 26114.2067   26  293 25538.6501 36514.2078  43.0%  2539 2394s
  8235  3246 28834.7279   23  266 25538.6501 36236.9318  41.9%  2553 2439s
  8503  3232 27112.7262   28  251 25538.6501 36236.9318  41.9%  2560 2489s
  8771  3279 28785.5324   22  223 25538.6501 35616.1307  39.5%  2578 2535s
  9068  3262 25867.0301   36  269 25538.6501 35223.4160  37.9%  2583 2582s
  9361  3206 infeasible   23      25538.6501 34930.2946  36.8%  2600 2635s
  9638  3162     cutoff   26      25538.6501 34438.5266  34.8%  2626 2682s
  9902  3088 31145.4381   24  198 25538.6501 33934.8966  32.9%  2640 2733s
 10195  3028 27580.3940   33  174 25538.6501 33702.9056  32.0%  2668 2789s
 10310  2990 27486.7864   33  164 25538.6501 33552.7464  31.4%  2678 2790s
 10489  2990 25873.0885   37  199 25538.6501 33463.4702  31.0%  2696 2850s
 10800  3044 infeasible   28      25538.6501 33224.3252  30.1%  2727 2910s
 11206  3032 26546.3760   30  329 25538.6501 33181.1184  29.9%  2735 2965s
 11601  3009 27210.4446   27  283 25538.6501 33019.8261  29.3%  2745 3031s
 11981  3119 25639.9807   25  198 25538.6501 33019.8261  29.3%  2763 3096s
 12378  3183 infeasible   33      25538.6501 32526.4877  27.4%  2781 3166s
 12803  3268 infeasible   28      25538.6501 32357.9040  26.7%  2797 3239s
 13242  3365     cutoff   37      25538.6501 32092.2529  25.7%  2813 3306s
 13696  3499 26286.6238   26  194 25538.6501 31893.5915  24.9%  2827 3381s
 14188  3622 27665.3497   28  340 25538.6501 31796.2079  24.5%  2829 3455s
 14718  3631 infeasible   30      25538.6501 31614.4531  23.8%  2835 3540s
 15286  3675 27351.7053   25  328 25538.6501 31383.4104  22.9%  2844 3600s

Cutting planes:
  Gomory: 1
  MIR: 559
  Flow cover: 2598
  RLT: 21
  Relax-and-lift: 204

Explored 15750 nodes (44934384 simplex iterations) in 3600.04 seconds (6719.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25538.7 24903 24790.3 ... 24226

Time limit reached
Best objective 2.553865011788e+04, best bound 3.137660143795e+04, gap 22.8593%
  WARNING: Time limit reached. Using best solution found (gap: 22.86%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 25538.65, θ = 180989.62
  Upper Bound (UB) = 25538.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 180989.62
  [DEBUG]   ✓ Scenario 0: θ = 180989.62 ≤ Q = 180989.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 180989.62 ≤ Q = 180989.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 180989.62 ≤ Q = 180989.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 180989.62 ≤ Q = 180989.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 180989.62 ≤ Q = 180989.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 180989.62 ≤ Q = 180989.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 180989.62 ≤ Q = 180989.62 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4876dad2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb789252e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.459559e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 7061748.2966
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.596225e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159622.52    0  129 7061748.30 -159622.52   102%     -    0s
H    0     0                    -122380.1507 -159622.52  30.4%     -    0s
H    0     0                    -122687.1870 -159622.52  30.1%     -    0s
H    0     0                    -124611.5899 -142867.36  14.7%     -    0s
H    0     0                    -132921.3220 -142867.36  7.48%     -    0s
     0     0 -142867.36    0   92 -132921.32 -142867.36  7.48%     -    0s
H    0     0                    -136917.1573 -142812.36  4.31%     -    0s
H    0     0                    -140488.1346 -142800.95  1.65%     -    0s
H    0     0                    -141150.1529 -142800.95  1.17%     -    0s
     0     0 -142800.95    0   85 -141150.15 -142800.95  1.17%     -    0s
     0     0 -142792.89    0   86 -141150.15 -142792.89  1.16%     -    0s
     0     0 -142322.08    0   74 -141150.15 -142322.08  0.83%     -    0s
     0     0 -141972.91    0   42 -141150.15 -141972.91  0.58%     -    0s
     0     0 -141924.67    0   50 -141150.15 -141924.67  0.55%     -    0s
     0     0 -141924.51    0   50 -141150.15 -141924.51  0.55%     -    0s
     0     0 -141447.53    0   42 -141150.15 -141447.53  0.21%     -    0s
     0     0 -141428.32    0   25 -141150.15 -141428.32  0.20%     -    0s
     0     0 -141380.32    0   35 -141150.15 -141380.32  0.16%     -    0s
     0     0 -141354.95    0   26 -141150.15 -141354.95  0.15%     -    0s
     0     0 -141347.80    0   25 -141150.15 -141347.80  0.14%     -    0s
     0     0 -141340.30    0   21 -141150.15 -141340.30  0.13%     -    0s
     0     0 -141329.23    0   30 -141150.15 -141329.23  0.13%     -    0s
     0     0 -141236.00    0   11 -141150.15 -141236.00  0.06%     -    0s
     0     0 -141236.00    0   15 -141150.15 -141236.00  0.06%     -    0s
H    0     0                    -141181.9016 -141236.00  0.04%     -    0s
     0     0 -141205.74    0    2 -141181.90 -141205.74  0.02%     -    0s
H    0     0                    -141193.8501 -141204.41  0.01%     -    0s
H    0     0                    -141204.4110 -141204.41  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 3
  Flow cover: 7

Explored 1 nodes (865 simplex iterations) in 0.13 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -141204 -141194 -141182 ... -122687
No other solutions better than -141204

Optimal solution found (tolerance 1.00e-06)
Best objective -1.412044110427e+05, best bound -1.412044110427e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 166425.23
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141204.41
  [DEBUG]   S×d_nominal = 307629.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 307629.65 + -141204.41 = 166425.23
  [DEBUG]   Current θ from Master = 180989.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14564.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10974.27
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 2204.4833, Absolute Gap = 2204.4833, Relative Gap = 0.086319
  Not converged yet (gap = 2204.48 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0xa0f68ead
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56800 rows and 23080 columns
Presolve time: 1.87s
Presolved: 66903 rows, 29100 columns, 416879 nonzeros
Variable types: 26841 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339436.1647
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66903 rows, 29100 columns, 416879 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29305   -1.2534532e+05   0.000000e+00   4.573807e+07      5s
   44496    6.7426293e+03   0.000000e+00   2.092809e+07     10s
   53333    2.2053881e+04   0.000000e+00   6.801896e+06     15s
   59592    2.7596144e+04   0.000000e+00   4.260801e+07     20s
   66903    3.8873444e+04   0.000000e+00   1.780480e+06     25s
   72732    4.1297408e+04   0.000000e+00   3.272371e+06     30s
   78383    4.4339428e+04   0.000000e+00   4.537879e+06     35s
   85009    4.5929444e+04   0.000000e+00   4.987089e+06     40s
   90467    4.8751811e+04   0.000000e+00   1.592551e+07     45s
   96526    5.0400788e+04   0.000000e+00   1.467138e+06     50s
  100905    5.0444127e+04   0.000000e+00   3.608955e+06     55s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 5.488867e+04, 76243 iterations, 52.92 seconds (63.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54888.6694    0  128 -239613.87 54888.6694   123%     -   55s
H    0     0                    -226156.4263 54888.6694   124%     -   55s
H    0     0                    -137588.7074 54888.6694   140%     -   55s
H    0     0                    -135325.2654 54888.6694   141%     -   55s
H    0     0                    -128614.6815 54888.6694   143%     -   56s
H    0     0                    -128185.1135 54888.6694   143%     -   56s
H    0     0                    -33199.97300 54888.6694   265%     -   56s
H    0     0                    -32839.83597 54888.6694   267%     -   56s
H    0     0                    -6103.815786 54888.6694   999%     -   56s
H    0     0                    -5905.484251 54888.6694  1029%     -   56s
H    0     0                    6738.4177955 54888.6694   715%     -   56s
H    0     0                    13134.555586 54888.6694   318%     -   57s
H    0     0                    21425.986371 54888.6694   156%     -   57s
H    0     0                    23831.894506 54888.6694   130%     -   57s
H    0     0                    24248.369345 54888.6694   126%     -   57s
H    0     0                    24302.761963 54888.6694   126%     -   57s
     0     0 50008.8224    0  154 24302.7620 50008.8224   106%     -   76s
H    0     0                    24337.755265 50008.7559   105%     -   77s
     0     0 49108.6407    0  185 24337.7553 49108.6407   102%     -   86s
     0     0 49105.0429    0  254 24337.7553 49105.0429   102%     -   89s
     0     0 49071.4762    0  186 24337.7553 49071.4762   102%     -   90s
     0     0 49066.1502    0  194 24337.7553 49066.1502   102%     -   90s
     0     0 49057.1291    0  192 24337.7553 49057.1291   102%     -   91s
     0     0 49056.6751    0  192 24337.7553 49056.6751   102%     -   91s
     0     0 46909.4960    0  323 24337.7553 46909.4960  92.7%     -  105s
     0     0 46553.7524    0  281 24337.7553 46553.7524  91.3%     -  114s
     0     0 46486.8690    0  288 24337.7553 46486.8690  91.0%     -  117s
     0     0 46407.2478    0  334 24337.7553 46407.2478  90.7%     -  119s
     0     0 46255.8043    0  339 24337.7553 46255.8043  90.1%     -  124s
     0     0 46151.2475    0  341 24337.7553 46151.2475  89.6%     -  129s
     0     0 46112.5613    0  345 24337.7553 46112.5613  89.5%     -  131s
     0     0 46110.6684    0  349 24337.7553 46110.6684  89.5%     -  132s
     0     0 46110.5109    0  350 24337.7553 46110.5109  89.5%     -  132s
H    0     0                    24352.558569 46110.5109  89.3%     -  142s
H    0     0                    24512.301927 46110.5109  88.1%     -  142s
     0     0 44714.9434    0  334 24512.3019 44714.9434  82.4%     -  158s
     0     0 44363.4681    0  337 24512.3019 44363.4681  81.0%     -  169s
     0     0 44234.3498    0  336 24512.3019 44234.3498  80.5%     -  174s
     0     0 44172.6021    0  351 24512.3019 44172.6021  80.2%     -  178s
     0     0 44125.4964    0  344 24512.3019 44125.4964  80.0%     -  182s
     0     0 44119.1359    0  351 24512.3019 44119.1359  80.0%     -  183s
     0     0 44109.1602    0  354 24512.3019 44109.1602  79.9%     -  184s
     0     0 44090.0328    0  350 24512.3019 44090.0328  79.9%     -  185s
     0     0 44086.0853    0  357 24512.3019 44086.0853  79.9%     -  186s
     0     0 44081.3795    0  354 24512.3019 44081.3795  79.8%     -  186s
     0     0 44080.8959    0  354 24512.3019 44080.8959  79.8%     -  187s
     0     0 43349.3637    0  418 24512.3019 43349.3637  76.8%     -  207s
     0     0 43102.2556    0  382 24512.3019 43102.2556  75.8%     -  214s
     0     0 42998.2583    0  421 24512.3019 42998.2583  75.4%     -  220s
     0     0 42961.8513    0  435 24512.3019 42961.8513  75.3%     -  223s
     0     0 42936.2805    0  397 24512.3019 42936.2805  75.2%     -  225s
     0     0 42924.6457    0  436 24512.3019 42924.6457  75.1%     -  228s
     0     0 42911.1551    0  438 24512.3019 42911.1551  75.1%     -  230s
     0     0 42907.9261    0  436 24512.3019 42907.9261  75.0%     -  231s
     0     0 42902.0083    0  399 24512.3019 42902.0083  75.0%     -  232s
     0     0 42900.4156    0  396 24512.3019 42900.4156  75.0%     -  233s
     0     0 42899.8244    0  399 24512.3019 42899.8244  75.0%     -  233s
     0     0 42663.8889    0  428 24512.3019 42663.8889  74.1%     -  241s
     0     0 42598.3369    0  439 24512.3019 42598.3369  73.8%     -  245s
     0     0 42572.9099    0  432 24512.3019 42572.9099  73.7%     -  247s
     0     0 42560.9582    0  449 24512.3019 42560.9582  73.6%     -  249s
     0     0 42555.0847    0  453 24512.3019 42555.0847  73.6%     -  250s
     0     0 42548.8877    0  447 24512.3019 42548.8877  73.6%     -  251s
     0     0 42547.7249    0  443 24512.3019 42547.7249  73.6%     -  251s
     0     0 42471.9786    0  438 24512.3019 42471.9786  73.3%     -  258s
     0     0 42419.5777    0  435 24512.3019 42419.5777  73.1%     -  263s
     0     0 42396.3740    0  447 24512.3019 42396.3740  73.0%     -  266s
     0     0 42388.6178    0  454 24512.3019 42388.6178  72.9%     -  268s
     0     0 42384.4871    0  454 24512.3019 42384.4871  72.9%     -  269s
     0     0 42378.9603    0  455 24512.3019 42378.9603  72.9%     -  271s
     0     0 42377.6377    0  457 24512.3019 42377.6377  72.9%     -  272s
     0     0 42296.7034    0  452 24512.3019 42296.7034  72.6%     -  277s
     0     0 42283.6131    0  461 24512.3019 42283.6131  72.5%     -  280s
     0     0 42271.9923    0  455 24512.3019 42271.9923  72.5%     -  281s
     0     0 42265.4867    0  453 24512.3019 42265.4867  72.4%     -  282s
     0     0 42262.3790    0  463 24512.3019 42262.3790  72.4%     -  283s
     0     0 42261.0351    0  456 24512.3019 42261.0351  72.4%     -  284s
     0     0 42236.7422    0  466 24512.3019 42236.7422  72.3%     -  287s
     0     0 42230.2404    0  471 24512.3019 42230.2404  72.3%     -  289s
     0     0 42227.8189    0  478 24512.3019 42227.8189  72.3%     -  290s
     0     0 42226.0248    0  473 24512.3019 42226.0248  72.3%     -  291s
     0     0 42225.3029    0  473 24512.3019 42225.3029  72.3%     -  291s
     0     0 42212.3099    0  425 24512.3019 42212.3099  72.2%     -  294s
     0     0 42207.6861    0  419 24512.3019 42207.6861  72.2%     -  295s
     0     0 42203.0353    0  412 24512.3019 42203.0353  72.2%     -  296s
     0     0 42201.3389    0  420 24512.3019 42201.3389  72.2%     -  296s
     0     0 42200.4329    0  425 24512.3019 42200.4329  72.2%     -  297s
     0     0 42194.5372    0  424 24512.3019 42194.5372  72.1%     -  300s
     0     0 42194.0749    0  421 24512.3019 42194.0749  72.1%     -  301s
H    0     0                    24544.672223 42189.5840  71.9%     -  303s
     0     0 42189.5840    0  411 24544.6722 42189.5840  71.9%     -  303s
     0     0 42187.8986    0  411 24544.6722 42187.8986  71.9%     -  304s
     0     0 42186.4074    0  417 24544.6722 42186.4074  71.9%     -  305s
     0     0 42182.6503    0  412 24544.6722 42182.6503  71.9%     -  307s
     0     0 42180.1235    0  424 24544.6722 42180.1235  71.9%     -  308s
     0     0 42178.5302    0  467 24544.6722 42178.5302  71.8%     -  309s
     0     0 42178.0214    0  469 24544.6722 42178.0214  71.8%     -  309s
     0     0 42164.4931    0  419 24544.6722 42164.4931  71.8%     -  312s
     0     0 42162.3004    0  417 24544.6722 42162.3004  71.8%     -  313s
     0     0 42149.0029    0  475 24544.6722 42149.0029  71.7%     -  316s
     0     0 42144.9942    0  474 24544.6722 42144.9942  71.7%     -  317s
     0     0 42142.2936    0  481 24544.6722 42142.2936  71.7%     -  318s
     0     0 42141.5537    0  478 24544.6722 42141.5537  71.7%     -  319s
     0     0 42138.8176    0  470 24544.6722 42138.8176  71.7%     -  321s
     0     0 42133.7278    0  476 24544.6722 42133.7278  71.7%     -  324s
     0     0 42131.6017    0  477 24544.6722 42131.6017  71.7%     -  325s
     0     0 42130.1765    0  479 24544.6722 42130.1765  71.6%     -  325s
     0     0 42126.3768    0  432 24544.6722 42126.3768  71.6%     -  328s
     0     0 42125.0618    0  429 24544.6722 42125.0618  71.6%     -  329s
     0     0 42123.7182    0  479 24544.6722 42123.7182  71.6%     -  331s
     0     0 42123.3511    0  479 24544.6722 42123.3511  71.6%     -  333s
     0     2 42123.3511    0  479 24544.6722 42123.3511  71.6%     -  401s
     1     4 42068.1888    1  417 24544.6722 42122.2614  71.6%  2692  406s
     3     8 41914.9754    2  406 24544.6722 42066.2470  71.4%  3619  415s
     7    16 41706.4589    3  454 24544.6722 41914.6626  70.8%  5459  426s
    15    32 41384.5457    4  405 24544.6722 41706.0516  69.9%  6129  444s
    31    48 40659.6747    5  410 24544.6722 41383.9428  68.6% 10227  474s
    47    80 39893.7607    6  394 24544.6722 41383.9428  68.6%  9147  489s
    79   192 39648.6335    7  389 24544.6722 41383.9428  68.6%  7242  511s
   191   224 39369.9688    9  374 24544.6722 41383.9428  68.6%  4491  531s
   223   256 39079.6193   10  334 24544.6722 41383.9428  68.6%  4180  544s
   255   297 39155.7929   10  320 24544.6722 41383.9428  68.6%  3947  559s
   296   343 38707.6957    8  360 24544.6722 41383.9428  68.6%  3709  572s
   342   375 39177.5362   10  371 24544.6722 41383.9428  68.6%  3483  585s
   374   411 39122.4814   10  309 24544.6722 41383.9428  68.6%  3376  599s
   412   452 38917.9980   11  392 24544.6722 41383.9428  68.6%  3272  613s
   453   514 38781.7529   11  261 24544.6722 41383.9428  68.6%  3127  626s
   517   594 38941.2487   11  313 24544.6722 41383.9428  68.6%  2888  640s
   597   678 38919.3954   11  305 24544.6722 41383.9428  68.6%  2645  652s
   683   756 38952.2823   11  369 24544.6722 41383.9428  68.6%  2445  664s
   773   842 38717.4030   12  380 24544.6722 41383.9428  68.6%  2288  675s
   873   922 39126.2334   11  315 24544.6722 41383.9428  68.6%  2127  686s
   967  1010 38889.8712   12  373 24544.6722 41383.9428  68.6%  2013  698s
  1069  1091 38932.5417   12  318 24544.6722 41383.9428  68.6%  1946  714s
  1178  1118 38578.0145   13  319 24544.6722 41383.9428  68.6%  1886  728s
  1263  1143 38749.5059   13  315 24544.6722 41383.9428  68.6%  1883  743s
  1328  1186 38225.5579   14  378 24544.6722 41383.9428  68.6%  1912  757s
  1417  1248 33475.8711   14  300 24544.6722 41383.9428  68.6%  1916  774s
  1497  1324 38370.0393   14  376 24544.6722 41383.9428  68.6%  1926  790s
  1599  1402 27299.9602   37  260 24544.6722 41383.9428  68.6%  1921  807s
  1708  1472 25599.7856   39  133 24544.6722 41383.9428  68.6%  1909  823s
  1823  1553 32137.0805   15  356 24544.6722 41383.9428  68.6%  1916  841s
  1934  1631 31985.2645   16  358 24544.6722 41383.9428  68.6%  1926  860s
  2055  1727 31635.0536   17  289 24544.6722 41383.9428  68.6%  1923  878s
  2198  1745 30883.8092   18  340 24544.6722 41383.9428  68.6%  1914  897s
  2237  1770 30258.6115   19  322 24544.6722 41383.9428  68.6%  1939  912s
  2278  1804 30146.9881   20  330 24544.6722 41292.8241  68.2%  1963  934s
  2316  1833 29527.3445   19  340 24544.6722 41292.8241  68.2%  1986  950s
  2353  1870 30090.9972   21  288 24544.6722 41292.8241  68.2%  2000  966s
  2406  1928 29860.6510   22  282 24544.6722 41292.8241  68.2%  2007  982s
  2480  1951 29755.4265   23  326 24544.6722 41292.8241  68.2%  1995  996s
  2527  2009 29627.8237   24  264 24544.6722 41292.8241  68.2%  2003 1012s
  2597  2081 29497.2614   25  278 24544.6722 40749.2476  66.0%  2000 1032s
  2693  2152 28114.0046   23  259 24544.6722 40749.2476  66.0%  1987 1053s
  2808  2191 29279.0768   26  267 24544.6722 40539.7582  65.2%  1983 1076s
  2911  2283 29160.2873   27  359 24544.6722 40539.7582  65.2%  1987 1101s
  3069  2420 29060.9112   28  354 24544.6722 40409.4369  64.6%  1968 1126s
  3275  2549 29041.4692   29  309 24544.6722 40409.4369  64.6%  1943 1148s
  3450  2681 28845.9108   28  357 24544.6722 40409.4369  64.6%  1946 1172s
  3654  2848 28149.3235   31  303 24544.6722 40285.7073  64.1%  1948 1197s
  3891  2849 28889.1588   17  479 24544.6722 40285.7073  64.1%  1935 1271s
  3893  2850 25634.5825   56  128 24544.6722 40285.7073  64.1%  1934 1308s
  3894  2851 31087.8794   17  362 24544.6722 40285.7073  64.1%  1933 1332s
  3895  2852 35356.2572   18  380 24544.6722 40285.7073  64.1%  1933 1346s
  3896  2852 25821.7132   49  407 24544.6722 40285.7073  64.1%  1932 1355s
  3897  2853 38635.5466    9  386 24544.6722 40285.7073  64.1%  1932 1365s
  3898  2854 33249.5336   13  405 24544.6722 40285.7073  64.1%  1931 1372s
  3899  2854 28797.3160   55  411 24544.6722 40285.7073  64.1%  1931 1376s
  3900  2855 27412.8641   20  471 24544.6722 40285.7073  64.1%  1930 1382s
  3901  2856 26162.3768   21  455 24544.6722 40285.7073  64.1%  1930 1387s
  3903  2857 25942.9168   67  425 24544.6722 40285.7073  64.1%  1929 1392s
  3904  2858 33235.4643   13  487 24544.6722 40285.7073  64.1%  1928 1395s
  3905  2858 37435.2959   23  425 24544.6722 40285.7073  64.1%  1928 1400s
  3906  2859 30565.1289   33  469 24544.6722 40285.7073  64.1%  1927 1410s
  3908  2860 26904.2496   57  457 24544.6722 40285.7073  64.1%  1926 1416s
  3910  2862 25170.8965   49  466 24544.6722 40285.7073  64.1%  1925 1421s
  3912  2863 38644.3328   20  456 24544.6722 40285.7073  64.1%  1924 1430s
  3915  2865 33249.5336   13  455 24544.6722 40285.7073  64.1%  1923 1436s
  3916  2866 31293.3357   12  446 24544.6722 40285.7073  64.1%  1923 1443s
  3918  2867 28372.0545   42  463 24544.6722 40285.7073  64.1%  1922 1448s
  3919  2868 34447.3260   23  467 24544.6722 40285.7073  64.1%  1921 1457s
  3920  2868 26420.6883   67  410 24544.6722 40285.7073  64.1%  1921 1460s
  3922  2870 39130.7049    7  411 24544.6722 40285.7073  64.1%  1920 1471s
  3924  2871 38751.3624   12  467 24544.6722 40285.7073  64.1%  1919 1481s
  3925  2872 26352.0910   50  472 24544.6722 40285.7073  64.1%  1918 1485s
  3926  2872 26734.2523   51  520 24544.6722 40285.7073  64.1%  1918 1493s
  3927  2873 29596.8448   25  463 24544.6722 40285.7073  64.1%  1917 1495s
  3929  2874 37881.4593   31  514 24544.6722 40285.7073  64.1%  1916 1507s
  3930  2875 28202.7412   46  464 24544.6722 40285.7073  64.1%  1916 1510s
  3931  2876 26941.6359   33  476 24544.6722 40285.7073  64.1%  1915 1515s
  3932  2876 32240.0072   19  476 24544.6722 40285.7073  64.1%  1915 1554s
  3933  2877 32467.9098   14  476 24544.6722 40285.7073  64.1%  1914 1599s
  3934  2881 40285.7073   13  463 24544.6722 40285.7073  64.1%  1961 1624s
  3936  2884 40285.7073   14  452 24544.6722 40285.7073  64.1%  1963 1643s
  3940  2891 40285.7073   15  414 24544.6722 40285.7073  64.1%  1966 1667s
  3948  2904 40285.7073   16  423 24544.6722 40285.7073  64.1%  1975 1688s
  3964  2917 35984.1976   17  250 24544.6722 40285.7073  64.1%  2023 1725s
  3982  2943 36397.5667   18  255 24544.6722 40285.7073  64.1%  2052 1751s
  4014  2998 36235.1619   19  253 24544.6722 40285.7073  64.1%  2094 1778s
  4080  3055 35911.5942   20  241 24544.6722 40285.7073  64.1%  2156 1806s
  4159  3087 32402.5321   21  359 24544.6722 40285.7073  64.1%  2187 1830s
  4231  3109 32153.7373   21  193 24544.6722 40285.7073  64.1%  2210 1851s
  4290  3146 32266.3117   22  402 24544.6722 40285.7073  64.1%  2240 1870s
  4380  3127 31252.2452   22  199 24544.6722 40285.7073  64.1%  2246 1893s
  4439  3117 31102.6130   23  366 24544.6722 40285.7073  64.1%  2270 1921s
  4478  3122 30756.2773   23  352 24544.6722 40285.7073  64.1%  2296 1940s
  4529  3131 25756.2476   22  156 24544.6722 40285.7073  64.1%  2315 1960s
  4572  3144 26164.7309   23  352 24544.6722 40285.7073  64.1%  2325 1983s
  4620  3150 25880.3352   23  391 24544.6722 40285.7073  64.1%  2334 2003s
  4670  3156     cutoff   23      24544.6722 40285.7073  64.1%  2349 2026s
  4724  3172 25448.4458   25  350 24544.6722 40285.7073  64.1%  2356 2041s
  4782  3176 25231.9568   27  335 24544.6722 40285.7073  64.1%  2359 2059s
  4829  3192     cutoff   27      24544.6722 40285.7073  64.1%  2371 2079s
  4894  3186 25269.9703   26  337 24544.6722 40285.7073  64.1%  2376 2102s
  4935  3190 infeasible   27      24544.6722 40285.7073  64.1%  2383 2120s
  4974  3199 infeasible   27      24544.6722 40118.7932  63.5%  2389 2138s
  5028  3202 35213.3390   20  440 24544.6722 40118.7932  63.5%  2393 2157s
  5085  3213 35169.7695   21  450 24544.6722 40118.7932  63.5%  2398 2177s
  5143  3224 34501.6692   22  372 24544.6722 40118.7932  63.5%  2410 2199s
  5220  3219 34352.7050   23  363 24544.6722 40118.7932  63.5%  2412 2220s
  5303  3224 33475.7850   24  438 24544.6722 40118.7932  63.5%  2418 2247s
  5398  3213 33295.3408   25  378 24544.6722 38864.8068  58.3%  2427 2269s
  5437  3229 31943.8158   26  327 24544.6722 38510.4489  56.9%  2437 2290s
  5490  3247 31547.9085   27  345 24544.6722 38510.4489  56.9%  2446 2312s
  5552  3258 29281.0021   30  278 24544.6722 38510.4489  56.9%  2458 2335s
  5633  3263     cutoff   33      24544.6722 38368.4402  56.3%  2466 2368s
  5723  3269     cutoff   37      24544.6722 38324.4048  56.1%  2474 2394s
  5840  3284 31246.0101   20  313 24544.6722 38324.4048  56.1%  2478 2421s
  5960  3287 26618.6462   23  195 24544.6722 38324.4048  56.1%  2490 2454s
  6103  3273 24901.8044   26  150 24544.6722 38102.2174  55.2%  2504 2485s
  6224  3290 infeasible   26      24544.6722 38102.2174  55.2%  2535 2516s
  6370  3339 28075.7885   23  205 24544.6722 38032.8948  55.0%  2559 2546s
  6526  3348 infeasible   24      24544.6722 37342.1097  52.1%  2579 2579s
  6749  3314     cutoff   25      24544.6722 37268.6467  51.8%  2578 2619s
  6930  3293 30508.4978   19  355 24544.6722 37218.3889  51.6%  2594 2661s
  7084  3274 25870.0379   22  207 24544.6722 37218.3889  51.6%  2625 2698s
  7230  3281 28489.7821   21  255 24544.6722 37218.3889  51.6%  2660 2745s
  7373  3281 infeasible   25      24544.6722 37218.3889  51.6%  2692 2790s
  7579  3279 27031.2020   28  387 24544.6722 37218.3889  51.6%  2706 2835s
  7777  3295 infeasible   32      24544.6722 37218.3889  51.6%  2730 2883s
  7999  3319 30540.0968   23  311 24544.6722 36491.3116  48.7%  2743 2931s
  8249  3300 infeasible   29      24544.6722 36188.1857  47.4%  2746 2981s
  8513  3327 28351.9346   25  210 24544.6722 36067.5121  46.9%  2753 3031s
  8732  3303 25623.3290   32  199 24544.6722 35987.6429  46.6%  2778 3076s
  8958  3322 28450.8659   26  233 24544.6722 35935.8382  46.4%  2787 3133s
  9257  3305 infeasible   28      24544.6722 35647.9867  45.2%  2793 3189s
  9496  3265     cutoff   32      24544.6722 35642.8807  45.2%  2825 3246s
  9779  3228 25522.4779   27  225 24544.6722 35522.8112  44.7%  2849 3307s
 10078  3171 24821.8912   22  233 24544.6722 35458.5753  44.5%  2870 3369s
 10413  3097 27522.6913   24  240 24544.6722 35212.4648  43.5%  2893 3431s
 10716  3016 25840.1236   26  235 24544.6722 35169.1191  43.3%  2928 3499s
 11079  3000 29797.7963   24  206 24544.6722 35169.1191  43.3%  2956 3573s
 11456  2873 31125.5913   23  364 24544.6722 34882.5928  42.1%  2975 3600s

Cutting planes:
  MIR: 814
  Mixing: 1
  Flow cover: 3176
  RLT: 16
  Relax-and-lift: 245

Explored 11579 nodes (34721007 simplex iterations) in 3600.04 seconds (6473.23 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 24544.7 24512.3 24352.6 ... 6738.42

Time limit reached
Best objective 2.454467222271e+04, best bound 3.488259278328e+04, gap 42.1188%
  WARNING: Time limit reached. Using best solution found (gap: 42.12%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 24544.67, θ = 179291.38
  Upper Bound (UB) = 24544.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179291.38
  [DEBUG]   ✓ Scenario 0: θ = 179291.38 ≤ Q = 179291.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 179291.38 ≤ Q = 179291.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179291.38 ≤ Q = 179291.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179291.38 ≤ Q = 179291.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179291.38 ≤ Q = 179291.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 179291.38 ≤ Q = 179291.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 179291.38 ≤ Q = 179291.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 179291.38 ≤ Q = 179291.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x535f55da
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaca0aa26
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.433632e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6867220.8982
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.640591e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164059.12    0  128 6867220.90 -164059.12   102%     -    0s
H    0     0                    -128628.2347 -164059.12  27.5%     -    0s
H    0     0                    -129710.7804 -164059.12  26.5%     -    0s
H    0     0                    -130683.9632 -146903.78  12.4%     -    0s
H    0     0                    -136479.4751 -146903.78  7.64%     -    0s
     0     0 -146903.78    0   76 -136479.48 -146903.78  7.64%     -    0s
H    0     0                    -143883.9234 -146812.09  2.04%     -    0s
H    0     0                    -145306.7618 -146812.09  1.04%     -    0s
H    0     0                    -145978.1397 -146812.09  0.57%     -    0s
     0     0 -146812.09    0   71 -145978.14 -146812.09  0.57%     -    0s
     0     0 -146812.09    0   71 -145978.14 -146812.09  0.57%     -    0s
     0     0 -146167.76    0   23 -145978.14 -146167.76  0.13%     -    0s
     0     0 -146090.30    0   17 -145978.14 -146090.30  0.08%     -    0s
     0     0 -146048.56    0    9 -145978.14 -146048.56  0.05%     -    0s
     0     0 -146032.80    0    8 -145978.14 -146032.80  0.04%     -    0s
     0     0 -146014.56    0    7 -145978.14 -146014.56  0.02%     -    0s
     0     0 -146004.72    0    6 -145978.14 -146004.72  0.02%     -    0s
     0     0 -145986.14    0    2 -145978.14 -145986.14  0.01%     -    0s
     0     0 -145985.00    0    4 -145978.14 -145985.00  0.00%     -    0s
     0     0 -145979.84    0    2 -145978.14 -145979.84  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 2
  Flow cover: 2

Explored 1 nodes (566 simplex iterations) in 0.21 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145978 -145915 -145729 ... 1.43363e+13
No other solutions better than -145978

Optimal solution found (tolerance 1.00e-06)
Best objective -1.459781396943e+05, best bound -1.459781396943e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 162072.93
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145978.14
  [DEBUG]   S×d_nominal = 308051.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308051.07 + -145978.14 = 162072.93
  [DEBUG]   Current θ from Master = 179291.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17218.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7326.23
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 1210.5054, Absolute Gap = 1210.5054, Relative Gap = 0.049318
  Not converged yet (gap = 1210.51 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0xcc41a786
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63910 rows and 25970 columns
Presolve time: 2.29s
Presolved: 75083 rows, 32450 columns, 468269 nonzeros
Variable types: 30191 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339436.1647
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75083 rows, 32450 columns, 468269 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25588   -1.8308860e+05   0.000000e+00   1.211886e+06      5s
   39925   -3.2825392e+04   0.000000e+00   8.121336e+09     10s
   47371    1.9312805e+04   0.000000e+00   9.115972e+06     15s
   54288    2.8634171e+04   0.000000e+00   5.172874e+07     20s
   59671    3.2473723e+04   0.000000e+00   2.621294e+07     25s
   64984    3.7149717e+04   0.000000e+00   3.460947e+06     30s
   71922    4.3924129e+04   0.000000e+00   6.025520e+05     35s
   78290    4.6860292e+04   0.000000e+00   2.023421e+07     40s
   84105    4.9439391e+04   0.000000e+00   2.099063e+06     45s
Concurrent spin time: 0.61s

Solved with dual simplex

Root relaxation: objective 5.484698e+04, 58516 iterations, 47.32 seconds (64.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54846.9816    0  127 -239613.87 54846.9816   123%     -   50s
H    0     0                    -228922.5701 54846.9816   124%     -   50s
H    0     0                    -130342.1500 54846.9816   142%     -   51s
H    0     0                    -129860.2004 54846.9816   142%     -   51s
H    0     0                    -129814.1277 54846.9816   142%     -   51s
H    0     0                    -127300.3711 54846.9816   143%     -   51s
H    0     0                    -45023.46105 54846.9816   222%     -   51s
H    0     0                    -44250.93976 54846.9816   224%     -   51s
H    0     0                    -43890.80274 54846.9816   225%     -   51s
H    0     0                    -31461.32105 54846.9816   274%     -   51s
H    0     0                    -30365.49051 54846.9816   281%     -   51s
H    0     0                    -26816.37853 54846.9816   305%     -   51s
H    0     0                    -26654.34754 54846.9816   306%     -   52s
H    0     0                    -22604.66233 54846.9816   343%     -   52s
H    0     0                    -11616.56528 54846.9816   572%     -   52s
H    0     0                    1780.8357480 54846.9816  2980%     -   52s
H    0     0                    8811.3743200 54846.9816   522%     -   52s
H    0     0                    8899.4431698 54846.9816   516%     -   52s
H    0     0                    8981.1061125 54846.9816   511%     -   52s
H    0     0                    17427.729819 54846.9816   215%     -   53s
H    0     0                    17521.502308 54846.9816   213%     -   53s
     0     0 50406.4184    0  153 17521.5023 50406.4184   188%     -   67s
H    0     0                    23270.055347 50403.8667   117%     -   69s
     0     0 49359.6793    0  188 23270.0553 49359.6793   112%     -   79s
     0     0 49359.6793    0  192 23270.0553 49359.6793   112%     -   82s
     0     0 49359.6793    0  193 23270.0553 49359.6793   112%     -   84s
     0     0 49359.6793    0  191 23270.0553 49359.6793   112%     -   84s
     0     0 49359.6793    0  191 23270.0553 49359.6793   112%     -   85s
     0     0 47128.8724    0  310 23270.0553 47128.8724   103%     -   98s
     0     0 46865.3176    0  281 23270.0553 46865.3176   101%     -  104s
     0     0 46571.9200    0  295 23270.0553 46571.9200   100%     -  110s
     0     0 46435.3077    0  291 23270.0553 46435.3077   100%     -  113s
     0     0 46340.7588    0  346 23270.0553 46340.7588  99.1%     -  118s
     0     0 46251.9219    0  336 23270.0553 46251.9219  98.8%     -  122s
     0     0 46217.1183    0  341 23270.0553 46217.1183  98.6%     -  125s
     0     0 46205.4200    0  343 23270.0553 46205.4200  98.6%     -  126s
     0     0 46204.0272    0  339 23270.0553 46204.0272  98.6%     -  127s
     0     0 46202.2379    0  342 23270.0553 46202.2379  98.5%     -  127s
     0     0 46200.7660    0  345 23270.0553 46200.7660  98.5%     -  128s
     0     0 46200.7660    0  345 23270.0553 46200.7660  98.5%     -  128s
H    0     0                    23585.302469 46200.7660  95.9%     -  138s
H    0     0                    23816.161182 46200.7660  94.0%     -  138s
H    0     0                    23859.251995 46200.7660  93.6%     -  138s
H    0     0                    23909.995553 46200.7660  93.2%     -  138s
H    0     0                    23999.328612 46200.7660  92.5%     -  138s
H    0     0                    24258.311341 44362.1409  82.9%     -  150s
     0     0 44362.1409    0  322 24258.3113 44362.1409  82.9%     -  150s
     0     0 44004.3809    0  338 24258.3113 44004.3809  81.4%     -  156s
     0     0 43865.7724    0  344 24258.3113 43865.7724  80.8%     -  161s
     0     0 43823.8496    0  352 24258.3113 43823.8496  80.7%     -  163s
     0     0 43812.3415    0  348 24258.3113 43812.3415  80.6%     -  165s
     0     0 43783.5273    0  356 24258.3113 43783.5273  80.5%     -  167s
     0     0 43773.3134    0  356 24258.3113 43773.3134  80.4%     -  169s
     0     0 43750.8395    0  346 24258.3113 43750.8395  80.4%     -  170s
     0     0 43744.8110    0  351 24258.3113 43744.8110  80.3%     -  172s
     0     0 43742.7587    0  355 24258.3113 43742.7587  80.3%     -  172s
     0     0 43740.3987    0  351 24258.3113 43740.3987  80.3%     -  173s
     0     0 43739.7640    0  351 24258.3113 43739.7640  80.3%     -  174s
     0     0 43251.8196    0  379 24258.3113 43251.8196  78.3%     -  190s
     0     0 43050.7441    0  390 24258.3113 43050.7441  77.5%     -  199s
     0     0 42980.8360    0  384 24258.3113 42980.8360  77.2%     -  204s
     0     0 42946.2177    0  391 24258.3113 42946.2177  77.0%     -  207s
     0     0 42935.3062    0  387 24258.3113 42935.3062  77.0%     -  209s
     0     0 42907.7776    0  395 24258.3113 42907.7776  76.9%     -  211s
     0     0 42901.8951    0  396 24258.3113 42901.8951  76.9%     -  213s
     0     0 42896.5057    0  394 24258.3113 42896.5057  76.8%     -  214s
     0     0 42895.8279    0  399 24258.3113 42895.8279  76.8%     -  215s
     0     0 42771.0962    0  399 24258.3113 42771.0962  76.3%     -  222s
     0     0 42702.4179    0  437 24258.3113 42702.4179  76.0%     -  228s
     0     0 42680.5291    0  437 24258.3113 42680.5291  75.9%     -  232s
     0     0 42674.1569    0  441 24258.3113 42674.1569  75.9%     -  233s
     0     0 42669.7165    0  441 24258.3113 42669.7165  75.9%     -  234s
     0     0 42667.2595    0  448 24258.3113 42667.2595  75.9%     -  237s
     0     0 42665.4138    0  448 24258.3113 42665.4138  75.9%     -  237s
     0     0 42664.6147    0  446 24258.3113 42664.6147  75.9%     -  238s
     0     0 42613.4969    0  453 24258.3113 42613.4969  75.7%     -  241s
     0     0 42585.5914    0  450 24258.3113 42585.5914  75.6%     -  251s
     0     0 42572.5906    0  441 24258.3113 42572.5906  75.5%     -  252s
     0     0 42561.5808    0  343 24258.3113 42561.5808  75.5%     -  253s
     0     0 42557.1548    0  389 24258.3113 42557.1548  75.4%     -  255s
     0     0 42555.3516    0  446 24258.3113 42555.3516  75.4%     -  255s
     0     0 42554.7673    0  450 24258.3113 42554.7673  75.4%     -  256s
     0     0 42500.5411    0  448 24258.3113 42500.5411  75.2%     -  261s
     0     0 42470.2406    0  457 24258.3113 42470.2406  75.1%     -  266s
     0     0 42419.4500    0  473 24258.3113 42419.4500  74.9%     -  270s
     0     0 42413.9383    0  473 24258.3113 42413.9383  74.8%     -  272s
     0     0 42406.6822    0  466 24258.3113 42406.6822  74.8%     -  273s
     0     0 42404.6771    0  475 24258.3113 42404.6771  74.8%     -  274s
     0     0 42404.0046    0  481 24258.3113 42404.0046  74.8%     -  274s
     0     0 42304.6407    0  409 24258.3113 42304.6407  74.4%     -  281s
     0     0 42277.3862    0  406 24258.3113 42277.3862  74.3%     -  295s
     0     0 42271.8512    0  416 24258.3113 42271.8512  74.3%     -  296s
     0     0 42270.7530    0  420 24258.3113 42270.7530  74.3%     -  298s
     0     0 42251.3312    0  417 24258.3113 42251.3312  74.2%     -  302s
     0     0 42248.6129    0  430 24258.3113 42248.6129  74.2%     -  304s
     0     0 42245.7537    0  475 24258.3113 42245.7537  74.1%     -  305s
     0     0 42243.4357    0  480 24258.3113 42243.4357  74.1%     -  306s
     0     0 42242.1558    0  481 24258.3113 42242.1558  74.1%     -  306s
     0     0 42211.7651    0  428 24258.3113 42211.7651  74.0%     -  311s
     0     0 42201.0427    0  476 24258.3113 42201.0427  74.0%     -  313s
     0     0 42194.1353    0  432 24258.3113 42194.1353  73.9%     -  315s
     0     0 42192.6164    0  435 24258.3113 42192.6164  73.9%     -  315s
     0     0 42192.1306    0  432 24258.3113 42192.1306  73.9%     -  315s
     0     0 42186.1145    0  428 24258.3113 42186.1145  73.9%     -  318s
     0     0 42183.1128    0  432 24258.3113 42183.1128  73.9%     -  319s
     0     0 42182.5751    0  432 24258.3113 42182.5751  73.9%     -  320s
     0     0 42180.9899    0  436 24258.3113 42180.9899  73.9%     -  321s
     0     0 42180.2565    0  441 24258.3113 42180.2565  73.9%     -  322s
     0     0 42178.7015    0  436 24258.3113 42178.7015  73.9%     -  324s
     0     0 42176.5942    0  488 24258.3113 42176.5942  73.9%     -  325s
     0     0 42175.6120    0  436 24258.3113 42175.6120  73.9%     -  326s
     0     0 42170.1101    0  444 24258.3113 42170.1101  73.8%     -  328s
     0     0 42169.9560    0  444 24258.3113 42169.9560  73.8%     -  331s
     0     2 42169.8977    0  444 24258.3113 42169.8977  73.8%     -  445s
     1     4 42145.3008    1  432 24258.3113 42169.2982  73.8%  1550  452s
     3     8 42110.3344    2  415 24258.3113 42144.8704  73.7%  3172  460s
     7    16 41857.5363    3  465 24258.3113 42108.7375  73.6%  5373  473s
    15    32 41709.4471    4  462 24258.3113 41857.5228  72.5%  6467  490s
    31    48 40711.2242    5  485 24258.3113 41708.8682  71.9% 10418  534s
    47    80 39733.4732    6  334 24258.3113 41708.8682  71.9%  9857  556s
    79   118 39666.5515    7  325 24258.3113 41708.8682  71.9%  7899  596s
   117   169 39607.4085    9  366 24258.3113 41708.8682  71.9%  5977  612s
   168   262 39592.6633    8  308 24258.3113 41708.8682  71.9%  4569  634s
   261   356 39339.8232   11  294 24258.3113 41708.8682  71.9%  3748  652s
   355   444 39111.1799   12  295 24258.3113 41708.8682  71.9%  3475  670s
   443   529 34035.6171   12  221 24258.3113 41708.8682  71.9%  3308  687s
   528   630 37957.5071   12  251 24258.3113 41708.8682  71.9%  3167  700s
   637   710 38417.3547   12  294 24258.3113 41708.8682  71.9%  2890  715s
   743   785 38686.0626   13  280 24258.3113 41708.8682  71.9%  2695  729s
   844   839 37747.1421   13  330 24258.3113 41708.8682  71.9%  2555  743s
   928   869 37891.7388   13  334 24258.3113 41708.8682  71.9%  2448  756s
   960   909 36869.0826   13  182 24258.3113 41708.8682  71.9%  2472  769s
  1000   941 38971.5597   14  289 24258.3113 41708.8682  71.9%  2506  785s
  1042   975 37813.2754   14  224 24258.3113 41708.8682  71.9%  2480  798s
  1094  1025 38501.9453   15  283 24258.3113 41708.8682  71.9%  2465  813s
  1162  1091 37189.3500   15  326 24258.3113 41708.8682  71.9%  2414  824s
  1253  1150 36920.9549   16  308 24258.3113 41708.8682  71.9%  2324  839s
  1357  1221 36288.4120   17  160 24258.3113 41708.8682  71.9%  2256  855s
  1477  1305 35852.0995   17  292 24258.3113 41708.8682  71.9%  2156  871s
  1611  1348 37812.9588   16  283 24258.3113 41708.8682  71.9%  2063  889s
  1729  1375 34364.9270   16  269 24258.3113 41708.8682  71.9%  2053  907s
  1814  1413 34956.2808   16  239 24258.3113 41690.6524  71.9%  2058  929s
  1899  1465 34011.7174   18  295 24258.3113 41466.2027  70.9%  2087  951s
  1987  1528 34916.3451   18  277 24258.3113 41466.2027  70.9%  2107  972s
  2067  1626 31600.2945   19  257 24258.3113 41466.2027  70.9%  2162  995s
  2190  1752 33688.1166   19  249 24258.3113 41466.2027  70.9%  2155 1016s
  2362  1833 30235.4494   19  172 24258.3113 41466.2027  70.9%  2103 1040s
  2494  1934 29398.4471   20  240 24258.3113 41307.9501  70.3%  2105 1063s
  2622  2028 28416.0480   19  259 24258.3113 41307.9501  70.3%  2112 1086s
  2796  2083 30976.5277   20  278 24258.3113 41306.1007  70.3%  2090 1114s
  2905  2150 27274.5799   20  244 24258.3113 41306.1007  70.3%  2129 1140s
  3007  2257 29228.7082   21  239 24258.3113 41306.1007  70.3%  2166 1167s
  3159  2370 29334.5468   21  239 24258.3113 41077.3858  69.3%  2169 1196s
  3342  2557 28736.2133   22  308 24258.3113 40921.0990  68.7%  2154 1225s
  3574  2558 27050.9770   40  444 24258.3113 40791.6747  68.2%  2115 1328s
  3576  2559 27798.9282   67  127 24258.3113 40791.6747  68.2%  2113 1379s
  3577  2560 25899.2988   53  377 24258.3113 40791.6747  68.2%  2113 1413s
  3578  2561 24977.8888   62  367 24258.3113 40791.6747  68.2%  2112 1433s
  3579  2561 28937.8601   14  376 24258.3113 40791.6747  68.2%  2112 1447s
  3580  2562 35521.4874   19  481 24258.3113 40791.6747  68.2%  2111 1458s
  3581  2563 31650.2700   29  406 24258.3113 40791.6747  68.2%  2110 1465s
  3582  2563 28896.4366   54  422 24258.3113 40791.6747  68.2%  2110 1471s
  3583  2564 34493.5157   17  411 24258.3113 40791.6747  68.2%  2109 1477s
  3584  2565 28063.3729   39  471 24258.3113 40791.6747  68.2%  2109 1482s
  3585  2565 39591.8975   13  420 24258.3113 40791.6747  68.2%  2108 1485s
  3587  2567 38977.4734   10  430 24258.3113 40791.6747  68.2%  2107 1490s
  3588  2567 40200.7560   13  478 24258.3113 40791.6747  68.2%  2106 1500s
  3590  2569 36508.7014   15  479 24258.3113 40791.6747  68.2%  2105 1507s
  3592  2570 40449.4298   13  479 24258.3113 40791.6747  68.2%  2104 1510s
  3594  2571 27764.5917   58  480 24258.3113 40791.6747  68.2%  2103 1521s
  3596  2573 40675.8469    8  477 24258.3113 40791.6747  68.2%  2102 1526s
  3597  2573 33899.1708   16  478 24258.3113 40791.6747  68.2%  2101 1534s
  3598  2574 33317.5032   42  521 24258.3113 40791.6747  68.2%  2101 1538s
  3599  2575 30504.3176   28  531 24258.3113 40791.6747  68.2%  2100 1542s
  3600  2575 25725.6802   46  483 24258.3113 40791.6747  68.2%  2099 1548s
  3601  2576 30308.4450   41  423 24258.3113 40791.6747  68.2%  2099 1552s
  3602  2577 26618.7581   36  483 24258.3113 40791.6747  68.2%  2098 1558s
  3603  2577 39009.6267   16  487 24258.3113 40791.6747  68.2%  2098 1562s
  3604  2578 29983.8849   21  479 24258.3113 40791.6747  68.2%  2097 1567s
  3605  2579 30531.4750   29  475 24258.3113 40791.6747  68.2%  2096 1571s
  3606  2579 36268.3912    9  479 24258.3113 40791.6747  68.2%  2096 1578s
  3608  2581 37644.9564   13  485 24258.3113 40791.6747  68.2%  2095 1582s
  3609  2581 25666.2648   53  429 24258.3113 40791.6747  68.2%  2094 1585s
  3610  2582 28678.4342   44  539 24258.3113 40791.6747  68.2%  2094 1592s
  3611  2583 35728.5350   19  492 24258.3113 40791.6747  68.2%  2093 1596s
  3612  2583 32179.1425   20  521 24258.3113 40791.6747  68.2%  2092 1603s
  3613  2584 26689.3120   18  521 24258.3113 40791.6747  68.2%  2092 1659s
  3614  2585 29891.9117   42  521 24258.3113 40791.6747  68.2%  2091 1721s
  3615  2588 40791.6747   14  467 24258.3113 40791.6747  68.2%  2147 1747s
  3617  2592 40791.6747   15  440 24258.3113 40791.6747  68.2%  2148 1773s
  3621  2598 40791.6747   16  453 24258.3113 40791.6747  68.2%  2157 1810s
  3629  2612 40791.6747   17  442 24258.3113 40791.6747  68.2%  2174 1843s
  3645  2622 39820.2063   18  488 24258.3113 40791.6747  68.2%  2235 1900s
  3661  2649 36120.6496   19  273 24258.3113 40791.6747  68.2%  2277 1940s
  3693  2764 35648.6822   20  262 24258.3113 40791.6747  68.2%  2319 1983s
  3819  2754 29500.7373   22  205 24258.3113 40791.6747  68.2%  2432 2004s
  3851  2781 29191.1458   23  210 24258.3113 40791.6747  68.2%  2438 2024s
  3889  2791     cutoff   25      24258.3113 40791.6747  68.2%  2450 2043s
  3926  2795     cutoff   24      24258.3113 40791.6747  68.2%  2472 2070s
  3973  2808 35731.7379   19  457 24258.3113 40791.6747  68.2%  2500 2088s
  4009  2811 35375.6880   20  473 24258.3113 40791.6747  68.2%  2520 2109s
  4053  2813 34348.7051   21  403 24258.3113 40791.6747  68.2%  2531 2135s
  4095  2819 34237.5860   22  392 24258.3113 40791.6747  68.2%  2539 2161s
  4145  2834 32588.4756   24  365 24258.3113 40791.6747  68.2%  2556 2180s
  4200  2846 32482.1191   27  309 24258.3113 40791.6747  68.2%  2564 2214s
  4249  2851 31620.1783   29  235 24258.3113 40791.6747  68.2%  2584 2245s
  4311  2853 31010.1297   31  301 24258.3113 40791.6747  68.2%  2588 2268s
  4369  2859 27869.7157   33   81 24258.3113 40791.6747  68.2%  2598 2297s
  4430  2881 26132.9891   36   52 24258.3113 40751.9230  68.0%  2610 2325s
  4490  2899 29238.6740   29  330 24258.3113 40751.9230  68.0%  2624 2369s
  4546  2918 28436.0267   31  313 24258.3113 40751.9230  68.0%  2638 2393s
  4609  2921 27720.8393   34  252 24258.3113 40751.9230  68.0%  2651 2415s
  4650  2953 27293.5011   35  319 24258.3113 40681.8700  67.7%  2658 2440s
  4724  2970 27055.2996   36  254 24258.3113 40681.8700  67.7%  2659 2473s
  4817  2995 26450.4335   40  245 24258.3113 40681.8700  67.7%  2666 2502s
  4927  2996     cutoff   48      24258.3113 40681.8700  67.7%  2670 2532s
  5042  3005 29332.4045   25  233 24258.3113 40681.8700  67.7%  2669 2571s
  5158  3033 28789.4303   27  273 24258.3113 40681.8700  67.7%  2681 2599s
  5277  3059 27711.1373   31  108 24258.3113 40681.8700  67.7%  2692 2637s
  5430  3075 25260.8203   40  208 24258.3113 40681.8700  67.7%  2682 2673s
  5570  3074 24452.8851   43  241 24258.3113 40681.8700  67.7%  2683 2707s
  5719  3088 33028.3968   22  424 24258.3113 40681.8700  67.7%  2686 2745s
  5856  3091 31971.2177   23  389 24258.3113 40681.8700  67.7%  2693 2783s
  6040  3104 30782.4407   27  305 24258.3113 40681.8700  67.7%  2691 2824s
  6168  3083     cutoff   32      24258.3113 38897.1518  60.3%  2714 2860s
  6208  3097 27471.4986   32  186 24258.3113 38897.1518  60.3%  2726 2904s
  6253  3103     cutoff   33      24258.3113 38897.1518  60.3%  2729 2937s
  6308  3111 26929.5421   34  180 24258.3113 38897.1518  60.3%  2727 2968s
H 6374  2980                    24325.496655 38897.1518  59.9%  2722 3002s
  6454  3049 26076.9208   36  118 24325.4967 38362.4800  57.7%  2718 3049s
  6672  3069 infeasible   42      24325.4967 38362.4800  57.7%  2715 3095s
  6860  3110 31344.9719   24  363 24325.4967 38126.3516  56.7%  2736 3144s
  7063  3145 29460.1607   27  308 24325.4967 38126.3516  56.7%  2749 3198s
  7244  3194     cutoff   30      24325.4967 38044.0185  56.4%  2770 3249s
  7455  3220 24527.9327   31  203 24325.4967 37208.4094  53.0%  2784 3301s
  7724  3188 29932.7996   29  287 24325.4967 37208.4094  53.0%  2779 3358s
  7958  3248 28612.6643   34  466 24325.4967 37151.5043  52.7%  2789 3418s
  8170  3331 25839.9519   45  157 24325.4967 37151.5043  52.7%  2808 3480s
  8447  3370 33964.0988   22  508 24325.4967 36820.0920  51.4%  2813 3547s
  8717  3408 31809.6324   25  424 24325.4967 36671.3022  50.8%  2823 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 822
  Mixing: 3
  Flow cover: 3161
  RLT: 24
  Relax-and-lift: 234

Explored 8930 nodes (25649488 simplex iterations) in 3600.06 seconds (6060.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 24325.5 24258.3 23999.3 ... 17427.7

Time limit reached
Best objective 2.432549665505e+04, best bound 3.654809749016e+04, gap 50.2460%
  WARNING: Time limit reached. Using best solution found (gap: 50.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 24325.50, θ = 179088.27
  Upper Bound (UB) = 24325.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179088.27
  [DEBUG]   ✓ Scenario 0: θ = 179088.27 ≤ Q = 179088.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 179088.27 ≤ Q = 179088.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179088.27 ≤ Q = 179088.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179088.27 ≤ Q = 179088.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179088.27 ≤ Q = 179088.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 179088.27 ≤ Q = 179088.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 179088.27 ≤ Q = 179088.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 179088.27 ≤ Q = 179088.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 179088.27 ≤ Q = 179088.27 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x53cc9836
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xac3367ca
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.428216e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 6879305.5416
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.640120e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164012.01    0  125 6879305.54 -164012.01   102%     -    0s
H    0     0                    -129066.0244 -164012.01  27.1%     -    0s
H    0     0                    -130143.2994 -164012.01  26.0%     -    0s
H    0     0                    -130605.2113 -145668.95  11.5%     -    0s
H    0     0                    -135258.9406 -145668.95  7.70%     -    0s
     0     0 -145668.95    0   77 -135258.94 -145668.95  7.70%     -    0s
H    0     0                    -142336.3363 -145553.13  2.26%     -    0s
     0     0 -145553.13    0   71 -142336.34 -145553.13  2.26%     -    0s
H    0     0                    -143727.7669 -145553.13  1.27%     -    0s
H    0     0                    -144354.3486 -145553.13  0.83%     -    0s
     0     0 -145553.13    0   71 -144354.35 -145553.13  0.83%     -    0s
     0     0 -144933.60    0   59 -144354.35 -144933.60  0.40%     -    0s
     0     0 -144815.26    0   42 -144354.35 -144815.26  0.32%     -    0s
     0     0 -144812.69    0   40 -144354.35 -144812.69  0.32%     -    0s
H    0     0                    -144386.3081 -144733.05  0.24%     -    0s
     0     0 -144732.01    0   38 -144386.31 -144732.01  0.24%     -    0s
     0     0 -144728.60    0   36 -144386.31 -144728.60  0.24%     -    0s
     0     0 -144497.70    0   14 -144386.31 -144497.70  0.08%     -    0s
     0     0 -144497.61    0   12 -144386.31 -144497.61  0.08%     -    0s
H    0     0                    -144423.9714 -144494.05  0.05%     -    0s
     0     0 -144491.57    0   14 -144423.97 -144491.57  0.05%     -    0s
     0     0 -144436.77    0    5 -144423.97 -144436.77  0.01%     -    0s
     0     0 -144435.33    0    5 -144426.88 -144435.33  0.01%     -    0s
     0     0 -144430.86    0    4 -144426.88 -144430.86  0.00%     -    0s
     0     0 -144427.20    0    2 -144426.88 -144427.20  0.00%     -    0s

Explored 1 nodes (681 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -144427 -144424 -144395 ... -129066
No other solutions better than -144427

Optimal solution found (tolerance 1.00e-06)
Best objective -1.444268813617e+05, best bound -1.444268813617e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 163624.19
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144426.88
  [DEBUG]   S×d_nominal = 308051.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308051.07 + -144426.88 = 163624.19
  [DEBUG]   Current θ from Master = 179088.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15464.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8861.41
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 991.3299, Absolute Gap = 991.3299, Relative Gap = 0.040753
  Not converged yet (gap = 991.33 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xd3e97a02
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 71000 rows and 28850 columns
Presolve time: 2.32s
Presolved: 83283 rows, 35810 columns, 510469 nonzeros
Variable types: 33551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339425.4737
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.563e+06
 Factor NZ  : 7.682e+06 (roughly 100 MB of memory)
 Factor Ops : 1.321e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83024103e+07  1.65439229e+08  1.20e+05 2.17e+01  8.32e+04     4s
   1  -1.36996896e+07  1.46888357e+08  8.26e+04 9.81e+01  5.65e+04     4s
   2  -4.00798323e+06  1.11812280e+08  2.40e+04 1.20e-11  1.75e+04     4s
   3  -1.11207612e+06  7.76431900e+07  3.95e+03 1.32e+00  3.18e+03     4s
   4  -5.15844315e+05  4.26702557e+07  5.34e+02 2.84e-01  6.12e+02     5s
   5  -4.10027251e+05  2.38000155e+07  2.42e+02 1.32e-01  2.91e+02     5s
   6  -3.05496780e+05  1.68498992e+07  9.70e+01 8.40e-02  1.60e+02     5s
   7  -1.77729775e+05  1.20930769e+07  2.59e+01 5.68e-02  9.11e+01     5s
   8  -1.23961341e+05  8.71392931e+06  1.26e+01 3.95e-02  6.20e+01     5s
   9  -1.03753041e+05  5.67873629e+06  8.34e+00 2.50e-02  3.98e+01     5s
  10  -8.60891949e+04  2.05543516e+06  4.66e+00 8.40e-03  1.45e+01     5s
  11  -3.46767296e+04  4.20856231e+05  9.19e-01 1.51e-03  3.01e+00     5s
  12  -9.70499212e+03  2.64850626e+05  5.21e-01 1.60e-03  1.81e+00     5s
  13  -4.75290059e+02  1.74865510e+05  4.19e-01 1.10e-03  1.15e+00     5s
  14   5.71809246e+03  1.30761980e+05  3.70e-01 1.55e-03  8.23e-01     5s
  15   1.47273708e+04  1.11984744e+05  3.01e-01 1.77e-03  6.40e-01     5s
  16   2.27528426e+04  9.55103732e+04  2.40e-01 1.70e-03  4.79e-01     5s
  17   2.99590670e+04  8.35080711e+04  1.83e-01 1.69e-03  3.53e-01     6s
  18   3.15511146e+04  7.78734907e+04  1.70e-01 1.52e-03  3.05e-01     6s
  19   3.78606849e+04  7.24322073e+04  1.22e-01 1.28e-03  2.28e-01     6s
  20   4.30255065e+04  6.86877171e+04  8.64e-02 1.18e-03  1.69e-01     6s
  21   4.62526799e+04  6.71450276e+04  6.55e-02 1.12e-03  1.37e-01     6s
  22   4.76758103e+04  6.38312564e+04  5.66e-02 1.57e-03  1.06e-01     6s
  23   4.96423938e+04  6.12487018e+04  4.44e-02 1.09e-03  7.64e-02     6s
  24   5.01967508e+04  6.00571283e+04  4.10e-02 1.22e-03  6.50e-02     6s
  25   5.19399624e+04  5.93902651e+04  3.04e-02 1.30e-03  4.91e-02     6s
  26   5.30693953e+04  5.87175009e+04  2.40e-02 8.74e-04  3.72e-02     6s
  27   5.36050588e+04  5.85419793e+04  2.09e-02 7.25e-04  3.25e-02     6s
  28   5.41250060e+04  5.82966428e+04  1.80e-02 5.52e-04  2.75e-02     7s
  29   5.47717672e+04  5.80983501e+04  1.45e-02 4.11e-04  2.19e-02     7s
  30   5.52415243e+04  5.78718902e+04  1.19e-02 2.65e-04  1.73e-02     7s
  31   5.57403940e+04  5.76718751e+04  9.06e-03 1.47e-04  1.27e-02     7s
  32   5.62964635e+04  5.75701972e+04  6.10e-03 3.09e-04  8.40e-03     7s
  33   5.65083221e+04  5.75342256e+04  4.93e-03 3.12e-04  6.77e-03     7s
  34   5.68343944e+04  5.75024545e+04  3.13e-03 1.97e-04  4.41e-03     7s
  35   5.68711586e+04  5.74631868e+04  2.93e-03 1.69e-04  3.91e-03     7s
  36   5.70454822e+04  5.74575822e+04  1.97e-03 1.42e-04  2.72e-03     7s
  37   5.71386379e+04  5.74548927e+04  1.49e-03 1.27e-04  2.09e-03     7s
  38   5.71605329e+04  5.74525697e+04  1.36e-03 1.19e-04  1.93e-03     8s
  39   5.72504919e+04  5.74452501e+04  8.80e-04 8.64e-05  1.28e-03     8s
  40   5.73539135e+04  5.74286762e+04  3.57e-04 1.50e-04  4.93e-04     8s
  41   5.73741404e+04  5.74267362e+04  2.48e-04 1.06e-04  3.47e-04     8s
  42   5.73793795e+04  5.74266265e+04  2.21e-04 1.03e-04  3.12e-04     8s
  43   5.73839034e+04  5.74258404e+04  1.95e-04 8.88e-05  2.77e-04     8s
  44   5.73913450e+04  5.74257412e+04  1.57e-04 8.68e-05  2.27e-04     8s
  45   5.74211005e+04  5.74228086e+04  5.22e-06 3.16e-06  1.12e-05     8s
  46   5.74223267e+04  5.74223384e+04  1.45e-07 4.28e-08  7.71e-08     8s
  47   5.74223369e+04  5.74223379e+04  2.10e-07 5.14e-11  6.40e-09     9s
  48   5.74223379e+04  5.74223379e+04  1.19e-08 3.74e-11  6.59e-12     9s

Barrier solved model in 48 iterations and 8.63 seconds (7.06 work units)
Optimal objective 5.74223379e+04


Root crossover log...

   75551 DPushes remaining with DInf 0.0000000e+00                 9s
    8129 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

     735 PPushes remaining with PInf 6.9586329e-07                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1743333e-10     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36653    5.7422338e+04   0.000000e+00   0.000000e+00     11s
   36653    5.7422338e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.742234e+04, 36653 iterations, 8.20 seconds (8.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57422.3379    0  120 -239613.87 57422.3379   124%     -   11s
H    0     0                    -229136.1291 57422.3379   125%     -   11s
H    0     0                    -121109.6015 57422.3379   147%     -   12s
H    0     0                    -116911.6118 57422.3379   149%     -   12s
H    0     0                    -116429.3711 57422.3379   149%     -   12s
H    0     0                    -116299.0160 57422.3379   149%     -   12s
H    0     0                    -52318.41355 57422.3379   210%     -   12s
H    0     0                    -51771.57988 57422.3379   211%     -   12s
H    0     0                    -869.5108871 57422.3379  6704%     -   12s
H    0     0                    1489.8361755 57422.3379  3754%     -   12s
H    0     0                    6018.3871818 57422.3379   854%     -   13s
H    0     0                    6233.6275576 57422.3379   821%     -   13s
H    0     0                    7114.2177262 57422.3379   707%     -   13s
H    0     0                    9664.9858833 57422.3379   494%     -   13s
H    0     0                    12327.777482 57422.3379   366%     -   13s
H    0     0                    14834.997117 57422.3379   287%     -   13s
H    0     0                    14842.802159 57422.3379   287%     -   13s
H    0     0                    15419.826396 57422.3379   272%     -   13s
H    0     0                    16561.027760 57422.3379   247%     -   13s
H    0     0                    18091.843509 57422.3379   217%     -   15s
H    0     0                    18264.233278 57422.3379   214%     -   15s
H    0     0                    18307.875307 57422.3379   214%     -   15s
H    0     0                    18514.007164 57422.3379   210%     -   15s
     0     0 51293.9634    0  228 18514.0072 51293.9634   177%     -   43s
H    0     0                    18549.000466 51293.8499   177%     -   44s
     0     0 50471.0276    0  263 18549.0005 50471.0276   172%     -   62s
     0     0 50469.1195    0  268 18549.0005 50469.1195   172%     -   70s
     0     0 50469.1195    0  269 18549.0005 50469.1195   172%     -   76s
     0     0 50468.9857    0  271 18549.0005 50468.9857   172%     -   76s
     0     0 50468.9857    0  271 18549.0005 50468.9857   172%     -   77s
H    0     0                    18598.671456 47919.0436   158%     -  105s
H    0     0                    18698.401716 47919.0436   156%     -  105s
H    0     0                    18717.111523 47919.0436   156%     -  105s
     0     0 47919.0436    0  313 18717.1115 47919.0436   156%     -  106s
     0     0 47019.1106    0  334 18717.1115 47019.1106   151%     -  124s
     0     0 46912.9649    0  333 18717.1115 46912.9649   151%     -  132s
     0     0 46871.5324    0  329 18717.1115 46871.5324   150%     -  136s
     0     0 46859.8212    0  330 18717.1115 46859.8212   150%     -  138s
H    0     0                    19162.553114 46804.6758   144%     -  144s
H    0     0                    19323.345460 46804.6758   142%     -  144s
H    0     0                    20835.775890 46804.6758   125%     -  144s
H    0     0                    20862.305973 46804.6758   124%     -  144s
H    0     0                    20956.007980 46804.6758   123%     -  144s
H    0     0                    21072.354184 46804.6758   122%     -  144s
H    0     0                    21351.255058 46804.6758   119%     -  144s
     0     0 46804.6758    0  338 21351.2551 46804.6758   119%     -  144s
     0     0 46782.3837    0  337 21351.2551 46782.3837   119%     -  146s
     0     0 46739.9378    0  328 21351.2551 46739.9378   119%     -  148s
     0     0 46728.7879    0  332 21351.2551 46728.7879   119%     -  151s
     0     0 46727.9299    0  332 21351.2551 46727.9299   119%     -  152s
     0     0 44829.6821    0  327 21351.2551 44829.6821   110%     -  181s
H    0     0                    21352.710073 44828.3814   110%     -  182s
     0     0 44535.2407    0  347 21352.7101 44535.2407   109%     -  194s
     0     0 44352.0735    0  344 21352.7101 44352.0735   108%     -  206s
     0     0 44262.7073    0  344 21352.7101 44262.7073   107%     -  214s
     0     0 44247.5923    0  350 21352.7101 44247.5923   107%     -  217s
     0     0 44231.9439    0  351 21352.7101 44231.9439   107%     -  220s
     0     0 44222.4349    0  345 21352.7101 44222.4349   107%     -  223s
     0     0 44175.5660    0  355 21352.7101 44175.5660   107%     -  229s
     0     0 44161.8645    0  355 21352.7101 44161.8645   107%     -  232s
     0     0 44154.0982    0  353 21352.7101 44154.0982   107%     -  234s
     0     0 44152.7902    0  353 21352.7101 44152.7902   107%     -  235s
H    0     0                    21430.055323 43574.2330   103%     -  272s
H    0     0                    21443.489794 43574.2330   103%     -  272s
H    0     0                    21456.645537 43574.2330   103%     -  272s
     0     0 43574.2330    0  423 21456.6455 43574.2330   103%     -  272s
     0     0 43355.0885    0  388 21456.6455 43355.0885   102%     -  287s
     0     0 43296.3101    0  391 21456.6455 43296.3101   102%     -  294s
     0     0 43256.5108    0  443 21456.6455 43256.5108   102%     -  300s
     0     0 43234.6487    0  398 21456.6455 43234.6487   101%     -  306s
     0     0 43194.9385    0  440 21456.6455 43194.9385   101%     -  312s
     0     0 43171.3815    0  440 21456.6455 43171.3815   101%     -  317s
     0     0 43160.5218    0  442 21456.6455 43160.5218   101%     -  320s
     0     0 43135.0447    0  435 21456.6455 43135.0447   101%     -  325s
     0     0 43111.3253    0  444 21456.6455 43111.3253   101%     -  329s
     0     0 43104.6585    0  435 21456.6455 43104.6585   101%     -  332s
     0     0 43096.3668    0  436 21456.6455 43096.3668   101%     -  334s
     0     0 43094.8724    0  437 21456.6455 43094.8724   101%     -  335s
     0     0 42931.4942    0  496 21456.6455 42931.4942   100%     -  350s
     0     0 42903.5287    0  453 21456.6455 42903.5287   100%     -  357s
     0     0 42890.0806    0  454 21456.6455 42890.0806   100%     -  359s
     0     0 42886.9145    0  452 21456.6455 42886.9145   100%     -  360s
     0     0 42850.1516    0  438 21456.6455 42850.1516   100%     -  364s
     0     0 42838.7369    0  475 21456.6455 42838.7369   100%     -  367s
     0     0 42828.8729    0  494 21456.6455 42828.8729   100%     -  373s
     0     0 42820.8110    0  496 21456.6455 42820.8110   100%     -  374s
     0     0 42812.2022    0  497 21456.6455 42812.2022   100%     -  376s
     0     0 42810.2623    0  506 21456.6455 42810.2623   100%     -  377s
     0     0 42809.9633    0  502 21456.6455 42809.9633   100%     -  378s
     0     0 42718.3355    0  487 21456.6455 42718.3355  99.1%     -  388s
     0     0 42696.8846    0  445 21456.6455 42696.8846  99.0%     -  392s
     0     0 42686.4950    0  449 21456.6455 42686.4950  98.9%     -  394s
     0     0 42681.3875    0  450 21456.6455 42681.3875  98.9%     -  396s
     0     0 42679.3632    0  444 21456.6455 42679.3632  98.9%     -  396s
     0     0 42675.7400    0  444 21456.6455 42675.7400  98.9%     -  398s
     0     0 42674.1628    0  449 21456.6455 42674.1628  98.9%     -  398s
     0     0 42543.3043    0  474 21456.6455 42543.3043  98.3%     -  408s
     0     0 42505.0404    0  480 21456.6455 42505.0404  98.1%     -  413s
     0     0 42479.9442    0  486 21456.6455 42479.9442  98.0%     -  417s
     0     0 42461.0390    0  494 21456.6455 42461.0390  97.9%     -  420s
     0     0 42446.6478    0  504 21456.6455 42446.6478  97.8%     -  421s
     0     0 42442.0344    0  501 21456.6455 42442.0344  97.8%     -  423s
     0     0 42439.2887    0  496 21456.6455 42439.2887  97.8%     -  424s
     0     0 42438.5025    0  501 21456.6455 42438.5025  97.8%     -  424s
     0     0 42395.1121    0  500 21456.6455 42395.1121  97.6%     -  431s
     0     0 42373.7125    0  503 21456.6455 42373.7125  97.5%     -  435s
     0     0 42368.1346    0  501 21456.6455 42368.1346  97.5%     -  436s
     0     0 42366.0271    0  504 21456.6455 42366.0271  97.4%     -  437s
     0     0 42362.4306    0  506 21456.6455 42362.4306  97.4%     -  439s
     0     0 42358.6996    0  504 21456.6455 42358.6996  97.4%     -  440s
     0     0 42352.5433    0  506 21456.6455 42352.5433  97.4%     -  441s
     0     0 42352.0494    0  508 21456.6455 42352.0494  97.4%     -  442s
     0     0 42286.1523    0  514 21456.6455 42286.1523  97.1%     -  448s
     0     0 42280.3495    0  514 21456.6455 42280.3495  97.1%     -  451s
     0     0 42278.2613    0  464 21456.6455 42278.2613  97.0%     -  452s
     0     0 42277.7758    0  460 21456.6455 42277.7758  97.0%     -  453s
     0     0 42264.1482    0  519 21456.6455 42264.1482  97.0%     -  458s
     0     0 42261.0646    0  519 21456.6455 42261.0646  97.0%     -  460s
     0     0 42260.1271    0  518 21456.6455 42260.1271  97.0%     -  461s
     0     0 42253.9565    0  523 21456.6455 42253.9565  96.9%     -  465s
     0     0 42247.8175    0  518 21456.6455 42247.8175  96.9%     -  468s
     0     0 42241.1734    0  522 21456.6455 42241.1734  96.9%     -  469s
     0     0 42237.4221    0  463 21456.6455 42237.4221  96.9%     -  470s
     0     0 42236.2909    0  464 21456.6455 42236.2909  96.8%     -  471s
     0     0 42233.4049    0  473 21456.6455 42233.4049  96.8%     -  474s
     0     0 42232.9011    0  522 21456.6455 42232.9011  96.8%     -  476s
     0     0 42228.4355    0  467 21456.6455 42228.4355  96.8%     -  479s
     0     0 42227.2078    0  475 21456.6455 42227.2078  96.8%     -  481s
     0     0 42223.6677    0  479 21456.6455 42223.6677  96.8%     -  483s
     0     0 42221.7791    0  479 21456.6455 42221.7791  96.8%     -  487s
     0     0 42219.5645    0  471 21456.6455 42219.5645  96.8%     -  489s
     0     0 42219.5545    0  471 21456.6455 42219.5545  96.8%     -  493s
     0     2 42219.5104    0  471 21456.6455 42219.5104  96.8%     -  595s
     1     3 40771.1453    1  375 21456.6455 42218.8647  96.8%  7348  607s
     2     6 39785.5523    2  278 21456.6455 42218.8647  96.8%  7392  616s
     5    12 39395.0003    3  275 21456.6455 42128.0795  96.3%  5970  647s
    11    24 38908.1015    4  319 21456.6455 42090.7479  96.2%  8035  665s
    23    36 41291.7369    4  470 21456.6455 41760.5480  94.6% 10004  697s
    35    68 40904.1385    5  410 21456.6455 41760.5480  94.6% 10866  797s
H   51    68                    21801.956648 41760.5480  91.5%  9480  797s
    67   195 40844.0963    6  393 21801.9566 41422.0842  90.0% 12783  830s
   194   228 40548.2190    8  377 21801.9566 41421.7250  90.0%  7184  853s
H  199   228                    22076.248268 41421.7250  87.6%  7066  853s
   227   292 40432.1204    9  379 22076.2483 41421.7250  87.6%  6695  872s
H  291   323                    22163.616725 41421.7250  86.9%  6238  886s
H  301   323                    22679.217295 41421.7250  82.6%  6194  886s
   322   399 40404.3098    9  369 22679.2173 41421.7250  82.6%  6175  907s
H  398   471                    22682.071722 41421.7250  82.6%  5596  925s
H  411   471                    22757.293031 41421.7250  82.0%  5494  925s
H  439   471                    22855.243586 41421.7250  81.2%  5315  925s
   470   536 39695.0201   12  273 22855.2436 41421.7250  81.2%  5272  942s
   537   599 40086.6944   13  373 22855.2436 41421.7250  81.2%  5052  960s
   600   661 39985.6696   14  366 22855.2436 41421.7250  81.2%  4976  974s
   666   726 39970.6851   15  367 22855.2436 41421.7250  81.2%  4895  989s
   735   758 38644.6947   37  273 22855.2436 41279.5085  80.6%  4795 1004s
   769   785 38077.9487   38  254 22855.2436 41279.5085  80.6%  4846 1018s
H  787   785                    23032.667004 41279.5085  79.2%  4814 1018s
   804   838 39672.0208   17  346 23032.6670 41279.5085  79.2%  4803 1034s
   873   870 39661.1019   18  348 23032.6670 41279.5085  79.2%  4726 1050s
H  877   870                    23170.042257 41279.5085  78.2%  4710 1050s
H  887   870                    23233.905894 41279.5085  77.7%  4704 1050s
H  925   870                    24400.498019 41279.5085  69.2%  4713 1050s
H  927   870                    24409.864370 41279.5085  69.1%  4709 1050s
   929   910 39186.1087   19  341 24409.8644 41279.5085  69.1%  4715 1068s
H  987   959                    24419.345758 41279.5085  69.0%  4834 1086s
H  990   959                    24420.997200 41279.5085  69.0%  4847 1086s
H  996   959                    24458.669073 41279.5085  68.8%  4864 1086s
H 1008   959                    24544.525578 41279.5085  68.2%  4875 1086s
H 1028   959                    25104.282587 41279.5085  64.4%  4895 1086s
  1040   983 38685.4484   21  393 25104.2826 41279.5085  64.4%  4910 1103s
  1074  1020 37788.5181   22  390 25104.2826 41279.5085  64.4%  4951 1120s
  1129  1066 37432.4434   50  289 25104.2826 41279.5085  64.4%  4977 1138s
  1194  1098 36522.2866   23  358 25104.2826 41279.5085  64.4%  4939 1159s
  1260  1121 33021.8360   24  320 25104.2826 41036.6790  63.5%  4998 1182s
  1318  1160 32903.4870   25  327 25104.2826 41035.5846  63.5%  5116 1205s
  1369  1202 30447.7684   25  287 25104.2826 41035.5846  63.5%  5207 1230s
  1431  1262 30378.5336   26  291 25104.2826 41035.5846  63.5%  5286 1253s
  1505  1313 32532.9013   26  332 25104.2826 40999.9245  63.3%  5330 1278s
  1586  1367 31001.3207   27  290 25104.2826 40927.4214  63.0%  5400 1303s
  1660  1435 30845.9695   28  292 25104.2826 40903.4942  62.9%  5488 1331s
  1748  1530 30677.0393   29  298 25104.2826 40846.6545  62.7%  5527 1358s
  1855  1619 29850.0134   30  225 25104.2826 40846.6545  62.7%  5531 1383s
  1974  1669 30309.1445   33  332 25104.2826 40846.6545  62.7%  5496 1413s
  2042  1720 29412.4463   36  275 25104.2826 40846.2789  62.7%  5539 1444s
  2097  1762 29220.5343   38  310 25104.2826 40846.2789  62.7%  5588 1473s
  2171  1832 28922.0236   43  198 25104.2826 40846.2789  62.7%  5583 1505s
  2269  1929 28384.7067   50  196 25104.2826 40846.2789  62.7%  5555 1534s
  2421  1996 27571.2675   54  184 25104.2826 40846.2789  62.7%  5471 1563s
  2534  2062 26371.0112   59  182 25104.2826 40801.6012  62.5%  5429 1596s
  2682  2143 infeasible   61      25104.2826 40701.0665  62.1%  5374 1630s
  2801  2267 26242.0087   23  138 25104.2826 40701.0665  62.1%  5435 1666s
  2947  2398 26933.7689   38  298 25104.2826 40701.0665  62.1%  5479 1703s
  3127  2452 infeasible   39      25104.2826 40701.0665  62.1%  5471 1738s
  3194  2582 infeasible   41      25104.2826 40701.0665  62.1%  5474 1776s
  3389  2734 infeasible   42      25104.2826 40701.0665  62.1%  5435 1816s
  3642  2869 32582.4350   12  344 25104.2826 40701.0665  62.1%  5353 1861s
  3894  2870 36361.6291   23  471 25104.2826 40701.0665  62.1%  5275 1990s
  3896  2871 34821.3102   15  127 25104.2826 40701.0665  62.1%  5272 2002s
  3897  2872 35108.9761   12  353 25104.2826 40701.0665  62.1%  5271 2044s
  3898  2873 38740.0884   11  357 25104.2826 40701.0665  62.1%  5270 2078s
  3899  2873 26232.5576   43  427 25104.2826 40701.0665  62.1%  5268 2100s
  3900  2874 25514.0055   28  436 25104.2826 40701.0665  62.1%  5267 2119s
  3901  2875 26937.8256   57  407 25104.2826 40701.0665  62.1%  5266 2131s
  3902  2875 34899.2659   20  416 25104.2826 40701.0665  62.1%  5264 2142s
  3903  2876 27275.6758   56  449 25104.2826 40701.0665  62.1%  5263 2151s
  3904  2877 27184.9380   29  466 25104.2826 40701.0665  62.1%  5262 2156s
  3905  2877 36762.3006   14  417 25104.2826 40701.0665  62.1%  5260 2163s
  3906  2878 37763.5966    8  470 25104.2826 40701.0665  62.1%  5259 2172s
  3907  2879 36310.7286   21  471 25104.2826 40701.0665  62.1%  5257 2177s
  3908  2879 33413.4395   11  458 25104.2826 40701.0665  62.1%  5256 2183s
  3909  2880 28691.7954   18  475 25104.2826 40701.0665  62.1%  5255 2188s
  3910  2881 38948.5995   14  497 25104.2826 40701.0665  62.1%  5253 2192s
  3911  2881 30126.6426   44  456 25104.2826 40701.0665  62.1%  5252 2196s
  3912  2882 28273.1443   38  482 25104.2826 40701.0665  62.1%  5251 2209s
  3913  2883 27106.3102   31  431 25104.2826 40701.0665  62.1%  5249 2217s
  3914  2883 30623.7278   25  488 25104.2826 40701.0665  62.1%  5248 2221s
  3915  2884 35475.7794   25  478 25104.2826 40701.0665  62.1%  5247 2230s
  3917  2885 26265.6154   32  490 25104.2826 40701.0665  62.1%  5244 2239s
  3918  2886 27906.0531   50  439 25104.2826 40701.0665  62.1%  5243 2249s
  3919  2887 27238.0531   29  409 25104.2826 40701.0665  62.1%  5241 2252s
  3920  2887 39960.6640   17  466 25104.2826 40701.0665  62.1%  5240 2258s
  3921  2888 40107.2979    8  445 25104.2826 40701.0665  62.1%  5239 2269s
  3922  2889 27813.7928   19  436 25104.2826 40701.0665  62.1%  5237 2273s
  3923  2889 30006.7298   26  428 25104.2826 40701.0665  62.1%  5236 2278s
  3924  2890 33008.1542   14  482 25104.2826 40701.0665  62.1%  5235 2292s
  3925  2891 29957.2146   40  528 25104.2826 40701.0665  62.1%  5233 2301s
  3927  2892 29343.5874   38  420 25104.2826 40701.0665  62.1%  5231 2307s
  3928  2893 26434.6757   37  490 25104.2826 40701.0665  62.1%  5229 2312s
  3929  2893 29929.5463   29  511 25104.2826 40701.0665  62.1%  5228 2325s
  3931  2895 29530.7137   47  515 25104.2826 40701.0665  62.1%  5225 2333s
  3932  2895 28941.9184   25  467 25104.2826 40701.0665  62.1%  5224 2345s
  3934  2897 25930.7024   49  435 25104.2826 40701.0665  62.1%  5221 2358s
  3935  2897 28102.2825   20  476 25104.2826 40701.0665  62.1%  5220 2363s
  3936  2898 25249.9089   50  430 25104.2826 40701.0665  62.1%  5219 2376s
  3937  2899 38260.0917   11  422 25104.2826 40701.0665  62.1%  5217 2380s
  3938  2899 27896.0004   34  476 25104.2826 40701.0665  62.1%  5216 2387s
  3940  2901 26515.5216   57  437 25104.2826 40701.0665  62.1%  5213 2394s
  3941  2901 34194.3001    8  495 25104.2826 40701.0665  62.1%  5212 2402s
  3942  2902 26861.5848   29  490 25104.2826 40701.0665  62.1%  5211 2407s
  3943  2903 31788.7297   18  467 25104.2826 40701.0665  62.1%  5209 2420s
  3944  2903 32136.7268   16  467 25104.2826 40701.0665  62.1%  5208 2433s
  3945  2904 29285.8524   29  467 25104.2826 40701.0665  62.1%  5207 2513s
  3946  2907 40701.0665   11  392 25104.2826 40701.0665  62.1%  5273 2571s
  3947  2909 40701.0665   12  431 25104.2826 40701.0665  62.1%  5274 2607s
  3950  2914 40701.0665   13  442 25104.2826 40701.0665  62.1%  5276 2655s
  3956  2924 39467.5244   14  459 25104.2826 40701.0665  62.1%  5283 2703s
  3968  2932 39981.0871   14  401 25104.2826 40701.0665  62.1%  5321 2793s
  3980  2960 38819.8917   15  379 25104.2826 40701.0665  62.1%  5350 2880s
  4012  3062 38387.1554   16  314 25104.2826 40701.0665  62.1%  5446 2946s
  4125  3054 35455.7941   18  282 25104.2826 40701.0665  62.1%  5519 2975s
  4156  3080 38304.1413   17  382 25104.2826 40701.0665  62.1%  5522 3012s
  4205  3085 33563.5075   18  166 25104.2826 40701.0665  62.1%  5524 3063s
  4252  3087 30368.0386   19  275 25104.2826 40357.5759  60.8%  5539 3107s
  4298  3089 27141.9853   20  157 25104.2826 40357.5759  60.8%  5544 3142s
  4336  3102 28024.1578   20  297 25104.2826 40357.5759  60.8%  5572 3179s
  4391  3124     cutoff   20      25104.2826 40357.5759  60.8%  5589 3211s
  4457  3139 34803.4606   19  284 25104.2826 40357.5759  60.8%  5625 3246s
  4520  3175 26441.3861   22  198 25104.2826 40357.5759  60.8%  5673 3276s
  4599  3182 26379.5016   23  178 25104.2826 40357.5759  60.8%  5695 3302s
  4652  3189 27839.7884   22  179 25104.2826 40357.5759  60.8%  5725 3325s
  4687  3199     cutoff   24      25104.2826 40357.5759  60.8%  5743 3351s
  4732  3216     cutoff   24      25104.2826 40357.5759  60.8%  5760 3375s
  4792  3217 25840.1319   25  165 25104.2826 40357.5759  60.8%  5764 3401s
  4855  3220 26034.5879   26  158 25104.2826 40357.5759  60.8%  5769 3436s
  4919  3218     cutoff   28      25104.2826 40357.3951  60.8%  5785 3475s
  4988  3207 34597.3204   19  439 25104.2826 39667.7160  58.0%  5820 3514s
  5031  3226 34339.6358   20  425 25104.2826 39667.7160  58.0%  5838 3546s
  5086  3238 33577.4294   22  426 25104.2826 39593.5384  57.7%  5879 3579s
  5143  3245 33280.4275   23  373 25104.2826 39593.5384  57.7%  5912 3600s

Cutting planes:
  Learned: 2
  Gomory: 5
  MIR: 598
  Mixing: 2
  Flow cover: 2383
  RLT: 11
  Relax-and-lift: 236

Explored 5192 nodes (31122726 simplex iterations) in 3600.08 seconds (6164.70 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25104.3 24544.5 24458.7 ... 23032.7

Time limit reached
Best objective 2.510428258712e+04, best bound 3.959353843871e+04, gap 57.7163%
  WARNING: Time limit reached. Using best solution found (gap: 57.72%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 25104.28, θ = 182095.28
  Upper Bound (UB) = 25104.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 182095.28
  [DEBUG]   ✓ Scenario 0: θ = 182095.28 ≤ Q = 182095.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 182095.28 ≤ Q = 182095.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 182095.28 ≤ Q = 182095.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 182095.28 ≤ Q = 182095.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 182095.28 ≤ Q = 182095.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 182095.28 ≤ Q = 182095.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 182095.28 ≤ Q = 182095.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 182095.28 ≤ Q = 182095.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 182095.28 ≤ Q = 182095.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 182095.28 ≤ Q = 182095.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1ceb7ac5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe314853b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462500e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 7119890.2684
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.566374e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156637.41    0  122 7119890.27 -156637.41   102%     -    0s
H    0     0                    -121612.8263 -156637.41  28.8%     -    0s
H    0     0                    -121919.8626 -156637.41  28.5%     -    0s
     0     0 -138332.99    0  116 -121919.86 -138332.99  13.5%     -    0s
H    0     0                    -132725.9021 -138263.33  4.17%     -    0s
H    0     0                    -133907.5901 -138263.33  3.25%     -    0s
H    0     0                    -135214.9649 -138263.33  2.25%     -    0s
     0     0 -137114.87    0   95 -135214.96 -137114.87  1.41%     -    0s
H    0     0                    -136127.5331 -137088.41  0.71%     -    0s
     0     0 -137088.41    0   95 -136127.53 -137088.41  0.71%     -    0s
     0     0 -136570.28    0   60 -136127.53 -136570.28  0.33%     -    0s
     0     0 -136554.50    0   59 -136127.53 -136554.50  0.31%     -    0s
     0     0 -136466.36    0   48 -136127.53 -136466.36  0.25%     -    0s
     0     0 -136462.52    0   37 -136127.53 -136462.52  0.25%     -    0s
     0     0 -136433.11    0   46 -136127.53 -136433.11  0.22%     -    0s
     0     0 -136415.01    0   34 -136127.53 -136415.01  0.21%     -    0s
     0     0 -136352.17    0   23 -136127.53 -136352.17  0.17%     -    0s
     0     0 -136337.24    0   45 -136127.53 -136337.24  0.15%     -    0s
     0     0 -136322.91    0   45 -136127.53 -136322.91  0.14%     -    0s
     0     0 -136264.66    0   10 -136127.53 -136264.66  0.10%     -    0s
     0     0 -136258.41    0   10 -136127.53 -136258.41  0.10%     -    0s
H    0     0                    -136163.4701 -136258.41  0.07%     -    0s
     0     0 -136197.93    0    9 -136163.47 -136197.93  0.03%     -    0s
     0     0     cutoff    0      -136163.47 -136163.47  0.00%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 3
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 4

Explored 1 nodes (834 simplex iterations) in 0.15 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -136163 -136128 -135215 ... 1.4625e+13
No other solutions better than -136163

Optimal solution found (tolerance 1.00e-06)
Best objective -1.361634700526e+05, best bound -1.361634700526e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 171887.60
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136163.47
  [DEBUG]   S×d_nominal = 308051.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308051.07 + -136163.47 = 171887.60
  [DEBUG]   Current θ from Master = 182095.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10207.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14896.61
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 1770.1158, Absolute Gap = 1770.1158, Relative Gap = 0.070511
  Not converged yet (gap = 1770.12 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0xa1b2a54d
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78090 rows and 31730 columns
Presolve time: 3.25s
Presolved: 91483 rows, 39170 columns, 556451 nonzeros
Variable types: 36911 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340183.2448
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 637
 AA' NZ     : 3.030e+06
 Factor NZ  : 7.079e+06 (roughly 100 MB of memory)
 Factor Ops : 1.290e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83185262e+07  1.80655880e+08  1.20e+05 2.02e+01  8.28e+04     5s
   1  -1.37578469e+07  1.60660774e+08  8.32e+04 9.54e+01  5.68e+04     5s
   2  -4.26214985e+06  1.23842135e+08  2.57e+04 7.65e-01  1.86e+04     5s
   3  -1.33386821e+06  9.40125148e+07  4.57e+03 3.00e+00  3.65e+03     5s
   4  -5.94538319e+05  5.56140145e+07  6.07e+02 3.47e-01  7.11e+02     5s
   5  -5.14441184e+05  3.14234975e+07  4.07e+02 3.06e-02  4.15e+02     5s
   6  -4.42582403e+05  2.34868685e+07  2.22e+02 2.14e-02  2.58e+02     5s
   7  -3.26545602e+05  1.83168314e+07  8.82e+01 1.63e-02  1.53e+02     5s
   8  -2.17326354e+05  1.17647353e+07  3.15e+01 9.49e-03  8.35e+01     5s
   9  -1.22340590e+05  7.29448909e+06  9.42e+00 5.52e-03  4.68e+01     6s
  10  -9.40017725e+04  3.36142823e+06  5.54e+00 2.39e-03  2.14e+01     6s
  11  -6.97157091e+04  2.11179918e+06  3.59e+00 1.47e-03  1.33e+01     6s
  12  -4.02612316e+04  8.41660545e+05  2.00e+00 5.78e-04  5.34e+00     6s
  13  -1.73931474e+04  4.46678028e+05  1.27e+00 2.68e-04  2.80e+00     6s
  14  -4.93774197e+03  2.61503875e+05  8.31e-01 1.80e-04  1.60e+00     6s
  15   3.96689039e+03  2.00424808e+05  6.37e-01 2.35e-04  1.18e+00     6s
  16   9.98803670e+03  1.34963392e+05  5.44e-01 1.36e-03  7.50e-01     6s
  17   1.76983815e+04  1.20422711e+05  4.40e-01 1.02e-03  6.16e-01     6s
  18   2.66257356e+04  9.74834696e+04  3.28e-01 1.97e-03  4.25e-01     6s
  19   2.80192314e+04  8.99293731e+04  3.11e-01 1.87e-03  3.72e-01     6s
  20   3.31365353e+04  7.96287230e+04  2.50e-01 1.69e-03  2.79e-01     6s
  21   3.53416341e+04  7.56947331e+04  2.26e-01 1.41e-03  2.42e-01     6s
  22   3.63717406e+04  7.10492452e+04  2.15e-01 1.87e-03  2.08e-01     7s
  23   4.14663786e+04  6.83495973e+04  1.61e-01 2.10e-03  1.61e-01     7s
  24   4.37419843e+04  6.53643473e+04  1.38e-01 2.05e-03  1.30e-01     7s
  25   4.62233944e+04  6.34281798e+04  1.12e-01 2.18e-03  1.03e-01     7s
  26   4.76523307e+04  6.16795162e+04  9.70e-02 1.58e-03  8.43e-02     7s
  27   4.97645575e+04  6.08680394e+04  7.62e-02 1.64e-03  6.67e-02     7s
  28   5.04057910e+04  6.01357978e+04  6.96e-02 1.45e-03  5.84e-02     7s
  29   5.08611888e+04  5.97361202e+04  6.49e-02 1.20e-03  5.33e-02     7s
  30   5.19650411e+04  5.94107270e+04  5.40e-02 1.44e-03  4.47e-02     7s
  31   5.28482120e+04  5.89291422e+04  4.52e-02 1.46e-03  3.65e-02     7s
  32   5.34129168e+04  5.87909636e+04  4.00e-02 1.39e-03  3.23e-02     7s
  33   5.37076249e+04  5.85444666e+04  3.73e-02 1.49e-03  2.91e-02     7s
  34   5.39139703e+04  5.84939470e+04  3.52e-02 1.48e-03  2.75e-02     7s
  35   5.46137098e+04  5.83058253e+04  2.83e-02 1.45e-03  2.22e-02     8s
  36   5.48164385e+04  5.82062547e+04  2.63e-02 1.31e-03  2.04e-02     8s
  37   5.54730243e+04  5.80787287e+04  1.99e-02 8.62e-04  1.57e-02     8s
  38   5.56631670e+04  5.79439160e+04  1.81e-02 9.59e-04  1.37e-02     8s
  39   5.58179375e+04  5.79135808e+04  1.66e-02 8.62e-04  1.26e-02     8s
  40   5.61981651e+04  5.78163297e+04  1.30e-02 5.04e-04  9.73e-03     8s
  41   5.65210570e+04  5.77843900e+04  1.01e-02 4.04e-04  7.59e-03     8s
  42   5.65686116e+04  5.77363890e+04  9.70e-03 3.60e-04  7.02e-03     8s
  43   5.67379248e+04  5.77110558e+04  8.11e-03 2.89e-04  5.85e-03     8s
  44   5.68988137e+04  5.76825993e+04  6.58e-03 2.71e-04  4.71e-03     8s
  45   5.69291292e+04  5.76711132e+04  6.29e-03 2.32e-04  4.46e-03     8s
  46   5.70035040e+04  5.76662693e+04  5.63e-03 2.16e-04  3.99e-03     9s
  47   5.70237475e+04  5.76628072e+04  5.43e-03 2.06e-04  3.84e-03     9s
  48   5.71070121e+04  5.76570932e+04  4.69e-03 1.69e-04  3.31e-03     9s
  49   5.71644142e+04  5.76526813e+04  4.13e-03 1.58e-04  2.94e-03     9s
  50   5.73783776e+04  5.76444163e+04  2.19e-03 1.15e-04  1.60e-03     9s
  51   5.74576892e+04  5.76350251e+04  1.46e-03 6.16e-05  1.07e-03     9s
  52   5.74631566e+04  5.76346957e+04  1.41e-03 5.97e-05  1.03e-03     9s
  53   5.74716941e+04  5.76330280e+04  1.33e-03 5.24e-05  9.70e-04     9s
  54   5.74906128e+04  5.76315284e+04  1.16e-03 4.32e-05  8.47e-04     9s
  55   5.74975463e+04  5.76273882e+04  1.10e-03 4.59e-05  7.81e-04     9s
  56   5.75299931e+04  5.76254927e+04  7.93e-04 2.96e-05  5.74e-04    10s
  57   5.75508767e+04  5.76238677e+04  6.01e-04 1.12e-05  4.39e-04    10s
  58   5.75587756e+04  5.76232481e+04  5.34e-04 9.20e-06  3.88e-04    10s
  59   5.75977405e+04  5.76226461e+04  1.83e-04 1.61e-05  1.50e-04    10s
  60   5.75998850e+04  5.76221334e+04  1.66e-04 1.03e-05  1.34e-04    10s
  61   5.76020584e+04  5.76219098e+04  1.49e-04 6.53e-06  1.19e-04    10s
  62   5.76129829e+04  5.76216239e+04  6.16e-05 6.22e-06  5.19e-05    10s
  63   5.76163085e+04  5.76213942e+04  3.60e-05 2.65e-06  3.05e-05    10s
  64   5.76168769e+04  5.76213148e+04  3.16e-05 1.78e-06  2.66e-05    10s
  65   5.76180891e+04  5.76212427e+04  2.26e-05 7.93e-07  1.89e-05    10s
  66   5.76185189e+04  5.76212363e+04  1.94e-05 6.95e-07  1.63e-05    11s
  67   5.76192332e+04  5.76212206e+04  1.39e-05 4.96e-07  1.19e-05    11s
  68   5.76210399e+04  5.76211843e+04  6.56e-07 1.27e-07  8.64e-07    11s
  69   5.76210688e+04  5.76211544e+04  5.39e-07 1.04e-07  5.13e-07    11s
  70   5.76211012e+04  5.76211536e+04  3.35e-07 2.11e-08  3.14e-07    11s
  71   5.76211457e+04  5.76211537e+04  1.32e-07 2.21e-07  4.81e-08    11s
  72   5.76211522e+04  5.76211525e+04  2.15e-08 2.62e-08  2.10e-09    11s

Barrier solved model in 72 iterations and 11.17 seconds (9.21 work units)
Optimal objective 5.76211522e+04


Root crossover log...

   80743 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    7009 PPushes remaining with PInf 6.8088141e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1841922e+02     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47689    5.7621152e+04   0.000000e+00   1.184192e+02     16s
   47774    5.7621152e+04   0.000000e+00   0.000000e+00     16s
   47774    5.7621152e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.762115e+04, 47774 iterations, 12.36 seconds (15.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57621.1523    0  209 -239613.87 57621.1523   124%     -   17s
H    0     0                    -232208.0860 57621.1523   125%     -   17s
H    0     0                    -215237.8857 57621.1523   127%     -   17s
H    0     0                    -214777.5664 57621.1523   127%     -   17s
H    0     0                    -146513.8504 57621.1523   139%     -   17s
H    0     0                    -144198.0778 57621.1523   140%     -   17s
H    0     0                    -144098.8764 57621.1523   140%     -   17s
H    0     0                    -47380.76031 57621.1523   222%     -   17s
H    0     0                    -12171.51705 57621.1523   573%     -   18s
H    0     0                    -10105.25727 57621.1523   670%     -   18s
H    0     0                    -416.5150031 57621.1523      -     -   18s
H    0     0                     167.6826870 57621.1523      -     -   18s
H    0     0                     673.9459907 57621.1523  8450%     -   18s
H    0     0                    1828.7708482 57621.1523  3051%     -   18s
H    0     0                    2691.4338961 57621.1523  2041%     -   18s
H    0     0                    2979.8076811 57621.1523  1834%     -   18s
H    0     0                    3190.3732660 57621.1523  1706%     -   19s
H    0     0                    3278.6395078 57621.1523  1657%     -   19s
H    0     0                    7017.8942311 57621.1523   721%     -   20s
H    0     0                    13428.685451 57621.1523   329%     -   20s
     0     0 51445.2174    0  305 13428.6855 51445.2174   283%     -   65s
H    0     0                    14443.877866 51444.9015   256%     -   66s
H    0     0                    14505.331608 51444.9015   255%     -   66s
H    0     0                    14595.641714 51444.9015   252%     -   66s
H    0     0                    14623.672513 51444.9015   252%     -   66s
     0     0 51119.1165    0  313 14623.6725 51119.1165   250%     -   86s
     0     0 50900.4150    0  310 14623.6725 50900.4150   248%     -   94s
     0     0 50900.4150    0  306 14623.6725 50900.4150   248%     -   99s
     0     0 50860.7702    0  319 14623.6725 50860.7702   248%     -  106s
     0     0 50802.7846    0  318 14623.6725 50802.7846   247%     -  108s
     0     0 50795.9270    0  318 14623.6725 50795.9270   247%     -  108s
     0     0 47810.6383    0  367 14623.6725 47810.6383   227%     -  165s
H    0     0                    18504.779420 47810.1462   158%     -  166s
     0     0 47149.5628    0  367 18504.7794 47149.5628   155%     -  189s
     0     0 47019.4315    0  360 18504.7794 47019.4315   154%     -  202s
     0     0 46983.7998    0  370 18504.7794 46983.7998   154%     -  207s
     0     0 46956.4503    0  374 18504.7794 46956.4503   154%     -  211s
     0     0 46950.1934    0  321 18504.7794 46950.1934   154%     -  213s
     0     0 46945.9505    0  314 18504.7794 46945.9505   154%     -  215s
     0     0 46935.9659    0  364 18504.7794 46935.9659   154%     -  218s
     0     0 46920.1377    0  360 18504.7794 46920.1377   154%     -  221s
     0     0 46918.4624    0  369 18504.7794 46918.4624   154%     -  222s
     0     0 46918.2755    0  368 18504.7794 46918.2755   154%     -  223s
H    0     0                    21677.294870 45132.3284   108%     -  282s
H    0     0                    21829.616244 45132.3284   107%     -  282s
H    0     0                    22140.891518 45132.3284   104%     -  282s
     0     0 45132.3284    0  364 22140.8915 45132.3284   104%     -  283s
H    0     0                    23379.704021 45132.0168  93.0%     -  283s
H    0     0                    23742.051321 45132.0168  90.1%     -  284s
H    0     0                    23812.934719 45132.0168  89.5%     -  284s
     0     0 44454.9964    0  413 23812.9347 44454.9964  86.7%     -  312s
     0     0 44210.4385    0  340 23812.9347 44210.4385  85.7%     -  331s
     0     0 44130.8543    0  360 23812.9347 44130.8543  85.3%     -  341s
     0     0 44091.1624    0  366 23812.9347 44091.1624  85.2%     -  351s
     0     0 44036.5017    0  376 23812.9347 44036.5017  84.9%     -  357s
     0     0 44021.0669    0  367 23812.9347 44021.0669  84.9%     -  361s
     0     0 43994.6730    0  370 23812.9347 43994.6730  84.8%     -  364s
     0     0 43971.5435    0  373 23812.9347 43971.5435  84.7%     -  367s
     0     0 43964.4815    0  387 23812.9347 43964.4815  84.6%     -  370s
     0     0 43963.7315    0  382 23812.9347 43963.7315  84.6%     -  372s
     0     0 43410.7703    0  355 23812.9347 43410.7703  82.3%     -  403s
     0     0 43252.3931    0  436 23812.9347 43252.3931  81.6%     -  420s
     0     0 43170.0390    0  408 23812.9347 43170.0390  81.3%     -  432s
     0     0 43129.4788    0  444 23812.9347 43129.4788  81.1%     -  444s
     0     0 43123.5856    0  433 23812.9347 43123.5856  81.1%     -  448s
     0     0 43118.6388    0  444 23812.9347 43118.6388  81.1%     -  453s
     0     0 43113.9759    0  438 23812.9347 43113.9759  81.1%     -  455s
     0     0 43109.7158    0  388 23812.9347 43109.7158  81.0%     -  457s
     0     0 43108.4805    0  395 23812.9347 43108.4805  81.0%     -  458s
     0     0 42895.7815    0  422 23812.9347 42895.7815  80.1%     -  472s
H    0     0                    24018.626956 42895.7558  78.6%     -  473s
     0     0 42863.4326    0  476 24018.6270 42863.4326  78.5%     -  479s
     0     0 42828.4771    0  473 24018.6270 42828.4771  78.3%     -  484s
     0     0 42817.9576    0  477 24018.6270 42817.9576  78.3%     -  487s
     0     0 42805.8133    0  471 24018.6270 42805.8133  78.2%     -  489s
     0     0 42755.5481    0  446 24018.6270 42755.5481  78.0%     -  496s
     0     0 42738.4233    0  445 24018.6270 42738.4233  77.9%     -  499s
     0     0 42736.7551    0  445 24018.6270 42736.7551  77.9%     -  499s
     0     0 42670.3238    0  446 24018.6270 42670.3238  77.7%     -  510s
     0     0 42654.9193    0  399 24018.6270 42654.9193  77.6%     -  524s
     0     0 42647.9797    0  452 24018.6270 42647.9797  77.6%     -  527s
     0     0 42645.6008    0  439 24018.6270 42645.6008  77.6%     -  529s
     0     0 42621.1836    0  394 24018.6270 42621.1836  77.5%     -  533s
     0     0 42616.6914    0  435 24018.6270 42616.6914  77.4%     -  535s
     0     0 42616.0967    0  398 24018.6270 42616.0967  77.4%     -  536s
     0     0 42581.9251    0  461 24018.6270 42581.9251  77.3%     -  543s
     0     0 42570.2574    0  493 24018.6270 42570.2574  77.2%     -  547s
     0     0 42556.7262    0  499 24018.6270 42556.7262  77.2%     -  550s
     0     0 42553.8375    0  491 24018.6270 42553.8375  77.2%     -  551s
     0     0 42551.5111    0  443 24018.6270 42551.5111  77.2%     -  552s
     0     0 42550.5584    0  443 24018.6270 42550.5584  77.2%     -  553s
     0     0 42528.2156    0  462 24018.6270 42528.2156  77.1%     -  558s
H    0     0                    24121.028198 42528.2048  76.3%     -  562s
     0     0 42513.3237    0  501 24121.0282 42513.3237  76.3%     -  566s
     0     0 42510.4780    0  466 24121.0282 42510.4780  76.2%     -  568s
     0     0 42508.3910    0  464 24121.0282 42508.3910  76.2%     -  569s
     0     0 42488.0822    0  471 24121.0282 42488.0822  76.1%     -  575s
H    0     0                    24123.822990 42488.0816  76.1%     -  576s
     0     0 42468.3090    0  467 24123.8230 42468.3090  76.0%     -  581s
     0     0 42465.6365    0  497 24123.8230 42465.6365  76.0%     -  583s
     0     0 42463.9691    0  500 24123.8230 42463.9691  76.0%     -  584s
     0     0 42425.9767    0  515 24123.8230 42425.9767  75.9%     -  592s
     0     0 42406.6734    0  517 24123.8230 42406.6734  75.8%     -  602s
     0     0 42401.9219    0  526 24123.8230 42401.9219  75.8%     -  606s
     0     0 42399.3486    0  473 24123.8230 42399.3486  75.8%     -  608s
     0     0 42397.1844    0  477 24123.8230 42397.1844  75.7%     -  610s
     0     0 42395.7256    0  478 24123.8230 42395.7256  75.7%     -  611s
     0     0 42375.6101    0  467 24123.8230 42375.6101  75.7%     -  620s
     0     0 42370.7122    0  472 24123.8230 42370.7122  75.6%     -  624s
     0     0 42362.6036    0  464 24123.8230 42362.6036  75.6%     -  627s
     0     0 42357.3840    0  519 24123.8230 42357.3840  75.6%     -  630s
     0     0 42353.7039    0  422 24123.8230 42353.7039  75.6%     -  631s
     0     0 42351.5597    0  516 24123.8230 42351.5597  75.6%     -  633s
H    0     0                    24140.708626 42317.3886  75.3%     -  642s
     0     0 42317.3886    0  492 24140.7086 42317.3886  75.3%     -  642s
H    0     0                    24160.932155 42316.8065  75.1%     -  648s
H    0     0                    24162.486811 42316.8065  75.1%     -  649s
     0     0 42305.7293    0  461 24162.4868 42305.7293  75.1%     -  652s
     0     0 42302.8789    0  466 24162.4868 42302.8789  75.1%     -  654s
     0     0 42301.0179    0  513 24162.4868 42301.0179  75.1%     -  656s
     0     0 42288.9374    0  575 24162.4868 42288.9374  75.0%     -  662s
     0     0 42277.9178    0  409 24162.4868 42277.9178  75.0%     -  665s
     0     0 42276.5783    0  585 24162.4868 42276.5783  75.0%     -  668s
     0     0 42264.9781    0  454 24162.4868 42264.9781  74.9%     -  673s
H    0     0                    24225.107230 42264.8584  74.5%     -  739s
     0     0 42261.1038    0  413 24225.1072 42261.1038  74.5%     -  764s
     0     0 42260.2121    0  529 24225.1072 42260.2121  74.4%     -  766s
     0     0 42253.9779    0  526 24225.1072 42253.9779  74.4%     -  771s
     0     0 42252.5601    0  527 24225.1072 42252.5601  74.4%     -  773s
     0     0 42234.9596    0  522 24225.1072 42234.9596  74.3%     -  778s
     0     0 42229.6195    0  567 24225.1072 42229.6195  74.3%     -  781s
     0     0 42225.0535    0  574 24225.1072 42225.0535  74.3%     -  783s
     0     0 42222.4251    0  467 24225.1072 42222.4251  74.3%     -  786s
     0     0 42217.7538    0  461 24225.1072 42217.7538  74.3%     -  788s
     0     0 42216.2769    0  414 24225.1072 42216.2769  74.3%     -  789s
     0     0 42210.3229    0  525 24225.1072 42210.3229  74.2%     -  794s
     0     0 42208.3196    0  531 24225.1072 42208.3196  74.2%     -  796s
     0     0 42206.1854    0  454 24225.1072 42206.1854  74.2%     -  801s
     0     0 42204.7931    0  463 24225.1072 42204.7931  74.2%     -  802s
     0     0 42202.7468    0  460 24225.1072 42202.7468  74.2%     -  806s
     0     0 42201.0681    0  516 24225.1072 42201.0681  74.2%     -  808s
     0     0 42199.2637    0  464 24225.1072 42199.2637  74.2%     -  812s
     0     0 42199.0959    0  464 24225.1072 42199.0959  74.2%     -  816s
     0     2 42198.8466    0  464 24225.1072 42198.8466  74.2%     -  915s
     1     3 41987.2041    1  582 24225.1072 42198.5297  74.2%  9115  929s
     2     4 41949.4882    1  458 24225.1072 41987.0797  73.3%  7384  941s
     3     6 41774.0805    2  465 24225.1072 41986.6772  73.3%  6644  957s
     5    12 41299.7431    3  447 24225.1072 41949.3475  73.2%  7422  976s
    11    24 40663.9797    4  447 24225.1072 41603.4406  71.7%  9012  998s
    23    36 41356.6582    4  473 24225.1072 41575.6571  71.6% 12111 1058s
    35    67 40695.6286    5  399 24225.1072 41575.6571  71.6% 11727 1173s
    66   141 40618.6241    6  401 24225.1072 41439.1216  71.1% 14986 1235s
   140   251 40380.7901    8  402 24225.1072 41038.9038  69.4% 10190 1274s
   250   323 40060.1776   12  394 24225.1072 41038.7814  69.4%  7748 1304s
   322   353 38682.3733   13  306 24225.1072 41038.7814  69.4%  6956 1326s
   352   404 39589.2412   14  365 24225.1072 41038.7814  69.4%  6880 1352s
   403   469 34511.7996   14  180 24225.1072 41038.7814  69.4%  6507 1372s
   472   530 34324.2883   15  193 24225.1072 41038.7814  69.4%  6079 1394s
   541   598 33927.7100   18  180 24225.1072 41038.7814  69.4%  5785 1414s
   611   670 33315.6848   21  164 24225.1072 41038.7814  69.4%  5581 1430s
   685   744 33211.9702   23  156 24225.1072 41038.7814  69.4%  5377 1446s
   763   810 33148.2804   25  157 24225.1072 41038.7814  69.4%  5174 1463s
   837   884 27203.4496   27  131 24225.1072 41038.7814  69.4%  5125 1479s
   917   927 27004.7638   29  107 24225.1072 41038.7814  69.4%  5004 1501s
  1002   949 26855.8607   32  129 24225.1072 41038.7814  69.4%  4992 1523s
  1034   954 26741.3105   33  112 24225.1072 41038.7814  69.4%  4972 1544s
  1065   979 26422.2111   34   99 24225.1072 41038.7814  69.4%  5083 1566s
  1106   996 26309.6427   35   95 24225.1072 40954.6108  69.1%  5165 1588s
  1155  1014 26153.9581   36  114 24225.1072 40954.6108  69.1%  5189 1612s
  1201  1059 26064.5248   37  117 24225.1072 40954.6108  69.1%  5250 1635s
  1264  1102 24929.4171   41  107 24225.1072 40954.6108  69.1%  5287 1656s
  1343  1138 33897.7635    9  409 24225.1072 40954.6108  69.1%  5165 1680s
  1420  1210 28014.2681   29  205 24225.1072 40954.6108  69.1%  5156 1703s
  1505  1271 27577.1201   30  165 24225.1072 40954.6108  69.1%  5082 1728s
  1612  1317 26751.5547   33  164 24225.1072 40954.6108  69.1%  4962 1756s
  1704  1379 infeasible   35      24225.1072 40954.6108  69.1%  4972 1786s
  1788  1421 33207.6359   13  339 24225.1072 40954.6108  69.1%  5049 1814s
  1850  1478 26037.3685   15  204 24225.1072 40954.6108  69.1%  5102 1842s
  1933  1539 infeasible   18      24225.1072 40954.6108  69.1%  5095 1870s
  2016  1642 24565.6995   25  133 24225.1072 40954.6108  69.1%  5168 1901s
  2139  1718 infeasible   29      24225.1072 40653.7902  67.8%  5151 1929s
  2269  1780 27684.5379   25  227 24225.1072 40653.7902  67.8%  5201 1962s
  2389  1883 34550.7368    8  364 24225.1072 40653.7902  67.8%  5263 1996s
  2538  2014 33725.4445    9  353 24225.1072 40653.7902  67.8%  5279 2029s
  2705  2184 33988.7444   10  321 24225.1072 40653.7902  67.8%  5284 2062s
  2927  2334 33331.7003   15  349 24225.1072 40653.7902  67.8%  5215 2097s
  3152  2520 31729.1388   22  285 24225.1072 40591.5305  67.6%  5164 2139s
  3410  2637 30673.9622   23  270 24225.1072 40591.5305  67.6%  5074 2178s
  3623  2755 30117.5806   26  248 24225.1072 40591.5305  67.6%  5071 2218s
  3829  2756 30266.7686   45  464 24225.1072 40482.8647  67.1%  5087 2367s
  3831  2757 40173.1408    9  134 24225.1072 40482.8647  67.1%  5084 2380s
  3832  2758 25384.0698   54  344 24225.1072 40482.8647  67.1%  5083 2432s
  3833  2759 39514.7240   20  346 24225.1072 40482.8647  67.1%  5082 2472s
  3834  2759 39894.9801   14  432 24225.1072 40482.8647  67.1%  5080 2506s
  3835  2760 29581.3148   19  423 24225.1072 40482.8647  67.1%  5079 2529s
  3836  2761 32921.8501   17  451 24225.1072 40482.8647  67.1%  5078 2556s
  3837  2761 25435.4174   34  454 24225.1072 40482.8647  67.1%  5076 2571s
  3838  2762 30953.3595   28  502 24225.1072 40482.8647  67.1%  5075 2587s
  3839  2763 25917.7614   59  466 24225.1072 40482.8647  67.1%  5074 2600s
  3840  2763 32566.1686   12  481 24225.1072 40482.8647  67.1%  5072 2608s
  3841  2764 33155.5353    9  463 24225.1072 40482.8647  67.1%  5071 2615s
  3842  2765 26917.4266   29  504 24225.1072 40482.8647  67.1%  5070 2624s
  3843  2765 32528.2900   35  521 24225.1072 40482.8647  67.1%  5068 2629s
  3844  2766 26847.3190   47  467 24225.1072 40482.8647  67.1%  5067 2634s
  3845  2767 31278.4001   18  473 24225.1072 40482.8647  67.1%  5066 2638s
  3846  2767 34601.7623   11  518 24225.1072 40482.8647  67.1%  5064 2647s
  3847  2768 26039.6152   52  414 24225.1072 40482.8647  67.1%  5063 2665s
  3848  2769 27024.8929   40  553 24225.1072 40482.8647  67.1%  5062 2679s
  3849  2769 28644.0294   34  548 24225.1072 40482.8647  67.1%  5060 2686s
  3850  2770 28955.6487   24  556 24225.1072 40482.8647  67.1%  5059 2695s
  3851  2771 32450.1716   17  575 24225.1072 40482.8647  67.1%  5058 2700s
  3852  2771 33043.7982   19  566 24225.1072 40482.8647  67.1%  5056 2706s
  3853  2772 38916.2313    8  417 24225.1072 40482.8647  67.1%  5055 2721s
  3855  2773 27023.0632   36  423 24225.1072 40482.8647  67.1%  5053 2728s
  3856  2774 32115.0966   18  418 24225.1072 40482.8647  67.1%  5051 2732s
  3857  2775 29409.6229   49  425 24225.1072 40482.8647  67.1%  5050 2737s
  3858  2775 39675.7572   15  476 24225.1072 40482.8647  67.1%  5049 2757s
  3859  2776 39249.5633   21  493 24225.1072 40482.8647  67.1%  5047 2762s
  3860  2777 39353.3500   13  503 24225.1072 40482.8647  67.1%  5046 2768s
  3861  2777 30156.0246   28  481 24225.1072 40482.8647  67.1%  5045 2780s
  3862  2778 28555.4476   40  480 24225.1072 40482.8647  67.1%  5043 2788s
  3863  2779 27366.2396   38  499 24225.1072 40482.8647  67.1%  5042 2801s
  3864  2779 29323.1241   30  483 24225.1072 40482.8647  67.1%  5041 2809s
  3865  2780 27748.9842   21  428 24225.1072 40482.8647  67.1%  5039 2822s
  3866  2781 34258.1691   19  427 24225.1072 40482.8647  67.1%  5038 2828s
  3867  2781 30156.0246   28  482 24225.1072 40482.8647  67.1%  5037 2844s
  3868  2782 28850.6987   32  423 24225.1072 40482.8647  67.1%  5036 2848s
  3869  2783 26688.2030   33  487 24225.1072 40482.8647  67.1%  5034 2854s
  3870  2783 39828.3891   17  489 24225.1072 40482.8647  67.1%  5033 2869s
  3871  2784 40116.6995   12  435 24225.1072 40482.8647  67.1%  5032 2875s
  3873  2785 30655.2533   28  444 24225.1072 40482.8647  67.1%  5029 2885s
  3874  2786 39200.7311    9  435 24225.1072 40482.8647  67.1%  5028 2895s
  3875  2787 38245.2034   18  435 24225.1072 40482.8647  67.1%  5026 2920s
  3876  2787 37509.4011   10  435 24225.1072 40482.8647  67.1%  5025 3007s
  3877  2790 40482.8647   11  463 24225.1072 40482.8647  67.1%  5104 3055s
  3878  2791 40482.8647   11  414 24225.1072 40482.8647  67.1%  5105 3078s
  3879  2794 40482.8647   12  468 24225.1072 40482.8647  67.1%  5107 3133s
  3883  2801 40482.8647   13  480 24225.1072 40482.8647  67.1%  5116 3184s
  3891  2814 40436.7604   14  427 24225.1072 40482.8647  67.1%  5131 3245s
  3907  2825 38714.2509   15  446 24225.1072 40482.8647  67.1%  5185 3353s
  3923  2851 38214.9819   16  328 24225.1072 40482.8647  67.1%  5260 3432s
  3954  2937 37954.2790   17  321 24225.1072 40482.8647  67.1%  5299 3502s
  4051  2937 37305.9672   21  247 24225.1072 40482.8647  67.1%  5401 3543s
  4083  2960 36970.0516   22  236 24225.1072 40482.8647  67.1%  5416 3588s
  4126  2947     cutoff   21      24225.1072 40482.8647  67.1%  5420 3600s

Cutting planes:
  Learned: 2
  Implied bound: 5
  Projected implied bound: 17
  MIR: 550
  Mixing: 2
  Flow cover: 2488
  RLT: 24
  Relax-and-lift: 291

Explored 4133 nodes (22834866 simplex iterations) in 3600.06 seconds (5861.41 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 24225.1 24162.5 24160.9 ... 23379.7

Time limit reached
Best objective 2.422510723029e+04, best bound 4.048286468749e+04, gap 67.1112%
  WARNING: Time limit reached. Using best solution found (gap: 67.11%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 24225.11, θ = 179592.59
  Upper Bound (UB) = 24225.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179592.59
  [DEBUG]   ✓ Scenario 0: θ = 179592.59 ≤ Q = 179592.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 179592.59 ≤ Q = 179592.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179592.59 ≤ Q = 179592.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179592.59 ≤ Q = 179592.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179592.59 ≤ Q = 179592.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 179592.59 ≤ Q = 179592.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 179592.59 ≤ Q = 179592.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 179592.59 ≤ Q = 179592.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 179592.59 ≤ Q = 179592.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 179592.59 ≤ Q = 179592.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 179592.59 ≤ Q = 179592.59 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3ea68f72
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3ea68f72
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.433799e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6848829.2693
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.637992e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163799.19    0  123 6848829.27 -163799.19   102%     -    0s
H    0     0                    -129151.9327 -163799.19  26.8%     -    0s
H    0     0                    -130230.7274 -163799.19  25.8%     -    0s
H    0     0                    -131672.9960 -142013.91  7.85%     -    0s
H    0     0                    -138166.7547 -142013.91  2.78%     -    0s
     0     0 -142013.91    0   53 -138166.75 -142013.91  2.78%     -    0s
H    0     0                    -139369.2689 -141995.90  1.88%     -    0s
     0     0 -141934.22    0   50 -139369.27 -141934.22  1.84%     -    0s
     0     0 -141933.76    0   50 -139369.27 -141933.76  1.84%     -    0s
     0     0 -141814.36    0   27 -139369.27 -141814.36  1.75%     -    0s
H    0     0                    -139840.6341 -141794.68  1.40%     -    0s
H    0     0                    -140149.1361 -141794.68  1.17%     -    0s
H    0     0                    -141693.1801 -141794.68  0.07%     -    0s
     0     0 -141789.56    0   34 -141693.18 -141789.56  0.07%     -    0s
     0     0 -141766.86    0   12 -141693.18 -141766.86  0.05%     -    0s
     0     0 -141731.72    0    7 -141693.18 -141731.72  0.03%     -    0s
     0     0 -141716.02    0    6 -141693.18 -141716.02  0.02%     -    0s
     0     0 -141702.11    0    5 -141693.18 -141702.11  0.01%     -    0s
     0     0 -141697.03    0    2 -141693.18 -141697.03  0.00%     -    0s
H    0     0                    -141695.1648 -141695.48  0.00%     -    0s
     0     0 -141695.48    0    2 -141695.16 -141695.48  0.00%     -    0s
     0     0     cutoff    0      -141695.16 -141695.16  0.00%     -    0s

Cutting planes:
  Gomory: 15
  MIR: 97
  RLT: 33

Explored 1 nodes (504 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -141695 -141693 -140149 ... 1.4338e+13
No other solutions better than -141695

Optimal solution found (tolerance 1.00e-06)
Best objective -1.416951647556e+05, best bound -1.416951647556e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 166355.91
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141695.16
  [DEBUG]   S×d_nominal = 308051.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308051.07 + -141695.16 = 166355.91
  [DEBUG]   Current θ from Master = 179592.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13236.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10988.42
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 890.9405, Absolute Gap = 890.9405, Relative Gap = 0.036778
  Not converged yet (gap = 890.94 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0xaaa519f8
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 85220 rows and 34630 columns
Presolve time: 3.52s
Presolved: 99643 rows, 42510 columns, 606131 nonzeros
Variable types: 40251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -341326.3384
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 Dense cols : 638
 AA' NZ     : 3.496e+06
 Factor NZ  : 8.199e+06 (roughly 120 MB of memory)
 Factor Ops : 1.560e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.86094266e+07  1.94494800e+08  1.22e+05 1.96e+01  8.36e+04     5s
   1  -1.40267371e+07  1.73226619e+08  8.47e+04 9.41e+01  5.75e+04     5s
   2  -4.62309574e+06  1.33597974e+08  2.78e+04 5.46e-01  2.00e+04     6s
   3  -1.59123622e+06  1.10213928e+08  4.98e+03 8.40e+00  3.99e+03     6s
   4  -8.68033061e+05  7.45743808e+07  9.02e+02 3.01e+00  9.90e+02     6s
   5  -7.57857406e+05  6.30008880e+07  4.03e+02 2.39e+00  5.97e+02     6s
   6  -4.90725313e+05  3.59168471e+07  2.87e+02 1.16e+00  3.56e+02     6s
   7  -3.99889828e+05  2.77095453e+07  9.91e+01 8.27e-01  2.05e+02     6s
   8  -3.16983138e+05  1.74049474e+07  4.19e+01 3.80e-01  1.15e+02     6s
   9  -2.00171975e+05  8.09441635e+06  1.65e+01 6.23e-03  4.98e+01     6s
  10  -1.19958106e+05  4.81689189e+06  6.94e+00 3.47e-03  2.83e+01     6s
  11  -1.04179764e+05  3.77720723e+06  5.48e+00 2.69e-03  2.20e+01     6s
  12  -7.89514927e+04  1.96395599e+06  3.65e+00 1.38e-03  1.15e+01     6s
  13  -3.72587416e+04  1.24001352e+06  1.50e+00 4.33e-03  7.08e+00     6s
  14  -1.54415506e+04  4.40001723e+05  9.45e-01 2.85e-04  2.52e+00     7s
  15  -2.72471276e+03  2.64783195e+05  6.11e-01 1.86e-04  1.47e+00     7s
  16   8.71825157e+03  1.78674755e+05  4.37e-01 1.34e-04  9.36e-01     7s
  17   1.42816458e+04  1.45708937e+05  3.69e-01 1.94e-04  7.24e-01     7s
  18   2.20154732e+04  1.12308014e+05  2.90e-01 2.96e-04  4.97e-01     7s
  19   3.10399985e+04  8.99954193e+04  2.02e-01 1.40e-03  3.24e-01     7s
  20   3.73313510e+04  8.08402451e+04  1.50e-01 1.56e-03  2.39e-01     7s
  21   4.28280428e+04  7.57956610e+04  1.05e-01 1.21e-03  1.81e-01     7s
  22   4.46205154e+04  7.19828795e+04  9.13e-02 1.44e-03  1.50e-01     7s
  23   4.70952518e+04  6.91514463e+04  7.26e-02 1.75e-03  1.21e-01     7s
  24   4.87101341e+04  6.65662512e+04  6.06e-02 1.44e-03  9.82e-02     7s
  25   5.03331893e+04  6.44802965e+04  4.92e-02 1.44e-03  7.78e-02     8s
  26   5.23290859e+04  6.28459719e+04  3.48e-02 1.20e-03  5.78e-02     8s
  27   5.35111843e+04  6.13832877e+04  2.68e-02 1.51e-03  4.33e-02     8s
  28   5.37061137e+04  6.10509972e+04  2.56e-02 1.39e-03  4.04e-02     8s
  29   5.41055601e+04  6.03444670e+04  2.30e-02 1.06e-03  3.43e-02     8s
  30   5.49596950e+04  5.99705349e+04  1.76e-02 9.57e-04  2.76e-02     8s
  31   5.53785909e+04  5.96519720e+04  1.50e-02 7.74e-04  2.35e-02     8s
  32   5.60539558e+04  5.90931733e+04  1.09e-02 5.59e-04  1.67e-02     8s
  33   5.64365054e+04  5.88856440e+04  8.60e-03 4.55e-04  1.35e-02     8s
  34   5.66044106e+04  5.86090940e+04  7.59e-03 3.15e-04  1.10e-02     8s
  35   5.68621332e+04  5.84383173e+04  6.13e-03 2.65e-04  8.67e-03     9s
  36   5.70945362e+04  5.83657409e+04  4.76e-03 2.25e-04  6.99e-03     9s
  37   5.72646235e+04  5.81768814e+04  3.79e-03 1.17e-04  5.02e-03     9s
  38   5.73879025e+04  5.81145888e+04  3.09e-03 8.24e-05  4.00e-03     9s
  39   5.74371174e+04  5.81088525e+04  2.82e-03 7.93e-05  3.70e-03     9s
  40   5.76364969e+04  5.80494097e+04  1.68e-03 7.77e-05  2.27e-03     9s
  41   5.76675276e+04  5.80243114e+04  1.51e-03 6.77e-05  1.96e-03     9s
  42   5.77726325e+04  5.80051046e+04  9.39e-04 4.49e-05  1.28e-03     9s
  43   5.78103186e+04  5.79882604e+04  7.38e-04 3.10e-05  9.79e-04    10s
  44   5.78803011e+04  5.79704855e+04  3.59e-04 1.73e-05  4.96e-04    10s
  45   5.79396794e+04  5.79546597e+04  3.71e-05 4.14e-06  8.23e-05    10s
  46   5.79410447e+04  5.79509865e+04  3.14e-05 2.09e-06  5.46e-05    10s
  47   5.79472346e+04  5.79490321e+04  3.94e-06 5.26e-07  9.87e-06    10s
  48   5.79483327e+04  5.79489468e+04  8.68e-07 4.75e-07  3.37e-06    10s
  49   5.79485690e+04  5.79486566e+04  1.90e-07 2.32e-08  4.81e-07    10s
  50   5.79486398e+04  5.79486430e+04  7.37e-09 2.25e-08  1.77e-08    10s
  51   5.79486425e+04  5.79486427e+04  4.32e-08 2.42e-09  1.18e-09    11s

Barrier solved model in 51 iterations and 10.61 seconds (8.86 work units)
Optimal objective 5.79486425e+04


Root crossover log...

   89602 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    9747 PPushes remaining with PInf 5.0542858e-05                15s
    5226 PPushes remaining with PInf 3.2381220e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3680280e+06     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53393    5.7948643e+04   0.000000e+00   1.368028e+06     16s
   55655    5.7948643e+04   0.000000e+00   0.000000e+00     18s
   55655    5.7948643e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.30s

Solved with barrier

Root relaxation: objective 5.794864e+04, 55655 iterations, 14.34 seconds (17.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57948.6427    0  151 -239613.87 57948.6427   124%     -   19s
H    0     0                    -232208.0860 57948.6427   125%     -   19s
H    0     0                    -221450.8434 57948.6427   126%     -   19s
H    0     0                    -220627.1358 57948.6427   126%     -   19s
H    0     0                    -219250.8598 57948.6427   126%     -   19s
H    0     0                    -205948.7319 57948.6427   128%     -   20s
H    0     0                    -199600.3448 57948.6427   129%     -   20s
H    0     0                    -148776.5805 57948.6427   139%     -   20s
H    0     0                    -143051.6885 57948.6427   141%     -   20s
H    0     0                    -143043.7910 57948.6427   141%     -   20s
H    0     0                    -142660.8984 57948.6427   141%     -   20s
H    0     0                    -142377.6405 57948.6427   141%     -   21s
H    0     0                    -142345.4247 57948.6427   141%     -   21s
H    0     0                    -142227.8583 57948.6427   141%     -   21s
H    0     0                    -141154.2040 57948.6427   141%     -   21s
H    0     0                    -140982.9346 57948.6427   141%     -   21s
H    0     0                    -50674.74374 57948.6427   214%     -   21s
H    0     0                    2866.1006826 57948.6427  1922%     -   21s
H    0     0                    4039.3528293 57948.6427  1335%     -   21s
     0     0 52582.5156    0  319 4039.35283 52582.5156  1202%     -   89s
H    0     0                    4158.8289385 52582.5156  1164%     -   90s
     0     0 52279.2832    0  315 4158.82894 52279.2832  1157%     -  114s
     0     0 52177.7584    0  308 4158.82894 52177.7584  1155%     -  135s
     0     0 52177.7584    0  299 4158.82894 52177.7584  1155%     -  141s
     0     0 52177.7584    0  313 4158.82894 52177.7584  1155%     -  146s
     0     0 52177.7584    0  315 4158.82894 52177.7584  1155%     -  150s
     0     0 52177.7584    0  315 4158.82894 52177.7584  1155%     -  151s
H    0     0                    8779.8441177 47926.6791   446%     -  205s
H    0     0                    8916.6831666 47926.6791   437%     -  205s
H    0     0                    8972.4448977 47926.6791   434%     -  205s
H    0     0                    9640.0922964 47926.6791   397%     -  205s
     0     0 47926.6791    0  341 9640.09230 47926.6791   397%     -  205s
H    0     0                    12907.481437 47925.3715   271%     -  206s
H    0     0                    13096.827439 47925.3715   266%     -  206s
H    0     0                    13106.228984 47925.3715   266%     -  206s
     0     0 47373.1036    0  346 13106.2290 47373.1036   261%     -  232s
     0     0 47218.4667    0  351 13106.2290 47218.4667   260%     -  248s
     0     0 46961.1497    0  338 13106.2290 46961.1497   258%     -  264s
     0     0 46889.0402    0  360 13106.2290 46889.0402   258%     -  284s
     0     0 46857.7817    0  361 13106.2290 46857.7817   258%     -  296s
     0     0 46845.2308    0  360 13106.2290 46845.2308   257%     -  304s
     0     0 46839.9581    0  366 13106.2290 46839.9581   257%     -  309s
     0     0 46829.9937    0  365 13106.2290 46829.9937   257%     -  313s
     0     0 46815.6265    0  369 13106.2290 46815.6265   257%     -  318s
     0     0 46799.7370    0  356 13106.2290 46799.7370   257%     -  323s
     0     0 46794.9973    0  370 13106.2290 46794.9973   257%     -  325s
     0     0 46794.9824    0  370 13106.2290 46794.9824   257%     -  327s
     0     0 45057.9524    0  339 13106.2290 45057.9524   244%     -  410s
H    0     0                    14152.876616 45057.6866   218%     -  411s
H    0     0                    15471.195770 45057.6866   191%     -  411s
H    0     0                    16070.614778 45057.6866   180%     -  411s
H    0     0                    16811.507905 45057.6866   168%     -  412s
H    0     0                    17463.294547 45057.6866   158%     -  412s
H    0     0                    17657.973237 45057.6866   155%     -  412s
     0     0 44524.7429    0  294 17657.9732 44524.7429   152%     -  455s
     0     0 44250.9116    0  305 17657.9732 44250.9116   151%     -  483s
     0     0 44149.1457    0  315 17657.9732 44149.1457   150%     -  501s
     0     0 44105.0341    0  360 17657.9732 44105.0341   150%     -  510s
     0     0 44083.3680    0  317 17657.9732 44083.3680   150%     -  516s
     0     0 44065.6410    0  362 17657.9732 44065.6410   150%     -  522s
     0     0 44045.0494    0  404 17657.9732 44045.0494   149%     -  531s
     0     0 44003.1174    0  358 17657.9732 44003.1174   149%     -  543s
     0     0 43975.5248    0  365 17657.9732 43975.5248   149%     -  550s
     0     0 43969.0775    0  364 17657.9732 43969.0775   149%     -  559s
     0     0 43967.0459    0  356 17657.9732 43967.0459   149%     -  565s
H    0     0                    18816.453602 43964.5432   134%     -  572s
     0     0 43964.5432    0  362 18816.4536 43964.5432   134%     -  572s
H    0     0                    19677.846645 43963.6660   123%     -  574s
H    0     0                    20588.262624 43963.6660   114%     -  574s
     0     0 43963.6660    0  370 20588.2626 43963.6660   114%     -  574s
H    0     0                    20713.167671 43963.6660   112%     -  590s
H    0     0                    21367.429458 43963.6660   106%     -  590s
H    0     0                    21514.750085 43963.6660   104%     -  590s
H    0     0                    22350.248336 43963.6660  96.7%     -  590s
     0     0 43439.1769    0  374 22350.2483 43439.1769  94.4%     -  616s
     0     0 43252.8948    0  400 22350.2483 43252.8948  93.5%     -  634s
     0     0 43195.9047    0  392 22350.2483 43195.9047  93.3%     -  644s
     0     0 43164.5580    0  402 22350.2483 43164.5580  93.1%     -  655s
     0     0 43140.2279    0  410 22350.2483 43140.2279  93.0%     -  664s
     0     0 43134.0131    0  405 22350.2483 43134.0131  93.0%     -  668s
     0     0 43100.3330    0  489 22350.2483 43100.3330  92.8%     -  680s
     0     0 43089.5123    0  489 22350.2483 43089.5123  92.8%     -  684s
     0     0 43078.3863    0  500 22350.2483 43078.3863  92.7%     -  689s
     0     0 43075.0961    0  500 22350.2483 43075.0961  92.7%     -  691s
H    0     0                    22561.118144 43068.2717  90.9%     -  695s
     0     0 43068.2717    0  503 22561.1181 43068.2717  90.9%     -  695s
     0     0 43058.1262    0  510 22561.1181 43058.1262  90.9%     -  701s
     0     0 43052.8246    0  505 22561.1181 43052.8246  90.8%     -  706s
     0     0 43049.9095    0  508 22561.1181 43049.9095  90.8%     -  710s
     0     0 43041.7826    0  502 22561.1181 43041.7826  90.8%     -  713s
     0     0 43039.2439    0  508 22561.1181 43039.2439  90.8%     -  715s
     0     0 43039.0470    0  510 22561.1181 43039.0470  90.8%     -  715s
     0     0 42878.3079    0  483 22561.1181 42878.3079  90.1%     -  739s
     0     0 42810.5381    0  400 22561.1181 42810.5381  89.8%     -  749s
     0     0 42797.7673    0  409 22561.1181 42797.7673  89.7%     -  753s
     0     0 42752.7435    0  406 22561.1181 42752.7435  89.5%     -  761s
     0     0 42738.3047    0  419 22561.1181 42738.3047  89.4%     -  766s
     0     0 42728.3468    0  425 22561.1181 42728.3468  89.4%     -  770s
     0     0 42690.8226    0  466 22561.1181 42690.8226  89.2%     -  777s
     0     0 42685.2196    0  417 22561.1181 42685.2196  89.2%     -  781s
     0     0 42683.2773    0  416 22561.1181 42683.2773  89.2%     -  783s
     0     0 42604.7359    0  475 22561.1181 42604.7359  88.8%     -  795s
     0     0 42579.3437    0  487 22561.1181 42579.3437  88.7%     -  811s
     0     0 42571.0616    0  481 22561.1181 42571.0616  88.7%     -  816s
     0     0 42562.2414    0  490 22561.1181 42562.2414  88.7%     -  820s
     0     0 42553.2524    0  491 22561.1181 42553.2524  88.6%     -  824s
     0     0 42550.9595    0  499 22561.1181 42550.9595  88.6%     -  826s
     0     0 42549.9277    0  505 22561.1181 42549.9277  88.6%     -  828s
     0     0 42511.9076    0  484 22561.1181 42511.9076  88.4%     -  836s
     0     0 42500.6368    0  485 22561.1181 42500.6368  88.4%     -  842s
     0     0 42458.2214    0  481 22561.1181 42458.2214  88.2%     -  850s
     0     0 42448.9584    0  491 22561.1181 42448.9584  88.2%     -  855s
     0     0 42445.7975    0  483 22561.1181 42445.7975  88.1%     -  857s
     0     0 42443.6631    0  487 22561.1181 42443.6631  88.1%     -  859s
     0     0 42419.2955    0  483 22561.1181 42419.2955  88.0%     -  866s
     0     0 42399.9729    0  473 22561.1181 42399.9729  87.9%     -  878s
     0     0 42395.8735    0  479 22561.1181 42395.8735  87.9%     -  881s
     0     0 42392.0470    0  489 22561.1181 42392.0470  87.9%     -  885s
     0     0 42388.3953    0  476 22561.1181 42388.3953  87.9%     -  888s
     0     0 42385.7108    0  468 22561.1181 42385.7108  87.9%     -  890s
     0     0 42385.2057    0  472 22561.1181 42385.2057  87.9%     -  891s
     0     0 42373.6454    0  470 22561.1181 42373.6454  87.8%     -  898s
     0     0 42362.5873    0  489 22561.1181 42362.5873  87.8%     -  903s
     0     0 42360.6026    0  481 22561.1181 42360.6026  87.8%     -  907s
     0     0 42347.2243    0  482 22561.1181 42347.2243  87.7%     -  913s
     0     0 42344.6446    0  482 22561.1181 42344.6446  87.7%     -  918s
     0     0 42343.0989    0  489 22561.1181 42343.0989  87.7%     -  920s
     0     0 42319.0408    0  491 22561.1181 42319.0408  87.6%     -  927s
     0     0 42311.1874    0  482 22561.1181 42311.1874  87.5%     -  935s
     0     0 42303.5774    0  486 22561.1181 42303.5774  87.5%     -  939s
     0     0 42302.1099    0  487 22561.1181 42302.1099  87.5%     -  940s
     0     0 42282.8170    0  520 22561.1181 42282.8170  87.4%     -  948s
H    0     0                    22726.384235 42282.7270  86.1%     -  980s
H    0     0                    23169.793485 42282.7270  82.5%     -  989s
     0     0 42275.5956    0  476 23169.7935 42275.5956  82.5%     -  994s
     0     0 42272.3727    0  492 23169.7935 42272.3727  82.4%     -  997s
     0     0 42268.7716    0  485 23169.7935 42268.7716  82.4%     - 1000s
     0     0 42267.0120    0  526 23169.7935 42267.0120  82.4%     - 1002s
     0     0 42264.2752    0  523 23169.7935 42264.2752  82.4%     - 1006s
H    0     0                    23430.305490 42263.8184  80.4%     - 1007s
H    0     0                    23431.860145 42263.8184  80.4%     - 1007s
     0     0 42262.5549    0  482 23431.8601 42262.5549  80.4%     - 1009s
     0     0 42261.6155    0  488 23431.8601 42261.6155  80.4%     - 1012s
     0     0 42261.2931    0  484 23431.8601 42261.2931  80.4%     - 1013s
     0     0 42260.6193    0  486 23431.8601 42260.6193  80.4%     - 1015s
     0     0 42260.2527    0  486 23431.8601 42260.2527  80.4%     - 1021s
H    0     0                    23485.957248 42260.2527  79.9%     - 1115s
H    0     0                    23586.108916 42260.2527  79.2%     - 1115s
H    0     0                    23690.374929 42260.2527  78.4%     - 1115s
H    0     0                    23698.224241 42260.2527  78.3%     - 1115s
H    0     0                    23784.337021 42260.2527  77.7%     - 1115s
H    0     0                    23858.599295 42260.2527  77.1%     - 1196s
H    0     0                    23885.237594 42260.2527  76.9%     - 1199s
H    0     0                    23898.413837 42260.2527  76.8%     - 1199s
H    0     0                    23899.968493 42260.2527  76.8%     - 1199s
H    0     2                    23959.309730 42260.2527  76.4%     - 1201s
     0     2 42260.2527    0  486 23959.3097 42260.2527  76.4%     - 1201s
     1     3 42238.1937    1  511 23959.3097 42260.2527  76.4%  1525 1208s
     2     4 42193.5302    1  465 23959.3097 42237.9603  76.3%  2203 1222s
     3     5 41517.8005    2  465 23959.3097 42237.9603  76.3%  6835 1250s
     4     9 41643.7774    2  469 23959.3097 42192.3681  76.1%  6691 1272s
     8    17 41229.4860    3  442 23959.3097 41826.2641  74.6%  7582 1345s
    16    34 41164.7345    4  416 23959.3097 41826.2641  74.6% 11262 1376s
    33    49 40630.3609    5  407 23959.3097 41397.5811  72.8% 15217 1458s
H   48    78                    23996.967334 41397.5811  72.5% 15230 1521s
    77   167 40521.8599    7  385 23996.9673 41397.5811  72.5% 11903 1642s
   166   268 40016.5971    9  352 23996.9673 41397.5811  72.5%  8007 1688s
H  258   268                    24055.608262 41397.5811  72.1%  6958 1688s
   267   341 39955.9212   10  357 24055.6083 41397.5811  72.1%  6908 1728s
   340   416 39815.0828   12  351 24055.6083 41397.5811  72.1%  6240 1765s
   415   478 39713.4394   16  355 24055.6083 41397.5811  72.1%  5743 1800s
   477   557 39561.3924   19  343 24055.6083 41397.5811  72.1%  5412 1830s
   556   610 39470.6325   24  336 24055.6083 41397.5811  72.1%  5050 1863s
   609   678 39122.3762   27  361 24055.6083 41397.5811  72.1%  4942 1894s
   677   743 39106.6452   29  312 24055.6083 41397.5811  72.1%  4789 1924s
   742   768 38444.5570   32  316 24055.6083 41397.5811  72.1%  4651 1952s
   767   807 38361.5528   33  311 24055.6083 41397.5811  72.1%  4625 1979s
   806   837 38213.1929   34  341 24055.6083 41397.5811  72.1%  4563 2005s
   836   876 38162.4056   35  313 24055.6083 41397.5811  72.1%  4532 2030s
   875   913 37671.1612   36  365 24055.6083 41397.5811  72.1%  4470 2053s
H  876   913                    24077.096971 41397.5811  71.9%  4465 2053s
   912  1007 37544.2750   37  259 24077.0970 41397.5811  71.9%  4445 2085s
  1008  1036 37058.9107   43  242 24077.0970 41397.5811  71.9%  4241 2108s
H 1022  1036                    24113.594975 41397.5811  71.7%  4233 2108s
H 1032  1036                    24321.712071 41397.5811  70.2%  4222 2108s
  1041  1115 35477.1047   44  278 24321.7121 41397.5811  70.2%  4227 2140s
  1128  1204 35382.4064   45  277 24321.7121 41397.5811  70.2%  4128 2179s
  1225  1315 34430.4382   50  308 24321.7121 41397.5811  70.2%  4053 2214s
  1342  1398 33942.4447   58  225 24321.7121 41397.5811  70.2%  3914 2250s
  1447  1427 27727.1627   63  232 24321.7121 41397.5811  70.2%  3874 2280s
  1490  1532 27649.7351   64  228 24321.7121 41397.5811  70.2%  3878 2320s
  1608  1685 27144.8272   72  256 24321.7121 41397.5811  70.2%  3771 2357s
  1788  1791 25723.1099   83  171 24321.7121 41397.5811  70.2%  3562 2399s
  1958  1794     cutoff   91      24321.7121 41397.5811  70.2%  3417 2446s
  2111  1786 infeasible   90      24321.7121 41235.7558  69.5%  3362 2494s
  2179  1805 40562.1945    6  444 24321.7121 41176.3371  69.3%  3379 2542s
  2264  1836 34996.2997    7  347 24321.7121 41176.3371  69.3%  3399 2597s
  2367  1882 34422.3186    7  410 24321.7121 41176.3371  69.3%  3412 2652s
  2452  1948 34143.8164    8  357 24321.7121 41176.3371  69.3%  3473 2711s
  2532  2026 33792.7519    9  326 24321.7121 41176.3371  69.3%  3533 2766s
  2639  2133 33616.2872   10  308 24321.7121 41176.3371  69.3%  3589 2814s
  2766  2256 33588.2041   11  305 24321.7121 40917.5549  68.2%  3615 2871s
  2911  2392 30803.7932   21  219 24321.7121 40917.5549  68.2%  3623 2930s
  3087  2532 31671.7950   12  258 24321.7121 40917.5549  68.2%  3609 2992s
  3283  2649 31100.2896   13  249 24321.7121 40917.5549  68.2%  3576 3070s
  3456  2819 29297.5887   15  296 24321.7121 40746.0079  67.5%  3598 3131s
H 3702  2810                    24591.433789 40746.0079  65.7%  3557 3180s
  3703  2811 29053.5753   44  486 24591.4338 40746.0079  65.7%  3556 3450s
  3705  2812 38353.5258   28  131 24591.4338 40746.0079  65.7%  3554 3464s
  3706  2813 33267.7280   23  337 24591.4338 40746.0079  65.7%  3553 3550s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 1
  MIR: 192
  Mixing: 2
  Flow cover: 489
  RLT: 13
  Relax-and-lift: 76

Explored 3706 nodes (13826755 simplex iterations) in 3600.03 seconds (4999.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 24591.4 24321.7 24113.6 ... 23885.2

Time limit reached
Best objective 2.459143378861e+04, best bound 4.074600788544e+04, gap 65.6919%
  WARNING: Time limit reached. Using best solution found (gap: 65.69%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 24591.43, θ = 177855.13
  Upper Bound (UB) = 24591.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 177855.13
  [DEBUG]   ✓ Scenario 0: θ = 177855.13 ≤ Q = 177855.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 177855.13 ≤ Q = 177855.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 177855.13 ≤ Q = 177855.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 177855.13 ≤ Q = 177855.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 177855.13 ≤ Q = 177855.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 177855.13 ≤ Q = 177855.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 177855.13 ≤ Q = 177855.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 177855.13 ≤ Q = 177855.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 177855.13 ≤ Q = 177855.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 177855.13 ≤ Q = 177855.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 177855.13 ≤ Q = 177855.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 177855.13 ≤ Q = 177855.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1d42c779
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe2bd3887
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.422475e+13
Presolve removed 2606 rows and 1897 columns
Presolve time: 0.01s
Presolved: 487 rows, 492 columns, 1374 nonzeros
Found heuristic solution: objective 6794598.5187
Variable types: 333 continuous, 159 integer (159 binary)
Found heuristic solution: objective 6794246.2322

Root relaxation: objective -1.613833e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161383.29    0  123 6794246.23 -161383.29   102%     -    0s
H    0     0                    -127577.8096 -161383.29  26.5%     -    0s
H    0     0                    -135560.4040 -161383.29  19.0%     -    0s
H    0     0                    -137006.9881 -161241.85  17.7%     -    0s
     0     0 -143261.64    0  102 -137006.99 -143261.64  4.57%     -    0s
H    0     0                    -139818.2489 -143136.20  2.37%     -    0s
H    0     0                    -140616.3089 -143136.20  1.79%     -    0s
     0     0 -142043.48    0  109 -140616.31 -142043.48  1.01%     -    0s
H    0     0                    -140787.5697 -141982.25  0.85%     -    0s
     0     0 -141982.25    0  100 -140787.57 -141982.25  0.85%     -    0s
     0     0 -141982.25    0  109 -140787.57 -141982.25  0.85%     -    0s
     0     0 -141378.06    0   81 -140787.57 -141378.06  0.42%     -    0s
H    0     0                    -140791.1402 -141257.61  0.33%     -    0s
     0     0 -141257.61    0   58 -140791.14 -141257.61  0.33%     -    0s
     0     0 -141237.88    0   63 -140791.14 -141237.88  0.32%     -    0s
     0     0 -141229.95    0   63 -140791.14 -141229.95  0.31%     -    0s
     0     0 -141051.11    0   44 -140791.14 -141051.11  0.18%     -    0s
     0     0 -141042.79    0   42 -140791.14 -141042.79  0.18%     -    0s
     0     0 -140982.48    0   39 -140791.14 -140982.48  0.14%     -    0s
H    0     0                    -140854.8136 -140980.49  0.09%     -    0s
     0     0 -140980.49    0   40 -140854.81 -140980.49  0.09%     -    0s
     0     0 -140976.50    0   39 -140854.81 -140976.50  0.09%     -    0s
     0     0 -140976.50    0   39 -140854.81 -140976.50  0.09%     -    0s
     0     0 -140976.50    0   43 -140854.81 -140976.50  0.09%     -    0s
H    0     0                    -140884.0704 -140976.50  0.07%     -    0s
     0     0 -140976.50    0   33 -140884.07 -140976.50  0.07%     -    0s
H    0     0                    -140894.1925 -140976.50  0.06%     -    0s
     0     0 -140976.50    0   30 -140894.19 -140976.50  0.06%     -    0s
     0     0 -140934.48    0    8 -140894.19 -140934.48  0.03%     -    0s
     0     0 -140908.72    0    6 -140894.19 -140908.72  0.01%     -    0s
     0     0 -140908.58    0    4 -140894.19 -140908.58  0.01%     -    0s
     0     0 -140901.45    0    2 -140894.19 -140901.45  0.01%     -    0s
H    0     0                    -140894.4378 -140901.45  0.00%     -    0s
     0     0 -140900.21    0    5 -140894.44 -140900.21  0.00%     -    0s
     0     0 -140897.36    0    2 -140894.44 -140897.36  0.00%     -    0s
     0     0 -140897.12    0    2 -140894.44 -140897.12  0.00%     -    0s
H    0     0                    -140897.1218 -140897.12  0.00%     -    0s

Cutting planes:
  MIR: 1
  Flow cover: 1

Explored 1 nodes (1023 simplex iterations) in 0.21 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -140897 -140894 -140884 ... -135560
No other solutions better than -140897

Optimal solution found (tolerance 1.00e-06)
Best objective -1.408971218490e+05, best bound -1.408971218490e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 167153.95
  Scenario: 49 demand increases, 11 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140897.12
  [DEBUG]   S×d_nominal = 308051.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308051.07 + -140897.12 = 167153.95
  [DEBUG]   Current θ from Master = 177855.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10701.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13890.25
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 1257.2670, Absolute Gap = 1257.2670, Relative Gap = 0.051126
  Not converged yet (gap = 1257.27 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 49 increases, 11 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x78ad4991
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 92310 rows and 37510 columns
Presolve time: 3.48s
Presolved: 107843 rows, 45870 columns, 651121 nonzeros
Variable types: 43611 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -343158.0855
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.33s

Barrier statistics:
 Dense cols : 628
 AA' NZ     : 3.899e+06
 Factor NZ  : 9.629e+06 (roughly 140 MB of memory)
 Factor Ops : 2.219e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.92414610e+07  2.09383799e+08  1.25e+05 1.63e+01  8.58e+04     5s
   1  -1.45741811e+07  1.87706907e+08  8.74e+04 9.31e+01  5.92e+04     5s
   2  -4.66461263e+06  1.45491383e+08  2.80e+04 6.68e-01  2.01e+04     5s
   3  -2.34942465e+06  1.46769389e+08  1.26e+04 2.66e+01  9.48e+03     6s
   4  -8.38006237e+05  1.10280186e+08  1.38e+03 6.01e+00  1.49e+03     6s
   5  -6.39487236e+05  5.43427035e+07  5.52e+02 1.61e+00  6.04e+02     6s
   6  -4.52715643e+05  3.63331273e+07  1.92e+02 4.92e-01  2.91e+02     6s
   7  -3.54416009e+05  2.59886947e+07  6.50e+01 3.40e-02  1.65e+02     6s
   8  -2.44355967e+05  1.72463399e+07  2.26e+01 2.14e-02  9.76e+01     6s
   9  -1.31903782e+05  7.14375881e+06  4.65e+00 8.18e-03  3.78e+01     6s
  10  -8.44204941e+04  3.40321457e+06  2.72e+00 3.76e-03  1.80e+01     6s
  11  -6.03440715e+04  2.41082433e+06  1.84e+00 2.61e-03  1.27e+01     6s
  12  -2.17257014e+04  1.59365510e+06  7.04e-01 1.63e-03  8.23e+00     6s
  13  -1.10380670e+04  7.09544709e+05  4.94e-01 6.16e-04  3.67e+00     7s
  14   5.32802483e+03  2.59980891e+05  2.20e-01 2.65e-04  1.29e+00     7s
  15   1.19732241e+04  1.88558056e+05  1.73e-01 2.37e-04  8.97e-01     7s
  16   2.00534428e+04  1.34357493e+05  1.31e-01 2.69e-04  5.80e-01     7s
  17   2.60049411e+04  1.20596955e+05  1.08e-01 5.11e-04  4.80e-01     7s
  18   3.12544774e+04  1.05360121e+05  8.87e-02 4.19e-04  3.76e-01     7s
  19   4.04690553e+04  9.25945722e+04  5.56e-02 2.74e-04  2.65e-01     7s
  20   4.36274132e+04  8.35932829e+04  4.61e-02 4.55e-04  2.03e-01     7s
  21   4.80192426e+04  7.72932253e+04  3.32e-02 1.14e-03  1.49e-01     7s
  22   4.90046766e+04  7.60406865e+04  3.05e-02 1.22e-03  1.37e-01     7s
  23   5.17621947e+04  7.21510205e+04  2.27e-02 1.16e-03  1.03e-01     8s
  24   5.36337545e+04  6.98117126e+04  1.77e-02 9.53e-04  8.21e-02     8s
  25   5.43148835e+04  6.75297688e+04  1.58e-02 1.14e-03  6.71e-02     8s
  26   5.54878105e+04  6.59658770e+04  1.28e-02 8.87e-04  5.32e-02     8s
  27   5.65010325e+04  6.50444737e+04  1.00e-02 7.36e-04  4.33e-02     8s
  28   5.74122816e+04  6.39933641e+04  7.70e-03 5.57e-04  3.34e-02     8s
  29   5.78994774e+04  6.36600191e+04  6.50e-03 5.00e-04  2.92e-02     8s
  30   5.84501760e+04  6.33456660e+04  5.21e-03 4.51e-04  2.48e-02     8s
  31   5.91467155e+04  6.29189164e+04  3.52e-03 3.77e-04  1.91e-02     9s
  32   5.95165147e+04  6.21250349e+04  2.65e-03 2.27e-04  1.32e-02     9s
  33   5.98619752e+04  6.15466045e+04  1.90e-03 1.26e-04  8.55e-03     9s
  34   5.99650485e+04  6.14165922e+04  1.69e-03 1.03e-04  7.36e-03     9s
  35   6.03015916e+04  6.12407425e+04  9.74e-04 7.25e-05  4.76e-03     9s
  36   6.04492501e+04  6.11659070e+04  6.70e-04 5.97e-05  3.64e-03     9s
  37   6.05943536e+04  6.10181739e+04  3.85e-04 3.54e-05  2.15e-03     9s
  38   6.07066856e+04  6.09010690e+04  1.70e-04 5.03e-05  9.86e-04     9s
  39   6.07477886e+04  6.08682621e+04  9.24e-05 3.30e-05  6.11e-04    10s
  40   6.07642573e+04  6.08380035e+04  6.46e-05 1.70e-05  3.74e-04    10s
  41   6.07706676e+04  6.08303607e+04  5.46e-05 1.28e-05  3.03e-04    10s
  42   6.07862704e+04  6.08205206e+04  2.94e-05 7.55e-06  1.74e-04    10s
  43   6.07942238e+04  6.08116819e+04  1.69e-05 2.91e-06  8.85e-05    10s
  44   6.07978061e+04  6.08060990e+04  1.16e-05 9.30e-07  4.21e-05    10s
  45   6.08056984e+04  6.08059349e+04  4.12e-07 2.23e-06  1.20e-06    10s
  46   6.08058450e+04  6.08058477e+04  1.47e-08 3.17e-08  1.36e-08    11s
  47   6.08058453e+04  6.08058474e+04  1.38e-07 3.48e-07  1.04e-08    11s
  48   6.08058454e+04  6.08058471e+04  2.70e-07 2.56e-07  8.32e-09    11s
  49   6.08058465e+04  6.08058465e+04  1.27e-07 6.28e-08  7.10e-11    11s

Barrier solved model in 49 iterations and 11.06 seconds (9.45 work units)
Optimal objective 6.08058465e+04


Root crossover log...

   92951 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    2102 PPushes remaining with PInf 6.1315227e-06                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4505245e-01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37875    6.0805846e+04   0.000000e+00   2.450524e-01     14s
   37878    6.0805846e+04   0.000000e+00   0.000000e+00     14s
   37878    6.0805846e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 6.080585e+04, 37878 iterations, 10.18 seconds (11.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 60805.8465    0  263 -239613.87 60805.8465   125%     -   15s
H    0     0                    -223206.8827 60805.8465   127%     -   15s
H    0     0                    -167331.8085 60805.8465   136%     -   15s
H    0     0                    -165866.2103 60805.8465   137%     -   15s
H    0     0                    -153553.5310 60805.8465   140%     -   15s
H    0     0                    -153248.2014 60805.8465   140%     -   15s
H    0     0                    -56044.06927 60805.8465   208%     -   15s
H    0     0                    -55778.91531 60805.8465   209%     -   16s
H    0     0                    -55543.94983 60805.8465   209%     -   16s
H    0     0                    -40485.43375 60805.8465   250%     -   16s
H    0     0                    -40250.46826 60805.8465   251%     -   16s
H    0     0                    -27595.35895 60805.8465   320%     -   16s
H    0     0                    -25070.28175 60805.8465   343%     -   16s
H    0     0                    -24820.50248 60805.8465   345%     -   16s
H    0     0                    -24340.86769 60805.8465   350%     -   16s
H    0     0                    -13283.10663 60805.8465   558%     -   18s
H    0     0                    -9129.443126 60805.8465   766%     -   18s
H    0     0                    -8994.010376 60805.8465   776%     -   18s
H    0     0                    -8974.448068 60805.8465   778%     -   18s
H    0     0                    -8954.909527 60805.8465   779%     -   18s
H    0     0                    -8915.680176 60805.8465   782%     -   18s
H    0     0                    7643.9642126 53121.1399   595%     -   68s
H    0     0                    10444.304671 53121.1399   409%     -   68s
H    0     0                    10503.025136 53121.1399   406%     -   68s
H    0     0                    10572.714227 53121.1399   402%     -   68s
H    0     0                    10610.371831 53121.1399   401%     -   68s
H    0     0                    10827.659786 53121.1399   391%     -   68s
H    0     0                    10865.317390 53121.1399   389%     -   68s
H    0     0                    10892.753983 53121.1399   388%     -   68s
H    0     0                    10930.411587 53121.1399   386%     -   68s
     0     0 53121.1399    0  340 10930.4116 53121.1399   386%     -   68s
H    0     0                    12570.265324 53120.8813   323%     -   70s
H    0     0                    12668.215879 53120.8813   319%     -   70s
     0     0 52475.3591    0  309 12668.2159 52475.3591   314%     -  107s
     0     0 52121.4839    0  372 12668.2159 52121.4839   311%     -  139s
     0     0 51957.5504    0  419 12668.2159 51957.5504   310%     -  169s
     0     0 51957.5504    0  374 12668.2159 51957.5504   310%     -  175s
     0     0 51957.5504    0  373 12668.2159 51957.5504   310%     -  180s
     0     0 51957.5504    0  382 12668.2159 51957.5504   310%     -  184s
     0     0 51957.5504    0  379 12668.2159 51957.5504   310%     -  193s
     0     0 51957.5504    0  422 12668.2159 51957.5504   310%     -  198s
     0     0 51957.5504    0  424 12668.2159 51957.5504   310%     -  201s
     0     0 51957.5504    0  424 12668.2159 51957.5504   310%     -  201s
     0     0 48672.6857    0  331 12668.2159 48672.6857   284%     -  264s
H    0     0                    16211.655100 48669.3461   200%     -  265s
H    0     0                    16577.265959 48669.3461   194%     -  265s
H    0     0                    16711.501078 48669.3461   191%     -  265s
H    0     0                    17960.270218 48669.3461   171%     -  265s
H    0     0                    18260.470820 48669.3461   167%     -  265s
H    0     0                    18345.265632 48669.3461   165%     -  265s
H    0     0                    18829.265110 48669.3461   158%     -  265s
H    0     0                    18914.059922 48669.3461   157%     -  265s
H    0     0                    18927.215665 48669.3461   157%     -  265s
     0     0 48201.3875    0  345 18927.2157 48201.3875   155%     -  298s
     0     0 48082.8304    0  392 18927.2157 48082.8304   154%     -  314s
     0     0 48004.4113    0  407 18927.2157 48004.4113   154%     -  325s
     0     0 47905.1281    0  406 18927.2157 47905.1281   153%     -  348s
     0     0 47511.8078    0  408 18927.2157 47511.8078   151%     -  371s
     0     0 47360.5679    0  390 18927.2157 47360.5679   150%     -  395s
     0     0 47336.1753    0  398 18927.2157 47336.1753   150%     -  402s
     0     0 47282.3260    0  394 18927.2157 47282.3260   150%     -  412s
     0     0 47263.9871    0  398 18927.2157 47263.9871   150%     -  419s
     0     0 47152.2983    0  381 18927.2157 47152.2983   149%     -  430s
     0     0 47130.9443    0  387 18927.2157 47130.9443   149%     -  441s
     0     0 47117.8567    0  390 18927.2157 47117.8567   149%     -  448s
     0     0 47102.7130    0  357 18927.2157 47102.7130   149%     -  457s
     0     0 47099.3755    0  353 18927.2157 47099.3755   149%     -  460s
     0     0 47088.7554    0  414 18927.2157 47088.7554   149%     -  466s
     0     0 47084.9360    0  412 18927.2157 47084.9360   149%     -  470s
     0     0 47082.5177    0  411 18927.2157 47082.5177   149%     -  472s
     0     0 47071.3489    0  355 18927.2157 47071.3489   149%     -  478s
     0     0 47063.2308    0  411 18927.2157 47063.2308   149%     -  482s
     0     0 47061.4788    0  402 18927.2157 47061.4788   149%     -  485s
     0     0 47041.5265    0  413 18927.2157 47041.5265   149%     -  491s
     0     0 47035.3126    0  412 18927.2157 47035.3126   149%     -  495s
     0     0 47034.2116    0  412 18927.2157 47034.2116   149%     -  497s
     0     0 45244.6772    0  368 18927.2157 45244.6772   139%     -  583s
H    0     0                    19262.269818 45244.6331   135%     -  584s
H    0     0                    19806.969882 45244.6331   128%     -  584s
     0     0 44478.7376    0  394 19806.9699 44478.7376   125%     -  638s
     0     0 44254.3999    0  391 19806.9699 44254.3999   123%     -  663s
H    0     0                    19978.595433 44114.8785   121%     -  681s
H    0     0                    20001.385580 44114.8785   121%     -  681s
H    0     0                    20255.109843 44114.8785   118%     -  681s
H    0     0                    20348.421773 44114.8785   117%     -  681s
     0     0 44114.8785    0  396 20348.4218 44114.8785   117%     -  681s
     0     0 44058.3670    0  396 20348.4218 44058.3670   117%     -  696s
H    0     0                    20488.392146 43973.3188   115%     -  713s
     0     0 43973.3188    0  456 20488.3921 43973.3188   115%     -  713s
     0     0 43958.1635    0  411 20488.3921 43958.1635   115%     -  717s
     0     0 43944.3391    0  460 20488.3921 43944.3391   114%     -  722s
     0     0 43942.4548    0  459 20488.3921 43942.4548   114%     -  725s
     0     0 43473.9366    0  443 20488.3921 43473.9366   112%     -  763s
     0     0 43302.2898    0  381 20488.3921 43302.2898   111%     -  791s
     0     0 43205.1692    0  381 20488.3921 43205.1692   111%     -  809s
H    0     0                    20651.990697 43168.0650   109%     -  820s
H    0     0                    20688.208603 43168.0650   109%     -  820s
H    0     0                    20725.855576 43168.0650   108%     -  820s
H    0     0                    20731.850631 43168.0650   108%     -  820s
H    0     0                    20769.497604 43168.0650   108%     -  820s
H    0     0                    20835.367243 43168.0650   107%     -  820s
     0     0 43168.0650    0  387 20835.3672 43168.0650   107%     -  820s
     0     0 43156.6735    0  396 20835.3672 43156.6735   107%     -  826s
     0     0 43155.2456    0  393 20835.3672 43155.2456   107%     -  829s
     0     0 43004.7786    0  523 20835.3672 43004.7786   106%     -  857s
H    0     0                    21043.484339 43004.7471   104%     -  858s
     0     0 42943.5327    0  545 21043.4843 42943.5327   104%     -  878s
     0     0 42929.4959    0  549 21043.4843 42929.4959   104%     -  888s
     0     0 42908.5281    0  541 21043.4843 42908.5281   104%     -  901s
     0     0 42906.9044    0  535 21043.4843 42906.9044   104%     -  903s
     0     0 42847.8625    0  437 21043.4843 42847.8625   104%     -  924s
     0     0 42830.9559    0  497 21043.4843 42830.9559   104%     -  935s
     0     0 42804.8441    0  511 21043.4843 42804.8441   103%     -  945s
     0     0 42792.1615    0  504 21043.4843 42792.1615   103%     -  953s
     0     0 42789.1166    0  496 21043.4843 42789.1166   103%     -  956s
     0     0 42788.0338    0  494 21043.4843 42788.0338   103%     -  958s
     0     0 42723.9369    0  350 21043.4843 42723.9369   103%     -  978s
H    0     0                    21158.150500 42723.7849   102%     -  979s
     0     0 42687.6101    0  477 21158.1505 42687.6101   102%     -  994s
     0     0 42667.9448    0  524 21158.1505 42667.9448   102%     - 1008s
     0     0 42659.2413    0  481 21158.1505 42659.2413   102%     - 1018s
H    0     0                    21165.553847 42638.3878   101%     - 1023s
H    0     0                    21801.056442 42638.3878  95.6%     - 1023s
H    0     0                    21809.301449 42638.3878  95.5%     - 1024s
H    0     0                    21915.900276 42638.3878  94.6%     - 1024s
     0     0 42638.3878    0  487 21915.9003 42638.3878  94.6%     - 1024s
     0     0 42614.3005    0  468 21915.9003 42614.3005  94.4%     - 1029s
     0     0 42610.4376    0  475 21915.9003 42610.4376  94.4%     - 1033s
     0     0 42609.6656    0  464 21915.9003 42609.6656  94.4%     - 1034s
     0     0 42540.9892    0  468 21915.9003 42540.9892  94.1%     - 1048s
     0     0 42530.3820    0  479 21915.9003 42530.3820  94.1%     - 1056s
     0     0 42527.0603    0  479 21915.9003 42527.0603  94.0%     - 1061s
     0     0 42523.8027    0  474 21915.9003 42523.8027  94.0%     - 1066s
     0     0 42522.4663    0  415 21915.9003 42522.4663  94.0%     - 1068s
     0     0 42495.2687    0  489 21915.9003 42495.2687  93.9%     - 1079s
H    0     0                    21916.842936 42493.4949  93.9%     - 1080s
H    0     0                    21998.026126 42493.4949  93.2%     - 1080s
H    0     0                    22016.442282 42493.4949  93.0%     - 1080s
H    0     0                    22038.517178 42493.4949  92.8%     - 1080s
     0     0 42482.5258    0  479 22038.5172 42482.5258  92.8%     - 1085s
     0     0 42481.3151    0  484 22038.5172 42481.3151  92.8%     - 1088s
     0     0 42475.9411    0  503 22038.5172 42475.9411  92.7%     - 1093s
H    0     0                    22064.321874 42475.8781  92.5%     - 1094s
     0     0 42473.0455    0  450 22064.3219 42473.0455  92.5%     - 1097s
     0     0 42470.8796    0  444 22064.3219 42470.8796  92.5%     - 1100s
     0     0 42467.0320    0  433 22064.3219 42467.0320  92.5%     - 1106s
     0     0 42465.5405    0  425 22064.3219 42465.5405  92.5%     - 1108s
     0     0 42448.1331    0  448 22064.3219 42448.1331  92.4%     - 1117s
     0     0 42447.4437    0  448 22064.3219 42447.4437  92.4%     - 1123s
H    0     0                    22371.521095 42447.2468  89.7%     - 1188s
H    0     0                    22374.235140 42447.2468  89.7%     - 1189s
H    0     0                    22374.525680 42447.2468  89.7%     - 1189s
H    0     0                    22385.875846 42447.2468  89.6%     - 1265s
H    0     0                    22619.742051 42447.2468  87.7%     - 1271s
H    0     0                    23219.453508 42447.2468  82.8%     - 1272s
H    0     0                    23304.248320 42447.2468  82.1%     - 1273s
H    0     2                    23734.159738 42447.2468  78.8%     - 1281s
     0     2 42447.2468    0  448 23734.1597 42447.2468  78.8%     - 1281s
     1     3 42136.0557    1  471 23734.1597 42447.0106  78.8% 11271 1304s
     2     6 41889.3787    2  491 23734.1597 42447.0106  78.8% 12104 1328s
     5    11 41734.5459    3  353 23734.1597 42225.2524  77.9%  9188 1370s
    10    22 41746.1746    3  415 23734.1597 41909.7596  76.6% 12063 1401s
    21    33 41181.3248    4  410 23734.1597 41783.3974  76.0% 15024 1462s
H   32    63                    23849.491648 41783.3974  75.2% 17935 1627s
    62    95 39717.3137    6  363 23849.4916 41563.1768  74.3% 23722 1673s
H   94   127                    23870.585829 41473.6113  73.7% 19872 1712s
H  103   127                    23887.787101 41473.6113  73.6% 18872 1712s
   126   195 39706.0578    8  371 23887.7871 41470.5067  73.6% 17656 1780s
H  194   280                    23961.866807 41470.5067  73.1% 14026 1836s
H  197   280                    24038.385146 41470.5067  72.5% 13901 1836s
   279   363 38551.2266   14  351 24038.3851 41470.5067  72.5% 11698 1881s
   362   439 38048.2554   18  345 24038.3851 41470.5067  72.5% 10388 1919s
H  390   439                    24055.608262 41470.5067  72.4%  9910 1919s
   438   519 37689.7019   23  333 24055.6083 41470.5067  72.4%  9580 1954s
   518   590 35486.7991   28  203 24055.6083 41470.5067  72.4%  8894 1980s
   589   664 35460.9633   29  208 24055.6083 41470.5067  72.4%  8526 2003s
   669   742 35290.2974   32  178 24055.6083 41470.5067  72.4%  8289 2025s
   751   794 34022.3101   37  130 24055.6083 41470.5067  72.4%  8047 2092s
   807   824 33842.2417   39  122 24055.6083 41461.4172  72.4%  8041 2144s
   837   864 33836.6479   40  120 24055.6083 41461.4172  72.4%  8074 2210s
   877   909 33820.8785   41  120 24055.6083 41461.4172  72.4%  8102 2236s
   922   958 33781.1379   42  116 24055.6083 41461.4172  72.4%  8101 2258s
   979  1017 33764.6025   43  122 24055.6083 41461.4172  72.4%  7986 2282s
  1042  1074 27454.4352   44  115 24055.6083 41461.4172  72.4%  7836 2304s
  1103  1129 27415.6753   45  119 24055.6083 41461.4172  72.4%  7692 2328s
  1167  1176 27402.0523   46  112 24055.6083 41461.4172  72.4%  7518 2353s
  1231  1212 27267.4403   47   76 24055.6083 41461.4172  72.4%  7487 2384s
  1290  1255 27228.0687   48   87 24055.6083 41446.8819  72.3%  7443 2419s
  1355  1321 27225.7541   49   67 24055.6083 41446.8819  72.3%  7504 2456s
  1437  1355 26672.2085   58   50 24055.6083 41446.8819  72.3%  7402 2496s
  1487  1407 26656.7151   59   54 24055.6083 41446.8819  72.3%  7424 2535s
  1553  1463 26629.0974   60   47 24055.6083 41446.8819  72.3%  7397 2571s
  1623  1510 infeasible   65      24055.6083 41446.8819  72.3%  7332 2608s
  1715  1576 35192.8634    6  352 24055.6083 41269.7704  71.6%  7196 2646s
  1815  1636 35079.6262    7  367 24055.6083 41269.7704  71.6%  7140 2688s
  1895  1700 34678.0251    9  369 24055.6083 41269.7704  71.6%  7166 2729s
  1985  1778 32322.5343   10  197 24055.6083 41269.7704  71.6%  7168 2777s
  2098  1874 29425.3692   13  195 24055.6083 41269.7704  71.6%  7104 2823s
  2222  2025 infeasible   14      24055.6083 41196.6521  71.3%  7077 2869s
  2399  2159 26989.6019   15  143 24055.6083 41196.6521  71.3%  6949 2916s
  2583  2303     cutoff   17      24055.6083 41196.6521  71.3%  6800 2967s
  2767  2455 25611.2462   18  178 24055.6083 41196.6521  71.3%  6701 3022s
  2992  2565 24695.0172   25  172 24055.6083 41196.6521  71.3%  6584 3085s
  3170  2698 40273.0993    9  436 24055.6083 41196.6521  71.3%  6559 3140s
  3339  2861 34020.4114   10  401 24055.6083 41196.6521  71.3%  6615 3197s
  3566  2862 38572.1613   17  448 24055.6083 41196.6521  71.3%  6579 3403s
  3568  2863 37330.3034   42  134 24055.6083 41196.6521  71.3%  6575 3433s
  3569  2864 24261.0454   56  330 24055.6083 41196.6521  71.3%  6573 3562s

Cutting planes:
  Gomory: 4
  Implied bound: 11
  MIR: 199
  Flow cover: 596
  RLT: 12
  Relax-and-lift: 56

Explored 3569 nodes (24264428 simplex iterations) in 3600.05 seconds (5594.23 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 24055.6 24038.4 23961.9 ... 22619.7

Time limit reached
Best objective 2.405560826164e+04, best bound 4.119665211683e+04, gap 71.2559%
  WARNING: Time limit reached. Using best solution found (gap: 71.26%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 24055.61, θ = 179231.34
  Upper Bound (UB) = 24055.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179231.34
  [DEBUG]   ✓ Scenario 0: θ = 179231.34 ≤ Q = 179231.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179231.34 ≤ Q = 179231.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 179231.34 ≤ Q = 179231.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 179231.34 ≤ Q = 179231.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 179231.34 ≤ Q = 179231.34 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x15d76da3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x15d76da3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.431972e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6842379.8019
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.596252e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159625.18    0  124 6842379.80 -159625.18   102%     -    0s
H    0     0                    -124544.9110 -159625.18  28.2%     -    0s
H    0     0                    -124808.1635 -159625.18  27.9%     -    0s
     0     0 -134171.38    0   99 -124808.16 -134171.38  7.50%     -    0s
H    0     0                    -129818.6907 -134043.17  3.25%     -    0s
     0     0 -133073.23    0   96 -129818.69 -133073.23  2.51%     -    0s
H    0     0                    -131445.7003 -133053.89  1.22%     -    0s
     0     0 -133025.83    0   96 -131445.70 -133025.83  1.20%     -    0s
     0     0 -133025.83    0   96 -131445.70 -133025.83  1.20%     -    0s
H    0     0                    -131464.2501 -133025.83  1.19%     -    0s
H    0     0                    -131467.8476 -132727.62  0.96%     -    0s
     0     0 -132727.62    0   64 -131467.85 -132727.62  0.96%     -    0s
H    0     0                    -132072.4478 -132718.16  0.49%     -    0s
     0     0 -132718.16    0   64 -132072.45 -132718.16  0.49%     -    0s
     0     0 -132657.06    0   62 -132072.45 -132657.06  0.44%     -    0s
     0     0 -132645.46    0   62 -132072.45 -132645.46  0.43%     -    0s
H    0     0                    -132108.4221 -132623.45  0.39%     -    0s
     0     2 -132623.45    0   62 -132108.42 -132623.45  0.39%     -    0s
H  114    16                    -132114.2255 -132301.12  0.14%   8.5    0s

Cutting planes:
  Gomory: 40
  Implied bound: 2
  MIR: 179
  Flow cover: 13
  RLT: 1

Explored 221 nodes (2021 simplex iterations) in 0.25 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -132114 -132108 -132072 ... 6.84238e+06
No other solutions better than -132114

Optimal solution found (tolerance 1.00e-06)
Best objective -1.321142255171e+05, best bound -1.321142255171e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 175936.84
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132114.23
  [DEBUG]   S×d_nominal = 308051.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308051.07 + -132114.23 = 175936.84
  [DEBUG]   Current θ from Master = 179231.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3294.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20761.12
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = 721.4415, Absolute Gap = 721.4415, Relative Gap = 0.029991
  Not converged yet (gap = 721.44 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x131752b3
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 99440 rows and 40410 columns
Presolve time: 4.75s
Presolved: 116003 rows, 49210 columns, 700079 nonzeros
Variable types: 46951 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -343158.0855
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.40s

Barrier statistics:
 Dense cols : 623
 AA' NZ     : 4.467e+06
 Factor NZ  : 1.078e+07 (roughly 150 MB of memory)
 Factor Ops : 2.219e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.98291389e+07  2.23144247e+08  1.29e+05 1.62e+01  8.79e+04     7s
   1  -1.52111504e+07  2.00837193e+08  9.03e+04 9.32e+01  6.06e+04     8s
   2  -5.31469139e+06  1.51297102e+08  3.13e+04 7.91e-01  2.22e+04     8s
   3  -1.19783320e+06  1.10981747e+08  4.01e+03 1.72e+00  3.22e+03     8s
   4  -5.64516306e+05  5.90048437e+07  5.77e+02 4.20e-01  6.33e+02     8s
   5  -4.61967945e+05  3.38602780e+07  3.06e+02 1.87e-01  3.29e+02     8s
   6  -3.40660378e+05  2.58986797e+07  9.26e+01 1.32e-01  1.71e+02     8s
   7  -2.77293569e+05  1.87660013e+07  5.36e+01 9.08e-02  1.13e+02     8s
   8  -1.56715210e+05  1.36737724e+07  1.75e+01 6.27e-02  7.15e+01     8s
   9  -9.93709988e+04  7.36176688e+06  8.52e+00 3.17e-02  3.71e+01     9s
  10  -7.70851597e+04  3.30246286e+06  5.03e+00 1.35e-02  1.65e+01     9s
  11  -3.98928766e+04  1.99844867e+06  1.97e+00 7.87e-03  9.75e+00     9s
  12  -1.47862360e+04  8.17427547e+05  1.14e+00 3.09e-03  3.96e+00     9s
  13  -8.65438738e+03  5.39705153e+05  8.74e-01 2.07e-03  2.60e+00     9s
  14   4.08438767e+03  2.33122029e+05  5.01e-01 1.07e-03  1.08e+00     9s
  15   1.11059074e+04  1.83714489e+05  3.79e-01 1.21e-03  8.17e-01     9s
  16   1.99640978e+04  1.31789711e+05  2.83e-01 2.26e-03  5.29e-01     9s
  17   2.52158073e+04  1.16844802e+05  2.39e-01 2.43e-03  4.33e-01     9s
  18   3.07093333e+04  1.04331192e+05  1.96e-01 2.29e-03  3.48e-01    10s
  19   3.73036983e+04  8.98547751e+04  1.48e-01 2.74e-03  2.49e-01    10s
  20   4.13540723e+04  8.19567916e+04  1.21e-01 1.89e-03  1.92e-01    10s
  21   4.40325123e+04  7.74918704e+04  1.03e-01 1.66e-03  1.58e-01    10s
  22   4.68625250e+04  7.50297136e+04  8.51e-02 1.43e-03  1.33e-01    10s
  23   4.91606196e+04  7.05441078e+04  7.06e-02 1.73e-03  1.01e-01    10s
  24   5.22704212e+04  6.84050048e+04  5.07e-02 1.10e-03  7.63e-02    10s
  25   5.43336829e+04  6.67753238e+04  3.79e-02 1.16e-03  5.88e-02    11s
  26   5.47977562e+04  6.63903721e+04  3.50e-02 1.20e-03  5.48e-02    11s
  27   5.62630129e+04  6.49868649e+04  2.58e-02 9.17e-04  4.12e-02    11s
  28   5.70447791e+04  6.43361647e+04  2.10e-02 9.29e-04  3.45e-02    11s
  29   5.72756042e+04  6.29569843e+04  1.97e-02 7.39e-04  2.69e-02    11s
  30   5.77227534e+04  6.27537037e+04  1.73e-02 6.57e-04  2.38e-02    11s
  31   5.91162621e+04  6.21130075e+04  9.61e-03 4.71e-04  1.42e-02    11s
  32   5.94748119e+04  6.17706901e+04  7.69e-03 3.74e-04  1.09e-02    12s
  33   5.96501753e+04  6.15250514e+04  6.80e-03 2.84e-04  8.87e-03    12s
  34   6.01471694e+04  6.13302207e+04  4.26e-03 2.51e-04  5.60e-03    12s
  35   6.02227643e+04  6.12858670e+04  3.87e-03 2.61e-04  5.03e-03    12s
  36   6.04436622e+04  6.12203374e+04  2.73e-03 2.34e-04  3.67e-03    12s
  37   6.06074787e+04  6.11209127e+04  1.91e-03 2.13e-04  2.43e-03    12s
  38   6.06988081e+04  6.11122818e+04  1.43e-03 2.08e-04  1.96e-03    13s
  39   6.08231541e+04  6.10607747e+04  7.94e-04 1.31e-04  1.12e-03    13s
  40   6.08591236e+04  6.10126881e+04  6.08e-04 1.11e-04  7.27e-04    13s
  41   6.09660393e+04  6.10046147e+04  9.08e-05 7.21e-05  1.82e-04    13s
  42   6.09800500e+04  6.09897530e+04  3.11e-05 9.11e-06  4.59e-05    13s
  43   6.09874059e+04  6.09887287e+04  2.24e-06 3.56e-06  6.25e-06    13s
  44   6.09880244e+04  6.09880324e+04  1.57e-08 8.66e-08  3.80e-08    13s
  45   6.09880307e+04  6.09880308e+04  3.81e-08 1.45e-10  6.22e-10    14s

Barrier solved model in 45 iterations and 13.60 seconds (9.67 work units)
Optimal objective 6.09880307e+04


Root crossover log...

   99656 DPushes remaining with DInf 0.0000000e+00                14s
   24497 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    6558 PPushes remaining with PInf 5.9209759e-05                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.9542990e+02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   49916    6.0988031e+04   0.000000e+00   5.954299e+02     17s
   49960    6.0988031e+04   0.000000e+00   0.000000e+00     17s
   49960    6.0988031e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 6.098803e+04, 49960 iterations, 11.31 seconds (11.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 60988.0308    0  258 -239613.87 60988.0308   125%     -   18s
H    0     0                    -178661.1731 60988.0308   134%     -   19s
H    0     0                    -178078.1444 60988.0308   134%     -   19s
H    0     0                    -177910.9268 60988.0308   134%     -   19s
H    0     0                    -144919.3508 60988.0308   142%     -   19s
H    0     0                    -144752.1331 60988.0308   142%     -   19s
H    0     0                    -143803.0326 60988.0308   142%     -   19s
H    0     0                    -142918.3336 60988.0308   143%     -   19s
H    0     0                    -61745.58118 60988.0308   199%     -   19s
H    0     0                    -61711.56951 60988.0308   199%     -   19s
H    0     0                    -61670.93713 60988.0308   199%     -   20s
H    0     0                    -37116.35057 60988.0308   264%     -   20s
H    0     0                    -36385.89103 60988.0308   268%     -   20s
H    0     0                    -28845.35846 60988.0308   311%     -   20s
H    0     0                    -28086.57749 60988.0308   317%     -   20s
H    0     0                    -28033.83494 60988.0308   318%     -   20s
H    0     0                    -27896.91507 60988.0308   319%     -   20s
H    0     0                    -27552.19085 60988.0308   321%     -   20s
H    0     0                    3177.9494738 60988.0308  1819%     -   22s
H    0     0                    3738.2369313 60988.0308  1531%     -   22s
H    0     0                    3778.3348818 60988.0308  1514%     -   22s
     0     0 54123.2974    0  359 3778.33488 54123.2974  1332%     -   61s
H    0     0                    3789.0329543 54123.2974  1328%     -   62s
     0     0 53147.8073    0  332 3789.03295 53147.8073  1303%     -   91s
     0     0 52884.3364    0  328 3789.03295 52884.3364  1296%     -   97s
     0     0 52874.3804    0  319 3789.03295 52874.3804  1295%     -  104s
     0     0 52874.3804    0  322 3789.03295 52874.3804  1295%     -  106s
     0     0 52718.4991    0  327 3789.03295 52718.4991  1291%     -  122s
     0     0 52718.4991    0  325 3789.03295 52718.4991  1291%     -  125s
     0     0 52718.4991    0  338 3789.03295 52718.4991  1291%     -  132s
     0     0 52718.4991    0  331 3789.03295 52718.4991  1291%     -  134s
     0     0 52718.4991    0  331 3789.03295 52718.4991  1291%     -  135s
     0     0 48749.8246    0  422 3789.03295 48749.8246  1187%     -  202s
H    0     0                    7523.3599470 48749.6512   548%     -  202s
H    0     0                    7625.7611888 48749.6512   539%     -  202s
     0     0 48494.5889    0  433 7625.76119 48494.5889   536%     -  227s
     0     0 48266.2041    0  456 7625.76119 48266.2041   533%     -  249s
     0     0 48149.6539    0  444 7625.76119 48149.6539   531%     -  263s
     0     0 47963.3475    0  436 7625.76119 47963.3475   529%     -  279s
     0     0 47902.0036    0  452 7625.76119 47902.0036   528%     -  293s
     0     0 47874.0614    0  451 7625.76119 47874.0614   528%     -  300s
     0     0 47839.3815    0  451 7625.76119 47839.3815   527%     -  308s
     0     0 47820.3209    0  457 7625.76119 47820.3209   527%     -  315s
     0     0 47819.6842    0  453 7625.76119 47819.6842   527%     -  316s
H    0     0                    9282.1424374 45255.2452   388%     -  405s
H    0     0                    9315.8220700 45255.2452   386%     -  405s
H    0     0                    9679.8929756 45255.2452   368%     -  405s
H    0     0                    9977.5177356 45255.2452   354%     -  405s
H    0     0                    10190.616389 45255.2452   344%     -  405s
H    0     0                    10206.148735 45255.2452   343%     -  405s
H    0     0                    10418.023476 45255.2452   334%     -  405s
     0     0 45255.2452    0  394 10418.0235 45255.2452   334%     -  405s
H    0     0                    10438.182743 45254.9681   334%     -  406s
H    0     0                    10723.703345 44746.5489   317%     -  449s
H    0     0                    10784.873356 44746.5489   315%     -  449s
H    0     0                    10826.704297 44746.5489   313%     -  449s
H    0     0                    10953.025164 44746.5489   309%     -  449s
H    0     0                    10979.328787 44746.5489   308%     -  449s
H    0     0                    11056.026115 44746.5489   305%     -  449s
H    0     0                    11070.038792 44746.5489   304%     -  449s
H    0     0                    11430.257336 44746.5489   291%     -  449s
H    0     0                    11533.258287 44746.5489   288%     -  449s
H    0     0                    12136.206114 44746.5489   269%     -  449s
H    0     0                    12598.145564 44746.5489   255%     -  449s
H    0     0                    12644.382741 44746.5489   254%     -  449s
H    0     0                    12671.003177 44746.5489   253%     -  449s
H    0     0                    15177.366183 44746.5489   195%     -  449s
H    0     0                    15219.667699 44746.5489   194%     -  449s
H    0     0                    15579.684481 44746.5489   187%     -  449s
H    0     0                    15599.822040 44746.5489   187%     -  449s
H    0     0                    15626.126463 44746.5489   186%     -  449s
H    0     0                    16244.371153 44746.5489   175%     -  449s
H    0     0                    19444.523964 44746.5489   130%     -  449s
H    0     0                    19994.467499 44746.5489   124%     -  449s
H    0     0                    20003.808505 44746.5489   124%     -  449s
H    0     0                    20205.078224 44746.5489   121%     -  449s
     0     0 44746.5489    0  423 20205.0782 44746.5489   121%     -  449s
     0     0 44552.5559    0  414 20205.0782 44552.5559   121%     -  476s
     0     0 44439.5297    0  375 20205.0782 44439.5297   120%     -  489s
     0     0 44367.6061    0  380 20205.0782 44367.6061   120%     -  500s
     0     0 44277.3488    0  366 20205.0782 44277.3488   119%     -  513s
     0     0 44235.6049    0  370 20205.0782 44235.6049   119%     -  523s
     0     0 44205.8234    0  370 20205.0782 44205.8234   119%     -  535s
     0     0 44145.5084    0  373 20205.0782 44145.5084   118%     -  555s
     0     0 44118.2511    0  381 20205.0782 44118.2511   118%     -  564s
     0     0 44112.9313    0  380 20205.0782 44112.9313   118%     -  571s
     0     0 44101.9800    0  385 20205.0782 44101.9800   118%     -  578s
     0     0 44071.1406    0  376 20205.0782 44071.1406   118%     -  588s
     0     0 44064.6008    0  375 20205.0782 44064.6008   118%     -  593s
     0     0 44056.2148    0  377 20205.0782 44056.2148   118%     -  599s
     0     0 44037.8908    0  386 20205.0782 44037.8908   118%     -  607s
     0     0 44036.5403    0  392 20205.0782 44036.5403   118%     -  610s
H    0     0                    20292.687385 43329.5299   114%     -  654s
H    0     0                    21146.690305 43329.5299   105%     -  654s
H    0     0                    21255.544453 43329.5299   104%     -  654s
H    0     0                    22088.728592 43329.5299  96.2%     -  654s
     0     0 43329.5299    0  417 22088.7286 43329.5299  96.2%     -  654s
     0     0 43102.7523    0  454 22088.7286 43102.7523  95.1%     -  684s
     0     0 43000.2155    0  415 22088.7286 43000.2155  94.7%     -  711s
     0     0 42972.1688    0  489 22088.7286 42972.1688  94.5%     -  723s
     0     0 42912.7602    0  445 22088.7286 42912.7602  94.3%     -  740s
H    0     0                    22091.442636 42893.1082  94.2%     -  754s
     0     0 42893.1082    0  428 22091.4426 42893.1082  94.2%     -  754s
     0     0 42863.0253    0  498 22091.4426 42863.0253  94.0%     -  765s
     0     0 42845.0799    0  493 22091.4426 42845.0799  93.9%     -  777s
     0     0 42832.1860    0  430 22091.4426 42832.1860  93.9%     -  782s
     0     0 42829.6742    0  438 22091.4426 42829.6742  93.9%     -  785s
     0     0 42719.8960    0  484 22091.4426 42719.8960  93.4%     -  809s
H    0     0                    22522.992881 42719.8903  89.7%     -  810s
H    0     0                    22544.659040 42719.8903  89.5%     -  810s
H    0     0                    22583.545019 42719.8903  89.2%     -  810s
H    0     0                    22726.384235 42719.8903  88.0%     -  810s
     0     0 42673.1426    0  479 22726.3842 42673.1426  87.8%     -  821s
     0     0 42647.5934    0  503 22726.3842 42647.5934  87.7%     -  830s
     0     0 42642.8525    0  498 22726.3842 42642.8525  87.6%     -  833s
     0     0 42638.2653    0  500 22726.3842 42638.2653  87.6%     -  837s
     0     0 42634.5319    0  512 22726.3842 42634.5319  87.6%     -  841s
     0     0 42632.2320    0  499 22726.3842 42632.2320  87.6%     -  844s
     0     0 42497.3871    0  526 22726.3842 42497.3871  87.0%     -  873s
     0     0 42455.2393    0  523 22726.3842 42455.2393  86.8%     -  891s
     0     0 42440.6787    0  528 22726.3842 42440.6787  86.7%     -  897s
     0     0 42422.2647    0  480 22726.3842 42422.2647  86.7%     -  902s
     0     0 42410.7963    0  527 22726.3842 42410.7963  86.6%     -  908s
     0     0 42405.6360    0  532 22726.3842 42405.6360  86.6%     -  912s
     0     0 42403.3414    0  539 22726.3842 42403.3414  86.6%     -  914s
     0     0 42319.2571    0  470 22726.3842 42319.2571  86.2%     -  936s
     0     0 42295.2851    0  469 22726.3842 42295.2851  86.1%     -  952s
     0     0 42287.4785    0  496 22726.3842 42287.4785  86.1%     -  958s
     0     0 42248.2424    0  471 22726.3842 42248.2424  85.9%     -  973s
     0     0 42243.3476    0  485 22726.3842 42243.3476  85.9%     -  977s
     0     0 42240.5837    0  482 22726.3842 42240.5837  85.9%     -  980s
     0     0 42197.1120    0  474 22726.3842 42197.1120  85.7%     -  995s
     0     0 42189.0536    0  475 22726.3842 42189.0536  85.6%     - 1004s
     0     0 42182.5488    0  469 22726.3842 42182.5488  85.6%     - 1010s
     0     0 42178.9302    0  477 22726.3842 42178.9302  85.6%     - 1014s
     0     0 42177.7638    0  428 22726.3842 42177.7638  85.6%     - 1015s
     0     0 42144.0179    0  462 22726.3842 42144.0179  85.4%     - 1028s
     0     0 42137.6334    0  472 22726.3842 42137.6334  85.4%     - 1034s
     0     0 42134.9355    0  466 22726.3842 42134.9355  85.4%     - 1036s
     0     0 42130.2635    0  476 22726.3842 42130.2635  85.4%     - 1042s
     0     0 42125.4859    0  472 22726.3842 42125.4859  85.4%     - 1045s
     0     0 42123.5787    0  487 22726.3842 42123.5787  85.4%     - 1047s
     0     0 42117.9224    0  473 22726.3842 42117.9224  85.3%     - 1052s
     0     0 42117.2884    0  473 22726.3842 42117.2884  85.3%     - 1058s
     0     2 42116.9931    0  473 22726.3842 42116.9931  85.3%     - 1258s
     1     3 41961.6078    1  429 22726.3842 42116.9931  85.3%  7854 1273s
     2     4 42049.2065    1  475 22726.3842 42049.2065  85.0%  5793 1286s
     3     6 41775.0572    2  418 22726.3842 42048.9911  85.0%  6615 1304s
     5    10 41349.4896    3  413 22726.3842 42048.9911  85.0%  8221 1332s
     9    19 41216.8460    4  482 22726.3842 41775.0535  83.8%  8382 1379s
    18    38 41107.2709    5  407 22726.3842 41602.5733  83.1%  9817 1439s
    37    51 41004.2685    5  469 22726.3842 41307.2622  81.8% 19001 1574s
    50    76 40922.5605    6  460 22726.3842 41307.2622  81.8% 17706 1651s
    75   134 40896.4181    7  467 22726.3842 41307.2622  81.8% 15204 1735s
   133   236 40874.5027    9  468 22726.3842 41307.2622  81.8% 11123 1795s
   235   275 37765.4640   12  295 22726.3842 41307.2622  81.8%  8281 1844s
   274   296 40696.7748   13  464 22726.3842 41307.2622  81.8%  7824 1887s
   295   338 39627.4413   16  412 22726.3842 41307.2622  81.8%  7857 1929s
   337   367 40397.4081   14  472 22726.3842 41307.2622  81.8%  8027 1971s
   368   400 36831.8195   13  345 22726.3842 41307.2622  81.8%  7986 2018s
   405   452 34161.6639   15  393 22726.3842 41307.2622  81.8%  7873 2051s
   463   516 34093.2712   16  437 22726.3842 41307.2622  81.8%  8040 2086s
   539   536     cutoff   23      22726.3842 41307.2622  81.8%  8032 2118s
   581   581 33052.8426   17  348 22726.3842 41307.2622  81.8%  8005 2150s
   644   642 32945.1246   18  421 22726.3842 41307.2622  81.8%  8011 2180s
   719   710 32287.1433   19  375 22726.3842 41307.2622  81.8%  8044 2210s
   801   738 31838.5229   20  430 22726.3842 41307.2622  81.8%  7887 2228s
   837   763 28562.6048   25  275 22726.3842 41307.2622  81.8%  7827 2253s
   872   789 31414.6327   21  426 22726.3842 41307.2622  81.8%  7801 2276s
   922   832 31305.5753   22  428 22726.3842 41307.2622  81.8%  7734 2305s
   993   867 31218.8204   23  407 22726.3842 41307.2622  81.8%  7541 2336s
  1086   892 31072.7173   24  398 22726.3842 41307.2622  81.8%  7382 2361s
  1123   911 30786.4334   25  405 22726.3842 41307.2622  81.8%  7377 2394s
  1178   931 29518.8046   26  317 22726.3842 41307.2622  81.8%  7324 2428s
  1220   944 29187.5219   27  321 22726.3842 41307.2622  81.8%  7335 2461s
  1306   983 28697.2591   28  319 22726.3842 41307.2622  81.8%  7279 2499s
  1397  1036 28374.6506   29  265 22726.3842 41307.2622  81.8%  7254 2534s
  1514  1088 24083.9396   31  297 22726.3842 41307.2622  81.8%  7210 2574s
  1645  1112 23158.1978   34  304 22726.3842 41307.2622  81.8%  7130 2616s
  1763  1149 24397.2484   23  277 22726.3842 41232.5644  81.4%  7136 2659s
  1858  1202 33326.9580   12  259 22726.3842 41232.5644  81.4%  7196 2706s
  1945  1246 32502.9331   13  249 22726.3842 41232.5644  81.4%  7318 2750s
  2047  1315 infeasible   16      22726.3842 41232.5644  81.4%  7442 2803s
  2162  1379 23841.2714   18  163 22726.3842 40911.2670  80.0%  7515 2851s
  2285  1481 26285.5449   16  194 22726.3842 40911.2670  80.0%  7662 2902s
  2417  1546 23897.3521   18  170 22726.3842 40911.2670  80.0%  7690 2953s
  2576  1687 23160.7439   22  143 22726.3842 40911.2670  80.0%  7702 3014s
  2787  1869 33809.2444    7  406 22726.3842 40911.2670  80.0%  7598 3071s
  3035  2001 33025.5192    9  302 22726.3842 40911.2670  80.0%  7428 3125s
  3291  2146 31456.4452   13  257 22726.3842 40811.0114  79.6%  7273 3182s
  3494  2293 30741.6718   17  179 22726.3842 40811.0114  79.6%  7230 3244s
  3713  2418 25871.6492   27  162 22726.3842 40811.0114  79.6%  7182 3306s
H 3921  2345                    23207.922510 40811.0114  75.8%  7156 3378s
H 3921  2335                    23238.305659 40811.0114  75.6%  7156 3378s
H 3921  2325                    23266.622232 40811.0114  75.4%  7156 3391s
H 3921  2320                    23296.537949 40811.0114  75.2%  7156 3394s

Cutting planes:
  Learned: 1
  Gomory: 17
  Implied bound: 217
  MIR: 2603
  Flow cover: 3802
  RLT: 149
  Relax-and-lift: 1130

Explored 3921 nodes (28783369 simplex iterations) in 3600.08 seconds (5546.22 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 23296.5 23266.6 23238.3 ... 22088.7

Time limit reached
Best objective 2.329653794898e+04, best bound 4.081101135455e+04, gap 75.1806%
  WARNING: Time limit reached. Using best solution found (gap: 75.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 23296.54, θ = 183074.68
  Upper Bound (UB) = 23296.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 183074.68
  [DEBUG]   ✓ Scenario 0: θ = 183074.68 ≤ Q = 183074.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 183074.68 ≤ Q = 183074.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 183074.68 ≤ Q = 183074.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 183074.68 ≤ Q = 183074.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 183074.68 ≤ Q = 183074.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 183074.68 ≤ Q = 183074.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5b8fed18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa47012e8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-16, 2e+02]
Found heuristic solution: objective 1.463179e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 7092259.4346
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.556175e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155617.47    0  122 7092259.43 -155617.47   102%     -    0s
H    0     0                    -120585.4515 -155617.47  29.1%     -    0s
H    0     0                    -120892.4877 -155617.47  28.7%     -    0s
     0     0 -131319.52    0   53 -120892.49 -131319.52  8.63%     -    0s
H    0     0                    -126217.2740 -131204.30  3.95%     -    0s
H    0     0                    -129000.9124 -131204.30  1.71%     -    0s
H    0     0                    -129906.8683 -131204.30  1.00%     -    0s
H    0     0                    -130478.3934 -131204.30  0.56%     -    0s
     0     0 -130899.04    0   44 -130478.39 -130899.04  0.32%     -    0s
     0     0 -130853.19    0   31 -130478.39 -130853.19  0.29%     -    0s
     0     0 -130808.71    0   33 -130478.39 -130808.71  0.25%     -    0s
     0     0 -130808.55    0   33 -130478.39 -130808.55  0.25%     -    0s
     0     0 -130565.04    0   12 -130478.39 -130565.04  0.07%     -    0s
     0     0 -130565.04    0   14 -130478.39 -130565.04  0.07%     -    0s
     0     0 -130499.01    0    2 -130478.39 -130499.01  0.02%     -    0s
H    0     0                    -130484.4082 -130496.43  0.01%     -    0s
*    0     0               0    -130496.4326 -130496.43  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 10
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (620 simplex iterations) in 0.14 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -130496 -130484 -130478 ... 1.46318e+13
No other solutions better than -130496

Optimal solution found (tolerance 1.00e-06)
Best objective -1.304964325514e+05, best bound -1.304964325514e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 177554.64
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130496.43
  [DEBUG]   S×d_nominal = 308051.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 308051.07 + -130496.43 = 177554.64
  [DEBUG]   Current θ from Master = 183074.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5520.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17776.50
  Lower Bound (LB) = 23334.17
  Gap (UB-LB) = -37.6288, Absolute Gap = 37.6288, Relative Gap = -0.001615
  *** CONVERGED (small negative gap: -37.63 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 14
Total Time: 35370.17s
Converged: True
Final Lower Bound: 23334.1668
Final Upper Bound: 23296.5379
Final Gap: -37.628826
Number of Critical Scenarios: 14
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1, 2] (2/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 4
DCs Opened: [1, 3, 5, 7] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 14
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-03 19:34:55
Total Time: 35370.17s
Optimal Value: 23334.17
Lower Bound: 23334.17
Upper Bound: 23296.54
Gap: -37.628826
Plants Opened: {0: [1, 2], 1: [2], 2: [2]} (4 plants)
DCs Opened: [1, 3, 5, 7] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed15_Mixed_gamma20_20260103_193455.csv

Total Execution Time: 35370.62 seconds
End Time: 2026-01-03 19:34:55

All tasks completed successfully!

