
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 20
DI Scenario: MD
Start Time: 2026-01-03 10:45:36
================================================================================
Loading data from data/DH_data_full_seed20.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.194', '1.425'] (k=0.437)
  Product 1: ['1.000', '1.149', '1.319'] (k=0.342)
  Product 2: ['1.000', '1.168', '1.363'] (k=0.382)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1737
  DC capacity (MC): min=437, max=799

Demand Structure (s_rk matrix):
  Total customer-product pairs: 88/150 (41.3% sparse)
  Average products per customer: 1.76

Demand (only non-zero entries):
  Nominal (μ): min=8.03, max=34.72, count=88
  Deviation (μ̂): min=4.13, max=9.94

Costs:
  Plant fixed cost: min=6305, max=9991
  DC fixed cost: min=3078, max=5751
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.452', '2.108'] (k=0.920)
    Product 1: ['1.000', '1.340', '1.796'] (k=0.722)
    Product 2: ['1.000', '1.438', '2.069'] (k=0.896)
  MD:
    Product 0: ['1.000', '1.194', '1.425'] (k=0.437)
    Product 1: ['1.000', '1.149', '1.319'] (k=0.342)
    Product 2: ['1.000', '1.168', '1.363'] (k=0.382)
  LD:
    Product 0: ['1.000', '1.028', '1.057'] (k=0.068)
    Product 1: ['1.000', '1.119', '1.252'] (k=0.277)
    Product 2: ['1.000', '1.010', '1.020'] (k=0.024)
  Mixed:
    Product 0: ['1.000', '1.452', '2.108'] (k=0.920)
    Product 1: ['1.000', '1.149', '1.319'] (k=0.342)
    Product 2: ['1.000', '1.010', '1.020'] (k=0.024)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48774 nonzeros
Model fingerprint: 0xfe7a8a7b
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11543 rows and 2543 columns
Presolve time: 0.08s
Presolved: 5130 rows, 5957 columns, 35527 nonzeros
Variable types: 3698 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -306020.4837
Found heuristic solution: objective -207781.0263

Root relaxation: objective 1.130831e+05, 5690 iterations, 0.25 seconds (0.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 113083.084    0  542 -207781.03 113083.084   154%     -    0s
H    0     0                    -179480.1920 113083.084   163%     -    0s
     0     0 99093.7159    0  828 -179480.19 99093.7159   155%     -    1s
H    0     0                    -152920.1378 98742.4913   165%     -    1s
     0     0 98742.4913    0  826 -152920.14 98742.4913   165%     -    1s
     0     0 98742.4913    0  828 -152920.14 98742.4913   165%     -    1s
     0     0 98742.4913    0  829 -152920.14 98742.4913   165%     -    1s
H    0     0                    -139395.6328 92589.3056   166%     -    2s
     0     0 92589.3056    0  908 -139395.63 92589.3056   166%     -    2s
H    0     0                    -139262.6702 92589.2287   166%     -    2s
     0     0 92439.4235    0  928 -139262.67 92439.4235   166%     -    2s
     0     0 92423.3889    0  929 -139262.67 92423.3889   166%     -    2s
     0     0 92422.4133    0  937 -139262.67 92422.4133   166%     -    2s
H    0     0                    -138998.4561 89007.5340   164%     -    4s
H    0     0                    -138818.8629 89007.5340   164%     -    4s
H    0     0                    -138370.9885 89007.5340   164%     -    4s
H    0     0                    -137858.5572 89007.5340   165%     -    4s
H    0     0                    -94021.47325 89007.5340   195%     -    4s
H    0     0                    40735.263626 89007.5340   119%     -    4s
     0     0 89007.5340    0 1057 40735.2636 89007.5340   119%     -    4s
     0     0 88745.4959    0 1049 40735.2636 88745.4959   118%     -    4s
     0     0 88706.1220    0 1069 40735.2636 88706.1220   118%     -    4s
H    0     0                    41037.278658 88696.2241   116%     -    4s
H    0     0                    41321.488099 88696.2241   115%     -    4s
     0     0 88696.2241    0 1087 41321.4881 88696.2241   115%     -    4s
H    0     0                    41766.808376 88695.1183   112%     -    4s
     0     0 88695.1183    0 1085 41766.8084 88695.1183   112%     -    4s
H    0     0                    41879.774765 88695.1183   112%     -    5s
H    0     0                    42019.627685 88695.1183   111%     -    5s
H    0     0                    42109.374462 88695.1183   111%     -    5s
H    0     0                    42320.439260 88695.1183   110%     -    5s
H    0     0                    42345.985013 88695.1183   109%     -    5s
H    0     0                    42557.768278 85435.4722   101%     -    6s
H    0     0                    42660.261549 85435.4722   100%     -    6s
H    0     0                    42673.882837 85435.4722   100%     -    6s
H    0     0                    42815.527707 85435.4722   100%     -    6s
H    0     0                    42829.148994 85435.4722  99.5%     -    6s
H    0     0                    42948.229441 85435.4722  98.9%     -    6s
H    0     0                    42973.847373 85435.4722  98.8%     -    6s
H    0     0                    42987.468660 85435.4722  98.7%     -    6s
H    0     0                    43005.235633 85435.4722  98.7%     -    6s
H    0     0                    43027.462573 85435.4722  98.6%     -    6s
H    0     0                    43083.866325 85435.4722  98.3%     -    6s
H    0     0                    43342.814346 85435.4722  97.1%     -    6s
H    0     0                    43445.645967 85435.4722  96.6%     -    6s
H    0     0                    43568.505798 85435.4722  96.1%     -    6s
H    0     0                    43825.246449 85435.4722  94.9%     -    6s
H    0     0                    43971.057593 85435.4722  94.3%     -    6s
H    0     0                    44155.794569 85435.4722  93.5%     -    6s
     0     0 85435.4722    0 1075 44155.7946 85435.4722  93.5%     -    6s
H    0     0                    44265.704351 85180.7868  92.4%     -    7s
     0     0 85180.7868    0 1102 44265.7044 85180.7868  92.4%     -    7s
     0     0 85134.6187    0 1119 44265.7044 85134.6187  92.3%     -    7s
     0     0 85111.5837    0 1114 44265.7044 85111.5837  92.3%     -    7s
     0     0 85109.9293    0 1124 44265.7044 85109.9293  92.3%     -    7s
     0     0 82637.3346    0  961 44265.7044 82637.3346  86.7%     -    9s
     0     0 82120.4454    0 1035 44265.7044 82120.4454  85.5%     -    9s
     0     0 82031.9054    0 1037 44265.7044 82031.9054  85.3%     -   10s
     0     0 82013.7541    0 1050 44265.7044 82013.7541  85.3%     -   10s
     0     0 82005.7738    0 1059 44265.7044 82005.7738  85.3%     -   10s
     0     0 77909.1451    0  798 44265.7044 77909.1451  76.0%     -   11s
     0     0 77220.6995    0  825 44265.7044 77220.6995  74.4%     -   12s
     0     0 77107.9358    0  838 44265.7044 77107.9358  74.2%     -   12s
     0     0 77087.3966    0  848 44265.7044 77087.3966  74.1%     -   12s
H    0     0                    44340.848872 67949.6438  53.2%     -   14s
     0     0 67949.6438    0  508 44340.8489 67949.6438  53.2%     -   14s
     0     0 66442.8379    0  634 44340.8489 66442.8379  49.8%     -   14s
     0     0 66098.8668    0  552 44340.8489 66098.8668  49.1%     -   15s
     0     0 66009.2726    0  652 44340.8489 66009.2726  48.9%     -   15s
     0     0 65960.6627    0  660 44340.8489 65960.6627  48.8%     -   15s
     0     0 65957.8904    0  669 44340.8489 65957.8904  48.8%     -   15s
     0     0 63339.9102    0  777 44340.8489 63339.9102  42.8%     -   16s
     0     0 62960.7217    0  789 44340.8489 62960.7217  42.0%     -   17s
H    0     0                    44779.757077 62815.8509  40.3%     -   17s
H    0     0                    44782.287744 62815.8509  40.3%     -   17s
H    0     0                    44826.605888 62815.8509  40.1%     -   17s
H    0     0                    44865.052173 62815.8509  40.0%     -   17s
     0     0 62815.8509    0  789 44865.0522 62815.8509  40.0%     -   17s
     0     0 62786.1579    0  737 44865.0522 62786.1579  39.9%     -   17s
     0     0 61140.3755    0  721 44865.0522 61140.3755  36.3%     -   18s
     0     0 60856.6551    0  757 44865.0522 60856.6551  35.6%     -   19s
     0     0 60734.2648    0  765 44865.0522 60734.2648  35.4%     -   19s
     0     0 60677.2487    0  810 44865.0522 60677.2487  35.2%     -   19s
     0     0 60657.1160    0  816 44865.0522 60657.1160  35.2%     -   20s
     0     0 59155.5624    0  778 44865.0522 59155.5624  31.9%     -   21s
     0     0 58807.4376    0  833 44865.0522 58807.4376  31.1%     -   21s
     0     0 58712.3640    0  856 44865.0522 58712.3640  30.9%     -   22s
     0     0 58656.8377    0  857 44865.0522 58656.8377  30.7%     -   22s
     0     0 58649.2642    0  834 44865.0522 58649.2642  30.7%     -   22s
H    0     0                    44968.140344 57936.8606  28.8%     -   23s
H    0     0                    44994.301205 57936.8606  28.8%     -   23s
     0     0 57936.8606    0  730 44994.3012 57936.8606  28.8%     -   23s
     0     0 57715.7626    0  748 44994.3012 57715.7626  28.3%     -   24s
     0     0 57625.3949    0  833 44994.3012 57625.3949  28.1%     -   24s
     0     0 57591.0600    0  809 44994.3012 57591.0600  28.0%     -   24s
     0     0 57119.7768    0  740 44994.3012 57119.7768  26.9%     -   25s
     0     0 57019.4587    0  777 44994.3012 57019.4587  26.7%     -   26s
     0     0 56977.1457    0  714 44994.3012 56977.1457  26.6%     -   26s
     0     0 56677.8218    0  742 44994.3012 56677.8218  26.0%     -   27s
     0     0 56677.7461    0  742 44994.3012 56677.7461  26.0%     -   27s
     0     2 56677.7461    0  742 44994.3012 56677.7461  26.0%     -   29s
     3     8 55413.6507    2  552 44994.3012 56497.5247  25.6%  2123   30s
    63    96 54128.8365    6  645 44994.3012 55354.9150  23.0%  2330   35s
   342   365 53459.7944   10  488 44994.3012 55354.9150  23.0%  1346   40s
   795   725 52143.6599   15  456 44994.3012 54618.4675  21.4%   933   45s
  1455  1333 50228.0284   26  358 44994.3012 54597.9591  21.3%   721   51s
  2137  1747 48418.1670   38  322 44994.3012 54334.6177  20.8%   608   55s
  2930  2289 45149.4250   53  296 44994.3012 54204.3262  20.5%   548   60s
  3955  2832 51105.6596   11  742 44994.3012 53328.3975  18.5%   491   74s
  3958  2834 48092.8281   17  300 44994.3012 53328.3975  18.5%   491   75s
  3993  2857 51125.5812   27  303 44994.3012 51825.4412  15.2%   487   80s

Cutting planes:
  Gomory: 5
  Implied bound: 16
  Projected implied bound: 35
  MIR: 161
  Flow cover: 372
  RLT: 31
  Relax-and-lift: 102
  BQP: 4

Explored 4900 nodes (2178518 simplex iterations) in 83.55 seconds (170.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 44994.3 44968.1 44865.1 ... 43971.1

Optimal solution found (tolerance 1.00e-06)
Best objective 4.499430120467e+04, best bound 4.499430120467e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 83.55s
  Master Objective (UB) = 44994.30, θ = 189635.68
  Upper Bound (UB) = 44994.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 189635.68
  [DEBUG]   ✓ Scenario 0: θ = 189635.68 ≤ Q = 189635.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7807f8d9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7807f8d9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.290003e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.00s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6909284.3793
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.426748e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142674.76    0  123 6909284.38 -142674.76   102%     -    0s
H    0     0                    -105757.8502 -142674.76  34.9%     -    0s
H    0     0                    -106981.7800 -142674.76  33.4%     -    0s
H    0     0                    -109804.9394 -109804.94  0.00%     -    0s
     0     0          -    0      -109804.94 -109804.94  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 211

Explored 1 nodes (385 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -109805 -106982 -105758 ... 1.29e+13
No other solutions better than -109805

Optimal solution found (tolerance 1.00e-06)
Best objective -1.098049393915e+05, best bound -1.098049393915e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 156842.66
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109804.94
  [DEBUG]   S×d_nominal = 266647.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 266647.60 + -109804.94 = 156842.66
  [DEBUG]   Current θ from Master = 189635.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32793.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12201.28
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 32793.0164, Absolute Gap = 32793.0164, Relative Gap = 0.728826
  Not converged yet (gap = 32793.02 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92029 nonzeros
Model fingerprint: 0x8efed9eb
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 12201.3 (0.01s)
MIP start from previous solve produced solution with objective 12201.3 (0.01s)
Loaded MIP start from previous solve with objective 12201.3

Presolve removed 12525 rows and 5084 columns
Presolve time: 0.30s
Presolved: 19438 rows, 9656 columns, 107838 nonzeros
Variable types: 7397 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.394035e+04, 9756 iterations, 0.88 seconds (1.86 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53940.3531    0  282 12201.2848 53940.3531   342%     -    1s
H    0     0                    12880.696366 53940.3531   319%     -    1s
H    0     0                    12908.477790 53940.3531   318%     -    1s
H    0     0                    13091.910541 53940.3531   312%     -    1s
H    0     0                    13274.087748 53940.3531   306%     -    1s
H    0     0                    13312.028942 53940.3531   305%     -    1s
     0     0 43515.0673    0  452 13312.0289 43515.0673   227%     -    2s
H    0     0                    14168.558003 43502.0905   207%     -    2s
H    0     0                    14227.144170 43502.0905   206%     -    2s
H    0     0                    14300.862668 43502.0905   204%     -    2s
     0     0 43184.4330    0  461 14300.8627 43184.4330   202%     -    2s
     0     0 43183.0680    0  461 14300.8627 43183.0680   202%     -    2s
H    0     0                    14376.321914 43183.0680   200%     -    3s
     0     0 37160.0127    0  362 14376.3219 37160.0127   158%     -    4s
     0     0 35918.0789    0  426 14376.3219 35918.0789   150%     -    5s
     0     0 35917.1745    0  433 14376.3219 35917.1745   150%     -    5s
     0     0 35917.1745    0  439 14376.3219 35917.1745   150%     -    5s
     0     0 35917.1745    0  437 14376.3219 35917.1745   150%     -    5s
     0     0 32177.2572    0  481 14376.3219 32177.2572   124%     -    7s
H    0     0                    14465.933631 32177.1257   122%     -    7s
H    0     0                    14476.695131 32177.1257   122%     -    7s
     0     0 31522.4581    0  510 14476.6951 31522.4581   118%     -    8s
     0     0 31429.1834    0  516 14476.6951 31429.1834   117%     -    8s
     0     0 31403.3963    0  523 14476.6951 31403.3963   117%     -    8s
     0     0 31398.7065    0  521 14476.6951 31398.7065   117%     -    9s
H    0     0                    14486.802341 31398.7065   117%     -   10s
     0     0 29311.3245    0  454 14486.8023 29311.3245   102%     -   11s
     0     0 28714.4035    0  520 14486.8023 28714.4035  98.2%     -   12s
H    0     0                    14587.175558 28446.7845  95.0%     -   13s
     0     0 28446.7845    0  466 14587.1756 28446.7845  95.0%     -   13s
     0     0 28377.4575    0  470 14587.1756 28377.4575  94.5%     -   13s
     0     0 28355.8301    0  460 14587.1756 28355.8301  94.4%     -   13s
     0     0 28330.2389    0  460 14587.1756 28330.2389  94.2%     -   13s
     0     0 28327.0074    0  469 14587.1756 28327.0074  94.2%     -   13s
     0     0 27878.0542    0  503 14587.1756 27878.0542  91.1%     -   15s
H    0     0                    14673.200002 27877.5047  90.0%     -   15s
H    0     0                    14717.345901 27877.5047  89.4%     -   15s
     0     0 27740.7589    0  526 14717.3459 27740.7589  88.5%     -   15s
     0     0 27634.9111    0  540 14717.3459 27634.9111  87.8%     -   16s
     0     0 27575.0866    0  607 14717.3459 27575.0866  87.4%     -   16s
     0     0 27559.4602    0  610 14717.3459 27559.4602  87.3%     -   16s
     0     0 27552.2532    0  542 14717.3459 27552.2532  87.2%     -   16s
     0     0 27402.0081    0  370 14717.3459 27402.0081  86.2%     -   17s
     0     0 27361.6896    0  589 14717.3459 27361.6896  85.9%     -   18s
     0     0 27338.1219    0  530 14717.3459 27338.1219  85.8%     -   19s
     0     0 27332.1953    0  539 14717.3459 27332.1953  85.7%     -   19s
H    0     0                    14828.564962 27283.2587  84.0%     -   20s
H    0     0                    14862.870938 27283.2587  83.6%     -   20s
H    0     0                    14887.612445 27283.2587  83.3%     -   20s
     0     0 27283.2587    0  453 14887.6124 27283.2587  83.3%     -   20s
H    0     0                    15039.075884 27281.5040  81.4%     -   20s
     0     0 27262.2886    0  512 15039.0759 27262.2886  81.3%     -   20s
     0     0 27257.2428    0  515 15039.0759 27257.2428  81.2%     -   21s
     0     0 27210.6938    0  315 15039.0759 27210.6938  80.9%     -   21s
H    0     0                    15222.730049 27210.0056  78.7%     -   22s
H    0     0                    15239.155942 27210.0056  78.6%     -   22s
     0     0 27195.1947    0  387 15239.1559 27195.1947  78.5%     -   23s
     0     0 27189.5501    0  394 15239.1559 27189.5501  78.4%     -   23s
     0     0 27180.7086    0  292 15239.1559 27180.7086  78.4%     -   23s
H    0     0                    15295.749729 27180.6455  77.7%     -   23s
     0     0 27176.2470    0  306 15295.7497 27176.2470  77.7%     -   23s
     0     0 27165.5440    0  393 15295.7497 27165.5440  77.6%     -   24s
     0     0 27165.0870    0  393 15295.7497 27165.0870  77.6%     -   24s
H    0     0                    15319.039001 27165.0870  77.3%     -   27s
     0     2 27165.0870    0  393 15319.0390 27165.0870  77.3%     -   27s
     7    16 25349.8007    3  563 15319.0390 26343.0276  72.0%  1380   30s
H   31    60                    15361.929687 25692.8761  67.3%  1662   33s
H   59    60                    15380.634270 25453.0524  65.5%  1423   33s
H   71    92                    15407.227202 25438.4323  65.1%  1377   34s
    95   178 23874.2689    7  377 15407.2272 25345.3917  64.5%  1579   35s
H  413   339                    15426.534200 24737.2972  60.4%   787   38s
   565   483 21014.3198   14  335 15426.5342 24689.4130  60.0%   644   40s
H  927   651                    15454.163053 23706.6822  53.4%   490   44s
   989   743 20183.1756   23  284 15454.1631 23706.6822  53.4%   478   45s
  1791  1248 17579.9510   54  181 15454.1631 23128.0205  49.7%   347   50s
H 1998  1298                    15467.862387 23128.0205  49.5%   330   51s
  3109  1886     cutoff   20      15467.8624 22186.4872  43.4%   264   55s
H 4504  2623                    15484.619649 21520.7838  39.0%   222   60s
H 4504  2623                    15484.814772 21520.7838  39.0%   222   61s
  4505  2624 16136.6978   36  393 15484.8148 21520.7838  39.0%   222   68s
  4508  2626 17587.1941   20  337 15484.8148 21520.7838  39.0%   222   71s
  4514  2630 18199.6038   43  410 15484.8148 21520.7838  39.0%   221   75s
  4525  2637 20997.8743    9  422 15484.8148 21520.7838  39.0%   221   80s
H 4528  2506                    15534.505925 21520.7838  38.5%   221   84s
H 4528  2380                    16454.635087 21520.7838  30.8%   221   84s
H 4528  2261                    16600.693643 21520.7838  29.6%   221   84s
H 4529  2150                    16609.181756 21520.7838  29.6%   227   84s
  4530  2152 21520.7838   11  386 16609.1818 21520.7838  29.6%   228   85s
H 4561  2086                    16752.836013 21520.7838  28.5%   232   89s
H 4566  1982                    17947.925593 21520.7838  19.9%   233   89s
  4592  1994 21520.7838   16  321 17947.9256 21520.7838  19.9%   237   90s
H 4628  1929                    18007.696210 21520.7838  19.5%   241   91s
H 4757  1868                    18108.949790 21520.7838  18.8%   249   93s
H 4760  1780                    18207.396916 21520.7838  18.2%   249   93s
H 4763  1695                    18548.334885 21520.7838  16.0%   249   93s
  4867  1686 21520.7838   18  353 18548.3349 21520.7838  16.0%   254   95s
  5243  1592 21095.0751   23  266 18548.3349 21520.7838  16.0%   270  100s
  5612  1445 infeasible   19      18548.3349 21520.7838  16.0%   282  105s
  6168  1036 19258.4106   26  311 18548.3349 20539.2085  10.7%   286  110s

Cutting planes:
  MIR: 249
  Mixing: 1
  Flow cover: 459
  RLT: 6
  Relax-and-lift: 53

Explored 6187 nodes (1811898 simplex iterations) in 110.76 seconds (254.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 18548.3 18207.4 18108.9 ... 15534.5

Optimal solution found (tolerance 1.00e-06)
Best objective 1.854833488501e+04, best bound 1.854833488501e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 110.77s
  Master Objective (UB) = 18548.33, θ = 157632.76
  Upper Bound (UB) = 18548.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157632.76
  [DEBUG]   ✓ Scenario 0: θ = 157632.76 ≤ Q = 157632.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157632.76 ≤ Q = 157632.76 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x23287f5e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdcd780a2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.178295e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6325475.4848
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.470563e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147056.25    0  133 6325475.48 -147056.25   102%     -    0s
H    0     0                    -108848.2904 -147056.25  35.1%     -    0s
H    0     0                    -111085.4619 -147056.25  32.4%     -    0s
H    0     0                    -116140.3729 -147056.25  26.6%     -    0s
H    0     0                    -124259.1998 -147056.25  18.3%     -    0s
     0     0 -136057.14    0  103 -124259.20 -136057.14  9.49%     -    0s
H    0     0                    -132934.3591 -135966.77  2.28%     -    0s
H    0     0                    -133233.7119 -135966.77  2.05%     -    0s
H    0     0                    -133666.6415 -135966.77  1.72%     -    0s
H    0     0                    -133965.9943 -135966.77  1.49%     -    0s
     0     0 -135677.46    0   93 -133965.99 -135677.46  1.28%     -    0s
     0     0 -134721.40    0   68 -133965.99 -134721.40  0.56%     -    0s
H    0     0                    -134026.6197 -134720.66  0.52%     -    0s
     0     0 -134477.63    0   56 -134026.62 -134477.63  0.34%     -    0s
     0     0 -134469.33    0   49 -134026.62 -134469.33  0.33%     -    0s
     0     0 -134275.52    0   28 -134026.62 -134275.52  0.19%     -    0s
     0     0 -134275.39    0   27 -134026.62 -134275.39  0.19%     -    0s
     0     0 -134246.64    0   35 -134026.62 -134246.64  0.16%     -    0s
     0     0 -134245.85    0   34 -134026.62 -134245.85  0.16%     -    0s
     0     0 -134242.26    0   25 -134026.62 -134242.26  0.16%     -    0s
     0     0 -134204.23    0   21 -134026.62 -134204.23  0.13%     -    0s
     0     0 -134204.23    0   29 -134026.62 -134204.23  0.13%     -    0s
     0     0 -134204.23    0   27 -134026.62 -134204.23  0.13%     -    0s
H    0     0                    -134064.5783 -134204.23  0.10%     -    0s
     0     0 -134134.33    0   12 -134064.58 -134134.33  0.05%     -    0s
H    0     0                    -134107.1641 -134133.59  0.02%     -    0s
     0     0 -134133.19    0   10 -134107.16 -134133.19  0.02%     -    0s
     0     0 -134123.26    0    2 -134107.16 -134123.26  0.01%     -    0s
     0     0 -134123.26    0    8 -134107.16 -134123.26  0.01%     -    0s
H    0     0                    -134111.8926 -134123.26  0.01%     -    0s
     0     0 -134119.95    0    3 -134111.89 -134119.95  0.01%     -    0s
H    0     0                    -134118.3710 -134118.37  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 3
  Flow cover: 5
  Relax-and-lift: 2

Explored 1 nodes (968 simplex iterations) in 0.12 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -134118 -134112 -134107 ... -116140
No other solutions better than -134118

Optimal solution found (tolerance 1.00e-06)
Best objective -1.341183709632e+05, best bound -1.341183709632e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 133571.25
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134118.37
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -134118.37 = 133571.25
  [DEBUG]   Current θ from Master = 157632.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24061.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5513.17
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 6347.0501, Absolute Gap = 6347.0501, Relative Gap = 0.342190
  Not converged yet (gap = 6347.05 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135284 nonzeros
Model fingerprint: 0x07f8d75e
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -5513.17 (0.02s)
Loaded MIP start from previous solve with objective -5513.17

Presolve removed 18786 rows and 7626 columns
Presolve time: 0.47s
Presolved: 28467 rows, 13354 columns, 175289 nonzeros
Variable types: 11095 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.709906e+04, 18084 iterations, 4.35 seconds (8.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 37099.0645    0  106 -5513.1698 37099.0645   773%     -    4s
H    0     0                    12053.772715 37099.0645   208%     -    5s
H    0     0                    12577.894246 37099.0645   195%     -    5s
H    0     0                    12924.940271 37099.0645   187%     -    5s
H    0     0                    13209.318960 37099.0645   181%     -    5s
     0     0 32817.6662    0  203 13209.3190 32817.6662   148%     -    7s
     0     0 32542.5016    0  201 13209.3190 32542.5016   146%     -    7s
     0     0 32542.5016    0  203 13209.3190 32542.5016   146%     -    7s
H    0     0                    13248.466283 29209.0000   120%     -   10s
H    0     0                    13373.034564 29209.0000   118%     -   10s
H    0     0                    13516.287598 29209.0000   116%     -   10s
     0     0 29078.9341    0  317 13516.2876 29078.9341   115%     -   10s
     0     0 28633.8072    0  316 13516.2876 28633.8072   112%     -   11s
     0     0 28435.5202    0  317 13516.2876 28435.5202   110%     -   11s
     0     0 28424.8263    0  353 13516.2876 28424.8263   110%     -   11s
     0     0 28423.1128    0  354 13516.2876 28423.1128   110%     -   11s
     0     0 28422.3287    0  321 13516.2876 28422.3287   110%     -   11s
     0     0 27271.2497    0  315 13516.2876 27271.2497   102%     -   14s
H    0     0                    13931.850010 27270.5623  95.7%     -   14s
H    0     0                    13968.307129 27270.5623  95.2%     -   14s
H    0     0                    14082.251466 27270.5623  93.7%     -   14s
     0     0 27011.8328    0  349 14082.2515 27011.8328  91.8%     -   15s
     0     0 26842.2529    0  402 14082.2515 26842.2529  90.6%     -   16s
     0     0 26820.6672    0  355 14082.2515 26820.6672  90.5%     -   16s
     0     0 26800.8879    0  315 14082.2515 26800.8879  90.3%     -   16s
     0     0 26796.8347    0  312 14082.2515 26796.8347  90.3%     -   16s
     0     0 26781.8154    0  304 14082.2515 26781.8154  90.2%     -   16s
     0     0 26780.0501    0  306 14082.2515 26780.0501  90.2%     -   16s
     0     0 26779.7973    0  306 14082.2515 26779.7973  90.2%     -   16s
     0     0 25848.2415    0  386 14082.2515 25848.2415  83.6%     -   20s
     0     0 25670.8074    0  395 14082.2515 25670.8074  82.3%     -   21s
     0     0 25616.6160    0  425 14082.2515 25616.6160  81.9%     -   21s
     0     0 25573.8515    0  390 14082.2515 25573.8515  81.6%     -   21s
     0     0 25565.7726    0  399 14082.2515 25565.7726  81.5%     -   22s
     0     0 25555.2489    0  402 14082.2515 25555.2489  81.5%     -   22s
     0     0 25553.3340    0  405 14082.2515 25553.3340  81.5%     -   22s
     0     0 25552.8640    0  403 14082.2515 25552.8640  81.5%     -   22s
     0     0 25345.1242    0  449 14082.2515 25345.1242  80.0%     -   23s
H    0     0                    14116.473782 25342.9894  79.5%     -   23s
     0     0 25319.4004    0  460 14116.4738 25319.4004  79.4%     -   24s
     0     0 25303.8947    0  483 14116.4738 25303.8947  79.3%     -   24s
     0     0 25294.0271    0  454 14116.4738 25294.0271  79.2%     -   24s
     0     0 25287.1532    0  454 14116.4738 25287.1532  79.1%     -   24s
     0     0 25285.8620    0  458 14116.4738 25285.8620  79.1%     -   24s
     0     0 25235.7948    0  440 14116.4738 25235.7948  78.8%     -   25s
H    0     0                    14246.353296 25234.5658  77.1%     -   26s
H    0     0                    14318.611566 25234.5658  76.2%     -   26s
H    0     0                    14465.178787 25234.5658  74.5%     -   26s
H    0     0                    14465.405059 25234.5658  74.4%     -   26s
H    0     0                    14596.183449 25234.5658  72.9%     -   26s
     0     0 25224.9757    0  442 14596.1834 25224.9757  72.8%     -   26s
H    0     0                    14688.416708 25219.2205  71.7%     -   26s
     0     0 25219.2205    0  444 14688.4167 25219.2205  71.7%     -   26s
     0     0 25218.0012    0  449 14688.4167 25218.0012  71.7%     -   26s
H    0     0                    14692.880524 25218.0012  71.6%     -   27s
H    0     0                    14748.748612 25198.2546  70.9%     -   27s
     0     0 25198.2546    0  394 14748.7486 25198.2546  70.9%     -   27s
H    0     0                    14900.065864 25198.0787  69.1%     -   27s
     0     0 25187.2696    0  358 14900.0659 25187.2696  69.0%     -   28s
     0     0 25185.3783    0  301 14900.0659 25185.3783  69.0%     -   28s
     0     0 25184.3771    0  302 14900.0659 25184.3771  69.0%     -   28s
     0     0 25167.9919    0  408 14900.0659 25167.9919  68.9%     -   29s
H    0     0                    14946.979383 25167.9257  68.4%     -   29s
H    0     0                    15396.619544 25167.9257  63.5%     -   29s
     0     0 25161.1269    0  456 15396.6195 25161.1269  63.4%     -   30s
     0     0 25159.7084    0  420 15396.6195 25159.7084  63.4%     -   30s
     0     0 25097.5140    0  404 15396.6195 25097.5140  63.0%     -   31s
     0     0 25094.7450    0  403 15396.6195 25094.7450  63.0%     -   31s
     0     0 25094.5495    0  353 15396.6195 25094.5495  63.0%     -   31s
     0     0 25092.1330    0  262 15396.6195 25092.1330  63.0%     -   31s
     0     0 25091.5788    0  262 15396.6195 25091.5788  63.0%     -   31s
     0     0 25082.3565    0  409 15396.6195 25082.3565  62.9%     -   32s
     0     0 25045.4839    0  402 15396.6195 25045.4839  62.7%     -   33s
     0     0 25041.5299    0  425 15396.6195 25041.5299  62.6%     -   33s
     0     0 25040.8513    0  425 15396.6195 25040.8513  62.6%     -   33s
     0     0 25039.2285    0  435 15396.6195 25039.2285  62.6%     -   33s
     0     0 25037.3984    0  437 15396.6195 25037.3984  62.6%     -   33s
     0     0 25035.9255    0  438 15396.6195 25035.9255  62.6%     -   34s
     0     0 25035.7309    0  438 15396.6195 25035.7309  62.6%     -   34s
     0     0 25035.2086    0  435 15396.6195 25035.2086  62.6%     -   34s
     0     0 25034.8334    0  431 15396.6195 25034.8334  62.6%     -   34s
     0     0 25034.7600    0  430 15396.6195 25034.7600  62.6%     -   35s
     0     0 25034.0904    0  430 15396.6195 25034.0904  62.6%     -   35s
     0     2 25034.0904    0  430 15396.6195 25034.0904  62.6%     -   38s
     7    16 24146.3222    3  423 15396.6195 24702.9005  60.4%  1455   41s
    95   133 23007.1589    7  368 15396.6195 23327.2130  51.5%  1661   46s
H  192   205                    15457.813693 23327.2130  50.9%  1285   49s
   204   282 22640.9778    9  365 15457.8137 23327.2130  50.9%  1283   51s
H  293   327                    15546.136934 23327.2130  50.1%  1237   53s
   338   405 22545.1956   10  398 15546.1369 23327.2130  50.1%  1299   55s
H  444   448                    15823.379179 23327.2130  47.4%  1272   56s
   536   545 21889.9430   13  329 15823.3792 23244.6121  46.9%  1237   60s
H  585   545                    15831.624816 23244.2285  46.8%  1209   60s
H  684   667                    15863.401254 23244.2285  46.5%  1173   64s
   743   730 17362.0461   17  377 15863.4013 23244.2285  46.5%  1137   66s
   909   818 20488.8335   19  359 15863.4013 23169.9108  46.1%  1055   70s
  1018   914 20412.8783   22  349 15863.4013 23133.3307  45.8%  1041   75s
  1221  1097 19445.0704   25  353 15863.4013 23125.5989  45.8%   999   81s
  1427  1222     cutoff   26      15863.4013 23124.4000  45.8%   968   86s
  1667  1352     cutoff   26      15863.4013 22943.6611  44.6%   931   92s
  1885  1462 17519.7462   29  231 15863.4013 22856.4365  44.1%   936   97s
  1996  1525 17014.9511   30  123 15863.4013 22856.4365  44.1%   937  100s
  2186  1587 20066.4802    8  242 15863.4013 22856.1621  44.1%   943  105s
H 2207  1587                    15866.045144 22856.1621  44.1%   944  105s
  2578  1830 17996.4720   15  140 15866.0451 22663.1649  42.8%   919  113s
  2802  1928 16803.6322   22  124 15866.0451 22515.0291  41.9%   894  115s
  3227  2001 19849.6490    8  276 15866.0451 22515.0291  41.9%   865  122s
  3498  2077 17357.8846   16  289 15866.0451 22515.0291  41.9%   882  127s
  3565  2152     cutoff   19      15866.0451 22515.0291  41.9%   883  130s
  3927  2311 17858.3167   17  294 15866.0451 22376.1421  41.0%   880  137s
  4182  2393 19743.9752   12  341 15866.0451 22201.4671  39.9%   873  140s
  4622  2554     cutoff   21      15866.0451 22199.1143  39.9%   873  149s
  4886  2629 19927.4873   12  239 15866.0451 22169.3084  39.7%   870  153s
  5110  2635 17313.8552   13  320 15866.0451 22169.3084  39.7%   877  156s
  5246  2711 16580.0075   14  292 15866.0451 22131.7025  39.5%   882  160s
  5483  2749 16319.7411   17  248 15866.0451 21934.1488  38.2%   885  165s
  5999  2914 19569.2535   15  307 15866.0451 21934.1488  38.2%   881  173s
  6298  3005 17185.0041    9  280 15866.0451 21846.8580  37.7%   883  179s
  6624  3006 19277.4346   18  430 15866.0451 21768.1398  37.2%   882  186s
  6626  3007 21274.1332   15  106 15866.0451 21768.1398  37.2%   882  191s
  6628  3009 18941.4043   10  434 15866.0451 21768.1398  37.2%   882  196s
  6632  3011 17012.0126   27  424 15866.0451 21768.1398  37.2%   881  200s
  6641  3017 16636.9553   23  470 15866.0451 21768.1398  37.2%   880  205s
  6647  3021 21157.1759   13  421 15866.0451 21768.1398  37.2%   879  210s
  6651  3024 18380.1053   13  268 15866.0451 21768.1398  37.2%   879  215s
  6654  3026 20783.0497   21  372 15866.0451 21768.1398  37.2%   878  223s
  6655  3027 21306.9867   12  372 15866.0451 21768.1398  37.2%   878  227s
  6658  3034 21768.1398   14  358 15866.0451 21768.1398  37.2%   887  231s
  6670  3053 21768.1398   16  428 15866.0451 21768.1398  37.2%   889  236s
  6686  3072 21768.1398   17  347 15866.0451 21768.1398  37.2%   894  240s
  6749  3122 21392.2819   19  464 15866.0451 21768.1398  37.2%   909  246s
  6853  3171 21212.7076   20  458 15866.0451 21768.1398  37.2%   917  250s
  6966  3194 18558.9044   21  256 15866.0451 21768.1398  37.2%   926  255s
  7199  3134 19198.1066   23  366 15866.0451 21768.1398  37.2%   943  263s
  7280  3097     cutoff   23      15866.0451 21768.1398  37.2%   949  265s
  7430  3075 16617.2915   25  173 15866.0451 21283.0072  34.1%   958  270s
H 7490  2912                    16007.793919 21283.0072  33.0%   961  272s
  7541  2896     cutoff   26      16007.7939 21283.0072  33.0%   961  275s
H 7542  2751                    16471.429322 21283.0072  29.2%   961  275s
H 7556  2609                    16645.435362 21283.0072  27.9%   961  275s
  7703  2557 19333.1607   20  389 16645.4354 21248.9248  27.7%   960  280s
H 7837  2384                    16655.804076 21248.9248  27.6%   957  282s
H 7855  2254                    16711.193210 21248.9248  27.2%   956  282s
  8070  2143 17890.4459   23  266 16711.1932 20247.3781  21.2%   954  286s
  8361  1967 16955.3439   25  146 16711.1932 20024.2165  19.8%   952  291s
  8571  1760     cutoff   25      16711.1932 19027.1181  13.9%   945  295s

Cutting planes:
  Gomory: 4
  Lift-and-project: 8
  MIR: 221
  Flow cover: 509
  RLT: 3
  Relax-and-lift: 34

Explored 8852 nodes (8284592 simplex iterations) in 298.20 seconds (869.87 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 16711.2 16655.8 16645.4 ... 15546.1

Optimal solution found (tolerance 1.00e-06)
Best objective 1.671119321024e+04, best bound 1.671119321024e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 298.21s
  Master Objective (UB) = 16711.19, θ = 157340.04
  Upper Bound (UB) = 16711.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157340.04
  [DEBUG]   ✓ Scenario 0: θ = 157340.04 ≤ Q = 157340.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157340.04 ≤ Q = 157340.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157340.04 ≤ Q = 157340.04 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x10629dda
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x10629dda
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.168998e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6311865.8703
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.413022e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141302.19    0  130 6311865.87 -141302.19   102%     -    0s
H    0     0                    -99781.82944 -141302.19  41.6%     -    0s
H    0     0                    -101666.8369 -141302.19  39.0%     -    0s
H    0     0                    -105356.8445 -141302.19  34.1%     -    0s
H    0     0                    -106864.7899 -119559.83  11.9%     -    0s
     0     0 -119559.83    0  121 -106864.79 -119559.83  11.9%     -    0s
H    0     0                    -117967.9902 -119539.08  1.33%     -    0s
     0     0 -119316.71    0  122 -117967.99 -119316.71  1.14%     -    0s
     0     0 -119309.72    0  122 -117967.99 -119309.72  1.14%     -    0s
     0     0 -118828.54    0   72 -117967.99 -118828.54  0.73%     -    0s
     0     0 -118794.56    0   71 -117967.99 -118794.56  0.70%     -    0s
     0     0 -118575.04    0   62 -117967.99 -118575.04  0.51%     -    0s
     0     0 -118522.37    0   53 -117967.99 -118522.37  0.47%     -    0s
     0     0 -118520.73    0   54 -117967.99 -118520.73  0.47%     -    0s
     0     0 -118400.41    0   51 -117967.99 -118400.41  0.37%     -    0s
     0     0 -118393.35    0   54 -117967.99 -118393.35  0.36%     -    0s
     0     0 -118299.40    0   48 -117967.99 -118299.40  0.28%     -    0s
     0     0 -118283.91    0   48 -117967.99 -118283.91  0.27%     -    0s
H    0     0                    -117977.9797 -118283.44  0.26%     -    0s
     0     2 -118283.44    0   48 -117977.98 -118283.44  0.26%     -    0s
H   40    24                    -118003.4834 -118154.68  0.13%   8.9    0s
H   41    23                    -118130.2344 -118154.68  0.02%   9.0    0s
H  110    13                    -118131.2083 -118145.99  0.01%   4.3    0s
H  127    13                    -118132.1697 -118145.99  0.01%   3.9    0s
*  132    13              13    -118132.3269 -118145.99  0.01%   3.9    0s
H  133    13                    -118142.7942 -118145.99  0.00%   3.8    0s

Cutting planes:
  Gomory: 36
  Implied bound: 8
  MIR: 129
  Flow cover: 12
  RLT: 52
  Relax-and-lift: 3
  BQP: 3

Explored 160 nodes (1188 simplex iterations) in 0.13 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118143 -118132 -118132 ... -105357
No other solutions better than -118143

Optimal solution found (tolerance 1.00e-06)
Best objective -1.181427942219e+05, best bound -1.181427942219e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 145311.58
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118142.79
  [DEBUG]   S×d_nominal = 263454.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 263454.37 + -118142.79 = 145311.58
  [DEBUG]   Current θ from Master = 157340.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12028.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4682.73
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 4509.9084, Absolute Gap = 4509.9084, Relative Gap = 0.269874
  Not converged yet (gap = 4509.91 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178539 nonzeros
Model fingerprint: 0x9fae0659
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 4682.73 (0.08s)
Loaded MIP start from previous solve with objective 4682.73

Presolve removed 25048 rows and 10168 columns
Presolve time: 0.58s
Presolved: 37495 rows, 17052 columns, 231879 nonzeros
Variable types: 14793 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37495 rows, 17052 columns, 231879 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   49858    2.6771616e+04   0.000000e+00   2.204668e+07      5s
Concurrent spin time: 1.51s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.696168e+04, 31741 iterations, 6.48 seconds (12.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36961.6808    0  112 4682.73124 36961.6808   689%     -    7s
H    0     0                    4712.4990314 36961.6808   684%     -    7s
H    0     0                    15428.425990 36961.6808   140%     -    7s
H    0     0                    15503.348715 36961.6808   138%     -    7s
H    0     0                    15541.583403 36961.6808   138%     -    7s
H    0     0                    15572.080247 36961.6808   137%     -    7s
H    0     0                    15605.434055 36961.6808   137%     -    7s
H    0     0                    15690.827202 36961.6808   136%     -    7s
H    0     0                    15776.452133 36961.6808   134%     -    7s
     0     0 32749.0541    0  213 15776.4521 32749.0541   108%     -   11s
     0     0 32145.8681    0  217 15776.4521 32145.8681   104%     -   12s
     0     0 32132.4329    0  216 15776.4521 32132.4329   104%     -   13s
     0     0 32132.4329    0  221 15776.4521 32132.4329   104%     -   13s
     0     0 32132.4329    0  222 15776.4521 32132.4329   104%     -   13s
     0     0 29698.4621    0  298 15776.4521 29698.4621  88.2%     -   17s
H    0     0                    15783.135082 29698.2027  88.2%     -   17s
H    0     0                    15853.121396 29698.2027  87.3%     -   17s
H    0     0                    16052.718379 29698.2027  85.0%     -   17s
     0     0 29121.7458    0  303 16052.7184 29121.7458  81.4%     -   19s
     0     0 28968.8822    0  303 16052.7184 28968.8822  80.5%     -   20s
     0     0 28816.0006    0  313 16052.7184 28816.0006  79.5%     -   21s
     0     0 28775.4656    0  312 16052.7184 28775.4656  79.3%     -   21s
     0     0 28761.8697    0  321 16052.7184 28761.8697  79.2%     -   21s
     0     0 28761.8697    0  321 16052.7184 28761.8697  79.2%     -   22s
H    0     0                    16133.083961 27209.1255  68.7%     -   27s
     0     0 27209.1255    0  294 16133.0840 27209.1255  68.7%     -   27s
     0     0 26713.2993    0  289 16133.0840 26713.2993  65.6%     -   29s
     0     0 26533.8101    0  309 16133.0840 26533.8101  64.5%     -   30s
     0     0 26467.9756    0  300 16133.0840 26467.9756  64.1%     -   32s
     0     0 26431.1176    0  411 16133.0840 26431.1176  63.8%     -   32s
     0     0 26395.4515    0  254 16133.0840 26395.4515  63.6%     -   33s
     0     0 26391.8269    0  311 16133.0840 26391.8269  63.6%     -   33s
     0     0 26387.3578    0  320 16133.0840 26387.3578  63.6%     -   33s
     0     0 26380.5771    0  361 16133.0840 26380.5771  63.5%     -   34s
     0     0 26380.0125    0  365 16133.0840 26380.0125  63.5%     -   34s
     0     0 25608.3493    0  354 16133.0840 25608.3493  58.7%     -   40s
     0     0 25453.8345    0  394 16133.0840 25453.8345  57.8%     -   42s
     0     0 25391.8459    0  447 16133.0840 25391.8459  57.4%     -   42s
     0     0 25375.7929    0  449 16133.0840 25375.7929  57.3%     -   43s
     0     0 25361.4277    0  447 16133.0840 25361.4277  57.2%     -   43s
     0     0 25353.3723    0  415 16133.0840 25353.3723  57.2%     -   44s
     0     0 25349.0998    0  351 16133.0840 25349.0998  57.1%     -   44s
     0     0 25349.0183    0  406 16133.0840 25349.0183  57.1%     -   44s
     0     0 25205.8498    0  392 16133.0840 25205.8498  56.2%     -   46s
     0     0 25171.6669    0  382 16133.0840 25171.6669  56.0%     -   47s
     0     0 25162.4258    0  398 16133.0840 25162.4258  56.0%     -   47s
     0     0 25158.9322    0  398 16133.0840 25158.9322  55.9%     -   47s
     0     0 25155.8485    0  392 16133.0840 25155.8485  55.9%     -   48s
     0     0 25154.2400    0  349 16133.0840 25154.2400  55.9%     -   48s
     0     0 25153.8298    0  343 16133.0840 25153.8298  55.9%     -   48s
     0     0 25095.0620    0  462 16133.0840 25095.0620  55.6%     -   50s
     0     0 25081.8181    0  450 16133.0840 25081.8181  55.5%     -   51s
     0     0 25079.4206    0  459 16133.0840 25079.4206  55.5%     -   51s
     0     0 25078.1477    0  419 16133.0840 25078.1477  55.4%     -   51s
     0     0 25047.0660    0  458 16133.0840 25047.0660  55.3%     -   52s
     0     0 25035.4645    0  456 16133.0840 25035.4645  55.2%     -   53s
     0     0 25032.1082    0  461 16133.0840 25032.1082  55.2%     -   53s
     0     0 25029.1936    0  468 16133.0840 25029.1936  55.1%     -   53s
     0     0 25027.7485    0  462 16133.0840 25027.7485  55.1%     -   54s
     0     0 25027.3958    0  465 16133.0840 25027.3958  55.1%     -   54s
     0     0 24970.4741    0  466 16133.0840 24970.4741  54.8%     -   55s
     0     0 24953.9114    0  467 16133.0840 24953.9114  54.7%     -   56s
     0     0 24950.3903    0  486 16133.0840 24950.3903  54.7%     -   57s
     0     0 24949.3711    0  479 16133.0840 24949.3711  54.6%     -   57s
     0     0 24942.8853    0  475 16133.0840 24942.8853  54.6%     -   58s
     0     0 24940.5866    0  435 16133.0840 24940.5866  54.6%     -   58s
     0     0 24940.4634    0  481 16133.0840 24940.4634  54.6%     -   58s
     0     0 24927.1310    0  433 16133.0840 24927.1310  54.5%     -   59s
     0     0 24921.7241    0  478 16133.0840 24921.7241  54.5%     -   61s
     0     0 24920.2933    0  436 16133.0840 24920.2933  54.5%     -   61s
     0     0 24909.9919    0  426 16133.0840 24909.9919  54.4%     -   62s
     0     0 24909.5639    0  296 16133.0840 24909.5639  54.4%     -   62s
     0     0 24908.7230    0  440 16133.0840 24908.7230  54.4%     -   63s
H    0     0                    16155.011888 24908.6511  54.2%     -   65s
     0     0 24908.6511    0  437 16155.0119 24908.6511  54.2%     -   65s
     0     0 24908.3503    0  435 16155.0119 24908.3503  54.2%     -   66s
     0     0 24907.5586    0  445 16155.0119 24907.5586  54.2%     -   66s
     0     0 24907.0052    0  429 16155.0119 24907.0052  54.2%     -   66s
     0     0 24906.9446    0  429 16155.0119 24906.9446  54.2%     -   67s
H    0     0                    16157.416188 24906.9337  54.2%     -   69s
     0     2 24906.9209    0  429 16157.4162 24906.9209  54.2%     -   74s
     1     4 24806.6186    1  431 16157.4162 24906.9209  54.2%  1912   76s
     7    16 24313.9665    3  479 16157.4162 24729.2749  53.1%  2177   82s
    15    32 23826.5995    4  499 16157.4162 24394.1263  51.0%  3166   85s
    31    59 23573.0540    5  384 16157.4162 23915.8613  48.0%  5013   90s
    63    70 22984.2877    6  355 16157.4162 23730.5027  46.9%  4714   98s
    76   142 22906.6167    7  433 16157.4162 23730.4373  46.9%  4844  106s
   164   169 22760.7898    9  438 16157.4162 23240.8078  43.8%  3920  111s
   201   192 22222.2977   10  459 16157.4162 23240.8078  43.8%  3564  115s
   284   257 21692.1486   12  387 16157.4162 23231.0946  43.8%  3139  123s
   321   292 21685.7029   13  375 16157.4162 23231.0946  43.8%  3016  127s
   362   333 21583.4649   14  295 16157.4162 23231.0946  43.8%  2852  130s
H  402   333                    16178.682782 23231.0946  43.6%  2711  130s
H  407   413                    16208.473317 23231.0946  43.3%  2692  137s
H  417   413                    16209.101116 23231.0946  43.3%  2664  137s
H  479   413                    16244.820154 23231.0946  43.0%  2494  137s
   501   484 20536.8350   17  282 16244.8202 23231.0946  43.0%  2439  141s
   613   500 19802.0290   20  286 16244.8202 23231.0946  43.0%  2176  145s
   717   601 19545.7822   22  337 16244.8202 23220.7366  42.9%  2036  153s
   798   640 19183.6994   23  263 16244.8202 23220.7366  42.9%  1951  157s
   889   658 19086.7298   24  271 16244.8202 23186.0641  42.7%  1863  160s
   941   698 17226.0981   25  148 16244.8202 23182.1834  42.7%  1806  165s
  1114   795 16619.1725   34  120 16244.8202 23182.1834  42.7%  1689  176s
  1232   880     cutoff   17      16244.8202 23080.6213  42.1%  1614  181s
  1365   937 16573.9396   10  244 16244.8202 23080.6213  42.1%  1541  188s
  1499  1007 16813.5798   11  212 16244.8202 23013.6235  41.7%  1484  194s
  1642  1037     cutoff   12      16244.8202 23013.6235  41.7%  1443  198s
  1766  1068 19049.2451   10  391 16244.8202 22843.3807  40.6%  1410  203s
  1881  1101 18886.7220   12  383 16244.8202 22843.3807  40.6%  1397  208s
  1992  1157 18064.5833   14  414 16244.8202 22819.7916  40.5%  1407  215s
  2261  1370 16834.5602   22  408 16244.8202 22795.0617  40.3%  1367  226s
  2468  1442 16692.2402   25  396 16244.8202 22795.0617  40.3%  1318  233s
  2702  1486 22031.5657    7  343 16244.8202 22445.2354  38.2%  1269  239s
  2860  1504 21176.1908   10  387 16244.8202 22445.2354  38.2%  1269  244s
  2922  1543 19059.5379   11  349 16244.8202 22350.3869  37.6%  1272  251s
  3037  1579 18945.4423   12  314 16244.8202 22315.4455  37.4%  1265  255s
  3172  1601 18897.5253   13  263 16244.8202 22291.5108  37.2%  1247  263s
  3322  1629 18501.4810   14  219 16244.8202 22156.2944  36.4%  1237  269s
  3450  1684 18335.3864   15  143 16244.8202 22031.7546  35.6%  1240  275s
  3609  1722 17454.4583   16  149 16244.8202 21968.7524  35.2%  1231  282s
  3728  1774 infeasible   17      16244.8202 21960.1826  35.2%  1240  289s
  3914  1818     cutoff   12      16244.8202 21809.5269  34.3%  1230  297s
  4145  1945 18929.9934   10  279 16244.8202 21694.9778  33.6%  1223  304s
  4422  2061 17830.8294   12  412 16244.8202 21694.9778  33.6%  1201  310s
  4707  2148     cutoff   15      16244.8202 21444.2240  32.0%  1185  320s
  5014  2259 16470.9304   16  362 16244.8202 21388.6009  31.7%  1172  329s
  5363  2381 infeasible   19      16244.8202 21388.6009  31.7%  1154  337s
  5782  2474 18112.8811   29  157 16244.8202 21173.4513  30.3%  1127  345s
  6186  2547     cutoff   34      16244.8202 20988.4536  29.2%  1104  352s
  6594  2659 19008.6369   18  217 16244.8202 20902.9080  28.7%  1085  360s
  7049  2747 16317.4586   32  122 16244.8202 20819.7342  28.2%  1065  370s
  7493  2810 16692.9269   36  101 16244.8202 20626.9161  27.0%  1049  378s
  7911  2952 17357.2441   14  432 16244.8202 20436.5848  25.8%  1043  388s
  8391  2953 16931.8842   24  429 16244.8202 20365.3123  25.4%  1031  401s
  8393  2954 16693.9268   48  112 16244.8202 20365.3123  25.4%  1031  407s
  8394  2955 16923.3226   32  286 16244.8202 20365.3123  25.4%  1031  414s
  8395  2956 17376.0255   14  341 16244.8202 20365.3123  25.4%  1030  417s
  8397  2957 20043.9204   16  429 16244.8202 20365.3123  25.4%  1030  421s
  8399  2958 19288.7176   19  438 16244.8202 20365.3123  25.4%  1030  426s
  8403  2961 17251.4499   25  426 16244.8202 20365.3123  25.4%  1029  430s
  8406  2963 16888.3957   15  420 16244.8202 20365.3123  25.4%  1029  435s
  8409  2965 17385.1201   20  406 16244.8202 20365.3123  25.4%  1029  440s
  8413  2968 17606.4411   27  417 16244.8202 20365.3123  25.4%  1028  451s
  8415  2972 20365.3123   16  229 16244.8202 20365.3123  25.4%  1037  462s
  8417  2975 20365.3123   17  499 16244.8202 20365.3123  25.4%  1038  468s
  8421  2982 20365.3123   18  518 16244.8202 20365.3123  25.4%  1038  473s
  8429  2995 20365.3123   19  520 16244.8202 20365.3123  25.4%  1043  479s
  8445  3008 20016.0587   20  269 16244.8202 20365.3123  25.4%  1051  488s
  8465  3029 20365.3123   21  345 16244.8202 20365.3123  25.4%  1067  494s
  8497  3101 20365.3123   22  344 16244.8202 20365.3123  25.4%  1071  502s
  8604  3111 20365.3123   24  336 16244.8202 20365.3123  25.4%  1097  509s
  8699  3112 20365.3123   23  340 16244.8202 20365.3123  25.4%  1105  514s
  8775  3126 20365.3123   25  289 16244.8202 20365.3123  25.4%  1108  519s
  8845  3142 20365.3123   24  440 16244.8202 20365.3123  25.4%  1113  525s
  9005  3137 20365.3123   25  328 16244.8202 20365.3123  25.4%  1117  532s
  9046  3151 20365.3123   25  176 16244.8202 20365.3123  25.4%  1118  536s
  9132  3157 17873.6405   26  137 16244.8202 20365.3123  25.4%  1123  544s
  9179  3150 20365.3123   26  282 16244.8202 20365.3123  25.4%  1124  548s
  9230  3147 17934.2880   26  184 16244.8202 20365.3123  25.4%  1125  552s
  9285  3141 19317.6931   27  172 16244.8202 20365.3123  25.4%  1127  557s
  9347  3141 19794.1664   27  273 16244.8202 20365.3123  25.4%  1128  562s
  9405  3127     cutoff   28      16244.8202 20365.3123  25.4%  1131  567s
  9484  3114 17687.3889   23  220 16244.8202 20365.3123  25.4%  1133  571s
  9565  3098 16451.9720   24  192 16244.8202 20365.3123  25.4%  1135  576s
  9654  3083     cutoff   26      16244.8202 20365.3123  25.4%  1138  583s
  9746  3064 20365.3123   23  182 16244.8202 20365.3123  25.4%  1143  588s
  9846  3036 19842.4448   25  333 16244.8202 20365.3123  25.4%  1145  595s
  9950  3010 19018.7287   27  234 16244.8202 20365.3123  25.4%  1151  601s
 10059  2981 17429.9172   31  112 16244.8202 20365.3123  25.4%  1156  606s
 10180  2953     cutoff   32      16244.8202 20365.3123  25.4%  1159  612s
 10321  2922     cutoff   25      16244.8202 20365.3123  25.4%  1161  618s
 10441  2878 16510.5161   29  322 16244.8202 20365.3123  25.4%  1167  624s
 10536  2842     cutoff   30      16244.8202 20365.3123  25.4%  1168  631s
 10643  2811 18938.2576   24  314 16244.8202 20365.3123  25.4%  1171  638s
 10765  2764 16445.8093   26  225 16244.8202 20365.3123  25.4%  1176  647s
 10922  2689 17054.8276   25  357 16244.8202 20365.3123  25.4%  1180  655s
 11094  2608     cutoff   28      16244.8202 20365.3123  25.4%  1183  661s
 11273  2490     cutoff   26      16244.8202 20131.8679  23.9%  1185  670s
 11491  2402 17399.0267   27  443 16244.8202 19900.9709  22.5%  1186  678s
 11696  2284 16286.6708   32  359 16244.8202 19900.9709  22.5%  1188  685s
 11931  2139 17679.9064   33  168 16244.8202 19434.0596  19.6%  1187  694s
 12176  1979 17513.2248   29  284 16244.8202 19199.1886  18.2%  1187  700s
 12410  1768     cutoff   31      16244.8202 19199.1886  18.2%  1180  708s
 12765  1561 infeasible   26      16244.8202 18382.5458  13.2%  1163  714s
 13010  1440 infeasible   31      16244.8202 18382.5458  13.2%  1151  717s

Cutting planes:
  MIR: 240
  Flow cover: 709
  RLT: 12
  Relax-and-lift: 67

Explored 13106 nodes (15110098 simplex iterations) in 717.92 seconds (2068.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 16244.8 16209.1 16208.5 ... 15783.1

Optimal solution found (tolerance 1.00e-06)
Best objective 1.624482015446e+04, best bound 1.624482015446e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 717.92s
  Master Objective (UB) = 16244.82, θ = 156443.52
  Upper Bound (UB) = 16244.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156443.52
  [DEBUG]   ✓ Scenario 0: θ = 156443.52 ≤ Q = 156443.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156443.52 ≤ Q = 156443.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156443.52 ≤ Q = 156443.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156443.52 ≤ Q = 156443.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7dd8a4c2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x82275b3e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.168791e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6341310.1031
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.402685e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140268.54    0  123 6341310.10 -140268.54   102%     -    0s
H    0     0                    -103466.7080 -140268.54  35.6%     -    0s
H    0     0                    -104857.9998 -140268.54  33.8%     -    0s
H    0     0                    -105596.0876 -140268.54  32.8%     -    0s
H    0     0                    -109051.8265 -140268.54  28.6%     -    0s
     0     0 -121739.25    0  103 -109051.83 -121739.25  11.6%     -    0s
H    0     0                    -118265.1374 -121653.42  2.86%     -    0s
H    0     0                    -119396.2132 -121653.42  1.89%     -    0s
     0     0 -120809.40    0  102 -119396.21 -120809.40  1.18%     -    0s
H    0     0                    -119949.6355 -120796.13  0.71%     -    0s
     0     0 -120660.45    0  102 -119949.64 -120660.45  0.59%     -    0s
     0     0 -120607.73    0  102 -119949.64 -120607.73  0.55%     -    0s
     0     0 -120468.59    0   31 -119949.64 -120468.59  0.43%     -    0s
     0     0 -120371.94    0   38 -119949.64 -120371.94  0.35%     -    0s
     0     0 -120228.29    0   29 -119949.64 -120228.29  0.23%     -    0s
     0     0 -120228.24    0   29 -119949.64 -120228.24  0.23%     -    0s
     0     0 -120131.68    0   17 -119949.64 -120131.68  0.15%     -    0s
H    0     0                    -119986.6391 -120116.19  0.11%     -    0s
     0     0 -120116.19    0   15 -119986.64 -120116.19  0.11%     -    0s
     0     0 -120098.78    0   12 -119986.64 -120098.78  0.09%     -    0s
     0     0 -120098.78    0   13 -119986.64 -120098.78  0.09%     -    0s
H    0     0                    -119987.7382 -120098.78  0.09%     -    0s
     0     0 -120070.67    0    8 -119987.74 -120070.67  0.07%     -    0s
H    0     0                    -119991.9269 -120065.90  0.06%     -    0s
     0     0 -120061.46    0    9 -119991.93 -120061.46  0.06%     -    0s
H    0     0                    -119993.7898 -120059.95  0.06%     -    0s
     0     0 -120059.95    0    8 -119993.79 -120059.95  0.06%     -    0s
H    0     0                    -120017.3296 -120059.95  0.04%     -    0s
     0     0 -120026.92    0    4 -120017.33 -120026.92  0.01%     -    0s
     0     0 -120019.75    0    5 -120017.33 -120019.75  0.00%     -    0s
     0     0 -120017.59    0    2 -120017.33 -120017.59  0.00%     -    0s

Cutting planes:
  MIR: 2
  RLT: 1

Explored 1 nodes (903 simplex iterations) in 0.15 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120017 -119994 -119992 ... -105596
No other solutions better than -120017

Optimal solution found (tolerance 1.00e-06)
Best objective -1.200173295814e+05, best bound -1.200173295814e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 143796.23
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120017.33
  [DEBUG]   S×d_nominal = 263813.56
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 263813.56 + -120017.33 = 143796.23
  [DEBUG]   Current θ from Master = 156443.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12647.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3597.53
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 4043.5354, Absolute Gap = 4043.5354, Relative Gap = 0.248912
  Not converged yet (gap = 4043.54 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221794 nonzeros
Model fingerprint: 0xe6bad702
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31310 rows and 12710 columns
Presolve time: 0.72s
Presolved: 46523 rows, 20750 columns, 288469 nonzeros
Variable types: 18491 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -221895.3170

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46523 rows, 20750 columns, 288469 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31788    7.8989044e+03   0.000000e+00   7.505626e+07      5s
   44557    3.0224504e+04   0.000000e+00   5.480459e+06     10s
Concurrent spin time: 0.29s

Solved with dual simplex

Root relaxation: objective 3.694087e+04, 31951 iterations, 12.50 seconds (24.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36940.8673    0  113 -221895.32 36940.8673   117%     -   13s
H    0     0                    -213985.6062 36940.8673   117%     -   13s
H    0     0                    -149632.2198 36940.8673   125%     -   13s
H    0     0                    -111599.0963 36940.8673   133%     -   13s
H    0     0                    -87663.34206 36940.8673   142%     -   13s
H    0     0                    -85344.05500 36940.8673   143%     -   13s
H    0     0                    -85105.75889 36940.8673   143%     -   13s
H    0     0                    -84287.24780 36940.8673   144%     -   13s
H    0     0                    -81147.47395 36940.8673   146%     -   13s
H    0     0                    -80209.82476 36940.8673   146%     -   13s
H    0     0                    -57615.37050 36940.8673   164%     -   14s
H    0     0                    1127.3817727 36940.8673  3177%     -   14s
H    0     0                    2870.2381424 36940.8673  1187%     -   14s
H    0     0                    12309.454134 36940.8673   200%     -   14s
H    0     0                    12924.940271 36940.8673   186%     -   14s
H    0     0                    13359.706726 36940.8673   177%     -   14s
     0     0 31858.8407    0  210 13359.7067 31858.8407   138%     -   21s
     0     0 31857.7417    0  224 13359.7067 31857.7417   138%     -   25s
     0     0 31857.7417    0  230 13359.7067 31857.7417   138%     -   25s
     0     0 29082.2539    0  227 13359.7067 29082.2539   118%     -   25s
     0     0 29082.2539    0  227 13359.7067 29082.2539   118%     -   26s
     0     0 29043.6846    0  325 13359.7067 29043.6846   117%     -   31s
H    0     0                    13783.565057 29043.4157   111%     -   32s
     0     0 28482.9683    0  318 13783.5651 28482.9683   107%     -   35s
     0     0 28384.7182    0  326 13783.5651 28384.7182   106%     -   36s
     0     0 28371.6519    0  330 13783.5651 28371.6519   106%     -   37s
     0     0 28354.0218    0  335 13783.5651 28354.0218   106%     -   37s
     0     0 28344.0461    0  334 13783.5651 28344.0461   106%     -   38s
     0     0 28342.5755    0  340 13783.5651 28342.5755   106%     -   38s
     0     0 28342.5752    0  341 13783.5651 28342.5752   106%     -   38s
     0     0 27121.2687    0  399 13783.5651 27121.2687  96.8%     -   46s
H    0     0                    14147.000376 27121.1287  91.7%     -   46s
H    0     0                    14165.917354 27121.1287  91.5%     -   46s
H    0     0                    14389.496810 27121.1287  88.5%     -   46s
     0     0 26724.4988    0  403 14389.4968 26724.4988  85.7%     -   49s
     0     0 26599.3276    0  350 14389.4968 26599.3276  84.9%     -   51s
     0     0 26506.7656    0  419 14389.4968 26506.7656  84.2%     -   52s
     0     0 26468.5150    0  364 14389.4968 26468.5150  83.9%     -   53s
     0     0 26451.2460    0  366 14389.4968 26451.2460  83.8%     -   53s
     0     0 26436.9649    0  374 14389.4968 26436.9649  83.7%     -   53s
     0     0 26426.0272    0  373 14389.4968 26426.0272  83.6%     -   54s
     0     0 26419.4726    0  374 14389.4968 26419.4726  83.6%     -   54s
     0     0 26396.8179    0  386 14389.4968 26396.8179  83.4%     -   55s
     0     0 26394.5883    0  381 14389.4968 26394.5883  83.4%     -   55s
     0     0 26393.4607    0  385 14389.4968 26393.4607  83.4%     -   55s
     0     0 26393.4392    0  388 14389.4968 26393.4392  83.4%     -   55s
     0     0 25593.5007    0  417 14389.4968 25593.5007  77.9%     -   64s
     0     0 25447.9487    0  406 14389.4968 25447.9487  76.9%     -   66s
     0     0 25352.6883    0  347 14389.4968 25352.6883  76.2%     -   68s
     0     0 25309.3765    0  417 14389.4968 25309.3765  75.9%     -   70s
     0     0 25292.6442    0  402 14389.4968 25292.6442  75.8%     -   71s
     0     0 25286.0561    0  406 14389.4968 25286.0561  75.7%     -   72s
     0     0 25279.9275    0  411 14389.4968 25279.9275  75.7%     -   72s
     0     0 25274.5292    0  441 14389.4968 25274.5292  75.6%     -   73s
     0     0 25273.3413    0  407 14389.4968 25273.3413  75.6%     -   73s
     0     0 25205.8719    0  400 14389.4968 25205.8719  75.2%     -   75s
     0     0 25187.9850    0  403 14389.4968 25187.9850  75.0%     -   77s
     0     0 25172.0512    0  420 14389.4968 25172.0512  74.9%     -   78s
     0     0 25170.7345    0  413 14389.4968 25170.7345  74.9%     -   78s
     0     0 25137.7016    0  358 14389.4968 25137.7016  74.7%     -   80s
     0     0 25133.3369    0  360 14389.4968 25133.3369  74.7%     -   81s
     0     0 25130.7618    0  400 14389.4968 25130.7618  74.6%     -   81s
     0     0 25129.7594    0  403 14389.4968 25129.7594  74.6%     -   81s
     0     0 25118.5651    0  405 14389.4968 25118.5651  74.6%     -   83s
     0     0 25111.8874    0  416 14389.4968 25111.8874  74.5%     -   83s
     0     0 25110.6770    0  417 14389.4968 25110.6770  74.5%     -   84s
     0     0 25108.8628    0  467 14389.4968 25108.8628  74.5%     -   85s
     0     0 25107.0578    0  382 14389.4968 25107.0578  74.5%     -   86s
     0     0 25105.0556    0  424 14389.4968 25105.0556  74.5%     -   86s
     0     0 25103.0755    0  418 14389.4968 25103.0755  74.5%     -   86s
     0     0 25102.7280    0  426 14389.4968 25102.7280  74.5%     -   87s
     0     0 25092.7209    0  467 14389.4968 25092.7209  74.4%     -   88s
     0     0 25091.8048    0  470 14389.4968 25091.8048  74.4%     -   89s
     0     0 25089.6246    0  379 14389.4968 25089.6246  74.4%     -   90s
     0     0 25088.9598    0  431 14389.4968 25088.9598  74.4%     -   90s
     0     0 25086.7000    0  384 14389.4968 25086.7000  74.3%     -   91s
     0     0 25085.6285    0  378 14389.4968 25085.6285  74.3%     -   92s
     0     0 25083.7612    0  378 14389.4968 25083.7612  74.3%     -   92s
H    0     0                    14454.803991 25083.6114  73.5%     -   93s
H    0     0                    14454.901996 25083.6114  73.5%     -   93s
     0     0 25083.5559    0  382 14454.9020 25083.5559  73.5%     -   93s
     0     0 25083.3297    0  376 14454.9020 25083.3297  73.5%     -   94s
     0     0 25082.8099    0  376 14454.9020 25082.8099  73.5%     -   94s
H    0     0                    14499.047895 25082.8099  73.0%     -   99s
     0     2 25082.8099    0  376 14499.0479 25082.8099  73.0%     -  102s
     1     4 24899.2185    1  366 14499.0479 25082.1368  73.0%  4688  109s
     3     8 24733.3098    2  312 14499.0479 24898.4035  71.7%  7248  112s
     7    16 24317.4098    3  426 14499.0479 24731.9547  70.6%  5428  116s
    15    32 24101.3706    4  419 14499.0479 24317.1181  67.7%  4820  122s
    31    50 22746.6212    5  258 14499.0479 24101.0146  66.2%  5525  182s
    49    82 21808.0069    6  281 14499.0479 24101.0126  66.2%  6636  187s
H   52    82                    14596.183449 24101.0126  65.1%  6448  187s
    81   176 21770.6171    7  269 14596.1834 24101.0126  65.1%  4924  193s
H  177   313                    14596.281455 24101.0126  65.1%  2736  198s
   317   405 21429.8260    9  248 14596.2815 24101.0126  65.1%  1922  203s
   428   452 21192.6605   11  244 14596.2815 24101.0126  65.1%  1663  209s
   500   513 21046.9294   10  244 14596.2815 24101.0126  65.1%  1620  215s
   583   567 21232.0457   12  250 14596.2815 24101.0126  65.1%  1541  220s
   659   583 20686.4855   12  230 14596.2815 24027.4557  64.6%  1490  226s
   699   620 20663.2003   12  238 14596.2815 24027.1956  64.6%  1490  232s
   738   659 20668.2063   12  253 14596.2815 24027.1956  64.6%  1511  235s
   787   704 20190.0323   13  230 14596.2815 23980.0719  64.3%  1490  240s
   842   756 20969.9751   13  222 14596.2815 23838.1727  63.3%  1457  245s
   959   841 20602.7663   15  208 14596.2815 23790.4668  63.0%  1405  252s
  1023   875 20443.2626   17  202 14596.2815 23790.4668  63.0%  1387  255s
  1140   986 20241.6541   19  213 14596.2815 23790.4668  63.0%  1363  264s
  1212  1052 19537.3826   21  198 14596.2815 23790.4668  63.0%  1337  268s
  1306  1097 19824.1221   22  205 14596.2815 23790.4668  63.0%  1292  273s
  1391  1157 19864.3106   21  213 14596.2815 23790.4668  63.0%  1279  277s
  1518  1223 19382.5230   25  275 14596.2815 23790.4668  63.0%  1262  282s
  1599  1283 19269.5673   24  201 14596.2815 23790.4668  63.0%  1268  289s
  1642  1317 19191.6425   27  280 14596.2815 23790.4668  63.0%  1270  293s
H 1688  1317                    14870.381294 23790.4668  60.0%  1267  293s
  1694  1386 19100.2330   28  248 14870.3813 23790.4668  60.0%  1273  301s
  1803  1474 18912.1068   30  204 14870.3813 23790.4668  60.0%  1262  306s
  1923  1565 infeasible   30      14870.3813 23790.4668  60.0%  1254  311s
  2040  1660     cutoff   31      14870.3813 23790.4668  60.0%  1258  316s
  2193  1764 18509.7253   35  225 14870.3813 23790.4668  60.0%  1228  324s
H 2337  1798                    14932.414212 23198.7222  55.4%  1221  332s
H 2342  1787                    15187.541429 23198.7222  52.7%  1221  332s
  2418  1842 16496.0666   37  257 15187.5414 23191.3371  52.7%  1213  338s
  2532  1909 17566.2290   40  303 15187.5414 23191.3371  52.7%  1226  345s
  2644  2001 17370.5461   43  280 15187.5414 23191.3371  52.7%  1248  351s
  2767  2077 16957.8779   47  288 15187.5414 23191.3371  52.7%  1256  358s
  2925  2169 16550.0449   51  279 15187.5414 23191.3371  52.7%  1252  365s
  3077  2307 16319.2146   52  284 15187.5414 23191.3371  52.7%  1259  372s
  3243  2445 15719.6689   56  295 15187.5414 23191.3371  52.7%  1257  378s
  3446  2473 15952.6859   56  266 15187.5414 22856.4308  50.5%  1239  385s
  3494  2528 15717.9020   58  264 15187.5414 22856.4308  50.5%  1247  393s
H 3504  2523                    15204.463752 22856.4308  50.3%  1245  393s
H 3522  2514                    15235.703283 22856.4308  50.0%  1245  393s
H 3574  2511                    15258.893795 22856.4308  49.8%  1248  393s
H 3585  2506                    15268.128366 22856.4308  49.7%  1250  393s
  3586  2653 21749.5057   14  349 15268.1284 22856.4308  49.7%  1251  402s
  3788  2654 19664.2618   37  376 15268.1284 22845.8411  49.6%  1243  421s
  3790  2655 17335.5802   59  113 15268.1284 22845.8411  49.6%  1242  438s
H 3790  2522                    15580.504064 22845.8411  46.6%  1242  449s
H 3790  2396                    15723.757099 22845.8411  45.3%  1242  449s
  3792  2398 19359.7532   30  394 15723.7571 22845.8411  45.3%  1242  457s
  3793  2398 20165.3311   20  389 15723.7571 22845.8411  45.3%  1241  463s
  3794  2399 17356.0294   47  380 15723.7571 22845.8411  45.3%  1241  468s
  3795  2400 17773.2219   45  401 15723.7571 22845.8411  45.3%  1241  471s
  3797  2401 16938.8020   13  482 15723.7571 22845.8411  45.3%  1240  475s
  3799  2402 20591.8436   11  463 15723.7571 22845.8411  45.3%  1239  480s
  3801  2404 19855.8010   15  428 15723.7571 22845.8411  45.3%  1239  487s
  3803  2405 15723.7571   12  367 15723.7571 22845.8411  45.3%  1238  491s
  3804  2406 18229.0372   24  447 15723.7571 22845.8411  45.3%  1238  495s
  3808  2408 21168.0124   13  406 15723.7571 22845.8411  45.3%  1237  501s
  3810  2410 21395.5656   14  434 15723.7571 22845.8411  45.3%  1236  505s
  3812  2411 21645.0196    5  417 15723.7571 22845.8411  45.3%  1235  511s
  3814  2412 18394.3836   30  368 15723.7571 22845.8411  45.3%  1235  516s
  3816  2414 19447.5728   33  433 15723.7571 22845.8411  45.3%  1234  520s
  3818  2415 21539.2912   14  425 15723.7571 22845.8411  45.3%  1233  526s
  3820  2416 15803.9914   45  345 15723.7571 22845.8411  45.3%  1233  531s
  3823  2418 17632.1468   23  364 15723.7571 22845.8411  45.3%  1232  552s
  3824  2419 21258.8013   14  364 15723.7571 22845.8411  45.3%  1231  559s
  3825  2423 22845.8411   10  394 15723.7571 22845.8411  45.3%  1274  570s
  3827  2426 22845.8411   11  387 15723.7571 22845.8411  45.3%  1275  578s
  3831  2433 22845.8411   12  400 15723.7571 22845.8411  45.3%  1278  586s
  3839  2446 22845.8411   13  410 15723.7571 22845.8411  45.3%  1287  594s
  3855  2457 22845.8411   14  423 15723.7571 22845.8411  45.3%  1312  609s
  3871  2483 22845.8411   15  420 15723.7571 22845.8411  45.3%  1327  621s
  3903  2492 22414.2023   16  314 15723.7571 22845.8411  45.3%  1341  631s
H 3911  2367                    15802.952759 22845.8411  44.6%  1348  631s
  3942  2408 22143.9288   17  380 15802.9528 22845.8411  44.6%  1382  643s
  4077  2388 21497.5573   20  394 15802.9528 22845.8411  44.6%  1422  653s
  4166  2392 19993.8252   21  167 15802.9528 22845.8411  44.6%  1464  660s
  4230  2416 19856.3164   22  164 15802.9528 22845.8411  44.6%  1497  668s
  4303  2432 18109.3005   23  103 15802.9528 22845.8411  44.6%  1526  673s
  4373  2447 19033.0912   23  186 15802.9528 22845.8411  44.6%  1547  680s
  4456  2441 18182.0558   23  108 15802.9528 22845.8411  44.6%  1563  688s
  4490  2451 18572.9420   23  188 15802.9528 22845.8411  44.6%  1570  696s
  4532  2458 17905.1643   24  103 15802.9528 22845.8411  44.6%  1582  703s
  4572  2466 17895.6980   25   95 15802.9528 22845.8411  44.6%  1599  707s
  4607  2465     cutoff   26      15802.9528 22845.8411  44.6%  1603  719s
  4654  2463     cutoff   24      15802.9528 22845.8411  44.6%  1611  727s
  4700  2464 20274.6908   19  366 15802.9528 22845.8411  44.6%  1630  735s
  4763  2456 20784.3944   19  347 15802.9528 22792.5688  44.2%  1637  743s
  4820  2458 20541.6121   20  346 15802.9528 22792.4617  44.2%  1669  750s
  4877  2462 20440.1767   21  328 15802.9528 22792.4617  44.2%  1688  760s
  4932  2467 20138.9588   22  257 15802.9528 22792.4617  44.2%  1714  768s
  4987  2475 19942.0598   23  337 15802.9528 22792.4617  44.2%  1743  776s
  5061  2463 20046.9583   20  381 15802.9528 22792.4617  44.2%  1748  785s
  5154  2450 19914.6984   22  343 15802.9528 22792.4617  44.2%  1761  794s
  5242  2433 19676.1427   23  346 15802.9528 22792.4617  44.2%  1786  804s
  5339  2447 19828.9884   21  352 15802.9528 22693.7580  43.6%  1798  813s
  5450  2455 16038.1853   20  403 15802.9528 22693.7580  43.6%  1818  821s
  5585  2463 19626.0335   24  229 15802.9528 22693.7580  43.6%  1829  832s
  5726  2438 18864.2136   25  288 15802.9528 22693.7580  43.6%  1839  842s
  5871  2417     cutoff   23      15802.9528 21527.8029  36.2%  1847  853s
  6002  2425 17198.3744   26   67 15802.9528 21525.0450  36.2%  1879  864s
  6131  2441 16565.3861   28  136 15802.9528 21525.0450  36.2%  1897  875s
  6318  2408 17434.0263   29  325 15802.9528 21525.0450  36.2%  1900  887s
  6493  2410 17418.5582   30  274 15802.9528 21260.7416  34.5%  1917  896s
  6642  2415 16547.4385   36  230 15802.9528 21210.7922  34.2%  1939  907s
  6832  2405 16402.5899   35  221 15802.9528 21067.5583  33.3%  1948  918s
  7036  2366 18161.9125   23  157 15802.9528 20647.1197  30.7%  1952  931s
  7243  2353     cutoff   21      15802.9528 20647.1197  30.7%  1964  944s
  7446  2328     cutoff   35      15802.9528 20227.0190  28.0%  1979  956s
  7668  2276 17038.6402   26   77 15802.9528 20227.0190  28.0%  1991  971s
  7898  2221 17367.7158   30  270 15802.9528 19833.7807  25.5%  1994  985s
  8132  2188 17024.2822   26   80 15802.9528 19768.9740  25.1%  2009  999s
  8381  2102 16151.4315   23  143 15802.9528 19450.4093  23.1%  2024 1015s
  8669  1979     cutoff   21      15802.9528 19370.3075  22.6%  2030 1029s
  8975  1824 17747.4866   27  296 15802.9528 19274.1093  22.0%  2037 1044s
  9277  1706 15985.0927   32  269 15802.9528 19062.5097  20.6%  2036 1059s
  9605  1583 15860.5672   18  398 15802.9528 18773.1795  18.8%  2041 1072s
  9964  1429 16961.6394   32  161 15802.9528 18547.8165  17.4%  2045 1089s
 10355  1240 15867.3303   33  281 15802.9528 18326.2079  16.0%  2043 1105s
 10644  1016 16114.1529   43  163 15802.9528 18092.7110  14.5%  2050 1122s
 11051   820     cutoff   34      15802.9528 17966.0706  13.7%  2059 1140s
*11451   820              61    15816.978960 17702.4669  11.9%  2048 1140s
 11634   546 infeasible   32      15816.9790 17620.9186  11.4%  2040 1157s
 12259   243 16374.5188   29  279 15816.9790 17352.3238  9.71%  2015 1171s
 13326   529 infeasible   21      15816.9790 17009.5007  7.54%  1910 1177s
*15680   791              58    15818.760718 16027.4400  1.32%  1634 1179s
*15696   791              50    15862.312307 16026.8568  1.04%  1633 1179s
 17158     0     cutoff   51      15862.3123 15992.0468  0.82%  1497 1181s

Cutting planes:
  Gomory: 5
  Lift-and-project: 2
  MIR: 496
  Flow cover: 1333
  RLT: 19
  Relax-and-lift: 92

Explored 18609 nodes (25868423 simplex iterations) in 1181.68 seconds (3252.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15862.3 15818.8 15817 ... 15204.5

Optimal solution found (tolerance 1.00e-06)
Best objective 1.586231230745e+04, best bound 1.586231230745e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1181.70s
  Master Objective (UB) = 15862.31, θ = 157317.54
  Upper Bound (UB) = 15862.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157317.54
  [DEBUG]   ✓ Scenario 0: θ = 157317.54 ≤ Q = 157317.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157317.54 ≤ Q = 157317.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157317.54 ≤ Q = 157317.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157317.54 ≤ Q = 157317.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157317.54 ≤ Q = 157317.54 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x75da73b4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8a258c4c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.168583e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6338044.4065
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.394713e+05, 281 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139471.31    0  139 6338044.41 -139471.31   102%     -    0s
H    0     0                    -95798.88372 -139471.31  45.6%     -    0s
H    0     0                    -97215.78978 -139471.31  43.5%     -    0s
H    0     0                    -109316.0593 -139471.31  27.6%     -    0s
H    0     0                    -119236.5975 -139471.31  17.0%     -    0s
H    0     0                    -122174.6369 -124914.46  2.24%     -    0s
     0     0 -124914.46    0  101 -122174.64 -124914.46  2.24%     -    0s
H    0     0                    -122453.4170 -124831.34  1.94%     -    0s
H    0     0                    -122912.5560 -124831.34  1.56%     -    0s
H    0     0                    -123191.3361 -124831.34  1.33%     -    0s
     0     0 -124069.56    0   98 -123191.34 -124069.56  0.71%     -    0s
     0     0 -124063.93    0   99 -123191.34 -124063.93  0.71%     -    0s
     0     0 -123608.36    0   37 -123191.34 -123608.36  0.34%     -    0s
H    0     0                    -123240.6084 -123571.66  0.27%     -    0s
     0     0 -123571.66    0   37 -123240.61 -123571.66  0.27%     -    0s
     0     0 -123571.66    0   37 -123240.61 -123571.66  0.27%     -    0s
     0     0 -123375.72    0   22 -123240.61 -123375.72  0.11%     -    0s
     0     0 -123326.87    0   13 -123240.61 -123326.87  0.07%     -    0s
     0     0 -123285.17    0    7 -123240.61 -123285.17  0.04%     -    0s
     0     0 -123278.17    0    5 -123240.61 -123278.17  0.03%     -    0s
     0     0 -123261.43    0    5 -123240.61 -123261.43  0.02%     -    0s
     0     0 -123257.56    0    4 -123240.61 -123257.56  0.01%     -    0s
     0     0 -123252.49    0    3 -123240.61 -123252.49  0.01%     -    0s
     0     0 -123247.74    0    2 -123240.61 -123247.74  0.01%     -    0s
     0     0 -123243.53    0    1 -123240.61 -123243.53  0.00%     -    0s
     0     0     cutoff    0      -123240.61 -123240.61  0.00%     -    0s

Explored 1 nodes (735 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123241 -123232 -123232 ... 6.33804e+06
No other solutions better than -123241

Optimal solution found (tolerance 1.00e-06)
Best objective -1.232406083827e+05, best bound -1.232406083827e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 138819.38
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123240.61
  [DEBUG]   S×d_nominal = 262059.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262059.99 + -123240.61 = 138819.38
  [DEBUG]   Current θ from Master = 157317.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18498.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2635.84
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 3661.0275, Absolute Gap = 3661.0275, Relative Gap = 0.230800
  Not converged yet (gap = 3661.03 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265049 nonzeros
Model fingerprint: 0x58032c13
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37572 rows and 15252 columns
Presolve time: 0.87s
Presolved: 55551 rows, 24448 columns, 345059 nonzeros
Variable types: 22189 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -221895.3170

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 55551 rows, 24448 columns, 345059 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31913    5.4500832e+03   0.000000e+00   1.996568e+07      5s
   45778    1.7269007e+04   0.000000e+00   1.656306e+08     10s
Concurrent spin time: 0.05s

Solved with dual simplex

Root relaxation: objective 3.680957e+04, 35382 iterations, 12.40 seconds (27.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36809.5687    0  110 -221895.32 36809.5687   117%     -   13s
H    0     0                    -209107.9354 36809.5687   118%     -   13s
H    0     0                    -146465.8964 36809.5687   125%     -   13s
H    0     0                    -145767.7652 36809.5687   125%     -   13s
H    0     0                    -102421.2260 36809.5687   136%     -   13s
H    0     0                    -95583.57018 36809.5687   139%     -   13s
H    0     0                    -58144.77072 36809.5687   163%     -   13s
H    0     0                    1779.1484261 36809.5687  1969%     -   14s
H    0     0                    11293.212248 36809.5687   226%     -   14s
H    0     0                    12427.022138 36809.5687   196%     -   14s
H    0     0                    12508.162072 36809.5687   194%     -   14s
H    0     0                    12544.821275 36809.5687   193%     -   14s
H    0     0                    12545.295179 36809.5687   193%     -   14s
H    0     0                    12567.315233 36809.5687   193%     -   14s
H    0     0                    12842.923991 36809.5687   187%     -   14s
H    0     0                    12880.696366 36809.5687   186%     -   14s
H    0     0                    12933.756746 32218.2737   149%     -   22s
     0     0 31914.8535    0  194 12933.7567 31914.8535   147%     -   22s
H    0     0                    12978.000650 31914.8535   146%     -   22s
     0     0 31914.8535    0  210 12978.0007 31914.8535   146%     -   25s
     0     0 31914.8535    0  205 12978.0007 31914.8535   146%     -   26s
     0     0 28497.0880    0  276 12978.0007 28497.0880   120%     -   35s
     0     0 27936.2767    0  323 12978.0007 27936.2767   115%     -   41s
H    0     0                    13034.983773 27790.0991   113%     -   44s
     0     0 27790.0991    0  327 13034.9838 27790.0991   113%     -   44s
     0     0 27748.2851    0  320 13034.9838 27748.2851   113%     -   45s
     0     0 27696.4381    0  321 13034.9838 27696.4381   112%     -   46s
     0     0 27687.3891    0  328 13034.9838 27687.3891   112%     -   46s
     0     0 27685.6558    0  328 13034.9838 27685.6558   112%     -   46s
     0     0 27682.3255    0  330 13034.9838 27682.3255   112%     -   47s
     0     0 27682.2190    0  330 13034.9838 27682.2190   112%     -   47s
     0     0 26867.4862    0  308 13034.9838 26867.4862   106%     -   57s
H    0     0                    13079.227678 26866.4968   105%     -   57s
     0     0 26602.5869    0  314 13079.2277 26602.5869   103%     -   61s
     0     0 26495.6356    0  311 13079.2277 26495.6356   103%     -   64s
     0     0 26390.7601    0  252 13079.2277 26390.7601   102%     -   67s
     0     0 26349.5771    0  364 13079.2277 26349.5771   101%     -   69s
     0     0 26321.6787    0  318 13079.2277 26321.6787   101%     -   71s
     0     0 26307.5780    0  375 13079.2277 26307.5780   101%     -   72s
     0     0 26287.4748    0  367 13079.2277 26287.4748   101%     -   73s
     0     0 26268.5902    0  323 13079.2277 26268.5902   101%     -   74s
     0     0 26258.6267    0  373 13079.2277 26258.6267   101%     -   75s
     0     0 26255.6043    0  330 13079.2277 26255.6043   101%     -   75s
     0     0 26255.0992    0  328 13079.2277 26255.0992   101%     -   75s
H    0     0                    13171.546585 25615.4574  94.5%     -   83s
H    0     0                    13209.318960 25615.4574  93.9%     -   83s
     0     0 25615.4574    0  396 13209.3190 25615.4574  93.9%     -   83s
     0     0 25532.6555    0  407 13209.3190 25532.6555  93.3%     -   87s
     0     0 25456.6799    0  342 13209.3190 25456.6799  92.7%     -   91s
     0     0 25437.0345    0  384 13209.3190 25437.0345  92.6%     -   93s
     0     0 25424.0197    0  347 13209.3190 25424.0197  92.5%     -   94s
     0     0 25407.2387    0  395 13209.3190 25407.2387  92.3%     -   95s
     0     0 25402.3767    0  348 13209.3190 25402.3767  92.3%     -   96s
     0     0 25401.7704    0  355 13209.3190 25401.7704  92.3%     -   96s
     0     0 25332.6689    0  325 13209.3190 25332.6689  91.8%     -   99s
     0     0 25296.5836    0  435 13209.3190 25296.5836  91.5%     -  102s
     0     0 25291.9877    0  430 13209.3190 25291.9877  91.5%     -  103s
     0     0 25290.7414    0  428 13209.3190 25290.7414  91.5%     -  104s
     0     0 25223.2368    0  397 13209.3190 25223.2368  91.0%     -  108s
H    0     0                    13436.070860 25221.8135  87.7%     -  110s
H    0     0                    13954.851411 25221.8135  80.7%     -  110s
     0     0 25202.1955    0  396 13954.8514 25202.1955  80.6%     -  111s
     0     0 25196.6442    0  392 13954.8514 25196.6442  80.6%     -  112s
     0     0 25193.5381    0  415 13954.8514 25193.5381  80.5%     -  113s
     0     0 25191.0258    0  402 13954.8514 25191.0258  80.5%     -  114s
     0     0 25189.7793    0  402 13954.8514 25189.7793  80.5%     -  115s
     0     0 25172.9758    0  449 13954.8514 25172.9758  80.4%     -  117s
H    0     0                    13975.020402 25172.6085  80.1%     -  117s
     0     0 25166.3961    0  404 13975.0204 25166.3961  80.1%     -  119s
     0     0 25164.3935    0  426 13975.0204 25164.3935  80.1%     -  120s
     0     0 25161.9635    0  408 13975.0204 25161.9635  80.0%     -  121s
     0     0 25160.9095    0  411 13975.0204 25160.9095  80.0%     -  121s
     0     0 25143.1023    0  417 13975.0204 25143.1023  79.9%     -  124s
H    0     0                    14012.046192 25142.9773  79.4%     -  126s
     0     0 25137.0459    0  410 14012.0462 25137.0459  79.4%     -  127s
     0     0 25135.3962    0  467 14012.0462 25135.3962  79.4%     -  128s
     0     0 25134.5660    0  425 14012.0462 25134.5660  79.4%     -  128s
     0     0 25120.8139    0  419 14012.0462 25120.8139  79.3%     -  130s
     0     0 25118.9089    0  426 14012.0462 25118.9089  79.3%     -  131s
     0     0 25118.3458    0  430 14012.0462 25118.3458  79.3%     -  132s
     0     0 25112.2594    0  426 14012.0462 25112.2594  79.2%     -  133s
     0     0 25109.5047    0  424 14012.0462 25109.5047  79.2%     -  134s
     0     0 25108.8314    0  430 14012.0462 25108.8314  79.2%     -  135s
     0     0 25107.1136    0  467 14012.0462 25107.1136  79.2%     -  136s
     0     0 25106.3637    0  462 14012.0462 25106.3637  79.2%     -  136s
     0     0 25106.2514    0  462 14012.0462 25106.2514  79.2%     -  137s
     0     0 25105.8606    0  462 14012.0462 25105.8606  79.2%     -  138s
H    0     0                    14033.131764 25105.8606  78.9%     -  142s
     0     2 25105.8606    0  462 14033.1318 25105.8606  78.9%     -  148s
     1     4 24832.9216    1  411 14033.1318 25105.8606  78.9%  3454  151s
     3     8 24736.6184    2  415 14033.1318 24832.8425  77.0%  3850  155s
     7    16 24042.2079    3  504 14033.1318 24727.7340  76.2%  4748  162s
    15    32 23948.4415    4  457 14033.1318 24041.9461  71.3%  5976  167s
    31    48 23317.4952    5  472 14033.1318 23947.7073  70.7%  6542  181s
    47    80 23566.2782    6  360 14033.1318 23947.7073  70.7%  7738  189s
    79   112 23520.2000    7  345 14033.1318 23947.7073  70.7%  5836  196s
H   91   112                    14046.928490 23947.7073  70.5%  5423  196s
H  111   237                    14066.459376 23947.7073  70.2%  5007  210s
H  123   237                    14119.058202 23947.7073  69.6%  4699  210s
H  136   237                    14233.100545 23947.7073  68.3%  4397  210s
   236   327 23397.1478   10  265 14233.1005 23947.7073  68.3%  3465  218s
   328   391 23330.6069   10  239 14233.1005 23947.7073  68.3%  3086  224s
   419   422 23208.4674    9  263 14233.1005 23947.7073  68.3%  2946  231s
   501   444 23356.6209   10  327 14233.1005 23947.7073  68.3%  2783  239s
   544   469 22797.3971   10  332 14233.1005 23947.7073  68.3%  2886  247s
   589   486 22865.5045   11  313 14233.1005 23947.7073  68.3%  3039  255s
   630   520 22771.5088   11  243 14233.1005 23947.7073  68.3%  3069  262s
   682   556 23172.9027   11  384 14233.1005 23947.7073  68.3%  3108  269s
   749   594 23043.4238   11  301 14233.1005 23947.7073  68.3%  3116  276s
   809   638 22666.3441   12  326 14233.1005 23947.7073  68.3%  3134  283s
   881   664 22458.0116   12  315 14233.1005 23947.7073  68.3%  3110  291s
   951   706 20319.3488   12  349 14233.1005 23947.7073  68.3%  3089  299s
  1021   764 22688.4140   12  243 14233.1005 23947.7073  68.3%  3089  307s
  1103   841 21967.5820   13  288 14233.1005 23947.7073  68.3%  3065  315s
H 1202   841                    14291.709612 23947.7073  67.6%  2997  315s
  1204   911 21564.6683   14  259 14291.7096 23947.7073  67.6%  3013  321s
H 1312   982                    14572.885667 23947.7073  64.3%  2963  329s
H 1315   982                    14848.727202 23947.7073  61.3%  2966  329s
H 1332   982                    14873.494069 23947.7073  61.0%  2943  329s
H 1351   982                    14968.388114 23947.7073  60.0%  2920  329s
H 1398   982                    15086.261791 23947.7073  58.7%  2879  329s
H 1413   982                    15198.119410 23947.7073  57.6%  2868  329s
  1429  1005 20473.5725   16  190 15198.1194 23947.7073  57.6%  2851  338s
  1540  1047 21218.5559   15  280 15198.1194 23947.7073  57.6%  2857  347s
  1646  1095 20963.3039   17  326 15198.1194 23947.7073  57.6%  2858  354s
  1728  1153 20641.8479   18  303 15198.1194 23947.7073  57.6%  2948  364s
  1830  1187 20422.0709   20  309 15198.1194 23947.7073  57.6%  2999  374s
H 1937  1214                    15214.720343 23947.7073  57.4%  3016  383s
H 2000  1214                    15654.712245 23708.5220  51.4%  3072  383s
  2010  1256 19689.4461   25  293 15654.7122 23708.5220  51.4%  3073  392s
  2105  1319     cutoff   26      15654.7122 23509.0409  50.2%  3137  401s
  2202  1362 18797.2561   34  156 15654.7122 23509.0409  50.2%  3204  409s
H 2219  1362                    15802.952759 23509.0409  48.8%  3204  409s
  2285  1448 18454.8735   37  143 15802.9528 23509.0409  48.8%  3223  420s
  2432  1560 18258.4036   46  126 15802.9528 23509.0409  48.8%  3204  430s
  2602  1682 17629.3854   56   39 15802.9528 23509.0409  48.8%  3145  440s
  2807  1738 17227.0441   66   30 15802.9528 23509.0409  48.8%  3085  450s
  2997  1746 20953.0608    9  314 15802.9528 23509.0409  48.8%  3063  461s
  3109  1754 19906.7994   10  291 15802.9528 23461.6471  48.5%  3085  471s
  3211  1751 19440.4433   11  245 15802.9528 23229.8154  47.0%  3114  483s
  3349  1758 17036.5554   14  250 15802.9528 23136.0369  46.4%  3145  496s
  3471  1768 16320.8890   16  223 15802.9528 22896.7370  44.9%  3205  510s
  3589  1808 22142.2688    7  302 15802.9528 22876.6201  44.8%  3252  522s
  3747  1853 21091.2431    9  371 15802.9528 22814.2554  44.4%  3277  535s
  3912  1880 19911.8466   12  300 15802.9528 22814.2554  44.4%  3302  547s
  4072  1922 18912.6605   15  319 15802.9528 22740.2180  43.9%  3340  562s
  4238  1943 17700.8968   21  284 15802.9528 22738.6296  43.9%  3372  575s
  4285  1962 17548.0101   22  240 15802.9528 22738.6296  43.9%  3386  589s
  4392  2009     cutoff   27      15802.9528 22629.7802  43.2%  3404  603s
  4576  2062 21485.4749   13  350 15802.9528 22557.8529  42.7%  3420  618s
  4785  2113 19967.2190   16  319 15802.9528 22554.3201  42.7%  3441  635s
  4943  2194 18730.8989   22  209 15802.9528 22554.3201  42.7%  3505  653s
  5151  2253 17305.6752   28  191 15802.9528 22538.4719  42.6%  3515  669s
  5398  2314 15964.0624   33  285 15802.9528 22525.8191  42.5%  3529  688s
  5661  2386 17081.3075   10  304 15802.9528 22525.8191  42.5%  3534  704s
  5913  2415     cutoff   14      15802.9528 22516.6450  42.5%  3541  722s
  6106  2474     cutoff   11      15802.9528 22516.6450  42.5%  3566  742s
  6345  2558 21711.0472   12  373 15802.9528 22516.6450  42.5%  3596  762s
  6594  2559 21461.9845   15  462 15802.9528 22321.7627  41.3%  3615  794s
  6596  2560 17350.8302   15  110 15802.9528 22321.7627  41.3%  3614  815s
  6597  2561 18632.7057   16  335 15802.9528 22321.7627  41.3%  3613  830s
  6598  2562 17352.9193   52  407 15802.9528 22321.7627  41.3%  3613  840s
  6599  2562 16102.2409   19  436 15802.9528 22321.7627  41.3%  3612  848s
  6600  2563 18170.5243   14  486 15802.9528 22321.7627  41.3%  3611  853s
  6601  2564 18632.7057   16  457 15802.9528 22321.7627  41.3%  3611  858s
  6602  2564 16351.1020   42  410 15802.9528 22321.7627  41.3%  3610  863s
  6603  2565 18065.0146   16  409 15802.9528 22321.7627  41.3%  3610  865s
  6606  2567 19133.4639   12  463 15802.9528 22321.7627  41.3%  3608  873s
  6607  2568 20556.5693   12  419 15802.9528 22321.7627  41.3%  3608  876s
  6609  2569 17242.6889   62  448 15802.9528 22321.7627  41.3%  3607  887s
  6611  2570 19103.4750   18  406 15802.9528 22321.7627  41.3%  3605  890s
  6612  2571 17328.6628   48  396 15802.9528 22321.7627  41.3%  3605  895s
  6614  2572 20206.6314   12  392 15802.9528 22321.7627  41.3%  3604  902s
  6615  2573 18424.8845   18  461 15802.9528 22321.7627  41.3%  3603  905s
  6616  2574 17346.7260   18  465 15802.9528 22321.7627  41.3%  3603  910s
  6619  2576 18098.0694   13  259 15802.9528 22321.7627  41.3%  3601  915s
  6622  2578 18223.1232   19  402 15802.9528 22321.7627  41.3%  3599  921s
  6625  2580 17788.0224   18  352 15802.9528 22321.7627  41.3%  3598  946s
  6626  2580 21858.8770   11  352 15802.9528 22321.7627  41.3%  3597  954s
  6627  2584 22321.7627   12  346 15802.9528 22321.7627  41.3%  3620  970s
  6629  2587 22321.7627   13  355 15802.9528 22321.7627  41.3%  3620  980s
  6633  2594 22321.7627   14  401 15802.9528 22321.7627  41.3%  3621  989s
  6641  2607 22321.7627   15  360 15802.9528 22321.7627  41.3%  3625 1003s
  6657  2614 21127.9596   16  271 15802.9528 22321.7627  41.3%  3633 1020s
  6673  2631 22084.5844   17  226 15802.9528 22321.7627  41.3%  3652 1036s
  6705  2684 21785.0828   18  341 15802.9528 22321.7627  41.3%  3669 1053s
  6800  2701 21573.1771   21  299 15802.9528 22321.7627  41.3%  3701 1072s
  6881  2705 21100.5187   22  359 15802.9528 22321.7627  41.3%  3702 1086s
  6943  2702 20625.4160   23  353 15802.9528 22321.7627  41.3%  3703 1098s
  6985  2711 18012.8817   22  167 15802.9528 22321.7627  41.3%  3708 1109s
  7024  2718 20024.6753   24  317 15802.9528 22321.7627  41.3%  3726 1118s
  7061  2728 19656.9973   24  365 15802.9528 22321.7627  41.3%  3741 1127s
  7101  2734 19180.5613   25  373 15802.9528 22321.7627  41.3%  3745 1137s
  7149  2734 19821.8683   25  272 15802.9528 22321.7627  41.3%  3742 1147s
  7206  2756 17776.6181   25  195 15802.9528 22321.7627  41.3%  3733 1161s
  7277  2747 19820.6716   26  275 15802.9528 22093.1153  39.8%  3714 1172s
  7356  2742     cutoff   27      15802.9528 22093.1153  39.8%  3696 1182s
  7427  2719 18268.5464   29  419 15802.9528 22093.1153  39.8%  3683 1193s
  7506  2690 17681.3164   31  377 15802.9528 22093.1153  39.8%  3666 1204s
  7568  2684 16899.8200   29  169 15802.9528 21930.7060  38.8%  3664 1215s
  7641  2669     cutoff   32      15802.9528 21813.1123  38.0%  3654 1226s
  7723  2665 16406.2893   21  336 15802.9528 21718.8261  37.4%  3649 1237s
  7795  2652 16039.9354   22  301 15802.9528 21718.8261  37.4%  3647 1248s
  7875  2646     cutoff   25      15802.9528 21354.0422  35.1%  3643 1260s
  7960  2609 20893.1741   22  165 15802.9528 21349.6490  35.1%  3635 1273s
  8077  2600 20173.5441   24  202 15802.9528 21349.6490  35.1%  3617 1286s
  8182  2561 19328.6578   26  267 15802.9528 21349.6490  35.1%  3609 1300s
  8301  2529     cutoff   29      15802.9528 21066.7243  33.3%  3591 1310s
  8358  2520 16107.2337   29   93 15802.9528 21033.2701  33.1%  3586 1321s
  8412  2507 16101.1756   30   95 15802.9528 20891.9462  32.2%  3584 1335s
  8482  2494     cutoff   31      15802.9528 20891.9462  32.2%  3574 1350s
  8571  2481     cutoff   24      15802.9528 20608.3002  30.4%  3565 1366s
  8671  2466 17357.3856   22  485 15802.9528 20608.3002  30.4%  3550 1379s
  8742  2462 17007.6195   23  436 15802.9528 20304.9362  28.5%  3542 1395s
  8890  2419 16134.5924   24  405 15802.9528 20299.4484  28.5%  3516 1412s
  9079  2365 16116.5048   25  465 15802.9528 20182.1300  27.7%  3480 1429s
  9269  2296     cutoff   24      15802.9528 20182.1300  27.7%  3446 1448s
  9463  2233 16667.0965   23  276 15802.9528 19712.1344  24.7%  3420 1471s
  9671  2184     cutoff   24      15802.9528 19323.2321  22.3%  3390 1490s
  9910  2077 16626.5432   23  398 15802.9528 19255.3466  21.8%  3353 1506s
 10119  1989     cutoff   25      15802.9528 19255.3466  21.8%  3318 1526s
 10373  1816 16317.3586   22  270 15802.9528 18987.9380  20.2%  3280 1546s
 10655  1573 16303.6338   33   53 15802.9528 18676.2446  18.2%  3239 1568s
 11089  1294     cutoff   32      15802.9528 18290.2308  15.7%  3157 1588s
 11592  1130     cutoff   39      15802.9528 17595.4135  11.3%  3055 1599s
*12300   764              66    15818.760718 16813.8471  6.29%  2890 1599s
 12317   774     cutoff   22      15818.7607 16619.0150  5.06%  2887 1601s

Cutting planes:
  Gomory: 1
  MIR: 573
  Mixing: 2
  Flow cover: 1327
  RLT: 17
  Relax-and-lift: 108

Explored 14129 nodes (35861923 simplex iterations) in 1603.93 seconds (4618.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15818.8 15803 15654.7 ... 14572.9

Optimal solution found (tolerance 1.00e-06)
Warning: max constraint violation (1.4188e-09) exceeds tolerance
Best objective 1.581876071767e+04, best bound 1.581876071767e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1603.94s
  Master Objective (UB) = 15818.76, θ = 156437.33
  Upper Bound (UB) = 15818.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156437.33
  [DEBUG]   ✓ Scenario 0: θ = 156437.33 ≤ Q = 156437.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156437.33 ≤ Q = 156437.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156437.33 ≤ Q = 156437.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156437.33 ≤ Q = 156437.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156437.33 ≤ Q = 156437.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156437.33 ≤ Q = 156437.33 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x278d99fd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x278d99fd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.174985e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6385421.1117
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.376480e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137648.02    0  123 6385421.11 -137648.02   102%     -    0s
H    0     0                    -100983.3175 -137648.02  36.3%     -    0s
H    0     0                    -102433.8482 -137648.02  34.4%     -    0s
     0     0 -117327.11    0  102 -102433.85 -117327.11  14.5%     -    0s
H    0     0                    -113859.7097 -117303.30  3.02%     -    0s
H    0     0                    -114173.0493 -117303.30  2.74%     -    0s
H    0     0                    -114786.4984 -117303.30  2.19%     -    0s
H    0     0                    -115099.8380 -117303.30  1.91%     -    0s
     0     0 -116227.16    0   98 -115099.84 -116227.16  0.98%     -    0s
H    0     0                    -115359.1400 -116216.83  0.74%     -    0s
     0     0 -116216.83    0   97 -115359.14 -116216.83  0.74%     -    0s
H    0     0                    -115388.2386 -116216.83  0.72%     -    0s
     0     0 -115917.12    0   31 -115388.24 -115917.12  0.46%     -    0s
     0     0 -115836.72    0   40 -115388.24 -115836.72  0.39%     -    0s
     0     0 -115836.57    0   38 -115388.24 -115836.57  0.39%     -    0s
     0     0 -115835.77    0   30 -115388.24 -115835.77  0.39%     -    0s
     0     0 -115746.71    0   26 -115388.24 -115746.71  0.31%     -    0s
     0     0 -115684.78    0   36 -115388.24 -115684.78  0.26%     -    0s
     0     0 -115677.77    0   31 -115388.24 -115677.77  0.25%     -    0s
     0     0 -115643.74    0   31 -115388.24 -115643.74  0.22%     -    0s
     0     0 -115628.72    0   31 -115388.24 -115628.72  0.21%     -    0s
     0     0 -115628.72    0   39 -115388.24 -115628.72  0.21%     -    0s
     0     0 -115628.72    0   39 -115388.24 -115628.72  0.21%     -    0s
     0     0 -115422.87    0   18 -115388.24 -115422.87  0.03%     -    0s
     0     0 -115418.22    0   10 -115388.24 -115418.22  0.03%     -    0s
H    0     0                    -115397.1112 -115415.95  0.02%     -    0s
     0     0 -115415.95    0    9 -115397.11 -115415.95  0.02%     -    0s
     0     0 -115407.38    0    8 -115397.11 -115407.38  0.01%     -    0s
     0     0 -115405.02    0    5 -115397.11 -115405.02  0.01%     -    0s
     0     0 -115405.02    0    6 -115397.11 -115405.02  0.01%     -    0s
H    0     0                    -115402.0112 -115405.02  0.00%     -    0s
     0     0 -115405.02    0    5 -115402.01 -115405.02  0.00%     -    0s
     0     0 -115404.79    0    5 -115402.01 -115404.79  0.00%     -    0s
*    0     0               0    -115402.4134 -115402.41  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 1
  Flow cover: 7
  Relax-and-lift: 3

Explored 1 nodes (1019 simplex iterations) in 0.14 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -115402 -115402 -115397 ... 6.38542e+06
No other solutions better than -115402

Optimal solution found (tolerance 1.00e-06)
Best objective -1.154024134241e+05, best bound -1.154024134241e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 145933.90
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115402.41
  [DEBUG]   S×d_nominal = 261336.32
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 261336.32 + -115402.41 = 145933.90
  [DEBUG]   Current θ from Master = 156437.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10503.42 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5315.34
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 3617.4759, Absolute Gap = 3617.4759, Relative Gap = 0.228683
  Not converged yet (gap = 3617.48 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308304 nonzeros
Model fingerprint: 0x2031e298
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43834 rows and 17794 columns
Presolve time: 1.02s
Presolved: 64579 rows, 28146 columns, 401649 nonzeros
Variable types: 25887 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -221895.3170

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 64579 rows, 28146 columns, 401649 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28564   -1.8421934e+04   0.000000e+00   4.404769e+08      5s
   46964    1.8617709e+04   0.000000e+00   1.805225e+07     10s
   55772    2.4912570e+04   0.000000e+00   3.352256e+07     15s
   65204    3.0341516e+04   0.000000e+00   3.477084e+07     20s
Concurrent spin time: 0.21s

Solved with dual simplex

Root relaxation: objective 3.680957e+04, 49477 iterations, 22.68 seconds (47.96 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36809.5687    0  110 -221895.32 36809.5687   117%     -   24s
H    0     0                    -215346.1088 36809.5687   117%     -   24s
H    0     0                    -121143.9692 36809.5687   130%     -   24s
H    0     0                    -120406.3502 36809.5687   131%     -   24s
H    0     0                    -57684.89483 36809.5687   164%     -   24s
H    0     0                    -17787.22063 36809.5687   307%     -   24s
H    0     0                    -8273.156809 36809.5687   545%     -   24s
H    0     0                    12213.776805 36809.5687   201%     -   24s
H    0     0                    12880.696366 36809.5687   186%     -   25s
H    0     0                    12924.940271 31893.7502   147%     -   35s
     0     0 31893.7502    0  221 12924.9403 31893.7502   147%     -   35s
     0     0 30985.0816    0  220 12924.9403 30985.0816   140%     -   39s
     0     0 30984.7690    0  212 12924.9403 30984.7690   140%     -   40s
     0     0 30984.7690    0  219 12924.9403 30984.7690   140%     -   41s
     0     0 30984.7690    0  217 12924.9403 30984.7690   140%     -   41s
H    0     0                    12975.480139 28222.3525   118%     -   51s
     0     0 28177.2395    0  317 12975.4801 28177.2395   117%     -   51s
     0     0 27841.8479    0  330 12975.4801 27841.8479   115%     -   56s
     0     0 27657.1966    0  339 12975.4801 27657.1966   113%     -   61s
     0     0 27632.6811    0  342 12975.4801 27632.6811   113%     -   64s
     0     0 27608.8189    0  349 12975.4801 27608.8189   113%     -   66s
     0     0 27593.2980    0  347 12975.4801 27593.2980   113%     -   67s
     0     0 27551.7762    0  353 12975.4801 27551.7762   112%     -   68s
     0     0 27547.4326    0  353 12975.4801 27547.4326   112%     -   68s
     0     0 27546.0565    0  355 12975.4801 27546.0565   112%     -   69s
     0     0 27545.7424    0  352 12975.4801 27545.7424   112%     -   69s
H    0     0                    13429.078318 26365.4908  96.3%     -   83s
H    0     0                    13522.130837 26365.4908  95.0%     -   83s
     0     0 26365.4908    0  367 13522.1308 26365.4908  95.0%     -   83s
     0     0 26032.9955    0  391 13522.1308 26032.9955  92.5%     -   89s
     0     0 25964.1222    0  383 13522.1308 25964.1222  92.0%     -   91s
     0     0 25926.1555    0  395 13522.1308 25926.1555  91.7%     -   93s
     0     0 25886.4749    0  390 13522.1308 25886.4749  91.4%     -   96s
     0     0 25881.5123    0  391 13522.1308 25881.5123  91.4%     -   97s
     0     0 25849.1763    0  401 13522.1308 25849.1763  91.2%     -   98s
     0     0 25824.6534    0  347 13522.1308 25824.6534  91.0%     -  100s
     0     0 25822.4789    0  351 13522.1308 25822.4789  91.0%     -  100s
     0     0 25800.0701    0  387 13522.1308 25800.0701  90.8%     -  102s
     0     0 25793.7202    0  392 13522.1308 25793.7202  90.8%     -  102s
     0     0 25792.7437    0  394 13522.1308 25792.7437  90.7%     -  103s
     0     0 25400.4617    0  413 13522.1308 25400.4617  87.8%     -  115s
     0     0 25144.0673    0  407 13522.1308 25144.0673  85.9%     -  120s
     0     0 25108.4057    0  403 13522.1308 25108.4057  85.7%     -  123s
     0     0 25096.3627    0  379 13522.1308 25096.3627  85.6%     -  124s
     0     0 25088.4512    0  411 13522.1308 25088.4512  85.5%     -  125s
     0     0 25086.1453    0  424 13522.1308 25086.1453  85.5%     -  126s
     0     0 25085.1230    0  362 13522.1308 25085.1230  85.5%     -  126s
H    0     0                    13668.160551 25019.4156  83.0%     -  130s
H    0     0                    13670.119805 25019.4156  83.0%     -  130s
     0     0 25019.4156    0  464 13670.1198 25019.4156  83.0%     -  130s
     0     0 25014.6823    0  419 13670.1198 25014.6823  83.0%     -  131s
     0     0 25010.9452    0  431 13670.1198 25010.9452  83.0%     -  131s
     0     0 25005.4329    0  418 13670.1198 25005.4329  82.9%     -  132s
     0     0 25001.7464    0  411 13670.1198 25001.7464  82.9%     -  133s
     0     0 24999.0208    0  427 13670.1198 24999.0208  82.9%     -  134s
     0     0 24995.3016    0  420 13670.1198 24995.3016  82.8%     -  135s
     0     0 24993.2625    0  425 13670.1198 24993.2625  82.8%     -  136s
     0     0 24992.9088    0  427 13670.1198 24992.9088  82.8%     -  136s
     0     0 24967.1433    0  303 13670.1198 24967.1433  82.6%     -  139s
H    0     0                    14119.156207 24966.9912  76.8%     -  141s
     0     0 24962.9157    0  462 14119.1562 24962.9157  76.8%     -  142s
     0     0 24960.7028    0  348 14119.1562 24960.7028  76.8%     -  143s
     0     0 24959.2805    0  437 14119.1562 24959.2805  76.8%     -  144s
     0     0 24959.1925    0  480 14119.1562 24959.1925  76.8%     -  145s
     0     0 24953.4289    0  469 14119.1562 24953.4289  76.7%     -  146s
     0     0 24952.3833    0  438 14119.1562 24952.3833  76.7%     -  147s
     0     0 24948.7719    0  440 14119.1562 24948.7719  76.7%     -  148s
H    0     0                    14233.100545 24948.0904  75.3%     -  150s
     0     0 24948.0904    0  436 14233.1005 24948.0904  75.3%     -  151s
     0     0 24947.5048    0  431 14233.1005 24947.5048  75.3%     -  152s
     0     0 24947.0113    0  442 14233.1005 24947.0113  75.3%     -  152s
     0     0 24946.2435    0  437 14233.1005 24946.2435  75.3%     -  154s
     0     0 24945.5595    0  437 14233.1005 24945.5595  75.3%     -  154s
     0     2 24945.5595    0  437 14233.1005 24945.5595  75.3%     -  175s
     3     8 24658.5010    2  426 14233.1005 24788.5753  74.2%  4799  188s
     7    16 24576.7605    3  425 14233.1005 24658.3068  73.2%  6527  192s
    15    32 24227.0579    4  426 14233.1005 24576.6993  72.7%  5283  203s
    31    49 16003.8895    5  186 14233.1005 24226.8518  70.2% 10048  218s
    48    81 23338.8227    6  444 14233.1005 24226.6980  70.2%  9026  237s
    80   229 23149.3862    7  442 14233.1005 24226.6980  70.2%  7526  248s
   232   303 23059.5346   10  376 14233.1005 24226.6980  70.2%  3790  255s
   319   338 22860.2428    9  394 14233.1005 24226.6980  70.2%  3206  263s
   385   367 22575.0415   11  241 14233.1005 24226.6980  70.2%  3171  272s
   448   395 22574.2928   12  230 14233.1005 24226.6980  70.2%  3156  280s
   528   432 22882.4627   12  361 14233.1005 24226.6980  70.2%  2991  288s
   597   497 22893.8313   12  370 14233.1005 24226.6980  70.2%  2939  294s
   682   565 21220.6122   12  239 14233.1005 24226.6980  70.2%  2820  301s
   761   634 22581.3460   13  367 14233.1005 24226.6980  70.2%  2712  309s
   846   698 22302.0544   14  333 14233.1005 24226.6980  70.2%  2582  316s
   929   790 22157.6836   15  193 14233.1005 24226.6980  70.2%  2477  323s
  1033   823 22102.2659   16  191 14233.1005 24226.6980  70.2%  2357  331s
  1104   898 21967.6139   18  186 14233.1005 24226.6980  70.2%  2324  338s
  1215   952 21769.9274   20  191 14233.1005 24226.6980  70.2%  2261  347s
  1316  1021 17901.5043   19  178 14233.1005 24226.6980  70.2%  2204  354s
  1413  1115 21379.1648   21  175 14233.1005 24226.6980  70.2%  2174  364s
  1537  1184 21031.7990   21  149 14233.1005 24226.6980  70.2%  2097  373s
  1659  1245 19894.7696   22  183 14233.1005 24226.6980  70.2%  2050  384s
  1784  1307 19713.1904   22  185 14233.1005 24226.6980  70.2%  2014  393s
  1904  1377 20930.0096   22  158 14233.1005 24226.6980  70.2%  1989  403s
  2004  1458 20715.0293   23  168 14233.1005 24226.6980  70.2%  1963  412s
  2148  1484 20692.8443   23  188 14233.1005 24226.6980  70.2%  1931  422s
  2188  1527 20649.7456   24  169 14233.1005 24226.6980  70.2%  1932  432s
  2275  1586 19928.4270   26  164 14233.1005 23820.6633  67.4%  1917  441s
  2370  1651 20509.6831   24  166 14233.1005 23820.6633  67.4%  1917  451s
  2478  1677 15558.2843   27   97 14233.1005 23820.6633  67.4%  1923  460s
  2552  1716 19696.4296   27  309 14233.1005 23820.6633  67.4%  1930  471s
  2637  1763 19845.0298   27  161 14233.1005 23415.2765  64.5%  1949  483s
  2745  1833 15290.1244   27   98 14233.1005 23415.2765  64.5%  1954  495s
  2857  1906 19097.8043   27  344 14233.1005 23415.2765  64.5%  1971  507s
  3001  1957 19367.6687   28  302 14233.1005 23055.3186  62.0%  1973  520s
  3139  1981 19094.3987   28  339 14233.1005 22893.2250  60.8%  1989  530s
  3183  2034 14958.1071   28   94 14233.1005 22893.2250  60.8%  2000  542s
  3250  2074 18768.5743   27  258 14233.1005 22893.2250  60.8%  2018  556s
  3342  2133 18542.8860   28  234 14233.1005 22859.7392  60.6%  2039  569s
  3439  2202 17735.5127   27  118 14233.1005 22859.7392  60.6%  2056  579s
  3552  2269 18569.1217   28  248 14233.1005 22859.7392  60.6%  2080  592s
  3703  2305 18549.1434   29  186 14233.1005 22859.7392  60.6%  2083  607s
  3839  2350 17863.2404   30  212 14233.1005 22859.7392  60.6%  2100  622s
H 3863  2350                    14242.664947 22859.7392  60.5%  2108  622s
  3982  2431 15940.4070   32   64 14242.6649 22859.7392  60.5%  2113  640s
  4156  2502 15118.0352   45   54 14242.6649 22591.6428  58.6%  2129  656s
  4315  2563 14811.0229   57   34 14242.6649 22476.6257  57.8%  2147  674s
  4458  2630 19027.1889   11  222 14242.6649 22476.6257  57.8%  2185  691s
  4597  2696 16627.7899   13  251 14242.6649 22476.6257  57.8%  2223  709s
H 4768  2695                    14325.678941 22371.7148  56.2%  2258  715s
  4769  2696 14992.3808   56  437 14325.6789 22371.7148  56.2%  2257  752s
  4771  2697 19816.4444    8  110 14325.6789 22371.7148  56.2%  2256  779s
  4772  2698 17885.7313   18  326 14325.6789 22371.7148  56.2%  2256  798s
  4773  2699 17239.7808   29  402 14325.6789 22371.7148  56.2%  2255  809s
  4774  2699 16572.8153   31  344 14325.6789 22371.7148  56.2%  2255  821s
H 4774  2563                    14382.026440 22371.7148  55.6%  2255  828s
H 4774  2435                    14388.892237 22371.7148  55.5%  2255  828s
H 4774  2313                    14885.248599 22371.7148  50.3%  2255  828s
  4776  2315 22054.9169    9  391 14885.2486 22371.7148  50.3%  2254  834s
  4777  2315 18248.0115   25  358 14885.2486 22371.7148  50.3%  2254  840s
H 4777  2199                    15053.337534 22371.7148  48.6%  2254  844s
H 4777  2089                    15060.573094 22371.7148  48.5%  2254  844s
  4779  2091 17691.0771   18  411 15060.5731 22371.7148  48.5%  2253  848s
  4780  2091 15559.1147   53  296 15060.5731 22371.7148  48.5%  2252  851s
  4782  2093 20762.6876    9  285 15060.5731 22371.7148  48.5%  2251  859s
  4783  2093 17314.9055   36  401 15060.5731 22371.7148  48.5%  2251  864s
  4784  2094 15108.9494   41  408 15060.5731 22371.7148  48.5%  2250  868s
H 4784  1989                    15120.395582 22371.7148  48.0%  2250  874s
H 4784  1889                    15153.527689 22371.7148  47.6%  2250  876s
  4787  1891 17293.8711   20  400 15153.5277 22371.7148  47.6%  2249  880s
  4789  1892 15155.9934   38  461 15153.5277 22371.7148  47.6%  2248  887s
  4790  1893 15754.7708   10  412 15153.5277 22371.7148  47.6%  2247  894s
  4791  1894 20748.9567   15  462 15153.5277 22371.7148  47.6%  2247  900s
  4792  1894 15262.7044   14  425 15153.5277 22371.7148  47.6%  2247  907s
  4793  1895 19650.8738   13  435 15153.5277 22371.7148  47.6%  2246  910s
  4794  1896 15288.8159   28  482 15153.5277 22371.7148  47.6%  2246  917s
  4795  1896 19801.9917    8  472 15153.5277 22371.7148  47.6%  2245  920s
  4796  1897 19727.5480   17  437 15153.5277 22371.7148  47.6%  2245  926s
  4798  1898 15153.5277   55  469 15153.5277 22371.7148  47.6%  2244  931s
  4799  1899 16831.9513   25  469 15153.5277 22371.7148  47.6%  2243  958s
  4800  1900 18745.9178   21  469 15153.5277 22371.7148  47.6%  2243  973s
  4801  1903 22371.7148   16  421 15153.5277 22371.7148  47.6%  2286  987s
  4803  1907 22371.7148   17  455 15153.5277 22371.7148  47.6%  2288 1005s
  4807  1913 22371.7148   18  451 15153.5277 22371.7148  47.6%  2294 1017s
  4815  1927 22371.7148   19  398 15153.5277 22371.7148  47.6%  2305 1043s
  4831  1937 22371.7148   20  419 15153.5277 22371.7148  47.6%  2345 1072s
  4847  1961 22216.8669   21  358 15153.5277 22371.7148  47.6%  2368 1090s
H 4857  1863                    15219.884465 22371.7148  47.0%  2379 1090s
  4879  1986 21997.7613   22  393 15219.8845 22371.7148  47.0%  2404 1115s
  5033  1977 21087.5724   27  303 15219.8845 22371.7148  47.0%  2470 1128s
H 5085  1869                    15235.703283 22371.7148  46.8%  2484 1128s
  5103  1893 20808.1920   28  354 15235.7033 22371.7148  46.8%  2495 1140s
  5175  1897 20458.3478   28  358 15235.7033 22371.7148  46.8%  2505 1154s
H 5194  1804                    15258.893795 22371.7148  46.6%  2511 1154s
H 5203  1719                    15271.601594 22371.7148  46.5%  2512 1154s
  5232  1737 21566.5980   26  386 15271.6016 22371.7148  46.5%  2514 1167s
  5303  1724 17461.3565   28  148 15271.6016 22371.7148  46.5%  2520 1178s
  5350  1727 18344.2209   29  368 15271.6016 22371.7148  46.5%  2527 1190s
H 5382  1639                    15409.883727 22371.7148  45.2%  2529 1190s
  5404  1660 20195.7621   29  352 15409.8837 22371.7148  45.2%  2534 1203s
H 5418  1582                    15419.538380 22371.7148  45.1%  2539 1203s
  5474  1585 16204.7515   30  308 15419.5384 22371.7148  45.1%  2547 1214s
  5543  1574 infeasible   31      15419.5384 22371.7148  45.1%  2560 1223s
H 5564  1497                    15459.803862 22371.7148  44.7%  2564 1223s
  5589  1509 20475.7135   25  468 15459.8039 22371.7148  44.7%  2568 1234s
  5653  1504 19882.2787   26  410 15459.8039 22371.7148  44.7%  2581 1244s
  5691  1510 19536.3531   27  358 15459.8039 22371.7148  44.7%  2585 1255s
  5740  1505 18706.7088   29  356 15459.8039 22314.7579  44.3%  2595 1266s
  5797  1495 18276.7148   31  339 15459.8039 22268.4216  44.0%  2611 1278s
  5842  1497 17596.6833   32  332 15459.8039 22268.4216  44.0%  2618 1288s
  5891  1492     cutoff   33      15459.8039 22268.4216  44.0%  2632 1300s
  5976  1485     cutoff   32      15459.8039 22268.4216  44.0%  2632 1312s
  6046  1487 16678.7537   32  122 15459.8039 21846.8812  41.3%  2640 1324s
  6126  1497     cutoff   34      15459.8039 21834.5881  41.2%  2646 1342s
  6213  1496 18714.5847   25  198 15459.8039 21799.2553  41.0%  2656 1357s
  6298  1478 16339.2390   26  287 15459.8039 21725.9285  40.5%  2671 1372s
  6399  1472 18205.9415   25  202 15459.8039 21661.1120  40.1%  2679 1389s
  6517  1472 17635.2486   25  360 15459.8039 21538.3329  39.3%  2685 1407s
  6604  1481 16310.1550   26  362 15459.8039 21538.3329  39.3%  2700 1425s
  6717  1474 16034.0898   27  300 15459.8039 21235.6586  37.4%  2713 1444s
  6830  1455 20069.6504   26  165 15459.8039 21206.9518  37.2%  2727 1460s
  6930  1459 19319.7119   28  224 15459.8039 21158.2377  36.9%  2735 1477s
  7065  1454 17636.6741   30  328 15459.8039 21127.6819  36.7%  2738 1497s
  7208  1432 16516.4002   32  192 15459.8039 21004.2743  35.9%  2741 1517s
  7367  1398     cutoff   27      15459.8039 20852.6030  34.9%  2745 1538s
  7512  1388 16006.1120   27  421 15459.8039 20712.7286  34.0%  2760 1559s
  7652  1371 infeasible   28      15459.8039 20533.0761  32.8%  2777 1580s
  7814  1324 18719.0524   29  295 15459.8039 20503.9628  32.6%  2792 1603s
  7966  1265     cutoff   31      15459.8039 20503.9628  32.6%  2807 1625s
  8085  1239 15593.7056   30  399 15459.8039 20399.9578  32.0%  2810 1648s
  8283  1181 15872.2627   30  313 15459.8039 20294.6592  31.3%  2806 1674s
  8519  1126 18039.6868   29  347 15459.8039 20121.3277  30.2%  2805 1696s
  8665  1060     cutoff   33      15459.8039 20121.3277  30.2%  2809 1723s
  8923  1005 infeasible   34      15459.8039 19934.9970  28.9%  2800 1751s
  9167  1012     cutoff   31      15459.8039 19623.4571  26.9%  2799 1781s
  9389   983 15747.1425   30  322 15459.8039 19589.4558  26.7%  2789 1809s
  9702   918 18119.2833   27  302 15459.8039 19293.9214  24.8%  2780 1840s
 10043   890     cutoff   34      15459.8039 19204.0111  24.2%  2771 1871s
 10377   849     cutoff   32      15459.8039 18980.6236  22.8%  2764 1903s
 10782   798     cutoff   29      15459.8039 18743.9409  21.2%  2744 1936s
 11151   718     cutoff   33      15459.8039 18491.6231  19.6%  2735 1971s
 11573   606 15693.8243   37  241 15459.8039 18190.1255  17.7%  2719 2009s
 12081   300 15842.7648   29  293 15459.8039 18076.8993  16.9%  2686 2043s
 12723   211     cutoff   28      15459.8039 17547.4039  13.5%  2624 2067s
 13644   525 15779.2026   38   45 15459.8039 16436.9421  6.32%  2476 2072s
 15234   915 15526.5602   48   32 15459.8039 15771.8479  2.02%  2230 2078s
*16882   915              93    15517.963671 15734.1414  1.39%  2024 2078s
 17346   435 15563.7119   57   18 15517.9637 15733.9271  1.39%  1973 2082s
*17464   435              62    15562.712375 15733.7710  1.10%  1960 2082s
*19737     0              57    15563.038039 15616.4277  0.34%  1744 2084s

Cutting planes:
  Gomory: 1
  MIR: 674
  Mixing: 2
  Flow cover: 1730
  RLT: 33
  Relax-and-lift: 139

Explored 20171 nodes (34632215 simplex iterations) in 2084.94 seconds (5883.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15563 15562.7 15518 ... 15219.9

Optimal solution found (tolerance 1.00e-06)
Best objective 1.556303803865e+04, best bound 1.556303803865e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2084.98s
  Master Objective (UB) = 15563.04, θ = 156735.80
  Upper Bound (UB) = 15563.04

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156735.80
  [DEBUG]   ✓ Scenario 0: θ = 156735.80 ≤ Q = 156735.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156735.80 ≤ Q = 156735.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156735.80 ≤ Q = 156735.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156735.80 ≤ Q = 156735.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156735.80 ≤ Q = 156735.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156735.80 ≤ Q = 156735.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 156735.80 ≤ Q = 156735.80 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7bf6fbc0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x84090440
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.168998e+13
Presolve removed 2557 rows and 1848 columns
Presolve time: 0.00s
Presolved: 536 rows, 541 columns, 1513 nonzeros
Found heuristic solution: objective 6244519.2758
Variable types: 366 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6244119.6956

Root relaxation: objective -1.396468e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -139646.76    0  120 6244119.70 -139646.76   102%     -    0s
H    0     0                    -100060.5105 -139646.76  39.6%     -    0s
     0     0 -119892.24    0   93 -100060.51 -119892.24  19.8%     -    0s
H    0     0                    -116630.9572 -119813.61  2.73%     -    0s
H    0     0                    -116943.4093 -119813.61  2.45%     -    0s
H    0     0                    -117717.5724 -119813.61  1.78%     -    0s
H    0     0                    -118030.0245 -119813.61  1.51%     -    0s
     0     0 -119111.59    0   75 -118030.02 -119111.59  0.92%     -    0s
H    0     0                    -118284.8191 -119055.43  0.65%     -    0s
     0     0 -118938.77    0   61 -118284.82 -118938.77  0.55%     -    0s
     0     0 -118936.88    0   61 -118284.82 -118936.88  0.55%     -    0s
     0     0 -118610.49    0   24 -118284.82 -118610.49  0.28%     -    0s
     0     0 -118601.68    0   16 -118284.82 -118601.68  0.27%     -    0s
     0     0 -118561.69    0   23 -118284.82 -118561.69  0.23%     -    0s
     0     0 -118559.42    0   28 -118284.82 -118559.42  0.23%     -    0s
     0     0 -118477.53    0   16 -118284.82 -118477.53  0.16%     -    0s
     0     0 -118477.53    0   27 -118284.82 -118477.53  0.16%     -    0s
     0     0 -118477.53    0   26 -118284.82 -118477.53  0.16%     -    0s
     0     0 -118346.99    0    2 -118284.82 -118346.99  0.05%     -    0s
H    0     0                    -118342.3122 -118343.53  0.00%     -    0s
H    0     0                    -118343.5349 -118343.53  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 4
  MIR: 11
  Flow cover: 9
  RLT: 2

Explored 1 nodes (882 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118344 -118342 -118285 ... 6.24452e+06
No other solutions better than -118344

Optimal solution found (tolerance 1.00e-06)
Best objective -1.183435348971e+05, best bound -1.183435348971e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 144789.84
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118343.53
  [DEBUG]   S×d_nominal = 263133.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 263133.37 + -118343.53 = 144789.84
  [DEBUG]   Current θ from Master = 156735.80
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11945.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3617.08
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 3361.7533, Absolute Gap = 3361.7533, Relative Gap = 0.216009
  Not converged yet (gap = 3361.75 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351559 nonzeros
Model fingerprint: 0x9edf2cd8
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50096 rows and 20336 columns
Presolve time: 1.18s
Presolved: 73607 rows, 31844 columns, 458239 nonzeros
Variable types: 29585 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -221895.3170

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73607 rows, 31844 columns, 458239 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33194   -9.0039855e+04   0.000000e+00   4.276864e+07      5s
   47155    9.5474076e+03   0.000000e+00   4.883252e+07     10s
   55522    1.3254256e+04   0.000000e+00   6.681733e+07     15s
   63177    1.8887834e+04   0.000000e+00   1.300372e+08     20s
   72474    2.3699860e+04   0.000000e+00   1.658469e+06     25s
   79477    2.5706730e+04   0.000000e+00   7.006082e+08     30s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 3.680957e+04, 55167 iterations, 28.84 seconds (60.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36809.5687    0  110 -221895.32 36809.5687   117%     -   30s
H    0     0                    -211358.8200 36809.5687   117%     -   30s
H    0     0                    -144596.0201 36809.5687   125%     -   30s
H    0     0                    -134272.6480 36809.5687   127%     -   31s
H    0     0                    -126945.0430 36809.5687   129%     -   31s
H    0     0                    -58144.77072 36809.5687   163%     -   31s
H    0     0                    12184.971690 36809.5687   202%     -   31s
H    0     0                    12509.465288 36809.5687   194%     -   31s
H    0     0                    12691.983227 36809.5687   190%     -   31s
H    0     0                    12880.696366 36809.5687   186%     -   31s
H    0     0                    12924.940271 31807.5059   146%     -   45s
     0     0 31067.7412    0  213 12924.9403 31067.7412   140%     -   45s
     0     0 31001.7023    0  225 12924.9403 31001.7023   140%     -   51s
     0     0 31001.7023    0  218 12924.9403 31001.7023   140%     -   51s
     0     0 31001.6719    0  222 12924.9403 31001.6719   140%     -   52s
H    0     0                    13209.318960 28340.4993   115%     -   64s
     0     0 28340.4993    0  335 13209.3190 28340.4993   115%     -   64s
     0     0 27761.9222    0  332 13209.3190 27761.9222   110%     -   71s
     0     0 27625.5774    0  342 13209.3190 27625.5774   109%     -   75s
     0     0 27568.9899    0  352 13209.3190 27568.9899   109%     -   77s
     0     0 27549.8075    0  349 13209.3190 27549.8075   109%     -   78s
     0     0 27536.6873    0  347 13209.3190 27536.6873   108%     -   79s
     0     0 27532.2979    0  351 13209.3190 27532.2979   108%     -   80s
     0     0 27511.4502    0  341 13209.3190 27511.4502   108%     -   81s
     0     0 27480.1839    0  345 13209.3190 27480.1839   108%     -   82s
     0     0 27475.8858    0  352 13209.3190 27475.8858   108%     -   83s
     0     0 27474.4451    0  356 13209.3190 27474.4451   108%     -   84s
     0     0 27474.2358    0  356 13209.3190 27474.2358   108%     -   84s
     0     0 26310.6795    0  385 13209.3190 26310.6795  99.2%     -  105s
     0     0 25984.4535    0  371 13209.3190 25984.4535  96.7%     -  112s
     0     0 25918.3543    0  425 13209.3190 25918.3543  96.2%     -  116s
     0     0 25888.7402    0  434 13209.3190 25888.7402  96.0%     -  119s
     0     0 25875.5942    0  428 13209.3190 25875.5942  95.9%     -  121s
     0     0 25858.6078    0  435 13209.3190 25858.6078  95.8%     -  122s
     0     0 25850.7826    0  436 13209.3190 25850.7826  95.7%     -  124s
     0     0 25848.8485    0  431 13209.3190 25848.8485  95.7%     -  124s
     0     0 25841.8389    0  422 13209.3190 25841.8389  95.6%     -  125s
     0     0 25837.4612    0  439 13209.3190 25837.4612  95.6%     -  126s
     0     0 25835.0978    0  433 13209.3190 25835.0978  95.6%     -  126s
     0     0 25830.3867    0  440 13209.3190 25830.3867  95.5%     -  127s
     0     0 25830.0704    0  446 13209.3190 25830.0704  95.5%     -  127s
     0     0 25338.8372    0  408 13209.3190 25338.8372  91.8%     -  140s
     0     0 25169.9371    0  452 13209.3190 25169.9371  90.5%     -  149s
     0     0 25144.0960    0  409 13209.3190 25144.0960  90.4%     -  152s
     0     0 25102.0834    0  406 13209.3190 25102.0834  90.0%     -  155s
     0     0 25082.6043    0  412 13209.3190 25082.6043  89.9%     -  159s
     0     0 25075.1587    0  411 13209.3190 25075.1587  89.8%     -  162s
     0     0 25066.1687    0  408 13209.3190 25066.1687  89.8%     -  163s
     0     0 25060.9749    0  404 13209.3190 25060.9749  89.7%     -  165s
     0     0 25057.8351    0  410 13209.3190 25057.8351  89.7%     -  165s
     0     0 25056.4429    0  411 13209.3190 25056.4429  89.7%     -  166s
     0     0 25055.8656    0  409 13209.3190 25055.8656  89.7%     -  166s
     0     0 25021.8245    0  438 13209.3190 25021.8245  89.4%     -  170s
     0     0 25013.2005    0  444 13209.3190 25013.2005  89.4%     -  173s
     0     0 25012.1715    0  441 13209.3190 25012.1715  89.4%     -  174s
     0     0 25005.6807    0  482 13209.3190 25005.6807  89.3%     -  177s
     0     0 25003.3179    0  481 13209.3190 25003.3179  89.3%     -  181s
     0     0 24986.3070    0  453 13209.3190 24986.3070  89.2%     -  184s
     0     0 24977.3172    0  353 13209.3190 24977.3172  89.1%     -  186s
     0     0 24974.8445    0  470 13209.3190 24974.8445  89.1%     -  188s
     0     0 24972.8352    0  466 13209.3190 24972.8352  89.1%     -  188s
     0     0 24971.0962    0  313 13209.3190 24971.0962  89.0%     -  189s
     0     0 24970.7533    0  466 13209.3190 24970.7533  89.0%     -  190s
     0     0 24934.9802    0  458 13209.3190 24934.9802  88.8%     -  193s
H    0     0                    13662.689983 24934.0938  82.5%     -  196s
H    0     0                    13766.209794 24934.0938  81.1%     -  197s
H    0     0                    13789.870982 24934.0938  80.8%     -  197s
H    0     0                    13975.479498 24934.0938  78.4%     -  197s
H    0     0                    13991.877202 24934.0938  78.2%     -  197s
H    0     0                    14119.058202 24934.0938  76.6%     -  198s
     0     0 24930.3632    0  362 14119.0582 24930.3632  76.6%     -  200s
     0     0 24925.0324    0  461 14119.0582 24925.0324  76.5%     -  202s
     0     0 24923.6304    0  456 14119.0582 24923.6304  76.5%     -  203s
     0     0 24923.4097    0  458 14119.0582 24923.4097  76.5%     -  203s
     0     0 24889.1941    0  455 14119.0582 24889.1941  76.3%     -  207s
     0     0 24881.7823    0  458 14119.0582 24881.7823  76.2%     -  210s
     0     0 24877.9780    0  461 14119.0582 24877.9780  76.2%     -  212s
     0     0 24874.7694    0  465 14119.0582 24874.7694  76.2%     -  214s
     0     0 24874.3733    0  467 14119.0582 24874.3733  76.2%     -  215s
     0     0 24866.0389    0  459 14119.0582 24866.0389  76.1%     -  218s
     0     0 24863.4638    0  459 14119.0582 24863.4638  76.1%     -  219s
     0     0 24858.8936    0  455 14119.0582 24858.8936  76.1%     -  221s
     0     0 24857.2318    0  465 14119.0582 24857.2318  76.1%     -  223s
     0     0 24857.1206    0  457 14119.0582 24857.1206  76.1%     -  223s
     0     0 24853.9038    0  452 14119.0582 24853.9038  76.0%     -  225s
     0     0 24850.8190    0  500 14119.0582 24850.8190  76.0%     -  226s
     0     0 24849.8567    0  509 14119.0582 24849.8567  76.0%     -  227s
     0     0 24849.4580    0  508 14119.0582 24849.4580  76.0%     -  228s
     0     0 24846.3596    0  508 14119.0582 24846.3596  76.0%     -  229s
H    0     0                    14233.100545 24846.3596  74.6%     -  235s
     0     2 24846.3596    0  508 14233.1005 24846.3596  74.6%     -  250s
     2     5 24132.4266    2  353 14233.1005 24846.3596  74.6%  6606  261s
     4    10 23459.6649    2  335 14233.1005 24766.7052  74.0%  6394  268s
     9    20 23271.9510    3  423 14233.1005 24602.8215  72.9%  5667  276s
    19    31 19933.1911    5  240 14233.1005 24334.7524  71.0%  7532  294s
    30    62 23096.8550    5  345 14233.1005 24334.7524  71.0%  8076  335s
    61    94 22901.5474    6  364 14233.1005 23991.2206  68.6% 18982  346s
    93   159 22833.0270    7  365 14233.1005 23793.4813  67.2% 14669  372s
   164   245 17556.0522    9  222 14233.1005 23793.4813  67.2%  9946  387s
   266   313 17437.0320   11  205 14233.1005 23793.4813  67.2%  7306  398s
   354   371 16829.2369   16  192 14233.1005 23793.4813  67.2%  6224  411s
   434   399 15626.6096   21  137 14233.1005 23425.1324  64.6%  5688  419s
   468   439 15625.6130   22  133 14233.1005 23425.1324  64.6%  5586  430s
   513   462 15607.2227   23  133 14233.1005 23425.1324  64.6%  5353  439s
   550   488 15562.8050   24  140 14233.1005 23425.1324  64.6%  5298  450s
   611   515 19647.8262   14  240 14233.1005 23425.1324  64.6%  5002  459s
   656   553 15844.2277   18  143 14233.1005 23425.1324  64.6%  4880  469s
   702   587     cutoff   15      14233.1005 23394.7227  64.4%  4765  479s
   756   628 18238.4206   15  206 14233.1005 23394.7227  64.4%  4609  489s
   815   673 15825.5569   16  168 14233.1005 23394.7227  64.4%  4460  499s
   874   693     cutoff   18      14233.1005 23394.7227  64.4%  4374  510s
   914   733 15242.5055   16  271 14233.1005 23394.7227  64.4%  4325  525s
   966   780 14996.7804   17  259 14233.1005 23394.7227  64.4%  4218  534s
  1053   861     cutoff   18      14233.1005 23394.7227  64.4%  4027  546s
  1149   961 15639.4078   22  306 14233.1005 23394.7227  64.4%  3860  556s
  1270   990 15395.5259   30  236 14233.1005 23394.7227  64.4%  3623  569s
H 1307   990                    14616.335513 23394.7227  60.1%  3587  569s
  1369   993 14937.1872   32  155 14616.3355 23394.7227  60.1%  3520  582s
  1475  1047 18373.9034   20  367 14616.3355 23394.7227  60.1%  3450  598s
  1578  1108 18278.0910   21  449 14616.3355 23394.7227  60.1%  3388  613s
  1672  1181 17932.7507   23  417 14616.3355 23394.7227  60.1%  3370  628s
  1796  1245 17725.1938   27  405 14616.3355 23394.7227  60.1%  3311  645s
  1930  1299 16902.2512   32  261 14616.3355 22871.4957  56.5%  3248  662s
  2036  1343 16205.1030   39  299 14616.3355 22827.8821  56.2%  3242  679s
  2128  1383 15743.6896   42  376 14616.3355 22827.8821  56.2%  3265  695s
H 2235  1451                    14793.284220 22827.8821  54.3%  3265  712s
H 2238  1451                    14951.028095 22827.8821  52.7%  3262  712s
  2328  1488     cutoff   51      14951.0281 22827.8821  52.7%  3244  729s
  2475  1530 18039.9804   13  342 14951.0281 22827.8821  52.7%  3196  748s
  2599  1548     cutoff   14      14951.0281 22827.8821  52.7%  3171  763s
H 2609  1548                    14968.720435 22827.8821  52.5%  3175  763s
H 2611  1548                    14997.511085 22827.8821  52.2%  3179  763s
H 2622  1548                    15017.955709 22827.8821  52.0%  3180  763s
H 2630  1548                    15056.473158 22827.8821  51.6%  3187  763s
  2645  1581     cutoff   16      15056.4732 22827.8821  51.6%  3200  782s
  2785  1602     cutoff   16      15056.4732 22785.3855  51.3%  3186  804s
  2955  1629 19275.6858   10  383 15056.4732 22538.6013  49.7%  3144  828s
  3063  1680 17432.0095   12  431 15056.4732 22538.6013  49.7%  3186  851s
  3214  1703 17157.7469   14  343 15056.4732 22538.6013  49.7%  3189  868s
H 3224  1703                    15141.889919 22538.6013  48.8%  3194  868s
  3255  1791 16594.5258   15  365 15141.8899 22538.6013  48.8%  3207  891s
  3411  1762     cutoff   16      15141.8899 22490.9740  48.5%  3202  915s
  3577  1801     cutoff   16      15141.8899 22490.9740  48.5%  3198  940s
  3756  1866 17468.3497   12  179 15141.8899 22490.9740  48.5%  3197  967s
H 3910  1908                    15158.539219 21953.8390  44.8%  3225  992s
H 3915  1904                    15169.597974 21953.8390  44.7%  3225  992s
H 3999  1901                    15195.365487 21941.4900  44.4%  3232  992s
  4018  1949 infeasible   16      15195.3655 21941.4900  44.4%  3227 1020s
  4196  1957 15812.9111   15  262 15195.3655 21842.3993  43.7%  3239 1047s
H 4221  1951                    15214.177377 21797.6205  43.3%  3243 1047s
H 4242  1935                    15271.601594 21792.8141  42.7%  3246 1047s
  4252  1967 15427.1572   16  244 15271.6016 21792.8141  42.7%  3247 1077s
  4478  2015 15747.9950   18  129 15271.6016 21792.8141  42.7%  3246 1108s
  4729  2037 infeasible   14      15271.6016 21750.8218  42.4%  3224 1141s
  4927  2101 17072.9021   16  441 15271.6016 21666.2219  41.9%  3251 1176s
  5091  2146 15890.8792   18  199 15271.6016 21666.2219  41.9%  3294 1208s
  5254  2152     cutoff   19      15271.6016 21665.4655  41.9%  3308 1235s
  5318  2170 16068.7082   20  253 15271.6016 21537.8493  41.0%  3322 1269s
  5465  2258 19619.1653   14  240 15271.6016 21509.6079  40.8%  3344 1318s
  5663  2328 17900.5724   16  181 15271.6016 21443.8545  40.4%  3371 1359s
  5907  2348 15955.2669   20  345 15271.6016 21428.4273  40.3%  3379 1391s
  6003  2386     cutoff   20      15271.6016 21359.3054  39.9%  3397 1431s
  6198  2408 20511.7537    9  192 15271.6016 21319.5572  39.6%  3414 1458s
  6244  2450 19425.4188    9  203 15271.6016 21317.1004  39.6%  3427 1498s
  6427  2451 15955.2225   61  508 15271.6016 21211.4688  38.9%  3404 1573s
  6429  2452 20439.2300   22  110 15271.6016 21211.4688  38.9%  3403 1604s
  6430  2453 16713.8808   29  277 15271.6016 21211.4688  38.9%  3403 1626s
  6431  2454 21072.9300   14  343 15271.6016 21211.4688  38.9%  3402 1642s
  6432  2454 17450.5639   14  370 15271.6016 21211.4688  38.9%  3402 1659s
  6433  2455 18484.3717   27  390 15271.6016 21211.4688  38.9%  3401 1669s
  6434  2456 17620.1545   24  380 15271.6016 21211.4688  38.9%  3401 1674s
  6435  2456 17761.3684   28  393 15271.6016 21211.4688  38.9%  3400 1681s
  6436  2457 17714.8020   16  387 15271.6016 21211.4688  38.9%  3400 1687s
  6437  2458 18005.0829   12  409 15271.6016 21211.4688  38.9%  3399 1690s
  6439  2459 19582.1680   31  456 15271.6016 21211.4688  38.9%  3398 1698s
  6440  2460 17512.3937   19  419 15271.6016 21211.4688  38.9%  3398 1706s
  6441  2460 21000.5044   14  416 15271.6016 21211.4688  38.9%  3397 1710s
  6443  2462 19505.6327   17  375 15271.6016 21211.4688  38.9%  3396 1721s
  6444  2462 16188.6897   35  418 15271.6016 21211.4688  38.9%  3396 1725s
  6445  2463 20862.8344   11  416 15271.6016 21211.4688  38.9%  3395 1732s
  6446  2464 15676.0642   27  422 15271.6016 21211.4688  38.9%  3394 1739s
  6447  2464 17688.5739   13  427 15271.6016 21211.4688  38.9%  3394 1741s
  6448  2465 19092.9908   16  424 15271.6016 21211.4688  38.9%  3393 1746s
  6450  2466 15313.2830   43  365 15271.6016 21211.4688  38.9%  3392 1756s
  6452  2468 20367.0248   13  419 15271.6016 21211.4688  38.9%  3391 1761s
  6454  2469 18339.0519   17  413 15271.6016 21211.4688  38.9%  3390 1770s
  6456  2470 18188.4039   17  404 15271.6016 21211.4688  38.9%  3389 1775s
  6458  2472 15530.1764   26  406 15271.6016 21211.4688  38.9%  3388 1781s
  6459  2472 18918.6897   19  406 15271.6016 21211.4688  38.9%  3388 1812s
  6460  2473 18397.2615   11  406 15271.6016 21211.4688  38.9%  3387 1825s
  6461  2477 21211.4688   10  398 15271.6016 21211.4688  38.9%  3423 1883s
  6463  2480 21211.4688   11  401 15271.6016 21211.4688  38.9%  3424 1897s
  6467  2487 21211.4688   12  414 15271.6016 21211.4688  38.9%  3427 1915s
  6475  2500 21211.4688   13  352 15271.6016 21211.4688  38.9%  3435 1935s
  6491  2511 20600.1823   14  240 15271.6016 21211.4688  38.9%  3465 1962s
  6509  2535 21211.4688   15  332 15271.6016 21211.4688  38.9%  3488 1974s
  6541  2575 21084.7475   16  355 15271.6016 21211.4688  38.9%  3507 1999s
  6615  2578 20486.6912   18  445 15271.6016 21211.4688  38.9%  3527 2018s
  6699  2561 20250.5004   19  335 15271.6016 21211.4688  38.9%  3532 2038s
  6757  2561 19597.3420   19  361 15271.6016 21211.4688  38.9%  3544 2053s
  6812  2561 19086.5978   20  184 15271.6016 21211.4688  38.9%  3555 2066s
  6845  2561 18710.1928   21  202 15271.6016 21211.4688  38.9%  3566 2082s
  6887  2559 17933.0895   22  206 15271.6016 21211.4688  38.9%  3571 2103s
  6931  2563 18022.2271   22  127 15271.6016 21211.4688  38.9%  3577 2120s
  6982  2558 16882.7585   23  158 15271.6016 21211.4688  38.9%  3581 2140s
  7040  2541 16068.4630   24  134 15271.6016 21211.4688  38.9%  3578 2155s
  7096  2535 15480.5292   25  130 15271.6016 21211.4688  38.9%  3581 2177s
  7147  2529 15271.6373   26   93 15271.6016 21211.4688  38.9%  3584 2190s
  7204  2517     cutoff   27      15271.6016 21211.4688  38.9%  3580 2207s
  7263  2518 20687.7729   16  210 15271.6016 21211.4688  38.9%  3576 2221s
  7328  2518 19869.8544   17  193 15271.6016 21211.4688  38.9%  3571 2235s
  7369  2522 18208.9673   22  143 15271.6016 21211.4688  38.9%  3572 2249s
  7424  2538 18940.7700   18  165 15271.6016 21211.4688  38.9%  3574 2265s
  7496  2522     cutoff   19      15271.6016 21211.4688  38.9%  3568 2280s
  7547  2523 17134.9211   18  270 15271.6016 21211.4688  38.9%  3570 2295s
  7588  2532 15965.2628   19  215 15271.6016 21211.4688  38.9%  3574 2310s
  7635  2525     cutoff   20      15271.6016 21211.4688  38.9%  3575 2334s
  7700  2514 15329.8699   20  320 15271.6016 21211.4688  38.9%  3575 2352s
  7772  2516     cutoff   21      15271.6016 21211.4688  38.9%  3576 2372s
  7860  2521 15923.5277   18  401 15271.6016 21211.4688  38.9%  3579 2391s
  7946  2521 15799.5501   19  391 15271.6016 21211.4688  38.9%  3590 2413s
  8075  2494 15359.5791   21  358 15271.6016 21211.4688  38.9%  3581 2433s
  8206  2468 19576.5075   20  389 15271.6016 20812.7354  36.3%  3575 2456s
  8332  2464 18686.5065   22  372 15271.6016 20780.6940  36.1%  3572 2478s
  8446  2447 17551.2888   24  194 15271.6016 20445.1258  33.9%  3576 2500s
  8575  2405 16486.6376   27  110 15271.6016 20445.1258  33.9%  3580 2519s
  8626  2415 16296.0107   28  101 15271.6016 20178.8365  32.1%  3587 2544s
  8695  2398 18220.5619   21  341 15271.6016 20178.8365  32.1%  3590 2570s
  8815  2342     cutoff   23      15271.6016 20082.6359  31.5%  3588 2596s
  8956  2320     cutoff   24      15271.6016 20082.6359  31.5%  3590 2625s
  9106  2317 17395.8210   25  330 15271.6016 20082.6359  31.5%  3593 2661s
  9260  2265 16435.9465   28  244 15271.6016 20082.6359  31.5%  3596 2692s
  9439  2233 15662.9978   31  305 15271.6016 19575.6104  28.2%  3596 2723s
  9615  2196     cutoff   31      15271.6016 19337.9584  26.6%  3593 2754s
  9842  2114 16276.0396   20  242 15271.6016 19304.5729  26.4%  3578 2783s
* 9881  1976              42    15357.867619 19103.6412  24.4%  3579 2783s
  9908  1941 16081.9739   21  369 15357.8676 19103.6412  24.4%  3581 2821s
 10146  1834     cutoff   23      15357.8676 18845.7246  22.7%  3570 2871s
 10372  1718     cutoff   25      15357.8676 18845.7246  22.7%  3565 2915s
 10661  1579 16181.1462   27  345 15357.8676 18377.9328  19.7%  3543 2953s
 10904  1426     cutoff   23      15357.8676 18112.2595  17.9%  3540 2998s
 11225  1169     cutoff   26      15357.8676 17712.7162  15.3%  3514 3038s
 11683  1046 15449.2195   43   38 15357.8676 17395.5192  13.3%  3446 3070s
*12238   743              60    15373.592084 17105.2036  11.3%  3326 3071s
 12479   946 15420.2872   49   44 15373.5921 16781.7736  9.16%  3276 3099s
 13675  1108 15379.4331   54    8 15373.5921 15882.7690  3.31%  3014 3106s
 15147  1541 15523.3411   41   40 15373.5921 15710.7973  2.19%  2741 3113s
*15895  1541              55    15418.657023 15710.7973  1.89%  2620 3113s
 16907  1609     cutoff   53      15418.6570 15645.7142  1.47%  2473 3121s
 19019  1280     cutoff   48      15418.6570 15580.4721  1.05%  2217 3128s
*19824  1280              56    15427.193715 15578.5325  0.98%  2132 3128s
 21547   113     cutoff   41      15427.1937 15542.0419  0.74%  1973 3135s
*22274   113              69    15439.172301 15531.6053  0.60%  1911 3135s
*22276   113              67    15445.658426 15531.6053  0.56%  1911 3135s
*22317   113              53    15459.803862 15531.6053  0.46%  1907 3135s

Cutting planes:
  Learned: 2
  Gomory: 2
  MIR: 698
  Flow cover: 1559
  RLT: 13
  Relax-and-lift: 149

Explored 23934 nodes (42956734 simplex iterations) in 3135.64 seconds (8601.37 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15459.8 15445.7 15439.2 ... 15195.4

Optimal solution found (tolerance 1.00e-06)
Best objective 1.545980386154e+04, best bound 1.545980386154e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3135.68s
  Master Objective (UB) = 15459.80, θ = 156136.84
  Upper Bound (UB) = 15459.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156136.84
  [DEBUG]   ✓ Scenario 0: θ = 156136.84 ≤ Q = 156136.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156136.84 ≤ Q = 156136.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156136.84 ≤ Q = 156136.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156136.84 ≤ Q = 156136.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156136.84 ≤ Q = 156136.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156136.84 ≤ Q = 156136.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 156136.84 ≤ Q = 156136.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 156136.84 ≤ Q = 156136.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x264b22d1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x264b22d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.161524e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6314376.3028
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.432037e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143203.72    0  133 6314376.30 -143203.72   102%     -    0s
H    0     0                    -105744.2719 -143203.72  35.4%     -    0s
H    0     0                    -108643.5414 -143203.72  31.8%     -    0s
H    0     0                    -111364.5612 -122423.15  9.93%     -    0s
H    0     0                    -121247.7690 -122423.15  0.97%     -    0s
     0     0 -122423.15    0   51 -121247.77 -122423.15  0.97%     -    0s
     0     0 -122303.44    0   51 -121247.77 -122303.44  0.87%     -    0s
     0     0 -121856.32    0   25 -121247.77 -121856.32  0.50%     -    0s
H    0     0                    -121492.8769 -121854.63  0.30%     -    0s
H    0     0                    -121537.7581 -121789.45  0.21%     -    0s
     0     0 -121789.45    0   12 -121537.76 -121789.45  0.21%     -    0s
     0     0 -121788.65    0   11 -121537.76 -121788.65  0.21%     -    0s
H    0     0                    -121575.2924 -121783.54  0.17%     -    0s
     0     0 -121783.54    0   16 -121575.29 -121783.54  0.17%     -    0s
     0     0 -121744.50    0    8 -121575.29 -121744.50  0.14%     -    0s
     0     0 -121744.50    0   37 -121575.29 -121744.50  0.14%     -    0s
     0     0 -121678.21    0    8 -121575.29 -121678.21  0.08%     -    0s
     0     0 -121677.52    0    3 -121575.29 -121677.52  0.08%     -    0s
H    0     0                    -121675.9306 -121676.06  0.00%     -    0s
     0     0     cutoff    0      -121675.93 -121675.93  0.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 28
  Flow cover: 5

Explored 1 nodes (743 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -121676 -121575 -121538 ... 1.16152e+13
No other solutions better than -121676

Optimal solution found (tolerance 1.00e-06)
Best objective -1.216759305658e+05, best bound -1.216759305658e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 142013.70
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121675.93
  [DEBUG]   S×d_nominal = 263689.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 263689.63 + -121675.93 = 142013.70
  [DEBUG]   Current θ from Master = 156136.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14123.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1336.67
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 3258.5191, Absolute Gap = 3258.5191, Relative Gap = 0.210774
  Not converged yet (gap = 3258.52 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394814 nonzeros
Model fingerprint: 0xe9bc8b4f
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56358 rows and 22878 columns
Presolve time: 1.23s
Presolved: 82635 rows, 35542 columns, 505019 nonzeros
Variable types: 33283 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -221895.3170

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.430e+06
 Factor NZ  : 7.396e+06 (roughly 100 MB of memory)
 Factor Ops : 1.199e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69331857e+07  1.45592797e+08  9.74e+04 2.87e+01  7.46e+04     2s
   1  -1.25362348e+07  1.26523874e+08  6.62e+04 6.91e+01  5.00e+04     2s
   2  -2.86340400e+06  9.57185827e+07  1.45e+04 3.03e+00  1.15e+04     2s
   3  -7.81907135e+05  7.67024356e+07  1.50e+03 1.30e+00  1.60e+03     2s
   4  -4.95276352e+05  2.42666376e+07  3.76e+02 2.36e-01  3.94e+02     2s
   5  -3.12476902e+05  1.70353487e+07  9.69e+01 1.48e-01  1.69e+02     2s
   6  -1.61256906e+05  1.15517782e+07  3.70e+01 9.33e-02  9.47e+01     2s
   7  -1.20970964e+05  9.12567910e+06  2.23e+01 7.13e-02  7.00e+01     2s
   8  -9.64751942e+04  5.66881288e+06  9.61e+00 4.17e-02  4.08e+01     3s
   9  -8.10921084e+04  3.87897012e+06  5.04e+00 2.78e-02  2.71e+01     3s
  10  -5.08114652e+04  2.14591850e+06  9.08e-01 1.49e-02  1.46e+01     3s
  11  -2.56832248e+04  5.57257586e+05  3.11e-01 3.60e-03  3.85e+00     3s
  12  -1.63121890e+04  1.91534693e+05  2.42e-01 1.42e-03  1.37e+00     3s
  13  -6.27170855e+03  1.36405800e+05  1.84e-01 1.89e-03  9.42e-01     3s
  14  -3.53998245e+02  1.12235335e+05  1.53e-01 2.02e-03  7.44e-01     3s
  15   7.14754222e+03  9.57387387e+04  1.17e-01 2.23e-03  5.85e-01     3s
  16   1.29500245e+04  7.97080033e+04  9.47e-02 1.62e-03  4.41e-01     3s
  17   1.79595341e+04  7.03049090e+04  7.64e-02 1.45e-03  3.46e-01     3s
  18   2.11202476e+04  6.53053228e+04  6.55e-02 1.48e-03  2.92e-01     3s
  19   2.42202778e+04  6.04672278e+04  5.45e-02 1.23e-03  2.39e-01     3s
  20   2.62628663e+04  5.54717265e+04  4.74e-02 1.17e-03  1.93e-01     3s
  21   2.83524076e+04  5.41997856e+04  4.07e-02 1.11e-03  1.71e-01     3s
  22   3.08845798e+04  5.12823300e+04  3.29e-02 8.45e-04  1.35e-01     3s
  23   3.31106803e+04  4.87733993e+04  2.64e-02 1.03e-03  1.03e-01     3s
  24   3.51537933e+04  4.69441872e+04  2.04e-02 6.98e-04  7.79e-02     3s
  25   3.70861278e+04  4.58856624e+04  1.50e-02 5.31e-04  5.81e-02     3s
  26   3.83382578e+04  4.51124587e+04  1.16e-02 4.25e-04  4.48e-02     3s
  27   3.92927582e+04  4.44307380e+04  8.92e-03 3.05e-04  3.39e-02     3s
  28   4.02710636e+04  4.36360565e+04  6.22e-03 1.68e-04  2.22e-02     3s
  29   4.05590969e+04  4.32643008e+04  5.43e-03 1.41e-04  1.79e-02     3s
  30   4.10667794e+04  4.31372625e+04  4.10e-03 1.09e-04  1.37e-02     3s
  31   4.15100343e+04  4.29136290e+04  2.92e-03 9.74e-05  9.28e-03     4s
  32   4.18578880e+04  4.28566780e+04  2.03e-03 6.31e-05  6.60e-03     4s
  33   4.20082506e+04  4.28099901e+04  1.66e-03 4.69e-05  5.30e-03     4s
  34   4.21921960e+04  4.27729343e+04  1.17e-03 3.46e-05  3.84e-03     4s
  35   4.23610248e+04  4.27519146e+04  7.62e-04 2.76e-05  2.58e-03     4s
  36   4.24242494e+04  4.27392854e+04  5.98e-04 2.81e-05  2.08e-03     4s
  37   4.24957033e+04  4.27068288e+04  4.16e-04 1.47e-05  1.40e-03     4s
  38   4.25274311e+04  4.27007052e+04  3.34e-04 1.63e-05  1.15e-03     4s
  39   4.25846053e+04  4.26901155e+04  1.76e-04 1.19e-05  6.97e-04     4s
  40   4.26247114e+04  4.26766946e+04  7.93e-05 7.67e-06  3.43e-04     4s
  41   4.26478227e+04  4.26704732e+04  2.57e-05 4.70e-06  1.49e-04     4s
  42   4.26535234e+04  4.26637068e+04  1.29e-05 1.52e-06  6.72e-05     4s
  43   4.26575268e+04  4.26616872e+04  5.22e-06 6.21e-07  2.75e-05     4s
  44   4.26581204e+04  4.26607882e+04  4.09e-06 2.01e-07  1.76e-05     4s
  45   4.26598024e+04  4.26603575e+04  8.59e-07 2.87e-07  3.67e-06     4s
  46   4.26602544e+04  4.26602947e+04  4.51e-08 5.60e-08  2.66e-07     4s
  47   4.26602747e+04  4.26602769e+04  2.80e-08 3.70e-10  1.50e-08     4s
  48   4.26602758e+04  4.26602769e+04  2.37e-07 1.88e-08  7.67e-09     4s
  49   4.26602763e+04  4.26602769e+04  1.37e-07 8.68e-09  4.44e-09     4s
  50   4.26602769e+04  4.26602769e+04  1.17e-08 1.24e-08  1.29e-11     4s

Barrier solved model in 50 iterations and 4.49 seconds (7.11 work units)
Optimal objective 4.26602769e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

     900 PPushes remaining with PInf 5.0566759e-07                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.3032606e-10      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33889    4.2660277e+04   0.000000e+00   0.000000e+00      7s
   33889    4.2660277e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.266028e+04, 33889 iterations, 5.51 seconds (11.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42660.2769    0  257 -221895.32 42660.2769   119%     -    7s
H    0     0                    -213892.9860 42660.2769   120%     -    7s
H    0     0                    -129840.2558 42660.2769   133%     -    7s
H    0     0                    -126332.1840 42660.2769   134%     -    7s
H    0     0                    -126152.5041 42660.2769   134%     -    7s
H    0     0                    -125843.6085 42660.2769   134%     -    7s
H    0     0                    -125142.9749 42660.2769   134%     -    7s
H    0     0                    -125118.9420 42660.2769   134%     -    7s
H    0     0                    -59801.27563 42660.2769   171%     -    7s
H    0     0                    10604.581365 42660.2769   302%     -    8s
H    0     0                    11703.754356 42660.2769   265%     -    8s
H    0     0                    12071.420528 42660.2769   253%     -    8s
H    0     0                    12253.332597 42660.2769   248%     -    8s
H    0     0                    12283.887663 42660.2769   247%     -    8s
H    0     0                    12406.977792 42660.2769   244%     -    8s
H    0     0                    12433.430069 42660.2769   243%     -    8s
H    0     0                    12481.398285 42660.2769   242%     -    8s
H    0     0                    13716.485924 35017.2351   155%     -   33s
H    0     0                    13964.058850 35017.2351   151%     -   33s
     0     0 34940.1177    0  218 13964.0588 34940.1177   150%     -   33s
     0     0 34181.2225    0  185 13964.0588 34181.2225   145%     -   44s
     0     0 34181.2225    0  185 13964.0588 34181.2225   145%     -   46s
     0     0 34181.2225    0  234 13964.0588 34181.2225   145%     -   53s
     0     0 34181.2225    0  197 13964.0588 34181.2225   145%     -   54s
     0     0 34181.2225    0  198 13964.0588 34181.2225   145%     -   55s
     0     0 34181.2225    0  197 13964.0588 34181.2225   145%     -   55s
H    0     0                    14107.311884 31729.0084   125%     -   74s
     0     0 31729.0084    0  298 14107.3119 31729.0084   125%     -   74s
     0     0 31215.9471    0  361 14107.3119 31215.9471   121%     -   92s
     0     0 31039.6552    0  366 14107.3119 31039.6552   120%     -  102s
     0     0 30846.0975    0  372 14107.3119 30846.0975   119%     -  112s
H    0     0                    14115.284045 30797.1741   118%     -  115s
     0     0 30797.1741    0  375 14115.2840 30797.1741   118%     -  115s
     0     0 30770.0452    0  382 14115.2840 30770.0452   118%     -  118s
     0     0 30762.1651    0  385 14115.2840 30762.1651   118%     -  119s
     0     0 30733.1546    0  367 14115.2840 30733.1546   118%     -  122s
H    0     0                    14123.200348 30726.8819   118%     -  124s
     0     0 30726.8819    0  372 14123.2003 30726.8819   118%     -  124s
     0     0 30723.9286    0  369 14123.2003 30723.9286   118%     -  125s
     0     0 30723.8295    0  369 14123.2003 30723.8295   118%     -  125s
H    0     0                    14254.130088 30723.8295   116%     -  133s
H    0     0                    14509.013836 30723.8295   112%     -  133s
H    0     0                    14525.623230 30723.8295   112%     -  133s
H    0     0                    14635.863839 28684.6918  96.0%     -  160s
H    0     0                    14682.510217 28684.6918  95.4%     -  160s
H    0     0                    14811.959378 28684.6918  93.7%     -  160s
     0     0 28684.6918    0  401 14811.9594 28684.6918  93.7%     -  160s
     0     0 28054.0956    0  389 14811.9594 28054.0956  89.4%     -  195s
     0     0 27889.0575    0  424 14811.9594 27889.0575  88.3%     -  210s
     0     0 27791.3891    0  463 14811.9594 27791.3891  87.6%     -  222s
     0     0 27738.6789    0  400 14811.9594 27738.6789  87.3%     -  232s
     0     0 27683.9276    0  458 14811.9594 27683.9276  86.9%     -  240s
     0     0 27621.6502    0  405 14811.9594 27621.6502  86.5%     -  250s
     0     0 27552.4692    0  442 14811.9594 27552.4692  86.0%     -  260s
     0     0 27514.0529    0  448 14811.9594 27514.0529  85.8%     -  265s
     0     0 27508.5529    0  443 14811.9594 27508.5529  85.7%     -  269s
     0     0 27506.5418    0  452 14811.9594 27506.5418  85.7%     -  272s
     0     0 27504.5770    0  452 14811.9594 27504.5770  85.7%     -  273s
H    0     0                    14880.573139 26129.6676  75.6%     -  313s
     0     0 26129.6676    0  442 14880.5731 26129.6676  75.6%     -  313s
     0     0 25821.4826    0  437 14880.5731 25821.4826  73.5%     -  326s
     0     0 25756.4293    0  444 14880.5731 25756.4293  73.1%     -  332s
     0     0 25710.1865    0  455 14880.5731 25710.1865  72.8%     -  340s
     0     0 25702.1167    0  453 14880.5731 25702.1167  72.7%     -  343s
     0     0 25691.8301    0  451 14880.5731 25691.8301  72.7%     -  345s
     0     0 25656.4716    0  467 14880.5731 25656.4716  72.4%     -  349s
     0     0 25622.2177    0  478 14880.5731 25622.2177  72.2%     -  354s
     0     0 25610.9090    0  486 14880.5731 25610.9090  72.1%     -  356s
     0     0 25604.6458    0  474 14880.5731 25604.6458  72.1%     -  358s
     0     0 25592.8400    0  438 14880.5731 25592.8400  72.0%     -  359s
     0     0 25584.6045    0  470 14880.5731 25584.6045  71.9%     -  361s
     0     0 25582.8734    0  485 14880.5731 25582.8734  71.9%     -  362s
     0     0 25424.2017    0  463 14880.5731 25424.2017  70.9%     -  371s
     0     0 25382.6135    0  477 14880.5731 25382.6135  70.6%     -  377s
     0     0 25358.6220    0  452 14880.5731 25358.6220  70.4%     -  381s
     0     0 25350.3485    0  506 14880.5731 25350.3485  70.4%     -  384s
     0     0 25345.3066    0  505 14880.5731 25345.3066  70.3%     -  386s
     0     0 25330.8620    0  504 14880.5731 25330.8620  70.2%     -  389s
     0     0 25327.2497    0  499 14880.5731 25327.2497  70.2%     -  391s
     0     0 25324.2697    0  453 14880.5731 25324.2697  70.2%     -  392s
     0     0 25323.3580    0  458 14880.5731 25323.3580  70.2%     -  393s
     0     0 25173.8937    0  480 14880.5731 25173.8937  69.2%     -  402s
     0     0 25151.5093    0  492 14880.5731 25151.5093  69.0%     -  407s
     0     0 25141.8835    0  494 14880.5731 25141.8835  69.0%     -  410s
     0     0 25132.9070    0  538 14880.5731 25132.9070  68.9%     -  412s
     0     0 25128.7203    0  502 14880.5731 25128.7203  68.9%     -  413s
     0     0 25126.8062    0  511 14880.5731 25126.8062  68.9%     -  414s
     0     0 25079.5887    0  383 14880.5731 25079.5887  68.5%     -  420s
     0     0 25067.6397    0  440 14880.5731 25067.6397  68.5%     -  423s
     0     0 25066.2575    0  373 14880.5731 25066.2575  68.4%     -  425s
     0     0 25066.2575    0  373 14880.5731 25066.2575  68.4%     -  425s
     0     0 25035.2079    0  294 14880.5731 25035.2079  68.2%     -  430s
     0     0 25020.4408    0  361 14880.5731 25020.4408  68.1%     -  441s
     0     0 25017.6283    0  368 14880.5731 25017.6283  68.1%     -  443s
     0     0 25016.1258    0  367 14880.5731 25016.1258  68.1%     -  445s
     0     0 25007.2106    0  368 14880.5731 25007.2106  68.1%     -  449s
     0     0 25004.2592    0  438 14880.5731 25004.2592  68.0%     -  451s
     0     0 25003.6103    0  437 14880.5731 25003.6103  68.0%     -  452s
     0     0 24998.1544    0  369 14880.5731 24998.1544  68.0%     -  455s
     0     0 24995.9972    0  366 14880.5731 24995.9972  68.0%     -  458s
     0     0 24989.2958    0  366 14880.5731 24989.2958  67.9%     -  461s
     0     0 24989.2440    0  366 14880.5731 24989.2440  67.9%     -  462s
     0     2 24989.2440    0  366 14880.5731 24989.2440  67.9%     -  487s
     1     3 24465.9145    1  253 14880.5731 24988.0276  67.9%  8155  493s
     2     5 24164.4552    2  400 14880.5731 24988.0276  67.9%  8778  501s
     4    10 24300.0101    2  363 14880.5731 24684.0642  65.9%  7768  509s
     9    20 24016.1910    3  364 14880.5731 24384.8657  63.9%  7829  522s
    19    40 23657.1751    4  441 14880.5731 24137.1612  62.2%  9751  539s
    39    53 16395.1847    5  224 14880.5731 23657.1636  59.0% 12488  582s
    52    79 18992.8957    6  253 14880.5731 23656.7677  59.0% 13540  612s
H   63    79                    14957.294128 23656.7677  58.2% 12946  612s
    78   218 18735.4592    7  239 14957.2941 23656.7677  58.2% 11864  633s
   221   275 15085.3345   12  201 14957.2941 23656.7677  58.2%  6693  647s
H  228   275                    15015.429312 23656.7677  57.5%  6596  647s
   296   302     cutoff   12      15015.4293 23656.7677  57.5%  6240  658s
   356   325 21034.5916   13  252 15015.4293 23656.7677  57.5%  6041  671s
   389   346 20681.0197   14  239 15015.4293 23656.7677  57.5%  6105  682s
   431   372 20622.4241   15  232 15015.4293 23656.7677  57.5%  6177  693s
   459   394 20412.3836   16  220 15015.4293 23656.7677  57.5%  6181  705s
   495   433 20400.0040   17  218 15015.4293 23656.7677  57.5%  6011  716s
H  533   433                    15020.094650 23656.7677  57.5%  6058  716s
   544   470 20350.7523   18  201 15020.0947 23656.7677  57.5%  6048  728s
   620   512     cutoff   20      15020.0947 23656.7677  57.5%  5893  739s
   686   543 18214.8757   20  152 15020.0947 23656.7677  57.5%  5794  752s
   749   559 18185.6752   23  144 15020.0947 23656.7677  57.5%  5710  763s
   777   590 17201.3842   24  294 15020.0947 23656.7677  57.5%  5695  775s
   818   625 16882.0201   25  356 15020.0947 23656.7677  57.5%  5831  787s
   860   650 16831.8107   26  352 15020.0947 23656.7677  57.5%  5873  799s
   913   680 infeasible   27      15020.0947 23656.7677  57.5%  5826  812s
   981   723 16799.6501    9  200 15020.0947 23656.7677  57.5%  5793  824s
H 1003   723                    15029.391121 23656.7677  57.4%  5767  824s
  1061   745 15831.4192   10  188 15029.3911 23656.7677  57.4%  5720  837s
H 1077   745                    15030.039864 23656.7677  57.4%  5750  837s
H 1095   745                    15035.636302 23656.7677  57.3%  5752  837s
  1099   777 infeasible   11      15035.6363 23656.7677  57.3%  5757  849s
  1187   793 16069.4151   33  152 15035.6363 23656.7677  57.3%  5651  862s
  1257   847 15887.1823   34  141 15035.6363 23656.7677  57.3%  5593  875s
  1365   881 infeasible   36      15035.6363 23656.7677  57.3%  5442  890s
  1496   906 infeasible   39      15035.6363 23433.1435  55.9%  5272  906s
  1612   919 22378.1011    7  417 15035.6363 23365.3245  55.4%  5169  922s
  1699   940 22325.2359    8  406 15035.6363 23365.3245  55.4%  5239  938s
  1793   980 18582.8853   14  210 15035.6363 23365.3245  55.4%  5293  956s
  1868  1020 19699.7690    9  226 15035.6363 23365.3245  55.4%  5387  974s
  1959  1083 16877.7126   11  197 15035.6363 23365.3245  55.4%  5423  991s
  2087  1101 infeasible   14      15035.6363 23365.3245  55.4%  5395 1008s
H 2111  1101                    15115.996406 23124.0023  53.0%  5415 1008s
  2128  1134 15548.0507   13  179 15115.9964 23124.0023  53.0%  5467 1027s
  2239  1144 15218.7634   25  162 15115.9964 23124.0023  53.0%  5417 1043s
  2291  1151     cutoff   26      15115.9964 23124.0023  53.0%  5451 1062s
  2344  1174 20153.5704    9  342 15115.9964 23124.0023  53.0%  5530 1084s
  2409  1210 19976.7419   10  344 15115.9964 23124.0023  53.0%  5567 1105s
  2486  1248 19002.3093   11  291 15115.9964 23124.0023  53.0%  5612 1125s
  2564  1253 18315.9968   12  194 15115.9964 23124.0023  53.0%  5669 1146s
  2631  1265 17738.8797   13  336 15115.9964 23124.0023  53.0%  5723 1171s
  2718  1293 17563.6325   14  260 15115.9964 22872.8767  51.3%  5792 1196s
  2810  1342 17196.6468   16  171 15115.9964 22872.8767  51.3%  5902 1223s
  2915  1386 16222.1542   19  364 15115.9964 22328.0317  47.7%  5963 1251s
  3017  1426 15635.7669   22  304 15115.9964 22066.2761  46.0%  6053 1280s
  3133  1456 infeasible   27      15115.9964 22066.2761  46.0%  6087 1309s
  3223  1497 19785.9991    6  263 15115.9964 21968.7764  45.3%  6173 1340s
  3342  1532 17157.8194    7  247 15115.9964 21968.7764  45.3%  6250 1372s
  3419  1627 infeasible   11      15115.9964 21968.7764  45.3%  6278 1404s
  3611  1708 16425.1666   18  414 15115.9964 21850.9654  44.6%  6236 1437s
  3820  1749 15658.4045   26  170 15115.9964 21850.9654  44.6%  6186 1476s
  3999  1791 15554.1519   27  315 15115.9964 21727.1277  43.7%  6191 1514s
  4150  1855 16029.0888   10  190 15115.9964 21694.2111  43.5%  6249 1552s
  4333  1912 20550.0166   11  285 15115.9964 21653.3897  43.2%  6298 1592s
  4494  1967 infeasible   15      15115.9964 21595.8209  42.9%  6372 1635s
  4674  1977 20123.6233   13  385 15115.9964 21566.9788  42.7%  6421 1673s
  4808  2004 18510.2680   14  412 15115.9964 21521.2924  42.4%  6450 1713s
  4966  2045 17839.2244   17  261 15115.9964 21521.2924  42.4%  6519 1761s
  5166  2077 16303.6871   24  279 15115.9964 21500.4683  42.2%  6580 1810s
  5358  2159 19471.5266   14  371 15115.9964 21352.5285  41.3%  6645 1860s
  5539  2216 17400.9313   17  227 15115.9964 21288.2420  40.8%  6734 1917s
  5778  2235 15652.5901   23  274 15115.9964 21280.3863  40.8%  6694 1968s
  5823  2259 15430.2060   24  250 15115.9964 21255.8911  40.6%  6731 2018s
  5862  2260 16098.2489   30  366 15115.9964 21255.8911  40.6%  6749 2076s
  5864  2261 16741.2161   12  152 15115.9964 21255.8911  40.6%  6747 2085s
  5865  2262 15899.0914   24  248 15115.9964 21255.8911  40.6%  6746 2126s
  5866  2263 18726.8040   16  368 15115.9964 21255.8911  40.6%  6745 2166s
  5867  2263 17034.4383   11  415 15115.9964 21255.8911  40.6%  6744 2200s
  5868  2264 20169.2959   12  422 15115.9964 21255.8911  40.6%  6743 2218s
  5869  2265 20694.0055   11  355 15115.9964 21255.8911  40.6%  6741 2234s
  5870  2265 15224.5906   38  362 15115.9964 21255.8911  40.6%  6740 2241s
  5871  2266 17808.3987   10  305 15115.9964 21255.8911  40.6%  6739 2248s
  5872  2267 15583.7146   11  456 15115.9964 21255.8911  40.6%  6738 2257s
  5873  2267 15432.0143   29  409 15115.9964 21255.8911  40.6%  6737 2264s
  5874  2268 15438.2344   30  456 15115.9964 21255.8911  40.6%  6736 2271s
  5875  2269 15263.3740   50  406 15115.9964 21255.8911  40.6%  6735 2276s
  5876  2269 19377.5338    9  421 15115.9964 21255.8911  40.6%  6733 2282s
  5877  2270 20589.3497   15  416 15115.9964 21255.8911  40.6%  6732 2285s
  5878  2271 16781.4472   19  471 15115.9964 21255.8911  40.6%  6731 2299s
  5879  2271 20390.7882    9  436 15115.9964 21255.8911  40.6%  6730 2303s
  5880  2272 17708.6811   14  442 15115.9964 21255.8911  40.6%  6729 2308s
  5881  2273 16606.9705   10  432 15115.9964 21255.8911  40.6%  6728 2317s
  5882  2273 17565.0748   18  429 15115.9964 21255.8911  40.6%  6727 2320s
  5883  2274 16177.2510   25  435 15115.9964 21255.8911  40.6%  6725 2327s
  5884  2275 15746.2404   38  431 15115.9964 21255.8911  40.6%  6724 2331s
  5885  2275 17337.3168   33  438 15115.9964 21255.8911  40.6%  6723 2340s
  5887  2277 19407.8820   18  423 15115.9964 21255.8911  40.6%  6721 2346s
  5888  2277 16422.2893   40  435 15115.9964 21255.8911  40.6%  6720 2354s
  5889  2278 15823.2001   12  444 15115.9964 21255.8911  40.6%  6719 2355s
  5891  2279 18573.3991   25  418 15115.9964 21255.8911  40.6%  6716 2360s
  5892  2280 19877.4408   15  418 15115.9964 21255.8911  40.6%  6715 2367s
  5893  2281 20268.9761   16  418 15115.9964 21255.8911  40.6%  6714 2376s
  5894  2281 18699.2271   23  418 15115.9964 21255.8911  40.6%  6713 2400s
  5895  2285 21255.8911   16  428 15115.9964 21255.8911  40.6%  6757 2454s
  5897  2288 21255.8911   17  422 15115.9964 21255.8911  40.6%  6757 2477s
  5901  2295 21255.8911   18  428 15115.9964 21255.8911  40.6%  6760 2509s
  5909  2308 21255.8911   19  424 15115.9964 21255.8911  40.6%  6763 2526s
  5925  2320 18626.7365   20  242 15115.9964 21255.8911  40.6%  6793 2686s
  5942  2346 21255.8911   21  403 15115.9964 21255.8911  40.6%  6808 2707s
  5974  2393 21255.8911   22  398 15115.9964 21255.8911  40.6%  6809 2737s
  6042  2379 20773.7976   24  335 15115.9964 21255.8911  40.6%  6810 2758s
  6074  2385 20309.3246   24  304 15115.9964 21255.8911  40.6%  6815 2785s
  6121  2411 18967.8327   25  354 15115.9964 21255.8911  40.6%  6827 2808s
  6185  2421 19786.1647   25  318 15115.9964 21255.8911  40.6%  6848 2829s
  6242  2415 20450.1909   25  355 15115.9964 21255.8911  40.6%  6840 2852s
  6292  2399 18688.8014   26  345 15115.9964 21255.8911  40.6%  6833 2870s
  6331  2391 16438.2876   26  345 15115.9964 21255.8911  40.6%  6851 2902s
  6371  2382 infeasible   33      15115.9964 21255.8911  40.6%  6850 2927s
  6419  2378 infeasible   27      15115.9964 21255.8911  40.6%  6856 2946s
  6466  2365 15423.3187   28  334 15115.9964 21255.8911  40.6%  6846 2964s
  6508  2354 15422.0469   29  288 15115.9964 21255.8911  40.6%  6843 2984s
H 6516  2236                    15124.574644 21255.8911  40.5%  6847 2984s
  6555  2231 15377.9962   30  286 15124.5746 21255.8911  40.5%  6853 3013s
  6612  2228 19638.8276   25  314 15124.5746 21255.8911  40.5%  6876 3035s
  6683  2208 infeasible   26      15124.5746 21255.8911  40.5%  6894 3054s
  6751  2198     cutoff   28      15124.5746 21255.8911  40.5%  6914 3080s
  6806  2198 17251.5583   29  392 15124.5746 21255.8911  40.5%  6938 3099s
  6855  2205 15992.2924   31  330 15124.5746 21255.8911  40.5%  6955 3128s
  6912  2193 15192.6018   33  334 15124.5746 21255.8911  40.5%  6958 3151s
  6966  2194 infeasible   34      15124.5746 21255.8911  40.5%  6975 3173s
H 6967  2085                    15126.114043 21255.8911  40.5%  6974 3173s
  7026  2080     cutoff   33      15126.1140 21255.8911  40.5%  6992 3194s
  7103  2086 19398.9099   28  464 15126.1140 21255.8911  40.5%  7019 3228s
  7191  2089 17456.7365   29  146 15126.1140 21255.8911  40.5%  7043 3254s
  7293  2062     cutoff   31      15126.1140 21255.8911  40.5%  7051 3279s
  7400  2041 18192.5977   30  455 15126.1140 21255.8911  40.5%  7059 3307s
  7485  2034     cutoff   31      15126.1140 21255.8911  40.5%  7081 3339s
  7577  2008 18535.9803   24  325 15126.1140 21255.8911  40.5%  7110 3363s
  7658  1995     cutoff   25      15126.1140 21255.8911  40.5%  7122 3394s
  7737  1998 18949.9525   23  213 15126.1140 21255.8911  40.5%  7148 3432s
  7858  1973 infeasible   25      15126.1140 21255.8911  40.5%  7159 3469s
  8003  1931 infeasible   26      15126.1140 21255.8911  40.5%  7171 3500s
  8100  1910 infeasible   27      15126.1140 21255.8911  40.5%  7182 3532s
  8206  1888 20734.1953   26  467 15126.1140 21255.8911  40.5%  7205 3567s
  8330  1879 infeasible   27      15126.1140 21255.8911  40.5%  7224 3600s

Cutting planes:
  Learned: 1
  Gomory: 21
  Lift-and-project: 1
  Implied bound: 11
  Projected implied bound: 121
  MIR: 949
  Mixing: 3
  Flow cover: 1747
  RLT: 20
  Relax-and-lift: 269

Explored 8476 nodes (61825417 simplex iterations) in 3600.06 seconds (9778.29 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15126.1 15124.6 15116 ... 14880.6

Time limit reached
Best objective 1.512611404282e+04, best bound 2.125589111655e+04, gap 40.5245%
  WARNING: Time limit reached. Using best solution found (gap: 40.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 15126.11, θ = 156369.74
  Upper Bound (UB) = 15126.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156369.74
  [DEBUG]   ✓ Scenario 0: θ = 156369.74 ≤ Q = 156369.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156369.74 ≤ Q = 156369.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156369.74 ≤ Q = 156369.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156369.74 ≤ Q = 156369.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156369.74 ≤ Q = 156369.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156369.74 ≤ Q = 156369.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 156369.74 ≤ Q = 156369.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 156369.74 ≤ Q = 156369.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 156369.74 ≤ Q = 156369.74 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1072e308
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1072e308
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-13, 2e+02]
Found heuristic solution: objective 1.173623e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.00s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6289120.1689
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.406345e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140634.47    0  132 6289120.17 -140634.47   102%     -    0s
H    0     0                    -100280.6501 -140634.47  40.2%     -    0s
H    0     0                    -102139.7729 -140634.47  37.7%     -    0s
H    0     0                    -108366.4265 -140634.47  29.8%     -    0s
H    0     0                    -109092.7651 -120754.63  10.7%     -    0s
     0     0 -120754.63    0   85 -109092.77 -120754.63  10.7%     -    0s
H    0     0                    -118928.0828 -120705.14  1.49%     -    0s
H    0     0                    -119329.3854 -120606.80  1.07%     -    0s
     0     0 -120606.80    0   85 -119329.39 -120606.80  1.07%     -    0s
     0     0 -120594.65    0   85 -119329.39 -120594.65  1.06%     -    0s
     0     0 -119839.45    0   63 -119329.39 -119839.45  0.43%     -    0s
     0     0 -119784.15    0   63 -119329.39 -119784.15  0.38%     -    0s
     0     0 -119784.01    0   63 -119329.39 -119784.01  0.38%     -    0s
     0     0 -119503.34    0   22 -119329.39 -119503.34  0.15%     -    0s
     0     0 -119497.52    0   18 -119329.39 -119497.52  0.14%     -    0s
     0     0 -119447.52    0   23 -119329.39 -119447.52  0.10%     -    0s
     0     0 -119425.11    0   11 -119329.39 -119425.11  0.08%     -    0s
     0     0 -119424.74    0   12 -119329.39 -119424.74  0.08%     -    0s
     0     0 -119379.26    0    6 -119329.39 -119379.26  0.04%     -    0s
     0     0 -119369.05    0    6 -119329.39 -119369.05  0.03%     -    0s
H    0     0                    -119332.3357 -119369.05  0.03%     -    0s
     0     0 -119334.36    0    2 -119332.34 -119334.36  0.00%     -    0s
H    0     0                    -119332.5460 -119332.89  0.00%     -    0s
H    0     0                    -119332.8873 -119332.89  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 3
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (763 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119333 -119333 -119332 ... -100281
No other solutions better than -119333

Optimal solution found (tolerance 1.00e-06)
Best objective -1.193328873078e+05, best bound -1.193328873078e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 143754.49
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119332.89
  [DEBUG]   S×d_nominal = 263087.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 263087.38 + -119332.89 = 143754.49
  [DEBUG]   Current θ from Master = 156369.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12615.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2510.87
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 2924.8293, Absolute Gap = 2924.8293, Relative Gap = 0.193363
  Not converged yet (gap = 2924.83 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438069 nonzeros
Model fingerprint: 0x2c3d3053
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 62620 rows and 25420 columns
Presolve time: 1.28s
Presolved: 91663 rows, 39240 columns, 556559 nonzeros
Variable types: 36981 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -374591.0313
Found heuristic solution: objective -221895.3170

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.989e+06
 Factor NZ  : 8.640e+06 (roughly 120 MB of memory)
 Factor Ops : 1.489e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69517778e+07  1.60447559e+08  9.75e+04 2.71e+01  7.43e+04     2s
   1  -1.26202946e+07  1.39780623e+08  6.66e+04 7.91e+01  5.00e+04     2s
   2  -3.40637367e+06  1.06285929e+08  1.76e+04 3.29e+00  1.37e+04     3s
   3  -9.51706272e+05  7.79177150e+07  1.44e+03 7.75e-01  1.52e+03     3s
   4  -5.76484712e+05  2.74025893e+07  3.88e+02 1.98e-01  4.13e+02     3s
   5  -3.43232010e+05  1.93788737e+07  1.04e+02 1.23e-01  1.78e+02     3s
   6  -2.13334252e+05  1.32527019e+07  5.07e+01 7.66e-02  1.06e+02     3s
   7  -1.29318727e+05  8.79059219e+06  2.57e+01 4.69e-02  6.32e+01     3s
   8  -9.00804727e+04  4.73222833e+06  1.25e+01 2.23e-02  3.18e+01     3s
   9  -6.06784312e+04  2.84040380e+06  5.85e+00 1.28e-02  1.82e+01     3s
  10  -2.31869778e+04  7.23351438e+05  1.87e+00 2.68e-03  4.54e+00     3s
  11  -8.66752901e+03  3.06044487e+05  1.03e+00 1.30e-03  1.90e+00     3s
  12   5.94229279e+03  1.44886154e+05  4.42e-01 1.04e-03  8.31e-01     3s
  13   1.01375789e+04  1.09488865e+05  3.39e-01 1.11e-03  5.94e-01     3s
  14   1.42291165e+04  9.77274903e+04  2.68e-01 1.13e-03  4.99e-01     3s
  15   1.69938089e+04  8.82978740e+04  2.28e-01 1.09e-03  4.26e-01     3s
  16   2.06736333e+04  7.32042580e+04  1.90e-01 2.11e-03  3.14e-01     3s
  17   2.51746632e+04  6.73974093e+04  1.42e-01 1.37e-03  2.52e-01     3s
  18   2.81864582e+04  6.13351335e+04  1.15e-01 2.36e-03  1.98e-01     3s
  19   3.02161693e+04  5.87131305e+04  9.87e-02 2.13e-03  1.70e-01     3s
  20   3.22073291e+04  5.60502025e+04  8.24e-02 2.02e-03  1.42e-01     3s
  21   3.56966092e+04  5.18928681e+04  5.65e-02 1.27e-03  9.66e-02     4s
  22   3.70869388e+04  4.97595118e+04  4.69e-02 2.36e-03  7.56e-02     4s
  23   3.87192751e+04  4.82500600e+04  3.59e-02 2.28e-03  5.69e-02     4s
  24   3.91305409e+04  4.74371411e+04  3.32e-02 1.79e-03  4.96e-02     4s
  25   4.09223419e+04  4.68073727e+04  2.19e-02 1.76e-03  3.51e-02     4s
  26   4.22286733e+04  4.61119932e+04  1.35e-02 1.69e-03  2.32e-02     4s
  27   4.27382379e+04  4.58920072e+04  1.04e-02 1.50e-03  1.88e-02     4s
  28   4.34738302e+04  4.54684095e+04  5.93e-03 1.23e-03  1.19e-02     4s
  29   4.38956183e+04  4.51718327e+04  3.51e-03 7.98e-04  7.60e-03     4s
  30   4.40550956e+04  4.49340716e+04  2.63e-03 4.98e-04  5.24e-03     4s
  31   4.41368545e+04  4.48679145e+04  2.18e-03 4.08e-04  4.36e-03     4s
  32   4.42566628e+04  4.48161488e+04  1.49e-03 3.37e-04  3.33e-03     4s
  33   4.43606778e+04  4.47186541e+04  9.63e-04 2.08e-04  2.13e-03     4s
  34   4.44861825e+04  4.46229833e+04  3.37e-04 6.95e-05  8.15e-04     4s
  35   4.44966130e+04  4.46029886e+04  2.88e-04 4.73e-05  6.34e-04     4s
  36   4.45178016e+04  4.45985219e+04  1.91e-04 4.21e-05  4.81e-04     4s
  37   4.45338089e+04  4.45929712e+04  1.19e-04 3.56e-05  3.52e-04     5s
  38   4.45560447e+04  4.45797084e+04  1.79e-05 2.02e-05  1.41e-04     5s
  39   4.45615824e+04  4.45655754e+04  1.80e-06 3.30e-06  2.37e-05     5s
  40   4.45619496e+04  4.45625027e+04  8.01e-07 1.62e-07  3.29e-06     5s
  41   4.45622995e+04  4.45623068e+04  4.94e-08 6.60e-08  4.39e-08     5s
  42   4.45623053e+04  4.45623066e+04  2.14e-07 9.15e-10  7.19e-09     5s
  43   4.45623066e+04  4.45623066e+04  1.55e-08 6.87e-11  8.80e-12     5s

Barrier solved model in 43 iterations and 4.91 seconds (7.30 work units)
Optimal objective 4.45623066e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1600 PPushes remaining with PInf 1.6141787e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.6058968e-11      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29517    4.4562307e+04   0.000000e+00   0.000000e+00      6s
   29517    4.4562307e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.456231e+04, 29517 iterations, 4.34 seconds (6.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 44562.3066    0  325 -221895.32 44562.3066   120%     -    6s
H    0     0                    -212719.3226 44562.3066   121%     -    6s
H    0     0                    -135220.8168 44562.3066   133%     -    6s
H    0     0                    -118123.5307 44562.3066   138%     -    6s
H    0     0                    -116826.2950 44562.3066   138%     -    6s
H    0     0                    -113523.6687 44562.3066   139%     -    6s
H    0     0                    -113450.0980 44562.3066   139%     -    6s
H    0     0                    -60721.33821 44562.3066   173%     -    6s
H    0     0                    9398.7514377 44562.3066   374%     -    7s
H    0     0                    12016.692415 44562.3066   271%     -    7s
H    0     0                    12751.875729 44562.3066   249%     -    7s
H    0     0                    12781.736760 44562.3066   249%     -    7s
H    0     0                    12905.719317 44562.3066   245%     -    7s
H    0     0                    12931.112524 44562.3066   245%     -    7s
H    0     0                    13050.045652 44562.3066   241%     -    7s
H    0     0                    13071.606740 38460.3734   194%     -   32s
H    0     0                    13298.852611 38460.3734   189%     -   32s
     0     0 38460.3734    0  416 13298.8526 38460.3734   189%     -   32s
H    0     0                    13375.698328 38443.6894   187%     -   33s
H    0     0                    13480.346914 38443.6894   185%     -   33s
H    0     0                    13505.147489 38443.6894   185%     -   33s
     0     0 37455.8161    0  416 13505.1475 37455.8161   177%     -   44s
     0     0 37455.8161    0  433 13505.1475 37455.8161   177%     -   55s
     0     0 37455.8161    0  431 13505.1475 37455.8161   177%     -   60s
     0     0 37455.8161    0  423 13505.1475 37455.8161   177%     -   61s
     0     0 37455.8161    0  423 13505.1475 37455.8161   177%     -   63s
     0     0 37455.8161    0  423 13505.1475 37455.8161   177%     -   63s
     0     0 32811.4875    0  447 13505.1475 32811.4875   143%     -  104s
     0     0 31827.0527    0  551 13505.1475 31827.0527   136%     -  138s
     0     0 31667.0810    0  495 13505.1475 31667.0810   134%     -  151s
     0     0 31483.6478    0  509 13505.1475 31483.6478   133%     -  164s
     0     0 31459.1622    0  503 13505.1475 31459.1622   133%     -  169s
     0     0 31445.1072    0  512 13505.1475 31445.1072   133%     -  172s
     0     0 31434.8070    0  506 13505.1475 31434.8070   133%     -  177s
     0     0 31426.4158    0  520 13505.1475 31426.4158   133%     -  181s
     0     0 31424.1159    0  519 13505.1475 31424.1159   133%     -  184s
     0     0 31415.8348    0  520 13505.1475 31415.8348   133%     -  186s
     0     0 31410.6301    0  517 13505.1475 31410.6301   133%     -  189s
     0     0 31388.0072    0  516 13505.1475 31388.0072   132%     -  193s
     0     0 31387.6203    0  516 13505.1475 31387.6203   132%     -  194s
     0     0 28556.2606    0  386 13505.1475 28556.2606   111%     -  248s
     0     0 27985.9726    0  430 13505.1475 27985.9726   107%     -  273s
     0     0 27861.1996    0  426 13505.1475 27861.1996   106%     -  289s
     0     0 27794.6928    0  422 13505.1475 27794.6928   106%     -  297s
     0     0 27764.0274    0  411 13505.1475 27764.0274   106%     -  304s
     0     0 27747.4788    0  421 13505.1475 27747.4788   105%     -  309s
     0     0 27667.6233    0  430 13505.1475 27667.6233   105%     -  320s
     0     0 27637.3312    0  411 13505.1475 27637.3312   105%     -  326s
     0     0 27601.5761    0  421 13505.1475 27601.5761   104%     -  333s
     0     0 27596.4540    0  424 13505.1475 27596.4540   104%     -  335s
     0     0 27564.0455    0  418 13505.1475 27564.0455   104%     -  341s
     0     0 27560.4049    0  420 13505.1475 27560.4049   104%     -  343s
     0     0 27558.3313    0  423 13505.1475 27558.3313   104%     -  345s
     0     0 26346.4751    0  502 13505.1475 26346.4751  95.1%     -  396s
H    0     0                    13527.031386 26346.4351  94.8%     -  396s
H    0     0                    13561.574572 26346.4351  94.3%     -  396s
H    0     0                    13595.015228 26346.4351  93.8%     -  396s
H    0     0                    13637.263823 26346.4351  93.2%     -  396s
     0     0 25983.7126    0  479 13637.2638 25983.7126  90.5%     -  417s
     0     0 25918.0540    0  486 13637.2638 25918.0540  90.1%     -  425s
     0     0 25866.4136    0  494 13637.2638 25866.4136  89.7%     -  432s
     0     0 25844.3979    0  510 13637.2638 25844.3979  89.5%     -  437s
     0     0 25755.7738    0  535 13637.2638 25755.7738  88.9%     -  448s
     0     0 25729.9990    0  505 13637.2638 25729.9990  88.7%     -  452s
     0     0 25695.7005    0  498 13637.2638 25695.7005  88.4%     -  459s
     0     0 25685.6098    0  505 13637.2638 25685.6098  88.3%     -  463s
     0     0 25673.7100    0  511 13637.2638 25673.7100  88.3%     -  467s
     0     0 25632.0141    0  500 13637.2638 25632.0141  88.0%     -  472s
     0     0 25622.6851    0  498 13637.2638 25622.6851  87.9%     -  476s
H    0     0                    13778.366907 25614.8237  85.9%     -  479s
H    0     0                    13828.614142 25614.8237  85.2%     -  479s
     0     0 25614.8237    0  502 13828.6141 25614.8237  85.2%     -  479s
H    0     0                    13891.009087 25612.7907  84.4%     -  480s
H    0     0                    13935.446436 25612.7907  83.8%     -  480s
H    0     0                    13962.256813 25612.7907  83.4%     -  480s
     0     0 25612.7907    0  502 13962.2568 25612.7907  83.4%     -  480s
     0     0 25456.4816    0  407 13962.2568 25456.4816  82.3%     -  494s
H    0     0                    13998.650592 25456.2915  81.8%     -  495s
H    0     0                    14063.520061 25456.2915  81.0%     -  495s
     0     0 25394.4617    0  487 14063.5201 25394.4617  80.6%     -  501s
     0     0 25381.8733    0  493 14063.5201 25381.8733  80.5%     -  506s
     0     0 25370.6285    0  545 14063.5201 25370.6285  80.4%     -  509s
     0     0 25364.3763    0  551 14063.5201 25364.3763  80.4%     -  512s
     0     0 25347.3404    0  548 14063.5201 25347.3404  80.2%     -  515s
     0     0 25331.0436    0  539 14063.5201 25331.0436  80.1%     -  519s
     0     0 25326.1759    0  543 14063.5201 25326.1759  80.1%     -  521s
     0     0 25318.8601    0  497 14063.5201 25318.8601  80.0%     -  523s
     0     0 25312.5220    0  500 14063.5201 25312.5220  80.0%     -  527s
     0     0 25310.4227    0  496 14063.5201 25310.4227  80.0%     -  528s
     0     0 25252.7729    0  498 14063.5201 25252.7729  79.6%     -  541s
H    0     0                    14247.371235 25252.6326  77.2%     -  541s
H    0     0                    14449.342796 25252.6326  74.8%     -  541s
     0     0 25223.5582    0  495 14449.3428 25223.5582  74.6%     -  546s
     0     0 25219.8403    0  492 14449.3428 25219.8403  74.5%     -  548s
     0     0 25218.3804    0  508 14449.3428 25218.3804  74.5%     -  549s
     0     0 25200.0525    0  403 14449.3428 25200.0525  74.4%     -  555s
     0     0 25194.9316    0  409 14449.3428 25194.9316  74.4%     -  558s
     0     0 25189.8715    0  409 14449.3428 25189.8715  74.3%     -  561s
     0     0 25187.8863    0  421 14449.3428 25187.8863  74.3%     -  562s
     0     0 25168.5042    0  486 14449.3428 25168.5042  74.2%     -  568s
H    0     0                    14456.107111 25166.7887  74.1%     -  569s
     0     0 25156.1621    0  481 14456.1071 25156.1621  74.0%     -  574s
     0     0 25153.8174    0  481 14456.1071 25153.8174  74.0%     -  575s
     0     0 25139.6986    0  486 14456.1071 25139.6986  73.9%     -  581s
     0     0 25138.1542    0  475 14456.1071 25138.1542  73.9%     -  583s
     0     0 25121.4135    0  486 14456.1071 25121.4135  73.8%     -  589s
     0     0 25121.2398    0  486 14456.1071 25121.2398  73.8%     -  591s
H    0     0                    14478.329821 25121.2398  73.5%     -  604s
H    0     0                    14609.491310 25121.2398  72.0%     -  626s
H    0     0                    14942.281413 25121.2398  68.1%     -  626s
     0     2 25121.2398    0  486 14942.2814 25121.2398  68.1%     -  629s
     1     3 24505.8409    1  337 14942.2814 25121.2398  68.1%  9264  638s
     2     5 24115.6454    2  278 14942.2814 25121.2398  68.1%  8618  646s
     4    10 24632.9938    2  363 14942.2814 24900.9221  66.6%  8173  657s
     9    19 23405.2626    4  408 14942.2814 24632.9650  64.9%  8347  679s
    18    37 23239.4837    5  430 14942.2814 24630.5804  64.8% 11373  697s
    36    50 22652.5134    5  351 14942.2814 24374.0752  63.1% 13424  750s
    49    77 23019.0264    7  429 14942.2814 24374.0752  63.1% 17186  778s
    76   167 23005.6832    8  207 14942.2814 24374.0752  63.1% 13465  805s
   166   225 22662.6572   10  322 14942.2814 24374.0752  63.1%  9648  827s
H  186   225                    14996.581162 24374.0752  62.5%  8963  827s
   224   286 20179.1764   13  321 14996.5812 24374.0752  62.5%  8140  846s
   285   315 22763.7396   10  204 14996.5812 24374.0752  62.5%  7268  869s
   314   371 22661.1792   11  203 14996.5812 24374.0752  62.5%  6987  889s
   370   421 20648.5975   13  286 14996.5812 24374.0752  62.5%  6551  909s
   420   458 22474.6198   12  196 14996.5812 24374.0752  62.5%  6320  930s
   459   508 19775.0823   16  386 14996.5812 24374.0752  62.5%  6272  947s
   509   553 22725.5137   11  195 14996.5812 24374.0752  62.5%  6335  969s
   564   600 19070.9528   18  366 14996.5812 24374.0752  62.5%  6184  990s
   623   623 21274.9515   16  223 14996.5812 24374.0752  62.5%  5986 1007s
   654   652 21216.5659   17  202 14996.5812 24374.0752  62.5%  5878 1024s
H  687   652                    15012.803774 24374.0752  62.4%  5857 1024s
   695   698 18196.6406   20  266 15012.8038 24374.0752  62.4%  5839 1044s
   747   722 20133.6062   20  339 15012.8038 24374.0752  62.4%  5742 1061s
   797   771 19874.9382   21  330 15012.8038 24374.0752  62.4%  5638 1080s
   866   839 19385.8915   23  287 15012.8038 24374.0752  62.4%  5474 1098s
   962   918 19212.3268   26  291 15012.8038 24374.0752  62.4%  5190 1120s
  1076   939 18966.3111   31  288 15012.8038 24374.0752  62.4%  4886 1137s
  1111   945 18960.5924   32  220 15012.8038 24374.0752  62.4%  4829 1154s
H 1141   945                    15015.472068 24374.0752  62.3%  4803 1154s
  1159   990 infeasible   33      15015.4721 24374.0752  62.3%  4794 1177s
  1286  1028 18453.7017   36  220 15015.4721 24374.0752  62.3%  4566 1199s
  1382  1130 17818.2810   38  213 15015.4721 24374.0752  62.3%  4470 1224s
  1543  1141 16888.1914   46  214 15015.4721 24374.0752  62.3%  4209 1248s
  1671  1163 15710.5536   56  217 15015.4721 23262.3095  54.9%  4046 1270s
  1707  1179 15650.8993   57  178 15015.4721 23262.3095  54.9%  4078 1291s
  1751  1223 15489.8290   58  193 15015.4721 23262.3095  54.9%  4070 1313s
  1819  1271 18837.3163   12  244 15015.4721 23262.3095  54.9%  4036 1335s
  1907  1296 18748.5352   13  229 15015.4721 23262.3095  54.9%  3993 1359s
  1942  1331 21410.2877   10  350 15015.4721 23262.3095  54.9%  4038 1382s
  1993  1406     cutoff   14      15015.4721 23262.3095  54.9%  4032 1408s
  2099  1496 20458.3000   12  499 15015.4721 23262.3095  54.9%  3990 1438s
  2247  1586 infeasible   14      15015.4721 23239.3667  54.8%  3884 1466s
  2397  1665 21988.6613    7  315 15015.4721 23239.3667  54.8%  3807 1495s
  2591  1741 19353.7192    8  192 15015.4721 23239.3667  54.8%  3695 1529s
  2789  1817 16577.9110   10  151 15015.4721 23239.3667  54.8%  3603 1564s
  2924  1903 22009.6953    9  354 15015.4721 23226.9752  54.7%  3610 1599s
  3071  2009 19219.9393    9  197 15015.4721 23061.6815  53.6%  3616 1635s
  3261  2086 15892.2537   10  156 15015.4721 22968.1772  53.0%  3586 1673s
  3436  2156 15441.8766   65  368 15015.4721 22755.1441  51.5%  3583 1718s
  3601  2222 20976.0133    7  403 15015.4721 22725.3198  51.3%  3602 1761s
  3741  2263 20931.3470    8  401 15015.4721 22725.3198  51.3%  3634 1794s
  3826  2351 15215.9205   10  428 15015.4721 22725.3198  51.3%  3656 1838s
  3964  2472 20345.1977   11  339 15015.4721 22671.9829  51.0%  3693 1881s
  4199  2580 19573.5276   14  321 15015.4721 22670.0220  51.0%  3677 1933s
  4395  2581 21172.0150   22  486 15015.4721 22670.0220  51.0%  3695 2099s
  4397  2582 17249.8711   31  205 15015.4721 22670.0220  51.0%  3693 2118s
  4398  2583 17386.9049   46  390 15015.4721 22670.0220  51.0%  3692 2198s
  4399  2584 19359.9588    8  463 15015.4721 22670.0220  51.0%  3691 2255s
  4400  2584 20737.0574    9  365 15015.4721 22670.0220  51.0%  3690 2296s
  4401  2585 19503.5568   25  504 15015.4721 22670.0220  51.0%  3689 2321s
  4402  2586 21299.7700   14  356 15015.4721 22670.0220  51.0%  3689 2338s
  4403  2586 22053.8044   11  487 15015.4721 22670.0220  51.0%  3688 2351s
  4404  2587 21561.7271   13  440 15015.4721 22670.0220  51.0%  3687 2369s
  4405  2588 20617.2061   11  434 15015.4721 22670.0220  51.0%  3686 2381s
  4406  2588 17978.3783   36  485 15015.4721 22670.0220  51.0%  3685 2392s
  4407  2589 20458.4714   12  470 15015.4721 22670.0220  51.0%  3684 2400s
  4408  2590 16636.5658   49  434 15015.4721 22670.0220  51.0%  3684 2405s
  4409  2590 21496.6698   12  472 15015.4721 22670.0220  51.0%  3683 2412s
  4410  2591 21664.5054   14  460 15015.4721 22670.0220  51.0%  3682 2420s
  4411  2592 15488.7555   59  475 15015.4721 22670.0220  51.0%  3681 2426s
  4412  2592 21877.9279   11  521 15015.4721 22670.0220  51.0%  3680 2444s
  4413  2593 21427.3795   11  507 15015.4721 22670.0220  51.0%  3679 2447s
  4414  2594 16039.4239   54  425 15015.4721 22670.0220  51.0%  3679 2454s
  4415  2594 17795.7993   17  438 15015.4721 22670.0220  51.0%  3678 2471s
  4416  2595 18618.1997   36  438 15015.4721 22670.0220  51.0%  3677 2477s
  4417  2596 21907.7111   11  412 15015.4721 22670.0220  51.0%  3676 2489s
  4418  2596 18104.1747   35  364 15015.4721 22670.0220  51.0%  3675 2493s
  4419  2597 15819.5138   37  371 15015.4721 22670.0220  51.0%  3674 2505s
  4420  2598 18953.0862   24  375 15015.4721 22670.0220  51.0%  3674 2511s
  4421  2598 20129.9387   21  488 15015.4721 22670.0220  51.0%  3673 2522s
  4422  2599 17558.4973   19  491 15015.4721 22670.0220  51.0%  3672 2527s
  4423  2600 16378.1125   48  525 15015.4721 22670.0220  51.0%  3671 2536s
  4424  2600 16873.7115   50  513 15015.4721 22670.0220  51.0%  3670 2543s
  4425  2601 20419.1354   22  515 15015.4721 22670.0220  51.0%  3669 2552s
  4426  2602 20576.8026   11  523 15015.4721 22670.0220  51.0%  3669 2556s
  4427  2602 18681.7683   24  525 15015.4721 22670.0220  51.0%  3668 2562s
  4428  2603 17371.6766   29  535 15015.4721 22670.0220  51.0%  3667 2566s
  4429  2604 15194.1524   45  523 15015.4721 22670.0220  51.0%  3666 2572s
  4430  2604 21031.4662   15  523 15015.4721 22670.0220  51.0%  3665 2597s
  4431  2605 17393.7411   30  523 15015.4721 22670.0220  51.0%  3664 2626s
  4432  2608 22670.0220   13  394 15015.4721 22670.0220  51.0%  3754 2655s
  4433  2610 22670.0220   14  248 15015.4721 22670.0220  51.0%  3756 2677s
  4436  2615 22670.0220   15  250 15015.4721 22670.0220  51.0%  3759 2703s
  4442  2625 21821.9552   16  311 15015.4721 22670.0220  51.0%  3769 2743s
  4454  2633 22670.0220   16  353 15015.4721 22670.0220  51.0%  3806 2794s
  4466  2660 22670.0220   17  363 15015.4721 22670.0220  51.0%  3831 2867s
  4498  2695 21614.9835   18  466 15015.4721 22670.0220  51.0%  3964 2912s
  4577  2708 21246.1438   19  402 15015.4721 22670.0220  51.0%  4152 2953s
  4634  2745 21230.9625   19  451 15015.4721 22670.0220  51.0%  4184 3000s
  4703  2748 21140.6404   20  402 15015.4721 22670.0220  51.0%  4213 3027s
  4740  2762 20831.5921   20  386 15015.4721 22670.0220  51.0%  4243 3054s
  4787  2772 19425.5928   27  325 15015.4721 22670.0220  51.0%  4259 3078s
  4834  2791 20662.9539   21  435 15015.4721 22465.3490  49.6%  4270 3128s
  4890  2806 20447.5768   22  328 15015.4721 22465.3490  49.6%  4282 3157s
  4966  2816 20252.0085   23  383 15015.4721 22465.3490  49.6%  4283 3191s
  5040  2807 19903.6361   24  408 15015.4721 22465.3490  49.6%  4287 3213s
  5082  2808 19495.8984   25  396 15015.4721 22465.3490  49.6%  4306 3236s
  5133  2816 16519.1575   36  360 15015.4721 22465.3490  49.6%  4304 3277s
  5181  2807 18939.8430   26  400 15015.4721 22465.3490  49.6%  4311 3299s
  5228  2807 18912.0439   27  396 15015.4721 22465.3490  49.6%  4329 3323s
  5280  2809     cutoff   27      15015.4721 21905.2249  45.9%  4332 3354s
  5349  2808     cutoff   29      15015.4721 21644.0472  44.1%  4328 3380s
  5425  2791 17566.6766   31  403 15015.4721 21615.7048  44.0%  4338 3402s
  5478  2785     cutoff   32      15015.4721 21562.2732  43.6%  4331 3433s
  5530  2769 16896.2755   33  379 15015.4721 21562.2732  43.6%  4330 3464s
  5602  2773     cutoff   33      15015.4721 21375.5747  42.4%  4332 3495s
H 5648  2626                    15015.497045 21375.5747  42.4%  4342 3495s
  5668  2645 16538.3347   35  295 15015.4970 21375.5747  42.4%  4344 3531s
  5749  2657     cutoff   36      15015.4970 21375.5747  42.4%  4354 3562s
  5858  2651     cutoff   37      15015.4970 21375.5747  42.4%  4344 3599s
  5979  2612 infeasible   40      15015.4970 21375.5747  42.4%  4326 3600s

Cutting planes:
  Gomory: 9
  Implied bound: 21
  Projected implied bound: 305
  MIR: 1272
  Mixing: 4
  Flow cover: 2059
  RLT: 77
  Relax-and-lift: 313

Explored 5990 nodes (26426308 simplex iterations) in 3600.04 seconds (8727.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15015.5 15015.5 15012.8 ... 14247.4

Time limit reached
Best objective 1.501549704487e+04, best bound 2.137557469920e+04, gap 42.3568%
  WARNING: Time limit reached. Using best solution found (gap: 42.36%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 15015.50, θ = 155696.52
  Upper Bound (UB) = 15015.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155696.52
  [DEBUG]   ✓ Scenario 0: θ = 155696.52 ≤ Q = 155696.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155696.52 ≤ Q = 155696.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 155696.52 ≤ Q = 155696.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 155696.52 ≤ Q = 155696.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 155696.52 ≤ Q = 155696.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 155696.52 ≤ Q = 155696.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 155696.52 ≤ Q = 155696.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 155696.52 ≤ Q = 155696.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 155696.52 ≤ Q = 155696.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 155696.52 ≤ Q = 155696.52 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1815ad28
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe7ea52d8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-14, 2e+02]
Found heuristic solution: objective 1.167221e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.00s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6254639.4739
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.414371e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141437.12    0  133 6254639.47 -141437.12   102%     -    0s
H    0     0                    -101938.1172 -141437.12  38.7%     -    0s
H    0     0                    -103756.2663 -141437.12  36.3%     -    0s
H    0     0                    -108953.6068 -141437.12  29.8%     -    0s
H    0     0                    -109563.2092 -121851.14  11.2%     -    0s
     0     0 -121851.14    0   95 -109563.21 -121851.14  11.2%     -    0s
H    0     0                    -118482.5665 -121756.91  2.76%     -    0s
H    0     0                    -118800.8511 -121756.91  2.49%     -    0s
H    0     0                    -119696.0211 -121756.91  1.72%     -    0s
H    0     0                    -120014.3057 -121756.91  1.45%     -    0s
     0     0 -121588.27    0   91 -120014.31 -121588.27  1.31%     -    0s
     0     0 -121584.74    0   91 -120014.31 -121584.74  1.31%     -    0s
     0     0 -120761.62    0   62 -120014.31 -120761.62  0.62%     -    0s
H    0     0                    -120292.0690 -120743.15  0.37%     -    0s
     0     0 -120682.54    0   43 -120292.07 -120682.54  0.32%     -    0s
     0     0 -120665.46    0   50 -120292.07 -120665.46  0.31%     -    0s
     0     0 -120514.04    0   44 -120292.07 -120514.04  0.18%     -    0s
     0     0 -120468.00    0   43 -120292.07 -120468.00  0.15%     -    0s
     0     0 -120464.01    0   44 -120292.07 -120464.01  0.14%     -    0s
     0     0 -120440.75    0   44 -120292.07 -120440.75  0.12%     -    0s
     0     0 -120440.75    0   45 -120292.07 -120440.75  0.12%     -    0s
     0     0 -120440.75    0   45 -120292.07 -120440.75  0.12%     -    0s
     0     0 -120440.75    0   35 -120292.07 -120440.75  0.12%     -    0s
     0     0 -120440.75    0   33 -120292.07 -120440.75  0.12%     -    0s
     0     0 -120440.75    0   30 -120292.07 -120440.75  0.12%     -    0s
     0     0 -120440.75    0   29 -120292.07 -120440.75  0.12%     -    0s
     0     0 -120359.97    0   10 -120292.07 -120359.97  0.06%     -    0s
     0     0 -120313.63    0    8 -120292.07 -120313.63  0.02%     -    0s
     0     0 -120313.63    0    4 -120292.07 -120313.63  0.02%     -    0s
H    0     0                    -120297.8803 -120313.63  0.01%     -    0s
H    0     0                    -120313.4258 -120313.43  0.00%     -    0s
     0     0          -    0      -120313.43 -120313.43  0.00%     -    0s

Cutting planes:
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (944 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120313 -120298 -120292 ... -108954
No other solutions better than -120313

Optimal solution found (tolerance 1.00e-06)
Best objective -1.203134257942e+05, best bound -1.203134257942e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 142625.82
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120313.43
  [DEBUG]   S×d_nominal = 262939.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262939.25 + -120313.43 = 142625.82
  [DEBUG]   Current θ from Master = 155696.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13070.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1944.80
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 2814.2123, Absolute Gap = 2814.2123, Relative Gap = 0.187421
  Not converged yet (gap = 2814.21 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481324 nonzeros
Model fingerprint: 0x53722c2f
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68882 rows and 27962 columns
Presolve time: 1.43s
Presolved: 100691 rows, 42938 columns, 607109 nonzeros
Variable types: 40679 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -376387.6593
Found heuristic solution: objective -221895.3170

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.524e+06
 Factor NZ  : 1.006e+07 (roughly 140 MB of memory)
 Factor Ops : 1.834e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69681541e+07  1.74664371e+08  9.76e+04 2.59e+01  7.39e+04     3s
   1  -1.26446074e+07  1.52422248e+08  6.64e+04 6.07e+01  4.94e+04     3s
   2  -4.77553261e+06  1.15830459e+08  2.46e+04 2.99e+00  1.88e+04     3s
   3  -8.43914167e+05  8.80568351e+07  9.84e+02 1.33e+00  1.20e+03     3s
   4  -5.56643754e+05  3.96559827e+07  3.02e+02 4.56e-01  4.14e+02     3s
   5  -4.05844785e+05  2.84559005e+07  9.76e+01 3.05e-01  2.15e+02     3s
   6  -3.34995120e+05  2.03652380e+07  5.70e+01 2.08e-01  1.42e+02     3s
   7  -2.10884515e+05  1.49966760e+07  1.64e+01 1.47e-01  8.95e+01     3s
   8  -9.81202450e+04  8.73055513e+06  5.55e+00 8.12e-02  4.94e+01     3s
   9  -8.16311552e+04  5.71631902e+06  3.40e+00 5.25e-02  3.21e+01     3s
  10  -4.20104800e+04  2.56883252e+06  8.93e-01 2.32e-02  1.42e+01     3s
  11  -1.14823432e+04  7.57733207e+05  3.04e-01 6.28e-03  4.18e+00     3s
  12  -1.50348320e+03  4.49294369e+05  1.62e-01 3.63e-03  2.45e+00     3s
  13   7.57261057e+03  2.50560320e+05  8.59e-02 1.93e-03  1.32e+00     3s
  14   1.34394399e+04  1.96377319e+05  6.05e-02 1.60e-03  9.92e-01     3s
  15   1.74579808e+04  1.63765289e+05  4.80e-02 1.44e-03  7.93e-01     3s
  16   2.30917805e+04  1.30706249e+05  3.31e-02 1.08e-03  5.83e-01     3s
  17   2.62489288e+04  1.11697495e+05  2.67e-02 1.02e-03  4.63e-01     4s
  18   2.83402171e+04  8.46471211e+04  2.28e-02 6.59e-04  3.05e-01     4s
  19   3.16891438e+04  7.29398511e+04  1.77e-02 4.68e-04  2.24e-01     4s
  20   3.42011030e+04  6.85651996e+04  1.43e-02 3.95e-04  1.86e-01     4s
  21   3.65149461e+04  6.32284595e+04  1.12e-02 3.02e-04  1.45e-01     4s
  22   3.83941091e+04  5.85161885e+04  8.83e-03 2.18e-04  1.09e-01     4s
  23   4.00764966e+04  5.53146267e+04  6.89e-03 1.57e-04  8.26e-02     4s
  24   4.19083705e+04  5.33950674e+04  4.90e-03 1.22e-04  6.23e-02     4s
  25   4.25686313e+04  5.22936132e+04  4.18e-03 1.02e-04  5.27e-02     4s
  26   4.35924196e+04  5.17797009e+04  3.13e-03 8.93e-05  4.44e-02     4s
  27   4.42266369e+04  5.08817654e+04  2.47e-03 7.52e-05  3.61e-02     4s
  28   4.46507763e+04  4.93861356e+04  2.04e-03 5.17e-05  2.57e-02     4s
  29   4.51137048e+04  4.88734558e+04  1.59e-03 4.09e-05  2.04e-02     4s
  30   4.54849010e+04  4.79953126e+04  1.23e-03 3.08e-05  1.36e-02     4s
  31   4.57999741e+04  4.77535454e+04  9.54e-04 2.42e-05  1.06e-02     4s
  32   4.59408694e+04  4.76191556e+04  8.24e-04 1.93e-05  9.10e-03     5s
  33   4.61215044e+04  4.73727125e+04  6.57e-04 1.26e-05  6.78e-03     5s
  34   4.62293837e+04  4.72177581e+04  5.61e-04 1.50e-05  5.36e-03     5s
  35   4.64020222e+04  4.71501555e+04  4.14e-04 1.19e-05  4.06e-03     5s
  36   4.65497990e+04  4.70635378e+04  2.82e-04 7.86e-06  2.78e-03     5s
  37   4.66185029e+04  4.69858823e+04  2.22e-04 4.50e-06  1.99e-03     5s
  38   4.66459502e+04  4.69656909e+04  1.98e-04 3.56e-06  1.73e-03     5s
  39   4.67252136e+04  4.69378505e+04  1.28e-04 7.01e-06  1.15e-03     5s
  40   4.67668415e+04  4.69216341e+04  9.33e-05 4.44e-06  8.39e-04     5s
  41   4.68292217e+04  4.69042064e+04  4.20e-05 3.78e-06  4.06e-04     5s
  42   4.68618188e+04  4.68992489e+04  1.61e-05 2.86e-06  2.03e-04     5s
  43   4.68743031e+04  4.68927687e+04  6.63e-06 1.57e-06  1.00e-04     5s
  44   4.68811661e+04  4.68918437e+04  2.20e-06 1.39e-06  5.79e-05     5s
  45   4.68829062e+04  4.68856939e+04  1.08e-06 1.86e-07  1.51e-05     5s
  46   4.68842600e+04  4.68849302e+04  2.03e-07 4.95e-08  3.63e-06     5s
  47   4.68845287e+04  4.68847682e+04  5.00e-08 2.27e-08  1.30e-06     6s
  48   4.68846156e+04  4.68846744e+04  8.37e-09 7.38e-09  3.18e-07     6s
  49   4.68846261e+04  4.68846284e+04  2.11e-09 3.05e-10  1.25e-08     6s
  50   4.68846263e+04  4.68846263e+04  7.39e-11 1.34e-10  6.76e-13     6s

Barrier solved model in 50 iterations and 5.69 seconds (9.56 work units)
Optimal objective 4.68846263e+04


Root crossover log...

   85823 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    1590 PPushes remaining with PInf 5.8552960e-08                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.2156320e-11      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31915    4.6884626e+04   0.000000e+00   0.000000e+00      8s
   31915    4.6884626e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 4.688463e+04, 31915 iterations, 5.71 seconds (11.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46884.6263    0  313 -221895.32 46884.6263   121%     -    8s
H    0     0                    -217244.3078 46884.6263   122%     -    8s
H    0     0                    -124781.6683 46884.6263   138%     -    8s
H    0     0                    -122395.1957 46884.6263   138%     -    8s
H    0     0                    -121304.1358 46884.6263   139%     -    8s
H    0     0                    -121272.0180 46884.6263   139%     -    8s
H    0     0                    -121008.2122 46884.6263   139%     -    8s
H    0     0                    -62600.94887 46884.6263   175%     -    8s
H    0     0                    10650.229518 46884.6263   340%     -    8s
H    0     0                    10809.223529 46884.6263   334%     -    8s
H    0     0                    12132.255181 46884.6263   286%     -    8s
     0     0 39225.7829    0  414 12132.2552 39225.7829   223%     -   40s
     0     0 38618.9968    0  449 12132.2552 38618.9968   218%     -   53s
     0     0 38529.7059    0  467 12132.2552 38529.7059   218%     -   60s
     0     0 38485.3179    0  450 12132.2552 38485.3179   217%     -   64s
H    0     0                    12539.843742 38480.2079   207%     -   65s
     0     0 38480.2079    0  446 12539.8437 38480.2079   207%     -   65s
     0     0 38479.3959    0  448 12539.8437 38479.3959   207%     -   66s
H    0     0                    12609.031281 35006.6627   178%     -  116s
     0     0 35006.6627    0  398 12609.0313 35006.6627   178%     -  116s
H    0     0                    12628.155985 33952.1277   169%     -  150s
H    0     0                    12731.903524 33952.1277   167%     -  150s
     0     0 33952.1277    0  417 12731.9035 33952.1277   167%     -  150s
     0     0 33676.7789    0  501 12731.9035 33676.7789   165%     -  174s
     0     0 33598.7389    0  512 12731.9035 33598.7389   164%     -  191s
     0     0 33584.0775    0  495 12731.9035 33584.0775   164%     -  198s
     0     0 33571.3476    0  500 12731.9035 33571.3476   164%     -  205s
     0     0 33564.5655    0  502 12731.9035 33564.5655   164%     -  211s
     0     0 33562.8687    0  504 12731.9035 33562.8687   164%     -  213s
     0     0 33562.3101    0  504 12731.9035 33562.3101   164%     -  214s
     0     0 31567.6796    0  425 12731.9035 31567.6796   148%     -  296s
H    0     0                    12824.222431 31567.6308   146%     -  297s
H    0     0                    12959.018255 30664.3414   137%     -  338s
     0     0 30664.3414    0  404 12959.0183 30664.3414   137%     -  338s
     0     0 30425.2383    0  386 12959.0183 30425.2383   135%     -  359s
     0     0 30267.8310    0  395 12959.0183 30267.8310   134%     -  383s
     0     0 30150.8169    0  444 12959.0183 30150.8169   133%     -  401s
H    0     0                    13212.114663 30075.0270   128%     -  413s
H    0     0                    13256.672965 30075.0270   127%     -  414s
H    0     0                    13387.604888 30075.0270   125%     -  414s
     0     0 30075.0270    0  455 13387.6049 30075.0270   125%     -  414s
     0     0 30048.0083    0  469 13387.6049 30048.0083   124%     -  426s
     0     0 30036.4561    0  463 13387.6049 30036.4561   124%     -  434s
     0     0 30029.5275    0  466 13387.6049 30029.5275   124%     -  441s
     0     0 30026.8547    0  448 13387.6049 30026.8547   124%     -  444s
     0     0 30012.4003    0  447 13387.6049 30012.4003   124%     -  451s
     0     0 30009.8277    0  442 13387.6049 30009.8277   124%     -  455s
H    0     0                    13514.722356 28051.2638   108%     -  546s
H    0     0                    13808.233014 28051.2638   103%     -  546s
H    0     0                    13822.438109 28051.2638   103%     -  546s
H    0     0                    13827.318990 28051.2638   103%     -  546s
     0     0 28051.2638    0  391 13827.3190 28051.2638   103%     -  546s
     0     0 27710.4894    0  305 13827.3190 27710.4894   100%     -  583s
H    0     0                    13849.057199 27395.8049  97.8%     -  604s
     0     0 27395.8049    0  510 13849.0572 27395.8049  97.8%     -  604s
     0     0 27214.4526    0  523 13849.0572 27214.4526  96.5%     -  620s
     0     0 27147.4352    0  427 13849.0572 27147.4352  96.0%     -  634s
     0     0 27114.6186    0  425 13849.0572 27114.6186  95.8%     -  642s
     0     0 27082.4549    0  383 13849.0572 27082.4549  95.6%     -  649s
     0     0 27059.1436    0  465 13849.0572 27059.1436  95.4%     -  657s
     0     0 27051.7298    0  414 13849.0572 27051.7298  95.3%     -  661s
     0     0 27030.8559    0  416 13849.0572 27030.8559  95.2%     -  668s
     0     0 27017.7879    0  424 13849.0572 27017.7879  95.1%     -  673s
     0     0 27016.7970    0  431 13849.0572 27016.7970  95.1%     -  675s
     0     0 26344.5115    0  435 13849.0572 26344.5115  90.2%     -  714s
     0     0 26136.5590    0  499 13849.0572 26136.5590  88.7%     -  735s
     0     0 26082.3952    0  497 13849.0572 26082.3952  88.3%     -  747s
     0     0 26068.0339    0  486 13849.0572 26068.0339  88.2%     -  753s
     0     0 26050.7930    0  438 13849.0572 26050.7930  88.1%     -  758s
     0     0 26040.5500    0  445 13849.0572 26040.5500  88.0%     -  763s
     0     0 26032.8733    0  481 13849.0572 26032.8733  88.0%     -  768s
     0     0 26027.9584    0  471 13849.0572 26027.9584  87.9%     -  772s
     0     0 26022.2530    0  479 13849.0572 26022.2530  87.9%     -  775s
     0     0 26017.3956    0  479 13849.0572 26017.3956  87.9%     -  777s
     0     0 26016.7380    0  485 13849.0572 26016.7380  87.9%     -  778s
     0     0 25767.6819    0  444 13849.0572 25767.6819  86.1%     -  801s
H    0     0                    13980.571329 25767.3390  84.3%     -  806s
     0     0 25677.3471    0  472 13980.5713 25677.3471  83.7%     -  820s
     0     0 25650.9643    0  480 13980.5713 25650.9643  83.5%     -  828s
     0     0 25632.5751    0  485 13980.5713 25632.5751  83.3%     -  834s
     0     0 25627.6575    0  441 13980.5713 25627.6575  83.3%     -  838s
     0     0 25621.1511    0  443 13980.5713 25621.1511  83.3%     -  844s
     0     0 25608.2979    0  440 13980.5713 25608.2979  83.2%     -  851s
     0     0 25603.2608    0  444 13980.5713 25603.2608  83.1%     -  857s
     0     0 25600.6482    0  438 13980.5713 25600.6482  83.1%     -  861s
     0     0 25454.2292    0  374 13980.5713 25454.2292  82.1%     -  879s
     0     0 25437.3406    0  324 13980.5713 25437.3406  81.9%     -  885s
     0     0 25434.6614    0  328 13980.5713 25434.6614  81.9%     -  890s
     0     0 25381.3328    0  562 13980.5713 25381.3328  81.5%     -  908s
H    0     0                    14002.046481 25381.1432  81.3%     -  915s
H    0     0                    14233.100545 25381.1432  78.3%     -  915s
     0     0 25364.3502    0  439 14233.1005 25364.3502  78.2%     -  923s
     0     0 25358.4076    0  559 14233.1005 25358.4076  78.2%     -  929s
     0     0 25356.6659    0  557 14233.1005 25356.6659  78.2%     -  932s
     0     0 25315.4420    0  423 14233.1005 25315.4420  77.9%     -  941s
     0     0 25307.8236    0  428 14233.1005 25307.8236  77.8%     -  945s
     0     0 25305.1276    0  422 14233.1005 25305.1276  77.8%     -  948s
     0     0 25279.5002    0  421 14233.1005 25279.5002  77.6%     -  958s
     0     0 25274.7717    0  353 14233.1005 25274.7717  77.6%     -  969s
     0     0 25271.7070    0  310 14233.1005 25271.7070  77.6%     -  971s
     0     0 25248.6986    0  306 14233.1005 25248.6986  77.4%     -  979s
     0     0 25241.4912    0  309 14233.1005 25241.4912  77.3%     -  983s
     0     0 25240.5406    0  312 14233.1005 25240.5406  77.3%     -  984s
     0     0 25235.7647    0  330 14233.1005 25235.7647  77.3%     -  988s
     0     0 25235.3498    0  330 14233.1005 25235.3498  77.3%     -  989s
     0     2 25235.2762    0  330 14233.1005 25235.2762  77.3%     - 1084s
     1     3 25074.5169    1  325 14233.1005 25235.0836  77.3%  9882 1094s
     2     5 24942.7943    2  309 14233.1005 25235.0836  77.3%  9392 1105s
     4     8 24885.9890    2  316 14233.1005 25180.5895  76.9%  9343 1121s
     7    15 24049.4326    4  329 14233.1005 25180.5895  76.9% 10579 1144s
    14    30 24541.9076    4  376 14233.1005 24884.7239  74.8% 11964 1168s
    29    45 23831.8338    5  358 14233.1005 24610.6903  72.9% 16448 1235s
    44    76 23312.5525    6  359 14233.1005 24610.6903  72.9% 15668 1379s
    75   115 23180.8337    7  332 14233.1005 24348.2367  71.1% 15409 1429s
   114   154 23019.2167    8  341 14233.1005 24348.2367  71.1% 14156 1467s
   153   205 23018.2803    9  341 14233.1005 24348.2367  71.1% 14745 1501s
   204   263 22534.7666   10  262 14233.1005 24348.2367  71.1% 12424 1532s
   263   309 22367.3043   11  438 14233.1005 24348.2367  71.1% 10605 1564s
   323   356 17222.1194   11  201 14233.1005 24348.2367  71.1%  9448 1600s
   374   388 17128.3825   12  203 14233.1005 24348.2367  71.1%  8729 1632s
   408   423 16937.2541   13  178 14233.1005 24348.2367  71.1%  8480 1665s
   461   464 16573.0289   14  164 14233.1005 24348.2367  71.1%  8270 1696s
   514   513 16071.7157   15  110 14233.1005 24348.2367  71.1%  7935 1723s
   574   558 16015.1293   16  110 14233.1005 24348.2367  71.1%  7581 1766s
   647   599 15942.2350   17  104 14233.1005 24348.2367  71.1%  7310 1791s
   717   633     cutoff   21      14233.1005 24348.2367  71.1%  6967 1818s
   771   670 infeasible   19      14233.1005 24348.2367  71.1%  6892 1845s
   818   724 15832.1290   21  257 14233.1005 24348.2367  71.1%  6881 1870s
   890   766 15624.6913   22  260 14233.1005 24348.2367  71.1%  6611 1893s
   956   793 16249.6643   14  178 14233.1005 24348.2367  71.1%  6405 1926s
  1019   828 infeasible   16      14233.1005 24348.2367  71.1%  6283 1950s
  1084   915 15272.1052   25  269 14233.1005 24348.2367  71.1%  6136 1979s
  1211   971 23177.1855    8  322 14233.1005 24348.2367  71.1%  5817 2008s
  1325  1021 14613.8135   28  290 14233.1005 24348.2367  71.1%  5549 2036s
  1441  1079 21969.1307    9  230 14233.1005 24348.2367  71.1%  5377 2070s
  1549  1179 16739.0706   10  176 14233.1005 24348.2367  71.1%  5271 2101s
  1700  1217 16204.4123   12  137 14233.1005 24348.2367  71.1%  5046 2133s
  1850  1261 16144.6720   12  139 14233.1005 24348.2367  71.1%  4898 2166s
  1998  1280 15239.1860   13  121 14233.1005 24348.2367  71.1%  4791 2199s
  2102  1292     cutoff   15      14233.1005 24348.2367  71.1%  4781 2235s
  2187  1329 19383.0593   14  438 14233.1005 24348.2367  71.1%  4779 2278s
  2270  1356 17880.2797   12  211 14233.1005 24348.2367  71.1%  4768 2323s
  2321  1402 infeasible   13      14233.1005 24348.2367  71.1%  4825 2369s
  2411  1470 20626.0433   15  411 14233.1005 24348.2367  71.1%  4853 2415s
  2523  1527 20463.3767   16  392 14233.1005 24348.2367  71.1%  4866 2458s
  2668  1570 14513.8615   19  153 14233.1005 24348.2367  71.1%  4816 2509s
  2775  1667 19686.6086   21  422 14233.1005 24348.2367  71.1%  4837 2557s
  2890  1807 19379.6813   28  418 14233.1005 24348.2367  71.1%  4831 2611s
  3058  1966 19128.3819   33  402 14233.1005 24348.2367  71.1%  4789 2661s
H 3147  1953                    14342.586546 23939.2304  66.9%  4719 2661s
H 3277  1979                    14517.860294 23939.2304  64.9%  4698 2710s
H 3316  1969                    14560.286152 23938.7595  64.4%  4671 2710s
H 3353  1946                    14605.570462 23938.7595  63.9%  4644 2710s
H 3358  1890                    14728.084267 23938.7595  62.5%  4647 2710s
H 3387  1866                    14775.215625 23938.7595  62.0%  4645 2710s
H 3402  1863                    14778.632982 23938.7595  62.0%  4649 2710s
  3408  1992 17384.6705   66  227 14778.6330 23938.7595  62.0%  4651 2766s
  3616  2040 16182.2517   88  203 14778.6330 23815.4045  61.1%  4581 2829s
  3776  2099 infeasible   11      14778.6330 23815.4045  61.1%  4603 2910s
  3909  2174 21926.8620   10  537 14778.6330 23815.4045  61.1%  4645 2984s
  4063  2241 18689.8680   11  422 14778.6330 23123.5866  56.5%  4677 3045s
H 4133  2192                    14866.277532 23112.8921  55.5%  4712 3045s
H 4146  2178                    14893.094235 23112.8921  55.2%  4712 3045s
  4219  2266 20086.0116   13  426 14893.0942 23112.8921  55.2%  4691 3119s
  4381  2267 15646.0328   37  330 14893.0942 23112.8921  55.2%  4723 3269s
  4383  2268 15597.1396   31  182 14893.0942 23112.8921  55.2%  4721 3281s
  4384  2269 17823.4861   15  244 14893.0942 23112.8921  55.2%  4720 3338s
  4385  2270 19644.6462   27  322 14893.0942 23112.8921  55.2%  4718 3416s
  4386  2270 15660.6709   26  384 14893.0942 23112.8921  55.2%  4717 3465s
H 4386  2156                    14912.023815 23112.8921  55.0%  4717 3500s
  4388  2158 15735.9324   25  401 14912.0238 23112.8921  55.0%  4715 3525s
  4389  2158 17384.5045   67  461 14912.0238 23112.8921  55.0%  4714 3545s
  4390  2159 19081.0298   12  452 14912.0238 23112.8921  55.0%  4713 3558s
  4391  2160 22287.1917   12  451 14912.0238 23112.8921  55.0%  4712 3569s
  4392  2160 16463.0425   22  406 14912.0238 23112.8921  55.0%  4711 3579s
  4393  2161 16753.6566   54  507 14912.0238 23112.8921  55.0%  4710 3589s

Cutting planes:
  Gomory: 12
  Implied bound: 38
  Projected implied bound: 173
  MIR: 808
  Mixing: 7
  Flow cover: 846
  RLT: 67
  Relax-and-lift: 270

Explored 4393 nodes (21759446 simplex iterations) in 3600.07 seconds (8298.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14912 14893.1 14866.3 ... 14342.6

Time limit reached
Best objective 1.491202381534e+04, best bound 2.311289213235e+04, gap 54.9950%
  WARNING: Time limit reached. Using best solution found (gap: 55.00%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 14912.02, θ = 156845.96
  Upper Bound (UB) = 14912.02

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156845.96
  [DEBUG]   ✓ Scenario 0: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 156845.96 ≤ Q = 156845.96 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7491dadf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7491dadf
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.184705e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.00s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6368022.4529
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.389405e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138940.55    0  123 6368022.45 -138940.55   102%     -    0s
H    0     0                    -102230.8189 -138940.55  35.9%     -    0s
H    0     0                    -103576.0667 -138940.55  34.1%     -    0s
     0     0 -119050.32    0   99 -103576.07 -119050.32  14.9%     -    0s
H    0     0                    -116002.4249 -119032.08  2.61%     -    0s
H    0     0                    -116321.7789 -119032.08  2.33%     -    0s
H    0     0                    -116729.5639 -119032.08  1.97%     -    0s
H    0     0                    -117048.9179 -119032.08  1.69%     -    0s
H    0     0                    -117088.7178 -118262.19  1.00%     -    0s
     0     0 -118262.19    0   97 -117088.72 -118262.19  1.00%     -    0s
     0     0 -118195.84    0   90 -117088.72 -118195.84  0.95%     -    0s
     0     0 -118193.23    0   91 -117088.72 -118193.23  0.94%     -    0s
     0     0 -117769.32    0   52 -117088.72 -117769.32  0.58%     -    0s
     0     0 -117723.95    0   57 -117088.72 -117723.95  0.54%     -    0s
     0     0 -117718.95    0   56 -117088.72 -117718.95  0.54%     -    0s
     0     0 -117385.68    0   16 -117088.72 -117385.68  0.25%     -    0s
     0     0 -117374.22    0   17 -117088.72 -117374.22  0.24%     -    0s
     0     0 -117334.18    0   18 -117088.72 -117334.18  0.21%     -    0s
     0     0 -117331.88    0   18 -117088.72 -117331.88  0.21%     -    0s
H    0     0                    -117141.8063 -117330.98  0.16%     -    0s
     0     0 -117330.98    0   45 -117141.81 -117330.98  0.16%     -    0s
     0     0 -117207.18    0   16 -117141.81 -117207.18  0.06%     -    0s
     0     0 -117206.83    0   15 -117141.81 -117206.83  0.06%     -    0s
H    0     0                    -117155.3431 -117199.12  0.04%     -    0s
     0     0 -117199.12    0   14 -117155.34 -117199.12  0.04%     -    0s
     0     0 -117171.98    0    6 -117155.34 -117171.98  0.01%     -    0s
     0     0 -117171.98    0    8 -117155.34 -117171.98  0.01%     -    0s
H    0     0                    -117161.1827 -117171.98  0.01%     -    0s
     0     0 -117166.79    0    4 -117161.18 -117166.79  0.00%     -    0s
H    0     0                    -117164.9907 -117166.55  0.00%     -    0s
     0     0 -117166.37    0    2 -117164.99 -117166.37  0.00%     -    0s
*    0     0               0    -117165.2887 -117165.29  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 2
  Flow cover: 4

Explored 1 nodes (1077 simplex iterations) in 0.11 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -117165 -117165 -117161 ... -102231
No other solutions better than -117165

Optimal solution found (tolerance 1.00e-06)
Best objective -1.171652887075e+05, best bound -1.171652887075e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 145714.06
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117165.29
  [DEBUG]   S×d_nominal = 262879.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262879.35 + -117165.29 = 145714.06
  [DEBUG]   Current θ from Master = 156845.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11131.90 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3780.12
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 2710.7390, Absolute Gap = 2710.7390, Relative Gap = 0.181782
  Not converged yet (gap = 2710.74 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524579 nonzeros
Model fingerprint: 0xf2437908
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75144 rows and 30504 columns
Presolve time: 1.55s
Presolved: 109719 rows, 46636 columns, 659903 nonzeros
Variable types: 44377 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -376831.8944
Found heuristic solution: objective -221895.3170

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 665
 AA' NZ     : 3.767e+06
 Factor NZ  : 9.135e+06 (roughly 140 MB of memory)
 Factor Ops : 1.748e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69860706e+07  1.88782215e+08  9.77e+04 2.45e+01  7.36e+04     3s
   1  -1.26730765e+07  1.64988243e+08  6.63e+04 5.66e+01  4.92e+04     3s
   2  -4.62300980e+06  1.25326593e+08  2.39e+04 3.24e+00  1.82e+04     3s
   3  -7.90916201e+05  1.01040286e+08  1.07e+03 1.52e+00  1.29e+03     3s
   4  -5.11967394e+05  3.10262525e+07  3.21e+02 1.96e-01  3.54e+02     3s
   5  -3.44527415e+05  2.33843421e+07  8.65e+01 1.35e-01  1.68e+02     3s
   6  -2.10960921e+05  1.64871795e+07  3.37e+01 8.94e-02  9.94e+01     3s
   7  -9.80837073e+04  1.21642835e+07  8.27e+00 6.29e-02  6.43e+01     3s
   8  -8.17456280e+04  5.59979004e+06  5.75e+00 2.75e-02  2.95e+01     3s
   9  -5.35455004e+04  4.28168268e+06  2.53e+00 2.08e-02  2.20e+01     3s
  10  -1.54106154e+04  2.38801644e+06  2.12e-01 1.12e-02  1.20e+01     3s
  11  -5.92969152e+03  7.88632151e+05  1.18e-01 3.52e-03  3.96e+00     3s
  12   3.23309441e+03  2.53135833e+05  5.55e-02 1.07e-03  1.24e+00     3s
  13   9.00768791e+03  1.93711050e+05  3.76e-02 1.06e-03  9.20e-01     3s
  14   1.39830007e+04  1.67596644e+05  2.93e-02 1.10e-03  7.65e-01     3s
  15   1.82196323e+04  1.27058064e+05  2.35e-02 1.08e-03  5.42e-01     4s
  16   2.36522811e+04  9.97113138e+04  1.78e-02 7.69e-04  3.79e-01     4s
  17   2.77904819e+04  8.52997681e+04  1.40e-02 5.64e-04  2.86e-01     4s
  18   3.05202497e+04  7.32711290e+04  1.17e-02 4.18e-04  2.13e-01     4s
  19   3.30766001e+04  6.71642390e+04  9.75e-03 3.13e-04  1.70e-01     4s
  20   3.67749737e+04  6.19271982e+04  7.06e-03 2.16e-04  1.25e-01     4s
  21   3.83765965e+04  5.71365482e+04  5.94e-03 1.56e-04  9.34e-02     4s
  22   3.93476033e+04  5.42907114e+04  5.32e-03 1.09e-04  7.44e-02     4s
  23   4.10017511e+04  5.33366507e+04  4.29e-03 1.46e-04  6.14e-02     4s
  24   4.23113773e+04  5.24064744e+04  3.50e-03 1.26e-04  5.03e-02     4s
  25   4.26669525e+04  5.18695430e+04  3.28e-03 1.09e-04  4.58e-02     4s
  26   4.38528472e+04  5.12388010e+04  2.55e-03 8.92e-05  3.68e-02     4s
  27   4.43416395e+04  5.11001734e+04  2.26e-03 8.98e-05  3.37e-02     4s
  28   4.48443017e+04  5.05829300e+04  1.95e-03 8.33e-05  2.86e-02     4s
  29   4.52819881e+04  4.99590456e+04  1.70e-03 7.50e-05  2.33e-02     4s
  30   4.56196494e+04  4.98538801e+04  1.50e-03 7.04e-05  2.11e-02     4s
  31   4.60325897e+04  4.94765610e+04  1.26e-03 5.42e-05  1.72e-02     5s
  32   4.64727705e+04  4.90953665e+04  1.00e-03 3.78e-05  1.31e-02     5s
  33   4.68949242e+04  4.88509119e+04  7.57e-04 4.47e-05  9.74e-03     5s
  34   4.72295405e+04  4.87040409e+04  5.67e-04 3.23e-05  7.34e-03     5s
  35   4.73625454e+04  4.86230757e+04  4.92e-04 2.61e-05  6.28e-03     5s
  36   4.74936859e+04  4.85353971e+04  4.20e-04 1.92e-05  5.19e-03     5s
  37   4.77139026e+04  4.84379469e+04  2.99e-04 1.95e-05  3.61e-03     5s
  38   4.79597262e+04  4.83812403e+04  1.70e-04 1.22e-05  2.10e-03     5s
  39   4.80316895e+04  4.83541203e+04  1.31e-04 9.05e-06  1.61e-03     5s
  40   4.80851004e+04  4.83478793e+04  1.02e-04 8.21e-06  1.31e-03     5s
  41   4.81016852e+04  4.83399667e+04  9.27e-05 7.28e-06  1.19e-03     5s
  42   4.81733588e+04  4.83156103e+04  5.40e-05 4.28e-06  7.08e-04     5s
  43   4.82083562e+04  4.83094855e+04  3.54e-05 3.58e-06  5.04e-04     5s
  44   4.82158812e+04  4.83055705e+04  3.16e-05 3.10e-06  4.47e-04     5s
  45   4.82297886e+04  4.82983645e+04  2.44e-05 2.23e-06  3.41e-04     5s
  46   4.82463498e+04  4.82868527e+04  1.62e-05 1.02e-06  2.02e-04     6s
  47   4.82716252e+04  4.82805703e+04  3.50e-06 1.53e-06  4.45e-05     6s
  48   4.82749437e+04  4.82790679e+04  1.81e-06 2.90e-07  2.05e-05     6s
  49   4.82771085e+04  4.82788110e+04  7.65e-07 7.27e-08  8.48e-06     6s
  50   4.82785681e+04  4.82787081e+04  6.64e-08 3.45e-08  6.97e-07     6s
  51   4.82787016e+04  4.82787070e+04  1.07e-07 8.90e-08  2.71e-08     6s
  52   4.82787045e+04  4.82787070e+04  7.29e-07 4.46e-09  1.23e-08     6s
  53   4.82787070e+04  4.82787070e+04  1.87e-09 3.95e-08  6.42e-12     6s

Barrier solved model in 53 iterations and 5.98 seconds (10.27 work units)
Optimal objective 4.82787070e+04


Root crossover log...

   92668 DPushes remaining with DInf 7.6302669e-08                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    1809 PPushes remaining with PInf 9.7262401e-07                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.1533561e-11      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33240    4.8278707e+04   0.000000e+00   0.000000e+00      8s
   33240    4.8278707e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.827871e+04, 33240 iterations, 5.72 seconds (11.55 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48278.7070    0  340 -221895.32 48278.7070   122%     -    8s
H    0     0                    -195482.0820 48278.7070   125%     -    8s
H    0     0                    -148054.8386 48278.7070   133%     -    8s
H    0     0                    -145821.8545 48278.7070   133%     -    8s
H    0     0                    -144760.6429 48278.7070   133%     -    8s
H    0     0                    -144359.1930 48278.7070   133%     -    8s
H    0     0                    -64106.21660 48278.7070   175%     -    8s
H    0     0                    5197.4276618 48278.7070   829%     -    8s
H    0     0                    8752.7430292 48278.7070   452%     -    8s
H    0     0                    10890.264686 48278.7070   343%     -    8s
H    0     0                    11464.091396 40801.9525   256%     -   44s
H    0     0                    11807.318151 40801.9525   246%     -   44s
H    0     0                    11950.571185 40801.9525   241%     -   44s
     0     0 40658.1380    0  446 11950.5712 40658.1380   240%     -   45s
     0     0 40116.3094    0  457 11950.5712 40116.3094   236%     -   61s
H    0     0                    12567.989380 40077.2440   219%     -   71s
     0     0 40073.5289    0  464 12567.9894 40073.5289   219%     -   71s
H    0     0                    12807.317798 39999.6572   212%     -   78s
     0     0 39999.6572    0  465 12807.3178 39999.6572   212%     -   80s
     0     0 39998.9234    0  455 12807.3178 39998.9234   212%     -   81s
     0     0 35923.6647    0  462 12807.3178 35923.6647   180%     -  150s
     0     0 34345.0000    0  571 12807.3178 34345.0000   168%     -  216s
     0     0 33977.0040    0  603 12807.3178 33977.0040   165%     -  255s
     0     0 33760.2361    0  615 12807.3178 33760.2361   164%     -  286s
     0     0 33726.3847    0  604 12807.3178 33726.3847   163%     -  295s
     0     0 33716.4277    0  603 12807.3178 33716.4277   163%     -  301s
     0     0 33713.0634    0  616 12807.3178 33713.0634   163%     -  306s
H    0     0                    12992.629886 33707.1460   159%     -  310s
H    0     0                    13171.546585 33707.1460   156%     -  310s
     0     0 33707.1460    0  611 13171.5466 33707.1460   156%     -  311s
     0     0 33703.8566    0  609 13171.5466 33703.8566   156%     -  313s
     0     0 33695.1810    0  560 13171.5466 33695.1810   156%     -  319s
     0     0 33681.6329    0  550 13171.5466 33681.6329   156%     -  326s
     0     0 33680.7597    0  553 13171.5466 33680.7597   156%     -  328s
     0     0 30896.5371    0  542 13171.5466 30896.5371   135%     -  439s
H    0     0                    13209.318960 30896.2043   134%     -  440s
H    0     0                    13761.396217 30260.4966   120%     -  490s
     0     0 30260.4966    0  495 13761.3962 30260.4966   120%     -  490s
     0     0 29963.1385    0  561 13761.3962 29963.1385   118%     -  526s
     0     0 29868.0596    0  561 13761.3962 29868.0596   117%     -  552s
     0     0 29804.7724    0  589 13761.3962 29804.7724   117%     -  571s
     0     0 29739.7111    0  575 13761.3962 29739.7111   116%     -  590s
     0     0 29721.8113    0  573 13761.3962 29721.8113   116%     -  601s
     0     0 29694.0409    0  592 13761.3962 29694.0409   116%     -  612s
H    0     0                    13828.128279 29677.6623   115%     -  621s
H    0     0                    13901.252079 29677.6623   113%     -  621s
     0     0 29677.6623    0  589 13901.2521 29677.6623   113%     -  621s
     0     0 29669.8305    0  596 13901.2521 29669.8305   113%     -  629s
     0     0 29653.3723    0  573 13901.2521 29653.3723   113%     -  637s
     0     0 29638.0275    0  568 13901.2521 29638.0275   113%     -  646s
     0     0 29621.5100    0  558 13901.2521 29621.5100   113%     -  652s
     0     0 29618.6138    0  575 13901.2521 29618.6138   113%     -  656s
     0     0 27792.9694    0  363 13901.2521 27792.9694   100%     -  738s
     0     0 27306.4512    0  370 13901.2521 27306.4512  96.4%     -  767s
     0     0 27085.7181    0  440 13901.2521 27085.7181  94.8%     -  792s
     0     0 27026.4257    0  376 13901.2521 27026.4257  94.4%     -  806s
     0     0 26915.3158    0  428 13901.2521 26915.3158  93.6%     -  821s
     0     0 26785.6711    0  399 13901.2521 26785.6711  92.7%     -  833s
     0     0 26756.3298    0  472 13901.2521 26756.3298  92.5%     -  842s
     0     0 26684.2433    0  470 13901.2521 26684.2433  92.0%     -  855s
     0     0 26659.7766    0  476 13901.2521 26659.7766  91.8%     -  863s
     0     0 26641.8674    0  466 13901.2521 26641.8674  91.7%     -  871s
     0     0 26610.0820    0  474 13901.2521 26610.0820  91.4%     -  880s
     0     0 26600.0178    0  481 13901.2521 26600.0178  91.3%     -  886s
     0     0 26595.4918    0  475 13901.2521 26595.4918  91.3%     -  891s
     0     0 26588.1643    0  478 13901.2521 26588.1643  91.3%     -  895s
     0     0 26579.4505    0  423 13901.2521 26579.4505  91.2%     -  900s
     0     0 26576.2678    0  480 13901.2521 26576.2678  91.2%     -  902s
     0     0 26135.6036    0  442 13901.2521 26135.6036  88.0%     -  925s
     0     0 26044.1462    0  479 13901.2521 26044.1462  87.4%     -  942s
     0     0 26004.6396    0  450 13901.2521 26004.6396  87.1%     -  949s
     0     0 25981.9810    0  445 13901.2521 25981.9810  86.9%     -  955s
     0     0 25957.8764    0  446 13901.2521 25957.8764  86.7%     -  961s
     0     0 25945.6510    0  441 13901.2521 25945.6510  86.6%     -  966s
     0     0 25937.1526    0  451 13901.2521 25937.1526  86.6%     -  972s
     0     0 25927.7275    0  446 13901.2521 25927.7275  86.5%     -  976s
     0     0 25913.1225    0  426 13901.2521 25913.1225  86.4%     -  980s
     0     0 25910.0120    0  431 13901.2521 25910.0120  86.4%     -  982s
     0     0 25759.4379    0  429 13901.2521 25759.4379  85.3%     - 1001s
H    0     0                    14196.074754 25759.4254  81.5%     - 1005s
     0     0 25715.9869    0  376 14196.0748 25715.9869  81.1%     - 1019s
     0     0 25703.6217    0  441 14196.0748 25703.6217  81.1%     - 1027s
     0     0 25697.2256    0  424 14196.0748 25697.2256  81.0%     - 1032s
     0     0 25695.6775    0  440 14196.0748 25695.6775  81.0%     - 1036s
     0     0 25481.3508    0  435 14196.0748 25481.3508  79.5%     - 1059s
     0     0 25461.9783    0  495 14196.0748 25461.9783  79.4%     - 1069s
     0     0 25445.7091    0  427 14196.0748 25445.7091  79.2%     - 1074s
     0     0 25429.5975    0  499 14196.0748 25429.5975  79.1%     - 1080s
     0     0 25427.5595    0  493 14196.0748 25427.5595  79.1%     - 1084s
     0     0 25385.0327    0  485 14196.0748 25385.0327  78.8%     - 1095s
H    0     0                    14233.100545 25385.0187  78.4%     - 1103s
     0     0 25352.3094    0  509 14233.1005 25352.3094  78.1%     - 1112s
     0     0 25349.8212    0  505 14233.1005 25349.8212  78.1%     - 1115s
     0     0 25322.1156    0  480 14233.1005 25322.1156  77.9%     - 1127s
     0     0 25302.3656    0  429 14233.1005 25302.3656  77.8%     - 1137s
     0     0 25293.8810    0  443 14233.1005 25293.8810  77.7%     - 1144s
     0     0 25291.9822    0  438 14233.1005 25291.9822  77.7%     - 1147s
     0     0 25283.7809    0  450 14233.1005 25283.7809  77.6%     - 1156s
     0     0 25279.4476    0  450 14233.1005 25279.4476  77.6%     - 1175s
     0     0 25276.3248    0  450 14233.1005 25276.3248  77.6%     - 1179s
     0     0 25260.3626    0  445 14233.1005 25260.3626  77.5%     - 1186s
     0     0 25259.9371    0  445 14233.1005 25259.9371  77.5%     - 1189s
     0     2 25259.9371    0  445 14233.1005 25259.9371  77.5%     - 1230s
     1     3 24857.4427    1  412 14233.1005 25259.9371  77.5% 12401 1241s
     2     4 25092.3159    1  450 14233.1005 25092.3159  76.3% 10438 1248s
     3     5 24304.8636    2  444 14233.1005 25091.8812  76.3%  9294 1259s
     4    10 24051.8926    3  436 14233.1005 25091.8812  76.3%  9584 1271s
     9    19 23544.1288    4  419 14233.1005 24872.9170  74.8% 10282 1291s
    18    38 23430.4542    5  430 14233.1005 24508.6795  72.2% 12366 1320s
    37    51 23506.4514    5  467 14233.1005 24299.2381  70.7% 17972 1402s
    50    77 22173.6272    6  276 14233.1005 24299.2381  70.7% 16955 1442s
    76   176 22093.9426    7  283 14233.1005 24299.2381  70.7% 14808 1506s
   177   235 21974.1784   12  260 14233.1005 24299.2381  70.7%  9345 1536s
   238   281 19962.7404   13  242 14233.1005 24299.2381  70.7%  9593 1566s
   288   302 20976.9392   15  204 14233.1005 24299.2381  70.7%  8993 1591s
   313   341 15592.7963   12  265 14233.1005 24299.2381  70.7%  9033 1627s
   363   381 infeasible   13      14233.1005 24299.2381  70.7%  9097 1655s
   416   434 infeasible   13      14233.1005 24299.2381  70.7%  9229 1679s
   489   481 18233.6801   20  205 14233.1005 24299.2381  70.7%  9098 1698s
   568   509 18028.9082   21  200 14233.1005 24299.2381  70.7%  8741 1719s
   634   542 17737.6717   22  190 14233.1005 24299.2381  70.7%  8611 1740s
   707   549 17338.2923   23  156 14233.1005 24299.2381  70.7%  8566 1762s
   746   581 infeasible   23      14233.1005 24299.2381  70.7%  8498 1780s
   819   633 15392.8336   23  179 14233.1005 24299.2381  70.7%  8491 1802s
   901   662 infeasible   24      14233.1005 24299.2381  70.7%  8176 1822s
   977   693 15636.9022   25  148 14233.1005 24299.2381  70.7%  8044 1843s
  1057   725     cutoff   25      14233.1005 24299.2381  70.7%  7925 1863s
  1132   753 14441.0311   27   95 14233.1005 24299.2381  70.7%  7896 1886s
  1207   780 17122.1755   11  170 14233.1005 24299.2381  70.7%  7824 1908s
  1298   799 16443.0928   12  178 14233.1005 24299.2381  70.7%  7737 1934s
  1383   841     cutoff   14      14233.1005 24299.2381  70.7%  7656 1960s
  1477   881 14492.3183   20   68 14233.1005 24299.2381  70.7%  7555 1985s
  1569   890 infeasible   24      14233.1005 24299.2381  70.7%  7532 2012s
  1654   892 14789.1820   48  103 14233.1005 24299.2381  70.7%  7532 2042s
  1719   912 19668.2819   10  231 14233.1005 24299.2381  70.7%  7529 2076s
  1789   960 22119.3480   14  419 14233.1005 24299.2381  70.7%  7570 2106s
  1877   980 21778.0609   15  337 14233.1005 24299.2381  70.7%  7656 2138s
  1977  1004 19630.1390   16  224 14233.1005 24299.2381  70.7%  7696 2177s
  2096  1031 18963.8709   17  238 14233.1005 24299.2381  70.7%  7649 2219s
  2191  1036 14721.8000   19   97 14233.1005 24299.2381  70.7%  7686 2258s
H 2226  1036                    14329.646517 24232.7936  69.1%  7733 2258s
  2234  1048 infeasible   21      14329.6465 24232.7936  69.1%  7753 2296s
  2324  1079 21932.4421   15  427 14329.6465 24232.7936  69.1%  7860 2333s
H 2376  1079                    14461.456500 24232.7936  67.6%  7972 2333s
  2381  1090 21753.6156   16  430 14461.4565 24232.7936  67.6%  7979 2375s
  2483  1112 19374.5081   16  455 14461.4565 24232.7936  67.6%  8025 2417s
  2574  1147 19348.0152   17  449 14461.4565 24232.7936  67.6%  8077 2468s
  2663  1219 15228.9987   19  400 14461.4565 24232.7936  67.6%  8220 2517s
  2783  1300 15202.6389   20  412 14461.4565 24232.7936  67.6%  8260 2566s
  2946  1325 19012.7669   19  400 14461.4565 24232.7936  67.6%  8231 2617s
  3095  1359 18315.4256   20  398 14461.4565 24232.7936  67.6%  8225 2674s
  3212  1374 18802.0497   21  406 14461.4565 23660.8744  63.6%  8270 2730s
H 3217  1374                    14476.975292 23660.8744  63.4%  8271 2730s
H 3224  1374                    14551.305871 23660.8744  62.6%  8300 2730s
H 3225  1374                    15226.972795 23660.8744  55.4%  8298 2730s
  3253  1394 18478.2645   21  370 15226.9728 23660.8744  55.4%  8348 2793s
H 3352  1404                    15282.361928 23660.8744  54.8%  8469 2848s
  3394  1447 infeasible   22      15282.3619 23660.8744  54.8%  8603 2898s
  3477  1486 18415.5654   25  506 15282.3619 23660.8744  54.8%  8714 2957s
  3600  1509 18155.7280   26  466 15282.3619 23660.8744  54.8%  8843 3023s
  3701  1514 18025.1964   27  423 15282.3619 23660.8744  54.8%  8924 3103s
  3755  1534 17842.9060   28  440 15282.3619 23660.8744  54.8%  9017 3167s
H 3761  1534                    15284.630928 23660.8744  54.8%  9016 3167s
  3807  1564 17558.3349   29  404 15284.6309 23660.8744  54.8%  9124 3253s
  3931  1603 17271.4937   31  428 15284.6309 23660.8744  54.8%  9219 3334s
  4043  1651 infeasible   33      15284.6309 23660.8744  54.8%  9349 3417s
  4155  1697 infeasible   34      15284.6309 23660.8744  54.8%  9478 3504s
  4313  1710 15647.4382   37  438 15284.6309 22810.9495  49.2%  9565 3579s
  4362  1724 15585.8019   38  442 15284.6309 22810.9495  49.2%  9626 3600s

Cutting planes:
  Gomory: 17
  Implied bound: 489
  MIR: 4253
  Flow cover: 3719
  RLT: 189
  Relax-and-lift: 1852

Explored 4390 nodes (43253781 simplex iterations) in 3600.05 seconds (8773.99 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15284.6 15282.4 15227 ... 13901.3

Time limit reached
Best objective 1.528463092778e+04, best bound 2.281094947207e+04, gap 49.2411%
  WARNING: Time limit reached. Using best solution found (gap: 49.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 15284.63, θ = 157217.60
  Upper Bound (UB) = 15284.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157217.60
  [DEBUG]   ✓ Scenario 0: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157217.60 ≤ Q = 157217.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157217.60 ≤ Q = 157217.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157217.60 ≤ Q = 157217.60 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x602fae9c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x602fae9c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.175193e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6361746.5459
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.379020e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137901.97    0  123 6361746.55 -137901.97   102%     -    0s
H    0     0                    -101203.3577 -137901.97  36.3%     -    0s
H    0     0                    -102653.8884 -137901.97  34.3%     -    0s
     0     0 -116630.12    0  131 -102653.89 -116630.12  13.6%     -    0s
H    0     0                    -112660.4634 -116599.06  3.50%     -    0s
H    0     0                    -113853.3113 -116599.06  2.41%     -    0s
     0     0 -115603.16    0  132 -113853.31 -115603.16  1.54%     -    0s
H    0     0                    -114144.9014 -115565.56  1.24%     -    0s
     0     0 -115565.56    0  132 -114144.90 -115565.56  1.24%     -    0s
     0     0 -115290.65    0  119 -114144.90 -115290.65  1.00%     -    0s
H    0     0                    -114158.1146 -115105.53  0.83%     -    0s
     0     0 -115105.53    0  130 -114158.11 -115105.53  0.83%     -    0s
     0     0 -115101.61    0  118 -114158.11 -115101.61  0.83%     -    0s
     0     0 -114821.23    0   80 -114158.11 -114821.23  0.58%     -    0s
H    0     0                    -114178.5670 -114781.68  0.53%     -    0s
     0     0 -114746.69    0   90 -114178.57 -114746.69  0.50%     -    0s
     0     0 -114742.74    0   91 -114178.57 -114742.74  0.49%     -    0s
     0     0 -114553.32    0   69 -114178.57 -114553.32  0.33%     -    0s
     0     0 -114505.69    0   69 -114178.57 -114505.69  0.29%     -    0s
     0     0 -114499.37    0   76 -114178.57 -114499.37  0.28%     -    0s
     0     0 -114429.28    0   63 -114178.57 -114429.28  0.22%     -    0s
     0     0 -114427.17    0   63 -114178.57 -114427.17  0.22%     -    0s
     0     0 -114426.11    0   78 -114178.57 -114426.11  0.22%     -    0s
     0     0 -114426.11    0   49 -114178.57 -114426.11  0.22%     -    0s
     0     0 -114352.78    0   39 -114178.57 -114352.78  0.15%     -    0s
     0     0 -114352.64    0   35 -114178.57 -114352.64  0.15%     -    0s
     0     0 -114348.73    0   35 -114178.57 -114348.73  0.15%     -    0s
H    0     0                    -114209.3343 -114348.73  0.12%     -    0s
     0     0 -114301.43    0    9 -114209.33 -114301.43  0.08%     -    0s
     0     0 -114286.42    0    9 -114209.33 -114286.42  0.07%     -    0s
     0     0 -114273.31    0   10 -114209.33 -114273.31  0.06%     -    0s
     0     0 -114273.31    0   15 -114209.33 -114273.31  0.06%     -    0s
     0     0 -114217.58    0    8 -114209.33 -114217.58  0.01%     -    0s
     0     0 -114217.37    0    7 -114209.33 -114217.37  0.01%     -    0s
H    0     0                    -114209.8030 -114216.01  0.01%     -    0s
H    0     0                    -114209.8693 -114216.01  0.01%     -    0s
     0     0 -114216.01    0    7 -114209.87 -114216.01  0.01%     -    0s
     0     0 -114213.41    0    6 -114209.87 -114213.41  0.00%     -    0s
     0     0 -114213.39    0    3 -114209.87 -114213.39  0.00%     -    0s
H    0     0                    -114211.9587 -114213.39  0.00%     -    0s
     0     0 -114212.60    0    3 -114211.96 -114212.60  0.00%     -    0s
     0     0 -114212.13    0    2 -114211.96 -114212.13  0.00%     -    0s

Cutting planes:
  MIR: 2

Explored 1 nodes (1468 simplex iterations) in 0.20 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -114212 -114210 -114210 ... -101203
No other solutions better than -114212

Optimal solution found (tolerance 1.00e-06)
Best objective -1.142119586710e+05, best bound -1.142119586710e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 148157.41
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114211.96
  [DEBUG]   S×d_nominal = 262369.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 262369.37 + -114211.96 = 148157.41
  [DEBUG]   Current θ from Master = 157217.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9060.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6224.44
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 3083.3462, Absolute Gap = 3083.3462, Relative Gap = 0.201729
  Not converged yet (gap = 3083.35 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567834 nonzeros
Model fingerprint: 0x3bfafe11
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 81406 rows and 33046 columns
Presolve time: 1.77s
Presolved: 118747 rows, 50334 columns, 729057 nonzeros
Variable types: 48075 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 701
 AA' NZ     : 4.702e+06
 Factor NZ  : 1.151e+07 (roughly 160 MB of memory)
 Factor Ops : 3.464e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70167917e+07  2.02930462e+08  1.04e+05 2.36e+01  7.33e+04     3s
   1  -1.28191956e+07  1.76684766e+08  7.15e+04 6.32e+01  4.98e+04     3s
   2  -5.24855546e+06  1.37495456e+08  2.82e+04 1.03e+00  2.03e+04     3s
   3  -8.38392288e+05  1.02790902e+08  1.84e+03 1.60e+00  1.72e+03     3s
   4  -5.23991760e+05  3.30277719e+07  4.40e+02 1.37e-01  4.12e+02     4s
   5  -4.00721431e+05  2.42813909e+07  1.76e+02 8.73e-02  2.10e+02     4s
   6  -2.75417889e+05  1.75583152e+07  7.24e+01 5.90e-02  1.17e+02     4s
   7  -2.17138772e+05  1.35361969e+07  5.12e+01 4.23e-02  8.49e+01     4s
   8  -1.45536197e+05  1.08943853e+07  2.13e+01 3.31e-02  5.87e+01     4s
   9  -1.21176263e+05  8.94963868e+06  1.47e+01 2.66e-02  4.64e+01     4s
  10  -1.07734255e+05  6.80224929e+06  6.28e+00 1.97e-02  3.34e+01     4s
  11  -8.76923592e+04  1.32021456e+06  3.07e+00 3.34e-03  6.70e+00     4s
  12  -4.92903127e+04  5.90040474e+05  1.05e+00 1.24e-03  2.98e+00     4s
  13  -3.59465224e+04  2.71417221e+05  7.02e-01 6.59e-04  1.43e+00     4s
  14  -1.29147053e+04  1.90931218e+05  3.98e-01 7.40e-04  9.45e-01     4s
  15  -5.47676278e+03  1.35834980e+05  3.23e-01 1.33e-03  6.55e-01     4s
  16   3.00873136e+03  9.74047610e+04  2.56e-01 1.93e-03  4.38e-01     4s
  17   8.03505330e+03  8.84785225e+04  2.16e-01 2.45e-03  3.73e-01     4s
  18   1.22049234e+04  7.83894957e+04  1.84e-01 1.80e-03  3.07e-01     4s
  19   1.53987796e+04  6.36258370e+04  1.58e-01 1.73e-03  2.24e-01     4s
  20   1.86399117e+04  5.74020757e+04  1.35e-01 2.12e-03  1.80e-01     4s
  21   2.19784205e+04  5.40754535e+04  1.12e-01 2.21e-03  1.49e-01     5s
  22   2.57125867e+04  5.08464830e+04  8.70e-02 2.17e-03  1.17e-01     5s
  23   2.80624181e+04  4.80261445e+04  7.21e-02 1.67e-03  9.28e-02     5s
  24   2.95470638e+04  4.60692211e+04  6.29e-02 1.77e-03  7.68e-02     5s
  25   3.15173290e+04  4.50526221e+04  5.11e-02 1.80e-03  6.29e-02     5s
  26   3.32060133e+04  4.44661080e+04  4.10e-02 1.57e-03  5.23e-02     5s
  27   3.47244659e+04  4.35019650e+04  3.23e-02 1.09e-03  4.08e-02     5s
  28   3.56573867e+04  4.24386204e+04  2.71e-02 1.16e-03  3.15e-02     5s
  29   3.66249093e+04  4.22474532e+04  2.18e-02 1.07e-03  2.61e-02     5s
  30   3.71543413e+04  4.19697322e+04  1.88e-02 8.98e-04  2.24e-02     5s
  31   3.75279511e+04  4.15158418e+04  1.66e-02 6.08e-04  1.86e-02     5s
  32   3.76520414e+04  4.14629495e+04  1.59e-02 5.73e-04  1.77e-02     5s
  33   3.80955277e+04  4.13697449e+04  1.35e-02 5.07e-04  1.52e-02     5s
  34   3.86710129e+04  4.12414449e+04  1.05e-02 3.98e-04  1.20e-02     5s
  35   3.89007647e+04  4.10632288e+04  9.12e-03 2.95e-04  1.01e-02     6s
  36   3.90135052e+04  4.09950178e+04  8.49e-03 2.50e-04  9.22e-03     6s
  37   3.95370606e+04  4.08764620e+04  5.60e-03 1.54e-04  6.23e-03     6s
  38   3.97229203e+04  4.08067268e+04  4.62e-03 1.14e-04  5.04e-03     6s
  39   4.00476827e+04  4.07383404e+04  2.85e-03 7.44e-05  3.21e-03     6s
  40   4.03329329e+04  4.06704264e+04  1.33e-03 9.07e-05  1.57e-03     6s
  41   4.03991740e+04  4.06558783e+04  9.89e-04 7.01e-05  1.19e-03     6s
  42   4.04268170e+04  4.06377235e+04  8.49e-04 4.69e-05  9.81e-04     6s
  43   4.05178826e+04  4.06236480e+04  3.91e-04 2.39e-05  4.92e-04     6s
  44   4.05332309e+04  4.06158658e+04  3.13e-04 1.54e-05  3.84e-04     6s
  45   4.05499061e+04  4.06102891e+04  2.30e-04 9.52e-06  2.81e-04     6s
  46   4.05726927e+04  4.06075943e+04  1.24e-04 6.57e-06  1.62e-04     6s
  47   4.05841570e+04  4.06065200e+04  7.32e-05 5.12e-06  1.04e-04     6s
  48   4.05975769e+04  4.06019141e+04  1.26e-05 6.75e-06  2.01e-05     6s
  49   4.06005982e+04  4.06016321e+04  2.98e-06 2.61e-06  4.79e-06     7s
  50   4.06008630e+04  4.06014617e+04  2.01e-06 4.82e-08  2.78e-06     7s
  51   4.06011400e+04  4.06014593e+04  9.79e-07 2.64e-08  1.48e-06     7s
  52   4.06012244e+04  4.06014511e+04  1.39e-06 9.47e-09  1.05e-06     7s
  53   4.06013998e+04  4.06014462e+04  8.00e-06 1.10e-07  2.16e-07     7s
  54   4.06014150e+04  4.06014451e+04  5.99e-06 6.98e-08  1.40e-07     7s
  55   4.06014238e+04  4.06014445e+04  4.25e-06 5.44e-08  9.69e-08     7s
  56   4.06014248e+04  4.06014436e+04  4.72e-06 9.81e-08  8.76e-08     7s
  57   4.06014257e+04  4.06014436e+04  4.71e-06 1.02e-07  8.32e-08     7s
  58   4.06014265e+04  4.06014436e+04  5.15e-06 9.81e-08  7.95e-08     7s
  59   4.06014286e+04  4.06014435e+04  4.81e-06 8.73e-08  6.92e-08     7s
  60   4.06014289e+04  4.06014435e+04  4.84e-06 8.87e-08  6.79e-08     8s
  61   4.06014289e+04  4.06014435e+04  4.85e-06 8.45e-08  6.73e-08     8s
  62   4.06014322e+04  4.06014433e+04  3.55e-06 6.02e-08  5.17e-08     8s
  63   4.06014330e+04  4.06014433e+04  3.31e-06 5.53e-08  4.72e-08     8s
  64   4.06014342e+04  4.06014432e+04  3.54e-06 4.97e-08  4.18e-08     8s
  65   4.06014350e+04  4.06014431e+04  3.45e-06 3.91e-08  3.77e-08     8s
  66   4.06014366e+04  4.06014431e+04  3.26e-06 5.68e-08  3.04e-08     8s
  67   4.06014368e+04  4.06014431e+04  3.08e-06 5.49e-08  2.98e-08     8s
  68   4.06014376e+04  4.06014430e+04  7.24e-06 4.43e-08  2.73e-08     8s
  69   4.06014381e+04  4.06014430e+04  6.13e-06 4.26e-08  2.50e-08     8s
  70   4.06014391e+04  4.06014429e+04  6.81e-06 4.78e-08  2.04e-08     9s
  71   4.06014392e+04  4.06014429e+04  7.70e-06 4.69e-08  1.97e-08     9s
  72   4.06014400e+04  4.06014429e+04  5.79e-06 5.03e-08  1.46e-08     9s
  73   4.06014404e+04  4.06014429e+04  7.20e-06 4.44e-08  1.30e-08     9s
  74   4.06014413e+04  4.06014429e+04  5.18e-06 1.73e-08  8.63e-09     9s
  75   4.06014413e+04  4.06014428e+04  5.24e-06 1.87e-08  8.46e-09     9s
  76   4.06014414e+04  4.06014428e+04  5.00e-06 1.40e-08  7.79e-09     9s
  77   4.06014420e+04  4.06014428e+04  3.06e-06 1.12e-07  4.63e-09     9s
  78   4.06014426e+04  4.06014428e+04  9.90e-07 5.98e-08  1.48e-09     9s

Barrier solved model in 78 iterations and 9.27 seconds (14.81 work units)
Optimal objective 4.06014426e+04


Root crossover log...

  105876 DPushes remaining with DInf 0.0000000e+00                 9s
   41891 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   15847 PPushes remaining with PInf 1.5123809e-04                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.7677612e+05     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72977    4.0601443e+04   0.000000e+00   5.767761e+05     14s
   73962    4.0601443e+04   0.000000e+00   4.692203e+01     15s
   74277    4.0601443e+04   0.000000e+00   0.000000e+00     15s
   74277    4.0601443e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.38s

Solved with barrier

Root relaxation: objective 4.060144e+04, 74277 iterations, 13.30 seconds (27.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40601.4428    0  184 -233197.24 40601.4428   117%     -   16s
H    0     0                    -226675.7839 40601.4428   118%     -   16s
H    0     0                    -184010.3653 40601.4428   122%     -   16s
H    0     0                    -183874.9539 40601.4428   122%     -   17s
H    0     0                    -58119.03510 40601.4428   170%     -   17s
H    0     0                    9653.3602210 40601.4428   321%     -   17s
H    0     0                    10508.430348 40601.4428   286%     -   17s
H    0     0                    12183.449197 40601.4428   233%     -   17s
H    0     0                    12821.848300 40601.4428   217%     -   17s
H    0     0                    13020.605821 34402.6846   164%     -   47s
     0     0 34402.6846    0  229 13020.6058 34402.6846   164%     -   47s
     0     0 33498.9554    0  272 13020.6058 33498.9554   157%     -   66s
     0     0 33498.9554    0  277 13020.6058 33498.9554   157%     -   68s
     0     0 33498.9554    0  277 13020.6058 33498.9554   157%     -   68s
     0     0 33498.9554    0  277 13020.6058 33498.9554   157%     -   69s
     0     0 29855.2515    0  347 13020.6058 29855.2515   129%     -  130s
     0     0 29183.0829    0  291 13020.6058 29183.0829   124%     -  150s
     0     0 28727.5856    0  339 13020.6058 28727.5856   121%     -  178s
     0     0 28694.1720    0  362 13020.6058 28694.1720   120%     -  183s
     0     0 28677.7221    0  346 13020.6058 28677.7221   120%     -  188s
     0     0 28668.4180    0  359 13020.6058 28668.4180   120%     -  191s
     0     0 28652.3393    0  374 13020.6058 28652.3393   120%     -  195s
     0     0 28649.6411    0  371 13020.6058 28649.6411   120%     -  197s
     0     0 28649.5680    0  371 13020.6058 28649.5680   120%     -  197s
     0     0 26066.9081    0  347 13020.6058 26066.9081   100%     -  240s
H    0     0                    13209.318960 26066.1417  97.3%     -  240s
     0     0 25474.4245    0  381 13209.3190 25474.4245  92.9%     -  263s
     0     0 25173.9941    0  458 13209.3190 25173.9941  90.6%     -  284s
     0     0 25089.7711    0  406 13209.3190 25089.7711  89.9%     -  292s
     0     0 25068.0738    0  407 13209.3190 25068.0738  89.8%     -  298s
     0     0 25058.4524    0  411 13209.3190 25058.4524  89.7%     -  302s
     0     0 25038.0148    0  404 13209.3190 25038.0148  89.5%     -  308s
     0     0 25031.7494    0  400 13209.3190 25031.7494  89.5%     -  310s
     0     0 25003.9428    0  399 13209.3190 25003.9428  89.3%     -  316s
     0     0 24994.3641    0  455 13209.3190 24994.3641  89.2%     -  320s
H    0     0                    13556.781498 24982.2809  84.3%     -  324s
     0     0 24982.2809    0  449 13556.7815 24982.2809  84.3%     -  324s
     0     0 24980.6842    0  453 13556.7815 24980.6842  84.3%     -  325s
     0     0 23867.7123    0  469 13556.7815 23867.7123  76.1%     -  360s
     0     0 23608.2122    0  508 13556.7815 23608.2122  74.1%     -  372s
     0     0 23545.2953    0  502 13556.7815 23545.2953  73.7%     -  378s
     0     0 23489.0797    0  456 13556.7815 23489.0797  73.3%     -  383s
     0     0 23470.9510    0  521 13556.7815 23470.9510  73.1%     -  386s
     0     0 23461.4622    0  517 13556.7815 23461.4622  73.1%     -  389s
     0     0 23452.6615    0  520 13556.7815 23452.6615  73.0%     -  391s
     0     0 23440.8261    0  526 13556.7815 23440.8261  72.9%     -  393s
     0     0 23437.2954    0  540 13556.7815 23437.2954  72.9%     -  395s
     0     0 23429.7342    0  533 13556.7815 23429.7342  72.8%     -  397s
     0     0 23425.9963    0  484 13556.7815 23425.9963  72.8%     -  398s
     0     0 23425.2177    0  487 13556.7815 23425.2177  72.8%     -  399s
     0     0 23335.0367    0  353 13556.7815 23335.0367  72.1%     -  406s
     0     0 23272.9991    0  363 13556.7815 23272.9991  71.7%     -  415s
     0     0 23258.7973    0  492 13556.7815 23258.7973  71.6%     -  419s
     0     0 23256.0886    0  490 13556.7815 23256.0886  71.5%     -  420s
     0     0 23250.4118    0  487 13556.7815 23250.4118  71.5%     -  422s
     0     0 23247.3717    0  433 13556.7815 23247.3717  71.5%     -  423s
     0     0 23246.5051    0  432 13556.7815 23246.5051  71.5%     -  424s
     0     0 23153.1347    0  481 13556.7815 23153.1347  70.8%     -  430s
H    0     0                    13715.167963 23152.6705  68.8%     -  431s
H    0     0                    13839.736243 23152.6705  67.3%     -  431s
H    0     0                    14119.058202 23152.6705  64.0%     -  431s
     0     0 23145.1621    0  417 14119.0582 23145.1621  63.9%     -  434s
     0     0 23140.5970    0  429 14119.0582 23140.5970  63.9%     -  437s
     0     0 23138.1206    0  435 14119.0582 23138.1206  63.9%     -  440s
     0     0 23121.0263    0  438 14119.0582 23121.0263  63.8%     -  445s
     0     0 23116.3474    0  447 14119.0582 23116.3474  63.7%     -  448s
     0     0 23114.3091    0  437 14119.0582 23114.3091  63.7%     -  449s
     0     0 23105.4661    0  426 14119.0582 23105.4661  63.6%     -  453s
     0     0 23101.6731    0  423 14119.0582 23101.6731  63.6%     -  459s
     0     0 23100.6868    0  427 14119.0582 23100.6868  63.6%     -  461s
     0     0 23080.1957    0  361 14119.0582 23080.1957  63.5%     -  466s
     0     0 23072.9540    0  496 14119.0582 23072.9540  63.4%     -  470s
     0     0 23070.4356    0  374 14119.0582 23070.4356  63.4%     -  472s
     0     0 23064.6091    0  474 14119.0582 23064.6091  63.4%     -  476s
     0     0 23062.5407    0  471 14119.0582 23062.5407  63.3%     -  480s
     0     0 23059.1546    0  475 14119.0582 23059.1546  63.3%     -  483s
     0     0 23059.0252    0  475 14119.0582 23059.0252  63.3%     -  485s
H    0     0                    14119.156207 23059.0252  63.3%     -  503s
H    0     0                    14152.776169 23059.0252  62.9%     -  503s
H    0     0                    14159.339336 23059.0252  62.9%     -  527s
     0     2 23059.0252    0  475 14159.3393 23059.0252  62.9%     -  530s
     1     3 22823.1233    1  348 14159.3393 23058.5358  62.9% 11980  541s
     2     5 22522.5206    2  277 14159.3393 23058.5358  62.9% 10692  548s
     4     8 22299.8372    3  274 14159.3393 22930.2397  61.9%  9700  562s
     7    15 21844.7680    3  277 14159.3393 22930.2397  61.9%  9725  581s
    14    30 21647.2752    4  279 14159.3393 22310.4102  57.6% 10274  591s
    29    45 21566.4345    4  528 14159.3393 22235.4981  57.0% 12893  624s
    44    77 21271.2221    5  392 14159.3393 22235.4981  57.0% 14300  732s
    76   195 21256.5866    6  390 14159.3393 22044.0348  55.7% 13219  758s
   194   230 21396.9138    9  273 14159.3393 22041.6212  55.7%  8235  779s
   230   292 17419.1356   11  188 14159.3393 22041.6212  55.7%  7652  797s
   299   331 17275.8232   12  178 14159.3393 22041.6212  55.7%  7051  814s
   344   368 14825.1763   15  181 14159.3393 22041.6212  55.7%  6996  833s
   386   392 infeasible   16      14159.3393 22041.6212  55.7%  7452  850s
   427   432 14211.4876   16  174 14159.3393 22041.6212  55.7%  7656  867s
   484   445     cutoff   17      14159.3393 22041.6212  55.7%  7642  882s
   515   468 14336.0144   16  131 14159.3393 22041.6212  55.7%  7825  901s
   558   505     cutoff   17      14159.3393 22041.6212  55.7%  7778  916s
   625   546 16053.6148   32  217 14159.3393 22041.6212  55.7%  7573  932s
   709   588 15380.7216   35  199 14159.3393 22041.6212  55.7%  7214  946s
   801   627 14971.5309   37  142 14159.3393 22041.6212  55.7%  6895  961s
   882   647 15172.5119   39  125 14159.3393 22041.6212  55.7%  6669  975s
   916   658 14482.9875   40  119 14159.3393 22013.3040  55.5%  6644  992s
   955   671 14929.7651   39  121 14159.3393 22013.3040  55.5%  6601 1005s
   998   692 infeasible   41      14159.3393 22013.3040  55.5%  6527 1021s
  1034   713 14244.1582   42  181 14159.3393 22013.3040  55.5%  6547 1036s
  1082   727     cutoff   42      14159.3393 22013.3040  55.5%  6458 1054s
  1133   746 15780.5492   29  238 14159.3393 22013.3040  55.5%  6409 1073s
  1204   782 15728.9746   30  232 14159.3393 22013.3040  55.5%  6237 1086s
  1292   811 15701.7988   31  227 14159.3393 22013.3040  55.5%  6054 1106s
  1377   838 15650.1012   32  229 14159.3393 22013.3040  55.5%  5891 1125s
  1467   884 15585.7902   34  335 14159.3393 22013.3040  55.5%  5776 1146s
  1551   945 15297.3466   38  266 14159.3393 22013.3040  55.5%  5783 1171s
  1645  1054 14815.7920   41  323 14159.3393 22013.3040  55.5%  5766 1191s
  1801  1101 14588.1751   47  224 14159.3393 22013.3040  55.5%  5586 1211s
  1967  1116 17433.8013   13  511 14159.3393 22013.3040  55.5%  5421 1234s
  2074  1151 17279.0840   14  516 14159.3393 22013.3040  55.5%  5455 1257s
  2169  1178 16945.5589   16  431 14159.3393 21930.3479  54.9%  5517 1279s
  2284  1210 16838.3862   17  423 14159.3393 21930.3479  54.9%  5559 1303s
  2391  1246 16465.0043   19  404 14159.3393 21930.3479  54.9%  5637 1330s
  2502  1287 infeasible   21      14159.3393 21930.3479  54.9%  5712 1357s
  2597  1335 20423.4077   12  458 14159.3393 21930.3479  54.9%  5844 1385s
  2697  1428 15832.6574   13  145 14159.3393 21723.3000  53.4%  6006 1413s
  2836  1509 14843.4042   16   72 14159.3393 21723.1599  53.4%  6036 1442s
  3008  1589     cutoff   23      14159.3393 21723.1599  53.4%  6002 1476s
  3185  1606 19548.6111   13  408 14159.3393 21723.1599  53.4%  6001 1509s
  3229  1627 18646.2154   14  430 14159.3393 21723.1599  53.4%  6036 1533s
  3269  1653 18316.5011   15  435 14159.3393 21659.7213  53.0%  6076 1562s
  3327  1704 17886.3605   16  370 14159.3393 21659.7213  53.0%  6075 1595s
  3395  1759 17815.9066   17  296 14159.3393 21217.9173  49.9%  6099 1630s
  3520  1819 17582.7732   18  279 14159.3393 21217.9173  49.9%  6110 1665s
  3667  1906 16418.4642   22  407 14159.3393 21217.9173  49.9%  6141 1699s
  3831  2037 15137.2224   30  241 14159.3393 21004.7058  48.3%  6198 1738s
  4042  2080 14312.0784   41  201 14159.3393 21004.7058  48.3%  6229 1772s
  4170  2142 15342.6412   14  125 14159.3393 21004.7058  48.3%  6233 1811s
  4315  2250 14265.7256   41  117 14159.3393 20968.2828  48.1%  6311 1859s
  4499  2251 14301.9840   47  475 14159.3393 20968.2828  48.1%  6377 2047s
  4501  2252 16317.0312   34  161 14159.3393 20968.2828  48.1%  6374 2058s
  4502  2253 16093.9728   34  324 14159.3393 20968.2828  48.1%  6372 2106s
  4503  2254 20193.2376   12  440 14159.3393 20968.2828  48.1%  6371 2148s
  4504  2254 15634.8572   28  390 14159.3393 20968.2828  48.1%  6370 2174s
  4505  2255 17973.7493   16  445 14159.3393 20968.2828  48.1%  6368 2194s
  4506  2256 18527.6511   11  389 14159.3393 20968.2828  48.1%  6367 2208s
  4507  2256 20347.9286   10  419 14159.3393 20968.2828  48.1%  6365 2219s
  4508  2257 16135.7141   21  420 14159.3393 20968.2828  48.1%  6364 2231s
  4509  2258 17212.0386   16  430 14159.3393 20968.2828  48.1%  6362 2236s
  4510  2258 15229.9708   16  439 14159.3393 20968.2828  48.1%  6361 2240s
  4512  2260 14356.4004   50  443 14159.3393 20968.2828  48.1%  6358 2248s
  4513  2260 14440.7869   35  463 14159.3393 20968.2828  48.1%  6357 2262s
  4514  2261 17251.2374   13  424 14159.3393 20968.2828  48.1%  6355 2269s
  4515  2262 15929.0892   21  470 14159.3393 20968.2828  48.1%  6354 2279s
  4516  2262 14401.5434   22  359 14159.3393 20968.2828  48.1%  6353 2283s
  4517  2263 20304.1629   11  311 14159.3393 20968.2828  48.1%  6351 2292s
  4518  2264 16723.5785   20  433 14159.3393 20968.2828  48.1%  6350 2299s
  4519  2264 14646.6542   51  467 14159.3393 20968.2828  48.1%  6348 2306s
  4520  2265 15049.1858   40  407 14159.3393 20968.2828  48.1%  6347 2310s
  4521  2266 19296.0174   17  396 14159.3393 20968.2828  48.1%  6346 2317s
  4522  2266 19449.2108   16  386 14159.3393 20968.2828  48.1%  6344 2321s
  4523  2267 14901.3578   46  404 14159.3393 20968.2828  48.1%  6343 2329s
  4524  2268 16212.8230   24  328 14159.3393 20968.2828  48.1%  6341 2334s
  4525  2268 14633.6916   53  327 14159.3393 20968.2828  48.1%  6340 2342s
  4526  2269 18635.5283   11  438 14159.3393 20968.2828  48.1%  6339 2345s
  4527  2270 15170.3943   48  427 14159.3393 20968.2828  48.1%  6337 2355s
  4529  2271 14532.4102   16  262 14159.3393 20968.2828  48.1%  6334 2363s
  4530  2272 15336.0115   38  375 14159.3393 20968.2828  48.1%  6333 2367s
  4531  2272 14926.0678   56  427 14159.3393 20968.2828  48.1%  6332 2375s
  4532  2273 17416.9972   12  427 14159.3393 20968.2828  48.1%  6330 2387s
  4533  2274 14385.6873   49  427 14159.3393 20968.2828  48.1%  6329 2423s
  4534  2277 20968.2828   14  431 14159.3393 20968.2828  48.1%  6393 2527s
  4536  2281 20968.2828   15  304 14159.3393 20968.2828  48.1%  6395 2562s
  4540  2287 20968.2828   16  382 14159.3393 20968.2828  48.1%  6400 2601s
  4548  2301 20968.2828   17  436 14159.3393 20968.2828  48.1%  6414 2634s
  4564  2311 20968.2828   18  450 14159.3393 20968.2828  48.1%  6456 3185s
  4580  2338 20673.8680   19  387 14159.3393 20968.2828  48.1%  6518 3211s
  4612  2410 20505.2966   20  375 14159.3393 20968.2828  48.1%  6520 3247s
  4701  2410 20152.0583   21  349 14159.3393 20968.2828  48.1%  6612 3267s
  4732  2429 19853.5812   22  365 14159.3393 20968.2828  48.1%  6620 3294s
  4768  2449 20002.8778   22  360 14159.3393 20968.2828  48.1%  6617 3330s
  4813  2460 19839.2576   23  355 14159.3393 20968.2828  48.1%  6603 3355s
  4847  2475 19489.1384   22  391 14159.3393 20968.2828  48.1%  6595 3391s
  4884  2484 19469.6786   23  348 14159.3393 20968.2828  48.1%  6593 3416s
  4950  2474 19094.1336   24  358 14159.3393 20968.2828  48.1%  6601 3442s
  5003  2462 19282.6717   24  363 14159.3393 20968.2828  48.1%  6594 3476s
  5046  2448 16941.0901   23  358 14159.3393 20968.2828  48.1%  6592 3511s
  5094  2445 16619.5242   24  180 14159.3393 20968.2828  48.1%  6591 3535s
  5150  2436 14744.4334   25  190 14159.3393 20968.2828  48.1%  6636 3562s
  5194  2428 18178.9068   23  195 14159.3393 20968.2828  48.1%  6640 3589s
  5233  2413     cutoff   26      14159.3393 20968.2828  48.1%  6641 3600s

Cutting planes:
  Learned: 1
  Gomory: 23
  Implied bound: 23
  Projected implied bound: 93
  MIR: 1105
  Flow cover: 1898
  Inf proof: 1
  RLT: 18
  Relax-and-lift: 208

Explored 5261 nodes (35446216 simplex iterations) in 3600.06 seconds (8548.84 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14159.3 14152.8 14119.2 ... 12821.8

Time limit reached
Best objective 1.415933933628e+04, best bound 2.096828281482e+04, gap 48.0880%
  WARNING: Time limit reached. Using best solution found (gap: 48.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 14159.34, θ = 156508.62
  Upper Bound (UB) = 14159.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156508.62
  [DEBUG]   ✓ Scenario 0: θ = 156508.62 ≤ Q = 156508.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156508.62 ≤ Q = 156508.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 156508.62 ≤ Q = 156508.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 156508.62 ≤ Q = 156508.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 156508.62 ≤ Q = 156508.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2f6ccba9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd0933457
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.272857e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6812316.5486
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.445413e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144541.28    0  134 6812316.55 -144541.28   102%     -    0s
H    0     0                    -105843.2211 -144541.28  36.6%     -    0s
H    0     0                    -106548.5601 -144541.28  35.7%     -    0s
H    0     0                    -108878.9159 -144541.28  32.8%     -    0s
H    0     0                    -117437.4390 -144541.28  23.1%     -    0s
H    0     0                    -121204.4649 -125639.71  3.66%     -    0s
     0     0 -125639.71    0  100 -121204.46 -125639.71  3.66%     -    0s
H    0     0                    -121476.4449 -125584.35  3.38%     -    0s
H    0     0                    -122645.0364 -125584.35  2.40%     -    0s
H    0     0                    -122917.0163 -125584.35  2.17%     -    0s
     0     0 -125478.59    0   96 -122917.02 -125478.59  2.08%     -    0s
H    0     0                    -123004.5322 -124377.57  1.12%     -    0s
     0     0 -124377.57    0   89 -123004.53 -124377.57  1.12%     -    0s
     0     0 -124325.39    0   82 -123004.53 -124325.39  1.07%     -    0s
     0     0 -124323.96    0   85 -123004.53 -124323.96  1.07%     -    0s
     0     0 -123991.93    0   79 -123004.53 -123991.93  0.80%     -    0s
H    0     0                    -123013.1391 -123989.66  0.79%     -    0s
     0     0 -123938.89    0   80 -123013.14 -123938.89  0.75%     -    0s
     0     0 -123920.38    0   80 -123013.14 -123920.38  0.74%     -    0s
     0     0 -123664.58    0   63 -123013.14 -123664.58  0.53%     -    0s
     0     0 -123592.13    0   62 -123013.14 -123592.13  0.47%     -    0s
     0     0 -123556.74    0   63 -123013.14 -123556.74  0.44%     -    0s
     0     0 -123552.07    0   63 -123013.14 -123552.07  0.44%     -    0s
     0     0 -123464.30    0   62 -123013.14 -123464.30  0.37%     -    0s
     0     0 -123457.04    0   62 -123013.14 -123457.04  0.36%     -    0s
     0     2 -123457.04    0   62 -123013.14 -123457.04  0.36%     -    0s
H   56    40                    -123018.8739 -123183.27  0.13%  16.7    0s
H  563   389                    -123031.4869 -123151.56  0.10%   5.4    0s
H  583   389                    -123053.6544 -123151.56  0.08%   5.3    0s
H  638   389                    -123070.5733 -123151.56  0.07%   5.2    0s
*  861   311              16    -123072.6417 -123137.14  0.05%   4.7    0s
* 1124   268              17    -123076.7840 -123122.16  0.04%   4.5    0s

Cutting planes:
  Gomory: 45
  Implied bound: 7
  MIR: 149
  Flow cover: 14
  RLT: 74
  BQP: 4

Explored 1442 nodes (6494 simplex iterations) in 0.23 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123077 -123073 -123071 ... -122645
No other solutions better than -123077

Optimal solution found (tolerance 1.00e-06)
Best objective -1.230767839943e+05, best bound -1.230767839943e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 144612.84
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123076.78
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -123076.78 = 144612.84
  [DEBUG]   Current θ from Master = 156508.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11895.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2263.56
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 1958.0546, Absolute Gap = 1958.0546, Relative Gap = 0.138287
  Not converged yet (gap = 1958.05 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611089 nonzeros
Model fingerprint: 0x9fa9e1c8
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87668 rows and 35588 columns
Presolve time: 2.14s
Presolved: 127775 rows, 54032 columns, 784527 nonzeros
Variable types: 51773 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 701
 AA' NZ     : 5.356e+06
 Factor NZ  : 1.236e+07 (roughly 170 MB of memory)
 Factor Ops : 2.687e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70331662e+07  2.16859614e+08  1.05e+05 2.30e+01  7.31e+04     4s
   1  -1.28656756e+07  1.89005418e+08  7.21e+04 6.22e+01  4.97e+04     4s
   2  -5.38204895e+06  1.47118471e+08  2.91e+04 7.32e-01  2.08e+04     4s
   3  -8.51404603e+05  1.10346910e+08  1.91e+03 1.85e+00  1.75e+03     4s
   4  -5.27692272e+05  3.64285539e+07  4.44e+02 1.39e-01  4.17e+02     4s
   5  -4.08822774e+05  2.68317974e+07  1.77e+02 8.97e-02  2.13e+02     4s
   6  -2.97655652e+05  1.87959484e+07  7.61e+01 5.89e-02  1.19e+02     4s
   7  -2.64577898e+05  1.45645800e+07  5.94e+01 4.29e-02  8.87e+01     4s
   8  -1.71124967e+05  1.32332848e+07  2.24e+01 3.87e-02  6.64e+01     4s
   9  -1.26749939e+05  1.09334264e+07  1.35e+01 3.12e-02  5.20e+01     4s
  10  -1.14108670e+05  5.67920191e+06  7.58e+00 1.57e-02  2.64e+01     4s
  11  -8.72993448e+04  3.60650309e+06  3.35e+00 9.74e-03  1.63e+01     5s
  12  -6.72928804e+04  2.40500365e+06  1.30e+00 6.47e-03  1.07e+01     5s
  13  -4.81603914e+04  7.43688856e+05  5.70e-01 1.93e-03  3.41e+00     5s
  14  -2.75469439e+04  4.31921165e+05  2.91e-01 9.13e-04  1.97e+00     5s
  15  -8.52118290e+03  2.10619374e+05  1.38e-01 8.67e-04  9.41e-01     5s
  16   1.43799279e+03  1.37000692e+05  9.19e-02 1.39e-03  5.82e-01     5s
  17   4.97226739e+03  1.12899436e+05  7.99e-02 1.47e-03  4.63e-01     5s
  18   1.22530970e+04  9.61684834e+04  5.80e-02 1.50e-03  3.60e-01     5s
  19   1.45952735e+04  8.68409430e+04  5.16e-02 2.13e-03  3.10e-01     5s
  20   1.70331098e+04  7.46892146e+04  4.52e-02 1.90e-03  2.47e-01     5s
  21   2.05293560e+04  6.40656853e+04  3.64e-02 2.29e-03  1.87e-01     5s
  22   2.35850555e+04  6.05303873e+04  2.94e-02 2.37e-03  1.59e-01     5s
  23   2.68671473e+04  5.68904810e+04  2.22e-02 1.94e-03  1.29e-01     5s
  24   2.89317623e+04  5.44623079e+04  1.81e-02 1.68e-03  1.10e-01     5s
  25   3.11011616e+04  5.03303807e+04  1.43e-02 1.20e-03  8.25e-02     6s
  26   3.26680473e+04  4.76850696e+04  1.17e-02 8.68e-04  6.44e-02     6s
  27   3.38105099e+04  4.57915738e+04  9.87e-03 6.38e-04  5.14e-02     6s
  28   3.50491697e+04  4.49035785e+04  7.97e-03 5.26e-04  4.23e-02     6s
  29   3.56479168e+04  4.35102937e+04  7.05e-03 3.62e-04  3.37e-02     6s
  30   3.63354215e+04  4.29701337e+04  6.06e-03 2.91e-04  2.85e-02     6s
  31   3.67621204e+04  4.24823620e+04  5.43e-03 2.28e-04  2.46e-02     6s
  32   3.71723019e+04  4.23803307e+04  4.85e-03 2.14e-04  2.24e-02     6s
  33   3.79497791e+04  4.19796814e+04  3.72e-03 1.64e-04  1.73e-02     6s
  34   3.80712850e+04  4.17582575e+04  3.55e-03 1.36e-04  1.58e-02     6s
  35   3.84253364e+04  4.14574461e+04  3.04e-03 9.56e-05  1.30e-02     6s
  36   3.91361181e+04  4.12479323e+04  2.08e-03 6.85e-05  9.07e-03     6s
  37   3.95800121e+04  4.11190610e+04  1.46e-03 5.31e-05  6.61e-03     7s
  38   4.00200775e+04  4.08983227e+04  8.50e-04 2.74e-05  3.77e-03     7s
  39   4.02707945e+04  4.07949131e+04  5.19e-04 1.38e-05  2.25e-03     7s
  40   4.03127463e+04  4.07923994e+04  4.66e-04 1.35e-05  2.06e-03     7s
  41   4.03368155e+04  4.07843566e+04  4.35e-04 1.25e-05  1.92e-03     7s
  42   4.03868001e+04  4.07444092e+04  3.73e-04 7.64e-06  1.54e-03     7s
  43   4.05048385e+04  4.07183677e+04  2.20e-04 7.23e-06  9.17e-04     7s
  44   4.05477517e+04  4.07041202e+04  1.63e-04 4.37e-06  6.71e-04     7s
  45   4.06067225e+04  4.06935824e+04  8.82e-05 2.99e-06  3.73e-04     7s
  46   4.06372665e+04  4.06911337e+04  5.00e-05 2.35e-06  2.31e-04     7s
  47   4.06674812e+04  4.06854887e+04  1.48e-05 9.18e-07  7.73e-05     7s
  48   4.06805479e+04  4.06817870e+04  8.59e-07 6.00e-07  5.32e-06     7s
  49   4.06810481e+04  4.06816186e+04  4.25e-07 1.08e-07  2.45e-06     8s
  50   4.06815702e+04  4.06815817e+04  9.65e-09 4.40e-09  4.90e-08     8s
  51   4.06815725e+04  4.06815814e+04  3.33e-07 3.09e-09  3.85e-08     8s
  52   4.06815750e+04  4.06815809e+04  1.17e-06 2.87e-09  2.51e-08     8s
  53   4.06815799e+04  4.06815809e+04  7.33e-07 2.11e-08  3.71e-09     8s
  54   4.06815804e+04  4.06815809e+04  4.46e-07 9.54e-09  1.91e-09     8s
  55   4.06815805e+04  4.06815809e+04  5.31e-07 7.67e-09  1.32e-09     8s

Barrier solved model in 55 iterations and 8.02 seconds (12.61 work units)
Optimal objective 4.06815805e+04


Root crossover log...

  113973 DPushes remaining with DInf 0.0000000e+00                 8s
   15626 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

   16748 PPushes remaining with PInf 1.2730323e-04                12s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2156550e+03     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   76661    4.0681581e+04   0.000000e+00   2.215655e+03     13s
   76843    4.0681581e+04   0.000000e+00   0.000000e+00     13s
   76843    4.0681581e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.068158e+04, 76843 iterations, 10.26 seconds (21.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40681.5809    0  188 -233197.24 40681.5809   117%     -   13s
H    0     0                    -231457.7610 40681.5809   118%     -   13s
H    0     0                    -142404.5933 40681.5809   129%     -   14s
H    0     0                    -58119.03510 40681.5809   170%     -   14s
H    0     0                    10790.830664 40681.5809   277%     -   14s
H    0     0                    12821.848300 40681.5809   217%     -   14s
H    0     0                    12866.092205 34249.8205   166%     -   45s
     0     0 34249.8205    0  242 12866.0922 34249.8205   166%     -   46s
     0     0 33064.8352    0  275 12866.0922 33064.8352   157%     -   66s
     0     0 33064.7441    0  275 12866.0922 33064.7441   157%     -   67s
H    0     0                    13137.033459 29318.2906   123%     -  115s
H    0     0                    13209.318960 29318.2906   122%     -  115s
     0     0 29318.2906    0  324 13209.3190 29318.2906   122%     -  115s
     0     0 28495.4750    0  401 13209.3190 28495.4750   116%     -  142s
     0     0 28338.7803    0  366 13209.3190 28338.7803   115%     -  160s
     0     0 28278.1316    0  363 13209.3190 28278.1316   114%     -  171s
     0     0 28246.5106    0  376 13209.3190 28246.5106   114%     -  176s
     0     0 28231.8473    0  369 13209.3190 28231.8473   114%     -  182s
     0     0 28226.6160    0  374 13209.3190 28226.6160   114%     -  184s
     0     0 28225.4761    0  367 13209.3190 28225.4761   114%     -  186s
     0     0 26229.0845    0  350 13209.3190 26229.0845  98.6%     -  237s
     0     0 25523.0290    0  404 13209.3190 25523.0290  93.2%     -  259s
     0     0 25263.3801    0  368 13209.3190 25263.3801  91.3%     -  277s
     0     0 25107.1700    0  361 13209.3190 25107.1700  90.1%     -  289s
     0     0 25077.1966    0  361 13209.3190 25077.1966  89.8%     -  295s
     0     0 25033.1643    0  373 13209.3190 25033.1643  89.5%     -  302s
     0     0 25027.1338    0  366 13209.3190 25027.1338  89.5%     -  305s
     0     0 24986.1727    0  384 13209.3190 24986.1727  89.2%     -  313s
     0     0 24974.4437    0  383 13209.3190 24974.4437  89.1%     -  318s
     0     0 24966.7660    0  429 13209.3190 24966.7660  89.0%     -  322s
     0     0 24932.8931    0  479 13209.3190 24932.8931  88.8%     -  329s
     0     0 24926.0551    0  377 13209.3190 24926.0551  88.7%     -  332s
     0     0 24909.0114    0  477 13209.3190 24909.0114  88.6%     -  337s
     0     0 24844.0167    0  422 13209.3190 24844.0167  88.1%     -  345s
     0     0 24819.5035    0  480 13209.3190 24819.5035  87.9%     -  349s
     0     0 24757.6072    0  473 13209.3190 24757.6072  87.4%     -  357s
     0     0 24743.7762    0  476 13209.3190 24743.7762  87.3%     -  362s
     0     0 24736.4318    0  478 13209.3190 24736.4318  87.3%     -  366s
     0     0 24733.6748    0  475 13209.3190 24733.6748  87.2%     -  369s
     0     0 24721.5372    0  476 13209.3190 24721.5372  87.2%     -  372s
     0     0 24707.4105    0  479 13209.3190 24707.4105  87.0%     -  379s
     0     0 24702.2472    0  484 13209.3190 24702.2472  87.0%     -  381s
     0     0 24701.1227    0  484 13209.3190 24701.1227  87.0%     -  383s
     0     0 23854.2774    0  454 13209.3190 23854.2774  80.6%     -  415s
     0     0 23684.1715    0  391 13209.3190 23684.1715  79.3%     -  429s
     0     0 23616.5421    0  465 13209.3190 23616.5421  78.8%     -  436s
     0     0 23589.1492    0  411 13209.3190 23589.1492  78.6%     -  442s
     0     0 23535.6733    0  397 13209.3190 23535.6733  78.2%     -  449s
     0     0 23500.0453    0  477 13209.3190 23500.0453  77.9%     -  454s
     0     0 23476.6480    0  433 13209.3190 23476.6480  77.7%     -  461s
     0     0 23443.9104    0  437 13209.3190 23443.9104  77.5%     -  464s
     0     0 23431.8732    0  482 13209.3190 23431.8732  77.4%     -  468s
     0     0 23431.4952    0  434 13209.3190 23431.4952  77.4%     -  469s
     0     0 23310.5288    0  418 13209.3190 23310.5288  76.5%     -  479s
     0     0 23276.2497    0  431 13209.3190 23276.2497  76.2%     -  483s
     0     0 23265.3086    0  413 13209.3190 23265.3086  76.1%     -  487s
     0     0 23249.5162    0  416 13209.3190 23249.5162  76.0%     -  490s
     0     0 23242.2056    0  429 13209.3190 23242.2056  76.0%     -  491s
     0     0 23238.4631    0  424 13209.3190 23238.4631  75.9%     -  493s
     0     0 23236.6199    0  490 13209.3190 23236.6199  75.9%     -  495s
     0     0 23207.5950    0  440 13209.3190 23207.5950  75.7%     -  503s
H    0     0                    13303.906788 23207.5172  74.4%     -  508s
H    0     0                    13473.593914 23207.5172  72.2%     -  508s
     0     0 23181.2268    0  439 13473.5939 23181.2268  72.0%     -  513s
     0     0 23179.9890    0  441 13473.5939 23179.9890  72.0%     -  515s
     0     0 23156.7047    0  452 13473.5939 23156.7047  71.9%     -  521s
H    0     0                    13510.619705 23155.8640  71.4%     -  521s
     0     0 23141.0947    0  387 13510.6197 23141.0947  71.3%     -  524s
     0     0 23128.5950    0  380 13510.6197 23128.5950  71.2%     -  527s
     0     0 23126.4176    0  377 13510.6197 23126.4176  71.2%     -  529s
     0     0 23097.8088    0  452 13510.6197 23097.8088  71.0%     -  536s
     0     0 23093.4676    0  377 13510.6197 23093.4676  70.9%     -  544s
     0     0 23088.0570    0  447 13510.6197 23088.0570  70.9%     -  546s
     0     0 23086.3092    0  382 13510.6197 23086.3092  70.9%     -  547s
     0     0 23083.1465    0  441 13510.6197 23083.1465  70.9%     -  550s
     0     0 23081.9199    0  459 13510.6197 23081.9199  70.8%     -  553s
     0     0 23080.6367    0  463 13510.6197 23080.6367  70.8%     -  556s
     0     0 23078.7420    0  468 13510.6197 23078.7420  70.8%     -  559s
     0     0 23077.2650    0  389 13510.6197 23077.2650  70.8%     -  562s
     0     0 23076.5470    0  455 13510.6197 23076.5470  70.8%     -  564s
     0     0 23073.9048    0  449 13510.6197 23073.9048  70.8%     -  568s
     0     0 23072.7055    0  449 13510.6197 23072.7055  70.8%     -  570s
H    0     0                    13536.634905 23072.7055  70.4%     -  624s
H    0     0                    13580.878810 23072.7055  69.9%     -  625s
     0     2 23072.7055    0  449 13580.8788 23072.7055  69.9%     -  719s
     1     4 22945.8372    1  508 13580.8788 23066.9321  69.8% 11755  730s
     3     8 22521.1323    2  513 13580.8788 22943.2664  68.9% 11143  744s
     7    16 22272.5832    3  520 13580.8788 22615.0385  66.5% 11678  755s
    15    32 22076.6452    4  526 13580.8788 22274.9461  64.0% 10880  765s
    31    48 21982.2387    5  514 13580.8788 22076.6310  62.6% 12818  803s
    47    79 21856.2335    6  533 13580.8788 22076.6310  62.6% 14425  824s
H   56    79                    13644.583988 22076.6310  61.8% 13238  824s
    78   156 21467.1597    7  455 13644.5840 22076.6310  61.8% 11661  846s
   155   184 16142.3319   12  131 13644.5840 22076.6310  61.8%  9702  863s
   183   218 20300.1177   10  387 13644.5840 22076.6310  61.8%  9115  880s
   219   245 15592.4176   13  126 13644.5840 22076.6310  61.8%  8292  900s
   252   270 15556.1015   14  119 13644.5840 22076.6310  61.8%  7976  918s
   281   298 17815.0657   11  228 13644.5840 22076.6310  61.8%  7664  933s
   316   330 17288.4334   12  178 13644.5840 22076.6310  61.8%  7749  949s
   368   369 16651.6284   13  162 13644.5840 22076.6310  61.8%  7488  966s
   414   388     cutoff   14      13644.5840 22076.6310  61.8%  7330  984s
   467   393     cutoff   15      13644.5840 22076.6310  61.8%  7107 1004s
   523   411     cutoff   17      13644.5840 22076.6310  61.8%  6751 1021s
   561   411     cutoff   17      13644.5840 22076.6310  61.8%  6751 1039s
   618   420     cutoff   17      13644.5840 22076.6310  61.8%  6507 1059s
   663   438 20191.0207    9  407 13644.5840 22076.6310  61.8%  6433 1075s
   719   449 14417.1769   13  188 13644.5840 22076.6310  61.8%  6352 1095s
   771   478 17628.8517   10  213 13644.5840 22076.6310  61.8%  6157 1109s
   827   498 17263.5343   11  207 13644.5840 22076.6310  61.8%  6075 1124s
   884   539 16761.4951   12  214 13644.5840 22076.6310  61.8%  6027 1139s
   948   565 16758.8385   13  215 13644.5840 22076.6310  61.8%  5923 1155s
  1020   590 16669.7016   14  215 13644.5840 22076.6310  61.8%  5777 1174s
  1104   609 16554.2738   15  221 13644.5840 22076.6310  61.8%  5642 1194s
  1171   644 16520.4825   16  221 13644.5840 22076.6310  61.8%  5566 1212s
  1255   708     cutoff   17      13644.5840 22076.6310  61.8%  5504 1230s
  1373   767     cutoff   17      13644.5840 22076.6310  61.8%  5366 1248s
  1511   839 14609.2907   16  354 13644.5840 22076.6310  61.8%  5231 1268s
  1635   867 14564.0768   17  366 13644.5840 22076.6310  61.8%  5139 1290s
  1747   914     cutoff   16      13644.5840 22076.6310  61.8%  5144 1309s
  1852   987 16389.8632   20  321 13644.5840 22076.6310  61.8%  5271 1329s
  1957  1065 16291.8122   22  308 13644.5840 22076.6310  61.8%  5401 1350s
  2098  1167 15964.2247   27  270 13644.5840 22076.6310  61.8%  5478 1370s
  2257  1272 14744.5857   31  254 13644.5840 22076.6310  61.8%  5479 1393s
  2424  1361 13687.3739   33  227 13644.5840 22076.6310  61.8%  5445 1418s
  2575  1403 15434.3617   28  320 13644.5840 22076.6310  61.8%  5487 1443s
  2737  1449 15339.2385   29  317 13644.5840 22076.6310  61.8%  5498 1468s
  2878  1487 13747.5170   32  327 13644.5840 22076.6310  61.8%  5608 1496s
  3018  1552 18731.9974    8  256 13644.5840 22076.6310  61.8%  5713 1525s
  3147  1644 16458.8262    9  351 13644.5840 22076.6310  61.8%  5839 1555s
  3324  1705     cutoff   12      13644.5840 22076.6310  61.8%  5811 1585s
  3531  1765     cutoff   12      13644.5840 22076.6310  61.8%  5805 1614s
  3722  1870     cutoff   24      13644.5840 21566.4191  58.1%  5850 1647s
  3938  1916 20051.1398    6  518 13644.5840 21566.0442  58.1%  5859 1682s
  4068  1945 19644.1000    7  384 13644.5840 21390.1056  56.8%  5930 1715s
  4189  2018 16754.6890   10  220 13644.5840 21390.1056  56.8%  5995 1749s
  4365  2076     cutoff   13      13644.5840 20673.5922  51.5%  6010 1790s
  4579  2140 17760.9215    8  237 13644.5840 20432.7705  49.8%  6011 1828s
  4790  2178     cutoff   11      13644.5840 20432.7705  49.8%  6078 1868s
  5044  2190 16828.3090   13  205 13644.5840 20432.7705  49.8%  6103 1912s
  5240  2250 14367.5988   19  222 13644.5840 20212.2919  48.1%  6166 1956s
  5414  2301 14877.3029   13  130 13644.5840 20212.2919  48.1%  6291 2004s
  5637  2367 16810.2020   11  354 13644.5840 20050.6901  46.9%  6393 2057s
  5836  2369 14763.5165   14  236 13644.5840 20050.6901  46.9%  6492 2111s
  6080  2400     cutoff   12      13644.5840 19614.3368  43.8%  6571 2167s
  6283  2418 17818.5097   10  335 13644.5840 19536.5568  43.2%  6669 2217s
  6329  2434 17605.5249   11  366 13644.5840 19536.5568  43.2%  6708 2267s
  6371  2449 17223.1161   12  357 13644.5840 19536.5568  43.2%  6751 2310s
  6461  2460 15777.6318   13  295 13644.5840 19536.5568  43.2%  6762 2363s
  6626  2523 14176.7328   16  197 13644.5840 19407.3864  42.2%  6830 2423s
  6916  2603 16192.0265   14  393 13644.5840 19407.3864  42.2%  6853 2488s
  7212  2604 14911.5008   20  449 13644.5840 19407.3864  42.2%  6885 2636s
  7214  2605 18383.2584   12  149 13644.5840 19407.3864  42.2%  6884 2653s
  7215  2606 14494.2600   43  309 13644.5840 19407.3864  42.2%  6883 2724s
  7216  2607 18648.3019   14  395 13644.5840 19407.3864  42.2%  6882 2807s
  7217  2607 16247.5176   11  396 13644.5840 19407.3864  42.2%  6881 2851s
  7218  2608 14225.0956   13  369 13644.5840 19407.3864  42.2%  6880 2897s
  7219  2609 15089.3842   16  474 13644.5840 19407.3864  42.2%  6879 2915s
  7220  2609 14941.0547   32  420 13644.5840 19407.3864  42.2%  6878 2927s
  7221  2610 15191.6633   21  427 13644.5840 19407.3864  42.2%  6877 2940s
  7222  2611 14448.8279   22  429 13644.5840 19407.3864  42.2%  6876 2950s
  7223  2611 14333.2732   32  399 13644.5840 19407.3864  42.2%  6875 2957s
  7224  2612 18734.6812   13  459 13644.5840 19407.3864  42.2%  6874 2966s
  7225  2613 14704.7252   16  379 13644.5840 19407.3864  42.2%  6873 2985s
  7226  2613 15233.8060   12  440 13644.5840 19407.3864  42.2%  6872 2995s
  7227  2614 15796.5330   32  496 13644.5840 19407.3864  42.2%  6871 3005s
  7228  2615 15312.3940   28  441 13644.5840 19407.3864  42.2%  6870 3019s
  7229  2615 15451.3395   19  374 13644.5840 19407.3864  42.2%  6869 3025s
  7230  2616 14079.1650   35  438 13644.5840 19407.3864  42.2%  6868 3038s
  7231  2617 14643.8429   33  430 13644.5840 19407.3864  42.2%  6867 3045s
  7232  2617 16839.5865   12  430 13644.5840 19407.3864  42.2%  6866 3058s
  7233  2618 16348.9259   11  425 13644.5840 19407.3864  42.2%  6865 3065s
  7234  2619 16890.3456   17  430 13644.5840 19407.3864  42.2%  6865 3076s
  7235  2619 13734.3388   20  427 13644.5840 19407.3864  42.2%  6864 3082s
  7236  2620 15540.4871   15  423 13644.5840 19407.3864  42.2%  6863 3093s
  7237  2621 17868.1910   14  405 13644.5840 19407.3864  42.2%  6862 3099s
  7238  2621 14791.1680   33  404 13644.5840 19407.3864  42.2%  6861 3108s
  7239  2622 17158.6100   11  404 13644.5840 19407.3864  42.2%  6860 3127s
  7240  2623 17377.3545   21  404 13644.5840 19407.3864  42.2%  6859 3168s
  7241  2625 19407.3864   15  333 13644.5840 19407.3864  42.2%  6904 3197s
  7242  2626 19407.3864   15  390 13644.5840 19407.3864  42.2%  6905 3225s
  7243  2630 19407.3864   16  371 13644.5840 19407.3864  42.2%  6907 3259s
  7247  2636 19407.3864   17  385 13644.5840 19407.3864  42.2%  6911 3311s
  7255  2650 19407.3864   18  346 13644.5840 19407.3864  42.2%  6920 3341s
  7271  2660 19407.3864   19  363 13644.5840 19407.3864  42.2%  6944 3399s
  7287  2687 19407.3864   20  436 13644.5840 19407.3864  42.2%  6977 3431s
  7319  2766 19407.3864   21  466 13644.5840 19407.3864  42.2%  7033 3475s
  7413  2768 19407.3864   23  353 13644.5840 19407.3864  42.2%  7025 3507s
  7480  2766 14595.5348   25  283 13644.5840 19407.3864  42.2%  7007 3541s
  7539  2756 19407.3864   23  377 13644.5840 19407.3864  42.2%  6996 3566s
  7573  2750 19407.3864   24  383 13644.5840 19407.3864  42.2%  6991 3593s
  7618  2734 15394.7043   26  135 13644.5840 19407.3864  42.2%  6982 3600s

Cutting planes:
  Learned: 1
  Gomory: 9
  Implied bound: 10
  Projected implied bound: 187
  MIR: 1098
  Mixing: 5
  Flow cover: 1948
  RLT: 22
  Relax-and-lift: 241

Explored 7637 nodes (53828892 simplex iterations) in 3600.07 seconds (9769.21 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13644.6 13580.9 13536.6 ... 12821.8

Time limit reached
Best objective 1.364458398796e+04, best bound 1.940738643172e+04, gap 42.2351%
  WARNING: Time limit reached. Using best solution found (gap: 42.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 13644.58, θ = 156198.33
  Upper Bound (UB) = 13644.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156198.33
  [DEBUG]   ✓ Scenario 0: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156198.33 ≤ Q = 156198.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156198.33 ≤ Q = 156198.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 156198.33 ≤ Q = 156198.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 156198.33 ≤ Q = 156198.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 156198.33 ≤ Q = 156198.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 156198.33 ≤ Q = 156198.33 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x27be3322
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x27be3322
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.275607e+13
Presolve removed 2557 rows and 1848 columns
Presolve time: 0.01s
Presolved: 536 rows, 541 columns, 1513 nonzeros
Found heuristic solution: objective 6750064.1233
Variable types: 366 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6749716.6378

Root relaxation: objective -1.451529e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145152.89    0  132 6749716.64 -145152.89   102%     -    0s
H    0     0                    -101341.7634 -145152.89  43.2%     -    0s
H    0     0                    -101828.4641 -145152.89  42.5%     -    0s
H    0     0                    -109690.1349 -145152.89  32.3%     -    0s
H    0     0                    -111175.7588 -144978.32  30.4%     -    0s
     0     0 -121676.05    0   57 -111175.76 -121676.05  9.44%     -    0s
H    0     0                    -118808.5915 -121571.14  2.33%     -    0s
H    0     0                    -119080.5714 -121571.14  2.09%     -    0s
H    0     0                    -120075.7045 -121571.14  1.25%     -    0s
H    0     0                    -120347.6845 -121571.14  1.02%     -    0s
H    0     0                    -120397.8291 -121548.29  0.96%     -    0s
     0     0 -121548.29    0   50 -120397.83 -121548.29  0.96%     -    0s
     0     0 -120964.32    0   42 -120397.83 -120964.32  0.47%     -    0s
     0     0 -120907.91    0   41 -120397.83 -120907.91  0.42%     -    0s
     0     0 -120907.85    0   41 -120397.83 -120907.85  0.42%     -    0s
     0     0 -120677.03    0   21 -120397.83 -120677.03  0.23%     -    0s
     0     0 -120633.64    0   26 -120397.83 -120633.64  0.20%     -    0s
     0     0 -120623.82    0   17 -120397.83 -120623.82  0.19%     -    0s
H    0     0                    -120449.5790 -120623.14  0.14%     -    0s
     0     0 -120623.14    0   15 -120449.58 -120623.14  0.14%     -    0s
     0     0 -120592.21    0   12 -120449.58 -120592.21  0.12%     -    0s
     0     0 -120592.21    0   18 -120449.58 -120592.21  0.12%     -    0s
     0     0 -120537.44    0    4 -120449.58 -120537.44  0.07%     -    0s
H    0     0                    -120453.4108 -120533.78  0.07%     -    0s
H    0     0                    -120484.0644 -120533.78  0.04%     -    0s
H    0     0                    -120532.3849 -120532.38  0.00%     -    0s
     0     0          -    0      -120532.38 -120532.38  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 1
  MIR: 6
  Flow cover: 11
  Relax-and-lift: 3

Explored 1 nodes (750 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120532 -120484 -120453 ... -101828
No other solutions better than -120532

Optimal solution found (tolerance 1.00e-06)
Best objective -1.205323849064e+05, best bound -1.205323849064e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 147157.24
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120532.38
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -120532.38 = 147157.24
  [DEBUG]   Current θ from Master = 156198.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9041.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4603.49
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 1443.2992, Absolute Gap = 1443.2992, Relative Gap = 0.105778
  Not converged yet (gap = 1443.30 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654344 nonzeros
Model fingerprint: 0xc860d47b
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 93930 rows and 38130 columns
Presolve time: 2.76s
Presolved: 136803 rows, 57730 columns, 839639 nonzeros
Variable types: 55471 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.35s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 6.101e+06
 Factor NZ  : 1.405e+07 (roughly 200 MB of memory)
 Factor Ops : 3.189e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70466007e+07  2.29984887e+08  1.05e+05 2.25e+01  7.27e+04     5s
   1  -1.29237035e+07  2.00340382e+08  7.23e+04 6.24e+01  4.95e+04     5s
   2  -5.46202226e+06  1.56412142e+08  2.94e+04 1.14e+00  2.09e+04     5s
   3  -1.10431515e+06  1.17852730e+08  3.36e+03 1.49e+00  2.72e+03     5s
   4  -5.59824878e+05  5.17036552e+07  5.72e+02 2.17e-01  5.54e+02     5s
   5  -4.51627043e+05  3.30568550e+07  2.54e+02 1.11e-01  2.75e+02     5s
   6  -3.62952634e+05  2.40431681e+07  9.94e+01 7.28e-02  1.48e+02     5s
   7  -2.47702761e+05  1.87540615e+07  4.60e+01 5.41e-02  9.66e+01     5s
   8  -1.30179058e+05  1.45413164e+07  1.01e+01 4.04e-02  6.26e+01     5s
   9  -1.15405847e+05  8.47101288e+06  7.51e+00 2.27e-02  3.62e+01     5s
  10  -1.05826469e+05  5.10105552e+06  4.52e+00 1.34e-02  2.16e+01     5s
  11  -7.82872102e+04  1.35058766e+06  1.90e+00 3.05e-03  5.82e+00     5s
  12  -5.12684622e+04  6.06888852e+05  8.24e-01 1.74e-03  2.66e+00     5s
  13  -2.49306091e+04  3.73151486e+05  4.01e-01 1.29e-03  1.60e+00     5s
  14  -1.00411344e+04  1.98583000e+05  2.52e-01 1.20e-03  8.39e-01     5s
  15  -2.32600819e+03  1.55668693e+05  1.97e-01 1.11e-03  6.35e-01     6s
  16   1.61759754e+03  1.09216206e+05  1.72e-01 1.38e-03  4.33e-01     6s
  17   8.08085021e+03  9.27973595e+04  1.33e-01 2.13e-03  3.41e-01     6s
  18   1.28792238e+04  8.20256738e+04  1.09e-01 2.01e-03  2.78e-01     6s
  19   1.66689195e+04  7.19222098e+04  9.15e-02 2.29e-03  2.22e-01     6s
  20   2.04347678e+04  6.48989477e+04  7.37e-02 2.06e-03  1.79e-01     6s
  21   2.25181485e+04  5.82013118e+04  6.45e-02 1.82e-03  1.44e-01     6s
  22   2.48299271e+04  5.57818080e+04  5.53e-02 1.54e-03  1.24e-01     6s
  23   2.81488713e+04  5.04277900e+04  4.25e-02 1.51e-03  8.96e-02     6s
  24   3.03475713e+04  4.74224720e+04  3.47e-02 1.66e-03  6.87e-02     6s
  25   3.24173512e+04  4.61870827e+04  2.74e-02 1.55e-03  5.54e-02     6s
  26   3.45724911e+04  4.47623367e+04  2.01e-02 1.11e-03  4.10e-02     6s
  27   3.57361061e+04  4.35464220e+04  1.63e-02 7.51e-04  3.14e-02     6s
  28   3.64969707e+04  4.25566116e+04  1.38e-02 4.63e-04  2.44e-02     6s
  29   3.71190999e+04  4.22567741e+04  1.17e-02 3.72e-04  2.07e-02     6s
  30   3.80317067e+04  4.16727801e+04  8.67e-03 3.67e-04  1.47e-02     7s
  31   3.85408268e+04  4.15201979e+04  7.08e-03 4.45e-04  1.20e-02     7s
  32   3.89392240e+04  4.14208471e+04  5.87e-03 4.34e-04  9.99e-03     7s
  33   3.90305405e+04  4.13476598e+04  5.58e-03 3.81e-04  9.33e-03     7s
  34   3.95692072e+04  4.12407863e+04  3.92e-03 2.18e-04  6.73e-03     7s
  35   3.96719220e+04  4.11758476e+04  3.58e-03 1.93e-04  6.06e-03     7s
  36   4.00416027e+04  4.09893085e+04  2.40e-03 8.03e-05  3.82e-03     7s
  37   4.02413796e+04  4.09308004e+04  1.77e-03 8.47e-05  2.78e-03     7s
  38   4.06236800e+04  4.08891874e+04  6.11e-04 8.31e-05  1.07e-03     7s
  39   4.07093545e+04  4.08710306e+04  3.47e-04 5.87e-05  6.51e-04     7s
  40   4.07205091e+04  4.08644696e+04  3.12e-04 4.94e-05  5.80e-04     7s
  41   4.07248170e+04  4.08611485e+04  2.99e-04 4.51e-05  5.49e-04     7s
  42   4.07647858e+04  4.08442529e+04  1.78e-04 2.17e-05  3.20e-04     8s
  43   4.08042008e+04  4.08365639e+04  6.51e-05 1.23e-05  1.30e-04     8s
  44   4.08165258e+04  4.08313013e+04  2.90e-05 5.27e-06  5.95e-05     8s
  45   4.08247259e+04  4.08309930e+04  6.32e-06 4.89e-06  2.52e-05     8s
  46   4.08248487e+04  4.08305418e+04  5.96e-06 4.33e-06  2.29e-05     8s
  47   4.08258601e+04  4.08288007e+04  3.01e-06 2.14e-06  1.18e-05     8s
  48   4.08265725e+04  4.08285531e+04  1.20e-06 1.83e-06  7.94e-06     8s
  49   4.08269589e+04  4.08278229e+04  1.59e-07 9.30e-07  3.46e-06     8s
  50   4.08270152e+04  4.08276343e+04  5.36e-08 7.00e-07  2.48e-06     8s
  51   4.08270236e+04  4.08275475e+04  4.45e-08 6.04e-07  2.10e-06     8s
  52   4.08270290e+04  4.08270831e+04  2.57e-08 4.28e-08  2.17e-07     8s
  53   4.08270312e+04  4.08270800e+04  3.75e-07 7.98e-08  1.96e-07     9s
  54   4.08270472e+04  4.08270479e+04  6.01e-09 2.80e-09  3.11e-09     9s
  55   4.08270472e+04  4.08270479e+04  4.64e-07 3.29e-08  2.51e-09     9s
  56   4.08270472e+04  4.08270479e+04  4.64e-07 3.24e-08  2.51e-09     9s
  57   4.08270472e+04  4.08270477e+04  6.38e-07 2.48e-08  1.56e-09     9s

Barrier solved model in 57 iterations and 8.97 seconds (14.27 work units)
Optimal objective 4.08270472e+04


Root crossover log...

  118550 DPushes remaining with DInf 0.0000000e+00                 9s
   49711 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                15s

   15261 PPushes remaining with PInf 3.2713202e-04                15s
    3766 PPushes remaining with PInf 5.2635620e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.1509598e+05     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   76430    4.0827048e+04   0.000000e+00   4.150960e+05     16s
   76952    4.0827048e+04   0.000000e+00   0.000000e+00     16s
   76952    4.0827048e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 2.68s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.082705e+04, 76952 iterations, 15.20 seconds (24.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40827.0475    0  244 -233197.24 40827.0475   118%     -   19s
H    0     0                    -231457.7610 40827.0475   118%     -   19s
H    0     0                    -203095.3820 40827.0475   120%     -   20s
H    0     0                    -202472.8105 40827.0475   120%     -   21s
H    0     0                    -202337.7174 40827.0475   120%     -   21s
H    0     0                    -202147.0264 40827.0475   120%     -   21s
H    0     0                    -199701.3700 40827.0475   120%     -   21s
H    0     0                    -57152.70486 40827.0475   171%     -   21s
H    0     0                    4206.1693189 40827.0475   871%     -   22s
H    0     0                    4248.8853999 40827.0475   861%     -   22s
H    0     0                    6808.1943269 40827.0475   500%     -   22s
H    0     0                    6942.7156280 40827.0475   488%     -   22s
H    0     0                    7475.1120786 40827.0475   446%     -   22s
H    0     0                    7573.6756061 40827.0475   439%     -   22s
H    0     0                    7703.1247670 40827.0475   430%     -   22s
H    0     0                    7827.6930476 40827.0475   422%     -   22s
     0     0 33390.2501    0  232 7827.69305 33390.2501   327%     -   59s
H    0     0                    8013.0056897 33390.1781   317%     -   60s
H    0     0                    9731.8470948 33390.1781   243%     -   60s
H    0     0                    10569.435594 33390.1781   216%     -   60s
H    0     0                    10616.507575 33390.1781   215%     -   60s
H    0     0                    10684.712430 33390.1781   213%     -   60s
H    0     0                    10693.743980 33390.1781   212%     -   60s
     0     0 33033.4884    0  272 10693.7440 33033.4884   209%     -   71s
     0     0 33002.2426    0  257 10693.7440 33002.2426   209%     -   74s
     0     0 33001.5586    0  266 10693.7440 33001.5586   209%     -   76s
     0     0 29735.4749    0  286 10693.7440 29735.4749   178%     -  105s
     0     0 28936.3956    0  341 10693.7440 28936.3956   171%     -  137s
     0     0 28656.2673    0  302 10693.7440 28656.2673   168%     -  152s
     0     0 28489.0597    0  355 10693.7440 28489.0597   166%     -  167s
     0     0 28364.1917    0  357 10693.7440 28364.1917   165%     -  175s
     0     0 28324.6924    0  357 10693.7440 28324.6924   165%     -  180s
     0     0 28312.2756    0  365 10693.7440 28312.2756   165%     -  184s
     0     0 28306.4759    0  366 10693.7440 28306.4759   165%     -  186s
     0     0 28301.6100    0  360 10693.7440 28301.6100   165%     -  189s
     0     0 28238.8814    0  358 10693.7440 28238.8814   164%     -  196s
     0     0 28213.4790    0  358 10693.7440 28213.4790   164%     -  200s
     0     0 28209.4937    0  356 10693.7440 28209.4937   164%     -  202s
     0     0 28188.7081    0  361 10693.7440 28188.7081   164%     -  204s
     0     0 28187.0993    0  360 10693.7440 28187.0993   164%     -  206s
     0     0 28187.0369    0  359 10693.7440 28187.0369   164%     -  206s
     0     0 26173.1855    0  293 10693.7440 26173.1855   145%     -  243s
H    0     0                    10774.419158 26173.0900   143%     -  244s
     0     0 25586.7899    0  341 10774.4192 25586.7899   137%     -  272s
     0     0 25295.7869    0  417 10774.4192 25295.7869   135%     -  293s
     0     0 25207.9121    0  450 10774.4192 25207.9121   134%     -  305s
     0     0 25181.4098    0  407 10774.4192 25181.4098   134%     -  312s
     0     0 25121.9951    0  393 10774.4192 25121.9951   133%     -  322s
     0     0 25088.2106    0  391 10774.4192 25088.2106   133%     -  333s
     0     0 25047.3930    0  426 10774.4192 25047.3930   132%     -  341s
     0     0 25035.6571    0  472 10774.4192 25035.6571   132%     -  347s
     0     0 24926.7333    0  353 10774.4192 24926.7333   131%     -  360s
     0     0 24916.9423    0  355 10774.4192 24916.9423   131%     -  363s
     0     0 24881.5547    0  407 10774.4192 24881.5547   131%     -  367s
     0     0 24817.2806    0  414 10774.4192 24817.2806   130%     -  375s
     0     0 24814.7712    0  418 10774.4192 24814.7712   130%     -  378s
     0     0 24813.5463    0  416 10774.4192 24813.5463   130%     -  380s
     0     0 24106.3145    0  459 10774.4192 24106.3145   124%     -  425s
H    0     0                    10811.694682 24106.1500   123%     -  425s
     0     0 23886.9574    0  447 10811.6947 23886.9574   121%     -  442s
     0     0 23805.3998    0  478 10811.6947 23805.3998   120%     -  454s
     0     0 23750.1329    0  509 10811.6947 23750.1329   120%     -  465s
     0     0 23727.1965    0  514 10811.6947 23727.1965   119%     -  471s
     0     0 23694.8334    0  495 10811.6947 23694.8334   119%     -  477s
     0     0 23596.0213    0  487 10811.6947 23596.0213   118%     -  489s
     0     0 23579.3084    0  498 10811.6947 23579.3084   118%     -  493s
     0     0 23566.3114    0  507 10811.6947 23566.3114   118%     -  497s
     0     0 23555.5960    0  504 10811.6947 23555.5960   118%     -  502s
     0     0 23548.3113    0  503 10811.6947 23548.3113   118%     -  506s
     0     0 23535.1308    0  493 10811.6947 23535.1308   118%     -  511s
     0     0 23534.3635    0  490 10811.6947 23534.3635   118%     -  512s
     0     0 23403.5055    0  384 10811.6947 23403.5055   116%     -  524s
     0     0 23356.1688    0  503 10811.6947 23356.1688   116%     -  532s
     0     0 23334.9659    0  544 10811.6947 23334.9659   116%     -  537s
     0     0 23312.2569    0  539 10811.6947 23312.2569   116%     -  544s
     0     0 23305.6360    0  476 10811.6947 23305.6360   116%     -  549s
     0     0 23302.3290    0  539 10811.6947 23302.3290   116%     -  552s
     0     0 23300.0224    0  545 10811.6947 23300.0224   116%     -  554s
     0     0 23276.5690    0  488 10811.6947 23276.5690   115%     -  563s
     0     0 23257.5877    0  489 10811.6947 23257.5877   115%     -  569s
     0     0 23255.8249    0  491 10811.6947 23255.8249   115%     -  571s
     0     0 23242.1658    0  516 10811.6947 23242.1658   115%     -  576s
     0     0 23238.9515    0  484 10811.6947 23238.9515   115%     -  579s
     0     0 23230.1219    0  503 10811.6947 23230.1219   115%     -  580s
     0     0 23227.3148    0  496 10811.6947 23227.3148   115%     -  582s
     0     0 23224.1307    0  504 10811.6947 23224.1307   115%     -  583s
     0     0 23222.5880    0  500 10811.6947 23222.5880   115%     -  584s
     0     0 23205.2727    0  379 10811.6947 23205.2727   115%     -  593s
     0     0 23189.1128    0  389 10811.6947 23189.1128   114%     -  595s
     0     0 23185.2935    0  386 10811.6947 23185.2935   114%     -  596s
     0     0 23185.2935    0  386 10811.6947 23185.2935   114%     -  596s
     0     0 23184.7970    0  392 10811.6947 23184.7970   114%     -  597s
     0     0 23177.9702    0  496 10811.6947 23177.9702   114%     -  603s
H    0     0                    10814.792400 23175.2290   114%     -  604s
     0     0 23160.1969    0  442 10814.7924 23160.1969   114%     -  605s
     0     0 23159.8897    0  449 10814.7924 23159.8897   114%     -  606s
     0     0 23158.4058    0  430 10814.7924 23158.4058   114%     -  609s
H    0     0                    11206.207855 23158.2206   107%     -  610s
H    0     0                    11280.912924 23158.2206   105%     -  610s
H    0     0                    11293.613303 23158.2206   105%     -  610s
H    0     0                    11311.457129 23158.2206   105%     -  610s
H    0     0                    11338.993812 23158.2206   104%     -  610s
H    0     0                    11380.959496 23158.2206   103%     -  610s
     0     0 23158.2206    0  436 11380.9595 23158.2206   103%     -  611s
     0     0 23157.6728    0  479 11380.9595 23157.6728   103%     -  614s
     0     0 23157.3063    0  235 11380.9595 23157.3063   103%     -  615s
     0     0 23151.2445    0  379 11380.9595 23151.2445   103%     -  618s
H    0     0                    11404.235386 23149.4762   103%     -  621s
H    0     0                    11690.326300 23149.4762  98.0%     -  621s
H    0     0                    11892.385757 23149.4762  94.7%     -  621s
     0     0 23143.9955    0  521 11892.3858 23143.9955  94.6%     -  625s
     0     0 23142.7090    0  503 11892.3858 23142.7090  94.6%     -  626s
     0     0 23140.8724    0  432 11892.3858 23140.8724  94.6%     -  629s
H    0     0                    12705.141380 23140.7478  82.1%     -  630s
H    0     0                    12781.687237 23140.7478  81.0%     -  630s
     0     0 23139.7810    0  389 12781.6872 23139.7810  81.0%     -  631s
     0     0 23137.8339    0  386 12781.6872 23137.8339  81.0%     -  635s
     0     0 23136.1807    0  386 12781.6872 23136.1807  81.0%     -  637s
H    0     0                    13066.065926 23135.9096  77.1%     -  659s
     0     2 23135.8894    0  386 13066.0659 23135.8894  77.1%     -  700s
     1     3 22379.4217    1  339 13066.0659 23135.8894  77.1% 18714  711s
     2     4 22874.1041    1  359 13066.0659 22874.1041  75.1% 14084  720s
     3     7 21759.0376    2  289 13066.0659 22869.9738  75.0% 10785  731s
     6    13 22053.8774    3  357 13066.0659 22869.9738  75.0% 10319  747s
    12    26 21841.6326    4  239 13066.0659 22656.5279  73.4% 11722  768s
    25    39 20949.5766    4  293 13066.0659 22225.8560  70.1% 16941  807s
H   38    70                    13209.318960 22225.8560  68.3% 16229  895s
    69   164 19283.6571    7  234 13209.3190 21997.2085  66.5% 17904  932s
   163   212 19219.3920    8  241 13209.3190 21923.5024  66.0% 11912  960s
   219   246 16015.5136    9  240 13209.3190 21923.5024  66.0% 11957  983s
   264   284 15218.0225   14  195 13209.3190 21923.5024  66.0% 11874 1008s
   316   315 14990.6755   11  207 13209.3190 21923.5024  66.0% 12067 1027s
   378   324 13437.4357   12  205 13209.3190 21923.5024  66.0% 11691 1052s
   435   339 14291.5139   13  131 13209.3190 21923.5024  66.0% 11600 1075s
   504   353     cutoff   14      13209.3190 21923.5024  66.0% 11427 1096s
   548   360 17605.1548   11  237 13209.3190 21923.5024  66.0% 11557 1117s
   589   373 16471.4325   13  421 13209.3190 21923.5024  66.0% 11579 1136s
   622   399 16023.0586   12  222 13209.3190 21923.5024  66.0% 11643 1157s
   667   422     cutoff   13      13209.3190 21923.5024  66.0% 11702 1175s
   700   437 16187.4945   16  392 13209.3190 21923.5024  66.0% 11777 1193s
   743   460 14079.8402   11  369 13209.3190 21923.5024  66.0% 11668 1212s
   796   482 infeasible   12      13209.3190 21923.5024  66.0% 11526 1230s
   858   483 infeasible   13      13209.3190 21923.5024  66.0% 11273 1249s
   912   483 13747.0573   18  370 13209.3190 21923.5024  66.0% 11027 1273s
   962   492 infeasible   19      13209.3190 21923.5024  66.0% 11022 1294s
   999   506 16449.3455   10  186 13209.3190 21923.5024  66.0% 11246 1313s
  1037   522     cutoff   11      13209.3190 21923.5024  66.0% 11253 1337s
  1073   543 13468.9646   19  304 13209.3190 21923.5024  66.0% 11348 1363s
  1127   573 16060.8398   24  303 13209.3190 21923.5024  66.0% 11243 1385s
  1199   610 15972.2474   27  261 13209.3190 21923.5024  66.0% 11175 1410s
  1278   623 15863.3170   30  404 13209.3190 21923.5024  66.0% 10944 1436s
  1317   661 15858.8607   31  410 13209.3190 21923.5024  66.0% 11018 1459s
  1371   699 15770.9543   32  349 13209.3190 21923.5024  66.0% 10900 1485s
  1447   739 15635.8659   33  322 13209.3190 21923.5024  66.0% 10679 1510s
  1517   771 15411.6239   34  223 13209.3190 21923.5024  66.0% 10578 1536s
  1602   832 14208.9436   35  192 13209.3190 21923.5024  66.0% 10414 1568s
* 1704   832              47    13220.174745 21563.6084  63.1% 10086 1568s
  1737   905 13873.7335   42  166 13220.1747 21563.6084  63.1% 10049 1601s
  1887   988 13372.8707   51  162 13220.1747 21563.6084  63.1%  9784 1633s
  2053  1008 infeasible   56      13220.1747 21563.6084  63.1%  9544 1666s
  2220  1074 16449.7897    8  174 13220.1747 21563.6084  63.1%  9316 1704s
  2376  1129 16048.5188    9  151 13220.1747 21563.6084  63.1%  9209 1740s
  2507  1186 14180.8975   11  130 13220.1747 21563.6084  63.1%  9225 1779s
  2648  1225 14181.4459   30  333 13220.1747 21563.6084  63.1%  9241 1819s
  2805  1272 13476.6924   12  458 13220.1747 21563.6084  63.1%  9157 1859s
  2938  1321 13440.3563   13  442 13220.1747 21563.6084  63.1%  9172 1903s
  3106  1331 infeasible   37      13220.1747 20356.4689  54.0%  9154 1940s
H 3114  1331                    13312.237804 20289.3979  52.4%  9161 1940s
H 3149  1331                    13412.066625 20122.9335  50.0%  9117 1940s
  3194  1372 19473.1609    7  385 13412.0666 20122.9335  50.0%  9212 1984s
  3316  1404 18237.6828    9  407 13412.0666 20122.9335  50.0%  9375 2031s
  3445  1472 15468.7029    9  466 13412.0666 20122.9335  50.0%  9523 2081s
  3619  1563 infeasible   10      13412.0666 20122.9335  50.0%  9535 2129s
  3844  1624 16115.8012   14  146 13412.0666 19664.6074  46.6%  9417 2182s
  4025  1669     cutoff   13      13412.0666 19664.6074  46.6%  9486 2241s
  4153  1777 15644.5003   18  238 13412.0666 19664.6074  46.6%  9610 2294s
  4365  1776 14286.1897   24  192 13412.0666 19664.6074  46.6%  9578 2360s
H 4378  1771                    13536.634905 19664.6074  45.3%  9561 2360s
  4556  1775     cutoff   35      13536.6349 19664.6074  45.3%  9502 2423s
  4729  1843 15054.0411   12  442 13536.6349 19358.0771  43.0%  9621 2490s
  4931  1875 infeasible   15      13536.6349 19205.6361  41.9%  9691 2559s
  5123  1946 15705.9016   14  571 13536.6349 19205.6361  41.9%  9760 2630s
  5327  1951 14871.1926   17  542 13536.6349 18937.2094  39.9%  9845 2693s
  5386  1965 14833.6422   18  486 13536.6349 18937.2094  39.9%  9864 2745s
  5438  2041 14583.0756   19  486 13536.6349 18937.2094  39.9%  9873 2812s
  5615  2042 13872.8629   20  386 13536.6349 18937.2094  39.9%  9814 2896s
  5617  2043 18338.9781   14  168 13536.6349 18937.2094  39.9%  9811 2910s
  5618  2044 16715.2396   10  340 13536.6349 18937.2094  39.9%  9809 2990s
  5619  2045 14274.8502   46  368 13536.6349 18937.2094  39.9%  9807 3068s
  5620  2045 15312.7353   23  448 13536.6349 18937.2094  39.9%  9805 3112s
  5621  2046 13990.6582   19  404 13536.6349 18937.2094  39.9%  9804 3153s
  5622  2047 18007.9945   16  422 13536.6349 18937.2094  39.9%  9802 3186s
  5623  2047 14140.3660   56  465 13536.6349 18937.2094  39.9%  9800 3204s
  5624  2048 16973.4760   15  511 13536.6349 18937.2094  39.9%  9799 3217s
  5625  2049 14139.4862   55  518 13536.6349 18937.2094  39.9%  9797 3223s
  5626  2049 14116.4548   32  431 13536.6349 18937.2094  39.9%  9795 3232s
  5627  2050 14236.8010   33  419 13536.6349 18937.2094  39.9%  9793 3241s
  5628  2051 15711.0983   16  422 13536.6349 18937.2094  39.9%  9792 3247s
  5629  2051 17991.3369    8  498 13536.6349 18937.2094  39.9%  9790 3276s
  5630  2052 16587.3740   19  501 13536.6349 18937.2094  39.9%  9788 3286s
  5631  2053 14116.1018   13  491 13536.6349 18937.2094  39.9%  9786 3294s
  5632  2053 16849.1717   11  489 13536.6349 18937.2094  39.9%  9785 3314s
  5633  2054 15601.1584   13  380 13536.6349 18937.2094  39.9%  9783 3325s
  5634  2055 18238.8494   16  417 13536.6349 18937.2094  39.9%  9781 3338s
  5635  2055 14197.1780   23  486 13536.6349 18937.2094  39.9%  9779 3351s
  5636  2056 13701.3772   21  544 13536.6349 18937.2094  39.9%  9778 3362s
  5637  2057 15844.0953   22  547 13536.6349 18937.2094  39.9%  9776 3370s
  5638  2057 14979.1654   37  489 13536.6349 18937.2094  39.9%  9774 3385s
  5639  2058 17006.7636   10  489 13536.6349 18937.2094  39.9%  9772 3393s
  5640  2059 15162.5721   21  493 13536.6349 18937.2094  39.9%  9771 3402s
  5641  2059 14455.2449   16  369 13536.6349 18937.2094  39.9%  9769 3409s
  5642  2060 14562.1708   15  367 13536.6349 18937.2094  39.9%  9767 3420s
  5643  2061 16638.4157   18  438 13536.6349 18937.2094  39.9%  9766 3426s
  5644  2061 15069.9838   24  444 13536.6349 18937.2094  39.9%  9764 3438s
  5645  2062 14719.3229   17  440 13536.6349 18937.2094  39.9%  9762 3442s
  5646  2063 14010.7861   58  379 13536.6349 18937.2094  39.9%  9760 3449s
  5647  2063 17131.8683   11  379 13536.6349 18937.2094  39.9%  9759 3462s
  5648  2064 16214.2534   10  379 13536.6349 18937.2094  39.9%  9757 3507s

Cutting planes:
  Gomory: 11
  Implied bound: 14
  Projected implied bound: 183
  MIR: 765
  Mixing: 3
  Flow cover: 1030
  RLT: 15
  Relax-and-lift: 137

Explored 5649 nodes (56170607 simplex iterations) in 3600.06 seconds (9601.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13536.6 13412.1 13312.2 ... 11690.3

Time limit reached
Best objective 1.353663490528e+04, best bound 1.893720938928e+04, gap 39.8960%
  WARNING: Time limit reached. Using best solution found (gap: 39.90%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.24s
  Master Objective (UB) = 13536.63, θ = 155484.50
  Upper Bound (UB) = 13536.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155484.50
  [DEBUG]   ✓ Scenario 0: θ = 155484.50 ≤ Q = 155484.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155484.50 ≤ Q = 155484.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 155484.50 ≤ Q = 155484.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 155484.50 ≤ Q = 155484.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 155484.50 ≤ Q = 155484.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 155484.50 ≤ Q = 155484.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 155484.50 ≤ Q = 155484.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 155484.50 ≤ Q = 155484.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 155484.50 ≤ Q = 155484.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 155484.50 ≤ Q = 155484.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 155484.50 ≤ Q = 155484.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 155484.50 ≤ Q = 155484.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 155484.50 ≤ Q = 155484.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 155484.50 ≤ Q = 155484.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 155484.50 ≤ Q = 155484.50 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3b2c120f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc4d3edf1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.275815e+13
Presolve removed 2563 rows and 1853 columns
Presolve time: 0.00s
Presolved: 530 rows, 536 columns, 1497 nonzeros
Found heuristic solution: objective 6661005.7722
Variable types: 362 continuous, 174 integer (174 binary)
Found heuristic solution: objective 6660295.0344

Root relaxation: objective -1.462754e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146275.37    0  130 6660295.03 -146275.37   102%     -    0s
H    0     0                    -101916.1974 -146275.37  43.5%     -    0s
H    0     0                    -111409.5311 -146275.37  31.3%     -    0s
H    0     0                    -111857.0869 -146101.05  30.6%     -    0s
     0     0 -122710.05    0   59 -111857.09 -122710.05  9.70%     -    0s
H    0     0                    -119445.0818 -122620.96  2.66%     -    0s
H    0     0                    -119717.0618 -122620.96  2.43%     -    0s
H    0     0                    -120655.8740 -122620.96  1.63%     -    0s
H    0     0                    -120927.8540 -122620.96  1.40%     -    0s
     0     0 -122491.96    0   51 -120927.85 -122491.96  1.29%     -    0s
     0     0 -121828.10    0   40 -120927.85 -121828.10  0.74%     -    0s
H    0     0                    -121122.0091 -121771.17  0.54%     -    0s
     0     0 -121771.17    0   40 -121122.01 -121771.17  0.54%     -    0s
     0     0 -121568.25    0   44 -121122.01 -121568.25  0.37%     -    0s
     0     0 -121567.73    0   23 -121122.01 -121567.73  0.37%     -    0s
     0     0 -121536.26    0   21 -121122.01 -121536.26  0.34%     -    0s
     0     0 -121495.37    0   26 -121122.01 -121495.37  0.31%     -    0s
     0     0 -121491.93    0   25 -121122.01 -121491.93  0.31%     -    0s
     0     0 -121484.29    0   22 -121122.01 -121484.29  0.30%     -    0s
     0     0 -121438.57    0   28 -121122.01 -121438.57  0.26%     -    0s
     0     0 -121438.57    0   49 -121122.01 -121438.57  0.26%     -    0s
     0     0 -121328.97    0   20 -121122.01 -121328.97  0.17%     -    0s
     0     0 -121245.97    0   12 -121122.01 -121245.97  0.10%     -    0s
     0     0 -121229.29    0    9 -121122.01 -121229.29  0.09%     -    0s
     0     0 -121227.08    0   15 -121122.01 -121227.08  0.09%     -    0s
H    0     0                    -121161.2721 -121227.08  0.05%     -    0s
H    0     0                    -121179.3141 -121227.08  0.04%     -    0s
     0     0 -121201.27    0   12 -121179.31 -121201.27  0.02%     -    0s
     0     0 -121201.27    0   10 -121179.31 -121201.27  0.02%     -    0s
H    0     0                    -121194.2995 -121201.27  0.01%     -    0s
     0     0     cutoff    0      -121194.30 -121194.30  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 3
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (902 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -121194 -121179 -121161 ... -101916
No other solutions better than -121194

Optimal solution found (tolerance 1.00e-06)
Best objective -1.211942995004e+05, best bound -1.211942995004e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 146495.32
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121194.30
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -121194.30 = 146495.32
  [DEBUG]   Current θ from Master = 155484.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8989.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4547.46
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 1335.3501, Absolute Gap = 1335.3501, Relative Gap = 0.098647
  Not converged yet (gap = 1335.35 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697599 nonzeros
Model fingerprint: 0xbe507df3
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 100192 rows and 40672 columns
Presolve time: 2.50s
Presolved: 145831 rows, 61428 columns, 895289 nonzeros
Variable types: 59169 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.09s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 6.852e+06
 Factor NZ  : 1.540e+07 (roughly 200 MB of memory)
 Factor Ops : 3.473e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70437263e+07  2.42909374e+08  1.04e+05 2.20e+01  7.22e+04     5s
   1  -1.29672546e+07  2.11367460e+08  7.20e+04 6.36e+01  4.93e+04     5s
   2  -5.63190851e+06  1.65652866e+08  3.01e+04 7.33e-01  2.14e+04     5s
   3  -1.09547207e+06  1.24993824e+08  3.26e+03 1.19e+00  2.65e+03     5s
   4  -5.61635299e+05  5.45222595e+07  5.52e+02 2.18e-01  5.39e+02     5s
   5  -4.66743886e+05  3.55259726e+07  2.75e+02 1.10e-01  2.88e+02     5s
   6  -3.75981310e+05  2.62104220e+07  1.02e+02 7.21e-02  1.52e+02     5s
   7  -2.67600118e+05  2.01409251e+07  4.69e+01 5.08e-02  9.79e+01     5s
   8  -1.38318727e+05  1.42997300e+07  1.14e+01 3.37e-02  5.84e+01     6s
   9  -1.20261841e+05  8.47062497e+06  8.31e+00 1.92e-02  3.43e+01     6s
  10  -1.08974139e+05  5.91122192e+06  5.14e+00 1.35e-02  2.36e+01     6s
  11  -8.56514993e+04  2.30532343e+06  1.98e+00 4.90e-03  9.15e+00     6s
  12  -5.15229951e+04  8.27458956e+05  5.99e-01 1.56e-03  3.32e+00     6s
  13  -3.24202669e+04  4.04024360e+05  3.39e-01 8.28e-04  1.65e+00     6s
  14  -8.57679126e+03  2.72858224e+05  1.81e-01 7.21e-04  1.06e+00     6s
  15  -7.36373290e+03  2.02554923e+05  1.73e-01 1.06e-03  7.91e-01     6s
  16   1.27019876e+03  1.39899659e+05  1.24e-01 1.30e-03  5.22e-01     6s
  17   2.94191419e+03  1.19124527e+05  1.16e-01 1.34e-03  4.38e-01     6s
  18   1.10696919e+04  9.30588261e+04  8.37e-02 2.24e-03  3.09e-01     6s
  19   1.46703859e+04  7.87738405e+04  7.10e-02 3.80e-03  2.42e-01     6s
  20   1.75897494e+04  6.76832914e+04  6.13e-02 2.65e-03  1.89e-01     6s
  21   2.02216442e+04  6.12658846e+04  5.34e-02 2.36e-03  1.55e-01     6s
  22   2.41072242e+04  5.74991788e+04  4.13e-02 2.61e-03  1.26e-01     7s
  23   2.74303085e+04  5.39952220e+04  3.14e-02 2.12e-03  1.00e-01     7s
  24   2.97758273e+04  5.10737336e+04  2.52e-02 1.62e-03  8.03e-02     7s
  25   3.12718333e+04  4.86567381e+04  2.14e-02 1.22e-03  6.55e-02     7s
  26   3.24458087e+04  4.70017181e+04  1.85e-02 1.40e-03  5.49e-02     7s
  27   3.46710680e+04  4.54049559e+04  1.32e-02 9.01e-04  4.05e-02     7s
  28   3.59521875e+04  4.44307233e+04  1.03e-02 7.27e-04  3.20e-02     7s
  29   3.64598952e+04  4.29348426e+04  9.15e-03 4.49e-04  2.44e-02     7s
  30   3.72022322e+04  4.21983806e+04  7.56e-03 3.68e-04  1.88e-02     7s
  31   3.76790648e+04  4.19235183e+04  6.53e-03 2.90e-04  1.60e-02     7s
  32   3.82289533e+04  4.16412680e+04  5.36e-03 2.19e-04  1.29e-02     7s
  33   3.87554402e+04  4.13726367e+04  4.23e-03 1.37e-04  9.88e-03     7s
  34   3.90508182e+04  4.12975058e+04  3.61e-03 1.13e-04  8.48e-03     8s
  35   3.95059755e+04  4.12037838e+04  2.63e-03 1.05e-04  6.41e-03     8s
  36   3.96829198e+04  4.11205115e+04  2.24e-03 8.77e-05  5.42e-03     8s
  37   3.99534556e+04  4.10916473e+04  1.69e-03 8.03e-05  4.29e-03     8s
  38   4.00722857e+04  4.09726507e+04  1.45e-03 4.62e-05  3.40e-03     8s
  39   4.03218841e+04  4.09640509e+04  9.44e-04 4.34e-05  2.42e-03     8s
  40   4.04609690e+04  4.08910143e+04  6.68e-04 2.39e-05  1.62e-03     8s
  41   4.06027449e+04  4.08839837e+04  3.78e-04 2.15e-05  1.06e-03     8s
  42   4.06675165e+04  4.08384129e+04  2.58e-04 7.03e-06  6.45e-04     8s
  43   4.07765696e+04  4.08233477e+04  6.34e-05 3.78e-06  1.76e-04     8s
  44   4.07828950e+04  4.08159035e+04  5.18e-05 7.63e-07  1.25e-04     9s
  45   4.08030428e+04  4.08141771e+04  1.57e-05 1.17e-07  4.20e-05     9s
  46   4.08058538e+04  4.08137087e+04  1.14e-05 3.70e-08  2.96e-05     9s
  47   4.08111482e+04  4.08136991e+04  3.05e-06 3.07e-08  9.62e-06     9s
  48   4.08113362e+04  4.08135410e+04  2.80e-06 8.03e-09  8.32e-06     9s
  49   4.08123097e+04  4.08134928e+04  2.55e-06 1.17e-06  4.46e-06     9s
  50   4.08134618e+04  4.08134635e+04  4.08e-08 5.58e-08  6.44e-09     9s
  51   4.08134634e+04  4.08134634e+04  6.31e-08 1.98e-10  9.75e-11     9s

Barrier solved model in 51 iterations and 9.14 seconds (14.86 work units)
Optimal objective 4.08134634e+04


Root crossover log...

  126507 DPushes remaining with DInf 0.0000000e+00                 9s
   41591 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    3142 PPushes remaining with PInf 1.8499099e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.9869227e-02     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56287    4.0813463e+04   0.000000e+00   6.986923e-02     12s
   56288    4.0813463e+04   0.000000e+00   0.000000e+00     12s
   56288    4.0813463e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.34s

Solved with barrier

Root relaxation: objective 4.081346e+04, 56288 iterations, 9.60 seconds (18.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40813.4634    0  242 -233197.24 40813.4634   118%     -   13s
H    0     0                    -190910.3612 40813.4634   121%     -   13s
H    0     0                    -162669.6073 40813.4634   125%     -   13s
H    0     0                    -56180.96607 40813.4634   173%     -   14s
H    0     0                    -24679.21617 40813.4634   265%     -   14s
H    0     0                    -4238.822047 40813.4634  1063%     -   14s
H    0     0                    7717.1643926 40813.4634   429%     -   14s
H    0     0                    8289.6860860 40813.4634   392%     -   14s
H    0     0                    8412.7605821 40813.4634   385%     -   14s
H    0     0                    9211.8989753 40813.4634   343%     -   14s
H    0     0                    9396.2638080 40813.4634   334%     -   14s
H    0     0                    9436.5292895 40813.4634   333%     -   15s
H    0     0                    9469.8361877 40813.4634   331%     -   15s
     0     0 33403.2529    0  192 9469.83619 33403.2529   253%     -   61s
H    0     0                    10177.737693 33403.0084   228%     -   62s
H    0     0                    10390.053393 33403.0084   221%     -   62s
H    0     0                    10411.720706 33403.0084   221%     -   62s
H    0     0                    10478.318596 33403.0084   219%     -   62s
     0     0 32979.5085    0  207 10478.3186 32979.5085   215%     -   73s
     0     0 32972.7547    0  205 10478.3186 32972.7547   215%     -   76s
     0     0 32971.6019    0  206 10478.3186 32971.6019   215%     -   76s
     0     0 32968.0328    0  206 10478.3186 32968.0328   215%     -   77s
     0     0 32968.0328    0  206 10478.3186 32968.0328   215%     -   77s
     0     0 30281.6536    0  328 10478.3186 30281.6536   189%     -  111s
H    0     0                    10624.891759 30281.6453   185%     -  112s
H    0     0                    10722.558152 30281.6453   182%     -  112s
H    0     0                    10754.340919 30281.6453   182%     -  112s
     0     0 29813.4154    0  351 10754.3409 29813.4154   177%     -  142s
     0     0 29383.8219    0  340 10754.3409 29383.8219   173%     -  163s
     0     0 29135.3827    0  348 10754.3409 29135.3827   171%     -  175s
     0     0 29087.9280    0  350 10754.3409 29087.9280   170%     -  184s
     0     0 28991.3185    0  348 10754.3409 28991.3185   170%     -  192s
     0     0 28955.8317    0  351 10754.3409 28955.8317   169%     -  198s
     0     0 28944.2269    0  356 10754.3409 28944.2269   169%     -  202s
     0     0 28942.7592    0  356 10754.3409 28942.7592   169%     -  205s
     0     0 28940.3753    0  356 10754.3409 28940.3753   169%     -  206s
     0     0 28931.3774    0  357 10754.3409 28931.3774   169%     -  212s
     0     0 28931.1887    0  354 10754.3409 28931.1887   169%     -  214s
     0     0 26306.0753    0  483 10754.3409 26306.0753   145%     -  285s
H    0     0                    10962.494140 26305.8315   140%     -  286s
H    0     0                    10990.660942 26305.8315   139%     -  286s
H    0     0                    11122.220674 26305.8315   137%     -  286s
     0     0 25704.3917    0  394 11122.2207 25704.3917   131%     -  310s
     0     0 25620.0873    0  392 11122.2207 25620.0873   130%     -  323s
     0     0 25595.2884    0  450 11122.2207 25595.2884   130%     -  329s
     0     0 25568.7947    0  404 11122.2207 25568.7947   130%     -  337s
     0     0 25485.5232    0  450 11122.2207 25485.5232   129%     -  348s
     0     0 25452.6428    0  441 11122.2207 25452.6428   129%     -  355s
     0     0 25421.3525    0  443 11122.2207 25421.3525   129%     -  361s
     0     0 25392.2299    0  448 11122.2207 25392.2299   128%     -  367s
     0     0 25343.9395    0  452 11122.2207 25343.9395   128%     -  375s
     0     0 25329.2105    0  450 11122.2207 25329.2105   128%     -  381s
     0     0 25310.0324    0  453 11122.2207 25310.0324   128%     -  386s
     0     0 25306.9918    0  413 11122.2207 25306.9918   128%     -  389s
     0     0 25306.0333    0  452 11122.2207 25306.0333   128%     -  391s
     0     0 24224.5625    0  359 11122.2207 24224.5625   118%     -  438s
H    0     0                    11251.960291 24224.2359   115%     -  439s
H    0     0                    11339.603784 24224.2359   114%     -  439s
H    0     0                    11514.757178 24224.2359   110%     -  439s
H    0     0                    11588.433590 24224.2359   109%     -  440s
     0     0 23982.2683    0  481 11588.4336 23982.2683   107%     -  464s
     0     0 23844.8228    0  353 11588.4336 23844.8228   106%     -  476s
     0     0 23795.7890    0  479 11588.4336 23795.7890   105%     -  486s
     0     0 23752.7209    0  528 11588.4336 23752.7209   105%     -  496s
     0     0 23736.2359    0  530 11588.4336 23736.2359   105%     -  501s
     0     0 23702.1369    0  479 11588.4336 23702.1369   105%     -  508s
     0     0 23674.1447    0  520 11588.4336 23674.1447   104%     -  514s
     0     0 23664.9043    0  484 11588.4336 23664.9043   104%     -  518s
     0     0 23661.7153    0  475 11588.4336 23661.7153   104%     -  520s
     0     0 23660.0940    0  480 11588.4336 23660.0940   104%     -  521s
     0     0 23514.8965    0  485 11588.4336 23514.8965   103%     -  538s
     0     0 23493.0409    0  419 11588.4336 23493.0409   103%     -  547s
     0     0 23484.9191    0  419 11588.4336 23484.9191   103%     -  551s
     0     0 23483.4674    0  412 11588.4336 23483.4674   103%     -  555s
     0     0 23398.9347    0  500 11588.4336 23398.9347   102%     -  570s
H    0     0                    12027.679441 23398.8063  94.5%     -  572s
H    0     0                    12424.990819 23398.8063  88.3%     -  573s
     0     0 23381.0540    0  492 12424.9908 23381.0540  88.2%     -  579s
     0     0 23379.3830    0  419 12424.9908 23379.3830  88.2%     -  581s
     0     0 23350.7182    0  444 12424.9908 23350.7182  87.9%     -  590s
H    0     0                    12501.536676 23350.6901  86.8%     -  591s
     0     0 23320.5010    0  504 12501.5367 23320.5010  86.5%     -  597s
     0     0 23316.0771    0  512 12501.5367 23316.0771  86.5%     -  600s
     0     0 23312.0100    0  321 12501.5367 23312.0100  86.5%     -  602s
     0     0 23312.0100    0  321 12501.5367 23312.0100  86.5%     -  602s
     0     0 23310.2963    0  317 12501.5367 23310.2963  86.5%     -  605s
     0     0 23250.7141    0  429 12501.5367 23250.7141  86.0%     -  613s
H    0     0                    12745.240973 23250.5134  82.4%     -  614s
     0     0 23232.2200    0  436 12745.2410 23232.2200  82.3%     -  620s
     0     0 23226.1280    0  440 12745.2410 23226.1280  82.2%     -  624s
     0     0 23218.8406    0  441 12745.2410 23218.8406  82.2%     -  627s
     0     0 23214.9955    0  426 12745.2410 23214.9955  82.1%     -  629s
     0     0 23212.2008    0  428 12745.2410 23212.2008  82.1%     -  632s
     0     0 23211.0130    0  441 12745.2410 23211.0130  82.1%     -  633s
     0     0 23172.8702    0  370 12745.2410 23172.8702  81.8%     -  642s
     0     0 23161.8340    0  372 12745.2410 23161.8340  81.7%     -  647s
     0     0 23159.9336    0  376 12745.2410 23159.9336  81.7%     -  649s
     0     0 23154.4819    0  418 12745.2410 23154.4819  81.7%     -  654s
H    0     0                    12801.644726 23154.4597  80.9%     -  655s
     0     0 23152.3576    0  488 12801.6447 23152.3576  80.9%     -  657s
     0     0 23149.9044    0  479 12801.6447 23149.9044  80.8%     -  663s
     0     0 23148.9773    0  361 12801.6447 23148.9773  80.8%     -  665s
     0     0 23147.1903    0  366 12801.6447 23147.1903  80.8%     -  669s
     0     0 23147.0494    0  366 12801.6447 23147.0494  80.8%     -  672s
H    0     0                    12897.253740 23147.0494  79.5%     -  741s
H    0     0                    12941.497645 23147.0494  78.9%     -  741s
     0     2 23147.0494    0  366 12941.4976 23147.0494  78.9%     -  743s
     1     3 22866.9092    1  360 12941.4976 23147.0494  78.9% 13445  756s
     2     4 22898.7235    1  463 12941.4976 22898.7235  76.9% 11911  766s
     3     6 21616.3171    2  289 12941.4976 22898.5035  76.9% 11267  780s
     5    12 21984.2336    3  320 12941.4976 22898.5035  76.9% 10299  792s
    11    23 21819.0021    4  381 12941.4976 22533.6333  74.1%  9540  809s
    22    34 21632.2929    4  552 12941.4976 22478.5378  73.7% 14892  863s
H   33    65                    13209.318960 22478.5378  70.2% 15229  977s
    64    97 21381.7643    6  480 13209.3190 22478.5378  70.2% 20511 1048s
    96   129 21376.9571    7  482 13209.3190 22478.5378  70.2% 18563 1076s
   128   163 21043.8866    8  362 13209.3190 22478.5378  70.2% 14953 1110s
   162   237 21031.3640    9  463 13209.3190 22478.5378  70.2% 13189 1157s
   236   320 20952.9010   10  364 13209.3190 22478.5378  70.2% 11425 1196s
   319   351 20670.0017   13  468 13209.3190 22478.5378  70.2% 10132 1219s
   350   384 20367.2174   14  405 13209.3190 22478.5378  70.2%  9982 1244s
   383   428 20284.1277   15  477 13209.3190 22478.5378  70.2%  9755 1270s
   429   486 16275.3677   22  177 13209.3190 22478.5378  70.2%  9461 1295s
   497   551 16628.7512   16  196 13209.3190 22478.5378  70.2%  9166 1320s
   580   619 16284.0267   17  203 13209.3190 22478.5378  70.2%  8805 1346s
   664   688 16115.4350   18  210 13209.3190 22478.5378  70.2%  8467 1367s
   746   754 15674.4488   19  191 13209.3190 22478.5378  70.2%  8081 1384s
   841   815 15631.2367   20  193 13209.3190 22478.5378  70.2%  7688 1402s
   934   835 infeasible   21      13209.3190 22478.5378  70.2%  7420 1425s
  1018   867 15211.8177   22  184 13209.3190 22478.5378  70.2%  7391 1444s
  1108   901 15086.0901   23  168 13209.3190 22478.5378  70.2%  7335 1463s
  1174   962 14844.3717   25  172 13209.3190 22478.5378  70.2%  7341 1483s
  1266  1052 14015.0435   31  167 13209.3190 22478.5378  70.2%  7408 1502s
  1378  1113 infeasible   33      13209.3190 22364.4689  69.3%  7364 1521s
  1481  1177 22282.2776    6  376 13209.3190 22364.2471  69.3%  7326 1544s
  1586  1234 21968.3788    9  272 13209.3190 22364.2471  69.3%  7330 1568s
  1703  1313 21950.8976   10  243 13209.3190 22364.2471  69.3%  7332 1593s
  1840  1370 21107.5448    8  237 13209.3190 22364.2471  69.3%  7256 1624s
  1937  1450 17507.8815   10  390 13209.3190 22364.2471  69.3%  7338 1655s
  2041  1562 21002.8419   11  205 13209.3190 22364.2471  69.3%  7420 1683s
  2185  1603 20048.7325   12  215 13209.3190 22364.2471  69.3%  7430 1710s
  2305  1662 18449.4703   14  153 13209.3190 22364.2471  69.3%  7460 1746s
  2408  1729 16846.8758   16  116 13209.3190 22364.2471  69.3%  7601 1779s
  2524  1822 16362.2872   17   82 13209.3190 22364.2471  69.3%  7685 1811s
  2674  1908 15479.5231   26   68 13209.3190 22364.2471  69.3%  7705 1846s
  2825  1967     cutoff   29      13209.3190 22364.2471  69.3%  7759 1880s
  2972  2031 13503.0829   40   31 13209.3190 22269.7150  68.6%  7824 1919s
  3142  2101 15412.1992   18  261 13209.3190 22005.5777  66.6%  7858 1960s
  3292  2157 14509.8770   19  295 13209.3190 22005.5777  66.6%  7924 2000s
  3396  2197 infeasible   20      13209.3190 21756.7156  64.7%  8145 2043s
  3534  2292 19979.7645   11  233 13209.3190 21756.6981  64.7%  8299 2087s
  3709  2373 15887.8545   14  117 13209.3190 21756.6981  64.7%  8346 2130s
  3951  2419 19062.2352   10  219 13209.3190 21756.6981  64.7%  8263 2177s
  4126  2503 14801.7113   13  174 13209.3190 21756.6981  64.7%  8322 2228s
  4282  2535 infeasible   16      13209.3190 21374.5854  61.8%  8420 2281s
  4444  2577 14282.6617   17   79 13209.3190 21374.5854  61.8%  8528 2330s
  4593  2624 14319.1392   30  346 13209.3190 21310.6869  61.3%  8549 2384s
  4691  2673 infeasible   24      13209.3190 21171.7051  60.3%  8684 2435s
  4821  2734 infeasible   13      13209.3190 21171.7051  60.3%  8817 2490s
  4987  2807 15019.0928   16  422 13209.3190 21171.7051  60.3%  8926 2548s
  5178  2808 18142.6130   10  366 13209.3190 21171.7051  60.3%  8993 2783s
  5180  2809 20673.9007   16  164 13209.3190 21171.7051  60.3%  8990 2801s
  5181  2810 17618.4316   13  254 13209.3190 21171.7051  60.3%  8988 2901s
  5182  2811 14683.9920   22  355 13209.3190 21171.7051  60.3%  8986 2976s
  5183  2811 14660.9784   29  426 13209.3190 21171.7051  60.3%  8985 3036s
  5184  2812 19907.5665   19  375 13209.3190 21171.7051  60.3%  8983 3095s
  5185  2813 15596.3291   19  411 13209.3190 21171.7051  60.3%  8981 3125s
  5186  2813 16749.2915   34  413 13209.3190 21171.7051  60.3%  8979 3143s
  5187  2814 14569.8837   30  434 13209.3190 21171.7051  60.3%  8978 3156s
  5188  2815 14753.3561   16  524 13209.3190 21171.7051  60.3%  8976 3165s
  5189  2815 18390.1732   11  409 13209.3190 21171.7051  60.3%  8974 3175s
  5190  2816 14346.3456   41  467 13209.3190 21171.7051  60.3%  8972 3184s
  5191  2817 20804.1580   11  428 13209.3190 21171.7051  60.3%  8971 3192s
  5192  2817 14510.0975   23  472 13209.3190 21171.7051  60.3%  8969 3214s
  5193  2818 17273.1312   10  431 13209.3190 21171.7051  60.3%  8967 3226s
  5194  2819 13878.0872   46  444 13209.3190 21171.7051  60.3%  8965 3233s
  5195  2819 17959.4281   30  360 13209.3190 21171.7051  60.3%  8964 3250s
  5196  2820 19975.5708   12  345 13209.3190 21171.7051  60.3%  8962 3261s
  5197  2821 20214.7685   20  357 13209.3190 21171.7051  60.3%  8960 3269s
  5198  2821 15466.7497   25  347 13209.3190 21171.7051  60.3%  8959 3274s
  5199  2822 16289.5554   34  497 13209.3190 21171.7051  60.3%  8957 3280s
  5200  2823 15671.5951   29  492 13209.3190 21171.7051  60.3%  8955 3286s
  5201  2823 15081.9207   30  354 13209.3190 21171.7051  60.3%  8953 3303s
  5202  2824 14168.2530   25  358 13209.3190 21171.7051  60.3%  8952 3310s
  5203  2825 13289.1632   50  416 13209.3190 21171.7051  60.3%  8950 3325s
  5204  2825 15768.1559   22  360 13209.3190 21171.7051  60.3%  8948 3337s
  5205  2826 14165.0344   30  477 13209.3190 21171.7051  60.3%  8947 3363s
  5206  2827 15416.1617   19  479 13209.3190 21171.7051  60.3%  8945 3374s
  5207  2827 13623.1956   26  485 13209.3190 21171.7051  60.3%  8943 3389s
  5208  2828 18361.8798    9  430 13209.3190 21171.7051  60.3%  8941 3395s
  5209  2829 17222.1492   10  423 13209.3190 21171.7051  60.3%  8940 3409s
  5210  2829 13732.6276   39  427 13209.3190 21171.7051  60.3%  8938 3415s
  5211  2830 14101.5255   18  430 13209.3190 21171.7051  60.3%  8936 3423s
  5212  2831 16336.1845    9  427 13209.3190 21171.7051  60.3%  8935 3427s
  5213  2831 18794.0143   16  481 13209.3190 21171.7051  60.3%  8933 3436s
  5214  2832 14185.8955   26  481 13209.3190 21171.7051  60.3%  8931 3458s
  5215  2833 13449.9843   23  481 13209.3190 21171.7051  60.3%  8929 3511s
  5216  2835 21171.7051   14  405 13209.3190 21171.7051  60.3%  9009 3600s

Cutting planes:
  Gomory: 13
  Implied bound: 6
  Projected implied bound: 183
  MIR: 793
  Flow cover: 970
  RLT: 11
  Relax-and-lift: 151

Explored 5217 nodes (47641669 simplex iterations) in 3600.12 seconds (9131.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13209.3 12941.5 12897.3 ... 11514.8

Time limit reached
Best objective 1.320931896004e+04, best bound 2.117170510241e+04, gap 60.2786%
  WARNING: Time limit reached. Using best solution found (gap: 60.28%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 13209.32, θ = 157333.62
  Upper Bound (UB) = 13209.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157333.62
  [DEBUG]   ✓ Scenario 0: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157333.62 ≤ Q = 157333.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157333.62 ≤ Q = 157333.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157333.62 ≤ Q = 157333.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157333.62 ≤ Q = 157333.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 157333.62 ≤ Q = 157333.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 157333.62 ≤ Q = 157333.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 157333.62 ≤ Q = 157333.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6238ad64
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6238ad64
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.280572e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.01s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6861806.4302
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.451389e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145138.91    0  134 6861806.43 -145138.91   102%     -    0s
H    0     0                    -104574.5147 -145138.91  38.8%     -    0s
H    0     0                    -106866.4701 -145138.91  35.8%     -    0s
H    0     0                    -114772.6471 -123836.10  7.90%     -    0s
     0     0 -123836.10    0   63 -114772.65 -123836.10  7.90%     -    0s
H    0     0                    -122229.9967 -123833.03  1.31%     -    0s
H    0     0                    -122548.2813 -123833.03  1.05%     -    0s
H    0     0                    -122715.4399 -123833.03  0.91%     -    0s
H    0     0                    -123033.7245 -123833.03  0.65%     -    0s
     0     0 -123815.21    0   56 -123033.72 -123815.21  0.64%     -    0s
     0     0 -123811.27    0   55 -123033.72 -123811.27  0.63%     -    0s
     0     0 -123333.04    0   13 -123033.72 -123333.04  0.24%     -    0s
H    0     0                    -123097.6033 -123307.42  0.17%     -    0s
     0     0 -123227.57    0   17 -123097.60 -123227.57  0.11%     -    0s
     0     0 -123223.63    0   15 -123097.60 -123223.63  0.10%     -    0s
     0     0 -123222.40    0    9 -123097.60 -123222.40  0.10%     -    0s
     0     0 -123193.46    0    6 -123097.60 -123193.46  0.08%     -    0s
     0     0 -123193.46    0   12 -123097.60 -123193.46  0.08%     -    0s
H    0     0                    -123125.2196 -123193.46  0.06%     -    0s
     0     0 -123162.36    0    4 -123125.22 -123162.36  0.03%     -    0s
H    0     0                    -123130.0781 -123155.00  0.02%     -    0s
H    0     0                    -123140.7578 -123155.00  0.01%     -    0s
     0     0 -123155.00    0    2 -123140.76 -123155.00  0.01%     -    0s
H    0     0                    -123143.3497 -123155.00  0.01%     -    0s
*    0     0               0    -123144.3932 -123144.39  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 5
  Flow cover: 6
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (611 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123144 -123143 -123141 ... -114773
No other solutions better than -123144

Optimal solution found (tolerance 1.00e-06)
Best objective -1.231443931585e+05, best bound -1.231443931585e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 144545.23
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123144.39
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -123144.39 = 144545.23
  [DEBUG]   Current θ from Master = 157333.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12788.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 420.93
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 1008.0342, Absolute Gap = 1008.0342, Relative Gap = 0.076312
  Not converged yet (gap = 1008.03 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740854 nonzeros
Model fingerprint: 0x5eda343e
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106454 rows and 43214 columns
Presolve time: 2.99s
Presolved: 154859 rows, 65126 columns, 950707 nonzeros
Variable types: 62867 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.42s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 7.642e+06
 Factor NZ  : 1.757e+07 (roughly 230 MB of memory)
 Factor Ops : 4.349e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70818221e+07  2.55832242e+08  1.05e+05 2.10e+01  7.21e+04     5s
   1  -1.30399546e+07  2.22743797e+08  7.27e+04 6.08e+01  4.93e+04     5s
   2  -4.55723608e+06  1.75328086e+08  2.45e+04 7.18e-01  1.74e+04     5s
   3  -8.65034810e+05  1.27413997e+08  1.77e+03 1.56e+00  1.62e+03     5s
   4  -5.42910404e+05  4.43672078e+07  4.28e+02 3.19e-01  4.07e+02     5s
   5  -4.14050391e+05  3.34408152e+07  1.35e+02 2.15e-01  1.94e+02     5s
   6  -3.29577196e+05  2.34042875e+07  6.52e+01 1.39e-01  1.15e+02     6s
   7  -1.84226155e+05  1.87722623e+07  1.90e+01 1.07e-01  7.51e+01     6s
   8  -1.26852123e+05  1.08961448e+07  9.13e+00 5.89e-02  4.16e+01     6s
   9  -1.12868554e+05  8.16684610e+06  5.74e+00 4.33e-02  3.06e+01     6s
  10  -1.03435989e+05  4.14013745e+06  3.98e+00 2.15e-02  1.55e+01     6s
  11  -6.95559816e+04  1.39059870e+06  1.10e+00 7.69e-03  5.23e+00     6s
  12  -4.26595795e+04  4.61714995e+05  5.05e-01 2.43e-03  1.80e+00     6s
  13  -1.32487899e+04  2.41371286e+05  2.07e-01 1.24e-03  9.04e-01     6s
  14  -2.65268405e+03  1.68546806e+05  1.46e-01 1.32e-03  6.08e-01     6s
  15   3.81139788e+03  1.37002920e+05  1.14e-01 1.16e-03  4.73e-01     6s
  16   1.12202286e+04  1.07627874e+05  8.07e-02 1.71e-03  3.42e-01     6s
  17   1.31000488e+04  8.77705960e+04  7.43e-02 1.57e-03  2.65e-01     6s
  18   1.83367497e+04  7.62102092e+04  5.66e-02 1.47e-03  2.05e-01     6s
  19   2.11518127e+04  6.58710910e+04  4.79e-02 1.84e-03  1.59e-01     6s
  20   2.37546155e+04  6.25662080e+04  4.03e-02 2.01e-03  1.38e-01     7s
  21   2.53002731e+04  5.40255655e+04  3.59e-02 2.97e-03  1.02e-01     7s
  22   2.72626818e+04  5.09791713e+04  3.09e-02 2.26e-03  8.43e-02     7s
  23   3.15389797e+04  4.89059217e+04  2.03e-02 1.85e-03  6.17e-02     7s
  24   3.26352893e+04  4.70208710e+04  1.78e-02 1.42e-03  5.11e-02     7s
  25   3.42963825e+04  4.63378902e+04  1.40e-02 1.27e-03  4.28e-02     7s
  26   3.56501989e+04  4.51315370e+04  1.10e-02 9.84e-04  3.37e-02     7s
  27   3.66829249e+04  4.40057153e+04  8.76e-03 7.12e-04  2.60e-02     7s
  28   3.69660786e+04  4.31172692e+04  8.14e-03 5.08e-04  2.19e-02     7s
  29   3.77493495e+04  4.24534424e+04  6.48e-03 3.47e-04  1.67e-02     7s
  30   3.82545777e+04  4.22207206e+04  5.38e-03 2.92e-04  1.41e-02     7s
  31   3.87133447e+04  4.19469599e+04  4.42e-03 2.25e-04  1.15e-02     8s
  32   3.91418403e+04  4.18213603e+04  3.54e-03 1.96e-04  9.52e-03     8s
  33   3.92937056e+04  4.16358588e+04  3.22e-03 1.55e-04  8.32e-03     8s
  34   3.95788770e+04  4.14979910e+04  2.64e-03 1.22e-04  6.82e-03     8s
  35   3.99749045e+04  4.13066901e+04  1.82e-03 1.53e-04  4.73e-03     8s
  36   4.00959025e+04  4.12518786e+04  1.59e-03 1.29e-04  4.11e-03     8s
  37   4.03960188e+04  4.11495033e+04  1.01e-03 8.62e-05  2.68e-03     8s
  38   4.05431865e+04  4.10881761e+04  7.26e-04 5.05e-05  1.94e-03     8s
  39   4.06707696e+04  4.10331417e+04  4.93e-04 3.42e-05  1.29e-03     8s
  40   4.07894973e+04  4.09918217e+04  2.68e-04 1.98e-05  7.19e-04     8s
  41   4.08898249e+04  4.09784201e+04  8.70e-05 1.42e-05  3.15e-04     8s
  42   4.09068311e+04  4.09532033e+04  5.67e-05 4.31e-06  1.65e-04     9s
  43   4.09160526e+04  4.09502055e+04  4.16e-05 3.16e-06  1.21e-04     9s
  44   4.09281090e+04  4.09422809e+04  2.14e-05 3.46e-07  5.04e-05     9s
  45   4.09326671e+04  4.09419177e+04  1.41e-05 1.66e-07  3.29e-05     9s
  46   4.09402774e+04  4.09417537e+04  3.33e-06 1.07e-06  5.25e-06     9s
  47   4.09408694e+04  4.09416077e+04  1.82e-06 1.23e-07  2.63e-06     9s
  48   4.09415615e+04  4.09415859e+04  1.84e-07 3.09e-08  8.69e-08     9s
  49   4.09415831e+04  4.09415858e+04  2.36e-07 4.86e-07  9.56e-09     9s
  50   4.09415847e+04  4.09415858e+04  3.04e-07 2.43e-07  3.83e-09     9s
  51   4.09415857e+04  4.09415858e+04  2.63e-08 7.21e-09  1.59e-10     9s

Barrier solved model in 51 iterations and 9.40 seconds (15.35 work units)
Optimal objective 4.09415857e+04


Root crossover log...

  134337 DPushes remaining with DInf 0.0000000e+00                 9s
   57360 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    4230 PPushes remaining with PInf 2.4677824e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.6327751e-01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62604    4.0941586e+04   0.000000e+00   4.632775e-01     14s
   62615    4.0941586e+04   0.000000e+00   0.000000e+00     14s
   62615    4.0941586e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 4.32s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.094159e+04, 62615 iterations, 14.73 seconds (23.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40941.5858    0  248 -233197.24 40941.5858   118%     -   19s
H    0     0                    -231836.7361 40941.5858   118%     -   19s
H    0     0                    -189287.3894 40941.5858   122%     -   20s
H    0     0                    -162524.8929 40941.5858   125%     -   20s
H    0     0                    -143033.5304 40941.5858   129%     -   20s
H    0     0                    -142461.7649 40941.5858   129%     -   20s
H    0     0                    -142250.8740 40941.5858   129%     -   20s
H    0     0                    -142247.3221 40941.5858   129%     -   21s
H    0     0                    -56180.96607 40941.5858   173%     -   21s
H    0     0                    -24529.64257 40941.5858   267%     -   21s
H    0     0                    -17336.93621 40941.5858   336%     -   21s
H    0     0                    4898.0033711 40941.5858   736%     -   21s
H    0     0                    5929.7104630 40941.5858   590%     -   21s
H    0     0                    6524.8523547 40941.5858   527%     -   22s
H    0     0                    8634.4565244 40941.5858   374%     -   22s
H    0     0                    8686.8871794 40941.5858   371%     -   22s
H    0     0                    8726.2112832 40941.5858   369%     -   22s
H    0     0                    8766.4155526 40941.5858   367%     -   22s
H    0     0                    8782.9892987 40941.5858   366%     -   22s
H    0     0                    8814.3873003 40941.5858   364%     -   22s
H    0     0                    8883.3297085 40941.5858   361%     -   22s
H    0     0                    8891.2811740 40941.5858   360%     -   22s
H    0     0                    8892.1117008 40941.5858   360%     -   22s
     0     0 33588.6968    0  203 8892.11170 33588.6968   278%     -   84s
H    0     0                    10545.089515 33588.6686   219%     -   85s
     0     0 33154.0808    0  210 10545.0895 33154.0808   214%     -   95s
     0     0 33132.6559    0  221 10545.0895 33132.6559   214%     -  100s
     0     0 33121.2260    0  217 10545.0895 33121.2260   214%     -  102s
     0     0 33045.0549    0  207 10545.0895 33045.0549   213%     -  106s
     0     0 32973.7273    0  263 10545.0895 32973.7273   213%     -  111s
     0     0 32966.6986    0  263 10545.0895 32966.6986   213%     -  113s
     0     0 32966.6094    0  267 10545.0895 32966.6094   213%     -  114s
     0     0 30171.3888    0  308 10545.0895 30171.3888   186%     -  156s
H    0     0                    10555.705218 30171.2914   186%     -  157s
H    0     0                    10620.967644 30171.2914   184%     -  157s
H    0     0                    10639.601206 30171.2914   184%     -  157s
H    0     0                    10701.530809 30171.2914   182%     -  157s
     0     0 29273.9995    0  356 10701.5308 29273.9995   174%     -  187s
     0     0 29105.7359    0  362 10701.5308 29105.7359   172%     -  203s
     0     0 28996.4791    0  365 10701.5308 28996.4791   171%     -  216s
     0     0 28903.4478    0  357 10701.5308 28903.4478   170%     -  224s
     0     0 28807.7339    0  349 10701.5308 28807.7339   169%     -  234s
     0     0 28753.0022    0  374 10701.5308 28753.0022   169%     -  238s
     0     0 28747.4152    0  379 10701.5308 28747.4152   169%     -  241s
     0     0 28701.3261    0  374 10701.5308 28701.3261   168%     -  247s
     0     0 28684.9081    0  376 10701.5308 28684.9081   168%     -  253s
     0     0 28681.8390    0  382 10701.5308 28681.8390   168%     -  256s
     0     0 28681.3906    0  387 10701.5308 28681.3906   168%     -  258s
     0     0 26139.2375    0  367 10701.5308 26139.2375   144%     -  319s
     0     0 25618.8599    0  436 10701.5308 25618.8599   139%     -  354s
     0     0 25248.4728    0  445 10701.5308 25248.4728   136%     -  386s
     0     0 25191.4006    0  446 10701.5308 25191.4006   135%     -  397s
     0     0 25135.6651    0  438 10701.5308 25135.6651   135%     -  406s
     0     0 25092.8801    0  437 10701.5308 25092.8801   134%     -  414s
     0     0 25052.7870    0  441 10701.5308 25052.7870   134%     -  422s
     0     0 25031.0404    0  445 10701.5308 25031.0404   134%     -  428s
     0     0 25026.0428    0  449 10701.5308 25026.0428   134%     -  433s
     0     0 25001.0343    0  444 10701.5308 25001.0343   134%     -  439s
     0     0 24974.4667    0  446 10701.5308 24974.4667   133%     -  446s
     0     0 24969.7328    0  447 10701.5308 24969.7328   133%     -  450s
     0     0 24966.6721    0  442 10701.5308 24966.6721   133%     -  453s
     0     0 24961.0369    0  447 10701.5308 24961.0369   133%     -  456s
     0     0 24943.6641    0  441 10701.5308 24943.6641   133%     -  459s
     0     0 24939.4432    0  443 10701.5308 24939.4432   133%     -  462s
     0     0 24937.1033    0  439 10701.5308 24937.1033   133%     -  464s
     0     0 24937.0860    0  437 10701.5308 24937.0860   133%     -  465s
     0     0 24127.0365    0  417 10701.5308 24127.0365   125%     -  514s
H    0     0                    10891.070457 24126.5217   122%     -  514s
     0     0 23961.1313    0  441 10891.0705 23961.1313   120%     -  529s
     0     0 23877.9702    0  429 10891.0705 23877.9702   119%     -  542s
     0     0 23834.2465    0  445 10891.0705 23834.2465   119%     -  553s
     0     0 23802.8989    0  450 10891.0705 23802.8989   119%     -  561s
     0     0 23789.0599    0  452 10891.0705 23789.0599   118%     -  567s
     0     0 23759.1615    0  451 10891.0705 23759.1615   118%     -  572s
     0     0 23754.1867    0  459 10891.0705 23754.1867   118%     -  576s
     0     0 23747.2940    0  472 10891.0705 23747.2940   118%     -  578s
     0     0 23732.7792    0  468 10891.0705 23732.7792   118%     -  582s
     0     0 23722.4740    0  453 10891.0705 23722.4740   118%     -  585s
     0     0 23717.6566    0  461 10891.0705 23717.6566   118%     -  588s
     0     0 23714.3651    0  504 10891.0705 23714.3651   118%     -  591s
     0     0 23710.7390    0  458 10891.0705 23710.7390   118%     -  592s
     0     0 23704.3367    0  473 10891.0705 23704.3367   118%     -  597s
     0     0 23695.8950    0  457 10891.0705 23695.8950   118%     -  600s
     0     0 23695.4677    0  458 10891.0705 23695.4677   118%     -  601s
     0     0 23517.5487    0  503 10891.0705 23517.5487   116%     -  619s
H    0     0                    10994.878159 23517.3034   114%     -  620s
     0     0 23490.8955    0  492 10994.8782 23490.8955   114%     -  626s
     0     0 23479.3337    0  498 10994.8782 23479.3337   114%     -  633s
     0     0 23464.5046    0  499 10994.8782 23464.5046   113%     -  638s
     0     0 23460.9496    0  512 10994.8782 23460.9496   113%     -  640s
     0     0 23435.6952    0  496 10994.8782 23435.6952   113%     -  646s
     0     0 23432.6843    0  499 10994.8782 23432.6843   113%     -  648s
     0     0 23427.3736    0  499 10994.8782 23427.3736   113%     -  651s
     0     0 23426.5788    0  502 10994.8782 23426.5788   113%     -  652s
     0     0 23351.7748    0  507 10994.8782 23351.7748   112%     -  661s
H    0     0                    11273.092896 23350.2380   107%     -  662s
H    0     0                    11313.701378 23350.2380   106%     -  662s
     0     0 23343.5534    0  451 11313.7014 23343.5534   106%     -  665s
     0     0 23341.1456    0  507 11313.7014 23341.1456   106%     -  667s
     0     0 23325.7135    0  445 11313.7014 23325.7135   106%     -  674s
     0     0 23317.7140    0  452 11313.7014 23317.7140   106%     -  678s
     0     0 23311.7939    0  386 11313.7014 23311.7939   106%     -  680s
     0     0 23309.1305    0  385 11313.7014 23309.1305   106%     -  681s
     0     0 23304.8018    0  449 11313.7014 23304.8018   106%     -  684s
     0     0 23298.8891    0  377 11313.7014 23298.8891   106%     -  685s
     0     0 23297.8400    0  382 11313.7014 23297.8400   106%     -  687s
     0     0 23261.2544    0  442 11313.7014 23261.2544   106%     -  695s
     0     0 23253.2183    0  383 11313.7014 23253.2183   106%     -  701s
     0     0 23251.9485    0  395 11313.7014 23251.9485   106%     -  703s
     0     0 23238.6457    0  396 11313.7014 23238.6457   105%     -  709s
     0     0 23234.0279    0  435 11313.7014 23234.0279   105%     -  712s
     0     0 23233.6045    0  444 11313.7014 23233.6045   105%     -  713s
     0     0 23228.3990    0  427 11313.7014 23228.3990   105%     -  717s
     0     0 23226.2853    0  514 11313.7014 23226.2853   105%     -  723s
     0     0 23222.6886    0  439 11313.7014 23222.6886   105%     -  727s
     0     0 23220.3616    0  497 11313.7014 23220.3616   105%     -  730s
     0     0 23219.1411    0  507 11313.7014 23219.1411   105%     -  734s
     0     0 23218.5763    0  507 11313.7014 23218.5763   105%     -  738s
H    0     0                    11335.838721 23218.5763   105%     -  760s
H    0     0                    11412.688142 23218.5763   103%     -  803s
H    0     0                    11995.779192 23218.5763  93.6%     -  803s
H    0     0                    12009.478527 23218.5763  93.3%     -  806s
H    0     0                    12231.454306 23218.5763  89.8%     -  816s
H    0     0                    12313.183029 23218.5763  88.6%     -  816s
H    0     0                    12326.882364 23218.5763  88.4%     -  817s
H    0     2                    12887.167896 23218.5763  80.2%     -  886s
     0     2 23218.5763    0  507 12887.1679 23218.5763  80.2%     -  886s
     1     4 23119.5770    1  417 12887.1679 23218.5763  80.2% 11664  901s
     3     8 22859.5404    2  490 12887.1679 23118.3940  79.4% 13973  923s
     7    16 22454.7108    3  439 12887.1679 22859.5013  77.4% 16545  944s
    15    32 22209.8068    4  504 12887.1679 22522.0776  74.8% 15834  966s
    31    48 21869.9672    5  373 12887.1679 22209.4522  72.3% 20524 1010s
    47    78 20776.5195    6  291 12887.1679 22209.4522  72.3% 19154 1041s
H   67    78                    12971.765411 22209.4522  71.2% 16441 1041s
    77   172 20745.7882    7  283 12971.7654 22209.4522  71.2% 15276 1087s
   171   243 20089.0997    9  258 12971.7654 22209.4522  71.2% 10305 1112s
H  173   243                    13019.840414 22209.4522  70.6% 10280 1112s
   242   298 20045.6013   10  249 13019.8404 22209.4522  70.6%  8363 1138s
   301   350 20663.7174   13  256 13019.8404 22209.4522  70.6%  8093 1158s
   359   390 18024.6496   12  240 13019.8404 22209.4522  70.6%  7738 1176s
   425   423 18208.6937   11  216 13019.8404 22209.4522  70.6%  7597 1197s
   513   439 17656.8798   12  216 13019.8404 22209.4522  70.6%  7434 1214s
   551   463 17021.1309   12  229 13019.8404 22209.4522  70.6%  7504 1227s
   590   471 16984.5928   12  173 13019.8404 22209.4522  70.6%  7515 1244s
   634   503 16371.3474   12  206 13019.8404 22209.4522  70.6%  7465 1261s
   680   524 16274.7633   13  206 13019.8404 22209.4522  70.6%  7509 1275s
   727   549 15876.1027   14  208 13019.8404 22209.4522  70.6%  7440 1292s
   779   569 13593.5369   14  211 13019.8404 22209.4522  70.6%  7283 1306s
   828   589 infeasible   15      13019.8404 22209.4522  70.6%  7222 1318s
   891   635 13639.8825   16  217 13019.8404 22209.4522  70.6%  7076 1333s
   972   642     cutoff   17      13019.8404 22209.4522  70.6%  6848 1347s
  1072   659     cutoff   17      13019.8404 22209.4522  70.6%  6599 1364s
H 1085   659                    13193.309096 22209.4522  68.3%  6593 1364s
  1157   675 14070.8498   23  164 13193.3091 22209.4522  68.3%  6432 1381s
  1248   709 13766.3294   24  155 13193.3091 22209.4522  68.3%  6351 1401s
  1333   732 13545.9337   27   99 13193.3091 22209.4522  68.3%  6270 1422s
  1419   739 13445.9141   29   91 13193.3091 22209.4522  68.3%  6289 1444s
  1494   758 infeasible   31      13193.3091 22209.4522  68.3%  6335 1465s
  1531   787 20013.8839    9  391 13193.3091 22209.4522  68.3%  6567 1486s
  1569   820 17579.1441   15  207 13193.3091 22209.4522  68.3%  6722 1507s
  1622   869 16690.3889   16  191 13193.3091 22209.4522  68.3%  6787 1525s
  1691   943 16590.7000   16  150 13193.3091 22209.4522  68.3%  6801 1547s
  1784  1012 16218.9301   17  104 13193.3091 22209.4522  68.3%  6739 1569s
  1915  1096 14230.3306   18  138 13193.3091 22209.4522  68.3%  6623 1595s
  2076  1180 14814.7063   20  116 13193.3091 22209.4522  68.3%  6471 1618s
  2251  1270 13985.7926   23   84 13193.3091 22209.4522  68.3%  6341 1642s
  2390  1354 13747.6221   26   73 13193.3091 22209.4522  68.3%  6360 1672s
  2550  1466     cutoff   27      13193.3091 22209.4522  68.3%  6313 1700s
  2731  1516 infeasible   46      13193.3091 21940.3682  66.3%  6238 1727s
  2874  1566 19340.5181    6  525 13193.3091 21940.3682  66.3%  6174 1760s
  3018  1631 18102.6450    7  560 13193.3091 21940.3682  66.3%  6163 1794s
  3201  1700 13290.9215    8  430 13193.3091 21940.3682  66.3%  6148 1829s
  3335  1785 13197.7931    9  412 13193.3091 21940.3682  66.3%  6196 1864s
  3490  1832 infeasible   10      13193.3091 21940.3682  66.3%  6236 1905s
  3609  1927 17584.0872    9  475 13193.3091 21940.3682  66.3%  6352 1940s
  3764  1985 16706.2504   10  474 13193.3091 21940.3682  66.3%  6421 1979s
H 3953  2032                    13205.724181 21940.3682  66.1%  6458 2022s
  4084  2099 15956.2939   12  442 13205.7242 21940.3682  66.1%  6595 2064s
  4221  2188 14998.9068   14  426 13205.7242 21485.2717  62.7%  6715 2103s
  4363  2354     cutoff   15      13205.7242 21278.0541  61.1%  6723 2146s
  4589  2355 17242.5609   28  507 13205.7242 21278.0541  61.1%  6664 2422s
  4591  2356 15795.1826   13  162 13205.7242 21278.0541  61.1%  6661 2444s
  4592  2357 14999.5374   15  269 13205.7242 21278.0541  61.1%  6660 2566s
  4593  2358 13926.6629   39  413 13205.7242 21278.0541  61.1%  6658 2678s
  4594  2358 17263.0141   21  391 13205.7242 21278.0541  61.1%  6657 2741s
  4595  2359 13960.1580   32  354 13205.7242 21278.0541  61.1%  6655 2775s
  4596  2360 18747.9836   11  416 13205.7242 21278.0541  61.1%  6654 2802s
  4597  2360 16298.7846   12  423 13205.7242 21278.0541  61.1%  6653 2824s
  4598  2361 13643.5648   28  435 13205.7242 21278.0541  61.1%  6651 2848s
  4599  2362 14231.5973   21  430 13205.7242 21278.0541  61.1%  6650 2861s
  4600  2362 14078.0685   49  435 13205.7242 21278.0541  61.1%  6648 2871s
  4601  2363 14156.7545   18  437 13205.7242 21278.0541  61.1%  6647 2880s
  4602  2364 13513.8758   25  433 13205.7242 21278.0541  61.1%  6645 2890s
  4603  2364 14039.2685   42  472 13205.7242 21278.0541  61.1%  6644 2897s
  4604  2365 13729.0737   22  472 13205.7242 21278.0541  61.1%  6642 2904s
  4605  2366 17359.7059   15  471 13205.7242 21278.0541  61.1%  6641 2915s
  4606  2366 18024.2245   13  380 13205.7242 21278.0541  61.1%  6640 2938s
  4607  2367 15779.6035   24  388 13205.7242 21278.0541  61.1%  6638 2946s
  4608  2368 14312.1128   20  385 13205.7242 21278.0541  61.1%  6637 2953s
  4609  2368 17346.3625   11  376 13205.7242 21278.0541  61.1%  6635 2974s
  4610  2369 15170.4372   14  481 13205.7242 21278.0541  61.1%  6634 2988s
  4611  2370 18602.8935   14  435 13205.7242 21278.0541  61.1%  6632 2998s
  4612  2370 13729.0737   22  444 13205.7242 21278.0541  61.1%  6631 3006s
  4613  2371 14635.4757   21  446 13205.7242 21278.0541  61.1%  6629 3012s
  4614  2372 15745.6266   16  482 13205.7242 21278.0541  61.1%  6628 3028s
  4615  2372 15970.9136   11  507 13205.7242 21278.0541  61.1%  6627 3037s
  4616  2373 16473.4443   18  487 13205.7242 21278.0541  61.1%  6625 3055s
  4617  2374 13671.5470   34  444 13205.7242 21278.0541  61.1%  6624 3064s
  4618  2374 18923.8787    7  493 13205.7242 21278.0541  61.1%  6622 3087s
  4619  2375 14995.2456   26  441 13205.7242 21278.0541  61.1%  6621 3096s
  4620  2376 15353.4055   49  467 13205.7242 21278.0541  61.1%  6619 3110s
  4621  2376 13713.2673   43  491 13205.7242 21278.0541  61.1%  6618 3119s
  4622  2377 18617.0714    7  476 13205.7242 21278.0541  61.1%  6617 3135s
  4623  2378 13514.2887   25  435 13205.7242 21278.0541  61.1%  6615 3140s
  4624  2378 14253.7500   20  458 13205.7242 21278.0541  61.1%  6614 3155s
  4625  2379 18763.6965    7  428 13205.7242 21278.0541  61.1%  6612 3163s
  4626  2380 18555.5435    9  393 13205.7242 21278.0541  61.1%  6611 3174s
  4627  2380 14504.0491   17  393 13205.7242 21278.0541  61.1%  6609 3197s
  4628  2381 14238.1489   22  393 13205.7242 21278.0541  61.1%  6608 3252s
  4629  2385 21278.0541   12  366 13205.7242 21278.0541  61.1%  6707 3377s
  4631  2388 21278.0541   13  359 13205.7242 21278.0541  61.1%  6708 3426s
  4635  2395 21278.0541   14  345 13205.7242 21278.0541  61.1%  6718 3478s
  4643  2408 21278.0541   15  402 13205.7242 21278.0541  61.1%  6736 3518s
  4659  2419 20846.3000   16  337 13205.7242 21278.0541  61.1%  6808 3582s
  4675  2427 18080.1484   17  215 13205.7242 21278.0541  61.1%  6863 3600s

Cutting planes:
  Gomory: 9
  Implied bound: 5
  Projected implied bound: 174
  MIR: 1200
  Flow cover: 1905
  RLT: 26
  Relax-and-lift: 196

Explored 4689 nodes (32886319 simplex iterations) in 3600.11 seconds (8695.93 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13205.7 13193.3 13019.8 ... 11995.8

Time limit reached
Best objective 1.320572418110e+04, best bound 2.127805414648e+04, gap 61.1275%
  WARNING: Time limit reached. Using best solution found (gap: 61.13%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 13205.72, θ = 156426.87
  Upper Bound (UB) = 13205.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156426.87
  [DEBUG]   ✓ Scenario 0: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 156426.87 ≤ Q = 156426.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 156426.87 ≤ Q = 156431.47 (slack: 4.61)
  [DEBUG]   ✓ Scenario 8: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 156426.87 ≤ Q = 156426.87 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 156426.87 ≤ Q = 156426.87 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7ddbd4fc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7ddbd4fc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.275607e+13
Presolve removed 2563 rows and 1853 columns
Presolve time: 0.01s
Presolved: 530 rows, 536 columns, 1497 nonzeros
Found heuristic solution: objective 6684188.7043
Variable types: 362 continuous, 174 integer (174 binary)
Found heuristic solution: objective 6683477.9664

Root relaxation: objective -1.451894e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145189.45    0  130 6683477.97 -145189.45   102%     -    0s
H    0     0                    -101677.9623 -145189.45  42.8%     -    0s
H    0     0                    -110868.6967 -145189.45  31.0%     -    0s
H    0     0                    -111170.9611 -145189.45  30.6%     -    0s
H    0     0                    -111809.6931 -145013.88  29.7%     -    0s
     0     0 -119616.59    0   20 -111809.69 -119616.59  6.98%     -    0s
H    0     0                    -118889.9242 -119553.01  0.56%     -    0s
     0     0 -119437.26    0   13 -118889.92 -119437.26  0.46%     -    0s
H    0     0                    -119012.4524 -119437.26  0.36%     -    0s
H    0     0                    -119348.0214 -119437.26  0.07%     -    0s
     0     0 -119373.43    0    2 -119348.02 -119373.43  0.02%     -    0s
     0     0 -119366.40    0    5 -119348.02 -119366.40  0.02%     -    0s
     0     0 -119364.56    0    3 -119348.02 -119364.56  0.01%     -    0s
H    0     0                    -119363.3449 -119364.56  0.00%     -    0s
     0     0     cutoff    0      -119363.34 -119363.34  0.00%     -    0s

Cutting planes:
  MIR: 1
  RLT: 1

Explored 1 nodes (452 simplex iterations) in 0.06 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119363 -119348 -119012 ... 1.27561e+13
No other solutions better than -119363

Optimal solution found (tolerance 1.00e-06)
Best objective -1.193633448841e+05, best bound -1.193633448841e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 148326.28
  Scenario: 5 demand increases, 55 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119363.34
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -119363.34 = 148326.28
  [DEBUG]   Current θ from Master = 156426.87
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8100.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5105.14
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 1004.4394, Absolute Gap = 1004.4394, Relative Gap = 0.076061
  Not converged yet (gap = 1004.44 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 5 increases, 55 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 784109 nonzeros
Model fingerprint: 0x8b3efb0d
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 112716 rows and 45756 columns
Presolve time: 3.55s
Presolved: 163887 rows, 68824 columns, 1006211 nonzeros
Variable types: 66565 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.49s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 8.478e+06
 Factor NZ  : 1.947e+07 (roughly 250 MB of memory)
 Factor Ops : 5.022e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70671903e+07  2.68252948e+08  1.05e+05 2.06e+01  7.16e+04     6s
   1  -1.30791144e+07  2.33262313e+08  7.29e+04 6.11e+01  4.92e+04     6s
   2  -3.32227108e+06  1.86585151e+08  1.75e+04 6.35e-01  1.26e+04     6s
   3  -1.05893656e+06  1.31534164e+08  3.25e+03 1.79e-01  2.59e+03     6s
   4  -5.76261429e+05  1.08875058e+08  6.01e+02 1.26e-01  7.53e+02     6s
   5  -5.18748596e+05  5.55464589e+07  3.69e+02 4.78e-02  3.95e+02     6s
   6  -4.26743564e+05  3.57935270e+07  9.46e+01 2.70e-02  1.70e+02     6s
   7  -3.56953010e+05  2.77884593e+07  4.06e+01 2.00e-02  1.13e+02     6s
   8  -2.46852160e+05  2.19170757e+07  7.09e+00 1.55e-02  7.71e+01     7s
   9  -1.76789022e+05  1.47883504e+07  3.23e+00 1.02e-02  5.10e+01     7s
  10  -1.29577697e+05  9.31857021e+06  1.77e+00 6.51e-03  3.20e+01     7s
  11  -1.09134705e+05  4.19832771e+06  1.15e+00 2.97e-03  1.45e+01     7s
  12  -8.79675122e+04  2.79351315e+06  6.61e-01 1.96e-03  9.69e+00     7s
  13  -6.14083700e+04  1.75346008e+06  2.79e-01 1.18e-03  6.09e+00     7s
  14  -3.73976493e+04  5.86270501e+05  1.32e-01 3.83e-04  2.09e+00     7s
  15  -1.47735929e+04  2.78965316e+05  6.57e-02 2.34e-04  9.84e-01     7s
  16  -1.99933099e+03  2.06213909e+05  4.43e-02 2.11e-04  6.98e-01     7s
  17   2.29620895e+03  1.65286810e+05  3.78e-02 3.45e-04  5.46e-01     7s
  18   1.00625505e+04  1.26373369e+05  2.75e-02 9.43e-04  3.90e-01     7s
  19   1.33493508e+04  1.02915870e+05  2.35e-02 7.07e-04  3.00e-01     7s
  20   1.79029468e+04  8.46884013e+04  1.87e-02 4.44e-04  2.24e-01     8s
  21   2.13746179e+04  7.32862298e+04  1.53e-02 6.17e-04  1.74e-01     8s
  22   2.42982061e+04  6.33655511e+04  1.26e-02 4.33e-04  1.31e-01     8s
  23   2.65803750e+04  5.79644039e+04  1.06e-02 3.33e-04  1.05e-01     8s
  24   2.85473665e+04  5.47768137e+04  9.02e-03 2.73e-04  8.79e-02     8s
  25   3.03049414e+04  5.21045625e+04  7.62e-03 2.24e-04  7.31e-02     8s
  26   3.26638613e+04  4.99577743e+04  5.80e-03 1.80e-04  5.80e-02     8s
  27   3.50350303e+04  4.76158977e+04  4.00e-03 1.33e-04  4.22e-02     8s
  28   3.59350537e+04  4.48123069e+04  3.35e-03 6.65e-05  2.98e-02     8s
  29   3.70506488e+04  4.43384782e+04  2.59e-03 5.81e-05  2.44e-02     9s
  30   3.77256664e+04  4.30874944e+04  2.12e-03 4.29e-05  1.80e-02     9s
  31   3.82400926e+04  4.26673040e+04  1.77e-03 3.47e-05  1.48e-02     9s
  32   3.85977091e+04  4.20502535e+04  1.52e-03 3.44e-05  1.16e-02     9s
  33   3.90899467e+04  4.18677768e+04  1.19e-03 2.85e-05  9.31e-03     9s
  34   3.94106490e+04  4.17828527e+04  9.75e-04 2.58e-05  7.95e-03     9s
  35   3.96014327e+04  4.14001898e+04  8.49e-04 1.42e-05  6.03e-03     9s
  36   4.00893181e+04  4.11947920e+04  5.32e-04 7.50e-06  3.71e-03     9s
  37   4.02210122e+04  4.11153570e+04  4.47e-04 5.16e-06  3.00e-03     9s
  38   4.05400631e+04  4.10922250e+04  2.52e-04 6.91e-06  1.85e-03    10s
  39   4.06863874e+04  4.10414832e+04  1.56e-04 5.10e-06  1.19e-03    10s
  40   4.07005733e+04  4.10085882e+04  1.48e-04 3.43e-06  1.03e-03    10s
  41   4.08752188e+04  4.09677320e+04  3.55e-05 1.27e-06  3.10e-04    10s
  42   4.09104591e+04  4.09640899e+04  1.66e-05 1.10e-06  1.80e-04    10s
  43   4.09231565e+04  4.09495407e+04  9.67e-06 3.66e-07  8.84e-05    10s
  44   4.09261102e+04  4.09462412e+04  8.06e-06 2.14e-07  6.75e-05    10s
  45   4.09381573e+04  4.09437394e+04  1.67e-06 9.60e-08  1.87e-05    10s
  46   4.09410704e+04  4.09423518e+04  1.81e-07 3.18e-08  4.29e-06    10s
  47   4.09415606e+04  4.09416130e+04  2.64e-08 9.86e-09  1.76e-07    11s
  48   4.09415857e+04  4.09415858e+04  1.21e-09 3.23e-10  9.65e-11    11s

Barrier solved model in 48 iterations and 10.60 seconds (16.33 work units)
Optimal objective 4.09415857e+04


Root crossover log...

  142097 DPushes remaining with DInf 0.0000000e+00                11s
    2215 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    3975 PPushes remaining with PInf 1.6214672e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9177001e-01     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63891    4.0941586e+04   0.000000e+00   1.917700e-01     16s
   63894    4.0941586e+04   0.000000e+00   0.000000e+00     16s
   63894    4.0941586e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 2.87s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.094159e+04, 63894 iterations, 14.67 seconds (25.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40941.5858    0  248 -233197.24 40941.5858   118%     -   19s
H    0     0                    -186069.0207 40941.5858   122%     -   20s
H    0     0                    -185339.4943 40941.5858   122%     -   20s
H    0     0                    -148647.9336 40941.5858   128%     -   21s
H    0     0                    -147467.0933 40941.5858   128%     -   21s
H    0     0                    -145820.4529 40941.5858   128%     -   21s
H    0     0                    -145701.9684 40941.5858   128%     -   21s
H    0     0                    -58251.44252 40941.5858   170%     -   21s
H    0     0                    -28203.67953 40941.5858   245%     -   22s
H    0     0                    -3524.598816 40941.5858  1262%     -   22s
H    0     0                    4484.0007990 40941.5858   813%     -   22s
H    0     0                    5210.9888053 40941.5858   686%     -   22s
H    0     0                    7417.6965881 40941.5858   452%     -   22s
H    0     0                    7461.1053533 40941.5858   449%     -   22s
H    0     0                    7831.9663661 40941.5858   423%     -   22s
H    0     0                    7920.8269017 40941.5858   417%     -   22s
     0     0 33524.5486    0  238 7920.82690 33524.5486   323%     -   85s
H    0     0                    10089.209645 33524.5273   232%     -   87s
H    0     0                    10260.251358 33524.5273   227%     -   87s
H    0     0                    10505.446097 33524.5273   219%     -   87s
     0     0 33136.4605    0  253 10505.4461 33136.4605   215%     -  101s
     0     0 33113.6390    0  212 10505.4461 33113.6390   215%     -  106s
     0     0 33103.8465    0  205 10505.4461 33103.8465   215%     -  106s
     0     0 33103.1002    0  205 10505.4461 33103.1002   215%     -  107s
     0     0 29829.4660    0  289 10505.4461 29829.4660   184%     -  161s
H    0     0                    10555.619040 29829.3594   183%     -  162s
H    0     0                    10605.178953 29829.3594   181%     -  162s
H    0     0                    10650.780299 29829.3594   180%     -  162s
H    0     0                    10674.699487 29829.3594   179%     -  162s
H    0     0                    10690.047798 29829.3594   179%     -  162s
     0     0 29336.9754    0  358 10690.0478 29336.9754   174%     -  200s
     0     0 29080.7729    0  302 10690.0478 29080.7729   172%     -  224s
     0     0 28852.9535    0  353 10690.0478 28852.9535   170%     -  255s
     0     0 28805.1596    0  351 10690.0478 28805.1596   169%     -  266s
     0     0 28755.0153    0  355 10690.0478 28755.0153   169%     -  281s
     0     0 28747.2428    0  348 10690.0478 28747.2428   169%     -  284s
     0     0 28744.9182    0  362 10690.0478 28744.9182   169%     -  286s
     0     0 28733.5093    0  362 10690.0478 28733.5093   169%     -  290s
     0     0 28730.9829    0  369 10690.0478 28730.9829   169%     -  294s
     0     0 28730.8144    0  367 10690.0478 28730.8144   169%     -  295s
     0     0 25954.5320    0  469 10690.0478 25954.5320   143%     -  392s
H    0     0                    10922.650489 25954.3317   138%     -  393s
H    0     0                    10954.063172 25954.3317   137%     -  393s
     0     0 25347.7732    0  465 10954.0632 25347.7732   131%     -  436s
     0     0 25175.4387    0  483 10954.0632 25175.4387   130%     -  461s
     0     0 25100.8562    0  483 10954.0632 25100.8562   129%     -  477s
     0     0 25017.7157    0  529 10954.0632 25017.7157   128%     -  489s
     0     0 24966.1145    0  488 10954.0632 24966.1145   128%     -  505s
     0     0 24945.1245    0  488 10954.0632 24945.1245   128%     -  517s
     0     0 24903.0947    0  478 10954.0632 24903.0947   127%     -  527s
     0     0 24888.8811    0  488 10954.0632 24888.8811   127%     -  534s
     0     0 24882.6073    0  531 10954.0632 24882.6073   127%     -  540s
     0     0 24880.1667    0  535 10954.0632 24880.1667   127%     -  543s
     0     0 24873.8547    0  530 10954.0632 24873.8547   127%     -  548s
     0     0 24836.6417    0  525 10954.0632 24836.6417   127%     -  560s
     0     0 24833.7383    0  532 10954.0632 24833.7383   127%     -  563s
     0     0 24818.0457    0  519 10954.0632 24818.0457   127%     -  571s
     0     0 24817.1993    0  523 10954.0632 24817.1993   127%     -  573s
     0     0 24155.1715    0  426 10954.0632 24155.1715   121%     -  625s
     0     0 23843.3993    0  307 10954.0632 23843.3993   118%     -  656s
     0     0 23751.6442    0  430 10954.0632 23751.6442   117%     -  670s
     0     0 23694.3829    0  406 10954.0632 23694.3829   116%     -  680s
     0     0 23677.2708    0  425 10954.0632 23677.2708   116%     -  686s
     0     0 23668.1165    0  417 10954.0632 23668.1165   116%     -  691s
     0     0 23660.5972    0  430 10954.0632 23660.5972   116%     -  696s
     0     0 23654.4061    0  420 10954.0632 23654.4061   116%     -  699s
     0     0 23653.6572    0  421 10954.0632 23653.6572   116%     -  700s
     0     0 23468.9510    0  495 10954.0632 23468.9510   114%     -  725s
     0     0 23454.8516    0  480 10954.0632 23454.8516   114%     -  734s
     0     0 23446.7469    0  500 10954.0632 23446.7469   114%     -  738s
     0     0 23437.1247    0  494 10954.0632 23437.1247   114%     -  745s
     0     0 23417.1721    0  441 10954.0632 23417.1721   114%     -  750s
     0     0 23399.0017    0  435 10954.0632 23399.0017   114%     -  756s
     0     0 23396.7104    0  438 10954.0632 23396.7104   114%     -  760s
     0     0 23363.1937    0  424 10954.0632 23363.1937   113%     -  772s
H    0     0                    12336.221045 23363.0212  89.4%     -  773s
H    0     0                    12533.622524 23363.0212  86.4%     -  775s
H    0     0                    12685.328695 23363.0212  84.2%     -  778s
     0     0 23358.4313    0  485 12685.3287 23358.4313  84.1%     -  783s
     0     0 23354.4850    0  475 12685.3287 23354.4850  84.1%     -  787s
     0     0 23352.7155    0  476 12685.3287 23352.7155  84.1%     -  789s
     0     0 23317.5298    0  539 12685.3287 23317.5298  83.8%     -  805s
H    0     0                    12743.914862 23317.3842  83.0%     -  806s
     0     0 23306.7321    0  500 12743.9149 23306.7321  82.9%     -  817s
     0     0 23301.4499    0  437 12743.9149 23301.4499  82.8%     -  823s
     0     0 23296.3216    0  490 12743.9149 23296.3216  82.8%     -  829s
     0     0 23293.6426    0  506 12743.9149 23293.6426  82.8%     -  832s
     0     0 23288.9460    0  486 12743.9149 23288.9460  82.7%     -  837s
     0     0 23287.5743    0  539 12743.9149 23287.5743  82.7%     -  839s
     0     0 23280.4620    0  480 12743.9149 23280.4620  82.7%     -  849s
H    0     0                    12887.167896 23280.4519  80.6%     -  850s
     0     0 23275.4627    0  485 12887.1679 23275.4627  80.6%     -  855s
     0     0 23274.6071    0  494 12887.1679 23274.6071  80.6%     -  857s
     0     0 23264.5646    0  536 12887.1679 23264.5646  80.5%     -  866s
     0     0 23259.2453    0  502 12887.1679 23259.2453  80.5%     -  871s
     0     0 23258.3220    0  500 12887.1679 23258.3220  80.5%     -  873s
     0     0 23249.1868    0  455 12887.1679 23249.1868  80.4%     -  881s
     0     0 23246.9228    0  505 12887.1679 23246.9228  80.4%     -  893s
     0     0 23239.3065    0  507 12887.1679 23239.3065  80.3%     -  901s
     0     0 23239.2219    0  507 12887.1679 23239.2219  80.3%     -  906s
     0     2 23239.0923    0  507 12887.1679 23239.0923  80.3%     -  979s
     1     3 22855.4953    1  369 12887.1679 23239.0923  80.3% 12210  996s
     2     4 22962.5317    1  462 12887.1679 22962.5317  78.2% 12744 1013s
     3     5 22422.1148    2  518 12887.1679 22962.3142  78.2% 15275 1038s
     4     7 22567.0612    2  452 12887.1679 22961.8764  78.2% 13741 1061s
     6    13 22299.5557    3  479 12887.1679 22961.8764  78.2% 12582 1085s
    12    26 21991.8579    3  528 12887.1679 22566.8539  75.1% 13836 1108s
    25    39 21443.6234    4  430 12887.1679 22454.0750  74.2% 18326 2475s
    38    68 19630.4374    6  304 12887.1679 22454.0750  74.2% 28382 2665s
    67   194 20012.7331    5  355 12887.1679 21884.7247  69.8% 30809 2738s
   193   242 19132.9971   10  289 12887.1679 21667.7936  68.1% 16216 2768s
   243   282 14452.8892   12  208 12887.1679 21667.7936  68.1% 14348 2803s
   298   308 14204.2686   14  179 12887.1679 21667.7936  68.1% 12754 2830s
   343   327 14027.3231   16  155 12887.1679 21667.7936  68.1% 11852 2857s
   383   348 13717.8491   21  157 12887.1679 21667.7936  68.1% 11297 2885s
   424   379 13485.3486   23  167 12887.1679 21667.7936  68.1% 11430 2913s
   472   402 infeasible   25      12887.1679 21667.7936  68.1% 11138 2936s
   515   435 20512.6550    8  402 12887.1679 21667.7936  68.1% 11067 2959s
   565   452 20282.8767    9  463 12887.1679 21667.7936  68.1% 10848 2979s
   609   470 20468.6438    9  395 12887.1679 21667.7936  68.1% 10694 3004s
   664   475 19931.0251   10  450 12887.1679 21667.7936  68.1% 10569 3025s
   711   488 17863.3512   10  200 12887.1679 21667.7936  68.1% 10488 3049s
   760   491 18336.0239   11  436 12887.1679 21667.7936  68.1% 10398 3074s
   801   492 17533.7570   12  449 12887.1679 21667.7936  68.1% 10352 3096s
   846   507 18159.1643   10  191 12887.1679 21667.7936  68.1% 10252 3143s
   883   552 18224.2079   17  422 12887.1679 21667.7936  68.1% 10237 3168s
   951   588 18200.8690    8  183 12887.1679 21667.7936  68.1% 10038 3193s
  1021   627 15182.8137   10  155 12887.1679 21667.7936  68.1%  9955 3223s
  1096   673 14462.9021   11   82 12887.1679 21667.7936  68.1%  9781 3249s
  1175   712 13834.8436   13   74 12887.1679 21667.7936  68.1%  9740 3277s
  1250   751 13382.0105   18   69 12887.1679 21608.5997  67.7%  9708 3303s
  1331   792 12891.7703   24   20 12887.1679 21608.5997  67.7%  9546 3336s
  1439   839 infeasible   17      12887.1679 21608.5997  67.7%  9255 3372s
  1545   889 14679.5204   40  257 12887.1679 21608.5997  67.7%  9041 3406s
  1659   972 13855.6719   50  324 12887.1679 21608.5997  67.7%  8874 3439s
  1783  1049 13781.0100   61  146 12887.1679 21608.5997  67.7%  8791 3479s
  1922  1094 13461.5053   70   76 12887.1679 21608.5997  67.7%  8627 3522s
  2051  1134 12999.2192   82   58 12887.1679 21608.5997  67.7%  8556 3564s
  2144  1196 12972.4151   83   59 12887.1679 21608.5997  67.7%  8629 3600s

Cutting planes:
  Learned: 1
  Gomory: 18
  Lift-and-project: 1
  Implied bound: 273
  MIR: 4260
  Flow cover: 3307
  RLT: 56
  Relax-and-lift: 579

Explored 2249 nodes (20275044 simplex iterations) in 3600.11 seconds (7462.17 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12887.2 12743.9 12685.3 ... 10650.8

Time limit reached
Best objective 1.288716789585e+04, best bound 2.160859974689e+04, gap 67.6753%
  WARNING: Time limit reached. Using best solution found (gap: 67.68%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 12887.17, θ = 157613.75
  Upper Bound (UB) = 12887.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157613.75
  [DEBUG]   ✓ Scenario 0: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157613.75 ≤ Q = 157613.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 157613.75 ≤ Q = 157613.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 157613.75 ≤ Q = 157613.75 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x725fe328
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x725fe328
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.277614e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.00s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6834591.4219
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.430089e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143008.93    0  123 6834591.42 -143008.93   102%     -    0s
H    0     0                    -106180.8411 -143008.93  34.7%     -    0s
H    0     0                    -107404.7709 -143008.93  33.1%     -    0s
     0     0 -114545.33    0   26 -107404.77 -114545.33  6.65%     -    0s
H    0     0                    -113461.2436 -114498.78  0.91%     -    0s
H    0     0                    -113810.3629 -114256.53  0.39%     -    0s
H    0     0                    -114145.9319 -114256.53  0.10%     -    0s
     0     0 -114256.53    0   13 -114145.93 -114256.53  0.10%     -    0s
     0     0 -114191.10    0    4 -114145.93 -114191.10  0.04%     -    0s
     0     0 -114189.12    0    5 -114145.93 -114189.12  0.04%     -    0s
     0     0 -114168.98    0    4 -114145.93 -114168.98  0.02%     -    0s
     0     0 -114168.98    0    7 -114145.93 -114168.98  0.02%     -    0s
H    0     0                    -114153.8842 -114168.98  0.01%     -    0s
     0     0 -114161.76    0    2 -114153.88 -114161.76  0.01%     -    0s
H    0     0                    -114159.1618 -114161.34  0.00%     -    0s
H    0     0                    -114160.0321 -114161.34  0.00%     -    0s
     0     0     cutoff    0      -114160.03 -114160.03  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 4
  RLT: 3

Explored 1 nodes (484 simplex iterations) in 0.05 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -114160 -114159 -114154 ... 1.27761e+13
No other solutions better than -114160

Optimal solution found (tolerance 1.00e-06)
Best objective -1.141600321153e+05, best bound -1.141600321153e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 153529.59
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114160.03
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -114160.03 = 153529.59
  [DEBUG]   Current θ from Master = 157613.75
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4084.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8803.01
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 685.8831, Absolute Gap = 685.8831, Relative Gap = 0.053222
  Not converged yet (gap = 685.88 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827364 nonzeros
Model fingerprint: 0x695eb709
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 118978 rows and 48298 columns
Presolve time: 3.71s
Presolved: 172915 rows, 72522 columns, 1061705 nonzeros
Variable types: 70263 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.55s

Barrier statistics:
 Dense cols : 696
 AA' NZ     : 9.329e+06
 Factor NZ  : 2.139e+07 (roughly 270 MB of memory)
 Factor Ops : 5.746e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70754269e+07  2.80438832e+08  1.05e+05 2.02e+01  7.13e+04     6s
   1  -1.31535825e+07  2.43522051e+08  7.32e+04 6.20e+01  4.91e+04     6s
   2  -6.22621715e+06  1.95133168e+08  3.33e+04 5.67e-01  2.34e+04     6s
   3  -8.91820525e+05  1.46247922e+08  1.90e+03 1.61e+00  1.73e+03     6s
   4  -5.93755258e+05  4.96171266e+07  5.38e+02 2.31e-01  4.73e+02     7s
   5  -4.95033444e+05  3.52670981e+07  2.80e+02 1.46e-01  2.67e+02     7s
   6  -3.90430553e+05  2.72132649e+07  9.37e+01 1.01e-01  1.35e+02     7s
   7  -2.82892319e+05  2.18119649e+07  4.47e+01 7.76e-02  9.06e+01     7s
   8  -1.48519683e+05  1.66152200e+07  8.91e+00 5.67e-02  5.66e+01     7s
   9  -1.27418651e+05  9.76972820e+06  6.27e+00 3.21e-02  3.30e+01     7s
  10  -1.12598561e+05  6.71293329e+06  3.59e+00 2.17e-02  2.23e+01     7s
  11  -9.79859247e+04  2.02992210e+06  2.32e+00 6.23e-03  6.90e+00     7s
  12  -5.92622009e+04  7.54324458e+05  6.38e-01 2.20e-03  2.60e+00     7s
  13  -2.95260583e+04  4.40496362e+05  3.04e-01 1.28e-03  1.50e+00     7s
  14  -1.25685434e+04  2.19222880e+05  1.73e-01 9.52e-04  7.38e-01     7s
  15  -4.73075398e+03  1.71951363e+05  1.36e-01 1.11e-03  5.62e-01     8s
  16   3.34654472e+03  1.26602973e+05  1.03e-01 1.06e-03  3.92e-01     8s
  17   5.76757138e+03  1.05347882e+05  9.41e-02 1.24e-03  3.17e-01     8s
  18   1.28405941e+04  9.04742434e+04  6.77e-02 1.46e-03  2.47e-01     8s
  19   1.68586810e+04  7.41521413e+04  5.56e-02 1.85e-03  1.82e-01     8s
  20   2.07679121e+04  6.50949245e+04  4.49e-02 1.38e-03  1.41e-01     8s
  21   2.27830601e+04  6.04721411e+04  3.93e-02 1.28e-03  1.20e-01     8s
  22   2.48004460e+04  5.60172264e+04  3.42e-02 1.64e-03  9.94e-02     8s
  23   2.62514040e+04  5.36183604e+04  3.06e-02 1.39e-03  8.71e-02     8s
  24   2.86442054e+04  5.26382618e+04  2.49e-02 1.29e-03  7.64e-02     8s
  25   3.08909722e+04  4.99775587e+04  1.97e-02 1.01e-03  6.08e-02     8s
  26   3.27351629e+04  4.81117212e+04  1.57e-02 8.00e-04  4.89e-02     9s
  27   3.49880568e+04  4.63114931e+04  1.10e-02 6.10e-04  3.60e-02     9s
  28   3.57808067e+04  4.48523805e+04  9.37e-03 4.48e-04  2.89e-02     9s
  29   3.65578944e+04  4.42222917e+04  7.83e-03 3.80e-04  2.44e-02     9s
  30   3.69264828e+04  4.38112163e+04  7.13e-03 3.31e-04  2.19e-02     9s
  31   3.77607162e+04  4.35429236e+04  5.54e-03 3.05e-04  1.84e-02     9s
  32   3.83797301e+04  4.27067025e+04  4.34e-03 2.04e-04  1.38e-02     9s
  33   3.87744756e+04  4.24464015e+04  3.62e-03 1.76e-04  1.17e-02     9s
  34   3.90334805e+04  4.20389252e+04  3.14e-03 1.32e-04  9.57e-03     9s
  35   3.91696596e+04  4.18259163e+04  2.88e-03 1.12e-04  8.46e-03    10s
  36   3.96000473e+04  4.17231455e+04  2.11e-03 1.02e-04  6.76e-03    10s
  37   3.96923148e+04  4.16722235e+04  1.95e-03 9.57e-05  6.30e-03    10s
  38   4.00158649e+04  4.15567795e+04  1.36e-03 8.31e-05  4.90e-03    10s
  39   4.03662767e+04  4.12258801e+04  7.42e-04 7.09e-05  2.73e-03    10s
  40   4.04423082e+04  4.11067728e+04  6.12e-04 4.91e-05  2.11e-03    10s
  41   4.05641339e+04  4.10486210e+04  4.18e-04 3.87e-05  1.54e-03    10s
  42   4.06296616e+04  4.09644268e+04  3.07e-04 2.31e-05  1.07e-03    10s
  43   4.06700828e+04  4.09397015e+04  2.41e-04 1.90e-05  8.58e-04    10s
  44   4.07338794e+04  4.08987798e+04  1.37e-04 1.20e-05  5.25e-04    11s
  45   4.07777577e+04  4.08845280e+04  6.78e-05 9.56e-06  3.39e-04    11s
  46   4.07917524e+04  4.08661269e+04  4.60e-05 6.55e-06  2.36e-04    11s
  47   4.08186128e+04  4.08402882e+04  8.87e-06 2.31e-06  6.89e-05    11s
  48   4.08239284e+04  4.08282206e+04  2.13e-06 3.28e-07  1.36e-05    11s
  49   4.08257486e+04  4.08265964e+04  2.88e-07 1.21e-07  2.69e-06    11s
  50   4.08260401e+04  4.08261141e+04  3.61e-08 3.12e-09  2.36e-07    11s
  51   4.08260447e+04  4.08261130e+04  3.29e-06 3.66e-09  2.18e-07    11s
  52   4.08260950e+04  4.08260951e+04  3.33e-09 1.35e-10  2.19e-10    11s

Barrier solved model in 52 iterations and 11.40 seconds (17.95 work units)
Optimal objective 4.08260950e+04


Root crossover log...

  149910 DPushes remaining with DInf 0.0000000e+00                11s
    7824 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    5292 PPushes remaining with PInf 3.5890708e-05                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9898448e+00     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69493    4.0826095e+04   0.000000e+00   1.989845e+00     17s
   69509    4.0826095e+04   0.000000e+00   0.000000e+00     17s
   69509    4.0826095e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.09s

Solved with barrier

Root relaxation: objective 4.082610e+04, 69509 iterations, 12.73 seconds (27.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40826.0951    0  244 -233197.24 40826.0951   118%     -   18s
H    0     0                    -153247.2236 40826.0951   127%     -   19s
H    0     0                    -146578.5571 40826.0951   128%     -   19s
H    0     0                    -142796.3637 40826.0951   129%     -   19s
H    0     0                    -142665.1771 40826.0951   129%     -   20s
H    0     0                    -58251.44252 40826.0951   170%     -   20s
H    0     0                    -33607.68059 40826.0951   221%     -   20s
H    0     0                    -5887.199312 40826.0951   793%     -   20s
H    0     0                    3209.7438980 40826.0951  1172%     -   20s
H    0     0                    5530.4651259 40826.0951   638%     -   21s
H    0     0                    7469.2682923 40826.0951   447%     -   21s
H    0     0                    7510.1644999 40826.0951   444%     -   21s
H    0     0                    7514.7076134 40826.0951   443%     -   21s
H    0     0                    7574.8042596 40826.0951   439%     -   21s
H    0     0                    7580.6913121 40826.0951   439%     -   21s
     0     0 33483.7133    0  199 7580.69131 33483.7133   342%     -  100s
H    0     0                    8145.5398188 33483.5948   311%     -  101s
H    0     0                    9915.3841014 33483.5948   238%     -  101s
H    0     0                    10066.977197 33483.5948   233%     -  101s
H    0     0                    10331.812897 33483.5948   224%     -  101s
H    0     0                    10506.689055 33483.5948   219%     -  101s
H    0     0                    10611.026849 33483.5948   216%     -  101s
H    0     0                    10620.854092 33483.5948   215%     -  101s
     0     0 32951.1841    0  217 10620.8541 32951.1841   210%     -  126s
     0     0 32929.1022    0  215 10620.8541 32929.1022   210%     -  132s
     0     0 32923.6597    0  213 10620.8541 32923.6597   210%     -  134s
     0     0 32919.1209    0  208 10620.8541 32919.1209   210%     -  136s
     0     0 32918.6280    0  208 10620.8541 32918.6280   210%     -  136s
     0     0 30039.8992    0  295 10620.8541 30039.8992   183%     -  184s
H    0     0                    10899.002864 30039.3889   176%     -  185s
     0     0 29501.4351    0  341 10899.0029 29501.4351   171%     -  215s
     0     0 29290.4481    0  298 10899.0029 29290.4481   169%     -  238s
     0     0 29164.6200    0  295 10899.0029 29164.6200   168%     -  255s
     0     0 29118.7802    0  302 10899.0029 29118.7802   167%     -  267s
     0     0 29107.1709    0  303 10899.0029 29107.1709   167%     -  273s
     0     0 29102.0737    0  308 10899.0029 29102.0737   167%     -  277s
     0     0 29091.7763    0  363 10899.0029 29091.7763   167%     -  283s
     0     0 29079.8046    0  306 10899.0029 29079.8046   167%     -  288s
     0     0 29074.8974    0  313 10899.0029 29074.8974   167%     -  289s
     0     0 29047.0232    0  310 10899.0029 29047.0232   167%     -  295s
     0     0 28947.0211    0  312 10899.0029 28947.0211   166%     -  309s
     0     0 28941.4828    0  307 10899.0029 28941.4828   166%     -  313s
     0     0 28938.8318    0  306 10899.0029 28938.8318   166%     -  314s
     0     0 28936.5002    0  316 10899.0029 28936.5002   165%     -  316s
     0     0 28935.5401    0  312 10899.0029 28935.5401   165%     -  319s
     0     0 26146.9258    0  344 10899.0029 26146.9258   140%     -  398s
H    0     0                    11010.722837 26146.9040   137%     -  399s
     0     0 25662.3688    0  473 11010.7228 25662.3688   133%     -  429s
     0     0 25497.9995    0  402 11010.7228 25497.9995   132%     -  447s
     0     0 25429.5533    0  414 11010.7228 25429.5533   131%     -  460s
     0     0 25412.3938    0  407 11010.7228 25412.3938   131%     -  468s
     0     0 25407.5043    0  401 11010.7228 25407.5043   131%     -  474s
     0     0 25363.1356    0  412 11010.7228 25363.1356   130%     -  483s
     0     0 25335.6780    0  407 11010.7228 25335.6780   130%     -  492s
     0     0 25303.5354    0  403 11010.7228 25303.5354   130%     -  504s
     0     0 25258.1653    0  416 11010.7228 25258.1653   129%     -  515s
     0     0 25221.4640    0  421 11010.7228 25221.4640   129%     -  523s
     0     0 25205.4696    0  419 11010.7228 25205.4696   129%     -  530s
     0     0 25141.8240    0  421 11010.7228 25141.8240   128%     -  538s
     0     0 25116.3729    0  420 11010.7228 25116.3729   128%     -  548s
     0     0 25111.2941    0  418 11010.7228 25111.2941   128%     -  552s
     0     0 25101.3325    0  423 11010.7228 25101.3325   128%     -  558s
     0     0 25096.8436    0  422 11010.7228 25096.8436   128%     -  562s
     0     0 25093.0966    0  424 11010.7228 25093.0966   128%     -  564s
     0     0 25077.2765    0  422 11010.7228 25077.2765   128%     -  570s
     0     0 25067.6758    0  425 11010.7228 25067.6758   128%     -  574s
     0     0 25040.4166    0  429 11010.7228 25040.4166   127%     -  580s
     0     0 25038.0490    0  421 11010.7228 25038.0490   127%     -  583s
     0     0 25033.2467    0  424 11010.7228 25033.2467   127%     -  587s
     0     0 25032.4907    0  425 11010.7228 25032.4907   127%     -  589s
     0     0 24188.6673    0  482 11010.7228 24188.6673   120%     -  644s
H    0     0                    11117.104727 24188.4997   118%     -  644s
H    0     0                    11169.818036 24188.4997   117%     -  644s
     0     0 23925.7177    0  462 11169.8180 23925.7177   114%     -  668s
     0     0 23877.8682    0  449 11169.8180 23877.8682   114%     -  679s
     0     0 23826.9090    0  474 11169.8180 23826.9090   113%     -  689s
     0     0 23804.4244    0  480 11169.8180 23804.4244   113%     -  698s
     0     0 23799.3751    0  485 11169.8180 23799.3751   113%     -  702s
     0     0 23766.7325    0  473 11169.8180 23766.7325   113%     -  712s
     0     0 23741.4392    0  520 11169.8180 23741.4392   113%     -  720s
     0     0 23730.0264    0  524 11169.8180 23730.0264   112%     -  725s
     0     0 23723.7943    0  526 11169.8180 23723.7943   112%     -  731s
     0     0 23712.0920    0  526 11169.8180 23712.0920   112%     -  739s
     0     0 23704.3378    0  526 11169.8180 23704.3378   112%     -  747s
     0     0 23700.3642    0  536 11169.8180 23700.3642   112%     -  750s
     0     0 23696.3411    0  541 11169.8180 23696.3411   112%     -  754s
     0     0 23693.6111    0  536 11169.8180 23693.6111   112%     -  757s
     0     0 23691.3820    0  529 11169.8180 23691.3820   112%     -  760s
     0     0 23502.6046    0  459 11169.8180 23502.6046   110%     -  790s
     0     0 23456.4846    0  477 11169.8180 23456.4846   110%     -  805s
     0     0 23445.4257    0  480 11169.8180 23445.4257   110%     -  814s
     0     0 23428.0863    0  458 11169.8180 23428.0863   110%     -  822s
     0     0 23423.0933    0  465 11169.8180 23423.0933   110%     -  828s
     0     0 23393.2526    0  448 11169.8180 23393.2526   109%     -  838s
     0     0 23379.6745    0  448 11169.8180 23379.6745   109%     -  846s
     0     0 23374.5764    0  453 11169.8180 23374.5764   109%     -  851s
     0     0 23372.9220    0  466 11169.8180 23372.9220   109%     -  854s
     0     0 23292.5321    0  484 11169.8180 23292.5321   109%     -  873s
     0     0 23269.1586    0  531 11169.8180 23269.1586   108%     -  886s
     0     0 23250.3857    0  495 11169.8180 23250.3857   108%     -  894s
     0     0 23247.4829    0  503 11169.8180 23247.4829   108%     -  898s
     0     0 23247.0404    0  500 11169.8180 23247.0404   108%     -  899s
     0     0 23233.3218    0  384 11169.8180 23233.3218   108%     -  908s
     0     0 23226.7666    0  387 11169.8180 23226.7666   108%     -  914s
     0     0 23223.6600    0  496 11169.8180 23223.6600   108%     -  918s
     0     0 23222.2255    0  495 11169.8180 23222.2255   108%     -  920s
     0     0 23209.7910    0  495 11169.8180 23209.7910   108%     -  928s
     0     0 23206.9205    0  383 11169.8180 23206.9205   108%     -  931s
     0     0 23205.2749    0  451 11169.8180 23205.2749   108%     -  934s
     0     0 23198.2243    0  494 11169.8180 23198.2243   108%     -  940s
     0     0 23196.6618    0  434 11169.8180 23196.6618   108%     -  944s
     0     0 23193.6364    0  436 11169.8180 23193.6364   108%     -  948s
     0     0 23193.4617    0  436 11169.8180 23193.4617   108%     -  953s
H    0     0                    11183.864027 23193.4617   107%     -  985s
H    0     0                    11187.269765 23193.4617   107%     -  985s
H    0     0                    11227.701836 23193.4617   107%     - 1038s
H    0     0                    11244.325823 23193.4617   106%     - 1038s
H    0     0                    11564.693739 23193.4617   101%     - 1040s
H    0     0                    11578.393074 23193.4617   100%     - 1042s
H    0     2                    12276.901843 23193.4617  88.9%     - 1046s
     0     2 23193.4617    0  436 12276.9018 23193.4617  88.9%     - 1046s
     1     3 22835.6918    1  371 12276.9018 23192.0603  88.9% 12882 1061s
     2     5 22690.9671    2  369 12276.9018 23192.0603  88.9% 11052 1078s
     4     9 22659.0503    2  491 12276.9018 22843.8756  86.1% 13388 1103s
     8    17 22521.9265    3  499 12276.9018 22843.8756  86.1% 13914 1138s
    16    34 22480.3611    4  523 12276.9018 22655.6899  84.5% 14303 1167s
    33    49 21987.2459    4  388 12276.9018 22493.2430  83.2% 19714 1264s
    48    79 19589.5543    7  303 12276.9018 22493.2430  83.2% 21374 1367s
H   78   180                    12520.606140 22493.2430  79.6% 17379 1433s
H   87   180                    12686.058639 22493.2430  77.3% 16388 1433s
H  115   180                    12741.119115 22493.2430  76.5% 13402 1433s
   179   224 19315.1308   13  283 12741.1191 22493.2430  76.5% 11944 1481s
   223   267 15138.5570   15  296 12741.1191 22493.2430  76.5% 11093 1515s
   266   319 14874.4094   16  280 12741.1191 22493.2430  76.5% 11081 1548s
   323   343 14347.0033   17  281 12741.1191 22493.2430  76.5% 11055 1580s
   348   369 14108.0508   18  297 12741.1191 22493.2430  76.5% 11507 1608s
   378   392 13846.5399   19  283 12741.1191 22493.2430  76.5% 11495 1641s
   411   439 13807.0461   20  274 12741.1191 22493.2430  76.5% 11633 1667s
   464   499 13770.5220   21  275 12741.1191 22493.2430  76.5% 11141 1692s
   533   558 13130.0830   23  262 12741.1191 22493.2430  76.5% 10564 1718s
   610   607     cutoff   24      12741.1191 22493.2430  76.5% 10004 1745s
   680   661 infeasible   23      12741.1191 22493.2430  76.5%  9447 1769s
   748   687 15160.1758   14  198 12741.1191 22493.2430  76.5%  9102 1791s
   816   720 14818.6172   17  160 12741.1191 22493.2430  76.5%  8924 1815s
   893   730 14217.6599   23   86 12741.1191 22493.2430  76.5%  8623 1839s
   963   735 13199.8618   28   64 12741.1191 22493.2430  76.5%  8391 1867s
  1035   745     cutoff   33      12741.1191 22493.2430  76.5%  8300 1895s
  1092   749 17742.5906   11  233 12741.1191 22493.2430  76.5%  8435 1924s
  1156   750 13235.4449   18  131 12741.1191 22493.2430  76.5%  8572 1955s
  1202   770 infeasible   19      12741.1191 22493.2430  76.5%  8720 1991s
  1230   810 18132.3356   12  477 12741.1191 22493.2430  76.5%  9065 2023s
  1278   845 18008.7957   13  470 12741.1191 22493.2430  76.5%  9371 2059s
  1343   892 17500.0337   14  407 12741.1191 22493.2430  76.5%  9472 2091s
  1427   957 17096.5430   16  376 12741.1191 22493.2430  76.5%  9437 2125s
  1520   996 16588.0826   20  314 12741.1191 22493.2430  76.5%  9421 2163s
  1612  1072 16122.4644   22  410 12741.1191 22493.2430  76.5%  9451 2203s
  1718  1125 15663.2460   26  412 12741.1191 22493.2430  76.5%  9490 2240s
  1836  1234 14861.2557   30  333 12741.1191 22493.2430  76.5%  9451 2286s
H 1902  1234                    12936.838287 22493.2430  73.9%  9411 2286s
  1977  1274 13953.3940   34  317 12936.8383 22493.2430  73.9%  9330 2327s
  2129  1348 13632.6937   36  320 12936.8383 22493.2430  73.9%  9164 2370s
  2283  1501 13088.7345   39  305 12936.8383 22493.2430  73.9%  9077 2415s
  2512  1531 20091.3857    8  288 12936.8383 22493.2430  73.9%  8772 2463s
  2694  1595 18818.7056    9  221 12936.8383 22493.2430  73.9%  8619 2514s
  2828  1657 14311.3187   11  140 12936.8383 22493.2430  73.9%  8694 2567s
  2962  1698 infeasible   13      12936.8383 22493.2430  73.9%  8819 2616s
  3056  1744 infeasible   14      12936.8383 22493.2430  73.9%  8818 2672s
  3205  1764 19809.5398    9  285 12936.8383 22493.2430  73.9%  8834 2729s
  3356  1803 14367.9083   11  214 12936.8383 22493.2430  73.9%  8941 2789s
  3488  1843 infeasible   13      12936.8383 22493.2430  73.9%  9027 2849s
  3633  1891 infeasible   12      12936.8383 22177.3824  71.4%  9109 2919s
  3747  1928 infeasible   12      12936.8383 22177.3824  71.4%  9270 2989s
  3881  1972 14339.7466   12  234 12936.8383 22177.3824  71.4%  9456 3064s
  4035  2036 13470.5219   44  186 12936.8383 21894.6662  69.2%  9616 3138s
  4197  2056 16636.9483    7  459 12936.8383 21894.6662  69.2%  9743 3197s
  4239  2077 15553.7976    8  451 12936.8383 21894.6662  69.2%  9846 3262s
H 4293  2073                    12962.127751 20888.1734  61.1%  9898 3262s
  4316  2154 14259.4630    9  413 12962.1278 20888.1734  61.1%  9949 3337s
  4505  2234     cutoff   10      12962.1278 20888.1734  61.1% 10031 3414s
  4719  2299 13726.9326   50  163 12962.1278 20431.4606  57.6% 10031 3501s
  4938  2349     cutoff   10      12962.1278 20368.4615  57.1% 10065 3590s
  5128  2332     cutoff   17      12962.1278 20368.4615  57.1% 10209 3600s

Cutting planes:
  Learned: 1
  Gomory: 4
  Lift-and-project: 2
  Implied bound: 272
  MIR: 4694
  Flow cover: 3994
  RLT: 81
  Relax-and-lift: 694

Explored 5173 nodes (53343718 simplex iterations) in 3600.06 seconds (9478.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12962.1 12936.8 12741.1 ... 11227.7

Time limit reached
Best objective 1.296212775124e+04, best bound 2.036846151728e+04, gap 57.1383%
  WARNING: Time limit reached. Using best solution found (gap: 57.14%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 12962.13, θ = 155747.53
  Upper Bound (UB) = 12962.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155747.53
  [DEBUG]   ✓ Scenario 0: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 155747.53 ≤ Q = 156179.25 (slack: 431.72)
  [DEBUG]   ✓ Scenario 3: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 155747.53 ≤ Q = 156600.06 (slack: 852.53)
  [DEBUG]   ✓ Scenario 14: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 155747.53 ≤ Q = 155747.53 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x36946696
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc96b996a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-13, 2e+02]
Found heuristic solution: objective 1.275815e+13
Presolve removed 2557 rows and 1848 columns
Presolve time: 0.00s
Presolved: 536 rows, 541 columns, 1513 nonzeros
Found heuristic solution: objective 6748762.2425
Variable types: 366 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6748414.7570

Root relaxation: objective -1.447721e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144772.07    0  122 6748414.76 -144772.07   102%     -    0s
H    0     0                    -97235.35430 -144772.07  48.9%     -    0s
H    0     0                    -97642.41418 -144772.07  48.3%     -    0s
H    0     0                    -108248.4618 -144772.07  33.7%     -    0s
     0     0 -116348.31    0   96 -108248.46 -116348.31  7.48%     -    0s
H    0     0                    -111097.7747 -116295.75  4.68%     -    0s
H    0     0                    -111679.6627 -116295.75  4.13%     -    0s
H    0     0                    -112556.6895 -116295.75  3.32%     -    0s
H    0     0                    -113138.5774 -116295.75  2.79%     -    0s
     0     0 -115130.79    0   60 -113138.58 -115130.79  1.76%     -    0s
H    0     0                    -114240.9501 -115112.48  0.76%     -    0s
H    0     0                    -114550.8581 -115112.48  0.49%     -    0s
     0     0 -114920.81    0   30 -114550.86 -114920.81  0.32%     -    0s
     0     0 -114867.58    0   42 -114550.86 -114867.58  0.28%     -    0s
     0     0 -114782.72    0   23 -114550.86 -114782.72  0.20%     -    0s
     0     0 -114764.35    0   19 -114550.86 -114764.35  0.19%     -    0s
     0     0 -114762.96    0   18 -114550.86 -114762.96  0.19%     -    0s
     0     0 -114721.61    0   15 -114550.86 -114721.61  0.15%     -    0s
     0     0 -114677.57    0   14 -114550.86 -114677.57  0.11%     -    0s
     0     0 -114677.57    0   48 -114550.86 -114677.57  0.11%     -    0s
H    0     0                    -114560.5054 -114677.57  0.10%     -    0s
     0     0 -114646.49    0   47 -114560.51 -114646.49  0.08%     -    0s
     0     0 -114628.85    0   13 -114560.51 -114628.85  0.06%     -    0s
     0     0 -114626.94    0   13 -114560.51 -114626.94  0.06%     -    0s
*    0     0               0    -114592.7012 -114592.70  0.00%     -    0s

Cutting planes:
  Gomory: 26
  Implied bound: 7
  MIR: 60
  Flow cover: 11

Explored 1 nodes (815 simplex iterations) in 0.12 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -114593 -114561 -114551 ... -97642.4
No other solutions better than -114593

Optimal solution found (tolerance 1.00e-06)
Best objective -1.145927012316e+05, best bound -1.145927012316e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 152567.81
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114592.70
  [DEBUG]   S×d_nominal = 267160.51
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267160.51 + -114592.70 = 152567.81
  [DEBUG]   Current θ from Master = 155747.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3179.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9782.41
  Lower Bound (LB) = 12201.28
  Gap (UB-LB) = 760.8430, Absolute Gap = 760.8430, Relative Gap = 0.058697
  Not converged yet (gap = 760.84 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870619 nonzeros
Model fingerprint: 0x7ce65815
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 125240 rows and 50840 columns
Presolve time: 3.54s
Presolved: 181943 rows, 76220 columns, 1116993 nonzeros
Variable types: 73961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.72s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 1.026e+07
 Factor NZ  : 2.306e+07 (roughly 300 MB of memory)
 Factor Ops : 6.170e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70883632e+07  2.93361948e+08  1.05e+05 1.98e+01  7.10e+04     7s
   1  -1.32363924e+07  2.54557700e+08  7.38e+04 6.37e+01  4.92e+04     7s
   2  -5.29194672e+06  2.05113964e+08  2.86e+04 6.12e-01  2.00e+04     7s
   3  -8.58441541e+05  1.50549294e+08  1.73e+03 1.49e+00  1.59e+03     8s
   4  -5.64184490e+05  4.85065282e+07  4.38e+02 1.81e-01  4.00e+02     8s
   5  -4.42005517e+05  3.66660013e+07  1.66e+02 1.22e-01  2.02e+02     8s
   6  -3.58075190e+05  2.65353055e+07  8.16e+01 8.07e-02  1.21e+02     8s
   7  -2.38160917e+05  2.05406990e+07  3.36e+01 5.90e-02  7.70e+01     8s
   8  -1.79257637e+05  1.66812947e+07  1.60e+01 4.69e-02  5.69e+01     8s
   9  -1.46216724e+05  1.25015623e+07  1.05e+01 3.39e-02  4.13e+01     8s
  10  -1.20804854e+05  7.89271937e+06  6.31e+00 2.06e-02  2.54e+01     8s
  11  -9.46755535e+04  4.29821380e+06  2.86e+00 1.08e-02  1.36e+01     8s
  12  -7.33196307e+04  1.41530681e+06  1.12e+00 3.47e-03  4.54e+00     8s
  13  -4.86476497e+04  5.90680147e+05  4.72e-01 1.50e-03  1.94e+00     8s
  14  -2.01319441e+04  2.75653450e+05  2.16e-01 1.35e-03  8.95e-01     8s
  15  -7.71421530e+03  1.72105951e+05  1.48e-01 1.68e-03  5.44e-01     9s
  16   2.79243686e+03  1.26165336e+05  1.07e-01 2.46e-03  3.73e-01     9s
  17   7.91076467e+03  1.09371827e+05  8.93e-02 1.54e-03  3.07e-01     9s
  18   1.28215473e+04  8.31892721e+04  7.28e-02 3.19e-03  2.13e-01     9s
  19   1.79277581e+04  6.75462608e+04  5.86e-02 3.15e-03  1.50e-01     9s
  20   2.00066834e+04  6.57836228e+04  5.25e-02 2.96e-03  1.39e-01     9s
  21   2.24752081e+04  5.98236038e+04  4.51e-02 2.76e-03  1.13e-01     9s
  22   2.42475768e+04  5.46580768e+04  4.01e-02 2.16e-03  9.21e-02     9s
  23   2.70112496e+04  5.27207159e+04  3.26e-02 1.99e-03  7.78e-02     9s
  24   2.86029171e+04  4.92336088e+04  2.84e-02 2.31e-03  6.25e-02     9s
  25   3.10382478e+04  4.82527355e+04  2.24e-02 2.06e-03  5.21e-02    10s
  26   3.27290437e+04  4.71803546e+04  1.83e-02 1.77e-03  4.38e-02    10s
  27   3.40308013e+04  4.62731981e+04  1.52e-02 1.54e-03  3.71e-02    10s
  28   3.53458913e+04  4.53582260e+04  1.20e-02 1.29e-03  3.03e-02    10s
  29   3.59038893e+04  4.36211372e+04  1.07e-02 8.15e-04  2.34e-02    10s
  30   3.66052747e+04  4.34503151e+04  9.16e-03 7.68e-04  2.07e-02    10s
  31   3.73039163e+04  4.30120088e+04  7.63e-03 6.44e-04  1.73e-02    10s
  32   3.77413359e+04  4.28110362e+04  6.63e-03 5.83e-04  1.54e-02    10s
  33   3.81957359e+04  4.25845702e+04  5.64e-03 5.17e-04  1.33e-02    10s
  34   3.85022835e+04  4.25068893e+04  4.96e-03 4.94e-04  1.21e-02    11s
  35   3.88293445e+04  4.23129534e+04  4.21e-03 4.37e-04  1.05e-02    11s
  36   3.90707773e+04  4.19954517e+04  3.66e-03 3.57e-04  8.86e-03    11s
  37   3.93712656e+04  4.17014782e+04  2.96e-03 2.67e-04  7.06e-03    11s
  38   3.97229388e+04  4.16023290e+04  2.20e-03 2.38e-04  5.69e-03    11s
  39   3.98192176e+04  4.14721501e+04  2.01e-03 1.99e-04  5.00e-03    11s
  40   4.01780893e+04  4.11392835e+04  1.27e-03 9.27e-05  2.91e-03    11s
  41   4.03164469e+04  4.10332011e+04  9.87e-04 6.11e-05  2.17e-03    11s
  42   4.04268895e+04  4.10012418e+04  7.65e-04 5.10e-05  1.74e-03    11s
  43   4.05891409e+04  4.09700876e+04  4.44e-04 4.18e-05  1.15e-03    12s
  44   4.06201307e+04  4.09290770e+04  3.83e-04 2.93e-05  9.35e-04    12s
  45   4.06665827e+04  4.08709180e+04  2.93e-04 1.27e-05  6.19e-04    12s
  46   4.06999050e+04  4.08492577e+04  2.30e-04 6.72e-06  4.53e-04    12s
  47   4.07133239e+04  4.08431965e+04  2.05e-04 4.89e-06  3.94e-04    12s
  48   4.07577449e+04  4.08390141e+04  1.24e-04 7.53e-06  2.46e-04    12s
  49   4.08117935e+04  4.08313044e+04  1.92e-05 1.10e-05  5.90e-05    12s
  50   4.08236214e+04  4.08274543e+04  2.61e-06 2.61e-06  1.16e-05    12s
  51   4.08257574e+04  4.08264454e+04  3.35e-07 6.64e-07  2.08e-06    13s
  52   4.08260235e+04  4.08261167e+04  8.10e-08 3.72e-08  2.82e-07    13s
  53   4.08260950e+04  4.08260951e+04  4.62e-10 1.31e-09  1.73e-10    13s

Barrier solved model in 53 iterations and 12.69 seconds (20.60 work units)
Optimal objective 4.08260950e+04


Root crossover log...

  157653 DPushes remaining with DInf 0.0000000e+00                13s
   32804 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    5473 PPushes remaining with PInf 3.9137666e-05                18s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.4945892e+00     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72276    4.0826095e+04   0.000000e+00   3.494589e+00     19s
   72312    4.0826095e+04   0.000000e+00   0.000000e+00     19s
   72312    4.0826095e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 0.63s

Solved with barrier

Root relaxation: objective 4.082610e+04, 72312 iterations, 15.16 seconds (30.62 work units)
Total elapsed time = 20.02s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40826.0951    0  244 -233197.24 40826.0951   118%     -   20s
H    0     0                    -213862.9945 40826.0951   119%     -   21s
H    0     0                    -188386.1598 40826.0951   122%     -   22s
H    0     0                    -167395.8997 40826.0951   124%     -   23s
H    0     0                    -155086.0799 40826.0951   126%     -   24s
H    0     0                    -155083.0185 40826.0951   126%     -   24s
H    0     0                    -155080.0043 40826.0951   126%     -   24s
H    0     0                    -154924.9433 40826.0951   126%     -   25s
H    0     0                    -154024.4127 40826.0951   127%     -   25s
H    0     0                    -46371.28599 40826.0951   188%     -   25s
H    0     0                    -34139.10192 40826.0951   220%     -   25s
H    0     0                    -30093.61430 40826.0951   236%     -   25s
H    0     0                    -29772.53337 40826.0951   237%     -   26s
     0     0 33885.7309    0  257 -29772.533 33885.7309   214%     -   99s
H    0     0                    2056.9598823 33885.3178  1547%     -  100s
H    0     0                    2234.6072840 33885.3178  1416%     -  100s
H    0     0                    2945.0679067 33885.3178  1051%     -  100s
     0     0 33253.3919    0  265 2945.06791 33253.3919  1029%     -  127s
     0     0 33245.7404    0  269 2945.06791 33245.7404  1029%     -  135s
     0     0 33242.9406    0  273 2945.06791 33242.9406  1029%     -  139s
     0     0 33234.9119    0  273 2945.06791 33234.9119  1028%     -  144s
     0     0 33231.5728    0  278 2945.06791 33231.5728  1028%     -  145s
     0     0 33231.5728    0  278 2945.06791 33231.5728  1028%     -  146s
     0     0 29932.9460    0  353 2945.06791 29932.9460   916%     -  199s
H    0     0                    6714.6134157 29932.6939   346%     -  200s
     0     0 29204.9225    0  363 6714.61342 29204.9225   335%     -  236s
     0     0 28928.0433    0  357 6714.61342 28928.0433   331%     -  265s
     0     0 28885.2460    0  370 6714.61342 28885.2460   330%     -  276s
     0     0 28824.2556    0  365 6714.61342 28824.2556   329%     -  284s
     0     0 28813.8380    0  363 6714.61342 28813.8380   329%     -  287s
     0     0 28787.4595    0  370 6714.61342 28787.4595   329%     -  294s
     0     0 28787.0820    0  371 6714.61342 28787.0820   329%     -  296s
     0     0 25728.0965    0  355 6714.61342 25728.0965   283%     -  387s
H    0     0                    6784.1475965 25727.9384   279%     -  388s
H    0     0                    6868.5385479 25727.9384   275%     -  388s
H    0     0                    7217.4551478 25727.9384   256%     -  388s
     0     0 25190.2500    0  413 7217.45515 25190.2500   249%     -  428s
     0     0 25006.4312    0  406 7217.45515 25006.4312   246%     -  458s
     0     0 24902.6838    0  371 7217.45515 24902.6838   245%     -  479s
     0     0 24794.9389    0  424 7217.45515 24794.9389   244%     -  508s
     0     0 24761.4215    0  384 7217.45515 24761.4215   243%     -  522s
     0     0 24739.5458    0  375 7217.45515 24739.5458   243%     -  537s
     0     0 24728.9214    0  383 7217.45515 24728.9214   243%     -  546s
     0     0 24726.4977    0  386 7217.45515 24726.4977   243%     -  551s
     0     0 24716.1560    0  388 7217.45515 24716.1560   242%     -  557s
     0     0 24712.6705    0  388 7217.45515 24712.6705   242%     -  560s
     0     0 24712.2655    0  388 7217.45515 24712.2655   242%     -  563s
     0     0 23792.2554    0  515 7217.45515 23792.2554   230%     -  642s
H    0     0                    7856.3118748 23791.8251   203%     -  643s
     0     0 23569.4759    0  511 7856.31187 23569.4759   200%     -  677s
     0     0 23516.3028    0  533 7856.31187 23516.3028   199%     -  697s
     0     0 23473.9867    0  518 7856.31187 23473.9867   199%     -  709s
     0     0 23451.5023    0  542 7856.31187 23451.5023   199%     -  720s
     0     0 23443.6510    0  539 7856.31187 23443.6510   198%     -  728s
     0     0 23435.9432    0  528 7856.31187 23435.9432   198%     -  734s
     0     0 23434.0351    0  527 7856.31187 23434.0351   198%     -  738s
     0     0 23328.3980    0  479 7856.31187 23328.3980   197%     -  762s
     0     0 23300.1170    0  490 7856.31187 23300.1170   197%     -  774s
     0     0 23294.9306    0  499 7856.31187 23294.9306   197%     -  780s
     0     0 23292.8424    0  489 7856.31187 23292.8424   196%     -  784s
     0     0 23265.0082    0  436 7856.31187 23265.0082   196%     -  798s
H    0     0                    8888.7532748 23264.9769   162%     -  813s
H    0     0                    8935.4014787 23264.9769   160%     -  814s
H    0     0                    8972.4272694 23264.9769   159%     -  814s
H    0     0                    9495.1834545 23264.9769   145%     -  816s
H    0     0                    10875.341089 23264.9769   114%     -  816s
H    0     0                    10989.562516 23264.9769   112%     -  816s
H    0     0                    11797.255323 23264.9769  97.2%     -  816s
     0     0 23250.7747    0  457 11797.2553 23250.7747  97.1%     -  826s
     0     0 23239.9202    0  438 11797.2553 23239.9202  97.0%     -  835s
     0     0 23235.7731    0  443 11797.2553 23235.7731  97.0%     -  840s
     0     0 23233.1787    0  451 11797.2553 23233.1787  96.9%     -  846s
     0     0 23223.2219    0  477 11797.2553 23223.2219  96.9%     -  857s
H    0     0                    12518.331342 23223.1060  85.5%     -  858s
H    0     0                    12542.404383 23223.1060  85.2%     -  858s
     0     0 23218.7213    0  487 12542.4044 23218.7213  85.1%     -  864s
     0     0 23214.8177    0  534 12542.4044 23214.8177  85.1%     -  867s
     0     0 23213.8892    0  487 12542.4044 23213.8892  85.1%     -  870s
     0     0 23210.0011    0  526 12542.4044 23210.0011  85.1%     -  879s
H    0     0                    12561.490359 23209.8723  84.8%     -  881s
H    0     0                    12686.058639 23209.8723  83.0%     -  881s
     0     0 23202.1618    0  482 12686.0586 23202.1618  82.9%     -  890s
     0     0 23201.3461    0  375 12686.0586 23201.3461  82.9%     -  894s
     0     0 23197.2713    0  491 12686.0586 23197.2713  82.9%     -  901s
H    0     0                    12741.119115 23197.2393  82.1%     -  902s
     0     0 23192.7504    0  486 12741.1191 23192.7504  82.0%     -  909s
     0     0 23190.8875    0  539 12741.1191 23190.8875  82.0%     -  912s
     0     0 23185.3954    0  446 12741.1191 23185.3954  82.0%     -  920s
     0     0 23185.1003    0  446 12741.1191 23185.1003  82.0%     -  926s
     0     2 23184.8980    0  446 12741.1191 23184.8980  82.0%     - 1152s
     1     4 23174.9947    1  433 12741.1191 23184.8347  82.0%  7356 1174s
     3     8 23015.1254    2  237 12741.1191 23174.4327  81.9% 12632 1203s
     7    15 22612.5532    3  456 12741.1191 23015.1107  80.6% 16341 1281s
    14    30 22212.2217    4  508 12741.1191 22612.5224  77.5% 22942 1310s
    29    45 21551.2362    5  456 12741.1191 22439.3737  76.1% 24084 1400s
    44    77 21352.0881    6  382 12741.1191 22439.3737  76.1% 28450 1575s
    76   172 21117.7663    7  303 12741.1191 22211.4523  74.3% 24264 1667s
   171   202 20864.3416   11  283 12741.1191 22211.4523  74.3% 15824 1702s
   201   229 20112.6475   10  439 12741.1191 22211.4523  74.3% 14490 1736s
   228   255 20850.8503   12  283 12741.1191 22211.4523  74.3% 13610 1771s
   254   284 19605.8142   11  395 12741.1191 22211.4523  74.3% 13057 1805s
   283   320 20637.9291   13  351 12741.1191 22211.4523  74.3% 12922 1840s
   319   352 20531.6185   14  349 12741.1191 22211.4523  74.3% 13071 1876s
   353   384 20513.1652   15  348 12741.1191 22211.4523  74.3% 12722 1918s
   396   399 19553.3732   16  347 12741.1191 22211.4523  74.3% 12417 1962s
   419   423 19886.2655   12  383 12741.1191 22211.4523  74.3% 12563 1998s
   457   447 14511.3312   17  161 12741.1191 22211.4523  74.3% 13000 2041s
   499   473 14445.8969   18  170 12741.1191 22211.4523  74.3% 13039 2086s
   550   492 infeasible   19      12741.1191 22211.4523  74.3% 13160 2130s
   599   514 17274.8028   10  358 12741.1191 22211.4523  74.3% 13160 2173s
   655   530 16849.2677   11  404 12741.1191 22211.4523  74.3% 12999 2221s
   688   547 16566.2212   12  403 12741.1191 22211.4523  74.3% 13009 2261s
   723   570     cutoff   12      12741.1191 22211.4523  74.3% 13088 2302s
   768   590 infeasible   11      12741.1191 22211.4523  74.3% 13064 2339s
   819   612 19170.4036   11  327 12741.1191 22211.4523  74.3% 12873 2379s
   873   648 19065.6602   12  325 12741.1191 22211.4523  74.3% 12619 2418s
   949   680 18986.8457   13  327 12741.1191 22211.4523  74.3% 12400 2460s
  1021   728 18762.6086   15  334 12741.1191 22211.4523  74.3% 12300 2506s
  1094   768 18563.8110   18  336 12741.1191 22211.4523  74.3% 12207 2552s
  1188   820 16536.8205   21  303 12741.1191 22211.4523  74.3% 12066 2599s
  1278   895 15761.8590   23  285 12741.1191 22211.4523  74.3% 11959 2649s
  1387   985 14987.5201   27  322 12741.1191 22211.4523  74.3% 11802 2703s
  1515  1053 14431.0773   32  267 12741.1191 22211.4523  74.3% 11482 2751s
  1665  1126     cutoff   41      12741.1191 22211.4523  74.3% 11117 2805s
  1823  1196 13551.9489   44  255 12741.1191 22211.4523  74.3% 10846 2863s
  1988  1277 infeasible   52      12741.1191 22211.4523  74.3% 10584 2952s
  2143  1399 19730.3204   11  302 12741.1191 22211.4523  74.3% 10388 3007s
  2356  1489 infeasible   14      12741.1191 22211.4523  74.3% 10092 3065s
  2526  1580 13471.2777   13  259 12741.1191 22211.4523  74.3%  9963 3133s
  2700  1708 12901.7249   14  200 12741.1191 22211.4523  74.3%  9858 3206s
  2904  1812 17739.6582   10  288 12741.1191 22211.4523  74.3%  9628 3269s
  3094  1883 16466.6003   11  277 12741.1191 22211.4523  74.3%  9494 3336s
  3234  1929 15355.2665   13  414 12741.1191 22211.4523  74.3%  9530 3407s
  3354  1973 14604.2408   15  420 12741.1191 22211.4523  74.3%  9654 3482s
  3472  2027 13577.6444   17  400 12741.1191 22211.4523  74.3%  9742 3560s
  3589  2087 13325.4232   19  328 12741.1191 22211.4523  74.3%  9910 3600s

Cutting planes:
  Learned: 3
  Gomory: 4
  Implied bound: 329
  MIR: 4694
  Flow cover: 4331
  RLT: 74
  Relax-and-lift: 865

Explored 3692 nodes (37178294 simplex iterations) in 3600.10 seconds (9308.92 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12741.1 12686.1 12561.5 ... 8972.43

Time limit reached
Best objective 1.274111911535e+04, best bound 2.221145231280e+04, gap 74.3289%
  WARNING: Time limit reached. Using best solution found (gap: 74.33%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 12741.12, θ = 157489.88
  Upper Bound (UB) = 12741.12

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157489.88
  [DEBUG]   ✓ Scenario 0: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157489.88 ≤ Q = 157489.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157489.88 ≤ Q = 157489.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157489.88 ≤ Q = 157489.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157489.88 ≤ Q = 157489.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 157489.88 ≤ Q = 157489.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 157489.88 ≤ Q = 157489.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 157489.88 ≤ Q = 157489.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 157489.88 ≤ Q = 157489.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 157489.88 ≤ Q = 157489.88 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1655a528
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1655a528
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-14, 2e+02]
Found heuristic solution: objective 1.286559e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.00s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6901209.0916
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.431683e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143168.29    0  123 6901209.09 -143168.29   102%     -    0s
H    0     0                    -106393.0298 -143168.29  34.6%     -    0s
H    0     0                    -107616.9596 -143168.29  33.0%     -    0s
     0     0 -110935.78    0   48 -107616.96 -110935.78  3.08%     -    0s
H    0     0                    -110546.4871 -110934.57  0.35%     -    0s
     0     0 -110727.85    0   42 -110546.49 -110727.85  0.16%     -    0s
     0     0 -110672.20    0   16 -110546.49 -110672.20  0.11%     -    0s
     0     0 -110573.18    0   12 -110546.49 -110573.18  0.02%     -    0s
     0     0 -110564.15    0    2 -110546.49 -110564.15  0.02%     -    0s
H    0     0                    -110561.8106 -110564.15  0.00%     -    0s
     0     0 -110564.05    0    2 -110561.81 -110564.05  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 146
  Flow cover: 4
  RLT: 5
  Relax-and-lift: 1
  BQP: 1

Explored 1 nodes (471 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -110562 -110546 -107617 ... 1.28656e+13
No other solutions better than -110562

Optimal solution found (tolerance 1.00e-06)
Best objective -1.105618106216e+05, best bound -1.105618106216e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 157127.81
  Scenario: 4 demand increases, 56 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110561.81
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -110561.81 = 157127.81
  [DEBUG]   Current θ from Master = 157489.88
  [DEBUG]   ⚠️  Z_SP ≤ θ by 362.07 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12379.05
  Lower Bound (LB) = 12379.05
  Gap (UB-LB) = 362.0722, Absolute Gap = 362.0722, Relative Gap = 0.028418
  Not converged yet (gap = 362.07 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 4 increases, 56 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913874 nonzeros
Model fingerprint: 0x87786503
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 131502 rows and 53382 columns
Presolve time: 4.15s
Presolved: 190971 rows, 79918 columns, 1172285 nonzeros
Variable types: 77659 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.62s

Barrier statistics:
 Dense cols : 1259
 AA' NZ     : 4.343e+06
 Factor NZ  : 1.272e+07 (roughly 200 MB of memory)
 Factor Ops : 4.650e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70942192e+07  3.05439349e+08  1.05e+05 1.94e+01  7.07e+04     8s
   1  -1.33102124e+07  2.65131621e+08  7.42e+04 6.36e+01  4.93e+04     8s
   2  -4.58315146e+06  2.13120828e+08  2.45e+04 1.06e+00  1.72e+04     8s
   3  -8.55607686e+05  1.52062402e+08  1.77e+03 3.03e+00  1.60e+03     8s
   4  -5.72168915e+05  6.27180966e+07  4.31e+02 5.80e-01  4.33e+02     8s
   5  -4.76516951e+05  4.63939190e+07  1.89e+02 3.78e-01  2.39e+02     8s
   6  -4.23343590e+05  3.37807031e+07  9.94e+01 2.55e-01  1.48e+02     8s
   7  -3.35469539e+05  2.67656954e+07  4.53e+01 1.92e-01  9.81e+01     8s
   8  -2.11044402e+05  2.21288779e+07  6.47e+00 1.54e-01  6.69e+01     8s
   9  -1.51986560e+05  1.45259658e+07  3.67e+00 1.00e-01  4.32e+01     8s
  10  -1.24084713e+05  7.46217026e+06  2.34e+00 5.10e-02  2.22e+01     9s
  11  -1.07808311e+05  5.97452412e+06  1.50e+00 4.04e-02  1.77e+01     9s
  12  -9.77460970e+04  3.87737744e+06  1.10e+00 2.57e-02  1.15e+01     9s
  13  -7.34166309e+04  2.43103596e+06  4.42e-01 1.56e-02  7.23e+00     9s
  14  -4.52916754e+04  6.66849250e+05  1.54e-01 4.02e-03  2.05e+00     9s
  15  -1.86650794e+04  3.01446108e+05  7.13e-02 1.69e-03  9.22e-01     9s
  16  -6.18405999e+03  2.03299281e+05  4.85e-02 1.61e-03  6.03e-01     9s
  17   6.22237225e+02  1.66205666e+05  3.97e-02 1.82e-03  4.77e-01     9s
  18   8.26866331e+03  1.27215591e+05  2.99e-02 1.16e-03  3.42e-01     9s
  19   1.30613803e+04  8.81107783e+04  2.43e-02 1.24e-03  2.16e-01     9s
  20   1.68708231e+04  7.54890497e+04  2.04e-02 9.46e-04  1.69e-01     9s
  21   2.03590025e+04  6.71513491e+04  1.69e-02 1.07e-03  1.35e-01    10s
  22   2.31696751e+04  6.34388394e+04  1.42e-02 9.19e-04  1.16e-01    10s
  23   2.48660136e+04  6.23073637e+04  1.26e-02 8.77e-04  1.08e-01    10s
  24   2.63123377e+04  5.54056798e+04  1.13e-02 6.07e-04  8.38e-02    10s
  25   2.90954239e+04  5.41433446e+04  8.87e-03 5.65e-04  7.21e-02    10s
  26   3.04897777e+04  5.11439228e+04  7.70e-03 4.22e-04  5.95e-02    10s
  27   3.17763974e+04  4.88693474e+04  6.67e-03 4.10e-04  4.92e-02    10s
  28   3.34154090e+04  4.82698289e+04  5.39e-03 3.84e-04  4.28e-02    10s
  29   3.45626801e+04  4.70292549e+04  4.50e-03 3.23e-04  3.59e-02    10s
  30   3.59289697e+04  4.51334178e+04  3.47e-03 2.28e-04  2.65e-02    11s
  31   3.67144722e+04  4.42902097e+04  2.89e-03 1.82e-04  2.18e-02    11s
  32   3.75650539e+04  4.37764147e+04  2.27e-03 1.55e-04  1.79e-02    11s
  33   3.78560838e+04  4.34444712e+04  2.06e-03 1.39e-04  1.61e-02    11s
  34   3.84964292e+04  4.28727414e+04  1.62e-03 1.07e-04  1.26e-02    11s
  35   3.87738203e+04  4.24868580e+04  1.43e-03 8.32e-05  1.07e-02    11s
  36   3.90683402e+04  4.21846916e+04  1.22e-03 6.75e-05  8.97e-03    11s
  37   3.95417366e+04  4.20146557e+04  8.96e-04 5.82e-05  7.12e-03    11s
  38   3.96791680e+04  4.17518191e+04  8.00e-04 4.48e-05  5.97e-03    11s
  39   4.01032664e+04  4.14849844e+04  5.26e-04 2.95e-05  3.98e-03    12s
  40   4.02048952e+04  4.13746645e+04  4.62e-04 2.36e-05  3.37e-03    12s
  41   4.02733618e+04  4.13502543e+04  4.19e-04 2.22e-05  3.10e-03    12s
  42   4.04782626e+04  4.12936624e+04  2.86e-04 1.91e-05  2.35e-03    12s
  43   4.05694356e+04  4.11750843e+04  2.27e-04 1.30e-05  1.74e-03    12s
  44   4.06526645e+04  4.11137910e+04  1.74e-04 1.22e-05  1.33e-03    12s
  45   4.07010826e+04  4.10684197e+04  1.44e-04 9.43e-06  1.06e-03    12s
  46   4.07510399e+04  4.10369482e+04  1.13e-04 7.05e-06  8.23e-04    12s
  47   4.07845381e+04  4.10190232e+04  9.14e-05 5.80e-06  6.75e-04    13s
  48   4.08711829e+04  4.09951435e+04  3.76e-05 4.06e-06  3.57e-04    13s
  49   4.08955502e+04  4.09831508e+04  2.29e-05 3.22e-06  2.52e-04    13s
  50   4.09092953e+04  4.09579071e+04  1.52e-05 1.35e-06  1.40e-04    13s
  51   4.09281973e+04  4.09479998e+04  4.95e-06 6.52e-07  5.70e-05    13s
  52   4.09318629e+04  4.09461682e+04  3.15e-06 5.25e-07  4.12e-05    13s
  53   4.09342852e+04  4.09407860e+04  1.96e-06 1.52e-07  1.87e-05    13s
  54   4.09362010e+04  4.09394553e+04  9.98e-07 7.44e-08  9.37e-06    13s
  55   4.09380852e+04  4.09384705e+04  7.78e-08 2.17e-08  1.11e-06    13s
  56   4.09382843e+04  4.09383352e+04  1.06e-08 2.39e-09  1.47e-07    13s
  57   4.09383181e+04  4.09383189e+04  4.19e-08 9.97e-09  2.29e-09    14s
  58   4.09383184e+04  4.09383189e+04  3.57e-06 3.77e-08  1.59e-09    14s
  59   4.09383185e+04  4.09383189e+04  4.14e-06 1.34e-07  4.71e-10    14s

Barrier solved model in 59 iterations and 13.70 seconds (20.20 work units)
Optimal objective 4.09383185e+04


Root crossover log...

  165360 DPushes remaining with DInf 0.0000000e+00                14s
   78959 DPushes remaining with DInf 0.0000000e+00                15s
    8609 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

   12811 PPushes remaining with PInf 1.4461731e-04                22s
       0 PPushes remaining with PInf 0.0000000e+00                23s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1216738e+03     23s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   88964    4.0938319e+04   0.000000e+00   1.121674e+03     24s
   89109    4.0938319e+04   0.000000e+00   0.000000e+00     24s
   89109    4.0938319e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 4.62s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.093832e+04, 89109 iterations, 23.35 seconds (40.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40938.3189    0  251 -233197.24 40938.3189   118%     -   29s
H    0     0                    -186793.2592 40938.3189   122%     -   31s
H    0     0                    -186126.9338 40938.3189   122%     -   31s
H    0     0                    -58251.44252 40938.3189   170%     -   31s
H    0     0                    -25268.33310 40938.3189   262%     -   31s
H    0     0                     339.5804779 40938.3189      -     -   31s
H    0     0                    2379.2896532 40938.3189  1621%     -   32s
H    0     0                    3050.7895119 40938.3189  1242%     -   32s
H    0     0                    3134.0717504 40938.3189  1206%     -   32s
H    0     0                    6530.8201653 40938.3189   527%     -   32s
H    0     0                    6544.5150702 40938.3189   526%     -   32s
     0     0 33979.2760    0  239 6544.51507 33979.2760   419%     -  127s
H    0     0                    7963.4072058 33975.4307   327%     -  128s
H    0     0                    9700.6177896 33975.4307   250%     -  129s
H    0     0                    10056.588698 33975.4307   238%     -  129s
H    0     0                    10090.103899 33975.4307   237%     -  129s
H    0     0                    10171.565278 33975.4307   234%     -  129s
     0     0 33261.3019    0  231 10171.5653 33261.3019   227%     -  168s
     0     0 33213.5387    0  240 10171.5653 33213.5387   227%     -  176s
     0     0 33134.4938    0  247 10171.5653 33134.4938   226%     -  191s
     0     0 33119.5915    0  288 10171.5653 33119.5915   226%     -  199s
     0     0 33070.5164    0  259 10171.5653 33070.5164   225%     -  207s
     0     0 33068.9324    0  257 10171.5653 33068.9324   225%     -  210s
     0     0 33067.4530    0  309 10171.5653 33067.4530   225%     -  212s
     0     0 33066.8678    0  309 10171.5653 33066.8678   225%     -  213s
     0     0 29478.1492    0  360 10171.5653 29478.1492   190%     -  295s
H    0     0                    10190.598345 29478.0805   189%     -  296s
     0     0 29083.0222    0  377 10190.5983 29083.0222   185%     -  330s
     0     0 28863.1720    0  407 10190.5983 28863.1720   183%     -  361s
     0     0 28769.3009    0  408 10190.5983 28769.3009   182%     -  384s
     0     0 28698.4855    0  415 10190.5983 28698.4855   182%     -  399s
     0     0 28650.7461    0  414 10190.5983 28650.7461   181%     -  413s
     0     0 28616.0114    0  449 10190.5983 28616.0114   181%     -  430s
     0     0 28595.0636    0  448 10190.5983 28595.0636   181%     -  445s
     0     0 28592.6427    0  453 10190.5983 28592.6427   181%     -  450s
     0     0 28586.0059    0  422 10190.5983 28586.0059   181%     -  459s
     0     0 28580.8941    0  455 10190.5983 28580.8941   180%     -  467s
     0     0 28517.3366    0  420 10190.5983 28517.3366   180%     -  485s
     0     0 28506.8899    0  429 10190.5983 28506.8899   180%     -  493s
     0     0 28499.2602    0  429 10190.5983 28499.2602   180%     -  498s
     0     0 28498.6339    0  433 10190.5983 28498.6339   180%     -  501s
     0     0 25949.7741    0  343 10190.5983 25949.7741   155%     -  589s
H    0     0                    10242.761851 25948.9162   153%     -  590s
H    0     0                    10248.911675 25948.9162   153%     -  591s
H    0     0                    10354.719297 25948.9162   151%     -  591s
     0     0 25494.2212    0  285 10354.7193 25494.2212   146%     -  629s
     0     0 25308.2885    0  424 10354.7193 25308.2885   144%     -  674s
     0     0 25250.3934    0  310 10354.7193 25250.3934   144%     -  699s
     0     0 25182.7692    0  369 10354.7193 25182.7692   143%     -  725s
     0     0 25161.5488    0  435 10354.7193 25161.5488   143%     -  736s
     0     0 25150.9613    0  438 10354.7193 25150.9613   143%     -  743s
     0     0 25129.3006    0  437 10354.7193 25129.3006   143%     -  755s
     0     0 25126.7698    0  444 10354.7193 25126.7698   143%     -  761s
     0     0 25124.9768    0  438 10354.7193 25124.9768   143%     -  764s
     0     0 24109.6540    0  461 10354.7193 24109.6540   133%     -  847s
H    0     0                    10388.229309 24107.0075   132%     -  848s
H    0     0                    10440.740246 24107.0075   131%     -  848s
     0     0 23998.6007    0  473 10440.7402 23998.6007   130%     -  870s
     0     0 23971.0568    0  471 10440.7402 23971.0568   130%     -  882s
     0     0 23913.6730    0  482 10440.7402 23913.6730   129%     -  897s
     0     0 23892.9833    0  377 10440.7402 23892.9833   129%     -  909s
     0     0 23872.7912    0  426 10440.7402 23872.7912   129%     -  921s
     0     0 23857.8730    0  428 10440.7402 23857.8730   129%     -  937s
     0     0 23763.4054    0  409 10440.7402 23763.4054   128%     -  953s
     0     0 23754.5429    0  479 10440.7402 23754.5429   128%     -  962s
     0     0 23731.0229    0  489 10440.7402 23731.0229   127%     -  971s
     0     0 23686.9827    0  433 10440.7402 23686.9827   127%     -  984s
     0     0 23666.2287    0  482 10440.7402 23666.2287   127%     -  993s
     0     0 23658.1652    0  484 10440.7402 23658.1652   127%     - 1011s
     0     0 23653.5101    0  488 10440.7402 23653.5101   127%     - 1015s
     0     0 23649.3121    0  485 10440.7402 23649.3121   127%     - 1019s
     0     0 23642.8655    0  488 10440.7402 23642.8655   126%     - 1022s
     0     0 23638.9847    0  490 10440.7402 23638.9847   126%     - 1028s
     0     0 23636.0401    0  488 10440.7402 23636.0401   126%     - 1034s
     0     0 23632.9613    0  450 10440.7402 23632.9613   126%     - 1037s
     0     0 23631.0344    0  491 10440.7402 23631.0344   126%     - 1042s
     0     0 23473.1019    0  388 10440.7402 23473.1019   125%     - 1074s
     0     0 23440.3596    0  422 10440.7402 23440.3596   125%     - 1088s
     0     0 23427.3056    0  387 10440.7402 23427.3056   124%     - 1095s
     0     0 23379.1774    0  426 10440.7402 23379.1774   124%     - 1111s
     0     0 23369.9937    0  386 10440.7402 23369.9937   124%     - 1119s
     0     0 23365.8862    0  429 10440.7402 23365.8862   124%     - 1124s
     0     0 23359.6449    0  433 10440.7402 23359.6449   124%     - 1129s
     0     0 23358.2126    0  436 10440.7402 23358.2126   124%     - 1131s
     0     0 23307.4928    0  507 10440.7402 23307.4928   123%     - 1154s
H    0     0                    10492.075870 23307.3716   122%     - 1156s
H    0     0                    10524.130758 23307.3716   121%     - 1156s
     0     0 23295.2504    0  435 10524.1308 23295.2504   121%     - 1166s
     0     0 23290.0120    0  448 10524.1308 23290.0120   121%     - 1175s
     0     0 23282.6698    0  429 10524.1308 23282.6698   121%     - 1182s
     0     0 23281.5572    0  432 10524.1308 23281.5572   121%     - 1187s
     0     0 23257.2837    0  430 10524.1308 23257.2837   121%     - 1203s
     0     0 23250.8562    0  381 10524.1308 23250.8562   121%     - 1211s
     0     0 23244.5827    0  444 10524.1308 23244.5827   121%     - 1217s
     0     0 23244.3573    0  445 10524.1308 23244.3573   121%     - 1220s
     0     0 23235.9319    0  474 10524.1308 23235.9319   121%     - 1233s
H    0     0                    10615.681676 23235.5344   119%     - 1234s
     0     0 23231.6891    0  521 10615.6817 23231.6891   119%     - 1241s
     0     0 23222.5236    0  519 10615.6817 23222.5236   119%     - 1250s
     0     0 23218.7876    0  456 10615.6817 23218.7876   119%     - 1255s
     0     0 23215.4435    0  465 10615.6817 23215.4435   119%     - 1260s
     0     0 23215.0826    0  465 10615.6817 23215.0826   119%     - 1261s
     0     0 23206.3303    0  446 10615.6817 23206.3303   119%     - 1274s
H    0     0                    10745.623639 23205.9564   116%     - 1275s
     0     0 23204.4157    0  450 10745.6236 23204.4157   116%     - 1280s
     0     0 23197.6229    0  476 10745.6236 23197.6229   116%     - 1293s
     0     0 23193.9972    0  630 10745.6236 23193.9972   116%     - 1303s
     0     0 23192.7138    0  532 10745.6236 23192.7138   116%     - 1307s
     0     0 23190.4568    0  562 10745.6236 23190.4568   116%     - 1316s
     0     0 23189.4263    0  520 10745.6236 23189.4263   116%     - 1320s
     0     0 23186.6451    0  509 10745.6236 23186.6451   116%     - 1329s
     0     0 23186.5997    0  509 10745.6236 23186.5997   116%     - 1337s
H    0     0                    11424.528587 23186.5997   103%     - 1481s
H    0     0                    11904.782658 23186.5997  94.8%     - 1485s
H    0     0                    12095.009039 23186.5997  91.7%     - 1490s
H    0     0                    12473.408842 23186.5997  85.9%     - 1491s
H    0     0                    12492.679855 23186.5997  85.6%     - 1491s
H    0     2                    12622.129016 23186.5997  83.7%     - 1493s
     0     2 23186.5997    0  509 12622.1290 23186.5997  83.7%     - 1493s
     1     3 22616.3233    1  294 12622.1290 23186.5997  83.7% 22890 1526s
     2     4 23061.5138    1  456 12622.1290 23061.5138  82.7% 19272 1545s
     3     5 21885.7476    2  306 12622.1290 23061.5127  82.7% 18311 1565s
     4    10 21750.8963    3  301 12622.1290 23061.5127  82.7% 17892 1586s
     9    18 21477.0896    4  295 12622.1290 22919.5254  81.6% 12010 1635s
    17    34 20992.9373    5  278 12622.1290 22919.4096  81.6% 15556 1670s
    33    48 21629.8229    5  315 12622.1290 22367.7019  77.2% 21441 1748s
    47    77 21436.2043    6  288 12622.1290 22367.7019  77.2% 22494 1814s
H   49    77                    12630.148174 22367.7019  77.1% 21834 1814s
H   58    77                    12662.551978 22367.7019  76.6% 21158 1814s
    76   175 21425.9074    7  279 12662.5520 22367.7019  76.6% 20385 1891s
   174   239 19179.7602   11  219 12662.5520 22367.7019  76.6% 13670 1930s
H  176   239                    12784.357139 22367.7019  75.0% 13573 1930s
   240   315 16098.2745   12  315 12784.3571 22367.7019  75.0% 12336 1961s
   320   371 16031.7993   13  318 12784.3571 22367.7019  75.0% 11116 1988s
H  357   371                    12789.111673 22367.7019  74.9% 10648 1988s
H  372   371                    12817.310901 22367.7019  74.5% 10398 1988s
   389   432 15788.3639   15  322 12817.3109 22367.7019  74.5% 10501 2014s
   463   479 15423.6218   17  315 12817.3109 22367.7019  74.5%  9956 2036s
   524   495 14400.2967   19  223 12817.3109 22367.7019  74.5%  9448 2063s
   602   523 14136.4258   21  195 12817.3109 22367.7019  74.5%  9035 2088s
   660   537 13369.1605   24  165 12817.3109 22367.7019  74.5%  9109 2114s
   712   556     cutoff   26      12817.3109 22367.7019  74.5%  9198 2133s
   762   574 15672.8027   26  161 12817.3109 22367.7019  74.5%  9189 2158s
   822   587 15664.3349   27  157 12817.3109 22367.7019  74.5%  9118 2181s
   878   605 15358.7359   31  133 12817.3109 22367.7019  74.5%  9019 2207s
   934   637 infeasible   35      12817.3109 22367.7019  74.5%  9041 2230s
   992   664 14225.0575   35  162 12817.3109 22367.7019  74.5%  9086 2257s
  1043   708 14188.7392   36  156 12817.3109 22367.7019  74.5%  9179 2282s
  1122   730 13785.4249   39  172 12817.3109 22367.7019  74.5%  9052 2308s
  1236   732 13607.2446   41  301 12817.3109 22367.7019  74.5%  8679 2335s
  1278   738 13577.3371   42  305 12817.3109 22367.7019  74.5%  8714 2364s
  1327   753 infeasible   42      12817.3109 22367.7019  74.5%  8630 2394s
H 1336   753                    12946.633715 22367.7019  72.8%  8586 2394s
  1381   762     cutoff   41      12946.6337 22367.7019  72.8%  8539 2427s
  1485   774 20519.3713    6  283 12946.6337 22367.7019  72.8%  8356 2465s
  1559   809 13322.9812   20   41 12946.6337 22367.7019  72.8%  8371 2498s
  1655   828 18818.9166    6  225 12946.6337 22367.7019  72.8%  8373 2532s
  1739   880 15499.8220    7  333 12946.6337 22367.7019  72.8%  8421 2570s
  1847   937 15261.0351    8  326 12946.6337 22367.7019  72.8%  8395 2606s
  1975   953 14991.3331   10  373 12946.6337 22367.7019  72.8%  8271 2641s
  2021   979 13259.7314   11  365 12946.6337 22367.7019  72.8%  8368 2680s
  2055  1005     cutoff   12      12946.6337 22367.7019  72.8%  8445 2710s
  2095  1018 18310.5022   13  248 12946.6337 22367.7019  72.8%  8473 2743s
  2138  1016 19349.8469   13  398 12946.6337 22367.7019  72.8%  8464 2785s
  2234  1024 16612.1713   14  186 12946.6337 22367.7019  72.8%  8404 2834s
  2301  1057 14687.5398   15  160 12946.6337 22367.7019  72.8%  8476 2882s
  2364  1108 14548.3691   16  161 12946.6337 22367.7019  72.8%  8687 2931s
  2446  1162 14527.3804   17  154 12946.6337 22367.7019  72.8%  8733 2978s
  2542  1208 13645.8003   19  122 12946.6337 22367.7019  72.8%  8833 3030s
  2668  1292     cutoff   19      12946.6337 22367.7019  72.8%  8883 3084s
  2783  1388 15780.6409   37  179 12946.6337 22367.7019  72.8%  8936 3146s
  2945  1447 14149.5818   45  175 12946.6337 22367.7019  72.8%  8889 3206s
  3083  1519 15326.2530   17  379 12946.6337 22367.7019  72.8%  9011 3270s
  3261  1550 14410.8053   18  375 12946.6337 22367.7019  72.8%  9008 3337s
  3361  1587 infeasible   19      12946.6337 22367.4915  72.8%  9252 3411s
  3448  1612 21943.2793    5  438 12946.6337 22153.4070  71.1%  9435 3478s
  3485  1641 21859.9815    6  387 12946.6337 22153.4070  71.1%  9560 3551s
  3556  1663 19114.5742    8  345 12946.6337 22153.4070  71.1%  9739 3600s

Cutting planes:
  Learned: 1
  Gomory: 10
  Implied bound: 360
  MIR: 4879
  Flow cover: 4645
  RLT: 70
  Relax-and-lift: 838

Explored 3592 nodes (36258362 simplex iterations) in 3600.07 seconds (9207.55 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12946.6 12817.3 12789.1 ... 12095

Time limit reached
Best objective 1.294663371541e+04, best bound 2.215340701467e+04, gap 71.1133%
  WARNING: Time limit reached. Using best solution found (gap: 71.11%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 12946.63, θ = 155861.96
  Upper Bound (UB) = 12946.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 155861.96
  [DEBUG]   ✓ Scenario 0: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 155861.96 ≤ Q = 155861.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 155861.96 ≤ Q = 155861.96 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x40ec40ca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x40ec40ca
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-14, 2e+02]
Found heuristic solution: objective 1.282009e+13
Presolve removed 2557 rows and 1848 columns
Presolve time: 0.00s
Presolved: 536 rows, 541 columns, 1513 nonzeros
Found heuristic solution: objective 6788101.3088
Variable types: 366 continuous, 175 integer (175 binary)
Found heuristic solution: objective 6787753.8233

Root relaxation: objective -1.452179e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145217.91    0  122 6787753.82 -145217.91   102%     -    0s
H    0     0                    -102363.8964 -145217.91  41.9%     -    0s
H    0     0                    -112795.9076 -145217.91  28.7%     -    0s
     0     0 -118307.41    0   66 -112795.91 -118307.41  4.89%     -    0s
H    0     0                    -114520.1726 -118199.70  3.21%     -    0s
H    0     0                    -114792.1526 -118199.70  2.97%     -    0s
H    0     0                    -115838.2836 -118199.70  2.04%     -    0s
H    0     0                    -116110.2635 -118199.70  1.80%     -    0s
H    0     0                    -116391.2313 -118199.70  1.55%     -    0s
     0     0 -117328.35    0   60 -116391.23 -117328.35  0.81%     -    0s
     0     0 -117281.42    0   60 -116391.23 -117281.42  0.76%     -    0s
     0     0 -117259.05    0   56 -116391.23 -117259.05  0.75%     -    0s
     0     0 -117029.25    0   49 -116391.23 -117029.25  0.55%     -    0s
     0     0 -116990.84    0   49 -116391.23 -116990.84  0.52%     -    0s
     0     0 -116964.88    0   48 -116391.23 -116964.88  0.49%     -    0s
     0     0 -116960.85    0   47 -116391.23 -116960.85  0.49%     -    0s
     0     0 -116925.03    0   48 -116391.23 -116925.03  0.46%     -    0s
     0     0 -116922.73    0   48 -116391.23 -116922.73  0.46%     -    0s
     0     0 -116922.64    0   94 -116391.23 -116922.64  0.46%     -    0s
     0     0 -116922.64    0   46 -116391.23 -116922.64  0.46%     -    0s
     0     0 -116849.86    0   46 -116391.23 -116849.86  0.39%     -    0s
     0     0 -116844.12    0   45 -116391.23 -116844.12  0.39%     -    0s
     0     0 -116708.47    0   29 -116391.23 -116708.47  0.27%     -    0s
H    0     0                    -116524.7192 -116708.47  0.16%     -    0s
     0     0 -116706.12    0   44 -116524.72 -116706.12  0.16%     -    0s
     0     0 -116671.07    0   31 -116524.72 -116671.07  0.13%     -    0s
     0     0 -116634.84    0   18 -116524.72 -116634.84  0.09%     -    0s
     0     0 -116634.10    0   14 -116524.72 -116634.10  0.09%     -    0s
     0     0 -116632.18    0   13 -116524.72 -116632.18  0.09%     -    0s
     0     0 -116621.76    0   10 -116524.72 -116621.76  0.08%     -    0s
     0     0 -116621.76    0   13 -116524.72 -116621.76  0.08%     -    0s
H    0     0                    -116548.7685 -116621.76  0.06%     -    0s
     0     0 -116621.76    0    9 -116548.77 -116621.76  0.06%     -    0s
H    0     0                    -116553.8208 -116620.37  0.06%     -    0s
H    0     0                    -116557.2821 -116620.37  0.05%     -    0s
H    0     0                    -116581.4587 -116608.84  0.02%     -    0s
     0     0 -116608.84    0    5 -116581.46 -116608.84  0.02%     -    0s
     0     0 -116608.56    0    5 -116581.46 -116608.56  0.02%     -    0s
*    0     0               0    -116585.9061 -116585.91  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 3
  MIR: 7
  Flow cover: 6
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (1248 simplex iterations) in 0.13 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -116586 -116581 -116557 ... -115838
No other solutions better than -116586

Optimal solution found (tolerance 1.00e-06)
Best objective -1.165859061286e+05, best bound -1.165859061286e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 151103.72
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116585.91
  [DEBUG]   S×d_nominal = 267689.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 267689.62 + -116585.91 = 151103.72
  [DEBUG]   Current θ from Master = 155861.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4758.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8188.39
  Lower Bound (LB) = 12379.05
  Gap (UB-LB) = 567.5868, Absolute Gap = 567.5868, Relative Gap = 0.043840
  Not converged yet (gap = 567.59 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 957129 nonzeros
Model fingerprint: 0x9afd3a01
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 137764 rows and 55924 columns
Presolve time: 4.09s
Presolved: 199999 rows, 83616 columns, 1227738 nonzeros
Variable types: 81357 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.53s

Barrier statistics:
 Dense cols : 1259
 AA' NZ     : 4.685e+06
 Factor NZ  : 1.376e+07 (roughly 230 MB of memory)
 Factor Ops : 5.175e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.70965350e+07  3.17368103e+08  1.05e+05 1.91e+01  7.03e+04     7s
   1  -1.31984298e+07  2.75226002e+08  7.42e+04 6.40e+01  4.93e+04     7s
   2  -5.11670635e+06  2.19624258e+08  2.80e+04 1.06e+01  1.91e+04     7s
   3  -9.04049058e+05  1.61657402e+08  1.94e+03 2.59e+00  1.69e+03     7s
   4  -6.45802484e+05  1.01861382e+08  7.18e+02 1.22e+00  7.12e+02     7s
   5  -5.48385699e+05  6.05319971e+07  3.91e+02 5.79e-01  3.82e+02     7s
   6  -4.37945907e+05  4.50028080e+07  1.32e+02 3.96e-01  1.93e+02     7s
   7  -3.91364529e+05  3.71517037e+07  7.74e+01 3.15e-01  1.40e+02     7s
   8  -2.69629761e+05  2.69352138e+07  2.16e+01 2.16e-01  8.36e+01     7s
   9  -1.89755654e+05  1.41043730e+07  8.32e+00 1.06e-01  4.15e+01     7s
  10  -1.54259097e+05  9.46574185e+06  5.75e+00 7.06e-02  2.75e+01     7s
  11  -1.28014860e+05  7.87170518e+06  3.91e+00 5.77e-02  2.26e+01     8s
  12  -1.15490643e+05  6.42668179e+06  2.66e+00 4.67e-02  1.83e+01     8s
  13  -1.04405360e+05  4.51541118e+06  1.92e+00 3.22e-02  1.29e+01     8s
  14  -7.48807928e+04  2.47339694e+06  5.07e-01 1.66e-02  7.03e+00     8s
  15  -5.16892331e+04  7.02397321e+05  1.86e-01 4.44e-03  2.08e+00     8s
  16  -2.28770935e+04  3.75227474e+05  8.14e-02 2.58e-03  1.09e+00     8s
  17  -9.88230506e+03  1.90268540e+05  5.22e-02 2.66e-03  5.50e-01     8s
  18  -3.79162346e+03  1.29895630e+05  4.42e-02 2.21e-03  3.68e-01     8s
  19   8.46675011e+03  1.02435249e+05  3.10e-02 1.57e-03  2.58e-01     8s
  20   1.08210048e+04  8.91797971e+04  2.84e-02 1.26e-03  2.16e-01     8s
  21   1.24258305e+04  8.37170590e+04  2.66e-02 1.13e-03  1.96e-01     8s
  22   1.56932351e+04  7.76019469e+04  2.30e-02 9.68e-04  1.70e-01     9s
  23   1.87675298e+04  6.61116690e+04  2.00e-02 8.40e-04  1.30e-01     9s
  24   2.28576279e+04  6.21093776e+04  1.59e-02 7.13e-04  1.08e-01     9s
  25   2.48101537e+04  5.64801186e+04  1.39e-02 5.51e-04  8.71e-02     9s
  26   2.61539306e+04  5.37380074e+04  1.26e-02 4.57e-04  7.59e-02     9s
  27   2.87692144e+04  5.17650460e+04  1.02e-02 3.87e-04  6.33e-02     9s
  28   2.96426999e+04  4.95039738e+04  9.37e-03 3.00e-04  5.46e-02     9s
  29   3.26509764e+04  4.77848237e+04  6.63e-03 2.40e-04  4.16e-02     9s
  30   3.34897471e+04  4.70043137e+04  5.89e-03 2.13e-04  3.72e-02    10s
  31   3.37184099e+04  4.65480083e+04  5.70e-03 1.96e-04  3.53e-02    10s
  32   3.56611306e+04  4.55427527e+04  4.05e-03 1.78e-04  2.72e-02    10s
  33   3.63044257e+04  4.45647652e+04  3.52e-03 1.45e-04  2.27e-02    10s
  34   3.67719826e+04  4.42567695e+04  3.15e-03 1.33e-04  2.06e-02    10s
  35   3.70743923e+04  4.37827240e+04  2.90e-03 1.14e-04  1.85e-02    10s
  36   3.73052746e+04  4.36144700e+04  2.72e-03 1.07e-04  1.74e-02    10s
  37   3.78111987e+04  4.31715763e+04  2.33e-03 9.03e-05  1.47e-02    10s
  38   3.81482760e+04  4.27391500e+04  2.06e-03 7.27e-05  1.26e-02    11s
  39   3.84604369e+04  4.24331508e+04  1.81e-03 6.12e-05  1.09e-02    11s
  40   3.87291411e+04  4.21605001e+04  1.61e-03 5.00e-05  9.44e-03    11s
  41   3.89489783e+04  4.19481941e+04  1.44e-03 4.10e-05  8.25e-03    11s
  42   3.92338656e+04  4.17988646e+04  1.22e-03 3.67e-05  7.06e-03    11s
  43   3.94156268e+04  4.15295811e+04  1.08e-03 2.56e-05  5.82e-03    11s
  44   3.97710511e+04  4.14425096e+04  8.19e-04 2.15e-05  4.60e-03    11s
  45   4.01253473e+04  4.13054096e+04  5.64e-04 4.24e-05  3.25e-03    11s
  46   4.03865009e+04  4.12364552e+04  3.74e-04 1.96e-05  2.34e-03    11s
  47   4.05833523e+04  4.11309945e+04  2.34e-04 2.66e-05  1.51e-03    12s
  48   4.06585363e+04  4.10700638e+04  1.82e-04 2.50e-05  1.13e-03    12s
  49   4.07194603e+04  4.10282245e+04  1.38e-04 1.68e-05  8.49e-04    12s
  50   4.08071596e+04  4.10056570e+04  7.94e-05 1.26e-05  5.46e-04    12s
  51   4.08455676e+04  4.09593469e+04  5.54e-05 4.27e-06  3.13e-04    12s
  52   4.08736583e+04  4.09579451e+04  3.72e-05 4.03e-06  2.32e-04    12s
  53   4.08955423e+04  4.09477935e+04  2.29e-05 2.17e-06  1.44e-04    12s
  54   4.09225040e+04  4.09403273e+04  7.02e-06 8.88e-07  4.90e-05    12s
  55   4.09290774e+04  4.09380433e+04  3.25e-06 4.90e-07  2.47e-05    13s
  56   4.09336842e+04  4.09364851e+04  5.83e-07 2.18e-07  7.70e-06    13s
  57   4.09344003e+04  4.09357780e+04  2.64e-07 1.09e-07  3.79e-06    13s
  58   4.09349215e+04  4.09352675e+04  6.22e-08 2.96e-08  9.52e-07    13s
  59   4.09350626e+04  4.09350666e+04  3.72e-09 1.60e-10  1.11e-08    13s
  60   4.09350649e+04  4.09350650e+04  5.24e-09 1.12e-10  1.89e-10    13s

Barrier solved model in 60 iterations and 13.01 seconds (20.29 work units)
Optimal objective 4.09350649e+04


Root crossover log...

  173086 DPushes remaining with DInf 0.0000000e+00                13s
   58871 DPushes remaining with DInf 0.0000000e+00                15s
    2572 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    6592 PPushes remaining with PInf 3.7441051e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.1272792e+00     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   81663    4.0935065e+04   0.000000e+00   5.127279e+00     22s
   81671    4.0935065e+04   0.000000e+00   0.000000e+00     22s
   81671    4.0935065e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 6.08s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.093507e+04, 81671 iterations, 23.14 seconds (39.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40935.0650    0  251 -233197.24 40935.0650   118%     -   29s
H    0     0                    -123739.6836 40935.0650   133%     -   30s
H    0     0                    -108617.3236 40935.0650   138%     -   30s
H    0     0                    -107196.8708 40935.0650   138%     -   30s
H    0     0                    -58251.44252 40935.0650   170%     -   30s
H    0     0                    2921.3403511 40935.0650  1301%     -   31s
H    0     0                    4019.9530632 40935.0650   918%     -   31s
H    0     0                    4791.0462917 40935.0650   754%     -   32s
H    0     0                    5559.1771206 40935.0650   636%     -   32s
H    0     0                    6544.5150702 40935.0650   525%     -   32s
     0     0 33365.3732    0  240 6544.51507 33365.3732   410%     -  121s
H    0     0                    9079.4880934 33365.3643   267%     -  123s
H    0     0                    9621.7529066 33365.3643   247%     -  123s
H    0     0                    10056.588698 33365.3643   232%     -  123s
H    0     0                    10171.565278 33365.3643   228%     -  123s
     0     0 32897.7422    0  249 10171.5653 32897.7422   223%     -  155s
     0     0 32786.8791    0  260 10171.5653 32786.8791   222%     -  177s
     0     0 32773.2493    0  266 10171.5653 32773.2493   222%     -  187s
     0     0 32754.8781    0  265 10171.5653 32754.8781   222%     -  192s
     0     0 32751.0761    0  264 10171.5653 32751.0761   222%     -  195s
     0     0 32750.6850    0  265 10171.5653 32750.6850   222%     -  196s
     0     0 29426.2682    0  343 10171.5653 29426.2682   189%     -  292s
H    0     0                    10440.899041 29426.1283   182%     -  293s
     0     0 28993.2125    0  360 10440.8990 28993.2125   178%     -  340s
     0     0 28832.7997    0  362 10440.8990 28832.7997   176%     -  365s
     0     0 28630.8253    0  348 10440.8990 28630.8253   174%     -  394s
     0     0 28601.1408    0  356 10440.8990 28601.1408   174%     -  408s
     0     0 28589.6424    0  360 10440.8990 28589.6424   174%     -  418s
     0     0 28585.7339    0  362 10440.8990 28585.7339   174%     -  424s
     0     0 28576.9150    0  361 10440.8990 28576.9150   174%     -  432s
     0     0 28568.5468    0  362 10440.8990 28568.5468   174%     -  440s
     0     0 28567.7553    0  365 10440.8990 28567.7553   174%     -  443s
     0     0 25895.3285    0  259 10440.8990 25895.3285   148%     -  538s
H    0     0                    10643.350785 25895.3255   143%     -  539s
H    0     0                    10645.303662 25895.3255   143%     -  539s
     0     0 25625.1908    0  287 10645.3037 25625.1908   141%     -  593s
     0     0 25396.1683    0  421 10645.3037 25396.1683   139%     -  634s
     0     0 25346.3469    0  403 10645.3037 25346.3469   138%     -  657s
     0     0 25261.8843    0  411 10645.3037 25261.8843   137%     -  678s
     0     0 25205.8908    0  394 10645.3037 25205.8908   137%     -  697s
     0     0 25163.5240    0  400 10645.3037 25163.5240   136%     -  715s
     0     0 25112.5320    0  449 10645.3037 25112.5320   136%     -  736s
     0     0 25067.0906    0  419 10645.3037 25067.0906   135%     -  750s
     0     0 25041.3968    0  411 10645.3037 25041.3968   135%     -  762s
     0     0 25035.4813    0  454 10645.3037 25035.4813   135%     -  769s
     0     0 25024.7086    0  421 10645.3037 25024.7086   135%     -  776s
     0     0 25022.1125    0  458 10645.3037 25022.1125   135%     -  781s
     0     0 25021.0726    0  454 10645.3037 25021.0726   135%     -  784s
     0     0 24064.6971    0  381 10645.3037 24064.6971   126%     -  881s
H    0     0                    10671.090978 24064.6295   126%     -  883s
H    0     0                    10676.981586 24064.6295   125%     -  883s
H    0     0                    10727.732880 24064.6295   124%     -  883s
     0     0 23899.0609    0  391 10727.7329 23899.0609   123%     -  912s
     0     0 23847.3074    0  378 10727.7329 23847.3074   122%     -  923s
     0     0 23818.4650    0  389 10727.7329 23818.4650   122%     -  934s
     0     0 23782.4975    0  438 10727.7329 23782.4975   122%     -  946s
     0     0 23771.8212    0  440 10727.7329 23771.8212   122%     -  955s
     0     0 23765.6850    0  445 10727.7329 23765.6850   122%     -  960s
     0     0 23758.5137    0  440 10727.7329 23758.5137   121%     -  965s
     0     0 23752.0065    0  447 10727.7329 23752.0065   121%     -  971s
     0     0 23734.1435    0  451 10727.7329 23734.1435   121%     -  976s
     0     0 23729.3924    0  449 10727.7329 23729.3924   121%     -  980s
     0     0 23694.1035    0  449 10727.7329 23694.1035   121%     -  990s
     0     0 23688.3518    0  447 10727.7329 23688.3518   121%     -  996s
     0     0 23687.2623    0  451 10727.7329 23687.2623   121%     - 1000s
     0     0 23490.6130    0  359 10727.7329 23490.6130   119%     - 1031s
H    0     0                    10764.758671 23490.2286   118%     - 1032s
     0     0 23455.4576    0  487 10764.7587 23455.4576   118%     - 1043s
     0     0 23434.5572    0  493 10764.7587 23434.5572   118%     - 1053s
     0     0 23427.6419    0  486 10764.7587 23427.6419   118%     - 1057s
     0     0 23417.6045    0  480 10764.7587 23417.6045   118%     - 1064s
     0     0 23412.5906    0  485 10764.7587 23412.5906   117%     - 1071s
     0     0 23403.1762    0  488 10764.7587 23403.1762   117%     - 1079s
     0     0 23395.8614    0  481 10764.7587 23395.8614   117%     - 1086s
     0     0 23392.4642    0  488 10764.7587 23392.4642   117%     - 1092s
     0     0 23382.6601    0  476 10764.7587 23382.6601   117%     - 1097s
     0     0 23381.3535    0  484 10764.7587 23381.3535   117%     - 1100s
     0     0 23336.4276    0  575 10764.7587 23336.4276   117%     - 1128s
H    0     0                    10779.483724 23335.7306   116%     - 1130s
H    0     0                    10909.672954 23335.7306   114%     - 1130s
H    0     0                    11035.558965 23335.7306   111%     - 1130s
H    0     0                    11196.579901 23335.7306   108%     - 1130s
     0     0 23318.0523    0  562 11196.5799 23318.0523   108%     - 1146s
     0     0 23311.3522    0  564 11196.5799 23311.3522   108%     - 1156s
     0     0 23306.1565    0  572 11196.5799 23306.1565   108%     - 1166s
     0     0 23302.5453    0  566 11196.5799 23302.5453   108%     - 1172s
     0     0 23299.9587    0  565 11196.5799 23299.9587   108%     - 1177s
     0     0 23298.6396    0  578 11196.5799 23298.6396   108%     - 1179s
     0     0 23263.8703    0  523 11196.5799 23263.8703   108%     - 1198s
     0     0 23249.4605    0  531 11196.5799 23249.4605   108%     - 1212s
     0     0 23242.2996    0  524 11196.5799 23242.2996   108%     - 1218s
     0     0 23239.4806    0  534 11196.5799 23239.4806   108%     - 1225s
     0     0 23235.1006    0  536 11196.5799 23235.1006   108%     - 1232s
     0     0 23232.6019    0  442 11196.5799 23232.6019   107%     - 1237s
     0     0 23177.2523    0  518 11196.5799 23177.2523   107%     - 1260s
H    0     0                    11294.649579 23173.7048   105%     - 1261s
     0     0 23165.3741    0  534 11294.6496 23165.3741   105%     - 1272s
     0     0 23159.4271    0  532 11294.6496 23159.4271   105%     - 1279s
     0     0 23155.0712    0  529 11294.6496 23155.0712   105%     - 1286s
     0     0 23153.6028    0  540 11294.6496 23153.6028   105%     - 1290s
     0     0 23148.1498    0  449 11294.6496 23148.1498   105%     - 1299s
H    0     0                    11451.178679 23147.9194   102%     - 1300s
     0     0 23146.7968    0  541 11451.1787 23146.7968   102%     - 1304s
     0     0 23143.1248    0  488 11451.1787 23143.1248   102%     - 1313s
H    0     0                    11490.511718 23143.1187   101%     - 1316s
H    0     0                    11535.736469 23143.1187   101%     - 1316s
H    0     0                    11585.531923 23143.1187   100%     - 1316s
     0     0 23140.8874    0  546 11585.5319 23140.8874   100%     - 1321s
     0     0 23138.2598    0  490 11585.5319 23138.2598   100%     - 1331s
H    0     0                    11656.947685 23138.1521  98.5%     - 1332s
H    0     0                    11660.797673 23138.1521  98.4%     - 1332s
     0     0 23134.4815    0  576 11660.7977 23134.4815  98.4%     - 1339s
     0     0 23133.0261    0  592 11660.7977 23133.0261  98.4%     - 1344s
     0     0 23128.0566    0  586 11660.7977 23128.0566  98.3%     - 1355s
     0     0 23127.9380    0  586 11660.7977 23127.9380  98.3%     - 1363s
H    0     0                    11911.980673 23127.8207  94.2%     - 1518s
H    0     0                    11917.538480 23127.8207  94.1%     - 1526s
H    0     0                    11918.941448 23127.8207  94.0%     - 1538s
H    0     2                    11951.286489 23127.8207  93.5%     - 1553s
     0     2 23127.8207    0  586 11951.2865 23127.8207  93.5%     - 1553s
     1     3 22395.1027    1  338 11951.2865 23127.8207  93.5% 19415 1580s
     2     6 22050.9924    2  273 11951.2865 23127.8207  93.5% 19215 1610s
     5    11 21322.3866    3  272 11951.2865 22918.1086  91.8% 19377 1652s
    10    22 20941.1881    4  316 11951.2865 22916.9402  91.8% 21695 1688s
    21    32 21830.3091    4  318 11951.2865 22316.1617  86.7% 26285 3600s

Cutting planes:
  Learned: 2
  Gomory: 6
  Implied bound: 271
  MIR: 4036
  Flow cover: 3450
  RLT: 59
  Relax-and-lift: 571

Explored 31 nodes (1828347 simplex iterations) in 3600.10 seconds (6624.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 11951.3 11918.9 11917.5 ... 11451.2

Time limit reached
Best objective 1.195128648887e+04, best bound 2.231616174077e+04, gap 86.7260%
  WARNING: Time limit reached. Using best solution found (gap: 86.73%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = 11951.29, θ = 152914.81
  Upper Bound (UB) = 11951.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152914.81
  [DEBUG]   ✓ Scenario 0: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152914.81 ≤ Q = 152931.70 (slack: 16.88)
  [DEBUG]   ✓ Scenario 2: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152914.81 ≤ Q = 152914.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 152914.81 ≤ Q = 152914.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 152914.81 ≤ Q = 152914.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 152914.81 ≤ Q = 152914.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 152914.81 ≤ Q = 152914.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 152914.81 ≤ Q = 152914.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x76d7e9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xff892817
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.167429e+13
Presolve removed 2550 rows and 1842 columns
Presolve time: 0.00s
Presolved: 543 rows, 547 columns, 1532 nonzeros
Found heuristic solution: objective 6369399.4816
Variable types: 371 continuous, 176 integer (176 binary)

Root relaxation: objective -1.348497e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134849.68    0  122 6369399.48 -134849.68   102%     -    0s
H    0     0                    -98169.31734 -134849.68  37.4%     -    0s
H    0     0                    -99572.24567 -134849.68  35.4%     -    0s
     0     0 -107983.33    0   89 -99572.246 -107983.33  8.45%     -    0s
H    0     0                    -104513.1272 -107892.81  3.23%     -    0s
H    0     0                    -104518.4856 -107892.81  3.23%     -    0s
H    0     0                    -105546.4927 -107892.81  2.22%     -    0s
H    0     0                    -105551.8511 -107892.81  2.22%     -    0s
     0     0 -107304.95    0   87 -105551.85 -107304.95  1.66%     -    0s
H    0     0                    -106451.6816 -107303.64  0.80%     -    0s
H    0     0                    -106663.1946 -107303.64  0.60%     -    0s
H    0     0                    -106799.0445 -107303.64  0.47%     -    0s
     0     0 -107265.57    0   83 -106799.04 -107265.57  0.44%     -    0s
     0     0 -107248.41    0   84 -106799.04 -107248.41  0.42%     -    0s
     0     0 -107248.25    0   84 -106799.04 -107248.25  0.42%     -    0s
     0     0 -107014.65    0   10 -106799.04 -107014.65  0.20%     -    0s
     0     0 -106980.19    0   10 -106799.04 -106980.19  0.17%     -    0s
     0     0 -106979.79    0   11 -106799.04 -106979.79  0.17%     -    0s
     0     0 -106930.20    0   12 -106799.04 -106930.20  0.12%     -    0s
     0     0 -106930.20    0   50 -106799.04 -106930.20  0.12%     -    0s
     0     0 -106855.71    0   11 -106799.04 -106855.71  0.05%     -    0s
H    0     0                    -106804.3242 -106852.05  0.04%     -    0s
     0     0 -106833.39    0   10 -106804.32 -106833.39  0.03%     -    0s
     0     0 -106832.57    0    5 -106804.32 -106832.57  0.03%     -    0s
     0     0 -106814.88    0    8 -106804.32 -106814.88  0.01%     -    0s
     0     0 -106814.88    0    6 -106804.32 -106814.88  0.01%     -    0s
     0     0 -106808.95    0    5 -106804.32 -106808.95  0.00%     -    0s
     0     0 -106807.77    0    4 -106804.32 -106807.77  0.00%     -    0s
     0     0 -106806.04    0    4 -106804.32 -106806.04  0.00%     -    0s
     0     0 -106805.55    0    4 -106804.32 -106805.55  0.00%     -    0s
     0     2 -106805.55    0    4 -106804.32 -106805.55  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 2
  Flow cover: 3

Explored 3 nodes (838 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -106804 -106799 -106763 ... 6.3694e+06

Optimal solution found (tolerance 1.00e-06)
Best objective -1.068043242261e+05, best bound -1.068043843273e+05, gap 0.0001%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 148192.37
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106804.32
  [DEBUG]   S×d_nominal = 254996.69
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254996.69 + -106804.32 = 148192.37
  [DEBUG]   Current θ from Master = 152914.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4722.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7228.84
  Lower Bound (LB) = 12379.05
  Gap (UB-LB) = -427.7604, Absolute Gap = 427.7604, Relative Gap = -0.035792
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 11951.29, LB = 12379.05, Gap = -427.76
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 1000384 nonzeros
Model fingerprint: 0x1c9556a7
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 144026 rows and 58466 columns
Presolve time: 4.65s
Presolved: 209027 rows, 87314 columns, 1283177 nonzeros
Variable types: 85055 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -369715.9537
Found heuristic solution: objective -233197.2386

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.95s

Barrier statistics:
 Dense cols : 1259
 AA' NZ     : 5.025e+06
 Factor NZ  : 1.474e+07 (roughly 240 MB of memory)
 Factor Ops : 5.667e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.71276091e+07  3.29595618e+08  1.05e+05 1.88e+01  7.01e+04     9s
   1  -1.32466398e+07  2.85987871e+08  7.45e+04 6.35e+01  4.93e+04     9s
   2  -5.19630877e+06  2.29109227e+08  2.84e+04 1.09e+01  1.93e+04     9s
   3  -9.21229502e+05  1.68643117e+08  2.02e+03 2.20e+00  1.74e+03     9s
   4  -6.32272135e+05  1.00188962e+08  6.91e+02 8.49e-01  6.76e+02     9s
   5  -5.46407554e+05  6.12831313e+07  3.99e+02 4.17e-01  3.79e+02     9s
   6  -4.47121686e+05  4.49095695e+07  1.57e+02 2.89e-01  1.99e+02     9s
   7  -3.75795170e+05  3.41069018e+07  8.20e+01 2.07e-01  1.28e+02     9s
   8  -2.38629230e+05  2.51839276e+07  2.36e+01 1.43e-01  7.62e+01     9s
   9  -1.74793311e+05  1.36817619e+07  9.52e+00 7.60e-02  3.90e+01     9s
  10  -1.40784941e+05  8.45909637e+06  6.40e+00 4.57e-02  2.38e+01     9s
  11  -1.25902940e+05  6.78249962e+06  4.35e+00 3.63e-02  1.88e+01    10s
  12  -1.14038716e+05  5.71227885e+06  3.20e+00 3.03e-02  1.57e+01    10s
  13  -1.02804038e+05  3.98147237e+06  2.26e+00 2.07e-02  1.10e+01    10s
  14  -7.42119702e+04  2.35157201e+06  6.81e-01 1.16e-02  6.42e+00    10s
  15  -5.07167249e+04  6.64701662e+05  2.42e-01 3.11e-03  1.89e+00    10s
  16  -2.95876763e+04  3.52524624e+05  1.20e-01 1.68e-03  1.01e+00    10s
  17  -1.42795417e+04  1.84175496e+05  7.49e-02 1.25e-03  5.23e-01    10s
  18  -5.12210624e+03  1.48762922e+05  5.98e-02 1.51e-03  4.05e-01    10s
  19   7.52403727e+03  1.06153256e+05  4.12e-02 2.20e-03  2.60e-01    10s
  20   1.12723015e+04  8.91823680e+04  3.58e-02 1.82e-03  2.05e-01    10s
  21   1.35181792e+04  7.97427917e+04  3.26e-02 1.48e-03  1.74e-01    10s
  22   1.78108410e+04  6.90743592e+04  2.68e-02 1.12e-03  1.35e-01    11s
  23   1.95820410e+04  6.26157842e+04  2.45e-02 8.66e-04  1.13e-01    11s
  24   2.22487598e+04  5.81596162e+04  2.10e-02 6.96e-04  9.46e-02    11s
  25   2.52760780e+04  5.64449268e+04  1.71e-02 6.31e-04  8.21e-02    11s
  26   2.72030278e+04  5.31909299e+04  1.47e-02 5.07e-04  6.84e-02    11s
  27   2.93160276e+04  5.15550747e+04  1.22e-02 4.41e-04  5.86e-02    11s
  28   3.20573499e+04  5.00256426e+04  8.93e-03 3.78e-04  4.73e-02    11s
  29   3.33030748e+04  4.78655175e+04  7.55e-03 3.19e-04  3.83e-02    11s
  30   3.40814319e+04  4.69569474e+04  6.70e-03 2.77e-04  3.39e-02    11s
  31   3.46216029e+04  4.62885651e+04  6.13e-03 2.51e-04  3.07e-02    12s
  32   3.59222492e+04  4.52609891e+04  4.77e-03 2.04e-04  2.46e-02    12s
  33   3.63310699e+04  4.42127168e+04  4.35e-03 1.51e-04  2.08e-02    12s
  34   3.66422033e+04  4.33759104e+04  4.03e-03 2.97e-04  1.77e-02    12s
  35   3.73367955e+04  4.28729791e+04  3.34e-03 1.75e-04  1.46e-02    12s
  36   3.80238228e+04  4.25616028e+04  2.70e-03 1.50e-04  1.20e-02    12s
  37   3.82181796e+04  4.24141835e+04  2.51e-03 1.36e-04  1.11e-02    12s
  38   3.85978962e+04  4.22824608e+04  2.15e-03 1.24e-04  9.70e-03    12s
  39   3.88800145e+04  4.19272066e+04  1.87e-03 9.68e-05  8.03e-03    12s
  40   3.91032202e+04  4.17840194e+04  1.65e-03 8.26e-05  7.06e-03    13s
  41   3.93445013e+04  4.15747933e+04  1.43e-03 6.33e-05  5.88e-03    13s
  42   3.96437415e+04  4.14988866e+04  1.15e-03 5.65e-05  4.89e-03    13s
  43   3.98985509e+04  4.14535960e+04  9.19e-04 5.20e-05  4.10e-03    13s
  44   4.03174798e+04  4.12403946e+04  5.42e-04 3.02e-05  2.43e-03    13s
  45   4.04797749e+04  4.11910615e+04  3.95e-04 3.71e-05  1.87e-03    13s
  46   4.06040050e+04  4.10826529e+04  2.83e-04 2.50e-05  1.26e-03    13s
  47   4.06867451e+04  4.10405698e+04  2.10e-04 1.81e-05  9.32e-04    13s
  48   4.07414770e+04  4.10155791e+04  1.62e-04 1.37e-05  7.22e-04    13s
  49   4.07808567e+04  4.09816342e+04  1.27e-04 7.35e-06  5.29e-04    14s
  50   4.08530900e+04  4.09532750e+04  6.58e-05 2.65e-06  2.64e-04    14s
  51   4.08683922e+04  4.09436497e+04  5.31e-05 1.27e-06  1.98e-04    14s
  52   4.08861062e+04  4.09384978e+04  3.89e-05 4.27e-07  1.38e-04    14s
  53   4.08905524e+04  4.09374415e+04  3.54e-05 2.63e-07  1.24e-04    14s
  54   4.09134584e+04  4.09370289e+04  1.68e-05 2.06e-07  6.21e-05    14s
  55   4.09220166e+04  4.09365001e+04  9.97e-06 1.42e-07  3.82e-05    14s
  56   4.09234746e+04  4.09363582e+04  8.86e-06 1.26e-07  3.40e-05    14s
  57   4.09263107e+04  4.09361708e+04  6.61e-06 1.07e-07  2.60e-05    14s
  58   4.09325715e+04  4.09353700e+04  1.92e-06 7.26e-07  7.38e-06    15s
  59   4.09349804e+04  4.09351331e+04  2.22e-07 2.51e-07  4.03e-07    15s
  60   4.09350635e+04  4.09350655e+04  3.59e-09 6.38e-10  5.31e-09    15s
  61   4.09350636e+04  4.09350653e+04  5.73e-07 1.44e-09  4.39e-09    15s
  62   4.09350640e+04  4.09350652e+04  1.38e-06 1.33e-09  3.19e-09    15s
  63   4.09350650e+04  4.09350650e+04  2.64e-08 7.63e-08  3.18e-11    15s

Barrier solved model in 63 iterations and 15.17 seconds (23.32 work units)
Optimal objective 4.09350650e+04


Root crossover log...

  180828 DPushes remaining with DInf 0.0000000e+00                15s
   11527 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

    3990 PPushes remaining with PInf 1.3097983e-05                22s
       0 PPushes remaining with PInf 0.0000000e+00                23s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6523588e-10     23s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   76038    4.0935065e+04   0.000000e+00   0.000000e+00     23s
   76038    4.0935065e+04   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 3.48s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.093507e+04, 76038 iterations, 20.63 seconds (37.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40935.0650    0  251 -233197.24 40935.0650   118%     -   27s
H    0     0                    -96087.78610 40935.0650   143%     -   27s
H    0     0                    -95896.54002 40935.0650   143%     -   28s
H    0     0                    -95271.73710 40935.0650   143%     -   28s
H    0     0                    -95083.16282 40935.0650   143%     -   28s
H    0     0                    -95066.69650 40935.0650   143%     -   28s
H    0     0                    -95011.94621 40935.0650   143%     -   28s
H    0     0                    -57279.70373 40935.0650   171%     -   28s
H    0     0                    3385.3880869 40935.0650  1109%     -   28s
H    0     0                    4484.0007990 40935.0650   813%     -   29s
H    0     0                    5175.0310317 40935.0650   691%     -   29s
H    0     0                    5929.7104630 40935.0650   590%     -   29s
H    0     0                    6282.2914319 40935.0650   552%     -   29s
     0     0 33609.2705    0  224 6282.29143 33609.2705   435%     -  117s
H    0     0                    8029.3525384 33609.1900   319%     -  118s
H    0     0                    9882.9044866 33609.1900   240%     -  119s
     0     0 32994.1631    0  266 9882.90449 32994.1631   234%     -  160s
     0     0 32914.1274    0  244 9882.90449 32914.1274   233%     -  172s
     0     0 32865.9093    0  250 9882.90449 32865.9093   233%     -  177s
     0     0 32863.8394    0  248 9882.90449 32863.8394   233%     -  179s
     0     0 32838.7272    0  260 9882.90449 32838.7272   232%     -  188s
     0     0 32838.3562    0  260 9882.90449 32838.3562   232%     -  190s
     0     0 29456.7530    0  340 9882.90449 29456.7530   198%     -  265s
H    0     0                    9992.4194230 29456.5958   195%     -  266s
H    0     0                    10107.328384 29456.5958   191%     -  266s
H    0     0                    10129.742361 29456.5958   191%     -  266s
     0     0 29024.6842    0  352 10129.7424 29024.6842   187%     -  310s
     0     0 28922.2199    0  368 10129.7424 28922.2199   186%     -  336s
     0     0 28902.2622    0  361 10129.7424 28902.2622   185%     -  347s
     0     0 28857.2201    0  370 10129.7424 28857.2201   185%     -  360s
     0     0 28840.1709    0  370 10129.7424 28840.1709   185%     -  373s
     0     0 28814.1993    0  358 10129.7424 28814.1993   184%     -  391s
     0     0 28803.4248    0  366 10129.7424 28803.4248   184%     -  402s
     0     0 28761.6573    0  367 10129.7424 28761.6573   184%     -  417s
     0     0 28756.7762    0  368 10129.7424 28756.7762   184%     -  428s
     0     0 28749.0164    0  376 10129.7424 28749.0164   184%     -  434s
     0     0 28747.9643    0  401 10129.7424 28747.9643   184%     -  438s
     0     0 26388.3269    0  338 10129.7424 26388.3269   161%     -  530s
     0     0 25883.2917    0  408 10129.7424 25883.2917   156%     -  589s
     0     0 25673.8557    0  411 10129.7424 25673.8557   153%     -  626s
     0     0 25471.2075    0  413 10129.7424 25471.2075   151%     -  659s
     0     0 25437.4593    0  416 10129.7424 25437.4593   151%     -  680s
     0     0 25388.2860    0  418 10129.7424 25388.2860   151%     -  699s
     0     0 25357.1276    0  427 10129.7424 25357.1276   150%     -  710s
     0     0 25343.6938    0  420 10129.7424 25343.6938   150%     -  720s
     0     0 25333.9615    0  417 10129.7424 25333.9615   150%     -  726s
     0     0 25320.4644    0  416 10129.7424 25320.4644   150%     -  735s
     0     0 25313.9284    0  416 10129.7424 25313.9284   150%     -  741s
     0     0 25296.1985    0  428 10129.7424 25296.1985   150%     -  752s
     0     0 25279.4952    0  426 10129.7424 25279.4952   150%     -  762s
     0     0 25275.5367    0  432 10129.7424 25275.5367   150%     -  767s
     0     0 25263.9288    0  428 10129.7424 25263.9288   149%     -  775s
     0     0 25259.1593    0  437 10129.7424 25259.1593   149%     -  780s
     0     0 25246.7175    0  427 10129.7424 25246.7175   149%     -  790s
     0     0 25241.1062    0  435 10129.7424 25241.1062   149%     -  798s
     0     0 25221.4321    0  431 10129.7424 25221.4321   149%     -  809s
     0     0 25218.7267    0  436 10129.7424 25218.7267   149%     -  814s
     0     0 25217.3099    0  433 10129.7424 25217.3099   149%     -  817s
     0     0 23974.2772    0  496 10129.7424 23974.2772   137%     -  911s
H    0     0                    10169.501085 23974.2007   136%     -  912s
H    0     0                    10176.965836 23974.2007   136%     -  912s
H    0     0                    10192.314147 23974.2007   135%     -  912s
     0     0 23772.3721    0  510 10192.3141 23772.3721   133%     -  963s
     0     0 23710.7210    0  497 10192.3141 23710.7210   133%     -  998s
     0     0 23679.0575    0  439 10192.3141 23679.0575   132%     - 1031s
     0     0 23660.2718    0  454 10192.3141 23660.2718   132%     - 1045s
     0     0 23656.0972    0  455 10192.3141 23656.0972   132%     - 1052s
     0     0 23645.4867    0  455 10192.3141 23645.4867   132%     - 1071s
     0     0 23644.2146    0  457 10192.3141 23644.2146   132%     - 1076s
     0     0 23478.1181    0  476 10192.3141 23478.1181   130%     - 1109s
     0     0 23415.9782    0  557 10192.3141 23415.9782   130%     - 1135s
     0     0 23407.1117    0  566 10192.3141 23407.1117   130%     - 1147s
     0     0 23396.4830    0  572 10192.3141 23396.4830   130%     - 1160s
     0     0 23390.2340    0  564 10192.3141 23390.2340   129%     - 1171s
     0     0 23384.7052    0  569 10192.3141 23384.7052   129%     - 1178s
     0     0 23378.5539    0  567 10192.3141 23378.5539   129%     - 1186s
     0     0 23373.4546    0  568 10192.3141 23373.4546   129%     - 1193s
     0     0 23368.7043    0  530 10192.3141 23368.7043   129%     - 1201s
     0     0 23362.3368    0  575 10192.3141 23362.3368   129%     - 1211s
     0     0 23361.2768    0  578 10192.3141 23361.2768   129%     - 1214s
     0     0 23319.9953    0  460 10192.3141 23319.9953   129%     - 1243s
H    0     0                    10220.949065 23319.9915   128%     - 1244s
H    0     0                    10413.576510 23319.9915   124%     - 1244s
H    0     0                    10465.850389 23319.9915   123%     - 1244s
     0     0 23309.9995    0  505 10465.8504 23309.9995   123%     - 1259s
     0     0 23306.4027    0  563 10465.8504 23306.4027   123%     - 1266s
     0     0 23305.6042    0  500 10465.8504 23305.6042   123%     - 1269s
     0     0 23295.6903    0  447 10465.8504 23295.6903   123%     - 1284s
H    0     0                    10721.060961 23295.4591   117%     - 1285s
H    0     0                    10754.614413 23295.4591   117%     - 1285s
     0     0 23280.2616    0  443 10754.6144 23280.2616   116%     - 1297s
     0     0 23273.8303    0  467 10754.6144 23273.8303   116%     - 1304s
     0     0 23270.6099    0  448 10754.6144 23270.6099   116%     - 1314s
     0     0 23266.1589    0  345 10754.6144 23266.1589   116%     - 1322s
     0     0 23261.0972    0  562 10754.6144 23261.0972   116%     - 1330s
     0     0 23258.0350    0  508 10754.6144 23258.0350   116%     - 1335s
     0     0 23257.5880    0  561 10754.6144 23257.5880   116%     - 1338s
     0     0 23248.3269    0  541 10754.6144 23248.3269   116%     - 1351s
H    0     0                    10806.114544 23248.2240   115%     - 1352s
H    0     0                    10825.481780 23248.2240   115%     - 1352s
H    0     0                    10854.390315 23248.2240   114%     - 1352s
H    0     0                    10858.114598 23248.2240   114%     - 1352s
H    0     0                    10876.530568 23248.2240   114%     - 1352s
H    0     0                    10881.777730 23248.2240   114%     - 1352s
H    0     0                    11026.768158 23248.2240   111%     - 1352s
     0     0 23242.7747    0  506 11026.7682 23242.7747   111%     - 1357s
     0     0 23240.8947    0  512 11026.7682 23240.8947   111%     - 1363s
     0     0 23222.0935    0  518 11026.7682 23222.0935   111%     - 1377s
     0     0 23207.4247    0  409 11026.7682 23207.4247   110%     - 1388s
     0     0 23205.1990    0  399 11026.7682 23205.1990   110%     - 1395s
     0     0 23198.0940    0  339 11026.7682 23198.0940   110%     - 1404s
     0     0 23173.8010    0  347 11026.7682 23173.8010   110%     - 1416s
     0     0 23161.1583    0  580 11026.7682 23161.1583   110%     - 1435s
     0     0 23159.2381    0  556 11026.7682 23159.2381   110%     - 1442s
     0     0 23151.0437    0  547 11026.7682 23151.0437   110%     - 1457s
     0     0 23145.1108    0  513 11026.7682 23145.1108   110%     - 1468s
     0     0 23141.7446    0  521 11026.7682 23141.7446   110%     - 1472s
     0     0 23141.0254    0  619 11026.7682 23141.0254   110%     - 1476s
     0     0 23135.4562    0  609 11026.7682 23135.4562   110%     - 1494s
H    0     0                    11303.136696 23135.3189   105%     - 1510s
     0     0 23128.8802    0  568 11303.1367 23128.8802   105%     - 1525s
     0     0 23127.6281    0  570 11303.1367 23127.6281   105%     - 1528s
     0     0 23121.5894    0  560 11303.1367 23121.5894   105%     - 1539s
     0     0 23118.2261    0  557 11303.1367 23118.2261   105%     - 1548s
     0     0 23116.2777    0  560 11303.1367 23116.2777   105%     - 1551s
     0     0 23113.7561    0  557 11303.1367 23113.7561   104%     - 1560s
     0     0 23113.1825    0  557 11303.1367 23113.1825   104%     - 1569s
H    0     0                    11452.948984 23113.1825   102%     - 1635s
H    0     0                    11458.394742 23113.0654   102%     - 1822s
H    0     0                    11462.256387 23113.0654   102%     - 1838s
H    0     0                    11468.510878 23113.0654   102%     - 1873s
H    0     0                    11562.136719 23113.0654   100%     - 1873s
H    0     0                    11565.807238 23113.0654   100%     - 1885s
H    0     0                    11628.769955 23113.0654  98.8%     - 1885s
H    0     0                    11666.810824 23113.0654  98.1%     - 1907s
H    0     0                    11945.594425 23113.0654  93.5%     - 1907s
H    0     0                    12041.984403 23113.0654  91.9%     - 1914s
H    0     0                    12056.605610 23113.0654  91.7%     - 1915s
H    0     0                    12066.409201 23113.0654  91.5%     - 1916s
H    0     0                    12068.707505 23113.0654  91.5%     - 1916s
     0     2 23113.0654    0  557 12068.7075 23113.0654  91.5%     - 2048s
     1     4 22897.4462    1  503 12068.7075 23113.0654  91.5% 27997 2090s
     3     8 22730.3419    2  552 12068.7075 22897.2132  89.7% 22591 2137s
     7    16 22512.0196    3  561 12068.7075 22728.8070  88.3% 25439 2188s
    15    32 22155.4866    4  561 12068.7075 22512.0133  86.5% 25625 2254s
    31    48 21959.2352    5  516 12068.7075 22155.0257  83.6% 34947 2421s
    47    79 21488.3147    6  554 12068.7075 22155.0257  83.6% 35268 2507s
    78   163 21340.7697    7  557 12068.7075 22155.0257  83.6% 27847 2691s
   162   221 21326.5589    8  549 12068.7075 22155.0257  83.6% 17401 2761s
   220   282 20047.1357    8  284 12068.7075 22155.0257  83.6% 15005 2819s
   281   311 19875.1573    9  275 12068.7075 22155.0257  83.6% 14203 2868s
H  284   311                    12287.065805 22155.0257  80.3% 14207 2868s
H  294   311                    12516.208846 22155.0257  77.0% 14064 2868s
   310   366 19308.0641    9  232 12516.2088 22155.0257  77.0% 14203 2924s
   371   377 18217.2276   17  233 12516.2088 22155.0257  77.0% 13712 2972s
   398   410 17490.1126   11  201 12516.2088 22155.0257  77.0% 13813 3023s
   459   459 12690.6096   16   98 12516.2088 22155.0257  77.0% 13570 3072s
   534   501 14716.4009   12  502 12516.2088 22155.0257  77.0% 13185 3114s
   612   553 16403.9307   12  178 12516.2088 22155.0257  77.0% 12566 3145s
H  641   553                    12565.486993 22155.0257  76.3% 12186 3145s
   691   598 16076.4866   13  187 12565.4870 22155.0257  76.3% 11860 3179s
   800   595 15160.4058   14  174 12565.4870 22155.0257  76.3% 11071 3210s
   895   565 15410.4549   14  192 12565.4870 22155.0257  76.3% 10483 3248s
   969   571 12922.7934   15  183 12565.4870 22155.0257  76.3% 10258 3289s
   995   578 13556.7985   15  453 12565.4870 22155.0257  76.3% 10374 3329s
  1012   585 12734.0420   16  392 12565.4870 22155.0257  76.3% 10519 3369s
  1037   591 infeasible   17      12565.4870 22155.0257  76.3% 10513 3413s
  1051   603 14782.9733   13  225 12565.4870 22155.0257  76.3% 10614 3457s
  1063   630 13882.8755   15  138 12565.4870 22155.0257  76.3% 10676 3500s
  1098   668 13100.2861   19   77 12565.4870 22155.0257  76.3% 10742 3538s
  1183   718 12959.8977   24  100 12565.4870 22155.0257  76.3% 10383 3576s
  1315   745 13772.8203   11  163 12565.4870 22155.0257  76.3%  9703 3600s

Cutting planes:
  Learned: 2
  Gomory: 14
  Implied bound: 290
  MIR: 5167
  Flow cover: 4947
  RLT: 63
  Relax-and-lift: 710

Explored 1438 nodes (14252138 simplex iterations) in 3600.20 seconds (8790.41 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12565.5 12516.2 12287.1 ... 11628.8

Time limit reached
Best objective 1.256548699303e+04, best bound 2.215502570541e+04, gap 76.3165%
  WARNING: Time limit reached. Using best solution found (gap: 76.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.23s
  Master Objective (UB) = 12565.49, θ = 153028.40
  Upper Bound (UB) = 12565.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153028.40
  [DEBUG]   ✓ Scenario 0: θ = 153028.40 ≤ Q = 153028.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153028.40 ≤ Q = 153028.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 153028.40 ≤ Q = 153028.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 153028.40 ≤ Q = 153028.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 153028.40 ≤ Q = 153028.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1090ef57
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xef6f10a9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.174598e+13
Presolve removed 2551 rows and 1843 columns
Presolve time: 0.00s
Presolved: 542 rows, 546 columns, 1529 nonzeros
Found heuristic solution: objective 6454245.6468
Variable types: 370 continuous, 176 integer (176 binary)

Root relaxation: objective -1.345208e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -134520.85    0  123 6454245.65 -134520.85   102%     -    0s
H    0     0                    -97637.70484 -134520.85  37.8%     -    0s
H    0     0                    -98983.89839 -134520.85  35.9%     -    0s
     0     0 -111816.58    0  107 -98983.898 -111816.58  13.0%     -    0s
H    0     0                    -109085.2183 -111742.85  2.44%     -    0s
H    0     0                    -109842.2750 -111742.85  1.73%     -    0s
     0     0 -111062.29    0  110 -109842.28 -111062.29  1.11%     -    0s
     0     0 -110836.02    0   32 -109842.28 -110836.02  0.90%     -    0s
H    0     0                    -110352.1046 -110829.35  0.43%     -    0s
     0     0 -110728.71    0   44 -110352.10 -110728.71  0.34%     -    0s
     0     0 -110682.82    0   45 -110352.10 -110682.82  0.30%     -    0s
     0     0 -110682.64    0   45 -110352.10 -110682.64  0.30%     -    0s
     0     0 -110574.01    0   17 -110352.10 -110574.01  0.20%     -    0s
H    0     0                    -110353.2086 -110560.56  0.19%     -    0s
H    0     0                    -110373.8661 -110560.56  0.17%     -    0s
     0     0 -110537.62    0   17 -110373.87 -110537.62  0.15%     -    0s
     0     0 -110534.78    0   19 -110373.87 -110534.78  0.15%     -    0s
     0     0 -110492.11    0   11 -110373.87 -110492.11  0.11%     -    0s
     0     0 -110492.11    0   49 -110373.87 -110492.11  0.11%     -    0s
     0     0 -110448.51    0   43 -110373.87 -110448.51  0.07%     -    0s
     0     0 -110440.33    0    8 -110373.87 -110440.33  0.06%     -    0s
     0     0 -110419.63    0   14 -110373.87 -110419.63  0.04%     -    0s
H    0     0                    -110395.5047 -110419.15  0.02%     -    0s
H    0     0                    -110418.1557 -110419.15  0.00%     -    0s
     0     0 -110419.14    0    6 -110418.16 -110419.14  0.00%     -    0s
     0     0 -110418.69    0    2 -110418.16 -110418.69  0.00%     -    0s
     0     0 -110418.69    0    2 -110418.16 -110418.69  0.00%     -    0s

Explored 1 nodes (894 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -110418 -110417 -110416 ... -97637.7

Optimal solution found (tolerance 1.00e-06)
Best objective -1.104181557065e+05, best bound -1.104182525831e+05, gap 0.0001%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 144421.22
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110418.16
  [DEBUG]   S×d_nominal = 254839.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254839.37 + -110418.16 = 144421.22
  [DEBUG]   Current θ from Master = 153028.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8607.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3958.31
  Lower Bound (LB) = 12379.05
  Gap (UB-LB) = 186.4401, Absolute Gap = 186.4401, Relative Gap = 0.014837
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 23
Total Time: 63233.49s
Converged: True
Final Lower Bound: 12379.0469
Final Upper Bound: 12565.4870
Final Gap: 186.440075
Number of Critical Scenarios: 23
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [5, 7, 8, 9] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 12 customers  Mode 2: 37 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 23
Start Time: 2026-01-03 10:45:36
End Time: 2026-01-04 04:19:29
Total Time: 63233.49s
Optimal Value: 12379.05
Lower Bound: 12379.05
Upper Bound: 12565.49
Gap: 186.440075
Plants Opened: {0: [1], 1: [1], 2: [1]} (3 plants)
DCs Opened: [5, 7, 8, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed20_MD_gamma20_20260104_041930.csv

Total Execution Time: 63235.12 seconds
End Time: 2026-01-04 04:19:31

All tasks completed successfully!

