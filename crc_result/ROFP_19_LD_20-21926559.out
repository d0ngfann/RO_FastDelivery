
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 19
DI Scenario: LD
Start Time: 2026-01-03 10:19:54
================================================================================
Loading data from data/DH_data_full_seed19.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.042', '1.086'] (k=0.102)
  Product 1: ['1.000', '1.040', '1.081'] (k=0.096)
  Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=927, max=1790
  DC capacity (MC): min=401, max=818

Demand Structure (s_rk matrix):
  Total customer-product pairs: 78/150 (48.0% sparse)
  Average products per customer: 1.56

Demand (only non-zero entries):
  Nominal (μ): min=8.20, max=34.38, count=78
  Deviation (μ̂): min=4.15, max=10.00

Costs:
  Plant fixed cost: min=5642, max=9474
  DC fixed cost: min=3448, max=5966
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
    Product 1: ['1.000', '1.331', '1.773'] (k=0.706)
    Product 2: ['1.000', '1.311', '1.720'] (k=0.669)
  MD:
    Product 0: ['1.000', '1.286', '1.654'] (k=0.620)
    Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
    Product 2: ['1.000', '1.177', '1.385'] (k=0.402)
  LD:
    Product 0: ['1.000', '1.042', '1.086'] (k=0.102)
    Product 1: ['1.000', '1.040', '1.081'] (k=0.096)
    Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
  Mixed:
    Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
    Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
    Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48744 nonzeros
Model fingerprint: 0x928debc3
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11953 rows and 2953 columns
Presolve time: 0.08s
Presolved: 4720 rows, 5547 columns, 32846 nonzeros
Variable types: 3288 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -322406.5190
Found heuristic solution: objective -185609.9094

Root relaxation: objective 4.636678e+04, 4421 iterations, 0.14 seconds (0.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46366.7808    0  611 -185609.91 46366.7808   125%     -    0s
H    0     0                    -184195.6804 46366.7808   125%     -    0s
     0     0 44301.5737    0  967 -184195.68 44301.5737   124%     -    0s
H    0     0                    -181584.8393 44301.5737   124%     -    0s
H    0     0                    -141992.3210 44301.5737   131%     -    0s
     0     0 44287.1820    0  954 -141992.32 44287.1820   131%     -    0s
     0     0 44287.1820    0  949 -141992.32 44287.1820   131%     -    0s
     0     0 44287.1820    0  885 -141992.32 44287.1820   131%     -    0s
     0     0 44287.1820    0  954 -141992.32 44287.1820   131%     -    0s
     0     0 44287.1820    0  952 -141992.32 44287.1820   131%     -    0s
H    0     0                    -106582.3754 40259.4557   138%     -    1s
     0     0 40259.4557    0 1154 -106582.38 40259.4557   138%     -    1s
     0     0 39988.5603    0 1148 -106582.38 39988.5603   138%     -    1s
     0     0 39964.9663    0 1155 -106582.38 39964.9663   137%     -    1s
     0     0 39964.9663    0 1153 -106582.38 39964.9663   137%     -    1s
H    0     0                    -106513.5277 38079.8683   136%     -    3s
H    0     0                    -106160.2758 38079.8683   136%     -    3s
H    0     0                    -104778.0071 38079.8683   136%     -    3s
H    0     0                    -72604.64082 38079.8683   152%     -    3s
H    0     0                    -60109.94837 38079.8683   163%     -    3s
H    0     0                    -13198.18845 38079.8683   389%     -    3s
H    0     0                    -13150.36804 38079.8683   390%     -    3s
H    0     0                    -13142.77565 38079.8683   390%     -    3s
     0     0 38079.8683    0 1256 -13142.776 38079.8683   390%     -    3s
     0     0 38066.4249    0 1256 -13142.776 38066.4249   390%     -    3s
     0     2 38066.4249    0 1256 -13142.776 38066.4249   390%     -    3s
     3     8 36987.9168    2 1000 -13142.776 38066.4249   390%  3221    5s
H  410   410                    -13078.15808 33146.7170   353%   599    8s
H  706   797                    -12979.21274 33146.7170   355%   451   10s
H  709   797                    -12559.24509 33146.7170   364%   451   10s
H  722   797                    -12449.34624 33146.7170   366%   448   10s
H  726   797                    -12216.82167 33146.7170   371%   448   10s
H  895   992                    -11243.89331 33146.7170   395%   403   10s
H  927   992                    -11138.84101 33146.7170   398%   400   10s
H  929   992                    -11122.70717 33146.7170   398%   399   10s
H  983   992                    -10794.14528 33146.7170   407%   383   10s
H 1128  1232                    -10215.65980 33146.7170   424%   352   10s
H 1135  1232                    -9836.459849 33146.7170   437%   351   10s
H 1204  1232                    -9107.672932 33146.7170   464%   340   10s
H 1378  1417                    -8941.060861 31998.5729   458%   320   11s
H 1386  1417                    -8378.058377 31998.5729   482%   318   11s
H 1402  1417                    -8272.009391 31998.5729   487%   317   11s
H 1431  1417                    -7611.164313 31998.5729   520%   318   11s
H 1527  1476                    -7350.486044 31733.3616   532%   315   11s
H 1723  1780                    -7126.356812 31733.3616   545%   304   12s
H 1742  1780                    -5506.466882 31733.3616   676%   301   12s
H 2089  2058                    -5301.405611 31733.3616   699%   274   12s
H 2105  2055                    -5074.691641 31733.3616   725%   273   12s
H 3498  3106                    -5060.305582 31424.9275   721%   211   17s
H 3498  3106                    -5049.002377 31424.9275   722%   211   17s
H 3498  3102                    -4996.192779 31424.9275   729%   211   17s
H 3498  3102                    -4966.607532 31424.9275   733%   211   17s
H 3498  3094                    -4777.910081 31424.9275   758%   211   17s
  3499  3093 6606.85833   32 1256 -4777.9101 31424.9275   758%   211   20s
  3520  3107 12318.7980   35  618 -4777.9101 14561.6867   405%   210   25s
H 3553  3006                    -4771.057416 12973.1490   372%   220   28s
H 3567  2853                    -4754.307771 12973.1490   373%   221   28s
  3773  2997 4480.16928   18  339 -4754.3078 12843.7999   370%   231   30s
H 3804  2845                    -4747.455106 12843.7999   371%   231   30s
H 3997  2813                    -4698.356586 12567.6360   367%   228   31s
H 4013  2681                    -4694.084564 12567.6360   368%   228   31s
H 4051  2547                    -4673.347253 12567.6360   369%   228   31s
H 4137  2494                    -4073.759739 11607.3444   385%   227   32s
* 4165  2376              42    -260.6867721 11607.3444  4553%   226   32s
H 4418  2222                    -258.7554842 11607.3444  4586%   224   33s
H 4595  2133                    3106.0386056 10956.9720   253%   222   33s
H 4764  1984                    3121.8743411 10380.3977   233%   220   34s
H 4770  1893                    3121.9349148 10380.3977   232%   220   34s
  4956  1847 4068.99422   23  224 3121.93491 9849.18681   215%   218   35s
H 4961  1762                    3129.8946709 9849.18681   215%   218   35s
H 5000  1669                    3137.7706503 9360.30375   198%   218   35s
H 5303  1515                    3141.3321028 9360.30375   198%   216   36s
H 5340  1430                    3623.4478081 9360.30375   158%   216   36s
H 5544  1265                    3663.3401096 8754.08988   139%   214   37s
H 5545  1200                    3676.7387162 8754.08988   138%   213   37s
H 5561  1133                    3704.8061895 8754.08988   136%   213   37s
  6883    51     cutoff   40      3704.80619 4780.88522  29.0%   193   40s

Cutting planes:
  Implied bound: 6
  Projected implied bound: 132
  MIR: 353
  Flow cover: 575
  Zero half: 1
  RLT: 20
  Relax-and-lift: 169

Explored 6910 nodes (1346108 simplex iterations) in 40.22 seconds (81.85 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3704.81 3676.74 3663.34 ... 3106.04

Optimal solution found (tolerance 1.00e-06)
Best objective 3.704806189523e+03, best bound 3.704806189523e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 40.23s
  Master Objective (UB) = 3704.81, θ = 127584.09
  Upper Bound (UB) = 3704.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 127584.09
  [DEBUG]   ✓ Scenario 0: θ = 127584.09 ≤ Q = 127584.09 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x72c71ac6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8d38e53a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.077478e+13
Presolve removed 2626 rows and 1919 columns
Presolve time: 0.00s
Presolved: 467 rows, 470 columns, 1281 nonzeros
Found heuristic solution: objective 5402805.8635
Variable types: 315 continuous, 155 integer (155 binary)
Found heuristic solution: objective 5402340.9419

Root relaxation: objective -1.047539e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -104753.90    0  116 5402340.94 -104753.90   102%     -    0s
H    0     0                    -61963.27770 -104753.90  69.1%     -    0s
H    0     0                    -72371.98601 -104753.90  44.7%     -    0s
H    0     0                    -73456.31229 -104753.90  42.6%     -    0s
H    0     0                    -73637.86941 -104753.90  42.3%     -    0s
*    0     0               0    -75162.17223 -75162.172  0.00%     -    0s

Cutting planes:
  Gomory: 23
  MIR: 172

Explored 1 nodes (338 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -75162.2 -73637.9 -73456.3 ... 1.07748e+13
No other solutions better than -75162.2

Optimal solution found (tolerance 1.00e-06)
Best objective -7.516217223230e+04, best bound -7.516217223230e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 92327.65
  Scenario: 1 demand increases, 58 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -75162.17
  [DEBUG]   S×d_nominal = 167489.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 167489.82 + -75162.17 = 92327.65
  [DEBUG]   Current θ from Master = 127584.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 35256.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -31551.64
  Lower Bound (LB) = -31551.64
  Gap (UB-LB) = 35256.4475, Absolute Gap = 35256.4475, Relative Gap = 9.516408
  Not converged yet (gap = 35256.45 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 1 increases, 58 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91969 nonzeros
Model fingerprint: 0xb2a89c30
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -31551.6 (0.01s)
Loaded MIP start from previous solve with objective -31551.6

Presolve removed 14605 rows and 5924 columns
Presolve time: 0.31s
Presolved: 17358 rows, 8816 columns, 95998 nonzeros
Variable types: 6557 continuous, 2259 integer (2259 binary)

Root relaxation: objective 3.957662e+03, 9680 iterations, 1.49 seconds (2.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3957.66162    0  474 -31551.641 3957.66162   113%     -    1s
H    0     0                    -29913.38830 3957.66162   113%     -    2s
H    0     0                    -29906.37112 3957.66162   113%     -    2s
H    0     0                    -29844.55693 3956.95798   113%     -    2s
     0     0 -1490.5739    0  827 -29844.557 -1490.5739  95.0%     -    3s
H    0     0                    -29803.57874 -1490.9108  95.0%     -    3s
     0     0 -1649.8247    0  816 -29803.579 -1649.8247  94.5%     -    4s
     0     0 -1649.8247    0  813 -29803.579 -1649.8247  94.5%     -    4s
     0     0 -1649.8247    0  816 -29803.579 -1649.8247  94.5%     -    4s
H    0     0                    -28232.94683 -6572.1564  76.7%     -    6s
H    0     0                    -27165.11073 -6572.1564  75.8%     -    6s
H    0     0                    -27164.98809 -6572.1564  75.8%     -    6s
H    0     0                    -26844.41123 -6572.1564  75.5%     -    6s
     0     0 -6572.1564    0  804 -26844.411 -6572.1564  75.5%     -    6s
H    0     0                    -26815.43792 -6573.8470  75.5%     -    7s
H    0     0                    -26791.16314 -6573.8470  75.5%     -    7s
H    0     0                    -26769.53932 -6573.8470  75.4%     -    7s
H    0     0                    -26740.67627 -6573.8470  75.4%     -    7s
H    0     0                    -26736.61212 -6573.8470  75.4%     -    7s
H    0     0                    -26723.03770 -6573.8470  75.4%     -    7s
     0     0 -7009.6571    0  818 -26723.038 -7009.6571  73.8%     -    7s
     0     0 -7089.8158    0  811 -26723.038 -7089.8158  73.5%     -    7s
     0     0 -7093.8489    0  814 -26723.038 -7093.8489  73.5%     -    8s
     0     0 -7094.9478    0  814 -26723.038 -7094.9478  73.5%     -    8s
H    0     0                    -26705.87872 -7094.9478  73.4%     -    9s
H    0     0                    -26658.06493 -9557.0066  64.1%     -   11s
H    0     0                    -26641.29002 -9557.0066  64.1%     -   11s
H    0     0                    -26637.28399 -9557.0066  64.1%     -   11s
H    0     0                    -26623.70958 -9557.0066  64.1%     -   11s
     0     0 -9557.0066    0  774 -26623.710 -9557.0066  64.1%     -   11s
H    0     0                    -26620.09358 -9900.7378  62.8%     -   12s
H    0     0                    -26317.20099 -9900.7378  62.4%     -   12s
H    0     0                    -26316.68525 -9900.7378  62.4%     -   12s
     0     0 -9900.7378    0  796 -26316.685 -9900.7378  62.4%     -   12s
     0     0 -9975.5980    0  803 -26316.685 -9975.5980  62.1%     -   13s
     0     0 -9984.1396    0  815 -26316.685 -9984.1396  62.1%     -   13s
     0     0 -9985.5374    0  813 -26316.685 -9985.5374  62.1%     -   13s
H    0     0                    -26289.05201 -9985.5374  62.0%     -   15s
H    0     0                    -26282.38739 -9985.5374  62.0%     -   15s
H    0     0                    -25506.47443 -9985.5374  60.9%     -   15s
H    0     0                    -25494.81804 -9985.5374  60.8%     -   15s
H    0     0                    -25489.52587 -9985.5374  60.8%     -   15s
     0     0 -10920.875    0  583 -25489.526 -10920.875  57.2%     -   17s
H    0     0                    -25461.99602 -10921.269  57.1%     -   17s
     0     0 -11262.891    0  675 -25461.996 -11262.891  55.8%     -   18s
     0     0 -11308.187    0  662 -25461.996 -11308.187  55.6%     -   19s
     0     0 -11320.637    0  658 -25461.996 -11320.637  55.5%     -   19s
     0     0 -11324.343    0  673 -25461.996 -11324.343  55.5%     -   19s
     0     0 -11732.316    0  648 -25461.996 -11732.316  53.9%     -   21s
     0     0 -11877.378    0  679 -25461.996 -11877.378  53.4%     -   21s
     0     0 -11923.649    0  670 -25461.996 -11923.649  53.2%     -   22s
     0     0 -11932.392    0  589 -25461.996 -11932.392  53.1%     -   22s
     0     0 -11934.591    0  767 -25461.996 -11934.591  53.1%     -   22s
     0     0 -12109.749    0  763 -25461.996 -12109.749  52.4%     -   23s
H    0     0                    -25449.15282 -12109.881  52.4%     -   24s
H    0     0                    -25445.36979 -12188.428  52.1%     -   25s
H    0     0                    -24842.15564 -12188.428  50.9%     -   25s
H    0     0                    -24832.64509 -12188.428  50.9%     -   25s
H    0     0                    -24790.62953 -12188.428  50.8%     -   25s
H    0     0                    -23580.53405 -12188.428  48.3%     -   25s
H    0     0                    -23562.80256 -12188.428  48.3%     -   25s
H    0     0                    -23561.08993 -12188.428  48.3%     -   25s
H    0     0                    -23461.12016 -12188.428  48.0%     -   25s
H    0     0                    -23442.64495 -12188.428  48.0%     -   25s
H    0     0                    -23294.45779 -12188.428  47.7%     -   25s
     0     0 -12188.428    0  594 -23294.458 -12188.428  47.7%     -   25s
     0     0 -12198.461    0  596 -23294.458 -12198.461  47.6%     -   25s
     0     0 -12199.253    0  608 -23294.458 -12199.253  47.6%     -   25s
H    0     0                    -23293.87753 -12277.749  47.3%     -   26s
H    0     0                    -23271.60527 -12277.749  47.2%     -   26s
H    0     0                    -23269.57784 -12277.749  47.2%     -   26s
H    0     0                    -23257.77329 -12277.749  47.2%     -   26s
     0     0 -12277.749    0  674 -23257.773 -12277.749  47.2%     -   26s
H    0     0                    -23067.71552 -12277.809  46.8%     -   26s
H    0     0                    -23031.76851 -12277.809  46.7%     -   26s
H    0     0                    -23021.43236 -12277.809  46.7%     -   26s
     0     0 -12302.753    0  687 -23021.432 -12302.753  46.6%     -   26s
     0     0 -12320.057    0  689 -23021.432 -12320.057  46.5%     -   27s
     0     0 -12325.267    0  679 -23021.432 -12325.267  46.5%     -   27s
     0     0 -12412.953    0  656 -23021.432 -12412.953  46.1%     -   28s
H    0     0                    -22651.39863 -12412.988  45.2%     -   28s
H    0     0                    -22621.34548 -12412.988  45.1%     -   28s
H    0     0                    -22571.39442 -12412.988  45.0%     -   28s
H    0     0                    -22560.66090 -12412.988  45.0%     -   28s
     0     0 -12432.505    0  705 -22560.661 -12432.505  44.9%     -   28s
     0     0 -12440.184    0  687 -22560.661 -12440.184  44.9%     -   29s
     0     0 -12442.735    0  703 -22560.661 -12442.735  44.8%     -   29s
     0     0 -12479.020    0  603 -22560.661 -12479.020  44.7%     -   30s
H    0     0                    -22439.08653 -12479.447  44.4%     -   30s
     0     0 -12500.126    0  840 -22439.087 -12500.126  44.3%     -   30s
     0     0 -12506.703    0  836 -22439.087 -12506.703  44.3%     -   30s
     0     0 -12534.585    0  611 -22439.087 -12534.585  44.1%     -   31s
     0     0 -12534.794    0  611 -22439.087 -12534.794  44.1%     -   32s
H    0     0                    -22013.30633 -12534.915  43.1%     -   36s
     0     2 -12534.915    0  611 -22013.306 -12534.915  43.1%     -   38s
     3     8 -13104.313    2  524 -22013.306 -12715.963  42.2%  1391   41s
    63    84 -17932.472    6  449 -22013.306 -14164.332  35.7%  1537   45s
H   96   111                    -22010.45577 -14643.115  33.5%  1482   46s
H  138   131                    -22007.88225 -14643.115  33.5%  1235   48s
H  159   131                    -22007.00031 -14643.115  33.5%  1137   48s
   288   213     cutoff   13      -22007.000 -14643.115  33.5%   832   50s
   635   354     cutoff   10      -22007.000 -15781.961  28.3%   614   55s
H  946   377                    -22006.49722 -16455.754  25.2%   551   59s
  1010   382     cutoff   15      -22006.497 -16455.754  25.2%   543   61s
  1477   503     cutoff   10      -22006.497 -16738.665  23.9%   483   66s
  2084   657 infeasible    9      -22006.497 -18035.444  18.0%   420   71s
H 2399   646                    -21453.54803 -18172.001  15.3%   393   73s
  2747   650 infeasible   18      -21453.548 -18172.001  15.3%   365   75s
  4755  1081 -20843.445   31   56 -21453.548 -20281.553  5.46%   263   80s
H 8009   550                    -21443.29996 -20900.547  2.53%   188   84s
  8322   115     cutoff   29      -21443.300 -20967.453  2.22%   183   85s

Cutting planes:
  Gomory: 2
  Implied bound: 12
  MIR: 2423
  Flow cover: 1180
  Inf proof: 3
  Zero half: 9
  RLT: 109
  Relax-and-lift: 380

Explored 9760 nodes (1638790 simplex iterations) in 86.65 seconds (193.44 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -21443.3 -21453.5 -22006.5 ... -22571.4
No other solutions better than -21443.3

Optimal solution found (tolerance 1.00e-06)
Best objective -2.144329996150e+04, best bound -2.144329996150e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 86.66s
  Master Objective (UB) = -21443.30, θ = 94250.40
  Upper Bound (UB) = -21443.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94250.40
  [DEBUG]   ✓ Scenario 0: θ = 94250.40 ≤ Q = 94250.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94250.40 ≤ Q = 94250.40 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x63991c71
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9c66e38f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.386945e+13
Presolve removed 2619 rows and 1913 columns
Presolve time: 0.00s
Presolved: 474 rows, 476 columns, 1300 nonzeros
Found heuristic solution: objective 7044928.8218
Variable types: 320 continuous, 156 integer (156 binary)

Root relaxation: objective -1.176158e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117615.76    0  127 7044928.82 -117615.76   102%     -    0s
H    0     0                    -77478.54856 -117615.76  51.8%     -    0s
H    0     0                    -78590.24263 -117615.76  49.7%     -    0s
H    0     0                    -93526.36970 -117615.76  25.8%     -    0s
H    0     0                    -93596.37122 -117426.80  25.5%     -    0s
H    0     0                    -103669.8921 -104804.56  1.09%     -    0s
     0     0 -104804.56    0   56 -103669.89 -104804.56  1.09%     -    0s
H    0     0                    -103789.8944 -104751.07  0.93%     -    0s
H    0     0                    -103856.7213 -104751.07  0.86%     -    0s
     0     0 -104588.02    0   58 -103856.72 -104588.02  0.70%     -    0s
     0     0 -104580.47    0   58 -103856.72 -104580.47  0.70%     -    0s
     0     0 -104580.33    0   58 -103856.72 -104580.33  0.70%     -    0s
     0     0 -104393.78    0   34 -103856.72 -104393.78  0.52%     -    0s
H    0     0                    -104173.8345 -104390.52  0.21%     -    0s
H    0     0                    -104226.8962 -104303.50  0.07%     -    0s
     0     0 -104303.50    0   31 -104226.90 -104303.50  0.07%     -    0s
     0     0 -104278.41    0    6 -104226.90 -104278.41  0.05%     -    0s
     0     0 -104266.01    0    5 -104226.90 -104266.01  0.04%     -    0s
     0     0 -104239.65    0    3 -104226.90 -104239.65  0.01%     -    0s
     0     0     cutoff    0      -104226.90 -104226.90  0.00%     -    0s

Cutting planes:
  Gomory: 30
  Implied bound: 1
  MIR: 78
  Flow cover: 2
  RLT: 68
  Relax-and-lift: 3
  BQP: 2

Explored 1 nodes (586 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104227 -104174 -103857 ... 7.04493e+06
No other solutions better than -104227

Optimal solution found (tolerance 1.00e-06)
Best objective -1.042268961889e+05, best bound -1.042268961889e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 70162.23
  Scenario: 28 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104226.90
  [DEBUG]   S×d_nominal = 174389.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 174389.12 + -104226.90 = 70162.23
  [DEBUG]   Current θ from Master = 94250.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24088.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -45531.48
  Lower Bound (LB) = -31551.64
  Gap (UB-LB) = 10108.3414, Absolute Gap = 10108.3414, Relative Gap = 0.471399
  Not converged yet (gap = 10108.34 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 31 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135194 nonzeros
Model fingerprint: 0xd621a22a
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -45531.5 (0.02s)
Loaded MIP start from previous solve with objective -45531.5

Presolve removed 21906 rows and 8886 columns
Presolve time: 0.41s
Presolved: 25347 rows, 12094 columns, 141689 nonzeros
Variable types: 9835 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.868701e+03, 19106 iterations, 3.53 seconds (7.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 3868.70104    0  476 -45531.478 3868.70104   108%     -    4s
H    0     0                    -28613.15306 3868.70104   114%     -    4s
H    0     0                    -28470.79870 3868.70104   114%     -    4s
H    0     0                    -28362.06834 3868.70104   114%     -    4s
H    0     0                    -22301.73668 3868.70104   117%     -    4s
H    0     0                    -22217.46819 3868.70104   117%     -    4s
     0     0 -1446.6003    0  810 -22217.468 -1446.6003  93.5%     -    7s
     0     0 -1575.3792    0  826 -22217.468 -1575.3792  92.9%     -    8s
     0     0 -1679.4372    0  828 -22217.468 -1679.4372  92.4%     -    8s
     0     0 -1681.5438    0  830 -22217.468 -1681.5438  92.4%     -    8s
     0     0 -1681.5438    0  830 -22217.468 -1681.5438  92.4%     -    8s
     0     0 -6834.9789    0  677 -22217.468 -6834.9789  69.2%     -   14s
H    0     0                    -21987.18989 -6834.9789  68.9%     -   14s
H    0     0                    -21986.09812 -6834.9789  68.9%     -   14s
H    0     0                    -21980.52032 -6834.9789  68.9%     -   14s
H    0     0                    -21953.74509 -6834.9789  68.9%     -   14s
H    0     0                    -21932.60405 -6834.9789  68.8%     -   14s
H    0     0                    -21907.18411 -6834.9789  68.8%     -   14s
H    0     0                    -21762.87224 -7285.5779  66.5%     -   16s
H    0     0                    -21735.62754 -7285.5779  66.5%     -   16s
     0     0 -7285.5779    0  828 -21735.628 -7285.5779  66.5%     -   16s
     0     0 -7390.5013    0  815 -21735.628 -7390.5013  66.0%     -   17s
     0     0 -7428.9716    0  844 -21735.628 -7428.9716  65.8%     -   17s
     0     0 -7436.5788    0  830 -21735.628 -7436.5788  65.8%     -   17s
     0     0 -7440.0853    0  836 -21735.628 -7440.0853  65.8%     -   17s
     0     0 -7440.1296    0  840 -21735.628 -7440.1296  65.8%     -   18s
     0     0 -9788.8672    0  806 -21735.628 -9788.8672  55.0%     -   24s
     0     0 -10168.136    0  812 -21735.628 -10168.136  53.2%     -   26s
     0     0 -10247.343    0  826 -21735.628 -10247.343  52.9%     -   28s
     0     0 -10280.657    0  840 -21735.628 -10280.657  52.7%     -   28s
H    0     0                    -21702.14686 -10290.157  52.6%     -   29s
H    0     0                    -21701.11174 -10290.157  52.6%     -   29s
     0     0 -10290.157    0  848 -21701.112 -10290.157  52.6%     -   29s
     0     0 -10292.374    0  849 -21701.112 -10292.374  52.6%     -   29s
     0     0 -11279.002    0  792 -21701.112 -11279.002  48.0%     -   36s
     0     0 -11575.413    0  629 -21701.112 -11575.413  46.7%     -   39s
     0     0 -11633.500    0  872 -21701.112 -11633.500  46.4%     -   40s
     0     0 -11652.682    0  554 -21701.112 -11652.682  46.3%     -   41s
     0     0 -11657.147    0  712 -21701.112 -11657.147  46.3%     -   41s
     0     0 -11874.430    0  773 -21701.112 -11874.430  45.3%     -   44s
     0     0 -11954.387    0  857 -21701.112 -11954.387  44.9%     -   47s
     0     0 -11987.131    0  620 -21701.112 -11987.131  44.8%     -   47s
     0     0 -11996.108    0  633 -21701.112 -11996.108  44.7%     -   48s
     0     0 -11999.672    0  642 -21701.112 -11999.672  44.7%     -   48s
     0     0 -12177.556    0  617 -21701.112 -12177.556  43.9%     -   51s
     0     0 -12196.433    0  681 -21701.112 -12196.433  43.8%     -   53s
     0     0 -12203.940    0  759 -21701.112 -12203.940  43.8%     -   54s
     0     0 -12206.092    0  684 -21701.112 -12206.092  43.8%     -   55s
     0     0 -12265.054    0  867 -21701.112 -12265.054  43.5%     -   57s
     0     0 -12287.877    0  762 -21701.112 -12287.877  43.4%     -   58s
     0     0 -12295.703    0  680 -21701.112 -12295.703  43.3%     -   59s
     0     0 -12298.629    0  681 -21701.112 -12298.629  43.3%     -   60s
     0     0 -12326.306    0  690 -21701.112 -12326.306  43.2%     -   62s
     0     0 -12335.017    0  639 -21701.112 -12335.017  43.2%     -   63s
     0     0 -12338.552    0  864 -21701.112 -12338.552  43.1%     -   64s
     0     0 -12365.470    0  541 -21701.112 -12365.470  43.0%     -   66s
     0     0 -12371.179    0  605 -21701.112 -12371.179  43.0%     -   67s
     0     0 -12395.035    0  617 -21701.112 -12395.035  42.9%     -   69s
     0     0 -12395.453    0  617 -21701.112 -12395.453  42.9%     -   69s
     0     2 -12395.453    0  617 -21701.112 -12395.453  42.9%     -   78s
     1     4 -12751.176    1  706 -21701.112 -12395.645  42.9%  4305   81s
     7    16 -13830.658    3  518 -21701.112 -12983.633  40.2%  4326   87s
    15    32 -13881.772    4  522 -21701.112 -13212.247  39.1%  3620   91s
    31    53 -14033.636    5  344 -21701.112 -13502.161  37.8%  4800  101s
    88   111 -19763.114    7  427 -21701.112 -13798.610  36.4%  4994  109s
H  102   111                    -21624.75258 -13798.610  36.2%  4759  109s
H  118   111                    -21624.25688 -13798.610  36.2%  4328  109s
   122   245 -19823.342    8  436 -21624.257 -13798.610  36.2%  4237  112s
   271   273 -20316.406   12  428 -21624.257 -13798.610  36.2%  2458  115s
   421   385 infeasible   14      -21624.257 -13798.610  36.2%  2054  121s
   487   431 -21367.212   14  250 -21624.257 -13798.610  36.2%  1905  126s
   640   512     cutoff   16      -21624.257 -13798.610  36.2%  1756  131s
   726   564 -17036.913   13  373 -21624.257 -14276.250  34.0%  1710  137s
   897   650 -18477.911   15  266 -21624.257 -14276.425  34.0%  1573  144s
   982   667 -18618.668   16  269 -21624.257 -14276.425  34.0%  1541  148s
  1065   701 -19468.685   18  265 -21624.257 -14276.425  34.0%  1541  151s
  1245   806 -21546.958   29  250 -21624.257 -14599.124  32.5%  1543  156s
  1346   853 -21586.409   29  241 -21624.257 -14599.124  32.5%  1515  160s
  1567   958 -16711.332    8  291 -21624.257 -14954.746  30.8%  1490  166s
  1791  1139 -17126.959   10  293 -21624.257 -14954.746  30.8%  1460  172s
  2071  1317 -17498.956   13  291 -21624.257 -15140.527  30.0%  1421  177s
  2263  1391 -17607.503   14  380 -21624.257 -15474.902  28.4%  1373  180s
  2703  1629 -17976.681   19  272 -21624.257 -15778.017  27.0%  1284  188s
  2886  1682 -18506.911   22  264 -21624.257 -16146.993  25.3%  1255  193s
  3071  1773 -19399.418   24  268 -21624.257 -16222.898  25.0%  1243  197s
  3311  1802 -18916.274   12  304 -21624.257 -16222.898  25.0%  1222  200s
  3814  1859     cutoff   14      -21624.257 -16491.524  23.7%  1192  208s
  3892  1873     cutoff   17      -21624.257 -16628.668  23.1%  1204  212s
  4106  1858     cutoff   20      -21624.257 -16680.155  22.9%  1196  218s
  4291  1821     cutoff    7      -21624.257 -16808.024  22.3%  1220  222s
  4530  1806     cutoff   10      -21624.257 -16820.350  22.2%  1222  228s
  4738  1790 -20788.924   10  294 -21624.257 -16942.889  21.6%  1238  233s
  4939  1780 -19643.186   12  289 -21624.257 -16942.889  21.6%  1253  237s
  5227  1742 -20052.627   19  219 -21624.257 -16942.889  21.6%  1250  245s
  5804  1660 infeasible   11      -21624.257 -17541.964  18.9%  1244  254s
  6122  1680     cutoff   15      -21624.257 -17844.024  17.5%  1240  259s
  6483  1650     cutoff    8      -21624.257 -18003.515  16.7%  1224  263s
  6820  1646     cutoff   11      -21624.257 -18096.792  16.3%  1221  267s
  6888  1643 -20933.393   30  156 -21624.257 -18096.792  16.3%  1226  271s
  7029  1652     cutoff   31      -21624.257 -18096.792  16.3%  1224  276s
H 7099  1652                    -21620.37212 -18245.768  15.6%  1223  276s
  7156  1599 -19764.775   28  251 -21620.372 -18270.469  15.5%  1217  281s
  7681  1532 -19906.164   34  233 -21620.372 -18515.326  14.4%  1188  285s
  8203  1478     cutoff   12      -21620.372 -18743.210  13.3%  1165  290s
  8583  1329 -20268.296   25  267 -21620.372 -18984.515  12.2%  1143  295s
  9334  1137 -20601.613   17  258 -21620.372 -19293.998  10.8%  1106  300s
 10110   919     cutoff   24      -21620.372 -19613.365  9.28%  1069  306s
 11223   865 infeasible   20      -21620.372 -20022.274  7.39%  1009  310s
 14976   274 -21282.211   21  216 -21620.372 -20883.518  3.41%   822  317s

Cutting planes:
  Gomory: 8
  MIR: 3442
  Flow cover: 1640
  Inf proof: 8
  Zero half: 9
  RLT: 182
  Relax-and-lift: 629

Explored 19626 nodes (12832383 simplex iterations) in 318.62 seconds (819.68 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -21620.4 -21624.3 -21624.8 ... -21953.7
No other solutions better than -21620.4

Optimal solution found (tolerance 1.00e-06)
Best objective -2.162037211725e+04, best bound -2.162037211725e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 318.65s
  Master Objective (UB) = -21620.37, θ = 93706.21
  Upper Bound (UB) = -21620.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93706.21
  [DEBUG]   ✓ Scenario 0: θ = 93706.21 ≤ Q = 93706.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93706.21 ≤ Q = 93706.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93706.21 ≤ Q = 93706.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x616b76a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf9e94896
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.376450e+13
Presolve removed 2619 rows and 1913 columns
Presolve time: 0.00s
Presolved: 474 rows, 476 columns, 1300 nonzeros
Found heuristic solution: objective 6941133.7652
Variable types: 320 continuous, 156 integer (156 binary)

Root relaxation: objective -1.126312e+05, 222 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112631.18    0  120 6941133.77 -112631.18   102%     -    0s
H    0     0                    -79564.11615 -112631.18  41.6%     -    0s
H    0     0                    -80012.65663 -112631.18  40.8%     -    0s
H    0     0                    -81466.00049 -112631.18  38.3%     -    0s
H    0     0                    -86858.10230 -97702.086  12.5%     -    0s
H    0     0                    -87080.37282 -97702.086  12.2%     -    0s
     0     0 -97702.086    0  120 -87080.373 -97702.086  12.2%     -    0s
H    0     0                    -94239.53780 -97685.919  3.66%     -    0s
H    0     0                    -94999.34953 -97685.919  2.83%     -    0s
     0     0 -97312.992    0  118 -94999.350 -97312.992  2.44%     -    0s
     0     0 -97271.124    0  118 -94999.350 -97271.124  2.39%     -    0s
     0     0 -97271.124    0  118 -94999.350 -97271.124  2.39%     -    0s
     0     0 -96571.376    0  106 -94999.350 -96571.376  1.65%     -    0s
H    0     0                    -95315.08943 -96514.252  1.26%     -    0s
     0     0 -96514.252    0  104 -95315.089 -96514.252  1.26%     -    0s
     0     0 -96265.678    0   82 -95315.089 -96265.678  1.00%     -    0s
     0     0 -96116.414    0   94 -95315.089 -96116.414  0.84%     -    0s
     0     0 -96107.975    0   78 -95315.089 -96107.975  0.83%     -    0s
     0     0 -95886.303    0   68 -95315.089 -95886.303  0.60%     -    0s
     0     0 -95834.181    0   76 -95315.089 -95834.181  0.54%     -    0s
     0     0 -95815.771    0   79 -95315.089 -95815.771  0.53%     -    0s
     0     0 -95813.964    0   85 -95315.089 -95813.964  0.52%     -    0s
     0     0 -95629.125    0   34 -95315.089 -95629.125  0.33%     -    0s
     0     0 -95627.008    0   21 -95315.089 -95627.008  0.33%     -    0s
     0     0 -95613.976    0   20 -95315.089 -95613.976  0.31%     -    0s
     0     0 -95590.996    0   19 -95315.089 -95590.996  0.29%     -    0s
     0     0 -95585.663    0   18 -95315.089 -95585.663  0.28%     -    0s
     0     0 -95584.896    0   18 -95315.089 -95584.896  0.28%     -    0s
     0     0 -95493.542    0   16 -95315.089 -95493.542  0.19%     -    0s
     0     0 -95493.102    0   16 -95315.089 -95493.102  0.19%     -    0s
     0     0 -95417.578    0   15 -95315.089 -95417.578  0.11%     -    0s
     0     0 -95417.578    0   16 -95315.089 -95417.578  0.11%     -    0s
     0     0 -95371.305    0    9 -95315.089 -95371.305  0.06%     -    0s
     0     0 -95329.296    0   10 -95315.089 -95329.296  0.01%     -    0s
     0     0     cutoff    0      -95315.089 -95315.089  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 2
  MIR: 3
  Flow cover: 13
  Relax-and-lift: 1

Explored 1 nodes (978 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -95315.1 -95215.6 -94999.3 ... 1.37645e+13
No other solutions better than -95315.1

Optimal solution found (tolerance 1.00e-06)
Best objective -9.531508943326e+04, best bound -9.531508943326e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 78658.27
  Scenario: 59 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95315.09
  [DEBUG]   S×d_nominal = 173973.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173973.36 + -95315.09 = 78658.27
  [DEBUG]   Current θ from Master = 93706.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15047.94 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -36668.31
  Lower Bound (LB) = -31551.64
  Gap (UB-LB) = 9931.2692, Absolute Gap = 9931.2692, Relative Gap = 0.459348
  Not converged yet (gap = 9931.27 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 59 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178419 nonzeros
Model fingerprint: 0x94bea5de
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -36668.3 (0.04s)
MIP start from previous solve produced solution with objective -36668.3 (0.04s)
Loaded MIP start from previous solve with objective -36668.3

Presolve removed 29148 rows and 11838 columns
Presolve time: 0.54s
Presolved: 33395 rows, 15382 columns, 206299 nonzeros
Variable types: 13123 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33395 rows, 15382 columns, 206299 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37068   -1.0087042e+04   0.000000e+00   7.764180e+05      5s
   49011   -7.0792397e+03   0.000000e+00   8.616290e+04     10s
Concurrent spin time: 2.43s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -6.767839e+03, 31717 iterations, 13.29 seconds (24.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6767.8387    0  369 -36668.314 -6767.8387  81.5%     -   14s
H    0     0                    -34939.50059 -6767.8387  80.6%     -   14s
H    0     0                    -32720.70177 -6767.8387  79.3%     -   14s
     0     0 -9630.4520    0  516 -32720.702 -9630.4520  70.6%     -   18s
     0     0 -9702.5223    0  523 -32720.702 -9702.5223  70.3%     -   19s
     0     0 -9864.6561    0  529 -32720.702 -9864.6561  69.9%     -   19s
     0     0 -9866.0876    0  528 -32720.702 -9866.0876  69.8%     -   19s
     0     0 -9866.3947    0  528 -32720.702 -9866.3947  69.8%     -   20s
H    0     0                    -32649.89224 -11461.044  64.9%     -   25s
     0     0 -11466.381    0  476 -32649.892 -11466.381  64.9%     -   25s
H    0     0                    -32603.09550 -11466.381  64.8%     -   25s
     0     0 -11932.374    0  490 -32603.096 -11932.374  63.4%     -   27s
     0     0 -11958.602    0  493 -32603.096 -11958.602  63.3%     -   28s
     0     0 -11960.989    0  488 -32603.096 -11960.989  63.3%     -   28s
     0     0 -11960.990    0  488 -32603.096 -11960.990  63.3%     -   28s
H    0     0                    -32592.00802 -13469.331  58.7%     -   35s
H    0     0                    -32588.00200 -13469.331  58.7%     -   35s
     0     0 -13469.331    0  532 -32588.002 -13469.331  58.7%     -   36s
H    0     0                    -32583.63472 -13742.914  57.8%     -   38s
     0     0 -13742.914    0  519 -32583.635 -13742.914  57.8%     -   38s
     0     0 -13823.132    0  543 -32583.635 -13823.132  57.6%     -   39s
H    0     0                    -31902.35116 -13839.149  56.6%     -   40s
     0     0 -13839.149    0  530 -31902.351 -13839.149  56.6%     -   40s
     0     0 -13846.258    0  539 -31902.351 -13846.258  56.6%     -   40s
     0     0 -13848.754    0  540 -31902.351 -13848.754  56.6%     -   40s
     0     0 -13848.889    0  541 -31902.351 -13848.889  56.6%     -   40s
H    0     0                    -28288.16563 -13848.889  51.0%     -   44s
H    0     0                    -26935.64313 -13848.889  48.6%     -   44s
H    0     0                    -26930.91314 -13848.889  48.6%     -   44s
H    0     0                    -26616.51436 -13848.889  48.0%     -   44s
H    0     0                    -26615.99862 -13848.889  48.0%     -   44s
H    0     0                    -26613.67074 -13848.889  48.0%     -   44s
H    0     0                    -26529.27456 -14472.852  45.4%     -   48s
H    0     0                    -26522.09420 -14472.852  45.4%     -   48s
H    0     0                    -26511.03030 -14472.852  45.4%     -   48s
H    0     0                    -26499.76161 -14472.852  45.4%     -   48s
     0     0 -14472.852    0  576 -26499.762 -14472.852  45.4%     -   48s
     0     0 -14934.153    0  647 -26499.762 -14934.153  43.6%     -   53s
H    0     0                    -26464.13819 -15131.161  42.8%     -   55s
H    0     0                    -26376.16875 -15131.161  42.6%     -   55s
H    0     0                    -26375.65301 -15131.161  42.6%     -   55s
     0     0 -15131.161    0  606 -26375.653 -15131.161  42.6%     -   55s
     0     0 -15205.480    0  615 -26375.653 -15205.480  42.4%     -   57s
     0     0 -15233.449    0  640 -26375.653 -15233.449  42.2%     -   58s
     0     0 -15250.518    0  632 -26375.653 -15250.518  42.2%     -   58s
     0     0 -15256.858    0  640 -26375.653 -15256.858  42.2%     -   59s
     0     0 -15259.139    0  641 -26375.653 -15259.139  42.1%     -   59s
     0     0 -15260.546    0  640 -26375.653 -15260.546  42.1%     -   59s
     0     0 -15260.778    0  643 -26375.653 -15260.778  42.1%     -   59s
     0     0 -15404.892    0  649 -26375.653 -15404.892  41.6%     -   62s
     0     0 -15492.434    0  582 -26375.653 -15492.434  41.3%     -   65s
     0     0 -15500.962    0  592 -26375.653 -15500.962  41.2%     -   66s
     0     0 -15508.241    0  593 -26375.653 -15508.241  41.2%     -   66s
     0     0 -15509.632    0  595 -26375.653 -15509.632  41.2%     -   66s
     0     0 -15509.781    0  595 -26375.653 -15509.781  41.2%     -   67s
     0     0 -15627.687    0  606 -26375.653 -15627.687  40.7%     -   70s
     0     0 -15664.077    0  611 -26375.653 -15664.077  40.6%     -   73s
     0     0 -15672.078    0  607 -26375.653 -15672.078  40.6%     -   73s
     0     0 -15673.709    0  613 -26375.653 -15673.709  40.6%     -   73s
     0     0 -15674.022    0  613 -26375.653 -15674.022  40.6%     -   73s
     0     0 -15715.929    0  600 -26375.653 -15715.929  40.4%     -   75s
     0     0 -15722.497    0  598 -26375.653 -15722.497  40.4%     -   77s
     0     0 -15725.088    0  609 -26375.653 -15725.088  40.4%     -   77s
     0     0 -15725.723    0  605 -26375.653 -15725.723  40.4%     -   77s
     0     0 -15775.909    0  591 -26375.653 -15775.909  40.2%     -   79s
     0     0 -15796.580    0  672 -26375.653 -15796.580  40.1%     -   81s
     0     0 -15801.030    0  603 -26375.653 -15801.030  40.1%     -   82s
     0     0 -15801.387    0  668 -26375.653 -15801.387  40.1%     -   82s
     0     0 -15816.079    0  655 -26375.653 -15816.079  40.0%     -   84s
     0     0 -15818.535    0  618 -26375.653 -15818.535  40.0%     -   85s
     0     0 -15819.610    0  625 -26375.653 -15819.610  40.0%     -   85s
     0     0 -15829.361    0  612 -26375.653 -15829.361  40.0%     -   87s
     0     0 -15831.531    0  689 -26375.653 -15831.531  40.0%     -   88s
     0     0 -15833.240    0  629 -26375.653 -15833.240  40.0%     -   89s
     0     0 -15834.275    0  627 -26375.653 -15834.275  40.0%     -   89s
     0     0 -15841.353    0  622 -26375.653 -15841.353  39.9%     -   90s
     0     0 -15841.617    0  622 -26375.653 -15841.617  39.9%     -   91s
H    0     0                    -25612.38498 -15842.268  38.1%     -  106s
H    0     0                    -25569.77896 -15842.268  38.0%     -  106s
H    0     2                    -25477.27726 -15842.268  37.8%     -  107s
     0     2 -15842.268    0  622 -25477.277 -15842.268  37.8%     -  107s
     3     8 -15962.273    2  681 -25477.277 -15932.643  37.5%  1831  110s
     7    16 -16061.887    3  673 -25477.277 -15962.561  37.3%  2536  115s
    15    32 -16138.370    4  733 -25477.277 -16062.633  37.0%  3183  121s
    31    64 -16383.934    5  715 -25477.277 -16138.931  36.7%  5739  125s
H   36    64                    -25452.84614 -16138.931  36.6%  5211  125s
H   41    64                    -25426.68166 -16138.931  36.5%  4801  125s
    95   158 -16508.482    7  713 -25426.682 -16383.961  35.6%  3636  134s
H  130   158                    -25402.25053 -16383.961  35.5%  2926  134s
   159   254 -16522.101    8  706 -25402.251 -16383.961  35.5%  2556  141s
   273   300 -16560.483    9  709 -25402.251 -16383.961  35.5%  2057  146s
H  316   300                    -25386.08656 -16383.961  35.5%  1989  146s
   356   333 -19772.245   11  440 -25386.087 -16400.916  35.4%  1899  152s
   415   357 -17065.600   11  638 -25386.087 -16561.082  34.8%  1942  157s
   453   386 -17533.981   12  645 -25386.087 -16561.082  34.8%  2010  163s
   500   430 -17642.340   13  700 -25386.087 -16631.274  34.5%  2225  167s
   544   481 -18816.605   14  736 -25386.087 -16631.274  34.5%  2242  171s
   596   542 -18961.873   14  646 -25386.087 -16631.274  34.5%  2224  176s
   667   592 -18956.160   15  725 -25386.087 -16631.274  34.5%  2141  180s
H  705   592                    -25384.36830 -16631.274  34.5%  2097  180s
   739   657     cutoff   15      -25384.368 -16631.274  34.5%  2054  185s
   837   743 -19046.304   16  715 -25384.368 -16636.325  34.5%  1940  190s
   931   814 -19228.739   17  709 -25384.368 -16636.325  34.5%  1850  196s
  1036   881 -19376.973   18  680 -25384.368 -16636.325  34.5%  1759  201s
  1129   960 -19652.574   19  667 -25384.368 -16636.325  34.5%  1704  205s
  1237  1056     cutoff   19      -25384.368 -16739.523  34.1%  1647  210s
  1398  1118 -19822.598   21  660 -25384.368 -16806.197  33.8%  1570  217s
  1441  1152 -19861.509   22  665 -25384.368 -16806.197  33.8%  1557  222s
  1499  1200 -19880.733   23  666 -25384.368 -16981.929  33.1%  1527  225s
  1632  1324 -19928.706   25  674 -25384.368 -16981.929  33.1%  1468  235s
  1733  1389 -19953.113   26  604 -25384.368 -16981.929  33.1%  1429  242s
  1835  1457 -20300.805   27  564 -25384.368 -16981.929  33.1%  1401  248s
  1948  1493 -20345.820   28  600 -25384.368 -16981.929  33.1%  1385  253s
  2052  1558 -22353.360   28  561 -25384.368 -16981.929  33.1%  1400  259s
  2162  1602 -20817.758   29  458 -25384.368 -17287.637  31.9%  1403  263s
  2249  1648 -22881.099   30  523 -25384.368 -17348.636  31.7%  1398  269s
  2355  1736 -24617.278   30  403 -25384.368 -17348.636  31.7%  1401  273s
  2501  1799     cutoff   31      -25384.368 -17348.636  31.7%  1388  281s
  2691  1877 -24958.012   36  268 -25384.368 -17434.625  31.3%  1363  287s
  2862  1956 -22127.187   14  458 -25384.368 -17434.625  31.3%  1352  296s
  3068  2027 -24650.256   17  401 -25384.368 -17689.084  30.3%  1335  303s
  3231  2103 -22712.363   14  417 -25384.368 -17883.341  29.5%  1337  311s
  3367  2184 -25126.175   18  363 -25384.368 -17883.341  29.5%  1353  319s
  3567  2276 -19509.603    9  447 -25384.368 -17883.341  29.5%  1349  326s
  3790  2354 -21125.236   12  389 -25384.368 -17957.083  29.3%  1338  335s
  3995  2411 infeasible   17      -25384.368 -17989.922  29.1%  1340  344s
  4234  2504 -23494.859    9  322 -25384.368 -18256.978  28.1%  1334  353s
  4468  2577 -22859.929    9  426 -25384.368 -18422.736  27.4%  1333  361s
  4708  2650 -24274.487   10  367 -25384.368 -18480.430  27.2%  1334  371s
  4897  2691 -21990.430   14  320 -25384.368 -18509.532  27.1%  1341  381s
  5148  2735 -23761.318   16  267 -25384.368 -18509.532  27.1%  1342  390s
  5402  2844 -25013.528   17  606 -25384.368 -18509.532  27.1%  1350  398s
  5679  2861 -19719.237   13  484 -25384.368 -18602.677  26.7%  1346  406s
  5727  2862 -20994.972   14  622 -25384.368 -18602.677  26.7%  1350  437s
  5729  2863 -22748.024   38  369 -25384.368 -18602.677  26.7%  1349  448s
  5730  2864 -25088.139   30  635 -25384.368 -18602.677  26.7%  1349  461s
  5731  2865 -22794.638   15  613 -25384.368 -18602.677  26.7%  1349  468s
  5732  2865 -24117.349   28  655 -25384.368 -18602.677  26.7%  1349  473s
  5733  2866 -22467.098   42  645 -25384.368 -18602.677  26.7%  1348  476s
  5735  2867 -20803.428   15  662 -25384.368 -18602.677  26.7%  1348  481s
  5738  2869 -20554.868   15  774 -25384.368 -18602.677  26.7%  1347  489s
  5739  2870 -19592.788   12  691 -25384.368 -18602.677  26.7%  1347  490s
  5742  2872 -21520.814   15  774 -25384.368 -18602.677  26.7%  1346  500s
  5745  2874 -24479.388   17  761 -25384.368 -18602.677  26.7%  1346  505s
  5746  2875 -21259.001   20  812 -25384.368 -18602.677  26.7%  1345  510s
  5748  2876 -19825.314   22  810 -25384.368 -18602.677  26.7%  1345  515s
  5749  2877 -20669.987   16  806 -25384.368 -18602.677  26.7%  1345  520s
  5752  2879 -19424.573   11  808 -25384.368 -18602.677  26.7%  1344  526s
  5753  2879 -24333.376   19  755 -25384.368 -18602.677  26.7%  1344  531s
  5755  2881 -24129.162   12  826 -25384.368 -18602.677  26.7%  1343  535s
  5756  2881 -20955.972   10  817 -25384.368 -18602.677  26.7%  1343  541s
  5757  2882 -24821.620   39  817 -25384.368 -18602.677  26.7%  1343  554s
  5758  2883 -22423.201   21  817 -25384.368 -18602.677  26.7%  1343  566s
  5759  2886 -18602.677   10  811 -25384.368 -18602.677  26.7%  1365  578s
  5761  2890 -18602.677   11  739 -25384.368 -18602.677  26.7%  1366  585s
  5765  2896 -18602.677   12  799 -25384.368 -18602.677  26.7%  1368  590s
  5773  2908 -18602.677   13  793 -25384.368 -18602.677  26.7%  1370  599s
  5789  2928 -18602.677   14  738 -25384.368 -18602.677  26.7%  1395  608s
  5819  2925 -22220.462   15  453 -25384.368 -18602.677  26.7%  1411  618s
  5826  2982 -21177.004   16  468 -25384.368 -18602.677  26.7%  1418  634s
  5892  3008 -21428.324   17  464 -25384.368 -18602.677  26.7%  1445  643s
  5958  3032 -24360.682   19  420 -25384.368 -18602.677  26.7%  1490  649s
  6039  3027 -24713.942   21  382 -25384.368 -18602.677  26.7%  1504  657s
  6126  3012 -25304.002   23  394 -25384.368 -18602.677  26.7%  1512  663s
  6172  3027     cutoff   24      -25384.368 -18602.677  26.7%  1521  671s
  6215  3041     cutoff   23      -25384.368 -18602.677  26.7%  1531  677s
  6268  3040 -18802.646   17  726 -25384.368 -18602.677  26.7%  1539  682s
  6318  3047 -19108.529   18  664 -25384.368 -18602.677  26.7%  1547  688s
  6385  3045 -19496.898   19  755 -25384.368 -18602.677  26.7%  1550  696s
  6450  3044 -20200.235   20  689 -25384.368 -18602.677  26.7%  1555  703s
  6507  3034 -20234.787   21  686 -25384.368 -18602.677  26.7%  1560  709s
  6561  3049 -20396.401   22  690 -25384.368 -18602.677  26.7%  1563  713s
  6616  3051 -21157.201   23  568 -25384.368 -18602.677  26.7%  1564  718s
  6664  3051 -21598.799   24  730 -25384.368 -18602.677  26.7%  1564  726s
  6732  3037 -21676.838   25  666 -25384.368 -18602.677  26.7%  1563  733s
  6792  3032 -21764.232   26  663 -25384.368 -19109.504  24.7%  1568  740s
  6855  3039 -22079.416   27  720 -25384.368 -19109.504  24.7%  1573  747s
  6926  3036 -22649.029   28  701 -25384.368 -19836.071  21.9%  1574  754s
  7037  3012 -22769.323   29  641 -25384.368 -19836.071  21.9%  1574  764s
  7125  3026 -23356.085   32  373 -25384.368 -19836.071  21.9%  1581  773s
  7217  3032 -24318.457   36  329 -25384.368 -19836.071  21.9%  1588  779s
  7329  3020     cutoff   42      -25384.368 -19836.071  21.9%  1590  788s
  7464  3008     cutoff   43      -25384.368 -20111.781  20.8%  1588  798s
  7608  2987 -21041.506   16  503 -25384.368 -20297.772  20.0%  1584  808s
  7764  2950 -22849.732   19  371 -25384.368 -20297.772  20.0%  1580  817s
  7891  2913     cutoff   21      -25384.368 -20489.174  19.3%  1586  824s
  8004  2898 -22552.081   22  586 -25384.368 -20704.542  18.4%  1587  833s
  8142  2886 -22638.063   23  584 -25384.368 -20871.015  17.8%  1590  841s
  8313  2845 -23727.408   24  197 -25384.368 -20871.015  17.8%  1592  851s
  8486  2814     cutoff   28      -25384.368 -20965.283  17.4%  1595  860s
  8651  2775 -24674.145   21  603 -25384.368 -20965.283  17.4%  1598  871s
  8858  2737     cutoff   23      -25384.368 -21262.452  16.2%  1597  881s
  9081  2660     cutoff   24      -25384.368 -21424.309  15.6%  1595  892s
  9183  2653     cutoff   22      -25384.368 -21424.309  15.6%  1597  904s
  9357  2617     cutoff   21      -25384.368 -21725.238  14.4%  1599  915s
  9576  2566 -24967.137   19  463 -25384.368 -21758.515  14.3%  1598  925s
  9782  2515 infeasible   26      -25384.368 -22117.035  12.9%  1599  937s
 10030  2438 -23523.208   18  435 -25384.368 -22406.001  11.7%  1598  951s
 10275  2370 -24664.654   21  220 -25384.368 -22539.703  11.2%  1600  963s
 10590  2259 -24058.871   28  195 -25384.368 -22846.962  10.0%  1593  977s
 10943  2140 -24947.094   43  146 -25384.368 -23148.997  8.81%  1583  990s
 11343  1897 infeasible   21      -25384.368 -23247.876  8.42%  1566 1003s
 11783  1659 -25332.679   26  636 -25384.368 -23469.641  7.54%  1548 1015s
 12358  1316     cutoff   38      -25384.368 -23801.983  6.23%  1514 1026s
 13089   719 infeasible   28      -25384.368 -23876.027  5.94%  1460 1037s
 14051   171 infeasible   25      -25384.368 -24162.109  4.82%  1388 1048s
 14588     2     cutoff   26      -25384.368 -24683.574  2.76%  1347 1056s

Cutting planes:
  Gomory: 1
  MIR: 780
  Flow cover: 1641
  GUB cover: 1
  Zero half: 4
  RLT: 32
  Relax-and-lift: 96

Explored 14648 nodes (19800606 simplex iterations) in 1059.45 seconds (2848.69 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -25384.4 -25386.1 -25402.3 ... -26376.2
No other solutions better than -25384.4

Optimal solution found (tolerance 1.00e-06)
Best objective -2.538436829724e+04, best bound -2.538436829724e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1059.45s
  Master Objective (UB) = -25384.37, θ = 94270.77
  Upper Bound (UB) = -25384.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94270.77
  [DEBUG]   ✓ Scenario 0: θ = 94270.77 ≤ Q = 94270.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94270.77 ≤ Q = 94270.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94270.77 ≤ Q = 94270.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94270.77 ≤ Q = 94270.77 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5df5ead8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa20a1528
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.069462e+13
Presolve removed 2618 rows and 1911 columns
Presolve time: 0.00s
Presolved: 475 rows, 478 columns, 1303 nonzeros
Found heuristic solution: objective 5157118.6866
Variable types: 322 continuous, 156 integer (156 binary)

Root relaxation: objective -1.189719e+05, 223 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118971.92    0  121 5157118.69 -118971.92   102%     -    0s
H    0     0                    -87584.49871 -118971.92  35.8%     -    0s
H    0     0                    -88146.67454 -118971.92  35.0%     -    0s
H    0     0                    -90952.97184 -98781.681  8.61%     -    0s
H    0     0                    -94549.22509 -98781.681  4.48%     -    0s
     0     0 -98781.681    0   35 -94549.225 -98781.681  4.48%     -    0s
H    0     0                    -97184.86023 -98697.780  1.56%     -    0s
H    0     0                    -97190.08521 -98697.780  1.55%     -    0s
H    0     0                    -97659.57820 -98697.780  1.06%     -    0s
H    0     0                    -97664.80318 -98697.780  1.06%     -    0s
H    0     0                    -98079.54924 -98660.492  0.59%     -    0s
     0     0 -98660.492    0   26 -98079.549 -98660.492  0.59%     -    0s
     0     0 -98603.647    0   33 -98079.549 -98603.647  0.53%     -    0s
     0     0 -98220.455    0    2 -98079.549 -98220.455  0.14%     -    0s
H    0     0                    -98220.14395 -98220.305  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 100
  Flow cover: 6
  RLT: 28

Explored 1 nodes (404 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -98220.1 -98079.5 -97664.8 ... 1.06946e+13
No other solutions better than -98220.1

Optimal solution found (tolerance 1.00e-06)
Best objective -9.822014394831e+04, best bound -9.822014394831e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 75479.13
  Scenario: 13 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98220.14
  [DEBUG]   S×d_nominal = 173699.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173699.27 + -98220.14 = 75479.13
  [DEBUG]   Current θ from Master = 94270.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18791.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -44176.01
  Lower Bound (LB) = -31551.64
  Gap (UB-LB) = 6167.2730, Absolute Gap = 6167.2730, Relative Gap = 0.242956
  Not converged yet (gap = 6167.27 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 46 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221644 nonzeros
Model fingerprint: 0x69314639
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 36440 rows and 14800 columns
Presolve time: 0.66s
Presolved: 41393 rows, 18660 columns, 256479 nonzeros
Variable types: 16401 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387235.2691
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41393 rows, 18660 columns, 256479 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29695   -1.3985775e+04   0.000000e+00   1.711393e+07      5s
   41170   -8.2105581e+03   0.000000e+00   2.859922e+07     10s
   49826   -7.2996136e+03   0.000000e+00   3.780952e+05     15s
Concurrent spin time: 1.65s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -6.767839e+03, 35326 iterations, 16.49 seconds (31.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6767.8387    0  369 -217728.64 -6767.8387  96.9%     -   17s
H    0     0                    -209822.3968 -6767.8387  96.8%     -   17s
H    0     0                    -111721.6078 -6767.8387  93.9%     -   17s
H    0     0                    -108746.3758 -6767.8387  93.8%     -   17s
H    0     0                    -106450.9746 -6767.8387  93.6%     -   17s
H    0     0                    -95382.03049 -6767.8387  92.9%     -   17s
H    0     0                    -68287.86694 -6767.8387  90.1%     -   17s
H    0     0                    -68161.03759 -6767.8387  90.1%     -   17s
H    0     0                    -68151.15417 -6767.8387  90.1%     -   17s
H    0     0                    -68148.46646 -6767.8387  90.1%     -   17s
H    0     0                    -68147.95595 -6767.8387  90.1%     -   17s
H    0     0                    -64387.09927 -6767.8387  89.5%     -   18s
H    0     0                    -63202.83271 -6767.8387  89.3%     -   18s
H    0     0                    -61007.48653 -6767.8387  88.9%     -   18s
H    0     0                    -60802.05518 -6767.8387  88.9%     -   18s
H    0     0                    -57184.09308 -9740.0336  83.0%     -   23s
H    0     0                    -57008.13975 -9740.0336  82.9%     -   23s
H    0     0                    -56549.98653 -9740.0336  82.8%     -   23s
H    0     0                    -56547.06945 -9740.0336  82.8%     -   23s
     0     0 -9740.0336    0  338 -56547.069 -9740.0336  82.8%     -   23s
H    0     0                    -54552.59449 -9741.2643  82.1%     -   24s
H    0     0                    -50329.38487 -9741.2643  80.6%     -   24s
H    0     0                    -50210.87752 -9741.2643  80.6%     -   24s
H    0     0                    -50165.97485 -9741.2643  80.6%     -   24s
H    0     0                    -50164.30306 -9741.2643  80.6%     -   24s
H    0     0                    -50160.83326 -9741.2643  80.6%     -   24s
H    0     0                    -50142.88957 -9741.2643  80.6%     -   24s
H    0     0                    -50137.17950 -9741.2643  80.6%     -   24s
H    0     0                    -50132.78320 -9741.2643  80.6%     -   24s
     0     0 -10217.301    0  578 -50132.783 -10217.301  79.6%     -   27s
     0     0 -10223.757    0  581 -50132.783 -10223.757  79.6%     -   30s
     0     0 -10223.757    0  608 -50132.783 -10223.757  79.6%     -   30s
     0     0 -10223.757    0  608 -50132.783 -10223.757  79.6%     -   30s
H    0     0                    -42040.60461 -10223.757  75.7%     -   31s
H    0     0                    -42017.42962 -10223.757  75.7%     -   31s
     0     0 -12298.412    0  494 -42017.430 -12298.412  70.7%     -   39s
H    0     0                    -32284.43098 -12298.553  61.9%     -   39s
H    0     0                    -32146.87552 -12298.553  61.7%     -   39s
     0     0 -12476.898    0  548 -32146.876 -12476.898  61.2%     -   41s
     0     0 -12787.467    0  553 -32146.876 -12787.467  60.2%     -   44s
     0     0 -12852.499    0  562 -32146.876 -12852.499  60.0%     -   45s
     0     0 -12879.047    0  551 -32146.876 -12879.047  59.9%     -   45s
     0     0 -12881.577    0  550 -32146.876 -12881.577  59.9%     -   46s
     0     0 -12881.805    0  551 -32146.876 -12881.805  59.9%     -   46s
H    0     0                    -31527.64087 -12881.805  59.1%     -   50s
H    0     0                    -31525.00043 -12881.805  59.1%     -   50s
     0     0 -14040.274    0  544 -31525.000 -14040.274  55.5%     -   61s
H    0     0                    -31444.35533 -14040.433  55.3%     -   62s
H    0     0                    -31438.77192 -14040.433  55.3%     -   62s
H    0     0                    -31429.13225 -14040.433  55.3%     -   62s
H    0     0                    -31426.93665 -14040.433  55.3%     -   62s
     0     0 -14286.389    0  541 -31426.937 -14286.389  54.5%     -   66s
H    0     0                    -28951.50150 -14381.349  50.3%     -   68s
H    0     0                    -28904.06429 -14381.349  50.2%     -   68s
H    0     0                    -28892.73952 -14381.349  50.2%     -   68s
H    0     0                    -28878.91694 -14381.349  50.2%     -   68s
     0     0 -14381.349    0  543 -28878.917 -14381.349  50.2%     -   68s
H    0     0                    -28856.95150 -14396.651  50.1%     -   69s
     0     0 -14396.651    0  544 -28856.951 -14396.651  50.1%     -   69s
H    0     0                    -28844.41169 -14417.633  50.0%     -   69s
     0     0 -14417.633    0  607 -28844.412 -14417.633  50.0%     -   69s
     0     0 -14420.155    0  619 -28844.412 -14420.155  50.0%     -   70s
     0     0 -14420.383    0  618 -28844.412 -14420.383  50.0%     -   70s
H    0     0                    -28658.94300 -14420.383  49.7%     -   76s
H    0     0                    -28287.34335 -14420.383  49.0%     -   76s
H    0     0                    -28284.01808 -14420.383  49.0%     -   76s
H    0     0                    -28217.85937 -14420.383  48.9%     -   76s
H    0     0                    -28116.78763 -14420.383  48.7%     -   76s
H    0     0                    -28108.76501 -14420.383  48.7%     -   76s
H    0     0                    -28098.12836 -14420.383  48.7%     -   76s
H    0     0                    -28094.12234 -14420.383  48.7%     -   76s
H    0     0                    -28093.60660 -14420.383  48.7%     -   76s
H    0     0                    -28034.89388 -14420.383  48.6%     -   76s
H    0     0                    -28034.37814 -14420.383  48.6%     -   76s
H    0     0                    -28032.09156 -14420.383  48.6%     -   76s
H    0     0                    -28025.98980 -14420.383  48.5%     -   76s
H    0     0                    -28025.95793 -14420.383  48.5%     -   76s
H    0     0                    -28025.10168 -14420.383  48.5%     -   76s
H    0     0                    -27978.67070 -14420.383  48.5%     -   76s
H    0     0                    -27973.37852 -14420.383  48.4%     -   76s
H    0     0                    -27954.59152 -14420.383  48.4%     -   76s
H    0     0                    -27947.38698 -14420.383  48.4%     -   76s
H    0     0                    -27940.77362 -14420.383  48.4%     -   76s
H    0     0                    -27937.96134 -14420.383  48.4%     -   76s
H    0     0                    -27926.75078 -14420.383  48.4%     -   76s
H    0     0                    -27921.45861 -14420.383  48.4%     -   76s
H    0     0                    -27910.67792 -14420.383  48.3%     -   76s
H    0     0                    -27905.38574 -14420.383  48.3%     -   76s
H    0     0                    -27897.49983 -14835.305  46.8%     -   82s
     0     0 -14835.305    0  648 -27897.500 -14835.305  46.8%     -   82s
H    0     0                    -27326.31154 -15053.255  44.9%     -   88s
H    0     0                    -27147.93522 -15053.255  44.6%     -   88s
     0     0 -15053.255    0  643 -27147.935 -15053.255  44.6%     -   88s
H    0     0                    -27106.32909 -15107.774  44.3%     -   90s
     0     0 -15107.774    0  651 -27106.329 -15107.774  44.3%     -   90s
     0     0 -15137.075    0  656 -27106.329 -15137.075  44.2%     -   91s
     0     0 -15151.990    0  663 -27106.329 -15151.990  44.1%     -   92s
     0     0 -15161.393    0  725 -27106.329 -15161.393  44.1%     -   93s
H    0     0                    -27053.96825 -15162.980  44.0%     -   94s
     0     0 -15162.980    0  731 -27053.968 -15162.980  44.0%     -   94s
H    0     0                    -26874.05875 -15164.012  43.6%     -   94s
H    0     0                    -26858.89768 -15164.012  43.5%     -   94s
H    0     0                    -26819.04842 -15164.012  43.5%     -   94s
     0     0 -15164.012    0  611 -26819.048 -15164.012  43.5%     -   94s
H    0     0                    -26811.99054 -15260.170  43.1%     -   97s
H    0     0                    -26805.32593 -15260.170  43.1%     -   97s
     0     0 -15260.170    0  595 -26805.326 -15260.170  43.1%     -   97s
H    0     0                    -26796.34630 -15276.050  43.0%     -   98s
     0     0 -15276.050    0  592 -26796.346 -15276.050  43.0%     -   98s
     0     0 -15279.796    0  601 -26796.346 -15279.796  43.0%     -   99s
     0     0 -15281.366    0  602 -26796.346 -15281.366  43.0%     -   99s
     0     0 -15282.443    0  603 -26796.346 -15282.443  43.0%     -  100s
     0     0 -15329.372    0  591 -26796.346 -15329.372  42.8%     -  102s
     0     0 -15349.793    0  608 -26796.346 -15349.793  42.7%     -  103s
     0     0 -15367.601    0  614 -26796.346 -15367.601  42.7%     -  105s
     0     0 -15373.007    0  607 -26796.346 -15373.007  42.6%     -  105s
     0     0 -15373.969    0  606 -26796.346 -15373.969  42.6%     -  105s
     0     0 -15415.668    0  651 -26796.346 -15415.668  42.5%     -  108s
     0     0 -15424.362    0  662 -26796.346 -15424.362  42.4%     -  109s
     0     0 -15430.663    0  660 -26796.346 -15430.663  42.4%     -  110s
     0     0 -15431.464    0  659 -26796.346 -15431.464  42.4%     -  110s
     0     0 -15451.483    0  633 -26796.346 -15451.483  42.3%     -  112s
     0     0 -15457.143    0  664 -26796.346 -15457.143  42.3%     -  114s
     0     0 -15461.090    0  632 -26796.346 -15461.090  42.3%     -  114s
     0     0 -15461.782    0  681 -26796.346 -15461.782  42.3%     -  115s
     0     0 -15479.413    0  632 -26796.346 -15479.413  42.2%     -  117s
H    0     0                    -26791.07440 -15485.559  42.2%     -  118s
     0     0 -15485.559    0  640 -26791.074 -15485.559  42.2%     -  118s
     0     0 -15486.881    0  634 -26791.074 -15486.881  42.2%     -  118s
     0     0 -15487.217    0  636 -26791.074 -15487.217  42.2%     -  119s
H    0     0                    -26770.77290 -15494.654  42.1%     -  120s
H    0     0                    -26705.98138 -15494.654  42.0%     -  120s
     0     0 -15494.654    0  674 -26705.981 -15494.654  42.0%     -  120s
     0     0 -15499.507    0  672 -26705.981 -15499.507  42.0%     -  121s
     0     0 -15501.310    0  644 -26705.981 -15501.310  42.0%     -  122s
     0     0 -15502.753    0  642 -26705.981 -15502.753  42.0%     -  122s
     0     0 -15503.091    0  649 -26705.981 -15503.091  41.9%     -  122s
     0     0 -15511.581    0  639 -26705.981 -15511.581  41.9%     -  124s
     0     0 -15515.938    0  643 -26705.981 -15515.938  41.9%     -  125s
     0     0 -15517.730    0  643 -26705.981 -15517.730  41.9%     -  125s
     0     0 -15518.042    0  648 -26705.981 -15518.042  41.9%     -  126s
     0     0 -15520.688    0  639 -26705.981 -15520.688  41.9%     -  127s
H    0     0                    -26676.26489 -15521.005  41.8%     -  129s
     0     0 -15521.118    0  644 -26676.265 -15521.118  41.8%     -  129s
H    0     0                    -26428.99104 -15531.901  41.2%     -  131s
H    0     0                    -26353.83687 -15531.901  41.1%     -  131s
H    0     0                    -26307.47736 -15531.901  41.0%     -  131s
H    0     0                    -26295.92130 -15531.901  40.9%     -  131s
     0     0 -15531.901    0  642 -26295.921 -15531.901  40.9%     -  131s
     0     0 -15532.048    0  642 -26295.921 -15532.048  40.9%     -  132s
H    0     0                    -26290.90275 -15532.112  40.9%     -  140s
H    0     0                    -26255.58023 -15532.112  40.8%     -  152s
     0     2 -15532.112    0  642 -26255.580 -15532.112  40.8%     -  153s
     1     4 -15561.776    1  611 -26255.580 -15532.644  40.8%  1526  158s
     3     8 -15588.254    2  666 -26255.580 -15562.654  40.7%  3246  166s
     7    16 -15600.787    3  721 -26255.580 -15588.695  40.6%  4217  172s
    15    32 -15754.628    4  725 -26255.580 -15601.531  40.6%  4759  187s
H   31    50                    -26166.47882 -15754.644  39.8%  7074  198s
H   31    50                    -26164.30201 -15754.644  39.8%  7074  198s
H   32    50                    -26163.24252 -15754.644  39.8%  7172  198s
H   47    50                    -26122.06238 -15754.644  39.7%  7166  198s
    49    82 -18048.071    6  426 -26122.062 -15754.644  39.7%  7612  205s
    81   115 -18152.405    7  417 -26122.062 -15754.644  39.7%  5584  212s
H   86   115                    -26115.76347 -15754.644  39.7%  5306  212s
H   90   115                    -26105.89841 -15754.644  39.7%  5110  212s
H   94   115                    -26099.59950 -15754.644  39.6%  4933  212s
   114   245 -18263.754    8  410 -26099.599 -15754.644  39.6%  4336  218s
   248   270 -18279.695    9  400 -26099.599 -15754.644  39.6%  2560  221s
   286   300 -18520.775    9  397 -26099.599 -15754.644  39.6%  2345  228s
   336   322 -18581.891   10  402 -26099.599 -15754.644  39.6%  2199  231s
   379   349 -20106.739   10  354 -26099.599 -15754.644  39.6%  2119  238s
   444   369 -18592.877   10  400 -26099.599 -15754.644  39.6%  1995  245s
   515   381 -20038.673    9  337 -26099.599 -15754.644  39.6%  1909  252s
   584   399 -20515.464    9  337 -26099.599 -15754.644  39.6%  1886  259s
   637   430 -19795.568   11  383 -26099.599 -15754.644  39.6%  1894  265s
   703   462 -21011.332   11  343 -26099.599 -15754.644  39.6%  1880  273s
   745   501 -20529.509   12  348 -26099.599 -15754.644  39.6%  1890  279s
   796   527 -21545.705   11  384 -26099.599 -15754.644  39.6%  1925  286s
   854   574 -21192.284   13  343 -26099.599 -15754.644  39.6%  1886  293s
   913   613 -21971.673   12  396 -26099.599 -15754.644  39.6%  1869  299s
   997   633 -23199.600   13  401 -26099.599 -15754.644  39.6%  1811  306s
  1036   668 -21237.552   12  333 -26099.599 -15754.644  39.6%  1804  313s
  1116   714 -21735.259   13  311 -26099.599 -15754.644  39.6%  1789  321s
  1220   755 -21943.050   14  354 -26099.599 -15754.644  39.6%  1749  326s
  1304   778 -25113.262   14  425 -26099.599 -15754.644  39.6%  1737  334s
  1357   816 -22432.972   13  378 -26099.599 -15922.466  39.0%  1742  340s
  1417   851 -23467.626   15  302 -26099.599 -15922.818  39.0%  1750  346s
  1512   880 -25988.689   15  394 -26099.599 -15922.818  39.0%  1733  354s
  1595   924 -23852.815   16  279 -26099.599 -15922.818  39.0%  1742  361s
  1677   974 -24883.323   17  265 -26099.599 -15922.818  39.0%  1762  367s
  1769  1050     cutoff   17      -26099.599 -15922.818  39.0%  1763  374s
  1872  1121 -25435.513   19  270 -26099.599 -15922.818  39.0%  1768  381s
  1971  1170     cutoff   20      -26099.599 -15922.818  39.0%  1761  389s
  2086  1226 -19051.756    6  388 -26099.599 -15922.818  39.0%  1751  398s
  2170  1277 -20014.458    7  437 -26099.599 -15922.818  39.0%  1756  406s
  2281  1344 -20336.018    8  432 -26099.599 -17674.047  32.3%  1746  416s
  2390  1396 -21687.398    9  423 -26099.599 -17674.047  32.3%  1752  424s
  2507  1434     cutoff   37      -26099.599 -17674.047  32.3%  1755  434s
  2673  1544     cutoff   10      -26099.599 -18193.519  30.3%  1735  444s
  2866  1640 -22994.775   11  291 -26099.599 -18193.519  30.3%  1693  452s
  3026  1678 -24307.956   13  464 -26099.599 -18577.016  28.8%  1661  462s
  3189  1700     cutoff   13      -26099.599 -18778.194  28.1%  1644  473s
  3318  1759 -19367.920   16  513 -26099.599 -18778.194  28.1%  1662  482s
  3456  1800 -20666.998   20  472 -26099.599 -18779.079  28.0%  1678  493s
  3596  1871 -22730.278   25  442 -26099.599 -18779.079  28.0%  1691  503s
  3793  1878 -24359.674   30  328 -26099.599 -18941.871  27.4%  1685  513s
  3850  1899 -24363.382   31  260 -26099.599 -18941.871  27.4%  1692  520s
  3897  1904 -24378.629   32  179 -26099.599 -18941.871  27.4%  1698  532s
  3970  1956 -24433.952   33  234 -26099.599 -18941.871  27.4%  1713  543s
  4077  1981     cutoff   54      -26099.599 -18990.566  27.2%  1703  553s
  4154  2009 -21961.610   11  546 -26099.599 -19002.176  27.2%  1708  566s
  4298  2012 -24920.572   15  273 -26099.599 -19002.176  27.2%  1702  579s
  4479  2033     cutoff   18      -26099.599 -19019.348  27.1%  1704  593s
  4584  2092 infeasible   38      -26099.599 -19142.761  26.7%  1709  608s
  4775  2162 -21714.933   13  325 -26099.599 -19187.769  26.5%  1723  622s
  4993  2242     cutoff   17      -26099.599 -19187.769  26.5%  1732  634s
  5254  2346 -23913.929    8  359 -26099.599 -19587.791  24.9%  1739  649s
  5559  2382 -24844.049   11  415 -26099.599 -19670.889  24.6%  1737  665s
  5782  2411 -25658.926   12  355 -26099.599 -20040.142  23.2%  1739  683s
  6058  2428     cutoff   16      -26099.599 -20040.142  23.2%  1753  699s
  6346  2471     cutoff   17      -26099.599 -20077.831  23.1%  1765  717s
  6662  2500 -24341.128   14  465 -26099.599 -20304.884  22.2%  1773  735s
  7005  2562 -23946.861   13  243 -26099.599 -20563.524  21.2%  1777  753s
  7346  2608 -24666.788   15  380 -26099.599 -20817.650  20.2%  1779  771s
  7758  2707 -23603.161   17  349 -26099.599 -20844.379  20.1%  1772  790s
  8176  2708 -21286.005   17  642 -26099.599 -20984.452  19.6%  1771  843s
  8178  2709 -23529.119   14  369 -26099.599 -20984.452  19.6%  1771  862s
  8179  2710 -24524.383   18  583 -26099.599 -20984.452  19.6%  1771  875s
  8180  2711 -24893.801   36  603 -26099.599 -20984.452  19.6%  1770  885s
  8181  2711 -25218.854   30  628 -26099.599 -20984.452  19.6%  1770  893s
  8182  2712 -21382.989   14  757 -26099.599 -20984.452  19.6%  1770  900s
  8184  2713 -25560.400   16  676 -26099.599 -20984.452  19.6%  1770  908s
  8185  2714 -24848.392   13  617 -26099.599 -20984.452  19.6%  1769  912s
  8186  2715 -24323.036   30  683 -26099.599 -20984.452  19.6%  1769  917s
  8187  2715 -25702.198   15  626 -26099.599 -20984.452  19.6%  1769  923s
  8188  2716 -23978.576    8  670 -26099.599 -20984.452  19.6%  1769  926s
  8190  2717 -24328.623   28  628 -26099.599 -20984.452  19.6%  1768  936s
  8192  2719 -21371.609   14  746 -26099.599 -20984.452  19.6%  1768  942s
  8193  2719 -24107.735   17  812 -26099.599 -20984.452  19.6%  1768  949s
  8194  2720 -23077.905   14  830 -26099.599 -20984.452  19.6%  1767  953s
  8195  2721 -23053.540   12  689 -26099.599 -20984.452  19.6%  1767  957s
  8196  2721 -21542.123   17  689 -26099.599 -20984.452  19.6%  1767  977s
  8197  2722 -25514.151   14  689 -26099.599 -20984.452  19.6%  1767  991s
  8198  2726 -20984.452   13  749 -26099.599 -20984.452  19.6%  1785  999s
  8200  2729 -20984.452   14  732 -26099.599 -20984.452  19.6%  1785 1007s
  8204  2736 -20984.452   15  746 -26099.599 -20984.452  19.6%  1786 1020s
  8212  2749 -20984.452   16  756 -26099.599 -20984.452  19.6%  1789 1032s
  8228  2763 -20984.452   17  303 -26099.599 -20984.452  19.6%  1807 1046s
  8247  2788 -20984.452   18  475 -26099.599 -20984.452  19.6%  1822 1051s
  8279  2856 -21478.253   19  347 -26099.599 -20984.452  19.6%  1826 1065s
  8403  2833 -23043.358   22  353 -26099.599 -20984.452  19.6%  1826 1074s
  8488  2821 -23808.080   22  363 -26099.599 -20984.452  19.6%  1823 1083s
  8541  2815 -25436.726   20  413 -26099.599 -20984.452  19.6%  1826 1094s
  8596  2817 -24525.225   23  401 -26099.599 -20984.452  19.6%  1831 1103s
  8655  2820 -24705.465   23  210 -26099.599 -20984.452  19.6%  1837 1111s
  8726  2830 -24826.178   24  466 -26099.599 -20984.452  19.6%  1840 1118s
  8781  2824 -25562.611   25  454 -26099.599 -20984.452  19.6%  1842 1125s
  8852  2818     cutoff   25      -26099.599 -20984.452  19.6%  1845 1132s
  8901  2821     cutoff   24      -26099.599 -20984.452  19.6%  1848 1140s
  8967  2810 -25107.268   22  210 -26099.599 -20984.452  19.6%  1851 1148s
  9020  2807     cutoff   23      -26099.599 -20984.452  19.6%  1854 1156s
  9082  2807 infeasible   23      -26099.599 -20984.452  19.6%  1857 1164s
  9134  2823 -20984.452   21  388 -26099.599 -20984.452  19.6%  1860 1173s
  9192  2827     cutoff   23      -26099.599 -20984.452  19.6%  1867 1180s
  9245  2832 -25525.643   23  241 -26099.599 -20984.452  19.6%  1869 1189s
  9325  2813     cutoff   24      -26099.599 -20984.452  19.6%  1869 1197s
  9398  2795 -25977.725   26  354 -26099.599 -20984.452  19.6%  1872 1206s
  9488  2792 -23054.822   22  422 -26099.599 -20984.452  19.6%  1873 1215s
  9562  2804 -25788.459   24  422 -26099.599 -20984.452  19.6%  1880 1231s
  9640  2797 infeasible   23      -26099.599 -20984.452  19.6%  1886 1240s
  9730  2792 -21395.739   20  342 -26099.599 -20984.452  19.6%  1893 1251s
  9822  2782 -22237.067   22  330 -26099.599 -20984.452  19.6%  1901 1260s
  9901  2770 -23673.293   23  317 -26099.599 -20984.452  19.6%  1910 1271s
  9998  2744 -24560.803   24  288 -26099.599 -20984.452  19.6%  1915 1281s
 10099  2745     cutoff   26      -26099.599 -20984.452  19.6%  1923 1292s
 10200  2735 -25192.704   24  335 -26099.599 -20984.452  19.6%  1932 1304s
 10326  2717     cutoff   25      -26099.599 -20984.452  19.6%  1936 1316s
 10452  2687 -24438.851   24  258 -26099.599 -20984.452  19.6%  1943 1328s
 10582  2689 -25053.764   27   86 -26099.599 -20984.452  19.6%  1946 1339s
 10713  2676     cutoff   31      -26099.599 -20984.452  19.6%  1952 1352s
 10878  2669     cutoff   22      -26099.599 -20984.452  19.6%  1955 1365s
 11028  2642 -24184.477   24  493 -26099.599 -20984.452  19.6%  1960 1373s
 11066  2644     cutoff   25      -26099.599 -20984.452  19.6%  1962 1386s
 11157  2622     cutoff   26      -26099.599 -20984.452  19.6%  1962 1398s
 11288  2605     cutoff   25      -26099.599 -20984.452  19.6%  1963 1413s
 11478  2597 -25499.240   27  634 -26099.599 -20984.452  19.6%  1964 1427s
 11696  2548     cutoff   30      -26099.599 -20984.452  19.6%  1959 1442s
 11916  2482 -24687.880   25  400 -26099.599 -20984.452  19.6%  1956 1458s
 12140  2439     cutoff   23      -26099.599 -21025.817  19.4%  1958 1475s
 12375  2391 -23954.660   23  460 -26099.599 -21080.117  19.2%  1962 1492s
 12644  2345 -23750.417   22  391 -26099.599 -21280.663  18.5%  1961 1514s
 12897  2282     cutoff   27      -26099.599 -21700.416  16.9%  1964 1530s
 13205  2170     cutoff   25      -26099.599 -21786.595  16.5%  1961 1543s
 13277  2154     cutoff   24      -26099.599 -22024.797  15.6%  1965 1559s
 13420  2113     cutoff   25      -26099.599 -22216.407  14.9%  1966 1577s
 13699  2035 -25764.591   22  205 -26099.599 -22324.092  14.5%  1966 1596s
 14045  1898     cutoff   24      -26099.599 -22613.685  13.4%  1964 1613s
 14455  1744 -24756.793   27  429 -26099.599 -22897.071  12.3%  1956 1634s
 14877  1537 -25096.898   26  539 -26099.599 -22972.726  12.0%  1947 1656s
 15335  1300     cutoff   26      -26099.599 -23182.475  11.2%  1938 1677s
 15828   993     cutoff   29      -26099.599 -23670.321  9.31%  1926 1698s
 16425   569     cutoff   35      -26099.599 -23967.743  8.17%  1905 1718s
 17199    91     cutoff   34      -26099.599 -24361.003  6.66%  1867 1737s
 18195     0     cutoff   30      -26099.599 -25037.576  4.07%  1801 1743s

Cutting planes:
  Gomory: 1
  MIR: 855
  Flow cover: 1665
  Zero half: 4
  RLT: 32
  Relax-and-lift: 111

Explored 18359 nodes (32984219 simplex iterations) in 1743.05 seconds (4962.87 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26099.6 -26105.9 -26115.8 ... -26307.5
No other solutions better than -26099.6

Optimal solution found (tolerance 1.00e-06)
Best objective -2.609959949859e+04, best bound -2.609959949859e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1743.08s
  Master Objective (UB) = -26099.60, θ = 94062.48
  Upper Bound (UB) = -26099.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94062.48
  [DEBUG]   ✓ Scenario 0: θ = 94062.48 ≤ Q = 94062.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94062.48 ≤ Q = 94062.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94062.48 ≤ Q = 94062.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94062.48 ≤ Q = 94062.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94062.48 ≤ Q = 94062.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x27f13427
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd80ecbd9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.076729e+13
Presolve removed 2618 rows and 1911 columns
Presolve time: 0.00s
Presolved: 475 rows, 478 columns, 1303 nonzeros
Found heuristic solution: objective 5230208.7546
Variable types: 322 continuous, 156 integer (156 binary)

Root relaxation: objective -1.114929e+05, 223 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111492.94    0  120 5230208.75 -111492.94   102%     -    0s
H    0     0                    -78469.01849 -111492.94  42.1%     -    0s
H    0     0                    -79197.52621 -111492.94  40.8%     -    0s
     0     0 -90818.628    0   88 -79197.526 -90818.628  14.7%     -    0s
H    0     0                    -87378.46011 -90816.066  3.93%     -    0s
H    0     0                    -87383.68509 -90816.066  3.93%     -    0s
H    0     0                    -87815.45160 -90816.066  3.42%     -    0s
H    0     0                    -87820.67658 -90816.066  3.41%     -    0s
     0     0 -90530.982    0   89 -87820.677 -90530.982  3.09%     -    0s
     0     0 -90438.334    0   89 -87820.677 -90438.334  2.98%     -    0s
     0     0 -90033.387    0   92 -87820.677 -90033.387  2.52%     -    0s
     0     0 -90003.688    0   92 -87820.677 -90003.688  2.49%     -    0s
     0     0 -90003.688    0   92 -87820.677 -90003.688  2.49%     -    0s
     0     0 -89671.590    0   93 -87820.677 -89671.590  2.11%     -    0s
     0     0 -89620.897    0   93 -87820.677 -89620.897  2.05%     -    0s
     0     0 -89572.133    0   79 -87820.677 -89572.133  1.99%     -    0s
     0     0 -89552.309    0   93 -87820.677 -89552.309  1.97%     -    0s
     0     0 -89461.113    0   75 -87820.677 -89461.113  1.87%     -    0s
H    0     0                    -88192.13820 -89461.113  1.44%     -    0s
     0     0 -89416.098    0   75 -88192.138 -89416.098  1.39%     -    0s
     0     2 -89416.098    0   75 -88192.138 -89416.098  1.39%     -    0s
H 1051   225                    -88192.53719 -88583.252  0.44%   5.7    0s
H 1058   225                    -88205.54991 -88583.252  0.43%   5.7    0s

Cutting planes:
  Gomory: 22
  MIR: 226
  Flow cover: 1
  RLT: 4
  BQP: 1

Explored 5889 nodes (25831 simplex iterations) in 0.19 seconds (0.21 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -88205.5 -88192.5 -88192.1 ... 1.07673e+13
No other solutions better than -88205.5

Optimal solution found (tolerance 1.00e-06)
Best objective -8.820554990926e+04, best bound -8.820554990926e+04, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 85074.09
  Scenario: 41 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88205.55
  [DEBUG]   S×d_nominal = 173279.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173279.64 + -88205.55 = 85074.09
  [DEBUG]   Current θ from Master = 94062.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8988.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -35087.99
  Lower Bound (LB) = -31551.64
  Gap (UB-LB) = 5452.0418, Absolute Gap = 5452.0418, Relative Gap = 0.208894
  Not converged yet (gap = 5452.04 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 18 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264869 nonzeros
Model fingerprint: 0x64042f5b
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43712 rows and 17752 columns
Presolve time: 0.79s
Presolved: 49411 rows, 21948 columns, 306719 nonzeros
Variable types: 19689 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387235.2691
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 49411 rows, 21948 columns, 306719 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26535   -3.3931328e+04   0.000000e+00   1.838092e+07      5s
   37496   -1.4504349e+04   0.000000e+00   1.512961e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective -6.767839e+03, 29540 iterations, 12.22 seconds (24.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6767.8387    0  369 -217728.64 -6767.8387  96.9%     -   13s
H    0     0                    -214358.9812 -6767.8387  96.8%     -   13s
H    0     0                    -137087.1831 -6767.8387  95.1%     -   13s
H    0     0                    -137038.7782 -6767.8387  95.1%     -   13s
H    0     0                    -99855.50792 -6767.8387  93.2%     -   13s
H    0     0                    -78601.55490 -6767.8387  91.4%     -   13s
H    0     0                    -78412.67084 -6767.8387  91.4%     -   13s
H    0     0                    -67291.04633 -6767.8387  89.9%     -   14s
H    0     0                    -64545.52314 -6767.8387  89.5%     -   14s
H    0     0                    -62730.88877 -6767.8387  89.2%     -   14s
H    0     0                    -61752.81731 -9458.2150  84.7%     -   21s
H    0     0                    -60208.72189 -9458.2150  84.3%     -   21s
H    0     0                    -59902.76025 -9458.2150  84.2%     -   21s
     0     0 -9458.2150    0  335 -59902.760 -9458.2150  84.2%     -   21s
H    0     0                    -50799.13129 -9458.2739  81.4%     -   21s
H    0     0                    -49712.26057 -9458.2739  81.0%     -   22s
H    0     0                    -48436.38192 -9458.2739  80.5%     -   22s
H    0     0                    -48359.99020 -9458.2739  80.4%     -   22s
H    0     0                    -48352.96310 -9458.2739  80.4%     -   22s
     0     0 -9937.4558    0  461 -48352.963 -9937.4558  79.4%     -   25s
     0     0 -10211.049    0  457 -48352.963 -10211.049  78.9%     -   26s
     0     0 -10234.028    0  459 -48352.963 -10234.028  78.8%     -   29s
     0     0 -10234.028    0  597 -48352.963 -10234.028  78.8%     -   32s
     0     0 -10234.028    0  597 -48352.963 -10234.028  78.8%     -   32s
     0     0 -10234.028    0  597 -48352.963 -10234.028  78.8%     -   32s
     0     0 -10234.028    0  590 -48352.963 -10234.028  78.8%     -   33s
     0     0 -10234.028    0  590 -48352.963 -10234.028  78.8%     -   33s
     0     0 -12357.044    0  496 -48352.963 -12357.044  74.4%     -   50s
H    0     0                    -36350.51016 -12357.044  66.0%     -   50s
H    0     0                    -36334.42120 -12357.044  66.0%     -   50s
H    0     0                    -36275.99214 -12357.044  65.9%     -   50s
H    0     0                    -36248.90928 -12357.044  65.9%     -   50s
H    0     0                    -36169.71207 -12357.044  65.8%     -   50s
H    0     0                    -36164.28721 -12357.044  65.8%     -   50s
H    0     0                    -36132.05686 -12357.044  65.8%     -   50s
H    0     0                    -36075.08144 -12357.044  65.7%     -   50s
H    0     0                    -36051.57735 -12357.044  65.7%     -   50s
H    0     0                    -36019.34699 -12357.044  65.7%     -   50s
     0     0 -12457.261    0  488 -36019.347 -12457.261  65.4%     -   54s
H    0     0                    -33770.46364 -12696.484  62.4%     -   58s
H    0     0                    -33766.06622 -12696.484  62.4%     -   58s
H    0     0                    -33747.53301 -12696.484  62.4%     -   58s
     0     0 -12696.484    0  565 -33747.533 -12696.484  62.4%     -   58s
H    0     0                    -33694.65160 -12765.417  62.1%     -   60s
H    0     0                    -33690.25332 -12765.417  62.1%     -   60s
     0     0 -12765.417    0  556 -33690.253 -12765.417  62.1%     -   60s
     0     0 -12777.349    0  563 -33690.253 -12777.349  62.1%     -   61s
     0     0 -12778.463    0  574 -33690.253 -12778.463  62.1%     -   62s
     0     0 -12803.008    0  561 -33690.253 -12803.008  62.0%     -   63s
     0     0 -12805.368    0  569 -33690.253 -12805.368  62.0%     -   63s
     0     0 -12805.965    0  568 -33690.253 -12805.965  62.0%     -   63s
H    0     0                    -33687.79074 -12805.965  62.0%     -   69s
H    0     0                    -33595.04542 -12805.965  61.9%     -   69s
H    0     0                    -33584.28705 -12805.965  61.9%     -   69s
H    0     0                    -29708.64732 -13977.821  53.0%     -   80s
H    0     0                    -29694.37553 -13977.821  52.9%     -   80s
H    0     0                    -28007.96117 -13977.821  50.1%     -   80s
H    0     0                    -27622.37638 -13977.821  49.4%     -   80s
H    0     0                    -27383.99025 -13977.821  49.0%     -   80s
H    0     0                    -27251.18445 -13977.821  48.7%     -   80s
H    0     0                    -27185.39778 -13977.821  48.6%     -   80s
H    0     0                    -27107.79903 -13977.821  48.4%     -   80s
H    0     0                    -27078.95631 -13977.821  48.4%     -   80s
H    0     0                    -27078.44056 -13977.821  48.4%     -   80s
H    0     0                    -27061.73755 -13977.821  48.3%     -   80s
     0     0 -13977.821    0  563 -27061.738 -13977.821  48.3%     -   80s
     0     0 -14198.777    0  581 -27061.738 -14198.777  47.5%     -   85s
H    0     0                    -27061.32406 -14465.348  46.5%     -   92s
H    0     0                    -26989.61437 -14465.348  46.4%     -   92s
H    0     0                    -26961.76105 -14465.348  46.3%     -   92s
H    0     0                    -26888.47897 -14465.348  46.2%     -   92s
H    0     0                    -26751.74201 -14465.348  45.9%     -   92s
H    0     0                    -26748.30461 -14465.348  45.9%     -   92s
     0     0 -14465.348    0  551 -26748.305 -14465.348  45.9%     -   92s
     0     0 -14498.129    0  567 -26748.305 -14498.129  45.8%     -   94s
     0     0 -14533.078    0  550 -26748.305 -14533.078  45.7%     -   96s
     0     0 -14542.244    0  563 -26748.305 -14542.244  45.6%     -   96s
     0     0 -14553.424    0  564 -26748.305 -14553.424  45.6%     -   97s
     0     0 -14559.342    0  565 -26748.305 -14559.342  45.6%     -   98s
     0     0 -14570.772    0  557 -26748.305 -14570.772  45.5%     -   98s
     0     0 -14577.822    0  565 -26748.305 -14577.822  45.5%     -   99s
     0     0 -14578.384    0  570 -26748.305 -14578.384  45.5%     -   99s
     0     0 -15169.424    0  651 -26748.305 -15169.424  43.3%     -  115s
H    0     0                    -26632.86064 -15170.020  43.0%     -  115s
     0     0 -15297.241    0  647 -26632.861 -15297.241  42.6%     -  120s
     0     0 -15386.426    0  660 -26632.861 -15386.426  42.2%     -  123s
     0     0 -15440.934    0  657 -26632.861 -15440.934  42.0%     -  126s
     0     0 -15459.401    0  663 -26632.861 -15459.401  42.0%     -  128s
     0     0 -15473.463    0  664 -26632.861 -15473.463  41.9%     -  130s
     0     0 -15475.418    0  674 -26632.861 -15475.418  41.9%     -  131s
     0     0 -15482.007    0  676 -26632.861 -15482.007  41.9%     -  132s
     0     0 -15483.098    0  677 -26632.861 -15483.098  41.9%     -  133s
     0     0 -15616.571    0  717 -26632.861 -15616.571  41.4%     -  140s
     0     0 -15658.831    0  730 -26632.861 -15658.831  41.2%     -  143s
     0     0 -15680.648    0  684 -26632.861 -15680.648  41.1%     -  144s
     0     0 -15686.012    0  681 -26632.861 -15686.012  41.1%     -  145s
     0     0 -15686.870    0  687 -26632.861 -15686.870  41.1%     -  146s
     0     0 -15733.096    0  670 -26632.861 -15733.096  40.9%     -  149s
H    0     0                    -26631.48819 -15733.602  40.9%     -  151s
H    0     0                    -26630.97245 -15733.602  40.9%     -  151s
     0     0 -15740.751    0  691 -26630.972 -15740.751  40.9%     -  152s
     0     0 -15744.389    0  690 -26630.972 -15744.389  40.9%     -  153s
     0     0 -15745.555    0  690 -26630.972 -15745.555  40.9%     -  153s
     0     0 -15766.818    0  698 -26630.972 -15766.818  40.8%     -  157s
     0     0 -15772.278    0  712 -26630.972 -15772.278  40.8%     -  158s
     0     0 -15773.551    0  711 -26630.972 -15773.551  40.8%     -  158s
     0     0 -15783.160    0  754 -26630.972 -15783.160  40.7%     -  160s
     0     0 -15796.919    0  753 -26630.972 -15796.919  40.7%     -  163s
     0     0 -15801.027    0  744 -26630.972 -15801.027  40.7%     -  164s
     0     0 -15803.787    0  753 -26630.972 -15803.787  40.7%     -  165s
     0     0 -15804.249    0  754 -26630.972 -15804.249  40.7%     -  166s
     0     0 -15816.394    0  713 -26630.972 -15816.394  40.6%     -  169s
     0     0 -15821.817    0  712 -26630.972 -15821.817  40.6%     -  171s
     0     0 -15823.804    0  717 -26630.972 -15823.804  40.6%     -  172s
     0     0 -15825.453    0  718 -26630.972 -15825.453  40.6%     -  173s
     0     0 -15826.388    0  724 -26630.972 -15826.388  40.6%     -  173s
     0     0 -15830.991    0  710 -26630.972 -15830.991  40.6%     -  175s
     0     0 -15832.332    0  714 -26630.972 -15832.332  40.5%     -  176s
     0     0 -15832.947    0  712 -26630.972 -15832.947  40.5%     -  176s
     0     0 -15835.538    0  715 -26630.972 -15835.538  40.5%     -  178s
     0     0 -15835.983    0  724 -26630.972 -15835.983  40.5%     -  178s
     0     0 -15837.589    0  728 -26630.972 -15837.589  40.5%     -  180s
     0     0 -15837.620    0  728 -26630.972 -15837.620  40.5%     -  181s
     0     2 -15837.676    0  728 -26630.972 -15837.676  40.5%     -  208s
     1     4 -15848.173    1  706 -26630.972 -15837.676  40.5%  1060  212s
     3     8 -15922.970    2  702 -26630.972 -15848.283  40.5%  2675  219s
     7    16 -15998.090    3  757 -26630.972 -15925.638  40.2%  4553  224s
    15    32 -16176.170    4  741 -26630.972 -15998.847  39.9%  4927  244s
    31    49 -23970.780    5  226 -26630.972 -16176.266  39.3%  8633  258s
    48    81 -17040.774    6  606 -26630.972 -16176.266  39.3%  8200  281s
    80   234 -17101.679    7  563 -26630.972 -16176.266  39.3%  5732  290s
   233   266 -17551.701    9  688 -26630.972 -16176.266  39.3%  2963  296s
   265   304 -17840.861   10  390 -26630.972 -16176.266  39.3%  2769  302s
   303   342 -17658.547   10  555 -26630.972 -16176.266  39.3%  2615  308s
   341   394 -17691.792   11  483 -26630.972 -16176.266  39.3%  2447  312s
   393   464 -18190.796   14  622 -26630.972 -16176.266  39.3%  2270  316s
   465   540 -18701.761   13  375 -26630.972 -16176.266  39.3%  2094  322s
   558   572 -19677.639   12  362 -26630.972 -16176.266  39.3%  1944  328s
   619   605 -18605.536   15  577 -26630.972 -16176.266  39.3%  1968  335s
   684   648 -19040.326   14  381 -26630.972 -16176.266  39.3%  1999  341s
   761   668 -19077.967   15  349 -26630.972 -16176.266  39.3%  1942  348s
   837   699 -18828.827   14  365 -26630.972 -16176.266  39.3%  1899  356s
   901   722 -18990.125   16  652 -26630.972 -16176.266  39.3%  1924  363s
   960   757 -19234.714   17  656 -26630.972 -16176.266  39.3%  1930  369s
  1005   801 -19311.299   18  651 -26630.972 -16176.266  39.3%  1957  373s
  1065   830 -19752.692   19  653 -26630.972 -16176.266  39.3%  1941  380s
  1112   844 -22269.177   19  606 -26630.972 -16176.266  39.3%  1937  388s
  1177   851 -19837.151   20  600 -26630.972 -16176.266  39.3%  1933  396s
  1232   894 -20741.039   20  476 -26630.972 -16176.266  39.3%  1929  404s
  1289   932 -20212.771   21  650 -26630.972 -16176.266  39.3%  1964  412s
  1347   962 -20371.603   22  635 -26630.972 -16176.266  39.3%  1973  420s
  1429   999 -20572.634   24  571 -26630.972 -16176.266  39.3%  1961  429s
  1508  1048 -21617.081   25  558 -26630.972 -16297.361  38.8%  1963  438s
  1614  1114 -24081.660   24  249 -26630.972 -16298.137  38.8%  1943  447s
  1722  1151 -22246.771   26  561 -26630.972 -16298.137  38.8%  1925  457s
  1826  1181 -21678.330   26  367 -26630.972 -16298.137  38.8%  1911  466s
  1926  1234 -22133.153   27  216 -26630.972 -16298.137  38.8%  1935  477s
  2020  1300 -22720.021   31  235 -26630.972 -16298.137  38.8%  1954  487s
  2118  1319 infeasible   31      -26630.972 -16298.137  38.8%  1941  496s
  2213  1374 -23034.827   36  189 -26630.972 -16298.137  38.8%  1947  506s
  2329  1452 -23358.628   45  186 -26630.972 -16298.137  38.8%  1953  518s
  2465  1530 -24084.105   54  152 -26630.972 -16298.137  38.8%  1963  529s
  2625  1607 -24363.953   65  141 -26630.972 -16787.424  37.0%  1931  540s
  2802  1665 -24815.560   76  148 -26630.972 -17463.630  34.4%  1902  552s
  2938  1718 infeasible   84      -26630.972 -17463.630  34.4%  1916  564s
  3049  1743 -22223.642   13  442 -26630.972 -17463.630  34.4%  1959  575s
  3086  1782     cutoff   14      -26630.972 -17463.630  34.4%  1978  583s
  3167  1818 -23179.116   14  228 -26630.972 -17463.630  34.4%  1992  596s
  3256  1854 -24861.037   14  319 -26630.972 -17463.630  34.4%  2012  608s
  3380  1956 -23338.596   15  245 -26630.972 -18021.735  32.3%  2016  622s
  3536  2031 -24977.254   15  298 -26630.972 -18046.123  32.2%  2014  636s
  3716  2101 -24023.227   14  311 -26630.972 -18089.231  32.1%  2018  649s
  3903  2164 -23440.007   16  229 -26630.972 -18378.117  31.0%  2028  663s
  4081  2220 -24836.142   19  210 -26630.972 -18479.443  30.6%  2047  678s
  4240  2327 -20668.161   10  267 -26630.972 -18605.610  30.1%  2085  694s
  4467  2382 -26281.803   14  229 -26630.972 -18634.334  30.0%  2092  710s
  4627  2432 infeasible   14      -26630.972 -18634.334  30.0%  2101  727s
  4833  2516 -22128.802   11  616 -26630.972 -18777.492  29.5%  2116  745s
  5053  2559 -24926.512   13  537 -26630.972 -18847.926  29.2%  2142  763s
  5248  2657 -26461.301   17  440 -26630.972 -18847.926  29.2%  2176  781s
  5522  2658 -20512.061   16  728 -26630.972 -19051.143  28.5%  2183  851s
  5524  2659 -24089.552   22  369 -26630.972 -19051.143  28.5%  2182  871s
  5525  2660 -26133.439   38  717 -26630.972 -19051.143  28.5%  2182  894s
  5526  2661 -22068.066   11  660 -26630.972 -19051.143  28.5%  2181  910s
  5527  2661 -21997.282    7  659 -26630.972 -19051.143  28.5%  2181  921s
  5528  2662 -23170.892   14  708 -26630.972 -19051.143  28.5%  2181  929s
  5529  2663 -21399.903   11  692 -26630.972 -19051.143  28.5%  2180  937s
  5530  2663 -26352.207   37  797 -26630.972 -19051.143  28.5%  2180  942s
  5531  2664 -24055.858   24  697 -26630.972 -19051.143  28.5%  2179  945s
  5533  2665 -25275.481   40  701 -26630.972 -19051.143  28.5%  2179  952s
  5534  2666 -22852.445   10  666 -26630.972 -19051.143  28.5%  2178  964s
  5535  2667 -22034.286   11  742 -26630.972 -19051.143  28.5%  2178  970s
  5537  2668 -25400.871   22  769 -26630.972 -19051.143  28.5%  2177  976s
  5538  2669 -25287.978   14  758 -26630.972 -19051.143  28.5%  2177  985s
  5540  2670 -23489.773   14  708 -26630.972 -19051.143  28.5%  2176  993s
  5541  2671 -20051.075   16  677 -26630.972 -19051.143  28.5%  2176  999s
  5542  2671 -23829.609   16  696 -26630.972 -19051.143  28.5%  2175 1003s
  5543  2672 -26365.454   24  700 -26630.972 -19051.143  28.5%  2175 1012s
  5545  2673 -23254.589   26  702 -26630.972 -19051.143  28.5%  2174 1017s
  5546  2674 -22837.021   12  729 -26630.972 -19051.143  28.5%  2174 1027s
  5547  2675 -20298.285    8  652 -26630.972 -19051.143  28.5%  2173 1030s
  5548  2675 -24916.502   17  784 -26630.972 -19051.143  28.5%  2173 1037s
  5549  2676 -26264.508   68  784 -26630.972 -19051.143  28.5%  2172 1058s
  5550  2677 -25114.931   21  784 -26630.972 -19051.143  28.5%  2172 1082s
  5551  2680 -19051.143   12  737 -26630.972 -19051.143  28.5%  2211 1101s
  5553  2684 -19051.143   13  741 -26630.972 -19051.143  28.5%  2212 1115s
  5557  2690 -19051.143   14  760 -26630.972 -19051.143  28.5%  2214 1130s
  5565  2704 -19051.143   15  760 -26630.972 -19051.143  28.5%  2220 1145s
  5581  2711 -24978.074   16  258 -26630.972 -19051.143  28.5%  2253 1171s
  5600  2728 -19215.871   17  420 -26630.972 -19051.143  28.5%  2280 1185s
  5632  2740 -19870.135   18  406 -26630.972 -19051.143  28.5%  2297 1202s
  5669  2766 -19985.135   19  372 -26630.972 -19051.143  28.5%  2309 1216s
H 5671  2630                    -26570.08620 -19051.143  28.3%  2309 1216s
  5723  2640 -21152.763   20  560 -26570.086 -19051.143  28.3%  2322 1231s
H 5725  2512                    -26204.94313 -19051.143  27.3%  2323 1231s
  5756  2525 -22383.653   20  456 -26204.943 -19051.143  27.3%  2339 1244s
  5838  2531 -21913.594   21  543 -26204.943 -19051.143  27.3%  2375 1256s
  5911  2519 -23246.541   21  272 -26204.943 -19051.143  27.3%  2397 1268s
  5949  2516 -22660.132   21  296 -26204.943 -19051.143  27.3%  2409 1285s
  6005  2512 -25481.076   21  374 -26204.943 -19051.143  27.3%  2418 1298s
  6050  2510 -23347.118   22  276 -26204.943 -19051.143  27.3%  2431 1308s
  6108  2510 -25532.858   23  281 -26204.943 -19051.143  27.3%  2442 1319s
  6161  2503 -25767.408   22  367 -26204.943 -19051.143  27.3%  2456 1331s
  6212  2498 -25767.859   23  360 -26204.943 -19051.143  27.3%  2465 1341s
  6269  2503 -25769.899   24  273 -26204.943 -19051.143  27.3%  2478 1354s
  6330  2490 -26053.475   25  362 -26204.943 -19051.143  27.3%  2485 1365s
  6397  2492     cutoff   26      -26204.943 -19051.143  27.3%  2489 1376s
  6451  2497 -22144.406   21  627 -26204.943 -19051.143  27.3%  2503 1388s
  6525  2510 -23919.596   22  465 -26204.943 -19051.143  27.3%  2517 1399s
  6608  2500 -24200.485   23  470 -26204.943 -19051.143  27.3%  2526 1411s
  6690  2514 -24380.123   24  388 -26204.943 -19051.143  27.3%  2535 1424s
  6788  2491 -24550.770   25  470 -26204.943 -19051.143  27.3%  2542 1437s
  6915  2483 -25135.320   27  429 -26204.943 -19051.143  27.3%  2536 1450s
  7012  2484 -26100.168   26  439 -26204.943 -19051.143  27.3%  2545 1466s
  7100  2473 infeasible   27      -26204.943 -19051.143  27.3%  2553 1490s
  7218  2453 -22244.923   20  638 -26204.943 -19051.143  27.3%  2555 1507s
  7322  2434 -24746.765   22  423 -26204.943 -19051.143  27.3%  2563 1522s
  7429  2428     cutoff   23      -26204.943 -19051.143  27.3%  2577 1538s
  7546  2424 -23982.700   21  711 -26204.943 -19842.240  24.3%  2593 1554s
  7650  2409 -24146.634   22  644 -26204.943 -19842.240  24.3%  2613 1570s
  7767  2383 -25945.797   23  577 -26204.943 -20338.994  22.4%  2631 1586s
  7877  2365     cutoff   22      -26204.943 -20607.605  21.4%  2654 1605s
  8022  2323 -24800.048   26  228 -26204.943 -20630.244  21.3%  2664 1622s
  8119  2319 -24614.143   20  332 -26204.943 -20752.645  20.8%  2689 1640s
  8263  2303 -26091.343   23  218 -26204.943 -20752.645  20.8%  2703 1661s
  8439  2302 -22987.855   19  525 -26204.943 -21029.739  19.7%  2709 1682s
  8621  2260     cutoff   23      -26204.943 -21070.833  19.6%  2716 1703s
  8817  2241     cutoff   27      -26204.943 -21245.512  18.9%  2726 1724s
  9017  2185     cutoff   26      -26204.943 -21259.896  18.9%  2736 1745s
  9191  2178 -24781.390   25  537 -26204.943 -21429.676  18.2%  2743 1765s
  9350  2115 -25647.469   28  421 -26204.943 -21429.676  18.2%  2756 1787s
  9536  2082 -25192.606   27  278 -26204.943 -21944.191  16.3%  2776 1812s
  9742  1992     cutoff   22      -26204.943 -22010.919  16.0%  2793 1836s
  9949  1954 -23526.132   27  218 -26204.943 -22225.586  15.2%  2810 1863s
 10224  1901 -25694.331   51  130 -26204.943 -22225.586  15.2%  2813 1887s
 10445  1815 -24622.038   24  436 -26204.943 -22591.391  13.8%  2817 1915s
 10719  1706 infeasible   26      -26204.943 -22679.146  13.5%  2832 1943s
 10937  1593     cutoff   22      -26204.943 -22679.146  13.5%  2847 1977s
 11195  1475     cutoff   20      -26204.943 -23028.954  12.1%  2870 2008s
 11500  1320 infeasible   22      -26204.943 -23275.091  11.2%  2886 2038s
 11867  1075 infeasible   32      -26204.943 -23518.699  10.3%  2889 2071s
 12265   633 infeasible   23      -26204.943 -23906.182  8.77%  2887 2103s
 12804    50 infeasible   29      -26204.943 -24247.197  7.47%  2860 2129s
 13428     1 -26148.820   24  222 -26204.943 -25078.921  4.30%  2789 2151s

Cutting planes:
  Gomory: 4
  MIR: 977
  Flow cover: 1967
  Zero half: 1
  RLT: 19
  Relax-and-lift: 109

Explored 13500 nodes (37747388 simplex iterations) in 2152.73 seconds (6084.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26204.9 -26570.1 -26631 ... -26989.6
No other solutions better than -26204.9

Optimal solution found (tolerance 1.00e-06)
Best objective -2.620494312638e+04, best bound -2.620494312638e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 2152.75s
  Master Objective (UB) = -26204.94, θ = 94131.28
  Upper Bound (UB) = -26204.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94131.28
  [DEBUG]   ✓ Scenario 0: θ = 94131.28 ≤ Q = 94131.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94131.28 ≤ Q = 94131.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94131.28 ≤ Q = 94131.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94131.28 ≤ Q = 94131.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94131.28 ≤ Q = 94131.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94131.28 ≤ Q = 94131.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7bc74df3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7bc74df3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.063693e+13
Presolve removed 2624 rows and 1916 columns
Presolve time: 0.00s
Presolved: 469 rows, 473 columns, 1287 nonzeros
Found heuristic solution: objective 5072467.8745
Variable types: 318 continuous, 155 integer (155 binary)
Found heuristic solution: objective 5072052.7895

Root relaxation: objective -1.117951e+05, 221 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111795.15    0  118 5072052.79 -111795.15   102%     -    0s
H    0     0                    -61578.28411 -111795.15  81.5%     -    0s
H    0     0                    -65817.75544 -111795.15  69.9%     -    0s
H    0     0                    -66300.72971 -111795.15  68.6%     -    0s
H    0     0                    -66923.43505 -111649.77  66.8%     -    0s
H    0     0                    -69488.20532 -88212.018  26.9%     -    0s
H    0     0                    -78183.45902 -88212.018  12.8%     -    0s
H    0     0                    -86742.84116 -88212.018  1.69%     -    0s
     0     0 -88212.018    0   34 -86742.841 -88212.018  1.69%     -    0s
H    0     0                    -86748.06615 -88203.472  1.68%     -    0s
H    0     0                    -86822.33759 -88203.472  1.59%     -    0s
H    0     0                    -86827.56257 -88203.472  1.58%     -    0s
     0     0 -87904.518    0   27 -86827.563 -87904.518  1.24%     -    0s
H    0     0                    -87263.22125 -87901.904  0.73%     -    0s
     0     0 -87846.866    0   22 -87263.221 -87846.866  0.67%     -    0s
     0     0 -87432.928    0    4 -87263.221 -87432.928  0.19%     -    0s
     0     0 -87415.163    0    4 -87263.221 -87415.163  0.17%     -    0s
*    0     0               0    -87408.99151 -87408.992  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 107
  Flow cover: 6
  RLT: 33
  Relax-and-lift: 1

Explored 1 nodes (478 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -87409 -87263.2 -86827.6 ... -61578.3
No other solutions better than -87409

Optimal solution found (tolerance 1.00e-06)
Best objective -8.740899151379e+04, best bound -8.740899151379e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 85870.65
  Scenario: 13 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -87408.99
  [DEBUG]   S×d_nominal = 173279.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173279.64 + -87408.99 = 85870.65
  [DEBUG]   Current θ from Master = 94131.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8260.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -34465.57
  Lower Bound (LB) = -31551.64
  Gap (UB-LB) = 5346.6982, Absolute Gap = 5346.6982, Relative Gap = 0.204034
  Not converged yet (gap = 5346.70 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 46 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308094 nonzeros
Model fingerprint: 0x8ee7bf14
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 51004 rows and 20714 columns
Presolve time: 0.95s
Presolved: 57409 rows, 25226 columns, 356899 nonzeros
Variable types: 22967 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387235.2691
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 57409 rows, 25226 columns, 356899 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33486   -3.0193521e+04   0.000000e+00   2.828846e+07      5s
   45195   -1.2649228e+04   0.000000e+00   1.383304e+06     10s
   54572   -1.1189779e+04   0.000000e+00   2.971446e+07     15s
   62393   -1.0137172e+04   0.000000e+00   3.153045e+06     20s
   70415   -7.9422285e+03   0.000000e+00   5.059528e+05     25s
   77035   -7.6603716e+03   0.000000e+00   5.009797e+05     30s
Concurrent spin time: 6.03s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -6.767839e+03, 57085 iterations, 35.95 seconds (68.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6767.8387    0  369 -217728.64 -6767.8387  96.9%     -   37s
H    0     0                    -211243.2014 -6767.8387  96.8%     -   37s
H    0     0                    -125160.7652 -6767.8387  94.6%     -   37s
H    0     0                    -125149.0117 -6767.8387  94.6%     -   37s
H    0     0                    -124191.6811 -6767.8387  94.6%     -   37s
H    0     0                    -98620.48745 -6767.8387  93.1%     -   37s
H    0     0                    -97974.78441 -6767.8387  93.1%     -   37s
H    0     0                    -74189.27178 -6767.8387  90.9%     -   37s
H    0     0                    -64358.01549 -6767.8387  89.5%     -   37s
H    0     0                    -61427.77575 -6767.8387  89.0%     -   37s
H    0     0                    -50216.71070 -9747.4977  80.6%     -   50s
H    0     0                    -41723.97691 -9747.4977  76.6%     -   50s
     0     0 -9936.3846    0  519 -41723.977 -9936.3846  76.2%     -   50s
H    0     0                    -41087.13107 -9936.3846  75.8%     -   51s
H    0     0                    -40129.47890 -9936.3846  75.2%     -   51s
H    0     0                    -40107.58990 -9936.3846  75.2%     -   51s
     0     0 -10235.527    0  581 -40107.590 -10235.527  74.5%     -   57s
     0     0 -10235.527    0  469 -40107.590 -10235.527  74.5%     -   58s
     0     0 -10235.527    0  595 -40107.590 -10235.527  74.5%     -   64s
     0     0 -10235.527    0  601 -40107.590 -10235.527  74.5%     -   64s
     0     0 -10235.527    0  606 -40107.590 -10235.527  74.5%     -   65s
     0     0 -10235.527    0  606 -40107.590 -10235.527  74.5%     -   65s
     0     0 -12169.242    0  559 -40107.590 -12169.242  69.7%     -   81s
H    0     0                    -39687.98015 -12169.504  69.3%     -   82s
H    0     0                    -39585.96128 -12169.504  69.3%     -   82s
H    0     0                    -37747.01325 -12401.947  67.1%     -   91s
H    0     0                    -37617.37776 -12401.947  67.0%     -   91s
H    0     0                    -37527.37292 -12401.947  67.0%     -   91s
     0     0 -12401.947    0  560 -37527.373 -12401.947  67.0%     -   91s
H    0     0                    -36341.37900 -12485.530  65.6%     -   95s
H    0     0                    -36198.11797 -12485.530  65.5%     -   95s
     0     0 -12485.530    0  556 -36198.118 -12485.530  65.5%     -   96s
     0     0 -12575.168    0  609 -36198.118 -12575.168  65.3%     -   99s
H    0     0                    -27996.37581 -12579.842  55.1%     -  100s
H    0     0                    -27134.62403 -12579.842  53.6%     -  100s
H    0     0                    -27129.54221 -12579.842  53.6%     -  100s
     0     0 -12579.842    0  606 -27129.542 -12579.842  53.6%     -  100s
     0     0 -12636.034    0  536 -27129.542 -12636.034  53.4%     -  101s
     0     0 -12644.027    0  611 -27129.542 -12644.027  53.4%     -  102s
     0     0 -12682.915    0  503 -27129.542 -12682.915  53.3%     -  104s
     0     0 -12695.825    0  571 -27129.542 -12695.825  53.2%     -  106s
     0     0 -12700.842    0  560 -27129.542 -12700.842  53.2%     -  106s
     0     0 -12703.037    0  552 -27129.542 -12703.037  53.2%     -  107s
     0     0 -12703.037    0  552 -27129.542 -12703.037  53.2%     -  107s
     0     0 -13621.534    0  595 -27129.542 -13621.534  49.8%     -  129s
     0     0 -14027.839    0  599 -27129.542 -14027.839  48.3%     -  140s
     0     0 -14209.406    0  609 -27129.542 -14209.406  47.6%     -  145s
     0     0 -14300.818    0  617 -27129.542 -14300.818  47.3%     -  150s
     0     0 -14340.267    0  564 -27129.542 -14340.267  47.1%     -  153s
     0     0 -14349.783    0  618 -27129.542 -14349.783  47.1%     -  155s
     0     0 -14354.891    0  569 -27129.542 -14354.891  47.1%     -  156s
     0     0 -14365.753    0  622 -27129.542 -14365.753  47.0%     -  158s
     0     0 -14369.817    0  573 -27129.542 -14369.817  47.0%     -  159s
     0     0 -14373.376    0  563 -27129.542 -14373.376  47.0%     -  160s
     0     0 -14373.731    0  620 -27129.542 -14373.731  47.0%     -  160s
H    0     0                    -26864.78282 -14373.731  46.5%     -  166s
H    0     0                    -26846.69328 -14706.188  45.2%     -  177s
     0     0 -14706.188    0  583 -26846.693 -14706.188  45.2%     -  177s
H    0     0                    -26842.68726 -14706.509  45.2%     -  177s
H    0     0                    -26808.89353 -14979.266  44.1%     -  185s
H    0     0                    -26808.37778 -14979.266  44.1%     -  185s
H    0     0                    -26770.98311 -14979.266  44.0%     -  185s
H    0     0                    -26756.16083 -14979.266  44.0%     -  185s
H    0     0                    -26673.08751 -14979.266  43.8%     -  185s
H    0     0                    -26666.64128 -14979.266  43.8%     -  185s
     0     0 -14979.266    0  588 -26666.641 -14979.266  43.8%     -  185s
     0     0 -15076.053    0  713 -26666.641 -15076.053  43.5%     -  190s
     0     0 -15090.460    0  612 -26666.641 -15090.460  43.4%     -  192s
     0     0 -15106.645    0  620 -26666.641 -15106.645  43.4%     -  194s
     0     0 -15112.575    0  623 -26666.641 -15112.575  43.3%     -  195s
     0     0 -15114.764    0  628 -26666.641 -15114.764  43.3%     -  196s
     0     0 -15115.240    0  623 -26666.641 -15115.240  43.3%     -  196s
     0     0 -15204.193    0  733 -26666.641 -15204.193  43.0%     -  203s
H    0     0                    -26663.44276 -15249.698  42.8%     -  208s
     0     0 -15249.698    0  754 -26663.443 -15249.698  42.8%     -  208s
     0     0 -15261.107    0  637 -26663.443 -15261.107  42.8%     -  210s
     0     0 -15263.035    0  698 -26663.443 -15263.035  42.8%     -  211s
     0     0 -15265.964    0  629 -26663.443 -15265.964  42.7%     -  212s
     0     0 -15267.852    0  629 -26663.443 -15267.852  42.7%     -  212s
     0     0 -15268.615    0  632 -26663.443 -15268.615  42.7%     -  213s
     0     0 -15360.621    0  725 -26663.443 -15360.621  42.4%     -  222s
     0     0 -15374.651    0  741 -26663.443 -15374.651  42.3%     -  224s
     0     0 -15381.237    0  742 -26663.443 -15381.237  42.3%     -  226s
     0     0 -15385.166    0  741 -26663.443 -15385.166  42.3%     -  227s
     0     0 -15385.744    0  748 -26663.443 -15385.744  42.3%     -  227s
     0     0 -15415.181    0  689 -26663.443 -15415.181  42.2%     -  231s
     0     0 -15426.708    0  684 -26663.443 -15426.708  42.1%     -  233s
     0     0 -15437.362    0  685 -26663.443 -15437.362  42.1%     -  235s
     0     0 -15439.386    0  686 -26663.443 -15439.386  42.1%     -  236s
     0     0 -15440.722    0  696 -26663.443 -15440.722  42.1%     -  236s
     0     0 -15441.582    0  703 -26663.443 -15441.582  42.1%     -  237s
     0     0 -15460.149    0  627 -26663.443 -15460.149  42.0%     -  240s
     0     0 -15470.551    0  697 -26663.443 -15470.551  42.0%     -  243s
     0     0 -15471.819    0  702 -26663.443 -15471.819  42.0%     -  243s
     0     0 -15472.091    0  638 -26663.443 -15472.091  42.0%     -  244s
     0     0 -15503.948    0  704 -26663.443 -15503.948  41.9%     -  248s
     0     0 -15520.940    0  629 -26663.443 -15520.940  41.8%     -  250s
     0     0 -15524.978    0  698 -26663.443 -15524.978  41.8%     -  252s
     0     0 -15526.077    0  700 -26663.443 -15526.077  41.8%     -  253s
     0     0 -15589.252    0  690 -26663.443 -15589.252  41.5%     -  258s
     0     0 -15601.519    0  629 -26663.443 -15601.519  41.5%     -  259s
     0     0 -15604.926    0  685 -26663.443 -15604.926  41.5%     -  260s
     0     0 -15605.473    0  682 -26663.443 -15605.473  41.5%     -  261s
     0     0 -15614.277    0  697 -26663.443 -15614.277  41.4%     -  263s
     0     0 -15618.873    0  638 -26663.443 -15618.873  41.4%     -  265s
     0     0 -15620.086    0  642 -26663.443 -15620.086  41.4%     -  266s
     0     0 -15628.339    0  698 -26663.443 -15628.339  41.4%     -  268s
H    0     0                    -26646.22298 -15628.386  41.3%     -  269s
H    0     0                    -26640.93081 -15628.386  41.3%     -  269s
     0     0 -15629.982    0  642 -26640.931 -15629.982  41.3%     -  270s
     0     0 -15630.456    0  645 -26640.931 -15630.456  41.3%     -  271s
     0     0 -15634.690    0  640 -26640.931 -15634.690  41.3%     -  273s
     0     0 -15636.161    0  646 -26640.931 -15636.161  41.3%     -  274s
     0     0 -15637.129    0  647 -26640.931 -15637.129  41.3%     -  274s
     0     0 -15647.798    0  639 -26640.931 -15647.798  41.3%     -  277s
H    0     0                    -26632.86064 -15647.886  41.2%     -  277s
     0     0 -15657.953    0  649 -26632.861 -15657.953  41.2%     -  279s
     0     0 -15661.276    0  710 -26632.861 -15661.276  41.2%     -  280s
     0     0 -15661.522    0  713 -26632.861 -15661.522  41.2%     -  280s
     0     0 -15665.259    0  655 -26632.861 -15665.259  41.2%     -  282s
     0     0 -15665.619    0  655 -26632.861 -15665.619  41.2%     -  283s
     0     0 -15667.306    0  662 -26632.861 -15667.306  41.2%     -  284s
     0     0 -15675.958    0  656 -26632.861 -15675.958  41.1%     -  287s
     0     0 -15676.159    0  657 -26632.861 -15676.159  41.1%     -  288s
     0     0 -15681.407    0  657 -26632.861 -15681.407  41.1%     -  289s
     0     0 -15682.392    0  665 -26632.861 -15682.392  41.1%     -  290s
     0     0 -15683.748    0  656 -26632.861 -15683.748  41.1%     -  291s
H    0     0                    -26631.48819 -15683.898  41.1%     -  294s
     0     0 -15684.126    0  666 -26631.488 -15684.126  41.1%     -  294s
     0     0 -15687.221    0  656 -26631.488 -15687.221  41.1%     -  296s
     0     0 -15688.592    0  722 -26631.488 -15688.592  41.1%     -  297s
     0     0 -15688.809    0  715 -26631.488 -15688.809  41.1%     -  297s
     0     0 -15689.999    0  651 -26631.488 -15689.999  41.1%     -  299s
     0     0 -15690.122    0  651 -26631.488 -15690.122  41.1%     -  301s
H    0     0                    -26630.97245 -15690.172  41.1%     -  350s
     0     2 -15690.172    0  651 -26630.972 -15690.172  41.1%     -  365s
     3     8 -15711.319    2  702 -26630.972 -15694.823  41.1%  2105  373s
     7    16 -15766.718    3  702 -26630.972 -15711.384  41.0%  2868  381s
    15    31 -15946.242    4  683 -26630.972 -15766.720  40.8%  4439  401s
    30    46 -17659.962    5  587 -26630.972 -15946.360  40.1%  9847  421s
    45    78 -18137.816    5  580 -26630.972 -15946.360  40.1%  9468  480s
    77   198 -18170.868    6  561 -26630.972 -16065.575  39.7%  8290  503s
   203   292 -18201.516   10  552 -26630.972 -16066.120  39.7%  4187  513s
   319   314 -18693.865   13  516 -26630.972 -16066.120  39.7%  3360  523s
   416   314 -20521.187   14  513 -26630.972 -16066.120  39.7%  2943  533s
   462   335 -21369.450   15  430 -26630.972 -16066.120  39.7%  2822  542s
   517   337 -22559.968   16  397 -26630.972 -16066.120  39.7%  2782  554s
   566   355 -23310.767   16  349 -26630.972 -16066.120  39.7%  2703  564s
   626   378     cutoff   17      -26630.972 -16066.120  39.7%  2684  573s
   681   407     cutoff   18      -26630.972 -16066.120  39.7%  2665  582s
   747   437 -22321.944   15  216 -26630.972 -16066.120  39.7%  2648  591s
   809   468 -22799.388   16  182 -26630.972 -16066.120  39.7%  2589  600s
   884   490 -23847.012   18  195 -26630.972 -16066.120  39.7%  2545  609s
   963   514     cutoff   20      -26630.972 -16066.120  39.7%  2473  619s
  1043   535 -26340.656   26   68 -26630.972 -16066.120  39.7%  2447  630s
  1101   571 -22643.403   15  176 -26630.972 -16066.120  39.7%  2463  640s
  1171   617 -23511.586   16  110 -26630.972 -16066.120  39.7%  2471  650s
  1247   666 -24324.947   24  104 -26630.972 -16066.120  39.7%  2447  661s
  1339   699 -25994.867   32   67 -26630.972 -16066.120  39.7%  2416  671s
  1437   717 -23978.554   10  147 -26630.972 -16066.120  39.7%  2393  683s
  1478   736 -24594.378   11  143 -26630.972 -16066.120  39.7%  2413  695s
  1535   762     cutoff   12      -26630.972 -16066.120  39.7%  2424  706s
  1603   813 -24582.500   12  110 -26630.972 -16066.120  39.7%  2436  717s
  1694   848 -24902.440   14   99 -26630.972 -16066.120  39.7%  2424  730s
  1839   889 -25233.356   17  262 -26630.972 -16066.120  39.7%  2355  743s
  1940   925 -26564.135   18  373 -26630.972 -16066.120  39.7%  2335  758s
  2041   942 -25961.824   19  104 -26630.972 -16066.120  39.7%  2354  771s
  2094   958 -26023.791   29  375 -26630.972 -16066.120  39.7%  2374  785s
  2158   986 -26314.042   31  294 -26630.972 -16066.120  39.7%  2372  806s
  2220  1046 infeasible   35      -26630.972 -16716.229  37.2%  2394  820s
  2329  1103 -21949.277   15  337 -26630.972 -16716.229  37.2%  2384  836s
  2457  1163 -24861.101   20  229 -26630.972 -16716.229  37.2%  2405  853s
  2614  1243 -22553.668    8  612 -26630.972 -17203.779  35.4%  2400  868s
  2744  1285 -22968.110   11  539 -26630.972 -17203.779  35.4%  2421  885s
  2891  1353 -25381.780   13  474 -26630.972 -17203.779  35.4%  2435  902s
  3042  1378 -26546.193   15  492 -26630.972 -17203.779  35.4%  2453  921s
  3228  1448 -25210.652   15  338 -26630.972 -17203.779  35.4%  2438  941s
  3395  1517 -20761.677   15  208 -26630.972 -17203.779  35.4%  2447  960s
  3610  1602 -24909.860   18  238 -26630.972 -18079.408  32.1%  2444  985s
  3835  1685 -23179.305   18  362 -26630.972 -18222.541  31.6%  2432 1005s
  4068  1781     cutoff   21      -26630.972 -18276.542  31.4%  2422 1026s
  4290  1830 -24035.411    9  176 -26630.972 -18284.376  31.3%  2436 1047s
  4504  1897 -19941.958   12  509 -26630.972 -18284.376  31.3%  2439 1069s
  4713  2007 -23408.774   17  436 -26630.972 -18383.375  31.0%  2446 1093s
  4935  2060 -24458.280   23  297 -26630.972 -18383.375  31.0%  2460 1120s
  5183  2114     cutoff   16      -26630.972 -18660.007  29.9%  2465 1145s
  5417  2201 -23803.708   15  458 -26630.972 -18852.868  29.2%  2491 1177s
  5667  2260 -25227.148   15  442 -26630.972 -18873.197  29.1%  2510 1205s
  5926  2286 -26000.662   19  390 -26630.972 -19296.058  27.5%  2497 1227s
  5982  2287 -23250.219   16  651 -26630.972 -19296.058  27.5%  2505 1308s
  5984  2288 -24119.830   16  369 -26630.972 -19296.058  27.5%  2504 1348s
  5985  2289 -23361.487    9  660 -26630.972 -19296.058  27.5%  2504 1370s
  5986  2290 -19429.158    9  736 -26630.972 -19296.058  27.5%  2504 1389s
  5987  2290 -23267.893   14  637 -26630.972 -19296.058  27.5%  2503 1403s
  5988  2291 -22322.080   11  651 -26630.972 -19296.058  27.5%  2503 1409s
  5989  2292 -24004.071   14  728 -26630.972 -19296.058  27.5%  2502 1414s
  5990  2292 -23285.996   12  601 -26630.972 -19296.058  27.5%  2502 1421s
  5991  2293 -20797.175   12  680 -26630.972 -19296.058  27.5%  2502 1426s
  5993  2294 -22008.189   24  696 -26630.972 -19296.058  27.5%  2501 1432s
  5994  2295 -22754.918   21  636 -26630.972 -19296.058  27.5%  2500 1443s
  5995  2296 -24030.498   14  619 -26630.972 -19296.058  27.5%  2500 1448s
  5996  2296 -25347.433   13  694 -26630.972 -19296.058  27.5%  2499 1451s
  5997  2297 -20625.700   10  630 -26630.972 -19296.058  27.5%  2499 1461s
  5998  2298 -24021.764   14  675 -26630.972 -19296.058  27.5%  2499 1465s
  6000  2299 -24687.229   11  738 -26630.972 -19296.058  27.5%  2498 1473s
  6001  2300 -23293.952   21  678 -26630.972 -19296.058  27.5%  2497 1483s
  6002  2300 -24114.456   17  695 -26630.972 -19296.058  27.5%  2497 1490s
  6004  2302 -23612.602   22  635 -26630.972 -19296.058  27.5%  2496 1499s
  6005  2302 -24803.088   14  751 -26630.972 -19296.058  27.5%  2496 1509s
  6006  2303 -23237.278   14  762 -26630.972 -19296.058  27.5%  2495 1514s
  6007  2304 -24828.864   14  684 -26630.972 -19296.058  27.5%  2495 1526s
  6008  2304 -22464.195   16  684 -26630.972 -19296.058  27.5%  2494 1562s
  6009  2305 -24477.079   22  684 -26630.972 -19296.058  27.5%  2494 1587s
  6010  2309 -19296.058   12  676 -26630.972 -19296.058  27.5%  2531 1602s
  6012  2312 -19296.058   13  666 -26630.972 -19296.058  27.5%  2533 1626s
  6016  2319 -19296.058   14  622 -26630.972 -19296.058  27.5%  2534 1646s
  6024  2331 -19296.058   15  633 -26630.972 -19296.058  27.5%  2540 1668s
  6039  2347 -19296.058   16  636 -26630.972 -19296.058  27.5%  2575 1722s
  6060  2359 -19296.058   16  596 -26630.972 -19296.058  27.5%  2598 1750s
  6091  2377 -20747.197   17  472 -26630.972 -19296.058  27.5%  2630 1774s
  6123  2416 -21003.851   18  411 -26630.972 -19296.058  27.5%  2662 1794s
  6188  2436 -22433.405   22  259 -26630.972 -19296.058  27.5%  2722 1809s
  6263  2437 -25745.828   25  191 -26630.972 -19296.058  27.5%  2764 1823s
  6324  2435     cutoff   26      -26630.972 -19296.058  27.5%  2809 1842s
  6381  2435     cutoff   21      -26630.972 -19296.058  27.5%  2851 1858s
  6439  2428 infeasible   22      -26630.972 -19296.058  27.5%  2892 1872s
  6514  2429 -26038.400   22  358 -26630.972 -19296.058  27.5%  2915 1889s
  6577  2417 -21742.612   20  476 -26630.972 -19296.058  27.5%  2938 1912s
  6631  2417 -22265.955   21  337 -26630.972 -19296.058  27.5%  2966 1926s
  6690  2421 -22635.272   22  267 -26630.972 -19296.058  27.5%  3011 1940s
  6744  2445 -21784.885   21  379 -26630.972 -19296.058  27.5%  3040 1953s
  6822  2442 -22778.838   24  246 -26630.972 -19296.058  27.5%  3054 1965s
  6893  2437 -23787.073   27  193 -26630.972 -19296.058  27.5%  3075 1979s
  6970  2426     cutoff   28      -26630.972 -19296.058  27.5%  3100 1991s
  7018  2433     cutoff   28      -26630.972 -19296.058  27.5%  3129 2010s
  7092  2435 -26337.634   27  292 -26630.972 -19296.058  27.5%  3143 2026s
  7167  2445 infeasible   28      -26630.972 -19296.058  27.5%  3179 2045s
  7252  2458 -21115.926   19  683 -26630.972 -19296.058  27.5%  3214 2061s
H 7271  2335                    -26593.67023 -19296.058  27.4%  3222 2061s
  7338  2375 -21621.156   20  623 -26593.670 -19296.058  27.4%  3238 2076s
  7441  2397 -22328.135   22  591 -26593.670 -19296.058  27.4%  3260 2092s
H 7491  2270                    -26543.07463 -19296.058  27.3%  3266 2092s
  7560  2274 -23078.915   24  397 -26543.075 -19296.058  27.3%  3272 2109s
  7688  2267 -23280.795   27  509 -26543.075 -19296.058  27.3%  3283 2127s
H 7736  2146                    -26518.64350 -19296.058  27.2%  3298 2127s
  7797  2160     cutoff   31      -26518.644 -19296.058  27.2%  3313 2145s
  7904  2154     cutoff   31      -26518.644 -19439.128  26.7%  3341 2162s
  7991  2167 -25025.778   35  341 -26518.644 -19439.128  26.7%  3371 2179s
  8093  2153 -25446.931   48  152 -26518.644 -19871.678  25.1%  3414 2196s
H 8109  2049                    -26517.00929 -19871.678  25.1%  3413 2196s
H 8144  1943                    -26507.92162 -20327.231  23.3%  3436 2196s
H 8163  1860                    -26445.84341 -20327.231  23.1%  3448 2214s
H 8165  1773                    -26417.46528 -20327.231  23.1%  3447 2214s
  8205  1770 -25802.784   63  117 -26417.465 -20327.231  23.1%  3474 2231s
  8248  1769 -25806.802   64  114 -26417.465 -20547.548  22.2%  3501 2250s
  8309  1769 -21789.732   23  688 -26417.465 -20547.548  22.2%  3537 2270s
  8390  1783 -22267.827   25  398 -26417.465 -20618.086  22.0%  3576 2292s
  8485  1775 -24195.431   29  305 -26417.465 -20618.086  22.0%  3613 2315s
  8602  1767 -26312.986   33  222 -26417.465 -20914.812  20.8%  3670 2338s
  8733  1763 -24448.349   23  607 -26417.465 -20971.391  20.6%  3721 2361s
  8874  1752 -25278.142   27  364 -26417.465 -20971.391  20.6%  3771 2387s
  9017  1744     cutoff   30      -26417.465 -21076.330  20.2%  3837 2415s
  9144  1762 -24010.437   18  440 -26417.465 -21076.330  20.2%  3895 2441s
  9336  1778     cutoff   20      -26417.465 -21367.799  19.1%  3938 2468s
  9513  1774 -25928.532   23  361 -26417.465 -21376.390  19.1%  3989 2496s
  9730  1716 -23457.513   25  463 -26417.465 -21502.524  18.6%  4035 2524s
  9799  1743 -23780.910   26  335 -26417.465 -21502.524  18.6%  4068 2553s
H 9838  1650                    -26405.84810 -21502.524  18.6%  4081 2553s
  9962  1676 -23858.956   27  335 -26405.848 -21624.963  18.1%  4099 2583s
 10184  1654 -24633.790   33  308 -26405.848 -21824.568  17.3%  4149 2617s
 10444  1615     cutoff   21      -26405.848 -22005.794  16.7%  4184 2655s
 10723  1598 infeasible   26      -26405.848 -22072.810  16.4%  4214 2688s
 10957  1620 infeasible   27      -26405.848 -22272.810  15.7%  4277 2725s
 11175  1657 -25277.185   21  455 -26405.848 -22393.357  15.2%  4348 2760s
 11500  1682 -23899.822   33  251 -26405.848 -22393.357  15.2%  4385 2805s
 11818  1695 -25114.541   31  300 -26405.848 -22580.480  14.5%  4424 2845s
 12132  1708     cutoff   30      -26405.848 -22763.119  13.8%  4475 2884s
 12442  1709 -24674.780   22  363 -26405.848 -22961.021  13.0%  4539 2928s
 12813  1686     cutoff   30      -26405.848 -23097.880  12.5%  4588 2971s
 13184  1670 -26154.219   26  221 -26405.848 -23333.896  11.6%  4628 3018s
 13588  1575 infeasible   35      -26405.848 -23505.283  11.0%  4658 3062s
 13961  1543 infeasible   23      -26405.848 -23699.069  10.3%  4703 3111s
 14533  1390 infeasible   33      -26405.848 -23901.016  9.49%  4682 3160s
 15164  1134 infeasible   29      -26405.848 -24232.782  8.23%  4668 3211s
 16073   601 infeasible   27      -26405.848 -24536.002  7.08%  4585 3257s
 17401    32 infeasible   29      -26405.848 -25032.637  5.20%  4395 3293s
 18478     0 infeasible   27      -26405.848 -25479.696  3.51%  4221 3298s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 889
  Flow cover: 2212
  Zero half: 2
  RLT: 21
  Relax-and-lift: 155

Explored 18528 nodes (78345443 simplex iterations) in 3298.92 seconds (9530.96 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26405.8 -26417.5 -26445.8 ... -26631.5
No other solutions better than -26405.8

Optimal solution found (tolerance 1.00e-06)
Best objective -2.640584809856e+04, best bound -2.640584809856e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3298.95s
  Master Objective (UB) = -26405.85, θ = 94055.57
  Upper Bound (UB) = -26405.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94055.57
  [DEBUG]   ✓ Scenario 0: θ = 94055.57 ≤ Q = 94055.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94055.57 ≤ Q = 94055.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94055.57 ≤ Q = 94055.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94055.57 ≤ Q = 94055.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94055.57 ≤ Q = 94055.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94055.57 ≤ Q = 94055.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94055.57 ≤ Q = 94055.57 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2126bde6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xded9421a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.077478e+13
Presolve removed 2618 rows and 1911 columns
Presolve time: 0.00s
Presolved: 475 rows, 478 columns, 1303 nonzeros
Found heuristic solution: objective 5187978.1281
Variable types: 322 continuous, 156 integer (156 binary)

Root relaxation: objective -1.120007e+05, 224 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112000.67    0  120 5187978.13 -112000.67   102%     -    0s
H    0     0                    -79074.51871 -112000.67  41.6%     -    0s
H    0     0                    -79741.23074 -112000.67  40.5%     -    0s
     0     0 -84282.770    0   80 -79741.231 -84282.770  5.70%     -    0s
H    0     0                    -82880.31137 -84272.944  1.68%     -    0s
H    0     0                    -83053.70235 -84272.944  1.47%     -    0s
     0     0 -84002.726    0   79 -83053.702 -84002.726  1.14%     -    0s
H    0     0                    -83309.30893 -83991.021  0.82%     -    0s
     0     0 -83975.633    0   78 -83309.309 -83975.633  0.80%     -    0s
     0     0 -83500.192    0   67 -83309.309 -83500.192  0.23%     -    0s
     0     0 -83423.656    0   56 -83309.309 -83423.656  0.14%     -    0s
     0     0 -83418.743    0   47 -83309.309 -83418.743  0.13%     -    0s
H    0     0                    -83418.28010 -83418.706  0.00%     -    0s
     0     0     cutoff    0      -83418.280 -83418.280  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 135
  Flow cover: 1
  RLT: 14
  Relax-and-lift: 5

Explored 1 nodes (469 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -83418.3 -83309.3 -83053.7 ... 1.07748e+13
No other solutions better than -83418.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.341828010498e+04, best bound -8.341828010498e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 90326.78
  Scenario: 13 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83418.28
  [DEBUG]   S×d_nominal = 173745.06
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173745.06 + -83418.28 = 90326.78
  [DEBUG]   Current θ from Master = 94055.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3728.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30134.64
  Lower Bound (LB) = -30134.64
  Gap (UB-LB) = 3728.7883, Absolute Gap = 3728.7883, Relative Gap = 0.141211
  Not converged yet (gap = 3728.79 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 46 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351319 nonzeros
Model fingerprint: 0xd0a56ea0
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 58296 rows and 23676 columns
Presolve time: 1.11s
Presolved: 65407 rows, 28504 columns, 407079 nonzeros
Variable types: 26245 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387235.2691
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 65407 rows, 28504 columns, 407079 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27427   -6.9719698e+04   0.000000e+00   1.610341e+08      5s
   38041   -2.0887222e+04   0.000000e+00   1.973598e+06     10s
   44023   -2.0257631e+04   0.000000e+00   1.013508e+07     15s
   50777   -1.8777572e+04   0.000000e+00   4.028854e+06     20s
   57373   -1.5793445e+04   0.000000e+00   9.272887e+05     25s
   62542   -1.5392927e+04   0.000000e+00   1.944746e+06     30s
   67693   -1.5241133e+04   0.000000e+00   1.995112e+06     35s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective -6.767839e+03, 56265 iterations, 33.92 seconds (70.51 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6767.8387    0  369 -217728.64 -6767.8387  96.9%     -   35s
H    0     0                    -209395.9608 -6767.8387  96.8%     -   35s
H    0     0                    -137970.4860 -6767.8387  95.1%     -   35s
H    0     0                    -130660.8762 -6767.8387  94.8%     -   35s
H    0     0                    -106570.9223 -6767.8387  93.6%     -   35s
H    0     0                    -67651.38593 -6767.8387  90.0%     -   36s
H    0     0                    -66929.26880 -6767.8387  89.9%     -   36s
H    0     0                    -64445.75341 -6767.8387  89.5%     -   37s
H    0     0                    -63511.01714 -6767.8387  89.3%     -   37s
H    0     0                    -61660.35265 -6767.8387  89.0%     -   37s
H    0     0                    -61047.25341 -6767.8387  88.9%     -   37s
H    0     0                    -60980.61226 -6767.8387  88.9%     -   37s
H    0     0                    -60869.35351 -6767.8387  88.9%     -   37s
H    0     0                    -60514.05324 -6767.8387  88.8%     -   37s
     0     0 -9715.5517    0  460 -60514.053 -9715.5517  83.9%     -   49s
H    0     0                    -42124.00171 -9715.5517  76.9%     -   49s
H    0     0                    -40271.83277 -9715.5517  75.9%     -   49s
H    0     0                    -40190.98324 -9715.5517  75.8%     -   49s
H    0     0                    -40181.86924 -9715.5517  75.8%     -   49s
     0     0 -9930.3864    0  465 -40181.869 -9930.3864  75.3%     -   55s
     0     0 -9930.3864    0  463 -40181.869 -9930.3864  75.3%     -   55s
     0     0 -10227.664    0  596 -40181.869 -10227.664  74.5%     -   65s
     0     0 -10227.664    0  601 -40181.869 -10227.664  74.5%     -   66s
     0     0 -10227.664    0  603 -40181.869 -10227.664  74.5%     -   66s
     0     0 -10227.664    0  603 -40181.869 -10227.664  74.5%     -   67s
     0     0 -10227.664    0  603 -40181.869 -10227.664  74.5%     -   67s
     0     0 -12362.157    0  490 -40181.869 -12362.157  69.2%     -   85s
H    0     0                    -33604.34978 -12362.253  63.2%     -   86s
H    0     0                    -33558.51838 -12362.253  63.2%     -   86s
H    0     0                    -33351.07787 -12362.253  62.9%     -   86s
H    0     0                    -33315.81650 -12362.253  62.9%     -   86s
     0     0 -12495.976    0  493 -33315.817 -12495.976  62.5%     -   89s
     0     0 -12621.878    0  547 -33315.817 -12621.878  62.1%     -   94s
     0     0 -12647.188    0  549 -33315.817 -12647.188  62.0%     -   95s
     0     0 -12766.259    0  554 -33315.817 -12766.259  61.7%     -   98s
     0     0 -12787.190    0  561 -33315.817 -12787.190  61.6%     -  101s
     0     0 -12793.540    0  562 -33315.817 -12793.540  61.6%     -  101s
     0     0 -12804.958    0  562 -33315.817 -12804.958  61.6%     -  103s
     0     0 -12813.347    0  565 -33315.817 -12813.347  61.5%     -  104s
     0     0 -12814.746    0  565 -33315.817 -12814.746  61.5%     -  105s
     0     0 -12814.798    0  565 -33315.817 -12814.798  61.5%     -  105s
H    0     0                    -32337.42606 -12814.798  60.4%     -  111s
H    0     0                    -31030.24672 -12814.798  58.7%     -  111s
H    0     0                    -31005.81560 -12814.798  58.7%     -  111s
     0     0 -14268.887    0  598 -31005.816 -14268.887  54.0%     -  133s
H    0     0                    -30985.74054 -14525.529  53.1%     -  142s
H    0     0                    -30944.48157 -14525.529  53.1%     -  142s
H    0     0                    -30899.26066 -14525.529  53.0%     -  142s
H    0     0                    -30893.62698 -14525.529  53.0%     -  142s
     0     0 -14525.529    0  622 -30893.627 -14525.529  53.0%     -  142s
     0     0 -14587.461    0  628 -30893.627 -14587.461  52.8%     -  148s
     0     0 -14595.504    0  634 -30893.627 -14595.504  52.8%     -  150s
     0     0 -14602.242    0  637 -30893.627 -14602.242  52.7%     -  152s
     0     0 -14604.839    0  632 -30893.627 -14604.839  52.7%     -  152s
     0     0 -14606.851    0  633 -30893.627 -14606.851  52.7%     -  153s
     0     0 -14621.187    0  643 -30893.627 -14621.187  52.7%     -  155s
     0     0 -14643.578    0  643 -30893.627 -14643.578  52.6%     -  157s
     0     0 -14646.241    0  646 -30893.627 -14646.241  52.6%     -  158s
H    0     0                    -29579.28794 -14656.991  50.4%     -  161s
H    0     0                    -29548.74134 -14656.991  50.4%     -  161s
H    0     0                    -29444.67628 -14656.991  50.2%     -  161s
H    0     0                    -29442.96648 -14656.991  50.2%     -  161s
     0     0 -14656.991    0  643 -29442.966 -14656.991  50.2%     -  161s
     0     0 -14659.182    0  645 -29442.966 -14659.182  50.2%     -  162s
     0     0 -14659.668    0  649 -29442.966 -14659.668  50.2%     -  162s
     0     0 -15018.716    0  655 -29442.966 -15018.716  49.0%     -  191s
H    0     0                    -29436.34229 -15019.128  49.0%     -  192s
H    0     0                    -29435.01681 -15019.128  49.0%     -  192s
H    0     0                    -29414.16012 -15182.310  48.4%     -  199s
H    0     0                    -29379.96870 -15182.310  48.3%     -  199s
H    0     0                    -29374.94071 -15182.310  48.3%     -  199s
     0     0 -15182.310    0  674 -29374.941 -15182.310  48.3%     -  199s
     0     0 -15282.422    0  677 -29374.941 -15282.422  48.0%     -  205s
     0     0 -15317.418    0  677 -29374.941 -15317.418  47.9%     -  207s
     0     0 -15328.193    0  676 -29374.941 -15328.193  47.8%     -  208s
     0     0 -15333.252    0  679 -29374.941 -15333.252  47.8%     -  209s
     0     0 -15336.242    0  682 -29374.941 -15336.242  47.8%     -  210s
     0     0 -15336.744    0  687 -29374.941 -15336.744  47.8%     -  211s
H    0     0                    -27262.54891 -15403.933  43.5%     -  218s
H    0     0                    -26864.61554 -15403.933  42.7%     -  218s
H    0     0                    -26848.33208 -15403.933  42.6%     -  218s
H    0     0                    -26818.26485 -15403.933  42.6%     -  218s
     0     0 -15403.933    0  630 -26818.265 -15403.933  42.6%     -  218s
H    0     0                    -26717.70266 -15427.448  42.3%     -  221s
H    0     0                    -26707.41910 -15427.448  42.2%     -  221s
     0     0 -15427.448    0  696 -26707.419 -15427.448  42.2%     -  221s
     0     0 -15439.902    0  758 -26707.419 -15439.902  42.2%     -  224s
     0     0 -15444.281    0  752 -26707.419 -15444.281  42.2%     -  225s
     0     0 -15445.129    0  758 -26707.419 -15445.129  42.2%     -  226s
     0     0 -15489.749    0  714 -26707.419 -15489.749  42.0%     -  230s
     0     0 -15501.830    0  714 -26707.419 -15501.830  42.0%     -  234s
     0     0 -15505.361    0  728 -26707.419 -15505.361  41.9%     -  235s
     0     0 -15506.329    0  728 -26707.419 -15506.329  41.9%     -  236s
     0     0 -15537.885    0  767 -26707.419 -15537.885  41.8%     -  241s
     0     0 -15544.469    0  720 -26707.419 -15544.469  41.8%     -  243s
     0     0 -15547.737    0  724 -26707.419 -15547.737  41.8%     -  244s
     0     0 -15548.920    0  724 -26707.419 -15548.920  41.8%     -  245s
     0     0 -15549.119    0  727 -26707.419 -15549.119  41.8%     -  245s
     0     0 -15561.724    0  646 -26707.419 -15561.724  41.7%     -  249s
H    0     0                    -26703.41308 -15561.818  41.7%     -  249s
     0     0 -15577.429    0  692 -26703.413 -15577.429  41.7%     -  252s
     0     0 -15583.536    0  695 -26703.413 -15583.536  41.6%     -  254s
     0     0 -15588.572    0  703 -26703.413 -15588.572  41.6%     -  256s
     0     0 -15589.800    0  697 -26703.413 -15589.800  41.6%     -  257s
     0     0 -15590.186    0  727 -26703.413 -15590.186  41.6%     -  257s
     0     0 -15621.460    0  714 -26703.413 -15621.460  41.5%     -  261s
     0     0 -15630.268    0  720 -26703.413 -15630.268  41.5%     -  263s
     0     0 -15632.942    0  722 -26703.413 -15632.942  41.5%     -  265s
     0     0 -15633.487    0  727 -26703.413 -15633.487  41.5%     -  266s
     0     0 -15647.825    0  727 -26703.413 -15647.825  41.4%     -  270s
     0     0 -15648.401    0  734 -26703.413 -15648.401  41.4%     -  271s
     0     0 -15654.680    0  728 -26703.413 -15654.680  41.4%     -  274s
     0     0 -15656.512    0  733 -26703.413 -15656.512  41.4%     -  275s
     0     0 -15657.212    0  735 -26703.413 -15657.212  41.4%     -  276s
     0     0 -15658.680    0  732 -26703.413 -15658.680  41.4%     -  278s
H    0     0                    -26692.14439 -15658.885  41.3%     -  278s
H    0     0                    -26691.62865 -15658.885  41.3%     -  278s
     0     0 -15659.247    0  729 -26691.629 -15659.247  41.3%     -  279s
     0     0 -15661.961    0  779 -26691.629 -15661.961  41.3%     -  282s
     0     0 -15662.133    0  779 -26691.629 -15662.133  41.3%     -  284s
H    0     0                    -26662.10248 -15662.338  41.3%     -  324s
H    0     0                    -26656.29457 -15662.338  41.2%     -  324s
     0     2 -15662.338    0  779 -26656.295 -15662.338  41.2%     -  325s
     1     3 -15917.390    1  433 -26656.295 -15662.338  41.2%  7295  332s
     2     4 -15748.670    1  714 -26656.295 -15748.670  40.9%  4606  339s
     3     8 -16009.686    2  619 -26656.295 -15748.719  40.9%  5549  346s
     7    16 -16212.499    3  667 -26656.295 -15836.865  40.6%  4937  358s
    15    31 -16223.947    4  620 -26656.295 -15909.932  40.3%  6067  375s
    30    46 -17196.574    5  450 -26656.295 -15940.537  40.2%  9434  403s
H   45    77                    -26633.42281 -15940.537  40.1%  9872  422s
H   58    77                    -26630.97245 -15940.537  40.1%  8950  422s
    76   218 -17270.118    7  410 -26630.972 -15940.537  40.1%  7964  438s
   217   256 -18665.919   11  393 -26630.972 -15940.537  40.1%  4547  446s
   255   306 -18891.982   12  387 -26630.972 -15940.537  40.1%  4463  455s
   305   356 -19082.892   13  395 -26630.972 -15940.537  40.1%  4174  463s
   369   397 -24185.780   14  226 -26630.972 -15940.537  40.1%  3885  473s
   428   434 -26175.681   15  145 -26630.972 -15940.537  40.1%  3741  481s
   494   463 -26367.915   16  169 -26630.972 -15940.537  40.1%  3667  491s
   565   499 -22030.962   12  250 -26630.972 -15940.537  40.1%  3794  501s
   623   508 -23187.982   13  220 -26630.972 -15940.537  40.1%  3742  509s
   691   541 infeasible   14      -26630.972 -15940.537  40.1%  3722  518s
   757   550     cutoff   14      -26630.972 -15940.537  40.1%  3781  528s
   839   570 -22802.113   12  398 -26630.972 -15940.537  40.1%  3739  537s
   873   577 -25840.385   14  169 -26630.972 -15940.537  40.1%  3815  546s
   926   586     cutoff   13      -26630.972 -16172.774  39.3%  3776  555s
   967   613 -22541.857    8  217 -26630.972 -16172.821  39.3%  3779  564s
  1022   628 -24725.296    9  186 -26630.972 -16172.821  39.3%  3791  577s
  1067   646     cutoff   15      -26630.972 -16172.821  39.3%  3800  587s
  1129   677 -23778.344   15  246 -26630.972 -16172.821  39.3%  3805  598s
  1229   677 -25327.588   16  215 -26630.972 -16172.821  39.3%  3696  609s
  1320   703 -24294.085   16  244 -26630.972 -16172.883  39.3%  3625  620s
  1402   751 -24387.834   17  164 -26630.972 -16172.883  39.3%  3676  631s
H 1479   818                    -26615.81943 -16172.883  39.2%  3752  642s
  1588   849 -25775.504   18  226 -26615.819 -16172.883  39.2%  3791  654s
  1718   856     cutoff   20      -26615.819 -16172.883  39.2%  3784  666s
  1817   903 -23533.447   10  394 -26615.819 -16488.723  38.0%  3837  678s
  1922   952     cutoff   11      -26615.819 -16488.723  38.0%  3881  691s
  2028   996 -18934.565    8  637 -26615.819 -16488.723  38.0%  3961  704s
  2140  1067 -25675.345   16  212 -26615.819 -16488.723  38.0%  3982  719s
  2290  1151 -19734.298   10  605 -26615.819 -16488.723  38.0%  3965  733s
  2468  1186 -20131.093   11  598 -26615.819 -16488.723  38.0%  3919  748s
  2576  1227 -22224.755   12  463 -26615.819 -16488.723  38.0%  3988  763s
H 2612  1227                    -26613.49155 -16488.723  38.0%  4022  763s
  2654  1271 -22943.243   14  510 -26613.492 -16488.723  38.0%  4083  778s
  2780  1363 -24772.953   19  271 -26613.492 -16488.723  38.0%  4131  795s
  2950  1436 -26422.636   36  159 -26613.492 -16543.692  37.8%  4121  810s
  3117  1496 -20045.551   12  547 -26613.492 -16543.692  37.8%  4114  827s
  3263  1561 -21051.262   14  340 -26613.492 -16543.692  37.8%  4117  842s
  3409  1605 -24149.248   16  147 -26613.492 -16543.692  37.8%  4145  859s
H 3566  1639                    -26601.48666 -17085.477  35.8%  4174  878s
H 3566  1639                    -26494.22957 -17085.477  35.5%  4174  878s
H 3626  1639                    -26463.22041 -17085.477  35.4%  4202  878s
  3636  1700 -21919.045   11  257 -26463.220 -17096.539  35.4%  4224  897s
  3888  1724 -20179.741    8  456 -26463.220 -17389.306  34.3%  4240  912s
H 3895  1724                    -26438.78928 -17389.306  34.2%  4240  912s
H 3914  1724                    -26433.64894 -17389.306  34.2%  4272  912s
  3928  1782 -22185.795    9  173 -26433.649 -17389.306  34.2%  4292  931s
  4148  1808 -25865.151   17  113 -26433.649 -17389.306  34.2%  4313  951s
  4373  1845 -25547.764   14  210 -26433.649 -17389.306  34.2%  4332  972s
  4564  1901 -22374.896   12  405 -26433.649 -17601.267  33.4%  4381  994s
H 4730  1944                    -26425.34426 -17601.267  33.4%  4450 1015s
  4897  2011     cutoff   24      -26425.344 -17601.267  33.4%  4480 1039s
H 5098  2028                    -26417.46528 -17601.267  33.4%  4531 1056s
  5141  2054 -25398.132   11  211 -26417.465 -18029.100  31.8%  4560 1079s
  5407  2086 -24899.263   11  200 -26417.465 -18029.100  31.8%  4575 1106s
  5664  2241 infeasible   18      -26417.465 -18409.518  30.3%  4605 1132s
  6045  2242 -23331.071   11  779 -26417.465 -18458.037  30.1%  4542 1223s
  6047  2243 -20080.447   11  369 -26417.465 -18458.037  30.1%  4540 1268s
  6048  2244 -23114.824   14  699 -26417.465 -18458.037  30.1%  4539 1296s
  6049  2245 -25090.127   12  624 -26417.465 -18458.037  30.1%  4539 1319s
  6050  2245 -23302.809   12  674 -26417.465 -18458.037  30.1%  4538 1333s
  6051  2246 -25145.875    9  736 -26417.465 -18458.037  30.1%  4537 1344s
  6052  2247 -26179.607   33  742 -26417.465 -18458.037  30.1%  4536 1355s
  6053  2247 -21800.972   11  745 -26417.465 -18458.037  30.1%  4536 1364s
  6054  2248 -22954.734   22  748 -26417.465 -18458.037  30.1%  4535 1369s
  6055  2249 -25676.798   17  760 -26417.465 -18458.037  30.1%  4534 1374s
  6056  2249 -25563.013   19  760 -26417.465 -18458.037  30.1%  4533 1379s
  6057  2250 -19500.951   11  707 -26417.465 -18458.037  30.1%  4533 1383s
  6058  2251 -24092.377   24  743 -26417.465 -18458.037  30.1%  4532 1403s
  6059  2251 -24536.662   18  692 -26417.465 -18458.037  30.1%  4531 1413s
  6060  2252 -24950.281   15  701 -26417.465 -18458.037  30.1%  4530 1417s
  6061  2253 -25466.207   21  702 -26417.465 -18458.037  30.1%  4530 1422s
  6062  2253 -22798.656   29  673 -26417.465 -18458.037  30.1%  4529 1434s
  6063  2254 -20081.705    9  680 -26417.465 -18458.037  30.1%  4528 1440s
  6065  2255 -25744.242   11  733 -26417.465 -18458.037  30.1%  4527 1450s
  6066  2256 -25844.908   25  725 -26417.465 -18458.037  30.1%  4526 1463s
  6067  2257 -24429.173   21  680 -26417.465 -18458.037  30.1%  4525 1470s
  6068  2257 -25325.358   24  616 -26417.465 -18458.037  30.1%  4524 1476s
  6069  2258 -21667.542   18  601 -26417.465 -18458.037  30.1%  4524 1485s
  6070  2259 -20015.349   10  670 -26417.465 -18458.037  30.1%  4523 1491s
  6071  2259 -23522.547   14  677 -26417.465 -18458.037  30.1%  4522 1501s
  6072  2260 -21994.187   10  688 -26417.465 -18458.037  30.1%  4521 1505s
  6073  2261 -21248.084   13  683 -26417.465 -18458.037  30.1%  4521 1510s
  6074  2261 -24649.632   12  670 -26417.465 -18458.037  30.1%  4520 1519s
  6075  2262 -22033.865   12  687 -26417.465 -18458.037  30.1%  4519 1525s
  6076  2263 -21006.350   11  747 -26417.465 -18458.037  30.1%  4518 1534s
  6077  2263 -21258.417   18  747 -26417.465 -18458.037  30.1%  4518 1608s
  6078  2264 -23092.101   24  747 -26417.465 -18458.037  30.1%  4517 1637s
  6079  2268 -18458.037   12  661 -26417.465 -18458.037  30.1%  4565 1664s
  6081  2271 -18458.037   13  716 -26417.465 -18458.037  30.1%  4566 1687s
  6085  2278 -18458.037   14  728 -26417.465 -18458.037  30.1%  4568 1705s
  6093  2291 -18458.037   15  725 -26417.465 -18458.037  30.1%  4575 1742s
  6109  2303 -23534.543   16  253 -26417.465 -18458.037  30.1%  4614 1780s
  6126  2329 -18794.299   17  526 -26417.465 -18458.037  30.1%  4640 1809s
  6158  2371 -20454.908   18  392 -26417.465 -18458.037  30.1%  4640 1842s
  6237  2388 -20848.255   20  498 -26417.465 -18458.037  30.1%  4646 1861s
  6313  2395 -22951.173   21  478 -26417.465 -18458.037  30.1%  4642 1880s
  6381  2399 -23856.963   22  358 -26417.465 -18458.037  30.1%  4633 1895s
  6452  2392 -24749.989   23  321 -26417.465 -18458.037  30.1%  4622 1912s
  6491  2397 -25943.503   24  299 -26417.465 -18458.037  30.1%  4622 1928s
  6548  2403     cutoff   24      -26417.465 -18458.037  30.1%  4607 1945s
  6608  2412 -26170.651   26  259 -26417.465 -18458.037  30.1%  4597 1959s
  6679  2410 -22482.721   26  286 -26417.465 -18458.037  30.1%  4582 1988s
  6741  2396 -20601.049   20  348 -26417.465 -18458.037  30.1%  4569 2009s
  6814  2386 -20943.800   21  346 -26417.465 -18458.037  30.1%  4557 2022s
  6878  2381     cutoff   33      -26417.465 -18458.037  30.1%  4541 2038s
  6916  2384 -22919.469   22  289 -26417.465 -18458.037  30.1%  4539 2051s
  6965  2405 -24593.738   24  254 -26417.465 -18458.037  30.1%  4534 2063s
  7045  2404 -25359.998   26  316 -26417.465 -18458.037  30.1%  4513 2077s
  7124  2401 -25924.276   29  231 -26417.465 -18458.037  30.1%  4490 2094s
  7205  2406     cutoff   32      -26417.465 -18458.037  30.1%  4467 2115s
  7288  2402 -22395.381   18  382 -26417.465 -18458.037  30.1%  4452 2130s
  7355  2409     cutoff   20      -26417.465 -18458.037  30.1%  4446 2148s
  7435  2403 -24403.377   22  381 -26417.465 -18458.037  30.1%  4432 2160s
  7483  2426 -24491.087   23  381 -26417.465 -18458.037  30.1%  4424 2175s
  7551  2424 -25030.890   25  199 -26417.465 -18458.037  30.1%  4411 2196s
  7648  2430 -22681.812   20  552 -26417.465 -18458.037  30.1%  4391 2214s
  7745  2419 -23169.951   22  539 -26417.465 -18458.037  30.1%  4378 2232s
  7853  2423 -24501.189   26  180 -26417.465 -18458.037  30.1%  4358 2254s
  7972  2421 -24068.967   22  212 -26417.465 -18458.037  30.1%  4344 2282s
  8108  2403 -24606.167   26  320 -26417.465 -18458.037  30.1%  4322 2315s
  8239  2416 -24798.936   27  394 -26417.465 -18458.037  30.1%  4307 2337s
  8382  2398 -26308.382   31  189 -26417.465 -18815.961  28.8%  4289 2360s
  8538  2364 -22298.951   23  523 -26417.465 -18817.500  28.8%  4263 2382s
  8579  2373 -22445.813   24  486 -26417.465 -18817.500  28.8%  4264 2402s
  8624  2396 -22527.993   25  485 -26417.465 -19081.076  27.8%  4266 2423s
  8720  2402 -23067.689   27  391 -26417.465 -19081.076  27.8%  4249 2445s
  8857  2388 -25113.370   33  233 -26417.465 -19081.076  27.8%  4228 2476s
  8991  2358 -25697.320   40  361 -26417.465 -19190.257  27.4%  4214 2505s
  9095  2357 -21691.148   21  595 -26417.465 -19686.699  25.5%  4209 2533s
  9235  2353 -22841.786   23  475 -26417.465 -19686.699  25.5%  4195 2566s
  9424  2341 -24440.687   28  330 -26417.465 -19686.699  25.5%  4174 2597s
  9625  2320 -24949.841   30  287 -26417.465 -19686.699  25.5%  4155 2629s
  9860  2305     cutoff   22      -26417.465 -20327.280  23.1%  4122 2662s
 10070  2294 -25231.269   22  490 -26417.465 -20534.063  22.3%  4106 2694s
 10295  2293 -25869.905   24  439 -26417.465 -20641.746  21.9%  4087 2730s
 10568  2262 -23704.830   28  384 -26417.465 -20981.480  20.6%  4056 2781s
 10841  2193 -25460.883   26  308 -26417.465 -21152.551  19.9%  4028 2813s
 10958  2179 -26213.898   27  277 -26417.465 -21152.551  19.9%  4011 2861s
 11165  2144 -25952.106   25  386 -26417.465 -21487.889  18.7%  4004 2901s
 11461  2123 -25487.960   21  267 -26417.465 -21487.889  18.7%  3983 2943s
 11798  2056 infeasible   23      -26417.465 -21783.010  17.5%  3952 2981s
 12095  1984 -25448.589   27  436 -26417.465 -21897.666  17.1%  3927 3020s
 12302  1993 -25660.933   28  409 -26417.465 -22030.514  16.6%  3913 3061s
 12690  1937     cutoff   23      -26417.465 -22213.882  15.9%  3867 3109s
 13174  1933 -25940.841   27  233 -26417.465 -22380.471  15.3%  3809 3161s
 13663  1954     cutoff   23      -26417.465 -22572.132  14.6%  3766 3215s
 14171  1958     cutoff   27      -26417.465 -22709.022  14.0%  3721 3271s
 14653  1975     cutoff   23      -26417.465 -23020.519  12.9%  3689 3323s
 15209  1983     cutoff   26      -26417.465 -23218.663  12.1%  3650 3379s
 15812  1943 -25538.019   31  441 -26417.465 -23371.678  11.5%  3604 3434s
 16385  1814     cutoff   26      -26417.465 -23609.300  10.6%  3575 3494s
 16994  1613 -26032.065   25  224 -26417.465 -23920.526  9.45%  3546 3574s
 17763  1439     cutoff   25      -26417.465 -24168.268  8.51%  3490 3600s

Cutting planes:
  Learned: 2
  Gomory: 1
  MIR: 1340
  Flow cover: 2665
  Zero half: 4
  RLT: 34
  Relax-and-lift: 162

Explored 18263 nodes (62954389 simplex iterations) in 3600.09 seconds (10136.46 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26417.5 -26425.3 -26433.6 ... -26631

Time limit reached
Best objective -2.641746528299e+04, best bound -2.433985945196e+04, gap 7.8645%
  WARNING: Time limit reached. Using best solution found (gap: 7.86%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -26417.47, θ = 93832.69
  Upper Bound (UB) = -26417.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93832.69
  [DEBUG]   ✓ Scenario 0: θ = 93832.69 ≤ Q = 93832.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93832.69 ≤ Q = 93832.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93832.69 ≤ Q = 93832.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93832.69 ≤ Q = 93832.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93832.69 ≤ Q = 93832.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93832.69 ≤ Q = 93832.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93832.69 ≤ Q = 93832.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93832.69 ≤ Q = 93832.69 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5cd48c5d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa32b73a3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [7e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.077478e+13
Presolve removed 2618 rows and 1911 columns
Presolve time: 0.00s
Presolved: 475 rows, 478 columns, 1303 nonzeros
Found heuristic solution: objective 5225140.4434
Variable types: 322 continuous, 156 integer (156 binary)

Root relaxation: objective -1.115246e+05, 223 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111524.56    0  120 5225140.44 -111524.56   102%     -    0s
H    0     0                    -78503.77069 -111524.56  42.1%     -    0s
H    0     0                    -79184.17500 -111524.56  40.8%     -    0s
     0     0 -82791.728    0   92 -79184.175 -82791.728  4.56%     -    0s
H    0     0                    -79546.34315 -82729.833  4.00%     -    0s
H    0     0                    -79703.84743 -82729.833  3.80%     -    0s
     0     0 -82350.138    0   92 -79703.847 -82350.138  3.32%     -    0s
H    0     0                    -79945.04569 -82331.509  2.99%     -    0s
H    0     0                    -79950.27067 -82331.509  2.98%     -    0s
     0     0 -82328.060    0   92 -79950.271 -82328.060  2.97%     -    0s
     0     0 -82005.514    0   95 -79950.271 -82005.514  2.57%     -    0s
     0     0 -81984.133    0   95 -79950.271 -81984.133  2.54%     -    0s
     0     0 -81920.956    0   82 -79950.271 -81920.956  2.46%     -    0s
     0     0 -81903.346    0   91 -79950.271 -81903.346  2.44%     -    0s
     0     0 -81850.480    0   92 -79950.271 -81850.480  2.38%     -    0s
     0     0 -81849.865    0   92 -79950.271 -81849.865  2.38%     -    0s
     0     2 -81830.396    0   92 -79950.271 -81830.396  2.35%     -    0s
H   31    58                    -80918.01552 -81581.807  0.82%  13.1    0s
H   47    50                    -80979.69638 -81562.686  0.72%  13.7    0s
H   63    28                    -80984.92136 -81562.686  0.71%  15.2    0s
H  102    30                    -81490.38833 -81561.035  0.09%  11.0    0s
H  103    30                    -81510.98139 -81561.035  0.06%  10.9    0s
*  186     0              17    -81511.48440 -81511.484  0.00%   8.5    0s

Cutting planes:
  Gomory: 25
  MIR: 229

Explored 187 nodes (2082 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -81511.5 -80984.9 -80979.7 ... 5.22514e+06
No other solutions better than -81511.5

Optimal solution found (tolerance 1.00e-06)
Best objective -8.151148439765e+04, best bound -8.151148439765e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 91622.59
  Scenario: 11 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81511.48
  [DEBUG]   S×d_nominal = 173134.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173134.08 + -81511.48 = 91622.59
  [DEBUG]   Current θ from Master = 93832.69
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2210.10 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28627.57
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 2210.1019, Absolute Gap = 2210.1019, Relative Gap = 0.083661
  Not converged yet (gap = 2210.10 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 48 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394544 nonzeros
Model fingerprint: 0x82abdaf5
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 65588 rows and 26638 columns
Presolve time: 1.26s
Presolved: 73405 rows, 31782 columns, 457259 nonzeros
Variable types: 29523 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387235.2691
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73405 rows, 31782 columns, 457259 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33392   -4.8751802e+04   0.000000e+00   2.126356e+07      5s
   45214   -2.8063308e+04   0.000000e+00   7.212553e+06     10s
   51905   -2.4169202e+04   0.000000e+00   1.540907e+08     15s
   60827   -1.2857799e+04   0.000000e+00   2.920607e+06     20s
   68112   -1.1430682e+04   0.000000e+00   7.186271e+05     25s
   73594   -1.1252561e+04   0.000000e+00   3.213249e+06     30s
   79076   -1.1170788e+04   0.000000e+00   1.478344e+06     35s
   84727   -1.0256720e+04   0.000000e+00   3.052124e+06     40s
   89548   -1.0209989e+04   0.000000e+00   3.060463e+05     45s
   94211   -1.0096097e+04   0.000000e+00   1.298188e+07     50s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective -6.767839e+03, 87415 iterations, 50.19 seconds (105.80 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6767.8387    0  369 -217728.64 -6767.8387  96.9%     -   52s
H    0     0                    -210239.5332 -6767.8387  96.8%     -   52s
H    0     0                    -124089.2070 -6767.8387  94.5%     -   52s
H    0     0                    -122926.8912 -6767.8387  94.5%     -   52s
H    0     0                    -122875.1370 -6767.8387  94.5%     -   52s
H    0     0                    -96821.13784 -6767.8387  93.0%     -   52s
H    0     0                    -73209.25003 -6767.8387  90.8%     -   52s
H    0     0                    -72805.90594 -6767.8387  90.7%     -   52s
H    0     0                    -66851.65032 -6767.8387  89.9%     -   53s
H    0     0                    -66762.74365 -6767.8387  89.9%     -   53s
H    0     0                    -66364.75537 -6767.8387  89.8%     -   53s
H    0     0                    -63697.84028 -9561.4270  85.0%     -   65s
H    0     0                    -63575.93606 -9561.4270  85.0%     -   65s
H    0     0                    -62485.04874 -9561.4270  84.7%     -   65s
H    0     0                    -62460.61761 -9561.4270  84.7%     -   65s
     0     0 -9608.1644    0  524 -62460.618 -9608.1644  84.6%     -   66s
H    0     0                    -62283.89166 -9608.1644  84.6%     -   66s
     0     0 -9717.9142    0  526 -62283.892 -9717.9142  84.4%     -   69s
     0     0 -9717.9142    0  532 -62283.892 -9717.9142  84.4%     -   70s
     0     0 -9717.9142    0  533 -62283.892 -9717.9142  84.4%     -   71s
     0     0 -9895.8616    0  531 -62283.892 -9895.8616  84.1%     -   74s
     0     0 -9895.8616    0  531 -62283.892 -9895.8616  84.1%     -   74s
     0     0 -9895.8616    0  533 -62283.892 -9895.8616  84.1%     -   75s
     0     0 -11658.241    0  482 -62283.892 -11658.241  81.3%     -   93s
H    0     0                    -46499.50192 -11658.939  74.9%     -   93s
H    0     0                    -46414.59971 -11658.939  74.9%     -   93s
H    0     0                    -46316.49765 -11658.939  74.8%     -   93s
H    0     0                    -46284.62612 -11658.939  74.8%     -   93s
H    0     0                    -46224.57017 -11658.939  74.8%     -   93s
H    0     0                    -46197.12908 -11658.939  74.8%     -   93s
H    0     0                    -46159.47386 -11658.939  74.7%     -   93s
     0     0 -11797.916    0  488 -46159.474 -11797.916  74.4%     -  102s
     0     0 -11852.910    0  482 -46159.474 -11852.910  74.3%     -  104s
     0     0 -11855.102    0  481 -46159.474 -11855.102  74.3%     -  105s
     0     0 -11858.206    0  481 -46159.474 -11858.206  74.3%     -  105s
     0     0 -11893.823    0  557 -46159.474 -11893.823  74.2%     -  108s
     0     0 -11895.263    0  488 -46159.474 -11895.263  74.2%     -  108s
     0     0 -11895.579    0  488 -46159.474 -11895.579  74.2%     -  109s
H    0     0                    -45305.46031 -13571.864  70.0%     -  130s
H    0     0                    -44455.05566 -13571.864  69.5%     -  130s
H    0     0                    -44411.87107 -13571.864  69.4%     -  130s
H    0     0                    -44338.95449 -13571.864  69.4%     -  130s
     0     0 -13571.864    0  449 -44338.954 -13571.864  69.4%     -  130s
H    0     0                    -43467.22600 -13572.130  68.8%     -  130s
H    0     0                    -43427.80944 -13572.130  68.7%     -  130s
H    0     0                    -43127.09776 -13572.130  68.5%     -  130s
H    0     0                    -42498.62291 -13572.130  68.1%     -  130s
     0     0 -13956.864    0  531 -42498.623 -13956.864  67.2%     -  144s
     0     0 -14050.090    0  474 -42498.623 -14050.090  66.9%     -  152s
     0     0 -14115.517    0  528 -42498.623 -14115.517  66.8%     -  158s
     0     0 -14154.508    0  533 -42498.623 -14154.508  66.7%     -  161s
     0     0 -14223.962    0  546 -42498.623 -14223.962  66.5%     -  168s
     0     0 -14235.236    0  540 -42498.623 -14235.236  66.5%     -  170s
H    0     0                    -38893.19011 -14265.164  63.3%     -  174s
H    0     0                    -37924.45890 -14265.164  62.4%     -  174s
H    0     0                    -37901.92299 -14265.164  62.4%     -  174s
H    0     0                    -29360.86843 -14265.164  51.4%     -  174s
H    0     0                    -29309.01044 -14265.164  51.3%     -  174s
H    0     0                    -29295.97397 -14265.164  51.3%     -  174s
H    0     0                    -28894.88131 -14265.164  50.6%     -  174s
     0     0 -14265.164    0  550 -28894.881 -14265.164  50.6%     -  174s
     0     0 -14268.240    0  549 -28894.881 -14268.240  50.6%     -  176s
     0     0 -14269.207    0  548 -28894.881 -14269.207  50.6%     -  177s
     0     0 -14273.084    0  555 -28894.881 -14273.084  50.6%     -  179s
     0     0 -14273.714    0  554 -28894.881 -14273.714  50.6%     -  179s
H    0     0                    -28312.21207 -14273.714  49.6%     -  190s
     0     0 -15088.752    0  581 -28312.212 -15088.752  46.7%     -  217s
H    0     0                    -27802.28677 -15274.351  45.1%     -  235s
H    0     0                    -27600.59365 -15274.351  44.7%     -  235s
H    0     0                    -27595.30148 -15274.351  44.6%     -  235s
     0     0 -15274.351    0  627 -27595.301 -15274.351  44.6%     -  235s
     0     0 -15397.781    0  638 -27595.301 -15397.781  44.2%     -  246s
     0     0 -15417.127    0  646 -27595.301 -15417.127  44.1%     -  252s
H    0     0                    -27333.32269 -15445.757  43.5%     -  257s
H    0     0                    -27250.54237 -15445.757  43.3%     -  257s
H    0     0                    -27250.02662 -15445.757  43.3%     -  257s
H    0     0                    -27238.96272 -15445.757  43.3%     -  257s
H    0     0                    -27232.29811 -15445.757  43.3%     -  257s
H    0     0                    -27194.76165 -15445.757  43.2%     -  257s
H    0     0                    -27191.21324 -15445.757  43.2%     -  257s
H    0     0                    -27097.00548 -15445.757  43.0%     -  257s
H    0     0                    -27056.29200 -15445.757  42.9%     -  257s
     0     0 -15445.757    0  663 -27056.292 -15445.757  42.9%     -  257s
H    0     0                    -26976.66552 -15462.335  42.7%     -  261s
H    0     0                    -26888.57888 -15462.335  42.5%     -  261s
H    0     0                    -26779.11317 -15462.335  42.3%     -  261s
H    0     0                    -26720.55241 -15462.335  42.1%     -  261s
H    0     0                    -26700.33588 -15462.335  42.1%     -  261s
H    0     0                    -26690.51050 -15462.335  42.1%     -  261s
     0     0 -15462.335    0  657 -26690.511 -15462.335  42.1%     -  261s
     0     0 -15470.155    0  668 -26690.511 -15470.155  42.0%     -  262s
     0     0 -15470.843    0  664 -26690.511 -15470.843  42.0%     -  263s
H    0     0                    -26681.62620 -15590.861  41.6%     -  277s
H    0     0                    -26681.24539 -15590.861  41.6%     -  277s
H    0     0                    -26677.04631 -15590.861  41.6%     -  277s
H    0     0                    -26672.08998 -15590.861  41.5%     -  277s
     0     0 -15590.861    0  669 -26672.090 -15590.861  41.5%     -  277s
     0     0 -15629.709    0  672 -26672.090 -15629.709  41.4%     -  284s
     0     0 -15643.741    0  680 -26672.090 -15643.741  41.3%     -  287s
     0     0 -15648.044    0  692 -26672.090 -15648.044  41.3%     -  289s
     0     0 -15649.103    0  686 -26672.090 -15649.103  41.3%     -  290s
     0     0 -15760.381    0  720 -26672.090 -15760.381  40.9%     -  304s
H    0     0                    -26666.16664 -15760.538  40.9%     -  305s
H    0     0                    -26665.65089 -15760.538  40.9%     -  305s
     0     0 -15799.817    0  743 -26665.651 -15799.817  40.7%     -  313s
     0     0 -15813.180    0  749 -26665.651 -15813.180  40.7%     -  318s
     0     0 -15816.235    0  748 -26665.651 -15816.235  40.7%     -  320s
     0     0 -15817.719    0  802 -26665.651 -15817.719  40.7%     -  321s
     0     0 -15818.479    0  751 -26665.651 -15818.479  40.7%     -  322s
     0     0 -15873.858    0  738 -26665.651 -15873.858  40.5%     -  331s
     0     0 -15904.533    0  696 -26665.651 -15904.533  40.4%     -  338s
     0     0 -15909.477    0  696 -26665.651 -15909.477  40.3%     -  340s
     0     0 -15912.559    0  638 -26665.651 -15912.559  40.3%     -  341s
     0     0 -15913.003    0  635 -26665.651 -15913.003  40.3%     -  342s
     0     0 -15944.879    0  692 -26665.651 -15944.879  40.2%     -  350s
H    0     0                    -26661.58674 -15945.462  40.2%     -  350s
     0     0 -15963.424    0  701 -26661.587 -15963.424  40.1%     -  356s
     0     0 -15968.359    0  703 -26661.587 -15968.359  40.1%     -  360s
     0     0 -15970.224    0  638 -26661.587 -15970.224  40.1%     -  361s
     0     0 -15971.061    0  701 -26661.587 -15971.061  40.1%     -  362s
     0     0 -15996.041    0  697 -26661.587 -15996.041  40.0%     -  368s
     0     0 -16001.649    0  696 -26661.587 -16001.649  40.0%     -  372s
     0     0 -16003.802    0  704 -26661.587 -16003.802  40.0%     -  373s
     0     0 -16004.535    0  713 -26661.587 -16004.535  40.0%     -  374s
     0     0 -16010.838    0  712 -26661.587 -16010.838  39.9%     -  378s
     0     0 -16011.994    0  714 -26661.587 -16011.994  39.9%     -  381s
     0     0 -16017.661    0  716 -26661.587 -16017.661  39.9%     -  384s
     0     0 -16020.032    0  713 -26661.587 -16020.032  39.9%     -  385s
     0     0 -16020.840    0  715 -26661.587 -16020.840  39.9%     -  387s
     0     0 -16022.977    0  654 -26661.587 -16022.977  39.9%     -  389s
     0     0 -16023.763    0  661 -26661.587 -16023.763  39.9%     -  392s
     0     0 -16025.437    0  714 -26661.587 -16025.437  39.9%     -  394s
     0     0 -16026.255    0  714 -26661.587 -16026.255  39.9%     -  397s
     0     2 -16026.255    0  714 -26661.587 -16026.255  39.9%     -  457s
     1     4 -16038.955    1  641 -26661.587 -16026.255  39.9%  1601  463s
     3     8 -16081.950    2  671 -26661.587 -16039.063  39.8%  3500  474s
     7    16 -16252.303    3  677 -26661.587 -16084.636  39.7%  5175  487s
    15    32 -16288.412    4  668 -26661.587 -16252.373  39.0%  7188  516s
    31    51 -20294.224    5  241 -26661.587 -16288.450  38.9% 12956  549s
    50    83 -17152.931    6  507 -26661.587 -16288.450  38.9% 13722  567s
    82   196 -17164.653    7  500 -26661.587 -16288.450  38.9% 10189  583s
   195   305 -17296.747    9  577 -26661.587 -16288.450  38.9%  5600  594s
   310   388 -17315.808    9  499 -26661.587 -16288.450  38.9%  4244  602s
   410   411 -17632.254   10  577 -26661.587 -16288.450  38.9%  3636  611s
   442   438 -21017.667   16  133 -26661.587 -16288.450  38.9%  3506  620s
   480   459 -21681.701   17  137 -26661.587 -16288.450  38.9%  3452  629s
   513   484 -17794.684   10  468 -26661.587 -16288.450  38.9%  3438  639s
   546   499 -18501.152    8  452 -26661.587 -16288.450  38.9%  3422  649s
   589   524 -18163.529   11  485 -26661.587 -16288.450  38.9%  3352  658s
   622   549 -23158.557   13  133 -26661.587 -16288.450  38.9%  3329  666s
   659   575 -18318.615   12  458 -26661.587 -16288.450  38.9%  3267  675s
   697   608 -19564.841   11  327 -26661.587 -16288.450  38.9%  3211  683s
   743   637 -18484.599   13  479 -26661.587 -16288.450  38.9%  3132  692s
   786   674 -18980.731   14  385 -26661.587 -16288.450  38.9%  3062  701s
   833   687 -19429.426   15  412 -26661.587 -16288.450  38.9%  2961  710s
   895   695 -20450.789   16  342 -26661.587 -16288.450  38.9%  2851  720s
   952   680 -25428.724   17   72 -26661.587 -16288.450  38.9%  2773  731s
  1009   684     cutoff   17      -26661.587 -16288.450  38.9%  2749  742s
  1065   687 -23049.240   17  182 -26661.587 -16288.450  38.9%  2733  754s
  1122   708 -20931.247   17  418 -26661.587 -16288.450  38.9%  2729  767s
  1167   712 -21197.466   18  404 -26661.587 -16288.450  38.9%  2748  778s
  1227   727 -20978.963   18  424 -26661.587 -16288.450  38.9%  2702  792s
  1269   751 -22368.460   19  487 -26661.587 -16288.450  38.9%  2751  806s
  1332   774 -22492.502   19  405 -26661.587 -16288.450  38.9%  2755  820s
  1427   792 -24305.455   18  255 -26661.587 -16288.450  38.9%  2701  834s
  1493   809 -22935.423   20  544 -26661.587 -16288.450  38.9%  2699  849s
  1526   832 -23367.895   20  524 -26661.587 -16288.450  38.9%  2745  863s
  1583   877 -24640.279   20  296 -26661.587 -16288.450  38.9%  2752  878s
  1684   897 -22960.491   21  540 -26661.587 -16360.139  38.6%  2713  893s
  1785   930 -23062.761   22  458 -26661.587 -16360.858  38.6%  2673  910s
  1891   954 -23279.584   23  518 -26661.587 -16360.858  38.6%  2677  927s
  1959   987 -23700.264   24  403 -26661.587 -16360.858  38.6%  2707  945s
  2026  1004 -23662.785   24  458 -26661.587 -16360.858  38.6%  2747  964s
  2099  1025 -26188.060   25  367 -26661.587 -16360.858  38.6%  2774  982s
  2176  1058 -23613.748   23  236 -26661.587 -16360.858  38.6%  2806 1003s
  2247  1086 -26135.586   24  206 -26661.587 -16360.858  38.6%  2837 1023s
  2379  1096 -24568.220   24  315 -26661.587 -16360.858  38.6%  2830 1042s
  2520  1147 -24561.778   25  356 -26661.587 -16564.614  37.9%  2810 1064s
  2631  1209     cutoff   29      -26661.587 -16564.614  37.9%  2840 1086s
  2781  1303 -21403.851   10  444 -26661.587 -16564.614  37.9%  2844 1108s
  2933  1359 -22964.110   12  263 -26661.587 -16564.614  37.9%  2851 1134s
  3093  1426 -25202.168   14  146 -26661.587 -16564.614  37.9%  2849 1158s
  3254  1480 -26353.933   17  315 -26661.587 -16564.614  37.9%  2850 1183s
  3406  1528     cutoff   16      -26661.587 -18209.737  31.7%  2885 1213s
  3569  1557 -23952.290   11  604 -26661.587 -18209.737  31.7%  2903 1241s
  3702  1612 -25336.533   13  437 -26661.587 -18209.737  31.7%  2943 1271s
  3855  1658 -26511.425   17  361 -26661.587 -18587.066  30.3%  2970 1301s
  4017  1714 -25282.638   21  240 -26661.587 -18587.066  30.3%  3007 1331s
  4187  1761 -19932.661   15  334 -26661.587 -18742.590  29.7%  3051 1361s
  4325  1803     cutoff   17      -26661.587 -18767.397  29.6%  3064 1394s
  4533  1847 -23655.108   18  325 -26661.587 -18937.736  29.0%  3071 1429s
  4731  1895 -20520.837   15  328 -26661.587 -19025.973  28.6%  3102 1466s
  4935  1948 infeasible   20      -26661.587 -19030.108  28.6%  3126 1505s
  5162  1992 -26589.254   27   85 -26661.587 -19194.317  28.0%  3149 1545s
  5422  2028 -22848.181   10  125 -26661.587 -19194.317  28.0%  3160 1583s
  5628  2103 -22763.695   13  391 -26661.587 -19194.317  28.0%  3165 1631s
  5852  2113 -24579.219   15  270 -26661.587 -19467.243  27.0%  3204 1664s
  5906  2132 -25309.227   15  198 -26661.587 -19467.243  27.0%  3217 1694s
  5961  2148     cutoff   15      -26661.587 -19467.243  27.0%  3227 1729s
  6117  2194 -25948.959   16  313 -26661.587 -19467.243  27.0%  3232 1771s
  6405  2298 infeasible   18      -26661.587 -19527.821  26.8%  3241 1816s
  6877  2358     cutoff   13      -26661.587 -19527.821  26.8%  3188 1859s
  7195  2396 -22926.627   15  464 -26661.587 -19853.672  25.5%  3182 1909s
  7524  2448 -25312.661   17  494 -26661.587 -19912.745  25.3%  3201 1961s
  7868  2496 infeasible   15      -26661.587 -20142.393  24.5%  3222 2017s
  8261  2532     cutoff   14      -26661.587 -20274.387  24.0%  3232 2068s
  8585  2556     cutoff   13      -26661.587 -20383.175  23.5%  3242 2127s
  8982  2594 -26446.316   12  323 -26661.587 -20428.474  23.4%  3259 2188s
  9406  2653     cutoff   15      -26661.587 -20472.227  23.2%  3269 2248s
 10030  2710     cutoff   11      -26661.587 -20638.743  22.6%  3241 2312s
 10583  2738 -25680.899   15  545 -26661.587 -20703.178  22.3%  3235 2377s
 11084  2762 -24132.961   12  412 -26661.587 -20859.418  21.8%  3253 2446s
 11624  2825 -25485.864   12  378 -26661.587 -20897.282  21.6%  3266 2518s
 12313  2837 -23497.196   17  267 -26661.587 -20937.306  21.5%  3252 2593s
 13000  2865 -26613.188   16  134 -26661.587 -21226.388  20.4%  3235 2671s
 13669  2863 -26549.404   22   62 -26661.587 -21331.385  20.0%  3225 2751s
 14324  2858     cutoff   17      -26661.587 -21549.201  19.2%  3230 2816s
 14437  2879     cutoff   17      -26661.587 -21549.201  19.2%  3245 2893s
H14878  2850                    -26565.94786 -21629.491  18.6%  3245 2893s
 14983  2856     cutoff   40      -26565.948 -21771.154  18.0%  3245 2981s
H15036  2854                    -26560.65569 -21771.154  18.0%  3244 2981s
H15152  2851                    -26538.28564 -21772.463  18.0%  3250 2981s
H15299  2850                    -26532.99346 -21772.463  17.9%  3246 2981s
 15685  2819     cutoff   11      -26532.993 -21868.526  17.6%  3239 3067s
 16468  2795 -24025.657   14  264 -26532.993 -22020.795  17.0%  3237 3161s
 17377  2724 -26160.933   23  261 -26532.993 -22258.641  16.1%  3212 3263s
 18206  2639     cutoff   18      -26532.993 -22515.858  15.1%  3214 3364s
H18209  2636                    -26520.98857 -22515.858  15.1%  3214 3364s
H18284  2622                    -26490.13986 -22515.858  15.0%  3216 3364s
 18786  2493 -24340.884   14  471 -26490.140 -22612.430  14.6%  3217 3471s
 19768  2318 infeasible   28      -26490.140 -23072.192  12.9%  3206 3574s
 20628  2260     cutoff   17      -26490.140 -23427.668  11.6%  3203 3600s

Cutting planes:
  Gomory: 2
  Cover: 2
  Implied bound: 8
  MIR: 1311
  Flow cover: 2610
  Zero half: 13
  RLT: 49
  Relax-and-lift: 141

Explored 20936 nodes (67048759 simplex iterations) in 3600.04 seconds (10622.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26490.1 -26521 -26533 ... -26672.1

Time limit reached
Best objective -2.649013986268e+04, best bound -2.343467353044e+04, gap 11.5344%
  WARNING: Time limit reached. Using best solution found (gap: 11.53%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -26490.14, θ = 93908.62
  Upper Bound (UB) = -26490.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93908.62
  [DEBUG]   ✓ Scenario 0: θ = 93908.62 ≤ Q = 93908.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93908.62 ≤ Q = 93908.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93908.62 ≤ Q = 93908.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93908.62 ≤ Q = 93908.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93908.62 ≤ Q = 93908.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93908.62 ≤ Q = 93908.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93908.62 ≤ Q = 93908.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93908.62 ≤ Q = 93908.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93908.62 ≤ Q = 93908.62 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5ae21ca1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5ae21ca1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.070585e+13
Presolve removed 2624 rows and 1916 columns
Presolve time: 0.00s
Presolved: 469 rows, 473 columns, 1287 nonzeros
Found heuristic solution: objective 5140742.5568
Variable types: 318 continuous, 155 integer (155 binary)
Found heuristic solution: objective 5140327.4717

Root relaxation: objective -1.121439e+05, 220 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112143.92    0  118 5140327.47 -112143.92   102%     -    0s
H    0     0                    -62670.53213 -112143.92  78.9%     -    0s
H    0     0                    -66503.09292 -112143.92  68.6%     -    0s
H    0     0                    -66906.15903 -112023.95  67.4%     -    0s
     0     0 -84273.619    0   30 -66906.159 -84273.619  26.0%     -    0s
H    0     0                    -82948.86707 -84208.208  1.52%     -    0s
H    0     0                    -83400.66172 -84208.208  0.97%     -    0s
     0     0 -83742.935    0   20 -83400.662 -83742.935  0.41%     -    0s
     0     0 -83734.494    0   17 -83400.662 -83734.494  0.40%     -    0s
     0     0 -83648.880    0   15 -83400.662 -83648.880  0.30%     -    0s
     0     0 -83602.241    0    6 -83400.662 -83602.241  0.24%     -    0s
H    0     0                    -83454.88865 -83602.241  0.18%     -    0s
     0     0 -83546.534    0    3 -83454.889 -83546.534  0.11%     -    0s
*    0     0               0    -83545.00063 -83545.001  0.00%     -    0s

Cutting planes:
  Gomory: 7
  MIR: 133
  RLT: 4

Explored 1 nodes (428 simplex iterations) in 0.03 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -83545 -83454.9 -83400.7 ... 1.07059e+13
No other solutions better than -83545

Optimal solution found (tolerance 1.00e-06)
Best objective -8.354500062575e+04, best bound -8.354500062575e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 89881.16
  Scenario: 11 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83545.00
  [DEBUG]   S×d_nominal = 173426.16
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173426.16 + -83545.00 = 89881.16
  [DEBUG]   Current θ from Master = 93908.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4027.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30517.59
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 2137.4273, Absolute Gap = 2137.4273, Relative Gap = 0.080688
  Not converged yet (gap = 2137.43 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 48 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437769 nonzeros
Model fingerprint: 0x206cca0f
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 72880 rows and 29600 columns
Presolve time: 1.21s
Presolved: 81403 rows, 35060 columns, 500179 nonzeros
Variable types: 32801 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387251.2280
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.385e+06
 Factor NZ  : 7.248e+06 (roughly 100 MB of memory)
 Factor Ops : 1.201e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.98225330e+07  1.37909889e+08  3.42e+05 1.92e+01  1.18e+05     2s
   1  -3.40682922e+07  1.65446802e+08  2.84e+05 5.57e+01  9.99e+04     2s
   2  -8.83568267e+06  9.37216511e+07  7.32e+04 5.03e+00  2.72e+04     2s
   3  -6.73212144e+06  9.36747030e+07  5.53e+04 4.79e+00  2.07e+04     2s
   4  -7.82680449e+05  5.98067334e+07  2.46e+03 1.64e+00  1.31e+03     2s
   5  -5.02019743e+05  2.50606629e+07  4.83e+02 4.90e-01  3.25e+02     2s
   6  -3.71774672e+05  1.35187839e+07  1.82e+02 2.29e-01  1.44e+02     2s
   7  -2.12988464e+05  1.02925474e+07  6.15e+01 1.65e-01  8.58e+01     3s
   8  -1.60608651e+05  8.16397976e+06  2.89e+01 1.29e-01  6.21e+01     3s
   9  -1.30268686e+05  5.54137648e+06  1.69e+01 8.47e-02  4.08e+01     3s
  10  -1.08299330e+05  2.54134681e+06  9.38e+00 3.65e-02  1.86e+01     3s
  11  -8.20468095e+04  9.06716820e+05  3.76e+00 1.25e-02  6.77e+00     3s
  12  -5.54936714e+04  4.00473416e+05  1.39e+00 5.79e-03  3.08e+00     3s
  13  -4.73461358e+04  1.90189459e+05  9.38e-01 2.93e-03  1.60e+00     3s
  14  -4.24785781e+04  1.14669879e+05  7.72e-01 2.05e-03  1.06e+00     3s
  15  -3.58457968e+04  8.09683058e+04  5.92e-01 1.47e-03  7.87e-01     3s
  16  -2.85420507e+04  4.60508806e+04  4.44e-01 1.44e-03  5.03e-01     3s
  17  -2.55917294e+04  3.60341385e+04  3.86e-01 1.70e-03  4.15e-01     3s
  18  -2.09955433e+04  2.52948607e+04  2.89e-01 2.14e-03  3.12e-01     3s
  19  -1.75203315e+04  1.40670127e+04  2.20e-01 2.00e-03  2.13e-01     3s
  20  -1.43296061e+04  8.68341823e+03  1.59e-01 1.99e-03  1.55e-01     3s
  21  -1.24228435e+04  7.20641432e+03  1.27e-01 1.60e-03  1.32e-01     3s
  22  -1.16610430e+04  3.36665225e+03  1.14e-01 1.51e-03  1.01e-01     3s
  23  -1.09294166e+04  2.22757000e+03  1.02e-01 1.40e-03  8.87e-02     3s
  24  -9.22128356e+03  7.79650827e+02  7.57e-02 1.22e-03  6.74e-02     3s
  25  -8.42755216e+03 -7.34102321e+02  6.32e-02 1.13e-03  5.19e-02     3s
  26  -7.84667198e+03 -1.53739406e+03  5.47e-02 1.40e-03  4.26e-02     3s
  27  -6.64282694e+03 -1.87219280e+03  3.75e-02 1.44e-03  3.22e-02     3s
  28  -6.07023934e+03 -2.51656813e+03  2.92e-02 9.65e-04  2.40e-02     3s
  29  -5.36892396e+03 -2.96384389e+03  1.95e-02 6.03e-04  1.62e-02     3s
  30  -5.33986578e+03 -3.26067265e+03  1.89e-02 4.16e-04  1.40e-02     3s
  31  -4.92949925e+03 -3.42721490e+03  1.33e-02 3.12e-04  1.01e-02     3s
  32  -4.74043739e+03 -3.57758377e+03  1.08e-02 2.30e-04  7.86e-03     3s
  33  -4.49063515e+03 -3.72521447e+03  7.54e-03 1.23e-04  5.17e-03     3s
  34  -4.44666740e+03 -3.78070084e+03  6.96e-03 8.55e-05  4.51e-03     3s
  35  -4.22748394e+03 -3.80898125e+03  4.04e-03 6.79e-05  2.83e-03     3s
  36  -4.18102139e+03 -3.84759609e+03  3.45e-03 9.20e-05  2.26e-03     4s
  37  -4.13854999e+03 -3.86584682e+03  2.88e-03 6.48e-05  1.85e-03     4s
  38  -3.99916342e+03 -3.89093075e+03  1.10e-03 2.47e-05  7.32e-04     4s
  39  -3.97460303e+03 -3.90401346e+03  7.94e-04 7.97e-06  4.78e-04     4s
  40  -3.92265283e+03 -3.90715961e+03  1.50e-04 1.92e-05  1.05e-04     4s
  41  -3.91088329e+03 -3.90850690e+03  2.18e-05 3.48e-06  1.61e-05     4s
  42  -3.90904964e+03 -3.90875325e+03  2.42e-06 6.20e-07  2.00e-06     4s
  43  -3.90877987e+03 -3.90877354e+03  3.91e-08 6.69e-08  4.27e-08     4s
  44  -3.90877868e+03 -3.90877507e+03  2.38e-07 2.90e-08  2.43e-08     4s
  45  -3.90877628e+03 -3.90877626e+03  7.98e-09 1.56e-08  7.51e-11     4s

Barrier solved model in 45 iterations and 3.85 seconds (6.66 work units)
Optimal objective -3.90877628e+03

Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -3.908776e+03, 36171 iterations, 3.19 seconds (6.01 work units)
Total elapsed time = 5.04s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -3908.7763    0  450 -217728.64 -3908.7763  98.2%     -    5s
H    0     0                    -212023.8212 -3908.7763  98.2%     -    5s
H    0     0                    -63144.30229 -3908.7763  93.8%     -    5s
H    0     0                    -62765.20847 -3908.7763  93.8%     -    5s
H    0     0                    -59725.64936 -3908.7763  93.5%     -    6s
H    0     0                    -34350.35523 -3908.7763  88.6%     -    6s
H    0     0                    -34247.12979 -3908.7763  88.6%     -    6s
H    0     0                    -34111.24526 -3908.7763  88.5%     -    6s
H    0     0                    -30292.89014 -3908.7763  87.1%     -    7s
H    0     0                    -30069.79531 -3908.7763  87.0%     -    7s
     0     0 -8180.6381    0  488 -30069.795 -8180.6381  72.8%     -   28s
H    0     0                    -29716.68551 -8180.6381  72.5%     -   28s
     0     0 -8296.2967    0  476 -29716.686 -8296.2967  72.1%     -   35s
     0     0 -8302.7908    0  484 -29716.686 -8302.7908  72.1%     -   36s
     0     0 -8473.2912    0  472 -29716.686 -8473.2912  71.5%     -   40s
     0     0 -8473.3023    0  476 -29716.686 -8473.3023  71.5%     -   43s
     0     0 -8473.3023    0  480 -29716.686 -8473.3023  71.5%     -   46s
H    0     0                    -29615.91274 -8473.3023  71.4%     -   48s
     0     0 -8473.3023    0  472 -29615.913 -8473.3023  71.4%     -   48s
     0     0 -8473.3023    0  473 -29615.913 -8473.3023  71.4%     -   49s
     0     0 -8473.3023    0  473 -29615.913 -8473.3023  71.4%     -   50s
     0     0 -8473.3194    0  470 -29615.913 -8473.3194  71.4%     -   50s
     0     0 -8473.3227    0  472 -29615.913 -8473.3227  71.4%     -   51s
     0     0 -10558.726    0  616 -29615.913 -10558.726  64.3%     -   76s
H    0     0                    -29610.32064 -10558.878  64.3%     -   76s
H    0     0                    -29605.02847 -10558.878  64.3%     -   76s
H    0     0                    -29603.96899 -10558.878  64.3%     -   76s
H    0     0                    -29598.67681 -10558.878  64.3%     -   76s
H    0     0                    -29598.09439 -10558.878  64.3%     -   76s
H    0     0                    -29595.32188 -10558.878  64.3%     -   76s
H    0     0                    -29594.65779 -10558.878  64.3%     -   76s
H    0     0                    -29586.91763 -10558.878  64.3%     -   76s
H    0     0                    -29583.21685 -10558.878  64.3%     -   76s
H    0     0                    -29567.43101 -11023.471  62.7%     -   94s
H    0     0                    -29538.99718 -11023.471  62.7%     -   94s
H    0     0                    -29348.18492 -11023.471  62.4%     -   94s
     0     0 -11023.471    0  635 -29348.185 -11023.471  62.4%     -   94s
     0     0 -11071.548    0  652 -29348.185 -11071.548  62.3%     -   99s
     0     0 -11084.564    0  637 -29348.185 -11084.564  62.2%     -  101s
H    0     0                    -29345.57686 -11112.232  62.1%     -  105s
H    0     0                    -29341.29654 -11112.232  62.1%     -  105s
     0     0 -11112.232    0  636 -29341.297 -11112.232  62.1%     -  105s
H    0     0                    -29291.48423 -11114.173  62.1%     -  106s
     0     0 -11114.173    0  635 -29291.484 -11114.173  62.1%     -  106s
     0     0 -11114.947    0  636 -29291.484 -11114.947  62.1%     -  107s
     0     0 -12697.818    0  573 -29291.484 -12697.818  56.7%     -  141s
H    0     0                    -29274.77204 -13034.919  55.5%     -  158s
H    0     0                    -29261.53833 -13034.919  55.5%     -  158s
H    0     0                    -29256.29354 -13034.919  55.4%     -  158s
H    0     0                    -29256.02531 -13034.919  55.4%     -  158s
H    0     0                    -29252.28347 -13034.919  55.4%     -  158s
     0     0 -13034.919    0  578 -29252.283 -13034.919  55.4%     -  158s
     0     0 -13062.205    0  573 -29252.283 -13062.205  55.3%     -  163s
     0     0 -13063.627    0  578 -29252.283 -13063.627  55.3%     -  164s
     0     0 -13070.499    0  582 -29252.283 -13070.499  55.3%     -  166s
     0     0 -13115.379    0  598 -29252.283 -13115.379  55.2%     -  171s
     0     0 -13126.308    0  604 -29252.283 -13126.308  55.1%     -  174s
     0     0 -13128.885    0  605 -29252.283 -13128.885  55.1%     -  176s
     0     0 -13129.668    0  602 -29252.283 -13129.668  55.1%     -  177s
H    0     0                    -28719.40026 -13931.595  51.5%     -  218s
H    0     0                    -27127.73069 -13931.595  48.6%     -  218s
H    0     0                    -27120.40458 -13931.595  48.6%     -  218s
     0     0 -13931.595    0  645 -27120.405 -13931.595  48.6%     -  218s
H    0     0                    -27085.16047 -13932.130  48.6%     -  219s
H    0     0                    -27055.86870 -13932.130  48.5%     -  219s
     0     0 -14348.811    0  584 -27055.869 -14348.811  47.0%     -  244s
     0     0 -14463.546    0  635 -27055.869 -14463.546  46.5%     -  255s
     0     0 -14497.483    0  585 -27055.869 -14497.483  46.4%     -  262s
     0     0 -14509.390    0  607 -27055.869 -14509.390  46.4%     -  266s
     0     0 -14515.426    0  610 -27055.869 -14515.426  46.4%     -  269s
     0     0 -14554.073    0  642 -27055.869 -14554.073  46.2%     -  277s
H    0     0                    -27045.26180 -14633.073  45.9%     -  286s
H    0     0                    -27042.50786 -14633.073  45.9%     -  286s
     0     0 -14633.073    0  582 -27042.508 -14633.073  45.9%     -  286s
     0     0 -14644.734    0  662 -27042.508 -14644.734  45.8%     -  290s
     0     0 -14645.380    0  662 -27042.508 -14645.380  45.8%     -  291s
H    0     0                    -27036.50619 -15085.896  44.2%     -  314s
H    0     0                    -26853.43737 -15085.896  43.8%     -  314s
H    0     0                    -26781.58480 -15085.896  43.7%     -  314s
H    0     0                    -26769.57991 -15085.896  43.6%     -  314s
H    0     0                    -26769.06417 -15085.896  43.6%     -  314s
     0     0 -15085.896    0  649 -26769.064 -15085.896  43.6%     -  314s
     0     0 -15128.489    0  664 -26769.064 -15128.489  43.5%     -  322s
     0     0 -15157.463    0  661 -26769.064 -15157.463  43.4%     -  328s
     0     0 -15173.593    0  674 -26769.064 -15173.593  43.3%     -  334s
     0     0 -15181.736    0  663 -26769.064 -15181.736  43.3%     -  338s
     0     0 -15183.344    0  667 -26769.064 -15183.344  43.3%     -  339s
H    0     0                    -26767.47881 -15316.834  42.8%     -  352s
     0     0 -15316.834    0  603 -26767.479 -15316.834  42.8%     -  352s
     0     0 -15337.320    0  627 -26767.479 -15337.320  42.7%     -  360s
     0     0 -15344.991    0  611 -26767.479 -15344.991  42.7%     -  364s
     0     0 -15350.045    0  611 -26767.479 -15350.045  42.7%     -  367s
     0     0 -15351.828    0  614 -26767.479 -15351.828  42.6%     -  369s
     0     0 -15419.618    0  719 -26767.479 -15419.618  42.4%     -  386s
     0     0 -15428.015    0  673 -26767.479 -15428.015  42.4%     -  390s
     0     0 -15432.298    0  677 -26767.479 -15432.298  42.3%     -  395s
     0     0 -15441.925    0  674 -26767.479 -15441.925  42.3%     -  402s
     0     0 -15446.800    0  668 -26767.479 -15446.800  42.3%     -  405s
     0     0 -15450.841    0  667 -26767.479 -15450.841  42.3%     -  408s
     0     0 -15451.324    0  733 -26767.479 -15451.324  42.3%     -  409s
     0     0 -15481.850    0  617 -26767.479 -15481.850  42.2%     -  420s
     0     0 -15493.010    0  622 -26767.479 -15493.010  42.1%     -  426s
     0     0 -15495.226    0  621 -26767.479 -15495.226  42.1%     -  428s
     0     0 -15496.135    0  625 -26767.479 -15496.135  42.1%     -  429s
     0     0 -15520.196    0  636 -26767.479 -15520.196  42.0%     -  438s
     0     0 -15527.518    0  634 -26767.479 -15527.518  42.0%     -  443s
     0     0 -15528.152    0  629 -26767.479 -15528.152  42.0%     -  445s
     0     0 -15540.932    0  696 -26767.479 -15540.932  41.9%     -  451s
     0     0 -15543.157    0  650 -26767.479 -15543.157  41.9%     -  457s
     0     0 -15544.434    0  701 -26767.479 -15544.434  41.9%     -  459s
     0     0 -15552.629    0  645 -26767.479 -15552.629  41.9%     -  464s
     0     0 -15555.094    0  645 -26767.479 -15555.094  41.9%     -  467s
     0     0 -15556.097    0  651 -26767.479 -15556.097  41.9%     -  469s
     0     0 -15567.718    0  708 -26767.479 -15567.718  41.8%     -  476s
     0     0 -15567.731    0  708 -26767.479 -15567.731  41.8%     -  480s
H    0     0                    -26732.55263 -15567.731  41.8%     -  578s
H    0     0                    -26715.12964 -15567.731  41.7%     -  578s
H    0     0                    -26706.73708 -15567.731  41.7%     -  578s
H    0     0                    -26701.96066 -15567.731  41.7%     -  578s
H    0     0                    -26701.44491 -15567.731  41.7%     -  578s
H    0     0                    -26680.12410 -15567.731  41.7%     -  578s
H    0     0                    -26671.81942 -15567.731  41.6%     -  589s
H    0     0                    -26662.10248 -15567.731  41.6%     -  591s
H    0     0                    -26661.58674 -15567.731  41.6%     -  591s
     0     2 -15567.731    0  708 -26661.587 -15567.731  41.6%     -  605s
     1     4 -15577.260    1  636 -26661.587 -15567.786  41.6%  4366  625s
     3     8 -15623.522    2  741 -26661.587 -15577.521  41.6%  9155  647s
     7    16 -15682.815    3  734 -26661.587 -15623.591  41.4% 11213  671s
    15    32 -15738.140    4  689 -26661.587 -15682.894  41.2% 11811  721s
    31    48 -16185.060    5  617 -26661.587 -15738.210  41.0% 17479  790s
    47    80 -16728.461    6  606 -26661.587 -15738.210  41.0% 15932  822s
    79   148 -16770.209    7  588 -26661.587 -15738.210  41.0% 13299  879s
   147   190 -16819.238    9  583 -26661.587 -15738.210  41.0%  8316  918s
   189   222 -17201.431    9  559 -26661.587 -15738.210  41.0%  6966  966s
   221   256 -17086.746    8  414 -26661.587 -15738.210  41.0%  6235  987s
   255   307 -17107.919   10  497 -26661.587 -15738.210  41.0%  5768 1008s
   306   371 -17032.956   10  556 -26661.587 -15738.210  41.0%  5244 1032s
   370   435 -17096.710    9  397 -26661.587 -15738.210  41.0%  4927 1061s
   457   462 -17141.016   11  497 -26661.587 -15738.210  41.0%  4662 1094s
   537   484 -17432.490   10  531 -26661.587 -15738.210  41.0%  4513 1123s
   601   508 -17546.419   10  591 -26661.587 -15738.210  41.0%  4594 1144s
   661   551 -18387.779   11  356 -26661.587 -15738.210  41.0%  4553 1172s
   731   583 -17940.046   11  384 -26661.587 -15738.210  41.0%  4414 1190s
   804   621 -17585.134   12  493 -26661.587 -15738.210  41.0%  4255 1207s
   879   659 -18649.060   12  542 -26661.587 -15738.210  41.0%  4156 1224s
   951   676 -19029.473   13  454 -26661.587 -15738.210  41.0%  4059 1241s
  1020   696 -19209.596   14  443 -26661.587 -15738.210  41.0%  3993 1261s
  1097   740 -19714.651   15  436 -26661.587 -15738.210  41.0%  3969 1278s
  1175   774 -19806.451   16  256 -26661.587 -15738.210  41.0%  3940 1299s
  1261   793 -19996.213   17  399 -26661.587 -15738.210  41.0%  3915 1320s
  1338   813 -20259.597   18  217 -26661.587 -15738.210  41.0%  3928 1344s
  1398   844 -21634.185   19  388 -26661.587 -15738.210  41.0%  3955 1365s
  1454   893 -21071.491   17  238 -26661.587 -15738.210  41.0%  3999 1387s
  1533   937 -21895.583   18  204 -26661.587 -15738.210  41.0%  4027 1410s
  1630   962 -21599.021   18  320 -26661.587 -15738.210  41.0%  4030 1435s
  1750  1001 -21986.252   19  210 -26661.587 -15738.210  41.0%  3951 1461s
  1852  1040 -22752.890   20  292 -26661.587 -15738.210  41.0%  3927 1505s
  1955  1087 -23048.070   21  277 -26661.587 -15738.210  41.0%  3897 1534s
  2052  1164 -23285.448   22  265 -26661.587 -15738.210  41.0%  3917 1562s
  2173  1206 -24532.805   22  217 -26661.587 -15738.210  41.0%  3916 1593s
  2324  1276 -23387.373   23  214 -26661.587 -15854.535  40.5%  3857 1629s
  2460  1356 -25327.090   21  342 -26661.587 -15854.829  40.5%  3840 1662s
  2643  1428 -26049.823   23   95 -26661.587 -15854.829  40.5%  3762 1696s
  2811  1464 infeasible   24      -26661.587 -15854.829  40.5%  3733 1733s
  2925  1510 infeasible   24      -26661.587 -15854.829  40.5%  3779 1772s
  3043  1562 -19508.795    8  584 -26661.587 -15854.829  40.5%  3832 1810s
  3213  1637 -21043.778    8  512 -26661.587 -15854.829  40.5%  3813 1871s
  3360  1727 -19718.107    9  592 -26661.587 -15854.829  40.5%  3836 1915s
  3569  1828 -20861.514    9  535 -26661.587 -15854.829  40.5%  3818 1958s
  3821  1843 -22347.008   10  503 -26661.587 -15854.829  40.5%  3753 1991s
  3869  1879 -22145.539   10  537 -26661.587 -17537.171  34.2%  3785 2033s
  3981  1910 -22413.382   11  512 -26661.587 -17537.171  34.2%  3772 2079s
  4124  1985 -24143.926   13  548 -26661.587 -17548.941  34.2%  3822 2126s
  4342  2041 -25175.773   16  509 -26661.587 -17548.941  34.2%  3839 2175s
  4565  2091 infeasible   19      -26661.587 -17548.941  34.2%  3851 2229s
  4789  2179 -23194.084   11  239 -26661.587 -17548.941  34.2%  3881 2281s
  4994  2220 -21138.778   12  221 -26661.587 -17945.935  32.7%  3925 2373s
  5231  2336 -25467.164   16  168 -26661.587 -17946.382  32.7%  3960 2429s
  5502  2337 -20395.085   17  708 -26661.587 -17946.382  32.7%  3973 2730s
  5504  2338 -21938.559   14  423 -26661.587 -17946.382  32.7%  3972 2739s
  5505  2339 -22681.835    9  673 -26661.587 -17946.382  32.7%  3971 2803s
  5506  2340 -19129.237    9  605 -26661.587 -17946.382  32.7%  3970 2851s
  5507  2340 -21439.843   12  655 -26661.587 -17946.382  32.7%  3970 2883s
  5508  2341 -25853.274   15  652 -26661.587 -17946.382  32.7%  3969 2906s
  5509  2342 -24488.939   20  655 -26661.587 -17946.382  32.7%  3968 2925s
  5510  2342 -20378.323   10  672 -26661.587 -17946.382  32.7%  3968 2937s
  5511  2343 -21341.959   11  667 -26661.587 -17946.382  32.7%  3967 2946s
  5512  2344 -20072.260   18  623 -26661.587 -17946.382  32.7%  3966 2955s
  5513  2344 -23903.812   17  639 -26661.587 -17946.382  32.7%  3965 2962s
  5514  2345 -25821.797   36  791 -26661.587 -17946.382  32.7%  3965 2994s
  5515  2346 -25157.208   22  676 -26661.587 -17946.382  32.7%  3964 3013s
  5516  2346 -20069.433    8  731 -26661.587 -17946.382  32.7%  3963 3024s
  5517  2347 -25821.797   36  742 -26661.587 -17946.382  32.7%  3963 3035s
  5518  2348 -25189.382   18  702 -26661.587 -17946.382  32.7%  3962 3063s
  5519  2348 -22412.915   18  758 -26661.587 -17946.382  32.7%  3961 3072s
  5520  2349 -19298.906    7  708 -26661.587 -17946.382  32.7%  3960 3080s
  5521  2350 -18544.081   14  707 -26661.587 -17946.382  32.7%  3960 3085s
  5522  2350 -20569.209   10  719 -26661.587 -17946.382  32.7%  3959 3091s
  5523  2351 -18439.624   12  711 -26661.587 -17946.382  32.7%  3958 3111s
  5524  2352 -19409.792   12  773 -26661.587 -17946.382  32.7%  3958 3122s
  5525  2352 -20354.438   11  723 -26661.587 -17946.382  32.7%  3957 3127s
  5526  2353 -23730.422   16  772 -26661.587 -17946.382  32.7%  3956 3133s
  5527  2354 -20919.517   16  776 -26661.587 -17946.382  32.7%  3955 3141s
  5528  2354 -19421.896   12  777 -26661.587 -17946.382  32.7%  3955 3163s
  5529  2355 -20595.827   12  760 -26661.587 -17946.382  32.7%  3954 3175s
  5530  2356 -24214.883   40  705 -26661.587 -17946.382  32.7%  3953 3184s
  5531  2356 -22364.827   12  784 -26661.587 -17946.382  32.7%  3953 3196s
  5532  2357 -26395.323   22  740 -26661.587 -17946.382  32.7%  3952 3219s
  5533  2358 -23897.546   16  825 -26661.587 -17946.382  32.7%  3951 3226s
  5534  2358 -21744.441   13  824 -26661.587 -17946.382  32.7%  3950 3235s
  5535  2359 -24681.170   22  760 -26661.587 -17946.382  32.7%  3950 3245s
  5536  2360 -19567.622   13  758 -26661.587 -17946.382  32.7%  3949 3253s
  5537  2360 -21140.298    8  707 -26661.587 -17946.382  32.7%  3948 3272s
  5538  2361 -20038.661   12  690 -26661.587 -17946.382  32.7%  3948 3279s
  5539  2362 -20025.170    7  702 -26661.587 -17946.382  32.7%  3947 3286s
  5540  2362 -21025.524   11  703 -26661.587 -17946.382  32.7%  3946 3301s
  5541  2363 -19421.919   14  716 -26661.587 -17946.382  32.7%  3945 3311s
  5542  2364 -19312.737    8  714 -26661.587 -17946.382  32.7%  3945 3328s
  5543  2364 -23388.533   21  651 -26661.587 -17946.382  32.7%  3944 3336s
  5544  2365 -25642.869   17  665 -26661.587 -17946.382  32.7%  3943 3343s
  5545  2366 -20240.407   12  698 -26661.587 -17946.382  32.7%  3943 3359s
  5546  2366 -18351.916   10  698 -26661.587 -17946.382  32.7%  3942 3369s
  5547  2367 -24482.479   25  698 -26661.587 -17946.382  32.7%  3941 3431s
  5548  2371 -17946.382   10  657 -26661.587 -17946.382  32.7%  4013 3509s
  5550  2374 -17946.382   11  665 -26661.587 -17946.382  32.7%  4014 3547s
  5554  2381 -17946.382   12  671 -26661.587 -17946.382  32.7%  4019 3591s
  5562  2380 -24805.746   13  259 -26661.587 -17946.382  32.7%  4036 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 7
  Projected implied bound: 45
  MIR: 1227
  Flow cover: 1746
  Zero half: 3
  RLT: 30
  Relax-and-lift: 159

Explored 5564 nodes (22868120 simplex iterations) in 3600.05 seconds (8527.43 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26661.6 -26662.1 -26671.8 ... -26767.5

Time limit reached
Best objective -2.666158673884e+04, best bound -1.794638204181e+04, gap 32.6882%
  WARNING: Time limit reached. Using best solution found (gap: 32.69%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -26661.59, θ = 94107.50
  Upper Bound (UB) = -26661.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94107.50
  [DEBUG]   ✓ Scenario 0: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 94107.50 ≤ Q = 94107.50 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4f79cfba
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb0863046
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.061639e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5044605.3181
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.112798e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111279.84    0  120 5044605.32 -111279.84   102%     -    0s
H    0     0                    -78283.28246 -111279.84  42.2%     -    0s
H    0     0                    -78509.04974 -111279.84  41.7%     -    0s
     0     0 -93484.429    0   72 -78509.050 -93484.429  19.1%     -    0s
H    0     0                    -90105.80886 -93391.456  3.65%     -    0s
H    0     0                    -90269.90408 -93391.456  3.46%     -    0s
H    0     0                    -90678.32428 -93391.456  2.99%     -    0s
H    0     0                    -90842.41950 -93391.456  2.81%     -    0s
     0     0 -92988.301    0   71 -90842.419 -92988.301  2.36%     -    0s
H    0     0                    -91027.38942 -92930.047  2.09%     -    0s
H    0     0                    -91191.48464 -92930.047  1.91%     -    0s
     0     0 -92930.047    0   71 -91191.485 -92930.047  1.91%     -    0s
     0     0 -92258.908    0   64 -91191.485 -92258.908  1.17%     -    0s
     0     0 -92196.334    0   53 -91191.485 -92196.334  1.10%     -    0s
     0     0 -92173.596    0   64 -91191.485 -92173.596  1.08%     -    0s
     0     0 -92170.612    0   64 -91191.485 -92170.612  1.07%     -    0s
H    0     0                    -91333.06428 -92170.612  0.92%     -    0s
H    0     0                    -91378.76317 -91657.397  0.30%     -    0s
     0     0 -91657.397    0   12 -91378.763 -91657.397  0.30%     -    0s
     0     0 -91621.763    0   11 -91378.763 -91621.763  0.27%     -    0s
H    0     0                    -91395.87976 -91621.763  0.25%     -    0s
     0     0 -91566.272    0    8 -91395.880 -91566.272  0.19%     -    0s
     0     0 -91565.706    0    7 -91395.880 -91565.706  0.19%     -    0s
     0     0 -91523.833    0    6 -91395.880 -91523.833  0.14%     -    0s
     0     0 -91523.833    0   12 -91395.880 -91523.833  0.14%     -    0s
     0     0 -91523.833    0   11 -91395.880 -91523.833  0.14%     -    0s
     0     0 -91475.383    0    4 -91395.880 -91475.383  0.09%     -    0s
H    0     0                    -91447.68985 -91463.460  0.02%     -    0s
     0     0 -91447.839    0    2 -91447.690 -91447.839  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 3
  Flow cover: 8

Explored 1 nodes (692 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -91447.7 -91395.9 -91378.8 ... 5.04461e+06
No other solutions better than -91447.7

Optimal solution found (tolerance 1.00e-06)
Best objective -9.144768985487e+04, best bound -9.144768985487e+04, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 81685.77
  Scenario: 32 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91447.69
  [DEBUG]   S×d_nominal = 173133.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173133.46 + -91447.69 = 81685.77
  [DEBUG]   Current θ from Master = 94107.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12421.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -39083.32
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 1965.9804, Absolute Gap = 1965.9804, Relative Gap = 0.073738
  Not converged yet (gap = 1965.98 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 27 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480994 nonzeros
Model fingerprint: 0x4b087ffa
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80172 rows and 32562 columns
Presolve time: 1.34s
Presolved: 89401 rows, 38338 columns, 545167 nonzeros
Variable types: 36079 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387186.9301
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.307e+06
 Factor NZ  : 7.422e+06 (roughly 110 MB of memory)
 Factor Ops : 1.289e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.98992618e+07  1.51178827e+08  3.43e+05 1.93e+01  1.18e+05     2s
   1  -3.45118026e+07  1.81301805e+08  2.89e+05 5.41e+01  1.01e+05     3s
   2  -9.21277645e+06  1.01413465e+08  7.37e+04 8.86e+00  2.72e+04     3s
   3  -7.57505639e+06  1.00772635e+08  6.03e+04 8.44e+00  2.24e+04     3s
   4  -1.34248405e+06  6.81852793e+07  6.74e+03 1.59e+00  2.92e+03     3s
   5  -6.32828548e+05  4.43297508e+07  1.19e+03 7.07e-01  6.85e+02     3s
   6  -4.79835370e+05  1.78461241e+07  4.12e+02 1.83e-01  2.37e+02     3s
   7  -2.89108916e+05  1.21069151e+07  7.84e+01 1.11e-01  9.72e+01     3s
   8  -1.63235117e+05  7.88913592e+06  2.18e+01 7.04e-02  5.39e+01     3s
   9  -1.23298355e+05  5.54773727e+06  1.37e+01 4.81e-02  3.69e+01     3s
  10  -9.48668678e+04  2.23972573e+06  7.34e+00 1.78e-02  1.48e+01     3s
  11  -7.09787304e+04  5.32791509e+05  4.36e+00 3.88e-03  3.81e+00     3s
  12  -4.65639316e+04  2.35444439e+05  2.47e+00 1.81e-03  1.76e+00     3s
  13  -3.47021497e+04  1.21430583e+05  1.44e+00 1.23e-03  9.65e-01     3s
  14  -2.83685421e+04  7.94730573e+04  1.02e+00 9.94e-04  6.65e-01     3s
  15  -2.41673128e+04  5.17867552e+04  8.04e-01 1.32e-03  4.67e-01     3s
  16  -1.84235767e+04  3.59329376e+04  5.64e-01 1.68e-03  3.34e-01     3s
  17  -1.63152784e+04  2.84642587e+04  4.81e-01 1.77e-03  2.75e-01     3s
  18  -1.31425604e+04  2.13390828e+04  3.69e-01 3.55e-03  2.12e-01     3s
  19  -1.08000840e+04  1.60545775e+04  2.93e-01 5.82e-03  1.65e-01     3s
  20  -9.11513864e+03  1.21392390e+04  2.40e-01 3.98e-03  1.30e-01     3s
  21  -7.32075907e+03  8.27706400e+03  1.88e-01 3.59e-03  9.56e-02     3s
  22  -6.97877955e+03  6.40971673e+03  1.76e-01 2.68e-03  8.21e-02     3s
  23  -5.84467510e+03  4.89213177e+03  1.44e-01 3.17e-03  6.58e-02     3s
  24  -5.41569758e+03  4.36938569e+03  1.31e-01 3.11e-03  6.00e-02     3s
  25  -4.53228495e+03  3.63541457e+03  1.06e-01 2.60e-03  5.00e-02     3s
  26  -3.91234256e+03  3.01151689e+03  8.81e-02 2.06e-03  4.24e-02     3s
  27  -3.22728516e+03  1.94808489e+03  6.90e-02 1.59e-03  3.17e-02     3s
  28  -2.38794789e+03  1.61167097e+03  4.66e-02 1.49e-03  2.45e-02     3s
  29  -2.15050481e+03  1.12789911e+03  4.01e-02 1.26e-03  2.01e-02     3s
  30  -1.79330303e+03  7.74450279e+02  3.14e-02 1.04e-03  1.57e-02     3s
  31  -1.67892511e+03  5.79729774e+02  2.87e-02 8.79e-04  1.38e-02     4s
  32  -1.30839247e+03  3.89570976e+02  1.96e-02 1.13e-03  1.04e-02     4s
  33  -1.11703943e+03  1.33037596e+02  1.51e-02 8.11e-04  7.65e-03     4s
  34  -1.03189422e+03  6.75030438e+00  1.31e-02 6.23e-04  6.36e-03     4s
  35  -8.01886368e+02 -3.68401362e+01  7.85e-03 5.60e-04  4.68e-03     4s
  36  -7.52030637e+02 -1.20616096e+02  6.72e-03 4.39e-04  3.86e-03     4s
  37  -7.12726143e+02 -1.72164843e+02  5.79e-03 3.69e-04  3.31e-03     4s
  38  -6.13566118e+02 -2.04335819e+02  3.62e-03 3.26e-04  2.50e-03     4s
  39  -5.82646285e+02 -2.83384924e+02  2.96e-03 2.15e-04  1.83e-03     4s
  40  -5.52692325e+02 -2.99648876e+02  2.29e-03 1.93e-04  1.55e-03     4s
  41  -5.36273511e+02 -3.48613651e+02  1.93e-03 1.27e-04  1.15e-03     4s
  42  -5.18449272e+02 -3.73259901e+02  1.54e-03 9.15e-05  8.88e-04     4s
  43  -4.99291558e+02 -3.76198021e+02  1.16e-03 8.71e-05  7.52e-04     4s
  44  -4.83560533e+02 -3.99142541e+02  8.49e-04 5.60e-05  5.16e-04     4s
  45  -4.74423674e+02 -4.15613210e+02  6.61e-04 3.17e-05  3.60e-04     4s
  46  -4.60552080e+02 -4.22924252e+02  3.85e-04 2.53e-05  2.30e-04     4s
  47  -4.56584126e+02 -4.28461568e+02  3.11e-04 1.62e-05  1.72e-04     4s
  48  -4.51859093e+02 -4.31779300e+02  2.17e-04 1.13e-05  1.23e-04     4s
  49  -4.42606756e+02 -4.37565819e+02  3.81e-05 3.05e-06  3.08e-05     4s
  50  -4.40013687e+02 -4.39690367e+02  2.12e-06 1.83e-06  1.97e-06     4s
  51  -4.39801647e+02 -4.39787461e+02  7.79e-09 2.21e-07  8.64e-08     4s
  52  -4.39800248e+02 -4.39800247e+02  2.51e-10 1.51e-08  9.44e-12     4s

Barrier solved model in 52 iterations and 4.36 seconds (7.84 work units)
Optimal objective -4.39800248e+02


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    2160 PPushes remaining with PInf 5.5845131e-07                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.3750692e-11      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33684   -4.3980025e+02   0.000000e+00   0.000000e+00      6s
   33684   -4.3980025e+02   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -4.398002e+02, 33684 iterations, 3.99 seconds (7.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -439.80025    0  409 -217728.64 -439.80025   100%     -    6s
H    0     0                    -215622.0262 -439.80025   100%     -    6s
H    0     0                    -154401.0992 -439.80025   100%     -    6s
H    0     0                    -124330.3413 -439.80025   100%     -    6s
H    0     0                    -123868.8767 -439.80025   100%     -    6s
H    0     0                    -123846.3328 -439.80025   100%     -    6s
H    0     0                    -122843.1494 -439.80025   100%     -    6s
H    0     0                    -82786.85613 -439.80025  99.5%     -    6s
H    0     0                    -60501.11459 -439.80025  99.3%     -    6s
H    0     0                    -59604.92889 -439.80025  99.3%     -    6s
H    0     0                    -59538.02439 -439.80025  99.3%     -    6s
H    0     0                    -59029.10005 -439.80025  99.3%     -    8s
H    0     0                    -55084.12139 -4786.3402  91.3%     -   43s
H    0     0                    -55019.22209 -4786.3402  91.3%     -   43s
H    0     0                    -53571.80270 -4786.3402  91.1%     -   43s
H    0     0                    -53567.85050 -4786.3402  91.1%     -   43s
H    0     0                    -53552.79124 -4786.3402  91.1%     -   43s
     0     0 -4786.3402    0  548 -53552.791 -4786.3402  91.1%     -   43s
H    0     0                    -53548.72709 -4786.4596  91.1%     -   44s
     0     0 -5289.8889    0  539 -53548.727 -5289.8889  90.1%     -   60s
     0     0 -5355.5964    0  558 -53548.727 -5355.5964  90.0%     -   71s
     0     0 -5355.5964    0  565 -53548.727 -5355.5964  90.0%     -   75s
     0     0 -5355.5964    0  563 -53548.727 -5355.5964  90.0%     -   76s
     0     0 -5355.5964    0  564 -53548.727 -5355.5964  90.0%     -   77s
H    0     0                    -51981.63644 -8690.3982  83.3%     -  138s
H    0     0                    -51839.40605 -8690.3982  83.2%     -  138s
H    0     0                    -50843.45614 -8690.3982  82.9%     -  138s
     0     0 -8690.3982    0  721 -50843.456 -8690.3982  82.9%     -  138s
H    0     0                    -36609.61511 -8690.8186  76.3%     -  138s
H    0     0                    -36494.04432 -8690.8186  76.2%     -  138s
H    0     0                    -36374.08505 -8690.8186  76.1%     -  138s
H    0     0                    -36358.85873 -8690.8186  76.1%     -  138s
H    0     0                    -36346.23756 -8690.8186  76.1%     -  138s
H    0     0                    -36325.06239 -8690.8186  76.1%     -  138s
H    0     0                    -36321.20352 -8690.8186  76.1%     -  138s
H    0     0                    -36320.47998 -8690.8186  76.1%     -  138s
H    0     0                    -36309.11254 -8690.8186  76.1%     -  138s
H    0     0                    -36296.49137 -8690.8186  76.1%     -  138s
H    0     0                    -36276.60054 -8690.8186  76.0%     -  138s
H    0     0                    -36275.31620 -8690.8186  76.0%     -  138s
H    0     0                    -36271.45733 -8690.8186  76.0%     -  138s
H    0     0                    -31052.46402 -9349.4603  69.9%     -  180s
H    0     0                    -31023.41950 -9349.4603  69.9%     -  180s
H    0     0                    -30773.70695 -9349.4603  69.6%     -  180s
H    0     0                    -30757.19161 -9349.4603  69.6%     -  180s
H    0     0                    -30698.61809 -9349.4603  69.5%     -  180s
H    0     0                    -30695.15405 -9349.4603  69.5%     -  180s
H    0     0                    -30675.60103 -9349.4603  69.5%     -  180s
H    0     0                    -30668.54490 -9349.4603  69.5%     -  180s
H    0     0                    -30667.27535 -9349.4603  69.5%     -  180s
H    0     0                    -30658.37830 -9349.4603  69.5%     -  180s
H    0     0                    -30654.07565 -9349.4603  69.5%     -  180s
H    0     0                    -30542.64386 -9349.4603  69.4%     -  180s
     0     0 -9349.4603    0  704 -30542.644 -9349.4603  69.4%     -  180s
     0     0 -9474.2791    0  702 -30542.644 -9474.2791  69.0%     -  194s
     0     0 -9531.4264    0  708 -30542.644 -9531.4264  68.8%     -  207s
H    0     0                    -30505.92484 -9580.9810  68.6%     -  214s
H    0     0                    -30428.95979 -9580.9810  68.5%     -  214s
     0     0 -9580.9810    0  714 -30428.960 -9580.9810  68.5%     -  214s
H    0     0                    -29623.34973 -9585.7419  67.6%     -  216s
H    0     0                    -29617.48150 -9585.7419  67.6%     -  216s
H    0     0                    -29538.80535 -9585.7419  67.5%     -  216s
     0     0 -9585.7419    0  708 -29538.805 -9585.7419  67.5%     -  216s
     0     0 -9587.7592    0  710 -29538.805 -9587.7592  67.5%     -  218s
     0     0 -9595.3199    0  708 -29538.805 -9595.3199  67.5%     -  219s
     0     0 -9597.7200    0  700 -29538.805 -9597.7200  67.5%     -  221s
     0     0 -9598.5832    0  701 -29538.805 -9598.5832  67.5%     -  223s
H    0     0                    -29528.26671 -9598.5832  67.5%     -  236s
H    0     0                    -29525.34964 -9598.5832  67.5%     -  236s
H    0     0                    -29518.99798 -9598.5832  67.5%     -  236s
H    0     0                    -29506.89295 -9598.5832  67.5%     -  236s
H    0     0                    -29478.73467 -11862.798  59.8%     -  287s
H    0     0                    -29385.61527 -11862.798  59.6%     -  287s
H    0     0                    -29376.62703 -11862.798  59.6%     -  287s
H    0     0                    -29374.76483 -11862.798  59.6%     -  287s
H    0     0                    -29365.46846 -11862.798  59.6%     -  287s
     0     0 -11862.798    0  632 -29365.468 -11862.798  59.6%     -  287s
H    0     0                    -29306.39728 -11862.922  59.5%     -  287s
H    0     0                    -29305.11113 -11862.922  59.5%     -  287s
H    0     0                    -29303.78564 -11862.922  59.5%     -  287s
     0     0 -12333.457    0  610 -29303.786 -12333.457  57.9%     -  313s
     0     0 -12426.953    0  706 -29303.786 -12426.953  57.6%     -  327s
     0     0 -12450.802    0  639 -29303.786 -12450.802  57.5%     -  332s
     0     0 -12463.724    0  636 -29303.786 -12463.724  57.5%     -  338s
     0     0 -12468.218    0  636 -29303.786 -12468.218  57.5%     -  341s
     0     0 -12517.773    0  697 -29303.786 -12517.773  57.3%     -  350s
     0     0 -12525.467    0  692 -29303.786 -12525.467  57.3%     -  354s
     0     0 -12529.134    0  696 -29303.786 -12529.134  57.2%     -  356s
     0     0 -12531.702    0  637 -29303.786 -12531.702  57.2%     -  358s
     0     0 -12532.584    0  698 -29303.786 -12532.584  57.2%     -  359s
     0     0 -13763.072    0  598 -29303.786 -13763.072  53.0%     -  429s
H    0     0                    -29300.04380 -13763.115  53.0%     -  430s
     0     0 -14246.293    0  720 -29300.044 -14246.293  51.4%     -  480s
     0     0 -14359.146    0  669 -29300.044 -14359.146  51.0%     -  499s
     0     0 -14413.148    0  627 -29300.044 -14413.148  50.8%     -  515s
     0     0 -14463.371    0  747 -29300.044 -14463.371  50.6%     -  528s
     0     0 -14477.934    0  796 -29300.044 -14477.934  50.6%     -  536s
     0     0 -14483.346    0  784 -29300.044 -14483.346  50.6%     -  539s
     0     0 -14488.468    0  733 -29300.044 -14488.468  50.6%     -  542s
     0     0 -14489.629    0  742 -29300.044 -14489.629  50.5%     -  544s
     0     0 -14733.642    0  616 -29300.044 -14733.642  49.7%     -  575s
H    0     0                    -29296.85283 -14733.771  49.7%     -  576s
H    0     0                    -29281.60510 -14733.771  49.7%     -  576s
H    0     0                    -29280.89266 -14733.771  49.7%     -  576s
     0     0 -14803.838    0  626 -29280.893 -14803.838  49.4%     -  599s
     0     0 -14818.785    0  630 -29280.893 -14818.785  49.4%     -  608s
     0     0 -14829.533    0  630 -29280.893 -14829.533  49.4%     -  614s
     0     0 -14830.711    0  632 -29280.893 -14830.711  49.4%     -  616s
     0     0 -15008.918    0  737 -29280.893 -15008.918  48.7%     -  650s
     0     0 -15053.322    0  630 -29280.893 -15053.322  48.6%     -  671s
     0     0 -15076.194    0  638 -29280.893 -15076.194  48.5%     -  685s
     0     0 -15083.241    0  632 -29280.893 -15083.241  48.5%     -  691s
     0     0 -15087.285    0  771 -29280.893 -15087.285  48.5%     -  696s
     0     0 -15088.956    0  767 -29280.893 -15088.956  48.5%     -  700s
     0     0 -15245.287    0  746 -29280.893 -15245.287  47.9%     -  725s
     0     0 -15278.609    0  753 -29280.893 -15278.609  47.8%     -  739s
     0     0 -15284.866    0  754 -29280.893 -15284.866  47.8%     -  747s
     0     0 -15291.731    0  755 -29280.893 -15291.731  47.8%     -  753s
     0     0 -15300.039    0  805 -29280.893 -15300.039  47.7%     -  759s
     0     0 -15302.057    0  808 -29280.893 -15302.057  47.7%     -  763s
     0     0 -15371.804    0  639 -29280.893 -15371.804  47.5%     -  788s
H    0     0                    -29279.34226 -15371.875  47.5%     -  790s
H    0     0                    -29274.36005 -15371.875  47.5%     -  790s
H    0     0                    -29273.84430 -15371.875  47.5%     -  790s
     0     0 -15395.930    0  755 -29273.844 -15395.930  47.4%     -  805s
     0     0 -15402.751    0  721 -29273.844 -15402.751  47.4%     -  811s
     0     0 -15406.638    0  784 -29273.844 -15406.638  47.4%     -  817s
     0     0 -15407.162    0  725 -29273.844 -15407.162  47.4%     -  819s
     0     0 -15450.000    0  697 -29273.844 -15450.000  47.2%     -  838s
     0     0 -15475.208    0  765 -29273.844 -15475.208  47.1%     -  850s
     0     0 -15483.748    0  701 -29273.844 -15483.748  47.1%     -  860s
     0     0 -15485.713    0  710 -29273.844 -15485.713  47.1%     -  865s
     0     0 -15500.911    0  658 -29273.844 -15500.911  47.0%     -  879s
     0     0 -15507.491    0  659 -29273.844 -15507.491  47.0%     -  890s
     0     0 -15509.920    0  658 -29273.844 -15509.920  47.0%     -  895s
     0     0 -15523.333    0  654 -29273.844 -15523.333  47.0%     -  908s
     0     0 -15526.340    0  659 -29273.844 -15526.340  47.0%     -  915s
     0     0 -15529.204    0  651 -29273.844 -15529.204  47.0%     -  922s
     0     0 -15535.265    0  652 -29273.844 -15535.265  46.9%     -  934s
     0     0 -15535.313    0  652 -29273.844 -15535.313  46.9%     -  939s
H    0     0                    -28410.26610 -15535.524  45.3%     - 1062s
H    0     0                    -27830.08016 -15535.524  44.2%     - 1062s
H    0     0                    -27387.19486 -15535.524  43.3%     - 1062s
H    0     0                    -27372.54954 -15535.524  43.2%     - 1063s
H    0     0                    -27355.22265 -15535.524  43.2%     - 1063s
H    0     0                    -27325.55863 -15535.524  43.1%     - 1067s
H    0     0                    -27324.50446 -15535.524  43.1%     - 1067s
H    0     0                    -27308.79118 -15535.524  43.1%     - 1067s
H    0     0                    -27306.17875 -15535.524  43.1%     - 1067s
H    0     0                    -27274.25634 -15535.524  43.0%     - 1068s
H    0     0                    -27269.38420 -15535.524  43.0%     - 1068s
H    0     0                    -27239.43576 -15535.524  43.0%     - 1068s
H    0     0                    -27207.87684 -15535.524  42.9%     - 1068s
H    0     2                    -27078.43725 -15535.524  42.6%     - 1094s
     0     2 -15535.524    0  652 -27078.437 -15535.524  42.6%     - 1094s
     1     4 -15669.762    1  632 -27078.437 -15535.524  42.6%  9562 1122s
     3     8 -15808.322    2  697 -27078.437 -15669.795  42.1% 12608 1166s
     7    16 -16020.951    3  693 -27078.437 -15808.644  41.6% 14701 1203s
    15    31 -17259.853    4  588 -27078.437 -16021.027  40.8% 15979 1265s
    30    48 -19332.985    5  231 -27078.437 -16021.027  40.8% 22542 1338s
H   47    80                    -27065.58974 -16232.075  40.0% 23975 1376s
H   48    80                    -27065.43964 -16232.171  40.0% 23927 1376s
H   50    80                    -27064.86577 -16232.171  40.0% 23247 1376s
H   52    80                    -27062.39123 -16232.171  40.0% 22770 1376s
H   76    80                    -27037.89821 -16232.171  40.0% 18037 1376s
    79   157 -17677.624    6  621 -27037.898 -16437.500  39.2% 17774 1469s
H  156   189                    -27033.02155 -16437.841  39.2% 11053 1495s
H  162   189                    -27028.15925 -16437.841  39.2% 10795 1495s
   188   317 -17770.518    9  616 -27028.159 -16437.841  39.2%  9827 1525s
   316   379 -17900.749   10  591 -27028.159 -16437.841  39.2%  7280 1546s
   392   396 -17913.639   11  593 -27028.159 -16437.841  39.2%  6799 1566s
   455   430 -19046.595   11  386 -27028.159 -16437.841  39.2%  6556 1584s
   525   466 -26613.871   18  144 -27028.159 -16437.841  39.2%  6258 1604s
   600   480 -24203.810   13  140 -27028.159 -16437.841  39.2%  5880 1622s
H  608   480                    -27027.61932 -16437.841  39.2%  5852 1622s
H  620   480                    -27025.68470 -16437.841  39.2%  5817 1622s
   632   523 -26628.533   14   97 -27025.685 -16437.841  39.2%  5770 1638s
   715   568 infeasible   15      -27025.685 -16437.841  39.2%  5407 1655s
   815   586     cutoff   16      -27025.685 -16437.841  39.2%  4996 1671s
   925   609 -26171.999   15  147 -27025.685 -16437.841  39.2%  4619 1688s
  1030   601     cutoff   16      -27025.685 -16437.841  39.2%  4361 1706s
  1151   593 infeasible   16      -27025.685 -16437.841  39.2%  4076 1728s
  1199   606 -21375.230   10  274 -27025.685 -16437.841  39.2%  4030 1752s
  1222   643 -23666.573   11  406 -27025.685 -16437.841  39.2%  4064 1773s
  1263   703 -23010.987   12  448 -27025.685 -16469.730  39.1%  4090 1796s
  1352   703 -23147.643   13  435 -27025.685 -16469.730  39.1%  3998 1819s
  1461   705 -26619.996   15  313 -27025.685 -16469.730  39.1%  3871 1842s
  1523   725 -24911.453   14  416 -27025.685 -16469.730  39.1%  3893 1865s
  1599   825 -25568.113   15  352 -27025.685 -16469.730  39.1%  3884 1887s
  1750   851 -25902.580   18  403 -27025.685 -16469.730  39.1%  3722 1907s
  1790   868 -25978.414   22  456 -27025.685 -16469.730  39.1%  3714 1929s
  1849   909 -26457.605   26  374 -27025.685 -16571.777  38.7%  3686 1953s
  1963   900 -26766.404   33  295 -27025.685 -16571.777  38.7%  3579 1979s
  2053   911 -24798.450   13  222 -27025.685 -16901.374  37.5%  3525 2008s
  2084   920 -24931.424   14  222 -27025.685 -16901.374  37.5%  3575 2036s
  2124   928 infeasible   14      -27025.685 -16901.374  37.5%  3594 2065s
  2164   946 -20559.891   14  610 -27025.685 -16901.374  37.5%  3648 2092s
  2194   979 -21103.256   15  583 -27025.685 -16901.374  37.5%  3685 2122s
  2235   996 -22129.959   16  589 -27025.685 -16901.374  37.5%  3710 2148s
H 2241   996                    -27006.65488 -16901.374  37.4%  3709 2148s
  2265  1029     cutoff   10      -27006.655 -16901.374  37.4%  3754 2180s
  2367  1063 -21738.797   16  484 -27006.655 -16901.374  37.4%  3754 2213s
H 2370  1063                    -27003.10647 -16901.374  37.4%  3756 2213s
H 2381  1063                    -26997.04828 -16901.374  37.4%  3769 2213s
H 2393  1063                    -26992.94730 -16901.374  37.4%  3756 2213s
H 2420  1063                    -26988.21087 -16901.374  37.4%  3748 2213s
  2455  1122 -25083.916   14  117 -26988.211 -16901.374  37.4%  3760 2247s
  2588  1187 infeasible   19      -26988.211 -16901.374  37.4%  3761 2287s
  2738  1208 -21267.580   12  470 -26988.211 -16901.374  37.4%  3739 2319s
  2779  1284 -21520.131   13  471 -26988.211 -16901.374  37.4%  3771 2352s
  2886  1305 -22169.207   14  461 -26988.211 -16901.374  37.4%  3723 2382s
  2927  1346 -22183.918   15  470 -26988.211 -16959.853  37.2%  3741 2414s
  3032  1419 -22713.946   16  445 -26988.211 -16959.853  37.2%  3693 2450s
  3182  1451 -24780.127   18  482 -26988.211 -16959.853  37.2%  3665 2495s
  3316  1526     cutoff   19      -26988.211 -16959.853  37.2%  3653 2541s
  3442  1603 infeasible   19      -26988.211 -16959.853  37.2%  3681 2587s
  3596  1684 -26720.541   18  432 -26988.211 -17625.756  34.7%  3698 2637s
  3789  1763 -20289.669   13  496 -26988.211 -17625.756  34.7%  3705 2686s
  3963  1829 -21021.626   14  485 -26988.211 -17625.785  34.7%  3717 2752s
  4096  1917 -23155.873   15  488 -26988.211 -17625.785  34.7%  3773 2806s
  4277  1983 -25845.540   19  343 -26988.211 -18636.406  30.9%  3788 2864s
  4480  2040 infeasible   19      -26988.211 -18840.884  30.2%  3822 2927s
  4668  2117 infeasible   12      -26988.211 -18955.140  29.8%  3842 2988s
  4847  2254 -26755.006   14  383 -26988.211 -19057.314  29.4%  3904 3051s
  5130  2255 -21329.666   12  652 -26988.211 -19102.574  29.2%  3885 3428s
  5132  2256 -23908.618    9  484 -26988.211 -19102.574  29.2%  3883 3440s
  5133  2257 -25508.870   37  640 -26988.211 -19102.574  29.2%  3883 3524s
  5134  2258 -24583.503   15  622 -26988.211 -19102.574  29.2%  3882 3584s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 46
  Projected implied bound: 106
  MIR: 1275
  Mixing: 3
  Flow cover: 1179
  Zero half: 8
  RLT: 72
  Relax-and-lift: 166

Explored 5134 nodes (20754044 simplex iterations) in 3600.03 seconds (8452.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26988.2 -26992.9 -26997 ... -27037.9

Time limit reached
Best objective -2.698821087239e+04, best bound -1.910257376116e+04, gap 29.2188%
  WARNING: Time limit reached. Using best solution found (gap: 29.22%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -26988.21, θ = 93823.52
  Upper Bound (UB) = -26988.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93823.52
  [DEBUG]   ✓ Scenario 0: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93823.52 ≤ Q = 93823.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93823.52 ≤ Q = 93823.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93823.52 ≤ Q = 93823.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2a3fde2d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd5c021d3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.075050e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5100024.8206
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.113556e+05, 224 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111355.61    0  120 5100024.82 -111355.61   102%     -    0s
H    0     0                    -78381.82447 -111355.61  42.1%     -    0s
H    0     0                    -79055.67961 -111355.61  40.9%     -    0s
     0     0 -88196.437    0   68 -79055.680 -88196.437  11.6%     -    0s
H    0     0                    -85247.97162 -88129.543  3.38%     -    0s
H    0     0                    -85412.06684 -88129.543  3.18%     -    0s
H    0     0                    -85485.55765 -88129.543  3.09%     -    0s
H    0     0                    -85649.65287 -88129.543  2.90%     -    0s
     0     0 -87754.502    0   69 -85649.653 -87754.502  2.46%     -    0s
     0     0 -87735.458    0   69 -85649.653 -87735.458  2.44%     -    0s
     0     0 -87130.434    0   71 -85649.653 -87130.434  1.73%     -    0s
     0     0 -86709.546    0   73 -85649.653 -86709.546  1.24%     -    0s
     0     0 -86684.518    0   73 -85649.653 -86684.518  1.21%     -    0s
H    0     0                    -85822.32059 -86684.518  1.00%     -    0s
     0     0 -86357.857    0   75 -85822.321 -86357.857  0.62%     -    0s
     0     0 -86309.788    0   73 -85822.321 -86309.788  0.57%     -    0s
     0     0 -86303.844    0   74 -85822.321 -86303.844  0.56%     -    0s
H    0     0                    -85836.93141 -86303.844  0.54%     -    0s
     0     0 -86079.076    0   11 -85836.931 -86079.076  0.28%     -    0s
     0     0 -86028.326    0   11 -85836.931 -86028.326  0.22%     -    0s
     0     0 -86023.642    0    8 -85836.931 -86023.642  0.22%     -    0s
     0     0 -85940.668    0    7 -85836.931 -85940.668  0.12%     -    0s
     0     0 -85940.668    0   14 -85836.931 -85940.668  0.12%     -    0s
     0     0 -85890.456    0    3 -85836.931 -85890.456  0.06%     -    0s
H    0     0                    -85875.14161 -85884.826  0.01%     -    0s
     0     0 -85879.433    0    2 -85875.142 -85879.433  0.00%     -    0s
     0     0 -85879.433    0    2 -85875.142 -85879.433  0.00%     -    0s
     0     0 -85875.469    0    2 -85875.142 -85875.469  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Flow cover: 1

Explored 1 nodes (774 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -85875.1 -85874 -85836.9 ... 1.07505e+13
No other solutions better than -85875.1

Optimal solution found (tolerance 1.00e-06)
Best objective -8.587514161217e+04, best bound -8.587514161217e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 87081.16
  Scenario: 30 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -85875.14
  [DEBUG]   S×d_nominal = 172956.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172956.31 + -85875.14 = 87081.16
  [DEBUG]   Current θ from Master = 93823.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6742.36 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33730.57
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 1639.3563, Absolute Gap = 1639.3563, Relative Gap = 0.060743
  Not converged yet (gap = 1639.36 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 29 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524219 nonzeros
Model fingerprint: 0x590a43af
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87464 rows and 35524 columns
Presolve time: 1.54s
Presolved: 97399 rows, 41616 columns, 592247 nonzeros
Variable types: 39357 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387312.5321
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.779e+06
 Factor NZ  : 8.564e+06 (roughly 130 MB of memory)
 Factor Ops : 1.558e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.99448418e+07  1.63650837e+08  3.43e+05 1.93e+01  1.17e+05     3s
   1  -3.48531815e+07  1.72879038e+08  2.92e+05 8.47e+01  9.91e+04     3s
   2  -1.57381339e+07  1.39704460e+08  1.23e+05 4.43e+01  4.27e+04     3s
   3  -8.96918214e+06  1.09886361e+08  6.86e+04 1.97e+01  2.40e+04     3s
   4  -7.72885755e+06  1.02304363e+08  5.88e+04 1.32e+01  2.05e+04     3s
   5  -2.17679991e+06  9.92672265e+07  1.30e+04 1.44e+01  4.95e+03     3s
   6  -9.49866246e+05  7.36342356e+07  2.93e+03 7.10e+00  1.38e+03     3s
   7  -6.46324231e+05  4.74961889e+07  6.95e+02 3.96e+00  4.85e+02     3s
   8  -5.24554168e+05  2.51841810e+07  1.95e+02 1.84e+00  1.98e+02     3s
   9  -3.85047490e+05  1.70662592e+07  4.89e+01 1.18e+00  1.10e+02     3s
  10  -2.91497932e+05  1.27851210e+07  1.95e+01 8.43e-01  7.74e+01     3s
  11  -1.69735648e+05  4.94157642e+06  8.94e+00 7.45e-03  2.96e+01     3s
  12  -1.33361495e+05  2.49489807e+06  5.46e+00 1.14e-01  1.51e+01     3s
  13  -1.04813838e+05  1.21166034e+06  3.75e+00 3.82e-02  7.51e+00     3s
  14  -6.82822671e+04  5.27745435e+05  2.00e+00 1.98e-02  3.38e+00     3s
  15  -4.51858456e+04  2.44286510e+05  1.13e+00 5.62e-04  1.63e+00     3s
  16  -3.28906676e+04  1.21616517e+05  7.16e-01 2.54e-04  8.71e-01     3s
  17  -2.65067768e+04  7.35164374e+04  5.31e-01 1.56e-04  5.63e-01     3s
  18  -1.98874424e+04  4.94764631e+04  3.73e-01 2.12e-04  3.90e-01     3s
  19  -1.71046361e+04  3.79261630e+04  3.07e-01 3.19e-04  3.10e-01     3s
  20  -1.36910479e+04  2.78422023e+04  2.31e-01 7.10e-04  2.34e-01     3s
  21  -1.04412188e+04  1.84253985e+04  1.68e-01 1.38e-03  1.62e-01     3s
  22  -7.58541295e+03  1.34247867e+04  1.20e-01 1.80e-03  1.18e-01     3s
  23  -7.28810241e+03  8.80111577e+03  1.13e-01 3.53e-03  9.05e-02     4s
  24  -6.19527769e+03  7.33942687e+03  9.44e-02 3.27e-03  7.61e-02     4s
  25  -5.15266278e+03  5.86294143e+03  7.60e-02 2.57e-03  6.19e-02     4s
  26  -4.26613887e+03  5.01525268e+03  6.04e-02 2.26e-03  5.22e-02     4s
  27  -3.92766020e+03  3.20340424e+03  5.44e-02 1.72e-03  4.01e-02     4s
  28  -3.67462523e+03  2.35147043e+03  5.03e-02 1.53e-03  3.39e-02     4s
  29  -3.21861946e+03  2.00302244e+03  4.34e-02 1.34e-03  2.94e-02     4s
  30  -2.76762341e+03  1.32608661e+03  3.63e-02 1.27e-03  2.30e-02     4s
  31  -2.50394613e+03  1.12676678e+03  3.24e-02 1.11e-03  2.04e-02     4s
  32  -2.32513201e+03  9.49806349e+02  2.98e-02 9.77e-04  1.84e-02     4s
  33  -2.09520790e+03  7.60260315e+02  2.63e-02 8.06e-04  1.61e-02     4s
  34  -1.70367056e+03  6.25533194e+02  2.04e-02 7.78e-04  1.31e-02     4s
  35  -1.57126039e+03  3.57290159e+02  1.85e-02 5.44e-04  1.08e-02     4s
  36  -1.08205283e+03  2.07313843e+02  1.16e-02 4.22e-04  7.25e-03     4s
  37  -1.05626386e+03  1.37703413e+02  1.12e-02 3.60e-04  6.71e-03     4s
  38  -9.52754525e+02  4.36897124e+01  9.68e-03 2.87e-04  5.60e-03     4s
  39  -7.69260844e+02 -1.13026873e+01  7.01e-03 2.34e-04  4.26e-03     4s
  40  -6.30598369e+02 -7.28244416e+01  5.02e-03 1.76e-04  3.14e-03     4s
  41  -5.86477776e+02 -1.24166368e+02  4.41e-03 1.28e-04  2.60e-03     4s
  42  -4.70322999e+02 -1.35616954e+02  2.80e-03 1.17e-04  1.88e-03     4s
  43  -4.02934991e+02 -1.88074848e+02  1.88e-03 8.76e-05  1.21e-03     4s
  44  -3.68968651e+02 -2.04806265e+02  1.44e-03 6.72e-05  9.23e-04     4s
  45  -3.32654280e+02 -2.35628595e+02  9.26e-04 2.48e-05  5.45e-04     5s
  46  -3.24182970e+02 -2.37584011e+02  8.19e-04 2.24e-05  4.87e-04     5s
  47  -3.16364824e+02 -2.44083393e+02  7.16e-04 1.58e-05  4.06e-04     5s
  48  -3.11962248e+02 -2.48669789e+02  6.62e-04 1.11e-05  3.56e-04     5s
  49  -3.03457193e+02 -2.49403758e+02  5.54e-04 1.03e-05  3.04e-04     5s
  50  -2.95567759e+02 -2.53052943e+02  4.51e-04 6.19e-06  2.39e-04     5s
  51  -2.92967209e+02 -2.53686781e+02  4.19e-04 5.72e-06  2.21e-04     5s
  52  -2.90426878e+02 -2.54507683e+02  3.88e-04 6.89e-06  2.02e-04     5s
  53  -2.86240123e+02 -2.55180187e+02  3.37e-04 6.10e-06  1.75e-04     5s
  54  -2.85183401e+02 -2.55643007e+02  3.24e-04 5.55e-06  1.66e-04     5s
  55  -2.82842988e+02 -2.56384691e+02  2.94e-04 4.46e-06  1.49e-04     5s
  56  -2.70222850e+02 -2.56913368e+02  1.32e-04 3.62e-06  7.48e-05     5s
  57  -2.66732022e+02 -2.57950618e+02  8.59e-05 2.00e-06  4.94e-05     5s
  58  -2.61161976e+02 -2.59070371e+02  1.48e-05 4.42e-07  1.17e-05     5s
  59  -2.60991725e+02 -2.59194655e+02  1.32e-05 4.44e-07  1.01e-05     5s
  60  -2.60412540e+02 -2.59278918e+02  7.55e-06 3.62e-07  6.36e-06     5s
  61  -2.60128700e+02 -2.59538766e+02  4.85e-06 7.66e-08  3.31e-06     5s
  62  -2.60103065e+02 -2.59547335e+02  4.62e-06 6.29e-08  3.12e-06     5s
  63  -2.60064429e+02 -2.59548969e+02  4.27e-06 5.93e-08  2.89e-06     5s
  64  -2.59995176e+02 -2.59552653e+02  3.63e-06 5.40e-08  2.49e-06     5s
  65  -2.59848548e+02 -2.59565667e+02  2.29e-06 2.60e-08  1.59e-06     6s
  66  -2.59606284e+02 -2.59583446e+02  1.25e-07 1.43e-07  1.28e-07     6s
  67  -2.59590980e+02 -2.59587244e+02  1.10e-07 7.50e-09  2.10e-08     6s
  68  -2.59589341e+02 -2.59587284e+02  1.26e-06 1.97e-09  1.14e-08     6s
  69  -2.59587905e+02 -2.59587297e+02  6.99e-07 1.93e-10  3.31e-09     6s
  70  -2.59587308e+02 -2.59587298e+02  1.09e-08 2.05e-08  5.17e-11     6s
  71  -2.59587299e+02 -2.59587298e+02  6.71e-09 3.26e-10  1.03e-12     6s

Barrier solved model in 71 iterations and 5.77 seconds (10.96 work units)
Optimal objective -2.59587299e+02


Root crossover log...

   78687 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    2389 PPushes remaining with PInf 2.3675307e-08                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.4989116e-01      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36549   -2.5958730e+02   0.000000e+00   6.498912e-01      8s
   36555   -2.5958730e+02   0.000000e+00   0.000000e+00      8s
   36555   -2.5958730e+02   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -2.595873e+02, 36555 iterations, 5.93 seconds (13.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -259.58730    0  441 -217728.64 -259.58730   100%     -    8s
H    0     0                    -215944.3554 -259.58730   100%     -    8s
H    0     0                    -144981.3989 -259.58730   100%     -    8s
H    0     0                    -143657.2628 -259.58730   100%     -    8s
H    0     0                    -143639.1501 -259.58730   100%     -    8s
H    0     0                    -143477.8040 -259.58730   100%     -    8s
H    0     0                    -95789.70086 -259.58730   100%     -    8s
H    0     0                    -81098.73343 -259.58730   100%     -    9s
H    0     0                    -72733.86334 -259.58730   100%     -    9s
H    0     0                    -72616.75266 -259.58730   100%     -    9s
H    0     0                    -72587.77936 -259.58730   100%     -    9s
H    0     0                    -66845.08299 -4155.6881  93.8%     -   57s
H    0     0                    -66837.87845 -4155.6881  93.8%     -   57s
H    0     0                    -66374.69734 -4155.6881  93.7%     -   57s
H    0     0                    -65929.67449 -4155.6881  93.7%     -   57s
H    0     0                    -64515.55768 -4155.6881  93.6%     -   57s
H    0     0                    -64498.09568 -4155.6881  93.6%     -   57s
H    0     0                    -64491.45585 -4155.6881  93.6%     -   57s
H    0     0                    -64458.39219 -4155.6881  93.6%     -   57s
H    0     0                    -64447.28294 -4155.6881  93.6%     -   57s
H    0     0                    -64442.50498 -4155.6881  93.6%     -   57s
H    0     0                    -64441.68054 -4155.6881  93.6%     -   57s
     0     0 -4198.1604    0  637 -64441.681 -4198.1604  93.5%     -   57s
H    0     0                    -63083.50342 -4198.1604  93.3%     -   58s
H    0     0                    -63020.11278 -4198.1604  93.3%     -   58s
H    0     0                    -62911.06415 -4198.1604  93.3%     -   58s
H    0     0                    -62892.06843 -4198.1604  93.3%     -   58s
H    0     0                    -62877.74046 -4198.1604  93.3%     -   58s
H    0     0                    -62870.29967 -4198.1604  93.3%     -   58s
     0     0 -4617.7791    0  647 -62870.300 -4617.7791  92.7%     -   74s
     0     0 -4746.7368    0  661 -62870.300 -4746.7368  92.4%     -   85s
     0     0 -4817.9163    0  663 -62870.300 -4817.9163  92.3%     -   95s
     0     0 -4817.9163    0  665 -62870.300 -4817.9163  92.3%     -  104s
     0     0 -4817.9163    0  667 -62870.300 -4817.9163  92.3%     -  105s
     0     0 -4817.9163    0  668 -62870.300 -4817.9163  92.3%     -  107s
     0     0 -4817.9163    0  673 -62870.300 -4817.9163  92.3%     -  107s
H    0     0                    -60040.54054 -7289.3466  87.9%     -  159s
H    0     0                    -59168.34992 -7289.3466  87.7%     -  159s
H    0     0                    -59056.57933 -7289.3466  87.7%     -  159s
H    0     0                    -59049.00661 -7289.3466  87.7%     -  159s
H    0     0                    -44599.85314 -7289.3466  83.7%     -  159s
H    0     0                    -42471.22699 -7289.3466  82.8%     -  159s
H    0     0                    -42263.42421 -7289.3466  82.8%     -  159s
     0     0 -7483.9997    0  658 -42263.424 -7483.9997  82.3%     -  159s
H    0     0                    -37480.58664 -7483.9997  80.0%     -  160s
H    0     0                    -37416.29000 -7483.9997  80.0%     -  160s
H    0     0                    -37408.83618 -7483.9997  80.0%     -  160s
H    0     0                    -37405.77480 -7483.9997  80.0%     -  160s
H    0     0                    -34718.06952 -8617.7104  75.2%     -  226s
H    0     0                    -34545.70000 -8617.7104  75.1%     -  226s
     0     0 -8617.7104    0  702 -34545.700 -8617.7104  75.1%     -  226s
H    0     0                    -28151.10106 -8774.2478  68.8%     -  248s
H    0     0                    -28007.69388 -8774.2478  68.7%     -  248s
H    0     0                    -27592.32381 -8774.2478  68.2%     -  248s
H    0     0                    -27498.10397 -8774.2478  68.1%     -  248s
H    0     0                    -27492.81180 -8774.2478  68.1%     -  248s
H    0     0                    -27490.48392 -8774.2478  68.1%     -  248s
     0     0 -8774.2478    0  689 -27490.484 -8774.2478  68.1%     -  248s
     0     0 -8797.4669    0  691 -27490.484 -8797.4669  68.0%     -  258s
H    0     0                    -27435.56491 -8805.3569  67.9%     -  265s
H    0     0                    -27433.23704 -8805.3569  67.9%     -  265s
H    0     0                    -27429.17288 -8805.3569  67.9%     -  265s
H    0     0                    -27426.03250 -8805.3569  67.9%     -  265s
H    0     0                    -27421.96834 -8805.3569  67.9%     -  265s
H    0     0                    -27412.45808 -8805.3569  67.9%     -  265s
H    0     0                    -27408.39393 -8805.3569  67.9%     -  265s
H    0     0                    -27402.40435 -8805.3569  67.9%     -  265s
H    0     0                    -27398.34020 -8805.3569  67.9%     -  265s
H    0     0                    -27388.82993 -8805.3569  67.9%     -  265s
H    0     0                    -27384.76578 -8805.3569  67.8%     -  265s
H    0     0                    -27378.07156 -8805.3569  67.8%     -  265s
H    0     0                    -27374.00741 -8805.3569  67.8%     -  265s
H    0     0                    -27373.39170 -8805.3569  67.8%     -  265s
H    0     0                    -27335.78114 -8805.3569  67.8%     -  265s
H    0     0                    -27330.48897 -8805.3569  67.8%     -  265s
H    0     0                    -27325.75897 -8805.3569  67.8%     -  265s
H    0     0                    -27325.24322 -8805.3569  67.8%     -  265s
     0     0 -8805.3569    0  687 -27325.243 -8805.3569  67.8%     -  265s
H    0     0                    -27229.23532 -8875.3630  67.4%     -  282s
H    0     0                    -27226.09379 -8875.3630  67.4%     -  282s
     0     0 -8875.3630    0  715 -27226.094 -8875.3630  67.4%     -  282s
     0     0 -8883.5161    0  692 -27226.094 -8883.5161  67.4%     -  288s
     0     0 -8886.4143    0  690 -27226.094 -8886.4143  67.4%     -  291s
     0     0 -8886.8296    0  689 -27226.094 -8886.8296  67.4%     -  292s
     0     0 -10488.522    0  591 -27226.094 -10488.522  61.5%     -  375s
H    0     0                    -27188.18609 -10488.690  61.4%     -  376s
     0     0 -11072.274    0  580 -27188.186 -11072.274  59.3%     -  422s
     0     0 -11164.236    0  588 -27188.186 -11164.236  58.9%     -  438s
     0     0 -11194.627    0  598 -27188.186 -11194.627  58.8%     -  449s
     0     0 -11259.256    0  678 -27188.186 -11259.256  58.6%     -  469s
     0     0 -11271.877    0  605 -27188.186 -11271.877  58.5%     -  476s
     0     0 -11282.060    0  620 -27188.186 -11282.060  58.5%     -  481s
     0     0 -11292.182    0  616 -27188.186 -11292.182  58.5%     -  485s
     0     0 -11294.372    0  624 -27188.186 -11294.372  58.5%     -  487s
     0     0 -11294.962    0  615 -27188.186 -11294.962  58.5%     -  489s
     0     0 -12346.100    0  591 -27188.186 -12346.100  54.6%     -  561s
H    0     0                    -27171.59749 -12346.264  54.6%     -  562s
H    0     0                    -27166.04855 -12346.264  54.6%     -  562s
     0     0 -12605.374    0  607 -27166.049 -12605.374  53.6%     -  602s
     0     0 -12772.651    0  627 -27166.049 -12772.651  53.0%     -  625s
     0     0 -12806.946    0  707 -27166.049 -12806.946  52.9%     -  637s
     0     0 -12823.542    0  632 -27166.049 -12823.542  52.8%     -  645s
     0     0 -12900.537    0  693 -27166.049 -12900.537  52.5%     -  666s
     0     0 -12908.980    0  692 -27166.049 -12908.980  52.5%     -  675s
     0     0 -12913.897    0  693 -27166.049 -12913.897  52.5%     -  683s
     0     0 -12934.802    0  695 -27166.049 -12934.802  52.4%     -  696s
     0     0 -12942.648    0  696 -27166.049 -12942.648  52.4%     -  704s
     0     0 -12943.825    0  704 -27166.049 -12943.825  52.4%     -  707s
     0     0 -13325.226    0  696 -27166.049 -13325.226  50.9%     -  761s
     0     0 -13421.354    0  686 -27166.049 -13421.354  50.6%     -  789s
     0     0 -13451.920    0  639 -27166.049 -13451.920  50.5%     -  806s
H    0     0                    -27160.56782 -13463.908  50.4%     -  819s
H    0     0                    -27155.27882 -13463.908  50.4%     -  819s
     0     0 -13463.908    0  751 -27155.279 -13463.908  50.4%     -  819s
     0     0 -13468.398    0  635 -27155.279 -13468.398  50.4%     -  827s
     0     0 -13471.549    0  630 -27155.279 -13471.549  50.4%     -  831s
H    0     0                    -27150.54883 -13476.676  50.4%     -  840s
H    0     0                    -27146.48468 -13476.676  50.4%     -  840s
H    0     0                    -27143.08323 -13476.676  50.3%     -  840s
H    0     0                    -27136.02536 -13476.676  50.3%     -  840s
H    0     0                    -27131.96121 -13476.676  50.3%     -  840s
H    0     0                    -27131.34550 -13476.676  50.3%     -  840s
     0     0 -13476.676    0  641 -27131.345 -13476.676  50.3%     -  840s
     0     0 -13481.877    0  617 -27131.345 -13481.877  50.3%     -  844s
     0     0 -13484.525    0  646 -27131.345 -13484.525  50.3%     -  848s
     0     0 -13484.954    0  645 -27131.345 -13484.954  50.3%     -  850s
H    0     0                    -27128.84705 -13680.505  49.6%     -  898s
     0     0 -13680.505    0  589 -27128.847 -13680.505  49.6%     -  898s
H    0     0                    -27087.28689 -13680.727  49.5%     -  902s
     0     0 -13761.840    0  612 -27087.287 -13761.840  49.2%     -  919s
     0     0 -13788.093    0  598 -27087.287 -13788.093  49.1%     -  932s
     0     0 -13797.507    0  622 -27087.287 -13797.507  49.1%     -  942s
     0     0 -13801.991    0  617 -27087.287 -13801.991  49.0%     -  947s
     0     0 -13802.531    0  621 -27087.287 -13802.531  49.0%     -  949s
H    0     0                    -27077.11805 -13918.846  48.6%     -  980s
     0     0 -13918.846    0  621 -27077.118 -13918.846  48.6%     -  980s
H    0     0                    -27044.20793 -13941.902  48.4%     -  995s
H    0     0                    -27032.34932 -13941.902  48.4%     -  995s
     0     0 -13941.902    0  787 -27032.349 -13941.902  48.4%     -  995s
     0     0 -13953.716    0  669 -27032.349 -13953.716  48.4%     - 1003s
     0     0 -13962.074    0  671 -27032.349 -13962.074  48.4%     - 1010s
     0     0 -13966.863    0  678 -27032.349 -13966.863  48.3%     - 1018s
     0     0 -13968.930    0  679 -27032.349 -13968.930  48.3%     - 1022s
     0     0 -14076.037    0  647 -27032.349 -14076.037  47.9%     - 1049s
     0     0 -14115.765    0  639 -27032.349 -14115.765  47.8%     - 1069s
     0     0 -14131.957    0  680 -27032.349 -14131.957  47.7%     - 1082s
     0     0 -14144.744    0  702 -27032.349 -14144.744  47.7%     - 1091s
     0     0 -14147.037    0  660 -27032.349 -14147.037  47.7%     - 1095s
     0     0 -14234.797    0  670 -27032.349 -14234.797  47.3%     - 1118s
     0     0 -14259.071    0  633 -27032.349 -14259.071  47.3%     - 1132s
     0     0 -14267.182    0  632 -27032.349 -14267.182  47.2%     - 1143s
     0     0 -14269.860    0  685 -27032.349 -14269.860  47.2%     - 1148s
     0     0 -14270.381    0  688 -27032.349 -14270.381  47.2%     - 1150s
     0     0 -14295.390    0  715 -27032.349 -14295.390  47.1%     - 1161s
     0     0 -14306.548    0  680 -27032.349 -14306.548  47.1%     - 1173s
     0     0 -14314.999    0  706 -27032.349 -14314.999  47.0%     - 1182s
     0     0 -14318.453    0  671 -27032.349 -14318.453  47.0%     - 1187s
     0     0 -14319.311    0  727 -27032.349 -14319.311  47.0%     - 1190s
     0     0 -14334.148    0  687 -27032.349 -14334.148  47.0%     - 1203s
     0     0 -14339.124    0  652 -27032.349 -14339.124  47.0%     - 1211s
     0     0 -14340.214    0  698 -27032.349 -14340.214  47.0%     - 1214s
     0     0 -14346.565    0  647 -27032.349 -14346.565  46.9%     - 1225s
     0     0 -14348.451    0  700 -27032.349 -14348.451  46.9%     - 1246s
     0     0 -14351.322    0  689 -27032.349 -14351.322  46.9%     - 1255s
     0     0 -14351.326    0  689 -27032.349 -14351.326  46.9%     - 1261s
     0     2 -14351.338    0  689 -27032.349 -14351.338  46.9%     - 1375s
     1     3 -14449.700    1  511 -27032.349 -14351.338  46.9%  6968 1386s
     2     4 -14491.151    1  686 -27032.349 -14449.853  46.5%  7476 1398s
     3     5 -14767.708    2  626 -27032.349 -14449.853  46.5%  9171 1413s
     4     8 -14997.858    3  446 -27032.349 -14449.853  46.5%  9927 1431s
     7    14 -15072.474    4  415 -27032.349 -14491.173  46.4%  8713 1453s
    13    26 -15104.553    5  433 -27032.349 -14690.190  45.7%  8729 1499s
    25    38 -15918.553    5  414 -27032.349 -14690.190  45.7% 14003 1547s
    37    67 -15410.279    4  428 -27032.349 -14914.081  44.8% 13577 1778s
    66   170 -15570.175    5  411 -27032.349 -14953.101  44.7% 18048 1833s
   169   273 -15788.117    7  409 -27032.349 -14953.101  44.7% 10686 1859s
   272   350 -17015.992    9  410 -27032.349 -14953.101  44.7%  8277 1881s
   355   383 -17172.322   11  310 -27032.349 -14953.101  44.7%  7842 1904s
   430   394 -24878.065   21  158 -27032.349 -14953.101  44.7%  7268 1923s
   495   424 -18615.593   13  242 -27032.349 -15004.117  44.5%  6967 1940s
   558   431 -24375.126   14  180 -27032.349 -15004.117  44.5%  6887 1954s
   636   438 -21249.857   14  243 -27032.349 -15004.117  44.5%  6507 1971s
   712   423 -21773.221   15  227 -27032.349 -15004.117  44.5%  6339 1987s
   769   429 -22130.895   15  237 -27032.349 -15004.117  44.5%  6249 2002s
   799   427 -25750.219   17  179 -27032.349 -15004.117  44.5%  6382 2019s
   841   433 infeasible   18      -27032.349 -15004.117  44.5%  6338 2047s
   865   445 -23041.185   10  159 -27032.349 -15004.117  44.5%  6451 2066s
   903   454 -19784.297    9  191 -27032.349 -15104.597  44.1%  6524 2094s
   930   473 -22815.478   10  172 -27032.349 -15104.597  44.1%  6614 2124s
   983   505 -22698.829   11  126 -27032.349 -15104.597  44.1%  6615 2142s
  1045   536 -22733.638   12  130 -27032.349 -15104.597  44.1%  6543 2161s
  1111   609 -23170.065   13  108 -27032.349 -15104.597  44.1%  6364 2180s
  1199   688 -23276.660   14  106 -27032.349 -15104.597  44.1%  6039 2198s
  1335   678 -25375.688   16   96 -27032.349 -15104.597  44.1%  5611 2217s
  1462   667     cutoff   15      -27032.349 -15104.597  44.1%  5278 2238s
  1544   669 -25655.431   15   70 -27032.349 -15104.597  44.1%  5194 2260s
  1622   668 infeasible   12      -27032.349 -15104.597  44.1%  5169 2285s
  1669   680 -21619.115    9  255 -27032.349 -15104.597  44.1%  5239 2310s
  1725   716 -22962.164   11  281 -27032.349 -15104.597  44.1%  5271 2336s
  1816   735 -24694.906   14  233 -27032.349 -15104.597  44.1%  5312 2361s
  1920   731 -24991.233   10  186 -27032.349 -15104.597  44.1%  5242 2388s
  2006   745     cutoff   11      -27032.349 -15104.597  44.1%  5247 2416s
  2047   768 infeasible   16      -27032.349 -15104.597  44.1%  5309 2445s
  2125   777     cutoff   15      -27032.349 -15104.597  44.1%  5383 2476s
  2172   798 -22733.525   10  348 -27032.349 -15104.597  44.1%  5546 2507s
  2235   829 -25602.104   22  217 -27032.349 -15104.597  44.1%  5674 2539s
  2327   847 -26224.346   26  206 -27032.349 -15104.597  44.1%  5807 2574s
  2419   854     cutoff   31      -27032.349 -15104.597  44.1%  5893 2608s
  2500   874 -18179.175   11  346 -27032.349 -15104.597  44.1%  6016 2645s
  2574   885 -21684.828   12  260 -27032.349 -15104.597  44.1%  6144 2680s
  2623   896 -22801.365   13  230 -27032.349 -15104.597  44.1%  6292 2716s
  2680   916 -23451.308   14  235 -27032.349 -15104.597  44.1%  6419 2755s
  2758   932     cutoff   15      -27032.349 -15588.306  42.3%  6585 2797s
  2856   946 -23862.439   14  302 -27032.349 -15588.306  42.3%  6733 2843s
  2938   995 -24084.428   16  455 -27032.349 -15588.306  42.3%  6896 2883s
  3089  1026 -24789.212   18  388 -27032.349 -15588.306  42.3%  6973 2927s
  3238  1107 -25107.109   15   86 -27032.349 -15588.306  42.3%  7026 2970s
  3399  1158 -17104.669    8  410 -27032.349 -15588.306  42.3%  7043 3022s
  3599  1191 -18257.443    9  423 -27032.349 -15588.306  42.3%  6971 3073s
  3714  1210 -23922.299   16  363 -27032.349 -15588.306  42.3%  7078 3118s
  3757  1242 -23974.523   17  339 -27032.349 -15588.306  42.3%  7211 3159s
  3799  1264 -24445.092   18  392 -27032.349 -15588.306  42.3%  7348 3208s
  3915  1279 infeasible   18      -27032.349 -15588.306  42.3%  7383 3257s
  3994  1299 -19284.090    9  495 -27032.349 -15588.306  42.3%  7497 3324s
  4091  1346 -22246.741   10  583 -27032.349 -15588.306  42.3%  7603 3384s
  4220  1396 -22717.375   11  601 -27032.349 -15588.306  42.3%  7742 3448s
  4395  1505 -22206.451   10  550 -27032.349 -15588.306  42.3%  7756 3512s
  4582  1585 -24374.097   12  296 -27032.349 -16360.799  39.5%  7797 3578s
  4823  1613 -22381.293   16  212 -27032.349 -16872.902  37.6%  7820 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 192
  MIR: 4632
  Flow cover: 4204
  Zero half: 1
  Mod-K: 1
  RLT: 193
  Relax-and-lift: 1267

Explored 4917 nodes (38958174 simplex iterations) in 3600.05 seconds (8904.70 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -27032.3 -27044.2 -27077.1 ... -27146.5

Time limit reached
Best objective -2.703234932050e+04, best bound -1.687290178038e+04, gap 37.5826%
  WARNING: Time limit reached. Using best solution found (gap: 37.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -27032.35, θ = 94005.73
  Upper Bound (UB) = -27032.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94005.73
  [DEBUG]   ✓ Scenario 0: θ = 94005.73 ≤ Q = 94005.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94005.73 ≤ Q = 94005.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94005.73 ≤ Q = 94005.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94005.73 ≤ Q = 94005.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94005.73 ≤ Q = 94005.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94005.73 ≤ Q = 94005.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94005.73 ≤ Q = 94005.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94005.73 ≤ Q = 94005.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94005.73 ≤ Q = 94005.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 94005.73 ≤ Q = 94005.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 94005.73 ≤ Q = 94005.73 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 94005.73 ≤ Q = 94005.73 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7630b4f2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x89cf4b0e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.081568e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5141958.3857
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.117034e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111703.38    0  120 5141958.39 -111703.38   102%     -    0s
H    0     0                    -78727.41587 -111703.38  41.9%     -    0s
H    0     0                    -79358.85262 -111703.38  40.8%     -    0s
     0     0 -85823.992    0   28 -79358.853 -85823.992  8.15%     -    0s
H    0     0                    -84367.67104 -85746.573  1.63%     -    0s
H    0     0                    -84519.95034 -85746.573  1.45%     -    0s
H    0     0                    -84828.37981 -85746.573  1.08%     -    0s
     0     0 -85285.853    0   23 -84828.380 -85285.853  0.54%     -    0s
     0     0 -85190.470    0   21 -84828.380 -85190.470  0.43%     -    0s
     0     0 -85136.004    0   22 -84828.380 -85136.004  0.36%     -    0s
     0     0 -85134.223    0   22 -84828.380 -85134.223  0.36%     -    0s
     0     0 -85134.223    0   21 -84828.380 -85134.223  0.36%     -    0s
     0     0 -85134.223    0   20 -84828.380 -85134.223  0.36%     -    0s
     0     0 -85134.223    0   20 -84828.380 -85134.223  0.36%     -    0s
     0     0 -85115.051    0   18 -84828.380 -85115.051  0.34%     -    0s
     0     0 -85110.452    0   16 -84828.380 -85110.452  0.33%     -    0s
H    0     0                    -84880.36841 -85110.452  0.27%     -    0s
     0     0 -84924.655    0    5 -84880.368 -84924.655  0.05%     -    0s
     0     0 -84903.659    0    4 -84880.368 -84903.659  0.03%     -    0s
     0     0     cutoff    0      -84880.368 -84880.368  0.00%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 4
  RLT: 1

Explored 1 nodes (488 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -84880.4 -84828.4 -84520 ... 1.08157e+13
No other solutions better than -84880.4

Optimal solution found (tolerance 1.00e-06)
Best objective -8.488036840855e+04, best bound -8.488036840855e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 88561.49
  Scenario: 11 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84880.37
  [DEBUG]   S×d_nominal = 173441.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173441.86 + -84880.37 = 88561.49
  [DEBUG]   Current θ from Master = 94005.73
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5444.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -32476.59
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 1595.2178, Absolute Gap = 1595.2178, Relative Gap = 0.059011
  Not converged yet (gap = 1595.22 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 48 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567444 nonzeros
Model fingerprint: 0x1359bcd9
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94756 rows and 38486 columns
Presolve time: 1.66s
Presolved: 105397 rows, 44894 columns, 639827 nonzeros
Variable types: 42635 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387046.7455
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 566
 AA' NZ     : 4.353e+06
 Factor NZ  : 9.908e+06 (roughly 140 MB of memory)
 Factor Ops : 1.889e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.99804221e+07  1.75037072e+08  3.44e+05 1.80e+01  1.17e+05     3s
   1  -3.50807669e+07  1.84272035e+08  2.94e+05 8.12e+01  9.92e+04     3s
   2  -1.55394735e+07  1.50790743e+08  1.21e+05 4.28e+01  4.18e+04     3s
   3  -8.96686812e+06  1.08253319e+08  6.87e+04 1.20e+01  2.37e+04     3s
   4  -7.93686925e+06  1.07506092e+08  5.54e+04 1.17e+01  1.92e+04     3s
   5  -2.54796986e+06  8.61602602e+07  1.42e+04 4.84e+00  5.17e+03     3s
   6  -1.22108794e+06  6.01563402e+07  4.18e+03 1.69e+00  1.66e+03     3s
   7  -7.64012991e+05  3.03422457e+07  8.23e+02 3.93e-01  4.05e+02     3s
   8  -6.09007147e+05  1.84508746e+07  1.57e+02 1.96e-01  1.41e+02     3s
   9  -4.85152688e+05  1.69684567e+07  9.91e+01 1.20e-01  1.16e+02     3s
  10  -3.22494036e+05  1.03984595e+07  2.13e+01 6.22e-02  5.99e+01     3s
  11  -1.94760575e+05  4.56603289e+06  8.95e+00 3.70e-03  2.57e+01     3s
  12  -1.49148633e+05  1.69123771e+06  6.20e+00 1.31e-03  9.86e+00     3s
  13  -1.48378031e+05  1.40924219e+06  5.70e+00 1.08e-03  8.33e+00     3s
  14  -1.16019103e+05  8.52230169e+05  4.07e+00 6.49e-04  5.14e+00     3s
  15  -7.19456409e+04  4.14195390e+05  2.33e+00 3.16e-04  2.56e+00     3s
  16  -4.89995429e+04  2.03129838e+05  1.38e+00 2.62e-04  1.32e+00     3s
  17  -4.04445828e+04  1.24229201e+05  1.03e+00 2.35e-04  8.60e-01     4s
  18  -3.22339788e+04  6.91410058e+04  7.51e-01 3.89e-04  5.29e-01     4s
  19  -2.59993877e+04  4.97434583e+04  5.74e-01 5.30e-04  3.95e-01     4s
  20  -2.08982925e+04  3.68853440e+04  4.32e-01 4.93e-04  3.01e-01     4s
  21  -1.67584565e+04  2.53960196e+04  3.34e-01 7.31e-04  2.20e-01     4s
  22  -1.40661343e+04  1.95314599e+04  2.79e-01 1.08e-03  1.75e-01     4s
  23  -1.09211515e+04  1.44140765e+04  2.16e-01 2.73e-03  1.32e-01     4s
  24  -8.64245083e+03  1.10669595e+04  1.68e-01 2.46e-03  1.03e-01     4s
  25  -7.14942054e+03  7.88259216e+03  1.38e-01 2.77e-03  7.82e-02     4s
  26  -6.50376012e+03  6.36239979e+03  1.26e-01 2.69e-03  6.70e-02     4s
  27  -5.44824064e+03  5.90165987e+03  1.04e-01 2.44e-03  5.90e-02     4s
  28  -5.04603586e+03  5.36306307e+03  9.54e-02 2.13e-03  5.41e-02     4s
  29  -3.81036815e+03  4.89966553e+03  7.11e-02 1.98e-03  4.53e-02     4s
  30  -3.31126826e+03  4.00035259e+03  6.15e-02 1.86e-03  3.80e-02     4s
  31  -2.67972084e+03  3.50983528e+03  5.03e-02 1.51e-03  3.22e-02     4s
  32  -2.61379515e+03  3.24439380e+03  4.91e-02 1.41e-03  3.05e-02     4s
  33  -2.01770937e+03  2.87919168e+03  3.87e-02 9.66e-04  2.55e-02     4s
  34  -1.74253610e+03  2.70983072e+03  3.36e-02 9.87e-04  2.31e-02     4s
  35  -1.38272737e+03  2.35444537e+03  2.74e-02 8.38e-04  1.94e-02     4s
  36  -9.98620043e+02  1.87561791e+03  2.09e-02 6.96e-04  1.49e-02     4s
  37  -7.51991002e+02  1.28975219e+03  1.68e-02 7.88e-04  1.06e-02     4s
  38  -4.73207730e+02  1.16465515e+03  1.23e-02 6.73e-04  8.51e-03     4s
  39  -3.87839157e+02  9.60036647e+02  1.09e-02 4.97e-04  7.00e-03     4s
  40  -2.32531117e+02  7.93437197e+02  8.52e-03 3.68e-04  5.33e-03     5s
  41  -2.07343052e+02  7.52959770e+02  8.12e-03 3.38e-04  4.99e-03     5s
  42  -6.25513607e+01  6.73487262e+02  5.92e-03 2.45e-04  3.82e-03     5s
  43   2.55204531e+01  6.21419857e+02  4.57e-03 2.09e-04  3.10e-03     5s
  44   6.57770770e+01  5.69601099e+02  3.91e-03 1.73e-04  2.62e-03     5s
  45   1.12991974e+02  4.96000457e+02  3.15e-03 1.25e-04  1.99e-03     5s
  46   1.90077019e+02  4.69687277e+02  2.01e-03 1.05e-04  1.45e-03     5s
  47   2.26382368e+02  4.13966756e+02  1.48e-03 6.22e-05  9.75e-04     5s
  48   2.38790664e+02  4.05493823e+02  1.28e-03 5.57e-05  8.66e-04     5s
  49   2.65893218e+02  3.79244812e+02  8.82e-04 3.71e-05  5.89e-04     5s
  50   3.00688450e+02  3.61550380e+02  3.67e-04 2.36e-05  3.16e-04     5s
  51   3.18843730e+02  3.47482912e+02  1.25e-04 1.31e-05  1.49e-04     5s
  52   3.19209408e+02  3.43779281e+02  1.21e-04 1.03e-05  1.28e-04     5s
  53   3.24582068e+02  3.42192597e+02  5.28e-05 9.16e-06  9.13e-05     5s
  54   3.26486261e+02  3.39362025e+02  2.96e-05 7.14e-06  6.68e-05     5s
  55   3.27189197e+02  3.38260764e+02  2.16e-05 6.33e-06  5.74e-05     5s
  56   3.28230201e+02  3.33785127e+02  1.13e-05 3.03e-06  2.88e-05     5s
  57   3.29053806e+02  3.29709064e+02  2.74e-06 1.44e-06  3.40e-06     5s
  58   3.29374433e+02  3.29404378e+02  5.54e-08 5.40e-08  1.55e-07     5s
  59   3.29386886e+02  3.29386890e+02  1.81e-10 1.37e-09  2.07e-11     6s
  60   3.29386887e+02  3.29386887e+02  1.07e-09 7.41e-10  1.53e-13     6s

Barrier solved model in 60 iterations and 5.54 seconds (10.17 work units)
Optimal objective 3.29386887e+02


Root crossover log...

   85060 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2830 PPushes remaining with PInf 9.4810595e-09                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.8760980e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39757    3.2938689e+02   0.000000e+00   0.000000e+00      7s
   39757    3.2938689e+02   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.293869e+02, 39757 iterations, 5.23 seconds (11.04 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  329.38689    0  435 -217728.64  329.38689   100%     -    7s
H    0     0                    -89710.61756  329.38689   100%     -    8s
H    0     0                    -85900.20526  329.38689   100%     -    8s
H    0     0                    -68077.33468  329.38689   100%     -    8s
H    0     0                    -54788.71442  329.38689   101%     -    8s
H    0     0                    -54699.46256  329.38689   101%     -    8s
H    0     0                    -34149.38327  329.38689   101%     -   10s
H    0     0                    -33965.09708  329.38689   101%     -   10s
     0     0 -3811.8459    0  630 -33965.097 -3811.8459  88.8%     -   71s
H    0     0                    -33762.10065 -3812.0456  88.7%     -   71s
H    0     0                    -33639.17426 -3812.0456  88.7%     -   71s
H    0     0                    -33528.99802 -3812.0456  88.6%     -   71s
H    0     0                    -33526.67014 -3812.0456  88.6%     -   71s
     0     0 -4199.4629    0  640 -33526.670 -4199.4629  87.5%     -   95s
     0     0 -4254.7190    0  714 -33526.670 -4254.7190  87.3%     -  116s
     0     0 -4254.7190    0  730 -33526.670 -4254.7190  87.3%     -  125s
     0     0 -4254.7190    0  729 -33526.670 -4254.7190  87.3%     -  127s
     0     0 -4254.7190    0  729 -33526.670 -4254.7190  87.3%     -  129s
     0     0 -4254.7190    0  718 -33526.670 -4254.7190  87.3%     -  134s
     0     0 -4254.7190    0  726 -33526.670 -4254.7190  87.3%     -  140s
     0     0 -4254.7190    0  732 -33526.670 -4254.7190  87.3%     -  142s
H    0     0                    -27942.36644 -7013.9938  74.9%     -  210s
H    0     0                    -27741.48016 -7013.9938  74.7%     -  210s
     0     0 -7013.9938    0  680 -27741.480 -7013.9938  74.7%     -  210s
H    0     0                    -27736.29417 -7014.0808  74.7%     -  211s
H    0     0                    -27728.49620 -7014.0808  74.7%     -  211s
H    0     0                    -27705.95744 -8297.7622  70.1%     -  291s
H    0     0                    -27663.18241 -8297.7622  70.0%     -  291s
H    0     0                    -27539.72168 -8297.7622  69.9%     -  291s
H    0     0                    -27434.59754 -8297.7622  69.8%     -  291s
H    0     0                    -27427.57400 -8297.7622  69.7%     -  291s
     0     0 -8297.7622    0  759 -27427.574 -8297.7622  69.7%     -  291s
H    0     0                    -27413.99958 -8426.5937  69.3%     -  321s
H    0     0                    -27384.88437 -8426.5937  69.2%     -  321s
     0     0 -8426.5937    0  749 -27384.884 -8426.5937  69.2%     -  322s
     0     0 -8488.1485    0  660 -27384.884 -8488.1485  69.0%     -  339s
     0     0 -8564.3140    0  743 -27384.884 -8564.3140  68.7%     -  353s
     0     0 -8567.6673    0  752 -27384.884 -8567.6673  68.7%     -  359s
     0     0 -8569.5442    0  761 -27384.884 -8569.5442  68.7%     -  362s
     0     0 -8569.8557    0  760 -27384.884 -8569.8557  68.7%     -  364s
H    0     0                    -27356.01844 -8569.8557  68.7%     -  385s
H    0     0                    -27329.96800 -8569.8557  68.6%     -  385s
H    0     0                    -27311.01346 -10848.065  60.3%     -  497s
H    0     0                    -27310.28949 -10848.065  60.3%     -  497s
     0     0 -10848.065    0  665 -27310.289 -10848.065  60.3%     -  498s
H    0     0                    -27303.26595 -10848.085  60.3%     -  498s
H    0     0                    -27302.75020 -11276.053  58.7%     -  547s
     0     0 -11276.053    0  676 -27302.750 -11276.053  58.7%     -  547s
     0     0 -11411.132    0  752 -27302.750 -11411.132  58.2%     -  580s
H    0     0                    -27157.85289 -11478.758  57.7%     -  602s
H    0     0                    -27155.60093 -11478.758  57.7%     -  602s
     0     0 -11478.758    0  746 -27155.601 -11478.758  57.7%     -  602s
     0     0 -11607.778    0  745 -27155.601 -11607.778  57.3%     -  630s
     0     0 -11647.953    0  700 -27155.601 -11647.953  57.1%     -  642s
     0     0 -11698.325    0  687 -27155.601 -11698.325  56.9%     -  656s
     0     0 -11712.188    0  752 -27155.601 -11712.188  56.9%     -  663s
     0     0 -11716.821    0  756 -27155.601 -11716.821  56.9%     -  667s
     0     0 -11724.443    0  757 -27155.601 -11724.443  56.8%     -  671s
     0     0 -11731.823    0  697 -27155.601 -11731.823  56.8%     -  677s
     0     0 -11733.529    0  700 -27155.601 -11733.529  56.8%     -  679s
H    0     0                    -27145.68560 -11733.529  56.8%     -  708s
H    0     0                    -27143.29972 -12489.205  54.0%     -  772s
     0     0 -12489.205    0  583 -27143.300 -12489.205  54.0%     -  772s
H    0     0                    -27143.10096 -13031.374  52.0%     -  824s
     0     0 -13031.374    0  673 -27143.101 -13031.374  52.0%     -  824s
     0     0 -13548.606    0  664 -27143.101 -13548.606  50.1%     -  871s
     0     0 -13632.475    0  634 -27143.101 -13632.475  49.8%     -  896s
     0     0 -13684.836    0  646 -27143.101 -13684.836  49.6%     -  917s
     0     0 -13703.619    0  658 -27143.101 -13703.619  49.5%     -  929s
     0     0 -13720.744    0  699 -27143.101 -13720.744  49.5%     -  945s
     0     0 -13725.710    0  700 -27143.101 -13725.710  49.4%     -  954s
     0     0 -13736.826    0  703 -27143.101 -13736.826  49.4%     -  960s
     0     0 -13738.008    0  708 -27143.101 -13738.008  49.4%     -  964s
     0     0 -14013.967    0  666 -27143.101 -14013.967  48.4%     - 1011s
     0     0 -14134.037    0  732 -27143.101 -14134.037  47.9%     - 1050s
     0     0 -14176.567    0  702 -27143.101 -14176.567  47.8%     - 1070s
H    0     0                    -27128.42513 -14201.056  47.7%     - 1088s
     0     0 -14201.056    0  715 -27128.425 -14201.056  47.7%     - 1088s
H    0     0                    -27124.41911 -14207.158  47.6%     - 1097s
     0     0 -14207.158    0  652 -27124.419 -14207.158  47.6%     - 1097s
     0     0 -14208.916    0  718 -27124.419 -14208.916  47.6%     - 1103s
     0     0 -14460.924    0  764 -27124.419 -14460.924  46.7%     - 1164s
H    0     0                    -27124.21088 -14460.943  46.7%     - 1176s
     0     0 -14508.020    0  779 -27124.211 -14508.020  46.5%     - 1199s
     0     0 -14516.946    0  765 -27124.211 -14516.946  46.5%     - 1210s
     0     0 -14523.294    0  770 -27124.211 -14523.294  46.5%     - 1216s
     0     0 -14533.748    0  774 -27124.211 -14533.748  46.4%     - 1225s
     0     0 -14538.422    0  752 -27124.211 -14538.422  46.4%     - 1231s
     0     0 -14541.963    0  766 -27124.211 -14541.963  46.4%     - 1239s
     0     0 -14543.130    0  773 -27124.211 -14543.130  46.4%     - 1242s
     0     0 -14600.539    0  734 -27124.211 -14600.539  46.2%     - 1270s
     0     0 -14607.549    0  802 -27124.211 -14607.549  46.1%     - 1280s
     0     0 -14631.264    0  780 -27124.211 -14631.264  46.1%     - 1294s
     0     0 -14637.736    0  745 -27124.211 -14637.736  46.0%     - 1302s
     0     0 -14645.478    0  721 -27124.211 -14645.478  46.0%     - 1308s
     0     0 -14649.963    0  732 -27124.211 -14649.963  46.0%     - 1316s
     0     0 -14651.613    0  730 -27124.211 -14651.613  46.0%     - 1322s
     0     0 -14703.249    0  730 -27124.211 -14703.249  45.8%     - 1351s
     0     0 -14713.710    0  733 -27124.211 -14713.710  45.8%     - 1368s
     0     0 -14720.745    0  728 -27124.211 -14720.745  45.7%     - 1378s
     0     0 -14725.646    0  720 -27124.211 -14725.646  45.7%     - 1387s
     0     0 -14726.933    0  722 -27124.211 -14726.933  45.7%     - 1392s
     0     0 -14748.650    0  642 -27124.211 -14748.650  45.6%     - 1410s
     0     0 -14757.861    0  748 -27124.211 -14757.861  45.6%     - 1423s
     0     0 -14759.424    0  741 -27124.211 -14759.424  45.6%     - 1428s
     0     0 -14768.947    0  693 -27124.211 -14768.947  45.6%     - 1444s
     0     0 -14773.433    0  680 -27124.211 -14773.433  45.5%     - 1470s
     0     0 -14775.945    0  680 -27124.211 -14775.945  45.5%     - 1478s
     0     0 -14791.401    0  797 -27124.211 -14791.401  45.5%     - 1496s
     0     0 -14791.453    0  797 -27124.211 -14791.453  45.5%     - 1505s
     0     2 -14791.468    0  797 -27124.211 -14791.468  45.5%     - 1663s
     1     3 -14904.788    1  622 -27124.211 -14791.468  45.5%  7645 1676s
     2     4 -14919.993    1  707 -27124.211 -14904.835  45.0%  8134 1691s
     3     6 -15065.106    2  644 -27124.211 -14904.951  45.0%  8570 1709s
     5     8 -15014.826    2  734 -27124.211 -14920.767  45.0% 11678 1742s
     7    14 -16335.042    3  438 -27124.211 -15014.881  44.6% 13855 1771s
    13    27 -16619.182    4  411 -27124.211 -15015.173  44.6% 14681 1833s
    26    41 -18449.168    5  229 -27124.211 -15042.743  44.5% 23880 1924s
    40    73 -19452.899    6  300 -27124.211 -15085.393  44.4% 23541 2110s
    72   210 -19629.753    7  285 -27124.211 -15159.409  44.1% 22900 2173s
   209   240 -20541.980   10  259 -27124.211 -15159.409  44.1% 12720 2194s
   239   276 -20292.532    9  263 -27124.211 -15159.409  44.1% 11782 2217s
   275   305 -20342.447   10  253 -27124.211 -15159.409  44.1% 10908 2243s
   306   364 -20912.414   11  255 -27124.211 -15159.409  44.1% 10806 2263s
   365   396 -21002.448   12  240 -27124.211 -15159.409  44.1%  9842 2286s
   397   456 -22429.386   13  214 -27124.211 -15159.409  44.1%  9807 2307s
   460   523 -20981.712   12  259 -27124.211 -15159.409  44.1%  9309 2327s
   541   584 -21229.033   13  260 -27124.211 -15159.409  44.1%  8609 2350s
   620   645 -21035.348   13  226 -27124.211 -15159.409  44.1%  8267 2368s
   705   699 -22643.566   15  229 -27124.211 -15159.409  44.1%  7919 2386s
   790   754 -22973.935   15  226 -27124.211 -15159.409  44.1%  7657 2405s
   867   823 -22856.850   16  217 -27124.211 -15159.409  44.1%  7397 2424s
   965   878 -23867.759   17  208 -27124.211 -15159.409  44.1%  7157 2442s
  1084   921 -26074.953   17  205 -27124.211 -15159.409  44.1%  6882 2460s
  1184   939 -26314.995   18  205 -27124.211 -15159.409  44.1%  6644 2479s
  1222   984 infeasible   18      -27124.211 -15159.409  44.1%  6622 2497s
  1327   968 infeasible   19      -27124.211 -15159.409  44.1%  6298 2517s
  1448   960 -25926.678   19  154 -27124.211 -15159.409  44.1%  6031 2539s
  1548  1004 -26071.802   19  187 -27124.211 -15159.409  44.1%  5916 2565s
  1625  1077 infeasible   20      -27124.211 -15159.409  44.1%  5983 2588s
  1769  1189 -21891.165   21  190 -27124.211 -15159.409  44.1%  5943 2611s
  1947  1340 -22989.769   22  261 -27124.211 -15159.409  44.1%  5769 2633s
  2160  1467 infeasible   23      -27124.211 -15159.409  44.1%  5556 2656s
  2421  1559 -24721.825   24  195 -27124.211 -15258.731  43.7%  5215 2682s
  2653  1643 -24831.186   26  258 -27124.211 -15258.731  43.7%  4989 2707s
  2914  1627     cutoff   28      -27124.211 -15258.731  43.7%  4687 2737s
  2997  1681 -26856.773   27  259 -27124.211 -15258.731  43.7%  4679 2765s
  3101  1718 infeasible   28      -27124.211 -15258.731  43.7%  4710 2797s
  3238  1739 -27060.989   29  188 -27124.211 -15258.731  43.7%  4689 2827s
  3330  1758 infeasible   31      -27124.211 -15258.731  43.7%  4686 2858s
  3436  1767 -26834.175   48  149 -27124.211 -15833.908  41.6%  4681 2893s
  3521  1791 -19675.490   13  230 -27124.211 -15833.908  41.6%  4744 2929s
  3620  1838 -19931.338   14  218 -27124.211 -15833.908  41.6%  4784 2967s
  3754  1881 infeasible   36      -27124.211 -15833.908  41.6%  4784 3004s
  3857  1951 -26636.090   61  133 -27124.211 -16114.442  40.6%  4852 3042s
  3992  2029 -17936.137    9  478 -27124.211 -16114.442  40.6%  4902 3079s
  4176  2052 -18063.519   10  425 -27124.211 -16114.442  40.6%  4927 3117s
  4277  2113 -25302.057   25  227 -27124.211 -16252.714  40.1%  4968 3159s
  4415  2149 -20861.561   11  322 -27124.211 -16252.714  40.1%  5018 3201s
  4519  2204 -21325.070   12  292 -27124.211 -16252.714  40.1%  5124 3247s
  4694  2263 -22457.399   13  287 -27124.211 -16252.714  40.1%  5162 3296s
  4831  2322 infeasible   14      -27124.211 -16873.424  37.8%  5239 3347s
  4963  2378 -24935.016   16  355 -27124.211 -16873.615  37.8%  5357 3394s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 322
  MIR: 5684
  Flow cover: 4771
  Zero half: 6
  RLT: 272
  Relax-and-lift: 1648

Explored 5097 nodes (28944516 simplex iterations) in 3600.03 seconds (8371.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -27124.2 -27124.4 -27128.4 ... -27303.3

Time limit reached
Best objective -2.712421088057e+04, best bound -1.687361490299e+04, gap 37.7913%
  WARNING: Time limit reached. Using best solution found (gap: 37.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -27124.21, θ = 94005.48
  Upper Bound (UB) = -27124.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94005.48
  [DEBUG]   ✓ Scenario 0: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94005.48 ≤ Q = 94005.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94005.48 ≤ Q = 94005.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 94005.48 ≤ Q = 94005.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1ccc8915
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1ccc8915
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.081568e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5138197.2488
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.119334e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111933.36    0  120 5138197.25 -111933.36   102%     -    0s
H    0     0                    -78930.31858 -111933.36  41.8%     -    0s
H    0     0                    -79154.97364 -111933.36  41.4%     -    0s
     0     0 -85484.737    0   31 -79154.974 -85484.737  8.00%     -    0s
H    0     0                    -83987.58645 -85397.453  1.68%     -    0s
H    0     0                    -84139.86575 -85397.453  1.49%     -    0s
H    0     0                    -84200.75435 -85397.453  1.42%     -    0s
     0     0 -84957.686    0   25 -84200.754 -84957.686  0.90%     -    0s
H    0     0                    -84489.35870 -84939.733  0.53%     -    0s
     0     0 -84848.349    0   17 -84489.359 -84848.349  0.42%     -    0s
     0     0 -84792.308    0   15 -84489.359 -84792.308  0.36%     -    0s
     0     0 -84698.257    0    9 -84489.359 -84698.257  0.25%     -    0s
     0     0 -84619.047    0    7 -84489.359 -84619.047  0.15%     -    0s
     0     0 -84569.988    0    6 -84489.359 -84569.988  0.10%     -    0s
     0     0 -84565.442    0    6 -84489.359 -84565.442  0.09%     -    0s
     0     0 -84565.442    0   14 -84489.359 -84565.442  0.09%     -    0s
H    0     0                    -84509.42246 -84565.442  0.07%     -    0s
*    0     0               0    -84559.01486 -84559.015  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 12
  Flow cover: 2
  RLT: 2
  PSD: 2

Explored 1 nodes (515 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -84559 -84509.4 -84489.4 ... 1.08157e+13
No other solutions better than -84559

Optimal solution found (tolerance 1.00e-06)
Best objective -8.455901485598e+04, best bound -8.455901485598e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 89134.17
  Scenario: 11 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84559.01
  [DEBUG]   S×d_nominal = 173693.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173693.19 + -84559.01 = 89134.17
  [DEBUG]   Current θ from Master = 94005.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4871.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -31995.52
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 1503.3563, Absolute Gap = 1503.3563, Relative Gap = 0.055425
  Not converged yet (gap = 1503.36 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 48 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610669 nonzeros
Model fingerprint: 0x033d4857
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 102048 rows and 41448 columns
Presolve time: 2.00s
Presolved: 113395 rows, 48172 columns, 686459 nonzeros
Variable types: 45913 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -386794.9215
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.27s

Barrier statistics:
 Dense cols : 563
 AA' NZ     : 4.907e+06
 Factor NZ  : 1.137e+07 (roughly 160 MB of memory)
 Factor Ops : 2.279e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.00297468e+07  1.86508384e+08  3.45e+05 1.63e+01  1.16e+05     3s
   1  -3.52738091e+07  1.95659863e+08  2.97e+05 7.78e+01  9.94e+04     3s
   2  -2.08373472e+07  1.63465940e+08  1.66e+05 4.38e+01  5.64e+04     3s
   3  -9.83498764e+06  1.16628702e+08  7.56e+04 9.87e+00  2.58e+04     4s
   4  -6.46338160e+06  1.15322573e+08  4.55e+04 9.39e+00  1.58e+04     4s
   5  -2.05736783e+06  8.43404851e+07  1.10e+04 2.75e+00  3.99e+03     4s
   6  -9.61884984e+05  4.55438846e+07  2.54e+03 2.09e-01  1.01e+03     4s
   7  -6.63567044e+05  2.18290951e+07  5.86e+02 4.64e-02  2.72e+02     4s
   8  -3.64112139e+05  1.28970158e+07  2.48e+02 3.24e-02  1.26e+02     4s
   9  -3.72186317e+05  1.06807315e+07  2.10e+02 2.55e-02  1.03e+02     4s
  10  -1.87947949e+05  6.51750669e+06  9.18e+01 1.26e-02  5.02e+01     4s
  11  -1.43174551e+05  3.36427583e+06  3.18e+01 4.94e-03  2.13e+01     4s
  12  -9.75160203e+04  1.58850808e+06  1.10e+01 1.66e-03  9.02e+00     4s
  13  -7.06404927e+04  6.51073680e+05  6.40e+00 6.49e-04  3.73e+00     4s
  14  -5.92387086e+04  4.01138066e+05  5.21e+00 6.09e-04  2.36e+00     4s
  15  -5.26670110e+04  2.60192293e+05  4.45e+00 3.41e-04  1.59e+00     4s
  16  -4.14220505e+04  9.09995891e+04  2.90e+00 5.15e-04  6.63e-01     4s
  17  -3.52322391e+04  5.34223755e+04  2.19e+00 8.50e-04  4.41e-01     4s
  18  -2.54402937e+04  3.39906269e+04  1.28e+00 5.77e-04  2.93e-01     4s
  19  -2.20356434e+04  2.38215873e+04  1.07e+00 1.56e-03  2.25e-01     4s
  20  -1.74577628e+04  1.77647183e+04  8.11e-01 1.39e-03  1.73e-01     4s
  21  -1.39391233e+04  1.14097216e+04  6.28e-01 1.50e-03  1.24e-01     4s
  22  -1.08249559e+04  8.87037529e+03  4.87e-01 1.36e-03  9.64e-02     4s
  23  -9.85253317e+03  5.85885339e+03  4.38e-01 2.12e-03  7.69e-02     4s
  24  -8.52403167e+03  4.73918163e+03  3.82e-01 3.17e-03  6.49e-02     4s
  25  -6.86785259e+03  3.65214411e+03  3.08e-01 4.05e-03  5.15e-02     5s
  26  -5.44508322e+03  2.95771848e+03  2.42e-01 3.36e-03  4.11e-02     5s
  27  -4.92239801e+03  2.56437854e+03  2.19e-01 2.61e-03  3.66e-02     5s
  28  -4.18362244e+03  2.00632896e+03  1.85e-01 2.71e-03  3.03e-02     5s
  29  -3.62458001e+03  1.54487574e+03  1.62e-01 1.54e-03  2.53e-02     5s
  30  -3.18385396e+03  1.37392923e+03  1.44e-01 1.27e-03  2.23e-02     5s
  31  -2.26502323e+03  1.22257964e+03  1.07e-01 1.06e-03  1.70e-02     5s
  32  -1.87644511e+03  1.14234179e+03  9.09e-02 1.02e-03  1.47e-02     5s
  33  -1.59705230e+03  9.36514753e+02  7.88e-02 7.80e-04  1.24e-02     5s
  34  -1.25354987e+03  8.87685368e+02  6.48e-02 7.54e-04  1.05e-02     5s
  35  -1.06015650e+03  7.55379103e+02  5.67e-02 8.37e-04  8.87e-03     5s
  36  -7.45801202e+02  6.85495084e+02  4.37e-02 8.94e-04  6.99e-03     5s
  37  -6.62000607e+02  6.49951008e+02  4.04e-02 7.38e-04  6.41e-03     5s
  38  -6.13698840e+02  6.15687572e+02  3.84e-02 6.19e-04  6.00e-03     5s
  39  -4.37732316e+02  5.64080760e+02  3.16e-02 6.09e-04  4.89e-03     5s
  40  -3.34145228e+02  5.35992176e+02  2.75e-02 5.96e-04  4.25e-03     5s
  41  -1.79783527e+02  5.21258411e+02  2.15e-02 5.58e-04  3.42e-03     5s
  42  -1.30454290e+02  4.99239566e+02  1.97e-02 4.80e-04  3.07e-03     5s
  43  -5.40150767e+01  4.80685761e+02  1.67e-02 4.12e-04  2.61e-03     5s
  44  -2.13992152e+01  4.72259811e+02  1.54e-02 3.87e-04  2.41e-03     5s
  45   4.73416540e-01  4.63017002e+02  1.45e-02 4.10e-04  2.26e-03     5s
  46   7.37466968e+01  4.51729645e+02  1.17e-02 3.54e-04  1.84e-03     5s
  47   1.32751447e+02  4.39817374e+02  9.40e-03 4.80e-04  1.50e-03     6s
  48   1.45113586e+02  4.25032030e+02  8.91e-03 3.18e-04  1.37e-03     6s
  49   1.99875943e+02  4.15149219e+02  6.78e-03 2.46e-04  1.05e-03     6s
  50   2.22023974e+02  4.13436114e+02  5.96e-03 2.33e-04  9.34e-04     6s
  51   2.48997409e+02  3.97702079e+02  4.91e-03 1.17e-04  7.26e-04     6s
  52   2.79651966e+02  3.94817809e+02  3.71e-03 9.78e-05  5.62e-04     6s
  53   2.85279573e+02  3.92506388e+02  3.49e-03 8.48e-05  5.24e-04     6s
  54   3.07450941e+02  3.89947286e+02  2.65e-03 1.09e-04  4.03e-04     6s
  55   3.17631473e+02  3.88503764e+02  2.25e-03 9.20e-05  3.46e-04     6s
  56   3.27725895e+02  3.87119497e+02  1.86e-03 8.40e-05  2.90e-04     6s
  57   3.47930154e+02  3.85105661e+02  1.10e-03 7.07e-05  1.81e-04     6s
  58   3.58120884e+02  3.83199900e+02  7.18e-04 4.90e-05  1.22e-04     6s
  59   3.61792326e+02  3.81408619e+02  5.85e-04 3.29e-05  9.57e-05     6s
  60   3.62443955e+02  3.80806531e+02  5.59e-04 2.74e-05  8.96e-05     6s
  61   3.65679580e+02  3.80234413e+02  4.36e-04 2.25e-05  7.10e-05     6s
  62   3.69237404e+02  3.79947651e+02  3.06e-04 2.00e-05  5.22e-05     6s
  63   3.69542304e+02  3.79852841e+02  2.95e-04 1.92e-05  5.03e-05     6s
  64   3.72380406e+02  3.79582587e+02  1.90e-04 1.67e-05  3.51e-05     7s
  65   3.73566553e+02  3.78150823e+02  1.49e-04 3.47e-06  2.24e-05     7s
  66   3.77425070e+02  3.78018658e+02  8.47e-06 2.10e-06  2.88e-06     7s
  67   3.77700681e+02  3.77782526e+02  1.59e-06 9.82e-08  3.97e-07     7s
  68   3.77734958e+02  3.77779884e+02  7.47e-07 8.10e-08  2.18e-07     7s
  69   3.77743709e+02  3.77779414e+02  5.54e-07 7.64e-08  1.73e-07     7s
  70   3.77754892e+02  3.77775753e+02  3.17e-07 1.24e-07  1.01e-07     7s
  71   3.77755136e+02  3.77775653e+02  4.84e-07 1.22e-07  9.94e-08     7s
  72   3.77765081e+02  3.77768907e+02  1.33e-07 3.62e-10  1.86e-08     7s
  73   3.77765912e+02  3.77768893e+02  9.79e-07 7.95e-10  1.44e-08     7s
  74   3.77768690e+02  3.77768867e+02  3.07e-07 1.57e-10  7.94e-10     7s
  75   3.77768858e+02  3.77768867e+02  1.27e-07 1.15e-09  9.67e-11     7s
  76   3.77768863e+02  3.77768867e+02  6.37e-08 5.88e-10  4.85e-11     7s
  77   3.77768866e+02  3.77768867e+02  3.36e-08 6.42e-10  3.43e-12     7s

Barrier solved model in 77 iterations and 7.27 seconds (13.52 work units)
Optimal objective 3.77768866e+02


Root crossover log...

   90502 DPushes remaining with DInf 0.0000000e+00                 7s
     753 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    3033 PPushes remaining with PInf 8.5642275e-07                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.8515320e-11     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42718    3.7776887e+02   0.000000e+00   0.000000e+00     10s
   42718    3.7776887e+02   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 1.06s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 3.777689e+02, 42718 iterations, 8.93 seconds (17.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  377.76887    0  469 -217728.64  377.76887   100%     -   12s
H    0     0                    -83006.31972  377.76887   100%     -   12s
H    0     0                    -82978.98210  377.76887   100%     -   12s
H    0     0                    -58846.89510  377.76887   101%     -   12s
H    0     0                    -58140.45331  377.76887   101%     -   12s
H    0     0                    -57986.44352  377.76887   101%     -   13s
H    0     0                    -57869.61096  377.76887   101%     -   13s
H    0     0                    -57739.57100  377.76887   101%     -   13s
H    0     0                    -55279.08287 -3517.0864  93.6%     -   80s
H    0     0                    -54786.39976 -3517.0864  93.6%     -   80s
H    0     0                    -54391.76800 -3517.0864  93.5%     -   80s
H    0     0                    -54377.04529 -3517.0864  93.5%     -   80s
H    0     0                    -54376.07315 -3517.0864  93.5%     -   80s
     0     0 -3517.0864    0  744 -54376.073 -3517.0864  93.5%     -   80s
H    0     0                    -54083.87100 -3517.4037  93.5%     -   81s
H    0     0                    -54082.07319 -3517.4037  93.5%     -   81s
H    0     0                    -54068.73211 -3517.4037  93.5%     -   81s
H    0     0                    -54048.37818 -3517.4037  93.5%     -   81s
     0     0 -3987.1763    0  766 -54048.378 -3987.1763  92.6%     -  113s
     0     0 -4081.8274    0  806 -54048.378 -4081.8274  92.4%     -  124s
     0     0 -4084.1760    0  801 -54048.378 -4084.1760  92.4%     -  133s
     0     0 -4084.1760    0  779 -54048.378 -4084.1760  92.4%     -  143s
     0     0 -4084.1760    0  779 -54048.378 -4084.1760  92.4%     -  148s
     0     0 -4084.1760    0  783 -54048.378 -4084.1760  92.4%     -  150s
     0     0 -4084.1760    0  783 -54048.378 -4084.1760  92.4%     -  152s
     0     0 -4084.1760    0  786 -54048.378 -4084.1760  92.4%     -  154s
     0     0 -4084.1760    0  786 -54048.378 -4084.1760  92.4%     -  158s
     0     0 -4084.1760    0  788 -54048.378 -4084.1760  92.4%     -  160s
     0     0 -4084.1760    0  794 -54048.378 -4084.1760  92.4%     -  162s
     0     0 -4084.1760    0  793 -54048.378 -4084.1760  92.4%     -  162s
H    0     0                    -33467.03271 -6860.2894  79.5%     -  257s
H    0     0                    -33084.61975 -6860.2894  79.3%     -  257s
     0     0 -6860.2894    0  739 -33084.620 -6860.2894  79.3%     -  258s
H    0     0                    -28072.03385 -6860.3580  75.6%     -  258s
H    0     0                    -27833.75285 -6860.3580  75.4%     -  258s
H    0     0                    -27815.27764 -6860.3580  75.3%     -  258s
H    0     0                    -27809.42006 -6860.3580  75.3%     -  258s
H    0     0                    -27790.94485 -6860.3580  75.3%     -  258s
H    0     0                    -27786.99265 -6860.3580  75.3%     -  258s
H    0     0                    -27621.82116 -8030.1110  70.9%     -  333s
H    0     0                    -27506.96640 -8030.1110  70.8%     -  333s
H    0     0                    -27502.96037 -8030.1110  70.8%     -  333s
     0     0 -8030.1110    0  832 -27502.960 -8030.1110  70.8%     -  333s
     0     0 -8212.8546    0  746 -27502.960 -8212.8546  70.1%     -  357s
     0     0 -8438.9382    0  728 -27502.960 -8438.9382  69.3%     -  391s
     0     0 -8523.2588    0  716 -27502.960 -8523.2588  69.0%     -  400s
     0     0 -8528.8007    0  713 -27502.960 -8528.8007  69.0%     -  405s
     0     0 -8541.4752    0  712 -27502.960 -8541.4752  68.9%     -  412s
     0     0 -8549.0790    0  709 -27502.960 -8549.0790  68.9%     -  418s
     0     0 -8552.3405    0  715 -27502.960 -8552.3405  68.9%     -  421s
     0     0 -8556.0878    0  712 -27502.960 -8556.0878  68.9%     -  423s
     0     0 -8558.8197    0  726 -27502.960 -8558.8197  68.9%     -  427s
     0     0 -8563.9053    0  734 -27502.960 -8563.9053  68.9%     -  430s
     0     0 -8567.0003    0  748 -27502.960 -8567.0003  68.9%     -  432s
     0     0 -8572.4439    0  737 -27502.960 -8572.4439  68.8%     -  435s
     0     0 -8573.6007    0  670 -27502.960 -8573.6007  68.8%     -  437s
     0     0 -8573.8531    0  669 -27502.960 -8573.8531  68.8%     -  439s
H    0     0                    -27414.50351 -10640.122  61.2%     -  584s
     0     0 -10640.122    0  724 -27414.504 -10640.122  61.2%     -  584s
H    0     0                    -27411.83839 -10640.187  61.2%     -  584s
H    0     0                    -27411.32264 -10640.187  61.2%     -  584s
H    0     0                    -27411.11442 -10640.187  61.2%     -  584s
H    0     0                    -27403.44729 -11390.967  58.4%     -  669s
H    0     0                    -27400.37203 -11390.967  58.4%     -  669s
H    0     0                    -27398.71730 -11390.967  58.4%     -  669s
H    0     0                    -27388.62477 -11390.967  58.4%     -  669s
H    0     0                    -27388.20642 -11390.967  58.4%     -  669s
H    0     0                    -27386.04013 -11390.967  58.4%     -  669s
     0     0 -11390.967    0  737 -27386.040 -11390.967  58.4%     -  669s
H    0     0                    -27381.18940 -11796.139  56.9%     -  738s
H    0     0                    -27380.47011 -11796.139  56.9%     -  738s
H    0     0                    -27378.71401 -11796.139  56.9%     -  738s
H    0     0                    -27255.47471 -11796.139  56.7%     -  738s
H    0     0                    -27227.14341 -11796.139  56.7%     -  738s
H    0     0                    -27223.98250 -11796.139  56.7%     -  738s
H    0     0                    -27222.62164 -11796.139  56.7%     -  738s
H    0     0                    -27202.66303 -11796.139  56.6%     -  738s
H    0     0                    -27191.85659 -11796.139  56.6%     -  738s
H    0     0                    -27187.18390 -11796.139  56.6%     -  738s
     0     0 -11796.139    0  696 -27187.184 -11796.139  56.6%     -  738s
H    0     0                    -27186.59440 -11913.469  56.2%     -  777s
H    0     0                    -27177.80025 -11913.469  56.2%     -  777s
     0     0 -11913.469    0  765 -27177.800 -11913.469  56.2%     -  778s
     0     0 -11973.450    0  750 -27177.800 -11973.450  55.9%     -  799s
     0     0 -12011.209    0  756 -27177.800 -12011.209  55.8%     -  814s
     0     0 -12034.132    0  747 -27177.800 -12034.132  55.7%     -  827s
     0     0 -12039.902    0  763 -27177.800 -12039.902  55.7%     -  834s
     0     0 -12057.563    0  764 -27177.800 -12057.563  55.6%     -  846s
     0     0 -12060.551    0  773 -27177.800 -12060.551  55.6%     -  852s
     0     0 -12076.622    0  757 -27177.800 -12076.622  55.6%     -  860s
     0     0 -12094.436    0  704 -27177.800 -12094.436  55.5%     -  870s
     0     0 -12099.717    0  738 -27177.800 -12099.717  55.5%     -  875s
     0     0 -12103.033    0  743 -27177.800 -12103.033  55.5%     -  879s
     0     0 -12104.256    0  741 -27177.800 -12104.256  55.5%     -  882s
     0     0 -13782.886    0  697 -27177.800 -13782.886  49.3%     -  998s
     0     0 -14038.493    0  723 -27177.800 -14038.493  48.3%     - 1053s
H    0     0                    -27174.05421 -14255.461  47.5%     - 1095s
     0     0 -14255.461    0  808 -27174.054 -14255.461  47.5%     - 1095s
     0     0 -14289.327    0  800 -27174.054 -14289.327  47.4%     - 1114s
     0     0 -14309.743    0  745 -27174.054 -14309.743  47.3%     - 1126s
     0     0 -14328.060    0  804 -27174.054 -14328.060  47.3%     - 1141s
     0     0 -14339.044    0  742 -27174.054 -14339.044  47.2%     - 1150s
     0     0 -14341.589    0  744 -27174.054 -14341.589  47.2%     - 1157s
     0     0 -14699.728    0  762 -27174.054 -14699.728  45.9%     - 1226s
     0     0 -14791.153    0  787 -27174.054 -14791.153  45.6%     - 1261s
     0     0 -14826.696    0  769 -27174.054 -14826.696  45.4%     - 1285s
     0     0 -14877.217    0  699 -27174.054 -14877.217  45.3%     - 1308s
     0     0 -14899.222    0  759 -27174.054 -14899.222  45.2%     - 1326s
     0     0 -14904.537    0  776 -27174.054 -14904.537  45.2%     - 1335s
     0     0 -14908.474    0  771 -27174.054 -14908.474  45.1%     - 1341s
     0     0 -14923.666    0  765 -27174.054 -14923.666  45.1%     - 1351s
     0     0 -14926.820    0  760 -27174.054 -14926.820  45.1%     - 1356s
     0     0 -14930.301    0  702 -27174.054 -14930.301  45.1%     - 1364s
     0     0 -14931.522    0  711 -27174.054 -14931.522  45.1%     - 1369s
     0     0 -15126.099    0  697 -27174.054 -15126.099  44.3%     - 1410s
     0     0 -15159.263    0  756 -27174.054 -15159.263  44.2%     - 1426s
     0     0 -15173.528    0  691 -27174.054 -15173.528  44.2%     - 1442s
     0     0 -15182.116    0  708 -27174.054 -15182.116  44.1%     - 1451s
     0     0 -15186.355    0  771 -27174.054 -15186.355  44.1%     - 1456s
     0     0 -15187.743    0  778 -27174.054 -15187.743  44.1%     - 1459s
     0     0 -15298.265    0  747 -27174.054 -15298.265  43.7%     - 1495s
     0     0 -15342.016    0  702 -27174.054 -15342.016  43.5%     - 1519s
     0     0 -15359.436    0  769 -27174.054 -15359.436  43.5%     - 1534s
     0     0 -15365.419    0  765 -27174.054 -15365.419  43.5%     - 1543s
     0     0 -15366.680    0  711 -27174.054 -15366.680  43.5%     - 1547s
     0     0 -15433.384    0  820 -27174.054 -15433.384  43.2%     - 1579s
     0     0 -15453.711    0  762 -27174.054 -15453.711  43.1%     - 1597s
     0     0 -15460.264    0  790 -27174.054 -15460.264  43.1%     - 1610s
     0     0 -15465.216    0  795 -27174.054 -15465.216  43.1%     - 1620s
     0     0 -15471.287    0  834 -27174.054 -15471.287  43.1%     - 1629s
     0     0 -15472.220    0  776 -27174.054 -15472.220  43.1%     - 1632s
     0     0 -15490.069    0  781 -27174.054 -15490.069  43.0%     - 1649s
     0     0 -15494.448    0  758 -27174.054 -15494.448  43.0%     - 1657s
     0     0 -15496.312    0  786 -27174.054 -15496.312  43.0%     - 1662s
     0     0 -15508.306    0  777 -27174.054 -15508.306  42.9%     - 1677s
     0     0 -15511.790    0  787 -27174.054 -15511.790  42.9%     - 1687s
     0     0 -15513.887    0  649 -27174.054 -15513.887  42.9%     - 1697s
     0     0 -15520.103    0  649 -27174.054 -15520.103  42.9%     - 1709s
     0     0 -15523.951    0  653 -27174.054 -15523.951  42.9%     - 1723s
     0     0 -15527.865    0  656 -27174.054 -15527.865  42.9%     - 1733s
     0     0 -15528.997    0  671 -27174.054 -15528.997  42.9%     - 1738s
     0     0 -15542.842    0  667 -27174.054 -15542.842  42.8%     - 1755s
     0     0 -15542.975    0  667 -27174.054 -15542.975  42.8%     - 1764s
     0     2 -15542.975    0  667 -27174.054 -15542.975  42.8%     - 1965s
     1     4 -15644.181    1  697 -27174.054 -15542.975  42.8% 13621 1986s
     3     8 -15705.327    2  697 -27174.054 -15644.300  42.4% 12498 2039s
     7    14 -16205.184    3  614 -27174.054 -15705.331  42.2% 17042 2093s
    13    28 -18120.925    4  322 -27174.054 -15705.416  42.2% 21559 2143s
    27    40 -16275.882    4  547 -27174.054 -15916.194  41.4% 25806 3600s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 125
  MIR: 5126
  Flow cover: 3701
  Zero half: 4
  RLT: 263
  Relax-and-lift: 1311

Explored 39 nodes (2380443 simplex iterations) in 3600.09 seconds (6617.55 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -27174.1 -27177.8 -27186.6 ... -27255.5

Time limit reached
Best objective -2.717405420975e+04, best bound -1.591619438489e+04, gap 41.4287%
  WARNING: Time limit reached. Using best solution found (gap: 41.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -27174.05, θ = 93766.56
  Upper Bound (UB) = -27174.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93766.56
  [DEBUG]   ✓ Scenario 0: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93766.56 ≤ Q = 93766.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93766.56 ≤ Q = 93766.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93766.56 ≤ Q = 93766.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93766.56 ≤ Q = 93766.56 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x63864752
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9c79b8ae
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.081943e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5154846.7927
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.124562e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112456.15    0  120 5154846.79 -112456.15   102%     -    0s
H    0     0                    -79371.06356 -112456.15  41.7%     -    0s
H    0     0                    -80044.91870 -112456.15  40.5%     -    0s
     0     0 -84267.375    0   63 -80044.919 -84267.375  5.28%     -    0s
H    0     0                    -83095.16077 -84261.743  1.40%     -    0s
     0     0 -83787.353    0   23 -83095.161 -83787.353  0.83%     -    0s
H    0     0                    -83288.51397 -83723.290  0.52%     -    0s
     0     0 -83710.138    0   13 -83288.514 -83710.138  0.51%     -    0s
     0     0 -83676.285    0   20 -83288.514 -83676.285  0.47%     -    0s
     0     0 -83416.642    0    4 -83288.514 -83416.642  0.15%     -    0s
H    0     0                    -83306.23314 -83415.578  0.13%     -    0s
     0     0 -83415.578    0    4 -83306.233 -83415.578  0.13%     -    0s
     0     0 -83400.344    0    3 -83306.233 -83400.344  0.11%     -    0s
     0     0 -83400.344    0   40 -83306.233 -83400.344  0.11%     -    0s
*    0     0               0    -83390.60011 -83390.600  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 11
  MIR: 38
  Flow cover: 3
  RLT: 2

Explored 1 nodes (580 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -83390.6 -83306.2 -83288.5 ... 1.08194e+13
No other solutions better than -83390.6

Optimal solution found (tolerance 1.00e-06)
Best objective -8.339060011040e+04, best bound -8.339060011040e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 90498.16
  Scenario: 10 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83390.60
  [DEBUG]   S×d_nominal = 173888.76
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173888.76 + -83390.60 = 90498.16
  [DEBUG]   Current θ from Master = 93766.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3268.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30442.46
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 1453.5129, Absolute Gap = 1453.5129, Relative Gap = 0.053489
  Not converged yet (gap = 1453.51 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 49 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653894 nonzeros
Model fingerprint: 0x6d854e54
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 109360 rows and 44420 columns
Presolve time: 1.98s
Presolved: 121373 rows, 51440 columns, 748468 nonzeros
Variable types: 49181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387251.2280
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 580
 AA' NZ     : 6.020e+06
 Factor NZ  : 1.327e+07 (roughly 180 MB of memory)
 Factor Ops : 2.839e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.00718968e+07  1.97099461e+08  3.44e+05 1.98e+01  1.16e+05     4s
   1  -3.54447818e+07  2.05551643e+08  2.97e+05 7.27e+01  9.90e+04     4s
   2  -1.90632986e+07  1.71030184e+08  1.51e+05 3.90e+01  5.12e+04     4s
   3  -1.02509708e+07  1.20073905e+08  8.00e+04 8.99e+00  2.72e+04     4s
   4  -7.68703493e+06  1.18800469e+08  5.43e+04 8.54e+00  1.86e+04     4s
   5  -2.38369632e+06  7.83702913e+07  1.33e+04 1.29e+00  4.67e+03     4s
   6  -8.74625157e+05  5.46136387e+07  1.70e+03 4.04e-01  7.83e+02     4s
   7  -7.10959486e+05  2.58944238e+07  5.94e+02 1.39e-01  2.87e+02     4s
   8  -6.07528342e+05  2.04810791e+07  1.96e+02 1.03e-01  1.48e+02     4s
   9  -5.49979253e+05  1.75953066e+07  1.69e+02 8.53e-02  1.25e+02     4s
  10  -2.92716314e+05  1.17836624e+07  5.65e+01 5.19e-02  6.70e+01     4s
  11  -2.09605644e+05  6.18907435e+06  3.50e+01 2.39e-02  3.43e+01     4s
  12  -1.64969814e+05  4.53610911e+06  2.14e+01 1.72e-02  2.39e+01     4s
  13  -1.51606709e+05  2.92099556e+06  1.48e+01 1.05e-02  1.52e+01     4s
  14  -1.15366155e+05  1.88854779e+06  5.76e+00 6.81e-03  9.41e+00     4s
  15  -9.46078297e+04  1.12153158e+06  3.09e+00 4.03e-03  5.61e+00     4s
  16  -8.13958078e+04  3.25324892e+05  2.03e+00 1.17e-03  1.87e+00     4s
  17  -6.62837941e+04  1.63718375e+05  1.33e+00 6.18e-04  1.05e+00     4s
  18  -5.12449427e+04  1.04971472e+05  8.83e-01 1.05e-03  7.12e-01     4s
  19  -4.18428404e+04  6.78843185e+04  6.91e-01 1.41e-03  5.00e-01     5s
  20  -3.25887793e+04  4.73828532e+04  5.27e-01 1.50e-03  3.64e-01     5s
  21  -2.54079714e+04  2.76956921e+04  3.95e-01 1.87e-03  2.42e-01     5s
  22  -2.22422273e+04  2.33669945e+04  3.26e-01 1.91e-03  2.08e-01     5s
  23  -1.86353216e+04  1.43881768e+04  2.51e-01 2.42e-03  1.50e-01     5s
  24  -1.65928423e+04  8.00978222e+03  2.09e-01 2.99e-03  1.12e-01     5s
  25  -1.44268135e+04  5.46365422e+03  1.67e-01 3.13e-03  9.06e-02     5s
  26  -1.26144453e+04  2.90362236e+03  1.32e-01 3.12e-03  7.07e-02     5s
  27  -1.13163744e+04  1.33975276e+03  1.09e-01 2.30e-03  5.77e-02     5s
  28  -1.00268991e+04  3.89721628e+02  8.75e-02 1.87e-03  4.75e-02     5s
  29  -9.03484540e+03 -8.47497519e+02  7.08e-02 1.38e-03  3.73e-02     5s
  30  -7.77911486e+03 -1.81252435e+03  5.05e-02 1.59e-03  2.72e-02     5s
  31  -7.10961293e+03 -2.61553107e+03  4.00e-02 1.78e-03  2.05e-02     5s
  32  -6.62162335e+03 -3.10377884e+03  3.25e-02 1.37e-03  1.60e-02     5s
  33  -5.96826106e+03 -3.55597440e+03  2.26e-02 1.48e-03  1.10e-02     5s
  34  -5.58987656e+03 -3.83176954e+03  1.68e-02 1.27e-03  8.02e-03     5s
  35  -5.27882383e+03 -4.04171205e+03  1.22e-02 8.67e-04  5.64e-03     6s
  36  -5.05821825e+03 -4.13333107e+03  8.93e-03 6.42e-04  4.22e-03     6s
  37  -4.92523030e+03 -4.25111435e+03  6.94e-03 3.92e-04  3.08e-03     6s
  38  -4.74414612e+03 -4.29405456e+03  4.28e-03 2.99e-04  2.05e-03     6s
  39  -4.65713029e+03 -4.32856838e+03  3.09e-03 2.21e-04  1.50e-03     6s
  40  -4.61383933e+03 -4.34552463e+03  2.47e-03 1.83e-04  1.22e-03     6s
  41  -4.53996561e+03 -4.36786811e+03  1.45e-03 1.32e-04  7.84e-04     6s
  42  -4.51676444e+03 -4.40413245e+03  1.13e-03 5.58e-05  5.14e-04     6s
  43  -4.46840656e+03 -4.41961738e+03  4.94e-04 2.01e-05  2.23e-04     6s
  44  -4.46631353e+03 -4.42122530e+03  4.67e-04 1.70e-05  2.06e-04     6s
  45  -4.46138247e+03 -4.42450236e+03  4.01e-04 1.01e-05  1.69e-04     6s
  46  -4.45543233e+03 -4.42487028e+03  3.23e-04 9.42e-06  1.40e-04     6s
  47  -4.45085961e+03 -4.42805024e+03  2.65e-04 3.15e-06  1.04e-04     6s
  48  -4.43560993e+03 -4.42955398e+03  6.90e-05 2.17e-05  2.77e-05     6s
  49  -4.43170055e+03 -4.42973765e+03  1.91e-05 1.20e-05  8.96e-06     6s
  50  -4.43057120e+03 -4.42983598e+03  6.59e-06 6.83e-06  3.35e-06     7s
  51  -4.43038972e+03 -4.42984493e+03  4.61e-06 6.33e-06  2.48e-06     7s
  52  -4.43014132e+03 -4.42993884e+03  1.86e-06 1.53e-06  9.24e-07     7s
  53  -4.43010065e+03 -4.42994775e+03  1.42e-06 1.15e-06  6.98e-07     7s
  54  -4.43006284e+03 -4.42996700e+03  1.73e-06 1.99e-07  4.38e-07     7s
  55  -4.43003702e+03 -4.42996962e+03  1.25e-06 4.42e-08  3.09e-07     7s
  56  -4.42998313e+03 -4.42997016e+03  5.78e-07 1.77e-06  5.91e-08     7s
  57  -4.42997326e+03 -4.42997018e+03  2.84e-06 1.33e-08  1.39e-08     7s
  58  -4.42997020e+03 -4.42997019e+03  1.27e-08 7.26e-08  4.60e-11     7s

Barrier solved model in 58 iterations and 7.06 seconds (12.40 work units)
Optimal objective -4.42997020e+03


Root crossover log...

   97989 DPushes remaining with DInf 0.0000000e+00                 7s
   18982 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    4625 PPushes remaining with PInf 1.1255048e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1840226e+00     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53512   -4.4299702e+03   0.000000e+00   1.184023e+00     13s
   53536   -4.4299702e+03   0.000000e+00   0.000000e+00     13s
   53536   -4.4299702e+03   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -4.429970e+03, 53536 iterations, 10.81 seconds (17.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4429.9702    0  449 -217728.64 -4429.9702  98.0%     -   14s
H    0     0                    -130620.6527 -4429.9702  96.6%     -   14s
H    0     0                    -101571.5336 -4429.9702  95.6%     -   14s
H    0     0                    -101332.7648 -4429.9702  95.6%     -   14s
H    0     0                    -101177.3439 -4429.9702  95.6%     -   14s
H    0     0                    -92627.95499 -4429.9702  95.2%     -   14s
H    0     0                    -92260.43661 -4429.9702  95.2%     -   15s
H    0     0                    -52154.28446 -4429.9702  91.5%     -   15s
H    0     0                    -52106.14879 -4429.9702  91.5%     -   15s
H    0     0                    -52002.92047 -4429.9702  91.5%     -   15s
H    0     0                    -40489.97745 -8235.9214  79.7%     -   74s
H    0     0                    -40391.02889 -8235.9214  79.6%     -   74s
H    0     0                    -40120.10761 -8235.9214  79.5%     -   74s
H    0     0                    -40065.20851 -8235.9214  79.4%     -   74s
     0     0 -8360.9477    0  541 -40065.209 -8360.9477  79.1%     -   74s
H    0     0                    -36690.18871 -8360.9477  77.2%     -   75s
H    0     0                    -36318.31831 -8360.9477  77.0%     -   76s
H    0     0                    -36164.81019 -8360.9477  76.9%     -   76s
H    0     0                    -36163.73928 -8360.9477  76.9%     -   76s
H    0     0                    -36162.29467 -8360.9477  76.9%     -   76s
     0     0 -8396.3832    0  525 -36162.295 -8396.3832  76.8%     -   89s
     0     0 -8396.3832    0  526 -36162.295 -8396.3832  76.8%     -   91s
     0     0 -8416.1654    0  517 -36162.295 -8416.1654  76.7%     -   96s
     0     0 -8442.4315    0  520 -36162.295 -8442.4315  76.7%     -   97s
     0     0 -8442.4315    0  520 -36162.295 -8442.4315  76.7%     -   98s
     0     0 -10670.108    0  634 -36162.295 -10670.108  70.5%     -  182s
H    0     0                    -34884.18895 -10670.108  69.4%     -  183s
H    0     0                    -34742.98110 -10670.108  69.3%     -  183s
H    0     0                    -34742.71692 -10670.108  69.3%     -  183s
H    0     0                    -34710.02327 -10670.108  69.3%     -  183s
H    0     0                    -34706.58667 -10670.108  69.3%     -  183s
     0     0 -10748.822    0  635 -34706.587 -10748.822  69.0%     -  215s
     0     0 -10838.295    0  588 -34706.587 -10838.295  68.8%     -  234s
H    0     0                    -30391.89759 -10870.444  64.2%     -  245s
H    0     0                    -30245.45692 -10870.444  64.1%     -  245s
     0     0 -10870.444    0  591 -30245.457 -10870.444  64.1%     -  245s
H    0     0                    -30242.26108 -10876.563  64.0%     -  251s
H    0     0                    -30234.46964 -10876.563  64.0%     -  251s
     0     0 -10876.563    0  636 -30234.470 -10876.563  64.0%     -  251s
     0     0 -10952.923    0  638 -30234.470 -10952.923  63.8%     -  263s
     0     0 -10957.915    0  637 -30234.470 -10957.915  63.8%     -  266s
     0     0 -10958.567    0  634 -30234.470 -10958.567  63.8%     -  268s
H    0     0                    -29833.94136 -12726.272  57.3%     -  358s
H    0     0                    -29574.05157 -12726.272  57.0%     -  358s
H    0     0                    -29567.49896 -12726.272  57.0%     -  358s
H    0     0                    -29558.11259 -12726.272  56.9%     -  358s
H    0     0                    -29482.88693 -12726.272  56.8%     -  358s
H    0     0                    -29475.17981 -12726.272  56.8%     -  358s
H    0     0                    -29459.98403 -12726.272  56.8%     -  358s
H    0     0                    -29459.23775 -12726.272  56.8%     -  358s
H    0     0                    -29450.85212 -12726.272  56.8%     -  358s
     0     0 -12726.272    0  663 -29450.852 -12726.272  56.8%     -  358s
H    0     0                    -29448.20051 -13142.727  55.4%     -  398s
     0     0 -13142.727    0  628 -29448.201 -13142.727  55.4%     -  398s
     0     0 -13301.423    0  573 -29448.201 -13301.423  54.8%     -  432s
     0     0 -13381.652    0  571 -29448.201 -13381.652  54.6%     -  458s
     0     0 -13433.143    0  657 -29448.201 -13433.143  54.4%     -  481s
     0     0 -13441.783    0  660 -29448.201 -13441.783  54.4%     -  487s
     0     0 -13443.290    0  655 -29448.201 -13443.290  54.3%     -  491s
     0     0 -13470.966    0  652 -29448.201 -13470.966  54.3%     -  498s
     0     0 -13474.146    0  651 -29448.201 -13474.146  54.2%     -  504s
     0     0 -13481.391    0  653 -29448.201 -13481.391  54.2%     -  508s
     0     0 -13484.246    0  662 -29448.201 -13484.246  54.2%     -  511s
H    0     0                    -29447.74591 -13555.995  54.0%     -  530s
     0     0 -13555.995    0  650 -29447.746 -13555.995  54.0%     -  530s
     0     0 -13608.000    0  663 -29447.746 -13608.000  53.8%     -  545s
     0     0 -13642.398    0  656 -29447.746 -13642.398  53.7%     -  565s
     0     0 -13651.069    0  660 -29447.746 -13651.069  53.6%     -  574s
     0     0 -13655.646    0  601 -29447.746 -13655.646  53.6%     -  580s
     0     0 -13658.683    0  601 -29447.746 -13658.683  53.6%     -  584s
     0     0 -13658.874    0  608 -29447.746 -13658.874  53.6%     -  585s
H    0     0                    -29432.57979 -13658.874  53.6%     -  608s
H    0     0                    -29417.66783 -13658.874  53.6%     -  608s
     0     0 -14376.707    0  741 -29417.668 -14376.707  51.1%     -  688s
     0     0 -14546.846    0  753 -29417.668 -14546.846  50.6%     -  719s
     0     0 -14619.673    0  744 -29417.668 -14619.673  50.3%     -  741s
     0     0 -14630.233    0  745 -29417.668 -14630.233  50.3%     -  750s
     0     0 -14638.868    0  758 -29417.668 -14638.868  50.2%     -  757s
     0     0 -14639.453    0  763 -29417.668 -14639.453  50.2%     -  760s
     0     0 -14811.838    0  690 -29417.668 -14811.838  49.6%     -  797s
     0     0 -14874.266    0  657 -29417.668 -14874.266  49.4%     -  821s
     0     0 -14886.437    0  713 -29417.668 -14886.437  49.4%     -  833s
     0     0 -14893.078    0  722 -29417.668 -14893.078  49.4%     -  849s
     0     0 -14901.443    0  724 -29417.668 -14901.443  49.3%     -  855s
     0     0 -14902.603    0  666 -29417.668 -14902.603  49.3%     -  858s
     0     0 -15103.821    0  757 -29417.668 -15103.821  48.7%     -  905s
     0     0 -15137.125    0  641 -29417.668 -15137.125  48.5%     -  927s
     0     0 -15143.832    0  644 -29417.668 -15143.832  48.5%     -  937s
     0     0 -15147.621    0  756 -29417.668 -15147.621  48.5%     -  944s
     0     0 -15148.803    0  645 -29417.668 -15148.803  48.5%     -  948s
     0     0 -15216.967    0  673 -29417.668 -15216.967  48.3%     -  981s
     0     0 -15234.638    0  751 -29417.668 -15234.638  48.2%     -  994s
     0     0 -15240.857    0  759 -29417.668 -15240.857  48.2%     - 1001s
     0     0 -15243.114    0  752 -29417.668 -15243.114  48.2%     - 1006s
     0     0 -15244.450    0  751 -29417.668 -15244.450  48.2%     - 1011s
     0     0 -15280.645    0  663 -29417.668 -15280.645  48.1%     - 1035s
     0     0 -15287.882    0  676 -29417.668 -15287.882  48.0%     - 1045s
     0     0 -15290.723    0  668 -29417.668 -15290.723  48.0%     - 1049s
     0     0 -15291.979    0  726 -29417.668 -15291.979  48.0%     - 1052s
     0     0 -15310.213    0  721 -29417.668 -15310.213  48.0%     - 1067s
     0     0 -15322.240    0  787 -29417.668 -15322.240  47.9%     - 1081s
     0     0 -15325.798    0  742 -29417.668 -15325.798  47.9%     - 1088s
     0     0 -15329.506    0  679 -29417.668 -15329.506  47.9%     - 1093s
     0     0 -15330.805    0  680 -29417.668 -15330.805  47.9%     - 1096s
     0     0 -15342.939    0  726 -29417.668 -15342.939  47.8%     - 1113s
     0     0 -15346.552    0  735 -29417.668 -15346.552  47.8%     - 1120s
     0     0 -15348.665    0  686 -29417.668 -15348.665  47.8%     - 1125s
     0     0 -15349.406    0  686 -29417.668 -15349.406  47.8%     - 1128s
     0     0 -15354.356    0  665 -29417.668 -15354.356  47.8%     - 1138s
     0     0 -15355.900    0  667 -29417.668 -15355.900  47.8%     - 1142s
H    0     0                    -28872.25080 -15363.957  46.8%     - 1159s
     0     0 -15363.957    0  713 -28872.251 -15363.957  46.8%     - 1159s
     0     0 -15364.340    0  713 -28872.251 -15364.340  46.8%     - 1167s
H    0     0                    -28773.61570 -15364.413  46.6%     - 1249s
H    0     0                    -28679.70266 -15364.413  46.4%     - 1249s
H    0     0                    -28679.03675 -15364.413  46.4%     - 1249s
H    0     0                    -28674.97260 -15364.413  46.4%     - 1249s
H    0     0                    -28667.76806 -15364.413  46.4%     - 1249s
H    0     0                    -28644.15782 -15364.413  46.4%     - 1349s
H    0     0                    -28557.11696 -15364.413  46.2%     - 1349s
H    0     0                    -27824.73927 -15364.413  44.8%     - 1349s
H    0     0                    -27717.96710 -15364.413  44.6%     - 1349s
H    0     0                    -27712.67493 -15364.413  44.6%     - 1351s
H    0     0                    -27642.20371 -15364.413  44.4%     - 1352s
H    0     0                    -27440.53406 -15364.413  44.0%     - 1353s
H    0     0                    -27438.49906 -15364.413  44.0%     - 1353s
H    0     0                    -27433.32952 -15364.413  44.0%     - 1353s
H    0     2                    -27398.78303 -15364.413  43.9%     - 1357s
     0     2 -15364.413    0  713 -27398.783 -15364.413  43.9%     - 1357s
     1     3 -15816.507    1  493 -27398.783 -15364.413  43.9% 18107 1389s
     2     4 -15436.013    1  648 -27398.783 -15436.013  43.7% 13897 1406s
     3     6 -15525.663    2  634 -27398.783 -15436.360  43.7% 11709 1432s
     5    11 -15808.579    3  617 -27398.783 -15436.360  43.7% 13684 1464s
    10    21 -15892.588    4  594 -27398.783 -15587.290  43.1% 12965 1528s
    20    31 -18086.078    5  372 -27398.783 -15587.422  43.1% 25827 1671s
H   30    59                    -27393.49086 -15653.752  42.9% 24053 1819s
H   31    59                    -27247.54990 -15653.752  42.5% 23849 1819s
    60    91 -17066.058    6  577 -27247.550 -15653.752  42.5% 26850 1876s
    92   164 -17104.910    7  564 -27247.550 -15653.752  42.5% 23518 1949s
H  111   164                    -27223.66094 -15653.752  42.5% 21154 1949s
H  134   164                    -27221.44743 -15653.752  42.5% 19315 1949s
H  158   164                    -26731.91274 -15653.752  41.4% 17863 1949s
   165   247 -17246.833    8  578 -26731.913 -15653.752  41.4% 17799 1991s
   248   275 -17435.072   10  575 -26731.913 -15653.752  41.4% 14350 2020s
H  254   275                    -26665.45996 -15653.752  41.3% 14258 2020s
H  265   275                    -26631.81070 -15653.752  41.2% 13837 2020s
   276   366 -17490.186   11  568 -26631.811 -15653.752  41.2% 13676 2054s
   367   400 -17684.525   13  571 -26631.811 -15653.752  41.2% 11755 2108s
H  374   400                    -26617.67977 -15653.752  41.2% 11835 2108s
H  374   400                    -26583.31274 -15653.752  41.1% 11835 2108s
H  392   400                    -26514.21364 -15653.752  41.0% 11557 2108s
   409   457 -20773.262   17  236 -26514.214 -15653.752  41.0% 11515 2139s
   484   514 -17780.099   14  574 -26514.214 -15653.752  41.0% 10747 2166s
H  486   514                    -26497.07320 -15653.752  40.9% 10732 2166s
H  508   514                    -26496.55745 -15653.752  40.9% 10462 2166s
   549   559 -24112.107   20  207 -26496.557 -15653.752  40.9% 10345 2195s
   628   588 -24401.493   22  189 -26496.557 -15653.752  40.9%  9949 2217s
   682   638 -22906.065   15  172 -26496.557 -15653.752  40.9%  9619 2241s
   774   696 -24619.801   20  100 -26496.557 -15653.752  40.9%  9241 2264s
   879   711 -24796.017   25   89 -26496.557 -15653.752  40.9%  8679 2287s
   981   717     cutoff   31      -26496.557 -15653.752  40.9%  8290 2309s
  1025   737 infeasible   30      -26496.557 -15653.752  40.9%  8223 2333s
  1075   775 -24401.074   16  130 -26496.557 -15653.752  40.9%  8146 2354s
  1150   787 -25575.659   17  100 -26496.557 -15653.752  40.9%  7951 2378s
  1198   794 -25951.518   18   72 -26496.557 -15653.752  40.9%  7839 2402s
  1274   789 infeasible   19      -26496.557 -15653.752  40.9%  7547 2427s
  1381   804 infeasible   18      -26496.557 -15653.752  40.9%  7238 2456s
  1470   833 -24030.140   14  123 -26496.557 -15653.752  40.9%  7013 2487s
  1569   888 -20268.958   11  355 -26496.557 -15653.752  40.9%  6893 2519s
  1682   927 -21186.853   12  291 -26496.557 -15653.752  40.9%  6784 2548s
  1792   953 -21384.636   13  226 -26496.557 -15653.752  40.9%  6712 2582s
  1863   980 -21566.794   13  303 -26496.557 -15653.752  40.9%  6867 2618s
  1928   998 -22143.259   14  268 -26496.557 -15653.752  40.9%  7031 2648s
  2010  1066 -22509.060   13  296 -26496.557 -15653.752  40.9%  7063 2683s
  2132  1091 infeasible   16      -26496.557 -15653.752  40.9%  6979 2721s
  2264  1129 infeasible   19      -26496.557 -15653.752  40.9%  6929 2761s
  2366  1171 -25247.163   10  213 -26496.557 -15653.752  40.9%  7021 2799s
  2463  1184 infeasible   11      -26496.557 -15653.752  40.9%  7056 2856s
  2498  1189 -26119.892   19  105 -26496.557 -15653.752  40.9%  7164 2899s
  2546  1212 -26237.136   20   94 -26496.557 -15653.752  40.9%  7222 2942s
  2579  1242 -20902.846   14  352 -26496.557 -15653.752  40.9%  7352 2979s
  2621  1275 -26276.723   20  109 -26496.557 -15653.752  40.9%  7433 3017s
  2664  1292 -21601.121   15  219 -26496.557 -15653.752  40.9%  7516 3058s
  2752  1313     cutoff   17      -26496.557 -15653.752  40.9%  7529 3104s
  2832  1350 -25557.566   18  196 -26496.557 -15777.045  40.5%  7603 3150s
  2922  1360 infeasible   20      -26496.557 -15777.045  40.5%  7652 3194s
  3020  1393 -25202.422   19  262 -26496.557 -15777.045  40.5%  7694 3248s
  3132  1402 infeasible   23      -26496.557 -15777.139  40.5%  7744 3303s
  3229  1447 -17954.860    7  519 -26496.557 -15777.139  40.5%  7803 3360s
  3340  1507 -18334.117    8  593 -26496.557 -15777.139  40.5%  7848 3420s
  3467  1555 -18969.136   10  575 -26496.557 -15777.139  40.5%  7966 3482s
  3599  1584 -21596.559   12  374 -26496.557 -15777.139  40.5%  8024 3541s
  3730  1669 -21704.331   13  370 -26496.557 -15777.139  40.5%  8102 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 162
  MIR: 3943
  Flow cover: 3892
  Zero half: 12
  RLT: 130
  Relax-and-lift: 651

Explored 3906 nodes (32644288 simplex iterations) in 3600.04 seconds (8281.61 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26496.6 -26497.1 -26514.2 ... -27223.7

Time limit reached
Best objective -2.649655745022e+04, best bound -1.664015157903e+04, gap 37.1988%
  WARNING: Time limit reached. Using best solution found (gap: 37.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -26496.56, θ = 93982.53
  Upper Bound (UB) = -26496.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93982.53
  [DEBUG]   ✓ Scenario 0: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93982.53 ≤ Q = 93982.53 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1f4fe69f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe0b01961
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.070585e+13
Presolve removed 2624 rows and 1916 columns
Presolve time: 0.01s
Presolved: 469 rows, 473 columns, 1287 nonzeros
Found heuristic solution: objective 5110559.5419
Variable types: 318 continuous, 155 integer (155 binary)
Found heuristic solution: objective 5110144.4568

Root relaxation: objective -1.123974e+05, 221 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112397.38    0  118 5110144.46 -112397.38   102%     -    0s
H    0     0                    -63941.81180 -112397.38  75.8%     -    0s
H    0     0                    -68139.39674 -112397.38  65.0%     -    0s
H    0     0                    -69345.48647 -112251.12  61.9%     -    0s
H    0     0                    -72467.50841 -83822.276  15.7%     -    0s
     0     0 -83822.276    0   91 -72467.508 -83822.276  15.7%     -    0s
H    0     0                    -78578.37548 -83762.702  6.60%     -    0s
H    0     0                    -78735.87976 -83762.702  6.38%     -    0s
H    0     0                    -80540.33943 -83762.702  4.00%     -    0s
H    0     0                    -80697.84371 -83762.702  3.80%     -    0s
     0     0 -83542.200    0   91 -80697.844 -83542.200  3.52%     -    0s
     0     0 -83521.566    0   87 -80697.844 -83521.566  3.50%     -    0s
H    0     0                    -80939.04196 -83521.566  3.19%     -    0s
H    0     0                    -80944.26694 -83521.566  3.18%     -    0s
     0     0 -83274.463    0   90 -80944.267 -83274.463  2.88%     -    0s
     0     0 -83251.733    0   87 -80944.267 -83251.733  2.85%     -    0s
     0     0 -83221.185    0   87 -80944.267 -83221.185  2.81%     -    0s
     0     0 -83194.659    0   87 -80944.267 -83194.659  2.78%     -    0s
H    0     0                    -82755.04904 -83194.268  0.53%     -    0s
H    0     0                    -82756.67088 -83194.268  0.53%     -    0s
H    0     0                    -82771.93704 -83194.268  0.51%     -    0s
     0     2 -83194.268    0   87 -82771.937 -83194.268  0.51%     -    0s
*   53     4              15    -82851.14077 -82851.967  0.00%   6.4    0s

Cutting planes:
  Gomory: 7
  MIR: 137

Explored 59 nodes (813 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -82851.1 -82771.9 -82756.7 ... -63941.8
No other solutions better than -82851.1

Optimal solution found (tolerance 1.00e-06)
Best objective -8.285114076858e+04, best bound -8.285114076858e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 90893.92
  Scenario: 13 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82851.14
  [DEBUG]   S×d_nominal = 173745.06
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173745.06 + -82851.14 = 90893.92
  [DEBUG]   Current θ from Master = 93982.53
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3088.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -29585.16
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 2131.0097, Absolute Gap = 2131.0097, Relative Gap = 0.080426
  Not converged yet (gap = 2131.01 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 46 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697119 nonzeros
Model fingerprint: 0xbf94fd83
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 116652 rows and 47382 columns
Presolve time: 2.39s
Presolved: 129371 rows, 54718 columns, 797729 nonzeros
Variable types: 52459 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387251.2280
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.11s

Barrier statistics:
 Dense cols : 578
 AA' NZ     : 6.776e+06
 Factor NZ  : 1.465e+07 (roughly 200 MB of memory)
 Factor Ops : 3.119e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.01059309e+07  2.08338944e+08  3.45e+05 1.98e+01  1.15e+05     5s
   1  -3.55687710e+07  2.16646622e+08  2.98e+05 6.94e+01  9.89e+04     5s
   2  -1.78053170e+07  1.79512236e+08  1.41e+05 3.59e+01  4.76e+04     5s
   3  -1.07142173e+07  1.25777847e+08  8.39e+04 8.80e+00  2.83e+04     5s
   4  -6.31834009e+06  1.23270380e+08  4.62e+04 7.84e+00  1.58e+04     5s
   5  -2.35082421e+06  8.24355856e+07  1.40e+04 7.41e-01  4.84e+03     5s
   6  -7.92486219e+05  6.03554644e+07  1.62e+03 1.65e-01  7.65e+02     5s
   7  -6.19943025e+05  2.67813868e+07  5.98e+02 4.10e-02  2.82e+02     5s
   8  -3.83886052e+05  1.54282743e+07  2.27e+02 1.55e-02  1.24e+02     5s
   9  -2.44741459e+05  1.15840007e+07  1.19e+02 1.11e-02  7.71e+01     5s
  10  -2.01254915e+05  7.75396925e+06  8.45e+01 7.10e-03  4.99e+01     5s
  11  -1.58055551e+05  5.10904288e+06  4.87e+01 4.56e-03  2.98e+01     5s
  12  -1.30186337e+05  3.25850625e+06  2.66e+01 2.74e-03  1.74e+01     5s
  13  -1.10720247e+05  2.13899143e+06  1.50e+01 1.74e-03  1.08e+01     5s
  14  -9.36728777e+04  9.46869033e+05  8.78e+00 8.43e-04  4.81e+00     6s
  15  -8.10815314e+04  3.68694811e+05  5.77e+00 3.21e-04  2.04e+00     6s
  16  -5.41229898e+04  1.56880673e+05  2.30e+00 2.98e-04  9.24e-01     6s
  17  -4.77999936e+04  7.32969069e+04  1.90e+00 1.25e-03  5.30e-01     6s
  18  -3.79805327e+04  4.39809308e+04  1.46e+00 1.39e-03  3.59e-01     6s
  19  -3.22275798e+04  3.52128421e+04  1.21e+00 1.11e-03  2.95e-01     6s
  20  -2.61659352e+04  2.34189399e+04  9.55e-01 3.09e-03  2.17e-01     6s
  21  -2.24131801e+04  1.55729844e+04  7.82e-01 2.31e-03  1.66e-01     6s
  22  -1.91944327e+04  9.25716518e+03  6.30e-01 3.45e-03  1.24e-01     6s
  23  -1.74030862e+04  4.42138463e+03  5.43e-01 3.07e-03  9.57e-02     6s
  24  -1.50464921e+04  2.42625173e+03  4.34e-01 3.34e-03  7.65e-02     6s
  25  -1.39533030e+04  3.33669255e+02  3.83e-01 2.14e-03  6.27e-02     6s
  26  -1.26605044e+04 -1.86346988e+02  3.27e-01 1.74e-03  5.47e-02     6s
  27  -1.15108442e+04 -8.47112667e+02  2.80e-01 2.82e-03  4.67e-02     6s
  28  -1.03193352e+04 -1.58825112e+03  2.31e-01 2.09e-03  3.83e-02     6s
  29  -9.38934890e+03 -2.43526905e+03  1.93e-01 2.08e-03  3.05e-02     6s
  30  -8.13753760e+03 -2.78869429e+03  1.44e-01 1.94e-03  2.34e-02     6s
  31  -7.75008184e+03 -3.41457269e+03  1.29e-01 2.32e-03  1.91e-02     6s
  32  -7.58171294e+03 -3.65827578e+03  1.22e-01 2.43e-03  1.73e-02     7s
  33  -6.73840064e+03 -3.76904452e+03  8.90e-02 1.77e-03  1.31e-02     7s
  34  -6.49452015e+03 -4.01421164e+03  7.94e-02 1.10e-03  1.09e-02     7s
  35  -6.13513831e+03 -4.07051495e+03  6.51e-02 1.15e-03  9.09e-03     7s
  36  -6.02184439e+03 -4.14403116e+03  6.08e-02 1.38e-03  8.28e-03     7s
  37  -5.73423255e+03 -4.21259330e+03  4.94e-02 1.43e-03  6.71e-03     7s
  38  -5.58453473e+03 -4.27872277e+03  4.35e-02 8.66e-04  5.76e-03     7s
  39  -5.26794030e+03 -4.31412880e+03  3.11e-02 8.53e-04  4.20e-03     7s
  40  -5.03485649e+03 -4.36536716e+03  2.21e-02 1.17e-03  2.95e-03     7s
  41  -4.99545872e+03 -4.39777689e+03  2.07e-02 7.36e-04  2.64e-03     7s
  42  -4.83203859e+03 -4.40398105e+03  1.46e-02 6.70e-04  1.89e-03     7s
  43  -4.80034185e+03 -4.40888267e+03  1.34e-02 5.09e-04  1.73e-03     7s
  44  -4.73144459e+03 -4.41441567e+03  1.09e-02 4.91e-04  1.40e-03     7s
  45  -4.64471855e+03 -4.41905590e+03  7.56e-03 4.47e-04  9.96e-04     7s
  46  -4.63786089e+03 -4.42258889e+03  7.32e-03 2.96e-04  9.50e-04     7s
  47  -4.60515557e+03 -4.42559250e+03  6.11e-03 2.30e-04  7.93e-04     7s
  48  -4.53736004e+03 -4.43066994e+03  3.56e-03 2.06e-04  4.71e-04     8s
  49  -4.51444903e+03 -4.43376561e+03  2.72e-03 1.40e-04  3.56e-04     8s
  50  -4.49626925e+03 -4.43624405e+03  2.04e-03 8.99e-05  2.65e-04     8s
  51  -4.48479130e+03 -4.43721558e+03  1.62e-03 6.02e-05  2.10e-04     8s
  52  -4.48148927e+03 -4.43724084e+03  1.50e-03 5.88e-05  1.95e-04     8s
  53  -4.47180309e+03 -4.43756495e+03  1.15e-03 4.56e-05  1.51e-04     8s
  54  -4.46819517e+03 -4.43796585e+03  1.01e-03 3.50e-05  1.33e-04     8s
  55  -4.44444502e+03 -4.43896931e+03  1.75e-04 3.38e-05  2.41e-05     8s
  56  -4.43950489e+03 -4.43919200e+03  7.69e-06 2.91e-06  1.37e-06     8s
  57  -4.43949215e+03 -4.43919405e+03  4.52e-06 1.18e-05  1.30e-06     8s
  58  -4.43948167e+03 -4.43919589e+03  4.97e-06 8.87e-06  1.25e-06     8s
  59  -4.43946823e+03 -4.43919792e+03  4.71e-06 8.51e-06  1.18e-06     8s
  60  -4.43946418e+03 -4.43919860e+03  4.64e-06 8.37e-06  1.16e-06     8s
  61  -4.43944012e+03 -4.43920408e+03  4.15e-06 7.09e-06  1.03e-06     9s
  62  -4.43942237e+03 -4.43920657e+03  3.73e-06 2.06e-05  9.41e-07     9s
  63  -4.43940323e+03 -4.43921045e+03  3.62e-06 9.66e-06  8.42e-07     9s
  64  -4.43940100e+03 -4.43921063e+03  3.57e-06 1.08e-05  8.32e-07     9s
  65  -4.43938816e+03 -4.43921229e+03  3.19e-06 1.04e-05  7.68e-07     9s
  66  -4.43937829e+03 -4.43921378e+03  2.95e-06 1.15e-05  7.19e-07     9s
  67  -4.43936577e+03 -4.43921600e+03  2.66e-06 1.41e-05  6.54e-07     9s
  68  -4.43936153e+03 -4.43921676e+03  2.59e-06 1.37e-05  6.32e-07     9s
  69  -4.43933108e+03 -4.43923785e+03  1.91e-06 7.01e-07  4.09e-07     9s
  70  -4.43931096e+03 -4.43923793e+03  8.38e-06 8.47e-07  3.20e-07     9s
  71  -4.43928356e+03 -4.43923892e+03  7.03e-06 4.20e-06  1.96e-07     9s
  72  -4.43928129e+03 -4.43923894e+03  5.97e-06 3.19e-06  1.86e-07     9s
  73  -4.43925544e+03 -4.43923910e+03  4.72e-06 5.80e-09  7.19e-08    10s
  74  -4.43924846e+03 -4.43923909e+03  2.76e-06 3.32e-07  4.12e-08    10s
  75  -4.43924694e+03 -4.43923910e+03  3.82e-06 7.25e-07  3.56e-08    10s
  76  -4.43924706e+03 -4.43923910e+03  4.48e-06 7.47e-07  3.52e-08    10s
  77  -4.43924664e+03 -4.43923910e+03  8.75e-06 7.36e-07  3.44e-08    10s
  78  -4.43924334e+03 -4.43923910e+03  5.67e-06 5.00e-07  1.88e-08    10s
  79  -4.43924178e+03 -4.43923910e+03  5.04e-06 2.45e-07  1.14e-08    10s
  80  -4.43923975e+03 -4.43923910e+03  1.36e-06 2.05e-07  2.78e-09    10s
  81  -4.43923935e+03 -4.43923910e+03  1.18e-06 1.37e-07  9.79e-10    10s
  82  -4.43923932e+03 -4.43923910e+03  1.04e-06 1.10e-07  8.66e-10    10s
  83  -4.43923922e+03 -4.43923910e+03  5.71e-07 9.37e-08  4.77e-10    10s
  84  -4.43923910e+03 -4.43923910e+03  4.71e-07 8.34e-08  6.46e-11    10s

Barrier solved model in 84 iterations and 10.24 seconds (18.15 work units)
Optimal objective -4.43923910e+03


Root crossover log...

  105829 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    4948 PPushes remaining with PInf 5.2523219e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.4009948e+01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   58206   -4.4392391e+03   0.000000e+00   9.400995e+01     14s
   58225   -4.4392391e+03   0.000000e+00   0.000000e+00     14s
   58225   -4.4392391e+03   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 5.65s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -4.439239e+03, 58225 iterations, 16.69 seconds (23.39 work units)
Total elapsed time = 20.01s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4439.2391    0  432 -217728.64 -4439.2391  98.0%     -   20s
H    0     0                    -100772.8635 -4439.2391  95.6%     -   20s
H    0     0                    -97943.22495 -4439.2391  95.5%     -   20s
H    0     0                    -97515.61057 -4439.2391  95.4%     -   20s
H    0     0                    -91335.51101 -4439.2391  95.1%     -   21s
H    0     0                    -66486.12794 -4439.2391  93.3%     -   21s
H    0     0                    -66283.98924 -4439.2391  93.3%     -   21s
H    0     0                    -42934.71798 -4439.2391  89.7%     -   24s
H    0     0                    -42846.17844 -4439.2391  89.6%     -   24s
H    0     0                    -42256.58780 -4439.2391  89.5%     -   24s
     0     0 -8205.4846    0  509 -42256.588 -8205.4846  80.6%     -   69s
H    0     0                    -41885.33323 -8205.7990  80.4%     -   70s
H    0     0                    -41874.57485 -8205.7990  80.4%     -   70s
H    0     0                    -41866.81277 -8205.7990  80.4%     -   70s
H    0     0                    -41825.77242 -8205.7990  80.4%     -   70s
H    0     0                    -41803.27275 -8205.7990  80.4%     -   70s
H    0     0                    -41791.27156 -8205.7990  80.4%     -   70s
     0     0 -8366.4056    0  475 -41791.272 -8366.4056  80.0%     -   86s
     0     0 -8388.1214    0  478 -41791.272 -8388.1214  79.9%     -   93s
     0     0 -8390.4185    0  480 -41791.272 -8390.4185  79.9%     -   94s
     0     0 -8390.4608    0  480 -41791.272 -8390.4608  79.9%     -   95s
     0     0 -10624.294    0  636 -41791.272 -10624.294  74.6%     -  173s
H    0     0                    -41772.01162 -10624.294  74.6%     -  175s
     0     0 -10721.331    0  654 -41772.012 -10721.331  74.3%     -  199s
     0     0 -10864.103    0  627 -41772.012 -10864.103  74.0%     -  216s
     0     0 -10876.064    0  601 -41772.012 -10876.064  74.0%     -  221s
     0     0 -10881.218    0  638 -41772.012 -10881.218  74.0%     -  225s
     0     0 -10909.054    0  634 -41772.012 -10909.054  73.9%     -  229s
     0     0 -10909.298    0  635 -41772.012 -10909.298  73.9%     -  231s
H    0     0                    -30413.40131 -12512.633  58.9%     -  300s
H    0     0                    -29886.51864 -12512.633  58.1%     -  300s
     0     0 -12512.633    0  687 -29886.519 -12512.633  58.1%     -  300s
H    0     0                    -29792.27705 -12512.664  58.0%     -  301s
H    0     0                    -29788.54506 -12512.664  58.0%     -  301s
H    0     0                    -29672.99606 -12512.664  57.8%     -  301s
H    0     0                    -29545.27644 -12512.664  57.6%     -  301s
H    0     0                    -29541.55752 -12512.664  57.6%     -  301s
H    0     0                    -29530.29337 -12512.664  57.6%     -  301s
     0     0 -13004.158    0  672 -29530.293 -13004.158  56.0%     -  335s
     0     0 -13136.724    0  684 -29530.293 -13136.724  55.5%     -  355s
     0     0 -13311.775    0  678 -29530.293 -13311.775  54.9%     -  385s
     0     0 -13437.707    0  686 -29530.293 -13437.707  54.5%     -  408s
     0     0 -13456.493    0  686 -29530.293 -13456.493  54.4%     -  420s
H    0     0                    -29523.58154 -13466.306  54.4%     -  427s
     0     0 -13466.306    0  682 -29523.582 -13466.306  54.4%     -  427s
     0     0 -13471.163    0  686 -29523.582 -13471.163  54.4%     -  430s
     0     0 -13479.865    0  688 -29523.582 -13479.865  54.3%     -  438s
     0     0 -13484.375    0  685 -29523.582 -13484.375  54.3%     -  448s
     0     0 -13486.461    0  691 -29523.582 -13486.461  54.3%     -  453s
     0     0 -13488.272    0  684 -29523.582 -13488.272  54.3%     -  456s
     0     0 -13506.030    0  691 -29523.582 -13506.030  54.3%     -  464s
H    0     0                    -29438.67601 -13509.382  54.1%     -  467s
     0     0 -13509.382    0  691 -29438.676 -13509.382  54.1%     -  468s
     0     0 -13545.278    0  695 -29438.676 -13545.278  54.0%     -  480s
     0     0 -13547.185    0  699 -29438.676 -13547.185  54.0%     -  483s
     0     0 -13547.511    0  699 -29438.676 -13547.511  54.0%     -  485s
     0     0 -14308.586    0  690 -29438.676 -14308.586  51.4%     -  580s
H    0     0                    -29431.39601 -14443.231  50.9%     -  612s
H    0     0                    -29382.36037 -14443.231  50.8%     -  612s
H    0     0                    -29364.41826 -14443.231  50.8%     -  612s
H    0     0                    -28375.06165 -14443.231  49.1%     -  612s
H    0     0                    -28368.72775 -14443.231  49.1%     -  612s
H    0     0                    -28345.76306 -14443.231  49.0%     -  612s
H    0     0                    -28272.10842 -14443.231  48.9%     -  612s
H    0     0                    -28270.24648 -14443.231  48.9%     -  612s
H    0     0                    -28240.41531 -14443.231  48.9%     -  612s
H    0     0                    -28237.45101 -14443.231  48.9%     -  612s
     0     0 -14443.231    0  648 -28237.451 -14443.231  48.9%     -  612s
H    0     0                    -28013.86755 -14589.223  47.9%     -  643s
H    0     0                    -28013.35180 -14589.223  47.9%     -  643s
H    0     0                    -27882.75936 -14589.223  47.7%     -  643s
H    0     0                    -27854.59263 -14589.223  47.6%     -  643s
H    0     0                    -27840.41907 -14589.223  47.6%     -  643s
H    0     0                    -27835.48482 -14589.223  47.6%     -  643s
H    0     0                    -27834.96908 -14589.223  47.6%     -  643s
H    0     0                    -27822.96419 -14589.223  47.6%     -  643s
H    0     0                    -27815.75965 -14589.223  47.6%     -  643s
     0     0 -14589.223    0  646 -27815.760 -14589.223  47.6%     -  643s
     0     0 -14624.409    0  642 -27815.760 -14624.409  47.4%     -  660s
     0     0 -14651.852    0  660 -27815.760 -14651.852  47.3%     -  673s
     0     0 -14675.981    0  678 -27815.760 -14675.981  47.2%     -  686s
     0     0 -14680.648    0  686 -27815.760 -14680.648  47.2%     -  691s
     0     0 -14687.751    0  674 -27815.760 -14687.751  47.2%     -  705s
     0     0 -14689.376    0  679 -27815.760 -14689.376  47.2%     -  708s
     0     0 -14689.762    0  682 -27815.760 -14689.762  47.2%     -  709s
     0     0 -14912.475    0  672 -27815.760 -14912.475  46.4%     -  768s
H    0     0                    -27810.98322 -14990.813  46.1%     -  805s
     0     0 -14990.813    0  692 -27810.983 -14990.813  46.1%     -  805s
     0     0 -15007.841    0  716 -27810.983 -15007.841  46.0%     -  825s
     0     0 -15020.208    0  718 -27810.983 -15020.208  46.0%     -  842s
     0     0 -15028.170    0  776 -27810.983 -15028.170  46.0%     -  856s
     0     0 -15031.146    0  824 -27810.983 -15031.146  46.0%     -  864s
     0     0 -15040.192    0  780 -27810.983 -15040.192  45.9%     -  874s
     0     0 -15041.758    0  832 -27810.983 -15041.758  45.9%     -  880s
     0     0 -15183.708    0  800 -27810.983 -15183.708  45.4%     -  925s
H    0     0                    -27803.44249 -15183.724  45.4%     -  930s
H    0     0                    -27722.82333 -15183.724  45.2%     -  930s
H    0     0                    -27695.43101 -15183.724  45.2%     -  931s
H    0     0                    -27675.63371 -15183.724  45.1%     -  931s
H    0     0                    -27660.29544 -15183.724  45.1%     -  931s
H    0     0                    -27647.12628 -15183.724  45.1%     -  932s
H    0     0                    -27643.06213 -15183.724  45.1%     -  932s
H    0     0                    -27632.30376 -15183.724  45.1%     -  932s
H    0     0                    -27624.13085 -15183.724  45.0%     -  932s
     0     0 -15211.124    0  806 -27624.131 -15211.124  44.9%     -  957s
     0     0 -15220.129    0  806 -27624.131 -15220.129  44.9%     -  971s
     0     0 -15223.593    0  812 -27624.131 -15223.593  44.9%     -  983s
     0     0 -15227.857    0  810 -27624.131 -15227.857  44.9%     -  989s
     0     0 -15231.337    0  761 -27624.131 -15231.337  44.9%     -  994s
     0     0 -15233.996    0  758 -27624.131 -15233.996  44.9%     -  999s
     0     0 -15234.417    0  759 -27624.131 -15234.417  44.9%     - 1002s
     0     0 -15291.345    0  767 -27624.131 -15291.345  44.6%     - 1026s
     0     0 -15315.221    0  810 -27624.131 -15315.221  44.6%     - 1042s
H    0     0                    -27506.18683 -15322.435  44.3%     - 1050s
     0     0 -15322.435    0  762 -27506.187 -15322.435  44.3%     - 1050s
     0     0 -15324.924    0  718 -27506.187 -15324.924  44.3%     - 1054s
H    0     0                    -27339.56031 -15330.225  43.9%     - 1061s
     0     0 -15330.225    0  820 -27339.560 -15330.225  43.9%     - 1061s
     0     0 -15334.226    0  818 -27339.560 -15334.226  43.9%     - 1064s
     0     0 -15334.884    0  823 -27339.560 -15334.884  43.9%     - 1068s
     0     0 -15374.178    0  711 -27339.560 -15374.178  43.8%     - 1088s
H    0     0                    -27334.01138 -15374.212  43.8%     - 1090s
     0     0 -15388.431    0  781 -27334.011 -15388.431  43.7%     - 1109s
     0     0 -15394.042    0  730 -27334.011 -15394.042  43.7%     - 1121s
     0     0 -15396.071    0  666 -27334.011 -15396.071  43.7%     - 1126s
     0     0 -15396.777    0  742 -27334.011 -15396.777  43.7%     - 1129s
     0     0 -15431.606    0  829 -27334.011 -15431.606  43.5%     - 1150s
     0     0 -15441.311    0  729 -27334.011 -15441.311  43.5%     - 1167s
     0     0 -15442.984    0  786 -27334.011 -15442.984  43.5%     - 1174s
     0     0 -15451.911    0  721 -27334.011 -15451.911  43.5%     - 1192s
H    0     0                    -27328.71920 -15451.937  43.5%     - 1210s
H    0     0                    -27313.49917 -15451.937  43.4%     - 1210s
H    0     0                    -27293.53241 -15451.937  43.4%     - 1210s
H    0     0                    -27288.80242 -15451.937  43.4%     - 1211s
H    0     0                    -27228.62597 -15451.937  43.3%     - 1211s
     0     0 -15461.111    0  788 -27228.626 -15461.111  43.2%     - 1225s
     0     0 -15462.223    0  858 -27228.626 -15462.223  43.2%     - 1231s
     0     0 -15485.277    0  775 -27228.626 -15485.277  43.1%     - 1255s
     0     0 -15491.617    0  791 -27228.626 -15491.617  43.1%     - 1264s
     0     0 -15494.155    0  793 -27228.626 -15494.155  43.1%     - 1274s
     0     0 -15496.065    0  732 -27228.626 -15496.065  43.1%     - 1281s
     0     0 -15496.909    0  803 -27228.626 -15496.909  43.1%     - 1286s
     0     0 -15505.804    0  789 -27228.626 -15505.804  43.1%     - 1303s
H    0     0                    -27223.33380 -15505.820  43.0%     - 1305s
     0     0 -15511.361    0  735 -27223.334 -15511.361  43.0%     - 1317s
     0     0 -15513.486    0  792 -27223.334 -15513.486  43.0%     - 1324s
     0     0 -15513.838    0  804 -27223.334 -15513.838  43.0%     - 1327s
     0     0 -15519.536    0  796 -27223.334 -15519.536  43.0%     - 1341s
     0     0 -15520.646    0  800 -27223.334 -15520.646  43.0%     - 1348s
     0     0 -15523.573    0  800 -27223.334 -15523.573  43.0%     - 1356s
     0     0 -15523.611    0  800 -27223.334 -15523.611  43.0%     - 1365s
H    0     0                    -27221.44743 -15523.646  43.0%     - 1656s
H    0     0                    -27220.93168 -15523.646  43.0%     - 1667s
H    0     0                    -26648.66639 -15523.646  41.7%     - 1667s
H    0     0                    -26646.33851 -15523.646  41.7%     - 1667s
H    0     0                    -26639.41212 -15523.646  41.7%     - 1810s
H    0     0                    -26632.20758 -15523.646  41.7%     - 1846s
H    0     0                    -26614.98099 -15523.646  41.7%     - 1846s
H    0     0                    -26610.10433 -15523.646  41.7%     - 1850s
H    0     0                    -26607.77645 -15523.646  41.7%     - 1850s
     0     2 -15523.646    0  800 -26607.776 -15523.646  41.7%     - 1855s
     1     3 -15853.909    1  619 -26607.776 -15523.659  41.7% 16572 1889s
     2     4 -15561.732    1  789 -26607.776 -15561.732  41.5% 12032 1904s
     3     5 -16753.154    2  599 -26607.776 -15561.910  41.5% 12788 1925s
     4     9 -15656.152    2  847 -26607.776 -15562.553  41.5% 12088 1948s
     8    17 -15679.874    3  853 -26607.776 -15656.178  41.2% 10442 1997s
    16    33 -15744.340    4  853 -26607.776 -15656.178  41.2% 12832 2038s
    32    48 -18167.271    5  329 -26607.776 -15679.907  41.1% 19084 2124s
    47    78 -17715.440    7  533 -26607.776 -15679.907  41.1% 24933 2177s
H   48    78                    -26580.11423 -15679.907  41.0% 24413 2177s
    77   177 -17820.640    8  514 -26580.114 -15744.358  40.8% 18127 2278s
   176   281 -22894.457   12  183 -26580.114 -15744.358  40.8% 10046 2307s
H  211   281                    -26576.10821 -15744.358  40.8%  8802 2307s
   282   364 -22962.063   17  153 -26576.108 -15744.358  40.8%  7349 2330s
   371   411 -23083.231   22  146 -26576.108 -15744.358  40.8%  6351 2351s
   434   425 -23879.781   27  123 -26576.108 -15744.358  40.8%  5932 2369s
   464   440 -25207.766   28   95 -26576.108 -15744.358  40.8%  5882 2389s
   503   457 -25672.898   29   71 -26576.108 -15744.358  40.8%  5752 2408s
   540   472 -26122.838   30   67 -26576.108 -15744.358  40.8%  5730 2428s
   571   477 -26186.196   31   72 -26576.108 -15744.358  40.8%  5686 2459s
   627   484 -26414.648   36   46 -26576.108 -15744.358  40.8%  5565 2482s
   660   488 infeasible   37      -26576.108 -15744.358  40.8%  5559 2502s
   713   500     cutoff   36      -26576.108 -15744.358  40.8%  5369 2521s
   771   487 infeasible   32      -26576.108 -15744.358  40.8%  5226 2542s
   827   501 infeasible   15      -26576.108 -15744.358  40.8%  5073 2566s
   874   511     cutoff    9      -26576.108 -15744.358  40.8%  4971 2588s
   904   537 -22234.843   10  262 -26576.108 -15744.358  40.8%  4933 2607s
H  915   537                    -26575.43712 -15744.358  40.8%  4957 2607s
   946   531 -22557.973   11  240 -26575.437 -15744.358  40.8%  4920 2630s
  1047   515 -22854.232   13  309 -26575.437 -15744.358  40.8%  4697 2654s
  1116   520 -23994.149   14  287 -26575.437 -15744.358  40.8%  4579 2680s
H 1117   520                    -26569.88602 -15744.358  40.7%  4575 2680s
H 1118   520                    -26509.91620 -15744.358  40.6%  4579 2680s
H 1140   520                    -26502.53210 -15744.358  40.6%  4581 2680s
  1145   545 -26024.716   15  186 -26502.532 -15744.358  40.6%  4603 2705s
H 1170   545                    -26494.65312 -15744.358  40.6%  4647 2705s
  1188   569 infeasible   13      -26494.653 -15744.358  40.6%  4684 2732s
  1267   610 infeasible   20      -26494.653 -15744.358  40.6%  4620 2760s
  1368   626 -23672.801   15  204 -26494.653 -15744.358  40.6%  4466 2788s
  1403   644 infeasible   16      -26494.653 -15744.358  40.6%  4468 2812s
  1445   674 infeasible   17      -26494.653 -15744.358  40.6%  4442 2835s
  1485   711 -24358.639   18  170 -26494.653 -15744.358  40.6%  4428 2860s
  1550   731 -24367.444   19  171 -26494.653 -15744.358  40.6%  4347 2886s
  1620   730 -24591.929   20  165 -26494.653 -15744.358  40.6%  4255 2918s
  1699   738 -24602.004   21  167 -26494.653 -15744.358  40.6%  4149 2953s
  1809   748 -24782.126   22  177 -26494.653 -15744.358  40.6%  4037 2988s
  1866   764 -26213.484   23  112 -26494.653 -15744.358  40.6%  4005 3025s
  1933   798 -26232.877   24  114 -26494.653 -15744.358  40.6%  4008 3064s
  2030   874 -21755.172    8  254 -26494.653 -15744.358  40.6%  3978 3119s
  2160   906 -22569.004    9  279 -26494.653 -15744.358  40.6%  3915 3164s
  2323   951 -24308.131   10  269 -26494.653 -15744.358  40.6%  3804 3210s
  2464   972 -25149.122   12  209 -26494.653 -15744.358  40.6%  3779 3254s
  2547  1012 -26452.030   13  119 -26494.653 -15744.358  40.6%  3818 3301s
  2659  1034 -26383.291   13  140 -26494.653 -15744.358  40.6%  3856 3352s
  2748  1081 -19511.608    8  497 -26494.653 -15744.358  40.6%  3930 3403s
  2821  1098 -21973.007    9  458 -26494.653 -15744.358  40.6%  4031 3458s
  2921  1141 -22847.186   11  416 -26494.653 -15744.358  40.6%  4093 3511s
  3018  1182 -23438.090   15  427 -26494.653 -15744.358  40.6%  4155 3570s
  3145  1197 -25060.234   18  211 -26494.653 -15744.358  40.6%  4179 3600s

Cutting planes:
  Gomory: 4
  Implied bound: 131
  MIR: 4318
  Flow cover: 4615
  Zero half: 7
  RLT: 132
  Relax-and-lift: 809

Explored 3204 nodes (14186668 simplex iterations) in 3600.07 seconds (7871.55 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26494.7 -26502.5 -26509.9 ... -26615

Time limit reached
Best objective -2.649465312317e+04, best bound -1.574435812472e+04, gap 40.5753%
  WARNING: Time limit reached. Using best solution found (gap: 40.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -26494.65, θ = 93994.21
  Upper Bound (UB) = -26494.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93994.21
  [DEBUG]   ✓ Scenario 0: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93994.21 ≤ Q = 93994.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93994.21 ≤ Q = 93994.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93994.21 ≤ Q = 93994.21 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x72f22694
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x72f22694
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.077478e+13
Presolve removed 2618 rows and 1911 columns
Presolve time: 0.00s
Presolved: 475 rows, 478 columns, 1303 nonzeros
Found heuristic solution: objective 5218294.9053
Variable types: 322 continuous, 156 integer (156 binary)

Root relaxation: objective -1.118496e+05, 224 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111849.58    0  120 5218294.91 -111849.58   102%     -    0s
H    0     0                    -78899.59979 -111849.58  41.8%     -    0s
H    0     0                    -79566.31182 -111849.58  40.6%     -    0s
     0     0 -83539.628    0   92 -79566.312 -83539.628  4.99%     -    0s
H    0     0                    -80312.68889 -83470.620  3.93%     -    0s
H    0     0                    -80470.19317 -83470.620  3.73%     -    0s
     0     0 -83090.932    0   94 -80470.193 -83090.932  3.26%     -    0s
     0     0 -83028.406    0   94 -80470.193 -83028.406  3.18%     -    0s
H    0     0                    -80748.35769 -83028.406  2.82%     -    0s
H    0     0                    -80753.58268 -82882.247  2.64%     -    0s
     0     0 -82882.247    0   95 -80753.583 -82882.247  2.64%     -    0s
     0     0 -82847.114    0   95 -80753.583 -82847.114  2.59%     -    0s
     0     0 -82603.764    0   90 -80753.583 -82603.764  2.29%     -    0s
     0     0 -82496.529    0   95 -80753.583 -82496.529  2.16%     -    0s
H    0     0                    -81102.16456 -82493.546  1.72%     -    0s
     0     0 -82493.546    0   95 -81102.165 -82493.546  1.72%     -    0s
     0     0 -82453.401    0   96 -81102.165 -82453.401  1.67%     -    0s
     0     0 -82392.648    0   96 -81102.165 -82392.648  1.59%     -    0s
     0     2 -82392.648    0   96 -81102.165 -82392.648  1.59%     -    0s
H    6     8                    -81776.41269 -82233.893  0.56%  13.8    0s

Cutting planes:
  Gomory: 25
  MIR: 201
  RLT: 1
  BQP: 1

Explored 88 nodes (1090 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -81776.4 -81102.2 -80753.6 ... 1.07748e+13
No other solutions better than -81776.4

Optimal solution found (tolerance 1.00e-06)
Best objective -8.177641269452e+04, best bound -8.177641269452e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 91725.31
  Scenario: 11 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81776.41
  [DEBUG]   S×d_nominal = 173501.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173501.72 + -81776.41 = 91725.31
  [DEBUG]   Current θ from Master = 93994.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2268.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28763.56
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 2132.9140, Absolute Gap = 2132.9140, Relative Gap = 0.080504
  Not converged yet (gap = 2132.91 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 48 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740344 nonzeros
Model fingerprint: 0x5a31bec0
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 123944 rows and 50344 columns
Presolve time: 2.50s
Presolved: 137369 rows, 57996 columns, 847109 nonzeros
Variable types: 55737 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387235.2691
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 578
 AA' NZ     : 7.565e+06
 Factor NZ  : 1.793e+07 (roughly 220 MB of memory)
 Factor Ops : 7.008e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.01266318e+07  2.18733124e+08  3.45e+05 1.98e+01  1.15e+05     4s
   1  -3.56548784e+07  2.26445645e+08  2.98e+05 6.60e+01  9.84e+04     4s
   2  -1.63992126e+07  1.84772462e+08  1.29e+05 3.19e+01  4.35e+04     4s
   3  -8.71456635e+06  1.32163129e+08  6.78e+04 9.29e+00  2.29e+04     4s
   4  -4.62856424e+06  1.31270779e+08  3.17e+04 8.92e+00  1.10e+04     5s
   5  -2.32950400e+06  8.43792619e+07  1.36e+04 1.09e+00  4.68e+03     5s
   6  -8.43299272e+05  6.85143375e+07  1.99e+03 5.54e-01  8.96e+02     5s
   7  -6.32941476e+05  5.12807997e+07  6.45e+02 3.85e-01  3.98e+02     5s
   8  -5.21831628e+05  2.64757189e+07  2.43e+02 1.58e-01  1.72e+02     5s
   9  -3.39593531e+05  1.56133035e+07  6.98e+01 7.77e-02  7.96e+01     5s
  10  -2.45742250e+05  9.76205290e+06  3.94e+01 3.24e-02  4.70e+01     5s
  11  -2.08204247e+05  7.62789843e+06  2.95e+01 1.13e-02  3.58e+01     5s
  12  -1.72328145e+05  5.31449146e+06  2.03e+01 7.51e-03  2.43e+01     5s
  13  -1.58024380e+05  3.54135753e+06  1.41e+01 4.75e-03  1.60e+01     5s
  14  -1.31297483e+05  2.65841125e+06  7.33e+00 3.50e-03  1.17e+01     5s
  15  -1.07653926e+05  1.94792723e+06  4.08e+00 2.54e-03  8.42e+00     5s
  16  -9.31897181e+04  1.52423270e+06  2.72e+00 1.96e-03  6.57e+00     5s
  17  -8.21646406e+04  6.06720965e+05  1.86e+00 7.62e-04  2.79e+00     5s
  18  -5.50533590e+04  2.05267368e+05  7.30e-01 3.45e-04  1.05e+00     5s
  19  -4.22066262e+04  7.85308416e+04  5.06e-01 9.43e-04  4.85e-01     5s
  20  -3.30983926e+04  5.42634551e+04  3.84e-01 1.21e-03  3.51e-01     6s
  21  -2.91299975e+04  3.99752165e+04  3.29e-01 1.59e-03  2.78e-01     6s
  22  -2.57204135e+04  3.19232487e+04  2.81e-01 1.68e-03  2.32e-01     6s
  23  -2.42334443e+04  2.59341919e+04  2.59e-01 1.42e-03  2.02e-01     6s
  24  -1.91984723e+04  1.78940001e+04  1.84e-01 1.37e-03  1.49e-01     6s
  25  -1.67709680e+04  1.16931868e+04  1.49e-01 1.44e-03  1.14e-01     6s
  26  -1.50943952e+04  7.12885174e+03  1.24e-01 2.84e-03  8.93e-02     6s
  27  -1.27104438e+04  4.07759338e+03  9.17e-02 2.66e-03  6.74e-02     6s
  28  -1.17804692e+04  2.86176267e+03  8.11e-02 1.96e-03  5.88e-02     6s
  29  -1.04647142e+04  1.35859677e+03  6.44e-02 1.54e-03  4.75e-02     6s
  30  -1.01752310e+04  8.83905936e+02  6.11e-02 1.34e-03  4.44e-02     6s
  31  -9.11368697e+03 -4.54766565e+02  4.89e-02 9.47e-04  3.48e-02     6s
  32  -8.67623423e+03 -1.26643614e+03  4.41e-02 9.87e-04  2.98e-02     6s
  33  -7.82400154e+03 -1.95602793e+03  3.46e-02 1.28e-03  2.36e-02     6s
  34  -7.31007332e+03 -2.59653952e+03  2.93e-02 1.41e-03  1.89e-02     6s
  35  -6.63221539e+03 -3.18258687e+03  2.21e-02 7.86e-04  1.39e-02     7s
  36  -6.13705282e+03 -3.48349546e+03  1.70e-02 5.90e-04  1.07e-02     7s
  37  -6.05086376e+03 -3.52653766e+03  1.61e-02 5.63e-04  1.01e-02     7s
  38  -5.99030073e+03 -3.77638026e+03  1.55e-02 4.03e-04  8.90e-03     7s
  39  -5.40658024e+03 -3.90762561e+03  9.58e-03 3.38e-04  6.02e-03     7s
  40  -5.17530705e+03 -4.05140148e+03  7.26e-03 4.27e-04  4.52e-03     7s
  41  -4.95912293e+03 -4.17459816e+03  5.11e-03 2.91e-04  3.15e-03     7s
  42  -4.84051226e+03 -4.27119316e+03  3.96e-03 1.64e-04  2.29e-03     7s
  43  -4.75638941e+03 -4.30784063e+03  3.15e-03 1.35e-04  1.80e-03     7s
  44  -4.65436788e+03 -4.32319877e+03  2.18e-03 1.15e-04  1.33e-03     7s
  45  -4.60468662e+03 -4.35457270e+03  1.72e-03 7.28e-05  1.01e-03     7s
  46  -4.56746508e+03 -4.36952594e+03  1.37e-03 5.20e-05  7.96e-04     7s
  47  -4.50689214e+03 -4.38824077e+03  8.25e-04 2.82e-05  4.77e-04     8s
  48  -4.47288382e+03 -4.39897850e+03  5.19e-04 1.49e-05  2.97e-04     8s
  49  -4.45366502e+03 -4.40532579e+03  3.45e-04 7.58e-06  1.94e-04     8s
  50  -4.44390002e+03 -4.40622112e+03  2.61e-04 6.56e-06  1.52e-04     8s
  51  -4.42965792e+03 -4.40910964e+03  1.42e-04 3.34e-06  8.26e-05     8s
  52  -4.41805689e+03 -4.41181976e+03  4.58e-05 4.04e-07  2.51e-05     8s
  53  -4.41709272e+03 -4.41226112e+03  3.75e-05 1.19e-07  1.95e-05     8s
  54  -4.41632807e+03 -4.41237053e+03  3.11e-05 1.37e-08  1.59e-05     8s
  55  -4.41288163e+03 -4.41239096e+03  3.27e-06 9.70e-09  1.97e-06     8s
  56  -4.41248669e+03 -4.41243411e+03  7.59e-07 1.10e-07  2.11e-07     8s
  57  -4.41248190e+03 -4.41243990e+03  6.08e-07 9.93e-08  1.68e-07     8s
  58  -4.41248139e+03 -4.41244029e+03  8.13e-07 1.36e-07  1.65e-07     8s
  59  -4.41247780e+03 -4.41244470e+03  7.71e-07 1.09e-07  1.32e-07     9s
  60  -4.41247711e+03 -4.41244603e+03  7.30e-07 1.01e-07  1.24e-07     9s
  61  -4.41247288e+03 -4.41245411e+03  4.98e-07 5.51e-08  7.49e-08     9s
  62  -4.41247235e+03 -4.41245468e+03  4.68e-07 5.13e-08  7.05e-08     9s
  63  -4.41247113e+03 -4.41245596e+03  4.00e-07 4.42e-08  6.05e-08     9s
  64  -4.41246590e+03 -4.41246382e+03  1.13e-07 3.55e-09  8.29e-09     9s
  65  -4.41246589e+03 -4.41246382e+03  2.21e-06 3.53e-09  8.13e-09     9s
  66  -4.41246408e+03 -4.41246386e+03  2.62e-06 9.44e-07  1.14e-09     9s
  67  -4.41246405e+03 -4.41246385e+03  2.15e-06 6.17e-07  9.75e-10     9s
  68  -4.41246406e+03 -4.41246385e+03  2.36e-06 6.18e-07  9.75e-10     9s
  69  -4.41246407e+03 -4.41246384e+03  2.36e-06 5.31e-07  1.01e-09     9s

Barrier solved model in 69 iterations and 9.45 seconds (17.84 work units)
Optimal objective -4.41246407e+03


Root crossover log...

  112484 DPushes remaining with DInf 0.0000000e+00                10s
   55612 DPushes remaining with DInf 0.0000000e+00                10s
   23174 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

   25091 PPushes remaining with PInf 3.6464459e-04                19s
   13680 PPushes remaining with PInf 3.2043407e-04                20s
       0 PPushes remaining with PInf 2.6120871e-09                22s

  Push phase complete: Pinf 2.6120871e-09, Dinf 1.8270910e+05     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   90866   -4.4124638e+03   0.000000e+00   1.827091e+05     22s
   91937   -4.4124638e+03   0.000000e+00   0.000000e+00     24s
   91937   -4.4124638e+03   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 0.35s

Solved with barrier

Root relaxation: objective -4.412464e+03, 91937 iterations, 21.30 seconds (36.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4412.4638    0  432 -217728.64 -4412.4638  98.0%     -   25s
H    0     0                    -111304.0648 -4412.4638  96.0%     -   25s
H    0     0                    -91556.85479 -4412.4638  95.2%     -   25s
H    0     0                    -91360.42327 -4412.4638  95.2%     -   25s
H    0     0                    -86547.67923 -4412.4638  94.9%     -   25s
H    0     0                    -70185.89376 -4412.4638  93.7%     -   26s
H    0     0                    -55905.81065 -4412.4638  92.1%     -   26s
H    0     0                    -52442.23611 -4412.4638  91.6%     -   26s
H    0     0                    -52401.11753 -4412.4638  91.6%     -   26s
     0     0 -8441.0335    0  573 -52401.118 -8441.0335  83.9%     -  125s
H    0     0                    -50972.64976 -8441.4163  83.4%     -  126s
H    0     0                    -48880.43357 -8441.4163  82.7%     -  126s
H    0     0                    -48682.42192 -8441.4163  82.7%     -  126s
H    0     0                    -48463.79470 -8441.4163  82.6%     -  126s
     0     0 -8718.4555    0  574 -48463.795 -8718.4555  82.0%     -  150s
     0     0 -8748.3393    0  568 -48463.795 -8748.3393  81.9%     -  156s
     0     0 -8763.4633    0  571 -48463.795 -8763.4633  81.9%     -  158s
     0     0 -8781.3759    0  568 -48463.795 -8781.3759  81.9%     -  166s
     0     0 -8804.7463    0  576 -48463.795 -8804.7463  81.8%     -  171s
     0     0 -8812.6430    0  580 -48463.795 -8812.6430  81.8%     -  174s
     0     0 -8819.8478    0  581 -48463.795 -8819.8478  81.8%     -  176s
     0     0 -8821.7746    0  571 -48463.795 -8821.7746  81.8%     -  177s
     0     0 -8822.2399    0  580 -48463.795 -8822.2399  81.8%     -  178s
     0     0 -8822.3515    0  580 -48463.795 -8822.3515  81.8%     -  179s
     0     0 -11063.856    0  585 -48463.795 -11063.856  77.2%     -  270s
H    0     0                    -32779.76812 -11063.889  66.2%     -  271s
H    0     0                    -32769.91684 -11063.889  66.2%     -  271s
H    0     0                    -32015.81227 -11063.889  65.4%     -  271s
H    0     0                    -31289.73222 -11063.889  64.6%     -  271s
H    0     0                    -31251.58517 -11063.889  64.6%     -  271s
H    0     0                    -31127.86955 -11063.889  64.5%     -  272s
H    0     0                    -30792.11116 -11063.889  64.1%     -  272s
H    0     0                    -30785.18477 -11063.889  64.1%     -  272s
H    0     0                    -30740.77353 -11063.889  64.0%     -  272s
H    0     0                    -30733.84714 -11063.889  64.0%     -  272s
H    0     0                    -30733.23143 -11063.889  64.0%     -  272s
     0     0 -11190.682    0  619 -30733.231 -11190.682  63.6%     -  302s
     0     0 -11215.643    0  636 -30733.231 -11215.643  63.5%     -  317s
     0     0 -11224.284    0  621 -30733.231 -11224.284  63.5%     -  328s
     0     0 -11250.599    0  615 -30733.231 -11250.599  63.4%     -  337s
     0     0 -11254.492    0  620 -30733.231 -11254.492  63.4%     -  340s
     0     0 -11257.436    0  601 -30733.231 -11257.436  63.4%     -  344s
     0     0 -11260.288    0  609 -30733.231 -11260.288  63.4%     -  348s
     0     0 -11261.783    0  618 -30733.231 -11261.783  63.4%     -  349s
     0     0 -11261.787    0  618 -30733.231 -11261.787  63.4%     -  350s
     0     0 -13110.935    0  501 -30733.231 -13110.935  57.3%     -  469s
H    0     0                    -30419.09723 -13110.957  56.9%     -  470s
     0     0 -13427.340    0  673 -30419.097 -13427.340  55.9%     -  522s
     0     0 -13505.712    0  661 -30419.097 -13505.712  55.6%     -  558s
     0     0 -13790.097    0  691 -30419.097 -13790.097  54.7%     -  603s
     0     0 -13830.133    0  696 -30419.097 -13830.133  54.5%     -  631s
     0     0 -13850.705    0  709 -30419.097 -13850.705  54.5%     -  654s
     0     0 -13857.063    0  703 -30419.097 -13857.063  54.4%     -  666s
     0     0 -13866.489    0  704 -30419.097 -13866.489  54.4%     -  675s
     0     0 -13876.433    0  761 -30419.097 -13876.433  54.4%     -  687s
     0     0 -13879.982    0  760 -30419.097 -13879.982  54.4%     -  694s
     0     0 -13882.381    0  751 -30419.097 -13882.381  54.4%     -  701s
     0     0 -13883.450    0  756 -30419.097 -13883.450  54.4%     -  707s
     0     0 -14635.324    0  773 -30419.097 -14635.324  51.9%     -  851s
H    0     0                    -30332.82532 -14635.396  51.8%     -  852s
     0     0 -14719.531    0  768 -30332.825 -14719.531  51.5%     -  879s
     0     0 -14744.333    0  781 -30332.825 -14744.333  51.4%     -  895s
     0     0 -14754.492    0  785 -30332.825 -14754.492  51.4%     -  907s
     0     0 -14757.846    0  730 -30332.825 -14757.846  51.3%     -  911s
     0     0 -14761.790    0  726 -30332.825 -14761.790  51.3%     -  917s
     0     0 -14762.504    0  732 -30332.825 -14762.504  51.3%     -  919s
     0     0 -14985.808    0  775 -30332.825 -14985.808  50.6%     -  977s
     0     0 -15040.184    0  786 -30332.825 -15040.184  50.4%     - 1009s
     0     0 -15062.230    0  782 -30332.825 -15062.230  50.3%     - 1034s
     0     0 -15078.480    0  728 -30332.825 -15078.480  50.3%     - 1052s
     0     0 -15088.439    0  742 -30332.825 -15088.439  50.3%     - 1067s
     0     0 -15089.562    0  738 -30332.825 -15089.562  50.3%     - 1071s
     0     0 -15184.499    0  773 -30332.825 -15184.499  49.9%     - 1107s
H    0     0                    -30323.44167 -15184.514  49.9%     - 1113s
H    0     0                    -30320.31058 -15184.514  49.9%     - 1113s
     0     0 -15209.608    0  787 -30320.311 -15209.608  49.8%     - 1136s
     0     0 -15230.573    0  798 -30320.311 -15230.573  49.8%     - 1162s
     0     0 -15232.934    0  797 -30320.311 -15232.934  49.8%     - 1169s
     0     0 -15234.095    0  804 -30320.311 -15234.095  49.8%     - 1173s
     0     0 -15278.138    0  747 -30320.311 -15278.138  49.6%     - 1205s
     0     0 -15291.168    0  741 -30320.311 -15291.168  49.6%     - 1225s
     0     0 -15293.860    0  803 -30320.311 -15293.860  49.6%     - 1231s
     0     0 -15295.341    0  817 -30320.311 -15295.341  49.6%     - 1236s
     0     0 -15317.967    0  796 -30320.311 -15317.967  49.5%     - 1264s
H    0     0                    -30279.72042 -15317.982  49.4%     - 1267s
H    0     0                    -30278.28708 -15317.982  49.4%     - 1267s
H    0     0                    -30245.02386 -15317.982  49.4%     - 1267s
H    0     0                    -30235.83747 -15317.982  49.3%     - 1267s
H    0     0                    -30227.92842 -15317.982  49.3%     - 1267s
     0     0 -15326.634    0  731 -30227.928 -15326.634  49.3%     - 1282s
     0     0 -15329.148    0  680 -30227.928 -15329.148  49.3%     - 1291s
     0     0 -15331.048    0  686 -30227.928 -15331.048  49.3%     - 1298s
     0     0 -15331.703    0  746 -30227.928 -15331.703  49.3%     - 1302s
     0     0 -15352.658    0  665 -30227.928 -15352.658  49.2%     - 1327s
     0     0 -15356.981    0  675 -30227.928 -15356.981  49.2%     - 1340s
     0     0 -15357.918    0  731 -30227.928 -15357.918  49.2%     - 1345s
     0     0 -15363.772    0  672 -30227.928 -15363.772  49.2%     - 1363s
H    0     0                    -30116.67823 -15363.775  49.0%     - 1365s
H    0     0                    -30081.59809 -15363.775  48.9%     - 1365s
H    0     0                    -30077.26577 -15363.775  48.9%     - 1365s
H    0     0                    -30072.99900 -15363.775  48.9%     - 1365s
H    0     0                    -30015.57508 -15363.775  48.8%     - 1366s
H    0     0                    -29948.29004 -15363.775  48.7%     - 1366s
     0     0 -15365.499    0  680 -29948.290 -15365.499  48.7%     - 1373s
     0     0 -15371.160    0  724 -29948.290 -15371.160  48.7%     - 1391s
     0     0 -15371.165    0  724 -29948.290 -15371.165  48.7%     - 1401s
H    0     0                    -29823.10469 -15371.215  48.5%     - 1490s
H    0     0                    -29794.79299 -15371.215  48.4%     - 1490s
H    0     0                    -29759.79243 -15371.215  48.3%     - 1490s
H    0     0                    -29753.44078 -15371.215  48.3%     - 1490s
H    0     0                    -29751.82500 -15371.215  48.3%     - 1490s
H    0     0                    -29739.85039 -15371.215  48.3%     - 1490s
H    0     0                    -29733.49873 -15371.215  48.3%     - 1490s
H    0     0                    -29728.47256 -15371.215  48.3%     - 1490s
H    0     0                    -29726.82092 -15371.215  48.3%     - 1490s
H    0     0                    -29720.46927 -15371.215  48.3%     - 1490s
H    0     0                    -28746.07396 -15371.215  46.5%     - 1549s
H    0     0                    -28222.74103 -15371.215  45.5%     - 1549s
H    0     0                    -28190.86950 -15371.215  45.5%     - 1550s
H    0     0                    -28113.92384 -15371.215  45.3%     - 1550s
H    0     0                    -28054.31945 -15371.215  45.2%     - 1550s
H    0     0                    -28043.56108 -15371.215  45.2%     - 1550s
     0     2 -15371.215    0  724 -28043.561 -15371.215  45.2%     - 1553s
     1     3 -15522.079    1  642 -28043.561 -15371.219  45.2% 17927 1587s
     2     4 -15520.769    1  778 -28043.561 -15520.769  44.7% 18632 1620s
     3     6 -16313.082    2  526 -28043.561 -15520.817  44.7% 16910 1645s
     5    12 -15944.228    3  615 -28043.561 -15520.817  44.7% 13920 1675s
    11    22 -16026.136    4  601 -28043.561 -15568.524  44.5% 13521 1762s
    21    33 -21750.821    5  278 -28043.561 -15568.524  44.5% 23111 1859s
    32    64 -16208.775    4  610 -28043.561 -15750.643  43.8% 22318 2101s
H   35    64                    -28019.96265 -15750.643  43.8% 21810 2101s
H   37    64                    -27916.24466 -15750.643  43.6% 21065 2101s
H   40    64                    -27778.01055 -15750.643  43.3% 19819 2101s
    63    96 -16236.400    5  605 -27778.011 -15769.443  43.2% 28329 2168s
H   95   169                    -27755.39325 -15785.144  43.1% 22176 2212s
H   96   169                    -27422.27106 -15785.144  42.4% 22022 2212s
H  102   169                    -27405.91863 -15785.144  42.4% 21215 2212s
H  109   169                    -27404.82389 -15785.144  42.4% 20269 2212s
H  125   169                    -27369.78158 -15785.144  42.3% 17990 2212s
H  133   169                    -27190.15030 -15785.144  41.9% 17442 2212s
   168   274 -16469.066    7  600 -27190.150 -15785.144  41.9% 15586 2249s
   273   354 -16699.197    8  593 -27190.150 -15785.144  41.9% 11631 2276s
   353   429 -16736.906    9  601 -27190.150 -15785.144  41.9%  9982 2299s
   430   455 -16806.679   10  590 -27190.150 -15785.144  41.9%  9157 2320s
   482   499 -20981.836   19  197 -27190.150 -15785.144  41.9%  8750 2341s
   545   516 -21339.451   20  207 -27190.150 -15785.144  41.9%  8544 2363s
   608   552 -25927.948   21  204 -27190.150 -15785.144  41.9%  8363 2384s
   680   596 infeasible   22      -27190.150 -15785.144  41.9%  7971 2405s
   750   653 -27073.841   23  168 -27190.150 -15785.144  41.9%  7812 2423s
   848   721 -24033.343   26  159 -27190.150 -15785.144  41.9%  7357 2440s
   965   762 -26448.787   29  114 -27190.150 -15785.144  41.9%  6927 2459s
  1095   781 -27110.312   30  104 -27190.150 -15785.144  41.9%  6491 2479s
  1130   790 infeasible   31      -27190.150 -15785.144  41.9%  6468 2497s
  1170   814 -26576.618   27  184 -27190.150 -15785.144  41.9%  6373 2512s
  1200   827 -26629.923   28  155 -27190.150 -15785.144  41.9%  6304 2531s
  1252   841 -26774.565   29  171 -27190.150 -15785.144  41.9%  6201 2551s
  1299   844 -26833.618   30  146 -27190.150 -15785.144  41.9%  6052 2569s
  1352   840 -26840.037   30  162 -27190.150 -15785.144  41.9%  5931 2590s
  1424   834 infeasible   31      -27190.150 -15785.144  41.9%  5769 2613s
  1470   824 infeasible   30      -27190.150 -15785.144  41.9%  5690 2637s
  1524   850 -23507.872   10  403 -27190.150 -15785.144  41.9%  5683 2665s
  1586   887 -23285.391    9  257 -27190.150 -15785.144  41.9%  5725 2689s
  1693   913 -25064.513   13  308 -27190.150 -15785.144  41.9%  5722 2718s
  1769   935 infeasible   10      -27190.150 -15973.315  41.3%  5685 2750s
  1868   990 -19856.204    7  178 -27190.150 -15973.315  41.3%  5684 2781s
  2008  1001 -21550.400    8  183 -27190.150 -15973.315  41.3%  5599 2814s
  2092  1104 -21885.776    9  178 -27190.150 -15973.315  41.3%  5569 2849s
  2231  1286 -22639.144   10  180 -27190.150 -15973.315  41.3%  5493 2879s
  2510  1265 -25023.285   13  144 -27190.150 -15973.315  41.3%  5167 2914s
  2656  1262 -25080.025   14  140 -27190.150 -15973.315  41.3%  5073 2950s
  2713  1282 -19722.604    8  186 -27190.150 -15973.315  41.3%  5129 2988s
  2745  1316 -21544.233    9  116 -27190.150 -16105.362  40.8%  5225 3028s
  2822  1345 infeasible   11      -27190.150 -16499.840  39.3%  5360 3065s
  2912  1353 -25275.131   12  118 -27190.150 -16499.840  39.3%  5487 3104s
  2986  1383 -26340.747   13  104 -27190.150 -16499.840  39.3%  5613 3144s
  3058  1386 -19235.114    8  460 -27190.150 -16499.840  39.3%  5750 3189s
  3144  1416 -20331.961    8  537 -27190.150 -16499.840  39.3%  5866 3230s
  3186  1448 -20569.333    9  417 -27190.150 -16499.840  39.3%  6007 3274s
  3268  1458 -20992.622   11  440 -27190.150 -16499.840  39.3%  6196 3318s
  3366  1499 -24706.226   12  439 -27190.150 -16499.840  39.3%  6313 3366s
  3511  1576 -25683.832   13  476 -27190.150 -16499.840  39.3%  6395 3416s
  3693  1606 -25725.661   11  133 -27190.150 -16499.840  39.3%  6423 3462s
  3837  1628 -26645.226   12  194 -27190.150 -16499.840  39.3%  6525 3520s
  3962  1671 -21585.778   14  520 -27190.150 -16499.840  39.3%  6659 3583s
  4047  1683 infeasible   15      -27190.150 -16499.840  39.3%  6844 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 187
  MIR: 4363
  Flow cover: 4369
  Zero half: 8
  RLT: 128
  Relax-and-lift: 645

Explored 4079 nodes (28729981 simplex iterations) in 3600.06 seconds (8080.28 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -27190.2 -27369.8 -27404.8 ... -28043.6

Time limit reached
Best objective -2.719015029675e+04, best bound -1.649984024331e+04, gap 39.3168%
  WARNING: Time limit reached. Using best solution found (gap: 39.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = -27190.15, θ = 94029.44
  Upper Bound (UB) = -27190.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94029.44
  [DEBUG]   ✓ Scenario 0: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94029.44 ≤ Q = 94029.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94029.44 ≤ Q = 94029.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94029.44 ≤ Q = 94029.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 94029.44 ≤ Q = 94029.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 94029.44 ≤ Q = 94029.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 94029.44 ≤ Q = 94029.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 94029.44 ≤ Q = 94029.44 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d4fc1a8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc2b03e58
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.081568e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5142567.0368
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.118597e+05, 224 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111859.69    0  120 5142567.04 -111859.69   102%     -    0s
H    0     0                    -78869.18041 -111859.69  41.8%     -    0s
H    0     0                    -79543.03555 -111859.69  40.6%     -    0s
     0     0 -84233.404    0   33 -79543.036 -84233.404  5.90%     -    0s
H    0     0                    -82668.13032 -84207.517  1.86%     -    0s
H    0     0                    -82673.35531 -84207.517  1.86%     -    0s
H    0     0                    -82821.85203 -84207.517  1.67%     -    0s
H    0     0                    -82827.07701 -84207.517  1.67%     -    0s
     0     0 -83963.144    0   35 -82827.077 -83963.144  1.37%     -    0s
     0     0 -83927.407    0   35 -82827.077 -83927.407  1.33%     -    0s
     0     0 -83544.069    0   27 -82827.077 -83544.069  0.87%     -    0s
H    0     0                    -83159.29021 -83517.740  0.43%     -    0s
     0     0 -83458.520    0   12 -83159.290 -83458.520  0.36%     -    0s
     0     0 -83412.987    0   10 -83159.290 -83412.987  0.31%     -    0s
H    0     0                    -83246.09191 -83393.090  0.18%     -    0s
     0     0 -83393.090    0    7 -83246.092 -83393.090  0.18%     -    0s
     0     0 -83382.153    0    7 -83246.092 -83382.153  0.16%     -    0s
     0     0 -83373.558    0    7 -83246.092 -83373.558  0.15%     -    0s
     0     0 -83373.558    0   18 -83246.092 -83373.558  0.15%     -    0s
H    0     0                    -83255.32082 -83373.558  0.14%     -    0s
*    0     0               0    -83370.74237 -83370.742  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 16
  Flow cover: 3

Explored 1 nodes (571 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -83370.7 -83255.3 -83246.1 ... 1.08157e+13
No other solutions better than -83370.7

Optimal solution found (tolerance 1.00e-06)
Best objective -8.337074236848e+04, best bound -8.337074236848e+04, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 90279.01
  Scenario: 10 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83370.74
  [DEBUG]   S×d_nominal = 173649.75
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173649.75 + -83370.74 = 90279.01
  [DEBUG]   Current θ from Master = 94029.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3750.43 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30940.58
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 1437.4168, Absolute Gap = 1437.4168, Relative Gap = 0.052865
  Not converged yet (gap = 1437.42 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 49 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783569 nonzeros
Model fingerprint: 0x8e43474f
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 131236 rows and 53306 columns
Presolve time: 2.90s
Presolved: 145367 rows, 61274 columns, 896737 nonzeros
Variable types: 59015 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387251.2280
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.41s

Barrier statistics:
 Dense cols : 577
 AA' NZ     : 8.429e+06
 Factor NZ  : 1.854e+07 (roughly 230 MB of memory)
 Factor Ops : 4.532e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.01550707e+07  2.29482471e+08  3.46e+05 1.98e+01  1.14e+05     5s
   1  -3.57415021e+07  2.36604435e+08  3.00e+05 6.28e+01  9.81e+04     5s
   2  -1.61068684e+07  1.77172554e+08  1.28e+05 1.95e+01  4.31e+04     5s
   3  -1.01939206e+07  1.52450319e+08  8.01e+04 1.16e+01  2.71e+04     5s
   4  -2.13380494e+06  1.37036813e+08  1.23e+04 7.04e+00  4.68e+03     5s
   5  -1.06392685e+06  8.83664661e+07  3.90e+03 2.20e+00  1.60e+03     5s
   6  -6.43946968e+05  6.37402851e+07  8.16e+02 1.37e+00  4.95e+02     5s
   7  -5.47243816e+05  3.64878746e+07  3.35e+02 6.64e-01  2.33e+02     5s
   8  -4.34918535e+05  2.05906543e+07  1.15e+02 3.28e-01  1.08e+02     5s
   9  -3.08463752e+05  1.70089535e+07  4.91e+01 2.58e-01  7.63e+01     5s
  10  -2.40886672e+05  9.77672337e+06  2.96e+01 1.18e-01  4.25e+01     6s
  11  -1.78594453e+05  7.32462752e+06  1.68e+01 2.73e-02  3.05e+01     6s
  12  -1.49474174e+05  5.63445618e+06  1.01e+01 3.37e-02  2.29e+01     6s
  13  -1.46034217e+05  3.62742829e+06  7.89e+00 1.75e-02  1.48e+01     6s
  14  -1.08481705e+05  2.44928216e+06  3.06e+00 2.92e-02  9.82e+00     6s
  15  -8.63199766e+04  1.02937510e+06  1.50e+00 1.24e-03  4.25e+00     6s
  16  -6.68141769e+04  5.73826013e+05  7.18e-01 7.01e-04  2.43e+00     6s
  17  -5.08579686e+04  2.17996152e+05  3.72e-01 2.99e-04  1.02e+00     6s
  18  -3.92285551e+04  1.21787695e+05  2.41e-01 2.15e-04  6.09e-01     6s
  19  -3.41523754e+04  9.60344711e+04  2.03e-01 2.62e-04  4.92e-01     6s
  20  -2.67204760e+04  5.65875388e+04  1.46e-01 1.08e-03  3.15e-01     6s
  21  -2.26613047e+04  3.67482521e+04  1.17e-01 8.97e-04  2.25e-01     6s
  22  -2.01224586e+04  2.69941524e+04  9.66e-02 1.16e-03  1.78e-01     6s
  23  -1.71828032e+04  1.91651720e+04  7.46e-02 9.27e-04  1.37e-01     6s
  24  -1.58066123e+04  1.05417418e+04  6.41e-02 9.63e-04  9.97e-02     6s
  25  -1.45994555e+04  7.02793943e+03  5.63e-02 1.30e-03  8.18e-02     7s
  26  -1.20838741e+04  5.38464618e+03  4.02e-02 1.47e-03  6.61e-02     7s
  27  -1.17265418e+04  3.18390245e+03  3.83e-02 1.17e-03  5.64e-02     7s
  28  -1.03265223e+04  1.80108542e+03  3.08e-02 9.43e-04  4.59e-02     7s
  29  -9.73840253e+03 -2.31148901e+02  2.73e-02 6.57e-04  3.60e-02     7s
  30  -8.90892454e+03 -1.25092126e+03  2.29e-02 6.31e-04  2.90e-02     7s
  31  -7.74444197e+03 -2.04931376e+03  1.66e-02 4.38e-04  2.16e-02     7s
  32  -7.32554990e+03 -2.77978929e+03  1.43e-02 3.27e-04  1.72e-02     7s
  33  -6.98843622e+03 -3.12308880e+03  1.26e-02 2.55e-04  1.46e-02     7s
  34  -6.68782861e+03 -3.30106149e+03  1.11e-02 2.20e-04  1.28e-02     7s
  35  -6.10844892e+03 -3.68148327e+03  8.09e-03 1.45e-04  9.19e-03     7s
  36  -5.62087320e+03 -3.89157283e+03  5.60e-03 1.04e-04  6.55e-03     7s
  37  -5.35354633e+03 -4.13063588e+03  4.27e-03 1.56e-04  4.63e-03     8s
  38  -5.28208439e+03 -4.22034212e+03  3.92e-03 1.33e-04  4.02e-03     8s
  39  -4.98618386e+03 -4.27228961e+03  2.45e-03 1.10e-04  2.70e-03     8s
  40  -4.81427624e+03 -4.31413014e+03  1.60e-03 1.03e-04  1.89e-03     8s
  41  -4.65653883e+03 -4.37443431e+03  8.64e-04 6.15e-05  1.07e-03     8s
  42  -4.61226655e+03 -4.41497935e+03  6.54e-04 3.48e-05  7.47e-04     8s
  43  -4.57955081e+03 -4.42583290e+03  5.00e-04 2.78e-05  5.82e-04     8s
  44  -4.56606513e+03 -4.43210319e+03  4.38e-04 2.38e-05  5.07e-04     8s
  45  -4.55832857e+03 -4.43434101e+03  4.01e-04 2.23e-05  4.69e-04     8s
  46  -4.55358855e+03 -4.43820938e+03  3.79e-04 1.99e-05  4.37e-04     8s
  47  -4.53298374e+03 -4.44722125e+03  2.87e-04 1.40e-05  3.25e-04     8s
  48  -4.53082837e+03 -4.44802691e+03  2.78e-04 1.35e-05  3.13e-04     9s
  49  -4.52878263e+03 -4.44994546e+03  2.68e-04 1.22e-05  2.98e-04     9s
  50  -4.52010434e+03 -4.45142879e+03  2.28e-04 1.12e-05  2.60e-04     9s
  51  -4.50430480e+03 -4.45883909e+03  1.54e-04 6.62e-06  1.72e-04     9s
  52  -4.49856107e+03 -4.46079541e+03  1.27e-04 5.34e-06  1.43e-04     9s
  53  -4.48979725e+03 -4.46278045e+03  8.82e-05 4.13e-06  1.02e-04     9s
  54  -4.47824734e+03 -4.46638612e+03  3.71e-05 1.80e-06  4.49e-05     9s
  55  -4.47564212e+03 -4.46791113e+03  2.59e-05 8.39e-07  2.93e-05     9s
  56  -4.47395100e+03 -4.46872974e+03  1.87e-05 3.41e-07  1.98e-05     9s
  57  -4.47248180e+03 -4.46912896e+03  1.25e-05 1.14e-07  1.27e-05     9s
  58  -4.46959315e+03 -4.46933211e+03  7.75e-07 1.87e-08  9.89e-07     9s
  59  -4.46940789e+03 -4.46938101e+03  1.06e-07 6.32e-08  1.02e-07     9s
  60  -4.46940182e+03 -4.46938242e+03  3.82e-07 4.51e-08  7.34e-08    10s
  61  -4.46938760e+03 -4.46938593e+03  9.00e-08 3.38e-10  6.31e-09    10s
  62  -4.46938618e+03 -4.46938597e+03  9.44e-08 6.44e-11  7.75e-10    10s
  63  -4.46938605e+03 -4.46938597e+03  1.10e-06 7.66e-10  3.96e-10    10s
  64  -4.46938602e+03 -4.46938597e+03  5.91e-07 4.00e-08  2.13e-10    10s
  65  -4.46938599e+03 -4.46938597e+03  2.51e-07 1.69e-08  9.03e-11    10s

Barrier solved model in 65 iterations and 9.97 seconds (18.25 work units)
Optimal objective -4.46938599e+03


Root crossover log...

   27644 variables added to crossover basis                       10s

  117513 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    6789 PPushes remaining with PInf 1.0390725e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1542329e+01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64700   -4.4693860e+03   0.000000e+00   1.154233e+01     14s
   64710   -4.4693860e+03   0.000000e+00   0.000000e+00     15s
   64710   -4.4693860e+03   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 6.40s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -4.469386e+03, 64710 iterations, 17.29 seconds (25.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4469.3860    0  451 -217728.64 -4469.3860  97.9%     -   21s
H    0     0                    -189590.5950 -4469.3860  97.6%     -   22s
H    0     0                    -117838.5077 -4469.3860  96.2%     -   22s
H    0     0                    -79996.30373 -4469.3860  94.4%     -   22s
H    0     0                    -54024.19149 -4469.3860  91.7%     -   23s
H    0     0                    -53964.76926 -4469.3860  91.7%     -   23s
H    0     0                    -53839.31189 -4469.3860  91.7%     -   23s
H    0     0                    -53731.48524 -4469.3860  91.7%     -   23s
     0     0 -8775.3687    0  582 -53731.485 -8775.3687  83.7%     -   86s
     0     0 -8775.3687    0  582 -53731.485 -8775.3687  83.7%     -   87s
H    0     0                    -41048.73185 -8775.5706  78.6%     -   87s
H    0     0                    -36584.54867 -8775.5706  76.0%     -   88s
H    0     0                    -36530.45738 -8775.5706  76.0%     -   88s
H    0     0                    -36423.26307 -8775.5706  75.9%     -   88s
H    0     0                    -36387.71641 -8775.5706  75.9%     -   88s
H    0     0                    -36307.93898 -8775.5706  75.8%     -   88s
H    0     0                    -36262.29622 -8775.5706  75.8%     -   88s
     0     0 -8910.9443    0  584 -36262.296 -8910.9443  75.4%     -  105s
     0     0 -8920.9658    0  589 -36262.296 -8920.9658  75.4%     -  108s
     0     0 -8922.4201    0  589 -36262.296 -8922.4201  75.4%     -  109s
     0     0 -8938.4570    0  581 -36262.296 -8938.4570  75.4%     -  111s
     0     0 -8939.5682    0  583 -36262.296 -8939.5682  75.3%     -  112s
     0     0 -8947.7476    0  599 -36262.296 -8947.7476  75.3%     -  115s
     0     0 -8949.0615    0  595 -36262.296 -8949.0615  75.3%     -  116s
     0     0 -8951.4678    0  593 -36262.296 -8951.4678  75.3%     -  116s
     0     0 -8951.4797    0  593 -36262.296 -8951.4797  75.3%     -  117s
     0     0 -10494.370    0  587 -36262.296 -10494.370  71.1%     -  174s
H    0     0                    -34912.33311 -10494.451  69.9%     -  174s
H    0     0                    -34746.97237 -10494.451  69.8%     -  174s
H    0     0                    -34710.00129 -10494.451  69.8%     -  174s
H    0     0                    -34693.43678 -10494.451  69.8%     -  174s
H    0     0                    -34655.00060 -10494.451  69.7%     -  174s
     0     0 -10919.846    0  564 -34655.001 -10919.846  68.5%     -  229s
     0     0 -11041.327    0  592 -34655.001 -11041.327  68.1%     -  260s
     0     0 -11055.992    0  608 -34655.001 -11055.992  68.1%     -  271s
     0     0 -11059.453    0  605 -34655.001 -11059.453  68.1%     -  278s
     0     0 -11063.289    0  601 -34655.001 -11063.289  68.1%     -  283s
     0     0 -11076.253    0  604 -34655.001 -11076.253  68.0%     -  291s
     0     0 -11078.524    0  605 -34655.001 -11078.524  68.0%     -  295s
     0     0 -11114.012    0  597 -34655.001 -11114.012  67.9%     -  304s
     0     0 -11121.719    0  608 -34655.001 -11121.719  67.9%     -  317s
     0     0 -11129.237    0  610 -34655.001 -11129.237  67.9%     -  322s
     0     0 -11139.358    0  608 -34655.001 -11139.358  67.9%     -  333s
     0     0 -11140.828    0  609 -34655.001 -11140.828  67.9%     -  338s
     0     0 -11142.237    0  605 -34655.001 -11142.237  67.8%     -  342s
     0     0 -11142.336    0  612 -34655.001 -11142.336  67.8%     -  343s
     0     0 -12720.547    0  644 -34655.001 -12720.547  63.3%     -  467s
H    0     0                    -34358.77535 -12720.550  63.0%     -  468s
H    0     0                    -34021.81022 -12720.550  62.6%     -  468s
H    0     0                    -34012.86923 -12720.550  62.6%     -  468s
H    0     0                    -33687.30953 -12720.550  62.2%     -  468s
H    0     0                    -33223.25650 -12720.550  61.7%     -  468s
     0     0 -12939.363    0  628 -33223.256 -12939.363  61.1%     -  525s
     0     0 -13071.111    0  587 -33223.256 -13071.111  60.7%     -  557s
     0     0 -13118.570    0  624 -33223.256 -13118.570  60.5%     -  590s
     0     0 -13126.190    0  600 -33223.256 -13126.190  60.5%     -  599s
     0     0 -13127.942    0  585 -33223.256 -13127.942  60.5%     -  602s
     0     0 -13130.454    0  595 -33223.256 -13130.454  60.5%     -  606s
     0     0 -13131.033    0  585 -33223.256 -13131.033  60.5%     -  609s
     0     0 -13686.406    0  661 -33223.256 -13686.406  58.8%     -  737s
H    0     0                    -33131.24888 -13686.427  58.7%     -  738s
H    0     0                    -33129.15966 -13686.427  58.7%     -  738s
     0     0 -13855.063    0  687 -33129.160 -13855.063  58.2%     -  782s
     0     0 -13912.610    0  671 -33129.160 -13912.610  58.0%     -  805s
     0     0 -13953.106    0  695 -33129.160 -13953.106  57.9%     -  826s
     0     0 -13962.955    0  700 -33129.160 -13962.955  57.9%     -  839s
     0     0 -13965.523    0  707 -33129.160 -13965.523  57.8%     -  849s
     0     0 -13971.909    0  692 -33129.160 -13971.909  57.8%     -  857s
     0     0 -13974.464    0  701 -33129.160 -13974.464  57.8%     -  861s
     0     0 -13988.504    0  693 -33129.160 -13988.504  57.8%     -  866s
     0     0 -13994.032    0  682 -33129.160 -13994.032  57.8%     -  873s
     0     0 -13998.285    0  686 -33129.160 -13998.285  57.7%     -  883s
     0     0 -13998.427    0  695 -33129.160 -13998.427  57.7%     -  885s
     0     0 -14218.560    0  599 -33129.160 -14218.560  57.1%     -  944s
H    0     0                    -32974.61624 -14218.589  56.9%     -  944s
H    0     0                    -32790.66430 -14218.589  56.6%     -  944s
H    0     0                    -32777.58333 -14218.589  56.6%     -  944s
     0     0 -14297.138    0  670 -32777.583 -14297.138  56.4%     -  979s
     0     0 -14330.300    0  734 -32777.583 -14330.300  56.3%     - 1002s
     0     0 -14343.945    0  729 -32777.583 -14343.945  56.2%     - 1016s
     0     0 -14357.136    0  751 -32777.583 -14357.136  56.2%     - 1029s
     0     0 -14364.300    0  752 -32777.583 -14364.300  56.2%     - 1038s
     0     0 -14366.464    0  761 -32777.583 -14366.464  56.2%     - 1043s
     0     0 -14367.907    0  755 -32777.583 -14367.907  56.2%     - 1049s
     0     0 -14500.243    0  689 -32777.583 -14500.243  55.8%     - 1091s
H    0     0                    -32764.92844 -14500.275  55.7%     - 1093s
H    0     0                    -32738.10922 -14500.275  55.7%     - 1093s
H    0     0                    -32686.52916 -14500.275  55.6%     - 1094s
H    0     0                    -32685.06405 -14500.275  55.6%     - 1094s
H    0     0                    -32680.33406 -14500.275  55.6%     - 1094s
     0     0 -14540.142    0  694 -32680.334 -14540.142  55.5%     - 1116s
     0     0 -14559.233    0  705 -32680.334 -14559.233  55.4%     - 1131s
     0     0 -14567.956    0  638 -32680.334 -14567.956  55.4%     - 1141s
     0     0 -14571.233    0  639 -32680.334 -14571.233  55.4%     - 1144s
     0     0 -14572.073    0  639 -32680.334 -14572.073  55.4%     - 1146s
     0     0 -14634.401    0  689 -32680.334 -14634.401  55.2%     - 1171s
     0     0 -14652.606    0  647 -32680.334 -14652.606  55.2%     - 1190s
     0     0 -14660.171    0  705 -32680.334 -14660.171  55.1%     - 1200s
     0     0 -14665.488    0  654 -32680.334 -14665.488  55.1%     - 1210s
     0     0 -14667.645    0  657 -32680.334 -14667.645  55.1%     - 1215s
     0     0 -14669.941    0  712 -32680.334 -14669.941  55.1%     - 1220s
     0     0 -14671.028    0  714 -32680.334 -14671.028  55.1%     - 1224s
     0     0 -14719.486    0  632 -32680.334 -14719.486  55.0%     - 1248s
H    0     0                    -32674.45770 -14719.512  55.0%     - 1249s
H    0     0                    -32671.27884 -14719.512  54.9%     - 1250s
H    0     0                    -32669.81373 -14719.512  54.9%     - 1250s
     0     0 -14734.436    0  709 -32669.814 -14734.436  54.9%     - 1263s
     0     0 -14738.578    0  700 -32669.814 -14738.578  54.9%     - 1274s
     0     0 -14741.154    0  696 -32669.814 -14741.154  54.9%     - 1280s
     0     0 -14744.360    0  695 -32669.814 -14744.360  54.9%     - 1287s
     0     0 -14744.790    0  696 -32669.814 -14744.790  54.9%     - 1291s
     0     0 -14779.410    0  775 -32669.814 -14779.410  54.8%     - 1325s
H    0     0                    -32656.73276 -14779.416  54.7%     - 1326s
     0     0 -14791.785    0  695 -32656.733 -14791.785  54.7%     - 1345s
     0     0 -14794.210    0  761 -32656.733 -14794.210  54.7%     - 1355s
     0     0 -14798.102    0  769 -32656.733 -14798.102  54.7%     - 1363s
     0     0 -14799.547    0  699 -32656.733 -14799.547  54.7%     - 1370s
     0     0 -14807.484    0  829 -32656.733 -14807.484  54.7%     - 1389s
H    0     0                    -30448.34358 -14807.499  51.4%     - 1390s
H    0     0                    -30401.93066 -14807.499  51.3%     - 1390s
H    0     0                    -29918.27644 -14807.499  50.5%     - 1390s
H    0     0                    -29895.42144 -14807.499  50.5%     - 1390s
H    0     0                    -29832.43093 -14807.499  50.4%     - 1390s
H    0     0                    -29809.57594 -14807.499  50.3%     - 1390s
H    0     0                    -29769.19535 -14807.499  50.3%     - 1390s
H    0     0                    -29757.09032 -14807.499  50.2%     - 1390s
H    0     0                    -29731.37573 -14807.499  50.2%     - 1391s
H    0     0                    -29731.11155 -14807.499  50.2%     - 1391s
     0     0 -14810.191    0  774 -29731.112 -14810.191  50.2%     - 1398s
     0     0 -14810.916    0  824 -29731.112 -14810.916  50.2%     - 1404s
     0     0 -14819.158    0  764 -29731.112 -14819.158  50.2%     - 1424s
H    0     0                    -29692.21483 -14819.237  50.1%     - 1425s
     0     0 -14820.862    0  774 -29692.215 -14820.862  50.1%     - 1434s
     0     0 -14822.490    0  778 -29692.215 -14822.490  50.1%     - 1441s
     0     0 -14834.129    0  820 -29692.215 -14834.129  50.0%     - 1462s
     0     0 -14834.156    0  820 -29692.215 -14834.156  50.0%     - 1472s
H    0     0                    -27880.20441 -14834.196  46.8%     - 1686s
H    0     0                    -27749.65455 -14834.196  46.5%     - 1686s
H    0     0                    -27747.91828 -14834.196  46.5%     - 1687s
H    0     0                    -27733.27296 -14834.196  46.5%     - 1689s
H    0     0                    -27711.30812 -14834.196  46.5%     - 1689s
H    0     0                    -27705.97083 -14834.196  46.5%     - 1689s
H    0     0                    -27667.90230 -14834.196  46.4%     - 1689s
H    0     0                    -27610.68687 -14834.196  46.3%     - 1695s
H    0     0                    -27586.37765 -14834.196  46.2%     - 1698s
H    0     0                    -27573.65489 -14834.196  46.2%     - 1698s
H    0     0                    -27572.66600 -14834.196  46.2%     - 1698s
H    0     0                    -27553.26018 -14834.196  46.2%     - 1698s
H    0     0                    -27552.74443 -14834.196  46.2%     - 1700s
H    0     0                    -27549.19603 -14834.196  46.2%     - 1700s
H    0     2                    -27483.03091 -14834.196  46.0%     - 1707s
     0     2 -14834.196    0  820 -27483.031 -14834.196  46.0%     - 1707s
     1     3 -15276.566    1  508 -27483.031 -14834.196  46.0% 28336 1774s
     2     4 -14856.676    1  745 -27483.031 -14856.676  45.9% 16056 1810s
     3     8 -14993.640    2  623 -27483.031 -14856.806  45.9% 17337 1843s
     7    16 -15047.679    3  630 -27483.031 -14891.257  45.8% 12905 1905s
    15    32 -15055.241    4  634 -27483.031 -14918.587  45.7% 15782 1999s
    31    48 -15152.204    5  628 -27483.031 -14932.681  45.7% 24490 2126s
H   47    79                    -27446.83332 -14932.681  45.6% 29393 2200s
H   48    79                    -27395.53145 -14932.681  45.5% 29196 2200s
H   49    79                    -27390.65479 -14932.681  45.5% 29149 2200s
H   58    79                    -27389.07688 -14932.681  45.5% 28046 2200s
H   60    79                    -27384.96927 -14932.681  45.5% 27325 2200s
H   64    79                    -27369.83009 -14932.681  45.4% 26221 2200s
    78   159 -15300.531    7  613 -27369.830 -14932.681  45.4% 22978 2326s
   160   191 -15436.240    9  590 -27369.830 -14932.681  45.4% 14767 2367s
H  188   191                    -27317.79138 -14932.681  45.3% 14620 2367s
H  190   191                    -27257.40813 -14932.681  45.2% 14533 2367s
   192   226 -20851.668   11  345 -27257.408 -14932.681  45.2% 14474 2418s
   241   247 -21466.998   13  328 -27257.408 -14932.681  45.2% 13320 2464s
H  250   247                    -27256.89238 -14932.681  45.2% 13572 2464s
H  261   247                    -27216.19241 -14932.681  45.1% 14118 2464s
H  263   247                    -27215.67666 -14932.681  45.1% 14163 2464s
   264   297 -22018.800   14  316 -27215.677 -14932.681  45.1% 14218 2514s
H  265   297                    -27211.67064 -14932.681  45.1% 14164 2514s
H  269   297                    -27204.91829 -14932.681  45.1% 14057 2514s
   320   319 -15684.262    8  493 -27204.918 -14932.681  45.1% 12921 2556s
H  328   319                    -27200.36680 -14932.681  45.1% 12844 2556s
   356   352 -17004.982    9  469 -27200.367 -14932.681  45.1% 12411 2595s
H  365   352                    -27199.85106 -14932.681  45.1% 12340 2595s
H  367   352                    -27196.36078 -14932.681  45.1% 12290 2595s
H  382   352                    -27195.84504 -14932.681  45.1% 12031 2595s
   393   384 -17148.771   10  471 -27195.845 -14932.681  45.1% 11887 2634s
   425   415 -24948.524   16  319 -27195.845 -14932.681  45.1% 11440 2669s
   460   501 -19789.422   11  460 -27195.845 -14932.681  45.1% 10900 2713s
   550   600 -19821.829   12  445 -27195.845 -14932.681  45.1%  9572 2752s
   657   677 -20061.789   13  437 -27195.845 -14932.681  45.1%  8496 2788s
   750   761 -20139.054   14  351 -27195.845 -14932.681  45.1%  7695 2813s
   856   829 -20436.817   16  344 -27195.845 -14932.681  45.1%  6990 2850s
   972   890 -25042.469   17  199 -27195.845 -14932.681  45.1%  6425 2885s
  1087   961 -25906.832   19  156 -27195.845 -14932.681  45.1%  5924 2911s
  1208  1042 infeasible   22      -27195.845 -14932.681  45.1%  5540 2937s
  1345  1052     cutoff   21      -27195.845 -14932.681  45.1%  5182 2963s
  1379  1092 -23210.011   40  279 -27195.845 -14932.681  45.1%  5119 2989s
  1443  1194 -23482.709   49  179 -27195.845 -14932.681  45.1%  4969 3017s
  1600  1332 -24140.346   59  208 -27195.845 -14932.681  45.1%  4590 3044s
  1802  1482 -24615.214   68  143 -27195.845 -14932.681  45.1%  4173 3070s
  2024  1571 -26155.026   78  142 -27195.845 -14932.681  45.1%  3807 3098s
  2249  1665 -26255.642   94  142 -27195.845 -14932.681  45.1%  3534 3128s
  2440  1646 -20732.906   16  239 -27195.845 -14932.681  45.1%  3344 3162s
  2529  1663 -25142.657   17  115 -27195.845 -14932.681  45.1%  3293 3200s
  2561  1665 infeasible   20      -27195.845 -14932.681  45.1%  3338 3237s
  2605  1679 infeasible   21      -27195.845 -14932.681  45.1%  3354 3272s
  2671  1719 -22506.023    8  248 -27195.845 -14932.681  45.1%  3359 3313s
  2797  1716     cutoff   10      -27195.845 -14932.681  45.1%  3320 3366s
  2856  1723 -26031.810   10  191 -27195.845 -14932.681  45.1%  3338 3467s
  2944  1720 infeasible   12      -27195.845 -14932.681  45.1%  3325 3524s
  2979  1714 infeasible   12      -27195.845 -14932.681  45.1%  3349 3580s
  3027  1708 infeasible  102      -27195.845 -14932.681  45.1%  3372 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 197
  MIR: 4610
  Flow cover: 3936
  Inf proof: 1
  Zero half: 10
  RLT: 115
  Relax-and-lift: 745

Explored 3049 nodes (11119276 simplex iterations) in 3600.07 seconds (8085.98 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -27195.8 -27196.4 -27199.9 ... -27257.4

Time limit reached
Best objective -2.719584503629e+04, best bound -1.493268119937e+04, gap 45.0920%
  WARNING: Time limit reached. Using best solution found (gap: 45.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -27195.85, θ = 93935.15
  Upper Bound (UB) = -27195.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93935.15
  [DEBUG]   ✓ Scenario 0: θ = 93935.15 ≤ Q = 93935.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93935.15 ≤ Q = 93935.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93935.15 ≤ Q = 93935.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93935.15 ≤ Q = 93935.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93935.15 ≤ Q = 93935.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93935.15 ≤ Q = 93935.15 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93935.15 ≤ Q = 93935.15 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2006a476
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdff95b8a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.082317e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5163340.0892
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.120805e+05, 224 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112080.48    0  120 5163340.09 -112080.48   102%     -    0s
H    0     0                    -79065.03795 -112080.48  41.8%     -    0s
H    0     0                    -79738.89309 -112080.48  40.6%     -    0s
     0     0 -83627.595    0   67 -79738.893 -83627.595  4.88%     -    0s
H    0     0                    -81137.66288 -83592.775  3.03%     -    0s
H    0     0                    -81301.75810 -83592.775  2.82%     -    0s
     0     0 -83187.357    0   68 -81301.758 -83187.357  2.32%     -    0s
     0     0 -83137.861    0   68 -81301.758 -83137.861  2.26%     -    0s
     0     0 -82639.835    0   70 -81301.758 -82639.835  1.65%     -    0s
     0     0 -82626.549    0   70 -81301.758 -82626.549  1.63%     -    0s
     0     0 -82514.904    0   71 -81301.758 -82514.904  1.49%     -    0s
H    0     0                    -81489.03663 -82514.904  1.26%     -    0s
     0     0 -82503.152    0   71 -81489.037 -82503.152  1.24%     -    0s
     0     2 -82502.256    0   71 -81489.037 -82502.256  1.24%     -    0s
H   36    23                    -81992.41460 -82255.716  0.32%  10.6    0s

Cutting planes:
  Gomory: 26
  MIR: 184

Explored 88 nodes (1024 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -81992.4 -81489 -81137.7 ... 1.08232e+13
No other solutions better than -81992.4

Optimal solution found (tolerance 1.00e-06)
Best objective -8.199241460162e+04, best bound -8.199241460162e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 91752.65
  Scenario: 11 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81992.41
  [DEBUG]   S×d_nominal = 173745.06
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173745.06 + -81992.41 = 91752.65
  [DEBUG]   Current θ from Master = 93935.15
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2182.50 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -29378.35
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 1431.7221, Absolute Gap = 1431.7221, Relative Gap = 0.052645
  Not converged yet (gap = 1431.72 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 48 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826794 nonzeros
Model fingerprint: 0x06684d00
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 138528 rows and 56268 columns
Presolve time: 2.78s
Presolved: 153365 rows, 64552 columns, 945484 nonzeros
Variable types: 62293 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387251.2280
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.46s

Barrier statistics:
 Dense cols : 577
 AA' NZ     : 9.285e+06
 Factor NZ  : 2.041e+07 (roughly 250 MB of memory)
 Factor Ops : 5.197e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.01794056e+07  2.40027593e+08  3.46e+05 1.98e+01  1.14e+05     5s
   1  -3.58020632e+07  2.46337183e+08  3.01e+05 5.90e+01  9.78e+04     5s
   2  -1.70594017e+07  1.96161049e+08  1.34e+05 1.75e+01  4.51e+04     5s
   3  -6.87935867e+06  1.61726416e+08  5.21e+04 6.32e+00  1.79e+04     5s
   4  -1.94031442e+06  1.44082296e+08  1.03e+04 1.15e+01  3.92e+03     5s
   5  -9.18962277e+05  9.17821396e+07  2.60e+03 3.87e+00  1.15e+03     5s
   6  -6.17363539e+05  6.06561824e+07  5.34e+02 2.25e+00  3.78e+02     5s
   7  -5.44303537e+05  3.54539873e+07  2.42e+02 1.17e+00  1.94e+02     5s
   8  -4.26087515e+05  2.04034403e+07  7.81e+01 6.05e-01  9.27e+01     5s
   9  -3.29127927e+05  1.71869582e+07  4.27e+01 4.81e-01  7.17e+01     6s
  10  -2.58031998e+05  1.07082282e+07  2.45e+01 8.52e-02  4.31e+01     6s
  11  -1.92731641e+05  7.31748083e+06  1.41e+01 7.78e-02  2.86e+01     6s
  12  -1.61971898e+05  2.83219045e+06  9.74e+00 4.86e-02  1.13e+01     6s
  13  -1.41391673e+05  1.96247293e+06  6.72e+00 4.02e-02  7.83e+00     6s
  14  -1.11030315e+05  1.40648214e+06  3.69e+00 1.75e-02  5.56e+00     6s
  15  -9.21529118e+04  9.17860954e+05  2.28e+00 6.24e-03  3.67e+00     6s
  16  -6.03315433e+04  3.22371952e+05  9.43e-01 2.06e-04  1.38e+00     6s
  17  -5.03541196e+04  1.46357372e+05  6.60e-01 1.34e-04  7.09e-01     6s
  18  -3.60444605e+04  1.07486161e+05  4.31e-01 1.14e-04  5.16e-01     6s
  19  -2.69794386e+04  6.76580183e+04  3.00e-01 4.02e-04  3.40e-01     6s
  20  -2.32812237e+04  4.86420618e+04  2.45e-01 2.98e-04  2.59e-01     6s
  21  -2.14292688e+04  3.54542314e+04  2.18e-01 4.52e-04  2.05e-01     6s
  22  -1.74166351e+04  2.57252145e+04  1.57e-01 1.03e-03  1.55e-01     6s
  23  -1.57789707e+04  1.60470051e+04  1.33e-01 2.04e-03  1.14e-01     7s
  24  -1.38559463e+04  1.20591552e+04  1.06e-01 3.24e-03  9.32e-02     7s
  25  -1.22509974e+04  7.88998167e+03  8.63e-02 2.44e-03  7.24e-02     7s
  26  -1.04586042e+04  6.39201300e+03  6.59e-02 2.77e-03  6.06e-02     7s
  27  -9.76714214e+03  3.15936755e+03  5.80e-02 1.86e-03  4.65e-02     7s
  28  -8.95120326e+03  1.59378564e+03  4.91e-02 1.73e-03  3.79e-02     7s
  29  -8.04961473e+03 -3.43106304e+01  3.98e-02 1.54e-03  2.88e-02     7s
  30  -7.59332367e+03 -1.18648989e+03  3.52e-02 1.25e-03  2.31e-02     7s
  31  -6.38916194e+03 -1.73430668e+03  2.35e-02 9.89e-04  1.68e-02     7s
  32  -6.12820324e+03 -2.26541110e+03  2.09e-02 7.57e-04  1.39e-02     7s
  33  -5.87503988e+03 -2.51683817e+03  1.86e-02 6.42e-04  1.21e-02     7s
  34  -5.70566982e+03 -2.56638490e+03  1.70e-02 6.19e-04  1.13e-02     7s
  35  -5.33759056e+03 -2.93792024e+03  1.35e-02 4.34e-04  8.64e-03     8s
  36  -5.12821124e+03 -3.03602573e+03  1.16e-02 3.86e-04  7.53e-03     8s
  37  -5.07540181e+03 -3.16262701e+03  1.11e-02 3.28e-04  6.89e-03     8s
  38  -4.96100187e+03 -3.19893209e+03  1.01e-02 3.13e-04  6.35e-03     8s
  39  -4.64145747e+03 -3.33726143e+03  6.96e-03 2.68e-04  4.70e-03     8s
  40  -4.51396917e+03 -3.45948495e+03  5.74e-03 2.08e-04  3.80e-03     8s
  41  -4.46172102e+03 -3.59404472e+03  5.27e-03 1.41e-04  3.13e-03     8s
  42  -4.30581510e+03 -3.64269299e+03  3.80e-03 1.17e-04  2.39e-03     8s
  43  -4.18761736e+03 -3.71393990e+03  2.71e-03 7.92e-05  1.71e-03     8s
  44  -4.14971909e+03 -3.73947529e+03  2.36e-03 6.64e-05  1.48e-03     8s
  45  -4.09075343e+03 -3.77685324e+03  1.84e-03 8.31e-05  1.13e-03     8s
  46  -4.02504191e+03 -3.78384748e+03  1.28e-03 7.35e-05  8.68e-04     9s
  47  -4.01189540e+03 -3.79748617e+03  1.17e-03 6.25e-05  7.72e-04     9s
  48  -3.97478070e+03 -3.80527495e+03  8.45e-04 5.55e-05  6.10e-04     9s
  49  -3.95134455e+03 -3.83455641e+03  6.43e-04 3.09e-05  4.21e-04     9s
  50  -3.93401088e+03 -3.85014318e+03  4.87e-04 1.80e-05  3.02e-04     9s
  51  -3.92105358e+03 -3.85688240e+03  3.78e-04 1.25e-05  2.31e-04     9s
  52  -3.90953019e+03 -3.85799909e+03  2.88e-04 1.16e-05  1.86e-04     9s
  53  -3.88638038e+03 -3.86290113e+03  8.73e-05 8.41e-06  8.44e-05     9s
  54  -3.88361286e+03 -3.86526081e+03  6.88e-05 6.21e-06  6.60e-05     9s
  55  -3.88169039e+03 -3.86764026e+03  5.47e-05 4.28e-06  5.05e-05    10s
  56  -3.87993185e+03 -3.86866076e+03  4.27e-05 4.38e-06  4.05e-05    10s
  57  -3.87697887e+03 -3.87038306e+03  2.26e-05 2.79e-06  2.37e-05    10s
  58  -3.87646386e+03 -3.87217207e+03  1.93e-05 1.04e-06  1.54e-05    10s
  59  -3.87446742e+03 -3.87286642e+03  6.57e-06 1.82e-06  5.76e-06    10s
  60  -3.87366947e+03 -3.87308401e+03  1.87e-06 9.36e-07  2.10e-06    10s
  61  -3.87356837e+03 -3.87329082e+03  1.30e-06 1.14e-07  1.00e-06    10s
  62  -3.87342994e+03 -3.87331971e+03  1.54e-06 1.96e-06  3.98e-07    10s
  63  -3.87340795e+03 -3.87332192e+03  2.05e-06 1.22e-06  3.10e-07    10s
  64  -3.87339811e+03 -3.87332233e+03  1.81e-06 1.08e-06  2.73e-07    10s
  65  -3.87339185e+03 -3.87332291e+03  4.71e-06 8.74e-07  2.48e-07    10s
  66  -3.87333559e+03 -3.87332558e+03  6.32e-06 2.50e-06  3.65e-08    11s
  67  -3.87332652e+03 -3.87332563e+03  5.67e-07 5.28e-07  3.34e-09    11s
  68  -3.87332615e+03 -3.87332563e+03  3.34e-07 2.70e-07  1.97e-09    11s
  69  -3.87332590e+03 -3.87332563e+03  1.84e-07 1.47e-07  1.07e-09    11s
  70  -3.87332579e+03 -3.87332563e+03  3.10e-07 8.82e-08  6.35e-10    11s
  71  -3.87332575e+03 -3.87332563e+03  5.12e-07 5.01e-08  5.00e-10    11s
  72  -3.87332570e+03 -3.87332563e+03  2.74e-07 5.28e-08  2.68e-10    11s
  73  -3.87332563e+03 -3.87332563e+03  8.49e-09 5.39e-08  3.38e-13    11s

Barrier solved model in 73 iterations and 11.20 seconds (21.51 work units)
Optimal objective -3.87332563e+03


Root crossover log...

  125242 DPushes remaining with DInf 0.0000000e+00                11s
    2390 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    4310 PPushes remaining with PInf 7.8841617e-08                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.5140470e-10     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   67626   -3.8733256e+03   0.000000e+00   0.000000e+00     16s
   67626   -3.8733256e+03   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 3.63s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -3.873326e+03, 67626 iterations, 16.08 seconds (29.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -3873.3256    0  434 -217728.64 -3873.3256  98.2%     -   20s
H    0     0                    -35167.93074 -3873.3256  89.0%     -   20s
H    0     0                    -34960.56687 -3873.3256  88.9%     -   20s
H    0     0                    -30583.37468 -3873.3256  87.3%     -   21s
H    0     0                    -30087.79039 -3873.3256  87.1%     -   21s
     0     0 -8391.1230    0  575 -30087.790 -8391.1230  72.1%     -   99s
H    0     0                    -29564.90691 -8391.1455  71.6%     -  100s
H    0     0                    -29555.84128 -8391.1455  71.6%     -  100s
H    0     0                    -29496.75932 -8391.1455  71.6%     -  100s
     0     0 -8435.3757    0  574 -29496.759 -8435.3757  71.4%     -  108s
     0     0 -8461.5205    0  576 -29496.759 -8461.5205  71.3%     -  119s
     0     0 -8529.7632    0  639 -29496.759 -8529.7632  71.1%     -  136s
     0     0 -8532.8728    0  635 -29496.759 -8532.8728  71.1%     -  139s
     0     0 -8539.2341    0  581 -29496.759 -8539.2341  71.1%     -  144s
     0     0 -8540.1518    0  576 -29496.759 -8540.1518  71.0%     -  145s
     0     0 -8540.2161    0  583 -29496.759 -8540.2161  71.0%     -  145s
     0     0 -10565.854    0  587 -29496.759 -10565.854  64.2%     -  243s
H    0     0                    -29458.79219 -10565.955  64.1%     -  245s
H    0     0                    -29453.50002 -10565.955  64.1%     -  245s
H    0     0                    -29451.94328 -10565.955  64.1%     -  245s
     0     0 -10878.637    0  591 -29451.943 -10878.637  63.1%     -  286s
     0     0 -10976.483    0  592 -29451.943 -10976.483  62.7%     -  315s
     0     0 -10983.013    0  593 -29451.943 -10983.013  62.7%     -  323s
     0     0 -10984.391    0  593 -29451.943 -10984.391  62.7%     -  326s
     0     0 -10985.933    0  592 -29451.943 -10985.933  62.7%     -  329s
     0     0 -11003.747    0  609 -29451.943 -11003.747  62.6%     -  339s
     0     0 -11044.534    0  608 -29451.943 -11044.534  62.5%     -  358s
     0     0 -11046.334    0  604 -29451.943 -11046.334  62.5%     -  362s
     0     0 -11071.819    0  597 -29451.943 -11071.819  62.4%     -  369s
     0     0 -11106.935    0  608 -29451.943 -11106.935  62.3%     -  382s
     0     0 -11110.580    0  611 -29451.943 -11110.580  62.3%     -  389s
     0     0 -11112.177    0  607 -29451.943 -11112.177  62.3%     -  393s
     0     0 -11113.351    0  603 -29451.943 -11113.351  62.3%     -  395s
     0     0 -11177.252    0  606 -29451.943 -11177.252  62.0%     -  413s
     0     0 -11180.314    0  607 -29451.943 -11180.314  62.0%     -  416s
     0     0 -11181.034    0  607 -29451.943 -11181.034  62.0%     -  418s
     0     0 -12894.843    0  581 -29451.943 -12894.843  56.2%     -  540s
     0     0 -13316.970    0  623 -29451.943 -13316.970  54.8%     -  602s
     0     0 -13431.217    0  640 -29451.943 -13431.217  54.4%     -  632s
     0     0 -13478.323    0  638 -29451.943 -13478.323  54.2%     -  651s
     0     0 -13492.171    0  633 -29451.943 -13492.171  54.2%     -  669s
     0     0 -13498.076    0  642 -29451.943 -13498.076  54.2%     -  681s
     0     0 -13502.961    0  647 -29451.943 -13502.961  54.2%     -  687s
     0     0 -13507.609    0  644 -29451.943 -13507.609  54.1%     -  693s
     0     0 -13511.099    0  645 -29451.943 -13511.099  54.1%     -  698s
     0     0 -13513.907    0  650 -29451.943 -13513.907  54.1%     -  704s
     0     0 -13515.230    0  653 -29451.943 -13515.230  54.1%     -  712s
     0     0 -13515.301    0  651 -29451.943 -13515.301  54.1%     -  714s
     0     0 -14446.573    0  727 -29451.943 -14446.573  50.9%     -  844s
H    0     0                    -29432.43601 -14446.614  50.9%     -  845s
     0     0 -14689.298    0  789 -29432.436 -14689.298  50.1%     -  893s
     0     0 -14733.075    0  785 -29432.436 -14733.075  49.9%     -  913s
     0     0 -14779.593    0  742 -29432.436 -14779.593  49.8%     -  931s
     0     0 -14789.688    0  744 -29432.436 -14789.688  49.8%     -  941s
     0     0 -14792.376    0  743 -29432.436 -14792.376  49.7%     -  947s
     0     0 -14797.914    0  788 -29432.436 -14797.914  49.7%     -  953s
     0     0 -14802.942    0  802 -29432.436 -14802.942  49.7%     -  958s
     0     0 -14803.635    0  742 -29432.436 -14803.635  49.7%     -  961s
     0     0 -15036.553    0  823 -29432.436 -15036.553  48.9%     - 1017s
     0     0 -15172.583    0  812 -29432.436 -15172.583  48.4%     - 1063s
     0     0 -15205.156    0  833 -29432.436 -15205.156  48.3%     - 1086s
     0     0 -15276.368    0  818 -29432.436 -15276.368  48.1%     - 1120s
     0     0 -15290.438    0  825 -29432.436 -15290.438  48.0%     - 1133s
     0     0 -15295.758    0  828 -29432.436 -15295.758  48.0%     - 1142s
     0     0 -15298.428    0  833 -29432.436 -15298.428  48.0%     - 1149s
     0     0 -15308.783    0  827 -29432.436 -15308.783  48.0%     - 1159s
     0     0 -15311.767    0  827 -29432.436 -15311.767  48.0%     - 1166s
     0     0 -15322.519    0  773 -29432.436 -15322.519  47.9%     - 1184s
     0     0 -15330.420    0  777 -29432.436 -15330.420  47.9%     - 1193s
     0     0 -15332.449    0  829 -29432.436 -15332.449  47.9%     - 1199s
     0     0 -15334.687    0  786 -29432.436 -15334.687  47.9%     - 1205s
     0     0 -15335.009    0  786 -29432.436 -15335.009  47.9%     - 1207s
     0     0 -15425.543    0  715 -29432.436 -15425.543  47.6%     - 1249s
     0     0 -15451.875    0  765 -29432.436 -15451.875  47.5%     - 1283s
     0     0 -15461.637    0  706 -29432.436 -15461.637  47.5%     - 1297s
     0     0 -15463.670    0  712 -29432.436 -15463.670  47.5%     - 1301s
     0     0 -15465.874    0  709 -29432.436 -15465.874  47.5%     - 1307s
     0     0 -15473.471    0  767 -29432.436 -15473.471  47.4%     - 1320s
     0     0 -15478.331    0  769 -29432.436 -15478.331  47.4%     - 1329s
     0     0 -15479.537    0  778 -29432.436 -15479.537  47.4%     - 1335s
     0     0 -15530.299    0  766 -29432.436 -15530.299  47.2%     - 1387s
     0     0 -15544.499    0  702 -29432.436 -15544.499  47.2%     - 1410s
     0     0 -15548.225    0  774 -29432.436 -15548.225  47.2%     - 1420s
     0     0 -15551.464    0  700 -29432.436 -15551.464  47.2%     - 1428s
     0     0 -15552.824    0  768 -29432.436 -15552.824  47.2%     - 1432s
     0     0 -15575.210    0  779 -29432.436 -15575.210  47.1%     - 1465s
H    0     0                    -29429.89062 -15575.308  47.1%     - 1473s
H    0     0                    -29423.53896 -15575.308  47.1%     - 1473s
     0     0 -15581.721    0  798 -29423.539 -15581.721  47.0%     - 1491s
     0     0 -15583.113    0  807 -29423.539 -15583.113  47.0%     - 1499s
     0     0 -15612.132    0  791 -29423.539 -15612.132  46.9%     - 1528s
     0     0 -15625.794    0  799 -29423.539 -15625.794  46.9%     - 1545s
     0     0 -15627.200    0  798 -29423.539 -15627.200  46.9%     - 1550s
     0     0 -15636.072    0  802 -29423.539 -15636.072  46.9%     - 1575s
H    0     0                    -29420.37499 -15636.117  46.9%     - 1581s
     0     0 -15637.653    0  799 -29420.375 -15637.653  46.8%     - 1590s
     0     0 -15665.435    0  789 -29420.375 -15665.435  46.8%     - 1623s
     0     0 -15681.585    0  794 -29420.375 -15681.585  46.7%     - 1651s
     0     0 -15687.484    0  805 -29420.375 -15687.484  46.7%     - 1675s
     0     0 -15689.859    0  860 -29420.375 -15689.859  46.7%     - 1689s
     0     0 -15693.243    0  861 -29420.375 -15693.243  46.7%     - 1702s
     0     0 -15694.114    0  875 -29420.375 -15694.114  46.7%     - 1708s
     0     0 -15703.707    0  742 -29420.375 -15703.707  46.6%     - 1732s
     0     0 -15708.476    0  869 -29420.375 -15708.476  46.6%     - 1754s
     0     0 -15709.188    0  869 -29420.375 -15709.188  46.6%     - 1759s
     0     0 -15714.881    0  805 -29420.375 -15714.881  46.6%     - 1776s
     0     0 -15718.514    0  804 -29420.375 -15718.514  46.6%     - 1790s
     0     0 -15719.001    0  812 -29420.375 -15719.001  46.6%     - 1794s
     0     0 -15730.044    0  862 -29420.375 -15730.044  46.5%     - 1816s
     0     0 -15730.312    0  862 -29420.375 -15730.312  46.5%     - 1827s
H    0     0                    -28859.34376 -15730.312  45.5%     - 2275s
H    0     0                    -28082.41637 -15730.312  44.0%     - 2275s
H    0     0                    -27814.40179 -15730.312  43.4%     - 2275s
H    0     0                    -27488.09140 -15730.312  42.8%     - 2275s
H    0     0                    -27482.79922 -15730.312  42.8%     - 2278s
H    0     0                    -27480.47135 -15730.312  42.8%     - 2278s
H    0     0                    -27327.60231 -15730.312  42.4%     - 2281s
H    0     2                    -27275.99041 -15730.312  42.3%     - 2292s
     0     2 -15730.312    0  862 -27275.990 -15730.312  42.3%     - 2292s
     1     4 -15772.770    1  792 -27275.990 -15731.728  42.3%  4977 2352s
     3     8 -15843.645    2  768 -27275.990 -15772.953  42.2% 14065 2373s
     7    14 -15896.244    3  854 -27275.990 -15843.652  41.9% 12003 2430s
    13    24 -15943.560    4  858 -27275.990 -15896.255  41.7% 15805 2514s
    23    34 -19243.544    5  506 -27275.990 -15896.255  41.7% 25870 2724s
    33    58 -20016.895    5  249 -27275.990 -15943.562  41.5% 24176 2957s
H   48    58                    -27233.45364 -15943.562  41.5% 20093 2957s
    59    88 -20259.162    6  242 -27233.454 -15943.562  41.5% 31136 3060s
H   91   216                    -27227.07247 -15943.562  41.4% 27450 3150s
H  149   216                    -27224.67036 -15943.562  41.4% 19302 3150s
   219   286 -20587.113   12  211 -27224.670 -15943.562  41.4% 16020 3193s
H  289   364                    -27161.94901 -15943.562  41.3% 13655 3229s
   367   423 -21671.134   21  144 -27161.949 -15943.562  41.3% 12202 3265s
   432   443 -24434.130   24  156 -27161.949 -15943.562  41.3% 11569 3299s
   466   478 -24539.521   26  158 -27161.949 -15943.562  41.3% 11361 3332s
   522   491 infeasible   31      -27161.949 -15943.562  41.3% 11141 3363s
   549   505 infeasible   31      -27161.949 -15943.562  41.3% 11044 3391s
   583   536 -26718.318   32  105 -27161.949 -15943.562  41.3% 11016 3422s
   630   571 -27112.044   33   94 -27161.949 -15943.562  41.3% 10803 3452s
   698   603 infeasible   34      -27161.949 -15943.562  41.3% 10500 3479s
   770   617 infeasible   34      -27161.949 -15943.562  41.3%  9965 3504s
   850   611 infeasible   30      -27161.949 -15943.562  41.3%  9447 3533s
   918   628 -20664.921   20  557 -27161.949 -15943.562  41.3%  9028 3561s
   988   670 -20817.380   21  433 -27161.949 -15943.562  41.3%  8720 3588s
  1059   671 -20942.079   22  484 -27161.949 -15943.562  41.3%  8695 3600s

Cutting planes:
  Learned: 1
  Implied bound: 198
  MIR: 4681
  Flow cover: 4709
  Zero half: 7
  RLT: 138
  Relax-and-lift: 927
  BQP: 1

Explored 1116 nodes (10328633 simplex iterations) in 3600.10 seconds (7559.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -27161.9 -27224.7 -27227.1 ... -27814.4

Time limit reached
Best objective -2.716194901022e+04, best bound -1.594356156862e+04, gap 41.3019%
  WARNING: Time limit reached. Using best solution found (gap: 41.30%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -27161.95, θ = 94078.77
  Upper Bound (UB) = -27161.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94078.77
  [DEBUG]   ✓ Scenario 0: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 94078.77 ≤ Q = 94078.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 94078.77 ≤ Q = 94078.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x572cfed6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa8d3012a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.081943e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5148902.0592
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.115564e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111556.36    0  120 5148902.06 -111556.36   102%     -    0s
H    0     0                    -78613.35983 -111556.36  41.9%     -    0s
H    0     0                    -79244.79658 -111556.36  40.8%     -    0s
     0     0 -84507.885    0   68 -79244.797 -84507.885  6.64%     -    0s
H    0     0                    -81478.06254 -84477.106  3.68%     -    0s
H    0     0                    -81642.15776 -84477.106  3.47%     -    0s
H    0     0                    -81902.27899 -84477.106  3.14%     -    0s
H    0     0                    -82066.37421 -84477.106  2.94%     -    0s
     0     0 -83965.308    0   67 -82066.374 -83965.308  2.31%     -    0s
     0     0 -83926.056    0   68 -82066.374 -83926.056  2.27%     -    0s
     0     0 -83447.540    0   71 -82066.374 -83447.540  1.68%     -    0s
     0     0 -83431.781    0   71 -82066.374 -83431.781  1.66%     -    0s
     0     0 -83094.313    0   71 -82066.374 -83094.313  1.25%     -    0s
H    0     0                    -82247.56700 -83065.586  0.99%     -    0s
     0     0 -83065.586    0   71 -82247.567 -83065.586  0.99%     -    0s
     0     0 -83065.309    0   71 -82247.567 -83065.309  0.99%     -    0s
     0     0 -82872.508    0   72 -82247.567 -82872.508  0.76%     -    0s
H    0     0                    -82295.89435 -82872.508  0.70%     -    0s
     0     0 -82855.157    0   72 -82295.894 -82855.157  0.68%     -    0s
     0     0 -82855.157    0   88 -82295.894 -82855.157  0.68%     -    0s
     0     0 -82855.157    0   68 -82295.894 -82855.157  0.68%     -    0s
     0     0 -82855.157    0   68 -82295.894 -82855.157  0.68%     -    0s
     0     0 -82855.157    0   50 -82295.894 -82855.157  0.68%     -    0s
     0     0 -82855.157    0   50 -82295.894 -82855.157  0.68%     -    0s
     0     0 -82735.577    0   51 -82295.894 -82735.577  0.53%     -    0s
     0     0 -82705.276    0   41 -82295.894 -82705.276  0.50%     -    0s
     0     0 -82704.666    0   57 -82295.894 -82704.666  0.50%     -    0s
     0     0 -82672.488    0   41 -82295.894 -82672.488  0.46%     -    0s
     0     0 -82655.093    0   41 -82295.894 -82655.093  0.44%     -    0s
     0     0 -82655.093    0   41 -82295.894 -82655.093  0.44%     -    0s
     0     2 -82655.093    0   41 -82295.894 -82655.093  0.44%     -    0s
*   64    12              13    -82325.33612 -82361.954  0.04%   5.5    0s

Cutting planes:
  Gomory: 27
  Implied bound: 3
  MIR: 135
  Flow cover: 6
  RLT: 15
  Relax-and-lift: 6

Explored 105 nodes (1443 simplex iterations) in 0.13 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -82325.3 -82295.9 -82247.6 ... 1.08194e+13
No other solutions better than -82325.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.232533612466e+04, best bound -8.232533612466e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 91025.09
  Scenario: 28 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82325.34
  [DEBUG]   S×d_nominal = 173350.43
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173350.43 + -82325.34 = 91025.09
  [DEBUG]   Current θ from Master = 94078.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3053.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30215.63
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 1465.6181, Absolute Gap = 1465.6181, Relative Gap = 0.053959
  Not converged yet (gap = 1465.62 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 31 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870019 nonzeros
Model fingerprint: 0xe4e28eea
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 145820 rows and 59230 columns
Presolve time: 3.41s
Presolved: 161363 rows, 67830 columns, 994805 nonzeros
Variable types: 65571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387251.2280
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 1153
 AA' NZ     : 3.947e+06
 Factor NZ  : 1.123e+07 (roughly 200 MB of memory)
 Factor Ops : 4.136e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.01898060e+07  2.52490110e+08  3.46e+05 1.98e+01  1.13e+05     5s
   1  -3.58573264e+07  2.57506402e+08  3.01e+05 5.32e+01  9.76e+04     5s
   2  -1.39763471e+07  1.65992580e+08  1.16e+05 1.04e+01  3.90e+04     6s
   3  -9.53430833e+06  1.66765714e+08  7.76e+04 1.01e+01  2.63e+04     6s
   4  -1.40009113e+06  1.13832475e+08  6.84e+03 4.88e+00  2.66e+03     6s
   5  -6.80280547e+05  6.75568466e+07  1.12e+03 1.49e+00  5.85e+02     6s
   6  -5.49728973e+05  3.23899040e+07  4.96e+02 5.15e-01  2.51e+02     6s
   7  -4.15861993e+05  2.30223644e+07  2.59e+02 3.37e-01  1.47e+02     6s
   8  -2.67758425e+05  1.57857500e+07  1.11e+02 2.09e-01  8.04e+01     6s
   9  -2.11835567e+05  8.14004631e+06  7.66e+01 8.48e-02  4.21e+01     6s
  10  -1.67535063e+05  4.59097758e+06  4.85e+01 3.72e-02  2.26e+01     6s
  11  -1.46308420e+05  3.31079893e+06  3.46e+01 2.46e-02  1.54e+01     6s
  12  -1.19134760e+05  2.48839907e+06  1.71e+01 1.72e-02  1.03e+01     6s
  13  -1.02426891e+05  1.38146949e+06  1.04e+01 9.04e-03  5.60e+00     6s
  14  -8.58372120e+04  3.49823189e+05  5.59e+00 2.18e-03  1.59e+00     6s
  15  -6.88403562e+04  1.63919842e+05  3.13e+00 1.30e-03  8.31e-01     6s
  16  -5.51496047e+04  7.77129858e+04  2.01e+00 1.55e-03  4.69e-01     6s
  17  -4.84940222e+04  5.24738441e+04  1.73e+00 1.55e-03  3.56e-01     6s
  18  -3.90604561e+04  3.81936860e+04  1.39e+00 1.56e-03  2.72e-01     7s
  19  -3.21556923e+04  2.42822261e+04  1.13e+00 5.86e-03  1.99e-01     7s
  20  -2.46565046e+04  1.92967093e+04  8.56e-01 1.71e-03  1.54e-01     7s
  21  -2.09344041e+04  1.45981921e+04  7.08e-01 3.79e-03  1.25e-01     7s
  22  -1.78384924e+04  8.10754131e+03  5.65e-01 3.70e-03  9.12e-02     7s
  23  -1.62001822e+04  5.48064668e+03  4.92e-01 2.69e-03  7.62e-02     7s
  24  -1.39457592e+04  3.57059644e+03  3.90e-01 2.58e-03  6.15e-02     7s
  25  -1.26003067e+04  1.44345163e+03  3.32e-01 2.07e-03  4.94e-02     7s
  26  -1.15823473e+04  1.73942856e+02  2.87e-01 2.24e-03  4.13e-02     7s
  27  -1.06901529e+04 -8.76439054e+02  2.51e-01 2.66e-03  3.45e-02     7s
  28  -9.71612123e+03 -1.25863501e+03  2.12e-01 2.39e-03  2.97e-02     7s
  29  -8.86514028e+03 -1.66227735e+03  1.81e-01 2.07e-03  2.53e-02     7s
  30  -8.62670201e+03 -2.10858637e+03  1.72e-01 2.64e-03  2.29e-02     7s
  31  -7.90539307e+03 -2.43158086e+03  1.46e-01 1.78e-03  1.93e-02     7s
  32  -7.43425767e+03 -2.69834697e+03  1.29e-01 3.07e-03  1.67e-02     7s
  33  -7.25105298e+03 -2.81341906e+03  1.23e-01 2.42e-03  1.56e-02     8s
  34  -6.56500393e+03 -3.09694756e+03  9.81e-02 4.68e-03  1.22e-02     8s
  35  -6.20256703e+03 -3.17011687e+03  8.60e-02 3.69e-03  1.07e-02     8s
  36  -6.14557375e+03 -3.20374057e+03  8.39e-02 3.79e-03  1.04e-02     8s
  37  -5.85783598e+03 -3.28775880e+03  7.36e-02 3.18e-03  9.07e-03     8s
  38  -5.35108793e+03 -3.36172182e+03  5.57e-02 2.66e-03  7.01e-03     8s
  39  -5.07712214e+03 -3.47002085e+03  4.58e-02 1.84e-03  5.67e-03     8s
  40  -4.81540242e+03 -3.54674494e+03  3.63e-02 1.34e-03  4.48e-03     8s
  41  -4.73730269e+03 -3.60673684e+03  3.34e-02 9.74e-04  3.99e-03     8s
  42  -4.63362489e+03 -3.61907287e+03  2.98e-02 7.43e-04  3.58e-03     8s
  43  -4.39356866e+03 -3.64919967e+03  2.12e-02 8.39e-04  2.62e-03     8s
  44  -4.28903635e+03 -3.66520065e+03  1.78e-02 7.19e-04  2.20e-03     8s
  45  -4.09565762e+03 -3.70038440e+03  1.09e-02 7.07e-04  1.39e-03     8s
  46  -4.07066147e+03 -3.70514190e+03  1.01e-02 6.59e-04  1.29e-03     9s
  47  -4.04353385e+03 -3.70978973e+03  9.14e-03 6.29e-04  1.17e-03     9s
  48  -3.96293043e+03 -3.72392796e+03  6.41e-03 4.65e-04  8.41e-04     9s
  49  -3.94351894e+03 -3.74430797e+03  5.76e-03 2.65e-04  7.02e-04     9s
  50  -3.89543080e+03 -3.75361318e+03  4.16e-03 2.55e-04  5.00e-04     9s
  51  -3.87721145e+03 -3.75775614e+03  3.55e-03 2.08e-04  4.21e-04     9s
  52  -3.85326265e+03 -3.76043764e+03  2.76e-03 1.61e-04  3.27e-04     9s
  53  -3.83066898e+03 -3.76668397e+03  1.96e-03 2.21e-04  2.26e-04     9s
  54  -3.82264055e+03 -3.76826742e+03  1.68e-03 1.51e-04  1.92e-04     9s
  55  -3.80736694e+03 -3.76898704e+03  1.14e-03 1.07e-04  1.35e-04     9s
  56  -3.80016236e+03 -3.76918312e+03  9.07e-04 9.74e-05  1.09e-04     9s
  57  -3.79866086e+03 -3.76929360e+03  8.57e-04 9.41e-05  1.03e-04     9s
  58  -3.79266636e+03 -3.77053277e+03  6.57e-04 5.05e-05  7.80e-05     9s
  59  -3.78006624e+03 -3.77141392e+03  2.34e-04 1.82e-05  3.04e-05     9s
  60  -3.77460026e+03 -3.77207599e+03  6.57e-05 2.86e-05  8.87e-06    10s
  61  -3.77373959e+03 -3.77230362e+03  4.01e-05 6.43e-06  5.06e-06    10s
  62  -3.77262335e+03 -3.77237927e+03  8.29e-06 2.17e-06  8.60e-07    10s
  63  -3.77243225e+03 -3.77238361e+03  1.49e-06 7.33e-07  1.71e-07    10s
  64  -3.77238915e+03 -3.77238632e+03  2.00e-07 1.02e-07  9.88e-09    10s
  65  -3.77238687e+03 -3.77238686e+03  5.56e-09 1.61e-10  2.80e-11    10s

Barrier solved model in 65 iterations and 9.87 seconds (15.87 work units)
Optimal objective -3.77238687e+03


Root crossover log...

  130612 DPushes remaining with DInf 0.0000000e+00                10s
   66682 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    5754 PPushes remaining with PInf 7.0756854e-06                15s
    3854 PPushes remaining with PInf 3.7608734e-06                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.9649704e+00     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69988   -3.7723869e+03   0.000000e+00   5.964970e+00     15s
   69990   -3.7723869e+03   0.000000e+00   0.000000e+00     16s
   69990   -3.7723869e+03   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 1.69s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -3.772387e+03, 69990 iterations, 12.94 seconds (23.96 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -3772.3869    0  453 -217728.64 -3772.3869  98.3%     -   18s
H    0     0                    -214612.8636 -3772.3869  98.2%     -   18s
H    0     0                    -35473.66181 -3772.3869  89.4%     -   18s
H    0     0                    -35280.15429 -3772.3869  89.3%     -   18s
H    0     0                    -30619.84629 -3772.3869  87.7%     -   18s
H    0     0                    -30095.73434 -3772.3869  87.5%     -   19s
     0     0 -8006.2892    0  569 -30095.734 -8006.2892  73.4%     -   85s
H    0     0                    -29700.18319 -8006.4841  73.0%     -   86s
H    0     0                    -29634.55326 -8006.4841  73.0%     -   86s
H    0     0                    -29621.81733 -8006.4841  73.0%     -   86s
H    0     0                    -29604.85642 -8006.4841  73.0%     -   86s
     0     0 -8069.4987    0  574 -29604.856 -8069.4987  72.7%     -  102s
     0     0 -8077.4169    0  569 -29604.856 -8077.4169  72.7%     -  111s
     0     0 -8088.6133    0  575 -29604.856 -8088.6133  72.7%     -  117s
     0     0 -8103.9423    0  567 -29604.856 -8103.9423  72.6%     -  126s
     0     0 -8108.2313    0  571 -29604.856 -8108.2313  72.6%     -  130s
     0     0 -8113.4214    0  577 -29604.856 -8113.4214  72.6%     -  136s
     0     0 -8146.1717    0  579 -29604.856 -8146.1717  72.5%     -  144s
     0     0 -8199.0617    0  579 -29604.856 -8199.0617  72.3%     -  160s
     0     0 -8200.1664    0  589 -29604.856 -8200.1664  72.3%     -  163s
     0     0 -8200.3936    0  592 -29604.856 -8200.3936  72.3%     -  164s
     0     0 -10634.903    0  615 -29604.856 -10634.903  64.1%     -  278s
H    0     0                    -29570.09728 -10635.080  64.0%     -  279s
H    0     0                    -29536.41616 -10635.080  64.0%     -  279s
     0     0 -10813.917    0  604 -29536.416 -10813.917  63.4%     -  320s
     0     0 -10838.907    0  606 -29536.416 -10838.907  63.3%     -  337s
     0     0 -10846.440    0  614 -29536.416 -10846.440  63.3%     -  348s
     0     0 -10879.583    0  616 -29536.416 -10879.583  63.2%     -  360s
     0     0 -10885.369    0  622 -29536.416 -10885.369  63.1%     -  364s
     0     0 -10889.645    0  622 -29536.416 -10889.645  63.1%     -  368s
     0     0 -11051.034    0  635 -29536.416 -11051.034  62.6%     -  408s
     0     0 -11070.401    0  640 -29536.416 -11070.401  62.5%     -  432s
     0     0 -11079.730    0  646 -29536.416 -11079.730  62.5%     -  446s
     0     0 -11082.938    0  637 -29536.416 -11082.938  62.5%     -  449s
     0     0 -11083.755    0  630 -29536.416 -11083.755  62.5%     -  451s
     0     0 -12547.156    0  591 -29536.416 -12547.156  57.5%     -  625s
     0     0 -12867.158    0  604 -29536.416 -12867.158  56.4%     -  703s
     0     0 -12946.720    0  619 -29536.416 -12946.720  56.2%     -  732s
     0     0 -13008.360    0  620 -29536.416 -13008.360  56.0%     -  758s
     0     0 -13020.057    0  622 -29536.416 -13020.057  55.9%     -  767s
     0     0 -13040.275    0  621 -29536.416 -13040.275  55.9%     -  788s
     0     0 -13065.722    0  608 -29536.416 -13065.722  55.8%     -  803s
     0     0 -13068.786    0  612 -29536.416 -13068.786  55.8%     -  810s
     0     0 -13074.731    0  625 -29536.416 -13074.731  55.7%     -  818s
     0     0 -13082.000    0  620 -29536.416 -13082.000  55.7%     -  830s
     0     0 -13083.476    0  626 -29536.416 -13083.476  55.7%     -  837s
     0     0 -13083.726    0  625 -29536.416 -13083.726  55.7%     -  839s
     0     0 -13838.283    0  689 -29536.416 -13838.283  53.1%     -  969s
H    0     0                    -29502.39979 -13838.464  53.1%     -  970s
     0     0 -13968.012    0  633 -29502.400 -13968.012  52.7%     - 1013s
     0     0 -14013.246    0  644 -29502.400 -14013.246  52.5%     - 1040s
     0     0 -14024.329    0  754 -29502.400 -14024.329  52.5%     - 1060s
     0     0 -14035.454    0  709 -29502.400 -14035.454  52.4%     - 1073s
     0     0 -14046.231    0  708 -29502.400 -14046.231  52.4%     - 1082s
     0     0 -14049.314    0  711 -29502.400 -14049.314  52.4%     - 1091s
     0     0 -14052.130    0  711 -29502.400 -14052.130  52.4%     - 1101s
     0     0 -14053.254    0  720 -29502.400 -14053.254  52.4%     - 1108s
     0     0 -14246.924    0  756 -29502.400 -14246.924  51.7%     - 1170s
H    0     0                    -29498.11272 -14247.318  51.7%     - 1171s
H    0     0                    -29495.19565 -14247.318  51.7%     - 1171s
H    0     0                    -29470.06229 -14247.318  51.7%     - 1171s
H    0     0                    -29464.01872 -14247.318  51.6%     - 1171s
H    0     0                    -29447.03786 -14247.318  51.6%     - 1171s
H    0     0                    -29435.64399 -14247.318  51.6%     - 1171s
     0     0 -14297.743    0  649 -29435.644 -14297.743  51.4%     - 1202s
     0     0 -14314.254    0  657 -29435.644 -14314.254  51.4%     - 1225s
     0     0 -14331.644    0  764 -29435.644 -14331.644  51.3%     - 1242s
     0     0 -14343.595    0  660 -29435.644 -14343.595  51.3%     - 1252s
     0     0 -14346.234    0  664 -29435.644 -14346.234  51.3%     - 1262s
     0     0 -14350.013    0  655 -29435.644 -14350.013  51.2%     - 1273s
     0     0 -14352.278    0  660 -29435.644 -14352.278  51.2%     - 1280s
     0     0 -14354.902    0  652 -29435.644 -14354.902  51.2%     - 1286s
     0     0 -14356.722    0  651 -29435.644 -14356.722  51.2%     - 1290s
     0     0 -14359.674    0  652 -29435.644 -14359.674  51.2%     - 1295s
     0     0 -14360.832    0  650 -29435.644 -14360.832  51.2%     - 1300s
     0     0 -14504.588    0  673 -29435.644 -14504.588  50.7%     - 1348s
H    0     0                    -29431.88583 -14504.600  50.7%     - 1357s
     0     0 -14574.187    0  755 -29431.886 -14574.187  50.5%     - 1405s
     0     0 -14590.073    0  708 -29431.886 -14590.073  50.4%     - 1426s
     0     0 -14598.686    0  748 -29431.886 -14598.686  50.4%     - 1447s
     0     0 -14603.928    0  755 -29431.886 -14603.928  50.4%     - 1466s
     0     0 -14608.733    0  759 -29431.886 -14608.733  50.4%     - 1478s
     0     0 -14609.954    0  755 -29431.886 -14609.954  50.4%     - 1486s
     0     0 -14688.398    0  700 -29431.886 -14688.398  50.1%     - 1552s
     0     0 -14713.581    0  641 -29431.886 -14713.581  50.0%     - 1591s
     0     0 -14720.071    0  774 -29431.886 -14720.071  50.0%     - 1617s
     0     0 -14723.461    0  658 -29431.886 -14723.461  50.0%     - 1628s
     0     0 -14724.752    0  657 -29431.886 -14724.752  50.0%     - 1638s
     0     0 -14756.559    0  817 -29431.886 -14756.559  49.9%     - 1680s
H    0     0                    -29423.53896 -14756.583  49.8%     - 1686s
     0     0 -14765.376    0  812 -29423.539 -14765.376  49.8%     - 1710s
     0     0 -14768.985    0  819 -29423.539 -14768.985  49.8%     - 1722s
     0     0 -14771.152    0  829 -29423.539 -14771.152  49.8%     - 1739s
     0     0 -14772.328    0  774 -29423.539 -14772.328  49.8%     - 1745s
     0     0 -14790.656    0  782 -29423.539 -14790.656  49.7%     - 1785s
     0     0 -14794.754    0  834 -29423.539 -14794.754  49.7%     - 1817s
     0     0 -14796.987    0  829 -29423.539 -14796.987  49.7%     - 1831s
     0     0 -14799.461    0  773 -29423.539 -14799.461  49.7%     - 1840s
     0     0 -14799.771    0  771 -29423.539 -14799.771  49.7%     - 1844s
     0     0 -14809.326    0  707 -29423.539 -14809.326  49.7%     - 1875s
H    0     0                    -29420.37499 -14809.343  49.7%     - 1886s
     0     0 -14813.141    0  723 -29420.375 -14813.141  49.7%     - 1901s
     0     0 -14815.846    0  717 -29420.375 -14815.846  49.6%     - 1914s
     0     0 -14817.417    0  787 -29420.375 -14817.417  49.6%     - 1924s
     0     0 -14839.767    0  775 -29420.375 -14839.767  49.6%     - 1972s
     0     0 -14844.360    0  722 -29420.375 -14844.360  49.5%     - 1993s
     0     0 -14847.022    0  669 -29420.375 -14847.022  49.5%     - 2006s
     0     0 -14849.397    0  728 -29420.375 -14849.397  49.5%     - 2021s
     0     0 -14850.302    0  671 -29420.375 -14850.302  49.5%     - 2031s
     0     0 -14859.200    0  725 -29420.375 -14859.200  49.5%     - 2060s
H    0     0                    -29339.84037 -14859.213  49.4%     - 2085s
H    0     0                    -28305.24036 -14859.213  47.5%     - 2085s
     0     0 -14865.197    0  677 -28305.240 -14865.197  47.5%     - 2104s
     0     0 -14866.600    0  792 -28305.240 -14866.600  47.5%     - 2113s
     0     0 -14877.580    0  666 -28305.240 -14877.580  47.4%     - 2150s
H    0     0                    -28278.13046 -14877.588  47.4%     - 2150s
H    0     0                    -28241.26961 -14877.588  47.3%     - 2150s
H    0     0                    -28229.32395 -14877.588  47.3%     - 2150s
     0     0 -14879.118    0  675 -28229.324 -14879.118  47.3%     - 2165s
     0     0 -14886.661    0  792 -28229.324 -14886.661  47.3%     - 2190s
     0     0 -14886.667    0  792 -28229.324 -14886.667  47.3%     - 2204s
H    0     0                    -28122.48053 -14886.667  47.1%     - 2334s
H    0     0                    -28063.34340 -14886.667  47.0%     - 2540s
H    0     0                    -28062.72770 -14886.667  47.0%     - 2581s
H    0     0                    -27944.65805 -14886.667  46.7%     - 2581s
H    0     0                    -27784.22689 -14886.667  46.4%     - 2588s
H    0     0                    -27668.55236 -14886.667  46.2%     - 2595s
H    0     0                    -27157.72497 -14886.667  45.2%     - 2595s
H    0     0                    -26861.76183 -14886.667  44.6%     - 2595s
H    0     0                    -26820.89640 -14886.667  44.5%     - 2598s
H    0     0                    -26738.29504 -14886.667  44.3%     - 2599s
H    0     0                    -26722.49484 -14886.667  44.3%     - 2599s
H    0     0                    -26708.53422 -14886.667  44.3%     - 2599s
H    0     2                    -26686.28062 -14886.667  44.2%     - 2606s
     0     2 -14886.667    0  792 -26686.281 -14886.667  44.2%     - 2606s
     1     3 -15358.938    1  594 -26686.281 -14886.681  44.2% 30558 2688s
     2     4 -14971.297    1  769 -26686.281 -14971.297  43.9% 24504 2725s
     3     6 -15014.860    2  763 -26686.281 -14971.395  43.9% 20488 2770s
     5    10 -15080.740    3  758 -26686.281 -14971.395  43.9% 17964 2831s
     9    19 -16460.105    3  513 -26686.281 -15014.904  43.7% 16599 2891s
    18    37 -16601.278    4  510 -26686.281 -15080.812  43.5% 15968 3014s
    36    50 -16850.286    5  436 -26686.281 -15119.493  43.3% 27419 3266s
    49    77 -22236.277    6  254 -26686.281 -15119.493  43.3% 29501 3379s
    76   127 -22542.657    7  215 -26686.281 -15133.811  43.3% 23606 3503s
H   92   127                    -26677.29138 -15133.811  43.3% 20265 3503s
H  116   127                    -26656.47572 -15133.811  43.2% 17911 3503s
H  126   260                    -26604.73688 -15133.811  43.1% 17131 3600s
H  141   260                    -26584.84673 -15133.811  43.1% 15764 3600s
H  149   260                    -26577.92034 -15133.811  43.1% 15239 3600s

Cutting planes:
  Learned: 4
  Implied bound: 225
  MIR: 5114
  Flow cover: 4081
  Zero half: 5
  RLT: 130
  Relax-and-lift: 955

Explored 259 nodes (3851433 simplex iterations) in 3600.06 seconds (7562.99 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -26577.9 -26584.8 -26604.7 ... -26820.9

Time limit reached
Best objective -2.657792033828e+04, best bound -1.513381143393e+04, gap 43.0587%
  WARNING: Time limit reached. Using best solution found (gap: 43.06%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -26577.92, θ = 93928.61
  Upper Bound (UB) = -26577.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93928.61
  [DEBUG]   ✓ Scenario 0: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 93928.61 ≤ Q = 93928.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x73afd094
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x73afd094
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.070585e+13
Presolve removed 2624 rows and 1916 columns
Presolve time: 0.00s
Presolved: 469 rows, 473 columns, 1287 nonzeros
Found heuristic solution: objective 5136329.9949
Variable types: 318 continuous, 155 integer (155 binary)
Found heuristic solution: objective 5135914.9099

Root relaxation: objective -1.124904e+05, 221 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112490.40    0  118 5135914.91 -112490.40   102%     -    0s
H    0     0                    -63130.09036 -112490.40  78.2%     -    0s
H    0     0                    -67116.50982 -112490.40  67.6%     -    0s
H    0     0                    -68829.55614 -112344.03  63.2%     -    0s
     0     0 -83885.772    0   86 -68829.556 -83885.772  21.9%     -    0s
H    0     0                    -74141.64250 -83882.319  13.1%     -    0s
H    0     0                    -80376.90724 -83882.319  4.36%     -    0s
     0     0 -83659.671    0   84 -80376.907 -83659.671  4.08%     -    0s
H    0     0                    -82529.81402 -83653.061  1.36%     -    0s
     0     0 -83648.934    0   84 -82529.814 -83648.934  1.36%     -    0s
     0     0 -83590.260    0   84 -82529.814 -83590.260  1.28%     -    0s
H    0     0                    -82594.29727 -83590.260  1.21%     -    0s
     0     0 -83559.857    0   84 -82594.297 -83559.857  1.17%     -    0s
     0     2 -83559.857    0   84 -82594.297 -83559.857  1.17%     -    0s
*  111     5              23    -82604.69751 -82675.289  0.09%   4.5    0s
*  117     0              25    -82665.18432 -82665.184  0.00%   4.4    0s

Cutting planes:
  Gomory: 4
  MIR: 130

Explored 128 nodes (963 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -82665.2 -82604.7 -82594.3 ... 5.13591e+06
No other solutions better than -82665.2

Optimal solution found (tolerance 1.00e-06)
Best objective -8.266518432136e+04, best bound -8.266518432136e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 91079.88
  Scenario: 20 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82665.18
  [DEBUG]   S×d_nominal = 173745.06
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173745.06 + -82665.18 = 91079.88
  [DEBUG]   Current θ from Master = 93928.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2848.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -29426.65
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 2049.6468, Absolute Gap = 2049.6468, Relative Gap = 0.077118
  Not converged yet (gap = 2049.65 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 39 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913244 nonzeros
Model fingerprint: 0x9a4d9852
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 153112 rows and 62192 columns
Presolve time: 3.39s
Presolved: 169361 rows, 71108 columns, 1044148 nonzeros
Variable types: 68849 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387251.2280
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.41s

Barrier statistics:
 Dense cols : 1153
 AA' NZ     : 4.270e+06
 Factor NZ  : 1.195e+07 (roughly 200 MB of memory)
 Factor Ops : 4.080e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.02177564e+07  2.63688633e+08  3.46e+05 1.77e+01  1.13e+05     5s
   1  -3.59247373e+07  2.67505716e+08  3.02e+05 5.38e+01  9.73e+04     6s
   2  -1.03769997e+07  1.75037843e+08  8.49e+04 8.25e+00  2.86e+04     6s
   3  -1.70273070e+06  1.37488644e+08  8.16e+03 3.44e+00  3.15e+03     6s
   4  -8.75119040e+05  6.74769209e+07  1.81e+03 7.98e-01  7.76e+02     6s
   5  -6.72761841e+05  3.43643710e+07  5.28e+02 2.46e-01  2.59e+02     6s
   6  -4.76308830e+05  2.46420229e+07  1.45e+02 1.64e-01  1.19e+02     6s
   7  -2.86422866e+05  1.86937673e+07  7.43e+01 1.19e-01  7.86e+01     6s
   8  -2.25514439e+05  1.59648149e+07  5.02e+01 1.00e-01  6.32e+01     6s
   9  -1.62366408e+05  7.42660659e+06  2.85e+01 3.94e-02  2.85e+01     6s
  10  -1.39413760e+05  4.71088879e+06  1.73e+01 2.37e-02  1.74e+01     6s
  11  -1.21428219e+05  3.16481259e+06  1.16e+01 1.53e-02  1.15e+01     6s
  12  -9.87718339e+04  1.95878303e+06  6.29e+00 9.18e-03  6.98e+00     6s
  13  -8.48720452e+04  5.91053066e+05  4.06e+00 2.70e-03  2.27e+00     6s
  14  -5.89543688e+04  1.84844526e+05  1.73e+00 1.13e-03  8.07e-01     6s
  15  -5.25821971e+04  1.01298789e+05  1.43e+00 1.58e-03  5.09e-01     6s
  16  -4.07927151e+04  6.85377127e+04  1.08e+00 2.47e-03  3.61e-01     7s
  17  -3.66274202e+04  5.75255837e+04  9.58e-01 2.47e-03  3.11e-01     7s
  18  -3.04053053e+04  3.97027110e+04  7.86e-01 3.89e-03  2.32e-01     7s
  19  -2.35833172e+04  2.98847181e+04  5.84e-01 7.25e-03  1.76e-01     7s
  20  -2.04145028e+04  2.22175401e+04  4.83e-01 7.50e-03  1.41e-01     7s
  21  -1.85462227e+04  1.55134573e+04  4.18e-01 5.30e-03  1.12e-01     7s
  22  -1.65852655e+04  1.07986234e+04  3.55e-01 6.48e-03  9.04e-02     7s
  23  -1.40089603e+04  8.51133663e+03  2.72e-01 4.66e-03  7.43e-02     7s
  24  -1.28190935e+04  5.73146967e+03  2.33e-01 3.19e-03  6.12e-02     7s
  25  -1.22699249e+04  3.97606977e+03  2.16e-01 2.97e-03  5.36e-02     7s
  26  -1.15298206e+04  3.23945850e+03  1.94e-01 3.30e-03  4.87e-02     7s
  27  -1.01643544e+04  1.55919990e+03  1.53e-01 4.30e-03  3.87e-02     7s
  28  -9.29955916e+03  1.06966170e+03  1.29e-01 3.88e-03  3.42e-02     7s
  29  -8.59005686e+03  1.94035349e+02  1.12e-01 4.14e-03  2.90e-02     8s
  30  -8.16688184e+03 -1.15141201e+03  1.01e-01 3.71e-03  2.32e-02     8s
  31  -7.57937803e+03 -1.30292323e+03  8.76e-02 3.41e-03  2.07e-02     8s
  32  -6.67975701e+03 -1.77967931e+03  6.70e-02 3.01e-03  1.62e-02     8s
  33  -6.20054086e+03 -2.28498306e+03  5.61e-02 2.27e-03  1.29e-02     8s
  34  -5.82067327e+03 -2.35778394e+03  4.76e-02 2.16e-03  1.14e-02     8s
  35  -5.71289157e+03 -2.48857688e+03  4.51e-02 1.95e-03  1.06e-02     8s
  36  -5.24319060e+03 -2.69359333e+03  3.47e-02 1.48e-03  8.41e-03     8s
  37  -4.92541519e+03 -2.87007466e+03  2.76e-02 1.21e-03  6.78e-03     8s
  38  -4.74896939e+03 -3.00036864e+03  2.34e-02 1.02e-03  5.76e-03     8s
  39  -4.68752197e+03 -3.03448046e+03  2.20e-02 9.76e-04  5.45e-03     8s
  40  -4.58171290e+03 -3.10134457e+03  1.94e-02 8.85e-04  4.88e-03     8s
  41  -4.48584371e+03 -3.27111167e+03  1.72e-02 6.19e-04  4.01e-03     8s
  42  -4.24072638e+03 -3.34980849e+03  1.17e-02 5.20e-04  2.94e-03     9s
  43  -4.14253501e+03 -3.46011393e+03  9.51e-03 3.54e-04  2.25e-03     9s
  44  -4.08909634e+03 -3.51076550e+03  8.34e-03 2.38e-04  1.91e-03     9s
  45  -3.95987931e+03 -3.55643201e+03  5.47e-03 1.84e-04  1.33e-03     9s
  46  -3.91731711e+03 -3.58510311e+03  4.52e-03 1.65e-04  1.10e-03     9s
  47  -3.89599357e+03 -3.59972299e+03  4.08e-03 1.44e-04  9.77e-04     9s
  48  -3.84659844e+03 -3.62503164e+03  2.99e-03 1.03e-04  7.30e-04     9s
  49  -3.79185205e+03 -3.64510441e+03  1.84e-03 7.11e-05  4.83e-04     9s
  50  -3.78253557e+03 -3.66359428e+03  1.65e-03 4.32e-05  3.92e-04     9s
  51  -3.75709555e+03 -3.67402263e+03  1.15e-03 2.91e-05  2.74e-04     9s
  52  -3.74580952e+03 -3.67556134e+03  9.29e-04 2.68e-05  2.32e-04     9s
  53  -3.74340321e+03 -3.67701351e+03  8.81e-04 2.48e-05  2.19e-04     9s
  54  -3.73305891e+03 -3.67773120e+03  6.75e-04 2.39e-05  1.82e-04    10s
  55  -3.72893019e+03 -3.68622453e+03  5.93e-04 1.45e-05  1.41e-04    10s
  56  -3.71309970e+03 -3.69176765e+03  2.86e-04 6.85e-05  7.03e-05    10s
  57  -3.70161530e+03 -3.69600211e+03  6.39e-05 2.67e-05  1.85e-05    10s
  58  -3.69819844e+03 -3.69656675e+03  1.07e-05 1.47e-05  5.34e-06    10s
  59  -3.69753535e+03 -3.69697046e+03  2.80e-06 5.97e-06  1.85e-06    10s
  60  -3.69727063e+03 -3.69720280e+03  9.97e-08 1.13e-06  2.21e-07    10s
  61  -3.69725912e+03 -3.69725597e+03  3.00e-08 1.93e-08  1.03e-08    10s
  62  -3.69725752e+03 -3.69725751e+03  6.95e-08 5.98e-11  3.83e-11    10s

Barrier solved model in 62 iterations and 10.21 seconds (17.01 work units)
Optimal objective -3.69725752e+03


Root crossover log...

  137392 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    6590 PPushes remaining with PInf 9.3219766e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1945515e+00     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72813   -3.6972575e+03   0.000000e+00   1.194551e+00     14s
   72825   -3.6972575e+03   0.000000e+00   0.000000e+00     14s
   72825   -3.6972575e+03   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -3.697258e+03, 72825 iterations, 9.56 seconds (18.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -3697.2575    0  448 -217728.64 -3697.2575  98.3%     -   14s
H    0     0                    -214612.8636 -3697.2575  98.3%     -   14s
H    0     0                    -35473.66181 -3697.2575  89.6%     -   15s
H    0     0                    -35280.15429 -3697.2575  89.5%     -   15s
H    0     0                    -30619.84629 -3697.2575  87.9%     -   15s
H    0     0                    -30095.73434 -3697.2575  87.7%     -   15s
     0     0 -8046.4218    0  529 -30095.734 -8046.4218  73.3%     -   94s
H    0     0                    -29861.60805 -8046.5845  73.1%     -   95s
H    0     0                    -29634.55326 -8046.5845  72.8%     -   95s
H    0     0                    -29629.76133 -8046.5845  72.8%     -   95s
H    0     0                    -29626.66354 -8046.5845  72.8%     -   95s
H    0     0                    -29621.81733 -8046.5845  72.8%     -   95s
     0     0 -8209.7372    0  576 -29621.817 -8209.7372  72.3%     -  132s
     0     0 -8229.0969    0  590 -29621.817 -8229.0969  72.2%     -  142s
     0     0 -8273.2676    0  586 -29621.817 -8273.2676  72.1%     -  159s
     0     0 -8343.1486    0  584 -29621.817 -8343.1486  71.8%     -  180s
     0     0 -8344.2261    0  580 -29621.817 -8344.2261  71.8%     -  185s
     0     0 -8344.4979    0  583 -29621.817 -8344.4979  71.8%     -  188s
     0     0 -10642.964    0  617 -29621.817 -10642.964  64.1%     -  301s
H    0     0                    -29576.79729 -10643.001  64.0%     -  302s
H    0     0                    -29574.45166 -10643.001  64.0%     -  302s
H    0     0                    -29574.18748 -10643.001  64.0%     -  303s
H    0     0                    -29566.82318 -10643.001  64.0%     -  303s
H    0     0                    -29566.55900 -10643.001  64.0%     -  303s
     0     0 -10855.002    0  570 -29566.559 -10855.002  63.3%     -  353s
     0     0 -10869.587    0  576 -29566.559 -10869.587  63.2%     -  364s
     0     0 -10890.382    0  579 -29566.559 -10890.382  63.2%     -  375s
     0     0 -10894.552    0  577 -29566.559 -10894.552  63.2%     -  384s
     0     0 -10897.472    0  581 -29566.559 -10897.472  63.1%     -  390s
     0     0 -10903.524    0  587 -29566.559 -10903.524  63.1%     -  396s
     0     0 -10928.765    0  591 -29566.559 -10928.765  63.0%     -  411s
     0     0 -11053.791    0  586 -29566.559 -11053.791  62.6%     -  442s
     0     0 -11068.411    0  588 -29566.559 -11068.411  62.6%     -  451s
     0     0 -11070.487    0  585 -29566.559 -11070.487  62.6%     -  455s
     0     0 -11070.859    0  585 -29566.559 -11070.859  62.6%     -  456s
     0     0 -12811.412    0  506 -29566.559 -12811.412  56.7%     -  553s
H    0     0                    -29541.14928 -12811.485  56.6%     -  554s
H    0     0                    -29516.63353 -12811.485  56.6%     -  554s
H    0     0                    -29500.49470 -12811.485  56.6%     -  554s
     0     0 -13442.193    0  648 -29500.495 -13442.193  54.4%     -  642s
     0     0 -13574.782    0  656 -29500.495 -13574.782  54.0%     -  686s
     0     0 -13631.406    0  674 -29500.495 -13631.406  53.8%     -  709s
     0     0 -13644.221    0  674 -29500.495 -13644.221  53.7%     -  723s
     0     0 -13651.830    0  668 -29500.495 -13651.830  53.7%     -  731s
     0     0 -13653.116    0  667 -29500.495 -13653.116  53.7%     -  734s
     0     0 -13682.120    0  665 -29500.495 -13682.120  53.6%     -  755s
     0     0 -13684.741    0  666 -29500.495 -13684.741  53.6%     -  761s
     0     0 -13684.911    0  667 -29500.495 -13684.911  53.6%     -  763s
     0     0 -14482.460    0  691 -29500.495 -14482.460  50.9%     -  909s
H    0     0                    -29485.29892 -14482.490  50.9%     -  910s
     0     0 -14643.111    0  729 -29485.299 -14643.111  50.3%     -  968s
     0     0 -14716.370    0  736 -29485.299 -14716.370  50.1%     - 1008s
     0     0 -14748.618    0  735 -29485.299 -14748.618  50.0%     - 1034s
     0     0 -14771.695    0  746 -29485.299 -14771.695  49.9%     - 1062s
     0     0 -14779.709    0  743 -29485.299 -14779.709  49.9%     - 1075s
     0     0 -14791.774    0  697 -29485.299 -14791.774  49.8%     - 1093s
     0     0 -14800.052    0  749 -29485.299 -14800.052  49.8%     - 1109s
     0     0 -14810.628    0  750 -29485.299 -14810.628  49.8%     - 1122s
     0     0 -14848.907    0  748 -29485.299 -14848.907  49.6%     - 1150s
     0     0 -14874.825    0  750 -29485.299 -14874.825  49.6%     - 1168s
     0     0 -14880.203    0  765 -29485.299 -14880.203  49.5%     - 1178s
     0     0 -14883.664    0  758 -29485.299 -14883.664  49.5%     - 1182s
     0     0 -14884.706    0  754 -29485.299 -14884.706  49.5%     - 1185s
     0     0 -15206.554    0  686 -29485.299 -15206.554  48.4%     - 1260s
     0     0 -15247.498    0  778 -29485.299 -15247.498  48.3%     - 1291s
     0     0 -15255.504    0  783 -29485.299 -15255.504  48.3%     - 1304s
     0     0 -15259.217    0  781 -29485.299 -15259.217  48.2%     - 1317s
     0     0 -15280.622    0  773 -29485.299 -15280.622  48.2%     - 1337s
     0     0 -15305.024    0  773 -29485.299 -15305.024  48.1%     - 1352s
     0     0 -15311.905    0  793 -29485.299 -15311.905  48.1%     - 1361s
     0     0 -15321.894    0  780 -29485.299 -15321.894  48.0%     - 1372s
     0     0 -15323.422    0  781 -29485.299 -15323.422  48.0%     - 1377s
     0     0 -15412.524    0  694 -29485.299 -15412.524  47.7%     - 1421s
H    0     0                    -29478.14005 -15412.794  47.7%     - 1433s
     0     0 -15429.706    0  703 -29478.140 -15429.706  47.7%     - 1455s
     0     0 -15437.329    0  709 -29478.140 -15437.329  47.6%     - 1473s
     0     0 -15440.578    0  829 -29478.140 -15440.578  47.6%     - 1482s
     0     0 -15441.988    0  832 -29478.140 -15441.988  47.6%     - 1486s
     0     0 -15497.103    0  746 -29478.140 -15497.103  47.4%     - 1515s
     0     0 -15527.320    0  755 -29478.140 -15527.320  47.3%     - 1534s
     0     0 -15539.876    0  647 -29478.140 -15539.876  47.3%     - 1546s
     0     0 -15541.277    0  707 -29478.140 -15541.277  47.3%     - 1552s
     0     0 -15576.440    0  769 -29478.140 -15576.440  47.2%     - 1581s
H    0     0                    -29455.16447 -15576.670  47.1%     - 1584s
H    0     0                    -29449.87229 -15576.670  47.1%     - 1584s
     0     0 -15593.115    0  636 -29449.872 -15593.115  47.1%     - 1606s
     0     0 -15598.418    0  776 -29449.872 -15598.418  47.0%     - 1615s
     0     0 -15601.419    0  775 -29449.872 -15601.419  47.0%     - 1624s
     0     0 -15603.850    0  776 -29449.872 -15603.850  47.0%     - 1631s
     0     0 -15604.504    0  779 -29449.872 -15604.504  47.0%     - 1634s
     0     0 -15631.834    0  776 -29449.872 -15631.834  46.9%     - 1667s
     0     0 -15639.669    0  773 -29449.872 -15639.669  46.9%     - 1679s
     0     0 -15641.314    0  776 -29449.872 -15641.314  46.9%     - 1684s
     0     0 -15652.261    0  772 -29449.872 -15652.261  46.9%     - 1702s
H    0     0                    -29449.60811 -15652.513  46.8%     - 1708s
     0     0 -15665.347    0  861 -29449.608 -15665.347  46.8%     - 1736s
     0     0 -15672.106    0  789 -29449.608 -15672.106  46.8%     - 1747s
     0     0 -15674.982    0  669 -29449.608 -15674.982  46.8%     - 1753s
     0     0 -15676.902    0  675 -29449.608 -15676.902  46.8%     - 1757s
     0     0 -15678.339    0  682 -29449.608 -15678.339  46.8%     - 1762s
     0     0 -15689.013    0  720 -29449.608 -15689.013  46.7%     - 1783s
     0     0 -15692.104    0  709 -29449.608 -15692.104  46.7%     - 1789s
     0     0 -15693.789    0  662 -29449.608 -15693.789  46.7%     - 1794s
     0     0 -15706.224    0  660 -29449.608 -15706.224  46.7%     - 1819s
     0     0 -15709.589    0  668 -29449.608 -15709.589  46.7%     - 1845s
     0     0 -15710.942    0  718 -29449.608 -15710.942  46.7%     - 1850s
     0     0 -15714.619    0  717 -29449.608 -15714.619  46.6%     - 1861s
     0     0 -15714.636    0  717 -29449.608 -15714.636  46.6%     - 1873s
     0     2 -15714.636    0  717 -29449.608 -15714.636  46.6%     - 2174s
     1     3 -16674.739    1  590 -29449.608 -15714.636  46.6% 39601 2259s
     2     4 -15745.931    1  650 -29449.608 -15745.931  46.5% 21962 2274s
     3     5 -17170.426    2  587 -29449.608 -15745.975  46.5% 22603 2324s
     4     8 -15858.530    2  665 -29449.608 -15746.113  46.5% 20637 2366s
     7    15 -15898.042    3  659 -29449.608 -15858.809  46.1% 18923 2409s
    14    28 -16390.336    4  529 -29449.608 -15858.809  46.1% 18392 2511s
    27    42 -19175.332    5  273 -29449.608 -15898.051  46.0% 25690 3468s
    41    68 -18304.562    5  342 -29449.608 -15972.486  45.8% 28545 3600s
H   50    68                    -29447.74591 -15972.486  45.8% 27697 3600s

Cutting planes:
  Learned: 1
  Implied bound: 208
  MIR: 5022
  Flow cover: 3900
  Zero half: 4
  RLT: 147
  Relax-and-lift: 929

Explored 67 nodes (2541526 simplex iterations) in 3600.13 seconds (6935.90 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -29447.7 -29449.6 -29449.9 ... -29566.6

Time limit reached
Best objective -2.944774591132e+04, best bound -1.597248647602e+04, gap 45.7599%
  WARNING: Time limit reached. Using best solution found (gap: 45.76%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = -29447.75, θ = 93110.81
  Upper Bound (UB) = -29447.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93110.81
  [DEBUG]   ✓ Scenario 0: θ = 93110.81 ≤ Q = 93110.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93110.81 ≤ Q = 93110.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93110.81 ≤ Q = 93110.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93110.81 ≤ Q = 93110.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93110.81 ≤ Q = 93110.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93110.81 ≤ Q = 93110.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93110.81 ≤ Q = 93110.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93110.81 ≤ Q = 93110.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 93110.81 ≤ Q = 93110.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7dd9654c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x82269ab4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.096224e+13
Presolve removed 2617 rows and 1910 columns
Presolve time: 0.00s
Presolved: 476 rows, 479 columns, 1306 nonzeros
Found heuristic solution: objective 5147061.1713
Variable types: 323 continuous, 156 integer (156 binary)

Root relaxation: objective -1.136981e+05, 226 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113698.12    0  120 5147061.17 -113698.12   102%     -    0s
H    0     0                    -80773.58119 -113698.12  40.8%     -    0s
H    0     0                    -81267.12872 -113698.12  39.9%     -    0s
     0     0 -95302.524    0   62 -81267.129 -95302.524  17.3%     -    0s
H    0     0                    -93072.96761 -95287.959  2.38%     -    0s
H    0     0                    -93099.77437 -95287.959  2.35%     -    0s
H    0     0                    -93297.47477 -95287.959  2.13%     -    0s
H    0     0                    -93324.28153 -95287.959  2.10%     -    0s
     0     0 -94570.429    0   61 -93324.282 -94570.429  1.34%     -    0s
     0     0 -94544.386    0   63 -93324.282 -94544.386  1.31%     -    0s
     0     0 -94469.742    0   63 -93324.282 -94469.742  1.23%     -    0s
H    0     0                    -93662.34875 -94469.742  0.86%     -    0s
H    0     0                    -93688.51322 -94469.742  0.83%     -    0s
     0     0 -93919.210    0   46 -93688.513 -93919.210  0.25%     -    0s
     0     0 -93814.000    0   15 -93688.513 -93814.000  0.13%     -    0s
     0     0 -93792.550    0    8 -93688.513 -93792.550  0.11%     -    0s
     0     0 -93766.956    0    8 -93688.513 -93766.956  0.08%     -    0s
     0     0 -93734.064    0    9 -93688.513 -93734.064  0.05%     -    0s
     0     0 -93730.595    0    7 -93688.513 -93730.595  0.04%     -    0s
     0     0     cutoff    0      -93688.513 -93688.513  0.00%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 5
  Flow cover: 4

Explored 1 nodes (604 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -93688.5 -93614.6 -93297.5 ... 1.09622e+13
No other solutions better than -93688.5

Optimal solution found (tolerance 1.00e-06)
Best objective -9.368851322478e+04, best bound -9.368851322478e+04, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 80614.68
  Scenario: 31 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93688.51
  [DEBUG]   S×d_nominal = 174303.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 174303.20 + -93688.51 = 80614.68
  [DEBUG]   Current θ from Master = 93110.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12496.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -41943.87
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = -820.1788, Absolute Gap = 820.1788, Relative Gap = -0.027852
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = -29447.75, LB = -28627.57, Gap = -820.18
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 28 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956469 nonzeros
Model fingerprint: 0x964a202a
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 160404 rows and 65154 columns
Presolve time: 3.90s
Presolved: 177359 rows, 74386 columns, 1093478 nonzeros
Variable types: 72127 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -387251.2280
Found heuristic solution: objective -217728.6435

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 1152
 AA' NZ     : 4.613e+06
 Factor NZ  : 1.293e+07 (roughly 200 MB of memory)
 Factor Ops : 4.467e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -4.02445567e+07  2.75137509e+08  3.47e+05 1.76e+01  1.12e+05     6s
   1  -3.59944321e+07  2.77871031e+08  3.03e+05 5.45e+01  9.71e+04     6s
   2  -8.66991345e+06  1.85849812e+08  7.03e+04 8.99e+00  2.37e+04     6s
   3  -1.70030360e+06  1.29998573e+08  8.19e+03 3.97e+00  3.07e+03     6s
   4  -8.92561300e+05  7.35663175e+07  1.97e+03 9.60e-01  8.30e+02     6s
   5  -6.85899190e+05  3.57429798e+07  5.95e+02 3.01e-01  2.76e+02     7s
   6  -5.25852340e+05  2.71148016e+07  2.52e+02 2.09e-01  1.51e+02     7s
   7  -3.65328254e+05  1.96633067e+07  1.10e+02 1.38e-01  8.78e+01     7s
   8  -3.20133614e+05  1.79211037e+07  8.46e+01 1.25e-01  7.55e+01     7s
   9  -2.17911984e+05  1.35428567e+07  3.87e+01 8.93e-02  5.01e+01     7s
  10  -1.66299792e+05  9.97350743e+06  2.35e+01 6.32e-02  3.51e+01     7s
  11  -1.48903091e+05  7.88004312e+06  1.71e+01 4.89e-02  2.71e+01     7s
  12  -1.29557140e+05  5.11905752e+06  1.22e+01 3.09e-02  1.74e+01     7s
  13  -1.12353606e+05  3.00329121e+06  7.31e+00 1.79e-02  1.01e+01     7s
  14  -9.49055468e+04  8.63072715e+05  4.27e+00 4.65e-03  3.07e+00     7s
  15  -6.91219681e+04  2.56823487e+05  2.10e+00 1.34e-03  1.03e+00     7s
  16  -5.66654517e+04  1.27934805e+05  1.42e+00 1.20e-03  5.83e-01     7s
  17  -4.92560340e+04  9.68908913e+04  1.19e+00 1.26e-03  4.61e-01     7s
  18  -4.06665921e+04  7.70063549e+04  9.53e-01 2.69e-03  3.70e-01     7s
  19  -3.46856070e+04  4.54963105e+04  7.95e-01 2.92e-03  2.53e-01     7s
  20  -2.82072845e+04  3.56916020e+04  6.37e-01 2.33e-03  2.01e-01     7s
  21  -2.34268526e+04  2.70907270e+04  5.12e-01 2.65e-03  1.59e-01     8s
  22  -2.12098703e+04  2.29252115e+04  4.50e-01 2.63e-03  1.39e-01     8s
  23  -1.84210870e+04  1.46018737e+04  3.68e-01 4.73e-03  1.04e-01     8s
  24  -1.66239816e+04  9.91300831e+03  3.16e-01 4.48e-03  8.36e-02     8s
  25  -1.41568093e+04  6.24719664e+03  2.46e-01 4.29e-03  6.42e-02     8s
  26  -1.26093543e+04  4.02257327e+03  2.03e-01 3.21e-03  5.24e-02     8s
  27  -1.16924141e+04  2.27883053e+03  1.79e-01 3.27e-03  4.40e-02     8s
  28  -9.89210161e+03  1.33814165e+03  1.32e-01 2.69e-03  3.53e-02     8s
  29  -9.44360822e+03  3.04412565e+02  1.21e-01 3.25e-03  3.07e-02     8s
  30  -8.73016594e+03 -4.90548898e+02  1.05e-01 3.31e-03  2.59e-02     8s
  31  -8.31624760e+03 -1.10168315e+03  9.55e-02 3.21e-03  2.27e-02     8s
  32  -7.98400747e+03 -1.46337524e+03  8.86e-02 2.78e-03  2.05e-02     8s
  33  -7.02450188e+03 -1.66091670e+03  6.83e-02 2.60e-03  1.69e-02     8s
  34  -6.47281619e+03 -2.12566759e+03  5.68e-02 2.54e-03  1.37e-02     8s
  35  -6.26623283e+03 -2.39752587e+03  5.24e-02 2.12e-03  1.22e-02     8s
  36  -5.95229268e+03 -2.66282584e+03  4.60e-02 1.69e-03  1.04e-02     9s
  37  -5.76380028e+03 -2.70139661e+03  4.21e-02 1.63e-03  9.65e-03     9s
  38  -5.52874700e+03 -2.97769337e+03  3.71e-02 1.17e-03  8.04e-03     9s
  39  -5.17123606e+03 -3.04591649e+03  3.00e-02 1.06e-03  6.70e-03     9s
  40  -4.87139566e+03 -3.19350032e+03  2.36e-02 8.22e-04  5.29e-03     9s
  41  -4.75500936e+03 -3.35122707e+03  2.11e-02 5.76e-04  4.43e-03     9s
  42  -4.61360983e+03 -3.39425852e+03  1.83e-02 5.00e-04  3.85e-03     9s
  43  -4.55394949e+03 -3.40367208e+03  1.71e-02 4.89e-04  3.63e-03     9s
  44  -4.37319342e+03 -3.45138899e+03  1.34e-02 3.95e-04  2.91e-03     9s
  45  -4.22603842e+03 -3.52723328e+03  1.02e-02 7.72e-04  2.20e-03     9s
  46  -4.19266486e+03 -3.56526619e+03  9.55e-03 6.17e-04  1.98e-03     9s
  47  -4.09606894e+03 -3.57967326e+03  7.51e-03 5.58e-04  1.63e-03     9s
  48  -4.05931632e+03 -3.62775010e+03  6.75e-03 3.97e-04  1.36e-03     9s
  49  -4.00249911e+03 -3.63128441e+03  5.60e-03 3.81e-04  1.17e-03    10s
  50  -3.96575936e+03 -3.66307971e+03  4.81e-03 3.10e-04  9.56e-04    10s
  51  -3.94959435e+03 -3.66578821e+03  4.49e-03 2.97e-04  8.96e-04    10s
  52  -3.91403917e+03 -3.68089116e+03  3.74e-03 2.26e-04  7.36e-04    10s
  53  -3.88345655e+03 -3.69368019e+03  3.11e-03 1.73e-04  5.99e-04    10s
  54  -3.84803164e+03 -3.70281925e+03  2.38e-03 1.24e-04  4.59e-04    10s
  55  -3.82701612e+03 -3.70480251e+03  1.95e-03 1.15e-04  3.86e-04    10s
  56  -3.82219960e+03 -3.71066223e+03  1.86e-03 9.06e-05  3.52e-04    10s
  57  -3.81819368e+03 -3.71257368e+03  1.77e-03 8.65e-05  3.34e-04    10s
  58  -3.79778192e+03 -3.71618546e+03  1.35e-03 6.46e-05  2.58e-04    10s
  59  -3.78449788e+03 -3.71999939e+03  1.08e-03 4.62e-05  2.04e-04    10s
  60  -3.78050976e+03 -3.72187518e+03  1.00e-03 3.62e-05  1.85e-04    11s
  61  -3.76970612e+03 -3.72252435e+03  7.92e-04 3.09e-05  1.49e-04    11s
  62  -3.76562284e+03 -3.72581262e+03  7.08e-04 1.55e-05  1.26e-04    11s
  63  -3.73741606e+03 -3.72810504e+03  1.46e-04 9.17e-06  2.94e-05    11s
  64  -3.73339362e+03 -3.72847350e+03  7.06e-05 6.79e-06  1.55e-05    11s
  65  -3.73242608e+03 -3.72855189e+03  5.30e-05 5.50e-06  1.22e-05    11s
  66  -3.73037403e+03 -3.72887935e+03  1.61e-05 9.55e-06  4.69e-06    11s
  67  -3.72974131e+03 -3.72931011e+03  5.42e-06 3.26e-06  1.36e-06    11s
  68  -3.72948664e+03 -3.72938692e+03  2.20e-06 4.13e-06  3.15e-07    11s
  69  -3.72947173e+03 -3.72938909e+03  1.83e-06 3.00e-06  2.61e-07    11s
  70  -3.72940371e+03 -3.72939416e+03  2.25e-07 3.01e-07  3.01e-08    12s
  71  -3.72939573e+03 -3.72939502e+03  2.75e-08 6.47e-08  2.24e-09    12s
  72  -3.72939562e+03 -3.72939503e+03  2.80e-06 8.86e-08  1.67e-09    12s
  73  -3.72939557e+03 -3.72939503e+03  3.03e-06 8.33e-08  1.63e-09    12s
  74  -3.72939508e+03 -3.72939505e+03  1.93e-07 1.85e-07  8.55e-11    12s

Barrier solved model in 74 iterations and 11.78 seconds (20.45 work units)
Optimal objective -3.72939508e+03


Root crossover log...

  143013 DPushes remaining with DInf 0.0000000e+00                12s
   26520 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    9059 PPushes remaining with PInf 1.2531949e-05                18s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0652614e+01     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   77566   -3.7293950e+03   0.000000e+00   1.065261e+01     19s
   77601   -3.7293950e+03   0.000000e+00   0.000000e+00     19s
   77601   -3.7293950e+03   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 3.03s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -3.729395e+03, 77601 iterations, 16.88 seconds (31.86 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -3729.3950    0  454 -217728.64 -3729.3950  98.3%     -   22s
H    0     0                    -55914.13573 -3729.3950  93.3%     -   23s
H    0     0                    -55907.21590 -3729.3950  93.3%     -   23s
H    0     0                    -55871.97213 -3729.3950  93.3%     -   23s
H    0     0                    -55864.61814 -3729.3950  93.3%     -   23s
H    0     0                    -30969.51757 -3729.3950  88.0%     -   24s
H    0     0                    -30936.70887 -3729.3950  87.9%     -   24s
H    0     0                    -30839.74649 -3729.3950  87.9%     -   24s
H    0     0                    -30830.20563 -3729.3950  87.9%     -   24s
     0     0 -8289.1674    0  510 -30830.206 -8289.1674  73.1%     -  123s
H    0     0                    -30748.21966 -8289.6488  73.0%     -  124s
H    0     0                    -30485.27544 -8289.6488  72.8%     -  124s
H    0     0                    -30220.34061 -8289.6488  72.6%     -  124s
H    0     0                    -30142.46315 -8289.6488  72.5%     -  124s
H    0     0                    -30140.77355 -8289.6488  72.5%     -  124s
H    0     0                    -30137.58631 -8289.6488  72.5%     -  124s
     0     0 -8401.8544    0  580 -30137.586 -8401.8544  72.1%     -  152s
     0     0 -8460.5101    0  640 -30137.586 -8460.5101  71.9%     -  170s
     0     0 -8469.0295    0  638 -30137.586 -8469.0295  71.9%     -  178s
     0     0 -8473.3374    0  643 -30137.586 -8473.3374  71.9%     -  185s
     0     0 -8473.6766    0  652 -30137.586 -8473.6766  71.9%     -  187s
     0     0 -10604.231    0  596 -30137.586 -10604.231  64.8%     -  326s
H    0     0                    -30028.75526 -10604.438  64.7%     -  327s
H    0     0                    -29984.87761 -10604.438  64.6%     -  327s
H    0     0                    -29974.27957 -10604.438  64.6%     -  327s
H    0     0                    -29949.53520 -10604.438  64.6%     -  327s
H    0     0                    -29946.94280 -10604.438  64.6%     -  327s
H    0     0                    -29945.08060 -10604.438  64.6%     -  327s
     0     0 -10766.727    0  607 -29945.081 -10766.727  64.0%     -  394s
     0     0 -10851.134    0  630 -29945.081 -10851.134  63.8%     -  430s
     0     0 -10870.266    0  635 -29945.081 -10870.266  63.7%     -  442s
     0     0 -10872.237    0  625 -29945.081 -10872.237  63.7%     -  447s
     0     0 -10878.677    0  632 -29945.081 -10878.677  63.7%     -  457s
     0     0 -10881.817    0  638 -29945.081 -10881.817  63.7%     -  462s
     0     0 -10884.829    0  634 -29945.081 -10884.829  63.7%     -  469s
     0     0 -10887.462    0  638 -29945.081 -10887.462  63.6%     -  472s
     0     0 -10890.668    0  635 -29945.081 -10890.668  63.6%     -  476s
     0     0 -10893.930    0  648 -29945.081 -10893.930  63.6%     -  481s
     0     0 -10894.920    0  635 -29945.081 -10894.920  63.6%     -  485s
     0     0 -10913.124    0  647 -29945.081 -10913.124  63.6%     -  494s
     0     0 -10916.111    0  653 -29945.081 -10916.111  63.5%     -  497s
     0     0 -10916.908    0  656 -29945.081 -10916.908  63.5%     -  499s
     0     0 -12477.225    0  493 -29945.081 -12477.225  58.3%     -  640s
H    0     0                    -29925.26273 -12477.230  58.3%     -  641s
     0     0 -13161.941    0  703 -29925.263 -13161.941  56.0%     -  764s
     0     0 -13313.703    0  723 -29925.263 -13313.703  55.5%     -  814s
     0     0 -13384.394    0  723 -29925.263 -13384.394  55.3%     -  857s
     0     0 -13422.975    0  744 -29925.263 -13422.975  55.1%     -  893s
     0     0 -13439.947    0  730 -29925.263 -13439.947  55.1%     -  918s
     0     0 -13446.874    0  743 -29925.263 -13446.874  55.1%     -  929s
     0     0 -13449.586    0  743 -29925.263 -13449.586  55.1%     -  935s
     0     0 -13485.678    0  734 -29925.263 -13485.678  54.9%     -  963s
     0     0 -13491.245    0  740 -29925.263 -13491.245  54.9%     -  977s
     0     0 -13493.075    0  734 -29925.263 -13493.075  54.9%     -  984s
     0     0 -13499.419    0  738 -29925.263 -13499.419  54.9%     -  993s
     0     0 -13506.684    0  691 -29925.263 -13506.684  54.9%     - 1004s
     0     0 -13508.385    0  690 -29925.263 -13508.385  54.9%     - 1010s
     0     0 -13630.217    0  620 -29925.263 -13630.217  54.5%     - 1051s
     0     0 -13643.245    0  673 -29925.263 -13643.245  54.4%     - 1071s
     0     0 -13646.042    0  633 -29925.263 -13646.042  54.4%     - 1079s
     0     0 -13647.846    0  626 -29925.263 -13647.846  54.4%     - 1084s
     0     0 -13648.066    0  630 -29925.263 -13648.066  54.4%     - 1086s
     0     0 -14496.853    0  813 -29925.263 -14496.853  51.6%     - 1254s
H    0     0                    -29889.91187 -14496.945  51.5%     - 1255s
     0     0 -14865.061    0  806 -29889.912 -14865.061  50.3%     - 1327s
     0     0 -15009.073    0  824 -29889.912 -15009.073  49.8%     - 1389s
     0     0 -15037.517    0  829 -29889.912 -15037.517  49.7%     - 1423s
     0     0 -15046.084    0  835 -29889.912 -15046.084  49.7%     - 1442s
     0     0 -15051.277    0  848 -29889.912 -15051.277  49.6%     - 1455s
     0     0 -15054.324    0  844 -29889.912 -15054.324  49.6%     - 1465s
     0     0 -15064.371    0  763 -29889.912 -15064.371  49.6%     - 1487s
     0     0 -15072.734    0  768 -29889.912 -15072.734  49.6%     - 1501s
     0     0 -15074.627    0  772 -29889.912 -15074.627  49.6%     - 1507s
     0     0 -15075.786    0  769 -29889.912 -15075.786  49.6%     - 1513s
     0     0 -15183.859    0  819 -29889.912 -15183.859  49.2%     - 1569s
     0     0 -15239.842    0  846 -29889.912 -15239.842  49.0%     - 1607s
     0     0 -15250.387    0  725 -29889.912 -15250.387  49.0%     - 1629s
     0     0 -15257.851    0  718 -29889.912 -15257.851  49.0%     - 1638s
     0     0 -15260.647    0  732 -29889.912 -15260.647  48.9%     - 1645s
     0     0 -15262.820    0  725 -29889.912 -15262.820  48.9%     - 1649s
     0     0 -15263.937    0  730 -29889.912 -15263.937  48.9%     - 1653s
     0     0 -15363.928    0  647 -29889.912 -15363.928  48.6%     - 1709s
H    0     0                    -29871.48661 -15363.970  48.6%     - 1711s
H    0     0                    -29858.43607 -15363.970  48.5%     - 1711s
H    0     0                    -29857.92033 -15363.970  48.5%     - 1711s
H    0     0                    -29857.24498 -15363.970  48.5%     - 1711s
H    0     0                    -29844.19445 -15363.970  48.5%     - 1711s
H    0     0                    -29842.27727 -15363.970  48.5%     - 1712s
     0     0 -15388.745    0  653 -29842.277 -15388.745  48.4%     - 1738s
     0     0 -15403.416    0  663 -29842.277 -15403.416  48.4%     - 1776s
     0     0 -15407.526    0  863 -29842.277 -15407.526  48.4%     - 1802s
     0     0 -15414.829    0  790 -29842.277 -15414.829  48.3%     - 1821s
     0     0 -15416.252    0  788 -29842.277 -15416.252  48.3%     - 1834s
     0     0 -15499.446    0  802 -29842.277 -15499.446  48.1%     - 1919s
     0     0 -15515.007    0  732 -29842.277 -15515.007  48.0%     - 1951s
     0     0 -15519.342    0  786 -29842.277 -15519.342  48.0%     - 1971s
     0     0 -15521.498    0  914 -29842.277 -15521.498  48.0%     - 1987s
     0     0 -15522.518    0  801 -29842.277 -15522.518  48.0%     - 1993s
     0     0 -15558.750    0  787 -29842.277 -15558.750  47.9%     - 2035s
     0     0 -15564.691    0  867 -29842.277 -15564.691  47.8%     - 2057s
     0     0 -15566.836    0  872 -29842.277 -15566.836  47.8%     - 2067s
     0     0 -15570.349    0  880 -29842.277 -15570.349  47.8%     - 2077s
     0     0 -15571.790    0  873 -29842.277 -15571.790  47.8%     - 2087s
     0     0 -15599.826    0  723 -29842.277 -15599.826  47.7%     - 2129s
     0     0 -15610.037    0  802 -29842.277 -15610.037  47.7%     - 2149s
     0     0 -15614.205    0  803 -29842.277 -15614.205  47.7%     - 2158s
     0     0 -15615.100    0  808 -29842.277 -15615.100  47.7%     - 2163s
     0     0 -15625.395    0  807 -29842.277 -15625.395  47.6%     - 2186s
     0     0 -15632.877    0  802 -29842.277 -15632.877  47.6%     - 2214s
     0     0 -15635.478    0  818 -29842.277 -15635.478  47.6%     - 2223s
     0     0 -15637.138    0  814 -29842.277 -15637.138  47.6%     - 2231s
     0     0 -15646.901    0  805 -29842.277 -15646.901  47.6%     - 2253s
     0     0 -15654.409    0  738 -29842.277 -15654.409  47.5%     - 2273s
     0     0 -15656.058    0  811 -29842.277 -15656.058  47.5%     - 2286s
     0     0 -15668.888    0  806 -29842.277 -15668.888  47.5%     - 2321s
H    0     0                    -29688.08555 -15669.219  47.2%     - 2343s
     0     0 -15676.106    0  830 -29688.086 -15676.106  47.2%     - 2360s
     0     0 -15676.580    0  828 -29688.086 -15676.580  47.2%     - 2366s
     0     0 -15685.580    0  814 -29688.086 -15685.580  47.2%     - 2389s
     0     0 -15688.369    0  817 -29688.086 -15688.369  47.2%     - 2400s
     0     0 -15688.936    0  828 -29688.086 -15688.936  47.2%     - 2408s
     0     0 -15690.461    0  824 -29688.086 -15690.461  47.1%     - 2418s
     0     0 -15690.482    0  824 -29688.086 -15690.482  47.1%     - 2436s
H    0     0                    -29686.30559 -15690.508  47.1%     - 2532s
H    0     0                    -29651.65839 -15690.508  47.1%     - 2532s
H    0     0                    -29640.40731 -15690.514  47.1%     - 2835s
H    0     0                    -29607.89234 -15690.514  47.0%     - 2847s
H    0     0                    -29566.71564 -15690.514  46.9%     - 2937s
H    0     0                    -28885.92052 -15690.514  45.7%     - 2943s
H    0     0                    -28519.52793 -15690.514  45.0%     - 2943s
H    0     0                    -28496.88299 -15690.514  44.9%     - 2945s
H    0     0                    -28468.43425 -15690.514  44.9%     - 3014s
H    0     0                    -28463.40808 -15690.514  44.9%     - 3024s
     0     2 -15690.514    0  824 -28463.408 -15690.514  44.9%     - 3355s
     1     4 -15771.486    1  769 -28463.408 -15690.527  44.9% 13198 3392s
     3     8 -15898.098    2  792 -28463.408 -15771.646  44.6% 17618 3520s
     7    14 -16121.562    3  631 -28463.408 -15898.241  44.1% 25055 3600s

Cutting planes:
  Learned: 3
  Gomory: 1
  Implied bound: 190
  MIR: 4532
  Flow cover: 3431
  Zero half: 5
  RLT: 93
  Relax-and-lift: 645

Explored 13 nodes (1505774 simplex iterations) in 3600.07 seconds (7963.37 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -28463.4 -28468.4 -28496.9 ... -29686.3

Time limit reached
Best objective -2.846340807958e+04, best bound -1.589824112973e+04, gap 44.1450%
  WARNING: Time limit reached. Using best solution found (gap: 44.14%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = -28463.41, θ = 93219.19
  Upper Bound (UB) = -28463.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93219.19
  [DEBUG]   ✓ Scenario 0: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93219.19 ≤ Q = 93219.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93219.19 ≤ Q = 93219.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93219.19 ≤ Q = 93219.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93219.19 ≤ Q = 93219.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93219.19 ≤ Q = 93219.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93219.19 ≤ Q = 93219.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93219.19 ≤ Q = 93219.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 93219.19 ≤ Q = 93219.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 93219.19 ≤ Q = 93219.19 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6039dfb0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9fc62050
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.114972e+13
Presolve removed 2624 rows and 1916 columns
Presolve time: 0.00s
Presolved: 469 rows, 473 columns, 1287 nonzeros
Found heuristic solution: objective 5313126.6377
Variable types: 318 continuous, 155 integer (155 binary)
Found heuristic solution: objective 5312711.5527

Root relaxation: objective -1.137026e+05, 221 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113702.61    0  118 5312711.55 -113702.61   102%     -    0s
H    0     0                    -72216.47082 -113702.61  57.4%     -    0s
H    0     0                    -77289.65154 -113702.61  47.1%     -    0s
H    0     0                    -78017.29660 -113552.35  45.5%     -    0s
     0     0 -87320.310    0   90 -78017.297 -87320.310  11.9%     -    0s
H    0     0                    -84376.63678 -87231.714  3.38%     -    0s
H    0     0                    -84400.77467 -87231.714  3.35%     -    0s
H    0     0                    -85438.73261 -87231.714  2.10%     -    0s
H    0     0                    -85462.87049 -87231.714  2.07%     -    0s
     0     0 -86913.295    0   92 -85462.870 -86913.295  1.70%     -    0s
     0     0 -86751.598    0   92 -85462.870 -86751.598  1.51%     -    0s
H    0     0                    -85732.31551 -86751.598  1.19%     -    0s
H    0     0                    -85809.72964 -86751.598  1.10%     -    0s
     0     0 -86560.526    0   92 -85809.730 -86560.526  0.87%     -    0s
     0     0 -86552.295    0   92 -85809.730 -86552.295  0.87%     -    0s
     0     0 -86442.544    0   95 -85809.730 -86442.544  0.74%     -    0s
     0     0 -86430.030    0   95 -85809.730 -86430.030  0.72%     -    0s
     0     2 -86430.030    0   95 -85809.730 -86430.030  0.72%     -    0s

Cutting planes:
  Gomory: 26
  Implied bound: 1
  MIR: 213
  Flow cover: 1
  RLT: 2
  BQP: 1

Explored 184 nodes (1334 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -85809.7 -85438.7 -78017.3 ... 1.11497e+13
No other solutions better than -85809.7

Optimal solution found (tolerance 1.00e-06)
Best objective -8.580972964074e+04, best bound -8.580972964074e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 88196.13
  Scenario: 40 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -85809.73
  [DEBUG]   S×d_nominal = 174005.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 174005.86 + -85809.73 = 88196.13
  [DEBUG]   Current θ from Master = 93219.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5023.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33486.46
  Lower Bound (LB) = -28627.57
  Gap (UB-LB) = 164.1591, Absolute Gap = 164.1591, Relative Gap = 0.005767
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 22
Total Time: 62712.94s
Converged: True
Final Lower Bound: -28627.5671
Final Upper Bound: -28463.4081
Final Gap: 164.159064
Number of Critical Scenarios: 22
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [5, 8, 9] (3/10)
Active Routes (Plant→DC): 8
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 8 customers  Mode 1: 30 customers  Mode 2: 12 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 22
Start Time: 2026-01-03 10:19:54
End Time: 2026-01-04 03:45:07
Total Time: 62712.94s
Optimal Value: -28627.57
Lower Bound: -28627.57
Upper Bound: -28463.41
Gap: 164.159064
Plants Opened: {0: [1], 1: [1], 2: [2]} (3 plants)
DCs Opened: [5, 8, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed19_LD_gamma20_20260104_034507.csv

Total Execution Time: 62713.20 seconds
End Time: 2026-01-04 03:45:07

All tasks completed successfully!

