
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 15
DI Scenario: HD
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed15.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
  Product 1: ['1.000', '1.335', '1.783'] (k=0.713)
  Product 2: ['1.000', '1.424', '2.029'] (k=0.873)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=903, max=1768
  DC capacity (MC): min=414, max=867

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.05, max=34.96, count=80
  Deviation (μ̂): min=4.07, max=9.96

Costs:
  Plant fixed cost: min=5260, max=9753
  DC fixed cost: min=3497, max=5949
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.335', '1.783'] (k=0.713)
    Product 2: ['1.000', '1.424', '2.029'] (k=0.873)
  MD:
    Product 0: ['1.000', '1.250', '1.561'] (k=0.549)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.287', '1.656'] (k=0.622)
  LD:
    Product 0: ['1.000', '1.113', '1.238'] (k=0.263)
    Product 1: ['1.000', '1.016', '1.032'] (k=0.039)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
  Mixed:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x017d1847
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.12s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -241274.6565
Found heuristic solution: objective -194606.4683

Root relaxation: objective 1.619343e+05, 5250 iterations, 0.38 seconds (0.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 161934.251    0  524 -194606.47 161934.251   183%     -    0s
H    0     0                    -190113.0011 161934.251   185%     -    0s
     0     0 144112.606    0  747 -190113.00 144112.606   176%     -    1s
H    0     0                    -182224.2283 144111.902   179%     -    2s
     0     0 143817.165    0  764 -182224.23 143817.165   179%     -    2s
     0     0 143749.935    0  764 -182224.23 143749.935   179%     -    2s
     0     0 143744.305    0  762 -182224.23 143744.305   179%     -    2s
     0     0 143744.252    0  763 -182224.23 143744.252   179%     -    2s
H    0     0                    -180188.6072 143744.252   180%     -    2s
     0     0 135081.074    0  865 -180188.61 135081.074   175%     -    3s
H    0     0                    -173417.7153 134831.414   178%     -    4s
     0     0 134831.414    0  882 -173417.72 134831.414   178%     -    4s
     0     0 134810.556    0  890 -173417.72 134810.556   178%     -    4s
     0     0 134809.214    0  890 -173417.72 134809.214   178%     -    4s
H    0     0                    -173407.0339 128272.525   174%     -    6s
     0     0 128272.525    0  841 -173407.03 128272.525   174%     -    6s
H    0     0                    -139866.3975 128269.469   192%     -    6s
     0     0 127663.819    0  874 -139866.40 127663.819   191%     -    6s
     0     0 127582.050    0  889 -139866.40 127582.050   191%     -    7s
     0     0 127560.740    0  900 -139866.40 127560.740   191%     -    7s
     0     0 127559.387    0  897 -139866.40 127559.387   191%     -    7s
H    0     0                    25238.296672 127559.387   405%     -    8s
     0     0 114102.597    0  498 25238.2967 114102.597   352%     -   10s
H    0     0                    26010.908304 112379.654   332%     -   10s
H    0     0                    27715.001954 112379.654   305%     -   10s
     0     0 112379.654    0  698 27715.0020 112379.654   305%     -   10s
H    0     0                    33296.969035 112059.858   237%     -   11s
H    0     0                    34459.745042 112059.858   225%     -   11s
H    0     0                    35936.593445 112059.858   212%     -   11s
H    0     0                    40195.587701 112059.858   179%     -   11s
     0     0 112059.858    0  711 40195.5877 112059.858   179%     -   11s
     0     0 111910.809    0  722 40195.5877 111910.809   178%     -   11s
     0     0 111892.428    0  738 40195.5877 111892.428   178%     -   11s
H    0     0                    40209.946475 108192.005   169%     -   12s
     0     0 108192.005    0  633 40209.9465 108192.005   169%     -   12s
     0     0 107685.589    0  720 40209.9465 107685.589   168%     -   13s
     0     0 107472.173    0  738 40209.9465 107472.173   167%     -   13s
     0     0 107395.435    0  745 40209.9465 107395.435   167%     -   13s
H    0     0                    40482.793951 107369.458   165%     -   13s
     0     0 107369.458    0  735 40482.7940 107369.458   165%     -   13s
H    0     0                    40524.848798 105099.239   159%     -   14s
H    0     0                    45103.699941 105099.239   133%     -   14s
H    0     0                    49154.633966 105099.239   114%     -   14s
     0     0 105099.239    0  684 49154.6340 105099.239   114%     -   14s
H    0     0                    49271.122519 104621.460   112%     -   15s
H    0     0                    49402.066251 104621.460   112%     -   15s
H    0     0                    49554.822282 104621.460   111%     -   15s
H    0     0                    49564.573245 104621.460   111%     -   15s
H    0     0                    49711.054991 104621.460   110%     -   15s
H    0     0                    49819.125178 104621.460   110%     -   15s
H    0     0                    49891.063954 104621.460   110%     -   15s
     0     0 104621.460    0  694 49891.0640 104621.460   110%     -   15s
     0     0 104545.935    0  732 49891.0640 104545.935   110%     -   15s
     0     0 104512.166    0  735 49891.0640 104512.166   109%     -   15s
     0     0 104494.862    0  746 49891.0640 104494.862   109%     -   15s
     0     0 103493.826    0  643 49891.0640 103493.826   107%     -   16s
     0     0 103150.320    0  745 49891.0640 103150.320   107%     -   16s
     0     0 102958.013    0  786 49891.0640 102958.013   106%     -   17s
     0     0 102926.575    0  759 49891.0640 102926.575   106%     -   17s
H    0     0                    50736.110283 102135.836   101%     -   18s
H    0     0                    50830.540974 102135.836   101%     -   18s
H    0     0                    51131.445086 102135.836   100%     -   18s
H    0     0                    51738.641036 102135.836  97.4%     -   18s
H    0     0                    52081.700916 102135.836  96.1%     -   18s
     0     0 102135.836    0  651 52081.7009 102135.836  96.1%     -   18s
H    0     0                    52782.893001 101883.227  93.0%     -   18s
H    0     0                    53804.264205 101883.227  89.4%     -   18s
H    0     0                    53932.734402 101883.227  88.9%     -   18s
H    0     0                    54583.737526 101883.227  86.7%     -   18s
     0     0 101883.227    0  782 54583.7375 101883.227  86.7%     -   18s
     0     0 101839.581    0  697 54583.7375 101839.581  86.6%     -   18s
     0     0 101825.745    0  777 54583.7375 101825.745  86.5%     -   18s
     0     0 101303.560    0  624 54583.7375 101303.560  85.6%     -   19s
     0     0 101101.241    0  668 54583.7375 101101.241  85.2%     -   20s
     0     0 101043.740    0  706 54583.7375 101043.740  85.1%     -   20s
     0     0 101029.777    0  679 54583.7375 101029.777  85.1%     -   20s
     0     0 100565.415    0  746 54583.7375 100565.415  84.2%     -   21s
     0     0 100403.075    0  747 54583.7375 100403.075  83.9%     -   21s
     0     0 100369.126    0  782 54583.7375 100369.126  83.9%     -   22s
     0     0 100032.313    0  785 54583.7375 100032.313  83.3%     -   23s
     0     0 99933.1232    0  783 54583.7375 99933.1232  83.1%     -   23s
H    0     0                    56826.640795 99903.8220  75.8%     -   23s
     0     0 99903.8220    0  811 56826.6408 99903.8220  75.8%     -   23s
     0     0 99680.8102    0  705 56826.6408 99680.8102  75.4%     -   24s
     0     0 99578.6400    0  730 56826.6408 99578.6400  75.2%     -   25s
     0     0 99551.5152    0  780 56826.6408 99551.5152  75.2%     -   25s
     0     0 99343.6945    0  703 56826.6408 99343.6945  74.8%     -   25s
     0     0 99343.6544    0  703 56826.6408 99343.6544  74.8%     -   26s
     0     2 99343.6173    0  703 56826.6408 99343.6173  74.8%     -   27s
     7    16 98742.2157    3  662 56826.6408 99000.7467  74.2%  1660   31s
    31    64 98343.7000    5  660 56826.6408 98561.1101  73.4%  2308   36s
H   40    64                    57071.288458 98561.1101  72.7%  1969   36s
H   95   234                    57226.517855 98342.9156  71.8%  1578   39s
H   98   234                    58092.979838 98342.9156  69.3%  1549   39s
H  103   234                    62659.447871 98342.9156  56.9%  1497   39s
H  189   234                    63298.930011 98342.9156  55.4%  1078   39s
   340   373 97568.6755   11  424 63298.9300 98342.9156  55.4%   816   40s
H  380   410                    64629.594356 98342.9156  52.2%   772   40s
   533   570 95516.5775   14  384 64629.5944 98342.9156  52.2%   695   45s
H  541   570                    64680.231757 98342.9156  52.0%   694   45s
H  663   744                    64830.633983 98342.9156  51.7%   654   46s
H  686   744                    65444.565391 98342.9156  50.3%   659   46s
H  868   914                    66805.075742 98342.9156  47.2%   613   47s
H 1034  1110                    66845.634208 98342.9156  47.1%   568   49s
H 1038  1110                    66931.309922 98342.9156  46.9%   569   49s
  1132  1226 92697.5219   22  541 66931.3099 98228.1971  46.8%   544   51s
H 1280  1294                    67434.937377 98154.1056  45.6%   514   52s
H 1303  1294                    67454.666472 98154.1056  45.5%   512   52s
H 1323  1294                    67464.388777 98154.1056  45.5%   515   52s
H 1342  1294                    67611.083474 98154.1056  45.2%   511   52s
  1464  1420 88856.2966   25  474 67611.0835 98111.4090  45.1%   516   55s
H 1474  1420                    67651.641941 98111.4090  45.0%   516   55s
  2006  2018 86844.2297   36  449 67651.6419 97754.1530  44.5%   518   60s
H 2689  2483                    67921.478344 97700.7016  43.8%   470   64s
  2691  2778 79720.1367   43  356 67921.4783 97700.7016  43.8%   470   65s
H 3841  3515                    68224.805910 97499.2553  42.9%   384   71s
H 3909  3781                    70245.447127 97440.1731  38.7%   384   72s
H 4044  3738                    70634.553063 97440.1731  37.9%   375   72s
H 4203  3734                    70661.243383 97440.1731  37.9%   366   72s
H 4422  3803                    71785.632513 97440.1731  35.7%   359   73s
H 4634  3682                    72579.823977 97440.1731  34.3%   352   75s
H 4634  3606                    73044.268152 97440.1731  33.4%   352   76s
  4635  3601 78819.1122   40  703 73044.2682 97440.1731  33.4%   352   83s
  4639  3604 89025.4951   18  301 73044.2682 97440.1731  33.4%   352   85s
H 4669  3442                    73260.886905 96221.9062  31.3%   349   89s
H 4674  3272                    73272.087884 96196.5889  31.3%   349   90s
  4699  3306 88988.6291   15  304 73272.0879 90196.2476  23.1%   353   95s
H 4782  3237                    75113.489383 89149.9856  18.7%   356   96s
H 4806  3073                    75269.482560 89149.9856  18.4%   356   96s
H 4910  2976                    75269.498083 89149.9856  18.4%   355   96s
H 4910  2835                    75728.266697 89149.9856  17.7%   355   96s
H 5013  2731                    75796.412046 88304.8884  16.5%   353   97s
H 5016  2603                    75973.578524 88304.8884  16.2%   353   97s
H 5024  2479                    76115.173366 88304.8884  16.0%   353   97s
H 5026  2364                    76122.199327 88304.8884  16.0%   353   97s
H 5037  2250                    76146.350785 88304.8884  16.0%   353   97s
H 5045  2144                    76406.540561 88304.8884  15.6%   353   97s
  5421  2200 79491.4602   21  168 76406.5406 87451.1376  14.5%   346  100s
H 5526  2107                    76418.436523 87272.8437  14.2%   344  101s
H 5614  1999                    76437.047964 86921.8618  13.7%   341  101s
H 5620  1947                    76445.711400 86836.6745  13.6%   341  101s
H 5623  1862                    76656.318209 86753.5943  13.2%   341  101s
H 5642  1774                    76940.656457 86753.5943  12.8%   341  101s
H 5648  1696                    77120.104587 86753.5943  12.5%   341  101s
H 5905  1596                    77175.507455 86276.3255  11.8%   334  103s
H 5931  1518                    77387.761159 86240.1401  11.4%   333  103s
  6435  1446     cutoff   26      77387.7612 86012.5926  11.1%   322  105s
H 7183  1252                    77672.403066 85465.5105  10.0%   308  107s
H 7533  1155                    78185.672442 85465.5105  9.31%   302  108s
H 7649  1057                    78256.153351 85145.8772  8.80%   300  108s
H 7651  1001                    78318.155768 85145.8772  8.72%   300  108s
  8243   884 81129.0972   21  275 78318.1558 83975.7445  7.22%   294  110s
H 8526   847                    78320.496758 83570.6239  6.70%   291  110s
H10858   731                    78339.522808 81256.3682  3.72%   261  114s
*11812  1377              81    78424.764618 80934.4155  3.20%   243  114s
*13555  2317              80    78902.152281 79777.0513  1.11%   216  114s
 14215  2068     cutoff   60      78902.1523 79366.7306  0.59%   207  115s

Cutting planes:
  Gomory: 1
  Implied bound: 10
  Projected implied bound: 9
  MIR: 273
  Mixing: 3
  Flow cover: 466
  RLT: 12
  Relax-and-lift: 44

Explored 25197 nodes (3266271 simplex iterations) in 117.16 seconds (157.66 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 78902.2 78424.8 78339.5 ... 77175.5

Optimal solution found (tolerance 1.00e-06)
Best objective 7.890215228146e+04, best bound 7.890215228146e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 117.17s
  Master Objective (UB) = 78902.15, θ = 229221.40
  Upper Bound (UB) = 78902.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229221.40
  [DEBUG]   ✓ Scenario 0: θ = 229221.40 ≤ Q = 229221.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7af73e6d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8508c193
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.497496e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 7380855.9166
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.609873e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160987.33    0  123 7380855.92 -160987.33   102%     -    0s
H    0     0                    -126131.5338 -160987.33  27.6%     -    0s
H    0     0                    -126394.7864 -160987.33  27.4%     -    0s
*    0     0               0    -130279.8369 -130279.84  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 203

Explored 1 nodes (377 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -130280 -126395 -126132 ... 1.4975e+13
No other solutions better than -130280

Optimal solution found (tolerance 1.00e-06)
Best objective -1.302798368826e+05, best bound -1.302798368826e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 195862.54
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130279.84
  [DEBUG]   S×d_nominal = 326142.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 326142.37 + -130279.84 = 195862.54
  [DEBUG]   Current θ from Master = 229221.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33358.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 45543.29
  Lower Bound (LB) = 45543.29
  Gap (UB-LB) = 33358.8582, Absolute Gap = 33358.8582, Relative Gap = 0.422788
  Not converged yet (gap = 33358.86 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0xc60bd13e
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 45543.3 (0.02s)
Loaded MIP start from previous solve with objective 45543.3

Presolve removed 14231 rows and 5770 columns
Presolve time: 0.50s
Presolved: 17732 rows, 8970 columns, 98128 nonzeros
Variable types: 6711 continuous, 2259 integer (2259 binary)

Root relaxation: objective 9.616435e+04, 11944 iterations, 2.13 seconds (2.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 96164.3468    0  245 45543.2941 96164.3468   111%     -    2s
H    0     0                    58669.598491 96164.3468  63.9%     -    2s
H    0     0                    59412.998178 96164.3468  61.9%     -    2s
H    0     0                    60799.979032 96164.3468  58.2%     -    2s
H    0     0                    60866.669545 96164.3468  58.0%     -    3s
     0     0 87329.1841    0  401 60866.6695 87329.1841  43.5%     -    4s
H    0     0                    60958.288824 87327.9777  43.3%     -    4s
H    0     0                    61041.622390 87241.8438  42.9%     -    4s
H    0     0                    61128.774959 87241.8438  42.7%     -    4s
     0     0 87241.8438    0  328 61128.7750 87241.8438  42.7%     -    4s
     0     0 87221.6076    0  335 61128.7750 87221.6076  42.7%     -    5s
     0     0 81883.7978    0  272 61128.7750 81883.7978  34.0%     -    6s
H    0     0                    61193.849963 81882.8985  33.8%     -    6s
H    0     0                    61215.306439 81882.8985  33.8%     -    6s
     0     0 81040.6595    0  421 61215.3064 81040.6595  32.4%     -    7s
     0     0 80817.7408    0  476 61215.3064 80817.7408  32.0%     -    7s
     0     0 80778.5503    0  478 61215.3064 80778.5503  32.0%     -    7s
     0     0 80772.4162    0  419 61215.3064 80772.4162  31.9%     -    7s
H    0     0                    61241.909528 77174.3459  26.0%     -   10s
H    0     0                    61261.658984 77174.3459  26.0%     -   10s
     0     0 77174.3459    0  367 61261.6590 77174.3459  26.0%     -   10s
     0     0 76494.7921    0  424 61261.6590 76494.7921  24.9%     -   11s
     0     0 76299.0709    0  430 61261.6590 76299.0709  24.5%     -   11s
     0     0 76246.5240    0  434 61261.6590 76246.5240  24.5%     -   11s
     0     0 76228.2244    0  447 61261.6590 76228.2244  24.4%     -   11s
     0     0 76227.4962    0  446 61261.6590 76227.4962  24.4%     -   11s
     0     0 74344.3323    0  407 61261.6590 74344.3323  21.4%     -   14s
     0     0 73975.3760    0  392 61261.6590 73975.3760  20.8%     -   15s
     0     0 73837.2219    0  400 61261.6590 73837.2219  20.5%     -   15s
     0     0 73759.7276    0  423 61261.6590 73759.7276  20.4%     -   16s
     0     0 73743.2854    0  436 61261.6590 73743.2854  20.4%     -   16s
     0     0 73741.3550    0  424 61261.6590 73741.3550  20.4%     -   16s
     0     0 73114.2538    0  365 61261.6590 73114.2538  19.3%     -   17s
     0     0 72938.1987    0  464 61261.6590 72938.1987  19.1%     -   18s
     0     0 72847.1900    0  426 61261.6590 72847.1900  18.9%     -   18s
     0     0 72813.1942    0  514 61261.6590 72813.1942  18.9%     -   19s
     0     0 72805.0824    0  449 61261.6590 72805.0824  18.8%     -   19s
     0     0 72803.6075    0  440 61261.6590 72803.6075  18.8%     -   19s
     0     0 72650.9372    0  505 61261.6590 72650.9372  18.6%     -   20s
H    0     0                    61536.265863 72650.7646  18.1%     -   20s
     0     0 72594.1590    0  502 61536.2659 72594.1590  18.0%     -   21s
     0     0 72570.0080    0  496 61536.2659 72570.0080  17.9%     -   21s
     0     0 72561.4728    0  506 61536.2659 72561.4728  17.9%     -   21s
     0     0 72556.0974    0  516 61536.2659 72556.0974  17.9%     -   21s
     0     0 72408.8618    0  485 61536.2659 72408.8618  17.7%     -   22s
     0     0 72394.8617    0  490 61536.2659 72394.8617  17.6%     -   23s
     0     0 72386.1223    0  413 61536.2659 72386.1223  17.6%     -   23s
     0     0 72383.0764    0  412 61536.2659 72383.0764  17.6%     -   23s
     0     0 72310.6585    0  384 61536.2659 72310.6585  17.5%     -   24s
     0     0 72303.6876    0  391 61536.2659 72303.6876  17.5%     -   24s
     0     0 72297.8691    0  390 61536.2659 72297.8691  17.5%     -   24s
     0     0 72254.6659    0  431 61536.2659 72254.6659  17.4%     -   25s
     0     0 72224.3210    0  453 61536.2659 72224.3210  17.4%     -   25s
     0     0 72219.6656    0  468 61536.2659 72219.6656  17.4%     -   26s
     0     0 72162.2796    0  432 61536.2659 72162.2796  17.3%     -   26s
     0     0 72148.0243    0  396 61536.2659 72148.0243  17.2%     -   27s
     0     0 72144.3343    0  398 61536.2659 72144.3343  17.2%     -   27s
     0     0 72132.1760    0  394 61536.2659 72132.1760  17.2%     -   28s
     0     0 72131.1413    0  396 61536.2659 72131.1413  17.2%     -   28s
     0     0 72126.1370    0  444 61536.2659 72126.1370  17.2%     -   28s
     0     0 72125.6263    0  444 61536.2659 72125.6263  17.2%     -   29s
     0     2 72125.6263    0  444 61536.2659 72125.6263  17.2%     -   35s
    15    32 70927.7076    4  484 61536.2659 71750.3858  16.6%  1041   40s
   229   260 69397.0415   10  386 61536.2659 70933.0221  15.3%   614   45s
   386   409 67342.4178   12  353 61536.2659 70933.0221  15.3%   607   50s
H  540   527                    61566.310066 70525.5324  14.6%   580   53s
   635   675 67109.1844   15  372 61566.3101 70525.5324  14.6%   546   56s
   863   828 65432.5773   18  330 61566.3101 70525.5324  14.6%   520   60s
  1109   986 67981.8889   10  372 61566.3101 70492.2301  14.5%   507   65s
  1440  1224 63400.8471   14  355 61566.3101 70492.2301  14.5%   472   70s
  1713  1405     cutoff   20      61566.3101 70163.8988  14.0%   447   75s
  2151  1634 66025.5651   16  176 61566.3101 70163.8988  14.0%   430   80s
  2600  1791     cutoff   28      61566.3101 69760.0250  13.3%   431   85s
  3000  2012 65399.7329   11  242 61566.3101 69711.6332  13.2%   448   91s
  3570  2405 63915.7104   13  252 61566.3101 69672.1886  13.2%   441   97s
  3883  2440 63699.1390   14  216 61566.3101 69498.4565  12.9%   428  100s
  4340  2669 63325.2570   15  202 61566.3101 69177.4787  12.4%   434  106s
  4758  2769 64877.8879   15  444 61566.3101 69091.3200  12.2%   440  132s
  4761  2771 62345.8301   47  295 61566.3101 69091.3200  12.2%   439  138s
  4763  2772 65498.5384   15  364 61566.3101 69091.3200  12.2%   439  140s
  4771  2778 68494.8618   12  457 61566.3101 69091.3200  12.2%   438  145s
  4778  2782 62206.0349   17  468 61566.3101 69091.3200  12.2%   438  150s
  4785  2787 62716.9235   27  467 61566.3101 69091.3200  12.2%   437  155s
  4790  2790 66680.3400   19  516 61566.3101 69091.3200  12.2%   437  161s
  4793  2792 66615.0061   15  470 61566.3101 69091.3200  12.2%   436  167s
  4794  2793 66996.8255   10  470 61566.3101 69091.3200  12.2%   436  173s
  4795  2797 69091.3200   10  406 61566.3101 69091.3200  12.2%   442  178s
  4801  2807 68548.9166   12  325 61566.3101 68990.2357  12.1%   443  181s
  4857  2857 66200.1057   15  323 61566.3101 68176.1226  10.7%   448  185s
  5104  2845 62406.5023   19  245 61566.3101 68176.1226  10.7%   456  191s
  5303  2793 64875.9054   18  236 61566.3101 66891.9618  8.65%   454  195s
  5518  2734 62741.4987   22  164 61566.3101 65895.3216  7.03%   453  200s
  5818  2627 61860.3620   25  229 61566.3101 65700.0473  6.71%   447  205s
  6225  2339 62699.7780   18  189 61566.3101 63732.1778  3.52%   440  210s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 113
  Flow cover: 427
  RLT: 11
  Relax-and-lift: 37

Explored 6409 nodes (2799132 simplex iterations) in 211.42 seconds (313.46 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 61566.3 61536.3 61261.7 ... 60866.7

Optimal solution found (tolerance 1.00e-06)
Best objective 6.156631006631e+04, best bound 6.156631006631e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 211.42s
  Master Objective (UB) = 61566.31, θ = 212089.63
  Upper Bound (UB) = 61566.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 212089.63
  [DEBUG]   ✓ Scenario 0: θ = 212089.63 ≤ Q = 212089.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 212089.63 ≤ Q = 212089.63 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3b6ac547
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3b6ac547
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.499323e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 7287967.8371
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.780730e+05, 258 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -178073.00    0  127 7287967.84 -178073.00   102%     -    0s
H    0     0                    -141609.9776 -178073.00  25.7%     -    0s
H    0     0                    -141924.6648 -178073.00  25.5%     -    0s
H    0     0                    -159092.9710 -178073.00  11.9%     -    0s
H    0     0                    -159259.7816 -168887.26  6.05%     -    0s
     0     0 -168887.26    0  108 -159259.78 -168887.26  6.05%     -    0s
H    0     0                    -163366.5515 -168752.07  3.30%     -    0s
H    0     0                    -165680.2932 -168489.62  1.70%     -    0s
     0     0 -168489.62    0  101 -165680.29 -168489.62  1.70%     -    0s
     0     0 -168482.43    0  101 -165680.29 -168482.43  1.69%     -    0s
H    0     0                    -166278.5788 -168482.43  1.33%     -    0s
     0     0 -167593.13    0   91 -166278.58 -167593.13  0.79%     -    0s
H    0     0                    -166501.6431 -167546.83  0.63%     -    0s
     0     0 -167471.90    0   70 -166501.64 -167471.90  0.58%     -    0s
     0     0 -167443.05    0   67 -166501.64 -167443.05  0.57%     -    0s
     0     0 -167426.83    0   67 -166501.64 -167426.83  0.56%     -    0s
     0     0 -167422.53    0   68 -166501.64 -167422.53  0.55%     -    0s
     0     0 -166852.44    0   29 -166501.64 -166852.44  0.21%     -    0s
     0     0 -166852.16    0   17 -166501.64 -166852.16  0.21%     -    0s
     0     0 -166794.51    0   25 -166501.64 -166794.51  0.18%     -    0s
     0     0 -166775.85    0   25 -166501.64 -166775.85  0.16%     -    0s
     0     0 -166770.82    0   26 -166501.64 -166770.82  0.16%     -    0s
     0     0 -166605.83    0   10 -166501.64 -166605.83  0.06%     -    0s
     0     0 -166601.23    0    9 -166501.64 -166601.23  0.06%     -    0s
     0     0 -166583.70    0    9 -166501.64 -166583.70  0.05%     -    0s
     0     0 -166552.87    0    5 -166501.64 -166552.87  0.03%     -    0s
     0     0 -166552.87    0    9 -166501.64 -166552.87  0.03%     -    0s
H    0     0                    -166512.5723 -166552.87  0.02%     -    0s
H    0     0                    -166523.7931 -166552.87  0.02%     -    0s
     0     0     cutoff    0      -166523.79 -166523.79  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 3
  Flow cover: 1
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (892 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -166524 -166513 -166502 ... -141925
No other solutions better than -166524

Optimal solution found (tolerance 1.00e-06)
Best objective -1.665237931064e+05, best bound -1.665237931064e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 187796.63
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -166523.79
  [DEBUG]   S×d_nominal = 354320.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 354320.42 + -166523.79 = 187796.63
  [DEBUG]   Current θ from Master = 212089.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24293.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 37273.31
  Lower Bound (LB) = 45543.29
  Gap (UB-LB) = 16023.0160, Absolute Gap = 16023.0160, Relative Gap = 0.260256
  Not converged yet (gap = 16023.02 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0x1f1136e2
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 37273.3 (0.03s)
MIP start from previous solve produced solution with objective 37273.3 (0.03s)
Loaded MIP start from previous solve with objective 37273.3

Presolve removed 21290 rows and 8650 columns
Presolve time: 0.66s
Presolved: 25963 rows, 12330 columns, 159809 nonzeros
Variable types: 10071 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42065    8.1541787e+04   0.000000e+00   7.732056e+05      5s
Concurrent spin time: 0.32s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16005    8.2923808e+04   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 8.292381e+04, 16005 iterations, 4.36 seconds (5.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82923.8076    0  126 37273.3110 82923.8076   122%     -    5s
H    0     0                    50870.432699 82923.8076  63.0%     -    5s
H    0     0                    52673.794971 82923.8076  57.4%     -    5s
     0     0 77116.1182    0  228 52673.7950 77116.1182  46.4%     -    7s
     0     0 76709.5930    0  223 52673.7950 76709.5930  45.6%     -    8s
     0     0 76656.0529    0  194 52673.7950 76656.0529  45.5%     -    8s
     0     0 76656.0529    0  223 52673.7950 76656.0529  45.5%     -    8s
     0     0 76656.0529    0  223 52673.7950 76656.0529  45.5%     -    8s
H    0     0                    52708.338320 73794.3325  40.0%     -   10s
     0     0 73794.3325    0  294 52708.3383 73794.3325  40.0%     -   10s
H    0     0                    54460.776224 73792.9276  35.5%     -   10s
H    0     0                    54779.108748 73792.9276  34.7%     -   10s
H    0     0                    54826.905418 73792.9276  34.6%     -   10s
H    0     0                    55287.796781 73792.9276  33.5%     -   10s
H    0     0                    55372.856765 73792.9276  33.3%     -   10s
H    0     0                    55386.757043 73792.9276  33.2%     -   10s
H    0     0                    55405.123167 73792.9276  33.2%     -   10s
     0     0 73382.5134    0  309 55405.1232 73382.5134  32.4%     -   11s
     0     0 73223.2700    0  307 55405.1232 73223.2700  32.2%     -   11s
     0     0 73159.1366    0  299 55405.1232 73159.1366  32.0%     -   11s
     0     0 73154.8353    0  302 55405.1232 73154.8353  32.0%     -   12s
     0     0 73111.3825    0  302 55405.1232 73111.3825  32.0%     -   12s
     0     0 73105.8297    0  309 55405.1232 73105.8297  31.9%     -   12s
     0     0 73105.4642    0  307 55405.1232 73105.4642  31.9%     -   12s
     0     0 71991.0016    0  344 55405.1232 71991.0016  29.9%     -   14s
H    0     0                    55579.918510 71990.2250  29.5%     -   15s
     0     0 71776.6761    0  347 55579.9185 71776.6761  29.1%     -   15s
     0     0 71628.9328    0  354 55579.9185 71628.9328  28.9%     -   15s
     0     0 71480.7764    0  360 55579.9185 71480.7764  28.6%     -   16s
     0     0 71440.5214    0  355 55579.9185 71440.5214  28.5%     -   16s
     0     0 71419.8574    0  368 55579.9185 71419.8574  28.5%     -   16s
     0     0 71415.4881    0  370 55579.9185 71415.4881  28.5%     -   16s
     0     0 71413.1113    0  371 55579.9185 71413.1113  28.5%     -   16s
     0     0 71411.6769    0  371 55579.9185 71411.6769  28.5%     -   16s
     0     0 71411.2292    0  370 55579.9185 71411.2292  28.5%     -   16s
     0     0 71017.9735    0  332 55579.9185 71017.9735  27.8%     -   19s
H    0     0                    56088.617839 71016.9381  26.6%     -   19s
     0     0 70881.9303    0  343 56088.6178 70881.9303  26.4%     -   20s
     0     0 70807.1369    0  346 56088.6178 70807.1369  26.2%     -   20s
     0     0 70766.0765    0  354 56088.6178 70766.0765  26.2%     -   20s
     0     0 70722.0013    0  361 56088.6178 70722.0013  26.1%     -   21s
     0     0 70713.3815    0  359 56088.6178 70713.3815  26.1%     -   21s
     0     0 70696.2365    0  361 56088.6178 70696.2365  26.0%     -   21s
     0     0 70688.3772    0  364 56088.6178 70688.3772  26.0%     -   21s
     0     0 70683.5570    0  390 56088.6178 70683.5570  26.0%     -   22s
     0     0 70682.4460    0  400 56088.6178 70682.4460  26.0%     -   23s
     0     0 70603.0809    0  367 56088.6178 70603.0809  25.9%     -   24s
H    0     0                    56088.921695 70602.4619  25.9%     -   24s
     0     0 70565.3867    0  406 56088.9217 70565.3867  25.8%     -   24s
     0     0 70550.4864    0  411 56088.9217 70550.4864  25.8%     -   25s
     0     0 70544.2197    0  409 56088.9217 70544.2197  25.8%     -   25s
     0     0 70541.3529    0  409 56088.9217 70541.3529  25.8%     -   25s
     0     0 70541.0968    0  409 56088.9217 70541.0968  25.8%     -   25s
     0     0 70415.8979    0  408 56088.9217 70415.8979  25.5%     -   26s
     0     0 70377.2937    0  400 56088.9217 70377.2937  25.5%     -   27s
     0     0 70365.1742    0  406 56088.9217 70365.1742  25.5%     -   27s
     0     0 70358.1348    0  405 56088.9217 70358.1348  25.4%     -   27s
     0     0 70357.2918    0  410 56088.9217 70357.2918  25.4%     -   27s
H    0     0                    56255.274336 70306.7939  25.0%     -   28s
H    0     0                    56257.904335 70306.7939  25.0%     -   28s
     0     0 70306.7939    0  416 56257.9043 70306.7939  25.0%     -   28s
     0     0 70296.5016    0  411 56257.9043 70296.5016  25.0%     -   28s
     0     0 70287.2030    0  415 56257.9043 70287.2030  24.9%     -   28s
     0     0 70282.2406    0  417 56257.9043 70282.2406  24.9%     -   29s
     0     0 70281.2607    0  418 56257.9043 70281.2607  24.9%     -   29s
     0     0 70262.8261    0  415 56257.9043 70262.8261  24.9%     -   29s
H    0     0                    56282.371123 70261.9968  24.8%     -   30s
H    0     0                    56426.412249 70261.9968  24.5%     -   30s
     0     0 70256.8885    0  421 56426.4122 70256.8885  24.5%     -   30s
     0     0 70254.5549    0  427 56426.4122 70254.5549  24.5%     -   30s
     0     0 70251.6743    0  422 56426.4122 70251.6743  24.5%     -   30s
     0     0 70249.6257    0  428 56426.4122 70249.6257  24.5%     -   30s
     0     0 70249.1418    0  429 56426.4122 70249.1418  24.5%     -   30s
H    0     0                    56501.303617 70181.9439  24.2%     -   31s
     0     0 70181.9439    0  424 56501.3036 70181.9439  24.2%     -   31s
H    0     0                    56544.549226 70179.9462  24.1%     -   31s
     0     0 70168.1040    0  422 56544.5492 70168.1040  24.1%     -   32s
     0     0 70166.0746    0  424 56544.5492 70166.0746  24.1%     -   32s
H    0     0                    56579.719985 70165.2105  24.0%     -   32s
     0     0 70165.2105    0  425 56579.7200 70165.2105  24.0%     -   32s
     0     0 70156.5717    0  421 56579.7200 70156.5717  24.0%     -   32s
     0     0 70155.3877    0  426 56579.7200 70155.3877  24.0%     -   33s
     0     0 70143.4431    0  428 56579.7200 70143.4431  24.0%     -   33s
H    0     0                    56730.708403 70143.2746  23.6%     -   34s
     0     0 70142.3787    0  430 56730.7084 70142.3787  23.6%     -   34s
     0     0 70140.0803    0  435 56730.7084 70140.0803  23.6%     -   34s
     0     0 70135.2050    0  426 56730.7084 70135.2050  23.6%     -   34s
     0     0 70134.9321    0  426 56730.7084 70134.9321  23.6%     -   35s
     0     0 70130.9953    0  424 56730.7084 70130.9953  23.6%     -   35s
     0     0 70130.5117    0  424 56730.7084 70130.5117  23.6%     -   35s
H    0     0                    56960.283695 70129.8368  23.1%     -   41s
     0     2 70129.8368    0  424 56960.2837 70129.8368  23.1%     -   41s
     7    16 69826.5709    3  407 56960.2837 69940.5988  22.8%   613   45s
    31    64 69612.3668    5  413 56960.2837 69676.7965  22.3%  1863   50s
H   33    64                    57131.579682 69676.7965  22.0%  1827   50s
H   33    64                    57275.268312 69676.7965  21.7%  1827   50s
H   38    64                    57573.205332 69676.7965  21.0%  1733   50s
   127   167 67848.2726    8  373 57573.2053 69594.6818  20.9%  1254   56s
H  132   167                    57656.982767 69594.6818  20.7%  1281   56s
H  144   167                    57657.837341 69594.6818  20.7%  1256   56s
   298   368 68984.8852   11  388 57657.8373 69594.6818  20.7%   860   61s
   434   492 68591.5106   13  376 57657.8373 69594.6818  20.7%   792   66s
   574   609 61700.3875   14  372 57657.8373 69594.6818  20.7%   779   70s
   774   801 67155.8598   16  387 57657.8373 69573.3931  20.7%   725   75s
   938   918 65423.7432   18  380 57657.8373 69440.4107  20.4%   706   80s
  1074  1075 65962.9806   19  381 57657.8373 69384.0520  20.3%   714   85s
  1269  1254 64623.5523   21  314 57657.8373 69384.0520  20.3%   680   90s
  1604  1518 64205.9518   23  301 57657.8373 69384.0520  20.3%   641   97s
  1860  1747 63520.2889   26  296 57657.8373 69059.4459  19.8%   619  102s
  2063  1799 infeasible   28      57657.8373 68690.1416  19.1%   607  106s
H 2129  1825                    57711.144894 68690.1416  19.0%   610  108s
H 2143  1825                    57711.506000 68690.1416  19.0%   609  108s
  2172  1906     cutoff   30      57711.5060 68690.1416  19.0%   610  111s
  2513  2044 59199.4396   35  242 57711.5060 68308.7100  18.4%   591  117s
  2651  2099 59036.1007   36  231 57711.5060 68308.7100  18.4%   592  120s
  2946  2275 infeasible   41      57711.5060 68056.2827  17.9%   593  126s
  3135  2324 65505.7559    8  327 57711.5060 67937.2787  17.7%   599  130s
  3230  2389 58379.0843   10  189 57711.5060 67937.2787  17.7%   602  135s
  3448  2539 63466.8283   11  260 57711.5060 67937.2787  17.7%   593  141s
  3630  2631 62903.4467   12  235 57711.5060 67937.2787  17.7%   588  145s
  4034  2839 58545.6813   14  245 57711.5060 67867.1722  17.6%   586  152s
  4237  2985     cutoff   16      57711.5060 67639.1442  17.2%   587  156s
  4520  2986 63004.9844   34  424 57711.5060 67639.1442  17.2%   579  170s
  4522  2987 62683.6385   25  126 57711.5060 67639.1442  17.2%   579  176s
  4523  2988 62247.6931   36  313 57711.5060 67639.1442  17.2%   579  180s
  4526  2990 62842.8759   19  396 57711.5060 67639.1442  17.2%   578  185s
  4532  2994 58708.3273   28  437 57711.5060 67639.1442  17.2%   577  191s
  4538  2998 59413.9719   28  427 57711.5060 67639.1442  17.2%   577  195s
  4543  3001 63958.0820   13  441 57711.5060 67639.1442  17.2%   576  200s
  4549  3005 59292.4610   28  485 57711.5060 67639.1442  17.2%   575  205s
  4553  3008 58821.5641   38  403 57711.5060 67639.1442  17.2%   575  210s
  4558  3011 60093.5256   62  448 57711.5060 67639.1442  17.2%   574  216s
  4561  3013 60837.7565   38  444 57711.5060 67639.1442  17.2%   574  226s
  4562  3014 59987.9917   48  444 57711.5060 67639.1442  17.2%   574  231s
  4563  3018 67639.1442   12  440 57711.5060 67639.1442  17.2%   585  236s
  4569  3028 67639.1442   14  324 57711.5060 67639.1442  17.2%   588  243s
  4577  3041 67639.1442   15  363 57711.5060 67639.1442  17.2%   591  248s
  4593  3068 67639.1442   16  371 57711.5060 67639.1442  17.2%   607  252s
  4657  3132 67128.3412   18  349 57711.5060 67639.1442  17.2%   626  257s
  4713  3173 60970.2251   19  314 57711.5060 67639.1442  17.2%   633  260s
  4846  3197 62803.4587   21  330 57711.5060 67639.1442  17.2%   655  268s
  4916  3191 60523.9136   22  318 57711.5060 67472.2260  16.9%   669  271s
  4959  3200 62357.3224   22  311 57711.5060 67472.2260  16.9%   679  275s
  5053  3195 60300.8492   23  287 57711.5060 67472.2260  16.9%   696  281s
  5104  3194 61851.8502   24  299 57711.5060 67472.2260  16.9%   703  285s
  5206  3214 60483.7188   26  263 57711.5060 67472.2260  16.9%   722  292s
  5250  3225     cutoff   27      57711.5060 67472.2260  16.9%   726  296s
  5345  3229 59910.9940   19  340 57711.5060 66421.5469  15.1%   740  302s
  5393  3237 59130.6504   22  263 57711.5060 66421.5469  15.1%   745  305s
  5493  3207     cutoff   28      57711.5060 66262.4885  14.8%   759  311s
  5597  3191 61867.6725   24  321 57711.5060 65954.4515  14.3%   772  319s
  5645  3180 61789.6515   25  312 57711.5060 65954.4515  14.3%   776  322s
  5691  3166 57966.5331   26  254 57711.5060 65954.4515  14.3%   782  326s
  5763  3159     cutoff   27      57711.5060 65954.4515  14.3%   784  330s
  5914  3131     cutoff   28      57711.5060 65603.9228  13.7%   795  337s
  5987  3130 62293.7832   23  268 57711.5060 65602.6687  13.7%   807  341s
  6062  3141 59742.7812   28  198 57711.5060 65386.1146  13.3%   813  345s
  6155  3131 58487.4898   36  113 57711.5060 65386.1146  13.3%   820  350s
  6410  3068     cutoff   22      57711.5060 64925.2527  12.5%   831  359s
  6532  3045 62122.1600   23  322 57711.5060 64925.2527  12.5%   839  364s
  6670  3014 60679.7880   25  251 57711.5060 64535.7229  11.8%   847  369s
  6712  3020 58611.9916   26  234 57711.5060 64481.3090  11.7%   852  373s
  6770  3006     cutoff   27      57711.5060 64481.3090  11.7%   854  377s
  6843  2996 59859.1321   22  286 57711.5060 64481.3090  11.7%   859  381s
  6913  2975     cutoff   22      57711.5060 64481.3090  11.7%   862  386s
H 6972  2804                    57742.549925 64481.3090  11.7%   864  386s
  6994  2787 59694.1946   23  242 57742.5499 64481.3090  11.7%   866  392s
  7219  2714 61500.2956   21  255 57742.5499 64140.6525  11.1%   874  399s
  7405  2655 58282.8725   24  269 57742.5499 64123.0434  11.0%   886  406s
  7617  2586 59792.3579   23  318 57742.5499 63574.0632  10.1%   896  412s
  7832  2465     cutoff   26      57742.5499 63184.5848  9.42%   906  418s
  8062  2384 61741.8862   24  275 57742.5499 63022.8967  9.14%   919  424s
  8305  2227 58169.7038   26  252 57742.5499 62678.1738  8.55%   929  430s
  8633  2056 59978.3489   22  293 57742.5499 62537.0927  8.30%   933  436s
  8938  1857 infeasible   24      57742.5499 61679.0132  6.82%   941  443s
  9334  1625     cutoff   26      57742.5499 61250.1687  6.07%   942  449s
  9876  1270     cutoff   24      57742.5499 60696.8488  5.12%   926  454s
 10851   944     cutoff   39      57742.5499 59064.4740  2.29%   865  455s

Cutting planes:
  Gomory: 5
  MIR: 211
  Mixing: 2
  Flow cover: 714
  RLT: 7
  Relax-and-lift: 69

Explored 12675 nodes (9489516 simplex iterations) in 457.24 seconds (815.91 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 57742.5 57711.5 57711.1 ... 56730.7

Optimal solution found (tolerance 1.00e-06)
Best objective 5.774254992520e+04, best bound 5.774254992520e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 457.25s
  Master Objective (UB) = 57742.55, θ = 207686.43
  Upper Bound (UB) = 57742.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 207686.43
  [DEBUG]   ✓ Scenario 0: θ = 207686.43 ≤ Q = 207686.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 207686.43 ≤ Q = 207686.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 207686.43 ≤ Q = 207686.43 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x248047b2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x248047b2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.510385e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7337974.3960
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.733030e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173302.97    0  128 7337974.40 -173302.97   102%     -    0s
H    0     0                    -137740.6952 -173302.97  25.8%     -    0s
H    0     0                    -138079.0628 -173302.97  25.5%     -    0s
H    0     0                    -145076.0141 -173302.97  19.5%     -    0s
     0     0 -157119.66    0  103 -145076.01 -157119.66  8.30%     -    0s
H    0     0                    -151408.8571 -157103.03  3.76%     -    0s
     0     0 -156854.38    0   83 -151408.86 -156854.38  3.60%     -    0s
H    0     0                    -154901.8919 -156854.38  1.26%     -    0s
     0     0 -155887.72    0   84 -154901.89 -155887.72  0.64%     -    0s
     0     0 -155743.69    0   66 -154901.89 -155743.69  0.54%     -    0s
     0     0 -155683.67    0   73 -154901.89 -155683.67  0.50%     -    0s
     0     0 -155680.63    0   73 -154901.89 -155680.63  0.50%     -    0s
     0     0 -155603.39    0   59 -154901.89 -155603.39  0.45%     -    0s
     0     0 -155600.64    0   59 -154901.89 -155600.64  0.45%     -    0s
     0     0 -155367.95    0   26 -154901.89 -155367.95  0.30%     -    0s
     0     0 -155336.03    0   40 -154901.89 -155336.03  0.28%     -    0s
     0     0 -155336.03    0   40 -154901.89 -155336.03  0.28%     -    0s
     0     0 -155204.49    0   22 -154901.89 -155204.49  0.20%     -    0s
     0     0 -155201.59    0   22 -154901.89 -155201.59  0.19%     -    0s
     0     0 -155199.76    0   22 -154901.89 -155199.76  0.19%     -    0s
     0     0 -155111.05    0   28 -154901.89 -155111.05  0.14%     -    0s
     0     0 -155110.95    0   27 -154901.89 -155110.95  0.13%     -    0s
     0     0 -154951.00    0   10 -154901.89 -154951.00  0.03%     -    0s
     0     0 -154922.57    0    7 -154901.89 -154922.57  0.01%     -    0s
     0     0     cutoff    0      -154901.89 -154901.89  0.00%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 1
  Flow cover: 5
  RLT: 5
  Relax-and-lift: 2

Explored 1 nodes (841 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -154902 -153254 -145076 ... 1.51039e+13
No other solutions better than -154902

Optimal solution found (tolerance 1.00e-06)
Best objective -1.549018919368e+05, best bound -1.549018919368e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 190299.66
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154901.89
  [DEBUG]   S×d_nominal = 345201.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 345201.55 + -154901.89 = 190299.66
  [DEBUG]   Current θ from Master = 207686.43
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17386.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 40355.78
  Lower Bound (LB) = 45543.29
  Gap (UB-LB) = 12199.2558, Absolute Gap = 12199.2558, Relative Gap = 0.211270
  Not converged yet (gap = 12199.26 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x4334b799
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 40355.8 (0.09s)
MIP start from previous solve produced solution with objective 40355.8 (0.09s)
Loaded MIP start from previous solve with objective 40355.8

Presolve removed 28400 rows and 11540 columns
Presolve time: 1.28s
Presolved: 34143 rows, 15680 columns, 211199 nonzeros
Variable types: 13421 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34143 rows, 15680 columns, 211199 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43318    5.1721112e+04   0.000000e+00   8.123930e+06      5s
Concurrent spin time: 0.59s

Solved with dual simplex

Root relaxation: objective 8.250061e+04, 22233 iterations, 8.77 seconds (11.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82500.6087    0  134 40355.7831 82500.6087   104%     -   10s
H    0     0                    52104.754527 82500.6087  58.3%     -   10s
H    0     0                    53160.555783 82500.6087  55.2%     -   10s
H    0     0                    54688.623890 82500.6087  50.9%     -   10s
H    0     0                    55611.618156 82500.6087  48.4%     -   10s
H    0     0                    56674.347556 82500.6087  45.6%     -   10s
     0     0 76788.9452    0  204 56674.3476 76788.9452  35.5%     -   14s
     0     0 76408.6878    0  217 56674.3476 76408.6878  34.8%     -   15s
     0     0 76408.6878    0  214 56674.3476 76408.6878  34.8%     -   16s
     0     0 76408.6878    0  225 56674.3476 76408.6878  34.8%     -   16s
     0     0 76408.6878    0  225 56674.3476 76408.6878  34.8%     -   16s
     0     0 73767.9860    0  266 56674.3476 73767.9860  30.2%     -   20s
H    0     0                    56695.168052 73767.7761  30.1%     -   20s
     0     0 73338.0356    0  299 56695.1681 73338.0356  29.4%     -   22s
     0     0 73117.7143    0  288 56695.1681 73117.7143  29.0%     -   24s
H    0     0                    56857.804740 72964.1513  28.3%     -   25s
H    0     0                    56970.413697 72964.1513  28.1%     -   25s
H    0     0                    56971.220703 72964.1513  28.1%     -   25s
     0     0 72964.1513    0  293 56971.2207 72964.1513  28.1%     -   25s
     0     0 72903.6844    0  304 56971.2207 72903.6844  28.0%     -   25s
     0     0 72883.5195    0  304 56971.2207 72883.5195  27.9%     -   26s
     0     0 72881.2020    0  303 56971.2207 72881.2020  27.9%     -   26s
     0     0 72880.1868    0  308 56971.2207 72880.1868  27.9%     -   26s
     0     0 72880.0312    0  306 56971.2207 72880.0312  27.9%     -   27s
H    0     0                    56997.533411 71537.1543  25.5%     -   33s
     0     0 71537.1543    0  337 56997.5334 71537.1543  25.5%     -   33s
H    0     0                    57233.897817 71191.9559  24.4%     -   35s
     0     0 71191.9559    0  374 57233.8978 71191.9559  24.4%     -   35s
     0     0 71109.5986    0  348 57233.8978 71109.5986  24.2%     -   37s
     0     0 71076.0409    0  364 57233.8978 71076.0409  24.2%     -   37s
     0     0 71063.7357    0  365 57233.8978 71063.7357  24.2%     -   37s
     0     0 71060.4261    0  368 57233.8978 71060.4261  24.2%     -   38s
     0     0 71059.9214    0  369 57233.8978 71059.9214  24.2%     -   38s
     0     0 70453.4802    0  395 57233.8978 70453.4802  23.1%     -   43s
     0     0 70283.6733    0  425 57233.8978 70283.6733  22.8%     -   45s
     0     0 70211.0712    0  400 57233.8978 70211.0712  22.7%     -   46s
     0     0 70175.7345    0  435 57233.8978 70175.7345  22.6%     -   47s
     0     0 70166.8474    0  440 57233.8978 70166.8474  22.6%     -   47s
     0     0 70151.4468    0  437 57233.8978 70151.4468  22.6%     -   47s
     0     0 70142.3086    0  438 57233.8978 70142.3086  22.6%     -   48s
     0     0 70133.9088    0  440 57233.8978 70133.9088  22.5%     -   48s
     0     0 70131.2186    0  442 57233.8978 70131.2186  22.5%     -   48s
     0     0 70128.9704    0  440 57233.8978 70128.9704  22.5%     -   48s
     0     0 70126.6786    0  447 57233.8978 70126.6786  22.5%     -   49s
     0     0 70125.9210    0  448 57233.8978 70125.9210  22.5%     -   49s
     0     0 69970.9121    0  453 57233.8978 69970.9121  22.3%     -   51s
     0     0 69922.1506    0  414 57233.8978 69922.1506  22.2%     -   52s
     0     0 69907.4551    0  417 57233.8978 69907.4551  22.1%     -   53s
     0     0 69901.5554    0  411 57233.8978 69901.5554  22.1%     -   53s
     0     0 69898.9790    0  420 57233.8978 69898.9790  22.1%     -   53s
     0     0 69898.0944    0  421 57233.8978 69898.0944  22.1%     -   53s
     0     0 69767.3772    0  414 57233.8978 69767.3772  21.9%     -   55s
     0     0 69700.8975    0  423 57233.8978 69700.8975  21.8%     -   56s
     0     0 69659.9249    0  425 57233.8978 69659.9249  21.7%     -   57s
     0     0 69653.2677    0  429 57233.8978 69653.2677  21.7%     -   57s
     0     0 69651.8638    0  435 57233.8978 69651.8638  21.7%     -   58s
     0     0 69580.6618    0  440 57233.8978 69580.6618  21.6%     -   59s
     0     0 69562.9306    0  443 57233.8978 69562.9306  21.5%     -   60s
     0     0 69549.5732    0  442 57233.8978 69549.5732  21.5%     -   60s
     0     0 69543.5073    0  443 57233.8978 69543.5073  21.5%     -   61s
     0     0 69540.7553    0  446 57233.8978 69540.7553  21.5%     -   61s
     0     0 69539.2928    0  455 57233.8978 69539.2928  21.5%     -   61s
H    0     0                    57260.331186 69539.2928  21.4%     -   62s
H    0     0                    57266.517694 69415.0363  21.2%     -   63s
     0     0 69415.0363    0  440 57266.5177 69415.0363  21.2%     -   63s
     0     0 69395.4843    0  446 57266.5177 69395.4843  21.2%     -   64s
     0     0 69389.1779    0  457 57266.5177 69389.1779  21.2%     -   65s
     0     0 69386.5274    0  454 57266.5177 69386.5274  21.2%     -   65s
     0     0 69385.5015    0  456 57266.5177 69385.5015  21.2%     -   65s
     0     0 69372.3644    0  458 57266.5177 69372.3644  21.1%     -   66s
     0     0 69369.5298    0  460 57266.5177 69369.5298  21.1%     -   67s
     0     0 69367.8032    0  458 57266.5177 69367.8032  21.1%     -   67s
     0     0 69366.7264    0  462 57266.5177 69366.7264  21.1%     -   67s
     0     0 69342.3863    0  461 57266.5177 69342.3863  21.1%     -   68s
     0     0 69339.5428    0  461 57266.5177 69339.5428  21.1%     -   68s
     0     0 69337.8254    0  464 57266.5177 69337.8254  21.1%     -   69s
     0     0 69337.1265    0  453 57266.5177 69337.1265  21.1%     -   69s
     0     0 69332.6235    0  456 57266.5177 69332.6235  21.1%     -   70s
     0     0 69329.6018    0  457 57266.5177 69329.6018  21.1%     -   70s
     0     0 69327.9887    0  464 57266.5177 69327.9887  21.1%     -   70s
     0     0 69323.4577    0  466 57266.5177 69323.4577  21.1%     -   71s
     0     0 69320.7650    0  466 57266.5177 69320.7650  21.0%     -   72s
     0     0 69317.9778    0  469 57266.5177 69317.9778  21.0%     -   72s
H    0     0                    57308.858681 69317.7414  21.0%     -   72s
     0     0 69317.7414    0  470 57308.8587 69317.7414  21.0%     -   73s
     0     0 69314.0608    0  469 57308.8587 69314.0608  20.9%     -   73s
     0     0 69313.9789    0  469 57308.8587 69313.9789  20.9%     -   74s
     0     2 69313.9789    0  469 57308.8587 69313.9789  20.9%     -   84s
     1     4 69106.4798    1  431 57308.8587 69313.7782  20.9%  1004   85s
     7    16 68849.4921    3  449 57308.8587 69046.7308  20.5%  1506   91s
    15    32 68679.2893    4  443 57308.8587 68849.4619  20.1%  2355   96s
    31    64 68648.2804    5  442 57308.8587 68690.7252  19.9%  4057  100s
    95   192 68508.9161    7  436 57308.8587 68647.9467  19.8%  2411  110s
   282   371 68027.6538    9  447 57308.8587 68647.9467  19.8%  1489  119s
   372   437 68025.4982   10  447 57308.8587 68647.9467  19.8%  1313  123s
   438   503 67085.3881   12  457 57308.8587 68647.9467  19.8%  1302  127s
   506   562 66071.0772   12  374 57308.8587 68647.9467  19.8%  1273  132s
   571   619 66899.6600   13  459 57308.8587 68647.9467  19.8%  1266  136s
   644   672 66565.6147   13  432 57308.8587 68518.6881  19.6%  1251  141s
   721   724 66851.5835   14  458 57308.8587 68518.6881  19.6%  1217  147s
   779   778 66805.1282   15  415 57308.8587 68511.7070  19.5%  1233  151s
   912   872 60150.2488   17  385 57308.8587 68451.4678  19.4%  1226  159s
   945   915 65263.3954   18  358 57308.8587 68451.4678  19.4%  1238  164s
   988   973 64765.8825   20  344 57308.8587 68451.4678  19.4%  1280  167s
  1050  1054 64750.1296   21  338 57308.8587 68451.4678  19.4%  1267  171s
  1153  1120 64679.3435   23  369 57308.8587 68451.4678  19.4%  1213  178s
  1245  1200 64537.8863   24  314 57308.8587 68364.7386  19.3%  1184  182s
  1340  1272 64513.1616   25  274 57308.8587 68364.7386  19.3%  1154  186s
  1432  1344 63873.1813   28  238 57308.8587 68268.3123  19.1%  1150  191s
  1651  1610 61545.4592   35  197 57308.8587 68268.3123  19.1%  1092  197s
  1822  1765 62555.3741   36  281 57308.8587 68268.3123  19.1%  1036  204s
  2007  1853 59914.7647   37  289 57308.8587 68268.3123  19.1%  1000  207s
  2109  1971 61737.2316   38  220 57308.8587 68217.8666  19.0%   975  213s
  2264  2081 61462.0403   39  203 57308.8587 68160.7310  18.9%   950  219s
  2422  2203 59158.7131   41  250 57308.8587 68129.3810  18.9%   937  225s
  2603  2343 58819.0545   42  198 57308.8587 68129.3810  18.9%   917  230s
  2788  2514 58098.9247   50  140 57308.8587 68129.3810  18.9%   898  235s
  2995  2631 61034.4691   12  300 57308.8587 68129.3810  18.9%   877  241s
  3152  2678 60588.1979   14  299 57308.8587 68129.3810  18.9%   872  245s
  3442  2873 66192.9308   11  469 57308.8587 68129.3810  18.9%   837  306s
  3444  2874 62561.5035   26  134 57308.8587 68129.3810  18.9%   837  318s
  3445  2875 63907.4082   26  265 57308.8587 68129.3810  18.9%   837  326s
  3446  2876 62467.8564   22  377 57308.8587 68129.3810  18.9%   837  332s
  3447  2876 63205.6697   22  404 57308.8587 68129.3810  18.9%   836  337s
  3449  2878 64001.5149   26  420 57308.8587 68129.3810  18.9%   836  343s
  3450  2878 65397.9146    9  484 57308.8587 68129.3810  18.9%   836  346s
  3453  2880 62291.3228   43  452 57308.8587 68129.3810  18.9%   835  350s
  3459  2884 63134.6300   23  471 57308.8587 68129.3810  18.9%   833  355s
  3460  2885 59914.7811   38  419 57308.8587 68129.3810  18.9%   833  360s
  3466  2889 62668.3485   27  432 57308.8587 68129.3810  18.9%   832  368s
  3468  2890 63549.0206   24  436 57308.8587 68129.3810  18.9%   831  370s
  3471  2892 61883.0366   47  449 57308.8587 68129.3810  18.9%   830  375s
  3476  2896 62671.2014   29  449 57308.8587 68129.3810  18.9%   829  380s
  3479  2898 63093.0739   36  457 57308.8587 68129.3810  18.9%   829  385s
  3482  2900 58501.0256   21  453 57308.8587 68129.3810  18.9%   828  392s
  3486  2902 64462.1416    9  459 57308.8587 68129.3810  18.9%   827  395s
  3490  2905 59973.6993   46  505 57308.8587 68129.3810  18.9%   826  400s
  3492  2906 58235.9256   20  460 57308.8587 68129.3810  18.9%   825  405s
  3495  2908 61426.9779   37  484 57308.8587 68129.3810  18.9%   825  410s
  3497  2910 59376.6282   23  463 57308.8587 68129.3810  18.9%   824  416s
  3500  2912 65213.0721   24  483 57308.8587 68129.3810  18.9%   824  422s
  3502  2913 64178.9973   21  494 57308.8587 68129.3810  18.9%   823  426s
  3504  2914 67582.6500    7  482 57308.8587 68129.3810  18.9%   823  431s
  3505  2915 66422.2320    7  482 57308.8587 68129.3810  18.9%   822  446s
  3506  2916 61473.7548   39  482 57308.8587 68129.3810  18.9%   822  463s
  3507  2919 68103.5845   15  467 57308.8587 68129.3810  18.9%   852  470s
  3509  2923 68042.8605   16  460 57308.8587 68102.1535  18.8%   853  479s
  3513  2929 67931.7342   17  440 57308.8587 68042.7208  18.7%   857  485s
  3521  2943 67797.8272   18  423 57308.8587 67931.4222  18.5%   863  493s
  3537  2957 62084.4610   19  348 57308.8587 67797.2420  18.3%   878  506s
  3557  2983 65496.6213   20  416 57308.8587 67797.0838  18.3%   936  515s
  3589  3062 65461.3394   21  407 57308.8587 67797.0838  18.3%   975  525s
  3687  3113 65274.4512   23  394 57308.8587 67797.0838  18.3%   985  531s
  3797  3135 59599.0945   22  337 57308.8587 67797.0838  18.3%   993  537s
  3906  3119 65003.9096   24  393 57308.8587 67378.9779  17.6%   991  545s
  3945  3124 64348.5411   24  285 57308.8587 67378.9779  17.6%   995  550s
  3997  3130 64802.6354   25  386 57308.8587 67378.9779  17.6%   998  555s
  4049  3139 64286.9868   24  272 57308.8587 67378.9779  17.6%  1001  560s
  4110  3148 63408.7218   25  371 57308.8587 67262.1728  17.4%  1006  565s
  4179  3152 63895.2049   25  242 57308.8587 66730.9089  16.4%  1012  571s
  4260  3140 62549.0699   26  282 57308.8587 66445.5074  15.9%  1013  578s
  4333  3134 61565.1955   27  236 57308.8587 66445.5074  15.9%  1021  584s
  4399  3135 59347.2855   25  256 57308.8587 66445.5074  15.9%  1032  590s
  4477  3134     cutoff   27      57308.8587 65699.0336  14.6%  1037  596s
  4557  3114 58633.2583   29  173 57308.8587 65699.0336  14.6%  1041  601s
  4613  3124 infeasible   30      57308.8587 65699.0336  14.6%  1047  605s
  4685  3123     cutoff   31      57308.8587 65699.0336  14.6%  1051  612s
  4768  3111 61979.7855   27  250 57308.8587 64929.7080  13.3%  1055  618s
  4858  3095 60775.6566   28  295 57308.8587 64816.9605  13.1%  1062  625s
  4976  3077     cutoff   29      57308.8587 64703.6112  12.9%  1063  630s
  5101  3050 58918.8295   30  184 57308.8587 64552.6744  12.6%  1063  637s
  5220  3026     cutoff   34      57308.8587 64514.3286  12.6%  1067  642s
  5345  3007 61449.3628   24  318 57308.8587 64427.9009  12.4%  1069  648s
  5460  2976 60083.6800   25  233 57308.8587 64171.6086  12.0%  1073  655s
  5589  2940     cutoff   29      57308.8587 64006.0441  11.7%  1081  662s
  5716  2895     cutoff   29      57308.8587 63758.0011  11.3%  1087  670s
  5800  2880     cutoff   30      57308.8587 63758.0011  11.3%  1093  677s
  5917  2862 58438.7568   25  222 57308.8587 63547.0587  10.9%  1099  685s
  6064  2805 58889.0937   26  188 57308.8587 63394.4429  10.6%  1102  694s
  6225  2753 58136.1270   27  163 57308.8587 63266.1464  10.4%  1107  703s
  6384  2704 61086.8132   26  247 57308.8587 63258.2708  10.4%  1113  711s
  6553  2648     cutoff   29      57308.8587 62791.1066  9.57%  1116  719s
  6718  2608 59403.5970   27  247 57308.8587 62596.4665  9.23%  1116  727s
  6924  2541 58358.0206   29  205 57308.8587 62596.4665  9.23%  1117  736s
  7091  2490 58912.1267   24  294 57308.8587 62332.9083  8.77%  1114  746s
  7325  2397     cutoff   26      57308.8587 62053.2079  8.28%  1117  756s
  7569  2296 58251.8260   29  198 57308.8587 62009.7136  8.20%  1121  765s
  7826  2191     cutoff   30      57308.8587 61530.5731  7.37%  1122  774s
  8118  2057     cutoff   27      57308.8587 61530.5731  7.37%  1115  783s
  8376  1920 59095.5176   27  237 57308.8587 60976.9792  6.40%  1111  792s
  8756  1688 57821.9112   27  186 57308.8587 60733.9728  5.98%  1100  802s
  9141  1439     cutoff   29      57308.8587 60167.7422  4.99%  1093  813s
  9733  1141     cutoff   29      57308.8587 59877.9421  4.48%  1060  820s
 10794   952 57430.7935   70   44 57308.8587 58408.2654  1.92%   981  828s
 11899   659 57389.9317   75   18 57308.8587 57823.6030  0.90%   898  832s
 15384    20 57333.5262   71   24 57308.8587 57499.6145  0.33%   707  836s
*15782    20              73    57339.096935 57499.6145  0.28%   690  836s
 16622     3 57343.4633   72   27 57339.0969 57361.6619  0.04%   656  840s
 16645     0     cutoff   74      57339.0969 57343.1423  0.01%   656  846s

Cutting planes:
  Gomory: 3
  MIR: 364
  Mixing: 1
  Flow cover: 1242
  RLT: 21
  Relax-and-lift: 128

Explored 16648 nodes (11002976 simplex iterations) in 846.78 seconds (1514.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 57339.1 57308.9 57266.5 ... 56695.2

Optimal solution found (tolerance 1.00e-06)
Best objective 5.733909693542e+04, best bound 5.733909693542e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 846.79s
  Master Objective (UB) = 57339.10, θ = 207261.45
  Upper Bound (UB) = 57339.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 207261.45
  [DEBUG]   ✓ Scenario 0: θ = 207261.45 ≤ Q = 207261.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 207261.45 ≤ Q = 207261.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 207261.45 ≤ Q = 207261.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 207261.45 ≤ Q = 207261.45 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x17fac29e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe8053d62
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.511367e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7338085.2789
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.734787e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173478.68    0  127 7338085.28 -173478.68   102%     -    0s
H    0     0                    -137006.1084 -173478.68  26.6%     -    0s
H    0     0                    -137244.3650 -173478.68  26.4%     -    0s
H    0     0                    -145216.3163 -173478.68  19.5%     -    0s
H    0     0                    -145324.5491 -159506.33  9.76%     -    0s
H    0     0                    -154220.0160 -159506.33  3.43%     -    0s
     0     0 -159506.33    0  106 -154220.02 -159506.33  3.43%     -    0s
H    0     0                    -155052.9962 -159123.26  2.63%     -    0s
H    0     0                    -156215.4411 -159123.26  1.86%     -    0s
H    0     0                    -157050.1110 -159123.26  1.32%     -    0s
     0     0 -159123.26    0   98 -157050.11 -159123.26  1.32%     -    0s
     0     0 -159123.26    0   98 -157050.11 -159123.26  1.32%     -    0s
     0     0 -159123.26    0   99 -157050.11 -159123.26  1.32%     -    0s
     0     0 -158380.76    0   59 -157050.11 -158380.76  0.85%     -    0s
H    0     0                    -157075.1849 -158293.36  0.78%     -    0s
     0     0 -158293.36    0   69 -157075.18 -158293.36  0.78%     -    0s
     0     0 -158193.56    0   62 -157075.18 -158193.56  0.71%     -    0s
     0     0 -157974.75    0   44 -157075.18 -157974.75  0.57%     -    0s
     0     0 -157901.14    0   44 -157075.18 -157901.14  0.53%     -    0s
     0     0 -157765.04    0   32 -157075.18 -157765.04  0.44%     -    0s
H    0     0                    -157080.7447 -157757.73  0.43%     -    0s
     0     0 -157733.86    0   33 -157080.74 -157733.86  0.42%     -    0s
     0     0 -157550.95    0   30 -157080.74 -157550.95  0.30%     -    0s
     0     0 -157512.15    0   30 -157080.74 -157512.15  0.27%     -    0s
     0     0 -157451.45    0   27 -157080.74 -157451.45  0.24%     -    0s
     0     0 -157431.67    0   27 -157080.74 -157431.67  0.22%     -    0s
     0     0 -157431.67    0   64 -157080.74 -157431.67  0.22%     -    0s
     0     0 -157431.67    0   64 -157080.74 -157431.67  0.22%     -    0s
     0     0 -157431.67    0   34 -157080.74 -157431.67  0.22%     -    0s
     0     0 -157334.98    0   27 -157080.74 -157334.98  0.16%     -    0s
     0     0 -157329.76    0   25 -157080.74 -157329.76  0.16%     -    0s
     0     0 -157288.40    0   24 -157080.74 -157288.40  0.13%     -    0s
     0     0 -157288.35    0   18 -157080.74 -157288.35  0.13%     -    0s
     0     0 -157149.33    0    9 -157080.74 -157149.33  0.04%     -    0s
     0     0 -157110.05    0    4 -157080.74 -157110.05  0.02%     -    0s
     0     0 -157081.40    0    4 -157080.74 -157081.40  0.00%     -    0s
     0     0     cutoff    0      -157080.74 -157080.74  0.00%     -    0s

Cutting planes:
  Gomory: 22
  Implied bound: 16
  MIR: 37
  Flow cover: 7
  RLT: 23
  BQP: 1

Explored 1 nodes (1145 simplex iterations) in 0.18 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -157081 -157075 -157050 ... 1.51137e+13
No other solutions better than -157081

Optimal solution found (tolerance 1.00e-06)
Best objective -1.570807447467e+05, best bound -1.570807447467e+05, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 187738.87
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -157080.74
  [DEBUG]   S×d_nominal = 344819.61
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 344819.61 + -157080.74 = 187738.87
  [DEBUG]   Current θ from Master = 207261.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19522.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 37816.51
  Lower Bound (LB) = 45543.29
  Gap (UB-LB) = 11795.8028, Absolute Gap = 11795.8028, Relative Gap = 0.205720
  Not converged yet (gap = 11795.80 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0xacb2ce4d
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35470 rows and 14410 columns
Presolve time: 1.27s
Presolved: 42363 rows, 19050 columns, 262709 nonzeros
Variable types: 16791 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42363 rows, 19050 columns, 262709 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26340    7.6295586e+03   0.000000e+00   6.041766e+08      5s
   39516    6.3213971e+04   0.000000e+00   6.366207e+09     10s
   50989    7.4841457e+04   0.000000e+00   1.332459e+06     15s
Concurrent spin time: 0.93s

Solved with dual simplex

Root relaxation: objective 8.234415e+04, 35272 iterations, 18.53 seconds (25.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82344.1547    0  147 -227427.98 82344.1547   136%     -   20s
H    0     0                    -218732.5940 82344.1547   138%     -   20s
H    0     0                    -69402.34420 82344.1547   219%     -   20s
H    0     0                    -67734.95403 82344.1547   222%     -   20s
H    0     0                    -26434.65086 82344.1547   412%     -   20s
H    0     0                    -26249.46802 82344.1547   414%     -   20s
H    0     0                    16550.544257 82344.1547   398%     -   20s
H    0     0                    23435.332434 82344.1547   251%     -   21s
H    0     0                    30009.129537 82344.1547   174%     -   21s
H    0     0                    30682.217212 82344.1547   168%     -   21s
H    0     0                    30997.850126 82344.1547   166%     -   21s
H    0     0                    31687.662989 76693.0360   142%     -   29s
H    0     0                    31795.436476 76693.0360   141%     -   29s
H    0     0                    32361.741258 76693.0360   137%     -   29s
H    0     0                    33143.254060 76693.0360   131%     -   29s
H    0     0                    33570.107946 76693.0360   128%     -   29s
     0     0 76536.4232    0  238 33570.1079 76536.4232   128%     -   29s
H    0     0                    39360.371839 76536.4232  94.5%     -   29s
H    0     0                    39945.971282 76536.4232  91.6%     -   29s
H    0     0                    43300.134889 76536.4232  76.8%     -   29s
H    0     0                    43441.548739 76536.4232  76.2%     -   29s
     0     0 76510.1071    0  235 43441.5487 76510.1071  76.1%     -   31s
     0     0 76510.1071    0  237 43441.5487 76510.1071  76.1%     -   31s
     0     0 76510.1071    0  241 43441.5487 76510.1071  76.1%     -   31s
     0     0 76510.1071    0  241 43441.5487 76510.1071  76.1%     -   31s
     0     0 73462.8591    0  239 43441.5487 73462.8591  69.1%     -   38s
H    0     0                    53842.351139 73462.6419  36.4%     -   38s
H    0     0                    54579.875971 73462.6419  34.6%     -   39s
H    0     0                    54925.325530 73462.6419  33.8%     -   39s
H    0     0                    55253.317807 73462.6419  33.0%     -   39s
H    0     0                    55320.936843 73462.6419  32.8%     -   39s
H    0     0                    55448.905109 73462.6419  32.5%     -   39s
H    0     0                    55459.462090 73462.6419  32.5%     -   39s
H    0     0                    55468.087849 73462.6419  32.4%     -   39s
H    0     0                    55493.797409 73462.6419  32.4%     -   39s
     0     0 73123.7053    0  302 55493.7974 73123.7053  31.8%     -   42s
     0     0 73043.1137    0  316 55493.7974 73043.1137  31.6%     -   43s
     0     0 73006.8826    0  316 55493.7974 73006.8826  31.6%     -   44s
     0     0 72977.0709    0  321 55493.7974 72977.0709  31.5%     -   44s
     0     0 72963.4569    0  284 55493.7974 72963.4569  31.5%     -   45s
     0     0 72959.0427    0  320 55493.7974 72959.0427  31.5%     -   45s
     0     0 72958.2562    0  322 55493.7974 72958.2562  31.5%     -   45s
     0     0 71449.7385    0  305 55493.7974 71449.7385  28.8%     -   53s
H    0     0                    55526.117912 71449.3013  28.7%     -   54s
H    0     0                    55557.794684 71449.3013  28.6%     -   54s
     0     0 71085.2326    0  315 55557.7947 71085.2326  27.9%     -   56s
     0     0 70836.9099    0  318 55557.7947 70836.9099  27.5%     -   58s
H    0     0                    55716.581354 70748.3160  27.0%     -   58s
H    0     0                    55730.959876 70748.3160  26.9%     -   58s
H    0     0                    55863.484820 70748.3160  26.6%     -   58s
     0     0 70748.3160    0  330 55863.4848 70748.3160  26.6%     -   58s
     0     0 70693.3062    0  331 55863.4848 70693.3062  26.5%     -   59s
     0     0 70672.1443    0  380 55863.4848 70672.1443  26.5%     -   60s
     0     0 70653.4563    0  327 55863.4848 70653.4563  26.5%     -   61s
     0     0 70637.7208    0  382 55863.4848 70637.7208  26.4%     -   61s
     0     0 70634.4657    0  388 55863.4848 70634.4657  26.4%     -   62s
     0     0 70632.4926    0  377 55863.4848 70632.4926  26.4%     -   62s
     0     0 70631.3933    0  340 55863.4848 70631.3933  26.4%     -   62s
H    0     0                    55900.663461 69971.7997  25.2%     -   72s
     0     0 69971.7997    0  413 55900.6635 69971.7997  25.2%     -   73s
H    0     0                    56017.213636 69804.1951  24.6%     -   75s
H    0     0                    56027.190707 69804.1951  24.6%     -   75s
H    0     0                    56063.946666 69804.1951  24.5%     -   75s
H    0     0                    56215.702606 69804.1951  24.2%     -   75s
H    0     0                    56240.105438 69804.1951  24.1%     -   75s
     0     0 69804.1951    0  420 56240.1054 69804.1951  24.1%     -   75s
     0     0 69666.9459    0  444 56240.1054 69666.9459  23.9%     -   77s
     0     0 69624.2375    0  440 56240.1054 69624.2375  23.8%     -   78s
     0     0 69600.9157    0  438 56240.1054 69600.9157  23.8%     -   79s
H    0     0                    56360.383988 69589.1334  23.5%     -   79s
     0     0 69589.1334    0  449 56360.3840 69589.1334  23.5%     -   79s
     0     0 69581.3266    0  454 56360.3840 69581.3266  23.5%     -   80s
     0     0 69574.9207    0  459 56360.3840 69574.9207  23.4%     -   80s
     0     0 69572.1532    0  455 56360.3840 69572.1532  23.4%     -   81s
     0     0 69567.4656    0  446 56360.3840 69567.4656  23.4%     -   81s
     0     0 69565.4683    0  448 56360.3840 69565.4683  23.4%     -   81s
     0     0 69564.1887    0  451 56360.3840 69564.1887  23.4%     -   81s
     0     0 69477.5751    0  436 56360.3840 69477.5751  23.3%     -   83s
H    0     0                    56399.734070 69477.5303  23.2%     -   84s
H    0     0                    56417.492173 69477.5303  23.1%     -   84s
     0     0 69457.5617    0  454 56417.4922 69457.5617  23.1%     -   85s
     0     0 69444.1874    0  448 56417.4922 69444.1874  23.1%     -   85s
     0     0 69439.0336    0  450 56417.4922 69439.0336  23.1%     -   86s
     0     0 69436.7609    0  453 56417.4922 69436.7609  23.1%     -   86s
     0     0 69435.9597    0  452 56417.4922 69435.9597  23.1%     -   86s
     0     0 69381.4426    0  463 56417.4922 69381.4426  23.0%     -   88s
H    0     0                    56472.205163 69380.7316  22.9%     -   90s
     0     0 69367.5903    0  464 56472.2052 69367.5903  22.8%     -   91s
     0     0 69359.6995    0  462 56472.2052 69359.6995  22.8%     -   91s
     0     0 69354.9457    0  461 56472.2052 69354.9457  22.8%     -   91s
     0     0 69351.8755    0  454 56472.2052 69351.8755  22.8%     -   92s
     0     0 69351.1467    0  458 56472.2052 69351.1467  22.8%     -   92s
     0     0 69269.1274    0  455 56472.2052 69269.1274  22.7%     -   95s
     0     0 69232.0399    0  460 56472.2052 69232.0399  22.6%     -   97s
     0     0 69223.2902    0  461 56472.2052 69223.2902  22.6%     -   98s
     0     0 69196.7789    0  441 56472.2052 69196.7789  22.5%     -   99s
     0     0 69171.7612    0  464 56472.2052 69171.7612  22.5%     -  100s
     0     0 69168.1468    0  458 56472.2052 69168.1468  22.5%     -  101s
     0     0 69165.6600    0  471 56472.2052 69165.6600  22.5%     -  101s
     0     0 69164.1301    0  472 56472.2052 69164.1301  22.5%     -  101s
     0     0 69073.3743    0  448 56472.2052 69073.3743  22.3%     -  104s
H    0     0                    56571.480695 69073.3384  22.1%     -  105s
H    0     0                    56697.711108 69073.3384  21.8%     -  105s
H    0     0                    56863.619501 69073.3384  21.5%     -  105s
     0     0 69045.6026    0  456 56863.6195 69045.6026  21.4%     -  107s
     0     0 69040.2223    0  459 56863.6195 69040.2223  21.4%     -  108s
     0     0 69037.0676    0  460 56863.6195 69037.0676  21.4%     -  108s
     0     0 69033.9590    0  461 56863.6195 69033.9590  21.4%     -  109s
     0     0 69032.7656    0  462 56863.6195 69032.7656  21.4%     -  109s
     0     0 69011.1865    0  482 56863.6195 69011.1865  21.4%     -  111s
     0     0 69001.8469    0  477 56863.6195 69001.8469  21.3%     -  112s
     0     0 68998.2051    0  477 56863.6195 68998.2051  21.3%     -  113s
     0     0 68996.4206    0  477 56863.6195 68996.4206  21.3%     -  113s
     0     0 68995.5902    0  475 56863.6195 68995.5902  21.3%     -  114s
     0     0 68973.6799    0  421 56863.6195 68973.6799  21.3%     -  116s
     0     0 68960.9640    0  431 56863.6195 68960.9640  21.3%     -  119s
     0     0 68956.6910    0  471 56863.6195 68956.6910  21.3%     -  119s
     0     0 68955.3056    0  470 56863.6195 68955.3056  21.3%     -  120s
     0     0 68942.2407    0  509 56863.6195 68942.2407  21.2%     -  121s
     0     0 68936.1646    0  508 56863.6195 68936.1646  21.2%     -  122s
     0     0 68934.9013    0  507 56863.6195 68934.9013  21.2%     -  123s
     0     0 68931.1453    0  477 56863.6195 68931.1453  21.2%     -  124s
     0     0 68930.6413    0  483 56863.6195 68930.6413  21.2%     -  124s
     0     0 68926.4558    0  507 56863.6195 68926.4558  21.2%     -  126s
     0     0 68925.0948    0  511 56863.6195 68925.0948  21.2%     -  126s
     0     0 68923.7232    0  427 56863.6195 68923.7232  21.2%     -  128s
     0     0 68923.3118    0  477 56863.6195 68923.3118  21.2%     -  128s
     0     0 68922.1915    0  468 56863.6195 68922.1915  21.2%     -  129s
     0     0 68921.7097    0  468 56863.6195 68921.7097  21.2%     -  130s
     0     2 68921.6846    0  468 56863.6195 68921.6846  21.2%     -  149s
     1     4 68884.7759    1  465 56863.6195 68921.5327  21.2%   857  151s
     3     8 68842.5344    2  460 56863.6195 68883.9016  21.1%  1226  157s
     7    16 68672.5923    3  446 56863.6195 68842.4281  21.1%  2399  163s
    15    32 68626.9897    4  486 56863.6195 68672.2712  20.8%  2830  172s
    31    64 68299.0301    5  505 56863.6195 68624.8677  20.7%  5242  179s
H   40    64                    56963.807809 68624.8677  20.5%  4565  179s
    63    96 68028.9580    6  496 56963.8078 68296.3590  19.9%  3938  186s
    95   201 67835.9486    7  418 56963.8078 68296.3590  19.9%  3211  193s
   200   289 67585.0575    9  444 56963.8078 68296.3590  19.9%  2186  200s
   288   372 67194.0234    9  471 56963.8078 68296.3590  19.9%  1896  207s
   371   447 67441.8968   10  446 56963.8078 68296.3590  19.9%  1731  215s
   446   479 67207.1146   11  395 56963.8078 68296.3590  19.9%  1670  220s
   478   517 66443.0362   11  401 56963.8078 68296.3590  19.9%  1680  227s
   516   555 66594.8083   12  399 56963.8078 68296.3590  19.9%  1752  232s
   554   594 65287.3178   12  412 56963.8078 68296.3590  19.9%  1737  238s
   595   643 66308.1303   13  396 56963.8078 68296.3590  19.9%  1722  243s
   644   694 66526.0637   13  431 56963.8078 68296.3590  19.9%  1672  247s
H  692   694                    57052.080464 68296.3590  19.7%  1631  247s
   695   785 66446.6955   14  433 57052.0805 68296.3590  19.7%  1628  255s
   788   889 66163.5195   16  430 57052.0805 68296.3590  19.7%  1541  261s
   894  1006 65373.9780   16  420 57052.0805 68296.3590  19.7%  1434  270s
  1015  1112 66110.5555   17  419 57052.0805 68296.3590  19.7%  1324  278s
  1133  1223 66031.3334   18  420 57052.0805 68296.3590  19.7%  1251  285s
  1254  1306 66002.0296   19  418 57052.0805 68288.3844  19.7%  1200  291s
  1371  1373 65725.4059   21  413 57052.0805 68288.3844  19.7%  1168  299s
  1464  1419 65131.3052   24  408 57052.0805 68057.5783  19.3%  1174  303s
H 1466  1419                    57072.574970 68057.5783  19.2%  1173  303s
H 1469  1419                    57073.132829 68057.5783  19.2%  1177  303s
H 1470  1419                    57118.110045 68057.5783  19.2%  1177  303s
  1522  1481 62106.4225   25  309 57118.1100 68057.5783  19.2%  1179  311s
  1598  1547 65115.3666   25  405 57118.1100 67872.8420  18.8%  1195  320s
  1676  1627 64845.8868   26  417 57118.1100 67872.8420  18.8%  1204  330s
  1764  1714 64711.9744   27  396 57118.1100 67872.8420  18.8%  1204  339s
  1867  1853 64414.7551   28  372 57118.1100 67872.8420  18.8%  1202  345s
  2018  2013 64217.7802   29  372 57118.1100 67872.8420  18.8%  1164  351s
  2190  2042 63976.4956   31  377 57118.1100 67835.2606  18.8%  1122  355s
  2225  2069 63949.0127   32  373 57118.1100 67835.2606  18.8%  1117  360s
  2262  2094 63856.7996   33  382 57118.1100 67835.2606  18.8%  1115  370s
H 2281  2094                    57131.872028 67835.2606  18.7%  1119  370s
  2305  2170 63683.2098   33  362 57131.8720 67835.2606  18.7%  1115  379s
  2453  2257 63692.4837   34  398 57131.8720 67758.7938  18.6%  1108  388s
  2580  2288 63045.3803   36  389 57131.8720 67718.2235  18.5%  1117  394s
  2613  2320 62466.0425   36  374 57131.8720 67718.2235  18.5%  1130  400s
  2656  2352 62941.2835   37  382 57131.8720 67718.2235  18.5%  1132  405s
H 2679  2352                    57164.584434 67718.2235  18.5%  1135  405s
  2696  2485 62931.4244   38  344 57164.5844 67718.2235  18.5%  1138  416s
  2879  2637 62489.5675   40  357 57164.5844 67458.5001  18.0%  1127  425s
  3079  2789 62078.8538   46  300 57164.5844 67458.5001  18.0%  1108  436s
  3295  2977 61886.7215   49  346 57164.5844 67458.5001  18.0%  1089  447s
  3575  2978 59154.9109   44  468 57164.5844 67160.4378  17.5%  1058  547s
  3577  2979 59452.6208   29  147 57164.5844 67160.4378  17.5%  1057  566s
  3578  2980 62113.8697   25  316 57164.5844 67160.4378  17.5%  1057  579s
  3579  2981 61234.8752   32  355 57164.5844 67160.4378  17.5%  1056  585s
  3580  2981 60951.0265   39  409 57164.5844 67160.4378  17.5%  1056  590s
  3581  2982 62714.6019   26  419 57164.5844 67160.4378  17.5%  1056  595s
  3582  2983 64636.2756   24  429 57164.5844 67160.4378  17.5%  1056  600s
  3584  2984 58513.9150   41  409 57164.5844 67160.4378  17.5%  1055  605s
  3587  2986 60528.5952   50  449 57164.5844 67160.4378  17.5%  1054  611s
  3589  2987 58603.9435   25  458 57164.5844 67160.4378  17.5%  1053  615s
  3593  2990 61354.7173   17  460 57164.5844 67160.4378  17.5%  1052  624s
  3594  2991 64568.1847   15  506 57164.5844 67160.4378  17.5%  1052  626s
  3597  2993 58115.4393   43  457 57164.5844 67160.4378  17.5%  1051  632s
  3599  2994 62473.1421   41  496 57164.5844 67160.4378  17.5%  1051  635s
  3600  2995 61755.8811   50  500 57164.5844 67160.4378  17.5%  1050  640s
  3603  2997 64660.7086    9  508 57164.5844 67160.4378  17.5%  1049  646s
  3605  2998 62947.5173   20  502 57164.5844 67160.4378  17.5%  1049  652s
  3608  3000 61661.0445   17  463 57164.5844 67160.4378  17.5%  1048  657s
  3610  3001 66307.9025   14  474 57164.5844 67160.4378  17.5%  1047  662s
  3612  3003 60859.6295   44  457 57164.5844 67160.4378  17.5%  1047  666s
  3615  3005 66525.9988   11  470 57164.5844 67160.4378  17.5%  1046  672s
  3616  3005 59811.0609   33  470 57164.5844 67160.4378  17.5%  1046  692s
  3617  3006 66400.1577   13  470 57164.5844 67160.4378  17.5%  1045  710s
  3618  3010 67160.4378   12  443 57164.5844 67160.4378  17.5%  1074  719s
  3620  3013 67160.4378   13  453 57164.5844 67160.4378  17.5%  1075  729s
  3624  3020 67160.4378   14  465 57164.5844 67160.4378  17.5%  1077  742s
  3632  3033 67160.4378   15  458 57164.5844 67160.4378  17.5%  1083  753s
  3648  3060 67160.4378   16  455 57164.5844 67160.4378  17.5%  1115  767s
  3680  3056 65444.9349   17  431 57164.5844 67160.4378  17.5%  1137  785s
  3687  3086 63719.1127   18  419 57164.5844 67160.4378  17.5%  1149  805s
  3719  3108 63483.0222   19  408 57164.5844 67077.4928  17.3%  1182  818s
  3754  3133 62466.2685   19  354 57164.5844 67077.4928  17.3%  1236  831s
  3793  3193 62693.3355   20  401 57164.5844 67077.4928  17.3%  1256  844s
  3868  3242 62256.0493   20  369 57164.5844 67077.4928  17.3%  1270  856s
  3954  3289 61568.6507   20  267 57164.5844 67077.4928  17.3%  1283  865s
  4045  3339 61222.6603   20  354 57164.5844 67077.4928  17.3%  1290  874s
  4147  3365 62365.5854   21  413 57164.5844 67077.4928  17.3%  1289  883s
  4247  3367 61885.6119   23  373 57164.5844 67077.4928  17.3%  1285  894s
  4343  3355 61455.0913   24  369 57164.5844 66426.5804  16.2%  1284  903s
  4414  3354 61714.2749   23  348 57164.5844 66426.5804  16.2%  1290  914s
  4475  3355 61261.1692   24  349 57164.5844 65770.7765  15.1%  1298  926s
  4530  3363 60947.9644   25  332 57164.5844 65735.1446  15.0%  1308  935s
  4599  3365 58949.1321   26  300 57164.5844 65625.2845  14.8%  1320  944s
  4657  3365     cutoff   27      57164.5844 65503.3209  14.6%  1335  954s
  4699  3375     cutoff   28      57164.5844 65426.2813  14.5%  1345  961s
  4737  3380 63010.7620   19  307 57164.5844 65426.2813  14.5%  1354  971s
  4786  3384 62863.6130   20  311 57164.5844 65426.2807  14.5%  1364  981s
  4857  3397 61381.0605   23  285 57164.5844 65366.1949  14.3%  1372  990s
  4928  3399 59139.3326   24  339 57164.5844 65366.1949  14.3%  1383 1001s
  5023  3405 57869.5627   25  268 57164.5844 65312.5372  14.3%  1393 1012s
  5124  3430     cutoff   27      57164.5844 65173.7011  14.0%  1401 1022s
  5241  3415 59238.2794   20  378 57164.5844 65173.7011  14.0%  1406 1035s
  5311  3430 57877.9830   21  349 57164.5844 65152.5562  14.0%  1411 1047s
  5419  3464     cutoff   22      57164.5844 65152.5562  14.0%  1417 1058s
  5550  3467 57411.2864   24  217 57164.5844 65152.5562  14.0%  1420 1071s
  5704  3470     cutoff   25      57164.5844 65134.0919  13.9%  1423 1084s
  5882  3465 62697.7109   20  351 57164.5844 65033.2425  13.8%  1419 1099s
  6040  3479 60077.7405   24  219 57164.5844 64969.6816  13.7%  1424 1111s
  6197  3474     cutoff   29      57164.5844 64969.6816  13.7%  1428 1124s
  6337  3480     cutoff   25      57164.5844 64455.4435  12.8%  1423 1139s
  6504  3523 61782.8534   21  369 57164.5844 64425.9894  12.7%  1427 1153s
  6686  3507 59881.5648   24  355 57164.5844 64421.2949  12.7%  1428 1169s
  6880  3510     cutoff   26      57164.5844 64193.9864  12.3%  1433 1186s
  7079  3523 57515.0921   26  244 57164.5844 64123.5602  12.2%  1435 1202s
  7334  3486 62174.9461   20  407 57164.5844 63996.0425  12.0%  1431 1218s
  7508  3512 62058.2273   22  389 57164.5844 63689.5415  11.4%  1433 1237s
  7733  3481     cutoff   30      57164.5844 63689.5415  11.4%  1437 1259s
  8005  3418 61290.5743   24  394 57164.5844 63689.5415  11.4%  1440 1279s
  8224  3398 58135.1854   28  317 57164.5844 63494.4231  11.1%  1453 1301s
  8490  3359 61494.2337   22  415 57164.5844 63253.9774  10.7%  1459 1323s
  8709  3351 58301.5145   25  281 57164.5844 63092.4959  10.4%  1462 1344s
  8966  3307     cutoff   23      57164.5844 62994.1736  10.2%  1472 1365s
  9228  3263 60874.8676   23  366 57164.5844 62912.1062  10.1%  1483 1390s
  9520  3174 59203.5399   29  297 57164.5844 62739.2370  9.75%  1489 1418s
  9847  3104     cutoff   33      57164.5844 62681.1968  9.65%  1493 1441s
 10119  2994 60625.8726   23  371 57164.5844 62663.9666  9.62%  1495 1468s
 10437  2920 58998.6926   26  305 57164.5844 62463.1583  9.27%  1506 1497s
 10793  2819 60059.0575   25  331 57164.5844 62271.7565  8.93%  1513 1523s
 11233  2675 60780.9145   25  297 57164.5844 62211.0175  8.83%  1512 1552s
 11710  2544 60214.1828   22  304 57164.5844 62099.6921  8.63%  1513 1583s
 12195  2394 57521.4468   26  213 57164.5844 61843.9801  8.19%  1513 1610s
 12752  2206     cutoff   29      57164.5844 61673.5130  7.89%  1505 1642s
 13266  2161     cutoff   20      57164.5844 61481.0240  7.55%  1506 1674s
 13758  2116 57314.9441   25  264 57164.5844 61409.0513  7.42%  1508 1706s
 14303  2025     cutoff   30      57164.5844 61076.3487  6.84%  1504 1740s
 14858  1942 59056.0767   24  377 57164.5844 60909.5936  6.55%  1506 1773s
 15487  1741     cutoff   25      57164.5844 60657.4675  6.11%  1505 1809s
 16239  1445     cutoff   27      57164.5844 60358.4770  5.59%  1494 1844s
 17081  1412     cutoff   26      57164.5844 59949.9262  4.87%  1479 1876s
 17184  1259 58289.2013   24  232 57164.5844 59829.9942  4.66%  1479 1909s
 17577   694 58128.9617   28  154 57164.5844 59699.0785  4.43%  1468 1943s
 18742   267 57907.7690   29  131 57164.5844 59323.7063  3.78%  1418 1973s
 20505   342 infeasible   29      57164.5844 58968.8551  3.16%  1317 1990s

Cutting planes:
  Learned: 5
  Gomory: 4
  MIR: 465
  Mixing: 1
  Flow cover: 1458
  RLT: 12
  Relax-and-lift: 119

Explored 24162 nodes (27326607 simplex iterations) in 1993.75 seconds (3793.23 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 57164.6 57131.9 57118.1 ... 56472.2

Optimal solution found (tolerance 1.00e-06)
Best objective 5.716458443398e+04, best bound 5.716458443398e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1993.76s
  Master Objective (UB) = 57164.58, θ = 208093.93
  Upper Bound (UB) = 57164.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 208093.93
  [DEBUG]   ✓ Scenario 0: θ = 208093.93 ≤ Q = 208093.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 208093.93 ≤ Q = 208093.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 208093.93 ≤ Q = 208093.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 208093.93 ≤ Q = 208093.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 208093.93 ≤ Q = 208093.93 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x55e348c6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaa1cb73a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.511856e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7353612.6472
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.729031e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -172903.14    0  128 7353612.65 -172903.14   102%     -    0s
H    0     0                    -135832.3427 -172903.14  27.3%     -    0s
H    0     0                    -136095.5953 -172903.14  27.0%     -    0s
H    0     0                    -142207.3232 -172903.14  21.6%     -    0s
H    0     0                    -144452.9933 -154682.55  7.08%     -    0s
H    0     0                    -149208.7024 -154682.55  3.67%     -    0s
     0     0 -154682.55    0   99 -149208.70 -154682.55  3.67%     -    0s
H    0     0                    -152304.4715 -154582.86  1.50%     -    0s
     0     0 -154467.82    0   88 -152304.47 -154467.82  1.42%     -    0s
     0     0 -154465.04    0   88 -152304.47 -154465.04  1.42%     -    0s
     0     0 -153802.67    0   91 -152304.47 -153802.67  0.98%     -    0s
     0     0 -153747.58    0   77 -152304.47 -153747.58  0.95%     -    0s
H    0     0                    -152322.6536 -153447.87  0.74%     -    0s
     0     0 -153447.87    0   76 -152322.65 -153447.87  0.74%     -    0s
     0     0 -153445.83    0   77 -152322.65 -153445.83  0.74%     -    0s
     0     0 -153403.67    0   84 -152322.65 -153403.67  0.71%     -    0s
     0     0 -153397.99    0   84 -152322.65 -153397.99  0.71%     -    0s
     0     2 -153397.99    0   84 -152322.65 -153397.99  0.71%     -    0s
H   90    63                    -152344.9808 -152925.35  0.38%  14.6    0s
*  526    56              26    -152357.2537 -152734.29  0.25%   7.6    0s
*  650    16              27    -152358.4924 -152647.73  0.19%   7.6    0s
*  656    16              29    -152360.1791 -152647.73  0.19%   7.6    0s
*  753    24              28    -152370.3596 -152595.35  0.15%   7.6    0s

Cutting planes:
  Gomory: 56
  Implied bound: 4
  MIR: 157
  Flow cover: 12
  RLT: 44
  BQP: 1

Explored 856 nodes (6959 simplex iterations) in 0.29 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -152370 -152360 -152358 ... -142207
No other solutions better than -152370

Optimal solution found (tolerance 1.00e-06)
Best objective -1.523703596190e+05, best bound -1.523703596190e+05, gap 0.0000%
  Subproblem solved in 0.32s
  Worst-case operational profit (Z_SP) = 193200.22
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -152370.36
  [DEBUG]   S×d_nominal = 345570.58
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 345570.58 + -152370.36 = 193200.22
  [DEBUG]   Current θ from Master = 208093.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14893.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 42270.88
  Lower Bound (LB) = 45543.29
  Gap (UB-LB) = 11621.2903, Absolute Gap = 11621.2903, Relative Gap = 0.203295
  Not converged yet (gap = 11621.29 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0xe908ea4d
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42580 rows and 17300 columns
Presolve time: 1.37s
Presolved: 50543 rows, 22400 columns, 314099 nonzeros
Variable types: 20141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50543 rows, 22400 columns, 314099 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24279   -1.1558940e+04   0.000000e+00   3.602751e+08      5s
   36630    6.4070868e+04   0.000000e+00   1.847212e+06     10s
   46973    7.2672351e+04   0.000000e+00   2.879884e+06     15s
   56905    7.9465323e+04   0.000000e+00   2.736468e+06     20s
   67305    8.1449362e+04   0.000000e+00   8.319934e+04     25s
   75533    8.1593997e+04   0.000000e+00   2.178706e+08     30s
   80453    8.1692886e+04   0.000000e+00   0.000000e+00     33s
Concurrent spin time: 10.59s (can be avoided by choosing Method=3)

Solved with primal simplex

Root relaxation: objective 8.169289e+04, 80453 iterations, 41.06 seconds (47.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81692.8859    0  148 -227427.98 81692.8859   136%     -   43s
H    0     0                    -219980.2901 81692.8859   137%     -   43s
H    0     0                    -170798.4761 81692.8859   148%     -   43s
H    0     0                    -170328.9983 81692.8859   148%     -   43s
H    0     0                    -40580.31021 81692.8859   301%     -   43s
H    0     0                    -40416.21585 81692.8859   302%     -   43s
H    0     0                    16383.922459 81692.8859   399%     -   43s
H    0     0                    24485.193169 81692.8859   234%     -   44s
H    0     0                    26685.522935 81692.8859   206%     -   45s
H    0     0                    26926.927286 81692.8859   203%     -   45s
H    0     0                    27215.374683 81692.8859   200%     -   45s
H    0     0                    27337.786826 81692.8859   199%     -   45s
H    0     0                    27562.922379 77150.9564   180%     -   55s
     0     0 77139.0810    0  225 27562.9224 77139.0810   180%     -   55s
H    0     0                    27651.449631 77139.0810   179%     -   56s
     0     0 76693.8877    0  228 27651.4496 76693.8877   177%     -   59s
     0     0 76693.8877    0  225 27651.4496 76693.8877   177%     -   61s
     0     0 76693.8877    0  232 27651.4496 76693.8877   177%     -   62s
     0     0 76693.8877    0  233 27651.4496 76693.8877   177%     -   63s
     0     0 76693.8877    0  233 27651.4496 76693.8877   177%     -   63s
     0     0 73921.3125    0  220 27651.4496 73921.3125   167%     -   75s
H    0     0                    36092.647263 73921.3125   105%     -   75s
H    0     0                    36150.197068 73921.3125   104%     -   75s
H    0     0                    37196.690349 73921.3125  98.7%     -   75s
     0     0 73340.6032    0  236 37196.6903 73340.6032  97.2%     -   81s
H    0     0                    37461.944449 73071.4792  95.1%     -   85s
     0     0 73071.4792    0  241 37461.9444 73071.4792  95.1%     -   85s
     0     0 72789.4284    0  285 37461.9444 72789.4284  94.3%     -   88s
     0     0 72744.2293    0  285 37461.9444 72744.2293  94.2%     -   89s
     0     0 72718.8428    0  284 37461.9444 72718.8428  94.1%     -   90s
     0     0 72684.2091    0  297 37461.9444 72684.2091  94.0%     -   91s
     0     0 72678.9809    0  297 37461.9444 72678.9809  94.0%     -   91s
     0     0 72677.7659    0  296 37461.9444 72677.7659  94.0%     -   92s
     0     0 72660.7194    0  294 37461.9444 72660.7194  94.0%     -   92s
     0     0 72653.0392    0  292 37461.9444 72653.0392  93.9%     -   93s
     0     0 72647.9376    0  296 37461.9444 72647.9376  93.9%     -   93s
     0     0 72647.5062    0  299 37461.9444 72647.5062  93.9%     -   93s
H    0     0                    38227.317703 72647.5062  90.0%     -  100s
H    0     0                    41783.146892 72647.5062  73.9%     -  100s
H    0     0                    41890.779886 72647.5062  73.4%     -  100s
H    0     0                    42085.128635 72647.5062  72.6%     -  100s
H    0     0                    42250.635064 72647.5062  71.9%     -  100s
H    0     0                    42638.165873 72647.5062  70.4%     -  100s
H    0     0                    42923.172227 72647.5062  69.3%     -  100s
H    0     0                    43204.068618 71206.0758  64.8%     -  113s
H    0     0                    43204.514253 71206.0758  64.8%     -  113s
H    0     0                    43672.990374 71206.0758  63.0%     -  113s
H    0     0                    44352.823334 71206.0758  60.5%     -  113s
H    0     0                    44609.172530 71206.0758  59.6%     -  113s
H    0     0                    44706.159498 71206.0758  59.3%     -  113s
H    0     0                    45294.382376 71206.0758  57.2%     -  113s
     0     0 71206.0758    0  319 45294.3824 71206.0758  57.2%     -  113s
H    0     0                    45377.743956 71205.7230  56.9%     -  114s
     0     0 70850.2812    0  351 45377.7440 70850.2812  56.1%     -  120s
     0     0 70707.5213    0  328 45377.7440 70707.5213  55.8%     -  122s
     0     0 70657.0650    0  364 45377.7440 70657.0650  55.7%     -  124s
     0     0 70643.5630    0  368 45377.7440 70643.5630  55.7%     -  125s
     0     0 70635.0652    0  328 45377.7440 70635.0652  55.7%     -  126s
     0     0 70626.3856    0  330 45377.7440 70626.3856  55.6%     -  127s
     0     0 70625.6442    0  330 45377.7440 70625.6442  55.6%     -  127s
     0     0 70203.2910    0  359 45377.7440 70203.2910  54.7%     -  139s
H    0     0                    46996.742455 70203.2188  49.4%     -  140s
H    0     0                    47645.947221 70203.2188  47.3%     -  140s
H    0     0                    47664.026541 70203.2188  47.3%     -  140s
H    0     0                    47783.865888 70203.2188  46.9%     -  140s
H    0     0                    47957.825158 70203.2188  46.4%     -  140s
H    0     0                    47975.226584 70203.2188  46.3%     -  140s
H    0     0                    47987.749923 70069.7281  46.0%     -  145s
H    0     0                    48035.409726 70069.7281  45.9%     -  145s
H    0     0                    48125.447262 70069.7281  45.6%     -  145s
     0     0 70069.7281    0  362 48125.4473 70069.7281  45.6%     -  145s
     0     0 69928.5600    0  398 48125.4473 69928.5600  45.3%     -  149s
     0     0 69875.6079    0  368 48125.4473 69875.6079  45.2%     -  150s
     0     0 69866.6793    0  376 48125.4473 69866.6793  45.2%     -  150s
     0     0 69858.7584    0  369 48125.4473 69858.7584  45.2%     -  151s
     0     0 69854.1550    0  371 48125.4473 69854.1550  45.2%     -  152s
     0     0 69851.5104    0  373 48125.4473 69851.5104  45.1%     -  152s
     0     0 69850.1140    0  373 48125.4473 69850.1140  45.1%     -  153s
     0     0 69849.8576    0  373 48125.4473 69849.8576  45.1%     -  153s
H    0     0                    48500.207710 69668.5076  43.6%     -  158s
     0     0 69668.5076    0  404 48500.2077 69668.5076  43.6%     -  158s
H    0     0                    48634.117809 69636.4016  43.2%     -  160s
H    0     0                    48695.772517 69636.4016  43.0%     -  160s
     0     0 69636.4016    0  401 48695.7725 69636.4016  43.0%     -  160s
     0     0 69621.7378    0  409 48695.7725 69621.7378  43.0%     -  161s
     0     0 69613.1772    0  418 48695.7725 69613.1772  43.0%     -  162s
     0     0 69611.1579    0  414 48695.7725 69611.1579  43.0%     -  162s
     0     0 69610.2868    0  416 48695.7725 69610.2868  42.9%     -  162s
     0     0 69484.8278    0  354 48695.7725 69484.8278  42.7%     -  167s
H    0     0                    48708.659477 69481.7434  42.6%     -  167s
     0     0 69442.3846    0  403 48708.6595 69442.3846  42.6%     -  170s
     0     0 69427.3004    0  362 48708.6595 69427.3004  42.5%     -  172s
     0     0 69420.4414    0  364 48708.6595 69420.4414  42.5%     -  173s
     0     0 69418.6123    0  368 48708.6595 69418.6123  42.5%     -  174s
     0     0 69418.3385    0  367 48708.6595 69418.3385  42.5%     -  174s
     0     0 69386.4340    0  379 48708.6595 69386.4340  42.5%     -  176s
     0     0 69380.7682    0  379 48708.6595 69380.7682  42.4%     -  177s
     0     0 69378.7043    0  385 48708.6595 69378.7043  42.4%     -  178s
     0     0 69377.3964    0  421 48708.6595 69377.3964  42.4%     -  178s
     0     0 69365.0490    0  419 48708.6595 69365.0490  42.4%     -  180s
     0     0 69361.4511    0  420 48708.6595 69361.4511  42.4%     -  180s
     0     0 69360.7954    0  424 48708.6595 69360.7954  42.4%     -  181s
     0     0 69347.4740    0  423 48708.6595 69347.4740  42.4%     -  182s
     0     0 69343.8905    0  380 48708.6595 69343.8905  42.4%     -  183s
     0     0 69342.4118    0  377 48708.6595 69342.4118  42.4%     -  184s
     0     0 69338.0325    0  419 48708.6595 69338.0325  42.4%     -  185s
H    0     0                    48764.776206 69336.9906  42.2%     -  186s
H    0     0                    48805.393432 69336.9906  42.1%     -  186s
     0     0 69336.9906    0  419 48805.3934 69336.9906  42.1%     -  186s
H    0     0                    48871.700289 69336.9906  41.9%     -  187s
     0     0 69333.7790    0  379 48871.7003 69333.7790  41.9%     -  187s
H    0     0                    48993.801896 69333.7377  41.5%     -  188s
H    0     0                    48995.704812 69333.7377  41.5%     -  188s
     0     0 69332.2141    0  424 48995.7048 69332.2141  41.5%     -  188s
     0     0 69330.9131    0  424 48995.7048 69330.9131  41.5%     -  189s
     0     0 69327.6507    0  378 48995.7048 69327.6507  41.5%     -  190s
H    0     0                    49054.610607 69327.2760  41.3%     -  192s
H    0     0                    49096.771692 69327.2760  41.2%     -  193s
     0     0 69326.5117    0  419 49096.7717 69326.5117  41.2%     -  194s
     0     0 69319.9294    0  417 49096.7717 69319.9294  41.2%     -  196s
     0     0 69317.6798    0  417 49096.7717 69317.6798  41.2%     -  197s
H    0     0                    49161.590528 69317.6798  41.0%     -  233s
     0     2 69317.6798    0  417 49161.5905 69317.6798  41.0%     -  234s
     1     4 69267.1164    1  405 49161.5905 69317.6798  41.0%  1241  238s
     3     8 69087.5956    2  405 49161.5905 69264.5303  40.9%  3347  244s
     7    15 68568.5566    3  401 49161.5905 69087.2798  40.5%  4012  253s
    14    30 67056.9624    4  349 49161.5905 69084.2678  40.5%  5274  264s
    29    45 67346.0662    4  371 49161.5905 68691.2979  39.7%  7389  288s
    44    77 66551.6762    6  346 49161.5905 68691.2979  39.7%  6597  310s
H   45    77                    49163.091397 68691.2979  39.7%  6451  310s
H   51    77                    49175.978357 68691.2979  39.7%  6148  310s
H   52    77                    49231.711608 68691.2979  39.5%  6061  310s
H   56    77                    49958.262401 68691.2979  37.5%  5959  310s
    76   225 66286.1850    7  339 49958.2624 68409.3102  36.9%  5327  343s
   224   335 66133.1343   12  317 49958.2624 68409.3102  36.9%  2531  355s
H  286   335                    50098.849880 68409.3102  36.5%  2334  355s
   334   432 65645.9750   15  311 50098.8499 68409.3102  36.5%  2230  363s
H  431   505                    50243.773201 68409.3102  36.2%  2034  373s
   509   585 65044.3034   19  351 50243.7732 68409.3102  36.2%  1974  383s
   589   636 64470.1595   21  337 50243.7732 68409.3102  36.2%  1935  390s
   642   712 64457.0532   22  283 50243.7732 68409.3102  36.2%  1888  398s
   724   791 64356.9343   23  289 50243.7732 68409.3102  36.2%  1804  404s
H  733   791                    50282.208854 68409.3102  36.1%  1797  404s
   813   899 64169.9550   27  260 50282.2089 68348.2660  35.9%  1727  414s
   933  1010 63516.0569   31  203 50282.2089 68347.6509  35.9%  1616  418s
  1061  1047 62520.6101   37  183 50282.2089 68347.6509  35.9%  1495  428s
  1120  1087 61374.5194   38  192 50282.2089 68289.9953  35.8%  1453  439s
  1194  1137 57291.9181   39  228 50282.2089 68230.7169  35.7%  1441  447s
  1272  1167 56835.3818   40  192 50282.2089 68230.7169  35.7%  1431  458s
  1328  1208 51383.5069   41  198 50282.2089 68230.7169  35.7%  1460  470s
  1389  1262 51034.6371   43  170 50282.2089 68230.7169  35.7%  1485  481s
  1467  1348     cutoff   46      50282.2089 68205.9820  35.6%  1491  492s
  1571  1452 65976.8307    8  301 50282.2089 68205.9820  35.6%  1479  504s
  1707  1570 65550.6806   14  271 50282.2089 68205.9820  35.6%  1446  517s
  1847  1685 59774.3480    9  285 50282.2089 68205.9820  35.6%  1410  529s
  1998  1759 59640.9916   11  276 50282.2089 68205.9820  35.6%  1384  540s
  2139  1882 58682.0702   13  257 50282.2089 68205.9820  35.6%  1385  553s
  2290  1982 55398.8576   15  228 50282.2089 68205.9820  35.6%  1376  566s
  2446  2085 54974.3645   17  266 50282.2089 68205.9820  35.6%  1364  580s
  2597  2183 53434.3968   20  216 50282.2089 68205.9820  35.6%  1357  593s
  2749  2354 52326.9861   22  165 50282.2089 68205.9820  35.6%  1363  607s
  2970  2486 51273.3868   29  129 50282.2089 68184.6610  35.6%  1328  623s
  3204  2614 66546.4127   10  315 50282.2089 67968.9212  35.2%  1303  641s
  3380  2745 60385.4506   11  309 50282.2089 67968.9212  35.2%  1300  658s
  3577  2856 57605.8485   13  270 50282.2089 67943.1758  35.1%  1294  674s
  3764  2857 56160.9964   38  417 50282.2089 67910.4211  35.1%  1301  724s
  3766  2858 59839.3261   17  148 50282.2089 67910.4211  35.1%  1300  756s
H 3766  2715                    50286.535566 67910.4211  35.0%  1300  776s
  3768  2717 63901.1249   19  362 50286.5356 67910.4211  35.0%  1300  788s
  3769  2717 62209.3476    7  386 50286.5356 67910.4211  35.0%  1299  795s
  3770  2718 51608.8178   33  379 50286.5356 67910.4211  35.0%  1299  802s
  3771  2719 60015.0442   46  405 50286.5356 67910.4211  35.0%  1299  806s
  3772  2719 52006.2855   30  421 50286.5356 67910.4211  35.0%  1298  812s
  3773  2720 59637.3423   12  378 50286.5356 67910.4211  35.0%  1298  816s
  3774  2721 67063.0991   10  376 50286.5356 67910.4211  35.0%  1298  820s
  3776  2722 56354.2891   46  418 50286.5356 67910.4211  35.0%  1297  826s
  3778  2723 60409.7581   23  380 50286.5356 67910.4211  35.0%  1296  831s
  3779  2724 50657.2099   60  432 50286.5356 67910.4211  35.0%  1296  837s
  3781  2725 52993.2431   24  413 50286.5356 67910.4211  35.0%  1295  841s
H 3781  2588                    50560.224017 67910.4211  34.3%  1295  844s
H 3782  2459                    50614.924653 67910.4211  34.2%  1295  847s
  3784  2460 51212.0951   39  426 50614.9247 67910.4211  34.2%  1294  852s
  3785  2461 62265.2022   36  432 50614.9247 67910.4211  34.2%  1294  856s
  3788  2463 59175.7758   16  432 50614.9247 67910.4211  34.2%  1293  860s
H 3789  2341                    50892.971459 67910.4211  33.4%  1292  864s
  3790  2341 63125.2899   14  414 50892.9715 67910.4211  33.4%  1292  867s
  3792  2343 56526.2549   29  436 50892.9715 67910.4211  33.4%  1291  870s
  3794  2344 54508.4461   30  432 50892.9715 67910.4211  33.4%  1291  876s
  3796  2345 60384.9149   12  434 50892.9715 67910.4211  33.4%  1290  880s
  3798  2347 59397.5728   11  434 50892.9715 67910.4211  33.4%  1289  885s
  3801  2349 53836.2336   48  427 50892.9715 67910.4211  33.4%  1288  893s
  3802  2349 60384.9149   12  427 50892.9715 67910.4211  33.4%  1288  922s
  3803  2350 66750.4757   11  427 50892.9715 67910.4211  33.4%  1288  944s
  3804  2354 67910.4211   13  404 50892.9715 67910.4211  33.4%  1327  961s
  3806  2357 67910.4211   14  400 50892.9715 67910.4211  33.4%  1329  976s
  3810  2364 67910.4211   15  398 50892.9715 67910.4211  33.4%  1332 1000s
  3818  2377 67910.4211   16  405 50892.9715 67910.4211  33.4%  1342 1017s
  3834  2388 67043.0955   17  326 50892.9715 67910.4211  33.4%  1381 1048s
  3850  2414 65704.6230   18  332 50892.9715 67910.4211  33.4%  1406 1067s
H 3872  2288                    50923.402302 67910.4211  33.4%  1430 1067s
  3882  2394 65015.8605   19  329 50923.4023 67910.4211  33.4%  1446 1091s
  3991  2389 64446.4086   21  315 50923.4023 67910.4211  33.4%  1526 1105s
  4023  2442 64346.7218   20  316 50923.4023 67910.4211  33.4%  1544 1122s
H 4032  2327                    50990.448503 67910.4211  33.2%  1547 1122s
  4093  2345 64227.6248   22  327 50990.4485 67910.4211  33.2%  1574 1137s
H 4100  2237                    50991.084838 67910.4211  33.2%  1576 1137s
  4162  2254 63144.6670   22  271 50991.0848 67910.4211  33.2%  1593 1154s
  4244  2243 63081.1017   22  267 50991.0848 67910.4211  33.2%  1609 1171s
H 4304  2121                    50997.958375 67910.4211  33.2%  1621 1171s
  4324  2142 63662.7267   21  365 50997.9584 67910.4211  33.2%  1626 1185s
  4392  2144 63031.1857   23  340 50997.9584 67910.4211  33.2%  1648 1207s
  4432  2151 62301.2161   24  285 50997.9584 67910.4211  33.2%  1662 1221s
  4475  2165 61125.8327   24  196 50997.9584 67910.4211  33.2%  1676 1235s
  4516  2175 60032.2618   25  234 50997.9584 67910.4211  33.2%  1691 1248s
  4565  2167 60074.4397   25  167 50997.9584 67910.4211  33.2%  1703 1263s
H 4570  2069                    51005.342106 67910.4211  33.1%  1704 1263s
  4626  2095 59654.0109   26  178 51005.3421 67910.4211  33.1%  1705 1278s
  4713  2093 52093.7020   27  168 51005.3421 67910.4211  33.1%  1710 1304s
  4831  2070 59023.7576   28  207 51005.3421 67350.3747  32.0%  1707 1317s
H 4852  1972                    51184.422213 67350.3747  31.6%  1710 1317s
H 4864  1881                    51861.824563 67350.3747  29.9%  1710 1317s
  4925  1869 58632.5993   29  159 51861.8246 67350.3747  29.9%  1710 1334s
  5009  1883 52613.2234   30  151 51861.8246 67350.3747  29.9%  1723 1350s
  5074  1897 53407.8516   32  218 51861.8246 67350.3747  29.9%  1737 1376s
  5165  1884 52288.5713   34  148 51861.8246 66650.4702  28.5%  1755 1392s
H 5173  1798                    52105.331300 66650.4702  27.9%  1757 1392s
H 5187  1716                    52220.466836 66650.4702  27.6%  1760 1392s
  5219  1719     cutoff   35      52220.4668 66144.1730  26.7%  1762 1407s
H 5230  1640                    52288.089579 66144.1730  26.5%  1765 1407s
  5287  1654 64704.7300   19  346 52288.0896 66144.1730  26.5%  1772 1424s
  5400  1650 58841.5778   20  327 52288.0896 66144.1730  26.5%  1784 1441s
  5514  1627 56859.4851   22  304 52288.0896 65421.7172  25.1%  1796 1456s
H 5524  1553                    52315.346528 65421.7172  25.1%  1798 1456s
H 5536  1481                    52386.296671 65421.7172  24.9%  1798 1456s
  5568  1488 56018.0257   23  302 52386.2967 65348.2906  24.7%  1807 1474s
  5693  1478     cutoff   24      52386.2967 65348.2906  24.7%  1814 1492s
  5815  1485 54942.5288   24  237 52386.2967 65348.2906  24.7%  1830 1511s
  5955  1456 54159.9701   32  157 52386.2967 65045.5505  24.2%  1843 1524s
  6007  1453 53289.8653   34  144 52386.2967 64571.9153  23.3%  1848 1542s
  6119  1465 55501.1014   23  278 52386.2967 64571.9153  23.3%  1852 1561s
  6244  1470 53995.6538   28  231 52386.2967 64571.9153  23.3%  1865 1587s
  6410  1449 60715.5343   20  253 52386.2967 64309.4959  22.8%  1873 1609s
  6567  1433 53885.3150   24  194 52386.2967 64191.9773  22.5%  1885 1631s
  6718  1414 57578.4598   20  344 52386.2967 64062.3714  22.3%  1901 1660s
  6886  1385 54693.1803   23  314 52386.2967 64062.3714  22.3%  1915 1684s
  7064  1351 54174.4042   27  149 52386.2967 63794.3762  21.8%  1917 1709s
  7198  1361 53391.5735   31  126 52386.2967 63542.9593  21.3%  1918 1737s
  7427  1334 55793.9565   21  295 52386.2967 63311.2748  20.9%  1917 1768s
  7657  1301 53723.8955   25  260 52386.2967 63229.0273  20.7%  1924 1791s
  7828  1337     cutoff   26      52386.2967 63056.7450  20.4%  1928 1818s
  8032  1382 54509.9006   26  319 52386.2967 62642.8790  19.6%  1941 1849s
  8292  1421 55996.8313   26  261 52386.2967 62322.2604  19.0%  1946 1881s
  8607  1458 54041.9516   24  270 52386.2967 61984.2649  18.3%  1945 1913s
  8922  1465 54242.3958   25  281 52386.2967 61655.5698  17.7%  1945 1946s
  9245  1500 57874.7835   23  336 52386.2967 61019.3891  16.5%  1947 1981s
  9556  1513 55175.9216   31  182 52386.2967 60846.6824  16.1%  1955 2014s
  9832  1516 52714.9191   37  164 52386.2967 60140.8367  14.8%  1958 2041s
  9892  1512 52504.0195   38  135 52386.2967 60136.7078  14.8%  1960 2073s
 10027  1530     cutoff   39      52386.2967 60136.7078  14.8%  1960 2106s
 10242  1576 54930.3606   24  272 52386.2967 59741.1682  14.0%  1966 2142s
 10558  1666 55081.1566   28  201 52386.2967 59535.9508  13.6%  1974 2181s
 10910  1734 52925.9493   35  172 52386.2967 59362.7498  13.3%  1982 2221s
 11302  1795 54214.2042   30  137 52386.2967 58797.1403  12.2%  1989 2262s
 11721  1816 53027.7941   27  289 52386.2967 58527.7638  11.7%  1999 2304s
 12212  1855 53727.4149   25  240 52386.2967 58136.7933  11.0%  1998 2349s
 12694  1912 55098.9408   22  333 52386.2967 57884.6073  10.5%  2001 2400s
 13199  1923 52688.0858   31  196 52386.2967 57701.4856  10.1%  2001 2444s
 13593  1971 53631.9974   26  126 52386.2967 57369.7568  9.51%  2004 2489s
 14144  1990     cutoff   24      52386.2967 57153.1998  9.10%  1994 2541s
 14717  1965     cutoff   29      52386.2967 56977.3966  8.76%  1997 2597s
 15351  1934     cutoff   26      52386.2967 56572.8684  7.99%  1996 2650s
 15990  1876 54596.2149   25  234 52386.2967 56260.8348  7.40%  1995 2707s
 16726  1821     cutoff   30      52386.2967 55954.1861  6.81%  1986 2767s
 17480  1669 52784.6474   26  207 52386.2967 55792.4847  6.50%  1981 2830s
 18306  1432 52613.0258   26  226 52386.2967 55302.7674  5.57%  1970 2898s
 19284  1015     cutoff   26      52386.2967 54937.5604  4.87%  1947 2957s
 20490   904 53366.9818   30  278 52386.2967 54472.7032  3.98%  1908 3008s
 20728   425     cutoff   28      52386.2967 54253.2576  3.56%  1898 3060s
 22862   748 53106.3131   35  142 52386.2967 53783.9301  2.67%  1764 3080s
*23290   748              38    52400.760059 53742.9079  2.56%  1735 3080s
*23372   748              69    52424.862196 53725.1747  2.48%  1730 3080s
H23464   748                    52684.388327 53704.1213  1.94%  1724 3080s

Cutting planes:
  Learned: 2
  MIR: 848
  Flow cover: 1850
  RLT: 18
  Relax-and-lift: 186

Explored 26664 nodes (41023477 simplex iterations) in 3082.61 seconds (5711.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 52684.4 52424.9 52400.8 ... 51184.4

Optimal solution found (tolerance 1.00e-06)
Best objective 5.268438832719e+04, best bound 5.268438832719e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3082.63s
  Master Objective (UB) = 52684.39, θ = 202036.66
  Upper Bound (UB) = 52684.39

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202036.66
  [DEBUG]   ✓ Scenario 0: θ = 202036.66 ≤ Q = 202036.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 202036.66 ≤ Q = 202036.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 202036.66 ≤ Q = 202036.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 202036.66 ≤ Q = 202036.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 202036.66 ≤ Q = 202036.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 202036.66 ≤ Q = 202036.66 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7362165a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7362165a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.449044e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.01s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 7148262.5504
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.671493e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167149.26    0  133 7148262.55 -167149.26   102%     -    0s
H    0     0                    -123287.5308 -167149.26  35.6%     -    0s
H    0     0                    -124306.4295 -167149.26  34.5%     -    0s
H    0     0                    -138127.1453 -167149.26  21.0%     -    0s
H    0     0                    -139911.5111 -153741.85  9.89%     -    0s
H    0     0                    -146794.7792 -153741.85  4.73%     -    0s
     0     0 -153741.85    0   77 -146794.78 -153741.85  4.73%     -    0s
H    0     0                    -151423.6770 -153646.71  1.47%     -    0s
H    0     0                    -151887.2163 -152821.43  0.62%     -    0s
     0     0 -152821.43    0   80 -151887.22 -152821.43  0.62%     -    0s
     0     0 -152817.03    0   80 -151887.22 -152817.03  0.61%     -    0s
H    0     0                    -152345.0335 -152811.31  0.31%     -    0s
     0     0 -152805.23    0   76 -152345.03 -152805.23  0.30%     -    0s
     0     0 -152764.73    0   67 -152345.03 -152764.73  0.28%     -    0s
     0     0 -152731.01    0   61 -152345.03 -152731.01  0.25%     -    0s
     0     0 -152694.39    0   57 -152345.03 -152694.39  0.23%     -    0s
     0     0 -152676.84    0   52 -152345.03 -152676.84  0.22%     -    0s
     0     0 -152663.02    0   35 -152345.03 -152663.02  0.21%     -    0s
     0     0 -152660.71    0   29 -152345.03 -152660.71  0.21%     -    0s
     0     0 -152641.99    0   39 -152345.03 -152641.99  0.19%     -    0s
     0     0 -152614.33    0   25 -152345.03 -152614.33  0.18%     -    0s
     0     0 -152599.63    0   24 -152345.03 -152599.63  0.17%     -    0s
     0     0 -152584.58    0   27 -152345.03 -152584.58  0.16%     -    0s
     0     0 -152568.69    0   27 -152345.03 -152568.69  0.15%     -    0s
     0     0 -152415.58    0   31 -152345.03 -152415.58  0.05%     -    0s
     0     0 -152415.58    0   23 -152345.03 -152415.58  0.05%     -    0s
     0     0 -152411.93    0    8 -152345.03 -152411.93  0.04%     -    0s
     0     0 -152387.51    0    6 -152345.03 -152387.51  0.03%     -    0s
H    0     0                    -152349.4474 -152387.51  0.02%     -    0s
     0     0 -152367.60    0    4 -152349.45 -152367.60  0.01%     -    0s
     0     0 -152358.42    0    3 -152349.45 -152358.42  0.01%     -    0s
     0     0 -152355.03    0    2 -152349.45 -152355.03  0.00%     -    0s
     0     0     cutoff    0      -152349.45 -152349.45  0.00%     -    0s

Explored 1 nodes (669 simplex iterations) in 0.18 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -152349 -152345 -152205 ... 7.14826e+06
No other solutions better than -152349

Optimal solution found (tolerance 1.00e-06)
Best objective -1.523494473670e+05, best bound -1.523494473670e+05, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 181459.42
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -152349.45
  [DEBUG]   S×d_nominal = 333808.86
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 333808.86 + -152349.45 = 181459.42
  [DEBUG]   Current θ from Master = 202036.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20577.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32107.14
  Lower Bound (LB) = 45543.29
  Gap (UB-LB) = 7141.0942, Absolute Gap = 7141.0942, Relative Gap = 0.135545
  Not converged yet (gap = 7141.09 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xbbe28c71
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49650 rows and 20170 columns
Presolve time: 2.43s
Presolved: 58763 rows, 25770 columns, 365609 nonzeros
Variable types: 23511 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58763 rows, 25770 columns, 365609 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23945   -1.5491954e+05   0.000000e+00   4.524053e+08      5s
   39253    2.7464940e+04   0.000000e+00   5.302637e+06     10s
   47863    6.3163672e+04   0.000000e+00   6.941206e+06     15s
   56611    7.1079556e+04   0.000000e+00   3.294355e+06     20s
   64210    7.3387271e+04   0.000000e+00   1.641328e+06     25s
Concurrent spin time: 1.53s

Solved with dual simplex

Root relaxation: objective 8.169289e+04, 42492 iterations, 27.94 seconds (38.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81692.8859    0  148 -227427.98 81692.8859   136%     -   31s
H    0     0                    -218732.5940 81692.8859   137%     -   31s
H    0     0                    -173555.2967 81692.8859   147%     -   31s
H    0     0                    -173266.1433 81692.8859   147%     -   31s
H    0     0                    -132985.0029 81692.8859   161%     -   31s
H    0     0                    -129379.3911 81692.8859   163%     -   31s
H    0     0                    -128554.6696 81692.8859   164%     -   31s
H    0     0                    -40580.31021 81692.8859   301%     -   31s
H    0     0                    -40416.21585 81692.8859   302%     -   31s
H    0     0                    16383.922459 81692.8859   399%     -   31s
H    0     0                    24485.193169 81692.8859   234%     -   32s
H    0     0                    25001.476415 81692.8859   227%     -   33s
H    0     0                    25497.360624 81692.8859   220%     -   33s
H    0     0                    27451.686479 81692.8859   198%     -   33s
H    0     0                    27562.922379 81692.8859   196%     -   33s
     0     0 76415.3504    0  226 27562.9224 76415.3504   177%     -   45s
H    0     0                    27580.951464 76415.3504   177%     -   45s
     0     0 76415.3504    0  196 27580.9515 76415.3504   177%     -   50s
     0     0 76415.3504    0  201 27580.9515 76415.3504   177%     -   51s
     0     0 74339.1954    0  196 27580.9515 74339.1954   170%     -   52s
     0     0 74339.1954    0  189 27580.9515 74339.1954   170%     -   53s
     0     0 74339.1954    0  189 27580.9515 74339.1954   170%     -   53s
     0     0 74339.1954    0  189 27580.9515 74339.1954   170%     -   53s
     0     0 74284.7242    0  236 27580.9515 74284.7242   169%     -   65s
H    0     0                    32894.152204 74284.4328   126%     -   66s
H    0     0                    37452.737780 74284.4328  98.3%     -   66s
H    0     0                    38194.921629 74284.4328  94.5%     -   66s
H    0     0                    38306.157529 74284.4328  93.9%     -   66s
     0     0 73538.3467    0  254 38306.1575 73538.3467  92.0%     -   72s
     0     0 73291.1402    0  259 38306.1575 73291.1402  91.3%     -   77s
     0     0 73130.3745    0  264 38306.1575 73130.3745  90.9%     -   79s
     0     0 73095.7734    0  259 38306.1575 73095.7734  90.8%     -   80s
     0     0 73085.9850    0  272 38306.1575 73085.9850  90.8%     -   80s
     0     0 73081.9480    0  270 38306.1575 73081.9480  90.8%     -   81s
     0     0 73079.5124    0  270 38306.1575 73079.5124  90.8%     -   81s
     0     0 73079.4175    0  270 38306.1575 73079.4175  90.8%     -   82s
H    0     0                    40910.442862 71210.1704  74.1%     -  102s
H    0     0                    40979.450957 71210.1704  73.8%     -  102s
H    0     0                    40981.164748 71210.1704  73.8%     -  102s
H    0     0                    41016.677596 71210.1704  73.6%     -  102s
H    0     0                    44759.189496 71210.1704  59.1%     -  102s
H    0     0                    50018.736389 71210.1704  42.4%     -  102s
     0     0 71210.1704    0  353 50018.7364 71210.1704  42.4%     -  102s
H    0     0                    50105.745271 71210.0192  42.1%     -  102s
     0     0 71001.9169    0  369 50105.7453 71001.9169  41.7%     -  107s
     0     0 70885.5983    0  365 50105.7453 70885.5983  41.5%     -  111s
     0     0 70831.4952    0  375 50105.7453 70831.4952  41.4%     -  113s
     0     0 70774.1980    0  383 50105.7453 70774.1980  41.2%     -  116s
     0     0 70755.8779    0  386 50105.7453 70755.8779  41.2%     -  117s
     0     0 70737.3427    0  383 50105.7453 70737.3427  41.2%     -  118s
     0     0 70731.7770    0  380 50105.7453 70731.7770  41.2%     -  119s
     0     0 70729.9835    0  385 50105.7453 70729.9835  41.2%     -  119s
     0     0 70729.0575    0  382 50105.7453 70729.0575  41.2%     -  120s
H    0     0                    50114.806978 70187.7131  40.1%     -  131s
H    0     0                    50274.006852 70187.7131  39.6%     -  131s
H    0     0                    50277.752078 70187.7131  39.6%     -  131s
H    0     0                    50411.495192 70187.7131  39.2%     -  131s
H    0     0                    50558.815819 70187.7131  38.8%     -  131s
     0     0 70187.7131    0  386 50558.8158 70187.7131  38.8%     -  131s
H    0     0                    51126.683708 70187.4749  37.3%     -  132s
     0     0 70056.6745    0  401 51126.6837 70056.6745  37.0%     -  136s
     0     0 69987.2092    0  401 51126.6837 69987.2092  36.9%     -  139s
     0     0 69961.5404    0  411 51126.6837 69961.5404  36.8%     -  140s
     0     0 69947.4845    0  407 51126.6837 69947.4845  36.8%     -  141s
     0     0 69939.8294    0  417 51126.6837 69939.8294  36.8%     -  142s
     0     0 69934.2545    0  418 51126.6837 69934.2545  36.8%     -  142s
     0     0 69933.0811    0  414 51126.6837 69933.0811  36.8%     -  143s
     0     0 69868.4567    0  412 51126.6837 69868.4567  36.7%     -  147s
H    0     0                    51134.235513 69867.0661  36.6%     -  147s
H    0     0                    51198.006056 69867.0661  36.5%     -  147s
     0     0 69843.1905    0  422 51198.0061 69843.1905  36.4%     -  149s
     0     0 69834.9430    0  426 51198.0061 69834.9430  36.4%     -  150s
     0     0 69831.9776    0  431 51198.0061 69831.9776  36.4%     -  150s
     0     0 69831.3395    0  429 51198.0061 69831.3395  36.4%     -  150s
     0     0 69689.2276    0  368 51198.0061 69689.2276  36.1%     -  156s
H    0     0                    51463.759596 69688.6312  35.4%     -  157s
H    0     0                    51485.736678 69688.6312  35.4%     -  157s
H    0     0                    51498.323968 69688.6312  35.3%     -  157s
H    0     0                    51651.887313 69660.2360  34.9%     -  159s
H    0     0                    51654.174837 69660.2360  34.9%     -  159s
     0     0 69660.2360    0  407 51654.1748 69660.2360  34.9%     -  159s
     0     0 69651.2774    0  415 51654.1748 69651.2774  34.8%     -  160s
     0     0 69645.5900    0  410 51654.1748 69645.5900  34.8%     -  161s
     0     0 69644.1060    0  417 51654.1748 69644.1060  34.8%     -  161s
     0     0 69643.7727    0  416 51654.1748 69643.7727  34.8%     -  161s
     0     0 69633.4629    0  416 51654.1748 69633.4629  34.8%     -  163s
     0     0 69620.0331    0  420 51654.1748 69620.0331  34.8%     -  164s
     0     0 69617.7112    0  421 51654.1748 69617.7112  34.8%     -  165s
     0     0 69616.7653    0  420 51654.1748 69616.7653  34.8%     -  165s
H    0     0                    51852.240094 69616.7653  34.3%     -  166s
     0     0 69609.7983    0  421 51852.2401 69609.7983  34.2%     -  167s
     0     0 69569.6900    0  412 51852.2401 69569.6900  34.2%     -  169s
     0     0 69557.5376    0  414 51852.2401 69557.5376  34.1%     -  170s
     0     0 69550.0781    0  416 51852.2401 69550.0781  34.1%     -  170s
     0     0 69548.6511    0  419 51852.2401 69548.6511  34.1%     -  171s
     0     0 69528.2630    0  409 51852.2401 69528.2630  34.1%     -  173s
     0     0 69523.5063    0  408 51852.2401 69523.5063  34.1%     -  174s
     0     0 69522.3660    0  415 51852.2401 69522.3660  34.1%     -  174s
     0     0 69514.9977    0  380 51852.2401 69514.9977  34.1%     -  176s
     0     0 69512.8624    0  382 51852.2401 69512.8624  34.1%     -  177s
     0     0 69511.3336    0  384 51852.2401 69511.3336  34.1%     -  177s
     0     0 69511.0589    0  386 51852.2401 69511.0589  34.1%     -  178s
     0     0 69496.8825    0  385 51852.2401 69496.8825  34.0%     -  179s
     0     0 69495.6562    0  386 51852.2401 69495.6562  34.0%     -  180s
     0     0 69449.9305    0  383 51852.2401 69449.9305  33.9%     -  182s
H    0     0                    51907.895927 69449.5831  33.8%     -  189s
     0     0 69431.7829    0  417 51907.8959 69431.7829  33.8%     -  189s
     0     0 69428.9348    0  423 51907.8959 69428.9348  33.8%     -  190s
     0     0 69427.3533    0  422 51907.8959 69427.3533  33.8%     -  190s
     0     0 69426.9904    0  422 51907.8959 69426.9904  33.8%     -  190s
     0     0 69420.6211    0  383 51907.8959 69420.6211  33.7%     -  192s
     0     0 69415.4787    0  425 51907.8959 69415.4787  33.7%     -  193s
     0     0 69415.0080    0  425 51907.8959 69415.0080  33.7%     -  193s
     0     0 69408.8142    0  432 51907.8959 69408.8142  33.7%     -  195s
     0     0 69404.8658    0  432 51907.8959 69404.8658  33.7%     -  195s
     0     0 69404.1414    0  430 51907.8959 69404.1414  33.7%     -  195s
     0     0 69399.2916    0  429 51907.8959 69399.2916  33.7%     -  197s
     0     0 69397.3995    0  429 51907.8959 69397.3995  33.7%     -  198s
     0     0 69393.6293    0  427 51907.8959 69393.6293  33.7%     -  199s
     0     0 69392.8319    0  427 51907.8959 69392.8319  33.7%     -  200s
     0     2 69392.8319    0  427 51907.8959 69392.8319  33.7%     -  231s
     3     8 69275.8220    2  420 51907.8959 69374.3067  33.6%  2032  240s
     7    16 69237.2827    3  378 51907.8959 69275.0867  33.5%  2981  249s
    15    32 68930.4473    4  419 51907.8959 69236.4209  33.4%  3909  260s
    31    48 68559.6242    5  409 51907.8959 68929.9108  32.8%  7085  285s
    47    80 67826.3435    6  410 51907.8959 68929.9108  32.8%  7037  297s
H   79   112                    51966.828777 68929.9108  32.6%  5099  308s
H   91   112                    52032.264844 68929.9108  32.5%  4556  308s
   111   267 67805.3325    8  400 52032.2648 68929.9108  32.5%  4045  321s
   266   351 67476.7107   11  341 52032.2648 68929.9108  32.5%  2367  331s
   350   435 67561.0029   13  373 52032.2648 68929.9108  32.5%  2215  341s
   434   510 67393.9167   12  333 52032.2648 68929.9108  32.5%  2024  350s
   509   573 67425.5565   12  332 52032.2648 68929.9108  32.5%  1958  357s
   572   633 66587.4018   14  304 52032.2648 68929.9108  32.5%  1924  367s
   632   683 67166.2519   14  333 52032.2648 68929.9108  32.5%  1947  374s
   690   738 67349.1839   15  383 52032.2648 68929.9108  32.5%  1941  384s
   771   790 67279.4104   15  368 52032.2648 68929.9108  32.5%  1886  395s
H  793   790                    52183.039502 68929.9108  32.1%  1892  395s
   839   855 66572.8233   15  283 52183.0395 68929.9108  32.1%  1848  407s
   930   901 66795.0724   15  366 52183.0395 68929.9108  32.1%  1797  418s
H  947   901                    52264.886856 68929.9108  31.9%  1797  418s
  1008   935 66925.4230   16  371 52264.8869 68929.9108  31.9%  1748  430s
H 1010   935                    52346.990818 68929.9108  31.7%  1747  430s
  1060   965 66857.8956   16  370 52346.9908 68929.9108  31.7%  1744  443s
  1135  1025 66395.6512   15  305 52346.9908 68929.9108  31.7%  1721  455s
  1219  1095 61371.3274   17  314 52346.9908 68929.9108  31.7%  1723  467s
  1311  1160 60765.9933   17  276 52346.9908 68929.9108  31.7%  1710  479s
  1419  1188 60595.6075   18  308 52346.9908 68929.9108  31.7%  1691  492s
  1453  1221 59946.3228   18  313 52346.9908 68929.9108  31.7%  1701  501s
  1500  1245 60051.2146   19  370 52346.9908 68929.9108  31.7%  1716  516s
  1534  1283 59889.7918   20  358 52346.9908 68929.9108  31.7%  1739  528s
  1588  1328 59256.0191   22  239 52346.9908 68929.9108  31.7%  1742  541s
  1655  1377 56899.9999   23  202 52346.9908 68929.9108  31.7%  1736  563s
  1745  1450 56238.5352   24  265 52346.9908 68831.8708  31.5%  1710  577s
  1862  1564 58112.8297   28  250 52346.9908 68829.7216  31.5%  1676  591s
  2014  1632 57934.3362   30  231 52346.9908 68829.7216  31.5%  1615  606s
  2158  1720 57378.7811   38  225 52346.9908 68829.7216  31.5%  1569  619s
  2296  1771 56995.8241   39  206 52346.9908 68829.7216  31.5%  1550  636s
  2409  1863 55945.6950   42  243 52346.9908 68350.1326  30.6%  1553  652s
  2531  1978 55098.9047   43  223 52346.9908 68350.1326  30.6%  1566  668s
  2674  2107 54481.9720   45  227 52346.9908 68350.1326  30.6%  1571  687s
  2853  2243 54422.5207   48  189 52346.9908 68281.1385  30.4%  1568  703s
  3069  2372 53989.5278   54  195 52346.9908 68281.1385  30.4%  1545  722s
  3275  2538     cutoff   62      52346.9908 68261.3817  30.4%  1535  740s
  3502  2699 66550.0335   17  336 52346.9908 68044.3595  30.0%  1517  759s
  3772  2700 66245.3344   11  427 52346.9908 68044.3595  30.0%  1482  829s
  3774  2701 53047.7800   36  148 52346.9908 68044.3595  30.0%  1481  884s
  3775  2702 53130.1447   39  224 52346.9908 68044.3595  30.0%  1481  908s
  3776  2703 53929.3065   27  287 52346.9908 68044.3595  30.0%  1480  927s
  3777  2703 62232.8653   14  346 52346.9908 68044.3595  30.0%  1480  943s
  3778  2704 54336.5708   48  397 52346.9908 68044.3595  30.0%  1479  954s
  3779  2705 55094.2562   21  405 52346.9908 68044.3595  30.0%  1479  962s
  3780  2705 64725.3910    8  407 52346.9908 68044.3595  30.0%  1479  968s
  3781  2706 55380.4628   36  353 52346.9908 68044.3595  30.0%  1478  972s
  3782  2707 55197.3445   33  411 52346.9908 68044.3595  30.0%  1478  975s
  3784  2708 64377.6030   29  416 52346.9908 68044.3595  30.0%  1477  980s
  3787  2710 61953.7793   10  390 52346.9908 68044.3595  30.0%  1476  985s
  3789  2711 55094.2562   21  419 52346.9908 68044.3595  30.0%  1475  990s
  3792  2713 57250.7752   20  426 52346.9908 68044.3595  30.0%  1474 1001s
  3795  2715 66693.7872   16  393 52346.9908 68044.3595  30.0%  1473 1005s
  3796  2716 53117.6215   31  424 52346.9908 68044.3595  30.0%  1472 1011s
  3799  2718 57612.3464   19  437 52346.9908 68044.3595  30.0%  1471 1015s
  3802  2720 66852.0850   15  428 52346.9908 68044.3595  30.0%  1470 1021s
  3804  2721 67120.8777   10  423 52346.9908 68044.3595  30.0%  1469 1025s
  3805  2722 60463.3521   18  437 52346.9908 68044.3595  30.0%  1469 1030s
  3809  2725 61110.8877   17  440 52346.9908 68044.3595  30.0%  1467 1035s
  3810  2725 58897.1199   18  428 52346.9908 68044.3595  30.0%  1467 1040s
  3813  2727 53588.0880   39  435 52346.9908 68044.3595  30.0%  1466 1048s
  3814  2728 66337.5854   11  447 52346.9908 68044.3595  30.0%  1465 1050s
  3817  2730 57540.4878   36  430 52346.9908 68044.3595  30.0%  1464 1059s
  3818  2731 56330.7543   41  446 52346.9908 68044.3595  30.0%  1464 1060s
  3820  2732 56351.5263   14  432 52346.9908 68044.3595  30.0%  1463 1066s
  3821  2733 54238.4906   25  432 52346.9908 68044.3595  30.0%  1463 1115s
  3822  2733 64843.4507   12  432 52346.9908 68044.3595  30.0%  1462 1141s
  3823  2737 68044.3595   13  426 52346.9908 68044.3595  30.0%  1514 1164s
  3825  2740 68044.3595   14  428 52346.9908 68044.3595  30.0%  1515 1186s
  3829  2747 68044.3595   15  424 52346.9908 68044.3595  30.0%  1519 1211s
  3837  2760 68044.3595   16  430 52346.9908 68044.3595  30.0%  1525 1259s
  3853  2771 65762.9898   17  359 52346.9908 68044.3595  30.0%  1590 1309s
  3869  2798 63846.6961   18  344 52346.9908 68044.3595  30.0%  1622 1335s
  3901  2937 63614.3152   19  335 52346.9908 68044.3595  30.0%  1670 1369s
  4051  2943 62998.0341   22  368 52346.9908 68044.3595  30.0%  1716 1389s
  4108  2995 61453.2299   21  252 52346.9908 68044.3595  30.0%  1756 1406s
  4193  2989 57393.4293   22  277 52346.9908 68044.3595  30.0%  1769 1422s
H 4200  2848                    52375.783477 68044.3595  29.9%  1772 1422s
  4225  2880 58032.9802   23  349 52375.7835 68044.3595  29.9%  1779 1440s
  4320  2867 54732.3273   37  122 52375.7835 68044.3595  29.9%  1785 1459s
H 4331  2733                    52445.751757 68044.3595  29.7%  1785 1459s
  4359  2756 56898.4240   23  303 52445.7518 68044.3595  29.7%  1793 1476s
  4447  2749 56202.4335   23  284 52445.7518 68044.3595  29.7%  1793 1490s
  4481  2761 57855.2883   23  255 52445.7518 68044.3595  29.7%  1809 1510s
H 4495  2632                    52452.110539 68044.3595  29.7%  1811 1510s
  4537  2635 56754.6625   24  370 52452.1105 68044.3595  29.7%  1815 1533s
  4580  2630 56379.5712   24  211 52452.1105 68044.3595  29.7%  1826 1547s
  4635  2636 55742.0102   25  256 52452.1105 68044.3595  29.7%  1841 1562s
  4682  2633 55492.4750   27  236 52452.1105 68044.3595  29.7%  1851 1578s
  4719  2641 55098.1980   28  212 52452.1105 68044.3595  29.7%  1863 1594s
  4771  2641 55046.8601   29  212 52452.1105 68044.3595  29.7%  1868 1611s
  4814  2668 54799.3480   30  189 52452.1105 68044.3595  29.7%  1883 1627s
  4885  2670 54676.7389   31  237 52452.1105 68044.3595  29.7%  1891 1643s
  4954  2688 54734.7339   31  191 52452.1105 67359.8106  28.4%  1898 1662s
  5031  2705     cutoff   32      52452.1105 67359.8106  28.4%  1901 1686s
  5121  2720 53305.6797   37  127 52452.1105 67359.8106  28.4%  1913 1708s
  5228  2716 58299.4627   24  360 52452.1105 67359.8106  28.4%  1920 1727s
  5336  2718 57025.3368   25  265 52452.1105 67359.8106  28.4%  1926 1752s
  5418  2747 54444.5484   28  251 52452.1105 66858.7925  27.5%  1946 1773s
  5511  2751 53847.5186   31  165 52452.1105 66857.9694  27.5%  1965 1802s
  5633  2752 53701.3869   37  145 52452.1105 66121.6883  26.1%  1972 1826s
  5753  2757     cutoff   48      52452.1105 66121.6883  26.1%  1984 1852s
  5870  2772 58011.3634   21  345 52452.1105 66121.6883  26.1%  2000 1878s
  6021  2729 56249.1661   23  302 52452.1105 66121.6883  26.1%  2006 1905s
  6084  2736 56044.5738   24  240 52452.1105 65598.2463  25.1%  2011 1935s
  6129  2737 55963.2912   25  248 52452.1105 65598.2463  25.1%  2020 1970s
  6186  2742 54874.3771   26  230 52452.1105 65598.2463  25.1%  2030 1994s
  6244  2751     cutoff   27      52452.1105 65598.2463  25.1%  2035 2017s
  6311  2764 53870.4163   28  221 52452.1105 65598.2463  25.1%  2036 2040s
  6382  2770 53694.3818   29  216 52452.1105 65598.2463  25.1%  2040 2068s
  6458  2772 53599.5852   30  220 52452.1105 65598.2463  25.1%  2046 2095s
  6561  2778     cutoff   31      52452.1105 63773.5957  21.6%  2047 2122s
  6693  2782 53314.9618   32  202 52452.1105 63654.1526  21.4%  2045 2151s
  6804  2796 57037.0119   21  311 52452.1105 63344.4372  20.8%  2051 2177s
  6914  2786 53298.5697   23  359 52452.1105 63344.4372  20.8%  2062 2213s
  7091  2745 55685.7423   22  260 52452.1105 63219.5301  20.5%  2068 2249s
  7259  2749 53702.2193   28  123 52452.1105 62954.7142  20.0%  2083 2281s
  7466  2726 57284.7798   21  293 52452.1105 62954.7142  20.0%  2089 2316s
  7633  2707     cutoff   22      52452.1105 62954.7142  20.0%  2092 2355s
  7852  2654     cutoff   23      52452.1105 62921.9580  20.0%  2099 2400s
  8113  2612 54668.6456   25  316 52452.1105 62558.7506  19.3%  2110 2445s
  8349  2604 52737.0370   28  190 52452.1105 62429.9289  19.0%  2130 2493s
  8623  2541 55495.8604   21  305 52452.1105 62010.4664  18.2%  2150 2539s
  8817  2490 infeasible   22      52452.1105 61765.0063  17.8%  2169 2588s
  9110  2433     cutoff   21      52452.1105 61634.3266  17.5%  2192 2640s
  9416  2374 54873.4157   21  232 52452.1105 60861.5655  16.0%  2216 2688s
  9749  2279     cutoff   26      52452.1105 60861.5655  16.0%  2232 2736s
 10013  2218 58762.8364   21  350 52452.1105 60587.4270  15.5%  2241 2792s
 10309  2181 54756.3394   26  316 52452.1105 60182.3870  14.7%  2270 2848s
 10658  2138 55274.9723   25  268 52452.1105 60100.0157  14.6%  2290 2912s
 11011  2113 54902.9003   24  316 52452.1105 59377.1074  13.2%  2310 2975s
 11421  2185 56433.7808   22  324 52452.1105 58839.5874  12.2%  2322 3045s
 11809  2218     cutoff   27      52452.1105 58658.5006  11.8%  2341 3108s
 12256  2244     cutoff   27      52452.1105 58326.0779  11.2%  2356 3180s
 12705  2289 53706.6470   26   70 52452.1105 58139.7867  10.8%  2368 3248s
 13181  2322 52678.9122   29  194 52452.1105 57755.7445  10.1%  2384 3321s
 13671  2367     cutoff   24      52452.1105 57627.6208  9.87%  2398 3399s
 14198  2396 55370.9732   25  244 52452.1105 57273.4669  9.19%  2407 3469s
 14675  2422 53572.5343   26  349 52452.1105 57042.0139  8.75%  2408 3546s
 15210  2384 53061.1064   25  269 52452.1105 56900.4661  8.48%  2418 3600s

Cutting planes:
  MIR: 547
  Mixing: 1
  Flow cover: 2004
  RLT: 17
  Relax-and-lift: 156

Explored 15664 nodes (37968940 simplex iterations) in 3600.03 seconds (6348.29 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 52452.1 52445.8 52375.8 ... 51852.2

Time limit reached
Best objective 5.245211053871e+04, best bound 5.682919876372e+04, gap 8.3449%
  WARNING: Time limit reached. Using best solution found (gap: 8.34%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 52452.11, θ = 203695.40
  Upper Bound (UB) = 52452.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 203695.40
  [DEBUG]   ✓ Scenario 0: θ = 203695.40 ≤ Q = 203695.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 203695.40 ≤ Q = 203695.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 203695.40 ≤ Q = 203695.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 203695.40 ≤ Q = 203695.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 203695.40 ≤ Q = 203695.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 203695.40 ≤ Q = 203695.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 203695.40 ≤ Q = 203695.40 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x628f49d9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9d70b627
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.511856e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7357950.6362
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.680642e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168064.23    0  127 7357950.64 -168064.23   102%     -    0s
H    0     0                    -132058.7018 -168064.23  27.3%     -    0s
H    0     0                    -133048.0899 -168064.23  26.3%     -    0s
H    0     0                    -133995.0663 -168064.23  25.4%     -    0s
     0     0 -149552.87    0   80 -133995.07 -149552.87  11.6%     -    0s
H    0     0                    -146733.7462 -149432.07  1.84%     -    0s
     0     0 -149081.54    0   73 -146733.75 -149081.54  1.60%     -    0s
H    0     0                    -147907.7891 -149081.54  0.79%     -    0s
     0     0 -148373.60    0   38 -147907.79 -148373.60  0.31%     -    0s
     0     0 -148288.81    0   23 -147907.79 -148288.81  0.26%     -    0s
     0     0 -148255.54    0   20 -147907.79 -148255.54  0.24%     -    0s
     0     0 -148186.56    0   12 -147907.79 -148186.56  0.19%     -    0s
     0     0 -148167.25    0   38 -147907.79 -148167.25  0.18%     -    0s
     0     0 -148166.01    0   37 -147907.79 -148166.01  0.17%     -    0s
     0     0 -148161.20    0   37 -147907.79 -148161.20  0.17%     -    0s
     0     0 -148158.07    0   23 -147907.79 -148158.07  0.17%     -    0s
     0     0 -148101.50    0   15 -147907.79 -148101.50  0.13%     -    0s
     0     0 -148101.50    0   33 -147907.79 -148101.50  0.13%     -    0s
     0     0 -148071.73    0    9 -147907.79 -148071.73  0.11%     -    0s
     0     0 -148071.67    0    8 -147907.79 -148071.67  0.11%     -    0s
H    0     0                    -147974.8469 -148054.08  0.05%     -    0s
     0     0 -148054.08    0    5 -147974.85 -148054.08  0.05%     -    0s
     0     0 -148053.37    0    5 -147974.85 -148053.37  0.05%     -    0s
H    0     0                    -148021.7442 -148053.37  0.02%     -    0s
*    0     0               0    -148027.2861 -148027.29  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 3
  MIR: 25
  Flow cover: 8
  Relax-and-lift: 3

Explored 1 nodes (795 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -148027 -148022 -147975 ... 1.51186e+13
No other solutions better than -148027

Optimal solution found (tolerance 1.00e-06)
Best objective -1.480272860906e+05, best bound -1.480272860906e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 192883.80
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148027.29
  [DEBUG]   S×d_nominal = 340911.09
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 340911.09 + -148027.29 = 192883.80
  [DEBUG]   Current θ from Master = 203695.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10811.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 41640.51
  Lower Bound (LB) = 45543.29
  Gap (UB-LB) = 6908.8164, Absolute Gap = 6908.8164, Relative Gap = 0.131717
  Not converged yet (gap = 6908.82 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0xe42cdb28
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56780 rows and 23070 columns
Presolve time: 2.42s
Presolved: 66923 rows, 29110 columns, 416939 nonzeros
Variable types: 26851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66923 rows, 29110 columns, 416939 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23478   -1.8203541e+05   0.000000e+00   4.606261e+07      5s
   33196   -5.5463245e+04   0.000000e+00   3.375495e+07     10s
   44726    2.2231362e+04   0.000000e+00   1.453412e+08     15s
   53798    4.3585181e+04   0.000000e+00   4.414224e+08     20s
   61404    5.5130755e+04   0.000000e+00   5.686666e+06     25s
   68634    6.0219747e+04   0.000000e+00   2.997171e+06     30s
   76832    6.2683992e+04   0.000000e+00   8.241587e+06     35s
   82467    6.3455720e+04   0.000000e+00   2.246317e+07     40s
   87826    6.5652546e+04   0.000000e+00   7.539210e+07     45s
   94444    6.8697387e+04   0.000000e+00   8.410344e+06     50s
Concurrent spin time: 1.40s

Solved with dual simplex

Root relaxation: objective 8.169289e+04, 59355 iterations, 53.31 seconds (71.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81692.8859    0  148 -227427.98 81692.8859   136%     -   56s
H    0     0                    -216614.2707 81692.8859   138%     -   56s
H    0     0                    -209153.3550 81692.8859   139%     -   57s
H    0     0                    -208476.4932 81692.8859   139%     -   57s
H    0     0                    -164241.9567 81692.8859   150%     -   57s
H    0     0                    -40580.31021 81692.8859   301%     -   57s
H    0     0                    -40416.21585 81692.8859   302%     -   57s
H    0     0                    16383.922459 81692.8859   399%     -   57s
H    0     0                    24485.193169 81692.8859   234%     -   58s
H    0     0                    25296.179985 81692.8859   223%     -   59s
H    0     0                    27265.721964 81692.8859   200%     -   59s
H    0     0                    27451.686479 81692.8859   198%     -   59s
H    0     0                    27562.922379 81692.8859   196%     -   59s
     0     0 76415.9541    0  224 27562.9224 76415.9541   177%     -   78s
H    0     0                    27580.951464 76415.9541   177%     -   79s
     0     0 76415.9541    0  195 27580.9515 76415.9541   177%     -   85s
     0     0 76415.9541    0  195 27580.9515 76415.9541   177%     -   88s
     0     0 74286.6861    0  192 27580.9515 74286.6861   169%     -   89s
     0     0 74286.5513    0  193 27580.9515 74286.5513   169%     -   90s
     0     0 74219.9328    0  248 27580.9515 74219.9328   169%     -  104s
H    0     0                    34318.325783 74219.7859   116%     -  105s
H    0     0                    34568.949119 74219.7859   115%     -  105s
H    0     0                    34971.324828 74219.7859   112%     -  105s
H    0     0                    35422.368869 74219.7859   110%     -  105s
     0     0 73595.3437    0  256 35422.3689 73595.3437   108%     -  117s
     0     0 73347.7840    0  261 35422.3689 73347.7840   107%     -  123s
     0     0 73132.2710    0  279 35422.3689 73132.2710   106%     -  129s
     0     0 73068.8395    0  279 35422.3689 73068.8395   106%     -  132s
     0     0 73056.3364    0  284 35422.3689 73056.3364   106%     -  133s
     0     0 73049.5320    0  278 35422.3689 73049.5320   106%     -  134s
     0     0 73047.2437    0  280 35422.3689 73047.2437   106%     -  134s
     0     0 73039.6682    0  285 35422.3689 73039.6682   106%     -  135s
     0     0 73038.5407    0  287 35422.3689 73038.5407   106%     -  136s
     0     0 73038.0362    0  287 35422.3689 73038.0362   106%     -  136s
H    0     0                    38747.361331 71312.3012  84.0%     -  162s
H    0     0                    39722.451297 71312.3012  79.5%     -  162s
H    0     0                    40178.695456 71312.3012  77.5%     -  162s
H    0     0                    40474.204785 71312.3012  76.2%     -  162s
H    0     0                    40501.021601 71312.3012  76.1%     -  162s
H    0     0                    40506.694321 71312.3012  76.1%     -  162s
H    0     0                    40990.380475 71312.3012  74.0%     -  162s
H    0     0                    41354.077834 71312.3012  72.4%     -  162s
     0     0 71312.3012    0  368 41354.0778 71312.3012  72.4%     -  162s
H    0     0                    41790.512032 71311.9549  70.6%     -  163s
H    0     0                    41891.630606 71311.9549  70.2%     -  163s
H    0     0                    41958.318137 71311.9549  70.0%     -  163s
     0     0 71054.8187    0  366 41958.3181 71054.8187  69.3%     -  172s
     0     0 70986.9827    0  377 41958.3181 70986.9827  69.2%     -  176s
     0     0 70918.1343    0  379 41958.3181 70918.1343  69.0%     -  180s
     0     0 70877.1206    0  375 41958.3181 70877.1206  68.9%     -  183s
H    0     0                    42715.692301 70854.6098  65.9%     -  186s
H    0     0                    42868.814754 70854.6098  65.3%     -  186s
H    0     0                    43012.640304 70854.6098  64.7%     -  186s
H    0     0                    43158.061249 70854.6098  64.2%     -  186s
H    0     0                    43180.285384 70854.6098  64.1%     -  186s
     0     0 70854.6098    0  375 43180.2854 70854.6098  64.1%     -  186s
H    0     0                    43414.722458 70845.2664  63.2%     -  188s
     0     0 70845.2664    0  375 43414.7225 70845.2664  63.2%     -  188s
     0     0 70837.2092    0  340 43414.7225 70837.2092  63.2%     -  190s
     0     0 70834.6168    0  376 43414.7225 70834.6168  63.2%     -  191s
     0     0 70830.7663    0  375 43414.7225 70830.7663  63.1%     -  192s
     0     0 70829.6941    0  375 43414.7225 70829.6941  63.1%     -  192s
H    0     0                    43857.515869 70295.1230  60.3%     -  209s
H    0     0                    44344.458392 70295.1230  58.5%     -  209s
H    0     0                    44980.386005 70295.1230  56.3%     -  209s
H    0     0                    44993.025514 70295.1230  56.2%     -  209s
     0     0 70295.1230    0  396 44993.0255 70295.1230  56.2%     -  209s
H    0     0                    45043.848639 70294.9845  56.1%     -  210s
     0     0 70151.6403    0  396 45043.8486 70151.6403  55.7%     -  215s
     0     0 70066.7637    0  399 45043.8486 70066.7637  55.6%     -  218s
     0     0 70022.8352    0  387 45043.8486 70022.8352  55.5%     -  222s
     0     0 70004.2375    0  398 45043.8486 70004.2375  55.4%     -  224s
     0     0 69985.2878    0  401 45043.8486 69985.2878  55.4%     -  226s
     0     0 69961.1970    0  403 45043.8486 69961.1970  55.3%     -  228s
     0     0 69950.3060    0  402 45043.8486 69950.3060  55.3%     -  229s
     0     0 69947.3218    0  404 45043.8486 69947.3218  55.3%     -  230s
     0     0 69945.9620    0  407 45043.8486 69945.9620  55.3%     -  230s
     0     0 69944.9462    0  403 45043.8486 69944.9462  55.3%     -  231s
H    0     0                    45181.995463 69801.1216  54.5%     -  238s
H    0     0                    45197.268618 69801.1216  54.4%     -  238s
H    0     0                    45235.666068 69801.1216  54.3%     -  238s
H    0     0                    45322.236027 69801.1216  54.0%     -  238s
     0     0 69801.1216    0  401 45322.2360 69801.1216  54.0%     -  238s
H    0     0                    45391.003237 69801.0332  53.8%     -  239s
H    0     0                    45407.538783 69801.0332  53.7%     -  239s
H    0     0                    45492.188722 69801.0332  53.4%     -  239s
     0     0 69745.0180    0  367 45492.1887 69745.0180  53.3%     -  241s
     0     0 69727.1694    0  408 45492.1887 69727.1694  53.3%     -  243s
     0     0 69718.5586    0  407 45492.1887 69718.5586  53.3%     -  244s
     0     0 69714.5961    0  412 45492.1887 69714.5961  53.2%     -  244s
     0     0 69712.0056    0  406 45492.1887 69712.0056  53.2%     -  245s
     0     0 69711.2120    0  405 45492.1887 69711.2120  53.2%     -  245s
     0     0 69639.6318    0  415 45492.1887 69639.6318  53.1%     -  250s
H    0     0                    45706.727197 69639.2471  52.4%     -  251s
     0     0 69625.1836    0  399 45706.7272 69625.1836  52.3%     -  253s
     0     0 69609.1427    0  422 45706.7272 69609.1427  52.3%     -  255s
     0     0 69605.4320    0  425 45706.7272 69605.4320  52.3%     -  256s
     0     0 69604.3768    0  449 45706.7272 69604.3768  52.3%     -  256s
     0     0 69548.4336    0  421 45706.7272 69548.4336  52.2%     -  260s
H    0     0                    45708.175744 69547.9660  52.2%     -  261s
H    0     0                    45732.323603 69547.9660  52.1%     -  261s
     0     0 69538.7035    0  388 45732.3236 69538.7035  52.1%     -  262s
     0     0 69527.3188    0  386 45732.3236 69527.3188  52.0%     -  263s
     0     0 69524.9051    0  414 45732.3236 69524.9051  52.0%     -  264s
     0     0 69523.3382    0  375 45732.3236 69523.3382  52.0%     -  264s
     0     0 69522.5427    0  423 45732.3236 69522.5427  52.0%     -  265s
     0     0 69515.0484    0  418 45732.3236 69515.0484  52.0%     -  267s
     0     0 69512.5626    0  422 45732.3236 69512.5626  52.0%     -  268s
     0     0 69512.2453    0  419 45732.3236 69512.2453  52.0%     -  268s
     0     0 69508.3057    0  427 45732.3236 69508.3057  52.0%     -  270s
     0     0 69507.8156    0  417 45732.3236 69507.8156  52.0%     -  271s
     0     0 69503.9508    0  426 45732.3236 69503.9508  52.0%     -  273s
H    0     0                    46124.456157 69503.8244  50.7%     -  275s
     0     0 69502.9768    0  430 46124.4562 69502.9768  50.7%     -  275s
     0     0 69494.3199    0  424 46124.4562 69494.3199  50.7%     -  277s
     0     0 69493.3491    0  424 46124.4562 69493.3491  50.7%     -  279s
H    0     0                    46138.785985 69493.3491  50.6%     -  307s
H    0     0                    46198.690329 69493.3491  50.4%     -  307s
H    0     0                    46310.033268 69493.3491  50.1%     -  307s
H    0     0                    46320.920651 69493.3491  50.0%     -  333s
H    0     0                    46344.164765 69493.3491  50.0%     -  333s
H    0     0                    46921.084256 69493.3491  48.1%     -  344s
     0     2 69493.3491    0  424 46921.0843 69493.3491  48.1%     -  345s
     1     4 69415.2970    1  425 46921.0843 69493.3491  48.1%  2424  350s
     3     8 69352.8216    2  373 46921.0843 69415.2471  47.9%  3544  358s
     7    16 69220.4579    3  422 46921.0843 69350.8780  47.8%  4494  370s
    15    32 69049.1426    4  381 46921.0843 69220.0933  47.5%  5958  388s
    31    49 66412.7159    5  341 46921.0843 69084.1282  47.2%  9832  422s
    48    81 67725.0243    6  349 46921.0843 69084.1233  47.2%  9332  445s
H   54    81                    46941.269779 69084.1233  47.2%  8910  445s
H   59    81                    47039.873354 69084.1233  46.9%  8696  445s
H   66    81                    47100.136942 69084.1233  46.7%  8399  445s
H   71    81                    47145.074826 69084.1233  46.5%  8015  445s
    80   114 67682.3301    7  340 47145.0748 69084.1233  46.5%  7537  489s
   113   263 67419.5271    8  337 47145.0748 69084.1233  46.5%  5812  519s
   262   356 67068.3014    9  324 47145.0748 69084.1233  46.5%  3941  533s
   355   387 67137.4867   11  328 47145.0748 69084.1233  46.5%  3559  547s
H  358   387                    48151.839546 69084.1233  43.5%  3537  547s
H  364   387                    48478.358438 69084.1233  42.5%  3516  547s
H  374   387                    48486.205315 69084.1233  42.5%  3467  547s
   386   471 65984.8900   11  264 48486.2053 69084.1233  42.5%  3467  561s
   470   502 66537.0421   11  276 48486.2053 69084.1233  42.5%  3228  574s
   501   551 66774.6957   10  326 48486.2053 69084.1233  42.5%  3189  586s
H  518   551                    48606.491837 69084.1233  42.1%  3146  586s
H  543   551                    49102.466422 69084.1233  40.7%  3151  586s
H  547   551                    49568.994298 69084.1233  39.4%  3135  586s
H  548   551                    50100.270325 69084.1233  37.9%  3130  586s
   550   654 64788.0154   12  274 50100.2703 69084.1233  37.9%  3138  599s
   653   682 65786.7300   12  268 50100.2703 69084.1233  37.9%  2923  610s
   689   726 67119.3825   12  323 50100.2703 69084.1233  37.9%  2924  623s
H  711   726                    50729.154513 69084.1233  36.2%  2951  623s
   735   817 66939.9539   14  312 50729.1545 69084.1233  36.2%  2952  634s
   826   903 66499.0113   17  317 50729.1545 69084.1233  36.2%  2873  647s
   930   969 66157.8679   18  316 50729.1545 69084.1233  36.2%  2771  661s
  1013  1035 64857.5808   18  288 50729.1545 69084.1233  36.2%  2771  675s
  1109  1089 65976.1842   19  315 50729.1545 69084.1233  36.2%  2757  690s
  1189  1117 65877.0779   19  309 50729.1545 69084.1233  36.2%  2758  704s
H 1191  1117                    50990.108591 69084.1233  35.5%  2754  704s
  1221  1199 64826.4504   17  253 50990.1086 69084.1233  35.5%  2814  719s
  1315  1292 65960.0504   20  310 50990.1086 69084.1233  35.5%  2831  732s
  1412  1400 65645.2941   22  303 50990.1086 69084.1233  35.5%  2875  747s
  1540  1498 65199.6155   24  294 50990.1086 69084.1233  35.5%  2848  763s
  1666  1527 64881.1280   25  292 50990.1086 69084.1233  35.5%  2835  777s
H 1702  1527                    50996.637838 69084.1233  35.5%  2858  777s
  1709  1593 62798.4477   25  240 50996.6378 69084.1233  35.5%  2860  794s
  1817  1665 62802.7840   26  246 50996.6378 69084.1233  35.5%  2928  810s
  1941  1683 63319.9256   26  281 50996.6378 69084.1233  35.5%  2940  828s
H 1946  1683                    51623.763530 69084.1233  33.8%  2949  828s
H 1966  1683                    51668.924278 69084.1233  33.7%  2977  828s
H 1967  1683                    51720.117120 69084.1233  33.6%  2976  828s
  1981  1757 63652.8120   25  252 51720.1171 69084.1233  33.6%  2992  846s
H 2097  1834                    51744.400928 69084.1233  33.5%  3001  864s
H 2099  1830                    51786.055971 69084.1233  33.4%  3011  864s
  2204  1917 59700.9983   27  230 51786.0560 69084.1233  33.4%  3048  880s
  2349  2016 61120.4057   29  233 51786.0560 69048.9603  33.3%  3056  899s
  2480  2146 59977.9232   30  182 51786.0560 69009.9208  33.3%  3074  919s
  2646  2299 60408.2523   30  210 51786.0560 69009.9208  33.3%  3050  937s
  2854  2317 58592.1295   35  179 51786.0560 68970.6975  33.2%  2981  956s
  2900  2344 58133.5277   35  178 51786.0560 68970.6975  33.2%  3006  973s
H 2921  2340                    51841.773297 68970.6975  33.0%  3015  973s
H 2937  2398                    51917.020295 68970.6975  32.8%  3030  994s
H 2939  2397                    51961.114850 68970.6975  32.7%  3033  994s
H 2942  2396                    51997.666797 68970.6975  32.6%  3038  994s
H 2975  2395                    52034.728821 68655.3891  31.9%  3047  994s
H 3028  2390                    52128.494453 68655.3891  31.7%  3043  994s
  3037  2558 58399.4703   36  137 52128.4945 68655.3891  31.7%  3044 1015s
  3245  2743 57550.1206   39  134 52128.4945 68655.3891  31.7%  3027 1037s
  3475  2744 65630.5026   13  424 52128.4945 68655.3891  31.7%  2990 1129s
  3477  2745 65744.3627   12  148 52128.4945 68655.3891  31.7%  2988 1167s
  3478  2746 65025.2160   18  278 52128.4945 68655.3891  31.7%  2987 1194s
  3479  2747 57383.4383   64  325 52128.4945 68655.3891  31.7%  2987 1212s
  3480  2747 58896.7570   18  431 52128.4945 68655.3891  31.7%  2986 1225s
  3481  2748 53690.3806   53  369 52128.4945 68655.3891  31.7%  2985 1234s
  3482  2749 65920.5700   29  417 52128.4945 68655.3891  31.7%  2984 1240s
  3483  2749 55076.2291   47  389 52128.4945 68655.3891  31.7%  2983 1246s
  3485  2751 53364.9790   51  408 52128.4945 68655.3891  31.7%  2981 1253s
  3486  2751 53809.0848   34  383 52128.4945 68655.3891  31.7%  2981 1258s
  3487  2752 53168.0247   75  410 52128.4945 68655.3891  31.7%  2980 1261s
H 3487  2614                    52130.574522 68655.3891  31.7%  2980 1262s
  3489  2615 57130.0129   67  422 52130.5745 68655.3891  31.7%  2978 1266s
  3490  2616 65930.5696   13  415 52130.5745 68655.3891  31.7%  2977 1274s
  3491  2617 62610.8835   24  375 52130.5745 68655.3891  31.7%  2976 1279s
  3492  2617 63141.7632   24  379 52130.5745 68655.3891  31.7%  2975 1283s
  3494  2619 55427.6495   89  422 52130.5745 68655.3891  31.7%  2974 1285s
  3496  2620 55457.1829   58  418 52130.5745 68655.3891  31.7%  2972 1296s
  3498  2621 66512.3910    7  428 52130.5745 68655.3891  31.7%  2970 1301s
  3502  2624 56996.2453   29  426 52130.5745 68655.3891  31.7%  2967 1307s
  3503  2625 61374.7101   11  433 52130.5745 68655.3891  31.7%  2966 1319s
  3504  2625 58940.1439   21  443 52130.5745 68655.3891  31.7%  2965 1322s
  3506  2627 57224.5953   11  447 52130.5745 68655.3891  31.7%  2964 1325s
  3508  2628 61168.3167   26  447 52130.5745 68655.3891  31.7%  2962 1331s
  3509  2629 64926.9126   11  457 52130.5745 68655.3891  31.7%  2961 1337s
  3510  2629 54133.0432   26  443 52130.5745 68655.3891  31.7%  2960 1340s
  3513  2631 66469.8818    7  456 52130.5745 68655.3891  31.7%  2958 1359s
  3514  2632 64815.7636   14  427 52130.5745 68655.3891  31.7%  2957 1362s
  3516  2633 56552.9552   23  429 52130.5745 68655.3891  31.7%  2955 1366s
  3517  2634 63629.6764   22  422 52130.5745 68655.3891  31.7%  2954 1371s
  3519  2635 62405.9224   22  438 52130.5745 68655.3891  31.7%  2953 1375s
  3520  2636 64320.7370   11  433 52130.5745 68655.3891  31.7%  2952 1381s
  3522  2637 60314.0594   23  418 52130.5745 68655.3891  31.7%  2950 1391s
  3524  2639 65072.7792   19  483 52130.5745 68655.3891  31.7%  2948 1395s
  3527  2641 54449.5891   30  489 52130.5745 68655.3891  31.7%  2946 1405s
  3530  2643 61603.8564   32  438 52130.5745 68630.5346  31.7%  2943 1414s
  3532  2644 52965.3218   38  448 52130.5745 68626.3220  31.6%  2942 1415s
  3534  2645 63689.9494   17  454 52130.5745 68601.6560  31.6%  2940 1423s
  3535  2646 63260.7013   20  451 52130.5745 68600.1033  31.6%  2939 1426s
  3537  2647 55484.4196   57  496 52130.5745 68587.5888  31.6%  2938 1435s
  3540  2649 55131.5682   22  453 52130.5745 68538.2173  31.5%  2935 1448s
  3542  2651 64442.6280   35  466 52130.5745 68538.2173  31.5%  2933 1450s
  3544  2652 61802.6588   41  444 52130.5745 68526.8402  31.5%  2932 1461s
  3545  2653 53395.9547   40  456 52130.5745 68526.8402  31.5%  2931 1465s
  3546  2653 54908.2418   25  447 52130.5745 68506.9952  31.4%  2930 1473s
  3547  2654 57495.4525   50  447 52130.5745 68505.3432  31.4%  2929 1512s
H 3547  2520                    52153.494515 68505.3432  31.4%  2929 1587s
  3549  2524 68500.6797   13  407 52153.4945 68505.3432  31.4%  2989 1614s
  3551  2528 68478.2627   14  405 52153.4945 68500.2600  31.3%  2991 1635s
  3555  2534 68317.8544   15  399 52153.4945 68476.9277  31.3%  2995 1656s
  3563  2548 68196.0328   16  388 52153.4945 68314.6212  31.0%  3010 1693s
  3579  2558 67095.3745   17  386 52153.4945 68196.0327  30.8%  3064 1741s
  3595  2585 66512.3875   18  362 52153.4945 68196.0327  30.8%  3088 1785s
  3627  2651 66088.0512   19  365 52153.4945 68196.0327  30.8%  3128 1820s
  3704  2745 65363.5160   21  304 52153.4945 68196.0327  30.8%  3195 1854s
  3827  2780 65332.4077   22  305 52153.4945 68196.0327  30.8%  3181 1879s
  3905  2779 64471.4820   23  276 52153.4945 68196.0327  30.8%  3191 1900s
  3941  2801 63471.0100   23  216 52153.4945 68196.0327  30.8%  3206 1915s
H 3965  2666                    52189.496707 68196.0327  30.7%  3207 1915s
  3983  2683 63549.8554   23  255 52189.4967 68196.0327  30.7%  3207 1934s
H 4007  2554                    52207.031453 68196.0327  30.6%  3205 1934s
  4019  2573 62858.6833   24  226 52207.0315 68196.0327  30.6%  3206 1957s
  4113  2573 58071.6109   25  256 52207.0315 68196.0327  30.6%  3181 1981s
  4201  2569 63787.5247   24  320 52207.0315 68196.0327  30.6%  3165 2008s
  4269  2563 63125.5655   25  328 52207.0315 68196.0327  30.6%  3169 2033s
  4334  2558 58038.9102   25  311 52207.0315 67703.1396  29.7%  3174 2052s
  4372  2569 56487.6302   24  269 52207.0315 67684.4140  29.6%  3186 2071s
  4415  2574 58358.6556   24  295 52207.0315 67684.4140  29.6%  3187 2094s
  4466  2590 57040.5948   26  302 52207.0315 67684.4140  29.6%  3185 2117s
  4517  2609 56670.6453   27  311 52207.0315 67684.4140  29.6%  3189 2136s
  4580  2621 56347.1075   28  296 52207.0315 67684.4140  29.6%  3184 2165s
  4644  2615 55941.4259   31  171 52207.0315 67153.4861  28.6%  3175 2187s
H 4679  2489                    52268.699140 67153.4861  28.5%  3169 2187s
  4714  2507 55725.6262   32  164 52268.6991 67075.2227  28.3%  3165 2213s
  4809  2520 54616.8801   36  150 52268.6991 67075.2227  28.3%  3160 2245s
  4903  2536     cutoff   37      52268.6991 67075.2227  28.3%  3161 2271s
  4994  2566 infeasible   31      52268.6991 66803.0702  27.8%  3167 2299s
  5083  2577 65885.7291   18  365 52268.6991 66803.0702  27.8%  3168 2328s
  5199  2578 60886.6348   18  362 52268.6991 66803.0702  27.8%  3163 2359s
  5322  2583 59694.0651   19  353 52268.6991 66501.9225  27.2%  3159 2392s
  5458  2607 59980.4442   20  307 52268.6991 65885.1528  26.1%  3143 2426s
  5573  2611 59162.9482   22  247 52268.6991 65870.0904  26.0%  3146 2458s
  5722  2581 58164.8359   23  258 52268.6991 65870.0904  26.0%  3136 2478s
  5763  2574 58106.9941   24  234 52268.6991 65870.0904  26.0%  3136 2503s
  5820  2567 57483.8791   25  279 52268.6991 65136.4140  24.6%  3140 2531s
  5894  2580 55260.9289   26  223 52268.6991 65033.0185  24.4%  3142 2567s
  5990  2598 55378.5887   27  235 52268.6991 65033.0185  24.4%  3149 2601s
  6111  2599 54791.2375   27  232 52268.6991 64983.4008  24.3%  3156 2641s
  6268  2570 53331.7352   31  196 52268.6991 64819.6661  24.0%  3149 2685s
  6427  2583 62185.0746   20  339 52268.6991 64431.0085  23.3%  3154 2726s
  6546  2584 54659.2250   23  306 52268.6991 64431.0085  23.3%  3178 2764s
  6737  2541 53418.9764   29  136 52268.6991 64431.0085  23.3%  3173 2813s
  6965  2485 56845.5682   24  201 52268.6991 64186.6045  22.8%  3157 2847s
H 6976  2372                    52304.645194 64186.6045  22.7%  3160 2847s
  7005  2443 55077.2222   25  197 52304.6452 64186.6045  22.7%  3170 2893s
  7204  2409 infeasible   34      52304.6452 63883.5725  22.1%  3171 2947s
  7428  2412 57444.1700   20  256 52304.6452 63755.0433  21.9%  3166 3000s
  7641  2379 53482.7854   26  197 52304.6452 63678.4355  21.7%  3170 3051s
  7863  2336 52792.2793   28  161 52304.6452 63249.9663  20.9%  3175 3107s
  8084  2279 55044.5694   24  233 52304.6452 63238.2943  20.9%  3184 3148s
  8140  2288 53774.3167   25  247 52304.6452 63238.2943  20.9%  3187 3194s
  8298  2273     cutoff   28      52304.6452 62985.8041  20.4%  3182 3251s
  8594  2239 53600.7071   24  260 52304.6452 62829.4940  20.1%  3169 3316s
  8848  2238     cutoff   25      52304.6452 62584.0698  19.7%  3183 3380s
  9171  2155 54900.6233   25  342 52304.6452 62558.2356  19.6%  3167 3431s
  9234  2151 53780.4291   26  315 52304.6452 62509.1895  19.5%  3168 3485s
  9316  2152 52820.9097   27  291 52304.6452 62509.1895  19.5%  3171 3542s
  9443  2142 52686.8038   28  256 52304.6452 62492.2131  19.5%  3165 3600s

Cutting planes:
  Learned: 2
  Implied bound: 3
  MIR: 815
  Mixing: 2
  Flow cover: 2716
  RLT: 50
  Relax-and-lift: 205

Explored 9769 nodes (30920875 simplex iterations) in 3600.08 seconds (6437.60 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 52304.6 52268.7 52207 ... 51961.1

Time limit reached
Best objective 5.230464519396e+04, best bound 6.248236372074e+04, gap 19.4585%
  WARNING: Time limit reached. Using best solution found (gap: 19.46%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 52304.65, θ = 202243.02
  Upper Bound (UB) = 52304.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202243.02
  [DEBUG]   ✓ Scenario 0: θ = 202243.02 ≤ Q = 202243.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 202243.02 ≤ Q = 202243.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 202243.02 ≤ Q = 202243.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 202243.02 ≤ Q = 202243.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 202243.02 ≤ Q = 202243.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 202243.02 ≤ Q = 202243.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 202243.02 ≤ Q = 202243.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 202243.02 ≤ Q = 202243.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x157ed0a5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x157ed0a5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-14, 2e+02]
Found heuristic solution: objective 1.513816e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7303620.4866
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.702371e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -170237.07    0  124 7303620.49 -170237.07   102%     -    0s
H    0     0                    -135213.4525 -170237.07  25.9%     -    0s
H    0     0                    -135476.7051 -170237.07  25.7%     -    0s
H    0     0                    -136679.6490 -152227.35  11.4%     -    0s
     0     0 -152227.35    0  104 -136679.65 -152227.35  11.4%     -    0s
H    0     0                    -148498.0272 -152195.71  2.49%     -    0s
H    0     0                    -149287.4336 -152195.71  1.95%     -    0s
H    0     0                    -149592.5671 -152195.71  1.74%     -    0s
H    0     0                    -149623.8656 -151071.28  0.97%     -    0s
     0     0 -151071.28    0  103 -149623.87 -151071.28  0.97%     -    0s
     0     0 -150919.98    0  102 -149623.87 -150919.98  0.87%     -    0s
     0     0 -150446.43    0   55 -149623.87 -150446.43  0.55%     -    0s
H    0     0                    -149788.9310 -150393.50  0.40%     -    0s
     0     0 -150393.50    0   42 -149788.93 -150393.50  0.40%     -    0s
     0     0 -150387.97    0   41 -149788.93 -150387.97  0.40%     -    0s
     0     0 -150204.91    0   47 -149788.93 -150204.91  0.28%     -    0s
     0     0 -150203.42    0   36 -149788.93 -150203.42  0.28%     -    0s
     0     0 -150102.98    0   47 -149788.93 -150102.98  0.21%     -    0s
     0     0 -150076.44    0   47 -149788.93 -150076.44  0.19%     -    0s
H    0     0                    -149808.8863 -150076.44  0.18%     -    0s
     0     0 -150076.44    0   68 -149808.89 -150076.44  0.18%     -    0s
     0     0 -150076.44    0   44 -149808.89 -150076.44  0.18%     -    0s
H    0     0                    -149810.6516 -150076.44  0.18%     -    0s
     0     0 -150061.20    0   46 -149810.65 -150061.20  0.17%     -    0s
     0     0 -150027.31    0   43 -149810.65 -150027.31  0.14%     -    0s
     0     0 -150025.16    0   43 -149810.65 -150025.16  0.14%     -    0s
     0     0 -150024.32    0   43 -149810.65 -150024.32  0.14%     -    0s
H    0     0                    -149844.4342 -150024.32  0.12%     -    0s
     0     0 -149963.06    0   19 -149844.43 -149963.06  0.08%     -    0s
     0     0 -149950.15    0   19 -149844.43 -149950.15  0.07%     -    0s
     0     0 -149943.57    0   12 -149844.43 -149943.57  0.07%     -    0s
     0     0 -149937.20    0   10 -149844.43 -149937.20  0.06%     -    0s
     0     0 -149922.29    0    8 -149844.43 -149922.29  0.05%     -    0s
     0     0 -149889.37    0    8 -149844.43 -149889.37  0.03%     -    0s
     0     0 -149889.37    0   14 -149844.43 -149889.37  0.03%     -    0s
H    0     0                    -149848.0154 -149889.37  0.03%     -    0s
H    0     0                    -149857.7764 -149858.35  0.00%     -    0s
     0     0 -149858.35    0    4 -149857.78 -149858.35  0.00%     -    0s
     0     0     cutoff    0      -149857.78 -149857.78  0.00%     -    0s

Cutting planes:
  Gomory: 9
  MIR: 3
  Flow cover: 1
  Relax-and-lift: 8

Explored 1 nodes (1201 simplex iterations) in 0.23 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -149858 -149848 -149844 ... -136680
No other solutions better than -149858

Optimal solution found (tolerance 1.00e-06)
Best objective -1.498577763617e+05, best bound -1.498577763617e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 191769.37
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149857.78
  [DEBUG]   S×d_nominal = 341627.14
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341627.14 + -149857.78 = 191769.37
  [DEBUG]   Current θ from Master = 202243.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10473.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 41830.99
  Lower Bound (LB) = 45543.29
  Gap (UB-LB) = 6761.3511, Absolute Gap = 6761.3511, Relative Gap = 0.129269
  Not converged yet (gap = 6761.35 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x4d85d755
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63870 rows and 25950 columns
Presolve time: 2.44s
Presolved: 75123 rows, 32470 columns, 468389 nonzeros
Variable types: 30211 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75123 rows, 32470 columns, 468389 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25358   -1.8596004e+05   0.000000e+00   1.145303e+07      5s
   39516   -7.4713720e+03   0.000000e+00   1.547466e+07     10s
   49435    3.4246162e+04   0.000000e+00   3.408869e+08     15s
   58055    4.5829817e+04   0.000000e+00   1.674927e+07     20s
   65716    5.6120167e+04   0.000000e+00   3.306621e+06     25s
   73596    6.3450863e+04   0.000000e+00   5.356024e+08     30s
   81242    6.6655217e+04   0.000000e+00   4.114462e+07     35s
   87744    6.7665079e+04   0.000000e+00   5.497364e+06     40s
   95135    6.9720437e+04   0.000000e+00   1.451346e+06     45s
  101655    7.1867297e+04   0.000000e+00   1.622014e+07     50s
  107661    7.2841036e+04   0.000000e+00   4.599407e+07     55s
Concurrent spin time: 2.63s

Solved with dual simplex

Root relaxation: objective 8.162922e+04, 63863 iterations, 57.04 seconds (80.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81629.2186    0  146 -227427.98 81629.2186   136%     -   60s
H    0     0                    -213180.4164 81629.2186   138%     -   60s
H    0     0                    -133708.2099 81629.2186   161%     -   61s
H    0     0                    -115722.1978 81629.2186   171%     -   61s
H    0     0                    -115434.2533 81629.2186   171%     -   61s
H    0     0                    -114662.4975 81629.2186   171%     -   61s
H    0     0                    -114512.9972 81629.2186   171%     -   61s
H    0     0                    -114290.8249 81629.2186   171%     -   61s
H    0     0                    -37961.45698 81629.2186   315%     -   61s
H    0     0                    -36945.92279 81629.2186   321%     -   61s
H    0     0                    16352.532185 81629.2186   399%     -   61s
H    0     0                    23408.923646 81629.2186   249%     -   62s
H    0     0                    26706.715207 81629.2186   206%     -   63s
H    0     0                    27451.686479 81629.2186   197%     -   63s
     0     0 76812.4418    0  240 27451.6865 76812.4418   180%     -   80s
H    0     0                    27469.715565 76812.1128   180%     -   80s
     0     0 76561.2680    0  239 27469.7156 76561.2680   179%     -   85s
     0     0 76522.1351    0  245 27469.7156 76522.1351   179%     -   89s
     0     0 76522.1351    0  244 27469.7156 76522.1351   179%     -   90s
     0     0 76521.9294    0  244 27469.7156 76521.9294   179%     -   91s
     0     0 76521.9294    0  244 27469.7156 76521.9294   179%     -   91s
     0     0 73635.6890    0  236 27469.7156 73635.6890   168%     -  109s
H    0     0                    32302.188878 73635.6890   128%     -  109s
H    0     0                    37202.114444 73635.6890  97.9%     -  109s
H    0     0                    37452.737780 73635.6890  96.6%     -  109s
H    0     0                    38194.921629 73635.6890  92.8%     -  109s
H    0     0                    38306.157529 73635.6890  92.2%     -  109s
     0     0 73086.9927    0  251 38306.1575 73086.9927  90.8%     -  123s
     0     0 72916.0165    0  258 38306.1575 72916.0165  90.4%     -  131s
     0     0 72877.0616    0  271 38306.1575 72877.0616  90.2%     -  135s
     0     0 72857.8669    0  273 38306.1575 72857.8669  90.2%     -  137s
     0     0 72848.2893    0  273 38306.1575 72848.2893  90.2%     -  139s
     0     0 72843.9353    0  271 38306.1575 72843.9353  90.2%     -  140s
     0     0 72841.8435    0  271 38306.1575 72841.8435  90.2%     -  141s
     0     0 72763.0740    0  271 38306.1575 72763.0740  90.0%     -  146s
     0     0 72756.8841    0  275 38306.1575 72756.8841  89.9%     -  147s
     0     0 72755.7756    0  275 38306.1575 72755.7756  89.9%     -  148s
     0     0 72755.4223    0  275 38306.1575 72755.4223  89.9%     -  148s
H    0     0                    38995.047398 71416.8433  83.1%     -  183s
H    0     0                    39035.993055 71416.8433  83.0%     -  183s
H    0     0                    39189.451619 71416.8433  82.2%     -  183s
H    0     0                    39511.689151 71416.8433  80.7%     -  183s
H    0     0                    39839.797693 71416.8433  79.3%     -  183s
H    0     0                    39844.556352 71416.8433  79.2%     -  183s
     0     0 71416.8433    0  353 39844.5564 71416.8433  79.2%     -  183s
H    0     0                    39978.913811 71415.9307  78.6%     -  184s
H    0     0                    40182.364791 71415.9307  77.7%     -  184s
     0     0 70848.8716    0  375 40182.3648 70848.8716  76.3%     -  200s
     0     0 70682.7257    0  373 40182.3648 70682.7257  75.9%     -  208s
H    0     0                    41556.268343 70604.2914  69.9%     -  214s
H    0     0                    42376.881946 70604.2914  66.6%     -  214s
H    0     0                    42802.486640 70604.2914  65.0%     -  214s
H    0     0                    42859.873891 70604.2914  64.7%     -  214s
H    0     0                    43465.727594 70604.2914  62.4%     -  214s
H    0     0                    43716.861281 70604.2914  61.5%     -  214s
H    0     0                    44487.196551 70604.2914  58.7%     -  214s
H    0     0                    44544.588495 70604.2914  58.5%     -  214s
H    0     0                    44676.770995 70604.2914  58.0%     -  214s
     0     0 70604.2914    0  373 44676.7710 70604.2914  58.0%     -  214s
     0     0 70573.2383    0  380 44676.7710 70573.2383  58.0%     -  216s
H    0     0                    44792.263620 70502.4845  57.4%     -  221s
     0     0 70502.4845    0  378 44792.2636 70502.4845  57.4%     -  221s
     0     0 70472.8946    0  382 44792.2636 70472.8946  57.3%     -  224s
     0     0 70462.7624    0  376 44792.2636 70462.7624  57.3%     -  225s
     0     0 70454.9517    0  383 44792.2636 70454.9517  57.3%     -  226s
     0     0 70451.9918    0  382 44792.2636 70451.9918  57.3%     -  227s
     0     0 70451.1460    0  385 44792.2636 70451.1460  57.3%     -  228s
H    0     0                    44924.956930 70070.5284  56.0%     -  251s
H    0     0                    45043.856008 70070.5284  55.6%     -  251s
H    0     0                    45136.421905 70070.5284  55.2%     -  251s
H    0     0                    45228.446076 70070.5284  54.9%     -  251s
H    0     0                    45479.345872 70070.5284  54.1%     -  251s
H    0     0                    45507.731576 70070.5284  54.0%     -  251s
H    0     0                    45673.916502 70070.5284  53.4%     -  251s
     0     0 70070.5284    0  389 45673.9165 70070.5284  53.4%     -  252s
H    0     0                    45874.329280 70070.4834  52.7%     -  252s
H    0     0                    45875.841781 70070.4834  52.7%     -  252s
H    0     0                    45888.271311 70070.4834  52.7%     -  252s
H    0     0                    45895.841635 70070.4834  52.7%     -  252s
H    0     0                    46036.571671 70070.4834  52.2%     -  252s
     0     0 69976.4866    0  398 46036.5717 69976.4866  52.0%     -  258s
     0     0 69920.6961    0  394 46036.5717 69920.6961  51.9%     -  263s
     0     0 69887.1787    0  405 46036.5717 69887.1787  51.8%     -  266s
     0     0 69874.2078    0  399 46036.5717 69874.2078  51.8%     -  267s
     0     0 69851.5257    0  404 46036.5717 69851.5257  51.7%     -  269s
     0     0 69846.6836    0  401 46036.5717 69846.6836  51.7%     -  270s
     0     0 69837.1998    0  411 46036.5717 69837.1998  51.7%     -  271s
     0     0 69836.3236    0  413 46036.5717 69836.3236  51.7%     -  272s
     0     0 69724.2373    0  406 46036.5717 69724.2373  51.5%     -  279s
     0     0 69707.6514    0  406 46036.5717 69707.6514  51.4%     -  282s
     0     0 69695.5419    0  408 46036.5717 69695.5419  51.4%     -  283s
     0     0 69691.0661    0  411 46036.5717 69691.0661  51.4%     -  286s
     0     0 69689.8241    0  414 46036.5717 69689.8241  51.4%     -  287s
     0     0 69645.4214    0  415 46036.5717 69645.4214  51.3%     -  294s
H    0     0                    46107.747664 69645.2197  51.0%     -  295s
H    0     0                    46416.766958 69645.2197  50.0%     -  295s
     0     0 69627.2509    0  416 46416.7670 69627.2509  50.0%     -  297s
     0     0 69622.8466    0  421 46416.7670 69622.8466  50.0%     -  299s
     0     0 69621.3123    0  425 46416.7670 69621.3123  50.0%     -  299s
     0     0 69615.1084    0  427 46416.7670 69615.1084  50.0%     -  300s
     0     0 69607.0348    0  429 46416.7670 69607.0348  50.0%     -  301s
     0     0 69602.7368    0  422 46416.7670 69602.7368  50.0%     -  302s
     0     0 69584.7119    0  419 46416.7670 69584.7119  49.9%     -  304s
     0     0 69569.1438    0  433 46416.7670 69569.1438  49.9%     -  306s
     0     0 69565.0752    0  440 46416.7670 69565.0752  49.9%     -  306s
     0     0 69561.2161    0  435 46416.7670 69561.2161  49.9%     -  307s
     0     0 69560.4337    0  435 46416.7670 69560.4337  49.9%     -  307s
     0     0 69457.4295    0  436 46416.7670 69457.4295  49.6%     -  315s
     0     0 69446.6369    0  441 46416.7670 69446.6369  49.6%     -  317s
     0     0 69444.0436    0  437 46416.7670 69444.0436  49.6%     -  318s
     0     0 69440.8767    0  441 46416.7670 69440.8767  49.6%     -  319s
     0     0 69440.6742    0  443 46416.7670 69440.6742  49.6%     -  320s
     0     0 69378.5194    0  424 46416.7670 69378.5194  49.5%     -  324s
H    0     0                    46519.795948 69378.3799  49.1%     -  325s
H    0     0                    46637.943194 69378.3799  48.8%     -  325s
H    0     0                    46833.511870 69378.3799  48.1%     -  325s
H    0     0                    46836.708628 69378.3799  48.1%     -  336s
     0     0 69369.0626    0  430 46836.7086 69369.0626  48.1%     -  337s
     0     0 69362.9077    0  434 46836.7086 69362.9077  48.1%     -  339s
     0     0 69361.5468    0  433 46836.7086 69361.5468  48.1%     -  340s
     0     0 69356.4101    0  437 46836.7086 69356.4101  48.1%     -  342s
     0     0 69353.1358    0  436 46836.7086 69353.1358  48.1%     -  344s
     0     0 69351.4597    0  432 46836.7086 69351.4597  48.1%     -  345s
     0     0 69350.4009    0  432 46836.7086 69350.4009  48.1%     -  345s
     0     0 69324.2386    0  434 46836.7086 69324.2386  48.0%     -  349s
H    0     0                    46959.407051 69324.0199  47.6%     -  350s
     0     0 69316.0049    0  443 46959.4071 69316.0049  47.6%     -  352s
     0     0 69314.1253    0  443 46959.4071 69314.1253  47.6%     -  353s
     0     0 69313.7831    0  443 46959.4071 69313.7831  47.6%     -  353s
     0     0 69309.8786    0  444 46959.4071 69309.8786  47.6%     -  355s
     0     0 69309.2074    0  442 46959.4071 69309.2074  47.6%     -  357s
     0     0 69307.0566    0  440 46959.4071 69307.0566  47.6%     -  359s
     0     0 69306.3689    0  440 46959.4071 69306.3689  47.6%     -  361s
     0     0 69281.4018    0  439 46959.4071 69281.4018  47.5%     -  365s
     0     0 69275.9750    0  438 46959.4071 69275.9750  47.5%     -  367s
     0     0 69274.7378    0  441 46959.4071 69274.7378  47.5%     -  367s
     0     0 69271.3771    0  436 46959.4071 69271.3771  47.5%     -  369s
H    0     0                    47050.027857 69268.3535  47.2%     -  370s
H    0     0                    47098.918407 69268.3535  47.1%     -  370s
     0     0 69268.3535    0  431 47098.9184 69268.3535  47.1%     -  371s
     0     0 69268.2424    0  431 47098.9184 69268.2424  47.1%     -  372s
     0     0 69264.5872    0  437 47098.9184 69264.5872  47.1%     -  374s
     0     0 69262.8692    0  440 47098.9184 69262.8692  47.1%     -  375s
     0     0 69262.1379    0  441 47098.9184 69262.1379  47.1%     -  375s
     0     0 69247.3105    0  439 47098.9184 69247.3105  47.0%     -  378s
     0     0 69236.6476    0  440 47098.9184 69236.6476  47.0%     -  382s
     0     0 69234.7170    0  448 47098.9184 69234.7170  47.0%     -  383s
     0     0 69234.1549    0  448 47098.9184 69234.1549  47.0%     -  383s
     0     0 69227.1612    0  445 47098.9184 69227.1612  47.0%     -  386s
     0     0 69223.2389    0  445 47098.9184 69223.2389  47.0%     -  387s
     0     0 69222.4038    0  442 47098.9184 69222.4038  47.0%     -  388s
     0     0 69214.5193    0  447 47098.9184 69214.5193  47.0%     -  390s
H    0     0                    47317.428654 69214.4732  46.3%     -  392s
     0     0 69211.8442    0  443 47317.4287 69211.8442  46.3%     -  393s
     0     0 69210.3186    0  442 47317.4287 69210.3186  46.3%     -  394s
     0     0 69208.5956    0  397 47317.4287 69208.5956  46.3%     -  394s
     0     0 69207.3512    0  434 47317.4287 69207.3512  46.3%     -  395s
     0     0 69200.9230    0  436 47317.4287 69200.9230  46.2%     -  399s
     0     0 69199.1961    0  445 47317.4287 69199.1961  46.2%     -  400s
     0     0 69198.8430    0  445 47317.4287 69198.8430  46.2%     -  401s
     0     0 69197.1044    0  441 47317.4287 69197.1044  46.2%     -  403s
     0     0 69196.6828    0  441 47317.4287 69196.6828  46.2%     -  405s
H    0     0                    47365.280274 69196.6828  46.1%     -  491s
     0     2 69196.6828    0  441 47365.2803 69196.6828  46.1%     -  499s
     1     4 69106.4808    1  431 47365.2803 69196.6828  46.1%  2693  512s
     3     8 69044.1801    2  422 47365.2803 69105.7112  45.9%  6247  522s
     7    16 68840.3265    3  387 47365.2803 69050.5276  45.8%  5896  533s
    15    32 68616.6057    4  392 47365.2803 68981.3582  45.6%  6726  553s
    31    48 68048.1307    5  417 47365.2803 68914.5182  45.5% 11140  583s
    47    80 67866.4983    6  372 47365.2803 68914.5182  45.5%  9675  605s
    79   112 67855.8147    7  361 47365.2803 68914.5182  45.5%  7273  623s
H   82   112                    47572.744412 68914.5182  44.9%  7051  623s
   111   249 67836.6158    8  366 47572.7444 68914.5182  44.9%  5632  651s
   248   327 67825.7496    9  367 47572.7444 68914.5182  44.9%  3948  666s
   326   392 67792.0620   10  366 47572.7444 68914.5182  44.9%  3681  683s
H  363   392                    47734.916228 68914.5182  44.4%  3627  683s
   391   465 67680.8679   10  355 47734.9162 68914.5182  44.4%  3609  699s
   464   534 67672.1429   11  348 47734.9162 68914.5182  44.4%  3566  713s
   533   630 67305.3205   10  327 47734.9162 68914.5182  44.4%  3464  727s
   629   662 67524.0496   11  351 47734.9162 68914.5182  44.4%  3207  739s
   661   694 67596.1497   11  353 47734.9162 68914.5182  44.4%  3167  769s
   693   726 67577.8443   12  353 47734.9162 68914.5182  44.4%  3097  776s
H  709   726                    48225.920125 68914.5182  42.9%  3070  776s
   725   828 67535.2224   11  341 48225.9201 68914.5182  42.9%  3045  792s
   827   942 66324.9950   12  326 48225.9201 68914.5182  42.9%  2849  805s
   943   984 67456.1234   12  345 48225.9201 68914.5182  42.9%  2663  836s
   991  1055 67488.5280   12  356 48225.9201 68914.5182  42.9%  2590  852s
H 1018  1055                    49286.938752 68914.5182  39.8%  2586  852s
  1075  1140 67307.4584   12  329 49286.9388 68914.5182  39.8%  2529  869s
  1188  1168 67538.8980   13  391 49286.9388 68914.5182  39.8%  2418  882s
  1222  1202 67353.3311   13  341 49286.9388 68914.5182  39.8%  2415  898s
H 1255  1202                    50048.603757 68914.5182  37.7%  2435  898s
  1262  1284 67231.2910   12  336 50048.6038 68914.5182  37.7%  2445  914s
  1378  1412 66086.4927   13  329 50048.6038 68914.5182  37.7%  2375  931s
  1520  1564 65771.9289   13  320 50048.6038 68914.5182  37.7%  2278  949s
  1680  1707 67295.5974   14  332 50048.6038 68914.5182  37.7%  2192  967s
  1849  1882 66556.2559   14  278 50048.6038 68914.5182  37.7%  2090  985s
  2030  2069 67212.6339   14  354 50048.6038 68914.5182  37.7%  1986 1002s
  2250  2178 64686.8209   15  243 50048.6038 68914.5182  37.7%  1887 1016s
H 2251  2177                    50074.620619 68914.5182  37.6%  1886 1016s
H 2266  2172                    50563.917630 68914.5182  36.3%  1876 1016s
  2403  2339 66928.1628   16  379 50563.9176 68591.7303  35.7%  1814 1035s
  2606  2478 61643.7057   16  242 50563.9176 68591.7303  35.7%  1765 1055s
  2777  2612 66828.2063   17  362 50563.9176 68591.7303  35.7%  1735 1075s
  2975  2720 66603.2159   20  319 50563.9176 68591.7303  35.7%  1703 1096s
  3135  2863 65341.4045   22  298 50563.9176 68591.7303  35.7%  1713 1122s
  3332  2924 63955.0964   21  265 50563.9176 68591.7303  35.7%  1707 1144s
H 3403  2914                    50812.146288 68591.7303  35.0%  1722 1172s
  3404  2915 55480.4094   51  441 50812.1463 68591.7303  35.0%  1722 1264s
  3406  2916 61641.3247   17  146 50812.1463 68591.7303  35.0%  1721 1351s
  3407  2917 53237.7022  107  324 50812.1463 68591.7303  35.0%  1720 1395s
  3408  2918 67073.8471   13  296 50812.1463 68591.7303  35.0%  1720 1413s
  3409  2918 53054.2211  107  356 50812.1463 68591.7303  35.0%  1719 1432s
  3410  2919 66322.0890   10  401 50812.1463 68591.7303  35.0%  1719 1442s
  3411  2920 53649.9518   83  359 50812.1463 68591.7303  35.0%  1718 1452s
  3412  2920 60798.6099   31  407 50812.1463 68591.7303  35.0%  1718 1461s
  3413  2921 54093.9317   94  411 50812.1463 68591.7303  35.0%  1717 1470s
  3414  2922 59821.0394   23  414 50812.1463 68591.7303  35.0%  1717 1481s
H 3414  2775                    50838.077764 68591.7303  34.9%  1717 1487s
  3416  2776 56972.7143   43  378 50838.0778 68591.7303  34.9%  1716 1494s
  3417  2777 64112.6949   22  440 50838.0778 68591.7303  34.9%  1715 1501s
  3418  2777 62755.5303   36  437 50838.0778 68591.7303  34.9%  1715 1505s
  3420  2779 60034.6876   50  438 50838.0778 68591.7303  34.9%  1714 1510s
  3423  2781 56146.8527   63  445 50838.0778 68591.7303  34.9%  1712 1515s
  3424  2781 61720.5802   23  429 50838.0778 68591.7303  34.9%  1712 1526s
  3425  2782 61554.2561   52  422 50838.0778 68591.7303  34.9%  1711 1535s
  3427  2783 66511.4486   13  433 50838.0778 68591.7303  34.9%  1710 1544s
  3428  2784 55699.3746   76  432 50838.0778 68591.7303  34.9%  1710 1546s
  3430  2785 65701.2655   18  428 50838.0778 68591.7303  34.9%  1709 1550s
  3432  2787 64613.1666   29  430 50838.0778 68591.7303  34.9%  1708 1555s
  3433  2787 55482.5439   91  386 50838.0778 68591.7303  34.9%  1707 1564s
  3434  2788 67372.5848   13  381 50838.0778 68591.7303  34.9%  1707 1567s
  3435  2789 56695.9019   34  430 50838.0778 68591.7303  34.9%  1706 1571s
H 3436  2649                    50896.203763 68591.7303  34.8%  1706 1575s
  3438  2651 63051.9476   18  437 50896.2038 68591.7303  34.8%  1705 1581s
  3440  2652 52569.2995   55  440 50896.2038 68591.7303  34.8%  1704 1585s
  3441  2653 53106.5819   47  436 50896.2038 68591.7303  34.8%  1703 1591s
  3443  2654 65640.3571   25  425 50896.2038 68591.7303  34.8%  1702 1595s
  3444  2655 64174.7443   12  438 50896.2038 68591.7303  34.8%  1702 1602s
  3446  2656 52966.0836  110  433 50896.2038 68591.7303  34.8%  1701 1606s
  3448  2657 55559.5763   51  440 50896.2038 68591.7303  34.8%  1700 1617s
  3450  2659 65906.5753   23  445 50896.2038 68591.7303  34.8%  1699 1622s
H 3450  2525                    50918.808747 68591.7303  34.7%  1699 1628s
  3452  2526 54037.4232   28  449 50918.8087 68591.7303  34.7%  1698 1631s
  3453  2527 62359.2289   39  450 50918.8087 68591.7303  34.7%  1698 1637s
  3454  2527 57228.9871   68  451 50918.8087 68591.7303  34.7%  1697 1640s
  3455  2528 59763.2255   52  429 50918.8087 68591.7303  34.7%  1697 1645s
  3457  2529 54567.7379   31  458 50918.8087 68591.7303  34.7%  1696 1656s
  3458  2530 54959.9898   72  458 50918.8087 68591.7303  34.7%  1695 1727s
  3459  2531 60128.6085   47  458 50918.8087 68591.7303  34.7%  1695 1828s
  3460  2534 68591.7303   14  432 50918.8087 68591.7303  34.7%  1770 1854s
  3462  2538 68565.3541   15  427 50918.8087 68591.7303  34.7%  1771 1885s
  3466  2544 68396.1819   16  422 50918.8087 68565.3000  34.7%  1779 1922s
  3474  2558 68110.1007   17  422 50918.8087 68395.8747  34.3%  1799 1959s
  3490  2568 66000.6968   18  361 50918.8087 68110.0698  33.8%  1850 2024s
  3506  2595 65002.7289   19  402 50918.8087 68110.0698  33.8%  1904 2066s
H 3512  2466                    51057.243395 68110.0698  33.4%  1915 2066s
  3538  2572 63550.0466   20  352 51057.2434 68110.0698  33.4%  1962 2109s
  3653  2575 62951.4107   23  346 51057.2434 68110.0698  33.4%  2107 2131s
  3694  2623 60756.4735   23  272 51057.2434 68110.0698  33.4%  2122 2155s
  3758  2651 63099.1695   22  362 51057.2434 68110.0698  33.4%  2148 2182s
  3813  2672 62220.7751   26  209 51057.2434 68110.0698  33.4%  2180 2210s
  3863  2710 61660.3211   28  248 51057.2434 68110.0698  33.4%  2220 2235s
H 3869  2587                    51183.143967 68110.0698  33.1%  2222 2235s
  3928  2619 55710.9985   31  238 51183.1440 68110.0698  33.1%  2236 2260s
  4011  2631 56447.4886   29  209 51183.1440 68110.0698  33.1%  2241 2294s
H 4012  2515                    51212.612406 68110.0698  33.0%  2240 2294s
  4089  2510 56314.1508   28  199 51212.6124 68110.0698  33.0%  2253 2326s
  4162  2513 55817.0845   29  264 51212.6124 68110.0698  33.0%  2266 2354s
H 4184  2396                    51276.110243 68110.0698  32.8%  2265 2354s
  4240  2401 60376.7821   27  208 51276.1102 68110.0698  32.8%  2271 2376s
  4308  2396 55848.1917   30  202 51276.1102 68110.0698  32.8%  2281 2397s
  4342  2409 55503.2893   30  206 51276.1102 68110.0698  32.8%  2296 2417s
  4390  2412 56003.1926   29  202 51276.1102 68110.0698  32.8%  2304 2436s
  4425  2415 55645.1004   30  212 51276.1102 68110.0698  32.8%  2304 2456s
  4479  2417 55421.3280   31  179 51276.1102 68110.0698  32.8%  2308 2475s
H 4483  2312                    51320.701597 68110.0698  32.7%  2307 2475s
H 4512  2204                    51347.096403 68110.0698  32.6%  2309 2475s
  4523  2239 55131.9051   32  162 51347.0964 68110.0698  32.6%  2313 2503s
  4630  2229 53968.4729   34  127 51347.0964 68110.0698  32.6%  2316 2531s
  4767  2229     cutoff   34      51347.0964 68110.0698  32.6%  2295 2566s
  4896  2208 52170.6760   36  105 51347.0964 68110.0698  32.6%  2294 2599s
  4998  2198 61236.8109   22  242 51347.0964 68110.0698  32.6%  2300 2634s
  5062  2216 56582.8789   24  258 51347.0964 67811.2372  32.1%  2329 2673s
  5123  2259 56075.5731   25  262 51347.0964 67811.2372  32.1%  2364 2704s
  5199  2278 54258.5078   28  244 51347.0964 67811.2372  32.1%  2398 2737s
  5295  2286     cutoff   29      51347.0964 67811.2372  32.1%  2419 2772s
  5407  2290 51525.5828   32  179 51347.0964 67811.2372  32.1%  2443 2810s
  5523  2305     cutoff   23      51347.0964 67811.2372  32.1%  2462 2849s
  5634  2320     cutoff   28      51347.0964 67160.4893  30.8%  2483 2894s
  5744  2349 66647.2755   20  418 51347.0964 67155.9341  30.8%  2509 2939s
  5868  2352 60431.1495   21  404 51347.0964 67155.9341  30.8%  2534 2984s
  5976  2383 59149.9432   23  361 51347.0964 67155.9341  30.8%  2568 3032s
  6120  2395 57711.5401   25  232 51347.0964 67155.9341  30.8%  2578 3081s
  6272  2434 55422.0576   27  205 51347.0964 67155.9341  30.8%  2597 3134s
  6411  2429 53923.2500   29  282 51347.0964 67155.9341  30.8%  2625 3174s
H 6420  2332                    51760.061503 67155.9341  29.7%  2629 3174s
  6509  2385 53827.6634   30  234 51760.0615 67155.9341  29.7%  2646 3224s
  6715  2335     cutoff   34      51760.0615 64744.6393  25.1%  2652 3260s
H 6721  2244                    51787.087096 64580.6010  24.7%  2654 3260s
H 6726  2159                    51883.136613 64580.6010  24.5%  2655 3260s
  6759  2203 57837.4206   21  332 51883.1366 64538.9924  24.4%  2667 3323s
  6920  2227 56316.9044   25  282 51883.1366 64538.9924  24.4%  2699 3375s
  7073  2190     cutoff   28      51883.1366 64538.9924  24.4%  2738 3435s
  7291  2180 52592.8533   29  186 51883.1366 64538.9924  24.4%  2752 3497s
  7492  2124 56931.0229   24  299 51883.1366 64046.6721  23.4%  2783 3542s
H 7534  2024                    51893.878100 63553.5265  22.5%  2792 3542s
  7551  2040 56798.7572   25  311 51893.8781 63549.6504  22.5%  2798 3593s
H 7592  1948                    51898.412458 63549.6504  22.5%  2812 3593s
  7610  1941 52411.1576   30  212 51898.4125 63549.6504  22.5%  2815 3600s

Cutting planes:
  Learned: 1
  MIR: 823
  Mixing: 1
  Flow cover: 2498
  RLT: 19
  Relax-and-lift: 211

Explored 7629 nodes (21729915 simplex iterations) in 3600.05 seconds (5989.57 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 51898.4 51893.9 51883.1 ... 51183.1

Time limit reached
Best objective 5.189841245788e+04, best bound 6.354965036094e+04, gap 22.4501%
  WARNING: Time limit reached. Using best solution found (gap: 22.45%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 51898.41, θ = 203072.97
  Upper Bound (UB) = 51898.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 203072.97
  [DEBUG]   ✓ Scenario 0: θ = 203072.97 ≤ Q = 203072.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 203072.97 ≤ Q = 203072.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 203072.97 ≤ Q = 203072.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 203072.97 ≤ Q = 203072.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 203072.97 ≤ Q = 203072.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 203072.97 ≤ Q = 203072.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 203072.97 ≤ Q = 203072.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 203072.97 ≤ Q = 203072.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 203072.97 ≤ Q = 203072.97 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x46797e47
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x46797e47
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.511856e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7337550.4067
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.683399e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168339.89    0  124 7337550.41 -168339.89   102%     -    0s
H    0     0                    -133390.8234 -168339.89  26.2%     -    0s
H    0     0                    -133654.0760 -168339.89  26.0%     -    0s
H    0     0                    -133775.0444 -145159.91  8.51%     -    0s
H    0     0                    -139451.0765 -145159.91  4.09%     -    0s
     0     0 -145159.91    0  131 -139451.08 -145159.91  4.09%     -    0s
     0     0 -142904.65    0  106 -139451.08 -142904.65  2.48%     -    0s
H    0     0                    -141651.3018 -142897.14  0.88%     -    0s
     0     0 -142879.79    0  106 -141651.30 -142879.79  0.87%     -    0s
     0     0 -142879.67    0  106 -141651.30 -142879.67  0.87%     -    0s
     0     0 -142521.96    0   62 -141651.30 -142521.96  0.61%     -    0s
     0     0 -142421.57    0   83 -141651.30 -142421.57  0.54%     -    0s
     0     0 -142337.98    0   93 -141651.30 -142337.98  0.48%     -    0s
     0     0 -142336.34    0   93 -141651.30 -142336.34  0.48%     -    0s
H    0     0                    -141658.9517 -142333.68  0.48%     -    0s
     0     2 -142333.68    0   93 -141658.95 -142333.68  0.48%     -    0s
H   89   117                    -141677.4809 -142109.79  0.31%  13.6    0s
H  109   117                    -141692.6165 -142077.14  0.27%  14.5    0s
H  179   117                    -141702.0357 -142054.28  0.25%  14.0    0s
H  199   117                    -141720.5649 -142054.28  0.24%  13.6    0s
H  209   117                    -141726.7544 -142054.28  0.23%  13.5    0s
*  913    13              33    -141735.7005 -141788.35  0.04%   9.1    0s

Cutting planes:
  Gomory: 44
  Implied bound: 5
  MIR: 213
  Flow cover: 11
  RLT: 4
  BQP: 1

Explored 991 nodes (9247 simplex iterations) in 0.21 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -141736 -141727 -141721 ... -133775
No other solutions better than -141736

Optimal solution found (tolerance 1.00e-06)
Best objective -1.417357004559e+05, best bound -1.417357004559e+05, gap 0.0000%
  Subproblem solved in 0.24s
  Worst-case operational profit (Z_SP) = 199008.50
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141735.70
  [DEBUG]   S×d_nominal = 340744.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 340744.20 + -141735.70 = 199008.50
  [DEBUG]   Current θ from Master = 203072.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4064.47 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 47833.94
  Lower Bound (LB) = 47833.94
  Gap (UB-LB) = 4064.4736, Absolute Gap = 4064.4736, Relative Gap = 0.078316
  Not converged yet (gap = 4064.47 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xc5fe8e84
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70940 rows and 28820 columns
Presolve time: 2.39s
Presolved: 83343 rows, 35840 columns, 510649 nonzeros
Variable types: 33581 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303653.9871
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.566e+06
 Factor NZ  : 7.686e+06 (roughly 100 MB of memory)
 Factor Ops : 1.322e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.74246941e+07  1.69644845e+08  1.25e+05 1.94e+01  8.33e+04     4s
   1  -1.30595773e+07  1.53169493e+08  8.62e+04 9.45e+01  5.68e+04     4s
   2  -3.81275916e+06  1.17416608e+08  2.53e+04 2.20e+00  1.77e+04     4s
   3  -1.00075681e+06  7.59132829e+07  3.47e+03 8.36e-01  2.74e+03     4s
   4  -5.09116411e+05  3.86012255e+07  5.21e+02 1.75e-01  5.58e+02     5s
   5  -4.05182522e+05  2.25928854e+07  2.67e+02 8.42e-02  2.89e+02     5s
   6  -2.84733933e+05  1.68141838e+07  1.03e+02 5.57e-02  1.61e+02     5s
   7  -2.05792435e+05  1.14881262e+07  5.61e+01 3.49e-02  9.88e+01     5s
   8  -1.07700285e+05  7.32399331e+06  1.50e+01 2.06e-02  5.31e+01     5s
   9  -9.48868752e+04  5.80864036e+06  7.92e+00 1.60e-02  4.05e+01     5s
  10  -5.92062679e+04  3.02724544e+06  1.69e+00 8.19e-03  2.04e+01     5s
  11  -3.14914096e+04  8.41028660e+05  3.89e-01 2.07e-03  5.71e+00     5s
  12  -3.11419859e+03  2.91363473e+05  2.00e-01 7.04e-04  1.93e+00     5s
  13   9.89541611e+03  2.41469976e+05  1.60e-01 8.41e-04  1.52e+00     5s
  14   1.85655120e+04  1.70387684e+05  1.37e-01 1.68e-03  9.94e-01     5s
  15   2.61484661e+04  1.53601614e+05  1.19e-01 1.73e-03  8.34e-01     5s
  16   3.25653633e+04  1.28664835e+05  1.04e-01 1.82e-03  6.29e-01     5s
  17   4.47259047e+04  1.20911220e+05  7.69e-02 1.96e-03  4.99e-01     6s
  18   5.04560293e+04  1.12599172e+05  6.41e-02 2.10e-03  4.07e-01     6s
  19   5.57987016e+04  1.01991343e+05  5.28e-02 1.57e-03  3.02e-01     6s
  20   6.16290362e+04  9.59292929e+04  4.07e-02 1.24e-03  2.25e-01     6s
  21   6.54523211e+04  9.24940998e+04  3.30e-02 1.35e-03  1.77e-01     6s
  22   6.87994254e+04  8.99229957e+04  2.67e-02 1.48e-03  1.38e-01     6s
  23   7.25117284e+04  8.82712792e+04  1.98e-02 1.03e-03  1.03e-01     6s
  24   7.48922932e+04  8.69086492e+04  1.53e-02 7.36e-04  7.87e-02     6s
  25   7.58641216e+04  8.62155643e+04  1.36e-02 5.88e-04  6.78e-02     6s
  26   7.61572509e+04  8.59678430e+04  1.30e-02 5.27e-04  6.42e-02     7s
  27   7.81489343e+04  8.54879134e+04  9.46e-03 4.05e-04  4.80e-02     7s
  28   7.92284441e+04  8.50399288e+04  7.55e-03 3.20e-04  3.80e-02     7s
  29   8.06712724e+04  8.44023816e+04  5.02e-03 1.69e-04  2.44e-02     7s
  30   8.19488080e+04  8.40925581e+04  2.80e-03 1.10e-04  1.40e-02     7s
  31   8.27456375e+04  8.38497238e+04  1.38e-03 5.22e-05  7.23e-03     7s
  32   8.31062295e+04  8.37661809e+04  7.62e-04 3.48e-05  4.32e-03     7s
  33   8.32647657e+04  8.36984758e+04  5.03e-04 2.07e-05  2.84e-03     7s
  34   8.33596059e+04  8.36314260e+04  3.50e-04 8.44e-06  1.78e-03     7s
  35   8.34509079e+04  8.36197117e+04  2.04e-04 6.22e-06  1.10e-03     8s
  36   8.34944345e+04  8.36049414e+04  1.39e-04 3.19e-06  7.23e-04     8s
  37   8.35375237e+04  8.35987298e+04  7.41e-05 2.06e-06  4.01e-04     8s
  38   8.35643165e+04  8.35942198e+04  3.24e-05 1.20e-06  1.96e-04     8s
  39   8.35657368e+04  8.35922131e+04  3.02e-05 8.80e-07  1.73e-04     8s
  40   8.35753334e+04  8.35894813e+04  1.59e-05 4.53e-07  9.26e-05     8s
  41   8.35805431e+04  8.35883173e+04  8.57e-06 2.68e-07  5.09e-05     8s
  42   8.35860916e+04  8.35877996e+04  4.84e-07 1.81e-07  1.12e-05     8s
  43   8.35866116e+04  8.35867972e+04  3.59e-08 4.17e-08  1.21e-06     9s
  44   8.35866447e+04  8.35866483e+04  4.99e-09 5.85e-09  2.41e-08     9s
  45   8.35866444e+04  8.35866477e+04  1.04e-05 9.18e-07  1.95e-08     9s
  46   8.35866444e+04  8.35866477e+04  1.01e-05 9.32e-07  1.90e-08     9s
  47   8.35866445e+04  8.35866477e+04  9.95e-06 8.98e-07  1.86e-08     9s
  48   8.35866453e+04  8.35866476e+04  6.83e-06 7.28e-07  1.35e-08     9s
  49   8.35866455e+04  8.35866475e+04  5.74e-06 6.40e-07  1.15e-08     9s
  50   8.35866456e+04  8.35866475e+04  5.65e-06 6.12e-07  1.12e-08    10s
  51   8.35866456e+04  8.35866474e+04  5.03e-06 5.60e-07  1.05e-08    10s
  52   8.35866457e+04  8.35866473e+04  4.63e-06 4.21e-07  9.24e-09    10s

Barrier solved model in 52 iterations and 9.94 seconds (8.19 work units)
Optimal objective 8.35866457e+04


Root crossover log...

   74615 DPushes remaining with DInf 0.0000000e+00                10s
   37768 DPushes remaining with DInf 0.0000000e+00                10s
     951 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   20593 PPushes remaining with PInf 2.2397289e-04                16s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0295637e+05     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64570    8.3586647e+04   0.000000e+00   1.029564e+05     19s
   65618    8.3586647e+04   0.000000e+00   0.000000e+00     20s
   65618    8.3586647e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 4.38s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.358665e+04, 65618 iterations, 21.32 seconds (24.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83586.6469    0  197 -227427.98 83586.6469   137%     -   25s
H    0     0                    -217861.9668 83586.6469   138%     -   25s
H    0     0                    -40916.73142 83586.6469   304%     -   25s
H    0     0                    26172.788841 83586.6469   219%     -   26s
H    0     0                    33554.167123 83586.6469   149%     -   26s
H    0     0                    33894.364890 83586.6469   147%     -   26s
H    0     0                    34462.348981 83586.6469   143%     -   26s
H    0     0                    34483.859442 76606.1541   122%     -   84s
H    0     0                    34645.257304 76606.1541   121%     -   84s
H    0     0                    34846.811179 76606.1541   120%     -   84s
H    0     0                    35050.158160 76606.1541   119%     -   84s
H    0     0                    35091.942518 76606.1541   118%     -   84s
     0     0 76606.1541    0  185 35091.9425 76606.1541   118%     -   84s
     0     0 76226.7278    0  228 35091.9425 76226.7278   117%     -  108s
     0     0 76221.2137    0  236 35091.9425 76221.2137   117%     -  115s
     0     0 76215.8039    0  199 35091.9425 76215.8039   117%     -  116s
     0     0 76215.2138    0  198 35091.9425 76215.2138   117%     -  117s
     0     0 74018.0162    0  264 35091.9425 74018.0162   111%     -  157s
H    0     0                    40066.910562 74018.0162  84.7%     -  157s
H    0     0                    40219.452931 74018.0162  84.0%     -  157s
H    0     0                    40805.405359 74018.0162  81.4%     -  157s
H    0     0                    41223.270168 74018.0162  79.6%     -  157s
H    0     0                    41457.915907 74018.0162  78.5%     -  158s
H    0     0                    43907.632200 74018.0162  68.6%     -  158s
H    0     0                    43960.758008 73453.7823  67.1%     -  191s
H    0     0                    44503.228396 73453.7823  65.1%     -  191s
H    0     0                    44978.372954 73453.7823  63.3%     -  191s
H    0     0                    45087.869313 73453.7823  62.9%     -  191s
H    0     0                    45097.993575 73453.7823  62.9%     -  191s
H    0     0                    45111.330926 73453.7823  62.8%     -  191s
     0     0 73453.7823    0  275 45111.3309 73453.7823  62.8%     -  191s
     0     0 73298.2041    0  286 45111.3309 73298.2041  62.5%     -  210s
     0     0 73248.2177    0  286 45111.3309 73248.2177  62.4%     -  220s
     0     0 73115.0955    0  280 45111.3309 73115.0955  62.1%     -  233s
     0     0 73066.1096    0  281 45111.3309 73066.1096  62.0%     -  243s
     0     0 73028.6579    0  280 45111.3309 73028.6579  61.9%     -  248s
H    0     0                    46491.558623 72996.5025  57.0%     -  255s
H    0     0                    46533.403611 72996.5025  56.9%     -  255s
H    0     0                    46663.886808 72996.5025  56.4%     -  255s
H    0     0                    46725.661293 72996.5025  56.2%     -  255s
H    0     0                    47468.453564 72996.5025  53.8%     -  255s
     0     0 72996.5025    0  289 47468.4536 72996.5025  53.8%     -  255s
H    0     0                    47576.163833 72961.2127  53.4%     -  259s
H    0     0                    47727.938104 72961.2127  52.9%     -  259s
H    0     0                    48024.794583 72961.2127  51.9%     -  259s
H    0     0                    48189.057238 72961.2127  51.4%     -  259s
     0     0 72961.2127    0  277 48189.0572 72961.2127  51.4%     -  259s
     0     0 72958.4286    0  276 48189.0572 72958.4286  51.4%     -  261s
     0     0 72945.4313    0  278 48189.0572 72945.4313  51.4%     -  262s
     0     0 72943.6946    0  280 48189.0572 72943.6946  51.4%     -  263s
     0     0 72943.6946    0  280 48189.0572 72943.6946  51.4%     -  264s
H    0     0                    49258.789387 71534.8103  45.2%     -  307s
H    0     0                    49278.948832 71534.8103  45.2%     -  307s
H    0     0                    49521.323946 71534.8103  44.5%     -  307s
H    0     0                    49531.398605 71534.8103  44.4%     -  307s
H    0     0                    49539.138066 71534.8103  44.4%     -  307s
     0     0 71534.8103    0  351 49539.1381 71534.8103  44.4%     -  307s
     0     0 71227.0485    0  363 49539.1381 71227.0485  43.8%     -  324s
     0     0 71110.8758    0  376 49539.1381 71110.8758  43.5%     -  338s
     0     0 71058.1343    0  380 49539.1381 71058.1343  43.4%     -  346s
     0     0 71017.9615    0  383 49539.1381 71017.9615  43.4%     -  356s
     0     0 71007.2639    0  390 49539.1381 71007.2639  43.3%     -  360s
     0     0 70983.9107    0  384 49539.1381 70983.9107  43.3%     -  364s
     0     0 70975.8392    0  381 49539.1381 70975.8392  43.3%     -  367s
     0     0 70968.8327    0  382 49539.1381 70968.8327  43.3%     -  370s
     0     0 70933.1619    0  386 49539.1381 70933.1619  43.2%     -  376s
     0     0 70927.2258    0  384 49539.1381 70927.2258  43.2%     -  380s
     0     0 70924.0774    0  386 49539.1381 70924.0774  43.2%     -  382s
     0     0 70923.1164    0  386 49539.1381 70923.1164  43.2%     -  383s
H    0     0                    49556.755452 70509.7533  42.3%     -  420s
     0     0 70509.7533    0  355 49556.7555 70509.7533  42.3%     -  420s
H    0     0                    49767.129779 70509.4847  41.7%     -  421s
     0     0 70342.2344    0  394 49767.1298 70342.2344  41.3%     -  439s
     0     0 70272.9918    0  367 49767.1298 70272.9918  41.2%     -  449s
     0     0 70200.5103    0  410 49767.1298 70200.5103  41.1%     -  460s
H    0     0                    50221.260657 70165.4961  39.7%     -  468s
H    0     0                    50448.731362 70165.4961  39.1%     -  468s
     0     0 70165.4961    0  375 50448.7314 70165.4961  39.1%     -  468s
     0     0 70152.3076    0  369 50448.7314 70152.3076  39.1%     -  472s
H    0     0                    50510.681555 70128.8165  38.8%     -  478s
H    0     0                    50544.272664 70128.8165  38.7%     -  478s
     0     0 70128.8165    0  367 50544.2727 70128.8165  38.7%     -  479s
     0     0 70116.5666    0  374 50544.2727 70116.5666  38.7%     -  482s
     0     0 70110.8888    0  371 50544.2727 70110.8888  38.7%     -  486s
     0     0 70105.0158    0  374 50544.2727 70105.0158  38.7%     -  488s
     0     0 70088.3906    0  375 50544.2727 70088.3906  38.7%     -  494s
     0     0 70081.1727    0  377 50544.2727 70081.1727  38.7%     -  497s
     0     0 70078.9281    0  383 50544.2727 70078.9281  38.6%     -  499s
     0     0 70076.1437    0  377 50544.2727 70076.1437  38.6%     -  501s
     0     0 70072.0612    0  376 50544.2727 70072.0612  38.6%     -  503s
     0     0 70071.2111    0  378 50544.2727 70071.2111  38.6%     -  504s
     0     0 69871.7739    0  413 50544.2727 69871.7739  38.2%     -  517s
H    0     0                    50738.698910 69871.6444  37.7%     -  518s
     0     0 69841.0283    0  416 50738.6989 69841.0283  37.6%     -  523s
     0     0 69829.2627    0  421 50738.6989 69829.2627  37.6%     -  528s
     0     0 69823.6057    0  418 50738.6989 69823.6057  37.6%     -  531s
     0     0 69811.9859    0  420 50738.6989 69811.9859  37.6%     -  534s
     0     0 69809.7690    0  421 50738.6989 69809.7690  37.6%     -  535s
     0     0 69801.7925    0  427 50738.6989 69801.7925  37.6%     -  538s
     0     0 69800.6195    0  430 50738.6989 69800.6195  37.6%     -  540s
     0     0 69738.7121    0  394 50738.6989 69738.7121  37.4%     -  553s
H    0     0                    51357.661076 69738.6578  35.8%     -  556s
     0     0 69719.4186    0  394 51357.6611 69719.4186  35.8%     -  561s
     0     0 69711.3956    0  396 51357.6611 69711.3956  35.7%     -  564s
     0     0 69701.2640    0  432 51357.6611 69701.2640  35.7%     -  569s
     0     0 69696.0732    0  388 51357.6611 69696.0732  35.7%     -  573s
     0     0 69690.2133    0  432 51357.6611 69690.2133  35.7%     -  575s
     0     0 69688.2437    0  427 51357.6611 69688.2437  35.7%     -  576s
     0     0 69686.0320    0  399 51357.6611 69686.0320  35.7%     -  577s
     0     0 69684.8697    0  399 51357.6611 69684.8697  35.7%     -  578s
     0     0 69648.2618    0  384 51357.6611 69648.2618  35.6%     -  588s
     0     0 69623.3449    0  418 51357.6611 69623.3449  35.6%     -  596s
     0     0 69600.1636    0  418 51357.6611 69600.1636  35.5%     -  603s
     0     0 69590.9597    0  424 51357.6611 69590.9597  35.5%     -  608s
     0     0 69588.0777    0  386 51357.6611 69588.0777  35.5%     -  611s
     0     0 69583.7926    0  458 51357.6611 69583.7926  35.5%     -  613s
     0     0 69582.8526    0  431 51357.6611 69582.8526  35.5%     -  614s
     0     0 69558.8763    0  419 51357.6611 69558.8763  35.4%     -  621s
H    0     0                    51442.478180 69558.6950  35.2%     -  623s
H    0     0                    51534.223423 69558.6950  35.0%     -  623s
     0     0 69551.7177    0  457 51534.2234 69551.7177  35.0%     -  629s
     0     0 69548.5282    0  463 51534.2234 69548.5282  35.0%     -  631s
     0     0 69545.2601    0  472 51534.2234 69545.2601  34.9%     -  635s
     0     0 69542.7591    0  475 51534.2234 69542.7591  34.9%     -  637s
     0     0 69541.8513    0  473 51534.2234 69541.8513  34.9%     -  638s
     0     0 69511.9703    0  430 51534.2234 69511.9703  34.9%     -  648s
     0     0 69501.9999    0  440 51534.2234 69501.9999  34.9%     -  653s
     0     0 69496.3492    0  441 51534.2234 69496.3492  34.9%     -  657s
     0     0 69494.0078    0  443 51534.2234 69494.0078  34.9%     -  659s
     0     0 69491.9191    0  440 51534.2234 69491.9191  34.8%     -  660s
     0     0 69491.1433    0  442 51534.2234 69491.1433  34.8%     -  661s
H    0     0                    51620.517784 69472.3764  34.6%     -  667s
H    0     0                    51646.380302 69472.3764  34.5%     -  667s
     0     0 69472.3764    0  432 51646.3803 69472.3764  34.5%     -  668s
     0     0 69467.9542    0  438 51646.3803 69467.9542  34.5%     -  672s
     0     0 69465.9703    0  443 51646.3803 69465.9703  34.5%     -  673s
     0     0 69464.5327    0  447 51646.3803 69464.5327  34.5%     -  675s
     0     0 69460.0756    0  445 51646.3803 69460.0756  34.5%     -  678s
     0     0 69458.8250    0  446 51646.3803 69458.8250  34.5%     -  679s
     0     0 69454.9133    0  443 51646.3803 69454.9133  34.5%     -  683s
H    0     0                    51756.587449 69454.0248  34.2%     -  694s
     0     0 69445.9007    0  441 51756.5874 69445.9007  34.2%     -  701s
     0     0 69432.4085    0  444 51756.5874 69432.4085  34.2%     -  703s
     0     0 69430.8942    0  440 51756.5874 69430.8942  34.1%     -  706s
     0     0 69427.1078    0  434 51756.5874 69427.1078  34.1%     -  710s
     0     0 69420.2477    0  437 51756.5874 69420.2477  34.1%     -  717s
     0     0 69413.7376    0  441 51756.5874 69413.7376  34.1%     -  721s
     0     0 69411.5439    0  443 51756.5874 69411.5439  34.1%     -  723s
     0     0 69410.5549    0  435 51756.5874 69410.5549  34.1%     -  724s
     0     0 69406.6438    0  439 51756.5874 69406.6438  34.1%     -  727s
H    0     0                    52079.915512 69406.4442  33.3%     -  738s
     0     0 69405.1364    0  439 52079.9155 69405.1364  33.3%     -  748s
     0     0 69404.3938    0  439 52079.9155 69404.3938  33.3%     -  750s
     0     0 69403.6671    0  437 52079.9155 69403.6671  33.3%     -  752s
     0     0 69393.0225    0  396 52079.9155 69393.0225  33.2%     -  757s
     0     0 69385.2153    0  437 52079.9155 69385.2153  33.2%     -  759s
     0     0 69380.4034    0  400 52079.9155 69380.4034  33.2%     -  761s
     0     0 69379.8646    0  400 52079.9155 69379.8646  33.2%     -  762s
     0     0 69374.6380    0  444 52079.9155 69374.6380  33.2%     -  766s
     0     0 69374.5704    0  444 52079.9155 69374.5704  33.2%     -  769s
     0     2 69374.4620    0  444 52079.9155 69374.4620  33.2%     -  942s
     1     4 69345.0846    1  387 52079.9155 69374.3105  33.2%  1580  970s
     3     6 69180.5508    2  410 52079.9155 69345.0062  33.2%  8011  992s
     5     9 68890.9633    3  408 52079.9155 69345.0062  33.2%  9173 1025s
     8    18 67782.9869    3  370 52079.9155 69180.2271  32.8% 10979 1055s
    17    35 67646.1941    4  374 52079.9155 68925.3510  32.3%  9582 1089s
    34    50 64138.6355    5  289 52079.9155 68865.4325  32.2% 15180 1154s
    49    80 64192.2471    7  291 52079.9155 68865.4325  32.2% 13436 1208s
    79   116 64142.3485    8  283 52079.9155 68865.4325  32.2% 11820 1315s
   115   165 64076.5128    9  278 52079.9155 68865.4325  32.2%  9394 1362s
   164   249 63588.7444   10  263 52079.9155 68865.4325  32.2%  7897 1410s
   248   338 64046.3059   10  275 52079.9155 68865.4325  32.2%  6868 1452s
   347   407 63544.9728   11  274 52079.9155 68865.4325  32.2%  5829 1494s
   441   431 63483.3556   11  254 52079.9155 68865.4325  32.2%  5248 1531s
   484   492 63032.7594   12  266 52079.9155 68865.4325  32.2%  5025 1568s
   551   575 62993.3756   11  252 52079.9155 68865.4325  32.2%  4771 1600s
   640   655 62563.3597   13  254 52079.9155 68865.4325  32.2%  4474 1631s
   734   680 62131.1229   31  247 52079.9155 68865.4325  32.2%  4167 1655s
   765   714 54486.5463   12  221 52079.9155 68865.4325  32.2%  4116 1681s
   799   745 62195.6917   14  248 52079.9155 68865.4325  32.2%  4036 1703s
   830   778 62238.2337   14  232 52079.9155 68865.4325  32.2%  3996 1728s
   877   843 61997.6062   15  234 52079.9155 68865.4325  32.2%  3914 1753s
   947   918 61064.2952   15  230 52079.9155 68865.4325  32.2%  3814 1776s
  1034  1000 61856.8961   15  252 52079.9155 68865.4325  32.2%  3652 1808s
  1126  1075 59862.7648   16  223 52079.9155 68865.4325  32.2%  3519 1854s
  1229  1161 58998.6579   16  209 52079.9155 68865.4325  32.2%  3380 1887s
  1341  1213 60458.1630   16  224 52079.9155 68865.4325  32.2%  3287 1922s
  1463  1263 59764.9730   15  249 52079.9155 68865.4325  32.2%  3208 1956s
  1573  1370 58478.6305   16  250 52079.9155 68865.4325  32.2%  3177 1989s
  1710  1483 60338.7326   16  256 52079.9155 68865.4325  32.2%  3069 2022s
  1870  1557 57644.8068   16  259 52079.9155 68865.4325  32.2%  2960 2062s
  2018  1647 58605.8379   17  242 52079.9155 68865.4325  32.2%  2866 2104s
  2166  1732     cutoff   18      52079.9155 68865.4325  32.2%  2822 2139s
  2290  1826     cutoff   19      52079.9155 68865.4297  32.2%  2779 2181s
  2424  1905 64997.3503    6  324 52079.9155 68780.0023  32.1%  2764 2227s
  2569  2009 61525.7116    7  324 52079.9155 68780.0023  32.1%  2751 2272s
  2717  2160 61107.3117    9  324 52079.9155 68780.0023  32.1%  2744 2319s
  2906  2315 60809.1268   11  306 52079.9155 68780.0023  32.1%  2697 2369s
  3121  2481 60395.7502   15  349 52079.9155 68690.5611  31.9%  2654 2422s
  3359  2628 60010.5037   20  268 52079.9155 68690.5611  31.9%  2601 2461s
  3545  2629 54185.0289   54  444 52079.9155 68690.5611  31.9%  2544 2661s
  3547  2630 53343.4176   49  148 52079.9155 68690.5611  31.9%  2543 2679s
  3548  2631 55752.8088   24  258 52079.9155 68690.5611  31.9%  2542 2745s
  3549  2632 57930.4856   41  301 52079.9155 68690.5611  31.9%  2541 2806s
  3550  2632 64974.1309   19  381 52079.9155 68690.5611  31.9%  2541 2856s
  3551  2633 65586.1739    9  397 52079.9155 68690.5611  31.9%  2540 2910s
  3552  2634 59096.9748   19  412 52079.9155 68690.5611  31.9%  2539 2934s
  3553  2634 61130.2540   12  415 52079.9155 68690.5611  31.9%  2539 2958s
  3554  2635 62329.4235   12  390 52079.9155 68690.5611  31.9%  2538 2979s
  3555  2636 62847.8731    9  429 52079.9155 68690.5611  31.9%  2537 2993s
  3556  2636 55139.3552   47  425 52079.9155 68690.5611  31.9%  2536 3008s
  3557  2637 53103.9657   84  396 52079.9155 68690.5611  31.9%  2536 3023s
  3558  2638 54365.3594   90  391 52079.9155 68690.5611  31.9%  2535 3033s
  3559  2638 63075.9901   21  394 52079.9155 68690.5611  31.9%  2534 3046s
  3560  2639 58126.8550   31  432 52079.9155 68690.5611  31.9%  2534 3055s
  3561  2640 59496.2926   50  441 52079.9155 68690.5611  31.9%  2533 3060s
  3562  2640 63100.8512   12  438 52079.9155 68690.5611  31.9%  2532 3069s
  3563  2641 57469.6843   62  436 52079.9155 68690.5611  31.9%  2531 3072s
  3564  2642 54434.7848   51  390 52079.9155 68690.5611  31.9%  2531 3075s
  3566  2643 61151.8814    9  398 52079.9155 68690.5611  31.9%  2529 3081s
  3567  2644 54185.0289   54  437 52079.9155 68690.5611  31.9%  2529 3085s
  3568  2644 52499.8333   16  433 52079.9155 68690.5611  31.9%  2528 3090s
  3569  2645 57453.2978   63  436 52079.9155 68690.5611  31.9%  2527 3113s
  3570  2646 55051.6599   34  434 52079.9155 68690.5611  31.9%  2526 3121s
  3571  2646 57670.5268   26  430 52079.9155 68690.5611  31.9%  2526 3128s
  3572  2647 53281.3239   33  386 52079.9155 68690.5611  31.9%  2525 3133s
  3573  2648 59247.3307   26  441 52079.9155 68690.5611  31.9%  2524 3137s
  3574  2648 62968.4893   22  434 52079.9155 68690.5611  31.9%  2524 3141s
  3575  2649 62539.8256   25  419 52079.9155 68690.5611  31.9%  2523 3155s
  3576  2650 56063.7276   37  420 52079.9155 68690.5611  31.9%  2522 3164s
  3577  2650 61477.4277   12  421 52079.9155 68690.5611  31.9%  2522 3172s
  3578  2651 52968.4894   51  434 52079.9155 68690.5611  31.9%  2521 3176s
  3580  2652 58176.9353   30  433 52079.9155 68690.5611  31.9%  2519 3184s
  3581  2653 53533.9809   69  435 52079.9155 68690.5611  31.9%  2519 3206s
  3582  2654 54871.7538   63  440 52079.9155 68690.5611  31.9%  2518 3213s
  3583  2654 65600.5690   25  441 52079.9155 68690.5611  31.9%  2517 3216s
  3585  2656 65604.2350   13  448 52079.9155 68690.5611  31.9%  2516 3222s
  3586  2656 61326.4387   25  445 52079.9155 68690.5611  31.9%  2515 3233s
  3587  2657 58102.6999   56  442 52079.9155 68690.5611  31.9%  2514 3238s
  3588  2658 53124.1387   31  433 52079.9155 68690.5611  31.9%  2514 3241s
  3590  2659 59434.2934   16  451 52079.9155 68690.5611  31.9%  2512 3245s
  3592  2660 54013.1095   92  437 52079.9155 68690.5611  31.9%  2511 3283s
  3593  2661 55212.3650   35  433 52079.9155 68690.5611  31.9%  2510 3286s
  3594  2662 52466.3192   41  433 52079.9155 68690.5611  31.9%  2510 3292s
  3595  2662 54060.8287   61  421 52079.9155 68690.5611  31.9%  2509 3304s
  3596  2663 57707.9891   31  436 52079.9155 68690.5611  31.9%  2508 3309s
  3597  2664 58015.4625   46  432 52079.9155 68690.5611  31.9%  2507 3314s
  3598  2664 57713.6795   67  429 52079.9155 68690.5611  31.9%  2507 3331s
  3599  2665 63878.4614   30  425 52079.9155 68690.5611  31.9%  2506 3338s
  3600  2666 57373.1268   36  431 52079.9155 68690.5611  31.9%  2505 3341s
  3601  2666 54771.9058   23  431 52079.9155 68690.5611  31.9%  2505 3346s
  3602  2667 54983.6056   34  425 52079.9155 68690.5611  31.9%  2504 3369s
  3603  2668 64705.6211   22  440 52079.9155 68690.5611  31.9%  2503 3376s
  3604  2668 63463.8081   23  453 52079.9155 68689.9272  31.9%  2503 3381s
  3606  2670 64913.3610   21  451 52079.9155 68679.3830  31.9%  2501 3385s
  3608  2671 56628.9692   53  449 52079.9155 68632.5139  31.8%  2500 3408s
  3609  2672 53442.0448   43  485 52079.9155 68617.5597  31.8%  2499 3416s
  3610  2672 62820.1826   26  451 52079.9155 68609.4808  31.7%  2498 3420s
  3611  2673 53471.1233   72  447 52079.9155 68606.7663  31.7%  2498 3425s
  3612  2674 61590.2415   23  443 52079.9155 68579.7605  31.7%  2497 3441s
  3613  2674 60343.6350   21  451 52079.9155 68568.5149  31.7%  2496 3448s
  3614  2675 55890.2540   84  446 52079.9155 68562.3290  31.6%  2496 3451s
  3615  2676 57134.9317   78  444 52079.9155 68560.6121  31.6%  2495 3455s
  3616  2676 64436.8529   25  443 52079.9155 68534.2594  31.6%  2494 3478s
  3617  2677 65146.0151   25  449 52079.9155 68522.2734  31.6%  2494 3486s
  3618  2678 54472.4967   50  451 52079.9155 68520.3692  31.6%  2493 3491s
  3619  2678 53847.7187   28  453 52079.9155 68507.2545  31.5%  2492 3500s
  3621  2680 56926.8217   84  451 52079.9155 68506.5977  31.5%  2491 3506s
  3622  2680 61113.4960   21  450 52079.9155 68490.5852  31.5%  2490 3517s
  3623  2681 55734.9029   60  450 52079.9155 68490.5852  31.5%  2489 3521s
  3624  2682 54642.5624   37  452 52079.9155 68490.5852  31.5%  2489 3532s
  3625  2682 56607.4347   24  452 52079.9155 68490.5852  31.5%  2488 3539s
  3626  2683 55627.4905   28  443 52079.9155 68490.5852  31.5%  2487 3549s
  3627  2684 58334.5237   34  454 52079.9155 68490.5852  31.5%  2487 3556s
  3628  2684 53590.0787   27  454 52079.9155 68489.8211  31.5%  2486 3562s
  3629  2685 61121.3634   32  454 52079.9155 68489.8211  31.5%  2485 3581s

Cutting planes:
  Implied bound: 4
  MIR: 148
  Flow cover: 623
  RLT: 15
  Relax-and-lift: 55

Explored 3629 nodes (9825604 simplex iterations) in 3600.03 seconds (5166.96 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 52079.9 51756.6 51646.4 ... 50448.7

Time limit reached
Best objective 5.207991551158e+04, best bound 6.848982106228e+04, gap 31.5091%
  WARNING: Time limit reached. Using best solution found (gap: 31.51%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 52079.92, θ = 203027.96
  Upper Bound (UB) = 52079.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 203027.96
  [DEBUG]   ✓ Scenario 0: θ = 203027.96 ≤ Q = 203027.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 203027.96 ≤ Q = 203027.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 203027.96 ≤ Q = 203027.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 203027.96 ≤ Q = 203027.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 203027.96 ≤ Q = 203027.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 203027.96 ≤ Q = 203027.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 203027.96 ≤ Q = 203027.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 203027.96 ≤ Q = 203027.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 203027.96 ≤ Q = 203027.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 203027.96 ≤ Q = 203027.96 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x59b951cd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa646ae33
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.511856e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7327264.7738
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.689993e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168999.25    0  124 7327264.77 -168999.25   102%     -    0s
H    0     0                    -133988.2670 -168999.25  26.1%     -    0s
H    0     0                    -134251.5195 -168999.25  25.9%     -    0s
     0     0 -148841.86    0  100 -134251.52 -148841.86  10.9%     -    0s
H    0     0                    -143002.5032 -148703.49  3.99%     -    0s
H    0     0                    -145079.9914 -148703.49  2.50%     -    0s
H    0     0                    -145147.5158 -148703.49  2.45%     -    0s
     0     0 -146969.55    0  104 -145147.52 -146969.55  1.26%     -    0s
H    0     0                    -145662.5464 -146959.80  0.89%     -    0s
     0     0 -146411.74    0   44 -145662.55 -146411.74  0.51%     -    0s
     0     0 -146357.66    0   57 -145662.55 -146357.66  0.48%     -    0s
     0     0 -146356.75    0   56 -145662.55 -146356.75  0.48%     -    0s
     0     0 -146084.12    0   18 -145662.55 -146084.12  0.29%     -    0s
     0     0 -145981.39    0   16 -145662.55 -145981.39  0.22%     -    0s
     0     0 -145802.12    0   10 -145662.55 -145802.12  0.10%     -    0s
     0     0 -145788.09    0    8 -145662.55 -145788.09  0.09%     -    0s
H    0     0                    -145706.0049 -145788.09  0.06%     -    0s
     0     0 -145777.78    0    6 -145706.00 -145777.78  0.05%     -    0s
     0     0 -145769.18    0    5 -145706.00 -145769.18  0.04%     -    0s
     0     0 -145769.18    0   13 -145706.00 -145769.18  0.04%     -    0s
H    0     0                    -145749.4166 -145769.18  0.01%     -    0s
     0     0 -145751.75    0    2 -145749.42 -145751.75  0.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 4
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (797 simplex iterations) in 0.16 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -145749 -145706 -145663 ... 1.51186e+13

Optimal solution found (tolerance 1.00e-06)
Best objective -1.457494165829e+05, best bound -1.457495073584e+05, gap 0.0001%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 195505.14
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -145749.42
  [DEBUG]   S×d_nominal = 341254.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341254.55 + -145749.42 = 195505.14
  [DEBUG]   Current θ from Master = 203027.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7522.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44557.09
  Lower Bound (LB) = 47833.94
  Gap (UB-LB) = 4245.9766, Absolute Gap = 4245.9766, Relative Gap = 0.081528
  Not converged yet (gap = 4245.98 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0xeb29ecc0
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78010 rows and 31690 columns
Presolve time: 3.56s
Presolved: 91563 rows, 39210 columns, 556691 nonzeros
Variable types: 36951 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -304614.8245
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 637
 AA' NZ     : 3.033e+06
 Factor NZ  : 7.086e+06 (roughly 100 MB of memory)
 Factor Ops : 1.291e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.79711058e+07  1.85176424e+08  1.29e+05 1.86e+01  8.54e+04     5s
   1  -1.36530661e+07  1.68494964e+08  8.97e+04 9.37e+01  5.89e+04     5s
   2  -3.78269424e+06  1.29343810e+08  2.47e+04 7.35e+00  1.73e+04     5s
   3  -9.06161378e+05  8.68447671e+07  2.41e+03 1.41e+00  2.08e+03     6s
   4  -5.64884700e+05  4.53528566e+07  5.39e+02 4.07e-01  5.83e+02     6s
   5  -4.55088922e+05  2.65644781e+07  2.78e+02 1.94e-01  3.04e+02     6s
   6  -3.36197418e+05  1.98319255e+07  1.17e+02 1.32e-01  1.75e+02     6s
   7  -2.49085693e+05  1.42034160e+07  4.76e+01 8.71e-02  1.06e+02     6s
   8  -1.27767918e+05  9.59261227e+06  1.31e+01 5.59e-02  6.20e+01     6s
   9  -8.24458612e+04  4.20552234e+06  6.13e+00 2.25e-02  2.66e+01     6s
  10  -3.75404594e+04  1.22186212e+06  1.85e+00 5.72e-03  7.61e+00     6s
  11  -6.65109278e+03  7.13806856e+05  1.00e+00 3.32e-03  4.33e+00     6s
  12   7.24360405e+03  4.06756299e+05  7.36e-01 1.60e-03  2.40e+00     6s
  13   1.66522799e+04  3.03402799e+05  5.38e-01 1.21e-03  1.72e+00     6s
  14   2.77152424e+04  2.26729288e+05  3.90e-01 9.31e-04  1.19e+00     6s
  15   3.16879301e+04  1.77143275e+05  3.43e-01 1.30e-03  8.70e-01     7s
  16   4.33921237e+04  1.38226699e+05  2.49e-01 1.93e-03  5.67e-01     7s
  17   5.03942308e+04  1.18775353e+05  1.98e-01 2.24e-03  4.09e-01     7s
  18   5.49017928e+04  1.07432121e+05  1.68e-01 2.09e-03  3.14e-01     7s
  19   6.22565886e+04  1.00821321e+05  1.19e-01 3.59e-03  2.31e-01     7s
  20   6.76996006e+04  9.53223786e+04  8.78e-02 2.36e-03  1.65e-01     7s
  21   7.02491407e+04  9.31244263e+04  7.35e-02 2.00e-03  1.37e-01     7s
  22   7.15340956e+04  9.05102489e+04  6.61e-02 1.75e-03  1.13e-01     7s
  23   7.43214056e+04  8.95434556e+04  5.03e-02 1.29e-03  9.10e-02     7s
  24   7.60407742e+04  8.73526007e+04  4.02e-02 1.19e-03  6.76e-02     7s
  25   7.75420634e+04  8.66795315e+04  3.15e-02 1.05e-03  5.46e-02     7s
  26   7.94505621e+04  8.59129522e+04  2.11e-02 8.25e-04  3.86e-02     8s
  27   7.97832649e+04  8.50422907e+04  1.94e-02 7.90e-04  3.15e-02     8s
  28   8.11800549e+04  8.45165169e+04  1.23e-02 6.54e-04  2.00e-02     8s
  29   8.16192274e+04  8.43074500e+04  1.01e-02 5.13e-04  1.61e-02     8s
  30   8.21499557e+04  8.40614270e+04  7.29e-03 2.46e-04  1.14e-02     8s
  31   8.26249258e+04  8.40435891e+04  4.98e-03 2.34e-04  8.48e-03     8s
  32   8.27311289e+04  8.39421731e+04  4.47e-03 1.64e-04  7.24e-03     8s
  33   8.31176362e+04  8.37970464e+04  2.60e-03 6.35e-05  4.06e-03     8s
  34   8.33147589e+04  8.37656692e+04  1.69e-03 3.92e-05  2.70e-03     9s
  35   8.33525506e+04  8.37503102e+04  1.52e-03 3.00e-05  2.38e-03     9s
  36   8.34056344e+04  8.37386031e+04  1.29e-03 2.25e-05  1.99e-03     9s
  37   8.34945284e+04  8.37304620e+04  8.81e-04 1.77e-05  1.41e-03     9s
  38   8.35581106e+04  8.37195150e+04  6.10e-04 1.12e-05  9.65e-04     9s
  39   8.36426149e+04  8.37085018e+04  2.36e-04 4.43e-06  3.94e-04     9s
  40   8.36537449e+04  8.37052242e+04  1.90e-04 2.90e-06  3.08e-04     9s
  41   8.36618471e+04  8.37022249e+04  1.54e-04 1.09e-06  2.42e-04     9s
  42   8.36884606e+04  8.37010954e+04  4.09e-05 6.19e-07  7.55e-05     9s
  43   8.36910450e+04  8.37006399e+04  3.10e-05 4.72e-07  5.73e-05    10s
  44   8.36955060e+04  8.37005179e+04  1.36e-05 4.27e-07  2.99e-05    10s
  45   8.36976442e+04  8.36994697e+04  5.68e-06 1.32e-07  1.09e-05    10s
  46   8.36990908e+04  8.36992803e+04  2.29e-07 1.23e-07  1.13e-06    10s
  47   8.36991966e+04  8.36992014e+04  3.42e-09 4.75e-09  2.82e-08    10s
  48   8.36991994e+04  8.36992003e+04  5.45e-08 1.24e-07  5.11e-09    11s
  49   8.36992000e+04  8.36992003e+04  8.83e-07 2.81e-08  1.59e-09    11s

Barrier solved model in 49 iterations and 10.68 seconds (7.92 work units)
Optimal objective 8.36992000e+04


Root crossover log...

   81556 DPushes remaining with DInf 0.0000000e+00                11s
     639 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    8754 PPushes remaining with PInf 6.8485238e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.1838322e+03     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50446    8.3699200e+04   0.000000e+00   7.183832e+03     17s
   50868    8.3699200e+04   0.000000e+00   0.000000e+00     17s
   50868    8.3699200e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 1.89s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.369920e+04, 50868 iterations, 14.97 seconds (17.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83699.2003    0  193 -227427.98 83699.2003   137%     -   19s
H    0     0                    -194652.9368 83699.2003   143%     -   20s
H    0     0                    -194527.0055 83699.2003   143%     -   20s
H    0     0                    -182569.8478 83699.2003   146%     -   20s
H    0     0                    -171208.6113 83699.2003   149%     -   20s
H    0     0                    -171208.1362 83699.2003   149%     -   20s
H    0     0                    -170963.1526 83699.2003   149%     -   20s
H    0     0                    -170939.6812 83699.2003   149%     -   20s
H    0     0                    -45834.29664 83699.2003   283%     -   21s
H    0     0                    1814.2898978 83699.2003  4513%     -   21s
H    0     0                    23941.456325 83699.2003   250%     -   21s
H    0     0                    31926.881584 83699.2003   162%     -   23s
     0     0 78177.1349    0  289 31926.8816 78177.1349   145%     -   88s
H    0     0                    32129.990235 78176.1226   143%     -   90s
     0     0 77632.9801    0  293 32129.9902 77632.9801   142%     -  119s
     0     0 77504.5248    0  325 32129.9902 77504.5248   141%     -  131s
     0     0 77504.5248    0  258 32129.9902 77504.5248   141%     -  135s
     0     0 77504.5248    0  270 32129.9902 77504.5248   141%     -  137s
     0     0 77504.5248    0  240 32129.9902 77504.5248   141%     -  149s
     0     0 77502.0108    0  241 32129.9902 77502.0108   141%     -  150s
     0     0 77501.5959    0  246 32129.9902 77501.5959   141%     -  151s
H    0     0                    32259.582259 75001.1815   132%     -  196s
     0     0 74898.9122    0  226 32259.5823 74898.9122   132%     -  196s
H    0     0                    33872.933221 74898.9122   121%     -  197s
H    0     0                    37401.387353 74898.9122   100%     -  197s
H    0     0                    37645.985453 74898.9122  99.0%     -  197s
H    0     0                    38480.387240 74898.9122  94.6%     -  197s
H    0     0                    38519.780326 74898.9122  94.4%     -  197s
H    0     0                    38860.594867 74898.9122  92.7%     -  198s
H    0     0                    39795.582153 74898.9122  88.2%     -  198s
H    0     0                    40111.607096 74898.9122  86.7%     -  198s
H    0     0                    40522.202510 74898.9122  84.8%     -  198s
     0     0 74396.6654    0  244 40522.2025 74396.6654  83.6%     -  234s
     0     0 74299.9584    0  245 40522.2025 74299.9584  83.4%     -  251s
     0     0 74171.5035    0  284 40522.2025 74171.5035  83.0%     -  266s
     0     0 74097.7825    0  292 40522.2025 74097.7825  82.9%     -  284s
     0     0 73900.0797    0  286 40522.2025 73900.0797  82.4%     -  297s
     0     0 73860.5558    0  300 40522.2025 73860.5558  82.3%     -  309s
     0     0 73847.1440    0  292 40522.2025 73847.1440  82.2%     -  312s
     0     0 73838.9962    0  296 40522.2025 73838.9962  82.2%     -  316s
     0     0 73827.9723    0  295 40522.2025 73827.9723  82.2%     -  321s
     0     0 73797.4642    0  294 40522.2025 73797.4642  82.1%     -  330s
     0     0 73793.1199    0  286 40522.2025 73793.1199  82.1%     -  336s
     0     0 73791.2651    0  288 40522.2025 73791.2651  82.1%     -  339s
     0     0 73790.9650    0  291 40522.2025 73790.9650  82.1%     -  341s
H    0     0                    42284.550402 71722.0658  69.6%     -  441s
H    0     0                    42292.110551 71722.0658  69.6%     -  441s
H    0     0                    42487.018093 71722.0658  68.8%     -  441s
H    0     0                    42497.101717 71722.0658  68.8%     -  441s
H    0     0                    42657.394641 71722.0658  68.1%     -  441s
H    0     0                    42683.385988 71722.0658  68.0%     -  441s
     0     0 71722.0658    0  352 42683.3860 71722.0658  68.0%     -  441s
H    0     0                    43617.734501 71721.8503  64.4%     -  442s
H    0     0                    44014.910966 71721.8503  62.9%     -  442s
H    0     0                    44338.135823 71391.0115  61.0%     -  475s
H    0     0                    44373.850915 71391.0115  60.9%     -  475s
H    0     0                    44885.960178 71391.0115  59.0%     -  475s
H    0     0                    45109.372262 71391.0115  58.3%     -  475s
     0     0 71391.0115    0  386 45109.3723 71391.0115  58.3%     -  475s
     0     0 71232.7348    0  377 45109.3723 71232.7348  57.9%     -  499s
     0     0 71157.7228    0  378 45109.3723 71157.7228  57.7%     -  517s
H    0     0                    45165.970912 71142.3395  57.5%     -  526s
     0     0 71142.3395    0  380 45165.9709 71142.3395  57.5%     -  526s
H    0     0                    45239.217445 71125.4422  57.2%     -  536s
H    0     0                    45327.753739 71125.4422  56.9%     -  536s
H    0     0                    45345.705764 71125.4422  56.9%     -  536s
H    0     0                    45388.909344 71125.4422  56.7%     -  536s
H    0     0                    45414.558534 71125.4422  56.6%     -  536s
     0     0 71125.4422    0  386 45414.5585 71125.4422  56.6%     -  536s
     0     0 71115.2656    0  400 45414.5585 71115.2656  56.6%     -  541s
     0     0 71112.0194    0  394 45414.5585 71112.0194  56.6%     -  544s
     0     0 71105.8823    0  398 45414.5585 71105.8823  56.6%     -  547s
     0     0 71096.0536    0  387 45414.5585 71096.0536  56.5%     -  550s
     0     0 71093.7618    0  390 45414.5585 71093.7618  56.5%     -  551s
     0     0 71089.6751    0  387 45414.5585 71089.6751  56.5%     -  554s
     0     0 71086.6824    0  391 45414.5585 71086.6824  56.5%     -  559s
     0     0 71083.1403    0  391 45414.5585 71083.1403  56.5%     -  561s
     0     0 71081.5748    0  393 45414.5585 71081.5748  56.5%     -  562s
H    0     0                    46117.715526 70511.4160  52.9%     -  609s
     0     0 70511.4160    0  352 46117.7155 70511.4160  52.9%     -  609s
H    0     0                    46121.268577 70510.8098  52.9%     -  610s
H    0     0                    46161.649898 70510.8098  52.7%     -  610s
H    0     0                    46170.466916 70510.8098  52.7%     -  610s
     0     0 70335.4133    0  360 46170.4669 70335.4133  52.3%     -  637s
     0     0 70270.0242    0  404 46170.4669 70270.0242  52.2%     -  648s
     0     0 70250.2249    0  361 46170.4669 70250.2249  52.2%     -  655s
     0     0 70230.9408    0  373 46170.4669 70230.9408  52.1%     -  659s
     0     0 70216.4225    0  406 46170.4669 70216.4225  52.1%     -  665s
     0     0 70207.2805    0  357 46170.4669 70207.2805  52.1%     -  670s
     0     0 70204.8209    0  354 46170.4669 70204.8209  52.1%     -  672s
     0     0 70202.2383    0  354 46170.4669 70202.2383  52.1%     -  674s
     0     0 70201.6882    0  354 46170.4669 70201.6882  52.0%     -  676s
     0     0 69973.0508    0  426 46170.4669 69973.0508  51.6%     -  707s
     0     0 69925.6812    0  392 46170.4669 69925.6812  51.5%     -  720s
     0     0 69901.2174    0  393 46170.4669 69901.2174  51.4%     -  727s
     0     0 69886.1417    0  425 46170.4669 69886.1417  51.4%     -  737s
     0     0 69882.6965    0  416 46170.4669 69882.6965  51.4%     -  740s
     0     0 69881.2134    0  425 46170.4669 69881.2134  51.4%     -  743s
     0     0 69824.8365    0  410 46170.4669 69824.8365  51.2%     -  759s
     0     0 69747.9251    0  371 46170.4669 69747.9251  51.1%     -  779s
     0     0 69730.6522    0  414 46170.4669 69730.6522  51.0%     -  791s
     0     0 69727.4292    0  415 46170.4669 69727.4292  51.0%     -  794s
H    0     0                    46304.681657 69724.2323  50.6%     -  798s
     0     0 69724.2323    0  417 46304.6817 69724.2323  50.6%     -  798s
     0     0 69722.7422    0  416 46304.6817 69722.7422  50.6%     -  801s
     0     0 69683.0657    0  420 46304.6817 69683.0657  50.5%     -  812s
H    0     0                    46382.968726 69682.9042  50.2%     -  813s
     0     0 69665.9272    0  429 46382.9687 69665.9272  50.2%     -  823s
     0     0 69660.6016    0  433 46382.9687 69660.6016  50.2%     -  826s
     0     0 69658.6403    0  425 46382.9687 69658.6403  50.2%     -  828s
     0     0 69644.6546    0  424 46382.9687 69644.6546  50.2%     -  834s
H    0     0                    46506.355245 69644.6002  49.8%     -  835s
H    0     0                    46534.120372 69644.6002  49.7%     -  835s
H    0     0                    46610.697991 69644.6002  49.4%     -  835s
     0     0 69626.4589    0  424 46610.6980 69626.4589  49.4%     -  839s
     0     0 69622.8007    0  429 46610.6980 69622.8007  49.4%     -  841s
     0     0 69619.2468    0  424 46610.6980 69619.2468  49.4%     -  844s
     0     0 69618.1600    0  420 46610.6980 69618.1600  49.4%     -  845s
     0     0 69606.0436    0  425 46610.6980 69606.0436  49.3%     -  851s
H    0     0                    46639.917464 69605.7882  49.2%     -  852s
     0     0 69604.2231    0  428 46639.9175 69604.2231  49.2%     -  853s
     0     0 69565.6458    0  376 46639.9175 69565.6458  49.2%     -  862s
     0     0 69552.6875    0  423 46639.9175 69552.6875  49.1%     -  870s
     0     0 69550.9560    0  387 46639.9175 69550.9560  49.1%     -  873s
     0     0 69523.5982    0  412 46639.9175 69523.5982  49.1%     -  880s
     0     0 69514.9092    0  418 46639.9175 69514.9092  49.0%     -  885s
     0     0 69509.3538    0  419 46639.9175 69509.3538  49.0%     -  890s
     0     0 69507.6128    0  420 46639.9175 69507.6128  49.0%     -  892s
     0     0 69503.5672    0  424 46639.9175 69503.5672  49.0%     -  896s
     0     0 69501.8217    0  425 46639.9175 69501.8217  49.0%     -  900s
     0     0 69496.7503    0  433 46639.9175 69496.7503  49.0%     -  906s
     0     0 69490.9604    0  433 46639.9175 69490.9604  49.0%     -  910s
     0     0 69489.0123    0  442 46639.9175 69489.0123  49.0%     -  912s
     0     0 69484.0406    0  390 46639.9175 69484.0406  49.0%     -  917s
     0     0 69484.0151    0  390 46639.9175 69484.0151  49.0%     -  919s
H    0     0                    46701.073346 69483.0156  48.8%     - 1143s
H    0     0                    47130.647100 69483.0156  47.4%     - 1173s
H    0     0                    47150.785489 69483.0156  47.4%     - 1186s
H    0     2                    47264.709545 69483.0156  47.0%     - 1192s
     0     2 69483.0156    0  390 47264.7095 69483.0156  47.0%     - 1192s
     1     4 69448.8376    1  379 47264.7095 69483.0156  47.0%  2134 1209s
     3     6 69216.5446    2  423 47264.7095 69448.7678  46.9%  7076 1260s
     5    11 66577.3839    3  352 47264.7095 69448.7678  46.9% 11475 1290s
    10    20 66198.4199    4  299 47264.7095 69215.9109  46.4% 11916 1356s
    19    29 66585.2606    5  312 47264.7095 69208.7988  46.4% 17264 1418s
    28    56 66478.4341    4  412 47264.7095 68897.7248  45.8% 15625 1584s
H   29    56                    47269.066199 68897.7248  45.8% 15086 1584s
H   44    56                    48010.364815 68897.7248  43.5% 12728 1584s
    55    88 66370.8477    5  404 48010.3648 68897.7248  43.5% 18202 1625s
H   87   147                    48070.913144 68897.7248  43.3% 15782 1750s
H   88   147                    48730.149353 68897.7248  41.4% 15776 1750s
H   98   147                    48810.981138 68897.7248  41.2% 14725 1750s
H  100   147                    48857.778236 68897.7248  41.0% 14509 1750s
H  113   147                    49027.530475 68897.7248  40.5% 13493 1750s
   146   269 66012.7702    7  369 49027.5305 68897.7248  40.5% 12020 1810s
   268   336 65902.1384   12  333 49027.5305 68897.7248  40.5%  8576 1848s
   335   400 65352.4326   15  319 49027.5305 68897.7248  40.5%  7962 1888s
   399   466 65021.2749   17  341 49027.5305 68897.7248  40.5%  7395 1920s
   465   496 64820.0040   20  288 49027.5305 68897.7248  40.5%  7050 1951s
   495   529 64804.8016   21  298 49027.5305 68897.7248  40.5%  6987 2003s
   528   570 63768.4929   22  298 49027.5305 68897.7248  40.5%  7164 2026s
   569   606 63680.8494   23  290 49027.5305 68897.7248  40.5%  7175 2050s
   605   637 63570.0584   24  283 49027.5305 68897.7248  40.5%  7186 2075s
H  610   637                    49793.130582 68897.7248  38.4%  7181 2075s
   644   696 63446.8499   25  231 49793.1306 68897.7248  38.4%  7197 2102s
   705   759 63183.9979   28  205 49793.1306 68897.6011  38.4%  7143 2129s
   768   815 63028.2901   31  210 49793.1306 68897.6011  38.4%  7167 2154s
   826   853 62386.2926   33  193 49793.1306 68897.6011  38.4%  7175 2181s
H  870   881                    50113.698036 68897.6011  37.5%  7168 2206s
H  873   881                    51006.004824 68897.6011  35.1%  7177 2206s
   900   923 61233.5665   35  230 51006.0048 68897.6011  35.1%  7322 2241s
   950   986 54354.9926   38  180 51006.0048 68897.6011  35.1%  7497 2268s
  1029  1032 53937.2692   44  147 51006.0048 68897.6011  35.1%  7325 2299s
H 1115  1062                    51420.454705 68897.6011  34.0%  7136 2331s
H 1134  1062                    51431.471631 68897.6011  34.0%  7090 2331s
H 1158  1062                    51440.005198 68897.6011  33.9%  7127 2331s
H 1178  1062                    51478.832263 68897.6011  33.8%  7014 2331s
  1182  1062     cutoff   56      51478.8323 68897.6011  33.8%  7038 2369s
  1240  1098 54882.3202   19  283 51478.8323 68897.6011  33.8%  7098 2404s
  1308  1138 infeasible   20      51478.8323 68897.6011  33.8%  7217 2442s
  1402  1190 52921.4497   22  233 51478.8323 68897.6011  33.8%  7209 2485s
  1512  1205 52780.6366   26  200 51478.8323 68897.6011  33.8%  7159 2528s
H 1514  1205                    51536.924820 68897.6011  33.7%  7154 2528s
  1582  1216 52339.8472   28  141 51536.9248 68897.6011  33.7%  7145 2573s
H 1598  1216                    51593.441440 68897.6011  33.5%  7099 2573s
  1635  1242     cutoff   32      51593.4414 68897.6011  33.5%  7184 2615s
  1706  1290 61298.7504   10  373 51593.4414 68897.6011  33.5%  7267 2662s
  1792  1338 60592.5911   11  381 51593.4414 68897.6011  33.5%  7328 2714s
  1888  1410 60311.8549   12  365 51593.4414 68897.6011  33.5%  7387 2765s
  1984  1432 52528.2794   29  200 51593.4414 68897.6011  33.5%  7479 2820s
H 1990  1432                    51828.061434 68897.6011  32.9%  7474 2821s
H 2018  1463                    51839.616009 68897.6011  32.9%  7595 2866s
H 2020  1463                    51866.782253 68897.6011  32.8%  7592 2866s
H 2021  1463                    51874.462471 68897.6011  32.8%  7594 2866s
H 2030  1463                    51981.240973 68897.6011  32.5%  7587 2867s
  2063  1556 60661.4758   11  397 51981.2410 68897.6011  32.5%  7659 2925s
  2188  1643 53849.4761   57  229 51981.2410 68897.6011  32.5%  7659 2972s
  2301  1693     cutoff   57      51981.2410 68026.9133  30.9%  7728 3031s
  2425  1796 66946.7557    5  338 51981.2410 67973.5133  30.8%  7747 3096s
  2556  1835 60896.6609    6  311 51981.2410 67973.5133  30.8%  7795 3154s
  2718  1914 59126.8610    8  322 51981.2410 67973.5133  30.8%  7791 3223s
  2859  2000 58576.6226    9  307 51981.2410 67500.0603  29.9%  7795 3292s
  2993  2094 57249.5335   12  262 51981.2410 67500.0603  29.9%  7874 3363s
  3133  2131 56075.8444   17  296 51981.2410 67451.1769  29.8%  7942 3423s
  3174  2239 55625.8571   18  301 51981.2410 67359.2805  29.6%  8051 3487s
  3314  2385 55130.1605   21  241 51981.2410 67359.2805  29.6%  8037 3566s
  3502  2463 54231.0929   27  216 51981.2410 67336.3562  29.5%  8007 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 46
  MIR: 1740
  Flow cover: 2450
  RLT: 54
  Relax-and-lift: 444

Explored 3620 nodes (29210905 simplex iterations) in 3600.06 seconds (5680.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 51981.2 51874.5 51866.8 ... 51431.5

Time limit reached
Best objective 5.198124097346e+04, best bound 6.733635619483e+04, gap 29.5397%
  WARNING: Time limit reached. Using best solution found (gap: 29.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 51981.24, θ = 202065.88
  Upper Bound (UB) = 51981.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202065.88
  [DEBUG]   ✓ Scenario 0: θ = 202065.88 ≤ Q = 202065.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 202065.88 ≤ Q = 202125.99 (slack: 60.11)
  [DEBUG]   ✓ Scenario 2: θ = 202065.88 ≤ Q = 202065.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 202065.88 ≤ Q = 202065.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 202065.88 ≤ Q = 202065.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 202065.88 ≤ Q = 202065.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 202065.88 ≤ Q = 202065.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 202065.88 ≤ Q = 202065.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 202065.88 ≤ Q = 202065.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 202065.88 ≤ Q = 202065.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 202065.88 ≤ Q = 202065.88 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x69ea9a66
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x69ea9a66
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.515153e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7317222.6406
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.712702e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171270.17    0  128 7317222.64 -171270.17   102%     -    0s
H    0     0                    -135358.5459 -171270.17  26.5%     -    0s
H    0     0                    -136138.6229 -171270.17  25.8%     -    0s
H    0     0                    -137516.4897 -171270.17  24.5%     -    0s
H    0     0                    -138274.1870 -149876.64  8.39%     -    0s
     0     0 -149876.64    0  101 -138274.19 -149876.64  8.39%     -    0s
H    0     0                    -144362.6175 -149737.06  3.72%     -    0s
H    0     0                    -144669.6533 -149737.06  3.50%     -    0s
     0     0 -149418.13    0   97 -144669.65 -149418.13  3.28%     -    0s
     0     0 -149412.55    0   97 -144669.65 -149412.55  3.28%     -    0s
H    0     0                    -145887.4688 -149412.55  2.42%     -    0s
H    0     0                    -146189.1777 -149412.55  2.20%     -    0s
     0     0 -148108.98    0   69 -146189.18 -148108.98  1.31%     -    0s
H    0     0                    -147530.4025 -148106.60  0.39%     -    0s
     0     0 -148099.60    0   51 -147530.40 -148099.60  0.39%     -    0s
     0     0 -147998.91    0   71 -147530.40 -147998.91  0.32%     -    0s
     0     0 -147998.66    0   65 -147530.40 -147998.66  0.32%     -    0s
     0     0 -147972.40    0   65 -147530.40 -147972.40  0.30%     -    0s
     0     0 -147972.40    0   81 -147530.40 -147972.40  0.30%     -    0s
     0     0 -147972.40    0   66 -147530.40 -147972.40  0.30%     -    0s
     0     0 -147911.59    0   65 -147530.40 -147911.59  0.26%     -    0s
     0     0 -147911.29    0   63 -147530.40 -147911.29  0.26%     -    0s
     0     0 -147888.83    0   69 -147530.40 -147888.83  0.24%     -    0s
     0     0 -147887.70    0   67 -147530.40 -147887.70  0.24%     -    0s
     0     0 -147825.20    0   31 -147530.40 -147825.20  0.20%     -    0s
     0     0 -147809.28    0   42 -147530.40 -147809.28  0.19%     -    0s
     0     0 -147807.78    0   32 -147530.40 -147807.78  0.19%     -    0s
     0     0 -147793.54    0   64 -147530.40 -147793.54  0.18%     -    0s
     0     0 -147785.83    0   64 -147530.40 -147785.83  0.17%     -    0s
     0     2 -147785.83    0   64 -147530.40 -147785.83  0.17%     -    0s
*   31     9               7    -147696.5915 -147707.24  0.01%  11.2    0s
*   36     7               7    -147707.2404 -147707.24  0.00%  10.4    0s

Cutting planes:
  Gomory: 44
  Implied bound: 8
  MIR: 81
  Flow cover: 15
  RLT: 6
  Relax-and-lift: 5

Explored 41 nodes (1529 simplex iterations) in 0.24 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -147707 -147697 -147530 ... 7.31722e+06
No other solutions better than -147707

Optimal solution found (tolerance 1.00e-06)
Best objective -1.477072404152e+05, best bound -1.477072404152e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 193418.67
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147707.24
  [DEBUG]   S×d_nominal = 341125.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341125.91 + -147707.24 = 193418.67
  [DEBUG]   Current θ from Master = 202065.88
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8647.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43334.04
  Lower Bound (LB) = 47833.94
  Gap (UB-LB) = 4147.3021, Absolute Gap = 4147.3021, Relative Gap = 0.079785
  Not converged yet (gap = 4147.30 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x7baf48b8
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 85140 rows and 34590 columns
Presolve time: 3.15s
Presolved: 99723 rows, 42550 columns, 606299 nonzeros
Variable types: 40291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -306566.1332
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 Dense cols : 638
 AA' NZ     : 3.494e+06
 Factor NZ  : 8.199e+06 (roughly 120 MB of memory)
 Factor Ops : 1.560e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.87581253e+07  1.99362649e+08  1.34e+05 1.80e+01  8.86e+04     5s
   1  -1.43859800e+07  1.82512076e+08  9.45e+04 9.52e+01  6.17e+04     5s
   2  -4.28805578e+06  1.41500723e+08  2.78e+04 2.09e+01  1.93e+04     5s
   3  -1.24735460e+06  9.74911861e+07  4.53e+03 9.24e-01  3.47e+03     5s
   4  -6.42410913e+05  7.45386355e+07  7.77e+02 4.68e-01  8.89e+02     5s
   5  -5.42306340e+05  4.03409889e+07  3.74e+02 2.11e-01  4.27e+02     6s
   6  -3.78388683e+05  2.89113048e+07  9.88e+01 1.42e-01  2.10e+02     6s
   7  -3.16908888e+05  2.54771385e+07  5.05e+01 1.23e-01  1.65e+02     6s
   8  -2.00692918e+05  1.39711489e+07  1.07e+01 6.33e-02  8.11e+01     6s
   9  -1.21106300e+05  5.12280559e+06  4.03e+00 2.15e-02  2.93e+01     6s
  10  -7.68642637e+04  3.11689859e+06  2.14e+00 1.33e-02  1.77e+01     6s
  11  -4.08852707e+04  1.76803044e+06  1.05e+00 7.27e-03  9.96e+00     6s
  12  -4.70623865e+03  6.55660856e+05  4.84e-01 2.25e-03  3.63e+00     6s
  13   9.57854596e+03  3.73242063e+05  3.43e-01 1.02e-03  2.00e+00     6s
  14   2.41001304e+04  2.57955620e+05  2.21e-01 6.57e-04  1.28e+00     6s
  15   3.25827349e+04  2.14077330e+05  1.83e-01 1.21e-03  9.95e-01     6s
  16   4.46004001e+04  1.64290800e+05  1.30e-01 2.00e-03  6.56e-01     6s
  17   5.17866016e+04  1.44293823e+05  1.01e-01 1.77e-03  5.07e-01     7s
  18   5.70919139e+04  1.28819804e+05  8.00e-02 1.73e-03  3.93e-01     7s
  19   6.59642123e+04  1.19555411e+05  4.91e-02 1.62e-03  2.94e-01     7s
  20   6.93607677e+04  1.08493876e+05  3.83e-02 1.77e-03  2.14e-01     7s
  21   7.23335843e+04  1.02268731e+05  2.95e-02 1.34e-03  1.64e-01     7s
  22   7.35064240e+04  9.83996679e+04  2.61e-02 1.07e-03  1.36e-01     7s
  23   7.58963248e+04  9.46869109e+04  1.95e-02 7.92e-04  1.03e-01     7s
  24   7.75046299e+04  9.22055449e+04  1.53e-02 6.09e-04  8.05e-02     7s
  25   7.85627002e+04  9.11077212e+04  1.26e-02 5.29e-04  6.87e-02     7s
  26   7.94985022e+04  8.78247139e+04  1.03e-02 2.91e-04  4.56e-02     8s
  27   8.00360336e+04  8.72933771e+04  8.99e-03 2.50e-04  3.98e-02     8s
  28   8.11949418e+04  8.62531730e+04  6.26e-03 1.91e-04  2.77e-02     8s
  29   8.19769277e+04  8.60012303e+04  4.46e-03 1.74e-04  2.20e-02     8s
  30   8.24906307e+04  8.58018188e+04  3.31e-03 1.57e-04  1.81e-02     8s
  31   8.26611788e+04  8.52233501e+04  2.91e-03 1.08e-04  1.40e-02     8s
  32   8.30100073e+04  8.49217395e+04  2.11e-03 9.18e-05  1.05e-02     8s
  33   8.32268414e+04  8.47879907e+04  1.60e-03 7.86e-05  8.55e-03     9s
  34   8.34063062e+04  8.44610003e+04  1.21e-03 6.10e-05  5.78e-03     9s
  35   8.37379133e+04  8.43325642e+04  5.04e-04 4.30e-05  3.26e-03     9s
  36   8.37916436e+04  8.42827864e+04  3.95e-04 3.66e-05  2.69e-03     9s
  37   8.38786740e+04  8.42093161e+04  2.33e-04 2.68e-05  1.81e-03     9s
  38   8.39199542e+04  8.41425544e+04  1.52e-04 1.78e-05  1.22e-03     9s
  39   8.39347811e+04  8.41304013e+04  1.24e-04 1.62e-05  1.07e-03     9s
  40   8.39546029e+04  8.40883900e+04  8.48e-05 1.07e-05  7.33e-04     9s
  41   8.39747102e+04  8.40770493e+04  4.97e-05 9.16e-06  5.60e-04    10s
  42   8.39875311e+04  8.40373777e+04  2.84e-05 3.91e-06  2.73e-04    10s
  43   8.39937923e+04  8.40318448e+04  1.83e-05 3.20e-06  2.08e-04    10s
  44   8.39945339e+04  8.40251038e+04  1.71e-05 2.38e-06  1.67e-04    10s
  45   8.39999446e+04  8.40101081e+04  9.31e-06 1.07e-06  5.57e-05    10s
  46   8.40029326e+04  8.40099658e+04  5.04e-06 1.03e-06  3.85e-05    10s
  47   8.40041760e+04  8.40088755e+04  3.19e-06 7.01e-07  2.57e-05    10s
  48   8.40051957e+04  8.40085970e+04  1.78e-06 6.28e-07  1.86e-05    10s
  49   8.40055838e+04  8.40079142e+04  1.22e-06 4.25e-07  1.28e-05    11s
  50   8.40061949e+04  8.40068299e+04  3.47e-07 1.23e-07  3.48e-06    11s
  51   8.40064311e+04  8.40065638e+04  1.18e-07 2.96e-08  7.26e-07    11s
  52   8.40064577e+04  8.40065477e+04  4.74e-08 2.37e-08  4.92e-07    11s
  53   8.40064785e+04  8.40064907e+04  7.73e-09 2.75e-09  6.66e-08    11s
  54   8.40064825e+04  8.40064825e+04  1.85e-09 3.73e-09  7.01e-11    12s

Barrier solved model in 54 iterations and 11.54 seconds (9.82 work units)
Optimal objective 8.40064825e+04


Root crossover log...

   88048 DPushes remaining with DInf 0.0000000e+00                12s
    1812 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    1284 PPushes remaining with PInf 3.8523453e-06                16s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.9451766e-03     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39012    8.4006482e+04   0.000000e+00   8.945176e-03     16s
   39015    8.4006482e+04   0.000000e+00   0.000000e+00     16s
   39015    8.4006482e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.400648e+04, 39015 iterations, 12.13 seconds (14.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 84006.4825    0  190 -227427.98 84006.4825   137%     -   17s
H    0     0                    -221394.9640 84006.4825   138%     -   17s
H    0     0                    -189365.3069 84006.4825   144%     -   17s
H    0     0                    -175100.8210 84006.4825   148%     -   17s
H    0     0                    -174961.8029 84006.4825   148%     -   17s
H    0     0                    -174480.4918 84006.4825   148%     -   18s
H    0     0                    -173859.2986 84006.4825   148%     -   18s
H    0     0                    -173844.3147 84006.4825   148%     -   18s
H    0     0                    -61794.65450 84006.4825   236%     -   18s
H    0     0                    -44427.02449 84006.4825   289%     -   18s
H    0     0                    5952.1373472 84006.4825  1311%     -   18s
H    0     0                    11306.635094 84006.4825   643%     -   19s
H    0     0                    14740.460989 84006.4825   470%     -   19s
H    0     0                    15445.494873 84006.4825   444%     -   19s
H    0     0                    15588.869075 84006.4825   439%     -   19s
H    0     0                    21385.175756 84006.4825   293%     -   21s
H    0     0                    21544.410311 84006.4825   290%     -   21s
H    0     0                    23786.401819 84006.4825   253%     -   21s
H    0     0                    26824.488158 84006.3272   213%     -   22s
H    0     0                    28571.956971 84006.3272   194%     -   22s
H    0     0                    28959.468822 84006.3272   190%     -   22s
H    0     0                    31975.021857 78547.0207   146%     -   77s
     0     0 78547.0207    0  291 31975.0219 78547.0207   146%     -   78s
H    0     0                    33258.878868 78546.2484   136%     -   78s
     0     0 78163.0232    0  290 33258.8789 78163.0232   135%     -  106s
     0     0 78117.7421    0  295 33258.8789 78117.7421   135%     -  116s
     0     0 78073.8388    0  303 33258.8789 78073.8388   135%     -  125s
     0     0 78064.2931    0  305 33258.8789 78064.2931   135%     -  134s
     0     0 78056.1080    0  301 33258.8789 78056.1080   135%     -  136s
     0     0 78056.1080    0  297 33258.8789 78056.1080   135%     -  138s
     0     0 78056.1080    0  297 33258.8789 78056.1080   135%     -  145s
     0     0 78056.1080    0  297 33258.8789 78056.1080   135%     -  148s
     0     0 78056.1080    0  297 33258.8789 78056.1080   135%     -  149s
H    0     0                    33917.550194 74508.9189   120%     -  242s
H    0     0                    33976.038370 74508.9189   119%     -  242s
     0     0 74508.9189    0  271 33976.0384 74508.9189   119%     -  242s
     0     0 74094.3248    0  269 33976.0384 74094.3248   118%     -  285s
     0     0 73981.0641    0  281 33976.0384 73981.0641   118%     -  307s
     0     0 73921.4052    0  287 33976.0384 73921.4052   118%     -  321s
     0     0 73873.6709    0  290 33976.0384 73873.6709   117%     -  336s
     0     0 73858.4051    0  283 33976.0384 73858.4051   117%     -  348s
     0     0 73818.8474    0  272 33976.0384 73818.8474   117%     -  365s
     0     0 73802.8439    0  288 33976.0384 73802.8439   117%     -  375s
     0     0 73801.9380    0  291 33976.0384 73801.9380   117%     -  377s
H    0     0                    41873.671631 73801.9380  76.2%     -  396s
H    0     0                    41877.496240 73801.9380  76.2%     -  396s
H    0     0                    43412.147149 73801.9380  70.0%     -  396s
H    0     0                    43412.908829 73801.9380  70.0%     -  396s
H    0     0                    43611.623764 73801.9380  69.2%     -  396s
H    0     0                    43803.954858 73801.9380  68.5%     -  396s
H    0     0                    44048.333663 73801.9380  67.5%     -  396s
H    0     0                    44120.183945 73801.9380  67.3%     -  396s
H    0     0                    44256.043581 71990.0335  62.7%     -  494s
H    0     0                    45144.049813 71990.0335  59.5%     -  494s
H    0     0                    45280.141824 71990.0335  59.0%     -  494s
H    0     0                    45281.015984 71990.0335  59.0%     -  494s
H    0     0                    45469.120264 71990.0335  58.3%     -  494s
H    0     0                    45488.187994 71990.0335  58.3%     -  494s
H    0     0                    45500.932168 71990.0335  58.2%     -  494s
     0     0 71990.0335    0  387 45500.9322 71990.0335  58.2%     -  494s
H    0     0                    45698.215459 71989.8434  57.5%     -  495s
     0     0 71388.2245    0  399 45698.2155 71388.2245  56.2%     -  542s
     0     0 71279.5989    0  417 45698.2155 71279.5989  56.0%     -  567s
     0     0 71226.2864    0  421 45698.2155 71226.2864  55.9%     -  587s
     0     0 71093.7194    0  415 45698.2155 71093.7194  55.6%     -  618s
     0     0 71075.3359    0  413 45698.2155 71075.3359  55.5%     -  628s
     0     0 71041.8864    0  418 45698.2155 71041.8864  55.5%     -  638s
     0     0 71030.2898    0  428 45698.2155 71030.2898  55.4%     -  644s
     0     0 71026.9380    0  417 45698.2155 71026.9380  55.4%     -  647s
     0     0 71023.5503    0  420 45698.2155 71023.5503  55.4%     -  651s
     0     0 71017.6653    0  420 45698.2155 71017.6653  55.4%     -  658s
     0     0 71013.2686    0  428 45698.2155 71013.2686  55.4%     -  664s
     0     0 71012.5553    0  426 45698.2155 71012.5553  55.4%     -  665s
     0     0 70501.1735    0  346 45698.2155 70501.1735  54.3%     -  732s
H    0     0                    45701.944265 70500.6402  54.3%     -  733s
H    0     0                    45739.957196 70500.6402  54.1%     -  733s
     0     0 70420.2629    0  395 45739.9572 70420.2629  54.0%     -  756s
     0     0 70337.1584    0  393 45739.9572 70337.1584  53.8%     -  774s
     0     0 70301.8765    0  372 45739.9572 70301.8765  53.7%     -  786s
     0     0 70283.8143    0  363 45739.9572 70283.8143  53.7%     -  796s
     0     0 70269.7889    0  366 45739.9572 70269.7889  53.6%     -  801s
     0     0 70245.7023    0  410 45739.9572 70245.7023  53.6%     -  809s
     0     0 70239.8968    0  398 45739.9572 70239.8968  53.6%     -  812s
     0     0 70231.4616    0  363 45739.9572 70231.4616  53.5%     -  815s
     0     0 70219.4034    0  368 45739.9572 70219.4034  53.5%     -  819s
     0     0 70215.4346    0  370 45739.9572 70215.4346  53.5%     -  823s
     0     0 70213.3530    0  370 45739.9572 70213.3530  53.5%     -  825s
     0     0 70212.5896    0  371 45739.9572 70212.5896  53.5%     -  826s
H    0     0                    45851.784443 70049.3718  52.8%     -  853s
H    0     0                    45874.920160 70049.3718  52.7%     -  853s
     0     0 70049.3718    0  412 45874.9202 70049.3718  52.7%     -  853s
H    0     0                    45904.058693 70003.7534  52.5%     -  874s
     0     0 70003.7534    0  419 45904.0587 70003.7534  52.5%     -  874s
     0     0 69992.5909    0  422 45904.0587 69992.5909  52.5%     -  883s
     0     0 69978.8773    0  423 45904.0587 69978.8773  52.4%     -  892s
     0     0 69974.4777    0  424 45904.0587 69974.4777  52.4%     -  898s
     0     0 69971.5994    0  433 45904.0587 69971.5994  52.4%     -  903s
     0     0 69967.7538    0  425 45904.0587 69967.7538  52.4%     -  907s
     0     0 69966.9387    0  428 45904.0587 69966.9387  52.4%     -  910s
     0     0 69848.9520    0  408 45904.0587 69848.9520  52.2%     -  936s
     0     0 69772.0551    0  420 45904.0587 69772.0551  52.0%     -  961s
     0     0 69753.9525    0  424 45904.0587 69753.9525  52.0%     -  969s
     0     0 69750.7328    0  424 45904.0587 69750.7328  51.9%     -  971s
     0     0 69745.9888    0  425 45904.0587 69745.9888  51.9%     -  978s
     0     0 69741.4045    0  428 45904.0587 69741.4045  51.9%     -  983s
     0     0 69740.5080    0  426 45904.0587 69740.5080  51.9%     -  984s
     0     0 69667.6501    0  431 45904.0587 69667.6501  51.8%     - 1001s
     0     0 69642.6235    0  440 45904.0587 69642.6235  51.7%     - 1010s
     0     0 69625.6611    0  440 45904.0587 69625.6611  51.7%     - 1016s
     0     0 69620.4409    0  429 45904.0587 69620.4409  51.7%     - 1020s
     0     0 69617.1105    0  433 45904.0587 69617.1105  51.7%     - 1022s
H    0     0                    45912.075792 69606.0076  51.6%     - 1028s
H    0     0                    45954.553956 69606.0076  51.5%     - 1028s
     0     0 69606.0076    0  419 45954.5540 69606.0076  51.5%     - 1028s
     0     0 69604.2345    0  419 45954.5540 69604.2345  51.5%     - 1031s
     0     0 69577.8278    0  430 45954.5540 69577.8278  51.4%     - 1045s
     0     0 69570.8750    0  425 45954.5540 69570.8750  51.4%     - 1050s
     0     0 69567.7519    0  427 45954.5540 69567.7519  51.4%     - 1052s
     0     0 69565.4953    0  424 45954.5540 69565.4953  51.4%     - 1054s
     0     0 69564.6298    0  429 45954.5540 69564.6298  51.4%     - 1057s
     0     0 69545.9694    0  430 45954.5540 69545.9694  51.3%     - 1070s
     0     0 69541.4464    0  428 45954.5540 69541.4464  51.3%     - 1076s
     0     0 69540.7754    0  431 45954.5540 69540.7754  51.3%     - 1078s
     0     0 69531.8558    0  428 45954.5540 69531.8558  51.3%     - 1089s
     0     0 69530.1660    0  436 45954.5540 69530.1660  51.3%     - 1094s
H    0     0                    46331.886179 69514.2087  50.0%     - 1104s
     0     0 69514.2087    0  432 46331.8862 69514.2087  50.0%     - 1104s
     0     0 69512.1188    0  429 46331.8862 69512.1188  50.0%     - 1108s
     0     0 69511.2978    0  428 46331.8862 69511.2978  50.0%     - 1110s
     0     0 69507.7914    0  429 46331.8862 69507.7914  50.0%     - 1116s
     0     0 69506.9499    0  429 46331.8862 69506.9499  50.0%     - 1120s
H    0     0                    46449.718238 69506.9499  49.6%     - 1332s
H    0     0                    46460.256501 69506.9499  49.6%     - 1341s
H    0     2                    46585.189010 69506.9499  49.2%     - 1352s
     0     2 69506.9499    0  429 46585.1890 69506.9499  49.2%     - 1352s
     1     4 69472.7625    1  408 46585.1890 69506.9499  49.2%  5740 1374s
     3     8 69410.7256    2  410 46585.1890 69471.8354  49.1%  8403 1403s
     7    16 69311.4624    3  412 46585.1890 69410.1428  49.0%  9904 1449s
    15    32 69207.4966    4  411 46585.1890 69311.2773  48.8% 12547 1482s
    31    48 68550.4670    5  350 46585.1890 69207.4351  48.6% 17242 1601s
    47    80 66958.3770    6  351 46585.1890 69207.4351  48.6% 17544 1677s
H   74    80                    46764.047942 69207.4351  48.0% 15869 1677s
    79   143 66921.3601    7  334 46764.0479 69207.4351  48.0% 15578 1887s
   142   175 64645.0746    8  280 46764.0479 69207.4351  48.0% 11653 1963s
   174   207 66884.9538    9  332 46764.0479 69207.4351  48.0% 11063 2029s
H  183   207                    46958.102896 69207.4351  47.4% 10609 2029s
   206   346 66866.7669   10  335 46958.1029 69207.4351  47.4%  9904 2117s
   345   448 66643.8741   12  335 46958.1029 69207.4351  47.4%  7651 2177s
   447   541 66636.7171   11  318 46958.1029 69207.4351  47.4%  6750 2228s
   540   619 66599.2583   13  333 46958.1029 69207.4351  47.4%  6190 2268s
   618   706 65694.7524   13  318 46958.1029 69207.4351  47.4%  5857 2306s
   707   787 66002.9155   13  329 46958.1029 69207.4351  47.4%  5459 2355s
   788   866 66399.6225   14  325 46958.1029 69207.4351  47.4%  5144 2392s
   867   964 66281.9050   15  318 46958.1029 69207.4351  47.4%  4893 2430s
   967  1052 66089.7364   15  331 46958.1029 69207.4351  47.4%  4606 2470s
  1061  1140 66078.7213   16  317 46958.1029 69207.4351  47.4%  4422 2508s
  1167  1228 66015.8757   16  336 46958.1029 69207.4351  47.4%  4256 2541s
  1279  1253 65884.9804   17  320 46958.1029 69207.4351  47.4%  4079 2581s
  1306  1284 65988.8173   17  315 46958.1029 69207.4351  47.4%  4087 2616s
H 1322  1284                    47004.363340 69207.4351  47.2%  4097 2616s
  1337  1338 65810.9045   17  317 47004.3633 69207.4351  47.2%  4106 2649s
H 1338  1338                    47376.050296 69207.4351  46.1%  4103 2649s
H 1345  1338                    47434.266742 69207.4351  45.9%  4093 2649s
H 1352  1338                    47486.835015 69207.4351  45.7%  4082 2649s
H 1397  1338                    47544.250815 69207.4351  45.6%  4036 2649s
  1401  1428 65900.3354   17  318 47544.2508 69207.4351  45.6%  4042 2692s
  1519  1570 65554.7708   18  272 47544.2508 69207.4351  45.6%  3926 2737s
  1673  1746 65839.7448   18  270 47544.2508 69207.4351  45.6%  3744 2778s
  1859  1932 62377.9750   18  308 47544.2508 69207.4351  45.6%  3549 2820s
  2059  2037 48478.4433   44  171 47544.2508 69207.4351  45.6%  3389 2862s
  2247  2216 63545.5210   19  241 47544.2508 69207.4351  45.6%  3254 2910s
  2498  2237 63047.1759   20  235 47544.2508 69207.4351  45.6%  3068 2949s
  2533  2226 57885.0037   20  230 47544.2508 69207.4351  45.6%  3069 2993s
  2622  2243 61800.2332   21  277 47544.2508 69207.4351  45.6%  3049 3038s
H 2630  2243                    47676.226440 69207.4351  45.2%  3050 3038s
H 2646  2243                    47792.534108 69207.4351  44.8%  3059 3038s
  2671  2285 58171.6505    8  256 47792.5341 69207.4351  44.8%  3086 3096s
  2831  2338 55858.9984   22  223 47792.5341 69207.4351  44.8%  3033 3154s
  2958  2398 49145.6135   11  213 47792.5341 69207.4351  44.8%  3061 3214s
  3075  2433 56471.7489   21  245 47792.5341 69207.4351  44.8%  3073 3272s
H 3077  2433                    47805.188656 69207.4351  44.8%  3076 3272s
H 3105  2433                    47834.437179 69207.4351  44.7%  3075 3272s
  3138  2490 56037.2139   22  282 47834.4372 69207.4351  44.7%  3114 3328s
  3261  2531 53700.1953   23  204 47834.4372 69207.4351  44.7%  3141 3388s
H 3309  2226                    50328.230116 69207.4351  37.5%  3200 3388s
  3330  2256     cutoff   24      50328.2301 69207.4351  37.5%  3186 3456s
  3448  2303 52391.9980   26  187 50328.2301 69207.4351  37.5%  3214 3528s
  3558  2358 51370.1388   28  217 50328.2301 69207.4351  37.5%  3263 3600s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 81
  MIR: 1786
  Flow cover: 2678
  RLT: 69
  Relax-and-lift: 578

Explored 3703 nodes (12710247 simplex iterations) in 3600.06 seconds (4875.47 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 50328.2 47834.4 47805.2 ... 47004.4

Time limit reached
Best objective 5.032823011601e+04, best bound 6.908892495424e+04, gap 37.2767%
  WARNING: Time limit reached. Using best solution found (gap: 37.28%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 50328.23, θ = 203920.29
  Upper Bound (UB) = 50328.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 203920.29
  [DEBUG]   ✓ Scenario 0: θ = 203920.29 ≤ Q = 203920.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 203920.29 ≤ Q = 203920.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 203920.29 ≤ Q = 203920.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 203920.29 ≤ Q = 203920.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 203920.29 ≤ Q = 203920.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 203920.29 ≤ Q = 203920.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 203920.29 ≤ Q = 203920.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 203920.29 ≤ Q = 203920.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 203920.29 ≤ Q = 203920.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 203920.29 ≤ Q = 203920.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 203920.29 ≤ Q = 203920.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 203920.29 ≤ Q = 203920.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1152b663
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeead499d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.509896e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1396 nonzeros
Found heuristic solution: objective 7358424.5180
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.663796e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166379.59    0  123 7358424.52 -166379.59   102%     -    0s
H    0     0                    -131434.9783 -166379.59  26.6%     -    0s
H    0     0                    -131682.9747 -166379.59  26.3%     -    0s
     0     0 -144156.51    0  102 -131682.97 -144156.51  9.47%     -    0s
H    0     0                    -138863.1372 -144021.31  3.71%     -    0s
     0     0 -142542.45    0  103 -138863.14 -142542.45  2.65%     -    0s
H    0     0                    -141256.5943 -142438.74  0.84%     -    0s
     0     0 -142438.74    0   88 -141256.59 -142438.74  0.84%     -    0s
     0     0 -142438.74    0  103 -141256.59 -142438.74  0.84%     -    0s
     0     0 -141992.15    0   58 -141256.59 -141992.15  0.52%     -    0s
     0     0 -141811.40    0   87 -141256.59 -141811.40  0.39%     -    0s
     0     0 -141802.54    0   66 -141256.59 -141802.54  0.39%     -    0s
     0     0 -141569.20    0   81 -141256.59 -141569.20  0.22%     -    0s
     0     0 -141557.22    0   76 -141256.59 -141557.22  0.21%     -    0s
     0     0 -141556.85    0   70 -141256.59 -141556.85  0.21%     -    0s
     0     0 -141538.72    0   60 -141256.59 -141538.72  0.20%     -    0s
     0     0 -141506.08    0   48 -141256.59 -141506.08  0.18%     -    0s
     0     0 -141477.63    0   48 -141256.59 -141477.63  0.16%     -    0s
     0     0 -141459.15    0   23 -141256.59 -141459.15  0.14%     -    0s
H    0     0                    -141297.5235 -141454.31  0.11%     -    0s
     0     0 -141424.70    0   30 -141297.52 -141424.70  0.09%     -    0s
     0     0 -141356.02    0   14 -141297.52 -141356.02  0.04%     -    0s
     0     0 -141345.73    0   13 -141297.52 -141345.73  0.03%     -    0s
     0     0 -141342.18    0    8 -141297.52 -141342.18  0.03%     -    0s
     0     0 -141341.81    0    9 -141297.52 -141341.81  0.03%     -    0s
     0     0 -141312.56    0    5 -141297.52 -141312.56  0.01%     -    0s
     0     0 -141311.06    0    7 -141297.52 -141311.06  0.01%     -    0s
     0     0 -141300.14    0    3 -141297.52 -141300.14  0.00%     -    0s
     0     0     cutoff    0      -141297.52 -141297.52  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 1
  Flow cover: 1
  Relax-and-lift: 1

Explored 1 nodes (873 simplex iterations) in 0.15 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -141298 -141257 -138863 ... 1.5099e+13
No other solutions better than -141298

Optimal solution found (tolerance 1.00e-06)
Best objective -1.412975235426e+05, best bound -1.412975235426e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 198412.84
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141297.52
  [DEBUG]   S×d_nominal = 339710.36
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 339710.36 + -141297.52 = 198412.84
  [DEBUG]   Current θ from Master = 203920.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5507.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 44820.78
  Lower Bound (LB) = 47833.94
  Gap (UB-LB) = 2494.2912, Absolute Gap = 2494.2912, Relative Gap = 0.049560
  Not converged yet (gap = 2494.29 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x236c4146
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 92210 rows and 37460 columns
Presolve time: 3.93s
Presolved: 107943 rows, 45920 columns, 651421 nonzeros
Variable types: 43661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310684.9051
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.39s

Barrier statistics:
 Dense cols : 628
 AA' NZ     : 3.903e+06
 Factor NZ  : 1.010e+07 (roughly 140 MB of memory)
 Factor Ops : 2.992e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.94623057e+07  2.14070848e+08  1.41e+05 1.62e+01  9.14e+04     6s
   1  -1.49488314e+07  1.97666493e+08  9.88e+04 9.60e+01  6.33e+04     6s
   2  -5.00012956e+06  1.55376109e+08  3.30e+04 2.75e+01  2.23e+04     6s
   3  -1.25240095e+06  1.08890749e+08  4.37e+03 6.25e-01  3.35e+03     6s
   4  -6.56986192e+05  6.15335846e+07  6.21e+02 1.27e-01  6.76e+02     6s
   5  -5.58614304e+05  3.65425211e+07  3.16e+02 6.28e-02  3.52e+02     6s
   6  -3.59673709e+05  2.65267057e+07  8.71e+01 4.31e-02  1.78e+02     6s
   7  -3.07168787e+05  1.83504604e+07  6.08e+01 2.84e-02  1.19e+02     7s
   8  -1.61717342e+05  1.20128123e+07  1.74e+01 1.60e-02  6.70e+01     7s
   9  -8.28253424e+04  6.52085770e+06  5.40e+00 8.03e-03  3.45e+01     7s
  10  -4.81334667e+04  4.11598542e+06  1.68e+00 4.98e-03  2.13e+01     7s
  11  -1.78303599e+04  1.63197018e+06  7.88e-01 1.86e-03  8.39e+00     7s
  12   3.03922090e+03  6.42421906e+05  4.42e-01 6.48e-04  3.25e+00     7s
  13   1.40029862e+04  4.05597725e+05  2.96e-01 3.20e-04  1.99e+00     7s
  14   2.55038748e+04  2.69160475e+05  2.18e-01 5.52e-04  1.24e+00     7s
  15   3.07574449e+04  2.27077135e+05  1.90e-01 8.58e-04  9.95e-01     7s
  16   4.25364572e+04  1.83928086e+05  1.35e-01 1.14e-03  7.17e-01     7s
  17   5.08684698e+04  1.45970674e+05  1.01e-01 1.47e-03  4.82e-01     8s
  18   5.78241107e+04  1.33806887e+05  7.89e-02 1.57e-03  3.85e-01     8s
  19   6.46698873e+04  1.21387991e+05  5.83e-02 1.21e-03  2.87e-01     8s
  20   6.87858913e+04  1.11592422e+05  4.67e-02 1.40e-03  2.17e-01     8s
  21   7.03785850e+04  1.03561422e+05  4.22e-02 9.66e-04  1.68e-01     8s
  22   7.23065534e+04  9.97393381e+04  3.71e-02 7.39e-04  1.39e-01     8s
  23   7.60879434e+04  9.80058190e+04  2.75e-02 7.14e-04  1.11e-01     8s
  24   7.76165373e+04  9.65505906e+04  2.34e-02 6.26e-04  9.59e-02     8s
  25   7.86821483e+04  9.31881310e+04  2.06e-02 4.09e-04  7.35e-02     8s
  26   8.01883098e+04  9.21925351e+04  1.67e-02 3.40e-04  6.08e-02     9s
  27   8.09989249e+04  9.15640588e+04  1.47e-02 2.88e-04  5.35e-02     9s
  28   8.21269190e+04  8.99688663e+04  1.18e-02 3.49e-04  3.97e-02     9s
  29   8.26713511e+04  8.95979336e+04  1.06e-02 2.95e-04  3.51e-02     9s
  30   8.39626749e+04  8.92605626e+04  7.44e-03 2.62e-04  2.68e-02     9s
  31   8.42884491e+04  8.85327853e+04  6.62e-03 1.65e-04  2.15e-02     9s
  32   8.44827427e+04  8.82727738e+04  6.13e-03 1.21e-04  1.92e-02     9s
  33   8.48576277e+04  8.81033633e+04  5.25e-03 1.06e-04  1.65e-02     9s
  34   8.49824737e+04  8.80507785e+04  4.96e-03 1.00e-04  1.56e-02    10s
  35   8.55535920e+04  8.78633851e+04  3.61e-03 8.22e-05  1.17e-02    10s
  36   8.57685259e+04  8.76577140e+04  3.14e-03 6.51e-05  9.58e-03    10s
  37   8.63298199e+04  8.75731861e+04  1.91e-03 5.37e-05  6.30e-03    10s
  38   8.66160970e+04  8.74786177e+04  1.26e-03 3.95e-05  4.37e-03    10s
  39   8.67110670e+04  8.74535736e+04  1.06e-03 3.58e-05  3.76e-03    10s
  40   8.68025174e+04  8.73951670e+04  8.51e-04 2.61e-05  3.00e-03    10s
  41   8.69093556e+04  8.73230094e+04  6.15e-04 1.42e-05  2.10e-03    11s
  42   8.69273722e+04  8.73147106e+04  5.76e-04 1.32e-05  1.96e-03    11s
  43   8.69835269e+04  8.72974599e+04  4.49e-04 1.11e-05  1.59e-03    11s
  44   8.70740889e+04  8.72520860e+04  2.62e-04 5.80e-06  9.02e-04    11s
  45   8.71251673e+04  8.72273260e+04  1.51e-04 2.78e-06  5.18e-04    11s
  46   8.71501026e+04  8.72174546e+04  9.89e-05 1.49e-06  3.41e-04    11s
  47   8.71634993e+04  8.72134326e+04  7.24e-05 1.04e-06  2.53e-04    11s
  48   8.71756190e+04  8.72107983e+04  4.92e-05 7.62e-07  1.78e-04    11s
  49   8.71901542e+04  8.72064166e+04  2.21e-05 3.19e-07  8.24e-05    12s
  50   8.72005444e+04  8.72054413e+04  3.59e-06 2.28e-07  2.48e-05    12s
  51   8.72026745e+04  8.72030734e+04  4.10e-07 2.09e-08  2.02e-06    12s
  52   8.72029818e+04  8.72029822e+04  2.89e-10 6.03e-09  2.20e-09    12s

Barrier solved model in 52 iterations and 11.90 seconds (10.22 work units)
Optimal objective 8.72029818e+04


Root crossover log...

   95133 DPushes remaining with DInf 0.0000000e+00                12s
     616 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

   13515 PPushes remaining with PInf 4.2895512e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2811883e+04     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56627    8.7202982e+04   0.000000e+00   1.281188e+04     17s
   57674    8.7202982e+04   0.000000e+00   0.000000e+00     18s
   57674    8.7202982e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.720298e+04, 57674 iterations, 13.22 seconds (15.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87202.9821    0  198 -227427.98 87202.9821   138%     -   18s
H    0     0                    -224397.9372 87202.9821   139%     -   18s
H    0     0                    -202854.4415 87202.9821   143%     -   19s
H    0     0                    -188462.4543 87202.9821   146%     -   19s
H    0     0                    -188250.5598 87202.9821   146%     -   19s
H    0     0                    -59429.58330 87202.9821   247%     -   19s
H    0     0                    -59265.48893 87202.9821   247%     -   19s
H    0     0                    -19922.60671 87202.9821   538%     -   20s
H    0     0                    8706.0495039 87202.9821   902%     -   20s
H    0     0                    10064.793667 87202.9821   766%     -   20s
H    0     0                    15329.129304 87202.9821   469%     -   21s
H    0     0                    15346.180802 87202.9821   468%     -   21s
H    0     0                    15374.647928 87202.9821   467%     -   21s
H    0     0                    15476.956445 87202.9821   463%     -   21s
H    0     0                    15484.547762 87202.9821   463%     -   21s
H    0     0                    32358.183520 87202.9821   169%     -   23s
H    0     0                    32649.150298 87202.9821   167%     -   23s
H    0     0                    36812.424324 80112.3468   118%     -  132s
H    0     0                    38052.336704 80112.3468   111%     -  132s
     0     0 80107.8067    0  310 38052.3367 80107.8067   111%     -  133s
     0     0 79161.5414    0  317 38052.3367 79161.5414   108%     -  182s
     0     0 79022.6460    0  297 38052.3367 79022.6460   108%     -  202s
     0     0 78841.9859    0  313 38052.3367 78841.9859   107%     -  233s
     0     0 78775.2064    0  318 38052.3367 78775.2064   107%     -  249s
     0     0 78775.2064    0  317 38052.3367 78775.2064   107%     -  277s
     0     0 78775.2064    0  326 38052.3367 78775.2064   107%     -  287s
     0     0 78775.2064    0  334 38052.3367 78775.2064   107%     -  294s
     0     0 78775.2064    0  333 38052.3367 78775.2064   107%     -  296s
     0     0 78775.2064    0  333 38052.3367 78775.2064   107%     -  297s
H    0     0                    42397.327031 74795.8470  76.4%     -  399s
H    0     0                    42930.748162 74795.8470  74.2%     -  399s
H    0     0                    42940.639309 74795.8470  74.2%     -  399s
     0     0 74795.8470    0  313 42940.6393 74795.8470  74.2%     -  399s
H    0     0                    43784.735364 74795.4339  70.8%     -  400s
H    0     0                    45204.736796 74795.4339  65.5%     -  400s
H    0     0                    45827.323400 74795.4339  63.2%     -  400s
H    0     0                    46202.430935 74795.4339  61.9%     -  400s
H    0     0                    46798.155445 74795.4339  59.8%     -  400s
H    0     0                    47271.358663 74795.4339  58.2%     -  400s
H    0     0                    47374.015194 74795.4339  57.9%     -  400s
H    0     0                    48033.832235 74795.4339  55.7%     -  400s
     0     0 74146.4651    0  312 48033.8322 74146.4651  54.4%     -  481s
     0     0 73937.3310    0  345 48033.8322 73937.3310  53.9%     -  526s
     0     0 73747.8870    0  305 48033.8322 73747.8870  53.5%     -  557s
     0     0 73713.2082    0  315 48033.8322 73713.2082  53.5%     -  572s
     0     0 73686.4866    0  312 48033.8322 73686.4866  53.4%     -  583s
     0     0 73667.3358    0  315 48033.8322 73667.3358  53.4%     -  591s
     0     0 73637.7964    0  319 48033.8322 73637.7964  53.3%     -  602s
     0     0 73588.7138    0  312 48033.8322 73588.7138  53.2%     -  617s
     0     0 73567.8731    0  314 48033.8322 73567.8731  53.2%     -  629s
     0     0 73560.3979    0  314 48033.8322 73560.3979  53.1%     -  636s
     0     0 73540.8838    0  312 48033.8322 73540.8838  53.1%     -  647s
     0     0 73536.4772    0  314 48033.8322 73536.4772  53.1%     -  653s
     0     0 73535.0291    0  320 48033.8322 73535.0291  53.1%     -  655s
H    0     0                    48366.550795 71930.3312  48.7%     -  819s
H    0     0                    48837.063974 71930.3312  47.3%     -  819s
H    0     0                    49097.313668 71930.3312  46.5%     -  819s
H    0     0                    49239.809311 71930.3312  46.1%     -  819s
     0     0 71930.3312    0  320 49239.8093 71930.3312  46.1%     -  819s
H    0     0                    49269.000959 71522.1590  45.2%     -  876s
H    0     0                    49270.112348 71522.1590  45.2%     -  876s
H    0     0                    49281.609012 71522.1590  45.1%     -  876s
     0     0 71522.1590    0  393 49281.6090 71522.1590  45.1%     -  876s
     0     0 71396.2477    0  408 49281.6090 71396.2477  44.9%     -  914s
     0     0 71359.2551    0  410 49281.6090 71359.2551  44.8%     -  928s
     0     0 71337.3208    0  421 49281.6090 71337.3208  44.8%     -  940s
     0     0 71317.8781    0  421 49281.6090 71317.8781  44.7%     -  947s
     0     0 71307.0990    0  426 49281.6090 71307.0990  44.7%     -  954s
     0     0 71282.1868    0  438 49281.6090 71282.1868  44.6%     -  964s
     0     0 71275.2440    0  436 49281.6090 71275.2440  44.6%     -  967s
     0     0 71271.7765    0  433 49281.6090 71271.7765  44.6%     -  971s
     0     0 71268.4317    0  432 49281.6090 71268.4317  44.6%     -  973s
     0     0 71264.1923    0  433 49281.6090 71264.1923  44.6%     -  975s
     0     0 71263.7036    0  427 49281.6090 71263.7036  44.6%     -  977s
     0     0 70567.5304    0  414 49281.6090 70567.5304  43.2%     - 1043s
     0     0 70388.6843    0  423 49281.6090 70388.6843  42.8%     - 1081s
     0     0 70346.8416    0  420 49281.6090 70346.8416  42.7%     - 1098s
     0     0 70328.6998    0  457 49281.6090 70328.6998  42.7%     - 1110s
     0     0 70306.9163    0  458 49281.6090 70306.9163  42.7%     - 1119s
     0     0 70289.2156    0  430 49281.6090 70289.2156  42.6%     - 1128s
     0     0 70280.7727    0  431 49281.6090 70280.7727  42.6%     - 1132s
     0     0 70252.5012    0  424 49281.6090 70252.5012  42.6%     - 1140s
     0     0 70244.3317    0  430 49281.6090 70244.3317  42.5%     - 1145s
     0     0 70239.9970    0  468 49281.6090 70239.9970  42.5%     - 1152s
     0     0 70235.7221    0  462 49281.6090 70235.7221  42.5%     - 1157s
     0     0 70231.3889    0  470 49281.6090 70231.3889  42.5%     - 1160s
     0     0 70230.5419    0  470 49281.6090 70230.5419  42.5%     - 1162s
H    0     0                    49958.232472 70000.9544  40.1%     - 1209s
H    0     0                    50157.453916 70000.9544  39.6%     - 1209s
H    0     0                    50219.579053 70000.9544  39.4%     - 1209s
H    0     0                    50273.773657 70000.9544  39.2%     - 1209s
H    0     0                    50497.758569 70000.9544  38.6%     - 1209s
     0     0 70000.9544    0  427 50497.7586 70000.9544  38.6%     - 1209s
     0     0 69947.4751    0  421 50497.7586 69947.4751  38.5%     - 1229s
     0     0 69927.5752    0  471 50497.7586 69927.5752  38.5%     - 1241s
     0     0 69915.9212    0  469 50497.7586 69915.9212  38.5%     - 1251s
     0     0 69911.6589    0  471 50497.7586 69911.6589  38.4%     - 1257s
     0     0 69907.6866    0  473 50497.7586 69907.6866  38.4%     - 1260s
     0     0 69905.9459    0  472 50497.7586 69905.9459  38.4%     - 1263s
     0     0 69823.6428    0  459 50497.7586 69823.6428  38.3%     - 1284s
H    0     0                    50679.562114 69823.4895  37.8%     - 1293s
H    0     0                    50700.562033 69823.4895  37.7%     - 1293s
H    0     0                    50949.686891 69823.4895  37.0%     - 1293s
     0     0 69793.6194    0  433 50949.6869 69793.6194  37.0%     - 1304s
     0     0 69779.0459    0  446 50949.6869 69779.0459  37.0%     - 1312s
     0     0 69775.6539    0  451 50949.6869 69775.6539  37.0%     - 1315s
     0     0 69756.9483    0  473 50949.6869 69756.9483  36.9%     - 1326s
     0     0 69754.2025    0  438 50949.6869 69754.2025  36.9%     - 1333s
     0     0 69752.7024    0  437 50949.6869 69752.7024  36.9%     - 1334s
     0     0 69694.5959    0  431 50949.6869 69694.5959  36.8%     - 1355s
     0     0 69674.3740    0  416 50949.6869 69674.3740  36.8%     - 1368s
     0     0 69667.5942    0  424 50949.6869 69667.5942  36.7%     - 1377s
     0     0 69638.4624    0  432 50949.6869 69638.4624  36.7%     - 1390s
     0     0 69632.4820    0  426 50949.6869 69632.4820  36.7%     - 1395s
     0     0 69628.8316    0  466 50949.6869 69628.8316  36.7%     - 1402s
     0     0 69624.4681    0  471 50949.6869 69624.4681  36.7%     - 1407s
     0     0 69623.4488    0  434 50949.6869 69623.4488  36.7%     - 1410s
     0     0 69603.4701    0  434 50949.6869 69603.4701  36.6%     - 1419s
H    0     0                    51289.081972 69600.6371  35.7%     - 1424s
H    0     0                    51670.618248 69600.6371  34.7%     - 1424s
     0     0 69595.7736    0  434 51670.6182 69595.7736  34.7%     - 1428s
     0     0 69590.6206    0  431 51670.6182 69590.6206  34.7%     - 1432s
     0     0 69586.5243    0  434 51670.6182 69586.5243  34.7%     - 1435s
     0     0 69582.5422    0  436 51670.6182 69582.5422  34.7%     - 1438s
     0     0 69579.9652    0  438 51670.6182 69579.9652  34.7%     - 1440s
     0     0 69543.1081    0  496 51670.6182 69543.1081  34.6%     - 1460s
     0     0 69528.7186    0  504 51670.6182 69528.7186  34.6%     - 1474s
     0     0 69525.9294    0  495 51670.6182 69525.9294  34.6%     - 1478s
     0     0 69524.7609    0  492 51670.6182 69524.7609  34.6%     - 1480s
     0     0 69513.4873    0  482 51670.6182 69513.4873  34.5%     - 1491s
H    0     0                    51716.804088 69513.3291  34.4%     - 1506s
     0     0 69506.9949    0  478 51716.8041 69506.9949  34.4%     - 1512s
     0     0 69505.1231    0  472 51716.8041 69505.1231  34.4%     - 1515s
     0     0 69485.4225    0  433 51716.8041 69485.4225  34.4%     - 1524s
     0     0 69482.1208    0  469 51716.8041 69482.1208  34.4%     - 1530s
     0     0 69480.8067    0  433 51716.8041 69480.8067  34.3%     - 1532s
     0     0 69473.9916    0  435 51716.8041 69473.9916  34.3%     - 1536s
H    0     0                    51919.597350 69473.9605  33.8%     - 1545s
H    0     0                    51928.810155 69473.9605  33.8%     - 1545s
     0     0 69471.2507    0  428 51928.8102 69471.2507  33.8%     - 1547s
     0     0 69468.9321    0  470 51928.8102 69468.9321  33.8%     - 1551s
     0     0 69468.8199    0  470 51928.8102 69468.8199  33.8%     - 1556s
     0     2 69468.8199    0  470 51928.8102 69468.8199  33.8%     - 1854s
     1     3 69262.0336    1  379 51928.8102 69467.9465  33.8% 11327 1878s
     2     4 69337.9999    1  413 51928.8102 69337.9999  33.5%  8366 1890s
     3     6 69156.7309    2  465 51928.8102 69337.8921  33.5%  8136 1908s
     5    10 69075.8565    3  444 51928.8102 69337.8921  33.5%  8259 1937s
     9    19 69021.0597    4  398 51928.8102 69156.6671  33.2%  8115 1971s
    18    36 68846.9816    5  404 51928.8102 69075.8476  33.0%  9829 2021s
    35    49 67877.9843    6  352 51928.8102 69021.0281  32.9% 15147 2134s
    48    77 67582.1756    6  325 51928.8102 69021.0281  32.9% 16128 2217s
H   61    77                    51945.592338 68967.4031  32.8% 15185 2217s
    76   174 67560.0772    7  316 51945.5923 68967.4031  32.8% 14134 2302s
   173   230 66936.6751   12  304 51945.5923 68967.4031  32.8% 10597 2363s
   229   279 66677.6649   14  357 51945.5923 68967.4031  32.8%  9560 2412s
   278   326 67071.8175   12  318 51945.5923 68967.4031  32.8%  9030 2507s
   325   376 66531.3080   15  347 51945.5923 68967.4031  32.8%  8594 2550s
   375   423 66270.9845   16  369 51945.5923 68967.4031  32.8%  8494 2683s
   422   481 66085.3073   18  345 51945.5923 68967.4031  32.8%  8171 2736s
   480   541 65687.7651   21  335 51945.5923 68967.4031  32.8%  7837 2791s
   540   598 65450.4746   23  320 51945.5923 68967.4031  32.8%  7566 2840s
   599   623 63194.3531   24  292 51945.5923 68967.4031  32.8%  7349 2878s
   628   664 62735.6030   25  286 51945.5923 68967.4031  32.8%  7271 2917s
   673   694 62692.3845   27  294 51945.5923 68967.4031  32.8%  7152 2963s
   703   730 62658.2611   28  283 51945.5923 68967.4031  32.8%  7184 3004s
   745   755 62646.7381   29  279 51945.5923 68967.4031  32.8%  6975 3045s
   772   781 62575.6855   30  276 51945.5923 68967.4031  32.8%  6867 3080s
   805   823 62574.3247   31  271 51945.5923 68967.4031  32.8%  6767 3114s
   851   861 62568.4246   32  263 51945.5923 68967.4031  32.8%  6587 3152s
H  888   861                    51972.291269 68967.4031  32.7%  6432 3152s
   901   979 62366.7520   33  269 51972.2913 68967.4031  32.7%  6374 3196s
  1025  1151 62025.7774   35  253 51972.2913 68967.4031  32.7%  5889 3240s
  1199  1301 61758.5382   39  210 51972.2913 68967.4031  32.7%  5295 3280s
  1369  1457 61563.9922   41  243 51972.2913 68967.4031  32.7%  4888 3320s
  1575  1609 60953.8455   44  236 51972.2913 68967.4031  32.7%  4452 3367s
  1755  1761 59612.3654   48  284 51972.2913 68967.4031  32.7%  4202 3413s
  1930  1789 59452.9395   50  289 51972.2913 68967.4031  32.7%  4017 3455s
H 1933  1789                    51976.590158 68967.4031  32.7%  4016 3455s
  1960  1981 59399.3678   51  292 51976.5902 68967.4031  32.7%  4014 3500s
  2177  2118 58384.9486   56  214 51976.5902 68846.9033  32.5%  3798 3545s
  2371  2343 57083.8678   60  282 51976.5902 68776.1040  32.3%  3659 3593s
  2616  2402 55509.4185  108  150 51976.5902 68776.1040  32.3%  3470 3600s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 103
  MIR: 2362
  Flow cover: 2656
  RLT: 80
  Relax-and-lift: 619

Explored 2679 nodes (9825336 simplex iterations) in 3600.06 seconds (4820.91 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 51976.6 51945.6 51928.8 ... 50679.6

Time limit reached
Best objective 5.197659015783e+04, best bound 6.877610399301e+04, gap 32.3213%
  WARNING: Time limit reached. Using best solution found (gap: 32.32%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 51976.59, θ = 202498.84
  Upper Bound (UB) = 51976.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202498.84
  [DEBUG]   ✓ Scenario 0: θ = 202498.84 ≤ Q = 202498.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 202498.84 ≤ Q = 202897.67 (slack: 398.83)
  [DEBUG]   ✓ Scenario 5: θ = 202498.84 ≤ Q = 202498.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 202498.84 ≤ Q = 202498.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 202498.84 ≤ Q = 202498.84 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7658d266
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x89a72d9a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.510029e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7306555.7193
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.692417e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169241.71    0  124 7306555.72 -169241.71   102%     -    0s
H    0     0                    -134280.6628 -169241.71  26.0%     -    0s
H    0     0                    -134543.9154 -169241.71  25.8%     -    0s
H    0     0                    -134843.1421 -146562.51  8.69%     -    0s
H    0     0                    -135986.2534 -146562.51  7.78%     -    0s
     0     0 -146562.51    0  132 -135986.25 -146562.51  7.78%     -    0s
H    0     0                    -141514.7317 -146427.31  3.47%     -    0s
H    0     0                    -142434.7143 -146427.31  2.80%     -    0s
     0     0 -144518.00    0  134 -142434.71 -144518.00  1.46%     -    0s
H    0     0                    -142650.6948 -144511.22  1.30%     -    0s
     0     0 -144466.25    0  133 -142650.69 -144466.25  1.27%     -    0s
H    0     0                    -142880.9986 -143905.99  0.72%     -    0s
     0     0 -143905.99    0  112 -142881.00 -143905.99  0.72%     -    0s
H    0     0                    -142929.4727 -143904.65  0.68%     -    0s
H    0     0                    -142940.2978 -143687.41  0.52%     -    0s
H    0     0                    -142978.7966 -143687.41  0.50%     -    0s
     0     0 -143687.41    0  141 -142978.80 -143687.41  0.50%     -    0s
     0     0 -143672.00    0  141 -142978.80 -143672.00  0.48%     -    0s
     0     0 -143500.20    0  133 -142978.80 -143500.20  0.36%     -    0s
     0     0 -143464.34    0   84 -142978.80 -143464.34  0.34%     -    0s
     0     0 -143431.55    0   72 -142978.80 -143431.55  0.32%     -    0s
     0     0 -143409.58    0   71 -142978.80 -143409.58  0.30%     -    0s
     0     0 -143380.39    0   78 -142978.80 -143380.39  0.28%     -    0s
     0     0 -143378.42    0   78 -142978.80 -143378.42  0.28%     -    0s
     0     2 -143377.91    0   78 -142978.80 -143377.91  0.28%     -    0s
H   50    18                    -142991.0785 -143327.66  0.24%  15.3    0s
H  603   158                    -143006.2632 -143237.04  0.16%   6.5    0s

Cutting planes:
  Gomory: 52
  Implied bound: 6
  MIR: 237
  Flow cover: 20
  RLT: 19
  Relax-and-lift: 1
  BQP: 3

Explored 1362 nodes (9753 simplex iterations) in 0.30 seconds (0.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -143006 -142991 -142979 ... -134544
No other solutions better than -143006

Optimal solution found (tolerance 1.00e-06)
Best objective -1.430062632428e+05, best bound -1.430062632428e+05, gap 0.0000%
  Subproblem solved in 0.33s
  Worst-case operational profit (Z_SP) = 198052.05
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143006.26
  [DEBUG]   S×d_nominal = 341058.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341058.31 + -143006.26 = 198052.05
  [DEBUG]   Current θ from Master = 202498.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4446.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 47529.80
  Lower Bound (LB) = 47833.94
  Gap (UB-LB) = 4142.6513, Absolute Gap = 4142.6513, Relative Gap = 0.079702
  Not converged yet (gap = 4142.65 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x487a6b94
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 99320 rows and 40350 columns
Presolve time: 4.08s
Presolved: 116123 rows, 49270 columns, 700439 nonzeros
Variable types: 47011 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310684.9051
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.39s

Barrier statistics:
 Dense cols : 623
 AA' NZ     : 4.472e+06
 Factor NZ  : 1.079e+07 (roughly 150 MB of memory)
 Factor Ops : 2.222e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.01460657e+07  2.28491611e+08  1.46e+05 1.56e+01  9.41e+04     6s
   1  -1.55368689e+07  2.12357122e+08  1.02e+05 9.63e+01  6.53e+04     6s
   2  -5.33696155e+06  1.68464164e+08  3.50e+04 3.31e+01  2.35e+04     7s
   3  -1.39900326e+06  1.18601795e+08  5.21e+03 9.84e-01  3.89e+03     7s
   4  -6.75490394e+05  6.87878828e+07  6.13e+02 1.31e-01  6.86e+02     7s
   5  -5.83015632e+05  4.23638286e+07  3.09e+02 6.97e-02  3.65e+02     7s
   6  -3.89325494e+05  2.99327644e+07  7.92e+01 4.67e-02  1.81e+02     7s
   7  -3.04915167e+05  2.05818826e+07  4.42e+01 3.03e-02  1.16e+02     7s
   8  -1.71148042e+05  1.35592015e+07  1.39e+01 1.93e-02  6.89e+01     7s
   9  -9.09635220e+04  6.23294558e+06  4.55e+00 8.64e-03  3.05e+01     7s
  10  -4.80065224e+04  2.45865966e+06  1.85e+00 3.32e-03  1.19e+01     7s
  11  -8.43746849e+03  1.06321851e+06  7.65e-01 1.25e-03  5.07e+00     7s
  12   4.82836399e+03  5.74576970e+05  5.55e-01 7.35e-04  2.69e+00     7s
  13   1.83660645e+04  3.44734341e+05  3.52e-01 5.12e-04  1.54e+00     8s
  14   2.59316982e+04  2.42099271e+05  2.85e-01 7.39e-04  1.02e+00     8s
  15   3.31194860e+04  2.23175154e+05  2.26e-01 5.33e-04  8.97e-01     8s
  16   4.18531286e+04  1.72882134e+05  1.69e-01 9.22e-04  6.18e-01     8s
  17   4.98738357e+04  1.55218281e+05  1.34e-01 1.63e-03  4.97e-01     8s
  18   5.65304844e+04  1.43088678e+05  1.06e-01 1.48e-03  4.08e-01     8s
  19   6.23649245e+04  1.21484824e+05  8.44e-02 1.92e-03  2.79e-01     8s
  20   6.76892655e+04  1.12719961e+05  6.47e-02 2.37e-03  2.12e-01     8s
  21   6.98133194e+04  1.04937311e+05  5.68e-02 1.90e-03  1.66e-01     8s
  22   7.22508423e+04  1.00056786e+05  4.84e-02 1.71e-03  1.31e-01     8s
  23   7.61604935e+04  9.82225873e+04  3.54e-02 1.49e-03  1.04e-01     9s
  24   7.73575804e+04  9.54400336e+04  3.15e-02 1.12e-03  8.53e-02     9s
  25   7.89797204e+04  9.30983447e+04  2.59e-02 8.03e-04  6.66e-02     9s
  26   7.99415420e+04  9.19460488e+04  2.27e-02 6.48e-04  5.66e-02     9s
  27   8.15895465e+04  9.11881837e+04  1.76e-02 5.35e-04  4.53e-02     9s
  28   8.26089043e+04  9.02526384e+04  1.41e-02 5.29e-04  3.61e-02     9s
  29   8.36688089e+04  8.96410879e+04  1.08e-02 4.16e-04  2.82e-02     9s
  30   8.39822091e+04  8.95138541e+04  9.85e-03 3.92e-04  2.61e-02     9s
  31   8.44654261e+04  8.88181227e+04  8.38e-03 2.67e-04  2.05e-02    10s
  32   8.49128560e+04  8.84471449e+04  6.94e-03 2.00e-04  1.67e-02    10s
  33   8.55524144e+04  8.82786621e+04  5.06e-03 1.68e-04  1.29e-02    10s
  34   8.57217872e+04  8.79662268e+04  4.55e-03 1.13e-04  1.06e-02    10s
  35   8.60500489e+04  8.78145787e+04  3.61e-03 8.33e-05  8.33e-03    10s
  36   8.63272420e+04  8.76776710e+04  2.81e-03 5.56e-05  6.37e-03    10s
  37   8.65959410e+04  8.76033270e+04  2.07e-03 4.25e-05  4.75e-03    11s
  38   8.67869414e+04  8.75231889e+04  1.52e-03 4.28e-05  3.47e-03    11s
  39   8.68713951e+04  8.75074461e+04  1.29e-03 3.91e-05  3.00e-03    11s
  40   8.69379200e+04  8.74946948e+04  1.11e-03 3.50e-05  2.63e-03    11s
  41   8.70041865e+04  8.74454532e+04  9.19e-04 2.61e-05  2.08e-03    11s
  42   8.70601240e+04  8.74223225e+04  7.65e-04 1.98e-05  1.71e-03    11s
  43   8.71249881e+04  8.73872178e+04  5.88e-04 9.32e-06  1.24e-03    12s
  44   8.72050218e+04  8.73658006e+04  3.70e-04 6.08e-06  7.59e-04    12s
  45   8.72479550e+04  8.73571501e+04  2.55e-04 2.70e-06  5.15e-04    12s
  46   8.72843027e+04  8.73539119e+04  1.57e-04 1.83e-06  3.29e-04    12s
  47   8.72927581e+04  8.73531383e+04  1.35e-04 1.64e-06  2.85e-04    12s
  48   8.72988583e+04  8.73501763e+04  1.20e-04 7.92e-07  2.42e-04    12s
  49   8.73010845e+04  8.73492260e+04  1.14e-04 5.87e-07  2.27e-04    13s
  50   8.73219083e+04  8.73484779e+04  6.20e-05 3.80e-07  1.25e-04    13s
  51   8.73325216e+04  8.73478960e+04  3.56e-05 3.55e-07  7.26e-05    13s
  52   8.73415864e+04  8.73473892e+04  1.22e-05 2.48e-07  2.74e-05    13s
  53   8.73444730e+04  8.73468917e+04  5.34e-06 5.48e-08  1.14e-05    13s
  54   8.73464934e+04  8.73468070e+04  4.63e-07 7.36e-07  1.48e-06    13s
  55   8.73467390e+04  8.73467511e+04  2.00e-08 2.67e-08  5.74e-08    14s
  56   8.73467489e+04  8.73467492e+04  1.79e-08 4.68e-08  1.13e-09    14s

Barrier solved model in 56 iterations and 13.70 seconds (11.57 work units)
Optimal objective 8.73467489e+04


Root crossover log...

  102270 DPushes remaining with DInf 0.0000000e+00                14s
   33734 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

   11436 PPushes remaining with PInf 7.3164012e-05                19s
     588 PPushes remaining with PInf 5.2237177e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.6839837e+03     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57499    8.7346749e+04   0.000000e+00   2.683984e+03     21s
   57957    8.7346749e+04   0.000000e+00   0.000000e+00     21s
   57957    8.7346749e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 0.10s

Solved with barrier

Root relaxation: objective 8.734675e+04, 57957 iterations, 16.10 seconds (20.97 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 87346.7492    0  186 -227427.98 87346.7492   138%     -   22s
H    0     0                    -144569.0352 87346.7492   160%     -   22s
H    0     0                    -144076.6637 87346.7492   161%     -   22s
H    0     0                    -141304.9064 87346.7492   162%     -   22s
H    0     0                    -141229.1901 87346.7492   162%     -   23s
H    0     0                    -141209.5445 87346.7492   162%     -   23s
H    0     0                    -55279.11143 87346.7492   258%     -   23s
H    0     0                    4487.2811685 87346.7492  1847%     -   23s
H    0     0                    16084.756695 87346.7492   443%     -   24s
H    0     0                    16481.960457 87346.7492   430%     -   24s
H    0     0                    18762.790989 87346.7492   366%     -   26s
H    0     0                    34165.454711 87346.7492   156%     -   26s
H    0     0                    35273.311105 87346.7492   148%     -   26s
H    0     0                    35336.579692 87346.7492   147%     -   26s
H    0     0                    35548.057683 87346.7492   146%     -   26s
     0     0 81133.5760    0  270 35548.0577 81133.5760   128%     -  140s
H    0     0                    35587.288677 81133.5760   128%     -  141s
     0     0 80261.6698    0  335 35587.2887 80261.6698   126%     -  207s
     0     0 79928.4568    0  322 35587.2887 79928.4568   125%     -  257s
     0     0 79848.6481    0  324 35587.2887 79848.6481   124%     -  285s
     0     0 79776.7873    0  322 35587.2887 79776.7873   124%     -  313s
     0     0 79715.1914    0  320 35587.2887 79715.1914   124%     -  339s
     0     0 79631.3891    0  345 35587.2887 79631.3891   124%     -  356s
     0     0 79613.5219    0  348 35587.2887 79613.5219   124%     -  366s
     0     0 79600.9247    0  318 35587.2887 79600.9247   124%     -  375s
     0     0 79598.0912    0  344 35587.2887 79598.0912   124%     -  377s
     0     0 79597.7711    0  344 35587.2887 79597.7711   124%     -  378s
     0     0 75597.2133    0  336 35587.2887 75597.2133   112%     -  488s
H    0     0                    37067.139341 75597.1777   104%     -  489s
H    0     0                    37079.076419 75597.1777   104%     -  489s
H    0     0                    37110.614857 75597.1777   104%     -  489s
H    0     0                    38727.456750 75597.1777  95.2%     -  489s
H    0     0                    38786.920102 75597.1777  94.9%     -  489s
H    0     0                    39158.916704 75597.1777  93.1%     -  489s
H    0     0                    39481.642083 75597.1777  91.5%     -  489s
H    0     0                    39728.310284 75597.1777  90.3%     -  489s
H    0     0                    44987.857177 75597.1777  68.0%     -  489s
     0     0 74976.0615    0  364 44987.8572 74976.0615  66.7%     -  562s
     0     0 74838.2232    0  362 44987.8572 74838.2232  66.4%     -  593s
     0     0 74802.1471    0  349 44987.8572 74802.1471  66.3%     -  612s
     0     0 74710.5798    0  342 44987.8572 74710.5798  66.1%     -  635s
     0     0 74614.0235    0  353 44987.8572 74614.0235  65.9%     -  661s
     0     0 74604.9499    0  347 44987.8572 74604.9499  65.8%     -  671s
     0     0 74593.3933    0  348 44987.8572 74593.3933  65.8%     -  679s
     0     0 74589.5870    0  356 44987.8572 74589.5870  65.8%     -  682s
     0     0 74587.1187    0  351 44987.8572 74587.1187  65.8%     -  685s
     0     0 74546.8589    0  349 44987.8572 74546.8589  65.7%     -  702s
     0     0 74538.0484    0  348 44987.8572 74538.0484  65.7%     -  711s
     0     0 74532.9874    0  358 44987.8572 74532.9874  65.7%     -  715s
     0     0 74520.1663    0  349 44987.8572 74520.1663  65.6%     -  723s
     0     0 74516.6905    0  352 44987.8572 74516.6905  65.6%     -  727s
     0     0 74515.1061    0  361 44987.8572 74515.1061  65.6%     -  730s
     0     0 71937.8739    0  347 44987.8572 71937.8739  59.9%     -  856s
     0     0 71567.9434    0  397 44987.8572 71567.9434  59.1%     -  907s
     0     0 71377.9867    0  355 44987.8572 71377.9867  58.7%     -  938s
     0     0 71290.5172    0  390 44987.8572 71290.5172  58.5%     -  955s
     0     0 71220.1287    0  365 44987.8572 71220.1287  58.3%     -  975s
     0     0 71190.7790    0  357 44987.8572 71190.7790  58.2%     -  986s
H    0     0                    45020.621797 71164.6154  58.1%     -  997s
H    0     0                    46495.018660 71164.6154  53.1%     -  997s
     0     0 71164.6154    0  362 46495.0187 71164.6154  53.1%     -  997s
H    0     0                    47611.021714 71150.2464  49.4%     - 1008s
     0     0 71150.2464    0  352 47611.0217 71150.2464  49.4%     - 1008s
     0     0 71132.3881    0  352 47611.0217 71132.3881  49.4%     - 1020s
H    0     0                    48681.287710 71121.0229  46.1%     - 1029s
H    0     0                    48714.888557 71121.0229  46.0%     - 1029s
H    0     0                    48718.615051 71121.0229  46.0%     - 1029s
H    0     0                    48841.289300 71121.0229  45.6%     - 1029s
H    0     0                    48961.676356 71121.0229  45.3%     - 1029s
     0     0 71121.0229    0  353 48961.6764 71121.0229  45.3%     - 1029s
     0     0 71119.8037    0  370 48961.6764 71119.8037  45.3%     - 1031s
     0     0 70519.9038    0  365 48961.6764 70519.9038  44.0%     - 1107s
H    0     0                    49061.248872 70519.7795  43.7%     - 1109s
H    0     0                    49202.158377 70519.7795  43.3%     - 1109s
     0     0 70352.7350    0  413 49202.1584 70352.7350  43.0%     - 1144s
     0     0 70209.2587    0  414 49202.1584 70209.2587  42.7%     - 1182s
     0     0 70180.4137    0  375 49202.1584 70180.4137  42.6%     - 1199s
     0     0 70169.3893    0  375 49202.1584 70169.3893  42.6%     - 1207s
     0     0 70164.5759    0  369 49202.1584 70164.5759  42.6%     - 1212s
     0     0 70143.3689    0  374 49202.1584 70143.3689  42.6%     - 1222s
     0     0 70119.7663    0  410 49202.1584 70119.7663  42.5%     - 1234s
     0     0 70008.0556    0  419 49202.1584 70008.0556  42.3%     - 1256s
     0     0 69974.7379    0  416 49202.1584 69974.7379  42.2%     - 1266s
     0     0 69958.3134    0  416 49202.1584 69958.3134  42.2%     - 1276s
     0     0 69955.9300    0  419 49202.1584 69955.9300  42.2%     - 1280s
     0     0 69740.3037    0  421 49202.1584 69740.3037  41.7%     - 1318s
H    0     0                    50075.707965 69740.1544  39.3%     - 1319s
H    0     0                    50373.290112 69740.1544  38.4%     - 1319s
     0     0 69698.9105    0  428 50373.2901 69698.9105  38.4%     - 1336s
     0     0 69673.8874    0  437 50373.2901 69673.8874  38.3%     - 1352s
     0     0 69663.7438    0  432 50373.2901 69663.7438  38.3%     - 1362s
     0     0 69651.5536    0  436 50373.2901 69651.5536  38.3%     - 1373s
     0     0 69647.0993    0  435 50373.2901 69647.0993  38.3%     - 1379s
     0     0 69642.8386    0  430 50373.2901 69642.8386  38.3%     - 1383s
     0     0 69639.7748    0  438 50373.2901 69639.7748  38.2%     - 1386s
     0     0 69636.9231    0  436 50373.2901 69636.9231  38.2%     - 1388s
     0     0 69627.3043    0  440 50373.2901 69627.3043  38.2%     - 1398s
     0     0 69624.2910    0  435 50373.2901 69624.2910  38.2%     - 1401s
     0     0 69623.1193    0  437 50373.2901 69623.1193  38.2%     - 1403s
     0     0 69522.7791    0  375 50373.2901 69522.7791  38.0%     - 1428s
H    0     0                    50721.693483 69522.1617  37.1%     - 1432s
H    0     0                    50832.922846 69522.1617  36.8%     - 1432s
     0     0 69493.9058    0  426 50832.9228 69493.9058  36.7%     - 1448s
     0     0 69479.9464    0  419 50832.9228 69479.9464  36.7%     - 1460s
     0     0 69475.4997    0  421 50832.9228 69475.4997  36.7%     - 1469s
     0     0 69469.5781    0  422 50832.9228 69469.5781  36.7%     - 1476s
     0     0 69465.1503    0  425 50832.9228 69465.1503  36.7%     - 1480s
     0     0 69462.7810    0  420 50832.9228 69462.7810  36.6%     - 1482s
     0     0 69429.8654    0  439 50832.9228 69429.8654  36.6%     - 1499s
     0     0 69425.1677    0  445 50832.9228 69425.1677  36.6%     - 1511s
     0     0 69423.3339    0  442 50832.9228 69423.3339  36.6%     - 1516s
     0     0 69400.2296    0  437 50832.9228 69400.2296  36.5%     - 1528s
H    0     0                    51139.515111 69400.1044  35.7%     - 1531s
     0     0 69394.1743    0  437 51139.5151 69394.1743  35.7%     - 1537s
     0     0 69389.4113    0  433 51139.5151 69389.4113  35.7%     - 1539s
     0     0 69387.8871    0  431 51139.5151 69387.8871  35.7%     - 1542s
     0     0 69356.7761    0  439 51139.5151 69356.7761  35.6%     - 1558s
     0     0 69346.4630    0  443 51139.5151 69346.4630  35.6%     - 1566s
     0     0 69343.9685    0  435 51139.5151 69343.9685  35.6%     - 1569s
     0     0 69337.4838    0  396 51139.5151 69337.4838  35.6%     - 1575s
H    0     0                    51283.517555 69337.4411  35.2%     - 1579s
     0     0 69330.8535    0  400 51283.5176 69330.8535  35.2%     - 1584s
     0     0 69329.4459    0  404 51283.5176 69329.4459  35.2%     - 1587s
     0     0 69324.3165    0  438 51283.5176 69324.3165  35.2%     - 1594s
     0     0 69324.2740    0  438 51283.5176 69324.2740  35.2%     - 1599s
H    0     0                    51283.955263 69324.2294  35.2%     - 1898s
     0     2 69324.2294    0  438 51283.9553 69324.2294  35.2%     - 1902s
     1     3 69234.6028    1  378 51283.9553 69324.0855  35.2%  6127 1915s
     2     4 69265.2769    1  436 51283.9553 69265.2769  35.1%  5884 1930s
     3     7 68776.5031    2  429 51283.9553 69265.1756  35.1%  6984 1968s
     6    13 68712.3284    3  378 51283.9553 69264.9704  35.1%  9475 1998s
    12    24 68684.0931    4  414 51283.9553 69227.9069  35.0% 10319 2058s
    23    35 68287.2664    5  386 51283.9553 69035.4589  34.6% 18757 2211s
    34    65 67168.2617    6  370 51283.9553 68736.3699  34.0% 19821 2425s
    64    97 67126.4886    7  375 51283.9553 68736.3532  34.0% 23158 2504s
H   82    97                    51319.265601 68736.3532  33.9% 21741 2504s
    96   159 67118.6862    8  366 51319.2656 68736.3532  33.9% 20877 2719s
   158   283 67104.7204   10  356 51319.2656 68736.3532  33.9% 16636 2813s
   282   338 66821.3202   14  340 51319.2656 68736.3532  33.9% 12092 2872s
H  295   338                    51351.056146 68736.3532  33.9% 11751 2872s
   337   391 66594.5508   18  286 51351.0561 68736.3532  33.9% 11219 2926s
   390   452 65472.6041   20  282 51351.0561 68736.3532  33.9% 10930 2986s
   451   504 65190.0880   22  433 51351.0561 68736.3532  33.9% 10215 3042s
   503   532 64961.8758   23  360 51351.0561 68736.3532  33.9%  9761 3107s
   531   571 64873.2952   24  364 51351.0561 68736.3532  33.9%  9645 3202s
   570   609 64844.0685   25  371 51351.0561 68736.3532  33.9%  9434 3301s
   608   658 64834.6809   26  359 51351.0561 68736.3532  33.9%  9286 3346s
   657   698 64711.7506   27  363 51351.0561 68736.3532  33.9%  8977 3394s
   697   742 64598.0443   28  355 51351.0561 68736.3532  33.9%  8793 3446s
H  711   742                    51676.345707 68736.3532  33.0%  8728 3446s
   741   840 64587.4164   29  354 51676.3457 68736.3532  33.0%  8600 3501s
   839   936 64063.3292   34  350 51676.3457 68736.3532  33.0%  7999 3554s
   935  1040 62220.8309   38  192 51676.3457 68736.3532  33.0%  7562 3600s

Cutting planes:
  Learned: 5
  Gomory: 12
  Implied bound: 143
  MIR: 2473
  Flow cover: 3015
  RLT: 98
  Relax-and-lift: 938
  PSD: 1

Explored 1039 nodes (8159353 simplex iterations) in 3600.06 seconds (4858.47 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 51676.3 51351.1 51319.3 ... 50075.7

Time limit reached
Best objective 5.167634570700e+04, best bound 6.873635320167e+04, gap 33.0132%
  WARNING: Time limit reached. Using best solution found (gap: 33.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 51676.35, θ = 202162.46
  Upper Bound (UB) = 51676.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202162.46
  [DEBUG]   ✓ Scenario 0: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 202162.46 ≤ Q = 202162.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 202162.46 ≤ Q = 202162.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 202162.46 ≤ Q = 204010.29 (slack: 1847.83)
  [DEBUG]   ✓ Scenario 10: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 202162.46 ≤ Q = 202162.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 202162.46 ≤ Q = 202162.46 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x65bdf367
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9a420c99
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.510029e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7318969.3661
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.693506e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169350.59    0  124 7318969.37 -169350.59   102%     -    0s
H    0     0                    -134460.5070 -169350.59  25.9%     -    0s
H    0     0                    -134723.7595 -169350.59  25.7%     -    0s
H    0     0                    -135177.3423 -146310.37  8.24%     -    0s
     0     0 -146310.37    0  123 -135177.34 -146310.37  8.24%     -    0s
H    0     0                    -143578.7661 -146307.63  1.90%     -    0s
H    0     0                    -143840.5093 -146307.63  1.72%     -    0s
     0     0 -145082.28    0  104 -143840.51 -145082.28  0.86%     -    0s
H    0     0                    -143963.0039 -145035.11  0.74%     -    0s
     0     0 -145035.11    0   95 -143963.00 -145035.11  0.74%     -    0s
     0     0 -144801.30    0   75 -143963.00 -144801.30  0.58%     -    0s
     0     0 -144760.20    0   80 -143963.00 -144760.20  0.55%     -    0s
     0     0 -144750.60    0   82 -143963.00 -144750.60  0.55%     -    0s
     0     0 -144672.49    0   78 -143963.00 -144672.49  0.49%     -    0s
     0     0 -144649.36    0   78 -143963.00 -144649.36  0.48%     -    0s
     0     0 -144649.36    0   74 -143963.00 -144649.36  0.48%     -    0s
     0     2 -144649.36    0   74 -143963.00 -144649.36  0.48%     -    0s
H  123    28                    -144029.7777 -144222.90  0.13%  10.9    0s

Cutting planes:
  Gomory: 37
  Implied bound: 10
  MIR: 165
  Flow cover: 12
  RLT: 43
  Relax-and-lift: 8
  BQP: 2

Explored 291 nodes (2710 simplex iterations) in 0.38 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -144030 -143963 -143841 ... 1.51003e+13
No other solutions better than -144030

Optimal solution found (tolerance 1.00e-06)
Best objective -1.440297776676e+05, best bound -1.440297776676e+05, gap 0.0000%
  Subproblem solved in 0.41s
  Worst-case operational profit (Z_SP) = 196629.31
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144029.78
  [DEBUG]   S×d_nominal = 340659.09
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 340659.09 + -144029.78 = 196629.31
  [DEBUG]   Current θ from Master = 202162.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5533.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 46143.19
  Lower Bound (LB) = 47833.94
  Gap (UB-LB) = 3842.4068, Absolute Gap = 3842.4068, Relative Gap = 0.074355
  Not converged yet (gap = 3842.41 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0x86c8a281
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106418 rows and 43234 columns
Presolve time: 4.25s
Presolved: 124315 rows, 52626 columns, 766474 nonzeros
Variable types: 50367 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 657
 AA' NZ     : 5.484e+06
 Factor NZ  : 1.240e+07 (roughly 170 MB of memory)
 Factor Ops : 2.740e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.10237213e+07  2.43787220e+08  1.54e+05 1.62e+01  9.79e+04     7s
   1  -1.61394900e+07  2.26644720e+08  1.08e+05 9.32e+01  6.80e+04     7s
   2  -5.33173601e+06  1.78367706e+08  3.51e+04 2.87e+01  2.34e+04     7s
   3  -1.56206719e+06  1.24127255e+08  6.55e+03 1.62e+00  4.70e+03     7s
   4  -6.99605767e+05  8.47183196e+07  8.51e+02 5.98e-01  8.84e+02     7s
   5  -5.91808447e+05  4.52309391e+07  4.20e+02 2.35e-01  4.24e+02     7s
   6  -4.51421319e+05  2.96008471e+07  1.83e+02 1.41e-01  2.20e+02     7s
   7  -3.37290627e+05  2.08118497e+07  7.21e+01 9.06e-02  1.24e+02     7s
   8  -2.06442436e+05  1.40432184e+07  2.50e+01 5.60e-02  7.13e+01     7s
   9  -1.26027036e+05  8.03163289e+06  8.91e+00 2.97e-02  3.79e+01     8s
  10  -9.32836003e+04  4.90789880e+06  2.98e+00 1.76e-02  2.25e+01     8s
  11  -6.12304934e+04  2.11876396e+06  7.96e-01 7.20e-03  9.65e+00     8s
  12  -3.67638776e+04  9.59853356e+05  3.94e-01 3.32e-03  4.40e+00     8s
  13  -1.59229561e+04  4.34295855e+05  2.36e-01 1.49e-03  1.99e+00     8s
  14   8.20523864e+03  2.69799746e+05  1.48e-01 1.07e-03  1.15e+00     8s
  15   1.87903339e+04  2.22830126e+05  1.23e-01 1.48e-03  9.00e-01     8s
  16   2.60150457e+04  1.59385964e+05  1.07e-01 1.35e-03  5.88e-01     8s
  17   3.30235157e+04  1.41956629e+05  9.26e-02 1.32e-03  4.81e-01     8s
  18   3.89483786e+04  1.21438791e+05  8.08e-02 2.09e-03  3.64e-01     8s
  19   4.83014447e+04  1.08096522e+05  6.16e-02 2.04e-03  2.64e-01     9s
  20   5.37090287e+04  1.04380105e+05  5.09e-02 2.01e-03  2.24e-01     9s
  21   5.69876908e+04  9.83545962e+04  4.46e-02 1.84e-03  1.83e-01     9s
  22   6.10967138e+04  9.50924747e+04  3.71e-02 1.49e-03  1.50e-01     9s
  23   6.57144089e+04  9.20502551e+04  2.87e-02 1.12e-03  1.16e-01     9s
  24   6.79641996e+04  8.99034049e+04  2.49e-02 8.68e-04  9.69e-02     9s
  25   6.91800134e+04  8.78786542e+04  2.27e-02 6.29e-04  8.26e-02     9s
  26   7.10566616e+04  8.68704041e+04  1.95e-02 5.06e-04  6.98e-02    10s
  27   7.32629320e+04  8.59980034e+04  1.57e-02 6.29e-04  5.62e-02    10s
  28   7.42903696e+04  8.51979319e+04  1.38e-02 4.60e-04  4.82e-02    10s
  29   7.45953776e+04  8.50227342e+04  1.33e-02 4.18e-04  4.61e-02    10s
  30   7.53385245e+04  8.47092112e+04  1.20e-02 3.66e-04  4.14e-02    10s
  31   7.62723194e+04  8.42793549e+04  1.05e-02 2.88e-04  3.54e-02    10s
  32   7.77257930e+04  8.39718997e+04  8.12e-03 2.23e-04  2.76e-02    10s
  33   7.84174782e+04  8.35185438e+04  6.95e-03 1.79e-04  2.25e-02    11s
  34   7.94202145e+04  8.32191223e+04  5.27e-03 2.01e-04  1.68e-02    11s
  35   8.03074047e+04  8.30638630e+04  3.76e-03 1.58e-04  1.22e-02    11s
  36   8.11611708e+04  8.29211448e+04  2.38e-03 9.04e-05  7.77e-03    11s
  37   8.16770811e+04  8.29032615e+04  1.56e-03 8.29e-05  5.42e-03    11s
  38   8.20139914e+04  8.28158067e+04  1.02e-03 4.36e-05  3.54e-03    11s
  39   8.23730931e+04  8.27550383e+04  4.75e-04 7.58e-05  1.69e-03    11s
  40   8.25602558e+04  8.27396045e+04  1.98e-04 4.87e-05  7.92e-04    12s
  41   8.26448837e+04  8.27255259e+04  8.07e-05 2.69e-05  3.56e-04    12s
  42   8.26992598e+04  8.27178042e+04  8.32e-06 1.44e-05  8.17e-05    12s
  43   8.27026699e+04  8.27099672e+04  5.10e-06 1.40e-06  3.22e-05    12s
  44   8.27079325e+04  8.27090934e+04  2.34e-07 6.69e-07  5.12e-06    12s
  45   8.27082917e+04  8.27085210e+04  3.55e-08 1.66e-07  1.01e-06    12s
  46   8.27083390e+04  8.27083417e+04  4.91e-09 1.16e-08  1.18e-08    13s
  47   8.27083390e+04  8.27083414e+04  1.01e-08 6.68e-08  1.06e-08    13s
  48   8.27083393e+04  8.27083413e+04  3.53e-07 6.84e-08  8.91e-09    13s
  49   8.27083402e+04  8.27083403e+04  5.00e-08 2.05e-07  4.98e-10    13s

Barrier solved model in 49 iterations and 13.18 seconds (12.21 work units)
Optimal objective 8.27083402e+04


Root crossover log...

  111213 DPushes remaining with DInf 0.0000000e+00                13s
   54850 DPushes remaining with DInf 0.0000000e+00                15s
   12968 DPushes remaining with DInf 0.0000000e+00                20s
     737 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                26s

    3506 PPushes remaining with PInf 1.7408455e-05                26s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1832010e+03     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64867    8.2708340e+04   0.000000e+00   1.183201e+03     27s
   64924    8.2708340e+04   0.000000e+00   0.000000e+00     28s
   64924    8.2708340e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 7.52s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.270834e+04, 64924 iterations, 30.05 seconds (36.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82708.3403    0  187 -227427.98 82708.3403   136%     -   36s
H    0     0                    -178486.8436 82708.3403   146%     -   37s
H    0     0                    -178216.3874 82708.3403   146%     -   37s
H    0     0                    -133076.4604 82708.3403   162%     -   37s
H    0     0                    -132822.4554 82708.3403   162%     -   38s
H    0     0                    -48997.75265 82708.3403   269%     -   38s
H    0     0                    -47506.35037 82708.3403   274%     -   38s
H    0     0                    -47321.16753 82708.3403   275%     -   39s
H    0     0                    -40874.70111 82708.3403   302%     -   39s
H    0     0                    -40420.34415 82708.3403   305%     -   39s
H    0     0                    -32610.07970 82708.3403   354%     -   39s
H    0     0                    -32445.98534 82708.3403   355%     -   39s
H    0     0                    15074.948595 82708.3403   449%     -   39s
H    0     0                    15096.037078 82708.3403   448%     -   39s
H    0     0                    25559.037310 82708.3403   224%     -   41s
H    0     0                    26757.132200 82708.3403   209%     -   41s
H    0     0                    28395.416805 82708.3403   191%     -   42s
H    0     0                    28735.172758 82708.3403   188%     -   42s
H    0     0                    28749.057767 82708.3403   188%     -   42s
H    0     0                    28914.058708 82708.3403   186%     -   42s
H    0     0                    29311.755912 82708.3403   182%     -   42s
H    0     0                    29936.903529 82708.3403   176%     -   42s
     0     0 76765.4185    0  258 29936.9035 76765.4185   156%     -  268s
H    0     0                    30156.883753 76765.4185   155%     -  269s
H    0     0                    30302.641391 76765.4185   153%     -  269s
H    0     0                    30840.742076 76765.4185   149%     -  269s
H    0     0                    31004.337953 76765.4185   148%     -  269s
H    0     0                    31109.733254 76765.4185   147%     -  269s
     0     0 76586.1954    0  258 31109.7333 76586.1954   146%     -  334s
     0     0 76586.1954    0  246 31109.7333 76586.1954   146%     -  363s
     0     0 76586.1954    0  248 31109.7333 76586.1954   146%     -  368s
     0     0 76586.1954    0  248 31109.7333 76586.1954   146%     -  373s
     0     0 76586.1954    0  247 31109.7333 76586.1954   146%     -  384s
     0     0 73514.7917    0  256 31109.7333 73514.7917   136%     -  396s
     0     0 73514.7917    0  239 31109.7333 73514.7917   136%     -  397s
     0     0 73451.9141    0  247 31109.7333 73451.9141   136%     -  470s
H    0     0                    32961.573985 73451.7450   123%     -  471s
H    0     0                    35887.313702 73451.7450   105%     -  471s
H    0     0                    36174.329043 73451.7450   103%     -  471s
H    0     0                    36893.177475 73451.7450  99.1%     -  471s
H    0     0                    37320.779178 73451.7450  96.8%     -  471s
     0     0 72747.8565    0  262 37320.7792 72747.8565  94.9%     -  520s
     0     0 72653.9520    0  278 37320.7792 72653.9520  94.7%     -  545s
     0     0 72590.0688    0  290 37320.7792 72590.0688  94.5%     -  565s
     0     0 72515.3514    0  276 37320.7792 72515.3514  94.3%     -  604s
     0     0 72490.9109    0  278 37320.7792 72490.9109  94.2%     -  623s
     0     0 72469.3282    0  275 37320.7792 72469.3282  94.2%     -  631s
     0     0 72466.8399    0  278 37320.7792 72466.8399  94.2%     -  639s
     0     0 72465.1999    0  278 37320.7792 72465.1999  94.2%     -  643s
     0     0 72451.4441    0  274 37320.7792 72451.4441  94.1%     -  655s
     0     0 72428.9404    0  287 37320.7792 72428.9404  94.1%     -  660s
     0     0 72428.1958    0  288 37320.7792 72428.1958  94.1%     -  662s
     0     0 71298.0463    0  310 37320.7792 71298.0463  91.0%     -  780s
H    0     0                    37892.807497 71297.8660  88.2%     -  781s
H    0     0                    38711.826017 71297.8660  84.2%     -  781s
H    0     0                    39175.839376 71104.5993  81.5%     -  822s
H    0     0                    42503.548828 71104.5993  67.3%     -  822s
H    0     0                    43723.917791 71104.5993  62.6%     -  822s
H    0     0                    43741.774663 71104.5993  62.6%     -  822s
     0     0 71104.5993    0  361 43741.7747 71104.5993  62.6%     -  822s
     0     0 71038.6282    0  322 43741.7747 71038.6282  62.4%     -  843s
     0     0 70999.7698    0  369 43741.7747 70999.7698  62.3%     -  862s
     0     0 70974.2164    0  369 43741.7747 70974.2164  62.3%     -  878s
     0     0 70962.4471    0  370 43741.7747 70962.4471  62.2%     -  887s
     0     0 70951.9860    0  375 43741.7747 70951.9860  62.2%     -  896s
     0     0 70949.2591    0  374 43741.7747 70949.2591  62.2%     -  900s
H    0     0                    44274.569810 70943.1708  60.2%     -  913s
H    0     0                    44333.402773 70943.1708  60.0%     -  913s
H    0     0                    45701.567642 70943.1708  55.2%     -  913s
H    0     0                    45762.251840 70943.1708  55.0%     -  913s
H    0     0                    46065.350354 70943.1708  54.0%     -  913s
     0     0 70943.1708    0  378 46065.3504 70943.1708  54.0%     -  913s
     0     0 70937.5186    0  378 46065.3504 70937.5186  54.0%     -  920s
     0     0 70928.2612    0  376 46065.3504 70928.2612  54.0%     -  930s
     0     0 70926.1068    0  378 46065.3504 70926.1068  54.0%     -  935s
     0     0 70925.3284    0  378 46065.3504 70925.3284  54.0%     -  937s
H    0     0                    46209.563549 70925.3284  53.5%     -  972s
H    0     0                    46231.973857 70925.3284  53.4%     -  972s
H    0     0                    46332.218398 70925.3284  53.1%     -  972s
     0     0 70499.5039    0  339 46332.2184 70499.5039  52.2%     - 1029s
H    0     0                    46607.670135 70498.3816  51.3%     - 1031s
H    0     0                    46615.596857 70498.3816  51.2%     - 1031s
H    0     0                    46621.453444 70498.3816  51.2%     - 1031s
     0     0 70242.5327    0  341 46621.4534 70242.5327  50.7%     - 1068s
     0     0 70171.5918    0  384 46621.4534 70171.5918  50.5%     - 1096s
     0     0 70148.4532    0  354 46621.4534 70148.4532  50.5%     - 1109s
     0     0 70118.4916    0  391 46621.4534 70118.4916  50.4%     - 1129s
     0     0 70102.3842    0  364 46621.4534 70102.3842  50.4%     - 1142s
     0     0 70097.4702    0  362 46621.4534 70097.4702  50.4%     - 1146s
     0     0 70095.0936    0  361 46621.4534 70095.0936  50.3%     - 1148s
     0     0 70093.0998    0  361 46621.4534 70093.0998  50.3%     - 1150s
     0     0 70091.2330    0  359 46621.4534 70091.2330  50.3%     - 1152s
     0     0 70090.3937    0  397 46621.4534 70090.3937  50.3%     - 1154s
     0     0 69981.5079    0  382 46621.4534 69981.5079  50.1%     - 1177s
     0     0 69938.7274    0  393 46621.4534 69938.7274  50.0%     - 1196s
     0     0 69921.5974    0  395 46621.4534 69921.5974  50.0%     - 1207s
     0     0 69905.1762    0  397 46621.4534 69905.1762  49.9%     - 1224s
     0     0 69873.1308    0  397 46621.4534 69873.1308  49.9%     - 1242s
     0     0 69830.6850    0  404 46621.4534 69830.6850  49.8%     - 1262s
     0     0 69822.2591    0  405 46621.4534 69822.2591  49.8%     - 1267s
     0     0 69819.7385    0  403 46621.4534 69819.7385  49.8%     - 1269s
     0     0 69817.3167    0  405 46621.4534 69817.3167  49.8%     - 1273s
     0     0 69815.4486    0  404 46621.4534 69815.4486  49.7%     - 1275s
     0     0 69813.2091    0  400 46621.4534 69813.2091  49.7%     - 1277s
     0     0 69810.8409    0  406 46621.4534 69810.8409  49.7%     - 1279s
     0     0 69800.4006    0  409 46621.4534 69800.4006  49.7%     - 1283s
     0     0 69796.8538    0  407 46621.4534 69796.8538  49.7%     - 1287s
     0     0 69796.1602    0  411 46621.4534 69796.1602  49.7%     - 1291s
     0     0 69730.5746    0  363 46621.4534 69730.5746  49.6%     - 1312s
H    0     0                    46906.365998 69729.4621  48.7%     - 1315s
H    0     0                    47024.198057 69729.4621  48.3%     - 1315s
H    0     0                    47147.409724 69729.4621  47.9%     - 1315s
     0     0 69719.6653    0  404 47147.4097 69719.6653  47.9%     - 1320s
     0     0 69718.2279    0  367 47147.4097 69718.2279  47.9%     - 1322s
     0     0 69661.2134    0  421 47147.4097 69661.2134  47.8%     - 1338s
     0     0 69642.1099    0  416 47147.4097 69642.1099  47.7%     - 1349s
     0     0 69641.0993    0  417 47147.4097 69641.0993  47.7%     - 1354s
     0     0 69574.6252    0  404 47147.4097 69574.6252  47.6%     - 1371s
     0     0 69551.6135    0  369 47147.4097 69551.6135  47.5%     - 1387s
     0     0 69544.9328    0  363 47147.4097 69544.9328  47.5%     - 1399s
H    0     0                    47160.364740 69540.9565  47.5%     - 1402s
     0     0 69540.9565    0  367 47160.3647 69540.9565  47.5%     - 1403s
     0     0 69540.3115    0  369 47160.3647 69540.3115  47.5%     - 1404s
     0     0 69504.7207    0  369 47160.3647 69504.7207  47.4%     - 1429s
     0     0 69497.2828    0  379 47160.3647 69497.2828  47.4%     - 1441s
     0     0 69494.3575    0  419 47160.3647 69494.3575  47.4%     - 1448s
     0     0 69492.6409    0  416 47160.3647 69492.6409  47.4%     - 1451s
     0     0 69492.4160    0  415 47160.3647 69492.4160  47.4%     - 1453s
     0     0 69466.3429    0  420 47160.3647 69466.3429  47.3%     - 1470s
     0     0 69456.1276    0  417 47160.3647 69456.1276  47.3%     - 1485s
     0     0 69452.7975    0  419 47160.3647 69452.7975  47.3%     - 1492s
     0     0 69451.9228    0  384 47160.3647 69451.9228  47.3%     - 1495s
     0     0 69434.7451    0  415 47160.3647 69434.7451  47.2%     - 1510s
     0     0 69431.2004    0  415 47160.3647 69431.2004  47.2%     - 1516s
     0     0 69428.6794    0  418 47160.3647 69428.6794  47.2%     - 1520s
     0     0 69427.4831    0  377 47160.3647 69427.4831  47.2%     - 1522s
     0     0 69410.5963    0  407 47160.3647 69410.5963  47.2%     - 1535s
H    0     0                    47261.915401 69410.4105  46.9%     - 1567s
     0     0 69399.9805    0  413 47261.9154 69399.9805  46.8%     - 1574s
     0     0 69398.6546    0  418 47261.9154 69398.6546  46.8%     - 1577s
     0     0 69395.7845    0  425 47261.9154 69395.7845  46.8%     - 1587s
     0     0 69394.5486    0  426 47261.9154 69394.5486  46.8%     - 1591s
     0     0 69386.2436    0  434 47261.9154 69386.2436  46.8%     - 1600s
H    0     0                    47821.706440 69385.7382  45.1%     - 1726s
H    0     0                    47867.827017 69385.7382  45.0%     - 1731s
H    0     0                    48683.711575 69385.7382  42.5%     - 1731s
     0     0 69383.4234    0  432 48683.7116 69383.4234  42.5%     - 1744s
     0     0 69382.5802    0  432 48683.7116 69382.5802  42.5%     - 1745s
     0     0 69377.1105    0  422 48683.7116 69377.1105  42.5%     - 1752s
     0     0 69356.4503    0  422 48683.7116 69356.4503  42.5%     - 1757s
H    0     0                    49052.964990 69356.4503  41.4%     - 1905s
     0     2 69356.4503    0  422 49052.9650 69356.4503  41.4%     - 2081s
     1     3 68874.5296    1  398 49052.9650 69356.4503  41.4% 12192 2109s
     2     4 69157.6187    1  377 49052.9650 69157.6187  41.0% 12265 2132s
     3     5 68537.5598    2  409 49052.9650 69157.2756  41.0% 11699 2160s
     4     7 68876.4064    2  383 49052.9650 69156.8568  41.0% 10472 2197s
     6    12 68742.9267    3  407 49052.9650 69156.8568  41.0%  9654 2249s
    11    22 68505.3718    4  422 49052.9650 68876.1741  40.4% 13135 2311s
    21    32 67279.8515    5  404 49052.9650 68741.0735  40.1% 18626 2455s
H   31    63                    50074.625547 68505.3139  36.8% 18162 2675s
    62    95 67004.2351    6  346 50074.6255 68504.1302  36.8% 21295 2726s
    94   177 66642.3691    7  378 50074.6255 68504.1302  36.8% 18896 2807s
   176   205 66527.8233    9  380 50074.6255 68504.1302  36.8% 14305 2859s
   204   234 66355.1981   10  361 50074.6255 68504.1302  36.8% 13500 2946s
   233   259 65308.6454   14  245 50074.6255 68504.1302  36.8% 12692 3094s
   258   288 66124.0894   11  360 50074.6255 68504.1302  36.8% 12427 3237s
H  285   288                    51251.922016 68504.1302  33.7% 11952 3237s
   287   350 66004.4113   12  351 51251.9220 68504.1302  33.7% 11962 3337s
   349   430 65898.0565   14  346 51251.9220 68504.1302  33.7% 11355 3402s
   429   462 65857.5537   16  348 51251.9220 68504.1302  33.7% 10186 3507s
   461   494 65805.6874   17  347 51251.9220 68504.1302  33.7%  9931 3600s

Cutting planes:
  Learned: 2
  Gomory: 12
  Implied bound: 11
  MIR: 1431
  Flow cover: 2881
  RLT: 43
  Relax-and-lift: 272

Explored 493 nodes (5404001 simplex iterations) in 3600.13 seconds (4973.38 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 51251.9 50074.6 49053 ... 47024.2

Time limit reached
Best objective 5.125192201598e+04, best bound 6.850413019522e+04, gap 33.6616%
  WARNING: Time limit reached. Using best solution found (gap: 33.66%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 51251.92, θ = 202686.52
  Upper Bound (UB) = 51251.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202686.52
  [DEBUG]   ✓ Scenario 0: θ = 202686.52 ≤ Q = 202686.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 202686.52 ≤ Q = 203275.37 (slack: 588.85)
  [DEBUG]   ✓ Scenario 2: θ = 202686.52 ≤ Q = 202686.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 202686.52 ≤ Q = 202686.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 202686.52 ≤ Q = 202686.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 202686.52 ≤ Q = 202686.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 202686.52 ≤ Q = 202686.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 202686.52 ≤ Q = 202686.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 202686.52 ≤ Q = 202686.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 202686.52 ≤ Q = 202686.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 202686.52 ≤ Q = 202686.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 202686.52 ≤ Q = 202686.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 202686.52 ≤ Q = 202686.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 202686.52 ≤ Q = 202686.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 202686.52 ≤ Q = 202686.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x29797975
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x29797975
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.510029e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7322887.9079
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.682915e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168291.49    0  123 7322887.91 -168291.49   102%     -    0s
H    0     0                    -133354.5546 -168291.49  26.2%     -    0s
H    0     0                    -133617.8072 -168291.49  25.9%     -    0s
H    0     0                    -134074.8455 -145467.11  8.50%     -    0s
H    0     0                    -135287.4648 -145467.11  7.52%     -    0s
     0     0 -145467.11    0  103 -135287.46 -145467.11  7.52%     -    0s
H    0     0                    -141017.3092 -145340.07  3.07%     -    0s
H    0     0                    -142831.2478 -145340.07  1.76%     -    0s
     0     0 -143990.79    0  103 -142831.25 -143990.79  0.81%     -    0s
H    0     0                    -143079.4040 -143986.31  0.63%     -    0s
     0     0 -143957.38    0   93 -143079.40 -143957.38  0.61%     -    0s
     0     0 -143703.01    0   88 -143079.40 -143703.01  0.44%     -    0s
     0     0 -143663.23    0   60 -143079.40 -143663.23  0.41%     -    0s
     0     0 -143657.81    0   58 -143079.40 -143657.81  0.40%     -    0s
     0     0 -143574.57    0   67 -143079.40 -143574.57  0.35%     -    0s
     0     0 -143559.21    0   67 -143079.40 -143559.21  0.34%     -    0s
     0     0 -143504.77    0   49 -143079.40 -143504.77  0.30%     -    0s
     0     0 -143496.83    0   60 -143079.40 -143496.83  0.29%     -    0s
     0     0 -143454.50    0   53 -143079.40 -143454.50  0.26%     -    0s
     0     0 -143453.86    0   53 -143079.40 -143453.86  0.26%     -    0s
     0     2 -143453.86    0   53 -143079.40 -143453.86  0.26%     -    0s
H  240    37                    -143090.9943 -143147.10  0.04%   5.1    0s
*  262     9              22    -143103.6238 -143147.10  0.03%   4.9    0s
*  265     9              20    -143124.2371 -143147.10  0.02%   4.9    0s
*  330     0              23    -143130.3544 -143144.47  0.01%   4.3    0s

Cutting planes:
  Gomory: 34
  Implied bound: 2
  MIR: 143
  Flow cover: 28
  RLT: 39
  Relax-and-lift: 10
  BQP: 1

Explored 336 nodes (2087 simplex iterations) in 0.26 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -143130 -143124 -143104 ... 7.32289e+06
No other solutions better than -143130

Optimal solution found (tolerance 1.00e-06)
Best objective -1.431303544123e+05, best bound -1.431303544123e+05, gap 0.0000%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 197603.85
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143130.35
  [DEBUG]   S×d_nominal = 340734.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 340734.21 + -143130.35 = 197603.85
  [DEBUG]   Current θ from Master = 202686.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5082.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 46169.25
  Lower Bound (LB) = 47833.94
  Gap (UB-LB) = 3417.9831, Absolute Gap = 3417.9831, Relative Gap = 0.066690
  Not converged yet (gap = 3417.98 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0x3792846c
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113488 rows and 46104 columns (presolve time = 5s)...
Presolve removed 113488 rows and 46104 columns
Presolve time: 5.92s
Presolved: 132535 rows, 55996 columns, 817802 nonzeros
Variable types: 53737 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.71s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 6.212e+06
 Factor NZ  : 1.377e+07 (roughly 200 MB of memory)
 Factor Ops : 3.034e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.17306459e+07  2.58036860e+08  1.58e+05 1.57e+01  1.01e+05    10s
   1  -1.67191218e+07  2.41208500e+08  1.11e+05 9.38e+01  7.01e+04    10s
   2  -5.62599837e+06  1.92272615e+08  3.68e+04 3.52e+01  2.45e+04    10s
   3  -1.70428938e+06  1.34541469e+08  7.49e+03 1.64e+00  5.32e+03    10s
   4  -7.17195145e+05  9.09895136e+07  8.72e+02 5.97e-01  9.02e+02    10s
   5  -6.16842686e+05  4.90748369e+07  4.37e+02 2.33e-01  4.38e+02    10s
   6  -4.62946986e+05  3.18923309e+07  1.35e+02 1.37e-01  1.99e+02    11s
   7  -3.29920169e+05  2.21974412e+07  3.63e+01 8.80e-02  1.08e+02    11s
   8  -2.97613581e+05  1.56338375e+07  2.72e+01 6.02e-02  7.51e+01    11s
   9  -1.61496673e+05  1.26465686e+07  8.33e+00 4.75e-02  5.54e+01    11s
  10  -1.25469903e+05  6.46780244e+06  5.03e+00 2.34e-02  2.81e+01    11s
  11  -1.00880179e+05  4.12981679e+06  2.26e+00 1.48e-02  1.77e+01    11s
  12  -5.76571903e+04  2.19970509e+06  6.50e-01 7.35e-03  9.37e+00    11s
  13  -2.96882210e+04  1.13859854e+06  2.82e-01 3.72e-03  4.84e+00    12s
  14  -2.51895566e+03  4.48780183e+05  1.31e-01 1.29e-03  1.87e+00    12s
  15   1.40045373e+04  3.08773158e+05  9.17e-02 8.98e-04  1.22e+00    12s
  16   1.92283925e+04  2.00670212e+05  8.15e-02 1.51e-03  7.51e-01    12s
  17   2.81030636e+04  1.90785672e+05  6.97e-02 1.41e-03  6.73e-01    12s
  18   3.38578099e+04  1.68248928e+05  6.09e-02 1.35e-03  5.56e-01    12s
  19   3.93450881e+04  1.50262666e+05  5.30e-02 1.20e-03  4.59e-01    12s
  20   4.64305441e+04  1.29139468e+05  4.29e-02 1.01e-03  3.42e-01    13s
  21   5.22833957e+04  1.15418439e+05  3.51e-02 9.36e-04  2.61e-01    13s
  22   5.67191800e+04  1.10430693e+05  2.94e-02 7.99e-04  2.22e-01    13s
  23   6.15109252e+04  1.02730964e+05  2.36e-02 5.32e-04  1.71e-01    13s
  24   6.41716694e+04  9.72963938e+04  2.05e-02 3.70e-04  1.37e-01    13s
  25   6.76689115e+04  9.32700624e+04  1.66e-02 2.66e-04  1.06e-01    14s
  26   7.06693754e+04  9.08348014e+04  1.33e-02 2.11e-04  8.35e-02    14s
  27   7.23888421e+04  8.85952152e+04  1.15e-02 8.06e-04  6.71e-02    14s
  28   7.51175251e+04  8.78826161e+04  8.55e-03 6.92e-04  5.28e-02    14s
  29   7.52723761e+04  8.67584716e+04  8.36e-03 5.28e-04  4.75e-02    15s
  30   7.75644755e+04  8.61266378e+04  6.01e-03 4.24e-04  3.54e-02    15s
  31   7.93852728e+04  8.53789012e+04  4.08e-03 3.13e-04  2.48e-02    15s
  32   7.95898345e+04  8.51771957e+04  3.86e-03 2.77e-04  2.31e-02    15s
  33   8.02335163e+04  8.45352327e+04  3.18e-03 1.87e-04  1.78e-02    15s
  34   8.12950173e+04  8.42638681e+04  2.13e-03 1.49e-04  1.23e-02    16s
  35   8.19126554e+04  8.40250078e+04  1.53e-03 1.01e-04  8.74e-03    16s
  36   8.23715076e+04  8.38427042e+04  1.06e-03 6.64e-05  6.09e-03    16s
  37   8.26578936e+04  8.37499058e+04  7.72e-04 4.93e-05  4.52e-03    16s
  38   8.28074884e+04  8.36948692e+04  6.19e-04 3.99e-05  3.67e-03    17s
  39   8.30543562e+04  8.36057447e+04  3.82e-04 2.20e-05  2.28e-03    17s
  40   8.31804787e+04  8.35290106e+04  2.54e-04 1.03e-05  1.44e-03    17s
  41   8.32840798e+04  8.35028722e+04  1.59e-04 6.28e-06  9.06e-04    17s
  42   8.32901407e+04  8.34952598e+04  1.54e-04 5.21e-06  8.49e-04    17s
  43   8.33225954e+04  8.34926539e+04  1.24e-04 4.82e-06  7.04e-04    18s
  44   8.33603175e+04  8.34821614e+04  8.85e-05 3.25e-06  5.04e-04    18s
  45   8.33978097e+04  8.34739891e+04  5.32e-05 2.14e-06  3.15e-04    18s
  46   8.34231596e+04  8.34723844e+04  3.10e-05 1.93e-06  2.04e-04    18s
  47   8.34350287e+04  8.34633259e+04  2.04e-05 6.14e-07  1.17e-04    18s
  48   8.34472950e+04  8.34610627e+04  9.34e-06 3.23e-07  5.70e-05    19s
  49   8.34486516e+04  8.34604077e+04  8.16e-06 2.40e-07  4.87e-05    19s
  50   8.34530042e+04  8.34594046e+04  4.52e-06 1.00e-07  2.65e-05    19s
  51   8.34556840e+04  8.34589962e+04  2.35e-06 7.28e-08  1.37e-05    19s
  52   8.34573480e+04  8.34588301e+04  9.80e-07 1.23e-07  6.14e-06    19s
  53   8.34581618e+04  8.34587078e+04  3.24e-07 6.24e-08  2.26e-06    20s
  54   8.34585374e+04  8.34586035e+04  4.20e-08 4.01e-09  2.74e-07    20s
  55   8.34585927e+04  8.34585957e+04  1.49e-08 1.15e-09  1.26e-08    20s
  56   8.34585954e+04  8.34585956e+04  1.88e-07 4.73e-07  9.35e-10    20s

Barrier solved model in 56 iterations and 20.43 seconds (14.96 work units)
Optimal objective 8.34585954e+04


Root crossover log...

  118195 DPushes remaining with DInf 0.0000000e+00                20s
   29712 DPushes remaining with DInf 0.0000000e+00                25s
    6374 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                34s

    7381 PPushes remaining with PInf 6.8100716e-05                34s
    4307 PPushes remaining with PInf 4.1711597e-05                35s
       0 PPushes remaining with PInf 0.0000000e+00                36s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0369039e+02     36s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72608    8.3458596e+04   0.000000e+00   1.036904e+02     36s
   72704    8.3458596e+04   0.000000e+00   0.000000e+00     37s
   72704    8.3458596e+04   0.000000e+00   0.000000e+00     37s
Concurrent spin time: 8.73s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.345860e+04, 72704 iterations, 38.71 seconds (43.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83458.5956    0  185 -227427.98 83458.5956   137%     -   46s
H    0     0                    -216777.5294 83458.5956   138%     -   50s
H    0     0                    -216456.4805 83458.5956   139%     -   50s
H    0     0                    -51535.55501 83458.5956   262%     -   50s
H    0     0                    -51514.46653 83458.5956   262%     -   51s
H    0     0                    18447.357212 83458.5956   352%     -   51s
H    0     0                    25044.847140 83458.5956   233%     -   53s
H    0     0                    29092.857822 83458.5956   187%     -   53s
H    0     0                    29955.607263 83458.5956   179%     -   53s
H    0     0                    30128.034158 83458.5956   177%     -   53s
H    0     0                    30897.043795 83458.5956   170%     -   54s
H    0     0                    31067.610283 83458.5956   169%     -   54s
     0     0 77309.7298    0  237 31067.6103 77309.7298   149%     -  178s
H    0     0                    31091.758142 77307.0334   149%     -  179s
H    0     0                    31200.883259 77307.0334   148%     -  179s
     0     0 76414.4082    0  241 31200.8833 76414.4082   145%     -  236s
     0     0 76397.7450    0  207 31200.8833 76397.7450   145%     -  241s
     0     0 76396.4197    0  207 31200.8833 76396.4197   145%     -  242s
     0     0 76343.8822    0  206 31200.8833 76343.8822   145%     -  252s
     0     0 76335.9698    0  202 31200.8833 76335.9698   145%     -  256s
     0     0 76308.6200    0  214 31200.8833 76308.6200   145%     -  282s
     0     0 76290.4278    0  219 31200.8833 76290.4278   145%     -  293s
     0     0 76290.3313    0  215 31200.8833 76290.3313   145%     -  294s
     0     0 73854.9283    0  261 31200.8833 73854.9283   137%     -  398s
H    0     0                    34396.777780 73854.8954   115%     -  399s
H    0     0                    36756.124842 73854.8954   101%     -  399s
H    0     0                    37146.181747 73854.8954  98.8%     -  399s
H    0     0                    37948.321904 73854.8954  94.6%     -  399s
H    0     0                    37974.245746 73854.8954  94.5%     -  399s
     0     0 73395.3545    0  260 37974.2457 73395.3545  93.3%     -  469s
     0     0 73343.4617    0  265 37974.2457 73343.4617  93.1%     -  504s
     0     0 73314.1416    0  266 37974.2457 73314.1416  93.1%     -  517s
     0     0 73298.7360    0  268 37974.2457 73298.7360  93.0%     -  531s
     0     0 73284.0677    0  272 37974.2457 73284.0677  93.0%     -  543s
     0     0 73166.1561    0  271 37974.2457 73166.1561  92.7%     -  568s
     0     0 73137.0024    0  269 37974.2457 73137.0024  92.6%     -  580s
     0     0 73118.8024    0  269 37974.2457 73118.8024  92.5%     -  586s
     0     0 73100.2762    0  274 37974.2457 73100.2762  92.5%     -  603s
     0     0 73053.4035    0  273 37974.2457 73053.4035  92.4%     -  622s
     0     0 73033.3321    0  279 37974.2457 73033.3321  92.3%     -  636s
     0     0 73023.1773    0  281 37974.2457 73023.1773  92.3%     -  643s
     0     0 72999.4965    0  276 37974.2457 72999.4965  92.2%     -  657s
     0     0 72987.4115    0  281 37974.2457 72987.4115  92.2%     -  667s
     0     0 72973.1654    0  287 37974.2457 72973.1654  92.2%     -  680s
     0     0 72971.7872    0  283 37974.2457 72971.7872  92.2%     -  684s
     0     0 72970.6815    0  289 37974.2457 72970.6815  92.2%     -  685s
     0     0 72970.2835    0  287 37974.2457 72970.2835  92.2%     -  686s
     0     0 71540.4978    0  376 37974.2457 71540.4978  88.4%     -  812s
H    0     0                    38376.439635 71540.4912  86.4%     -  813s
H    0     0                    38476.343490 71540.4912  85.9%     -  813s
H    0     0                    38665.799320 71540.4912  85.0%     -  813s
H    0     0                    39613.674625 71540.4912  80.6%     -  813s
     0     0 71261.3319    0  349 39613.6746 71261.3319  79.9%     -  852s
     0     0 71191.9900    0  349 39613.6746 71191.9900  79.7%     -  876s
     0     0 71154.3640    0  356 39613.6746 71154.3640  79.6%     -  896s
     0     0 71116.9947    0  360 39613.6746 71116.9947  79.5%     -  920s
     0     0 71096.0268    0  370 39613.6746 71096.0268  79.5%     -  940s
     0     0 71076.8303    0  366 39613.6746 71076.8303  79.4%     -  960s
     0     0 71064.9830    0  367 39613.6746 71064.9830  79.4%     -  972s
     0     0 71048.7144    0  370 39613.6746 71048.7144  79.4%     -  981s
     0     0 71046.0068    0  371 39613.6746 71046.0068  79.3%     -  989s
     0     0 71042.2949    0  374 39613.6746 71042.2949  79.3%     -  996s
     0     0 71040.1984    0  371 39613.6746 71040.1984  79.3%     -  999s
     0     0 71039.5947    0  372 39613.6746 71039.5947  79.3%     - 1001s
     0     0 70400.6944    0  383 39613.6746 70400.6944  77.7%     - 1080s
     0     0 70239.6103    0  353 39613.6746 70239.6103  77.3%     - 1115s
     0     0 70154.3591    0  388 39613.6746 70154.3591  77.1%     - 1142s
     0     0 70126.9441    0  350 39613.6746 70126.9441  77.0%     - 1156s
     0     0 70088.9761    0  363 39613.6746 70088.9761  76.9%     - 1172s
     0     0 70071.5926    0  407 39613.6746 70071.5926  76.9%     - 1184s
     0     0 70062.2116    0  406 39613.6746 70062.2116  76.9%     - 1191s
     0     0 70060.5421    0  404 39613.6746 70060.5421  76.9%     - 1195s
     0     0 70056.5420    0  404 39613.6746 70056.5420  76.8%     - 1203s
     0     0 70052.4527    0  403 39613.6746 70052.4527  76.8%     - 1207s
     0     0 70029.4991    0  405 39613.6746 70029.4991  76.8%     - 1217s
     0     0 70013.6646    0  405 39613.6746 70013.6646  76.7%     - 1225s
     0     0 70001.2478    0  404 39613.6746 70001.2478  76.7%     - 1240s
     0     0 69996.7002    0  405 39613.6746 69996.7002  76.7%     - 1246s
     0     0 69995.4393    0  404 39613.6746 69995.4393  76.7%     - 1249s
     0     0 69850.9032    0  395 39613.6746 69850.9032  76.3%     - 1269s
H    0     0                    39902.208128 69850.3983  75.1%     - 1270s
     0     0 69817.3875    0  408 39902.2081 69817.3875  75.0%     - 1284s
     0     0 69798.3500    0  407 39902.2081 69798.3500  74.9%     - 1300s
     0     0 69779.5556    0  404 39902.2081 69779.5556  74.9%     - 1309s
     0     0 69774.3348    0  405 39902.2081 69774.3348  74.9%     - 1317s
     0     0 69769.4556    0  403 39902.2081 69769.4556  74.9%     - 1320s
     0     0 69768.7163    0  411 39902.2081 69768.7163  74.8%     - 1322s
     0     0 69667.3049    0  396 39902.2081 69667.3049  74.6%     - 1344s
H    0     0                    40000.705853 69666.6413  74.2%     - 1370s
     0     0 69656.2571    0  401 40000.7059 69656.2571  74.1%     - 1380s
     0     0 69654.2979    0  398 40000.7059 69654.2979  74.1%     - 1383s
     0     0 69650.5450    0  399 40000.7059 69650.5450  74.1%     - 1391s
     0     0 69645.1200    0  398 40000.7059 69645.1200  74.1%     - 1400s
     0     0 69639.7171    0  402 40000.7059 69639.7171  74.1%     - 1407s
     0     0 69638.4814    0  397 40000.7059 69638.4814  74.1%     - 1412s
     0     0 69620.1304    0  408 40000.7059 69620.1304  74.0%     - 1431s
H    0     0                    40037.244329 69620.0926  73.9%     - 1433s
H    0     0                    40107.624861 69620.0926  73.6%     - 1433s
     0     0 69615.9154    0  408 40107.6249 69615.9154  73.6%     - 1437s
     0     0 69609.5572    0  360 40107.6249 69609.5572  73.6%     - 1441s
     0     0 69606.4688    0  410 40107.6249 69606.4688  73.5%     - 1446s
     0     0 69605.8718    0  416 40107.6249 69605.8718  73.5%     - 1448s
     0     0 69591.1893    0  413 40107.6249 69591.1893  73.5%     - 1459s
H    0     0                    40908.577179 69590.1036  70.1%     - 1464s
H    0     0                    41430.283242 69590.1036  68.0%     - 1465s
H    0     0                    41860.899875 69590.1036  66.2%     - 1465s
H    0     0                    44621.004277 69590.1036  56.0%     - 1465s
H    0     0                    44663.239547 69590.1036  55.8%     - 1465s
H    0     0                    45580.240254 69590.1036  52.7%     - 1465s
     0     0 69587.0366    0  421 45580.2403 69587.0366  52.7%     - 1469s
     0     0 69578.2375    0  416 45580.2403 69578.2375  52.7%     - 1474s
     0     0 69577.0643    0  416 45580.2403 69577.0643  52.6%     - 1475s
     0     0 69516.2003    0  415 45580.2403 69516.2003  52.5%     - 1491s
H    0     0                    45999.190896 69515.1121  51.1%     - 1493s
H    0     0                    46180.268880 69515.1121  50.5%     - 1493s
H    0     0                    46191.223772 69515.1121  50.5%     - 1493s
     0     0 69406.2933    0  418 46191.2238 69406.2933  50.3%     - 1514s
     0     0 69395.0829    0  418 46191.2238 69395.0829  50.2%     - 1521s
     0     0 69388.4704    0  420 46191.2238 69388.4704  50.2%     - 1529s
     0     0 69387.6639    0  418 46191.2238 69387.6639  50.2%     - 1532s
     0     0 69371.3651    0  424 46191.2238 69371.3651  50.2%     - 1550s
H    0     0                    46829.196596 69371.2926  48.1%     - 1573s
H    0     0                    47049.562056 69371.2926  47.4%     - 1577s
H    0     0                    47480.109694 69371.2926  46.1%     - 1577s
H    0     0                    47695.317211 69371.2926  45.4%     - 1578s
     0     0 69368.4314    0  419 47695.3172 69368.4314  45.4%     - 1585s
     0     0 69367.0918    0  415 47695.3172 69367.0918  45.4%     - 1588s
     0     0 69331.3630    0  409 47695.3172 69331.3630  45.4%     - 1608s
H    0     0                    47795.162891 69331.1388  45.1%     - 1609s
H    0     0                    47893.855462 69331.1388  44.8%     - 1609s
     0     0 69311.0386    0  417 47893.8555 69311.0386  44.7%     - 1621s
     0     0 69305.7399    0  415 47893.8555 69305.7399  44.7%     - 1626s
     0     0 69303.0553    0  420 47893.8555 69303.0553  44.7%     - 1630s
     0     0 69302.1170    0  417 47893.8555 69302.1170  44.7%     - 1633s
     0     0 69295.7072    0  425 47893.8555 69295.7072  44.7%     - 1647s
     0     0 69293.3245    0  418 47893.8555 69293.3245  44.7%     - 1652s
     0     0 69291.8057    0  429 47893.8555 69291.8057  44.7%     - 1655s
     0     0 69281.2803    0  419 47893.8555 69281.2803  44.7%     - 1671s
     0     0 69278.9374    0  429 47893.8555 69278.9374  44.7%     - 1676s
     0     0 69278.3244    0  419 47893.8555 69278.3244  44.6%     - 1678s
     0     0 69256.8081    0  424 47893.8555 69256.8081  44.6%     - 1691s
     0     0 69252.8145    0  423 47893.8555 69252.8145  44.6%     - 1696s
     0     0 69251.4257    0  422 47893.8555 69251.4257  44.6%     - 1698s
     0     0 69231.1513    0  429 47893.8555 69231.1513  44.6%     - 1715s
     0     0 69225.1336    0  436 47893.8555 69225.1336  44.5%     - 1725s
     0     0 69223.7916    0  437 47893.8555 69223.7916  44.5%     - 1728s
     0     0 69219.9110    0  436 47893.8555 69219.9110  44.5%     - 1738s
     0     0 69219.0423    0  438 47893.8555 69219.0423  44.5%     - 1742s
     0     0 69217.0483    0  436 47893.8555 69217.0483  44.5%     - 1751s
H    0     0                    47903.035915 69216.6346  44.5%     - 1752s
     0     0 69216.1726    0  443 47903.0359 69216.1726  44.5%     - 1758s
     0     0 69214.9634    0  441 47903.0359 69214.9634  44.5%     - 1763s
     0     0 69214.2100    0  441 47903.0359 69214.2100  44.5%     - 1769s
H    0     0                    48062.833973 69214.2100  44.0%     - 1946s
H    0     2                    50432.643185 69214.2100  37.2%     - 2171s
     0     2 69214.2100    0  441 50432.6432 69214.2100  37.2%     - 2171s
     1     4 69015.5260    1  372 50432.6432 69212.3922  37.2% 12910 2216s
     3     7 68958.0721    2  375 50432.6432 69015.3788  36.8% 12190 2282s
     6    14 68669.8723    3  403 50432.6432 68997.8513  36.8% 15694 2362s
    13    28 68429.0957    4  420 50432.6432 68669.6319  36.2% 19021 2450s
    27    42 67544.9420    5  423 50432.6432 68428.3927  35.7% 27571 2612s
    41    74 66861.7602    6  396 50432.6432 68428.3927  35.7% 23450 2889s
H   52    74                    51072.116478 68428.3927  34.0% 20933 2889s
    73   176 66781.1213    7  396 51072.1165 68189.2576  33.5% 21088 3086s
   175   289 66688.9009   10  386 51072.1165 68189.1257  33.5% 12970 3178s
H  235   289                    51092.574425 68189.1257  33.5% 10756 3178s
   288   371 66589.6672   15  371 51092.5744 68189.1257  33.5%  9963 3245s
   370   428 66532.6986   20  368 51092.5744 68189.1257  33.5%  8832 3304s
   427   497 66286.3834   22  345 51092.5744 68189.1257  33.5%  8495 3361s
   496   525 66018.2753   25  345 51092.5744 68189.1257  33.5%  8115 3429s
   524   554 66011.9046   26  337 51092.5744 68189.1257  33.5%  8095 3530s
   553   585 65748.0124   27  330 51092.5744 68189.1257  33.5%  8182 3600s

Cutting planes:
  Learned: 2
  Gomory: 8
  Implied bound: 3
  MIR: 1634
  Flow cover: 3128
  RLT: 39
  Relax-and-lift: 273

Explored 584 nodes (5484957 simplex iterations) in 3600.10 seconds (4907.15 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 51092.6 51072.1 50432.6 ... 47049.6

Time limit reached
Best objective 5.109257442470e+04, best bound 6.818912568664e+04, gap 33.4619%
  WARNING: Time limit reached. Using best solution found (gap: 33.46%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 51092.57, θ = 201325.39
  Upper Bound (UB) = 51092.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 201325.39
  [DEBUG]   ✓ Scenario 0: θ = 201325.39 ≤ Q = 201325.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 201325.39 ≤ Q = 201325.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 201325.39 ≤ Q = 201325.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 201325.39 ≤ Q = 201325.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 201325.39 ≤ Q = 201325.39 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x55b0f075
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaa4f0f8b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.510029e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7302320.4274
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.686322e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -168632.19    0  123 7302320.43 -168632.19   102%     -    0s
H    0     0                    -133645.1478 -168632.19  26.2%     -    0s
H    0     0                    -133908.4003 -168632.19  25.9%     -    0s
     0     0 -143557.40    0  132 -133908.40 -143557.40  7.21%     -    0s
H    0     0                    -138017.3821 -143422.21  3.92%     -    0s
     0     0 -141760.97    0  115 -138017.38 -141760.97  2.71%     -    0s
H    0     0                    -140245.1060 -141755.38  1.08%     -    0s
     0     0 -141645.73    0   80 -140245.11 -141645.73  1.00%     -    0s
     0     0 -141645.73    0   83 -140245.11 -141645.73  1.00%     -    0s
     0     0 -141402.61    0   94 -140245.11 -141402.61  0.83%     -    0s
     0     0 -141363.23    0   87 -140245.11 -141363.23  0.80%     -    0s
     0     0 -141361.26    0   86 -140245.11 -141361.26  0.80%     -    0s
     0     0 -141231.84    0   58 -140245.11 -141231.84  0.70%     -    0s
H    0     0                    -140715.8438 -141226.69  0.36%     -    0s
     0     0 -141226.69    0   57 -140715.84 -141226.69  0.36%     -    0s
     0     0 -141197.57    0   51 -140715.84 -141197.57  0.34%     -    0s
     0     0 -141174.24    0   49 -140715.84 -141174.24  0.33%     -    0s
     0     0 -141174.24    0   49 -140715.84 -141174.24  0.33%     -    0s
     0     2 -141174.24    0   49 -140715.84 -141174.24  0.33%     -    0s

Cutting planes:
  Gomory: 52
  Implied bound: 1
  MIR: 187
  Flow cover: 10
  RLT: 1
  BQP: 1

Explored 147 nodes (1789 simplex iterations) in 0.23 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -140716 -140245 -138017 ... 1.51003e+13
No other solutions better than -140716

Optimal solution found (tolerance 1.00e-06)
Best objective -1.407158437521e+05, best bound -1.407158437521e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 198383.94
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140715.84
  [DEBUG]   S×d_nominal = 339099.79
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 339099.79 + -140715.84 = 198383.94
  [DEBUG]   Current θ from Master = 201325.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2941.44 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 48151.13
  Lower Bound (LB) = 48151.13
  Gap (UB-LB) = 2941.4448, Absolute Gap = 2941.4448, Relative Gap = 0.057571
  Not converged yet (gap = 2941.44 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0xc5fe65e2
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120558 rows and 48974 columns (presolve time = 5s)...
Presolve removed 120558 rows and 48974 columns
Presolve time: 6.26s
Presolved: 140755 rows, 59366 columns, 867898 nonzeros
Variable types: 57107 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.56s

Barrier statistics:
 Dense cols : 656
 AA' NZ     : 6.876e+06
 Factor NZ  : 1.554e+07 (roughly 200 MB of memory)
 Factor Ops : 3.730e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.28553420e+07  2.71872715e+08  1.67e+05 1.52e+01  1.05e+05     9s
   1  -1.76539284e+07  2.56380867e+08  1.17e+05 9.68e+01  7.34e+04     9s
   2  -7.00990855e+06  2.08867171e+08  4.49e+04 4.41e+01  2.94e+04     9s
   3  -1.84675902e+06  1.54092228e+08  8.08e+03 1.84e+00  5.72e+03     9s
   4  -7.84107504e+05  9.18395577e+07  1.05e+03 4.05e-01  9.82e+02    10s
   5  -6.67050930e+05  5.05689738e+07  4.81e+02 1.88e-01  4.55e+02    10s
   6  -5.87702653e+05  3.36004196e+07  2.91e+02 1.09e-01  2.75e+02    10s
   7  -3.90326837e+05  2.55388884e+07  7.89e+01 7.68e-02  1.37e+02    10s
   8  -2.33193676e+05  1.46395202e+07  2.08e+01 3.93e-02  6.52e+01    10s
   9  -1.60108111e+05  1.00972455e+07  9.71e+00 2.62e-02  4.25e+01    10s
  10  -1.32909259e+05  4.95560292e+06  6.30e+00 1.22e-02  2.07e+01    10s
  11  -9.00448793e+04  3.32205156e+06  2.35e+00 8.00e-03  1.35e+01    10s
  12  -6.53785613e+04  1.13535439e+06  1.24e+00 2.43e-03  4.72e+00    11s
  13  -3.32969837e+04  4.37895934e+05  5.99e-01 7.81e-04  1.85e+00    11s
  14  -1.77439673e+03  2.77914109e+05  3.06e-01 1.03e-03  1.09e+00    11s
  15   8.97776380e+03  2.30819498e+05  2.51e-01 8.63e-04  8.67e-01    11s
  16   1.65567768e+04  1.72755138e+05  2.23e-01 1.52e-03  6.11e-01    11s
  17   2.16707227e+04  1.57258601e+05  2.03e-01 1.21e-03  5.30e-01    11s
  18   3.10759797e+04  1.39605097e+05  1.69e-01 1.21e-03  4.24e-01    11s
  19   4.11257279e+04  1.16234483e+05  1.35e-01 1.84e-03  2.94e-01    12s
  20   4.61593982e+04  1.10286763e+05  1.17e-01 2.64e-03  2.51e-01    12s
  21   4.98886592e+04  1.07519067e+05  1.03e-01 2.93e-03  2.25e-01    12s
  22   5.42302474e+04  1.00528606e+05  8.82e-02 2.73e-03  1.81e-01    12s
  23   5.50761303e+04  9.91075625e+04  8.53e-02 2.37e-03  1.72e-01    12s
  24   5.86454211e+04  9.76433724e+04  7.34e-02 2.18e-03  1.53e-01    12s
  25   5.99880658e+04  9.37098696e+04  6.88e-02 1.66e-03  1.32e-01    12s
  26   6.50221544e+04  9.07926853e+04  5.28e-02 1.32e-03  1.01e-01    12s
  27   6.76416787e+04  8.97658110e+04  4.45e-02 1.23e-03  8.66e-02    13s
  28   6.94919657e+04  8.73630574e+04  3.91e-02 1.87e-03  7.00e-02    13s
  29   7.16023380e+04  8.63270695e+04  3.26e-02 1.13e-03  5.77e-02    13s
  30   7.42262218e+04  8.53793909e+04  2.46e-02 7.82e-04  4.37e-02    13s
  31   7.50894684e+04  8.45774591e+04  2.21e-02 7.86e-04  3.72e-02    13s
  32   7.55634093e+04  8.43167790e+04  2.07e-02 6.82e-04  3.43e-02    13s
  33   7.69257013e+04  8.40517015e+04  1.68e-02 6.13e-04  2.79e-02    14s
  34   7.77737894e+04  8.37960269e+04  1.43e-02 5.28e-04  2.36e-02    14s
  35   7.89135004e+04  8.36254119e+04  1.09e-02 4.32e-04  1.85e-02    14s
  36   8.04692668e+04  8.32640822e+04  6.26e-03 2.48e-04  1.09e-02    14s
  37   8.09759167e+04  8.30203676e+04  4.80e-03 2.12e-04  8.01e-03    14s
  38   8.14815214e+04  8.29352615e+04  3.36e-03 1.50e-04  5.69e-03    15s
  39   8.19543654e+04  8.28793841e+04  2.01e-03 1.12e-04  3.62e-03    15s
  40   8.22422082e+04  8.28273513e+04  1.22e-03 8.00e-05  2.29e-03    15s
  41   8.23542903e+04  8.28052279e+04  9.12e-04 6.44e-05  1.77e-03    15s
  42   8.25116414e+04  8.27693962e+04  4.92e-04 3.97e-05  1.01e-03    15s
  43   8.26016630e+04  8.27316724e+04  2.59e-04 1.46e-05  5.09e-04    15s
  44   8.26488474e+04  8.27161870e+04  1.39e-04 4.91e-06  2.64e-04    16s
  45   8.26971583e+04  8.27133444e+04  2.33e-05 3.30e-06  6.33e-05    16s
  46   8.27033760e+04  8.27112801e+04  8.91e-06 2.12e-06  3.09e-05    16s
  47   8.27043074e+04  8.27082838e+04  6.89e-06 6.20e-07  1.56e-05    16s
  48   8.27043823e+04  8.27077135e+04  6.73e-06 3.07e-07  1.30e-05    16s
  49   8.27057743e+04  8.27076626e+04  3.73e-06 2.32e-07  7.39e-06    16s
  50   8.27074534e+04  8.27075308e+04  4.56e-08 3.04e-07  3.03e-07    17s
  51   8.27075094e+04  8.27075095e+04  2.28e-09 2.07e-08  3.13e-10    17s

Barrier solved model in 51 iterations and 16.98 seconds (13.94 work units)
Optimal objective 8.27075094e+04


Root crossover log...

  125265 DPushes remaining with DInf 0.0000000e+00                17s
   49586 DPushes remaining with DInf 0.0000000e+00                20s
   14661 DPushes remaining with DInf 0.0000000e+00                25s
    3786 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                34s

    2585 PPushes remaining with PInf 1.7840923e-05                34s
       0 PPushes remaining with PInf 0.0000000e+00                35s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.5513917e+00     35s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   67707    8.2707509e+04   0.000000e+00   5.551392e+00     35s
   67714    8.2707509e+04   0.000000e+00   0.000000e+00     35s
   67714    8.2707509e+04   0.000000e+00   0.000000e+00     35s
Concurrent spin time: 11.07s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.270751e+04, 67714 iterations, 39.21 seconds (45.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82707.5095    0  187 -227427.98 82707.5095   136%     -   47s
H    0     0                    -153854.3887 82707.5095   154%     -   48s
H    0     0                    -152528.1032 82707.5095   154%     -   49s
H    0     0                    -140053.4933 82707.5095   159%     -   49s
H    0     0                    -49446.76387 82707.5095   267%     -   49s
H    0     0                    -47305.25779 82707.5095   275%     -   49s
H    0     0                    -47120.07495 82707.5095   276%     -   50s
H    0     0                    23448.116573 82707.5095   253%     -   50s
H    0     0                    24672.131650 82707.5095   235%     -   51s
H    0     0                    25795.266798 82707.5095   221%     -   52s
H    0     0                    27963.139718 82707.5095   196%     -   52s
     0     0 77424.7004    0  225 27963.1397 77424.7004   177%     -  188s
H    0     0                    28139.204962 77424.3886   175%     -  189s
     0     0 76822.9608    0  253 28139.2050 76822.9608   173%     -  263s
     0     0 76806.2858    0  260 28139.2050 76806.2858   173%     -  278s
     0     0 76774.1610    0  256 28139.2050 76774.1610   173%     -  295s
     0     0 76764.9506    0  255 28139.2050 76764.9506   173%     -  298s
     0     0 76716.0401    0  264 28139.2050 76716.0401   173%     -  321s
     0     0 76712.8275    0  258 28139.2050 76712.8275   173%     -  324s
     0     0 76651.8516    0  256 28139.2050 76651.8516   172%     -  340s
     0     0 76650.5072    0  253 28139.2050 76650.5072   172%     -  343s
     0     0 76585.4386    0  256 28139.2050 76585.4386   172%     -  368s
     0     0 76574.7939    0  254 28139.2050 76574.7939   172%     -  374s
     0     0 76573.8251    0  252 28139.2050 76573.8251   172%     -  381s
     0     0 76573.8181    0  254 28139.2050 76573.8181   172%     -  382s
     0     0 73701.8895    0  250 28139.2050 73701.8895   162%     -  506s
H    0     0                    39961.364855 73701.8630  84.4%     -  507s
H    0     0                    41402.365731 73701.8630  78.0%     -  508s
H    0     0                    41722.210405 73701.8630  76.6%     -  508s
H    0     0                    42098.589354 73701.8630  75.1%     -  508s
     0     0 73307.3064    0  259 42098.5894 73307.3064  74.1%     -  566s
     0     0 73122.0377    0  265 42098.5894 73122.0377  73.7%     -  631s
     0     0 73014.3144    0  262 42098.5894 73014.3144  73.4%     -  667s
     0     0 72971.7075    0  266 42098.5894 72971.7075  73.3%     -  689s
     0     0 72948.7734    0  272 42098.5894 72948.7734  73.3%     -  705s
     0     0 72939.6458    0  277 42098.5894 72939.6458  73.3%     -  713s
     0     0 72934.0383    0  277 42098.5894 72934.0383  73.2%     -  718s
     0     0 72912.4221    0  280 42098.5894 72912.4221  73.2%     -  730s
     0     0 72910.1101    0  281 42098.5894 72910.1101  73.2%     -  734s
     0     0 72843.9490    0  266 42098.5894 72843.9490  73.0%     -  763s
     0     0 72834.4795    0  274 42098.5894 72834.4795  73.0%     -  772s
     0     0 72826.5531    0  268 42098.5894 72826.5531  73.0%     -  784s
     0     0 72820.2012    0  274 42098.5894 72820.2012  73.0%     -  805s
     0     0 72819.4087    0  274 42098.5894 72819.4087  73.0%     -  810s
     0     0 71691.6013    0  341 42098.5894 71691.6013  70.3%     -  943s
H    0     0                    42116.994807 71691.5119  70.2%     -  945s
H    0     0                    42122.742120 71691.5119  70.2%     -  945s
H    0     0                    42164.163326 71691.5119  70.0%     -  945s
H    0     0                    42222.936443 71691.5119  69.8%     -  945s
     0     0 71469.1826    0  365 42222.9364 71469.1826  69.3%     - 1001s
     0     0 71395.3639    0  363 42222.9364 71395.3639  69.1%     - 1040s
     0     0 71358.9285    0  364 42222.9364 71358.9285  69.0%     - 1070s
     0     0 71347.9819    0  363 42222.9364 71347.9819  69.0%     - 1088s
     0     0 71338.0545    0  369 42222.9364 71338.0545  69.0%     - 1103s
     0     0 71334.5185    0  372 42222.9364 71334.5185  68.9%     - 1116s
     0     0 71330.5628    0  369 42222.9364 71330.5628  68.9%     - 1120s
     0     0 71327.9095    0  373 42222.9364 71327.9095  68.9%     - 1125s
     0     0 71326.6034    0  373 42222.9364 71326.6034  68.9%     - 1129s
     0     0 71322.7494    0  368 42222.9364 71322.7494  68.9%     - 1135s
     0     0 71316.8167    0  366 42222.9364 71316.8167  68.9%     - 1144s
     0     0 71312.0395    0  368 42222.9364 71312.0395  68.9%     - 1155s
     0     0 71310.0554    0  365 42222.9364 71310.0554  68.9%     - 1159s
     0     0 71309.5790    0  371 42222.9364 71309.5790  68.9%     - 1161s
     0     0 70729.1578    0  346 42222.9364 70729.1578  67.5%     - 1260s
H    0     0                    42714.120046 70729.1104  65.6%     - 1261s
H    0     0                    43401.039463 70729.1104  63.0%     - 1262s
H    0     0                    43610.811336 70729.1104  62.2%     - 1262s
H    0     0                    44080.364532 70729.1104  60.5%     - 1262s
H    0     0                    44117.895021 70729.1104  60.3%     - 1262s
H    0     0                    44212.965894 70729.1104  60.0%     - 1262s
H    0     0                    44222.204253 70729.1104  59.9%     - 1262s
     0     0 70341.0984    0  349 44222.2043 70341.0984  59.1%     - 1324s
     0     0 70242.5224    0  353 44222.2043 70242.5224  58.8%     - 1359s
     0     0 70202.2026    0  360 44222.2043 70202.2026  58.7%     - 1381s
     0     0 70187.8830    0  354 44222.2043 70187.8830  58.7%     - 1393s
     0     0 70175.3909    0  358 44222.2043 70175.3909  58.7%     - 1403s
     0     0 70172.1299    0  362 44222.2043 70172.1299  58.7%     - 1407s
     0     0 70148.8610    0  362 44222.2043 70148.8610  58.6%     - 1420s
     0     0 70131.2253    0  365 44222.2043 70131.2253  58.6%     - 1435s
     0     0 70123.9695    0  398 44222.2043 70123.9695  58.6%     - 1446s
     0     0 70114.1343    0  368 44222.2043 70114.1343  58.5%     - 1455s
     0     0 70109.4463    0  370 44222.2043 70109.4463  58.5%     - 1465s
     0     0 70106.9933    0  371 44222.2043 70106.9933  58.5%     - 1472s
     0     0 70105.8384    0  371 44222.2043 70105.8384  58.5%     - 1477s
     0     0 69978.5857    0  407 44222.2043 69978.5857  58.2%     - 1513s
H    0     0                    44275.050480 69978.2471  58.1%     - 1514s
     0     0 69944.6756    0  401 44275.0505 69944.6756  58.0%     - 1539s
     0     0 69931.6791    0  401 44275.0505 69931.6791  57.9%     - 1553s
     0     0 69927.5491    0  400 44275.0505 69927.5491  57.9%     - 1560s
     0     0 69923.8307    0  394 44275.0505 69923.8307  57.9%     - 1570s
     0     0 69914.5221    0  396 44275.0505 69914.5221  57.9%     - 1578s
     0     0 69910.9924    0  400 44275.0505 69910.9924  57.9%     - 1583s
     0     0 69908.3417    0  408 44275.0505 69908.3417  57.9%     - 1587s
     0     0 69907.5794    0  402 44275.0505 69907.5794  57.9%     - 1590s
     0     0 69813.0040    0  363 44275.0505 69813.0040  57.7%     - 1627s
H    0     0                    44389.008103 69812.3198  57.3%     - 1631s
H    0     0                    44392.599637 69812.3198  57.3%     - 1631s
H    0     0                    44402.969792 69812.3198  57.2%     - 1631s
     0     0 69783.6829    0  409 44402.9698 69783.6829  57.2%     - 1654s
     0     0 69776.8697    0  375 44402.9698 69776.8697  57.1%     - 1660s
     0     0 69772.3311    0  376 44402.9698 69772.3311  57.1%     - 1671s
     0     0 69770.3278    0  409 44402.9698 69770.3278  57.1%     - 1679s
     0     0 69770.0260    0  374 44402.9698 69770.0260  57.1%     - 1681s
     0     0 69730.2999    0  425 44402.9698 69730.2999  57.0%     - 1712s
     0     0 69718.6045    0  425 44402.9698 69718.6045  57.0%     - 1733s
     0     0 69707.2539    0  432 44402.9698 69707.2539  57.0%     - 1745s
     0     0 69701.8304    0  429 44402.9698 69701.8304  57.0%     - 1751s
     0     0 69698.1602    0  390 44402.9698 69698.1602  57.0%     - 1757s
     0     0 69696.1598    0  391 44402.9698 69696.1598  57.0%     - 1761s
     0     0 69695.6563    0  431 44402.9698 69695.6563  57.0%     - 1764s
     0     0 69680.3167    0  422 44402.9698 69680.3167  56.9%     - 1787s
H    0     0                    44516.720087 69679.8161  56.5%     - 1789s
H    0     0                    45078.809962 69679.8161  54.6%     - 1789s
H    0     0                    45417.089163 69679.8161  53.4%     - 1789s
H    0     0                    45477.991650 69679.8161  53.2%     - 1789s
H    0     0                    45594.647799 69679.8161  52.8%     - 1789s
     0     0 69673.0216    0  435 45594.6478 69673.0216  52.8%     - 1803s
     0     0 69662.9236    0  389 45594.6478 69662.9236  52.8%     - 1818s
     0     0 69659.6691    0  436 45594.6478 69659.6691  52.8%     - 1827s
     0     0 69658.2006    0  441 45594.6478 69658.2006  52.8%     - 1831s
     0     0 69633.1825    0  441 45594.6478 69633.1825  52.7%     - 1863s
     0     0 69619.5109    0  441 45594.6478 69619.5109  52.7%     - 1884s
     0     0 69609.0020    0  437 45594.6478 69609.0020  52.7%     - 1908s
     0     0 69605.2292    0  440 45594.6478 69605.2292  52.7%     - 1917s
     0     0 69602.7530    0  431 45594.6478 69602.7530  52.7%     - 1927s
     0     0 69601.7130    0  436 45594.6478 69601.7130  52.7%     - 1932s
     0     0 69582.7908    0  435 45594.6478 69582.7908  52.6%     - 1955s
H    0     0                    45838.718392 69582.7156  51.8%     - 1957s
H    0     0                    45862.739325 69582.7156  51.7%     - 1957s
     0     0 69577.9970    0  436 45862.7393 69577.9970  51.7%     - 1969s
     0     0 69576.6212    0  438 45862.7393 69576.6212  51.7%     - 1974s
     0     0 69559.6583    0  436 45862.7393 69559.6583  51.7%     - 1993s
     0     0 69555.4125    0  433 45862.7393 69555.4125  51.7%     - 2008s
     0     0 69553.6872    0  433 45862.7393 69553.6872  51.7%     - 2011s
     0     0 69547.6238    0  435 45862.7393 69547.6238  51.6%     - 2020s
     0     0 69545.1001    0  436 45862.7393 69545.1001  51.6%     - 2027s
     0     0 69541.3374    0  438 45862.7393 69541.3374  51.6%     - 2046s
     0     0 69537.0702    0  444 45862.7393 69537.0702  51.6%     - 2058s
     0     0 69535.1540    0  436 45862.7393 69535.1540  51.6%     - 2064s
     0     0 69532.7237    0  433 45862.7393 69532.7237  51.6%     - 2070s
     0     0 69532.1702    0  439 45862.7393 69532.1702  51.6%     - 2079s
     0     0 69524.6016    0  401 45862.7393 69524.6016  51.6%     - 2098s
H    0     0                    46234.471140 69524.4794  50.4%     - 2112s
H    0     0                    46578.297404 69524.4794  49.3%     - 2112s
     0     0 69523.3014    0  444 46578.2974 69523.3014  49.3%     - 2120s
     0     0 69515.1171    0  436 46578.2974 69515.1171  49.2%     - 2139s
H    0     0                    46674.267296 69515.0152  48.9%     - 2140s
H    0     0                    47419.449766 69515.0152  46.6%     - 2140s
H    0     0                    47571.534274 69515.0152  46.1%     - 2140s
H    0     0                    47667.092469 69515.0152  45.8%     - 2140s
H    0     0                    47776.927776 69515.0152  45.5%     - 2140s
     0     0 69511.4833    0  439 47776.9278 69511.4833  45.5%     - 2151s
     0     0 69509.9312    0  438 47776.9278 69509.9312  45.5%     - 2158s
     0     0 69494.5591    0  396 47776.9278 69494.5591  45.5%     - 2177s
H    0     0                    48611.347406 69494.0811  43.0%     - 2188s
H    0     0                    48947.772822 69494.0811  42.0%     - 2188s
H    0     0                    49199.920131 69494.0811  41.2%     - 2189s
H    0     0                    49807.140782 69494.0811  39.5%     - 2190s
     0     0 69488.4967    0  440 49807.1408 69488.4967  39.5%     - 2207s
     0     0 69487.2437    0  441 49807.1408 69487.2437  39.5%     - 2212s
     0     0 69451.7628    0  448 49807.1408 69451.7628  39.4%     - 2241s
     0     0 69437.2687    0  451 49807.1408 69437.2687  39.4%     - 2260s
     0     0 69429.3227    0  448 49807.1408 69429.3227  39.4%     - 2275s
     0     0 69422.6566    0  446 49807.1408 69422.6566  39.4%     - 2283s
     0     0 69420.9496    0  446 49807.1408 69420.9496  39.4%     - 2289s
     0     0 69419.8613    0  450 49807.1408 69419.8613  39.4%     - 2293s
     0     0 69404.1478    0  446 49807.1408 69404.1478  39.3%     - 2310s
H    0     0                    49872.337808 69404.1356  39.2%     - 2319s
H    0     0                    49980.038734 69404.1356  38.9%     - 2319s
H    0     0                    50029.652475 69404.1356  38.7%     - 2320s
     0     0 69399.5068    0  440 50029.6525 69399.5068  38.7%     - 2328s
     0     0 69396.7920    0  444 50029.6525 69396.7920  38.7%     - 2337s
     0     0 69394.8375    0  442 50029.6525 69394.8375  38.7%     - 2342s
     0     0 69394.3596    0  445 50029.6525 69394.3596  38.7%     - 2345s
     0     0 69386.4512    0  398 50029.6525 69386.4512  38.7%     - 2354s
H    0     0                    50484.207077 69386.3257  37.4%     - 2356s
H    0     0                    50511.671030 69386.3257  37.4%     - 2356s
     0     0 69379.5317    0  406 50511.6710 69379.5317  37.4%     - 2366s
     0     0 69376.0501    0  408 50511.6710 69376.0501  37.3%     - 2376s
     0     0 69374.7135    0  409 50511.6710 69374.7135  37.3%     - 2381s
     0     0 69372.5625    0  405 50511.6710 69372.5625  37.3%     - 2393s
H    0     0                    50552.546466 69371.5597  37.2%     - 2443s
H    0     0                    50588.499898 69371.5597  37.1%     - 2443s
H    0     0                    50659.537579 69371.5597  36.9%     - 2448s
     0     0 69371.5597    0  408 50659.5376 69371.5597  36.9%     - 2453s
     0     0 69369.3996    0  444 50659.5376 69369.3996  36.9%     - 2466s
     0     0 69361.9858    0  405 50659.5376 69361.9858  36.9%     - 2471s
     0     0 69361.9858    0  438 50659.5376 69361.9858  36.9%     - 2480s
     0     0 69361.9858    0  438 50659.5376 69361.9858  36.9%     - 2487s
H    0     0                    50967.849135 69361.9858  36.1%     - 2779s
     0     2 69361.9858    0  438 50967.8491 69361.9858  36.1%     - 2927s
     1     3 69250.8451    1  384 50967.8491 69361.9858  36.1% 11813 2965s
     2     4 69173.1274    1  425 50967.8491 69250.7307  35.9% 11007 2993s
     3     5 68912.0849    2  388 50967.8491 69250.7307  35.9% 11972 3034s
     4     7 68927.5239    2  394 50967.8491 69250.7307  35.9% 11561 3100s
     6    11 68613.3717    3  374 50967.8491 69250.7307  35.9% 14330 3168s
    10    20 68581.2776    4  377 50967.8491 68930.5899  35.2% 14686 3241s
    19    29 67023.9747    4  353 50967.8491 68930.5354  35.2% 19543 3419s
H   28    47                    51385.224481 68720.4010  33.7% 17154 3600s
H   31    47                    51401.612815 68720.4010  33.7% 17830 3600s
H   36    47                    51571.560658 68720.4010  33.3% 17148 3600s
H   39    47                    51605.235835 68720.4010  33.2% 16317 3600s

Cutting planes:
  Learned: 5
  Gomory: 5
  Implied bound: 5
  MIR: 1417
  Flow cover: 3147
  RLT: 37
  Relax-and-lift: 250

Explored 46 nodes (1554236 simplex iterations) in 3600.14 seconds (4333.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 51605.2 51571.6 51401.6 ... 50484.2

Time limit reached
Best objective 5.160523583550e+04, best bound 6.872040102333e+04, gap 33.1656%
  WARNING: Time limit reached. Using best solution found (gap: 33.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = 51605.24, θ = 202745.63
  Upper Bound (UB) = 51605.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 202745.63
  [DEBUG]   ✓ Scenario 0: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 202745.63 ≤ Q = 202745.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 202745.63 ≤ Q = 202745.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2f56bb1f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2f56bb1f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.511856e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7324379.7733
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.690074e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -169007.37    0  123 7324379.77 -169007.37   102%     -    0s
H    0     0                    -134041.3904 -169007.37  26.1%     -    0s
H    0     0                    -134304.6430 -169007.37  25.8%     -    0s
H    0     0                    -134474.2959 -146403.95  8.87%     -    0s
H    0     0                    -135846.7094 -146403.95  7.77%     -    0s
     0     0 -146403.95    0  131 -135846.71 -146403.95  7.77%     -    0s
H    0     0                    -140749.7708 -146272.08  3.92%     -    0s
     0     0 -144135.48    0  135 -140749.77 -144135.48  2.41%     -    0s
H    0     0                    -142433.6049 -144044.61  1.13%     -    0s
     0     0 -143331.94    0  107 -142433.60 -143331.94  0.63%     -    0s
     0     0 -143267.03    0   98 -142433.60 -143267.03  0.59%     -    0s
     0     0 -143265.19    0  108 -142433.60 -143265.19  0.58%     -    0s
     0     0 -142975.90    0  105 -142433.60 -142975.90  0.38%     -    0s
H    0     0                    -142742.4187 -142975.75  0.16%     -    0s
     0     0 -142973.62    0  102 -142742.42 -142973.62  0.16%     -    0s
     0     0 -142973.58    0   89 -142742.42 -142973.58  0.16%     -    0s
     0     0 -142945.46    0   25 -142742.42 -142945.46  0.14%     -    0s
     0     0 -142931.98    0   59 -142742.42 -142931.98  0.13%     -    0s
     0     0 -142929.67    0   18 -142742.42 -142929.67  0.13%     -    0s
     0     0 -142928.02    0   16 -142742.42 -142928.02  0.13%     -    0s
     0     0 -142924.80    0   16 -142742.42 -142924.80  0.13%     -    0s
     0     0 -142924.80    0   58 -142742.42 -142924.80  0.13%     -    0s
     0     0 -142924.80    0   58 -142742.42 -142924.80  0.13%     -    0s
     0     0 -142924.80    0   45 -142742.42 -142924.80  0.13%     -    0s
     0     0 -142811.65    0   14 -142742.42 -142811.65  0.05%     -    0s
     0     0 -142811.62    0   12 -142742.42 -142811.62  0.05%     -    0s
     0     0 -142780.49    0   42 -142742.42 -142780.49  0.03%     -    0s
     0     0 -142777.02    0   42 -142742.42 -142777.02  0.02%     -    0s
     0     0 -142748.07    0   12 -142742.42 -142748.07  0.00%     -    0s
     0     0     cutoff    0      -142742.42 -142742.42  0.00%     -    0s

Cutting planes:
  Gomory: 20
  Implied bound: 2
  MIR: 60
  Flow cover: 13
  RLT: 9

Explored 1 nodes (1145 simplex iterations) in 0.24 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -142742 -142434 -141213 ... 1.51186e+13
No other solutions better than -142742

Optimal solution found (tolerance 1.00e-06)
Best objective -1.427424186797e+05, best bound -1.427424186797e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 198517.01
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142742.42
  [DEBUG]   S×d_nominal = 341259.43
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 341259.43 + -142742.42 = 198517.01
  [DEBUG]   Current θ from Master = 202745.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4228.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 47376.62
  Lower Bound (LB) = 48151.13
  Gap (UB-LB) = 3454.1062, Absolute Gap = 3454.1062, Relative Gap = 0.066933
  Not converged yet (gap = 3454.11 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0xcf007fd6
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127628 rows and 51844 columns (presolve time = 5s)...
Presolve removed 127628 rows and 51844 columns
Presolve time: 5.48s
Presolved: 148975 rows, 62736 columns, 919022 nonzeros
Variable types: 60477 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227427.9843

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.60s

Barrier statistics:
 Dense cols : 655
 AA' NZ     : 7.660e+06
 Factor NZ  : 1.727e+07 (roughly 230 MB of memory)
 Factor Ops : 4.327e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.39406965e+07  2.85987083e+08  1.74e+05 1.47e+01  1.10e+05     8s
   1  -1.85352456e+07  2.71861047e+08  1.23e+05 9.88e+01  7.66e+04     8s
   2  -7.82511132e+06  2.23776995e+08  4.92e+04 1.86e+01  3.21e+04     9s
   3  -2.07301861e+06  1.62161114e+08  9.50e+03 2.86e+00  6.65e+03     9s
   4  -8.00290248e+05  9.15200494e+07  1.11e+03 5.35e-01  1.00e+03     9s
   5  -6.81132422e+05  5.33877158e+07  5.16e+02 2.48e-01  4.81e+02     9s
   6  -5.54217257e+05  3.79354582e+07  1.65e+02 1.61e-01  2.25e+02     9s
   7  -3.96787143e+05  2.64523224e+07  4.12e+01 1.05e-01  1.17e+02     9s
   8  -3.19300429e+05  1.72312232e+07  2.42e+01 6.46e-02  7.28e+01     9s
   9  -1.91392744e+05  9.77230445e+06  9.51e+00 3.39e-02  3.88e+01     9s
  10  -1.39342194e+05  5.99006876e+06  5.29e+00 1.99e-02  2.34e+01    10s
  11  -1.00111172e+05  4.04359823e+06  2.05e+00 1.33e-02  1.55e+01    10s
  12  -6.47081838e+04  1.80771349e+06  7.52e-01 5.65e-03  6.93e+00    10s
  13  -3.66115106e+04  8.45450806e+05  3.36e-01 2.59e-03  3.26e+00    10s
  14  -6.88024611e+03  3.40051975e+05  1.62e-01 8.67e-04  1.28e+00    10s
  15   8.61398121e+03  2.46048370e+05  1.17e-01 8.81e-04  8.75e-01    10s
  16   1.85917397e+04  1.80819210e+05  9.66e-02 1.70e-03  5.98e-01    10s
  17   2.78937623e+04  1.55944190e+05  8.16e-02 1.88e-03  4.72e-01    10s
  18   3.80957069e+04  1.38432367e+05  6.49e-02 1.98e-03  3.70e-01    10s
  19   4.62087228e+04  1.16673743e+05  5.19e-02 1.65e-03  2.60e-01    11s
  20   5.05339464e+04  1.10393531e+05  4.50e-02 1.63e-03  2.21e-01    11s
  21   5.30852633e+04  1.02985365e+05  4.10e-02 1.30e-03  1.84e-01    11s
  22   5.48744673e+04  1.00152767e+05  3.84e-02 1.12e-03  1.67e-01    11s
  23   6.06788245e+04  9.58606819e+04  2.99e-02 8.39e-04  1.30e-01    11s
  24   6.18008452e+04  9.26580195e+04  2.81e-02 6.57e-04  1.14e-01    11s
  25   6.56962704e+04  9.09990802e+04  2.29e-02 9.01e-04  9.33e-02    12s
  26   6.81704972e+04  8.96586755e+04  1.96e-02 7.52e-04  7.93e-02    12s
  27   7.03065785e+04  8.80245894e+04  1.68e-02 5.47e-04  6.54e-02    12s
  28   7.36052952e+04  8.67519418e+04  1.24e-02 3.70e-04  4.85e-02    12s
  29   7.42234497e+04  8.57965672e+04  1.16e-02 2.67e-04  4.27e-02    12s
  30   7.56682385e+04  8.51886211e+04  9.70e-03 2.02e-04  3.51e-02    12s
  31   7.79641597e+04  8.48846037e+04  6.78e-03 1.68e-04  2.55e-02    13s
  32   7.97043108e+04  8.45093547e+04  4.51e-03 1.29e-04  1.77e-02    13s
  33   8.02746536e+04  8.40112488e+04  3.77e-03 9.82e-05  1.38e-02    13s
  34   8.10495916e+04  8.38884855e+04  2.82e-03 8.52e-05  1.05e-02    13s
  35   8.14599424e+04  8.37864657e+04  2.29e-03 7.01e-05  8.58e-03    13s
  36   8.17881277e+04  8.36465638e+04  1.88e-03 5.99e-05  6.86e-03    13s
  37   8.22762596e+04  8.35549400e+04  1.26e-03 3.64e-05  4.72e-03    14s
  38   8.24233108e+04  8.34667268e+04  1.08e-03 2.71e-05  3.85e-03    14s
  39   8.25901483e+04  8.34511915e+04  8.65e-04 2.42e-05  3.18e-03    14s
  40   8.27461140e+04  8.34158159e+04  6.70e-04 1.81e-05  2.47e-03    14s
  41   8.28315898e+04  8.34095157e+04  5.66e-04 1.71e-05  2.13e-03    14s
  42   8.30459074e+04  8.33864802e+04  3.01e-04 2.11e-05  1.26e-03    14s
  43   8.31071632e+04  8.33607506e+04  2.28e-04 1.38e-05  9.35e-04    15s
  44   8.31692908e+04  8.33506378e+04  1.56e-04 1.09e-05  6.69e-04    15s
  45   8.32044344e+04  8.33421744e+04  1.15e-04 8.56e-06  5.08e-04    15s
  46   8.32289974e+04  8.33275122e+04  8.89e-05 4.60e-06  3.63e-04    15s
  47   8.32494712e+04  8.33191746e+04  6.61e-05 2.50e-06  2.57e-04    15s
  48   8.32994774e+04  8.33127739e+04  7.47e-06 6.38e-07  4.90e-05    16s
  49   8.33084927e+04  8.33100756e+04  3.80e-07 1.38e-07  5.83e-06    16s
  50   8.33089141e+04  8.33094908e+04  1.40e-07 5.10e-08  2.13e-06    16s
  51   8.33091033e+04  8.33094031e+04  2.65e-07 3.59e-08  1.10e-06    16s
  52   8.33091780e+04  8.33092843e+04  2.05e-08 1.62e-08  3.91e-07    16s
  53   8.33091820e+04  8.33091998e+04  1.23e-08 2.10e-09  6.57e-08    16s
  54   8.33091854e+04  8.33091863e+04  4.83e-09 4.67e-09  3.36e-09    17s
  55   8.33091855e+04  8.33091857e+04  1.16e-07 1.15e-09  5.69e-10    17s

Barrier solved model in 55 iterations and 16.85 seconds (16.85 work units)
Optimal objective 8.33091855e+04


Root crossover log...

  132713 DPushes remaining with DInf 0.0000000e+00                17s
   51543 DPushes remaining with DInf 0.0000000e+00                20s
   17609 DPushes remaining with DInf 0.0000000e+00                25s
    4077 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                33s

    5783 PPushes remaining with PInf 4.5153022e-05                33s
       0 PPushes remaining with PInf 0.0000000e+00                35s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7815197e+01     35s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   75597    8.3309186e+04   0.000000e+00   1.781520e+01     35s
   75653    8.3309186e+04   0.000000e+00   0.000000e+00     35s
   75653    8.3309186e+04   0.000000e+00   0.000000e+00     35s
Concurrent spin time: 13.53s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.330919e+04, 75653 iterations, 42.36 seconds (48.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83309.1857    0  183 -227427.98 83309.1857   137%     -   50s
H    0     0                    -222665.9304 83309.1857   137%     -   50s
H    0     0                    -210636.1480 83309.1857   140%     -   52s
H    0     0                    -207319.9486 83309.1857   140%     -   53s
H    0     0                    -206702.8670 83309.1857   140%     -   55s
H    0     0                    -206643.8614 83309.1857   140%     -   55s
H    0     0                    -203668.8465 83309.1857   141%     -   55s
H    0     0                    15980.277739 83309.1857   421%     -   56s
H    0     0                    16891.156520 83309.1857   393%     -   56s
     0     0 77131.0873    0  252 16891.1565 77131.0873   357%     -  270s
H    0     0                    17624.945427 77130.9496   338%     -  272s
H    0     0                    18288.185374 77130.9496   322%     -  272s
H    0     0                    19574.820308 77130.9496   294%     -  272s
H    0     0                    23005.144747 77130.9496   235%     -  272s
H    0     0                    23778.569491 77130.9496   224%     -  272s
H    0     0                    23783.696279 77130.9496   224%     -  272s
H    0     0                    23826.311930 77130.9496   224%     -  272s
     0     0 76594.1226    0  200 23826.3119 76594.1226   221%     -  385s
     0     0 76578.3908    0  202 23826.3119 76578.3908   221%     -  410s
     0     0 76555.3061    0  202 23826.3119 76555.3061   221%     -  430s
     0     0 76544.0344    0  210 23826.3119 76544.0344   221%     -  435s
     0     0 76543.7312    0  208 23826.3119 76543.7312   221%     -  439s
     0     0 74166.3523    0  226 23826.3119 74166.3523   211%     -  604s
H    0     0                    25141.333821 74166.2472   195%     -  605s
H    0     0                    30948.033883 74166.2472   140%     -  605s
H    0     0                    31005.665818 74166.2472   139%     -  606s
     0     0 73622.3663    0  228 31005.6658 73622.3663   137%     -  712s
     0     0 73460.0333    0  241 31005.6658 73460.0333   137%     -  754s
     0     0 73363.7570    0  253 31005.6658 73363.7570   137%     -  788s
     0     0 73297.2093    0  255 31005.6658 73297.2093   136%     -  824s
     0     0 73267.1778    0  259 31005.6658 73267.1778   136%     -  841s
     0     0 73257.7689    0  258 31005.6658 73257.7689   136%     -  851s
     0     0 73233.1581    0  255 31005.6658 73233.1581   136%     -  872s
     0     0 73204.0015    0  259 31005.6658 73204.0015   136%     -  886s
     0     0 73193.9506    0  267 31005.6658 73193.9506   136%     -  904s
     0     0 73193.1555    0  263 31005.6658 73193.1555   136%     -  906s
     0     0 71806.3129    0  337 31005.6658 71806.3129   132%     - 1062s
H    0     0                    31110.318219 71806.1748   131%     - 1063s
     0     0 71438.4821    0  355 31110.3182 71438.4821   130%     - 1153s
     0     0 71327.8288    0  361 31110.3182 71327.8288   129%     - 1190s
     0     0 71161.6432    0  362 31110.3182 71161.6432   129%     - 1235s
     0     0 71139.6996    0  377 31110.3182 71139.6996   129%     - 1255s
     0     0 71114.0957    0  365 31110.3182 71114.0957   129%     - 1271s
     0     0 71107.4643    0  372 31110.3182 71107.4643   129%     - 1279s
     0     0 71102.1116    0  371 31110.3182 71102.1116   129%     - 1291s
     0     0 71098.7407    0  373 31110.3182 71098.7407   129%     - 1296s
     0     0 71095.6111    0  372 31110.3182 71095.6111   129%     - 1301s
     0     0 71093.7924    0  373 31110.3182 71093.7924   129%     - 1305s
     0     0 71092.3167    0  378 31110.3182 71092.3167   129%     - 1311s
     0     0 71092.1804    0  378 31110.3182 71092.1804   129%     - 1312s
     0     0 70534.8515    0  352 31110.3182 70534.8515   127%     - 1400s
H    0     0                    40466.113239 70534.7128  74.3%     - 1404s
H    0     0                    41714.114423 70534.7128  69.1%     - 1408s
H    0     0                    42325.138029 70534.7128  66.6%     - 1409s
H    0     0                    44109.542982 70534.7128  59.9%     - 1412s
H    0     0                    44372.081645 70534.7128  59.0%     - 1414s
H    0     0                    44532.466698 70534.7128  58.4%     - 1414s
H    0     0                    44533.023823 70534.7128  58.4%     - 1414s
     0     0 70345.4052    0  348 44533.0238 70345.4052  58.0%     - 1464s
     0     0 70229.5828    0  349 44533.0238 70229.5828  57.7%     - 1500s
     0     0 70117.4720    0  352 44533.0238 70117.4720  57.5%     - 1537s
     0     0 70088.0321    0  348 44533.0238 70088.0321  57.4%     - 1563s
     0     0 70065.6918    0  360 44533.0238 70065.6918  57.3%     - 1581s
     0     0 70032.7915    0  350 44533.0238 70032.7915  57.3%     - 1600s
     0     0 70008.4476    0  348 44533.0238 70008.4476  57.2%     - 1612s
     0     0 69998.9393    0  351 44533.0238 69998.9393  57.2%     - 1622s
     0     0 69989.9637    0  358 44533.0238 69989.9637  57.2%     - 1630s
     0     0 69984.4080    0  358 44533.0238 69984.4080  57.2%     - 1637s
     0     0 69982.9389    0  352 44533.0238 69982.9389  57.1%     - 1641s
     0     0 69854.3392    0  403 44533.0238 69854.3392  56.9%     - 1676s
H    0     0                    44609.753841 69854.2233  56.6%     - 1677s
H    0     0                    44954.588011 69854.2233  55.4%     - 1677s
     0     0 69798.2689    0  407 44954.5880 69798.2689  55.3%     - 1702s
     0     0 69782.9621    0  370 44954.5880 69782.9621  55.2%     - 1716s
     0     0 69771.8865    0  373 44954.5880 69771.8865  55.2%     - 1728s
     0     0 69740.9860    0  410 44954.5880 69740.9860  55.1%     - 1755s
     0     0 69730.4996    0  417 44954.5880 69730.4996  55.1%     - 1768s
     0     0 69728.7268    0  414 44954.5880 69728.7268  55.1%     - 1773s
     0     0 69727.8045    0  416 44954.5880 69727.8045  55.1%     - 1776s
     0     0 69643.6471    0  419 44954.5880 69643.6471  54.9%     - 1817s
H    0     0                    44977.364046 69643.1326  54.8%     - 1836s
     0     0 69633.8577    0  421 44977.3640 69633.8577  54.8%     - 1862s
     0     0 69624.6380    0  416 44977.3640 69624.6380  54.8%     - 1871s
     0     0 69619.1311    0  377 44977.3640 69619.1311  54.8%     - 1881s
     0     0 69617.7016    0  378 44977.3640 69617.7016  54.8%     - 1883s
     0     0 69593.7152    0  380 44977.3640 69593.7152  54.7%     - 1904s
     0     0 69586.8107    0  371 44977.3640 69586.8107  54.7%     - 1915s
     0     0 69577.7771    0  374 44977.3640 69577.7771  54.7%     - 1923s
     0     0 69559.7277    0  411 44977.3640 69559.7277  54.7%     - 1944s
     0     0 69547.1044    0  416 44977.3640 69547.1044  54.6%     - 1954s
     0     0 69543.9734    0  422 44977.3640 69543.9734  54.6%     - 1961s
     0     0 69541.5578    0  426 44977.3640 69541.5578  54.6%     - 1969s
     0     0 69540.0559    0  423 44977.3640 69540.0559  54.6%     - 1972s
     0     0 69528.3102    0  423 44977.3640 69528.3102  54.6%     - 1984s
H    0     0                    45081.472628 69528.1033  54.2%     - 1987s
H    0     0                    45142.654014 69528.1033  54.0%     - 1991s
H    0     0                    45186.734700 69528.1033  53.9%     - 1991s
H    0     0                    45631.962989 69528.1033  52.4%     - 1991s
     0     0 69526.1912    0  420 45631.9630 69526.1912  52.4%     - 1996s
     0     0 69524.3515    0  422 45631.9630 69524.3515  52.4%     - 2004s
     0     0 69523.3305    0  426 45631.9630 69523.3305  52.4%     - 2006s
     0     0 69503.6142    0  376 45631.9630 69503.6142  52.3%     - 2023s
     0     0 69486.0304    0  418 45631.9630 69486.0304  52.3%     - 2037s
     0     0 69479.3287    0  417 45631.9630 69479.3287  52.3%     - 2046s
     0     0 69475.3200    0  416 45631.9630 69475.3200  52.3%     - 2051s
     0     0 69472.6521    0  375 45631.9630 69472.6521  52.2%     - 2055s
     0     0 69471.0113    0  376 45631.9630 69471.0113  52.2%     - 2060s
     0     0 69450.7106    0  365 45631.9630 69450.7106  52.2%     - 2071s
     0     0 69444.6884    0  377 45631.9630 69444.6884  52.2%     - 2084s
     0     0 69441.1670    0  373 45631.9630 69441.1670  52.2%     - 2088s
     0     0 69438.8460    0  418 45631.9630 69438.8460  52.2%     - 2093s
     0     0 69438.3824    0  416 45631.9630 69438.3824  52.2%     - 2098s
     0     0 69421.4333    0  420 45631.9630 69421.4333  52.1%     - 2119s
     0     0 69411.0338    0  434 45631.9630 69411.0338  52.1%     - 2134s
     0     0 69407.2434    0  429 45631.9630 69407.2434  52.1%     - 2141s
     0     0 69405.4548    0  424 45631.9630 69405.4548  52.1%     - 2146s
     0     0 69403.9845    0  429 45631.9630 69403.9845  52.1%     - 2150s
     0     0 69394.8773    0  436 45631.9630 69394.8773  52.1%     - 2165s
H    0     0                    45904.113650 69394.3582  51.2%     - 2214s
H    0     0                    46020.497162 69394.3582  50.8%     - 2219s
     0     0 69383.4601    0  442 46020.4972 69383.4601  50.8%     - 2233s
     0     0 69382.0782    0  440 46020.4972 69382.0782  50.8%     - 2236s
     0     0 69367.5402    0  426 46020.4972 69367.5402  50.7%     - 2251s
     0     0 69365.3547    0  434 46020.4972 69365.3547  50.7%     - 2256s
     0     0 69361.8675    0  427 46020.4972 69361.8675  50.7%     - 2260s
     0     0 69359.8292    0  435 46020.4972 69359.8292  50.7%     - 2263s
     0     0 69358.5825    0  438 46020.4972 69358.5825  50.7%     - 2266s
     0     0 69353.6680    0  433 46020.4972 69353.6680  50.7%     - 2276s
     0     0 69337.5805    0  424 46020.4972 69337.5805  50.7%     - 2282s
     0     0 69325.7194    0  391 46020.4972 69325.7194  50.6%     - 2287s
     0     0 69321.6280    0  429 46020.4972 69321.6280  50.6%     - 2293s
     0     0 69320.3301    0  432 46020.4972 69320.3301  50.6%     - 2296s
     0     0 69271.1979    0  418 46020.4972 69271.1979  50.5%     - 2323s
H    0     0                    46106.073296 69271.0123  50.2%     - 2324s
     0     0 69257.5984    0  388 46106.0733 69257.5984  50.2%     - 2339s
     0     0 69253.0500    0  428 46106.0733 69253.0500  50.2%     - 2345s
     0     0 69250.5548    0  427 46106.0733 69250.5548  50.2%     - 2355s
     0     0 69249.6563    0  431 46106.0733 69249.6563  50.2%     - 2358s
     0     0 69244.8033    0  436 46106.0733 69244.8033  50.2%     - 2366s
     0     0 69243.6816    0  433 46106.0733 69243.6816  50.2%     - 2370s
     0     0 69236.5759    0  423 46106.0733 69236.5759  50.2%     - 2387s
     0     0 69234.8662    0  429 46106.0733 69234.8662  50.2%     - 2393s
     0     0 69222.3500    0  428 46106.0733 69222.3500  50.1%     - 2405s
     0     0 69219.3187    0  377 46106.0733 69219.3187  50.1%     - 2412s
     0     0 69218.4927    0  435 46106.0733 69218.4927  50.1%     - 2414s
     0     0 69214.0147    0  432 46106.0733 69214.0147  50.1%     - 2421s
     0     0 69213.4972    0  432 46106.0733 69213.4972  50.1%     - 2428s
H    0     0                    46161.249887 69213.4972  49.9%     - 2635s
H    0     0                    46183.755459 69213.4972  49.9%     - 2636s
H    0     0                    46229.230805 69213.4972  49.7%     - 2636s
H    0     0                    46275.877924 69213.4972  49.6%     - 2636s
     0     2 69213.3834    0  432 46275.8779 69213.3834  49.6%     - 3111s
     1     3 68736.6578    1  346 46275.8779 69209.9255  49.6% 18716 3173s
     2     4 69128.1704    1  424 46275.8779 69128.1704  49.4% 12628 3196s
     3     5 68167.5523    2  353 46275.8779 69128.0361  49.4% 13110 3233s
     4     9 68918.2283    2  419 46275.8779 69127.9327  49.4% 11470 3271s
     8    17 68718.5067    3  407 46275.8779 68918.1057  48.9% 11324 3346s
    16    32 68485.7966    4  409 46275.8779 68918.1057  48.9% 12818 3413s
    31    45 66670.4630    5  355 46275.8779 68718.3811  48.5% 18924 3600s

Cutting planes:
  Learned: 2
  Gomory: 12
  Implied bound: 12
  MIR: 1550
  Flow cover: 3257
  RLT: 36
  Relax-and-lift: 304

Explored 44 nodes (1612556 simplex iterations) in 3600.23 seconds (4374.74 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 46275.9 46229.2 46183.8 ... 45142.7

Time limit reached
Best objective 4.627587792399e+04, best bound 6.856911814619e+04, gap 48.1746%
  WARNING: Time limit reached. Using best solution found (gap: 48.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.25s
  Master Objective (UB) = 46275.88, θ = 194331.14
  Upper Bound (UB) = 46275.88

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 194331.14
  [DEBUG]   ✓ Scenario 0: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 194331.14 ≤ Q = 194331.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 194331.14 ≤ Q = 194331.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 194331.14 ≤ Q = 194331.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 194331.14 ≤ Q = 194331.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 194331.14 ≤ Q = 194331.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 194331.14 ≤ Q = 194331.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 194331.14 ≤ Q = 194331.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 194331.14 ≤ Q = 194331.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 194331.14 ≤ Q = 194331.14 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3f6ff8e2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc090071e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.430145e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6953254.6339
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.596604e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159660.42    0  123 6953254.63 -159660.42   102%     -    0s
H    0     0                    -124953.5843 -159660.42  27.8%     -    0s
H    0     0                    -125216.8369 -159660.42  27.5%     -    0s
H    0     0                    -126408.9107 -159660.42  26.3%     -    0s
H    0     0                    -129874.6800 -142714.61  9.89%     -    0s
H    0     0                    -130688.6840 -142714.61  9.20%     -    0s
     0     0 -142714.61    0  130 -130688.68 -142714.61  9.20%     -    0s
H    0     0                    -138191.3128 -142609.75  3.20%     -    0s
H    0     0                    -138977.3826 -142609.75  2.61%     -    0s
     0     0 -141290.20    0  110 -138977.38 -141290.20  1.66%     -    0s
H    0     0                    -140114.6352 -141277.40  0.83%     -    0s
H    0     0                    -140134.9385 -141249.23  0.80%     -    0s
     0     0 -141249.23    0  110 -140134.94 -141249.23  0.80%     -    0s
     0     0 -140715.43    0   31 -140134.94 -140715.43  0.41%     -    0s
     0     0 -140587.51    0   40 -140134.94 -140587.51  0.32%     -    0s
     0     0 -140522.66    0   30 -140134.94 -140522.66  0.28%     -    0s
     0     0 -140465.72    0   28 -140134.94 -140465.72  0.24%     -    0s
     0     0 -140441.94    0   28 -140134.94 -140441.94  0.22%     -    0s
H    0     0                    -140141.9199 -140441.94  0.21%     -    0s
     0     0 -140441.94    0   69 -140141.92 -140441.94  0.21%     -    0s
     0     0 -140441.94    0   22 -140141.92 -140441.94  0.21%     -    0s
     0     0 -140262.89    0   24 -140141.92 -140262.89  0.09%     -    0s
     0     0 -140260.65    0   15 -140141.92 -140260.65  0.08%     -    0s
     0     0 -140249.18    0   13 -140141.92 -140249.18  0.08%     -    0s
     0     0 -140180.80    0   11 -140141.92 -140180.80  0.03%     -    0s
     0     0 -140155.33    0    9 -140141.92 -140155.33  0.01%     -    0s
     0     0 -140153.11    0    4 -140141.92 -140153.11  0.01%     -    0s
     0     0 -140147.37    0    2 -140141.92 -140147.37  0.00%     -    0s
H    0     0                    -140146.7795 -140147.37  0.00%     -    0s
     0     0 -140147.37    0    1 -140146.78 -140147.37  0.00%     -    0s

Explored 1 nodes (1111 simplex iterations) in 0.24 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -140147 -140135 -140115 ... 1.43015e+13
No other solutions better than -140147

Optimal solution found (tolerance 1.00e-06)
Best objective -1.401467794990e+05, best bound -1.401467794990e+05, gap 0.0000%
  Subproblem solved in 0.27s
  Worst-case operational profit (Z_SP) = 183223.43
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140146.78
  [DEBUG]   S×d_nominal = 323370.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 323370.21 + -140146.78 = 183223.43
  [DEBUG]   Current θ from Master = 194331.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11107.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 35168.17
  Lower Bound (LB) = 48151.13
  Gap (UB-LB) = -1875.2517, Absolute Gap = 1875.2517, Relative Gap = -0.040523
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 46275.88, LB = 48151.13, Gap = -1875.25
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0xc598d17f
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134698 rows and 54714 columns
Presolve time: 4.95s
Presolved: 157195 rows, 66106 columns, 969680 nonzeros
Variable types: 63847 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -303310.8179
Found heuristic solution: objective -227440.3388

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.66s

Barrier statistics:
 Dense cols : 655
 AA' NZ     : 8.447e+06
 Factor NZ  : 1.899e+07 (roughly 240 MB of memory)
 Factor Ops : 4.948e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.50082748e+07  3.00213762e+08  1.83e+05 1.43e+01  1.14e+05     8s
   1  -1.94045136e+07  2.87946346e+08  1.28e+05 9.96e+01  7.97e+04     8s
   2  -8.49044914e+06  2.37070522e+08  5.31e+04 2.07e+01  3.44e+04     8s
   3  -2.05445101e+06  1.77675084e+08  9.27e+03 2.20e+00  6.47e+03     8s
   4  -8.70897257e+05  9.72478519e+07  1.49e+03 4.55e-01  1.23e+03     9s
   5  -7.05416814e+05  5.80706558e+07  5.97e+02 2.31e-01  5.32e+02     9s
   6  -5.79715124e+05  4.25689231e+07  1.95e+02 1.46e-01  2.51e+02     9s
   7  -4.27302043e+05  2.92232507e+07  4.64e+01 9.37e-02  1.25e+02     9s
   8  -3.29838325e+05  1.87023774e+07  2.29e+01 5.71e-02  7.44e+01     9s
   9  -1.97941665e+05  1.17836201e+07  7.68e+00 3.43e-02  4.37e+01     9s
  10  -1.45132758e+05  8.58110150e+06  4.15e+00 2.46e-02  3.12e+01     9s
  11  -1.25566910e+05  5.77753152e+06  2.62e+00 1.62e-02  2.10e+01    10s
  12  -7.86781366e+04  3.25370898e+06  8.79e-01 8.98e-03  1.17e+01    10s
  13  -4.66055374e+04  1.20847518e+06  3.43e-01 3.32e-03  4.39e+00    10s
  14  -1.87157219e+04  4.16640985e+05  1.92e-01 1.24e-03  1.52e+00    10s
  15   5.53826859e+03  2.85773581e+05  1.28e-01 7.16e-04  9.79e-01    10s
  16   1.79163845e+04  1.92612504e+05  1.07e-01 1.75e-03  6.11e-01    10s
  17   3.12819347e+04  1.42282158e+05  8.41e-02 2.45e-03  3.88e-01    10s
  18   3.78252029e+04  1.24214270e+05  7.30e-02 1.76e-03  3.02e-01    10s
  19   4.32189465e+04  1.13834893e+05  6.35e-02 1.70e-03  2.47e-01    11s
  20   5.04076757e+04  1.07258461e+05  5.14e-02 1.50e-03  1.99e-01    11s
  21   5.32075581e+04  1.00435099e+05  4.64e-02 1.38e-03  1.65e-01    11s
  22   5.62031607e+04  9.79233088e+04  4.16e-02 1.26e-03  1.46e-01    11s
  23   5.78871075e+04  9.59613601e+04  3.88e-02 1.32e-03  1.33e-01    11s
  24   5.99654692e+04  9.30995172e+04  3.55e-02 1.05e-03  1.16e-01    11s
  25   6.41590513e+04  9.05721698e+04  2.89e-02 8.28e-04  9.24e-02    11s
  26   6.62756214e+04  9.02195492e+04  2.56e-02 7.88e-04  8.38e-02    12s
  27   6.81488054e+04  8.83244176e+04  2.28e-02 5.65e-04  7.06e-02    12s
  28   7.15971484e+04  8.74959394e+04  1.74e-02 4.71e-04  5.56e-02    12s
  29   7.39771390e+04  8.66440853e+04  1.37e-02 3.74e-04  4.43e-02    12s
  30   7.56488528e+04  8.57791670e+04  1.11e-02 2.83e-04  3.54e-02    12s
  31   7.62121616e+04  8.52717419e+04  1.02e-02 2.28e-04  3.17e-02    13s
  32   7.81101124e+04  8.47802596e+04  7.22e-03 1.75e-04  2.33e-02    13s
  33   7.89280331e+04  8.39967169e+04  5.97e-03 1.40e-04  1.77e-02    13s
  34   7.98203235e+04  8.37739303e+04  4.60e-03 1.20e-04  1.38e-02    13s
  35   8.05289067e+04  8.35443080e+04  3.55e-03 8.32e-05  1.06e-02    13s
  36   8.13469027e+04  8.34413456e+04  2.33e-03 6.73e-05  7.33e-03    14s
  37   8.16726677e+04  8.33599232e+04  1.86e-03 5.40e-05  5.90e-03    14s
  38   8.19169924e+04  8.32630781e+04  1.53e-03 5.58e-05  4.71e-03    14s
  39   8.20872597e+04  8.32234518e+04  1.30e-03 5.38e-05  3.98e-03    14s
  40   8.22144271e+04  8.32157813e+04  1.13e-03 5.10e-05  3.50e-03    14s
  41   8.23811906e+04  8.31526631e+04  8.96e-04 3.36e-05  2.70e-03    15s
  42   8.24665387e+04  8.31239680e+04  7.77e-04 2.54e-05  2.30e-03    15s
  43   8.25916899e+04  8.31161783e+04  5.94e-04 2.30e-05  1.84e-03    15s
  44   8.26566621e+04  8.30958515e+04  5.05e-04 1.69e-05  1.54e-03    15s
  45   8.27137595e+04  8.30859448e+04  4.29e-04 1.41e-05  1.30e-03    16s
  46   8.27889058e+04  8.30675590e+04  3.21e-04 9.20e-06  9.75e-04    16s
  47   8.28116669e+04  8.30528216e+04  2.90e-04 5.31e-06  8.44e-04    16s
  48   8.28816149e+04  8.30467674e+04  1.95e-04 1.03e-05  5.78e-04    16s
  49   8.29049772e+04  8.30437224e+04  1.64e-04 8.30e-06  4.86e-04    17s
  50   8.29557191e+04  8.30397133e+04  9.61e-05 4.93e-06  2.94e-04    17s
  51   8.29658199e+04  8.30392244e+04  8.32e-05 4.64e-06  2.57e-04    17s
  52   8.29776270e+04  8.30371091e+04  6.83e-05 3.72e-06  2.08e-04    17s
  53   8.30017815e+04  8.30355840e+04  3.70e-05 2.38e-06  1.18e-04    17s
  54   8.30192802e+04  8.30335522e+04  1.49e-05 1.01e-06  4.99e-05    18s
  55   8.30198489e+04  8.30332660e+04  1.42e-05 8.54e-07  4.69e-05    18s
  56   8.30243594e+04  8.30326720e+04  8.84e-06 6.69e-07  2.91e-05    18s
  57   8.30259334e+04  8.30325091e+04  6.90e-06 5.40e-07  2.30e-05    18s
  58   8.30263893e+04  8.30323932e+04  6.34e-06 4.36e-07  2.10e-05    18s
  59   8.30287792e+04  8.30320388e+04  3.56e-06 4.87e-07  1.14e-05    19s
  60   8.30288288e+04  8.30320356e+04  3.57e-06 1.48e-06  1.12e-05    19s
  61   8.30294178e+04  8.30319686e+04  2.87e-06 1.04e-06  8.93e-06    19s
  62   8.30301523e+04  8.30319452e+04  1.99e-06 8.47e-07  6.27e-06    19s
  63   8.30304491e+04  8.30319275e+04  1.63e-06 7.30e-07  5.17e-06    19s
  64   8.30307449e+04  8.30319030e+04  1.42e-06 5.74e-07  4.05e-06    20s
  65   8.30308560e+04  8.30318899e+04  1.27e-06 4.88e-07  3.62e-06    20s
  66   8.30314688e+04  8.30318244e+04  4.28e-07 3.80e-08  1.24e-06    20s
  67   8.30317282e+04  8.30318169e+04  1.26e-07 9.64e-09  3.11e-07    20s
  68   8.30317344e+04  8.30318163e+04  9.62e-06 6.27e-07  2.87e-07    20s
  69   8.30317351e+04  8.30318163e+04  9.54e-06 6.26e-07  2.85e-07    21s
  70   8.30317532e+04  8.30318158e+04  7.86e-06 5.40e-07  2.18e-07    21s
  71   8.30317660e+04  8.30318139e+04  1.23e-05 2.33e-06  1.64e-07    21s
  72   8.30317833e+04  8.30318130e+04  1.91e-05 1.35e-06  1.02e-07    21s
  73   8.30317904e+04  8.30318126e+04  1.44e-05 9.66e-07  7.62e-08    21s
  74   8.30317914e+04  8.30318125e+04  1.38e-05 9.27e-07  7.30e-08    22s
  75   8.30317919e+04  8.30318125e+04  1.34e-05 8.75e-07  7.18e-08    22s
  76   8.30317931e+04  8.30318124e+04  1.18e-05 9.52e-07  6.70e-08    22s
  77   8.30317947e+04  8.30318123e+04  1.07e-05 9.70e-07  6.08e-08    22s
  78   8.30317950e+04  8.30318122e+04  1.05e-05 8.29e-07  5.95e-08    22s
  79   8.30318004e+04  8.30318120e+04  4.72e-06 1.91e-06  3.99e-08    23s
  80   8.30318006e+04  8.30318120e+04  4.65e-06 1.90e-06  3.93e-08    23s
  81   8.30318015e+04  8.30318119e+04  4.38e-06 1.69e-06  3.59e-08    23s
  82   8.30318051e+04  8.30318117e+04  9.30e-06 1.82e-06  2.07e-08    23s
  83   8.30318051e+04  8.30318117e+04  9.35e-06 1.81e-06  2.05e-08    24s
  84   8.30318052e+04  8.30318117e+04  9.49e-06 1.70e-06  2.06e-08    24s
  85   8.30318052e+04  8.30318117e+04  9.49e-06 1.70e-06  2.05e-08    24s

Barrier solved model in 85 iterations and 23.90 seconds (25.25 work units)
Optimal objective 8.30318052e+04


Root crossover log...

  141491 DPushes remaining with DInf 0.0000000e+00                24s
   64166 DPushes remaining with DInf 0.0000000e+00                25s
   31099 DPushes remaining with DInf 0.0000000e+00                30s
   13691 DPushes remaining with DInf 0.0000000e+00                35s
    2745 DPushes remaining with DInf 0.0000000e+00                40s
       0 DPushes remaining with DInf 0.0000000e+00                43s

   60019 PPushes remaining with PInf 1.2806730e-03                43s
   27065 PPushes remaining with PInf 3.8969580e-04                46s
   12227 PPushes remaining with PInf 6.3747051e-03                51s
       0 PPushes remaining with PInf 0.0000000e+00                55s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.3129270e+06     55s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  142014    8.3031805e+04   0.000000e+00   7.312927e+06     55s
  142232    8.3031805e+04   0.000000e+00   3.267444e+05     56s
  143104    8.3031806e+04   0.000000e+00   2.463719e+05     60s
  144194    8.3031808e+04   0.000000e+00   2.756330e+06     65s
  145502    8.3031809e+04   0.000000e+00   1.772083e+05     71s
  146810    8.3031809e+04   0.000000e+00   1.157955e+05     76s
  148336    8.3031810e+04   0.000000e+00   1.717394e+04     80s
  150383    8.3031816e+04   0.000000e+00   2.671709e+00     85s
  150478    8.3031812e+04   0.000000e+00   0.000000e+00     86s
  150478    8.3031812e+04   0.000000e+00   0.000000e+00     86s
Concurrent spin time: 43.87s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.303181e+04, 150478 iterations, 123.56 seconds (125.00 work units)
Total elapsed time = 130.39s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83031.8116    0  157 -227440.34 83031.8116   137%     -  131s
H    0     0                    -221712.5674 83031.8116   137%     -  132s
H    0     0                    -221641.9880 83031.8116   137%     -  132s
H    0     0                    -207549.8690 83031.8116   140%     -  132s
H    0     0                    -203421.3078 83031.8116   141%     -  133s
H    0     0                    -203227.1365 83031.8116   141%     -  133s
H    0     0                    -60976.57838 83031.8116   236%     -  133s
H    0     0                    -54976.28436 83031.8116   251%     -  133s
H    0     0                    -54085.32112 83031.8116   254%     -  134s
H    0     0                    2566.5878012 83031.8116  3135%     -  134s
H    0     0                    16123.664862 83031.8116   415%     -  134s
H    0     0                    17905.096317 83031.8116   364%     -  136s
H    0     0                    24097.557581 83031.8116   245%     -  136s
H    0     0                    24446.598218 83031.8116   240%     -  136s
H    0     0                    25849.426935 83031.8116   221%     -  137s
H    0     0                    25947.251466 83031.8116   220%     -  137s
H    0     0                    30930.006909 83031.8116   168%     -  137s
H    0     0                    30962.744171 83031.8116   168%     -  137s
H    0     0                    31177.853708 83031.8116   166%     -  137s
     0     0 78027.6314    0  249 31177.8537 78027.6314   150%     -  321s
H    0     0                    31227.842559 78027.4391   150%     -  323s
H    0     0                    31429.320907 78027.4391   148%     -  323s
H    0     0                    31522.243686 78027.4391   148%     -  323s
     0     0 77576.3784    0  261 31522.2437 77576.3784   146%     -  391s
     0     0 77484.0095    0  249 31522.2437 77484.0095   146%     -  451s
     0     0 77376.2048    0  240 31522.2437 77376.2048   145%     -  487s
     0     0 77366.3556    0  243 31522.2437 77366.3556   145%     -  505s
     0     0 77365.8652    0  243 31522.2437 77365.8652   145%     -  506s
     0     0 74591.6961    0  237 31522.2437 74591.6961   137%     -  664s
H    0     0                    31848.428155 74591.6850   134%     -  666s
H    0     0                    32401.877851 74591.6850   130%     -  666s
H    0     0                    32608.008433 74591.6850   129%     -  666s
H    0     0                    32979.348793 74591.6850   126%     -  666s
H    0     0                    38238.895686 74591.6850  95.1%     -  666s
     0     0 73884.3416    0  288 38238.8957 73884.3416  93.2%     -  778s
     0     0 73803.9516    0  291 38238.8957 73803.9516  93.0%     -  814s
     0     0 73764.1828    0  289 38238.8957 73764.1828  92.9%     -  843s
     0     0 73750.8715    0  289 38238.8957 73750.8715  92.9%     -  854s
     0     0 73722.8630    0  289 38238.8957 73722.8630  92.8%     -  871s
     0     0 73651.7839    0  248 38238.8957 73651.7839  92.6%     -  914s
     0     0 73640.8654    0  296 38238.8957 73640.8654  92.6%     -  933s
     0     0 73639.0031    0  300 38238.8957 73639.0031  92.6%     -  939s
     0     0 73620.0732    0  246 38238.8957 73620.0732  92.5%     -  957s
     0     0 73611.9558    0  256 38238.8957 73611.9558  92.5%     -  977s
     0     0 73607.0954    0  292 38238.8957 73607.0954  92.5%     -  987s
     0     0 73605.1307    0  250 38238.8957 73605.1307  92.5%     -  992s
     0     0 73599.5307    0  291 38238.8957 73599.5307  92.5%     -  997s
     0     0 73599.4638    0  293 38238.8957 73599.4638  92.5%     -  999s
     0     0 71868.6570    0  348 38238.8957 71868.6570  87.9%     - 1187s
     0     0 71514.7883    0  299 38238.8957 71514.7883  87.0%     - 1268s
     0     0 71386.2927    0  353 38238.8957 71386.2927  86.7%     - 1332s
     0     0 71344.7134    0  357 38238.8957 71344.7134  86.6%     - 1362s
     0     0 71321.7800    0  357 38238.8957 71321.7800  86.5%     - 1381s
     0     0 71313.1656    0  356 38238.8957 71313.1656  86.5%     - 1391s
     0     0 71296.9931    0  357 38238.8957 71296.9931  86.5%     - 1400s
     0     0 71291.8619    0  351 38238.8957 71291.8619  86.4%     - 1407s
     0     0 71284.0890    0  353 38238.8957 71284.0890  86.4%     - 1414s
     0     0 71277.3557    0  360 38238.8957 71277.3557  86.4%     - 1425s
     0     0 71271.9766    0  358 38238.8957 71271.9766  86.4%     - 1431s
     0     0 71268.9292    0  353 38238.8957 71268.9292  86.4%     - 1434s
     0     0 71267.6355    0  356 38238.8957 71267.6355  86.4%     - 1437s
     0     0 70630.6773    0  370 38238.8957 70630.6773  84.7%     - 1528s
     0     0 70429.7838    0  321 38238.8957 70429.7838  84.2%     - 1577s
     0     0 70379.2861    0  337 38238.8957 70379.2861  84.1%     - 1605s
     0     0 70350.3201    0  340 38238.8957 70350.3201  84.0%     - 1632s
     0     0 70308.6004    0  386 38238.8957 70308.6004  83.9%     - 1659s
     0     0 70299.8550    0  391 38238.8957 70299.8550  83.8%     - 1682s
     0     0 70289.2751    0  386 38238.8957 70289.2751  83.8%     - 1700s
     0     0 70282.5815    0  390 38238.8957 70282.5815  83.8%     - 1712s
     0     0 70278.1126    0  386 38238.8957 70278.1126  83.8%     - 1723s
     0     0 70271.2447    0  386 38238.8957 70271.2447  83.8%     - 1738s
     0     0 70268.2730    0  385 38238.8957 70268.2730  83.8%     - 1746s
     0     0 70264.0047    0  388 38238.8957 70264.0047  83.8%     - 1757s
     0     0 70259.2971    0  344 38238.8957 70259.2971  83.7%     - 1766s
     0     0 70258.0651    0  393 38238.8957 70258.0651  83.7%     - 1772s
     0     0 70076.7474    0  394 38238.8957 70076.7474  83.3%     - 1825s
     0     0 70000.7456    0  361 38238.8957 70000.7456  83.1%     - 1865s
     0     0 69983.3902    0  367 38238.8957 69983.3902  83.0%     - 1896s
     0     0 69947.4578    0  403 38238.8957 69947.4578  82.9%     - 1922s
     0     0 69930.5439    0  408 38238.8957 69930.5439  82.9%     - 1936s
     0     0 69920.7243    0  405 38238.8957 69920.7243  82.9%     - 1948s
     0     0 69916.6458    0  410 38238.8957 69916.6458  82.8%     - 1957s
     0     0 69912.8527    0  411 38238.8957 69912.8527  82.8%     - 1963s
     0     0 69909.9226    0  415 38238.8957 69909.9226  82.8%     - 1978s
     0     0 69907.0448    0  410 38238.8957 69907.0448  82.8%     - 1983s
     0     0 69905.9546    0  416 38238.8957 69905.9546  82.8%     - 1987s
     0     0 69821.8616    0  416 38238.8957 69821.8616  82.6%     - 2031s
     0     0 69790.3455    0  412 38238.8957 69790.3455  82.5%     - 2055s
     0     0 69780.5826    0  416 38238.8957 69780.5826  82.5%     - 2071s
     0     0 69775.7761    0  382 38238.8957 69775.7761  82.5%     - 2081s
     0     0 69772.2215    0  416 38238.8957 69772.2215  82.5%     - 2088s
     0     0 69771.2002    0  422 38238.8957 69771.2002  82.5%     - 2095s
     0     0 69690.0203    0  417 38238.8957 69690.0203  82.2%     - 2134s
H    0     0                    38449.153937 69689.8441  81.3%     - 2135s
     0     0 69661.1450    0  427 38449.1539 69661.1450  81.2%     - 2155s
     0     0 69652.1395    0  428 38449.1539 69652.1395  81.2%     - 2164s
     0     0 69646.3561    0  431 38449.1539 69646.3561  81.1%     - 2171s
     0     0 69641.6655    0  432 38449.1539 69641.6655  81.1%     - 2178s
     0     0 69629.8707    0  429 38449.1539 69629.8707  81.1%     - 2195s
     0     0 69620.7582    0  430 38449.1539 69620.7582  81.1%     - 2203s
     0     0 69617.7129    0  432 38449.1539 69617.7129  81.1%     - 2208s
     0     0 69615.7497    0  430 38449.1539 69615.7497  81.1%     - 2213s
     0     0 69614.4274    0  430 38449.1539 69614.4274  81.1%     - 2219s
     0     0 69547.1795    0  416 38449.1539 69547.1795  80.9%     - 2246s
     0     0 69526.9232    0  425 38449.1539 69526.9232  80.8%     - 2263s
     0     0 69520.0278    0  426 38449.1539 69520.0278  80.8%     - 2269s
     0     0 69515.3583    0  427 38449.1539 69515.3583  80.8%     - 2276s
     0     0 69513.7837    0  433 38449.1539 69513.7837  80.8%     - 2279s
     0     0 69481.9578    0  426 38449.1539 69481.9578  80.7%     - 2305s
     0     0 69474.1937    0  423 38449.1539 69474.1937  80.7%     - 2317s
     0     0 69456.1673    0  426 38449.1539 69456.1673  80.6%     - 2334s
     0     0 69446.0325    0  428 38449.1539 69446.0325  80.6%     - 2346s
     0     0 69439.6417    0  424 38449.1539 69439.6417  80.6%     - 2356s
     0     0 69437.6391    0  430 38449.1539 69437.6391  80.6%     - 2360s
     0     0 69436.8950    0  431 38449.1539 69436.8950  80.6%     - 2364s
     0     0 69422.3100    0  426 38449.1539 69422.3100  80.6%     - 2377s
     0     0 69417.5105    0  439 38449.1539 69417.5105  80.5%     - 2386s
     0     0 69416.4341    0  438 38449.1539 69416.4341  80.5%     - 2389s
     0     0 69402.1712    0  423 38449.1539 69402.1712  80.5%     - 2405s
     0     0 69396.1923    0  425 38449.1539 69396.1923  80.5%     - 2412s
     0     0 69392.6434    0  426 38449.1539 69392.6434  80.5%     - 2417s
     0     0 69391.6855    0  429 38449.1539 69391.6855  80.5%     - 2420s
     0     0 69385.4766    0  424 38449.1539 69385.4766  80.5%     - 2435s
H    0     0                    40059.620588 69385.4313  73.2%     - 2436s
H    0     0                    40140.951457 69385.4313  72.9%     - 2438s
H    0     0                    40402.079685 69385.4313  71.7%     - 2438s
H    0     0                    40405.050429 69385.4313  71.7%     - 2438s
     0     0 69382.7488    0  431 40405.0504 69382.7488  71.7%     - 2448s
     0     0 69377.0621    0  432 40405.0504 69377.0621  71.7%     - 2457s
     0     0 69376.2997    0  431 40405.0504 69376.2997  71.7%     - 2460s
     0     0 69374.2528    0  435 40405.0504 69374.2528  71.7%     - 2469s
H    0     0                    40525.968293 69374.0798  71.2%     - 2471s
H    0     0                    40528.540860 69374.0798  71.2%     - 2471s
     0     0 69373.7169    0  434 40528.5409 69373.7169  71.2%     - 2474s
     0     0 69362.0197    0  427 40528.5409 69362.0197  71.1%     - 2493s
H    0     0                    41960.007972 69361.6282  65.3%     - 2498s
H    0     0                    43267.975343 69361.6282  60.3%     - 2498s
H    0     0                    43529.339830 69361.6282  59.3%     - 2498s
H    0     0                    43745.967880 69361.6282  58.6%     - 2498s
H    0     0                    44561.930154 69361.6282  55.7%     - 2498s
H    0     0                    44814.072737 69361.6282  54.8%     - 2498s
H    0     0                    44913.362049 69361.6282  54.4%     - 2498s
H    0     0                    44989.157727 69361.6282  54.2%     - 2498s
H    0     0                    45010.205649 69361.6282  54.1%     - 2498s
     0     0 69357.3609    0  424 45010.2056 69357.3609  54.1%     - 2507s
     0     0 69356.4801    0  424 45010.2056 69356.4801  54.1%     - 2511s
     0     0 69352.1905    0  423 45010.2056 69352.1905  54.1%     - 2522s
     0     0 69351.9491    0  423 45010.2056 69351.9491  54.1%     - 2529s
H    0     0                    45529.015900 69351.7224  52.3%     - 2699s
H    0     0                    45641.626994 69351.7224  51.9%     - 2699s
H    0     0                    45757.809897 69351.7224  51.6%     - 2699s
H    0     0                    46040.619623 69351.7224  50.6%     - 2699s
     0     2 69351.7224    0  423 46040.6196 69351.7224  50.6%     - 2941s
     1     3 69261.4913    1  366 46040.6196 69351.7224  50.6% 13148 2972s
     2     4 69181.0994    1  414 46040.6196 69261.4883  50.4% 13604 3005s
     3     5 68222.8386    2  389 46040.6196 69261.4883  50.4% 16839 3075s
     4     7 68891.5137    2  412 46040.6196 69261.4883  50.4% 15950 3126s
     6    12 68741.8703    3  416 46040.6196 69261.4883  50.4% 15823 3193s
    11    23 68620.5778    4  421 46040.6196 68891.3810  49.6% 14590 3250s
    22    34 68032.1638    5  369 46040.6196 68827.7995  49.5% 20162 3426s
H   33    56                    46883.710894 68626.9455  46.4% 20362 3600s
H   40    56                    47318.742348 68626.9455  45.0% 19938 3600s
H   47    56                    48140.065060 68626.9455  42.6% 18913 3600s

Cutting planes:
  Learned: 3
  Gomory: 11
  Implied bound: 18
  MIR: 1840
  Flow cover: 3316
  RLT: 38
  Relax-and-lift: 276

Explored 55 nodes (1969708 simplex iterations) in 3600.15 seconds (4430.70 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 48140.1 47318.7 46883.7 ... 43746

Time limit reached
Best objective 4.814006506015e+04, best bound 6.862694551833e+04, gap 42.5568%
  WARNING: Time limit reached. Using best solution found (gap: 42.56%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = 48140.07, θ = 199487.04
  Upper Bound (UB) = 48140.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 199487.04
  [DEBUG]   ✓ Scenario 0: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 199487.04 ≤ Q = 199487.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 199487.04 ≤ Q = 199487.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 199487.04 ≤ Q = 199849.54 (slack: 362.49)
  [DEBUG]   ✓ Scenario 5: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 199487.04 ≤ Q = 199487.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 199487.04 ≤ Q = 199921.60 (slack: 434.56)
  [DEBUG]   ✓ Scenario 18: θ = 199487.04 ≤ Q = 201848.21 (slack: 2361.16)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7d59ed99
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x82a61267
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.511856e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 7322514.8417
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.713428e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -171342.77    0  124 7322514.84 -171342.77   102%     -    0s
H    0     0                    -136309.8348 -171342.77  25.7%     -    0s
H    0     0                    -136573.0873 -171342.77  25.5%     -    0s
H    0     0                    -142012.4345 -171342.77  20.7%     -    0s
H    0     0                    -144710.3246 -155820.35  7.68%     -    0s
H    0     0                    -145285.9797 -155820.35  7.25%     -    0s
     0     0 -155820.35    0  130 -145285.98 -155820.35  7.25%     -    0s
H    0     0                    -150647.5767 -155685.15  3.34%     -    0s
     0     0 -153750.80    0  113 -150647.58 -153750.80  2.06%     -    0s
H    0     0                    -152090.5259 -153737.29  1.08%     -    0s
     0     0 -153658.13    0  113 -152090.53 -153658.13  1.03%     -    0s
     0     0 -153280.91    0   98 -152090.53 -153280.91  0.78%     -    0s
H    0     0                    -152152.6254 -153228.63  0.71%     -    0s
     0     0 -153155.41    0   99 -152152.63 -153155.41  0.66%     -    0s
     0     0 -153153.22    0   99 -152152.63 -153153.22  0.66%     -    0s
     0     0 -153008.64    0   79 -152152.63 -153008.64  0.56%     -    0s
     0     0 -152935.82    0   78 -152152.63 -152935.82  0.51%     -    0s
     0     0 -152868.83    0   74 -152152.63 -152868.83  0.47%     -    0s
     0     0 -152856.04    0   74 -152152.63 -152856.04  0.46%     -    0s
H    0     0                    -152181.9554 -152852.28  0.44%     -    0s
     0     2 -152819.42    0   68 -152181.96 -152819.42  0.42%     -    0s
H  160    46                    -152184.1577 -152277.79  0.06%   6.7    0s
H  185    46                    -152199.1944 -152277.79  0.05%   6.2    0s
*  272    99              28    -152229.5997 -152242.67  0.01%   5.5    0s
*  364     0              27    -152233.5249 -152242.67  0.01%   4.9    0s

Cutting planes:
  Gomory: 31
  Implied bound: 3
  MIR: 172
  Flow cover: 22
  RLT: 45
  Relax-and-lift: 5
  BQP: 3

Explored 398 nodes (2515 simplex iterations) in 0.23 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -152234 -152230 -152199 ... -142012
No other solutions better than -152234

Optimal solution found (tolerance 1.00e-06)
Best objective -1.522335249491e+05, best bound -1.522335249491e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 195081.88
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -152233.52
  [DEBUG]   S×d_nominal = 347315.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 347315.41 + -152233.52 = 195081.88
  [DEBUG]   Current θ from Master = 199487.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4405.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 43734.90
  Lower Bound (LB) = 48151.13
  Gap (UB-LB) = -11.0646, Absolute Gap = 11.0646, Relative Gap = -0.000230
  *** CONVERGED (small negative gap: -11.06 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 19
Total Time: 53527.27s
Converged: True
Final Lower Bound: 48151.1296
Final Upper Bound: 48140.0651
Final Gap: -11.064568
Number of Critical Scenarios: 19
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 5, 7, 8] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 4 customers  Mode 1: 4 customers  Mode 2: 42 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 19
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-04 00:37:32
Total Time: 53527.27s
Optimal Value: 48151.13
Lower Bound: 48151.13
Upper Bound: 48140.07
Gap: -11.064568
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [3, 5, 7, 8] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed15_HD_gamma20_20260104_003732.csv

Total Execution Time: 53527.59 seconds
End Time: 2026-01-04 00:37:32

All tasks completed successfully!

