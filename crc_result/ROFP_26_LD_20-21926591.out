
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 26
DI Scenario: LD
Start Time: 2026-01-03 12:17:00
================================================================================
Loading data from data/DH_data_full_seed26.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.097', '1.204'] (k=0.229)
  Product 1: ['1.000', '1.011', '1.023'] (k=0.028)
  Product 2: ['1.000', '1.006', '1.011'] (k=0.014)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1015, max=1762
  DC capacity (MC): min=419, max=830

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.89, max=34.98, count=80
  Deviation (μ̂): min=4.07, max=9.87

Costs:
  Plant fixed cost: min=5727, max=9546
  DC fixed cost: min=3464, max=5845
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.374', '1.888'] (k=0.784)
    Product 1: ['1.000', '1.468', '2.155'] (k=0.947)
    Product 2: ['1.000', '1.491', '2.223'] (k=0.985)
  MD:
    Product 0: ['1.000', '1.174', '1.378'] (k=0.396)
    Product 1: ['1.000', '1.207', '1.456'] (k=0.463)
    Product 2: ['1.000', '1.190', '1.416'] (k=0.429)
  LD:
    Product 0: ['1.000', '1.097', '1.204'] (k=0.229)
    Product 1: ['1.000', '1.011', '1.023'] (k=0.028)
    Product 2: ['1.000', '1.006', '1.011'] (k=0.014)
  Mixed:
    Product 0: ['1.000', '1.374', '1.888'] (k=0.784)
    Product 1: ['1.000', '1.207', '1.456'] (k=0.463)
    Product 2: ['1.000', '1.006', '1.011'] (k=0.014)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x16d514aa
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.08s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -349078.2786
Found heuristic solution: objective -192490.8375

Root relaxation: objective 3.809810e+04, 5230 iterations, 0.26 seconds (0.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38098.1013    0  711 -192490.84 38098.1013   120%     -    0s
H    0     0                    -190524.1492 38098.1013   120%     -    0s
H    0     0                    -187673.8941 38098.1013   120%     -    0s
     0     0 36387.7455    0 1113 -187673.89 36387.7455   119%     -    0s
H    0     0                    -181469.3808 36387.2211   120%     -    0s
H    0     0                    -170151.9177 36353.9893   121%     -    1s
H    0     0                    -157843.2177 36353.9893   123%     -    1s
     0     0 36353.9893    0 1100 -157843.22 36353.9893   123%     -    1s
     0     0 36343.0527    0 1120 -157843.22 36343.0527   123%     -    1s
     0     0 36336.6430    0 1123 -157843.22 36336.6430   123%     -    1s
     0     0 36335.2388    0 1123 -157843.22 36335.2388   123%     -    1s
     0     0 36334.0045    0 1121 -157843.22 36334.0045   123%     -    1s
     0     0 36333.9325    0 1125 -157843.22 36333.9325   123%     -    1s
     0     0 34366.4840    0 1231 -157843.22 34366.4840   122%     -    2s
H    0     0                    -157104.7562 34366.4564   122%     -    2s
     0     0 33894.0286    0 1224 -157104.76 33894.0286   122%     -    2s
     0     0 31911.1314    0 1220 -157104.76 31911.1314   120%     -    2s
     0     0 31803.2765    0 1216 -157104.76 31803.2765   120%     -    2s
     0     0 31803.2765    0 1214 -157104.76 31803.2765   120%     -    2s
H    0     0                    -120099.8495 31513.4342   126%     -    4s
H    0     0                    -119084.0936 29857.6519   125%     -    4s
H    0     0                    -82530.13091 29857.6519   136%     -    4s
H    0     0                    -66139.98807 29857.6519   145%     -    4s
H    0     0                    -62756.61086 29857.6519   148%     -    4s
     0     0 29857.6519    0 1244 -62756.611 29857.6519   148%     -    4s
     0     0 29128.1775    0 1267 -62756.611 29128.1775   146%     -    4s
     0     0 29045.5248    0 1411 -62756.611 29045.5248   146%     -    4s
     0     0 28958.6000    0 1283 -62756.611 28958.6000   146%     -    4s
     0     0 28958.6000    0 1402 -62756.611 28958.6000   146%     -    4s
     0     0 28958.6000    0 1408 -62756.611 28958.6000   146%     -    4s
H    0     0                    -44535.50646 26867.9483   160%     -    7s
H    0     0                    -43215.98872 26867.9483   162%     -    7s
H    0     0                    -33628.52091 26867.9483   180%     -    7s
H    0     0                    -33444.26016 26867.9483   180%     -    7s
H    0     0                    -25750.30777 26867.9483   204%     -    7s
H    0     0                    -13599.45081 26867.9483   298%     -    7s
H    0     0                    -12968.84622 26867.9483   307%     -    7s
     0     0 26867.9483    0 1451 -12968.846 26867.9483   307%     -    7s
     0     0 26839.8071    0 1450 -12968.846 26839.8071   307%     -    7s
     0     2 26839.8071    0 1450 -12968.846 26839.8071   307%     -    8s
     3     8 26839.8071    2 1168 -12968.846 26839.8071   307%  4269   10s
    31    64 26043.4783    5  845 -12968.846 26839.8071   307%  3309   16s
H  380   407                    -12934.03614 26033.1320   301%   767   18s
H  405   407                    -12720.80894 26033.1320   305%   758   18s
H  536   576                    -12657.59450 26033.1320   306%   685   19s
H  571   576                    -12415.41565 26033.1320   310%   673   19s
   575   644 12090.2352   18  727 -12415.416 26033.1320   310%   673   20s
H  647   695                    -11245.14131 26033.1320   332%   652   20s
H  810   810                    -11165.50934 26012.5765   333%   638   21s
H  923   960                    -11134.56616 26012.5765   334%   617   22s
H 1685  1669                    -11114.68064 25806.4019   332%   480   24s
  1830  1845 10390.2773   12  574 -11114.681 25806.4019   332%   460   25s
H 2189  1804                    -5196.307988 25806.4019   597%   425   26s
H 2269  1992                    -4613.404669 25806.4019   659%   416   26s
H 2390  1965                    -3857.807499 25806.4019   769%   404   26s
H 2810  2282                    -3831.161741 25182.7488   757%   373   27s
H 2854  2278                    -3674.592353 25182.7488   785%   370   27s
H 3547  2732                    -3451.804809 24849.4704   820%   336   32s
H 3547  2730                    -3424.152182 24849.4704   826%   336   34s
  3548  2731 9365.84055   29 1450 -3424.1522 24849.4704   826%   336   39s
  3551  2733 5226.17659   34  524 -3424.1522 9787.97056   386%   335   40s
  3573  2748 2749.46139   42  636 -3424.1522 2749.46139   180%   333   45s
  3865  2706 -2469.9164   21  202 -3424.1522  382.59465   111%   336   50s
H 3938  2530                    -3387.186615  382.59465   111%   333   50s
H 3972  2377                    -3386.108301  382.59465   111%   331   50s
H 4157  2240                    -3362.450679 -1438.8107  57.2%   319   50s
* 4158  2121              39    -3361.372365 -1438.8107  57.2%   319   50s
H 4313  1978                    -3350.251964 -1439.7222  57.0%   309   50s
* 4352  1858              38    -3326.568028 -1439.7222  56.7%   306   50s
* 4404  1740              41    -3311.725664 -1439.7222  56.5%   303   50s
* 4445  1588              46    -3263.131020 -1451.1253  55.5%   300   50s
* 4494  1481              47    -3230.742122 -1451.1253  55.1%   297   50s
H 4549  1329                    -2710.549993 -1454.4690  46.3%   294   50s
H 4607  1227                    -2149.854042 -1485.7238  30.9%   291   51s
H 4612  1146                    -2086.834699 -1488.3547  28.7%   291   51s
H 4656  1089                    -2049.043769 -1667.9750  18.6%   288   51s
H 4662  1016                    -2037.027250 -1669.5965  18.0%   288   51s
H 4985   987                    -2022.440282 -1675.7528  17.1%   271   51s
H 5235   915                    -1927.719509 -1688.5729  12.4%   259   52s
H 5241   852                    -1926.920524 -1688.5729  12.4%   258   52s
* 5463   741              71    -1905.203855 -1688.5729  11.4%   249   52s
* 5971   622              65    -1888.417356 -1688.5729  10.6%   230   52s
* 6215   489              67    -1877.188647 -1744.1796  7.09%   222   52s
* 6300   391              75    -1875.783540 -1744.1796  7.02%   219   52s
* 6369   368              80    -1864.899794 -1744.1796  6.47%   217   52s
* 6372   368              81    -1802.653478 -1744.1796  3.24%   217   52s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  Projected implied bound: 11
  MIR: 169
  Flow cover: 439
  Zero half: 3
  RLT: 9
  Relax-and-lift: 115

Explored 7027 nodes (1420655 simplex iterations) in 52.50 seconds (116.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -1802.65 -1864.9 -1875.78 ... -2037.03
No other solutions better than -1802.65

Optimal solution found (tolerance 1.00e-06)
Warning: max constraint violation (1.2765e-09) exceeds tolerance
Best objective -1.802653478172e+03, best bound -1.802653478172e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 52.50s
  Master Objective (UB) = -1802.65, θ = 122948.82
  Upper Bound (UB) = -1802.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 122948.82
  [DEBUG]   ✓ Scenario 0: θ = 122948.82 ≤ Q = 122948.82 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x71293487
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x71293487
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177653e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5603186.5237
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.194501e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119450.10    0  124 5603186.52 -119450.10   102%     -    0s
H    0     0                    -85896.38814 -119450.10  39.1%     -    0s
H    0     0                    -86455.06827 -119450.10  38.2%     -    0s
H    0     0                    -89115.16964 -89115.170  0.00%     -    0s
     0     0          -    0      -89115.170 -89115.170  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 204

Explored 1 nodes (370 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -89115.2 -86455.1 -85896.4 ... 1.17765e+13
No other solutions better than -89115.2

Optimal solution found (tolerance 1.00e-06)
Best objective -8.911516964259e+04, best bound -8.911516964259e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 91634.76
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -89115.17
  [DEBUG]   S×d_nominal = 180749.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 180749.93 + -89115.17 = 91634.76
  [DEBUG]   Current θ from Master = 122948.82
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31314.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33116.71
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 31314.0535, Absolute Gap = 31314.0535, Relative Gap = 17.371089
  Not converged yet (gap = 31314.05 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0xcce9d43c
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -33116.7 (0.01s)
MIP start from previous solve produced solution with objective -33116.7 (0.01s)
Loaded MIP start from previous solve with objective -33116.7

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.29s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective -4.534500e+03, 10245 iterations, 1.40 seconds (2.93 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4534.5000    0  381 -33116.707 -4534.5000  86.3%     -    1s
H    0     0                    -31859.04422 -4534.5000  85.8%     -    1s
H    0     0                    -31645.11900 -4534.5000  85.7%     -    2s
     0     0 -9014.4872    0  817 -31645.119 -9014.4872  71.5%     -    3s
H    0     0                    -31429.76062 -9019.7649  71.3%     -    3s
     0     0 -9094.1743    0  818 -31429.761 -9094.1743  71.1%     -    3s
     0     0 -9097.7586    0  830 -31429.761 -9097.7586  71.1%     -    3s
     0     0 -9098.0337    0  831 -31429.761 -9098.0337  71.1%     -    3s
H    0     0                    -31341.02611 -14165.139  54.8%     -    5s
H    0     0                    -31250.38747 -14165.139  54.7%     -    5s
     0     0 -14165.139    0  802 -31250.387 -14165.139  54.7%     -    5s
H    0     0                    -31083.07634 -14790.117  52.4%     -    6s
H    0     0                    -31027.70438 -14790.117  52.3%     -    6s
     0     0 -14790.117    0  870 -31027.704 -14790.117  52.3%     -    6s
     0     0 -14825.841    0  811 -31027.704 -14825.841  52.2%     -    7s
     0     0 -14835.189    0  876 -31027.704 -14835.189  52.2%     -    7s
     0     0 -14836.725    0  878 -31027.704 -14836.725  52.2%     -    7s
H    0     0                    -30954.35140 -17414.031  43.7%     -   10s
H    0     0                    -30937.37106 -17414.031  43.7%     -   10s
H    0     0                    -30900.13293 -17414.031  43.6%     -   10s
     0     0 -17414.031    0  650 -30900.133 -17414.031  43.6%     -   10s
H    0     0                    -30899.62383 -17414.176  43.6%     -   10s
H    0     0                    -30893.73172 -17414.176  43.6%     -   10s
H    0     0                    -30879.08667 -17414.176  43.6%     -   10s
H    0     0                    -30878.57757 -17414.176  43.6%     -   10s
     0     0 -17701.528    0  710 -30878.578 -17701.528  42.7%     -   11s
H    0     0                    -29622.92506 -17740.961  40.1%     -   11s
H    0     0                    -29099.52415 -17740.961  39.0%     -   11s
     0     0 -17740.961    0  719 -29099.524 -17740.961  39.0%     -   11s
H    0     0                    -29053.86802 -17752.363  38.9%     -   12s
H    0     0                    -28748.94682 -17752.363  38.3%     -   12s
     0     0 -17752.363    0  657 -28748.947 -17752.363  38.3%     -   12s
H    0     0                    -28545.57509 -17755.642  37.8%     -   12s
     0     0 -17755.642    0  666 -28545.575 -17755.642  37.8%     -   12s
     0     0 -19280.426    0  855 -28545.575 -19280.426  32.5%     -   16s
     0     0 -19731.980    0  852 -28545.575 -19731.980  30.9%     -   17s
     0     0 -19814.926    0  852 -28545.575 -19814.926  30.6%     -   18s
     0     0 -19824.282    0  853 -28545.575 -19824.282  30.6%     -   18s
     0     0 -19826.175    0  864 -28545.575 -19826.175  30.5%     -   18s
     0     0 -20289.705    0  665 -28545.575 -20289.705  28.9%     -   20s
     0     0 -20289.705    0  665 -28545.575 -20289.705  28.9%     -   20s
H    0     0                    -28529.40029 -20290.025  28.9%     -   21s
H    0     0                    -28514.24613 -20290.025  28.8%     -   21s
     0     0 -20395.123    0  738 -28514.246 -20395.123  28.5%     -   21s
     0     0 -20424.795    0  683 -28514.246 -20424.795  28.4%     -   22s
     0     0 -20435.413    0  689 -28514.246 -20435.413  28.3%     -   22s
     0     0 -20435.761    0  754 -28514.246 -20435.761  28.3%     -   22s
     0     0 -20663.220    0  813 -28514.246 -20663.220  27.5%     -   24s
     0     0 -20722.025    0  719 -28514.246 -20722.025  27.3%     -   25s
     0     0 -20733.749    0  784 -28514.246 -20733.749  27.3%     -   25s
     0     0 -20739.118    0  814 -28514.246 -20739.118  27.3%     -   25s
     0     0 -20845.984    0  662 -28514.246 -20845.984  26.9%     -   27s
     0     0 -20881.644    0  725 -28514.246 -20881.644  26.8%     -   27s
     0     0 -20889.002    0  726 -28514.246 -20889.002  26.7%     -   28s
     0     0 -20924.849    0  675 -28514.246 -20924.849  26.6%     -   28s
     0     0 -20935.255    0  753 -28514.246 -20935.255  26.6%     -   30s
     0     0 -20942.843    0  609 -28514.246 -20942.843  26.6%     -   30s
     0     0 -20948.873    0  679 -28514.246 -20948.873  26.5%     -   30s
     0     0 -20994.225    0  737 -28514.246 -20994.225  26.4%     -   31s
     0     0 -21005.998    0  744 -28514.246 -21005.998  26.3%     -   31s
     0     0 -21009.905    0  685 -28514.246 -21009.905  26.3%     -   32s
     0     0 -21032.889    0  757 -28514.246 -21032.889  26.2%     -   33s
     0     0 -21032.950    0  757 -28514.246 -21032.950  26.2%     -   33s
     0     2 -21033.098    0  757 -28514.246 -21033.098  26.2%     -   37s
     3     8 -21621.397    2  563 -28514.246 -21242.243  25.5%  1847   40s
   191   221 -22053.423   10  311 -28514.246 -21922.420  23.1%   494   45s
   256   290 -22077.151   12  294 -28514.246 -21922.420  23.1%   504   51s
   649   565 -22745.924   16  272 -28514.246 -21922.420  23.1%   418   55s
  1101   894 -24785.151   22  180 -28514.246 -22011.085  22.8%   386   60s
  1747  1179 -27748.464   44   58 -28514.246 -22125.017  22.4%   326   65s
  2248  1334     cutoff   14      -28514.246 -22257.830  21.9%   333   70s
  2853  1478     cutoff   13      -28514.246 -22834.611  19.9%   336   75s
  3298  1619 -24483.909   13  260 -28514.246 -22947.945  19.5%   344   80s
  3856  1717 -25427.844    9  200 -28514.246 -23160.475  18.8%   348   85s
  4604  1781 -25434.745   11  285 -28514.246 -23422.219  17.9%   354   91s
  5056  1876 -27406.756   11  274 -28514.246 -23546.695  17.4%   357   95s
  6146  1948 -27070.700   13  169 -28514.246 -24012.960  15.8%   359  100s
  6915  1875     cutoff   15      -28514.246 -24282.487  14.8%   369  105s
  7922  1784     cutoff   15      -28514.246 -24776.745  13.1%   376  111s
  8498  1840 -27365.159    9   98 -28514.246 -24841.183  12.9%   375  116s
  9151  1949 -26862.503   13   87 -28514.246 -25136.895  11.8%   370  121s
  9735  1950 -25966.588   17  757 -28514.246 -25162.829  11.8%   363  145s
  9738  1952 -26253.008   13  656 -28514.246 -25162.829  11.8%   363  152s
  9741  1954 -28210.945   22  697 -28514.246 -25162.829  11.8%   363  155s
  9746  1957 -26872.185   18  804 -28514.246 -25162.829  11.8%   363  160s
  9751  1961 -27266.555   36  802 -28514.246 -25162.829  11.8%   363  165s
  9754  1963 -27290.106   14  842 -28514.246 -25162.829  11.8%   363  170s
  9757  1965 -28044.543   30  780 -28514.246 -25162.829  11.8%   362  178s
  9758  1965 -26626.533   17  780 -28514.246 -25162.829  11.8%   362  181s
  9765  1979 -25162.829   16  562 -28514.246 -25162.829  11.8%   367  185s
  9817  2022 -25162.829   19  420 -28514.246 -25162.829  11.8%   374  190s
 10021  2034 -27233.063   23  241 -28514.246 -25162.829  11.8%   381  195s
 10431  1882 -27375.351   22  114 -28514.246 -25162.829  11.8%   387  200s
 10797  1641 -28208.351   28  221 -28514.246 -25162.829  11.8%   391  205s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 282
  Flow cover: 553
  Zero half: 11
  RLT: 10
  Relax-and-lift: 48

Explored 10889 nodes (4301377 simplex iterations) in 206.51 seconds (461.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -28514.2 -28529.4 -28545.6 ... -30893.7
No other solutions better than -28514.2

Optimal solution found (tolerance 1.00e-06)
Best objective -2.851424613430e+04, best bound -2.851424613430e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 206.52s
  Master Objective (UB) = -28514.25, θ = 94505.67
  Upper Bound (UB) = -28514.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 94505.67
  [DEBUG]   ✓ Scenario 0: θ = 94505.67 ≤ Q = 94505.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 94505.67 ≤ Q = 94505.67 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x46d7a298
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x46d7a298
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.059696e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.00s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 4805258.2501
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.257813e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -125781.34    0  127 4805258.25 -125781.34   103%     -    0s
H    0     0                    -89855.37497 -125781.34  40.0%     -    0s
H    0     0                    -90519.68085 -125781.34  39.0%     -    0s
H    0     0                    -103863.8104 -125781.34  21.1%     -    0s
     0     0 -114033.07    0   68 -103863.81 -114033.07  9.79%     -    0s
H    0     0                    -111985.6076 -113949.61  1.75%     -    0s
     0     0 -113708.44    0   70 -111985.61 -113708.44  1.54%     -    0s
     0     0 -113695.32    0   70 -111985.61 -113695.32  1.53%     -    0s
     0     0 -113190.71    0   53 -111985.61 -113190.71  1.08%     -    0s
H    0     0                    -112439.9335 -113189.03  0.67%     -    0s
H    0     0                    -112519.8649 -113171.36  0.58%     -    0s
     0     0 -113171.36    0   43 -112519.86 -113171.36  0.58%     -    0s
     0     0 -113165.87    0   43 -112519.86 -113165.87  0.57%     -    0s
     0     0 -112792.72    0   36 -112519.86 -112792.72  0.24%     -    0s
     0     0 -112768.49    0   25 -112519.86 -112768.49  0.22%     -    0s
     0     0 -112767.17    0   24 -112519.86 -112767.17  0.22%     -    0s
     0     0 -112729.86    0   31 -112519.86 -112729.86  0.19%     -    0s
     0     0 -112722.61    0   29 -112519.86 -112722.61  0.18%     -    0s
     0     0 -112713.43    0   28 -112519.86 -112713.43  0.17%     -    0s
     0     0 -112697.81    0   15 -112519.86 -112697.81  0.16%     -    0s
     0     0 -112668.54    0   18 -112519.86 -112668.54  0.13%     -    0s
     0     0 -112663.80    0   23 -112519.86 -112663.80  0.13%     -    0s
     0     0 -112644.51    0   10 -112519.86 -112644.51  0.11%     -    0s
     0     0 -112644.51    0   20 -112519.86 -112644.51  0.11%     -    0s
H    0     0                    -112553.1842 -112644.51  0.08%     -    0s
     0     0 -112626.63    0    3 -112553.18 -112626.63  0.07%     -    0s
H    0     0                    -112604.0469 -112622.58  0.02%     -    0s
     0     0 -112615.08    0    2 -112604.05 -112615.08  0.01%     -    0s
*    0     0               0    -112613.5646 -112613.56  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 13
  Flow cover: 13
  RLT: 1
  Relax-and-lift: 8

Explored 1 nodes (790 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -112614 -112604 -112553 ... -89855.4
No other solutions better than -112614

Optimal solution found (tolerance 1.00e-06)
Best objective -1.126135646063e+05, best bound -1.126135646063e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 73911.15
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112613.56
  [DEBUG]   S×d_nominal = 186524.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186524.71 + -112613.56 = 73911.15
  [DEBUG]   Current θ from Master = 94505.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20594.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -49108.77
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 4602.4608, Absolute Gap = 4602.4608, Relative Gap = 0.161409
  Not converged yet (gap = 4602.46 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0x90138908
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -49108.8 (0.02s)
Loaded MIP start from previous solve with objective -49108.8

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.44s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31122   -1.4928722e+04   0.000000e+00   4.636208e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22265   -1.3221039e+04   0.000000e+00   0.000000e+00      8s

Root relaxation: objective -1.322104e+04, 22265 iterations, 7.94 seconds (14.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13221.039    0  389 -49108.767 -13221.039  73.1%     -    8s
H    0     0                    -47848.83169 -13221.039  72.4%     -    8s
H    0     0                    -47762.62592 -13221.039  72.3%     -    8s
H    0     0                    -45346.34892 -13221.039  70.8%     -    8s
H    0     0                    -40032.87824 -13221.039  67.0%     -    9s
H    0     0                    -39659.26167 -13221.039  66.7%     -    9s
H    0     0                    -39611.92092 -13221.039  66.6%     -    9s
H    0     0                    -35908.96573 -16589.476  53.8%     -   13s
H    0     0                    -34363.65991 -16589.476  51.7%     -   13s
     0     0 -17041.626    0  461 -34363.660 -17041.626  50.4%     -   13s
     0     0 -17041.626    0  459 -34363.660 -17041.626  50.4%     -   14s
     0     0 -17042.922    0  454 -34363.660 -17042.922  50.4%     -   14s
     0     0 -17043.207    0  452 -34363.660 -17043.207  50.4%     -   15s
     0     0 -18806.367    0  551 -34363.660 -18806.367  45.3%     -   18s
H    0     0                    -30364.08372 -18806.367  38.1%     -   18s
H    0     0                    -30190.35301 -18806.367  37.7%     -   18s
H    0     0                    -30186.31379 -18806.367  37.7%     -   18s
H    0     0                    -30186.06910 -18806.367  37.7%     -   18s
H    0     0                    -30177.71999 -18806.367  37.7%     -   18s
     0     0 -18927.639    0  551 -30177.720 -18927.639  37.3%     -   19s
     0     0 -18956.058    0  548 -30177.720 -18956.058  37.2%     -   20s
     0     0 -18990.678    0  554 -30177.720 -18990.678  37.1%     -   20s
     0     0 -19001.190    0  549 -30177.720 -19001.190  37.0%     -   21s
     0     0 -19001.666    0  551 -30177.720 -19001.666  37.0%     -   21s
     0     0 -19882.006    0  493 -30177.720 -19882.006  34.1%     -   26s
H    0     0                    -29834.97852 -19882.077  33.4%     -   26s
H    0     0                    -29812.49709 -19882.077  33.3%     -   26s
H    0     0                    -29766.17018 -19882.077  33.2%     -   26s
H    0     0                    -29758.63315 -19882.077  33.2%     -   26s
H    0     0                    -29743.47899 -19882.077  33.2%     -   26s
     0     0 -20081.340    0  618 -29743.479 -20081.340  32.5%     -   27s
H    0     0                    -29740.78310 -20264.470  31.9%     -   29s
H    0     0                    -29693.72633 -20264.470  31.8%     -   29s
H    0     0                    -29679.30204 -20264.470  31.7%     -   29s
     0     0 -20264.470    0  568 -29679.302 -20264.470  31.7%     -   29s
     0     0 -20306.888    0  534 -29679.302 -20306.888  31.6%     -   29s
     0     0 -20330.319    0  530 -29679.302 -20330.319  31.5%     -   30s
     0     0 -20334.231    0  522 -29679.302 -20334.231  31.5%     -   30s
     0     0 -20335.202    0  518 -29679.302 -20335.202  31.5%     -   30s
     0     0 -20336.132    0  521 -29679.302 -20336.132  31.5%     -   30s
     0     0 -20336.343    0  578 -29679.302 -20336.343  31.5%     -   30s
H    0     0                    -29544.57263 -20336.343  31.2%     -   33s
H    0     0                    -29384.42536 -20336.343  30.8%     -   33s
H    0     0                    -29330.26584 -20336.343  30.7%     -   33s
H    0     0                    -29302.31842 -20336.343  30.6%     -   33s
H    0     0                    -29266.64467 -20336.343  30.5%     -   33s
     0     0 -20797.683    0  602 -29266.645 -20797.683  28.9%     -   36s
H    0     0                    -29247.79636 -20798.048  28.9%     -   36s
     0     0 -21099.756    0  631 -29247.796 -21099.756  27.9%     -   38s
     0     0 -21229.535    0  605 -29247.796 -21229.535  27.4%     -   39s
     0     0 -21324.830    0  600 -29247.796 -21324.830  27.1%     -   40s
     0     0 -21335.978    0  602 -29247.796 -21335.978  27.1%     -   40s
     0     0 -21341.455    0  665 -29247.796 -21341.455  27.0%     -   41s
     0     0 -21343.308    0  670 -29247.796 -21343.308  27.0%     -   41s
     0     0 -21343.718    0  665 -29247.796 -21343.718  27.0%     -   41s
     0     0 -21530.227    0  678 -29247.796 -21530.227  26.4%     -   44s
     0     0 -21585.411    0  629 -29247.796 -21585.411  26.2%     -   44s
     0     0 -21597.029    0  706 -29247.796 -21597.029  26.2%     -   45s
     0     0 -21598.434    0  706 -29247.796 -21598.434  26.2%     -   45s
     0     0 -21598.771    0  704 -29247.796 -21598.771  26.2%     -   45s
     0     0 -21680.955    0  701 -29247.796 -21680.955  25.9%     -   46s
     0     0 -21708.486    0  713 -29247.796 -21708.486  25.8%     -   47s
     0     0 -21715.978    0  706 -29247.796 -21715.978  25.8%     -   47s
     0     0 -21717.067    0  713 -29247.796 -21717.067  25.7%     -   47s
     0     0 -21759.385    0  717 -29247.796 -21759.385  25.6%     -   49s
     0     0 -21778.319    0  719 -29247.796 -21778.319  25.5%     -   50s
     0     0 -21782.236    0  707 -29247.796 -21782.236  25.5%     -   50s
     0     0 -21784.366    0  712 -29247.796 -21784.366  25.5%     -   50s
     0     0 -21787.095    0  721 -29247.796 -21787.095  25.5%     -   51s
     0     0 -21787.697    0  726 -29247.796 -21787.697  25.5%     -   51s
     0     0 -21814.167    0  652 -29247.796 -21814.167  25.4%     -   52s
     0     0 -21821.797    0  606 -29247.796 -21821.797  25.4%     -   53s
     0     0 -21826.755    0  610 -29247.796 -21826.755  25.4%     -   53s
     0     0 -21829.840    0  732 -29247.796 -21829.840  25.4%     -   53s
     0     0 -21830.233    0  731 -29247.796 -21830.233  25.4%     -   53s
     0     0 -21840.171    0  618 -29247.796 -21840.171  25.3%     -   54s
     0     0 -21841.845    0  627 -29247.796 -21841.845  25.3%     -   55s
     0     0 -21843.548    0  617 -29247.796 -21843.548  25.3%     -   55s
     0     0 -21843.732    0  614 -29247.796 -21843.732  25.3%     -   55s
     0     0 -21916.788    0  658 -29247.796 -21916.788  25.1%     -   56s
     0     0 -21923.877    0  613 -29247.796 -21923.877  25.0%     -   57s
     0     0 -21929.137    0  607 -29247.796 -21929.137  25.0%     -   57s
H    0     0                    -29083.50393 -21930.869  24.6%     -   57s
H    0     0                    -29068.34978 -21930.869  24.6%     -   57s
     0     0 -21930.869    0  720 -29068.350 -21930.869  24.6%     -   57s
     0     0 -21932.582    0  719 -29068.350 -21932.582  24.5%     -   58s
     0     0 -21933.322    0  612 -29068.350 -21933.322  24.5%     -   58s
     0     0 -21945.944    0  721 -29068.350 -21945.944  24.5%     -   59s
     0     0 -21948.970    0  727 -29068.350 -21948.970  24.5%     -   59s
H    0     0                    -29046.26957 -21949.551  24.4%     -   59s
     0     0 -21949.551    0  733 -29046.270 -21949.551  24.4%     -   59s
     0     0 -21969.598    0  677 -29046.270 -21969.598  24.4%     -   60s
     0     0 -21970.075    0  615 -29046.270 -21970.075  24.4%     -   61s
H    0     0                    -29017.37849 -21970.075  24.3%     -   61s
     0     0 -21971.934    0  616 -29017.378 -21971.934  24.3%     -   61s
H    0     0                    -28991.69156 -21974.204  24.2%     -   62s
H    0     0                    -28896.51096 -21974.204  24.0%     -   62s
H    0     0                    -28881.17276 -21974.204  23.9%     -   62s
H    0     0                    -28876.21473 -21974.204  23.9%     -   62s
     0     0 -21974.204    0  751 -28876.215 -21974.204  23.9%     -   62s
     0     0 -21974.281    0  634 -28876.215 -21974.281  23.9%     -   62s
     0     0 -21978.420    0  636 -28876.215 -21978.420  23.9%     -   63s
     0     0 -21978.591    0  636 -28876.215 -21978.591  23.9%     -   63s
     0     2 -21978.652    0  636 -28876.215 -21978.652  23.9%     -   73s
     3     8 -22151.131    2  637 -28876.215 -21997.104  23.8%   835   76s
    15    32 -22328.223    4  643 -28876.215 -22151.650  23.3%  1469   81s
    63    96 -22533.481    6  714 -28876.215 -22287.156  22.8%  1977   86s
   168   237 -23160.645    8  457 -28876.215 -22287.329  22.8%  1450   91s
   293   288 -22887.349    9  708 -28876.215 -22364.142  22.6%  1126   96s
   389   350 -22919.935   10  705 -28876.215 -22364.142  22.6%  1139  100s
   499   428 -23192.662   11  756 -28876.215 -22364.142  22.6%  1138  106s
   615   508 -23569.609   13  703 -28876.215 -22386.253  22.5%  1108  112s
   674   548 -23814.221   14  718 -28876.215 -22546.602  21.9%  1110  115s
   790   629 -23914.823   15  733 -28876.215 -22546.602  21.9%  1107  121s
   914   709 -23929.603   16  724 -28876.215 -22893.514  20.7%  1093  128s
   975   758 -24788.735   17  639 -28876.215 -22916.210  20.6%  1102  131s
  1133   854 -25182.602   19  579 -28876.215 -22918.660  20.6%  1062  138s
  1226   898 -25197.370   20  579 -28876.215 -22943.272  20.5%  1032  141s
  1321   951 -25364.890   21  572 -28876.215 -22943.272  20.5%  1014  145s
  1498  1057 -25681.961   22  501 -28876.215 -22943.272  20.5%  1008  152s
  1633  1096 -27308.517   23  474 -28876.215 -23028.162  20.3%   978  155s
  1906  1268 -27408.350   25  383 -28876.215 -23046.627  20.2%   943  163s
  2067  1362 -27868.424   28  178 -28876.215 -23046.627  20.2%   916  168s
  2243  1438 -28308.828   35  184 -28876.215 -23068.426  20.1%   894  172s
  2395  1504     cutoff   46      -28876.215 -23068.426  20.1%   870  177s
  2571  1550 -24718.627   11  338 -28876.215 -23168.120  19.8%   861  183s
  2719  1603 -25161.451   13  339 -28876.215 -23232.041  19.5%   862  190s
  2992  1674 infeasible   16      -28876.215 -23252.573  19.5%   874  199s
  3131  1725 -26775.346   17  402 -28876.215 -23302.999  19.3%   878  204s
  3310  1737     cutoff   23      -28876.215 -23302.999  19.3%   878  209s
  3433  1782 infeasible   24      -28876.215 -23302.999  19.3%   879  214s
  3556  1827 -24237.108    9  385 -28876.215 -23302.999  19.3%   883  219s
H 3601  1827                    -28860.22571 -23302.999  19.3%   884  219s
  3706  1881 -25037.627   10  313 -28860.226 -23473.619  18.7%   888  223s
  3871  1963 -27272.168   17  246 -28860.226 -23473.619  18.7%   894  230s
  4115  1966     cutoff   36      -28860.226 -23505.156  18.6%   886  238s
H 4121  1966                    -28858.56096 -23507.193  18.5%   888  238s
H 4127  1963                    -28831.84122 -23507.193  18.5%   887  238s
H 4136  1963                    -28829.74260 -23507.193  18.5%   887  238s
H 4154  1963                    -28827.78763 -23555.349  18.3%   886  238s
H 4161  1948                    -28789.47884 -23555.349  18.2%   887  238s
  4214  1975 infeasible   10      -28789.479 -23638.171  17.9%   891  244s
  4395  2004 -25650.981   17  480 -28789.479 -23638.171  17.9%   902  250s
  4584  2039 -26403.962   19  451 -28789.479 -23638.171  17.9%   913  255s
  4828  2048 -28410.381   28  150 -28789.479 -23831.883  17.2%   915  261s
  5038  2050 -28123.676   12  384 -28789.479 -23875.432  17.1%   923  269s
H 5039  2044                    -28771.31321 -23875.432  17.0%   923  269s
  5112  2052 -28264.068   13  385 -28771.313 -23932.881  16.8%   932  276s
  5382  2075 -27106.635   13  369 -28771.313 -24191.241  15.9%   934  282s
  5671  2111 -26355.074   16  263 -28771.313 -24205.989  15.9%   934  288s
  5972  2135 -27224.437   20  173 -28771.313 -24205.989  15.9%   933  295s
  6095  2153     cutoff   22      -28771.313 -24417.509  15.1%   928  301s
  6375  2177 -27356.715   11  368 -28771.313 -24417.509  15.1%   922  309s
  6702  2178     cutoff   11      -28771.313 -24619.923  14.4%   917  316s
  6990  2183 -27643.067   13  396 -28771.313 -24752.094  14.0%   921  323s
  7352  2199     cutoff   18      -28771.313 -24853.550  13.6%   918  332s
  7709  2166     cutoff   14      -28771.313 -25000.139  13.1%   922  340s
  8061  2151 infeasible   11      -28771.313 -25043.241  13.0%   925  349s
  8187  2100     cutoff   11      -28771.313 -25225.532  12.3%   928  358s
  8481  2051     cutoff   16      -28771.313 -25303.138  12.1%   928  367s
  8846  1962 -27270.958   22  370 -28771.313 -25437.937  11.6%   932  377s
  9210  1868 -26575.597   14  272 -28771.313 -25640.705  10.9%   933  386s
  9594  1804     cutoff   44      -28771.313 -25887.295  10.0%   934  394s
 10076  1683     cutoff   16      -28771.313 -25972.116  9.73%   925  408s
 10721  1442     cutoff   18      -28771.313 -26259.614  8.73%   910  416s
 11465  1208 -28281.330   13  264 -28771.313 -26644.867  7.39%   890  425s
 12581   703 -27784.867   23  164 -28771.313 -27038.395  6.02%   851  434s
 14201     6     cutoff   34      -28771.313 -27607.569  4.04%   789  441s

Cutting planes:
  Gomory: 1
  Implied bound: 10
  MIR: 480
  Flow cover: 1145
  Zero half: 12
  RLT: 34
  Relax-and-lift: 60

Explored 15693 nodes (11605927 simplex iterations) in 441.27 seconds (1234.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -28771.3 -28789.5 -28827.8 ... -28896.5
No other solutions better than -28771.3

Optimal solution found (tolerance 1.00e-06)
Best objective -2.877131320902e+04, best bound -2.877131320902e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 441.35s
  Master Objective (UB) = -28771.31, θ = 95228.73
  Upper Bound (UB) = -28771.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 95228.73
  [DEBUG]   ✓ Scenario 0: θ = 95228.73 ≤ Q = 95228.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 95228.73 ≤ Q = 95228.73 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 95228.73 ≤ Q = 95228.73 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x385c7db1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc7a3824f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.050071e+13
Presolve removed 2607 rows and 1902 columns
Presolve time: 0.00s
Presolved: 486 rows, 487 columns, 1369 nonzeros
Found heuristic solution: objective 4835069.0464
Variable types: 327 continuous, 160 integer (160 binary)

Root relaxation: objective -1.245537e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124553.70    0  127 4835069.05 -124553.70   103%     -    0s
H    0     0                    -90282.95524 -124553.70  38.0%     -    0s
H    0     0                    -91623.76635 -124553.70  35.9%     -    0s
H    0     0                    -104856.1321 -124553.70  18.8%     -    0s
     0     0 -115172.65    0   80 -104856.13 -115172.65  9.84%     -    0s
H    0     0                    -113828.0181 -115094.18  1.11%     -    0s
     0     0 -115094.18    0   81 -113828.02 -115094.18  1.11%     -    0s
     0     0 -114757.26    0   78 -113828.02 -114757.26  0.82%     -    0s
H    0     0                    -114242.2371 -114638.07  0.35%     -    0s
     0     0 -114638.07    0   38 -114242.24 -114638.07  0.35%     -    0s
     0     0 -114532.78    0   47 -114242.24 -114532.78  0.25%     -    0s
     0     0 -114525.14    0   40 -114242.24 -114525.14  0.25%     -    0s
     0     0 -114513.56    0   39 -114242.24 -114513.56  0.24%     -    0s
     0     0 -114504.19    0   36 -114242.24 -114504.19  0.23%     -    0s
     0     0 -114500.07    0   35 -114242.24 -114500.07  0.23%     -    0s
     0     0 -114498.79    0   35 -114242.24 -114498.79  0.22%     -    0s
     0     0 -114346.69    0    7 -114242.24 -114346.69  0.09%     -    0s
     0     0 -114346.69    0    9 -114242.24 -114346.69  0.09%     -    0s
H    0     0                    -114292.5928 -114346.69  0.05%     -    0s
     0     0 -114333.20    0    3 -114292.59 -114333.20  0.04%     -    0s
H    0     0                    -114323.9450 -114329.69  0.01%     -    0s
*    0     0               0    -114328.0752 -114328.08  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 3
  Flow cover: 4
  Relax-and-lift: 3

Explored 1 nodes (722 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -114328 -114324 -114293 ... 4.83507e+06
No other solutions better than -114328

Optimal solution found (tolerance 1.00e-06)
Best objective -1.143280751628e+05, best bound -1.143280751628e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 70793.08
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114328.08
  [DEBUG]   S×d_nominal = 185121.16
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 185121.16 + -114328.08 = 70793.08
  [DEBUG]   Current θ from Master = 95228.73
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24435.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -53206.96
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 4345.3937, Absolute Gap = 4345.3937, Relative Gap = 0.151032
  Not converged yet (gap = 4345.39 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0xd5cd00d0
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -53207 (0.02s)
Loaded MIP start from previous solve with objective -53207

Presolve removed 28280 rows and 11480 columns
Presolve time: 0.53s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33856   -2.9878908e+04   0.000000e+00   3.296550e+06      5s
Concurrent spin time: 0.03s

Solved with dual simplex

Root relaxation: objective -1.386217e+04, 26459 iterations, 8.76 seconds (17.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13862.175    0  398 -53206.958 -13862.175  73.9%     -    9s
H    0     0                    -53177.54808 -13862.175  73.9%     -    9s
H    0     0                    -53004.88932 -13862.175  73.8%     -    9s
H    0     0                    -52953.39538 -13862.175  73.8%     -    9s
H    0     0                    -47659.68746 -13862.175  70.9%     -    9s
H    0     0                    -44078.38790 -13862.175  68.6%     -    9s
H    0     0                    -41750.68970 -13862.175  66.8%     -    9s
H    0     0                    -39199.66726 -13862.175  64.6%     -    9s
H    0     0                    -37183.78291 -13862.175  62.7%     -    9s
H    0     0                    -37179.31038 -13862.175  62.7%     -    9s
H    0     0                    -37171.66820 -13862.175  62.7%     -   10s
     0     0 -17507.593    0  461 -37171.668 -17507.593  52.9%     -   17s
     0     0 -17507.593    0  460 -37171.668 -17507.593  52.9%     -   18s
     0     0 -17507.593    0  455 -37171.668 -17507.593  52.9%     -   18s
     0     0 -17507.593    0  455 -37171.668 -17507.593  52.9%     -   18s
     0     0 -19530.996    0  540 -37171.668 -19530.996  47.5%     -   24s
H    0     0                    -34883.84731 -19531.005  44.0%     -   24s
H    0     0                    -34878.99193 -19531.005  44.0%     -   24s
     0     0 -19640.458    0  589 -34878.992 -19640.458  43.7%     -   26s
     0     0 -19726.073    0  540 -34878.992 -19726.073  43.4%     -   26s
H    0     0                    -30899.54576 -19749.360  36.1%     -   27s
H    0     0                    -30891.90358 -19749.360  36.1%     -   27s
     0     0 -19749.360    0  542 -30891.904 -19749.360  36.1%     -   27s
     0     0 -19760.781    0  542 -30891.904 -19760.781  36.0%     -   27s
     0     0 -19761.005    0  546 -30891.904 -19761.005  36.0%     -   27s
H    0     0                    -30729.59454 -20985.893  31.7%     -   35s
H    0     0                    -30376.02046 -20985.893  30.9%     -   35s
H    0     0                    -30363.51274 -20985.893  30.9%     -   35s
H    0     0                    -30336.24420 -20985.893  30.8%     -   35s
H    0     0                    -30306.44466 -20985.893  30.8%     -   35s
     0     0 -20985.893    0  528 -30306.445 -20985.893  30.8%     -   35s
H    0     0                    -29928.72037 -20986.200  29.9%     -   35s
H    0     0                    -29875.07908 -20986.200  29.8%     -   35s
H    0     0                    -29851.81028 -20986.200  29.7%     -   35s
H    0     0                    -29810.05533 -20986.200  29.6%     -   35s
H    0     0                    -29809.37618 -20986.200  29.6%     -   35s
     0     0 -21429.772    0  523 -29809.376 -21429.772  28.1%     -   38s
     0     0 -21649.875    0  655 -29809.376 -21649.875  27.4%     -   40s
     0     0 -21735.561    0  586 -29809.376 -21735.561  27.1%     -   41s
     0     0 -21830.554    0  592 -29809.376 -21830.554  26.8%     -   42s
     0     0 -21871.681    0  603 -29809.376 -21871.681  26.6%     -   43s
     0     0 -21880.082    0  608 -29809.376 -21880.082  26.6%     -   43s
     0     0 -21880.264    0  607 -29809.376 -21880.264  26.6%     -   43s
     0     0 -22486.074    0  667 -29809.376 -22486.074  24.6%     -   49s
H    0     0                    -29750.96253 -22486.332  24.4%     -   49s
     0     0 -22649.939    0  695 -29750.963 -22649.939  23.9%     -   52s
     0     0 -22738.233    0  705 -29750.963 -22738.233  23.6%     -   54s
     0     0 -22765.650    0  703 -29750.963 -22765.650  23.5%     -   55s
     0     0 -22777.687    0  714 -29750.963 -22777.687  23.4%     -   55s
     0     0 -22784.142    0  713 -29750.963 -22784.142  23.4%     -   56s
     0     0 -22788.574    0  714 -29750.963 -22788.574  23.4%     -   56s
     0     0 -22789.145    0  723 -29750.963 -22789.145  23.4%     -   56s
     0     0 -22891.308    0  747 -29750.963 -22891.308  23.1%     -   58s
H    0     0                    -29749.74607 -22891.526  23.1%     -   59s
     0     0 -22919.687    0  721 -29749.746 -22919.687  23.0%     -   59s
     0     0 -22932.344    0  714 -29749.746 -22932.344  22.9%     -   60s
     0     0 -22934.535    0  721 -29749.746 -22934.535  22.9%     -   60s
     0     0 -22936.378    0  717 -29749.746 -22936.378  22.9%     -   60s
     0     0 -22936.573    0  723 -29749.746 -22936.573  22.9%     -   60s
     0     0 -23058.827    0  753 -29749.746 -23058.827  22.5%     -   63s
     0     0 -23088.148    0  701 -29749.746 -23088.148  22.4%     -   65s
     0     0 -23094.967    0  709 -29749.746 -23094.967  22.4%     -   66s
H    0     0                    -29701.36933 -23098.549  22.2%     -   66s
     0     0 -23098.549    0  774 -29701.369 -23098.549  22.2%     -   66s
     0     0 -23101.965    0  773 -29701.369 -23101.965  22.2%     -   66s
     0     0 -23103.185    0  778 -29701.369 -23103.185  22.2%     -   67s
     0     0 -23123.591    0  784 -29701.369 -23123.591  22.1%     -   68s
     0     0 -23126.743    0  787 -29701.369 -23126.743  22.1%     -   69s
     0     0 -23127.966    0  796 -29701.369 -23127.966  22.1%     -   69s
     0     0 -23145.219    0  755 -29701.369 -23145.219  22.1%     -   70s
     0     0 -23148.944    0  681 -29701.369 -23148.944  22.1%     -   71s
     0     0 -23151.223    0  697 -29701.369 -23151.223  22.1%     -   71s
     0     0 -23152.274    0  697 -29701.369 -23152.274  22.0%     -   72s
     0     0 -23156.731    0  765 -29701.369 -23156.731  22.0%     -   73s
     0     0 -23157.835    0  761 -29701.369 -23157.835  22.0%     -   73s
     0     0 -23162.530    0  758 -29701.369 -23162.530  22.0%     -   74s
     0     0 -23163.345    0  694 -29701.369 -23163.345  22.0%     -   75s
     0     0 -23203.304    0  759 -29701.369 -23203.304  21.9%     -   76s
     0     0 -23204.572    0  759 -29701.369 -23204.572  21.9%     -   77s
     0     0 -23208.201    0  758 -29701.369 -23208.201  21.9%     -   78s
     0     0 -23208.802    0  758 -29701.369 -23208.802  21.9%     -   79s
     0     0 -23215.908    0  768 -29701.369 -23215.908  21.8%     -   80s
     0     0 -23218.856    0  773 -29701.369 -23218.856  21.8%     -   80s
     0     0 -23219.358    0  773 -29701.369 -23219.358  21.8%     -   80s
     0     0 -23224.367    0  781 -29701.369 -23224.367  21.8%     -   81s
     0     0 -23224.469    0  781 -29701.369 -23224.469  21.8%     -   82s
     0     2 -23224.584    0  781 -29701.369 -23224.584  21.8%     -   97s
     3     8 -23277.276    2  744 -29701.369 -23248.182  21.7%  1323  101s
    15    32 -23433.316    4  738 -29701.369 -23403.146  21.2%  2964  110s
    63    94 -23708.783    6  774 -29701.369 -23466.802  21.0%  3852  117s
    95   173 -23734.351    7  772 -29701.369 -23555.822  20.7%  3036  122s
   180   250 -23743.434    8  772 -29701.369 -23555.822  20.7%  2062  127s
   299   306 -25977.279    9  544 -29701.369 -23734.703  20.1%  1816  134s
   343   338 -23838.285   10  700 -29701.369 -23734.703  20.1%  1783  139s
   390   367 -23941.847   10  774 -29701.369 -23734.703  20.1%  1755  145s
   440   394 -24835.830   11  599 -29701.369 -23734.703  20.1%  1816  151s
   495   423 -24190.255   11  718 -29701.369 -23734.703  20.1%  1848  156s
   552   455 -25797.289   12  573 -29701.369 -23846.776  19.7%  1871  161s
   606   475 -25909.453   12  514 -29701.369 -23846.776  19.7%  1896  166s
   650   518 -26005.122   13  400 -29701.369 -23885.753  19.6%  1981  170s
   713   557 -26497.412   15  265 -29701.369 -23899.210  19.5%  1966  175s
   776   589 -26239.797   16  491 -29701.369 -23899.210  19.5%  1947  182s
   846   624 -27404.545   18  240 -29701.369 -23899.210  19.5%  1904  188s
   910   659 -28831.351   19  231 -29701.369 -23899.210  19.5%  1914  194s
   971   700 -29402.330   20  201 -29701.369 -23899.210  19.5%  1900  200s
  1075   740     cutoff   26      -29701.369 -23899.210  19.5%  1806  206s
  1177   793 -26115.698    9  460 -29701.369 -23899.210  19.5%  1761  213s
  1287   852 -27191.334   10  226 -29701.369 -23899.210  19.5%  1704  219s
  1420   882 infeasible   12      -29701.369 -23988.513  19.2%  1640  225s
  1532   891 -25795.211    9  326 -29701.369 -24021.632  19.1%  1589  232s
  1629   931 -28214.090   11  281 -29701.369 -24027.715  19.1%  1596  240s
  1729   954 -29443.297   13  201 -29701.369 -24027.715  19.1%  1593  247s
  1830   991 infeasible   14      -29701.369 -24027.715  19.1%  1605  254s
  1958  1027 -28244.736    7  260 -29701.369 -24159.324  18.7%  1592  260s
  2084  1056 -29514.093   13  221 -29701.369 -24167.325  18.6%  1583  268s
  2220  1092 -24623.986    9  537 -29701.369 -24167.325  18.6%  1583  273s
  2338  1141 -28687.478   11  154 -29701.369 -24167.325  18.6%  1592  281s
  2463  1178 -26237.958   12  410 -29701.369 -24167.325  18.6%  1600  289s
  2633  1186 -28641.071   14  385 -29701.369 -24167.325  18.6%  1571  297s
  2687  1221     cutoff   15      -29701.369 -24167.325  18.6%  1569  305s
  2766  1236     cutoff   14      -29701.369 -24167.325  18.6%  1574  315s
  2901  1305 -28252.309   15  471 -29701.369 -24167.325  18.6%  1563  323s
  3074  1349 -28545.353   17  390 -29701.369 -24499.353  17.5%  1552  333s
  3241  1395 -28348.328   12  361 -29701.369 -24499.353  17.5%  1556  343s
  3423  1434 -29210.778   13  446 -29701.369 -24579.786  17.2%  1550  352s
  3602  1450 -27158.886    9  403 -29701.369 -24640.226  17.0%  1559  361s
  3774  1463 -28951.356    9  361 -29701.369 -24640.226  17.0%  1573  367s
  3823  1470 -29234.678   10  250 -29701.369 -24640.226  17.0%  1576  374s
  3876  1476 -29638.599   11  167 -29701.369 -24652.465  17.0%  1583  381s
  3942  1473     cutoff   12      -29701.369 -24775.957  16.6%  1587  392s
  4065  1500 -27756.295   14  345 -29701.369 -24775.957  16.6%  1582  400s
  4230  1539 infeasible   15      -29701.369 -24788.359  16.5%  1577  410s
  4452  1573 -29229.762   16  343 -29701.369 -24832.340  16.4%  1555  421s
  4710  1636 -28334.968    8  174 -29701.369 -25079.658  15.6%  1545  433s
  4992  1669 infeasible   10      -29701.369 -25161.458  15.3%  1535  446s
  5249  1749 -29609.302   12  263 -29701.369 -25193.259  15.2%  1537  458s
  5532  1763     cutoff   15      -29701.369 -25382.197  14.5%  1535  470s
  5766  1728     cutoff    9      -29701.369 -25445.471  14.3%  1538  484s
  6072  1695     cutoff   21      -29701.369 -25627.759  13.7%  1540  501s
  6336  1684     cutoff   26      -29701.369 -25803.271  13.1%  1549  516s
  6645  1673 -27671.602   16  638 -29701.369 -25953.904  12.6%  1552  532s
  7021  1666     cutoff   14      -29701.369 -26083.733  12.2%  1542  544s
  7317  1660 -28854.946   16  430 -29701.369 -26237.450  11.7%  1537  560s
  7736  1626 infeasible   17      -29701.369 -26420.433  11.0%  1526  572s
  8278  1594 -28300.066   15  275 -29701.369 -26620.991  10.4%  1496  586s
  8832  1548     cutoff   11      -29701.369 -26911.897  9.39%  1473  602s
  9032  1512 -29532.569   13  209 -29701.369 -27042.971  8.95%  1465  616s
  9699  1486 -29639.507   23  124 -29701.369 -27291.451  8.11%  1430  632s
 10493  1329     cutoff   27      -29701.369 -27434.523  7.63%  1388  649s
 11421  1068 -28580.238   31  478 -29701.369 -27895.015  6.08%  1337  666s
 12523   541 -29545.920   21  163 -29701.369 -28160.225  5.19%  1279  681s
 13937    32     cutoff   22      -29701.369 -28631.580  3.60%  1198  691s
 14937    21 -29646.281   35   44 -29701.369 -29490.456  0.71%  1136  704s
 15007     0     cutoff   27      -29701.369 -29578.412  0.41%  1131  707s

Cutting planes:
  Implied bound: 1
  MIR: 593
  Flow cover: 1321
  Zero half: 11
  RLT: 47
  Relax-and-lift: 70

Explored 15061 nodes (17100294 simplex iterations) in 707.67 seconds (2071.41 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -29701.4 -29749.7 -29809.4 ... -30363.5
No other solutions better than -29701.4

Optimal solution found (tolerance 1.00e-06)
Best objective -2.970136933014e+04, best bound -2.970136933014e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 707.73s
  Master Objective (UB) = -29701.37, θ = 93785.57
  Upper Bound (UB) = -29701.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93785.57
  [DEBUG]   ✓ Scenario 0: θ = 93785.57 ≤ Q = 93785.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93785.57 ≤ Q = 93785.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93785.57 ≤ Q = 93785.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93785.57 ≤ Q = 93785.57 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1f8939c2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1f8939c2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.064170e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.00s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 4915468.3331
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.187960e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118796.05    0  124 4915468.33 -118796.05   102%     -    0s
H    0     0                    -85357.47824 -118796.05  39.2%     -    0s
H    0     0                    -85710.22054 -118796.05  38.6%     -    0s
H    0     0                    -91143.26109 -118796.05  30.3%     -    0s
H    0     0                    -91787.27226 -105910.89  15.4%     -    0s
     0     0 -105910.89    0   74 -91787.272 -105910.89  15.4%     -    0s
H    0     0                    -103143.6251 -105852.92  2.63%     -    0s
     0     0 -105463.23    0   74 -103143.63 -105463.23  2.25%     -    0s
H    0     0                    -103678.5375 -105458.86  1.72%     -    0s
H    0     0                    -103692.2083 -104774.49  1.04%     -    0s
     0     0 -104774.49    0   61 -103692.21 -104774.49  1.04%     -    0s
     0     0 -104658.43    0   57 -103692.21 -104658.43  0.93%     -    0s
     0     0 -104543.83    0   60 -103692.21 -104543.83  0.82%     -    0s
     0     0 -104540.85    0   60 -103692.21 -104540.85  0.82%     -    0s
     0     0 -104183.78    0   60 -103692.21 -104183.78  0.47%     -    0s
     0     0 -104005.01    0   43 -103692.21 -104005.01  0.30%     -    0s
     0     0 -104003.01    0   41 -103692.21 -104003.01  0.30%     -    0s
     0     0 -104002.91    0   46 -103692.21 -104002.91  0.30%     -    0s
     0     0 -103848.95    0   25 -103692.21 -103848.95  0.15%     -    0s
     0     0 -103843.80    0   22 -103692.21 -103843.80  0.15%     -    0s
H    0     0                    -103726.6101 -103839.13  0.11%     -    0s
     0     0 -103822.34    0   26 -103726.61 -103822.34  0.09%     -    0s
     0     0 -103793.61    0   12 -103726.61 -103793.61  0.06%     -    0s
     0     0 -103793.61    0   17 -103726.61 -103793.61  0.06%     -    0s
H    0     0                    -103739.1555 -103793.61  0.05%     -    0s
     0     0 -103749.15    0    8 -103739.16 -103749.15  0.01%     -    0s
     0     0 -103745.82    0    6 -103739.16 -103745.82  0.01%     -    0s
     0     0 -103745.26    0    4 -103739.16 -103745.26  0.01%     -    0s
     0     0 -103745.20    0    4 -103739.16 -103745.20  0.01%     -    0s
     0     0 -103745.17    0    4 -103739.16 -103745.17  0.01%     -    0s
H    0     0                    -103744.4709 -103744.47  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 2
  MIR: 3
  Flow cover: 5
  Relax-and-lift: 5

Explored 1 nodes (904 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -103744 -103739 -103727 ... -85357.5
No other solutions better than -103744

Optimal solution found (tolerance 1.00e-06)
Best objective -1.037444709439e+05, best bound -1.037444709439e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 78557.05
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103744.47
  [DEBUG]   S×d_nominal = 182301.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 182301.52 + -103744.47 = 78557.05
  [DEBUG]   Current θ from Master = 93785.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15228.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -44929.88
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 3415.3376, Absolute Gap = 3415.3376, Relative Gap = 0.114989
  Not converged yet (gap = 3415.34 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x5f9390ba
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 0.68s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -189851.7259

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30535   -3.1341466e+04   0.000000e+00   6.538185e+09      5s
Warning: 1 variables dropped from basis
Warning: switch to quad precision
   40870   -2.2052244e+04   0.000000e+00   1.135992e+10     10s
   43532   -1.8389215e+04   0.000000e+00   4.354432e+06     15s
Concurrent spin time: 3.45s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -1.386327e+04, 34986 iterations, 17.24 seconds (28.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13863.271    0  402 -189851.73 -13863.271  92.7%     -   18s
H    0     0                    -183921.2763 -13863.271  92.5%     -   18s
H    0     0                    -57489.58423 -13863.271  75.9%     -   18s
H    0     0                    -57244.78685 -13863.271  75.8%     -   18s
H    0     0                    -57209.09638 -13863.271  75.8%     -   18s
H    0     0                    -57186.60122 -13863.271  75.8%     -   18s
H    0     0                    -39234.13401 -13863.271  64.7%     -   18s
H    0     0                    -37994.13203 -13863.271  63.5%     -   18s
H    0     0                    -37989.56359 -13863.271  63.5%     -   18s
H    0     0                    -37981.92141 -16888.700  55.5%     -   28s
     0     0 -16888.700    0  454 -37981.921 -16888.700  55.5%     -   28s
     0     0 -17841.541    0  465 -37981.921 -17841.541  53.0%     -   32s
     0     0 -17841.541    0  468 -37981.921 -17841.541  53.0%     -   33s
     0     0 -17841.541    0  471 -37981.921 -17841.541  53.0%     -   34s
     0     0 -17841.541    0  470 -37981.921 -17841.541  53.0%     -   34s
     0     0 -17841.541    0  540 -37981.921 -17841.541  53.0%     -   35s
     0     0 -17841.542    0  538 -37981.921 -17841.542  53.0%     -   35s
     0     0 -17841.542    0  538 -37981.921 -17841.542  53.0%     -   35s
H    0     0                    -37980.53233 -19541.137  48.5%     -   44s
     0     0 -19541.137    0  595 -37980.532 -19541.137  48.5%     -   44s
H    0     0                    -30913.73334 -19541.800  36.8%     -   44s
H    0     0                    -30890.51267 -19541.800  36.7%     -   44s
     0     0 -19684.967    0  598 -30890.513 -19684.967  36.3%     -   46s
     0     0 -19804.521    0  614 -30890.513 -19804.521  35.9%     -   48s
     0     0 -19888.702    0  554 -30890.513 -19888.702  35.6%     -   50s
     0     0 -19896.606    0  560 -30890.513 -19896.606  35.6%     -   51s
     0     0 -19896.906    0  556 -30890.513 -19896.906  35.6%     -   51s
H    0     0                    -30865.82528 -20962.823  32.1%     -   65s
     0     0 -20962.823    0  640 -30865.825 -20962.823  32.1%     -   65s
     0     0 -21330.739    0  598 -30865.825 -21330.739  30.9%     -   69s
     0     0 -21604.783    0  618 -30865.825 -21604.783  30.0%     -   71s
     0     0 -21618.270    0  619 -30865.825 -21618.270  30.0%     -   72s
     0     0 -21621.315    0  621 -30865.825 -21621.315  30.0%     -   72s
     0     0 -21622.309    0  622 -30865.825 -21622.309  29.9%     -   73s
     0     0 -21622.439    0  620 -30865.825 -21622.439  29.9%     -   73s
     0     0 -22154.623    0  652 -30865.825 -22154.623  28.2%     -   83s
     0     0 -22452.081    0  643 -30865.825 -22452.081  27.3%     -   87s
     0     0 -22558.422    0  639 -30865.825 -22558.422  26.9%     -   89s
     0     0 -22602.677    0  603 -30865.825 -22602.677  26.8%     -   91s
     0     0 -22609.509    0  559 -30865.825 -22609.509  26.7%     -   92s
     0     0 -22610.804    0  561 -30865.825 -22610.804  26.7%     -   92s
     0     0 -22613.540    0  569 -30865.825 -22613.540  26.7%     -   92s
     0     0 -22614.016    0  568 -30865.825 -22614.016  26.7%     -   92s
     0     0 -22761.608    0  660 -30865.825 -22761.608  26.3%     -   96s
     0     0 -22807.500    0  668 -30865.825 -22807.500  26.1%     -   98s
     0     0 -22833.810    0  662 -30865.825 -22833.810  26.0%     -  100s
     0     0 -22842.294    0  680 -30865.825 -22842.294  26.0%     -  101s
     0     0 -22845.044    0  687 -30865.825 -22845.044  26.0%     -  101s
     0     0 -22846.712    0  690 -30865.825 -22846.712  26.0%     -  101s
     0     0 -22847.886    0  705 -30865.825 -22847.886  26.0%     -  102s
     0     0 -22848.108    0  707 -30865.825 -22848.108  26.0%     -  102s
     0     0 -22899.033    0  717 -30865.825 -22899.033  25.8%     -  105s
     0     0 -22912.151    0  730 -30865.825 -22912.151  25.8%     -  106s
     0     0 -22919.153    0  730 -30865.825 -22919.153  25.7%     -  107s
     0     0 -22922.688    0  737 -30865.825 -22922.688  25.7%     -  108s
     0     0 -22923.750    0  734 -30865.825 -22923.750  25.7%     -  108s
     0     0 -22968.127    0  721 -30865.825 -22968.127  25.6%     -  111s
     0     0 -22984.626    0  738 -30865.825 -22984.626  25.5%     -  112s
     0     0 -22988.395    0  741 -30865.825 -22988.395  25.5%     -  113s
     0     0 -22990.029    0  744 -30865.825 -22990.029  25.5%     -  113s
     0     0 -22990.949    0  746 -30865.825 -22990.949  25.5%     -  114s
H    0     0                    -30830.40824 -22990.949  25.4%     -  115s
H    0     0                    -30830.35069 -22990.949  25.4%     -  115s
     0     0 -23001.632    0  660 -30830.351 -23001.632  25.4%     -  115s
H    0     0                    -30616.93355 -23001.647  24.9%     -  116s
H    0     0                    -30563.07604 -23001.647  24.7%     -  116s
     0     0 -23006.664    0  794 -30563.076 -23006.664  24.7%     -  116s
     0     0 -23009.738    0  797 -30563.076 -23009.738  24.7%     -  117s
     0     0 -23012.250    0  799 -30563.076 -23012.250  24.7%     -  117s
     0     0 -23012.991    0  805 -30563.076 -23012.991  24.7%     -  118s
H    0     0                    -30275.96225 -23021.447  24.0%     -  119s
     0     0 -23021.447    0  746 -30275.962 -23021.447  24.0%     -  119s
     0     0 -23023.926    0  751 -30275.962 -23023.926  24.0%     -  120s
     0     0 -23026.591    0  765 -30275.962 -23026.591  23.9%     -  120s
     0     0 -23027.605    0  760 -30275.962 -23027.605  23.9%     -  121s
     0     0 -23054.556    0  746 -30275.962 -23054.556  23.9%     -  122s
     0     0 -23057.685    0  755 -30275.962 -23057.685  23.8%     -  123s
     0     0 -23058.248    0  759 -30275.962 -23058.248  23.8%     -  124s
     0     0 -23082.289    0  805 -30275.962 -23082.289  23.8%     -  126s
H    0     0                    -30253.23686 -23082.644  23.7%     -  126s
     0     0 -23087.571    0  808 -30253.237 -23087.571  23.7%     -  127s
     0     0 -23094.636    0  746 -30253.237 -23094.636  23.7%     -  127s
     0     0 -23096.732    0  753 -30253.237 -23096.732  23.7%     -  127s
     0     0 -23097.053    0  753 -30253.237 -23097.053  23.7%     -  128s
     0     0 -23105.689    0  659 -30253.237 -23105.689  23.6%     -  129s
H    0     0                    -30249.69152 -23106.749  23.6%     -  129s
     0     0 -23106.749    0  657 -30249.692 -23106.749  23.6%     -  129s
     0     0 -23110.676    0  666 -30249.692 -23110.676  23.6%     -  130s
     0     0 -23112.053    0  679 -30249.692 -23112.053  23.6%     -  131s
     0     0 -23112.622    0  669 -30249.692 -23112.622  23.6%     -  131s
     0     0 -23122.110    0  717 -30249.692 -23122.110  23.6%     -  133s
H    0     0                    -30246.35237 -23122.375  23.6%     -  134s
     0     0 -23122.878    0  671 -30246.352 -23122.878  23.6%     -  134s
     0     0 -23125.387    0  676 -30246.352 -23125.387  23.5%     -  135s
     0     0 -23125.723    0  676 -30246.352 -23125.723  23.5%     -  136s
H    0     0                    -30133.06526 -23125.723  23.3%     -  153s
     0     2 -23125.723    0  676 -30133.065 -23125.723  23.3%     -  154s
     1     4 -23280.346    1  696 -30133.065 -23127.260  23.2%  5797  158s
     3     8 -23505.737    2  761 -30133.065 -23280.376  22.7%  4950  163s
     7    16 -23538.578    3  789 -30133.065 -23505.759  22.0%  4110  167s
    15    32 -23686.137    4  783 -30133.065 -23538.770  21.9%  3821  176s
    31    48 -23936.449    5  763 -30133.065 -23686.904  21.4%  6913  188s
    47    78 -24101.252    6  774 -30133.065 -23686.904  21.4%  5842  194s
H   49    78                    -30129.47870 -23686.904  21.4%  5757  194s
H   66    78                    -30126.26427 -23686.904  21.4%  4826  194s
H   69    78                    -30111.27444 -23686.904  21.3%  4656  194s
    79   156 -24127.101    7  779 -30111.274 -23686.904  21.3%  4268  205s
   159   305 -24182.083    9  763 -30111.274 -23686.904  21.3%  2628  213s
   310   379 -24200.783   10  752 -30111.274 -23686.904  21.3%  1785  217s
   393   410 -24504.276   13  730 -30111.274 -23686.904  21.3%  1673  221s
   426   447 -24440.278   13  740 -30111.274 -23686.904  21.3%  1658  226s
   471   475 -26110.001   19  386 -30111.274 -23686.904  21.3%  1649  234s
   513   508 -24498.721   11  643 -30111.274 -23686.904  21.3%  1658  238s
   558   542 -24557.902   14  714 -30111.274 -23686.904  21.3%  1629  246s
   606   583 -25213.198   14  554 -30111.274 -23686.904  21.3%  1612  252s
   657   621 -24639.345   15  732 -30111.274 -23686.904  21.3%  1567  257s
   712   659 -24835.929   17  716 -30111.274 -23686.904  21.3%  1541  262s
   764   717 -24895.853   18  710 -30111.274 -23798.418  21.0%  1506  268s
   834   792 -25416.120   19  697 -30111.274 -23798.418  21.0%  1482  274s
   925   852 -26623.935   17  369 -30111.274 -23798.418  21.0%  1432  281s
  1017   887 -28578.052   28  423 -30111.274 -23798.418  21.0%  1365  288s
  1103   916 -25855.217   20  684 -30111.274 -23798.418  21.0%  1344  295s
  1162   949 -26332.843   20  707 -30111.274 -23798.418  21.0%  1389  304s
  1219   991 -29928.982   31  237 -30111.274 -23798.418  21.0%  1416  311s
  1294  1041 -27141.000   21  583 -30111.274 -23798.418  21.0%  1421  319s
  1380  1098 -27578.665   21  676 -30111.274 -23798.418  21.0%  1433  326s
  1477  1143 -27083.187   21  583 -30111.274 -23880.492  20.7%  1451  334s
  1574  1203 -27853.478   21  693 -30111.274 -23880.492  20.7%  1463  342s
  1674  1267 -27736.822   22  512 -30111.274 -24117.688  19.9%  1470  350s
  1775  1390 -27711.651   22  552 -30111.274 -24117.688  19.9%  1468  358s
  1930  1420     cutoff   22      -30111.274 -24117.688  19.9%  1429  367s
  2101  1477     cutoff   23      -30111.274 -24119.013  19.9%  1396  375s
  2251  1558 -28774.299   25  446 -30111.274 -24119.013  19.9%  1393  384s
  2410  1629     cutoff   25      -30111.274 -24119.013  19.9%  1382  394s
  2557  1687     cutoff   26      -30111.274 -24119.013  19.9%  1384  404s
  2704  1711 -25410.053   10  414 -30111.274 -24119.013  19.9%  1392  414s
  2811  1763 -25506.410   11  417 -30111.274 -24119.013  19.9%  1411  424s
  2930  1823     cutoff   15      -30111.274 -24381.903  19.0%  1426  433s
  3067  1865 -29731.542   20   80 -30111.274 -24381.903  19.0%  1444  445s
  3183  1927 -27595.725   11  368 -30111.274 -24381.903  19.0%  1454  456s
  3360  1972 -30039.591   42   47 -30111.274 -24487.883  18.7%  1457  469s
  3545  2046 -26142.326    6  562 -30111.274 -24536.123  18.5%  1463  480s
  3742  2111 -26747.298    8  530 -30111.274 -24628.936  18.2%  1470  493s
  3922  2125 -28009.248   10  564 -30111.274 -24700.405  18.0%  1481  507s
  4071  2157 -28397.954   11  519 -30111.274 -24729.072  17.9%  1490  521s
  4230  2190 -29382.069   12  452 -30111.274 -24734.867  17.9%  1509  534s
  4402  2264 -29958.054   13  467 -30111.274 -24814.738  17.6%  1531  548s
  4642  2292 -26007.549   17  372 -30111.274 -24878.726  17.4%  1538  561s
  4712  2320 -26133.111   18  386 -30111.274 -24907.144  17.3%  1551  573s
  4826  2425 -26545.362   20  271 -30111.274 -24932.789  17.2%  1558  586s
  5075  2477 -27874.358   26  181 -30111.274 -24941.347  17.2%  1555  600s
  5349  2512     cutoff   14      -30111.274 -24941.347  17.2%  1556  616s
  5629  2535     cutoff   15      -30111.274 -24941.347  17.2%  1549  631s
  5900  2606 -27116.136   17  360 -30111.274 -25039.951  16.8%  1561  647s
  6157  2695 -28981.865   21  311 -30111.274 -25093.456  16.7%  1568  665s
  6474  2758 -27164.821   12  355 -30111.274 -25136.388  16.5%  1559  686s
  6862  2817     cutoff   14      -30111.274 -25176.544  16.4%  1545  704s
  7125  2818 -27687.269   21  676 -30111.274 -25217.729  16.3%  1551  801s
  7127  2819 -28131.128   21  402 -30111.274 -25217.729  16.3%  1550  823s
  7128  2820 -28410.921   33  633 -30111.274 -25217.729  16.3%  1550  843s
  7129  2821 -28267.877   17  620 -30111.274 -25217.729  16.3%  1550  854s
  7130  2821 -29724.795   13  707 -30111.274 -25217.729  16.3%  1550  861s
  7131  2822 -29525.533   24  742 -30111.274 -25217.729  16.3%  1549  867s
  7132  2823 -28866.001   26  711 -30111.274 -25217.729  16.3%  1549  871s
  7133  2823 -25571.676   14  735 -30111.274 -25217.729  16.3%  1549  876s
  7135  2825 -28059.672   16  806 -30111.274 -25217.729  16.3%  1549  883s
  7136  2825 -26847.025   17  701 -30111.274 -25217.729  16.3%  1548  885s
  7138  2827 -25910.289   16  739 -30111.274 -25217.729  16.3%  1548  895s
  7141  2829 -25738.041   13  759 -30111.274 -25217.729  16.3%  1547  900s
  7143  2830 -29201.748   32  763 -30111.274 -25217.729  16.3%  1547  913s
  7145  2831 -27913.400   20  698 -30111.274 -25217.729  16.3%  1546  916s
  7147  2833 -25335.300    7  814 -30111.274 -25217.729  16.3%  1546  927s
  7149  2834 -25695.894   20  827 -30111.274 -25217.729  16.3%  1545  930s
  7151  2835 -29379.792   31  732 -30111.274 -25217.729  16.3%  1545  941s
  7153  2837 -30055.061   18  763 -30111.274 -25217.729  16.3%  1545  947s
  7154  2837 -27195.660   17  767 -30111.274 -25217.729  16.3%  1544  951s
  7155  2838 -29960.744   33  760 -30111.274 -25217.729  16.3%  1544  957s
  7156  2839 -26372.205   15  780 -30111.274 -25217.729  16.3%  1544  961s
  7157  2839 -27155.435   17  770 -30111.274 -25217.729  16.3%  1544  966s
  7158  2840 -29787.742   16  770 -30111.274 -25217.729  16.3%  1544  991s
  7159  2841 -26406.689   23  770 -30111.274 -25217.729  16.3%  1543 1009s
  7160  2844 -25217.729   11  747 -30111.274 -25217.729  16.3%  1570 1023s
  7162  2848 -25217.729   12  810 -30111.274 -25217.729  16.3%  1570 1037s
  7166  2854 -25217.729   13  817 -30111.274 -25217.729  16.3%  1573 1046s
  7174  2868 -25217.729   14  771 -30111.274 -25217.729  16.3%  1578 1061s
  7190  2878 -25217.729   15  760 -30111.274 -25217.729  16.3%  1584 1077s
  7206  2903 -25217.729   16  480 -30111.274 -25217.729  16.3%  1613 1089s
  7238  3007 -25661.565   17  607 -30111.274 -25217.729  16.3%  1625 1101s
  7360  2993 -25818.913   19  632 -30111.274 -25217.729  16.3%  1631 1106s
  7396  3006     cutoff   18      -30111.274 -25217.729  16.3%  1630 1115s
  7445  2989 -26404.904   21  339 -30111.274 -25217.729  16.3%  1635 1124s
  7525  2970 -29013.642   21  205 -30111.274 -25217.729  16.3%  1632 1132s
  7572  2955 -28060.018   19  336 -30111.274 -25217.729  16.3%  1637 1142s
  7637  2951 -26831.423   22  410 -30111.274 -25217.729  16.3%  1638 1149s
  7680  2955 -27994.939   20  349 -30111.274 -25217.729  16.3%  1642 1164s
  7740  2939 -27440.107   23  451 -30111.274 -25217.729  16.3%  1643 1175s
  7801  2939 -27549.116   24  453 -30111.274 -25217.729  16.3%  1649 1184s
  7864  2935     cutoff   23      -30111.274 -25217.729  16.3%  1658 1193s
  7903  2946 -27594.521   26  443 -30111.274 -25217.729  16.3%  1661 1203s
  7946  2943 -27603.572   27  444 -30111.274 -25217.729  16.3%  1663 1210s
  7999  2945 -27724.893   28  434 -30111.274 -25217.729  16.3%  1668 1219s
  8055  2928 -28029.161   29  343 -30111.274 -25217.729  16.3%  1670 1229s
  8123  2910 -28081.514   30  260 -30111.274 -25217.729  16.3%  1673 1238s
  8201  2904 -28483.740   31  266 -30111.274 -25217.729  16.3%  1676 1247s
  8259  2918 -28499.384   32  265 -30111.274 -25217.729  16.3%  1680 1257s
  8328  2914     cutoff   33      -30111.274 -25217.729  16.3%  1686 1267s
  8415  2895 -27189.144   21  438 -30111.274 -25217.729  16.3%  1691 1278s
  8513  2879     cutoff   23      -30111.274 -25217.729  16.3%  1694 1289s
  8616  2864 -27982.536   24  447 -30111.274 -25727.884  14.6%  1698 1301s
  8708  2842 -28706.868   25  375 -30111.274 -25733.629  14.5%  1704 1312s
  8772  2831 -29601.775   26  379 -30111.274 -25931.481  13.9%  1713 1325s
  8857  2826 -28216.234   21  584 -30111.274 -25931.481  13.9%  1723 1335s
  8959  2812 -29003.600   22  511 -30111.274 -25938.299  13.9%  1731 1352s
  9089  2783     cutoff   25      -30111.274 -26434.890  12.2%  1735 1364s
  9204  2761 -29710.848   25  336 -30111.274 -26672.665  11.4%  1746 1378s
  9326  2717     cutoff   28      -30111.274 -26805.243  11.0%  1758 1392s
  9434  2679 -27420.830   24  434 -30111.274 -26805.243  11.0%  1766 1406s
  9566  2643 -27750.547   25  450 -30111.274 -26847.983  10.8%  1775 1423s
  9732  2584     cutoff   28      -30111.274 -26847.983  10.8%  1778 1437s
  9909  2497     cutoff   29      -30111.274 -27380.147  9.07%  1782 1451s
 10005  2462 -28602.378   19  270 -30111.274 -27539.252  8.54%  1785 1464s
 10161  2405 -29459.373   21  203 -30111.274 -27539.877  8.54%  1788 1478s
 10371  2293 -30102.579   39   18 -30111.274 -27804.817  7.66%  1789 1495s
 10581  2174 -28948.773   20  220 -30111.274 -27852.003  7.50%  1794 1513s
 10809  2059     cutoff   22      -30111.274 -28029.804  6.91%  1800 1532s
 11070  1902 -30019.677   24  367 -30111.274 -28212.789  6.30%  1799 1549s
 11400  1623     cutoff   21      -30111.274 -28484.449  5.40%  1788 1564s
 11808  1317     cutoff   44      -30111.274 -28660.279  4.82%  1760 1578s
 12191  1163     cutoff   25      -30111.274 -29270.393  2.79%  1724 1581s

Cutting planes:
  Learned: 3
  Gomory: 1
  Implied bound: 38
  MIR: 640
  Flow cover: 1836
  Zero half: 5
  Mod-K: 1
  RLT: 20
  Relax-and-lift: 142

Explored 12286 nodes (21211483 simplex iterations) in 1581.16 seconds (4131.96 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -30111.3 -30126.3 -30129.5 ... -30616.9
No other solutions better than -30111.3

Optimal solution found (tolerance 1.00e-06)
Best objective -3.011127444148e+04, best bound -3.011127444148e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1581.17s
  Master Objective (UB) = -30111.27, θ = 93359.65
  Upper Bound (UB) = -30111.27

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93359.65
  [DEBUG]   ✓ Scenario 0: θ = 93359.65 ≤ Q = 93359.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93359.65 ≤ Q = 93367.61 (slack: 7.95)
  [DEBUG]   ✓ Scenario 2: θ = 93359.65 ≤ Q = 93359.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93359.65 ≤ Q = 93359.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93359.65 ≤ Q = 93359.65 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2ab9afff
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd5465001
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.063892e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.00s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 4903885.9017
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.190547e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119054.70    0  124 4903885.90 -119054.70   102%     -    0s
H    0     0                    -85627.98713 -119054.70  39.0%     -    0s
H    0     0                    -85980.72942 -119054.70  38.5%     -    0s
H    0     0                    -91545.86162 -119054.70  30.0%     -    0s
     0     0 -103193.67    0   81 -91545.862 -103193.67  12.7%     -    0s
H    0     0                    -100558.2973 -103156.05  2.58%     -    0s
H    0     0                    -100871.2106 -103156.05  2.27%     -    0s
H    0     0                    -101167.1347 -103156.05  1.97%     -    0s
     0     0 -102795.53    0   78 -101167.13 -102795.53  1.61%     -    0s
     0     0 -102712.83    0   71 -101167.13 -102712.83  1.53%     -    0s
     0     0 -102707.97    0   70 -101167.13 -102707.97  1.52%     -    0s
     0     0 -102147.96    0   58 -101167.13 -102147.96  0.97%     -    0s
     0     0 -102039.28    0   44 -101167.13 -102039.28  0.86%     -    0s
     0     0 -102005.48    0   55 -101167.13 -102005.48  0.83%     -    0s
     0     0 -102002.96    0   55 -101167.13 -102002.96  0.83%     -    0s
     0     0 -101665.13    0   28 -101167.13 -101665.13  0.49%     -    0s
     0     0 -101577.39    0   48 -101167.13 -101577.39  0.41%     -    0s
     0     0 -101573.49    0   35 -101167.13 -101573.49  0.40%     -    0s
     0     0 -101385.60    0   25 -101167.13 -101385.60  0.22%     -    0s
     0     0 -101383.71    0   21 -101167.13 -101383.71  0.21%     -    0s
     0     0 -101354.78    0   26 -101167.13 -101354.78  0.19%     -    0s
     0     0 -101288.94    0   11 -101167.13 -101288.94  0.12%     -    0s
     0     0 -101288.94    0   22 -101167.13 -101288.94  0.12%     -    0s
H    0     0                    -101183.7893 -101288.94  0.10%     -    0s
     0     0 -101200.10    0    6 -101183.79 -101200.10  0.02%     -    0s
     0     0 -101195.80    0    5 -101183.79 -101195.80  0.01%     -    0s
*    0     0               0    -101195.3787 -101195.38  0.00%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 5
  MIR: 3
  Flow cover: 17

Explored 1 nodes (1011 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -101195 -101184 -101167 ... 4.90389e+06
No other solutions better than -101195

Optimal solution found (tolerance 1.00e-06)
Best objective -1.011953787115e+05, best bound -1.011953787115e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 80888.26
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101195.38
  [DEBUG]   S×d_nominal = 182083.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 182083.64 + -101195.38 = 80888.26
  [DEBUG]   Current θ from Master = 93359.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12471.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -42582.66
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 3005.4325, Absolute Gap = 3005.4325, Relative Gap = 0.099811
  Not converged yet (gap = 3005.43 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x8f9ba958
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 0.81s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -189851.7259

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29190   -3.2444355e+04   0.000000e+00   1.917184e+06      5s
   39487   -2.1351189e+04   0.000000e+00   6.124634e+06     10s
   47829   -1.9755407e+04   0.000000e+00   2.640811e+06     15s
   55135   -1.8677557e+04   0.000000e+00   3.268189e+08     20s
Concurrent spin time: 0.50s

Solved with dual simplex

Root relaxation: objective -1.386327e+04, 47082 iterations, 22.10 seconds (44.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13863.271    0  402 -189851.73 -13863.271  92.7%     -   23s
H    0     0                    -183921.2763 -13863.271  92.5%     -   23s
H    0     0                    -57489.58423 -13863.271  75.9%     -   23s
H    0     0                    -57244.78685 -13863.271  75.8%     -   23s
H    0     0                    -57209.09638 -13863.271  75.8%     -   23s
H    0     0                    -57186.60122 -13863.271  75.8%     -   23s
H    0     0                    -54709.68699 -13863.271  74.7%     -   23s
H    0     0                    -39117.17815 -13863.271  64.6%     -   23s
H    0     0                    -38032.69108 -13863.271  63.5%     -   23s
H    0     0                    -37994.13203 -13863.271  63.5%     -   23s
H    0     0                    -37989.56359 -13863.271  63.5%     -   23s
H    0     0                    -37981.92141 -17198.627  54.7%     -   39s
     0     0 -17529.688    0  457 -37981.921 -17529.688  53.8%     -   39s
     0     0 -17529.688    0  468 -37981.921 -17529.688  53.8%     -   40s
     0     0 -17529.688    0  467 -37981.921 -17529.688  53.8%     -   40s
     0     0 -17529.688    0  459 -37981.921 -17529.688  53.8%     -   42s
     0     0 -17529.688    0  463 -37981.921 -17529.688  53.8%     -   43s
     0     0 -19438.184    0  460 -37981.921 -19438.184  48.8%     -   43s
     0     0 -19438.184    0  460 -37981.921 -19438.184  48.8%     -   43s
     0     0 -19487.609    0  524 -37981.921 -19487.609  48.7%     -   53s
H    0     0                    -30907.05773 -19488.776  36.9%     -   54s
H    0     0                    -30906.28680 -19488.776  36.9%     -   54s
H    0     0                    -30891.90175 -19488.776  36.9%     -   54s
     0     0 -19609.535    0  533 -30891.902 -19609.535  36.5%     -   57s
     0     0 -19661.942    0  589 -30891.902 -19661.942  36.4%     -   58s
     0     0 -19719.147    0  586 -30891.902 -19719.147  36.2%     -   60s
     0     0 -19758.999    0  549 -30891.902 -19758.999  36.0%     -   61s
     0     0 -19759.607    0  551 -30891.902 -19759.607  36.0%     -   62s
     0     0 -20913.136    0  601 -30891.902 -20913.136  32.3%     -   76s
H    0     0                    -30890.43318 -21726.506  29.7%     -   86s
H    0     0                    -30871.87149 -21726.506  29.6%     -   86s
     0     0 -21726.506    0  539 -30871.871 -21726.506  29.6%     -   86s
H    0     0                    -30852.80759 -21985.852  28.7%     -   90s
H    0     0                    -30850.63145 -21985.852  28.7%     -   90s
H    0     0                    -30731.61755 -21985.852  28.5%     -   90s
     0     0 -21985.852    0  561 -30731.618 -21985.852  28.5%     -   91s
     0     0 -22067.131    0  610 -30731.618 -22067.131  28.2%     -   94s
H    0     0                    -30722.34994 -22077.829  28.1%     -   96s
H    0     0                    -30721.43467 -22077.829  28.1%     -   96s
H    0     0                    -30711.44947 -22077.829  28.1%     -   96s
H    0     0                    -30703.50855 -22077.829  28.1%     -   96s
H    0     0                    -30687.60281 -22077.829  28.1%     -   96s
     0     0 -22077.829    0  624 -30687.603 -22077.829  28.1%     -   96s
     0     0 -22081.272    0  606 -30687.603 -22081.272  28.0%     -   97s
     0     0 -22083.915    0  566 -30687.603 -22083.915  28.0%     -   98s
     0     0 -22085.467    0  564 -30687.603 -22085.467  28.0%     -   98s
     0     0 -22085.741    0  568 -30687.603 -22085.741  28.0%     -   99s
H    0     0                    -30554.68637 -22085.741  27.7%     -  106s
H    0     0                    -30548.87141 -22085.741  27.7%     -  106s
H    0     0                    -30504.41984 -22474.993  26.3%     -  115s
H    0     0                    -30428.12482 -22474.993  26.1%     -  115s
     0     0 -22474.993    0  614 -30428.125 -22474.993  26.1%     -  115s
H    0     0                    -30417.10737 -22563.070  25.8%     -  118s
     0     0 -22563.070    0  611 -30417.107 -22563.070  25.8%     -  118s
     0     0 -22613.430    0  622 -30417.107 -22613.430  25.7%     -  121s
     0     0 -22633.499    0  637 -30417.107 -22633.499  25.6%     -  123s
     0     0 -22649.136    0  686 -30417.107 -22649.136  25.5%     -  125s
     0     0 -22654.631    0  688 -30417.107 -22654.631  25.5%     -  125s
     0     0 -22690.284    0  552 -30417.107 -22690.284  25.4%     -  127s
     0     0 -22693.155    0  554 -30417.107 -22693.155  25.4%     -  128s
     0     0 -22693.558    0  553 -30417.107 -22693.558  25.4%     -  128s
     0     0 -22816.198    0  689 -30417.107 -22816.198  25.0%     -  132s
H    0     0                    -30407.41930 -22845.770  24.9%     -  134s
     0     0 -22845.770    0  702 -30407.419 -22845.770  24.9%     -  134s
     0     0 -22850.828    0  655 -30407.419 -22850.828  24.9%     -  135s
     0     0 -22853.871    0  654 -30407.419 -22853.871  24.8%     -  136s
     0     0 -22854.344    0  659 -30407.419 -22854.344  24.8%     -  136s
     0     0 -22962.180    0  577 -30407.419 -22962.180  24.5%     -  143s
     0     0 -23022.466    0  671 -30407.419 -23022.466  24.3%     -  147s
     0     0 -23056.791    0  681 -30407.419 -23056.791  24.2%     -  150s
     0     0 -23068.119    0  693 -30407.419 -23068.119  24.1%     -  151s
     0     0 -23071.173    0  692 -30407.419 -23071.173  24.1%     -  152s
     0     0 -23072.264    0  693 -30407.419 -23072.264  24.1%     -  152s
     0     0 -23113.014    0  725 -30407.419 -23113.014  24.0%     -  157s
     0     0 -23129.818    0  752 -30407.419 -23129.818  23.9%     -  160s
     0     0 -23133.333    0  771 -30407.419 -23133.333  23.9%     -  160s
     0     0 -23136.022    0  761 -30407.419 -23136.022  23.9%     -  161s
     0     0 -23136.522    0  766 -30407.419 -23136.522  23.9%     -  161s
     0     0 -23166.164    0  729 -30407.419 -23166.164  23.8%     -  165s
     0     0 -23172.293    0  791 -30407.419 -23172.293  23.8%     -  167s
     0     0 -23175.224    0  781 -30407.419 -23175.224  23.8%     -  168s
     0     0 -23175.805    0  783 -30407.419 -23175.805  23.8%     -  169s
     0     0 -23218.880    0  789 -30407.419 -23218.880  23.6%     -  174s
     0     0 -23228.657    0  757 -30407.419 -23228.657  23.6%     -  176s
     0     0 -23231.153    0  792 -30407.419 -23231.153  23.6%     -  177s
     0     0 -23232.683    0  750 -30407.419 -23232.683  23.6%     -  178s
     0     0 -23233.090    0  758 -30407.419 -23233.090  23.6%     -  178s
     0     0 -23249.089    0  760 -30407.419 -23249.089  23.5%     -  181s
     0     0 -23253.090    0  759 -30407.419 -23253.090  23.5%     -  182s
     0     0 -23256.669    0  768 -30407.419 -23256.669  23.5%     -  183s
     0     0 -23256.888    0  766 -30407.419 -23256.888  23.5%     -  183s
     0     0 -23268.327    0  750 -30407.419 -23268.327  23.5%     -  185s
     0     0 -23271.282    0  738 -30407.419 -23271.282  23.5%     -  187s
     0     0 -23272.133    0  752 -30407.419 -23272.133  23.5%     -  187s
     0     0 -23277.143    0  757 -30407.419 -23277.143  23.4%     -  189s
     0     0 -23277.815    0  762 -30407.419 -23277.815  23.4%     -  190s
     0     0 -23281.145    0  760 -30407.419 -23281.145  23.4%     -  192s
     0     0 -23281.692    0  762 -30407.419 -23281.692  23.4%     -  192s
     0     0 -23286.881    0  756 -30407.419 -23286.881  23.4%     -  194s
     0     0 -23287.052    0  756 -30407.419 -23287.052  23.4%     -  196s
H    0     0                    -30403.78917 -23287.052  23.4%     -  220s
     0     2 -23287.052    0  756 -30403.789 -23287.052  23.4%     -  221s
     3     8 -23429.881    2  625 -30403.789 -23366.363  23.1%  2754  229s
     7    16 -23479.869    3  643 -30403.789 -23429.914  22.9%  3971  236s
    15    32 -23566.860    4  729 -30403.789 -23480.840  22.8%  5878  248s
    31    50 -27854.638    5  209 -30403.789 -23567.271  22.5%  8383  266s
    49    82 -26262.243    6  278 -30403.789 -23567.271  22.5%  7888  274s
    81   161 -26436.368    7  356 -30403.789 -23567.271  22.5%  6285  282s
H   90   161                    -30398.01226 -23567.271  22.5%  5733  282s
   164   264 -26687.176   10  268 -30398.012 -23567.271  22.5%  3513  290s
   278   284 -29309.184    9  189 -30398.012 -23567.271  22.5%  2525  298s
   317   308 -26634.697    8  270 -30398.012 -23567.271  22.5%  2308  305s
   366   331 -27352.823   12  229 -30398.012 -23567.271  22.5%  2260  313s
   424   353 -27402.998   12  220 -30398.012 -23567.271  22.5%  2130  321s
   477   380 -28095.860   15  212 -30398.012 -23567.271  22.5%  2052  328s
   533   400 -28808.907   14  194 -30398.012 -23567.271  22.5%  2074  335s
   591   420 infeasible   16      -30398.012 -23567.271  22.5%  2039  343s
   628   436 -27146.504   16  388 -30398.012 -23567.271  22.5%  2080  351s
   676   458 infeasible   17      -30398.012 -23567.271  22.5%  2104  359s
   711   497     cutoff   16      -30398.012 -23642.294  22.2%  2148  366s
   766   543 -27910.898   20  443 -30398.012 -23642.294  22.2%  2119  373s
   819   602 -28144.852   23  299 -30398.012 -23642.294  22.2%  2082  380s
   894   657     cutoff   13      -30398.012 -23642.294  22.2%  2049  388s
   972   702 -29685.911   22  206 -30398.012 -23642.294  22.2%  1997  396s
  1045   755 -29887.585   28  223 -30398.012 -23642.294  22.2%  1973  402s
  1128   805 -30366.535   31  200 -30398.012 -23773.413  21.8%  1903  410s
  1211   861 -23892.981    6  711 -30398.012 -23773.624  21.8%  1864  418s
  1314   924 -23949.912    7  540 -30398.012 -23773.624  21.8%  1809  427s
  1449   995 -24778.186    9  641 -30398.012 -23773.624  21.8%  1729  436s
  1573  1045 -24938.671   10  654 -30398.012 -23773.624  21.8%  1700  445s
  1682  1087 -25673.472   11  483 -30398.012 -23773.624  21.8%  1705  454s
  1795  1132 -25913.909   12  392 -30398.012 -23893.230  21.4%  1694  463s
  1894  1188 -26615.434   14  359 -30398.012 -23893.230  21.4%  1700  473s
  1974  1211 -26979.132   16  361 -30398.012 -23893.230  21.4%  1748  482s
  2015  1250     cutoff   16      -30398.012 -23950.046  21.2%  1784  490s
H 2072  1250                    -30392.12529 -23950.046  21.2%  1781  490s
  2093  1293 -27293.872   18  343 -30392.125 -23950.046  21.2%  1786  501s
H 2231  1325                    -30385.74916 -24100.781  20.7%  1781  510s
H 2291  1325                    -30373.48436 -24100.781  20.7%  1792  510s
  2297  1373 -27847.298   22  351 -30373.484 -24100.781  20.7%  1792  522s
  2443  1440 -28427.679   35  319 -30373.484 -24100.781  20.7%  1781  535s
  2579  1551 -29314.510   46  232 -30373.484 -24462.492  19.5%  1796  546s
  2759  1602     cutoff   57      -30373.484 -24462.492  19.5%  1782  558s
  2916  1656     cutoff    9      -30373.484 -24462.492  19.5%  1779  571s
  3053  1724 -26605.726   11  388 -30373.484 -24462.492  19.5%  1799  584s
H 3063  1724                    -30359.44585 -24462.492  19.4%  1802  584s
  3217  1807 -27274.780   13  249 -30359.446 -24694.118  18.7%  1808  598s
  3372  1819     cutoff   16      -30359.446 -24963.784  17.8%  1818  609s
H 3402  1815                    -30342.14379 -25042.308  17.5%  1826  609s
  3424  1903 -30067.468   17  203 -30342.144 -25042.308  17.5%  1830  625s
  3604  1978 -28765.053   10  397 -30342.144 -25042.308  17.5%  1828  640s
  3869  2028     cutoff   10      -30342.144 -25121.278  17.2%  1792  656s
  4098  2141 -26375.224   13  558 -30342.144 -25121.278  17.2%  1781  672s
  4322  2187 -28737.514   16  343 -30342.144 -25243.064  16.8%  1783  690s
  4568  2236     cutoff   25      -30342.144 -25329.997  16.5%  1780  707s
  4711  2287 -29941.846   15  275 -30342.144 -25329.997  16.5%  1785  725s
  4908  2300     cutoff   17      -30342.144 -25402.315  16.3%  1798  739s
  4959  2315 -28732.052   18  363 -30342.144 -25415.419  16.2%  1808  754s
  5014  2331 -27854.611   17  439 -30342.144 -25415.419  16.2%  1821  770s
  5077  2350     cutoff   17      -30342.144 -25415.419  16.2%  1825  787s
  5175  2359     cutoff   18      -30342.144 -25415.419  16.2%  1828  806s
  5352  2397 -29561.732   23  287 -30342.144 -25415.419  16.2%  1824  829s
  5568  2429 -29505.169   16  138 -30342.144 -25527.023  15.9%  1839  851s
  5728  2451 -27904.440   17  493 -30342.144 -25631.524  15.5%  1858  871s
  5927  2467     cutoff   19      -30342.144 -25634.251  15.5%  1861  894s
  6223  2479     cutoff   26      -30342.144 -25721.999  15.2%  1867  920s
  6499  2546 -27625.520   12  383 -30342.144 -25847.957  14.8%  1881  947s
  6796  2609 -29823.956   18  239 -30342.144 -25958.734  14.4%  1895  976s
  7118  2680     cutoff   12      -30342.144 -25958.734  14.4%  1908 1000s
  7459  2727     cutoff   18      -30342.144 -26174.529  13.7%  1907 1028s
  7824  2755     cutoff   11      -30342.144 -26208.007  13.6%  1914 1058s
  8143  2856     cutoff   16      -30342.144 -26306.721  13.3%  1935 1086s
  8553  2857 -29514.057   19  756 -30342.144 -26548.138  12.5%  1938 1146s
  8555  2858 -29646.580   23  402 -30342.144 -26548.138  12.5%  1937 1176s
  8556  2859 -27498.339   18  624 -30342.144 -26548.138  12.5%  1937 1200s
  8557  2860 -27987.633   31  661 -30342.144 -26548.138  12.5%  1937 1216s
  8558  2860 -28906.702   19  689 -30342.144 -26548.138  12.5%  1936 1228s
  8559  2861 -29025.842   24  734 -30342.144 -26548.138  12.5%  1936 1239s
  8560  2862 -29841.237   25  725 -30342.144 -26548.138  12.5%  1936 1246s
  8561  2862 -27262.875   15  762 -30342.144 -26548.138  12.5%  1936 1253s
  8562  2863 -29624.811   23  724 -30342.144 -26548.138  12.5%  1935 1257s
  8563  2864 -29533.660   34  781 -30342.144 -26548.138  12.5%  1935 1261s
  8564  2864 -28926.129   32  746 -30342.144 -26548.138  12.5%  1935 1265s
  8565  2865 -29901.843   42  749 -30342.144 -26548.138  12.5%  1935 1270s
  8566  2866 -28577.430   25  637 -30342.144 -26548.138  12.5%  1935 1279s
  8567  2866 -27418.324   12  651 -30342.144 -26548.138  12.5%  1934 1282s
  8568  2867 -29594.921   35  644 -30342.144 -26548.138  12.5%  1934 1286s
  8569  2868 -27367.229   13  740 -30342.144 -26548.138  12.5%  1934 1291s
  8570  2868 -27958.336   28  745 -30342.144 -26548.138  12.5%  1934 1301s
  8572  2870 -27910.390   13  805 -30342.144 -26548.138  12.5%  1933 1310s
  8573  2870 -27216.055   11  788 -30342.144 -26548.138  12.5%  1933 1318s
  8574  2871 -27285.986   18  726 -30342.144 -26548.138  12.5%  1933 1322s
  8575  2872 -30073.952   28  683 -30342.144 -26548.138  12.5%  1933 1325s
  8576  2872 -30035.479   43  746 -30342.144 -26548.138  12.5%  1932 1332s
  8577  2873 -27421.117   13  674 -30342.144 -26548.138  12.5%  1932 1335s
  8578  2874 -26957.125   11  738 -30342.144 -26548.138  12.5%  1932 1341s
  8580  2875 -28657.980   17  672 -30342.144 -26548.138  12.5%  1931 1350s
  8581  2876 -28428.898   20  672 -30342.144 -26548.138  12.5%  1931 1379s
  8582  2876 -29160.484   43  672 -30342.144 -26548.138  12.5%  1931 1394s
  8583  2879 -26548.138   14  466 -30342.144 -26548.138  12.5%  1956 1401s
  8584  2882 -26548.138   15  471 -30342.144 -26548.138  12.5%  1956 1412s
  8587  2887 -26548.138   16  481 -30342.144 -26548.138  12.5%  1956 1427s
  8593  2896 -26548.138   17  473 -30342.144 -26548.138  12.5%  1960 1444s
  8605  2904 -28566.974   18  292 -30342.144 -26548.138  12.5%  1972 1467s
  8617  2930 -26548.138   18  297 -30342.144 -26548.138  12.5%  1979 1491s
  8649  3017 -26563.390   19  384 -30342.144 -26548.138  12.5%  2010 1507s
  8758  3013 -27987.331   23  222 -30342.144 -26548.138  12.5%  2045 1517s
  8808  3001 -29152.568   24  378 -30342.144 -26548.138  12.5%  2053 1533s
  8870  2992 -29294.795   25  329 -30342.144 -26548.138  12.5%  2070 1544s
  8929  2994 -29803.744   27  410 -30342.144 -26548.138  12.5%  2095 1560s
  8988  2981     cutoff   27      -30342.144 -26548.138  12.5%  2111 1571s
  9045  2973 -26548.138   20  656 -30342.144 -26548.138  12.5%  2135 1582s
  9099  2980 -26548.138   21  485 -30342.144 -26548.138  12.5%  2154 1601s
  9146  2983 -26548.138   22  396 -30342.144 -26548.138  12.5%  2174 1612s
  9190  2987 -28645.282   26  353 -30342.144 -26548.138  12.5%  2195 1624s
  9245  2981 -26904.357   22  478 -30342.144 -26548.138  12.5%  2207 1635s
  9300  2973 -28004.240   23  369 -30342.144 -26548.138  12.5%  2219 1645s
  9359  2954 -28094.663   24  304 -30342.144 -26548.138  12.5%  2228 1656s
  9422  2941 -28842.182   25  297 -30342.144 -26548.138  12.5%  2240 1668s
  9480  2926     cutoff   26      -30342.144 -26548.138  12.5%  2251 1679s
  9539  2917     cutoff   25      -30342.144 -26548.138  12.5%  2270 1692s
  9611  2899 -27261.423   24  399 -30342.144 -26548.138  12.5%  2287 1704s
  9674  2885 -27946.401   25  539 -30342.144 -26548.138  12.5%  2307 1717s
  9744  2880 -28306.867   26  463 -30342.144 -26548.138  12.5%  2325 1729s
  9820  2860 -28475.114   27  452 -30342.144 -26548.138  12.5%  2349 1742s
  9908  2836 -29036.935   28  322 -30342.144 -26548.138  12.5%  2369 1755s
  9955  2821 -29133.043   29  317 -30342.144 -26548.138  12.5%  2386 1768s
 10021  2800     cutoff   30      -30342.144 -26548.138  12.5%  2401 1781s
 10115  2762 -29670.201   30  415 -30342.144 -26548.138  12.5%  2421 1796s
 10217  2725 -29702.824   26  218 -30342.144 -26548.138  12.5%  2440 1811s
 10338  2676 -29269.522   22  462 -30342.144 -26830.023  11.6%  2464 1827s
 10463  2638     cutoff   24      -30342.144 -26955.174  11.2%  2491 1842s
 10590  2597     cutoff   33      -30342.144 -26999.231  11.0%  2520 1859s
 10730  2563 -30081.864   25  391 -30342.144 -26999.231  11.0%  2547 1875s
 10902  2456 -29911.902   29  271 -30342.144 -27347.785  9.87%  2569 1891s
 11118  2362     cutoff   26      -30342.144 -27806.859  8.36%  2575 1907s
 11292  2244     cutoff   25      -30342.144 -28052.844  7.54%  2589 1925s
 11496  2083 -30095.831   26  290 -30342.144 -28083.290  7.44%  2602 1940s
 11746  1899 infeasible   31      -30342.144 -28779.946  5.15%  2601 1955s
 12095  1767 -30284.765   35   22 -30342.144 -28821.674  5.01%  2558 1966s
*12524  1536              62    -30329.34834 -30209.171  0.40%  2481 1968s
 12891  1332 -30283.973   42   28 -30329.348 -30219.605  0.36%  2413 1971s
H13128  1116                    -30328.89103 -30228.567  0.33%  2371 1971s

Cutting planes:
  Implied bound: 20
  Projected implied bound: 7
  MIR: 761
  Flow cover: 1798
  Zero half: 4
  RLT: 24
  Relax-and-lift: 148

Explored 13508 nodes (31396471 simplex iterations) in 1972.67 seconds (5294.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -30328.9 -30329.3 -30342.1 ... -30407.4
No other solutions better than -30328.9

Optimal solution found (tolerance 1.00e-06)
Best objective -3.032889102844e+04, best bound -3.032889102844e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1972.70s
  Master Objective (UB) = -30328.89, θ = 93559.70
  Upper Bound (UB) = -30328.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93559.70
  [DEBUG]   ✓ Scenario 0: θ = 93559.70 ≤ Q = 93559.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93559.70 ≤ Q = 93559.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93559.70 ≤ Q = 93559.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93559.70 ≤ Q = 93559.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93559.70 ≤ Q = 93559.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93559.70 ≤ Q = 93559.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x446ff534
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x446ff534
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.062632e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.00s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 4905604.7043
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.190059e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119005.87    0  124 4905604.70 -119005.87   102%     -    0s
H    0     0                    -85518.95876 -119005.87  39.2%     -    0s
H    0     0                    -85871.70106 -119005.87  38.6%     -    0s
H    0     0                    -91312.91810 -119005.87  30.3%     -    0s
H    0     0                    -91490.38687 -101969.93  11.5%     -    0s
H    0     0                    -91811.73738 -101969.93  11.1%     -    0s
     0     0 -101969.93    0  126 -91811.737 -101969.93  11.1%     -    0s
H    0     0                    -97568.71207 -101893.48  4.43%     -    0s
H    0     0                    -98196.72288 -101893.48  3.76%     -    0s
     0     0 -101170.61    0   84 -98196.723 -101170.61  3.03%     -    0s
H    0     0                    -99577.65626 -101103.90  1.53%     -    0s
     0     0 -100436.80    0   54 -99577.656 -100436.80  0.86%     -    0s
     0     0 -100414.44    0   56 -99577.656 -100414.44  0.84%     -    0s
     0     0 -100407.83    0   54 -99577.656 -100407.83  0.83%     -    0s
     0     0 -100087.87    0   45 -99577.656 -100087.87  0.51%     -    0s
     0     0 -100000.21    0   36 -99577.656 -100000.21  0.42%     -    0s
     0     0 -99982.097    0   36 -99577.656 -99982.097  0.41%     -    0s
     0     0 -99872.377    0   17 -99577.656 -99872.377  0.30%     -    0s
     0     0 -99854.110    0   15 -99577.656 -99854.110  0.28%     -    0s
     0     0 -99826.164    0   15 -99577.656 -99826.164  0.25%     -    0s
     0     0 -99804.881    0   15 -99577.656 -99804.881  0.23%     -    0s
     0     0 -99802.701    0   15 -99577.656 -99802.701  0.23%     -    0s
     0     0 -99802.701    0   69 -99577.656 -99802.701  0.23%     -    0s
     0     0 -99655.143    0   13 -99577.656 -99655.143  0.08%     -    0s
     0     0 -99611.328    0   10 -99577.656 -99611.328  0.03%     -    0s
     0     0 -99599.808    0   10 -99577.656 -99599.808  0.02%     -    0s
     0     0 -99599.032    0    9 -99577.656 -99599.032  0.02%     -    0s
     0     0 -99581.157    0    3 -99577.656 -99581.157  0.00%     -    0s
     0     0 -99581.157    0    3 -99577.656 -99581.157  0.00%     -    0s
     0     0 -99578.376    0    2 -99577.656 -99578.376  0.00%     -    0s

Explored 1 nodes (1149 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -99577.7 -99383.9 -99365.6 ... -85519
No other solutions better than -99577.7

Optimal solution found (tolerance 1.00e-06)
Best objective -9.957765625812e+04, best bound -9.957765625812e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 82713.98
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99577.66
  [DEBUG]   S×d_nominal = 182291.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 182291.64 + -99577.66 = 82713.98
  [DEBUG]   Current θ from Master = 93559.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10845.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -41174.61
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 2787.8159, Absolute Gap = 2787.8159, Relative Gap = 0.091919
  Not converged yet (gap = 2787.82 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xd0662cf7
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 0.97s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -189851.7259

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29928   -4.2431767e+04   0.000000e+00   2.978235e+06      5s
   39715   -2.8998450e+04   0.000000e+00   8.442557e+08     10s
   48378   -2.0902587e+04   0.000000e+00   3.147705e+06     15s
   55395   -1.9972000e+04   0.000000e+00   2.682683e+06     20s
   61893   -1.7872969e+04   0.000000e+00   3.745918e+06     25s
   68243   -1.7301663e+04   0.000000e+00   1.269515e+07     30s
   74588   -1.7081000e+04   0.000000e+00   1.432098e+06     35s
Concurrent spin time: 0.37s

Solved with dual simplex

Root relaxation: objective -1.386327e+04, 61727 iterations, 38.11 seconds (76.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13863.271    0  402 -189851.73 -13863.271  92.7%     -   39s
H    0     0                    -176476.1448 -13863.271  92.1%     -   39s
H    0     0                    -106288.9504 -13863.271  87.0%     -   39s
H    0     0                    -102421.3360 -13863.271  86.5%     -   39s
H    0     0                    -57244.78685 -13863.271  75.8%     -   39s
H    0     0                    -57186.60122 -13863.271  75.8%     -   39s
H    0     0                    -39023.49094 -13863.271  64.5%     -   40s
H    0     0                    -38037.34822 -13863.271  63.6%     -   40s
H    0     0                    -38032.69108 -13863.271  63.5%     -   40s
H    0     0                    -37994.13203 -13863.271  63.5%     -   40s
H    0     0                    -37989.56359 -13863.271  63.5%     -   40s
H    0     0                    -37981.92141 -16811.096  55.7%     -   57s
     0     0 -16958.434    0  465 -37981.921 -16958.434  55.4%     -   57s
     0     0 -17651.296    0  475 -37981.921 -17651.296  53.5%     -   65s
     0     0 -17667.123    0  474 -37981.921 -17667.123  53.5%     -   66s
     0     0 -17692.412    0  466 -37981.921 -17692.412  53.4%     -   68s
     0     0 -17694.065    0  470 -37981.921 -17694.065  53.4%     -   68s
     0     0 -17694.065    0  470 -37981.921 -17694.065  53.4%     -   68s
     0     0 -19343.387    0  481 -37981.921 -19343.387  49.1%     -   82s
H    0     0                    -30992.85181 -19343.395  37.6%     -   82s
H    0     0                    -30891.90358 -19343.395  37.4%     -   82s
     0     0 -19758.051    0  534 -30891.904 -19758.051  36.0%     -   89s
     0     0 -19802.109    0  570 -30891.904 -19802.109  35.9%     -   92s
H    0     0                    -30776.42422 -19867.690  35.4%     -   95s
H    0     0                    -30738.02833 -19867.690  35.4%     -   95s
     0     0 -19867.690    0  526 -30738.028 -19867.690  35.4%     -   95s
     0     0 -19871.963    0  537 -30738.028 -19871.963  35.4%     -   96s
     0     0 -19925.676    0  542 -30738.028 -19925.676  35.2%     -   98s
     0     0 -20040.042    0  534 -30738.028 -20040.042  34.8%     -  102s
H    0     0                    -30699.72120 -20043.541  34.7%     -  103s
H    0     0                    -30625.59440 -20043.541  34.6%     -  103s
     0     0 -20043.541    0  486 -30625.594 -20043.541  34.6%     -  103s
H    0     0                    -30623.65844 -20043.893  34.5%     -  103s
     0     0 -20043.893    0  491 -30623.658 -20043.893  34.5%     -  103s
H    0     0                    -30596.29677 -20043.893  34.5%     -  111s
     0     0 -20888.866    0  576 -30596.297 -20888.866  31.7%     -  125s
     0     0 -21291.486    0  593 -30596.297 -21291.486  30.4%     -  134s
     0     0 -21371.991    0  590 -30596.297 -21371.991  30.1%     -  138s
     0     0 -21390.024    0  607 -30596.297 -21390.024  30.1%     -  140s
     0     0 -21414.141    0  612 -30596.297 -21414.141  30.0%     -  141s
     0     0 -21427.400    0  611 -30596.297 -21427.400  30.0%     -  143s
     0     0 -21446.462    0  607 -30596.297 -21446.462  29.9%     -  144s
     0     0 -21454.991    0  610 -30596.297 -21454.991  29.9%     -  145s
     0     0 -21461.433    0  606 -30596.297 -21461.433  29.9%     -  146s
     0     0 -21462.625    0  620 -30596.297 -21462.625  29.9%     -  147s
     0     0 -21462.852    0  615 -30596.297 -21462.852  29.9%     -  147s
     0     0 -22037.466    0  671 -30596.297 -22037.466  28.0%     -  163s
     0     0 -22198.314    0  623 -30596.297 -22198.314  27.4%     -  169s
     0     0 -22291.138    0  696 -30596.297 -22291.138  27.1%     -  174s
     0     0 -22422.698    0  700 -30596.297 -22422.698  26.7%     -  178s
     0     0 -22437.489    0  705 -30596.297 -22437.489  26.7%     -  180s
     0     0 -22448.786    0  640 -30596.297 -22448.786  26.6%     -  182s
     0     0 -22452.827    0  621 -30596.297 -22452.827  26.6%     -  183s
     0     0 -22453.622    0  677 -30596.297 -22453.622  26.6%     -  184s
     0     0 -22536.496    0  665 -30596.297 -22536.496  26.3%     -  189s
     0     0 -22558.150    0  743 -30596.297 -22558.150  26.3%     -  193s
     0     0 -22562.716    0  651 -30596.297 -22562.716  26.3%     -  195s
     0     0 -22564.682    0  737 -30596.297 -22564.682  26.3%     -  195s
     0     0 -22565.551    0  743 -30596.297 -22565.551  26.2%     -  196s
     0     0 -22663.035    0  698 -30596.297 -22663.035  25.9%     -  202s
     0     0 -22689.974    0  749 -30596.297 -22689.974  25.8%     -  209s
     0     0 -22695.334    0  754 -30596.297 -22695.334  25.8%     -  210s
     0     0 -22697.063    0  702 -30596.297 -22697.063  25.8%     -  210s
     0     0 -22698.296    0  757 -30596.297 -22698.296  25.8%     -  211s
     0     0 -22698.379    0  760 -30596.297 -22698.379  25.8%     -  211s
     0     0 -22742.188    0  706 -30596.297 -22742.188  25.7%     -  216s
     0     0 -22753.336    0  713 -30596.297 -22753.336  25.6%     -  218s
     0     0 -22757.344    0  711 -30596.297 -22757.344  25.6%     -  219s
     0     0 -22758.519    0  714 -30596.297 -22758.519  25.6%     -  220s
     0     0 -22759.485    0  713 -30596.297 -22759.485  25.6%     -  221s
     0     0 -22803.427    0  770 -30596.297 -22803.427  25.5%     -  225s
     0     0 -22810.723    0  766 -30596.297 -22810.723  25.4%     -  228s
     0     0 -22811.680    0  717 -30596.297 -22811.680  25.4%     -  229s
     0     0 -22817.517    0  781 -30596.297 -22817.517  25.4%     -  231s
     0     0 -22821.466    0  790 -30596.297 -22821.466  25.4%     -  233s
     0     0 -22823.259    0  790 -30596.297 -22823.259  25.4%     -  234s
     0     0 -22825.050    0  787 -30596.297 -22825.050  25.4%     -  235s
     0     0 -22825.699    0  795 -30596.297 -22825.699  25.4%     -  236s
     0     0 -22837.232    0  784 -30596.297 -22837.232  25.4%     -  240s
     0     0 -22839.434    0  788 -30596.297 -22839.434  25.4%     -  243s
     0     0 -22840.860    0  791 -30596.297 -22840.860  25.3%     -  244s
     0     0 -22841.288    0  796 -30596.297 -22841.288  25.3%     -  244s
     0     0 -22842.985    0  798 -30596.297 -22842.985  25.3%     -  246s
     0     0 -22844.119    0  793 -30596.297 -22844.119  25.3%     -  247s
     0     0 -22850.638    0  794 -30596.297 -22850.638  25.3%     -  250s
H    0     0                    -30595.07414 -22850.704  25.3%     -  263s
     0     0 -22851.962    0  799 -30595.074 -22851.962  25.3%     -  264s
     0     0 -22852.575    0  800 -30595.074 -22852.575  25.3%     -  265s
     0     0 -22855.238    0  792 -30595.074 -22855.238  25.3%     -  267s
     0     0 -22855.404    0  792 -30595.074 -22855.404  25.3%     -  269s
H    0     0                    -30583.51994 -22855.439  25.3%     -  280s
H    0     0                    -30567.26033 -22855.439  25.2%     -  299s
H    0     0                    -30566.35645 -22855.439  25.2%     -  299s
     0     2 -22855.439    0  792 -30566.356 -22855.439  25.2%     -  300s
     1     4 -22864.978    1  778 -30566.356 -22855.625  25.2%  1412  306s
     3     8 -22871.688    2  781 -30566.356 -22865.428  25.2%  3404  312s
     7    16 -22941.893    3  722 -30566.356 -22872.048  25.2%  3777  321s
    15    31 -24511.417    4  447 -30566.356 -22941.911  24.9%  5245  330s
    30    46 -23942.733    5  538 -30566.356 -22942.428  24.9%  8240  351s
    45    77 -23678.313    5  449 -30566.356 -23093.498  24.4%  8315  367s
H   48    77                    -30551.94302 -23093.498  24.4%  8152  367s
    76   212 -23697.574    6  432 -30551.943 -23093.498  24.4%  6120  382s
   221   299 -23820.968   11  411 -30551.943 -23093.498  24.4%  3082  391s
   320   367 -27269.995   12  185 -30551.943 -23093.498  24.4%  2557  398s
   426   382 -23861.765   12  508 -30551.943 -23093.498  24.4%  2190  405s
   468   418 -24496.823   13  494 -30551.943 -23093.498  24.4%  2130  412s
   545   441 -24547.171   14  504 -30551.943 -23093.498  24.4%  2009  420s
   584   460 -24934.430   15  408 -30551.943 -23093.498  24.4%  1997  427s
   635   460 infeasible   13      -30551.943 -23093.498  24.4%  1961  435s
   687   468 -29085.678   16  121 -30551.943 -23093.498  24.4%  1929  442s
   739   486 -28186.629   15  338 -30551.943 -23093.498  24.4%  1931  450s
   788   512     cutoff   16      -30551.943 -23093.498  24.4%  1928  458s
   846   530 -28970.924   17  309 -30551.943 -23114.217  24.3%  1916  474s
   899   547 -29356.899   18  338 -30551.943 -23114.217  24.3%  1917  482s
   966   557     cutoff   19      -30551.943 -23114.217  24.3%  1904  491s
  1028   570     cutoff   20      -30551.943 -23114.217  24.3%  1898  499s
  1076   582 -24571.761   10  326 -30551.943 -23114.217  24.3%  1938  509s
  1118   618 -25330.296   11  199 -30551.943 -23114.217  24.3%  1984  518s
  1179   659 -25859.994   12  179 -30551.943 -23114.217  24.3%  1990  527s
  1265   691 -28786.607   13   74 -30551.943 -23114.217  24.3%  1971  537s
  1358   710 -29247.699   14   58 -30551.943 -23114.217  24.3%  1968  547s
H 1386   710                    -30536.35863 -23114.217  24.3%  1982  547s
  1426   722 -29869.151   15   47 -30536.359 -23114.217  24.3%  1981  557s
  1521   747 -30439.527   22  354 -30536.359 -23114.217  24.3%  1984  569s
H 1522   747                    -30500.78162 -23114.217  24.2%  1983  569s
  1604   785     cutoff   23      -30500.782 -23114.217  24.2%  1976  580s
  1702   814 -24981.032   10  651 -30500.782 -23114.217  24.2%  1964  591s
  1808   834 -25204.079   11  591 -30500.782 -23114.217  24.2%  1934  603s
  1917   855 -25673.810   12  573 -30500.782 -23114.217  24.2%  1939  615s
  1960   874 -28889.303   15  369 -30500.782 -23114.217  24.2%  1970  627s
  2013   892 -26962.986   13  419 -30500.782 -23114.217  24.2%  2001  640s
  2063   908 -27529.677   14  492 -30500.782 -23172.190  24.0%  2017  652s
H 2085   908                    -30496.79889 -23172.190  24.0%  2022  652s
  2113   940 -29058.525   15  621 -30496.799 -23172.190  24.0%  2045  665s
  2213   988 -29336.708   16  623 -30496.799 -23173.595  24.0%  2072  678s
  2335  1036     cutoff   17      -30496.799 -23219.693  23.9%  2082  691s
  2447  1088 -28841.779   16  428 -30496.799 -23219.693  23.9%  2081  705s
  2594  1128 -29587.949   17  309 -30496.799 -23888.055  21.7%  2079  721s
  2715  1208     cutoff   18      -30496.799 -23888.055  21.7%  2105  735s
  2863  1267 infeasible   19      -30496.799 -23888.055  21.7%  2117  751s
  3017  1305 infeasible   16      -30496.799 -23888.055  21.7%  2109  769s
  3141  1328 -28363.643   15  415 -30496.799 -23888.055  21.7%  2139  787s
  3182  1348 -28928.116   16  388 -30496.799 -23888.055  21.7%  2155  814s
  3226  1377 -29314.946   17  348 -30496.799 -23888.055  21.7%  2168  830s
  3304  1399 -29758.241   18  349 -30496.799 -23888.055  21.7%  2169  848s
  3422  1434 -29879.301   19  307 -30496.799 -24349.800  20.2%  2172  865s
  3534  1453     cutoff   27      -30496.799 -24476.553  19.7%  2187  882s
  3649  1475 -28720.406   15  296 -30496.799 -24477.366  19.7%  2205  899s
  3765  1512     cutoff   17      -30496.799 -24498.282  19.7%  2225  918s
  3871  1557     cutoff   19      -30496.799 -24498.282  19.7%  2247  937s
  4000  1631 -25899.776   11  668 -30496.799 -24590.536  19.4%  2263  955s
  4171  1678     cutoff   16      -30496.799 -24590.536  19.4%  2264  977s
  4348  1733 -29426.153   18  488 -30496.799 -24597.201  19.3%  2273 1000s
  4525  1798 -28673.858   17  349 -30496.799 -24597.201  19.3%  2286 1024s
  4720  1862     cutoff   20      -30496.799 -24668.532  19.1%  2299 1048s
  4958  1880 -30258.779   20  457 -30496.799 -24794.979  18.7%  2315 1069s
  5080  1967     cutoff   21      -30496.799 -24982.580  18.1%  2317 1091s
  5286  2073 -27473.307   12  472 -30496.799 -25021.139  18.0%  2328 1119s
  5529  2074 -28382.457   20  792 -30496.799 -25062.333  17.8%  2351 1183s
  5531  2075 -29687.570   28  402 -30496.799 -25062.333  17.8%  2350 1239s
  5532  2076 -28161.287   22  576 -30496.799 -25062.333  17.8%  2349 1270s
  5533  2077 -26257.512   11  623 -30496.799 -25062.333  17.8%  2349 1286s
  5534  2077 -28717.195   16  618 -30496.799 -25062.333  17.8%  2349 1304s
  5535  2078 -29180.375   20  686 -30496.799 -25062.333  17.8%  2348 1309s
  5536  2079 -27033.564   12  686 -30496.799 -25062.333  17.8%  2348 1314s
  5537  2079 -28073.056   22  762 -30496.799 -25062.333  17.8%  2347 1320s
  5538  2080 -26714.433   13  748 -30496.799 -25062.333  17.8%  2347 1326s
  5540  2081 -29269.579   34  716 -30496.799 -25062.333  17.8%  2346 1333s
  5541  2082 -27200.559   15  753 -30496.799 -25062.333  17.8%  2346 1346s
  5542  2083 -29277.247   17  743 -30496.799 -25062.333  17.8%  2345 1353s
  5543  2083 -29648.522   20  742 -30496.799 -25062.333  17.8%  2345 1358s
  5544  2084 -26264.646   10  772 -30496.799 -25062.333  17.8%  2344 1362s
  5545  2085 -27558.554   14  763 -30496.799 -25062.333  17.8%  2344 1366s
  5546  2085 -29667.807   23  825 -30496.799 -25062.333  17.8%  2343 1372s
  5547  2086 -29230.186   22  771 -30496.799 -25062.333  17.8%  2343 1384s
  5548  2087 -29991.762   25  771 -30496.799 -25062.333  17.8%  2343 1388s
  5549  2087 -29543.810   18  685 -30496.799 -25062.333  17.8%  2342 1391s
  5550  2088 -27012.208   12  688 -30496.799 -25062.333  17.8%  2342 1395s
  5551  2089 -26669.354   10  753 -30496.799 -25062.333  17.8%  2341 1404s
  5552  2089 -26417.500   14  802 -30496.799 -25062.333  17.8%  2341 1409s
  5553  2090 -29355.390   40  769 -30496.799 -25062.333  17.8%  2340 1413s
  5554  2091 -29186.223   27  733 -30496.799 -25062.333  17.8%  2340 1424s
  5555  2091 -28060.501   17  755 -30496.799 -25062.333  17.8%  2340 1429s
  5556  2092 -29716.467   25  776 -30496.799 -25062.333  17.8%  2339 1434s
  5557  2093 -28802.122   21  786 -30496.799 -25062.333  17.8%  2339 1437s
  5558  2093 -27100.973   13  810 -30496.799 -25062.333  17.8%  2338 1443s
  5559  2094 -27937.144   15  650 -30496.799 -25062.333  17.8%  2338 1455s
  5561  2095 -26370.440   12  786 -30496.799 -25062.333  17.8%  2337 1462s
  5562  2096 -29026.343   23  584 -30496.799 -25062.333  17.8%  2337 1468s
  5563  2097 -29066.473   24  740 -30496.799 -25062.333  17.8%  2336 1471s
  5565  2098 -26199.228   13  728 -30496.799 -25062.333  17.8%  2335 1480s
  5567  2099 -27011.214   14  796 -30496.799 -25062.333  17.8%  2335 1490s
  5569  2101 -30221.441   63  803 -30496.799 -25062.333  17.8%  2334 1500s
  5570  2101 -28777.008    9  803 -30496.799 -25062.333  17.8%  2333 1554s
  5571  2102 -27651.468   17  803 -30496.799 -25062.333  17.8%  2333 1570s
  5572  2106 -25062.333   16  755 -30496.799 -25062.333  17.8%  2392 1589s
  5574  2109 -25062.333   17  758 -30496.799 -25062.333  17.8%  2392 1611s
  5578  2116 -25062.333   18  709 -30496.799 -25062.333  17.8%  2395 1632s
  5586  2127 -25062.333   19  723 -30496.799 -25062.333  17.8%  2402 1649s
  5602  2139 -25062.333   20  465 -30496.799 -25062.333  17.8%  2434 1678s
  5619  2157 -30288.319   21  197 -30496.799 -25062.333  17.8%  2450 1697s
  5651  2242 -30437.962   22  178 -30496.799 -25062.333  17.8%  2483 1725s
  5783  2226 -25317.644   21  463 -30496.799 -25062.333  17.8%  2496 1749s
  5865  2216 -26349.359   22  508 -30496.799 -25062.333  17.8%  2530 1767s
  5932  2211 -26872.400   23  406 -30496.799 -25062.333  17.8%  2556 1781s
  5998  2201 -27165.202   24  411 -30496.799 -25062.333  17.8%  2591 1792s
  6072  2164 -27240.414   25  320 -30496.799 -25062.333  17.8%  2606 1814s
  6162  2150 -27763.344   27  398 -30496.799 -25062.333  17.8%  2612 1825s
  6212  2127 -29102.132   28  322 -30496.799 -25062.333  17.8%  2641 1845s
  6277  2101 -29395.981   29  233 -30496.799 -25062.333  17.8%  2652 1856s
  6333  2098     cutoff   30      -30496.799 -25062.333  17.8%  2675 1867s
  6387  2087 -29492.230   25  209 -30496.799 -25062.333  17.8%  2702 1877s
  6430  2076     cutoff   29      -30496.799 -25062.333  17.8%  2722 1889s
  6498  2050 -29397.984   31  266 -30496.799 -25062.333  17.8%  2731 1900s
  6562  2050 -29405.597   32  256 -30496.799 -25062.333  17.8%  2744 1912s
  6627  2022 -29774.122   37  154 -30496.799 -25062.333  17.8%  2760 1933s
  6710  2005 -28287.524   23  506 -30496.799 -25062.333  17.8%  2789 1946s
  6789  1995 -29043.336   24  532 -30496.799 -25062.333  17.8%  2814 1957s
  6832  1977 -29464.153   25  438 -30496.799 -25062.333  17.8%  2834 1970s
  6900  1958     cutoff   26      -30496.799 -25062.333  17.8%  2849 1985s
  6963  1939 -29981.448   26  210 -30496.799 -25062.333  17.8%  2867 1999s
  7052  1922     cutoff   27      -30496.799 -25062.333  17.8%  2882 2017s
  7171  1888 -28893.029   24  394 -30496.799 -25062.333  17.8%  2887 2031s
  7272  1859 -29418.264   25  485 -30496.799 -25062.333  17.8%  2915 2047s
  7396  1807     cutoff   26      -30496.799 -25062.333  17.8%  2923 2063s
  7487  1785 -28848.646   25  520 -30496.799 -25062.333  17.8%  2940 2078s
  7579  1728 -29754.061   26  513 -30496.799 -25062.333  17.8%  2944 2096s
  7707  1696 infeasible   27      -30496.799 -25062.333  17.8%  2948 2112s
  7820  1630 -29326.166   26  260 -30496.799 -25062.333  17.8%  2959 2131s
  8010  1558     cutoff   28      -30496.799 -25062.333  17.8%  2944 2148s
  8275  1423 -30475.033   29  351 -30496.799 -25758.918  15.5%  2920 2165s
  8552  1319 -29866.122   24  306 -30496.799 -26138.472  14.3%  2890 2181s
  8862  1199 -30481.742   43   12 -30496.799 -27053.773  11.3%  2844 2198s
  9185  1093     cutoff   35      -30496.799 -27420.126  10.1%  2783 2216s
* 9536   870              59    -30490.78160 -27669.676  9.25%  2710 2216s
  9682   781 -30403.719   40   20 -30490.782 -27669.676  9.25%  2676 2229s
H10034   562                    -30469.68023 -28034.301  7.99%  2598 2229s
 10256   390 -29659.591   30  211 -30469.680 -28034.301  7.99%  2544 2238s
 10677   208     cutoff   40      -30469.680 -28034.301  7.99%  2451 2240s
*11065    18              77    -30469.66844 -30430.537  0.13%  2369 2243s
*11091    18              71    -30465.26799 -30430.949  0.11%  2364 2243s
*11109    18              69    -30464.04484 -30430.949  0.11%  2360 2243s
*11261     0              73    -30462.92962 -30446.886  0.05%  2330 2243s

Cutting planes:
  Learned: 3
  Implied bound: 11
  Projected implied bound: 2
  MIR: 833
  Flow cover: 1980
  Zero half: 5
  RLT: 20
  Relax-and-lift: 231

Explored 11283 nodes (26525830 simplex iterations) in 2243.95 seconds (5845.79 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -30462.9 -30464 -30465.3 ... -30551.9
No other solutions better than -30462.9

Optimal solution found (tolerance 1.00e-06)
Best objective -3.046292961501e+04, best bound -3.046292961501e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 2243.96s
  Master Objective (UB) = -30462.93, θ = 93427.89
  Upper Bound (UB) = -30462.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93427.89
  [DEBUG]   ✓ Scenario 0: θ = 93427.89 ≤ Q = 93427.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93427.89 ≤ Q = 93427.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93427.89 ≤ Q = 93427.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93427.89 ≤ Q = 93427.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93427.89 ≤ Q = 93427.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93427.89 ≤ Q = 93427.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93427.89 ≤ Q = 93427.89 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x36042706
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc9fbd8fa
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.062493e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.00s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 4910033.8321
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.187390e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -118739.04    0  124 4910033.83 -118739.04   102%     -    0s
H    0     0                    -85242.75406 -118739.04  39.3%     -    0s
H    0     0                    -85595.49636 -118739.04  38.7%     -    0s
H    0     0                    -91634.49134 -118739.04  29.6%     -    0s
H    0     0                    -91684.35603 -101208.86  10.4%     -    0s
     0     0 -101208.86    0  127 -91684.356 -101208.86  10.4%     -    0s
H    0     0                    -97013.21888 -101167.01  4.28%     -    0s
H    0     0                    -97554.18511 -101167.01  3.70%     -    0s
     0     0 -100407.16    0  125 -97554.185 -100407.16  2.92%     -    0s
     0     0 -100359.89    0  125 -97554.185 -100359.89  2.88%     -    0s
     0     0 -99800.485    0  130 -97554.185 -99800.485  2.30%     -    0s
H    0     0                    -97781.17827 -99762.863  2.03%     -    0s
     0     0 -99762.863    0  130 -97781.178 -99762.863  2.03%     -    0s
     0     0 -99762.863    0  130 -97781.178 -99762.863  2.03%     -    0s
     0     0 -99255.803    0  130 -97781.178 -99255.803  1.51%     -    0s
     0     0 -99231.801    0  129 -97781.178 -99231.801  1.48%     -    0s
     0     0 -99230.294    0  129 -97781.178 -99230.294  1.48%     -    0s
     0     0 -98796.600    0  116 -97781.178 -98796.600  1.04%     -    0s
     0     0 -98743.645    0  116 -97781.178 -98743.645  0.98%     -    0s
     0     0 -98743.530    0  116 -97781.178 -98743.530  0.98%     -    0s
     0     0 -98517.633    0   87 -97781.178 -98517.633  0.75%     -    0s
     0     0 -98342.449    0   91 -97781.178 -98342.449  0.57%     -    0s
     0     0 -98339.298    0   85 -97781.178 -98339.298  0.57%     -    0s
     0     0 -98161.651    0   99 -97781.178 -98161.651  0.39%     -    0s
     0     0 -98161.524    0   98 -97781.178 -98161.524  0.39%     -    0s
     0     0 -98127.431    0   83 -97781.178 -98127.431  0.35%     -    0s
     0     0 -98105.627    0   81 -97781.178 -98105.627  0.33%     -    0s
     0     0 -98016.157    0   74 -97781.178 -98016.157  0.24%     -    0s
     0     0 -98015.390    0   55 -97781.178 -98015.390  0.24%     -    0s
     0     0 -97983.316    0   55 -97781.178 -97983.316  0.21%     -    0s
     0     0 -97980.744    0   55 -97781.178 -97980.744  0.20%     -    0s
     0     0 -97980.744    0   72 -97781.178 -97980.744  0.20%     -    0s
     0     0 -97980.744    0   67 -97781.178 -97980.744  0.20%     -    0s
     0     0 -97980.744    0   53 -97781.178 -97980.744  0.20%     -    0s
     0     0 -97980.744    0   52 -97781.178 -97980.744  0.20%     -    0s
     0     0 -97980.744    0   30 -97781.178 -97980.744  0.20%     -    0s
     0     0 -97975.777    0   23 -97781.178 -97975.777  0.20%     -    0s
     0     0 -97946.726    0   17 -97781.178 -97946.726  0.17%     -    0s
     0     0 -97933.807    0   16 -97781.178 -97933.807  0.16%     -    0s
     0     0 -97929.607    0   15 -97781.178 -97929.607  0.15%     -    0s
     0     0 -97884.290    0   14 -97781.178 -97884.290  0.11%     -    0s
     0     0 -97862.013    0   13 -97781.178 -97862.013  0.08%     -    0s
     0     0 -97786.318    0    5 -97781.178 -97786.318  0.01%     -    0s
     0     0     cutoff    0      -97781.178 -97781.178  0.00%     -    0s

Explored 1 nodes (1481 simplex iterations) in 0.12 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -97781.2 -97737.9 -97716.7 ... 4.91003e+06
No other solutions better than -97781.2

Optimal solution found (tolerance 1.00e-06)
Best objective -9.778117826814e+04, best bound -9.778117826814e+04, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 84029.26
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -97781.18
  [DEBUG]   S×d_nominal = 181810.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 181810.44 + -97781.18 = 84029.26
  [DEBUG]   Current θ from Master = 93427.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9398.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -39861.56
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 2653.7773, Absolute Gap = 2653.7773, Relative Gap = 0.087115
  Not converged yet (gap = 2653.78 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x6b5df5d8
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 1.11s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32404   -7.3204567e+04   0.000000e+00   4.627159e+07      5s
   42578   -2.9733507e+04   0.000000e+00   2.231992e+06     10s
   49498   -2.6083036e+04   0.000000e+00   1.229177e+07     15s
   54920   -2.4971266e+04   0.000000e+00   1.532267e+06     20s
   61156   -2.2447738e+04   0.000000e+00   7.402144e+06     25s
   67368   -1.9740997e+04   0.000000e+00   7.850264e+06     30s
   73490   -1.8327175e+04   0.000000e+00   1.091187e+06     35s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective -1.542045e+04, 58511 iterations, 34.10 seconds (68.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -15420.448    0  403 -201924.56 -15420.448  92.4%     -   35s
H    0     0                    -191536.1296 -15420.448  91.9%     -   35s
H    0     0                    -68261.54108 -15420.448  77.4%     -   36s
H    0     0                    -39590.02486 -15420.448  61.0%     -   36s
H    0     0                    -39474.82884 -15420.448  60.9%     -   36s
H    0     0                    -31960.14389 -15420.448  51.8%     -   36s
H    0     0                    -30902.83218 -15420.448  50.1%     -   36s
H    0     0                    -30895.19000 -15420.448  50.1%     -   37s
     0     0 -18756.632    0  507 -30895.190 -18756.632  39.3%     -   49s
     0     0 -18756.632    0  505 -30895.190 -18756.632  39.3%     -   52s
     0     0 -18756.632    0  511 -30895.190 -18756.632  39.3%     -   53s
     0     0 -18756.632    0  520 -30895.190 -18756.632  39.3%     -   54s
     0     0 -18756.632    0  521 -30895.190 -18756.632  39.3%     -   55s
     0     0 -18756.632    0  524 -30895.190 -18756.632  39.3%     -   55s
     0     0 -20623.122    0  419 -30895.190 -20623.122  33.2%     -   65s
H    0     0                    -30893.15856 -20734.235  32.9%     -   70s
     0     0 -20734.235    0  421 -30893.159 -20734.235  32.9%     -   70s
     0     0 -21191.531    0  499 -30893.159 -21191.531  31.4%     -   78s
     0     0 -21222.078    0  508 -30893.159 -21222.078  31.3%     -   80s
     0     0 -21222.640    0  501 -30893.159 -21222.640  31.3%     -   80s
     0     0 -22803.475    0  559 -30893.159 -22803.475  26.2%     -   92s
     0     0 -23324.855    0  615 -30893.159 -23324.855  24.5%     -   99s
     0     0 -23479.009    0  526 -30893.159 -23479.009  24.0%     -  103s
     0     0 -23521.314    0  517 -30893.159 -23521.314  23.9%     -  105s
     0     0 -23543.589    0  517 -30893.159 -23543.589  23.8%     -  106s
     0     0 -23550.572    0  529 -30893.159 -23550.572  23.8%     -  106s
     0     0 -23551.405    0  528 -30893.159 -23551.405  23.8%     -  106s
     0     0 -24390.262    0  662 -30893.159 -24390.262  21.0%     -  118s
     0     0 -24612.911    0  706 -30893.159 -24612.911  20.3%     -  123s
     0     0 -24670.611    0  715 -30893.159 -24670.611  20.1%     -  125s
     0     0 -24699.133    0  727 -30893.159 -24699.133  20.0%     -  127s
     0     0 -24731.061    0  645 -30893.159 -24731.061  19.9%     -  129s
     0     0 -24742.533    0  657 -30893.159 -24742.533  19.9%     -  129s
     0     0 -24749.424    0  715 -30893.159 -24749.424  19.9%     -  130s
     0     0 -24755.191    0  648 -30893.159 -24755.191  19.9%     -  131s
     0     0 -24756.818    0  677 -30893.159 -24756.818  19.9%     -  132s
     0     0 -24757.305    0  668 -30893.159 -24757.305  19.9%     -  132s
     0     0 -24895.080    0  691 -30893.159 -24895.080  19.4%     -  137s
     0     0 -24916.906    0  640 -30893.159 -24916.906  19.3%     -  140s
     0     0 -24919.875    0  652 -30893.159 -24919.875  19.3%     -  140s
     0     0 -24922.894    0  656 -30893.159 -24922.894  19.3%     -  141s
     0     0 -24924.645    0  643 -30893.159 -24924.645  19.3%     -  141s
     0     0 -24925.323    0  653 -30893.159 -24925.323  19.3%     -  142s
     0     0 -24979.561    0  702 -30893.159 -24979.561  19.1%     -  146s
     0     0 -24992.597    0  705 -30893.159 -24992.597  19.1%     -  152s
     0     0 -24996.103    0  704 -30893.159 -24996.103  19.1%     -  153s
     0     0 -24998.240    0  705 -30893.159 -24998.240  19.1%     -  153s
     0     0 -24998.640    0  700 -30893.159 -24998.640  19.1%     -  153s
     0     0 -25069.184    0  711 -30893.159 -25069.184  18.9%     -  157s
     0     0 -25092.977    0  719 -30893.159 -25092.977  18.8%     -  159s
     0     0 -25103.012    0  708 -30893.159 -25103.012  18.7%     -  161s
     0     0 -25106.713    0  710 -30893.159 -25106.713  18.7%     -  162s
     0     0 -25107.925    0  714 -30893.159 -25107.925  18.7%     -  162s
     0     0 -25127.825    0  722 -30893.159 -25127.825  18.7%     -  165s
     0     0 -25131.754    0  725 -30893.159 -25131.754  18.6%     -  173s
     0     0 -25132.706    0  732 -30893.159 -25132.706  18.6%     -  174s
     0     0 -25148.940    0  737 -30893.159 -25148.940  18.6%     -  176s
     0     0 -25151.012    0  746 -30893.159 -25151.012  18.6%     -  177s
     0     0 -25154.292    0  747 -30893.159 -25154.292  18.6%     -  177s
     0     0 -25154.725    0  739 -30893.159 -25154.725  18.6%     -  177s
     0     0 -25162.511    0  658 -30893.159 -25162.511  18.5%     -  180s
     0     0 -25163.983    0  712 -30893.159 -25163.983  18.5%     -  180s
     0     0 -25165.178    0  706 -30893.159 -25165.178  18.5%     -  181s
     0     0 -25175.389    0  666 -30893.159 -25175.389  18.5%     -  183s
     0     0 -25176.905    0  668 -30893.159 -25176.905  18.5%     -  183s
     0     0 -25178.016    0  669 -30893.159 -25178.016  18.5%     -  184s
     0     0 -25181.398    0  662 -30893.159 -25181.398  18.5%     -  186s
     0     0 -25182.926    0  669 -30893.159 -25182.926  18.5%     -  187s
     0     0 -25183.244    0  674 -30893.159 -25183.244  18.5%     -  187s
     0     0 -25191.745    0  674 -30893.159 -25191.745  18.5%     -  189s
     0     0 -25191.984    0  674 -30893.159 -25191.984  18.5%     -  191s
     0     2 -25191.984    0  674 -30893.159 -25191.984  18.5%     -  215s
     3     8 -25360.555    2  696 -30893.159 -25208.294  18.4%  3428  224s
     7    16 -25397.327    3  707 -30893.159 -25367.113  17.9%  4419  233s
    15    32 -25399.262    4  705 -30893.159 -25398.015  17.8%  6162  240s
    31    50 -27485.012    5  175 -30893.159 -25399.583  17.8%  8065  256s
    51    82 -26782.650    6  393 -30893.159 -25399.583  17.8%  9708  266s
    83   194 -26854.509    7  374 -30893.159 -25399.583  17.8%  7305  273s
   199   309 -27776.201    9  208 -30893.159 -25399.583  17.8%  4199  279s
   322   389 -26987.832    9  371 -30893.159 -25399.583  17.8%  3076  286s
   425   411 -28022.872   10  215 -30893.159 -25399.583  17.8%  2680  293s
   464   459 -28540.383   10  184 -30893.159 -25399.583  17.8%  2587  300s
   526   507 -27807.631   10  210 -30893.159 -25399.583  17.8%  2444  306s
   598   548 -28084.304   10  424 -30893.159 -25399.583  17.8%  2372  313s
   664   589 -27692.883    9  204 -30893.159 -25399.583  17.8%  2324  319s
   746   612 -27982.498    9  424 -30893.159 -25399.583  17.8%  2258  326s
   820   637 -28709.629   11  185 -30893.159 -25399.583  17.8%  2193  333s
   892   647 -28681.586   11  184 -30893.159 -25399.583  17.8%  2179  340s
   942   654 -28700.210   11  190 -30893.159 -25399.583  17.8%  2243  347s
  1001   648 -29115.971   11  176 -30893.159 -25399.583  17.8%  2235  355s
  1066   666 -28889.244   11  376 -30893.159 -25399.583  17.8%  2259  363s
  1128   684 -28765.358   12  182 -30893.159 -25399.583  17.8%  2351  369s
  1170   714 -29190.134   13  160 -30893.159 -25399.583  17.8%  2436  376s
  1244   736 -30188.342   16  115 -30893.159 -25399.583  17.8%  2456  383s
  1306   737 -30457.455   22   84 -30893.159 -25399.583  17.8%  2495  391s
  1386   747 -30316.725   19  389 -30893.159 -25399.583  17.8%  2501  399s
  1443   763     cutoff   14      -30893.159 -25399.583  17.8%  2594  407s
  1495   768 infeasible   16      -30893.159 -25399.583  17.8%  2707  416s
  1554   770 -26890.194    6  392 -30893.159 -25399.583  17.8%  2750  425s
  1628   780     cutoff   10      -30893.159 -25399.583  17.8%  2825  434s
  1676   806 -28724.188   11  315 -30893.159 -25399.583  17.8%  2926  443s
  1754   819 -29370.128   12  270 -30893.159 -25399.583  17.8%  3012  453s
  1817   851 -29998.607   13  256 -30893.159 -25399.583  17.8%  3073  461s
  1911   869     cutoff   14      -30893.159 -25399.583  17.8%  3115  471s
  2024   882 -29604.927   13  255 -30893.159 -25399.583  17.8%  3130  481s
  2119   922 -30496.140   15  244 -30893.159 -25800.881  16.5%  3202  491s
  2211   928 -30683.510   17  219 -30893.159 -25800.881  16.5%  3271  501s
  2332   949 -29078.109    8  175 -30893.159 -25800.881  16.5%  3305  513s
  2435   951 -30704.394   11   82 -30893.159 -25800.881  16.5%  3369  525s
  2550   980 -28159.974   10  173 -30893.159 -25800.881  16.5%  3382  535s
  2675   997     cutoff   17      -30893.159 -25800.881  16.5%  3426  547s
  2825  1007 -29136.684   13  368 -30893.159 -25800.881  16.5%  3446  559s
  2942  1037     cutoff   14      -30893.159 -25800.881  16.5%  3488  571s
  3055  1048     cutoff   13      -30893.159 -26516.260  14.2%  3563  582s
  3106  1051 -28729.715    9  331 -30893.159 -26516.260  14.2%  3602  596s
  3179  1046     cutoff   12      -30893.159 -26516.260  14.2%  3608  608s
  3261  1058 -30755.165   12  152 -30893.159 -26516.260  14.2%  3642  623s
  3324  1077 -28790.047   13  300 -30893.159 -26516.260  14.2%  3675  635s
  3437  1083     cutoff   15      -30893.159 -26659.537  13.7%  3672  649s
  3528  1097     cutoff   18      -30893.159 -26659.537  13.7%  3663  661s
  3604  1124 -30732.872   10  272 -30893.159 -26659.537  13.7%  3668  672s
  3714  1123 -29441.603   10  350 -30893.159 -27088.643  12.3%  3647  687s
  3817  1142     cutoff   14      -30893.159 -27258.115  11.8%  3653  703s
  3993  1125     cutoff   18      -30893.159 -27403.167  11.3%  3602  718s
  4233  1112 -29865.309   11  434 -30893.159 -27572.603  10.7%  3522  732s
  4432  1106 -30799.710   13  373 -30893.159 -27572.603  10.7%  3505  747s
  4717  1062     cutoff   15      -30893.159 -27572.603  10.7%  3438  763s
  4981  1030     cutoff    9      -30893.159 -27905.927  9.67%  3402  779s
  5403   943     cutoff   10      -30893.159 -28060.934  9.17%  3315  798s
  5778   769 -29798.355   15  125 -30893.159 -28308.962  8.36%  3246  815s
  6266   598 -30266.264   17  128 -30893.159 -28515.556  7.70%  3185  834s
  6697   364     cutoff   16      -30893.159 -28894.698  6.47%  3147  853s
  7270    51     cutoff   11      -30893.159 -29294.999  5.17%  3054  871s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 4
  MIR: 971
  Flow cover: 2144
  Zero half: 8
  RLT: 35
  Relax-and-lift: 131

Explored 7860 nodes (23206933 simplex iterations) in 874.20 seconds (2529.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -30893.2 -30895.2 -30902.8 ... -427171
No other solutions better than -30893.2

Optimal solution found (tolerance 1.00e-06)
Best objective -3.089315856135e+04, best bound -3.089315856135e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 874.33s
  Master Objective (UB) = -30893.16, θ = 93719.19
  Upper Bound (UB) = -30893.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93719.19
  [DEBUG]   ✓ Scenario 0: θ = 93719.19 ≤ Q = 93719.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93719.19 ≤ Q = 93719.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93719.19 ≤ Q = 93719.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93719.19 ≤ Q = 93719.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93719.19 ≤ Q = 93719.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93719.19 ≤ Q = 93719.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93719.19 ≤ Q = 93719.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93719.19 ≤ Q = 93719.19 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x12f40bc7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xed0bf439
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.157247e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5306973.2499
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.267171e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126717.14    0  128 5306973.25 -126717.14   102%     -    0s
H    0     0                    -87747.09035 -126717.14  44.4%     -    0s
H    0     0                    -89484.92525 -126717.14  41.6%     -    0s
H    0     0                    -92190.46973 -126717.14  37.5%     -    0s
H    0     0                    -108064.4455 -126717.14  17.3%     -    0s
     0     0 -113750.48    0   64 -108064.45 -113750.48  5.26%     -    0s
H    0     0                    -111625.4265 -113640.02  1.80%     -    0s
     0     0 -113436.82    0   66 -111625.43 -113436.82  1.62%     -    0s
     0     0 -113428.69    0   66 -111625.43 -113428.69  1.62%     -    0s
H    0     0                    -112169.4605 -112902.14  0.65%     -    0s
     0     0 -112902.14    0   50 -112169.46 -112902.14  0.65%     -    0s
     0     0 -112818.13    0   47 -112169.46 -112818.13  0.58%     -    0s
     0     0 -112736.58    0   36 -112169.46 -112736.58  0.51%     -    0s
     0     0 -112733.13    0   36 -112169.46 -112733.13  0.50%     -    0s
     0     0 -112489.26    0   15 -112169.46 -112489.26  0.29%     -    0s
     0     0 -112471.81    0   14 -112169.46 -112471.81  0.27%     -    0s
     0     0 -112436.08    0   24 -112169.46 -112436.08  0.24%     -    0s
     0     0 -112435.35    0   24 -112169.46 -112435.35  0.24%     -    0s
     0     0 -112403.50    0   25 -112169.46 -112403.50  0.21%     -    0s
     0     0 -112403.05    0   24 -112169.46 -112403.05  0.21%     -    0s
     0     0 -112399.55    0   24 -112169.46 -112399.55  0.21%     -    0s
     0     0 -112349.17    0   13 -112169.46 -112349.17  0.16%     -    0s
     0     0 -112349.17    0   20 -112169.46 -112349.17  0.16%     -    0s
     0     0 -112198.29    0   11 -112169.46 -112198.29  0.03%     -    0s
     0     0 -112192.75    0    9 -112169.46 -112192.75  0.02%     -    0s
     0     0 -112192.23    0    9 -112169.46 -112192.23  0.02%     -    0s
     0     0 -112192.18    0    9 -112169.46 -112192.18  0.02%     -    0s
     0     0 -112192.18    0    9 -112169.46 -112192.18  0.02%     -    0s
H    0     0                    -112189.0937 -112190.69  0.00%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 7
  MIR: 5
  Flow cover: 9
  RLT: 2
  Relax-and-lift: 2

Explored 1 nodes (828 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -112189 -112169 -111791 ... 5.30697e+06

Optimal solution found (tolerance 1.00e-06)
Best objective -1.121890936772e+05, best bound -1.121891284335e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 74222.45
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112189.09
  [DEBUG]   S×d_nominal = 186411.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186411.54 + -112189.09 = 74222.45
  [DEBUG]   Current θ from Master = 93719.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19496.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -50389.90
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 2223.5484, Absolute Gap = 2223.5484, Relative Gap = 0.071975
  Not converged yet (gap = 2223.55 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x6198a9dd
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 1.27s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29070   -1.1185673e+05   0.000000e+00   5.243600e+09      5s
   42438   -3.1753169e+04   0.000000e+00   1.483247e+07     10s
   49593   -2.9451897e+04   0.000000e+00   4.954739e+09     15s
   55180   -2.9124309e+04   0.000000e+00   1.916617e+07     20s
   62141   -2.7515045e+04   0.000000e+00   3.038294e+08     25s
   68173   -1.8904345e+04   0.000000e+00   2.502516e+08     30s
   73566   -1.7402601e+04   0.000000e+00   5.940765e+06     35s
   78791   -1.7108342e+04   0.000000e+00   1.255988e+07     40s
   84137   -1.6259351e+04   0.000000e+00   1.276771e+07     45s
   88462   -1.6182188e+04   0.000000e+00   3.250503e+06     50s
   93951   -1.5939194e+04   0.000000e+00   6.210898e+07     55s
   98347   -1.5902729e+04   0.000000e+00   1.148554e+06     60s
  102429   -1.5881269e+04   0.000000e+00   3.382544e+05     65s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective -1.569547e+04, 85829 iterations, 64.01 seconds (124.78 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -15695.475    0  321 -201924.56 -15695.475  92.2%     -   66s
H    0     0                    -196847.7142 -15695.475  92.0%     -   66s
H    0     0                    -86497.56146 -15695.475  81.9%     -   66s
H    0     0                    -86206.07519 -15695.475  81.8%     -   66s
H    0     0                    -40355.69065 -15695.475  61.1%     -   66s
H    0     0                    -39810.20601 -15695.475  60.6%     -   66s
H    0     0                    -39805.41690 -19060.873  52.1%     -   83s
     0     0 -19060.873    0  509 -39805.417 -19060.873  52.1%     -   84s
H    0     0                    -39685.78681 -19061.103  52.0%     -   84s
H    0     0                    -39679.88849 -19223.618  51.6%     -   87s
     0     0 -19241.815    0  497 -39679.888 -19241.815  51.5%     -   88s
     0     0 -19241.815    0  499 -39679.888 -19241.815  51.5%     -   89s
     0     0 -19281.075    0  498 -39679.888 -19281.075  51.4%     -   90s
     0     0 -19286.276    0  501 -39679.888 -19286.276  51.4%     -   91s
     0     0 -19297.534    0  497 -39679.888 -19297.534  51.4%     -   91s
     0     0 -19304.344    0  500 -39679.888 -19304.344  51.3%     -   92s
     0     0 -19415.722    0  506 -39679.888 -19415.722  51.1%     -   93s
     0     0 -19415.987    0  510 -39679.888 -19415.987  51.1%     -   93s
H    0     0                    -39670.54313 -21344.653  46.2%     -  108s
H    0     0                    -38757.71938 -21344.653  44.9%     -  108s
H    0     0                    -38448.09397 -21344.653  44.5%     -  108s
     0     0 -21344.653    0  483 -38448.094 -21344.653  44.5%     -  108s
H    0     0                    -32276.58938 -21345.676  33.9%     -  108s
H    0     0                    -32261.43523 -21345.676  33.8%     -  108s
     0     0 -21668.804    0  544 -32261.435 -21668.804  32.8%     -  116s
     0     0 -21800.009    0  565 -32261.435 -21800.009  32.4%     -  119s
     0     0 -21843.086    0  562 -32261.435 -21843.086  32.3%     -  121s
     0     0 -21874.778    0  596 -32261.435 -21874.778  32.2%     -  123s
     0     0 -21891.005    0  571 -32261.435 -21891.005  32.1%     -  125s
     0     0 -21895.118    0  554 -32261.435 -21895.118  32.1%     -  126s
     0     0 -21895.435    0  558 -32261.435 -21895.435  32.1%     -  126s
     0     0 -23402.560    0  607 -32261.435 -23402.560  27.5%     -  143s
H    0     0                    -31893.64568 -23403.014  26.6%     -  144s
H    0     0                    -31835.49651 -23403.014  26.5%     -  144s
H    0     0                    -31819.33181 -23403.014  26.5%     -  144s
H    0     0                    -31566.38906 -23403.014  25.9%     -  144s
H    0     0                    -31396.07187 -23403.014  25.5%     -  144s
     0     0 -23708.695    0  575 -31396.072 -23708.695  24.5%     -  150s
     0     0 -23984.456    0  579 -31396.072 -23984.456  23.6%     -  155s
     0     0 -24128.044    0  635 -31396.072 -24128.044  23.1%     -  160s
     0     0 -24184.356    0  628 -31396.072 -24184.356  23.0%     -  163s
     0     0 -24288.655    0  614 -31396.072 -24288.655  22.6%     -  165s
     0     0 -24330.924    0  621 -31396.072 -24330.924  22.5%     -  168s
     0     0 -24338.567    0  624 -31396.072 -24338.567  22.5%     -  169s
     0     0 -24363.608    0  557 -31396.072 -24363.608  22.4%     -  171s
     0     0 -24381.771    0  664 -31396.072 -24381.771  22.3%     -  173s
     0     0 -24391.455    0  592 -31396.072 -24391.455  22.3%     -  174s
     0     0 -24395.203    0  560 -31396.072 -24395.203  22.3%     -  175s
     0     0 -24396.027    0  563 -31396.072 -24396.027  22.3%     -  175s
H    0     0                    -31175.76288 -24396.027  21.7%     -  178s
H    0     0                    -31167.69636 -24984.658  19.8%     -  188s
     0     0 -24984.658    0  723 -31167.696 -24984.658  19.8%     -  188s
     0     0 -25118.554    0  720 -31167.696 -25118.554  19.4%     -  193s
     0     0 -25158.966    0  731 -31167.696 -25158.966  19.3%     -  195s
     0     0 -25171.647    0  726 -31167.696 -25171.647  19.2%     -  196s
     0     0 -25184.686    0  729 -31167.696 -25184.686  19.2%     -  198s
     0     0 -25187.171    0  736 -31167.696 -25187.171  19.2%     -  199s
     0     0 -25195.693    0  732 -31167.696 -25195.693  19.2%     -  200s
     0     0 -25227.453    0  723 -31167.696 -25227.453  19.1%     -  201s
     0     0 -25231.369    0  723 -31167.696 -25231.369  19.0%     -  202s
     0     0 -25239.266    0  731 -31167.696 -25239.266  19.0%     -  203s
     0     0 -25242.505    0  752 -31167.696 -25242.505  19.0%     -  204s
     0     0 -25246.905    0  739 -31167.696 -25246.905  19.0%     -  204s
     0     0 -25250.717    0  735 -31167.696 -25250.717  19.0%     -  205s
     0     0 -25253.786    0  731 -31167.696 -25253.786  19.0%     -  205s
     0     0 -25258.285    0  721 -31167.696 -25258.285  19.0%     -  206s
     0     0 -25258.973    0  721 -31167.696 -25258.973  19.0%     -  206s
     0     0 -25395.131    0  719 -31167.696 -25395.131  18.5%     -  212s
     0     0 -25418.474    0  653 -31167.696 -25418.474  18.4%     -  214s
     0     0 -25424.202    0  662 -31167.696 -25424.202  18.4%     -  216s
     0     0 -25428.385    0  664 -31167.696 -25428.385  18.4%     -  217s
     0     0 -25429.898    0  763 -31167.696 -25429.898  18.4%     -  218s
     0     0 -25430.112    0  766 -31167.696 -25430.112  18.4%     -  218s
     0     0 -25498.237    0  764 -31167.696 -25498.237  18.2%     -  223s
H    0     0                    -31166.30728 -25516.690  18.1%     -  227s
     0     0 -25516.690    0  677 -31166.307 -25516.690  18.1%     -  227s
     0     0 -25523.186    0  685 -31166.307 -25523.186  18.1%     -  228s
     0     0 -25529.940    0  680 -31166.307 -25529.940  18.1%     -  229s
     0     0 -25530.463    0  692 -31166.307 -25530.463  18.1%     -  229s
     0     0 -25553.179    0  771 -31166.307 -25553.179  18.0%     -  233s
     0     0 -25576.334    0  760 -31166.307 -25576.334  17.9%     -  235s
     0     0 -25579.699    0  771 -31166.307 -25579.699  17.9%     -  236s
     0     0 -25580.487    0  773 -31166.307 -25580.487  17.9%     -  237s
     0     0 -25600.422    0  789 -31166.307 -25600.422  17.9%     -  241s
     0     0 -25612.491    0  710 -31166.307 -25612.491  17.8%     -  244s
     0     0 -25617.341    0  794 -31166.307 -25617.341  17.8%     -  245s
     0     0 -25620.572    0  808 -31166.307 -25620.572  17.8%     -  246s
     0     0 -25622.662    0  798 -31166.307 -25622.662  17.8%     -  247s
     0     0 -25623.103    0  800 -31166.307 -25623.103  17.8%     -  247s
     0     0 -25636.487    0  714 -31166.307 -25636.487  17.7%     -  250s
     0     0 -25638.635    0  666 -31166.307 -25638.635  17.7%     -  251s
     0     0 -25639.643    0  729 -31166.307 -25639.643  17.7%     -  252s
     0     0 -25655.790    0  787 -31166.307 -25655.790  17.7%     -  255s
     0     0 -25663.160    0  791 -31166.307 -25663.160  17.7%     -  258s
     0     0 -25663.620    0  807 -31166.307 -25663.620  17.7%     -  258s
     0     0 -25668.961    0  794 -31166.307 -25668.961  17.6%     -  260s
     0     0 -25670.354    0  810 -31166.307 -25670.354  17.6%     -  261s
     0     0 -25670.654    0  811 -31166.307 -25670.654  17.6%     -  262s
     0     0 -25674.089    0  812 -31166.307 -25674.089  17.6%     -  264s
     0     0 -25675.872    0  830 -31166.307 -25675.872  17.6%     -  271s
     0     0 -25680.115    0  833 -31166.307 -25680.115  17.6%     -  271s
     0     0 -25680.131    0  833 -31166.307 -25680.131  17.6%     -  272s
     0     0 -25686.860    0  820 -31166.307 -25686.860  17.6%     -  274s
     0     0 -25687.861    0  817 -31166.307 -25687.861  17.6%     -  275s
     0     0 -25691.806    0  816 -31166.307 -25691.806  17.6%     -  276s
     0     0 -25691.878    0  816 -31166.307 -25691.878  17.6%     -  279s
     0     2 -25691.948    0  816 -31166.307 -25691.948  17.6%     -  371s
     3     8 -25784.038    2  800 -31166.307 -25737.503  17.4%  3434  382s
     7    16 -25943.327    3  802 -31166.307 -25784.217  17.3%  5461  390s
    15    32 -26195.462    4  795 -31166.307 -25937.020  16.8%  6513  401s
    31    46 -26333.693    5  762 -31166.307 -26044.075  16.4%  9770  435s
    47    76 -26755.621    6  759 -31166.307 -26044.075  16.4%  9201  452s
    77   171 -26865.658    7  652 -31166.307 -26044.075  16.4%  7874  471s
   185   249 -27138.274    8  493 -31166.307 -26044.075  16.4%  4353  480s
   289   281 -27149.382    9  715 -31166.307 -26044.075  16.4%  3267  489s
   366   287 -27843.846    9  396 -31166.307 -26044.075  16.4%  2840  498s
   406   306 -27254.483    9  498 -31166.307 -26044.075  16.4%  2782  507s
   457   327 -30521.512    9  162 -31166.307 -26044.075  16.4%  2752  517s
   492   351 -28008.099   13  582 -31166.307 -26044.075  16.4%  2774  526s
   526   374 -28061.454   14  645 -31166.307 -26044.075  16.4%  2823  535s
   565   412 infeasible   10      -31166.307 -26044.075  16.4%  2839  544s
   611   446 -28559.052   16  690 -31166.307 -26044.075  16.4%  2914  554s
   663   455     cutoff   17      -31166.307 -26178.390  16.0%  2903  563s
   723   480 -26319.932    6  622 -31166.307 -26179.093  16.0%  2815  572s
   778   516 -26434.026    7  607 -31166.307 -26179.093  16.0%  2782  581s
   836   553 -26543.127    8  592 -31166.307 -26179.093  16.0%  2722  590s
   907   572 -26648.968   10  581 -31166.307 -26179.093  16.0%  2657  600s
   944   593 -30689.277   34  158 -31166.307 -26179.093  16.0%  2624  609s
   997   629 -29792.064   22  512 -31166.307 -26179.093  16.0%  2592  625s
  1069   638 -27284.303    9  412 -31166.307 -26179.093  16.0%  2519  635s
  1150   659 -27803.241   10  344 -31166.307 -26179.093  16.0%  2476  646s
  1245   673 -27870.508   11  342 -31166.307 -26179.093  16.0%  2432  657s
  1344   702 -28244.062   12  380 -31166.307 -26179.093  16.0%  2390  668s
  1431   737 -28638.353   13  381 -31166.307 -26179.093  16.0%  2390  680s
  1528   766 -29191.478   14  364 -31166.307 -26179.093  16.0%  2397  694s
  1603   808 -29590.310   17  364 -31166.307 -26179.093  16.0%  2420  709s
  1693   840 -30438.491   19  285 -31166.307 -26179.093  16.0%  2427  725s
  1796   868     cutoff   20      -31166.307 -26179.093  16.0%  2430  741s
  1888   890 -30808.692   19  528 -31166.307 -26608.956  14.6%  2473  753s
  1935   908     cutoff   20      -31166.307 -26608.956  14.6%  2490  769s
  2024   923 -28735.236    8  433 -31166.307 -26608.956  14.6%  2507  783s
  2067   940 -28807.843    9  428 -31166.307 -26608.956  14.6%  2533  796s
  2150   958 -29022.935   11  404 -31166.307 -26608.956  14.6%  2522  820s
  2189   986 -29060.961   12  393 -31166.307 -26608.956  14.6%  2533  858s
  2253  1029 -29307.132   13  308 -31166.307 -26608.956  14.6%  2547  877s
  2350  1066 -29528.924   14  327 -31166.307 -26608.956  14.6%  2542  892s
  2459  1128 -29789.090   15  332 -31166.307 -27012.319  13.3%  2545  910s
  2579  1170 -29815.580   16  323 -31166.307 -27012.319  13.3%  2533  928s
  2752  1226 -30259.548   17  294 -31166.307 -27012.319  13.3%  2483  947s
  2914  1289 -30317.335   18  274 -31166.307 -27012.319  13.3%  2454  967s
  3129  1315 -30339.315   19  266 -31166.307 -27012.319  13.3%  2412  988s
  3327  1327 -28695.016   11  395 -31166.307 -27012.319  13.3%  2383 1008s
  3482  1337 -30845.105   14  104 -31166.307 -27012.319  13.3%  2402 1030s
  3651  1386 -29031.518   11  348 -31166.307 -27012.319  13.3%  2416 1053s
  3854  1417     cutoff   14      -31166.307 -27281.117  12.5%  2414 1073s
  4010  1440 -31099.659   13  222 -31166.307 -27438.590  12.0%  2420 1098s
  4248  1485 -30123.453   13  414 -31166.307 -27543.066  11.6%  2402 1124s
  4436  1491 -30392.948   16  218 -31166.307 -27543.066  11.6%  2426 1154s
  4683  1480 -29859.651   15  384 -31166.307 -27648.475  11.3%  2434 1180s
  4898  1523     cutoff   18      -31166.307 -27717.288  11.1%  2455 1207s
  5182  1533 -31104.995   12  549 -31166.307 -27771.391  10.9%  2449 1236s
  5468  1554 -30994.884   16  355 -31166.307 -27857.844  10.6%  2427 1267s
  5703  1565 -30735.670   13  107 -31166.307 -27946.113  10.3%  2442 1300s
  5993  1609     cutoff   15      -31166.307 -28042.336  10.0%  2449 1332s
  6343  1592     cutoff   23      -31166.307 -28099.729  9.84%  2446 1366s
  6627  1599 -29789.106   17  342 -31166.307 -28195.881  9.53%  2465 1400s
  6940  1625     cutoff   12      -31166.307 -28286.565  9.24%  2469 1439s
  7328  1618     cutoff   13      -31166.307 -28400.218  8.88%  2460 1478s
  7731  1588 -29336.836   14  439 -31166.307 -28481.838  8.61%  2464 1510s
  7950  1534 -30295.227   14  149 -31166.307 -28566.418  8.34%  2492 1551s
  8356  1518 -29579.178   13  289 -31166.307 -28702.795  7.90%  2488 1599s
  8859  1417 -29026.047   13  399 -31166.307 -28891.564  7.30%  2470 1641s
  9391  1334     cutoff   15      -31166.307 -28989.826  6.98%  2459 1687s
  9972  1139     cutoff   22      -31166.307 -29282.084  6.05%  2437 1733s
 10756   839     cutoff   17      -31166.307 -29636.975  4.91%  2384 1791s
 11733   173     cutoff   10      -31166.307 -29953.196  3.89%  2309 1831s
 13022     0     cutoff   25      -31166.307 -30437.597  2.34%  2185 1838s

Cutting planes:
  Gomory: 2
  Implied bound: 8
  MIR: 1117
  Flow cover: 2542
  Zero half: 5
  RLT: 53
  Relax-and-lift: 149

Explored 13258 nodes (28913778 simplex iterations) in 1838.41 seconds (5149.43 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31166.3 -31167.7 -31175.8 ... -32276.6
No other solutions better than -31166.3

Optimal solution found (tolerance 1.00e-06)
Best objective -3.116630728326e+04, best bound -3.116630728326e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1838.53s
  Master Objective (UB) = -31166.31, θ = 93385.56
  Upper Bound (UB) = -31166.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93385.56
  [DEBUG]   ✓ Scenario 0: θ = 93385.56 ≤ Q = 93385.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93385.56 ≤ Q = 93385.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93385.56 ≤ Q = 93385.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93385.56 ≤ Q = 93385.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93385.56 ≤ Q = 93385.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93385.56 ≤ Q = 93385.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93385.56 ≤ Q = 93385.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93385.56 ≤ Q = 93385.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93385.56 ≤ Q = 93385.56 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7d5b8865
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7d5b8865
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.170851e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5422961.4887
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.239731e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123973.10    0  124 5422961.49 -123973.10   102%     -    0s
H    0     0                    -90076.90595 -123973.10  37.6%     -    0s
H    0     0                    -90635.58608 -123973.10  36.8%     -    0s
     0     0 -101938.51    0   65 -90635.586 -101938.51  12.5%     -    0s
H    0     0                    -99513.16158 -101835.90  2.33%     -    0s
H    0     0                    -99801.23674 -101835.90  2.04%     -    0s
H    0     0                    -100129.5870 -101835.90  1.70%     -    0s
H    0     0                    -100417.6621 -101835.90  1.41%     -    0s
     0     0 -101275.60    0   63 -100417.66 -101275.60  0.85%     -    0s
     0     0 -101258.44    0   62 -100417.66 -101258.44  0.84%     -    0s
     0     0 -101089.31    0   48 -100417.66 -101089.31  0.67%     -    0s
     0     0 -101019.86    0   51 -100417.66 -101019.86  0.60%     -    0s
     0     0 -101013.99    0   51 -100417.66 -101013.99  0.59%     -    0s
     0     0 -100843.61    0   49 -100417.66 -100843.61  0.42%     -    0s
     0     0 -100826.34    0   52 -100417.66 -100826.34  0.41%     -    0s
     0     0 -100775.85    0   51 -100417.66 -100775.85  0.36%     -    0s
     0     0 -100761.32    0   51 -100417.66 -100761.32  0.34%     -    0s
     0     0 -100761.32    0   62 -100417.66 -100761.32  0.34%     -    0s
     0     0 -100761.32    0   51 -100417.66 -100761.32  0.34%     -    0s
H    0     0                    -100429.8728 -100761.32  0.33%     -    0s
     0     0 -100715.42    0   37 -100429.87 -100715.42  0.28%     -    0s
     0     0 -100694.69    0   37 -100429.87 -100694.69  0.26%     -    0s
     0     0 -100692.58    0   36 -100429.87 -100692.58  0.26%     -    0s
     0     0 -100478.75    0   15 -100429.87 -100478.75  0.05%     -    0s
     0     0 -100472.05    0   13 -100429.87 -100472.05  0.04%     -    0s
     0     0 -100463.52    0   10 -100429.87 -100463.52  0.03%     -    0s
     0     0 -100458.81    0   10 -100429.87 -100458.81  0.03%     -    0s
     0     0 -100432.60    0    4 -100429.87 -100432.60  0.00%     -    0s
     0     0     cutoff    0      -100429.96 -100429.96  0.00%     -    0s

Explored 1 nodes (1023 simplex iterations) in 0.13 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -100430 -100430 -100418 ... 1.17085e+13
No other solutions better than -100430

Optimal solution found (tolerance 1.00e-06)
Best objective -1.004299552821e+05, best bound -1.004299552821e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 86269.94
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100429.96
  [DEBUG]   S×d_nominal = 186699.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186699.89 + -100429.96 = 86269.94
  [DEBUG]   Current θ from Master = 93385.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7115.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -38281.93
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 1950.3997, Absolute Gap = 1950.3997, Relative Gap = 0.062580
  Not converged yet (gap = 1950.40 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xcf64e51c
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 1.23s
Presolved: 83583 rows, 35960 columns, 511289 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427100.3350
Found heuristic solution: objective -414882.2319
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.531e+06
 Factor NZ  : 7.611e+06 (roughly 100 MB of memory)
 Factor Ops : 1.289e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37337832e+07  1.56795251e+08  7.05e+04 2.06e+01  6.07e+04     3s
   1  -1.01387673e+07  1.30643415e+08  4.71e+04 5.85e+01  4.01e+04     3s
   2  -4.86859474e+06  9.88642580e+07  2.18e+04 9.18e-12  1.91e+04     3s
   3  -6.35655061e+05  6.61549229e+07  9.18e+02 1.75e+00  1.18e+03     3s
   4  -4.55737712e+05  2.27109667e+07  2.86e+02 3.26e-01  3.55e+02     3s
   5  -3.68420860e+05  1.63462636e+07  1.27e+02 2.07e-01  1.93e+02     3s
   6  -2.09222641e+05  1.20450357e+07  2.62e+01 1.39e-01  9.50e+01     3s
   7  -1.55218563e+05  7.07659481e+06  1.62e+01 7.75e-02  5.33e+01     3s
   8  -1.17449363e+05  3.18002035e+06  6.23e+00 3.14e-02  2.28e+01     3s
   9  -1.04062002e+05  1.44954571e+06  4.30e+00 1.38e-02  1.06e+01     3s
  10  -8.01705802e+04  5.51724466e+05  1.87e+00 5.15e-03  4.21e+00     3s
  11  -5.76648241e+04  1.87028194e+05  8.26e-01 1.67e-03  1.61e+00     3s
  12  -4.49034146e+04  7.10741327e+04  4.60e-01 1.63e-03  7.62e-01     3s
  13  -3.97661282e+04  4.69914872e+04  3.67e-01 1.62e-03  5.70e-01     3s
  14  -3.57411455e+04  3.46772727e+04  3.03e-01 1.81e-03  4.62e-01     3s
  15  -3.23751137e+04  2.19709585e+04  2.54e-01 2.00e-03  3.57e-01     3s
  16  -2.87697982e+04  1.44793015e+04  2.04e-01 1.85e-03  2.84e-01     3s
  17  -2.58986814e+04  4.77065938e+03  1.66e-01 2.42e-03  2.01e-01     3s
  18  -2.40226026e+04  3.76026666e+02  1.40e-01 2.40e-03  1.60e-01     3s
  19  -2.17472449e+04 -1.91438949e+03  1.10e-01 2.13e-03  1.30e-01     3s
  20  -2.07798831e+04 -4.43513877e+03  9.80e-02 2.00e-03  1.07e-01     3s
  21  -1.93447479e+04 -5.98337976e+03  8.02e-02 1.76e-03  8.77e-02     3s
  22  -1.75112883e+04 -7.62332314e+03  5.83e-02 1.61e-03  6.49e-02     3s
  23  -1.68215450e+04 -9.29046123e+03  5.00e-02 1.00e-03  4.95e-02     3s
  24  -1.59250321e+04 -9.98262663e+03  4.00e-02 1.54e-03  3.90e-02     4s
  25  -1.55103885e+04 -1.04594540e+04  3.58e-02 1.38e-03  3.32e-02     4s
  26  -1.47648969e+04 -1.08172028e+04  2.79e-02 1.02e-03  2.60e-02     4s
  27  -1.43555784e+04 -1.11134441e+04  2.33e-02 6.98e-04  2.13e-02     4s
  28  -1.38625977e+04 -1.13728194e+04  1.81e-02 8.21e-04  1.64e-02     4s
  29  -1.34456099e+04 -1.16278038e+04  1.35e-02 1.33e-03  1.20e-02     4s
  30  -1.30636241e+04 -1.17702815e+04  9.45e-03 9.50e-04  8.50e-03     4s
  31  -1.27254859e+04 -1.19215523e+04  6.07e-03 5.02e-04  5.29e-03     4s
  32  -1.25504513e+04 -1.19913156e+04  4.33e-03 2.95e-04  3.68e-03     4s
  33  -1.24697298e+04 -1.20169259e+04  3.52e-03 2.29e-04  2.98e-03     4s
  34  -1.24260050e+04 -1.20400522e+04  3.07e-03 1.68e-04  2.54e-03     4s
  35  -1.23701369e+04 -1.20501114e+04  2.53e-03 1.50e-04  2.11e-03     4s
  36  -1.22828945e+04 -1.20832888e+04  1.68e-03 1.00e-04  1.31e-03     4s
  37  -1.22707070e+04 -1.20870947e+04  1.56e-03 7.56e-05  1.21e-03     4s
  38  -1.22190195e+04 -1.20896988e+04  1.06e-03 6.05e-05  8.51e-04     4s
  39  -1.22091855e+04 -1.20904721e+04  9.70e-04 5.69e-05  7.81e-04     4s
  40  -1.22018082e+04 -1.20921602e+04  9.03e-04 4.91e-05  7.22e-04     4s
  41  -1.21814843e+04 -1.20964808e+04  7.16e-04 1.61e-05  5.60e-04     4s
  42  -1.21298455e+04 -1.20982354e+04  2.33e-04 1.15e-05  2.08e-04     4s
  43  -1.21142776e+04 -1.20999560e+04  9.76e-05 7.56e-06  9.41e-05     5s
  44  -1.21050960e+04 -1.21016596e+04  2.15e-05 4.79e-06  2.26e-05     5s
  45  -1.21036807e+04 -1.21021922e+04  1.05e-05 5.82e-07  9.79e-06     5s
  46  -1.21035478e+04 -1.21022419e+04  9.43e-06 3.07e-07  8.59e-06     5s
  47  -1.21028060e+04 -1.21022659e+04  6.72e-06 8.94e-07  3.55e-06     5s
  48  -1.21022926e+04 -1.21022902e+04  3.29e-08 2.56e-08  1.54e-08     5s
  49  -1.21022921e+04 -1.21022903e+04  2.90e-07 9.72e-08  1.20e-08     5s
  50  -1.21022921e+04 -1.21022903e+04  2.94e-07 9.85e-08  1.15e-08     5s
  51  -1.21022915e+04 -1.21022904e+04  2.62e-07 1.66e-07  7.06e-09     5s
  52  -1.21022912e+04 -1.21022904e+04  1.42e-06 1.35e-07  5.19e-09     5s
  53  -1.21022909e+04 -1.21022904e+04  8.57e-07 7.86e-08  3.13e-09     5s
  54  -1.21022907e+04 -1.21022904e+04  9.03e-07 1.12e-07  1.80e-09     5s
  55  -1.21022904e+04 -1.21022904e+04  4.18e-07 6.97e-08  2.14e-11     5s

Barrier solved model in 55 iterations and 5.23 seconds (7.66 work units)
Optimal objective -1.21022904e+04


Root crossover log...

   68088 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2684 PPushes remaining with PInf 5.0157795e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.2700498e-02      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33603   -1.2102290e+04   0.000000e+00   9.270050e-02      7s
   33606   -1.2102290e+04   0.000000e+00   0.000000e+00      7s
   33606   -1.2102290e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective -1.210229e+04, 33606 iterations, 5.60 seconds (11.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -12102.290    0  404 -201924.56 -12102.290  94.0%     -    7s
H    0     0                    -198056.9477 -12102.290  93.9%     -    7s
H    0     0                    -147824.3820 -12102.290  91.8%     -    8s
H    0     0                    -142156.7454 -12102.290  91.5%     -    8s
H    0     0                    -142038.2418 -12102.290  91.5%     -    8s
H    0     0                    -142036.6991 -12102.290  91.5%     -    8s
H    0     0                    -116622.1577 -12102.290  89.6%     -    8s
H    0     0                    -113598.7823 -12102.290  89.3%     -    8s
H    0     0                    -113063.0489 -12102.290  89.3%     -    8s
H    0     0                    -76472.41859 -12102.290  84.2%     -    8s
H    0     0                    -73229.45564 -12102.290  83.5%     -    8s
H    0     0                    -72512.75259 -12102.290  83.3%     -    8s
H    0     0                    -72345.52207 -12102.290  83.3%     -    8s
H    0     0                    -72247.30460 -12102.290  83.2%     -    8s
H    0     0                    -71985.51595 -12102.290  83.2%     -    8s
H    0     0                    -71936.34795 -12102.290  83.2%     -    8s
H    0     0                    -71850.28843 -12102.290  83.2%     -    8s
H    0     0                    -71826.99363 -12102.290  83.2%     -    8s
H    0     0                    -71764.05851 -12102.290  83.1%     -    8s
H    0     0                    -71736.01597 -12102.290  83.1%     -    8s
H    0     0                    -71649.56545 -12102.290  83.1%     -    8s
H    0     0                    -71640.17145 -12102.290  83.1%     -    8s
H    0     0                    -71612.12891 -12102.290  83.1%     -    8s
H    0     0                    -71593.96614 -12103.317  83.1%     -   10s
H    0     0                    -71565.92360 -12103.317  83.1%     -   10s
H    0     0                    -70007.24263 -17002.761  75.7%     -   34s
H    0     0                    -69964.78252 -17002.761  75.7%     -   34s
H    0     0                    -69783.30549 -17002.761  75.6%     -   34s
H    0     0                    -67715.05538 -17002.761  74.9%     -   34s
H    0     0                    -67688.79742 -17002.761  74.9%     -   34s
H    0     0                    -65810.43401 -17002.761  74.2%     -   34s
H    0     0                    -65802.79183 -17002.761  74.2%     -   34s
H    0     0                    -65732.51890 -17002.761  74.1%     -   34s
H    0     0                    -65719.37868 -17002.761  74.1%     -   34s
H    0     0                    -65704.22453 -17002.761  74.1%     -   34s
     0     0 -17002.761    0  524 -65704.225 -17002.761  74.1%     -   34s
     0     0 -17387.275    0  599 -65704.225 -17387.275  73.5%     -   40s
     0     0 -17486.470    0  592 -65704.225 -17486.470  73.4%     -   42s
     0     0 -17546.573    0  605 -65704.225 -17546.573  73.3%     -   45s
     0     0 -17546.573    0  595 -65704.225 -17546.573  73.3%     -   48s
     0     0 -17546.573    0  599 -65704.225 -17546.573  73.3%     -   48s
     0     0 -17546.573    0  603 -65704.225 -17546.573  73.3%     -   49s
     0     0 -17546.573    0  603 -65704.225 -17546.573  73.3%     -   49s
H    0     0                    -63109.68612 -20462.178  67.6%     -   72s
H    0     0                    -63105.19542 -20462.178  67.6%     -   72s
H    0     0                    -62928.71186 -20462.178  67.5%     -   72s
H    0     0                    -62909.47984 -20462.178  67.5%     -   72s
H    0     0                    -62795.43557 -20462.178  67.4%     -   72s
     0     0 -20462.178    0  504 -62795.436 -20462.178  67.4%     -   72s
H    0     0                    -54987.14193 -20462.252  62.8%     -   72s
     0     0 -20599.880    0  575 -54987.142 -20599.880  62.5%     -   79s
     0     0 -20762.558    0  582 -54987.142 -20762.558  62.2%     -   86s
     0     0 -20886.633    0  646 -54987.142 -20886.633  62.0%     -   94s
     0     0 -20940.120    0  589 -54987.142 -20940.120  61.9%     -   98s
     0     0 -20959.810    0  587 -54987.142 -20959.810  61.9%     -   99s
     0     0 -20963.236    0  600 -54987.142 -20963.236  61.9%     -  100s
     0     0 -20965.693    0  590 -54987.142 -20965.693  61.9%     -  101s
     0     0 -20967.850    0  593 -54987.142 -20967.850  61.9%     -  102s
     0     0 -20991.927    0  582 -54987.142 -20991.927  61.8%     -  105s
     0     0 -20993.378    0  586 -54987.142 -20993.378  61.8%     -  106s
     0     0 -21001.393    0  648 -54987.142 -21001.393  61.8%     -  107s
     0     0 -21003.942    0  649 -54987.142 -21003.942  61.8%     -  108s
     0     0 -21015.510    0  644 -54987.142 -21015.510  61.8%     -  109s
     0     0 -21016.568    0  645 -54987.142 -21016.568  61.8%     -  110s
H    0     0                    -43121.37430 -22189.076  48.5%     -  139s
H    0     0                    -43025.46688 -22189.076  48.4%     -  139s
H    0     0                    -43000.08989 -22189.076  48.4%     -  139s
H    0     0                    -42805.70421 -22189.076  48.2%     -  139s
H    0     0                    -37330.99072 -22189.076  40.6%     -  139s
H    0     0                    -35324.53261 -22189.076  37.2%     -  139s
     0     0 -22189.076    0  630 -35324.533 -22189.076  37.2%     -  139s
H    0     0                    -35219.75481 -22189.152  37.0%     -  140s
H    0     0                    -35186.30686 -22378.817  36.4%     -  152s
H    0     0                    -35061.48941 -22378.817  36.2%     -  152s
H    0     0                    -34809.23223 -22378.817  35.7%     -  152s
H    0     0                    -34783.78168 -22378.817  35.7%     -  152s
H    0     0                    -34769.60752 -22378.817  35.6%     -  152s
     0     0 -22378.817    0  648 -34769.608 -22378.817  35.6%     -  152s
     0     0 -22420.366    0  565 -34769.608 -22420.366  35.5%     -  160s
     0     0 -22544.774    0  574 -34769.608 -22544.774  35.2%     -  167s
     0     0 -22553.911    0  655 -34769.608 -22553.911  35.1%     -  168s
     0     0 -22556.272    0  574 -34769.608 -22556.272  35.1%     -  170s
     0     0 -22558.684    0  644 -34769.608 -22558.684  35.1%     -  172s
     0     0 -22575.128    0  661 -34769.608 -22575.128  35.1%     -  174s
     0     0 -22580.257    0  670 -34769.608 -22580.257  35.1%     -  176s
     0     0 -22681.951    0  648 -34769.608 -22681.951  34.8%     -  183s
     0     0 -22723.417    0  646 -34769.608 -22723.417  34.6%     -  187s
     0     0 -22729.272    0  654 -34769.608 -22729.272  34.6%     -  189s
     0     0 -22731.834    0  652 -34769.608 -22731.834  34.6%     -  191s
     0     0 -22739.399    0  658 -34769.608 -22739.399  34.6%     -  192s
     0     0 -22740.154    0  655 -34769.608 -22740.154  34.6%     -  193s
H    0     0                    -34749.84233 -22740.154  34.6%     -  201s
H    0     0                    -34722.27952 -22740.154  34.5%     -  201s
H    0     0                    -33244.20674 -22740.154  31.6%     -  201s
H    0     0                    -33229.05258 -22740.154  31.6%     -  201s
H    0     0                    -32973.43738 -23665.775  28.2%     -  223s
H    0     0                    -32958.88838 -23665.775  28.2%     -  223s
H    0     0                    -32905.67601 -23665.775  28.1%     -  223s
H    0     0                    -32623.96187 -23665.775  27.5%     -  223s
H    0     0                    -32500.75879 -23665.775  27.2%     -  223s
H    0     0                    -32459.83801 -23665.775  27.1%     -  223s
H    0     0                    -32447.54642 -23665.775  27.1%     -  223s
H    0     0                    -32337.17166 -23665.775  26.8%     -  223s
H    0     0                    -32296.25088 -23665.775  26.7%     -  223s
H    0     0                    -32283.95929 -23665.775  26.7%     -  223s
H    0     0                    -32244.57992 -23665.775  26.6%     -  223s
H    0     0                    -32194.21012 -23665.775  26.5%     -  223s
     0     0 -23665.775    0  690 -32194.210 -23665.775  26.5%     -  223s
H    0     0                    -32186.14361 -23666.122  26.5%     -  224s
     0     0 -23832.031    0  679 -32186.144 -23832.031  26.0%     -  235s
     0     0 -23912.062    0  700 -32186.144 -23912.062  25.7%     -  243s
     0     0 -23951.054    0  732 -32186.144 -23951.054  25.6%     -  249s
     0     0 -23966.567    0  645 -32186.144 -23966.567  25.5%     -  251s
     0     0 -23983.266    0  568 -32186.144 -23983.266  25.5%     -  253s
     0     0 -24000.861    0  566 -32186.144 -24000.861  25.4%     -  255s
     0     0 -24004.155    0  574 -32186.144 -24004.155  25.4%     -  256s
     0     0 -24024.946    0  645 -32186.144 -24024.946  25.4%     -  257s
     0     0 -24028.853    0  640 -32186.144 -24028.853  25.3%     -  259s
H    0     0                    -32089.43232 -24034.204  25.1%     -  259s
     0     0 -24034.204    0  634 -32089.432 -24034.204  25.1%     -  259s
     0     0 -24035.082    0  634 -32089.432 -24035.082  25.1%     -  260s
H    0     0                    -32074.27816 -24395.816  23.9%     -  273s
     0     0 -24395.816    0  721 -32074.278 -24395.816  23.9%     -  273s
H    0     0                    -31852.17601 -24395.932  23.4%     -  274s
H    0     0                    -31822.81312 -24395.932  23.3%     -  274s
     0     0 -24478.984    0  730 -31822.813 -24478.984  23.1%     -  281s
     0     0 -24524.030    0  724 -31822.813 -24524.030  22.9%     -  285s
     0     0 -24536.004    0  715 -31822.813 -24536.004  22.9%     -  287s
     0     0 -24539.236    0  734 -31822.813 -24539.236  22.9%     -  288s
     0     0 -24547.842    0  719 -31822.813 -24547.842  22.9%     -  290s
     0     0 -24551.536    0  763 -31822.813 -24551.536  22.8%     -  291s
     0     0 -24554.616    0  741 -31822.813 -24554.616  22.8%     -  291s
     0     0 -24555.088    0  739 -31822.813 -24555.088  22.8%     -  292s
     0     0 -24772.460    0  757 -31822.813 -24772.460  22.2%     -  304s
H    0     0                    -31591.10314 -24772.934  21.6%     -  305s
H    0     0                    -31432.84149 -24772.934  21.2%     -  305s
H    0     0                    -31396.18651 -24772.934  21.1%     -  305s
H    0     0                    -31320.19212 -24772.934  20.9%     -  305s
H    0     0                    -31311.83050 -24772.934  20.9%     -  305s
H    0     0                    -31286.93142 -24772.934  20.8%     -  305s
H    0     0                    -31252.45312 -24772.934  20.7%     -  305s
     0     0 -24804.856    0  666 -31252.453 -24804.856  20.6%     -  308s
     0     0 -24819.752    0  764 -31252.453 -24819.752  20.6%     -  311s
     0     0 -24825.992    0  673 -31252.453 -24825.992  20.6%     -  313s
     0     0 -24826.652    0  677 -31252.453 -24826.652  20.6%     -  314s
     0     0 -24905.268    0  718 -31252.453 -24905.268  20.3%     -  322s
     0     0 -24934.396    0  720 -31252.453 -24934.396  20.2%     -  327s
     0     0 -24940.709    0  743 -31252.453 -24940.709  20.2%     -  329s
     0     0 -24945.714    0  740 -31252.453 -24945.714  20.2%     -  331s
     0     0 -24951.579    0  679 -31252.453 -24951.579  20.2%     -  332s
     0     0 -24954.618    0  738 -31252.453 -24954.618  20.2%     -  333s
     0     0 -24955.056    0  746 -31252.453 -24955.056  20.2%     -  334s
     0     0 -25035.529    0  744 -31252.453 -25035.529  19.9%     -  342s
H    0     0                    -31244.38844 -25035.594  19.9%     -  343s
     0     0 -25053.202    0  742 -31244.388 -25053.202  19.8%     -  346s
     0     0 -25057.230    0  760 -31244.388 -25057.230  19.8%     -  348s
     0     0 -25073.210    0  743 -31244.388 -25073.210  19.8%     -  350s
     0     0 -25076.893    0  763 -31244.388 -25076.893  19.7%     -  352s
     0     0 -25078.315    0  766 -31244.388 -25078.315  19.7%     -  353s
     0     0 -25127.383    0  748 -31244.388 -25127.383  19.6%     -  359s
     0     0 -25145.416    0  766 -31244.388 -25145.416  19.5%     -  363s
     0     0 -25148.562    0  764 -31244.388 -25148.562  19.5%     -  364s
     0     0 -25149.431    0  757 -31244.388 -25149.431  19.5%     -  365s
     0     0 -25166.107    0  796 -31244.388 -25166.107  19.5%     -  369s
     0     0 -25169.425    0  762 -31244.388 -25169.425  19.4%     -  371s
     0     0 -25170.327    0  760 -31244.388 -25170.327  19.4%     -  372s
     0     0 -25182.719    0  802 -31244.388 -25182.719  19.4%     -  376s
     0     0 -25189.357    0  763 -31244.388 -25189.357  19.4%     -  379s
     0     0 -25191.954    0  770 -31244.388 -25191.954  19.4%     -  380s
     0     0 -25198.671    0  816 -31244.388 -25198.671  19.3%     -  381s
     0     0 -25200.519    0  821 -31244.388 -25200.519  19.3%     -  382s
     0     0 -25209.962    0  778 -31244.388 -25209.962  19.3%     -  386s
     0     0 -25210.810    0  784 -31244.388 -25210.810  19.3%     -  390s
     0     0 -25217.348    0  775 -31244.388 -25217.348  19.3%     -  393s
     0     0 -25219.071    0  787 -31244.388 -25219.071  19.3%     -  394s
     0     0 -25223.133    0  775 -31244.388 -25223.133  19.3%     -  397s
     0     0 -25223.349    0  775 -31244.388 -25223.349  19.3%     -  401s
     0     2 -25223.349    0  775 -31244.388 -25223.349  19.3%     -  466s
     1     4 -25293.348    1  743 -31244.388 -25223.349  19.3%  4145  471s
     3     8 -25469.716    2  731 -31244.388 -25293.845  19.0%  5798  480s
     7    16 -25499.043    3  731 -31244.388 -25469.939  18.5%  6982  496s
    15    32 -25633.872    4  752 -31244.388 -25499.120  18.4%  9152  512s
    31    48 -26481.992    5  494 -31244.388 -25634.263  18.0% 13261  551s
    47    80 -28174.046    6  363 -31244.388 -25634.263  18.0% 15523  572s
    79   133 -28202.346    7  348 -31244.388 -25634.263  18.0% 11914  608s
   132   227 -28355.878    9  336 -31244.388 -25634.263  18.0%  8781  625s
   228   323 -28434.165   11  330 -31244.388 -25634.263  18.0%  6313  635s
   345   373 -28760.509   12  292 -31244.388 -25634.263  18.0%  5036  647s
   423   397 -28887.113   13  228 -31244.388 -25634.263  18.0%  4827  658s
   485   409 -28992.579   14  312 -31244.388 -25634.263  18.0%  4814  671s
   529   429 -30325.141   14  178 -31244.388 -25634.263  18.0%  4958  693s
   577   440 -29278.520   14  306 -31244.388 -25634.263  18.0%  4987  706s
   632   453 -30576.433   14  180 -31244.388 -25634.263  18.0%  4975  719s
   680   460 -29490.917   15  226 -31244.388 -25634.263  18.0%  4991  732s
   734   471 -30412.762   15  201 -31244.388 -25634.263  18.0%  5081  744s
   781   493 -29808.256   15  299 -31244.388 -25634.263  18.0%  5131  757s
   851   508 -29906.085   16  287 -31244.388 -25634.263  18.0%  5026  769s
   917   520 infeasible   17      -31244.388 -25634.263  18.0%  4913  781s
   995   539 -28629.533   11  486 -31244.388 -25634.263  18.0%  4923  820s
  1066   549 -28648.615   12  492 -31244.388 -25634.263  18.0%  4868  836s
  1142   577 -29127.218   13  508 -31244.388 -25634.263  18.0%  4854  850s
  1212   596 -29628.825   14  417 -31244.388 -25634.263  18.0%  4920  864s
  1266   615 -29665.321   15  518 -31244.388 -25634.263  18.0%  5002  878s
  1351   638 -30123.109   14  412 -31244.388 -25634.263  18.0%  5064  896s
  1412   682 -30377.996   15  409 -31244.388 -25634.263  18.0%  5170  911s
  1490   706 -30713.714   16  400 -31244.388 -25634.263  18.0%  5254  927s
  1578   746 -30385.836   16  218 -31244.388 -25634.263  18.0%  5281  944s
  1680   790 -30900.162   18  398 -31244.388 -25634.263  18.0%  5333  961s
  1798   831     cutoff   26      -31244.388 -25634.263  18.0%  5301  979s
  1896   867 -29525.754    8  195 -31244.388 -25634.263  18.0%  5297  997s
  2014   933 -30194.621   10  147 -31244.388 -25634.263  18.0%  5337 1018s
  2149  1011 -30635.037   14  195 -31244.388 -25634.263  18.0%  5314 1037s
  2311  1036 -31053.052   19  153 -31244.388 -25634.263  18.0%  5258 1057s
  2447  1083 -28347.041   10  415 -31244.388 -25801.178  17.4%  5222 1079s
  2571  1133 -29158.086   10  407 -31244.388 -25801.178  17.4%  5252 1100s
  2705  1171 -29693.880   11  339 -31244.388 -25900.737  17.1%  5268 1121s
  2817  1205 -28105.259    8  591 -31244.388 -25900.737  17.1%  5275 1146s
  2934  1282 -28156.836    9  495 -31244.388 -25900.737  17.1%  5335 1168s
  3084  1344 -28391.651   11  518 -31244.388 -26228.571  16.1%  5360 1191s
  3259  1394 -29186.320   14  278 -31244.388 -26228.571  16.1%  5350 1220s
  3422  1485 -30779.558   18  167 -31244.388 -26228.571  16.1%  5372 1247s
  3605  1573 -28029.124   12  228 -31244.388 -26440.409  15.4%  5379 1274s
  3831  1650 -30251.070   14  116 -31244.388 -26440.409  15.4%  5281 1303s
  4030  1698 -29640.089   13  504 -31244.388 -26614.359  14.8%  5246 1334s
  4200  1807 -30223.567   16  351 -31244.388 -26614.359  14.8%  5288 1367s
  4407  1854 -30859.032   18  331 -31244.388 -26614.359  14.8%  5314 1395s
  4516  1911 -30945.964   20  205 -31244.388 -27129.331  13.2%  5304 1429s
  4709  1972 infeasible   12      -31244.388 -27129.331  13.2%  5312 1464s
  4919  2043 infeasible   13      -31244.388 -27129.331  13.2%  5337 1500s
  5171  2088 -27819.931   10  334 -31244.388 -27252.140  12.8%  5346 1540s
  5397  2146 -30828.037   13  230 -31244.388 -27288.994  12.7%  5400 1581s
  5593  2185 -30878.997   16  294 -31244.388 -27288.994  12.7%  5481 1622s
  5847  2242 -30941.784   15  141 -31244.388 -27375.254  12.4%  5517 1666s
  6122  2298 -30459.800   20  281 -31244.388 -27375.254  12.4%  5534 1711s
  6382  2335 infeasible   14      -31244.388 -27375.254  12.4%  5583 1755s
  6643  2350 -28732.453   15  373 -31244.388 -27596.016  11.7%  5657 1792s
  6694  2380 -28838.094   16  225 -31244.388 -27596.016  11.7%  5686 1838s
  6924  2442 -29963.903   20  291 -31244.388 -27717.972  11.3%  5687 1887s
  7234  2519 -30886.590   17  212 -31244.388 -27783.742  11.1%  5726 1939s
  7591  2544 -30968.267   21  185 -31244.388 -27849.710  10.9%  5729 1997s
  7956  2566 infeasible   13      -31244.388 -27881.513  10.8%  5731 2051s
  8342  2610     cutoff   10      -31244.388 -27945.979  10.6%  5719 2107s
  8727  2649 infeasible   11      -31244.388 -28014.815  10.3%  5745 2162s
  8937  2691 -30443.716   11  463 -31244.388 -28024.506  10.3%  5745 2222s
  9470  2669 infeasible   13      -31244.388 -28105.752  10.0%  5714 2284s
  9993  2714     cutoff   15      -31244.388 -28237.530  9.62%  5706 2347s
 10525  2745 -31130.389   23  158 -31244.388 -28301.253  9.42%  5693 2413s
 11008  2726 infeasible   21      -31244.388 -28430.295  9.01%  5707 2481s
 11528  2631 infeasible   15      -31244.388 -28551.250  8.62%  5709 2554s
 12109  2591 -29609.207   19  379 -31244.388 -28609.141  8.43%  5709 2626s
 12709  2574 infeasible   20      -31244.388 -28847.038  7.67%  5692 2703s
 13363  2430 infeasible   16      -31244.388 -28983.552  7.24%  5672 2785s
 14032  2299     cutoff   14      -31244.388 -29239.963  6.42%  5662 2859s
 14291  2129     cutoff   17      -31244.388 -29277.048  6.30%  5661 2944s
 14946  1862 -31096.796   12  186 -31244.388 -29437.872  5.78%  5625 3030s
 15879  1403     cutoff   28      -31244.388 -29738.863  4.82%  5534 3121s
 16919   478 infeasible   25      -31244.388 -30104.809  3.65%  5435 3205s
 18409     0 infeasible   19      -31244.388 -30591.429  2.09%  5222 3236s

Cutting planes:
  Implied bound: 33
  MIR: 2709
  Flow cover: 4241
  Inf proof: 1
  Zero half: 3
  RLT: 111
  Relax-and-lift: 708

Explored 18981 nodes (97729372 simplex iterations) in 3236.73 seconds (9514.77 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31244.4 -31252.5 -31286.9 ... -31852.2
No other solutions better than -31244.4

Optimal solution found (tolerance 1.00e-06)
Best objective -3.124438843642e+04, best bound -3.124438843642e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3236.81s
  Master Objective (UB) = -31244.39, θ = 93467.63
  Upper Bound (UB) = -31244.39

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93467.63
  [DEBUG]   ✓ Scenario 0: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93467.63 ≤ Q = 93467.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93467.63 ≤ Q = 93467.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6f1615cd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x90e9ea33
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177653e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5435441.2397
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.233504e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123350.38    0  124 5435441.24 -123350.38   102%     -    0s
H    0     0                    -89526.77188 -123350.38  37.8%     -    0s
H    0     0                    -90085.45201 -123350.38  36.9%     -    0s
     0     0 -99656.726    0   30 -90085.452 -99656.726  10.6%     -    0s
H    0     0                    -98748.54405 -99617.319  0.88%     -    0s
     0     0 -99297.123    0   21 -98748.544 -99297.123  0.56%     -    0s
H    0     0                    -98935.58219 -99198.078  0.27%     -    0s
     0     0 -99184.164    0   14 -98935.582 -99184.164  0.25%     -    0s
     0     0 -99183.931    0   13 -98935.582 -99183.931  0.25%     -    0s
     0     0 -99183.063    0   14 -98935.582 -99183.063  0.25%     -    0s
     0     0 -99111.238    0    9 -98935.582 -99111.238  0.18%     -    0s
     0     0 -99111.238    0   21 -98935.582 -99111.238  0.18%     -    0s
H    0     0                    -98977.13893 -99111.238  0.14%     -    0s
     0     0 -99068.639    0    9 -98977.139 -99068.639  0.09%     -    0s
H    0     0                    -99030.96553 -99068.207  0.04%     -    0s
H    0     0                    -99033.00827 -99068.207  0.04%     -    0s
H    0     0                    -99046.06280 -99062.713  0.02%     -    0s
     0     0 -99062.713    0    7 -99046.063 -99062.713  0.02%     -    0s
     0     0 -99053.422    0    4 -99046.063 -99053.422  0.01%     -    0s
     0     0     cutoff    0      -99046.063 -99046.063  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 11
  Flow cover: 5

Explored 1 nodes (596 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -99046.1 -99033 -99031 ... 1.17765e+13
No other solutions better than -99046.1

Optimal solution found (tolerance 1.00e-06)
Best objective -9.904606279704e+04, best bound -9.904606279704e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 87168.34
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99046.06
  [DEBUG]   S×d_nominal = 186214.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186214.40 + -99046.06 = 87168.34
  [DEBUG]   Current θ from Master = 93467.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6299.30 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -37543.69
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 1872.3185, Absolute Gap = 1872.3185, Relative Gap = 0.059925
  Not converged yet (gap = 1872.32 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0xfa628ed3
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 1.38s
Presolved: 91803 rows, 39330 columns, 558599 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427060.7230
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 620
 AA' NZ     : 3.165e+06
 Factor NZ  : 7.259e+06 (roughly 110 MB of memory)
 Factor Ops : 1.301e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37399931e+07  1.69760113e+08  7.05e+04 1.98e+01  6.03e+04     3s
   1  -1.02340277e+07  1.41741374e+08  4.75e+04 5.67e+01  4.01e+04     3s
   2  -4.29575815e+06  1.08231106e+08  1.92e+04 3.73e+00  1.68e+04     3s
   3  -6.41709859e+05  6.94180352e+07  9.33e+02 1.23e+00  1.16e+03     3s
   4  -4.46863575e+05  2.22965404e+07  2.67e+02 1.99e-01  3.21e+02     3s
   5  -3.48458074e+05  1.61286377e+07  1.12e+02 1.30e-01  1.70e+02     3s
   6  -1.97659335e+05  1.34467194e+07  3.05e+01 1.03e-01  9.89e+01     3s
   7  -1.61527575e+05  1.00745905e+07  1.73e+01 7.46e-02  6.89e+01     3s
   8  -1.19540644e+05  3.29465063e+06  8.04e+00 1.87e-02  2.20e+01     3s
   9  -1.03744596e+05  2.18759394e+06  5.86e+00 1.20e-02  1.45e+01     3s
  10  -8.22332766e+04  6.12984637e+05  3.76e+00 3.32e-03  4.34e+00     3s
  11  -6.03470827e+04  3.25221107e+05  2.07e+00 2.15e-03  2.36e+00     3s
  12  -4.83893897e+04  1.12569051e+05  9.56e-01 1.35e-03  9.70e-01     3s
  13  -4.16520480e+04  5.35687043e+04  6.15e-01 9.38e-04  5.71e-01     3s
  14  -3.72082014e+04  3.46368721e+04  4.71e-01 2.06e-03  4.30e-01     3s
  15  -3.38809190e+04  2.63681543e+04  3.98e-01 1.58e-03  3.61e-01     3s
  16  -3.01452539e+04  1.12584404e+04  3.28e-01 2.16e-03  2.48e-01     3s
  17  -2.79151446e+04  5.13926640e+03  2.88e-01 3.59e-03  1.98e-01     3s
  18  -2.45953576e+04  5.34204409e+02  2.29e-01 2.70e-03  1.50e-01     3s
  19  -2.29682197e+04 -1.30374656e+03  1.99e-01 2.38e-03  1.30e-01     3s
  20  -2.06820990e+04 -3.18253020e+03  1.56e-01 2.27e-03  1.05e-01     3s
  21  -1.89239266e+04 -5.37300419e+03  1.23e-01 2.34e-03  8.10e-02     3s
  22  -1.73939750e+04 -6.34106649e+03  9.66e-02 1.83e-03  6.60e-02     3s
  23  -1.67494928e+04 -7.63857163e+03  8.45e-02 1.36e-03  5.44e-02     3s
  24  -1.60483260e+04 -9.01614003e+03  7.18e-02 1.24e-03  4.20e-02     3s
  25  -1.50902017e+04 -9.63247293e+03  5.63e-02 9.82e-04  3.26e-02     3s
  26  -1.44480175e+04 -1.01655450e+04  4.61e-02 1.11e-03  2.56e-02     4s
  27  -1.39498469e+04 -1.04822379e+04  3.81e-02 9.74e-04  2.07e-02     4s
  28  -1.37978251e+04 -1.05095569e+04  3.57e-02 9.26e-04  1.96e-02     4s
  29  -1.36145717e+04 -1.06682859e+04  3.26e-02 8.50e-04  1.76e-02     4s
  30  -1.32164240e+04 -1.09945626e+04  2.55e-02 9.23e-04  1.33e-02     4s
  31  -1.30174399e+04 -1.11263726e+04  2.24e-02 9.20e-04  1.13e-02     4s
  32  -1.28228379e+04 -1.12224457e+04  1.93e-02 6.42e-04  9.56e-03     4s
  33  -1.25575012e+04 -1.13546027e+04  1.51e-02 5.53e-04  7.19e-03     4s
  34  -1.24695364e+04 -1.13971500e+04  1.37e-02 4.48e-04  6.41e-03     4s
  35  -1.22314897e+04 -1.14371584e+04  9.88e-03 3.83e-04  4.75e-03     4s
  36  -1.21881225e+04 -1.14485533e+04  9.22e-03 3.69e-04  4.42e-03     4s
  37  -1.20586101e+04 -1.14635919e+04  7.20e-03 3.84e-04  3.56e-03     4s
  38  -1.19409523e+04 -1.14920249e+04  5.50e-03 3.53e-04  2.68e-03     4s
  39  -1.18589013e+04 -1.15030327e+04  4.25e-03 2.92e-04  2.13e-03     4s
  40  -1.17501192e+04 -1.15355004e+04  2.59e-03 2.15e-04  1.28e-03     4s
  41  -1.17056455e+04 -1.15586895e+04  1.94e-03 5.39e-05  8.79e-04     4s
  42  -1.16830475e+04 -1.15619204e+04  1.61e-03 3.64e-05  7.24e-04     4s
  43  -1.16446887e+04 -1.15644475e+04  1.07e-03 5.59e-05  4.80e-04     4s
  44  -1.16340529e+04 -1.15657489e+04  9.13e-04 4.16e-05  4.08e-04     4s
  45  -1.16236716e+04 -1.15665200e+04  7.68e-04 2.08e-05  3.42e-04     4s
  46  -1.15991787e+04 -1.15673848e+04  4.50e-04 1.31e-05  1.90e-04     5s
  47  -1.15910526e+04 -1.15679228e+04  3.28e-04 1.37e-05  1.38e-04     5s
  48  -1.15743474e+04 -1.15684486e+04  8.25e-05 9.50e-06  3.53e-05     5s
  49  -1.15701796e+04 -1.15684472e+04  2.12e-05 9.18e-06  1.04e-05     5s
  50  -1.15686050e+04 -1.15685727e+04  2.63e-07 9.38e-07  1.92e-07     5s
  51  -1.15685792e+04 -1.15685788e+04  1.06e-08 5.25e-10  1.97e-09     5s
  52  -1.15685788e+04 -1.15685788e+04  3.25e-09 4.78e-12  5.96e-12     5s

Barrier solved model in 52 iterations and 4.87 seconds (7.62 work units)
Optimal objective -1.15685788e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    2806 PPushes remaining with PInf 1.0819483e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.6839184e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33099   -1.1568579e+04   0.000000e+00   0.000000e+00      7s
   33099   -1.1568579e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -1.156858e+04, 33099 iterations, 4.71 seconds (9.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -11568.579    0  438 -201924.56 -11568.579  94.3%     -    6s
H    0     0                    -189099.8375 -11568.579  93.9%     -    7s
H    0     0                    -168263.5912 -11568.579  93.1%     -    7s
H    0     0                    -165687.6816 -11568.579  93.0%     -    7s
H    0     0                    -164766.1466 -11568.579  93.0%     -    7s
H    0     0                    -106407.7750 -11568.579  89.1%     -    7s
H    0     0                    -106287.4276 -11568.579  89.1%     -    7s
H    0     0                    -75686.93948 -11568.579  84.7%     -    7s
H    0     0                    -65840.15326 -11568.579  82.4%     -    7s
H    0     0                    -62934.35057 -11568.579  81.6%     -    7s
H    0     0                    -62740.01036 -11568.579  81.6%     -    7s
H    0     0                    -60659.52474 -16025.707  73.6%     -   40s
H    0     0                    -60405.52749 -16025.707  73.5%     -   40s
     0     0 -16025.707    0  685 -60405.527 -16025.707  73.5%     -   40s
H    0     0                    -60194.07349 -16026.594  73.4%     -   40s
H    0     0                    -60181.78190 -16026.594  73.4%     -   40s
     0     0 -16517.039    0  679 -60181.782 -16517.039  72.6%     -   51s
     0     0 -16617.267    0  678 -60181.782 -16617.267  72.4%     -   60s
     0     0 -16617.267    0  664 -60181.782 -16617.267  72.4%     -   64s
     0     0 -16617.267    0  662 -60181.782 -16617.267  72.4%     -   64s
     0     0 -16617.267    0  663 -60181.782 -16617.267  72.4%     -   64s
     0     0 -19539.963    0  670 -60181.782 -19539.963  67.5%     -  112s
H    0     0                    -56481.69681 -19540.380  65.4%     -  112s
H    0     0                    -56461.81130 -19540.380  65.4%     -  112s
H    0     0                    -56228.49690 -19540.380  65.2%     -  112s
     0     0 -20174.425    0  679 -56228.497 -20174.425  64.1%     -  134s
     0     0 -20293.793    0  654 -56228.497 -20293.793  63.9%     -  142s
     0     0 -20342.804    0  680 -56228.497 -20342.804  63.8%     -  147s
     0     0 -20374.245    0  674 -56228.497 -20374.245  63.8%     -  151s
     0     0 -20421.987    0  695 -56228.497 -20421.987  63.7%     -  156s
     0     0 -20621.979    0  676 -56228.497 -20621.979  63.3%     -  170s
     0     0 -20631.563    0  697 -56228.497 -20631.563  63.3%     -  174s
     0     0 -20640.496    0  644 -56228.497 -20640.496  63.3%     -  180s
     0     0 -20689.855    0  637 -56228.497 -20689.855  63.2%     -  188s
     0     0 -20706.278    0  641 -56228.497 -20706.278  63.2%     -  191s
     0     0 -20706.975    0  644 -56228.497 -20706.975  63.2%     -  191s
H    0     0                    -49083.30056 -22424.813  54.3%     -  251s
H    0     0                    -48812.48771 -22424.813  54.1%     -  251s
     0     0 -22424.813    0  618 -48812.488 -22424.813  54.1%     -  251s
H    0     0                    -48644.53715 -22424.907  53.9%     -  251s
H    0     0                    -48350.56599 -22545.818  53.4%     -  263s
     0     0 -22545.818    0  571 -48350.566 -22545.818  53.4%     -  263s
     0     0 -22647.640    0  752 -48350.566 -22647.640  53.2%     -  274s
     0     0 -22783.882    0  561 -48350.566 -22783.882  52.9%     -  284s
     0     0 -22802.202    0  709 -48350.566 -22802.202  52.8%     -  290s
H    0     0                    -47825.77119 -22824.077  52.3%     -  294s
H    0     0                    -47570.27989 -22824.077  52.0%     -  294s
H    0     0                    -47062.53076 -22824.077  51.5%     -  294s
H    0     0                    -44453.56286 -22824.077  48.7%     -  294s
     0     0 -22824.077    0  716 -44453.563 -22824.077  48.7%     -  294s
     0     0 -22889.120    0  694 -44453.563 -22889.120  48.5%     -  303s
     0     0 -22913.300    0  715 -44453.563 -22913.300  48.5%     -  306s
     0     0 -22942.685    0  710 -44453.563 -22942.685  48.4%     -  311s
     0     0 -22945.236    0  704 -44453.563 -22945.236  48.4%     -  312s
     0     0 -22946.489    0  719 -44453.563 -22946.489  48.4%     -  314s
H    0     0                    -44307.91660 -23692.748  46.5%     -  354s
     0     0 -23692.748    0  713 -44307.917 -23692.748  46.5%     -  354s
H    0     0                    -42166.77606 -23693.310  43.8%     -  354s
H    0     0                    -42121.63550 -23693.310  43.8%     -  354s
     0     0 -23932.251    0  724 -42121.636 -23932.251  43.2%     -  371s
     0     0 -24116.826    0  760 -42121.636 -24116.826  42.7%     -  384s
H    0     0                    -36841.47074 -24160.545  34.4%     -  392s
H    0     0                    -36811.17581 -24160.545  34.4%     -  392s
H    0     0                    -36806.13819 -24160.545  34.4%     -  392s
H    0     0                    -36801.99869 -24160.545  34.3%     -  392s
H    0     0                    -36766.66614 -24160.545  34.3%     -  392s
H    0     0                    -36754.37455 -24160.545  34.3%     -  392s
H    0     0                    -36737.40317 -24160.545  34.2%     -  392s
     0     0 -24160.545    0  766 -36737.403 -24160.545  34.2%     -  392s
     0     0 -24186.181    0  760 -36737.403 -24186.181  34.2%     -  398s
     0     0 -24199.541    0  768 -36737.403 -24199.541  34.1%     -  401s
     0     0 -24204.240    0  767 -36737.403 -24204.240  34.1%     -  402s
H    0     0                    -36729.76099 -24207.014  34.1%     -  404s
     0     0 -24207.014    0  786 -36729.761 -24207.014  34.1%     -  404s
H    0     0                    -36362.71052 -24207.605  33.4%     -  404s
H    0     0                    -35522.97291 -24207.605  31.9%     -  404s
H    0     0                    -35505.30533 -24207.605  31.8%     -  404s
     0     0 -24207.605    0  786 -35505.305 -24207.605  31.8%     -  404s
H    0     0                    -35484.98560 -24207.605  31.8%     -  406s
H    0     0                    -35478.79918 -24207.605  31.8%     -  406s
H    0     0                    -35458.43158 -24491.522  30.9%     -  427s
     0     0 -24491.522    0  712 -35458.432 -24491.522  30.9%     -  427s
H    0     0                    -35329.89075 -24491.575  30.7%     -  428s
H    0     0                    -35254.98580 -24491.575  30.5%     -  428s
H    0     0                    -35202.61788 -24491.575  30.4%     -  428s
     0     0 -24572.443    0  705 -35202.618 -24572.443  30.2%     -  442s
     0     0 -24591.204    0  665 -35202.618 -24591.204  30.1%     -  448s
     0     0 -24598.123    0  674 -35202.618 -24598.123  30.1%     -  456s
     0     0 -24599.906    0  725 -35202.618 -24599.906  30.1%     -  458s
     0     0 -24759.929    0  780 -35202.618 -24759.929  29.7%     -  473s
H    0     0                    -35177.35184 -24759.934  29.6%     -  475s
H    0     0                    -35157.00030 -24759.934  29.6%     -  475s
H    0     0                    -35137.49544 -24759.934  29.5%     -  475s
     0     0 -24819.259    0  780 -35137.495 -24819.259  29.4%     -  484s
     0     0 -24825.821    0  735 -35137.495 -24825.821  29.3%     -  487s
     0     0 -24906.563    0  757 -35137.495 -24906.563  29.1%     -  496s
     0     0 -24935.180    0  753 -35137.495 -24935.180  29.0%     -  504s
     0     0 -24948.611    0  634 -35137.495 -24948.611  29.0%     -  508s
     0     0 -24956.680    0  745 -35137.495 -24956.680  29.0%     -  513s
     0     0 -24958.749    0  739 -35137.495 -24958.749  29.0%     -  515s
     0     0 -25012.393    0  679 -35137.495 -25012.393  28.8%     -  525s
H    0     0                    -35110.46837 -25012.404  28.8%     -  525s
H    0     0                    -35084.35214 -25044.934  28.6%     -  531s
H    0     0                    -35079.73187 -25044.934  28.6%     -  531s
H    0     0                    -35064.17747 -25044.934  28.6%     -  531s
     0     0 -25044.934    0  779 -35064.177 -25044.934  28.6%     -  531s
     0     0 -25072.266    0  663 -35064.177 -25072.266  28.5%     -  536s
     0     0 -25076.845    0  684 -35064.177 -25076.845  28.5%     -  538s
     0     0 -25079.797    0  689 -35064.177 -25079.797  28.5%     -  540s
     0     0 -25084.249    0  681 -35064.177 -25084.249  28.5%     -  542s
     0     0 -25085.366    0  680 -35064.177 -25085.366  28.5%     -  543s
H    0     0                    -35059.79678 -25130.192  28.3%     -  553s
     0     0 -25130.192    0  687 -35059.797 -25130.192  28.3%     -  553s
     0     0 -25140.349    0  670 -35059.797 -25140.349  28.3%     -  557s
     0     0 -25144.493    0  688 -35059.797 -25144.493  28.3%     -  558s
     0     0 -25145.455    0  688 -35059.797 -25145.455  28.3%     -  559s
H    0     0                    -35034.58067 -25166.152  28.2%     -  566s
H    0     0                    -34998.40310 -25166.152  28.1%     -  566s
     0     0 -25166.152    0  651 -34998.403 -25166.152  28.1%     -  566s
H    0     0                    -34974.32082 -25166.155  28.0%     -  567s
     0     0 -25169.643    0  719 -34974.321 -25169.643  28.0%     -  569s
     0     0 -25172.110    0  646 -34974.321 -25172.110  28.0%     -  571s
     0     0 -25173.868    0  720 -34974.321 -25173.868  28.0%     -  573s
     0     0 -25204.478    0  652 -34974.321 -25204.478  27.9%     -  582s
     0     0 -25207.371    0  658 -34974.321 -25207.371  27.9%     -  585s
     0     0 -25208.863    0  715 -34974.321 -25208.863  27.9%     -  588s
     0     0 -25218.519    0  698 -34974.321 -25218.519  27.9%     -  594s
     0     0 -25220.086    0  653 -34974.321 -25220.086  27.9%     -  595s
     0     0 -25231.251    0  656 -34974.321 -25231.251  27.9%     -  600s
     0     0 -25231.442    0  656 -34974.321 -25231.442  27.9%     -  605s
H    0     0                    -34972.14280 -25231.442  27.9%     -  633s
H    0     0                    -34775.10885 -25231.442  27.4%     -  673s
H    0     0                    -32108.11519 -25231.442  21.4%     -  673s
H    0     0                    -32088.22967 -25231.442  21.4%     -  674s
H    0     0                    -32061.43061 -25231.442  21.3%     -  675s
H    0     0                    -31969.00421 -25231.442  21.1%     -  675s
H    0     0                    -31823.56344 -25231.442  20.7%     -  675s
H    0     0                    -31718.78563 -25231.442  20.5%     -  675s
     0     2 -25231.442    0  656 -31718.786 -25231.442  20.5%     -  676s
     1     3 -25365.369    1  626 -31718.786 -25231.442  20.5%  7534  685s
     2     4 -25427.873    1  722 -31718.786 -25365.733  20.0%  6883  692s
     3     7 -25535.523    2  636 -31718.786 -25367.842  20.0%  6299  702s
     6    13 -25574.691    3  634 -31718.786 -25428.408  19.8%  6412  719s
    12    23 -25582.522    4  631 -31718.786 -25493.817  19.6%  6905  735s
    24    33 -27666.758    4  435 -31718.786 -25520.693  19.5% 11766  903s
H   34    56                    -31674.27596 -25582.524  19.2% 12386 1050s
H   34    56                    -31574.21486 -25582.524  19.0% 12386 1050s
H   35    56                    -31486.96214 -25582.524  18.8% 12215 1050s
H   39    56                    -31434.64338 -25582.524  18.6% 11852 1050s
H   40    56                    -31325.17629 -25582.524  18.3% 11869 1050s
H   51    56                    -31288.61350 -25582.524  18.2% 10399 1050s
    63    88 -29556.640    6  224 -31288.614 -25582.524  18.2% 17199 1081s
    95   190 -29960.534    7  198 -31288.614 -25582.524  18.2% 16347 1111s
H  100   190                    -31288.61167 -25582.524  18.2% 15550 1111s
   211   258 -30032.978   12  185 -31288.612 -25582.524  18.2% 10631 1129s
   291   283     cutoff   17      -31288.612 -25582.524  18.2%  8934 1143s
   322   321 infeasible   17      -31288.612 -25582.524  18.2%  8830 1160s
   382   349 infeasible   16      -31288.612 -25582.524  18.2%  8061 1175s
H  405   349                    -31286.54067 -25582.524  18.2%  7858 1175s
   449   398 -30793.394   20  148 -31286.541 -25582.524  18.2%  7441 1190s
   538   424 -30047.038   24  431 -31286.541 -25582.524  18.2%  7031 1203s
   586   472 -30113.133   25  428 -31286.541 -25582.524  18.2%  6947 1217s
   660   495 -30778.977   30  282 -31286.541 -25582.524  18.2%  6711 1231s
   737   513 -30854.223   33  271 -31286.541 -25582.524  18.2%  6315 1244s
   791   524 infeasible   35      -31286.541 -25582.524  18.2%  6152 1259s
   844   543     cutoff   12      -31286.541 -25582.524  18.2%  6187 1272s
   883   573 -29442.250   17  421 -31286.541 -25582.524  18.2%  6316 1286s
   927   620 -29484.150   18  281 -31286.541 -25582.524  18.2%  6303 1299s
  1008   687 -29843.321   23  258 -31286.541 -25582.524  18.2%  6209 1313s
  1115   748 -30000.511   30  230 -31286.541 -25582.524  18.2%  6001 1328s
  1241   780 infeasible   36      -31286.541 -25582.524  18.2%  5719 1343s
  1358   798 infeasible   41      -31286.541 -25582.524  18.2%  5524 1361s
  1461   798 -30818.527    8  180 -31286.541 -25582.524  18.2%  5421 1378s
  1525   821 -30565.135    9  174 -31286.541 -25582.524  18.2%  5418 1396s
  1590   853 -31119.427   17  185 -31286.541 -25582.524  18.2%  5501 1413s
  1684   931 infeasible   19      -31286.541 -25582.524  18.2%  5432 1431s
  1823   956 -29694.483   13  215 -31286.541 -25582.524  18.2%  5277 1450s
  1952   967 -30662.655   16   84 -31286.541 -25582.524  18.2%  5224 1469s
  2051   981 infeasible   26      -31286.541 -25685.891  17.9%  5193 1488s
  2093  1001 -28644.665   14  517 -31286.541 -25685.891  17.9%  5292 1507s
  2139  1012 -29130.081   16  485 -31286.541 -25685.891  17.9%  5374 1528s
  2188  1022 -30615.190   17  453 -31286.541 -25685.891  17.9%  5418 1550s
  2280  1051 -29124.087   17  540 -31286.541 -25685.891  17.9%  5430 1569s
  2349  1110 -30393.024   20  342 -31286.541 -25685.891  17.9%  5487 1590s
  2446  1140 infeasible   30      -31286.541 -25709.059  17.8%  5479 1612s
  2572  1159     cutoff   24      -31286.541 -25891.055  17.2%  5440 1640s
  2667  1159 -26886.000    7  533 -31286.541 -25910.189  17.2%  5472 1676s
  2812  1165 -27139.242    8  444 -31286.541 -26211.028  16.2%  5480 1704s
  2908  1177 -27482.256    9  430 -31286.541 -26211.028  16.2%  5539 1733s
  3006  1189 -27578.975   10  367 -31286.541 -26211.028  16.2%  5631 1763s
  3050  1222 -27715.914   11  340 -31286.541 -26211.028  16.2%  5754 1790s
  3137  1249 infeasible   13      -31286.541 -26211.028  16.2%  5877 1819s
  3232  1301 infeasible   11      -31286.541 -26211.028  16.2%  5949 1848s
  3384  1329 -28083.908   11  516 -31286.541 -26211.028  16.2%  5981 1882s
  3500  1402     cutoff   12      -31286.541 -27138.593  13.3%  6038 1914s
  3689  1430 -30251.912   12  423 -31286.541 -27270.850  12.8%  6026 1948s
  3877  1424 infeasible   13      -31286.541 -27270.850  12.8%  5956 1985s
  4022  1432 infeasible   18      -31286.541 -27312.372  12.7%  6005 2026s
  4144  1452 infeasible   14      -31286.541 -27372.458  12.5%  6108 2069s
  4300  1466 -29068.308   10  724 -31286.541 -27524.573  12.0%  6209 2111s
  4456  1481 infeasible   12      -31286.541 -27524.573  12.0%  6301 2152s
  4609  1512 -28477.913    9  523 -31286.541 -27524.573  12.0%  6426 2197s
  4770  1514 -28921.786   10  607 -31286.541 -27524.573  12.0%  6507 2242s
  4832  1538 -28988.811   11  506 -31286.541 -27524.573  12.0%  6581 2286s
  4971  1576 -29533.746   13  535 -31286.541 -27524.573  12.0%  6578 2330s
  5184  1581 -30240.876   20  273 -31286.541 -27740.144  11.3%  6601 2381s
  5416  1601 -29643.896   16  347 -31286.541 -27890.809  10.9%  6650 2430s
  5617  1595 -28986.430    9  459 -31286.541 -27890.809  10.9%  6754 2481s
  5866  1619 -30579.686   13  418 -31286.541 -28033.093  10.4%  6812 2538s
  6118  1628 -31198.696   15  107 -31286.541 -28033.093  10.4%  6864 2592s
  6393  1690 -29398.765   12  491 -31286.541 -28251.647  9.70%  6886 2648s
  6659  1690 -30087.295   16  544 -31286.541 -28375.517  9.30%  6947 2713s
  6988  1647 infeasible   20      -31286.541 -28441.347  9.09%  6925 2783s
  7266  1587     cutoff   37      -31286.541 -28645.373  8.44%  6969 2847s
  7645  1550 -30768.391   23  233 -31286.541 -28802.376  7.94%  6952 2915s
  7967  1515 infeasible   20      -31286.541 -28852.372  7.78%  6944 2986s
  8382  1498 -30381.131   19  310 -31286.541 -29148.206  6.83%  6905 3052s
  8848  1468 infeasible   21      -31286.541 -29163.908  6.78%  6853 3108s
  8944  1429 -30944.437   18   61 -31286.541 -29299.519  6.35%  6859 3175s
  9166  1384 infeasible   19      -31286.541 -29514.982  5.66%  6810 3247s
  9578  1337 -30610.038   29  297 -31286.541 -29579.133  5.46%  6812 3333s
 10244  1303 -30245.119   19  243 -31286.541 -29843.923  4.61%  6692 3413s
 10956  1254 -30964.013   20  417 -31286.541 -30010.755  4.08%  6579 3502s
 11773  1132 -30746.914   25  474 -31286.541 -30165.728  3.58%  6404 3580s
 12885  1066 -31022.155   21  460 -31286.541 -30407.228  2.81%  6142 3600s

Cutting planes:
  Gomory: 6
  Implied bound: 75
  MIR: 3261
  Flow cover: 4173
  Inf proof: 1
  Zero half: 3
  RLT: 173
  Relax-and-lift: 940

Explored 13243 nodes (80668671 simplex iterations) in 3600.04 seconds (9589.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31286.5 -31288.6 -31288.6 ... -31823.6

Time limit reached
Best objective -3.128654066998e+04, best bound -3.047066252807e+04, gap 2.6078%
  WARNING: Time limit reached. Using best solution found (gap: 2.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -31286.54, θ = 93597.11
  Upper Bound (UB) = -31286.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93597.11
  [DEBUG]   ✓ Scenario 0: θ = 93597.11 ≤ Q = 93597.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93597.11 ≤ Q = 93597.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93597.11 ≤ Q = 93597.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93597.11 ≤ Q = 93597.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93597.11 ≤ Q = 93597.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93597.11 ≤ Q = 93597.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93597.11 ≤ Q = 93597.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93597.11 ≤ Q = 93597.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93597.11 ≤ Q = 93597.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93597.11 ≤ Q = 93597.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93597.11 ≤ Q = 93597.11 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2faeceed
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2faeceed
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.164049e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5410324.9867
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.234234e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123423.37    0  124 5410324.99 -123423.37   102%     -    0s
H    0     0                    -89618.17373 -123423.37  37.7%     -    0s
H    0     0                    -90176.85385 -123423.37  36.9%     -    0s
     0     0 -100128.40    0   70 -90176.854 -100128.40  11.0%     -    0s
H    0     0                    -97285.80999 -100120.96  2.91%     -    0s
H    0     0                    -97573.88514 -100120.96  2.61%     -    0s
H    0     0                    -98050.59397 -100120.96  2.11%     -    0s
H    0     0                    -98338.66913 -100120.96  1.81%     -    0s
     0     0 -99748.215    0   71 -98338.669 -99748.215  1.43%     -    0s
     0     0 -99655.901    0   74 -98338.669 -99655.901  1.34%     -    0s
     0     0 -99238.757    0   52 -98338.669 -99238.757  0.92%     -    0s
     0     0 -99178.004    0   56 -98338.669 -99178.004  0.85%     -    0s
     0     0 -99171.222    0   55 -98338.669 -99171.222  0.85%     -    0s
     0     0 -99164.429    0   55 -98338.669 -99164.429  0.84%     -    0s
     0     0 -99000.681    0   53 -98338.669 -99000.681  0.67%     -    0s
     0     0 -98979.770    0   53 -98338.669 -98979.770  0.65%     -    0s
     0     0 -98902.059    0   49 -98338.669 -98902.059  0.57%     -    0s
     0     0 -98882.623    0   49 -98338.669 -98882.623  0.55%     -    0s
     0     0 -98868.739    0   85 -98338.669 -98868.739  0.54%     -    0s
     0     0 -98868.739    0   56 -98338.669 -98868.739  0.54%     -    0s
     0     0 -98868.739    0   45 -98338.669 -98868.739  0.54%     -    0s
     0     0 -98868.739    0   48 -98338.669 -98868.739  0.54%     -    0s
     0     0 -98868.739    0   49 -98338.669 -98868.739  0.54%     -    0s
     0     0 -98868.739    0   49 -98338.669 -98868.739  0.54%     -    0s
     0     0 -98793.309    0   49 -98338.669 -98793.309  0.46%     -    0s
     0     0 -98770.254    0   42 -98338.669 -98770.254  0.44%     -    0s
     0     0 -98769.946    0   42 -98338.669 -98769.946  0.44%     -    0s
     0     0 -98741.729    0   42 -98338.669 -98741.729  0.41%     -    0s
     0     0 -98741.729    0   42 -98338.669 -98741.729  0.41%     -    0s
     0     0 -98741.729    0   42 -98338.669 -98741.729  0.41%     -    0s
     0     0 -98741.729    0   42 -98338.669 -98741.729  0.41%     -    0s
     0     2 -98741.729    0   42 -98338.669 -98741.729  0.41%     -    0s
*   21    10               5    -98450.25066 -98612.912  0.17%   9.3    0s

Cutting planes:
  Gomory: 18
  Implied bound: 21
  MIR: 76
  Flow cover: 8
  RLT: 8
  Relax-and-lift: 3
  BQP: 1

Explored 76 nodes (1507 simplex iterations) in 0.13 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -98450.3 -98338.7 -98050.6 ... 1.16405e+13
No other solutions better than -98450.3

Optimal solution found (tolerance 1.00e-06)
Best objective -9.845025065775e+04, best bound -9.845025065775e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 88026.45
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98450.25
  [DEBUG]   S×d_nominal = 186476.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186476.70 + -98450.25 = 88026.45
  [DEBUG]   Current θ from Master = 93597.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5570.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -36857.21
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 1830.1663, Absolute Gap = 1830.1663, Relative Gap = 0.058497
  Not converged yet (gap = 1830.17 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x770a2493
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 1.52s
Presolved: 100023 rows, 42700 columns, 606167 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427274.8974
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 611
 AA' NZ     : 3.649e+06
 Factor NZ  : 8.491e+06 (roughly 130 MB of memory)
 Factor Ops : 1.584e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37279542e+07  1.82262450e+08  7.04e+04 1.90e+01  5.97e+04     3s
   1  -1.02867163e+07  1.52405639e+08  4.74e+04 5.59e+01  3.98e+04     3s
   2  -3.70725093e+06  1.16219531e+08  1.63e+04 5.20e+00  1.43e+04     3s
   3  -7.68568166e+05  8.06966859e+07  1.66e+03 3.86e-01  1.77e+03     3s
   4  -4.88652073e+05  6.24908348e+07  3.71e+02 9.44e-01  6.31e+02     3s
   5  -4.31398821e+05  3.37552862e+07  2.10e+02 5.09e-01  3.30e+02     3s
   6  -3.67733154e+05  2.38101132e+07  1.08e+02 4.70e-02  1.99e+02     3s
   7  -2.50010422e+05  1.66661914e+07  1.95e+01 3.08e-02  1.03e+02     3s
   8  -1.45500046e+05  9.90259303e+06  1.64e+00 1.74e-02  5.54e+01     3s
   9  -1.14502241e+05  6.99510308e+06  9.17e-01 1.21e-02  3.90e+01     3s
  10  -9.36052827e+04  1.00455744e+06  5.21e-01 8.57e-03  6.01e+00     3s
  11  -6.76035939e+04  4.90537789e+05  2.76e-01 2.43e-03  3.05e+00     3s
  12  -4.90800526e+04  2.39317354e+05  1.10e-01 3.97e-04  1.57e+00     3s
  13  -4.12050520e+04  1.25230532e+05  6.98e-02 2.39e-04  9.08e-01     3s
  14  -3.79853806e+04  8.38797116e+04  5.69e-02 4.18e-04  6.65e-01     3s
  15  -3.42099135e+04  6.68695654e+04  4.57e-02 3.51e-04  5.52e-01     3s
  16  -2.99605071e+04  4.12742107e+04  3.49e-02 4.23e-04  3.89e-01     3s
  17  -2.59990466e+04  2.33199016e+04  2.60e-02 8.14e-04  2.69e-01     3s
  18  -2.47187401e+04  2.17863516e+04  2.31e-02 8.37e-04  2.54e-01     3s
  19  -2.25110722e+04  1.35627727e+04  1.82e-02 7.12e-04  1.97e-01     4s
  20  -2.03694567e+04  9.57251822e+03  1.35e-02 9.73e-04  1.63e-01     4s
  21  -1.88788049e+04  3.31391768e+03  1.02e-02 7.18e-04  1.21e-01     4s
  22  -1.78460130e+04  4.92542753e+02  8.21e-03 5.69e-04  1.00e-01     4s
  23  -1.66142314e+04 -3.91061818e+03  6.00e-03 3.96e-04  6.93e-02     4s
  24  -1.59228060e+04 -5.56444101e+03  4.82e-03 3.27e-04  5.65e-02     4s
  25  -1.56240883e+04 -6.05548177e+03  4.34e-03 3.03e-04  5.22e-02     4s
  26  -1.54378012e+04 -7.45676713e+03  4.05e-03 2.36e-04  4.35e-02     4s
  27  -1.49350251e+04 -7.90202403e+03  3.28e-03 2.14e-04  3.84e-02     4s
  28  -1.48039479e+04 -8.38633796e+03  3.07e-03 1.93e-04  3.50e-02     4s
  29  -1.46966224e+04 -8.51052696e+03  2.91e-03 1.88e-04  3.38e-02     4s
  30  -1.44877864e+04 -9.84575336e+03  2.57e-03 1.28e-04  2.53e-02     4s
  31  -1.40337917e+04 -1.05019219e+04  1.92e-03 1.11e-04  1.93e-02     4s
  32  -1.37689204e+04 -1.08936839e+04  1.55e-03 1.34e-04  1.57e-02     4s
  33  -1.35427979e+04 -1.12505874e+04  1.24e-03 1.17e-04  1.25e-02     4s
  34  -1.33662141e+04 -1.15781205e+04  1.01e-03 8.87e-05  9.76e-03     4s
  35  -1.32112209e+04 -1.17334127e+04  8.04e-04 7.51e-05  8.06e-03     4s
  36  -1.31404841e+04 -1.19637117e+04  7.11e-04 6.02e-05  6.42e-03     4s
  37  -1.30596177e+04 -1.19929563e+04  6.12e-04 5.60e-05  5.82e-03     4s
  38  -1.30407494e+04 -1.20425246e+04  5.87e-04 5.11e-05  5.45e-03     5s
  39  -1.29691537e+04 -1.20713619e+04  4.99e-04 4.85e-05  4.90e-03     5s
  40  -1.28847080e+04 -1.21964510e+04  3.92e-04 3.63e-05  3.75e-03     5s
  41  -1.28222974e+04 -1.23292265e+04  3.13e-04 2.26e-05  2.69e-03     5s
  42  -1.28017970e+04 -1.23743562e+04  2.88e-04 1.82e-05  2.33e-03     5s
  43  -1.27337660e+04 -1.24104904e+04  2.05e-04 1.97e-05  1.76e-03     5s
  44  -1.26619530e+04 -1.24426455e+04  1.20e-04 1.62e-05  1.20e-03     5s
  45  -1.26142569e+04 -1.24936324e+04  6.30e-05 8.74e-06  6.58e-04     5s
  46  -1.25786939e+04 -1.25372663e+04  2.30e-05 4.26e-06  2.26e-04     5s
  47  -1.25765880e+04 -1.25395486e+04  2.07e-05 3.74e-06  2.02e-04     5s
  48  -1.25717341e+04 -1.25445752e+04  1.58e-05 3.87e-06  1.48e-04     5s
  49  -1.25711367e+04 -1.25496040e+04  1.52e-05 9.99e-07  1.17e-04     5s
  50  -1.25684658e+04 -1.25496975e+04  1.25e-05 9.65e-07  1.02e-04     5s
  51  -1.25608372e+04 -1.25535981e+04  4.57e-06 2.32e-06  3.95e-05     5s
  52  -1.25586160e+04 -1.25556418e+04  2.42e-06 2.47e-07  1.62e-05     5s
  53  -1.25578222e+04 -1.25557219e+04  1.63e-06 2.31e-07  1.15e-05     5s
  54  -1.25563105e+04 -1.25560569e+04  1.35e-07 1.53e-08  1.38e-06     6s
  55  -1.25561091e+04 -1.25560967e+04  7.13e-09 6.95e-09  6.79e-08     6s
  56  -1.25561016e+04 -1.25560972e+04  3.36e-07 7.88e-09  2.42e-08     6s
  57  -1.25560981e+04 -1.25560972e+04  1.45e-07 1.26e-07  4.63e-09     6s
  58  -1.25560975e+04 -1.25560972e+04  3.42e-07 3.30e-10  1.32e-09     6s
  59  -1.25560972e+04 -1.25560972e+04  4.68e-08 8.65e-09  1.80e-10     6s

Barrier solved model in 59 iterations and 5.77 seconds (10.16 work units)
Optimal objective -1.25560972e+04


Root crossover log...

   74923 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    8260 PPushes remaining with PInf 4.9871034e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0651676e+02      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43004   -1.2556097e+04   0.000000e+00   1.065168e+02      9s
   43012   -1.2556097e+04   0.000000e+00   0.000000e+00      9s
   43012   -1.2556097e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.37s

Solved with barrier

Root relaxation: objective -1.255610e+04, 43012 iterations, 7.68 seconds (17.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -12556.097    0  542 -201924.56 -12556.097  93.8%     -   10s
H    0     0                    -198056.9477 -12556.097  93.7%     -   10s
H    0     0                    -157979.2834 -12556.097  92.1%     -   10s
H    0     0                    -142260.1549 -12556.097  91.2%     -   10s
H    0     0                    -141234.4225 -12556.097  91.1%     -   10s
H    0     0                    -101001.4684 -12556.097  87.6%     -   10s
H    0     0                    -76175.31971 -12556.097  83.5%     -   10s
H    0     0                    -76136.37321 -12556.097  83.5%     -   10s
H    0     0                    -75752.20248 -12556.097  83.4%     -   10s
H    0     0                    -66303.36673 -17292.896  73.9%     -   50s
H    0     0                    -60589.75085 -17292.896  71.5%     -   50s
H    0     0                    -60554.65343 -17292.896  71.4%     -   50s
     0     0 -17292.896    0  739 -60554.653 -17292.896  71.4%     -   51s
     0     0 -17954.059    0  731 -60554.653 -17954.059  70.4%     -   76s
     0     0 -17954.059    0  702 -60554.653 -17954.059  70.4%     -   83s
     0     0 -17954.059    0  685 -60554.653 -17954.059  70.4%     -   91s
     0     0 -17954.059    0  689 -60554.653 -17954.059  70.4%     -   98s
     0     0 -17979.235    0  682 -60554.653 -17979.235  70.3%     -  103s
     0     0 -17979.656    0  682 -60554.653 -17979.656  70.3%     -  104s
H    0     0                    -58258.69372 -20224.524  65.3%     -  163s
H    0     0                    -54885.80639 -20224.524  63.2%     -  163s
     0     0 -20224.524    0  660 -54885.806 -20224.524  63.2%     -  163s
H    0     0                    -47297.31829 -20224.616  57.2%     -  164s
H    0     0                    -39647.00247 -20224.616  49.0%     -  164s
H    0     0                    -39342.59731 -20224.616  48.6%     -  164s
     0     0 -20796.601    0  672 -39342.597 -20796.601  47.1%     -  192s
     0     0 -20889.189    0  671 -39342.597 -20889.189  46.9%     -  200s
     0     0 -20901.225    0  680 -39342.597 -20901.225  46.9%     -  205s
     0     0 -20917.780    0  682 -39342.597 -20917.780  46.8%     -  208s
     0     0 -20934.161    0  667 -39342.597 -20934.161  46.8%     -  211s
     0     0 -20958.532    0  727 -39342.597 -20958.532  46.7%     -  216s
H    0     0                    -39119.23965 -20959.137  46.4%     -  218s
     0     0 -20959.137    0  726 -39119.240 -20959.137  46.4%     -  218s
H    0     0                    -39037.75844 -22093.076  43.4%     -  266s
     0     0 -22093.076    0  685 -39037.758 -22093.076  43.4%     -  266s
H    0     0                    -38764.01567 -22093.164  43.0%     -  266s
     0     0 -22423.172    0  675 -38764.016 -22423.172  42.2%     -  288s
     0     0 -22550.125    0  702 -38764.016 -22550.125  41.8%     -  299s
     0     0 -22590.625    0  637 -38764.016 -22590.625  41.7%     -  307s
     0     0 -22639.196    0  670 -38764.016 -22639.196  41.6%     -  313s
     0     0 -22655.696    0  650 -38764.016 -22655.696  41.6%     -  317s
     0     0 -22675.066    0  673 -38764.016 -22675.066  41.5%     -  320s
H    0     0                    -33130.38309 -22696.997  31.5%     -  323s
H    0     0                    -32609.26239 -22696.997  30.4%     -  323s
     0     0 -22696.997    0  626 -32609.262 -22696.997  30.4%     -  323s
H    0     0                    -31830.98766 -22702.994  28.7%     -  325s
     0     0 -22702.994    0  621 -31830.988 -22702.994  28.7%     -  325s
     0     0 -22705.164    0  626 -31830.988 -22705.164  28.7%     -  327s
     0     0 -22720.573    0  631 -31830.988 -22720.573  28.6%     -  329s
     0     0 -22726.469    0  625 -31830.988 -22726.469  28.6%     -  331s
H    0     0                    -31826.33053 -22727.682  28.6%     -  333s
     0     0 -22727.682    0  630 -31826.331 -22727.682  28.6%     -  333s
H    0     0                    -31802.50621 -22727.682  28.5%     -  341s
     0     0 -23576.409    0  727 -31802.506 -23576.409  25.9%     -  374s
     0     0 -23820.765    0  681 -31802.506 -23820.765  25.1%     -  391s
     0     0 -24075.794    0  715 -31802.506 -24075.794  24.3%     -  408s
H    0     0                    -31594.79246 -24136.639  23.6%     -  415s
     0     0 -24136.639    0  698 -31594.792 -24136.639  23.6%     -  415s
     0     0 -24179.421    0  705 -31594.792 -24179.421  23.5%     -  422s
     0     0 -24186.493    0  712 -31594.792 -24186.493  23.4%     -  423s
     0     0 -24195.112    0  716 -31594.792 -24195.112  23.4%     -  426s
     0     0 -24213.859    0  716 -31594.792 -24213.859  23.4%     -  432s
H    0     0                    -31520.27183 -24229.583  23.1%     -  437s
H    0     0                    -31486.39497 -24229.583  23.0%     -  437s
     0     0 -24229.583    0  636 -31486.395 -24229.583  23.0%     -  437s
     0     0 -24240.309    0  793 -31486.395 -24240.309  23.0%     -  440s
     0     0 -24244.385    0  717 -31486.395 -24244.385  23.0%     -  442s
     0     0 -24254.865    0  780 -31486.395 -24254.865  23.0%     -  446s
     0     0 -24268.035    0  731 -31486.395 -24268.035  22.9%     -  449s
     0     0 -24274.977    0  722 -31486.395 -24274.977  22.9%     -  452s
     0     0 -24277.564    0  723 -31486.395 -24277.564  22.9%     -  453s
     0     0 -24287.289    0  787 -31486.395 -24287.289  22.9%     -  456s
     0     0 -24287.597    0  789 -31486.395 -24287.597  22.9%     -  456s
     0     0 -24456.903    0  762 -31486.395 -24456.903  22.3%     -  475s
     0     0 -24567.535    0  697 -31486.395 -24567.535  22.0%     -  488s
     0     0 -24596.038    0  701 -31486.395 -24596.038  21.9%     -  496s
     0     0 -24611.024    0  700 -31486.395 -24611.024  21.8%     -  500s
     0     0 -24613.507    0  697 -31486.395 -24613.507  21.8%     -  502s
     0     0 -24618.678    0  691 -31486.395 -24618.678  21.8%     -  503s
     0     0 -24618.923    0  693 -31486.395 -24618.923  21.8%     -  504s
     0     0 -24741.193    0  701 -31486.395 -24741.193  21.4%     -  519s
H    0     0                    -31473.51579 -24741.577  21.4%     -  528s
H    0     0                    -31452.06429 -24741.577  21.3%     -  528s
     0     0 -24795.575    0  695 -31452.064 -24795.575  21.2%     -  535s
     0     0 -24807.672    0  695 -31452.064 -24807.672  21.1%     -  539s
     0     0 -24811.487    0  625 -31452.064 -24811.487  21.1%     -  541s
     0     0 -24813.399    0  712 -31452.064 -24813.399  21.1%     -  542s
     0     0 -24815.349    0  718 -31452.064 -24815.349  21.1%     -  544s
     0     0 -24815.851    0  720 -31452.064 -24815.851  21.1%     -  545s
     0     0 -24926.081    0  709 -31452.064 -24926.081  20.7%     -  558s
     0     0 -24944.686    0  707 -31452.064 -24944.686  20.7%     -  564s
     0     0 -24952.544    0  717 -31452.064 -24952.544  20.7%     -  567s
     0     0 -25022.824    0  690 -31452.064 -25022.824  20.4%     -  576s
     0     0 -25031.514    0  696 -31452.064 -25031.514  20.4%     -  580s
     0     0 -25033.584    0  754 -31452.064 -25033.584  20.4%     -  582s
     0     0 -25034.771    0  713 -31452.064 -25034.771  20.4%     -  583s
     0     0 -25097.893    0  603 -31452.064 -25097.893  20.2%     -  597s
H    0     0                    -31438.29921 -25098.480  20.2%     -  598s
H    0     0                    -31386.79126 -25109.131  20.0%     -  603s
H    0     0                    -31382.13412 -25109.131  20.0%     -  603s
H    0     0                    -31379.67249 -25109.131  20.0%     -  603s
H    0     0                    -31367.39197 -25109.131  20.0%     -  603s
H    0     0                    -31366.61134 -25109.131  19.9%     -  603s
     0     0 -25109.131    0  614 -31366.611 -25109.131  19.9%     -  603s
     0     0 -25116.907    0  625 -31366.611 -25116.907  19.9%     -  607s
     0     0 -25119.574    0  621 -31366.611 -25119.574  19.9%     -  609s
     0     0 -25120.777    0  630 -31366.611 -25120.777  19.9%     -  611s
     0     0 -25175.632    0  610 -31366.611 -25175.632  19.7%     -  622s
     0     0 -25182.656    0  609 -31366.611 -25182.656  19.7%     -  627s
     0     0 -25196.809    0  665 -31366.611 -25196.809  19.7%     -  631s
     0     0 -25200.568    0  684 -31366.611 -25200.568  19.7%     -  632s
     0     0 -25201.436    0  634 -31366.611 -25201.436  19.7%     -  633s
     0     0 -25223.211    0  580 -31366.611 -25223.211  19.6%     -  643s
H    0     0                    -31312.75383 -25223.242  19.4%     -  694s
     0     0 -25228.419    0  653 -31312.754 -25228.419  19.4%     -  705s
     0     0 -25229.675    0  658 -31312.754 -25229.675  19.4%     -  707s
     0     0 -25271.999    0  774 -31312.754 -25271.999  19.3%     -  718s
     0     0 -25278.328    0  783 -31312.754 -25278.328  19.3%     -  722s
     0     0 -25280.697    0  706 -31312.754 -25280.697  19.3%     -  724s
     0     0 -25281.660    0  646 -31312.754 -25281.660  19.3%     -  725s
     0     0 -25302.483    0  796 -31312.754 -25302.483  19.2%     -  731s
     0     0 -25310.071    0  658 -31312.754 -25310.071  19.2%     -  735s
     0     0 -25312.887    0  865 -31312.754 -25312.887  19.2%     -  738s
     0     0 -25320.536    0  725 -31312.754 -25320.536  19.1%     -  742s
     0     0 -25321.178    0  723 -31312.754 -25321.178  19.1%     -  743s
     0     0 -25329.710    0  716 -31312.754 -25329.710  19.1%     -  748s
     0     0 -25332.292    0  654 -31312.754 -25332.292  19.1%     -  750s
     0     0 -25345.306    0  652 -31312.754 -25345.306  19.1%     -  752s
     0     0 -25346.054    0  656 -31312.754 -25346.054  19.1%     -  753s
     0     0 -25361.932    0  729 -31312.754 -25361.932  19.0%     -  760s
     0     0 -25369.747    0  730 -31312.754 -25369.747  19.0%     -  764s
     0     0 -25371.759    0  731 -31312.754 -25371.759  19.0%     -  765s
     0     0 -25377.704    0  742 -31312.754 -25377.704  19.0%     -  771s
     0     0 -25380.654    0  743 -31312.754 -25380.654  18.9%     -  774s
     0     0 -25382.095    0  752 -31312.754 -25382.095  18.9%     -  776s
     0     0 -25393.154    0  824 -31312.754 -25393.154  18.9%     -  781s
     0     0 -25393.285    0  824 -31312.754 -25393.285  18.9%     -  788s
     0     2 -25393.418    0  824 -31312.754 -25393.418  18.9%     -  864s
     1     4 -25404.688    1  741 -31312.754 -25393.418  18.9%  1496  872s
     3     7 -25439.527    2  747 -31312.754 -25404.813  18.9%  4727  904s
     6    14 -25569.215    3  694 -31312.754 -25439.687  18.8% 10796  918s
    13    27 -25670.020    4  836 -31312.754 -25498.204  18.6% 10377  945s
    26    40 -26501.207    5  567 -31312.754 -25595.167  18.3% 17386  989s
    39    69 -26645.880    5  463 -31312.754 -25595.167  18.3% 15866 1123s
    70   100 -26772.747    6  456 -31312.754 -25595.167  18.3% 18542 1160s
   109   153 -26780.060    7  452 -31312.754 -25595.167  18.3% 16838 1191s
   162   256 -27363.911    8  433 -31312.754 -25595.167  18.3% 13967 1221s
   267   336 -28113.184   18  365 -31312.754 -25595.167  18.3% 11237 1243s
   355   410 -28910.641   20  143 -31312.754 -25595.167  18.3%  9891 1264s
   439   435 -27919.009   10  383 -31312.754 -25595.167  18.3%  8947 1281s
   481   454 -28028.392   11  361 -31312.754 -25595.167  18.3%  8623 1307s
   518   474     cutoff   13      -31312.754 -25595.167  18.3%  8479 1323s
   563   500 -29953.139   13  302 -31312.754 -25595.167  18.3%  8289 1343s
   619   522     cutoff   15      -31312.754 -25595.167  18.3%  8047 1360s
   679   562 -27262.711   13  453 -31312.754 -25595.167  18.3%  8038 1379s
   748   587 -27372.733   14  453 -31312.754 -25595.167  18.3%  7830 1406s
   815   626 -28127.355   15  321 -31312.754 -25595.167  18.3%  7635 1423s
   881   662 -28265.200   16  311 -31312.754 -25595.167  18.3%  7554 1440s
   943   699 -30032.652   18  223 -31312.754 -25595.167  18.3%  7447 1458s
  1008   746 -30719.818   19  222 -31312.754 -25595.167  18.3%  7255 1476s
  1091   787 -30836.242   20  219 -31312.754 -25595.167  18.3%  7063 1494s
  1200   837 -31143.241   24  215 -31312.754 -25595.167  18.3%  6863 1513s
  1306   896 -28882.152   10  606 -31312.754 -25595.167  18.3%  6716 1532s
  1437   967 -29213.777   11  573 -31312.754 -25595.167  18.3%  6445 1556s
  1580  1051 -29504.369   12  558 -31312.754 -25595.167  18.3%  6127 1576s
  1737  1161 -30848.005   31   55 -31312.754 -25595.167  18.3%  5837 1597s
  1917  1189 -29839.618   14  536 -31312.754 -25595.167  18.3%  5478 1617s
  2015  1289 -30204.607   15  543 -31312.754 -25595.167  18.3%  5370 1640s
  2197  1347 -30222.848   16  546 -31312.754 -25595.167  18.3%  5095 1661s
  2374  1366 -30640.253   17  661 -31312.754 -25595.167  18.3%  4852 1683s
  2473  1397 -30921.034   18  642 -31312.754 -25595.167  18.3%  4770 1705s
  2592  1415     cutoff   21      -31312.754 -25595.167  18.3%  4714 1729s
  2679  1431     cutoff   12      -31312.754 -26250.215  16.2%  4835 1755s
  2755  1439 -31213.016   13  211 -31312.754 -26251.162  16.2%  4949 1782s
  2842  1457     cutoff   14      -31312.754 -26251.162  16.2%  5054 1813s
  2914  1478 -27976.607   10  450 -31312.754 -26251.162  16.2%  5179 1843s
  2977  1494 -28087.539   11  432 -31312.754 -26251.162  16.2%  5345 1874s
  3049  1521 -28745.261   12  266 -31312.754 -26251.162  16.2%  5472 1905s
  3132  1541 -29988.995   14  462 -31312.754 -26251.162  16.2%  5624 1939s
  3250  1597     cutoff   16      -31312.754 -26251.162  16.2%  5686 1972s
  3360  1663 infeasible   20      -31312.754 -26570.993  15.1%  5788 2005s
  3494  1714 -28868.355    7  452 -31312.754 -26570.993  15.1%  5812 2041s
  3637  1769     cutoff    9      -31312.754 -26570.993  15.1%  5883 2077s
  3812  1828 -29805.939    8  418 -31312.754 -26570.993  15.1%  5911 2115s
  3967  1840 infeasible   10      -31312.754 -26570.993  15.1%  5958 2148s
  4015  1860 -28318.702    9  277 -31312.754 -26867.845  14.2%  6074 2187s
  4073  1885 -28378.682   10  263 -31312.754 -26867.845  14.2%  6136 2225s
  4179  1920 -28699.163   11  236 -31312.754 -26867.845  14.2%  6188 2265s
  4303  1963 -29441.755   13  174 -31312.754 -26945.723  13.9%  6260 2309s
  4446  2029 -30218.361   20  162 -31312.754 -26977.049  13.8%  6335 2353s
  4630  2083 -31150.256   43  188 -31312.754 -26986.531  13.8%  6379 2398s
  4848  2141 -27160.321    8  488 -31312.754 -27000.909  13.8%  6385 2451s
  5047  2183 -29394.121   10  337 -31312.754 -27000.909  13.8%  6421 2503s
  5256  2200 -30435.158   11  246 -31312.754 -27057.904  13.6%  6447 2545s
  5313  2216     cutoff   12      -31312.754 -27157.444  13.3%  6489 2590s
  5375  2239 -30532.102   11  299 -31312.754 -27162.554  13.3%  6547 2641s
  5466  2268     cutoff   12      -31312.754 -27162.554  13.3%  6577 2693s
  5581  2325 -30977.279   12  270 -31312.754 -27196.688  13.1%  6634 2749s
  5730  2359 -30807.449   14  340 -31312.754 -27201.164  13.1%  6718 2809s
  5944  2439 -31311.296   18  325 -31312.754 -27238.115  13.0%  6779 2871s
  6260  2477     cutoff   12      -31312.754 -27286.742  12.9%  6794 2934s
  6466  2577 -30770.300   14   80 -31312.754 -27321.408  12.7%  6942 3003s
  6767  2578 -28321.210   10  824 -31312.754 -27374.001  12.6%  6973 3227s
  6769  2579 -28200.435   17  450 -31312.754 -27374.001  12.6%  6971 3241s
  6770  2580 -30023.263   23  580 -31312.754 -27374.001  12.6%  6970 3299s
  6771  2581 -27591.772   11  713 -31312.754 -27374.001  12.6%  6969 3393s
  6772  2581 -29208.037   16  541 -31312.754 -27374.001  12.6%  6968 3436s
  6773  2582 -31001.498   43  683 -31312.754 -27374.001  12.6%  6967 3459s
  6774  2583 -31131.307   17  749 -31312.754 -27374.001  12.6%  6966 3483s
  6775  2583 -30938.800   23  686 -31312.754 -27374.001  12.6%  6965 3501s
  6776  2584 -30782.659   30  706 -31312.754 -27374.001  12.6%  6964 3511s
  6777  2585 -30057.747   18  697 -31312.754 -27374.001  12.6%  6963 3522s
  6778  2585 -28771.244   11  690 -31312.754 -27374.001  12.6%  6962 3540s
  6779  2586 -30148.445   16  726 -31312.754 -27374.001  12.6%  6961 3553s
  6780  2587 -29825.750   26  708 -31312.754 -27374.001  12.6%  6960 3558s
  6781  2587 -28228.988   13  756 -31312.754 -27374.001  12.6%  6959 3574s
  6782  2588 -28320.393   19  728 -31312.754 -27374.001  12.6%  6958 3585s
  6783  2589 -30210.165   22  726 -31312.754 -27374.001  12.6%  6957 3594s

Cutting planes:
  Implied bound: 18
  Projected implied bound: 155
  MIR: 1154
  Mixing: 2
  Flow cover: 1402
  Zero half: 6
  RLT: 73
  Relax-and-lift: 267

Explored 6783 nodes (48214737 simplex iterations) in 3600.03 seconds (9067.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31312.8 -31366.6 -31379.7 ... -31520.3

Time limit reached
Best objective -3.131275383101e+04, best bound -2.737400056409e+04, gap 12.5788%
  WARNING: Time limit reached. Using best solution found (gap: 12.58%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.21s
  Master Objective (UB) = -31312.75, θ = 93316.24
  Upper Bound (UB) = -31312.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93316.24
  [DEBUG]   ✓ Scenario 0: θ = 93316.24 ≤ Q = 93316.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93316.24 ≤ Q = 93316.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93316.24 ≤ Q = 93316.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93316.24 ≤ Q = 93316.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93316.24 ≤ Q = 93316.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93316.24 ≤ Q = 93316.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93316.24 ≤ Q = 93316.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93316.24 ≤ Q = 93316.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93316.24 ≤ Q = 93316.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93316.24 ≤ Q = 93316.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93316.24 ≤ Q = 93316.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93316.24 ≤ Q = 93316.24 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x44d6d5bf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbb292a41
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177514e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5438214.2042
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.233033e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123303.27    0  124 5438214.20 -123303.27   102%     -    0s
H    0     0                    -89491.91136 -123303.27  37.8%     -    0s
H    0     0                    -90050.59149 -123303.27  36.9%     -    0s
     0     0 -98318.961    0   68 -90050.591 -98318.961  9.18%     -    0s
H    0     0                    -96082.03094 -98242.070  2.25%     -    0s
H    0     0                    -96370.10609 -98242.070  1.94%     -    0s
H    0     0                    -96454.45269 -98242.070  1.85%     -    0s
H    0     0                    -96742.52785 -98242.070  1.55%     -    0s
     0     0 -97880.693    0   68 -96742.528 -97880.693  1.18%     -    0s
     0     0 -97482.351    0   53 -96742.528 -97482.351  0.76%     -    0s
     0     0 -97432.017    0   59 -96742.528 -97432.017  0.71%     -    0s
     0     0 -97420.148    0   55 -96742.528 -97420.148  0.70%     -    0s
     0     0 -97250.412    0   45 -96742.528 -97250.412  0.52%     -    0s
     0     0 -97082.440    0   29 -96742.528 -97082.440  0.35%     -    0s
     0     0 -97072.221    0   29 -96742.528 -97072.221  0.34%     -    0s
     0     0 -96971.305    0   30 -96742.528 -96971.305  0.24%     -    0s
     0     0 -96971.128    0   19 -96742.528 -96971.128  0.24%     -    0s
     0     0 -96945.582    0   25 -96742.528 -96945.582  0.21%     -    0s
     0     0 -96901.177    0   25 -96742.528 -96901.177  0.16%     -    0s
     0     0 -96901.177    0   23 -96742.528 -96901.177  0.16%     -    0s
     0     0 -96746.873    0    5 -96742.528 -96746.873  0.00%     -    0s
*    0     0               0    -96746.65283 -96746.653  0.00%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 3
  MIR: 11
  Flow cover: 16

Explored 1 nodes (809 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -96746.7 -96742.5 -96622.1 ... 1.17751e+13
No other solutions better than -96746.7

Optimal solution found (tolerance 1.00e-06)
Best objective -9.674665283052e+04, best bound -9.674665283052e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 89313.44
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96746.65
  [DEBUG]   S×d_nominal = 186060.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186060.10 + -96746.65 = 89313.44
  [DEBUG]   Current θ from Master = 93316.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4002.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -35315.55
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 1803.9531, Absolute Gap = 1803.9531, Relative Gap = 0.057611
  Not converged yet (gap = 1803.95 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x510700d1
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 1.68s
Presolved: 108243 rows, 46070 columns, 653608 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427154.2907
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 600
 AA' NZ     : 4.185e+06
 Factor NZ  : 1.047e+07 (roughly 150 MB of memory)
 Factor Ops : 2.911e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37377559e+07  1.95390040e+08  7.05e+04 1.83e+01  5.94e+04     3s
   1  -1.02994043e+07  1.63555089e+08  4.72e+04 5.33e+01  3.94e+04     3s
   2  -3.73736976e+06  1.25108026e+08  1.64e+04 6.26e+00  1.43e+04     3s
   3  -8.79375910e+05  1.05174373e+08  2.06e+03 3.57e-01  2.21e+03     3s
   4  -5.04957162e+05  4.19440041e+07  4.01e+02 9.37e-01  5.04e+02     3s
   5  -4.01397704e+05  2.56457675e+07  1.48e+02 2.86e-02  2.28e+02     3s
   6  -2.80856009e+05  1.88229394e+07  3.39e+01 1.93e-02  1.16e+02     3s
   7  -1.69142996e+05  1.21929231e+07  4.63e+00 1.19e-02  6.44e+01     3s
   8  -1.32703074e+05  5.70862572e+06  2.96e+00 5.32e-03  3.01e+01     3s
   9  -1.00692186e+05  3.19957456e+06  1.64e+00 2.92e-03  1.69e+01     3s
  10  -8.34554717e+04  1.52126128e+06  1.03e+00 1.36e-03  8.17e+00     3s
  11  -5.93411999e+04  4.26661643e+05  3.34e-01 3.53e-04  2.46e+00     4s
  12  -4.48410331e+04  1.44287648e+05  1.13e-01 1.54e-04  9.56e-01     4s
  13  -3.94175633e+04  8.86763845e+04  8.22e-02 2.11e-04  6.47e-01     4s
  14  -3.64821788e+04  7.45529214e+04  7.01e-02 5.67e-04  5.61e-01     4s
  15  -3.48453412e+04  6.62866389e+04  6.33e-02 4.60e-04  5.11e-01     4s
  16  -3.17290025e+04  3.28602755e+04  5.18e-02 3.42e-04  3.26e-01     4s
  17  -2.95469740e+04  2.34544314e+04  4.52e-02 2.59e-04  2.68e-01     4s
  18  -2.76824693e+04  1.55285684e+04  3.99e-02 7.31e-04  2.18e-01     4s
  19  -2.52897675e+04  9.94362675e+03  3.32e-02 2.11e-03  1.78e-01     4s
  20  -2.26785195e+04  3.96346396e+03  2.59e-02 1.85e-03  1.35e-01     4s
  21  -2.17321409e+04  2.07090938e+03  2.33e-02 1.64e-03  1.20e-01     4s
  22  -2.00662849e+04 -1.32882562e+03  1.87e-02 1.29e-03  9.46e-02     4s
  23  -1.93145694e+04 -3.44389755e+03  1.68e-02 1.03e-03  8.01e-02     4s
  24  -1.82557248e+04 -4.72238880e+03  1.39e-02 8.89e-04  6.83e-02     4s
  25  -1.75031724e+04 -6.79197708e+03  1.18e-02 6.00e-04  5.41e-02     4s
  26  -1.67906817e+04 -8.14850630e+03  9.98e-03 5.72e-04  4.36e-02     4s
  27  -1.57510854e+04 -9.06606748e+03  7.29e-03 4.53e-04  3.38e-02     5s
  28  -1.52192510e+04 -1.01191621e+04  5.95e-03 3.20e-04  2.58e-02     5s
  29  -1.46014913e+04 -1.07951918e+04  4.45e-03 2.20e-04  1.92e-02     5s
  30  -1.42690129e+04 -1.11216018e+04  3.66e-03 1.65e-04  1.59e-02     5s
  31  -1.39587225e+04 -1.13384673e+04  2.90e-03 1.40e-04  1.32e-02     5s
  32  -1.37074745e+04 -1.17888569e+04  2.32e-03 1.13e-04  9.69e-03     5s
  33  -1.35095097e+04 -1.18379138e+04  1.88e-03 1.06e-04  8.44e-03     5s
  34  -1.33283139e+04 -1.21037819e+04  1.47e-03 7.01e-05  6.18e-03     5s
  35  -1.31966855e+04 -1.22401169e+04  1.19e-03 5.06e-05  4.83e-03     5s
  36  -1.30869078e+04 -1.23208331e+04  9.61e-04 3.98e-05  3.87e-03     5s
  37  -1.29868315e+04 -1.23436859e+04  7.51e-04 3.68e-05  3.25e-03     5s
  38  -1.29190528e+04 -1.23986234e+04  6.04e-04 2.94e-05  2.63e-03     5s
  39  -1.28443144e+04 -1.24479335e+04  4.43e-04 2.49e-05  2.00e-03     6s
  40  -1.28156789e+04 -1.25009401e+04  3.81e-04 1.73e-05  1.59e-03     6s
  41  -1.27835300e+04 -1.25243073e+04  3.16e-04 1.32e-05  1.31e-03     6s
  42  -1.27060664e+04 -1.25654638e+04  1.53e-04 7.38e-06  7.10e-04     6s
  43  -1.26968487e+04 -1.25732187e+04  1.35e-04 6.48e-06  6.24e-04     6s
  44  -1.26798788e+04 -1.25863482e+04  1.00e-04 4.88e-06  4.72e-04     6s
  45  -1.26744871e+04 -1.25951596e+04  8.98e-05 3.82e-06  4.00e-04     6s
  46  -1.26642405e+04 -1.26054848e+04  6.98e-05 2.65e-06  2.97e-04     6s
  47  -1.26567793e+04 -1.26148353e+04  5.48e-05 1.91e-06  2.12e-04     6s
  48  -1.26459691e+04 -1.26211998e+04  3.33e-05 7.21e-07  1.25e-04     6s
  49  -1.26408927e+04 -1.26217008e+04  2.39e-05 6.65e-07  9.69e-05     6s
  50  -1.26323746e+04 -1.26230192e+04  8.01e-06 5.24e-07  4.72e-05     6s
  51  -1.26284060e+04 -1.26270369e+04  5.30e-07 6.71e-07  6.91e-06     6s
  52  -1.26280303e+04 -1.26277802e+04  1.15e-07 9.74e-08  1.26e-06     7s
  53  -1.26279225e+04 -1.26279091e+04  1.95e-08 1.24e-08  6.78e-08     7s
  54  -1.26279105e+04 -1.26279103e+04  6.53e-09 1.03e-09  6.01e-10     7s

Barrier solved model in 54 iterations and 6.66 seconds (10.56 work units)
Optimal objective -1.26279105e+04


Root crossover log...

   76854 DPushes remaining with DInf 0.0000000e+00                 7s
    6155 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

   17600 PPushes remaining with PInf 5.8344744e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2121266e+03     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56991   -1.2627910e+04   0.000000e+00   2.212127e+03     12s
   57032   -1.2627910e+04   0.000000e+00   0.000000e+00     12s
   57032   -1.2627910e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.54s

Solved with barrier

Root relaxation: objective -1.262791e+04, 57032 iterations, 10.18 seconds (21.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -12627.910    0  609 -201924.56 -12627.910  93.7%     -   13s
H    0     0                    -197425.4348 -12627.910  93.6%     -   13s
H    0     0                    -191450.0922 -12627.910  93.4%     -   13s
H    0     0                    -191355.9388 -12627.910  93.4%     -   13s
H    0     0                    -191098.5626 -12627.910  93.4%     -   13s
H    0     0                    -165492.9420 -12627.910  92.4%     -   13s
H    0     0                    -160544.8250 -12627.910  92.1%     -   14s
H    0     0                    -159754.0039 -12627.910  92.1%     -   14s
H    0     0                    -159675.3268 -12627.910  92.1%     -   14s
H    0     0                    -159655.4945 -12627.910  92.1%     -   14s
H    0     0                    -105288.3119 -12627.910  88.0%     -   14s
H    0     0                    -105280.9446 -12627.910  88.0%     -   14s
H    0     0                    -79361.84454 -12627.910  84.1%     -   14s
H    0     0                    -79101.91697 -12627.910  84.0%     -   14s
H    0     0                    -77597.60362 -12627.910  83.7%     -   14s
H    0     0                    -68903.68076 -12627.910  81.7%     -   17s
H    0     0                    -68378.14526 -12627.910  81.5%     -   17s
H    0     0                    -60837.27459 -16724.619  72.5%     -   60s
H    0     0                    -59602.85621 -16724.619  71.9%     -   60s
H    0     0                    -59590.55513 -16724.619  71.9%     -   60s
     0     0 -16724.619    0  772 -59590.555 -16724.619  71.9%     -   60s
H    0     0                    -59577.41491 -16724.852  71.9%     -   61s
     0     0 -17429.842    0  764 -59577.415 -17429.842  70.7%     -   81s
     0     0 -17810.087    0  758 -59577.415 -17810.087  70.1%     -   95s
     0     0 -17843.727    0  745 -59577.415 -17843.727  70.0%     -  101s
     0     0 -17861.341    0  739 -59577.415 -17861.341  70.0%     -  105s
     0     0 -17862.522    0  730 -59577.415 -17862.522  70.0%     -  113s
     0     0 -17862.522    0  751 -59577.415 -17862.522  70.0%     -  115s
     0     0 -17862.522    0  750 -59577.415 -17862.522  70.0%     -  116s
H    0     0                    -56041.68646 -19715.241  64.8%     -  158s
H    0     0                    -55281.66528 -19715.241  64.3%     -  158s
     0     0 -20168.954    0  556 -55281.665 -20168.954  63.5%     -  158s
     0     0 -20373.033    0  636 -55281.665 -20373.033  63.1%     -  200s
     0     0 -20554.148    0  705 -55281.665 -20554.148  62.8%     -  230s
     0     0 -20596.963    0  606 -55281.665 -20596.963  62.7%     -  245s
     0     0 -20629.048    0  595 -55281.665 -20629.048  62.7%     -  254s
     0     0 -20740.757    0  715 -55281.665 -20740.757  62.5%     -  268s
     0     0 -20885.437    0  613 -55281.665 -20885.437  62.2%     -  281s
     0     0 -20896.810    0  615 -55281.665 -20896.810  62.2%     -  285s
     0     0 -20899.883    0  618 -55281.665 -20899.883  62.2%     -  287s
     0     0 -20900.878    0  617 -55281.665 -20900.878  62.2%     -  288s
H    0     0                    -54610.05231 -22188.414  59.4%     -  343s
H    0     0                    -54342.22544 -22188.414  59.2%     -  343s
H    0     0                    -52853.27195 -22188.414  58.0%     -  343s
     0     0 -22188.414    0  715 -52853.272 -22188.414  58.0%     -  343s
H    0     0                    -36629.12376 -22188.446  39.4%     -  344s
H    0     0                    -36101.02431 -22188.446  38.5%     -  344s
H    0     0                    -36093.38213 -22188.446  38.5%     -  344s
H    0     0                    -36053.76736 -22188.446  38.5%     -  344s
H    0     0                    -36048.12316 -22188.446  38.4%     -  344s
     0     0 -22497.957    0  716 -36048.123 -22497.957  37.6%     -  366s
     0     0 -22592.991    0  715 -36048.123 -22592.991  37.3%     -  377s
     0     0 -22789.190    0  708 -36048.123 -22789.190  36.8%     -  395s
     0     0 -22822.763    0  777 -36048.123 -22822.763  36.7%     -  403s
     0     0 -22910.091    0  795 -36048.123 -22910.091  36.4%     -  415s
     0     0 -22931.988    0  796 -36048.123 -22931.988  36.4%     -  420s
     0     0 -22950.851    0  802 -36048.123 -22950.851  36.3%     -  425s
     0     0 -22958.080    0  803 -36048.123 -22958.080  36.3%     -  428s
     0     0 -22991.574    0  808 -36048.123 -22991.574  36.2%     -  435s
     0     0 -22997.170    0  810 -36048.123 -22997.170  36.2%     -  438s
     0     0 -23000.471    0  824 -36048.123 -23000.471  36.2%     -  440s
     0     0 -23000.952    0  820 -36048.123 -23000.952  36.2%     -  441s
     0     0 -23761.361    0  722 -36048.123 -23761.361  34.1%     -  500s
H    0     0                    -35864.72324 -23761.528  33.7%     -  501s
H    0     0                    -35799.70830 -23761.528  33.6%     -  501s
H    0     0                    -35786.53898 -23761.528  33.6%     -  501s
     0     0 -23930.068    0  754 -35786.539 -23930.068  33.1%     -  522s
     0     0 -24045.500    0  702 -35786.539 -24045.500  32.8%     -  537s
     0     0 -24076.000    0  710 -35786.539 -24076.000  32.7%     -  543s
     0     0 -24086.596    0  726 -35786.539 -24086.596  32.7%     -  547s
     0     0 -24098.418    0  723 -35786.539 -24098.418  32.7%     -  552s
     0     0 -24101.557    0  718 -35786.539 -24101.557  32.7%     -  554s
     0     0 -24102.965    0  686 -35786.539 -24102.965  32.6%     -  556s
     0     0 -24583.124    0  746 -35786.539 -24583.124  31.3%     -  588s
H    0     0                    -35737.84226 -24583.134  31.2%     -  588s
H    0     0                    -35693.33258 -24583.134  31.1%     -  588s
     0     0 -24729.510    0  863 -35693.333 -24729.510  30.7%     -  606s
     0     0 -24782.189    0  783 -35693.333 -24782.189  30.6%     -  618s
     0     0 -24797.505    0  782 -35693.333 -24797.505  30.5%     -  622s
     0     0 -24815.559    0  786 -35693.333 -24815.559  30.5%     -  629s
     0     0 -24830.892    0  841 -35693.333 -24830.892  30.4%     -  634s
     0     0 -24836.552    0  783 -35693.333 -24836.552  30.4%     -  637s
     0     0 -24855.368    0  771 -35693.333 -24855.368  30.4%     -  643s
     0     0 -24857.577    0  768 -35693.333 -24857.577  30.4%     -  645s
     0     0 -24858.085    0  831 -35693.333 -24858.085  30.4%     -  646s
     0     0 -24971.451    0  792 -35693.333 -24971.451  30.0%     -  665s
H    0     0                    -34796.81089 -24971.755  28.2%     -  669s
H    0     0                    -34286.07597 -24971.755  27.2%     -  669s
H    0     0                    -33806.67524 -24971.755  26.1%     -  669s
H    0     0                    -32949.81468 -24971.755  24.2%     -  669s
H    0     0                    -32903.03256 -24971.755  24.1%     -  670s
H    0     0                    -32704.11525 -24971.755  23.6%     -  670s
H    0     0                    -32558.90279 -24971.755  23.3%     -  670s
H    0     0                    -32482.85570 -24971.755  23.1%     -  670s
     0     0 -25003.775    0  754 -32482.856 -25003.775  23.0%     -  679s
     0     0 -25032.212    0  710 -32482.856 -25032.212  22.9%     -  691s
     0     0 -25050.619    0  725 -32482.856 -25050.619  22.9%     -  699s
     0     0 -25054.454    0  733 -32482.856 -25054.454  22.9%     -  701s
     0     0 -25056.625    0  740 -32482.856 -25056.625  22.9%     -  703s
     0     0 -25058.008    0  738 -32482.856 -25058.008  22.9%     -  704s
     0     0 -25095.834    0  636 -32482.856 -25095.834  22.7%     -  713s
     0     0 -25102.552    0  636 -32482.856 -25102.552  22.7%     -  718s
     0     0 -25109.565    0  710 -32482.856 -25109.565  22.7%     -  723s
     0     0 -25119.380    0  715 -32482.856 -25119.380  22.7%     -  727s
     0     0 -25123.352    0  707 -32482.856 -25123.352  22.7%     -  731s
     0     0 -25126.756    0  713 -32482.856 -25126.756  22.6%     -  734s
     0     0 -25128.658    0  726 -32482.856 -25128.658  22.6%     -  737s
     0     0 -25152.828    0  654 -32482.856 -25152.828  22.6%     -  744s
H    0     0                    -32468.32593 -25152.881  22.5%     -  746s
H    0     0                    -32223.98641 -25152.881  21.9%     -  746s
H    0     0                    -32201.37225 -25152.881  21.9%     -  746s
H    0     0                    -32186.13479 -25152.881  21.9%     -  746s
     0     0 -25164.192    0  666 -32186.135 -25164.192  21.8%     -  750s
     0     0 -25168.657    0  750 -32186.135 -25168.657  21.8%     -  754s
     0     0 -25169.339    0  813 -32186.135 -25169.339  21.8%     -  756s
     0     0 -25177.524    0  689 -32186.135 -25177.524  21.8%     -  763s
     0     0 -25179.222    0  767 -32186.135 -25179.222  21.8%     -  767s
     0     0 -25193.004    0  679 -32186.135 -25193.004  21.7%     -  774s
H    0     0                    -32177.35076 -25193.014  21.7%     -  797s
H    0     0                    -31650.07404 -25193.014  20.4%     -  797s
H    0     0                    -31614.02184 -25193.014  20.3%     -  797s
H    0     0                    -31606.04730 -25193.014  20.3%     -  797s
     0     0 -25196.518    0  754 -31606.047 -25196.518  20.3%     -  800s
     0     0 -25202.035    0  753 -31606.047 -25202.035  20.3%     -  805s
     0     0 -25202.296    0  804 -31606.047 -25202.296  20.3%     -  807s
     0     0 -25207.565    0  675 -31606.047 -25207.565  20.2%     -  812s
     0     0 -25207.630    0  675 -31606.047 -25207.630  20.2%     -  818s
H    0     0                    -31533.62584 -25207.685  20.1%     -  913s
H    0     0                    -31530.66676 -25207.685  20.1%     -  919s
H    0     0                    -31406.08198 -25207.685  19.7%     -  919s
H    0     0                    -31398.92432 -25207.685  19.7%     -  919s
H    0     0                    -31392.21032 -25207.685  19.7%     -  921s
H    0     0                    -31387.85456 -25207.685  19.7%     -  921s
     0     2 -25207.685    0  675 -31387.855 -25207.685  19.7%     -  923s
     1     3 -26420.251    1  436 -31387.855 -25207.685  19.7% 16681  941s
     2     4 -25294.197    1  715 -31387.855 -25294.197  19.4% 13184  951s
     3     8 -25453.900    2  736 -31387.855 -25294.965  19.4% 13040  963s
     7    16 -25635.850    3  691 -31387.855 -25404.662  19.1% 10549 1009s
    15    32 -25761.463    4  696 -31387.855 -25453.762  18.9% 14217 1032s
    31    48 -27545.222    5  563 -31387.855 -25647.731  18.3% 19095 1097s
    47    76 -27047.526    6  532 -31387.855 -25647.731  18.3% 20605 1126s
H   48    76                    -31381.16782 -25647.731  18.3% 20175 1126s
H   54    75                    -31376.51068 -25647.731  18.3% 19332 1126s
    77   168 -27078.828    7  449 -31376.511 -25647.731  18.3% 15228 1180s
   172   198 -27247.465   10  386 -31376.511 -25647.731  18.3%  9494 1217s
   206   244 -27314.992   11  478 -31376.511 -25647.731  18.3%  8758 1272s
   258   262 -27367.805   12  400 -31376.511 -25647.731  18.3%  8276 1315s
   294   281 -27650.401   13  475 -31376.511 -25647.731  18.3%  7818 1354s
   343   314 -27701.867   14  546 -31376.511 -25647.731  18.3%  7549 1394s
   399   342 -28595.028   15  549 -31376.511 -25647.731  18.3%  7720 1416s
   451   387 -29376.229   16  561 -31376.511 -25647.731  18.3%  7994 1439s
   512   421 -29392.767   17  552 -31376.511 -25647.731  18.3%  8291 1456s
   570   439 -29689.752   18  536 -31376.511 -25647.731  18.3%  8270 1475s
   621   461 -30941.981   19  452 -31376.511 -25647.731  18.3%  8324 1495s
   688   471     cutoff   20      -31376.511 -25647.731  18.3%  8394 1514s
   760   459 -29008.193   14  325 -31376.511 -25647.731  18.3%  8235 1534s
   832   477 -29367.292   15  334 -31376.511 -25647.731  18.3%  8196 1554s
   884   491 -30050.606   16  299 -31376.511 -25647.731  18.3%  8232 1575s
   932   508     cutoff   17      -31376.511 -25647.731  18.3%  8256 1596s
   983   522 -30680.795   17  266 -31376.511 -25647.731  18.3%  8344 1619s
  1015   532 -30866.756   18  256 -31376.511 -25647.731  18.3%  8402 1659s
  1065   530 infeasible   19      -31376.511 -25647.731  18.3%  8333 1684s
  1127   538     cutoff   18      -31376.511 -25647.731  18.3%  8238 1711s
  1181   546 -27834.854   11  422 -31376.511 -25647.731  18.3%  8315 1734s
  1235   564 -28833.730   12  393 -31376.511 -25647.731  18.3%  8468 1758s
  1291   570 -29153.010   13  464 -31376.511 -25647.731  18.3%  8492 1785s
  1343   582 -29532.806   14  531 -31376.511 -25647.731  18.3%  8595 1811s
H 1400   582                    -31354.97773 -25647.731  18.2%  8589 1812s
  1417   621     cutoff   15      -31354.978 -25647.731  18.2%  8582 1842s
  1526   656     cutoff   16      -31354.978 -25647.731  18.2%  8576 1876s
  1640   692 -30783.100   13  377 -31354.978 -25732.444  17.9%  8510 1906s
  1766   702 -26695.074    6  427 -31354.978 -25732.517  17.9%  8449 1940s
  1874   711 -26793.237    7  417 -31354.978 -25732.517  17.9%  8413 1977s
  1969   761 -27807.544    9  269 -31354.978 -25732.517  17.9%  8473 2013s
  2065   825 -29088.794   11  159 -31354.978 -25732.517  17.9%  8535 2046s
  2220   892 -30721.736   24   83 -31354.978 -25732.517  17.9%  8433 2081s
  2401   910     cutoff   34      -31354.978 -25732.517  17.9%  8194 2118s
  2541   931 -28575.456    9  295 -31354.978 -25732.517  17.9%  8205 2162s
  2669   954     cutoff   11      -31354.978 -25732.517  17.9%  8249 2206s
  2799   963 -28936.538   13  540 -31354.978 -25732.517  17.9%  8317 2255s
  2886   995 -29899.572   14  486 -31354.978 -25876.643  17.5%  8422 2301s
  3040  1027 -26894.564    7  696 -31354.978 -25876.643  17.5%  8467 2354s
  3172  1083 -29582.476    8  594 -31354.978 -25876.643  17.5%  8540 2402s
  3351  1090 -29805.748    9  702 -31354.978 -25876.643  17.5%  8521 2460s
  3411  1101 -29809.908   10  703 -31354.978 -25876.643  17.5%  8585 2527s
  3508  1145 -30205.632   11  642 -31354.978 -25876.643  17.5%  8537 2600s
  3651  1174 -30715.868   26   14 -31354.978 -25876.643  17.5%  8561 2657s
  3853  1181     cutoff   12      -31354.978 -25876.643  17.5%  8477 2722s
  3998  1190     cutoff   12      -31354.978 -25876.643  17.5%  8553 2784s
  4129  1226 -31212.648   14  292 -31354.978 -25876.643  17.5%  8704 2847s
  4305  1261 -30231.299   12  659 -31354.978 -25876.643  17.5%  8777 2907s
  4499  1290 -30866.295   14  676 -31354.978 -25876.643  17.5%  8854 2980s
  4746  1293     cutoff   13      -31354.978 -26418.300  15.7%  8842 3055s
  4936  1315 -30263.745   16  262 -31354.978 -26418.429  15.7%  8984 3131s
  5190  1322 -31199.051   18  169 -31354.978 -26418.429  15.7%  8980 3210s
  5391  1337     cutoff   16      -31354.978 -26418.429  15.7%  9033 3287s
  5652  1316 -31078.784   16  302 -31354.978 -27593.284  12.0%  9087 3377s
  5891  1353     cutoff   13      -31354.978 -27593.284  12.0%  9148 3470s
  6149  1351 -30440.416   15  301 -31354.978 -27593.284  12.0%  9147 3563s
  6520  1347 infeasible   17      -31354.978 -28867.079  7.93%  9051 3600s

Cutting planes:
  Learned: 1
  Implied bound: 130
  MIR: 3638
  Flow cover: 4435
  Zero half: 12
  RLT: 216
  Relax-and-lift: 1224

Explored 6594 nodes (60312466 simplex iterations) in 3600.08 seconds (9089.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31355 -31376.5 -31381.2 ... -31606

Time limit reached
Warning: max constraint violation (1.1651e-09) exceeds tolerance
Best objective -3.135497773026e+04, best bound -2.886707852653e+04, gap 7.9346%
  WARNING: Time limit reached. Using best solution found (gap: 7.93%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -31354.98, θ = 93502.71
  Upper Bound (UB) = -31354.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93502.71
  [DEBUG]   ✓ Scenario 0: θ = 93502.71 ≤ Q = 93502.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93502.71 ≤ Q = 93502.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93502.71 ≤ Q = 93502.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93502.71 ≤ Q = 93502.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93502.71 ≤ Q = 93502.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93502.71 ≤ Q = 93502.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93502.71 ≤ Q = 93502.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93502.71 ≤ Q = 93502.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93502.71 ≤ Q = 93502.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93502.71 ≤ Q = 93502.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93502.71 ≤ Q = 93502.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93502.71 ≤ Q = 93502.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93502.71 ≤ Q = 93502.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7910cb58
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7910cb58
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-13, 2e+02]
Found heuristic solution: objective 1.177514e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5453261.7473
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.235608e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123560.77    0  124 5453261.75 -123560.77   102%     -    0s
H    0     0                    -89730.59622 -123560.77  37.7%     -    0s
H    0     0                    -90289.27635 -123560.77  36.8%     -    0s
     0     0 -99981.408    0   64 -90289.276 -99981.408  10.7%     -    0s
H    0     0                    -97870.49818 -99955.798  2.13%     -    0s
     0     0 -99586.176    0   66 -97870.498 -99586.176  1.75%     -    0s
H    0     0                    -98342.86090 -99316.415  0.99%     -    0s
H    0     0                    -98349.76116 -99316.415  0.98%     -    0s
     0     0 -99316.415    0   70 -98349.761 -99316.415  0.98%     -    0s
     0     0 -99279.409    0   69 -98349.761 -99279.409  0.95%     -    0s
     0     0 -99076.496    0   51 -98349.761 -99076.496  0.74%     -    0s
     0     0 -99019.713    0   51 -98349.761 -99019.713  0.68%     -    0s
     0     0 -98944.033    0   35 -98349.761 -98944.033  0.60%     -    0s
     0     0 -98908.907    0   39 -98349.761 -98908.907  0.57%     -    0s
     0     0 -98888.566    0   38 -98349.761 -98888.566  0.55%     -    0s
     0     0 -98886.195    0   38 -98349.761 -98886.195  0.55%     -    0s
     0     0 -98790.330    0   32 -98349.761 -98790.330  0.45%     -    0s
     0     0 -98776.144    0   32 -98349.761 -98776.144  0.43%     -    0s
     0     0 -98776.144    0   76 -98349.761 -98776.144  0.43%     -    0s
     0     0 -98776.144    0   41 -98349.761 -98776.144  0.43%     -    0s
H    0     0                    -98358.21185 -98776.144  0.42%     -    0s
     0     0 -98671.033    0   19 -98358.212 -98671.033  0.32%     -    0s
     0     0 -98665.955    0   16 -98358.212 -98665.955  0.31%     -    0s
     0     0 -98499.156    0   17 -98358.212 -98499.156  0.14%     -    0s
     0     0 -98490.892    0   14 -98358.212 -98490.892  0.13%     -    0s
H    0     0                    -98362.32589 -98474.407  0.11%     -    0s
     0     0 -98474.407    0   14 -98362.326 -98474.407  0.11%     -    0s
     0     0 -98394.481    0    9 -98362.326 -98394.481  0.03%     -    0s
     0     0 -98394.481    0   10 -98362.326 -98394.481  0.03%     -    0s
H    0     0                    -98383.52448 -98394.481  0.01%     -    0s
     0     0     cutoff    0      -98383.524 -98383.524  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 5
  Flow cover: 4

Explored 1 nodes (1048 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -98383.5 -98362.3 -98358.2 ... 1.17751e+13
No other solutions better than -98383.5

Optimal solution found (tolerance 1.00e-06)
Best objective -9.838352448180e+04, best bound -9.838352448180e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 88028.02
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98383.52
  [DEBUG]   S×d_nominal = 186411.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186411.54 + -98383.52 = 88028.02
  [DEBUG]   Current θ from Master = 93502.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5474.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -36829.67
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 1761.7292, Absolute Gap = 1761.7292, Relative Gap = 0.056187
  Not converged yet (gap = 1761.73 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x252a7b66
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 1.99s
Presolved: 116463 rows, 49440 columns, 702705 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427274.8974
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 605
 AA' NZ     : 4.699e+06
 Factor NZ  : 1.116e+07 (roughly 160 MB of memory)
 Factor Ops : 2.280e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37486236e+07  2.07996509e+08  7.05e+04 1.71e+01  5.90e+04     3s
   1  -1.03636270e+07  1.74034767e+08  4.74e+04 5.07e+01  3.93e+04     3s
   2  -4.01510217e+06  1.33078363e+08  1.77e+04 7.38e+00  1.53e+04     4s
   3  -7.65212336e+05  9.70775767e+07  1.55e+03 1.07e+00  1.69e+03     4s
   4  -4.80613920e+05  3.54583989e+07  3.71e+02 4.15e-02  4.31e+02     4s
   5  -3.93640343e+05  2.51339931e+07  1.62e+02 2.52e-02  2.27e+02     4s
   6  -2.69783542e+05  1.83114287e+07  4.28e+01 1.65e-02  1.12e+02     4s
   7  -1.65367187e+05  1.15920332e+07  1.01e+01 9.68e-03  5.96e+01     4s
   8  -1.32398129e+05  4.18392401e+06  6.72e+00 3.13e-03  2.16e+01     4s
   9  -1.00175638e+05  2.03186325e+06  3.76e+00 1.44e-03  1.04e+01     4s
  10  -8.05850658e+04  8.97332761e+05  2.51e+00 6.10e-04  4.72e+00     4s
  11  -6.41579398e+04  3.77800608e+05  1.32e+00 2.95e-04  2.11e+00     4s
  12  -4.62490143e+04  1.57104186e+05  4.25e-01 1.78e-04  9.60e-01     4s
  13  -3.93773227e+04  7.20707667e+04  2.90e-01 2.47e-04  5.25e-01     4s
  14  -3.67144274e+04  5.54652282e+04  2.44e-01 2.14e-04  4.34e-01     4s
  15  -3.48460168e+04  4.74490266e+04  2.18e-01 1.88e-04  3.88e-01     4s
  16  -3.16642499e+04  3.01375912e+04  1.80e-01 3.27e-04  2.91e-01     4s
  17  -2.87849265e+04  1.99686284e+04  1.49e-01 8.17e-04  2.30e-01     4s
  18  -2.61948375e+04  1.47829670e+04  1.21e-01 8.58e-04  1.93e-01     4s
  19  -2.36446024e+04  8.97359512e+03  9.51e-02 1.18e-03  1.53e-01     5s
  20  -2.19117698e+04  3.50095602e+03  7.95e-02 1.27e-03  1.20e-01     5s
  21  -2.06004725e+04  6.33015766e+02  6.57e-02 1.30e-03  9.99e-02     5s
  22  -1.89934444e+04 -2.01858027e+03  5.13e-02 1.47e-03  7.98e-02     5s
  23  -1.78795394e+04 -5.37086565e+03  4.15e-02 2.20e-03  5.88e-02     5s
  24  -1.68243723e+04 -6.61796466e+03  3.25e-02 1.63e-03  4.80e-02     5s
  25  -1.56513684e+04 -8.27791714e+03  2.26e-02 8.73e-04  3.47e-02     5s
  26  -1.49430883e+04 -1.00176600e+04  1.70e-02 8.57e-04  2.32e-02     5s
  27  -1.45246867e+04 -1.06298821e+04  1.38e-02 6.09e-04  1.83e-02     5s
  28  -1.41317757e+04 -1.10561491e+04  1.09e-02 4.61e-04  1.45e-02     5s
  29  -1.37911354e+04 -1.14925816e+04  8.57e-03 3.17e-04  1.08e-02     5s
  30  -1.36920511e+04 -1.16037593e+04  7.90e-03 2.88e-04  9.82e-03     5s
  31  -1.36063377e+04 -1.17625696e+04  7.32e-03 3.45e-04  8.67e-03     5s
  32  -1.33592205e+04 -1.19321473e+04  5.63e-03 4.34e-04  6.71e-03     5s
  33  -1.31962375e+04 -1.20946646e+04  4.53e-03 3.10e-04  5.18e-03     6s
  34  -1.30302156e+04 -1.22047460e+04  3.42e-03 2.26e-04  3.88e-03     6s
  35  -1.28492124e+04 -1.23108218e+04  2.23e-03 1.44e-04  2.53e-03     6s
  36  -1.28032761e+04 -1.23423723e+04  1.95e-03 1.18e-04  2.17e-03     6s
  37  -1.27555577e+04 -1.23594741e+04  1.65e-03 1.04e-04  1.86e-03     6s
  38  -1.27370386e+04 -1.23769869e+04  1.53e-03 1.09e-04  1.69e-03     6s
  39  -1.26797297e+04 -1.24000509e+04  1.16e-03 8.79e-05  1.32e-03     6s
  40  -1.26470114e+04 -1.24346840e+04  9.58e-04 5.89e-05  9.99e-04     6s
  41  -1.25933348e+04 -1.24425298e+04  6.29e-04 5.06e-05  7.09e-04     6s
  42  -1.25679724e+04 -1.24546567e+04  4.66e-04 4.62e-05  5.33e-04     6s
  43  -1.25590571e+04 -1.24586170e+04  4.12e-04 4.11e-05  4.72e-04     6s
  44  -1.25494872e+04 -1.24641032e+04  3.53e-04 3.33e-05  4.02e-04     6s
  45  -1.25369676e+04 -1.24706045e+04  2.73e-04 2.53e-05  3.12e-04     7s
  46  -1.25225164e+04 -1.24791051e+04  1.87e-04 1.46e-05  2.04e-04     7s
  47  -1.25150105e+04 -1.24823512e+04  1.39e-04 1.06e-05  1.54e-04     7s
  48  -1.25018764e+04 -1.24830585e+04  5.83e-05 9.82e-06  8.85e-05     7s
  49  -1.25003882e+04 -1.24839552e+04  5.00e-05 8.74e-06  7.73e-05     7s
  50  -1.24993661e+04 -1.24863117e+04  4.39e-05 6.01e-06  6.14e-05     7s
  51  -1.24956795e+04 -1.24893043e+04  2.29e-05 2.62e-06  3.00e-05     7s
  52  -1.24936627e+04 -1.24899917e+04  1.09e-05 1.79e-06  1.73e-05     7s
  53  -1.24918166e+04 -1.24904712e+04  7.34e-07 1.25e-06  6.32e-06     7s
  54  -1.24917147e+04 -1.24912903e+04  4.59e-07 2.78e-07  1.99e-06     7s
  55  -1.24916581e+04 -1.24915110e+04  2.96e-07 4.62e-08  6.91e-07     8s
  56  -1.24915568e+04 -1.24915543e+04  1.13e-08 1.79e-08  1.16e-08     8s
  57  -1.24915562e+04 -1.24915546e+04  2.91e-07 8.66e-08  7.51e-09     8s
  58  -1.24915554e+04 -1.24915550e+04  8.96e-08 1.89e-07  1.73e-09     8s
  59  -1.24915551e+04 -1.24915551e+04  1.05e-07 4.59e-08  6.41e-11     8s

Barrier solved model in 59 iterations and 7.92 seconds (12.12 work units)
Optimal objective -1.24915551e+04


Root crossover log...

   84263 DPushes remaining with DInf 0.0000000e+00                 8s
   11191 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    7631 PPushes remaining with PInf 3.1660364e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.6079723e+02     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   44239   -1.2491555e+04   0.000000e+00   5.607972e+02     11s
   44241   -1.2491555e+04   0.000000e+00   0.000000e+00     11s
   44241   -1.2491555e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.75s

Solved with barrier

Root relaxation: objective -1.249156e+04, 44241 iterations, 9.37 seconds (17.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -12491.555    0  591 -201924.56 -12491.555  93.8%     -   12s
H    0     0                    -164538.0175 -12491.555  92.4%     -   13s
H    0     0                    -164175.2178 -12491.555  92.4%     -   13s
H    0     0                    -148747.0974 -12491.555  91.6%     -   13s
H    0     0                    -147221.6362 -12491.555  91.5%     -   13s
H    0     0                    -98520.47066 -12491.555  87.3%     -   13s
H    0     0                    -98513.10340 -12491.555  87.3%     -   13s
H    0     0                    -93273.07507 -12491.555  86.6%     -   13s
H    0     0                    -88332.22349 -12491.555  85.9%     -   13s
H    0     0                    -77629.24031 -12491.555  83.9%     -   13s
H    0     0                    -77607.83482 -16416.220  78.8%     -   56s
H    0     0                    -77453.29636 -16416.220  78.8%     -   56s
H    0     0                    -63952.87890 -16416.220  74.3%     -   56s
H    0     0                    -59595.92429 -16416.220  72.5%     -   56s
     0     0 -16416.220    0  690 -59595.924 -16416.220  72.5%     -   56s
     0     0 -17148.733    0  744 -59595.924 -17148.733  71.2%     -   79s
     0     0 -17329.220    0  733 -59595.924 -17329.220  70.9%     -   93s
     0     0 -17371.489    0  752 -59595.924 -17371.489  70.9%     -   98s
     0     0 -17373.870    0  749 -59595.924 -17373.870  70.8%     -  100s
     0     0 -17410.669    0  752 -59595.924 -17410.669  70.8%     -  106s
     0     0 -17410.669    0  738 -59595.924 -17410.669  70.8%     -  115s
     0     0 -17414.293    0  740 -59595.924 -17414.293  70.8%     -  116s
     0     0 -17435.456    0  730 -59595.924 -17435.456  70.7%     -  119s
     0     0 -17438.762    0  734 -59595.924 -17438.762  70.7%     -  121s
     0     0 -17439.205    0  734 -59595.924 -17439.205  70.7%     -  121s
H    0     0                    -56850.14930 -19339.826  66.0%     -  177s
H    0     0                    -55130.47516 -19339.826  64.9%     -  177s
H    0     0                    -55014.43486 -19339.826  64.8%     -  177s
     0     0 -19339.826    0  624 -55014.435 -19339.826  64.8%     -  177s
H    0     0                    -54831.02629 -19340.125  64.7%     -  178s
H    0     0                    -54766.70349 -19340.125  64.7%     -  178s
H    0     0                    -54745.85191 -19340.125  64.7%     -  178s
H    0     0                    -47174.57049 -20152.423  57.3%     -  236s
H    0     0                    -47093.08556 -20152.423  57.2%     -  236s
H    0     0                    -46926.79243 -20152.423  57.1%     -  236s
H    0     0                    -46909.26429 -20152.423  57.0%     -  236s
     0     0 -20152.423    0  675 -46909.264 -20152.423  57.0%     -  236s
     0     0 -20279.045    0  682 -46909.264 -20279.045  56.8%     -  262s
     0     0 -20425.546    0  738 -46909.264 -20425.546  56.5%     -  279s
     0     0 -20450.560    0  726 -46909.264 -20450.560  56.4%     -  289s
     0     0 -20474.851    0  654 -46909.264 -20474.851  56.4%     -  298s
     0     0 -20494.601    0  641 -46909.264 -20494.601  56.3%     -  303s
     0     0 -20507.755    0  644 -46909.264 -20507.755  56.3%     -  306s
     0     0 -20514.076    0  647 -46909.264 -20514.076  56.3%     -  308s
     0     0 -20544.616    0  657 -46909.264 -20544.616  56.2%     -  313s
     0     0 -20546.124    0  662 -46909.264 -20546.124  56.2%     -  314s
H    0     0                    -38280.69685 -20610.960  46.2%     -  327s
H    0     0                    -38277.44705 -20610.960  46.2%     -  327s
     0     0 -20610.960    0  636 -38277.447 -20610.960  46.2%     -  327s
     0     0 -20614.667    0  706 -38277.447 -20614.667  46.1%     -  331s
     0     0 -20614.767    0  708 -38277.447 -20614.767  46.1%     -  332s
H    0     0                    -38099.00586 -20614.767  45.9%     -  343s
     0     0 -22540.309    0  704 -38099.006 -22540.309  40.8%     -  435s
     0     0 -22722.433    0  694 -38099.006 -22722.433  40.4%     -  462s
     0     0 -22794.916    0  663 -38099.006 -22794.916  40.2%     -  474s
H    0     0                    -38085.02573 -22935.311  39.8%     -  488s
     0     0 -22935.311    0  817 -38085.026 -22935.311  39.8%     -  488s
     0     0 -22999.532    0  801 -38085.026 -22999.532  39.6%     -  503s
H    0     0                    -36946.41798 -23009.223  37.7%     -  509s
H    0     0                    -36923.19915 -23009.223  37.7%     -  509s
H    0     0                    -36917.05509 -23009.223  37.7%     -  509s
     0     0 -23009.223    0  824 -36917.055 -23009.223  37.7%     -  509s
     0     0 -23077.954    0  736 -36917.055 -23077.954  37.5%     -  523s
     0     0 -23123.566    0  849 -36917.055 -23123.566  37.4%     -  537s
     0     0 -23133.276    0  860 -36917.055 -23133.276  37.3%     -  543s
     0     0 -23158.029    0  821 -36917.055 -23158.029  37.3%     -  552s
     0     0 -23164.410    0  838 -36917.055 -23164.410  37.3%     -  557s
     0     0 -23165.883    0  685 -36917.055 -23165.883  37.2%     -  559s
     0     0 -23168.027    0  840 -36917.055 -23168.027  37.2%     -  561s
     0     0 -23183.080    0  823 -36917.055 -23183.080  37.2%     -  567s
     0     0 -23187.758    0  825 -36917.055 -23187.758  37.2%     -  569s
     0     0 -23222.880    0  826 -36917.055 -23222.880  37.1%     -  578s
     0     0 -23232.723    0  848 -36917.055 -23232.723  37.1%     -  585s
     0     0 -23236.278    0  859 -36917.055 -23236.278  37.1%     -  587s
     0     0 -23261.436    0  825 -36917.055 -23261.436  37.0%     -  594s
     0     0 -23268.272    0  834 -36917.055 -23268.272  37.0%     -  597s
     0     0 -23269.097    0  842 -36917.055 -23269.097  37.0%     -  598s
H    0     0                    -32217.12268 -23947.240  25.7%     -  658s
H    0     0                    -31655.26393 -23947.240  24.3%     -  658s
H    0     0                    -31486.24316 -23947.240  23.9%     -  658s
H    0     0                    -31481.58602 -23947.240  23.9%     -  658s
     0     0 -23947.240    0  776 -31481.586 -23947.240  23.9%     -  658s
     0     0 -24263.704    0  732 -31481.586 -24263.704  22.9%     -  687s
     0     0 -24411.510    0  752 -31481.586 -24411.510  22.5%     -  712s
     0     0 -24456.919    0  852 -31481.586 -24456.919  22.3%     -  725s
     0     0 -24469.319    0  854 -31481.586 -24469.319  22.3%     -  730s
     0     0 -24489.237    0  842 -31481.586 -24489.237  22.2%     -  738s
     0     0 -24494.882    0  774 -31481.586 -24494.882  22.2%     -  742s
     0     0 -24500.269    0  790 -31481.586 -24500.269  22.2%     -  745s
     0     0 -24500.706    0  790 -31481.586 -24500.706  22.2%     -  746s
     0     0 -24835.115    0  811 -31481.586 -24835.115  21.1%     -  777s
     0     0 -24963.131    0  777 -31481.586 -24963.131  20.7%     -  798s
     0     0 -24976.054    0  732 -31481.586 -24976.054  20.7%     -  805s
     0     0 -24989.721    0  800 -31481.586 -24989.721  20.6%     -  811s
     0     0 -24998.414    0  863 -31481.586 -24998.414  20.6%     -  816s
     0     0 -25011.038    0  746 -31481.586 -25011.038  20.6%     -  822s
     0     0 -25013.984    0  860 -31481.586 -25013.984  20.5%     -  825s
     0     0 -25016.441    0  869 -31481.586 -25016.441  20.5%     -  828s
     0     0 -25017.685    0  754 -31481.586 -25017.685  20.5%     -  829s
     0     0 -25164.836    0  878 -31481.586 -25164.836  20.1%     -  853s
H    0     0                    -31477.73209 -25164.997  20.1%     -  862s
H    0     0                    -31421.23796 -25164.997  19.9%     -  864s
     0     0 -25217.556    0  879 -31421.238 -25217.556  19.7%     -  877s
     0     0 -25225.796    0  835 -31421.238 -25225.796  19.7%     -  882s
     0     0 -25229.764    0  830 -31421.238 -25229.764  19.7%     -  886s
     0     0 -25233.720    0  912 -31421.238 -25233.720  19.7%     -  889s
     0     0 -25237.999    0  884 -31421.238 -25237.999  19.7%     -  893s
     0     0 -25239.012    0  873 -31421.238 -25239.012  19.7%     -  895s
     0     0 -25338.225    0  804 -31421.238 -25338.225  19.4%     -  915s
H    0     0                    -31408.93688 -25338.230  19.3%     -  916s
     0     0 -25365.914    0  819 -31408.937 -25365.914  19.2%     -  926s
     0     0 -25377.371    0  685 -31408.937 -25377.371  19.2%     -  933s
     0     0 -25381.712    0  825 -31408.937 -25381.712  19.2%     -  936s
     0     0 -25383.309    0  823 -31408.937 -25383.309  19.2%     -  938s
     0     0 -25492.262    0  739 -31408.937 -25492.262  18.8%     -  960s
H    0     0                    -31389.12375 -25492.323  18.8%     -  963s
     0     0 -25509.756    0  675 -31389.124 -25509.756  18.7%     -  975s
     0     0 -25517.120    0  621 -31389.124 -25517.120  18.7%     -  980s
     0     0 -25520.981    0  752 -31389.124 -25520.981  18.7%     -  983s
     0     0 -25521.891    0  759 -31389.124 -25521.891  18.7%     -  985s
     0     0 -25539.146    0  806 -31389.124 -25539.146  18.6%     -  994s
     0     0 -25544.808    0  819 -31389.124 -25544.808  18.6%     - 1000s
     0     0 -25546.887    0  685 -31389.124 -25546.887  18.6%     - 1003s
     0     0 -25567.933    0  687 -31389.124 -25567.933  18.5%     - 1010s
     0     0 -25572.616    0  690 -31389.124 -25572.616  18.5%     - 1013s
     0     0 -25574.171    0  696 -31389.124 -25574.171  18.5%     - 1015s
     0     0 -25584.096    0  695 -31389.124 -25584.096  18.5%     - 1023s
H    0     0                    -31381.19287 -25584.340  18.5%     - 1078s
     0     0 -25585.517    0  702 -31381.193 -25585.517  18.5%     - 1085s
     0     0 -25597.780    0  754 -31381.193 -25597.780  18.4%     - 1091s
     0     0 -25599.002    0  762 -31381.193 -25599.002  18.4%     - 1096s
     0     0 -25600.452    0  763 -31381.193 -25600.452  18.4%     - 1100s
     0     0 -25600.651    0  763 -31381.193 -25600.651  18.4%     - 1107s
     0     2 -25600.651    0  763 -31381.193 -25600.651  18.4%     - 1204s
     1     3 -25705.279    1  747 -31381.193 -25600.851  18.4%  9259 1217s
     2     4 -25632.239    1  763 -31381.193 -25632.239  18.3%  5646 1225s
     3     6 -25734.799    2  752 -31381.193 -25633.638  18.3%  5727 1238s
     5    10 -25857.348    3  726 -31381.193 -25633.638  18.3%  6793 1256s
     9    20 -26082.943    3  597 -31381.193 -25734.834  18.0%  7813 1281s
    19    40 -26208.895    4  579 -31381.193 -25895.323  17.5%  8651 1323s
    39    52 -26533.910    5  510 -31381.193 -25958.739  17.3% 16223 1387s
    51    74 -26772.758    6  605 -31381.193 -25958.739  17.3% 16116 1441s
    73   156 -26916.513    7  602 -31381.193 -25958.739  17.3% 14144 1494s
   155   241 -26992.822   11  658 -31381.193 -25958.739  17.3%  9834 1528s
   240   273 -27169.893   15  665 -31381.193 -25958.739  17.3%  8732 1552s
H  275   273                    -31376.51068 -25958.739  17.3%  8400 1552s
   278   298 -27322.754   16  651 -31376.511 -25958.739  17.3%  8417 1581s
   315   322 -29930.267   12  407 -31376.511 -25958.739  17.3%  8486 1608s
   351   351 -29786.754   17  637 -31376.511 -25958.739  17.3%  9119 1643s
   390   380 -29970.676   18  628 -31376.511 -25958.739  17.3%  8921 1672s
   429   407 -31256.582   13  145 -31376.511 -25958.739  17.3%  8746 1704s
   481   447 infeasible   20      -31376.511 -25958.739  17.3%  8311 1730s
   549   490 -30336.754   16  172 -31376.511 -25958.739  17.3%  7835 1757s
H  610   490                    -31365.23278 -25958.739  17.2%  7528 1757s
   617   518 infeasible   16      -31365.233 -25958.739  17.2%  7487 1787s
   691   531 -28511.692   17  523 -31365.233 -25958.739  17.2%  7029 1815s
   762   557 -28834.938   18  471 -31365.233 -25958.739  17.2%  6688 1840s
   856   536 -28969.204   19  482 -31365.233 -25958.739  17.2%  6317 1867s
   937   518 infeasible   20      -31365.233 -25958.739  17.2%  6020 1898s
   973   523 -29320.927   21  466 -31365.233 -25958.739  17.2%  5896 1930s
   990   543 -29291.464    9  501 -31365.233 -25958.739  17.2%  5891 1966s
  1018   578 -29421.665   10  499 -31365.233 -25958.739  17.2%  5856 1996s
  1077   670 infeasible   11      -31365.233 -26012.322  17.1%  5750 2034s
  1187   709 -30887.691   12  272 -31365.233 -26012.322  17.1%  5511 2065s
  1307   710 infeasible   18      -31365.233 -26012.322  17.1%  5306 2103s
  1414   711 -30860.179   33  432 -31365.233 -26012.322  17.1%  5158 2141s
  1453   720 -31015.738   34  367 -31365.233 -26012.322  17.1%  5132 2172s
  1494   720 -31071.986   35  364 -31365.233 -26012.322  17.1%  5111 2209s
  1553   723 -31144.171   36  320 -31365.233 -26064.054  16.9%  5033 2250s
  1616   736 -30187.299   13  186 -31365.233 -26064.054  16.9%  4981 2293s
  1689   765 -30547.593   21  137 -31365.233 -26064.054  16.9%  4921 2333s
  1773   786 -30686.114   30  112 -31365.233 -26064.054  16.9%  4839 2377s
  1868   812 -31163.346   38   58 -31365.233 -26064.054  16.9%  4746 2429s
  1939   823 -29070.742   11  457 -31365.233 -26064.054  16.9%  4738 2478s
  2013   842 -28593.614   10  481 -31365.233 -26064.054  16.9%  4768 2522s
  2066   849 -29692.275   11  447 -31365.233 -26064.054  16.9%  4819 2569s
  2131   881 infeasible   11      -31365.233 -26088.414  16.8%  4838 2621s
  2202   917 -30117.199   17  529 -31365.233 -26088.414  16.8%  4898 2676s
  2306   953 -27136.510    7  666 -31365.233 -26088.414  16.8%  4935 2728s
  2440  1014 -28645.313    8  545 -31365.233 -26088.414  16.8%  4899 2789s
  2582  1031 -29088.904    9  455 -31365.233 -26386.217  15.9%  4853 2853s
  2719  1055 -30461.757   10  436 -31365.233 -26386.217  15.9%  4866 2922s
  2815  1072 -30670.158   13  421 -31365.233 -26386.217  15.9%  4948 2988s
  2858  1130 -30827.942   14  405 -31365.233 -26386.217  15.9%  5003 3061s
  2952  1145 -31305.441   19  298 -31365.233 -26386.217  15.9%  5025 3143s
  3097  1158 -29280.822   14  548 -31365.233 -26868.563  14.3%  4999 3222s
  3192  1215 -29347.893   15  559 -31365.233 -26868.563  14.3%  5032 3298s
  3320  1295     cutoff   20      -31365.233 -26873.124  14.3%  5091 3387s
  3481  1377 -28405.075   12  743 -31365.233 -26908.160  14.2%  5110 3471s
  3692  1405 infeasible   14      -31365.233 -26908.160  14.2%  5079 3600s

Cutting planes:
  Learned: 3
  Gomory: 2
  Implied bound: 166
  MIR: 3893
  Flow cover: 4533
  Zero half: 17
  RLT: 213
  Relax-and-lift: 1161

Explored 3768 nodes (20102523 simplex iterations) in 3600.09 seconds (7520.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31365.2 -31376.5 -31381.2 ... -31655.3

Time limit reached
Best objective -3.136523278426e+04, best bound -2.696918196035e+04, gap 14.0157%
  WARNING: Time limit reached. Using best solution found (gap: 14.02%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -31365.23, θ = 93372.33
  Upper Bound (UB) = -31365.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93372.33
  [DEBUG]   ✓ Scenario 0: θ = 93372.33 ≤ Q = 93372.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93372.33 ≤ Q = 93372.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93372.33 ≤ Q = 93372.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93372.33 ≤ Q = 93372.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93372.33 ≤ Q = 93372.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93372.33 ≤ Q = 93372.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93372.33 ≤ Q = 93372.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93372.33 ≤ Q = 93372.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93372.33 ≤ Q = 93372.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93372.33 ≤ Q = 93372.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93372.33 ≤ Q = 93372.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93372.33 ≤ Q = 93372.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93372.33 ≤ Q = 93372.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93372.33 ≤ Q = 93372.33 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4e7daa25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb18255db
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177514e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5475304.3130
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.236931e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123693.10    0  124 5475304.31 -123693.10   102%     -    0s
H    0     0                    -89845.27181 -123693.10  37.7%     -    0s
H    0     0                    -90403.95194 -123693.10  36.8%     -    0s
     0     0 -97200.718    0   66 -90403.952 -97200.718  7.52%     -    0s
H    0     0                    -94592.69532 -97140.893  2.69%     -    0s
H    0     0                    -94880.77047 -97140.893  2.38%     -    0s
H    0     0                    -95332.44384 -97140.893  1.90%     -    0s
H    0     0                    -95620.51900 -97140.893  1.59%     -    0s
     0     0 -96771.347    0   67 -95620.519 -96771.347  1.20%     -    0s
     0     0 -96606.147    0   69 -95620.519 -96606.147  1.03%     -    0s
     0     0 -96597.423    0   69 -95620.519 -96597.423  1.02%     -    0s
     0     2 -96569.333    0   69 -95620.519 -96569.333  0.99%     -    0s
H 2294   497                    -95631.44866 -95852.432  0.23%   5.1    0s
H 2307   497                    -95631.58869 -95852.432  0.23%   5.1    0s

Cutting planes:
  Gomory: 30
  Implied bound: 2
  MIR: 163
  RLT: 3

Explored 4644 nodes (25651 simplex iterations) in 0.16 seconds (0.14 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -95631.6 -95631.4 -95620.5 ... 1.17751e+13
No other solutions better than -95631.6

Optimal solution found (tolerance 1.00e-06)
Best objective -9.563158868899e+04, best bound -9.563158868899e+04, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 90806.00
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95631.59
  [DEBUG]   S×d_nominal = 186437.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186437.59 + -95631.59 = 90806.00
  [DEBUG]   Current θ from Master = 93372.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2566.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33931.56
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 1751.4742, Absolute Gap = 1751.4742, Relative Gap = 0.055841
  Not converged yet (gap = 1751.47 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0x2f0458fa
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns
Presolve time: 2.19s
Presolved: 124683 rows, 52810 columns, 767483 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.20s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 5.817e+06
 Factor NZ  : 1.284e+07 (roughly 180 MB of memory)
 Factor Ops : 2.752e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37781392e+07  2.19473128e+08  7.14e+04 1.72e+01  5.88e+04     5s
   1  -1.04969972e+07  1.82965861e+08  4.91e+04 4.98e+01  4.00e+04     5s
   2  -4.23704046e+06  1.39085996e+08  1.86e+04 1.14e+01  1.58e+04     5s
   3  -7.25843387e+05  8.76654736e+07  1.20e+03 1.54e+00  1.32e+03     5s
   4  -5.18057622e+05  3.87102291e+07  3.75e+02 3.53e-01  4.38e+02     5s
   5  -4.16494873e+05  2.77733994e+07  1.53e+02 2.22e-01  2.25e+02     5s
   6  -3.21540625e+05  2.00923725e+07  5.65e+01 1.45e-01  1.23e+02     5s
   7  -2.04390566e+05  1.45566094e+07  7.33e+00 9.90e-02  6.84e+01     5s
   8  -1.58466560e+05  5.83776981e+06  4.68e+00 3.69e-02  2.74e+01     5s
   9  -1.17679800e+05  2.64512689e+06  2.41e+00 1.60e-02  1.24e+01     5s
  10  -1.00574042e+05  1.11783628e+06  1.55e+00 6.68e-03  5.43e+00     5s
  11  -7.38606783e+04  3.64610177e+05  5.55e-01 2.17e-03  1.94e+00     6s
  12  -5.39634445e+04  1.59597979e+05  2.84e-01 1.29e-03  9.41e-01     6s
  13  -4.63502548e+04  9.50466560e+04  2.17e-01 9.55e-04  6.23e-01     6s
  14  -4.20781500e+04  7.09060795e+04  1.84e-01 1.11e-03  4.98e-01     6s
  15  -3.86473539e+04  5.23852850e+04  1.58e-01 1.37e-03  4.01e-01     6s
  16  -3.48765387e+04  3.30241547e+04  1.32e-01 2.12e-03  2.99e-01     6s
  17  -3.05929943e+04  2.23758691e+04  1.02e-01 1.24e-03  2.33e-01     6s
  18  -2.78085622e+04  1.28684581e+04  8.20e-02 1.09e-03  1.79e-01     6s
  19  -2.50123182e+04  4.87898813e+03  6.31e-02 1.46e-03  1.32e-01     6s
  20  -2.30991397e+04 -6.34053256e+02  5.12e-02 4.02e-03  9.90e-02     6s
  21  -2.10289449e+04 -5.05677782e+03  3.94e-02 3.20e-03  7.04e-02     6s
  22  -1.97747061e+04 -6.04829170e+03  3.23e-02 3.06e-03  6.05e-02     6s
  23  -1.86594260e+04 -7.26239351e+03  2.61e-02 2.46e-03  5.02e-02     6s
  24  -1.79497200e+04 -9.42060426e+03  2.22e-02 1.87e-03  3.76e-02     7s
  25  -1.76561014e+04 -1.02631690e+04  2.07e-02 1.49e-03  3.26e-02     7s
  26  -1.67703028e+04 -1.09466391e+04  1.64e-02 1.27e-03  2.57e-02     7s
  27  -1.65595276e+04 -1.10848969e+04  1.53e-02 1.20e-03  2.41e-02     7s
  28  -1.63079865e+04 -1.12851005e+04  1.41e-02 1.11e-03  2.22e-02     7s
  29  -1.58112478e+04 -1.16621730e+04  1.17e-02 9.11e-04  1.83e-02     7s
  30  -1.54864318e+04 -1.20810651e+04  1.01e-02 7.35e-04  1.50e-02     7s
  31  -1.52446941e+04 -1.24133580e+04  8.90e-03 5.78e-04  1.25e-02     7s
  32  -1.49023102e+04 -1.26403004e+04  7.24e-03 4.37e-04  9.99e-03     7s
  33  -1.45875002e+04 -1.27754816e+04  5.73e-03 3.31e-04  8.00e-03     7s
  34  -1.42686342e+04 -1.28285850e+04  4.26e-03 3.01e-04  6.35e-03     8s
  35  -1.41149752e+04 -1.29941705e+04  3.47e-03 1.88e-04  4.95e-03     8s
  36  -1.39835610e+04 -1.30963149e+04  2.84e-03 1.32e-04  3.92e-03     8s
  37  -1.38375600e+04 -1.31201658e+04  2.18e-03 1.19e-04  3.17e-03     8s
  38  -1.37443042e+04 -1.32163685e+04  1.74e-03 8.21e-05  2.33e-03     8s
  39  -1.36540248e+04 -1.32407275e+04  1.34e-03 6.65e-05  1.82e-03     8s
  40  -1.35741989e+04 -1.32682975e+04  9.84e-04 6.02e-05  1.35e-03     8s
  41  -1.35229176e+04 -1.32941676e+04  7.50e-04 4.09e-05  1.01e-03     8s
  42  -1.34565270e+04 -1.33166494e+04  4.51e-04 2.92e-05  6.18e-04     8s
  43  -1.34384982e+04 -1.33316656e+04  3.72e-04 2.60e-05  4.72e-04     8s
  44  -1.34040356e+04 -1.33374358e+04  2.22e-04 1.80e-05  2.94e-04     9s
  45  -1.33887973e+04 -1.33480036e+04  1.58e-04 1.84e-06  1.80e-04     9s
  46  -1.33765996e+04 -1.33486080e+04  1.07e-04 1.37e-06  1.24e-04     9s
  47  -1.33593362e+04 -1.33490564e+04  3.42e-05 9.20e-07  4.54e-05     9s
  48  -1.33558466e+04 -1.33500407e+04  2.04e-05 2.41e-07  2.57e-05     9s
  49  -1.33538098e+04 -1.33501482e+04  1.26e-05 1.59e-07  1.62e-05     9s
  50  -1.33523848e+04 -1.33503437e+04  7.17e-06 3.96e-08  9.02e-06     9s
  51  -1.33504993e+04 -1.33504124e+04  9.94e-07 1.69e-08  3.84e-07     9s
  52  -1.33504864e+04 -1.33504132e+04  8.42e-07 1.11e-08  3.23e-07     9s
  53  -1.33504405e+04 -1.33504147e+04  5.20e-07 2.21e-10  1.14e-07     9s
  54  -1.33504283e+04 -1.33504147e+04  2.72e-07 1.26e-07  5.98e-08     9s
  55  -1.33504218e+04 -1.33504147e+04  5.24e-07 1.40e-07  3.13e-08    10s
  56  -1.33504151e+04 -1.33504147e+04  5.69e-08 9.15e-08  1.44e-09    10s
  57  -1.33504147e+04 -1.33504147e+04  2.52e-07 2.01e-08  5.60e-11    10s

Barrier solved model in 57 iterations and 9.78 seconds (13.44 work units)
Optimal objective -1.33504147e+04


Root crossover log...

   99240 DPushes remaining with DInf 0.0000000e+00                10s
   50486 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    5009 PPushes remaining with PInf 9.1227143e-06                15s
    1914 PPushes remaining with PInf 3.4185778e-07                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.5973055e-01     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52460   -1.3350415e+04   0.000000e+00   5.597305e-01     15s
   52464   -1.3350415e+04   0.000000e+00   0.000000e+00     15s
   52464   -1.3350415e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 1.36s

Solved with barrier

Root relaxation: objective -1.335041e+04, 52464 iterations, 13.78 seconds (25.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13350.415    0  438 -201924.56 -13350.415  93.4%     -   17s
H    0     0                    -198347.0450 -13350.415  93.3%     -   17s
H    0     0                    -132237.2770 -13350.415  89.9%     -   17s
H    0     0                    -117115.6078 -13350.415  88.6%     -   17s
H    0     0                    -114421.0899 -13350.415  88.3%     -   17s
H    0     0                    -111971.1607 -13350.415  88.1%     -   17s
H    0     0                    -111963.7934 -13350.415  88.1%     -   18s
H    0     0                    -85714.21663 -13350.415  84.4%     -   18s
H    0     0                    -77152.52257 -13350.415  82.7%     -   18s
H    0     0                    -77030.86154 -13350.415  82.7%     -   18s
H    0     0                    -76989.71350 -13350.415  82.7%     -   18s
H    0     0                    -76910.49552 -13350.415  82.6%     -   18s
H    0     0                    -76879.09207 -13350.415  82.6%     -   18s
H    0     0                    -75930.11385 -13350.415  82.4%     -   21s
H    0     0                    -75874.48447 -13350.415  82.4%     -   21s
H    0     0                    -70392.59683 -13350.415  81.0%     -   21s
H    0     0                    -70348.08716 -13350.415  81.0%     -   21s
H    0     0                    -70328.27587 -13350.415  81.0%     -   21s
H    0     0                    -69195.85016 -17601.946  74.6%     -   68s
H    0     0                    -69154.91842 -17601.946  74.5%     -   68s
H    0     0                    -66884.13990 -17601.946  73.7%     -   68s
H    0     0                    -66845.58085 -17601.946  73.7%     -   68s
H    0     0                    -66818.44201 -17601.946  73.7%     -   68s
H    0     0                    -66770.49310 -17601.946  73.6%     -   68s
H    0     0                    -66649.08342 -17601.946  73.6%     -   68s
     0     0 -17959.139    0  572 -66649.083 -17959.139  73.1%     -   69s
     0     0 -18167.809    0  616 -66649.083 -18167.809  72.7%     -   83s
     0     0 -18168.278    0  607 -66649.083 -18168.278  72.7%     -   87s
     0     0 -18168.278    0  560 -66649.083 -18168.278  72.7%     -   94s
     0     0 -18168.278    0  562 -66649.083 -18168.278  72.7%     -   96s
     0     0 -18168.278    0  561 -66649.083 -18168.278  72.7%     -   98s
     0     0 -18168.278    0  615 -66649.083 -18168.278  72.7%     -  101s
     0     0 -18168.278    0  629 -66649.083 -18168.278  72.7%     -  107s
     0     0 -18168.278    0  628 -66649.083 -18168.278  72.7%     -  108s
     0     0 -18168.278    0  627 -66649.083 -18168.278  72.7%     -  109s
H    0     0                    -65894.91991 -20572.154  68.8%     -  165s
H    0     0                    -65794.42883 -20572.154  68.7%     -  165s
H    0     0                    -65769.13960 -20572.154  68.7%     -  165s
H    0     0                    -65725.41717 -20572.154  68.7%     -  165s
     0     0 -20572.154    0  561 -65725.417 -20572.154  68.7%     -  165s
H    0     0                    -57053.18902 -20572.227  63.9%     -  166s
H    0     0                    -57045.12251 -20572.227  63.9%     -  166s
     0     0 -20848.712    0  603 -57045.123 -20848.712  63.5%     -  193s
     0     0 -21142.085    0  587 -57045.123 -21142.085  62.9%     -  210s
     0     0 -21229.267    0  620 -57045.123 -21229.267  62.8%     -  225s
     0     0 -21232.099    0  622 -57045.123 -21232.099  62.8%     -  228s
     0     0 -21248.096    0  618 -57045.123 -21248.096  62.8%     -  231s
     0     0 -21262.554    0  616 -57045.123 -21262.554  62.7%     -  235s
     0     0 -21267.446    0  621 -57045.123 -21267.446  62.7%     -  239s
     0     0 -21269.771    0  621 -57045.123 -21269.771  62.7%     -  239s
     0     0 -21422.053    0  665 -57045.123 -21422.053  62.4%     -  252s
     0     0 -21434.385    0  659 -57045.123 -21434.385  62.4%     -  258s
H    0     0                    -54519.83312 -21436.122  60.7%     -  261s
H    0     0                    -54294.89684 -21436.122  60.5%     -  261s
H    0     0                    -54218.11732 -21436.122  60.5%     -  261s
     0     0 -21436.122    0  671 -54218.117 -21436.122  60.5%     -  261s
     0     0 -21451.865    0  673 -54218.117 -21451.865  60.4%     -  265s
     0     0 -21459.835    0  620 -54218.117 -21459.835  60.4%     -  268s
     0     0 -21567.370    0  618 -54218.117 -21567.370  60.2%     -  277s
     0     0 -21572.378    0  614 -54218.117 -21572.378  60.2%     -  280s
     0     0 -21573.373    0  618 -54218.117 -21573.373  60.2%     -  282s
     0     0 -21575.275    0  615 -54218.117 -21575.275  60.2%     -  283s
     0     0 -21577.192    0  626 -54218.117 -21577.192  60.2%     -  284s
     0     0 -21587.802    0  616 -54218.117 -21587.802  60.2%     -  288s
H    0     0                    -51647.83031 -21591.746  58.2%     -  291s
H    0     0                    -51594.77832 -21591.746  58.2%     -  291s
H    0     0                    -51414.41895 -21591.746  58.0%     -  291s
H    0     0                    -50447.21631 -21591.746  57.2%     -  291s
H    0     0                    -49784.92250 -21591.746  56.6%     -  291s
     0     0 -21591.746    0  618 -49784.923 -21591.746  56.6%     -  291s
H    0     0                    -49521.15366 -21593.678  56.4%     -  293s
H    0     0                    -49283.64310 -21593.678  56.2%     -  293s
H    0     0                    -49057.62058 -21593.678  56.0%     -  293s
     0     0 -21593.678    0  622 -49057.621 -21593.678  56.0%     -  293s
     0     0 -21594.076    0  619 -49057.621 -21594.076  56.0%     -  294s
     0     0 -22713.556    0  599 -49057.621 -22713.556  53.7%     -  352s
H    0     0                    -48838.29251 -22713.742  53.5%     -  353s
H    0     0                    -48821.68745 -22713.742  53.5%     -  353s
H    0     0                    -40106.19537 -22974.320  42.7%     -  379s
H    0     0                    -39781.12993 -22974.320  42.2%     -  379s
H    0     0                    -39036.94409 -22974.320  41.1%     -  379s
H    0     0                    -38891.26233 -22974.320  40.9%     -  379s
H    0     0                    -38817.23925 -22974.320  40.8%     -  379s
H    0     0                    -38799.58503 -22974.320  40.8%     -  379s
H    0     0                    -38793.45270 -22974.320  40.8%     -  379s
H    0     0                    -38713.57200 -22974.320  40.7%     -  379s
     0     0 -22974.320    0  694 -38713.572 -22974.320  40.7%     -  379s
     0     0 -23075.821    0  646 -38713.572 -23075.821  40.4%     -  390s
H    0     0                    -38521.22999 -23175.390  39.8%     -  400s
     0     0 -23175.390    0  640 -38521.230 -23175.390  39.8%     -  400s
     0     0 -23196.820    0  649 -38521.230 -23196.820  39.8%     -  407s
     0     0 -23211.154    0  654 -38521.230 -23211.154  39.7%     -  412s
     0     0 -23243.747    0  659 -38521.230 -23243.747  39.7%     -  415s
     0     0 -23250.733    0  654 -38521.230 -23250.733  39.6%     -  417s
     0     0 -23257.065    0  651 -38521.230 -23257.065  39.6%     -  419s
     0     0 -23259.100    0  650 -38521.230 -23259.100  39.6%     -  420s
     0     0 -23279.508    0  653 -38521.230 -23279.508  39.6%     -  424s
     0     0 -23281.946    0  655 -38521.230 -23281.946  39.6%     -  426s
     0     0 -23287.878    0  654 -38521.230 -23287.878  39.5%     -  428s
     0     0 -23288.448    0  658 -38521.230 -23288.448  39.5%     -  429s
H    0     0                    -38452.68135 -24201.416  37.1%     -  467s
H    0     0                    -38416.58918 -24201.416  37.0%     -  467s
H    0     0                    -37508.95601 -24201.416  35.5%     -  467s
H    0     0                    -37122.06536 -24201.416  34.8%     -  467s
H    0     0                    -36831.65026 -24201.416  34.3%     -  467s
H    0     0                    -36821.49004 -24201.416  34.3%     -  467s
H    0     0                    -36761.12724 -24201.416  34.2%     -  467s
H    0     0                    -36736.65248 -24201.416  34.1%     -  467s
H    0     0                    -36558.33143 -24201.416  33.8%     -  467s
     0     0 -24201.416    0  657 -36558.331 -24201.416  33.8%     -  467s
H    0     0                    -36321.43342 -24314.278  33.1%     -  477s
H    0     0                    -36266.91028 -24314.278  33.0%     -  477s
H    0     0                    -36082.67261 -24314.278  32.6%     -  477s
H    0     0                    -35681.15719 -24314.278  31.9%     -  477s
H    0     0                    -35551.14713 -24314.278  31.6%     -  477s
     0     0 -24314.278    0  670 -35551.147 -24314.278  31.6%     -  477s
H    0     0                    -35540.94613 -24451.486  31.2%     -  489s
H    0     0                    -35539.44990 -24451.486  31.2%     -  489s
H    0     0                    -35525.94926 -24451.486  31.2%     -  489s
     0     0 -24451.486    0  731 -35525.949 -24451.486  31.2%     -  489s
     0     0 -24526.107    0  700 -35525.949 -24526.107  31.0%     -  498s
     0     0 -24549.437    0  760 -35525.949 -24549.437  30.9%     -  502s
     0     0 -24553.171    0  769 -35525.949 -24553.171  30.9%     -  504s
     0     0 -24557.227    0  762 -35525.949 -24557.227  30.9%     -  507s
     0     0 -24560.308    0  724 -35525.949 -24560.308  30.9%     -  508s
     0     0 -24566.299    0  726 -35525.949 -24566.299  30.8%     -  512s
     0     0 -24567.383    0  729 -35525.949 -24567.383  30.8%     -  513s
H    0     0                    -35504.51807 -24777.516  30.2%     -  532s
     0     0 -24777.516    0  750 -35504.518 -24777.516  30.2%     -  532s
     0     0 -24832.922    0  750 -35504.518 -24832.922  30.1%     -  546s
     0     0 -24865.927    0  776 -35504.518 -24865.927  30.0%     -  552s
     0     0 -24872.233    0  782 -35504.518 -24872.233  29.9%     -  555s
     0     0 -24876.573    0  770 -35504.518 -24876.573  29.9%     -  558s
     0     0 -24877.280    0  782 -35504.518 -24877.280  29.9%     -  559s
     0     0 -24982.916    0  707 -35504.518 -24982.916  29.6%     -  578s
     0     0 -25018.061    0  743 -35504.518 -25018.061  29.5%     -  586s
     0     0 -25038.006    0  757 -35504.518 -25038.006  29.5%     -  592s
     0     0 -25045.280    0  761 -35504.518 -25045.280  29.5%     -  594s
     0     0 -25046.467    0  762 -35504.518 -25046.467  29.5%     -  596s
     0     0 -25114.861    0  788 -35504.518 -25114.861  29.3%     -  609s
     0     0 -25147.486    0  801 -35504.518 -25147.486  29.2%     -  616s
     0     0 -25152.604    0  817 -35504.518 -25152.604  29.2%     -  620s
     0     0 -25154.178    0  816 -35504.518 -25154.178  29.2%     -  621s
H    0     0                    -35498.69817 -25215.297  29.0%     -  636s
     0     0 -25215.297    0  798 -35498.698 -25215.297  29.0%     -  636s
     0     0 -25238.360    0  796 -35498.698 -25238.360  28.9%     -  643s
     0     0 -25244.582    0  806 -35498.698 -25244.582  28.9%     -  646s
     0     0 -25249.804    0  745 -35498.698 -25249.804  28.9%     -  649s
     0     0 -25250.905    0  750 -35498.698 -25250.905  28.9%     -  651s
     0     0 -25270.744    0  747 -35498.698 -25270.744  28.8%     -  660s
     0     0 -25275.891    0  764 -35498.698 -25275.891  28.8%     -  664s
     0     0 -25277.243    0  764 -35498.698 -25277.243  28.8%     -  666s
     0     0 -25299.112    0  742 -35498.698 -25299.112  28.7%     -  675s
H    0     0                    -32637.57300 -25308.480  22.5%     -  680s
     0     0 -25308.480    0  756 -32637.573 -25308.480  22.5%     -  680s
H    0     0                    -32623.79730 -25310.675  22.4%     -  683s
H    0     0                    -32222.48683 -25310.675  21.5%     -  683s
H    0     0                    -32200.99268 -25310.675  21.4%     -  683s
H    0     0                    -32178.89468 -25310.675  21.3%     -  683s
H    0     0                    -32175.06897 -25310.675  21.3%     -  683s
     0     0 -25310.675    0  751 -32175.069 -25310.675  21.3%     -  683s
     0     0 -25314.019    0  761 -32175.069 -25314.019  21.3%     -  685s
     0     0 -25314.804    0  755 -32175.069 -25314.804  21.3%     -  687s
H    0     0                    -31891.04907 -25354.220  20.5%     -  698s
H    0     0                    -31886.39193 -25354.220  20.5%     -  698s
     0     0 -25354.220    0  766 -31886.392 -25354.220  20.5%     -  698s
     0     0 -25364.873    0  809 -31886.392 -25364.873  20.5%     -  702s
     0     0 -25367.543    0  816 -31886.392 -25367.543  20.4%     -  705s
     0     0 -25368.063    0  829 -31886.392 -25368.063  20.4%     -  706s
     0     0 -25382.979    0  752 -31886.392 -25382.979  20.4%     -  714s
     0     0 -25385.567    0  743 -31886.392 -25385.567  20.4%     -  717s
     0     0 -25387.017    0  734 -31886.392 -25387.017  20.4%     -  720s
     0     0 -25393.339    0  755 -31886.392 -25393.339  20.4%     -  726s
     0     0 -25397.240    0  753 -31886.392 -25397.240  20.4%     -  730s
     0     0 -25398.023    0  827 -31886.392 -25398.023  20.3%     -  732s
     0     0 -25403.368    0  766 -31886.392 -25403.368  20.3%     -  737s
     0     0 -25404.034    0  766 -31886.392 -25404.034  20.3%     -  744s
H    0     0                    -31549.04013 -25404.034  19.5%     -  781s
H    0     0                    -31544.38299 -25404.034  19.5%     -  781s
H    0     0                    -31522.59630 -25404.034  19.4%     -  874s
H    0     0                    -31462.13282 -25404.034  19.3%     -  874s
H    0     0                    -31453.72701 -25404.034  19.2%     -  874s
     0     2 -25404.034    0  766 -31453.727 -25404.034  19.2%     -  876s
     1     3 -25730.201    1  735 -31453.727 -25404.034  19.2% 16156  896s
     2     4 -25430.955    1  759 -31453.727 -25430.955  19.1%  9639  907s
     3     7 -26054.399    2  555 -31453.727 -25431.423  19.1%  8174  920s
     6    13 -26314.221    3  635 -31453.727 -25431.423  19.1%  7610  936s
    12    25 -26379.004    4  644 -31453.727 -25548.736  18.8%  8264  968s
    24    37 -26199.233    5  558 -31453.727 -25579.103  18.7% 12977 1007s
    36    68 -26464.670    6  546 -31453.727 -25618.052  18.6% 11771 1208s
    67   149 -26521.070    7  524 -31453.727 -25618.052  18.6% 19914 1251s
   148   241 -26553.999   11  545 -31453.727 -25618.052  18.6% 12922 1282s
H  215   241                    -31398.10522 -25618.052  18.4% 10458 1282s
   244   293 -26638.307   14  611 -31398.105 -25618.052  18.4% 10222 1307s
   307   320 -26838.424   15  658 -31398.105 -25618.052  18.4%  9357 1328s
H  313   320                    -31376.81815 -25618.052  18.4%  9347 1328s
   334   370 -26881.939   16  640 -31376.818 -25618.052  18.4%  9416 1353s
   394   400 -27073.138   17  640 -31376.818 -25618.052  18.4%  8977 1371s
   426   432 -28798.081   19  379 -31376.818 -25618.052  18.4%  8886 1394s
   474   450 infeasible   21      -31376.818 -25618.052  18.4%  8850 1417s
   528   468 -27243.444   12  529 -31376.818 -25618.052  18.4%  9026 1440s
   554   490 -27651.026   13  509 -31376.818 -25618.052  18.4%  9138 1461s
   589   511 -28175.393   14  576 -31376.818 -25618.052  18.4%  9472 1484s
   634   521 -28184.772   15  568 -31376.818 -26069.419  16.9%  9578 1506s
   668   550 -28809.236   17  462 -31376.818 -26069.419  16.9%  9616 1529s
   719   591 -29153.790   19  444 -31376.818 -26069.419  16.9%  9659 1548s
   768   638 -29299.742   22  414 -31376.818 -26069.419  16.9%  9582 1570s
   846   690 -29668.487   26  393 -31376.818 -26069.419  16.9%  9320 1591s
   916   735 -30117.706   30  402 -31376.818 -26069.419  16.9%  9163 1610s
  1001   771 -30601.101   35  387 -31376.818 -26069.419  16.9%  8891 1636s
  1069   818 -31354.359   36  341 -31376.818 -26069.419  16.9%  8701 1657s
  1162   899 -31364.537   37  282 -31376.818 -26142.818  16.7%  8578 1682s
  1301   981 -29363.800   16  314 -31376.818 -26142.818  16.7%  8099 1705s
  1439  1057 -29457.252   17  385 -31376.818 -26142.818  16.7%  7747 1734s
  1568  1153 -29636.060   19  232 -31376.818 -26142.818  16.7%  7510 1758s
  1722  1208 -30113.076   23  201 -31376.818 -26181.239  16.6%  7255 1784s
  1835  1222 -30110.489   25  195 -31376.818 -26181.239  16.6%  7118 1813s
  1936  1244 -30409.661   30  220 -31376.818 -26253.165  16.3%  7116 1838s
  1999  1256 infeasible   29      -31376.818 -26253.165  16.3%  7247 1867s
  2095  1277 -27609.992    8  436 -31376.818 -26253.165  16.3%  7327 1904s
  2166  1314 -27845.964    9  492 -31376.818 -26259.309  16.3%  7346 1961s
  2245  1344 -28985.524   11  362 -31376.818 -26259.309  16.3%  7424 1995s
  2371  1352 -30695.681   13  261 -31376.818 -26259.309  16.3%  7420 2033s
  2474  1381 -30121.757   13  118 -31376.818 -26427.561  15.8%  7448 2071s
  2547  1403 -30082.727   15  507 -31376.818 -26427.561  15.8%  7598 2111s
  2628  1413 -30901.019   16  376 -31376.818 -26529.626  15.4%  7707 2147s
  2728  1435 -29625.249   12  136 -31376.818 -26529.626  15.4%  7792 2189s
  2804  1443 -31305.722   15   58 -31376.818 -26529.626  15.4%  7968 2229s
  2878  1448 -29380.012    9  153 -31376.818 -26529.626  15.4%  8030 2273s
  2959  1473 -28176.540    8  326 -31376.818 -26529.626  15.4%  8159 2320s
  3068  1494 -29360.179   10  273 -31376.818 -26529.626  15.4%  8274 2373s
  3195  1534 -29274.213    9  272 -31376.818 -26529.626  15.4%  8362 2423s
  3313  1550 -30154.496   11  227 -31376.818 -26529.626  15.4%  8507 2475s
  3439  1578 -30970.904   12  208 -31376.818 -26529.626  15.4%  8614 2526s
  3547  1594     cutoff   10      -31376.818 -26807.588  14.6%  8688 2578s
  3673  1605     cutoff   10      -31376.818 -26839.009  14.5%  8791 2637s
  3804  1628 -28107.441   11  462 -31376.818 -26867.824  14.4%  8861 2698s
  3931  1645 -29461.734   13  262 -31376.818 -26867.824  14.4%  8956 2760s
  4090  1671 infeasible   15      -31376.818 -26946.365  14.1%  9061 2824s
  4242  1687 -28741.507   12  389 -31376.818 -27013.532  13.9%  9158 2902s
  4290  1716 -29128.751   13  388 -31376.818 -27013.532  13.9%  9237 2974s
  4331  1732 -29269.864   14  462 -31376.818 -27013.532  13.9%  9303 3033s
  4393  1745 -30219.038   13  105 -31376.818 -27013.532  13.9%  9382 3092s
  4466  1755 infeasible   14      -31376.818 -27013.532  13.9%  9413 3158s
  4584  1784 infeasible   15      -31376.818 -27023.450  13.9%  9442 3221s
  4701  1836 -29745.702   16  365 -31376.818 -27058.945  13.8%  9422 3292s
  4882  1874 -31127.250   18  237 -31376.818 -27058.945  13.8%  9373 3365s
  5079  1908 -29755.059   17  449 -31376.818 -27107.950  13.6%  9393 3452s
H 5147  1908                    -31376.51068 -27107.950  13.6%  9392 3452s
  5312  1969 -27650.117   13  582 -31376.511 -27107.950  13.6%  9427 3546s
  5535  2007 -30038.578   16  316 -31376.511 -27182.655  13.4%  9525 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 155
  MIR: 3404
  Flow cover: 5272
  Zero half: 14
  RLT: 144
  Relax-and-lift: 723

Explored 5721 nodes (54640394 simplex iterations) in 3600.06 seconds (9300.97 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31376.5 -31376.8 -31398.1 ... -31891

Time limit reached
Best objective -3.137651068138e+04, best bound -2.718265458556e+04, gap 13.3662%
  WARNING: Time limit reached. Using best solution found (gap: 13.37%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -31376.51, θ = 93338.24
  Upper Bound (UB) = -31376.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93338.24
  [DEBUG]   ✓ Scenario 0: θ = 93338.24 ≤ Q = 93338.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93338.24 ≤ Q = 93338.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93338.24 ≤ Q = 93338.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93338.24 ≤ Q = 93338.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93338.24 ≤ Q = 93338.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93338.24 ≤ Q = 93338.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93338.24 ≤ Q = 93338.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93338.24 ≤ Q = 93338.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93338.24 ≤ Q = 93910.23 (slack: 572.00)
  [DEBUG]   ✓ Scenario 9: θ = 93338.24 ≤ Q = 93338.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93338.24 ≤ Q = 93338.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93338.24 ≤ Q = 93338.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93338.24 ≤ Q = 93338.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93338.24 ≤ Q = 93338.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93338.24 ≤ Q = 93338.24 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4744b22b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb8bb4dd5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.170851e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5443271.0497
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.241510e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124151.01    0  124 5443271.05 -124151.01   102%     -    0s
H    0     0                    -90255.18466 -124151.01  37.6%     -    0s
H    0     0                    -90813.86479 -124151.01  36.7%     -    0s
     0     0 -97266.303    0   69 -90813.865 -97266.303  7.11%     -    0s
H    0     0                    -94201.78001 -97260.911  3.25%     -    0s
H    0     0                    -94489.85516 -97260.911  2.93%     -    0s
H    0     0                    -95302.62753 -97260.911  2.05%     -    0s
H    0     0                    -95590.70269 -97260.911  1.75%     -    0s
     0     0 -97059.065    0   68 -95590.703 -97059.065  1.54%     -    0s
     0     0 -96917.491    0   70 -95590.703 -96917.491  1.39%     -    0s
     0     0 -96536.850    0   58 -95590.703 -96536.850  0.99%     -    0s
     0     0 -96476.537    0   53 -95590.703 -96476.537  0.93%     -    0s
     0     0 -96467.959    0   56 -95590.703 -96467.959  0.92%     -    0s
     0     0 -96246.304    0   53 -95590.703 -96246.304  0.69%     -    0s
     0     0 -96217.939    0   45 -95590.703 -96217.939  0.66%     -    0s
     0     0 -96217.756    0   46 -95590.703 -96217.756  0.66%     -    0s
     0     0 -96136.594    0   45 -95590.703 -96136.594  0.57%     -    0s
     0     0 -96114.861    0   45 -95590.703 -96114.861  0.55%     -    0s
     0     0 -96112.738    0   45 -95590.703 -96112.738  0.55%     -    0s
     0     0 -96071.964    0   45 -95590.703 -96071.964  0.50%     -    0s
     0     0 -96034.964    0   45 -95590.703 -96034.964  0.46%     -    0s
     0     0 -96034.964    0   82 -95590.703 -96034.964  0.46%     -    0s
     0     0 -96034.964    0   54 -95590.703 -96034.964  0.46%     -    0s
     0     0 -96034.964    0   44 -95590.703 -96034.964  0.46%     -    0s
     0     0 -96034.964    0   45 -95590.703 -96034.964  0.46%     -    0s
     0     0 -96034.964    0   45 -95590.703 -96034.964  0.46%     -    0s
     0     0 -96007.208    0   40 -95590.703 -96007.208  0.44%     -    0s
     0     0 -95981.490    0   40 -95590.703 -95981.490  0.41%     -    0s
     0     0 -95981.490    0   40 -95590.703 -95981.490  0.41%     -    0s
     0     0 -95968.149    0   40 -95590.703 -95968.149  0.39%     -    0s
     0     2 -95968.149    0   40 -95590.703 -95968.149  0.39%     -    0s
*   35    20               6    -95598.31781 -95842.314  0.26%   6.5    0s
*   57    16               7    -95641.28164 -95828.221  0.20%   5.4    0s
*   61    16               7    -95648.48879 -95828.221  0.19%   5.3    0s
*   65    16               7    -95662.31088 -95828.221  0.17%   5.0    0s

Cutting planes:
  Gomory: 17
  Implied bound: 18
  MIR: 83
  Flow cover: 11
  RLT: 6
  BQP: 1

Explored 122 nodes (1721 simplex iterations) in 0.14 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -95662.3 -95648.5 -95641.3 ... 1.17085e+13
No other solutions better than -95662.3

Optimal solution found (tolerance 1.00e-06)
Best objective -9.566231088319e+04, best bound -9.566231088319e+04, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 91175.09
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95662.31
  [DEBUG]   S×d_nominal = 186837.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186837.40 + -95662.31 = 91175.09
  [DEBUG]   Current θ from Master = 93338.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2163.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33539.66
  Lower Bound (LB) = -33116.71
  Gap (UB-LB) = 1740.1963, Absolute Gap = 1740.1963, Relative Gap = 0.055462
  Not converged yet (gap = 1740.20 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0xfb989e10
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 2.42s
Presolved: 132903 rows, 56180 columns, 818173 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.09s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 6.534e+06
 Factor NZ  : 1.436e+07 (roughly 200 MB of memory)
 Factor Ops : 3.124e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37865707e+07  2.31267823e+08  7.15e+04 1.66e+01  5.85e+04     5s
   1  -1.05485601e+07  1.92728499e+08  4.93e+04 4.99e+01  3.99e+04     5s
   2  -4.43031609e+06  1.46821956e+08  1.95e+04 1.32e+01  1.64e+04     5s
   3  -7.39337902e+05  9.37359632e+07  1.25e+03 1.27e+00  1.36e+03     5s
   4  -5.25166763e+05  4.06609869e+07  3.91e+02 2.95e-01  4.46e+02     5s
   5  -4.18291029e+05  2.90388680e+07  1.51e+02 1.90e-01  2.21e+02     5s
   6  -3.27316926e+05  2.11200142e+07  5.84e+01 1.27e-01  1.23e+02     5s
   7  -2.11302554e+05  1.54568480e+07  7.64e+00 8.80e-02  6.83e+01     5s
   8  -1.63031680e+05  6.38426056e+06  3.59e+00 3.41e-02  2.78e+01     5s
   9  -1.28033852e+05  3.74426556e+06  2.04e+00 1.96e-02  1.62e+01     5s
  10  -1.03442853e+05  1.66945661e+06  1.07e+00 8.58e-03  7.38e+00     5s
  11  -8.91887896e+04  5.33826125e+05  5.44e-01 3.00e-03  2.58e+00     6s
  12  -5.84451111e+04  2.31922746e+05  1.91e-01 1.61e-03  1.20e+00     6s
  13  -4.63487836e+04  1.38518533e+05  1.20e-01 1.37e-03  7.63e-01     6s
  14  -4.21912116e+04  1.09455386e+05  9.91e-02 1.25e-03  6.26e-01     6s
  15  -3.95681770e+04  8.09876433e+04  8.66e-02 7.77e-04  4.97e-01     6s
  16  -3.53699520e+04  4.66631886e+04  6.97e-02 2.03e-03  3.39e-01     6s
  17  -3.30122141e+04  2.85646984e+04  6.09e-02 3.25e-03  2.54e-01     6s
  18  -2.90221096e+04  1.38751512e+04  4.67e-02 1.86e-03  1.77e-01     6s
  19  -2.69764232e+04  6.61322305e+03  3.98e-02 3.83e-03  1.39e-01     6s
  20  -2.48355492e+04  1.39531516e+03  3.26e-02 2.86e-03  1.08e-01     6s
  21  -2.27532699e+04 -1.59182024e+03  2.62e-02 1.99e-03  8.74e-02     6s
  22  -2.07629673e+04 -4.79461677e+03  2.00e-02 1.53e-03  6.59e-02     6s
  23  -1.94994023e+04 -6.57545363e+03  1.63e-02 1.21e-03  5.34e-02     7s
  24  -1.83780665e+04 -8.76617559e+03  1.32e-02 8.68e-04  3.97e-02     7s
  25  -1.82492542e+04 -9.22612496e+03  1.28e-02 7.83e-04  3.73e-02     7s
  26  -1.79862455e+04 -9.82538827e+03  1.21e-02 6.64e-04  3.37e-02     7s
  27  -1.65714719e+04 -1.03723570e+04  8.44e-03 5.52e-04  2.56e-02     7s
  28  -1.63794743e+04 -1.09675793e+04  7.87e-03 4.18e-04  2.24e-02     7s
  29  -1.56932602e+04 -1.17408691e+04  6.08e-03 2.69e-04  1.63e-02     7s
  30  -1.53782688e+04 -1.19566738e+04  5.28e-03 2.34e-04  1.41e-02     7s
  31  -1.53092877e+04 -1.22410997e+04  5.10e-03 1.84e-04  1.27e-02     7s
  32  -1.48412054e+04 -1.23761781e+04  3.92e-03 1.58e-04  1.02e-02     8s
  33  -1.44047509e+04 -1.25619414e+04  2.79e-03 1.22e-04  7.61e-03     8s
  34  -1.42128401e+04 -1.27332040e+04  2.31e-03 9.11e-05  6.11e-03     8s
  35  -1.40562078e+04 -1.28122703e+04  1.93e-03 7.78e-05  5.14e-03     8s
  36  -1.39181704e+04 -1.28854712e+04  1.59e-03 6.48e-05  4.27e-03     8s
  37  -1.37918506e+04 -1.29698238e+04  1.25e-03 5.00e-05  3.40e-03     8s
  38  -1.37483640e+04 -1.30034855e+04  1.15e-03 4.45e-05  3.08e-03     8s
  39  -1.37144152e+04 -1.30205829e+04  1.07e-03 4.38e-05  2.87e-03     8s
  40  -1.35559819e+04 -1.30918063e+04  6.85e-04 3.07e-05  1.92e-03     8s
  41  -1.35389652e+04 -1.31656324e+04  6.45e-04 1.78e-05  1.54e-03     8s
  42  -1.34178247e+04 -1.31889457e+04  3.55e-04 2.33e-05  9.46e-04     9s
  43  -1.33789924e+04 -1.31932047e+04  2.66e-04 2.20e-05  7.67e-04     9s
  44  -1.33257792e+04 -1.32340693e+04  1.40e-04 9.16e-06  3.79e-04     9s
  45  -1.32929474e+04 -1.32538827e+04  6.37e-05 2.67e-06  1.61e-04     9s
  46  -1.32732096e+04 -1.32589687e+04  2.16e-05 1.10e-06  5.88e-05     9s
  47  -1.32678033e+04 -1.32611662e+04  1.06e-05 4.01e-07  2.74e-05     9s
  48  -1.32632960e+04 -1.32623401e+04  1.51e-06 4.76e-08  3.95e-06     9s
  49  -1.32625466e+04 -1.32625112e+04  9.24e-08 5.50e-08  1.46e-07     9s
  50  -1.32625277e+04 -1.32625275e+04  1.13e-08 8.67e-11  8.00e-10     9s
  51  -1.32625276e+04 -1.32625275e+04  1.90e-07 7.82e-09  4.17e-10     9s

Barrier solved model in 51 iterations and 9.39 seconds (14.06 work units)
Optimal objective -1.32625276e+04


Root crossover log...

  105115 DPushes remaining with DInf 0.0000000e+00                 9s
   49065 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   18249 PPushes remaining with PInf 9.6026012e-05                14s
    4166 PPushes remaining with PInf 8.5076933e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9638328e+04     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70650   -1.3262527e+04   0.000000e+00   3.963833e+04     16s
   70853   -1.3262527e+04   0.000000e+00   0.000000e+00     16s
   70853   -1.3262527e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.51s

Solved with barrier

Root relaxation: objective -1.326253e+04, 70853 iterations, 13.41 seconds (27.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13262.527    0  439 -201924.56 -13262.527  93.4%     -   17s
H    0     0                    -156461.0840 -13262.527  91.5%     -   17s
H    0     0                    -155664.4549 -13262.527  91.5%     -   17s
H    0     0                    -121214.4444 -13262.527  89.1%     -   17s
H    0     0                    -121118.7462 -13262.527  89.0%     -   18s
H    0     0                    -121007.7167 -13262.527  89.0%     -   18s
H    0     0                    -103937.6582 -13262.527  87.2%     -   18s
H    0     0                    -71167.10226 -13262.527  81.4%     -   18s
H    0     0                    -64017.33713 -13262.527  79.3%     -   18s
H    0     0                    -63800.26356 -13262.527  79.2%     -   18s
H    0     0                    -63727.14833 -13262.527  79.2%     -   18s
     0     0 -17627.851    0  616 -63727.148 -17627.851  72.3%     -   64s
H    0     0                    -61281.61921 -17629.006  71.2%     -   65s
H    0     0                    -56063.52707 -17629.006  68.6%     -   65s
H    0     0                    -55837.08615 -17629.006  68.4%     -   65s
H    0     0                    -55497.03559 -17629.006  68.2%     -   65s
H    0     0                    -55414.38658 -17629.006  68.2%     -   65s
     0     0 -17952.040    0  607 -55414.387 -17952.040  67.6%     -   81s
     0     0 -17972.881    0  592 -55414.387 -17972.881  67.6%     -   85s
     0     0 -17983.753    0  603 -55414.387 -17983.753  67.5%     -   86s
     0     0 -17996.189    0  486 -55414.387 -17996.189  67.5%     -   90s
     0     0 -18044.051    0  485 -55414.387 -18044.051  67.4%     -   94s
     0     0 -18048.085    0  485 -55414.387 -18048.085  67.4%     -   94s
     0     0 -18148.786    0  616 -55414.387 -18148.786  67.2%     -  105s
     0     0 -18160.346    0  631 -55414.387 -18160.346  67.2%     -  107s
     0     0 -18160.535    0  631 -55414.387 -18160.535  67.2%     -  108s
     0     0 -20396.058    0  517 -55414.387 -20396.058  63.2%     -  154s
H    0     0                    -55399.23059 -20396.148  63.2%     -  154s
H    0     0                    -55370.58054 -20396.148  63.2%     -  154s
     0     0 -20599.805    0  531 -55370.581 -20599.805  62.8%     -  170s
     0     0 -20679.998    0  604 -55370.581 -20679.998  62.7%     -  182s
     0     0 -20705.957    0  604 -55370.581 -20705.957  62.6%     -  188s
     0     0 -20819.647    0  687 -55370.581 -20819.647  62.4%     -  201s
     0     0 -20831.715    0  691 -55370.581 -20831.715  62.4%     -  206s
     0     0 -20832.651    0  695 -55370.581 -20832.651  62.4%     -  208s
     0     0 -22308.557    0  487 -55370.581 -22308.557  59.7%     -  254s
H    0     0                    -51084.00517 -22308.606  56.3%     -  254s
H    0     0                    -51001.43404 -22308.606  56.3%     -  254s
H    0     0                    -50963.70259 -22308.606  56.2%     -  254s
H    0     0                    -50934.34706 -22308.606  56.2%     -  254s
     0     0 -22662.790    0  696 -50934.347 -22662.790  55.5%     -  275s
     0     0 -22739.292    0  665 -50934.347 -22739.292  55.4%     -  285s
     0     0 -22911.928    0  687 -50934.347 -22911.928  55.0%     -  298s
     0     0 -22935.819    0  591 -50934.347 -22935.819  55.0%     -  303s
     0     0 -22945.610    0  696 -50934.347 -22945.610  55.0%     -  309s
     0     0 -22950.629    0  688 -50934.347 -22950.629  54.9%     -  313s
     0     0 -22955.795    0  690 -50934.347 -22955.795  54.9%     -  317s
     0     0 -22983.687    0  613 -50934.347 -22983.687  54.9%     -  326s
     0     0 -23056.316    0  660 -50934.347 -23056.316  54.7%     -  337s
     0     0 -23101.232    0  635 -50934.347 -23101.232  54.6%     -  344s
     0     0 -23142.255    0  621 -50934.347 -23142.255  54.6%     -  350s
     0     0 -23177.816    0  634 -50934.347 -23177.816  54.5%     -  358s
     0     0 -23179.496    0  629 -50934.347 -23179.496  54.5%     -  359s
     0     0 -23181.798    0  628 -50934.347 -23181.798  54.5%     -  362s
     0     0 -23194.058    0  628 -50934.347 -23194.058  54.5%     -  364s
     0     0 -23204.777    0  642 -50934.347 -23204.777  54.4%     -  366s
     0     0 -23210.683    0  629 -50934.347 -23210.683  54.4%     -  369s
     0     0 -23215.541    0  635 -50934.347 -23215.541  54.4%     -  371s
     0     0 -23217.609    0  643 -50934.347 -23217.609  54.4%     -  373s
     0     0 -23223.004    0  648 -50934.347 -23223.004  54.4%     -  375s
     0     0 -23225.803    0  651 -50934.347 -23225.803  54.4%     -  377s
     0     0 -23236.049    0  695 -50934.347 -23236.049  54.4%     -  381s
     0     0 -23237.945    0  653 -50934.347 -23237.945  54.4%     -  383s
     0     0 -23238.067    0  657 -50934.347 -23238.067  54.4%     -  384s
     0     0 -23838.349    0  742 -50934.347 -23838.349  53.2%     -  421s
H    0     0                    -49345.53414 -23838.426  51.7%     -  422s
     0     0 -24119.274    0  740 -49345.534 -24119.274  51.1%     -  444s
     0     0 -24207.858    0  699 -49345.534 -24207.858  50.9%     -  457s
     0     0 -24232.711    0  712 -49345.534 -24232.711  50.9%     -  462s
     0     0 -24247.141    0  644 -49345.534 -24247.141  50.9%     -  466s
     0     0 -24254.895    0  631 -49345.534 -24254.895  50.8%     -  468s
     0     0 -24256.767    0  632 -49345.534 -24256.767  50.8%     -  470s
     0     0 -24268.973    0  694 -49345.534 -24268.973  50.8%     -  473s
     0     0 -24275.335    0  705 -49345.534 -24275.335  50.8%     -  475s
     0     0 -24311.852    0  617 -49345.534 -24311.852  50.7%     -  481s
     0     0 -24322.147    0  636 -49345.534 -24322.147  50.7%     -  484s
     0     0 -24326.497    0  635 -49345.534 -24326.497  50.7%     -  486s
     0     0 -24332.043    0  631 -49345.534 -24332.043  50.7%     -  488s
     0     0 -24333.510    0  637 -49345.534 -24333.510  50.7%     -  489s
     0     0 -24548.862    0  759 -49345.534 -24548.862  50.3%     -  515s
H    0     0                    -33310.39484 -24548.932  26.3%     -  515s
H    0     0                    -31807.87002 -24548.932  22.8%     -  515s
     0     0 -24685.448    0  757 -31807.870 -24685.448  22.4%     -  534s
     0     0 -24696.875    0  788 -31807.870 -24696.875  22.4%     -  538s
     0     0 -24703.572    0  782 -31807.870 -24703.572  22.3%     -  543s
     0     0 -24703.766    0  788 -31807.870 -24703.766  22.3%     -  545s
     0     0 -24854.359    0  707 -31807.870 -24854.359  21.9%     -  569s
H    0     0                    -31644.80510 -24854.687  21.5%     -  571s
H    0     0                    -31622.00877 -24854.687  21.4%     -  577s
H    0     0                    -31615.32203 -24854.687  21.4%     -  577s
H    0     0                    -31615.32019 -24854.687  21.4%     -  578s
     0     0 -24872.039    0  694 -31615.320 -24872.039  21.3%     -  584s
     0     0 -24883.318    0  717 -31615.320 -24883.318  21.3%     -  590s
     0     0 -24887.087    0  716 -31615.320 -24887.087  21.3%     -  592s
     0     0 -24889.571    0  729 -31615.320 -24889.571  21.3%     -  594s
     0     0 -24890.862    0  721 -31615.320 -24890.862  21.3%     -  595s
     0     0 -24972.945    0  711 -31615.320 -24972.945  21.0%     -  614s
H    0     0                    -31564.20748 -24973.631  20.9%     -  615s
H    0     0                    -31475.02493 -24973.631  20.7%     -  615s
     0     0 -25002.084    0  791 -31475.025 -25002.084  20.6%     -  623s
     0     0 -25021.956    0  786 -31475.025 -25021.956  20.5%     -  630s
     0     0 -25034.500    0  789 -31475.025 -25034.500  20.5%     -  635s
     0     0 -25043.360    0  782 -31475.025 -25043.360  20.4%     -  640s
     0     0 -25045.132    0  795 -31475.025 -25045.132  20.4%     -  642s
     0     0 -25051.586    0  791 -31475.025 -25051.586  20.4%     -  646s
     0     0 -25055.325    0  795 -31475.025 -25055.325  20.4%     -  648s
     0     0 -25056.886    0  805 -31475.025 -25056.886  20.4%     -  650s
     0     0 -25095.360    0  785 -31475.025 -25095.360  20.3%     -  663s
H    0     0                    -31457.42701 -25095.390  20.2%     -  664s
H    0     0                    -31442.27285 -25095.390  20.2%     -  670s
     0     0 -25109.299    0  805 -31442.273 -25109.299  20.1%     -  676s
     0     0 -25121.598    0  746 -31442.273 -25121.598  20.1%     -  683s
     0     0 -25124.639    0  759 -31442.273 -25124.639  20.1%     -  686s
     0     0 -25125.667    0  755 -31442.273 -25125.667  20.1%     -  688s
     0     0 -25125.667    0  755 -31442.273 -25125.667  20.1%     -  688s
     0     0 -25141.816    0  760 -31442.273 -25141.816  20.0%     -  699s
     0     0 -25150.263    0  759 -31442.273 -25150.263  20.0%     -  705s
     0     0 -25153.329    0  763 -31442.273 -25153.329  20.0%     -  709s
     0     0 -25156.355    0  758 -31442.273 -25156.355  20.0%     -  711s
     0     0 -25157.843    0  749 -31442.273 -25157.843  20.0%     -  714s
     0     0 -25166.576    0  743 -31442.273 -25166.576  20.0%     -  721s
     0     0 -25172.812    0  742 -31442.273 -25172.812  19.9%     -  726s
     0     0 -25174.549    0  736 -31442.273 -25174.549  19.9%     -  728s
     0     0 -25187.672    0  744 -31442.273 -25187.672  19.9%     -  738s
     0     0 -25190.631    0  758 -31442.273 -25190.631  19.9%     -  742s
     0     0 -25193.860    0  760 -31442.273 -25193.860  19.9%     -  743s
     0     0 -25194.142    0  764 -31442.273 -25194.142  19.9%     -  744s
     0     0 -25199.720    0  749 -31442.273 -25199.720  19.9%     -  751s
H    0     0                    -31437.97651 -25201.719  19.8%     -  766s
H    0     0                    -31419.37690 -25201.719  19.8%     -  766s
H    0     0                    -31415.08055 -25201.719  19.8%     -  766s
     0     0 -25201.719    0  751 -31415.081 -25201.719  19.8%     -  770s
     0     0 -25213.708    0  744 -31415.081 -25213.708  19.7%     -  779s
     0     0 -25214.355    0  744 -31415.081 -25214.355  19.7%     -  786s
     0     2 -25214.355    0  744 -31415.081 -25214.355  19.7%     -  926s
     1     4 -25245.480    1  739 -31415.081 -25214.355  19.7%  2998  953s
     3     7 -25286.174    2  739 -31415.081 -25245.923  19.6% 10124  985s
     6    12 -25443.362    3  730 -31415.081 -25286.301  19.5% 12734 1002s
    11    21 -25526.086    4  714 -31415.081 -25286.301  19.5% 12066 1025s
    22    30 -26118.104    4  630 -31415.081 -25429.950  19.1% 16955 1089s
H   31    56                    -31413.49739 -25429.950  19.0% 18201 1260s
    57    83 -26694.671    6  477 -31413.497 -25429.950  19.0% 24711 1314s
    88   114 -26696.400    7  475 -31413.497 -25429.950  19.0% 20656 1390s
H   94   114                    -31393.78089 -25429.950  19.0% 19595 1390s
   119   251 -26706.520    8  461 -31393.781 -25429.950  19.0% 16549 1424s
   258   320 -26911.974   11  448 -31393.781 -25429.950  19.0%  9281 1446s
H  259   320                    -31385.22396 -25429.950  19.0%  9245 1446s
   333   365 -26818.957   13  444 -31385.224 -25429.950  19.0%  8296 1465s
   398   388 -28363.213   14  193 -31385.224 -25429.950  19.0%  7754 1483s
H  404   388                    -31376.81815 -25429.950  19.0%  7660 1483s
   450   419     cutoff   15      -31376.818 -25429.950  19.0%  7641 1499s
   513   459 -26919.983   15  432 -31376.818 -25429.950  19.0%  7475 1519s
   583   485 -27055.129   15  387 -31376.818 -25429.950  19.0%  7251 1539s
   663   500 -31005.977   15  161 -31376.818 -25429.950  19.0%  6938 1556s
   690   523 -31144.031   16  152 -31376.818 -25429.950  19.0%  6872 1570s
   739   542 -31035.341   16  153 -31376.818 -25429.950  19.0%  6813 1586s
   791   565 -31149.876   18  146 -31376.818 -25429.950  19.0%  6715 1605s
   847   587 -31264.723   20  132 -31376.818 -25429.950  19.0%  6629 1619s
   899   622     cutoff   23      -31376.818 -25429.950  19.0%  6568 1635s
   961   647 infeasible   25      -31376.818 -25429.950  19.0%  6429 1654s
  1049   691     cutoff   22      -31376.818 -25429.950  19.0%  6288 1671s
  1138   708     cutoff   31      -31376.818 -25429.950  19.0%  6108 1689s
  1188   730 infeasible   33      -31376.818 -25429.950  19.0%  6107 1705s
  1269   752 -31007.103   26  276 -31376.818 -25429.950  19.0%  5961 1724s
  1323   783 -29441.235   24  159 -31376.818 -25429.950  19.0%  5954 1746s
  1392   804 -30004.448   25  135 -31376.818 -25429.950  19.0%  5946 1768s
  1443   842 -30710.297   26  116 -31376.818 -25429.950  19.0%  6023 1792s
  1525   897 -30763.657   27  114 -31376.818 -25429.950  19.0%  6118 1814s
  1606   936 -31341.065   32  111 -31376.818 -25429.950  19.0%  6145 1841s
  1705   975     cutoff   33      -31376.818 -25430.024  19.0%  6102 1865s
  1795   992 -27883.546    9  406 -31376.818 -25430.024  19.0%  6125 1892s
  1898  1023 -28929.010   10  384 -31376.818 -25430.024  19.0%  6132 1917s
  1963  1086 -28993.344   11  522 -31376.818 -25430.024  19.0%  6257 1945s
  2082  1158 -29718.793   14  214 -31376.818 -25430.024  19.0%  6272 1973s
  2219  1190 -30300.042   22  203 -31376.818 -25430.024  19.0%  6175 2005s
  2336  1212 infeasible   28      -31376.818 -25430.024  19.0%  6094 2035s
  2451  1254 -28362.302   13  194 -31376.818 -25430.024  19.0%  6083 2067s
  2536  1302 -29253.275   15  150 -31376.818 -25580.573  18.5%  6153 2103s
  2650  1355 -30806.943   31   76 -31376.818 -25580.573  18.5%  6212 2139s
  2778  1389 infeasible   13      -31376.818 -25580.573  18.5%  6267 2176s
  2889  1421 -30306.178   24  343 -31376.818 -25580.573  18.5%  6343 2217s
  2994  1491     cutoff   30      -31376.818 -25580.573  18.5%  6432 2257s
  3132  1573 -30335.064   22  418 -31376.818 -25580.573  18.5%  6473 2301s
  3312  1657 -31253.388   24  305 -31376.818 -25580.573  18.5%  6423 2343s
  3475  1736 infeasible   27      -31376.818 -25580.573  18.5%  6468 2388s
  3698  1794 -30843.779   11  508 -31376.818 -25580.573  18.5%  6440 2434s
  3850  1846 -31077.615   13  418 -31376.818 -25580.573  18.5%  6514 2483s
  4009  1895     cutoff   18      -31376.818 -26386.564  15.9%  6563 2523s
  4091  1965 infeasible   12      -31376.818 -26386.564  15.9%  6619 2565s
  4272  2047     cutoff   22      -31376.818 -26386.564  15.9%  6600 2616s
  4420  2061 -29923.926   12  165 -31376.818 -26386.564  15.9%  6645 2660s
  4468  2091 -30193.692   13  160 -31376.818 -26386.564  15.9%  6716 2705s
  4508  2139 -30214.178   14  163 -31376.818 -26386.564  15.9%  6757 2761s
  4615  2140 -29589.048   28  744 -31376.818 -26386.564  15.9%  6762 3158s
  4617  2141 -29969.894   15  402 -31376.818 -26386.564  15.9%  6759 3180s
  4618  2142 -30108.925   24  651 -31376.818 -26386.564  15.9%  6757 3272s
  4619  2143 -30194.935   11  602 -31376.818 -26386.564  15.9%  6756 3339s
  4620  2143 -30105.715   29  621 -31376.818 -26386.564  15.9%  6754 3387s
  4621  2144 -30309.868   19  681 -31376.818 -26386.564  15.9%  6753 3416s
  4622  2145 -27845.376   19  691 -31376.818 -26386.564  15.9%  6752 3442s
  4623  2145 -27287.547   12  709 -31376.818 -26386.564  15.9%  6750 3472s
  4624  2146 -30811.753   35  766 -31376.818 -26386.564  15.9%  6749 3491s
  4625  2147 -29566.754   24  774 -31376.818 -26386.564  15.9%  6747 3510s
  4626  2147 -30473.623   31  778 -31376.818 -26386.564  15.9%  6746 3524s
  4627  2148 -28993.529   12  728 -31376.818 -26386.564  15.9%  6744 3546s
  4628  2149 -30051.801   19  764 -31376.818 -26386.564  15.9%  6743 3561s
  4629  2149 -30763.334   26  787 -31376.818 -26386.564  15.9%  6741 3573s
  4630  2150 -30290.855   30  745 -31376.818 -26386.564  15.9%  6740 3581s
  4631  2151 -26835.161   14  742 -31376.818 -26386.564  15.9%  6738 3591s

Cutting planes:
  Implied bound: 17
  Projected implied bound: 156
  MIR: 1271
  Flow cover: 1779
  Zero half: 7
  RLT: 35
  Relax-and-lift: 277

Explored 4631 nodes (32276067 simplex iterations) in 3600.07 seconds (8389.96 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31376.8 -31385.2 -31393.8 ... -31475

Time limit reached
Best objective -3.137681815007e+04, best bound -2.638656432752e+04, gap 15.9043%
  WARNING: Time limit reached. Using best solution found (gap: 15.90%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.32s
  Master Objective (UB) = -31376.82, θ = 93620.90
  Upper Bound (UB) = -31376.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93620.90
  [DEBUG]   ✓ Scenario 0: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93620.90 ≤ Q = 93620.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93620.90 ≤ Q = 93620.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93620.90 ≤ Q = 93620.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93620.90 ≤ Q = 93620.90 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x64bccb13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x64bccb13
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177514e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5479653.0456
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.236895e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123689.51    0  124 5479653.05 -123689.51   102%     -    0s
H    0     0                    -89841.56329 -123689.51  37.7%     -    0s
H    0     0                    -90400.24342 -123689.51  36.8%     -    0s
     0     0 -96236.190    0   67 -90400.243 -96236.190  6.46%     -    0s
H    0     0                    -93708.01288 -96133.576  2.59%     -    0s
H    0     0                    -93996.08803 -96133.576  2.27%     -    0s
H    0     0                    -94257.94302 -96133.576  1.99%     -    0s
H    0     0                    -94546.01817 -96133.576  1.68%     -    0s
     0     0 -95793.699    0   68 -94546.018 -95793.699  1.32%     -    0s
     0     0 -95502.131    0   73 -94546.018 -95502.131  1.01%     -    0s
     0     0 -95489.785    0   72 -94546.018 -95489.785  1.00%     -    0s
     0     0 -95348.982    0   71 -94546.018 -95348.982  0.85%     -    0s
     0     0 -95336.733    0   71 -94546.018 -95336.733  0.84%     -    0s
     0     2 -95336.733    0   71 -94546.018 -95336.733  0.84%     -    0s
H 4057  1252                    -94556.95956 -94747.483  0.20%   4.9    0s
H 4060  1252                    -94557.09959 -94747.483  0.20%   4.9    0s

Cutting planes:
  Gomory: 34
  Implied bound: 4
  MIR: 169
  Flow cover: 5
  RLT: 1
  BQP: 2

Explored 11511 nodes (60627 simplex iterations) in 0.33 seconds (0.31 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -94557.1 -94557 -94546 ... 1.17751e+13
No other solutions better than -94557.1

Optimal solution found (tolerance 1.00e-06)
Best objective -9.455709959422e+04, best bound -9.455709959422e+04, gap 0.0000%
  Subproblem solved in 0.35s
  Worst-case operational profit (Z_SP) = 92142.79
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94557.10
  [DEBUG]   S×d_nominal = 186699.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186699.89 + -94557.10 = 92142.79
  [DEBUG]   Current θ from Master = 93620.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1478.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -32854.93
  Lower Bound (LB) = -32854.93
  Gap (UB-LB) = 1478.1114, Absolute Gap = 1478.1114, Relative Gap = 0.047108
  Not converged yet (gap = 1478.11 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0xcbe714ea
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns
Presolve time: 2.57s
Presolved: 141123 rows, 59550 columns, 868798 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 7.293e+06
 Factor NZ  : 1.688e+07 (roughly 200 MB of memory)
 Factor Ops : 5.223e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.37970235e+07  2.43416173e+08  7.15e+04 1.60e+01  5.81e+04     4s
   1  -1.05953957e+07  2.02805669e+08  4.94e+04 4.98e+01  3.98e+04     4s
   2  -4.56626584e+06  1.54585684e+08  2.01e+04 1.40e+01  1.68e+04     5s
   3  -7.49808871e+05  9.95251534e+07  1.28e+03 1.29e+00  1.38e+03     5s
   4  -5.27435142e+05  3.62731078e+07  4.02e+02 2.44e-01  4.21e+02     5s
   5  -4.09098795e+05  2.68563011e+07  1.54e+02 1.65e-01  2.06e+02     5s
   6  -3.07022407e+05  1.95578299e+07  6.09e+01 1.07e-01  1.13e+02     5s
   7  -1.86683972e+05  1.55075568e+07  1.20e+01 8.10e-02  6.69e+01     5s
   8  -1.64118628e+05  8.12248967e+06  8.96e+00 3.97e-02  3.49e+01     5s
   9  -1.29478803e+05  4.83251744e+06  5.22e+00 2.24e-02  2.03e+01     5s
  10  -1.11029669e+05  1.20996514e+06  3.14e+00 5.08e-03  5.33e+00     5s
  11  -8.77049727e+04  4.55659692e+05  1.26e+00 1.92e-03  2.15e+00     5s
  12  -5.63168695e+04  1.50651106e+05  5.03e-01 6.38e-04  8.11e-01     5s
  13  -4.52839935e+04  9.51980989e+04  3.40e-01 5.42e-04  5.50e-01     5s
  14  -4.10853418e+04  6.79012296e+04  2.84e-01 1.08e-03  4.26e-01     5s
  15  -3.79066279e+04  5.06184002e+04  2.44e-01 1.07e-03  3.46e-01     6s
  16  -3.53815656e+04  2.91713027e+04  2.15e-01 2.39e-03  2.53e-01     6s
  17  -3.25623368e+04  2.23132927e+04  1.85e-01 1.80e-03  2.15e-01     6s
  18  -3.05301076e+04  1.44847416e+04  1.61e-01 1.57e-03  1.76e-01     6s
  19  -2.81338660e+04  9.95797556e+03  1.34e-01 1.21e-03  1.49e-01     6s
  20  -2.60074574e+04  3.29541513e+03  1.10e-01 1.32e-03  1.15e-01     6s
  21  -2.36658983e+04 -8.23142791e+02  8.76e-02 1.50e-03  8.94e-02     6s
  22  -2.26804441e+04 -3.68195486e+03  7.84e-02 1.74e-03  7.44e-02     6s
  23  -2.11652526e+04 -7.14198965e+03  6.44e-02 1.65e-03  5.49e-02     6s
  24  -1.98946893e+04 -8.02083226e+03  5.36e-02 1.53e-03  4.65e-02     6s
  25  -1.86345012e+04 -9.13407341e+03  4.30e-02 9.15e-04  3.72e-02     6s
  26  -1.77481438e+04 -1.00289489e+04  3.55e-02 9.69e-04  3.02e-02     6s
  27  -1.72429011e+04 -1.07808648e+04  3.15e-02 8.79e-04  2.53e-02     7s
  28  -1.65966921e+04 -1.14885686e+04  2.65e-02 1.18e-03  2.00e-02     7s
  29  -1.60524844e+04 -1.18340567e+04  2.21e-02 1.33e-03  1.65e-02     7s
  30  -1.54669792e+04 -1.21912884e+04  1.76e-02 1.13e-03  1.29e-02     7s
  31  -1.52525463e+04 -1.24147649e+04  1.60e-02 8.65e-04  1.11e-02     7s
  32  -1.48741756e+04 -1.24818418e+04  1.30e-02 7.84e-04  9.39e-03     7s
  33  -1.47249691e+04 -1.26643912e+04  1.19e-02 5.67e-04  8.09e-03     7s
  34  -1.45712867e+04 -1.27310028e+04  1.08e-02 5.09e-04  7.23e-03     7s
  35  -1.44045061e+04 -1.28205150e+04  9.49e-03 4.05e-04  6.22e-03     7s
  36  -1.41275828e+04 -1.28526526e+04  7.41e-03 3.68e-04  5.01e-03     7s
  37  -1.40140493e+04 -1.29169293e+04  6.52e-03 2.91e-04  4.31e-03     8s
  38  -1.39498486e+04 -1.29471036e+04  6.03e-03 2.51e-04  3.94e-03     8s
  39  -1.39073467e+04 -1.29884667e+04  5.70e-03 1.98e-04  3.61e-03     8s
  40  -1.36809576e+04 -1.30332857e+04  4.02e-03 1.43e-04  2.54e-03     8s
  41  -1.35590956e+04 -1.30491957e+04  3.06e-03 1.25e-04  2.00e-03     8s
  42  -1.34676965e+04 -1.30822515e+04  2.35e-03 1.30e-04  1.51e-03     8s
  43  -1.33763478e+04 -1.31104096e+04  1.62e-03 6.63e-05  1.04e-03     8s
  44  -1.32875416e+04 -1.31317124e+04  9.54e-04 3.61e-05  6.12e-04     8s
  45  -1.32467175e+04 -1.31345676e+04  6.52e-04 3.53e-05  4.40e-04     8s
  46  -1.32238031e+04 -1.31384829e+04  4.84e-04 2.84e-05  3.35e-04     8s
  47  -1.32143213e+04 -1.31400390e+04  4.15e-04 2.55e-05  2.92e-04     9s
  48  -1.31994730e+04 -1.31439249e+04  3.13e-04 1.83e-05  2.18e-04     9s
  49  -1.31740491e+04 -1.31470703e+04  1.33e-04 1.35e-05  1.06e-04     9s
  50  -1.31657044e+04 -1.31492342e+04  7.72e-05 9.18e-06  6.45e-05     9s
  51  -1.31607034e+04 -1.31527066e+04  4.27e-05 1.10e-05  3.14e-05     9s
  52  -1.31589141e+04 -1.31532555e+04  3.06e-05 6.85e-06  2.22e-05     9s
  53  -1.31565360e+04 -1.31539700e+04  1.43e-05 1.05e-06  1.01e-05     9s
  54  -1.31544844e+04 -1.31540235e+04  1.89e-06 7.67e-07  1.80e-06     9s
  55  -1.31542320e+04 -1.31541663e+04  3.63e-07 2.02e-07  2.58e-07     9s
  56  -1.31541709e+04 -1.31541708e+04  1.86e-08 9.90e-10  5.64e-10     9s
  57  -1.31541708e+04 -1.31541708e+04  3.42e-07 9.81e-09  1.83e-11     9s

Barrier solved model in 57 iterations and 9.44 seconds (15.11 work units)
Optimal objective -1.31541708e+04


Root crossover log...

  111832 DPushes remaining with DInf 0.0000000e+00                 9s
   53734 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    4459 PPushes remaining with PInf 5.4225666e-06                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.0516552e-10     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   55351   -1.3154171e+04   0.000000e+00   0.000000e+00     14s
   55351   -1.3154171e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 1.32s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -1.315417e+04, 55351 iterations, 11.98 seconds (23.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13154.171    0  433 -201924.56 -13154.171  93.5%     -   16s
H    0     0                    -106806.6349 -13154.171  87.7%     -   16s
H    0     0                    -106439.0670 -13154.171  87.6%     -   16s
H    0     0                    -104702.5363 -13154.171  87.4%     -   16s
H    0     0                    -102156.2522 -13154.171  87.1%     -   16s
H    0     0                    -85487.27694 -13154.171  84.6%     -   16s
H    0     0                    -77158.41112 -13154.171  83.0%     -   17s
H    0     0                    -77086.30690 -13154.171  82.9%     -   17s
H    0     0                    -77009.83312 -13154.171  82.9%     -   17s
     0     0 -17690.787    0  505 -77009.833 -17690.787  77.0%     -   78s
     0     0 -17690.849    0  505 -77009.833 -17690.849  77.0%     -   79s
H    0     0                    -62397.51749 -17691.502  71.6%     -   79s
H    0     0                    -62314.39479 -17691.502  71.6%     -   79s
H    0     0                    -58440.87229 -17691.502  69.7%     -   79s
H    0     0                    -58271.30616 -17691.502  69.6%     -   79s
H    0     0                    -58013.01150 -17691.502  69.5%     -   79s
     0     0 -18061.572    0  606 -58013.012 -18061.572  68.9%     -  102s
     0     0 -18068.907    0  610 -58013.012 -18068.907  68.9%     -  105s
     0     0 -18087.081    0  607 -58013.012 -18087.081  68.8%     -  109s
     0     0 -18093.446    0  607 -58013.012 -18093.446  68.8%     -  111s
     0     0 -18105.364    0  615 -58013.012 -18105.364  68.8%     -  116s
     0     0 -18140.230    0  618 -58013.012 -18140.230  68.7%     -  123s
     0     0 -18142.928    0  621 -58013.012 -18142.928  68.7%     -  126s
     0     0 -18212.406    0  628 -58013.012 -18212.406  68.6%     -  131s
     0     0 -18214.447    0  624 -58013.012 -18214.447  68.6%     -  132s
     0     0 -18222.408    0  622 -58013.012 -18222.408  68.6%     -  135s
     0     0 -18223.309    0  624 -58013.012 -18223.309  68.6%     -  136s
     0     0 -18223.431    0  624 -58013.012 -18223.431  68.6%     -  136s
     0     0 -20498.518    0  529 -58013.012 -20498.518  64.7%     -  183s
H    0     0                    -55332.40305 -20498.674  63.0%     -  184s
H    0     0                    -55317.24890 -20498.674  62.9%     -  184s
     0     0 -20721.353    0  574 -55317.249 -20721.353  62.5%     -  200s
     0     0 -20842.135    0  604 -55317.249 -20842.135  62.3%     -  211s
     0     0 -20863.287    0  610 -55317.249 -20863.287  62.3%     -  216s
     0     0 -20982.445    0  593 -55317.249 -20982.445  62.1%     -  226s
     0     0 -21012.213    0  636 -55317.249 -21012.213  62.0%     -  233s
     0     0 -21255.783    0  636 -55317.249 -21255.783  61.6%     -  253s
     0     0 -21264.015    0  647 -55317.249 -21264.015  61.6%     -  256s
     0     0 -21265.436    0  647 -55317.249 -21265.436  61.6%     -  257s
     0     0 -21267.897    0  590 -55317.249 -21267.897  61.6%     -  259s
     0     0 -21283.927    0  587 -55317.249 -21283.927  61.5%     -  261s
     0     0 -21287.660    0  652 -55317.249 -21287.660  61.5%     -  263s
     0     0 -21288.120    0  649 -55317.249 -21288.120  61.5%     -  264s
     0     0 -22727.656    0  659 -55317.249 -22727.656  58.9%     -  321s
H    0     0                    -55278.90509 -22727.692  58.9%     -  321s
H    0     0                    -55184.23811 -22727.692  58.8%     -  321s
     0     0 -23035.491    0  725 -55184.238 -23035.491  58.3%     -  343s
     0     0 -23120.923    0  745 -55184.238 -23120.923  58.1%     -  355s
     0     0 -23185.478    0  730 -55184.238 -23185.478  58.0%     -  366s
     0     0 -23229.971    0  688 -55184.238 -23229.971  57.9%     -  372s
     0     0 -23263.519    0  708 -55184.238 -23263.519  57.8%     -  378s
     0     0 -23327.685    0  747 -55184.238 -23327.685  57.7%     -  388s
     0     0 -23351.796    0  696 -55184.238 -23351.796  57.7%     -  393s
     0     0 -23392.782    0  696 -55184.238 -23392.782  57.6%     -  399s
     0     0 -23407.383    0  742 -55184.238 -23407.383  57.6%     -  404s
     0     0 -23409.945    0  700 -55184.238 -23409.945  57.6%     -  406s
     0     0 -23410.638    0  749 -55184.238 -23410.638  57.6%     -  407s
     0     0 -23973.114    0  749 -55184.238 -23973.114  56.6%     -  455s
H    0     0                    -54660.71613 -23973.121  56.1%     -  455s
     0     0 -24148.225    0  746 -54660.716 -24148.225  55.8%     -  474s
     0     0 -24216.676    0  748 -54660.716 -24216.676  55.7%     -  486s
     0     0 -24277.585    0  738 -54660.716 -24277.585  55.6%     -  495s
     0     0 -24321.213    0  738 -54660.716 -24321.213  55.5%     -  506s
     0     0 -24333.871    0  745 -54660.716 -24333.871  55.5%     -  512s
     0     0 -24350.231    0  740 -54660.716 -24350.231  55.5%     -  516s
     0     0 -24360.180    0  716 -54660.716 -24360.180  55.4%     -  518s
     0     0 -24376.249    0  693 -54660.716 -24376.249  55.4%     -  524s
     0     0 -24382.152    0  691 -54660.716 -24382.152  55.4%     -  528s
     0     0 -24393.678    0  687 -54660.716 -24393.678  55.4%     -  532s
     0     0 -24398.336    0  676 -54660.716 -24398.336  55.4%     -  535s
     0     0 -24399.263    0  689 -54660.716 -24399.263  55.4%     -  537s
     0     0 -24657.276    0  609 -54660.716 -24657.276  54.9%     -  566s
H    0     0                    -51713.13425 -24657.412  52.3%     -  567s
H    0     0                    -51477.59255 -24657.412  52.1%     -  567s
     0     0 -24711.639    0  755 -51477.593 -24711.639  52.0%     -  579s
     0     0 -24744.365    0  676 -51477.593 -24744.365  51.9%     -  588s
     0     0 -24755.935    0  775 -51477.593 -24755.935  51.9%     -  592s
     0     0 -24760.175    0  733 -51477.593 -24760.175  51.9%     -  595s
     0     0 -24763.450    0  787 -51477.593 -24763.450  51.9%     -  598s
     0     0 -24767.905    0  783 -51477.593 -24767.905  51.9%     -  601s
     0     0 -24768.292    0  783 -51477.593 -24768.292  51.9%     -  602s
     0     0 -24946.557    0  745 -51477.593 -24946.557  51.5%     -  624s
H    0     0                    -51189.08741 -24946.569  51.3%     -  629s
H    0     0                    -44238.72530 -24946.569  43.6%     -  629s
H    0     0                    -44223.79392 -24946.569  43.6%     -  630s
H    0     0                    -44221.23421 -24946.569  43.6%     -  630s
H    0     0                    -40478.64386 -24946.569  38.4%     -  630s
H    0     0                    -40410.81449 -24946.569  38.3%     -  631s
H    0     0                    -39071.11160 -24946.569  36.2%     -  631s
H    0     0                    -38888.71237 -24946.569  35.9%     -  631s
     0     0 -24987.337    0  707 -38888.712 -24987.337  35.7%     -  642s
     0     0 -25000.662    0  770 -38888.712 -25000.662  35.7%     -  651s
     0     0 -25006.541    0  767 -38888.712 -25006.541  35.7%     -  656s
     0     0 -25009.596    0  775 -38888.712 -25009.596  35.7%     -  658s
     0     0 -25011.006    0  772 -38888.712 -25011.006  35.7%     -  660s
     0     0 -25052.535    0  626 -38888.712 -25052.535  35.6%     -  677s
     0     0 -25074.911    0  699 -38888.712 -25074.911  35.5%     -  691s
     0     0 -25084.845    0  696 -38888.712 -25084.845  35.5%     -  696s
     0     0 -25088.902    0  699 -38888.712 -25088.902  35.5%     -  700s
     0     0 -25091.132    0  710 -38888.712 -25091.132  35.5%     -  702s
     0     0 -25091.778    0  708 -38888.712 -25091.778  35.5%     -  703s
     0     0 -25121.143    0  794 -38888.712 -25121.143  35.4%     -  717s
H    0     0                    -38807.89319 -25121.270  35.3%     -  718s
H    0     0                    -38793.13993 -25121.270  35.2%     -  718s
     0     0 -25136.369    0  743 -38793.140 -25136.369  35.2%     -  724s
     0     0 -25143.727    0  808 -38793.140 -25143.727  35.2%     -  729s
     0     0 -25145.667    0  763 -38793.140 -25145.667  35.2%     -  731s
     0     0 -25146.036    0  759 -38793.140 -25146.036  35.2%     -  733s
     0     0 -25155.358    0  670 -38793.140 -25155.358  35.2%     -  740s
H    0     0                    -38681.96955 -25155.548  35.0%     -  740s
     0     0 -25160.574    0  760 -38681.970 -25160.574  35.0%     -  745s
     0     0 -25162.617    0  825 -38681.970 -25162.617  35.0%     -  747s
     0     0 -25163.529    0  764 -38681.970 -25163.529  34.9%     -  749s
     0     0 -25180.701    0  811 -38681.970 -25180.701  34.9%     -  759s
H    0     0                    -38673.56374 -25181.104  34.9%     -  760s
H    0     0                    -38671.00403 -25181.104  34.9%     -  760s
     0     0 -25183.857    0  832 -38671.004 -25183.857  34.9%     -  763s
     0     0 -25185.366    0  834 -38671.004 -25185.366  34.9%     -  766s
     0     0 -25196.412    0  826 -38671.004 -25196.412  34.8%     -  775s
     0     0 -25198.210    0  817 -38671.004 -25198.210  34.8%     -  778s
     0     0 -25200.212    0  766 -38671.004 -25200.212  34.8%     -  780s
     0     0 -25201.770    0  822 -38671.004 -25201.770  34.8%     -  782s
     0     0 -25211.544    0  824 -38671.004 -25211.544  34.8%     -  789s
H    0     0                    -38640.83882 -25211.568  34.8%     -  797s
H    0     0                    -32288.25939 -25211.568  21.9%     -  799s
H    0     0                    -31683.14848 -25211.568  20.4%     -  799s
H    0     0                    -31643.67627 -25211.568  20.3%     -  799s
H    0     0                    -31615.00702 -25211.568  20.3%     -  799s
H    0     0                    -31604.53597 -25211.568  20.2%     -  800s
H    0     0                    -31604.53413 -25211.568  20.2%     -  801s
H    0     0                    -31579.84857 -25211.568  20.2%     -  801s
     0     0 -25213.619    0  780 -31579.849 -25213.619  20.2%     -  803s
     0     0 -25214.120    0  784 -31579.849 -25214.120  20.2%     -  805s
     0     0 -25217.398    0  831 -31579.849 -25217.398  20.1%     -  811s
     0     0 -25217.469    0  831 -31579.849 -25217.469  20.1%     -  818s
H    0     0                    -31483.23760 -25217.469  19.9%     -  843s
H    0     0                    -31470.41794 -25217.469  19.9%     -  843s
H    0     0                    -31455.26379 -25217.469  19.8%     -  843s
H    0     0                    -31454.97508 -25217.469  19.8%     -  906s
     0     2 -25217.469    0  831 -31454.975 -25217.469  19.8%     -  908s
     1     3 -25699.525    1  547 -31454.975 -25217.469  19.8% 16787  930s
     2     4 -25254.090    1  808 -31454.975 -25254.090  19.7% 10756  940s
     3     6 -25270.482    2  756 -31454.975 -25255.109  19.7%  9430  954s
     5    11 -25980.571    3  555 -31454.975 -25255.109  19.7%  9341  973s
    10    21 -26013.465    4  558 -31454.975 -25270.591  19.7%  9117  996s
    20    29 -26503.252    5  545 -31454.975 -25285.676  19.6% 15174 1059s
    30    55 -29327.112    5  282 -31454.975 -25464.160  19.0% 15172 1347s
H   33    55                    -31396.62619 -25464.160  18.9% 14918 1347s
H   34    55                    -31390.52035 -25464.160  18.9% 14846 1347s
    56    85 -29530.008    6  269 -31390.520 -25464.160  18.9% 23390 1491s
    88   177     cutoff    7      -31390.520 -25464.160  18.9% 21208 1549s
H  105   177                    -31390.51852 -25464.160  18.9% 18699 1549s
   188   273     cutoff   10      -31390.519 -25464.160  18.9% 14428 1583s
   303   299 -30490.300   13  263 -31390.519 -25464.160  18.9% 12029 1606s
   335   327 -30595.631   14  255 -31390.519 -25464.160  18.9% 11482 1628s
H  342   327                    -31389.12375 -25464.160  18.9% 11339 1628s
H  349   327                    -31387.55318 -25464.160  18.9% 11255 1628s
   367   378 -30780.227   15  251 -31387.553 -25464.160  18.9% 11278 1654s
   464   409 -31240.794   17  237 -31387.553 -25464.160  18.9% 10212 1676s
   543   430 -26245.890    8  557 -31387.553 -25464.160  18.9%  9715 1699s
   598   442 -26386.564    9  543 -31387.553 -25464.160  18.9%  9527 1722s
   648   460 -31175.686   19  139 -31387.553 -25464.160  18.9%  9537 1747s
   682   467     cutoff   20      -31387.553 -25464.160  18.9%  9572 1772s
   721   477 infeasible    8      -31387.553 -25464.160  18.9%  9684 1793s
   773   504 -28903.570   20  356 -31387.553 -25464.160  18.9%  9651 1814s
   834   513 -29050.365   21  426 -31387.553 -25464.160  18.9%  9497 1835s
   886   530 -29196.577   22  407 -31387.553 -25464.160  18.9%  9386 1857s
   948   546 -29588.518   23  351 -31387.553 -25464.160  18.9%  9206 1878s
  1029   566 -29652.929   24  231 -31387.553 -25464.160  18.9%  8867 1900s
  1091   600 -29691.314   25  213 -31387.553 -25464.160  18.9%  8779 1924s
  1173   618 -31350.716   28  195 -31387.553 -25464.902  18.9%  8602 1952s
  1260   636 infeasible   29      -31387.553 -25464.902  18.9%  8470 1978s
  1352   642 -27339.076    9  498 -31387.553 -25464.902  18.9%  8389 2008s
  1427   667 -27420.691   10  392 -31387.553 -25464.902  18.9%  8375 2036s
  1488   694 -27606.953   12  459 -31387.553 -25464.902  18.9%  8435 2067s
  1552   707 infeasible   16      -31387.553 -25464.902  18.9%  8509 2102s
  1629   747 -28953.029   11  155 -31387.553 -25464.902  18.9%  8549 2138s
  1704   796 -29593.475   12  120 -31387.553 -25464.902  18.9%  8569 2173s
  1820   843 -30734.192   22   48 -31387.553 -25464.902  18.9%  8503 2212s
  1957   888 -31244.059   28   38 -31387.553 -25464.902  18.9%  8412 2244s
  2083   916 -27886.969   14  505 -31387.553 -25464.902  18.9%  8339 2280s
  2163   947 -30316.595   15  449 -31387.553 -25464.902  18.9%  8293 2312s
  2250   972 -30778.410   16  442 -31387.553 -25464.902  18.9%  8413 2350s
  2316   978     cutoff   17      -31387.553 -25464.902  18.9%  8530 2388s
  2392   995     cutoff   17      -31387.553 -25464.902  18.9%  8661 2430s
  2486  1007 -27722.231   11  473 -31387.553 -25464.902  18.9%  8759 2476s
  2583  1022 -27747.729   12  478 -31387.553 -25464.902  18.9%  8835 2525s
  2682  1029 infeasible   15      -31387.553 -25464.902  18.9%  8950 2571s
  2729  1062 -28596.963   15  439 -31387.553 -25464.902  18.9%  9078 2616s
  2818  1107 infeasible   18      -31387.553 -25464.902  18.9%  9158 2668s
  2972  1141 -28068.215   12  515 -31387.553 -25464.902  18.9%  9152 2722s
  3093  1158 -29122.810   14  437 -31387.553 -25464.902  18.9%  9281 2777s
  3216  1175 -29491.659   17  471 -31387.553 -25464.902  18.9%  9387 2844s
  3301  1215     cutoff   17      -31387.553 -25464.902  18.9%  9477 2910s
  3398  1239 -28799.202   13  475 -31387.553 -25464.902  18.9%  9580 2971s
  3516  1273 -29722.790   16  300 -31387.553 -25464.902  18.9%  9607 3040s
  3674  1291 -30830.779   21  277 -31387.553 -25464.902  18.9%  9709 3105s
  3843  1323 -28860.590   12  500 -31387.553 -25464.902  18.9%  9781 3176s
  3973  1363 -31263.290   15  460 -31387.553 -25464.902  18.9%  9920 3250s
  4121  1405     cutoff   17      -31387.553 -25464.902  18.9% 10065 3335s
  4285  1418 -29382.370   18  506 -31387.553 -25464.902  18.9% 10147 3408s
  4341  1440 -29434.375   19  491 -31387.553 -25464.902  18.9% 10226 3488s
  4409  1458 -30358.082   20  477 -31387.553 -25464.902  18.9% 10257 3568s
  4535  1455 infeasible   21      -31387.553 -26555.404  15.4% 10249 3600s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 173
  MIR: 3317
  Flow cover: 4913
  Zero half: 4
  RLT: 111
  Relax-and-lift: 586

Explored 4618 nodes (47805693 simplex iterations) in 3600.08 seconds (8757.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31387.6 -31389.1 -31390.5 ... -31579.8

Time limit reached
Best objective -3.138755318409e+04, best bound -2.655540354154e+04, gap 15.3951%
  WARNING: Time limit reached. Using best solution found (gap: 15.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -31387.55, θ = 93348.93
  Upper Bound (UB) = -31387.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93348.93
  [DEBUG]   ✓ Scenario 0: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93348.93 ≤ Q = 93348.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93348.93 ≤ Q = 93348.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93348.93 ≤ Q = 93348.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93348.93 ≤ Q = 93348.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93348.93 ≤ Q = 93348.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93348.93 ≤ Q = 93348.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93348.93 ≤ Q = 93348.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93348.93 ≤ Q = 93348.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93348.93 ≤ Q = 93348.93 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5320bcd8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xacdf4328
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.170990e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5426186.6248
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.238559e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123855.93    0  124 5426186.62 -123855.93   102%     -    0s
H    0     0                    -89964.75939 -123855.93  37.7%     -    0s
H    0     0                    -90523.43952 -123855.93  36.8%     -    0s
     0     0 -97265.904    0   70 -90523.440 -97265.904  7.45%     -    0s
H    0     0                    -94743.11235 -97161.459  2.55%     -    0s
H    0     0                    -95031.18750 -97161.459  2.24%     -    0s
H    0     0                    -95307.84887 -97161.459  1.94%     -    0s
H    0     0                    -95595.92403 -97161.459  1.64%     -    0s
     0     0 -96689.936    0   71 -95595.924 -96689.936  1.14%     -    0s
     0     0 -96520.070    0   77 -95595.924 -96520.070  0.97%     -    0s
     0     0 -96511.076    0   77 -95595.924 -96511.076  0.96%     -    0s
     0     2 -96511.076    0   77 -95595.924 -96511.076  0.96%     -    0s

Cutting planes:
  Gomory: 43
  Implied bound: 2
  MIR: 179
  RLT: 1

Explored 2626 nodes (15213 simplex iterations) in 0.17 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -95595.9 -95307.8 -90523.4 ... 1.17099e+13
No other solutions better than -95595.9

Optimal solution found (tolerance 1.00e-06)
Best objective -9.559592402550e+04, best bound -9.559592402550e+04, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 90979.17
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95595.92
  [DEBUG]   S×d_nominal = 186575.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186575.10 + -95595.92 = 90979.17
  [DEBUG]   Current θ from Master = 93348.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2369.75 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33757.31
  Lower Bound (LB) = -32854.93
  Gap (UB-LB) = 1467.3764, Absolute Gap = 1467.3764, Relative Gap = 0.046750
  Not converged yet (gap = 1467.38 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0x56db255c
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns
Presolve time: 2.84s
Presolved: 149343 rows, 62920 columns, 919158 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.41s

Barrier statistics:
 Dense cols : 626
 AA' NZ     : 8.073e+06
 Factor NZ  : 1.866e+07 (roughly 240 MB of memory)
 Factor Ops : 5.886e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.38098724e+07  2.55656893e+08  7.16e+04 1.55e+01  5.79e+04     5s
   1  -1.06339819e+07  2.12947654e+08  4.95e+04 4.97e+01  3.96e+04     5s
   2  -4.76223628e+06  1.62492285e+08  2.10e+04 1.48e+01  1.74e+04     5s
   3  -7.63663486e+05  1.05765892e+08  1.32e+03 1.31e+00  1.40e+03     5s
   4  -5.35129487e+05  3.81002922e+07  4.12e+02 1.85e-01  4.25e+02     5s
   5  -4.13128764e+05  2.80487320e+07  1.52e+02 1.26e-01  2.03e+02     5s
   6  -3.14346956e+05  2.05901684e+07  6.16e+01 8.30e-02  1.12e+02     5s
   7  -1.90869404e+05  1.66502919e+07  1.05e+01 6.31e-02  6.73e+01     5s
   8  -1.65399897e+05  8.64023539e+06  7.73e+00 3.05e-02  3.47e+01     5s
   9  -1.34239190e+05  5.67351601e+06  4.64e+00 1.94e-02  2.23e+01     6s
  10  -1.14004733e+05  1.18037240e+06  2.69e+00 3.57e-03  4.91e+00     6s
  11  -9.77704052e+04  6.34093992e+05  1.64e+00 1.94e-03  2.75e+00     6s
  12  -6.59650945e+04  2.81692475e+05  5.45e-01 8.75e-04  1.29e+00     6s
  13  -5.49101819e+04  1.34687455e+05  3.48e-01 5.29e-04  7.00e-01     6s
  14  -4.41811519e+04  7.62161472e+04  2.38e-01 1.07e-03  4.44e-01     6s
  15  -4.09100657e+04  5.60219690e+04  2.08e-01 7.95e-04  3.58e-01     6s
  16  -3.51054973e+04  3.60006657e+04  1.58e-01 1.37e-03  2.62e-01     6s
  17  -3.24058146e+04  2.64382524e+04  1.35e-01 1.36e-03  2.17e-01     6s
  18  -3.04049909e+04  1.50291567e+04  1.20e-01 2.10e-03  1.68e-01     6s
  19  -2.67249637e+04  1.07500372e+04  8.89e-02 1.75e-03  1.38e-01     6s
  20  -2.52364571e+04  4.86856115e+03  7.56e-02 3.08e-03  1.11e-01     7s
  21  -2.26146089e+04  1.40957273e+03  5.63e-02 2.71e-03  8.86e-02     7s
  22  -2.16061229e+04 -3.38313860e+03  4.95e-02 2.58e-03  6.73e-02     7s
  23  -1.98326200e+04 -5.74123500e+03  3.73e-02 2.52e-03  5.20e-02     7s
  24  -1.91478281e+04 -6.93911527e+03  3.30e-02 2.23e-03  4.51e-02     7s
  25  -1.76349945e+04 -8.06165996e+03  2.34e-02 1.80e-03  3.53e-02     7s
  26  -1.71139490e+04 -9.19248981e+03  2.03e-02 1.38e-03  2.92e-02     7s
  27  -1.63619003e+04 -1.01462913e+04  1.64e-02 9.95e-04  2.29e-02     7s
  28  -1.57283535e+04 -1.07962476e+04  1.31e-02 9.36e-04  1.82e-02     7s
  29  -1.52065508e+04 -1.15153382e+04  1.05e-02 5.20e-04  1.36e-02     7s
  30  -1.48991470e+04 -1.18893788e+04  8.93e-03 4.02e-04  1.11e-02     8s
  31  -1.45913549e+04 -1.21336273e+04  7.40e-03 3.14e-04  9.07e-03     8s
  32  -1.44844538e+04 -1.23873007e+04  6.88e-03 2.37e-04  7.75e-03     8s
  33  -1.44302978e+04 -1.24865356e+04  6.62e-03 1.96e-04  7.18e-03     8s
  34  -1.42014055e+04 -1.25553436e+04  5.53e-03 1.81e-04  6.08e-03     8s
  35  -1.41451599e+04 -1.25858871e+04  5.25e-03 1.70e-04  5.76e-03     8s
  36  -1.39741318e+04 -1.26232203e+04  4.46e-03 1.57e-04  4.99e-03     8s
  37  -1.39144444e+04 -1.26789920e+04  4.18e-03 1.37e-04  4.56e-03     8s
  38  -1.38624676e+04 -1.27382654e+04  3.92e-03 1.14e-04  4.15e-03     8s
  39  -1.37281904e+04 -1.28143465e+04  3.25e-03 7.31e-05  3.38e-03     9s
  40  -1.36257890e+04 -1.28532438e+04  2.77e-03 6.00e-05  2.86e-03     9s
  41  -1.35503284e+04 -1.28798610e+04  2.42e-03 7.02e-05  2.48e-03     9s
  42  -1.33937820e+04 -1.29215162e+04  1.68e-03 5.38e-05  1.75e-03     9s
  43  -1.33566913e+04 -1.29283879e+04  1.50e-03 5.09e-05  1.58e-03     9s
  44  -1.33165211e+04 -1.29372956e+04  1.30e-03 4.71e-05  1.40e-03     9s
  45  -1.32614268e+04 -1.29472020e+04  1.03e-03 4.25e-05  1.16e-03     9s
  46  -1.31850706e+04 -1.29737254e+04  6.51e-04 6.29e-05  7.80e-04     9s
  47  -1.31339937e+04 -1.29840454e+04  4.11e-04 5.31e-05  5.53e-04    10s
  48  -1.31286433e+04 -1.30091944e+04  3.87e-04 3.03e-05  4.41e-04    10s
  49  -1.30977887e+04 -1.30216561e+04  2.45e-04 1.81e-05  2.81e-04    10s
  50  -1.30727905e+04 -1.30317003e+04  1.32e-04 8.38e-06  1.52e-04    10s
  51  -1.30489315e+04 -1.30325393e+04  2.19e-05 7.69e-06  6.03e-05    10s
  52  -1.30462429e+04 -1.30375104e+04  1.29e-05 3.87e-06  3.22e-05    10s
  53  -1.30459929e+04 -1.30378614e+04  1.21e-05 3.58e-06  2.99e-05    10s
  54  -1.30448383e+04 -1.30395247e+04  8.44e-06 2.10e-06  1.96e-05    10s
  55  -1.30446225e+04 -1.30400902e+04  7.72e-06 1.48e-06  1.67e-05    10s
  56  -1.30437965e+04 -1.30409648e+04  5.09e-06 8.73e-07  1.04e-05    10s
  57  -1.30431677e+04 -1.30411059e+04  3.18e-06 7.56e-07  7.60e-06    11s
  58  -1.30429247e+04 -1.30415478e+04  2.45e-06 4.75e-06  5.08e-06    11s
  59  -1.30428969e+04 -1.30415663e+04  2.37e-06 4.59e-06  4.90e-06    11s
  60  -1.30425473e+04 -1.30419726e+04  1.31e-06 1.33e-06  2.12e-06    11s
  61  -1.30424978e+04 -1.30419881e+04  1.21e-06 8.23e-06  1.88e-06    11s
  62  -1.30424804e+04 -1.30419938e+04  1.10e-06 7.95e-06  1.80e-06    11s
  63  -1.30424435e+04 -1.30420086e+04  1.07e-06 7.00e-06  1.61e-06    11s
  64  -1.30423429e+04 -1.30420208e+04  7.45e-07 6.27e-06  1.19e-06    11s
  65  -1.30423286e+04 -1.30420276e+04  6.98e-07 5.82e-06  1.11e-06    12s
  66  -1.30422736e+04 -1.30420471e+04  3.27e-06 4.49e-06  8.34e-07    12s
  67  -1.30421425e+04 -1.30421052e+04  5.84e-07 4.36e-07  1.37e-07    12s
  68  -1.30421364e+04 -1.30421068e+04  4.30e-07 3.38e-07  1.09e-07    12s
  69  -1.30421205e+04 -1.30421104e+04  1.43e-07 7.28e-08  3.70e-08    12s
  70  -1.30421189e+04 -1.30421106e+04  8.02e-07 5.06e-08  3.01e-08    12s
  71  -1.30421185e+04 -1.30421108e+04  7.62e-07 5.24e-08  2.83e-08    12s
  72  -1.30421172e+04 -1.30421109e+04  5.61e-07 9.33e-08  2.30e-08    12s
  73  -1.30421161e+04 -1.30421112e+04  5.56e-07 1.93e-07  1.80e-08    13s
  74  -1.30421161e+04 -1.30421112e+04  1.61e-06 1.92e-07  1.79e-08    13s
  75  -1.30421151e+04 -1.30421113e+04  2.14e-06 1.33e-07  1.39e-08    13s
  76  -1.30421150e+04 -1.30421113e+04  2.12e-06 1.28e-07  1.37e-08    13s
  77  -1.30421147e+04 -1.30421114e+04  1.94e-06 1.24e-07  1.28e-08    13s
  78  -1.30421147e+04 -1.30421114e+04  2.03e-06 1.20e-07  1.18e-08    13s
  79  -1.30421147e+04 -1.30421114e+04  2.03e-06 1.20e-07  1.18e-08    13s
  80  -1.30421146e+04 -1.30421114e+04  1.96e-06 1.16e-07  1.17e-08    13s
  81  -1.30421141e+04 -1.30421115e+04  2.18e-06 8.93e-08  8.96e-09    14s
  82  -1.30421140e+04 -1.30421115e+04  1.93e-06 8.63e-08  8.59e-09    14s
  83  -1.30421138e+04 -1.30421116e+04  3.46e-06 8.11e-08  7.96e-09    14s
  84  -1.30421138e+04 -1.30421116e+04  3.54e-06 8.06e-08  7.92e-09    14s
  85  -1.30421137e+04 -1.30421116e+04  3.13e-06 7.36e-08  7.70e-09    14s
  86  -1.30421136e+04 -1.30421116e+04  2.47e-06 7.32e-08  7.39e-09    14s
  87  -1.30421136e+04 -1.30421116e+04  2.24e-06 7.02e-08  7.12e-09    14s
  88  -1.30421135e+04 -1.30421116e+04  2.57e-06 6.77e-08  6.73e-09    14s
  89  -1.30421133e+04 -1.30421116e+04  2.94e-06 6.72e-08  6.69e-09    15s
  90  -1.30421133e+04 -1.30421116e+04  2.98e-06 6.63e-08  6.64e-09    15s
  91  -1.30421127e+04 -1.30421118e+04  5.67e-06 1.25e-07  3.68e-09    15s
  92  -1.30421126e+04 -1.30421118e+04  5.66e-06 1.19e-07  3.50e-09    15s
  93  -1.30421126e+04 -1.30421118e+04  5.35e-06 1.14e-07  3.39e-09    15s
  94  -1.30421126e+04 -1.30421118e+04  5.51e-06 1.03e-07  3.18e-09    15s

Barrier solved model in 94 iterations and 15.17 seconds (26.37 work units)
Optimal objective -1.30421126e+04


Root crossover log...

  118974 DPushes remaining with DInf 0.0000000e+00                15s
   25346 DPushes remaining with DInf 0.0000000e+00                20s
    3478 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                27s

   52113 PPushes remaining with PInf 3.5181313e-03                27s
    3580 PPushes remaining with PInf 1.2983030e-03                30s
       0 PPushes remaining with PInf 0.0000000e+00                31s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1225729e+06     31s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  120619   -1.3042113e+04   0.000000e+00   2.122573e+06     31s
  122046   -1.3042112e+04   0.000000e+00   0.000000e+00     33s
  122046   -1.3042112e+04   0.000000e+00   0.000000e+00     33s
Concurrent spin time: 6.28s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -1.304211e+04, 122046 iterations, 35.62 seconds (69.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13042.112    0  437 -201924.56 -13042.112  93.5%     -   40s
H    0     0                    -155886.5443 -13042.112  91.6%     -   40s
H    0     0                    -155416.5704 -13042.112  91.6%     -   40s
H    0     0                    -146967.7455 -13042.112  91.1%     -   40s
H    0     0                    -146325.7316 -13042.112  91.1%     -   40s
H    0     0                    -117358.7469 -13042.112  88.9%     -   40s
H    0     0                    -117095.1951 -13042.112  88.9%     -   41s
H    0     0                    -116933.2894 -13042.112  88.8%     -   41s
H    0     0                    -96352.86195 -13042.112  86.5%     -   41s
H    0     0                    -82230.44933 -13042.112  84.1%     -   41s
H    0     0                    -77513.46161 -13042.112  83.2%     -   41s
     0     0 -17556.792    0  560 -77513.462 -17556.792  77.4%     -  102s
H    0     0                    -74740.78316 -17560.642  76.5%     -  103s
H    0     0                    -73069.77958 -17560.642  76.0%     -  103s
H    0     0                    -71050.43607 -17560.642  75.3%     -  103s
H    0     0                    -69054.97938 -17560.642  74.6%     -  103s
H    0     0                    -68992.33532 -17560.642  74.5%     -  103s
H    0     0                    -68972.31883 -17560.642  74.5%     -  103s
H    0     0                    -68942.96331 -17560.642  74.5%     -  103s
     0     0 -17740.640    0  607 -68942.963 -17740.640  74.3%     -  123s
     0     0 -17849.985    0  559 -68942.963 -17849.985  74.1%     -  134s
     0     0 -17882.584    0  560 -68942.963 -17882.584  74.1%     -  142s
     0     0 -17892.242    0  567 -68942.963 -17892.242  74.0%     -  146s
     0     0 -17899.139    0  561 -68942.963 -17899.139  74.0%     -  148s
     0     0 -17899.611    0  561 -68942.963 -17899.611  74.0%     -  149s
     0     0 -20006.162    0  607 -68942.963 -20006.162  71.0%     -  205s
H    0     0                    -56134.96143 -20008.674  64.4%     -  206s
H    0     0                    -56119.80728 -20008.674  64.3%     -  206s
H    0     0                    -56100.63202 -20008.674  64.3%     -  206s
H    0     0                    -56028.07381 -20008.674  64.3%     -  206s
H    0     0                    -56027.73935 -20008.674  64.3%     -  206s
H    0     0                    -55959.55977 -20008.674  64.2%     -  206s
H    0     0                    -55940.92250 -20008.674  64.2%     -  206s
H    0     0                    -55934.31884 -20008.674  64.2%     -  206s
H    0     0                    -55913.46726 -20008.674  64.2%     -  206s
     0     0 -20171.218    0  569 -55913.467 -20171.218  63.9%     -  223s
     0     0 -20223.966    0  582 -55913.467 -20223.966  63.8%     -  231s
     0     0 -20323.136    0  568 -55913.467 -20323.136  63.7%     -  249s
     0     0 -20439.031    0  595 -55913.467 -20439.031  63.4%     -  266s
     0     0 -20496.648    0  613 -55913.467 -20496.648  63.3%     -  275s
     0     0 -20497.544    0  618 -55913.467 -20497.544  63.3%     -  276s
     0     0 -21842.364    0  639 -55913.467 -21842.364  60.9%     -  340s
H    0     0                    -55455.83494 -21842.649  60.6%     -  341s
H    0     0                    -55357.25144 -21842.649  60.5%     -  341s
     0     0 -22204.839    0  635 -55357.251 -22204.839  59.9%     -  379s
     0     0 -22477.964    0  661 -55357.251 -22477.964  59.4%     -  403s
     0     0 -22524.667    0  645 -55357.251 -22524.667  59.3%     -  420s
     0     0 -22541.530    0  654 -55357.251 -22541.530  59.3%     -  430s
     0     0 -22574.745    0  675 -55357.251 -22574.745  59.2%     -  440s
     0     0 -22578.016    0  671 -55357.251 -22578.016  59.2%     -  443s
     0     0 -22585.152    0  677 -55357.251 -22585.152  59.2%     -  447s
     0     0 -22595.212    0  674 -55357.251 -22595.212  59.2%     -  450s
     0     0 -22595.849    0  677 -55357.251 -22595.849  59.2%     -  451s
     0     0 -23398.478    0  686 -55357.251 -23398.478  57.7%     -  506s
H    0     0                    -55276.92145 -23398.485  57.7%     -  507s
     0     0 -23619.897    0  652 -55276.921 -23619.897  57.3%     -  531s
     0     0 -23680.764    0  653 -55276.921 -23680.764  57.2%     -  547s
     0     0 -23726.971    0  702 -55276.921 -23726.971  57.1%     -  560s
     0     0 -23736.490    0  668 -55276.921 -23736.490  57.1%     -  565s
     0     0 -23740.244    0  670 -55276.921 -23740.244  57.1%     -  569s
     0     0 -23742.734    0  660 -55276.921 -23742.734  57.0%     -  572s
     0     0 -23754.023    0  660 -55276.921 -23754.023  57.0%     -  576s
     0     0 -23760.745    0  650 -55276.921 -23760.745  57.0%     -  580s
     0     0 -23775.375    0  658 -55276.921 -23775.375  57.0%     -  586s
     0     0 -23778.717    0  631 -55276.921 -23778.717  57.0%     -  589s
     0     0 -23781.763    0  634 -55276.921 -23781.763  57.0%     -  592s
     0     0 -23782.614    0  624 -55276.921 -23782.614  57.0%     -  594s
     0     0 -24102.799    0  634 -55276.921 -24102.799  56.4%     -  633s
     0     0 -24183.059    0  719 -55276.921 -24183.059  56.3%     -  649s
     0     0 -24207.153    0  733 -55276.921 -24207.153  56.2%     -  657s
     0     0 -24227.315    0  737 -55276.921 -24227.315  56.2%     -  662s
     0     0 -24231.163    0  738 -55276.921 -24231.163  56.2%     -  665s
     0     0 -24234.502    0  685 -55276.921 -24234.502  56.2%     -  668s
     0     0 -24242.791    0  688 -55276.921 -24242.791  56.1%     -  672s
     0     0 -24244.995    0  688 -55276.921 -24244.995  56.1%     -  674s
     0     0 -24245.353    0  692 -55276.921 -24245.353  56.1%     -  676s
     0     0 -24374.953    0  643 -55276.921 -24374.953  55.9%     -  695s
H    0     0                    -53657.43964 -24375.120  54.6%     -  701s
H    0     0                    -49895.31196 -24375.120  51.1%     -  701s
H    0     0                    -48389.93011 -24375.120  49.6%     -  702s
H    0     0                    -44829.00634 -24375.120  45.6%     -  702s
H    0     0                    -44408.47615 -24375.120  45.1%     -  702s
H    0     0                    -44091.02969 -24375.120  44.7%     -  702s
     0     0 -24422.866    0  705 -44091.030 -24422.866  44.6%     -  715s
     0     0 -24433.112    0  709 -44091.030 -24433.112  44.6%     -  720s
     0     0 -24458.075    0  684 -44091.030 -24458.075  44.5%     -  727s
     0     0 -24462.297    0  687 -44091.030 -24462.297  44.5%     -  731s
     0     0 -24468.555    0  702 -44091.030 -24468.555  44.5%     -  734s
     0     0 -24469.863    0  708 -44091.030 -24469.863  44.5%     -  737s
     0     0 -24601.557    0  705 -44091.030 -24601.557  44.2%     -  759s
H    0     0                    -42470.28238 -24601.783  42.1%     -  759s
     0     0 -24647.890    0  722 -42470.282 -24647.890  42.0%     -  770s
     0     0 -24689.985    0  716 -42470.282 -24689.985  41.9%     -  780s
     0     0 -24697.643    0  738 -42470.282 -24697.643  41.8%     -  786s
     0     0 -24702.440    0  736 -42470.282 -24702.440  41.8%     -  790s
     0     0 -24706.598    0  744 -42470.282 -24706.598  41.8%     -  795s
     0     0 -24707.185    0  746 -42470.282 -24707.185  41.8%     -  797s
     0     0 -24758.152    0  703 -42470.282 -24758.152  41.7%     -  817s
H    0     0                    -41370.96006 -24758.247  40.2%     -  821s
H    0     0                    -41136.44085 -24758.247  39.8%     -  821s
H    0     0                    -40600.46254 -24758.247  39.0%     -  821s
H    0     0                    -40147.26826 -24758.247  38.3%     -  821s
H    0     0                    -39714.04587 -24758.247  37.7%     -  822s
H    0     0                    -39522.63870 -24758.247  37.4%     -  822s
H    0     0                    -38729.46885 -24758.247  36.1%     -  822s
     0     0 -24792.627    0  672 -38729.469 -24792.627  36.0%     -  833s
     0     0 -24804.682    0  667 -38729.469 -24804.682  36.0%     -  839s
     0     0 -24812.044    0  603 -38729.469 -24812.044  35.9%     -  845s
     0     0 -24816.532    0  612 -38729.469 -24816.532  35.9%     -  848s
     0     0 -24821.548    0  695 -38729.469 -24821.548  35.9%     -  854s
     0     0 -24823.822    0  736 -38729.469 -24823.822  35.9%     -  860s
     0     0 -24826.086    0  739 -38729.469 -24826.086  35.9%     -  864s
     0     0 -24826.207    0  742 -38729.469 -24826.207  35.9%     -  866s
     0     0 -24855.653    0  683 -38729.469 -24855.653  35.8%     -  881s
H    0     0                    -38435.38097 -24855.685  35.3%     -  882s
H    0     0                    -38353.12800 -24855.685  35.2%     -  882s
     0     0 -24874.353    0  791 -38353.128 -24874.353  35.1%     -  893s
     0     0 -24877.983    0  740 -38353.128 -24877.983  35.1%     -  896s
     0     0 -24880.153    0  745 -38353.128 -24880.153  35.1%     -  901s
     0     0 -24880.749    0  757 -38353.128 -24880.749  35.1%     -  903s
     0     0 -24893.289    0  757 -38353.128 -24893.289  35.1%     -  914s
H    0     0                    -37959.11245 -24893.681  34.4%     -  916s
H    0     0                    -37845.98637 -24893.681  34.2%     -  919s
     0     0 -24898.804    0  757 -37845.986 -24898.804  34.2%     -  927s
     0     0 -24899.843    0  765 -37845.986 -24899.843  34.2%     -  929s
     0     0 -24920.048    0  768 -37845.986 -24920.048  34.2%     -  942s
H    0     0                    -37488.23877 -24920.392  33.5%     -  943s
H    0     0                    -37306.29220 -24920.392  33.2%     -  943s
H    0     0                    -37259.08133 -24920.392  33.1%     -  943s
H    0     0                    -37252.16349 -24920.392  33.1%     -  943s
     0     0 -24921.721    0  764 -37252.163 -24921.721  33.1%     -  946s
     0     0 -24933.214    0  805 -37252.163 -24933.214  33.1%     -  957s
H    0     0                    -35543.63804 -24933.279  29.9%     -  974s
H    0     0                    -35368.62921 -24933.279  29.5%     -  975s
H    0     0                    -35265.89583 -24933.279  29.3%     -  975s
H    0     0                    -35241.19784 -24933.279  29.2%     -  975s
H    0     0                    -35173.46943 -24933.279  29.1%     -  975s
H    0     0                    -35111.98836 -24933.279  29.0%     -  976s
H    0     0                    -34817.24406 -24933.279  28.4%     -  976s
H    0     0                    -34611.99624 -24933.279  28.0%     -  977s
H    0     0                    -34603.21608 -24933.279  27.9%     -  977s
     0     0 -24937.903    0  763 -34603.216 -24937.903  27.9%     -  983s
     0     0 -24939.088    0  797 -34603.216 -24939.088  27.9%     -  986s
     0     0 -24943.546    0  769 -34603.216 -24943.546  27.9%     -  994s
     0     0 -24943.556    0  769 -34603.216 -24943.556  27.9%     - 1002s
H    0     0                    -34555.14336 -24943.571  27.8%     - 1064s
H    0     0                    -34480.12499 -24943.571  27.7%     - 1064s
H    0     0                    -32351.15482 -24943.580  22.9%     - 1149s
H    0     0                    -32294.26563 -24943.580  22.8%     - 1149s
H    0     0                    -32212.92906 -24943.580  22.6%     - 1149s
H    0     0                    -32212.92722 -24943.580  22.6%     - 1151s
H    0     0                    -32091.26803 -24943.580  22.3%     - 1151s
H    0     0                    -32007.12897 -24943.580  22.1%     - 1151s
H    0     0                    -31974.93619 -24943.580  22.0%     - 1151s
     0     2 -24943.580    0  769 -31974.936 -24943.580  22.0%     - 1155s
     1     3 -25019.555    1  744 -31974.936 -24943.580  22.0% 13366 1172s
     2     4 -24953.439    1  773 -31974.936 -24953.439  22.0%  8043 1182s
     3     7 -25207.351    2  750 -31974.936 -24953.538  22.0%  8565 1211s
     6    12 -25309.596    3  722 -31974.936 -24953.543  22.0% 11310 1253s
    11    24 -26221.999    4  481 -31974.936 -25018.938  21.8% 16429 1283s
    23    34 -25775.338    5  514 -31974.936 -25237.081  21.1% 20664 1355s
H   35    60                    -31805.46635 -25237.081  20.7% 22551 1559s
H   35    60                    -31740.46691 -25237.081  20.5% 22551 1559s
H   37    60                    -31682.45047 -25237.081  20.3% 22168 1559s
H   46    60                    -31610.84410 -25237.081  20.2% 19849 1559s
    63    91 -25570.983    6  670 -31610.844 -25237.081  20.2% 28391 1623s
    94   219 -25576.226    7  663 -31610.844 -25237.081  20.2% 24511 1679s
H   99   219                    -31537.19481 -25237.081  20.0% 23421 1679s
H  109   219                    -31390.51852 -25237.081  19.6% 21652 1679s
   230   286 -25625.661   12  620 -31390.519 -25237.081  19.6% 13943 1707s
   305   336 -25645.504   13  621 -31390.519 -25237.081  19.6% 12396 1730s
   370   376 -25687.675   14  618 -31390.519 -25237.081  19.6% 11340 1750s
   435   379 -25768.465   15  615 -31390.519 -25237.081  19.6% 10597 1774s
   486   400 -28219.988   13  387 -31390.519 -25237.081  19.6% 10333 1812s
   515   437 -25849.139   16  680 -31390.519 -25237.081  19.6% 10273 1875s
   571   465 -25952.504   17  602 -31390.519 -25237.081  19.6%  9906 1943s
   647   494 infeasible   16      -31390.519 -25237.081  19.6%  9480 1997s
   706   522 -29486.511   25  350 -31390.519 -25237.081  19.6%  9174 2050s
   769   555 -29934.819   27  266 -31390.519 -25237.081  19.6%  8905 2099s
   838   604 -30423.289   29  241 -31390.519 -25237.081  19.6%  8626 2148s
   935   626 -31064.140   32  309 -31390.519 -25237.081  19.6%  8222 2202s
  1039   639 -30653.448   31  322 -31390.519 -25237.081  19.6%  7893 2228s
  1122   638 infeasible   32      -31390.519 -25237.081  19.6%  7615 2252s
  1169   662 -30089.449   24  363 -31390.519 -25237.081  19.6%  7565 2275s
  1223   688 -30680.143   12  171 -31390.519 -25237.081  19.6%  7625 2298s
  1273   723 -31303.524   13  143 -31390.519 -25237.081  19.6%  7693 2321s
  1332   744 infeasible   13      -31390.519 -25237.081  19.6%  7702 2344s
  1404   798 -30930.542   14  375 -31390.519 -25237.081  19.6%  7640 2370s
  1498   832 infeasible   26      -31390.519 -25237.081  19.6%  7432 2401s
  1604   860 -29407.831   16  333 -31390.519 -25237.081  19.6%  7331 2430s
  1707   908 -29646.300   18  308 -31390.519 -25237.081  19.6%  7309 2462s
  1777   949 -31035.743   21  270 -31390.519 -25237.081  19.6%  7465 2496s
  1860   975 -28025.733   16  511 -31390.519 -25237.081  19.6%  7635 2527s
  1916  1055 -28220.906   17  474 -31390.519 -25237.081  19.6%  7735 2561s
  2036  1149 -28223.774   18  413 -31390.519 -25237.081  19.6%  7756 2594s
  2172  1171 -28516.793   21  405 -31390.519 -25237.081  19.6%  7650 2627s
  2283  1178 -29970.266   22  371 -31390.519 -25237.081  19.6%  7615 2666s
  2359  1208 -30436.054   23  223 -31390.519 -25237.081  19.6%  7605 2709s
  2459  1225 -29799.547   23  311 -31390.519 -25237.081  19.6%  7652 2749s
  2537  1251 infeasible   25      -31390.519 -25237.081  19.6%  7795 2792s
  2658  1277 -28251.401   10  189 -31390.519 -25237.081  19.6%  7909 2838s
  2768  1293     cutoff   15      -31390.519 -25237.081  19.6%  7977 2884s
  2896  1307 infeasible   16      -31390.519 -25237.081  19.6%  8030 2935s
  2992  1336 -31079.794   21  384 -31390.519 -25237.081  19.6%  8208 2987s
  3081  1357 -30047.027   19  557 -31390.519 -25237.081  19.6%  8394 3043s
  3194  1400 -30075.776   20  530 -31390.519 -25237.081  19.6%  8453 3103s
  3307  1408 -31032.405   22  528 -31390.519 -25237.081  19.6%  8593 3153s
  3372  1432     cutoff   23      -31390.519 -25237.081  19.6%  8724 3207s
  3434  1449 infeasible   22      -31390.519 -25237.081  19.6%  8875 3266s
  3536  1468 -29123.907   13  344 -31390.519 -25237.081  19.6%  8972 3339s
  3674  1480 -30677.561   15  218 -31390.519 -25237.081  19.6%  9037 3408s
  3824  1500 -29205.422    8  428 -31390.519 -25354.904  19.2%  9115 3477s
  3936  1525 -31189.865   10  219 -31390.519 -25354.950  19.2%  9259 3556s
  4104  1539 -30082.603   12  205 -31390.519 -25891.809  17.5%  9312 3600s

Cutting planes:
  Gomory: 1
  Implied bound: 213
  MIR: 3947
  Flow cover: 5822
  Zero half: 11
  RLT: 118
  Relax-and-lift: 1051

Explored 4235 nodes (40176771 simplex iterations) in 3600.10 seconds (8830.17 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31390.5 -31537.2 -31610.8 ... -32212.9

Time limit reached
Best objective -3.139051851817e+04, best bound -2.589180861561e+04, gap 17.5171%
  WARNING: Time limit reached. Using best solution found (gap: 17.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -31390.52, θ = 93296.68
  Upper Bound (UB) = -31390.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93296.68
  [DEBUG]   ✓ Scenario 0: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93296.68 ≤ Q = 93296.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93296.68 ≤ Q = 93296.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93296.68 ≤ Q = 93296.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93296.68 ≤ Q = 93296.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x58e2c3e2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa71d3c1e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.170851e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5472783.4148
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.240336e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124033.65    0  124 5472783.41 -124033.65   102%     -    0s
H    0     0                    -90141.80529 -124033.65  37.6%     -    0s
H    0     0                    -90700.48542 -124033.65  36.8%     -    0s
     0     0 -96495.975    0   31 -90700.485 -96495.975  6.39%     -    0s
H    0     0                    -95531.25562 -96447.677  0.96%     -    0s
     0     0 -96084.483    0   18 -95531.256 -96084.483  0.58%     -    0s
H    0     0                    -95684.79217 -96076.840  0.41%     -    0s
H    0     0                    -95876.90596 -96065.518  0.20%     -    0s
     0     0 -96021.693    0   12 -95876.906 -96021.693  0.15%     -    0s
     0     0 -96021.693    0    9 -95876.906 -96021.693  0.15%     -    0s
     0     0 -96021.693    0    8 -95876.906 -96021.693  0.15%     -    0s
     0     0 -95935.134    0   10 -95876.906 -95935.134  0.06%     -    0s
     0     0 -95911.181    0    9 -95876.906 -95911.181  0.04%     -    0s
     0     0 -95901.690    0    3 -95876.906 -95901.690  0.03%     -    0s
     0     0 -95887.091    0    3 -95876.906 -95887.091  0.01%     -    0s
     0     0 -95883.458    0    3 -95876.906 -95883.458  0.01%     -    0s
H    0     0                    -95881.24850 -95883.458  0.00%     -    0s
     0     0     cutoff    0      -95881.249 -95881.249  0.00%     -    0s

Cutting planes:
  RLT: 1

Explored 1 nodes (464 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -95881.2 -95876.9 -95873 ... 1.17085e+13
No other solutions better than -95881.2

Optimal solution found (tolerance 1.00e-06)
Best objective -9.588124850410e+04, best bound -9.588124850410e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 90818.64
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95881.25
  [DEBUG]   S×d_nominal = 186699.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186699.89 + -95881.25 = 90818.64
  [DEBUG]   Current θ from Master = 93296.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2478.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33868.55
  Lower Bound (LB) = -32854.93
  Gap (UB-LB) = 1464.4110, Absolute Gap = 1464.4110, Relative Gap = 0.046651
  Not converged yet (gap = 1464.41 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 49 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0x1479ae7e
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134330 rows and 54530 columns
Presolve time: 3.14s
Presolved: 157563 rows, 66290 columns, 969807 nonzeros
Variable types: 64031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.49s

Barrier statistics:
 Dense cols : 625
 AA' NZ     : 8.929e+06
 Factor NZ  : 1.998e+07 (roughly 250 MB of memory)
 Factor Ops : 5.193e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.38169122e+07  2.66796475e+08  7.16e+04 1.50e+01  5.75e+04     6s
   1  -1.06837910e+07  2.22083792e+08  4.97e+04 4.95e+01  3.95e+04     6s
   2  -4.91305361e+06  1.71676456e+08  2.17e+04 1.90e+01  1.78e+04     6s
   3  -7.99283285e+05  1.11872412e+08  1.39e+03 1.08e+00  1.45e+03     6s
   4  -5.53878648e+05  4.02857014e+07  4.63e+02 1.93e-01  4.58e+02     6s
   5  -4.24977730e+05  2.84231184e+07  1.71e+02 1.07e-01  2.10e+02     6s
   6  -3.23234653e+05  2.12268955e+07  7.15e+01 7.16e-02  1.16e+02     6s
   7  -1.89240284e+05  1.63025285e+07  8.93e+00 5.05e-02  6.20e+01     6s
   8  -1.63261861e+05  9.14823170e+06  6.57e+00 2.71e-02  3.45e+01     6s
   9  -1.26730596e+05  4.62814702e+06  3.62e+00 1.30e-02  1.72e+01     6s
  10  -1.08185969e+05  2.24439878e+06  2.00e+00 6.11e-03  8.37e+00     6s
  11  -8.99478105e+04  6.10708158e+05  7.61e-01 1.64e-03  2.46e+00     7s
  12  -6.17592960e+04  2.38579841e+05  2.69e-01 6.28e-04  1.05e+00     7s
  13  -5.20519125e+04  1.48899026e+05  1.91e-01 4.86e-04  7.02e-01     7s
  14  -4.57310800e+04  9.82703519e+04  1.52e-01 7.04e-04  5.03e-01     7s
  15  -4.26437752e+04  6.74168729e+04  1.35e-01 1.05e-03  3.84e-01     7s
  16  -3.82789441e+04  3.85389121e+04  1.12e-01 1.22e-03  2.68e-01     7s
  17  -3.33381470e+04  2.64400601e+04  8.58e-02 1.97e-03  2.09e-01     7s
  18  -3.14721043e+04  2.00438891e+04  7.64e-02 2.16e-03  1.80e-01     7s
  19  -2.92109040e+04  1.32549500e+04  6.53e-02 1.41e-03  1.48e-01     7s
  20  -2.66567557e+04  8.90438833e+03  5.32e-02 1.13e-03  1.24e-01     7s
  21  -2.47069858e+04  2.02510342e+02  4.36e-02 1.04e-03  8.70e-02     7s
  22  -2.32253894e+04 -2.58542679e+03  3.71e-02 9.80e-04  7.21e-02     8s
  23  -2.21187983e+04 -6.27869054e+03  3.28e-02 1.35e-03  5.54e-02     8s
  24  -2.08396380e+04 -7.37333564e+03  2.79e-02 1.13e-03  4.71e-02     8s
  25  -2.00245061e+04 -8.25302988e+03  2.48e-02 1.12e-03  4.11e-02     8s
  26  -1.82040751e+04 -9.46168651e+03  1.80e-02 1.04e-03  3.06e-02     8s
  27  -1.78735500e+04 -1.03531737e+04  1.68e-02 7.89e-04  2.63e-02     8s
  28  -1.64076332e+04 -1.12333774e+04  1.16e-02 5.66e-04  1.81e-02     8s
  29  -1.60726557e+04 -1.13928085e+04  1.04e-02 5.18e-04  1.64e-02     8s
  30  -1.55282472e+04 -1.16959829e+04  8.54e-03 4.21e-04  1.34e-02     8s
  31  -1.51740606e+04 -1.20316270e+04  7.31e-03 3.35e-04  1.10e-02     9s
  32  -1.47410638e+04 -1.22394196e+04  5.83e-03 2.99e-04  8.75e-03     9s
  33  -1.45509054e+04 -1.24362140e+04  5.19e-03 2.44e-04  7.40e-03     9s
  34  -1.43331529e+04 -1.25005261e+04  4.45e-03 2.21e-04  6.41e-03     9s
  35  -1.40962517e+04 -1.25209621e+04  3.66e-03 2.13e-04  5.51e-03     9s
  36  -1.40020432e+04 -1.25512424e+04  3.31e-03 2.05e-04  5.07e-03     9s
  37  -1.37913301e+04 -1.26382825e+04  2.55e-03 1.90e-04  4.03e-03     9s
  38  -1.37261380e+04 -1.27565222e+04  2.30e-03 1.34e-04  3.39e-03     9s
  39  -1.36053081e+04 -1.28016903e+04  1.89e-03 1.12e-04  2.81e-03     9s
  40  -1.35412338e+04 -1.28297109e+04  1.66e-03 9.97e-05  2.49e-03    10s
  41  -1.33893070e+04 -1.28715700e+04  1.15e-03 7.76e-05  1.81e-03    10s
  42  -1.32823076e+04 -1.29365274e+04  7.76e-04 6.06e-05  1.21e-03    10s
  43  -1.32418458e+04 -1.29595919e+04  6.39e-04 4.77e-05  9.87e-04    10s
  44  -1.31642085e+04 -1.29985972e+04  3.88e-04 2.37e-05  5.79e-04    10s
  45  -1.31353228e+04 -1.30135915e+04  2.93e-04 1.45e-05  4.26e-04    10s
  46  -1.30834586e+04 -1.30216197e+04  1.24e-04 1.02e-05  2.16e-04    10s
  47  -1.30794125e+04 -1.30305727e+04  1.11e-04 5.56e-06  1.71e-04    11s
  48  -1.30538497e+04 -1.30368537e+04  2.96e-05 2.36e-06  5.94e-05    11s
  49  -1.30509530e+04 -1.30378394e+04  2.20e-05 2.06e-06  4.58e-05    11s
  50  -1.30508500e+04 -1.30382213e+04  2.17e-05 1.84e-06  4.41e-05    11s
  51  -1.30502859e+04 -1.30385120e+04  2.03e-05 1.70e-06  4.11e-05    11s
  52  -1.30479507e+04 -1.30400004e+04  1.45e-05 1.32e-06  2.78e-05    11s
  53  -1.30463071e+04 -1.30414196e+04  1.04e-05 7.07e-07  1.71e-05    11s
  54  -1.30447165e+04 -1.30415435e+04  6.34e-06 6.29e-07  1.11e-05    11s
  55  -1.30436293e+04 -1.30418233e+04  3.61e-06 3.67e-07  6.32e-06    11s
  56  -1.30423884e+04 -1.30419216e+04  5.51e-07 2.35e-07  1.63e-06    12s
  57  -1.30422518e+04 -1.30419978e+04  2.70e-07 2.16e-07  8.87e-07    12s
  58  -1.30421679e+04 -1.30420557e+04  9.97e-08 1.06e-07  3.92e-07    12s
  59  -1.30421680e+04 -1.30420557e+04  8.19e-07 1.07e-07  3.92e-07    12s
  60  -1.30421549e+04 -1.30420937e+04  7.36e-07 2.69e-08  2.14e-07    12s
  61  -1.30421293e+04 -1.30421075e+04  4.51e-07 5.91e-09  7.63e-08    12s
  62  -1.30421275e+04 -1.30421092e+04  7.52e-07 1.25e-07  6.45e-08    13s
  63  -1.30421257e+04 -1.30421095e+04  6.70e-07 1.03e-07  5.73e-08    13s
  64  -1.30421169e+04 -1.30421115e+04  4.34e-07 3.55e-07  1.92e-08    13s
  65  -1.30421152e+04 -1.30421118e+04  2.69e-05 2.74e-06  1.33e-08    13s
  66  -1.30421151e+04 -1.30421118e+04  2.53e-05 2.60e-06  1.27e-08    13s
  67  -1.30421148e+04 -1.30421119e+04  2.54e-05 2.34e-06  1.20e-08    13s
  68  -1.30421149e+04 -1.30421119e+04  2.38e-05 2.29e-06  1.18e-08    13s
  69  -1.30421147e+04 -1.30421119e+04  2.44e-05 2.20e-06  1.13e-08    13s
  70  -1.30421143e+04 -1.30421119e+04  2.20e-05 2.06e-06  1.01e-08    14s
  71  -1.30421143e+04 -1.30421119e+04  1.70e-05 1.91e-06  8.88e-09    14s
  72  -1.30421142e+04 -1.30421119e+04  1.46e-05 1.86e-06  8.44e-09    14s
  73  -1.30421141e+04 -1.30421119e+04  1.39e-05 1.84e-06  8.32e-09    14s
  74  -1.30421141e+04 -1.30421119e+04  1.38e-05 1.80e-06  8.20e-09    14s
  75  -1.30421140e+04 -1.30421119e+04  1.31e-05 1.75e-06  7.69e-09    14s
  76  -1.30421137e+04 -1.30421119e+04  1.22e-05 1.71e-06  7.42e-09    14s
  77  -1.30421137e+04 -1.30421119e+04  1.26e-05 1.71e-06  7.42e-09    15s
  78  -1.30421136e+04 -1.30421119e+04  1.17e-05 1.65e-06  7.16e-09    15s
  79  -1.30421136e+04 -1.30421119e+04  1.14e-05 1.61e-06  6.90e-09    15s
  80  -1.30421136e+04 -1.30421119e+04  1.11e-05 1.55e-06  6.69e-09    15s
  81  -1.30421136e+04 -1.30421119e+04  1.11e-05 1.55e-06  6.68e-09    15s
  82  -1.30421135e+04 -1.30421119e+04  1.07e-05 1.49e-06  6.61e-09    15s
  83  -1.30421135e+04 -1.30421119e+04  1.07e-05 1.49e-06  6.59e-09    15s
  84  -1.30421134e+04 -1.30421119e+04  1.04e-05 1.44e-06  6.40e-09    15s
  85  -1.30421133e+04 -1.30421119e+04  9.82e-06 1.25e-06  5.96e-09    16s
  86  -1.30421131e+04 -1.30421119e+04  8.30e-06 1.04e-06  5.32e-09    16s

Barrier solved model in 86 iterations and 15.74 seconds (26.08 work units)
Optimal objective -1.30421131e+04


Root crossover log...

  125269 DPushes remaining with DInf 0.0000000e+00                16s
   32583 DPushes remaining with DInf 0.0000000e+00                20s
   10542 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                28s

   58392 PPushes remaining with PInf 5.5373011e-04                28s
   27025 PPushes remaining with PInf 1.6544943e-03                30s
       0 PPushes remaining with PInf 0.0000000e+00                35s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2199592e+06     35s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  129858   -1.3042122e+04   0.000000e+00   1.219959e+06     35s
  131677   -1.3042112e+04   0.000000e+00   0.000000e+00     38s
  131677   -1.3042112e+04   0.000000e+00   0.000000e+00     38s
Concurrent spin time: 14.44s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -1.304211e+04, 131677 iterations, 48.06 seconds (78.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13042.112    0  437 -201924.56 -13042.112  93.5%     -   53s
H    0     0                    -197780.5349 -13042.112  93.4%     -   53s
H    0     0                    -197463.1110 -13042.112  93.4%     -   53s
H    0     0                    -197431.9847 -13042.112  93.4%     -   53s
H    0     0                    -193866.9867 -13042.112  93.3%     -   53s
H    0     0                    -144022.5239 -13042.112  90.9%     -   54s
H    0     0                    -143967.2001 -13042.112  90.9%     -   54s
H    0     0                    -110450.7518 -13042.112  88.2%     -   54s
H    0     0                    -110288.8460 -13042.112  88.2%     -   54s
H    0     0                    -68847.96432 -13042.112  81.1%     -   54s
H    0     0                    -64635.87534 -13042.112  79.8%     -   54s
H    0     0                    -64028.47288 -13042.112  79.6%     -   54s
     0     0 -17595.949    0  555 -64028.473 -17595.949  72.5%     -  147s
H    0     0                    -58969.54320 -17596.044  70.2%     -  148s
H    0     0                    -55487.85224 -17596.044  68.3%     -  148s
H    0     0                    -55483.17005 -17596.044  68.3%     -  148s
H    0     0                    -55480.03541 -17596.044  68.3%     -  148s
     0     0 -17844.652    0  542 -55480.035 -17844.652  67.8%     -  168s
     0     0 -17874.243    0  552 -55480.035 -17874.243  67.8%     -  174s
     0     0 -17898.629    0  555 -55480.035 -17898.629  67.7%     -  180s
     0     0 -17898.845    0  560 -55480.035 -17898.845  67.7%     -  182s
     0     0 -20122.415    0  558 -55480.035 -20122.415  63.7%     -  266s
H    0     0                    -55445.74041 -20122.714  63.7%     -  268s
H    0     0                    -55417.44965 -20122.714  63.7%     -  268s
H    0     0                    -55417.08853 -20122.714  63.7%     -  268s
H    0     0                    -55415.69945 -20122.714  63.7%     -  268s
     0     0 -20346.620    0  563 -55415.699 -20346.620  63.3%     -  284s
     0     0 -20473.560    0  611 -55415.699 -20473.560  63.1%     -  297s
     0     0 -20497.682    0  605 -55415.699 -20497.682  63.0%     -  307s
     0     0 -20501.151    0  622 -55415.699 -20501.151  63.0%     -  310s
     0     0 -20504.053    0  629 -55415.699 -20504.053  63.0%     -  313s
     0     0 -20508.378    0  625 -55415.699 -20508.378  63.0%     -  315s
     0     0 -20529.669    0  626 -55415.699 -20529.669  63.0%     -  320s
     0     0 -20530.161    0  632 -55415.699 -20530.161  63.0%     -  322s
     0     0 -21950.844    0  620 -55415.699 -21950.844  60.4%     -  402s
H    0     0                    -54806.10735 -21950.942  59.9%     -  403s
H    0     0                    -54435.96192 -21950.942  59.7%     -  403s
     0     0 -22210.574    0  633 -54435.962 -22210.574  59.2%     -  432s
     0     0 -22278.073    0  633 -54435.962 -22278.073  59.1%     -  449s
     0     0 -22405.330    0  630 -54435.962 -22405.330  58.8%     -  467s
     0     0 -22465.409    0  646 -54435.962 -22465.409  58.7%     -  482s
     0     0 -22483.346    0  637 -54435.962 -22483.346  58.7%     -  492s
     0     0 -22554.507    0  658 -54435.962 -22554.507  58.6%     -  513s
     0     0 -22660.174    0  650 -54435.962 -22660.174  58.4%     -  531s
     0     0 -22672.079    0  661 -54435.962 -22672.079  58.4%     -  539s
     0     0 -22676.375    0  670 -54435.962 -22676.375  58.3%     -  544s
     0     0 -22680.983    0  666 -54435.962 -22680.983  58.3%     -  547s
     0     0 -22698.772    0  651 -54435.962 -22698.772  58.3%     -  559s
     0     0 -22703.218    0  653 -54435.962 -22703.218  58.3%     -  563s
     0     0 -22707.504    0  653 -54435.962 -22707.504  58.3%     -  566s
     0     0 -22719.293    0  660 -54435.962 -22719.293  58.3%     -  572s
     0     0 -22753.277    0  663 -54435.962 -22753.277  58.2%     -  579s
     0     0 -22756.871    0  674 -54435.962 -22756.871  58.2%     -  583s
     0     0 -22757.182    0  665 -54435.962 -22757.182  58.2%     -  584s
     0     0 -23431.493    0  714 -54435.962 -23431.493  57.0%     -  646s
     0     0 -23639.839    0  700 -54435.962 -23639.839  56.6%     -  671s
     0     0 -23694.008    0  685 -54435.962 -23694.008  56.5%     -  682s
     0     0 -23708.836    0  692 -54435.962 -23708.836  56.4%     -  690s
     0     0 -23755.993    0  682 -54435.962 -23755.993  56.4%     -  703s
     0     0 -23762.214    0  696 -54435.962 -23762.214  56.3%     -  710s
     0     0 -23780.661    0  689 -54435.962 -23780.661  56.3%     -  717s
     0     0 -23787.033    0  694 -54435.962 -23787.033  56.3%     -  721s
     0     0 -23787.983    0  698 -54435.962 -23787.983  56.3%     -  723s
     0     0 -24037.284    0  698 -54435.962 -24037.284  55.8%     -  752s
H    0     0                    -53554.79730 -24037.536  55.1%     -  753s
H    0     0                    -49358.12998 -24037.536  51.3%     -  753s
H    0     0                    -49310.63550 -24037.536  51.3%     -  753s
H    0     0                    -48921.82585 -24037.536  50.9%     -  753s
H    0     0                    -48891.77767 -24037.536  50.8%     -  753s
     0     0 -24104.815    0  716 -48891.778 -24104.815  50.7%     -  766s
     0     0 -24120.902    0  766 -48891.778 -24120.902  50.7%     -  775s
     0     0 -24140.112    0  729 -48891.778 -24140.112  50.6%     -  783s
     0     0 -24165.091    0  719 -48891.778 -24165.091  50.6%     -  791s
     0     0 -24169.133    0  724 -48891.778 -24169.133  50.6%     -  795s
     0     0 -24176.214    0  725 -48891.778 -24176.214  50.6%     -  799s
     0     0 -24177.235    0  736 -48891.778 -24177.235  50.5%     -  802s
     0     0 -24373.305    0  725 -48891.778 -24373.305  50.1%     -  827s
H    0     0                    -43767.15429 -24373.671  44.3%     -  829s
H    0     0                    -43453.53039 -24373.671  43.9%     -  829s
H    0     0                    -42810.62291 -24373.671  43.1%     -  832s
H    0     0                    -41426.73379 -24373.671  41.2%     -  835s
H    0     0                    -41304.89463 -24373.671  41.0%     -  835s
H    0     0                    -40786.53149 -24373.671  40.2%     -  836s
H    0     0                    -40700.99058 -24373.671  40.1%     -  836s
H    0     0                    -31880.08379 -24373.671  23.5%     -  836s
H    0     0                    -31678.97582 -24373.671  23.1%     -  836s
H    0     0                    -31627.27880 -24373.671  22.9%     -  836s
H    0     0                    -31511.13753 -24373.671  22.7%     -  836s
H    0     0                    -31445.84894 -24373.671  22.5%     -  837s
H    0     0                    -31441.19180 -24373.671  22.5%     -  837s
     0     0 -24499.198    0  718 -31441.192 -24499.198  22.1%     -  858s
     0     0 -24521.682    0  721 -31441.192 -24521.682  22.0%     -  866s
     0     0 -24538.341    0  705 -31441.192 -24538.341  22.0%     -  871s
     0     0 -24543.704    0  757 -31441.192 -24543.704  21.9%     -  876s
     0     0 -24552.214    0  751 -31441.192 -24552.214  21.9%     -  882s
     0     0 -24556.701    0  684 -31441.192 -24556.701  21.9%     -  886s
     0     0 -24558.507    0  704 -31441.192 -24558.507  21.9%     -  889s
     0     0 -24560.056    0  709 -31441.192 -24560.056  21.9%     -  891s
     0     0 -24666.711    0  763 -31441.192 -24666.711  21.5%     -  914s
     0     0 -24713.239    0  769 -31441.192 -24713.239  21.4%     -  927s
     0     0 -24722.903    0  780 -31441.192 -24722.903  21.4%     -  932s
     0     0 -24728.644    0  786 -31441.192 -24728.644  21.3%     -  937s
     0     0 -24730.329    0  784 -31441.192 -24730.329  21.3%     -  940s
     0     0 -24806.455    0  667 -31441.192 -24806.455  21.1%     -  960s
H    0     0                    -31433.12712 -24806.541  21.1%     -  961s
H    0     0                    -31433.12529 -24806.541  21.1%     -  961s
     0     0 -24820.324    0  587 -31433.125 -24820.324  21.0%     -  974s
     0     0 -24824.730    0  598 -31433.125 -24824.730  21.0%     -  980s
     0     0 -24829.020    0  666 -31433.125 -24829.020  21.0%     -  987s
     0     0 -24830.873    0  671 -31433.125 -24830.873  21.0%     -  989s
     0     0 -24831.136    0  672 -31433.125 -24831.136  21.0%     -  990s
     0     0 -24868.254    0  713 -31433.125 -24868.254  20.9%     - 1009s
     0     0 -24876.823    0  721 -31433.125 -24876.823  20.9%     - 1017s
     0     0 -24881.083    0  683 -31433.125 -24881.083  20.8%     - 1021s
     0     0 -24883.138    0  784 -31433.125 -24883.138  20.8%     - 1025s
     0     0 -24884.503    0  785 -31433.125 -24884.503  20.8%     - 1028s
     0     0 -24902.836    0  793 -31433.125 -24902.836  20.8%     - 1041s
H    0     0                    -31410.22933 -24903.231  20.7%     - 1053s
     0     0 -24914.189    0  753 -31410.229 -24914.189  20.7%     - 1061s
     0     0 -24919.796    0  705 -31410.229 -24919.796  20.7%     - 1065s
     0     0 -24922.769    0  750 -31410.229 -24922.769  20.7%     - 1069s
     0     0 -24925.836    0  748 -31410.229 -24925.836  20.6%     - 1073s
     0     0 -24927.600    0  748 -31410.229 -24927.600  20.6%     - 1077s
     0     0 -24936.017    0  691 -31410.229 -24936.017  20.6%     - 1087s
     0     0 -24938.394    0  761 -31410.229 -24938.394  20.6%     - 1091s
     0     0 -24939.614    0  774 -31410.229 -24939.614  20.6%     - 1095s
     0     0 -24963.835    0  759 -31410.229 -24963.835  20.5%     - 1107s
     0     0 -24967.503    0  829 -31410.229 -24967.503  20.5%     - 1116s
     0     0 -24969.858    0  825 -31410.229 -24969.858  20.5%     - 1120s
     0     0 -24971.035    0  824 -31410.229 -24971.035  20.5%     - 1122s
     0     0 -24987.097    0  769 -31410.229 -24987.097  20.4%     - 1136s
     0     0 -24987.928    0  772 -31410.229 -24987.928  20.4%     - 1140s
     0     0 -24998.021    0  774 -31410.229 -24998.021  20.4%     - 1152s
     0     0 -25002.845    0  774 -31410.229 -25002.845  20.4%     - 1203s
     0     0 -25003.777    0  783 -31410.229 -25003.777  20.4%     - 1207s
     0     0 -25006.868    0  793 -31410.229 -25006.868  20.4%     - 1214s
     0     0 -25007.624    0  793 -31410.229 -25007.624  20.4%     - 1224s
     0     2 -25007.624    0  793 -31410.229 -25007.624  20.4%     - 1363s
     1     3 -25234.301    1  494 -31410.229 -25007.624  20.4% 14622 1384s
     2     4 -25056.895    1  757 -31410.229 -25056.895  20.2% 10321 1394s
     3     6 -25082.900    2  697 -31410.229 -25057.004  20.2%  9568 1408s
     5    11 -25653.540    3  482 -31410.229 -25057.004  20.2% 10609 1429s
    10    21 -25941.793    4  490 -31410.229 -25082.983  20.1% 13882 1459s
    20    32 -28615.803    5  191 -31410.229 -25212.556  19.7% 18451 1536s
    31    60 -26563.410    6  442 -31410.229 -25212.556  19.7% 18064 1878s
    59    92 -26705.316    7  410 -31410.229 -25277.977  19.5% 32321 1954s
    91   203 -26740.860    8  422 -31410.229 -25441.651  19.0% 27344 2021s
   204   278 -26813.172   12  415 -31410.229 -25441.651  19.0% 16521 2057s
   281   320 -27027.705   15  407 -31410.229 -25441.651  19.0% 13707 2086s
H  289   320                    -31401.42484 -25441.651  19.0% 13474 2086s
   331   344 -28961.214   16  381 -31401.425 -25441.651  19.0% 12785 2116s
   360   371 -29019.707   17  305 -31401.425 -25441.651  19.0% 12800 2147s
   400   397 -29923.563   18  282 -31401.425 -25441.651  19.0% 12401 2176s
   458   421     cutoff   20      -31401.425 -25570.547  18.6% 12196 2207s
   511   467 -30377.206   21  264 -31401.425 -25570.547  18.6% 11954 2236s
   590   482 infeasible   25      -31401.425 -25570.547  18.6% 11401 2261s
   643   493 -31310.647   26  261 -31401.425 -25570.547  18.6% 11023 2288s
   705   511 -30185.256   19  235 -31401.425 -25570.547  18.6% 10769 2316s
   771   565 infeasible   22      -31401.425 -25570.547  18.6% 10361 2340s
   861   602 -29822.322   16   73 -31401.425 -25570.547  18.6%  9806 2360s
   970   597 -30648.526   22   36 -31401.425 -25570.547  18.6%  9104 2386s
  1072   592     cutoff   24      -31401.425 -25724.680  18.1%  8622 2413s
  1109   605 -29184.824   18  430 -31401.425 -25724.680  18.1%  8659 2440s
  1136   630 -27941.172    7  242 -31401.425 -25724.680  18.1%  8718 2466s
  1197   645 -29930.229    8  136 -31401.425 -25724.680  18.1%  8646 2494s
  1259   691 -30270.964    9   90 -31401.425 -25724.680  18.1%  8732 2519s
  1337   719 -31144.742   16   49 -31401.425 -25724.680  18.1%  8616 2548s
  1429   747 infeasible   20      -31401.425 -25724.680  18.1%  8526 2579s
  1483   768 -28331.484   10  522 -31401.425 -25875.308  17.6%  8641 2639s
  1522   781 -28525.357   11  482 -31401.425 -25875.308  17.6%  8716 2671s
  1575   794 infeasible   26      -31401.425 -25875.308  17.6%  8731 2708s
  1622   795 -30314.893   10  422 -31401.425 -25926.551  17.4%  8738 2744s
  1655   807 -29751.213   11  416 -31401.425 -25926.551  17.4%  8762 2783s
  1689   800 -30595.422   12  491 -31401.425 -25926.551  17.4%  8807 2819s
  1740   810     cutoff   11      -31401.425 -26093.093  16.9%  8871 2857s
  1794   830     cutoff   12      -31401.425 -26093.093  16.9%  8939 2896s
  1830   842 -31334.441   12  464 -31401.425 -26093.093  16.9%  9156 2933s
  1872   858 infeasible   13      -31401.425 -26093.093  16.9%  9307 2974s
  1925   874 -30636.013   15  452 -31401.425 -26202.555  16.6%  9435 3019s
  2012   899 infeasible   16      -31401.425 -26202.555  16.6%  9505 3067s
  2088   921 -31037.669   12  373 -31401.425 -26202.555  16.6%  9584 3118s
  2170   950 infeasible   13      -31401.425 -26330.043  16.2%  9708 3160s
  2267   997 -28551.186    9  370 -31401.425 -26330.980  16.1%  9730 3210s
  2396  1044 infeasible   10      -31401.425 -26330.980  16.1%  9720 3270s
  2516  1077 -29693.318   11  328 -31401.425 -26330.980  16.1%  9756 3331s
  2645  1088 -30434.126   12  284 -31401.425 -26330.980  16.1%  9779 3392s
  2748  1100     cutoff   13      -31401.425 -26462.876  15.7%  9928 3455s
  2835  1141 -29499.178   11  108 -31401.425 -26494.543  15.6% 10040 3519s
  2955  1167 -27658.858   11  314 -31401.425 -26494.543  15.6% 10111 3585s
  3053  1160     cutoff   18      -31401.425 -26494.543  15.6% 10303 3600s

Cutting planes:
  Gomory: 1
  Implied bound: 237
  MIR: 4095
  Flow cover: 6479
  Zero half: 18
  RLT: 133
  Relax-and-lift: 1081

Explored 3090 nodes (32627840 simplex iterations) in 3600.11 seconds (8712.21 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31401.4 -31410.2 -31433.1 ... -31880.1

Time limit reached
Best objective -3.140142483856e+04, best bound -2.649454326874e+04, gap 15.6263%
  WARNING: Time limit reached. Using best solution found (gap: 15.63%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = -31401.42, θ = 93241.48
  Upper Bound (UB) = -31401.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93241.48
  [DEBUG]   ✓ Scenario 0: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93241.48 ≤ Q = 93241.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93241.48 ≤ Q = 93241.48 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3d17ffe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x03d17ffe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177653e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5443555.4397
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.242529e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124252.93    0  124 5443555.44 -124252.93   102%     -    0s
H    0     0                    -90334.50625 -124252.93  37.5%     -    0s
H    0     0                    -90893.18638 -124252.93  36.7%     -    0s
     0     0 -95099.354    0   35 -90893.186 -95099.354  4.63%     -    0s
H    0     0                    -93766.40889 -95009.966  1.33%     -    0s
     0     0 -94861.746    0   35 -93766.409 -94861.746  1.17%     -    0s
H    0     0                    -94215.86799 -94857.296  0.68%     -    0s
H    0     0                    -94438.07607 -94857.296  0.44%     -    0s
     0     0 -94735.225    0   23 -94438.076 -94735.225  0.31%     -    0s
     0     0 -94712.668    0   20 -94438.076 -94712.668  0.29%     -    0s
     0     0 -94691.504    0   18 -94438.076 -94691.504  0.27%     -    0s
     0     0 -94683.958    0   15 -94438.076 -94683.958  0.26%     -    0s
     0     0 -94665.854    0   14 -94438.076 -94665.854  0.24%     -    0s
     0     0 -94606.400    0   18 -94438.076 -94606.400  0.18%     -    0s
     0     0 -94575.983    0   15 -94438.076 -94575.983  0.15%     -    0s
     0     0 -94541.595    0   13 -94438.076 -94541.595  0.11%     -    0s
     0     0 -94502.379    0   14 -94438.076 -94502.379  0.07%     -    0s
     0     0 -94488.338    0    8 -94438.076 -94488.338  0.05%     -    0s
     0     0 -94475.128    0    5 -94438.076 -94475.128  0.04%     -    0s
     0     0 -94450.018    0    3 -94438.076 -94450.018  0.01%     -    0s
     0     0 -94443.026    0    5 -94438.076 -94443.026  0.01%     -    0s
     0     0 -94442.803    0    3 -94438.076 -94442.803  0.01%     -    0s
H    0     0                    -94438.47118 -94442.803  0.00%     -    0s
     0     0 -94438.555    0    2 -94438.471 -94438.555  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 2

Explored 1 nodes (485 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -94438.5 -94438.1 -94410.6 ... 1.17765e+13

Optimal solution found (tolerance 1.00e-06)
Best objective -9.443847118025e+04, best bound -9.443855534096e+04, gap 0.0001%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 92398.93
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94438.47
  [DEBUG]   S×d_nominal = 186837.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186837.40 + -94438.47 = 92398.93
  [DEBUG]   Current θ from Master = 93241.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 842.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -32243.98
  Lower Bound (LB) = -32243.98
  Gap (UB-LB) = 842.5552, Absolute Gap = 842.5552, Relative Gap = 0.026832
  Not converged yet (gap = 842.56 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870139 nonzeros
Model fingerprint: 0x8d15facf
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141400 rows and 57400 columns
Presolve time: 3.33s
Presolved: 165783 rows, 69660 columns, 1020213 nonzeros
Variable types: 67401 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.29s

Barrier statistics:
 Dense cols : 1154
 AA' NZ     : 3.996e+06
 Factor NZ  : 1.118e+07 (roughly 200 MB of memory)
 Factor Ops : 3.749e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.38251281e+07  2.78098166e+08  7.17e+04 1.45e+01  5.72e+04     6s
   1  -1.07351374e+07  2.31454614e+08  4.99e+04 4.92e+01  3.94e+04     6s
   2  -5.02789841e+06  1.81233438e+08  2.22e+04 1.09e+01  1.82e+04     6s
   3  -7.66261797e+05  1.18553968e+08  1.33e+03 1.99e+00  1.41e+03     6s
   4  -5.37498354e+05  6.49170124e+07  4.27e+02 9.30e-01  5.21e+02     7s
   5  -4.65149223e+05  4.24204184e+07  2.28e+02 5.35e-01  2.92e+02     7s
   6  -4.02419953e+05  3.15806762e+07  1.15e+02 3.63e-01  1.76e+02     7s
   7  -3.01464951e+05  2.30518474e+07  2.68e+01 2.44e-01  9.17e+01     7s
   8  -1.92482363e+05  1.59473784e+07  3.77e+00 1.64e-01  5.50e+01     7s
   9  -1.51384133e+05  1.15121950e+06  2.13e+00 7.54e-03  4.43e+00     7s
  10  -1.02844112e+05  6.72086323e+05  9.86e-01 4.47e-03  2.60e+00     7s
  11  -8.90880089e+04  4.66075887e+05  6.90e-01 3.17e-03  1.86e+00     7s
  12  -7.30872108e+04  2.57333791e+05  4.15e-01 1.80e-03  1.10e+00     7s
  13  -5.49667960e+04  1.42268178e+05  2.31e-01 1.04e-03  6.56e-01     7s
  14  -4.44621355e+04  7.98754591e+04  1.57e-01 9.05e-04  4.13e-01     7s
  15  -3.97608430e+04  5.56169635e+04  1.28e-01 1.25e-03  3.17e-01     7s
  16  -3.47262892e+04  3.33865320e+04  9.90e-02 2.26e-03  2.26e-01     7s
  17  -3.21614774e+04  2.26986924e+04  8.50e-02 1.67e-03  1.82e-01     8s
  18  -2.77559554e+04  1.09741736e+04  6.16e-02 4.54e-03  1.29e-01     8s
  19  -2.51620748e+04  6.77039993e+02  4.82e-02 2.18e-03  8.59e-02     8s
  20  -2.24986430e+04 -1.49627891e+03  3.67e-02 1.71e-03  6.98e-02     8s
  21  -2.13406583e+04 -5.09039166e+03  3.15e-02 1.19e-03  5.40e-02     8s
  22  -1.95222019e+04 -6.82489080e+03  2.38e-02 1.93e-03  4.22e-02     8s
  23  -1.85292596e+04 -7.97763429e+03  1.97e-02 1.82e-03  3.51e-02     8s
  24  -1.74474480e+04 -8.40421001e+03  1.54e-02 1.66e-03  3.00e-02     8s
  25  -1.62546418e+04 -9.38376037e+03  1.09e-02 1.31e-03  2.28e-02     8s
  26  -1.57139570e+04 -1.02970367e+04  8.85e-03 9.68e-04  1.80e-02     8s
  27  -1.50522443e+04 -1.08311465e+04  6.52e-03 7.76e-04  1.40e-02     8s
  28  -1.48463651e+04 -1.12853658e+04  5.76e-03 6.19e-04  1.18e-02     9s
  29  -1.44522410e+04 -1.17700373e+04  4.45e-03 4.43e-04  8.91e-03     9s
  30  -1.42531990e+04 -1.20433240e+04  3.78e-03 3.51e-04  7.34e-03     9s
  31  -1.42063686e+04 -1.22510912e+04  3.63e-03 2.80e-04  6.49e-03     9s
  32  -1.41103401e+04 -1.23690622e+04  3.33e-03 2.36e-04  5.78e-03     9s
  33  -1.39110382e+04 -1.24779376e+04  2.70e-03 1.98e-04  4.76e-03     9s
  34  -1.37147352e+04 -1.25512004e+04  2.06e-03 1.72e-04  3.86e-03     9s
  35  -1.36890382e+04 -1.25925643e+04  1.97e-03 1.58e-04  3.64e-03     9s
  36  -1.35739620e+04 -1.26683965e+04  1.59e-03 1.32e-04  3.01e-03     9s
  37  -1.35290409e+04 -1.27240233e+04  1.45e-03 1.13e-04  2.67e-03    10s
  38  -1.34642899e+04 -1.27572642e+04  1.23e-03 1.01e-04  2.35e-03    10s
  39  -1.34476176e+04 -1.27817284e+04  1.18e-03 9.23e-05  2.21e-03    10s
  40  -1.34035973e+04 -1.28481296e+04  1.05e-03 6.82e-05  1.85e-03    10s
  41  -1.33517383e+04 -1.28998117e+04  8.94e-04 6.19e-05  1.50e-03    10s
  42  -1.32340410e+04 -1.29183998e+04  5.51e-04 5.48e-05  1.05e-03    10s
  43  -1.31821840e+04 -1.29433199e+04  3.91e-04 4.42e-05  7.93e-04    10s
  44  -1.31573303e+04 -1.29517820e+04  3.19e-04 4.04e-05  6.82e-04    10s
  45  -1.31409367e+04 -1.29634283e+04  2.74e-04 3.52e-05  5.89e-04    10s
  46  -1.31234362e+04 -1.29785280e+04  2.26e-04 2.81e-05  4.81e-04    11s
  47  -1.30866143e+04 -1.29991935e+04  1.18e-04 1.87e-05  2.90e-04    11s
  48  -1.30731787e+04 -1.30125492e+04  8.23e-05 1.27e-05  2.01e-04    11s
  49  -1.30552288e+04 -1.30318726e+04  3.40e-05 4.10e-06  7.75e-05    11s
  50  -1.30544014e+04 -1.30334826e+04  3.18e-05 3.44e-06  6.94e-05    11s
  51  -1.30498284e+04 -1.30347775e+04  2.00e-05 2.89e-06  4.99e-05    11s
  52  -1.30451769e+04 -1.30374196e+04  8.03e-06 1.79e-06  2.57e-05    11s
  53  -1.30440273e+04 -1.30386349e+04  5.17e-06 1.28e-06  1.79e-05    11s
  54  -1.30438986e+04 -1.30388505e+04  4.89e-06 1.18e-06  1.67e-05    11s
  55  -1.30436082e+04 -1.30394346e+04  4.21e-06 9.40e-07  1.38e-05    12s
  56  -1.30433784e+04 -1.30396552e+04  3.67e-06 8.52e-07  1.24e-05    12s
  57  -1.30423640e+04 -1.30402238e+04  1.49e-06 6.09e-07  7.09e-06    12s
  58  -1.30423102e+04 -1.30409629e+04  1.37e-06 4.77e-07  4.47e-06    12s
  59  -1.30422050e+04 -1.30410427e+04  1.14e-06 4.23e-07  3.86e-06    12s
  60  -1.30417761e+04 -1.30412648e+04  1.58e-07 2.67e-07  1.69e-06    12s
  61  -1.30417605e+04 -1.30412669e+04  1.28e-05 2.66e-07  1.64e-06    12s
  62  -1.30417088e+04 -1.30415569e+04  5.58e-06 5.18e-08  5.04e-07    12s
  63  -1.30416915e+04 -1.30415868e+04  3.49e-06 2.66e-07  3.47e-07    13s
  64  -1.30416826e+04 -1.30416123e+04  2.36e-06 1.76e-07  2.33e-07    13s
  65  -1.30416662e+04 -1.30416533e+04  3.97e-07 2.97e-08  4.28e-08    13s
  66  -1.30416654e+04 -1.30416550e+04  3.25e-07 2.43e-08  3.47e-08    13s
  67  -1.30416637e+04 -1.30416617e+04  1.52e-07 9.08e-09  6.52e-09    13s
  68  -1.30416636e+04 -1.30416617e+04  1.67e-07 1.05e-08  6.49e-09    13s
  69  -1.30416636e+04 -1.30416617e+04  7.34e-07 4.10e-08  6.30e-09    13s
  70  -1.30416635e+04 -1.30416617e+04  2.30e-06 1.14e-07  5.84e-09    13s
  71  -1.30416633e+04 -1.30416618e+04  6.74e-06 1.49e-07  5.11e-09    13s
  72  -1.30416626e+04 -1.30416618e+04  9.81e-06 1.86e-07  3.75e-09    14s
  73  -1.30416626e+04 -1.30416618e+04  9.21e-06 1.83e-07  3.54e-09    14s
  74  -1.30416626e+04 -1.30416618e+04  8.48e-06 1.69e-07  3.25e-09    14s
  75  -1.30416622e+04 -1.30416619e+04  2.04e-06 1.19e-07  1.03e-09    14s
  76  -1.30416622e+04 -1.30416619e+04  1.70e-06 1.09e-07  9.02e-10    14s
  77  -1.30416622e+04 -1.30416619e+04  1.74e-06 1.02e-07  8.62e-10    14s
  78  -1.30416622e+04 -1.30416619e+04  1.66e-06 9.54e-08  8.07e-10    14s
  79  -1.30416621e+04 -1.30416620e+04  1.26e-06 3.46e-08  5.42e-10    14s
  80  -1.30416621e+04 -1.30416620e+04  1.27e-06 3.44e-08  5.37e-10    14s
  81  -1.30416621e+04 -1.30416620e+04  1.44e-06 3.42e-08  5.26e-10    15s

Barrier solved model in 81 iterations and 14.61 seconds (21.69 work units)
Optimal objective -1.30416621e+04


Root crossover log...

  131591 DPushes remaining with DInf 0.0000000e+00                15s
   71859 DPushes remaining with DInf 0.0000000e+00                15s
   23001 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                23s

   28504 PPushes remaining with PInf 2.3283205e-04                23s
    3301 PPushes remaining with PInf 1.1846643e-04                25s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.6333032e+02     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   96266   -1.3041662e+04   0.000000e+00   5.633303e+02     26s
   96801   -1.3041662e+04   0.000000e+00   0.000000e+00     26s
   96801   -1.3041662e+04   0.000000e+00   0.000000e+00     27s
Concurrent spin time: 4.98s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -1.304166e+04, 96801 iterations, 27.32 seconds (47.61 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13041.662    0  437 -201924.56 -13041.662  93.5%     -   32s
H    0     0                    -136016.9794 -13041.662  90.4%     -   33s
H    0     0                    -127918.2495 -13041.662  89.8%     -   33s
H    0     0                    -127860.0189 -13041.662  89.8%     -   34s
H    0     0                    -127828.0681 -13041.662  89.8%     -   34s
H    0     0                    -127638.5664 -13041.662  89.8%     -   34s
H    0     0                    -101214.4030 -13041.662  87.1%     -   34s
H    0     0                    -68205.39037 -13041.662  80.9%     -   34s
H    0     0                    -63987.15749 -13041.662  79.6%     -   34s
H    0     0                    -63974.85640 -13041.662  79.6%     -   34s
     0     0 -17521.573    0  570 -63974.856 -17521.573  72.6%     -   99s
     0     0 -17521.758    0  569 -63974.856 -17521.758  72.6%     -  100s
H    0     0                    -61215.49154 -17522.133  71.4%     -  100s
H    0     0                    -58616.90412 -17522.133  70.1%     -  101s
H    0     0                    -56497.80316 -17522.133  69.0%     -  101s
H    0     0                    -56491.59594 -17522.133  69.0%     -  101s
H    0     0                    -55530.42876 -17522.133  68.4%     -  101s
H    0     0                    -55507.45778 -17522.133  68.4%     -  101s
H    0     0                    -55480.09367 -17522.133  68.4%     -  101s
H    0     0                    -55476.71556 -17522.133  68.4%     -  101s
H    0     0                    -55464.93951 -17522.133  68.4%     -  101s
     0     0 -17811.588    0  609 -55464.940 -17811.588  67.9%     -  118s
     0     0 -17814.655    0  613 -55464.940 -17814.655  67.9%     -  121s
     0     0 -17856.824    0  612 -55464.940 -17856.824  67.8%     -  127s
     0     0 -17858.780    0  618 -55464.940 -17858.780  67.8%     -  128s
     0     0 -17862.797    0  615 -55464.940 -17862.797  67.8%     -  130s
     0     0 -17866.697    0  612 -55464.940 -17866.697  67.8%     -  132s
     0     0 -17885.268    0  623 -55464.940 -17885.268  67.8%     -  136s
     0     0 -17885.507    0  622 -55464.940 -17885.507  67.8%     -  137s
     0     0 -20150.187    0  552 -55464.940 -20150.187  63.7%     -  199s
H    0     0                    -55405.32700 -20150.580  63.6%     -  200s
     0     0 -20500.955    0  602 -55405.327 -20500.955  63.0%     -  222s
     0     0 -20585.947    0  600 -55405.327 -20585.947  62.8%     -  233s
     0     0 -20689.609    0  615 -55405.327 -20689.609  62.7%     -  246s
     0     0 -20703.409    0  608 -55405.327 -20703.409  62.6%     -  252s
     0     0 -20710.042    0  606 -55405.327 -20710.042  62.6%     -  256s
     0     0 -20722.079    0  603 -55405.327 -20722.079  62.6%     -  260s
     0     0 -20727.188    0  605 -55405.327 -20727.188  62.6%     -  263s
     0     0 -20764.985    0  599 -55405.327 -20764.985  62.5%     -  273s
     0     0 -20767.920    0  607 -55405.327 -20767.920  62.5%     -  276s
     0     0 -20809.803    0  541 -55405.327 -20809.803  62.4%     -  282s
     0     0 -20818.877    0  541 -55405.327 -20818.877  62.4%     -  285s
     0     0 -20861.858    0  555 -55405.327 -20861.858  62.3%     -  292s
     0     0 -20879.690    0  555 -55405.327 -20879.690  62.3%     -  298s
     0     0 -20880.799    0  551 -55405.327 -20880.799  62.3%     -  299s
     0     0 -20892.962    0  616 -55405.327 -20892.962  62.3%     -  304s
     0     0 -20894.379    0  675 -55405.327 -20894.379  62.3%     -  307s
     0     0 -20894.450    0  676 -55405.327 -20894.450  62.3%     -  309s
     0     0 -21937.026    0  727 -55405.327 -21937.026  60.4%     -  378s
H    0     0                    -55378.48571 -21937.066  60.4%     -  379s
     0     0 -22261.627    0  714 -55378.486 -22261.627  59.8%     -  421s
     0     0 -22680.714    0  715 -55378.486 -22680.714  59.0%     -  449s
     0     0 -22785.592    0  675 -55378.486 -22785.592  58.9%     -  472s
     0     0 -22816.713    0  715 -55378.486 -22816.713  58.8%     -  486s
     0     0 -22848.220    0  725 -55378.486 -22848.220  58.7%     -  495s
     0     0 -22880.109    0  633 -55378.486 -22880.109  58.7%     -  507s
     0     0 -22897.760    0  637 -55378.486 -22897.760  58.7%     -  514s
     0     0 -22902.179    0  573 -55378.486 -22902.179  58.6%     -  518s
     0     0 -22954.667    0  623 -55378.486 -22954.667  58.5%     -  532s
     0     0 -22957.398    0  626 -55378.486 -22957.398  58.5%     -  537s
     0     0 -22994.659    0  715 -55378.486 -22994.659  58.5%     -  549s
     0     0 -23006.996    0  665 -55378.486 -23006.996  58.5%     -  555s
     0     0 -23010.192    0  671 -55378.486 -23010.192  58.4%     -  558s
     0     0 -23029.022    0  680 -55378.486 -23029.022  58.4%     -  565s
     0     0 -23030.460    0  741 -55378.486 -23030.460  58.4%     -  567s
     0     0 -23031.603    0  685 -55378.486 -23031.603  58.4%     -  569s
     0     0 -23519.675    0  699 -55378.486 -23519.675  57.5%     -  624s
     0     0 -23749.164    0  695 -55378.486 -23749.164  57.1%     -  659s
     0     0 -23843.292    0  705 -55378.486 -23843.292  56.9%     -  675s
     0     0 -23932.300    0  703 -55378.486 -23932.300  56.8%     -  690s
     0     0 -23945.794    0  708 -55378.486 -23945.794  56.8%     -  698s
     0     0 -23975.019    0  712 -55378.486 -23975.019  56.7%     -  707s
     0     0 -24014.539    0  714 -55378.486 -24014.539  56.6%     -  717s
     0     0 -24030.137    0  719 -55378.486 -24030.137  56.6%     -  722s
     0     0 -24032.557    0  760 -55378.486 -24032.557  56.6%     -  725s
     0     0 -24053.408    0  770 -55378.486 -24053.408  56.6%     -  730s
     0     0 -24063.157    0  732 -55378.486 -24063.157  56.5%     -  734s
     0     0 -24072.162    0  745 -55378.486 -24072.162  56.5%     -  741s
     0     0 -24074.601    0  740 -55378.486 -24074.601  56.5%     -  743s
     0     0 -24103.243    0  732 -55378.486 -24103.243  56.5%     -  752s
     0     0 -24108.716    0  737 -55378.486 -24108.716  56.5%     -  757s
     0     0 -24111.054    0  737 -55378.486 -24111.054  56.5%     -  759s
     0     0 -24112.758    0  731 -55378.486 -24112.758  56.5%     -  761s
     0     0 -24118.936    0  740 -55378.486 -24118.936  56.4%     -  763s
     0     0 -24119.433    0  734 -55378.486 -24119.433  56.4%     -  765s
     0     0 -24416.121    0  636 -55378.486 -24416.121  55.9%     -  792s
     0     0 -24448.905    0  641 -55378.486 -24448.905  55.9%     -  804s
     0     0 -24468.069    0  677 -55378.486 -24468.069  55.8%     -  811s
     0     0 -24477.631    0  769 -55378.486 -24477.631  55.8%     -  817s
     0     0 -24481.055    0  678 -55378.486 -24481.055  55.8%     -  821s
     0     0 -24496.400    0  648 -55378.486 -24496.400  55.8%     -  826s
     0     0 -24498.085    0  680 -55378.486 -24498.085  55.8%     -  828s
     0     0 -24595.715    0  770 -55378.486 -24595.715  55.6%     -  850s
H    0     0                    -50380.93022 -24596.108  51.2%     -  854s
H    0     0                    -47864.76701 -24596.108  48.6%     -  854s
H    0     0                    -47701.06568 -24596.108  48.4%     -  855s
H    0     0                    -47629.84324 -24596.108  48.4%     -  855s
H    0     0                    -45752.78916 -24596.108  46.2%     -  855s
H    0     0                    -39113.54197 -24596.108  37.1%     -  856s
H    0     0                    -38777.74990 -24596.108  36.6%     -  856s
H    0     0                    -38619.58307 -24596.108  36.3%     -  856s
H    0     0                    -38589.06969 -24596.108  36.3%     -  857s
     0     0 -24669.504    0  778 -38589.070 -24669.504  36.1%     -  873s
     0     0 -24686.322    0  792 -38589.070 -24686.322  36.0%     -  880s
     0     0 -24698.738    0  811 -38589.070 -24698.738  36.0%     -  889s
     0     0 -24703.637    0  773 -38589.070 -24703.637  36.0%     -  894s
     0     0 -24705.416    0  774 -38589.070 -24705.416  36.0%     -  898s
     0     0 -24707.464    0  815 -38589.070 -24707.464  36.0%     -  903s
     0     0 -24708.547    0  804 -38589.070 -24708.547  36.0%     -  905s
     0     0 -24800.748    0  736 -38589.070 -24800.748  35.7%     -  927s
H    0     0                    -38578.86658 -24801.241  35.7%     -  927s
     0     0 -24834.357    0  738 -38578.867 -24834.357  35.6%     -  938s
     0     0 -24853.289    0  746 -38578.867 -24853.289  35.6%     -  946s
     0     0 -24861.751    0  744 -38578.867 -24861.751  35.6%     -  951s
     0     0 -24864.541    0  749 -38578.867 -24864.541  35.5%     -  954s
     0     0 -24865.379    0  751 -38578.867 -24865.379  35.5%     -  957s
     0     0 -24911.106    0  792 -38578.867 -24911.106  35.4%     -  977s
H    0     0                    -38578.86475 -24911.223  35.4%     -  979s
     0     0 -24926.583    0  800 -38578.865 -24926.583  35.4%     -  988s
     0     0 -24937.403    0  813 -38578.865 -24937.403  35.4%     -  998s
     0     0 -24947.515    0  818 -38578.865 -24947.515  35.3%     - 1005s
     0     0 -24949.596    0  820 -38578.865 -24949.596  35.3%     - 1009s
     0     0 -24959.367    0  817 -38578.865 -24959.367  35.3%     - 1016s
     0     0 -24962.147    0  804 -38578.865 -24962.147  35.3%     - 1019s
     0     0 -24963.184    0  818 -38578.865 -24963.184  35.3%     - 1021s
     0     0 -24988.977    0  812 -38578.865 -24988.977  35.2%     - 1034s
H    0     0                    -38523.27385 -24989.000  35.1%     - 1034s
     0     0 -24995.242    0  764 -38523.274 -24995.242  35.1%     - 1039s
     0     0 -24997.724    0  807 -38523.274 -24997.724  35.1%     - 1042s
     0     0 -24998.418    0  806 -38523.274 -24998.418  35.1%     - 1043s
     0     0 -25016.783    0  807 -38523.274 -25016.783  35.1%     - 1055s
     0     0 -25023.293    0  824 -38523.274 -25023.293  35.0%     - 1067s
     0     0 -25026.589    0  824 -38523.274 -25026.589  35.0%     - 1071s
     0     0 -25028.224    0  827 -38523.274 -25028.224  35.0%     - 1073s
     0     0 -25043.392    0  808 -38523.274 -25043.392  35.0%     - 1085s
     0     0 -25047.144    0  829 -38523.274 -25047.144  35.0%     - 1090s
     0     0 -25047.969    0  831 -38523.274 -25047.969  35.0%     - 1093s
     0     0 -25056.204    0  779 -38523.274 -25056.204  35.0%     - 1103s
     0     0 -25058.801    0  837 -38523.274 -25058.801  35.0%     - 1110s
     0     0 -25060.303    0  787 -38523.274 -25060.303  34.9%     - 1113s
     0     0 -25062.176    0  837 -38523.274 -25062.176  34.9%     - 1121s
     0     0 -25062.235    0  837 -38523.274 -25062.235  34.9%     - 1130s
H    0     0                    -32268.43295 -25062.324  22.3%     - 1254s
H    0     0                    -31984.41590 -25062.324  21.6%     - 1254s
H    0     0                    -31984.41406 -25062.324  21.6%     - 1256s
H    0     0                    -31943.48232 -25062.324  21.5%     - 1256s
     0     2 -25062.324    0  837 -31943.482 -25062.324  21.5%     - 1259s
     1     3 -25172.590    1  750 -31943.482 -25062.324  21.5% 13125 1279s
     2     4 -25153.146    1  770 -31943.482 -25153.146  21.3% 11226 1290s
     3     6 -25665.517    2  487 -31943.482 -25153.205  21.3% 10757 1312s
     5    10 -25908.214    3  502 -31943.482 -25153.205  21.3% 11536 1336s
     9    18 -25935.707    4  502 -31943.482 -25226.685  21.0% 10735 1384s
    17    27 -29955.351    5  172 -31943.482 -25226.685  21.0% 11983 1476s
    26    54 -29163.438    4  262 -31943.482 -25262.408  20.9% 15447 1684s
H   27    54                    -31873.59545 -25262.408  20.7% 14875 1684s
H   29    54                    -31817.21386 -25262.408  20.6% 15218 1684s
H   30    54                    -31739.10520 -25262.408  20.4% 15775 1684s
H   53    84                    -31738.01245 -25312.494  20.2% 51612 1745s
H   54    84                    -31730.37027 -25312.494  20.2% 50796 1745s
H   55    84                    -31599.78669 -25312.494  19.9% 49982 1745s
H   57    84                    -31582.56154 -25312.494  19.9% 48475 1745s
H   64    84                    -31557.99470 -25312.494  19.8% 44143 1745s
H   85   115                    -31553.33756 -25339.933  19.7% 36264 1801s
H   90   115                    -31413.66868 -25339.933  19.3% 34638 1801s
   116   187 -29710.340    7  248 -31413.669 -25340.705  19.3% 29079 1859s
H  144   187                    -31409.01154 -25340.705  19.3% 24358 1859s
H  175   187                    -31406.51103 -25340.705  19.3% 21009 1859s
   204   245 infeasible    9      -31406.511 -25340.705  19.3% 19200 1901s
H  284   267                    -31398.10522 -25340.705  19.3% 15010 1949s
   345   289 infeasible   14      -31398.105 -25496.710  18.8% 13227 1986s
   400   305 -28360.507   17  556 -31398.105 -25496.710  18.8% 12025 2020s
   450   312 -28563.802   19  548 -31398.105 -25496.710  18.8% 11207 2057s
   492   328 -26949.215   12  568 -31398.105 -25496.710  18.8% 10731 2092s
   527   364 -27152.765   13  545 -31398.105 -25496.710  18.8% 10367 2126s
   569   425 -27217.266   16  600 -31398.105 -25496.710  18.8%  9978 2161s
   636   487 -27307.547   16  718 -31398.105 -25496.710  18.8%  9344 2193s
   724   527 -27305.862   17  590 -31398.105 -25496.710  18.8%  8533 2217s
   812   572 -27743.596   18  456 -31398.105 -25496.710  18.8%  7918 2244s
   916   582 -28412.627   19  337 -31398.105 -25496.710  18.8%  7285 2276s
   998   569 infeasible   20      -31398.105 -25576.167  18.5%  6960 2308s
  1058   582 -27388.728   18  578 -31398.105 -25670.618  18.2%  6706 2343s
  1079   617 -27307.875    9  401 -31398.105 -25670.618  18.2%  6720 2374s
  1124   618     cutoff   10      -31398.105 -25670.618  18.2%  6601 2411s
  1196   624 -27483.205   10  448 -31398.105 -25670.618  18.2%  6372 2450s
  1226   634 -26959.464    9  492 -31398.105 -25726.155  18.1%  6344 2488s
  1248   651 -27589.645   10  463 -31398.105 -25797.711  17.8%  6392 2528s
  1273   661 -27735.281   11  452 -31398.105 -25874.690  17.6%  6430 2570s
  1299   673 infeasible   11      -31398.105 -25905.054  17.5%  6451 2612s
  1325   682 -27507.966   11  312 -31398.105 -25905.054  17.5%  6501 2652s
  1352   703 -27587.404   12  299 -31398.105 -25905.581  17.5%  6482 2697s
  1387   730 -29358.068    9  161 -31398.105 -26410.531  15.9%  6489 2739s
  1440   753 infeasible   14      -31398.105 -26410.531  15.9%  6503 2785s
  1513   759 -28713.630   19  420 -31398.105 -26410.531  15.9%  6466 2828s
  1580   764 -28820.648   20  424 -31398.105 -26410.531  15.9%  6430 2877s
  1641   783 infeasible   22      -31398.105 -26509.447  15.6%  6387 2931s
  1686   806 -28857.695   11  450 -31398.105 -26509.447  15.6%  6419 2990s
  1735   834 -29015.748   15  292 -31398.105 -26509.447  15.6%  6452 3051s
  1790   860 -29074.478   16  254 -31398.105 -26509.447  15.6%  6434 3110s
  1840   903 -29425.947   17  251 -31398.105 -26509.447  15.6%  6455 3173s
  1927   949 -30382.314   22  311 -31398.105 -26509.447  15.6%  6459 3234s
  2042   961 infeasible   22      -31398.105 -26657.488  15.1%  6388 3290s
  2088   961 -27206.223   11  490 -31398.105 -26684.608  15.0%  6395 3341s
  2140   973 -30300.506    7  139 -31398.105 -26684.608  15.0%  6404 3405s
  2194  1000 -28068.871   12  536 -31398.105 -26684.608  15.0%  6419 3469s
  2274  1029 -29951.387   13  357 -31398.105 -26684.608  15.0%  6410 3545s
  2355  1064 -28428.381   13  532 -31398.105 -26684.608  15.0%  6394 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 286
  MIR: 4307
  Flow cover: 6108
  Zero half: 14
  RLT: 125
  Relax-and-lift: 919

Explored 2465 nodes (16569313 simplex iterations) in 3600.07 seconds (8010.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31398.1 -31406.5 -31409 ... -31738

Time limit reached
Best objective -3.139810522255e+04, best bound -2.668460793175e+04, gap 15.0120%
  WARNING: Time limit reached. Using best solution found (gap: 15.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -31398.11, θ = 93585.25
  Upper Bound (UB) = -31398.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93585.25
  [DEBUG]   ✓ Scenario 0: θ = 93585.25 ≤ Q = 93585.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93585.25 ≤ Q = 93585.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93585.25 ≤ Q = 93585.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93585.25 ≤ Q = 93585.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93585.25 ≤ Q = 93585.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93585.25 ≤ Q = 93585.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 93585.25 ≤ Q = 93585.25 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x75caace3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8a35531d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177514e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5502109.9330
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.237401e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123740.09    0  124 5502109.93 -123740.09   102%     -    0s
H    0     0                    -89894.65225 -123740.09  37.7%     -    0s
H    0     0                    -90453.33238 -123740.09  36.8%     -    0s
H    0     0                    -93100.38610 -95731.795  2.83%     -    0s
     0     0 -95731.795    0   66 -93100.386 -95731.795  2.83%     -    0s
H    0     0                    -93388.46126 -95710.134  2.49%     -    0s
H    0     0                    -93799.85394 -95710.134  2.04%     -    0s
H    0     0                    -94087.92910 -95710.134  1.72%     -    0s
     0     0 -95292.363    0   67 -94087.929 -95292.363  1.28%     -    0s
     0     0 -95048.557    0   69 -94087.929 -95048.557  1.02%     -    0s
     0     0 -95044.178    0   62 -94087.929 -95044.178  1.02%     -    0s
     0     0 -94854.699    0   70 -94087.929 -94854.699  0.81%     -    0s
     0     0 -94851.780    0   70 -94087.929 -94851.780  0.81%     -    0s
     0     2 -94844.452    0   70 -94087.929 -94844.452  0.80%     -    0s
H   37    19                    -94152.10951 -94583.578  0.46%  12.6    0s
H   40    19                    -94197.01407 -94583.578  0.41%  12.8    0s
H   92    56                    -94212.43639 -94550.658  0.36%   9.3    0s
H  112    56                    -94248.45123 -94500.381  0.27%   8.4    0s
*  259    65              14    -94263.87354 -94492.296  0.24%   6.4    0s

Cutting planes:
  Gomory: 31
  Implied bound: 4
  MIR: 206
  RLT: 1

Explored 551 nodes (4062 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -94263.9 -94248.5 -94212.4 ... 5.50211e+06
No other solutions better than -94263.9

Optimal solution found (tolerance 1.00e-06)
Best objective -9.426387354415e+04, best bound -9.426387354415e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 92436.02
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94263.87
  [DEBUG]   S×d_nominal = 186699.89
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186699.89 + -94263.87 = 92436.02
  [DEBUG]   Current θ from Master = 93585.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1149.23 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -32547.33
  Lower Bound (LB) = -32243.98
  Gap (UB-LB) = 845.8748, Absolute Gap = 845.8748, Relative Gap = 0.026940
  Not converged yet (gap = 845.87 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913370 nonzeros
Model fingerprint: 0xcbd798e3
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 148470 rows and 60270 columns
Presolve time: 3.50s
Presolved: 174003 rows, 73030 columns, 1070751 nonzeros
Variable types: 70771 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.33s

Barrier statistics:
 Dense cols : 1154
 AA' NZ     : 4.323e+06
 Factor NZ  : 1.208e+07 (roughly 200 MB of memory)
 Factor Ops : 4.139e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.38359247e+07  2.89018407e+08  7.17e+04 1.41e+01  5.69e+04     7s
   1  -1.07791552e+07  2.40411370e+08  5.00e+04 4.89e+01  3.93e+04     7s
   2  -5.16113466e+06  1.86484935e+08  2.27e+04 1.35e+01  1.85e+04     7s
   3  -7.75890115e+05  1.23321066e+08  1.34e+03 1.92e+00  1.40e+03     7s
   4  -5.43689836e+05  7.01254415e+07  4.29e+02 8.44e-01  5.24e+02     7s
   5  -4.80163111e+05  4.27222604e+07  2.52e+02 4.22e-01  2.98e+02     7s
   6  -4.27723314e+05  3.13873301e+07  1.42e+02 2.82e-01  1.84e+02     7s
   7  -3.43077720e+05  2.33262776e+07  5.68e+01 1.95e-01  1.05e+02     7s
   8  -2.07250044e+05  1.66420393e+07  3.97e+00 1.29e-01  5.49e+01     7s
   9  -1.60121194e+05  5.03671343e+06  2.60e+00 3.73e-02  1.68e+01     7s
  10  -1.23972919e+05  2.24424412e+06  1.34e+00 1.65e-02  7.57e+00     8s
  11  -1.12371664e+05  1.58919722e+06  1.00e+00 1.18e-02  5.42e+00     8s
  12  -1.01710468e+05  1.23913498e+06  7.02e-01 9.27e-03  4.26e+00     8s
  13  -8.29231540e+04  7.19918677e+05  3.79e-01 5.56e-03  2.54e+00     8s
  14  -5.79973074e+04  2.06321330e+05  1.29e-01 1.49e-03  8.35e-01     8s
  15  -4.49394813e+04  1.42670121e+05  7.88e-02 1.18e-03  5.93e-01     8s
  16  -4.05431033e+04  7.83466531e+04  6.52e-02 2.86e-03  3.76e-01     8s
  17  -3.52536184e+04  5.71657657e+04  4.98e-02 2.63e-03  2.92e-01     8s
  18  -3.28915192e+04  2.86887439e+04  4.37e-02 3.11e-03  1.95e-01     8s
  19  -3.06098367e+04  1.88522776e+04  3.80e-02 2.38e-03  1.56e-01     8s
  20  -2.74492997e+04  1.61346889e+04  3.02e-02 2.15e-03  1.38e-01     8s
  21  -2.56924046e+04  5.01180075e+03  2.57e-02 1.42e-03  9.70e-02     8s
  22  -2.34063893e+04  1.05129757e+03  2.04e-02 1.15e-03  7.73e-02     9s
  23  -2.23660201e+04 -7.55861702e+02  1.81e-02 1.00e-03  6.83e-02     9s
  24  -2.11572511e+04 -3.97665419e+03  1.55e-02 8.63e-04  5.43e-02     9s
  25  -2.02542358e+04 -6.29530930e+03  1.35e-02 6.46e-04  4.41e-02     9s
  26  -1.88972728e+04 -7.43578329e+03  1.08e-02 5.19e-04  3.62e-02     9s
  27  -1.86833154e+04 -7.97486807e+03  1.03e-02 4.69e-04  3.38e-02     9s
  28  -1.73880023e+04 -8.84896939e+03  7.78e-03 3.87e-04  2.70e-02     9s
  29  -1.66963663e+04 -9.45239290e+03  6.44e-03 3.28e-04  2.29e-02     9s
  30  -1.59585253e+04 -1.06499696e+04  5.08e-03 1.85e-04  1.68e-02     9s
  31  -1.53965603e+04 -1.10811951e+04  4.05e-03 1.52e-04  1.36e-02    10s
  32  -1.51162480e+04 -1.16108402e+04  3.54e-03 9.70e-05  1.11e-02    10s
  33  -1.49020914e+04 -1.19565738e+04  3.18e-03 7.16e-05  9.31e-03    10s
  34  -1.46574971e+04 -1.20832541e+04  2.77e-03 6.34e-05  8.14e-03    10s
  35  -1.45461579e+04 -1.21786765e+04  2.58e-03 5.50e-05  7.48e-03    10s
  36  -1.43044014e+04 -1.23266764e+04  2.17e-03 4.70e-05  6.25e-03    10s
  37  -1.42465747e+04 -1.24270354e+04  2.07e-03 3.87e-05  5.75e-03    10s
  38  -1.41767682e+04 -1.24420611e+04  1.95e-03 3.78e-05  5.48e-03    10s
  39  -1.41041805e+04 -1.24830879e+04  1.83e-03 4.06e-05  5.12e-03    10s
  40  -1.40005404e+04 -1.25945664e+04  1.65e-03 4.05e-05  4.44e-03    10s
  41  -1.38629089e+04 -1.26228365e+04  1.41e-03 3.80e-05  3.92e-03    11s
  42  -1.38461299e+04 -1.26360528e+04  1.38e-03 3.69e-05  3.83e-03    11s
  43  -1.37230222e+04 -1.27159544e+04  1.16e-03 2.91e-05  3.18e-03    11s
  44  -1.36751816e+04 -1.27384712e+04  1.08e-03 2.71e-05  2.96e-03    11s
  45  -1.35969456e+04 -1.27624722e+04  9.48e-04 2.49e-05  2.64e-03    11s
  46  -1.35361215e+04 -1.27924750e+04  8.38e-04 2.22e-05  2.35e-03    11s
  47  -1.34965744e+04 -1.28405402e+04  7.68e-04 1.82e-05  2.07e-03    11s
  48  -1.34363177e+04 -1.28624900e+04  6.61e-04 1.63e-05  1.81e-03    11s
  49  -1.33718469e+04 -1.28683746e+04  5.54e-04 1.68e-05  1.59e-03    12s
  50  -1.33370929e+04 -1.29117476e+04  4.92e-04 2.75e-05  1.34e-03    12s
  51  -1.32778562e+04 -1.29564490e+04  3.89e-04 1.84e-05  1.02e-03    12s
  52  -1.32316619e+04 -1.29647339e+04  3.09e-04 1.66e-05  8.44e-04    12s
  53  -1.31910838e+04 -1.29708839e+04  2.42e-04 1.51e-05  6.96e-04    12s
  54  -1.31460129e+04 -1.30051712e+04  1.66e-04 7.07e-06  4.45e-04    12s
  55  -1.31085427e+04 -1.30160897e+04  1.04e-04 4.73e-06  2.92e-04    12s
  56  -1.30683221e+04 -1.30317712e+04  3.99e-05 1.72e-06  1.16e-04    12s
  57  -1.30520791e+04 -1.30354114e+04  1.38e-05 1.09e-06  5.27e-05    12s
  58  -1.30451156e+04 -1.30366688e+04  4.00e-06 8.71e-07  2.67e-05    13s
  59  -1.30447377e+04 -1.30394098e+04  3.56e-06 3.75e-07  1.68e-05    13s
  60  -1.30436073e+04 -1.30402977e+04  2.11e-06 2.32e-07  1.05e-05    13s
  61  -1.30423171e+04 -1.30405136e+04  5.59e-07 1.94e-07  5.70e-06    13s
  62  -1.30423039e+04 -1.30407207e+04  5.47e-07 1.60e-07  5.00e-06    13s
  63  -1.30421406e+04 -1.30412518e+04  3.92e-07 6.84e-08  2.81e-06    13s
  64  -1.30419941e+04 -1.30412739e+04  2.62e-07 6.52e-08  2.28e-06    13s
  65  -1.30419411e+04 -1.30412992e+04  2.16e-07 5.90e-07  2.03e-06    13s
  66  -1.30417299e+04 -1.30416739e+04  2.59e-08 2.02e-08  1.78e-07    14s
  67  -1.30416974e+04 -1.30416899e+04  1.06e-08 3.04e-08  2.37e-08    14s
  68  -1.30416969e+04 -1.30416900e+04  4.88e-07 5.21e-07  2.19e-08    14s
  69  -1.30416947e+04 -1.30416901e+04  1.08e-06 4.04e-07  1.44e-08    14s
  70  -1.30416946e+04 -1.30416902e+04  1.03e-06 3.64e-07  1.39e-08    14s
  71  -1.30416934e+04 -1.30416902e+04  1.50e-05 5.25e-07  1.38e-08    14s
  72  -1.30416931e+04 -1.30416902e+04  1.84e-05 6.81e-07  1.26e-08    14s
  73  -1.30416925e+04 -1.30416903e+04  1.77e-05 6.59e-07  1.05e-08    14s
  74  -1.30416912e+04 -1.30416904e+04  5.51e-06 4.38e-07  3.98e-09    15s
  75  -1.30416912e+04 -1.30416904e+04  5.35e-06 4.30e-07  3.85e-09    15s
  76  -1.30416912e+04 -1.30416904e+04  4.17e-06 6.30e-07  3.45e-09    15s
  77  -1.30416911e+04 -1.30416904e+04  3.40e-06 5.39e-07  2.84e-09    15s
  78  -1.30416910e+04 -1.30416905e+04  2.65e-06 4.48e-07  2.25e-09    15s
  79  -1.30416908e+04 -1.30416905e+04  1.21e-06 4.24e-07  1.27e-09    15s
  80  -1.30416907e+04 -1.30416905e+04  1.11e-06 3.82e-07  1.16e-09    15s
  81  -1.30416908e+04 -1.30416905e+04  9.76e-07 3.24e-07  1.03e-09    16s
  82  -1.30416907e+04 -1.30416906e+04  7.01e-07 3.80e-09  4.88e-10    16s

Barrier solved model in 82 iterations and 15.66 seconds (23.70 work units)
Optimal objective -1.30416907e+04


Root crossover log...

  138031 DPushes remaining with DInf 0.0000000e+00                16s
   23635 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

   30386 PPushes remaining with PInf 1.7688879e-04                24s
    8440 PPushes remaining with PInf 9.1194818e-04                26s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.7985533e+04     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  101806   -1.3041691e+04   0.000000e+00   2.798553e+04     27s
  102384   -1.3041691e+04   0.000000e+00   0.000000e+00     28s
  102384   -1.3041691e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 5.63s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -1.304169e+04, 102384 iterations, 29.01 seconds (50.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13041.691    0  438 -201924.56 -13041.691  93.5%     -   34s
H    0     0                    -159437.2875 -13041.691  91.8%     -   35s
H    0     0                    -146791.3895 -13041.691  91.1%     -   35s
H    0     0                    -146697.1215 -13041.691  91.1%     -   35s
H    0     0                    -110370.6478 -13041.691  88.2%     -   35s
H    0     0                    -69065.17589 -13041.691  81.1%     -   36s
H    0     0                    -63987.15749 -13041.691  79.6%     -   36s
H    0     0                    -63974.85640 -13041.691  79.6%     -   36s
     0     0 -17585.418    0  578 -63974.856 -17585.418  72.5%     -  112s
     0     0 -17585.755    0  579 -63974.856 -17585.755  72.5%     -  112s
H    0     0                    -62516.04589 -17585.894  71.9%     -  114s
H    0     0                    -58519.74497 -17585.894  69.9%     -  114s
H    0     0                    -57929.30074 -17585.894  69.6%     -  114s
H    0     0                    -57924.64360 -17585.894  69.6%     -  114s
H    0     0                    -56238.57294 -17585.894  68.7%     -  114s
H    0     0                    -55546.50960 -17585.894  68.3%     -  114s
H    0     0                    -55493.39220 -17585.894  68.3%     -  114s
H    0     0                    -55464.93951 -17585.894  68.3%     -  114s
     0     0 -17738.071    0  624 -55464.940 -17738.071  68.0%     -  139s
     0     0 -17762.942    0  620 -55464.940 -17762.942  68.0%     -  147s
     0     0 -17919.351    0  612 -55464.940 -17919.351  67.7%     -  160s
     0     0 -17923.062    0  611 -55464.940 -17923.062  67.7%     -  164s
     0     0 -17937.286    0  614 -55464.940 -17937.286  67.7%     -  170s
     0     0 -17937.510    0  614 -55464.940 -17937.510  67.7%     -  170s
     0     0 -20264.503    0  614 -55464.940 -20264.503  63.5%     -  240s
H    0     0                    -55424.04819 -20265.525  63.4%     -  242s
H    0     0                    -55208.05001 -20265.525  63.3%     -  242s
H    0     0                    -55183.84165 -20265.525  63.3%     -  242s
     0     0 -20499.895    0  616 -55183.842 -20499.895  62.9%     -  261s
     0     0 -20690.698    0  625 -55183.842 -20690.698  62.5%     -  279s
     0     0 -20755.306    0  676 -55183.842 -20755.306  62.4%     -  292s
     0     0 -20795.397    0  674 -55183.842 -20795.397  62.3%     -  299s
     0     0 -20797.429    0  683 -55183.842 -20797.429  62.3%     -  301s
     0     0 -20802.792    0  684 -55183.842 -20802.792  62.3%     -  305s
     0     0 -20810.935    0  693 -55183.842 -20810.935  62.3%     -  309s
     0     0 -20822.767    0  681 -55183.842 -20822.767  62.3%     -  311s
     0     0 -20822.784    0  681 -55183.842 -20822.784  62.3%     -  312s
     0     0 -22222.380    0  610 -55183.842 -22222.380  59.7%     -  409s
H    0     0                    -51399.66098 -22222.785  56.8%     -  410s
H    0     0                    -50972.71754 -22222.785  56.4%     -  410s
H    0     0                    -50965.20557 -22222.785  56.4%     -  410s
     0     0 -22535.987    0  618 -50965.206 -22535.987  55.8%     -  460s
     0     0 -22621.664    0  620 -50965.206 -22621.664  55.6%     -  484s
     0     0 -22743.383    0  612 -50965.206 -22743.383  55.4%     -  504s
     0     0 -22782.212    0  609 -50965.206 -22782.212  55.3%     -  515s
     0     0 -22803.800    0  621 -50965.206 -22803.800  55.3%     -  521s
     0     0 -22815.485    0  622 -50965.206 -22815.485  55.2%     -  530s
     0     0 -22860.091    0  679 -50965.206 -22860.091  55.1%     -  546s
     0     0 -22864.480    0  612 -50965.206 -22864.480  55.1%     -  550s
     0     0 -22913.524    0  616 -50965.206 -22913.524  55.0%     -  561s
     0     0 -22960.955    0  614 -50965.206 -22960.955  54.9%     -  575s
     0     0 -22968.128    0  623 -50965.206 -22968.128  54.9%     -  581s
     0     0 -22974.425    0  624 -50965.206 -22974.425  54.9%     -  587s
     0     0 -22992.551    0  677 -50965.206 -22992.551  54.9%     -  598s
     0     0 -22998.291    0  623 -50965.206 -22998.291  54.9%     -  604s
     0     0 -23007.320    0  614 -50965.206 -23007.320  54.9%     -  609s
     0     0 -23009.261    0  618 -50965.206 -23009.261  54.9%     -  612s
     0     0 -23022.231    0  655 -50965.206 -23022.231  54.8%     -  620s
     0     0 -23022.786    0  625 -50965.206 -23022.786  54.8%     -  621s
     0     0 -23574.125    0  709 -50965.206 -23574.125  53.7%     -  709s
H    0     0                    -50569.91386 -23574.259  53.4%     -  710s
H    0     0                    -49317.44177 -23574.259  52.2%     -  710s
     0     0 -23760.449    0  695 -49317.442 -23760.449  51.8%     -  755s
     0     0 -23881.376    0  710 -49317.442 -23881.376  51.6%     -  780s
     0     0 -23955.546    0  720 -49317.442 -23955.546  51.4%     -  796s
     0     0 -23997.322    0  711 -49317.442 -23997.322  51.3%     -  807s
     0     0 -24022.371    0  720 -49317.442 -24022.371  51.3%     -  818s
     0     0 -24036.452    0  723 -49317.442 -24036.452  51.3%     -  827s
     0     0 -24050.561    0  741 -49317.442 -24050.561  51.2%     -  833s
     0     0 -24058.708    0  732 -49317.442 -24058.708  51.2%     -  841s
     0     0 -24084.275    0  740 -49317.442 -24084.275  51.2%     -  850s
     0     0 -24088.509    0  745 -49317.442 -24088.509  51.2%     -  855s
     0     0 -24092.677    0  741 -49317.442 -24092.677  51.1%     -  859s
     0     0 -24099.613    0  737 -49317.442 -24099.613  51.1%     -  864s
     0     0 -24113.808    0  738 -49317.442 -24113.808  51.1%     -  873s
     0     0 -24114.614    0  751 -49317.442 -24114.614  51.1%     -  875s
     0     0 -24401.123    0  745 -49317.442 -24401.123  50.5%     -  916s
H    0     0                    -42061.25059 -24401.252  42.0%     -  917s
H    0     0                    -42001.39856 -24401.252  41.9%     -  917s
H    0     0                    -41765.21347 -24401.252  41.6%     -  917s
H    0     0                    -31638.52102 -24401.252  22.9%     -  917s
     0     0 -24450.327    0  751 -31638.521 -24450.327  22.7%     -  933s
     0     0 -24497.906    0  747 -31638.521 -24497.906  22.6%     -  943s
     0     0 -24504.859    0  755 -31638.521 -24504.859  22.5%     -  950s
     0     0 -24509.415    0  771 -31638.521 -24509.415  22.5%     -  958s
     0     0 -24510.314    0  768 -31638.521 -24510.314  22.5%     -  961s
     0     0 -24627.909    0  734 -31638.521 -24627.909  22.2%     -  987s
H    0     0                    -31580.59815 -24628.030  22.0%     -  998s
H    0     0                    -31547.42466 -24628.030  21.9%     -  999s
     0     0 -24697.514    0  654 -31547.425 -24697.514  21.7%     - 1017s
     0     0 -24710.732    0  657 -31547.425 -24710.732  21.7%     - 1027s
     0     0 -24713.729    0  661 -31547.425 -24713.729  21.7%     - 1031s
     0     0 -24723.197    0  659 -31547.425 -24723.197  21.6%     - 1035s
     0     0 -24737.561    0  652 -31547.425 -24737.561  21.6%     - 1039s
     0     0 -24739.922    0  649 -31547.425 -24739.922  21.6%     - 1042s
     0     0 -24743.704    0  656 -31547.425 -24743.704  21.6%     - 1045s
     0     0 -24749.794    0  673 -31547.425 -24749.794  21.5%     - 1052s
     0     0 -24752.588    0  760 -31547.425 -24752.588  21.5%     - 1056s
     0     0 -24752.950    0  754 -31547.425 -24752.950  21.5%     - 1058s
     0     0 -24848.531    0  726 -31547.425 -24848.531  21.2%     - 1082s
     0     0 -24883.178    0  664 -31547.425 -24883.178  21.1%     - 1094s
     0     0 -24888.976    0  747 -31547.425 -24888.976  21.1%     - 1100s
     0     0 -24889.559    0  665 -31547.425 -24889.559  21.1%     - 1102s
     0     0 -24911.259    0  670 -31547.425 -24911.259  21.0%     - 1115s
H    0     0                    -31547.42282 -24911.393  21.0%     - 1119s
     0     0 -24920.161    0  674 -31547.423 -24920.161  21.0%     - 1127s
     0     0 -24923.092    0  816 -31547.423 -24923.092  21.0%     - 1131s
     0     0 -24926.895    0  804 -31547.423 -24926.895  21.0%     - 1138s
     0     0 -24927.336    0  811 -31547.423 -24927.336  21.0%     - 1140s
     0     0 -24936.554    0  818 -31547.423 -24936.554  21.0%     - 1153s
     0     0 -24951.283    0  816 -31547.423 -24951.283  20.9%     - 1163s
     0     0 -24954.126    0  817 -31547.423 -24954.126  20.9%     - 1167s
     0     0 -24956.434    0  823 -31547.423 -24956.434  20.9%     - 1172s
     0     0 -24958.356    0  822 -31547.423 -24958.356  20.9%     - 1176s
     0     0 -24959.744    0  815 -31547.423 -24959.744  20.9%     - 1179s
     0     0 -24967.429    0  687 -31547.423 -24967.429  20.9%     - 1189s
     0     0 -24971.836    0  783 -31547.423 -24971.836  20.8%     - 1198s
     0     0 -24974.517    0  795 -31547.423 -24974.517  20.8%     - 1202s
     0     0 -24975.594    0  838 -31547.423 -24975.594  20.8%     - 1205s
     0     0 -24982.952    0  689 -31547.423 -24982.952  20.8%     - 1214s
     0     0 -24985.696    0  701 -31547.423 -24985.696  20.8%     - 1221s
     0     0 -24986.621    0  706 -31547.423 -24986.621  20.8%     - 1224s
     0     0 -24990.727    0  696 -31547.423 -24990.727  20.8%     - 1238s
     0     0 -24990.738    0  696 -31547.423 -24990.738  20.8%     - 1250s
H    0     0                    -31540.64697 -24991.135  20.8%     - 1314s
H    0     0                    -31533.96022 -24991.135  20.7%     - 1314s
H    0     0                    -31499.69871 -24991.135  20.7%     - 1425s
     0     2 -24991.135    0  696 -31499.699 -24991.135  20.7%     - 1464s
     1     4 -25019.001    1  757 -31499.699 -24991.135  20.7%  6270 1487s
     3     8 -25077.170    2  763 -31499.699 -25019.329  20.6% 11069 1648s
     7    16 -25209.103    3  764 -31499.699 -25078.334  20.4% 25783 1676s
    15    30 -25291.327    4  764 -31499.699 -25209.499  20.0% 19923 1711s
    31    42 -26073.362    5  463 -31499.699 -25291.715  19.7% 24060 3305s
    45    64 -26544.301    6  346 -31499.699 -25291.715  19.7% 30545 3502s
H   49    64                    -31484.13327 -25291.715  19.7% 29859 3502s
    73   179 -26565.469    7  335 -31484.133 -25291.715  19.7% 30088 3569s
   202   205 -26848.503   12  395 -31484.133 -25291.715  19.7% 13991 3600s
H  222   205                    -31459.44587 -25291.715  19.6% 13221 3600s

Cutting planes:
  Learned: 1
  Implied bound: 172
  MIR: 3953
  Flow cover: 4235
  Zero half: 6
  RLT: 90
  Relax-and-lift: 664

Explored 232 nodes (4011637 simplex iterations) in 3600.14 seconds (6489.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31459.4 -31484.1 -31499.7 ... -41765.2

Time limit reached
Best objective -3.145944587431e+04, best bound -2.529171510243e+04, gap 19.6053%
  WARNING: Time limit reached. Using best solution found (gap: 19.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = -31459.45, θ = 93500.65
  Upper Bound (UB) = -31459.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93500.65
  [DEBUG]   ✓ Scenario 0: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 93500.65 ≤ Q = 93500.65 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4fbcf9d1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb043062f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177514e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5459829.7885
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.233559e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123355.88    0  124 5459829.79 -123355.88   102%     -    0s
H    0     0                    -89549.66624 -123355.88  37.8%     -    0s
H    0     0                    -90108.34637 -123355.88  36.9%     -    0s
H    0     0                    -93072.58030 -95828.067  2.96%     -    0s
     0     0 -95828.067    0   70 -93072.580 -95828.067  2.96%     -    0s
H    0     0                    -93360.65546 -95767.863  2.58%     -    0s
H    0     0                    -93836.11662 -95767.863  2.06%     -    0s
H    0     0                    -94124.19177 -95767.863  1.75%     -    0s
     0     0 -95243.143    0   71 -94124.192 -95243.143  1.19%     -    0s
     0     0 -95042.129    0   73 -94124.192 -95042.129  0.98%     -    0s
     0     0 -95006.738    0   72 -94124.192 -95006.738  0.94%     -    0s
     0     0 -94990.923    0   72 -94124.192 -94990.923  0.92%     -    0s
     0     0 -94837.061    0   75 -94124.192 -94837.061  0.76%     -    0s
     0     0 -94835.543    0   75 -94124.192 -94835.543  0.76%     -    0s
     0     2 -94834.860    0   75 -94124.192 -94834.860  0.76%     -    0s

Cutting planes:
  Gomory: 38
  Implied bound: 4
  MIR: 176
  Flow cover: 2
  RLT: 5

Explored 2655 nodes (13372 simplex iterations) in 0.16 seconds (0.13 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -94124.2 -93836.1 -90108.3 ... 1.17751e+13
No other solutions better than -94124.2

Optimal solution found (tolerance 1.00e-06)
Best objective -9.412419177491e+04, best bound -9.412419177491e+04, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 92146.11
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94124.19
  [DEBUG]   S×d_nominal = 186270.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186270.31 + -94124.19 = 92146.11
  [DEBUG]   Current θ from Master = 93500.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1354.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -32813.98
  Lower Bound (LB) = -32243.98
  Gap (UB-LB) = 784.5342, Absolute Gap = 784.5342, Relative Gap = 0.024938
  Not converged yet (gap = 784.53 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956601 nonzeros
Model fingerprint: 0x4ddcefe8
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 155540 rows and 63140 columns
Presolve time: 3.85s
Presolved: 182223 rows, 76400 columns, 1121208 nonzeros
Variable types: 74141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -402646.4229
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.49s

Barrier statistics:
 Dense cols : 1153
 AA' NZ     : 4.667e+06
 Factor NZ  : 1.312e+07 (roughly 200 MB of memory)
 Factor Ops : 4.676e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.38491225e+07  3.00597621e+08  7.18e+04 1.35e+01  5.66e+04     6s
   1  -1.08114608e+07  2.49894038e+08  5.01e+04 4.87e+01  3.91e+04     6s
   2  -5.25409820e+06  1.93495123e+08  2.31e+04 1.43e+01  1.87e+04     6s
   3  -7.80164523e+05  1.28609064e+08  1.35e+03 2.31e+00  1.40e+03     7s
   4  -5.45943746e+05  7.12312253e+07  4.36e+02 1.14e+00  5.22e+02     7s
   5  -4.63576892e+05  4.70366625e+07  2.05e+02 6.44e-01  2.77e+02     7s
   6  -4.03075514e+05  3.44097949e+07  9.78e+01 4.34e-01  1.63e+02     7s
   7  -3.17485553e+05  2.50170305e+07  2.83e+01 2.93e-01  9.10e+01     7s
   8  -2.22932588e+05  1.71534410e+07  4.61e+00 1.91e-01  5.42e+01     7s
   9  -1.54101511e+05  4.93258428e+06  1.47e+00 4.80e-02  1.55e+01     7s
  10  -1.26718329e+05  2.67437235e+06  8.94e-01 2.61e-02  8.51e+00     7s
  11  -1.12789935e+05  1.82050310e+06  6.24e-01 1.77e-02  5.86e+00     7s
  12  -9.93296969e+04  1.31658084e+06  3.95e-01 1.28e-02  4.28e+00     7s
  13  -8.12010636e+04  5.26298321e+05  1.94e-01 4.77e-03  1.83e+00     7s
  14  -5.53564267e+04  1.60251530e+05  6.74e-02 1.65e-03  6.50e-01     8s
  15  -4.90653025e+04  9.74039992e+04  5.29e-02 1.19e-03  4.42e-01     8s
  16  -4.14335975e+04  5.46911254e+04  3.88e-02 1.56e-03  2.90e-01     8s
  17  -3.75757182e+04  4.26372752e+04  3.31e-02 1.40e-03  2.42e-01     8s
  18  -3.42080371e+04  3.00394991e+04  2.81e-02 1.07e-03  1.94e-01     8s
  19  -3.14445789e+04  1.92554012e+04  2.39e-02 8.37e-04  1.53e-01     8s
  20  -2.86605244e+04  1.16795943e+04  1.99e-02 6.27e-04  1.22e-01     8s
  21  -2.61438885e+04  5.50823994e+03  1.61e-02 6.48e-04  9.55e-02     8s
  22  -2.41022421e+04  5.26822427e+02  1.33e-02 4.92e-04  7.43e-02     8s
  23  -2.28597335e+04 -1.55276928e+03  1.16e-02 4.18e-04  6.43e-02     9s
  24  -2.15101955e+04 -4.50567133e+03  9.83e-03 5.78e-04  5.13e-02     9s
  25  -1.96522701e+04 -5.97313573e+03  7.32e-03 4.80e-04  4.13e-02     9s
  26  -1.86256437e+04 -7.82197771e+03  6.05e-03 3.89e-04  3.26e-02     9s
  27  -1.77873084e+04 -9.22936208e+03  5.09e-03 2.89e-04  2.58e-02     9s
  28  -1.73078306e+04 -1.04510184e+04  4.56e-03 2.11e-04  2.07e-02     9s
  29  -1.60077505e+04 -1.12126383e+04  3.09e-03 1.16e-04  1.45e-02     9s
  30  -1.55325572e+04 -1.16927084e+04  2.59e-03 9.78e-05  1.16e-02     9s
  31  -1.51692906e+04 -1.21335347e+04  2.20e-03 1.35e-04  9.16e-03    10s
  32  -1.49787473e+04 -1.22617463e+04  2.00e-03 1.15e-04  8.20e-03    10s
  33  -1.45677428e+04 -1.23098361e+04  1.58e-03 1.07e-04  6.81e-03    10s
  34  -1.44009176e+04 -1.24063784e+04  1.40e-03 9.22e-05  6.02e-03    10s
  35  -1.42842854e+04 -1.24909745e+04  1.29e-03 7.85e-05  5.41e-03    10s
  36  -1.41641561e+04 -1.25771280e+04  1.16e-03 6.35e-05  4.79e-03    10s
  37  -1.39671895e+04 -1.26131020e+04  9.56e-04 4.53e-05  4.09e-03    10s
  38  -1.38064611e+04 -1.26368158e+04  7.94e-04 4.29e-05  3.53e-03    10s
  39  -1.37177861e+04 -1.26892260e+04  7.03e-04 3.76e-05  3.10e-03    11s
  40  -1.36787843e+04 -1.27675479e+04  6.61e-04 2.96e-05  2.75e-03    11s
  41  -1.36521370e+04 -1.27791202e+04  6.25e-04 2.86e-05  2.63e-03    11s
  42  -1.35499846e+04 -1.28022951e+04  5.17e-04 2.63e-05  2.26e-03    11s
  43  -1.35270419e+04 -1.28246208e+04  4.93e-04 2.39e-05  2.12e-03    11s
  44  -1.35067334e+04 -1.28758479e+04  4.71e-04 1.85e-05  1.90e-03    11s
  45  -1.34289502e+04 -1.29064928e+04  3.91e-04 1.53e-05  1.58e-03    11s
  46  -1.33833019e+04 -1.29216047e+04  3.44e-04 1.34e-05  1.39e-03    11s
  47  -1.33088889e+04 -1.29566999e+04  2.66e-04 9.69e-06  1.06e-03    12s
  48  -1.32284860e+04 -1.29772564e+04  1.82e-04 7.26e-06  7.58e-04    12s
  49  -1.31768650e+04 -1.29867861e+04  1.31e-04 6.14e-06  5.73e-04    12s
  50  -1.31412024e+04 -1.30093133e+04  9.52e-05 3.51e-06  3.98e-04    12s
  51  -1.31140731e+04 -1.30247560e+04  6.83e-05 1.73e-06  2.70e-04    12s
  52  -1.30814552e+04 -1.30370193e+04  3.68e-05 5.73e-07  1.34e-04    12s
  53  -1.30629963e+04 -1.30386100e+04  1.91e-05 3.80e-07  7.36e-05    12s
  54  -1.30535484e+04 -1.30387192e+04  1.06e-05 3.60e-07  4.47e-05    12s
  55  -1.30498753e+04 -1.30400659e+04  7.21e-06 1.91e-07  2.96e-05    13s
  56  -1.30460215e+04 -1.30406541e+04  3.71e-06 1.22e-07  1.62e-05    13s
  57  -1.30434901e+04 -1.30411740e+04  1.53e-06 1.30e-07  6.99e-06    13s
  58  -1.30432977e+04 -1.30414034e+04  1.36e-06 7.48e-08  5.72e-06    13s
  59  -1.30431817e+04 -1.30414167e+04  1.26e-06 6.90e-08  5.33e-06    13s
  60  -1.30421395e+04 -1.30414296e+04  3.79e-07 7.81e-08  2.14e-06    13s
  61  -1.30419466e+04 -1.30416289e+04  2.16e-07 1.52e-06  9.59e-07    13s
  62  -1.30417382e+04 -1.30416849e+04  1.91e-07 2.10e-07  1.61e-07    13s
  63  -1.30417044e+04 -1.30416895e+04  4.80e-08 3.31e-08  4.49e-08    14s
  64  -1.30417041e+04 -1.30416896e+04  3.71e-07 3.30e-08  4.41e-08    14s
  65  -1.30417041e+04 -1.30416896e+04  3.42e-07 3.27e-08  4.40e-08    14s
  66  -1.30417036e+04 -1.30416897e+04  4.15e-07 3.73e-08  4.20e-08    14s
  67  -1.30417015e+04 -1.30416898e+04  1.73e-05 3.01e-07  3.60e-08    14s
  68  -1.30416944e+04 -1.30416906e+04  6.03e-06 3.37e-09  1.19e-08    14s
  69  -1.30416944e+04 -1.30416906e+04  5.97e-06 2.47e-08  1.19e-08    14s
  70  -1.30416940e+04 -1.30416906e+04  5.95e-06 1.55e-07  1.01e-08    14s
  71  -1.30416927e+04 -1.30416906e+04  6.80e-06 2.82e-07  8.30e-09    15s
  72  -1.30416926e+04 -1.30416906e+04  6.59e-06 2.76e-07  8.01e-09    15s
  73  -1.30416925e+04 -1.30416906e+04  6.54e-06 2.76e-07  7.95e-09    15s
  74  -1.30416919e+04 -1.30416906e+04  3.47e-06 3.05e-07  4.84e-09    15s
  75  -1.30416918e+04 -1.30416906e+04  3.30e-06 2.95e-07  4.74e-09    15s
  76  -1.30416917e+04 -1.30416906e+04  3.23e-06 2.82e-07  4.59e-09    15s
  77  -1.30416912e+04 -1.30416906e+04  2.19e-06 6.00e-07  2.44e-09    15s
  78  -1.30416908e+04 -1.30416906e+04  8.00e-07 8.59e-07  5.71e-10    15s
  79  -1.30416909e+04 -1.30416906e+04  1.77e-06 7.65e-07  5.47e-10    16s
  80  -1.30416907e+04 -1.30416906e+04  1.81e-06 2.75e-07  2.07e-10    16s

Barrier solved model in 80 iterations and 15.64 seconds (23.45 work units)
Optimal objective -1.30416907e+04


Root crossover log...

  144486 DPushes remaining with DInf 0.0000000e+00                16s
   37359 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

   19834 PPushes remaining with PInf 2.2668166e-04                25s
   10459 PPushes remaining with PInf 1.5778660e-04                25s
       0 PPushes remaining with PInf 3.4745738e+00                27s

  Push phase complete: Pinf 3.4745738e+00, Dinf 1.8820952e+05     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   89331   -1.3041700e+04   0.000000e+00   1.882095e+05     27s
   89665   -1.3041691e+04   0.000000e+00   0.000000e+00     27s
   89665   -1.3041691e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 5.47s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -1.304169e+04, 89665 iterations, 28.09 seconds (49.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13041.691    0  438 -201924.56 -13041.691  93.5%     -   34s
H    0     0                    -139353.0419 -13041.691  90.6%     -   35s
H    0     0                    -136439.4414 -13041.691  90.4%     -   35s
H    0     0                    -114259.6673 -13041.691  88.6%     -   35s
H    0     0                    -113996.1155 -13041.691  88.6%     -   36s
H    0     0                    -113988.7482 -13041.691  88.6%     -   36s
H    0     0                    -82051.72410 -13041.691  84.1%     -   36s
H    0     0                    -77419.11391 -13041.691  83.2%     -   36s
     0     0 -17526.574    0  501 -77419.114 -17526.574  77.4%     -  117s
H    0     0                    -76119.33796 -17526.577  77.0%     -  118s
H    0     0                    -73685.50112 -17526.577  76.2%     -  118s
H    0     0                    -72189.19902 -17526.577  75.7%     -  118s
H    0     0                    -68601.47044 -17526.577  74.5%     -  118s
H    0     0                    -68463.99808 -17526.577  74.4%     -  118s
H    0     0                    -68437.48369 -17526.577  74.4%     -  118s
H    0     0                    -68158.16695 -17526.577  74.3%     -  118s
H    0     0                    -68134.73288 -17526.577  74.3%     -  118s
H    0     0                    -68032.20830 -17526.577  74.2%     -  118s
H    0     0                    -68029.12474 -17526.577  74.2%     -  118s
     0     0 -17894.644    0  547 -68029.125 -17894.644  73.7%     -  140s
     0     0 -17930.858    0  617 -68029.125 -17930.858  73.6%     -  148s
     0     0 -17932.182    0  622 -68029.125 -17932.182  73.6%     -  150s
     0     0 -17932.185    0  555 -68029.125 -17932.185  73.6%     -  150s
     0     0 -19985.253    0  596 -68029.125 -19985.253  70.6%     -  220s
H    0     0                    -65815.95189 -19986.028  69.6%     -  221s
H    0     0                    -65804.36949 -19986.028  69.6%     -  221s
H    0     0                    -65795.10031 -19986.028  69.6%     -  221s
     0     0 -20568.763    0  569 -65795.100 -20568.763  68.7%     -  247s
     0     0 -20673.235    0  587 -65795.100 -20673.235  68.6%     -  264s
     0     0 -20712.782    0  602 -65795.100 -20712.782  68.5%     -  273s
     0     0 -20913.386    0  613 -65795.100 -20913.386  68.2%     -  294s
     0     0 -20925.939    0  613 -65795.100 -20925.939  68.2%     -  301s
     0     0 -20930.122    0  618 -65795.100 -20930.122  68.2%     -  305s
     0     0 -21006.090    0  606 -65795.100 -21006.090  68.1%     -  316s
     0     0 -21016.463    0  614 -65795.100 -21016.463  68.1%     -  321s
     0     0 -21019.037    0  609 -65795.100 -21019.037  68.1%     -  323s
     0     0 -21019.175    0  609 -65795.100 -21019.175  68.1%     -  325s
     0     0 -22325.306    0  585 -65795.100 -22325.306  66.1%     -  402s
H    0     0                    -63858.86369 -22326.141  65.0%     -  404s
H    0     0                    -63846.56261 -22326.141  65.0%     -  404s
     0     0 -22666.461    0  588 -63846.563 -22666.461  64.5%     -  448s
     0     0 -22724.339    0  617 -63846.563 -22724.339  64.4%     -  468s
     0     0 -22800.596    0  630 -63846.563 -22800.596  64.3%     -  482s
     0     0 -22816.874    0  617 -63846.563 -22816.874  64.3%     -  492s
     0     0 -22854.679    0  614 -63846.563 -22854.679  64.2%     -  505s
     0     0 -22860.395    0  621 -63846.563 -22860.395  64.2%     -  511s
     0     0 -22883.548    0  626 -63846.563 -22883.548  64.2%     -  522s
     0     0 -22884.608    0  626 -63846.563 -22884.608  64.2%     -  525s
     0     0 -23746.387    0  593 -63846.563 -23746.387  62.8%     -  599s
H    0     0                    -58227.55134 -23746.442  59.2%     -  599s
H    0     0                    -58206.69976 -23746.442  59.2%     -  599s
     0     0 -23999.749    0  656 -58206.700 -23999.749  58.8%     -  635s
     0     0 -24103.781    0  647 -58206.700 -24103.781  58.6%     -  654s
     0     0 -24139.588    0  686 -58206.700 -24139.588  58.5%     -  671s
     0     0 -24154.609    0  684 -58206.700 -24154.609  58.5%     -  681s
     0     0 -24170.845    0  699 -58206.700 -24170.845  58.5%     -  690s
     0     0 -24181.010    0  681 -58206.700 -24181.010  58.5%     -  696s
     0     0 -24199.107    0  682 -58206.700 -24199.107  58.4%     -  705s
     0     0 -24207.031    0  699 -58206.700 -24207.031  58.4%     -  711s
     0     0 -24218.734    0  683 -58206.700 -24218.734  58.4%     -  718s
     0     0 -24224.545    0  690 -58206.700 -24224.545  58.4%     -  724s
     0     0 -24225.196    0  690 -58206.700 -24225.196  58.4%     -  726s
     0     0 -24481.928    0  690 -58206.700 -24481.928  57.9%     -  762s
H    0     0                    -57875.28154 -24482.112  57.7%     -  763s
H    0     0                    -57854.20948 -24482.112  57.7%     -  764s
H    0     0                    -56206.55460 -24482.112  56.4%     -  764s
H    0     0                    -56186.83595 -24482.112  56.4%     -  764s
H    0     0                    -56186.71249 -24482.112  56.4%     -  764s
H    0     0                    -56172.14519 -24482.112  56.4%     -  764s
     0     0 -24562.706    0  648 -56172.145 -24562.706  56.3%     -  791s
     0     0 -24588.556    0  649 -56172.145 -24588.556  56.2%     -  802s
     0     0 -24595.256    0  703 -56172.145 -24595.256  56.2%     -  811s
     0     0 -24598.635    0  664 -56172.145 -24598.635  56.2%     -  816s
     0     0 -24599.108    0  669 -56172.145 -24599.108  56.2%     -  819s
     0     0 -24904.977    0  722 -56172.145 -24904.977  55.7%     -  856s
H    0     0                    -56076.34395 -24905.296  55.6%     -  858s
H    0     0                    -56056.22373 -24905.296  55.6%     -  860s
H    0     0                    -55866.59777 -24905.296  55.4%     -  860s
H    0     0                    -55753.23569 -24905.296  55.3%     -  860s
H    0     0                    -55714.67664 -24905.296  55.3%     -  861s
H    0     0                    -55690.79640 -24905.296  55.3%     -  861s
H    0     0                    -55649.73146 -24905.296  55.2%     -  861s
     0     0 -24955.539    0  725 -55649.731 -24955.539  55.2%     -  874s
     0     0 -25031.454    0  728 -55649.731 -25031.454  55.0%     -  891s
     0     0 -25067.815    0  729 -55649.731 -25067.815  55.0%     -  906s
     0     0 -25075.067    0  743 -55649.731 -25075.067  54.9%     -  912s
     0     0 -25096.824    0  731 -55649.731 -25096.824  54.9%     -  921s
     0     0 -25103.329    0  756 -55649.731 -25103.329  54.9%     -  928s
     0     0 -25105.591    0  757 -55649.731 -25105.591  54.9%     -  934s
     0     0 -25106.339    0  765 -55649.731 -25106.339  54.9%     -  937s
     0     0 -25168.977    0  691 -55649.731 -25168.977  54.8%     -  963s
H    0     0                    -55612.39723 -25169.652  54.7%     -  964s
     0     0 -25189.516    0  717 -55612.397 -25189.516  54.7%     -  981s
     0     0 -25194.644    0  716 -55612.397 -25194.644  54.7%     -  992s
     0     0 -25196.721    0  728 -55612.397 -25196.721  54.7%     -  996s
     0     0 -25198.653    0  735 -55612.397 -25198.653  54.7%     - 1003s
     0     0 -25200.419    0  731 -55612.397 -25200.419  54.7%     - 1007s
     0     0 -25231.305    0  711 -55612.397 -25231.305  54.6%     - 1029s
H    0     0                    -55551.11392 -25231.738  54.6%     - 1032s
H    0     0                    -55535.95976 -25231.738  54.6%     - 1032s
H    0     0                    -55535.95793 -25231.738  54.6%     - 1032s
     0     0 -25243.030    0  712 -55535.958 -25243.030  54.5%     - 1044s
     0     0 -25245.796    0  711 -55535.958 -25245.796  54.5%     - 1050s
     0     0 -25246.471    0  715 -55535.958 -25246.471  54.5%     - 1052s
     0     0 -25259.600    0  725 -55535.958 -25259.600  54.5%     - 1066s
H    0     0                    -55473.44398 -25259.849  54.5%     - 1067s
H    0     0                    -55466.99649 -25259.849  54.5%     - 1067s
H    0     0                    -55465.03818 -25259.849  54.5%     - 1067s
     0     0 -25289.879    0  721 -55465.038 -25289.879  54.4%     - 1084s
     0     0 -25295.501    0  745 -55465.038 -25295.501  54.4%     - 1091s
     0     0 -25296.824    0  748 -55465.038 -25296.824  54.4%     - 1096s
     0     0 -25322.530    0  727 -55465.038 -25322.530  54.3%     - 1110s
     0     0 -25330.985    0  767 -55465.038 -25330.985  54.3%     - 1121s
     0     0 -25332.768    0  771 -55465.038 -25332.768  54.3%     - 1126s
     0     0 -25336.647    0  778 -55465.038 -25336.647  54.3%     - 1135s
     0     0 -25338.946    0  783 -55465.038 -25338.946  54.3%     - 1140s
     0     0 -25340.226    0  792 -55465.038 -25340.226  54.3%     - 1143s
     0     0 -25345.280    0  752 -55465.038 -25345.280  54.3%     - 1152s
H    0     0                    -44314.95780 -25345.370  42.8%     - 1168s
H    0     0                    -31598.24871 -25345.370  19.8%     - 1169s
H    0     0                    -31582.34743 -25345.370  19.7%     - 1173s
     0     0 -25350.557    0  751 -31582.347 -25350.557  19.7%     - 1179s
     0     0 -25351.550    0  752 -31582.347 -25351.550  19.7%     - 1181s
     0     0 -25354.292    0  747 -31582.347 -25354.292  19.7%     - 1190s
     0     0 -25354.425    0  747 -31582.347 -25354.425  19.7%     - 1201s
H    0     0                    -31551.67081 -25354.425  19.6%     - 1397s
H    0     2                    -31539.36972 -25354.425  19.6%     - 1400s
     0     2 -25354.425    0  747 -31539.370 -25354.425  19.6%     - 1400s
     1     3 -25628.991    1  541 -31539.370 -25354.433  19.6% 30148 1420s
     2     4 -25391.203    1  784 -31539.370 -25391.203  19.5% 17418 1430s
     3     6 -25416.341    2  788 -31539.370 -25391.378  19.5% 13899 1457s
     5    11 -26201.596    3  575 -31539.370 -25391.378  19.5% 16403 1482s
    10    21 -26376.471    4  683 -31539.370 -25416.374  19.4% 15288 1521s
    20    31 -26678.567    4  600 -31539.370 -25463.028  19.3% 24704 1625s
H   30    58                    -31525.53562 -25480.331  19.2% 22217 2031s
H   31    58                    -31490.19158 -25480.331  19.1% 22142 2031s
H   33    58                    -31481.86153 -25480.331  19.1% 21759 2031s
H   42    58                    -31465.50235 -25480.331  19.0% 19253 2031s
H   56    58                    -31457.09655 -25480.331  19.0% 37076 2031s
    57    90 -28043.156    6  616 -31457.097 -25480.331  19.0% 38476 2096s
H   89   122                    -31434.20059 -25480.331  18.9% 32019 2149s
   121   203 -28167.681    8  548 -31434.201 -25480.331  18.9% 27464 2208s
   214   253 -29199.412    8  311 -31434.201 -25480.331  18.9% 18874 2253s
   276   295 -28199.414    9  545 -31434.201 -25480.331  18.9% 16512 2296s
   341   313     cutoff   11      -31434.201 -25480.331  18.9% 14745 2327s
   405   334 -30252.170   12  278 -31434.201 -25480.331  18.9% 13713 2363s
   454   356 infeasible   13      -31434.201 -25480.331  18.9% 13240 2396s
H  475   356                    -31414.88647 -25480.331  18.9% 13216 2396s
H  484   356                    -31411.79990 -25480.331  18.9% 13330 2396s
   490   406 -30609.109   14  286 -31411.800 -25480.331  18.9% 13373 2427s
   570   447 infeasible   16      -31411.800 -25480.331  18.9% 12752 2473s
   631   474 -31336.507   18  154 -31411.800 -25480.331  18.9% 12260 2504s
H  635   474                    -31410.22933 -25480.331  18.9% 12228 2504s
   680   511 infeasible   19      -31410.229 -25480.331  18.9% 11903 2533s
   749   547 -28705.520   26  434 -31410.229 -25480.331  18.9% 11467 2561s
   813   580 -28864.814   27  421 -31410.229 -25480.331  18.9% 11107 2589s
   902   612 -29866.447   28  322 -31410.229 -25480.331  18.9% 10488 2620s
   982   641 -29878.908   29  258 -31410.229 -25480.331  18.9% 10202 2650s
  1043   661 -30257.286   31  287 -31410.229 -25480.331  18.9% 10018 2677s
  1079   712 -30304.143   32  286 -31410.229 -25480.331  18.9% 10024 2707s
  1158   786 -30567.607   39  271 -31410.229 -25480.331  18.9%  9717 2736s
  1286   862 -31246.208   47  196 -31410.229 -25480.331  18.9%  9126 2765s
  1447   854 -28569.148    6  235 -31410.229 -25480.331  18.9%  8486 2797s
  1567   905 -30701.434    8  186 -31410.229 -25480.331  18.9%  8249 2830s
  1663   983     cutoff    7      -31410.229 -25480.331  18.9%  8181 2866s
  1811  1039 infeasible   29      -31410.229 -25480.331  18.9%  7893 2899s
  1981  1078 infeasible   16      -31410.229 -25480.331  18.9%  7615 2934s
  2127  1092 -30571.748   14  325 -31410.229 -25480.331  18.9%  7439 2971s
  2209  1107 -30860.015   15  301 -31410.229 -25480.331  18.9%  7435 3005s
  2240  1137 infeasible   15      -31410.229 -25480.331  18.9%  7530 3046s
  2287  1165 -31194.657   17  223 -31410.229 -25480.331  18.9%  7632 3085s
  2355  1241 -30910.734   17  297 -31410.229 -25480.331  18.9%  7642 3122s
  2469  1358     cutoff   20      -31410.229 -25480.331  18.9%  7554 3154s
  2634  1432     cutoff   29      -31410.229 -25480.331  18.9%  7386 3196s
  2797  1518 -28623.173   12  367 -31410.229 -25480.331  18.9%  7260 3240s
  2942  1611 -29324.077   14  402 -31410.229 -25480.331  18.9%  7219 3287s
  3146  1626 -29639.129   17  412 -31410.229 -25480.331  18.9%  7084 3341s
  3257  1657 -29859.515   18  244 -31410.229 -25480.331  18.9%  7119 3393s
  3338  1710 infeasible   21      -31410.229 -25480.331  18.9%  7273 3446s
  3458  1766 infeasible   20      -31410.229 -25480.331  18.9%  7293 3507s
  3555  1863 infeasible   31      -31410.229 -25480.331  18.9%  7427 3560s
  3704  1935 infeasible   24      -31410.229 -25480.331  18.9%  7473 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 297
  MIR: 4704
  Flow cover: 6622
  Zero half: 5
  RLT: 116
  Relax-and-lift: 1137
  PSD: 1

Explored 3862 nodes (29708944 simplex iterations) in 3600.11 seconds (8656.44 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31410.2 -31411.8 -31414.9 ... -31539.4

Time limit reached
Best objective -3.141022933333e+04, best bound -2.548033110130e+04, gap 18.8789%
  WARNING: Time limit reached. Using best solution found (gap: 18.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -31410.23, θ = 93530.70
  Upper Bound (UB) = -31410.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93530.70
  [DEBUG]   ✓ Scenario 0: θ = 93530.70 ≤ Q = 93530.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93530.70 ≤ Q = 93530.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93530.70 ≤ Q = 93530.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 93530.70 ≤ Q = 93530.70 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5c78a407
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5c78a407
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-14, 2e+02]
Found heuristic solution: objective 1.170990e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5452967.1724
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.236606e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123660.63    0  124 5452967.17 -123660.63   102%     -    0s
H    0     0                    -89800.42489 -123660.63  37.7%     -    0s
H    0     0                    -90359.10502 -123660.63  36.9%     -    0s
     0     0 -96410.036    0   69 -90359.105 -96410.036  6.70%     -    0s
H    0     0                    -93683.14835 -96326.385  2.82%     -    0s
H    0     0                    -93971.22350 -96326.385  2.51%     -    0s
H    0     0                    -94390.93859 -96326.385  2.05%     -    0s
H    0     0                    -94679.01375 -96326.385  1.74%     -    0s
     0     0 -95805.410    0   69 -94679.014 -95805.410  1.19%     -    0s
     0     0 -95652.759    0   75 -94679.014 -95652.759  1.03%     -    0s
     0     0 -95617.636    0   75 -94679.014 -95617.636  0.99%     -    0s
     0     2 -95617.636    0   75 -94679.014 -95617.636  0.99%     -    0s
H   32    30                    -94787.11634 -95323.114  0.57%  12.8    0s
H  107    40                    -94888.27850 -95298.226  0.43%   8.7    0s
*  242    77              16    -94890.98533 -95132.047  0.25%   6.5    0s
*  343   102              18    -94909.91071 -95094.644  0.19%   6.1    0s
*  367   102              15    -94913.50223 -95056.866  0.15%   6.1    0s
*  381   102              16    -94937.70237 -95056.866  0.13%   6.1    0s
*  419   102              15    -94965.41329 -95056.866  0.10%   6.0    0s
*  510     7              14    -94980.51056 -95013.612  0.03%   5.6    0s

Cutting planes:
  Gomory: 43
  Implied bound: 2
  MIR: 178

Explored 538 nodes (3342 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -94980.5 -94965.4 -94937.7 ... -94390.9
No other solutions better than -94980.5

Optimal solution found (tolerance 1.00e-06)
Best objective -9.498051055676e+04, best bound -9.498051055676e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 91594.59
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94980.51
  [DEBUG]   S×d_nominal = 186575.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186575.10 + -94980.51 = 91594.59
  [DEBUG]   Current θ from Master = 93530.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1936.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -33346.34
  Lower Bound (LB) = -32243.98
  Gap (UB-LB) = 833.7507, Absolute Gap = 833.7507, Relative Gap = 0.026544
  Not converged yet (gap = 833.75 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999832 nonzeros
Model fingerprint: 0xc44624fc
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 162610 rows and 66010 columns
Presolve time: 4.09s
Presolved: 190443 rows, 79770 columns, 1171909 nonzeros
Variable types: 77511 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -426079.3538
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.66s

Barrier statistics:
 Dense cols : 1154
 AA' NZ     : 5.016e+06
 Factor NZ  : 1.393e+07 (roughly 220 MB of memory)
 Factor Ops : 4.869e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.38588156e+07  3.11418946e+08  7.18e+04 1.31e+01  5.63e+04     8s
   1  -1.08399500e+07  2.58628232e+08  5.02e+04 4.83e+01  3.89e+04     8s
   2  -5.29736679e+06  2.00624852e+08  2.33e+04 1.49e+01  1.87e+04     8s
   3  -7.86798223e+05  1.33464446e+08  1.36e+03 2.32e+00  1.40e+03     8s
   4  -5.50030186e+05  7.33954018e+07  4.38e+02 1.08e+00  5.18e+02     8s
   5  -4.72999609e+05  4.85197452e+07  2.22e+02 6.21e-01  2.85e+02     8s
   6  -4.14578931e+05  3.58172019e+07  1.13e+02 4.21e-01  1.72e+02     8s
   7  -3.42506917e+05  2.61498937e+07  4.62e+01 2.81e-01  1.01e+02     8s
   8  -2.34746483e+05  2.08973536e+07  5.51e+00 2.15e-01  6.35e+01     9s
   9  -1.64653880e+05  4.55347428e+06  1.72e+00 4.11e-02  1.38e+01     9s
  10  -1.37221964e+05  1.78322199e+06  1.14e+00 1.65e-02  5.60e+00     9s
  11  -1.11708518e+05  1.25016988e+06  7.05e-01 1.15e-02  3.96e+00     9s
  12  -1.00417989e+05  1.08913318e+06  5.20e-01 1.01e-02  3.45e+00     9s
  13  -8.98802622e+04  1.02870490e+06  3.80e-01 9.49e-03  3.24e+00     9s
  14  -6.52943194e+04  4.81491042e+05  1.10e-01 4.38e-03  1.58e+00     9s
  15  -4.79230942e+04  1.90842157e+05  5.49e-02 1.84e-03  6.89e-01     9s
  16  -4.11671385e+04  1.08890249e+05  3.90e-02 1.62e-03  4.33e-01     9s
  17  -3.74668854e+04  7.42115782e+04  3.17e-02 1.74e-03  3.22e-01     9s
  18  -3.37426401e+04  4.23413596e+04  2.53e-02 1.98e-03  2.20e-01     9s
  19  -3.09134665e+04  2.81149536e+04  2.11e-02 1.49e-03  1.70e-01    10s
  20  -2.81419556e+04  1.90675948e+04  1.72e-02 1.19e-03  1.36e-01    10s
  21  -2.61465600e+04  9.76322300e+03  1.45e-02 8.71e-04  1.04e-01    10s
  22  -2.34273058e+04  4.22274936e+03  1.09e-02 6.64e-04  7.98e-02    10s
  23  -2.23650499e+04 -1.27590112e+03  9.47e-03 6.97e-04  6.09e-02    10s
  24  -2.06523739e+04 -2.91731744e+03  7.48e-03 6.00e-04  5.12e-02    10s
  25  -1.96140730e+04 -5.50246172e+03  6.33e-03 4.61e-04  4.07e-02    10s
  26  -1.88890543e+04 -7.33374846e+03  5.56e-03 3.56e-04  3.34e-02    10s
  27  -1.78745981e+04 -7.92053646e+03  4.53e-03 3.19e-04  2.87e-02    10s
  28  -1.70511533e+04 -8.75884483e+03  3.73e-03 2.75e-04  2.39e-02    11s
  29  -1.69173561e+04 -9.01950066e+03  3.58e-03 2.61e-04  2.28e-02    11s
  30  -1.58807356e+04 -9.68535444e+03  2.58e-03 2.16e-04  1.79e-02    11s
  31  -1.56904351e+04 -1.02540223e+04  2.38e-03 1.80e-04  1.57e-02    11s
  32  -1.54193371e+04 -1.13772904e+04  2.13e-03 1.07e-04  1.17e-02    11s
  33  -1.51411373e+04 -1.16586070e+04  1.88e-03 8.72e-05  1.01e-02    11s
  34  -1.47539958e+04 -1.18537306e+04  1.53e-03 7.45e-05  8.37e-03    11s
  35  -1.46282399e+04 -1.21552741e+04  1.43e-03 5.47e-05  7.14e-03    11s
  36  -1.45516390e+04 -1.22447079e+04  1.36e-03 4.85e-05  6.66e-03    12s
  37  -1.43163759e+04 -1.23021403e+04  1.15e-03 4.48e-05  5.82e-03    12s
  38  -1.42927395e+04 -1.23641993e+04  1.12e-03 4.07e-05  5.57e-03    12s
  39  -1.40544636e+04 -1.25093027e+04  9.11e-04 3.64e-05  4.46e-03    12s
  40  -1.38685402e+04 -1.25969769e+04  7.45e-04 2.98e-05  3.67e-03    12s
  41  -1.38424203e+04 -1.26086163e+04  7.23e-04 2.89e-05  3.56e-03    12s
  42  -1.37510187e+04 -1.26222854e+04  6.46e-04 2.79e-05  3.26e-03    12s
  43  -1.36816717e+04 -1.26755739e+04  5.88e-04 2.40e-05  2.90e-03    12s
  44  -1.35963607e+04 -1.27345295e+04  5.12e-04 1.95e-05  2.49e-03    13s
  45  -1.34937120e+04 -1.27682915e+04  4.19e-04 1.69e-05  2.09e-03    13s
  46  -1.33609949e+04 -1.28317489e+04  3.05e-04 1.23e-05  1.53e-03    13s
  47  -1.32994333e+04 -1.28640418e+04  2.53e-04 9.96e-06  1.26e-03    13s
  48  -1.32389492e+04 -1.28888196e+04  2.03e-04 8.04e-06  1.01e-03    13s
  49  -1.31921959e+04 -1.28948564e+04  1.63e-04 7.61e-06  8.58e-04    13s
  50  -1.31451588e+04 -1.29096853e+04  1.23e-04 6.53e-06  6.80e-04    13s
  51  -1.30805333e+04 -1.29320841e+04  6.79e-05 4.85e-06  4.29e-04    14s
  52  -1.30568127e+04 -1.29475483e+04  4.82e-05 3.62e-06  3.15e-04    14s
  53  -1.30412026e+04 -1.29613083e+04  3.54e-05 2.58e-06  2.31e-04    14s
  54  -1.30249227e+04 -1.29751069e+04  2.23e-05 1.50e-06  1.44e-04    14s
  55  -1.30087026e+04 -1.29873008e+04  9.69e-06 5.80e-07  6.18e-05    14s
  56  -1.30027064e+04 -1.29903746e+04  5.19e-06 3.52e-07  3.56e-05    14s
  57  -1.29990572e+04 -1.29939114e+04  2.39e-06 6.83e-07  1.49e-05    14s
  58  -1.29962415e+04 -1.29950587e+04  5.59e-07 1.22e-07  3.42e-06    14s
  59  -1.29953318e+04 -1.29953075e+04  8.93e-09 4.40e-08  7.02e-08    15s
  60  -1.29953222e+04 -1.29953219e+04  5.12e-09 4.77e-11  7.21e-10    15s
  61  -1.29953221e+04 -1.29953221e+04  3.93e-08 4.54e-10  1.19e-10    15s

Barrier solved model in 61 iterations and 14.76 seconds (22.02 work units)
Optimal objective -1.29953221e+04


Root crossover log...

  150343 DPushes remaining with DInf 0.0000000e+00                15s
   84538 DPushes remaining with DInf 0.0000000e+00                15s
   28166 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

   17231 PPushes remaining with PInf 1.1451716e-04                24s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.2500683e+02     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   87060   -1.2995322e+04   0.000000e+00   2.250068e+02     25s
   87079   -1.2995322e+04   0.000000e+00   0.000000e+00     25s
   87079   -1.2995322e+04   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 6.77s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -1.299532e+04, 87079 iterations, 26.53 seconds (45.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -12995.322    0  439 -201924.56 -12995.322  93.6%     -   33s
H    0     0                    -176901.4532 -12995.322  92.7%     -   33s
H    0     0                    -176804.5439 -12995.322  92.6%     -   33s
H    0     0                    -166192.9702 -12995.322  92.2%     -   34s
H    0     0                    -165306.8650 -12995.322  92.1%     -   34s
H    0     0                    -141314.0140 -12995.322  90.8%     -   34s
H    0     0                    -137115.4478 -12995.322  90.5%     -   35s
H    0     0                    -137061.2515 -12995.322  90.5%     -   35s
H    0     0                    -136072.0872 -12995.322  90.4%     -   35s
H    0     0                    -136016.0367 -12995.322  90.4%     -   35s
H    0     0                    -135751.1877 -12995.322  90.4%     -   35s
H    0     0                    -134585.8325 -12995.322  90.3%     -   35s
H    0     0                    -134537.0939 -12995.322  90.3%     -   35s
H    0     0                    -134320.9835 -12995.322  90.3%     -   35s
H    0     0                    -134089.5175 -12995.322  90.3%     -   35s
H    0     0                    -134080.6265 -12995.322  90.3%     -   35s
H    0     0                    -133834.3447 -12995.322  90.3%     -   35s
H    0     0                    -117767.9841 -12995.322  89.0%     -   35s
H    0     0                    -117474.3094 -12995.322  88.9%     -   36s
H    0     0                    -85572.94004 -12995.322  84.8%     -   36s
H    0     0                    -83258.38585 -12995.322  84.4%     -   37s
H    0     0                    -82455.82329 -12995.322  84.2%     -   37s
     0     0 -17476.473    0  599 -82455.823 -17476.473  78.8%     -  110s
     0     0 -17479.121    0  600 -82455.823 -17479.121  78.8%     -  114s
H    0     0                    -71096.30226 -17481.563  75.4%     -  116s
H    0     0                    -65845.52896 -17481.563  73.5%     -  116s
H    0     0                    -65654.80445 -17481.563  73.4%     -  116s
H    0     0                    -62009.12441 -17481.563  71.8%     -  116s
     0     0 -17818.837    0  603 -62009.124 -17818.837  71.3%     -  144s
     0     0 -17833.098    0  604 -62009.124 -17833.098  71.2%     -  152s
     0     0 -17836.962    0  602 -62009.124 -17836.962  71.2%     -  156s
     0     0 -17837.293    0  605 -62009.124 -17837.293  71.2%     -  157s
     0     0 -20199.679    0  502 -62009.124 -20199.679  67.4%     -  241s
H    0     0                    -50461.72094 -20199.882  60.0%     -  242s
     0     0 -20397.013    0  549 -50461.721 -20397.013  59.6%     -  284s
     0     0 -20450.203    0  602 -50461.721 -20450.203  59.5%     -  303s
     0     0 -20480.702    0  521 -50461.721 -20480.702  59.4%     -  323s
     0     0 -20488.383    0  609 -50461.721 -20488.383  59.4%     -  332s
     0     0 -20650.601    0  674 -50461.721 -20650.601  59.1%     -  376s
     0     0 -20704.868    0  679 -50461.721 -20704.868  59.0%     -  403s
     0     0 -20723.714    0  672 -50461.721 -20723.714  58.9%     -  413s
     0     0 -20726.216    0  675 -50461.721 -20726.216  58.9%     -  418s
     0     0 -20728.286    0  675 -50461.721 -20728.286  58.9%     -  421s
     0     0 -20921.760    0  623 -50461.721 -20921.760  58.5%     -  450s
     0     0 -20929.525    0  625 -50461.721 -20929.525  58.5%     -  458s
     0     0 -20933.866    0  632 -50461.721 -20933.866  58.5%     -  466s
     0     0 -20942.986    0  630 -50461.721 -20942.986  58.5%     -  474s
     0     0 -20943.566    0  633 -50461.721 -20943.566  58.5%     -  476s
     0     0 -22307.998    0  725 -50461.721 -22307.998  55.8%     -  624s
H    0     0                    -50031.27005 -22308.089  55.4%     -  625s
     0     0 -22479.538    0  711 -50031.270 -22479.538  55.1%     -  673s
     0     0 -22539.781    0  726 -50031.270 -22539.781  54.9%     -  697s
     0     0 -22562.588    0  724 -50031.270 -22562.588  54.9%     -  714s
     0     0 -22643.082    0  726 -50031.270 -22643.082  54.7%     -  746s
     0     0 -22676.168    0  675 -50031.270 -22676.168  54.7%     -  765s
     0     0 -22683.059    0  673 -50031.270 -22683.059  54.7%     -  774s
     0     0 -22689.271    0  673 -50031.270 -22689.271  54.6%     -  782s
     0     0 -22707.996    0  665 -50031.270 -22707.996  54.6%     -  809s
     0     0 -22722.929    0  669 -50031.270 -22722.929  54.6%     -  826s
     0     0 -22749.025    0  673 -50031.270 -22749.025  54.5%     -  835s
     0     0 -22762.661    0  678 -50031.270 -22762.661  54.5%     -  851s
     0     0 -22763.646    0  672 -50031.270 -22763.646  54.5%     -  855s
     0     0 -23570.177    0  674 -50031.270 -23570.177  52.9%     -  953s
H    0     0                    -50023.20353 -23570.474  52.9%     -  953s
     0     0 -23697.672    0  684 -50023.204 -23697.672  52.6%     -  987s
     0     0 -23789.258    0  692 -50023.204 -23789.258  52.4%     - 1022s
     0     0 -23828.261    0  714 -50023.204 -23828.261  52.4%     - 1037s
     0     0 -23857.571    0  718 -50023.204 -23857.571  52.3%     - 1054s
     0     0 -23883.713    0  767 -50023.204 -23883.713  52.3%     - 1070s
     0     0 -23889.938    0  661 -50023.204 -23889.938  52.2%     - 1077s
     0     0 -23918.435    0  731 -50023.204 -23918.435  52.2%     - 1096s
     0     0 -23924.307    0  729 -50023.204 -23924.307  52.2%     - 1105s
     0     0 -23936.184    0  583 -50023.204 -23936.184  52.1%     - 1115s
     0     0 -23948.468    0  653 -50023.204 -23948.468  52.1%     - 1126s
     0     0 -23958.749    0  661 -50023.204 -23958.749  52.1%     - 1136s
     0     0 -23959.362    0  660 -50023.204 -23959.362  52.1%     - 1139s
     0     0 -24242.829    0  693 -50023.204 -24242.829  51.5%     - 1191s
     0     0 -24283.106    0  727 -50023.204 -24283.106  51.5%     - 1213s
     0     0 -24324.421    0  724 -50023.204 -24324.421  51.4%     - 1231s
     0     0 -24349.646    0  776 -50023.204 -24349.646  51.3%     - 1247s
     0     0 -24359.498    0  782 -50023.204 -24359.498  51.3%     - 1257s
     0     0 -24363.375    0  741 -50023.204 -24363.375  51.3%     - 1262s
     0     0 -24371.610    0  792 -50023.204 -24371.610  51.3%     - 1268s
     0     0 -24374.869    0  790 -50023.204 -24374.869  51.3%     - 1272s
     0     0 -24377.088    0  795 -50023.204 -24377.088  51.3%     - 1275s
     0     0 -24377.693    0  681 -50023.204 -24377.693  51.3%     - 1277s
     0     0 -24575.473    0  757 -50023.204 -24575.473  50.9%     - 1321s
H    0     0                    -49356.27190 -24575.507  50.2%     - 1323s
H    0     0                    -49193.98939 -24575.507  50.0%     - 1325s
H    0     0                    -49050.48878 -24575.507  49.9%     - 1325s
H    0     0                    -48972.62087 -24575.507  49.8%     - 1326s
     0     0 -24621.377    0  770 -48972.621 -24621.377  49.7%     - 1342s
     0     0 -24631.622    0  770 -48972.621 -24631.622  49.7%     - 1352s
     0     0 -24638.307    0  777 -48972.621 -24638.307  49.7%     - 1360s
     0     0 -24640.610    0  783 -48972.621 -24640.610  49.7%     - 1364s
     0     0 -24641.711    0  785 -48972.621 -24641.711  49.7%     - 1368s
     0     0 -24741.151    0  783 -48972.621 -24741.151  49.5%     - 1405s
     0     0 -24767.099    0  797 -48972.621 -24767.099  49.4%     - 1424s
     0     0 -24776.647    0  801 -48972.621 -24776.647  49.4%     - 1436s
     0     0 -24778.973    0  806 -48972.621 -24778.973  49.4%     - 1442s
     0     0 -24782.510    0  812 -48972.621 -24782.510  49.4%     - 1449s
     0     0 -24785.566    0  806 -48972.621 -24785.566  49.4%     - 1457s
     0     0 -24815.591    0  743 -48972.621 -24815.591  49.3%     - 1473s
     0     0 -24822.511    0  741 -48972.621 -24822.511  49.3%     - 1480s
     0     0 -24824.500    0  806 -48972.621 -24824.500  49.3%     - 1485s
     0     0 -24825.408    0  763 -48972.621 -24825.408  49.3%     - 1489s
     0     0 -24878.767    0  812 -48972.621 -24878.767  49.2%     - 1520s
     0     0 -24891.864    0  800 -48972.621 -24891.864  49.2%     - 1533s
     0     0 -24904.158    0  730 -48972.621 -24904.158  49.1%     - 1544s
     0     0 -24910.636    0  798 -48972.621 -24910.636  49.1%     - 1552s
     0     0 -24913.248    0  809 -48972.621 -24913.248  49.1%     - 1555s
     0     0 -24914.765    0  810 -48972.621 -24914.765  49.1%     - 1559s
     0     0 -24959.371    0  814 -48972.621 -24959.371  49.0%     - 1583s
     0     0 -24970.738    0  764 -48972.621 -24970.738  49.0%     - 1593s
     0     0 -24977.903    0  770 -48972.621 -24977.903  49.0%     - 1599s
     0     0 -24980.612    0  788 -48972.621 -24980.612  49.0%     - 1604s
     0     0 -24980.922    0  786 -48972.621 -24980.922  49.0%     - 1607s
     0     0 -24996.327    0  823 -48972.621 -24996.327  49.0%     - 1626s
     0     0 -25001.550    0  841 -48972.621 -25001.550  48.9%     - 1633s
     0     0 -25002.877    0  792 -48972.621 -25002.877  48.9%     - 1636s
     0     0 -25010.864    0  789 -48972.621 -25010.864  48.9%     - 1649s
H    0     0                    -48962.49588 -25011.146  48.9%     - 1651s
     0     0 -25013.528    0  836 -48962.496 -25013.528  48.9%     - 1657s
     0     0 -25015.373    0  785 -48962.496 -25015.373  48.9%     - 1664s
     0     0 -25016.250    0  830 -48962.496 -25016.250  48.9%     - 1668s
     0     0 -25021.293    0  834 -48962.496 -25021.293  48.9%     - 1677s
H    0     0                    -48124.87122 -25021.312  48.0%     - 1684s
H    0     0                    -46090.21208 -25021.312  45.7%     - 1685s
H    0     0                    -42128.77440 -25021.312  40.6%     - 1686s
H    0     0                    -42020.77675 -25021.312  40.5%     - 1687s
     0     0 -25022.269    0  839 -42020.777 -25022.269  40.5%     - 1689s
     0     0 -25026.522    0  781 -42020.777 -25026.522  40.4%     - 1701s
     0     0 -25026.531    0  781 -42020.777 -25026.531  40.4%     - 1716s
H    0     0                    -33546.60279 -25026.534  25.4%     - 1745s
H    0     0                    -32031.80075 -25026.534  21.9%     - 1770s
H    0     0                    -32000.99058 -25026.534  21.8%     - 1770s
H    0     0                    -31986.84379 -25026.534  21.8%     - 1770s
H    0     0                    -31948.44347 -25026.534  21.7%     - 1770s
H    0     0                    -31934.31292 -25026.534  21.6%     - 1770s
H    0     0                    -31928.05981 -25026.534  21.6%     - 1770s
H    0     0                    -31921.49325 -25026.534  21.6%     - 1770s
H    0     0                    -31906.33910 -25026.534  21.6%     - 1770s
H    0     0                    -31708.78603 -25026.534  21.1%     - 1870s
H    0     0                    -31681.33079 -25026.534  21.0%     - 1876s
H    0     0                    -31662.58480 -25026.534  21.0%     - 1876s
H    0     0                    -31640.26912 -25026.534  20.9%     - 1876s
     0     2 -25026.534    0  781 -31640.269 -25026.534  20.9%     - 1882s
     1     3 -25068.249    1  794 -31640.269 -25026.675  20.9%  9386 1899s
     2     4 -25097.589    1  682 -31640.269 -25068.301  20.8%  7234 1912s
     3     6 -25186.585    2  767 -31640.269 -25068.451  20.8%  7526 1931s
     5    10 -26001.640    3  482 -31640.269 -25097.856  20.7%  8835 1953s
     9    17 -26119.788    4  476 -31640.269 -25186.762  20.4%  8874 1987s
    16    34 -25387.012    4  777 -31640.269 -25206.870  20.3% 12399 2024s
    33    45 -26039.733    5  608 -31640.269 -25387.054  19.8% 19085 2145s
    48    63 infeasible    6      -31640.269 -25387.054  19.8% 24872 2328s
H   54    63                    -31451.42758 -25387.054  19.3% 23419 2328s
    68   148 -26086.222    7  610 -31451.428 -25387.054  19.3% 20299 2418s
   167   200 -26219.605   10  588 -31451.428 -25387.054  19.3% 12283 2457s
H  168   200                    -31451.42574 -25387.054  19.3% 12210 2457s
   225   295 -26264.722   11  577 -31451.426 -25387.054  19.3% 11872 2495s
   326   360 -26343.565   14  576 -31451.426 -25387.054  19.3% 10116 2528s
   399   427 -26467.681   15  643 -31451.426 -25387.054  19.3%  9521 2551s
   470   465 -26847.036   16  503 -31451.426 -25387.054  19.3%  8918 2576s
   524   506 -26918.051   17  496 -31451.426 -25387.054  19.3%  8693 2602s
   603   536 -29914.642   16  145 -31451.426 -25387.054  19.3%  8284 2623s
   648   564 -28649.396   17  393 -31451.426 -25387.054  19.3%  8135 2643s
H  696   564                    -31423.14378 -25387.054  19.2%  7952 2643s
   738   584 -27258.247   17  520 -31423.144 -25387.054  19.2%  7722 2664s
   821   578 -27477.656   18  511 -31423.144 -25387.054  19.2%  7425 2689s
   899   632 -28511.447   18  389 -31423.144 -25387.054  19.2%  7130 2708s
   973   652     cutoff   19      -31423.144 -25387.054  19.2%  7087 2731s
  1102   642 infeasible   12      -31423.144 -25387.054  19.2%  6677 2756s
  1189   643 infeasible   13      -31423.144 -25387.054  19.2%  6513 2783s
  1250   670 -27947.778   13  424 -31423.144 -25387.054  19.2%  6507 2807s
H 1260   670                    -31416.45704 -25387.054  19.2%  6479 2807s
  1350   665 -28573.018   14  271 -31416.457 -25387.054  19.2%  6292 2833s
  1466   687 -28769.609   14  402 -31416.457 -25387.054  19.2%  6012 2862s
  1520   737 -31293.867   15  200 -31416.457 -25387.054  19.2%  6070 2888s
  1614   784 -31398.274   16  191 -31416.457 -25387.054  19.2%  6155 2920s
  1740   791 infeasible   16      -31416.457 -25387.054  19.2%  6055 2951s
H 1816   791                    -31415.06796 -25387.054  19.2%  6031 2951s
  1856   805 -29062.426   11  143 -31415.068 -25387.054  19.2%  6027 2986s
  1947   835 -30034.260   13  205 -31415.068 -25387.054  19.2%  6065 3022s
  2049   859 -30368.247   14  198 -31415.068 -25387.054  19.2%  6041 3056s
  2150   867 -30992.426   17  250 -31415.068 -25387.054  19.2%  6021 3093s
  2203   895 infeasible   18      -31415.068 -25387.054  19.2%  6131 3132s
  2256   904 -27847.626   18  172 -31415.068 -25387.054  19.2%  6306 3176s
  2338   909 -29231.328   16  408 -31415.068 -25387.054  19.2%  6344 3216s
  2412   934 infeasible   17      -31415.068 -25387.054  19.2%  6442 3253s
H 2439   934                    -31411.79990 -25387.054  19.2%  6571 3253s
  2465   961 -28073.775    7  220 -31411.800 -25387.054  19.2%  6553 3297s
  2598   988     cutoff    8      -31411.800 -25387.054  19.2%  6524 3346s
  2716  1027 -28129.605    9  207 -31411.800 -25387.054  19.2%  6568 3391s
  2834  1036 infeasible   12      -31411.800 -25387.054  19.2%  6695 3440s
  2877  1054 -30265.292   13   74 -31411.800 -25387.054  19.2%  6762 3487s
  2954  1069 infeasible   12      -31411.800 -25387.054  19.2%  6809 3528s
  3025  1082     cutoff   14      -31411.800 -25387.054  19.2%  6870 3580s
  3068  1106 infeasible   14      -31411.800 -25387.054  19.2%  6943 3600s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 353
  MIR: 5177
  Flow cover: 6707
  Zero half: 7
  RLT: 101
  Relax-and-lift: 960

Explored 3124 nodes (22729112 simplex iterations) in 3600.09 seconds (8200.19 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31411.8 -31415.1 -31416.5 ... -31708.8

Time limit reached
Best objective -3.141179990064e+04, best bound -2.538705424042e+04, gap 19.1799%
  WARNING: Time limit reached. Using best solution found (gap: 19.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -31411.80, θ = 93520.78
  Upper Bound (UB) = -31411.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93520.78
  [DEBUG]   ✓ Scenario 0: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 93520.78 ≤ Q = 93520.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 93520.78 ≤ Q = 93520.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1ec63e05
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1ec63e05
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.170990e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5447425.9954
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.239450e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123945.05    0  124 5447426.00 -123945.05   102%     -    0s
H    0     0                    -90072.63694 -123945.05  37.6%     -    0s
H    0     0                    -90631.31707 -123945.05  36.8%     -    0s
H    0     0                    -92937.58196 -96248.466  3.56%     -    0s
     0     0 -96248.466    0   71 -92937.582 -96248.466  3.56%     -    0s
H    0     0                    -93225.65712 -96199.649  3.19%     -    0s
H    0     0                    -94172.30217 -96199.649  2.15%     -    0s
H    0     0                    -94460.37732 -96199.649  1.84%     -    0s
     0     0 -95722.398    0   70 -94460.377 -95722.398  1.34%     -    0s
     0     0 -95534.616    0   74 -94460.377 -95534.616  1.14%     -    0s
     0     0 -95505.963    0   74 -94460.377 -95505.963  1.11%     -    0s
     0     2 -95505.963    0   74 -94460.377 -95505.963  1.11%     -    0s
H   47    43                    -94522.52803 -95145.200  0.66%  13.1    0s
H   48    38                    -94646.79645 -95145.200  0.53%  12.9    0s
*  327   194              14    -94695.55622 -95113.689  0.44%   6.3    0s
*  457   202              18    -94732.31910 -95113.689  0.40%   5.7    0s
*  482   202              16    -94761.90221 -95113.689  0.37%   5.6    0s
*  723   119              17    -94803.84609 -94915.988  0.12%   5.6    0s

Cutting planes:
  Gomory: 22
  Implied bound: 3
  MIR: 165
  RLT: 3

Explored 955 nodes (5570 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -94803.8 -94761.9 -94732.3 ... -90072.6
No other solutions better than -94803.8

Optimal solution found (tolerance 1.00e-06)
Best objective -9.480384609084e+04, best bound -9.480384609084e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 92033.55
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94803.85
  [DEBUG]   S×d_nominal = 186837.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186837.40 + -94803.85 = 92033.55
  [DEBUG]   Current θ from Master = 93520.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1487.23 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -32899.03
  Lower Bound (LB) = -32243.98
  Gap (UB-LB) = 832.1801, Absolute Gap = 832.1801, Relative Gap = 0.026493
  Not converged yet (gap = 832.18 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043063 nonzeros
Model fingerprint: 0x64e53e12
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 169680 rows and 68880 columns
Presolve time: 4.26s
Presolved: 198663 rows, 83140 columns, 1222066 nonzeros
Variable types: 80881 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -427170.7784
Found heuristic solution: objective -201924.5621

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.50s

Barrier statistics:
 Dense cols : 1150
 AA' NZ     : 5.395e+06
 Factor NZ  : 1.523e+07 (roughly 240 MB of memory)
 Factor Ops : 5.588e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.38656297e+07  3.21916597e+08  7.19e+04 1.26e+01  5.60e+04     7s
   1  -1.08711370e+07  2.67133136e+08  5.02e+04 4.80e+01  3.87e+04     7s
   2  -5.30533615e+06  2.10330935e+08  2.33e+04 1.37e+01  1.86e+04     7s
   3  -7.90318608e+05  1.38920396e+08  1.39e+03 1.82e+00  1.43e+03     7s
   4  -5.42485056e+05  7.33506182e+07  4.02e+02 6.74e-01  4.81e+02     7s
   5  -4.82683342e+05  4.75750097e+07  2.41e+02 3.73e-01  2.85e+02     7s
   6  -4.31662410e+05  3.49800880e+07  1.33e+02 2.48e-01  1.76e+02     7s
   7  -3.50940440e+05  2.65230894e+07  5.10e+01 1.72e-01  1.01e+02     7s
   8  -2.14756589e+05  1.84826048e+07  8.13e+00 1.11e-01  5.52e+01     7s
   9  -1.60508588e+05  7.20692466e+06  4.44e+00 4.01e-02  2.12e+01     8s
  10  -1.23250407e+05  4.20464171e+06  1.63e+00 2.28e-02  1.22e+01     8s
  11  -1.18404760e+05  3.44956508e+06  1.38e+00 1.86e-02  1.00e+01     8s
  12  -1.03343930e+05  2.46629697e+06  6.73e-01 1.32e-02  7.16e+00     8s
  13  -8.90466254e+04  1.91389861e+06  3.37e-01 1.01e-02  5.56e+00     8s
  14  -7.53665087e+04  3.66031671e+05  1.57e-01 1.96e-03  1.22e+00     8s
  15  -6.27225711e+04  1.57086048e+05  9.43e-02 1.03e-03  6.09e-01     8s
  16  -4.91643819e+04  1.09213946e+05  5.79e-02 9.75e-04  4.39e-01     8s
  17  -4.55206448e+04  7.61564204e+04  5.15e-02 1.35e-03  3.37e-01     8s
  18  -3.97021229e+04  5.64141591e+04  4.09e-02 1.16e-03  2.66e-01     8s
  19  -3.39057089e+04  3.94766946e+04  3.08e-02 1.49e-03  2.03e-01     8s
  20  -3.22754264e+04  2.93150361e+04  2.81e-02 1.28e-03  1.71e-01     9s
  21  -2.86272397e+04  2.35717888e+04  2.17e-02 1.11e-03  1.45e-01     9s
  22  -2.73343885e+04  1.82327880e+04  1.94e-02 8.92e-04  1.26e-01     9s
  23  -2.54805142e+04  8.73803697e+03  1.59e-02 8.11e-04  9.47e-02     9s
  24  -2.35926956e+04  3.47412300e+03  1.30e-02 6.23e-04  7.49e-02     9s
  25  -2.25725156e+04 -1.88037204e+02  1.16e-02 4.88e-04  6.20e-02     9s
  26  -2.15589635e+04 -2.94831226e+03  1.01e-02 3.86e-04  5.15e-02     9s
  27  -2.02317106e+04 -4.61411526e+03  8.24e-03 3.27e-04  4.32e-02     9s
  28  -1.91371962e+04 -5.88183212e+03  6.74e-03 2.79e-04  3.67e-02     9s
  29  -1.84280927e+04 -8.25923676e+03  5.83e-03 2.28e-04  2.82e-02    10s
  30  -1.78847785e+04 -8.97143489e+03  5.18e-03 1.95e-04  2.47e-02    10s
  31  -1.74558349e+04 -9.88511105e+03  4.69e-03 1.93e-04  2.10e-02    10s
  32  -1.63356403e+04 -1.10486342e+04  3.43e-03 1.55e-04  1.46e-02    10s
  33  -1.61021803e+04 -1.14702051e+04  3.15e-03 1.25e-04  1.28e-02    10s
  34  -1.53114174e+04 -1.19026880e+04  2.29e-03 9.07e-05  9.44e-03    10s
  35  -1.51284206e+04 -1.22767282e+04  2.09e-03 6.36e-05  7.90e-03    10s
  36  -1.47470083e+04 -1.23363460e+04  1.70e-03 5.89e-05  6.68e-03    10s
  37  -1.46276195e+04 -1.23563604e+04  1.57e-03 5.74e-05  6.29e-03    11s
  38  -1.43940383e+04 -1.24988010e+04  1.32e-03 4.62e-05  5.25e-03    11s
  39  -1.43296776e+04 -1.26178275e+04  1.25e-03 3.76e-05  4.74e-03    11s
  40  -1.41457103e+04 -1.27541595e+04  1.05e-03 2.76e-05  3.85e-03    11s
  41  -1.40946275e+04 -1.27690357e+04  9.97e-04 2.65e-05  3.67e-03    11s
  42  -1.39963061e+04 -1.27880897e+04  8.95e-04 2.51e-05  3.35e-03    11s
  43  -1.38857567e+04 -1.28457798e+04  7.73e-04 2.11e-05  2.88e-03    11s
  44  -1.38019949e+04 -1.29162532e+04  6.82e-04 1.62e-05  2.45e-03    11s
  45  -1.37492426e+04 -1.29526820e+04  6.27e-04 1.36e-05  2.21e-03    12s
  46  -1.36280424e+04 -1.29952019e+04  4.93e-04 1.08e-05  1.75e-03    12s
  47  -1.35329195e+04 -1.30196857e+04  3.89e-04 9.18e-06  1.42e-03    12s
  48  -1.34463827e+04 -1.30640274e+04  2.96e-04 1.57e-05  1.06e-03    12s
  49  -1.34095027e+04 -1.30844424e+04  2.57e-04 1.19e-05  9.00e-04    12s
  50  -1.33430475e+04 -1.30934919e+04  1.88e-04 1.01e-05  6.91e-04    12s
  51  -1.33130699e+04 -1.31053625e+04  1.57e-04 7.94e-06  5.75e-04    12s
  52  -1.32879313e+04 -1.31227879e+04  1.31e-04 5.09e-06  4.57e-04    13s
  53  -1.32831172e+04 -1.31252131e+04  1.27e-04 4.73e-06  4.37e-04    13s
  54  -1.32261068e+04 -1.31351541e+04  6.89e-05 2.90e-06  2.52e-04    13s
  55  -1.32003711e+04 -1.31441386e+04  4.44e-05 1.45e-06  1.56e-04    13s
  56  -1.31631132e+04 -1.31507968e+04  8.09e-06 4.56e-07  3.41e-05    13s
  57  -1.31618601e+04 -1.31532356e+04  6.97e-06 7.00e-08  2.39e-05    13s
  58  -1.31551237e+04 -1.31538091e+04  6.92e-07 5.82e-08  3.65e-06    13s
  59  -1.31541172e+04 -1.31539709e+04  6.84e-08 9.41e-09  4.06e-07    13s
  60  -1.31540699e+04 -1.31540038e+04  2.81e-06 7.75e-06  1.83e-07    13s
  61  -1.31540127e+04 -1.31540044e+04  3.52e-07 3.29e-07  2.30e-08    14s
  62  -1.31540089e+04 -1.31540044e+04  5.35e-06 2.44e-06  1.30e-08    14s
  63  -1.31540072e+04 -1.31540044e+04  3.38e-06 1.50e-06  8.28e-09    14s
  64  -1.31540059e+04 -1.31540044e+04  1.71e-06 9.29e-07  4.61e-09    14s
  65  -1.31540050e+04 -1.31540044e+04  3.43e-06 3.51e-09  1.92e-09    14s
  66  -1.31540047e+04 -1.31540044e+04  2.17e-06 3.17e-07  1.01e-09    14s
  67  -1.31540046e+04 -1.31540044e+04  1.08e-06 2.19e-07  5.07e-10    14s
  68  -1.31540046e+04 -1.31540044e+04  9.93e-07 2.10e-07  4.64e-10    14s
  69  -1.31540045e+04 -1.31540044e+04  1.77e-06 2.07e-07  4.54e-10    14s

Barrier solved model in 69 iterations and 14.29 seconds (23.19 work units)
Optimal objective -1.31540045e+04


Root crossover log...

  155119 DPushes remaining with DInf 0.0000000e+00                14s
   86323 DPushes remaining with DInf 0.0000000e+00                15s
   38679 DPushes remaining with DInf 0.0000000e+00                20s
   14507 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                29s

   37405 PPushes remaining with PInf 5.8137680e-04                29s
    9257 PPushes remaining with PInf 4.2931154e-04                30s
       0 PPushes remaining with PInf 0.0000000e+00                31s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.5497256e+04     31s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  122936   -1.3154004e+04   0.000000e+00   3.549726e+04     31s
  123222   -1.3154004e+04   0.000000e+00   0.000000e+00     32s
  123222   -1.3154004e+04   0.000000e+00   0.000000e+00     32s
Concurrent spin time: 12.70s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -1.315400e+04, 123222 iterations, 39.57 seconds (67.43 work units)
Total elapsed time = 45.42s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13154.004    0  456 -201924.56 -13154.004  93.5%     -   46s
H    0     0                    -160392.9329 -13154.004  91.8%     -   47s
H    0     0                    -159692.8446 -13154.004  91.8%     -   47s
H    0     0                    -146917.6307 -13154.004  91.0%     -   47s
H    0     0                    -143500.2835 -13154.004  90.8%     -   48s
H    0     0                    -102597.7487 -13154.004  87.2%     -   48s
H    0     0                    -69238.63204 -13154.004  81.0%     -   49s
H    0     0                    -55886.37285 -13154.004  76.5%     -   49s
H    0     0                    -55708.93745 -13154.004  76.4%     -   49s
     0     0 -17711.330    0  602 -55708.937 -17711.330  68.2%     -  111s
H    0     0                    -54734.09513 -17712.943  67.6%     -  112s
H    0     0                    -54729.43799 -17712.943  67.6%     -  112s
H    0     0                    -54633.27416 -17712.943  67.6%     -  112s
H    0     0                    -54438.12511 -17712.943  67.5%     -  112s
H    0     0                    -54433.46798 -17712.943  67.5%     -  112s
     0     0 -17870.560    0  610 -54433.468 -17870.560  67.2%     -  135s
     0     0 -17882.154    0  614 -54433.468 -17882.154  67.1%     -  145s
     0     0 -17891.441    0  615 -54433.468 -17891.441  67.1%     -  148s
     0     0 -17891.448    0  615 -54433.468 -17891.448  67.1%     -  149s
     0     0 -20288.804    0  537 -54433.468 -20288.804  62.7%     -  263s
H    0     0                    -54373.23596 -20288.887  62.7%     -  264s
     0     0 -20502.480    0  551 -54373.236 -20502.480  62.3%     -  297s
     0     0 -20583.342    0  550 -54373.236 -20583.342  62.1%     -  313s
     0     0 -20666.850    0  553 -54373.236 -20666.850  62.0%     -  333s
     0     0 -20706.552    0  546 -54373.236 -20706.552  61.9%     -  345s
     0     0 -20827.228    0  695 -54373.236 -20827.228  61.7%     -  383s
     0     0 -20892.592    0  710 -54373.236 -20892.592  61.6%     -  405s
     0     0 -20897.646    0  643 -54373.236 -20897.646  61.6%     -  410s
     0     0 -20933.161    0  700 -54373.236 -20933.161  61.5%     -  425s
     0     0 -20977.347    0  700 -54373.236 -20977.347  61.4%     -  438s
     0     0 -20979.572    0  688 -54373.236 -20979.572  61.4%     -  442s
     0     0 -20997.535    0  693 -54373.236 -20997.535  61.4%     -  450s
     0     0 -21005.297    0  691 -54373.236 -21005.297  61.4%     -  458s
     0     0 -21057.359    0  692 -54373.236 -21057.359  61.3%     -  477s
     0     0 -21066.051    0  629 -54373.236 -21066.051  61.3%     -  487s
     0     0 -21067.038    0  642 -54373.236 -21067.038  61.3%     -  490s
     0     0 -21076.281    0  640 -54373.236 -21076.281  61.2%     -  493s
     0     0 -21083.730    0  642 -54373.236 -21083.730  61.2%     -  497s
     0     0 -21083.746    0  642 -54373.236 -21083.746  61.2%     -  498s
     0     0 -22411.773    0  582 -54373.236 -22411.773  58.8%     -  640s
H    0     0                    -51522.41435 -22411.883  56.5%     -  641s
     0     0 -22636.858    0  591 -51522.414 -22636.858  56.1%     -  693s
     0     0 -22711.343    0  685 -51522.414 -22711.343  55.9%     -  723s
     0     0 -22827.680    0  618 -51522.414 -22827.680  55.7%     -  747s
     0     0 -22849.983    0  629 -51522.414 -22849.983  55.7%     -  764s
     0     0 -22946.162    0  621 -51522.414 -22946.162  55.5%     -  792s
     0     0 -22966.398    0  615 -51522.414 -22966.398  55.4%     -  807s
     0     0 -22993.740    0  688 -51522.414 -22993.740  55.4%     -  822s
     0     0 -23007.420    0  686 -51522.414 -23007.420  55.3%     -  832s
     0     0 -23055.889    0  634 -51522.414 -23055.889  55.3%     -  846s
     0     0 -23087.784    0  628 -51522.414 -23087.784  55.2%     -  863s
     0     0 -23100.736    0  626 -51522.414 -23100.736  55.2%     -  871s
     0     0 -23124.373    0  622 -51522.414 -23124.373  55.1%     -  885s
     0     0 -23128.838    0  624 -51522.414 -23128.838  55.1%     -  891s
     0     0 -23134.524    0  697 -51522.414 -23134.524  55.1%     -  898s
     0     0 -23135.464    0  693 -51522.414 -23135.464  55.1%     -  901s
     0     0 -23734.475    0  689 -51522.414 -23734.475  53.9%     - 1019s
H    0     0                    -51437.10898 -23734.599  53.9%     - 1021s
     0     0 -23924.974    0  709 -51437.109 -23924.974  53.5%     - 1075s
     0     0 -23955.529    0  723 -51437.109 -23955.529  53.4%     - 1092s
     0     0 -23962.768    0  724 -51437.109 -23962.768  53.4%     - 1103s
     0     0 -23973.694    0  727 -51437.109 -23973.694  53.4%     - 1116s
     0     0 -23978.691    0  728 -51437.109 -23978.691  53.4%     - 1124s
     0     0 -23982.281    0  739 -51437.109 -23982.281  53.4%     - 1129s
     0     0 -24002.024    0  739 -51437.109 -24002.024  53.3%     - 1142s
     0     0 -24003.758    0  734 -51437.109 -24003.758  53.3%     - 1146s
     0     0 -24004.461    0  736 -51437.109 -24004.461  53.3%     - 1149s
     0     0 -24189.060    0  708 -51437.109 -24189.060  53.0%     - 1216s
H    0     0                    -49183.81862 -24189.073  50.8%     - 1217s
H    0     0                    -42951.05550 -24189.073  43.7%     - 1217s
H    0     0                    -41178.87411 -24189.073  41.3%     - 1217s
H    0     0                    -36854.08147 -24189.073  34.4%     - 1217s
H    0     0                    -34947.22338 -24189.073  30.8%     - 1217s
     0     0 -24263.008    0  631 -34947.223 -24263.008  30.6%     - 1255s
     0     0 -24283.135    0  710 -34947.223 -24283.135  30.5%     - 1269s
     0     0 -24286.614    0  721 -34947.223 -24286.614  30.5%     - 1274s
     0     0 -24291.504    0  720 -34947.223 -24291.504  30.5%     - 1280s
     0     0 -24293.157    0  731 -34947.223 -24293.157  30.5%     - 1285s
     0     0 -24426.948    0  742 -34947.223 -24426.948  30.1%     - 1336s
H    0     0                    -31878.35273 -24427.155  23.4%     - 1340s
H    0     0                    -31817.87190 -24427.155  23.2%     - 1345s
H    0     0                    -31790.77018 -24427.155  23.2%     - 1345s
H    0     0                    -31761.85185 -24427.155  23.1%     - 1346s
H    0     0                    -31582.04216 -24427.155  22.7%     - 1346s
H    0     0                    -31569.16915 -24427.155  22.6%     - 1347s
     0     0 -24469.525    0  789 -31569.169 -24469.525  22.5%     - 1376s
     0     0 -24488.838    0  785 -31569.169 -24488.838  22.4%     - 1396s
     0     0 -24496.539    0  790 -31569.169 -24496.539  22.4%     - 1408s
     0     0 -24513.318    0  792 -31569.169 -24513.318  22.4%     - 1422s
     0     0 -24519.133    0  810 -31569.169 -24519.133  22.3%     - 1433s
     0     0 -24520.873    0  808 -31569.169 -24520.873  22.3%     - 1438s
     0     0 -24522.609    0  797 -31569.169 -24522.609  22.3%     - 1444s
     0     0 -24532.856    0  783 -31569.169 -24532.856  22.3%     - 1458s
     0     0 -24542.305    0  779 -31569.169 -24542.305  22.3%     - 1473s
     0     0 -24544.958    0  802 -31569.169 -24544.958  22.3%     - 1479s
     0     0 -24547.460    0  789 -31569.169 -24547.460  22.2%     - 1485s
     0     0 -24548.241    0  792 -31569.169 -24548.241  22.2%     - 1488s
     0     0 -24645.630    0  771 -31569.169 -24645.630  21.9%     - 1539s
     0     0 -24676.335    0  795 -31569.169 -24676.335  21.8%     - 1563s
     0     0 -24682.071    0  753 -31569.169 -24682.071  21.8%     - 1568s
     0     0 -24684.176    0  752 -31569.169 -24684.176  21.8%     - 1573s
     0     0 -24688.633    0  760 -31569.169 -24688.633  21.8%     - 1577s
     0     0 -24691.451    0  763 -31569.169 -24691.451  21.8%     - 1582s
     0     0 -24693.047    0  764 -31569.169 -24693.047  21.8%     - 1586s
     0     0 -24732.805    0  699 -31569.169 -24732.805  21.7%     - 1613s
     0     0 -24744.956    0  687 -31569.169 -24744.956  21.6%     - 1630s
     0     0 -24747.348    0  699 -31569.169 -24747.348  21.6%     - 1639s
     0     0 -24749.482    0  701 -31569.169 -24749.482  21.6%     - 1643s
     0     0 -24751.316    0  693 -31569.169 -24751.316  21.6%     - 1647s
     0     0 -24751.867    0  696 -31569.169 -24751.867  21.6%     - 1649s
     0     0 -24781.225    0  689 -31569.169 -24781.225  21.5%     - 1678s
     0     0 -24790.297    0  694 -31569.169 -24790.297  21.5%     - 1691s
     0     0 -24794.907    0  697 -31569.169 -24794.907  21.5%     - 1698s
     0     0 -24796.161    0  698 -31569.169 -24796.161  21.5%     - 1703s
     0     0 -24811.353    0  747 -31569.169 -24811.353  21.4%     - 1722s
     0     0 -24822.856    0  760 -31569.169 -24822.856  21.4%     - 1737s
     0     0 -24829.494    0  806 -31569.169 -24829.494  21.3%     - 1748s
     0     0 -24833.114    0  770 -31569.169 -24833.114  21.3%     - 1754s
     0     0 -24837.258    0  768 -31569.169 -24837.258  21.3%     - 1761s
     0     0 -24839.034    0  806 -31569.169 -24839.034  21.3%     - 1767s
     0     0 -24839.611    0  764 -31569.169 -24839.611  21.3%     - 1770s
     0     0 -24850.329    0  684 -31569.169 -24850.329  21.3%     - 1788s
     0     0 -24854.056    0  775 -31569.169 -24854.056  21.3%     - 1797s
     0     0 -24857.484    0  696 -31569.169 -24857.484  21.3%     - 1805s
     0     0 -24858.265    0  789 -31569.169 -24858.265  21.3%     - 1809s
     0     0 -24869.040    0  823 -31569.169 -24869.040  21.2%     - 1828s
H    0     0                    -31558.96164 -24869.042  21.2%     - 1841s
H    0     0                    -31499.69871 -24869.042  21.0%     - 1848s
     0     0 -24873.534    0  745 -31499.699 -24873.534  21.0%     - 1860s
     0     0 -24876.329    0  749 -31499.699 -24876.329  21.0%     - 1866s
     0     0 -24878.462    0  829 -31499.699 -24878.462  21.0%     - 1872s
     0     0 -24879.206    0  827 -31499.699 -24879.206  21.0%     - 1876s
     0     0 -24884.034    0  786 -31499.699 -24884.034  21.0%     - 1889s
     0     0 -24886.049    0  788 -31499.699 -24886.049  21.0%     - 1896s
     0     0 -24886.985    0  786 -31499.699 -24886.985  21.0%     - 1899s
     0     0 -24892.068    0  785 -31499.699 -24892.068  21.0%     - 1912s
     0     0 -24892.152    0  785 -31499.699 -24892.152  21.0%     - 1929s
H    0     0                    -31474.95240 -24892.167  20.9%     - 1988s
H    0     0                    -31452.05644 -24892.223  20.9%     - 2246s
     0     2 -24892.223    0  785 -31452.056 -24892.223  20.9%     - 2336s
     1     3 -25248.124    1  465 -31452.056 -24892.223  20.9% 14561 2366s
     2     4 -24906.797    1  764 -31452.056 -24906.797  20.8%  8406 2377s
     3     6 -25503.457    2  474 -31452.056 -24906.929  20.8%  8026 2394s
     5    10 -25726.716    3  463 -31452.056 -24906.929  20.8% 10115 2423s
     9    18 -25797.650    4  460 -31452.056 -25102.888  20.2% 10850 2459s
    17    24 -27603.587    5  239 -31452.056 -25103.233  20.2% 15035 2589s
    25    42 -28415.553    4  280 -31452.056 -25178.085  19.9% 16089 2863s
H   45    73                    -31427.36905 -25178.085  19.9% 51257 2959s
H   71    73                    -31424.10099 -25178.085  19.9% 37152 2960s
    76   209 -28507.617    6  267 -31424.101 -25178.085  19.9% 36044 3035s
   212   238 -28783.436    9  244 -31424.101 -25178.085  19.9% 15589 3064s
   241   283 -29209.592   11  235 -31424.101 -25178.085  19.9% 14185 3093s
   286   307 -29634.705   12  230 -31424.101 -25178.085  19.9% 12498 3121s
   312   347 -29338.681   12  239 -31424.101 -25178.085  19.9% 11805 3148s
   358   379 -29568.856   13  232 -31424.101 -25178.085  19.9% 10747 3177s
   402   412 -29720.441   13  239 -31424.101 -25178.085  19.9% 10009 3206s
   451   429 -29625.458   14  219 -31424.101 -25178.085  19.9%  9381 3241s
   504   447 -30722.517   16  176 -31424.101 -25178.085  19.9%  8781 3277s
   551   459 -29106.518   19  136 -31424.101 -25178.085  19.9%  8459 3310s
   597   474 -30994.390   17  192 -31424.101 -25178.085  19.9%  8059 3344s
   636   488 infeasible   16      -31424.101 -25178.085  19.9%  7860 3378s
   685   534 -30193.972   24   81 -31424.101 -25178.085  19.9%  7623 3404s
   752   587 -30868.299   29   52 -31424.101 -25178.085  19.9%  7199 3432s
   843   644 -31135.679   34   40 -31424.101 -25178.085  19.9%  6692 3456s
   963   635     cutoff   40      -31424.101 -25178.085  19.9%  6037 3485s
  1082   629 -31170.035   42   11 -31424.101 -25178.085  19.9%  5602 3517s
  1154   634 -27906.650   10  328 -31424.101 -25178.085  19.9%  5438 3553s
  1183   654 -28568.155   11  327 -31424.101 -25178.085  19.9%  5441 3589s
  1213   663 infeasible   28      -31424.101 -25178.085  19.9%  5450 3600s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 245
  MIR: 4588
  Flow cover: 6120
  Zero half: 4
  RLT: 164
  Relax-and-lift: 1246

Explored 1237 nodes (7872921 simplex iterations) in 3600.16 seconds (7602.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -31424.1 -31427.4 -31452.1 ... -31790.8

Time limit reached
Best objective -3.142410098780e+04, best bound -2.517808536843e+04, gap 19.8765%
  WARNING: Time limit reached. Using best solution found (gap: 19.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.18s
  Master Objective (UB) = -31424.10, θ = 93423.25
  Upper Bound (UB) = -31424.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93423.25
  [DEBUG]   ✓ Scenario 0: θ = 93423.25 ≤ Q = 93423.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93423.25 ≤ Q = 93423.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93423.25 ≤ Q = 93423.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93423.25 ≤ Q = 93423.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 93423.25 ≤ Q = 93423.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 93423.25 ≤ Q = 93423.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 93423.25 ≤ Q = 93423.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 93423.25 ≤ Q = 93423.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x25440f95
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdabbf06b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.177653e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5470335.9874
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.240576e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124057.63    0  124 5470335.99 -124057.63   102%     -    0s
H    0     0                    -90170.17175 -124057.63  37.6%     -    0s
H    0     0                    -90728.85188 -124057.63  36.7%     -    0s
     0     0 -94230.717    0   72 -90728.852 -94230.717  3.86%     -    0s
H    0     0                    -91833.60853 -94229.589  2.61%     -    0s
     0     0 -93963.755    0   33 -91833.609 -93963.755  2.32%     -    0s
H    0     0                    -93221.76860 -93932.953  0.76%     -    0s
     0     0 -93863.036    0   34 -93221.769 -93863.036  0.69%     -    0s
H    0     0                    -93405.67779 -93863.036  0.49%     -    0s
H    0     0                    -93416.73819 -93863.036  0.48%     -    0s
     0     0 -93863.036    0   34 -93416.738 -93863.036  0.48%     -    0s
H    0     0                    -93436.61712 -93863.036  0.46%     -    0s
H    0     0                    -93453.10206 -93863.036  0.44%     -    0s
     0     2 -93863.036    0   34 -93453.102 -93863.036  0.44%     -    0s
H   45    52                    -93464.37399 -93716.916  0.27%   6.4    0s
*  233     0              14    -93468.71706 -93530.453  0.07%   4.6    0s

Cutting planes:
  Gomory: 11
  Implied bound: 1
  MIR: 143

Explored 262 nodes (1789 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -93468.7 -93464.4 -93453.1 ... 1.17765e+13
No other solutions better than -93468.7

Optimal solution found (tolerance 1.00e-06)
Best objective -9.346871705743e+04, best bound -9.346871705743e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 93368.68
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93468.72
  [DEBUG]   S×d_nominal = 186837.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186837.40 + -93468.72 = 93368.68
  [DEBUG]   Current θ from Master = 93423.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 54.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -31478.67
  Lower Bound (LB) = -31478.67
  Gap (UB-LB) = 54.5678, Absolute Gap = 54.5678, Relative Gap = 0.001736
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 24
Total Time: 63575.13s
Converged: True
Final Lower Bound: -31478.6688
Final Upper Bound: -31424.1010
Final Gap: 54.567777
Number of Critical Scenarios: 24
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 1, 5] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 25 customers  Mode 1: 12 customers  Mode 2: 13 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 24
Start Time: 2026-01-03 12:17:00
End Time: 2026-01-04 05:56:36
Total Time: 63575.13s
Optimal Value: -31478.67
Lower Bound: -31478.67
Upper Bound: -31424.10
Gap: 54.567777
Plants Opened: {0: [1], 1: [0], 2: [2]} (3 plants)
DCs Opened: [0, 1, 5] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed26_LD_gamma20_20260104_055636.csv

Total Execution Time: 63575.73 seconds
End Time: 2026-01-04 05:56:36

All tasks completed successfully!

