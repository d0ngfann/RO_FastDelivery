
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 13
DI Scenario: LD
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed13.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.004', '1.007'] (k=0.009)
  Product 1: ['1.000', '1.039', '1.080'] (k=0.094)
  Product 2: ['1.000', '1.030', '1.061'] (k=0.073)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=916, max=1753
  DC capacity (MC): min=475, max=856

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.12, max=34.71, count=80
  Deviation (μ̂): min=4.05, max=9.96

Costs:
  Plant fixed cost: min=6124, max=9786
  DC fixed cost: min=3012, max=5993
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.413', '1.996'] (k=0.852)
    Product 1: ['1.000', '1.320', '1.743'] (k=0.685)
    Product 2: ['1.000', '1.358', '1.844'] (k=0.755)
  MD:
    Product 0: ['1.000', '1.286', '1.653'] (k=0.620)
    Product 1: ['1.000', '1.212', '1.468'] (k=0.473)
    Product 2: ['1.000', '1.148', '1.318'] (k=0.341)
  LD:
    Product 0: ['1.000', '1.004', '1.007'] (k=0.009)
    Product 1: ['1.000', '1.039', '1.080'] (k=0.094)
    Product 2: ['1.000', '1.030', '1.061'] (k=0.073)
  Mixed:
    Product 0: ['1.000', '1.413', '1.996'] (k=0.852)
    Product 1: ['1.000', '1.212', '1.468'] (k=0.473)
    Product 2: ['1.000', '1.030', '1.061'] (k=0.073)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x4d985381
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.12s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -343234.4676
Found heuristic solution: objective -180743.6115

Root relaxation: objective 4.955710e+04, 4370 iterations, 0.19 seconds (0.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49557.1045    0  605 -180743.61 49557.1045   127%     -    0s
H    0     0                    -157836.7873 49557.1045   131%     -    0s
     0     0 47359.0699    0  988 -157836.79 47359.0699   130%     -    1s
H    0     0                    -119989.5467 47354.7407   139%     -    1s
H    0     0                    -119366.1647 47354.7407   140%     -    1s
     0     0 47236.2033    0  966 -119366.16 47236.2033   140%     -    1s
     0     0 47230.0981    0  973 -119366.16 47230.0981   140%     -    1s
     0     0 47229.6757    0  973 -119366.16 47229.6757   140%     -    1s
     0     0 44399.1890    0 1178 -119366.16 44399.1890   137%     -    3s
     0     0 43937.3159    0 1192 -119366.16 43937.3159   137%     -    3s
     0     0 43937.3159    0 1190 -119366.16 43937.3159   137%     -    3s
     0     0 43937.3159    0 1195 -119366.16 43937.3159   137%     -    3s
H    0     0                    -110166.9492 42884.2318   139%     -    5s
H    0     0                    -107915.1198 42884.2318   140%     -    5s
H    0     0                    -86096.33567 41824.3972   149%     -    5s
H    0     0                    -73347.64015 41824.3972   157%     -    5s
H    0     0                    -44410.57161 41824.3972   194%     -    5s
H    0     0                    -13006.84278 41824.3972   422%     -    5s
     0     0 41824.3972    0 1179 -13006.843 41824.3972   422%     -    5s
     0     0 41824.3972    0 1179 -13006.843 41824.3972   422%     -    6s
     0     2 41824.3972    0 1179 -13006.843 41824.3972   422%     -    7s
     7    16 38895.3491    3  855 -13006.843 41471.0991   419%  2441   10s
H   95   247                    -11971.05498 37583.6283   414%  1285   13s
H  127   247                    -9354.911499 37583.6283   502%  1046   13s
H  137   247                    -8691.365336 37583.6283   532%   987   13s
   378   411 29944.4396   12  580 -8691.3653 37583.6283   532%   503   15s
H  392   411                    -7644.324304 37583.6283   592%   502   15s
H  690   764                    -7640.011830 37583.6283   592%   407   17s
H  696   764                    -7386.000517 37583.6283   609%   406   17s
H  701   764                    -5653.910893 37583.6283   765%   406   17s
H  708   764                    -568.3139782 37583.6283  6713%   405   17s
H  713   764                    1785.2233512 37583.6283  2005%   407   17s
H  851   895                    2600.0350895 37583.6283  1346%   392   18s
H  860   895                    3055.1110369 37583.6283  1130%   394   18s
H 1010  1021                    3415.5265412 37010.5187   984%   387   19s
H 1014  1021                    3457.1066807 37010.5187   971%   386   19s
  1080  1090 18499.3948   31  353 3457.10668 37010.5187   971%   384   20s
H 1161  1175                    3505.5846832 37010.5187   956%   386   20s
H 1193  1175                    3507.6488574 37010.5187   955%   378   20s
H 1204  1175                    3927.7209830 37010.5187   842%   378   20s
H 1387  1344                    3988.4395934 36867.8546   824%   364   21s
H 1390  1344                    4003.6192442 36867.8546   821%   364   21s
H 1391  1344                    4046.4006643 36867.8546   811%   365   21s
H 1392  1344                    4056.0744268 36867.8546   809%   364   21s
H 1399  1344                    4461.7619628 36867.8546   726%   364   21s
H 1401  1344                    4916.6238109 36867.8546   650%   364   21s
H 1548  1496                    4921.7827093 36867.8546   649%   363   22s
H 1553  1496                    5001.6306916 36867.8546   637%   363   22s
  2624  2316 26218.0155   17  510 5001.63069 36692.0943   634%   292   25s
H 2626  2311                    5238.9374683 36692.0943   600%   292   25s
H 2647  2311                    5275.5894545 36692.0943   596%   291   25s
H 3499  2895                    5405.7115628 35859.2547   563%   271   31s
  3500  2896 5738.31127   70 1179 5405.71156 35859.2547   563%   271   37s
H 3501  2752                    9606.7132531 29798.7268   210%   271   37s
  3508  2756 19243.9977   25  416 9606.71325 22325.6103   132%   271   40s
  3526  2768 20508.4641   13  561 9606.71325 20508.4641   113%   269   45s
  3559  2814 18350.0049   16  384 9606.71325 19954.0697   108%   277   50s
H 3564  2674                    9608.0246429 19954.0697   108%   278   50s
H 3777  2552                    10332.510490 17859.0502  72.8%   281   52s
H 4080  2347                    10334.619237 16833.6126  62.9%   273   53s
H 4081  2227                    10335.859519 16833.6126  62.9%   273   53s
H 4089  2112                    10338.413542 16833.6126  62.8%   273   53s
H 4091  2003                    10349.303161 16833.6126  62.7%   273   53s
H 4260  1831                    10351.040042 15524.1294  50.0%   268   54s
H 4276  1709                    10351.133434 15524.1294  50.0%   268   54s
  4451  1652 10486.8403   36    4 10351.1334 15338.9200  48.2%   262   55s
* 4599  1513              38    10414.981497 15338.9200  47.3%   257   55s
H 4734  1354                    10480.598724 14283.4375  36.3%   251   55s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 42
  MIR: 209
  Flow cover: 387
  Zero half: 1
  RLT: 14
  Relax-and-lift: 83

Explored 5143 nodes (1232045 simplex iterations) in 57.57 seconds (74.60 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 10480.6 10415 10351.1 ... 9608.02

Optimal solution found (tolerance 1.00e-06)
Best objective 1.048059872446e+04, best bound 1.048059872446e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 57.58s
  Master Objective (UB) = 10480.60, θ = 134496.10
  Upper Bound (UB) = 10480.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 134496.10
  [DEBUG]   ✓ Scenario 0: θ = 134496.10 ≤ Q = 134496.10 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4be8c7b9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb4173847
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.158540e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 5850956.2674
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.072956e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -107295.62    0  121 5850956.27 -107295.62   102%     -    0s
H    0     0                    -73434.81681 -107295.62  46.1%     -    0s
H    0     0                    -74284.92534 -107295.62  44.4%     -    0s
*    0     0               0    -76776.44725 -76776.447  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 201

Explored 1 nodes (372 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -76776.4 -74284.9 -73434.8 ... 1.15854e+13
No other solutions better than -76776.4

Optimal solution found (tolerance 1.00e-06)
Best objective -7.677644725001e+04, best bound -7.677644725001e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 97881.37
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -76776.45
  [DEBUG]   S×d_nominal = 174657.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 174657.81 + -76776.45 = 97881.37
  [DEBUG]   Current θ from Master = 134496.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 36614.73 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26134.13
  Lower Bound (LB) = -26134.13
  Gap (UB-LB) = 36614.7315, Absolute Gap = 36614.7315, Relative Gap = 3.493572
  Not converged yet (gap = 36614.73 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x281d51e6
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -26134.1 (0.02s)
MIP start from previous solve produced solution with objective -26134.1 (0.02s)
Loaded MIP start from previous solve with objective -26134.1

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.47s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.164119e+03, 9449 iterations, 1.93 seconds (2.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 4164.11912    0  473 -26134.133 4164.11912   116%     -    2s
H    0     0                    -25434.60318 4164.11912   116%     -    2s
     0     0 -789.89868    0  575 -25434.603 -789.89868  96.9%     -    5s
H    0     0                    -25267.50613 -792.84857  96.9%     -    5s
     0     0 -1049.0057    0  659 -25267.506 -1049.0057  95.8%     -    5s
     0     0 -1056.8477    0  656 -25267.506 -1056.8477  95.8%     -    5s
     0     0 -1056.8734    0  656 -25267.506 -1056.8734  95.8%     -    5s
     0     0 -4438.7126    0  912 -25267.506 -4438.7126  82.4%     -    9s
H    0     0                    -25244.70446 -4439.4068  82.4%     -    9s
H    0     0                    -25244.13709 -4439.4068  82.4%     -    9s
     0     0 -4782.2291    0  933 -25244.137 -4782.2291  81.1%     -   10s
     0     0 -4782.2291    0  920 -25244.137 -4782.2291  81.1%     -   10s
     0     0 -4782.2291    0  925 -25244.137 -4782.2291  81.1%     -   10s
     0     0 -4782.2291    0  925 -25244.137 -4782.2291  81.1%     -   10s
H    0     0                    -25068.79323 -6447.6798  74.3%     -   14s
     0     0 -6447.6798    0  638 -25068.793 -6447.6798  74.3%     -   14s
H    0     0                    -25051.04616 -6447.7199  74.3%     -   14s
H    0     0                    -24969.26970 -6447.7199  74.2%     -   14s
H    0     0                    -24917.35066 -6907.6233  72.3%     -   16s
H    0     0                    -24904.62868 -6907.6233  72.3%     -   16s
H    0     0                    -15356.92028 -6907.6233  55.0%     -   16s
H    0     0                    -15319.50185 -6907.6233  54.9%     -   16s
     0     0 -6907.6233    0  725 -15319.502 -6907.6233  54.9%     -   16s
     0     0 -7023.1469    0  732 -15319.502 -7023.1469  54.2%     -   16s
     0     0 -7086.7705    0  727 -15319.502 -7086.7705  53.7%     -   17s
H    0     0                    -15269.98050 -7109.8005  53.4%     -   17s
     0     0 -7109.8005    0  747 -15269.980 -7109.8005  53.4%     -   17s
     0     0 -7114.7642    0  843 -15269.980 -7114.7642  53.4%     -   17s
     0     0 -7117.9944    0  837 -15269.980 -7117.9944  53.4%     -   17s
H    0     0                    -15219.26684 -7118.4218  53.2%     -   18s
     0     0 -7118.4218    0  835 -15219.267 -7118.4218  53.2%     -   18s
H    0     0                    -15166.42181 -7118.4218  53.1%     -   20s
     0     0 -8336.1838    0  723 -15166.422 -8336.1838  45.0%     -   23s
H    0     0                    -14732.08040 -8336.2264  43.4%     -   23s
H    0     0                    -14725.49287 -8336.2264  43.4%     -   23s
H    0     0                    -14606.21834 -8521.4097  41.7%     -   24s
     0     0 -8521.4097    0  746 -14606.218 -8521.4097  41.7%     -   24s
     0     0 -8568.4682    0  757 -14606.218 -8568.4682  41.3%     -   25s
     0     0 -8574.0217    0  754 -14606.218 -8574.0217  41.3%     -   25s
     0     0 -8575.8797    0  760 -14606.218 -8575.8797  41.3%     -   25s
     0     0 -8860.3136    0  820 -14606.218 -8860.3136  39.3%     -   28s
H    0     0                    -14531.93913 -8860.7334  39.0%     -   28s
H    0     0                    -14530.02400 -8860.7334  39.0%     -   28s
     0     0 -8991.6459    0  896 -14530.024 -8991.6459  38.1%     -   29s
     0     0 -9018.0569    0  829 -14530.024 -9018.0569  37.9%     -   30s
     0     0 -9028.0017    0  899 -14530.024 -9028.0017  37.9%     -   30s
     0     0 -9030.8155    0  829 -14530.024 -9030.8155  37.8%     -   31s
     0     0 -9173.6943    0  726 -14530.024 -9173.6943  36.9%     -   33s
H    0     0                    -14434.81347 -9173.7497  36.4%     -   34s
H    0     0                    -14432.31669 -9173.7497  36.4%     -   34s
     0     0 -9214.7716    0  717 -14432.317 -9214.7716  36.2%     -   35s
     0     0 -9225.4099    0  812 -14432.317 -9225.4099  36.1%     -   35s
     0     0 -9227.6868    0  812 -14432.317 -9227.6868  36.1%     -   36s
H    0     0                    -14409.55402 -9321.0830  35.3%     -   38s
     0     0 -9321.0830    0  622 -14409.554 -9321.0830  35.3%     -   38s
     0     0 -9352.8839    0  714 -14409.554 -9352.8839  35.1%     -   39s
     0     0 -9367.1403    0  729 -14409.554 -9367.1403  35.0%     -   40s
     0     0 -9370.4758    0  726 -14409.554 -9370.4758  35.0%     -   40s
     0     0 -9425.2076    0  789 -14409.554 -9425.2076  34.6%     -   42s
     0     0 -9438.6609    0  645 -14409.554 -9438.6609  34.5%     -   43s
     0     0 -9449.0723    0  640 -14409.554 -9449.0723  34.4%     -   43s
     0     0 -9455.1787    0  734 -14409.554 -9455.1787  34.4%     -   44s
     0     0 -9457.7420    0  651 -14409.554 -9457.7420  34.4%     -   44s
     0     0 -9501.3828    0  683 -14409.554 -9501.3828  34.1%     -   46s
     0     0 -9514.9687    0  715 -14409.554 -9514.9687  34.0%     -   47s
     0     0 -9520.2254    0  703 -14409.554 -9520.2254  33.9%     -   47s
     0     0 -9565.7215    0  725 -14409.554 -9565.7215  33.6%     -   49s
     0     0 -9570.9800    0  622 -14409.554 -9570.9800  33.6%     -   50s
     0     0 -9583.1986    0  638 -14409.554 -9583.1986  33.5%     -   51s
     0     0 -9592.8697    0  649 -14409.554 -9592.8697  33.4%     -   52s
     0     0 -9596.5899    0  640 -14409.554 -9596.5899  33.4%     -   52s
     0     0 -9602.9054    0  621 -14409.554 -9602.9054  33.4%     -   53s
     0     0 -9603.0197    0  621 -14409.554 -9603.0197  33.4%     -   54s
H    0     0                    -14394.46632 -9603.0197  33.3%     -   58s
     0     2 -9603.0197    0  621 -14394.466 -9603.0197  33.3%     -   63s
     1     4 -9892.2105    1  796 -14394.466 -9603.0197  33.3%  2871   65s
     7    12 -10982.241    3  624 -14394.466 -9916.4072  31.1%  2235   70s
    81    72 -12427.922    7  372 -14394.466 -10362.330  28.0%  1274   75s
   281   241 -12743.797   13  439 -14394.466 -10362.869  28.0%   585   81s
   657   350 -13152.907   13  376 -14394.466 -10362.869  28.0%   458   85s
   833   368 infeasible   17      -14394.466 -10555.483  26.7%   484   90s
  1043   340 -12720.930   12   77 -14394.466 -11185.731  22.3%   493   95s
  1215   329 -13195.875   13  282 -14394.466 -11688.788  18.8%   499  100s
  1499   271     cutoff   16      -14394.466 -12350.381  14.2%   504  107s
  1690   220 -13636.651   11   81 -14394.466 -12467.537  13.4%   518  110s
  1966   153     cutoff   17      -14394.466 -12544.333  12.9%   523  116s
  2264     6 infeasible   22      -14394.466 -13389.884  6.98%   509  120s

Cutting planes:
  Implied bound: 3
  MIR: 1768
  Flow cover: 1131
  Zero half: 1
  RLT: 155
  Relax-and-lift: 507

Explored 2310 nodes (1216599 simplex iterations) in 120.76 seconds (179.70 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14394.5 -14409.6 -14432.3 ... -15166.4
No other solutions better than -14394.5

Optimal solution found (tolerance 1.00e-06)
Best objective -1.439446632380e+04, best bound -1.439446632380e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 120.77s
  Master Objective (UB) = -14394.47, θ = 97870.68
  Upper Bound (UB) = -14394.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 97870.68
  [DEBUG]   ✓ Scenario 0: θ = 97870.68 ≤ Q = 97870.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 97870.68 ≤ Q = 97870.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3035b7b3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3035b7b3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.392190e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.01s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 7498201.9640
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.104261e+05, 298 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110426.15    0  130 7498201.96 -110426.15   101%     -    0s
H    0     0                    -70784.75027 -110426.15  56.0%     -    0s
H    0     0                    -72087.37784 -110426.15  53.2%     -    0s
H    0     0                    -82510.79003 -110426.15  33.8%     -    0s
H    0     0                    -90563.05122 -110426.15  21.9%     -    0s
H    0     0                    -91024.67507 -96045.474  5.52%     -    0s
     0     0 -96045.474    0   54 -91024.675 -96045.474  5.52%     -    0s
H    0     0                    -94421.79994 -95986.858  1.66%     -    0s
     0     0 -95966.758    0   55 -94421.800 -95966.758  1.64%     -    0s
     0     0 -95964.524    0   55 -94421.800 -95964.524  1.63%     -    0s
     0     0 -95548.798    0   27 -94421.800 -95548.798  1.19%     -    0s
H    0     0                    -94875.36257 -95544.084  0.70%     -    0s
     0     0 -95250.735    0   29 -94875.363 -95250.735  0.40%     -    0s
     0     0 -95244.402    0   29 -94875.363 -95244.402  0.39%     -    0s
     0     0 -95080.345    0   11 -94875.363 -95080.345  0.22%     -    0s
     0     0 -95010.973    0   20 -94875.363 -95010.973  0.14%     -    0s
     0     0 -94978.023    0   19 -94875.363 -94978.023  0.11%     -    0s
     0     0 -94945.926    0   17 -94875.363 -94945.926  0.07%     -    0s
     0     0 -94913.115    0    5 -94875.363 -94913.115  0.04%     -    0s
     0     0 -94910.648    0    5 -94875.363 -94910.648  0.04%     -    0s
     0     0 -94892.796    0    5 -94875.363 -94892.796  0.02%     -    0s
     0     0 -94882.254    0    2 -94875.363 -94882.254  0.01%     -    0s
     0     0     cutoff    0      -94875.363 -94875.363  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 2

Explored 1 nodes (661 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -94875.4 -94812.5 -94421.8 ... 1.39219e+13
No other solutions better than -94875.4

Optimal solution found (tolerance 1.00e-06)
Best objective -9.487536257283e+04, best bound -9.487536257283e+04, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 80601.73
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -94875.36
  [DEBUG]   S×d_nominal = 175477.09
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175477.09 + -94875.36 = 80601.73
  [DEBUG]   Current θ from Master = 97870.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17268.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -31663.41
  Lower Bound (LB) = -26134.13
  Gap (UB-LB) = 11739.6664, Absolute Gap = 11739.6664, Relative Gap = 0.815568
  Not converged yet (gap = 11739.67 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0x32f8a689
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -31663.4 (0.04s)
MIP start from previous solve produced solution with objective -31663.4 (0.04s)
Loaded MIP start from previous solve with objective -31663.4

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.68s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31383   -3.4417459e+03   0.000000e+00   1.470862e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20218   -2.5241309e+03   0.000000e+00   0.000000e+00      9s

Root relaxation: objective -2.524131e+03, 20218 iterations, 8.35 seconds (11.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -2524.1309    0  377 -31663.412 -2524.1309  92.0%     -    9s
H    0     0                    -30751.18095 -2524.1309  91.8%     -    9s
H    0     0                    -29846.65886 -2524.1309  91.5%     -    9s
H    0     0                    -24813.63732 -2524.1309  89.8%     -   10s
H    0     0                    -24808.06129 -2524.1309  89.8%     -   10s
H    0     0                    -16487.95662 -2524.1309  84.7%     -   11s
H    0     0                    -16463.21051 -2524.3116  84.7%     -   11s
H    0     0                    -16440.84675 -2524.3116  84.6%     -   11s
     0     0 -4378.7980    0  405 -16440.847 -4378.7980  73.4%     -   13s
H    0     0                    -15061.70344 -4379.2205  70.9%     -   13s
H    0     0                    -14745.24498 -4379.2205  70.3%     -   13s
H    0     0                    -14715.41474 -4379.2205  70.2%     -   13s
     0     0 -4980.8195    0  451 -14715.415 -4980.8195  66.2%     -   15s
     0     0 -5340.1037    0  455 -14715.415 -5340.1037  63.7%     -   15s
     0     0 -5352.7204    0  453 -14715.415 -5352.7204  63.6%     -   15s
     0     0 -5355.8295    0  453 -14715.415 -5355.8295  63.6%     -   16s
     0     0 -7197.8400    0  478 -14715.415 -7197.8400  51.1%     -   19s
H    0     0                    -14707.90024 -7198.3355  51.1%     -   19s
     0     0 -7301.2350    0  492 -14707.900 -7301.2350  50.4%     -   20s
     0     0 -7411.8285    0  502 -14707.900 -7411.8285  49.6%     -   21s
     0     0 -7416.3766    0  418 -14707.900 -7416.3766  49.6%     -   21s
     0     0 -7417.3695    0  418 -14707.900 -7417.3695  49.6%     -   21s
     0     0 -7417.3695    0  418 -14707.900 -7417.3695  49.6%     -   21s
H    0     0                    -14692.68074 -8389.6567  42.9%     -   28s
H    0     0                    -14681.06785 -8389.6567  42.9%     -   28s
H    0     0                    -14680.39470 -8389.6567  42.9%     -   28s
H    0     0                    -14679.15272 -8389.6567  42.8%     -   28s
H    0     0                    -14677.08210 -8389.6567  42.8%     -   28s
H    0     0                    -14674.41459 -8389.6567  42.8%     -   28s
H    0     0                    -14666.01710 -8389.6567  42.8%     -   28s
H    0     0                    -14664.94040 -8389.6567  42.8%     -   28s
     0     0 -8389.6567    0  554 -14664.940 -8389.6567  42.8%     -   28s
     0     0 -8758.8587    0  630 -14664.940 -8758.8587  40.3%     -   30s
     0     0 -8824.6517    0  582 -14664.940 -8824.6517  39.8%     -   31s
     0     0 -8843.9622    0  589 -14664.940 -8843.9622  39.7%     -   31s
     0     0 -8845.4032    0  594 -14664.940 -8845.4032  39.7%     -   32s
     0     0 -8855.9114    0  596 -14664.940 -8855.9114  39.6%     -   32s
     0     0 -8855.9482    0  596 -14664.940 -8855.9482  39.6%     -   32s
     0     0 -9271.1805    0  624 -14664.940 -9271.1805  36.8%     -   38s
     0     0 -9437.3706    0  637 -14664.940 -9437.3706  35.6%     -   40s
     0     0 -9484.2750    0  615 -14664.940 -9484.2750  35.3%     -   41s
     0     0 -9503.6748    0  634 -14664.940 -9503.6748  35.2%     -   42s
     0     0 -9506.9743    0  634 -14664.940 -9506.9743  35.2%     -   42s
     0     0 -9508.0641    0  644 -14664.940 -9508.0641  35.2%     -   42s
     0     0 -9508.5412    0  644 -14664.940 -9508.5412  35.2%     -   43s
     0     0 -9625.0853    0  597 -14664.940 -9625.0853  34.4%     -   45s
     0     0 -9683.5686    0  587 -14664.940 -9683.5686  34.0%     -   46s
     0     0 -9691.8555    0  605 -14664.940 -9691.8555  33.9%     -   46s
     0     0 -9693.6937    0  613 -14664.940 -9693.6937  33.9%     -   47s
     0     0 -9695.6826    0  606 -14664.940 -9695.6826  33.9%     -   47s
     0     0 -9695.8969    0  608 -14664.940 -9695.8969  33.9%     -   47s
     0     0 -9761.1848    0  669 -14664.940 -9761.1848  33.4%     -   49s
     0     0 -9803.4042    0  598 -14664.940 -9803.4042  33.2%     -   50s
     0     0 -9811.7180    0  604 -14664.940 -9811.7180  33.1%     -   50s
     0     0 -9812.8608    0  615 -14664.940 -9812.8608  33.1%     -   51s
     0     0 -9813.0888    0  614 -14664.940 -9813.0888  33.1%     -   51s
     0     0 -9927.4230    0  596 -14664.940 -9927.4230  32.3%     -   53s
     0     0 -9950.3549    0  596 -14664.940 -9950.3549  32.1%     -   53s
     0     0 -9958.8883    0  612 -14664.940 -9958.8883  32.1%     -   54s
     0     0 -9960.4359    0  608 -14664.940 -9960.4359  32.1%     -   54s
     0     0 -9960.5874    0  609 -14664.940 -9960.5874  32.1%     -   54s
     0     0 -10018.143    0  609 -14664.940 -10018.143  31.7%     -   56s
     0     0 -10033.007    0  623 -14664.940 -10033.007  31.6%     -   56s
     0     0 -10033.007    0  623 -14664.940 -10033.007  31.6%     -   57s
     0     0 -10039.191    0  621 -14664.940 -10039.191  31.5%     -   57s
     0     0 -10040.710    0  629 -14664.940 -10040.710  31.5%     -   57s
     0     0 -10040.984    0  630 -14664.940 -10040.984  31.5%     -   57s
     0     0 -10057.642    0  636 -14664.940 -10057.642  31.4%     -   59s
     0     0 -10067.176    0  629 -14664.940 -10067.176  31.4%     -   59s
     0     0 -10068.945    0  636 -14664.940 -10068.945  31.3%     -   60s
     0     0 -10068.945    0  636 -14664.940 -10068.945  31.3%     -   60s
     0     0 -10069.482    0  630 -14664.940 -10069.482  31.3%     -   60s
     0     0 -10076.819    0  623 -14664.940 -10076.819  31.3%     -   61s
     0     0 -10080.096    0  627 -14664.940 -10080.096  31.3%     -   62s
     0     0 -10082.214    0  641 -14664.940 -10082.214  31.2%     -   62s
     0     0 -10082.581    0  636 -14664.940 -10082.581  31.2%     -   62s
     0     0 -10087.436    0  637 -14664.940 -10087.436  31.2%     -   64s
H    0     0                    -14660.97626 -10090.781  31.2%     -   64s
     0     0 -10090.781    0  642 -14660.976 -10090.781  31.2%     -   64s
     0     0 -10091.653    0  640 -14660.976 -10091.653  31.2%     -   65s
     0     0 -10101.442    0  676 -14660.976 -10101.442  31.1%     -   66s
     0     0 -10105.549    0  615 -14660.976 -10105.549  31.1%     -   67s
     0     0 -10107.831    0  679 -14660.976 -10107.831  31.1%     -   67s
     0     0 -10108.325    0  682 -14660.976 -10108.325  31.1%     -   68s
     0     0 -10114.345    0  642 -14660.976 -10114.345  31.0%     -   69s
     0     0 -10117.620    0  642 -14660.976 -10117.620  31.0%     -   69s
     0     0 -10118.991    0  644 -14660.976 -10118.991  31.0%     -   70s
     0     0 -10119.102    0  644 -14660.976 -10119.102  31.0%     -   70s
     0     0 -10121.712    0  647 -14660.976 -10121.712  31.0%     -   71s
     0     0 -10125.367    0  636 -14660.976 -10125.367  30.9%     -   72s
     0     0 -10128.383    0  640 -14660.976 -10128.383  30.9%     -   72s
     0     0 -10129.736    0  632 -14660.976 -10129.736  30.9%     -   72s
     0     0 -10130.179    0  638 -14660.976 -10130.179  30.9%     -   72s
     0     0 -10134.977    0  639 -14660.976 -10134.977  30.9%     -   74s
     0     0 -10136.012    0  642 -14660.976 -10136.012  30.9%     -   74s
     0     0 -10191.840    0  680 -14660.976 -10191.840  30.5%     -   75s
     0     0 -10198.636    0  681 -14660.976 -10198.636  30.4%     -   76s
     0     0 -10199.344    0  688 -14660.976 -10199.344  30.4%     -   76s
     0     0 -10201.468    0  690 -14660.976 -10201.468  30.4%     -   77s
     0     0 -10202.329    0  695 -14660.976 -10202.329  30.4%     -   78s
     0     0 -10214.670    0  697 -14660.976 -10214.670  30.3%     -   79s
     0     0 -10215.348    0  695 -14660.976 -10215.348  30.3%     -   79s
     0     0 -10216.779    0  710 -14660.976 -10216.779  30.3%     -   81s
     0     0 -10217.146    0  713 -14660.976 -10217.146  30.3%     -   81s
     0     0 -10217.886    0  704 -14660.976 -10217.886  30.3%     -   82s
     0     0 -10218.110    0  704 -14660.976 -10218.110  30.3%     -   84s
H    0     0                    -14658.56562 -10218.385  30.3%     -   96s
H    0     0                    -14656.65048 -10218.385  30.3%     -   96s
     0     2 -10218.385    0  704 -14656.650 -10218.385  30.3%     -   96s
     3     8 -10595.120    2  688 -14656.650 -10277.979  29.9%  1044  101s
     7    16 -10779.814    3  685 -14656.650 -10364.224  29.3%  1507  105s
    31    50 -11027.276    5  671 -14656.650 -10892.998  25.7%  1774  111s
H   46    50                    -14654.06869 -11027.335  24.7%  1529  111s
    59    77 -11038.073    6  664 -14654.069 -11027.605  24.7%  1481  117s
    91   155 -11111.560    7  675 -14654.069 -11038.229  24.7%  1554  120s
   260   238 -13238.825    9  690 -14654.069 -11111.585  24.2%   886  128s
H  267   238                    -14653.92646 -11111.585  24.2%   880  128s
   324   269 -11601.949   10  694 -14653.926 -11111.585  24.2%   783  131s
   442   322 -11698.374   11  706 -14653.926 -11111.585  24.2%   729  138s
   495   353 -11730.126   12  708 -14653.926 -11111.585  24.2%   726  140s
   542   380 -13938.565   13  607 -14653.926 -11385.107  22.3%   730  145s
   663   425 -12755.750   14  816 -14653.926 -11385.107  22.3%   708  152s
   726   451 -13140.769   14  599 -14653.926 -11385.107  22.3%   708  156s
   836   500 -13458.635   16  726 -14653.926 -11385.107  22.3%   706  162s
   877   530 -13856.401   17  652 -14653.926 -11385.107  22.3%   703  165s
   999   554 -14082.192   19  574 -14653.926 -11664.767  20.4%   685  171s
  1064   578 -14107.474   20  497 -14653.926 -11664.767  20.4%   677  176s
  1220   660 -14481.554   24  531 -14653.926 -11664.767  20.4%   674  183s
  1328   682     cutoff   24      -14653.926 -11720.513  20.0%   658  187s
  1412   692 -14642.828   25  512 -14653.926 -11828.655  19.3%   650  190s
  1470   712     cutoff   25      -14653.926 -11884.646  18.9%   652  196s
  1547   739 -13885.645   12  543 -14653.926 -11982.889  18.2%   649  201s
  1654   781 -14133.012   13  537 -14653.926 -11982.889  18.2%   646  206s
  1753   806 -14238.905   14  600 -14653.926 -12130.267  17.2%   646  212s
  1859   841 -14276.652   15  609 -14653.926 -12188.731  16.8%   646  216s
  1969   876 -14460.750   17  594 -14653.926 -12191.701  16.8%   646  220s
  2216   917 -14126.085   11  256 -14653.926 -12191.701  16.8%   644  229s
  2272   934 -14192.230   12  237 -14653.926 -12191.701  16.8%   644  234s
  2380   958     cutoff   12      -14653.926 -12251.513  16.4%   636  239s
  2485   985 -13141.668   15  413 -14653.926 -12260.752  16.3%   637  244s
  2605  1021 -13845.734   17  399 -14653.926 -12276.079  16.2%   636  249s
  2760  1023 -14525.474   22  325 -14653.926 -12283.960  16.2%   634  254s
  2870  1061 -13497.032   14  516 -14653.926 -12283.960  16.2%   633  258s
  3027  1086 -14067.389   19  406 -14653.926 -12495.045  14.7%   628  265s
  3224  1098     cutoff   27      -14653.926 -12522.083  14.5%   623  271s
  3419  1103 -13427.029   16  440 -14653.926 -12845.574  12.3%   620  277s
  3557  1130 -13734.920   18  567 -14653.926 -12845.574  12.3%   618  283s
  3816  1160 -14335.146   20  641 -14653.926 -12845.574  12.3%   606  288s
  4074  1161 -14139.946   19  318 -14653.926 -12845.574  12.3%   594  293s
  4387  1132 -14499.325   25  353 -14653.926 -13185.330  10.0%   579  299s
  4698  1069 infeasible   19      -14653.926 -13287.034  9.33%   570  306s
  5070  1050     cutoff   21      -14653.926 -13494.277  7.91%   554  312s
  5395   978     cutoff   20      -14653.926 -13562.936  7.45%   547  320s
  5807   930 -14410.759   14  346 -14653.926 -13664.763  6.75%   535  326s
  6177   894     cutoff   22      -14653.926 -13752.174  6.15%   526  334s
  6458   753 -14507.042   22  384 -14653.926 -13841.094  5.55%   521  341s
  6919   597     cutoff   21      -14653.926 -13971.704  4.66%   511  347s
  7378   301 -14615.460   19  419 -14653.926 -14093.510  3.82%   502  353s
  7933    42     cutoff   20      -14653.926 -14196.951  3.12%   489  359s
  8326     0     cutoff   23      -14653.926 -14343.123  2.12%   479  360s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 14
  MIR: 467
  Flow cover: 918
  RLT: 22
  Relax-and-lift: 21

Explored 8399 nodes (4053742 simplex iterations) in 360.57 seconds (685.57 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -14653.9 -14654.1 -14656.7 ... -14679.2
No other solutions better than -14653.9

Optimal solution found (tolerance 1.00e-06)
Best objective -1.465392646261e+04, best bound -1.465392646261e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 360.61s
  Master Objective (UB) = -14653.93, θ = 97874.68
  Upper Bound (UB) = -14653.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 97874.68
  [DEBUG]   ✓ Scenario 0: θ = 97874.68 ≤ Q = 97874.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 97874.68 ≤ Q = 97874.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 97874.68 ≤ Q = 97874.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4ef39fae
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4ef39fae
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.402028e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.01s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 7580098.2341
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.085142e+05, 295 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108514.21    0  121 7580098.23 -108514.21   101%     -    0s
H    0     0                    -74523.62129 -108514.21  45.6%     -    0s
H    0     0                    -75364.98465 -108514.21  44.0%     -    0s
     0     0 -91162.829    0  124 -75364.985 -91162.829  21.0%     -    0s
H    0     0                    -87512.87692 -91154.443  4.16%     -    0s
H    0     0                    -88623.97562 -91154.443  2.86%     -    0s
     0     0 -90856.010    0  124 -88623.976 -90856.010  2.52%     -    0s
     0     0 -90616.637    0  128 -88623.976 -90616.637  2.25%     -    0s
     0     0 -90321.115    0  130 -88623.976 -90321.115  1.91%     -    0s
     0     0 -90269.644    0  130 -88623.976 -90269.644  1.86%     -    0s
     0     0 -89841.907    0  123 -88623.976 -89841.907  1.37%     -    0s
     0     0 -89801.048    0  131 -88623.976 -89801.048  1.33%     -    0s
     0     0 -89724.500    0  117 -88623.976 -89724.500  1.24%     -    0s
     0     0 -89706.056    0  117 -88623.976 -89706.056  1.22%     -    0s
     0     2 -89694.824    0  117 -88623.976 -89694.824  1.21%     -    0s
H   35    12                    -88638.62036 -89290.395  0.74%  20.3    0s

Cutting planes:
  Gomory: 27
  Implied bound: 4
  MIR: 312
  Flow cover: 1
  RLT: 57
  Relax-and-lift: 7
  BQP: 3

Explored 1097 nodes (7597 simplex iterations) in 0.27 seconds (0.13 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -88638.6 -88624 -75365 ... 1.40203e+13
No other solutions better than -88638.6

Optimal solution found (tolerance 1.00e-06)
Best objective -8.863862035837e+04, best bound -8.863862035837e+04, gap 0.0000%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 86987.89
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88638.62
  [DEBUG]   S×d_nominal = 175626.51
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 175626.51 + -88638.62 = 86987.89
  [DEBUG]   Current θ from Master = 97874.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10886.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25540.72
  Lower Bound (LB) = -25540.72
  Gap (UB-LB) = 10886.7936, Absolute Gap = 10886.7936, Relative Gap = 0.742927
  Not converged yet (gap = 10886.79 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x4f191f63
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -25540.7 (0.19s)
MIP start from previous solve produced solution with objective -25540.7 (0.19s)
Loaded MIP start from previous solve with objective -25540.7

Presolve removed 28280 rows and 11480 columns
Presolve time: 0.87s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36386   -1.8249619e+04   0.000000e+00   3.986615e+06      5s
   44866   -5.8979154e+03   0.000000e+00   4.699635e+05     10s
Concurrent spin time: 2.14s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -4.750153e+03, 30296 iterations, 11.51 seconds (15.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4750.1532    0  393 -25540.720 -4750.1532  81.4%     -   12s
H    0     0                    -23897.81397 -4750.1532  80.1%     -   13s
H    0     0                    -23665.20829 -4750.1532  79.9%     -   13s
H    0     0                    -23638.18213 -4750.1532  79.9%     -   13s
H    0     0                    -23491.14966 -7767.1540  66.9%     -   20s
H    0     0                    -23464.32893 -7767.1540  66.9%     -   20s
     0     0 -7767.1540    0  439 -23464.329 -7767.1540  66.9%     -   20s
     0     0 -8482.9848    0  449 -23464.329 -8482.9848  63.8%     -   23s
     0     0 -8482.9848    0  459 -23464.329 -8482.9848  63.8%     -   24s
     0     0 -8483.0199    0  469 -23464.329 -8483.0199  63.8%     -   25s
H    0     0                    -23391.07567 -9714.3241  58.5%     -   30s
     0     0 -9766.2662    0  470 -23391.076 -9766.2662  58.2%     -   30s
H    0     0                    -22939.48637 -9766.2662  57.4%     -   30s
     0     0 -9850.0950    0  475 -22939.486 -9850.0950  57.1%     -   32s
     0     0 -9876.8326    0  485 -22939.486 -9876.8326  56.9%     -   33s
     0     0 -9883.6411    0  490 -22939.486 -9883.6411  56.9%     -   33s
     0     0 -9887.4128    0  495 -22939.486 -9887.4128  56.9%     -   34s
     0     0 -9891.4498    0  492 -22939.486 -9891.4498  56.9%     -   34s
     0     0 -9917.6731    0  494 -22939.486 -9917.6731  56.8%     -   34s
     0     0 -9943.4029    0  494 -22939.486 -9943.4029  56.7%     -   34s
     0     0 -9948.2167    0  494 -22939.486 -9948.2167  56.6%     -   34s
     0     0 -9948.2306    0  495 -22939.486 -9948.2306  56.6%     -   35s
H    0     0                    -22708.49158 -10932.898  51.9%     -   44s
H    0     0                    -22689.83025 -10932.898  51.8%     -   44s
H    0     0                    -22514.40537 -10932.898  51.4%     -   44s
     0     0 -10932.898    0  522 -22514.405 -10932.898  51.4%     -   44s
H    0     0                    -22372.39735 -10932.960  51.1%     -   44s
     0     0 -11561.775    0  513 -22372.397 -11561.775  48.3%     -   48s
     0     0 -11740.561    0  450 -22372.397 -11740.561  47.5%     -   50s
     0     0 -11845.658    0  448 -22372.397 -11845.658  47.1%     -   52s
     0     0 -12002.277    0  502 -22372.397 -12002.277  46.4%     -   54s
     0     0 -12026.561    0  525 -22372.397 -12026.561  46.2%     -   55s
     0     0 -12047.587    0  512 -22372.397 -12047.587  46.1%     -   56s
     0     0 -12060.683    0  517 -22372.397 -12060.683  46.1%     -   56s
     0     0 -12063.596    0  517 -22372.397 -12063.596  46.1%     -   56s
     0     0 -12063.709    0  516 -22372.397 -12063.709  46.1%     -   57s
H    0     0                    -22330.15759 -12457.330  44.2%     -   64s
H    0     0                    -22296.76852 -12457.330  44.1%     -   64s
     0     0 -12457.330    0  564 -22296.769 -12457.330  44.1%     -   64s
     0     0 -12599.887    0  567 -22296.769 -12599.887  43.5%     -   68s
     0     0 -12661.347    0  557 -22296.769 -12661.347  43.2%     -   69s
     0     0 -12694.037    0  576 -22296.769 -12694.037  43.1%     -   69s
     0     0 -12715.177    0  566 -22296.769 -12715.177  43.0%     -   70s
     0     0 -12719.642    0  577 -22296.769 -12719.642  43.0%     -   70s
     0     0 -12722.311    0  582 -22296.769 -12722.311  42.9%     -   71s
     0     0 -12722.559    0  583 -22296.769 -12722.559  42.9%     -   71s
     0     0 -12800.165    0  592 -22296.769 -12800.165  42.6%     -   74s
     0     0 -12819.955    0  586 -22296.769 -12819.955  42.5%     -   76s
     0     0 -12828.438    0  589 -22296.769 -12828.438  42.5%     -   77s
H    0     0                    -22206.49713 -12830.425  42.2%     -   77s
H    0     0                    -22154.76049 -12830.425  42.1%     -   77s
     0     0 -12830.425    0  587 -22154.760 -12830.425  42.1%     -   77s
     0     0 -12830.860    0  593 -22154.760 -12830.860  42.1%     -   78s
     0     0 -13035.263    0  582 -22154.760 -13035.263  41.2%     -   81s
     0     0 -13067.321    0  608 -22154.760 -13067.321  41.0%     -   82s
     0     0 -13069.620    0  610 -22154.760 -13069.620  41.0%     -   83s
     0     0 -13073.046    0  607 -22154.760 -13073.046  41.0%     -   83s
     0     0 -13074.321    0  610 -22154.760 -13074.321  41.0%     -   83s
     0     0 -13074.819    0  612 -22154.760 -13074.819  41.0%     -   84s
     0     0 -13256.829    0  590 -22154.760 -13256.829  40.2%     -   87s
     0     0 -13270.672    0  667 -22154.760 -13270.672  40.1%     -   89s
     0     0 -13297.818    0  657 -22154.760 -13297.818  40.0%     -   89s
     0     0 -13304.141    0  665 -22154.760 -13304.141  39.9%     -   90s
     0     0 -13305.375    0  664 -22154.760 -13305.375  39.9%     -   90s
     0     0 -13305.738    0  666 -22154.760 -13305.738  39.9%     -   90s
     0     0 -13335.119    0  611 -22154.760 -13335.119  39.8%     -   92s
     0     0 -13339.566    0  610 -22154.760 -13339.566  39.8%     -   93s
     0     0 -13342.322    0  621 -22154.760 -13342.322  39.8%     -   93s
     0     0 -13342.878    0  621 -22154.760 -13342.878  39.8%     -   94s
     0     0 -13374.912    0  631 -22154.760 -13374.912  39.6%     -   96s
     0     0 -13389.323    0  631 -22154.760 -13389.323  39.6%     -   97s
     0     0 -13395.509    0  630 -22154.760 -13395.509  39.5%     -   98s
     0     0 -13396.161    0  623 -22154.760 -13396.161  39.5%     -   98s
H    0     0                    -22140.06960 -13418.035  39.4%     -  100s
H    0     0                    -22055.58796 -13418.035  39.2%     -  100s
     0     0 -13418.035    0  638 -22055.588 -13418.035  39.2%     -  100s
     0     0 -13424.202    0  630 -22055.588 -13424.202  39.1%     -  101s
     0     0 -13425.792    0  640 -22055.588 -13425.792  39.1%     -  101s
     0     0 -13426.179    0  646 -22055.588 -13426.179  39.1%     -  102s
     0     0 -13438.633    0  642 -22055.588 -13438.633  39.1%     -  103s
     0     0 -13444.942    0  638 -22055.588 -13444.942  39.0%     -  104s
     0     0 -13446.186    0  643 -22055.588 -13446.186  39.0%     -  104s
     0     0 -13459.301    0  643 -22055.588 -13459.301  39.0%     -  106s
H    0     0                    -22033.73437 -13459.378  38.9%     -  106s
     0     0 -13476.010    0  630 -22033.734 -13476.010  38.8%     -  107s
     0     0 -13482.814    0  645 -22033.734 -13482.814  38.8%     -  107s
     0     0 -13484.303    0  643 -22033.734 -13484.303  38.8%     -  108s
     0     0 -13484.946    0  642 -22033.734 -13484.946  38.8%     -  108s
     0     0 -13491.845    0  643 -22033.734 -13491.845  38.8%     -  109s
     0     0 -13495.291    0  642 -22033.734 -13495.291  38.8%     -  110s
     0     0 -13496.406    0  651 -22033.734 -13496.406  38.7%     -  110s
     0     0 -13504.866    0  641 -22033.734 -13504.866  38.7%     -  112s
     0     0 -13506.077    0  639 -22033.734 -13506.077  38.7%     -  113s
     0     0 -13509.733    0  650 -22033.734 -13509.733  38.7%     -  115s
     0     0 -13509.885    0  650 -22033.734 -13509.885  38.7%     -  116s
     0     2 -13509.885    0  650 -22033.734 -13509.885  38.7%     -  127s
     1     4 -13678.392    1  637 -22033.734 -13509.885  38.7%  2074  131s
     7    16 -14076.439    3  739 -22033.734 -13711.197  37.8%  2365  138s
    15    32 -14298.499    4  678 -22033.734 -14077.511  36.1%  2654  143s
    31    56 -14530.801    5  725 -22033.734 -14242.343  35.4%  2878  149s
H   34    56                    -21916.41897 -14242.343  35.0%  2761  149s
    63    84 -14572.508    6  680 -21916.419 -14475.189  34.0%  2453  155s
    95   134 -14672.278    7  753 -21916.419 -14490.137  33.9%  2417  161s
   155   202 -14738.281    8  756 -21916.419 -14500.762  33.8%  1994  168s
   231   262 -14777.563    9  750 -21916.419 -14500.762  33.8%  1857  175s
   303   289 -16409.386    9  545 -21916.419 -14500.762  33.8%  1713  182s
   344   318 -14859.672   10  793 -21916.419 -14500.762  33.8%  1648  190s
   428   395 -14920.549   13  767 -21916.419 -14546.322  33.6%  1606  200s
   464   453 -14957.876   14  680 -21916.419 -14546.322  33.6%  1613  207s
   532   526 -14985.806   16  670 -21916.419 -14546.322  33.6%  1553  211s
   619   596 -15058.255   19  589 -21916.419 -14546.322  33.6%  1457  216s
   699   657 -15366.812   21  645 -21916.419 -14546.322  33.6%  1394  221s
   778   713 -15158.853   21  572 -21916.419 -14552.657  33.6%  1362  228s
   852   774 -15438.680   22  632 -21916.419 -14552.657  33.6%  1353  236s
   933   854 -16734.345   22  501 -21916.419 -14552.657  33.6%  1366  243s
  1015   882 -15442.965   23  643 -21916.419 -14552.657  33.6%  1340  247s
  1049   923 -15611.878   24  632 -21916.419 -14552.657  33.6%  1345  251s
  1106   980 -15691.088   25  626 -21916.419 -14578.834  33.5%  1328  255s
H 1121   980                    -21697.04950 -14578.834  32.8%  1328  255s
  1303  1193 -15843.374   27  553 -21697.050 -14578.834  32.8%  1251  264s
  1442  1330 -16162.892   28  547 -21697.050 -14578.834  32.8%  1200  268s
  1613  1464 -17678.994   28  562 -21697.050 -14597.519  32.7%  1138  275s
H 1781  1645                    -21382.57444 -14602.163  31.7%  1100  279s
H 1815  1645                    -21106.97075 -14602.163  30.8%  1096  279s
  1995  1747 -17348.634   30  220 -21106.971 -14602.163  30.8%  1035  288s
H 2150  1864                    -20333.28713 -14607.970  28.2%  1022  295s
H 2150  1864                    -20171.16137 -14607.970  27.6%  1022  295s
  2321  1878 -17611.946   33  303 -20171.161 -14647.089  27.4%   993  301s
H 2547  1911                    -19890.37860 -14647.089  26.4%   962  311s
H 2656  1890                    -19779.37548 -14647.089  25.9%   952  311s
  2769  1983 -17979.511   39  232 -19779.375 -14680.275  25.8%   945  322s
  2976  2095 -18394.617   42  265 -19779.375 -14680.336  25.8%   935  328s
H 3021  2066                    -19621.04613 -14680.336  25.2%   932  328s
  3125  2160 -19321.359   46  181 -19621.046 -14699.206  25.1%   938  339s
H 3265  2170                    -19560.41318 -14738.950  24.6%   953  348s
  3315  2262 -18840.587   53  209 -19560.413 -14738.950  24.6%   959  358s
  3483  2407     cutoff   67      -19560.413 -14824.560  24.2%   958  366s
  3678  2408 -17460.600   32  650 -19560.413 -14877.994  23.9%   953  401s
  3680  2409 -19030.976   59  393 -19560.413 -14877.994  23.9%   953  420s
  3681  2410 -19337.133   81  538 -19560.413 -14877.994  23.9%   952  432s
  3682  2411 -16585.074   21  595 -19560.413 -14877.994  23.9%   952  437s
  3683  2411 -18726.880   73  604 -19560.413 -14877.994  23.9%   952  441s
  3685  2413 -18994.818   40  657 -19560.413 -14877.994  23.9%   951  448s
  3686  2413 -18673.458   44  619 -19560.413 -14877.994  23.9%   951  451s
  3689  2415 -19552.565   16  640 -19560.413 -14877.994  23.9%   950  455s
  3692  2417 -17914.058   45  672 -19560.413 -14877.994  23.9%   950  466s
  3695  2419 -18502.632   72  731 -19560.413 -14877.994  23.9%   949  471s
H 3696  2298                    -19552.64829 -14877.994  23.9%   949  475s
  3698  2299 -17412.510   60  650 -19552.648 -14877.994  23.9%   948  484s
  3699  2300 -18602.266   50  604 -19552.648 -14877.994  23.9%   948  485s
  3702  2302 -16628.448   21  609 -19552.648 -14877.994  23.9%   947  490s
  3703  2303 -19009.142   57  673 -19552.648 -14877.994  23.9%   947  499s
  3704  2303 -19337.659   78  599 -19552.648 -14877.994  23.9%   947  500s
  3706  2305 -16492.169   31  678 -19552.648 -14877.994  23.9%   946  508s
  3707  2305 -16765.773   26  625 -19552.648 -14877.994  23.9%   946  511s
  3708  2306 -17358.387   48  605 -19552.648 -14877.994  23.9%   946  516s
  3710  2307 -18501.471   45  667 -19552.648 -14877.994  23.9%   945  526s
  3711  2308 -16541.336   15  684 -19552.648 -14877.994  23.9%   945  530s
  3712  2309 -16868.751   33  728 -19552.648 -14877.994  23.9%   945  535s
  3714  2310 -18378.896   13  633 -19552.648 -14877.994  23.9%   944  543s
  3715  2311 -16422.920   15  633 -19552.648 -14877.994  23.9%   944  546s
  3716  2311 -17648.754   73  628 -19552.648 -14877.994  23.9%   944  550s
  3717  2312 -15092.602    9  628 -19552.648 -14877.994  23.9%   943  644s
  3718  2313 -18364.290   41  628 -19552.648 -14877.994  23.9%   943  654s
  3719  2316 -14877.994   13  570 -19552.648 -14877.994  23.9%   968  659s
  3721  2320 -14877.994   14  573 -19552.648 -14877.994  23.9%   969  663s
  3725  2324 -14877.994   15  625 -19552.648 -14877.994  23.9%   971  670s
  3733  2336 -14935.651   16  661 -19552.648 -14877.994  23.9%   973  680s
  3747  2355 -15033.633   17  647 -19552.648 -14877.994  23.9%   994  688s
  3775  2374 -15176.633   18  648 -19552.648 -14942.478  23.6%  1014  700s
  3807  2388 -15300.394   19  650 -19552.648 -15096.060  22.8%  1022  712s
  3844  2432 -15621.160   20  647 -19552.648 -15177.325  22.4%  1083  722s
  3924  2455 -16901.740   21  704 -19552.648 -15177.325  22.4%  1098  730s
  4002  2471 -15630.753   21  645 -19552.648 -15177.325  22.4%  1101  738s
  4071  2494 -17208.392   22  616 -19552.648 -15490.007  20.8%  1106  744s
  4146  2528 -15871.062   23  663 -19552.648 -15490.007  20.8%  1102  750s
  4240  2539 -17363.594   23  643 -19552.648 -15585.240  20.3%  1098  760s
  4313  2535 -16097.436   24  619 -19552.648 -15607.451  20.2%  1092  766s
  4365  2540 -16856.786   24  680 -19552.648 -15607.451  20.2%  1090  771s
  4441  2539 -16226.029   25  608 -19552.648 -15638.625  20.0%  1086  777s
  4503  2564 -17307.154   25  465 -19552.648 -15690.982  19.8%  1082  783s
  4586  2568 -18307.904   26  538 -19552.648 -15690.982  19.8%  1078  791s
  4670  2550 -18177.789   26  426 -19552.648 -15737.802  19.5%  1078  797s
  4766  2536 -18228.209   27  423 -19552.648 -15764.771  19.4%  1073  802s
  4821  2535 -18453.213   27  404 -19552.648 -15764.771  19.4%  1071  808s
  4905  2523     cutoff   28      -19552.648 -15764.771  19.4%  1068  816s
  4996  2525     cutoff   27      -19552.648 -15978.752  18.3%  1064  824s
  5089  2544 -18155.742   23  602 -19552.648 -15978.752  18.3%  1065  830s
  5203  2554 -18335.102   24  663 -19552.648 -15978.752  18.3%  1057  838s
  5340  2556 -18342.348   26  672 -19552.648 -15978.752  18.3%  1046  847s
  5498  2542 -18683.435   29  604 -19552.648 -15978.752  18.3%  1034  858s
  5650  2507 -19387.841   32  608 -19552.648 -16223.406  17.0%  1024  864s
  5693  2514 -19396.672   33  605 -19552.648 -16262.566  16.8%  1026  870s
  5778  2531     cutoff   36      -19552.648 -16262.566  16.8%  1020  876s
  5915  2531     cutoff   51      -19552.648 -16358.388  16.3%  1012  886s
  6062  2531 -17893.371   24  524 -19552.648 -16379.878  16.2%  1006  896s
  6275  2496 -18775.331   26  483 -19552.648 -16379.878  16.2%   990  903s
  6459  2442 infeasible   28      -19552.648 -16387.396  16.2%   980  909s
  6508  2440 -19269.859   27  343 -19552.648 -16387.396  16.2%   980  918s
  6554  2437 -19510.871   28  333 -19552.648 -16387.396  16.2%   980  924s
  6615  2451     cutoff   29      -19552.648 -16387.396  16.2%   976  935s
  6764  2494 -18597.974   26  782 -19552.648 -16387.396  16.2%   965  945s
  7085  2486 -18696.439   27  688 -19552.648 -16387.396  16.2%   936  957s
  7435  2461 -18741.381   28  703 -19552.648 -16387.396  16.2%   912  970s
  7681  2534 -19056.776   29  772 -19552.648 -16671.774  14.7%   903  980s
  8009  2498 -19242.551   31  704 -19552.648 -16671.774  14.7%   888  993s
  8455  2433     cutoff   34      -19552.648 -16786.779  14.1%   863 1005s
  8933  2285     cutoff   32      -19552.648 -16878.581  13.7%   841 1017s
  9390  2167     cutoff   56      -19552.648 -16996.776  13.1%   826 1030s
  9769  2065 -18690.241   25  452 -19552.648 -17052.806  12.8%   819 1043s
 10202  1897     cutoff   25      -19552.648 -17234.682  11.9%   809 1058s
 10696  1685 -19269.766   27  441 -19552.648 -17329.068  11.4%   796 1069s
 11203  1580     cutoff   28      -19552.648 -17423.414  10.9%   784 1080s
 11812  1513     cutoff   60      -19552.648 -17572.180  10.1%   768 1095s
 12250  1404 -18999.376   50  228 -19552.648 -17721.749  9.36%   760 1107s
 12835  1218 -18639.748   37  276 -19552.648 -17855.803  8.68%   749 1119s
 13466   909 -19125.647   44  101 -19552.648 -18042.038  7.73%   736 1133s
 14270   466     cutoff   53      -19552.648 -18316.880  6.32%   718 1146s
 15104    59     cutoff   28      -19552.648 -18491.664  5.43%   699 1155s

Cutting planes:
  Gomory: 1
  Implied bound: 75
  Projected implied bound: 1
  MIR: 673
  Mixing: 1
  Flow cover: 1336
  Zero half: 4
  RLT: 13
  Relax-and-lift: 53

Explored 15801 nodes (10871624 simplex iterations) in 1157.34 seconds (2012.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19552.6 -19560.4 -19621 ... -21697
No other solutions better than -19552.6

Optimal solution found (tolerance 1.00e-06)
Best objective -1.955264829117e+04, best bound -1.955264829117e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1157.36s
  Master Objective (UB) = -19552.65, θ = 93701.64
  Upper Bound (UB) = -19552.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93701.64
  [DEBUG]   ✓ Scenario 0: θ = 93701.64 ≤ Q = 93701.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93701.64 ≤ Q = 93701.64 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93701.64 ≤ Q = 93701.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93701.64 ≤ Q = 93701.64 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6c444c54
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x93bbb3ac
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.435884e+13
Presolve removed 2608 rows and 1904 columns
Presolve time: 0.01s
Presolved: 485 rows, 485 columns, 1366 nonzeros
Found heuristic solution: objective 7783313.6841
Variable types: 325 continuous, 160 integer (160 binary)

Root relaxation: objective -1.083761e+05, 273 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108376.08    0  122 7783313.68 -108376.08   101%     -    0s
H    0     0                    -74273.01100 -108376.08  45.9%     -    0s
H    0     0                    -75227.92766 -108376.08  44.1%     -    0s
     0     0 -90318.925    0   67 -75227.928 -90318.925  20.1%     -    0s
H    0     0                    -86966.27711 -90266.765  3.80%     -    0s
     0     0 -90134.671    0   69 -86966.277 -90134.671  3.64%     -    0s
     0     0 -90014.652    0   69 -86966.277 -90014.652  3.51%     -    0s
H    0     0                    -87368.54062 -90014.652  3.03%     -    0s
     0     0 -89817.451    0   68 -87368.541 -89817.451  2.80%     -    0s
     0     0 -89511.136    0   67 -87368.541 -89511.136  2.45%     -    0s
     0     0 -89339.329    0   69 -87368.541 -89339.329  2.26%     -    0s
     0     0 -89306.586    0   69 -87368.541 -89306.586  2.22%     -    0s
     0     0 -89211.657    0   68 -87368.541 -89211.657  2.11%     -    0s
     0     0 -89041.017    0   67 -87368.541 -89041.017  1.91%     -    0s
     0     0 -89040.941    0   67 -87368.541 -89040.941  1.91%     -    0s
     0     0 -88788.838    0   67 -87368.541 -88788.838  1.63%     -    0s
     0     0 -88525.853    0   56 -87368.541 -88525.853  1.32%     -    0s
     0     0 -88517.630    0   62 -87368.541 -88517.630  1.32%     -    0s
     0     0 -88333.111    0   62 -87368.541 -88333.111  1.10%     -    0s
     0     0 -88170.725    0   23 -87368.541 -88170.725  0.92%     -    0s
     0     0 -88046.400    0   25 -87368.541 -88046.400  0.78%     -    0s
     0     0 -87990.217    0   42 -87368.541 -87990.217  0.71%     -    0s
     0     0 -87967.470    0   45 -87368.541 -87967.470  0.69%     -    0s
     0     0 -87920.602    0   47 -87368.541 -87920.602  0.63%     -    0s
     0     0 -87918.161    0   45 -87368.541 -87918.161  0.63%     -    0s
     0     0 -87709.060    0   23 -87368.541 -87709.060  0.39%     -    0s
     0     0 -87576.983    0   30 -87368.541 -87576.983  0.24%     -    0s
     0     0 -87567.411    0   27 -87368.541 -87567.411  0.23%     -    0s
     0     0 -87543.986    0   32 -87368.541 -87543.986  0.20%     -    0s
     0     0 -87543.587    0   30 -87368.541 -87543.587  0.20%     -    0s
     0     0 -87527.378    0   35 -87368.541 -87527.378  0.18%     -    0s
     0     0 -87518.680    0   28 -87368.541 -87518.680  0.17%     -    0s
     0     0 -87468.441    0    9 -87368.541 -87468.441  0.11%     -    0s
     0     0 -87468.441    0   10 -87368.541 -87468.441  0.11%     -    0s
H    0     0                    -87438.76829 -87468.441  0.03%     -    0s
     0     0 -87449.293    0    2 -87438.768 -87449.293  0.01%     -    0s
     0     0     cutoff    0      -87438.768 -87438.768  0.00%     -    0s

Cutting planes:
  MIR: 3
  Flow cover: 8
  RLT: 1

Explored 1 nodes (1206 simplex iterations) in 0.16 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -87438.8 -87368.5 -87113.4 ... 1.43588e+13
No other solutions better than -87438.8

Optimal solution found (tolerance 1.00e-06)
Best objective -8.743876829060e+04, best bound -8.743876829060e+04, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 85119.00
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -87438.77
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -87438.77 = 85119.00
  [DEBUG]   Current θ from Master = 93701.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8582.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28135.29
  Lower Bound (LB) = -25540.72
  Gap (UB-LB) = 5988.0718, Absolute Gap = 5988.0718, Relative Gap = 0.306254
  Not converged yet (gap = 5988.07 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x5998a7b3
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 1.18s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431970.6122
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24990   -2.0508576e+04   0.000000e+00   1.746516e+06      5s
   34646   -9.1234163e+03   0.000000e+00   1.270562e+07     10s
   41646   -6.5789577e+03   0.000000e+00   1.994427e+06     15s
   47837   -6.0592325e+03   0.000000e+00   2.631408e+06     20s
Concurrent spin time: 3.96s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -4.750153e+03, 41905 iterations, 21.48 seconds (29.22 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4750.1532    0  393 -180243.66 -4750.1532  97.4%     -   23s
H    0     0                    -171106.9613 -4750.1532  97.2%     -   23s
H    0     0                    -96141.90641 -4750.1532  95.1%     -   23s
H    0     0                    -95929.10642 -4750.1532  95.0%     -   23s
H    0     0                    -95658.86326 -4750.1532  95.0%     -   23s
H    0     0                    -95028.41350 -4750.1532  95.0%     -   23s
H    0     0                    -70475.62083 -4750.1532  93.3%     -   23s
H    0     0                    -70463.13542 -4750.1532  93.3%     -   23s
H    0     0                    -44288.00888 -4750.1532  89.3%     -   23s
H    0     0                    -44230.64594 -4750.1532  89.3%     -   23s
H    0     0                    -44182.11580 -4750.1532  89.2%     -   23s
H    0     0                    -37172.56201 -4750.1532  87.2%     -   25s
H    0     0                    -37137.56765 -4750.1532  87.2%     -   25s
H    0     0                    -37050.20044 -4750.1532  87.2%     -   25s
H    0     0                    -37037.10522 -7790.4509  79.0%     -   32s
H    0     0                    -36934.28617 -7790.4509  78.9%     -   32s
H    0     0                    -36777.30335 -7790.4509  78.8%     -   32s
     0     0 -7790.4509    0  445 -36777.303 -7790.4509  78.8%     -   32s
H    0     0                    -30059.71449 -8245.0628  72.6%     -   35s
     0     0 -8245.1344    0  442 -30059.714 -8245.1344  72.6%     -   35s
     0     0 -8303.0893    0  445 -30059.714 -8303.0893  72.4%     -   35s
     0     0 -8480.0181    0  458 -30059.714 -8480.0181  71.8%     -   37s
     0     0 -8489.4707    0  454 -30059.714 -8489.4707  71.8%     -   38s
     0     0 -8490.2616    0  466 -30059.714 -8490.2616  71.8%     -   38s
     0     0 -8490.2616    0  466 -30059.714 -8490.2616  71.8%     -   38s
     0     0 -9739.1028    0  491 -30059.714 -9739.1028  67.6%     -   46s
H    0     0                    -30055.71937 -9739.1028  67.6%     -   46s
H    0     0                    -29873.76957 -9843.4117  67.0%     -   49s
     0     0 -9843.4117    0  508 -29873.770 -9843.4117  67.0%     -   49s
     0     0 -9982.8723    0  515 -29873.770 -9982.8723  66.6%     -   50s
     0     0 -10022.629    0  523 -29873.770 -10022.629  66.5%     -   52s
     0     0 -10035.814    0  518 -29873.770 -10035.814  66.4%     -   52s
     0     0 -10037.506    0  519 -29873.770 -10037.506  66.4%     -   53s
     0     0 -10039.230    0  574 -29873.770 -10039.230  66.4%     -   53s
     0     0 -10039.324    0  521 -29873.770 -10039.324  66.4%     -   53s
H    0     0                    -24922.33340 -10039.324  59.7%     -   59s
H    0     0                    -24919.58999 -10039.324  59.7%     -   59s
H    0     0                    -24918.38863 -10039.324  59.7%     -   59s
H    0     0                    -24917.82126 -10039.324  59.7%     -   59s
H    0     0                    -24905.09928 -10039.324  59.7%     -   59s
     0     0 -10999.267    0  492 -24905.099 -10999.267  55.8%     -   66s
     0     0 -11175.805    0  507 -24905.099 -11175.805  55.1%     -   70s
     0     0 -11471.113    0  365 -24905.099 -11471.113  53.9%     -   72s
     0     0 -11492.371    0  506 -24905.099 -11492.371  53.9%     -   73s
     0     0 -11534.337    0  513 -24905.099 -11534.337  53.7%     -   74s
     0     0 -11555.955    0  525 -24905.099 -11555.955  53.6%     -   75s
     0     0 -11563.191    0  375 -24905.099 -11563.191  53.6%     -   76s
     0     0 -11568.858    0  528 -24905.099 -11568.858  53.5%     -   76s
H    0     0                    -24860.73803 -11574.965  53.4%     -   77s
     0     0 -11574.965    0  521 -24860.738 -11574.965  53.4%     -   77s
     0     0 -11576.754    0  464 -24860.738 -11576.754  53.4%     -   77s
     0     0 -11577.287    0  469 -24860.738 -11577.287  53.4%     -   77s
     0     0 -12014.236    0  484 -24860.738 -12014.236  51.7%     -   86s
     0     0 -12276.527    0  512 -24860.738 -12276.527  50.6%     -   90s
     0     0 -12350.604    0  580 -24860.738 -12350.604  50.3%     -   91s
     0     0 -12527.179    0  591 -24860.738 -12527.179  49.6%     -   94s
     0     0 -12539.503    0  594 -24860.738 -12539.503  49.6%     -   95s
     0     0 -12554.413    0  596 -24860.738 -12554.413  49.5%     -   96s
     0     0 -12557.368    0  599 -24860.738 -12557.368  49.5%     -   96s
     0     0 -12601.669    0  591 -24860.738 -12601.669  49.3%     -   97s
     0     0 -12606.182    0  587 -24860.738 -12606.182  49.3%     -   97s
     0     0 -12621.342    0  589 -24860.738 -12621.342  49.2%     -   98s
     0     0 -12637.673    0  604 -24860.738 -12637.673  49.2%     -   99s
     0     0 -12661.659    0  584 -24860.738 -12661.659  49.1%     -  100s
     0     0 -12665.207    0  589 -24860.738 -12665.207  49.1%     -  100s
     0     0 -12667.894    0  587 -24860.738 -12667.894  49.0%     -  100s
     0     0 -12668.084    0  591 -24860.738 -12668.084  49.0%     -  101s
     0     0 -12868.595    0  658 -24860.738 -12868.595  48.2%     -  104s
     0     0 -12892.167    0  673 -24860.738 -12892.167  48.1%     -  106s
     0     0 -12916.654    0  673 -24860.738 -12916.654  48.0%     -  108s
     0     0 -12923.729    0  626 -24860.738 -12923.729  48.0%     -  109s
     0     0 -12929.968    0  626 -24860.738 -12929.968  48.0%     -  110s
     0     0 -12933.771    0  644 -24860.738 -12933.771  48.0%     -  110s
     0     0 -12934.335    0  638 -24860.738 -12934.335  48.0%     -  110s
H    0     0                    -24583.87586 -13029.835  47.0%     -  114s
H    0     0                    -24536.19644 -13029.835  46.9%     -  114s
H    0     0                    -24509.53077 -13029.835  46.8%     -  114s
H    0     0                    -24476.14170 -13029.835  46.8%     -  114s
     0     0 -13029.835    0  558 -24476.142 -13029.835  46.8%     -  114s
H    0     0                    -23879.57392 -13030.025  45.4%     -  115s
H    0     0                    -23110.63020 -13030.025  43.6%     -  116s
H    0     0                    -23012.72068 -13030.025  43.4%     -  116s
H    0     0                    -22844.71963 -13030.025  43.0%     -  116s
H    0     0                    -22705.15979 -13030.025  42.6%     -  116s
H    0     0                    -22674.76520 -13030.025  42.5%     -  116s
H    0     0                    -22136.55532 -13030.025  41.1%     -  116s
H    0     0                    -22119.62335 -13030.025  41.1%     -  117s
     0     0 -13065.731    0  560 -22119.623 -13065.731  40.9%     -  119s
     0     0 -13086.805    0  563 -22119.623 -13086.805  40.8%     -  120s
     0     0 -13092.818    0  565 -22119.623 -13092.818  40.8%     -  120s
     0     0 -13094.174    0  569 -22119.623 -13094.174  40.8%     -  121s
     0     0 -13095.461    0  622 -22119.623 -13095.461  40.8%     -  121s
     0     0 -13103.221    0  626 -22119.623 -13103.221  40.8%     -  121s
     0     0 -13105.771    0  572 -22119.623 -13105.771  40.8%     -  122s
     0     0 -13105.988    0  570 -22119.623 -13105.988  40.7%     -  122s
     0     0 -13144.625    0  586 -22119.623 -13144.625  40.6%     -  125s
H    0     0                    -22117.76545 -13144.971  40.6%     -  125s
     0     0 -13232.769    0  577 -22117.765 -13232.769  40.2%     -  127s
     0     0 -13245.618    0  597 -22117.765 -13245.618  40.1%     -  128s
     0     0 -13249.468    0  600 -22117.765 -13249.468  40.1%     -  129s
     0     0 -13251.682    0  596 -22117.765 -13251.682  40.1%     -  129s
     0     0 -13252.074    0  595 -22117.765 -13252.074  40.1%     -  130s
     0     0 -13293.744    0  601 -22117.765 -13293.744  39.9%     -  132s
H    0     0                    -22032.03299 -13293.769  39.7%     -  133s
H    0     0                    -21990.65643 -13293.769  39.5%     -  134s
H    0     0                    -21936.33598 -13293.769  39.4%     -  134s
     0     0 -13306.034    0  596 -21936.336 -13306.034  39.3%     -  135s
     0     0 -13307.586    0  601 -21936.336 -13307.586  39.3%     -  135s
     0     0 -13308.004    0  598 -21936.336 -13308.004  39.3%     -  136s
     0     0 -13320.377    0  609 -21936.336 -13320.377  39.3%     -  138s
     0     0 -13322.291    0  607 -21936.336 -13322.291  39.3%     -  139s
     0     0 -13322.627    0  609 -21936.336 -13322.627  39.3%     -  140s
     0     0 -13349.654    0  618 -21936.336 -13349.654  39.1%     -  142s
     0     0 -13351.908    0  632 -21936.336 -13351.908  39.1%     -  142s
     0     0 -13352.766    0  621 -21936.336 -13352.766  39.1%     -  143s
     0     0 -13358.773    0  619 -21936.336 -13358.773  39.1%     -  145s
     0     0 -13360.316    0  622 -21936.336 -13360.316  39.1%     -  146s
     0     0 -13360.900    0  611 -21936.336 -13360.900  39.1%     -  146s
     0     0 -13370.298    0  618 -21936.336 -13370.298  39.0%     -  148s
     0     0 -13370.952    0  622 -21936.336 -13370.952  39.0%     -  149s
     0     0 -13380.875    0  671 -21936.336 -13380.875  39.0%     -  151s
     0     0 -13381.037    0  671 -21936.336 -13381.037  39.0%     -  153s
H    0     0                    -21934.08290 -13381.190  39.0%     -  165s
     0     2 -13381.190    0  671 -21934.083 -13381.190  39.0%     -  167s
     3     8 -13451.161    2  650 -21934.083 -13433.687  38.8%  1833  173s
     7    16 -13575.759    3  599 -21934.083 -13451.502  38.7%  2446  178s
    15    32 -13851.968    4  657 -21934.083 -13576.687  38.1%  3751  187s
    31    37 -15742.987    5  280 -21934.083 -13852.634  36.8%  5566  201s
    48    65 -15209.073    6  285 -21934.083 -13852.634  36.8%  4856  218s
H   62    65                    -21923.57095 -13852.634  36.8%  4541  218s
    76   163 -15230.865    7  280 -21923.571 -13852.634  36.8%  4351  230s
   195   189 -15325.096   11  256 -21923.571 -13852.634  36.8%  2784  241s
H  196   189                    -21920.19852 -13852.634  36.8%  2770  241s
   233   249     cutoff   11      -21920.199 -14182.346  35.3%  2887  250s
   318   308 -19497.969   15  238 -21920.199 -14183.909  35.3%  2830  260s
H  385   308                    -21916.41897 -14183.909  35.3%  2720  260s
   389   373 -15339.281   13  253 -21916.419 -14183.909  35.3%  2705  270s
   477   425 -15790.465   16  297 -21916.419 -14183.909  35.3%  2485  279s
   544   479 -15799.440   17  303 -21916.419 -14183.909  35.3%  2423  290s
   638   515 -16026.263   21  301 -21916.419 -14183.909  35.3%  2275  301s
   712   558 -16046.001   19  221 -21916.419 -14183.909  35.3%  2304  309s
   785   608 -16622.276   22  290 -21916.419 -14183.909  35.3%  2343  319s
   855   670 -16630.771   23  308 -21916.419 -14183.909  35.3%  2330  329s
   941   716 -16737.499   25  304 -21916.419 -14183.909  35.3%  2286  340s
H  971   716                    -21717.57961 -14183.909  34.7%  2259  340s
H 1023   763                    -21344.61922 -14183.909  33.5%  2259  349s
H 1024   763                    -20652.83141 -14183.909  31.3%  2257  349s
  1108   750 -17425.588   28  283 -20652.831 -14183.909  31.3%  2246  360s
H 1109   750                    -20634.96950 -14183.909  31.3%  2244  360s
H 1109   750                    -19881.73897 -14183.909  28.7%  2244  360s
  1186   794 -17325.290   27  290 -19881.739 -14183.909  28.7%  2221  369s
  1277   876 -17584.415   28  210 -19881.739 -14183.909  28.7%  2241  379s
H 1290   876                    -19856.54807 -14183.909  28.6%  2228  379s
H 1299   876                    -19854.91824 -14183.909  28.6%  2249  379s
H 1307   876                    -19829.72734 -14183.909  28.5%  2238  379s
  1377   929 -17727.004   35  201 -19829.727 -14183.909  28.5%  2210  390s
  1498   995 -17979.752   38  179 -19829.727 -14349.812  27.6%  2183  402s
H 1562   995                    -19826.09962 -14349.812  27.6%  2147  402s
H 1580   995                    -19816.06947 -14598.372  26.3%  2145  402s
  1622  1080 infeasible   38      -19816.069 -14598.372  26.3%  2132  411s
  1773  1154 -15369.260   13  257 -19816.069 -14608.746  26.3%  2088  423s
H 1819  1154                    -19776.82537 -14608.746  26.1%  2066  423s
  1925  1238 infeasible   15      -19776.825 -14608.746  26.1%  2042  435s
  2105  1254 -17100.801   18  383 -19776.825 -14608.746  26.1%  1983  446s
H 2108  1254                    -19762.60278 -14608.746  26.1%  1980  446s
  2151  1364     cutoff   19      -19762.603 -14608.746  26.1%  1988  457s
  2359  1456     cutoff   21      -19762.603 -14608.746  26.1%  1915  470s
  2552  1615     cutoff   21      -19762.603 -14608.746  26.1%  1866  483s
  2772  1752 -18340.496   24  180 -19762.603 -14801.890  25.1%  1788  492s
  3035  1869 -19286.038   31  182 -19762.603 -14801.890  25.1%  1717  504s
  3340  1824 infeasible   46      -19762.603 -15074.485  23.7%  1654  516s
  3537  1929 -17117.307    8  484 -19762.603 -15074.485  23.7%  1646  530s
  3771  2031 -18248.567   10  314 -19762.603 -15109.940  23.5%  1619  544s
  4003  2116 -18847.367   13  367 -19762.603 -15109.940  23.5%  1604  558s
  4209  2133 infeasible   19      -19762.603 -15244.172  22.9%  1604  569s
  4255  2157 -19487.030   18  332 -19762.603 -15244.172  22.9%  1616  583s
  4344  2207 -19589.128   19  270 -19762.603 -15244.172  22.9%  1628  596s
  4536  2311 -15977.847   18  237 -19762.603 -15252.626  22.8%  1621  609s
  4786  2333     cutoff   36      -19762.603 -15343.298  22.4%  1610  622s
  4840  2388 -16059.249   13  542 -19762.603 -15366.718  22.2%  1617  639s
  4990  2457 -16908.306   16  464 -19762.603 -15366.718  22.2%  1614  655s
  5241  2500 -17831.965   20  199 -19762.603 -15525.699  21.4%  1607  672s
  5484  2537 -18009.610   19  296 -19762.603 -15551.955  21.3%  1610  690s
  5781  2602 infeasible   23      -19762.603 -15715.135  20.5%  1607  709s
  6190  2698 infeasible   12      -19762.603 -15854.624  19.8%  1579  726s
  6571  2805     cutoff   23      -19762.603 -16008.437  19.0%  1562  741s
  6998  2806 -16596.992   16  671 -19762.603 -16057.363  18.7%  1546  793s
  7000  2807 -18004.420   16  393 -19762.603 -16057.363  18.7%  1546  816s
  7001  2808 -17720.363   18  504 -19762.603 -16057.363  18.7%  1546  839s
  7002  2809 -16300.619   17  576 -19762.603 -16057.363  18.7%  1546  848s
  7003  2809 -18872.214   32  662 -19762.603 -16057.363  18.7%  1545  856s
  7004  2810 -19431.264   33  609 -19762.603 -16057.363  18.7%  1545  862s
  7005  2811 -18106.266   16  559 -19762.603 -16057.363  18.7%  1545  865s
  7006  2811 -19471.731   16  604 -19762.603 -16057.363  18.7%  1545  871s
  7007  2812 -18610.307   47  643 -19762.603 -16057.363  18.7%  1544  877s
  7008  2813 -18153.667   21  597 -19762.603 -16057.363  18.7%  1544  880s
  7010  2814 -19294.509   13  601 -19762.603 -16057.363  18.7%  1544  886s
  7011  2815 -17741.491   34  681 -19762.603 -16057.363  18.7%  1544  895s
  7013  2816 -18907.292   20  687 -19762.603 -16057.363  18.7%  1543  903s
  7014  2817 -19577.730   45  694 -19762.603 -16057.363  18.7%  1543  912s
  7015  2817 -16512.679   18  620 -19762.603 -16057.363  18.7%  1543  916s
  7016  2818 -17306.869   15  628 -19762.603 -16057.363  18.7%  1543  920s
  7017  2819 -16979.035   24  699 -19762.603 -16057.363  18.7%  1542  929s
  7018  2819 -19415.668   14  681 -19762.603 -16057.363  18.7%  1542  934s
  7019  2820 -18327.512   41  684 -19762.603 -16057.363  18.7%  1542  940s
  7021  2821 -18291.726   42  625 -19762.603 -16057.363  18.7%  1541  947s
  7022  2822 -17863.796   28  702 -19762.603 -16057.363  18.7%  1541  954s
  7023  2823 -19507.891   35  637 -19762.603 -16057.363  18.7%  1541  958s
  7024  2823 -16749.927   18  691 -19762.603 -16057.363  18.7%  1541  965s
  7026  2825 -16949.392   51  699 -19762.603 -16057.363  18.7%  1540  975s
  7027  2825 -17773.900   23  699 -19762.603 -16057.363  18.7%  1540 1000s
  7028  2826 -18118.023   24  699 -19762.603 -16057.363  18.7%  1540 1015s
  7029  2830 -16057.363   11  601 -19762.603 -16057.363  18.7%  1560 1021s
  7031  2833 -16057.363   12  602 -19762.603 -16057.363  18.7%  1561 1037s
  7035  2840 -16057.363   13  620 -19762.603 -16057.363  18.7%  1563 1046s
  7043  2853 -16057.363   14  618 -19762.603 -16057.363  18.7%  1566 1059s
  7059  2849 -16057.363   15  535 -19762.603 -16057.363  18.7%  1582 1078s
  7076  2865 -18132.005   16  315 -19762.603 -16057.363  18.7%  1587 1096s
  7108  2895 -19113.015   17  480 -19762.603 -16057.363  18.7%  1612 1114s
  7182  2927 -19555.063   19  456 -19762.603 -16057.363  18.7%  1641 1129s
  7274  2916 infeasible   20      -19762.603 -16057.363  18.7%  1648 1139s
  7350  2918 -18007.774   20  284 -19762.603 -16057.363  18.7%  1651 1152s
  7438  2886 -18926.494   22  241 -19762.603 -16057.363  18.7%  1651 1164s
  7502  2882     cutoff   23      -19762.603 -16057.363  18.7%  1650 1179s
  7586  2882     cutoff   22      -19762.603 -16057.363  18.7%  1649 1187s
  7651  2899 -16707.442   18  356 -19762.603 -16057.363  18.7%  1646 1197s
  7746  2861 -18437.831   18  263 -19762.603 -16057.363  18.7%  1639 1207s
  7804  2852 -19165.107   19  251 -19762.603 -16057.363  18.7%  1637 1217s
  7869  2832     cutoff   19      -19762.603 -16057.363  18.7%  1632 1225s
  7934  2827 -19259.132   21  353 -19762.603 -16114.495  18.5%  1629 1235s
  8023  2796     cutoff   23      -19762.603 -16114.495  18.5%  1623 1246s
  8099  2777 -19353.427   25  239 -19762.603 -16125.907  18.4%  1621 1257s
  8212  2743     cutoff   24      -19762.603 -16401.374  17.0%  1612 1268s
  8329  2700 -17874.939   24  269 -19762.603 -16421.194  16.9%  1601 1281s
  8471  2636 -18060.657   27  235 -19762.603 -16421.194  16.9%  1589 1292s
  8595  2599     cutoff   29      -19762.603 -16772.370  15.1%  1582 1301s
  8728  2533 -18433.584   22  296 -19762.603 -17273.060  12.6%  1572 1310s
  8870  2447 -18622.183   24  268 -19762.603 -17523.267  11.3%  1561 1322s
  9045  2332     cutoff   27      -19762.603 -17523.267  11.3%  1546 1330s
  9213  2234     cutoff   30      -19762.603 -17620.060  10.8%  1531 1339s
  9389  2124 -18215.275   23  211 -19762.603 -17668.607  10.6%  1512 1347s
  9539  2022 infeasible   24      -19762.603 -17866.155  9.60%  1499 1353s
  9660  1969 -18964.650   28  331 -19762.603 -17877.769  9.54%  1486 1360s
  9714  1935     cutoff   29      -19762.603 -18246.304  7.67%  1481 1367s
  9757  1920     cutoff   23      -19762.603 -18390.117  6.94%  1475 1374s
  9763  1916 -18487.861   27  224 -19762.603 -18436.716  6.71%  1475 1380s
  9769  1917 -18572.609   29  273 -19762.603 -18520.068  6.29%  1474 1385s
  9778  1912     cutoff   35      -19762.603 -18572.717  6.02%  1473 1390s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 36
  Projected implied bound: 5
  MIR: 548
  Mixing: 1
  Flow cover: 1353
  Zero half: 4
  RLT: 7
  Relax-and-lift: 51

Explored 9803 nodes (14571412 simplex iterations) in 1393.91 seconds (2352.73 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19762.6 -19776.8 -19816.1 ... -20652.8
No other solutions better than -19762.6

Optimal solution found (tolerance 1.00e-06)
Best objective -1.976260278043e+04, best bound -1.976260278043e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1393.93s
  Master Objective (UB) = -19762.60, θ = 93336.30
  Upper Bound (UB) = -19762.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93336.30
  [DEBUG]   ✓ Scenario 0: θ = 93336.30 ≤ Q = 93336.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93336.30 ≤ Q = 93336.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93336.30 ≤ Q = 93336.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93336.30 ≤ Q = 93336.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93336.30 ≤ Q = 93336.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xa959d2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xff56a62e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.431776e+13
Presolve removed 2608 rows and 1904 columns
Presolve time: 0.01s
Presolved: 485 rows, 485 columns, 1366 nonzeros
Found heuristic solution: objective 7755674.7676
Variable types: 325 continuous, 160 integer (160 binary)

Root relaxation: objective -1.084444e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108444.41    0  122 7755674.77 -108444.41   101%     -    0s
H    0     0                    -74411.65017 -108444.41  45.7%     -    0s
H    0     0                    -75366.56683 -108444.41  43.9%     -    0s
     0     0 -87000.770    0   65 -75366.567 -87000.770  15.4%     -    0s
H    0     0                    -83754.16097 -86991.521  3.87%     -    0s
     0     0 -86643.565    0   64 -83754.161 -86643.565  3.45%     -    0s
     0     0 -86562.906    0   64 -83754.161 -86562.906  3.35%     -    0s
H    0     0                    -84146.81462 -86562.906  2.87%     -    0s
H    0     0                    -84176.27134 -86452.502  2.70%     -    0s
     0     0 -86452.502    0   66 -84176.271 -86452.502  2.70%     -    0s
     0     0 -86199.986    0   66 -84176.271 -86199.986  2.40%     -    0s
     0     0 -85911.520    0   67 -84176.271 -85911.520  2.06%     -    0s
     0     0 -85891.947    0   67 -84176.271 -85891.947  2.04%     -    0s
     0     0 -85890.976    0   67 -84176.271 -85890.976  2.04%     -    0s
     0     0 -85799.167    0   66 -84176.271 -85799.167  1.93%     -    0s
     0     0 -85764.919    0   66 -84176.271 -85764.919  1.89%     -    0s
     0     2 -85764.919    0   66 -84176.271 -85764.919  1.89%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 219
  RLT: 41
  Relax-and-lift: 2
  BQP: 2

Explored 5067 nodes (30251 simplex iterations) in 0.58 seconds (0.21 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -84176.3 -83754.2 -75366.6 ... 1.43178e+13
No other solutions better than -84176.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.417627133577e+04, best bound -8.417627133577e+04, gap 0.0000%
  Subproblem solved in 0.62s
  Worst-case operational profit (Z_SP) = 88381.50
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84176.27
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -84176.27 = 88381.50
  [DEBUG]   Current θ from Master = 93336.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4954.81 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24717.41
  Lower Bound (LB) = -24717.41
  Gap (UB-LB) = 4954.8084, Absolute Gap = 4954.8084, Relative Gap = 0.250716
  Not converged yet (gap = 4954.81 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x0fffc3f1
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 1.69s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431970.6122
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24657   -5.4822473e+04   0.000000e+00   3.596536e+06      5s
   33424   -2.2977766e+04   0.000000e+00   3.410899e+06     10s
   40325   -9.6543177e+03   0.000000e+00   3.165304e+06     15s
   45741   -9.2951603e+03   0.000000e+00   3.202169e+06     20s
Concurrent spin time: 3.16s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -4.750153e+03, 36481 iterations, 20.23 seconds (27.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4750.1532    0  393 -180243.66 -4750.1532  97.4%     -   22s
H    0     0                    -166904.1577 -4750.1532  97.2%     -   22s
H    0     0                    -112959.0914 -4750.1532  95.8%     -   23s
H    0     0                    -105826.4277 -4750.1532  95.5%     -   23s
H    0     0                    -105446.9034 -4750.1532  95.5%     -   23s
H    0     0                    -104791.4409 -4750.1532  95.5%     -   23s
H    0     0                    -68709.97684 -4750.1532  93.1%     -   23s
H    0     0                    -67850.55462 -4750.1532  93.0%     -   23s
H    0     0                    -41502.83821 -4750.1532  88.6%     -   23s
H    0     0                    -35811.42316 -4750.1532  86.7%     -   23s
H    0     0                    -35787.33679 -4750.1532  86.7%     -   23s
H    0     0                    -29052.16555 -4750.1532  83.6%     -   24s
H    0     0                    -28754.06082 -4750.1532  83.5%     -   24s
H    0     0                    -28709.02225 -4750.1532  83.5%     -   24s
H    0     0                    -28674.05058 -7874.3655  72.5%     -   33s
     0     0 -8052.9750    0  438 -28674.051 -8052.9750  71.9%     -   33s
     0     0 -8115.4556    0  436 -28674.051 -8115.4556  71.7%     -   35s
     0     0 -8115.4556    0  439 -28674.051 -8115.4556  71.7%     -   35s
     0     0 -8115.4556    0  442 -28674.051 -8115.4556  71.7%     -   35s
     0     0 -8196.6371    0  458 -28674.051 -8196.6371  71.4%     -   37s
H    0     0                    -28589.50784 -8317.8939  70.9%     -   40s
     0     0 -8339.7739    0  454 -28589.508 -8339.7739  70.8%     -   41s
     0     0 -8339.7739    0  453 -28589.508 -8339.7739  70.8%     -   41s
     0     0 -8339.7739    0  451 -28589.508 -8339.7739  70.8%     -   42s
     0     0 -8339.7739    0  463 -28589.508 -8339.7739  70.8%     -   42s
     0     0 -8339.7739    0  457 -28589.508 -8339.7739  70.8%     -   42s
     0     0 -8339.7739    0  451 -28589.508 -8339.7739  70.8%     -   42s
     0     0 -9662.9347    0  468 -28589.508 -9662.9347  66.2%     -   50s
H    0     0                    -25481.92379 -9664.8513  62.1%     -   50s
H    0     0                    -24951.12668 -9664.8513  61.3%     -   50s
     0     0 -9940.8832    0  533 -24951.127 -9940.8832  60.2%     -   55s
     0     0 -10003.561    0  488 -24951.127 -10003.561  59.9%     -   57s
     0     0 -10064.002    0  493 -24951.127 -10064.002  59.7%     -   59s
     0     0 -10159.137    0  544 -24951.127 -10159.137  59.3%     -   60s
     0     0 -10159.506    0  550 -24951.127 -10159.506  59.3%     -   61s
     0     0 -11200.701    0  547 -24951.127 -11200.701  55.1%     -   73s
     0     0 -11531.566    0  541 -24951.127 -11531.566  53.8%     -   77s
     0     0 -11918.972    0  569 -24951.127 -11918.972  52.2%     -   82s
     0     0 -11966.028    0  580 -24951.127 -11966.028  52.0%     -   84s
     0     0 -11975.335    0  583 -24951.127 -11975.335  52.0%     -   85s
     0     0 -11986.240    0  584 -24951.127 -11986.240  52.0%     -   86s
     0     0 -11994.522    0  587 -24951.127 -11994.522  51.9%     -   86s
     0     0 -11997.957    0  592 -24951.127 -11997.957  51.9%     -   87s
     0     0 -11998.217    0  594 -24951.127 -11998.217  51.9%     -   87s
H    0     0                    -23978.22357 -12294.701  48.7%     -   96s
     0     0 -12294.701    0  540 -23978.224 -12294.701  48.7%     -   96s
H    0     0                    -23080.65439 -12296.555  46.7%     -   97s
     0     0 -12369.557    0  541 -23080.654 -12369.557  46.4%     -  103s
     0     0 -12425.111    0  628 -23080.654 -12425.111  46.2%     -  105s
     0     0 -12479.098    0  562 -23080.654 -12479.098  45.9%     -  107s
     0     0 -12488.127    0  572 -23080.654 -12488.127  45.9%     -  108s
     0     0 -12495.680    0  577 -23080.654 -12495.680  45.9%     -  109s
     0     0 -12506.114    0  574 -23080.654 -12506.114  45.8%     -  110s
     0     0 -12508.070    0  577 -23080.654 -12508.070  45.8%     -  110s
     0     0 -12513.139    0  575 -23080.654 -12513.139  45.8%     -  111s
     0     0 -12514.671    0  576 -23080.654 -12514.671  45.8%     -  111s
     0     0 -12514.692    0  577 -23080.654 -12514.692  45.8%     -  111s
H    0     0                    -22821.45218 -12571.209  44.9%     -  115s
H    0     0                    -22780.82009 -12571.209  44.8%     -  115s
     0     0 -12571.209    0  595 -22780.820 -12571.209  44.8%     -  115s
H    0     0                    -22777.37951 -12572.263  44.8%     -  116s
H    0     0                    -22693.64481 -12572.263  44.6%     -  116s
     0     0 -12589.068    0  593 -22693.645 -12589.068  44.5%     -  118s
     0     0 -12598.231    0  604 -22693.645 -12598.231  44.5%     -  118s
     0     0 -12600.798    0  599 -22693.645 -12600.798  44.5%     -  119s
     0     0 -12602.242    0  598 -22693.645 -12602.242  44.5%     -  119s
     0     0 -12602.519    0  603 -22693.645 -12602.519  44.5%     -  119s
     0     0 -12866.500    0  593 -22693.645 -12866.500  43.3%     -  126s
H    0     0                    -22577.79073 -12866.905  43.0%     -  128s
H    0     0                    -22539.01904 -12866.905  42.9%     -  128s
H    0     0                    -22275.22229 -12866.905  42.2%     -  128s
H    0     0                    -22271.28698 -12866.905  42.2%     -  128s
     0     0 -12899.782    0  591 -22271.287 -12899.782  42.1%     -  131s
     0     0 -12912.996    0  596 -22271.287 -12912.996  42.0%     -  132s
     0     0 -12919.988    0  664 -22271.287 -12919.988  42.0%     -  133s
     0     0 -12923.969    0  668 -22271.287 -12923.969  42.0%     -  134s
     0     0 -12924.408    0  668 -22271.287 -12924.408  42.0%     -  134s
     0     0 -12951.849    0  594 -22271.287 -12951.849  41.8%     -  137s
     0     0 -12957.315    0  608 -22271.287 -12957.315  41.8%     -  138s
     0     0 -12961.585    0  617 -22271.287 -12961.585  41.8%     -  139s
     0     0 -12963.270    0  618 -22271.287 -12963.270  41.8%     -  139s
     0     0 -12963.626    0  611 -22271.287 -12963.626  41.8%     -  139s
     0     0 -13046.570    0  602 -22271.287 -13046.570  41.4%     -  143s
H    0     0                    -22214.58899 -13046.718  41.3%     -  144s
H    0     0                    -22128.69248 -13046.718  41.0%     -  145s
     0     0 -13049.369    0  607 -22128.692 -13049.369  41.0%     -  146s
     0     0 -13050.910    0  611 -22128.692 -13050.910  41.0%     -  146s
     0     0 -13051.705    0  614 -22128.692 -13051.705  41.0%     -  147s
     0     0 -13089.643    0  695 -22128.692 -13089.643  40.8%     -  151s
     0     0 -13091.572    0  614 -22128.692 -13091.572  40.8%     -  152s
     0     0 -13093.012    0  698 -22128.692 -13093.012  40.8%     -  153s
     0     0 -13093.663    0  629 -22128.692 -13093.663  40.8%     -  153s
     0     0 -13117.811    0  622 -22128.692 -13117.811  40.7%     -  156s
     0     0 -13123.847    0  632 -22128.692 -13123.847  40.7%     -  157s
     0     0 -13126.363    0  635 -22128.692 -13126.363  40.7%     -  158s
     0     0 -13127.588    0  641 -22128.692 -13127.588  40.7%     -  159s
     0     0 -13127.802    0  646 -22128.692 -13127.802  40.7%     -  159s
     0     0 -13140.700    0  646 -22128.692 -13140.700  40.6%     -  161s
     0     0 -13141.504    0  652 -22128.692 -13141.504  40.6%     -  162s
     0     0 -13157.708    0  713 -22128.692 -13157.708  40.5%     -  165s
     0     0 -13163.142    0  655 -22128.692 -13163.142  40.5%     -  166s
     0     0 -13166.061    0  649 -22128.692 -13166.061  40.5%     -  167s
     0     0 -13166.768    0  650 -22128.692 -13166.768  40.5%     -  167s
     0     0 -13188.885    0  730 -22128.692 -13188.885  40.4%     -  169s
     0     0 -13192.130    0  660 -22128.692 -13192.130  40.4%     -  170s
     0     0 -13193.536    0  657 -22128.692 -13193.536  40.4%     -  171s
     0     0 -13194.438    0  658 -22128.692 -13194.438  40.4%     -  171s
     0     0 -13205.838    0  728 -22128.692 -13205.838  40.3%     -  173s
     0     0 -13209.787    0  723 -22128.692 -13209.787  40.3%     -  174s
     0     0 -13210.185    0  727 -22128.692 -13210.185  40.3%     -  175s
     0     0 -13219.159    0  734 -22128.692 -13219.159  40.3%     -  177s
     0     0 -13223.591    0  735 -22128.692 -13223.591  40.2%     -  178s
     0     0 -13225.413    0  675 -22128.692 -13225.413  40.2%     -  179s
     0     0 -13226.361    0  676 -22128.692 -13226.361  40.2%     -  179s
     0     0 -13272.032    0  732 -22128.692 -13272.032  40.0%     -  184s
     0     0 -13280.961    0  670 -22128.692 -13280.961  40.0%     -  185s
     0     0 -13285.754    0  685 -22128.692 -13285.754  40.0%     -  186s
     0     0 -13287.631    0  680 -22128.692 -13287.631  40.0%     -  187s
     0     0 -13289.080    0  742 -22128.692 -13289.080  39.9%     -  188s
     0     0 -13289.183    0  749 -22128.692 -13289.183  39.9%     -  188s
     0     0 -13297.027    0  686 -22128.692 -13297.027  39.9%     -  191s
     0     0 -13298.369    0  694 -22128.692 -13298.369  39.9%     -  191s
     0     0 -13298.726    0  700 -22128.692 -13298.726  39.9%     -  192s
     0     0 -13301.422    0  689 -22128.692 -13301.422  39.9%     -  194s
     0     0 -13302.947    0  764 -22128.692 -13302.947  39.9%     -  195s
     0     0 -13303.856    0  698 -22128.692 -13303.856  39.9%     -  195s
     0     0 -13305.961    0  687 -22128.692 -13305.961  39.9%     -  197s
     0     0 -13306.334    0  694 -22128.692 -13306.334  39.9%     -  198s
     0     0 -13310.372    0  688 -22128.692 -13310.372  39.9%     -  200s
     0     0 -13310.607    0  688 -22128.692 -13310.607  39.8%     -  202s
H    0     0                    -22012.68634 -13310.607  39.5%     -  225s
H    0     0                    -21998.70407 -13310.607  39.5%     -  229s
     0     2 -13310.607    0  688 -21998.704 -13310.607  39.5%     -  230s
     1     4 -13420.321    1  642 -21998.704 -13312.545  39.5%  2312  236s
     3     8 -13694.840    2  700 -21998.704 -13420.976  39.0%  3745  241s
     7    16 -13810.512    3  696 -21998.704 -13545.144  38.4%  3582  246s
    15    32 -13998.997    4  674 -21998.704 -13810.666  37.2%  3966  254s
    31    48 -14058.625    5  526 -21998.704 -13997.956  36.4%  5503  288s
H   47    78                    -21995.02241 -13997.956  36.4%  5518  302s
H   50    78                    -21916.41897 -13997.956  36.1%  5359  302s
    79   148 -14812.545    7  529 -21916.419 -13997.956  36.1%  4295  323s
   151   221 -14966.057    9  518 -21916.419 -13997.956  36.1%  2990  337s
   238   275 -15865.376   10  572 -21916.419 -13997.956  36.1%  2895  350s
   331   298 -15185.761   10  518 -21916.419 -13997.956  36.1%  2585  362s
   414   331     cutoff    9      -21916.419 -13997.956  36.1%  2360  374s
   483   385 -19326.767   11  647 -21916.419 -13997.956  36.1%  2340  385s
   551   424 -17525.130   11  598 -21916.419 -13997.956  36.1%  2298  396s
   645   452 -18093.858   12  446 -21916.419 -13997.956  36.1%  2157  408s
   729   493 -17810.583   12  601 -21916.419 -13997.956  36.1%  2056  419s
   819   522 -19136.348   13  488 -21916.419 -13997.956  36.1%  1975  429s
   905   579 -18604.131   13  493 -21916.419 -13997.956  36.1%  1910  440s
  1009   601 -21531.556   15  477 -21916.419 -13997.956  36.1%  1827  450s
  1089   625 -18700.007   14  388 -21916.419 -13999.678  36.1%  1778  461s
  1193   651 -20455.258   15  522 -21916.419 -14160.106  35.4%  1726  472s
  1271   693 -20842.761   15  511 -21916.419 -14160.106  35.4%  1722  484s
  1358   736     cutoff   14      -21916.419 -14160.106  35.4%  1717  496s
  1454   792 -18581.972    8  504 -21916.419 -14160.106  35.4%  1718  508s
  1561   876 -18982.575   10  436 -21916.419 -14160.106  35.4%  1693  520s
  1708   929 -19892.605   12  391 -21916.419 -14160.106  35.4%  1652  534s
  1829  1004 -20203.697   14  383 -21916.419 -14160.106  35.4%  1643  548s
  1958  1086 -20767.380   19  304 -21916.419 -14160.106  35.4%  1623  561s
  2100  1150 -21326.845   24  160 -21916.419 -14415.677  34.2%  1601  573s
  2217  1209 -17494.713    9  524 -21916.419 -14415.677  34.2%  1585  587s
  2361  1270 -18480.262   11  447 -21916.419 -14415.677  34.2%  1565  601s
  2502  1349 -18853.725   14  248 -21916.419 -14415.677  34.2%  1541  616s
  2663  1415     cutoff   20      -21916.419 -14415.677  34.2%  1527  629s
  2842  1515 -16875.524   11  302 -21916.419 -14415.677  34.2%  1508  646s
  3081  1603 -19452.789   14  361 -21916.419 -14415.677  34.2%  1464  662s
  3348  1657 -17542.940   16  407 -21916.419 -14415.677  34.2%  1415  678s
  3549  1681 -18746.899   26  175 -21916.419 -14919.113  31.9%  1396  693s
H 3578  1681                    -21557.84104 -14919.113  30.8%  1404  693s
  3593  1740 -15827.756   10  543 -21557.841 -14919.113  30.8%  1409  711s
  3746  1743     cutoff   21      -21557.841 -14919.113  30.8%  1431  729s
H 3749  1743                    -20665.04329 -14919.113  27.8%  1430  729s
H 3756  1743                    -19949.54055 -14919.113  25.2%  1431  729s
H 3792  1743                    -19815.48850 -14919.113  24.7%  1436  729s
  3900  1711 -18282.119   12  239 -19815.488 -14919.113  24.7%  1435  748s
  4075  1763 -19135.687   10  395 -19815.488 -15450.710  22.0%  1449  765s
H 4081  1763                    -19790.55958 -15450.710  21.9%  1449  765s
  4283  1717     cutoff   10      -19790.560 -15477.774  21.8%  1445  785s
  4489  1735     cutoff   11      -19790.560 -15657.730  20.9%  1451  804s
  4720  1697 -16725.200   13  472 -19790.560 -15659.198  20.9%  1456  824s
  4811  1724 -17294.655   14  452 -19790.560 -15659.198  20.9%  1461  843s
  5001  1717 -17959.577   16  313 -19790.560 -15930.559  19.5%  1472  866s
  5236  1674 -19057.520   18  331 -19790.560 -15984.124  19.2%  1480  890s
  5531  1679 infeasible   12      -19790.560 -16109.015  18.6%  1475  912s
  5818  1650 -17074.043   21  178 -19790.560 -16166.381  18.3%  1479  938s
  6148  1612 -19681.694   16  168 -19790.560 -16398.570  17.1%  1470  962s
  6535  1531 -18723.911    9  377 -19790.560 -16429.566  17.0%  1456  989s
  6953  1482 -19766.519   17  378 -19790.560 -17006.462  14.1%  1443 1014s
  7274  1372     cutoff   21      -19790.560 -17113.847  13.5%  1430 1043s
  7746  1312 infeasible   13      -19790.560 -17232.628  12.9%  1410 1071s
  8244  1154 -19305.196   18  424 -19790.560 -17546.185  11.3%  1393 1100s
  8890   892 -18945.841   15  273 -19790.560 -17909.773  9.50%  1350 1126s
  9823   500 infeasible   20      -19790.560 -18222.730  7.92%  1279 1146s
 10704    45     cutoff   18      -19790.560 -18638.902  5.82%  1201 1163s

Cutting planes:
  Gomory: 3
  Implied bound: 10
  MIR: 830
  Flow cover: 1784
  RLT: 31
  Relax-and-lift: 150

Explored 11834 nodes (13194360 simplex iterations) in 1164.27 seconds (2189.76 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19790.6 -19815.5 -19949.5 ... -22214.6
No other solutions better than -19790.6

Optimal solution found (tolerance 1.00e-06)
Best objective -1.979055958120e+04, best bound -1.979055958120e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1164.32s
  Master Objective (UB) = -19790.56, θ = 93074.86
  Upper Bound (UB) = -19790.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93074.86
  [DEBUG]   ✓ Scenario 0: θ = 93074.86 ≤ Q = 93074.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93074.86 ≤ Q = 93074.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93074.86 ≤ Q = 93074.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93074.86 ≤ Q = 93074.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x22f4aa51
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdd0b55af
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.435884e+13
Presolve removed 2608 rows and 1904 columns
Presolve time: 0.01s
Presolved: 485 rows, 485 columns, 1366 nonzeros
Found heuristic solution: objective 7755104.7711
Variable types: 325 continuous, 160 integer (160 binary)

Root relaxation: objective -1.085927e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108592.74    0  122 7755104.77 -108592.74   101%     -    0s
H    0     0                    -74481.87047 -108592.74  45.8%     -    0s
H    0     0                    -75436.78713 -108592.74  44.0%     -    0s
     0     0 -85934.326    0   68 -75436.787 -85934.326  13.9%     -    0s
H    0     0                    -82590.12326 -85864.154  3.96%     -    0s
     0     0 -85651.225    0   67 -82590.123 -85651.225  3.71%     -    0s
H    0     0                    -83110.17706 -85556.510  2.94%     -    0s
H    0     0                    -83122.28113 -85345.435  2.67%     -    0s
     0     0 -85345.435    0   68 -83122.281 -85345.435  2.67%     -    0s
     0     0 -85256.973    0   70 -83122.281 -85256.973  2.57%     -    0s
     0     0 -85255.973    0   70 -83122.281 -85255.973  2.57%     -    0s
     0     2 -85255.973    0   70 -83122.281 -85255.973  2.57%     -    0s

Cutting planes:
  Gomory: 40
  Implied bound: 2
  Projected implied bound: 18
  MIR: 76
  Flow cover: 37
  RLT: 39
  Relax-and-lift: 1
  BQP: 2

Explored 10420 nodes (61502 simplex iterations) in 0.60 seconds (0.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -83122.3 -82590.1 -75436.8 ... 1.43588e+13
No other solutions better than -83122.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.312228112747e+04, best bound -8.312228112747e+04, gap 0.0000%
  Subproblem solved in 0.64s
  Worst-case operational profit (Z_SP) = 89435.49
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83122.28
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -83122.28 = 89435.49
  [DEBUG]   Current θ from Master = 93074.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3639.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23429.93
  Lower Bound (LB) = -23429.93
  Gap (UB-LB) = 3639.3708, Absolute Gap = 3639.3708, Relative Gap = 0.183894
  Not converged yet (gap = 3639.37 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0x53668cef
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 1.59s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431970.6122
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22639   -1.1083816e+05   0.000000e+00   2.142819e+10      5s
   32753   -2.4326723e+04   0.000000e+00   1.107021e+08     10s
   38266   -2.1068094e+04   0.000000e+00   1.137693e+07     15s
   42988   -1.6339985e+04   0.000000e+00   2.656090e+06     20s
   47416   -1.1662419e+04   0.000000e+00   2.676577e+07     25s
Concurrent spin time: 2.85s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -4.750153e+03, 44484 iterations, 26.98 seconds (37.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4750.1532    0  393 -180243.66 -4750.1532  97.4%     -   29s
H    0     0                    -174093.4421 -4750.1532  97.3%     -   29s
H    0     0                    -109993.9358 -4750.1532  95.7%     -   29s
H    0     0                    -107628.1125 -4750.1532  95.6%     -   29s
H    0     0                    -107459.5185 -4750.1532  95.6%     -   29s
H    0     0                    -68690.47130 -4750.1532  93.1%     -   29s
H    0     0                    -67831.04908 -4750.1532  93.0%     -   30s
H    0     0                    -41502.83821 -4750.1532  88.6%     -   30s
H    0     0                    -35811.42316 -4750.1532  86.7%     -   30s
H    0     0                    -35787.33679 -4750.1532  86.7%     -   30s
H    0     0                    -28709.02225 -4750.1532  83.5%     -   31s
H    0     0                    -28674.05058 -8017.5974  72.0%     -   46s
     0     0 -8479.8317    0  446 -28674.051 -8479.8317  70.4%     -   46s
     0     0 -8486.1654    0  447 -28674.051 -8486.1654  70.4%     -   51s
     0     0 -8486.1654    0  446 -28674.051 -8486.1654  70.4%     -   51s
     0     0 -8486.1654    0  449 -28674.051 -8486.1654  70.4%     -   52s
     0     0 -8486.1654    0  451 -28674.051 -8486.1654  70.4%     -   53s
     0     0 -8486.1654    0  446 -28674.051 -8486.1654  70.4%     -   54s
     0     0 -8486.1654    0  442 -28674.051 -8486.1654  70.4%     -   54s
     0     0 -8486.1654    0  452 -28674.051 -8486.1654  70.4%     -   55s
     0     0 -9711.2059    0  462 -28674.051 -9711.2059  66.1%     -   57s
     0     0 -9711.2059    0  462 -28674.051 -9711.2059  66.1%     -   57s
     0     0 -9870.6941    0  556 -28674.051 -9870.6941  65.6%     -   70s
H    0     0                    -25124.93814 -9871.6375  60.7%     -   70s
H    0     0                    -25124.37077 -9871.6375  60.7%     -   70s
H    0     0                    -25102.05301 -9871.6375  60.7%     -   70s
     0     0 -10092.458    0  562 -25102.053 -10092.458  59.8%     -   73s
     0     0 -10203.038    0  560 -25102.053 -10203.038  59.4%     -   77s
     0     0 -10227.338    0  565 -25102.053 -10227.338  59.3%     -   78s
     0     0 -10234.820    0  575 -25102.053 -10234.820  59.2%     -   78s
     0     0 -10306.431    0  515 -25102.053 -10306.431  58.9%     -   80s
     0     0 -10344.913    0  574 -25102.053 -10344.913  58.8%     -   81s
     0     0 -10345.712    0  578 -25102.053 -10345.712  58.8%     -   82s
     0     0 -10346.190    0  530 -25102.053 -10346.190  58.8%     -   82s
H    0     0                    -25069.24568 -11480.907  54.2%     -   97s
H    0     0                    -25065.73243 -11480.907  54.2%     -   97s
     0     0 -11480.907    0  518 -25065.732 -11480.907  54.2%     -   97s
H    0     0                    -25062.27176 -11481.174  54.2%     -   97s
     0     0 -11822.820    0  552 -25062.272 -11822.820  52.8%     -  103s
     0     0 -11890.570    0  587 -25062.272 -11890.570  52.6%     -  106s
     0     0 -11936.122    0  603 -25062.272 -11936.122  52.4%     -  108s
     0     0 -11967.912    0  599 -25062.272 -11967.912  52.2%     -  109s
     0     0 -11978.913    0  603 -25062.272 -11978.913  52.2%     -  110s
     0     0 -11988.695    0  602 -25062.272 -11988.695  52.2%     -  111s
     0     0 -11990.220    0  605 -25062.272 -11990.220  52.2%     -  112s
     0     0 -11992.163    0  614 -25062.272 -11992.163  52.2%     -  112s
     0     0 -11992.701    0  614 -25062.272 -11992.701  52.1%     -  113s
H    0     0                    -25042.57202 -12378.703  50.6%     -  123s
     0     0 -12378.703    0  630 -25042.572 -12378.703  50.6%     -  123s
H    0     0                    -24992.10395 -12476.350  50.1%     -  128s
H    0     0                    -24957.36842 -12476.350  50.0%     -  128s
     0     0 -12476.350    0  560 -24957.368 -12476.350  50.0%     -  128s
     0     0 -12509.279    0  494 -24957.368 -12509.279  49.9%     -  130s
     0     0 -12520.730    0  580 -24957.368 -12520.730  49.8%     -  132s
     0     0 -12552.040    0  555 -24957.368 -12552.040  49.7%     -  134s
     0     0 -12571.506    0  566 -24957.368 -12571.506  49.6%     -  135s
     0     0 -12575.517    0  570 -24957.368 -12575.517  49.6%     -  135s
     0     0 -12578.415    0  578 -24957.368 -12578.415  49.6%     -  136s
     0     0 -12578.874    0  577 -24957.368 -12578.874  49.6%     -  136s
     0     0 -12671.404    0  643 -24957.368 -12671.404  49.2%     -  141s
H    0     0                    -24932.58956 -12671.446  49.2%     -  142s
     0     0 -12707.328    0  582 -24932.590 -12707.328  49.0%     -  144s
     0     0 -12710.538    0  586 -24932.590 -12710.538  49.0%     -  144s
     0     0 -12711.732    0  587 -24932.590 -12711.732  49.0%     -  144s
     0     0 -12712.751    0  647 -24932.590 -12712.751  49.0%     -  145s
     0     0 -12713.252    0  593 -24932.590 -12713.252  49.0%     -  145s
     0     0 -12770.583    0  620 -24932.590 -12770.583  48.8%     -  149s
H    0     0                    -24891.15466 -12794.225  48.6%     -  153s
     0     0 -12794.225    0  579 -24891.155 -12794.225  48.6%     -  153s
     0     0 -12805.485    0  651 -24891.155 -12805.485  48.6%     -  154s
     0     0 -12809.917    0  650 -24891.155 -12809.917  48.5%     -  156s
     0     0 -12811.609    0  663 -24891.155 -12811.609  48.5%     -  156s
     0     0 -12811.951    0  664 -24891.155 -12811.951  48.5%     -  156s
H    0     0                    -23647.54203 -12970.958  45.1%     -  162s
     0     0 -12970.958    0  661 -23647.542 -12970.958  45.1%     -  162s
H    0     0                    -23360.79177 -12971.136  44.5%     -  163s
     0     0 -13002.672    0  741 -23360.792 -13002.672  44.3%     -  165s
H    0     0                    -23175.67599 -13012.935  43.9%     -  166s
H    0     0                    -22749.60630 -13012.935  42.8%     -  166s
H    0     0                    -22541.55741 -13012.935  42.3%     -  166s
H    0     0                    -22089.14863 -13012.935  41.1%     -  166s
H    0     0                    -22011.74155 -13012.935  40.9%     -  166s
     0     0 -13012.935    0  732 -22011.742 -13012.935  40.9%     -  166s
     0     0 -13014.351    0  725 -22011.742 -13014.351  40.9%     -  167s
     0     0 -13015.085    0  732 -22011.742 -13015.085  40.9%     -  167s
     0     0 -13092.450    0  669 -22011.742 -13092.450  40.5%     -  172s
H    0     0                    -20925.75336 -13092.866  37.4%     -  173s
     0     0 -13106.788    0  653 -20925.753 -13106.788  37.4%     -  175s
     0     0 -13119.094    0  667 -20925.753 -13119.094  37.3%     -  177s
     0     0 -13126.258    0  674 -20925.753 -13126.258  37.3%     -  178s
     0     0 -13130.422    0  676 -20925.753 -13130.422  37.3%     -  179s
     0     0 -13130.735    0  674 -20925.753 -13130.735  37.3%     -  179s
     0     0 -13141.984    0  676 -20925.753 -13141.984  37.2%     -  183s
     0     0 -13144.665    0  680 -20925.753 -13144.665  37.2%     -  184s
     0     0 -13147.408    0  611 -20925.753 -13147.408  37.2%     -  185s
     0     0 -13150.033    0  627 -20925.753 -13150.033  37.2%     -  185s
     0     0 -13150.548    0  629 -20925.753 -13150.548  37.2%     -  186s
     0     0 -13176.023    0  620 -20925.753 -13176.023  37.0%     -  189s
H    0     0                    -20899.40393 -13176.296  37.0%     -  190s
H    0     0                    -20733.66320 -13176.296  36.4%     -  190s
H    0     0                    -20672.59774 -13176.296  36.3%     -  192s
H    0     0                    -20542.66175 -13176.296  35.9%     -  192s
H    0     0                    -20359.34187 -13176.296  35.3%     -  192s
     0     0 -13181.207    0  637 -20359.342 -13181.207  35.3%     -  194s
     0     0 -13181.796    0  636 -20359.342 -13181.796  35.3%     -  194s
     0     0 -13189.781    0  641 -20359.342 -13189.781  35.2%     -  197s
     0     0 -13196.535    0  634 -20359.342 -13196.535  35.2%     -  198s
     0     0 -13198.349    0  635 -20359.342 -13198.349  35.2%     -  198s
     0     0 -13199.454    0  642 -20359.342 -13199.454  35.2%     -  199s
     0     0 -13204.893    0  639 -20359.342 -13204.893  35.1%     -  201s
     0     0 -13207.199    0  638 -20359.342 -13207.199  35.1%     -  202s
     0     0 -13208.794    0  639 -20359.342 -13208.794  35.1%     -  202s
     0     0 -13209.547    0  642 -20359.342 -13209.547  35.1%     -  203s
     0     0 -13212.867    0  713 -20359.342 -13212.867  35.1%     -  205s
     0     0 -13215.099    0  718 -20359.342 -13215.099  35.1%     -  206s
     0     0 -13217.704    0  721 -20359.342 -13217.704  35.1%     -  207s
     0     0 -13218.175    0  724 -20359.342 -13218.175  35.1%     -  207s
     0     0 -13227.112    0  718 -20359.342 -13227.112  35.0%     -  210s
     0     0 -13228.488    0  719 -20359.342 -13228.488  35.0%     -  211s
     0     0 -13229.868    0  716 -20359.342 -13229.868  35.0%     -  211s
     0     0 -13230.013    0  718 -20359.342 -13230.013  35.0%     -  212s
     0     0 -13234.696    0  710 -20359.342 -13234.696  35.0%     -  214s
     0     0 -13252.248    0  650 -20359.342 -13252.248  34.9%     -  217s
     0     0 -13256.773    0  645 -20359.342 -13256.773  34.9%     -  218s
     0     0 -13258.236    0  651 -20359.342 -13258.236  34.9%     -  218s
     0     0 -13259.154    0  653 -20359.342 -13259.154  34.9%     -  218s
     0     0 -13261.206    0  656 -20359.342 -13261.206  34.9%     -  221s
     0     0 -13261.881    0  654 -20359.342 -13261.881  34.9%     -  221s
     0     0 -13264.935    0  656 -20359.342 -13264.935  34.8%     -  223s
     0     0 -13265.629    0  652 -20359.342 -13265.629  34.8%     -  224s
     0     0 -13269.235    0  661 -20359.342 -13269.235  34.8%     -  226s
     0     0 -13271.044    0  652 -20359.342 -13271.044  34.8%     -  227s
     0     0 -13271.449    0  656 -20359.342 -13271.449  34.8%     -  227s
     0     0 -13277.724    0  712 -20359.342 -13277.724  34.8%     -  230s
     0     0 -13277.793    0  712 -20359.342 -13277.793  34.8%     -  233s
H    0     0                    -20150.09594 -13277.900  34.1%     -  266s
H    0     0                    -20072.66297 -13277.900  33.9%     -  268s
H    0     0                    -20044.35027 -13277.900  33.8%     -  268s
H    0     0                    -20001.23132 -13277.900  33.6%     -  270s
     0     2 -13277.900    0  712 -20001.231 -13277.900  33.6%     -  274s
     1     4 -13529.264    1  619 -20001.231 -13278.125  33.6%  6390  280s
     3     8 -13667.531    2  665 -20001.231 -13532.365  32.3%  5572  287s
     7    16 -13831.384    3  676 -20001.231 -13566.014  32.2%  5457  299s
    15    32 -13892.565    4  677 -20001.231 -13831.514  30.8%  5324  307s
    31    46 -14126.998    5  674 -20001.231 -13892.665  30.5%  6565  332s
    47    74 -14834.715    6  507 -20001.231 -13892.665  30.5%  8617  352s
H   49    74                    -19831.33212 -13892.665  29.9%  8481  352s
    77   164 -14947.014    7  558 -19831.332 -13892.665  29.9%  6997  375s
   171   273 -15076.594   10  544 -19831.332 -13892.665  29.9%  4926  388s
   296   351 -15174.531    9  455 -19831.332 -13892.665  29.9%  3347  396s
   384   399     cutoff   10      -19831.332 -13892.665  29.9%  2904  406s
   456   450 -15105.759   11  460 -19831.332 -13892.665  29.9%  2695  417s
   529   496     cutoff   11      -19831.332 -13892.665  29.9%  2558  428s
   612   542 infeasible   11      -19831.332 -13896.018  29.9%  2364  439s
   693   615 -15388.884   13  449 -19831.332 -13896.018  29.9%  2254  448s
   776   681 infeasible   13      -19831.332 -13896.018  29.9%  2116  459s
   879   763 -15422.859   14  432 -19831.332 -13896.018  29.9%  1984  471s
H  919   763                    -19829.72734 -13896.018  29.9%  1934  471s
   995   819 -15669.558   16  423 -19829.727 -13896.018  29.9%  1834  481s
  1081   901 -15701.519   17  421 -19829.727 -13896.018  29.9%  1742  492s
  1188   985 -15835.739   18  419 -19829.727 -13896.018  29.9%  1656  503s
  1322  1084 -15942.392   19  407 -19829.727 -13896.018  29.9%  1560  515s
  1482  1185 -16575.931   19  408 -19829.727 -13896.018  29.9%  1461  526s
  1643  1311 -18698.205   18  211 -19829.727 -13935.388  29.7%  1381  538s
  1801  1442 -17601.238   21  421 -19829.727 -13935.388  29.7%  1330  550s
  1978  1575 -16696.849   20  317 -19829.727 -13935.388  29.7%  1274  560s
  2161  1710 -17021.221   23  301 -19829.727 -13935.388  29.7%  1219  568s
  2358  1834 infeasible   25      -19829.727 -14004.131  29.4%  1158  580s
  2551  1986 -17789.124   24  258 -19829.727 -14004.378  29.4%  1123  591s
  2784  2067 -18098.505   30  266 -19829.727 -14004.378  29.4%  1085  603s
  2963  2172 -18379.674   35  247 -19829.727 -14004.378  29.4%  1077  616s
  3137  2267 -18946.512   38  180 -19829.727 -14250.581  28.1%  1075  629s
  3303  2332 -19174.170   43  174 -19829.727 -14345.392  27.7%  1071  642s
H 3324  2332                    -19821.96245 -14345.392  27.6%  1067  642s
H 3370  2332                    -19815.48850 -14349.387  27.6%  1072  642s
  3408  2448 infeasible   48      -19815.488 -14349.387  27.6%  1069  653s
  3573  2628 -15779.772    7  276 -19815.488 -14349.387  27.6%  1055  667s
  3822  2629 -17103.267   16  712 -19815.488 -14349.387  27.6%  1034  744s
  3824  2630 -19598.754   72  393 -19815.488 -14349.387  27.6%  1033  803s
  3825  2631 -16893.753   22  563 -19815.488 -14349.387  27.6%  1033  835s
  3826  2632 -16271.319   40  673 -19815.488 -14349.387  27.6%  1033  851s
  3827  2632 -17456.113   14  704 -19815.488 -14349.387  27.6%  1033  864s
  3828  2633 -16385.705   25  655 -19815.488 -14349.387  27.6%  1032  870s
  3829  2634 -16672.610   21  657 -19815.488 -14349.387  27.6%  1032  875s
  3831  2635 -19088.767   42  531 -19815.488 -14349.387  27.6%  1032  882s
  3832  2636 -19323.507   63  673 -19815.488 -14349.387  27.6%  1031  888s
  3833  2636 -15954.427    9  676 -19815.488 -14349.387  27.6%  1031  893s
  3834  2637 -17303.206   35  696 -19815.488 -14349.387  27.6%  1031  896s
  3837  2639 -19206.722   49  697 -19815.488 -14349.387  27.6%  1030  901s
  3839  2640 -16140.858   21  698 -19815.488 -14349.387  27.6%  1029  907s
  3841  2642 -19405.428   62  704 -19815.488 -14349.387  27.6%  1029  914s
  3842  2642 -17230.856   51  669 -19815.488 -14349.387  27.6%  1029  931s
  3845  2644 -16318.588   42  685 -19815.488 -14349.387  27.6%  1028  940s
  3846  2645 -14865.360   11  621 -19815.488 -14349.387  27.6%  1027  953s
  3847  2646 -17629.917   31  643 -19815.488 -14349.387  27.6%  1027  956s
  3849  2647 -18591.913   38  653 -19815.488 -14349.387  27.6%  1027  960s
  3851  2648 -16518.460   23  656 -19815.488 -14349.387  27.6%  1026  966s
  3852  2649 -17572.809   10  636 -19815.488 -14349.387  27.6%  1026  978s
  3853  2650 -19066.714   26  629 -19815.488 -14349.387  27.6%  1026  980s
  3855  2651 -19580.746   47  637 -19815.488 -14349.387  27.6%  1025  986s
  3856  2652 -19130.901   42  674 -19815.488 -14349.387  27.6%  1025 1000s
  3858  2653 -15761.614   11  629 -19815.488 -14349.387  27.6%  1024 1006s
  3859  2654 -16552.733   18  702 -19815.488 -14349.387  27.6%  1024 1015s
  3860  2654 -15393.365   14  696 -19815.488 -14349.387  27.6%  1024 1020s
  3861  2655 -17322.280   38  627 -19815.488 -14349.387  27.6%  1024 1027s
  3863  2656 -18751.348   24  656 -19815.488 -14349.387  27.6%  1023 1030s
  3865  2658 -18869.381   56  693 -19815.488 -14349.387  27.6%  1022 1042s
  3867  2659 -18059.138   28  692 -19815.488 -14349.387  27.6%  1022 1048s
  3868  2660 -15478.708   17  681 -19815.488 -14349.387  27.6%  1022 1057s
  3869  2660 -15489.888    9  691 -19815.488 -14349.387  27.6%  1021 1062s
  3870  2661 -16540.782   13  701 -19815.488 -14349.387  27.6%  1021 1070s
  3871  2662 -16246.479   20  701 -19815.488 -14349.387  27.6%  1021 1132s
  3872  2662 -19563.320   21  701 -19815.488 -14349.387  27.6%  1021 1149s
  3873  2666 -14349.387   16  628 -19815.488 -14349.387  27.6%  1078 1164s
  3875  2669 -14349.387   17  670 -19815.488 -14349.387  27.6%  1080 1173s
  3879  2676 -14349.387   18  665 -19815.488 -14349.387  27.6%  1082 1191s
  3887  2687 -14349.387   19  746 -19815.488 -14349.387  27.6%  1092 1207s
  3903  2682 -16013.554   20  417 -19815.488 -14349.387  27.6%  1112 1295s
  3917  2683 -15155.338   21  630 -19815.488 -14349.387  27.6%  1130 1320s
  3933  2697 -15260.945   22  630 -19815.488 -14349.387  27.6%  1151 1343s
  3964  2754 -15603.298   23  651 -19815.488 -14486.238  26.9%  1209 1386s
  4039  2777 -16259.801   27  566 -19815.488 -14577.563  26.4%  1255 1410s
  4115  2775 -16283.592   28  562 -19815.488 -14577.563  26.4%  1293 1428s
  4185  2789 -17043.709   30  487 -19815.488 -14577.563  26.4%  1365 1443s
  4251  2792 -19088.151   32  359 -19815.488 -14577.563  26.4%  1398 1471s
  4306  2808 infeasible   32      -19815.488 -14789.890  25.4%  1431 1488s
  4384  2802 -18277.911   32  435 -19815.488 -14789.890  25.4%  1485 1505s
  4439  2819 -18576.763   33  434 -19815.488 -14789.890  25.4%  1529 1523s
  4513  2824     cutoff   35      -19815.488 -14789.890  25.4%  1587 1544s
  4571  2851 infeasible   34      -19815.488 -14876.171  24.9%  1620 1559s
  4645  2850 infeasible   34      -19815.488 -15026.420  24.2%  1671 1573s
  4713  2862 -17163.883   25  508 -19815.488 -15026.420  24.2%  1710 1588s
  4805  2850     cutoff   28      -19815.488 -15026.420  24.2%  1737 1604s
  4883  2827     cutoff   27      -19815.488 -15026.420  24.2%  1764 1619s
  4957  2806 -19475.553   26  272 -19815.488 -15026.420  24.2%  1789 1636s
  5036  2785 infeasible   27      -19815.488 -15234.953  23.1%  1819 1653s
  5116  2777 -17413.705   24  533 -19815.488 -15234.953  23.1%  1863 1672s
  5203  2781 -17479.628   25  437 -19815.488 -15234.953  23.1%  1904 1689s
  5304  2763 -18110.176   27  567 -19815.488 -15622.653  21.2%  1946 1706s
  5393  2759 -18037.640   27  395 -19815.488 -15622.653  21.2%  1977 1725s
  5506  2732 -18813.598   29  407 -19815.488 -15622.653  21.2%  2012 1745s
  5594  2727 -18957.346   30  486 -19815.488 -15975.464  19.4%  2043 1765s
  5720  2707 -19311.000   31  439 -19815.488 -15975.464  19.4%  2070 1786s
  5852  2695 infeasible   34      -19815.488 -16003.019  19.2%  2089 1821s
  6005  2635 -19325.576   22  575 -19815.488 -16126.445  18.6%  2117 1843s
  6158  2586 -19395.117   23  311 -19815.488 -16126.445  18.6%  2130 1864s
  6353  2514 infeasible   23      -19815.488 -16351.613  17.5%  2143 1885s
  6550  2463 -18819.486   30  341 -19815.488 -16351.613  17.5%  2157 1909s
  6784  2380 infeasible   32      -19815.488 -16351.613  17.5%  2164 1932s
  6975  2315 -18050.494   32  480 -19815.488 -16771.242  15.4%  2195 1955s
  7168  2221 -18810.012   34  314 -19815.488 -16830.400  15.1%  2231 1981s
  7388  2140 -19470.732   32  283 -19815.488 -16830.400  15.1%  2241 2009s
  7641  1987 -18792.115   26  469 -19815.488 -17151.648  13.4%  2256 2034s
  7972  1849 -19600.162   27  288 -19815.488 -17407.438  12.2%  2240 2061s
  8218  1736 -18627.491   27  550 -19815.488 -17564.324  11.4%  2259 2088s
  8357  1599 -19018.843   28  360 -19815.488 -17564.324  11.4%  2266 2115s
  8657  1307 -19060.914   28  597 -19815.488 -17729.065  10.5%  2268 2145s
  8999  1059 -19232.498   29  530 -19815.488 -17729.065  10.5%  2262 2170s
H 9157   873                    -19800.73498 -17729.065  10.5%  2250 2170s
  9315   729 infeasible   36      -19800.735 -18296.783  7.60%  2242 2193s
  9475   661 infeasible   30      -19800.735 -18893.293  4.58%  2222 2200s

Cutting planes:
  Gomory: 2
  Implied bound: 33
  Projected implied bound: 4
  MIR: 787
  Flow cover: 2042
  Zero half: 1
  RLT: 11
  Relax-and-lift: 158

Explored 9539 nodes (21297082 simplex iterations) in 2200.09 seconds (3748.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19800.7 -19815.5 -19822 ... -20359.3
No other solutions better than -19800.7

Optimal solution found (tolerance 1.00e-06)
Best objective -1.980073497550e+04, best bound -1.980073497550e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 2200.11s
  Master Objective (UB) = -19800.73, θ = 93293.12
  Upper Bound (UB) = -19800.73

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93293.12
  [DEBUG]   ✓ Scenario 0: θ = 93293.12 ≤ Q = 93293.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93293.12 ≤ Q = 93293.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93293.12 ≤ Q = 93293.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93293.12 ≤ Q = 93293.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93293.12 ≤ Q = 93293.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93293.12 ≤ Q = 93293.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93293.12 ≤ Q = 93293.12 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1722558c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe8ddaa74
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.435884e+13
Presolve removed 2608 rows and 1904 columns
Presolve time: 0.01s
Presolved: 485 rows, 485 columns, 1366 nonzeros
Found heuristic solution: objective 7764202.9470
Variable types: 325 continuous, 160 integer (160 binary)

Root relaxation: objective -1.083936e+05, 268 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108393.56    0  122 7764202.95 -108393.56   101%     -    0s
H    0     0                    -74314.53717 -108393.56  45.9%     -    0s
H    0     0                    -75269.45383 -108393.56  44.0%     -    0s
     0     0 -85937.954    0   68 -75269.454 -85937.954  14.2%     -    0s
H    0     0                    -82493.39840 -85901.264  4.13%     -    0s
     0     0 -85655.834    0   67 -82493.398 -85655.834  3.83%     -    0s
H    0     0                    -83014.40078 -85590.478  3.10%     -    0s
H    0     0                    -83038.93346 -85349.326  2.78%     -    0s
     0     0 -85349.326    0   68 -83038.933 -85349.326  2.78%     -    0s
     0     0 -85261.162    0   68 -83038.933 -85261.162  2.68%     -    0s
     0     0 -85182.421    0   68 -83038.933 -85182.421  2.58%     -    0s
     0     2 -85182.421    0   68 -83038.933 -85182.421  2.58%     -    0s

Cutting planes:
  Gomory: 22
  MIR: 202
  RLT: 2
  BQP: 1

Explored 22680 nodes (146129 simplex iterations) in 0.83 seconds (0.52 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -83038.9 -82493.4 -75269.5 ... 1.43588e+13
No other solutions better than -83038.9

Optimal solution found (tolerance 1.00e-06)
Best objective -8.303893346363e+04, best bound -8.303893346363e+04, gap 0.0000%
  Subproblem solved in 0.86s
  Worst-case operational profit (Z_SP) = 89518.83
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83038.93
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -83038.93 = 89518.83
  [DEBUG]   Current θ from Master = 93293.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3774.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23575.02
  Lower Bound (LB) = -23429.93
  Gap (UB-LB) = 3629.1954, Absolute Gap = 3629.1954, Relative Gap = 0.183286
  Not converged yet (gap = 3629.20 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x9484d841
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 2.34s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431970.6122
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22885   -1.4468013e+05   0.000000e+00   1.344379e+06      5s
   34459   -2.4025545e+04   0.000000e+00   3.248157e+06     10s
   39072   -2.2737791e+04   0.000000e+00   1.058297e+08     15s
   44055   -2.1013744e+04   0.000000e+00   1.240673e+07     20s
   47841   -2.0810675e+04   0.000000e+00   1.960077e+06     25s
   53017   -1.4682080e+04   0.000000e+00   3.702218e+06     30s
   57082   -1.2838553e+04   0.000000e+00   1.027032e+07     35s
   61263   -9.7081809e+03   0.000000e+00   3.493248e+06     40s
   65286   -9.5243734e+03   0.000000e+00   6.152682e+05     45s
   69218   -9.3235201e+03   0.000000e+00   1.268639e+07     50s
Concurrent spin time: 2.35s

Solved with dual simplex

Root relaxation: objective -4.750153e+03, 87289 iterations, 48.87 seconds (60.80 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4750.1532    0  393 -180243.66 -4750.1532  97.4%     -   52s
H    0     0                    -164383.1578 -4750.1532  97.1%     -   52s
H    0     0                    -107311.7383 -4750.1532  95.6%     -   52s
H    0     0                    -104511.0015 -4750.1532  95.5%     -   52s
H    0     0                    -80742.07330 -4750.1532  94.1%     -   52s
H    0     0                    -79870.16567 -4750.1532  94.1%     -   52s
H    0     0                    -41503.40558 -4750.1532  88.6%     -   52s
H    0     0                    -41388.25145 -4750.1532  88.5%     -   52s
H    0     0                    -33687.09492 -4750.1532  85.9%     -   54s
H    0     0                    -32698.31335 -4750.1532  85.5%     -   54s
H    0     0                    -32697.74598 -4750.1532  85.5%     -   54s
H    0     0                    -30443.73947 -8193.6489  73.1%     -   74s
H    0     0                    -30409.13805 -8193.6489  73.1%     -   74s
H    0     0                    -30407.45760 -8193.6489  73.1%     -   74s
     0     0 -8448.3750    0  451 -30407.458 -8448.3750  72.2%     -   74s
     0     0 -8453.0867    0  448 -30407.458 -8453.0867  72.2%     -   77s
     0     0 -8453.0867    0  448 -30407.458 -8453.0867  72.2%     -   78s
H    0     0                    -26487.95693 -8453.0867  68.1%     -   80s
     0     0 -8453.0867    0  458 -26487.957 -8453.0867  68.1%     -   80s
     0     0 -8453.0867    0  459 -26487.957 -8453.0867  68.1%     -   81s
     0     0 -8453.0867    0  458 -26487.957 -8453.0867  68.1%     -   83s
     0     0 -8453.0867    0  462 -26487.957 -8453.0867  68.1%     -   84s
     0     0 -8453.0867    0  462 -26487.957 -8453.0867  68.1%     -   84s
     0     0 -9722.1211    0  483 -26487.957 -9722.1211  63.3%     -   98s
     0     0 -9905.2668    0  537 -26487.957 -9905.2668  62.6%     -  105s
     0     0 -9990.1039    0  487 -26487.957 -9990.1039  62.3%     -  108s
     0     0 -10162.234    0  486 -26487.957 -10162.234  61.6%     -  111s
     0     0 -10175.671    0  492 -26487.957 -10175.671  61.6%     -  112s
H    0     0                    -26480.77046 -10201.783  61.5%     -  113s
     0     0 -10201.783    0  489 -26480.770 -10201.783  61.5%     -  113s
H    0     0                    -26033.70877 -10221.341  60.7%     -  115s
H    0     0                    -25942.58716 -10221.341  60.6%     -  115s
     0     0 -10221.341    0  537 -25942.587 -10221.341  60.6%     -  115s
     0     0 -10221.723    0  544 -25942.587 -10221.723  60.6%     -  116s
     0     0 -11125.057    0  554 -25942.587 -11125.057  57.1%     -  133s
     0     0 -11205.325    0  269 -25942.587 -11205.325  56.8%     -  140s
     0     0 -11341.510    0  563 -25942.587 -11341.510  56.3%     -  146s
     0     0 -11519.318    0  514 -25942.587 -11519.318  55.6%     -  153s
H    0     0                    -25368.70096 -11602.252  54.3%     -  157s
     0     0 -11602.252    0  515 -25368.701 -11602.252  54.3%     -  157s
     0     0 -11629.033    0  524 -25368.701 -11629.033  54.2%     -  160s
     0     0 -11653.910    0  519 -25368.701 -11653.910  54.1%     -  162s
     0     0 -11658.691    0  519 -25368.701 -11658.691  54.0%     -  164s
     0     0 -11661.872    0  529 -25368.701 -11661.872  54.0%     -  166s
     0     0 -11662.176    0  527 -25368.701 -11662.176  54.0%     -  166s
     0     0 -12264.553    0  604 -25368.701 -12264.553  51.7%     -  184s
H    0     0                    -25270.74056 -12329.320  51.2%     -  189s
H    0     0                    -24564.86876 -12329.320  49.8%     -  189s
     0     0 -12329.320    0  678 -24564.869 -12329.320  49.8%     -  189s
H    0     0                    -23930.21422 -12455.752  47.9%     -  194s
H    0     0                    -23896.82515 -12455.752  47.9%     -  194s
H    0     0                    -23727.22709 -12455.752  47.5%     -  194s
     0     0 -12455.752    0  474 -23727.227 -12455.752  47.5%     -  195s
H    0     0                    -23661.66122 -12490.530  47.2%     -  199s
     0     0 -12490.530    0  543 -23661.661 -12490.530  47.2%     -  199s
     0     0 -12509.430    0  624 -23661.661 -12509.430  47.1%     -  201s
     0     0 -12517.038    0  639 -23661.661 -12517.038  47.1%     -  203s
     0     0 -12524.833    0  631 -23661.661 -12524.833  47.1%     -  204s
     0     0 -12527.279    0  639 -23661.661 -12527.279  47.1%     -  205s
     0     0 -12535.854    0  637 -23661.661 -12535.854  47.0%     -  207s
     0     0 -12536.881    0  638 -23661.661 -12536.881  47.0%     -  207s
     0     0 -12537.028    0  640 -23661.661 -12537.028  47.0%     -  207s
     0     0 -12644.881    0  653 -23661.661 -12644.881  46.6%     -  213s
H    0     0                    -22874.74154 -12644.904  44.7%     -  214s
H    0     0                    -22754.58004 -12644.904  44.4%     -  214s
H    0     0                    -22398.43901 -12644.904  43.5%     -  214s
     0     0 -12657.697    0  511 -22398.439 -12657.697  43.5%     -  216s
     0     0 -12663.979    0  585 -22398.439 -12663.979  43.5%     -  218s
     0     0 -12671.216    0  578 -22398.439 -12671.216  43.4%     -  219s
     0     0 -12672.783    0  579 -22398.439 -12672.783  43.4%     -  219s
     0     0 -12673.223    0  584 -22398.439 -12673.223  43.4%     -  219s
     0     0 -12788.909    0  696 -22398.439 -12788.909  42.9%     -  227s
H    0     0                    -22094.45027 -12789.028  42.1%     -  232s
H    0     0                    -22077.51831 -12789.028  42.1%     -  232s
H    0     0                    -22040.69294 -12789.028  42.0%     -  232s
     0     0 -12819.912    0  705 -22040.693 -12819.912  41.8%     -  237s
     0     0 -12834.916    0  652 -22040.693 -12834.916  41.8%     -  238s
     0     0 -12846.694    0  642 -22040.693 -12846.694  41.7%     -  240s
     0     0 -12849.790    0  651 -22040.693 -12849.790  41.7%     -  241s
     0     0 -12852.008    0  652 -22040.693 -12852.008  41.7%     -  242s
     0     0 -12852.750    0  712 -22040.693 -12852.750  41.7%     -  242s
     0     0 -12916.911    0  574 -22040.693 -12916.911  41.4%     -  248s
     0     0 -12943.114    0  573 -22040.693 -12943.114  41.3%     -  251s
     0     0 -12952.990    0  582 -22040.693 -12952.990  41.2%     -  253s
     0     0 -12954.850    0  643 -22040.693 -12954.850  41.2%     -  254s
     0     0 -12955.453    0  647 -22040.693 -12955.453  41.2%     -  254s
     0     0 -12988.773    0  655 -22040.693 -12988.773  41.1%     -  257s
H    0     0                    -22025.00568 -12988.826  41.0%     -  263s
H    0     0                    -22023.31682 -12988.826  41.0%     -  264s
     0     0 -13097.248    0  627 -22023.317 -13097.248  40.5%     -  268s
     0     0 -13119.753    0  641 -22023.317 -13119.753  40.4%     -  273s
     0     0 -13127.255    0  655 -22023.317 -13127.255  40.4%     -  274s
     0     0 -13131.673    0  644 -22023.317 -13131.673  40.4%     -  275s
     0     0 -13135.000    0  661 -22023.317 -13135.000  40.4%     -  276s
     0     0 -13136.510    0  660 -22023.317 -13136.510  40.4%     -  277s
     0     0 -13138.285    0  718 -22023.317 -13138.285  40.3%     -  278s
     0     0 -13138.918    0  660 -22023.317 -13138.918  40.3%     -  279s
     0     0 -13190.461    0  601 -22023.317 -13190.461  40.1%     -  285s
     0     0 -13216.559    0  592 -22023.317 -13216.559  40.0%     -  288s
     0     0 -13225.629    0  594 -22023.317 -13225.629  39.9%     -  289s
     0     0 -13228.808    0  611 -22023.317 -13228.808  39.9%     -  290s
     0     0 -13229.755    0  616 -22023.317 -13229.755  39.9%     -  290s
     0     0 -13247.474    0  606 -22023.317 -13247.474  39.8%     -  294s
     0     0 -13262.408    0  675 -22023.317 -13262.408  39.8%     -  303s
     0     0 -13263.800    0  627 -22023.317 -13263.800  39.8%     -  304s
     0     0 -13264.623    0  626 -22023.317 -13264.623  39.8%     -  305s
     0     0 -13278.354    0  685 -22023.317 -13278.354  39.7%     -  308s
     0     0 -13284.112    0  685 -22023.317 -13284.112  39.7%     -  310s
     0     0 -13285.347    0  693 -22023.317 -13285.347  39.7%     -  311s
     0     0 -13285.984    0  636 -22023.317 -13285.984  39.7%     -  311s
     0     0 -13307.008    0  638 -22023.317 -13307.008  39.6%     -  315s
     0     0 -13310.522    0  635 -22023.317 -13310.522  39.6%     -  316s
     0     0 -13310.945    0  635 -22023.317 -13310.945  39.6%     -  317s
     0     0 -13314.942    0  637 -22023.317 -13314.942  39.5%     -  320s
     0     0 -13315.710    0  647 -22023.317 -13315.710  39.5%     -  321s
H    0     0                    -21967.47197 -13315.710  39.4%     -  323s
H    0     0                    -21934.08290 -13315.710  39.3%     -  323s
     0     0 -13326.756    0  705 -21934.083 -13326.756  39.2%     -  325s
     0     0 -13328.249    0  708 -21934.083 -13328.249  39.2%     -  326s
     0     0 -13329.449    0  703 -21934.083 -13329.449  39.2%     -  327s
     0     0 -13330.449    0  706 -21934.083 -13330.449  39.2%     -  327s
     0     0 -13341.557    0  692 -21934.083 -13341.557  39.2%     -  331s
     0     0 -13346.635    0  704 -21934.083 -13346.635  39.2%     -  333s
     0     0 -13347.944    0  709 -21934.083 -13347.944  39.1%     -  334s
     0     0 -13348.116    0  711 -21934.083 -13348.116  39.1%     -  334s
     0     0 -13352.487    0  653 -21934.083 -13352.487  39.1%     -  337s
     0     0 -13354.863    0  651 -21934.083 -13354.863  39.1%     -  338s
     0     0 -13355.368    0  649 -21934.083 -13355.368  39.1%     -  339s
     0     0 -13361.236    0  648 -21934.083 -13361.236  39.1%     -  341s
     0     0 -13362.053    0  706 -21934.083 -13362.053  39.1%     -  343s
     0     0 -13363.865    0  694 -21934.083 -13363.865  39.1%     -  346s
     0     0 -13363.914    0  694 -21934.083 -13363.914  39.1%     -  349s
H    0     0                    -21923.57095 -13363.915  39.0%     -  389s
     0     2 -13363.915    0  694 -21923.571 -13363.915  39.0%     -  390s
     1     4 -13460.421    1  657 -21923.571 -13363.970  39.0%  3981  396s
     3     8 -13806.741    2  645 -21923.571 -13457.790  38.6%  4552  405s
     7    15 -13991.554    3  647 -21923.571 -13571.127  38.1%  5173  416s
    14    28 -14145.607    4  639 -21923.571 -13571.127  38.1%  5899  425s
    29    41 -14592.304    5  723 -21923.571 -14064.990  35.8%  7086  451s
    42    72 -14617.089    6  325 -21923.571 -14064.990  35.8%  7405  520s
    73   103 -14626.881    7  315 -21923.571 -14064.990  35.8%  7932  532s
H   78   103                    -21920.19852 -14064.990  35.8%  7494  532s
H  106   199                    -21916.41897 -14064.990  35.8%  6668  551s
   222   299 -14987.221   10  289 -21916.419 -14064.990  35.8%  4397  563s
   324   377 -15171.207   15  264 -21916.419 -14064.990  35.8%  3652  574s
   410   431 -15801.901   18  257 -21916.419 -14064.990  35.8%  3344  585s
   484   503 -16251.392   21  194 -21916.419 -14064.990  35.8%  3198  596s
   566   546 -16494.802   26  180 -21916.419 -14064.990  35.8%  3109  608s
   625   603 -16963.407   28  167 -21916.419 -14064.990  35.8%  3068  618s
   700   656 -17056.506   32  212 -21916.419 -14064.990  35.8%  2992  629s
   781   722 -17181.386   37  205 -21916.419 -14064.990  35.8%  2865  639s
   859   813 -17332.664   41  207 -21916.419 -14064.990  35.8%  2780  651s
   963   876 -18196.320   47  157 -21916.419 -14064.990  35.8%  2678  663s
  1064   938 -18429.112   50  188 -21916.419 -14064.990  35.8%  2605  673s
  1151  1025 -19773.081   57  204 -21916.419 -14064.990  35.8%  2521  685s
  1262  1131     cutoff   64      -21916.419 -14064.990  35.8%  2450  697s
  1390  1219 -20770.007   71  292 -21916.419 -14064.990  35.8%  2388  710s
  1498  1298 -21139.952   79  162 -21916.419 -14064.990  35.8%  2323  722s
  1649  1386 -21639.626   87   97 -21916.419 -14064.990  35.8%  2262  735s
  1781  1504 -15273.526   12  642 -21916.419 -14064.990  35.8%  2231  749s
  1909  1602 -15503.095   14  663 -21916.419 -14064.990  35.8%  2208  762s
  2039  1709 -15610.007   16  649 -21916.419 -14064.990  35.8%  2167  777s
  2178  1822 -15790.709   20  647 -21916.419 -14064.990  35.8%  2155  790s
  2327  1908 -17516.699   22  651 -21916.419 -14064.990  35.8%  2160  804s
  2441  2015 -17620.459   23  644 -21916.419 -14064.990  35.8%  2166  817s
  2594  2095 -17778.612   25  618 -21916.419 -14064.990  35.8%  2158  833s
  2770  2198 -18031.413   28  606 -21916.419 -14064.990  35.8%  2156  850s
  2941  2269 -18222.210   31  532 -21916.419 -14064.990  35.8%  2177  866s
  3081  2331 -18489.134   34  414 -21916.419 -14245.636  35.0%  2205  883s
  3231  2383 -18899.241   39  414 -21916.419 -14245.636  35.0%  2230  902s
  3358  2407 -19901.704   46  301 -21916.419 -14245.636  35.0%  2282  919s
  3394  2456     cutoff   47      -21916.419 -14503.059  33.8%  2334  933s
  3455  2486 -20483.943   48  291 -21916.419 -14503.059  33.8%  2370  951s
  3532  2545 -20710.428   50  299 -21916.419 -14503.059  33.8%  2414  970s
  3651  2629 -20596.995   33  501 -21916.419 -14503.059  33.8%  2439  987s
  3801  2721     cutoff   35      -21916.419 -14503.059  33.8%  2438 1009s
  3958  2787 -21765.096   41  231 -21916.419 -14653.632  33.1%  2450 1032s
  4112  2884 -16081.174    9  224 -21916.419 -14662.446  33.1%  2475 1052s
  4302  2885 -20523.700   49  694 -21916.419 -14721.551  32.8%  2493 1248s
  4304  2886 -20454.737   17  393 -21916.419 -14721.551  32.8%  2492 1282s
  4305  2887 -20566.108   41  565 -21916.419 -14721.551  32.8%  2491 1317s
  4306  2888 -21311.780   14  643 -21916.419 -14721.551  32.8%  2491 1333s
  4307  2888 -20475.772   33  631 -21916.419 -14721.551  32.8%  2490 1345s
  4308  2889 -19248.297   36  632 -21916.419 -14721.551  32.8%  2489 1356s
  4309  2890 -17058.202   18  706 -21916.419 -14721.551  32.8%  2489 1362s
  4310  2890 -21720.065   39  652 -21916.419 -14721.551  32.8%  2488 1369s
  4311  2891 -16300.476   40  661 -21916.419 -14721.551  32.8%  2488 1373s
  4312  2892 -15740.227    7  598 -21916.419 -14721.551  32.8%  2487 1376s
  4314  2893 -20594.755   43  658 -21916.419 -14721.551  32.8%  2486 1382s
  4315  2894 -19126.025   95  669 -21916.419 -14721.551  32.8%  2485 1390s
  4316  2894 -17285.838   63  645 -21916.419 -14721.551  32.8%  2485 1407s
  4317  2895 -20666.086   49  671 -21916.419 -14721.551  32.8%  2484 1413s
  4318  2896 -17227.694   14  735 -21916.419 -14721.551  32.8%  2484 1416s
  4321  2898 -18304.349   84  697 -21916.419 -14721.551  32.8%  2482 1427s
  4322  2898 -15616.706   15  765 -21916.419 -14721.551  32.8%  2481 1442s
  4323  2899 -20057.009   15  691 -21916.419 -14721.551  32.8%  2481 1445s
  4326  2901 -20419.176   31  700 -21916.419 -14721.551  32.8%  2479 1456s
  4327  2902 -15582.563   14  699 -21916.419 -14721.551  32.8%  2478 1469s
  4328  2902 -18794.177   33  705 -21916.419 -14721.551  32.8%  2478 1472s
  4330  2904 -20288.699   59  703 -21916.419 -14721.551  32.8%  2477 1475s
  4331  2904 -20194.762   18  712 -21916.419 -14721.551  32.8%  2476 1482s
  4332  2905 -21417.261   55  702 -21916.419 -14721.551  32.8%  2476 1494s
  4333  2906 -17918.387   17  693 -21916.419 -14721.551  32.8%  2475 1495s
  4334  2906 -18453.731   66  698 -21916.419 -14721.551  32.8%  2474 1503s
  4335  2907 -16421.115   26  689 -21916.419 -14721.551  32.8%  2474 1514s
  4336  2908 -19853.707   21  704 -21916.419 -14721.551  32.8%  2473 1522s
  4337  2908 -16899.338   10  692 -21916.419 -14721.551  32.8%  2473 1534s
  4338  2909 -18784.546   12  691 -21916.419 -14721.551  32.8%  2472 1536s
  4339  2910 -18447.156   14  689 -21916.419 -14721.551  32.8%  2472 1544s
  4340  2910 -15952.630   10  667 -21916.419 -14721.551  32.8%  2471 1556s
  4341  2911 -19318.145   62  682 -21916.419 -14721.551  32.8%  2470 1563s
  4342  2912 -20584.023   71  661 -21916.419 -14721.551  32.8%  2470 1573s
  4344  2913 -20732.757   58  680 -21916.419 -14721.551  32.8%  2469 1581s
  4345  2914 -18452.398   87  684 -21916.419 -14721.551  32.8%  2468 1590s
  4346  2914 -18154.286   78  684 -21916.419 -14721.551  32.8%  2468 1630s
  4347  2915 -21405.967   46  684 -21916.419 -14721.551  32.8%  2467 1648s
  4348  2919 -14721.551   11  668 -21916.419 -14721.551  32.8%  2516 1665s
  4350  2922 -14721.551   12  668 -21916.419 -14721.551  32.8%  2517 1678s
  4354  2929 -14721.551   13  666 -21916.419 -14721.551  32.8%  2520 1709s
  4362  2942 -14721.551   14  645 -21916.419 -14721.551  32.8%  2524 1727s
  4378  2952 -21572.204   15  225 -21916.419 -14721.551  32.8%  2536 1750s
  4395  2965 -15617.590   16  362 -21916.419 -14721.551  32.8%  2568 1773s
  4427  3020 -15731.609   17  428 -21916.419 -14721.551  32.8%  2570 1795s
  4512  3059 -15753.581   20  431 -21916.419 -14721.551  32.8%  2581 1817s
  4597  3050 -16017.350   22  403 -21916.419 -14721.551  32.8%  2573 1830s
  4637  3061 -16159.490   23  378 -21916.419 -14721.551  32.8%  2573 1844s
  4704  3065 -16338.687   24  354 -21916.419 -14721.551  32.8%  2562 1858s
  4767  3075 -17495.897   26  414 -21916.419 -14721.551  32.8%  2550 1872s
  4831  3069 infeasible   25      -21916.419 -14721.551  32.8%  2541 1885s
  4870  3067 -17540.803   28  254 -21916.419 -14721.551  32.8%  2534 1900s
  4915  3075 -17562.554   29  282 -21916.419 -14721.551  32.8%  2529 1921s
  4961  3092 -17730.258   30  339 -21916.419 -14721.551  32.8%  2522 1935s
  5012  3116 infeasible   29      -21916.419 -14721.551  32.8%  2517 1948s
  5068  3133 -17791.574   32  410 -21916.419 -14721.551  32.8%  2527 1968s
  5127  3142 -17794.861   33  294 -21916.419 -14721.551  32.8%  2514 1995s
  5193  3148 -17806.909   34  296 -21916.419 -14721.551  32.8%  2503 2010s
  5260  3168 -17893.450   36  186 -21916.419 -14721.551  32.8%  2490 2026s
  5319  3181 -17939.997   38  137 -21916.419 -14721.551  32.8%  2483 2040s
  5383  3196 -17951.070   39  352 -21916.419 -14721.551  32.8%  2471 2056s
  5436  3248 -17970.758   40  327 -21916.419 -14721.551  32.8%  2458 2072s
  5529  3279 -18081.423   44  387 -21916.419 -14721.551  32.8%  2436 2090s
  5619  3324 -18339.745   47  252 -21916.419 -14721.551  32.8%  2416 2106s
  5730  3381 -18288.021   50  337 -21916.419 -14721.551  32.8%  2392 2143s
  5854  3461 -18299.716   56  232 -21916.419 -14721.551  32.8%  2363 2163s
  5997  3550 -18409.654   62  265 -21916.419 -14721.551  32.8%  2330 2181s
  6163  3627 -18495.252   69  165 -21916.419 -15330.420  30.1%  2290 2197s
  6350  3705 -18681.525   79  221 -21916.419 -15330.420  30.1%  2245 2213s
  6555  3753 -19133.226   91  111 -21916.419 -15330.420  30.1%  2194 2228s
  6788  3762 -19774.299  105   81 -21916.419 -15419.277  29.6%  2137 2247s
  6998  3796 -16879.777   19  593 -21916.419 -15691.912  28.4%  2097 2267s
  7199  3815 -17335.557   22  593 -21916.419 -15937.531  27.3%  2063 2286s
  7374  3868 -17580.431   24  536 -21916.419 -16013.289  26.9%  2041 2307s
  7576  3821 -17934.036   26  425 -21916.419 -16013.289  26.9%  2012 2336s
  7613  3819 -18077.240   27  412 -21916.419 -16013.289  26.9%  2013 2379s
  7663  3817 -18287.394   28  484 -21916.419 -16013.289  26.9%  2013 2412s
  7709  3823 -18305.602   29  411 -21916.419 -16013.289  26.9%  2010 2450s
  7763  3834 -18346.039   30  341 -21916.419 -16090.912  26.6%  2009 2470s
  7805  3848 -18362.070   31  345 -21916.419 -16090.912  26.6%  2010 2489s
  7857  3867 -19223.541   32  475 -21916.419 -16090.912  26.6%  2009 2511s
  7918  3880 -19254.898   33  140 -21916.419 -16090.912  26.6%  2003 2535s
  7991  3887 -19950.841   34  138 -21916.419 -16090.912  26.6%  1998 2561s
  8065  3919 -19975.627   35  153 -21916.419 -16090.912  26.6%  1993 2579s
  8158  3922 -20079.246   36  152 -21916.419 -16111.579  26.5%  1980 2605s
  8266  3933 -20235.794   37  149 -21916.419 -16238.914  25.9%  1972 2638s
  8365  3958 -21015.693   43  287 -21916.419 -16265.249  25.8%  1970 2669s
  8516  3970 -21100.662   23  241 -21916.419 -16284.257  25.7%  1960 2701s
  8737  4032     cutoff   58      -21916.419 -16349.401  25.4%  1931 2730s
H 8813  3853                    -21818.80034 -16366.314  25.0%  1928 2730s
H 9005  3186                    -20118.39607 -16366.314  18.7%  1900 2761s
H 9063  2938                    -19926.31132 -16366.314  17.9%  1895 2761s
  9337  2787     cutoff   25      -19926.311 -16366.314  17.9%  1864 2794s
H 9448  2601                    -19890.36029 -16426.416  17.4%  1859 2794s
H 9522  2444                    -19865.67838 -16459.637  17.1%  1853 2794s
  9702  2517     cutoff   29      -19865.678 -16515.002  16.9%  1837 2825s
H 9842  2336                    -19829.72734 -16515.002  16.7%  1829 2825s
 10111  2468 infeasible   46      -19829.727 -16515.002  16.7%  1804 2858s
H10586  2248                    -19821.96245 -16793.471  15.3%  1754 2858s
 10706  2429 -18603.153   63   80 -19821.962 -16813.153  15.2%  1745 2893s
H10998  2424                    -19815.48850 -16813.153  15.2%  1713 2893s
 11404  2481 infeasible   48      -19815.488 -16859.461  14.9%  1679 2931s
 12225  2488     cutoff   68      -19815.488 -17137.485  13.5%  1606 2965s
 12936  2288 -19292.435   19  375 -19815.488 -17179.666  13.3%  1556 2999s
 13769  2192 -19556.711   72   98 -19815.488 -17335.526  12.5%  1499 3031s
 14156  2043     cutoff   22      -19815.488 -17335.526  12.5%  1482 3069s
 14661  1930     cutoff   28      -19815.488 -17659.890  10.9%  1457 3107s
 15202  1912     cutoff   22      -19815.488 -17783.556  10.3%  1425 3144s
 16023  1736     cutoff   37      -19815.488 -17835.070  10.0%  1387 3187s
 17070  1245 -19744.703   44  115 -19815.488 -18058.985  8.86%  1340 3230s
 18264   621 -19634.174   25  419 -19815.488 -18242.964  7.94%  1286 3266s
 19709    31 -19426.935   33  138 -19815.488 -18747.750  5.39%  1223 3289s
 20262    31 -19086.976   33  306 -19815.488 -18833.796  4.95%  1195 3290s

Cutting planes:
  Gomory: 2
  MIR: 985
  Mixing: 1
  Flow cover: 2685
  Zero half: 1
  RLT: 14
  Relax-and-lift: 152

Explored 20942 nodes (24695255 simplex iterations) in 3291.68 seconds (5639.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19815.5 -19822 -19829.7 ... -21920.2
No other solutions better than -19815.5

Optimal solution found (tolerance 1.00e-06)
Best objective -1.981548849611e+04, best bound -1.981548849611e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3291.72s
  Master Objective (UB) = -19815.49, θ = 93322.41
  Upper Bound (UB) = -19815.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93322.41
  [DEBUG]   ✓ Scenario 0: θ = 93322.41 ≤ Q = 93322.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93322.41 ≤ Q = 93322.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93322.41 ≤ Q = 93322.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93322.41 ≤ Q = 93322.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93322.41 ≤ Q = 93322.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93322.41 ≤ Q = 93322.41 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93322.41 ≤ Q = 93322.41 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93322.41 ≤ Q = 93322.41 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x61c4fb8e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9e3b0472
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.427669e+13
Presolve removed 2608 rows and 1904 columns
Presolve time: 0.01s
Presolved: 485 rows, 485 columns, 1366 nonzeros
Found heuristic solution: objective 7750891.5318
Variable types: 325 continuous, 160 integer (160 binary)

Root relaxation: objective -1.083012e+05, 276 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108301.24    0  122 7750891.53 -108301.24   101%     -    0s
H    0     0                    -74206.19887 -108301.24  45.9%     -    0s
H    0     0                    -75161.11553 -108301.24  44.1%     -    0s
     0     0 -84452.297    0   68 -75161.116 -84452.297  12.4%     -    0s
H    0     0                    -81050.81435 -84445.675  4.19%     -    0s
     0     0 -84158.387    0   68 -81050.814 -84158.387  3.83%     -    0s
     0     0 -84123.429    0   68 -81050.814 -84123.429  3.79%     -    0s
H    0     0                    -81538.09923 -84123.429  3.17%     -    0s
H    0     0                    -81555.87981 -84123.429  3.15%     -    0s
     0     0 -84069.702    0   70 -81555.880 -84069.702  3.08%     -    0s
     0     0 -83995.310    0   70 -81555.880 -83995.310  2.99%     -    0s
     0     2 -83995.310    0   70 -81555.880 -83995.310  2.99%     -    0s
H 1599  1259                    -81628.57416 -83174.777  1.89%   4.0    0s
* 5878  2694              11    -81632.87356 -81632.874  0.00%   3.9    0s

Cutting planes:
  Gomory: 24
  Implied bound: 1
  Projected implied bound: 24
  MIR: 53
  Flow cover: 66
  RLT: 44

Explored 5878 nodes (24374 simplex iterations) in 0.97 seconds (0.25 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -81632.9 -81555.9 -81050.8 ... 1.42767e+13
No other solutions better than -81632.9

Optimal solution found (tolerance 1.00e-06)
Best objective -8.163287356267e+04, best bound -8.163287356267e+04, gap 0.0000%
  Subproblem solved in 1.00s
  Worst-case operational profit (Z_SP) = 90924.89
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81632.87
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -81632.87 = 90924.89
  [DEBUG]   Current θ from Master = 93322.41
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2397.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22213.01
  Lower Bound (LB) = -22213.01
  Gap (UB-LB) = 2397.5186, Absolute Gap = 2397.5186, Relative Gap = 0.120992
  Not converged yet (gap = 2397.52 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0xfb246c6d
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 2.96s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431970.6122
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   15141   -2.2912744e+05   0.000000e+00   1.003255e+07      5s
   29359   -7.4229112e+04   0.000000e+00   2.064573e+07     10s
   37666   -3.8836298e+04   0.000000e+00   5.957749e+07     15s
   43847   -1.2533222e+04   0.000000e+00   1.813077e+07     20s
   47959   -1.0915670e+04   0.000000e+00   1.017182e+07     25s
   51811   -9.9276526e+03   0.000000e+00   4.340914e+07     30s
   55121   -9.2034045e+03   0.000000e+00   2.083348e+06     35s
   58776   -7.9688880e+03   0.000000e+00   5.772345e+06     40s
   62122   -7.7521236e+03   0.000000e+00   3.194404e+06     45s
   65576   -7.4138487e+03   0.000000e+00   4.600947e+06     50s
   69132   -7.0970247e+03   0.000000e+00   1.823073e+06     55s
   72115   -7.0725564e+03   0.000000e+00   3.067739e+06     60s
   75255   -7.0450755e+03   0.000000e+00   1.738540e+06     65s
   78932   -6.5027868e+03   0.000000e+00   7.724770e+05     70s
   81915   -6.4280778e+03   0.000000e+00   2.344819e+06     75s
Concurrent spin time: 5.59s

Solved with dual simplex

Root relaxation: objective -4.750153e+03, 98581 iterations, 77.83 seconds (93.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -4750.1532    0  393 -180243.66 -4750.1532  97.4%     -   82s
H    0     0                    -171572.4421 -4750.1532  97.2%     -   82s
H    0     0                    -110227.3608 -4750.1532  95.7%     -   82s
H    0     0                    -76891.23065 -4750.1532  93.8%     -   82s
H    0     0                    -76019.32302 -4750.1532  93.8%     -   82s
H    0     0                    -41503.40558 -4750.1532  88.6%     -   82s
H    0     0                    -35923.85835 -4750.1532  86.8%     -   82s
H    0     0                    -35787.33679 -4750.1532  86.7%     -   82s
H    0     0                    -28910.51263 -4750.1532  83.6%     -   84s
H    0     0                    -28754.06082 -4750.1532  83.5%     -   84s
H    0     0                    -28709.02225 -4750.1532  83.5%     -   84s
H    0     0                    -28674.05058 -8190.1060  71.4%     -  110s
     0     0 -8448.2526    0  439 -28674.051 -8448.2526  70.5%     -  110s
     0     0 -8448.2526    0  443 -28674.051 -8448.2526  70.5%     -  116s
     0     0 -8448.2526    0  440 -28674.051 -8448.2526  70.5%     -  116s
     0     0 -8448.2526    0  440 -28674.051 -8448.2526  70.5%     -  117s
     0     0 -9669.5481    0  543 -28674.051 -9669.5481  66.3%     -  134s
H    0     0                    -26320.57060 -9669.5481  63.3%     -  135s
H    0     0                    -25106.84587 -9669.5481  61.5%     -  135s
     0     0 -9861.7234    0  550 -25106.846 -9861.7234  60.7%     -  141s
     0     0 -9924.0716    0  550 -25106.846 -9924.0716  60.5%     -  144s
     0     0 -10158.712    0  500 -25106.846 -10158.712  59.5%     -  151s
     0     0 -10250.152    0  561 -25106.846 -10250.152  59.2%     -  154s
     0     0 -10286.577    0  559 -25106.846 -10286.577  59.0%     -  156s
     0     0 -10302.072    0  559 -25106.846 -10302.072  59.0%     -  157s
     0     0 -10306.190    0  542 -25106.846 -10306.190  59.0%     -  158s
     0     0 -10315.264    0  547 -25106.846 -10315.264  58.9%     -  160s
     0     0 -10315.621    0  550 -25106.846 -10315.621  58.9%     -  160s
     0     0 -11342.003    0  592 -25106.846 -11342.003  54.8%     -  180s
H    0     0                    -25102.91628 -11342.501  54.8%     -  181s
     0     0 -11593.239    0  594 -25102.916 -11593.239  53.8%     -  189s
     0     0 -11678.250    0  543 -25102.916 -11678.250  53.5%     -  194s
     0     0 -11764.157    0  431 -25102.916 -11764.157  53.1%     -  198s
     0     0 -12034.341    0  521 -25102.916 -12034.341  52.1%     -  204s
H    0     0                    -25088.66582 -12066.770  51.9%     -  207s
H    0     0                    -25074.51320 -12066.770  51.9%     -  207s
H    0     0                    -25028.30852 -12066.770  51.8%     -  207s
H    0     0                    -25020.26395 -12066.770  51.8%     -  207s
     0     0 -12066.770    0  528 -25020.264 -12066.770  51.8%     -  207s
     0     0 -12092.298    0  430 -25020.264 -12092.298  51.7%     -  210s
     0     0 -12097.718    0  434 -25020.264 -12097.718  51.6%     -  210s
     0     0 -12100.803    0  592 -25020.264 -12100.803  51.6%     -  212s
     0     0 -12107.197    0  380 -25020.264 -12107.197  51.6%     -  212s
     0     0 -12108.208    0  386 -25020.264 -12108.208  51.6%     -  213s
     0     0 -12116.300    0  385 -25020.264 -12116.300  51.6%     -  214s
     0     0 -12116.417    0  388 -25020.264 -12116.417  51.6%     -  214s
     0     0 -12504.261    0  612 -25020.264 -12504.261  50.0%     -  230s
     0     0 -12645.335    0  624 -25020.264 -12645.335  49.5%     -  236s
     0     0 -12714.560    0  615 -25020.264 -12714.560  49.2%     -  240s
     0     0 -12731.355    0  618 -25020.264 -12731.355  49.1%     -  243s
     0     0 -12739.732    0  619 -25020.264 -12739.732  49.1%     -  244s
     0     0 -12743.105    0  612 -25020.264 -12743.105  49.1%     -  245s
     0     0 -12744.348    0  615 -25020.264 -12744.348  49.1%     -  246s
     0     0 -12745.840    0  618 -25020.264 -12745.840  49.1%     -  246s
     0     0 -12756.545    0  612 -25020.264 -12756.545  49.0%     -  247s
     0     0 -12759.134    0  610 -25020.264 -12759.134  49.0%     -  248s
     0     0 -12760.886    0  619 -25020.264 -12760.886  49.0%     -  249s
     0     0 -12761.651    0  613 -25020.264 -12761.651  49.0%     -  249s
     0     0 -12835.330    0  624 -25020.264 -12835.330  48.7%     -  258s
     0     0 -12870.033    0  630 -25020.264 -12870.033  48.6%     -  263s
     0     0 -12881.090    0  638 -25020.264 -12881.090  48.5%     -  266s
     0     0 -12887.216    0  637 -25020.264 -12887.216  48.5%     -  267s
     0     0 -12889.452    0  652 -25020.264 -12889.452  48.5%     -  268s
     0     0 -12889.623    0  646 -25020.264 -12889.623  48.5%     -  269s
     0     0 -12964.121    0  576 -25020.264 -12964.121  48.2%     -  276s
H    0     0                    -25016.98767 -12964.291  48.2%     -  280s
H    0     0                    -25014.22507 -12964.291  48.2%     -  280s
H    0     0                    -23381.35810 -12964.291  44.6%     -  280s
     0     0 -12976.858    0  638 -23381.358 -12976.858  44.5%     -  282s
     0     0 -12982.924    0  655 -23381.358 -12982.924  44.5%     -  284s
     0     0 -12984.192    0  574 -23381.358 -12984.192  44.5%     -  287s
     0     0 -12984.527    0  644 -23381.358 -12984.527  44.5%     -  288s
     0     0 -13072.041    0  580 -23381.358 -13072.041  44.1%     -  297s
     0     0 -13119.843    0  581 -23381.358 -13119.843  43.9%     -  302s
     0     0 -13138.006    0  653 -23381.358 -13138.006  43.8%     -  305s
     0     0 -13143.682    0  655 -23381.358 -13143.682  43.8%     -  306s
     0     0 -13145.507    0  657 -23381.358 -13145.507  43.8%     -  307s
     0     0 -13147.139    0  645 -23381.358 -13147.139  43.8%     -  308s
     0     0 -13147.530    0  651 -23381.358 -13147.530  43.8%     -  308s
     0     0 -13167.625    0  672 -23381.358 -13167.625  43.7%     -  312s
H    0     0                    -22800.09161 -13168.549  42.2%     -  313s
     0     0 -13181.546    0  667 -22800.092 -13181.546  42.2%     -  316s
     0     0 -13182.771    0  660 -22800.092 -13182.771  42.2%     -  317s
     0     0 -13183.640    0  599 -22800.092 -13183.640  42.2%     -  318s
     0     0 -13196.055    0  604 -22800.092 -13196.055  42.1%     -  322s
     0     0 -13220.505    0  666 -22800.092 -13220.505  42.0%     -  326s
     0     0 -13227.612    0  667 -22800.092 -13227.612  42.0%     -  327s
     0     0 -13229.428    0  667 -22800.092 -13229.428  42.0%     -  329s
     0     0 -13230.098    0  667 -22800.092 -13230.098  42.0%     -  329s
     0     0 -13373.644    0  659 -22800.092 -13373.644  41.3%     -  337s
H    0     0                    -22542.76094 -13373.722  40.7%     -  341s
H    0     0                    -22462.72607 -13373.722  40.5%     -  342s
H    0     0                    -22363.43811 -13373.722  40.2%     -  342s
H    0     0                    -22158.96594 -13373.722  39.6%     -  342s
H    0     0                    -22066.26694 -13373.722  39.4%     -  342s
     0     0 -13381.478    0  656 -22066.267 -13381.478  39.4%     -  344s
     0     0 -13387.868    0  665 -22066.267 -13387.868  39.3%     -  345s
     0     0 -13391.782    0  662 -22066.267 -13391.782  39.3%     -  346s
     0     0 -13395.009    0  673 -22066.267 -13395.009  39.3%     -  347s
     0     0 -13395.633    0  673 -22066.267 -13395.633  39.3%     -  348s
     0     0 -13403.259    0  689 -22066.267 -13403.259  39.3%     -  352s
     0     0 -13406.978    0  687 -22066.267 -13406.978  39.2%     -  353s
     0     0 -13411.858    0  696 -22066.267 -13411.858  39.2%     -  355s
     0     0 -13412.517    0  704 -22066.267 -13412.517  39.2%     -  355s
     0     0 -13412.517    0  704 -22066.267 -13412.517  39.2%     -  356s
     0     0 -13433.070    0  680 -22066.267 -13433.070  39.1%     -  360s
     0     0 -13435.790    0  684 -22066.267 -13435.790  39.1%     -  366s
     0     0 -13436.252    0  756 -22066.267 -13436.252  39.1%     -  367s
     0     0 -13456.363    0  818 -22066.267 -13456.363  39.0%     -  373s
     0     0 -13458.963    0  834 -22066.267 -13458.963  39.0%     -  375s
     0     0 -13459.164    0  837 -22066.267 -13459.164  39.0%     -  375s
     0     0 -13550.851    0  758 -22066.267 -13550.851  38.6%     -  380s
H    0     0                    -21967.34572 -13550.943  38.3%     -  416s
H    0     0                    -21944.71338 -13550.943  38.2%     -  417s
     0     0 -13563.454    0  633 -21944.713 -13563.454  38.2%     -  420s
     0     0 -13564.524    0  645 -21944.713 -13564.524  38.2%     -  420s
     0     0 -13576.887    0  650 -21944.713 -13576.887  38.1%     -  424s
     0     0 -13577.885    0  654 -21944.713 -13577.885  38.1%     -  425s
     0     0 -13584.555    0  720 -21944.713 -13584.555  38.1%     -  428s
     0     0 -13588.325    0  723 -21944.713 -13588.325  38.1%     -  430s
     0     0 -13589.101    0  720 -21944.713 -13589.101  38.1%     -  430s
     0     0 -13594.066    0  649 -21944.713 -13594.066  38.1%     -  433s
     0     0 -13598.748    0  725 -21944.713 -13598.748  38.0%     -  435s
     0     0 -13600.299    0  718 -21944.713 -13600.299  38.0%     -  436s
     0     0 -13600.605    0  653 -21944.713 -13600.605  38.0%     -  436s
     0     0 -13606.279    0  713 -21944.713 -13606.279  38.0%     -  440s
     0     0 -13609.317    0  778 -21944.713 -13609.317  38.0%     -  442s
     0     0 -13609.900    0  710 -21944.713 -13609.900  38.0%     -  442s
     0     0 -13624.043    0  714 -21944.713 -13624.043  37.9%     -  448s
     0     0 -13626.593    0  718 -21944.713 -13626.593  37.9%     -  450s
     0     0 -13628.945    0  852 -21944.713 -13628.945  37.9%     -  452s
     0     0 -13629.305    0  853 -21944.713 -13629.305  37.9%     -  452s
     0     0 -13631.788    0  780 -21944.713 -13631.788  37.9%     -  455s
     0     0 -13633.944    0  712 -21944.713 -13633.944  37.9%     -  457s
     0     0 -13634.673    0  714 -21944.713 -13634.673  37.9%     -  457s
     0     0 -13638.397    0  716 -21944.713 -13638.397  37.9%     -  460s
     0     0 -13638.713    0  716 -21944.713 -13638.713  37.8%     -  465s
     0     2 -13639.404    0  716 -21944.713 -13639.404  37.8%     -  495s
     1     4 -13747.463    1  694 -21944.713 -13639.404  37.8%  4370  500s
     3     8 -13997.048    2  668 -21944.713 -13748.112  37.4%  4492  510s
     7    15 -14299.314    3  741 -21944.713 -13845.086  36.9%  4898  529s
    14    28 -14332.377    4  728 -21944.713 -13845.086  36.9%  5353  543s
    29    29 -15177.664    5  640 -21944.713 -14087.637  35.8%  7627  566s
    42    44 -14872.855    5  687 -21944.713 -14087.637  35.8%  7203  593s
H   48    44                    -21920.19852 -14087.637  35.7%  6620  593s
    61    70 -14905.990    6  550 -21920.199 -14087.637  35.7%  7510  604s
    93   125 -14910.510    7  555 -21920.199 -14087.637  35.7%  6726  630s
H  106   125                    -21916.41897 -14087.637  35.7%  6231  630s
H  129   125                    -21385.21776 -14087.637  34.1%  5531  630s
H  148   125                    -21218.48072 -14087.637  33.6%  5418  630s
   152   210 -14967.731    9  453 -21218.481 -14087.637  33.6%  5428  647s
H  257   281                    -21124.45771 -14087.637  33.3%  4718  662s
H  307   281                    -20726.65982 -14087.637  32.0%  4224  662s
H  309   281                    -20611.12720 -14087.637  31.7%  4226  662s
   338   331 -20196.786   18  236 -20611.127 -14087.637  31.7%  4061  680s
H  411   391                    -20552.26471 -14087.637  31.5%  3711  693s
H  492   391                    -20542.65307 -14087.637  31.4%  3348  693s
   501   441 -15371.916   16  519 -20542.653 -14087.637  31.4%  3307  708s
   595   503 -15533.737   18  557 -20542.653 -14087.637  31.4%  2969  721s
H  631   503                    -20488.40175 -14087.637  31.2%  2861  721s
H  677   525                    -20311.83613 -14087.637  30.6%  2728  734s
H  684   525                    -20167.22691 -14087.637  30.1%  2709  734s
H  711   599                    -20166.76473 -14087.637  30.1%  2663  747s
H  717   599                    -20140.53048 -14160.862  29.7%  2667  747s
H  811   599                    -20121.68735 -14160.862  29.6%  2451  747s
   817   683 -16058.579   22  449 -20121.687 -14160.862  29.6%  2440  758s
   930   785 -16203.157   24  440 -20121.687 -14160.933  29.6%  2273  770s
  1052   878 -16559.872   26  427 -20121.687 -14160.933  29.6%  2111  781s
H 1093   878                    -20078.18879 -14160.933  29.5%  2065  781s
H 1126   878                    -20031.53628 -14160.933  29.3%  2024  781s
H 1155   878                    -20005.30203 -14160.933  29.2%  1993  781s
  1163   909 -16642.307   27  358 -20005.302 -14160.933  29.2%  1982  794s
  1196   951 -17264.308   28  360 -20005.302 -14160.933  29.2%  1961  815s
  1240  1031 -15072.326   11  523 -20005.302 -14160.933  29.2%  1924  828s
  1337  1120 -17425.345   29  404 -20005.302 -14299.887  28.5%  1826  839s
H 1401  1120                    -19852.88316 -14299.887  28.0%  1771  839s
  1451  1297 -17678.570   30  446 -19852.883 -14299.887  28.0%  1729  852s
  1667  1442 -18296.689   32  307 -19852.883 -14299.887  28.0%  1584  865s
  1885  1564 -19057.003   38  285 -19852.883 -14299.887  28.0%  1474  880s
  2081  1580 infeasible   22      -19852.883 -14400.510  27.5%  1393  894s
  2127  1613 -17649.420    8  305 -19852.883 -14400.510  27.5%  1386  906s
H 2148  1613                    -19837.92775 -14400.510  27.4%  1381  906s
  2174  1748 -18130.356   10  225 -19837.928 -14400.510  27.4%  1377  926s
  2391  1871 -18198.890   16  258 -19837.928 -14400.510  27.4%  1309  948s
  2573  2013 -18226.995   19  170 -19837.928 -14400.510  27.4%  1275  965s
  2791  2197 -18287.169   24  365 -19837.928 -14400.510  27.4%  1225  981s
  3060  2390 -18429.456   37  150 -19837.928 -14400.510  27.4%  1169  997s
  3342  2513 -18553.631   42  150 -19837.928 -14400.510  27.4%  1116 1013s
  3504  2686 -18594.370   46  143 -19837.928 -14400.510  27.4%  1089 1030s
  3760  2687 -16557.930   38  716 -19837.928 -14510.937  26.9%  1049 1161s
  3762  2688 -17854.167   56  393 -19837.928 -14510.937  26.9%  1049 1226s
  3763  2689 -17814.783   72  580 -19837.928 -14510.937  26.9%  1049 1270s
  3764  2690 -19187.992   49  626 -19837.928 -14510.937  26.9%  1048 1323s
  3765  2690 -16981.934   39  689 -19837.928 -14510.937  26.9%  1048 1338s
  3766  2691 -17729.582   49  699 -19837.928 -14510.937  26.9%  1048 1345s
  3767  2692 -16982.377   14  712 -19837.928 -14510.937  26.9%  1047 1359s
  3768  2692 -17353.488   47  718 -19837.928 -14510.937  26.9%  1047 1372s
  3769  2693 -15858.067   18  677 -19837.928 -14510.937  26.9%  1047 1376s
  3770  2694 -16241.546   20  742 -19837.928 -14510.937  26.9%  1047 1380s
  3772  2695 -17948.384   35  758 -19837.928 -14510.937  26.9%  1046 1390s
  3774  2696 -19457.242   74  829 -19837.928 -14510.937  26.9%  1046 1397s
  3775  2697 -16657.680   29  693 -19837.928 -14510.937  26.9%  1045 1400s
  3776  2698 -19429.353   54  630 -19837.928 -14510.937  26.9%  1045 1405s
  3779  2700 -16270.061   25  779 -19837.928 -14510.937  26.9%  1044 1418s
  3780  2700 -16467.178   23  754 -19837.928 -14510.937  26.9%  1044 1443s
  3781  2701 -19141.453   49  715 -19837.928 -14510.937  26.9%  1044 1448s
  3782  2702 -18694.949   65  687 -19837.928 -14510.937  26.9%  1043 1450s
  3784  2703 -17012.680   18  845 -19837.928 -14510.937  26.9%  1043 1461s
  3785  2704 -18315.538   70  766 -19837.928 -14510.937  26.9%  1042 1487s
  3786  2704 -18845.272   63  743 -19837.928 -14510.937  26.9%  1042 1494s
  3787  2705 -19787.824  119  689 -19837.928 -14510.937  26.9%  1042 1501s
  3789  2706 -17602.534   51  690 -19837.928 -14510.937  26.9%  1041 1513s
  3790  2707 -18839.295   62  679 -19837.928 -14510.937  26.9%  1041 1528s
  3791  2708 -17548.920   18  607 -19837.928 -14510.937  26.9%  1041 1530s
  3793  2709 -18044.579   67  628 -19837.928 -14510.937  26.9%  1040 1540s
  3794  2710 -18017.249   26  687 -19837.928 -14510.937  26.9%  1040 1561s
  3796  2711 -17620.988   39  676 -19837.928 -14510.937  26.9%  1039 1566s
  3798  2712 -19436.486   41  730 -19837.928 -14510.937  26.9%  1039 1580s
  3799  2713 -16054.741   29  662 -19837.928 -14510.937  26.9%  1039 1602s
  3800  2714 -18641.864   64  676 -19837.928 -14510.937  26.9%  1038 1609s
  3801  2714 -18943.676   38  677 -19837.928 -14510.937  26.9%  1038 1614s
  3802  2715 -16139.041   18  667 -19837.928 -14510.937  26.9%  1038 1617s
  3803  2716 -19141.296   66  665 -19837.928 -14510.937  26.9%  1038 1626s
  3804  2716 -15602.881   19  666 -19837.928 -14510.937  26.9%  1037 1648s
  3805  2717 -17916.201   30  595 -19837.928 -14510.937  26.9%  1037 1655s
  3806  2718 -18360.007   59  664 -19837.928 -14510.937  26.9%  1037 1673s
  3807  2718 -19610.556   49  508 -19837.928 -14510.937  26.9%  1036 1678s
  3808  2719 -18015.281   80  528 -19837.928 -14510.937  26.9%  1036 1690s
  3809  2720 -15227.815   19  665 -19837.928 -14510.937  26.9%  1036 1697s
  3810  2720 -18205.756   39  595 -19837.928 -14510.937  26.9%  1036 1718s
  3811  2721 -17005.448   12  658 -19837.928 -14510.937  26.9%  1035 1721s
  3812  2722 -17673.157   58  666 -19837.928 -14510.937  26.9%  1035 1730s
  3813  2722 -18272.364   15  650 -19837.928 -14510.937  26.9%  1035 1742s
  3814  2723 -15844.548   16  654 -19837.928 -14510.937  26.9%  1035 1750s
  3815  2724 -19335.621   75  671 -19837.928 -14510.937  26.9%  1034 1763s
  3816  2724 -19670.260   81  670 -19837.928 -14510.937  26.9%  1034 1770s
  3817  2725 -18772.574   53  659 -19837.928 -14510.937  26.9%  1034 1779s
  3818  2726 -15446.369   13  659 -19837.928 -14510.937  26.9%  1033 1841s
  3819  2726 -16584.602   14  659 -19837.928 -14510.937  26.9%  1033 1861s
  3820  2730 -14510.937   12  653 -19837.928 -14510.937  26.9%  1122 1891s
  3822  2733 -14510.937   13  655 -19837.928 -14510.937  26.9%  1124 1912s
  3826  2740 -14510.937   14  639 -19837.928 -14510.937  26.9%  1130 1928s
  3834  2753 -14510.937   15  541 -19837.928 -14510.937  26.9%  1141 1965s
  3850  2764 -14942.249   16  624 -19837.928 -14510.937  26.9%  1182 2027s
  3866  2771 -18124.543   17  277 -19837.928 -14510.937  26.9%  1202 2064s
  3895  2824 -18240.768   18  294 -19837.928 -14510.937  26.9%  1239 2108s
  3979  2839 infeasible   19      -19837.928 -14510.937  26.9%  1329 2135s
  4047  2838 -18199.352   24  291 -19837.928 -14510.937  26.9%  1345 2158s
  4095  2856 -19727.671   25  213 -19837.928 -14510.937  26.9%  1357 2184s
  4160  2858 -19742.428   26  219 -19837.928 -14510.937  26.9%  1374 2214s
  4227  2863 -18888.695   29  405 -19837.928 -14510.937  26.9%  1397 2237s
  4295  2881 -18954.536   32  254 -19837.928 -14510.937  26.9%  1414 2265s
  4366  2891 -19052.396   37  169 -19837.928 -14510.937  26.9%  1418 2294s
  4456  2911 -19141.568   42  266 -19837.928 -14510.937  26.9%  1421 2336s
  4550  2917 -19464.979   47  159 -19837.928 -14510.937  26.9%  1419 2355s
  4633  2930 -19667.085   52  251 -19837.928 -14510.937  26.9%  1417 2378s
  4737  2919 infeasible   39      -19837.928 -14510.937  26.9%  1410 2406s
  4838  2918 -16321.637   20  312 -19837.928 -14510.937  26.9%  1405 2425s
  4937  2907 -16371.075   22  298 -19837.928 -14510.937  26.9%  1403 2449s
  5047  2898 infeasible   24      -19837.928 -14510.937  26.9%  1395 2474s
  5158  2894 -17105.496   23  383 -19837.928 -14510.937  26.9%  1389 2496s
  5256  2895 infeasible   25      -19837.928 -14510.937  26.9%  1388 2521s
  5380  2878 -17311.707   27  510 -19837.928 -14510.937  26.9%  1385 2552s
  5521  2864 -17391.158   32  386 -19837.928 -14510.937  26.9%  1381 2580s
  5654  2888 -17408.715   35  419 -19837.928 -14510.937  26.9%  1380 2604s
  5798  2913 -17615.788   42  155 -19837.928 -14510.937  26.9%  1376 2629s
  5971  2921 -17716.817   48  271 -19837.928 -14510.937  26.9%  1366 2655s
  6142  2953 -17817.472   56  242 -19837.928 -14510.937  26.9%  1351 2683s
  6366  2897 -19075.321   67  106 -19837.928 -14510.937  26.9%  1329 2702s
  6405  2903     cutoff   68      -19837.928 -14510.937  26.9%  1333 2724s
  6461  2914 -19206.791   69  225 -19837.928 -14510.937  26.9%  1336 2744s
  6583  2962 -19209.469   70  228 -19837.928 -14510.937  26.9%  1335 2767s
  6837  3000 -19238.156   74  107 -19837.928 -14510.937  26.9%  1305 2792s
  7146  2947 -19424.179   88  101 -19837.928 -14510.937  26.9%  1276 2818s
  7308  2940 -19558.284   96  140 -19837.928 -14510.937  26.9%  1273 2847s
  7468  2966 -19819.813  112  130 -19837.928 -14685.580  26.0%  1274 2876s
  7731  2997 infeasible   67      -19837.928 -15787.161  20.4%  1270 2907s
  7962  2964 -19580.444   25  224 -19837.928 -15787.315  20.4%  1269 2946s
  8187  2929 infeasible   33      -19837.928 -15787.315  20.4%  1275 2980s
  8430  2873 infeasible   23      -19837.928 -15787.315  20.4%  1284 3015s
  8657  2872 infeasible   37      -19837.928 -15876.382  20.0%  1285 3050s
  8883  2828 -17239.162   19  602 -19837.928 -16361.984  17.5%  1293 3086s
  9094  2820 -17646.089   21  525 -19837.928 -16361.984  17.5%  1310 3124s
  9380  2738 -19796.186   33  281 -19837.928 -16584.126  16.4%  1315 3166s
  9647  2620 -18910.421   24  402 -19837.928 -16905.969  14.8%  1321 3208s
  9865  2478 -19427.544   25  476 -19837.928 -17065.492  14.0%  1337 3255s
 10215  2281 infeasible   27      -19837.928 -17185.765  13.4%  1344 3299s
 10571  2010 infeasible   39      -19837.928 -17239.073  13.1%  1356 3346s
 10996  1678 infeasible   24      -19837.928 -17490.826  11.8%  1356 3394s
 11499  1317 -19689.642   31  408 -19837.928 -17563.240  11.5%  1353 3442s
 12085   931 infeasible   47      -19837.928 -17677.614  10.9%  1336 3492s
 12633   646 -18026.609   33  292 -19837.928 -17958.709  9.47%  1332 3543s
 13286   301 infeasible   27      -19837.928 -18061.786  8.95%  1319 3590s
 14002   191 infeasible   51      -19837.928 -18120.836  8.66%  1302 3600s

Cutting planes:
  Implied bound: 88
  Projected implied bound: 5
  MIR: 1060
  Mixing: 1
  Flow cover: 2859
  RLT: 10
  Relax-and-lift: 121

Explored 14304 nodes (18766439 simplex iterations) in 3600.09 seconds (5789.56 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19837.9 -19852.9 -20005.3 ... -20488.4

Time limit reached
Best objective -1.983792775453e+04, best bound -1.861317093056e+04, gap 6.1738%
  WARNING: Time limit reached. Using best solution found (gap: 6.17%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -19837.93, θ = 93314.28
  Upper Bound (UB) = -19837.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93314.28
  [DEBUG]   ✓ Scenario 0: θ = 93314.28 ≤ Q = 93314.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93314.28 ≤ Q = 93314.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93314.28 ≤ Q = 93314.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93314.28 ≤ Q = 93314.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93314.28 ≤ Q = 93314.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93314.28 ≤ Q = 93314.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93314.28 ≤ Q = 93314.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93314.28 ≤ Q = 93314.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93314.28 ≤ Q = 93314.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5244b3cd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xadbb4c33
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.427669e+13
Presolve removed 2608 rows and 1904 columns
Presolve time: 0.01s
Presolved: 485 rows, 485 columns, 1366 nonzeros
Found heuristic solution: objective 7753155.0728
Variable types: 325 continuous, 160 integer (160 binary)

Root relaxation: objective -1.082912e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108291.23    0  122 7753155.07 -108291.23   101%     -    0s
H    0     0                    -74184.00867 -108291.23  46.0%     -    0s
H    0     0                    -75138.92533 -108291.23  44.1%     -    0s
     0     0 -84370.223    0   66 -75138.925 -84370.223  12.3%     -    0s
H    0     0                    -80969.01568 -84349.092  4.17%     -    0s
     0     0 -84038.129    0   66 -80969.016 -84038.129  3.79%     -    0s
     0     0 -83917.599    0   66 -80969.016 -83917.599  3.64%     -    0s
H    0     0                    -81461.83347 -83917.599  3.01%     -    0s
H    0     0                    -81487.89623 -83917.599  2.98%     -    0s
     0     0 -83917.599    0   68 -81487.896 -83917.599  2.98%     -    0s
     0     0 -83900.322    0   68 -81487.896 -83900.322  2.96%     -    0s
     0     2 -83900.322    0   68 -81487.896 -83900.322  2.96%     -    0s

Cutting planes:
  Gomory: 44
  Implied bound: 1
  Projected implied bound: 19
  MIR: 55
  Flow cover: 61
  RLT: 46
  BQP: 2

Explored 4885 nodes (23888 simplex iterations) in 1.12 seconds (0.27 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -81487.9 -80969 -75138.9 ... 1.42767e+13
No other solutions better than -81487.9

Optimal solution found (tolerance 1.00e-06)
Best objective -8.148789622681e+04, best bound -8.148789622681e+04, gap 0.0000%
  Subproblem solved in 1.16s
  Worst-case operational profit (Z_SP) = 91069.87
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81487.90
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -81487.90 = 91069.87
  [DEBUG]   Current θ from Master = 93314.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2244.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22082.33
  Lower Bound (LB) = -22082.33
  Gap (UB-LB) = 2244.4064, Absolute Gap = 2244.4064, Relative Gap = 0.113137
  Not converged yet (gap = 2244.41 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xb5f9761e
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 2.58s
Presolved: 83583 rows, 35960 columns, 511899 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431970.6122
Found heuristic solution: objective -412812.4620
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.24s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.540e+06
 Factor NZ  : 7.602e+06 (roughly 100 MB of memory)
 Factor Ops : 1.284e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84039913e+07  1.43496067e+08  9.65e+04 1.84e+01  7.89e+04     4s
   1  -1.38186394e+07  1.27489550e+08  6.65e+04 6.97e+01  5.39e+04     4s
   2  -4.42313333e+06  9.75831378e+07  2.06e+04 1.61e-11  1.79e+04     4s
   3  -6.86683209e+05  6.47882121e+07  1.19e+03 1.99e+00  1.37e+03     5s
   4  -4.82713053e+05  3.33710152e+07  4.20e+02 7.21e-01  5.26e+02     5s
   5  -3.77312354e+05  2.15986867e+07  1.62e+02 4.08e-01  2.51e+02     5s
   6  -2.65170482e+05  1.54474909e+07  3.29e+01 2.63e-01  1.22e+02     5s
   7  -1.41879987e+05  1.03007120e+07  1.92e+00 1.66e-01  6.88e+01     5s
   8  -9.48215046e+04  3.22381363e+06  7.04e-01 5.11e-02  2.17e+01     5s
   9  -8.00844679e+04  1.29057349e+06  4.85e-01 2.03e-02  8.95e+00     5s
  10  -5.50239403e+04  6.03152949e+05  2.53e-01 9.36e-03  4.29e+00     5s
  11  -3.20236605e+04  1.87090461e+05  7.76e-02 2.96e-03  1.43e+00     5s
  12  -2.46059715e+04  8.69954644e+04  4.11e-02 1.30e-03  7.27e-01     5s
  13  -2.03396652e+04  5.49896291e+04  3.06e-02 1.25e-03  4.90e-01     5s
  14  -1.72045603e+04  3.82220053e+04  2.42e-02 8.83e-04  3.61e-01     5s
  15  -1.46020508e+04  2.13107438e+04  1.97e-02 5.63e-04  2.34e-01     6s
  16  -1.14195021e+04  1.54731296e+04  1.45e-02 4.09e-04  1.75e-01     6s
  17  -1.00521432e+04  1.34549155e+04  1.25e-02 3.46e-04  1.53e-01     6s
  18  -7.96430907e+03  1.00660253e+04  9.49e-03 2.67e-04  1.17e-01     6s
  19  -6.85796937e+03  6.61504561e+03  8.02e-03 2.98e-04  8.77e-02     6s
  20  -5.81276666e+03  5.34996834e+03  6.61e-03 2.48e-04  7.27e-02     6s
  21  -4.93281749e+03  3.40408652e+03  5.41e-03 1.81e-04  5.43e-02     6s
  22  -4.33547524e+03  2.61464395e+03  4.54e-03 1.49e-04  4.53e-02     6s
  23  -3.72154397e+03  1.86711057e+03  3.69e-03 1.17e-04  3.64e-02     7s
  24  -3.25832589e+03  1.38994511e+03  2.99e-03 9.46e-05  3.03e-02     7s
  25  -2.87823093e+03  1.06838175e+03  2.43e-03 8.19e-05  2.57e-02     7s
  26  -2.53812285e+03  7.40715594e+02  1.98e-03 6.83e-05  2.14e-02     7s
  27  -2.42274519e+03  4.89016018e+02  1.82e-03 5.83e-05  1.90e-02     7s
  28  -2.17100672e+03  2.52054349e+02  1.50e-03 4.94e-05  1.58e-02     7s
  29  -2.03487367e+03  5.31833212e+01  1.30e-03 4.18e-05  1.36e-02     7s
  30  -1.89660976e+03 -1.58984257e+02  1.12e-03 3.37e-05  1.13e-02     7s
  31  -1.82061713e+03 -2.60494318e+02  1.02e-03 2.97e-05  1.02e-02     7s
  32  -1.76496568e+03 -4.32106016e+02  9.40e-04 2.33e-05  8.68e-03     8s
  33  -1.65926410e+03 -5.41731074e+02  8.07e-04 1.89e-05  7.28e-03     8s
  34  -1.57511899e+03 -5.91802972e+02  6.98e-04 1.68e-05  6.40e-03     8s
  35  -1.51126368e+03 -6.58369546e+02  6.17e-04 1.41e-05  5.55e-03     8s
  36  -1.36260247e+03 -6.90368179e+02  4.41e-04 1.25e-05  4.38e-03     8s
  37  -1.27938924e+03 -7.46192686e+02  3.44e-04 1.01e-05  3.47e-03     8s
  38  -1.27562713e+03 -7.69100538e+02  3.39e-04 9.22e-06  3.30e-03     8s
  39  -1.25271390e+03 -7.83039574e+02  3.11e-04 8.65e-06  3.06e-03     8s
  40  -1.23262933e+03 -7.98427173e+02  2.86e-04 8.00e-06  2.83e-03     9s
  41  -1.18369013e+03 -8.26086132e+02  2.28e-04 6.82e-06  2.33e-03     9s
  42  -1.17207924e+03 -8.39880324e+02  2.14e-04 6.23e-06  2.16e-03     9s
  43  -1.15048524e+03 -8.68743826e+02  1.91e-04 4.96e-06  1.83e-03     9s
  44  -1.13453520e+03 -9.00399545e+02  1.73e-04 3.59e-06  1.52e-03     9s
  45  -1.08544069e+03 -9.13280076e+02  1.13e-04 3.00e-06  1.12e-03     9s
  46  -1.06475409e+03 -9.32073412e+02  8.96e-05 2.17e-06  8.64e-04     9s
  47  -1.05210890e+03 -9.38530873e+02  7.52e-05 1.88e-06  7.40e-04     9s
  48  -1.03940562e+03 -9.43399086e+02  6.18e-05 1.65e-06  6.25e-04    10s
  49  -1.03169721e+03 -9.54786030e+02  5.27e-05 1.18e-06  5.01e-04    10s
  50  -1.02945529e+03 -9.61391848e+02  5.02e-05 9.00e-07  4.43e-04    10s
  51  -1.01876612e+03 -9.63283829e+02  3.88e-05 8.14e-07  3.61e-04    10s
  52  -1.01679710e+03 -9.64493646e+02  3.65e-05 7.64e-07  3.41e-04    10s
  53  -1.00648067e+03 -9.68552409e+02  2.53e-05 6.62e-07  2.47e-04    10s
  54  -1.00037857e+03 -9.71582032e+02  1.84e-05 5.34e-07  1.88e-04    10s
  55  -9.91444081e+02 -9.78674200e+02  9.18e-06 1.49e-06  8.32e-05    10s
  56  -9.82837409e+02 -9.81799126e+02  5.40e-07 8.17e-08  6.76e-06    11s
  57  -9.82261650e+02 -9.82052460e+02  1.30e-07 1.94e-09  1.36e-06    11s
  58  -9.82081755e+02 -9.82059461e+02  2.13e-08 9.64e-08  1.45e-07    11s
  59  -9.82066215e+02 -9.82063258e+02  3.03e-08 1.27e-09  1.93e-08    11s
  60  -9.82065886e+02 -9.82063263e+02  3.11e-06 1.42e-08  1.57e-08    11s
  61  -9.82063285e+02 -9.82063284e+02  4.44e-09 6.04e-08  1.09e-11    11s

Barrier solved model in 61 iterations and 10.95 seconds (9.49 work units)
Optimal objective -9.82063285e+02


Root crossover log...

   66078 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2578 PPushes remaining with PInf 3.7241492e-06                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.6800197e-10     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31327   -9.8206328e+02   0.000000e+00   0.000000e+00     14s
   31327   -9.8206328e+02   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective -9.820633e+02, 31327 iterations, 10.25 seconds (11.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -982.06328    0  459 -180243.66 -982.06328  99.5%     -   14s
H    0     0                    -165770.4876 -982.06328  99.4%     -   14s
H    0     0                    -144835.9384 -982.06328  99.3%     -   14s
H    0     0                    -142280.4675 -982.06328  99.3%     -   14s
H    0     0                    -141774.0416 -982.06328  99.3%     -   15s
H    0     0                    -141372.3879 -982.06328  99.3%     -   15s
H    0     0                    -141076.8736 -982.06328  99.3%     -   15s
H    0     0                    -63885.71083 -982.06328  98.5%     -   15s
H    0     0                    -63651.09468 -982.06328  98.5%     -   15s
H    0     0                    -46821.28372 -982.06328  97.9%     -   15s
H    0     0                    -46778.26092 -982.06328  97.9%     -   15s
H    0     0                    -45351.43985 -982.06328  97.8%     -   17s
H    0     0                    -45330.87798 -982.06328  97.8%     -   17s
     0     0 -4704.7217    0  543 -45330.878 -4704.7217  89.6%     -   43s
H    0     0                    -42408.88389 -4707.0047  88.9%     -   44s
H    0     0                    -40673.06094 -4707.0047  88.4%     -   44s
     0     0 -4882.0349    0  527 -40673.061 -4882.0349  88.0%     -   47s
     0     0 -4990.8876    0  536 -40673.061 -4990.8876  87.7%     -   49s
     0     0 -4992.5054    0  537 -40673.061 -4992.5054  87.7%     -   49s
     0     0 -4998.8407    0  537 -40673.061 -4998.8407  87.7%     -   50s
     0     0 -4998.8407    0  537 -40673.061 -4998.8407  87.7%     -   50s
H    0     0                    -40071.74191 -7735.7787  80.7%     -   82s
H    0     0                    -38850.14275 -7735.7787  80.1%     -   82s
     0     0 -7735.7787    0  609 -38850.143 -7735.7787  80.1%     -   83s
H    0     0                    -30832.91008 -7736.4449  74.9%     -   84s
H    0     0                    -30819.92442 -7736.4449  74.9%     -   84s
H    0     0                    -30679.11799 -7736.4449  74.8%     -   84s
H    0     0                    -30672.46671 -7736.4449  74.8%     -   84s
H    0     0                    -30669.96993 -7736.4449  74.8%     -   84s
H    0     0                    -30593.79680 -7736.4449  74.7%     -   84s
H    0     0                    -30561.15619 -7736.4449  74.7%     -   84s
H    0     0                    -30554.50491 -7736.4449  74.7%     -   84s
H    0     0                    -30552.00813 -7736.4449  74.7%     -   84s
H    0     0                    -30466.94247 -7736.4449  74.6%     -   84s
H    0     0                    -30415.04246 -7736.4449  74.6%     -   84s
     0     0 -7896.4980    0  600 -30415.042 -7896.4980  74.0%     -   94s
     0     0 -8098.5296    0  537 -30415.042 -8098.5296  73.4%     -  103s
     0     0 -8154.3292    0  543 -30415.042 -8154.3292  73.2%     -  106s
     0     0 -8166.2250    0  553 -30415.042 -8166.2250  73.2%     -  107s
     0     0 -8168.4812    0  552 -30415.042 -8168.4812  73.1%     -  108s
     0     0 -8171.8045    0  552 -30415.042 -8171.8045  73.1%     -  108s
     0     0 -8223.1819    0  555 -30415.042 -8223.1819  73.0%     -  110s
     0     0 -8290.1818    0  545 -30415.042 -8290.1818  72.7%     -  114s
     0     0 -8295.1920    0  553 -30415.042 -8295.1920  72.7%     -  115s
     0     0 -8309.3819    0  545 -30415.042 -8309.3819  72.7%     -  116s
     0     0 -8311.5485    0  547 -30415.042 -8311.5485  72.7%     -  117s
     0     0 -8311.5685    0  545 -30415.042 -8311.5685  72.7%     -  118s
H    0     0                    -29917.87732 -10395.013  65.3%     -  172s
H    0     0                    -29874.22289 -10395.013  65.2%     -  172s
H    0     0                    -29659.97797 -10395.013  65.0%     -  172s
H    0     0                    -29659.61142 -10395.013  65.0%     -  172s
     0     0 -10395.013    0  592 -29659.611 -10395.013  65.0%     -  172s
H    0     0                    -29656.35498 -10395.203  64.9%     -  173s
H    0     0                    -29235.74836 -10821.441  63.0%     -  191s
H    0     0                    -29208.26635 -10821.441  63.0%     -  191s
H    0     0                    -29203.92753 -10821.441  62.9%     -  191s
     0     0 -10821.441    0  589 -29203.928 -10821.441  62.9%     -  191s
H    0     0                    -29129.82341 -10983.336  62.3%     -  200s
H    0     0                    -29126.91043 -10983.336  62.3%     -  200s
H    0     0                    -28352.61523 -10983.336  61.3%     -  200s
H    0     0                    -27404.24910 -10983.336  59.9%     -  200s
H    0     0                    -27399.55661 -10983.336  59.9%     -  200s
     0     0 -10983.336    0  594 -27399.557 -10983.336  59.9%     -  200s
H    0     0                    -27344.83146 -11118.766  59.3%     -  204s
     0     0 -11118.766    0  589 -27344.831 -11118.766  59.3%     -  204s
H    0     0                    -27058.80622 -11220.846  58.5%     -  210s
H    0     0                    -26982.94147 -11220.846  58.4%     -  210s
H    0     0                    -26980.17886 -11220.846  58.4%     -  210s
     0     0 -11220.846    0  589 -26980.179 -11220.846  58.4%     -  211s
     0     0 -11248.016    0  590 -26980.179 -11248.016  58.3%     -  214s
     0     0 -11276.389    0  587 -26980.179 -11276.389  58.2%     -  216s
     0     0 -11292.926    0  599 -26980.179 -11292.926  58.1%     -  218s
     0     0 -11302.249    0  603 -26980.179 -11302.249  58.1%     -  220s
     0     0 -11351.186    0  589 -26980.179 -11351.186  57.9%     -  221s
     0     0 -11556.210    0  495 -26980.179 -11556.210  57.2%     -  228s
     0     0 -11598.998    0  495 -26980.179 -11598.998  57.0%     -  230s
     0     0 -11606.872    0  501 -26980.179 -11606.872  57.0%     -  231s
     0     0 -11610.527    0  495 -26980.179 -11610.527  57.0%     -  232s
     0     0 -11610.690    0  497 -26980.179 -11610.690  57.0%     -  232s
H    0     0                    -26922.12306 -12245.831  54.5%     -  258s
H    0     0                    -26868.04618 -12245.831  54.4%     -  258s
H    0     0                    -26862.84971 -12245.831  54.4%     -  258s
     0     0 -12245.831    0  615 -26862.850 -12245.831  54.4%     -  258s
H    0     0                    -26807.77976 -12246.092  54.3%     -  258s
     0     0 -12382.043    0  609 -26807.780 -12382.043  53.8%     -  268s
     0     0 -12403.713    0  620 -26807.780 -12403.713  53.7%     -  271s
     0     0 -12407.517    0  623 -26807.780 -12407.517  53.7%     -  272s
     0     0 -12411.874    0  618 -26807.780 -12411.874  53.7%     -  274s
     0     0 -12415.791    0  622 -26807.780 -12415.791  53.7%     -  275s
     0     0 -12416.118    0  631 -26807.780 -12416.118  53.7%     -  276s
     0     0 -12598.870    0  585 -26807.780 -12598.870  53.0%     -  290s
     0     0 -12626.571    0  729 -26807.780 -12626.571  52.9%     -  297s
     0     0 -12633.217    0  729 -26807.780 -12633.217  52.9%     -  299s
     0     0 -12634.364    0  737 -26807.780 -12634.364  52.9%     -  301s
     0     0 -12713.722    0  648 -26807.780 -12713.722  52.6%     -  312s
H    0     0                    -26660.46604 -12715.867  52.3%     -  315s
H    0     0                    -26547.59266 -12715.867  52.1%     -  315s
H    0     0                    -26544.83006 -12715.867  52.1%     -  316s
     0     0 -12737.014    0  659 -26544.830 -12737.014  52.0%     -  321s
     0     0 -12747.990    0  656 -26544.830 -12747.990  52.0%     -  324s
     0     0 -12749.420    0  661 -26544.830 -12749.420  52.0%     -  326s
     0     0 -12793.915    0  571 -26544.830 -12793.915  51.8%     -  333s
     0     0 -12812.624    0  573 -26544.830 -12812.624  51.7%     -  342s
     0     0 -12821.135    0  573 -26544.830 -12821.135  51.7%     -  345s
     0     0 -12824.314    0  576 -26544.830 -12824.314  51.7%     -  347s
     0     0 -12825.965    0  582 -26544.830 -12825.965  51.7%     -  349s
     0     0 -12851.302    0  572 -26544.830 -12851.302  51.6%     -  356s
H    0     0                    -26520.96947 -12851.755  51.5%     -  357s
     0     0 -12860.980    0  567 -26520.969 -12860.980  51.5%     -  361s
     0     0 -12864.317    0  569 -26520.969 -12864.317  51.5%     -  362s
     0     0 -12864.864    0  743 -26520.969 -12864.864  51.5%     -  364s
     0     0 -12960.669    0  749 -26520.969 -12960.669  51.1%     -  373s
     0     0 -12970.511    0  640 -26520.969 -12970.511  51.1%     -  376s
     0     0 -12974.275    0  644 -26520.969 -12974.275  51.1%     -  377s
     0     0 -12976.464    0  587 -26520.969 -12976.464  51.1%     -  379s
     0     0 -12977.758    0  656 -26520.969 -12977.758  51.1%     -  380s
     0     0 -12992.184    0  663 -26520.969 -12992.184  51.0%     -  387s
     0     0 -12996.241    0  657 -26520.969 -12996.241  51.0%     -  394s
     0     0 -12998.611    0  653 -26520.969 -12998.611  51.0%     -  395s
     0     0 -12999.092    0  597 -26520.969 -12999.092  51.0%     -  396s
     0     0 -13021.825    0  731 -26520.969 -13021.825  50.9%     -  406s
     0     0 -13024.059    0  664 -26520.969 -13024.059  50.9%     -  409s
     0     0 -13025.787    0  594 -26520.969 -13025.787  50.9%     -  410s
     0     0 -13071.500    0  595 -26520.969 -13071.500  50.7%     -  418s
H    0     0                    -22715.91638 -13071.665  42.5%     -  427s
     0     0 -13092.140    0  679 -22715.916 -13092.140  42.4%     -  431s
     0     0 -13098.255    0  671 -22715.916 -13098.255  42.3%     -  433s
     0     0 -13100.112    0  614 -22715.916 -13100.112  42.3%     -  435s
     0     0 -13100.316    0  684 -22715.916 -13100.316  42.3%     -  436s
     0     0 -13117.507    0  680 -22715.916 -13117.507  42.3%     -  441s
     0     0 -13121.237    0  622 -22715.916 -13121.237  42.2%     -  444s
     0     0 -13122.048    0  693 -22715.916 -13122.048  42.2%     -  445s
     0     0 -13142.917    0  619 -22715.916 -13142.917  42.1%     -  452s
H    0     0                    -22258.56449 -13142.989  41.0%     -  454s
H    0     0                    -22161.15124 -13142.989  40.7%     -  455s
H    0     0                    -22136.35059 -13142.989  40.6%     -  456s
H    0     0                    -22116.31182 -13142.989  40.6%     -  470s
     0     0 -13206.580    0  611 -22116.312 -13206.580  40.3%     -  478s
     0     0 -13215.176    0  703 -22116.312 -13215.176  40.2%     -  480s
     0     0 -13219.488    0  633 -22116.312 -13219.488  40.2%     -  483s
     0     0 -13220.130    0  638 -22116.312 -13220.130  40.2%     -  484s
     0     0 -13282.627    0  616 -22116.312 -13282.627  39.9%     -  492s
     0     0 -13311.755    0  686 -22116.312 -13311.755  39.8%     -  498s
     0     0 -13316.420    0  636 -22116.312 -13316.420  39.8%     -  500s
     0     0 -13318.136    0  703 -22116.312 -13318.136  39.8%     -  501s
     0     0 -13325.363    0  638 -22116.312 -13325.363  39.7%     -  506s
     0     0 -13327.977    0  650 -22116.312 -13327.977  39.7%     -  509s
     0     0 -13330.130    0  653 -22116.312 -13330.130  39.7%     -  510s
     0     0 -13330.432    0  655 -22116.312 -13330.432  39.7%     -  511s
     0     0 -13333.942    0  636 -22116.312 -13333.942  39.7%     -  515s
     0     0 -13337.825    0  651 -22116.312 -13337.825  39.7%     -  516s
     0     0 -13338.496    0  651 -22116.312 -13338.496  39.7%     -  517s
     0     0 -13340.401    0  652 -22116.312 -13340.401  39.7%     -  520s
     0     0 -13340.511    0  652 -22116.312 -13340.511  39.7%     -  527s
H    0     0                    -22110.60698 -13340.629  39.7%     -  540s
H    0     0                    -22023.31682 -13340.629  39.4%     -  540s
     0     2 -13340.629    0  652 -22023.317 -13340.629  39.4%     -  573s
     1     4 -13414.990    1  618 -22023.317 -13340.629  39.4%  3196  582s
     3     6 -13701.500    2  305 -22023.317 -13415.051  39.1%  6449  598s
     5    12 -14031.285    3  327 -22023.317 -13415.051  39.1%  6443  605s
    11    24 -14225.281    4  325 -22023.317 -13648.795  38.0%  5548  625s
    23    26 -14128.780    4  683 -22023.317 -14026.252  36.3% 10142  660s
    35    36     cutoff    5      -22023.317 -14026.252  36.3%  9865  698s
H   37    36                    -21999.20425 -14026.252  36.2%  9367  698s
H   45    36                    -21995.02241 -14026.252  36.2%  8198  698s
    51    57 -14133.812    6  578 -21995.022 -14026.252  36.2%  8453  783s
H   82    87                    -21966.51336 -14134.445  35.7%  8460  815s
H   84    87                    -21916.41897 -14134.920  35.5%  8448  815s
   114   204 -14309.717    8  537 -21916.419 -14139.747  35.5%  8499  848s
   234   246 -14524.559   11  624 -21916.419 -14139.747  35.5%  6038  869s
   288   265 -18511.948   14  258 -21916.419 -14139.747  35.5%  5940  894s
   335   311 -18293.133   10  191 -21916.419 -14139.747  35.5%  6034  918s
   401   352 -19347.262   11  214 -21916.419 -14139.747  35.5%  5886  937s
   462   401 -19640.102   12  204 -21916.419 -14139.747  35.5%  5904  957s
   533   446 -20016.368   15  196 -21916.419 -14139.747  35.5%  5838  978s
   611   505 -21685.872   17  126 -21916.419 -14139.747  35.5%  5708  996s
   689   565     cutoff   20      -21916.419 -14139.747  35.5%  5471 1013s
   785   608 infeasible   17      -21916.419 -14148.405  35.4%  5140 1030s
   848   652 -15539.251    7  576 -21916.419 -14148.405  35.4%  4973 1047s
   918   752 -15587.966    8  575 -21916.419 -14148.405  35.4%  4824 1064s
  1032   835 -18137.893    9  497 -21916.419 -14204.297  35.2%  4520 1080s
  1127   968     cutoff   10      -21916.419 -14204.854  35.2%  4354 1097s
  1276  1116 -18148.253   10  494 -21916.419 -14204.854  35.2%  4077 1114s
  1446  1143 infeasible   12      -21916.419 -14204.854  35.2%  3745 1130s
  1481  1175 -18376.235   13  458 -21916.419 -14204.854  35.2%  3721 1150s
  1521  1201 -18393.683   14  458 -21916.419 -14204.854  35.2%  3676 1165s
  1559  1286 -18566.230   15  457 -21916.419 -14204.854  35.2%  3653 1181s
  1660  1412 -18631.304   16  379 -21916.419 -14204.854  35.2%  3505 1197s
  1822  1606 -18652.096   17  364 -21916.419 -14204.854  35.2%  3304 1214s
  2032  1838 -18730.819   18  347 -21916.419 -14204.854  35.2%  3062 1227s
H 2152  1838                    -20991.55978 -14204.854  32.3%  2919 1227s
  2288  1903 -18792.169   19  321 -20991.560 -14204.854  32.3%  2794 1245s
  2553  1969 infeasible   20      -20991.560 -14204.854  32.3%  2598 1265s
  2758  2031 -15040.439   11  530 -20991.560 -14204.854  32.3%  2526 1287s
  2940  2113 -17484.556   12  285 -20991.560 -14204.854  32.3%  2495 1307s
  3091  2176 infeasible   18      -20991.560 -14204.854  32.3%  2508 1328s
  3253  2294 infeasible   13      -20991.560 -14349.030  31.6%  2489 1347s
H 3263  2287                    -20966.35103 -14349.030  31.6%  2489 1347s
H 3308  2274                    -20877.78181 -14349.030  31.3%  2491 1347s
  3447  2347 -16267.623   14  234 -20877.782 -14349.030  31.3%  2465 1369s
  3633  2435 -20128.271   16  217 -20877.782 -14507.911  30.5%  2461 1392s
  3823  2523 infeasible   18      -20877.782 -14507.911  30.5%  2470 1416s
  3978  2594 infeasible   20      -20877.782 -14507.911  30.5%  2478 1440s
  4187  2652 infeasible   20      -20877.782 -14507.911  30.5%  2494 1464s
H 4335  2553                    -20616.85719 -14525.188  29.5%  2556 1488s
H 4336  2387                    -20324.74219 -14525.188  28.5%  2557 1488s
H 4337  2309                    -20174.20330 -14525.188  28.0%  2557 1488s
H 4338  2304                    -20167.05438 -14525.188  28.0%  2560 1488s
H 4339  2213                    -20003.39755 -14525.188  27.4%  2560 1488s
H 4346  2163                    -19922.71234 -14525.188  27.1%  2568 1488s
  4373  2206 infeasible   11      -19922.712 -14525.188  27.1%  2593 1516s
  4548  2311 -18640.035   10  285 -19922.712 -14541.839  27.0%  2600 1543s
H 4743  2291                    -19897.21990 -14541.839  26.9%  2614 1579s
H 4743  2283                    -19881.93981 -14541.839  26.9%  2614 1591s
  4744  2284 -15339.436   12  652 -19881.940 -14541.839  26.9%  2613 1720s
  4746  2285 -17807.091   31  497 -19881.940 -14541.839  26.9%  2612 1741s
  4747  2286 -17650.884   39  595 -19881.940 -14541.839  26.9%  2612 1810s
  4748  2287 -18439.659   17  604 -19881.940 -14541.839  26.9%  2611 1853s
  4749  2287 -15459.061    7  667 -19881.940 -14541.839  26.9%  2610 1875s
  4750  2288 -16320.506   18  600 -19881.940 -14541.839  26.9%  2610 1890s
  4751  2289 -18489.003   11  620 -19881.940 -14541.839  26.9%  2609 1899s
  4752  2289 -19336.296   82  623 -19881.940 -14541.839  26.9%  2609 1905s
  4753  2290 -19528.216   73  630 -19881.940 -14541.839  26.9%  2608 1911s
  4754  2291 -18174.025   66  632 -19881.940 -14541.839  26.9%  2608 1916s
  4755  2291 -19037.298   94  643 -19881.940 -14541.839  26.9%  2607 1920s
  4757  2293 -17197.191   61  658 -19881.940 -14541.839  26.9%  2606 1927s
  4758  2293 -17583.177   37  604 -19881.940 -14541.839  26.9%  2606 1933s
  4759  2294 -18339.212   47  715 -19881.940 -14541.839  26.9%  2605 1940s
  4761  2295 -19856.079   94  660 -19881.940 -14541.839  26.9%  2604 1952s
  4762  2296 -15620.564   13  657 -19881.940 -14541.839  26.9%  2603 1978s
  4763  2297 -16438.665   30  726 -19881.940 -14541.839  26.9%  2603 1988s
  4764  2297 -15643.167   10  683 -19881.940 -14541.839  26.9%  2602 1994s
  4765  2298 -17580.374   69  436 -19881.940 -14541.839  26.9%  2602 1998s
  4766  2299 -15787.743   13  690 -19881.940 -14541.839  26.9%  2601 2003s
  4767  2299 -17371.539   46  691 -19881.940 -14541.839  26.9%  2601 2006s
  4768  2300 -16718.285   41  650 -19881.940 -14541.839  26.9%  2600 2013s
  4769  2301 -17737.162   58  733 -19881.940 -14541.839  26.9%  2600 2019s
  4770  2301 -16994.513   32  656 -19881.940 -14541.839  26.9%  2599 2023s
  4771  2302 -18950.450  107  665 -19881.940 -14541.839  26.9%  2598 2032s
  4772  2303 -16403.478   24  640 -19881.940 -14541.839  26.9%  2598 2054s
  4773  2303 -17256.018   26  713 -19881.940 -14541.839  26.9%  2597 2059s
  4774  2304 -15904.338   25  724 -19881.940 -14541.839  26.9%  2597 2062s
  4775  2305 -16562.682   14  662 -19881.940 -14541.839  26.9%  2596 2072s
  4776  2305 -17638.337   39  668 -19881.940 -14541.839  26.9%  2596 2085s
  4779  2307 -16871.859   10  606 -19881.940 -14541.839  26.9%  2594 2096s
  4780  2308 -18307.298   84  596 -19881.940 -14541.839  26.9%  2594 2108s
  4781  2309 -17777.247   66  603 -19881.940 -14541.839  26.9%  2593 2116s
  4782  2309 -18628.813  115  646 -19881.940 -14541.839  26.9%  2592 2140s
  4784  2311 -19442.406   75  663 -19881.940 -14541.839  26.9%  2591 2152s
  4785  2311 -17312.893   39  580 -19881.940 -14541.839  26.9%  2591 2171s
  4786  2312 -19649.700   68  570 -19881.940 -14541.839  26.9%  2590 2175s
  4788  2313 -16251.749   14  578 -19881.940 -14541.839  26.9%  2589 2184s
  4789  2314 -17036.838   51  586 -19881.940 -14541.839  26.9%  2589 2200s
  4790  2315 -18652.119   11  589 -19881.940 -14541.839  26.9%  2588 2206s
  4791  2315 -17905.583   80  583 -19881.940 -14541.839  26.9%  2588 2219s
  4792  2316 -17444.288   13  707 -19881.940 -14541.839  26.9%  2587 2223s
  4793  2317 -18844.210   95  644 -19881.940 -14541.839  26.9%  2587 2231s
  4794  2317 -18307.298   84  708 -19881.940 -14541.839  26.9%  2586 2248s
  4795  2318 -18514.685   59  708 -19881.940 -14541.839  26.9%  2585 2272s
  4796  2319 -19234.850   91  708 -19881.940 -14541.839  26.9%  2585 2293s
  4797  2322 -14541.839   11  629 -19881.940 -14541.839  26.9%  2642 2329s
  4799  2326 -14541.839   12  689 -19881.940 -14541.839  26.9%  2642 2353s
  4803  2332 -14541.839   13  717 -19881.940 -14541.839  26.9%  2645 2400s
  4811  2338 -14541.839   14  716 -19881.940 -14541.839  26.9%  2652 2445s
  4825  2341 -15180.722   15  381 -19881.940 -14541.839  26.9%  2671 2490s
  4837  2360 -16890.204   16  571 -19881.940 -14541.839  26.9%  2691 2561s
  4866  2436 -17081.971   17  478 -19881.940 -14541.839  26.9%  2836 2618s
  4962  2464 -17555.491   20  540 -19881.940 -14541.839  26.9%  2860 2656s
  5031  2485 -19525.403   22  435 -19881.940 -14541.839  26.9%  2880 2703s
  5104  2514 -19808.748   24  400 -19881.940 -14541.839  26.9%  2886 2732s
  5195  2522 infeasible   22      -19881.940 -14541.839  26.9%  2874 2759s
  5268  2538 infeasible   22      -19881.940 -14541.839  26.9%  2863 2785s
  5355  2542 -15204.754   16  548 -19881.940 -14541.839  26.9%  2847 2809s
  5447  2547 -18752.991   18  487 -19881.940 -14541.839  26.9%  2824 2838s
  5534  2553 -19162.967   19  340 -19881.940 -14541.839  26.9%  2805 2863s
  5606  2574 -15873.342   16  564 -19881.940 -14541.839  26.9%  2793 2885s
  5687  2605 -16899.532   17  491 -19881.940 -14541.839  26.9%  2780 2907s
  5765  2631 -18051.350   18  432 -19881.940 -14541.839  26.9%  2763 2930s
  5858  2652 -18779.480   19  421 -19881.940 -14541.839  26.9%  2743 2950s
  5936  2679 infeasible   20      -19881.940 -14541.839  26.9%  2721 2971s
  6050  2689 -19242.486   19  475 -19881.940 -15634.791  21.4%  2688 2993s
  6166  2702 -19384.877   20  403 -19881.940 -15634.791  21.4%  2653 3015s
  6307  2718 infeasible   21      -19881.940 -15634.791  21.4%  2615 3055s
  6458  2727 -19692.937   22  473 -19881.940 -15700.812  21.0%  2579 3081s
  6610  2712     cutoff   23      -19881.940 -15700.812  21.0%  2543 3107s
  6772  2736 -16737.386   26  493 -19881.940 -15700.812  21.0%  2501 3140s
  6976  2713 -16845.312   29  368 -19881.940 -15700.812  21.0%  2448 3165s
  7128  2722 -16883.631   30  340 -19881.940 -15700.812  21.0%  2411 3195s
  7347  2699 -16943.632   35  319 -19881.940 -15700.812  21.0%  2361 3224s
  7538  2701 -17035.165   40  268 -19881.940 -15875.157  20.2%  2329 3259s
  7718  2724 -17149.826   49  272 -19881.940 -15875.157  20.2%  2299 3288s
  7934  2750 -17354.529   56  332 -19881.940 -15915.640  19.9%  2262 3320s
  8164  2763 -17520.683   63  309 -19881.940 -15915.640  19.9%  2225 3352s
  8367  2708 -17670.117   68  331 -19881.940 -15915.640  19.9%  2189 3379s
  8422  2722 -17691.559   69  240 -19881.940 -16022.653  19.4%  2183 3405s
  8506  2736 -17888.960   87  281 -19881.940 -16022.653  19.4%  2173 3432s
  8616  2815 -17992.139  102  290 -19881.940 -16022.653  19.4%  2161 3461s
  8815  2893 -18091.748  111  140 -19881.940 -16022.653  19.4%  2129 3492s
  9091  2993 -18250.540  134  210 -19881.940 -16022.653  19.4%  2085 3527s
  9471  3068     cutoff  159      -19881.940 -16022.653  19.4%  2028 3565s
  9893  3064 infeasible  179      -19881.940 -16143.689  18.8%  1971 3600s

Cutting planes:
  Learned: 1
  Implied bound: 26
  Projected implied bound: 133
  MIR: 1175
  Mixing: 1
  Flow cover: 2638
  Zero half: 1
  RLT: 50
  Relax-and-lift: 193

Explored 10284 nodes (20219503 simplex iterations) in 3600.09 seconds (5659.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -19881.9 -19881.9 -19897.2 ... -20877.8

Time limit reached
Best objective -1.988193980676e+04, best bound -1.614368895078e+04, gap 18.8022%
  WARNING: Time limit reached. Using best solution found (gap: 18.80%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -19881.94, θ = 93074.86
  Upper Bound (UB) = -19881.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93074.86
  [DEBUG]   ✓ Scenario 0: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93074.86 ≤ Q = 93074.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93074.86 ≤ Q = 93074.86 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5563a0f2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5563a0f2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.431776e+13
Presolve removed 2608 rows and 1904 columns
Presolve time: 0.01s
Presolved: 485 rows, 485 columns, 1366 nonzeros
Found heuristic solution: objective 7745018.2219
Variable types: 325 continuous, 160 integer (160 binary)

Root relaxation: objective -1.084442e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108444.19    0  122 7745018.22 -108444.19   101%     -    0s
H    0     0                    -74363.10415 -108444.19  45.8%     -    0s
H    0     0                    -75318.02081 -108444.19  44.0%     -    0s
     0     0 -84114.084    0  129 -75318.021 -84114.084  11.7%     -    0s
H    0     0                    -78645.11054 -84070.686  6.90%     -    0s
H    0     0                    -79310.31906 -83533.065  5.32%     -    0s
     0     0 -83533.065    0  128 -79310.319 -83533.065  5.32%     -    0s
     0     0 -83428.184    0  128 -79310.319 -83428.184  5.19%     -    0s
     0     0 -83116.427    0  132 -79310.319 -83116.427  4.80%     -    0s
H    0     0                    -79495.46507 -83102.047  4.54%     -    0s
     0     0 -83023.664    0  133 -79495.465 -83023.664  4.44%     -    0s
     0     0 -83000.770    0  133 -79495.465 -83000.770  4.41%     -    0s
     0     2 -83000.770    0  133 -79495.465 -83000.770  4.41%     -    0s
H  205   256                    -79524.95078 -82275.467  3.46%   3.8    0s
* 2670  2022              50    -79954.14807 -82013.385  2.58%   5.1    0s
* 2673  2022              48    -79963.21000 -82013.385  2.56%   5.1    0s
H 3368  2431                    -80014.44562 -81892.726  2.35%   5.2    0s
H 3473  2375                    -80067.71604 -81886.847  2.27%   5.2    0s
H 3515  2333                    -80098.56940 -81886.847  2.23%   5.2    0s
H 3893  2301                    -80133.89453 -81852.887  2.15%   5.2    0s
H 4031  1976                    -80287.56648 -81852.887  1.95%   5.2    1s
H 4059  1856                    -80320.76008 -80322.991  0.00%   5.1    1s
H 4062  1766                    -80322.28522 -80322.563  0.00%   5.5    1s

Explored 4064 nodes (22932 simplex iterations) in 1.60 seconds (0.50 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -80322.3 -80287.6 -80133.9 ... -79495.5
No other solutions better than -80322.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.032228521941e+04, best bound -8.032228521941e+04, gap 0.0000%
  Subproblem solved in 1.63s
  Worst-case operational profit (Z_SP) = 92235.48
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -80322.29
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -80322.29 = 92235.48
  [DEBUG]   Current θ from Master = 93074.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 839.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20721.31
  Lower Bound (LB) = -20721.31
  Gap (UB-LB) = 839.3749, Absolute Gap = 839.3749, Relative Gap = 0.042218
  Not converged yet (gap = 839.37 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0xd30ea441
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 2.73s
Presolved: 91803 rows, 39330 columns, 558907 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431779.1466
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 620
 AA' NZ     : 3.175e+06
 Factor NZ  : 7.276e+06 (roughly 110 MB of memory)
 Factor Ops : 1.305e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84499893e+07  1.56840145e+08  9.67e+04 1.82e+01  7.87e+04     4s
   1  -1.38725161e+07  1.39552864e+08  6.65e+04 6.62e+01  5.36e+04     4s
   2  -4.92474578e+06  1.06537948e+08  2.31e+04 7.22e-01  1.99e+04     5s
   3  -6.88525461e+05  6.72191018e+07  1.16e+03 1.63e+00  1.32e+03     5s
   4  -4.68329394e+05  3.09191635e+07  3.57e+02 6.10e-01  4.41e+02     5s
   5  -3.76126119e+05  2.02422369e+07  1.49e+02 3.48e-01  2.19e+02     5s
   6  -2.37253760e+05  1.61500944e+07  2.02e+01 2.60e-01  1.10e+02     5s
   7  -1.45674766e+05  1.18259971e+07  1.81e+00 1.86e-01  7.19e+01     5s
   8  -1.11318839e+05  4.12232029e+06  1.07e+00 6.23e-02  2.53e+01     5s
   9  -6.43606671e+04  1.06955760e+06  3.74e-01 1.37e-02  6.75e+00     5s
  10  -4.61713429e+04  5.14782246e+05  2.47e-01 6.40e-03  3.34e+00     5s
  11  -3.28468765e+04  2.43161696e+05  1.12e-01 2.99e-03  1.64e+00     5s
  12  -2.63819204e+04  1.35626287e+05  7.24e-02 1.68e-03  9.62e-01     5s
  13  -2.18776689e+04  8.88426620e+04  5.36e-02 1.16e-03  6.57e-01     5s
  14  -1.80417568e+04  5.70072067e+04  4.06e-02 8.35e-04  4.46e-01     5s
  15  -1.55387861e+04  3.91054500e+04  3.35e-02 2.43e-03  3.24e-01     5s
  16  -1.17816396e+04  2.89763921e+04  2.26e-02 1.65e-03  2.42e-01     6s
  17  -9.38501760e+03  1.94327984e+04  1.72e-02 1.13e-03  1.71e-01     6s
  18  -7.73111547e+03  1.60979580e+04  1.40e-02 9.35e-04  1.41e-01     6s
  19  -6.68687125e+03  1.13410202e+04  1.19e-02 7.59e-04  1.07e-01     6s
  20  -4.89442211e+03  9.84955110e+03  8.73e-03 6.59e-04  8.75e-02     6s
  21  -4.20548545e+03  8.36194137e+03  7.50e-03 5.55e-04  7.46e-02     6s
  22  -3.64914785e+03  7.55175111e+03  6.53e-03 5.00e-04  6.65e-02     6s
  23  -3.33783506e+03  6.28394121e+03  5.97e-03 4.16e-04  5.71e-02     6s
  24  -2.50300349e+03  5.50793691e+03  4.54e-03 3.63e-04  4.75e-02     6s
  25  -2.01112057e+03  4.42610628e+03  3.64e-03 2.85e-04  3.82e-02     7s
  26  -1.62523651e+03  3.21075700e+03  2.91e-03 2.04e-04  2.87e-02     7s
  27  -1.39907668e+03  2.74527007e+03  2.49e-03 1.74e-04  2.46e-02     7s
  28  -1.17058950e+03  2.27626794e+03  2.09e-03 1.42e-04  2.05e-02     7s
  29  -8.43324885e+02  1.60710054e+03  1.53e-03 9.66e-05  1.45e-02     7s
  30  -7.46192190e+02  1.28656602e+03  1.37e-03 7.36e-05  1.21e-02     7s
  31  -5.52046841e+02  1.06871740e+03  1.06e-03 5.91e-05  9.62e-03     7s
  32  -3.24682251e+02  8.28268567e+02  6.96e-04 4.28e-05  6.84e-03     7s
  33  -2.18930829e+02  6.40005127e+02  5.38e-04 3.11e-05  5.10e-03     7s
  34  -1.57623435e+02  5.14750841e+02  4.45e-04 2.29e-05  3.99e-03     7s
  35  -8.60612052e+01  4.71100491e+02  3.39e-04 2.00e-05  3.31e-03     8s
  36  -3.39356866e+01  3.78550075e+02  2.63e-04 1.38e-05  2.45e-03     8s
  37  -6.18290911e+00  3.35391260e+02  2.24e-04 1.11e-05  2.03e-03     8s
  38   2.44120811e+01  3.06294624e+02  1.84e-04 9.08e-06  1.67e-03     8s
  39   5.25972467e+01  2.57169958e+02  1.45e-04 5.84e-06  1.21e-03     8s
  40   6.37770466e+01  2.24688836e+02  1.30e-04 3.86e-06  9.55e-04     8s
  41   7.38463041e+01  2.11038182e+02  1.16e-04 2.99e-06  8.14e-04     8s
  42   7.98456592e+01  2.06786243e+02  1.08e-04 2.71e-06  7.53e-04     8s
  43   9.47367094e+01  2.00747085e+02  8.86e-05 2.35e-06  6.29e-04     8s
  44   1.00769288e+02  1.99207214e+02  8.06e-05 2.25e-06  5.84e-04     9s
  45   1.13147519e+02  1.94084281e+02  6.43e-05 1.90e-06  4.80e-04     9s
  46   1.22140679e+02  1.85981450e+02  5.21e-05 1.40e-06  3.79e-04     9s
  47   1.32979864e+02  1.82338417e+02  3.63e-05 1.19e-06  2.93e-04     9s
  48   1.41611028e+02  1.80620763e+02  2.57e-05 1.07e-06  2.32e-04     9s
  49   1.44792418e+02  1.69409282e+02  2.17e-05 4.24e-07  1.46e-04     9s
  50   1.48665168e+02  1.67770399e+02  1.67e-05 3.23e-07  1.13e-04     9s
  51   1.51921964e+02  1.67426218e+02  1.27e-05 3.03e-07  9.20e-05     9s
  52   1.54805303e+02  1.66293207e+02  9.14e-06 2.32e-07  6.82e-05     9s
  53   1.54868278e+02  1.65959743e+02  9.06e-06 2.14e-07  6.58e-05    10s
  54   1.55475560e+02  1.65669175e+02  8.29e-06 1.98e-07  6.05e-05    10s
  55   1.56760832e+02  1.64282381e+02  6.60e-06 1.30e-07  4.46e-05    10s
  56   1.56993570e+02  1.64313700e+02  6.30e-06 1.29e-07  4.34e-05    10s
  57   1.58891808e+02  1.63441982e+02  3.77e-06 8.15e-08  2.70e-05    10s
  58   1.60069953e+02  1.63350930e+02  2.28e-06 7.55e-08  1.95e-05    10s
  59   1.60390299e+02  1.63081291e+02  1.86e-06 6.36e-08  1.60e-05    10s
  60   1.60677524e+02  1.62430086e+02  1.49e-06 2.85e-08  1.04e-05    10s
  61   1.60897963e+02  1.62375931e+02  1.21e-06 2.56e-08  8.77e-06    11s
  62   1.60918390e+02  1.62356023e+02  1.18e-06 2.46e-08  8.53e-06    11s
  63   1.61152248e+02  1.62275926e+02  8.85e-07 2.11e-08  6.67e-06    11s
  64   1.61218468e+02  1.62167963e+02  8.02e-07 1.41e-08  5.64e-06    11s
  65   1.61474937e+02  1.62076926e+02  5.13e-07 1.57e-08  3.57e-06    11s
  66   1.61470606e+02  1.62005677e+02  4.92e-07 9.83e-09  3.18e-06    11s
  67   1.61761844e+02  1.61983595e+02  1.45e-07 7.13e-09  1.32e-06    11s
  68   1.61803913e+02  1.61919468e+02  9.60e-08 2.03e-09  6.86e-07    12s
  69   1.61810572e+02  1.61918330e+02  8.65e-08 1.97e-09  6.39e-07    12s
  70   1.61825406e+02  1.61918053e+02  7.02e-08 1.84e-09  5.50e-07    12s
  71   1.61843499e+02  1.61897478e+02  4.58e-08 8.77e-10  3.20e-07    12s
  72   1.61875100e+02  1.61892617e+02  6.51e-09 5.73e-10  1.04e-07    12s
  73   1.61877327e+02  1.61889854e+02  3.61e-07 1.13e-08  7.43e-08    12s
  74   1.61877370e+02  1.61887611e+02  3.58e-07 7.24e-09  6.08e-08    12s
  75   1.61877786e+02  1.61884786e+02  3.26e-07 4.17e-09  4.15e-08    13s
  76   1.61878647e+02  1.61884368e+02  5.87e-07 6.65e-08  3.38e-08    13s
  77   1.61880346e+02  1.61881572e+02  3.16e-07 6.14e-08  7.22e-09    13s
  78   1.61880519e+02  1.61881567e+02  1.23e-06 5.75e-08  6.59e-09    13s
  79   1.61881106e+02  1.61881452e+02  4.30e-07 4.03e-09  2.10e-09    13s
  80   1.61881201e+02  1.61881452e+02  8.95e-07 3.77e-09  2.00e-09    13s
  81   1.61881408e+02  1.61881445e+02  3.57e-07 2.15e-08  3.78e-10    13s
  82   1.61881448e+02  1.61881445e+02  6.42e-08 5.45e-09  1.08e-11    13s
  83   1.61881446e+02  1.61881445e+02  3.38e-09 2.91e-10  5.75e-13    13s

Barrier solved model in 83 iterations and 13.24 seconds (13.05 work units)
Optimal objective 1.61881446e+02


Root crossover log...

   56295 DPushes remaining with DInf 0.0000000e+00                14s
    6701 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    5062 PPushes remaining with PInf 4.7530505e-07                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.8380951e-11     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28353    1.6188145e+02   0.000000e+00   0.000000e+00     17s
   28353    1.6188145e+02   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.618814e+02, 28353 iterations, 13.15 seconds (16.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  161.88145    0  834 -180243.66  161.88145   100%     -   18s
H    0     0                    -171572.4421  161.88145   100%     -   18s
H    0     0                    -170381.2417  161.88145   100%     -   18s
H    0     0                    -169252.5822  161.88145   100%     -   18s
H    0     0                    -101842.6740  161.88145   100%     -   18s
H    0     0                    -78798.54709  161.88145   100%     -   18s
H    0     0                    -78686.32484  161.88145   100%     -   19s
H    0     0                    -70682.17658  161.88145   100%     -   19s
H    0     0                    -53609.60768  161.88145   100%     -   19s
H    0     0                    -53606.96867  161.88145   100%     -   19s
H    0     0                    -43868.17469  161.88145   100%     -   24s
H    0     0                    -43536.89686  161.88145   100%     -   24s
H    0     0                    -34887.13591 -3622.0590  89.6%     -   93s
H    0     0                    -34221.51594 -3622.0590  89.4%     -   93s
     0     0 -3622.0590    0  709 -34221.516 -3622.0590  89.4%     -   94s
     0     0 -4537.3346    0  714 -34221.516 -4537.3346  86.7%     -  121s
     0     0 -4699.5552    0  730 -34221.516 -4699.5552  86.3%     -  133s
     0     0 -4699.5552    0  712 -34221.516 -4699.5552  86.3%     -  143s
     0     0 -4699.5552    0  716 -34221.516 -4699.5552  86.3%     -  145s
     0     0 -4699.5552    0  717 -34221.516 -4699.5552  86.3%     -  146s
     0     0 -4699.5552    0  718 -34221.516 -4699.5552  86.3%     -  147s
     0     0 -4771.3465    0  730 -34221.516 -4771.3465  86.1%     -  159s
     0     0 -4788.2076    0  739 -34221.516 -4788.2076  86.0%     -  163s
     0     0 -4792.8921    0  735 -34221.516 -4792.8921  86.0%     -  165s
     0     0 -4794.1455    0  734 -34221.516 -4794.1455  86.0%     -  166s
     0     0 -4794.2796    0  733 -34221.516 -4794.2796  86.0%     -  166s
H    0     0                    -33599.72076 -7002.9399  79.2%     -  247s
H    0     0                    -33069.02746 -7002.9399  78.8%     -  247s
H    0     0                    -32964.57812 -7002.9399  78.8%     -  247s
H    0     0                    -32346.75742 -7002.9399  78.4%     -  247s
     0     0 -7162.5336    0  598 -32346.757 -7162.5336  77.9%     -  247s
H    0     0                    -29419.72645 -7162.5336  75.7%     -  248s
H    0     0                    -29177.51510 -8557.2437  70.7%     -  309s
     0     0 -8557.2437    0  717 -29177.515 -8557.2437  70.7%     -  309s
H    0     0                    -28862.91941 -8686.0746  69.9%     -  325s
     0     0 -8686.0746    0  790 -28862.919 -8686.0746  69.9%     -  325s
H    0     0                    -28859.57561 -8822.2691  69.4%     -  340s
     0     0 -8822.2691    0  782 -28859.576 -8822.2691  69.4%     -  340s
     0     0 -8865.1216    0  789 -28859.576 -8865.1216  69.3%     -  350s
     0     0 -8886.4647    0  798 -28859.576 -8886.4647  69.2%     -  356s
     0     0 -8889.1495    0  794 -28859.576 -8889.1495  69.2%     -  359s
     0     0 -8896.3349    0  812 -28859.576 -8896.3349  69.2%     -  362s
     0     0 -8899.6227    0  803 -28859.576 -8899.6227  69.2%     -  365s
     0     0 -8909.9397    0  801 -28859.576 -8909.9397  69.1%     -  370s
H    0     0                    -28378.50964 -8913.1168  68.6%     -  372s
H    0     0                    -28374.54568 -8913.1168  68.6%     -  372s
     0     0 -8913.1168    0  812 -28374.546 -8913.1168  68.6%     -  372s
     0     0 -8914.7240    0  814 -28374.546 -8914.7240  68.6%     -  373s
     0     0 -8916.1887    0  814 -28374.546 -8916.1887  68.6%     -  375s
     0     0 -8917.3283    0  809 -28374.546 -8917.3283  68.6%     -  376s
     0     0 -8917.6456    0  809 -28374.546 -8917.6456  68.6%     -  376s
     0     0 -10285.027    0  584 -28374.546 -10285.027  63.8%     -  429s
H    0     0                    -27176.13224 -10285.065  62.2%     -  430s
H    0     0                    -26956.81258 -10285.065  61.8%     -  434s
     0     0 -10480.862    0  619 -26956.813 -10480.862  61.1%     -  451s
     0     0 -10571.966    0  586 -26956.813 -10571.966  60.8%     -  461s
     0     0 -10767.502    0  607 -26956.813 -10767.502  60.1%     -  476s
     0     0 -10847.190    0  609 -26956.813 -10847.190  59.8%     -  483s
     0     0 -10867.282    0  617 -26956.813 -10867.282  59.7%     -  488s
     0     0 -10873.394    0  613 -26956.813 -10873.394  59.7%     -  490s
     0     0 -11026.197    0  669 -26956.813 -11026.197  59.1%     -  503s
     0     0 -11058.239    0  682 -26956.813 -11058.239  59.0%     -  507s
     0     0 -11073.306    0  602 -26956.813 -11073.306  58.9%     -  512s
     0     0 -11078.369    0  600 -26956.813 -11078.369  58.9%     -  514s
     0     0 -11078.482    0  601 -26956.813 -11078.482  58.9%     -  514s
H    0     0                    -26923.46376 -11078.482  58.9%     -  519s
     0     0 -11509.042    0  619 -26923.464 -11509.042  57.3%     -  545s
H    0     0                    -26736.92493 -11509.121  57.0%     -  546s
     0     0 -11681.475    0  591 -26736.925 -11681.475  56.3%     -  558s
     0     0 -11757.470    0  614 -26736.925 -11757.470  56.0%     -  571s
     0     0 -11787.145    0  611 -26736.925 -11787.145  55.9%     -  578s
     0     0 -11824.017    0  620 -26736.925 -11824.017  55.8%     -  587s
     0     0 -11845.209    0  635 -26736.925 -11845.209  55.7%     -  591s
     0     0 -11849.416    0  637 -26736.925 -11849.416  55.7%     -  592s
     0     0 -11850.636    0  635 -26736.925 -11850.636  55.7%     -  593s
     0     0 -11977.387    0  630 -26736.925 -11977.387  55.2%     -  610s
H    0     0                    -26556.65543 -11977.541  54.9%     -  611s
H    0     0                    -26551.01102 -11977.541  54.9%     -  611s
     0     0 -12011.028    0  638 -26551.011 -12011.028  54.8%     -  619s
     0     0 -12023.049    0  650 -26551.011 -12023.049  54.7%     -  622s
     0     0 -12025.746    0  655 -26551.011 -12025.746  54.7%     -  624s
     0     0 -12026.499    0  651 -26551.011 -12026.499  54.7%     -  625s
     0     0 -12090.376    0  647 -26551.011 -12090.376  54.5%     -  639s
H    0     0                    -26549.99495 -12090.480  54.5%     -  658s
H    0     0                    -26519.28826 -12090.480  54.4%     -  662s
H    0     0                    -24706.80294 -12090.480  51.1%     -  667s
H    0     0                    -22515.51170 -12090.480  46.3%     -  668s
H    0     0                    -22340.16911 -12090.480  45.9%     -  669s
H    0     0                    -22314.28478 -12090.480  45.8%     -  669s
     0     0 -12283.774    0  649 -22314.285 -12283.774  45.0%     -  682s
     0     0 -12302.006    0  665 -22314.285 -12302.006  44.9%     -  691s
     0     0 -12311.308    0  682 -22314.285 -12311.308  44.8%     -  695s
     0     0 -12315.881    0  671 -22314.285 -12315.881  44.8%     -  697s
     0     0 -12320.077    0  677 -22314.285 -12320.077  44.8%     -  699s
     0     0 -12320.551    0  672 -22314.285 -12320.551  44.8%     -  700s
     0     0 -12390.963    0  667 -22314.285 -12390.963  44.5%     -  714s
     0     0 -12518.481    0  729 -22314.285 -12518.481  43.9%     -  725s
     0     0 -12524.984    0  668 -22314.285 -12524.984  43.9%     -  728s
     0     0 -12525.978    0  668 -22314.285 -12525.978  43.9%     -  729s
     0     0 -12550.475    0  648 -22314.285 -12550.475  43.8%     -  738s
     0     0 -12550.475    0  648 -22314.285 -12550.475  43.8%     -  738s
H    0     0                    -22266.76774 -12550.541  43.6%     -  741s
H    0     0                    -22090.43620 -12550.541  43.2%     -  743s
H    0     0                    -21970.94763 -12550.541  42.9%     -  744s
H    0     0                    -21944.71338 -12550.541  42.8%     -  745s
     0     0 -12558.213    0  607 -21944.713 -12558.213  42.8%     -  767s
     0     0 -12561.663    0  674 -21944.713 -12561.663  42.8%     -  770s
     0     0 -12563.597    0  658 -21944.713 -12563.597  42.7%     -  772s
     0     0 -12640.045    0  674 -21944.713 -12640.045  42.4%     -  784s
     0     0 -12662.471    0  780 -21944.713 -12662.471  42.3%     -  793s
     0     0 -12670.778    0  769 -21944.713 -12670.778  42.3%     -  796s
     0     0 -12673.581    0  768 -21944.713 -12673.581  42.2%     -  799s
     0     0 -12675.047    0  777 -21944.713 -12675.047  42.2%     -  800s
     0     0 -12749.672    0  605 -21944.713 -12749.672  41.9%     -  811s
     0     0 -12776.439    0  643 -21944.713 -12776.439  41.8%     -  818s
     0     0 -12781.616    0  650 -21944.713 -12781.616  41.8%     -  820s
     0     0 -12785.066    0  605 -21944.713 -12785.066  41.7%     -  823s
     0     0 -12786.267    0  598 -21944.713 -12786.267  41.7%     -  824s
     0     0 -12801.056    0  610 -21944.713 -12801.056  41.7%     -  832s
     0     0 -12813.131    0  592 -21944.713 -12813.131  41.6%     -  836s
     0     0 -12815.350    0  597 -21944.713 -12815.350  41.6%     -  837s
     0     0 -12816.005    0  602 -21944.713 -12816.005  41.6%     -  839s
     0     0 -12844.780    0  618 -21944.713 -12844.780  41.5%     -  848s
     0     0 -12849.366    0  601 -21944.713 -12849.366  41.4%     -  851s
     0     0 -12852.948    0  611 -21944.713 -12852.948  41.4%     -  853s
     0     0 -12853.795    0  609 -21944.713 -12853.795  41.4%     -  855s
     0     0 -12870.056    0  588 -21944.713 -12870.056  41.4%     -  861s
     0     0 -12877.590    0  604 -21944.713 -12877.590  41.3%     -  864s
     0     0 -12878.373    0  601 -21944.713 -12878.373  41.3%     -  865s
     0     0 -12885.306    0  609 -21944.713 -12885.306  41.3%     -  871s
     0     0 -12886.800    0  600 -21944.713 -12886.800  41.3%     -  872s
     0     0 -12889.590    0  604 -21944.713 -12889.590  41.3%     -  877s
     0     0 -12889.590    0  604 -21944.713 -12889.590  41.3%     -  877s
     0     0 -12889.591    0  604 -21944.713 -12889.591  41.3%     -  884s
     0     2 -12889.614    0  604 -21944.713 -12889.614  41.3%     -  991s
     1     3 -13214.526    1  296 -21944.713 -12889.614  41.3%  6371 1005s
     2     5 -13416.102    2  319 -21944.713 -12889.614  41.3%  5152 1016s
     4    10 -13104.667    2  601 -21944.713 -12962.207  40.9%  5323 1028s
     9    20 -13175.217    3  656 -21944.713 -13012.497  40.7%  4789 1064s
    19    37 -13284.912    4  648 -21944.713 -13175.228  40.0%  6213 1085s
    38    49 -13615.070    5  633 -21944.713 -13285.181  39.5%  9041 1116s
    50    68 -14004.880    6  554 -21944.713 -13285.181  39.5%  9261 1149s
H   54    68                    -21916.41897 -13285.181  39.4%  9166 1149s
    75   107 -14213.760    7  543 -21916.419 -13285.181  39.4%  8684 1187s
   128   199 -14233.217    8  281 -21916.419 -13285.181  39.4%  7773 1220s
   240   275 -14320.508   13  507 -21916.419 -13285.181  39.4%  5173 1245s
   324   334 -14891.648   15  491 -21916.419 -13285.181  39.4%  4423 1266s
   395   400 -14892.238   16  489 -21916.419 -13285.181  39.4%  4042 1287s
   472   450 -14949.374   17  577 -21916.419 -13285.181  39.4%  3730 1307s
   526   516 -15096.769   19  506 -21916.419 -13285.181  39.4%  3537 1326s
   605   566 -15008.136   18  579 -21916.419 -13285.181  39.4%  3334 1343s
   671   627 -15058.429   19  573 -21916.419 -13285.181  39.4%  3193 1362s
   746   658 -15290.443   22  561 -21916.419 -13285.181  39.4%  3101 1379s
   793   693 -17008.532   23  239 -21916.419 -13285.181  39.4%  3075 1398s
   852   715 -17238.692   24  377 -21916.419 -13285.181  39.4%  2975 1422s
   880   743 -17415.016   25  469 -21916.419 -13285.181  39.4%  2978 1454s
   916   768 -18022.564   26  389 -21916.419 -13285.181  39.4%  2964 1475s
   973   830 -18086.793   27  508 -21916.419 -13285.181  39.4%  2896 1495s
  1049   866 -19588.630   29  490 -21916.419 -13285.181  39.4%  2804 1517s
  1103   921 -19653.862   30  493 -21916.419 -13285.181  39.4%  2760 1538s
  1182   998 -19660.315   31  446 -21916.419 -13285.181  39.4%  2656 1557s
  1297  1101 -19672.003   32  442 -21916.419 -13285.181  39.4%  2506 1579s
  1438  1221 -20248.402   33  343 -21916.419 -13451.088  38.6%  2359 1602s
  1590  1380 -20254.712   34  362 -21916.419 -13451.088  38.6%  2219 1622s
  1781  1576 -20404.924   35  363 -21916.419 -13451.088  38.6%  2052 1643s
  2017  1782 -20526.407   37  353 -21916.419 -13460.268  38.6%  1884 1660s
  2278  1929 -21107.524   42  358 -21916.419 -13460.268  38.6%  1743 1683s
  2541  2045 -21362.809   45  416 -21916.419 -13460.268  38.6%  1626 1707s
  2761  2133 infeasible   50      -21916.419 -13460.268  38.6%  1564 1735s
  2964  2212 infeasible   25      -21916.419 -13621.785  37.8%  1512 1764s
  3120  2367 -20280.058   20  192 -21916.419 -13621.785  37.8%  1490 1795s
  3337  2469     cutoff   21      -21916.419 -13621.785  37.8%  1460 1826s
  3576  2548 infeasible   65      -21916.419 -13673.404  37.6%  1422 1858s
  3719  2644 -15466.397    7  503 -21916.419 -13673.404  37.6%  1419 1898s
  3877  2703 -15879.648    8  503 -21916.419 -13673.404  37.6%  1411 1930s
  4041  2806 -16119.002    9  509 -21916.419 -13744.286  37.3%  1419 1963s
  4208  2807 -18186.584   60  604 -21916.419 -13744.286  37.3%  1426 2389s
  4210  2808 -16999.336   49  580 -21916.419 -13744.286  37.3%  1425 2415s
  4211  2809 -14578.645   10  603 -21916.419 -13744.286  37.3%  1425 2502s
  4212  2810 -18192.124   66  627 -21916.419 -13744.286  37.3%  1425 2556s
  4213  2810 -21277.625   75  624 -21916.419 -13744.286  37.3%  1424 2585s
  4214  2811 -21607.074   97  658 -21916.419 -13744.286  37.3%  1424 2611s
  4215  2812 -13811.495    6  660 -21916.419 -13744.286  37.3%  1423 2638s
  4216  2812 -17189.904   22  639 -21916.419 -13744.286  37.3%  1423 2652s
  4217  2813 -17400.991   53  660 -21916.419 -13744.286  37.3%  1423 2662s
  4218  2814 -13989.489    8  650 -21916.419 -13744.286  37.3%  1422 2671s
  4219  2814 -19643.006   97  744 -21916.419 -13744.286  37.3%  1422 2684s
  4220  2815 -21295.594  100  668 -21916.419 -13744.286  37.3%  1422 2695s
  4221  2816 -21403.756   99  650 -21916.419 -13744.286  37.3%  1421 2704s
  4222  2816 -18396.778   67  650 -21916.419 -13744.286  37.3%  1421 2713s
  4223  2817 -21475.092   80  641 -21916.419 -13744.286  37.3%  1421 2720s
  4225  2818 -14427.717   26  645 -21916.419 -13744.286  37.3%  1420 2726s
  4226  2819 -21037.619  107  651 -21916.419 -13744.286  37.3%  1420 2732s
  4227  2820 -17688.028   48  708 -21916.419 -13744.286  37.3%  1419 2737s
  4229  2821 -17421.835   48  718 -21916.419 -13744.286  37.3%  1419 2749s
  4230  2822 -14725.974   17  606 -21916.419 -13744.286  37.3%  1418 2774s
  4231  2822 -21089.173   73  596 -21916.419 -13744.286  37.3%  1418 2781s
  4233  2824 -21061.711  100  671 -21916.419 -13744.286  37.3%  1417 2787s
  4235  2825 -17511.387   44  670 -21916.419 -13744.286  37.3%  1417 2797s
  4236  2826 -21040.522   78  648 -21916.419 -13744.286  37.3%  1416 2825s
  4237  2826 -16395.216   38  702 -21916.419 -13744.286  37.3%  1416 2834s
  4238  2827 -20158.670  115  716 -21916.419 -13744.286  37.3%  1416 2838s
  4239  2828 -17871.646   54  661 -21916.419 -13744.286  37.3%  1415 2841s
  4240  2828 -18652.368   55  737 -21916.419 -13744.286  37.3%  1415 2851s
  4241  2829 -17008.551   24  653 -21916.419 -13744.286  37.3%  1415 2867s
  4242  2830 -15060.666   21  663 -21916.419 -13744.286  37.3%  1414 2873s
  4243  2830 -19352.444   87  531 -21916.419 -13744.286  37.3%  1414 2876s
  4244  2831 -18078.340   62  710 -21916.419 -13744.286  37.3%  1414 2885s
  4245  2832 -16445.351   30  662 -21916.419 -13744.286  37.3%  1413 2913s
  4246  2832 -20813.878  110  595 -21916.419 -13744.286  37.3%  1413 2918s
  4247  2833 -18478.194   28  684 -21916.419 -13744.286  37.3%  1413 2923s
  4248  2834 -21443.842   40  681 -21916.419 -13744.286  37.3%  1412 2933s
  4249  2834 -21301.064   45  660 -21916.419 -13744.286  37.3%  1412 2951s
  4250  2835 -20620.772   63  676 -21916.419 -13744.286  37.3%  1412 2955s
  4251  2836 -18489.667   27  612 -21916.419 -13744.286  37.3%  1411 2963s
  4252  2836 -15209.866   20  689 -21916.419 -13744.286  37.3%  1411 2977s
  4253  2837 -19079.804   48  682 -21916.419 -13744.286  37.3%  1411 2981s
  4254  2838 -15771.127   35  683 -21916.419 -13744.286  37.3%  1410 2992s
  4255  2838 -17219.254   35  612 -21916.419 -13744.286  37.3%  1410 3003s
  4256  2839 -21840.499   95  608 -21916.419 -13744.286  37.3%  1410 3011s
  4257  2840 -15008.020   18  681 -21916.419 -13744.286  37.3%  1409 3030s
  4258  2840 -17287.615   38  611 -21916.419 -13744.286  37.3%  1409 3038s
  4259  2841 -20616.971  107  671 -21916.419 -13744.286  37.3%  1409 3051s
  4260  2842 -14613.594   11  675 -21916.419 -13744.286  37.3%  1408 3060s
  4261  2842 -20031.669   96  681 -21916.419 -13744.286  37.3%  1408 3071s
  4262  2843 -20598.790   65  681 -21916.419 -13744.286  37.3%  1408 3102s
  4263  2844 -20842.371   97  681 -21916.419 -13744.286  37.3%  1407 3167s
  4264  2847 -13744.286   13  627 -21916.419 -13744.286  37.3%  1490 3225s
  4266  2851 -13941.689   14  646 -21916.419 -13744.286  37.3%  1492 3257s
  4270  2857 -14075.055   15  644 -21916.419 -13843.250  36.8%  1497 3300s
  4278  2869 -14330.723   16  673 -21916.419 -13998.796  36.1%  1509 3362s
  4294  2875 infeasible   17      -21916.419 -14183.347  35.3%  1541 3419s
  4308  2896 -16228.245   18  293 -21916.419 -14183.347  35.3%  1596 3511s
  4337  2979 -16425.853   19  296 -21916.419 -14184.682  35.3%  1658 3563s
  4444  2992 -17053.308   24  246 -21916.419 -14184.682  35.3%  1782 3597s

Cutting planes:
  Learned: 1
  Implied bound: 15
  Projected implied bound: 189
  MIR: 1580
  Flow cover: 2512
  RLT: 73
  Relax-and-lift: 312

Explored 4507 nodes (8872315 simplex iterations) in 3600.05 seconds (4992.63 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -21916.4 -21944.7 -21970.9 ... -26519.3

Time limit reached
Best objective -2.191641897139e+04, best bound -1.418468202544e+04, gap 35.2783%
  WARNING: Time limit reached. Using best solution found (gap: 35.28%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -21916.42, θ = 90470.21
  Upper Bound (UB) = -21916.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 90470.21
  [DEBUG]   ✓ Scenario 0: θ = 90470.21 ≤ Q = 90470.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 90470.21 ≤ Q = 90470.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 90470.21 ≤ Q = 90470.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 90470.21 ≤ Q = 90470.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 90470.21 ≤ Q = 90470.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 90470.21 ≤ Q = 90470.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 90470.21 ≤ Q = 90470.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 90470.21 ≤ Q = 90470.21 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 90470.21 ≤ Q = 90470.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 90470.21 ≤ Q = 90470.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 90470.21 ≤ Q = 90470.21 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x430f445b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbcf0bba5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-15, 2e+02]
Found heuristic solution: objective 1.398749e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.01s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 7654412.5834
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.060555e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -106055.50    0  121 7654412.58 -106055.50   101%     -    0s
H    0     0                    -72143.02071 -106055.50  47.0%     -    0s
H    0     0                    -73124.22803 -106055.50  45.0%     -    0s
     0     0 -84774.727    0  133 -73124.228 -84774.727  15.9%     -    0s
H    0     0                    -81446.67000 -84668.050  3.96%     -    0s
H    0     0                    -82081.02649 -84284.663  2.68%     -    0s
     0     0 -84284.663    0  131 -82081.026 -84284.663  2.68%     -    0s
     0     0 -84003.560    0  131 -82081.026 -84003.560  2.34%     -    0s
     0     0 -83920.988    0  131 -82081.026 -83920.988  2.24%     -    0s
     0     0 -83920.988    0  131 -82081.026 -83920.988  2.24%     -    0s
     0     0 -83576.809    0  123 -82081.026 -83576.809  1.82%     -    0s
H    0     0                    -82087.55882 -83533.280  1.76%     -    0s
     0     0 -83533.280    0  133 -82087.559 -83533.280  1.76%     -    0s
     0     0 -83451.541    0  121 -82087.559 -83451.541  1.66%     -    0s
     0     0 -83439.158    0  125 -82087.559 -83439.158  1.65%     -    0s
     0     0 -82935.003    0  112 -82087.559 -82935.003  1.03%     -    0s
     0     0 -82842.961    0  118 -82087.559 -82842.961  0.92%     -    0s
     0     0 -82743.288    0   98 -82087.559 -82743.288  0.80%     -    0s
     0     0 -82716.433    0  106 -82087.559 -82716.433  0.77%     -    0s
     0     0 -82703.716    0   86 -82087.559 -82703.716  0.75%     -    0s
     0     0 -82665.623    0  108 -82087.559 -82665.623  0.70%     -    0s
     0     0 -82592.644    0   99 -82087.559 -82592.644  0.62%     -    0s
     0     0 -82592.165    0   99 -82087.559 -82592.165  0.61%     -    0s
     0     0 -82552.943    0   77 -82087.559 -82552.943  0.57%     -    0s
     0     0 -82542.921    0   75 -82087.559 -82542.921  0.55%     -    0s
     0     0 -82515.302    0   75 -82087.559 -82515.302  0.52%     -    0s
     0     0 -82503.223    0   75 -82087.559 -82503.223  0.51%     -    0s
     0     2 -82503.223    0   75 -82087.559 -82503.223  0.51%     -    0s
H   28     1                    -82089.97798 -82217.116  0.15%  17.9    0s
H   59    14                    -82092.32474 -82144.780  0.06%  11.4    0s
H   61    14                    -82102.26803 -82144.780  0.05%  11.1    0s

Cutting planes:
  Gomory: 12
  Implied bound: 6
  MIR: 192
  Flow cover: 12
  RLT: 89

Explored 119 nodes (1833 simplex iterations) in 0.20 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -82102.3 -82092.3 -82090 ... 1.39875e+13
No other solutions better than -82102.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.210226803444e+04, best bound -8.210226803444e+04, gap 0.0000%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 90455.50
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82102.27
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -82102.27 = 90455.50
  [DEBUG]   Current θ from Master = 90470.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14.71 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21931.13
  Lower Bound (LB) = -20721.31
  Gap (UB-LB) = -1195.1043, Absolute Gap = 1195.1043, Relative Gap = -0.054530
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = -21916.42, LB = -20721.31, Gap = -1195.10
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x0d33e3cb
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 3.53s
Presolved: 100023 rows, 42700 columns, 606983 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431458.6812
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 613
 AA' NZ     : 3.659e+06
 Factor NZ  : 8.480e+06 (roughly 130 MB of memory)
 Factor Ops : 1.584e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84754396e+07  1.70139212e+08  9.69e+04 1.69e+01  7.84e+04     5s
   1  -1.38593531e+07  1.51651341e+08  6.62e+04 6.13e+01  5.32e+04     6s
   2  -5.13530499e+06  1.15991831e+08  2.41e+04 6.71e-01  2.05e+04     6s
   3  -7.23646130e+05  8.05469232e+07  1.33e+03 1.55e+00  1.50e+03     6s
   4  -4.51742814e+05  2.78884961e+07  2.98e+02 3.36e-01  3.65e+02     6s
   5  -3.75315271e+05  1.91661983e+07  1.49e+02 2.04e-01  2.03e+02     6s
   6  -2.17063003e+05  1.51063557e+07  1.63e+01 1.51e-01  9.30e+01     6s
   7  -1.54353700e+05  9.72862574e+06  3.37e+00 9.35e-02  5.53e+01     6s
   8  -1.08137382e+05  4.66525623e+06  2.04e+00 4.35e-02  2.65e+01     6s
   9  -5.99443366e+04  8.92578860e+05  6.61e-01 7.37e-03  5.23e+00     6s
  10  -4.63459791e+04  3.82304721e+05  4.54e-01 3.00e-03  2.35e+00     6s
  11  -3.55369058e+04  2.13513710e+05  2.61e-01 1.68e-03  1.36e+00     6s
  12  -2.75860468e+04  1.15940309e+05  1.63e-01 8.94e-04  7.84e-01     6s
  13  -2.22182629e+04  7.90462715e+04  1.17e-01 7.51e-04  5.53e-01     6s
  14  -1.70704848e+04  5.40070491e+04  8.10e-02 1.22e-03  3.88e-01     6s
  15  -1.56571513e+04  4.70916991e+04  7.22e-02 1.11e-03  3.43e-01     7s
  16  -1.27372797e+04  3.03531522e+04  5.66e-02 9.59e-04  2.35e-01     7s
  17  -1.02896604e+04  2.42718013e+04  4.39e-02 1.52e-03  1.89e-01     7s
  18  -7.92934447e+03  1.64821500e+04  3.29e-02 9.55e-04  1.33e-01     7s
  19  -6.63750602e+03  1.21077111e+04  2.72e-02 7.03e-04  1.02e-01     7s
  20  -5.35397481e+03  1.07994912e+04  2.21e-02 6.10e-04  8.82e-02     7s
  21  -4.43164315e+03  8.97972143e+03  1.85e-02 5.66e-04  7.32e-02     7s
  22  -3.24052204e+03  7.26591341e+03  1.37e-02 5.35e-04  5.73e-02     7s
  23  -2.70686861e+03  6.40890081e+03  1.15e-02 4.74e-04  4.97e-02     7s
  24  -2.06690914e+03  4.53048251e+03  8.97e-03 3.17e-04  3.60e-02     7s
  25  -1.73781859e+03  3.88255585e+03  7.56e-03 2.69e-04  3.07e-02     7s
  26  -1.54749535e+03  2.58399326e+03  6.74e-03 1.76e-04  2.25e-02     7s
  27  -9.27673456e+02  2.16277309e+03  4.42e-03 1.45e-04  1.69e-02     8s
  28  -7.53077095e+02  1.91556247e+03  3.71e-03 1.27e-04  1.46e-02     8s
  29  -5.80007563e+02  1.73776626e+03  3.02e-03 1.13e-04  1.26e-02     8s
  30  -4.47724434e+02  1.37836420e+03  2.55e-03 8.46e-05  9.96e-03     8s
  31  -2.52791697e+02  1.20484667e+03  1.89e-03 7.04e-05  7.95e-03     8s
  32  -2.04448053e+02  1.03214040e+03  1.70e-03 5.68e-05  6.75e-03     8s
  33  -1.04061170e+02  9.08280942e+02  1.38e-03 4.68e-05  5.52e-03     8s
  34  -1.23472489e-01  8.19768230e+02  1.02e-03 4.13e-05  4.47e-03     8s
  35   4.70729552e+01  7.42532690e+02  8.73e-04 3.41e-05  3.79e-03     8s
  36   6.62311999e+01  7.21688922e+02  8.13e-04 3.23e-05  3.58e-03     9s
  37   1.14368786e+02  6.14726556e+02  6.56e-04 2.32e-05  2.73e-03     9s
  38   1.82313843e+02  5.61541495e+02  4.38e-04 1.88e-05  2.07e-03     9s
  39   2.03732419e+02  5.00638868e+02  3.70e-04 1.38e-05  1.62e-03     9s
  40   2.32258935e+02  4.76739683e+02  2.89e-04 1.19e-05  1.33e-03     9s
  41   2.51289237e+02  4.25627494e+02  2.28e-04 7.48e-06  9.51e-04     9s
  42   2.65391819e+02  4.00554340e+02  1.84e-04 5.42e-06  7.37e-04     9s
  43   2.87443406e+02  3.93134309e+02  1.22e-04 4.83e-06  5.77e-04     9s
  44   2.97615015e+02  3.73225222e+02  9.15e-05 3.21e-06  4.12e-04    10s
  45   3.08336276e+02  3.67385190e+02  6.14e-05 2.76e-06  3.22e-04    10s
  46   3.14012596e+02  3.59589421e+02  4.58e-05 2.12e-06  2.49e-04    10s
  47   3.20550938e+02  3.48001408e+02  2.84e-05 2.37e-06  1.50e-04    10s
  48   3.25698750e+02  3.42170258e+02  1.51e-05 1.62e-06  8.98e-05    10s
  49   3.28992487e+02  3.39365634e+02  6.96e-06 1.91e-06  5.66e-05    10s
  50   3.29655369e+02  3.35636935e+02  5.46e-06 9.10e-07  3.26e-05    10s
  51   3.30378874e+02  3.33580988e+02  3.93e-06 7.31e-07  1.75e-05    10s
  52   3.31708332e+02  3.32837337e+02  1.05e-06 3.12e-07  6.16e-06    10s
  53   3.31904044e+02  3.32499219e+02  6.70e-07 1.28e-07  3.25e-06    10s
  54   3.32189574e+02  3.32284929e+02  1.60e-07 6.72e-09  5.20e-07    11s
  55   3.32260509e+02  3.32264434e+02  2.97e-08 2.74e-10  2.14e-08    11s
  56   3.32263354e+02  3.32263355e+02  8.42e-10 1.81e-10  6.76e-12    11s

Barrier solved model in 56 iterations and 10.83 seconds (10.20 work units)
Optimal objective 3.32263354e+02


Root crossover log...

   69090 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    4940 PPushes remaining with PInf 1.1085531e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.5606687e-01     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34931    3.3226335e+02   0.000000e+00   3.560669e-01     15s
   34932    3.3226335e+02   0.000000e+00   0.000000e+00     15s
   34932    3.3226335e+02   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.322634e+02, 34932 iterations, 10.31 seconds (13.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  332.26335    0  681 -180243.66  332.26335   100%     -   16s
H    0     0                    -168585.9614  332.26335   100%     -   16s
H    0     0                    -113916.2536  332.26335   100%     -   16s
H    0     0                    -112644.6611  332.26335   100%     -   17s
H    0     0                    -67366.30855  332.26335   100%     -   18s
H    0     0                    -67240.25003  332.26335   100%     -   18s
H    0     0                    -45519.50603  332.26335   101%     -   18s
H    0     0                    -45391.85378  332.26335   101%     -   18s
H    0     0                    -32929.12190  332.26335   101%     -   22s
H    0     0                    -32627.08861  332.26335   101%     -   22s
     0     0 -3268.0966    0  726 -32627.089 -3268.0966  90.0%     -   95s
H    0     0                    -32190.32788 -3268.3412  89.8%     -   96s
     0     0 -4006.5319    0  727 -32190.328 -4006.5319  87.6%     -  134s
     0     0 -4124.1980    0  722 -32190.328 -4124.1980  87.2%     -  147s
     0     0 -4142.9387    0  722 -32190.328 -4142.9387  87.1%     -  151s
     0     0 -4146.3097    0  715 -32190.328 -4146.3097  87.1%     -  160s
     0     0 -4228.1860    0  714 -32190.328 -4228.1860  86.9%     -  165s
     0     0 -4228.1877    0  714 -32190.328 -4228.1877  86.9%     -  166s
H    0     0                    -29400.33194 -6451.6624  78.1%     -  270s
H    0     0                    -29263.08071 -6451.6624  78.0%     -  270s
H    0     0                    -29241.57618 -6451.6624  77.9%     -  270s
     0     0 -6756.4337    0  686 -29241.576 -6756.4337  76.9%     -  270s
H    0     0                    -29143.07671 -6756.4337  76.8%     -  271s
H    0     0                    -29140.57993 -6756.4337  76.8%     -  271s
H    0     0                    -28282.92845 -7955.9852  71.9%     -  352s
H    0     0                    -28261.55840 -7955.9852  71.8%     -  352s
H    0     0                    -28251.69156 -7955.9852  71.8%     -  352s
H    0     0                    -28241.32194 -7955.9852  71.8%     -  352s
H    0     0                    -28107.84514 -7955.9852  71.7%     -  352s
H    0     0                    -26873.76293 -7955.9852  70.4%     -  352s
H    0     0                    -26853.85008 -7955.9852  70.4%     -  352s
H    0     0                    -26674.38424 -7955.9852  70.2%     -  352s
H    0     0                    -26671.62163 -7955.9852  70.2%     -  352s
H    0     0                    -26670.31758 -7955.9852  70.2%     -  352s
     0     0 -7955.9852    0  760 -26670.318 -7955.9852  70.2%     -  352s
     0     0 -8184.0764    0  689 -26670.318 -8184.0764  69.3%     -  376s
     0     0 -8290.1394    0  763 -26670.318 -8290.1394  68.9%     -  400s
     0     0 -8534.1131    0  738 -26670.318 -8534.1131  68.0%     -  416s
     0     0 -8596.5851    0  698 -26670.318 -8596.5851  67.8%     -  422s
     0     0 -8801.8531    0  749 -26670.318 -8801.8531  67.0%     -  436s
     0     0 -8816.2384    0  746 -26670.318 -8816.2384  66.9%     -  440s
H    0     0                    -26559.69788 -8817.0760  66.8%     -  443s
     0     0 -8817.0760    0  742 -26559.698 -8817.0760  66.8%     -  443s
     0     0 -10099.283    0  514 -26559.698 -10099.283  62.0%     -  538s
H    0     0                    -26552.66036 -10099.850  62.0%     -  538s
H    0     0                    -26549.89776 -10099.850  62.0%     -  538s
H    0     0                    -26548.69641 -10099.850  62.0%     -  539s
     0     0 -10446.270    0  507 -26548.696 -10446.270  60.7%     -  570s
     0     0 -10473.840    0  661 -26548.696 -10473.840  60.5%     -  586s
     0     0 -10498.697    0  584 -26548.696 -10498.697  60.5%     -  599s
     0     0 -10518.346    0  526 -26548.696 -10518.346  60.4%     -  614s
     0     0 -10523.634    0  516 -26548.696 -10523.634  60.4%     -  621s
     0     0 -10530.624    0  518 -26548.696 -10530.624  60.3%     -  624s
     0     0 -10533.295    0  514 -26548.696 -10533.295  60.3%     -  627s
     0     0 -10588.449    0  515 -26548.696 -10588.449  60.1%     -  645s
     0     0 -10658.994    0  510 -26548.696 -10658.994  59.9%     -  656s
     0     0 -10671.664    0  507 -26548.696 -10671.664  59.8%     -  666s
     0     0 -10675.817    0  485 -26548.696 -10675.817  59.8%     -  672s
     0     0 -10805.756    0  532 -26548.696 -10805.756  59.3%     -  694s
     0     0 -10855.174    0  544 -26548.696 -10855.174  59.1%     -  705s
     0     0 -10858.473    0  544 -26548.696 -10858.473  59.1%     -  707s
     0     0 -10864.486    0  522 -26548.696 -10864.486  59.1%     -  709s
     0     0 -10967.086    0  529 -26548.696 -10967.086  58.7%     -  717s
     0     0 -10977.431    0  535 -26548.696 -10977.431  58.7%     -  721s
     0     0 -10994.562    0  542 -26548.696 -10994.562  58.6%     -  727s
     0     0 -10995.193    0  546 -26548.696 -10995.193  58.6%     -  728s
     0     0 -11759.138    0  745 -26548.696 -11759.138  55.7%     -  787s
H    0     0                    -26531.65465 -11759.165  55.7%     -  789s
H    0     0                    -26520.96947 -11759.165  55.7%     -  789s
     0     0 -11882.112    0  693 -26520.969 -11882.112  55.2%     -  808s
     0     0 -11921.143    0  705 -26520.969 -11921.143  55.1%     -  818s
     0     0 -11962.483    0  699 -26520.969 -11962.483  54.9%     -  827s
     0     0 -12067.804    0  596 -26520.969 -12067.804  54.5%     -  842s
     0     0 -12090.338    0  714 -26520.969 -12090.338  54.4%     -  852s
     0     0 -12118.545    0  735 -26520.969 -12118.545  54.3%     -  863s
     0     0 -12161.647    0  785 -26520.969 -12161.647  54.1%     -  875s
     0     0 -12171.476    0  792 -26520.969 -12171.476  54.1%     -  881s
     0     0 -12176.130    0  788 -26520.969 -12176.130  54.1%     -  886s
     0     0 -12178.279    0  790 -26520.969 -12178.279  54.1%     -  889s
     0     0 -12180.144    0  799 -26520.969 -12180.144  54.1%     -  891s
     0     0 -12180.372    0  796 -26520.969 -12180.372  54.1%     -  892s
     0     0 -12314.224    0  518 -26520.969 -12314.224  53.6%     -  924s
     0     0 -12420.008    0  527 -26520.969 -12420.008  53.2%     -  938s
     0     0 -12435.959    0  535 -26520.969 -12435.959  53.1%     -  946s
     0     0 -12442.537    0  604 -26520.969 -12442.537  53.1%     -  951s
     0     0 -12445.614    0  597 -26520.969 -12445.614  53.1%     -  954s
     0     0 -12447.758    0  665 -26520.969 -12447.758  53.1%     -  956s
     0     0 -12449.859    0  665 -26520.969 -12449.859  53.1%     -  959s
     0     0 -12451.469    0  658 -26520.969 -12451.469  53.1%     -  961s
     0     0 -12559.651    0  620 -26520.969 -12559.651  52.6%     -  984s
H    0     0                    -23468.70127 -12559.900  46.5%     - 1000s
H    0     0                    -22942.85452 -12559.900  45.3%     - 1003s
H    0     0                    -22709.40018 -12559.900  44.7%     - 1004s
H    0     0                    -22442.66788 -12559.900  44.0%     - 1005s
H    0     0                    -22413.52877 -12559.900  44.0%     - 1005s
     0     0 -12574.273    0  693 -22413.529 -12574.273  43.9%     - 1012s
     0     0 -12585.693    0  797 -22413.529 -12585.693  43.8%     - 1017s
     0     0 -12590.054    0  625 -22413.529 -12590.054  43.8%     - 1021s
     0     0 -12591.935    0  630 -22413.529 -12591.935  43.8%     - 1022s
     0     0 -12617.413    0  579 -22413.529 -12617.413  43.7%     - 1034s
H    0     0                    -22335.08824 -12618.065  43.5%     - 1035s
     0     0 -12626.939    0  632 -22335.088 -12626.939  43.5%     - 1040s
     0     0 -12628.478    0  637 -22335.088 -12628.478  43.5%     - 1043s
     0     0 -12664.893    0  646 -22335.088 -12664.893  43.3%     - 1056s
H    0     0                    -22037.70838 -12664.979  42.5%     - 1059s
     0     0 -12731.708    0  639 -22037.708 -12731.708  42.2%     - 1102s
     0     0 -12745.153    0  667 -22037.708 -12745.153  42.2%     - 1110s
     0     0 -12749.720    0  661 -22037.708 -12749.720  42.1%     - 1114s
     0     0 -12753.890    0  597 -22037.708 -12753.890  42.1%     - 1118s
     0     0 -12835.911    0  648 -22037.708 -12835.911  41.8%     - 1133s
     0     0 -12842.512    0  657 -22037.708 -12842.512  41.7%     - 1138s
     0     0 -12846.469    0  678 -22037.708 -12846.469  41.7%     - 1141s
     0     0 -12847.275    0  679 -22037.708 -12847.275  41.7%     - 1143s
     0     0 -12901.219    0  759 -22037.708 -12901.219  41.5%     - 1166s
     0     0 -12980.814    0  847 -22037.708 -12980.814  41.1%     - 1191s
     0     0 -12991.352    0  852 -22037.708 -12991.352  41.0%     - 1199s
     0     0 -12994.813    0  846 -22037.708 -12994.813  41.0%     - 1203s
     0     0 -13001.520    0  846 -22037.708 -13001.520  41.0%     - 1206s
     0     0 -13001.520    0  846 -22037.708 -13001.520  41.0%     - 1207s
     0     0 -13002.787    0  860 -22037.708 -13002.787  41.0%     - 1209s
     0     0 -13024.730    0  750 -22037.708 -13024.730  40.9%     - 1222s
H    0     0                    -21997.97379 -13024.761  40.8%     - 1225s
H    0     0                    -21970.94763 -13024.761  40.7%     - 1225s
H    0     0                    -21944.71338 -13024.761  40.6%     - 1227s
     0     0 -13029.236    0  684 -21944.713 -13029.236  40.6%     - 1247s
     0     0 -13031.592    0  690 -21944.713 -13031.592  40.6%     - 1250s
     0     0 -13037.260    0  694 -21944.713 -13037.260  40.6%     - 1253s
     0     0 -13037.784    0  697 -21944.713 -13037.784  40.6%     - 1255s
     0     0 -13052.742    0  762 -21944.713 -13052.742  40.5%     - 1264s
     0     0 -13062.263    0  780 -21944.713 -13062.263  40.5%     - 1272s
     0     0 -13064.836    0  695 -21944.713 -13064.836  40.5%     - 1275s
     0     0 -13066.165    0  703 -21944.713 -13066.165  40.5%     - 1277s
     0     0 -13072.042    0  631 -21944.713 -13072.042  40.4%     - 1284s
     0     0 -13079.112    0  633 -21944.713 -13079.112  40.4%     - 1326s
     0     0 -13082.053    0  697 -21944.713 -13082.053  40.4%     - 1330s
     0     0 -13083.637    0  699 -21944.713 -13083.637  40.4%     - 1332s
     0     0 -13090.704    0  699 -21944.713 -13090.704  40.3%     - 1340s
     0     0 -13092.690    0  628 -21944.713 -13092.690  40.3%     - 1344s
     0     0 -13099.372    0  701 -21944.713 -13099.372  40.3%     - 1352s
     0     0 -13099.436    0  701 -21944.713 -13099.436  40.3%     - 1361s
     0     2 -13099.522    0  701 -21944.713 -13099.522  40.3%     - 1474s
     1     3 -13151.265    1  592 -21944.713 -13099.630  40.3%  4116 1483s
     2     4 -13188.850    1  658 -21944.713 -13151.284  40.1%  4074 1495s
     3     7 -13468.848    2  670 -21944.713 -13153.784  40.1%  5210 1510s
     6    12 -13452.370    3  659 -21944.713 -13188.861  39.9%  6443 1562s
    11    23 -13876.542    4  789 -21944.713 -13267.851  39.5%  9994 1596s
    22    30 -14038.023    4  595 -21944.713 -13454.712  38.7% 13646 2813s
    33    56 -14571.193    5  656 -21944.713 -13511.273  38.4% 19060 3071s
    59    88 -15461.760    6  665 -21944.713 -13518.527  38.4% 21083 3158s
    91   198 -15498.227    7  668 -21944.713 -13518.527  38.4% 17852 3242s
H  100   198                    -21931.12818 -13518.527  38.4% 16777 3242s
H  199   198                    -21930.08354 -13518.527  38.4% 12259 3242s
   207   299 -15595.806    8  776 -21930.084 -13518.527  38.4% 12245 3290s
   320   372 -20963.744   17  184 -21930.084 -13518.527  38.4%  9579 3325s
   410   406 -16757.025    8  257 -21930.084 -13518.527  38.4%  8362 3355s
   484   438 -20775.075   24  227 -21930.084 -13518.527  38.4%  7818 3382s
   546   481 -18348.332    9  198 -21930.084 -13518.527  38.4%  7393 3406s
   626   519 -18576.393   11  189 -21930.084 -13518.527  38.4%  7131 3431s
   692   566 -19249.665   15  155 -21930.084 -13518.527  38.4%  6856 3457s
   772   596 -21190.668   18  212 -21930.084 -13518.527  38.4%  6604 3480s
   830   662 -21626.262   21  186 -21930.084 -13518.527  38.4%  6513 3505s
   915   724 infeasible   26      -21930.084 -13518.527  38.4%  6316 3526s
   987   790 -15582.541    9  294 -21930.084 -13518.527  38.4%  6196 3550s
  1071   870 -16746.784   10  432 -21930.084 -13518.527  38.4%  6052 3572s
  1177   982 -17018.006   11  263 -21930.084 -13518.527  38.4%  5802 3596s
  1299  1002 -19708.008   36  345 -21930.084 -13518.527  38.4%  5586 3600s

Cutting planes:
  Learned: 1
  Implied bound: 174
  MIR: 3141
  Flow cover: 3887
  Zero half: 1
  RLT: 223
  Relax-and-lift: 1123

Explored 1319 nodes (8002429 simplex iterations) in 3600.07 seconds (4436.16 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -21930.1 -21931.1 -21944.7 ... -22709.4

Time limit reached
Best objective -2.193008353822e+04, best bound -1.351852720603e+04, gap 38.3562%
  WARNING: Time limit reached. Using best solution found (gap: 38.36%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -21930.08, θ = 90575.51
  Upper Bound (UB) = -21930.08

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 90575.51
  [DEBUG]   ✓ Scenario 0: θ = 90575.51 ≤ Q = 90575.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 90575.51 ≤ Q = 90575.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 90575.51 ≤ Q = 90575.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 90575.51 ≤ Q = 90575.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 90575.51 ≤ Q = 90575.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 90575.51 ≤ Q = 90575.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 90575.51 ≤ Q = 90575.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 90575.51 ≤ Q = 90575.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 90575.51 ≤ Q = 90575.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 90575.51 ≤ Q = 90575.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 90575.51 ≤ Q = 90575.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 90575.51 ≤ Q = 90575.51 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x285a8083
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd7a57f7d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.395469e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.01s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 7640884.5470
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.060162e+05, 277 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -106016.18    0  121 7640884.55 -106016.18   101%     -    0s
H    0     0                    -72125.40463 -106016.18  47.0%     -    0s
H    0     0                    -73106.61194 -106016.18  45.0%     -    0s
     0     0 -87337.259    0   54 -73106.612 -87337.259  19.5%     -    0s
H    0     0                    -85800.51098 -87227.490  1.66%     -    0s
H    0     0                    -85981.94181 -87227.490  1.45%     -    0s
     0     0 -86972.527    0   55 -85981.942 -86972.527  1.15%     -    0s
     0     0 -86683.817    0   22 -85981.942 -86683.817  0.82%     -    0s
     0     0 -86565.404    0   24 -85981.942 -86565.404  0.68%     -    0s
     0     0 -86563.827    0   24 -85981.942 -86563.827  0.68%     -    0s
     0     0 -86268.311    0   19 -85981.942 -86268.311  0.33%     -    0s
     0     0 -86152.432    0   27 -85981.942 -86152.432  0.20%     -    0s
     0     0 -86149.351    0   25 -85981.942 -86149.351  0.19%     -    0s
     0     0 -86147.349    0   25 -85981.942 -86147.349  0.19%     -    0s
     0     0 -86145.927    0   24 -85981.942 -86145.927  0.19%     -    0s
     0     0 -86027.515    0    5 -85981.942 -86027.515  0.05%     -    0s
     0     0 -86011.286    0    6 -85981.942 -86011.286  0.03%     -    0s
H    0     0                    -85992.27531 -86011.286  0.02%     -    0s
     0     0     cutoff    0      -85992.275 -85992.275  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 1
  Flow cover: 1
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (686 simplex iterations) in 0.13 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -85992.3 -85981.9 -85061.9 ... 1.39547e+13
No other solutions better than -85992.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.599227530529e+04, best bound -8.599227530529e+04, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 86565.49
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -85992.28
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -85992.28 = 86565.49
  [DEBUG]   Current θ from Master = 90575.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4010.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25940.10
  Lower Bound (LB) = -20721.31
  Gap (UB-LB) = -1208.7689, Absolute Gap = 1208.7689, Relative Gap = -0.055119
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = -21930.08, LB = -20721.31, Gap = -1208.77
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x6b357126
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 3.05s
Presolved: 108243 rows, 46070 columns, 654544 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -431370.4283
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 602
 AA' NZ     : 4.202e+06
 Factor NZ  : 1.010e+07 (roughly 140 MB of memory)
 Factor Ops : 2.244e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85055922e+07  1.82018677e+08  9.70e+04 1.59e+01  7.80e+04     5s
   1  -1.41608950e+07  1.62346378e+08  6.84e+04 5.90e+01  5.48e+04     5s
   2  -6.47862915e+06  1.26332420e+08  3.07e+04 3.86e+00  2.59e+04     5s
   3  -8.62831068e+05  9.35805096e+07  1.77e+03 1.46e+00  1.89e+03     5s
   4  -5.58374186e+05  7.10362047e+07  4.98e+02 1.03e+00  7.47e+02     5s
   5  -4.68822655e+05  3.77420015e+07  2.49e+02 4.58e-01  3.64e+02     5s
   6  -3.80159237e+05  2.85736821e+07  1.16e+02 3.30e-01  2.20e+02     5s
   7  -2.49713353e+05  1.96418578e+07  6.36e+00 2.12e-01  1.04e+02     6s
   8  -1.57086944e+05  7.65412954e+06  9.73e-01 7.78e-02  3.96e+01     6s
   9  -9.52769339e+04  3.28540210e+06  2.95e-01 3.12e-02  1.71e+01     6s
  10  -6.46543079e+04  2.00094668e+06  1.49e-01 1.87e-02  1.04e+01     6s
  11  -4.86565814e+04  1.18701574e+06  9.10e-02 1.12e-02  6.24e+00     6s
  12  -4.30088106e+04  6.26984673e+05  5.22e-02 6.11e-03  3.38e+00     6s
  13  -3.10661866e+04  2.45656146e+05  2.51e-02 2.44e-03  1.40e+00     6s
  14  -2.27657390e+04  1.30819126e+05  1.36e-02 1.21e-03  7.75e-01     6s
  15  -1.96457423e+04  9.35273483e+04  1.09e-02 8.68e-04  5.71e-01     6s
  16  -1.50527470e+04  6.66248793e+04  7.51e-03 6.26e-04  4.12e-01     6s
  17  -1.22770349e+04  3.84450917e+04  5.80e-03 3.87e-04  2.56e-01     6s
  18  -1.02005299e+04  3.19276894e+04  4.70e-03 3.06e-04  2.13e-01     6s
  19  -8.78006767e+03  2.26728731e+04  4.00e-03 2.47e-04  1.59e-01     7s
  20  -7.45009213e+03  1.87117746e+04  3.41e-03 1.85e-04  1.32e-01     7s
  21  -5.43299212e+03  1.58742914e+04  2.51e-03 1.56e-04  1.07e-01     7s
  22  -4.68482595e+03  1.43036074e+04  2.19e-03 1.40e-04  9.58e-02     7s
  23  -4.10691011e+03  1.09516240e+04  1.94e-03 1.08e-04  7.60e-02     7s
  24  -3.11282612e+03  9.57225160e+03  1.54e-03 9.20e-05  6.40e-02     7s
  25  -2.54436871e+03  8.61795373e+03  1.30e-03 8.20e-05  5.63e-02     7s
  26  -2.32861698e+03  7.91935427e+03  1.22e-03 7.52e-05  5.17e-02     7s
  27  -1.86166076e+03  6.27568026e+03  1.02e-03 5.84e-05  4.10e-02     7s
  28  -1.47518035e+03  5.07694819e+03  8.40e-04 4.64e-05  3.31e-02     8s
  29  -1.06645255e+03  3.98506864e+03  6.75e-04 3.52e-05  2.55e-02     8s
  30  -7.23149232e+02  3.63716892e+03  5.43e-04 3.16e-05  2.20e-02     8s
  31  -4.33688420e+02  2.73395528e+03  4.27e-04 2.22e-05  1.60e-02     8s
  32  -2.84903623e+02  2.48141009e+03  3.73e-04 1.92e-05  1.40e-02     8s
  33  -2.30143620e+01  2.09268768e+03  2.82e-04 1.47e-05  1.07e-02     8s
  34   1.50392447e+02  1.76262440e+03  2.22e-04 1.10e-05  8.13e-03     8s
  35   1.90100538e+02  1.70097849e+03  2.07e-04 1.03e-05  7.62e-03     8s
  36   3.33750442e+02  1.54083386e+03  1.57e-04 8.37e-06  6.09e-03     9s
  37   4.12269139e+02  1.40926466e+03  1.31e-04 6.78e-06  5.03e-03     9s
  38   4.98266604e+02  1.38228627e+03  1.04e-04 6.45e-06  4.46e-03     9s
  39   5.54941444e+02  1.22412750e+03  8.46e-05 4.66e-06  3.38e-03     9s
  40   6.18572783e+02  1.11388550e+03  6.51e-05 3.26e-06  2.50e-03     9s
  41   6.45577407e+02  1.04603950e+03  5.62e-05 2.50e-06  2.02e-03     9s
  42   7.04594740e+02  1.00774703e+03  3.87e-05 2.03e-06  1.53e-03     9s
  43   7.39410928e+02  9.67678668e+02  2.84e-05 1.52e-06  1.15e-03     9s
  44   7.48371734e+02  9.45310096e+02  2.58e-05 1.26e-06  9.93e-04     9s
  45   7.61322819e+02  9.37798263e+02  2.21e-05 1.17e-06  8.90e-04    10s
  46   7.71643741e+02  9.23933535e+02  1.92e-05 9.97e-07  7.68e-04    10s
  47   7.83628467e+02  9.08345206e+02  1.57e-05 8.16e-07  6.29e-04    10s
  48   7.87880600e+02  8.93101972e+02  1.44e-05 6.35e-07  5.31e-04    10s
  49   7.96581973e+02  8.78662095e+02  1.19e-05 4.64e-07  4.14e-04    10s
  50   8.02952624e+02  8.65295103e+02  1.01e-05 6.46e-07  3.14e-04    10s
  51   8.08097211e+02  8.58740545e+02  8.71e-06 4.44e-07  2.55e-04    10s
  52   8.10958319e+02  8.55116979e+02  7.85e-06 3.13e-07  2.23e-04    10s
  53   8.19310196e+02  8.46843530e+02  5.62e-06 7.32e-08  1.39e-04    11s
  54   8.25306186e+02  8.46114222e+02  3.94e-06 9.06e-08  1.05e-04    11s
  55   8.27830559e+02  8.42929008e+02  3.23e-06 1.89e-07  7.62e-05    11s
  56   8.30919206e+02  8.42108941e+02  2.38e-06 1.47e-07  5.64e-05    11s
  57   8.31238351e+02  8.41816529e+02  2.29e-06 1.31e-07  5.34e-05    11s
  58   8.33340001e+02  8.41430815e+02  1.71e-06 1.13e-07  4.08e-05    11s
  59   8.35733299e+02  8.40931641e+02  1.04e-06 1.13e-07  2.62e-05    11s
  60   8.36274781e+02  8.40793252e+02  8.86e-07 9.15e-08  2.28e-05    11s
  61   8.37674236e+02  8.39987711e+02  5.19e-07 7.95e-08  1.17e-05    11s
  62   8.39454022e+02  8.39786855e+02  5.35e-08 7.65e-09  1.68e-06    12s
  63   8.39682734e+02  8.39731864e+02  1.32e-08 2.25e-09  2.48e-07    12s
  64   8.39702763e+02  8.39704824e+02  7.87e-09 9.42e-12  1.04e-08    12s
  65   8.39702877e+02  8.39704768e+02  1.25e-06 4.84e-09  1.00e-08    12s
  66   8.39703180e+02  8.39704726e+02  1.43e-06 7.16e-09  8.44e-09    12s
  67   8.39703196e+02  8.39704725e+02  4.07e-06 6.89e-09  7.44e-09    12s
  68   8.39703919e+02  8.39704633e+02  1.64e-06 1.11e-08  3.43e-09    12s
  69   8.39704369e+02  8.39704604e+02  1.53e-06 7.04e-09  1.85e-09    12s
  70   8.39704294e+02  8.39704602e+02  1.11e-06 4.99e-09  1.66e-09    12s
  71   8.39704339e+02  8.39704599e+02  9.94e-07 3.85e-09  1.45e-09    13s
  72   8.39704383e+02  8.39704592e+02  7.51e-07 9.62e-09  1.19e-09    13s
  73   8.39704403e+02  8.39704585e+02  6.24e-07 6.86e-08  8.22e-10    13s
  74   8.39704413e+02  8.39704585e+02  5.91e-07 6.25e-08  7.95e-10    13s
  75   8.39704476e+02  8.39704585e+02  3.10e-07 4.99e-08  3.39e-10    13s
  76   8.39704554e+02  8.39704585e+02  1.17e-07 4.90e-08  7.33e-11    13s
  77   8.39704582e+02  8.39704585e+02  1.31e-07 2.74e-10  2.01e-11    13s

Barrier solved model in 77 iterations and 13.19 seconds (14.81 work units)
Optimal objective 8.39704582e+02


Root crossover log...

   81020 DPushes remaining with DInf 0.0000000e+00                13s
   15148 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    5667 PPushes remaining with PInf 2.4349628e-05                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9320773e+01     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40838    8.3970458e+02   0.000000e+00   1.932077e+01     17s
   40841    8.3970458e+02   0.000000e+00   0.000000e+00     18s
   40841    8.3970458e+02   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 1.58s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.397046e+02, 40841 iterations, 15.29 seconds (19.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  839.70458    0  588 -180243.66  839.70458   100%     -   20s
H    0     0                    -174093.4421  839.70458   100%     -   20s
H    0     0                    -116506.2642  839.70458   101%     -   21s
H    0     0                    -74282.66574  839.70458   101%     -   21s
H    0     0                    -67855.22217  839.70458   101%     -   21s
H    0     0                    -64677.75581  839.70458   101%     -   21s
H    0     0                    -54963.86706  839.70458   102%     -   21s
H    0     0                    -54522.77432  839.70458   102%     -   21s
H    0     0                    -54317.83022  839.70458   102%     -   21s
H    0     0                    -38467.01958  839.70458   102%     -   25s
H    0     0                    -38403.26256  839.70458   102%     -   25s
H    0     0                    -34232.32542 -3243.0759  90.5%     -  119s
H    0     0                    -33774.98078 -3243.0759  90.4%     -  119s
     0     0 -3408.8237    0  793 -33774.981 -3408.8237  89.9%     -  119s
H    0     0                    -33743.52542 -3408.8237  89.9%     -  120s
H    0     0                    -33732.55255 -3408.8237  89.9%     -  120s
H    0     0                    -33709.19137 -3408.8237  89.9%     -  120s
     0     0 -3567.8229    0  797 -33709.191 -3567.8229  89.4%     -  138s
     0     0 -3657.3417    0  789 -33709.191 -3657.3417  89.2%     -  152s
     0     0 -3657.7686    0  784 -33709.191 -3657.7686  89.1%     -  172s
     0     0 -3699.0033    0  791 -33709.191 -3699.0033  89.0%     -  185s
     0     0 -3714.6360    0  800 -33709.191 -3714.6360  89.0%     -  191s
     0     0 -3714.8149    0  807 -33709.191 -3714.8149  89.0%     -  192s
H    0     0                    -30949.73919 -6063.9112  80.4%     -  297s
H    0     0                    -30704.77902 -6063.9112  80.3%     -  297s
H    0     0                    -30605.70999 -6063.9112  80.2%     -  297s
H    0     0                    -30290.15173 -6063.9112  80.0%     -  297s
H    0     0                    -29986.56974 -6063.9112  79.8%     -  297s
     0     0 -6071.8286    0  638 -29986.570 -6071.8286  79.8%     -  297s
H    0     0                    -29539.30521 -6071.8286  79.4%     -  298s
H    0     0                    -29437.02710 -6071.8286  79.4%     -  298s
     0     0 -7629.5339    0  758 -29437.027 -7629.5339  74.1%     -  392s
     0     0 -8166.0298    0  715 -29437.027 -8166.0298  72.3%     -  457s
     0     0 -8233.6723    0  706 -29437.027 -8233.6723  72.0%     -  486s
     0     0 -8252.4530    0  726 -29437.027 -8252.4530  72.0%     -  499s
H    0     0                    -29418.93283 -8298.0717  71.8%     -  514s
H    0     0                    -29410.49124 -8298.0717  71.8%     -  514s
     0     0 -8298.0717    0  727 -29410.491 -8298.0717  71.8%     -  514s
H    0     0                    -29114.15219 -8312.3900  71.4%     -  525s
     0     0 -8312.3900    0  729 -29114.152 -8312.3900  71.4%     -  525s
     0     0 -8323.2765    0  727 -29114.152 -8323.2765  71.4%     -  538s
     0     0 -8327.0931    0  811 -29114.152 -8327.0931  71.4%     -  542s
     0     0 -8330.7838    0  815 -29114.152 -8330.7838  71.4%     -  548s
     0     0 -8331.6437    0  718 -29114.152 -8331.6437  71.4%     -  550s
H    0     0                    -29093.74518 -9664.6216  66.8%     -  696s
     0     0 -9664.6216    0  767 -29093.745 -9664.6216  66.8%     -  696s
H    0     0                    -29069.50543 -9664.9474  66.8%     -  697s
H    0     0                    -29068.27291 -9664.9474  66.8%     -  697s
H    0     0                    -24329.57819 -9861.9764  59.5%     -  749s
H    0     0                    -23853.67895 -9861.9764  58.7%     -  749s
H    0     0                    -23226.28229 -9861.9764  57.5%     -  749s
     0     0 -9861.9764    0  844 -23226.282 -9861.9764  57.5%     -  750s
H    0     0                    -22736.07834 -10040.236  55.8%     -  785s
H    0     0                    -22498.57678 -10040.236  55.4%     -  785s
H    0     0                    -22439.21395 -10040.236  55.3%     -  785s
H    0     0                    -22261.86786 -10040.236  54.9%     -  785s
H    0     0                    -22209.25588 -10040.236  54.8%     -  785s
H    0     0                    -22121.25133 -10040.236  54.6%     -  785s
     0     0 -10040.236    0  764 -22121.251 -10040.236  54.6%     -  785s
     0     0 -10061.554    0  776 -22121.251 -10061.554  54.5%     -  805s
     0     0 -10068.680    0  768 -22121.251 -10068.680  54.5%     -  814s
     0     0 -10239.459    0  835 -22121.251 -10239.459  53.7%     -  852s
H    0     0                    -22063.74437 -10460.106  52.6%     -  880s
     0     0 -10460.106    0  743 -22063.744 -10460.106  52.6%     -  880s
H    0     0                    -21991.81732 -10660.522  51.5%     -  908s
     0     0 -10660.522    0  803 -21991.817 -10660.522  51.5%     -  908s
     0     0 -10703.284    0  730 -21991.817 -10703.284  51.3%     -  924s
     0     0 -10711.923    0  730 -21991.817 -10711.923  51.3%     -  930s
     0     0 -10723.083    0  808 -21991.817 -10723.083  51.2%     -  938s
     0     0 -10736.298    0  740 -21991.817 -10736.298  51.2%     -  948s
     0     0 -10738.566    0  742 -21991.817 -10738.566  51.2%     -  951s
     0     0 -10739.075    0  744 -21991.817 -10739.075  51.2%     -  953s
     0     0 -11497.098    0  537 -21991.817 -11497.098  47.7%     - 1018s
     0     0 -11756.873    0  562 -21991.817 -11756.873  46.5%     - 1061s
     0     0 -11854.399    0  620 -21991.817 -11854.399  46.1%     - 1079s
     0     0 -11918.298    0  562 -21991.817 -11918.298  45.8%     - 1087s
     0     0 -11927.937    0  577 -21991.817 -11927.937  45.8%     - 1093s
     0     0 -11929.864    0  577 -21991.817 -11929.864  45.8%     - 1096s
     0     0 -12188.155    0  720 -21991.817 -12188.155  44.6%     - 1150s
     0     0 -12254.821    0  604 -21991.817 -12254.821  44.3%     - 1167s
     0     0 -12280.583    0  590 -21991.817 -12280.583  44.2%     - 1174s
     0     0 -12286.757    0  600 -21991.817 -12286.757  44.1%     - 1179s
     0     0 -12294.407    0  604 -21991.817 -12294.407  44.1%     - 1183s
     0     0 -12299.790    0  613 -21991.817 -12299.790  44.1%     - 1187s
     0     0 -12301.664    0  624 -21991.817 -12301.664  44.1%     - 1190s
     0     0 -12443.294    0  539 -21991.817 -12443.294  43.4%     - 1218s
     0     0 -12470.058    0  735 -21991.817 -12470.058  43.3%     - 1248s
     0     0 -12499.216    0  559 -21991.817 -12499.216  43.2%     - 1257s
     0     0 -12509.653    0  553 -21991.817 -12509.653  43.1%     - 1264s
     0     0 -12510.866    0  554 -21991.817 -12510.866  43.1%     - 1266s
     0     0 -12563.623    0  815 -21991.817 -12563.623  42.9%     - 1287s
     0     0 -12574.135    0  757 -21991.817 -12574.135  42.8%     - 1296s
     0     0 -12578.212    0  816 -21991.817 -12578.212  42.8%     - 1301s
     0     0 -12578.941    0  820 -21991.817 -12578.941  42.8%     - 1302s
     0     0 -12633.553    0  735 -21991.817 -12633.553  42.6%     - 1321s
     0     0 -12649.426    0  592 -21991.817 -12649.426  42.5%     - 1330s
     0     0 -12665.707    0  649 -21991.817 -12665.707  42.4%     - 1338s
     0     0 -12675.085    0  655 -21991.817 -12675.085  42.4%     - 1345s
     0     0 -12684.673    0  586 -21991.817 -12684.673  42.3%     - 1353s
     0     0 -12689.305    0  587 -21991.817 -12689.305  42.3%     - 1357s
     0     0 -12689.937    0  584 -21991.817 -12689.937  42.3%     - 1358s
     0     0 -12715.396    0  615 -21991.817 -12715.396  42.2%     - 1373s
     0     0 -12733.434    0  602 -21991.817 -12733.434  42.1%     - 1382s
     0     0 -12737.452    0  603 -21991.817 -12737.452  42.1%     - 1386s
     0     0 -12739.252    0  765 -21991.817 -12739.252  42.1%     - 1392s
     0     0 -12771.297    0  615 -21991.817 -12771.297  41.9%     - 1410s
H    0     0                    -21969.51403 -12771.413  41.9%     - 1413s
H    0     0                    -21944.71338 -12771.413  41.8%     - 1414s
     0     0 -12777.844    0  611 -21944.713 -12777.844  41.8%     - 1423s
     0     0 -12781.727    0  618 -21944.713 -12781.727  41.8%     - 1426s
     0     0 -12784.780    0  613 -21944.713 -12784.780  41.7%     - 1428s
     0     0 -12785.246    0  625 -21944.713 -12785.246  41.7%     - 1429s
     0     0 -12823.974    0  669 -21944.713 -12823.974  41.6%     - 1449s
     0     0 -12837.226    0  671 -21944.713 -12837.226  41.5%     - 1456s
     0     0 -12846.846    0  658 -21944.713 -12846.846  41.5%     - 1466s
     0     0 -12850.706    0  675 -21944.713 -12850.706  41.4%     - 1471s
     0     0 -12852.343    0  699 -21944.713 -12852.343  41.4%     - 1473s
     0     0 -12864.492    0  784 -21944.713 -12864.492  41.4%     - 1486s
     0     0 -12867.556    0  776 -21944.713 -12867.556  41.4%     - 1498s
     0     0 -12868.735    0  617 -21944.713 -12868.735  41.4%     - 1501s
     0     0 -12874.133    0  623 -21944.713 -12874.133  41.3%     - 1509s
     0     0 -12875.316    0  618 -21944.713 -12875.316  41.3%     - 1513s
     0     0 -12901.614    0  609 -21944.713 -12901.614  41.2%     - 1525s
     0     0 -12909.303    0  604 -21944.713 -12909.303  41.2%     - 1562s
     0     0 -12911.904    0  769 -21944.713 -12911.904  41.2%     - 1566s
     0     0 -12912.270    0  772 -21944.713 -12912.270  41.2%     - 1567s
     0     0 -12917.552    0  783 -21944.713 -12917.552  41.1%     - 1574s
     0     0 -12923.943    0  628 -21944.713 -12923.943  41.1%     - 1580s
     0     0 -12926.290    0  629 -21944.713 -12926.290  41.1%     - 1583s
     0     0 -12926.461    0  630 -21944.713 -12926.461  41.1%     - 1584s
     0     0 -12935.084    0  630 -21944.713 -12935.084  41.1%     - 1594s
     0     0 -12935.121    0  630 -21944.713 -12935.121  41.1%     - 1606s
     0     2 -12935.175    0  630 -21944.713 -12935.175  41.1%     - 1831s
     1     3 -13121.136    1  319 -21944.713 -12935.339  41.1% 10357 1851s
     2     4 -13000.754    1  612 -21944.713 -13000.754  40.8%  7358 1865s
     3     5 -14260.924    2  310 -21944.713 -13000.951  40.8%  7604 1884s
     4    10 -14792.838    3  302 -21944.713 -13000.951  40.8%  8469 1900s
     9    16 -13595.178    3  313 -21944.713 -13182.839  39.9%  6371 1947s
    15    32 -13868.089    4  324 -21944.713 -13182.839  39.9% 10297 1979s
    31    48 -14382.526    4  323 -21944.713 -13340.748  39.2% 12626 2071s
    47    80 -14111.374    6  290 -21944.713 -13340.748  39.2% 15100 2124s
H   48    80                    -21931.12818 -13340.748  39.2% 14785 2124s
    79   137 -14148.538    7  278 -21931.128 -13340.748  39.2% 11326 2295s
   136   165 -14186.031    9  282 -21931.128 -13340.748  39.2%  8995 2347s
   170   238 -14194.463   10  265 -21931.128 -13340.748  39.2%  8181 2394s
   243   316 -14248.728   12  270 -21931.128 -13340.748  39.2%  6448 2437s
H  259   316                    -21312.57384 -13340.748  37.4%  6153 2437s
   329   383 -14385.975   17  257 -21312.574 -13340.748  37.4%  5386 2478s
   420   464 -14889.816   19  351 -21312.574 -13340.748  37.4%  4827 2508s
   519   563 -15003.709   21  548 -21312.574 -13340.748  37.4%  4406 2537s
   628   651 -15435.794   22  321 -21312.574 -13340.748  37.4%  3986 2559s
   740   735 -15439.189   23  319 -21312.574 -13340.748  37.4%  3622 2581s
   846   835 -15538.926   26  372 -21312.574 -13340.748  37.4%  3357 2607s
   956   908 -15831.853   27  255 -21312.574 -13340.748  37.4%  3121 2629s
  1061   990 -15883.345   29  363 -21312.574 -13340.748  37.4%  3008 2652s
  1192  1065 -16036.289   30  271 -21312.574 -13340.748  37.4%  2838 2676s
  1293  1124 -16174.035   34  213 -21312.574 -13340.748  37.4%  2752 2699s
  1410  1191 -16226.268   37  424 -21312.574 -13340.748  37.4%  2653 2730s
  1521  1310 -16271.186   42  331 -21312.574 -13340.748  37.4%  2560 2756s
  1680  1455 -16433.625   47  332 -21312.574 -13340.748  37.4%  2433 2780s
  1865  1617 -16919.779   52  324 -21312.574 -13340.748  37.4%  2287 2805s
  2083  1793 -17185.045   58  361 -21312.574 -13340.748  37.4%  2130 2826s
  2382  1987 -17899.164   69  184 -21312.574 -13340.748  37.4%  1940 2851s
  2689  2130 -21145.101   83  100 -21312.574 -13340.748  37.4%  1780 2877s
  2944  2237 -21175.793   87   68 -21312.574 -13340.748  37.4%  1696 2906s
  3191  2283 -14863.865   13  244 -21312.574 -13340.748  37.4%  1619 2936s
  3371  2317 -15257.944   16  223 -21312.574 -13340.748  37.4%  1592 2975s
H 3394  2219                    -20790.20915 -13340.748  35.8%  1585 2975s
H 3395  2212                    -20758.78264 -13340.748  35.7%  1585 2975s
* 3397  2209             129    -20755.76456 -13340.748  35.7%  1584 2975s
  3472  2206 infeasible   63      -20755.765 -13340.748  35.7%  1596 3010s
  3553  2225 -15267.828   16  227 -20755.765 -13340.748  35.7%  1612 3052s
  3639  2247 infeasible   17      -20755.765 -13340.748  35.7%  1631 3092s
  3723  2265 infeasible   16      -20755.765 -13405.515  35.4%  1657 3135s
  3799  2304 -19082.176   33  183 -20755.765 -13405.767  35.4%  1681 3180s
  3903  2330 infeasible   35      -20755.765 -13405.767  35.4%  1698 3224s
  3991  2356 infeasible   20      -20755.765 -13600.487  34.5%  1735 3268s
  4064  2380 infeasible    6      -20755.765 -13600.487  34.5%  1763 3310s
  4154  2423 infeasible   89      -20755.765 -13668.954  34.1%  1793 3356s
  4241  2453 -14492.816   13  562 -20755.765 -13668.954  34.1%  1824 3404s
  4327  2491 infeasible    7      -20755.765 -13709.543  33.9%  1850 3454s
  4413  2531 infeasible   84      -20755.765 -13775.659  33.6%  1882 3502s
  4497  2548 -15324.891   12  333 -20755.765 -13775.659  33.6%  1913 3552s
H 4555  2301                    -20191.57301 -13775.659  31.8%  1932 3552s
  4556  2346 -16251.071   12  270 -20191.573 -13775.659  31.8%  1935 3600s

Cutting planes:
  Implied bound: 293
  MIR: 4013
  Flow cover: 4841
  Zero half: 2
  RLT: 229
  Relax-and-lift: 1813

Explored 4651 nodes (9944610 simplex iterations) in 3600.07 seconds (4714.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -20191.6 -20755.8 -20790.2 ... -22121.3

Time limit reached
Best objective -2.019157301140e+04, best bound -1.377565885231e+04, gap 31.7752%
  WARNING: Time limit reached. Using best solution found (gap: 31.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = -20191.57, θ = 93294.12
  Upper Bound (UB) = -20191.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93294.12
  [DEBUG]   ✓ Scenario 0: θ = 93294.12 ≤ Q = 93294.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93294.12 ≤ Q = 93294.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93294.12 ≤ Q = 93294.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 93294.12 ≤ Q = 93294.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 93294.12 ≤ Q = 93294.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 93294.12 ≤ Q = 93294.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 93294.12 ≤ Q = 93294.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 93294.12 ≤ Q = 93294.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 93294.12 ≤ Q = 93294.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 93294.12 ≤ Q = 93294.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 93294.12 ≤ Q = 93294.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 93294.12 ≤ Q = 93294.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 93294.12 ≤ Q = 93294.12 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x58b210ca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa74def36
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-01, 2e+02]
Found heuristic solution: objective 1.431776e+13
Presolve removed 2608 rows and 1904 columns
Presolve time: 0.01s
Presolved: 485 rows, 485 columns, 1366 nonzeros
Found heuristic solution: objective 7765225.3104
Variable types: 325 continuous, 160 integer (160 binary)

Root relaxation: objective -1.083637e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108363.68    0  122 7765225.31 -108363.68   101%     -    0s
H    0     0                    -74262.90927 -108363.68  45.9%     -    0s
H    0     0                    -75217.82593 -108363.68  44.1%     -    0s
     0     0 -85025.731    0   69 -75217.826 -85025.731  13.0%     -    0s
H    0     0                    -81618.03072 -84881.990  4.00%     -    0s
H    0     0                    -81924.70462 -84881.990  3.61%     -    0s
     0     0 -84739.338    0   69 -81924.705 -84739.338  3.44%     -    0s
     0     0 -84647.461    0   71 -81924.705 -84647.461  3.32%     -    0s
     0     0 -84640.011    0   71 -81924.705 -84640.011  3.31%     -    0s
H    0     0                    -82131.55973 -84640.011  3.05%     -    0s
     0     2 -84640.011    0   71 -82131.560 -84640.011  3.05%     -    0s

Cutting planes:
  Gomory: 28
  Projected implied bound: 12
  MIR: 53
  Flow cover: 56
  RLT: 40
  Relax-and-lift: 3

Explored 4881 nodes (23423 simplex iterations) in 1.13 seconds (0.28 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -82131.6 -81924.7 -75217.8 ... 1.43178e+13
No other solutions better than -82131.6

Optimal solution found (tolerance 1.00e-06)
Best objective -8.213155972964e+04, best bound -8.213155972964e+04, gap 0.0000%
  Subproblem solved in 1.17s
  Worst-case operational profit (Z_SP) = 90616.50
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82131.56
  [DEBUG]   S×d_nominal = 172748.06
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172748.06 + -82131.56 = 90616.50
  [DEBUG]   Current θ from Master = 93294.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2677.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22869.20
  Lower Bound (LB) = -20721.31
  Gap (UB-LB) = 529.7417, Absolute Gap = 529.7417, Relative Gap = 0.026236
  Not converged yet (gap = 529.74 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x7d9ac80a
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 4.03s
Presolved: 116463 rows, 49440 columns, 702607 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -430875.3068
Found heuristic solution: objective -180243.6641

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 605
 AA' NZ     : 4.682e+06
 Factor NZ  : 1.112e+07 (roughly 160 MB of memory)
 Factor Ops : 2.262e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.85291416e+07  1.94221580e+08  9.71e+04 1.54e+01  7.77e+04     6s
   1  -1.41618998e+07  1.73282960e+08  6.84e+04 5.66e+01  5.45e+04     6s
   2  -6.65315203e+06  1.35907353e+08  3.15e+04 5.63e+00  2.64e+04     6s
   3  -8.34569543e+05  9.98643462e+07  1.54e+03 1.15e+00  1.70e+03     6s
   4  -5.49190067e+05  4.57554692e+07  4.51e+02 3.88e-01  5.44e+02     6s
   5  -4.39856435e+05  2.99626844e+07  2.24e+02 2.23e-01  2.93e+02     6s
   6  -3.16119963e+05  2.34414153e+07  6.74e+01 1.62e-01  1.53e+02     7s
   7  -2.11306873e+05  1.78806873e+07  6.57e+00 1.17e-01  8.85e+01     7s
   8  -1.24565113e+05  7.03368374e+06  1.15e+00 4.19e-02  3.39e+01     7s
   9  -8.24844639e+04  2.86837957e+06  3.72e-01 1.65e-02  1.39e+01     7s
  10  -6.08217304e+04  1.27011534e+06  2.09e-01 7.03e-03  6.26e+00     7s
  11  -4.56492597e+04  6.70414401e+05  1.34e-01 3.55e-03  3.36e+00     7s
  12  -3.44159279e+04  3.00667102e+05  6.16e-02 1.59e-03  1.57e+00     7s
  13  -2.80684630e+04  1.34404928e+05  3.93e-02 7.82e-04  7.63e-01     7s
  14  -2.24028948e+04  7.73426915e+04  2.83e-02 9.04e-04  4.68e-01     7s
  15  -1.94919260e+04  6.01110585e+04  2.32e-02 8.63e-04  3.74e-01     7s
  16  -1.54523896e+04  4.41756333e+04  1.77e-02 7.19e-04  2.80e-01     8s
  17  -1.26281057e+04  2.63195099e+04  1.42e-02 6.16e-04  1.83e-01     8s
  18  -1.04544240e+04  2.22030364e+04  1.18e-02 5.24e-04  1.53e-01     8s
  19  -8.90472324e+03  1.98347581e+04  1.00e-02 5.00e-04  1.35e-01     8s
  20  -7.95440436e+03  1.69502657e+04  9.01e-03 4.18e-04  1.17e-01     8s
  21  -6.57412813e+03  1.36511935e+04  7.54e-03 3.10e-04  9.49e-02     8s
  22  -5.96385976e+03  1.09936436e+04  6.93e-03 2.44e-04  7.96e-02     8s
  23  -5.50337629e+03  1.02087665e+04  6.49e-03 2.22e-04  7.37e-02     9s
  24  -4.67872446e+03  8.24308674e+03  5.74e-03 1.69e-04  6.07e-02     9s
  25  -4.17150357e+03  7.51445061e+03  5.28e-03 1.51e-04  5.49e-02     9s
  26  -3.59144036e+03  6.57555769e+03  4.74e-03 1.22e-04  4.77e-02     9s
  27  -3.14062600e+03  5.61314198e+03  4.28e-03 1.03e-04  4.11e-02     9s
  28  -2.42109471e+03  5.12098219e+03  3.52e-03 9.21e-05  3.54e-02     9s
  29  -2.02139945e+03  4.75265529e+03  3.10e-03 8.35e-05  3.18e-02     9s
  30  -1.47042363e+03  3.98282229e+03  2.55e-03 6.49e-05  2.56e-02    10s
  31  -9.48050825e+02  3.19021925e+03  2.06e-03 4.45e-05  1.94e-02    10s
  32  -4.07053459e+02  2.72962513e+03  1.56e-03 3.36e-05  1.47e-02    10s
  33  -3.09671874e+02  2.52242870e+03  1.47e-03 2.86e-05  1.33e-02    10s
  34  -4.74706324e+00  2.26662622e+03  1.20e-03 2.18e-05  1.07e-02    10s
  35   4.54505353e+02  2.08501884e+03  8.04e-04 1.70e-05  7.65e-03    10s
  36   4.78413491e+02  2.00071948e+03  7.84e-04 1.50e-05  7.15e-03    10s
  37   6.07363820e+02  1.85368269e+03  6.71e-04 1.15e-05  5.85e-03    11s
  38   6.76398644e+02  1.83912979e+03  6.07e-04 1.12e-05  5.46e-03    11s
  39   8.15646717e+02  1.77304068e+03  4.86e-04 9.43e-06  4.49e-03    11s
  40   9.95290913e+02  1.67492984e+03  3.29e-04 6.85e-06  3.19e-03    11s
  41   1.06123914e+03  1.60536068e+03  2.74e-04 5.03e-06  2.55e-03    11s
  42   1.10819579e+03  1.57856124e+03  2.37e-04 4.38e-06  2.21e-03    11s
  43   1.12552958e+03  1.56995587e+03  2.24e-04 4.16e-06  2.09e-03    11s
  44   1.13549849e+03  1.54654459e+03  2.15e-04 3.57e-06  1.93e-03    12s
  45   1.19355329e+03  1.50480883e+03  1.67e-04 1.07e-05  1.46e-03    12s
  46   1.21835101e+03  1.49518440e+03  1.47e-04 9.59e-06  1.30e-03    12s
  47   1.25734970e+03  1.48208221e+03  1.15e-04 8.18e-06  1.05e-03    12s
  48   1.27169963e+03  1.45948659e+03  1.03e-04 5.78e-06  8.81e-04    12s
  49   1.31396576e+03  1.43743626e+03  6.91e-05 3.17e-06  5.80e-04    12s
  50   1.31994360e+03  1.43561362e+03  6.39e-05 2.99e-06  5.43e-04    12s
  51   1.32511196e+03  1.43183756e+03  6.00e-05 2.63e-06  5.01e-04    12s
  52   1.34222615e+03  1.42236192e+03  4.68e-05 1.74e-06  3.76e-04    13s
  53   1.35362998e+03  1.41931990e+03  3.82e-05 1.43e-06  3.08e-04    13s
  54   1.36590228e+03  1.41568753e+03  2.85e-05 1.08e-06  2.34e-04    13s
  55   1.36824354e+03  1.41455074e+03  2.67e-05 9.87e-07  2.17e-04    13s
  56   1.37421448e+03  1.41392710e+03  2.23e-05 9.33e-07  1.86e-04    13s
  57   1.39426262e+03  1.41148673e+03  6.77e-06 6.49e-07  8.08e-05    13s
  58   1.39895269e+03  1.40530004e+03  3.32e-06 1.90e-06  2.98e-05    13s
  59   1.40320867e+03  1.40447713e+03  4.91e-07 4.39e-07  5.95e-06    14s
  60   1.40396680e+03  1.40416281e+03  7.90e-08 9.15e-08  9.20e-07    14s
  61   1.40413040e+03  1.40413104e+03  5.19e-10 5.09e-10  3.01e-09    14s
  62   1.40413088e+03  1.40413096e+03  1.21e-07 1.04e-11  3.53e-10    14s
  63   1.40413094e+03  1.40413095e+03  2.46e-07 1.78e-09  2.33e-11    14s

Barrier solved model in 63 iterations and 14.02 seconds (13.67 work units)
Optimal objective 1.40413094e+03


Root crossover log...

   92517 DPushes remaining with DInf 0.0000000e+00                14s
   25618 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

    3899 PPushes remaining with PInf 1.0350702e-05                18s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.9650984e-11     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42150    1.4041310e+03   0.000000e+00   0.000000e+00     19s
   42150    1.4041310e+03   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 0.33s

Solved with barrier

Root relaxation: objective 1.404131e+03, 42150 iterations, 14.11 seconds (18.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1404.13095    0  495 -180243.66 1404.13095   101%     -   20s
H    0     0                    -174093.4421 1404.13095   101%     -   20s
H    0     0                    -137941.4147 1404.13095   101%     -   20s
H    0     0                    -136431.2232 1404.13095   101%     -   21s
H    0     0                    -134870.6400 1404.13095   101%     -   22s
H    0     0                    -130448.6033 1404.13095   101%     -   22s
H    0     0                    -67347.70517 1404.13095   102%     -   22s
H    0     0                    -62129.82504 1404.13095   102%     -   23s
H    0     0                    -54861.98114 1404.13095   103%     -   26s
H    0     0                    -54707.85447 1404.13095   103%     -   26s
H    0     0                    -44974.07389 -2239.4759  95.0%     -  128s
H    0     0                    -44905.18152 -2239.4759  95.0%     -  128s
H    0     0                    -37611.43107 -2239.4759  94.0%     -  128s
     0     0 -2776.6297    0  808 -37611.431 -2776.6297  92.6%     -  128s
H    0     0                    -37608.12432 -2776.6297  92.6%     -  130s
H    0     0                    -37218.51397 -2776.6297  92.5%     -  130s
H    0     0                    -37047.89944 -2776.6297  92.5%     -  130s
H    0     0                    -36800.05500 -2776.6297  92.5%     -  130s
     0     0 -3183.8544    0  754 -36800.055 -3183.8544  91.3%     -  178s
     0     0 -3183.8544    0  844 -36800.055 -3183.8544  91.3%     -  188s
     0     0 -3183.8544    0  843 -36800.055 -3183.8544  91.3%     -  190s
     0     0 -3183.8544    0  845 -36800.055 -3183.8544  91.3%     -  195s
     0     0 -3183.8544    0  842 -36800.055 -3183.8544  91.3%     -  196s
H    0     0                    -33938.40187 -5692.5743  83.2%     -  300s
H    0     0                    -33874.39368 -5692.5743  83.2%     -  300s
H    0     0                    -33385.48411 -5692.5743  82.9%     -  300s
H    0     0                    -33384.51868 -5692.5743  82.9%     -  300s
H    0     0                    -33377.86740 -5692.5743  82.9%     -  300s
     0     0 -5692.5743    0  666 -33377.867 -5692.5743  82.9%     -  300s
H    0     0                    -31063.68384 -5693.6346  81.7%     -  301s
H    0     0                    -30862.73879 -5693.6346  81.6%     -  301s
H    0     0                    -30861.50627 -5693.6346  81.6%     -  301s
H    0     0                    -30429.94602 -6941.1324  77.2%     -  428s
H    0     0                    -30360.64724 -6941.1324  77.1%     -  428s
H    0     0                    -30321.70345 -6941.1324  77.1%     -  428s
H    0     0                    -30319.46220 -6941.1324  77.1%     -  428s
H    0     0                    -30312.81092 -6941.1324  77.1%     -  428s
H    0     0                    -30308.47211 -6941.1324  77.1%     -  428s
     0     0 -6941.1324    0  760 -30308.472 -6941.1324  77.1%     -  429s
H    0     0                    -30195.27994 -7190.9530  76.2%     -  478s
H    0     0                    -30188.77240 -7190.9530  76.2%     -  478s
     0     0 -7190.9530    0  788 -30188.772 -7190.9530  76.2%     -  478s
H    0     0                    -29442.85083 -7213.8286  75.5%     -  495s
H    0     0                    -29338.26575 -7213.8286  75.4%     -  495s
H    0     0                    -29331.75821 -7213.8286  75.4%     -  495s
H    0     0                    -29280.25697 -7213.8286  75.4%     -  495s
H    0     0                    -29180.41696 -7213.8286  75.3%     -  495s
H    0     0                    -29173.90941 -7213.8286  75.3%     -  495s
H    0     0                    -28997.32799 -7213.8286  75.1%     -  495s
H    0     0                    -28997.18576 -7213.8286  75.1%     -  495s
H    0     0                    -28990.67822 -7213.8286  75.1%     -  495s
H    0     0                    -28990.53448 -7213.8286  75.1%     -  495s
H    0     0                    -28984.02694 -7213.8286  75.1%     -  495s
H    0     0                    -28919.41370 -7213.8286  75.1%     -  495s
     0     0 -7213.8286    0  725 -28919.414 -7213.8286  75.1%     -  495s
     0     0 -7250.2656    0  728 -28919.414 -7250.2656  74.9%     -  511s
     0     0 -7283.9005    0  730 -28919.414 -7283.9005  74.8%     -  525s
     0     0 -7334.7620    0  777 -28919.414 -7334.7620  74.6%     -  544s
     0     0 -7343.6684    0  722 -28919.414 -7343.6684  74.6%     -  552s
     0     0 -7365.2364    0  789 -28919.414 -7365.2364  74.5%     -  564s
     0     0 -7387.1410    0  793 -28919.414 -7387.1410  74.5%     -  584s
     0     0 -7391.2367    0  808 -28919.414 -7391.2367  74.4%     -  590s
     0     0 -7396.1591    0  815 -28919.414 -7396.1591  74.4%     -  595s
     0     0 -7398.8480    0  804 -28919.414 -7398.8480  74.4%     -  599s
     0     0 -7399.6396    0  802 -28919.414 -7399.6396  74.4%     -  601s
     0     0 -9418.9236    0  607 -28919.414 -9418.9236  67.4%     -  758s
H    0     0                    -28826.96108 -9419.5164  67.3%     -  759s
H    0     0                    -28802.88449 -9419.5164  67.3%     -  759s
     0     0 -10374.229    0  754 -28802.884 -10374.229  64.0%     -  846s
     0     0 -10705.366    0  767 -28802.884 -10705.366  62.8%     -  896s
     0     0 -10799.371    0  728 -28802.884 -10799.371  62.5%     -  919s
     0     0 -10848.416    0  742 -28802.884 -10848.416  62.3%     -  934s
H    0     0                    -28792.57870 -11003.750  61.8%     -  957s
H    0     0                    -28766.96965 -11003.750  61.7%     -  957s
H    0     0                    -28739.73367 -11003.750  61.7%     -  957s
     0     0 -11003.750    0  748 -28739.734 -11003.750  61.7%     -  957s
     0     0 -11036.639    0  746 -28739.734 -11036.639  61.6%     -  966s
     0     0 -11102.012    0  761 -28739.734 -11102.012  61.4%     -  981s
     0     0 -11115.656    0  767 -28739.734 -11115.656  61.3%     -  987s
     0     0 -11128.725    0  779 -28739.734 -11128.725  61.3%     -  992s
     0     0 -11159.761    0  752 -28739.734 -11159.761  61.2%     -  999s
     0     0 -11173.025    0  758 -28739.734 -11173.025  61.1%     - 1002s
     0     0 -11179.592    0  771 -28739.734 -11179.592  61.1%     - 1005s
     0     0 -11180.536    0  778 -28739.734 -11180.536  61.1%     - 1007s
     0     0 -12092.811    0  644 -28739.734 -12092.811  57.9%     - 1103s
     0     0 -12240.594    0  748 -28739.734 -12240.594  57.4%     - 1161s
     0     0 -12440.762    0  650 -28739.734 -12440.762  56.7%     - 1200s
H    0     0                    -24588.36613 -12536.987  49.0%     - 1230s
H    0     0                    -23146.50336 -12536.987  45.8%     - 1230s
     0     0 -12536.987    0  743 -23146.503 -12536.987  45.8%     - 1230s
     0     0 -12551.757    0  747 -23146.503 -12551.757  45.8%     - 1239s
H    0     0                    -22940.25635 -12595.047  45.1%     - 1258s
     0     0 -12595.047    0  671 -22940.256 -12595.047  45.1%     - 1258s
     0     0 -12637.212    0  644 -22940.256 -12637.212  44.9%     - 1273s
     0     0 -12649.733    0  656 -22940.256 -12649.733  44.9%     - 1283s
     0     0 -12651.185    0  834 -22940.256 -12651.185  44.9%     - 1287s
H    0     0                    -22861.23754 -12787.159  44.1%     - 1321s
H    0     0                    -22750.58140 -12787.159  43.8%     - 1321s
H    0     0                    -22703.00217 -12787.159  43.7%     - 1321s
H    0     0                    -22676.18145 -12787.159  43.6%     - 1321s
H    0     0                    -22640.23041 -12787.159  43.5%     - 1321s
H    0     0                    -22558.31655 -12787.159  43.3%     - 1321s
     0     0 -12787.159    0  642 -22558.317 -12787.159  43.3%     - 1321s
     0     0 -12909.531    0  655 -22558.317 -12909.531  42.8%     - 1344s
     0     0 -12932.793    0  651 -22558.317 -12932.793  42.7%     - 1358s
     0     0 -12940.087    0  668 -22558.317 -12940.087  42.6%     - 1363s
     0     0 -12942.453    0  675 -22558.317 -12942.453  42.6%     - 1367s
     0     0 -12943.044    0  678 -22558.317 -12943.044  42.6%     - 1368s
     0     0 -12988.354    0  660 -22558.317 -12988.354  42.4%     - 1395s
H    0     0                    -22489.22624 -12989.054  42.2%     - 1400s
H    0     0                    -22302.23807 -12989.054  41.8%     - 1400s
H    0     0                    -22301.24225 -12989.054  41.8%     - 1401s
H    0     0                    -22040.69294 -12989.054  41.1%     - 1401s
     0     0 -13039.050    0  662 -22040.693 -13039.050  40.8%     - 1422s
     0     0 -13045.139    0  671 -22040.693 -13045.139  40.8%     - 1430s
     0     0 -13049.564    0  687 -22040.693 -13049.564  40.8%     - 1437s
     0     0 -13051.457    0  689 -22040.693 -13051.457  40.8%     - 1441s
     0     0 -13079.569    0  854 -22040.693 -13079.569  40.7%     - 1465s
     0     0 -13086.060    0  847 -22040.693 -13086.060  40.6%     - 1474s
     0     0 -13089.280    0  846 -22040.693 -13089.280  40.6%     - 1481s
     0     0 -13090.685    0  855 -22040.693 -13090.685  40.6%     - 1485s
     0     0 -13101.099    0  844 -22040.693 -13101.099  40.6%     - 1498s
     0     0 -13103.462    0  855 -22040.693 -13103.462  40.5%     - 1516s
     0     0 -13104.664    0  858 -22040.693 -13104.664  40.5%     - 1520s
     0     0 -13112.374    0  870 -22040.693 -13112.374  40.5%     - 1535s
     0     0 -13138.380    0  839 -22040.693 -13138.380  40.4%     - 1554s
     0     0 -13144.219    0  685 -22040.693 -13144.219  40.4%     - 1564s
     0     0 -13148.760    0  685 -22040.693 -13148.760  40.3%     - 1569s
     0     0 -13150.242    0  692 -22040.693 -13150.242  40.3%     - 1573s
H    0     0                    -22020.57123 -13191.587  40.1%     - 1600s
     0     0 -13191.587    0  848 -22020.571 -13191.587  40.1%     - 1600s
H    0     0                    -21995.62350 -13191.639  40.0%     - 1610s
H    0     0                    -21986.02081 -13191.639  40.0%     - 1615s
     0     0 -13222.137    0  680 -21986.021 -13222.137  39.9%     - 1627s
     0     0 -13229.922    0  694 -21986.021 -13229.922  39.8%     - 1633s
     0     0 -13234.297    0  857 -21986.021 -13234.297  39.8%     - 1638s
     0     0 -13236.995    0  702 -21986.021 -13236.995  39.8%     - 1642s
     0     0 -13237.895    0  698 -21986.021 -13237.895  39.8%     - 1644s
     0     0 -13259.145    0  628 -21986.021 -13259.145  39.7%     - 1658s
H    0     0                    -21978.30132 -13259.366  39.7%     - 1659s
     0     0 -13273.101    0  708 -21978.301 -13273.101  39.6%     - 1671s
     0     0 -13278.176    0  729 -21978.301 -13278.176  39.6%     - 1677s
     0     0 -13279.104    0  738 -21978.301 -13279.104  39.6%     - 1680s
     0     0 -13286.852    0  726 -21978.301 -13286.852  39.5%     - 1693s
     0     0 -13290.871    0  728 -21978.301 -13290.871  39.5%     - 1724s
     0     0 -13291.678    0  736 -21978.301 -13291.678  39.5%     - 1726s
     0     0 -13293.929    0  733 -21978.301 -13293.929  39.5%     - 1733s
     0     0 -13294.540    0  740 -21978.301 -13294.540  39.5%     - 1737s
     0     0 -13300.608    0  887 -21978.301 -13300.608  39.5%     - 1746s
     0     0 -13300.914    0  887 -21978.301 -13300.914  39.5%     - 1761s
H    0     0                    -21973.29792 -13300.934  39.5%     - 1983s
     0     2 -13300.934    0  887 -21973.298 -13300.934  39.5%     - 2014s
     1     3 -13318.965    1  858 -21973.298 -13300.934  39.5%  2568 2023s
     2     4 -13382.584    1  717 -21973.298 -13318.990  39.4%  3322 2036s
     3     6 -13506.269    2  853 -21973.298 -13319.473  39.4%  4058 2060s
     5     8 -13475.642    2  632 -21973.298 -13382.607  39.1%  6902 2088s
     7    16 -13770.572    3  619 -21973.298 -13475.800  38.7%  7289 2117s
    15    31 -14052.633    4  695 -21973.298 -13493.857  38.6%  7993 2158s
    30    42 -14367.686    5  462 -21973.298 -13556.055  38.3% 14184 2359s
    45    67 -14605.453    5  576 -21973.298 -13556.055  38.3% 15581 2569s
H   46    67                    -21950.15877 -13556.055  38.2% 15242 2569s
    70   157 -14699.090    6  722 -21950.159 -13556.055  38.2% 14601 2645s
   166   205 -15162.625    8  595 -21950.159 -13556.055  38.2% 11048 2705s
   218   272 infeasible    9      -21950.159 -13556.055  38.2%  9472 2770s
   289   348 -15290.635   10  573 -21950.159 -13556.055  38.2%  8217 2815s
   376   369 -15311.105   12  653 -21950.159 -13556.055  38.2%  6950 2957s
   407   396 -15403.220   13  749 -21950.159 -13556.055  38.2%  6789 3000s
H  440   396                    -21931.12818 -13556.055  38.2%  6562 3000s
   442   420 -15430.246   14  755 -21931.128 -13556.055  38.2%  6562 3038s
   477   427 -15047.424   11  706 -21931.128 -13556.055  38.2%  6463 3075s
   518   442 -20702.816   14  239 -21931.128 -13556.055  38.2%  6241 3115s
   551   469 -15592.355   14  745 -21931.128 -13556.055  38.2%  6133 3150s
   584   499 -20309.587   11  401 -21931.128 -13556.055  38.2%  6079 3188s
   632   538 -20369.391   12  399 -21931.128 -13556.055  38.2%  5891 3225s
   687   579 -20894.365   20  188 -21931.128 -13556.055  38.2%  5640 3266s
   762   610 -21095.466   21  180 -21931.128 -13556.055  38.2%  5265 3296s
   831   628 infeasible   22      -21931.128 -13556.055  38.2%  5034 3332s
   915   643 infeasible   22      -21931.128 -13556.055  38.2%  4742 3372s
   997   650 infeasible   17      -21931.128 -13556.055  38.2%  4512 3418s
  1073   669 -20303.712   17  320 -21931.128 -13556.055  38.2%  4342 3463s
  1153   693 -20320.288   18  321 -21931.128 -13556.055  38.2%  4223 3511s
  1245   759 -20397.059   19  315 -21931.128 -13556.055  38.2%  4094 3558s
  1361   806 -20501.676   25  204 -21931.128 -13556.055  38.2%  3934 3600s

Cutting planes:
  Gomory: 2
  Implied bound: 280
  MIR: 4047
  Flow cover: 4928
  Inf proof: 1
  Zero half: 3
  RLT: 239
  Relax-and-lift: 1488

Explored 1456 nodes (6393240 simplex iterations) in 3600.20 seconds (4719.40 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -21931.1 -21950.2 -21973.3 ... -22489.2

Time limit reached
Best objective -2.193112818333e+04, best bound -1.355605543660e+04, gap 38.1881%
  WARNING: Time limit reached. Using best solution found (gap: 38.19%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 3600.22s
  Master Objective (UB) = -21931.13, θ = 90455.50
  Upper Bound (UB) = -21931.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 90455.50
  [DEBUG]   ✓ Scenario 0: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 90455.50 ≤ Q = 90455.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 90455.50 ≤ Q = 90455.50 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7d6cc8ca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7d6cc8ca
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.398749e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.01s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 7654412.5834
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.060555e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -106055.50    0  121 7654412.58 -106055.50   101%     -    0s
H    0     0                    -72143.02071 -106055.50  47.0%     -    0s
H    0     0                    -73124.22803 -106055.50  45.0%     -    0s
     0     0 -84774.727    0  133 -73124.228 -84774.727  15.9%     -    0s
H    0     0                    -81446.67000 -84668.050  3.96%     -    0s
H    0     0                    -82081.02649 -84284.663  2.68%     -    0s
     0     0 -84284.663    0  131 -82081.026 -84284.663  2.68%     -    0s
     0     0 -84003.560    0  131 -82081.026 -84003.560  2.34%     -    0s
     0     0 -83920.988    0  131 -82081.026 -83920.988  2.24%     -    0s
     0     0 -83920.988    0  131 -82081.026 -83920.988  2.24%     -    0s
     0     0 -83575.968    0  123 -82081.026 -83575.968  1.82%     -    0s
H    0     0                    -82087.55882 -83532.439  1.76%     -    0s
     0     0 -83532.439    0  133 -82087.559 -83532.439  1.76%     -    0s
     0     0 -83451.562    0  121 -82087.559 -83451.562  1.66%     -    0s
     0     0 -83439.180    0  125 -82087.559 -83439.180  1.65%     -    0s
     0     0 -82921.701    0  112 -82087.559 -82921.701  1.02%     -    0s
     0     0 -82827.681    0  118 -82087.559 -82827.681  0.90%     -    0s
     0     0 -82738.762    0   98 -82087.559 -82738.762  0.79%     -    0s
     0     0 -82709.100    0  105 -82087.559 -82709.100  0.76%     -    0s
     0     0 -82703.577    0   86 -82087.559 -82703.577  0.75%     -    0s
     0     0 -82666.053    0  108 -82087.559 -82666.053  0.70%     -    0s
     0     0 -82591.758    0   99 -82087.559 -82591.758  0.61%     -    0s
     0     0 -82591.279    0   99 -82087.559 -82591.279  0.61%     -    0s
     0     0 -82555.747    0   77 -82087.559 -82555.747  0.57%     -    0s
     0     0 -82545.568    0   75 -82087.559 -82545.568  0.56%     -    0s
     0     0 -82515.793    0   75 -82087.559 -82515.793  0.52%     -    0s
     0     0 -82488.736    0   75 -82087.559 -82488.736  0.49%     -    0s
     0     2 -82488.736    0   75 -82087.559 -82488.736  0.49%     -    0s
H   32     4                    -82089.97798 -82235.491  0.18%  14.3    0s
H   62     4                    -82102.26803 -82145.978  0.05%  11.3    0s

Cutting planes:
  Gomory: 24
  Implied bound: 7
  MIR: 260
  Flow cover: 13
  RLT: 93
  Relax-and-lift: 1

Explored 117 nodes (1781 simplex iterations) in 0.28 seconds (0.11 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -82102.3 -82090 -82087.6 ... 1.39875e+13
No other solutions better than -82102.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.210226803444e+04, best bound -8.210226803444e+04, gap 0.0000%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 90455.50
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82102.27
  [DEBUG]   S×d_nominal = 172557.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172557.77 + -82102.27 = 90455.50
  [DEBUG]   Current θ from Master = 90455.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 0.00 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21931.13
  Lower Bound (LB) = -20721.31
  Gap (UB-LB) = -1209.8135, Absolute Gap = 1209.8135, Relative Gap = -0.055164
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = -21931.13, LB = -20721.31, Gap = -1209.81
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Scenario is DUPLICATE - checking details:
  [DEBUG] Matches scenario 11
  [DEBUG] Scenario pattern: 60 increases, 0 decreases
  [DEBUG] NOT adding to Master Problem (duplicate)

  WARNING: Duplicate scenario detected - algorithm stalled!
  Current gap: -1209.813520
  This may indicate numerical issues or model formulation error.
  Terminating with current best solution.


================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 14
Total Time: 31363.85s
Converged: False
Final Lower Bound: -20721.3147
Final Upper Bound: -21931.1282
Final Gap: -1209.813520
Number of Critical Scenarios: 14
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 9] (2/10)
Active Routes (Plant→DC): 6
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 50 customers  Mode 1: 0 customers  Mode 2: 0 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: False
Iterations: 14
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-03 18:28:08
Total Time: 31363.85s
Optimal Value: -20721.31
Lower Bound: -20721.31
Upper Bound: -21931.13
Gap: -1209.813520
Plants Opened: {0: [1], 1: [2], 2: [0]} (3 plants)
DCs Opened: [0, 9] (2 DCs)
================================================================================

Results saved to: result/DH_single_full_seed13_LD_gamma20_20260103_182809.csv

Total Execution Time: 31365.05 seconds
End Time: 2026-01-03 18:28:10

All tasks completed successfully!

