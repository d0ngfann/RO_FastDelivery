
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 15
DI Scenario: LD
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed15.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.113', '1.238'] (k=0.263)
  Product 1: ['1.000', '1.016', '1.032'] (k=0.039)
  Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=903, max=1768
  DC capacity (MC): min=414, max=867

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.05, max=34.96, count=80
  Deviation (μ̂): min=4.07, max=9.96

Costs:
  Plant fixed cost: min=5260, max=9753
  DC fixed cost: min=3497, max=5949
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.335', '1.783'] (k=0.713)
    Product 2: ['1.000', '1.424', '2.029'] (k=0.873)
  MD:
    Product 0: ['1.000', '1.250', '1.561'] (k=0.549)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.287', '1.656'] (k=0.622)
  LD:
    Product 0: ['1.000', '1.113', '1.238'] (k=0.263)
    Product 1: ['1.000', '1.016', '1.032'] (k=0.039)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
  Mixed:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x03cc8874
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.12s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333501.7915
Found heuristic solution: objective -194606.4683

Root relaxation: objective 7.101466e+04, 5084 iterations, 0.31 seconds (0.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 71014.6558    0  536 -194606.47 71014.6558   136%     -    0s
H    0     0                    -190113.0011 71014.6558   137%     -    0s
     0     0 64738.8015    0  945 -190113.00 64738.8015   134%     -    1s
     0     0 64723.5236    0  937 -190113.00 64723.5236   134%     -    1s
     0     0 64723.5108    0  941 -190113.00 64723.5108   134%     -    1s
H    0     0                    -147439.1953 61995.5752   142%     -    2s
     0     0 61995.5752    0 1096 -147439.20 61995.5752   142%     -    2s
H    0     0                    -144062.7363 61891.5075   143%     -    2s
     0     0 61891.5075    0 1110 -144062.74 61891.5075   143%     -    2s
     0     0 61887.0708    0 1119 -144062.74 61887.0708   143%     -    3s
     0     0 61886.9063    0 1119 -144062.74 61886.9063   143%     -    3s
H    0     0                    -9656.839011 59237.7126   713%     -    5s
     0     0 59237.7126    0 1274 -9656.8390 59237.7126   713%     -    5s
     0     0 58931.4385    0 1285 -9656.8390 58931.4385   710%     -    5s
     0     0 58863.2618    0 1298 -9656.8390 58863.2618   710%     -    5s
     0     0 58854.0752    0 1304 -9656.8390 58854.0752   709%     -    5s
     0     0 58853.1797    0 1305 -9656.8390 58853.1797   709%     -    5s
H    0     0                    15929.850850 56673.3496   256%     -    8s
H    0     0                    15972.571864 56673.3496   255%     -    8s
H    0     0                    15987.701830 56673.3496   254%     -    8s
H    0     0                    15997.053801 56673.3496   254%     -    8s
H    0     0                    16369.010613 56673.3496   246%     -    8s
     0     0 56673.3496    0 1308 16369.0106 56673.3496   246%     -    8s
H    0     0                    16371.912908 56351.6412   244%     -   10s
H    0     0                    16590.535671 56351.6412   240%     -   10s
H    0     0                    16677.380842 56351.6412   238%     -   10s
H    0     0                    16692.664551 56351.6412   238%     -   10s
H    0     0                    16729.898903 56351.6412   237%     -   10s
H    0     0                    16807.492083 56351.6412   235%     -   10s
H    0     0                    16816.947288 56351.6412   235%     -   10s
H    0     0                    16934.013265 56351.6412   233%     -   10s
H    0     0                    16956.924898 56351.6412   232%     -   10s
H    0     0                    16980.389156 56351.6412   232%     -   10s
H    0     0                    17035.396367 56351.6412   231%     -   10s
     0     0 56351.6412    0 1310 17035.3964 56351.6412   231%     -   10s
     0     0 56294.7458    0 1325 17035.3964 56294.7458   230%     -   10s
     0     0 56281.0592    0 1337 17035.3964 56281.0592   230%     -   10s
     0     0 56279.2406    0 1336 17035.3964 56279.2406   230%     -   10s
H    0     0                    17085.416969 54612.6508   220%     -   13s
H    0     0                    17103.033143 54612.6508   219%     -   13s
H    0     0                    17130.255959 54612.6508   219%     -   13s
H    0     0                    17173.177419 54612.6508   218%     -   13s
H    0     0                    17529.513665 54612.6508   212%     -   13s
     0     0 54612.6508    0 1343 17529.5137 54612.6508   212%     -   13s
H    0     0                    17620.407362 54392.4799   209%     -   14s
H    0     0                    17638.103732 54392.4799   208%     -   14s
H    0     0                    17659.324207 54392.4799   208%     -   14s
H    0     0                    17723.575605 54392.4799   207%     -   14s
H    0     0                    17758.568907 54392.4799   206%     -   14s
     0     0 54392.4799    0 1412 17758.5689 54392.4799   206%     -   14s
     0     0 54346.1319    0 1413 17758.5689 54346.1319   206%     -   14s
     0     0 54324.7573    0 1418 17758.5689 54324.7573   206%     -   14s
     0     0 54323.1950    0 1421 17758.5689 54323.1950   206%     -   15s
H    0     0                    17916.270577 54323.1950   203%     -   15s
H    0     0                    18006.831483 54323.1950   202%     -   15s
     0     0 52983.0206    0 1378 18006.8315 52983.0206   194%     -   17s
H    0     0                    18111.423797 52752.3639   191%     -   19s
     0     0 52752.3639    0 1410 18111.4238 52752.3639   191%     -   19s
     0     0 52696.1470    0 1419 18111.4238 52696.1470   191%     -   19s
     0     0 52686.0737    0 1415 18111.4238 52686.0737   191%     -   19s
     0     0 51762.5180    0 1386 18111.4238 51762.5180   186%     -   22s
H    0     0                    21135.385531 51546.4808   144%     -   23s
H    0     0                    21928.104279 51546.4808   135%     -   23s
H    0     0                    21989.066284 51546.4808   134%     -   23s
H    0     0                    22056.856494 51546.4808   134%     -   23s
H    0     0                    22288.925840 51546.4808   131%     -   23s
H    0     0                    22348.676585 51546.4808   131%     -   23s
H    0     0                    22437.744981 51546.4808   130%     -   23s
H    0     0                    22439.950932 51546.4808   130%     -   23s
H    0     0                    22468.451415 51546.4808   129%     -   23s
H    0     0                    22661.866561 51546.4808   127%     -   23s
     0     0 51546.4808    0 1427 22661.8666 51546.4808   127%     -   23s
H    0     0                    22665.398580 51507.1250   127%     -   24s
     0     0 51507.1250    0 1444 22665.3986 51507.1250   127%     -   24s
     0     0 51498.6972    0 1449 22665.3986 51498.6972   127%     -   24s
H    0     0                    23124.794994 51498.6972   123%     -   24s
H    0     0                    23259.666389 51498.6972   121%     -   24s
H    0     0                    23466.036124 50835.5107   117%     -   27s
H    0     0                    23474.947856 50835.5107   117%     -   27s
H    0     0                    23513.456905 50835.5107   116%     -   27s
H    0     0                    23515.698954 50835.5107   116%     -   27s
     0     0 50835.5107    0 1395 23515.6990 50835.5107   116%     -   27s
H    0     0                    24299.024895 50694.7001   109%     -   28s
     0     0 50694.7001    0 1415 24299.0249 50694.7001   109%     -   28s
H    0     0                    24680.959254 50660.2899   105%     -   29s
     0     0 50660.2899    0 1425 24680.9593 50660.2899   105%     -   29s
     0     0 50651.9999    0 1452 24680.9593 50651.9999   105%     -   29s
H    0     0                    24723.492417 50651.9999   105%     -   29s
     0     0 49650.0243    0 1359 24723.4924 49650.0243   101%     -   33s
     0     0 49446.2446    0 1397 24723.4924 49446.2446   100%     -   35s
     0     0 49394.3857    0 1390 24723.4924 49394.3857   100%     -   36s
     0     0 49382.1638    0 1391 24723.4924 49382.1638   100%     -   36s
H    0     0                    24812.109841 48809.3669  96.7%     -   39s
H    0     0                    24846.194260 48809.3669  96.4%     -   39s
H    0     0                    24886.614361 48809.3669  96.1%     -   39s
H    0     0                    24908.430607 48809.3669  96.0%     -   39s
H    0     0                    24943.968009 48809.3669  95.7%     -   39s
H    0     0                    24947.423183 48809.3669  95.6%     -   39s
H    0     0                    24979.402120 48809.3669  95.4%     -   39s
     0     0 48809.3669    0 1395 24979.4021 48809.3669  95.4%     -   39s
H    0     0                    25001.098270 48676.8850  94.7%     -   41s
     0     0 48676.8850    0 1420 25001.0983 48676.8850  94.7%     -   41s
     0     0 48654.0035    0 1415 25001.0983 48654.0035  94.6%     -   42s
     0     0 48647.0390    0 1435 25001.0983 48647.0390  94.6%     -   42s
     0     0 48076.9205    0 1347 25001.0983 48076.9205  92.3%     -   45s
     0     0 47912.4785    0 1375 25001.0983 47912.4785  91.6%     -   47s
     0     0 47858.0992    0 1372 25001.0983 47858.0992  91.4%     -   48s
     0     0 47847.5517    0 1375 25001.0983 47847.5517  91.4%     -   49s
     0     0 47369.7411    0 1366 25001.0983 47369.7411  89.5%     -   52s
     0     0 47216.9791    0 1411 25001.0983 47216.9791  88.9%     -   54s
     0     0 47181.7204    0 1444 25001.0983 47181.7204  88.7%     -   54s
     0     0 47173.1897    0 1448 25001.0983 47173.1897  88.7%     -   55s
     0     0 46764.0019    0 1363 25001.0983 46764.0019  87.0%     -   58s
     0     0 46637.1051    0 1379 25001.0983 46637.1051  86.5%     -   59s
     0     0 46606.6686    0 1381 25001.0983 46606.6686  86.4%     -   60s
     0     0 46595.3800    0 1401 25001.0983 46595.3800  86.4%     -   61s
     0     0 46345.9999    0 1283 25001.0983 46345.9999  85.4%     -   63s
     0     0 46276.3738    0 1388 25001.0983 46276.3738  85.1%     -   64s
     0     0 46244.1335    0 1380 25001.0983 46244.1335  85.0%     -   65s
     0     0 46239.4859    0 1388 25001.0983 46239.4859  84.9%     -   65s
     0     0 46042.7766    0 1353 25001.0983 46042.7766  84.2%     -   68s
     0     0 45968.7195    0 1361 25001.0983 45968.7195  83.9%     -   69s
     0     0 45948.8055    0 1391 25001.0983 45948.8055  83.8%     -   70s
     0     0 45739.2612    0 1352 25001.0983 45739.2612  82.9%     -   72s
     0     0 45681.8572    0 1347 25001.0983 45681.8572  82.7%     -   73s
     0     0 45670.7338    0 1368 25001.0983 45670.7338  82.7%     -   74s
     0     0 45488.6927    0 1334 25001.0983 45488.6927  81.9%     -   75s
     0     0 45488.6184    0 1334 25001.0983 45488.6184  81.9%     -   76s
     0     2 45488.6184    0 1334 25001.0983 45488.6184  81.9%     -   79s
     1     4 45114.8578    1 1071 25001.0983 45488.5385  81.9%  4272   84s
     3     8 44979.2107    2 1067 25001.0983 45114.7732  80.5%  5441   87s
     7    16 43586.4520    3  949 25001.0983 44978.0974  79.9%  4916   93s
    15    32 42313.6493    4  868 25001.0983 43586.2748  74.3%  4893   95s
    63    82 37476.1194    6  608 25001.0983 41343.9554  65.4%  4871  101s
H  156   169                    25037.277624 39852.8528  59.2%  2601  103s
H  160   169                    25134.115682 39852.8528  58.6%  2584  103s
   314   241 35122.0081   11  688 25134.1157 39852.8528  58.6%  1597  105s
H  364   257                    25143.386673 39067.0397  55.4%  1498  106s
H  394   257                    25150.319635 39067.0397  55.3%  1461  106s
H  439   306                    25170.836380 39067.0397  55.2%  1427  112s
   572   420 32795.1946   15  592 25170.8364 38529.7026  53.1%  1282  115s
   867   573 28587.6613   10  181 25170.8364 37490.7774  48.9%  1054  120s
  1484   814 27107.7725   16  450 25170.8364 36575.3619  45.3%   781  126s
  1601   847     cutoff   16      25170.8364 35651.1075  41.6%   774  130s
  2113   982 27540.7668   11  318 25170.8364 34283.2499  36.2%   701  136s
  2430  1035     cutoff   13      25170.8364 33028.2468  31.2%   678  140s
  2800  1061 26171.6162   11  254 25170.8364 32756.1376  30.1%   660  146s
  2992  1119     cutoff   14      25170.8364 32394.1068  28.7%   659  150s
  3535  1180     cutoff   15      25170.8364 31912.0229  26.8%   616  155s
  4210  1152     cutoff   15      25170.8364 30873.4413  22.7%   582  163s
  4731  1055     cutoff   16      25170.8364 30373.1101  20.7%   554  166s
  5508   870 25272.5454   13  124 25170.8364 29172.0943  15.9%   524  170s
  7873     0 25239.7117   21   21 25170.8364 25295.2420  0.49%   417  175s

Cutting planes:
  Gomory: 14
  Implied bound: 435
  MIR: 2711
  Flow cover: 1155
  Zero half: 18
  RLT: 60
  Relax-and-lift: 872

Explored 7929 nodes (3409077 simplex iterations) in 175.14 seconds (223.93 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25170.8 25150.3 25143.4 ... 24908.4

Optimal solution found (tolerance 1.00e-06)
Best objective 2.517083638033e+04, best bound 2.517083638033e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 175.14s
  Master Objective (UB) = 25170.84, θ = 152636.68
  Upper Bound (UB) = 25170.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152636.68
  [DEBUG]   ✓ Scenario 0: θ = 152636.68 ≤ Q = 152636.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x69b68702
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x69b68702
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.355232e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6778107.0008
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.274182e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127418.18    0  122 6778107.00 -127418.18   102%     -    0s
H    0     0                    -92535.16665 -127418.18  37.7%     -    0s
H    0     0                    -92849.39419 -127418.18  37.2%     -    0s
*    0     0               0    -97020.01252 -97020.013  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 202

Explored 1 nodes (367 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -97020 -92849.4 -92535.2 ... 1.35523e+13
No other solutions better than -97020

Optimal solution found (tolerance 1.00e-06)
Best objective -9.702001252101e+04, best bound -9.702001252101e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 118337.67
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -97020.01
  [DEBUG]   S×d_nominal = 215357.69
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 215357.69 + -97020.01 = 118337.67
  [DEBUG]   Current θ from Master = 152636.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34299.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9128.18
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 34299.0124, Absolute Gap = 34299.0124, Relative Gap = 1.362649
  Not converged yet (gap = 34299.01 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0xd6f7218c
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -9128.18 (0.02s)
MIP start from previous solve produced solution with objective -9128.18 (0.02s)
Loaded MIP start from previous solve with objective -9128.18

Presolve removed 14231 rows and 5770 columns
Presolve time: 0.49s
Presolved: 17732 rows, 8970 columns, 98128 nonzeros
Variable types: 6711 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.622905e+04, 9876 iterations, 1.86 seconds (2.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 26229.0467    0  420 -9128.1761 26229.0467   387%     -    2s
H    0     0                    -9096.476931 26229.0467   388%     -    2s
H    0     0                    -8512.906161 26229.0467   408%     -    2s
     0     0 16799.8059    0  677 -8512.9062 16799.8059   297%     -    4s
     0     0 16482.3694    0  670 -8512.9062 16482.3694   294%     -    5s
     0     0 16478.5082    0  671 -8512.9062 16478.5082   294%     -    5s
     0     0 11476.6087    0  569 -8512.9062 11476.6087   235%     -    8s
H    0     0                    -8416.446319 10770.0274   228%     -    9s
     0     0 10770.0274    0  672 -8416.4463 10770.0274   228%     -    9s
     0     0 10745.0488    0  681 -8416.4463 10745.0488   228%     -    9s
     0     0 10742.4195    0  683 -8416.4463 10742.4195   228%     -    9s
     0     0 8068.32622    0  635 -8416.4463 8068.32622   196%     -   13s
H    0     0                    -8238.967644 8065.59622   198%     -   13s
H    0     0                    -7490.989817 7576.89175   201%     -   14s
H    0     0                    -7217.613262 7576.89175   205%     -   14s
H    0     0                    -6805.625432 7576.89175   211%     -   14s
H    0     0                    -6795.424275 7576.89175   211%     -   14s
     0     0 7576.89175    0  639 -6795.4243 7576.89175   211%     -   14s
H    0     0                    -6773.226217 7394.47292   209%     -   14s
H    0     0                    -6721.862578 7394.47292   210%     -   14s
H    0     0                    -6625.896383 7394.47292   212%     -   14s
     0     0 7394.47292    0  758 -6625.8964 7394.47292   212%     -   14s
     0     0 7378.39537    0  755 -6625.8964 7378.39537   211%     -   15s
     0     0 7378.15958    0  647 -6625.8964 7378.15958   211%     -   15s
H    0     0                    -6521.401388 7378.15958   213%     -   17s
H    0     0                    -6498.816107 7378.15958   214%     -   17s
H    0     0                    -6414.623964 6199.97961   197%     -   19s
     0     0 6199.97961    0  554 -6414.6240 6199.97961   197%     -   19s
H    0     0                    -6405.556652 6199.07445   197%     -   19s
     0     0 5921.65078    0  637 -6405.5567 5921.65078   192%     -   20s
     0     0 5853.40095    0  545 -6405.5567 5853.40095   191%     -   21s
     0     0 5838.01433    0  550 -6405.5567 5838.01433   191%     -   21s
     0     0 5833.54747    0  550 -6405.5567 5833.54747   191%     -   21s
     0     0 5492.03225    0  726 -6405.5567 5492.03225   186%     -   23s
     0     0 5376.64239    0  602 -6405.5567 5376.64239   184%     -   24s
     0     0 5330.62830    0  541 -6405.5567 5330.62830   183%     -   24s
     0     0 5325.51362    0  555 -6405.5567 5325.51362   183%     -   24s
     0     0 5183.02821    0  637 -6405.5567 5183.02821   181%     -   26s
     0     0 5140.12425    0  755 -6405.5567 5140.12425   180%     -   27s
     0     0 5127.92128    0  832 -6405.5567 5127.92128   180%     -   28s
     0     0 5123.38765    0  832 -6405.5567 5123.38765   180%     -   28s
     0     0 5057.29241    0  547 -6405.5567 5057.29241   179%     -   30s
     0     0 5038.87377    0  541 -6405.5567 5038.87377   179%     -   30s
     0     0 5031.20119    0  542 -6405.5567 5031.20119   179%     -   30s
     0     0 5029.48493    0  548 -6405.5567 5029.48493   179%     -   30s
     0     0 4951.43437    0  492 -6405.5567 4951.43437   177%     -   32s
     0     0 4931.27824    0  513 -6405.5567 4931.27824   177%     -   32s
     0     0 4923.97461    0  522 -6405.5567 4923.97461   177%     -   33s
     0     0 4907.86941    0  515 -6405.5567 4907.86941   177%     -   34s
     0     0 4901.50607    0  528 -6405.5567 4901.50607   177%     -   34s
     0     0 4888.20777    0  529 -6405.5567 4888.20777   176%     -   35s
     0     0 4888.15128    0  529 -6405.5567 4888.15128   176%     -   35s
H    0     2                    -6323.382600 4888.15128   177%     -   42s
     0     2 4888.15128    0  529 -6323.3826 4888.15128   177%     -   42s
     3     8  582.78591    2  685 -6323.3826 4637.80363   173%  1891   46s
    31    56   27.87293    5  705 -6323.3826 3832.31663   161%  1381   50s
H  175   160                    -6055.429807 3135.58978   152%   975   55s
   445   259 -4263.6837   15  181 -6055.4298 3134.67160   152%   681   60s
H  464   259                    -5240.398263 3134.67160   160%   663   60s
H  575   314                    -5157.067950 2308.17940   145%   595   61s
H  678   349                    -4455.921384 1882.92952   142%   550   61s
  1029   519 -2581.6957   21  193 -4455.9214 1882.92952   142%   425   65s
H 1355   617                    -4387.154376 1882.92952   143%   356   68s
H 1366   617                    -3898.044841 1882.92952   148%   355   68s
  1931  1170 -2920.2555   38  114 -3898.0448 1882.92952   148%   274   70s
H 2701  1412                    -3844.406410 1882.92952   149%   207   72s
  4115  2173 -3064.7769   51  529 -3844.4064 -1542.5511  59.9%   151   90s
H 4116  2065                    -3842.662272 -1542.5511  59.9%   151   93s
  4118  2066 -3154.1380   46  458 -3842.6623 -1542.5511  59.9%   151   95s
H 4118  1962                    -3807.329406 -1542.5511  59.5%   151   96s
H 4123  1867                    -3778.664486 -1542.5511  59.2%   151  100s
H 4123  1773                    -3756.065818 -1542.5511  58.9%   151  100s
H 4125  1687                    -3744.787323 -1542.5511  58.8%   151  102s
H 4127  1603                    -3721.250629 -1542.5511  58.5%   151  104s
  4128  1604 -2597.9220   25  529 -3721.2506 -1542.5511  58.5%   151  105s
H 4130  1524                    -3713.386269 -1542.5511  58.5%   151  108s
H 4130  1448                    -3703.805054 -1542.5511  58.4%   151  108s
H 4130  1375                    -3702.092397 -1542.5511  58.3%   151  108s
H 4130  1306                    -3695.205061 -1542.5511  58.3%   151  109s
H 4132  1242                    -3691.975263 -1542.5511  58.2%   150  110s
H 4132  1179                    -3689.320790 -1542.5511  58.2%   150  110s
  4134  1181 -2932.4747   28  526 -3689.3208 -1542.5511  58.2%   150  115s
  4136  1185 -1542.5511   10  447 -3689.3208 -1542.5511  58.2%   157  120s
  4164  1204 -1623.6041   14  252 -3689.3208 -1542.5511  58.2%   162  125s
H 4171  1142                    -3656.824165 -1542.5511  57.8%   162  125s
H 4233  1079                    -3652.403619 -1542.5511  57.8%   167  127s
H 4322   968                    -3652.188205 -1542.5511  57.8%   169  128s
H 4328   915                    -3650.199109 -1542.5511  57.7%   170  128s
H 4341   862                    -3645.556414 -1542.5511  57.7%   170  128s
H 4344   815                    -3637.597896 -1542.5511  57.6%   170  128s
  4636   874 -3346.5660   29   79 -3637.5979 -3022.5521  16.9%   164  130s
H 4775   826                    -3613.776896 -3022.5521  16.4%   160  130s
H 4785   781                    -3613.715290 -3022.5521  16.4%   159  130s
H 4793   739                    -3589.646690 -3022.5521  15.8%   159  130s
H 5546   749                    -3567.225907 -3078.1128  13.7%   139  130s
H 5577   704                    -3557.861673 -3312.7584  6.89%   138  130s
H 8531   643                    -3557.380989 -3504.3803  1.49%  93.0  132s
H 8708   643                    -3557.027658 -3507.7671  1.38%  91.3  132s

Cutting planes:
  MIR: 135
  Flow cover: 412
  Inf proof: 1
  RLT: 5
  Relax-and-lift: 27

Explored 10510 nodes (848920 simplex iterations) in 133.57 seconds (177.56 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3557.03 -3557.38 -3557.86 ... -3650.2
No other solutions better than -3557.03

Optimal solution found (tolerance 1.00e-06)
Best objective -3.557027657521e+03, best bound -3.557027657521e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 133.58s
  Master Objective (UB) = -3557.03, θ = 111115.17
  Upper Bound (UB) = -3557.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111115.17
  [DEBUG]   ✓ Scenario 0: θ = 111115.17 ≤ Q = 111115.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111115.17 ≤ Q = 111115.17 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x15d1f393
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x15d1f393
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.479041e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.01s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 7994165.6240
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.234263e+05, 279 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123426.31    0  130 7994165.62 -123426.31   102%     -    0s
H    0     0                    -87207.77287 -123426.31  41.5%     -    0s
H    0     0                    -88067.97339 -123426.31  40.1%     -    0s
H    0     0                    -95197.20682 -123426.31  29.7%     -    0s
H    0     0                    -107631.0803 -109423.52  1.67%     -    0s
H    0     0                    -108324.3172 -109423.52  1.01%     -    0s
     0     0 -109423.52    0   59 -108324.32 -109423.52  1.01%     -    0s
     0     0 -109286.20    0   59 -108324.32 -109286.20  0.89%     -    0s
     0     0 -109027.65    0   30 -108324.32 -109027.65  0.65%     -    0s
H    0     0                    -108721.4804 -109026.61  0.28%     -    0s
     0     0 -108907.51    0   33 -108721.48 -108907.51  0.17%     -    0s
     0     0 -108856.68    0   21 -108721.48 -108856.68  0.12%     -    0s
     0     0 -108856.66    0   21 -108721.48 -108856.66  0.12%     -    0s
     0     0 -108845.38    0   18 -108721.48 -108845.38  0.11%     -    0s
     0     0 -108822.33    0   16 -108721.48 -108822.33  0.09%     -    0s
     0     0 -108790.86    0   10 -108721.48 -108790.86  0.06%     -    0s
     0     0 -108773.06    0    8 -108721.48 -108773.06  0.05%     -    0s
     0     0 -108760.98    0    6 -108721.48 -108760.98  0.04%     -    0s
     0     0 -108753.53    0    4 -108721.48 -108753.53  0.03%     -    0s
     0     0 -108746.33    0    3 -108721.48 -108746.33  0.02%     -    0s
     0     0 -108744.26    0    4 -108721.48 -108744.26  0.02%     -    0s
H    0     0                    -108726.6498 -108744.26  0.02%     -    0s
H    0     0                    -108737.1332 -108744.26  0.01%     -    0s
     0     0     cutoff    0      -108737.13 -108737.13  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 4
  Flow cover: 2
  RLT: 2

Explored 1 nodes (633 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -108737 -108727 -108721 ... 7.99417e+06
No other solutions better than -108737

Optimal solution found (tolerance 1.00e-06)
Best objective -1.087371331638e+05, best bound -1.087371331638e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 85954.41
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108737.13
  [DEBUG]   S×d_nominal = 194691.55
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 194691.55 + -108737.13 = 85954.41
  [DEBUG]   Current θ from Master = 111115.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25160.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28717.79
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 5571.1484, Absolute Gap = 5571.1484, Relative Gap = 1.566237
  Not converged yet (gap = 5571.15 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xa3c9067e
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -28717.8 (0.03s)
Loaded MIP start from previous solve with objective -28717.8

Presolve removed 21310 rows and 8660 columns
Presolve time: 0.67s
Presolved: 25943 rows, 12320 columns, 159749 nonzeros
Variable types: 10061 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27566    1.2861284e+04   0.000000e+00   1.022356e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   17019    1.3836176e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 1.383618e+04, 17019 iterations, 6.20 seconds (7.82 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13836.1760    0  133 -28717.788 13836.1760   148%     -    7s
H    0     0                    -22906.18914 13836.1760   160%     -    7s
H    0     0                    -20016.54154 13836.1760   169%     -    8s
H    0     0                    -18091.37204 13836.1760   176%     -    8s
H    0     0                    -18090.00133 13836.1760   176%     -    8s
H    0     0                    -18080.32766 13836.1760   177%     -    8s
H    0     0                    -18074.19874 13836.1760   177%     -    8s
     0     0 10287.5516    0  403 -18074.199 10287.5516   157%     -   10s
H    0     0                    -15628.89651 10286.3752   166%     -   10s
H    0     0                    -15225.20332 10286.3752   168%     -   10s
H    0     0                    -15176.25005 10286.3752   168%     -   10s
H    0     0                    -15148.22125 10286.3752   168%     -   10s
H    0     0                    -14830.90399 10286.3752   169%     -   10s
H    0     0                    -14655.35021 10286.3752   170%     -   10s
H    0     0                    -14624.99424 10286.3752   170%     -   10s
H    0     0                    -14404.03527 10286.3752   171%     -   10s
H    0     0                    -14378.06350 10286.3752   172%     -   10s
H    0     0                    -14157.10453 10286.3752   173%     -   10s
     0     0 10107.7703    0  405 -14157.105 10107.7703   171%     -   11s
     0     0 10104.6363    0  408 -14157.105 10104.6363   171%     -   11s
     0     0 10091.9915    0  405 -14157.105 10091.9915   171%     -   11s
     0     0 10091.4017    0  402 -14157.105 10091.4017   171%     -   11s
     0     0 10091.3315    0  399 -14157.105 10091.3315   171%     -   11s
     0     0 8076.48682    0  385 -14157.105 8076.48682   157%     -   14s
H    0     0                    -13286.16027 8076.10120   161%     -   14s
H    0     0                    -13212.43553 8076.10120   161%     -   14s
H    0     0                    -13182.47841 8076.10120   161%     -   14s
     0     0 7749.33270    0  394 -13182.478 7749.33270   159%     -   15s
     0     0 7569.35818    0  395 -13182.478 7569.35818   157%     -   16s
     0     0 7556.43744    0  407 -13182.478 7556.43744   157%     -   16s
     0     0 7555.11518    0  405 -13182.478 7555.11518   157%     -   16s
     0     0 7554.75900    0  404 -13182.478 7554.75900   157%     -   16s
     0     0 6380.62171    0  456 -13182.478 6380.62171   148%     -   20s
H    0     0                    -13047.23230 6378.76446   149%     -   20s
H    0     0                    -11403.10498 6378.76446   156%     -   20s
H    0     0                    -11146.34025 6378.76446   157%     -   20s
H    0     0                    -11136.53731 6378.76446   157%     -   20s
H    0     0                    -11013.49345 6378.76446   158%     -   20s
H    0     0                    -10894.26286 6378.76446   159%     -   20s
H    0     0                    -10777.04237 6378.76446   159%     -   20s
     0     0 6263.87823    0  453 -10777.042 6263.87823   158%     -   21s
     0     0 6035.28026    0  465 -10777.042 6035.28026   156%     -   22s
     0     0 6005.81753    0  471 -10777.042 6005.81753   156%     -   22s
     0     0 5992.73930    0  480 -10777.042 5992.73930   156%     -   22s
     0     0 5991.67377    0  480 -10777.042 5991.67377   156%     -   23s
     0     0 5991.65293    0  481 -10777.042 5991.65293   156%     -   23s
H    0     0                    -10632.73408 5991.65293   156%     -   25s
H    0     0                    -10548.20168 5991.65293   157%     -   25s
H    0     0                    -10544.99097 5991.65293   157%     -   25s
     0     0 5542.35269    0  503 -10544.991 5542.35269   153%     -   27s
H    0     0                    -10508.40202 5542.25758   153%     -   27s
H    0     0                    -10503.72385 5542.25758   153%     -   27s
     0     0 5304.18572    0  491 -10503.724 5304.18572   150%     -   28s
     0     0 5268.55197    0  493 -10503.724 5268.55197   150%     -   29s
     0     0 5263.20732    0  495 -10503.724 5263.20732   150%     -   29s
     0     0 5262.65701    0  503 -10503.724 5262.65701   150%     -   29s
     0     0 5127.10609    0  566 -10503.724 5127.10609   149%     -   31s
H    0     0                    -10292.31816 5126.87894   150%     -   31s
H    0     0                    -10197.32047 5126.87894   150%     -   31s
H    0     0                    -9936.798425 5126.87894   152%     -   31s
H    0     0                    -9877.403767 5126.87894   152%     -   31s
H    0     0                    -9874.975874 5126.87894   152%     -   31s
H    0     0                    -9865.908562 5126.87894   152%     -   31s
     0     0 5031.77976    0  505 -9865.9086 5031.77976   151%     -   32s
     0     0 5026.83864    0  513 -9865.9086 5026.83864   151%     -   32s
     0     0 5025.86163    0  509 -9865.9086 5025.86163   151%     -   32s
H    0     0                    -9846.633679 5025.86163   151%     -   33s
H    0     0                    -9723.694207 4958.48573   151%     -   34s
H    0     0                    -8812.078050 4958.48573   156%     -   34s
H    0     0                    -8778.671903 4958.48573   156%     -   34s
H    0     0                    -8612.775900 4958.48573   158%     -   34s
     0     0 4958.48573    0  571 -8612.7759 4958.48573   158%     -   34s
H    0     0                    -8602.683118 4956.38664   158%     -   34s
     0     0 4935.51935    0  508 -8602.6831 4935.51935   157%     -   34s
     0     0 4904.42150    0  516 -8602.6831 4904.42150   157%     -   35s
     0     0 4893.56495    0  519 -8602.6831 4893.56495   157%     -   35s
     0     0 4890.57571    0  523 -8602.6831 4890.57571   157%     -   35s
     0     0 4890.16847    0  520 -8602.6831 4890.16847   157%     -   35s
     0     0 4849.68047    0  526 -8602.6831 4849.68047   156%     -   37s
     0     0 4827.88975    0  528 -8602.6831 4827.88975   156%     -   37s
     0     0 4822.13395    0  532 -8602.6831 4822.13395   156%     -   38s
     0     0 4821.07912    0  536 -8602.6831 4821.07912   156%     -   38s
     0     0 4760.86879    0  516 -8602.6831 4760.86879   155%     -   39s
     0     0 4757.66250    0  529 -8602.6831 4757.66250   155%     -   39s
     0     0 4757.30414    0  533 -8602.6831 4757.30414   155%     -   39s
     0     0 4751.38429    0  532 -8602.6831 4751.38429   155%     -   40s
H    0     0                    -8538.790902 4750.69359   156%     -   41s
     0     0 4750.39184    0  539 -8538.7909 4750.39184   156%     -   41s
     0     0 4746.57339    0  537 -8538.7909 4746.57339   156%     -   42s
     0     0 4745.05630    0  587 -8538.7909 4745.05630   156%     -   42s
     0     0 4744.99275    0  591 -8538.7909 4744.99275   156%     -   42s
     0     0 4736.20876    0  597 -8538.7909 4736.20876   155%     -   43s
     0     0 4736.13322    0  597 -8538.7909 4736.13322   155%     -   44s
     0     2 4736.13322    0  597 -8538.7909 4736.13322   155%     -   52s
     3     8 4120.35497    2  571 -8538.7909 4588.71181   154%  1091   55s
    31    64 3705.03318    5  584 -8538.7909 4229.41048   150%  1288   60s
H   35    64                    -8445.549578 4229.41048   150%  1186   60s
    95   186 3558.63270    7  575 -8445.5496 4223.29366   150%  1039   66s
H   98   186                    -8441.671091 4223.29366   150%  1034   66s
H  134   186                    -8438.976818 4223.29366   150%   880   66s
   185   263 3485.16650    8  580 -8438.9768 4223.29366   150%   778   70s
   329   340 3456.08122    9  578 -8438.9768 4223.29366   150%   683   75s
   461   433 3110.92287   10  553 -8438.9768 4129.62213   149%   681   80s
   578   508 3051.91458   11  507 -8438.9768 4129.62213   149%   656   85s
   677   569 1061.90883   12  445 -8438.9768 4075.76875   148%   648   90s
   785   619 1663.26211   14  506 -8438.9768 4075.76875   148%   673   96s
   866   702 -1413.0970   15  493 -8438.9768 4075.76875   148%   699  101s
H  927   702                    -8035.532784 4075.76875   151%   684  101s
H  950   744                    -7793.625520 4075.76875   152%   689  104s
H  962   744                    -7738.893506 4075.76875   153%   688  104s
  1000   767 -643.77217   16  395 -7738.8935 4075.76875   153%   685  106s
  1043   804 -2067.2268   16  317 -7738.8935 4075.76875   153%   697  110s
  1182   937 -1775.3736   18  344 -7738.8935 4075.76875   153%   713  115s
H 1235   937                    -7725.468623 3941.34663   151%   700  115s
  1578  1235 -3236.6913   23  238 -7725.4686 3941.22501   151%   618  122s
  1703  1328 -3496.7913   26  125 -7725.4686 3625.08547   147%   598  125s
H 2040  1542                    -6634.040494 3625.08547   155%   557  129s
H 2058  1542                    -4529.882125 3625.08547   180%   553  129s
H 2059  1542                    -4517.017455 3625.08547   180%   553  129s
  2146  1566     cutoff   35      -4517.0175 3613.25308   180%   543  131s
H 2175  1566                    -4429.489942 3613.25308   182%   542  131s
H 2206  1566                    -4418.889456 3613.25308   182%   539  131s
  2302  1645 -3876.2301    9  189 -4418.8895 3613.25308   182%   532  135s
  2573  1744 -3056.2582   11  349 -4418.8895 3613.25308   182%   529  143s
  2710  1765 -3178.5672   13  348 -4418.8895 3373.99817   176%   533  147s
  2844  1771     cutoff   17      -4418.8895 3317.46839   175%   535  152s
  2980  1760 -677.01223   11  212 -4418.8895 3317.46839   175%   538  157s
H 3030  1760                    -4321.666830 3317.46839   177%   539  157s
  3122  1739     cutoff   14      -4321.6668 3088.26567   171%   537  161s
H 3133  1739                    -4297.379077 3070.04799   171%   539  161s
H 3166  1739                    -4260.898268 3070.04799   172%   539  161s
  3233  1742 -2139.6486   13  165 -4260.8983 3070.04799   172%   540  165s
  3441  1770 infeasible   13      -4260.8983 2781.13288   165%   545  172s
  3597  1769     cutoff   17      -4260.8983 2746.32926   164%   547  176s
  3771  1757 -2108.0796   12  514 -4260.8983 2746.32926   164%   547  180s
  4054  1773 -3099.2603   18  311 -4260.8983 2746.32926   164%   559  188s
  4170  1774 -1743.8935   11  487 -4260.8983 2675.17552   163%   560  192s
  4245  1808 -2351.5686   14  423 -4260.8983 2613.51207   161%   562  197s
H 4247  1808                    -4259.973273 2613.51207   161%   562  197s
  4321  1859 -2884.7558   16  280 -4259.9733 2531.92073   159%   562  202s
  4544  1947     cutoff   39      -4259.9733 2462.49154   158%   554  206s
  4788  2049     cutoff   38      -4259.9733 2316.93271   154%   549  211s
  5031  2115 -396.96952   17  243 -4259.9733 2189.96005   151%   549  217s
  5305  2226 -3093.1734   22  335 -4259.9733 2189.96005   151%   547  222s
H 5479  2225                    -4259.676081 2026.34031   148%   545  222s
  5558  2226 1079.73914   19  597 -4259.6761 1919.39949   145%   544  241s
  5560  2227 -3668.1225   31  133 -4259.6761 1919.39949   145%   544  250s
  5561  2228 1636.88331    8  426 -4259.6761 1919.39949   145%   544  255s
  5563  2229 -1327.0419   15  507 -4259.6761 1919.39949   145%   544  260s
  5567  2232 -724.59911   12  525 -4259.6761 1919.39949   145%   544  265s
  5569  2233 -4043.2442   26  531 -4259.6761 1919.39949   145%   543  270s
  5572  2235 -1267.5892   17  513 -4259.6761 1919.39949   145%   543  275s
  5574  2237 -3177.6602   34  530 -4259.6761 1919.39949   145%   543  280s
  5577  2239  713.69476   13  600 -4259.6761 1919.39949   145%   543  285s
  5580  2241 -3214.0936   20  603 -4259.6761 1919.39949   145%   542  299s
  5581  2241  818.33029   22  603 -4259.6761 1919.39949   145%   542  305s
  5584  2248 1919.39949   13  561 -4259.6761 1919.39949   145%   551  312s
  5596  2268 1919.39949   15  430 -4259.6761 1919.39949   145%   552  317s
  5644  2305 1919.39949   17  388 -4259.6761 1919.39949   145%   559  322s
  5676  2322 1919.39949   18  376 -4259.6761 1919.39949   145%   560  325s
  5776  2310 -1279.8369   19  205 -4259.6761 1919.39949   145%   563  332s
  5833  2297 1919.39949   20  272 -4259.6761 1919.39949   145%   565  336s
  5905  2290 1653.91721   21  223 -4259.6761 1919.39949   145%   568  340s
  6027  2256     cutoff   22      -4259.6761 1919.39949   145%   577  347s
H 6041  2138                    -4228.575649 1919.39949   145%   576  347s
H 6173  1994                    -4225.506191 1919.39949   145%   578  353s
H 6176  1892                    -4223.130530 1919.39949   145%   578  353s
H 6177  1795                    -4221.098190 1919.39949   145%   578  353s
H 6188  1700                    -4219.186190 1919.39949   145%   578  353s
H 6202  1608                    -4209.879969 1919.39949   146%   578  353s
H 6219  1520                    -4193.528635 1919.39949   146%   577  353s
  6258  1512 -1478.2503   26  226 -4193.5286 1919.39949   146%   577  355s
H 6338  1394                    -4192.708538 1919.39949   146%   576  358s
  6416  1372     cutoff   28      -4192.7085 1919.39949   146%   575  361s
H 6493  1271                    -4186.071810 1827.65738   144%   575  363s
  6570  1224 infeasible   31      -4186.0718 1192.62415   128%   574  365s
  6785  1176 infeasible   24      -4186.0718  413.63432   110%   567  371s
  7111  1135 -2278.8363   24  302 -4186.0718 -582.49346  86.1%   550  376s
H 7315   996                    -4176.276294 -582.49346  86.1%   537  376s
  8086   903     cutoff   28      -4176.2763 -1596.1653  61.8%   489  381s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 194
  Flow cover: 843
  Zero half: 1
  RLT: 3
  Relax-and-lift: 26

Explored 11211 nodes (4032429 simplex iterations) in 384.17 seconds (636.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -4176.28 -4186.07 -4192.71 ... -4259.97
No other solutions better than -4176.28

Optimal solution found (tolerance 1.00e-06)
Best objective -4.176276293906e+03, best bound -4.176276293906e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 384.19s
  Master Objective (UB) = -4176.28, θ = 110950.64
  Upper Bound (UB) = -4176.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110950.64
  [DEBUG]   ✓ Scenario 0: θ = 110950.64 ≤ Q = 110950.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110950.64 ≤ Q = 110950.64 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110950.64 ≤ Q = 110950.64 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1418be19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xebe741e7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.483454e+13
Presolve removed 2606 rows and 1901 columns
Presolve time: 0.01s
Presolved: 487 rows, 488 columns, 1372 nonzeros
Found heuristic solution: objective 8012927.0519
Variable types: 328 continuous, 160 integer (160 binary)

Root relaxation: objective -1.162017e+05, 287 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116201.75    0  134 8012927.05 -116201.75   101%     -    0s
H    0     0                    -74852.31835 -116201.75  55.2%     -    0s
H    0     0                    -75192.03338 -116201.75  54.5%     -    0s
H    0     0                    -91927.37715 -116201.75  26.4%     -    0s
H    0     0                    -98964.68332 -116201.75  17.4%     -    0s
H    0     0                    -100657.2747 -108492.92  7.78%     -    0s
H    0     0                    -101323.3532 -108492.92  7.08%     -    0s
     0     0 -108492.92    0  129 -101323.35 -108492.92  7.08%     -    0s
H    0     0                    -105399.2406 -108429.57  2.88%     -    0s
     0     0 -108296.55    0  128 -105399.24 -108296.55  2.75%     -    0s
     0     0 -108287.77    0  128 -105399.24 -108287.77  2.74%     -    0s
     0     0 -107963.74    0  121 -105399.24 -107963.74  2.43%     -    0s
H    0     0                    -106466.7104 -107902.53  1.35%     -    0s
     0     0 -107668.57    0  109 -106466.71 -107668.57  1.13%     -    0s
     0     0 -107653.44    0  114 -106466.71 -107653.44  1.11%     -    0s
     0     0 -107124.38    0   81 -106466.71 -107124.38  0.62%     -    0s
     0     0 -107085.18    0   82 -106466.71 -107085.18  0.58%     -    0s
     0     0 -106980.53    0   78 -106466.71 -106980.53  0.48%     -    0s
     0     0 -106804.48    0   37 -106466.71 -106804.48  0.32%     -    0s
     0     0 -106791.63    0   53 -106466.71 -106791.63  0.31%     -    0s
     0     0 -106783.82    0   36 -106466.71 -106783.82  0.30%     -    0s
     0     0 -106518.44    0   23 -106466.71 -106518.44  0.05%     -    0s
     0     0 -106512.77    0    9 -106466.71 -106512.77  0.04%     -    0s
     0     0 -106502.82    0    4 -106466.71 -106502.82  0.03%     -    0s
     0     0 -106483.61    0    2 -106466.71 -106483.61  0.02%     -    0s
     0     0 -106478.53    0    2 -106466.71 -106478.53  0.01%     -    0s
H    0     0                    -106478.4940 -106478.53  0.00%     -    0s

Explored 1 nodes (989 simplex iterations) in 0.12 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -106478 -106467 -106391 ... -75192

Optimal solution found (tolerance 1.00e-06)
Best objective -1.064784940489e+05, best bound -1.064785331767e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 88626.11
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -106478.49
  [DEBUG]   S×d_nominal = 195104.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 195104.60 + -106478.49 = 88626.11
  [DEBUG]   Current θ from Master = 110950.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22324.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26500.81
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 4951.8998, Absolute Gap = 4951.8998, Relative Gap = 1.185721
  Not converged yet (gap = 4951.90 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x4ac0efde
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -26500.8 (0.09s)
Loaded MIP start from previous solve with objective -26500.8

Presolve removed 28380 rows and 11530 columns
Presolve time: 0.90s
Presolved: 34163 rows, 15690 columns, 211259 nonzeros
Variable types: 13431 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34163 rows, 15690 columns, 211259 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38306   -6.7470299e+03   0.000000e+00   1.580361e+06      5s
   49080    8.1126584e+03   0.000000e+00   2.218873e+06     10s
   56652    1.1430384e+04   0.000000e+00   2.782626e+05     15s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 1.180236e+04, 31834 iterations, 16.78 seconds (22.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11802.3616    0  120 -26500.806 11802.3616   145%     -   18s
H    0     0                    -26474.73258 11802.3616   145%     -   18s
H    0     0                    -26198.97716 11802.3616   145%     -   18s
H    0     0                    -25283.57121 11802.3616   147%     -   18s
H    0     0                    -23903.96693 11802.3616   149%     -   18s
H    0     0                    -23493.91466 11802.3616   150%     -   18s
H    0     0                    -18146.49301 8032.80156   144%     -   23s
     0     0 8024.13324    0  394 -18146.493 8024.13324   144%     -   23s
H    0     0                    -16964.64388 8024.13324   147%     -   23s
H    0     0                    -12030.85976 8024.13324   167%     -   23s
H    0     0                    -11728.80229 8024.13324   168%     -   23s
H    0     0                    -11368.76224 8024.13324   171%     -   23s
H    0     0                    -10054.56354 8024.13324   180%     -   23s
     0     0 7809.55711    0  390 -10054.564 7809.55711   178%     -   24s
     0     0 7807.87670    0  408 -10054.564 7807.87670   178%     -   25s
     0     0 7740.69972    0  394 -10054.564 7740.69972   177%     -   26s
     0     0 7740.56753    0  395 -10054.564 7740.56753   177%     -   26s
     0     0 4926.42014    0  379 -10054.564 4926.42014   149%     -   31s
H    0     0                    -9892.745407 4925.82364   150%     -   31s
     0     0 4537.90747    0  441 -9892.7454 4537.90747   146%     -   33s
     0     0 4288.25784    0  446 -9892.7454 4288.25784   143%     -   35s
     0     0 4249.76459    0  462 -9892.7454 4249.76459   143%     -   36s
     0     0 4248.97955    0  463 -9892.7454 4248.97955   143%     -   36s
     0     0 4242.73991    0  462 -9892.7454 4242.73991   143%     -   36s
     0     0 4242.56932    0  464 -9892.7454 4242.56932   143%     -   36s
     0     0 3043.73555    0  531 -9892.7454 3043.73555   131%     -   42s
H    0     0                    -9147.867696 3041.94483   133%     -   42s
H    0     0                    -8804.964738 3041.94483   135%     -   42s
     0     0 2740.39437    0  463 -8804.9647 2740.39437   131%     -   45s
H    0     0                    -8787.286702 2664.88716   130%     -   45s
H    0     0                    -8781.437199 2664.88716   130%     -   45s
     0     0 2664.88716    0  415 -8781.4372 2664.88716   130%     -   45s
H    0     0                    -8592.978846 2626.16700   131%     -   46s
H    0     0                    -8543.800752 2626.16700   131%     -   46s
H    0     0                    -8530.930032 2626.16700   131%     -   46s
H    0     0                    -8506.828784 2626.16700   131%     -   46s
H    0     0                    -8461.318881 2626.16700   131%     -   46s
     0     0 2626.16700    0  480 -8461.3189 2626.16700   131%     -   46s
     0     0 2596.96917    0  415 -8461.3189 2596.96917   131%     -   47s
     0     0 2593.56920    0  417 -8461.3189 2593.56920   131%     -   47s
     0     0 2590.87307    0  430 -8461.3189 2590.87307   131%     -   47s
     0     0 2590.04935    0  424 -8461.3189 2590.04935   131%     -   47s
     0     0 2188.85650    0  519 -8461.3189 2188.85650   126%     -   52s
H    0     0                    -8450.141200 2188.79209   126%     -   53s
     0     0 2114.83083    0  519 -8450.1412 2114.83083   125%     -   53s
     0     0 2074.23226    0  504 -8450.1412 2074.23226   125%     -   54s
     0     0 2040.21277    0  523 -8450.1412 2040.21277   124%     -   54s
     0     0 2035.60361    0  526 -8450.1412 2035.60361   124%     -   54s
     0     0 2033.40869    0  532 -8450.1412 2033.40869   124%     -   55s
     0     0 2033.36506    0  532 -8450.1412 2033.36506   124%     -   55s
     0     0 1949.32536    0  521 -8450.1412 1949.32536   123%     -   57s
H    0     0                    -8438.976818 1949.32231   123%     -   57s
     0     0 1933.32623    0  512 -8438.9768 1933.32623   123%     -   58s
     0     0 1929.12139    0  520 -8438.9768 1929.12139   123%     -   58s
     0     0 1880.97489    0  525 -8438.9768 1880.97489   122%     -   59s
     0     0 1865.97841    0  519 -8438.9768 1865.97841   122%     -   60s
     0     0 1859.51079    0  528 -8438.9768 1859.51079   122%     -   60s
     0     0 1857.57950    0  527 -8438.9768 1857.57950   122%     -   60s
     0     0 1857.28300    0  526 -8438.9768 1857.28300   122%     -   60s
     0     0 1780.48915    0  583 -8438.9768 1780.48915   121%     -   62s
     0     0 1760.81932    0  526 -8438.9768 1760.81932   121%     -   66s
     0     0 1754.76090    0  531 -8438.9768 1754.76090   121%     -   66s
     0     0 1746.40170    0  545 -8438.9768 1746.40170   121%     -   66s
     0     0 1744.60691    0  543 -8438.9768 1744.60691   121%     -   67s
     0     0 1744.41415    0  546 -8438.9768 1744.41415   121%     -   67s
     0     0 1714.44204    0  537 -8438.9768 1714.44204   120%     -   68s
     0     0 1706.24967    0  536 -8438.9768 1706.24967   120%     -   69s
     0     0 1705.98491    0  539 -8438.9768 1705.98491   120%     -   69s
     0     0 1685.04091    0  598 -8438.9768 1685.04091   120%     -   70s
     0     0 1679.59583    0  600 -8438.9768 1679.59583   120%     -   71s
     0     0 1675.53195    0  602 -8438.9768 1675.53195   120%     -   71s
     0     0 1674.46561    0  605 -8438.9768 1674.46561   120%     -   71s
     0     0 1668.96095    0  553 -8438.9768 1668.96095   120%     -   72s
     0     0 1646.35427    0  550 -8438.9768 1646.35427   120%     -   73s
     0     0 1645.80286    0  556 -8438.9768 1645.80286   120%     -   74s
     0     0 1641.48765    0  552 -8438.9768 1641.48765   119%     -   75s
     0     0 1638.84686    0  548 -8438.9768 1638.84686   119%     -   75s
     0     0 1638.57886    0  555 -8438.9768 1638.57886   119%     -   75s
     0     0 1634.73071    0  553 -8438.9768 1634.73071   119%     -   76s
     0     0 1633.84979    0  554 -8438.9768 1633.84979   119%     -   77s
     0     0 1631.50699    0  553 -8438.9768 1631.50699   119%     -   78s
     0     0 1629.77747    0  554 -8438.9768 1629.77747   119%     -   79s
     0     0 1629.51014    0  558 -8438.9768 1629.51014   119%     -   79s
     0     0 1628.33508    0  555 -8438.9768 1628.33508   119%     -   80s
     0     0 1628.12493    0  555 -8438.9768 1628.12493   119%     -   81s
     0     2 1627.59665    0  555 -8438.9768 1627.59665   119%     -   94s
     1     4 1534.58503    1  457 -8438.9768 1627.59665   119%  2462   96s
     7    16 1030.31281    3  536 -8438.9768 1399.97155   117%  2169  102s
    15    32  745.37589    4  602 -8438.9768 1225.92002   115%  2642  106s
    31    64  379.39886    5  582 -8438.9768 1036.09163   112%  3310  110s
    95   137  145.57017    7  590 -8438.9768  834.49902   110%  2569  119s
   136   213 -675.72838    8  515 -8438.9768  834.49902   110%  2215  125s
H  159   213                    -8430.856110  834.49902   110%  2168  125s
   219   291 -140.97625    8  577 -8430.8561  834.49902   110%  1850  131s
   301   347 -757.38918    9  440 -8430.8561  834.49902   110%  1674  137s
   379   370 -3641.2236   10  322 -8430.8561  834.49902   110%  1570  143s
   426   422 -823.66327   10  446 -8430.8561  717.48015   109%  1515  149s
   486   469 -1080.0707   12  444 -8430.8561  652.31175   108%  1601  155s
   612   582 -2124.3941   14  514 -8430.8561  652.31175   108%  1646  165s
   680   655 -3212.1513   15  467 -8430.8561  632.67554   108%  1622  170s
   760   683 -5634.1468   15  438 -8430.8561  632.67554   108%  1576  175s
H  763   683                    -8347.036085  632.67554   108%  1574  175s
   794   759 -4988.0930   16  255 -8347.0361  632.67554   108%  1568  180s
H  877   796                    -8338.724326  632.67554   108%  1502  183s
H  893   796                    -8100.385469  632.67554   108%  1509  183s
H  901   796                    -8083.082099  632.67554   108%  1500  184s
   916   879 -3493.6538   17  426 -8083.0821  632.67554   108%  1490  187s
  1019   925 -3609.1658   18  393 -8083.0821  632.67554   108%  1407  190s
  1144  1046 -3956.6530   20  337 -8083.0821  598.30954   107%  1310  197s
  1228  1061 -3972.8127   21  328 -8083.0821  598.30954   107%  1262  203s
  1313  1089 -4819.3023   22  331 -8083.0821  598.30954   107%  1235  206s
H 1339  1089                    -8079.851887  598.30954   107%  1235  206s
  1349  1156 -5812.5390   22  310 -8079.8519  598.30954   107%  1234  210s
  1558  1272 -6678.7801   23  198 -8079.8519  598.30954   107%  1194  220s
  1861  1461 -3224.1094    8  265 -8079.8519  598.30954   107%  1115  230s
  2048  1488 -5009.8313   11  235 -8079.8519  557.08467   107%  1074  235s
  2085  1520 -5039.3011   12  178 -8079.8519  557.08467   107%  1081  240s
  2210  1588 -6057.7352   14  235 -8079.8519  557.08467   107%  1083  249s
  2297  1623 -6741.4522   15  225 -8079.8519  557.08467   107%  1077  256s
  2401  1670 -6878.1177   16  263 -8079.8519  500.07304   106%  1078  263s
  2501  1734     cutoff   22      -8079.8519  500.07304   106%  1077  270s
  2632  1777 -476.40620    8  385 -8079.8519  500.07304   106%  1077  279s
  2735  1831 -837.37374    9  362 -8079.8519  500.07304   106%  1076  286s
  2874  1923 -1499.0827   10  335 -8079.8519  500.07304   106%  1065  294s
  3043  2027 -3433.8598   13  227 -8079.8519  300.65680   104%  1057  303s
  3215  2127 -4010.5266   15  318 -8079.8519  262.95442   103%  1047  312s
  3430  2200 -4580.0363   18  332 -8079.8519  262.95442   103%  1035  322s
  3656  2296 -6598.3466   24  283 -8079.8519   93.31739   101%  1027  330s
  3836  2389 -637.22738   10  559 -8079.8519   93.31739   101%  1030  341s
  4055  2443 -2932.0048   13  324 -8079.8519   93.31739   101%  1025  349s
  4256  2494 -3475.6648   14  400 -8079.8519   93.31739   101%  1014  358s
  4468  2573 -3962.4109   15  398 -8079.8519   93.31739   101%  1009  365s
  4668  2667 -5050.7745   17  368 -8079.8519   93.31739   101%  1009  375s
  4963  2751 -7603.8448   20  364 -8079.8519   88.05506   101%   997  384s
  5254  2836     cutoff   22      -8079.8519 -139.75611  98.3%   991  393s
  5497  2905 -1686.6540   12  288 -8079.8519 -180.97596  97.8%   990  405s
  5800  2967 -3268.8856   17  357 -8079.8519 -266.61009  96.7%   985  416s
  6082  3105 -5390.3142   22  249 -8079.8519 -299.93483  96.3%   988  430s
  6425  3106 -6863.5541   40  555 -8079.8519 -465.80952  94.2%   980  458s
  6427  3107 -6630.1197   20  120 -8079.8519 -465.80952  94.2%   980  471s
  6428  3108 -2310.9269   15  442 -8079.8519 -465.80952  94.2%   980  478s
  6429  3109 -2153.9989   14  463 -8079.8519 -465.80952  94.2%   980  484s
  6430  3109 -5761.3988   13  503 -8079.8519 -465.80952  94.2%   980  489s
  6431  3110 -7747.6549   41  517 -8079.8519 -465.80952  94.2%   980  492s
  6432  3111 -6580.5007   25  510 -8079.8519 -465.80952  94.2%   979  495s
  6436  3113 -7834.3429   28  550 -8079.8519 -465.80952  94.2%   979  500s
  6438  3115 -6142.5672   31  530 -8079.8519 -465.80952  94.2%   978  506s
  6441  3117 -3744.5933   10  464 -8079.8519 -465.80952  94.2%   978  511s
  6444  3119 -5258.0097   15  530 -8079.8519 -465.80952  94.2%   978  516s
  6448  3121 -6128.1760   21  463 -8079.8519 -465.80952  94.2%   977  520s
  6450  3123 -4186.6578   23  488 -8079.8519 -465.80952  94.2%   977  525s
  6451  3123 -2466.9808   19  624 -8079.8519 -465.80952  94.2%   977  530s
  6453  3125 -5606.6915   15  562 -8079.8519 -465.80952  94.2%   976  535s
  6455  3126 -5716.3239   26  566 -8079.8519 -465.80952  94.2%   976  541s
  6457  3127 -3985.9829   12  480 -8079.8519 -465.80952  94.2%   976  545s
  6460  3129 -3248.6994   11  565 -8079.8519 -465.80952  94.2%   975  552s
  6461  3130 -4907.5261   11  565 -8079.8519 -465.80952  94.2%   975  567s
  6462  3131 -5852.8474   13  565 -8079.8519 -465.80952  94.2%   975  580s
  6463  3134 -465.80952   14  474 -8079.8519 -465.80952  94.2%   990  600s
  6465  3138 -465.80952   15  465 -8079.8519 -465.80952  94.2%   990  605s
  6469  3144 -465.80952   16  465 -8079.8519 -465.80952  94.2%   992  610s
  6477  3158 -465.80952   17  539 -8079.8519 -465.80952  94.2%   993  619s
  6493  3184 -465.80952   18  605 -8079.8519 -465.80952  94.2%  1000  627s
  6525  3184 -4043.0761   19  584 -8079.8519 -465.80952  94.2%  1014  635s
  6557  3222 -4190.9467   20  537 -8079.8519 -465.80952  94.2%  1039  644s
  6636  3211 -5560.9345   21  547 -8079.8519 -465.80952  94.2%  1047  650s
  6710  3211 -4727.4956   21  586 -8079.8519 -465.80952  94.2%  1052  655s
  6780  3209 -6019.5840   22  546 -8079.8519 -465.80952  94.2%  1057  662s
  6857  3212 -5766.7290   22  475 -8079.8519 -465.80952  94.2%  1058  668s
  6904  3224 -6141.0063   23  520 -8079.8519 -465.80952  94.2%  1063  673s
  6962  3214 -6819.5164   23  344 -8079.8519 -465.80952  94.2%  1069  678s
  7007  3204 -7416.9327   24  210 -8079.8519 -465.80952  94.2%  1072  683s
  7077  3177     cutoff   25      -8079.8519 -465.80952  94.2%  1073  689s
  7145  3172 -7479.0021   24  477 -8079.8519 -465.80952  94.2%  1073  695s
  7198  3170 -7571.4227   25  437 -8079.8519 -543.86605  93.3%  1078  703s
  7256  3164     cutoff   25      -8079.8519 -543.86605  93.3%  1081  710s
  7331  3155     cutoff   25      -8079.8519 -543.86605  93.3%  1082  716s
  7398  3132     cutoff   28      -8079.8519 -543.86605  93.3%  1083  725s
  7478  3128 -6594.4165   21  313 -8079.8519 -545.10537  93.3%  1085  731s
  7527  3144 -6923.4087   22  273 -8079.8519 -1388.8437  82.8%  1089  735s
  7604  3153     cutoff   24      -8079.8519 -1547.1466  80.9%  1088  743s
  7685  3176     cutoff   26      -8079.8519 -1622.0674  79.9%  1091  751s
  7784  3192 -5652.7647   25  178 -8079.8519 -1622.0674  79.9%  1092  757s
  7898  3176 -7486.1891   27   27 -8079.8519 -1678.5698  79.2%  1090  764s
  8022  3151 -3304.3058   25  434 -8079.8519 -1787.5398  77.9%  1089  772s
  8116  3151 -5337.8816   27  491 -8079.8519 -1796.2206  77.8%  1092  778s
  8241  3160 -6257.1343   28  454 -8079.8519 -1871.8006  76.8%  1090  786s
  8367  3108 -6832.7773   30  278 -8079.8519 -1871.8006  76.8%  1089  793s
  8532  3055     cutoff   31      -8079.8519 -2590.6603  67.9%  1086  801s
  8629  3031 -6192.2219   29  135 -8079.8519 -2748.8999  66.0%  1083  808s
  8756  3015 -6871.0531   31  300 -8079.8519 -2941.2026  63.6%  1083  815s
  8913  2956 -7174.3975   30  210 -8079.8519 -3247.2162  59.8%  1081  825s
  9102  2869     cutoff   34      -8079.8519 -3247.2162  59.8%  1079  833s
  9280  2777 -7539.1681   22  332 -8079.8519 -3647.3702  54.9%  1079  843s
  9481  2683 -8001.5743   27  142 -8079.8519 -3924.0704  51.4%  1075  853s
  9563  2644     cutoff   28      -8079.8519 -3924.0704  51.4%  1077  865s
  9630  2603     cutoff   24      -8079.8519 -3924.0704  51.4%  1076  873s
  9703  2579 -7786.0335   25  449 -8079.8519 -4135.7505  48.8%  1076  880s
  9761  2533     cutoff   26      -8079.8519 -4135.7505  48.8%  1075  888s
  9844  2495 -5655.5795   33  247 -8079.8519 -4135.7505  48.8%  1074  895s
  9925  2450 -5940.6886   34  138 -8079.8519 -4310.8895  46.6%  1073  906s
 10049  2389 -7492.1669   35  183 -8079.8519 -4310.8895  46.6%  1069  914s
 10120  2307 -7493.6415   36  181 -8079.8519 -4519.8391  44.1%  1068  923s
 10254  2233 -6920.5453   25  401 -8079.8519 -4764.0827  41.0%  1063  934s
 10402  2092     cutoff   29      -8079.8519 -4912.8257  39.2%  1061  945s
 10643  1973 -6824.8994   24  442 -8079.8519 -4920.7508  39.1%  1049  955s
 10838  1807 -6489.9183   36  209 -8079.8519 -4920.7508  39.1%  1044  965s
 11070  1640     cutoff   25      -8079.8519 -5791.8429  28.3%  1031  973s
 11261  1542     cutoff   31      -8079.8519 -5791.8429  28.3%  1024  982s
 11322  1515     cutoff   41      -8079.8519 -7154.4924  11.5%  1021  991s
 11339  1508 -8025.6557   29  384 -8079.8519 -7787.7437  3.62%  1020  999s
 11343  1504     cutoff   27      -8079.8519 -7790.6107  3.58%  1019 1003s

Cutting planes:
  Learned: 1
  Gomory: 3
  MIR: 312
  Flow cover: 1228
  RLT: 29
  Relax-and-lift: 56

Explored 11348 nodes (11654132 simplex iterations) in 1003.49 seconds (1789.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8079.85 -8083.08 -8100.39 ... -8530.93
No other solutions better than -8079.85

Optimal solution found (tolerance 1.00e-06)
Best objective -8.079851886778e+03, best bound -8.079851886778e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1003.52s
  Master Objective (UB) = -8079.85, θ = 118046.09
  Upper Bound (UB) = -8079.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118046.09
  [DEBUG]   ✓ Scenario 0: θ = 118046.09 ≤ Q = 118046.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118046.09 ≤ Q = 118046.09 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118046.09 ≤ Q = 118046.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118046.09 ≤ Q = 118046.09 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6731bf88
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x98ce4078
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.365045e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.01s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 6870377.9940
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.307410e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130740.98    0  122 6870377.99 -130740.98   102%     -    0s
H    0     0                    -95986.53364 -130740.98  36.2%     -    0s
H    0     0                    -96249.78621 -130740.98  35.8%     -    0s
     0     0 -113113.90    0  101 -96249.786 -113113.90  17.5%     -    0s
H    0     0                    -109679.1200 -113010.17  3.04%     -    0s
H    0     0                    -110617.8882 -113010.17  2.16%     -    0s
     0     0 -112339.33    0  102 -110617.89 -112339.33  1.56%     -    0s
H    0     0                    -110924.9927 -112306.72  1.25%     -    0s
     0     0 -111803.40    0   82 -110924.99 -111803.40  0.79%     -    0s
     0     0 -111752.09    0   90 -110924.99 -111752.09  0.75%     -    0s
     0     0 -111642.69    0   61 -110924.99 -111642.69  0.65%     -    0s
     0     0 -111566.35    0   71 -110924.99 -111566.35  0.58%     -    0s
     0     0 -111566.30    0   71 -110924.99 -111566.30  0.58%     -    0s
     0     0 -111310.68    0   56 -110924.99 -111310.68  0.35%     -    0s
     0     0 -111253.20    0   48 -110924.99 -111253.20  0.30%     -    0s
     0     0 -111247.21    0   48 -110924.99 -111247.21  0.29%     -    0s
     0     0 -111157.11    0   47 -110924.99 -111157.11  0.21%     -    0s
     0     0 -111112.67    0   46 -110924.99 -111112.67  0.17%     -    0s
     0     0 -111103.24    0   48 -110924.99 -111103.24  0.16%     -    0s
     0     0 -111077.96    0   47 -110924.99 -111077.96  0.14%     -    0s
     0     0 -111068.51    0   47 -110924.99 -111068.51  0.13%     -    0s
H    0     0                    -110928.1380 -111068.51  0.13%     -    0s
     0     0 -111068.51    0   47 -110928.14 -111068.51  0.13%     -    0s
     0     0 -111068.51    0   47 -110928.14 -111068.51  0.13%     -    0s
     0     0 -111068.51    0   44 -110928.14 -111068.51  0.13%     -    0s
     0     0 -111041.95    0   29 -110928.14 -111041.95  0.10%     -    0s
     0     0 -110984.07    0   10 -110928.14 -110984.07  0.05%     -    0s
     0     0 -110958.96    0    7 -110928.14 -110958.96  0.03%     -    0s
     0     0 -110952.44    0    6 -110928.14 -110952.44  0.02%     -    0s
     0     0 -110933.81    0    2 -110928.14 -110933.81  0.01%     -    0s
     0     0 -110928.16    0    2 -110928.14 -110928.16  0.00%     -    0s

Explored 1 nodes (1154 simplex iterations) in 0.26 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -110928 -110925 -110813 ... 1.36505e+13

Optimal solution found (tolerance 1.00e-06)
Best objective -1.109281380281e+05, best bound -1.109281594341e+05, gap 0.0000%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 107108.57
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110928.14
  [DEBUG]   S×d_nominal = 218036.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 218036.71 + -110928.14 = 107108.57
  [DEBUG]   Current θ from Master = 118046.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10937.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19017.37
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 1048.3242, Absolute Gap = 1048.3242, Relative Gap = 0.129745
  Not converged yet (gap = 1048.32 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x2ab72870
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35470 rows and 14410 columns
Presolve time: 2.20s
Presolved: 42363 rows, 19050 columns, 262709 nonzeros
Variable types: 16791 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42363 rows, 19050 columns, 262709 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21311   -3.8798014e+04   0.000000e+00   3.470708e+06      5s
   30848    3.6473081e+03   0.000000e+00   2.716410e+06     10s
Concurrent spin time: 0.63s

Solved with dual simplex

Root relaxation: objective 1.180236e+04, 24169 iterations, 10.06 seconds (12.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11802.3616    0  120 -239633.31 11802.3616   105%     -   12s
H    0     0                    -226256.3653 11802.3616   105%     -   12s
H    0     0                    -183842.7923 11802.3616   106%     -   13s
H    0     0                    -183016.9021 11802.3616   106%     -   13s
H    0     0                    -174541.5316 11802.3616   107%     -   13s
H    0     0                    -174384.3537 11802.3616   107%     -   13s
H    0     0                    -54101.62471 11802.3616   122%     -   13s
H    0     0                    -18242.96394 11802.3616   165%     -   13s
H    0     0                    -9128.796146 11802.3616   229%     -   13s
H    0     0                    -9086.256922 11802.3616   230%     -   13s
H    0     0                    -8954.848337 11802.3616   232%     -   13s
H    0     0                    -8516.146280 11802.3616   239%     -   13s
     0     0 8073.27681    0  402 -8516.1463 8073.27681   195%     -   19s
H    0     0                    -8469.793695 8073.27681   195%     -   19s
     0     0 7837.49558    0  393 -8469.7937 7837.49558   193%     -   21s
     0     0 7833.00457    0  413 -8469.7937 7833.00457   192%     -   22s
     0     0 7832.14630    0  416 -8469.7937 7832.14630   192%     -   22s
     0     0 7743.95720    0  398 -8469.7937 7743.95720   191%     -   23s
     0     0 7743.95720    0  398 -8469.7937 7743.95720   191%     -   23s
     0     0 5089.22260    0  417 -8469.7937 5089.22260   160%     -   31s
H    0     0                    -8463.220935 5086.07677   160%     -   31s
     0     0 4537.87696    0  436 -8463.2209 4537.87696   154%     -   33s
     0     0 4408.30070    0  449 -8463.2209 4408.30070   152%     -   35s
     0     0 4391.31446    0  440 -8463.2209 4391.31446   152%     -   35s
     0     0 4390.55036    0  441 -8463.2209 4390.55036   152%     -   36s
     0     0 4370.78645    0  457 -8463.2209 4370.78645   152%     -   36s
     0     0 4369.90624    0  454 -8463.2209 4369.90624   152%     -   36s
     0     0 4369.83860    0  456 -8463.2209 4369.83860   152%     -   36s
     0     0 3206.16457    0  526 -8463.2209 3206.16457   138%     -   44s
     0     0 2889.91512    0  481 -8463.2209 2889.91512   134%     -   47s
     0     0 2809.68819    0  474 -8463.2209 2809.68819   133%     -   49s
     0     0 2793.81916    0  403 -8463.2209 2793.81916   133%     -   49s
     0     0 2752.10844    0  483 -8463.2209 2752.10844   133%     -   50s
     0     0 2744.22806    0  542 -8463.2209 2744.22806   132%     -   51s
     0     0 2741.59155    0  475 -8463.2209 2741.59155   132%     -   51s
     0     0 2737.99840    0  543 -8463.2209 2737.99840   132%     -   51s
     0     0 2736.73294    0  549 -8463.2209 2736.73294   132%     -   51s
     0     0 2736.71625    0  549 -8463.2209 2736.71625   132%     -   52s
     0     0 2329.68485    0  508 -8463.2209 2329.68485   128%     -   59s
     0     0 2195.92131    0  506 -8463.2209 2195.92131   126%     -   62s
     0     0 2147.01463    0  505 -8463.2209 2147.01463   125%     -   63s
H    0     0                    -8453.903439 2095.61350   125%     -   64s
     0     0 2095.61350    0  564 -8453.9034 2095.61350   125%     -   64s
     0     0 2086.51835    0  499 -8453.9034 2086.51835   125%     -   65s
     0     0 2071.10998    0  580 -8453.9034 2071.10998   124%     -   65s
     0     0 2068.92837    0  514 -8453.9034 2068.92837   124%     -   66s
     0     0 2067.24937    0  581 -8453.9034 2067.24937   124%     -   66s
     0     0 2065.57549    0  577 -8453.9034 2065.57549   124%     -   66s
H    0     0                    -8450.141200 2065.39923   124%     -   66s
     0     0 2065.39923    0  577 -8450.1412 2065.39923   124%     -   66s
     0     0 1951.84171    0  441 -8450.1412 1951.84171   123%     -   70s
     0     0 1933.35553    0  446 -8450.1412 1933.35553   123%     -   71s
     0     0 1925.79034    0  445 -8450.1412 1925.79034   123%     -   72s
     0     0 1920.14976    0  431 -8450.1412 1920.14976   123%     -   72s
     0     0 1913.45485    0  444 -8450.1412 1913.45485   123%     -   73s
     0     0 1912.22354    0  519 -8450.1412 1912.22354   123%     -   73s
     0     0 1910.76982    0  522 -8450.1412 1910.76982   123%     -   73s
     0     0 1910.00829    0  447 -8450.1412 1910.00829   123%     -   74s
     0     0 1882.81563    0  516 -8450.1412 1882.81563   122%     -   75s
H    0     0                    -8438.976818 1882.35159   122%     -   77s
     0     0 1867.44041    0  448 -8438.9768 1867.44041   122%     -   78s
     0     0 1853.39585    0  449 -8438.9768 1853.39585   122%     -   79s
     0     0 1848.31492    0  451 -8438.9768 1848.31492   122%     -   80s
     0     0 1846.68851    0  453 -8438.9768 1846.68851   122%     -   80s
     0     0 1846.20413    0  450 -8438.9768 1846.20413   122%     -   80s
     0     0 1814.01928    0  443 -8438.9768 1814.01928   121%     -   82s
     0     0 1806.71538    0  540 -8438.9768 1806.71538   121%     -   83s
     0     0 1761.17570    0  541 -8438.9768 1761.17570   121%     -   84s
     0     0 1750.25977    0  542 -8438.9768 1750.25977   121%     -   85s
     0     0 1747.17447    0  537 -8438.9768 1747.17447   121%     -   86s
     0     0 1744.63124    0  543 -8438.9768 1744.63124   121%     -   86s
     0     0 1744.04762    0  543 -8438.9768 1744.04762   121%     -   86s
     0     0 1718.25578    0  465 -8438.9768 1718.25578   120%     -   87s
     0     0 1712.25760    0  473 -8438.9768 1712.25760   120%     -   88s
     0     0 1705.86544    0  475 -8438.9768 1705.86544   120%     -   89s
     0     0 1703.46884    0  474 -8438.9768 1703.46884   120%     -   89s
     0     0 1703.03870    0  477 -8438.9768 1703.03870   120%     -   89s
     0     0 1688.56746    0  536 -8438.9768 1688.56746   120%     -   91s
     0     0 1684.54254    0  471 -8438.9768 1684.54254   120%     -   92s
     0     0 1673.87824    0  465 -8438.9768 1673.87824   120%     -   93s
     0     0 1671.90756    0  476 -8438.9768 1671.90756   120%     -   93s
     0     0 1667.33537    0  477 -8438.9768 1667.33537   120%     -   93s
     0     0 1666.91468    0  479 -8438.9768 1666.91468   120%     -   93s
     0     0 1660.74859    0  466 -8438.9768 1660.74859   120%     -   94s
     0     0 1658.98313    0  463 -8438.9768 1658.98313   120%     -   95s
     0     0 1657.68856    0  468 -8438.9768 1657.68856   120%     -   96s
     0     0 1656.29886    0  466 -8438.9768 1656.29886   120%     -   96s
     0     0 1644.78709    0  469 -8438.9768 1644.78709   119%     -   97s
     0     0 1641.56434    0  478 -8438.9768 1641.56434   119%     -   98s
     0     0 1640.18960    0  484 -8438.9768 1640.18960   119%     -   98s
     0     0 1639.62852    0  477 -8438.9768 1639.62852   119%     -   98s
     0     0 1637.22917    0  458 -8438.9768 1637.22917   119%     -   99s
     0     0 1637.15602    0  458 -8438.9768 1637.15602   119%     -  100s
     0     2 1637.15602    0  458 -8438.9768 1637.15602   119%     -  116s
     3     8 1425.39617    2  468 -8438.9768 1587.62616   119%  1983  122s
     7    16 1082.49608    3  525 -8438.9768 1423.23267   117%  3087  128s
    15    32  777.43709    4  518 -8438.9768 1147.48672   114%  3987  135s
    31    52  -38.38712    5  474 -8438.9768  898.08424   111%  5658  148s
    55    84 -234.38762    6  279 -8438.9768  896.38973   111%  5534  154s
    87   116 -323.21621    7  265 -8438.9768  896.38973   111%  4241  159s
   119   150 -741.72727    8  264 -8438.9768  896.38973   111%  3423  164s
   153   195 -790.89033    9  254 -8438.9768  896.38973   111%  2981  171s
   198   249 -824.18273    9  261 -8438.9768  896.38973   111%  2624  180s
   270   288 -1095.5660   10  244 -8438.9768  896.38973   111%  2265  186s
   349   321 -1864.3713   10  230 -8438.9768  873.01865   110%  1998  195s
   420   355 -883.41124   10  265 -8438.9768  847.87087   110%  1923  203s
   484   393 -5118.4577   10  175 -8438.9768  847.87087   110%  1906  213s
   549   429 -4201.8376   11  219 -8438.9768  847.87087   110%  1880  220s
   614   469 -2680.3982   11  241 -8438.9768  847.87087   110%  1868  229s
   670   508 -2825.1700   11  243 -8438.9768  847.87087   110%  1881  238s
   720   553 -3334.2762   11  221 -8438.9768  847.87087   110%  1966  247s
   786   587 -4301.0457   11  240 -8438.9768  728.28876   109%  2032  256s
   838   631 -3482.2894   12  224 -8438.9768  728.28876   109%  2045  265s
   918   662 -4503.1578   12  199 -8438.9768  728.28876   109%  2007  272s
   967   704 -5591.5741   14  206 -8438.9768  728.28876   109%  2016  281s
  1031   732 -5131.5415   14  208 -8438.9768  728.28876   109%  2020  287s
  1073   782 -5150.2731   15  200 -8438.9768  549.71678   107%  2018  297s
  1139   844 -5702.4944   16  264 -8438.9768  546.52534   106%  2025  307s
  1235   936 -5722.1874   17  267 -8438.9768  546.52534   106%  1977  317s
  1365  1018 -6058.7201   19  252 -8438.9768  432.36444   105%  1892  329s
  1487  1113 -6437.2833   21  286 -8438.9768  432.36444   105%  1823  339s
  1614  1228 -6554.1433   24  315 -8438.9768  431.42223   105%  1768  347s
  1763  1290 -7609.0187   30  223 -8438.9768  368.58007   104%  1707  356s
  1930  1339     cutoff   32      -8438.9768  368.58007   104%  1660  367s
  2069  1374 -6041.5583    8  217 -8438.9768  368.58007   104%  1647  376s
  2174  1420 -401.10427   12  416 -8438.9768  368.58007   104%  1633  385s
  2295  1492 -1760.2297   16  299 -8438.9768  368.58007   104%  1622  393s
  2442  1546 -2335.4232   19  283 -8438.9768  368.58007   104%  1601  405s
  2622  1619 -6985.9783   23  216 -8438.9768   43.74380   101%  1565  415s
  2803  1676     cutoff   27      -8438.9768   43.74380   101%  1540  425s
  2993  1737 -3494.1574   24  350 -8438.9768  -15.47083   100%  1528  436s
  3157  1824 -5740.8321   27  289 -8438.9768  -15.47083   100%  1514  447s
  3330  1837 -6503.0929   30  196 -8438.9768 -257.13364  97.0%  1509  455s
  3379  1861     cutoff   29      -8438.9768 -335.12691  96.0%  1511  464s
  3445  1901 -7726.6528   32  253 -8438.9768 -335.12691  96.0%  1506  477s
  3621  1907     cutoff   30      -8438.9768 -404.84804  95.2%  1481  492s
  3791  1974 infeasible   32      -8438.9768 -414.57962  95.1%  1477  506s
  3977  2081 -7679.1344   18   51 -8438.9768 -503.29633  94.0%  1487  522s
  4176  2227 -3311.3955   16  279 -8438.9768 -560.15388  93.4%  1488  536s
  4455  2331 -6956.9710   17  264 -8438.9768 -560.15388  93.4%  1470  552s
  4751  2413     cutoff   22      -8438.9768 -560.15388  93.4%  1459  568s
  5088  2535 -7547.9634   24  292 -8438.9768 -910.87625  89.2%  1439  587s
  5416  2536 -7383.2250   10  458 -8438.9768 -910.87625  89.2%  1422  619s
  5418  2537 -8277.1911   20  120 -8438.9768 -910.87625  89.2%  1422  637s
  5419  2538 -6850.1386   19  424 -8438.9768 -910.87625  89.2%  1422  648s
  5420  2539 -7682.0275   17  540 -8438.9768 -910.87625  89.2%  1421  655s
  5421  2539 -4210.2129   16  562 -8438.9768 -910.87625  89.2%  1421  661s
  5422  2540 -7758.6917   31  580 -8438.9768 -910.87625  89.2%  1421  665s
  5424  2541 -3842.5573   12  455 -8438.9768 -910.87625  89.2%  1420  671s
  5426  2543 -4994.7280   21  531 -8438.9768 -910.87625  89.2%  1420  675s
  5428  2544 -7087.9917   20  520 -8438.9768 -910.87625  89.2%  1419  682s
  5430  2545 -1749.5700    9  608 -8438.9768 -910.87625  89.2%  1419  685s
  5433  2547 -2470.8365   31  550 -8438.9768 -910.87625  89.2%  1418  690s
  5434  2548 -6257.3469   24  434 -8438.9768 -910.87625  89.2%  1418  696s
  5436  2549 -6713.6389   17  458 -8438.9768 -910.87625  89.2%  1417  700s
  5438  2551 -7299.5371   26  548 -8438.9768 -910.87625  89.2%  1417  705s
  5440  2552 -7894.2421   13  457 -8438.9768 -910.87625  89.2%  1416  710s
  5442  2553 -8088.0460   29  562 -8438.9768 -910.87625  89.2%  1415  716s
  5444  2555 -5564.5048   16  471 -8438.9768 -910.87625  89.2%  1415  724s
  5445  2555 -3089.0072   20  479 -8438.9768 -910.87625  89.2%  1415  727s
  5446  2556 -7963.3836   14  464 -8438.9768 -910.87625  89.2%  1414  730s
  5448  2557 -4929.7689   17  466 -8438.9768 -910.87625  89.2%  1414  736s
  5450  2559 -5891.9001   35  533 -8438.9768 -910.87625  89.2%  1413  741s
  5451  2559 -6575.5254   27  533 -8438.9768 -910.87625  89.2%  1413  760s
  5452  2560 -6092.0123   19  533 -8438.9768 -910.87625  89.2%  1413  782s
  5453  2564 -910.87625   10  471 -8438.9768 -910.87625  89.2%  1435  797s
  5455  2567 -910.87625   11  526 -8438.9768 -910.87625  89.2%  1437  805s
  5459  2574 -910.87625   12  590 -8438.9768 -910.87625  89.2%  1438  812s
  5467  2587 -910.87625   13  598 -8438.9768 -910.87625  89.2%  1442  820s
  5483  2594 -2602.9714   14  276 -8438.9768 -910.87625  89.2%  1456  838s
  5502  2608 -910.87625   15  471 -8438.9768 -910.87625  89.2%  1477  853s
  5534  2664 -936.31138   16  442 -8438.9768 -910.87625  89.2%  1493  867s
  5643  2640 -3936.4890   20  300 -8438.9768 -910.87625  89.2%  1507  884s
  5731  2632 -1639.1977   20  378 -8438.9768 -910.87625  89.2%  1524  897s
  5785  2634 -7455.1541   18   66 -8438.9768 -910.87625  89.2%  1547  908s
  5846  2622 -1711.1174   19  298 -8438.9768 -910.87625  89.2%  1570  919s
  5917  2634 -4022.7917   21  295 -8438.9768 -910.87625  89.2%  1576  930s
  5988  2616 -2260.9493   23  305 -8438.9768 -910.87625  89.2%  1580  942s
  6047  2621 -2794.6854   24  263 -8438.9768 -910.87625  89.2%  1584  952s
  6117  2607 -6637.5653   25   66 -8438.9768 -910.87625  89.2%  1586  963s
  6179  2600 -3385.2286   25  397 -8438.9768 -910.87625  89.2%  1590  979s
  6257  2597     cutoff   24      -8438.9768 -910.87625  89.2%  1593  989s
  6305  2614 -4219.0958   27  340 -8438.9768 -910.87625  89.2%  1621 1000s
  6364  2610 -4445.7617   28  158 -8438.9768 -910.87625  89.2%  1630 1007s
  6408  2635 -4639.6567   29  314 -8438.9768 -910.87625  89.2%  1635 1016s
  6473  2639 -4901.4682   32  224 -8438.9768 -910.87625  89.2%  1637 1027s
  6532  2643     cutoff   32      -8438.9768 -910.87625  89.2%  1636 1038s
  6617  2626     cutoff   36      -8438.9768 -910.87625  89.2%  1630 1048s
  6712  2624     cutoff   37      -8438.9768 -910.87625  89.2%  1632 1060s
  6817  2612     cutoff   42      -8438.9768 -910.87625  89.2%  1633 1071s
  6909  2612 -6977.2922   16  285 -8438.9768 -910.87625  89.2%  1637 1079s
  7001  2623     cutoff   17      -8438.9768 -1064.9964  87.4%  1638 1091s
  7095  2596     cutoff   17      -8438.9768 -1064.9964  87.4%  1640 1100s
  7147  2587 -6224.1432   17  397 -8438.9768 -1064.9964  87.4%  1645 1111s
  7209  2568 -6582.7332   18  474 -8438.9768 -1064.9964  87.4%  1649 1125s
  7285  2548 -6835.1952   19  438 -8438.9768 -1187.3821  85.9%  1651 1134s
  7356  2555 -7688.1005   20  451 -8438.9768 -1337.9444  84.1%  1651 1147s
  7424  2543 -8350.7482   21  326 -8438.9768 -1410.7563  83.3%  1656 1161s
  7503  2535     cutoff   22      -8438.9768 -1410.7563  83.3%  1658 1173s
  7604  2529 -7736.9249   24  112 -8438.9768 -1410.7563  83.3%  1659 1188s
H 7623  2393                    -8425.383902 -1410.7563  83.3%  1659 1188s
  7697  2399 -7842.6169   25  106 -8425.3839 -1410.7563  83.3%  1659 1202s
  7876  2365 -3639.7574   22  220 -8425.3839 -2604.3975  69.1%  1656 1214s
  8045  2348 -4946.5076   24  214 -8425.3839 -2891.2064  65.7%  1654 1228s
  8209  2306 -6368.2012   28  311 -8425.3839 -2891.2064  65.7%  1654 1243s
  8376  2267 infeasible   28      -8425.3839 -3125.5998  62.9%  1654 1259s
  8573  2210 -6642.9923   28  157 -8425.3839 -3461.1557  58.9%  1656 1272s
  8753  2162 infeasible   21      -8425.3839 -3762.9620  55.3%  1657 1290s
  8913  2105     cutoff   20      -8425.3839 -3934.5402  53.3%  1656 1309s
  9147  1961 -6958.9760   31  141 -8425.3839 -3964.5987  52.9%  1649 1326s
  9412  1794 -6807.3542   20  346 -8425.3839 -4358.5325  48.3%  1643 1344s
  9689  1644     cutoff   24      -8425.3839 -4675.5041  44.5%  1637 1364s
  9968  1533     cutoff   29      -8425.3839 -5080.3240  39.7%  1633 1381s
 10046  1482 -6626.9281   19  427 -8425.3839 -5094.5022  39.5%  1634 1397s
 10152  1361     cutoff   25      -8425.3839 -5339.2818  36.6%  1633 1414s
 10373  1156 -7576.2194   26  536 -8425.3839 -5376.3778  36.2%  1622 1433s
 10698   828 -7544.6641   24  482 -8425.3839 -5569.8809  33.9%  1611 1453s
 11071   558 -7826.5498   19  434 -8425.3839 -5908.9293  29.9%  1585 1465s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 403
  Mixing: 1
  Flow cover: 1473
  RLT: 24
  Relax-and-lift: 97

Explored 11288 nodes (17806739 simplex iterations) in 1465.57 seconds (2712.60 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8425.38 -8438.98 -8450.14 ... -9128.8
No other solutions better than -8425.38

Optimal solution found (tolerance 1.00e-06)
Best objective -8.425383901710e+03, best bound -8.425383901710e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1465.59s
  Master Objective (UB) = -8425.38, θ = 119029.33
  Upper Bound (UB) = -8425.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119029.33
  [DEBUG]   ✓ Scenario 0: θ = 119029.33 ≤ Q = 119029.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119029.33 ≤ Q = 119029.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119029.33 ≤ Q = 119029.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119029.33 ≤ Q = 119029.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119029.33 ≤ Q = 119029.33 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7810e3bc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7810e3bc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.371410e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6821220.1699
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.295310e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129531.00    0  122 6821220.17 -129531.00   102%     -    0s
H    0     0                    -94703.84756 -129531.00  36.8%     -    0s
H    0     0                    -94967.10012 -129531.00  36.4%     -    0s
     0     0 -106685.73    0   93 -94967.100 -106685.73  12.3%     -    0s
H    0     0                    -103563.9004 -106579.81  2.91%     -    0s
     0     0 -106094.16    0   95 -103563.90 -106094.16  2.44%     -    0s
H    0     0                    -104511.7848 -106076.56  1.50%     -    0s
     0     0 -105924.43    0   95 -104511.78 -105924.43  1.35%     -    0s
     0     0 -105582.42    0   68 -104511.78 -105582.42  1.02%     -    0s
     0     0 -105562.68    0   74 -104511.78 -105562.68  1.01%     -    0s
     0     0 -105499.10    0   64 -104511.78 -105499.10  0.94%     -    0s
     0     0 -105334.86    0   53 -104511.78 -105334.86  0.79%     -    0s
     0     0 -105245.77    0   56 -104511.78 -105245.77  0.70%     -    0s
     0     0 -105244.84    0   57 -104511.78 -105244.84  0.70%     -    0s
     0     0 -105191.20    0   57 -104511.78 -105191.20  0.65%     -    0s
     0     0 -105172.23    0   57 -104511.78 -105172.23  0.63%     -    0s
H    0     0                    -104863.5874 -105172.23  0.29%     -    0s
H    0     0                    -104921.6025 -105172.23  0.24%     -    0s
     0     0 -105172.23    0   80 -104921.60 -105172.23  0.24%     -    0s
     0     0 -105172.23    0   60 -104921.60 -105172.23  0.24%     -    0s
     0     0 -105091.10    0   47 -104921.60 -105091.10  0.16%     -    0s
     0     0 -105067.51    0   50 -104921.60 -105067.51  0.14%     -    0s
     0     0 -105065.88    0   51 -104921.60 -105065.88  0.14%     -    0s
     0     0 -105004.87    0   39 -104921.60 -105004.87  0.08%     -    0s
     0     0 -105004.74    0   40 -104921.60 -105004.74  0.08%     -    0s
     0     0 -104991.84    0   40 -104921.60 -104991.84  0.07%     -    0s
     0     0 -104979.22    0   39 -104921.60 -104979.22  0.05%     -    0s
     0     0 -104979.16    0   39 -104921.60 -104979.16  0.05%     -    0s
     0     0 -104979.16    0   41 -104921.60 -104979.16  0.05%     -    0s
     0     0 -104979.16    0   37 -104921.60 -104979.16  0.05%     -    0s
     0     0 -104979.16    0   35 -104921.60 -104979.16  0.05%     -    0s
     0     0 -104974.69    0   34 -104921.60 -104974.69  0.05%     -    0s
     0     0 -104974.28    0   34 -104921.60 -104974.28  0.05%     -    0s
H    0     0                    -104957.0277 -104974.28  0.02%     -    0s

Cutting planes:
  Gomory: 22
  Implied bound: 4
  MIR: 50
  Flow cover: 11

Explored 1 nodes (1360 simplex iterations) in 0.49 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -104957 -104922 -104864 ... 1.37141e+13
No other solutions better than -104957

Optimal solution found (tolerance 1.00e-06)
Best objective -1.049570276765e+05, best bound -1.049570276765e+05, gap 0.0000%
  Subproblem solved in 0.53s
  Worst-case operational profit (Z_SP) = 112922.28
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104957.03
  [DEBUG]   S×d_nominal = 217879.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217879.31 + -104957.03 = 112922.28
  [DEBUG]   Current θ from Master = 119029.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6107.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14532.43
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 702.7922, Absolute Gap = 702.7922, Relative Gap = 0.083414
  Not converged yet (gap = 702.79 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x267c4b08
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42600 rows and 17310 columns
Presolve time: 1.45s
Presolved: 50523 rows, 22390 columns, 314039 nonzeros
Variable types: 20131 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50523 rows, 22390 columns, 314039 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23547   -5.0736962e+04   0.000000e+00   7.801439e+06      5s
   32395   -3.8020427e+03   0.000000e+00   1.822080e+06     10s
   39183    1.6541576e+03   0.000000e+00   7.316611e+06     15s
   45080    5.1241894e+03   0.000000e+00   2.806936e+09     20s
Concurrent spin time: 0.20s

Solved with dual simplex

Root relaxation: objective 1.176344e+04, 38217 iterations, 23.06 seconds (30.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11763.4416    0  121 -239633.31 11763.4416   105%     -   25s
H    0     0                    -229155.5646 11763.4416   105%     -   25s
H    0     0                    -165965.7828 11763.4416   107%     -   25s
H    0     0                    -165827.4869 11763.4416   107%     -   25s
H    0     0                    -54197.70364 11763.4416   122%     -   25s
H    0     0                    -10113.67929 11763.4416   216%     -   25s
H    0     0                    -9473.030635 11763.4416   224%     -   26s
H    0     0                    -9333.890222 11763.4416   226%     -   26s
H    0     0                    -8716.707335 11763.4416   235%     -   26s
H    0     0                    -8653.641672 8064.86195   193%     -   36s
H    0     0                    -8589.767844 8064.86195   194%     -   36s
H    0     0                    -8586.132648 8064.86195   194%     -   36s
     0     0 8063.92324    0  389 -8586.1326 8063.92324   194%     -   36s
     0     0 7896.37409    0  338 -8586.1326 7896.37409   192%     -   38s
     0     0 7894.96006    0  344 -8586.1326 7894.96006   192%     -   39s
     0     0 7803.76813    0  345 -8586.1326 7803.76813   191%     -   39s
     0     0 7803.76813    0  345 -8586.1326 7803.76813   191%     -   39s
     0     0 6151.42760    0  259 -8586.1326 6151.42760   172%     -   46s
H    0     0                    -8570.242392 6151.42760   172%     -   46s
     0     0 5296.48126    0  377 -8570.2424 5296.48126   162%     -   52s
     0     0 5162.74266    0  397 -8570.2424 5162.74266   160%     -   54s
     0     0 5051.91738    0  443 -8570.2424 5051.91738   159%     -   56s
     0     0 5015.56958    0  444 -8570.2424 5015.56958   159%     -   57s
     0     0 5008.49473    0  440 -8570.2424 5008.49473   158%     -   58s
     0     0 5002.36209    0  443 -8570.2424 5002.36209   158%     -   58s
     0     0 5000.16603    0  443 -8570.2424 5000.16603   158%     -   59s
     0     0 4999.93530    0  445 -8570.2424 4999.93530   158%     -   59s
     0     0 3525.93246    0  528 -8570.2424 3525.93246   141%     -   70s
     0     0 3204.52261    0  542 -8570.2424 3204.52261   137%     -   74s
     0     0 3157.61054    0  537 -8570.2424 3157.61054   137%     -   76s
     0     0 3098.32012    0  534 -8570.2424 3098.32012   136%     -   77s
     0     0 3074.14193    0  489 -8570.2424 3074.14193   136%     -   78s
     0     0 3068.67475    0  550 -8570.2424 3068.67475   136%     -   79s
     0     0 3008.72212    0  482 -8570.2424 3008.72212   135%     -   80s
     0     0 2992.71227    0  481 -8570.2424 2992.71227   135%     -   81s
     0     0 2989.95796    0  480 -8570.2424 2989.95796   135%     -   81s
     0     0 2989.72949    0  485 -8570.2424 2989.72949   135%     -   81s
     0     0 2560.41226    0  489 -8570.2424 2560.41226   130%     -   88s
     0     0 2288.83867    0  498 -8570.2424 2288.83867   127%     -   92s
     0     0 2235.11931    0  495 -8570.2424 2235.11931   126%     -   93s
     0     0 2158.29165    0  494 -8570.2424 2158.29165   125%     -   95s
     0     0 2146.00140    0  495 -8570.2424 2146.00140   125%     -   96s
     0     0 2141.37727    0  506 -8570.2424 2141.37727   125%     -   96s
     0     0 2140.25273    0  503 -8570.2424 2140.25273   125%     -   96s
     0     0 2140.16518    0  504 -8570.2424 2140.16518   125%     -   96s
     0     0 2040.18848    0  516 -8570.2424 2040.18848   124%     -   99s
     0     0 2024.95108    0  438 -8570.2424 2024.95108   124%     -  100s
     0     0 2019.59217    0  528 -8570.2424 2019.59217   124%     -  101s
     0     0 2015.48348    0  456 -8570.2424 2015.48348   124%     -  101s
     0     0 1984.64986    0  527 -8570.2424 1984.64986   123%     -  103s
     0     0 1972.57244    0  532 -8570.2424 1972.57244   123%     -  103s
     0     0 1967.91484    0  527 -8570.2424 1967.91484   123%     -  104s
     0     0 1967.54170    0  532 -8570.2424 1967.54170   123%     -  104s
H    0     0                    -8504.387390 1967.54170   123%     -  105s
     0     0 1925.32817    0  536 -8504.3874 1925.32817   123%     -  106s
H    0     0                    -8501.693117 1904.21035   122%     -  111s
H    0     0                    -8497.814630 1904.21035   122%     -  111s
     0     0 1904.21035    0  531 -8497.8146 1904.21035   122%     -  111s
     0     0 1900.71093    0  459 -8497.8146 1900.71093   122%     -  112s
     0     0 1900.49913    0  541 -8497.8146 1900.49913   122%     -  112s
     0     0 1847.70508    0  449 -8497.8146 1847.70508   122%     -  115s
     0     0 1826.27996    0  532 -8497.8146 1826.27996   121%     -  117s
     0     0 1818.14062    0  454 -8497.8146 1818.14062   121%     -  117s
     0     0 1816.51854    0  447 -8497.8146 1816.51854   121%     -  117s
     0     0 1816.17540    0  453 -8497.8146 1816.17540   121%     -  117s
     0     0 1798.38008    0  533 -8497.8146 1798.38008   121%     -  119s
     0     0 1791.92488    0  539 -8497.8146 1791.92488   121%     -  120s
     0     0 1790.85431    0  535 -8497.8146 1790.85431   121%     -  120s
     0     0 1755.44969    0  537 -8497.8146 1755.44969   121%     -  122s
     0     0 1751.44421    0  454 -8497.8146 1751.44421   121%     -  124s
     0     0 1750.72422    0  458 -8497.8146 1750.72422   121%     -  124s
     0     0 1740.44807    0  551 -8497.8146 1740.44807   120%     -  125s
     0     0 1737.75472    0  554 -8497.8146 1737.75472   120%     -  127s
     0     0 1737.44793    0  551 -8497.8146 1737.44793   120%     -  127s
     0     0 1728.85929    0  610 -8497.8146 1728.85929   120%     -  129s
     0     0 1726.63255    0  613 -8497.8146 1726.63255   120%     -  130s
     0     0 1725.63560    0  541 -8497.8146 1725.63560   120%     -  130s
     0     0 1667.98599    0  607 -8497.8146 1667.98599   120%     -  133s
     0     0 1635.94947    0  606 -8497.8146 1635.94947   119%     -  135s
     0     0 1628.51913    0  539 -8497.8146 1628.51913   119%     -  135s
     0     0 1625.75008    0  609 -8497.8146 1625.75008   119%     -  135s
     0     0 1625.22638    0  612 -8497.8146 1625.22638   119%     -  136s
     0     0 1618.18634    0  616 -8497.8146 1618.18634   119%     -  137s
     0     0 1609.25491    0  609 -8497.8146 1609.25491   119%     -  139s
     0     0 1607.35070    0  612 -8497.8146 1607.35070   119%     -  139s
     0     0 1606.84240    0  615 -8497.8146 1606.84240   119%     -  140s
     0     0 1596.36818    0  601 -8497.8146 1596.36818   119%     -  141s
     0     0 1591.61900    0  596 -8497.8146 1591.61900   119%     -  142s
     0     0 1591.61900    0  601 -8497.8146 1591.61900   119%     -  142s
     0     0 1590.89763    0  606 -8497.8146 1590.89763   119%     -  144s
     0     0 1588.90263    0  599 -8497.8146 1588.90263   119%     -  144s
     0     0 1588.47309    0  609 -8497.8146 1588.47309   119%     -  145s
     0     0 1580.58211    0  603 -8497.8146 1580.58211   119%     -  146s
     0     0 1577.09863    0  615 -8497.8146 1577.09863   119%     -  147s
     0     0 1576.31587    0  621 -8497.8146 1576.31587   119%     -  148s
     0     0 1575.02146    0  612 -8497.8146 1575.02146   119%     -  149s
     0     0 1573.94185    0  612 -8497.8146 1573.94185   119%     -  151s
     0     2 1573.94185    0  612 -8497.8146 1573.94185   119%     -  176s
     3     8 1305.00232    2  587 -8497.8146 1511.05761   118%  2253  181s
     7    16  927.30891    3  604 -8497.8146 1352.63922   116%  3138  189s
    15    32  632.29725    4  627 -8497.8146 1223.88514   114%  4544  198s
    31    49 -5895.7762    5  178 -8497.8146  919.04791   111%  6738  218s
    48    81 -5754.3780    6  215 -8497.8146  912.02453   111%  6732  234s
    80   222 -5886.4594    7  197 -8497.8146  912.02453   111%  5063  249s
   221   311 -6018.3540    9  189 -8497.8146  912.02453   111%  2572  257s
   339   324 -6053.0520   10  178 -8497.8146  912.02453   111%  1982  267s
   438   333 -6200.1525   12  173 -8497.8146  912.02453   111%  1737  277s
   516   355 -6240.1023   12  180 -8497.8146  912.02453   111%  1649  286s
   576   375     cutoff   13      -8497.8146  912.02453   111%  1656  294s
   614   406 -6159.0807   12  178 -8497.8146  912.02453   111%  1691  303s
   667   448 -7677.3200   13  143 -8497.8146  863.66757   110%  1684  310s
   725   492 -8485.8227   13  101 -8497.8146  632.28803   107%  1661  316s
H  739   492                    -8447.168527  632.28803   107%  1647  316s
   777   546 -610.25907    8  349 -8447.1685  632.28803   107%  1635  325s
   860   602 -717.46312    9  418 -8447.1685  632.28803   107%  1582  332s
   932   676 -929.99122    9  361 -8447.1685  632.28803   107%  1564  341s
  1027   703 -1163.8525   10  393 -8447.1685  632.28803   107%  1522  351s
  1084   742 -1123.1989   11  423 -8447.1685  546.06949   106%  1514  361s
  1151   770 -6563.1535   10  136 -8447.1685  546.06949   106%  1541  370s
  1184   806 -1292.7869   11  372 -8447.1685  546.06949   106%  1554  378s
  1236   827 -5409.8303   11  154 -8447.1685  546.06949   106%  1559  384s
  1297   865 -4842.9467   11  410 -8447.1685  546.06949   106%  1537  395s
  1375   924 -1584.5911   12  376 -8447.1685  546.06949   106%  1509  403s
  1463  1009 -1974.3349   13  264 -8447.1685  -14.04921   100%  1501  411s
  1583  1097 -3126.9784   12  349 -8447.1685  -14.04921   100%  1468  421s
  1725  1183 -8184.2404    8  115 -8447.1685  -14.04921   100%  1427  431s
  1845  1253 -8153.4727   13  115 -8447.1685 -109.09573  98.7%  1415  442s
  1985  1275 -2180.5144   14  261 -8447.1685 -109.09573  98.7%  1397  449s
  2027  1286 -7973.1840   13   97 -8447.1685 -111.77154  98.7%  1404  458s
  2078  1305 -2225.5718   14  220 -8447.1685 -111.94470  98.7%  1414  468s
  2123  1322 -2360.1057   14  318 -8447.1685 -111.94470  98.7%  1420  478s
  2180  1352 -2471.7998   15  245 -8447.1685 -111.94470  98.7%  1426  486s
  2222  1378 -2510.4049   15  249 -8447.1685 -111.94470  98.7%  1434  492s
  2272  1413 -6941.4880   15   58 -8447.1685 -111.94470  98.7%  1441  503s
  2323  1457 -2645.5388   16  222 -8447.1685 -111.94470  98.7%  1454  511s
  2389  1494 -3602.9069   17  335 -8447.1685 -111.94470  98.7%  1453  522s
  2474  1547 -2652.5726   16  278 -8447.1685 -111.94470  98.7%  1448  530s
  2591  1587 -3301.4694   17  223 -8447.1685 -265.00759  96.9%  1430  541s
  2719  1656 -7435.7653   15   72 -8447.1685 -265.00759  96.9%  1422  552s
  2875  1734 -5228.5594   17  213 -8447.1685 -351.85875  95.8%  1408  564s
  3017  1785 -8291.6210   16   70 -8447.1685 -351.85875  95.8%  1406  577s
  3129  1841 -5312.6125   22  252 -8447.1685 -425.25560  95.0%  1401  588s
  3246  1940     cutoff   26      -8447.1685 -490.31319  94.2%  1391  598s
  3441  2061 -8217.1625   29  161 -8447.1685 -490.31319  94.2%  1367  612s
  3701  2150 -1703.9672    9  373 -8447.1685 -503.08971  94.0%  1336  625s
  3965  2247 -2993.9510   14  313 -8447.1685 -647.92223  92.3%  1323  640s
  4180  2351 -5497.5115   20  221 -8447.1685 -685.40243  91.9%  1331  655s
  4430  2428 -1578.3743   10  514 -8447.1685 -699.79907  91.7%  1331  673s
  4683  2516 -2683.3986   13  472 -8447.1685 -699.79907  91.7%  1336  690s
  4948  2589 -4071.2250   17  349 -8447.1685 -898.71821  89.4%  1340  705s
  5173  2696 -7997.3776   20  358 -8447.1685 -904.31177  89.3%  1337  720s
  5433  2697 -6135.7923   10  612 -8447.1685 -982.40249  88.4%  1341  850s
  5435  2698 -3227.9438   12  121 -8447.1685 -982.40249  88.4%  1341  884s
  5436  2699 -8051.3526   11  441 -8447.1685 -982.40249  88.4%  1340  900s
  5437  2700 -7833.2923   51  513 -8447.1685 -982.40249  88.4%  1340  912s
  5438  2700 -1623.7255   14  482 -8447.1685 -982.40249  88.4%  1340  918s
  5439  2701 -2834.6197   14  494 -8447.1685 -982.40249  88.4%  1340  923s
  5440  2702 -6951.8589   17  582 -8447.1685 -982.40249  88.4%  1339  928s
  5441  2702 -4089.7433   13  507 -8447.1685 -982.40249  88.4%  1339  932s
  5443  2704 -5814.5839   18  600 -8447.1685 -982.40249  88.4%  1339  935s
  5445  2705 -1646.8370    9  540 -8447.1685 -982.40249  88.4%  1338  941s
  5447  2706 -7139.0526   43  600 -8447.1685 -982.40249  88.4%  1338  947s
  5448  2707 -4965.2367   20  594 -8447.1685 -982.40249  88.4%  1338  952s
  5450  2708 -5054.1809   26  595 -8447.1685 -982.40249  88.4%  1337  956s
  5451  2709 -4154.9674   15  531 -8447.1685 -982.40249  88.4%  1337  962s
  5453  2710 -6728.4469   32  630 -8447.1685 -982.40249  88.4%  1336  967s
  5454  2711 -4842.0103   33  532 -8447.1685 -982.40249  88.4%  1336  971s
  5456  2712 -6371.2252   10  542 -8447.1685 -982.40249  88.4%  1336  979s
  5457  2713 -7743.5944   23  558 -8447.1685 -982.40249  88.4%  1335  982s
  5458  2714 -6738.4556   19  534 -8447.1685 -982.40249  88.4%  1335  989s
  5459  2714 -8261.7179    9  558 -8447.1685 -982.40249  88.4%  1335  992s
  5460  2715 -3722.7834   18  561 -8447.1685 -982.40249  88.4%  1335  996s
  5462  2716 -6890.6867   14  569 -8447.1685 -982.40249  88.4%  1334 1002s
  5464  2718 -6101.6866   11  567 -8447.1685 -982.40249  88.4%  1334 1008s
  5465  2718 -5016.8992   19  567 -8447.1685 -982.40249  88.4%  1333 1042s
  5466  2719 -7242.0532   12  567 -8447.1685 -982.40249  88.4%  1333 1078s
  5467  2723 -982.40249   12  554 -8447.1685 -982.40249  88.4%  1361 1087s
  5469  2726 -982.40249   13  532 -8447.1685 -982.40249  88.4%  1361 1104s
  5473  2733 -982.40249   14  547 -8447.1685 -982.40249  88.4%  1364 1117s
  5481  2746 -982.40249   15  597 -8447.1685 -982.40249  88.4%  1371 1130s
  5497  2754 -6404.8157   16  199 -8447.1685 -982.40249  88.4%  1390 1154s
  5516  2775 -1449.9026   17  299 -8447.1685 -982.40249  88.4%  1423 1166s
  5548  2841 -1609.8924   18  261 -8447.1685 -982.40249  88.4%  1439 1183s
  5677  2816 -2265.8852   21  376 -8447.1685 -982.40249  88.4%  1453 1196s
  5736  2821 -6782.5262   20  191 -8447.1685 -982.40249  88.4%  1466 1210s
  5789  2815 -5912.6627   21  386 -8447.1685 -982.40249  88.4%  1489 1223s
  5836  2832 -2548.3736   19  279 -8447.1685 -982.40249  88.4%  1512 1236s
  5889  2838 -6332.8487   22  358 -8447.1685 -982.40249  88.4%  1525 1250s
  5949  2841     cutoff   23      -8447.1685 -982.40249  88.4%  1540 1262s
  6028  2834 -8044.5603   23  489 -8447.1685 -982.40249  88.4%  1545 1282s
  6068  2850 -8370.3386   24  331 -8447.1685 -982.40249  88.4%  1554 1292s
  6113  2856 infeasible   25      -8447.1685 -982.40249  88.4%  1568 1304s
  6151  2860 -3967.1956   23  342 -8447.1685 -982.40249  88.4%  1582 1317s
  6200  2869 -4012.9151   24  260 -8447.1685 -982.40249  88.4%  1593 1326s
  6242  2876 -4246.5385   25  359 -8447.1685 -982.40249  88.4%  1603 1339s
  6290  2885 -4465.2995   26  408 -8447.1685 -982.40249  88.4%  1610 1351s
  6339  2895 -4993.5426   28  309 -8447.1685 -982.40249  88.4%  1614 1361s
  6401  2888 -5496.3493   30  325 -8447.1685 -982.40249  88.4%  1621 1374s
  6471  2889     cutoff   32      -8447.1685 -982.40249  88.4%  1635 1388s
  6548  2893 -5866.8937   34  348 -8447.1685 -982.40249  88.4%  1643 1403s
  6628  2899 -7212.7067   39  205 -8447.1685 -982.40249  88.4%  1656 1418s
  6732  2886 -2965.7151   21  244 -8447.1685 -982.40249  88.4%  1665 1431s
  6829  2882 -3663.8203   24  230 -8447.1685 -1090.8378  87.1%  1680 1445s
  6910  2907 -4598.1238   26  302 -8447.1685 -1090.8378  87.1%  1693 1461s
  7021  2922 -5083.0298   29  273 -8447.1685 -1143.1541  86.5%  1710 1475s
  7135  2918 -5477.3475   33  186 -8447.1685 -1164.2389  86.2%  1725 1492s
  7274  2900 -7886.7757   39  255 -8447.1685 -1177.2591  86.1%  1743 1509s
  7413  2864 -6576.0463   18  432 -8447.1685 -1333.7448  84.2%  1753 1525s
  7507  2860 -6618.5394   19  420 -8447.1685 -1333.7448  84.2%  1770 1541s
  7625  2880 -6763.6534   20  407 -8447.1685 -1669.4769  80.2%  1783 1555s
  7779  2875 -7324.7259   22  377 -8447.1685 -1669.4769  80.2%  1789 1570s
  7953  2863 -7956.8642   24  388 -8447.1685 -1958.6678  76.8%  1799 1588s
  8120  2815     cutoff   24      -8447.1685 -2337.7896  72.3%  1811 1605s
  8340  2776     cutoff   20      -8447.1685 -2391.4936  71.7%  1817 1627s
  8554  2732 -3715.0620   22  318 -8447.1685 -2391.4936  71.7%  1827 1647s
  8731  2676 -5994.2623   24  343 -8447.1685 -2564.8904  69.6%  1837 1666s
  8929  2628 -8304.5657   27  294 -8447.1685 -2725.4679  67.7%  1847 1680s
  8971  2624     cutoff   28      -8447.1685 -2840.2413  66.4%  1852 1696s
  9037  2587     cutoff   22      -8447.1685 -2906.7059  65.6%  1859 1711s
  9170  2512     cutoff   23      -8447.1685 -2906.7059  65.6%  1861 1732s
  9346  2466 -5270.4271   31  299 -8447.1685 -3341.7018  60.4%  1871 1752s
  9556  2394     cutoff   38      -8447.1685 -3341.7018  60.4%  1883 1775s
  9867  2291 -6697.5234   33  400 -8447.1685 -3445.7153  59.2%  1879 1796s
 10137  2209 -5298.2609   21  362 -8447.1685 -3777.3763  55.3%  1881 1815s
 10478  1984     cutoff   25      -8447.1685 -3949.7848  53.2%  1882 1839s
 10914  1740     cutoff   28      -8447.1685 -4200.7578  50.3%  1874 1859s
 11362  1474 -7108.3066   26  343 -8447.1685 -4429.4977  47.6%  1870 1882s
 11807  1189 -8105.7898   30  511 -8447.1685 -4429.4977  47.6%  1866 1907s
 12275   834     cutoff   22      -8447.1685 -5208.2273  38.3%  1859 1931s
 12791   366 -7806.8543   24  305 -8447.1685 -5818.7464  31.1%  1847 1950s
 13304   109 infeasible   22      -8447.1685 -6588.6263  22.0%  1816 1970s

Cutting planes:
  Gomory: 2
  MIR: 490
  Mixing: 1
  Flow cover: 1853
  Zero half: 3
  RLT: 19
  Relax-and-lift: 125

Explored 13445 nodes (24523115 simplex iterations) in 1970.51 seconds (3543.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8447.17 -8497.81 -8501.69 ... -9333.89
No other solutions better than -8447.17

Optimal solution found (tolerance 1.00e-06)
Best objective -8.447168527211e+03, best bound -8.447168527211e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1970.54s
  Master Objective (UB) = -8447.17, θ = 118247.23
  Upper Bound (UB) = -8447.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118247.23
  [DEBUG]   ✓ Scenario 0: θ = 118247.23 ≤ Q = 118247.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118247.23 ≤ Q = 118247.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118247.23 ≤ Q = 118247.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118247.23 ≤ Q = 118247.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118247.23 ≤ Q = 118247.23 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118247.23 ≤ Q = 118247.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6d01bb68
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6d01bb68
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.467526e+13
Presolve removed 2604 rows and 1898 columns
Presolve time: 0.01s
Presolved: 489 rows, 491 columns, 1378 nonzeros
Found heuristic solution: objective 7480008.5855
Variable types: 331 continuous, 160 integer (160 binary)

Root relaxation: objective -1.301989e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130198.89    0  123 7480008.59 -130198.89   102%     -    0s
H    0     0                    -95122.78847 -130198.89  36.9%     -    0s
H    0     0                    -95386.04103 -130198.89  36.5%     -    0s
H    0     0                    -99032.97110 -130198.89  31.5%     -    0s
H    0     0                    -105766.1882 -130198.89  23.1%     -    0s
     0     0 -114075.37    0  103 -105766.19 -114075.37  7.86%     -    0s
H    0     0                    -111171.7983 -113977.85  2.52%     -    0s
H    0     0                    -111881.8762 -113977.85  1.87%     -    0s
     0     0 -113482.82    0  102 -111881.88 -113482.82  1.43%     -    0s
     0     0 -113424.46    0  102 -111881.88 -113424.46  1.38%     -    0s
     0     0 -112993.98    0   88 -111881.88 -112993.98  0.99%     -    0s
     0     0 -112653.60    0   63 -111881.88 -112653.60  0.69%     -    0s
     0     0 -112467.22    0   43 -111881.88 -112467.22  0.52%     -    0s
     0     0 -112389.86    0   50 -111881.88 -112389.86  0.45%     -    0s
     0     0 -112384.82    0   51 -111881.88 -112384.82  0.45%     -    0s
     0     0 -112113.76    0   21 -111881.88 -112113.76  0.21%     -    0s
     0     0 -112113.67    0   20 -111881.88 -112113.67  0.21%     -    0s
     0     0 -112089.06    0   18 -111881.88 -112089.06  0.19%     -    0s
     0     0 -111937.60    0   11 -111881.88 -111937.60  0.05%     -    0s
     0     0 -111914.31    0    8 -111881.88 -111914.31  0.03%     -    0s
     0     0 -111896.24    0    2 -111881.88 -111896.24  0.01%     -    0s
H    0     0                    -111887.4098 -111894.55  0.01%     -    0s
H    0     0                    -111894.5517 -111894.55  0.00%     -    0s
     0     0 -111894.55    0    2 -111894.55 -111894.55  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 1
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (783 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -111895 -111887 -111882 ... 7.48001e+06
No other solutions better than -111895

Optimal solution found (tolerance 1.00e-06)
Best objective -1.118945516541e+05, best bound -1.118945516541e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 105780.07
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111894.55
  [DEBUG]   S×d_nominal = 217674.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217674.62 + -111894.55 = 105780.07
  [DEBUG]   Current θ from Master = 118247.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12467.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -20914.33
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 681.0075, Absolute Gap = 681.0075, Relative Gap = 0.080620
  Not converged yet (gap = 681.01 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0x81c24c49
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49690 rows and 20190 columns
Presolve time: 2.46s
Presolved: 58723 rows, 25750 columns, 365489 nonzeros
Variable types: 23491 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58723 rows, 25750 columns, 365489 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22134   -1.5267866e+05   0.000000e+00   4.528469e+06      5s
   32132   -3.0903113e+04   0.000000e+00   1.366417e+08     10s
   40065   -5.9074510e+03   0.000000e+00   1.280807e+07     15s
   46544   -1.9959791e+03   0.000000e+00   8.799608e+06     20s
   51795   -8.9152609e+02   0.000000e+00   2.803693e+06     25s
   56620    1.5167442e+03   0.000000e+00   3.057638e+06     30s
   61741    6.2412912e+03   0.000000e+00   7.161638e+05     35s
   66953    7.4683621e+03   0.000000e+00   7.784811e+06     40s
   71604    8.5786565e+03   0.000000e+00   1.074722e+08     45s
Concurrent spin time: 1.47s

Solved with dual simplex

Root relaxation: objective 1.176344e+04, 53445 iterations, 45.42 seconds (60.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11763.4416    0  121 -239633.31 11763.4416   105%     -   48s
H    0     0                    -230937.9157 11763.4416   105%     -   48s
H    0     0                    -93337.03480 11763.4416   113%     -   48s
H    0     0                    -93289.76781 11763.4416   113%     -   48s
H    0     0                    -54103.93929 11763.4416   122%     -   48s
H    0     0                    -10011.46503 11763.4416   217%     -   49s
H    0     0                    -9319.326755 11763.4416   226%     -   49s
H    0     0                    -8716.707335 11763.4416   235%     -   49s
H    0     0                    -8712.601538 8183.53145   194%     -   63s
H    0     0                    -8586.132648 8183.53145   195%     -   63s
     0     0 8178.86001    0  406 -8586.1326 8178.86001   195%     -   64s
     0     0 7999.82145    0  353 -8586.1326 7999.82145   193%     -   66s
     0     0 7858.27243    0  349 -8586.1326 7858.27243   192%     -   67s
     0     0 7842.56515    0  347 -8586.1326 7842.56515   191%     -   68s
     0     0 7837.63462    0  341 -8586.1326 7837.63462   191%     -   70s
     0     0 7837.63462    0  345 -8586.1326 7837.63462   191%     -   71s
     0     0 7837.63462    0  345 -8586.1326 7837.63462   191%     -   71s
     0     0 7837.63462    0  347 -8586.1326 7837.63462   191%     -   71s
     0     0 7837.63462    0  347 -8586.1326 7837.63462   191%     -   71s
     0     0 5678.91470    0  384 -8586.1326 5678.91470   166%     -   81s
H    0     0                    -8574.120880 5678.91470   166%     -   82s
     0     0 5423.81983    0  383 -8574.1209 5423.81983   163%     -   85s
     0     0 5404.39809    0  390 -8574.1209 5404.39809   163%     -   87s
     0     0 5374.15309    0  385 -8574.1209 5374.15309   163%     -   88s
     0     0 5357.85696    0  386 -8574.1209 5357.85696   162%     -   89s
     0     0 5353.90935    0  391 -8574.1209 5353.90935   162%     -   90s
     0     0 5115.70119    0  384 -8574.1209 5115.70119   160%     -   95s
     0     0 5056.01024    0  442 -8574.1209 5056.01024   159%     -   97s
     0     0 5052.64769    0  441 -8574.1209 5052.64769   159%     -   97s
     0     0 5051.75896    0  439 -8574.1209 5051.75896   159%     -   98s
     0     0 5051.75896    0  439 -8574.1209 5051.75896   159%     -   98s
H    0     0                    -8572.936665 3544.31617   141%     -  109s
H    0     0                    -8570.242392 3544.31617   141%     -  109s
     0     0 3544.31617    0  424 -8570.2424 3544.31617   141%     -  109s
     0     0 3020.88878    0  435 -8570.2424 3020.88878   135%     -  116s
     0     0 2863.55439    0  513 -8570.2424 2863.55439   133%     -  120s
     0     0 2754.96294    0  504 -8570.2424 2754.96294   132%     -  122s
     0     0 2702.48465    0  506 -8570.2424 2702.48465   132%     -  124s
     0     0 2659.30163    0  520 -8570.2424 2659.30163   131%     -  126s
     0     0 2627.84850    0  525 -8570.2424 2627.84850   131%     -  127s
     0     0 2620.18882    0  524 -8570.2424 2620.18882   131%     -  127s
     0     0 2611.20799    0  537 -8570.2424 2611.20799   130%     -  128s
     0     0 2603.61673    0  533 -8570.2424 2603.61673   130%     -  129s
     0     0 2589.24849    0  534 -8570.2424 2589.24849   130%     -  130s
     0     0 2587.15792    0  535 -8570.2424 2587.15792   130%     -  130s
     0     0 2586.92858    0  535 -8570.2424 2586.92858   130%     -  130s
H    0     0                    -8513.704885 2586.92858   130%     -  133s
     0     0 2238.13490    0  416 -8513.7049 2238.13490   126%     -  139s
H    0     0                    -8504.387390 2237.89992   126%     -  139s
     0     0 2148.49298    0  429 -8504.3874 2148.49298   125%     -  142s
     0     0 2099.98282    0  498 -8504.3874 2099.98282   125%     -  144s
     0     0 2043.15340    0  506 -8504.3874 2043.15340   124%     -  146s
     0     0 2019.12664    0  506 -8504.3874 2019.12664   124%     -  148s
     0     0 2016.29497    0  502 -8504.3874 2016.29497   124%     -  148s
     0     0 2015.92164    0  512 -8504.3874 2015.92164   124%     -  148s
     0     0 1959.92514    0  575 -8504.3874 1959.92514   123%     -  152s
     0     0 1945.40947    0  525 -8504.3874 1945.40947   123%     -  155s
     0     0 1940.20131    0  526 -8504.3874 1940.20131   123%     -  155s
     0     0 1932.12322    0  518 -8504.3874 1932.12322   123%     -  156s
     0     0 1931.53271    0  524 -8504.3874 1931.53271   123%     -  156s
     0     0 1891.70717    0  525 -8504.3874 1891.70717   122%     -  160s
H    0     0                    -8501.693117 1890.97794   122%     -  164s
     0     0 1887.59415    0  452 -8501.6931 1887.59415   122%     -  165s
     0     0 1828.92024    0  514 -8501.6931 1828.92024   122%     -  167s
     0     0 1796.79557    0  535 -8501.6931 1796.79557   121%     -  170s
     0     0 1787.14938    0  534 -8501.6931 1787.14938   121%     -  171s
     0     0 1786.04357    0  534 -8501.6931 1786.04357   121%     -  171s
     0     0 1743.45454    0  460 -8501.6931 1743.45454   121%     -  174s
     0     0 1731.24675    0  526 -8501.6931 1731.24675   120%     -  176s
     0     0 1727.63049    0  539 -8501.6931 1727.63049   120%     -  176s
     0     0 1723.94311    0  537 -8501.6931 1723.94311   120%     -  177s
     0     0 1722.98563    0  542 -8501.6931 1722.98563   120%     -  177s
     0     0 1714.39433    0  605 -8501.6931 1714.39433   120%     -  179s
H    0     0                    -8497.814630 1713.77738   120%     -  180s
     0     0 1706.57274    0  555 -8497.8146 1706.57274   120%     -  181s
     0     0 1704.15265    0  559 -8497.8146 1704.15265   120%     -  182s
     0     0 1704.12928    0  561 -8497.8146 1704.12928   120%     -  182s
     0     0 1667.17283    0  553 -8497.8146 1667.17283   120%     -  185s
     0     0 1663.70182    0  573 -8497.8146 1663.70182   120%     -  187s
     0     0 1662.93211    0  569 -8497.8146 1662.93211   120%     -  187s
     0     0 1654.26734    0  570 -8497.8146 1654.26734   119%     -  190s
     0     0 1644.05884    0  570 -8497.8146 1644.05884   119%     -  192s
     0     0 1642.45895    0  569 -8497.8146 1642.45895   119%     -  192s
     0     0 1642.16423    0  580 -8497.8146 1642.16423   119%     -  192s
     0     0 1635.61296    0  482 -8497.8146 1635.61296   119%     -  194s
     0     0 1633.16801    0  484 -8497.8146 1633.16801   119%     -  195s
     0     0 1632.81230    0  485 -8497.8146 1632.81230   119%     -  196s
     0     0 1631.53369    0  488 -8497.8146 1631.53369   119%     -  197s
     0     0 1630.84066    0  492 -8497.8146 1630.84066   119%     -  204s
     0     0 1630.15949    0  489 -8497.8146 1630.15949   119%     -  206s
     0     0 1629.02282    0  586 -8497.8146 1629.02282   119%     -  207s
     0     0 1626.17701    0  580 -8497.8146 1626.17701   119%     -  209s
     0     0 1626.17607    0  580 -8497.8146 1626.17607   119%     -  212s
     0     2 1626.17576    0  580 -8497.8146 1626.17576   119%     -  253s
     1     4 1501.95151    1  567 -8497.8146 1625.44260   119%  3601  256s
     3     8 1427.19712    2  562 -8497.8146 1599.44562   119%  2566  265s
     7    16  928.82172    3  596 -8497.8146 1558.06440   118%  5038  272s
    15    32  880.24729    4  584 -8497.8146 1536.20145   118%  4515  287s
    31    48  -91.41173    5  358 -8497.8146 1367.33505   116%  6681  311s
    47    80 1043.88907    6  369 -8497.8146 1367.33505   116%  6244  323s
    79   163  827.75563    7  357 -8497.8146 1367.33505   116%  5440  352s
   164   276  734.67881    9  351 -8497.8146 1367.33505   116%  3382  366s
   285   322 -3499.6517   11  404 -8497.8146 1367.33505   116%  2655  376s
   389   343  732.77481   10  337 -8497.8146 1367.33505   116%  2425  388s
   476   376  697.65957   10  338 -8497.8146 1367.33505   116%  2428  397s
   553   402 -135.27230   13  324 -8497.8146 1367.33505   116%  2577  408s
   619   451 -409.92448   14  299 -8497.8146 1367.33505   116%  2652  419s
   696   486 -695.76995   16  292 -8497.8146 1241.36390   115%  2682  429s
   770   527 -1024.0444   17  354 -8497.8146 1241.36390   115%  2709  440s
   855   561 -1633.2433   18  272 -8497.8146 1241.36390   115%  2694  452s
   931   613 -3009.5412   16  230 -8497.8146 1241.36390   115%  2644  462s
  1017   663 -6502.6229   17  148 -8497.8146 1241.36390   115%  2629  473s
  1092   727 -2000.2818   18  361 -8497.8146 1241.36390   115%  2622  485s
  1205   756 -2295.1757   19  278 -8497.8146 1241.36390   115%  2560  497s
  1287   815 -3056.9387   20  260 -8497.8146 1230.89867   114%  2563  506s
  1375   873 -3541.1295   21  330 -8497.8146 1230.89867   114%  2607  519s
  1477   949 -4657.3010   21  163 -8497.8146 1230.89867   114%  2557  532s
  1613  1044 -4110.8115   23  302 -8497.8146  616.44543   107%  2507  542s
  1752  1088 -4696.0199   26  154 -8497.8146  605.96106   107%  2481  556s
  1870  1135 infeasible   28      -8497.8146  605.96106   107%  2491  568s
  2017  1204 -7017.3420   28  175 -8497.8146  456.46586   105%  2483  581s
  2146  1214 -5767.6083   29  274 -8497.8146  456.46586   105%  2481  594s
  2278  1257     cutoff   29      -8497.8146  380.71653   104%  2469  608s
  2389  1324 infeasible   31      -8497.8146  222.78205   103%  2497  623s
  2519  1397 -4707.7187   15  231 -8497.8146  222.78205   103%  2507  637s
  2666  1476 -5663.5715   17  258 -8497.8146  222.78205   103%  2513  649s
  2850  1490 -6388.5134   20  228 -8497.8146  222.78205   103%  2515  661s
  2902  1511 -6776.3991   21  262 -8497.8146  222.78205   103%  2536  679s
  2979  1533 -6916.3075   22  219 -8497.8146  222.78205   103%  2548  690s
  3035  1557 -7098.4610   23  204 -8497.8146  222.78205   103%  2551  706s
  3126  1588 -7667.7578   24   57 -8497.8146  -79.67119  99.1%  2559  722s
  3222  1612 -7816.3779   25   39 -8497.8146  -79.67119  99.1%  2574  733s
  3316  1658 -7828.6815   26   39 -8497.8146 -107.02190  98.7%  2593  745s
  3424  1706 -7843.0023   27   38 -8497.8146 -107.02190  98.7%  2603  757s
  3548  1781 -7855.9779   28   24 -8497.8146 -107.02190  98.7%  2597  775s
  3752  1840 -1145.7196   10  325 -8497.8146 -125.23880  98.5%  2564  792s
  3925  1871 -2282.3437   13  303 -8497.8146 -125.23880  98.5%  2568  808s
  4109  1941 -3376.7224   17  269 -8497.8146 -345.48724  95.9%  2590  827s
  4305  1950 -3921.8577   20  203 -8497.8146 -367.37958  95.7%  2605  849s
  4382  1984 -4413.2856   21  158 -8497.8146 -456.73890  94.6%  2613  875s
  4446  2018 -5594.1038   22  198 -8497.8146 -463.27200  94.5%  2634  892s
  4524  2055 -6683.4210   23  195 -8497.8146 -463.27200  94.5%  2650  907s
  4597  2055 infeasible   24      -8497.8146 -463.27200  94.5%  2658  926s
  4731  2083 -7450.1377   23   45 -8497.8146 -504.07436  94.1%  2648  948s
  4834  2105     cutoff   24      -8497.8146 -504.07436  94.1%  2658  965s
  4936  2131 -7752.2844   10  339 -8497.8146 -511.73831  94.0%  2673  985s
  5056  2162 -6668.9544   10  399 -8497.8146 -595.97406  93.0%  2670 1003s
  5222  2205 -6728.1118   11  395 -8497.8146 -595.97406  93.0%  2673 1028s
  5370  2232 infeasible   11      -8497.8146 -893.21398  89.5%  2704 1051s
  5553  2295 -7397.8419   13  216 -8497.8146 -906.97225  89.3%  2721 1075s
  5756  2338 -6979.7726   13  461 -8497.8146 -1002.0529  88.2%  2742 1102s
  5982  2385     cutoff   14      -8497.8146 -1037.0632  87.8%  2758 1125s
  6199  2421 -7528.5960   14  212 -8497.8146 -1164.3508  86.3%  2772 1153s
  6555  2463 -6007.0125   10  388 -8497.8146 -1164.3508  86.3%  2778 1179s
  6922  2514     cutoff   13      -8497.8146 -1392.4837  83.6%  2789 1209s
  7391  2559 -7834.7303   16  219 -8497.8146 -1673.5722  80.3%  2770 1236s
  7813  2603 -5016.7774   22  333 -8497.8146 -1720.0439  79.8%  2773 1265s
  8247  2669 -4034.2926   12  482 -8497.8146 -1869.2256  78.0%  2779 1299s
  8641  2717 -7426.9226   16  233 -8497.8146 -1954.9702  77.0%  2800 1330s
  9090  2770     cutoff   15      -8497.8146 -2195.8533  74.2%  2806 1361s
  9647  2831 -5726.5382   14  204 -8497.8146 -2438.1849  71.3%  2794 1395s
 10170  2832 -7833.6703   13  580 -8497.8146 -2532.0809  70.2%  2800 1544s
 10172  2833 -5708.2689   14  121 -8497.8146 -2532.0809  70.2%  2799 1598s
 10173  2834 -3120.8426   14  442 -8497.8146 -2532.0809  70.2%  2799 1619s
 10174  2835 -5009.6192   18  508 -8497.8146 -2532.0809  70.2%  2799 1631s
 10175  2835 -4879.8442   21  512 -8497.8146 -2532.0809  70.2%  2798 1638s
 10176  2836 -5906.6662   10  516 -8497.8146 -2532.0809  70.2%  2798 1643s
 10177  2837 -5834.2889   18  515 -8497.8146 -2532.0809  70.2%  2798 1647s
 10178  2837 -4724.4138   38  524 -8497.8146 -2532.0809  70.2%  2798 1651s
 10180  2839 -4326.9790   12  550 -8497.8146 -2532.0809  70.2%  2797 1657s
 10181  2839 -4343.3366   12  562 -8497.8146 -2532.0809  70.2%  2797 1660s
 10182  2840 -5188.5845   14  594 -8497.8146 -2532.0809  70.2%  2796 1668s
 10183  2841 -6333.1250   10  545 -8497.8146 -2532.0809  70.2%  2796 1671s
 10185  2842 -7539.7862   24  563 -8497.8146 -2532.0809  70.2%  2796 1681s
 10187  2843 -7198.3709   16  478 -8497.8146 -2532.0809  70.2%  2795 1689s
 10188  2844 -6498.2535   12  550 -8497.8146 -2532.0809  70.2%  2795 1692s
 10189  2845 -3914.5286   19  474 -8497.8146 -2532.0809  70.2%  2795 1696s
 10191  2846 -6484.8013   18  464 -8497.8146 -2532.0809  70.2%  2794 1706s
 10193  2847 -4139.1146   14  491 -8497.8146 -2532.0809  70.2%  2793 1714s
 10194  2848 -4879.8442   21  493 -8497.8146 -2532.0809  70.2%  2793 1717s
 10195  2849 -8137.7897   37  499 -8497.8146 -2532.0809  70.2%  2793 1721s
 10196  2849 -5140.3509   19  499 -8497.8146 -2532.0809  70.2%  2793 1774s
 10197  2850 -3079.4297   20  499 -8497.8146 -2532.0809  70.2%  2792 1793s
 10198  2854 -2532.0809   12  541 -8497.8146 -2532.0809  70.2%  2808 1807s
 10200  2857 -2532.0809   13  542 -8497.8146 -2532.0809  70.2%  2808 1819s
 10204  2864 -2532.0809   14  554 -8497.8146 -2532.0809  70.2%  2809 1837s
 10212  2877 -2532.0809   15  608 -8497.8146 -2532.0809  70.2%  2813 1852s
 10228  2888 -7859.3277   16  171 -8497.8146 -2532.0809  70.2%  2827 1883s
 10245  2906 -2532.0809   17  316 -8497.8146 -2532.0809  70.2%  2836 1899s
 10277  2985 -2732.8971   18  300 -8497.8146 -2532.0809  70.2%  2850 1925s
 10385  3009 -3436.1005   21  313 -8497.8146 -2532.0809  70.2%  2856 1937s
 10480  3011 -3890.7217   22  253 -8497.8146 -2532.0809  70.2%  2861 1953s
 10559  3000     cutoff   24      -8497.8146 -2532.0809  70.2%  2862 1967s
 10626  2996 -5638.6444   25  165 -8497.8146 -2532.0809  70.2%  2862 1981s
 10663  2999     cutoff   25      -8497.8146 -2532.0809  70.2%  2870 1995s
 10719  2997     cutoff   26      -8497.8146 -2532.0809  70.2%  2875 2001s
 10757  2990 -6901.1195   28  204 -8497.8146 -2532.0809  70.2%  2879 2016s
 10822  2969 -7435.9811   29  206 -8497.8146 -2532.0809  70.2%  2877 2030s
 10871  2963 -7852.8465   30  229 -8497.8146 -2532.0809  70.2%  2878 2041s
 10930  2970     cutoff   31      -8497.8146 -2532.0809  70.2%  2877 2055s
 10992  2967     cutoff   32      -8497.8146 -2532.0809  70.2%  2880 2069s
 11056  2968     cutoff   32      -8497.8146 -2532.0809  70.2%  2886 2085s
 11117  2970 -2532.0809   17  396 -8497.8146 -2532.0809  70.2%  2892 2099s
 11175  2990 -2592.4068   18  344 -8497.8146 -2532.0809  70.2%  2900 2112s
 11259  2978 -2639.4200   19  337 -8497.8146 -2532.0809  70.2%  2900 2127s
 11340  2976 -3283.7977   21  335 -8497.8146 -2532.0809  70.2%  2907 2143s
 11419  2968     cutoff   22      -8497.8146 -2532.0809  70.2%  2909 2160s
 11504  2959 -4051.7463   21  285 -8497.8146 -2532.0809  70.2%  2911 2175s
 11598  2955 -8179.0117   22  274 -8497.8146 -2532.0809  70.2%  2919 2194s
 11683  2971 infeasible   25      -8497.8146 -2532.0809  70.2%  2929 2208s
 11778  2956     cutoff   19      -8497.8146 -2532.0809  70.2%  2935 2226s
 11900  2932 -6618.2293   21  337 -8497.8146 -2532.0809  70.2%  2935 2244s
 12022  2914 -6681.9975   20  234 -8497.8146 -2532.0809  70.2%  2944 2264s
 12118  2904 -6622.9172   22  345 -8497.8146 -2532.0809  70.2%  2951 2284s
 12230  2887 -7354.4729   24  393 -8497.8146 -2532.0809  70.2%  2957 2304s
 12368  2876     cutoff   25      -8497.8146 -2532.0809  70.2%  2964 2324s
 12519  2831     cutoff   28      -8497.8146 -2532.0809  70.2%  2966 2341s
 12634  2823     cutoff   23      -8497.8146 -2532.0809  70.2%  2966 2361s
 12774  2794 -5199.9247   24  314 -8497.8146 -2532.0809  70.2%  2975 2377s
 12818  2789 -6766.2391   25  450 -8497.8146 -2532.0809  70.2%  2980 2393s
H12848  2636                    -8487.706671 -2532.0809  70.2%  2980 2393s
 12878  2648 -8401.3874   26  119 -8487.7067 -2532.0809  70.2%  2985 2412s
 13094  2612     cutoff   28      -8487.7067 -2532.0809  70.2%  2981 2433s
 13271  2584 -8408.9061   22  363 -8487.7067 -2959.9924  65.1%  2985 2458s
 13452  2532 -6680.2283   23  308 -8487.7067 -3031.8842  64.3%  2998 2479s
H13476  2388                    -8474.281788 -3031.8842  64.2%  2998 2479s
 13639  2385     cutoff   27      -8474.2818 -3034.9729  64.2%  3004 2499s
 13863  2318     cutoff   25      -8474.2818 -3228.6530  61.9%  3004 2526s
 14127  2235 -8354.0306   26  340 -8474.2818 -3293.4887  61.1%  3001 2550s
 14376  2158     cutoff   29      -8474.2818 -3634.7681  57.1%  3002 2576s
 14430  2138     cutoff   30      -8474.2818 -3634.7681  57.1%  3000 2595s
 14491  2130 -6430.3254   31  287 -8474.2818 -3634.7681  57.1%  3000 2618s
 14549  2094 -5517.4468   23  200 -8474.2818 -3634.7681  57.1%  3003 2641s
 14668  2046 -7332.1007   25  188 -8474.2818 -3917.4691  53.8%  3003 2671s
 14912  1959 -7089.3875   27  250 -8474.2818 -3965.2725  53.2%  2994 2699s
 15215  1810     cutoff   31      -8474.2818 -3965.2725  53.2%  2985 2727s
 15557  1663     cutoff   30      -8474.2818 -4249.9439  49.8%  2984 2756s
 15966  1433 -7271.8698   24  324 -8474.2818 -4551.5683  46.3%  2972 2789s
 16396  1141     cutoff   30      -8474.2818 -5027.1791  40.7%  2959 2824s
 16926   720 -7520.2249   25  264 -8474.2818 -5393.3519  36.4%  2934 2858s
 17504   293 -8383.1672   20  514 -8474.2818 -6169.0045  27.2%  2901 2893s
 18006     0 infeasible   32      -8474.2818 -6506.0395  23.2%  2870 2911s

Cutting planes:
  Learned: 1
  MIR: 511
  Mixing: 1
  Flow cover: 2267
  Zero half: 3
  RLT: 23
  Relax-and-lift: 122

Explored 18270 nodes (52243639 simplex iterations) in 2911.65 seconds (5452.49 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8474.28 -8487.71 -8497.81 ... -8586.13
No other solutions better than -8474.28

Optimal solution found (tolerance 1.00e-06)
Best objective -8.474281788349e+03, best bound -8.474281788349e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2911.68s
  Master Objective (UB) = -8474.28, θ = 118803.71
  Upper Bound (UB) = -8474.28

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118803.71
  [DEBUG]   ✓ Scenario 0: θ = 118803.71 ≤ Q = 118803.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118803.71 ≤ Q = 118803.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118803.71 ≤ Q = 118803.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118803.71 ≤ Q = 118803.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118803.71 ≤ Q = 118803.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118803.71 ≤ Q = 118803.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118803.71 ≤ Q = 118803.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x336af07c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x336af07c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.369583e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6798722.4216
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.297589e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129758.93    0  122 6798722.42 -129758.93   102%     -    0s
H    0     0                    -94901.52020 -129758.93  36.7%     -    0s
H    0     0                    -95164.77276 -129758.93  36.4%     -    0s
     0     0 -106783.06    0   94 -95164.773 -106783.06  12.2%     -    0s
H    0     0                    -104177.4661 -106770.51  2.49%     -    0s
H    0     0                    -104633.7137 -106770.51  2.04%     -    0s
     0     0 -106253.18    0   92 -104633.71 -106253.18  1.55%     -    0s
     0     0 -106216.33    0   93 -104633.71 -106216.33  1.51%     -    0s
     0     0 -105969.54    0   69 -104633.71 -105969.54  1.28%     -    0s
H    0     0                    -104648.5691 -105952.73  1.25%     -    0s
     0     0 -105871.49    0   70 -104648.57 -105871.49  1.17%     -    0s
     0     0 -105863.33    0   71 -104648.57 -105863.33  1.16%     -    0s
     0     0 -105776.43    0   69 -104648.57 -105776.43  1.08%     -    0s
     0     0 -105756.31    0   69 -104648.57 -105756.31  1.06%     -    0s
     0     0 -105695.91    0   61 -104648.57 -105695.91  1.00%     -    0s
     0     0 -105680.36    0   62 -104648.57 -105680.36  0.99%     -    0s
     0     0 -105587.61    0   59 -104648.57 -105587.61  0.90%     -    0s
     0     0 -105583.32    0   59 -104648.57 -105583.32  0.89%     -    0s
     0     2 -105583.32    0   59 -104648.57 -105583.32  0.89%     -    0s
H   16    11                    -105148.3403 -105420.73  0.26%   7.5    0s
H   17    11                    -105158.9533 -105420.73  0.25%   7.1    0s
*   28     9               5    -105411.3008 -105419.38  0.01%   5.6    0s

Cutting planes:
  Gomory: 6
  MIR: 112
  Flow cover: 9
  RLT: 55

Explored 41 nodes (818 simplex iterations) in 0.19 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -105411 -105159 -105148 ... 1.36958e+13
No other solutions better than -105411

Optimal solution found (tolerance 1.00e-06)
Best objective -1.054113007852e+05, best bound -1.054113007852e+05, gap 0.0000%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 112468.01
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105411.30
  [DEBUG]   S×d_nominal = 217879.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217879.31 + -105411.30 = 112468.01
  [DEBUG]   Current θ from Master = 118803.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6335.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14809.98
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 653.8943, Absolute Gap = 653.8943, Relative Gap = 0.077162
  Not converged yet (gap = 653.89 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0xded483e2
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56800 rows and 23080 columns
Presolve time: 2.32s
Presolved: 66903 rows, 29100 columns, 416879 nonzeros
Variable types: 26841 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66903 rows, 29100 columns, 416879 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22111   -1.6023258e+05   0.000000e+00   6.429277e+06      5s
   35556   -9.4666179e+03   0.000000e+00   2.613444e+06     10s
   41005   -5.6841682e+03   0.000000e+00   1.593581e+06     15s
   47054    3.1411116e+03   0.000000e+00   3.045952e+06     20s
   52187    4.5738802e+03   0.000000e+00   9.241939e+05     25s
   57274    5.9855902e+03   0.000000e+00   4.259870e+06     30s
   61744    7.4957814e+03   0.000000e+00   3.993538e+06     35s
   66751    9.3758326e+03   0.000000e+00   2.322513e+06     40s
   70625    9.4210694e+03   0.000000e+00   1.435335e+06     45s
   74744    9.8068495e+03   0.000000e+00   7.400994e+05     50s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.175751e+04, 52964 iterations, 51.55 seconds (63.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11757.5112    0  129 -239633.31 11757.5112   105%     -   55s
H    0     0                    -226175.8618 11757.5112   105%     -   55s
H    0     0                    -97425.31831 11757.5112   112%     -   55s
H    0     0                    -97329.76065 11757.5112   112%     -   55s
H    0     0                    -54015.89683 11757.5112   122%     -   55s
H    0     0                    -10137.83043 11757.5112   216%     -   55s
H    0     0                    -9711.541716 11757.5112   221%     -   55s
H    0     0                    -8831.734013 11757.5112   233%     -   56s
H    0     0                    -8716.707335 11757.5112   235%     -   56s
H    0     0                    -8589.767844 8214.86044   196%     -   71s
H    0     0                    -8586.132648 8214.86044   196%     -   71s
     0     0 8214.86044    0  348 -8586.1326 8214.86044   196%     -   71s
     0     0 7988.18963    0  339 -8586.1326 7988.18963   193%     -   75s
     0     0 7988.18963    0  333 -8586.1326 7988.18963   193%     -   77s
     0     0 7988.18963    0  331 -8586.1326 7988.18963   193%     -   78s
     0     0 7988.18963    0  331 -8586.1326 7988.18963   193%     -   78s
     0     0 7988.18963    0  331 -8586.1326 7988.18963   193%     -   78s
     0     0 5472.18543    0  374 -8586.1326 5472.18543   164%     -   89s
H    0     0                    -8583.438375 5470.45348   164%     -   89s
     0     0 5363.63125    0  373 -8583.4384 5363.63125   162%     -   91s
     0     0 5223.53758    0  362 -8583.4384 5223.53758   161%     -   94s
     0     0 5210.91754    0  360 -8583.4384 5210.91754   161%     -   95s
     0     0 5188.85186    0  370 -8583.4384 5188.85186   160%     -   97s
     0     0 5053.81389    0  423 -8583.4384 5053.81389   159%     -  101s
     0     0 5050.25451    0  424 -8583.4384 5050.25451   159%     -  102s
     0     0 5050.06586    0  427 -8583.4384 5050.06586   159%     -  103s
     0     0 3961.63995    0  532 -8583.4384 3961.63995   146%     -  118s
H    0     0                    -8511.010613 3960.92588   147%     -  118s
     0     0 3482.22674    0  529 -8511.0106 3482.22674   141%     -  125s
     0     0 3191.23248    0  540 -8511.0106 3191.23248   137%     -  129s
     0     0 3115.01464    0  483 -8511.0106 3115.01464   137%     -  132s
     0     0 3053.32399    0  544 -8511.0106 3053.32399   136%     -  135s
     0     0 3022.71771    0  546 -8511.0106 3022.71771   136%     -  137s
     0     0 3006.48443    0  544 -8511.0106 3006.48443   135%     -  139s
     0     0 2965.72359    0  541 -8511.0106 2965.72359   135%     -  140s
     0     0 2961.64891    0  545 -8511.0106 2961.64891   135%     -  141s
     0     0 2959.68738    0  542 -8511.0106 2959.68738   135%     -  142s
     0     0 2959.28246    0  547 -8511.0106 2959.28246   135%     -  142s
     0     0 2578.03212    0  577 -8511.0106 2578.03212   130%     -  153s
H    0     0                    -8501.693117 2576.49058   130%     -  154s
     0     0 2472.54470    0  570 -8501.6931 2472.54470   129%     -  157s
     0     0 2429.96394    0  552 -8501.6931 2429.96394   129%     -  160s
     0     0 2399.97835    0  485 -8501.6931 2399.97835   128%     -  163s
     0     0 2383.01833    0  550 -8501.6931 2383.01833   128%     -  166s
     0     0 2364.73944    0  561 -8501.6931 2364.73944   128%     -  167s
     0     0 2359.77982    0  427 -8501.6931 2359.77982   128%     -  168s
     0     0 2358.41846    0  568 -8501.6931 2358.41846   128%     -  168s
     0     0 2357.50726    0  489 -8501.6931 2357.50726   128%     -  169s
     0     0 2279.94281    0  481 -8501.6931 2279.94281   127%     -  174s
     0     0 2267.30784    0  421 -8501.6931 2267.30784   127%     -  175s
     0     0 2259.84975    0  432 -8501.6931 2259.84975   127%     -  176s
     0     0 2256.10165    0  435 -8501.6931 2256.10165   127%     -  177s
     0     0 2250.60693    0  441 -8501.6931 2250.60693   126%     -  178s
     0     0 2214.05024    0  567 -8501.6931 2214.05024   126%     -  180s
     0     0 2200.80130    0  579 -8501.6931 2200.80130   126%     -  182s
     0     0 2194.92396    0  581 -8501.6931 2194.92396   126%     -  183s
     0     0 2194.03514    0  585 -8501.6931 2194.03514   126%     -  183s
     0     0 2119.27399    0  437 -8501.6931 2119.27399   125%     -  188s
     0     0 2097.16652    0  445 -8501.6931 2097.16652   125%     -  194s
     0     0 2094.67417    0  440 -8501.6931 2094.67417   125%     -  195s
     0     0 2093.10513    0  440 -8501.6931 2093.10513   125%     -  195s
     0     0 2092.04388    0  441 -8501.6931 2092.04388   125%     -  195s
     0     0 2034.00694    0  453 -8501.6931 2034.00694   124%     -  199s
     0     0 2022.75623    0  453 -8501.6931 2022.75623   124%     -  201s
     0     0 2022.01160    0  461 -8501.6931 2022.01160   124%     -  201s
     0     0 2004.93915    0  456 -8501.6931 2004.93915   124%     -  204s
H    0     0                    -8497.814630 2003.18703   124%     -  205s
     0     0 2001.28892    0  455 -8497.8146 2001.28892   124%     -  206s
     0     0 1999.81498    0  455 -8497.8146 1999.81498   124%     -  206s
     0     0 1999.62549    0  455 -8497.8146 1999.62549   124%     -  207s
     0     0 1994.20796    0  453 -8497.8146 1994.20796   123%     -  208s
     0     0 1992.79598    0  448 -8497.8146 1992.79598   123%     -  210s
     0     0 1990.43567    0  452 -8497.8146 1990.43567   123%     -  210s
     0     0 1990.17471    0  452 -8497.8146 1990.17471   123%     -  210s
     0     0 1940.55256    0  446 -8497.8146 1940.55256   123%     -  214s
     0     0 1935.36567    0  446 -8497.8146 1935.36567   123%     -  217s
     0     0 1933.37595    0  457 -8497.8146 1933.37595   123%     -  218s
     0     0 1933.08386    0  456 -8497.8146 1933.08386   123%     -  219s
     0     0 1930.56210    0  457 -8497.8146 1930.56210   123%     -  220s
     0     0 1929.62391    0  468 -8497.8146 1929.62391   123%     -  222s
     0     0 1920.18496    0  472 -8497.8146 1920.18496   123%     -  226s
     0     0 1918.83428    0  606 -8497.8146 1918.83428   123%     -  228s
     0     0 1918.58224    0  600 -8497.8146 1918.58224   123%     -  229s
     0     0 1874.31550    0  515 -8497.8146 1874.31550   122%     -  232s
     0     0 1870.10953    0  517 -8497.8146 1870.10953   122%     -  234s
     0     0 1868.94386    0  519 -8497.8146 1868.94386   122%     -  234s
     0     0 1865.75988    0  529 -8497.8146 1865.75988   122%     -  236s
     0     0 1861.92518    0  535 -8497.8146 1861.92518   122%     -  284s
     0     0 1859.57585    0  531 -8497.8146 1859.57585   122%     -  285s
     0     0 1857.30781    0  462 -8497.8146 1857.30781   122%     -  286s
     0     0 1851.06652    0  467 -8497.8146 1851.06652   122%     -  287s
     0     0 1850.67716    0  471 -8497.8146 1850.67716   122%     -  287s
     0     0 1846.62981    0  546 -8497.8146 1846.62981   122%     -  289s
     0     0 1845.38964    0  470 -8497.8146 1845.38964   122%     -  290s
     0     0 1845.08600    0  465 -8497.8146 1845.08600   122%     -  290s
     0     0 1841.19543    0  468 -8497.8146 1841.19543   122%     -  292s
     0     0 1841.09696    0  469 -8497.8146 1841.09696   122%     -  292s
     0     0 1840.61776    0  468 -8497.8146 1840.61776   122%     -  294s
     0     0 1840.15354    0  471 -8497.8146 1840.15354   122%     -  295s
     0     0 1838.44865    0  467 -8497.8146 1838.44865   122%     -  296s
     0     0 1837.75538    0  469 -8497.8146 1837.75538   122%     -  297s
     0     0 1835.19594    0  459 -8497.8146 1835.19594   122%     -  298s
     0     0 1834.84159    0  459 -8497.8146 1834.84159   122%     -  301s
     0     2 1834.66324    0  459 -8497.8146 1834.66324   122%     -  360s
     3     8 1445.58853    2  523 -8497.8146 1756.88276   121%  4725  371s
     7    16 1346.73746    3  516 -8497.8146 1676.49382   120%  5196  382s
    15    32 1041.55124    4  526 -8497.8146 1595.61060   119%  5975  392s
    31    49 -4358.2183    5  216 -8497.8146 1575.41495   119%  6656  414s
    48    81 -5193.2804    6  206 -8497.8146 1573.68315   119%  7416  435s
    80   216 -5269.4199    7  171 -8497.8146 1573.68315   119%  6056  453s
   217   319 -5784.0136   10  145 -8497.8146 1573.68315   119%  3656  467s
   330   376 -5600.1547   10  163 -8497.8146 1573.68315   119%  2890  473s
   407   447 -5661.2457   10  168 -8497.8146 1573.68315   119%  2639  481s
   508   497 -5874.3657   11  169 -8497.8146 1573.68315   119%  2451  492s
   612   513 -5684.4797   11  174 -8497.8146 1573.68315   119%  2195  504s
   701   540 -6587.2274   12  111 -8497.8146 1573.68315   119%  2149  515s
   772   578 -6589.3878   13  107 -8497.8146 1573.68315   119%  2146  523s
   849   611 -7025.3753   16   66 -8497.8146 1502.54216   118%  2173  533s
   929   645 -7088.5682   17   70 -8497.8146 1502.24799   118%  2167  542s
  1007   666 -7520.3085   21   43 -8497.8146 1436.84194   117%  2201  553s
  1047   701 -7530.3567   22   30 -8497.8146 1436.84191   117%  2303  564s
  1092   729 -7623.2035   23   33 -8497.8146 1436.84191   117%  2370  574s
  1156   761 -7625.2267   24   23 -8497.8146 1408.92145   117%  2403  586s
  1227   779 -7657.7625   23   38 -8497.8146 1408.92145   117%  2459  598s
  1293   812 -7651.2638   25   25 -8497.8146 1408.92145   117%  2502  610s
  1362   832 -7750.8583   24   37 -8497.8146 1408.92145   117%  2540  622s
  1433   859     cutoff   26      -8497.8146 1408.92145   117%  2575  635s
  1520   912 -4756.9655   12  168 -8497.8146 1408.92145   117%  2607  646s
  1596   943 -7111.3429   13  149 -8497.8146 1408.92145   117%  2644  659s
  1691   964 -8470.8278   14   90 -8497.8146 1408.92145   117%  2654  673s
  1800   999 -7680.1947   14  159 -8497.8146 1057.41348   112%  2647  686s
  1895  1038 -7227.0770   18  155 -8497.8146 1044.88716   112%  2687  701s
  2009  1072 -7271.2954   19  151 -8497.8146 1044.88716   112%  2713  714s
  2055  1103     cutoff   19      -8497.8146 1044.88716   112%  2757  725s
  2114  1131 -7660.1765   21  144 -8497.8146 1039.46938   112%  2790  738s
  2198  1186 infeasible   22      -8497.8146 1039.46938   112%  2842  751s
  2273  1230     cutoff   24      -8497.8146 1039.46938   112%  2898  764s
  2387  1277 -1872.0915   11  207 -8497.8146 1039.46938   112%  2918  778s
  2526  1299 -2983.7624   12  191 -8497.8146 1039.46938   112%  2922  794s
  2655  1364     cutoff   15      -8497.8146  819.55952   110%  2949  809s
  2757  1407 -4433.7481   12  251 -8497.8146  819.55952   110%  3009  824s
  2910  1437     cutoff   15      -8497.8146  819.55952   110%  3023  839s
  3065  1499 -3819.2287   12  426 -8497.8146  819.55952   110%  3047  856s
  3207  1525     cutoff   13      -8497.8146  819.55952   110%  3081  875s
  3341  1586 -4270.2038   13  548 -8497.8146  819.55952   110%  3076  894s
  3475  1644 -5056.9364   14  539 -8497.8146  819.55952   110%  3105  912s
  3631  1682 -6341.2694   16  414 -8497.8146  819.55952   110%  3120  933s
  3823  1712     cutoff   17      -8497.8146  819.55952   110%  3118  954s
  3995  1724     cutoff   18      -8497.8146  482.98892   106%  3128  990s
  4046  1746 -7185.8310   19  411 -8497.8146  482.98892   106%  3152 1032s
  4102  1764     cutoff   19      -8497.8146  482.98892   106%  3165 1047s
  4148  1775 -7310.0233   21  361 -8497.8146  482.98892   106%  3167 1063s
  4213  1779 -7411.0890   22  225 -8497.8146  482.98892   106%  3169 1077s
  4273  1802     cutoff   22      -8497.8146  482.98892   106%  3171 1097s
  4314  1801 -7784.2258   23  215 -8497.8146  482.98892   106%  3193 1114s
  4380  1809 -7977.6066   24  280 -8497.8146  482.98892   106%  3199 1136s
  4438  1822 -7962.5746   24  215 -8497.8146  482.98892   106%  3199 1152s
  4489  1835 infeasible   25      -8497.8146  394.10762   105%  3205 1169s
  4540  1849     cutoff   26      -8497.8146  394.10762   105%  3202 1188s
  4590  1863     cutoff   25      -8497.8146  173.95839   102%  3213 1208s
  4639  1883 -1461.2632   10  366 -8497.8146  173.95839   102%  3211 1229s
  4695  1896 -1524.1672   11  365 -8497.8146  173.95839   102%  3217 1252s
  4746  1916     cutoff   12      -8497.8146  119.84371   101%  3223 1274s
  4808  1948 -2520.4362   13  247 -8497.8146  119.64455   101%  3224 1296s
  4843  1974 -2806.1295   14  276 -8497.8146  119.64455   101%  3236 1320s
  4960  2012 -3452.0892   15  357 -8497.8146  119.64455   101%  3221 1348s
  5076  2098 -3664.0540   16  269 -8497.8146  119.64455   101%  3223 1393s
  5230  2099 -5884.3463   12  459 -8497.8146  119.64455   101%  3237 1471s
  5232  2100 -7658.5147   24  129 -8497.8146  119.64455   101%  3235 1527s
  5233  2101 -3170.7382   18  425 -8497.8146  119.64455   101%  3235 1553s
  5234  2102 -6229.1875   17  428 -8497.8146  119.64455   101%  3234 1572s
  5235  2102 -2293.2303   17  483 -8497.8146  119.64455   101%  3234 1582s
  5236  2103 -6111.7388   15  494 -8497.8146  119.64455   101%  3233 1590s
  5237  2104 -5984.8643   28  562 -8497.8146  119.64455   101%  3232 1600s
  5239  2105 -6461.3169   17  574 -8497.8146  119.64455   101%  3231 1610s
  5240  2106 -5189.5677   14  529 -8497.8146  119.64455   101%  3230 1615s
  5242  2107 -6864.4834   25  528 -8497.8146  119.64455   101%  3229 1621s
  5244  2108 -7828.7917   29  604 -8497.8146  119.64455   101%  3228 1626s
  5245  2109 -3857.4254   15  567 -8497.8146  119.64455   101%  3227 1636s
  5246  2110 -7447.9604    9  511 -8497.8146  119.64455   101%  3227 1640s
  5247  2110 -7226.0540   18  517 -8497.8146  119.64455   101%  3226 1645s
  5250  2112 -5225.3528   22  429 -8497.8146  119.64455   101%  3224 1653s
  5251  2113 -5751.6235   12  590 -8497.8146  119.64455   101%  3224 1655s
  5252  2114 -2478.1309   23  579 -8497.8146  119.64455   101%  3223 1660s
  5253  2114 -6832.7526   20  562 -8497.8146  119.64455   101%  3222 1672s
  5254  2115 -6532.3979   14  580 -8497.8146  119.64455   101%  3222 1675s
  5257  2117 -5160.4713    9  602 -8497.8146  119.64455   101%  3220 1682s
  5258  2118 -4091.5145    8  446 -8497.8146  119.64455   101%  3219 1688s
  5259  2118 -4986.5074   17  445 -8497.8146  119.64455   101%  3219 1690s
  5261  2120 -582.35115   14  525 -8497.8146  119.64455   101%  3218 1700s
  5263  2121 -6002.8007   20  539 -8497.8146  119.64455   101%  3216 1713s
  5264  2122 -4501.8198    8  464 -8497.8146  119.64455   101%  3216 1716s
  5265  2122 -1308.2706   11  552 -8497.8146  119.64455   101%  3215 1724s
  5266  2123 -5272.3708   18  458 -8497.8146  119.64455   101%  3215 1727s
  5267  2124 -7813.9056   20  551 -8497.8146  119.64455   101%  3214 1733s
  5268  2124 -3814.4911   21  538 -8497.8146  119.64455   101%  3213 1737s
  5269  2125 -5967.2228   11  539 -8497.8146  119.64455   101%  3213 1743s
  5270  2126 -6264.6754   23  547 -8497.8146  119.64455   101%  3212 1747s
  5271  2126 -6915.6070   17  523 -8497.8146  119.64455   101%  3211 1754s
  5272  2127 -3696.4221   21  523 -8497.8146  119.64455   101%  3211 1808s
  5273  2128 -7370.6427   13  523 -8497.8146  119.64455   101%  3210 1837s
  5274  2131  119.64455   13  526 -8497.8146  119.64455   101%  3250 1893s
  5276  2135  119.64455   14  529 -8497.8146  119.64455   101%  3251 1915s
  5280  2141  119.64455   15  441 -8497.8146  119.64455   101%  3254 1930s
  5288  2155  119.64455   16  516 -8497.8146  119.64455   101%  3261 1951s
  5304  2165 -871.17536   17  438 -8497.8146  119.64455   101%  3284 2151s
  5320  2187 -1998.4291   18  263 -8497.8146  119.64455   101%  3306 2165s
  5352  2235 -4872.1657   19  411 -8497.8146  119.64455   101%  3315 2192s
  5415  2254 -4882.3461   20  475 -8497.8146  119.64455   101%  3364 2216s
  5500  2238 -5416.7895   22  393 -8497.8146  119.64455   101%  3369 2241s
  5555  2228 -6876.2361   23  426 -8497.8146  119.64455   101%  3364 2265s
  5616  2214     cutoff   21      -8497.8146  119.64455   101%  3368 2284s
  5698  2188     cutoff   24      -8497.8146  119.64455   101%  3359 2305s
  5771  2176 -7694.0237   25  342 -8497.8146  119.64455   101%  3349 2322s
  5844  2159     cutoff   26      -8497.8146  119.64455   101%  3339 2339s
  5912  2156 -3242.1734   21  221 -8497.8146  119.64455   101%  3330 2355s
  5979  2152 -4546.5649   23  412 -8497.8146  119.64455   101%  3316 2372s
  6046  2136 -4754.9627   25  351 -8497.8146  119.64455   101%  3308 2389s
  6117  2124 infeasible   27      -8497.8146  119.64455   101%  3296 2409s
  6181  2134 -5159.9418   19  437 -8497.8146  119.64455   101%  3295 2433s
  6262  2125 -6778.6646   21  392 -8497.8146  119.64455   101%  3280 2454s
  6334  2111 -7304.4218   24  440 -8497.8146  119.64455   101%  3270 2470s
  6392  2114 -7321.3967   25  441 -8497.8146  119.64455   101%  3260 2488s
  6457  2121 -7726.9116   28  355 -8497.8146  119.64455   101%  3253 2508s
  6563  2108     cutoff   33      -8497.8146 -460.10915  94.6%  3227 2531s
  6674  2104 -7132.5272   21  564 -8497.8146 -460.10915  94.6%  3205 2554s
  6781  2102 -7490.9662   23  290 -8497.8146 -460.10915  94.6%  3185 2576s
  6903  2075     cutoff   26      -8497.8146 -460.10915  94.6%  3161 2598s
  6951  2087 -6976.2815   18  349 -8497.8146 -694.37162  91.8%  3166 2613s
  6986  2095 -7784.9089   19  261 -8497.8146 -694.37162  91.8%  3164 2633s
  7030  2100 -8459.3762   20  213 -8497.8146 -694.37162  91.8%  3162 2656s
  7071  2093     cutoff   21      -8497.8146 -1381.5008  83.7%  3159 2672s
  7123  2107 -6320.4904   21  460 -8497.8146 -1606.7311  81.1%  3155 2693s
  7190  2113 -6548.4969   22  383 -8497.8146 -1768.4115  79.2%  3144 2722s
  7302  2114     cutoff   23      -8497.8146 -2108.9651  75.2%  3124 2749s
  7404  2095 -6953.8324   24  438 -8497.8146 -2177.5741  74.4%  3118 2774s
  7524  2089 -7009.5645   25  370 -8497.8146 -2352.8235  72.3%  3098 2798s
  7677  2026 -7252.7926   26  325 -8497.8146 -2540.8821  70.1%  3074 2828s
  7870  1997 -7895.7126   29  248 -8497.8146 -2958.1787  65.2%  3054 2855s
  8009  1946 infeasible   21      -8497.8146 -3426.0298  59.7%  3043 2880s
  8125  1935 -7343.3289   23  412 -8497.8146 -3541.3073  58.3%  3035 2913s
  8296  1846 -7955.4784   26  385 -8497.8146 -3584.3703  57.8%  3017 2947s
  8566  1763 -6267.9946   19  509 -8497.8146 -3706.2426  56.4%  2971 2983s
  8713  1675 -6882.0065   20  431 -8497.8146 -3706.2426  56.4%  2963 3013s
  8995  1546 -7040.5307   21  423 -8497.8146 -4411.2057  48.1%  2923 3049s
  9289  1400 -6693.7797   31  346 -8497.8146 -4880.8468  42.6%  2890 3084s
  9621  1211     cutoff   36      -8497.8146 -5162.1604  39.3%  2847 3127s
  9946   966 -7907.7200   33  261 -8497.8146 -5651.6554  33.5%  2811 3165s
 10250   665 -7514.8698   37  184 -8497.8146 -5884.0109  30.8%  2775 3201s
 10651   380     cutoff   24      -8497.8146 -6466.8658  23.9%  2714 3230s
 10948   236     cutoff   25      -8497.8146 -7043.1467  17.1%  2670 3242s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 506
  Flow cover: 2217
  RLT: 23
  Relax-and-lift: 165

Explored 11008 nodes (29494684 simplex iterations) in 3242.18 seconds (5565.99 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8497.81 -8501.69 -8511.01 ... -10137.8
No other solutions better than -8497.81

Optimal solution found (tolerance 1.00e-06)
Best objective -8.497814629903e+03, best bound -8.497814629903e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3242.23s
  Master Objective (UB) = -8497.81, θ = 118941.38
  Upper Bound (UB) = -8497.81

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118941.38
  [DEBUG]   ✓ Scenario 0: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118941.38 ≤ Q = 118941.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118941.38 ≤ Q = 120570.29 (slack: 1628.92)
  [DEBUG]   ✓ Scenario 3: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118941.38 ≤ Q = 118941.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118941.38 ≤ Q = 135413.57 (slack: 16472.19)
  [DEBUG]   ✓ Scenario 7: θ = 118941.38 ≤ Q = 130354.06 (slack: 11412.69)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1bb3ff97
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe44c0069
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.458447e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 7359065.3766
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.302462e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130246.23    0  123 7359065.38 -130246.23   102%     -    0s
H    0     0                    -95179.81192 -130246.23  36.8%     -    0s
H    0     0                    -95443.06448 -130246.23  36.5%     -    0s
     0     0 -104497.52    0   49 -95443.064 -104497.52  9.49%     -    0s
H    0     0                    -103158.3195 -104475.08  1.28%     -    0s
     0     0 -104136.96    0   30 -103158.32 -104136.96  0.95%     -    0s
H    0     0                    -103406.4255 -104073.13  0.64%     -    0s
H    0     0                    -103409.7620 -104045.06  0.61%     -    0s
     0     0 -104045.06    0   25 -103409.76 -104045.06  0.61%     -    0s
     0     0 -103990.58    0   25 -103409.76 -103990.58  0.56%     -    0s
     0     0 -103989.04    0   25 -103409.76 -103989.04  0.56%     -    0s
     0     0 -103683.33    0   22 -103409.76 -103683.33  0.26%     -    0s
H    0     0                    -103439.6569 -103660.55  0.21%     -    0s
H    0     0                    -103442.6616 -103655.41  0.21%     -    0s
H    0     0                    -103450.8558 -103655.41  0.20%     -    0s
     0     0 -103655.41    0   22 -103450.86 -103655.41  0.20%     -    0s
     0     0 -103647.33    0   19 -103450.86 -103647.33  0.19%     -    0s
     0     0 -103552.52    0    9 -103450.86 -103552.52  0.10%     -    0s
     0     0 -103535.56    0   10 -103450.86 -103535.56  0.08%     -    0s
H    0     0                    -103486.4886 -103535.56  0.05%     -    0s
*    0     0               0    -103503.5310 -103503.53  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 7
  MIR: 7
  Flow cover: 3
  RLT: 3

Explored 1 nodes (633 simplex iterations) in 0.15 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -103504 -103486 -103451 ... 1.45845e+13
No other solutions better than -103504

Optimal solution found (tolerance 1.00e-06)
Best objective -1.035035309609e+05, best bound -1.035035309609e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 114945.99
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103503.53
  [DEBUG]   S×d_nominal = 218449.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 218449.52 + -103503.53 = 114945.99
  [DEBUG]   Current θ from Master = 118941.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3995.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -12493.20
  Lower Bound (LB) = -9128.18
  Gap (UB-LB) = 630.3614, Absolute Gap = 630.3614, Relative Gap = 0.074179
  Not converged yet (gap = 630.36 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0xacc74fc4
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63930 rows and 25980 columns
Presolve time: 2.44s
Presolved: 75063 rows, 32440 columns, 468209 nonzeros
Variable types: 30181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398515.1785
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75063 rows, 32440 columns, 468209 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20881   -1.8416524e+05   0.000000e+00   4.718552e+06      5s
   38037   -3.1577813e+04   0.000000e+00   8.821213e+06     10s
   44667   -1.8571326e+04   0.000000e+00   1.143417e+08     15s
   50907    4.0686392e+02   0.000000e+00   2.249849e+06     20s
   56021    2.9726197e+03   0.000000e+00   1.273396e+07     25s
   59318    3.0385905e+03   0.000000e+00   3.325331e+06     30s
   63193    4.3889742e+03   0.000000e+00   1.973788e+06     35s
   67539    5.6097010e+03   0.000000e+00   1.056133e+06     40s
   71103    6.2221781e+03   0.000000e+00   4.609285e+06     45s
   75272    9.3732897e+03   0.000000e+00   6.553094e+06     50s
   78977    1.0151492e+04   0.000000e+00   3.482691e+06     55s
   83163    1.0558990e+04   0.000000e+00   2.168247e+06     60s
   86617    1.0841805e+04   0.000000e+00   2.838937e+06     65s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.175750e+04, 58534 iterations, 64.82 seconds (81.29 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11757.4994    0  133 -239633.31 11757.4994   105%     -   68s
H    0     0                    -224138.0420 11757.4994   105%     -   68s
H    0     0                    -137258.7563 11757.4994   109%     -   68s
H    0     0                    -136363.1627 11757.4994   109%     -   69s
H    0     0                    -132642.8256 11757.4994   109%     -   69s
H    0     0                    -132468.4472 11757.4994   109%     -   69s
H    0     0                    -54015.89683 11757.4994   122%     -   69s
H    0     0                    -10546.49472 11757.4994   211%     -   70s
H    0     0                    -9597.054235 11757.4994   223%     -   70s
H    0     0                    -8716.707335 11757.4994   235%     -   71s
H    0     0                    -8670.354750 8226.87401   195%     -   93s
     0     0 7863.63293    0  338 -8670.3548 7863.63293   191%     -   94s
     0     0 7863.63293    0  403 -8670.3548 7863.63293   191%     -   98s
     0     0 7863.63293    0  340 -8670.3548 7863.63293   191%     -   99s
     0     0 7863.63293    0  340 -8670.3548 7863.63293   191%     -   99s
     0     0 5580.68239    0  372 -8670.3548 5580.68239   164%     -  111s
H    0     0                    -8667.660478 5580.68239   164%     -  112s
     0     0 5472.33077    0  371 -8667.6605 5472.33077   163%     -  115s
     0     0 5326.49112    0  384 -8667.6605 5326.49112   161%     -  118s
     0     0 5209.41959    0  368 -8667.6605 5209.41959   160%     -  121s
     0     0 5086.72735    0  418 -8667.6605 5086.72735   159%     -  123s
     0     0 5080.28917    0  434 -8667.6605 5080.28917   159%     -  124s
     0     0 5075.25826    0  442 -8667.6605 5075.25826   159%     -  125s
     0     0 5061.09478    0  442 -8667.6605 5061.09478   158%     -  126s
     0     0 5039.11731    0  450 -8667.6605 5039.11731   158%     -  128s
     0     0 5037.48578    0  449 -8667.6605 5037.48578   158%     -  128s
     0     0 5037.48578    0  449 -8667.6605 5037.48578   158%     -  128s
     0     0 3243.26416    0  461 -8667.6605 3243.26416   137%     -  145s
H    0     0                    -8652.733857 3242.78962   137%     -  146s
     0     0 2910.31005    0  492 -8652.7339 2910.31005   134%     -  153s
     0     0 2818.88218    0  542 -8652.7339 2818.88218   133%     -  157s
     0     0 2771.63924    0  485 -8652.7339 2771.63924   132%     -  160s
     0     0 2755.42903    0  486 -8652.7339 2755.42903   132%     -  161s
     0     0 2749.75430    0  486 -8652.7339 2749.75430   132%     -  162s
     0     0 2744.90651    0  488 -8652.7339 2744.90651   132%     -  163s
     0     0 2739.71408    0  487 -8652.7339 2739.71408   132%     -  163s
     0     0 2738.62199    0  490 -8652.7339 2738.62199   132%     -  164s
     0     0 2709.67417    0  549 -8652.7339 2709.67417   131%     -  165s
     0     0 2708.32536    0  547 -8652.7339 2708.32536   131%     -  166s
     0     0 2708.24823    0  548 -8652.7339 2708.24823   131%     -  166s
     0     0 2162.99173    0  495 -8652.7339 2162.99173   125%     -  179s
     0     0 2035.25796    0  504 -8652.7339 2035.25796   124%     -  185s
     0     0 1996.06956    0  496 -8652.7339 1996.06956   123%     -  189s
     0     0 1951.33605    0  512 -8652.7339 1951.33605   123%     -  192s
     0     0 1923.30531    0  495 -8652.7339 1923.30531   122%     -  194s
     0     0 1885.82800    0  572 -8652.7339 1885.82800   122%     -  197s
     0     0 1879.55311    0  569 -8652.7339 1879.55311   122%     -  199s
     0     0 1860.02554    0  513 -8652.7339 1860.02554   121%     -  200s
     0     0 1856.32653    0  514 -8652.7339 1856.32653   121%     -  201s
     0     0 1850.64288    0  509 -8652.7339 1850.64288   121%     -  202s
     0     0 1843.80054    0  505 -8652.7339 1843.80054   121%     -  203s
     0     0 1843.74770    0  509 -8652.7339 1843.74770   121%     -  203s
     0     0 1740.07419    0  433 -8652.7339 1740.07419   120%     -  208s
     0     0 1734.78497    0  504 -8652.7339 1734.78497   120%     -  210s
     0     0 1727.67696    0  505 -8652.7339 1727.67696   120%     -  212s
     0     0 1712.30429    0  507 -8652.7339 1712.30429   120%     -  213s
     0     0 1706.41790    0  503 -8652.7339 1706.41790   120%     -  214s
     0     0 1705.40213    0  501 -8652.7339 1705.40213   120%     -  216s
     0     0 1657.70601    0  514 -8652.7339 1657.70601   119%     -  221s
     0     0 1623.68563    0  508 -8652.7339 1623.68563   119%     -  230s
     0     0 1617.08084    0  520 -8652.7339 1617.08084   119%     -  231s
     0     0 1614.10983    0  524 -8652.7339 1614.10983   119%     -  232s
     0     0 1613.94277    0  523 -8652.7339 1613.94277   119%     -  232s
     0     0 1593.14392    0  534 -8652.7339 1593.14392   118%     -  237s
     0     0 1586.20911    0  539 -8652.7339 1586.20911   118%     -  239s
     0     0 1585.32977    0  534 -8652.7339 1585.32977   118%     -  240s
     0     0 1572.84994    0  541 -8652.7339 1572.84994   118%     -  243s
H    0     0                    -8639.537874 1571.76770   118%     -  244s
     0     0 1564.58881    0  445 -8639.5379 1564.58881   118%     -  245s
     0     0 1561.27007    0  538 -8639.5379 1561.27007   118%     -  246s
     0     0 1560.95239    0  539 -8639.5379 1560.95239   118%     -  246s
     0     0 1558.33687    0  547 -8639.5379 1558.33687   118%     -  249s
     0     0 1557.85089    0  538 -8639.5379 1557.85089   118%     -  250s
     0     0 1547.88361    0  550 -8639.5379 1547.88361   118%     -  253s
     0     0 1547.29275    0  546 -8639.5379 1547.29275   118%     -  256s
     0     0 1544.02734    0  537 -8639.5379 1544.02734   118%     -  258s
     0     0 1543.50618    0  551 -8639.5379 1543.50618   118%     -  259s
     0     0 1537.59105    0  545 -8639.5379 1537.59105   118%     -  262s
     0     0 1537.48742    0  545 -8639.5379 1537.48742   118%     -  265s
     0     2 1537.47563    0  545 -8639.5379 1537.47563   118%     -  352s
     1     4 1420.46390    1  583 -8639.5379 1537.47375   118%  4216  359s
     3     8 1372.70743    2  584 -8639.5379 1437.09205   117%  4941  383s
     7    16 1069.38497    3  583 -8639.5379 1372.00848   116%  7433  392s
    15    32  927.55472    4  579 -8639.5379 1294.07518   115%  5465  402s
    31    51 -4693.0985    5  215 -8639.5379 1145.02714   113%  7792  423s
    50    82 -178.04325    6  262 -8639.5379 1144.89666   113%  7819  440s
    81   143 -191.36706    7  269 -8639.5379 1144.89666   113%  6681  457s
   146   195 -430.35986    8  342 -8639.5379 1144.89666   113%  5382  472s
   198   272 -434.34804    9  342 -8639.5379 1144.89666   113%  4522  486s
   285   348 -5573.1667   12  154 -8639.5379 1144.89666   113%  3884  501s
   374   389 -818.91983   13  331 -8639.5379 1144.89666   113%  3446  515s
   450   424 -7177.0303   13  146 -8639.5379 1144.89666   113%  3322  527s
   531   456 -1329.4457   14  229 -8639.5379 1144.89666   113%  3287  540s
   610   480 -4671.2431   14  329 -8639.5379 1144.89666   113%  3308  554s
   674   494 -1605.8194   15  306 -8639.5379 1144.89666   113%  3366  567s
   724   532 -2195.6507   16  280 -8639.5379 1072.36257   112%  3394  579s
   778   560 -2210.5183   17  282 -8639.5379 1072.36257   112%  3498  591s
   834   605 -2974.9617   18  266 -8639.5379 1072.36257   112%  3559  603s
   895   647 -6696.7987   18  278 -8639.5379 1072.36257   112%  3614  615s
   965   696 -3117.5518   19  269 -8639.5379 1072.36257   112%  3609  625s
  1059   729 -3159.4048   20  351 -8639.5379 1072.36257   112%  3527  639s
  1124   778 -3226.5731   21  323 -8639.5379  999.83064   112%  3526  652s
  1229   826 -3701.2265   20  358 -8639.5379  999.83064   112%  3464  666s
  1317   906 -8132.0511   21  132 -8639.5379  999.83064   112%  3404  679s
  1428   983 -4355.4065   24  259 -8639.5379  999.83064   112%  3335  694s
  1547  1040 -7978.1727   24  178 -8639.5379  926.85440   111%  3268  709s
  1664  1098 -4699.6633   26  239 -8639.5379  926.85440   111%  3259  724s
  1780  1121 -5052.2949   30  164 -8639.5379  926.85440   111%  3256  740s
  1854  1157 -5060.1891   31  158 -8639.5379  926.85440   111%  3238  756s
  1938  1203 -5686.5666   31  162 -8639.5379  926.85440   111%  3254  774s
  2044  1258 -5452.3623   33  214 -8639.5379  926.85440   111%  3283  789s
  2167  1316 -6076.7073   36  302 -8639.5379  926.85440   111%  3320  803s
  2273  1360 -6650.0581   39  243 -8639.5379  777.55057   109%  3349  820s
  2439  1415     cutoff   45      -8639.5379  777.55057   109%  3326  838s
  2588  1447 -1087.7908   11  329 -8639.5379  777.55057   109%  3334  859s
  2700  1503 -4378.9540   12  318 -8639.5379  625.82636   107%  3379  876s
  2820  1564 -4758.7647   13  426 -8639.5379  625.82636   107%  3431  895s
  2951  1612 -5938.3431   14  244 -8639.5379  625.82636   107%  3479  915s
  3063  1672 -6512.9109   15  448 -8639.5379  625.82636   107%  3485  934s
  3211  1695 -6611.4236   16  451 -8639.5379  625.82636   107%  3489  955s
  3381  1778     cutoff   19      -8639.5379  625.82636   107%  3464  976s
  3520  1837 -7873.0052   22  235 -8639.5379  625.82636   107%  3502  999s
  3703  1921 -5069.5737   12  351 -8639.5379  625.82636   107%  3511 1018s
  3890  1946 -6702.7090   16  320 -8639.5379  124.79009   101%  3528 1039s
  3929  1970     cutoff   17      -8639.5379  120.07601   101%  3547 1054s
  3972  1994 -7189.5707   16  272 -8639.5379  120.07601   101%  3562 1070s
  4012  2020 -7216.4498   17  289 -8639.5379  120.07601   101%  3571 1091s
  4084  2040     cutoff   18      -8639.5379  120.07601   101%  3563 1111s
  4128  2061 -7601.2914   19  276 -8639.5379  120.07601   101%  3567 1135s
  4191  2086 -8163.3696   20  289 -8639.5379  120.07601   101%  3567 1160s
  4289  2143 -8256.2458   21  215 -8639.5379  120.07601   101%  3588 1187s
  4437  2214 -5566.5170    9  352 -8639.5379 -190.43189  97.8%  3602 1215s
  4641  2338 -7323.3306   14  370 -8639.5379 -233.58066  97.3%  3614 1241s
H 4883  2338                    -8638.718490 -233.58066  97.3%  3638 1254s
  4884  2339 -4866.0390   15  545 -8638.7185 -233.58066  97.3%  3637 1347s
H 4885  2223                    -8601.060886 -233.58066  97.3%  3636 1427s
  4887  2224 -8164.6710   35  426 -8601.0609 -233.58066  97.3%  3635 1463s
  4888  2225 -1740.0069   16  393 -8601.0609 -233.58066  97.3%  3634 1480s
  4889  2225 -4560.0333   27  548 -8601.0609 -233.58066  97.3%  3633 1494s
  4890  2226 -1851.9199    8  536 -8601.0609 -233.58066  97.3%  3633 1504s
  4891  2227 -5137.6737   16  495 -8601.0609 -233.58066  97.3%  3632 1512s
  4892  2227 -409.73444   10  486 -8601.0609 -233.58066  97.3%  3631 1516s
  4893  2228 -875.09219    9  582 -8601.0609 -233.58066  97.3%  3630 1522s
  4895  2229 -5490.8288   15  532 -8601.0609 -233.58066  97.3%  3629 1527s
  4897  2231 -6787.1107   20  546 -8601.0609 -233.58066  97.3%  3627 1534s
  4898  2231 -6454.2380   13  449 -8601.0609 -233.58066  97.3%  3627 1542s
  4899  2232 -7273.5766   21  490 -8601.0609 -233.58066  97.3%  3626 1547s
  4900  2233 -4787.1990   12  443 -8601.0609 -233.58066  97.3%  3625 1550s
  4902  2234 -4585.5580   12  508 -8601.0609 -233.58066  97.3%  3624 1563s
  4903  2235 -5978.0603   20  609 -8601.0609 -233.58066  97.3%  3623 1568s
  4905  2236 -8295.0805   28  526 -8601.0609 -233.58066  97.3%  3622 1573s
  4906  2237 -4246.5202   18  537 -8601.0609 -233.58066  97.3%  3621 1583s
  4907  2237 -6182.6442   21  533 -8601.0609 -233.58066  97.3%  3620 1585s
  4909  2239 -4780.3641   15  553 -8601.0609 -233.58066  97.3%  3619 1597s
  4911  2240 -6969.2808   17  538 -8601.0609 -233.58066  97.3%  3617 1603s
  4912  2241 -8322.5623   35  515 -8601.0609 -233.58066  97.3%  3616 1620s
H 4912  2128                    -8575.907031 -233.58066  97.3%  3616 1620s
  4914  2129 -7233.8828   33  545 -8575.9070 -233.58066  97.3%  3615 1630s
  4916  2130 -7529.8751   22  560 -8575.9070 -233.58066  97.3%  3613 1659s
  4917  2131 -7936.2169   20  548 -8575.9070 -233.58066  97.3%  3613 1663s
  4918  2132 -1528.2230   16  533 -8575.9070 -233.58066  97.3%  3612 1672s
  4920  2133 -1810.2133   14  553 -8575.9070 -233.58066  97.3%  3610 1679s
  4921  2134 -6654.2730   15  560 -8575.9070 -233.58066  97.3%  3610 1686s
  4922  2134 -7503.6523   44  560 -8575.9070 -233.58066  97.3%  3609 1765s
H 4922  2027                    -8567.740884 -233.58066  97.3%  3609 1785s
  4923  2028 -2132.9898    8  560 -8567.7409 -233.58066  97.3%  3608 1805s
  4924  2032 -233.58066   12  609 -8567.7409 -233.58066  97.3%  3653 1834s
  4926  2035 -233.58066   13  523 -8567.7409 -233.58066  97.3%  3655 1854s
  4930  2042 -233.58066   14  521 -8567.7409 -233.58066  97.3%  3656 1877s
  4938  2055 -233.58066   15  442 -8567.7409 -233.58066  97.3%  3666 1908s
  4954  2066 -1192.3998   16  459 -8567.7409 -233.58066  97.3%  3692 1958s
  4970  2092 -4395.5312   17  262 -8567.7409 -233.58066  97.3%  3735 2004s
  5002  2187 -4816.1806   18  260 -8567.7409 -233.58066  97.3%  3751 2038s
  5127  2170 -6352.8920   21  203 -8567.7409 -233.58066  97.3%  3789 2058s
  5173  2171 -6360.7243   23  231 -8567.7409 -233.58066  97.3%  3787 2079s
  5222  2164     cutoff   23      -8567.7409 -233.58066  97.3%  3776 2100s
  5270  2162 -8215.7911   22  200 -8567.7409 -233.58066  97.3%  3782 2121s
  5325  2155     cutoff   23      -8567.7409 -233.58066  97.3%  3791 2147s
  5375  2143 -8218.3033   24  311 -8567.7409 -233.58066  97.3%  3797 2166s
  5444  2140 -8478.9878   25  269 -8567.7409 -233.58066  97.3%  3802 2196s
  5513  2134     cutoff   26      -8567.7409 -233.58066  97.3%  3814 2215s
  5585  2112 -7190.6601   39  190 -8567.7409 -233.58066  97.3%  3820 2235s
  5663  2105     cutoff   40      -8567.7409 -233.58066  97.3%  3808 2254s
  5730  2094 -2993.7343   24  368 -8567.7409 -233.58066  97.3%  3804 2279s
  5798  2093 -3740.8976   25  334 -8567.7409 -233.58066  97.3%  3808 2306s
  5856  2097 -3798.6128   26  336 -8567.7409 -233.58066  97.3%  3832 2325s
  5928  2099 -4085.4628   27  272 -8567.7409 -233.58066  97.3%  3838 2349s
  5980  2113 -4353.6239   28  164 -8567.7409 -233.58066  97.3%  3849 2376s
  6046  2108 -5100.8845   29  251 -8567.7409 -233.58066  97.3%  3860 2397s
  6127  2108 -5102.7220   30  250 -8567.7409 -233.58066  97.3%  3854 2423s
  6200  2121 -5796.0011   33  168 -8567.7409 -233.58066  97.3%  3864 2446s
  6279  2125     cutoff   36      -8567.7409 -233.58066  97.3%  3873 2469s
  6371  2127 -6405.8855   35  189 -8567.7409 -233.58066  97.3%  3874 2496s
  6465  2141     cutoff   38      -8567.7409 -233.58066  97.3%  3892 2527s
  6572  2139 -6466.6114   38  328 -8567.7409 -233.58066  97.3%  3896 2555s
  6707  2138 -7228.7705   34  250 -8567.7409 -526.09392  93.9%  3893 2583s
  6841  2111 -4611.0407   18  575 -8567.7409 -526.09392  93.9%  3888 2613s
  6993  2099 -4935.3764   20  655 -8567.7409 -526.09392  93.9%  3868 2644s
  7097  2097 -5756.7560   22  552 -8567.7409 -526.09392  93.9%  3885 2675s
  7228  2091 -6279.1069   26  475 -8567.7409 -526.09392  93.9%  3893 2708s
  7346  2093 -7752.6637   29  373 -8567.7409 -526.09392  93.9%  3907 2740s
  7512  2090 -8168.8476   19  200 -8567.7409 -1627.0056  81.0%  3910 2774s
  7635  2079     cutoff   20      -8567.7409 -1627.0056  81.0%  3927 2807s
  7814  2049 -7648.5239   23  449 -8567.7409 -1672.1090  80.5%  3929 2841s
  7999  2022 -6845.2961   23  308 -8567.7409 -1673.8573  80.5%  3937 2881s
  8147  2022 -7052.9348   26  421 -8567.7409 -1673.8573  80.5%  3966 2917s
  8307  2030     cutoff   30      -8567.7409 -1673.8573  80.5%  3983 2958s
  8520  2023 infeasible   22      -8567.7409 -2476.3731  71.1%  3976 3000s
  8680  2044 infeasible   21      -8567.7409 -2727.8611  68.2%  3978 3053s
  8907  1979 -5797.6287   29  429 -8567.7409 -2791.8772  67.4%  3982 3105s
H 8910  1876                    -8560.701347 -2791.8772  67.4%  3983 3105s
  8954  1914 -5881.6174   30  337 -8560.7013 -2800.6845  67.3%  3999 3149s
  9185  1841 -4240.8798   22  333 -8560.7013 -2869.0942  66.5%  4015 3193s
  9433  1769     cutoff   26      -8560.7013 -2993.6186  65.0%  4021 3241s
  9718  1683 -8456.8719   21  515 -8560.7013 -3070.2517  64.1%  4018 3286s
  9935  1648     cutoff   21      -8560.7013 -3539.8792  58.6%  4022 3340s
 10261  1526 -7285.2725   22  247 -8560.7013 -3567.6142  58.3%  4014 3401s
 10602  1451     cutoff   33      -8560.7013 -3872.1441  54.8%  4006 3457s
 10948  1424 -8534.1007   30  258 -8560.7013 -4122.8302  51.8%  3997 3519s
 11323  1445 -5367.7154   31  317 -8560.7013 -4208.3736  50.8%  3993 3574s
 11716  1443 -8402.4614   34  100 -8560.7013 -4339.3064  49.3%  3986 3600s

Cutting planes:
  Learned: 2
  Gomory: 2
  MIR: 567
  Mixing: 1
  Flow cover: 2950
  RLT: 10
  Relax-and-lift: 141

Explored 11933 nodes (47629241 simplex iterations) in 3600.09 seconds (6427.28 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8560.7 -8567.74 -8575.91 ... -8716.71

Time limit reached
Best objective -8.560701347052e+03, best bound -4.339306447636e+03, gap 49.3113%
  WARNING: Time limit reached. Using best solution found (gap: 49.31%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -8560.70, θ = 118890.34
  Upper Bound (UB) = -8560.70

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118890.34
  [DEBUG]   ✓ Scenario 0: θ = 118890.34 ≤ Q = 118890.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118890.34 ≤ Q = 118890.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118890.34 ≤ Q = 118890.34 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5489814f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5489814f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-14, 2e+02]
Found heuristic solution: objective 1.363321e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6792067.4680
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.295932e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129593.22    0  122 6792067.47 -129593.22   102%     -    0s
H    0     0                    -94730.12224 -129593.22  36.8%     -    0s
H    0     0                    -94993.37481 -129593.22  36.4%     -    0s
     0     0 -101146.36    0   94 -94993.375 -101146.36  6.48%     -    0s
H    0     0                    -97848.41586 -101030.15  3.25%     -    0s
H    0     0                    -98589.34584 -101030.15  2.48%     -    0s
     0     0 -100522.49    0   94 -98589.346 -100522.49  1.96%     -    0s
H    0     0                    -98896.45038 -100497.37  1.62%     -    0s
     0     0 -100497.37    0   94 -98896.450 -100497.37  1.62%     -    0s
     0     0 -100338.37    0   97 -98896.450 -100338.37  1.46%     -    0s
     0     0 -100331.92    0   97 -98896.450 -100331.92  1.45%     -    0s
     0     2 -100331.92    0   97 -98896.450 -100331.92  1.45%     -    0s
H   44    48                    -98897.52088 -99922.294  1.04%  17.6    0s
H  526   376                    -98921.39670 -99774.604  0.86%   7.0    0s
H  531   376                    -99061.41679 -99774.604  0.72%   7.0    0s
H  536   376                    -99077.86012 -99774.604  0.70%   6.9    0s
*  546   376              17    -99298.83339 -99774.604  0.48%   6.9    0s
H  774   246                    -99393.13883 -99562.739  0.17%   6.7    0s
H  776   246                    -99415.62815 -99562.739  0.15%   6.6    0s

Cutting planes:
  Gomory: 48
  Implied bound: 8
  MIR: 230

Explored 1081 nodes (6598 simplex iterations) in 0.17 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -99415.6 -99393.1 -99298.8 ... -94993.4
No other solutions better than -99415.6

Optimal solution found (tolerance 1.00e-06)
Best objective -9.941562815066e+04, best bound -9.941562815066e+04, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 118436.31
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99415.63
  [DEBUG]   S×d_nominal = 217851.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217851.93 + -99415.63 = 118436.31
  [DEBUG]   Current θ from Master = 118890.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 454.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9014.73
  Lower Bound (LB) = -9014.73
  Gap (UB-LB) = 454.0336, Absolute Gap = 454.0336, Relative Gap = 0.053037
  Not converged yet (gap = 454.03 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x22f72560
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 71040 rows and 28870 columns
Presolve time: 2.92s
Presolved: 83243 rows, 35790 columns, 510349 nonzeros
Variable types: 33531 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -398565.1771
Found heuristic solution: objective -239633.3060

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.560e+06
 Factor NZ  : 7.673e+06 (roughly 100 MB of memory)
 Factor Ops : 1.319e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.80655238e+07  1.51177788e+08  9.73e+04 2.21e+01  7.82e+04     5s
   1  -1.35607616e+07  1.30825751e+08  6.65e+04 7.27e+01  5.29e+04     5s
   2  -4.46258168e+06  1.02643880e+08  2.12e+04 1.11e-11  1.79e+04     5s
   3  -7.08410955e+05  6.80200330e+07  1.33e+03 1.09e+00  1.49e+03     5s
   4  -4.49866632e+05  2.17526549e+07  3.15e+02 2.53e-01  3.59e+02     5s
   5  -3.06241097e+05  1.55454790e+07  9.74e+01 1.52e-01  1.65e+02     5s
   6  -1.67351571e+05  1.12845653e+07  2.16e+01 1.01e-01  8.66e+01     5s
   7  -1.27595786e+05  6.85908673e+06  1.16e+01 5.77e-02  5.00e+01     6s
   8  -9.78142571e+04  3.65606832e+06  5.61e+00 2.89e-02  2.58e+01     6s
   9  -8.69022372e+04  2.23431085e+06  4.00e+00 1.74e-02  1.58e+01     6s
  10  -6.65268962e+04  4.81389566e+05  1.71e+00 3.32e-03  3.66e+00     6s
  11  -3.63079016e+04  1.39327395e+05  6.69e-01 7.71e-04  1.16e+00     6s
  12  -2.57544114e+04  8.53120529e+04  5.10e-01 1.69e-03  7.35e-01     6s
  13  -2.32636187e+04  7.74055741e+04  4.74e-01 1.79e-03  6.66e-01     6s
  14  -1.88264158e+04  5.98987117e+04  4.13e-01 1.89e-03  5.21e-01     6s
  15  -1.42927307e+04  4.76440123e+04  3.53e-01 1.46e-03  4.10e-01     6s
  16  -1.01151915e+04  3.96890184e+04  3.00e-01 1.06e-03  3.30e-01     6s
  17  -7.63210143e+03  3.20071258e+04  2.66e-01 1.72e-03  2.63e-01     6s
  18  -4.13547804e+03  2.77107750e+04  2.21e-01 2.24e-03  2.11e-01     7s
  19  -1.41113300e+03  2.50777257e+04  1.86e-01 1.53e-03  1.76e-01     7s
  20   1.53319657e+03  2.21924738e+04  1.48e-01 1.43e-03  1.37e-01     7s
  21   3.12946181e+03  1.95891665e+04  1.27e-01 1.24e-03  1.09e-01     7s
  22   5.89011569e+03  1.88338697e+04  9.56e-02 1.36e-03  8.58e-02     7s
  23   6.50857805e+03  1.75265095e+04  8.89e-02 1.13e-03  7.31e-02     7s
  24   7.84184625e+03  1.68650751e+04  7.43e-02 1.39e-03  5.99e-02     7s
  25   9.23653967e+03  1.62837167e+04  5.81e-02 1.35e-03  4.68e-02     7s
  26   1.07381330e+04  1.57070098e+04  4.17e-02 1.47e-03  3.30e-02     7s
  27   1.16738373e+04  1.53594700e+04  3.17e-02 2.29e-03  2.45e-02     7s
  28   1.23750080e+04  1.51808441e+04  2.41e-02 1.50e-03  1.86e-02     7s
  29   1.29676744e+04  1.50515083e+04  1.82e-02 1.07e-03  1.38e-02     8s
  30   1.34273816e+04  1.49747676e+04  1.32e-02 8.39e-04  1.03e-02     8s
  31   1.38620353e+04  1.48750795e+04  8.58e-03 7.41e-04  6.72e-03     8s
  32   1.39611953e+04  1.47924518e+04  7.57e-03 4.63e-04  5.52e-03     8s
  33   1.42457533e+04  1.47410822e+04  4.49e-03 4.64e-04  3.29e-03     8s
  34   1.43625503e+04  1.47284355e+04  3.27e-03 3.40e-04  2.43e-03     8s
  35   1.44112773e+04  1.47067318e+04  2.78e-03 1.40e-04  1.96e-03     8s
  36   1.44335694e+04  1.47014525e+04  2.54e-03 1.05e-04  1.78e-03     8s
  37   1.45207083e+04  1.46975256e+04  1.62e-03 7.92e-05  1.18e-03     8s
  38   1.46500169e+04  1.46938769e+04  3.52e-04 5.32e-05  2.91e-04     9s
  39   1.46665382e+04  1.46930481e+04  1.91e-04 4.56e-05  1.76e-04     9s
  40   1.46713521e+04  1.46903302e+04  1.43e-04 2.54e-05  1.26e-04     9s
  41   1.46795436e+04  1.46887411e+04  6.48e-05 1.38e-05  6.09e-05     9s
  42   1.46821662e+04  1.46882838e+04  4.07e-05 1.06e-05  4.05e-05     9s
  43   1.46841293e+04  1.46873577e+04  2.13e-05 4.36e-06  2.14e-05     9s
  44   1.46863674e+04  1.46867508e+04  2.09e-06 6.21e-07  2.53e-06     9s
  45   1.46866008e+04  1.46866419e+04  2.81e-07 1.49e-07  2.72e-07     9s
  46   1.46866011e+04  1.46866419e+04  7.13e-07 1.47e-07  2.70e-07     9s
  47   1.46866369e+04  1.46866397e+04  2.02e-07 2.46e-09  1.90e-08    10s
  48   1.46866394e+04  1.46866397e+04  1.80e-07 2.37e-07  1.99e-09    10s
  49   1.46866397e+04  1.46866397e+04  9.48e-07 9.35e-08  2.69e-10    10s

Barrier solved model in 49 iterations and 9.81 seconds (7.16 work units)
Optimal objective 1.46866397e+04


Root crossover log...

   74843 DPushes remaining with DInf 0.0000000e+00                10s
   39412 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    2912 PPushes remaining with PInf 2.5346304e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1029675e+01     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41059    1.4686640e+04   0.000000e+00   2.102967e+01     13s
   41091    1.4686640e+04   0.000000e+00   0.000000e+00     13s
   41091    1.4686640e+04   0.000000e+00   0.000000e+00     13s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 1.468664e+04, 41091 iterations, 9.16 seconds (9.66 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14686.6397    0  176 -239633.31 14686.6397   106%     -   13s
H    0     0                    -228819.5924 14686.6397   106%     -   13s
H    0     0                    -159193.2213 14686.6397   109%     -   14s
H    0     0                    -154217.5747 14686.6397   110%     -   14s
H    0     0                    -154161.8958 14686.6397   110%     -   14s
H    0     0                    -52399.62526 14686.6397   128%     -   14s
H    0     0                    -42319.92499 14686.6397   135%     -   15s
H    0     0                    -22314.93456 14686.6397   166%     -   15s
H    0     0                    -19208.68316 14686.6397   176%     -   15s
H    0     0                    -19106.97633 14686.6397   177%     -   15s
H    0     0                    -19099.66087 14686.6397   177%     -   15s
H    0     0                    -16816.71646 14686.6397   187%     -   17s
H    0     0                    -15813.21249 14686.6397   193%     -   17s
H    0     0                    -13380.75229 14686.6397   210%     -   17s
H    0     0                    -13372.49759 14686.6397   210%     -   17s
H    0     0                    -13314.33317 14686.6397   210%     -   17s
H    0     0                    -13269.39921 14686.6397   211%     -   17s
H    0     0                    -13241.47199 14686.6397   211%     -   17s
H    0     0                    -11537.31060 9293.78521   181%     -   44s
H    0     0                    -10290.45546 9293.78521   190%     -   44s
H    0     0                    -10193.92972 9293.78521   191%     -   44s
H    0     0                    -10159.20418 9293.78521   191%     -   44s
H    0     0                    -10157.05993 9293.78521   192%     -   44s
H    0     0                    -10129.17488 9293.78521   192%     -   44s
     0     0 9106.22274    0  331 -10129.175 9106.22274   190%     -   44s
     0     0 8488.17046    0  333 -10129.175 8488.17046   184%     -   55s
     0     0 8409.64013    0  373 -10129.175 8409.64013   183%     -   66s
     0     0 8326.43170    0  354 -10129.175 8326.43170   182%     -   68s
     0     0 8293.18005    0  373 -10129.175 8293.18005   182%     -   71s
     0     0 8293.18005    0  374 -10129.175 8293.18005   182%     -   74s
     0     0 8293.18005    0  374 -10129.175 8293.18005   182%     -   75s
     0     0 8293.18005    0  374 -10129.175 8293.18005   182%     -   76s
     0     0 5551.01105    0  411 -10129.175 5551.01105   155%     -  102s
H    0     0                    -10090.35632 5551.01105   155%     -  103s
H    0     0                    -10081.28900 5551.01105   155%     -  103s
H    0     0                    -10080.03859 5551.01105   155%     -  103s
     0     0 5363.34276    0  358 -10080.039 5363.34276   153%     -  111s
     0     0 5200.25707    0  359 -10080.039 5200.25707   152%     -  117s
     0     0 5101.20661    0  501 -10080.039 5101.20661   151%     -  128s
     0     0 4984.64382    0  382 -10080.039 4984.64382   149%     -  133s
     0     0 4885.49865    0  478 -10080.039 4885.49865   148%     -  144s
     0     0 4879.13935    0  484 -10080.039 4879.13935   148%     -  146s
     0     0 4878.08438    0  486 -10080.039 4878.08438   148%     -  147s
H    0     0                    -9988.869544 3503.15906   135%     -  183s
     0     0 3503.15906    0  533 -9988.8695 3503.15906   135%     -  183s
H    0     0                    -9948.276987 3497.54599   135%     -  184s
H    0     0                    -9922.214950 3497.54599   135%     -  184s
H    0     0                    -9825.856666 3497.54599   136%     -  184s
     0     0 3191.65213    0  529 -9825.8567 3191.65213   132%     -  192s
     0     0 3045.55831    0  540 -9825.8567 3045.55831   131%     -  200s
     0     0 2964.28825    0  545 -9825.8567 2964.28825   130%     -  207s
     0     0 2955.51878    0  554 -9825.8567 2955.51878   130%     -  209s
     0     0 2941.81588    0  549 -9825.8567 2941.81588   130%     -  212s
     0     0 2933.55647    0  551 -9825.8567 2933.55647   130%     -  214s
     0     0 2932.36654    0  561 -9825.8567 2932.36654   130%     -  214s
     0     0 2506.00309    0  505 -9825.8567 2506.00309   126%     -  232s
     0     0 2332.55676    0  520 -9825.8567 2332.55676   124%     -  240s
     0     0 2279.52055    0  523 -9825.8567 2279.52055   123%     -  245s
     0     0 2252.84658    0  535 -9825.8567 2252.84658   123%     -  248s
     0     0 2247.45870    0  535 -9825.8567 2247.45870   123%     -  249s
     0     0 2240.65424    0  525 -9825.8567 2240.65424   123%     -  250s
     0     0 2226.22611    0  525 -9825.8567 2226.22611   123%     -  251s
     0     0 2219.11218    0  525 -9825.8567 2219.11218   123%     -  252s
     0     0 2217.07777    0  455 -9825.8567 2217.07777   123%     -  253s
     0     0 2202.21099    0  513 -9825.8567 2202.21099   122%     -  255s
     0     0 2195.94783    0  519 -9825.8567 2195.94783   122%     -  256s
     0     0 2192.80279    0  521 -9825.8567 2192.80279   122%     -  257s
     0     0 2189.36840    0  516 -9825.8567 2189.36840   122%     -  259s
     0     0 2188.59162    0  519 -9825.8567 2188.59162   122%     -  259s
     0     0 1950.10666    0  504 -9825.8567 1950.10666   120%     -  273s
H    0     0                    -9595.130755 1947.03143   120%     -  274s
H    0     0                    -9577.417619 1947.03143   120%     -  274s
     0     0 1865.40735    0  511 -9577.4176 1865.40735   119%     -  279s
     0     0 1850.01972    0  523 -9577.4176 1850.01972   119%     -  280s
     0     0 1842.50603    0  583 -9577.4176 1842.50603   119%     -  283s
     0     0 1838.06543    0  523 -9577.4176 1838.06543   119%     -  284s
     0     0 1834.90661    0  522 -9577.4176 1834.90661   119%     -  285s
     0     0 1833.47539    0  526 -9577.4176 1833.47539   119%     -  285s
     0     0 1776.71742    0  518 -9577.4176 1776.71742   119%     -  292s
H    0     0                    -8992.472305 1776.27560   120%     -  294s
H    0     0                    -8931.297596 1776.27560   120%     -  294s
H    0     0                    -8738.071842 1776.27560   120%     -  295s
H    0     0                    -8734.193354 1776.27560   120%     -  296s
     0     0 1763.81712    0  525 -8734.1934 1763.81712   120%     -  298s
     0     0 1760.04395    0  534 -8734.1934 1760.04395   120%     -  300s
     0     0 1759.37459    0  530 -8734.1934 1759.37459   120%     -  300s
     0     0 1737.11721    0  450 -8734.1934 1737.11721   120%     -  304s
     0     0 1725.14384    0  445 -8734.1934 1725.14384   120%     -  306s
     0     0 1723.24023    0  449 -8734.1934 1723.24023   120%     -  307s
     0     0 1722.08895    0  450 -8734.1934 1722.08895   120%     -  308s
     0     0 1703.68195    0  449 -8734.1934 1703.68195   120%     -  311s
H    0     0                    -8712.828848 1703.49918   120%     -  312s
     0     0 1682.44842    0  548 -8712.8288 1682.44842   119%     -  314s
     0     0 1679.01728    0  543 -8712.8288 1679.01728   119%     -  316s
     0     0 1677.57415    0  453 -8712.8288 1677.57415   119%     -  316s
     0     0 1667.63945    0  465 -8712.8288 1667.63945   119%     -  320s
     0     0 1664.44965    0  462 -8712.8288 1664.44965   119%     -  322s
     0     0 1663.01124    0  469 -8712.8288 1663.01124   119%     -  323s
     0     0 1647.88422    0  463 -8712.8288 1647.88422   119%     -  327s
H    0     0                    -8710.134575 1646.85949   119%     -  334s
     0     0 1646.85949    0  466 -8710.1346 1646.85949   119%     -  336s
     0     0 1640.06945    0  535 -8710.1346 1640.06945   119%     -  340s
     0     0 1635.06045    0  540 -8710.1346 1635.06045   119%     -  343s
     0     0 1633.93882    0  462 -8710.1346 1633.93882   119%     -  344s
     0     0 1631.96895    0  549 -8710.1346 1631.96895   119%     -  347s
H    0     0                    -8700.817080 1631.87420   119%     -  348s
     0     0 1631.67584    0  552 -8700.8171 1631.67584   119%     -  349s
     0     0 1625.31402    0  469 -8700.8171 1625.31402   119%     -  352s
     0     0 1625.04530    0  469 -8700.8171 1625.04530   119%     -  358s
     0     2 1625.04530    0  469 -8700.8171 1625.04530   119%     -  426s
     1     3 1529.52871    1  423 -8700.8171 1624.65751   119%  4799  432s
     2     6 1431.37763    2  488 -8700.8171 1624.65751   119%  5224  441s
     5    11 1076.59752    3  508 -8700.8171 1452.26020   117%  6515  453s
    10    22 1257.38598    4  420 -8700.8171 1430.47318   116%  6759  467s
    21    33 1054.96154    5  423 -8700.8171 1257.26062   114%  8736  500s
    32    65 1110.21185    6  436 -8700.8171 1257.26062   114% 10399  595s
H   36    65                    -8639.537874 1257.26062   115% 10094  595s
    64    97  601.94099    7  411 -8639.5379 1138.28288   113% 15116  615s
    96   168  590.38830    8  396 -8639.5379 1137.91344   113% 12134  641s
   167   279  563.12424   10  410 -8639.5379 1137.91344   113%  8159  661s
   282   317  109.23796   13  401 -8639.5379 1137.91344   113%  5866  679s
   340   331 -8542.7349   14  140 -8639.5379 1137.91344   113%  5689  695s
   400   362 -8604.2364   15  109 -8639.5379 1137.91344   113%  5609  712s
   469   401 -2099.1649   12  321 -8639.5379 1137.91344   113%  5695  729s
   525   443 -2738.2124   13  371 -8639.5379 1137.91344   113%  5818  747s
   573   488 -3181.5040   14  361 -8639.5379 1137.91344   113%  5934  761s
   630   530 -2787.1083   14  377 -8639.5379 1040.56230   112%  5867  778s
   688   559 -2851.8188   15  373 -8639.5379 1040.56230   112%  5838  792s
   752   601 -6140.3353   15  226 -8639.5379 1040.56230   112%  5767  808s
   815   638 -7602.2738   13  100 -8639.5379 1040.56230   112%  5781  823s
   881   686 -8210.2195   14   77 -8639.5379 1026.39409   112%  5738  840s
   947   740 -2893.4964   16  302 -8639.5379  979.15661   111%  5711  858s
  1024   763 infeasible   17      -8639.5379  979.15661   111%  5659  872s
  1063   791 -3490.1983   19  476 -8639.5379  834.49073   110%  5676  888s
  1097   814 -1775.6686   16  445 -8639.5379  834.49073   110%  5672  903s
  1136   833 infeasible   20      -8639.5379  834.49073   110%  5644  920s
  1187   855 -3703.6526   21  299 -8639.5379  834.49073   110%  5564  936s
  1241   883 -4004.6023   21  305 -8639.5379  834.49073   110%  5524  952s
  1289   921     cutoff   22      -8639.5379  816.86185   109%  5510  969s
  1356   953 -4098.5066   22  227 -8639.5379  816.86185   109%  5433  986s
  1439   981 -4417.5777   23  404 -8639.5379  788.62452   109%  5337 1006s
  1523  1012 -4646.3277   24  267 -8639.5379  747.89759   109%  5271 1026s
  1616  1067 -4945.6035   25  335 -8639.5379  747.89759   109%  5239 1047s
  1727  1127 -5484.1559   27  214 -8639.5379  677.87185   108%  5232 1070s
  1833  1181 infeasible   28      -8639.5379  677.87185   108%  5235 1090s
  1954  1226 -6643.7910   32  317 -8639.5379  607.67555   107%  5207 1113s
  2034  1273     cutoff   38      -8639.5379  577.22045   107%  5205 1137s
  2175  1309 infeasible   25      -8639.5379  557.91750   106%  5156 1164s
  2317  1405 -1036.6272   12  272 -8639.5379  557.91750   106%  5134 1191s
  2489  1465 -1660.6573   15  425 -8639.5379  557.91750   106%  5082 1220s
  2651  1511 -2406.4935   18  261 -8639.5379  557.91750   106%  5051 1249s
  2793  1574 infeasible   21      -8639.5379  510.84470   106%  5031 1278s
  2966  1614 -8538.1782   20  281 -8639.5379  510.84470   106%  5029 1311s
  3099  1675 -555.31513    9  501 -8639.5379  510.84470   106%  5074 1344s
  3252  1700 -1555.7359   11  383 -8639.5379  510.84470   106%  5109 1376s
  3291  1717 -1707.3870   12  390 -8639.5379  331.18326   104%  5142 1404s
  3348  1756 -1865.6353   13  433 -8639.5379  331.18326   104%  5146 1436s
  3411  1836 -2051.1733   14  356 -8639.5379  331.18326   104%  5154 1470s
  3551  1884 -2150.3703   16  302 -8639.5379  231.71648   103%  5134 1506s
  3726  1961 -7555.4759   19  131 -8639.5379  205.21688   102%  5111 1545s
  3900  2039 -5144.8430    9  446 -8639.5379  134.62913   102%  5132 1581s
  4101  2106 -6401.1593   12  355 -8639.5379  134.62913   102%  5155 1620s
  4292  2179 -7963.5736   16  195 -8639.5379   76.76598   101%  5192 1663s
  4449  2272 infeasible   19      -8639.5379   62.65274   101%  5259 1704s
  4676  2326 -7343.2279   17  590 -8639.5379   -4.23412   100%  5281 1749s
  4840  2421 -7554.5920   19  495 -8639.5379  -91.00219  98.9%  5295 1798s
  5054  2422 -258.20224    9  469 -8639.5379 -129.47758  98.5%  5296 1918s
  5056  2423 -5833.5370   22  135 -8639.5379 -129.47758  98.5%  5294 1933s
  5057  2424 -2234.8079   24  409 -8639.5379 -129.47758  98.5%  5293 1993s
  5058  2425 -5606.5282   16  462 -8639.5379 -129.47758  98.5%  5292 2025s
  5059  2425 -338.64597   10  482 -8639.5379 -129.47758  98.5%  5291 2050s
  5060  2426 -2680.2762   14  538 -8639.5379 -129.47758  98.5%  5290 2065s
  5061  2427 -8437.0126   14  490 -8639.5379 -129.47758  98.5%  5289 2075s
  5062  2427 -7410.1062   34  493 -8639.5379 -129.47758  98.5%  5288 2082s
  5063  2428 -7745.4426   13  493 -8639.5379 -129.47758  98.5%  5287 2092s
  5064  2429 -258.62135   12  513 -8639.5379 -129.47758  98.5%  5286 2098s
  5065  2429 -310.22219   11  589 -8639.5379 -129.47758  98.5%  5285 2103s
  5066  2430 -1604.0460   18  527 -8639.5379 -129.47758  98.5%  5284 2109s
  5067  2431 -6926.7268   22  520 -8639.5379 -129.47758  98.5%  5283 2112s
  5069  2432 -8396.1178   20  540 -8639.5379 -129.47758  98.5%  5281 2117s
  5070  2433 -1141.8952   12  537 -8639.5379 -129.47758  98.5%  5280 2124s
  5071  2433 -6942.6968   16  546 -8639.5379 -129.47758  98.5%  5279 2130s
  5073  2435 -5215.3985   27  536 -8639.5379 -129.47758  98.5%  5276 2137s
  5074  2435 -3872.4595    7  595 -8639.5379 -129.47758  98.5%  5275 2162s
  5075  2436 -1245.7594   10  543 -8639.5379 -129.47758  98.5%  5274 2176s
  5076  2437 -7707.7637   28  522 -8639.5379 -129.47758  98.5%  5273 2186s
  5077  2437 -1933.6717   10  625 -8639.5379 -129.47758  98.5%  5272 2190s
  5078  2438 -2516.0024   14  616 -8639.5379 -129.47758  98.5%  5271 2197s
  5079  2439 -8221.9105   29  628 -8639.5379 -129.47758  98.5%  5270 2208s
  5080  2439 -3101.0429   14  617 -8639.5379 -129.47758  98.5%  5269 2210s
  5081  2440 -5700.3932   19  560 -8639.5379 -129.47758  98.5%  5268 2215s
  5082  2441 -6388.6615   32  464 -8639.5379 -129.47758  98.5%  5267 2224s
  5083  2441 -7726.6172   12  475 -8639.5379 -129.47758  98.5%  5266 2228s
  5084  2442 -6644.6153   22  464 -8639.5379 -129.47758  98.5%  5265 2232s
  5085  2443 -3910.8199    8  548 -8639.5379 -129.47758  98.5%  5264 2242s
  5086  2443 -619.15941   17  558 -8639.5379 -129.47758  98.5%  5263 2248s
  5087  2444 -5365.4942   16  549 -8639.5379 -129.47758  98.5%  5262 2264s
  5088  2445 -5373.2561   22  554 -8639.5379 -129.47758  98.5%  5261 2268s
  5089  2445 -6917.8093   18  556 -8639.5379 -129.47758  98.5%  5260 2279s
  5090  2446 -5321.9333   16  627 -8639.5379 -129.47758  98.5%  5259 2285s
  5091  2447 -3676.9298   17  555 -8639.5379 -129.47758  98.5%  5258 2298s
  5092  2447 -5145.7976    9  637 -8639.5379 -129.47758  98.5%  5257 2304s
  5093  2448 -2925.7864   11  561 -8639.5379 -129.47758  98.5%  5256 2316s
  5094  2449 -255.91698   15  633 -8639.5379 -129.47758  98.5%  5255 2323s
  5095  2449 -5888.7147   30  630 -8639.5379 -129.47758  98.5%  5254 2332s
  5096  2450 -3711.9509    9  630 -8639.5379 -129.47758  98.5%  5253 2384s
  5097  2451 -5648.8992   27  630 -8639.5379 -129.47758  98.5%  5252 2441s
  5098  2454 -129.47758   10  623 -8639.5379 -129.47758  98.5%  5302 2540s
  5100  2458 -129.47758   11  551 -8639.5379 -129.47758  98.5%  5303 2577s
  5104  2464 -129.47758   12  720 -8639.5379 -129.47758  98.5%  5306 2610s
  5112  2478 -129.47758   13  726 -8639.5379 -129.47758  98.5%  5312 2642s
  5128  2488 -129.47758   14  445 -8639.5379 -129.47758  98.5%  5345 2716s
  5144  2505 -129.47758   15  482 -8639.5379 -129.47758  98.5%  5378 2763s
  5176  2581 -598.46164   16  445 -8639.5379 -129.47758  98.5%  5403 2818s
  5299  2553 -3050.6082   20  348 -8639.5379 -129.47758  98.5%  5395 2859s
  5344  2557 -7074.6154   19  167 -8639.5379 -129.47758  98.5%  5409 2885s
  5399  2544 -3376.6293   21  372 -8639.5379 -129.47758  98.5%  5423 2919s
  5445  2561 -3776.9818   23  383 -8639.5379 -129.47758  98.5%  5436 2943s
  5495  2574 -3796.2946   24  432 -8639.5379 -129.47758  98.5%  5455 2980s
  5546  2589 -3994.0087   25  296 -8639.5379 -129.47758  98.5%  5458 3018s
  5604  2585 -7426.0961   26   76 -8639.5379 -129.47758  98.5%  5474 3052s
  5665  2586 -7722.2423   24  439 -8639.5379 -129.47758  98.5%  5486 3084s
  5726  2591 infeasible   25      -8639.5379 -129.47758  98.5%  5497 3120s
  5789  2598 -3768.2417   26  254 -8639.5379 -129.47758  98.5%  5498 3156s
  5846  2612 -4083.7840   27  350 -8639.5379 -129.47758  98.5%  5515 3179s
  5906  2619 -4185.0326   28  256 -8639.5379 -129.47758  98.5%  5519 3203s
  5957  2636 -4503.8379   30  248 -8639.5379 -129.47758  98.5%  5517 3224s
H 5969  2508                    -8567.740884 -129.47758  98.5%  5518 3224s
  6012  2512     cutoff   32      -8567.7409 -129.47758  98.5%  5510 3245s
  6064  2512 -4636.5615   33  315 -8567.7409 -129.47758  98.5%  5503 3274s
  6133  2496 -5296.2067   36  316 -8567.7409 -129.47758  98.5%  5502 3313s
  6191  2473 infeasible   36      -8567.7409 -129.47758  98.5%  5500 3338s
  6239  2479 -5124.5503   35  410 -8567.7409 -129.47758  98.5%  5497 3368s
  6292  2480 -5297.3928   37  312 -8567.7409 -129.47758  98.5%  5508 3394s
  6332  2484 -5335.4545   38  260 -8567.7409 -129.47758  98.5%  5522 3419s
  6389  2475 -5913.6708   39  228 -8567.7409 -129.47758  98.5%  5533 3445s
  6454  2467 -6458.0273   41  225 -8567.7409 -129.47758  98.5%  5532 3482s
  6518  2460 infeasible   44      -8567.7409 -129.47758  98.5%  5537 3514s
  6559  2473 -7580.4027   44  296 -8567.7409 -129.47758  98.5%  5556 3545s
  6611  2467 -7985.4386   45  337 -8567.7409 -129.47758  98.5%  5571 3575s
  6661  2460 -8056.7305   46  264 -8567.7409 -129.47758  98.5%  5589 3600s

Cutting planes:
  Learned: 1
  MIR: 548
  Mixing: 1
  Flow cover: 2217
  RLT: 21
  Relax-and-lift: 140

Explored 6714 nodes (37853279 simplex iterations) in 3600.09 seconds (6299.22 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -8567.74 -8567.74 -8639.54 ... -8992.47

Time limit reached
Best objective -8.567740884140e+03, best bound -1.294775844621e+02, gap 98.4888%
  WARNING: Time limit reached. Using best solution found (gap: 98.49%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = -8567.74, θ = 118863.01
  Upper Bound (UB) = -8567.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118863.01
  [DEBUG]   ✓ Scenario 0: θ = 118863.01 ≤ Q = 118863.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118863.01 ≤ Q = 118863.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118863.01 ≤ Q = 118863.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118863.01 ≤ Q = 118863.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118863.01 ≤ Q = 118863.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118863.01 ≤ Q = 118863.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118863.01 ≤ Q = 118863.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118863.01 ≤ Q = 118863.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118863.01 ≤ Q = 118863.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 118863.01 ≤ Q = 118863.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x144ed126
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xebb12eda
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-14, 2e+02]
Found heuristic solution: objective 1.366452e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6759232.2688
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.296771e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129677.06    0  122 6759232.27 -129677.06   102%     -    0s
H    0     0                    -94870.15934 -129677.06  36.7%     -    0s
H    0     0                    -95133.41190 -129677.06  36.3%     -    0s
     0     0 -99967.743    0   37 -95133.412 -99967.743  5.08%     -    0s
H    0     0                    -98333.07932 -99876.754  1.57%     -    0s
     0     0 -99595.144    0   38 -98333.079 -99595.144  1.28%     -    0s
H    0     0                    -99155.72066 -99563.887  0.41%     -    0s
     0     0 -99496.494    0   35 -99155.721 -99496.494  0.34%     -    0s
     0     0 -99489.999    0   35 -99155.721 -99489.999  0.34%     -    0s
     0     0 -99489.999    0   65 -99155.721 -99489.999  0.34%     -    0s
     0     0 -99489.999    0   41 -99155.721 -99489.999  0.34%     -    0s
     0     0 -99444.350    0   37 -99155.721 -99444.350  0.29%     -    0s
H    0     0                    -99173.81195 -99444.350  0.27%     -    0s
     0     0 -99368.522    0   38 -99173.812 -99368.522  0.20%     -    0s
     0     0 -99358.878    0   37 -99173.812 -99358.878  0.19%     -    0s
     0     0 -99358.642    0   37 -99173.812 -99358.642  0.19%     -    0s
     0     0 -99352.898    0   37 -99173.812 -99352.898  0.18%     -    0s
     0     0 -99352.898    0   40 -99173.812 -99352.898  0.18%     -    0s
     0     0 -99352.898    0   44 -99173.812 -99352.898  0.18%     -    0s
     0     0 -99342.275    0   36 -99173.812 -99342.275  0.17%     -    0s
     0     0 -99326.987    0   36 -99173.812 -99326.987  0.15%     -    0s
     0     0 -99324.686    0   36 -99173.812 -99324.686  0.15%     -    0s
     0     0 -99304.776    0   37 -99173.812 -99304.776  0.13%     -    0s
     0     0 -99299.226    0   37 -99173.812 -99299.226  0.13%     -    0s
     0     0 -99299.226    0   37 -99173.812 -99299.226  0.13%     -    0s
H    0     0                    -99196.66841 -99299.226  0.10%     -    0s
     0     0 -99295.316    0   37 -99196.668 -99295.316  0.10%     -    0s
     0     2 -99295.312    0   37 -99196.668 -99295.312  0.10%     -    0s

Cutting planes:
  Gomory: 17
  Implied bound: 4
  MIR: 56
  Flow cover: 4

Explored 18 nodes (1154 simplex iterations) in 0.49 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -99196.7 -99173.8 -99155.7 ... 1.36645e+13
No other solutions better than -99196.7

Optimal solution found (tolerance 1.00e-06)
Best objective -9.919666841317e+04, best bound -9.919666841317e+04, gap 0.0000%
  Subproblem solved in 0.52s
  Worst-case operational profit (Z_SP) = 118682.64
  Scenario: 11 demand increases, 49 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99196.67
  [DEBUG]   S×d_nominal = 217879.31
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 217879.31 + -99196.67 = 118682.64
  [DEBUG]   Current θ from Master = 118863.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 180.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8748.11
  Lower Bound (LB) = -8748.11
  Gap (UB-LB) = 180.3725, Absolute Gap = 180.3725, Relative Gap = 0.021053
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 10
Total Time: 18494.58s
Converged: True
Final Lower Bound: -8748.1134
Final Upper Bound: -8567.7409
Final Gap: 180.372490
Number of Critical Scenarios: 10
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 4, 5] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 2 customers  Mode 1: 11 customers  Mode 2: 37 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 10
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-03 14:53:39
Total Time: 18494.58s
Optimal Value: -8748.11
Lower Bound: -8748.11
Upper Bound: -8567.74
Gap: 180.372490
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [3, 4, 5] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed15_LD_gamma20_20260103_145339.csv

Total Execution Time: 18495.87 seconds
End Time: 2026-01-03 14:53:40

All tasks completed successfully!

