
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 14
DI Scenario: HD
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed14.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.352', '1.828'] (k=0.744)
  Product 1: ['1.000', '1.441', '2.076'] (k=0.901)
  Product 2: ['1.000', '1.370', '1.878'] (k=0.777)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1032, max=1646
  DC capacity (MC): min=410, max=893

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=9.47, max=34.92, count=80
  Deviation (μ̂): min=4.04, max=9.84

Costs:
  Plant fixed cost: min=5479, max=9697
  DC fixed cost: min=3301, max=5734
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.352', '1.828'] (k=0.744)
    Product 1: ['1.000', '1.441', '2.076'] (k=0.901)
    Product 2: ['1.000', '1.370', '1.878'] (k=0.777)
  MD:
    Product 0: ['1.000', '1.159', '1.343'] (k=0.364)
    Product 1: ['1.000', '1.262', '1.592'] (k=0.574)
    Product 2: ['1.000', '1.299', '1.687'] (k=0.645)
  LD:
    Product 0: ['1.000', '1.107', '1.226'] (k=0.251)
    Product 1: ['1.000', '1.121', '1.257'] (k=0.282)
    Product 2: ['1.000', '1.114', '1.241'] (k=0.266)
  Mixed:
    Product 0: ['1.000', '1.352', '1.828'] (k=0.744)
    Product 1: ['1.000', '1.262', '1.592'] (k=0.574)
    Product 2: ['1.000', '1.114', '1.241'] (k=0.266)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0xd037e13b
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.13s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309798.5813
Found heuristic solution: objective -191190.9899

Root relaxation: objective 1.524406e+05, 4835 iterations, 0.32 seconds (0.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 152440.600    0  565 -191190.99 152440.600   180%     -    0s
H    0     0                    -185870.2214 152440.600   182%     -    0s
     0     0 126999.383    0  891 -185870.22 126999.383   168%     -    1s
     0     0 126962.006    0  897 -185870.22 126962.006   168%     -    2s
     0     0 126961.691    0  895 -185870.22 126961.691   168%     -    2s
     0     0 113851.979    0  694 -185870.22 113851.979   161%     -    3s
H    0     0                    -126160.3088 113850.442   190%     -    3s
     0     0 113525.672    0  676 -126160.31 113525.672   190%     -    3s
     0     0 113501.536    0  682 -126160.31 113501.536   190%     -    3s
     0     0 113497.445    0  681 -126160.31 113497.445   190%     -    3s
     0     0 101909.795    0  511 -126160.31 101909.795   181%     -    5s
H    0     0                    -125408.6818 101872.965   181%     -    5s
     0     0 101211.154    0  494 -125408.68 101211.154   181%     -    5s
H    0     0                    -125160.2243 100933.257   181%     -    5s
H    0     0                    -123634.9390 100933.257   182%     -    5s
     0     0 100933.257    0  536 -123634.94 100933.257   182%     -    5s
H    0     0                    57591.622979 100906.659  75.2%     -    6s
     0     0 100906.659    0  547 57591.6230 100906.659  75.2%     -    6s
     0     0 100903.853    0  539 57591.6230 100903.853  75.2%     -    6s
H    0     0                    57617.650514 96190.7983  66.9%     -    7s
H    0     0                    57680.858619 96190.7983  66.8%     -    7s
H    0     0                    57713.326671 96190.7983  66.7%     -    7s
     0     0 96190.7983    0  643 57713.3267 96190.7983  66.7%     -    7s
     0     0 95446.8623    0  635 57713.3267 95446.8623  65.4%     -    8s
     0     0 95287.3213    0  676 57713.3267 95287.3213  65.1%     -    8s
     0     0 95192.0686    0  666 57713.3267 95192.0686  64.9%     -    8s
     0     0 95180.2178    0  697 57713.3267 95180.2178  64.9%     -    8s
H    0     0                    57758.329393 92937.2234  60.9%     -    9s
H    0     0                    57778.275529 92937.2234  60.9%     -    9s
H    0     0                    57800.376579 92937.2234  60.8%     -    9s
H    0     0                    57841.901327 92937.2234  60.7%     -    9s
     0     0 92937.2234    0  639 57841.9013 92937.2234  60.7%     -    9s
H    0     0                    58758.665090 92462.0501  57.4%     -    9s
H    0     0                    59491.793870 92462.0501  55.4%     -    9s
H    0     0                    59699.103728 92462.0501  54.9%     -    9s
H    0     0                    59980.396207 92462.0501  54.2%     -    9s
H    0     0                    60285.957814 92462.0501  53.4%     -    9s
H    0     0                    60930.195620 92462.0501  51.8%     -    9s
H    0     0                    61067.044632 92462.0501  51.4%     -    9s
H    0     0                    61476.899219 92462.0501  50.4%     -    9s
H    0     0                    61514.630352 92462.0501  50.3%     -    9s
H    0     0                    61532.485568 92462.0501  50.3%     -    9s
H    0     0                    61715.416435 92462.0501  49.8%     -    9s
     0     0 92462.0501    0  737 61715.4164 92462.0501  49.8%     -    9s
H    0     0                    61775.496785 92356.2161  49.5%     -   10s
H    0     0                    62334.717397 92356.2161  48.2%     -   10s
H    0     0                    62363.164232 92356.2161  48.1%     -   10s
H    0     0                    62415.522443 92356.2161  48.0%     -   10s
     0     0 92356.2161    0  722 62415.5224 92356.2161  48.0%     -   10s
     0     0 92340.0822    0  749 62415.5224 92340.0822  47.9%     -   10s
H    0     0                    62473.756073 90808.7369  45.4%     -   11s
H    0     0                    62574.468498 90808.7369  45.1%     -   11s
H    0     0                    62610.355200 90808.7369  45.0%     -   11s
     0     0 90808.7369    0  669 62610.3552 90808.7369  45.0%     -   11s
     0     0 90529.9296    0  728 62610.3552 90529.9296  44.6%     -   11s
H    0     0                    62757.726994 90452.3945  44.1%     -   11s
     0     0 90452.3945    0  673 62757.7270 90452.3945  44.1%     -   11s
H    0     0                    62838.450164 90398.3827  43.9%     -   11s
     0     0 90398.3827    0  780 62838.4502 90398.3827  43.9%     -   11s
     0     0 90387.4427    0  774 62838.4502 90387.4427  43.8%     -   11s
H    0     0                    62935.333104 89303.4394  41.9%     -   12s
H    0     0                    63190.722455 89303.4394  41.3%     -   12s
     0     0 89303.4394    0  703 63190.7225 89303.4394  41.3%     -   12s
     0     0 89027.3783    0  761 63190.7225 89027.3783  40.9%     -   13s
     0     0 88950.2193    0  758 63190.7225 88950.2193  40.8%     -   13s
     0     0 88931.8098    0  760 63190.7225 88931.8098  40.7%     -   13s
     0     0 88095.8175    0  745 63190.7225 88095.8175  39.4%     -   14s
H    0     0                    63661.559608 87917.9643  38.1%     -   15s
H    0     0                    63755.773966 87917.9643  37.9%     -   15s
H    0     0                    64045.016321 87917.9643  37.3%     -   15s
     0     0 87917.9643    0  803 64045.0163 87917.9643  37.3%     -   15s
     0     0 87883.8925    0  830 64045.0163 87883.8925  37.2%     -   15s
     0     0 87310.7028    0  737 64045.0163 87310.7028  36.3%     -   16s
     0     0 87190.9469    0  763 64045.0163 87190.9469  36.1%     -   17s
     0     0 87165.7863    0  754 64045.0163 87165.7863  36.1%     -   17s
H    0     0                    64059.662592 86784.5083  35.5%     -   18s
     0     0 86784.5083    0  746 64059.6626 86784.5083  35.5%     -   18s
     0     0 86669.8185    0  818 64059.6626 86669.8185  35.3%     -   18s
     0     0 86593.8200    0  841 64059.6626 86593.8200  35.2%     -   18s
     0     0 86574.0277    0  839 64059.6626 86574.0277  35.1%     -   19s
H    0     0                    64215.665969 86282.4729  34.4%     -   19s
H    0     0                    64328.500441 86282.4729  34.1%     -   19s
H    0     0                    64528.710259 86282.4729  33.7%     -   19s
H    0     0                    64532.344987 86282.4729  33.7%     -   19s
H    0     0                    64552.028838 86282.4729  33.7%     -   19s
     0     0 86282.4729    0  728 64552.0288 86282.4729  33.7%     -   19s
     0     0 86282.4078    0  728 64552.0288 86282.4078  33.7%     -   20s
     0     2 86281.8391    0  728 64552.0288 86281.8391  33.7%     -   21s
    31    64 82815.3550    5  625 64552.0288 84904.7595  31.5%  1804   25s
H   95   167                    66145.026450 84896.7282  28.3%  1355   27s
H   97   167                    66578.346950 84896.7282  27.5%  1340   27s
H  269   349                    66803.236624 84896.7282  27.1%   877   29s
H  275   349                    66806.904729 84896.7282  27.1%   867   29s
H  285   349                    66818.570264 84896.7282  27.1%   856   29s
   348   444 81661.9515   10  374 66818.5703 84896.7282  27.1%   784   30s
H  451   510                    66864.541399 84896.7282  27.0%   695   31s
H  770   769                    66944.430993 84896.7282  26.8%   586   34s
   782   856 78876.2525   16  444 66944.4310 84896.7282  26.8%   584   35s
H 1031  1068                    66951.515843 84896.7282  26.8%   549   38s
  1199  1274 78236.3929   19  424 66951.5158 84896.7282  26.8%   532   40s
  1781  1771 75912.0244   28  251 66951.5158 84741.6547  26.6%   461   45s
  2219  2057 72298.3523   44  145 66951.5158 84741.6547  26.6%   434   50s
H 2308  2119                    67124.973717 84741.6547  26.2%   433   50s
  3087  2734 79517.6154   11  382 67124.9737 84033.5168  25.2%   385   56s
H 3088  2729                    67351.410496 84033.5168  24.8%   385   56s
H 3107  2729                    67356.316464 84033.5168  24.8%   386   56s
  3363  2910 78480.2482   20  728 67356.3165 84033.5168  24.8%   387   66s
  3388  2927 80947.6639    6  361 67356.3165 80947.6639  20.2%   384   70s
  3403  2942 79738.7869   13  340 67356.3165 80436.3032  19.4%   386   75s
  3854  2983 68053.1202   23  280 67356.3165 75773.7110  12.5%   383   80s
H 3990  2836                    67811.636765 74956.3027  10.5%   377   81s
H 4145  2654                    67876.726540 74560.0060  9.85%   370   82s
H 4430  2473                    67954.519085 73922.8984  8.78%   359   83s
H 4476  2332                    68246.448243 73786.5064  8.12%   357   83s
  4829  2243 69283.0832   25  165 68246.4482 73389.0456  7.54%   341   85s
H 5008  2076                    68246.572041 73389.0456  7.54%   333   85s
H 5031  1954                    68257.845403 73389.0456  7.52%   332   85s

Cutting planes:
  Gomory: 4
  Lift-and-project: 1
  Implied bound: 1
  Projected implied bound: 26
  MIR: 219
  Flow cover: 373
  RLT: 16
  Relax-and-lift: 50

Explored 10249 nodes (1933734 simplex iterations) in 88.68 seconds (118.71 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 68257.8 68246.6 67954.5 ... 66818.6

Optimal solution found (tolerance 1.00e-06)
Best objective 6.825784540271e+04, best bound 6.825784540271e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 88.69s
  Master Objective (UB) = 68257.85, θ = 231819.25
  Upper Bound (UB) = 68257.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 231819.25
  [DEBUG]   ✓ Scenario 0: θ = 231819.25 ≤ Q = 231819.25 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x41ba65df
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x41ba65df
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.358137e+13
Presolve removed 2598 rows and 1889 columns
Presolve time: 0.01s
Presolved: 495 rows, 500 columns, 1396 nonzeros
Found heuristic solution: objective 6209709.2908
Variable types: 340 continuous, 160 integer (160 binary)

Root relaxation: objective -1.897571e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -189757.11    0  125 6209709.29 -189757.11   103%     -    0s
H    0     0                    -155849.8916 -189757.11  21.8%     -    0s
H    0     0                    -156957.9943 -189757.11  20.9%     -    0s
H    0     0                    -158582.0846 -158582.08  0.00%     -    0s
     0     0          -    0      -158582.08 -158582.08  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (374 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -158582 -156958 -155850 ... 1.35814e+13
No other solutions better than -158582

Optimal solution found (tolerance 1.00e-06)
Best objective -1.585820846294e+05, best bound -1.585820846294e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 202022.63
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -158582.08
  [DEBUG]   S×d_nominal = 360604.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 360604.72 + -158582.08 = 202022.63
  [DEBUG]   Current θ from Master = 231819.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 29796.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38461.23
  Lower Bound (LB) = 38461.23
  Gap (UB-LB) = 29796.6131, Absolute Gap = 29796.6131, Relative Gap = 0.436530
  Not converged yet (gap = 29796.61 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x7a6f8b5f
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 38461.2 (0.02s)
MIP start from previous solve produced solution with objective 38461.2 (0.02s)
Loaded MIP start from previous solve with objective 38461.2

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.49s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 8.551688e+04, 8708 iterations, 1.22 seconds (1.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 85516.8764    0  237 38461.2323 85516.8764   122%     -    1s
H    0     0                    41078.990437 85516.8764   108%     -    2s
H    0     0                    41455.202001 85516.8764   106%     -    2s
H    0     0                    42021.969286 85516.8764   104%     -    2s
H    0     0                    42097.255971 85516.8764   103%     -    2s
H    0     0                    42893.958626 85516.8764  99.4%     -    2s
H    0     0                    43043.552876 85516.8764  98.7%     -    2s
     0     0 78345.8142    0  289 43043.5529 78345.8142  82.0%     -    3s
H    0     0                    43333.511518 78323.7166  80.7%     -    3s
     0     0 78237.1646    0  294 43333.5115 78237.1646  80.5%     -    4s
     0     0 78225.8033    0  301 43333.5115 78225.8033  80.5%     -    4s
     0     0 78223.9083    0  301 43333.5115 78223.9083  80.5%     -    4s
     0     0 78223.6958    0  301 43333.5115 78223.6958  80.5%     -    4s
     0     0 71982.4431    0  303 43333.5115 71982.4431  66.1%     -    6s
     0     0 71152.5924    0  345 43333.5115 71152.5924  64.2%     -    6s
     0     0 70851.9827    0  338 43333.5115 70851.9827  63.5%     -    6s
     0     0 70841.4589    0  341 43333.5115 70841.4589  63.5%     -    7s
     0     0 70840.8637    0  341 43333.5115 70840.8637  63.5%     -    7s
     0     0 67335.3387    0  341 43333.5115 67335.3387  55.4%     -    9s
     0     0 66951.3598    0  355 43333.5115 66951.3598  54.5%     -    9s
     0     0 66893.1888    0  361 43333.5115 66893.1888  54.4%     -    9s
     0     0 66886.1053    0  351 43333.5115 66886.1053  54.4%     -    9s
     0     0 66878.8778    0  356 43333.5115 66878.8778  54.3%     -    9s
     0     0 66873.4640    0  367 43333.5115 66873.4640  54.3%     -   10s
     0     0 66872.7548    0  369 43333.5115 66872.7548  54.3%     -   10s
H    0     0                    43477.062841 66872.7548  53.8%     -   11s
     0     0 63660.2414    0  415 43477.0628 63660.2414  46.4%     -   13s
H    0     0                    43523.451941 63658.1921  46.3%     -   13s
     0     0 63151.7395    0  431 43523.4519 63151.7395  45.1%     -   13s
     0     0 62990.0355    0  418 43523.4519 62990.0355  44.7%     -   14s
     0     0 62936.0234    0  417 43523.4519 62936.0234  44.6%     -   14s
     0     0 62900.7550    0  424 43523.4519 62900.7550  44.5%     -   14s
     0     0 62898.5826    0  431 43523.4519 62898.5826  44.5%     -   14s
     0     0 61894.5285    0  383 43523.4519 61894.5285  42.2%     -   16s
H    0     0                    43592.515943 61894.1491  42.0%     -   16s
H    0     0                    43747.968592 61535.5853  40.7%     -   18s
     0     0 61535.5853    0  495 43747.9686 61535.5853  40.7%     -   18s
     0     0 61394.6672    0  563 43747.9686 61394.6672  40.3%     -   18s
     0     0 61351.8991    0  607 43747.9686 61351.8991  40.2%     -   19s
     0     0 61299.2893    0  588 43747.9686 61299.2893  40.1%     -   19s
     0     0 61282.8641    0  598 43747.9686 61282.8641  40.1%     -   19s
     0     0 61275.8513    0  457 43747.9686 61275.8513  40.1%     -   19s
     0     0 61274.8403    0  459 43747.9686 61274.8403  40.1%     -   19s
     0     0 60780.2013    0  498 43747.9686 60780.2013  38.9%     -   21s
     0     0 60657.2051    0  489 43747.9686 60657.2051  38.7%     -   22s
     0     0 60616.6860    0  502 43747.9686 60616.6860  38.6%     -   22s
     0     0 60604.4553    0  505 43747.9686 60604.4553  38.5%     -   22s
     0     0 60600.0597    0  503 43747.9686 60600.0597  38.5%     -   22s
     0     0 60210.3542    0  427 43747.9686 60210.3542  37.6%     -   24s
     0     0 60123.0753    0  439 43747.9686 60123.0753  37.4%     -   24s
     0     0 60098.2957    0  431 43747.9686 60098.2957  37.4%     -   24s
     0     0 60091.4395    0  435 43747.9686 60091.4395  37.4%     -   25s
     0     0 59867.1965    0  375 43747.9686 59867.1965  36.8%     -   26s
     0     0 59846.3627    0  411 43747.9686 59846.3627  36.8%     -   26s
     0     0 59838.2532    0  396 43747.9686 59838.2532  36.8%     -   27s
     0     0 59833.4599    0  484 43747.9686 59833.4599  36.8%     -   27s
     0     0 59732.9146    0  334 43747.9686 59732.9146  36.5%     -   28s
     0     0 59698.1634    0  336 43747.9686 59698.1634  36.5%     -   28s
     0     0 59692.2251    0  331 43747.9686 59692.2251  36.4%     -   28s
     0     0 59612.5693    0  328 43747.9686 59612.5693  36.3%     -   29s
     0     0 59586.4041    0  328 43747.9686 59586.4041  36.2%     -   30s
     0     0 59565.3535    0  333 43747.9686 59565.3535  36.2%     -   30s
     0     0 59563.3295    0  333 43747.9686 59563.3295  36.2%     -   30s
     0     0 59505.2293    0  397 43747.9686 59505.2293  36.0%     -   31s
     0     0 59490.4685    0  358 43747.9686 59490.4685  36.0%     -   31s
     0     0 59487.9848    0  355 43747.9686 59487.9848  36.0%     -   32s
     0     0 59480.8545    0  394 43747.9686 59480.8545  36.0%     -   32s
     0     0 59477.3620    0  343 43747.9686 59477.3620  36.0%     -   32s
     0     0 59474.3256    0  340 43747.9686 59474.3256  35.9%     -   33s
     0     0 59473.3808    0  399 43747.9686 59473.3808  35.9%     -   33s
     0     0 59473.0622    0  412 43747.9686 59473.0622  35.9%     -   33s
     0     0 59472.8147    0  412 43747.9686 59472.8147  35.9%     -   34s
     0     2 59472.7386    0  412 43747.9686 59472.7386  35.9%     -   41s
    15    32 57857.2047    4  327 43747.9686 58155.3641  32.9%  1130   45s
   134   173 56922.9328    8  343 43747.9686 57609.1125  31.7%   733   50s
H  161   173                    43929.178298 57609.1125  31.1%   672   50s
H  173   241                    43956.969815 57609.1125  31.1%   658   51s
   428   499 56493.6637   10  376 43956.9698 57609.1125  31.1%   477   55s
   713   716 55963.9945   12  369 43956.9698 57609.1125  31.1%   456   60s
   891   850 54127.6234   14  289 43956.9698 57465.7097  30.7%   491   65s
   996   966 53705.2638   15  280 43956.9698 57465.7097  30.7%   498   70s
  1310  1258 51443.7094   20  290 43956.9698 57435.8084  30.7%   464   75s
  1613  1498 50692.3830   25  269 43956.9698 57435.8084  30.7%   435   80s
  2040  1777 48688.0516   32  278 43956.9698 57270.2203  30.3%   412   86s
  2391  1997 45688.5383   42  241 43956.9698 56971.1283  29.6%   392   90s
  2839  2361 45527.5353   14  355 43956.9698 56971.1283  29.6%   391   95s
  3166  2491 54434.3344   12  297 43956.9698 56733.9342  29.1%   386  100s
  3622  2889 49126.8719   23  280 43956.9698 56652.2542  28.9%   382  105s
  3836  2890 48468.8823   24  412 43956.9698 56652.2542  28.9%   377  121s
  3839  2892 47172.2727   35  300 43956.9698 56652.2542  28.9%   377  126s
  3844  2895 54198.2909   12  326 43956.9698 56652.2542  28.9%   376  130s
  3854  2902 45728.5484   39  337 43956.9698 56652.2542  28.9%   375  135s
  3861  2907 52700.1410   13  337 43956.9698 56652.2542  28.9%   375  140s
  3866  2910 54829.1796    6  380 43956.9698 56652.2542  28.9%   374  146s
  3868  2914 56652.2542   12  366 43956.9698 56652.2542  28.9%   381  150s
  3898  2964 54142.2195   16  266 43956.9698 56652.2542  28.9%   387  156s
  4023  3070 52815.1924   19  277 43956.9698 56652.2542  28.9%   399  161s
  4253  3121 50654.0172   22  213 43956.9698 56652.2542  28.9%   407  165s
  4537  3139 45499.1958   27  151 43956.9698 55210.4053  25.6%   412  170s
  4746  3142     cutoff   28      43956.9698 55096.6443  25.3%   413  175s
  4977  3124 47941.9322   24  207 43956.9698 54638.9139  24.3%   412  180s
  5351  3096 46668.1536   24  304 43956.9698 53803.8535  22.4%   416  186s
  5665  3095 47385.5925   20  218 43956.9698 53411.9660  21.5%   420  190s
  6021  3048 47200.3360   24  200 43956.9698 52736.9937  20.0%   421  196s
  6343  2970 45481.1235   25  212 43956.9698 52688.5978  19.9%   422  200s
  6867  2867 45686.8474   28  234 43956.9698 51919.2483  18.1%   427  206s
  7340  2670     cutoff   27      43956.9698 51005.3896  16.0%   427  210s
  7862  2480 46374.1391   20  256 43956.9698 50254.3843  14.3%   428  215s
  8123  2343 44328.6813   24  243 43956.9698 49849.4731  13.4%   431  220s
  8685  2035 45673.2453   26  218 43956.9698 49429.5729  12.4%   429  225s
  9381  1599 45653.4593   18  285 43956.9698 48379.9258  10.1%   427  230s
H10771   462                    44103.893645 44801.5951  1.58%   406  234s

Cutting planes:
  Learned: 1
  Lift-and-project: 1
  MIR: 183
  Flow cover: 376
  RLT: 6
  Relax-and-lift: 21

Explored 10873 nodes (4416519 simplex iterations) in 234.59 seconds (378.30 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 44103.9 43957 43929.2 ... 42894

Optimal solution found (tolerance 1.00e-06)
Best objective 4.410389364529e+04, best bound 4.410389364529e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 234.59s
  Master Objective (UB) = 44103.89, θ = 206904.69
  Upper Bound (UB) = 44103.89

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206904.69
  [DEBUG]   ✓ Scenario 0: θ = 206904.69 ≤ Q = 206904.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206904.69 ≤ Q = 206904.69 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xfe8c776
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0fe8c776
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.365440e+13
Presolve removed 2599 rows and 1899 columns
Presolve time: 0.01s
Presolved: 494 rows, 490 columns, 1384 nonzeros
Found heuristic solution: objective 5762428.3349
Variable types: 330 continuous, 160 integer (160 binary)

Root relaxation: objective -1.994762e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -199476.22    0  129 5762428.33 -199476.22   103%     -    0s
H    0     0                    -162354.2605 -199476.22  22.9%     -    0s
H    0     0                    -168497.7023 -199476.22  18.4%     -    0s
H    0     0                    -174771.6475 -199476.22  14.1%     -    0s
H    0     0                    -175831.4519 -199476.22  13.4%     -    0s
H    0     0                    -179115.9380 -199476.22  11.4%     -    0s
     0     0 -187628.56    0   77 -179115.94 -187628.56  4.75%     -    0s
H    0     0                    -183851.9688 -187543.88  2.01%     -    0s
H    0     0                    -184143.6792 -187543.88  1.85%     -    0s
     0     0 -185683.36    0   71 -184143.68 -185683.36  0.84%     -    0s
     0     0 -185662.78    0   71 -184143.68 -185662.78  0.82%     -    0s
     0     0 -185654.29    0   70 -184143.68 -185654.29  0.82%     -    0s
     0     0 -185460.82    0   20 -184143.68 -185460.82  0.72%     -    0s
H    0     0                    -184834.8388 -185459.25  0.34%     -    0s
H    0     0                    -184843.7020 -185459.25  0.33%     -    0s
H    0     0                    -184929.8977 -185268.98  0.18%     -    0s
     0     0 -185256.54    0   14 -184929.90 -185256.54  0.18%     -    0s
     0     0 -185255.81    0   15 -184929.90 -185255.81  0.18%     -    0s
H    0     0                    -184974.0834 -185255.81  0.15%     -    0s
H    0     0                    -185035.1695 -185255.81  0.12%     -    0s
     0     0 -185185.60    0   14 -185035.17 -185185.60  0.08%     -    0s
     0     0 -185185.60    0   20 -185035.17 -185185.60  0.08%     -    0s
     0     0 -185091.50    0    7 -185035.17 -185091.50  0.03%     -    0s
H    0     0                    -185084.5757 -185085.66  0.00%     -    0s
     0     0     cutoff    0      -185084.58 -185084.58  0.00%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 13
  Flow cover: 6
  Relax-and-lift: 1

Explored 1 nodes (742 simplex iterations) in 0.23 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -185085 -185035 -184974 ... -175831
No other solutions better than -185085

Optimal solution found (tolerance 1.00e-06)
Best objective -1.850845756975e+05, best bound -1.850845756975e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 183962.40
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -185084.58
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -185084.58 = 183962.40
  [DEBUG]   Current θ from Master = 206904.69
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22942.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21161.60
  Lower Bound (LB) = 38461.23
  Gap (UB-LB) = 5642.6614, Absolute Gap = 5642.6614, Relative Gap = 0.127940
  Not converged yet (gap = 5642.66 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0x1d484860
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 21161.6 (0.03s)
Loaded MIP start from previous solve with objective 21161.6

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.69s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.13s

Solved with dual simplex

Root relaxation: objective 7.376881e+04, 14893 iterations, 4.15 seconds (5.25 work units)
Total elapsed time = 5.02s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 73768.8082    0   78 21161.6048 73768.8082   249%     -    5s
H    0     0                    22861.325016 73768.8082   223%     -    5s
H    0     0                    35497.798718 73768.8082   108%     -    5s
H    0     0                    41525.827638 73768.8082  77.6%     -    5s
H    0     0                    42124.833129 73768.8082  75.1%     -    5s
H    0     0                    42130.815840 73768.8082  75.1%     -    5s
H    0     0                    42137.862777 73768.8082  75.1%     -    5s
H    0     0                    42520.096447 73768.8082  73.5%     -    5s
     0     0 68315.0777    0  116 42520.0964 68315.0777  60.7%     -    7s
     0     0 67750.6187    0  123 42520.0964 67750.6187  59.3%     -    8s
     0     0 67633.9280    0  129 42520.0964 67633.9280  59.1%     -    8s
     0     0 64332.9607    0  255 42520.0964 64332.9607  51.3%     -   10s
     0     0 63785.3608    0  264 42520.0964 63785.3608  50.0%     -   11s
     0     0 63703.6231    0  258 42520.0964 63703.6231  49.8%     -   11s
     0     0 63674.4569    0  269 42520.0964 63674.4569  49.8%     -   12s
     0     0 63671.3498    0  265 42520.0964 63671.3498  49.7%     -   12s
     0     0 63668.9413    0  265 42520.0964 63668.9413  49.7%     -   12s
     0     0 63668.7992    0  265 42520.0964 63668.7992  49.7%     -   12s
     0     0 62019.6306    0  295 42520.0964 62019.6306  45.9%     -   15s
     0     0 61366.1935    0  267 42520.0964 61366.1935  44.3%     -   16s
     0     0 60942.3704    0  314 42520.0964 60942.3704  43.3%     -   16s
     0     0 60874.0778    0  278 42520.0964 60874.0778  43.2%     -   17s
     0     0 60862.6387    0  286 42520.0964 60862.6387  43.1%     -   17s
     0     0 60855.0515    0  287 42520.0964 60855.0515  43.1%     -   17s
     0     0 60853.9166    0  326 42520.0964 60853.9166  43.1%     -   17s
H    0     0                    42648.188253 59930.8485  40.5%     -   20s
     0     0 59930.8485    0  303 42648.1883 59930.8485  40.5%     -   20s
     0     0 59625.3397    0  354 42648.1883 59625.3397  39.8%     -   21s
     0     0 59496.4192    0  302 42648.1883 59496.4192  39.5%     -   22s
     0     0 59486.8608    0  351 42648.1883 59486.8608  39.5%     -   22s
     0     0 59459.0297    0  303 42648.1883 59459.0297  39.4%     -   22s
     0     0 59449.5297    0  357 42648.1883 59449.5297  39.4%     -   22s
     0     0 59447.3399    0  309 42648.1883 59447.3399  39.4%     -   22s
     0     0 59444.8024    0  358 42648.1883 59444.8024  39.4%     -   23s
     0     0 59444.3387    0  356 42648.1883 59444.3387  39.4%     -   23s
H    0     0                    42766.723474 59151.1290  38.3%     -   24s
     0     0 59151.1290    0  367 42766.7235 59151.1290  38.3%     -   24s
     0     0 59102.0703    0  382 42766.7235 59102.0703  38.2%     -   24s
     0     0 59072.9634    0  380 42766.7235 59072.9634  38.1%     -   25s
     0     0 59058.5942    0  373 42766.7235 59058.5942  38.1%     -   25s
     0     0 59054.9895    0  378 42766.7235 59054.9895  38.1%     -   25s
     0     0 59054.2870    0  375 42766.7235 59054.2870  38.1%     -   25s
     0     0 58912.8771    0  329 42766.7235 58912.8771  37.8%     -   26s
H    0     0                    43087.720167 58912.5973  36.7%     -   27s
     0     0 58879.8567    0  340 43087.7202 58879.8567  36.7%     -   27s
     0     0 58867.6610    0  326 43087.7202 58867.6610  36.6%     -   28s
     0     0 58861.6202    0  326 43087.7202 58861.6202  36.6%     -   28s
     0     0 58856.9962    0  325 43087.7202 58856.9962  36.6%     -   28s
     0     0 58855.4244    0  329 43087.7202 58855.4244  36.6%     -   28s
     0     0 58822.3883    0  389 43087.7202 58822.3883  36.5%     -   29s
     0     0 58810.9025    0  345 43087.7202 58810.9025  36.5%     -   29s
     0     0 58809.7389    0  391 43087.7202 58809.7389  36.5%     -   29s
     0     0 58766.6798    0  380 43087.7202 58766.6798  36.4%     -   30s
     0     0 58761.7808    0  327 43087.7202 58761.7808  36.4%     -   30s
     0     0 58759.4942    0  374 43087.7202 58759.4942  36.4%     -   30s
     0     0 58758.1388    0  328 43087.7202 58758.1388  36.4%     -   30s
     0     0 58753.2293    0  380 43087.7202 58753.2293  36.4%     -   31s
     0     0 58751.7249    0  390 43087.7202 58751.7249  36.4%     -   31s
     0     0 58714.6265    0  323 43087.7202 58714.6265  36.3%     -   32s
     0     0 58702.0694    0  384 43087.7202 58702.0694  36.2%     -   32s
     0     0 58696.7485    0  391 43087.7202 58696.7485  36.2%     -   32s
     0     0 58691.0400    0  384 43087.7202 58691.0400  36.2%     -   32s
     0     0 58689.3295    0  386 43087.7202 58689.3295  36.2%     -   33s
     0     0 58683.3977    0  388 43087.7202 58683.3977  36.2%     -   33s
     0     0 58682.9030    0  383 43087.7202 58682.9030  36.2%     -   33s
     0     0 58680.7844    0  344 43087.7202 58680.7844  36.2%     -   34s
     0     0 58680.6357    0  387 43087.7202 58680.6357  36.2%     -   34s
     0     0 58679.7604    0  393 43087.7202 58679.7604  36.2%     -   35s
     0     0 58679.0439    0  389 43087.7202 58679.0439  36.2%     -   35s
     0     0 58671.7101    0  342 43087.7202 58671.7101  36.2%     -   35s
     0     0 58671.1278    0  343 43087.7202 58671.1278  36.2%     -   36s
     0     0 58666.1283    0  386 43087.7202 58666.1283  36.2%     -   36s
     0     0 58663.1472    0  386 43087.7202 58663.1472  36.1%     -   36s
     0     2 58663.1472    0  386 43087.7202 58663.1472  36.1%     -   42s
     7    16 57691.6747    3  366 43087.7202 58392.3339  35.5%   913   45s
    31    64 56823.7889    5  383 43087.7202 57273.5644  32.9%  1179   50s
H   35    64                    43130.553859 57273.5644  32.8%  1122   50s
H  100   130                    43210.958006 56823.3012  31.5%  1147   53s
   248   319 56430.3821    8  374 43210.9580 56823.3012  31.5%   713   56s
   417   453 55917.0435   11  325 43210.9580 56823.3012  31.5%   674   61s
   547   560 55385.3343   13  314 43210.9580 56733.7161  31.3%   693   66s
   650   638 53861.4836   14  293 43210.9580 56634.4444  31.1%   683   70s
   742   719 50583.7109   15  298 43210.9580 56430.3323  30.6%   695   75s
   889   821 48886.9729   17  300 43210.9580 56430.3323  30.6%   697   80s
  1076   950 47419.1453   19  264 43210.9580 56218.9895  30.1%   673   85s
  1240  1068 46585.2729   21  235 43210.9580 56134.1629  29.9%   662   91s
  1444  1239 43728.9276   24  245 43210.9580 56092.2846  29.8%   630   96s
  1763  1439     cutoff   27      43210.9580 56074.7152  29.8%   584  101s
  1978  1591 53349.7991   14  275 43210.9580 55942.0298  29.5%   573  106s
  2238  1851 50050.8388   20  220 43210.9580 55935.5852  29.4%   566  110s
  2646  2058 46730.4051   50  107 43210.9580 55778.3166  29.1%   527  115s
  2976  2295 53826.8731    9  293 43210.9580 55635.7244  28.8%   520  120s
  3365  2495 44249.0094   15  271 43210.9580 55629.0283  28.7%   511  125s
  3764  2612 53627.7704   10  307 43210.9580 55477.0699  28.4%   508  132s
  3895  2664 49262.6027   16  249 43210.9580 55298.3123  28.0%   516  135s
  4240  2934     cutoff   39      43210.9580 55247.1965  27.9%   510  142s
  4544  2935 50953.8731   11  386 43210.9580 55214.8102  27.8%   501  153s
  4546  2936 53552.3597    7   78 43210.9580 55214.8102  27.8%   501  159s
  4547  2937 48603.4158   14  275 43210.9580 55214.8102  27.8%   501  163s
  4548  2938 44280.0273   32  334 43210.9580 55214.8102  27.8%   501  166s
  4551  2940 54349.7102   12  325 43210.9580 55214.8102  27.8%   501  170s
  4558  2944 51184.6712   14  373 43210.9580 55214.8102  27.8%   500  176s
  4562  2947 48757.0234   24  390 43210.9580 55214.8102  27.8%   499  180s
  4566  2950 48245.4279   27  423 43210.9580 55214.8102  27.8%   499  185s
  4569  2952 48485.3273   16  383 43210.9580 55214.8102  27.8%   499  194s
  4570  2952 50020.1798   17  383 43210.9580 55214.8102  27.8%   499  200s
  4573  2959 53784.2000   16  339 43210.9580 55214.8102  27.8%   507  207s
  4585  2979 47373.8139   18  340 43210.9580 55214.8102  27.8%   510  212s
  4601  3006 45324.9316   19  321 43210.9580 55214.8102  27.8%   516  215s
  4665  3031     cutoff   21      43210.9580 54969.4590  27.2%   532  221s
  4747  3046 47899.8792   24  258 43210.9580 54969.4590  27.2%   540  227s
  4790  3057 44161.8691   25  205 43210.9580 54816.9079  26.9%   543  230s
  4878  3072 45754.7824   26  221 43210.9580 54616.9375  26.4%   548  235s
  4997  3083 43762.1788   28  159 43210.9580 54170.5792  25.4%   552  242s
  5059  3097     cutoff   29      43210.9580 54170.5792  25.4%   556  245s
  5194  3098     cutoff   30      43210.9580 54170.5792  25.4%   561  251s
  5347  3081 49473.5892   25  332 43210.9580 52641.7298  21.8%   566  257s
  5413  3086 48583.4613   26  297 43210.9580 52640.2465  21.8%   570  261s
  5579  3070 46707.8563   28  262 43210.9580 52640.2465  21.8%   574  267s
  5670  3069 46180.5090   29  196 43210.9580 52640.2465  21.8%   576  271s
  5860  3018 44280.9646   30  200 43210.9580 51082.2097  18.2%   582  277s
  5976  2991 45054.9126   25  266 43210.9580 50973.3618  18.0%   584  281s
  6222  2941     cutoff   27      43210.9580 50973.3618  18.0%   587  287s
  6358  2886     cutoff   27      43210.9580 50973.3618  18.0%   586  290s
  6646  2811     cutoff   33      43210.9580 49691.6887  15.0%   586  300s
  6948  2735 46809.6956   25  292 43210.9580 49004.4482  13.4%   589  308s
  7124  2675     cutoff   25      43210.9580 48979.3812  13.3%   589  311s
  7309  2602     cutoff   28      43210.9580 48667.8115  12.6%   590  315s
  7720  2434     cutoff   21      43210.9580 48314.8169  11.8%   589  324s
  7941  2340 44131.7707   26  253 43210.9580 47780.7404  10.6%   589  327s
  8219  2213     cutoff   31      43210.9580 47596.1058  10.1%   587  332s
  8492  2063 infeasible   28      43210.9580 47028.7771  8.84%   586  337s
  8877  1801 44030.3686   24  261 43210.9580 46642.4648  7.94%   579  341s
  9296  1520     cutoff   23      43210.9580 45956.7290  6.35%   571  345s
* 9875  1062              43    43218.854679 45273.4259  4.75%   555  347s
*10092   823              48    43257.958559 43725.2521  1.08%   545  348s

Cutting planes:
  MIR: 307
  Mixing: 1
  Flow cover: 526
  RLT: 8
  Relax-and-lift: 46

Explored 10216 nodes (5544584 simplex iterations) in 348.40 seconds (609.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 43258 43218.9 43211 ... 42130.8

Optimal solution found (tolerance 1.00e-06)
Best objective 4.325795855868e+04, best bound 4.325795855868e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 348.42s
  Master Objective (UB) = 43257.96, θ = 206334.13
  Upper Bound (UB) = 43257.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206334.13
  [DEBUG]   ✓ Scenario 0: θ = 206334.13 ≤ Q = 206334.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206334.13 ≤ Q = 206334.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206334.13 ≤ Q = 206334.13 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x49104a66
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb6efb59a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.376262e+13
Presolve removed 2597 rows and 1888 columns
Presolve time: 0.01s
Presolved: 496 rows, 501 columns, 1399 nonzeros
Found heuristic solution: objective 6164786.1099
Variable types: 341 continuous, 160 integer (160 binary)

Root relaxation: objective -1.962471e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196247.07    0  128 6164786.11 -196247.07   103%     -    0s
H    0     0                    -155882.3130 -196247.07  25.9%     -    0s
H    0     0                    -157219.1697 -196247.07  24.8%     -    0s
H    0     0                    -157433.7767 -196247.07  24.7%     -    0s
H    0     0                    -165717.2167 -196247.07  18.4%     -    0s
H    0     0                    -171897.6532 -177620.11  3.33%     -    0s
H    0     0                    -174082.4931 -177620.11  2.03%     -    0s
     0     0 -177620.11    0   58 -174082.49 -177620.11  2.03%     -    0s
H    0     0                    -174415.6676 -177607.62  1.83%     -    0s
H    0     0                    -174713.5689 -177607.62  1.66%     -    0s
H    0     0                    -175046.7434 -177607.62  1.46%     -    0s
H    0     0                    -175054.2304 -176191.44  0.65%     -    0s
     0     0 -176169.19    0   53 -175054.23 -176169.19  0.64%     -    0s
     0     0 -176166.39    0   53 -175054.23 -176166.39  0.64%     -    0s
     0     0 -175793.59    0   16 -175054.23 -175793.59  0.42%     -    0s
     0     0 -175751.53    0   16 -175054.23 -175751.53  0.40%     -    0s
     0     0 -175730.29    0   17 -175054.23 -175730.29  0.39%     -    0s
     0     0 -175728.70    0   17 -175054.23 -175728.70  0.39%     -    0s
H    0     0                    -175159.0971 -175728.70  0.33%     -    0s
H    0     0                    -175231.6826 -175728.70  0.28%     -    0s
     0     0 -175680.03    0   16 -175231.68 -175680.03  0.26%     -    0s
     0     0 -175662.70    0   16 -175231.68 -175662.70  0.25%     -    0s
H    0     0                    -175333.4687 -175658.89  0.19%     -    0s
     0     0 -175658.89    0   68 -175333.47 -175658.89  0.19%     -    0s
     0     0 -175658.89    0   21 -175333.47 -175658.89  0.19%     -    0s
     0     0 -175616.40    0   12 -175333.47 -175616.40  0.16%     -    0s
     0     0 -175609.84    0   10 -175333.47 -175609.84  0.16%     -    0s
     0     0 -175537.50    0    5 -175333.47 -175537.50  0.12%     -    0s
H    0     0                    -175475.9130 -175536.25  0.03%     -    0s
     0     0 -175533.89    0    5 -175475.91 -175533.89  0.03%     -    0s
     0     0 -175533.89    0   16 -175475.91 -175533.89  0.03%     -    0s
H    0     0                    -175489.5355 -175495.93  0.00%     -    0s
     0     0 -175495.93    0    2 -175489.54 -175495.93  0.00%     -    0s
H    0     0                    -175495.5350 -175495.53  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 7
  MIR: 2
  Flow cover: 3
  Relax-and-lift: 2

Explored 1 nodes (955 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -175496 -175490 -175476 ... -174082
No other solutions better than -175496

Optimal solution found (tolerance 1.00e-06)
Best objective -1.754955349783e+05, best bound -1.754955349783e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 193551.44
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -175495.53
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -175495.53 = 193551.44
  [DEBUG]   Current θ from Master = 206334.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12782.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30475.27
  Lower Bound (LB) = 38461.23
  Gap (UB-LB) = 4796.7263, Absolute Gap = 4796.7263, Relative Gap = 0.110887
  Not converged yet (gap = 4796.73 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x5374a2d2
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 30475.3 (0.07s)
MIP start from previous solve produced solution with objective 30475.3 (0.07s)
Loaded MIP start from previous solve with objective 30475.3

Presolve removed 28280 rows and 11480 columns
Presolve time: 0.95s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34834    4.2221345e+04   0.000000e+00   4.328429e+07      5s
Concurrent spin time: 0.36s

Solved with dual simplex

Root relaxation: objective 7.340686e+04, 19150 iterations, 8.65 seconds (10.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 73406.8580    0   83 30475.2700 73406.8580   141%     -    9s
H    0     0                    36504.443166 73406.8580   101%     -   10s
H    0     0                    38007.529900 73406.8580  93.1%     -   10s
H    0     0                    40929.013619 73406.8580  79.4%     -   10s
H    0     0                    41514.584754 73406.8580  76.8%     -   10s
H    0     0                    41888.700586 73406.8580  75.2%     -   11s
     0     0 68088.2706    0  115 41888.7006 68088.2706  62.5%     -   14s
H    0     0                    42257.500491 68088.2706  61.1%     -   15s
     0     0 67375.7332    0  138 42257.5005 67375.7332  59.4%     -   16s
     0     0 67180.7210    0  139 42257.5005 67180.7210  59.0%     -   17s
     0     0 67175.4160    0  181 42257.5005 67175.4160  59.0%     -   17s
     0     0 64253.3109    0  240 42257.5005 64253.3109  52.1%     -   20s
     0     0 63289.0813    0  252 42257.5005 63289.0813  49.8%     -   21s
     0     0 63030.7211    0  279 42257.5005 63030.7211  49.2%     -   23s
     0     0 62913.5317    0  280 42257.5005 62913.5317  48.9%     -   23s
     0     0 62905.5277    0  280 42257.5005 62905.5277  48.9%     -   23s
     0     0 62902.4156    0  280 42257.5005 62902.4156  48.9%     -   23s
     0     0 62902.3009    0  280 42257.5005 62902.3009  48.9%     -   23s
     0     0 61468.9852    0  332 42257.5005 61468.9852  45.5%     -   28s
     0     0 60886.5756    0  272 42257.5005 60886.5756  44.1%     -   30s
     0     0 60688.0100    0  291 42257.5005 60688.0100  43.6%     -   31s
     0     0 60646.0883    0  284 42257.5005 60646.0883  43.5%     -   32s
     0     0 60636.4383    0  288 42257.5005 60636.4383  43.5%     -   32s
     0     0 60634.4618    0  290 42257.5005 60634.4618  43.5%     -   32s
     0     0 60634.0408    0  288 42257.5005 60634.0408  43.5%     -   32s
     0     0 59757.2119    0  306 42257.5005 59757.2119  41.4%     -   38s
     0     0 59609.7338    0  309 42257.5005 59609.7338  41.1%     -   39s
     0     0 59539.0373    0  353 42257.5005 59539.0373  40.9%     -   40s
     0     0 59464.0821    0  331 42257.5005 59464.0821  40.7%     -   40s
     0     0 59425.0902    0  376 42257.5005 59425.0902  40.6%     -   41s
     0     0 59406.5311    0  376 42257.5005 59406.5311  40.6%     -   41s
     0     0 59396.8490    0  381 42257.5005 59396.8490  40.6%     -   42s
     0     0 59393.0409    0  379 42257.5005 59393.0409  40.6%     -   42s
     0     0 59391.3588    0  387 42257.5005 59391.3588  40.5%     -   42s
     0     0 59390.9197    0  386 42257.5005 59390.9197  40.5%     -   42s
     0     0 59233.5105    0  358 42257.5005 59233.5105  40.2%     -   44s
     0     0 59198.6403    0  353 42257.5005 59198.6403  40.1%     -   45s
     0     0 59165.0700    0  354 42257.5005 59165.0700  40.0%     -   45s
     0     0 59153.7865    0  358 42257.5005 59153.7865  40.0%     -   46s
     0     0 59142.8091    0  360 42257.5005 59142.8091  40.0%     -   46s
     0     0 59140.4724    0  364 42257.5005 59140.4724  40.0%     -   46s
     0     0 59139.4825    0  371 42257.5005 59139.4825  40.0%     -   47s
     0     0 59090.8685    0  404 42257.5005 59090.8685  39.8%     -   48s
     0     0 59036.6829    0  388 42257.5005 59036.6829  39.7%     -   50s
     0     0 59027.3216    0  328 42257.5005 59027.3216  39.7%     -   50s
     0     0 59024.6815    0  360 42257.5005 59024.6815  39.7%     -   50s
     0     0 59023.6029    0  367 42257.5005 59023.6029  39.7%     -   51s
     0     0 58964.4180    0  364 42257.5005 58964.4180  39.5%     -   52s
     0     0 58945.8179    0  370 42257.5005 58945.8179  39.5%     -   53s
     0     0 58936.4940    0  369 42257.5005 58936.4940  39.5%     -   53s
     0     0 58933.6931    0  364 42257.5005 58933.6931  39.5%     -   53s
     0     0 58932.6439    0  366 42257.5005 58932.6439  39.5%     -   53s
     0     0 58924.9347    0  366 42257.5005 58924.9347  39.4%     -   54s
     0     0 58916.6314    0  365 42257.5005 58916.6314  39.4%     -   55s
     0     0 58916.6314    0  364 42257.5005 58916.6314  39.4%     -   55s
     0     0 58916.6314    0  367 42257.5005 58916.6314  39.4%     -   56s
H    0     0                    42409.201317 58907.2577  38.9%     -   57s
     0     0 58907.2577    0  375 42409.2013 58907.2577  38.9%     -   57s
     0     0 58905.4453    0  333 42409.2013 58905.4453  38.9%     -   57s
     0     0 58892.6349    0  376 42409.2013 58892.6349  38.9%     -   58s
     0     0 58878.6456    0  389 42409.2013 58878.6456  38.8%     -   61s
     0     0 58875.2002    0  363 42409.2013 58875.2002  38.8%     -   61s
     0     0 58873.6343    0  360 42409.2013 58873.6343  38.8%     -   61s
     0     0 58855.9838    0  366 42409.2013 58855.9838  38.8%     -   62s
     0     0 58850.9268    0  415 42409.2013 58850.9268  38.8%     -   63s
     0     0 58849.2872    0  414 42409.2013 58849.2872  38.8%     -   63s
     0     0 58807.2449    0  409 42409.2013 58807.2449  38.7%     -   64s
     0     0 58765.8746    0  378 42409.2013 58765.8746  38.6%     -   65s
     0     0 58759.2793    0  381 42409.2013 58759.2793  38.6%     -   66s
     0     0 58754.4158    0  344 42409.2013 58754.4158  38.5%     -   66s
     0     0 58752.0263    0  344 42409.2013 58752.0263  38.5%     -   66s
     0     0 58751.0077    0  385 42409.2013 58751.0077  38.5%     -   66s
     0     0 58729.9059    0  373 42409.2013 58729.9059  38.5%     -   67s
     0     0 58720.8288    0  419 42409.2013 58720.8288  38.5%     -   68s
     0     0 58718.1784    0  377 42409.2013 58718.1784  38.5%     -   68s
     0     0 58715.5174    0  424 42409.2013 58715.5174  38.4%     -   69s
     0     0 58715.4200    0  428 42409.2013 58715.4200  38.4%     -   69s
     0     0 58697.9043    0  334 42409.2013 58697.9043  38.4%     -   70s
     0     0 58690.6975    0  389 42409.2013 58690.6975  38.4%     -   70s
     0     0 58688.7258    0  429 42409.2013 58688.7258  38.4%     -   71s
     0     0 58688.1360    0  394 42409.2013 58688.1360  38.4%     -   71s
     0     0 58670.1275    0  387 42409.2013 58670.1275  38.3%     -   72s
     0     0 58666.5186    0  390 42409.2013 58666.5186  38.3%     -   72s
     0     0 58666.1930    0  389 42409.2013 58666.1930  38.3%     -   72s
     0     0 58665.8103    0  387 42409.2013 58665.8103  38.3%     -   73s
     0     0 58663.9624    0  388 42409.2013 58663.9624  38.3%     -   73s
     0     0 58663.9624    0  389 42409.2013 58663.9624  38.3%     -   74s
     0     0 58663.9624    0  388 42409.2013 58663.9624  38.3%     -   74s
     0     0 58656.6035    0  333 42409.2013 58656.6035  38.3%     -   75s
     0     0 58655.3900    0  389 42409.2013 58655.3900  38.3%     -   75s
     0     0 58655.3900    0  335 42409.2013 58655.3900  38.3%     -   76s
     0     0 58655.3900    0  335 42409.2013 58655.3900  38.3%     -   77s
     0     2 58655.1689    0  335 42409.2013 58655.1689  38.3%     -   92s
     3     8 58466.2186    2  360 42409.2013 58629.1740  38.2%   749   96s
    15    32 58255.9206    4  371 42409.2013 58271.3264  37.4%  1389  103s
    31    64 58063.9254    5  367 42409.2013 58255.6317  37.4%  2307  107s
    63    96 57997.7848    6  365 42409.2013 58063.8832  36.9%  2015  115s
    95   142 57777.2604    7  358 42409.2013 58063.8832  36.9%  1961  124s
   141   214 57401.0095    9  375 42409.2013 58063.8832  36.9%  1511  128s
   215   254 57010.0412   12  398 42409.2013 58063.8832  36.9%  1274  133s
   255   324 56031.2857   12  351 42409.2013 58063.8832  36.9%  1254  138s
   325   362 55387.6426   13  312 42409.2013 58063.8832  36.9%  1208  143s
   365   414 56957.9538   13  388 42409.2013 58063.8832  36.9%  1182  148s
   417   474 56544.9557   15  331 42409.2013 58063.8832  36.9%  1224  153s
   477   551 56090.1235   16  330 42409.2013 58063.8832  36.9%  1212  157s
   554   629 56041.3951   16  319 42409.2013 58063.8832  36.9%  1150  161s
   636   691 55240.1623   17  311 42409.2013 58063.8832  36.9%  1109  165s
   777   779 55030.1082   18  313 42409.2013 58063.8832  36.9%  1086  172s
   811   811 53863.3106   18  307 42409.2013 58063.8832  36.9%  1085  176s
   855   857 54380.6200   19  290 42409.2013 58063.8832  36.9%  1095  180s
   917   900 49695.2402   19  339 42409.2013 58063.8832  36.9%  1092  186s
   980   953 53038.3266   20  294 42409.2013 58063.8832  36.9%  1096  190s
  1055  1012 49381.3028   20  294 42409.2013 58063.8832  36.9%  1110  195s
  1219  1164 51007.2742   21  264 42409.2013 57777.2102  36.2%  1107  205s
  1446  1366 46777.3091   23  247 42409.2013 57695.9761  36.0%  1060  215s
  1573  1467 48688.5800   25  320 42409.2013 57695.9761  36.0%  1038  221s
  1702  1613 48396.2187   26  316 42409.2013 57695.9761  36.0%  1023  225s
  1870  1790 infeasible   27      42409.2013 57695.9761  36.0%   986  230s
  2080  1921 47268.8079   28  301 42409.2013 57190.4488  34.9%   939  235s
  2257  2098 46897.8076   29  292 42409.2013 57068.5458  34.6%   919  243s
  2462  2189 46119.5250   32  260 42409.2013 56957.8186  34.3%   894  247s
  2579  2318 45269.5797   33  221 42409.2013 56957.8186  34.3%   881  253s
  2780  2433 45234.5919   34  219 42409.2013 56956.6109  34.3%   855  260s
  2947  2555 infeasible   40      42409.2013 56804.8092  33.9%   849  266s
  3113  2665 43016.8824   52  153 42409.2013 56771.1234  33.9%   847  271s
  3281  2761 53858.7417   14  259 42409.2013 56771.1234  33.9%   849  279s
  3437  2863 52177.1532   15  299 42409.2013 56683.2179  33.7%   851  285s
  3637  2994 51183.1377   18  237 42409.2013 56565.9286  33.4%   847  292s
  3853  3155 49738.0936   19  200 42409.2013 56565.9286  33.4%   841  299s
  4076  3156 51954.8907   12  335 42409.2013 56561.3337  33.4%   837  347s
  4078  3157 52819.3143   16   83 42409.2013 56561.3337  33.4%   837  358s
  4079  3158 48643.8533   32  307 42409.2013 56561.3337  33.4%   836  368s
  4080  3159 44309.0286   53  339 42409.2013 56561.3337  33.4%   836  372s
  4081  3159 48803.2128   22  363 42409.2013 56561.3337  33.4%   836  375s
  4086  3163 47381.6792   26  330 42409.2013 56561.3337  33.4%   835  381s
  4091  3166 44607.2088   66  378 42409.2013 56561.3337  33.4%   834  385s
  4095  3169 48110.7789   30  341 42409.2013 56561.3337  33.4%   833  391s
  4098  3171 44708.6377   21  344 42409.2013 56561.3337  33.4%   832  395s
  4101  3173 53465.5217   22  343 42409.2013 56561.3337  33.4%   832  402s
  4103  3174 49090.0815   11  400 42409.2013 56561.3337  33.4%   831  405s
  4106  3176 45281.5070   42  332 42409.2013 56561.3337  33.4%   831  410s
  4109  3178 46476.8093   25  336 42409.2013 56561.3337  33.4%   830  426s
  4110  3179 43884.6680   46  336 42409.2013 56561.3337  33.4%   830  435s
  4111  3182 56561.3337   10  338 42409.2013 56561.3337  33.4%   843  446s
  4113  3186 56561.3337   11  335 42409.2013 56561.3337  33.4%   845  452s
  4117  3192 56561.3337   12  334 42409.2013 56561.3337  33.4%   846  457s
  4125  3206 56561.3337   13  332 42409.2013 56561.3337  33.4%   847  466s
  4141  3232 56561.3337   14  321 42409.2013 56561.3337  33.4%   859  475s
  4173  3254 56561.3337   15  375 42409.2013 56561.3337  33.4%   876  481s
  4205  3282 51913.7757   16  309 42409.2013 56561.3337  33.4%   902  490s
  4244  3318 50978.8044   17  340 42409.2013 56561.3337  33.4%   936  498s
  4297  3322 50931.5798   17  299 42409.2013 56561.3337  33.4%   958  508s
  4367  3333 46201.5426   18  331 42409.2013 56561.3337  33.4%   982  517s
  4437  3320 46076.5705   18  297 42409.2013 56561.3337  33.4%  1001  524s
  4522  3288 46060.8551   19  328 42409.2013 56561.3337  33.4%  1012  531s
  4597  3287 infeasible   19      42409.2013 56561.3337  33.4%  1027  537s
  4664  3304 44925.2792   20  311 42409.2013 56167.6334  32.4%  1037  544s
  4730  3308 42594.6264   21  260 42409.2013 56167.6334  32.4%  1049  551s
  4778  3328 42964.7099   21  292 42409.2013 56167.6334  32.4%  1055  560s
  4844  3330 infeasible   22      42409.2013 55789.2675  31.5%  1063  568s
  4889  3366 43435.8659   21  305 42409.2013 55789.2675  31.5%  1067  574s
  4972  3375 infeasible   22      42409.2013 55535.8467  31.0%  1067  579s
  5053  3385 infeasible   22      42409.2013 55362.8154  30.5%  1071  585s
  5136  3364 52094.6295   18  293 42409.2013 55333.7877  30.5%  1075  594s
  5187  3380 51902.0205   19  297 42409.2013 55333.7877  30.5%  1081  598s
  5250  3382 50824.7928   20  301 42409.2013 55333.7877  30.5%  1082  604s
  5336  3379 49705.6820   21  294 42409.2013 55202.2506  30.2%  1087  611s
  5421  3394 49434.6964   22  278 42409.2013 55202.2506  30.2%  1096  619s
  5510  3407 45719.2529   24  236 42409.2013 55202.2506  30.2%  1104  626s
  5605  3419 43058.9459   26  198 42409.2013 54067.8092  27.5%  1111  636s
  5706  3428     cutoff   25      42409.2013 53941.1021  27.2%  1119  645s
  5820  3408 52082.6140   19  270 42409.2013 53897.5245  27.1%  1124  655s
  5868  3420 51528.6902   20  301 42409.2013 53897.5245  27.1%  1128  661s
  5925  3435 49078.0238   21  273 42409.2013 53780.2554  26.8%  1132  670s
  5991  3426 46833.7298   22  299 42409.2013 53780.2554  26.8%  1136  678s
  6072  3425 45088.5595   23  265 42409.2013 53780.2554  26.8%  1144  686s
  6144  3445 44786.2770   24  255 42409.2013 53780.2554  26.8%  1154  695s
  6229  3458 44686.0541   25  200 42409.2013 53780.2554  26.8%  1160  704s
  6337  3443 43005.3608   28  167 42409.2013 53108.3509  25.2%  1166  712s
  6378  3455     cutoff   29      42409.2013 53071.0881  25.1%  1168  718s
  6425  3454 49991.1463   16  300 42409.2013 53071.0881  25.1%  1170  729s
  6488  3442 47445.7448   16  288 42409.2013 53071.0881  25.1%  1174  738s
  6570  3434 48681.5955   17  253 42409.2013 52997.2441  25.0%  1182  750s
  6649  3445     cutoff   18      42409.2013 52997.2441  25.0%  1191  762s
  6740  3439 46007.3125   20  217 42409.2013 52997.2441  25.0%  1196  773s
  6892  3437 43335.9996   23  109 42409.2013 52737.6017  24.4%  1204  783s
  7072  3430     cutoff   25      42409.2013 52732.8473  24.3%  1212  796s
  7267  3417     cutoff   23      42409.2013 52408.5033  23.6%  1220  807s
  7461  3413 47233.5303   17  262 42409.2013 52291.2279  23.3%  1227  820s
  7673  3420 45135.5390   20  217 42409.2013 52025.5964  22.7%  1232  831s
  7888  3382 47778.1819   18  305 42409.2013 51927.9601  22.4%  1237  843s
  8096  3415 44388.6305   21  262 42409.2013 51927.9601  22.4%  1250  857s
  8335  3387 47329.3213   20  286 42409.2013 51610.3695  21.7%  1258  870s
  8601  3350 42477.3465   25  198 42409.2013 51610.3695  21.7%  1266  885s
  8879  3322 47987.6787   20  260 42409.2013 51427.7863  21.3%  1275  898s
  9168  3261 46406.8206   22  238 42409.2013 51102.2920  20.5%  1284  914s
  9464  3206 45621.6819   22  304 42409.2013 50966.7511  20.2%  1294  929s
  9761  3168 45212.3936   24  239 42409.2013 50767.4611  19.7%  1306  944s
 10063  3151 44575.9014   22  334 42409.2013 50660.2695  19.5%  1318  958s
 10460  3074 44650.1936   25  219 42409.2013 50532.2703  19.2%  1319  975s
 10793  3025 44033.4278   19  240 42409.2013 50262.7066  18.5%  1327  992s
 11078  2998     cutoff   22      42409.2013 50144.6799  18.2%  1332 1011s
 11444  2960 infeasible   24      42409.2013 49846.8572  17.5%  1342 1032s
 11864  2873 42912.9662   27  187 42409.2013 49736.3064  17.3%  1347 1053s
 12353  2763 44787.3749   22  246 42409.2013 49571.4225  16.9%  1349 1072s
 12861  2604 42772.1211   24  206 42409.2013 49397.8544  16.5%  1350 1092s
 13364  2459 42573.6393   19  274 42409.2013 49108.2956  15.8%  1354 1114s
 13828  2373 42825.9228   22  285 42409.2013 49025.4517  15.6%  1364 1135s
 13890  2371 infeasible   23      42409.2013 48883.3450  15.3%  1368 1157s
 14219  2410 infeasible   20      42409.2013 48882.1356  15.3%  1375 1180s
 14766  2426     cutoff   28      42409.2013 48647.2226  14.7%  1380 1205s
 15339  2481 42699.8637   21  253 42409.2013 48376.4245  14.1%  1387 1228s
 15924  2522     cutoff   22      42409.2013 48157.4271  13.6%  1394 1252s
H15988  2513                    42577.556324 48157.4271  13.1%  1393 1252s
*16020  2492              70    42689.944330 48157.4271  12.8%  1390 1252s
 16624  2448 44356.7137   22  240 42689.9443 48085.1938  12.6%  1391 1278s
H16671  2346                    43130.553859 47903.1453  11.1%  1391 1278s
 17189  2251 44478.7628   26  128 43130.5539 47770.3184  10.8%  1396 1305s
 17859  2160 infeasible   23      43130.5539 47502.8136  10.1%  1402 1332s
 18519  2045 infeasible   24      43130.5539 47324.0792  9.72%  1411 1360s
 19238  1891     cutoff   22      43130.5539 47073.7440  9.14%  1417 1389s
 20037  1707 infeasible   25      43130.5539 46749.5894  8.39%  1420 1419s
 20780  1398 infeasible   23      43130.5539 46506.4987  7.83%  1427 1451s
 21624  1073 infeasible   34      43130.5539 45916.0040  6.46%  1432 1485s
 22379   555 infeasible   27      43130.5539 45603.3368  5.73%  1440 1516s
H22597   555                    43210.958006 45518.6953  5.34%  1441 1516s
 23200     5     cutoff   27      43210.9580 44950.7046  4.03%  1445 1555s

Cutting planes:
  MIR: 546
  Mixing: 1
  Flow cover: 898
  Inf proof: 13
  RLT: 12
  Relax-and-lift: 74

Explored 23854 nodes (34346019 simplex iterations) in 1556.82 seconds (3018.42 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 43211 43130.6 42689.9 ... 38007.5

Optimal solution found (tolerance 1.00e-06)
Best objective 4.321095800632e+04, best bound 4.321095800632e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1556.83s
  Master Objective (UB) = 43210.96, θ = 206859.69
  Upper Bound (UB) = 43210.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206859.69
  [DEBUG]   ✓ Scenario 0: θ = 206859.69 ≤ Q = 206859.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206859.69 ≤ Q = 206859.69 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206859.69 ≤ Q = 206859.69 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206859.69 ≤ Q = 206859.69 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x23736e2d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x23736e2d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.363719e+13
Presolve removed 2599 rows and 1890 columns
Presolve time: 0.01s
Presolved: 494 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6210403.2191
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.970351e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -197035.15    0  128 6210403.22 -197035.15   103%     -    0s
H    0     0                    -159969.2671 -197035.15  23.2%     -    0s
H    0     0                    -161470.9980 -197035.15  22.0%     -    0s
     0     0 -174673.32    0   55 -161471.00 -174673.32  8.18%     -    0s
H    0     0                    -171704.2194 -174632.74  1.71%     -    0s
     0     0 -174454.48    0   53 -171704.22 -174454.48  1.60%     -    0s
H    0     0                    -173283.9352 -174454.48  0.68%     -    0s
     0     0 -173855.63    0   35 -173283.94 -173855.63  0.33%     -    0s
     0     0 -173728.91    0   34 -173283.94 -173728.91  0.26%     -    0s
     0     0 -173708.04    0   42 -173283.94 -173708.04  0.24%     -    0s
     0     0 -173707.32    0   41 -173283.94 -173707.32  0.24%     -    0s
     0     0 -173584.08    0   15 -173283.94 -173584.08  0.17%     -    0s
     0     0 -173532.46    0   18 -173283.94 -173532.46  0.14%     -    0s
H    0     0                    -173351.6164 -173525.20  0.10%     -    0s
     0     0 -173525.20    0   17 -173351.62 -173525.20  0.10%     -    0s
     0     0 -173461.12    0   12 -173351.62 -173461.12  0.06%     -    0s
     0     0 -173461.12    0   27 -173351.62 -173461.12  0.06%     -    0s
     0     0 -173461.12    0   27 -173351.62 -173461.12  0.06%     -    0s
     0     0 -173456.65    0   16 -173351.62 -173456.65  0.06%     -    0s
     0     0 -173456.56    0   16 -173351.62 -173456.56  0.06%     -    0s
     0     0 -173453.70    0   16 -173351.62 -173453.70  0.06%     -    0s
     0     0 -173451.88    0   16 -173351.62 -173451.88  0.06%     -    0s
     0     0 -173451.18    0   16 -173351.62 -173451.18  0.06%     -    0s
     0     0 -173451.14    0   16 -173351.62 -173451.14  0.06%     -    0s
     0     0 -173451.14    0   16 -173351.62 -173451.14  0.06%     -    0s
     0     0 -173434.13    0   14 -173351.62 -173434.13  0.05%     -    0s
     0     0 -173434.13    0   13 -173351.62 -173434.13  0.05%     -    0s
     0     0 -173434.04    0   13 -173351.62 -173434.04  0.05%     -    0s
     0     0 -173433.17    0   13 -173351.62 -173433.17  0.05%     -    0s
     0     0 -173432.82    0   13 -173351.62 -173432.82  0.05%     -    0s
     0     0 -173432.80    0   13 -173351.62 -173432.80  0.05%     -    0s
     0     0 -173432.80    0   13 -173351.62 -173432.80  0.05%     -    0s
     0     0 -173368.62    0   13 -173351.62 -173368.62  0.01%     -    0s
     0     0 -173368.62    0   13 -173351.62 -173368.62  0.01%     -    0s
     0     0 -173368.62    0   13 -173351.62 -173368.62  0.01%     -    0s
     0     0 -173368.62    0   13 -173351.62 -173368.62  0.01%     -    0s
     0     0 -173368.62    0   13 -173351.62 -173368.62  0.01%     -    0s
     0     0 -173368.62    0   13 -173351.62 -173368.62  0.01%     -    0s
     0     0 -173368.62    0   13 -173351.62 -173368.62  0.01%     -    0s
     0     0 -173357.95    0    3 -173351.62 -173357.95  0.00%     -    0s
     0     0     cutoff    0      -173351.62 -173351.62  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 9
  MIR: 21
  Flow cover: 16
  Relax-and-lift: 2

Explored 1 nodes (729 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 6: -173352 -173284 -161471 ... 1.36372e+13
No other solutions better than -173352

Optimal solution found (tolerance 1.00e-06)
Best objective -1.733516164397e+05, best bound -1.733516164397e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 195695.36
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -173351.62
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -173351.62 = 195695.36
  [DEBUG]   Current θ from Master = 206859.69
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11164.33 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32046.63
  Lower Bound (LB) = 38461.23
  Gap (UB-LB) = 4749.7257, Absolute Gap = 4749.7257, Relative Gap = 0.109919
  Not converged yet (gap = 4749.73 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0xb240cf7e
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 1.15s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -318406.0610
Found heuristic solution: objective -173969.7691

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25286   -1.5756497e+04   0.000000e+00   3.783774e+08      5s
   36365    4.9410751e+04   0.000000e+00   2.032435e+09     10s
Concurrent spin time: 1.16s

Solved with dual simplex

Root relaxation: objective 7.340683e+04, 29082 iterations, 13.98 seconds (17.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 73406.8291    0   83 -173969.77 73406.8291   142%     -   15s
H    0     0                    -168314.8447 73406.8291   144%     -   15s
H    0     0                    -164375.6056 73406.8291   145%     -   16s
H    0     0                    -161386.0770 73406.8291   145%     -   16s
H    0     0                    -45739.81386 73406.8291   260%     -   16s
H    0     0                    -3627.340052 73406.8291  2124%     -   16s
H    0     0                    -2529.315102 73406.8291  3002%     -   16s
H    0     0                    7836.9334213 73406.8291   837%     -   16s
H    0     0                    18524.294970 73406.8291   296%     -   17s
H    0     0                    24055.856187 73406.8291   205%     -   17s
H    0     0                    24356.571342 73406.8291   201%     -   17s
H    0     0                    29135.791599 73406.8291   152%     -   17s
H    0     0                    29353.993602 73406.8291   150%     -   17s
H    0     0                    29421.837836 73406.8291   149%     -   17s
H    0     0                    29516.430274 73406.8291   149%     -   17s
H    0     0                    29592.134510 73406.8291   148%     -   17s
H    0     0                    29841.740146 73406.8291   146%     -   17s
H    0     0                    29998.838819 73406.8291   145%     -   17s
H    0     0                    30613.332734 73406.8291   140%     -   17s
H    0     0                    30711.391844 73406.8291   139%     -   17s
H    0     0                    31805.429322 73406.8291   131%     -   17s
H    0     0                    33426.656447 68339.3422   104%     -   23s
H    0     0                    34231.370645 68339.3422   100%     -   23s
H    0     0                    34453.655624 68339.3422  98.4%     -   23s
     0     0 68316.1614    0  122 34453.6556 68316.1614  98.3%     -   23s
     0     0 67786.6874    0  140 34453.6556 67786.6874  96.7%     -   26s
     0     0 67786.6874    0  143 34453.6556 67786.6874  96.7%     -   27s
     0     0 67786.6874    0  142 34453.6556 67786.6874  96.7%     -   27s
H    0     0                    34546.669002 64209.4213  85.9%     -   36s
H    0     0                    35084.156657 64209.4213  83.0%     -   36s
     0     0 64209.4213    0  273 35084.1567 64209.4213  83.0%     -   36s
H    0     0                    37069.228400 64209.1900  73.2%     -   36s
     0     0 63784.0827    0  278 37069.2284 63784.0827  72.1%     -   38s
     0     0 63479.3273    0  271 37069.2284 63479.3273  71.2%     -   41s
     0     0 63401.3545    0  293 37069.2284 63401.3545  71.0%     -   42s
     0     0 63382.1257    0  291 37069.2284 63382.1257  71.0%     -   42s
     0     0 63379.0284    0  287 37069.2284 63379.0284  71.0%     -   43s
     0     0 63374.3677    0  300 37069.2284 63374.3677  71.0%     -   43s
     0     0 63370.1544    0  279 37069.2284 63370.1544  71.0%     -   43s
     0     0 63369.9807    0  275 37069.2284 63369.9807  71.0%     -   43s
     0     0 61560.6682    0  316 37069.2284 61560.6682  66.1%     -   51s
     0     0 61137.3419    0  309 37069.2284 61137.3419  64.9%     -   54s
     0     0 61003.2540    0  327 37069.2284 61003.2540  64.6%     -   56s
     0     0 60897.4777    0  333 37069.2284 60897.4777  64.3%     -   57s
     0     0 60869.1080    0  332 37069.2284 60869.1080  64.2%     -   58s
     0     0 60834.2727    0  328 37069.2284 60834.2727  64.1%     -   58s
H    0     0                    37440.372237 60776.3632  62.3%     -   59s
H    0     0                    37524.202359 60776.3632  62.0%     -   59s
     0     0 60776.3632    0  331 37524.2024 60776.3632  62.0%     -   59s
     0     0 60755.5459    0  337 37524.2024 60755.5459  61.9%     -   60s
H    0     0                    38216.073927 60753.0063  59.0%     -   60s
H    0     0                    38549.360389 60753.0063  57.6%     -   60s
     0     0 60753.0063    0  334 38549.3604 60753.0063  57.6%     -   60s
     0     0 60751.5177    0  330 38549.3604 60751.5177  57.6%     -   60s
     0     0 60750.2788    0  334 38549.3604 60750.2788  57.6%     -   60s
H    0     0                    38814.408292 60750.2788  56.5%     -   66s
H    0     0                    39024.692999 60750.2788  55.7%     -   66s
H    0     0                    39517.310958 60750.2788  53.7%     -   66s
H    0     0                    39741.896946 60750.2788  52.9%     -   66s
H    0     0                    40415.095426 60750.2788  50.3%     -   66s
     0     0 60160.9829    0  350 40415.0954 60160.9829  48.9%     -   69s
     0     0 59825.9310    0  354 40415.0954 59825.9310  48.0%     -   73s
     0     0 59726.5795    0  362 40415.0954 59726.5795  47.8%     -   75s
     0     0 59687.7675    0  366 40415.0954 59687.7675  47.7%     -   76s
     0     0 59619.5431    0  360 40415.0954 59619.5431  47.5%     -   78s
     0     0 59549.3960    0  361 40415.0954 59549.3960  47.3%     -   79s
     0     0 59525.5179    0  367 40415.0954 59525.5179  47.3%     -   81s
     0     0 59514.5381    0  361 40415.0954 59514.5381  47.3%     -   82s
     0     0 59501.2928    0  365 40415.0954 59501.2928  47.2%     -   82s
     0     0 59497.8666    0  366 40415.0954 59497.8666  47.2%     -   83s
     0     0 59496.3242    0  378 40415.0954 59496.3242  47.2%     -   83s
     0     0 59311.2480    0  369 40415.0954 59311.2480  46.8%     -   87s
H    0     0                    40425.029956 59198.4160  46.4%     -   90s
H    0     0                    40523.944949 59198.4160  46.1%     -   90s
H    0     0                    40763.291772 59198.4160  45.2%     -   90s
     0     0 59198.4160    0  376 40763.2918 59198.4160  45.2%     -   90s
     0     0 59191.5953    0  365 40763.2918 59191.5953  45.2%     -   90s
     0     0 59187.2708    0  374 40763.2918 59187.2708  45.2%     -   91s
     0     0 59185.3655    0  371 40763.2918 59185.3655  45.2%     -   91s
     0     0 59184.9358    0  373 40763.2918 59184.9358  45.2%     -   91s
     0     0 59082.4452    0  343 40763.2918 59082.4452  44.9%     -   93s
     0     0 59066.9196    0  391 40763.2918 59066.9196  44.9%     -   95s
     0     0 59058.2516    0  389 40763.2918 59058.2516  44.9%     -   96s
     0     0 59047.5036    0  392 40763.2918 59047.5036  44.9%     -   96s
     0     0 59040.9461    0  392 40763.2918 59040.9461  44.8%     -   97s
     0     0 59036.2143    0  344 40763.2918 59036.2143  44.8%     -   97s
     0     0 59035.1860    0  348 40763.2918 59035.1860  44.8%     -   97s
     0     0 58960.2146    0  379 40763.2918 58960.2146  44.6%     -  100s
H    0     0                    40814.692501 58956.2975  44.4%     -  100s
H    0     0                    40816.388862 58956.2975  44.4%     -  100s
     0     0 58946.2804    0  383 40816.3889 58946.2804  44.4%     -  101s
     0     0 58940.4253    0  386 40816.3889 58940.4253  44.4%     -  102s
     0     0 58938.3960    0  384 40816.3889 58938.3960  44.4%     -  103s
     0     0 58936.1854    0  383 40816.3889 58936.1854  44.4%     -  103s
     0     0 58934.8466    0  385 40816.3889 58934.8466  44.4%     -  103s
     0     0 58873.4470    0  381 40816.3889 58873.4470  44.2%     -  106s
     0     0 58846.3532    0  390 40816.3889 58846.3532  44.2%     -  109s
     0     0 58838.1213    0  396 40816.3889 58838.1213  44.2%     -  110s
     0     0 58837.7883    0  397 40816.3889 58837.7883  44.2%     -  110s
     0     0 58809.3415    0  378 40816.3889 58809.3415  44.1%     -  112s
     0     0 58804.0783    0  390 40816.3889 58804.0783  44.1%     -  113s
     0     0 58801.3564    0  395 40816.3889 58801.3564  44.1%     -  113s
     0     0 58800.7951    0  391 40816.3889 58800.7951  44.1%     -  113s
     0     0 58759.4007    0  349 40816.3889 58759.4007  44.0%     -  116s
     0     0 58746.7437    0  361 40816.3889 58746.7437  43.9%     -  118s
     0     0 58740.9405    0  360 40816.3889 58740.9405  43.9%     -  119s
     0     0 58737.1937    0  363 40816.3889 58737.1937  43.9%     -  119s
     0     0 58736.4964    0  418 40816.3889 58736.4964  43.9%     -  120s
     0     0 58720.3293    0  421 40816.3889 58720.3293  43.9%     -  121s
     0     0 58717.8161    0  449 40816.3889 58717.8161  43.9%     -  122s
     0     0 58714.8418    0  443 40816.3889 58714.8418  43.9%     -  123s
     0     0 58713.6677    0  451 40816.3889 58713.6677  43.8%     -  123s
     0     0 58702.8467    0  365 40816.3889 58702.8467  43.8%     -  124s
H    0     0                    41121.424330 58702.7342  42.8%     -  128s
H    0     0                    41501.535071 58702.7342  41.4%     -  129s
     0     0 58700.5477    0  367 41501.5351 58700.5477  41.4%     -  129s
     0     0 58699.2154    0  372 41501.5351 58699.2154  41.4%     -  129s
     0     0 58697.7052    0  368 41501.5351 58697.7052  41.4%     -  130s
H    0     0                    41510.662095 58697.3126  41.4%     -  130s
H    0     0                    41573.579926 58697.3126  41.2%     -  130s
     0     0 58696.0008    0  430 41573.5799 58696.0008  41.2%     -  131s
     0     0 58695.6072    0  428 41573.5799 58695.6072  41.2%     -  132s
     0     0 58694.5255    0  426 41573.5799 58694.5255  41.2%     -  132s
     0     0 58694.5255    0  426 41573.5799 58694.5255  41.2%     -  133s
     0     0 58694.5255    0  426 41573.5799 58694.5255  41.2%     -  134s
     0     2 58694.5255    0  426 41573.5799 58694.5255  41.2%     -  157s
     1     4 58612.0412    1  363 41573.5799 58694.2064  41.2%   941  161s
     3     8 58451.8520    2  395 41573.5799 58612.0128  41.0%  1766  165s
     7    16 57839.2480    3  383 41573.5799 58451.1662  40.6%  2800  170s
    15    32 57486.8104    4  356 41573.5799 57839.2154  39.1%  3090  180s
    31    64 57290.9351    5  374 41573.5799 57486.7669  38.3%  4865  191s
    63    81 55489.6375    6  346 41573.5799 57332.3927  37.9%  4369  203s
    80   113 55544.5275    7  308 41573.5799 57332.3927  37.9%  4961  222s
   112   145 55362.5897    8  300 41573.5799 57332.3927  37.9%  4469  230s
   144   218 54000.1539    9  258 41573.5799 57332.3927  37.9%  4230  242s
   217   324 54838.5830    9  292 41573.5799 57332.3927  37.9%  3302  254s
   323   439 55228.3096    8  289 41573.5799 57332.3927  37.9%  2810  265s
   438   471 54109.0507   10  286 41573.5799 57332.3927  37.9%  2498  270s
   470   509 54646.9327    9  300 41573.5799 57332.3927  37.9%  2466  276s
   508   549 54724.3910   11  287 41573.5799 57332.3927  37.9%  2455  282s
   548   587 54529.6737   11  282 41573.5799 57332.3927  37.9%  2444  288s
   586   627 53925.7223   10  256 41573.5799 57332.3927  37.9%  2436  295s
   626   667 53938.0853   10  250 41573.5799 57332.3927  37.9%  2427  301s
   666   703 54647.2711   12  290 41573.5799 57332.3927  37.9%  2417  306s
   706   733 53759.7262   12  287 41573.5799 57332.3927  37.9%  2402  313s
   740   773 54428.6247   12  328 41573.5799 57331.9079  37.9%  2402  320s
   780   815 54568.8358   13  290 41573.5799 57331.9079  37.9%  2386  329s
   824   878 54205.1214   13  281 41573.5799 57331.9079  37.9%  2385  333s
   887   943 54325.6564   14  278 41573.5799 57331.9079  37.9%  2332  340s
   958  1011 54075.6743   14  328 41573.5799 57331.9079  37.9%  2265  348s
  1046  1076 54262.2056   15  283 41573.5799 57284.8389  37.8%  2203  356s
  1139  1153 53275.0281   13  271 41573.5799 57283.3563  37.8%  2187  364s
  1254  1210 52139.8544   15  258 41573.5799 57283.3563  37.8%  2149  377s
  1351  1287 54022.1623   16  265 41573.5799 57283.3563  37.8%  2129  389s
  1451  1358 53809.6874   15  331 41573.5799 57283.3563  37.8%  2126  402s
  1554  1452 52053.2439   16  250 41573.5799 57283.3563  37.8%  2138  410s
  1664  1554 52111.5528   17  271 41573.5799 57283.3563  37.8%  2149  418s
  1786  1638 52585.8370   18  241 41573.5799 57200.8686  37.6%  2143  429s
  1916  1707 51630.3489   21  215 41573.5799 57200.8686  37.6%  2150  437s
  2011  1779 51539.7326   20  225 41573.5799 57200.8686  37.6%  2188  448s
  2091  1881 51030.6648   22  197 41573.5799 57200.8686  37.6%  2242  459s
  2208  1979 50739.8507   24  182 41573.5799 57200.8686  37.6%  2266  473s
  2320  2098 50523.7687   25  194 41573.5799 57200.8686  37.6%  2283  482s
  2499  2197 49659.1376   26  181 41573.5799 56945.6959  37.0%  2248  494s
  2684  2295 48303.0571   28  200 41573.5799 56945.6959  37.0%  2226  507s
  2826  2399 47995.9454   29  200 41573.5799 56945.6959  37.0%  2255  521s
  2982  2505 46698.2786   30  189 41573.5799 56444.0395  35.8%  2269  533s
  3118  2645 47243.7196   30  191 41573.5799 56444.0395  35.8%  2304  545s
  3313  2784 44215.3689   34  120 41573.5799 56317.9880  35.5%  2297  556s
  3475  2785 47182.8386   34  426 41573.5799 56317.9880  35.5%  2309  634s
  3477  2786 44783.2553   38   83 41573.5799 56317.9880  35.5%  2307  657s
  3478  2787 45331.0011   45  287 41573.5799 56317.9880  35.5%  2307  672s
  3479  2788 45895.1190   33  364 41573.5799 56317.9880  35.5%  2306  679s
  3480  2788 54006.2221   15  394 41573.5799 56317.9880  35.5%  2305  683s
  3481  2789 55867.4045    6  416 41573.5799 56317.9880  35.5%  2305  685s
  3483  2790 50158.4565   12  423 41573.5799 56317.9880  35.5%  2303  690s
  3488  2794 46274.6156   50  367 41573.5799 56317.9880  35.5%  2300  697s
  3492  2796 50543.3433   26  427 41573.5799 56317.9880  35.5%  2297  701s
  3494  2798 44788.7468   38  382 41573.5799 56317.9880  35.5%  2296  707s
  3495  2798 50604.5271   25  379 41573.5799 56317.9880  35.5%  2295  711s
  3497  2800 51776.8668   13  404 41573.5799 56317.9880  35.5%  2294  716s
  3499  2801 54118.7438    8  404 41573.5799 56317.9880  35.5%  2293  721s
  3501  2802 50530.3034   27  377 41573.5799 56317.9880  35.5%  2291  726s
  3503  2804 53649.8490   10  385 41573.5799 56317.9880  35.5%  2290  730s
  3505  2805 54592.3091   14  337 41573.5799 56317.9880  35.5%  2289  736s
  3507  2806 48938.5510   33  395 41573.5799 56317.9880  35.5%  2287  740s
  3510  2808 47464.1958   32  390 41573.5799 56317.9880  35.5%  2286  767s
  3511  2809 52137.6776   23  390 41573.5799 56317.9880  35.5%  2285  778s
  3512  2813 56317.9880   13  373 41573.5799 56317.9880  35.5%  2309  789s
  3514  2816 56317.9880   14  361 41573.5799 56317.9880  35.5%  2310  798s
  3518  2823 56317.9880   15  358 41573.5799 56317.9880  35.5%  2310  808s
  3526  2836 56317.9880   16  369 41573.5799 56317.9880  35.5%  2314  818s
  3542  2854 55447.6322   17  344 41573.5799 56317.9880  35.5%  2338  838s
  3565  2878 54588.0741   18  366 41573.5799 56317.9880  35.5%  2365  853s
  3597  2903 54564.9827   19  356 41573.5799 56317.9880  35.5%  2404  865s
  3633  2927 54301.9800   20  351 41573.5799 56317.9880  35.5%  2400  876s
  3669  2957 53761.6204   20  281 41573.5799 56317.9880  35.5%  2397  890s
H 3675  2813                    41786.707564 56317.9880  34.8%  2401  890s
  3711  2912 54170.4771   21  302 41786.7076 56317.9880  34.8%  2406  903s
H 3751  2765                    41913.305918 56317.9880  34.4%  2417  903s
  3823  2821 51451.4707   21  251 41913.3059 56317.9880  34.4%  2410  915s
H 3909  2729                    42013.589109 56317.9880  34.0%  2428  934s
H 3946  2596                    42132.665693 56317.9880  33.7%  2443  934s
H 3956  2478                    42148.781449 56317.9880  33.6%  2445  934s
  3996  2512 52014.8429   22  339 42148.7814 56199.9441  33.3%  2444  947s
  4077  2512 53312.0079   22  327 42148.7814 56189.2863  33.3%  2468  961s
H 4111  2392                    42177.975609 56189.2863  33.2%  2488  961s
H 4142  2279                    42317.987917 56189.2863  32.8%  2496  961s
  4145  2323 52404.2573   22  312 42317.9879 56189.2863  32.8%  2500  973s
  4217  2330 51636.3020   22  277 42317.9879 56189.2863  32.8%  2526  985s
  4289  2354 51093.8156   22  326 42317.9879 56189.2863  32.8%  2534  999s
  4352  2361 52092.3416   24  289 42317.9879 56189.2863  32.8%  2566 1011s
  4384  2378 51761.5035   25  306 42317.9879 56189.2863  32.8%  2576 1019s
  4423  2393 50949.4465   26  299 42317.9879 56189.2863  32.8%  2583 1027s
H 4435  2290                    42581.219249 56189.2863  32.0%  2587 1027s
  4455  2325 50658.9237   27  297 42581.2192 56189.2863  32.0%  2589 1038s
  4537  2318 50637.6143   26  263 42581.2192 55497.7335  30.3%  2601 1049s
H 4562  2216                    42807.564320 55497.7335  29.6%  2612 1049s
  4580  2234 48775.3358   28  275 42807.5643 55497.7335  29.6%  2619 1061s
  4651  2234 49825.0792   28  263 42807.5643 55497.7335  29.6%  2625 1076s
  4736  2237 49132.8925   27  256 42807.5643 54922.8500  28.3%  2635 1090s
  4826  2254 47800.4943   28  243 42807.5643 54922.8500  28.3%  2664 1105s
  4903  2281 48888.5912   27  273 42807.5643 54922.8500  28.3%  2677 1117s
  4995  2307 48759.0234   28  300 42807.5643 54579.8567  27.5%  2689 1131s
  5102  2315 48703.1489   28  247 42807.5643 54579.8567  27.5%  2686 1147s
  5221  2312 48633.3594   29  253 42807.5643 54579.8567  27.5%  2688 1163s
  5349  2312 48478.1627   30  210 42807.5643 53983.2497  26.1%  2700 1178s
  5455  2333 43655.6955   31  221 42807.5643 53960.2483  26.1%  2717 1195s
  5583  2307     cutoff   29      42807.5643 53960.2483  26.1%  2742 1209s
  5697  2293     cutoff   32      42807.5643 53791.8151  25.7%  2746 1224s
  5790  2303 50882.6412   20  221 42807.5643 53791.8151  25.7%  2762 1240s
  5933  2323 48289.3449   23  315 42807.5643 53551.7307  25.1%  2774 1254s
  6060  2328 48017.8314   25  272 42807.5643 53519.0880  25.0%  2791 1275s
  6238  2315 43731.1039   33  117 42807.5643 53447.2362  24.9%  2793 1293s
  6402  2289 48733.1723   26  228 42807.5643 52937.8239  23.7%  2809 1313s
  6577  2307 46634.4569   29  191 42807.5643 52898.0279  23.6%  2829 1335s
  6775  2279     cutoff   35      42807.5643 52898.0279  23.6%  2844 1353s
  6966  2265 45665.1627   23  246 42807.5643 52788.4029  23.3%  2867 1372s
  7117  2302 44707.5772   24  275 42807.5643 52465.0704  22.6%  2900 1395s
  7345  2286 49706.7609   22  302 42807.5643 52356.2923  22.3%  2911 1416s
  7522  2247     cutoff   23      42807.5643 52145.7945  21.8%  2949 1437s
  7603  2276 46910.8773   25  256 42807.5643 52145.7945  21.8%  2949 1462s
  7823  2276 44171.1047   23  286 42807.5643 52145.7945  21.8%  2954 1484s
  8069  2235 43350.3673   28  204 42807.5643 52054.8141  21.6%  2971 1507s
  8353  2223     cutoff   25      42807.5643 51759.1870  20.9%  2981 1534s
  8644  2191     cutoff   28      42807.5643 51759.1870  20.9%  2991 1558s
  8955  2214 45594.7691   27  257 42807.5643 51577.5132  20.5%  2994 1585s
  9246  2317     cutoff   29      42807.5643 51527.9626  20.4%  3018 1613s
  9591  2362 45669.3118   28  283 42807.5643 51312.1816  19.9%  3020 1639s
  9988  2367 infeasible   33      42807.5643 51275.7327  19.8%  3010 1667s
 10263  2421 45584.2743   26  286 42807.5643 51035.8650  19.2%  3019 1697s
 10603  2503 47007.1701   24  277 42807.5643 50745.8134  18.5%  3039 1727s
 11047  2555 43240.0606   30  138 42807.5643 50732.5386  18.5%  3028 1762s
 11477  2576 46228.2658   29  209 42807.5643 50412.2945  17.8%  3032 1795s
 11878  2605     cutoff   32      42807.5643 50087.9729  17.0%  3049 1832s
 12372  2630     cutoff   25      42807.5643 49936.6947  16.7%  3049 1871s
 12782  2670 43153.0307   25  242 42807.5643 49769.1556  16.3%  3070 1910s
 13186  2679 43503.3693   31  228 42807.5643 49735.9850  16.2%  3074 1946s
 13695  2754     cutoff   27      42807.5643 49551.7796  15.8%  3077 1984s
 14205  2778     cutoff   30      42807.5643 49314.7201  15.2%  3082 2026s
 14767  2791 43201.7437   29  289 42807.5643 49151.0585  14.8%  3083 2069s
 15290  2803     cutoff   25      42807.5643 49056.5412  14.6%  3099 2115s
 15857  2809     cutoff   26      42807.5643 48810.7293  14.0%  3104 2161s
 16482  2847 46378.3616   25  311 42807.5643 48646.1162  13.6%  3109 2203s
 17173  2876 44749.8394   31  206 42807.5643 48469.9546  13.2%  3097 2248s
 17932  2876 44499.9785   30  209 42807.5643 48302.5280  12.8%  3082 2295s
 18618  2881 44103.1090   28  168 42807.5643 48085.7689  12.3%  3080 2343s
 18746  2852     cutoff   29      42807.5643 48037.5653  12.2%  3081 2394s
 19321  2820 45018.1449   25  293 42807.5643 47883.0580  11.9%  3082 2446s
 20149  2716     cutoff   24      42807.5643 47652.9939  11.3%  3076 2499s
 21025  2597 43743.9007   32  213 42807.5643 47418.9285  10.8%  3069 2555s
 21909  2469 43862.9289   26  338 42807.5643 47175.3745  10.2%  3063 2615s
 22863  2258 43216.9578   29  202 42807.5643 46916.7029  9.60%  3050 2673s
 23977  2003 44342.2722   27  282 42807.5643 46568.0553  8.78%  3022 2734s
 25093  1565     cutoff   31      42807.5643 46231.7126  8.00%  3000 2793s
 26433   508 43647.9852   31  102 42807.5643 45882.1298  7.18%  2959 2852s
 28359     0     cutoff   29      42807.5643 45064.7118  5.27%  2858 2873s

Cutting planes:
  Learned: 2
  MIR: 681
  Mixing: 1
  Flow cover: 1170
  RLT: 8
  Relax-and-lift: 101

Explored 29181 nodes (81671232 simplex iterations) in 2873.99 seconds (5633.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 42807.6 42581.2 42318 ... 41573.6

Optimal solution found (tolerance 1.00e-06)
Best objective 4.280756431990e+04, best bound 4.280756431990e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2874.00s
  Master Objective (UB) = 42807.56, θ = 205641.39
  Upper Bound (UB) = 42807.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205641.39
  [DEBUG]   ✓ Scenario 0: θ = 205641.39 ≤ Q = 205641.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205641.39 ≤ Q = 205641.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205641.39 ≤ Q = 205641.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205641.39 ≤ Q = 205641.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205641.39 ≤ Q = 205641.39 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3104d2a9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3104d2a9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.363527e+13
Presolve removed 2598 rows and 1889 columns
Presolve time: 0.01s
Presolved: 495 rows, 500 columns, 1396 nonzeros
Found heuristic solution: objective 6178243.1238
Variable types: 340 continuous, 160 integer (160 binary)

Root relaxation: objective -1.986288e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -198628.79    0  128 6178243.12 -198628.79   103%     -    0s
H    0     0                    -161582.0695 -198628.79  22.9%     -    0s
H    0     0                    -163083.8004 -198628.79  21.8%     -    0s
     0     0 -173884.76    0   46 -163083.80 -173884.76  6.62%     -    0s
H    0     0                    -171684.8080 -173854.62  1.26%     -    0s
H    0     0                    -171949.0127 -173854.62  1.11%     -    0s
H    0     0                    -172485.6496 -173854.62  0.79%     -    0s
H    0     0                    -172749.8544 -173854.62  0.64%     -    0s
     0     0 -173682.25    0   46 -172749.85 -173682.25  0.54%     -    0s
H    0     0                    -172751.8575 -173682.25  0.54%     -    0s
     0     0 -173512.94    0   13 -172751.86 -173512.94  0.44%     -    0s
H    0     0                    -172828.2827 -173496.58  0.39%     -    0s
H    0     0                    -173161.4572 -173496.58  0.19%     -    0s
     0     0 -173486.63    0   14 -173161.46 -173486.63  0.19%     -    0s
     0     0 -173435.54    0   10 -173161.46 -173435.54  0.16%     -    0s
     0     0 -173435.54    0   52 -173161.46 -173435.54  0.16%     -    0s
H    0     0                    -173166.2238 -173435.54  0.16%     -    0s
     0     0 -173360.10    0   16 -173166.22 -173360.10  0.11%     -    0s
     0     0 -173296.63    0    9 -173166.22 -173296.63  0.08%     -    0s
     0     0 -173296.62    0   10 -173166.22 -173296.62  0.08%     -    0s
*    0     0               0    -173280.6313 -173280.63  0.00%     -    0s

Cutting planes:
  Gomory: 18
  Implied bound: 9
  MIR: 37
  Flow cover: 8
  Relax-and-lift: 11

Explored 1 nodes (674 simplex iterations) in 0.12 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -173281 -173166 -173161 ... -161582
No other solutions better than -173281

Optimal solution found (tolerance 1.00e-06)
Best objective -1.732806312902e+05, best bound -1.732806312902e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 195766.35
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -173280.63
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -173280.63 = 195766.35
  [DEBUG]   Current θ from Master = 205641.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9875.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32932.52
  Lower Bound (LB) = 38461.23
  Gap (UB-LB) = 4346.3320, Absolute Gap = 4346.3320, Relative Gap = 0.101532
  Not converged yet (gap = 4346.33 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0xb25cb342
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 1.38s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -173969.7691

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23621   -3.7777237e+04   0.000000e+00   1.700121e+07      5s
   36294    2.2181924e+04   0.000000e+00   4.826124e+06     10s
   44711    2.7823255e+04   0.000000e+00   3.563214e+07     15s
   53205    4.5393773e+04   0.000000e+00   3.438745e+07     20s
   61746    5.8322353e+04   0.000000e+00   5.536614e+07     25s
Concurrent spin time: 0.99s

Solved with dual simplex

Root relaxation: objective 7.340489e+04, 37596 iterations, 25.48 seconds (31.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 73404.8897    0   87 -173969.77 73404.8897   142%     -   27s
H    0     0                    -170163.7446 73404.8897   143%     -   27s
H    0     0                    -130001.6669 73404.8897   156%     -   27s
H    0     0                    -77209.21491 73404.8897   195%     -   27s
H    0     0                    -50450.17087 73404.8897   245%     -   27s
H    0     0                    -45739.81386 73404.8897   260%     -   27s
H    0     0                    -45736.45871 73404.8897   260%     -   27s
H    0     0                    11917.849517 73404.8897   516%     -   27s
H    0     0                    16838.477690 73404.8897   336%     -   27s
H    0     0                    24804.412430 73404.8897   196%     -   28s
H    0     0                    25389.435683 73404.8897   189%     -   28s
H    0     0                    29050.920504 73404.8897   153%     -   28s
H    0     0                    29135.246920 73404.8897   152%     -   28s
H    0     0                    29173.514605 73404.8897   152%     -   28s
H    0     0                    29199.769394 73404.8897   151%     -   28s
H    0     0                    29361.874740 73404.8897   150%     -   29s
H    0     0                    29419.499480 73404.8897   150%     -   29s
H    0     0                    34337.062874 68028.7456  98.1%     -   38s
     0     0 68028.7456    0  122 34337.0629 68028.7456  98.1%     -   38s
H    0     0                    34483.021169 68028.4138  97.3%     -   39s
H    0     0                    35015.637788 68028.4138  94.3%     -   39s
     0     0 67077.9380    0  143 35015.6378 67077.9380  91.6%     -   43s
     0     0 67024.6452    0  139 35015.6378 67024.6452  91.4%     -   47s
     0     0 67024.6452    0  135 35015.6378 67024.6452  91.4%     -   48s
     0     0 67024.6452    0  145 35015.6378 67024.6452  91.4%     -   49s
     0     0 67024.6452    0  146 35015.6378 67024.6452  91.4%     -   49s
     0     0 67024.6452    0  146 35015.6378 67024.6452  91.4%     -   50s
     0     0 63872.7174    0  265 35015.6378 63872.7174  82.4%     -   61s
H    0     0                    35397.432301 63872.7174  80.4%     -   61s
H    0     0                    35537.556680 63872.7174  79.7%     -   61s
H    0     0                    35550.708756 63872.7174  79.7%     -   61s
H    0     0                    35746.317556 63872.7174  78.7%     -   61s
H    0     0                    35759.113197 63872.7174  78.6%     -   61s
H    0     0                    35824.305610 63872.7174  78.3%     -   61s
     0     0 63332.9068    0  279 35824.3056 63332.9068  76.8%     -   66s
     0     0 63008.4860    0  280 35824.3056 63008.4860  75.9%     -   71s
     0     0 62948.3246    0  274 35824.3056 62948.3246  75.7%     -   73s
     0     0 62944.2098    0  257 35824.3056 62944.2098  75.7%     -   73s
     0     0 62941.7372    0  274 35824.3056 62941.7372  75.7%     -   73s
     0     0 62940.8027    0  276 35824.3056 62940.8027  75.7%     -   74s
H    0     0                    36173.865784 61417.2499  69.8%     -   90s
H    0     0                    36259.446763 61417.2499  69.4%     -   90s
     0     0 61417.2499    0  251 36259.4468 61417.2499  69.4%     -   90s
H    0     0                    36367.018253 61417.0711  68.9%     -   91s
H    0     0                    36533.230335 61417.0711  68.1%     -   91s
H    0     0                    36648.248839 61417.0711  67.6%     -   91s
H    0     0                    36834.318635 61417.0711  66.7%     -   91s
H    0     0                    36981.278496 61417.0711  66.1%     -   91s
H    0     0                    37075.968790 61110.5242  64.8%     -   97s
H    0     0                    37471.891215 61110.5242  63.1%     -   97s
     0     0 61110.5242    0  321 37471.8912 61110.5242  63.1%     -   97s
H    0     0                    37728.236195 60978.1587  61.6%     -  101s
H    0     0                    37929.515733 60978.1587  60.8%     -  101s
     0     0 60978.1587    0  322 37929.5157 60978.1587  60.8%     -  101s
     0     0 60844.7849    0  317 37929.5157 60844.7849  60.4%     -  104s
     0     0 60794.5327    0  287 37929.5157 60794.5327  60.3%     -  107s
     0     0 60752.6997    0  323 37929.5157 60752.6997  60.2%     -  109s
     0     0 60728.8654    0  286 37929.5157 60728.8654  60.1%     -  112s
     0     0 60722.9202    0  284 37929.5157 60722.9202  60.1%     -  113s
     0     0 60716.5686    0  293 37929.5157 60716.5686  60.1%     -  114s
     0     0 60715.6426    0  291 37929.5157 60715.6426  60.1%     -  115s
H    0     0                    39532.283061 60003.1542  51.8%     -  133s
     0     0 60003.1542    0  347 39532.2831 60003.1542  51.8%     -  133s
H    0     0                    39612.880420 59766.4638  50.9%     -  139s
H    0     0                    39615.074972 59766.4638  50.9%     -  139s
H    0     0                    39670.788982 59766.4638  50.7%     -  139s
     0     0 59766.4638    0  357 39670.7890 59766.4638  50.7%     -  139s
     0     0 59602.1170    0  350 39670.7890 59602.1170  50.2%     -  143s
     0     0 59545.8871    0  355 39670.7890 59545.8871  50.1%     -  146s
     0     0 59514.5935    0  362 39670.7890 59514.5935  50.0%     -  148s
     0     0 59486.2205    0  363 39670.7890 59486.2205  49.9%     -  149s
     0     0 59469.1942    0  354 39670.7890 59469.1942  49.9%     -  150s
     0     0 59418.9083    0  365 39670.7890 59418.9083  49.8%     -  153s
     0     0 59408.5344    0  364 39670.7890 59408.5344  49.8%     -  154s
     0     0 59402.9131    0  366 39670.7890 59402.9131  49.7%     -  154s
     0     0 59400.9542    0  367 39670.7890 59400.9542  49.7%     -  155s
     0     0 59398.5869    0  371 39670.7890 59398.5869  49.7%     -  155s
     0     0 59391.5022    0  366 39670.7890 59391.5022  49.7%     -  156s
     0     0 59388.3081    0  362 39670.7890 59388.3081  49.7%     -  156s
     0     0 59387.0789    0  362 39670.7890 59387.0789  49.7%     -  156s
     0     0 59130.7200    0  360 39670.7890 59130.7200  49.1%     -  162s
H    0     0                    39672.435993 59130.5596  49.0%     -  163s
H    0     0                    41097.181187 59130.5596  43.9%     -  163s
H    0     0                    41143.570288 59130.5596  43.7%     -  163s
H    0     0                    41285.846751 59130.5596  43.2%     -  163s
     0     0 59070.8283    0  364 41285.8468 59070.8283  43.1%     -  165s
     0     0 59037.7099    0  358 41285.8468 59037.7099  43.0%     -  166s
     0     0 59002.8207    0  361 41285.8468 59002.8207  42.9%     -  167s
     0     0 58990.6819    0  371 41285.8468 58990.6819  42.9%     -  168s
     0     0 58979.6807    0  373 41285.8468 58979.6807  42.9%     -  169s
     0     0 58972.2548    0  378 41285.8468 58972.2548  42.8%     -  169s
     0     0 58970.0898    0  375 41285.8468 58970.0898  42.8%     -  170s
     0     0 58966.7829    0  369 41285.8468 58966.7829  42.8%     -  171s
     0     0 58964.7993    0  375 41285.8468 58964.7993  42.8%     -  171s
     0     0 58964.5719    0  375 41285.8468 58964.5719  42.8%     -  171s
     0     0 58882.6265    0  400 41285.8468 58882.6265  42.6%     -  175s
     0     0 58873.6511    0  395 41285.8468 58873.6511  42.6%     -  177s
     0     0 58870.0093    0  402 41285.8468 58870.0093  42.6%     -  178s
     0     0 58868.5621    0  396 41285.8468 58868.5621  42.6%     -  178s
     0     0 58829.7124    0  379 41285.8468 58829.7124  42.5%     -  181s
     0     0 58822.0266    0  381 41285.8468 58822.0266  42.5%     -  183s
     0     0 58818.9944    0  380 41285.8468 58818.9944  42.5%     -  184s
     0     0 58817.4154    0  376 41285.8468 58817.4154  42.5%     -  185s
     0     0 58794.7252    0  367 41285.8468 58794.7252  42.4%     -  187s
     0     0 58787.2639    0  376 41285.8468 58787.2639  42.4%     -  190s
     0     0 58784.8678    0  380 41285.8468 58784.8678  42.4%     -  190s
     0     0 58784.0256    0  381 41285.8468 58784.0256  42.4%     -  191s
     0     0 58761.0334    0  374 41285.8468 58761.0334  42.3%     -  194s
H    0     0                    41311.429815 58760.9787  42.2%     -  195s
     0     0 58755.9360    0  377 41311.4298 58755.9360  42.2%     -  196s
     0     0 58749.3472    0  382 41311.4298 58749.3472  42.2%     -  197s
     0     0 58747.0591    0  380 41311.4298 58747.0591  42.2%     -  198s
     0     0 58746.1912    0  378 41311.4298 58746.1912  42.2%     -  198s
     0     0 58727.2333    0  428 41311.4298 58727.2333  42.2%     -  201s
     0     0 58704.1428    0  422 41311.4298 58704.1428  42.1%     -  204s
     0     0 58696.1790    0  423 41311.4298 58696.1790  42.1%     -  205s
     0     0 58692.0612    0  424 41311.4298 58692.0612  42.1%     -  207s
     0     0 58690.0755    0  434 41311.4298 58690.0755  42.1%     -  208s
     0     0 58688.4684    0  430 41311.4298 58688.4684  42.1%     -  209s
     0     0 58673.0464    0  428 41311.4298 58673.0464  42.0%     -  211s
H    0     0                    41367.104536 58673.0176  41.8%     -  211s
     0     0 58668.6048    0  389 41367.1045 58668.6048  41.8%     -  212s
     0     0 58663.5784    0  393 41367.1045 58663.5784  41.8%     -  214s
     0     0 58662.2295    0  395 41367.1045 58662.2295  41.8%     -  214s
     0     0 58655.2153    0  397 41367.1045 58655.2153  41.8%     -  217s
H    0     0                    41368.800898 58654.6849  41.8%     -  227s
     0     0 58650.8933    0  392 41368.8009 58650.8933  41.8%     -  229s
     0     0 58649.7907    0  396 41368.8009 58649.7907  41.8%     -  230s
     0     0 58646.3519    0  392 41368.8009 58646.3519  41.8%     -  232s
H    0     0                    41462.596064 58646.2959  41.4%     -  233s
     0     0 58645.3595    0  392 41462.5961 58645.3595  41.4%     -  233s
     0     0 58643.8665    0  395 41462.5961 58643.8665  41.4%     -  234s
     0     0 58643.5530    0  395 41462.5961 58643.5530  41.4%     -  235s
H    0     0                    41573.579926 58643.5434  41.1%     -  285s
     0     2 58643.5434    0  395 41573.5799 58643.5434  41.1%     -  286s
     1     3 58211.8803    1  288 41573.5799 58643.5434  41.1%  8292  294s
     2     5 57769.5778    2  356 41573.5799 58643.5434  41.1%  8886  304s
     4    10 56750.4303    2  355 41573.5799 58210.0623  40.0%  6528  312s
     9    20 56237.2865    3  360 41573.5799 57735.9147  38.9%  5493  325s
    19    40 55893.9665    4  364 41573.5799 57671.1559  38.7%  5054  338s
    39    56 54447.4209    6  271 41573.5799 57487.7836  38.3%  7192  358s
    55    88 55565.0064    6  379 41573.5799 57487.7836  38.3%  7015  370s
    87   152 55336.1864    7  361 41573.5799 57487.7836  38.3%  5524  399s
   151   184 55074.6239    9  294 41573.5799 57487.7836  38.3%  3990  408s
   183   229 54763.1736   10  292 41573.5799 57487.7836  38.3%  3522  419s
   228   345 54689.1969   11  284 41573.5799 57487.7836  38.3%  3102  432s
   344   426 53990.2236   13  352 41573.5799 57487.7836  38.3%  2659  444s
   425   529 53653.3036   15  301 41573.5799 57487.7836  38.3%  2615  454s
   528   636 49243.8265   17  188 41573.5799 57487.7836  38.3%  2425  461s
   635   745 48363.9035   18  189 41573.5799 57487.7836  38.3%  2222  471s
   744   845 47922.0258   21  162 41573.5799 57487.7836  38.3%  2071  478s
   852   952 46477.7314   26  131 41573.5799 57487.7836  38.3%  1960  489s
   975  1071 44776.7967   32  101 41573.5799 57487.7836  38.3%  1844  495s
  1110  1173 42447.4865   37   85 41573.5799 57487.7836  38.3%  1721  505s
  1252  1289     cutoff   39      41573.5799 57487.7836  38.3%  1621  517s
  1402  1359 46004.8270   14  274 41573.5799 57487.7836  38.3%  1543  528s
  1526  1423 45619.5527   15  271 41573.5799 57487.7836  38.3%  1510  540s
  1628  1469 45431.5952   18  255 41573.5799 57487.7836  38.3%  1510  549s
  1722  1544 44679.1318   23  269 41573.5799 57487.7836  38.3%  1524  560s
  1803  1633 44528.6664   28  266 41573.5799 57487.7836  38.3%  1543  570s
  1916  1727 43363.1137   31  193 41573.5799 57487.7836  38.3%  1535  582s
  2034  1832 42570.1115   35  177 41573.5799 57487.7836  38.3%  1534  591s
  2185  1925     cutoff   39      41573.5799 57487.7836  38.3%  1512  604s
  2330  2019 55079.6713    9  368 41573.5799 57487.7836  38.3%  1496  618s
  2450  2134 54228.3936   11  346 41573.5799 57107.8250  37.4%  1510  629s
  2593  2250 53777.6734   16  330 41573.5799 57107.8250  37.4%  1502  643s
  2723  2277 52793.2543   19  254 41573.5799 57107.8250  37.4%  1506  655s
  2758  2310 52504.2419   20  307 41573.5799 57107.8250  37.4%  1519  665s
  2793  2347 52322.2293   21  303 41573.5799 56863.2492  36.8%  1532  678s
  2836  2392 52234.9311   22  261 41573.5799 56863.2492  36.8%  1549  687s
  2885  2457 51590.0687   23  240 41573.5799 56863.2492  36.8%  1553  698s
  2956  2541 50842.9841   24  283 41573.5799 56647.0026  36.3%  1549  708s
  3056  2658 50237.3443   26  241 41573.5799 56647.0026  36.3%  1545  717s
  3209  2776 49245.8425   32  246 41573.5799 56647.0026  36.3%  1514  728s
  3380  2777 42905.1071   31  395 41573.5799 56432.4283  35.7%  1489  783s
  3382  2778 48223.6520   43   87 41573.5799 56432.4283  35.7%  1488  812s
  3383  2779 52261.0693   12  303 41573.5799 56432.4283  35.7%  1488  829s
  3384  2780 44804.8188   83  323 41573.5799 56432.4283  35.7%  1487  838s
  3385  2780 52782.0598   19  389 41573.5799 56432.4283  35.7%  1487  845s
  3386  2781 43446.4452   69  362 41573.5799 56432.4283  35.7%  1487  851s
  3387  2782 49974.2843   25  379 41573.5799 56432.4283  35.7%  1486  856s
  3388  2782 55418.9183   13  383 41573.5799 56432.4283  35.7%  1486  860s
  3390  2784 55418.1037    9  391 41573.5799 56432.4283  35.7%  1485  866s
  3392  2785 46656.6038   34  425 41573.5799 56432.4283  35.7%  1484  870s
  3394  2786 55225.0452    9  393 41573.5799 56432.4283  35.7%  1483  877s
  3395  2787 54477.6203    6  399 41573.5799 56432.4283  35.7%  1483  880s
  3397  2788 46427.2554   73  335 41573.5799 56432.4283  35.7%  1482  885s
  3399  2790 43691.5892   65  392 41573.5799 56432.4283  35.7%  1481  891s
  3401  2791 51231.0492   22  391 41573.5799 56432.4283  35.7%  1480  896s
  3403  2792 48717.4710   38  396 41573.5799 56432.4283  35.7%  1479  904s
  3404  2793 44183.1470   61  387 41573.5799 56432.4283  35.7%  1479  905s
  3406  2794 54239.6005   10  391 41573.5799 56432.4283  35.7%  1478  910s
  3407  2795 52899.9241   13  397 41573.5799 56432.4283  35.7%  1477  915s
  3410  2797 54070.0341   11  391 41573.5799 56432.4283  35.7%  1476  948s
  3411  2798 55433.5074   12  391 41573.5799 56432.4283  35.7%  1476  972s
  3412  2801 56432.4283   12  387 41573.5799 56432.4283  35.7%  1510  987s
  3414  2805 56432.4283   13  329 41573.5799 56432.4283  35.7%  1512 1001s
  3418  2811 56432.4283   14  326 41573.5799 56432.4283  35.7%  1515 1015s
  3426  2825 56432.4283   15  328 41573.5799 56432.4283  35.7%  1527 1040s
  3442  2837 54119.3872   16  306 41573.5799 56432.4283  35.7%  1571 1074s
  3460  2863 55740.8734   17  367 41573.5799 56432.4283  35.7%  1602 1099s
  3492  2961 54975.1908   18  361 41573.5799 56432.4283  35.7%  1642 1123s
  3600  3005 53909.1162   22  294 41573.5799 56432.4283  35.7%  1713 1137s
  3680  3065 53951.0453   21  301 41573.5799 56432.4283  35.7%  1752 1151s
  3770  3103 53463.8123   20  366 41573.5799 56432.4283  35.7%  1779 1165s
  3854  3133 53175.8541   23  354 41573.5799 56432.4283  35.7%  1802 1180s
  3927  3137 53258.1472   23  278 41573.5799 56432.4283  35.7%  1821 1192s
  3962  3158 53180.3661   23  301 41573.5799 56432.4283  35.7%  1845 1203s
  3999  3174 53649.8679   22  295 41573.5799 56432.4283  35.7%  1876 1215s
  4033  3193 50473.5421   23  267 41573.5799 56432.4283  35.7%  1887 1228s
  4069  3208 52615.3025   22  346 41573.5799 56432.4283  35.7%  1896 1241s
  4106  3229 53508.4270   23  290 41573.5799 56432.4283  35.7%  1903 1254s
  4152  3237 53079.9059   24  301 41573.5799 56432.4283  35.7%  1905 1275s
  4206  3244 51933.1624   25  324 41573.5799 56432.4283  35.7%  1911 1290s
  4259  3247 50258.0165   25  250 41573.5799 56432.4283  35.7%  1923 1310s
  4314  3251 51583.0049   26  321 41573.5799 56432.4283  35.7%  1951 1325s
  4367  3273 51098.5009   27  318 41573.5799 56432.4283  35.7%  1972 1344s
H 4410  3118                    41578.926338 56432.4283  35.7%  1985 1344s
  4437  3151 50879.7966   26  333 41578.9263 56432.4283  35.7%  1989 1364s
  4547  3155 49925.8491   26  274 41578.9263 56432.4283  35.7%  2006 1380s
  4637  3156 50365.7976   27  311 41578.9263 56432.4283  35.7%  2031 1400s
  4734  3169 49907.7117   28  331 41578.9263 56432.4283  35.7%  2071 1415s
  4827  3175 45412.3627   28  295 41578.9263 56432.4283  35.7%  2109 1431s
  4922  3186 48982.4981   28  311 41578.9263 56432.4283  35.7%  2153 1450s
  4998  3207 47240.1559   29  321 41578.9263 55730.5838  34.0%  2189 1467s
  5080  3231 48307.0508   30  296 41578.9263 55730.5838  34.0%  2219 1488s
  5181  3247 46255.7061   33  197 41578.9263 55730.5838  34.0%  2251 1513s
  5293  3268 44050.8293   34  225 41578.9263 55730.5838  34.0%  2292 1532s
  5419  3267 44935.3460   34  193 41578.9263 55142.1079  32.6%  2326 1552s
  5543  3297 43962.1368   36  187 41578.9263 55142.1079  32.6%  2368 1570s
  5654  3313     cutoff   37      41578.9263 55142.1079  32.6%  2404 1593s
  5762  3352 44202.9950   18  281 41578.9263 55142.1079  32.6%  2444 1615s
  5889  3331 43234.1630   21  260 41578.9263 54746.1599  31.7%  2484 1630s
H 5893  3196                    42134.750163 54746.1599  29.9%  2486 1630s
H 5897  3068                    42173.639939 54746.1599  29.8%  2487 1630s
  5928  3080 43154.2049   22  265 42173.6399 54746.1599  29.8%  2496 1653s
  6092  3071 43451.0458   23  237 42173.6399 54385.5653  29.0%  2528 1674s
  6246  3102 53622.1765   19  368 42173.6399 54077.9479  28.2%  2565 1694s
  6410  3144 52740.3386   22  339 42173.6399 54077.9479  28.2%  2590 1718s
  6604  3117 50449.5181   26  311 42173.6399 54077.9479  28.2%  2603 1742s
  6811  3122 47475.5581   30  181 42173.6399 54077.9479  28.2%  2623 1770s
  6973  3119 45337.8854   35  193 42173.6399 53794.6622  27.6%  2660 1796s
H 6980  2993                    42239.264240 53794.6622  27.4%  2659 1796s
H 6984  2860                    42409.201317 53794.6622  26.8%  2660 1796s
  7074  2877 42842.8065   42  209 42409.2013 53648.2719  26.5%  2696 1824s
  7266  2882 47941.7394   24  271 42409.2013 53526.7303  26.2%  2750 1855s
  7447  2864 43238.1557   28  206 42409.2013 53460.9675  26.1%  2802 1888s
  7689  2879 47455.3120   22  280 42409.2013 53460.9675  26.1%  2839 1917s
  7906  2894 45160.8546   25  207 42409.2013 53175.3781  25.4%  2883 1950s
  8187  2854     cutoff   20      42409.2013 53077.1060  25.2%  2909 1982s
  8368  2849 50069.7796   26  333 42409.2013 52925.6713  24.8%  2941 2015s
  8639  2827 43970.8703   32  230 42409.2013 52807.2720  24.5%  2982 2050s
  8948  2801     cutoff   35      42409.2013 52739.3003  24.4%  3012 2085s
  9288  2725 47990.9197   24  314 42409.2013 52310.5539  23.3%  3031 2120s
  9350  2750 47691.7642   26  228 42409.2013 52310.5539  23.3%  3043 2156s
  9608  2746 42953.3559   18  285 42409.2013 52206.5182  23.1%  3049 2194s
  9977  2769 43765.0641   23  282 42409.2013 52087.8951  22.8%  3072 2234s
 10298  2882 43555.4818   23  281 42409.2013 52013.1624  22.6%  3108 2278s
 10633  3023 43375.4858   19  262 42409.2013 51790.5474  22.1%  3154 2319s
 11075  3148 46523.5356   24  294 42409.2013 51565.0411  21.6%  3174 2365s
 11474  3252 42732.8824   29  156 42409.2013 51413.5195  21.2%  3200 2411s
 11919  3408 46453.0154   28  266 42409.2013 51356.7009  21.1%  3209 2458s
 12381  3583 42601.1090   41  179 42409.2013 51102.7428  20.5%  3228 2507s
 12815  3741 45048.5396   29  220 42409.2013 51069.6427  20.4%  3261 2558s
 13320  3902 44018.7469   25  212 42409.2013 50982.7149  20.2%  3278 2608s
 13867  3968     cutoff   28      42409.2013 50797.7304  19.8%  3285 2662s
 14365  4087 45449.8656   23  286 42409.2013 50621.1108  19.4%  3289 2716s
 14871  4219 47953.1682   27  281 42409.2013 50585.0424  19.3%  3323 2776s
 15445  4435 46482.3726   31  331 42409.2013 50359.7331  18.7%  3345 2837s
*15604  4409              50    42615.031299 50359.7331  18.2%  3336 2837s
 16049  4579 42685.1152   25  266 42615.0313 50329.8200  18.1%  3364 2898s
 16729  4681 45487.5504   26  291 42615.0313 50233.3240  17.9%  3372 2962s
 17253  4812     cutoff   26      42615.0313 49996.5978  17.3%  3394 3025s
 17919  4975     cutoff   26      42615.0313 49869.8680  17.0%  3409 3093s
 18624  5162 45395.2931   27  242 42615.0313 49675.6870  16.6%  3422 3162s
 19335  5279     cutoff   24      42615.0313 49507.2406  16.2%  3442 3234s
 20152  5398     cutoff   31      42615.0313 49379.2234  15.9%  3446 3305s
 20935  5493 42952.9434   32  168 42615.0313 49219.3818  15.5%  3468 3383s
 21797  5647 45762.8222   27  291 42615.0313 49090.1325  15.2%  3465 3461s
 22663  5775 42649.0783   40  129 42615.0313 48958.0897  14.9%  3474 3539s
 23530  5848     cutoff   29      42615.0313 48813.5772  14.5%  3482 3600s

Cutting planes:
  Learned: 1
  MIR: 878
  Mixing: 1
  Flow cover: 1567
  RLT: 8
  Relax-and-lift: 92

Explored 24317 nodes (84900674 simplex iterations) in 3600.04 seconds (7104.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 42615 42409.2 42239.3 ... 41367.1

Time limit reached
Best objective 4.261503129914e+04, best bound 4.863358191859e+04, gap 14.1231%
  WARNING: Time limit reached. Using best solution found (gap: 14.12%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 42615.03, θ = 206187.56
  Upper Bound (UB) = 42615.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206187.56
  [DEBUG]   ✓ Scenario 0: θ = 206187.56 ≤ Q = 206187.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206187.56 ≤ Q = 206187.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206187.56 ≤ Q = 206187.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206187.56 ≤ Q = 206187.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206187.56 ≤ Q = 206187.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 206187.56 ≤ Q = 206187.56 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x638d52af
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9c72ad51
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-15, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-14, 2e+02]
Found heuristic solution: objective 1.363527e+13
Presolve removed 2598 rows and 1889 columns
Presolve time: 0.01s
Presolved: 495 rows, 500 columns, 1396 nonzeros
Found heuristic solution: objective 6190319.4844
Variable types: 340 continuous, 160 integer (160 binary)

Root relaxation: objective -1.941500e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194150.04    0  125 6190319.48 -194150.04   103%     -    0s
H    0     0                    -160246.3757 -194150.04  21.2%     -    0s
H    0     0                    -161324.4730 -194150.04  20.3%     -    0s
     0     0 -168849.91    0   59 -161324.47 -168849.91  4.66%     -    0s
H    0     0                    -164341.7752 -168730.33  2.67%     -    0s
H    0     0                    -164674.9497 -168730.33  2.46%     -    0s
H    0     0                    -165844.7539 -168730.33  1.74%     -    0s
H    0     0                    -166177.9285 -168730.33  1.54%     -    0s
     0     0 -167283.59    0   59 -166177.93 -167283.59  0.67%     -    0s
H    0     0                    -166199.0447 -167260.65  0.64%     -    0s
     0     0 -167251.93    0   59 -166199.04 -167251.93  0.63%     -    0s
     0     0 -167236.09    0   60 -166199.04 -167236.09  0.62%     -    0s
     0     0 -167021.00    0   29 -166199.04 -167021.00  0.49%     -    0s
H    0     0                    -166353.0685 -167008.69  0.39%     -    0s
H    0     0                    -166474.9332 -167008.69  0.32%     -    0s
     0     0 -166865.92    0   27 -166474.93 -166865.92  0.23%     -    0s
     0     0 -166864.49    0   28 -166474.93 -166864.49  0.23%     -    0s
     0     0 -166710.37    0   24 -166474.93 -166710.37  0.14%     -    0s
     0     0 -166662.13    0   20 -166474.93 -166662.13  0.11%     -    0s
     0     0 -166662.13    0   11 -166474.93 -166662.13  0.11%     -    0s
     0     0 -166611.41    0   12 -166474.93 -166611.41  0.08%     -    0s
     0     0 -166611.41    0   36 -166474.93 -166611.41  0.08%     -    0s
     0     0 -166517.72    0    3 -166474.93 -166517.72  0.03%     -    0s
*    0     0               0    -166514.0470 -166514.05  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 20
  Flow cover: 15
  Relax-and-lift: 2

Explored 1 nodes (810 simplex iterations) in 0.13 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -166514 -166475 -166353 ... 1.36353e+13
No other solutions better than -166514

Optimal solution found (tolerance 1.00e-06)
Best objective -1.665140470472e+05, best bound -1.665140470472e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 202532.93
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -166514.05
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -166514.05 = 202532.93
  [DEBUG]   Current θ from Master = 206187.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3654.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38960.40
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 3654.6295, Absolute Gap = 3654.6295, Relative Gap = 0.085759
  Not converged yet (gap = 3654.63 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0xd89ea98e
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 1.74s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -173969.7691

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22704   -1.2505061e+05   0.000000e+00   1.056289e+07      5s
   32522    7.4495228e+03   0.000000e+00   2.095836e+08     10s
   43035    5.0333756e+04   0.000000e+00   5.065440e+06     15s
   52049    5.5084769e+04   0.000000e+00   1.418823e+06     20s
   58580    5.8855503e+04   0.000000e+00   9.751418e+07     25s
Concurrent spin time: 2.29s

Solved with dual simplex

Root relaxation: objective 7.336818e+04, 41826 iterations, 26.10 seconds (33.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 73368.1798    0   83 -173969.77 73368.1798   142%     -   28s
H    0     0                    -168314.8447 73368.1798   144%     -   28s
H    0     0                    -99345.10511 73368.1798   174%     -   28s
H    0     0                    -80664.23384 73368.1798   191%     -   28s
H    0     0                    -80447.54353 73368.1798   191%     -   28s
H    0     0                    -57401.59107 73368.1798   228%     -   28s
H    0     0                    -57117.06605 73368.1798   228%     -   29s
H    0     0                    -31222.99964 73368.1798   335%     -   29s
H    0     0                    -24455.89387 73368.1798   400%     -   29s
H    0     0                    -24171.36886 73368.1798   404%     -   29s
H    0     0                    -17430.48670 73368.1798   521%     -   29s
H    0     0                    -17145.96168 73368.1798   528%     -   29s
H    0     0                    -3629.507766 73368.1798  2121%     -   29s
H    0     0                    25637.252675 73368.1798   186%     -   29s
H    0     0                    28535.889121 73368.1798   157%     -   30s
H    0     0                    29050.920504 73368.1798   153%     -   30s
H    0     0                    29135.246920 73368.1798   152%     -   30s
H    0     0                    30647.778233 73368.1798   139%     -   30s
H    0     0                    30924.383000 73368.1798   137%     -   30s
H    0     0                    30973.550785 73368.1798   137%     -   30s
H    0     0                    31363.935115 73368.1798   134%     -   30s
     0     0 68133.2047    0  119 31363.9351 68133.2047   117%     -   41s
H    0     0                    31935.554026 68132.7005   113%     -   42s
H    0     0                    36101.753550 68132.7005  88.7%     -   42s
H    0     0                    38185.007846 68132.7005  78.4%     -   42s
H    0     0                    38186.704208 68132.7005  78.4%     -   42s
     0     0 67407.3809    0  185 38186.7042 67407.3809  76.5%     -   48s
     0     0 67399.1307    0  193 38186.7042 67399.1307  76.5%     -   50s
     0     0 67399.1307    0  186 38186.7042 67399.1307  76.5%     -   51s
     0     0 67399.1307    0  188 38186.7042 67399.1307  76.5%     -   51s
     0     0 67399.1307    0  188 38186.7042 67399.1307  76.5%     -   52s
     0     0 67399.1307    0  188 38186.7042 67399.1307  76.5%     -   52s
     0     0 64291.4244    0  269 38186.7042 64291.4244  68.4%     -   64s
     0     0 63746.7967    0  275 38186.7042 63746.7967  66.9%     -   69s
     0     0 63536.2032    0  280 38186.7042 63536.2032  66.4%     -   75s
     0     0 63316.7823    0  271 38186.7042 63316.7823  65.8%     -   79s
     0     0 63240.5491    0  263 38186.7042 63240.5491  65.6%     -   82s
     0     0 63207.2998    0  271 38186.7042 63207.2998  65.5%     -   86s
     0     0 63168.2054    0  277 38186.7042 63168.2054  65.4%     -   89s
     0     0 63160.8307    0  277 38186.7042 63160.8307  65.4%     -   90s
     0     0 63160.1392    0  284 38186.7042 63160.1392  65.4%     -   91s
H    0     0                    38577.690055 63160.1392  63.7%     -   98s
H    0     0                    38640.126369 63160.1392  63.5%     -   98s
H    0     0                    38675.246022 63160.1392  63.3%     -   98s
H    0     0                    38681.024595 63160.1392  63.3%     -   98s
H    0     0                    38693.806738 63160.1392  63.2%     -   98s
H    0     0                    39080.594973 63160.1392  61.6%     -   98s
H    0     0                    39322.259657 63160.1392  60.6%     -   98s
H    0     0                    39770.560606 61631.2798  55.0%     -  110s
     0     0 61631.2798    0  280 39770.5606 61631.2798  55.0%     -  110s
H    0     0                    40496.350384 61631.1347  52.2%     -  111s
H    0     0                    40630.687290 61631.1347  51.7%     -  111s
     0     0 61388.7497    0  262 40630.6873 61388.7497  51.1%     -  116s
     0     0 61179.8234    0  322 40630.6873 61179.8234  50.6%     -  122s
     0     0 61008.0220    0  334 40630.6873 61008.0220  50.2%     -  128s
     0     0 60952.9910    0  335 40630.6873 60952.9910  50.0%     -  131s
     0     0 60916.8440    0  343 40630.6873 60916.8440  49.9%     -  133s
     0     0 60902.2284    0  340 40630.6873 60902.2284  49.9%     -  134s
     0     0 60894.4251    0  341 40630.6873 60894.4251  49.9%     -  135s
     0     0 60886.9959    0  338 40630.6873 60886.9959  49.9%     -  136s
     0     0 60884.8357    0  336 40630.6873 60884.8357  49.8%     -  137s
     0     0 60884.1586    0  338 40630.6873 60884.1586  49.8%     -  137s
H    0     0                    40738.484240 60339.0604  48.1%     -  152s
H    0     0                    40799.952360 60339.0604  47.9%     -  152s
H    0     0                    40801.648721 60339.0604  47.9%     -  152s
     0     0 60339.0604    0  359 40801.6487 60339.0604  47.9%     -  152s
     0     0 60000.2089    0  314 40801.6487 60000.2089  47.1%     -  160s
     0     0 59862.4570    0  358 40801.6487 59862.4570  46.7%     -  166s
     0     0 59777.0033    0  328 40801.6487 59777.0033  46.5%     -  170s
     0     0 59733.4373    0  330 40801.6487 59733.4373  46.4%     -  172s
H    0     0                    41170.917625 59672.1205  44.9%     -  176s
     0     0 59672.1205    0  324 41170.9176 59672.1205  44.9%     -  176s
     0     0 59642.4995    0  323 41170.9176 59642.4995  44.9%     -  179s
     0     0 59638.1877    0  325 41170.9176 59638.1877  44.9%     -  180s
     0     0 59620.9830    0  321 41170.9176 59620.9830  44.8%     -  182s
     0     0 59607.7980    0  373 41170.9176 59607.7980  44.8%     -  182s
     0     0 59606.5866    0  326 41170.9176 59606.5866  44.8%     -  183s
     0     0 59390.1579    0  363 41170.9176 59390.1579  44.3%     -  192s
H    0     0                    41197.981758 59390.1578  44.2%     -  193s
     0     0 59300.4719    0  361 41197.9818 59300.4719  43.9%     -  197s
     0     0 59276.5702    0  371 41197.9818 59276.5702  43.9%     -  199s
     0     0 59268.5319    0  373 41197.9818 59268.5319  43.9%     -  200s
     0     0 59214.2211    0  362 41197.9818 59214.2211  43.7%     -  202s
     0     0 59205.2309    0  369 41197.9818 59205.2309  43.7%     -  203s
     0     0 59202.4161    0  375 41197.9818 59202.4161  43.7%     -  203s
     0     0 59200.8782    0  360 41197.9818 59200.8782  43.7%     -  204s
     0     0 59072.9653    0  376 41197.9818 59072.9653  43.4%     -  210s
H    0     0                    41349.282408 59072.7800  42.9%     -  211s
H    0     0                    41507.517782 59072.7800  42.3%     -  211s
     0     0 59042.8181    0  390 41507.5178 59042.8181  42.2%     -  214s
     0     0 59020.6411    0  385 41507.5178 59020.6411  42.2%     -  217s
     0     0 59008.5280    0  392 41507.5178 59008.5280  42.2%     -  219s
     0     0 59007.3175    0  394 41507.5178 59007.3175  42.2%     -  219s
     0     0 58940.6109    0  328 41507.5178 58940.6109  42.0%     -  225s
H    0     0                    41516.644806 58940.4399  42.0%     -  226s
     0     0 58907.5974    0  375 41516.6448 58907.5974  41.9%     -  229s
     0     0 58890.6425    0  377 41516.6448 58890.6425  41.8%     -  231s
     0     0 58885.2862    0  372 41516.6448 58885.2862  41.8%     -  232s
     0     0 58882.4363    0  378 41516.6448 58882.4363  41.8%     -  233s
     0     0 58874.6578    0  374 41516.6448 58874.6578  41.8%     -  234s
     0     0 58873.6683    0  380 41516.6448 58873.6683  41.8%     -  234s
     0     0 58857.5523    0  389 41516.6448 58857.5523  41.8%     -  236s
     0     0 58846.0808    0  394 41516.6448 58846.0808  41.7%     -  239s
     0     0 58833.6789    0  391 41516.6448 58833.6789  41.7%     -  241s
     0     0 58831.3007    0  391 41516.6448 58831.3007  41.7%     -  241s
     0     0 58830.9907    0  388 41516.6448 58830.9907  41.7%     -  241s
     0     0 58788.4335    0  425 41516.6448 58788.4335  41.6%     -  244s
     0     0 58774.5914    0  396 41516.6448 58774.5914  41.6%     -  246s
     0     0 58770.0018    0  397 41516.6448 58770.0018  41.6%     -  247s
     0     0 58768.3566    0  400 41516.6448 58768.3566  41.6%     -  247s
     0     0 58727.6514    0  411 41516.6448 58727.6514  41.5%     -  251s
     0     0 58703.1347    0  417 41516.6448 58703.1347  41.4%     -  254s
     0     0 58688.8502    0  424 41516.6448 58688.8502  41.4%     -  255s
     0     0 58682.0848    0  414 41516.6448 58682.0848  41.3%     -  256s
     0     0 58680.7037    0  413 41516.6448 58680.7037  41.3%     -  257s
     0     0 58643.5929    0  333 41516.6448 58643.5929  41.3%     -  261s
     0     0 58626.7395    0  346 41516.6448 58626.7395  41.2%     -  265s
     0     0 58625.1171    0  346 41516.6448 58625.1171  41.2%     -  265s
     0     0 58614.4170    0  398 41516.6448 58614.4170  41.2%     -  267s
     0     0 58612.7230    0  343 41516.6448 58612.7230  41.2%     -  270s
     0     0 58610.3159    0  393 41516.6448 58610.3159  41.2%     -  272s
     0     0 58609.7939    0  388 41516.6448 58609.7939  41.2%     -  272s
     0     0 58609.3094    0  347 41516.6448 58609.3094  41.2%     -  273s
H    0     0                    41573.579926 58608.2111  41.0%     -  312s
     0     0 58608.2111    0  349 41573.5799 58608.2111  41.0%     -  317s
     0     0 58607.3220    0  350 41573.5799 58607.3220  41.0%     -  319s
     0     0 58603.2194    0  405 41573.5799 58603.2194  41.0%     -  320s
     0     0 58601.9644    0  413 41573.5799 58601.9644  41.0%     -  321s
     0     0 58600.7916    0  420 41573.5799 58600.7916  41.0%     -  322s
     0     0 58600.4957    0  420 41573.5799 58600.4957  41.0%     -  323s
     0     2 58600.4957    0  420 41573.5799 58600.4957  41.0%     -  363s
     1     4 58491.0732    1  406 41573.5799 58599.9688  41.0%  1743  372s
     3     8 58313.9403    2  328 41573.5799 58490.8805  40.7%  4268  381s
     7    16 58266.4782    3  326 41573.5799 58313.5537  40.3%  4218  403s
    15    32 58185.3330    4  332 41573.5799 58265.7467  40.2%  5022  419s
    31    48 57248.4746    5  326 41573.5799 58185.0173  40.0%  8420  449s
    47    80 56523.7041    6  313 41573.5799 58185.0173  40.0%  8265  464s
    79   144 55174.4881    7  288 41573.5799 58185.0173  40.0%  6710  505s
   143   176 55044.7237    9  287 41573.5799 58185.0173  40.0%  4677  523s
   175   208 53821.4590   10  277 41573.5799 58185.0173  40.0%  4202  550s
   207   239 54952.7983    9  286 41573.5799 58185.0173  40.0%  4305  571s
   238   271 55128.0891    8  288 41573.5799 58185.0173  40.0%  4378  584s
   270   303 54946.9857   10  283 41573.5799 58185.0173  40.0%  4131  598s
   302   335 53589.0957   10  324 41573.5799 58185.0173  40.0%  3991  614s
H  333   335                    41875.532964 58185.0173  38.9%  3869  614s
   334   367 50774.3882   10  270 41875.5330 58185.0173  38.9%  3907  630s
   366   400 53804.4764    9  289 41875.5330 58185.0173  38.9%  3833  650s
H  367   400                    42176.895268 58185.0173  38.0%  3823  650s
H  384   400                    42246.748764 58185.0173  37.7%  3742  650s
H  397   400                    42268.816709 58185.0173  37.7%  3698  650s
   399   545 53606.3324   11  324 42268.8167 58185.0173  37.7%  3711  670s
   547   666     cutoff   22      42268.8167 58185.0173  37.7%  3049  685s
   682   742 52921.2098   11  305 42268.8167 58185.0173  37.7%  2682  698s
   774   835 44348.5468   31  160 42268.8167 58185.0173  37.7%  2579  710s
   871   930 52842.8799   11  307 42268.8167 58185.0173  37.7%  2476  724s
   998  1027 52936.0690   12  271 42268.8167 58185.0173  37.7%  2329  739s
  1130  1121 53023.2226   12  282 42268.8167 58185.0173  37.7%  2206  752s
  1261  1202 52835.0296   12  296 42268.8167 58185.0173  37.7%  2111  765s
  1403  1246 53007.1935   13  275 42268.8167 58185.0173  37.7%  2014  781s
  1503  1325 50325.5974   13  248 42268.8167 58185.0173  37.7%  1983  798s
  1650  1404 52090.1040   14  311 42268.8167 58185.0173  37.7%  1918  815s
  1777  1454 49000.2515   13  254 42268.8167 58185.0173  37.7%  1895  832s
  1867  1478 52678.7006   14  278 42268.8167 58185.0173  37.7%  1924  848s
  1915  1559 50254.9743   14  247 42268.8167 58185.0173  37.7%  1944  861s
  2026  1634     cutoff   25      42268.8167 58185.0173  37.7%  1925  881s
  2167  1712 49941.8185   15  254 42268.8167 58185.0173  37.7%  1901  900s
  2303  1848 49340.0453   16  232 42268.8167 58185.0173  37.7%  1901  917s
  2487  1978 48370.2697   16  201 42268.8167 58185.0173  37.7%  1870  935s
  2685  2110 48223.2471   19  200 42268.8167 57981.8110  37.2%  1838  952s
  2889  2233 46798.0888   30  163 42268.8167 57981.8110  37.2%  1808  974s
  3060  2396 45937.5253   32  171 42268.8167 57981.8110  37.2%  1802  993s
  3297  2544 45577.3727   35  159 42268.8167 57981.8110  37.2%  1756 1015s
  3533  2745 44644.2523   37  156 42268.8167 56832.1735  34.5%  1731 1038s
H 3778  2739                    42409.201317 56832.1735  34.0%  1704 1148s
  3779  2740 45339.9176   30  420 42409.2013 56832.1735  34.0%  1703 1216s
  3781  2741 46591.9923   39   83 42409.2013 56832.1735  34.0%  1702 1247s
  3782  2742 52434.3167   14  274 42409.2013 56832.1735  34.0%  1702 1270s
  3783  2743 51086.5928   19  327 42409.2013 56832.1735  34.0%  1701 1288s
  3784  2743 46331.8574   16  362 42409.2013 56832.1735  34.0%  1701 1298s
  3785  2744 43286.8592   47  395 42409.2013 56832.1735  34.0%  1701 1306s
  3786  2745 55400.6486   10  387 42409.2013 56832.1735  34.0%  1700 1310s
  3787  2745 53467.7214   14  382 42409.2013 56832.1735  34.0%  1700 1316s
  3788  2746 52038.5793   21  400 42409.2013 56832.1735  34.0%  1699 1323s
  3789  2747 46284.9928   46  392 42409.2013 56832.1735  34.0%  1699 1325s
  3791  2748 47419.4319   13  399 42409.2013 56832.1735  34.0%  1698 1330s
  3793  2749 49055.5330   37  398 42409.2013 56832.1735  34.0%  1697 1335s
  3794  2750 45538.6268   31  392 42409.2013 56832.1735  34.0%  1697 1340s
  3797  2752 44733.0809   28  407 42409.2013 56832.1735  34.0%  1695 1349s
  3798  2753 43669.2375   29  405 42409.2013 56832.1735  34.0%  1695 1353s
  3799  2753 46059.3718   22  339 42409.2013 56832.1735  34.0%  1694 1356s
  3801  2755 44583.0202   40  401 42409.2013 56832.1735  34.0%  1693 1365s
  3803  2756 47316.9127   17  400 42409.2013 56832.1735  34.0%  1693 1372s
  3805  2757 46130.4054   53  357 42409.2013 56832.1735  34.0%  1692 1378s
  3807  2759 45193.3453   35  359 42409.2013 56832.1735  34.0%  1691 1382s
  3809  2760 42697.1861   51  362 42409.2013 56832.1735  34.0%  1690 1387s
  3811  2761 52084.7798   15  360 42409.2013 56832.1735  34.0%  1689 1392s
  3812  2762 47570.9259   21  360 42409.2013 56832.1735  34.0%  1689 1421s
  3813  2763 49328.3603   17  360 42409.2013 56832.1735  34.0%  1688 1446s
  3814  2766 56832.1735   14  391 42409.2013 56832.1735  34.0%  1724 1471s
  3816  2770 56832.1735   15  381 42409.2013 56832.1735  34.0%  1726 1489s
  3820  2776 56832.1735   16  380 42409.2013 56832.1735  34.0%  1729 1504s
  3828  2790 56832.1735   17  388 42409.2013 56832.1735  34.0%  1742 1538s
  3844  2800 55678.4312   18  371 42409.2013 56832.1735  34.0%  1790 1578s
  3860  2827 52872.5327   19  291 42409.2013 56832.1735  34.0%  1817 1607s
  3892  2935 51885.8718   20  284 42409.2013 56832.1735  34.0%  1858 1640s
  4011  2967 49740.7682   21  280 42409.2013 56832.1735  34.0%  1918 1657s
  4091  2994 48344.0328   22  228 42409.2013 56832.1735  34.0%  1944 1671s
  4162  3004 46743.7035   24  261 42409.2013 56832.1735  34.0%  1966 1686s
  4214  3013 45252.6704   24  246 42409.2013 56832.1735  34.0%  1979 1703s
  4288  3006 48071.2579   23  226 42409.2013 56832.1735  34.0%  1998 1726s
  4324  3020 46346.5241   23  235 42409.2013 56832.1735  34.0%  2038 1742s
  4391  3017 46878.0273   24  212 42409.2013 56832.1735  34.0%  2063 1766s
  4454  3016 45513.5754   25  221 42409.2013 56832.1735  34.0%  2101 1782s
  4490  3026     cutoff   24      42409.2013 56832.1735  34.0%  2131 1805s
  4537  3021     cutoff   24      42409.2013 56832.1735  34.0%  2167 1824s
  4586  3016 47139.5295   27  192 42409.2013 56832.1735  34.0%  2200 1841s
  4635  3016 46166.5122   28  161 42409.2013 56832.1735  34.0%  2230 1862s
  4684  3029 46035.8318   29  150 42409.2013 56832.1735  34.0%  2259 1880s
  4737  3030 45830.5041   30  133 42409.2013 56447.6842  33.1%  2292 1897s
  4796  3037 45813.3740   31  126 42409.2013 56315.2604  32.8%  2324 1915s
  4852  3051 45435.3518   32   95 42409.2013 56315.2604  32.8%  2351 1932s
  4899  3065 44758.8830   33  213 42409.2013 56315.2604  32.8%  2384 1947s
  4932  3093 44416.1476   34  100 42409.2013 56315.2604  32.8%  2400 1965s
  4987  3105 43809.1050   36  161 42409.2013 56315.2604  32.8%  2425 1983s
  5054  3120 43463.4617   38  179 42409.2013 56315.2604  32.8%  2449 2002s
  5149  3132 43449.5660   25  346 42409.2013 55055.8667  29.8%  2471 2023s
  5239  3128 43004.2425   26  300 42409.2013 55055.8667  29.8%  2505 2042s
  5295  3147 42726.6469   27  294 42409.2013 55055.8667  29.8%  2520 2067s
  5392  3149 infeasible   28      42409.2013 54714.7176  29.0%  2532 2088s
  5501  3149 48288.4865   24  338 42409.2013 54714.7176  29.0%  2562 2111s
  5587  3160 47448.3348   25  327 42409.2013 54714.7176  29.0%  2600 2135s
  5705  3177 46285.8238   27  321 42409.2013 54564.1983  28.7%  2636 2158s
  5804  3196     cutoff   30      42409.2013 54528.4500  28.6%  2678 2183s
  5914  3202     cutoff   33      42409.2013 54528.4500  28.6%  2731 2210s
  6009  3221     cutoff   33      42409.2013 54528.4500  28.6%  2777 2235s
  6109  3235 50912.4301   19  291 42409.2013 54528.4500  28.6%  2841 2257s
  6186  3290 50868.3206   20  286 42409.2013 54044.9060  27.4%  2878 2285s
  6327  3279 45287.9669   24  253 42409.2013 53940.9903  27.2%  2918 2315s
  6495  3297 43399.2558   29  146 42409.2013 53940.9903  27.2%  2957 2347s
  6661  3305     cutoff   22      42409.2013 53940.9903  27.2%  2992 2379s
  6840  3350     cutoff   23      42409.2013 53940.9903  27.2%  3015 2412s
  7038  3341 50590.9166   25  243 42409.2013 53542.9017  26.3%  3032 2444s
  7246  3318 48105.2137   28  231 42409.2013 53542.9017  26.3%  3052 2476s
  7425  3327 45122.3770   33  142 42409.2013 53542.9017  26.3%  3070 2512s
  7627  3359 43622.9163   39  172 42409.2013 53542.9017  26.3%  3124 2547s
  7817  3350 49375.0682   25  290 42409.2013 53036.8034  25.1%  3188 2585s
  7981  3348 46675.6471   28  283 42409.2013 52841.7968  24.6%  3227 2622s
  8185  3386 45503.1711   31  245 42409.2013 52801.1017  24.5%  3279 2659s
  8396  3394     cutoff   38      42409.2013 52530.2649  23.9%  3331 2701s
  8671  3345 43046.8994   34  253 42409.2013 52530.2649  23.9%  3365 2743s
  8879  3379 47671.8457   28  286 42409.2013 52498.3904  23.8%  3401 2788s
  9136  3382 44464.1978   34  229 42409.2013 52288.1414  23.3%  3450 2833s
  9431  3355     cutoff   42      42409.2013 51970.3090  22.5%  3493 2878s
  9660  3391 48446.9003   24  247 42409.2013 51868.5486  22.3%  3540 2925s
  9958  3387 43612.9614   30  130 42409.2013 51809.3409  22.2%  3586 2975s
 10220  3389 47946.0119   26  241 42409.2013 51754.1798  22.0%  3616 3027s
 10530  3378 43480.9097   31  169 42409.2013 51722.5255  22.0%  3670 3081s
 10853  3289 47917.2365   24  286 42409.2013 51719.2586  22.0%  3721 3123s
 10897  3293 46318.1726   25  219 42409.2013 51422.0292  21.3%  3729 3166s
 10949  3332 45847.4605   26  205 42409.2013 51422.0292  21.3%  3732 3217s
 11175  3365     cutoff   34      42409.2013 51243.3852  20.8%  3747 3275s
 11523  3341     cutoff   29      42409.2013 51243.3852  20.8%  3786 3334s
 11932  3211 45592.0887   25  280 42409.2013 51046.3813  20.4%  3831 3396s
 12400  3236     cutoff   30      42409.2013 50934.9480  20.1%  3843 3465s
 12787  3282     cutoff   27      42409.2013 50746.8916  19.7%  3874 3527s
 12991  3345 43857.0865   22  337 42409.2013 50661.8954  19.5%  3899 3591s
 13186  3363 44174.8302   26  187 42409.2013 50634.2362  19.4%  3919 3600s

Cutting planes:
  MIR: 752
  Mixing: 3
  Flow cover: 1377
  RLT: 13
  Relax-and-lift: 107

Explored 13236 nodes (52075396 simplex iterations) in 3600.04 seconds (6567.17 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 42409.2 42268.8 42246.7 ... 41198

Time limit reached
Best objective 4.240920131667e+04, best bound 5.063423618105e+04, gap 19.3945%
  WARNING: Time limit reached. Using best solution found (gap: 19.39%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 42409.20, θ = 205753.25
  Upper Bound (UB) = 42409.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205753.25
  [DEBUG]   ✓ Scenario 0: θ = 205753.25 ≤ Q = 205753.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205753.25 ≤ Q = 205753.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205753.25 ≤ Q = 205753.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205753.25 ≤ Q = 205753.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205753.25 ≤ Q = 205753.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205753.25 ≤ Q = 205753.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 205753.25 ≤ Q = 205753.25 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x48789b2c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb78764d4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-15, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.376130e+13
Presolve removed 2597 rows and 1888 columns
Presolve time: 0.01s
Presolved: 496 rows, 501 columns, 1399 nonzeros
Found heuristic solution: objective 6147755.6119
Variable types: 341 continuous, 160 integer (160 binary)

Root relaxation: objective -1.952248e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -195224.77    0  128 6147755.61 -195224.77   103%     -    0s
H    0     0                    -159198.9898 -195224.77  22.6%     -    0s
H    0     0                    -159903.3618 -195224.77  22.1%     -    0s
     0     0 -172933.31    0   78 -159903.36 -172933.31  8.15%     -    0s
H    0     0                    -171316.3727 -172932.13  0.94%     -    0s
H    0     0                    -171831.7836 -172932.13  0.64%     -    0s
     0     0 -172893.59    0   35 -171831.78 -172893.59  0.62%     -    0s
     0     0 -172832.93    0   76 -171831.78 -172832.93  0.58%     -    0s
     0     0 -172101.28    0   19 -171831.78 -172101.28  0.16%     -    0s
     0     0 -172070.55    0   17 -171831.78 -172070.55  0.14%     -    0s
     0     0 -172066.87    0   16 -171831.78 -172066.87  0.14%     -    0s
     0     0 -172065.86    0   16 -171831.78 -172065.86  0.14%     -    0s
     0     0 -172065.69    0   16 -171831.78 -172065.69  0.14%     -    0s
     0     0 -172064.77    0   16 -171831.78 -172064.77  0.14%     -    0s
H    0     0                    -171954.0027 -172064.77  0.06%     -    0s
     0     0 -172006.18    0    9 -171954.00 -172006.18  0.03%     -    0s
     0     0 -172006.18    0   18 -171954.00 -172006.18  0.03%     -    0s
     0     0 -171966.63    0    7 -171954.00 -171966.63  0.01%     -    0s
     0     0 -171958.68    0    4 -171954.00 -171958.68  0.00%     -    0s
     0     0 -171957.50    0    2 -171954.00 -171957.50  0.00%     -    0s
     0     0 -171955.03    0    2 -171954.00 -171955.03  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 5
  MIR: 6
  Flow cover: 4

Explored 1 nodes (601 simplex iterations) in 0.10 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -171954 -171832 -171802 ... 1.37613e+13
No other solutions better than -171954

Optimal solution found (tolerance 1.00e-06)
Best objective -1.719540026596e+05, best bound -1.719540026596e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 197092.97
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -171954.00
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -171954.00 = 197092.97
  [DEBUG]   Current θ from Master = 205753.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8660.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 33748.93
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 3448.7995, Absolute Gap = 3448.7995, Relative Gap = 0.081322
  Not converged yet (gap = 3448.80 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x2a061a56
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 2.36s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -173969.7691

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   21496   -1.9588351e+05   0.000000e+00   8.719486e+07      5s
   33319   -1.4703609e+04   0.000000e+00   5.736528e+07     10s
   41606   -3.2799185e+03   0.000000e+00   3.651107e+07     15s
   47905    1.3802661e+04   0.000000e+00   9.163542e+07     20s
   54829    2.4464330e+04   0.000000e+00   1.758959e+07     25s
   62181    3.0267889e+04   0.000000e+00   7.462373e+06     30s
   69136    3.5993148e+04   0.000000e+00   3.184563e+06     35s
   75766    4.1711714e+04   0.000000e+00   6.537097e+06     40s
   80837    4.2733971e+04   0.000000e+00   1.068677e+08     45s
Concurrent spin time: 15.73s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 7.336818e+04, 65628 iterations, 57.02 seconds (64.15 work units)
Total elapsed time = 60.14s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 73368.1798    0   83 -173969.77 73368.1798   142%     -   60s
H    0     0                    -170311.5077 73368.1798   143%     -   60s
H    0     0                    -122066.7952 73368.1798   160%     -   60s
H    0     0                    -77760.64653 73368.1798   194%     -   60s
H    0     0                    -73086.75887 73368.1798   200%     -   60s
H    0     0                    -57401.59107 73368.1798   228%     -   60s
H    0     0                    25201.989857 73368.1798   191%     -   60s
H    0     0                    34923.649176 73368.1798   110%     -   61s
H    0     0                    36402.667311 73368.1798   102%     -   61s
H    0     0                    37049.905624 73368.1798  98.0%     -   61s
H    0     0                    37232.710444 73368.1798  97.1%     -   61s
H    0     0                    37270.551267 73368.1798  96.9%     -   61s
H    0     0                    37793.059505 73368.1798  94.1%     -   61s
H    0     0                    37917.783275 73368.1798  93.5%     -   61s
H    0     0                    37926.880492 73368.1798  93.4%     -   61s
     0     0 68116.4776    0  175 37926.8805 68116.4776  79.6%     -   81s
H    0     0                    37996.531116 68116.4776  79.3%     -   82s
H    0     0                    38481.094938 68116.4776  77.0%     -   82s
H    0     0                    38776.430727 68116.4776  75.7%     -   82s
     0     0 67943.9737    0  179 38776.4307 67943.9737  75.2%     -   89s
     0     0 67943.9737    0  182 38776.4307 67943.9737  75.2%     -   95s
     0     0 67943.9737    0  185 38776.4307 67943.9737  75.2%     -   96s
     0     0 67943.9737    0  185 38776.4307 67943.9737  75.2%     -   96s
     0     0 64361.2201    0  247 38776.4307 64361.2201  66.0%     -  112s
H    0     0                    40740.959692 64361.2201  58.0%     -  113s
     0     0 64070.1653    0  254 40740.9597 64070.1653  57.3%     -  123s
     0     0 63871.3748    0  253 40740.9597 63871.3748  56.8%     -  127s
     0     0 63665.8847    0  258 40740.9597 63665.8847  56.3%     -  131s
     0     0 63606.8629    0  254 40740.9597 63606.8629  56.1%     -  135s
     0     0 63595.5156    0  257 40740.9597 63595.5156  56.1%     -  138s
     0     0 63591.9231    0  263 40740.9597 63591.9231  56.1%     -  138s
     0     0 63582.6494    0  259 40740.9597 63582.6494  56.1%     -  140s
     0     0 63581.3972    0  263 40740.9597 63581.3972  56.1%     -  140s
     0     0 63581.3972    0  263 40740.9597 63581.3972  56.1%     -  140s
     0     0 61923.2379    0  256 40740.9597 61923.2379  52.0%     -  163s
H    0     0                    40817.994216 61922.6655  51.7%     -  164s
H    0     0                    40902.367859 61922.6655  51.4%     -  164s
     0     0 61509.0539    0  309 40902.3679 61509.0539  50.4%     -  173s
     0     0 61436.2925    0  273 40902.3679 61436.2925  50.2%     -  178s
     0     0 61363.1132    0  278 40902.3679 61363.1132  50.0%     -  183s
     0     0 61312.7266    0  276 40902.3679 61312.7266  49.9%     -  187s
     0     0 61207.1503    0  307 40902.3679 61207.1503  49.6%     -  191s
     0     0 61165.8504    0  311 40902.3679 61165.8504  49.5%     -  193s
     0     0 61128.3256    0  315 40902.3679 61128.3256  49.4%     -  195s
     0     0 61003.4095    0  318 40902.3679 61003.4095  49.1%     -  200s
     0     0 60948.4412    0  278 40902.3679 60948.4412  49.0%     -  204s
     0     0 60939.7084    0  286 40902.3679 60939.7084  49.0%     -  206s
     0     0 60929.0243    0  326 40902.3679 60929.0243  49.0%     -  207s
     0     0 60926.6920    0  329 40902.3679 60926.6920  49.0%     -  208s
     0     0 60925.7345    0  327 40902.3679 60925.7345  49.0%     -  208s
H    0     0                    41088.340843 60925.7345  48.3%     -  216s
     0     0 60252.9117    0  347 41088.3408 60252.9117  46.6%     -  226s
     0     0 59947.0787    0  345 41088.3408 59947.0787  45.9%     -  237s
     0     0 59874.4664    0  377 41088.3408 59874.4664  45.7%     -  242s
     0     0 59842.2030    0  344 41088.3408 59842.2030  45.6%     -  245s
     0     0 59823.9778    0  343 41088.3408 59823.9778  45.6%     -  247s
     0     0 59812.2912    0  347 41088.3408 59812.2912  45.6%     -  248s
     0     0 59804.9295    0  351 41088.3408 59804.9295  45.6%     -  249s
     0     0 59799.6402    0  354 41088.3408 59799.6402  45.5%     -  250s
     0     0 59797.2997    0  349 41088.3408 59797.2997  45.5%     -  250s
     0     0 59797.1223    0  349 41088.3408 59797.1223  45.5%     -  250s
     0     0 59521.0117    0  352 41088.3408 59521.0117  44.9%     -  260s
H    0     0                    41090.547601 59520.9104  44.9%     -  261s
H    0     0                    41097.838501 59520.9104  44.8%     -  261s
H    0     0                    41155.200656 59520.9104  44.6%     -  261s
     0     0 59463.5963    0  347 41155.2007 59463.5963  44.5%     -  267s
     0     0 59439.5980    0  357 41155.2007 59439.5980  44.4%     -  272s
     0     0 59408.8027    0  349 41155.2007 59408.8027  44.4%     -  277s
     0     0 59384.5987    0  352 41155.2007 59384.5987  44.3%     -  280s
     0     0 59353.5447    0  353 41155.2007 59353.5447  44.2%     -  282s
     0     0 59343.1835    0  357 41155.2007 59343.1835  44.2%     -  286s
     0     0 59339.9671    0  323 41155.2007 59339.9671  44.2%     -  287s
     0     0 59338.8747    0  325 41155.2007 59338.8747  44.2%     -  288s
     0     0 59195.0042    0  365 41155.2007 59195.0042  43.8%     -  294s
     0     0 59061.1232    0  368 41155.2007 59061.1232  43.5%     -  304s
     0     0 59009.5353    0  367 41155.2007 59009.5353  43.4%     -  309s
     0     0 58995.2094    0  417 41155.2007 58995.2094  43.3%     -  311s
     0     0 58986.4451    0  424 41155.2007 58986.4451  43.3%     -  313s
     0     0 58978.4942    0  416 41155.2007 58978.4942  43.3%     -  314s
     0     0 58973.5039    0  341 41155.2007 58973.5039  43.3%     -  315s
     0     0 58969.9556    0  369 41155.2007 58969.9556  43.3%     -  316s
     0     0 58968.2817    0  376 41155.2007 58968.2817  43.3%     -  317s
     0     0 58906.9126    0  423 41155.2007 58906.9126  43.1%     -  325s
H    0     0                    41462.596064 58906.8638  42.1%     -  325s
     0     0 58878.5330    0  396 41462.5961 58878.5330  42.0%     -  330s
     0     0 58866.9214    0  394 41462.5961 58866.9214  42.0%     -  331s
     0     0 58862.2349    0  401 41462.5961 58862.2349  42.0%     -  332s
     0     0 58856.3774    0  401 41462.5961 58856.3774  42.0%     -  333s
     0     0 58855.2526    0  409 41462.5961 58855.2526  41.9%     -  334s
     0     0 58796.2382    0  443 41462.5961 58796.2382  41.8%     -  341s
     0     0 58789.4463    0  442 41462.5961 58789.4463  41.8%     -  344s
     0     0 58784.3107    0  441 41462.5961 58784.3107  41.8%     -  346s
     0     0 58783.0956    0  447 41462.5961 58783.0956  41.8%     -  346s
     0     0 58769.3379    0  444 41462.5961 58769.3379  41.7%     -  349s
     0     0 58715.8716    0  399 41462.5961 58715.8716  41.6%     -  353s
     0     0 58712.7651    0  445 41462.5961 58712.7651  41.6%     -  354s
     0     0 58709.8199    0  442 41462.5961 58709.8199  41.6%     -  355s
     0     0 58709.3785    0  404 41462.5961 58709.3785  41.6%     -  355s
     0     0 58694.2305    0  418 41462.5961 58694.2305  41.6%     -  358s
     0     0 58691.7830    0  422 41462.5961 58691.7830  41.6%     -  362s
     0     0 58691.1137    0  419 41462.5961 58691.1137  41.6%     -  363s
     0     0 58666.8573    0  425 41462.5961 58666.8573  41.5%     -  367s
     0     0 58663.6161    0  363 41462.5961 58663.6161  41.5%     -  368s
     0     0 58662.5876    0  426 41462.5961 58662.5876  41.5%     -  368s
     0     0 58659.9668    0  413 41462.5961 58659.9668  41.5%     -  370s
H    0     0                    41573.579926 58659.9103  41.1%     -  379s
     0     0 58659.4220    0  406 41573.5799 58659.4220  41.1%     -  385s
     0     0 58653.0346    0  448 41573.5799 58653.0346  41.1%     -  389s
     0     0 58650.8150    0  449 41573.5799 58650.8150  41.1%     -  391s
     0     0 58650.6161    0  448 41573.5799 58650.6161  41.1%     -  392s
     0     0 58642.4939    0  444 41573.5799 58642.4939  41.1%     -  396s
     0     0 58641.4840    0  444 41573.5799 58641.4840  41.1%     -  398s
     0     2 58640.9234    0  444 41573.5799 58640.9234  41.1%     -  490s
     1     3 58059.5940    1  400 41573.5799 58640.9234  41.1% 11882  506s
     2     6 56848.3846    2  355 41573.5799 58640.9234  41.1% 11384  518s
     5    12 55439.0575    3  310 41573.5799 58004.6574  39.5%  9023  537s
    11    24 55286.1821    4  324 41573.5799 57859.5747  39.2%  8476  556s
    23    36 57176.3724    4  385 41573.5799 57714.1296  38.8% 11276  587s
    35    68 56849.6837    5  387 41573.5799 57714.1296  38.8%  9640  649s
    67   100 56638.4517    6  348 41573.5799 57082.4031  37.3% 10496  672s
    99   132 56395.0929    7  299 41573.5799 57082.0684  37.3%  8834  695s
H  121   132                    41718.605982 57082.0684  36.8%  7550  695s
   131   272 56325.7506    8  346 41718.6060 57082.0684  36.8%  7163  725s
H  141   272                    41786.707564 57082.0684  36.6%  6830  725s
H  212   272                    41909.085585 57082.0684  36.2%  5502  725s
   271   365 56080.0424   12  298 41909.0856 57082.0684  36.2%  5260  744s
   364   442 55969.2835   13  337 41909.0856 57082.0684  36.2%  4914  761s
   443   515 54013.3363   15  269 41909.0856 57082.0684  36.2%  4759  776s
   516   547 50461.3863   17  241 41909.0856 57082.0684  36.2%  4699  790s
   548   583 45601.8077   18  223 41909.0856 57082.0684  36.2%  4811  805s
   588   624 51082.4260   17  213 41909.0856 57082.0684  36.2%  4855  823s
   635   660     cutoff   19      41909.0856 57082.0684  36.2%  4872  838s
H  640   660                    41934.913336 57082.0684  36.1%  4855  838s
H  677   660                    42001.007027 56849.4737  35.4%  4801  838s
   687   708 43950.3329   20  209 42001.0070 56849.4737  35.4%  4868  855s
   756   756 43678.9244   22  186 42001.0070 56849.4737  35.4%  4909  873s
   822   784 43789.3390   22  187 42001.0070 56849.4737  35.4%  4952  890s
   850   819 43737.0078   23  189 42001.0070 56849.4737  35.4%  5034  905s
   885   858 43671.6546   23  184 42001.0070 56849.4737  35.4%  5034  923s
H  899   858                    42026.834778 56849.4737  35.3%  4983  923s
H  919   858                    42106.062083 56849.4737  35.0%  4973  923s
   930   921 43701.1108   24  187 42106.0621 56849.4737  35.0%  5011  939s
  1019   992 42920.3204   26  166 42106.0621 56849.4737  35.0%  4946  958s
  1106  1058     cutoff   31      42106.0621 56800.6102  34.9%  4905  975s
  1184  1134 54796.4867    9  369 42106.0621 56800.6102  34.9%  4922  994s
  1270  1194 54610.5295   10  278 42106.0621 56800.6102  34.9%  4925 1014s
  1362  1268 54424.6161   12  272 42106.0621 56800.6102  34.9%  4914 1034s
  1452  1347 53555.7841   15  313 42106.0621 56800.6102  34.9%  4934 1052s
  1549  1434 52652.8085   16  257 42106.0621 56800.6102  34.9%  4924 1071s
  1667  1468 52132.6689   18  272 42106.0621 56776.8784  34.8%  4874 1087s
  1719  1541 51820.0144   19  266 42106.0621 56776.8784  34.8%  4888 1107s
  1812  1616 51495.6643   21  317 42106.0621 56776.8784  34.8%  4879 1130s
  1922  1707 49904.7076   23  297 42106.0621 56562.8833  34.3%  4863 1153s
  2041  1812 49853.6337   24  288 42106.0621 56562.8833  34.3%  4816 1177s
  2168  1932 49472.4540   30  283 42106.0621 56383.1386  33.9%  4833 1203s
  2312  2044 48406.4338   33  280 42106.0621 56382.3256  33.9%  4828 1228s
  2456  2166 47942.1316   37  264 42106.0621 56382.3256  33.9%  4828 1254s
  2612  2280 46798.3568   42  188 42106.0621 56382.3256  33.9%  4822 1280s
  2778  2389 45955.8657   48  236 42106.0621 56214.1993  33.5%  4811 1308s
  2967  2539 44979.1749   56  173 42106.0621 56173.4527  33.4%  4772 1336s
  3149  2681 43765.4170   65  170 42106.0621 56173.4527  33.4%  4745 1362s
H 3232  2680                    42193.597740 56173.4527  33.1%  4693 1362s
  3329  2822     cutoff   75      42193.5977 56173.4527  33.1%  4633 1396s
H 3551  2822                    42239.937482 56057.2975  32.7%  4601 1423s
  3552  2823 43529.7022   26  444 42239.9375 56057.2975  32.7%  4599 1484s
  3554  2824 51504.9123   17   83 42239.9375 56057.2975  32.7%  4597 1532s
  3555  2825 44659.7885   20  315 42239.9375 56057.2975  32.7%  4596 1570s
  3556  2826 42501.1112   37  350 42239.9375 56057.2975  32.7%  4594 1595s
  3557  2826 46744.3524   23  399 42239.9375 56057.2975  32.7%  4593 1608s
  3558  2827 42672.7394   32  420 42239.9375 56057.2975  32.7%  4592 1620s
  3559  2828 50077.3993   22  409 42239.9375 56057.2975  32.7%  4590 1632s
  3560  2828 48521.1370   35  388 42239.9375 56057.2975  32.7%  4589 1638s
  3561  2829 47623.8932   21  381 42239.9375 56057.2975  32.7%  4588 1645s
  3562  2830 52340.2540   18  390 42239.9375 56057.2975  32.7%  4587 1651s
  3563  2830 43173.2941   30  422 42239.9375 56057.2975  32.7%  4585 1656s
  3565  2832 47724.3043   38  384 42239.9375 56057.2975  32.7%  4583 1663s
  3566  2832 55262.3802   13  353 42239.9375 56057.2975  32.7%  4581 1672s
  3567  2833 48458.9232   28  392 42239.9375 56057.2975  32.7%  4580 1679s
  3568  2834 48611.8535   16  345 42239.9375 56057.2975  32.7%  4579 1682s
  3569  2834 50359.1344   24  399 42239.9375 56057.2975  32.7%  4578 1690s
  3571  2836 46876.6100   52  362 42239.9375 56057.2975  32.7%  4575 1697s
  3572  2836 43940.2664   33  398 42239.9375 56057.2975  32.7%  4574 1705s
  3573  2837 54929.8508    6  398 42239.9375 56057.2975  32.7%  4572 1710s
  3574  2838 52839.5444   18  408 42239.9375 56057.2975  32.7%  4571 1715s
  3576  2839 43849.3457   56  400 42239.9375 56057.2975  32.7%  4569 1723s
  3577  2840 50129.8602   21  437 42239.9375 56057.2975  32.7%  4567 1727s
  3578  2840 44482.9593   45  449 42239.9375 56057.2975  32.7%  4566 1732s
  3580  2842 44458.4032   73  441 42239.9375 56057.2975  32.7%  4563 1741s
  3582  2843 48617.4792   43  399 42239.9375 56057.2975  32.7%  4561 1749s
  3583  2844 44397.0143   29  399 42239.9375 56057.2975  32.7%  4560 1796s
  3584  2844 45135.1969   36  399 42239.9375 56057.2975  32.7%  4558 1861s
  3585  2847 56057.2975   11  327 42239.9375 56057.2975  32.7%  4614 1883s
  3586  2850 56057.2975   12  301 42239.9375 56057.2975  32.7%  4614 1906s
  3589  2855 55952.1440   13  315 42239.9375 56057.2975  32.7%  4618 1938s
  3595  2865 55417.7144   14  316 42239.9375 56057.2975  32.7%  4624 1973s
  3607  2873 55729.6760   15  377 42239.9375 56057.2975  32.7%  4660 2026s
H 3619  2758                    42423.074112 56057.2975  32.1%  4677 2089s
H 3641  2614                    42452.020212 56057.2975  32.0%  4700 2089s
  3651  2727 54713.4081   16  341 42452.0202 56057.2975  32.0%  4741 2132s
  3767  2721 54483.7240   19  361 42452.0202 56057.2975  32.0%  4821 2151s
  3800  2759 53326.0183   19  313 42452.0202 56057.2975  32.0%  4814 2171s
H 3818  2624                    42494.739578 56057.2975  31.9%  4812 2171s
H 3835  2497                    42572.197607 56057.2975  31.7%  4812 2171s
  3849  2563 53123.0804   20  358 42572.1976 56057.2975  31.7%  4815 2199s
  3924  2615 49256.8484   20  306 42572.1976 56057.2975  31.7%  4791 2223s
  4010  2649 49462.2397   31  234 42572.1976 56057.2975  31.7%  4750 2243s
  4084  2674 52797.6775   19  299 42572.1976 56057.2975  31.7%  4718 2278s
  4169  2686 51634.8019   20  287 42572.1976 56057.2975  31.7%  4675 2309s
  4251  2702 47793.3351   22  301 42572.1976 56017.7656  31.6%  4640 2328s
  4321  2700 53421.8978   17  309 42572.1976 56017.7656  31.6%  4618 2354s
  4358  2720 48188.6863   22  286 42572.1976 56017.7656  31.6%  4612 2375s
  4399  2743 44539.4504   23  312 42572.1976 56017.7656  31.6%  4615 2394s
  4440  2766 49872.7520   18  239 42572.1976 56017.7656  31.6%  4621 2416s
  4489  2778     cutoff   24      42572.1976 56017.7656  31.6%  4610 2436s
  4543  2787 43325.9378   24  266 42572.1976 56017.7656  31.6%  4604 2455s
  4581  2797     cutoff   25      42572.1976 55396.1225  30.1%  4601 2468s
  4620  2826 49228.9751   20  231 42572.1976 55396.1225  30.1%  4593 2491s
  4680  2854 46642.5798   18  276 42572.1976 55396.1225  30.1%  4573 2515s
  4754  2877 46022.2201   19  266 42572.1976 55396.1225  30.1%  4547 2537s
  4829  2908 45214.1835   21  251 42572.1976 55396.1225  30.1%  4530 2560s
  4923  2913     cutoff   24      42572.1976 55396.1225  30.1%  4505 2582s
  4994  2907 43156.6237   24  199 42572.1976 55396.1225  30.1%  4489 2613s
  5099  2905 51718.9131   15  292 42572.1976 55396.1225  30.1%  4454 2639s
  5210  2942 49674.1765   17  281 42572.1976 55396.1225  30.1%  4426 2668s
  5344  2938 49470.6136   20  266 42572.1976 55396.1225  30.1%  4387 2700s
  5465  2948 46081.2057   23  174 42572.1976 55396.1225  30.1%  4367 2735s
  5596  2920     cutoff   29      42572.1976 54572.4742  28.2%  4339 2767s
  5642  2924 43039.1663   20  294 42572.1976 54572.4742  28.2%  4343 2798s
  5705  2909 42957.5541   21  285 42572.1976 54547.2597  28.1%  4338 2832s
H 5774  2770                    42573.662081 54547.2597  28.1%  4324 2832s
  5790  2810     cutoff   22      42573.6621 54547.2597  28.1%  4323 2865s
  5913  2830 43334.5615   23  242 42573.6621 54547.2597  28.1%  4313 2901s
  6052  2841 44198.5980   25  242 42573.6621 54326.1720  27.6%  4293 2945s
  6207  2808 43853.7901   26  221 42573.6621 54326.1720  27.6%  4269 2974s
  6250  2820 43077.5437   27  179 42573.6621 53830.1392  26.4%  4267 3007s
  6288  2832     cutoff   28      42573.6621 53830.1392  26.4%  4270 3034s
  6325  2848     cutoff   27      42573.6621 53830.1392  26.4%  4273 3064s
  6362  2859     cutoff   29      42573.6621 53830.1392  26.4%  4274 3101s
  6435  2894 44764.7911   20  263 42573.6621 53830.1392  26.4%  4265 3138s
  6569  2936     cutoff   24      42573.6621 53830.1392  26.4%  4246 3178s
  6769  2982 51486.2388   20  302 42573.6621 53830.1392  26.4%  4216 3223s
  7011  2953 47793.7676   24  189 42573.6621 53681.5141  26.1%  4160 3264s
  7150  2975 42784.8572   28  132 42573.6621 53318.2385  25.2%  4132 3310s
  7356  2981 51071.7449   22  390 42573.6621 53236.6394  25.0%  4113 3364s
  7597  2991 49256.5990   25  334 42573.6621 53236.6394  25.0%  4081 3416s
  7817  3014 45436.6731   32  231 42573.6621 53105.5784  24.7%  4065 3468s
  8111  2996 43357.5370   40  233 42573.6621 53105.5784  24.7%  4025 3529s
  8349  2989 48490.7869   23  286 42573.6621 52813.1893  24.1%  4016 3584s
  8628  2915     cutoff   26      42573.6621 52728.3942  23.9%  3994 3600s

Cutting planes:
  MIR: 869
  Mixing: 6
  Flow cover: 1563
  RLT: 10
  Relax-and-lift: 80

Explored 8681 nodes (34951933 simplex iterations) in 3600.05 seconds (6235.14 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 42573.7 42572.2 42494.7 ... 42001

Time limit reached
Best objective 4.257366208076e+04, best bound 5.265719435631e+04, gap 23.6849%
  WARNING: Time limit reached. Using best solution found (gap: 23.68%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 42573.66, θ = 206050.33
  Upper Bound (UB) = 42573.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206050.33
  [DEBUG]   ✓ Scenario 0: θ = 206050.33 ≤ Q = 206050.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206050.33 ≤ Q = 206050.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206050.33 ≤ Q = 206050.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206050.33 ≤ Q = 206050.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206050.33 ≤ Q = 206050.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 206050.33 ≤ Q = 206050.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 206050.33 ≤ Q = 206050.33 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 206050.33 ≤ Q = 206050.33 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7e872c67
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8178d399
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.356954e+13
Presolve removed 2598 rows and 1889 columns
Presolve time: 0.01s
Presolved: 495 rows, 500 columns, 1396 nonzeros
Found heuristic solution: objective 6148638.2634
Variable types: 340 continuous, 160 integer (160 binary)

Root relaxation: objective -1.943260e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194326.02    0  125 6148638.26 -194326.02   103%     -    0s
H    0     0                    -160285.6644 -194326.02  21.2%     -    0s
H    0     0                    -161363.7617 -194326.02  20.4%     -    0s
     0     0 -171464.55    0   71 -161363.76 -171464.55  6.26%     -    0s
H    0     0                    -167187.2277 -171349.28  2.49%     -    0s
H    0     0                    -167478.9381 -171349.28  2.31%     -    0s
H    0     0                    -167669.9245 -171349.28  2.19%     -    0s
H    0     0                    -167961.6350 -171349.28  2.02%     -    0s
     0     0 -169464.75    0   75 -167961.63 -169464.75  0.89%     -    0s
H    0     0                    -168117.3663 -169451.94  0.79%     -    0s
H    0     0                    -168178.9390 -169451.94  0.76%     -    0s
     0     0 -169070.26    0   59 -168178.94 -169070.26  0.53%     -    0s
H    0     0                    -168255.7608 -169019.71  0.45%     -    0s
     0     0 -168997.09    0   53 -168255.76 -168997.09  0.44%     -    0s
     0     0 -168802.63    0   19 -168255.76 -168802.63  0.33%     -    0s
     0     0 -168714.73    0   18 -168255.76 -168714.73  0.27%     -    0s
     0     0 -168713.59    0   16 -168255.76 -168713.59  0.27%     -    0s
     0     0 -168650.77    0   23 -168255.76 -168650.77  0.23%     -    0s
     0     0 -168634.11    0   23 -168255.76 -168634.11  0.22%     -    0s
H    0     0                    -168310.5493 -168634.11  0.19%     -    0s
     0     0 -168634.11    0   67 -168310.55 -168634.11  0.19%     -    0s
     0     0 -168634.11    0   18 -168310.55 -168634.11  0.19%     -    0s
     0     0 -168553.30    0   15 -168310.55 -168553.30  0.14%     -    0s
     0     0 -168495.09    0   10 -168310.55 -168495.09  0.11%     -    0s
     0     0 -168416.61    0   13 -168310.55 -168416.61  0.06%     -    0s
H    0     0                    -168329.5714 -168416.61  0.05%     -    0s
     0     0 -168407.94    0    2 -168329.57 -168407.94  0.05%     -    0s
     0     0 -168407.94    0   13 -168329.57 -168407.94  0.05%     -    0s
H    0     0                    -168361.3544 -168407.94  0.03%     -    0s
*    0     0               0    -168393.0291 -168393.03  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 7
  Flow cover: 11
  Relax-and-lift: 2

Explored 1 nodes (1088 simplex iterations) in 0.23 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -168393 -168361 -168330 ... -161364
No other solutions better than -168393

Optimal solution found (tolerance 1.00e-06)
Best objective -1.683930290734e+05, best bound -1.683930290734e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 200653.95
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -168393.03
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -168393.03 = 200653.95
  [DEBUG]   Current θ from Master = 206050.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5396.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 37177.28
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 3613.2603, Absolute Gap = 3613.2603, Relative Gap = 0.084871
  Not converged yet (gap = 3613.26 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x5d57a13b
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 3.30s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -173969.7691

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16781   -2.6792983e+05   0.000000e+00   4.308563e+06      5s
   34312   -1.0039275e+05   0.000000e+00   1.443231e+07     10s
   44329    1.5940897e+02   0.000000e+00   3.115593e+07     15s
   52841    1.6660900e+04   0.000000e+00   9.028876e+06     20s
   59887    2.4306818e+04   0.000000e+00   4.388700e+06     25s
   65351    2.6289394e+04   0.000000e+00   1.372429e+07     30s
   69861    2.8672540e+04   0.000000e+00   7.232538e+08     35s
   75942    3.4674321e+04   0.000000e+00   2.303716e+07     40s
   81869    3.8403404e+04   0.000000e+00   2.086801e+08     45s
   87273    4.3232856e+04   0.000000e+00   6.376761e+07     50s
   92961    4.9676827e+04   0.000000e+00   4.568824e+06     55s
   98670    5.7077788e+04   0.000000e+00   3.475119e+06     60s
  104569    5.8843902e+04   0.000000e+00   8.486800e+07     65s
  110353    6.0139809e+04   0.000000e+00   2.256078e+06     70s
  116398    6.3924407e+04   0.000000e+00   8.245439e+06     75s
  122513    6.6109971e+04   0.000000e+00   6.909831e+05     80s
  129506    6.7974754e+04   0.000000e+00   5.411093e+08     85s
  135901    6.8740640e+04   0.000000e+00   3.592381e+05     90s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 7.336803e+04, 93260 iterations, 86.47 seconds (92.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 73368.0328    0   83 -173969.77 73368.0328   142%     -   90s
H    0     0                    -163898.8846 73368.0328   145%     -   90s
H    0     0                    -161944.1762 73368.0328   145%     -   91s
H    0     0                    -161445.5575 73368.0328   145%     -   91s
H    0     0                    -161219.3134 73368.0328   146%     -   91s
H    0     0                    -160893.2279 73368.0328   146%     -   91s
H    0     0                    -65608.32558 73368.0328   212%     -   91s
H    0     0                    -65141.16168 73368.0328   213%     -   91s
H    0     0                    -1161.431666 73368.0328  6417%     -   91s
H    0     0                    16491.897011 73368.0328   345%     -   91s
H    0     0                    24893.478208 73368.0328   195%     -   92s
H    0     0                    25567.852740 73368.0328   187%     -   92s
H    0     0                    29050.920504 73368.0328   153%     -   92s
H    0     0                    29135.246920 73368.0328   152%     -   92s
H    0     0                    29239.138609 73368.0328   151%     -   93s
     0     0 68474.2781    0  130 29239.1386 68474.2781   134%     -  119s
H    0     0                    30601.588462 68474.1760   124%     -  119s
H    0     0                    30609.387161 68474.1760   124%     -  120s
H    0     0                    30988.386125 68474.1760   121%     -  120s
H    0     0                    31216.816760 68474.1760   119%     -  120s
H    0     0                    31233.782853 68474.1760   119%     -  120s
     0     0 68089.7120    0  145 31233.7829 68089.7120   118%     -  131s
     0     0 67993.7970    0  145 31233.7829 67993.7970   118%     -  135s
     0     0 67963.3942    0  138 31233.7829 67963.3942   118%     -  136s
     0     0 67900.3184    0  142 31233.7829 67900.3184   117%     -  137s
     0     0 67896.7189    0  142 31233.7829 67896.7189   117%     -  138s
     0     0 64356.6637    0  262 31233.7829 64356.6637   106%     -  176s
H    0     0                    38819.665158 64356.6216  65.8%     -  177s
H    0     0                    38871.671821 64356.6216  65.6%     -  177s
H    0     0                    39143.360597 64356.6216  64.4%     -  177s
H    0     0                    39165.269798 64356.6216  64.3%     -  177s
     0     0 63895.1508    0  242 39165.2698 63895.1508  63.1%     -  189s
     0     0 63793.5745    0  271 39165.2698 63793.5745  62.9%     -  193s
     0     0 63736.8730    0  283 39165.2698 63736.8730  62.7%     -  197s
     0     0 63690.2455    0  260 39165.2698 63690.2455  62.6%     -  201s
     0     0 63667.7490    0  271 39165.2698 63667.7490  62.6%     -  204s
     0     0 63649.5448    0  271 39165.2698 63649.5448  62.5%     -  206s
     0     0 63620.0395    0  271 39165.2698 63620.0395  62.4%     -  208s
     0     0 63613.9499    0  275 39165.2698 63613.9499  62.4%     -  209s
     0     0 63612.8707    0  275 39165.2698 63612.8707  62.4%     -  209s
     0     0 63612.6296    0  275 39165.2698 63612.6296  62.4%     -  209s
     0     0 61845.7212    0  272 39165.2698 61845.7212  57.9%     -  245s
     0     0 61429.0359    0  316 39165.2698 61429.0359  56.8%     -  259s
H    0     0                    39737.010430 61264.8123  54.2%     -  271s
H    0     0                    39782.967015 61264.8123  54.0%     -  271s
H    0     0                    40100.216543 61264.8123  52.8%     -  271s
H    0     0                    40146.605644 61264.8123  52.6%     -  271s
H    0     0                    40277.647199 61264.8123  52.1%     -  271s
H    0     0                    40316.623338 61264.8123  52.0%     -  271s
H    0     0                    40325.324323 61264.8123  51.9%     -  271s
     0     0 61264.8123    0  322 40325.3243 61264.8123  51.9%     -  271s
     0     0 61146.7424    0  322 40325.3243 61146.7424  51.6%     -  281s
     0     0 61068.6951    0  322 40325.3243 61068.6951  51.4%     -  287s
     0     0 61041.2840    0  321 40325.3243 61041.2840  51.4%     -  290s
     0     0 61004.5639    0  321 40325.3243 61004.5639  51.3%     -  296s
     0     0 60992.4236    0  324 40325.3243 60992.4236  51.3%     -  299s
     0     0 60985.0126    0  322 40325.3243 60985.0126  51.2%     -  302s
     0     0 60982.9692    0  323 40325.3243 60982.9692  51.2%     -  303s
     0     0 60982.3584    0  326 40325.3243 60982.3584  51.2%     -  304s
H    0     0                    41270.208033 59989.9808  45.4%     -  338s
     0     0 59989.9808    0  354 41270.2080 59989.9808  45.4%     -  338s
     0     0 59735.2438    0  349 41270.2080 59735.2438  44.7%     -  349s
     0     0 59679.2956    0  353 41270.2080 59679.2956  44.6%     -  355s
     0     0 59647.3071    0  357 41270.2080 59647.3071  44.5%     -  357s
     0     0 59602.5705    0  355 41270.2080 59602.5705  44.4%     -  363s
     0     0 59464.3135    0  362 41270.2080 59464.3135  44.1%     -  371s
     0     0 59423.4028    0  356 41270.2080 59423.4028  44.0%     -  376s
     0     0 59410.0743    0  366 41270.2080 59410.0743  44.0%     -  378s
     0     0 59408.5848    0  368 41270.2080 59408.5848  44.0%     -  379s
     0     0 59183.8787    0  337 41270.2080 59183.8787  43.4%     -  393s
H    0     0                    41393.737533 59183.3601  43.0%     -  394s
H    0     0                    41407.560942 59183.3601  42.9%     -  394s
     0     0 59065.5055    0  325 41407.5609 59065.5055  42.6%     -  402s
     0     0 59041.1540    0  331 41407.5609 59041.1540  42.6%     -  410s
     0     0 59029.5239    0  327 41407.5609 59029.5239  42.6%     -  416s
     0     0 59023.5600    0  382 41407.5609 59023.5600  42.5%     -  419s
     0     0 59007.8839    0  380 41407.5609 59007.8839  42.5%     -  422s
     0     0 58969.9726    0  326 41407.5609 58969.9726  42.4%     -  427s
     0     0 58962.4314    0  327 41407.5609 58962.4314  42.4%     -  430s
     0     0 58956.7052    0  326 41407.5609 58956.7052  42.4%     -  432s
     0     0 58954.1728    0  327 41407.5609 58954.1728  42.4%     -  432s
     0     0 58951.5544    0  325 41407.5609 58951.5544  42.4%     -  433s
     0     0 58950.5430    0  323 41407.5609 58950.5430  42.4%     -  434s
     0     0 58855.2400    0  332 41407.5609 58855.2400  42.1%     -  444s
H    0     0                    41408.365057 58853.8170  42.1%     -  446s
     0     0 58840.2385    0  404 41408.3651 58840.2385  42.1%     -  449s
     0     0 58835.7201    0  330 41408.3651 58835.7201  42.1%     -  451s
     0     0 58827.6473    0  329 41408.3651 58827.6473  42.1%     -  453s
     0     0 58823.7660    0  318 41408.3651 58823.7660  42.1%     -  454s
     0     0 58820.7237    0  326 41408.3651 58820.7237  42.1%     -  455s
     0     0 58820.1045    0  329 41408.3651 58820.1045  42.0%     -  456s
     0     0 58769.2858    0  396 41408.3651 58769.2858  41.9%     -  462s
H    0     0                    41440.430486 58769.0660  41.8%     -  463s
     0     0 58755.7783    0  382 41440.4305 58755.7783  41.8%     -  467s
     0     0 58749.4066    0  401 41440.4305 58749.4066  41.8%     -  469s
     0     0 58745.3953    0  397 41440.4305 58745.3953  41.8%     -  472s
     0     0 58740.8897    0  396 41440.4305 58740.8897  41.7%     -  474s
     0     0 58739.5646    0  393 41440.4305 58739.5646  41.7%     -  475s
     0     0 58707.0676    0  384 41440.4305 58707.0676  41.7%     -  480s
     0     0 58696.3247    0  387 41440.4305 58696.3247  41.6%     -  485s
     0     0 58693.2686    0  388 41440.4305 58693.2686  41.6%     -  486s
     0     0 58692.3426    0  384 41440.4305 58692.3426  41.6%     -  487s
     0     0 58676.7065    0  409 41440.4305 58676.7065  41.6%     -  490s
     0     0 58674.5010    0  364 41440.4305 58674.5010  41.6%     -  492s
     0     0 58673.2879    0  410 41440.4305 58673.2879  41.6%     -  493s
     0     0 58657.5549    0  377 41440.4305 58657.5549  41.5%     -  498s
H    0     0                    41573.579926 58657.4129  41.1%     -  506s
     0     0 58653.2674    0  368 41573.5799 58653.2674  41.1%     -  510s
     0     0 58652.8686    0  373 41573.5799 58652.8686  41.1%     -  510s
     0     0 58646.3176    0  323 41573.5799 58646.3176  41.1%     -  514s
     0     0 58641.6388    0  377 41573.5799 58641.6388  41.1%     -  518s
     0     0 58640.7535    0  382 41573.5799 58640.7535  41.1%     -  519s
     0     0 58632.9705    0  344 41573.5799 58632.9705  41.0%     -  523s
     0     0 58630.5040    0  337 41573.5799 58630.5040  41.0%     -  532s
     0     0 58629.6650    0  396 41573.5799 58629.6650  41.0%     -  533s
     0     0 58628.9236    0  404 41573.5799 58628.9236  41.0%     -  535s
     0     0 58627.8781    0  400 41573.5799 58627.8781  41.0%     -  537s
     0     0 58623.9455    0  420 41573.5799 58623.9455  41.0%     -  540s
     0     0 58623.6559    0  420 41573.5799 58623.6559  41.0%     -  542s
     0     2 58623.5247    0  420 41573.5799 58623.5247  41.0%     -  645s
     1     3 57969.6294    1  306 41573.5799 58623.5247  41.0% 11850  661s
     2     4 58119.7345    1  374 41573.5799 58119.7345  39.8%  7169  675s
     3     8 57499.5748    2  338 41573.5799 58118.7837  39.8%  7522  685s
     7    16 57190.4103    3  331 41573.5799 58000.4483  39.5%  6480  700s
    15    32 57124.0299    4  332 41573.5799 57678.8809  38.7%  7227  725s
    31    48 57069.8814    5  357 41573.5799 57446.1848  38.2% 12381  770s
    47    80 56023.1622    6  365 41573.5799 57446.1848  38.2% 11482  801s
    79   126 55985.0216    7  366 41573.5799 57446.1848  38.2%  9254  874s
   125   255 55890.5811    8  362 41573.5799 57446.1848  38.2%  6739  909s
   254   312 55456.7569   12  349 41573.5799 57446.1848  38.2%  4533  938s
   311   360 55210.5493   15  347 41573.5799 57446.1848  38.2%  4422  962s
   359   440 53462.8174   17  287 41573.5799 57446.1848  38.2%  4497  987s
   439   523 54130.7100   15  315 41573.5799 57446.1848  38.2%  4254 1008s
   524   604 52797.8064   16  335 41573.5799 57446.1848  38.2%  4004 1028s
   613   630 52664.0672   17  334 41573.5799 57446.1848  38.2%  3799 1043s
   645   656 52596.8581   18  332 41573.5799 57446.1848  38.2%  3748 1060s
   677   684 52527.5543   19  330 41573.5799 57446.1848  38.2%  3706 1075s
   711   713 52488.6084   20  320 41573.5799 57446.1848  38.2%  3681 1093s
   742   736 52299.8314   21  316 41573.5799 57446.1848  38.2%  3657 1109s
   783   767 52097.2671   22  311 41573.5799 57446.1848  38.2%  3594 1121s
   836   814 51997.1122   23  316 41573.5799 57446.1848  38.2%  3504 1140s
   897   871 51756.0837   24  308 41573.5799 57446.1848  38.2%  3446 1159s
   962   927 51647.2426   25  283 41573.5799 57446.1848  38.2%  3354 1178s
  1054   970 51470.0069   26  284 41573.5799 57446.1848  38.2%  3219 1200s
  1129  1005 51306.7873   27  277 41573.5799 57446.1848  38.2%  3172 1220s
  1196  1062 51050.6003   28  281 41573.5799 57446.1848  38.2%  3190 1240s
  1275  1140 50524.6397   29  261 41573.5799 57446.1848  38.2%  3165 1263s
  1373  1228 50217.2052   30  262 41573.5799 57226.6461  37.7%  3118 1285s
  1500  1286 49877.4092   31  255 41573.5799 57226.6461  37.7%  3016 1309s
  1590  1286 infeasible   50      41573.5799 57226.6461  37.7%  3006 1310s
  1605  1363 48620.4485   33  230 41573.5799 57226.6461  37.7%  2998 1335s
  1714  1450 48353.2730   35  153 41573.5799 57226.6461  37.7%  2989 1360s
  1835  1520 47173.3131   37  178 41573.5799 57226.5594  37.7%  2962 1386s
  1950  1607 46243.6196   41  185 41573.5799 57226.5594  37.7%  2954 1412s
  2083  1716 44496.9009   51  165 41573.5799 57226.5594  37.7%  2946 1441s
  2247  1830 42473.5592   65  146 41573.5799 57123.9839  37.4%  2906 1472s
  2385  1918 48847.9291   15  241 41573.5799 57123.9839  37.4%  2893 1504s
  2535  1988 46527.3608   17  244 41573.5799 57123.9839  37.4%  2896 1539s
  2672  2071 46206.7786   18  282 41573.5799 56911.3998  36.9%  2908 1572s
  2804  2178 42914.4534   22  162 41573.5799 56911.0441  36.9%  2921 1610s
  2961  2232 41857.6716   31  107 41573.5799 56911.0441  36.9%  2921 1648s
  3105  2282 43378.7184   49  162 41573.5799 56911.0441  36.9%  2948 1687s
  3239  2365 42537.5174   53  165 41573.5799 56911.0441  36.9%  2993 1726s
  3407  2452 infeasible   54      41573.5799 56911.0441  36.9%  3003 1768s
  3542  2557 51376.2703    7  311 41573.5799 55955.4338  34.6%  3047 1812s
  3697  2625 46209.1194    9  305 41573.5799 55955.4338  34.6%  3077 1857s
  3866  2728 43895.8883   12  240 41573.5799 55955.4338  34.6%  3095 1903s
  4049  2852 42167.5462   15  184 41573.5799 55743.3532  34.1%  3094 1949s
  4278  2853 50623.2699   24  420 41573.5799 55743.3532  34.1%  3088 2027s
  4280  2854 42885.1291   28   83 41573.5799 55743.3532  34.1%  3087 2076s
  4281  2855 47700.4757   10  297 41573.5799 55743.3532  34.1%  3086 2122s
  4282  2856 46679.0427   28  310 41573.5799 55743.3532  34.1%  3085 2152s
  4283  2856 54045.4320   15  339 41573.5799 55743.3532  34.1%  3085 2169s
  4284  2857 47354.2466   12  357 41573.5799 55743.3532  34.1%  3084 2189s
  4285  2858 45394.9172   32  376 41573.5799 55743.3532  34.1%  3083 2201s
  4286  2858 45899.0219   26  338 41573.5799 55743.3532  34.1%  3082 2208s
  4287  2859 54145.4888   17  393 41573.5799 55743.3532  34.1%  3082 2217s
  4288  2860 44612.3770   48  345 41573.5799 55743.3532  34.1%  3081 2225s
  4289  2860 45519.5349   46  404 41573.5799 55743.3532  34.1%  3080 2234s
  4290  2861 45769.9373   42  371 41573.5799 55743.3532  34.1%  3080 2239s
  4291  2862 52597.8504   26  395 41573.5799 55743.3532  34.1%  3079 2245s
  4292  2862 42986.3512   40  399 41573.5799 55743.3532  34.1%  3078 2259s
  4293  2863 51359.3344   14  400 41573.5799 55743.3532  34.1%  3077 2267s
  4294  2864 43078.5280   51  408 41573.5799 55743.3532  34.1%  3077 2272s
  4295  2864 49709.5526   15  396 41573.5799 55743.3532  34.1%  3076 2286s
  4296  2865 52858.1960   12  395 41573.5799 55743.3532  34.1%  3075 2292s
  4297  2866 46250.3749   28  334 41573.5799 55743.3532  34.1%  3075 2297s
  4298  2866 44714.2018   31  374 41573.5799 55743.3532  34.1%  3074 2309s
  4299  2867 43965.7359   27  365 41573.5799 55743.3532  34.1%  3073 2316s
  4300  2868 45145.8145   29  377 41573.5799 55743.3532  34.1%  3072 2325s
  4301  2868 51740.5904   14  418 41573.5799 55743.3532  34.1%  3072 2331s
  4302  2869 44557.6840   15  420 41573.5799 55743.3532  34.1%  3071 2342s
  4303  2870 43862.9990   52  383 41573.5799 55743.3532  34.1%  3070 2348s
  4304  2870 42482.2405   55  393 41573.5799 55743.3532  34.1%  3070 2357s
  4305  2871 46515.6270   33  406 41573.5799 55743.3532  34.1%  3069 2364s
  4306  2872 41911.5030   37  407 41573.5799 55743.3532  34.1%  3068 2372s
  4307  2872 43074.5137   41  377 41573.5799 55743.3532  34.1%  3067 2377s
  4308  2873 49114.3154   26  348 41573.5799 55743.3532  34.1%  3067 2385s
  4310  2874 55332.6007    8  345 41573.5799 55743.3532  34.1%  3065 2393s
  4311  2875 52268.9976   20  345 41573.5799 55743.3532  34.1%  3065 2440s
  4312  2876 42713.5031   37  345 41573.5799 55743.3532  34.1%  3064 2502s
  4313  2879 55743.3532   15  374 41573.5799 55743.3532  34.1%  3120 2612s
  4315  2883 55743.3532   16  430 41573.5799 55743.3532  34.1%  3123 2647s
  4319  2889 55743.3532   17  409 41573.5799 55743.3532  34.1%  3128 2687s
  4327  2903 55743.3532   18  417 41573.5799 55743.3532  34.1%  3144 2742s
  4343  2916 55602.9014   19  297 41573.5799 55743.3532  34.1%  3216 2815s
  4362  2942 55743.3532   20  349 41573.5799 55743.3532  34.1%  3257 2850s
  4394  3038 55743.3532   21  366 41573.5799 55743.3532  34.1%  3319 2902s
  4501  3057 55093.2327   24  321 41573.5799 55743.3532  34.1%  3419 2931s
  4555  3071 54463.5250   24  274 41573.5799 55743.3532  34.1%  3436 2956s
  4587  3098 55352.0610   23  318 41573.5799 55743.3532  34.1%  3459 2984s
  4627  3128 53578.6175   25  262 41573.5799 55743.3532  34.1%  3481 3011s
  4681  3149 52936.8810   25  233 41573.5799 55743.3532  34.1%  3500 3040s
  4747  3162 50597.8039   25  243 41573.5799 55743.3532  34.1%  3514 3069s
  4823  3154 52808.3369   26  232 41573.5799 55743.3532  34.1%  3513 3101s
  4887  3139 50940.5626   27  214 41573.5799 55743.3532  34.1%  3525 3130s
  4942  3146 50922.1029   29  230 41573.5799 55743.3532  34.1%  3545 3158s
  4994  3146 46642.3058   31  151 41573.5799 55743.3532  34.1%  3567 3192s
  5049  3148 46555.1192   29  233 41573.5799 55743.3532  34.1%  3596 3220s
  5105  3152 47050.6930   31  171 41573.5799 55743.3532  34.1%  3619 3249s
  5159  3144 46222.1216   32  152 41573.5799 55743.3532  34.1%  3643 3270s
  5200  3146 45566.0454   33  154 41573.5799 55743.3532  34.1%  3664 3303s
  5246  3139 44780.4677   32  157 41573.5799 55743.3532  34.1%  3676 3329s
  5290  3145 46220.6283   32  209 41573.5799 55743.3532  34.1%  3697 3358s
  5333  3145 44147.2802   33  154 41573.5799 55743.3532  34.1%  3715 3387s
  5367  3156 44269.7004   34  141 41573.5799 55743.3532  34.1%  3734 3418s
  5430  3150 42341.0215   35   97 41573.5799 55743.3532  34.1%  3747 3453s
  5503  3166 42448.1811   35  104 41573.5799 55743.3532  34.1%  3761 3488s
  5577  3169 infeasible   37      41573.5799 55743.3532  34.1%  3776 3529s
  5655  3179 47754.6979   21  293 41573.5799 55743.3532  34.1%  3798 3563s
  5741  3206 46131.1647   23  243 41573.5799 55743.3532  34.1%  3816 3600s

Cutting planes:
  MIR: 875
  Mixing: 2
  Flow cover: 1459
  RLT: 10
  Relax-and-lift: 84

Explored 5829 nodes (22696888 simplex iterations) in 3600.08 seconds (5718.98 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41573.6 41440.4 41408.4 ... 40146.6

Time limit reached
Best objective 4.157357992582e+04, best bound 5.574335316690e+04, gap 34.0836%
  WARNING: Time limit reached. Using best solution found (gap: 34.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 41573.58, θ = 207520.24
  Upper Bound (UB) = 41573.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 207520.24
  [DEBUG]   ✓ Scenario 0: θ = 207520.24 ≤ Q = 207520.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 207520.24 ≤ Q = 207520.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 207520.24 ≤ Q = 207520.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 207520.24 ≤ Q = 207520.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 207520.24 ≤ Q = 207520.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 207520.24 ≤ Q = 207520.24 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 207520.24 ≤ Q = 207520.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 207520.24 ≤ Q = 207520.24 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 207520.24 ≤ Q = 207520.24 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x14056851
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x14056851
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.402866e+13
Presolve removed 2597 rows and 1888 columns
Presolve time: 0.01s
Presolved: 496 rows, 501 columns, 1402 nonzeros
Found heuristic solution: objective 6243543.9242
Variable types: 341 continuous, 160 integer (160 binary)

Root relaxation: objective -1.940418e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194041.81    0  128 6243543.92 -194041.81   103%     -    0s
H    0     0                    -157462.2900 -194041.81  23.2%     -    0s
H    0     0                    -158799.1467 -194041.81  22.2%     -    0s
H    0     0                    -166336.0845 -194041.81  16.7%     -    0s
H    0     0                    -171988.3201 -194041.81  12.8%     -    0s
     0     0 -177345.59    0  108 -171988.32 -177345.59  3.11%     -    0s
H    0     0                    -173274.2423 -177223.17  2.28%     -    0s
H    0     0                    -173598.5828 -177223.17  2.09%     -    0s
     0     0 -176420.25    0  109 -173598.58 -176420.25  1.63%     -    0s
     0     0 -176410.24    0  109 -173598.58 -176410.24  1.62%     -    0s
     0     0 -174829.97    0   88 -173598.58 -174829.97  0.71%     -    0s
H    0     0                    -173808.4548 -174827.08  0.59%     -    0s
H    0     0                    -174072.6595 -174827.08  0.43%     -    0s
H    0     0                    -174119.7043 -174780.64  0.38%     -    0s
     0     0 -174780.64    0   90 -174119.70 -174780.64  0.38%     -    0s
     0     0 -174579.33    0   18 -174119.70 -174579.33  0.26%     -    0s
     0     0 -174562.63    0   18 -174119.70 -174562.63  0.25%     -    0s
H    0     0                    -174214.2016 -174547.63  0.19%     -    0s
     0     0 -174510.94    0   19 -174214.20 -174510.94  0.17%     -    0s
     0     0 -174506.18    0   18 -174214.20 -174506.18  0.17%     -    0s
     0     0 -174482.79    0   12 -174214.20 -174482.79  0.15%     -    0s
H    0     0                    -174259.7583 -174443.42  0.11%     -    0s
     0     0 -174443.42    0   13 -174259.76 -174443.42  0.11%     -    0s
     0     0 -174443.42    0   12 -174259.76 -174443.42  0.11%     -    0s
     0     0 -174443.42    0   50 -174259.76 -174443.42  0.11%     -    0s
     0     0 -174443.42    0   33 -174259.76 -174443.42  0.11%     -    0s
*    0     0               0    -174318.0141 -174318.01  0.00%     -    0s

Cutting planes:
  Gomory: 29
  Implied bound: 1
  MIR: 33
  Flow cover: 20

Explored 1 nodes (919 simplex iterations) in 0.18 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -174318 -174260 -174214 ... -166336
No other solutions better than -174318

Optimal solution found (tolerance 1.00e-06)
Best objective -1.743180140869e+05, best bound -1.743180140869e+05, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 194728.96
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -174318.01
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -174318.01 = 194728.96
  [DEBUG]   Current θ from Master = 207520.24
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12791.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28782.30
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 2613.1781, Absolute Gap = 2613.1781, Relative Gap = 0.062857
  Not converged yet (gap = 2613.18 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0x8b49cbad
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 3.42s
Presolved: 83583 rows, 35960 columns, 511919 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -323047.1494
Found heuristic solution: objective -173969.7691

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.585e+06
 Factor NZ  : 7.691e+06 (roughly 100 MB of memory)
 Factor Ops : 1.319e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.07259235e+07  1.78016657e+08  1.65e+05 2.37e+01  1.04e+05     5s
   1  -1.59431958e+07  1.67895666e+08  1.18e+05 1.19e+02  7.35e+04     5s
   2  -6.71401009e+06  1.34021074e+08  4.76e+04 3.58e+01  3.07e+04     5s
   3  -1.49022249e+06  9.86305804e+07  6.28e+03 1.14e+00  4.52e+03     6s
   4  -7.36683193e+05  5.59573740e+07  1.04e+03 2.77e-01  9.51e+02     6s
   5  -6.24891795e+05  3.16257896e+07  4.73e+02 1.27e-01  4.47e+02     6s
   6  -4.80936608e+05  2.26740250e+07  1.69e+02 8.24e-02  2.29e+02     6s
   7  -3.59276519e+05  1.64506138e+07  6.76e+01 5.62e-02  1.38e+02     6s
   8  -2.23423303e+05  1.16205689e+07  2.15e+01 3.83e-02  8.44e+01     6s
   9  -1.60249309e+05  7.87756927e+06  1.17e+01 2.51e-02  5.53e+01     6s
  10  -1.12289240e+05  3.63249420e+06  6.80e+00 1.10e-02  2.53e+01     6s
  11  -5.73931575e+04  5.63302029e+05  1.82e+00 1.32e-03  4.11e+00     6s
  12  -1.93235343e+04  3.03981629e+05  1.08e+00 1.10e-03  2.13e+00     6s
  13   4.48648857e+03  2.39507068e+05  7.19e-01 8.00e-04  1.54e+00     6s
  14   1.54577791e+04  1.86186481e+05  5.92e-01 1.20e-03  1.12e+00     6s
  15   2.72231688e+04  1.56770770e+05  4.59e-01 1.42e-03  8.51e-01     6s
  16   4.02689376e+04  1.37851281e+05  3.08e-01 1.77e-03  6.40e-01     6s
  17   5.08203715e+04  1.21638418e+05  1.94e-01 1.65e-03  4.64e-01     6s
  18   5.36532570e+04  1.03279741e+05  1.66e-01 1.98e-03  3.25e-01     6s
  19   5.88504525e+04  9.62630578e+04  1.21e-01 2.18e-03  2.45e-01     7s
  20   6.21513934e+04  9.05120318e+04  9.48e-02 1.87e-03  1.86e-01     7s
  21   6.52481092e+04  8.54897715e+04  7.11e-02 2.41e-03  1.33e-01     7s
  22   6.70218296e+04  8.18043031e+04  5.76e-02 2.24e-03  9.70e-02     7s
  23   6.91114169e+04  8.09365140e+04  4.35e-02 1.95e-03  7.76e-02     7s
  24   7.07610075e+04  7.91703943e+04  3.24e-02 1.43e-03  5.52e-02     7s
  25   7.19731043e+04  7.82576811e+04  2.44e-02 1.02e-03  4.12e-02     7s
  26   7.31173101e+04  7.74227485e+04  1.70e-02 5.79e-04  2.83e-02     7s
  27   7.33659457e+04  7.71106985e+04  1.54e-02 4.60e-04  2.46e-02     7s
  28   7.35852239e+04  7.67124037e+04  1.39e-02 3.13e-04  2.05e-02     7s
  29   7.41278390e+04  7.65790589e+04  1.04e-02 2.57e-04  1.61e-02     7s
  30   7.43931383e+04  7.64138857e+04  8.76e-03 2.48e-04  1.33e-02     7s
  31   7.44766227e+04  7.62359815e+04  8.22e-03 1.86e-04  1.16e-02     7s
  32   7.48114433e+04  7.61136296e+04  6.20e-03 1.44e-04  8.56e-03     8s
  33   7.49581492e+04  7.60170508e+04  5.32e-03 2.61e-04  6.96e-03     8s
  34   7.53069749e+04  7.59986321e+04  3.22e-03 2.29e-04  4.55e-03     8s
  35   7.54065465e+04  7.59702175e+04  2.63e-03 1.77e-04  3.70e-03     8s
  36   7.55436818e+04  7.59505291e+04  1.80e-03 1.43e-04  2.67e-03     8s
  37   7.56253775e+04  7.59062130e+04  1.33e-03 6.58e-05  1.85e-03     8s
  38   7.57612856e+04  7.58835525e+04  5.63e-04 2.58e-05  8.04e-04     8s
  39   7.57980691e+04  7.58758400e+04  3.66e-04 1.91e-05  5.11e-04     8s
  40   7.58310134e+04  7.58730928e+04  1.85e-04 1.24e-05  2.76e-04     8s
  41   7.58370985e+04  7.58721076e+04  1.52e-04 1.03e-05  2.30e-04     8s
  42   7.58560494e+04  7.58705647e+04  5.17e-05 6.95e-06  9.52e-05     8s
  43   7.58665061e+04  7.58671836e+04  3.51e-06 2.37e-06  4.44e-06     8s
  44   7.58670602e+04  7.58670632e+04  8.56e-08 6.39e-08  1.96e-08     8s
  45   7.58670622e+04  7.58670631e+04  4.49e-07 5.68e-08  5.51e-09     9s
  46   7.58670631e+04  7.58670631e+04  7.89e-08 6.92e-08  1.81e-10     9s

Barrier solved model in 46 iterations and 8.62 seconds (6.95 work units)
Optimal objective 7.58670631e+04


Root crossover log...

   74878 DPushes remaining with DInf 0.0000000e+00                 9s
   12130 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    1322 PPushes remaining with PInf 9.0856598e-06                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2246039e+00     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35665    7.5867063e+04   0.000000e+00   1.224604e+00     12s
   35673    7.5867063e+04   0.000000e+00   0.000000e+00     12s
   35673    7.5867063e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 7.586706e+04, 35673 iterations, 7.85 seconds (10.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 75867.0631    0  151 -173969.77 75867.0631   144%     -   12s
H    0     0                    -170707.6596 75867.0631   144%     -   12s
H    0     0                    -124729.7556 75867.0631   161%     -   13s
H    0     0                    -105235.8489 75867.0631   172%     -   13s
H    0     0                    -51625.61957 75867.0631   247%     -   13s
H    0     0                    13772.113837 75867.0631   451%     -   13s
H    0     0                    13865.414047 75867.0631   447%     -   14s
H    0     0                    28459.397330 75867.0631   167%     -   14s
     0     0 69993.9148    0  109 28459.3973 69993.9148   146%     -   51s
H    0     0                    28771.118422 69993.9148   143%     -   52s
     0     0 69456.4374    0  111 28771.1184 69456.4374   141%     -   72s
     0     0 69456.4374    0  113 28771.1184 69456.4374   141%     -   75s
     0     0 69298.7610    0  119 28771.1184 69298.7610   141%     -   80s
     0     0 69298.7610    0  119 28771.1184 69298.7610   141%     -   80s
     0     0 66512.4281    0  274 28771.1184 66512.4281   131%     -  117s
H    0     0                    31484.084709 66512.4281   111%     -  117s
H    0     0                    31604.554101 66512.4281   110%     -  117s
     0     0 65240.5303    0  304 31604.5541 65240.5303   106%     -  153s
     0     0 64922.1343    0  318 31604.5541 64922.1343   105%     -  172s
     0     0 64830.5661    0  307 31604.5541 64830.5661   105%     -  183s
     0     0 64814.3663    0  305 31604.5541 64814.3663   105%     -  187s
     0     0 64812.2151    0  317 31604.5541 64812.2151   105%     -  188s
     0     0 64808.5438    0  303 31604.5541 64808.5438   105%     -  190s
     0     0 64804.8500    0  314 31604.5541 64804.8500   105%     -  191s
     0     0 64804.1092    0  318 31604.5541 64804.1092   105%     -  192s
H    0     0                    32946.253788 62461.4800  89.6%     -  246s
H    0     0                    33330.361452 62461.4800  87.4%     -  246s
H    0     0                    33454.312771 62461.4800  86.7%     -  246s
H    0     0                    33611.972244 62461.4800  85.8%     -  246s
H    0     0                    33613.944215 62461.4800  85.8%     -  246s
H    0     0                    33849.959123 62461.4800  84.5%     -  246s
     0     0 62461.4800    0  324 33849.9591 62461.4800  84.5%     -  246s
     0     0 61680.4345    0  349 33849.9591 61680.4345  82.2%     -  275s
H    0     0                    33897.819941 61496.0973  81.4%     -  291s
H    0     0                    33977.067968 61496.0973  81.0%     -  291s
     0     0 61496.0973    0  343 33977.0680 61496.0973  81.0%     -  291s
     0     0 61432.6441    0  355 33977.0680 61432.6441  80.8%     -  300s
     0     0 61411.7139    0  353 33977.0680 61411.7139  80.7%     -  304s
H    0     0                    34090.260609 61387.2185  80.1%     -  309s
H    0     0                    34420.047355 61387.2185  78.3%     -  309s
     0     0 61387.2185    0  367 34420.0474 61387.2185  78.3%     -  309s
H    0     0                    34466.294517 61360.3676  78.0%     -  315s
     0     0 61360.3676    0  359 34466.2945 61360.3676  78.0%     -  315s
     0     0 61355.7953    0  370 34466.2945 61355.7953  78.0%     -  318s
     0     0 61352.5372    0  364 34466.2945 61352.5372  78.0%     -  322s
     0     0 61338.6579    0  364 34466.2945 61338.6579  78.0%     -  328s
     0     0 61336.7839    0  364 34466.2945 61336.7839  78.0%     -  330s
     0     0 61317.2087    0  354 34466.2945 61317.2087  77.9%     -  333s
     0     0 61314.6251    0  358 34466.2945 61314.6251  77.9%     -  334s
     0     0 61309.2534    0  361 34466.2945 61309.2534  77.9%     -  336s
     0     0 61308.4148    0  364 34466.2945 61308.4148  77.9%     -  337s
     0     0 60217.2982    0  374 34466.2945 60217.2982  74.7%     -  388s
H    0     0                    34757.914735 60217.1147  73.2%     -  389s
H    0     0                    34769.506525 60217.1147  73.2%     -  389s
H    0     0                    35136.056741 60217.1147  71.4%     -  389s
     0     0 59918.0314    0  308 35136.0567 59918.0314  70.5%     -  408s
     0     0 59787.2136    0  381 35136.0567 59787.2136  70.2%     -  417s
     0     0 59741.4584    0  371 35136.0567 59741.4584  70.0%     -  424s
     0     0 59704.3682    0  371 35136.0567 59704.3682  69.9%     -  430s
     0     0 59668.6281    0  377 35136.0567 59668.6281  69.8%     -  436s
     0     0 59640.1836    0  379 35136.0567 59640.1836  69.7%     -  443s
     0     0 59632.6236    0  381 35136.0567 59632.6236  69.7%     -  446s
     0     0 59585.1690    0  379 35136.0567 59585.1690  69.6%     -  454s
     0     0 59573.3601    0  383 35136.0567 59573.3601  69.6%     -  457s
     0     0 59562.6143    0  386 35136.0567 59562.6143  69.5%     -  460s
     0     0 59550.0553    0  388 35136.0567 59550.0553  69.5%     -  463s
     0     0 59548.0196    0  383 35136.0567 59548.0196  69.5%     -  464s
     0     0 59211.4988    0  384 35136.0567 59211.4988  68.5%     -  485s
     0     0 59157.7265    0  377 35136.0567 59157.7265  68.4%     -  495s
     0     0 59124.1268    0  379 35136.0567 59124.1268  68.3%     -  500s
     0     0 59095.5583    0  393 35136.0567 59095.5583  68.2%     -  504s
     0     0 59079.7832    0  400 35136.0567 59079.7832  68.1%     -  509s
     0     0 59063.3020    0  394 35136.0567 59063.3020  68.1%     -  512s
     0     0 59050.2507    0  396 35136.0567 59050.2507  68.1%     -  515s
H    0     0                    35240.667911 59038.0790  67.5%     -  518s
     0     0 59038.0790    0  389 35240.6679 59038.0790  67.5%     -  518s
H    0     0                    35241.917837 59033.5057  67.5%     -  521s
H    0     0                    35354.501201 59033.5057  67.0%     -  521s
H    0     0                    35481.617574 59033.5057  66.4%     -  521s
     0     0 59033.5057    0  394 35481.6176 59033.5057  66.4%     -  521s
     0     0 59027.2463    0  390 35481.6176 59027.2463  66.4%     -  522s
     0     0 59023.2584    0  381 35481.6176 59023.2584  66.3%     -  524s
     0     0 59019.5947    0  381 35481.6176 59019.5947  66.3%     -  525s
     0     0 59016.9851    0  419 35481.6176 59016.9851  66.3%     -  526s
     0     0 59016.2931    0  388 35481.6176 59016.2931  66.3%     -  527s
     0     0 58836.2418    0  334 35481.6176 58836.2418  65.8%     -  540s
     0     0 58800.6831    0  403 35481.6176 58800.6831  65.7%     -  545s
     0     0 58758.3435    0  366 35481.6176 58758.3435  65.6%     -  550s
     0     0 58740.2647    0  435 35481.6176 58740.2647  65.6%     -  553s
     0     0 58736.3102    0  405 35481.6176 58736.3102  65.5%     -  554s
     0     0 58735.6784    0  401 35481.6176 58735.6784  65.5%     -  556s
     0     0 58650.3634    0  421 35481.6176 58650.3634  65.3%     -  565s
     0     0 58632.1227    0  429 35481.6176 58632.1227  65.2%     -  569s
     0     0 58616.0561    0  428 35481.6176 58616.0561  65.2%     -  573s
     0     0 58609.7885    0  434 35481.6176 58609.7885  65.2%     -  575s
     0     0 58605.3926    0  424 35481.6176 58605.3926  65.2%     -  577s
     0     0 58604.9058    0  428 35481.6176 58604.9058  65.2%     -  578s
     0     0 58525.4954    0  428 35481.6176 58525.4954  64.9%     -  587s
     0     0 58501.8709    0  360 35481.6176 58501.8709  64.9%     -  592s
     0     0 58494.0625    0  361 35481.6176 58494.0625  64.9%     -  595s
     0     0 58485.7072    0  422 35481.6176 58485.7072  64.8%     -  599s
     0     0 58482.7991    0  424 35481.6176 58482.7991  64.8%     -  602s
     0     0 58481.8496    0  427 35481.6176 58481.8496  64.8%     -  603s
     0     0 58464.0665    0  412 35481.6176 58464.0665  64.8%     -  609s
     0     0 58454.2568    0  363 35481.6176 58454.2568  64.7%     -  613s
     0     0 58452.2650    0  415 35481.6176 58452.2650  64.7%     -  614s
     0     0 58422.2161    0  411 35481.6176 58422.2161  64.7%     -  620s
     0     0 58416.4933    0  410 35481.6176 58416.4933  64.6%     -  625s
     0     0 58415.6795    0  416 35481.6176 58415.6795  64.6%     -  626s
     0     0 58409.6356    0  429 35481.6176 58409.6356  64.6%     -  630s
     0     0 58405.5928    0  425 35481.6176 58405.5928  64.6%     -  633s
     0     0 58402.8256    0  427 35481.6176 58402.8256  64.6%     -  635s
     0     0 58401.3666    0  422 35481.6176 58401.3666  64.6%     -  636s
     0     0 58389.9146    0  424 35481.6176 58389.9146  64.6%     -  640s
     0     0 58381.8964    0  426 35481.6176 58381.8964  64.5%     -  650s
     0     0 58381.2305    0  427 35481.6176 58381.2305  64.5%     -  651s
     0     0 58372.6973    0  438 35481.6176 58372.6973  64.5%     -  656s
     0     0 58372.6796    0  438 35481.6176 58372.6796  64.5%     -  658s
H    0     0                    37522.537415 58372.6478  55.6%     -  778s
H    0     0                    37944.452083 58372.6478  53.8%     -  778s
H    0     0                    38280.040222 58372.6478  52.5%     -  781s
H    0     2                    40241.207168 58372.6478  45.1%     -  783s
     0     2 58372.6478    0  438 40241.2072 58372.6478  45.1%     -  783s
     1     3 57839.8818    1  371 40241.2072 58372.3939  45.1% 12865  801s
     2     4 58226.1558    1  409 40241.2072 58226.1558  44.7%  9804  815s
     3     7 56105.4299    2  312 40241.2072 58225.6511  44.7%  8741  834s
     6    14 56855.6047    3  402 40241.2072 58225.6511  44.7%  8767  870s
    13    28 56053.9482    4  396 40241.2072 57889.4341  43.9% 10546  902s
    27    42 56391.9590    5  412 40241.2072 57411.8237  42.7% 15741  960s
    41    74 54858.2844    6  397 40241.2072 57411.8237  42.7% 13961 1047s
H   42    74                    40854.986191 57411.8237  40.5% 13629 1047s
H   47    74                    40924.283238 57411.8237  40.3% 13565 1047s
H   53    74                    40938.009627 57411.8237  40.2% 13162 1047s
    73   158 54823.9325    7  403 40938.0096 57153.6253  39.6% 14173 1125s
   157   198 54738.8342   10  326 40938.0096 57151.8047  39.6%  9783 1158s
H  169   198                    40968.538234 57151.8047  39.5%  9341 1158s
H  172   198                    41106.940471 57151.8047  39.0%  9246 1158s
   197   301 54566.4587   11  322 41106.9405 57151.8047  39.0%  8654 1197s
   300   400 54550.6274    9  373 41106.9405 57151.8047  39.0%  7325 1232s
H  317   400                    41718.605982 57151.8047  37.0%  7123 1232s
   399   484 54698.6869   11  397 41718.6060 57151.8047  37.0%  6409 1259s
   483   556 54560.1716   11  335 41718.6060 57151.8047  37.0%  5959 1283s
   555   630 54202.1316   12  313 41718.6060 57151.8047  37.0%  5690 1302s
   629   661 54142.0354   12  304 41718.6060 57151.8047  37.0%  5616 1319s
   660   700 54507.7696   12  381 41718.6060 57151.8047  37.0%  5659 1337s
   699   747 53982.4444   12  300 41718.6060 57151.8047  37.0%  5690 1353s
   746   801 54355.3613   12  323 41718.6060 57151.8047  37.0%  5663 1376s
   801   857 54280.2352   12  383 41718.6060 57151.8047  37.0%  5584 1393s
   861   907 51482.5264   26  308 41718.6060 57151.8047  37.0%  5488 1413s
   923   966 53711.9979   13  288 41718.6060 57151.8047  37.0%  5466 1434s
  1003  1030 53849.9692   13  313 41718.6060 57151.8047  37.0%  5342 1454s
  1081  1086 53997.9494   13  321 41718.6060 57151.8047  37.0%  5309 1476s
  1155  1163 49735.9254   30  312 41718.6060 57151.8047  37.0%  5357 1502s
  1234  1221 53533.8230   13  287 41718.6060 57151.8047  37.0%  5305 1528s
  1318  1272 49545.6532   32  300 41718.6060 57151.8047  37.0%  5278 1557s
  1395  1323 53664.8634   14  299 41718.6060 57151.8047  37.0%  5249 1583s
  1478  1375 53437.0724   14  318 41718.6060 57151.8047  37.0%  5320 1609s
  1564  1445 47478.1167   35  239 41718.6060 57151.8047  37.0%  5373 1638s
  1666  1506 52344.7702   15  260 41718.6060 57151.8047  37.0%  5364 1667s
  1770  1561 52004.3283   16  252 41718.6060 57151.8047  37.0%  5382 1699s
  1866  1635 51623.7964   17  306 41718.6060 57151.8047  37.0%  5428 1732s
  1968  1690 45567.4253   44  191 41718.6060 56664.0735  35.8%  5460 1761s
  2027  1772 50640.2602   18  288 41718.6060 56664.0735  35.8%  5501 1792s
  2137  1875 50430.1813   17  230 41718.6060 56205.7970  34.7%  5518 1824s
  2273  1993 50171.2006   20  292 41718.6060 56205.7970  34.7%  5495 1859s
  2435  2076 49837.8292   21  278 41718.6060 56053.1031  34.4%  5398 1895s
  2575  2103 49830.8098   19  283 41718.6060 55907.4359  34.0%  5413 1926s
H 2587  2102                    41786.707564 55907.4359  33.8%  5429 1926s
  2612  2225 49669.0960   22  271 41786.7076 55907.4359  33.8%  5494 1964s
H 2768  2329                    41870.060718 55907.4359  33.5%  5511 2001s
  2926  2430 48114.5313   22  251 41870.0607 55747.3830  33.1%  5482 2044s
  3083  2478 49405.9908   23  278 41870.0607 55747.3830  33.1%  5487 2085s
H 3108  2456                    42120.097292 55747.3830  32.4%  5541 2085s
  3145  2564 46699.8485   23  143 42120.0973 55747.3830  32.4%  5570 2128s
  3309  2700 49371.8681   24  276 42120.0973 55747.3830  32.4%  5609 2171s
  3483  2833 49267.5601   26  271 42120.0973 55747.3830  32.4%  5656 2218s
  3686  2834 46389.1706    9  438 42120.0973 55747.3830  32.4%  5658 2349s
  3688  2835 44808.4877   37  138 42120.0973 55747.3830  32.4%  5655 2362s
  3689  2836 50308.5272   27  297 42120.0973 55747.3830  32.4%  5653 2435s
  3690  2837 43139.8640   63  349 42120.0973 55747.3830  32.4%  5652 2511s
  3691  2837 50061.4039   11  404 42120.0973 55747.3830  32.4%  5650 2568s
  3692  2838 49313.6414   27  384 42120.0973 55747.3830  32.4%  5648 2597s
  3693  2839 45280.2663   48  430 42120.0973 55747.3830  32.4%  5647 2630s
  3694  2839 51855.3478   11  387 42120.0973 55747.3830  32.4%  5645 2652s
  3695  2840 45216.4469   70  408 42120.0973 55747.3830  32.4%  5644 2663s
  3696  2841 45991.2689   48  424 42120.0973 55747.3830  32.4%  5642 2680s
  3697  2841 49377.1009   34  425 42120.0973 55747.3830  32.4%  5641 2689s
  3698  2842 44318.2255   48  446 42120.0973 55747.3830  32.4%  5639 2708s
  3699  2843 43852.1078   58  410 42120.0973 55747.3830  32.4%  5638 2714s
  3700  2843 43927.2241   41  466 42120.0973 55747.3830  32.4%  5636 2720s
  3701  2844 47084.1409   33  410 42120.0973 55747.3830  32.4%  5635 2727s
  3702  2845 49565.4864   30  450 42120.0973 55747.3830  32.4%  5633 2743s
  3703  2845 43963.3631   59  450 42120.0973 55747.3830  32.4%  5632 2752s
  3704  2846 52845.3635   17  398 42120.0973 55747.3830  32.4%  5630 2758s
  3705  2847 53830.2868   20  351 42120.0973 55747.3830  32.4%  5629 2764s
  3706  2847 45859.7899   39  407 42120.0973 55747.3830  32.4%  5627 2776s
  3707  2848 55177.6083   16  402 42120.0973 55747.3830  32.4%  5626 2782s
  3708  2849 51117.2273   28  398 42120.0973 55747.3830  32.4%  5624 2792s
  3709  2849 47395.7425   22  352 42120.0973 55747.3830  32.4%  5623 2797s
  3710  2850 52947.4024   11  446 42120.0973 55747.3830  32.4%  5621 2806s
  3711  2851 53434.7090   15  427 42120.0973 55747.3830  32.4%  5620 2811s
  3712  2851 46109.2796   26  412 42120.0973 55747.3830  32.4%  5618 2826s
  3714  2853 48854.9053   22  421 42120.0973 55747.3830  32.4%  5615 2840s
  3716  2854 43455.6753   43  390 42120.0973 55747.3830  32.4%  5612 2852s
  3717  2855 53040.0412   13  390 42120.0973 55747.3830  32.4%  5610 2855s
  3718  2855 43456.0878   45  389 42120.0973 55747.3830  32.4%  5609 2862s
  3719  2856 53093.3903   21  385 42120.0973 55747.3830  32.4%  5607 2867s
  3720  2857 42908.1896   41  386 42120.0973 55747.3830  32.4%  5606 2871s
  3721  2857 53196.6555   27  386 42120.0973 55747.3830  32.4%  5604 2895s
  3722  2858 50381.4422   12  386 42120.0973 55747.3830  32.4%  5603 2986s
  3723  2862 55747.3830   16  342 42120.0973 55747.3830  32.4%  5683 3158s
  3725  2865 55747.3830   17  351 42120.0973 55747.3830  32.4%  5686 3212s
  3729  2872 55747.3830   18  373 42120.0973 55747.3830  32.4%  5696 3273s
  3737  2885 55747.3830   19  390 42120.0973 55747.3830  32.4%  5713 3323s
  3753  2896 54702.6956   20  365 42120.0973 55747.3830  32.4%  5778 3429s
  3769  2922 54067.2871   21  356 42120.0973 55747.3830  32.4%  5862 3512s
H 3772  2777                    42167.485610 55747.3830  32.2%  5864 3512s
  3801  2882 52939.6647   22  378 42167.4856 55747.3830  32.2%  5912 3578s
  3915  2886 52818.7597   23  377 42167.4856 55747.3830  32.2%  6005 3600s

Cutting planes:
  Learned: 1
  Gomory: 5
  Implied bound: 23
  Projected implied bound: 70
  MIR: 1205
  Mixing: 6
  Flow cover: 1384
  RLT: 19
  Relax-and-lift: 211

Explored 3957 nodes (24095410 simplex iterations) in 3600.06 seconds (5864.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 42167.5 42120.1 41870.1 ... 40855

Time limit reached
Best objective 4.216748561002e+04, best bound 5.574738299944e+04, gap 32.2047%
  WARNING: Time limit reached. Using best solution found (gap: 32.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 42167.49, θ = 205499.25
  Upper Bound (UB) = 42167.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205499.25
  [DEBUG]   ✓ Scenario 0: θ = 205499.25 ≤ Q = 205499.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205499.25 ≤ Q = 205499.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205499.25 ≤ Q = 205499.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205499.25 ≤ Q = 205499.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205499.25 ≤ Q = 205499.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205499.25 ≤ Q = 205499.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 205499.25 ≤ Q = 205499.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 205499.25 ≤ Q = 205499.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 205499.25 ≤ Q = 205499.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 205499.25 ≤ Q = 205499.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1f415d27
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe0bea2d9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.373824e+13
Presolve removed 2597 rows and 1888 columns
Presolve time: 0.01s
Presolved: 496 rows, 501 columns, 1399 nonzeros
Found heuristic solution: objective 6134249.2968
Variable types: 341 continuous, 160 integer (160 binary)

Root relaxation: objective -1.949013e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194901.29    0  125 6134249.30 -194901.29   103%     -    0s
H    0     0                    -160864.7229 -194901.29  21.2%     -    0s
H    0     0                    -161792.9688 -194901.29  20.5%     -    0s
     0     0 -173520.18    0   96 -161792.97 -173520.18  7.25%     -    0s
H    0     0                    -167604.9001 -173403.02  3.46%     -    0s
H    0     0                    -167896.6106 -173403.02  3.28%     -    0s
H    0     0                    -168783.5050 -173403.02  2.74%     -    0s
H    0     0                    -169075.2155 -173403.02  2.56%     -    0s
     0     0 -171009.52    0   83 -169075.22 -171009.52  1.14%     -    0s
H    0     0                    -169277.5139 -170971.77  1.00%     -    0s
     0     0 -170528.21    0   58 -169277.51 -170528.21  0.74%     -    0s
     0     0 -170467.61    0   59 -169277.51 -170467.61  0.70%     -    0s
     0     0 -170467.32    0   60 -169277.51 -170467.32  0.70%     -    0s
     0     0 -170176.85    0   60 -169277.51 -170176.85  0.53%     -    0s
     0     0 -170163.92    0   60 -169277.51 -170163.92  0.52%     -    0s
     0     0 -169963.71    0   44 -169277.51 -169963.71  0.41%     -    0s
     0     0 -169881.73    0   50 -169277.51 -169881.73  0.36%     -    0s
     0     0 -169876.83    0   51 -169277.51 -169876.83  0.35%     -    0s
     0     0 -169793.26    0   64 -169277.51 -169793.26  0.30%     -    0s
     0     0 -169793.06    0   64 -169277.51 -169793.06  0.30%     -    0s
H    0     0                    -169338.5729 -169785.08  0.26%     -    0s
     0     2 -169785.08    0   64 -169338.57 -169785.08  0.26%     -    0s
H   32    32                    -169376.0145 -169586.32  0.12%  12.4    0s
H   41    32                    -169377.1979 -169555.57  0.11%  12.4    0s
H  455   178                    -169381.6787 -169508.27  0.07%   5.4    0s
*  554   178              17    -169390.1320 -169503.20  0.07%   5.3    0s
*  595   160              16    -169402.0567 -169487.37  0.05%   5.3    0s
*  651   160              18    -169414.1880 -169487.37  0.04%   5.1    0s
H  748    92                    -169425.6885 -169487.37  0.04%   5.0    0s
*  901     0              19    -169426.3322 -169475.34  0.03%   4.7    0s

Cutting planes:
  Gomory: 45
  Implied bound: 5
  MIR: 139
  Flow cover: 16
  RLT: 36
  BQP: 5

Explored 910 nodes (4963 simplex iterations) in 0.46 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -169426 -169426 -169414 ... -169278
No other solutions better than -169426

Optimal solution found (tolerance 1.00e-06)
Best objective -1.694263321571e+05, best bound -1.694263321571e+05, gap 0.0000%
  Subproblem solved in 0.49s
  Worst-case operational profit (Z_SP) = 199620.64
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -169426.33
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -169426.33 = 199620.64
  [DEBUG]   Current θ from Master = 205499.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5878.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 36288.88
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 3207.0838, Absolute Gap = 3207.0838, Relative Gap = 0.076056
  Not converged yet (gap = 3207.08 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x63282c96
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 3.01s
Presolved: 91803 rows, 39330 columns, 558577 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -332029.4056
Found heuristic solution: objective -179585.9549

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 645
 AA' NZ     : 3.025e+06
 Factor NZ  : 7.029e+06 (roughly 100 MB of memory)
 Factor Ops : 1.284e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.24883269e+07  1.94469228e+08  1.84e+05 2.46e+01  1.12e+05     5s
   1  -1.74162808e+07  1.86668389e+08  1.31e+05 1.22e+02  7.97e+04     5s
   2  -8.48799297e+06  1.57420211e+08  6.26e+04 4.34e+01  3.95e+04     5s
   3  -1.68992389e+06  1.15133621e+08  8.68e+03 2.48e+00  6.02e+03     5s
   4  -7.26129762e+05  5.64115276e+07  1.30e+03 3.59e-01  1.06e+03     5s
   5  -5.97889415e+05  3.15443708e+07  5.68e+02 1.37e-01  4.77e+02     5s
   6  -4.14909692e+05  2.07843203e+07  1.38e+02 7.62e-02  1.90e+02     5s
   7  -2.83957286e+05  1.43902879e+07  7.31e+01 4.84e-02  1.16e+02     5s
   8  -1.48777219e+05  9.47982362e+06  2.30e+01 3.00e-02  6.43e+01     5s
   9  -1.04601064e+05  4.06736450e+06  1.01e+01 1.14e-02  2.64e+01     6s
  10  -5.25044365e+04  1.00438964e+06  3.54e+00 2.61e-03  6.46e+00     6s
  11  -1.74181676e+04  4.80667396e+05  1.99e+00 1.34e-03  3.01e+00     6s
  12  -5.81306972e+03  3.08406937e+05  1.57e+00 1.07e-03  1.90e+00     6s
  13   7.58753690e+03  2.19294241e+05  1.11e+00 2.12e-03  1.27e+00     6s
  14   2.26478175e+04  1.61812351e+05  8.05e-01 2.09e-03  8.36e-01     6s
  15   2.80374164e+04  1.39638401e+05  7.14e-01 1.62e-03  6.70e-01     6s
  16   3.42251392e+04  1.24229585e+05  6.06e-01 1.22e-03  5.40e-01     6s
  17   4.42830339e+04  1.12987895e+05  4.26e-01 1.77e-03  4.12e-01     6s
  18   5.18955744e+04  1.02456621e+05  3.06e-01 1.75e-03  3.03e-01     6s
  19   5.71332702e+04  9.39345776e+04  2.30e-01 1.37e-03  2.20e-01     6s
  20   6.06297563e+04  8.58669200e+04  1.81e-01 1.73e-03  1.51e-01     6s
  21   6.45044776e+04  8.36298910e+04  1.32e-01 1.60e-03  1.14e-01     6s
  22   6.56046839e+04  8.06347717e+04  1.17e-01 1.44e-03  9.00e-02     6s
  23   6.69173707e+04  7.96187289e+04  1.01e-01 1.19e-03  7.61e-02     7s
  24   6.94761500e+04  7.86575083e+04  7.04e-02 1.02e-03  5.50e-02     7s
  25   7.13219404e+04  7.77788120e+04  4.86e-02 7.71e-04  3.87e-02     7s
  26   7.22941661e+04  7.68548930e+04  3.74e-02 1.27e-03  2.73e-02     7s
  27   7.27403856e+04  7.64613435e+04  3.20e-02 1.77e-03  2.23e-02     7s
  28   7.33146602e+04  7.62410094e+04  2.55e-02 1.09e-03  1.75e-02     7s
  29   7.36387025e+04  7.60416716e+04  2.18e-02 5.83e-04  1.44e-02     7s
  30   7.40144254e+04  7.60143769e+04  1.78e-02 4.80e-04  1.20e-02     7s
  31   7.41658224e+04  7.58943031e+04  1.61e-02 4.71e-04  1.04e-02     7s
  32   7.44377054e+04  7.58785720e+04  1.32e-02 4.37e-04  8.64e-03     7s
  33   7.48169852e+04  7.58256756e+04  9.02e-03 3.20e-04  6.05e-03     7s
  34   7.49476167e+04  7.57728404e+04  7.60e-03 3.76e-04  4.95e-03     7s
  35   7.49897811e+04  7.57533711e+04  7.17e-03 3.04e-04  4.58e-03     7s
  36   7.50381697e+04  7.57335680e+04  6.64e-03 2.32e-04  4.17e-03     8s
  37   7.51101336e+04  7.57203583e+04  5.84e-03 1.99e-04  3.66e-03     8s
  38   7.51899575e+04  7.57127678e+04  5.00e-03 1.92e-04  3.14e-03     8s
  39   7.52949577e+04  7.57012904e+04  3.86e-03 1.46e-04  2.44e-03     8s
  40   7.53710789e+04  7.56991552e+04  3.04e-03 1.35e-04  1.97e-03     8s
  41   7.54145987e+04  7.56949468e+04  2.60e-03 1.07e-04  1.68e-03     8s
  42   7.54327122e+04  7.56946233e+04  2.42e-03 1.03e-04  1.57e-03     8s
  43   7.54709674e+04  7.56906664e+04  2.02e-03 8.64e-05  1.32e-03     8s
  44   7.55114235e+04  7.56851781e+04  1.59e-03 7.49e-05  1.04e-03     8s
  45   7.55548955e+04  7.56825559e+04  1.13e-03 6.10e-05  7.65e-04     8s
  46   7.55777336e+04  7.56813427e+04  8.96e-04 5.57e-05  6.21e-04     9s
  47   7.55893291e+04  7.56786963e+04  7.83e-04 4.27e-05  5.36e-04     9s
  48   7.56132786e+04  7.56759693e+04  5.47e-04 2.99e-05  3.76e-04     9s
  49   7.56291142e+04  7.56754120e+04  3.83e-04 2.78e-05  2.77e-04     9s
  50   7.56487523e+04  7.56723967e+04  1.91e-04 1.34e-05  1.42e-04     9s
  51   7.56506598e+04  7.56697780e+04  1.73e-04 2.21e-06  1.15e-04     9s
  52   7.56518287e+04  7.56694798e+04  1.61e-04 1.44e-06  1.06e-04     9s
  53   7.56523592e+04  7.56694516e+04  1.56e-04 1.35e-06  1.03e-04     9s
  54   7.56544303e+04  7.56694122e+04  1.36e-04 1.17e-06  8.98e-05     9s
  55   7.56584107e+04  7.56693040e+04  9.85e-05 9.88e-07  6.53e-05     9s
  56   7.56591693e+04  7.56692093e+04  9.14e-05 7.77e-07  6.02e-05    10s
  57   7.56662853e+04  7.56692000e+04  2.41e-05 5.39e-07  1.75e-05    10s
  58   7.56677976e+04  7.56690709e+04  1.02e-05 1.21e-07  7.63e-06    10s
  59   7.56679948e+04  7.56690675e+04  8.56e-06 6.87e-08  6.43e-06    10s
  60   7.56682634e+04  7.56690508e+04  6.33e-06 7.07e-08  4.72e-06    10s
  61   7.56686116e+04  7.56690501e+04  3.40e-06 1.16e-07  2.63e-06    10s
  62   7.56689976e+04  7.56690317e+04  1.49e-07 2.82e-08  2.04e-07    10s
  63   7.56689998e+04  7.56690317e+04  1.11e-06 3.15e-08  1.91e-07    10s
  64   7.56690250e+04  7.56690295e+04  2.18e-07 2.13e-07  2.78e-08    10s
  65   7.56690256e+04  7.56690295e+04  4.42e-06 1.84e-07  2.33e-08    10s
  66   7.56690268e+04  7.56690294e+04  3.00e-06 1.01e-07  1.54e-08    10s
  67   7.56690290e+04  7.56690294e+04  3.95e-07 1.52e-09  1.98e-09    10s

Barrier solved model in 67 iterations and 10.49 seconds (9.30 work units)
Optimal objective 7.56690290e+04


Root crossover log...

   80792 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   10658 PPushes remaining with PInf 7.0609379e-05                14s
    4859 PPushes remaining with PInf 4.6003197e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2433228e+03     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48393    7.5669029e+04   0.000000e+00   1.243323e+03     16s
   48550    7.5669029e+04   0.000000e+00   0.000000e+00     16s
   48550    7.5669029e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 7.566903e+04, 48550 iterations, 12.11 seconds (15.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 75669.0294    0  184 -179585.95 75669.0294   142%     -   16s
H    0     0                    -175130.4564 75669.0294   143%     -   16s
H    0     0                    -171440.4657 75669.0294   144%     -   17s
H    0     0                    -162383.9835 75669.0294   147%     -   17s
H    0     0                    -157333.7068 75669.0294   148%     -   18s
H    0     0                    -154385.7936 75669.0294   149%     -   18s
H    0     0                    -153442.5454 75669.0294   149%     -   18s
H    0     0                    -64057.37811 75669.0294   218%     -   18s
H    0     0                    14605.077273 75669.0294   418%     -   19s
H    0     0                    27184.128069 75669.0294   178%     -   19s
H    0     0                    27584.295224 75669.0294   174%     -   19s
H    0     0                    27662.940939 75669.0294   174%     -   19s
H    0     0                    28604.800543 75669.0294   165%     -   20s
H    0     0                    28825.925052 75669.0294   163%     -   20s
H    0     0                    28919.255188 75669.0294   162%     -   20s
     0     0 69639.2281    0  199 28919.2552 69639.2281   141%     -   56s
     0     0 69341.2358    0  114 28919.2552 69341.2358   140%     -   67s
     0     0 69284.8152    0  111 28919.2552 69284.8152   140%     -   71s
     0     0 69196.7714    0  113 28919.2552 69196.7714   139%     -   77s
     0     0 69165.3871    0  109 28919.2552 69165.3871   139%     -   82s
     0     0 69160.7358    0  183 28919.2552 69160.7358   139%     -   84s
     0     0 69012.4336    0  186 28919.2552 69012.4336   139%     -   90s
     0     0 69006.7750    0  182 28919.2552 69006.7750   139%     -   91s
     0     0 68757.6101    0  192 28919.2552 68757.6101   138%     -   99s
     0     0 68731.4448    0  201 28919.2552 68731.4448   138%     -  102s
     0     0 68731.3422    0  201 28919.2552 68731.3422   138%     -  103s
     0     0 65812.5144    0  269 28919.2552 65812.5144   128%     -  143s
H    0     0                    30383.249091 65812.4358   117%     -  143s
H    0     0                    32089.464754 65812.4358   105%     -  144s
H    0     0                    32200.966761 65812.4358   104%     -  144s
H    0     0                    32640.109378 65812.4358   102%     -  144s
H    0     0                    33281.126929 65812.4358  97.7%     -  144s
H    0     0                    33308.297744 65812.4358  97.6%     -  144s
H    0     0                    33664.517700 65812.4358  95.5%     -  144s
H    0     0                    33824.075279 65812.4358  94.6%     -  144s
     0     0 64973.7116    0  281 33824.0753 64973.7116  92.1%     -  182s
     0     0 64620.8193    0  294 33824.0753 64620.8193  91.0%     -  205s
     0     0 64580.5050    0  297 33824.0753 64580.5050  90.9%     -  213s
     0     0 64537.3536    0  310 33824.0753 64537.3536  90.8%     -  219s
     0     0 64522.7274    0  294 33824.0753 64522.7274  90.8%     -  225s
     0     0 64522.3223    0  294 33824.0753 64522.3223  90.8%     -  226s
H    0     0                    33889.392743 61503.1652  81.5%     -  320s
     0     0 61503.1652    0  381 33889.3927 61503.1652  81.5%     -  320s
H    0     0                    34095.901096 61503.0872  80.4%     -  321s
     0     0 60903.4949    0  381 34095.9011 60903.4949  78.6%     -  346s
     0     0 60698.5490    0  371 34095.9011 60698.5490  78.0%     -  363s
     0     0 60597.4317    0  342 34095.9011 60597.4317  77.7%     -  379s
     0     0 60555.5189    0  337 34095.9011 60555.5189  77.6%     -  386s
     0     0 60540.4603    0  339 34095.9011 60540.4603  77.6%     -  389s
     0     0 60498.7019    0  338 34095.9011 60498.7019  77.4%     -  396s
     0     0 60464.2845    0  337 34095.9011 60464.2845  77.3%     -  402s
     0     0 60450.6540    0  352 34095.9011 60450.6540  77.3%     -  406s
     0     0 60443.3164    0  355 34095.9011 60443.3164  77.3%     -  409s
     0     0 60441.6043    0  351 34095.9011 60441.6043  77.3%     -  410s
     0     0 59618.3383    0  362 34095.9011 59618.3383  74.9%     -  460s
     0     0 59223.9469    0  358 34095.9011 59223.9469  73.7%     -  491s
     0     0 59068.0879    0  360 34095.9011 59068.0879  73.2%     -  512s
     0     0 58979.6752    0  385 34095.9011 58979.6752  73.0%     -  528s
     0     0 58927.4192    0  395 34095.9011 58927.4192  72.8%     -  537s
     0     0 58904.3657    0  380 34095.9011 58904.3657  72.8%     -  545s
     0     0 58853.3235    0  377 34095.9011 58853.3235  72.6%     -  555s
H    0     0                    34117.807295 58829.1236  72.4%     -  565s
H    0     0                    34245.150295 58829.1236  71.8%     -  565s
H    0     0                    34436.172681 58829.1236  70.8%     -  565s
     0     0 58829.1236    0  378 34436.1727 58829.1236  70.8%     -  565s
H    0     0                    35576.383491 58811.6491  65.3%     -  572s
H    0     0                    35646.496401 58811.6491  65.0%     -  572s
     0     0 58811.6491    0  379 35646.4964 58811.6491  65.0%     -  572s
     0     0 58787.4624    0  385 35646.4964 58787.4624  64.9%     -  579s
     0     0 58732.3030    0  375 35646.4964 58732.3030  64.8%     -  590s
H    0     0                    35715.453599 58661.0120  64.2%     -  603s
H    0     0                    36366.692364 58661.0120  61.3%     -  603s
H    0     0                    36562.869729 58661.0120  60.4%     -  603s
H    0     0                    36696.198769 58661.0120  59.9%     -  603s
H    0     0                    36817.404244 58661.0120  59.3%     -  603s
H    0     0                    36829.184251 58661.0120  59.3%     -  603s
     0     0 58661.0120    0  366 36829.1843 58661.0120  59.3%     -  603s
     0     0 58645.8134    0  368 36829.1843 58645.8134  59.2%     -  610s
     0     0 58617.9900    0  376 36829.1843 58617.9900  59.2%     -  617s
     0     0 58607.4403    0  379 36829.1843 58607.4403  59.1%     -  621s
     0     0 58605.5170    0  373 36829.1843 58605.5170  59.1%     -  623s
     0     0 58372.6956    0  434 36829.1843 58372.6956  58.5%     -  643s
     0     0 58316.9465    0  405 36829.1843 58316.9465  58.3%     -  652s
     0     0 58303.6788    0  406 36829.1843 58303.6788  58.3%     -  658s
     0     0 58283.6459    0  393 36829.1843 58283.6459  58.3%     -  664s
     0     0 58266.8619    0  447 36829.1843 58266.8619  58.2%     -  669s
     0     0 58260.0789    0  404 36829.1843 58260.0789  58.2%     -  673s
     0     0 58254.4149    0  387 36829.1843 58254.4149  58.2%     -  676s
     0     0 58250.1752    0  390 36829.1843 58250.1752  58.2%     -  678s
     0     0 58248.0003    0  387 36829.1843 58248.0003  58.2%     -  680s
     0     0 58039.4765    0  453 36829.1843 58039.4765  57.6%     -  701s
H    0     0                    38710.929486 58039.0451  49.9%     -  707s
     0     0 57973.7947    0  486 38710.9295 57973.7947  49.8%     -  723s
     0     0 57929.4328    0  497 38710.9295 57929.4328  49.6%     -  734s
     0     0 57907.6223    0  445 38710.9295 57907.6223  49.6%     -  741s
     0     0 57901.3805    0  453 38710.9295 57901.3805  49.6%     -  744s
     0     0 57897.5551    0  462 38710.9295 57897.5551  49.6%     -  748s
     0     0 57895.8835    0  503 38710.9295 57895.8835  49.6%     -  750s
     0     0 57743.8774    0  379 38710.9295 57743.8774  49.2%     -  767s
H    0     0                    38777.211725 57743.6572  48.9%     -  768s
H    0     0                    38942.842069 57743.6572  48.3%     -  768s
H    0     0                    39285.722877 57743.6572  47.0%     -  768s
     0     0 57713.9415    0  430 39285.7229 57713.9415  46.9%     -  775s
     0     0 57700.8729    0  385 39285.7229 57700.8729  46.9%     -  782s
     0     0 57696.5517    0  381 39285.7229 57696.5517  46.9%     -  784s
     0     0 57695.1766    0  381 39285.7229 57695.1766  46.9%     -  787s
     0     0 57652.5174    0  382 39285.7229 57652.5174  46.8%     -  795s
     0     0 57644.0155    0  332 39285.7229 57644.0155  46.7%     -  800s
     0     0 57641.9261    0  334 39285.7229 57641.9261  46.7%     -  801s
     0     0 57617.5412    0  338 39285.7229 57617.5412  46.7%     -  808s
     0     0 57614.5837    0  341 39285.7229 57614.5837  46.7%     -  810s
     0     0 57613.2134    0  341 39285.7229 57613.2134  46.7%     -  811s
     0     0 57601.4281    0  401 39285.7229 57601.4281  46.6%     -  815s
H    0     0                    39370.073392 57601.1231  46.3%     -  819s
H    0     0                    39409.327888 57601.1231  46.2%     -  831s
H    0     0                    39416.462493 57601.1231  46.1%     -  831s
H    0     0                    39417.354739 57601.1231  46.1%     -  831s
H    0     0                    39860.149787 57601.1231  44.5%     -  833s
H    0     0                    39878.609146 57601.1231  44.4%     -  833s
     0     0 57595.8297    0  344 39878.6091 57595.8297  44.4%     -  837s
     0     0 57594.9913    0  397 39878.6091 57594.9913  44.4%     -  839s
     0     0 57580.6904    0  399 39878.6091 57580.6904  44.4%     -  844s
H    0     0                    40078.464394 57580.3918  43.7%     -  845s
H    0     0                    40549.811815 57580.3918  42.0%     -  845s
     0     0 57575.7917    0  403 40549.8118 57575.7917  42.0%     -  847s
     0     0 57572.5395    0  399 40549.8118 57572.5395  42.0%     -  848s
     0     0 57570.6558    0  405 40549.8118 57570.6558  42.0%     -  850s
     0     0 57563.3541    0  407 40549.8118 57563.3541  42.0%     -  854s
     0     0 57563.2941    0  407 40549.8118 57563.2941  42.0%     -  857s
H    0     0                    40677.994881 57563.2583  41.5%     - 1006s
H    0     0                    40719.953330 57563.2583  41.4%     - 1006s
H    0     0                    40837.843884 57563.2583  41.0%     - 1006s
H    0     0                    40984.516177 57563.2583  40.5%     - 1008s
H    0     0                    41015.858010 57563.2583  40.3%     - 1008s
H    0     0                    41105.043098 57563.2583  40.0%     - 1028s
     0     2 57563.2583    0  407 41105.0431 57563.2583  40.0%     - 1032s
     1     3 57148.4589    1  381 41105.0431 57563.1930  40.0% 15646 1054s
     2     4 57213.1151    1  319 41105.0431 57213.1151  39.2% 10166 1066s
     3     7 56387.7635    2  311 41105.0431 57212.7748  39.2% 10864 1097s
     6    10 54787.1723    3  303 41105.0431 57212.7748  39.2% 14175 1136s
     9    18 54047.1000    4  271 41105.0431 56480.3062  37.4% 13373 1172s
    17    36 55352.1820    4  397 41105.0431 56479.7782  37.4% 12561 1205s
    35    50 54221.5840    5  447 41105.0431 55719.6670  35.6% 16546 1308s
    49    78 53898.4494    6  287 41105.0431 55719.6670  35.6% 17079 1377s
    77   121 53831.3587    7  289 41105.0431 55719.6670  35.6% 14184 1435s
H  111   121                    41831.384105 55719.6670  33.2% 12034 1435s
   120   263 53472.8433    8  275 41831.3841 55719.6670  33.2% 11750 1488s
H  143   263                    41861.357748 55719.6670  33.1% 10634 1488s
H  180   263                    41874.326820 55719.6670  33.1%  9591 1488s
   262   330 52967.7728   13  266 41874.3268 55719.6670  33.1%  8196 1520s
   329   393 52663.0569   15  266 41874.3268 55719.6670  33.1%  7564 1551s
   392   463 52081.0158   17  251 41874.3268 55719.6670  33.1%  7014 1580s
   462   534 51529.7060   21  242 41874.3268 55719.6670  33.1%  6637 1606s
   533   606 51034.4212   26  221 41874.3268 55719.6670  33.1%  6403 1630s
   605   636 50758.8177   31  210 41874.3268 55719.6670  33.1%  6222 1649s
   637   671 50305.8027   32  193 41874.3268 55719.6670  33.1%  6268 1669s
   672   702 50142.0317   33  188 41874.3268 55719.6670  33.1%  6213 1687s
H  676   702                    41999.868934 55719.6670  32.7%  6218 1688s
   703   781 49258.5904   34  181 41999.8689 55719.6670  32.7%  6206 1720s
   783   813 48668.6935   37  183 41999.8689 55719.6670  32.7%  6042 1733s
   815   849 48552.1929   38  185 41999.8689 55719.6670  32.7%  6049 1749s
   851   884 48459.4727   39  175 41999.8689 55719.6670  32.7%  6071 1771s
   886   924 48304.2667   40  177 41999.8689 55719.6670  32.7%  6066 1791s
   926   979 48303.3934   41  175 41999.8689 55719.6670  32.7%  6044 1812s
   981  1039 47674.6924   46  163 41999.8689 55719.6670  32.7%  6009 1831s
  1049  1097 44741.4141   50  100 41999.8689 55719.6670  32.7%  5946 1854s
  1121  1163     cutoff   56      41999.8689 55719.6670  32.7%  5886 1875s
  1209  1191 42779.2183   60   79 41999.8689 55719.6670  32.7%  5816 1901s
  1276  1230 53015.4759    9  287 41999.8689 55719.6670  32.7%  5866 1932s
  1350  1275 52466.4650   11  223 41999.8689 55719.6670  32.7%  5924 1962s
  1427  1323 52327.0013   13  219 41999.8689 55719.6670  32.7%  5935 1989s
  1505  1360 51671.1476   15  223 41999.8689 55719.6670  32.7%  5988 2023s
  1590  1395 51133.7080   19  185 41999.8689 55719.6670  32.7%  6059 2058s
  1671  1448 50105.1440   21  144 41999.8689 55719.6670  32.7%  6200 2092s
  1754  1503 48846.2152   25  123 41999.8689 55719.6670  32.7%  6341 2129s
  1861  1578 48039.2256   29  285 41999.8689 55719.6670  32.7%  6401 2166s
  1961  1674 46056.7615   32   78 41999.8689 55719.6670  32.7%  6477 2202s
  2099  1745 45575.3240   36   78 41999.8689 55719.6670  32.7%  6450 2250s
  2214  1835 44516.7931   50   58 41999.8689 55719.6670  32.7%  6439 2288s
  2356  1879     cutoff   61      41999.8689 55352.1817  31.8%  6428 2330s
  2486  1906 53794.7536    6  289 41999.8689 55274.7670  31.6%  6491 2377s
  2601  1934 53769.6329    7  288 41999.8689 55153.0191  31.3%  6563 2426s
  2689  1986 52012.0869   10  279 41999.8689 54925.3899  30.8%  6709 2476s
  2781  2042 49954.3529   12  314 41999.8689 54925.3899  30.8%  6836 2525s
  2889  2098 48159.3665   15  216 41999.8689 54925.3899  30.8%  6956 2576s
  3011  2143 43746.6917   18  166 41999.8689 54727.5443  30.3%  7026 2616s
  3068  2226 42442.1526   20  179 41999.8689 54727.5443  30.3%  7100 2668s
  3181  2335 43949.7448   26  184 41999.8689 54727.5443  30.3%  7117 2722s
  3319  2465 42971.0435   32  151 41999.8689 54727.5443  30.3%  7170 2775s
  3505  2579 50455.3187   13  263 41999.8689 54148.6628  28.9%  7178 2835s
  3716  2728 45243.9664   17  186 41999.8689 54148.6628  28.9%  7137 2898s
H 3905  2726                    42099.181682 53978.4635  28.2%  7170 2947s
  3906  2727 48641.9123   14  407 42099.1817 53978.4635  28.2%  7168 3067s
  3908  2728 53429.9626   17  202 42099.1817 53978.4635  28.2%  7164 3083s
  3909  2729 44756.3980   40  339 42099.1817 53978.4635  28.2%  7162 3192s
  3910  2730 51827.5469   13  386 42099.1817 53978.4635  28.2%  7160 3316s
  3911  2730 46301.7387   37  420 42099.1817 53978.4635  28.2%  7159 3389s
  3912  2731 43940.4904   25  392 42099.1817 53978.4635  28.2%  7157 3435s
  3913  2732 49205.7328   25  407 42099.1817 53978.4635  28.2%  7155 3474s
  3914  2732 52714.5306   11  398 42099.1817 53978.4635  28.2%  7153 3516s
  3915  2733 45223.3626   14  379 42099.1817 53978.4635  28.2%  7151 3540s
  3916  2734 42773.4295   42  393 42099.1817 53978.4635  28.2%  7149 3559s
  3917  2734 46650.7725   19  403 42099.1817 53978.4635  28.2%  7148 3574s
  3918  2735 43415.6783   28  391 42099.1817 53978.4635  28.2%  7146 3590s
  3919  2736 51687.8836    9  404 42099.1817 53978.4635  28.2%  7144 3599s

Cutting planes:
  Gomory: 16
  Implied bound: 16
  Projected implied bound: 188
  MIR: 726
  Flow cover: 560
  RLT: 25
  Relax-and-lift: 239

Explored 3919 nodes (28821194 simplex iterations) in 3600.04 seconds (5478.47 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 42099.2 41999.9 41874.3 ... 40720

Time limit reached
Best objective 4.209918168163e+04, best bound 5.397846347349e+04, gap 28.2174%
  WARNING: Time limit reached. Using best solution found (gap: 28.22%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 42099.18, θ = 206047.86
  Upper Bound (UB) = 42099.18

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206047.86
  [DEBUG]   ✓ Scenario 0: θ = 206047.86 ≤ Q = 206047.86 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 206047.86 ≤ Q = 206047.86 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xa8dfd15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf57202eb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.382775e+13
Presolve removed 2597 rows and 1888 columns
Presolve time: 0.01s
Presolved: 496 rows, 501 columns, 1399 nonzeros
Found heuristic solution: objective 6178172.0109
Variable types: 341 continuous, 160 integer (160 binary)

Root relaxation: objective -1.943493e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194349.27    0  125 6178172.01 -194349.27   103%     -    0s
H    0     0                    -160285.1455 -194349.27  21.3%     -    0s
H    0     0                    -161213.3914 -194349.27  20.6%     -    0s
     0     0 -169668.42    0   84 -161213.39 -169668.42  5.24%     -    0s
H    0     0                    -164095.9702 -169547.55  3.32%     -    0s
H    0     0                    -164726.6182 -169547.55  2.93%     -    0s
H    0     0                    -165673.8501 -169547.55  2.34%     -    0s
H    0     0                    -166304.4980 -169547.55  1.95%     -    0s
     0     0 -167786.95    0   86 -166304.50 -167786.95  0.89%     -    0s
     0     0 -167738.36    0   86 -166304.50 -167738.36  0.86%     -    0s
     0     0 -167417.05    0   63 -166304.50 -167417.05  0.67%     -    0s
     0     0 -167382.98    0   70 -166304.50 -167382.98  0.65%     -    0s
     0     0 -167382.22    0   70 -166304.50 -167382.22  0.65%     -    0s
     0     0 -167035.32    0   59 -166304.50 -167035.32  0.44%     -    0s
     0     0 -166975.95    0   73 -166304.50 -166975.95  0.40%     -    0s
     0     0 -166975.65    0   58 -166304.50 -166975.65  0.40%     -    0s
     0     0 -166812.09    0   45 -166304.50 -166812.09  0.31%     -    0s
     0     0 -166762.91    0   42 -166304.50 -166762.91  0.28%     -    0s
     0     0 -166759.06    0   43 -166304.50 -166759.06  0.27%     -    0s
     0     0 -166730.50    0   43 -166304.50 -166730.50  0.26%     -    0s
     0     0 -166730.49    0   43 -166304.50 -166730.49  0.26%     -    0s
H    0     0                    -166340.7371 -166718.09  0.23%     -    0s
     0     2 -166718.09    0   43 -166340.74 -166718.09  0.23%     -    0s
H   30    50                    -166378.2480 -166616.21  0.14%   9.7    0s
H   85   167                    -166426.5116 -166577.61  0.09%  13.9    0s
*  257   150              12    -166446.6516 -166528.00  0.05%   7.7    0s
H  281   150                    -166466.2953 -166524.86  0.04%   7.5    0s
*  414    20              13    -166502.7308 -166524.12  0.01%   6.4    0s

Cutting planes:
  Gomory: 33
  Implied bound: 5
  MIR: 137
  Flow cover: 17
  RLT: 35
  BQP: 2

Explored 558 nodes (3613 simplex iterations) in 0.27 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -166503 -166466 -166447 ... -160285
No other solutions better than -166503

Optimal solution found (tolerance 1.00e-06)
Best objective -1.665027308241e+05, best bound -1.665027308241e+05, gap 0.0000%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 202544.25
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -166502.73
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -166502.73 = 202544.25
  [DEBUG]   Current θ from Master = 206047.86
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3503.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38595.57
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 3138.7799, Absolute Gap = 3138.7799, Relative Gap = 0.074557
  Not converged yet (gap = 3138.78 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x3f8c9b2a
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 3.46s
Presolved: 100023 rows, 42700 columns, 605807 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -333576.9485
Found heuristic solution: objective -179585.9549

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 632
 AA' NZ     : 3.497e+06
 Factor NZ  : 8.263e+06 (roughly 120 MB of memory)
 Factor Ops : 1.566e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.41884248e+07  2.09872876e+08  1.97e+05 2.39e+01  1.20e+05     5s
   1  -1.87781059e+07  2.04242732e+08  1.41e+05 1.24e+02  8.51e+04     5s
   2  -9.65391007e+06  1.72075734e+08  7.08e+04 4.18e+01  4.43e+04     5s
   3  -2.10446782e+06  1.28951028e+08  1.07e+04 3.16e+00  7.31e+03     6s
   4  -8.09820755e+05  8.24006054e+07  1.41e+03 4.23e-01  1.27e+03     6s
   5  -6.92106908e+05  4.40737438e+07  6.66e+02 1.61e-01  5.83e+02     6s
   6  -5.66350314e+05  2.90096431e+07  1.54e+02 9.32e-02  2.33e+02     6s
   7  -4.99203111e+05  1.96412397e+07  8.20e+01 5.95e-02  1.43e+02     6s
   8  -2.37039343e+05  1.35287256e+07  9.65e+00 3.85e-02  7.83e+01     6s
   9  -1.28920695e+05  5.82274876e+06  4.32e+00 1.63e-02  3.32e+01     6s
  10  -8.44918024e+04  3.31040151e+06  2.22e+00 9.20e-03  1.87e+01     6s
  11  -5.06531746e+04  1.87446729e+06  1.13e+00 5.06e-03  1.06e+01     6s
  12  -1.25772884e+04  5.58462626e+05  4.83e-01 1.52e-03  3.12e+00     6s
  13   3.37589678e+02  3.15214646e+05  3.49e-01 8.82e-04  1.72e+00     6s
  14   1.40487677e+04  2.24289980e+05  2.50e-01 1.42e-03  1.15e+00     6s
  15   2.00220712e+04  1.92593386e+05  2.20e-01 1.44e-03  9.43e-01     6s
  16   2.90957412e+04  1.51401056e+05  1.83e-01 1.50e-03  6.68e-01     7s
  17   3.51400223e+04  1.33502888e+05  1.57e-01 1.34e-03  5.38e-01     7s
  18   4.36111108e+04  1.21324556e+05  1.17e-01 1.57e-03  4.25e-01     7s
  19   4.87925744e+04  1.07613970e+05  9.64e-02 1.49e-03  3.21e-01     7s
  20   5.12862054e+04  9.74662084e+04  8.62e-02 3.96e-03  2.52e-01     7s
  21   5.64173472e+04  9.17756502e+04  6.65e-02 3.23e-03  1.93e-01     7s
  22   5.99941276e+04  8.69077138e+04  5.34e-02 2.90e-03  1.47e-01     7s
  23   6.45334679e+04  8.40852905e+04  3.72e-02 2.23e-03  1.07e-01     7s
  24   6.59090970e+04  8.17028528e+04  3.24e-02 2.09e-03  8.63e-02     7s
  25   6.76239990e+04  8.00868409e+04  2.64e-02 1.50e-03  6.81e-02     7s
  26   6.96296719e+04  7.89077447e+04  1.95e-02 1.11e-03  5.07e-02     7s
  27   7.10646446e+04  7.82370306e+04  1.47e-02 8.66e-04  3.92e-02     8s
  28   7.18359313e+04  7.70314200e+04  1.22e-02 4.65e-04  2.84e-02     8s
  29   7.25581977e+04  7.65621704e+04  9.77e-03 3.02e-04  2.19e-02     8s
  30   7.29781013e+04  7.63138295e+04  8.50e-03 2.18e-04  1.82e-02     8s
  31   7.34298933e+04  7.61809434e+04  7.00e-03 1.73e-04  1.50e-02     8s
  32   7.40133541e+04  7.61464153e+04  5.24e-03 1.59e-04  1.17e-02     8s
  33   7.42197503e+04  7.59978962e+04  4.54e-03 1.10e-04  9.72e-03     8s
  34   7.43179061e+04  7.59930174e+04  4.23e-03 1.08e-04  9.16e-03     8s
  35   7.46142011e+04  7.59084508e+04  3.29e-03 7.69e-05  7.08e-03     8s
  36   7.48656167e+04  7.58308398e+04  2.49e-03 5.20e-05  5.28e-03     8s
  37   7.49885934e+04  7.57773771e+04  2.09e-03 3.45e-05  4.31e-03     9s
  38   7.51373670e+04  7.57492450e+04  1.62e-03 2.66e-05  3.35e-03     9s
  39   7.51779125e+04  7.57329712e+04  1.50e-03 2.09e-05  3.04e-03     9s
  40   7.52550221e+04  7.57172710e+04  1.26e-03 1.54e-05  2.53e-03     9s
  41   7.52870391e+04  7.57039365e+04  1.16e-03 1.79e-05  2.28e-03     9s
  42   7.53670642e+04  7.57011723e+04  9.13e-04 2.06e-05  1.83e-03     9s
  43   7.54220807e+04  7.56919197e+04  7.41e-04 1.43e-05  1.48e-03     9s
  44   7.54518214e+04  7.56892502e+04  6.54e-04 1.24e-05  1.30e-03     9s
  45   7.54948120e+04  7.56841017e+04  5.23e-04 9.12e-06  1.04e-03    10s
  46   7.55374684e+04  7.56778145e+04  3.91e-04 2.14e-05  7.68e-04    10s
  47   7.55830022e+04  7.56746548e+04  2.46e-04 1.23e-05  5.01e-04    10s
  48   7.55894814e+04  7.56742277e+04  2.27e-04 1.14e-05  4.63e-04    10s
  49   7.56069073e+04  7.56736859e+04  1.76e-04 9.84e-06  3.65e-04    10s
  50   7.56224768e+04  7.56726827e+04  1.30e-04 7.72e-06  2.75e-04    10s
  51   7.56325641e+04  7.56717794e+04  1.01e-04 5.71e-06  2.14e-04    10s
  52   7.56452636e+04  7.56704534e+04  6.55e-05 2.30e-06  1.38e-04    10s
  53   7.56460790e+04  7.56699977e+04  6.30e-05 1.54e-06  1.31e-04    10s
  54   7.56467221e+04  7.56696886e+04  6.11e-05 1.06e-06  1.26e-04    11s
  55   7.56592137e+04  7.56694875e+04  2.62e-05 7.46e-07  5.62e-05    11s
  56   7.56596759e+04  7.56694350e+04  2.49e-05 6.59e-07  5.34e-05    11s
  57   7.56649676e+04  7.56693120e+04  1.08e-05 3.92e-07  2.38e-05    11s
  58   7.56676727e+04  7.56690962e+04  3.21e-06 8.60e-08  7.78e-06    11s
  59   7.56684302e+04  7.56690772e+04  1.42e-06 2.12e-07  3.54e-06    11s
  60   7.56689786e+04  7.56690386e+04  1.18e-07 4.72e-08  3.28e-07    11s
  61   7.56690288e+04  7.56690306e+04  1.21e-08 6.29e-09  9.83e-09    11s
  62   7.56690290e+04  7.56690294e+04  2.26e-08 1.29e-09  2.26e-09    11s

Barrier solved model in 62 iterations and 11.42 seconds (10.17 work units)
Optimal objective 7.56690290e+04


Root crossover log...

   87875 DPushes remaining with DInf 0.0000000e+00                11s
     271 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

   13550 PPushes remaining with PInf 6.0128816e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.3961095e+03     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53956    7.5669029e+04   0.000000e+00   5.396110e+03     17s
   54266    7.5669029e+04   0.000000e+00   0.000000e+00     17s
   54266    7.5669029e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 1.19s

Solved with barrier

Root relaxation: objective 7.566903e+04, 54266 iterations, 14.25 seconds (17.05 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 75669.0294    0  184 -179585.95 75669.0294   142%     -   19s
H    0     0                    -176647.0850 75669.0294   143%     -   19s
H    0     0                    -175684.9960 75669.0294   143%     -   19s
H    0     0                    -140488.2113 75669.0294   154%     -   19s
H    0     0                    -138725.9204 75669.0294   155%     -   20s
H    0     0                    -137567.8806 75669.0294   155%     -   20s
H    0     0                    -137409.9755 75669.0294   155%     -   20s
H    0     0                    -135399.9179 75669.0294   156%     -   20s
H    0     0                    -134934.2801 75669.0294   156%     -   20s
H    0     0                    -64571.43183 75669.0294   217%     -   20s
H    0     0                    21803.769586 75669.0294   247%     -   21s
H    0     0                    22654.265331 75669.0294   234%     -   21s
H    0     0                    27238.103212 75669.0294   178%     -   21s
H    0     0                    27282.106313 75669.0294   177%     -   22s
H    0     0                    27436.160538 75669.0294   176%     -   22s
H    0     0                    27757.129951 75669.0294   173%     -   22s
H    0     0                    27824.653180 75669.0294   172%     -   22s
H    0     0                    27841.965124 75669.0294   172%     -   22s
H    0     0                    28012.089421 75669.0294   170%     -   22s
H    0     0                    28092.603280 75669.0294   169%     -   22s
H    0     0                    28164.304533 75669.0294   169%     -   22s
H    0     0                    28219.317809 75669.0294   168%     -   22s
H    0     0                    28295.951790 75669.0294   167%     -   22s
     0     0 68610.5676    0  215 28295.9518 68610.5676   142%     -   74s
H    0     0                    28397.975210 68610.5676   142%     -   75s
     0     0 68045.5428    0  207 28397.9752 68045.5428   140%     -  102s
     0     0 67991.8832    0  213 28397.9752 67991.8832   139%     -  108s
     0     0 67935.4561    0  216 28397.9752 67935.4561   139%     -  116s
     0     0 67935.4561    0  125 28397.9752 67935.4561   139%     -  119s
     0     0 67935.4561    0  205 28397.9752 67935.4561   139%     -  122s
     0     0 67842.1985    0  203 28397.9752 67842.1985   139%     -  124s
     0     0 67839.1440    0  210 28397.9752 67839.1440   139%     -  130s
     0     0 67839.1440    0  217 28397.9752 67839.1440   139%     -  131s
     0     0 64661.7902    0  278 28397.9752 64661.7902   128%     -  207s
H    0     0                    29593.055800 64661.7159   119%     -  209s
H    0     0                    29645.261623 64661.7159   118%     -  209s
H    0     0                    29940.807900 64661.7159   116%     -  209s
H    0     0                    30025.902595 64661.7159   115%     -  209s
H    0     0                    30030.364036 64661.7159   115%     -  209s
H    0     0                    30044.737292 63719.8999   112%     -  263s
H    0     0                    32117.588887 63719.8999  98.4%     -  263s
H    0     0                    32166.444005 63719.8999  98.1%     -  263s
H    0     0                    32522.000178 63719.8999  95.9%     -  263s
H    0     0                    32686.564560 63719.8999  94.9%     -  263s
H    0     0                    32847.955259 63719.8999  94.0%     -  263s
H    0     0                    32888.853207 63719.8999  93.7%     -  263s
     0     0 63719.8999    0  296 32888.8532 63719.8999  93.7%     -  263s
     0     0 63406.3924    0  333 32888.8532 63406.3924  92.8%     -  297s
     0     0 63220.9367    0  339 32888.8532 63220.9367  92.2%     -  318s
     0     0 63191.0330    0  335 32888.8532 63191.0330  92.1%     -  325s
     0     0 63169.4635    0  331 32888.8532 63169.4635  92.1%     -  332s
     0     0 63110.4770    0  335 32888.8532 63110.4770  91.9%     -  338s
     0     0 63100.7411    0  341 32888.8532 63100.7411  91.9%     -  340s
     0     0 63099.0916    0  334 32888.8532 63099.0916  91.9%     -  343s
     0     0 63087.8288    0  335 32888.8532 63087.8288  91.8%     -  346s
     0     0 63084.2627    0  334 32888.8532 63084.2627  91.8%     -  347s
     0     0 63084.1665    0  334 32888.8532 63084.1665  91.8%     -  347s
H    0     0                    33378.518882 60991.6696  82.7%     -  419s
H    0     0                    34020.881546 60991.6696  79.3%     -  419s
H    0     0                    34026.323788 60991.6696  79.2%     -  419s
H    0     0                    34133.190392 60991.6696  78.7%     -  419s
H    0     0                    34214.600215 60991.6696  78.3%     -  419s
H    0     0                    34234.538921 60991.6696  78.2%     -  419s
H    0     0                    34236.160208 60991.6696  78.1%     -  419s
H    0     0                    34345.469519 60991.6696  77.6%     -  419s
H    0     0                    34355.385463 60991.6696  77.5%     -  419s
     0     0 60991.6696    0  384 34355.3855 60991.6696  77.5%     -  420s
     0     0 60656.0788    0  428 34355.3855 60656.0788  76.6%     -  450s
     0     0 60479.6038    0  426 34355.3855 60479.6038  76.0%     -  476s
     0     0 60358.2662    0  409 34355.3855 60358.2662  75.7%     -  499s
     0     0 60303.9822    0  405 34355.3855 60303.9822  75.5%     -  509s
     0     0 60238.4824    0  412 34355.3855 60238.4824  75.3%     -  523s
H    0     0                    34509.667993 60205.3544  74.5%     -  531s
     0     0 60205.3544    0  400 34509.6680 60205.3544  74.5%     -  531s
     0     0 60186.1898    0  414 34509.6680 60186.1898  74.4%     -  536s
     0     0 60183.1890    0  403 34509.6680 60183.1890  74.4%     -  540s
     0     0 60163.6521    0  401 34509.6680 60163.6521  74.3%     -  546s
     0     0 60158.8386    0  418 34509.6680 60158.8386  74.3%     -  550s
     0     0 60153.1194    0  420 34509.6680 60153.1194  74.3%     -  552s
     0     0 60138.1631    0  408 34509.6680 60138.1631  74.3%     -  555s
     0     0 60100.0729    0  401 34509.6680 60100.0729  74.2%     -  563s
     0     0 60088.8546    0  412 34509.6680 60088.8546  74.1%     -  567s
     0     0 60077.5720    0  405 34509.6680 60077.5720  74.1%     -  571s
     0     0 60070.3686    0  413 34509.6680 60070.3686  74.1%     -  575s
     0     0 60069.1381    0  416 34509.6680 60069.1381  74.1%     -  578s
     0     0 59043.4228    0  383 34509.6680 59043.4228  71.1%     -  636s
     0     0 58798.1312    0  381 34509.6680 58798.1312  70.4%     -  656s
     0     0 58702.8750    0  389 34509.6680 58702.8750  70.1%     -  668s
     0     0 58656.1999    0  386 34509.6680 58656.1999  70.0%     -  677s
     0     0 58580.5500    0  396 34509.6680 58580.5500  69.8%     -  688s
     0     0 58566.1518    0  464 34509.6680 58566.1518  69.7%     -  693s
     0     0 58549.9756    0  400 34509.6680 58549.9756  69.7%     -  698s
     0     0 58533.3673    0  405 34509.6680 58533.3673  69.6%     -  702s
     0     0 58529.8732    0  398 34509.6680 58529.8732  69.6%     -  707s
     0     0 58522.2868    0  398 34509.6680 58522.2868  69.6%     -  710s
H    0     0                    34531.200089 58515.6459  69.5%     -  712s
H    0     0                    34742.495191 58515.6459  68.4%     -  712s
H    0     0                    34814.174400 58515.6459  68.1%     -  712s
H    0     0                    34828.367650 58515.6459  68.0%     -  712s
     0     0 58515.6459    0  399 34828.3676 58515.6459  68.0%     -  712s
     0     0 58506.1093    0  410 34828.3676 58506.1093  68.0%     -  716s
     0     0 58499.0135    0  406 34828.3676 58499.0135  68.0%     -  720s
     0     0 58492.6948    0  395 34828.3676 58492.6948  67.9%     -  725s
     0     0 58487.9565    0  404 34828.3676 58487.9565  67.9%     -  728s
     0     0 58482.3432    0  390 34828.3676 58482.3432  67.9%     -  732s
     0     0 58477.2025    0  393 34828.3676 58477.2025  67.9%     -  735s
     0     0 58476.2175    0  395 34828.3676 58476.2175  67.9%     -  736s
     0     0 58300.9993    0  396 34828.3676 58300.9993  67.4%     -  757s
     0     0 58217.5036    0  405 34828.3676 58217.5036  67.2%     -  771s
     0     0 58196.4296    0  452 34828.3676 58196.4296  67.1%     -  783s
     0     0 58184.0958    0  394 34828.3676 58184.0958  67.1%     -  791s
     0     0 58176.1996    0  395 34828.3676 58176.1996  67.0%     -  798s
     0     0 58171.2586    0  414 34828.3676 58171.2586  67.0%     -  802s
     0     0 58169.8162    0  407 34828.3676 58169.8162  67.0%     -  804s
H    0     0                    34997.210447 57981.0085  65.7%     -  826s
H    0     0                    35818.721759 57981.0085  61.9%     -  826s
H    0     0                    35841.037326 57981.0085  61.8%     -  826s
     0     0 57981.0085    0  542 35841.0373 57981.0085  61.8%     -  826s
H    0     0                    35947.831779 57980.4005  61.3%     -  828s
H    0     0                    38004.529432 57980.4005  52.6%     -  828s
H    0     0                    38736.165769 57980.4005  49.7%     -  828s
     0     0 57934.7819    0  539 38736.1658 57934.7819  49.6%     -  840s
     0     0 57915.3718    0  392 38736.1658 57915.3718  49.5%     -  847s
     0     0 57902.4317    0  465 38736.1658 57902.4317  49.5%     -  855s
     0     0 57899.2097    0  421 38736.1658 57899.2097  49.5%     -  858s
     0     0 57894.8194    0  413 38736.1658 57894.8194  49.5%     -  862s
     0     0 57892.3676    0  407 38736.1658 57892.3676  49.5%     -  863s
     0     0 57851.3860    0  528 38736.1658 57851.3860  49.3%     -  876s
H    0     0                    39158.466823 57851.2655  47.7%     -  877s
H    0     0                    39972.814493 57851.2655  44.7%     -  877s
H    0     0                    40200.055549 57851.2655  43.9%     -  877s
H    0     0                    40505.144274 57851.2655  42.8%     -  877s
H    0     0                    40601.260370 57851.2655  42.5%     -  877s
H    0     0                    40686.718455 57851.2655  42.2%     -  877s
     0     0 57812.2980    0  536 40686.7185 57812.2980  42.1%     -  887s
     0     0 57799.9288    0  540 40686.7185 57799.9288  42.1%     -  893s
     0     0 57784.3037    0  523 40686.7185 57784.3037  42.0%     -  900s
     0     0 57767.5406    0  545 40686.7185 57767.5406  42.0%     -  905s
     0     0 57763.6950    0  524 40686.7185 57763.6950  42.0%     -  907s
     0     0 57762.6965    0  540 40686.7185 57762.6965  42.0%     -  910s
     0     0 57724.9338    0  408 40686.7185 57724.9338  41.9%     -  925s
     0     0 57707.2018    0  484 40686.7185 57707.2018  41.8%     -  937s
     0     0 57703.8609    0  420 40686.7185 57703.8609  41.8%     -  944s
     0     0 57700.1657    0  408 40686.7185 57700.1657  41.8%     -  950s
     0     0 57688.8725    0  467 40686.7185 57688.8725  41.8%     -  957s
     0     0 57685.4399    0  416 40686.7185 57685.4399  41.8%     -  959s
     0     0 57683.8178    0  415 40686.7185 57683.8178  41.8%     -  962s
     0     0 57657.3631    0  467 40686.7185 57657.3631  41.7%     -  976s
H    0     0                    40731.128034 57656.6135  41.6%     -  977s
     0     0 57651.4658    0  476 40731.1280 57651.4658  41.5%     -  983s
     0     0 57648.8447    0  407 40731.1280 57648.8447  41.5%     -  986s
     0     0 57631.6252    0  471 40731.1280 57631.6252  41.5%     -  995s
H    0     0                    40796.379606 57631.5183  41.3%     -  997s
     0     0 57626.6488    0  471 40796.3796 57626.6488  41.3%     - 1004s
     0     0 57625.5991    0  407 40796.3796 57625.5991  41.3%     - 1006s
     0     0 57585.4182    0  458 40796.3796 57585.4182  41.2%     - 1017s
H    0     0                    40869.181155 57584.7589  40.9%     - 1019s
H    0     0                    41449.741043 57584.7589  38.9%     - 1019s
     0     0 57534.7182    0  403 41449.7410 57534.7182  38.8%     - 1031s
     0     0 57527.2805    0  454 41449.7410 57527.2805  38.8%     - 1036s
     0     0 57526.5324    0  454 41449.7410 57526.5324  38.8%     - 1038s
     0     0 57510.8329    0  347 41449.7410 57510.8329  38.7%     - 1045s
     0     0 57509.7075    0  410 41449.7410 57509.7075  38.7%     - 1052s
     0     0 57505.0366    0  404 41449.7410 57505.0366  38.7%     - 1058s
     0     0 57503.6323    0  403 41449.7410 57503.6323  38.7%     - 1061s
     0     0 57501.0260    0  403 41449.7410 57501.0260  38.7%     - 1067s
     0     0 57500.9222    0  403 41449.7410 57500.9222  38.7%     - 1070s
H    0     0                    41786.707564 57500.7304  37.6%     - 1283s
     0     2 57500.7304    0  403 41786.7076 57500.7304  37.6%     - 1286s
     1     3 56802.7263    1  352 41786.7076 57500.7304  37.6% 34140 1354s
     2     4 56901.9750    1  393 41786.7076 56901.9750  36.2% 25035 1378s
     3     6 56600.8753    2  389 41786.7076 56901.6719  36.2% 19937 1408s
     5    11 55166.7259    3  362 41786.7076 56901.6719  36.2% 17981 1447s
    10    22 54771.5551    4  355 41786.7076 56170.0525  34.4% 16153 1499s
    21    33 55595.8261    5  411 41786.7076 56125.7889  34.3% 20632 1618s
    32    63 54340.3276    6  328 41786.7076 56125.7889  34.3% 25256 2052s
    62    95 53972.0443    7  392 41786.7076 55691.3222  33.3% 30131 2112s
    94   229 53901.5924    8  387 41786.7076 55350.4683  32.5% 25370 2190s
   228   298 53723.4097   11  367 41786.7076 55350.1076  32.5% 14412 2237s
   297   357 53112.9966   14  296 41786.7076 55350.1076  32.5% 12447 2277s
   356   418 52894.6300   16  291 41786.7076 55350.1076  32.5% 11646 2318s
   417   475 52635.0907   18  277 41786.7076 55350.1076  32.5% 10956 2351s
   474   537 51636.2327   20  339 41786.7076 55350.1076  32.5% 10519 2387s
   536   602 51582.0586   21  392 41786.7076 55350.1076  32.5% 10155 2418s
   601   673 51560.9256   23  378 41786.7076 55350.1076  32.5%  9951 2448s
   672   737 50838.5766   25  367 41786.7076 55350.1076  32.5%  9716 2477s
   736   813 50410.7423   26  258 41786.7076 55350.1076  32.5%  9616 2503s
   812   843 45766.7391   28  243 41786.7076 55350.1076  32.5%  9426 2525s
   844   883 45440.4473   29  248 41786.7076 55350.1076  32.5%  9385 2546s
   884   912 43515.2385   31  209 41786.7076 55350.1076  32.5%  9339 2573s
   913   941 43513.9833   32  204 41786.7076 55350.1076  32.5%  9286 2596s
   944   972 43259.4150   33  205 41786.7076 55350.1076  32.5%  9284 2619s
   975  1000 43244.4831   34  205 41786.7076 55350.1076  32.5%  9256 2640s
  1009  1027 43236.7705   35  201 41786.7076 55350.1076  32.5%  9266 2666s
  1044  1060 43187.5060   36  197 41786.7076 55350.1076  32.5%  9206 2692s
  1081  1094 infeasible   37      41786.7076 55350.1076  32.5%  9108 2715s
H 1101  1094                    41817.264622 55350.1076  32.4%  9083 2715s
  1121  1202 49162.1849   23  332 41817.2646 55350.1076  32.4%  9146 2749s
  1253  1275 49034.1255   24  329 41817.2646 55350.1076  32.4%  8839 2782s
  1351  1335 48747.9870   28  315 41817.2646 55350.1076  32.4%  8732 2816s
  1447  1414 47687.3264   31  303 41817.2646 55350.1076  32.4%  8705 2853s
  1542  1519 47521.4208   33  306 41817.2646 55350.1076  32.4%  8721 2890s
  1690  1553 44413.8035   36  198 41817.2646 55350.1076  32.4%  8549 2926s
  1842  1594 43369.4322   39  158 41817.2646 55350.1076  32.4%  8317 2966s
  1955  1647 42108.5085   44  134 41817.2646 55127.6175  31.8%  8335 3013s
  2064  1718 51587.7616    9  357 41817.2646 55127.6175  31.8%  8446 3057s
  2167  1745 51111.5773   10  332 41817.2646 55127.6175  31.8%  8500 3098s
  2204  1771 50497.4473   11  234 41817.2646 55127.6175  31.8%  8602 3140s
  2240  1817 49023.5704   12  228 41817.2646 55127.6175  31.8%  8694 3175s
  2292  1892 49206.0668   12  276 41817.2646 54906.8648  31.3%  8734 3222s
  2371  2016 48836.3829   13  253 41817.2646 54890.4985  31.3%  8794 3268s
  2499  2136 48754.2095   14  267 41817.2646 54890.4985  31.3%  8762 3317s
  2635  2277 48268.6442   13  207 41817.2646 54890.4985  31.3%  8745 3372s
  2798  2404 47881.1837   14  312 41817.2646 54890.4985  31.3%  8726 3427s
  2959  2527 47613.6568   16  203 41817.2646 54890.4985  31.3%  8730 3493s
  3130  2648 47079.3379   19  315 41817.2646 54890.4985  31.3%  8731 3548s
  3295  2783 43425.6657   18  139 41817.2646 54890.4985  31.3%  8741 3600s

Cutting planes:
  Learned: 1
  Gomory: 9
  Implied bound: 66
  MIR: 2643
  Flow cover: 2623
  RLT: 69
  Relax-and-lift: 786

Explored 3472 nodes (31014474 simplex iterations) in 3600.05 seconds (5621.66 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41817.3 41786.7 41449.7 ... 40200.1

Time limit reached
Best objective 4.181726462181e+04, best bound 5.489049846271e+04, gap 31.2628%
  WARNING: Time limit reached. Using best solution found (gap: 31.26%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 41817.26, θ = 205623.78
  Upper Bound (UB) = 41817.26

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205623.78
  [DEBUG]   ✓ Scenario 0: θ = 205623.78 ≤ Q = 205623.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205623.78 ≤ Q = 205623.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205623.78 ≤ Q = 205623.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205623.78 ≤ Q = 205623.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205623.78 ≤ Q = 205623.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205623.78 ≤ Q = 205623.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 205623.78 ≤ Q = 205623.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 205623.78 ≤ Q = 205623.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 205623.78 ≤ Q = 205623.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 205623.78 ≤ Q = 205623.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 205623.78 ≤ Q = 205623.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 205623.78 ≤ Q = 205623.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x241f4734
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x241f4734
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.381460e+13
Presolve removed 2598 rows and 1889 columns
Presolve time: 0.01s
Presolved: 495 rows, 500 columns, 1399 nonzeros
Found heuristic solution: objective 6162555.8773
Variable types: 340 continuous, 160 integer (160 binary)

Root relaxation: objective -1.947166e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194716.61    0  125 6162555.88 -194716.61   103%     -    0s
H    0     0                    -160726.1304 -194716.61  21.1%     -    0s
H    0     0                    -161639.3535 -194716.61  20.5%     -    0s
     0     0 -173279.79    0   55 -161639.35 -173279.79  7.20%     -    0s
H    0     0                    -168723.1077 -173175.97  2.64%     -    0s
H    0     0                    -169056.2822 -173175.97  2.44%     -    0s
H    0     0                    -170200.2044 -173175.97  1.75%     -    0s
H    0     0                    -170533.3790 -173175.97  1.55%     -    0s
     0     0 -171349.95    0   49 -170533.38 -171349.95  0.48%     -    0s
     0     0 -171328.56    0   45 -170533.38 -171328.56  0.47%     -    0s
     0     0 -171328.44    0   45 -170533.38 -171328.44  0.47%     -    0s
H    0     0                    -170573.7776 -171120.38  0.32%     -    0s
     0     0 -171120.38    0   19 -170573.78 -171120.38  0.32%     -    0s
     0     0 -171110.73    0   16 -170573.78 -171110.73  0.31%     -    0s
     0     0 -171087.19    0   16 -170573.78 -171087.19  0.30%     -    0s
H    0     0                    -170577.3720 -171086.80  0.30%     -    0s
H    0     0                    -170579.1040 -171086.80  0.30%     -    0s
     0     0 -171083.91    0   16 -170579.10 -171083.91  0.30%     -    0s
     0     0 -171079.17    0   16 -170579.10 -171079.17  0.29%     -    0s
H    0     0                    -170679.4509 -171079.17  0.23%     -    0s
     0     2 -171079.17    0   16 -170679.45 -171079.17  0.23%     -    0s
H   28    38                    -170711.3745 -170966.97  0.15%   7.4    0s
H   32    38                    -170759.1890 -170960.53  0.12%   7.7    0s
H   40    38                    -170765.7712 -170944.70  0.10%   7.4    0s
*  313   138              11    -170766.6240 -170890.95  0.07%   3.6    0s
*  320   138              13    -170786.2310 -170890.95  0.06%   3.6    0s
*  331   138              12    -170797.6948 -170890.95  0.05%   3.5    0s
*  335   138              13    -170847.7487 -170890.95  0.03%   3.5    0s
*  339   138              12    -170859.2124 -170887.64  0.02%   3.5    0s

Cutting planes:
  Gomory: 30
  Implied bound: 4
  MIR: 125
  Flow cover: 8
  RLT: 32
  Relax-and-lift: 8
  BQP: 6

Explored 492 nodes (1967 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -170859 -170848 -170798 ... -170579
No other solutions better than -170859

Optimal solution found (tolerance 1.00e-06)
Best objective -1.708592124104e+05, best bound -1.708592124104e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 198187.76
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -170859.21
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -170859.21 = 198187.76
  [DEBUG]   Current θ from Master = 205623.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7436.02 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34381.25
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 2856.8628, Absolute Gap = 2856.8628, Relative Gap = 0.068318
  Not converged yet (gap = 2856.86 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x3bb08ba4
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 4.01s
Presolved: 108243 rows, 46070 columns, 654635 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -336204.0865
Found heuristic solution: objective -179585.9549

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 629
 AA' NZ     : 4.001e+06
 Factor NZ  : 9.907e+06 (roughly 140 MB of memory)
 Factor Ops : 2.492e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.56500741e+07  2.25114072e+08  2.09e+05 2.33e+01  1.26e+05     6s
   1  -2.00182624e+07  2.21467776e+08  1.50e+05 1.24e+02  9.00e+04     6s
   2  -1.07317068e+07  1.86460347e+08  7.84e+04 4.21e+01  4.87e+04     6s
   3  -1.91549619e+06  1.40147261e+08  1.04e+04 3.24e+00  7.05e+03     6s
   4  -7.10625768e+05  7.15486627e+07  1.10e+03 3.49e-01  9.83e+02     7s
   5  -6.12120901e+05  4.40470085e+07  5.24e+02 1.79e-01  4.94e+02     7s
   6  -4.90593943e+05  2.89270581e+07  1.31e+02 1.07e-01  2.10e+02     7s
   7  -3.42101176e+05  2.01256105e+07  3.47e+01 6.99e-02  1.17e+02     7s
   8  -2.13436422e+05  1.55511310e+07  1.14e+01 5.29e-02  8.34e+01     7s
   9  -1.27157132e+05  5.85268230e+06  5.18e+00 1.87e-02  3.10e+01     7s
  10  -8.75192506e+04  2.71338663e+06  2.68e+00 8.38e-03  1.43e+01     7s
  11  -3.50350912e+04  1.15287254e+06  1.15e+00 3.54e-03  6.03e+00     7s
  12  -8.63146897e+03  4.96381572e+05  6.99e-01 1.61e-03  2.56e+00     7s
  13   5.18853714e+03  2.96795338e+05  4.82e-01 8.44e-04  1.48e+00     7s
  14   1.86750565e+04  2.07387707e+05  3.57e-01 2.71e-03  9.55e-01     7s
  15   2.79079231e+04  1.82021616e+05  2.87e-01 2.51e-03  7.80e-01     7s
  16   3.80076148e+04  1.45962380e+05  2.20e-01 1.86e-03  5.46e-01     7s
  17   4.62166590e+04  1.20356893e+05  1.62e-01 3.86e-03  3.75e-01     8s
  18   5.14438882e+04  1.01344957e+05  1.31e-01 2.05e-03  2.53e-01     8s
  19   5.99624072e+04  9.50298775e+04  8.29e-02 1.85e-03  1.77e-01     8s
  20   6.23749739e+04  8.88686287e+04  6.95e-02 1.28e-03  1.34e-01     8s
  21   6.42999965e+04  8.70741454e+04  5.87e-02 1.22e-03  1.15e-01     8s
  22   6.70805420e+04  8.52325570e+04  4.38e-02 1.09e-03  9.18e-02     8s
  23   6.80446421e+04  8.21899343e+04  3.86e-02 1.05e-03  7.16e-02     8s
  24   6.91181865e+04  8.00070505e+04  3.34e-02 9.36e-04  5.51e-02     8s
  25   7.08579474e+04  7.92044389e+04  2.49e-02 9.67e-04  4.22e-02     8s
  26   7.12708769e+04  7.84596412e+04  2.29e-02 7.51e-04  3.64e-02     8s
  27   7.19642445e+04  7.78618131e+04  1.96e-02 5.86e-04  2.99e-02     9s
  28   7.25551039e+04  7.75485216e+04  1.68e-02 4.64e-04  2.53e-02     9s
  29   7.30924787e+04  7.74192308e+04  1.42e-02 4.09e-04  2.19e-02     9s
  30   7.35631986e+04  7.71862671e+04  1.19e-02 3.44e-04  1.83e-02     9s
  31   7.41111918e+04  7.69555735e+04  9.21e-03 3.23e-04  1.44e-02     9s
  32   7.45749732e+04  7.65762385e+04  7.01e-03 1.61e-04  1.01e-02     9s
  33   7.50938681e+04  7.64318207e+04  4.58e-03 1.18e-04  6.77e-03     9s
  34   7.54822631e+04  7.63525956e+04  2.80e-03 8.65e-05  4.41e-03     9s
  35   7.55764143e+04  7.63058228e+04  2.38e-03 7.02e-05  3.69e-03     9s
  36   7.56448318e+04  7.62625030e+04  2.07e-03 5.35e-05  3.13e-03     9s
  37   7.57374894e+04  7.62060865e+04  1.65e-03 4.59e-05  2.37e-03    10s
  38   7.58230588e+04  7.61785984e+04  1.30e-03 3.25e-05  1.80e-03    10s
  39   7.59785806e+04  7.61575022e+04  5.86e-04 3.71e-05  9.06e-04    10s
  40   7.60427250e+04  7.61463104e+04  3.14e-04 2.44e-05  5.24e-04    10s
  41   7.60533639e+04  7.61419083e+04  2.72e-04 1.96e-05  4.48e-04    10s
  42   7.60685161e+04  7.61349363e+04  2.12e-04 1.19e-05  3.36e-04    10s
  43   7.60979817e+04  7.61319499e+04  9.31e-05 8.90e-06  1.72e-04    10s
  44   7.61134490e+04  7.61285867e+04  3.24e-05 5.63e-06  7.65e-05    10s
  45   7.61178015e+04  7.61253523e+04  1.64e-05 2.52e-06  3.82e-05    10s
  46   7.61195130e+04  7.61231515e+04  1.05e-05 4.42e-07  1.84e-05    10s
  47   7.61223583e+04  7.61229308e+04  4.67e-07 2.63e-07  2.89e-06    11s
  48   7.61225674e+04  7.61225731e+04  7.24e-09 2.00e-08  2.87e-08    11s
  49   7.61225711e+04  7.61225713e+04  2.64e-08 5.59e-08  7.57e-10    11s

Barrier solved model in 49 iterations and 10.79 seconds (9.42 work units)
Optimal objective 7.61225711e+04


Root crossover log...

   95115 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    6560 PPushes remaining with PInf 4.5720867e-05                14s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9815913e+04     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   45047    7.6122571e+04   0.000000e+00   2.981591e+04     15s
   45088    7.6122571e+04   0.000000e+00   0.000000e+00     15s
   45088    7.6122571e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.64s

Solved with barrier

Root relaxation: objective 7.612257e+04, 45088 iterations, 10.53 seconds (12.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 76122.5713    0  184 -179585.95 76122.5713   142%     -   16s
H    0     0                    -177553.7851 76122.5713   143%     -   17s
H    0     0                    -171398.8916 76122.5713   144%     -   17s
H    0     0                    -170210.0184 76122.5713   145%     -   18s
H    0     0                    -169496.3135 76122.5713   145%     -   18s
H    0     0                    -168141.5594 76122.5713   145%     -   18s
H    0     0                    -168108.3181 76122.5713   145%     -   18s
H    0     0                    -168098.6608 76122.5713   145%     -   19s
H    0     0                    -75887.01771 76122.5713   200%     -   19s
H    0     0                    -31824.72463 76122.5713   339%     -   19s
H    0     0                    3657.2313479 76122.5713  1981%     -   21s
H    0     0                    5388.9709679 76122.5713  1313%     -   21s
H    0     0                    25665.311073 76122.5713   197%     -   21s
H    0     0                    26463.901493 76122.5713   188%     -   21s
     0     0 69037.5829    0  262 26463.9015 69037.5829   161%     -   85s
H    0     0                    27414.392756 69037.4499   152%     -   86s
     0     0 68535.3196    0  257 27414.3928 68535.3196   150%     -  116s
     0     0 68469.5065    0  243 27414.3928 68469.5065   150%     -  123s
     0     0 68467.2910    0  248 27414.3928 68467.2910   150%     -  124s
     0     0 68395.8450    0  244 27414.3928 68395.8450   149%     -  138s
     0     0 68391.5282    0  247 27414.3928 68391.5282   149%     -  140s
     0     0 68390.9820    0  247 27414.3928 68390.9820   149%     -  141s
H    0     0                    28771.118422 64897.9024   126%     -  219s
     0     0 64897.9024    0  283 28771.1184 64897.9024   126%     -  219s
H    0     0                    30825.567861 64897.8542   111%     -  220s
H    0     0                    32623.671112 64897.8542  98.9%     -  221s
H    0     0                    32825.858273 64897.8542  97.7%     -  221s
H    0     0                    32905.979420 64897.8542  97.2%     -  221s
H    0     0                    33403.404038 64897.8542  94.3%     -  221s
     0     0 64036.6570    0  308 33403.4040 64036.6570  91.7%     -  259s
     0     0 63837.3459    0  321 33403.4040 63837.3459  91.1%     -  282s
     0     0 63685.3527    0  326 33403.4040 63685.3527  90.7%     -  306s
     0     0 63560.1150    0  306 33403.4040 63560.1150  90.3%     -  326s
     0     0 63489.4051    0  308 33403.4040 63489.4051  90.1%     -  336s
     0     0 63458.6390    0  319 33403.4040 63458.6390  90.0%     -  345s
     0     0 63440.5150    0  321 33403.4040 63440.5150  89.9%     -  349s
     0     0 63437.1811    0  324 33403.4040 63437.1811  89.9%     -  351s
     0     0 63430.6818    0  322 33403.4040 63430.6818  89.9%     -  354s
     0     0 63393.6710    0  307 33403.4040 63393.6710  89.8%     -  362s
     0     0 63387.6316    0  321 33403.4040 63387.6316  89.8%     -  365s
     0     0 63387.1656    0  321 33403.4040 63387.1656  89.8%     -  366s
     0     0 60980.8937    0  403 33403.4040 60980.8937  82.6%     -  453s
H    0     0                    33503.826068 60980.5720  82.0%     -  454s
H    0     0                    33519.413539 60980.5720  81.9%     -  454s
H    0     0                    33575.741261 60391.2202  79.9%     -  496s
H    0     0                    33630.547710 60391.2202  79.6%     -  496s
H    0     0                    35895.726503 60391.2202  68.2%     -  496s
H    0     0                    36303.466546 60391.2202  66.4%     -  496s
     0     0 60391.2202    0  410 36303.4665 60391.2202  66.4%     -  496s
     0     0 60084.8248    0  419 36303.4665 60084.8248  65.5%     -  523s
     0     0 59953.3702    0  415 36303.4665 59953.3702  65.1%     -  539s
     0     0 59883.0677    0  419 36303.4665 59883.0677  65.0%     -  547s
     0     0 59716.6563    0  431 36303.4665 59716.6563  64.5%     -  563s
     0     0 59692.7156    0  436 36303.4665 59692.7156  64.4%     -  569s
     0     0 59637.3349    0  434 36303.4665 59637.3349  64.3%     -  579s
     0     0 59611.7531    0  440 36303.4665 59611.7531  64.2%     -  589s
     0     0 59592.7697    0  450 36303.4665 59592.7697  64.2%     -  593s
     0     0 59588.0519    0  454 36303.4665 59588.0519  64.1%     -  597s
     0     0 59566.3618    0  456 36303.4665 59566.3618  64.1%     -  602s
     0     0 59554.6532    0  450 36303.4665 59554.6532  64.0%     -  605s
     0     0 59537.5368    0  450 36303.4665 59537.5368  64.0%     -  609s
     0     0 59528.3241    0  452 36303.4665 59528.3241  64.0%     -  612s
     0     0 59526.7819    0  449 36303.4665 59526.7819  64.0%     -  613s
     0     0 58647.4871    0  395 36303.4665 58647.4871  61.5%     -  659s
H    0     0                    36547.202314 58646.9626  60.5%     -  661s
     0     0 58449.3635    0  391 36547.2023 58449.3635  59.9%     -  682s
     0     0 58332.8338    0  449 36547.2023 58332.8338  59.6%     -  705s
     0     0 58286.5125    0  451 36547.2023 58286.5125  59.5%     -  719s
     0     0 58263.8930    0  449 36547.2023 58263.8930  59.4%     -  729s
H    0     0                    37197.972325 58254.1362  56.6%     -  738s
H    0     0                    37746.388242 58254.1362  54.3%     -  738s
H    0     0                    37752.648829 58254.1362  54.3%     -  738s
     0     0 58254.1362    0  449 37752.6488 58254.1362  54.3%     -  738s
H    0     0                    38006.831634 58246.6250  53.3%     -  744s
H    0     0                    38155.963217 58246.6250  52.7%     -  744s
     0     0 58246.6250    0  393 38155.9632 58246.6250  52.7%     -  744s
     0     0 58238.3632    0  452 38155.9632 58238.3632  52.6%     -  750s
     0     0 58219.8895    0  395 38155.9632 58219.8895  52.6%     -  761s
     0     0 58217.9039    0  453 38155.9632 58217.9039  52.6%     -  764s
H    0     0                    38818.798406 58002.3430  49.4%     -  799s
     0     0 58002.3430    0  451 38818.7984 58002.3430  49.4%     -  799s
H    0     0                    39072.102249 58002.0966  48.4%     -  800s
H    0     0                    39103.138740 58002.0966  48.3%     -  800s
     0     0 57937.4620    0  399 39103.1387 57937.4620  48.2%     -  818s
     0     0 57914.6510    0  469 39103.1387 57914.6510  48.1%     -  828s
     0     0 57886.4558    0  461 39103.1387 57886.4558  48.0%     -  835s
H    0     0                    39479.437544 57880.9633  46.6%     -  840s
     0     0 57880.9633    0  470 39479.4375 57880.9633  46.6%     -  840s
H    0     0                    39820.054433 57877.4577  45.3%     -  844s
H    0     0                    39936.980610 57877.4577  44.9%     -  844s
H    0     0                    40281.903959 57877.4577  43.7%     -  844s
H    0     0                    40408.357971 57877.4577  43.2%     -  844s
     0     0 57877.4577    0  396 40408.3580 57877.4577  43.2%     -  844s
     0     0 57874.5470    0  467 40408.3580 57874.5470  43.2%     -  849s
     0     0 57871.3024    0  469 40408.3580 57871.3024  43.2%     -  856s
     0     0 57870.1509    0  475 40408.3580 57870.1509  43.2%     -  858s
     0     0 57768.0227    0  318 40408.3580 57768.0227  43.0%     -  877s
H    0     0                    40574.095787 57766.3601  42.4%     -  884s
H    0     0                    40843.162147 57766.3601  41.4%     -  884s
     0     0 57740.1382    0  391 40843.1621 57740.1382  41.4%     -  896s
     0     0 57717.5667    0  394 40843.1621 57717.5667  41.3%     -  904s
     0     0 57706.7132    0  389 40843.1621 57706.7132  41.3%     -  909s
     0     0 57700.1041    0  470 40843.1621 57700.1041  41.3%     -  913s
     0     0 57698.6310    0  464 40843.1621 57698.6310  41.3%     -  916s
     0     0 57667.5691    0  472 40843.1621 57667.5691  41.2%     -  932s
H    0     0                    40891.620526 57667.5641  41.0%     -  933s
H    0     0                    40894.126941 57667.5641  41.0%     -  933s
     0     0 57647.1032    0  454 40894.1269 57647.1032  41.0%     -  949s
     0     0 57637.5737    0  461 40894.1269 57637.5737  40.9%     -  957s
     0     0 57633.4354    0  468 40894.1269 57633.4354  40.9%     -  963s
     0     0 57632.1466    0  470 40894.1269 57632.1466  40.9%     -  968s
     0     0 57595.8753    0  395 40894.1269 57595.8753  40.8%     -  983s
     0     0 57585.1494    0  416 40894.1269 57585.1494  40.8%     -  998s
     0     0 57571.7325    0  325 40894.1269 57571.7325  40.8%     - 1006s
     0     0 57564.9136    0  388 40894.1269 57564.9136  40.8%     - 1013s
     0     0 57562.2586    0  388 40894.1269 57562.2586  40.8%     - 1015s
     0     0 57551.5168    0  393 40894.1269 57551.5168  40.7%     - 1022s
     0     0 57548.3487    0  470 40894.1269 57548.3487  40.7%     - 1028s
     0     0 57545.8515    0  406 40894.1269 57545.8515  40.7%     - 1031s
     0     0 57530.0131    0  461 40894.1269 57530.0131  40.7%     - 1040s
     0     0 57525.6930    0  404 40894.1269 57525.6930  40.7%     - 1048s
     0     0 57523.9291    0  396 40894.1269 57523.9291  40.7%     - 1049s
     0     0 57518.3905    0  416 40894.1269 57518.3905  40.7%     - 1056s
     0     0 57518.2050    0  416 40894.1269 57518.2050  40.7%     - 1060s
H    0     0                    40914.107936 57518.1839  40.6%     - 1226s
H    0     0                    41009.363935 57518.1839  40.3%     - 1228s
     0     2 57518.1839    0  416 41009.3639 57518.1839  40.3%     - 1231s
     1     4 57506.7080    1  399 41009.3639 57518.1839  40.3%  2206 1265s
     3     6 56196.6730    2  291 41009.3639 57505.9789  40.2% 13140 1320s
     5    10 55769.6942    3  283 41009.3639 57505.9789  40.2% 16108 1349s
     9    20 55589.1961    4  279 41009.3639 56891.7676  38.7% 14497 1380s
    19    40 55300.3521    5  279 41009.3639 56553.4149  37.9% 13508 1417s
    39    52 54967.9772    5  377 41009.3639 56265.0709  37.2% 18319 1501s
    51    76 54455.3771    6  332 41009.3639 56265.0709  37.2% 21117 1565s
H   54    76                    41099.060387 56265.0709  36.9% 20446 1565s
H   63    76                    41173.879575 56265.0709  36.7% 19346 1565s
    75   113 54367.4872    7  328 41173.8796 56265.0709  36.7% 17312 1628s
   112   199 54319.4034    8  405 41173.8796 56265.0709  36.7% 15986 1697s
   198   276 54267.3418    9  378 41173.8796 56265.0709  36.7% 12107 1743s
   275   334 51938.0377   12  283 41173.8796 56265.0709  36.7% 11448 1786s
   333   399 50197.7755   14  235 41173.8796 56265.0709  36.7% 10453 1829s
   398   436 49259.7206   12  271 41173.8796 56265.0709  36.7%  9537 1867s
   435   477 49124.4633   13  249 41173.8796 56265.0709  36.7%  9240 1906s
H  454   477                    41265.656604 56265.0709  36.3%  9227 1906s
   476   509 49136.6677   13  246 41265.6566 56265.0709  36.3%  9139 1933s
H  484   509                    41415.200524 56265.0709  35.9%  9125 1933s
H  491   509                    41664.421811 56265.0709  35.0%  9087 1933s
   508   556 48639.8043   14  226 41664.4218 56265.0709  35.0%  9147 1969s
   563   612 46298.9345   15  236 41664.4218 56265.0709  35.0%  9150 1998s
   631   686 48350.0148   14  213 41664.4218 56265.0709  35.0%  9068 2029s
   707   752 48469.6719   15  200 41664.4218 56265.0709  35.0%  8874 2059s
   785   806 46149.5935   16  185 41664.4218 56265.0709  35.0%  8683 2083s
   855   860 48154.2635   18  202 41664.4218 56265.0709  35.0%  8561 2112s
   930   917 47925.0528   17  188 41664.4218 56265.0709  35.0%  8435 2141s
  1015   939 47863.6531   19  213 41664.4218 56265.0709  35.0%  8226 2168s
H 1050   939                    41938.081703 56265.0709  34.2%  8226 2168s
  1053   980 47879.6777   19  198 41938.0817 56265.0709  34.2%  8222 2199s
  1140  1029 48037.3827   19  193 41938.0817 56265.0709  34.2%  8136 2234s
  1230  1095 47539.8444   22  199 41938.0817 56265.0709  34.2%  8086 2264s
  1330  1199 46780.9521   25  182 41938.0817 56265.0709  34.2%  7998 2301s
  1452  1319 45867.0129   27  160 41938.0817 56265.0709  34.2%  7733 2336s
  1606  1404 46245.7411   31  118 41938.0817 56265.0709  34.2%  7458 2369s
  1766  1420 infeasible   30      41938.0817 56265.0709  34.2%  7249 2409s
  1921  1457 43223.1441   33  111 41938.0817 56265.0709  34.2%  7055 2454s
H 1953  1457                    42005.153676 56265.0709  33.9%  7073 2454s
  2034  1457     cutoff   34      42005.1537 56265.0709  33.9%  6997 2498s
  2132  1479 50287.3265   13  281 42005.1537 56265.0709  33.9%  6996 2541s
  2206  1536 49252.6767   14  245 42005.1537 56265.0709  33.9%  7144 2589s
  2274  1559 47629.6525   16  209 42005.1537 56265.0709  33.9%  7388 2628s
  2309  1592 47180.2813   16  212 42005.1537 56265.0709  33.9%  7541 2667s
  2354  1647 49029.9250   14  366 42005.1537 56265.0709  33.9%  7655 2711s
  2429  1699 48090.8682   15  244 42005.1537 56265.0709  33.9%  7738 2759s
  2521  1767 47333.6203   17  277 42005.1537 56265.0709  33.9%  7830 2813s
  2639  1830 47253.5944   18  304 42005.1537 56265.0709  33.9%  7864 2863s
  2752  1896 44393.6436   20  182 42005.1537 56265.0709  33.9%  7932 2923s
  2871  1963 46338.4583   21  315 42005.1537 56021.8602  33.4%  8044 2983s
  3016  2003 46247.5215   22  316 42005.1537 56021.8567  33.4%  8067 3047s
  3120  2026 43177.2535   23  170 42005.1537 56021.8567  33.4%  8168 3113s
  3155  2042 45548.2411   25  321 42005.1537 55929.2826  33.1%  8291 3168s
  3207  2068 44892.2869   26  283 42005.1537 55192.9158  31.4%  8377 3234s
  3271  2114 43953.1633   26  285 42005.1537 55192.9158  31.4%  8468 3309s
  3349  2157 44748.9000   27  333 42005.1537 54835.6605  30.5%  8633 3387s
  3432  2178 43661.5877   28  176 42005.1537 54835.6605  30.5%  8813 3447s
  3471  2211 43847.1004   27  284 42005.1537 54835.6605  30.5%  8918 3518s
  3518  2252 42691.2989   29  290 42005.1537 54835.6605  30.5%  9006 3590s
  3601  2249 infeasible   12      42005.1537 54551.6225  29.9%  9127 3600s

Cutting planes:
  Gomory: 13
  Implied bound: 65
  MIR: 2772
  Flow cover: 2690
  RLT: 70
  Relax-and-lift: 539

Explored 3612 nodes (33631622 simplex iterations) in 3600.06 seconds (5703.88 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 42005.2 41938.1 41664.4 ... 40894.1

Time limit reached
Best objective 4.200515367587e+04, best bound 5.455162248298e+04, gap 29.8689%
  WARNING: Time limit reached. Using best solution found (gap: 29.87%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 42005.15, θ = 206223.20
  Upper Bound (UB) = 42005.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206223.20
  [DEBUG]   ✓ Scenario 0: θ = 206223.20 ≤ Q = 206223.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 206223.20 ≤ Q = 206223.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 206223.20 ≤ Q = 206223.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 206223.20 ≤ Q = 206223.20 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6e3c3b7c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6e3c3b7c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.370873e+13
Presolve removed 2598 rows and 1889 columns
Presolve time: 0.01s
Presolved: 495 rows, 500 columns, 1399 nonzeros
Found heuristic solution: objective 6173709.6236
Variable types: 340 continuous, 160 integer (160 binary)

Root relaxation: objective -1.940925e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194092.52    0  125 6173709.62 -194092.52   103%     -    0s
H    0     0                    -160210.7400 -194092.52  21.1%     -    0s
H    0     0                    -161288.8373 -194092.52  20.3%     -    0s
     0     0 -169429.65    0   78 -161288.84 -169429.65  5.05%     -    0s
H    0     0                    -164351.1459 -169319.24  3.02%     -    0s
H    0     0                    -164684.3205 -169319.24  2.81%     -    0s
H    0     0                    -165015.0452 -169319.24  2.61%     -    0s
H    0     0                    -165348.2197 -169319.24  2.40%     -    0s
     0     0 -167160.01    0   83 -165348.22 -167160.01  1.10%     -    0s
H    0     0                    -165627.5795 -167132.27  0.91%     -    0s
     0     0 -166753.99    0   64 -165627.58 -166753.99  0.68%     -    0s
     0     0 -166684.52    0   64 -165627.58 -166684.52  0.64%     -    0s
     0     0 -166684.12    0   64 -165627.58 -166684.12  0.64%     -    0s
     0     0 -166548.42    0   58 -165627.58 -166548.42  0.56%     -    0s
     0     0 -166547.42    0   58 -165627.58 -166547.42  0.56%     -    0s
H    0     0                    -165768.4062 -166546.81  0.47%     -    0s
     0     2 -166546.81    0   58 -165768.41 -166546.81  0.47%     -    0s
H   93   230                    -165826.5388 -166193.69  0.22%   8.2    0s
*  409   387              14    -165922.9783 -166193.69  0.16%   5.6    0s
*  457   387              16    -165970.2810 -166169.50  0.12%   5.4    0s
*  492   387              13    -166106.4791 -166169.50  0.04%   5.3    0s

Cutting planes:
  Gomory: 40
  MIR: 167
  Flow cover: 7
  RLT: 6
  Relax-and-lift: 1
  BQP: 1

Explored 888 nodes (3839 simplex iterations) in 0.19 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -166106 -165970 -165923 ... -160211
No other solutions better than -166106

Optimal solution found (tolerance 1.00e-06)
Best objective -1.661064791334e+05, best bound -1.661064791334e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 202940.50
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -166106.48
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -166106.48 = 202940.50
  [DEBUG]   Current θ from Master = 206223.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3282.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38722.46
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 3044.7519, Absolute Gap = 3044.7519, Relative Gap = 0.072485
  Not converged yet (gap = 3044.75 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x6f92f207
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 4.29s
Presolved: 116463 rows, 49440 columns, 701851 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -337969.5423
Found heuristic solution: objective -179585.9549

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.58s

Barrier statistics:
 Dense cols : 629
 AA' NZ     : 4.435e+06
 Factor NZ  : 1.059e+07 (roughly 150 MB of memory)
 Factor Ops : 2.084e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.69981285e+07  2.40193494e+08  2.20e+05 2.16e+01  1.32e+05     8s
   1  -2.11401635e+07  2.38630576e+08  1.57e+05 1.25e+02  9.40e+04     8s
   2  -1.16514574e+07  2.00658140e+08  8.51e+04 4.19e+01  5.25e+04     8s
   3  -1.93290339e+06  1.51843799e+08  1.05e+04 3.58e+00  7.11e+03     8s
   4  -7.33320998e+05  7.86572745e+07  1.25e+03 5.16e-01  1.08e+03     8s
   5  -6.24344195e+05  4.66367429e+07  5.83e+02 2.24e-01  5.18e+02     8s
   6  -4.98038870e+05  3.07671542e+07  1.29e+02 1.34e-01  2.07e+02     8s
   7  -3.64324272e+05  2.10808077e+07  3.97e+01 8.59e-02  1.16e+02     8s
   8  -2.41953402e+05  1.80372571e+07  9.28e+00 7.23e-02  8.91e+01     8s
   9  -1.47174640e+05  6.08428817e+06  4.62e+00 2.42e-02  3.00e+01     8s
  10  -9.20640646e+04  2.36322364e+06  2.50e+00 8.72e-03  1.17e+01     8s
  11  -4.25517701e+04  9.97745233e+05  1.30e+00 3.52e-03  4.92e+00     8s
  12  -8.19187341e+03  4.50965474e+05  7.42e-01 1.85e-03  2.17e+00     9s
  13   2.38864199e+03  2.89360282e+05  5.78e-01 1.33e-03  1.35e+00     9s
  14   1.57543950e+04  2.06444613e+05  4.44e-01 1.49e-03  8.99e-01     9s
  15   2.38226826e+04  1.80795111e+05  3.74e-01 1.64e-03  7.40e-01     9s
  16   3.81763309e+04  1.49980453e+05  2.60e-01 2.58e-03  5.27e-01     9s
  17   4.58218894e+04  1.24623802e+05  1.99e-01 1.97e-03  3.71e-01     9s
  18   5.39042616e+04  1.09898258e+05  1.43e-01 1.58e-03  2.64e-01     9s
  19   6.09478758e+04  1.01592002e+05  9.62e-02 1.29e-03  1.91e-01     9s
  20   6.40477062e+04  9.74551268e+04  7.61e-02 1.07e-03  1.57e-01     9s
  21   6.56633640e+04  9.49214258e+04  6.60e-02 9.15e-04  1.38e-01     9s
  22   6.72346957e+04  8.82982055e+04  5.60e-02 1.07e-03  9.91e-02     9s
  23   6.83823343e+04  8.62396864e+04  4.90e-02 8.62e-04  8.41e-02    10s
  24   6.93428109e+04  8.33967670e+04  4.28e-02 9.10e-04  6.62e-02    10s
  25   7.15100291e+04  8.16924441e+04  3.09e-02 1.14e-03  4.79e-02    10s
  26   7.29688374e+04  8.08845046e+04  2.31e-02 9.14e-04  3.73e-02    10s
  27   7.36184296e+04  7.95757736e+04  1.97e-02 1.60e-03  2.81e-02    10s
  28   7.45683125e+04  7.91038616e+04  1.48e-02 1.23e-03  2.14e-02    10s
  29   7.50612316e+04  7.86581299e+04  1.23e-02 8.72e-04  1.69e-02    10s
  30   7.53634542e+04  7.85536679e+04  1.08e-02 7.84e-04  1.50e-02    10s
  31   7.57802735e+04  7.83294479e+04  8.69e-03 5.79e-04  1.20e-02    10s
  32   7.60391245e+04  7.81232262e+04  7.39e-03 2.87e-04  9.82e-03    10s
  33   7.64570887e+04  7.80620579e+04  5.43e-03 2.54e-04  7.56e-03    11s
  34   7.66811134e+04  7.79888134e+04  4.34e-03 2.14e-04  6.16e-03    11s
  35   7.69315489e+04  7.79180446e+04  3.07e-03 1.76e-04  4.64e-03    11s
  36   7.69849398e+04  7.78900909e+04  2.80e-03 1.62e-04  4.26e-03    11s
  37   7.71797818e+04  7.77518320e+04  1.79e-03 1.17e-04  2.69e-03    11s
  38   7.72038334e+04  7.77277173e+04  1.67e-03 9.77e-05  2.47e-03    11s
  39   7.73081141e+04  7.76941482e+04  1.21e-03 7.58e-05  1.82e-03    11s
  40   7.74082532e+04  7.76387975e+04  7.33e-04 5.74e-05  1.09e-03    11s
  41   7.74942103e+04  7.76117294e+04  3.19e-04 4.78e-05  5.53e-04    12s
  42   7.75230296e+04  7.75952722e+04  1.99e-04 2.71e-05  3.40e-04    12s
  43   7.75355938e+04  7.75832584e+04  1.45e-04 1.19e-05  2.24e-04    12s
  44   7.75495634e+04  7.75821654e+04  9.11e-05 1.06e-05  1.53e-04    12s
  45   7.75550533e+04  7.75787395e+04  6.99e-05 6.12e-06  1.12e-04    12s
  46   7.75583333e+04  7.75745292e+04  5.68e-05 1.30e-06  7.63e-05    12s
  47   7.75691698e+04  7.75736590e+04  1.37e-05 3.32e-07  2.11e-05    12s
  48   7.75714845e+04  7.75734621e+04  5.62e-06 2.10e-07  9.31e-06    12s
  49   7.75718644e+04  7.75732511e+04  4.26e-06 8.30e-08  6.53e-06    13s
  50   7.75726206e+04  7.75731263e+04  1.64e-06 4.44e-09  2.38e-06    13s
  51   7.75729045e+04  7.75731162e+04  6.61e-07 8.27e-10  9.97e-07    13s
  52   7.75730515e+04  7.75731123e+04  1.16e-06 2.65e-07  2.86e-07    13s
  53   7.75731058e+04  7.75731118e+04  8.21e-07 4.17e-07  2.83e-08    13s
  54   7.75731110e+04  7.75731117e+04  3.53e-07 4.35e-09  3.47e-09    13s

Barrier solved model in 54 iterations and 13.13 seconds (11.44 work units)
Optimal objective 7.75731110e+04


Root crossover log...

  101233 DPushes remaining with DInf 0.0000000e+00                13s
   24241 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

   26364 PPushes remaining with PInf 1.4484272e-04                18s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1566899e+05     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   73340    7.7573112e+04   0.000000e+00   2.156690e+05     20s
   73531    7.7573112e+04   0.000000e+00   3.195219e+05     20s
   76269    7.7573112e+04   0.000000e+00   0.000000e+00     25s
   76269    7.7573112e+04   0.000000e+00   0.000000e+00     25s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 7.757311e+04, 76269 iterations, 19.90 seconds (22.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 77573.1117    0  209 -179585.95 77573.1117   143%     -   25s
H    0     0                    -72847.50738 77573.1117   206%     -   26s
H    0     0                    -4031.704077 77573.1117  2024%     -   27s
H    0     0                    -2095.643370 77573.1117  3802%     -   27s
H    0     0                    -1010.574855 77573.1117  7776%     -   29s
H    0     0                    -666.3340183 77573.1117      -     -   29s
H    0     0                    -261.4146676 77573.1117      -     -   29s
H    0     0                    5597.1293429 77573.1117  1286%     -   29s
H    0     0                    5634.3384551 77573.1117  1277%     -   29s
H    0     0                    6549.8578035 77573.1117  1084%     -   29s
H    0     0                    9977.0112696 70061.5345   602%     -   80s
H    0     0                    14197.164971 70061.5345   393%     -   80s
H    0     0                    15710.067743 70061.5345   346%     -   80s
     0     0 70061.5345    0  222 15710.0677 70061.5345   346%     -   80s
     0     0 69565.0474    0  241 15710.0677 69565.0474   343%     -  108s
     0     0 69535.4733    0  268 15710.0677 69535.4733   343%     -  113s
     0     0 69450.9110    0  237 15710.0677 69450.9110   342%     -  123s
     0     0 69450.9110    0  259 15710.0677 69450.9110   342%     -  129s
     0     0 69450.9110    0  248 15710.0677 69450.9110   342%     -  131s
     0     0 69450.9110    0  262 15710.0677 69450.9110   342%     -  133s
     0     0 69450.9110    0  248 15710.0677 69450.9110   342%     -  137s
     0     0 69450.9110    0  246 15710.0677 69450.9110   342%     -  147s
     0     0 69450.9110    0  248 15710.0677 69450.9110   342%     -  147s
H    0     0                    17053.867899 65926.9111   287%     -  211s
H    0     0                    17586.876158 65926.9111   275%     -  211s
H    0     0                    17588.191546 65926.9111   275%     -  211s
     0     0 65926.9111    0  275 17588.1915 65926.9111   275%     -  211s
H    0     0                    23135.432546 65926.8822   185%     -  212s
H    0     0                    23599.241821 65926.8822   179%     -  212s
H    0     0                    23634.296965 65926.8822   179%     -  212s
H    0     0                    23640.895264 65926.8822   179%     -  212s
H    0     0                    23676.213263 65926.8822   178%     -  227s
     0     0 65113.9248    0  286 23676.2133 65113.9248   175%     -  276s
     0     0 64908.1352    0  297 23676.2133 64908.1352   174%     -  301s
     0     0 64834.9240    0  297 23676.2133 64834.9240   174%     -  314s
     0     0 64805.6938    0  306 23676.2133 64805.6938   174%     -  324s
     0     0 64731.2173    0  309 23676.2133 64731.2173   173%     -  339s
     0     0 64585.8841    0  371 23676.2133 64585.8841   173%     -  358s
     0     0 64537.4528    0  369 23676.2133 64537.4528   173%     -  369s
     0     0 64505.4500    0  374 23676.2133 64505.4500   172%     -  379s
     0     0 64492.4144    0  379 23676.2133 64492.4144   172%     -  386s
     0     0 64491.5112    0  379 23676.2133 64491.5112   172%     -  389s
     0     0 61734.7586    0  350 23676.2133 61734.7586   161%     -  484s
H    0     0                    24002.446582 61734.5499   157%     -  486s
     0     0 61300.2191    0  358 24002.4466 61300.2191   155%     -  530s
H    0     0                    27928.268894 61159.4916   119%     -  554s
H    0     0                    28140.023049 61159.4916   117%     -  554s
H    0     0                    28423.303027 61159.4916   115%     -  554s
H    0     0                    28751.911441 61159.4916   113%     -  554s
H    0     0                    28790.356755 61159.4916   112%     -  554s
H    0     0                    28798.039866 61159.4916   112%     -  554s
     0     0 61159.4916    0  379 28798.0399 61159.4916   112%     -  554s
     0     0 61057.4977    0  386 28798.0399 61057.4977   112%     -  576s
     0     0 60963.0612    0  413 28798.0399 60963.0612   112%     -  594s
     0     0 60874.9599    0  389 28798.0399 60874.9599   111%     -  609s
H    0     0                    29067.123543 60797.3085   109%     -  625s
H    0     0                    29081.616396 60797.3085   109%     -  625s
H    0     0                    29228.147607 60797.3085   108%     -  625s
H    0     0                    29342.466807 60797.3085   107%     -  625s
H    0     0                    29390.092683 60797.3085   107%     -  625s
H    0     0                    29568.272202 60797.3085   106%     -  625s
H    0     0                    29696.788619 60797.3085   105%     -  625s
H    0     0                    29843.319830 60797.3085   104%     -  625s
     0     0 60797.3085    0  403 29843.3198 60797.3085   104%     -  625s
     0     0 60780.3454    0  402 29843.3198 60780.3454   104%     -  635s
     0     0 60747.4822    0  404 29843.3198 60747.4822   104%     -  643s
     0     0 60734.0805    0  405 29843.3198 60734.0805   104%     -  649s
     0     0 60704.0189    0  394 29843.3198 60704.0189   103%     -  656s
     0     0 60701.7327    0  441 29843.3198 60701.7327   103%     -  660s
     0     0 60700.6706    0  404 29843.3198 60700.6706   103%     -  662s
H    0     0                    30832.152845 60700.6706  96.9%     -  674s
H    0     0                    30907.270883 60700.6706  96.4%     -  674s
H    0     0                    30972.652840 60700.6706  96.0%     -  674s
H    0     0                    31357.561127 60700.6706  93.6%     -  674s
H    0     0                    31980.530700 60700.6706  89.8%     -  674s
H    0     0                    32031.376675 59337.5986  85.2%     -  727s
H    0     0                    32036.636438 59337.5986  85.2%     -  727s
     0     0 59337.5986    0  358 32036.6364 59337.5986  85.2%     -  727s
     0     0 58933.2345    0  356 32036.6364 58933.2345  84.0%     -  761s
     0     0 58863.6806    0  362 32036.6364 58863.6806  83.7%     -  780s
     0     0 58782.0085    0  477 32036.6364 58782.0085  83.5%     -  807s
     0     0 58752.1846    0  431 32036.6364 58752.1846  83.4%     -  816s
H    0     0                    32094.271976 58705.6109  82.9%     -  828s
     0     0 58705.6109    0  353 32094.2720 58705.6109  82.9%     -  828s
     0     0 58651.1270    0  482 32094.2720 58651.1270  82.7%     -  838s
     0     0 58594.9072    0  479 32094.2720 58594.9072  82.6%     -  848s
     0     0 58562.2711    0  436 32094.2720 58562.2711  82.5%     -  856s
H    0     0                    32678.444236 58550.9641  79.2%     -  860s
H    0     0                    32760.922651 58550.9641  78.7%     -  860s
     0     0 58550.9641    0  489 32760.9227 58550.9641  78.7%     -  860s
     0     0 58537.9945    0  451 32760.9227 58537.9945  78.7%     -  866s
     0     0 58534.9205    0  488 32760.9227 58534.9205  78.7%     -  869s
     0     0 58516.8861    0  448 32760.9227 58516.8861  78.6%     -  878s
     0     0 58491.1547    0  454 32760.9227 58491.1547  78.5%     -  884s
     0     0 58486.7467    0  439 32760.9227 58486.7467  78.5%     -  888s
     0     0 58484.3924    0  443 32760.9227 58484.3924  78.5%     -  891s
     0     0 58259.3766    0  430 32760.9227 58259.3766  77.8%     -  918s
     0     0 58149.6360    0  448 32760.9227 58149.6360  77.5%     -  946s
     0     0 58113.9103    0  454 32760.9227 58113.9103  77.4%     -  963s
     0     0 58097.9452    0  452 32760.9227 58097.9452  77.3%     -  979s
     0     0 58087.4393    0  392 32760.9227 58087.4393  77.3%     -  989s
     0     0 58078.9016    0  455 32760.9227 58078.9016  77.3%     -  998s
     0     0 58072.9226    0  455 32760.9227 58072.9226  77.3%     - 1004s
     0     0 58067.0913    0  454 32760.9227 58067.0913  77.2%     - 1012s
     0     0 58037.2440    0  400 32760.9227 58037.2440  77.2%     - 1030s
     0     0 58019.6729    0  454 32760.9227 58019.6729  77.1%     - 1041s
     0     0 58012.3589    0  448 32760.9227 58012.3589  77.1%     - 1047s
     0     0 58010.9506    0  457 32760.9227 58010.9506  77.1%     - 1053s
H    0     0                    32805.782175 57859.8794  76.4%     - 1075s
     0     0 57859.8794    0  446 32805.7822 57859.8794  76.4%     - 1075s
     0     0 57770.7041    0  515 32805.7822 57770.7041  76.1%     - 1092s
H    0     0                    32917.519617 57746.5772  75.4%     - 1108s
H    0     0                    33064.191910 57746.5772  74.6%     - 1108s
H    0     0                    33827.353668 57746.5772  70.7%     - 1108s
     0     0 57746.5772    0  508 33827.3537 57746.5772  70.7%     - 1108s
     0     0 57738.5634    0  521 33827.3537 57738.5634  70.7%     - 1119s
     0     0 57729.3208    0  385 33827.3537 57729.3208  70.7%     - 1129s
     0     0 57722.4236    0  500 33827.3537 57722.4236  70.6%     - 1139s
     0     0 57715.7330    0  457 33827.3537 57715.7330  70.6%     - 1147s
     0     0 57714.9222    0  502 33827.3537 57714.9222  70.6%     - 1151s
     0     0 57644.4378    0  412 33827.3537 57644.4378  70.4%     - 1180s
H    0     0                    33983.893301 57643.5342  69.6%     - 1181s
     0     0 57617.9053    0  394 33983.8933 57617.9053  69.5%     - 1192s
     0     0 57608.6122    0  390 33983.8933 57608.6122  69.5%     - 1199s
     0     0 57604.7552    0  390 33983.8933 57604.7552  69.5%     - 1202s
     0     0 57601.1957    0  392 33983.8933 57601.1957  69.5%     - 1205s
     0     0 57595.8170    0  391 33983.8933 57595.8170  69.5%     - 1209s
     0     0 57594.1593    0  396 33983.8933 57594.1593  69.5%     - 1210s
     0     0 57574.2590    0  454 33983.8933 57574.2590  69.4%     - 1225s
     0     0 57566.9036    0  462 33983.8933 57566.9036  69.4%     - 1232s
     0     0 57559.3445    0  458 33983.8933 57559.3445  69.4%     - 1240s
     0     0 57556.0237    0  344 33983.8933 57556.0237  69.4%     - 1245s
     0     0 57554.9068    0  336 33983.8933 57554.9068  69.4%     - 1247s
     0     0 57541.6296    0  565 33983.8933 57541.6296  69.3%     - 1263s
H    0     0                    34047.248436 57541.4683  69.0%     - 1264s
     0     0 57520.9830    0  398 34047.2484 57520.9830  68.9%     - 1276s
     0     0 57518.0923    0  541 34047.2484 57518.0923  68.9%     - 1282s
     0     0 57503.7799    0  418 34047.2484 57503.7799  68.9%     - 1294s
H    0     0                    34088.624923 57503.7654  68.7%     - 1294s
H    0     0                    34110.486270 57503.7654  68.6%     - 1295s
     0     0 57501.5986    0  479 34110.4863 57501.5986  68.6%     - 1302s
     0     0 57490.1453    0  526 34110.4863 57490.1453  68.5%     - 1315s
     0     0 57486.5696    0  526 34110.4863 57486.5696  68.5%     - 1321s
     0     0 57484.5826    0  529 34110.4863 57484.5826  68.5%     - 1324s
     0     0 57472.6945    0  406 34110.4863 57472.6945  68.5%     - 1336s
     0     0 57472.6873    0  406 34110.4863 57472.6873  68.5%     - 1340s
H    0     0                    39370.073392 57472.6873  46.0%     - 1508s
H    0     0                    40224.691199 57472.6873  42.9%     - 1526s
H    0     0                    40669.256175 57472.6873  41.3%     - 1528s
     0     2 57472.6873    0  406 40669.2562 57472.6873  41.3%     - 1533s
     1     3 56784.5509    1  300 40669.2562 57472.5986  41.3% 20857 1570s
     2     4 56925.5766    1  382 40669.2562 56925.5766  40.0% 22771 1607s
     3     7 55808.1653    2  308 40669.2562 56925.4500  40.0% 19372 1636s
     6    13 55660.7062    3  304 40669.2562 56924.0058  40.0% 15485 1711s
    12    26 55949.3832    4  393 40669.2562 56786.9914  39.6% 17676 1746s
    25    39 54940.4818    5  373 40669.2562 56437.4332  38.8% 19761 1844s
    38    71 54524.1135    6  318 40669.2562 56437.4332  38.8% 25324 2049s
H   44    71                    41031.798750 56437.4332  37.5% 24013 2049s
    70   163 53741.0418    7  348 41031.7987 56176.0405  36.9% 26309 2148s
   162   194 53579.1159    9  336 41031.7987 56176.0405  36.9% 15457 2194s
   193   225 53122.6138   10  287 41031.7987 56176.0405  36.9% 14250 2241s
H  207   225                    41310.865939 56176.0405  36.0% 14056 2241s
   224   252 53087.5518   11  286 41310.8659 56176.0405  36.0% 13605 2289s
   251   284 51922.4292    7  262 41310.8659 56176.0405  36.0% 13694 2346s
   285   317 52105.3263   12  277 41310.8659 56176.0405  36.0% 13422 2399s
   318   354 51937.8349   13  339 41310.8659 56176.0405  36.0% 12972 2449s
H  330   354                    41361.487878 56176.0405  35.8% 12856 2449s
   357   428 51919.4470   14  272 41361.4879 56176.0405  35.8% 12955 2500s
   435   503 50719.3296   16  275 41361.4879 56176.0405  35.8% 12155 2550s
   516   585 49732.3450   12  234 41361.4879 56176.0405  35.8% 11826 2589s
   602   680 51609.4513   16  334 41361.4879 56176.0405  35.8% 11137 2629s
   701   761 51162.3421   18  330 41361.4879 56176.0405  35.8% 10458 2658s
   784   833 50984.0777   19  347 41361.4879 56176.0405  35.8% 10062 2690s
   871   911 50886.5741   20  357 41361.4879 56176.0405  35.8%  9730 2718s
   967   965 50712.6054   21  264 41361.4879 56176.0405  35.8%  9330 2750s
  1060  1014 50412.6736   22  344 41361.4879 56101.7799  35.6%  9116 2783s
  1155  1059 48673.9385   19  242 41361.4879 56054.8895  35.5%  9000 2813s
  1238  1086 49434.9369   23  238 41361.4879 56054.8895  35.5%  8938 2851s
  1319  1139 49329.6922   24  238 41361.4879 56054.8895  35.5%  8888 2891s
  1415  1157 48012.1769   22  188 41361.4879 56054.8895  35.5%  8834 2934s
  1449  1194 47014.6077   26  198 41361.4879 56054.8895  35.5%  8890 2973s
  1506  1224 44323.9345   28  192 41361.4879 56054.8895  35.5%  8930 3014s
  1558  1257 44089.1897   34  193 41361.4879 56054.8895  35.5%  8907 3057s
  1625  1305 42083.7502   40  178 41361.4879 56054.8895  35.5%  8881 3102s
  1715  1376     cutoff   42      41361.4879 56044.0955  35.5%  8903 3142s
  1839  1403 46003.8811   11  312 41361.4879 56044.0955  35.5%  8802 3184s
  1916  1447 45600.9884   12  268 41361.4879 56044.0955  35.5%  8762 3234s
H 1990  1447                    41537.419086 56044.0955  34.9%  8714 3234s
  2004  1469 45169.9274   13  250 41537.4191 56044.0955  34.9%  8748 3301s
  2064  1547 44525.3441   14  254 41537.4191 56044.0955  34.9%  8835 3347s
  2166  1650 43433.7687   18  256 41537.4191 56044.0955  34.9%  8817 3397s
  2307  1755 42823.2561   21  249 41537.4191 56044.0955  34.9%  8724 3459s
  2442  1862 41794.9343   25  234 41537.4191 56044.0955  34.9%  8729 3518s
  2588  1983     cutoff   38      41537.4191 55695.4389  34.1%  8721 3583s
  2761  1989 42702.5491   52  109 41537.4191 55694.8953  34.1%  8634 3600s

Cutting planes:
  Learned: 1
  Gomory: 10
  Implied bound: 95
  MIR: 3698
  Flow cover: 2793
  RLT: 88
  Relax-and-lift: 861

Explored 2787 nodes (24911890 simplex iterations) in 3600.09 seconds (5500.44 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41537.4 41361.5 41310.9 ... 34047.2

Time limit reached
Best objective 4.153741908561e+04, best bound 5.569489534785e+04, gap 34.0837%
  WARNING: Time limit reached. Using best solution found (gap: 34.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 41537.42, θ = 206724.91
  Upper Bound (UB) = 41537.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206724.91
  [DEBUG]   ✓ Scenario 0: θ = 206724.91 ≤ Q = 206724.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 206724.91 ≤ Q = 206724.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 206724.91 ≤ Q = 206724.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 206724.91 ≤ Q = 206724.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 206724.91 ≤ Q = 206724.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6e45f8eb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6e45f8eb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.376262e+13
Presolve removed 2598 rows and 1889 columns
Presolve time: 0.01s
Presolved: 495 rows, 500 columns, 1399 nonzeros
Found heuristic solution: objective 6187750.5894
Variable types: 340 continuous, 160 integer (160 binary)

Root relaxation: objective -1.936471e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -193647.14    0  125 6187750.59 -193647.14   103%     -    0s
H    0     0                    -159601.6545 -193647.14  21.3%     -    0s
H    0     0                    -160694.7746 -193647.14  20.5%     -    0s
     0     0 -169620.50    0   54 -160694.77 -169620.50  5.55%     -    0s
H    0     0                    -166059.2538 -169526.87  2.09%     -    0s
     0     0 -168066.56    0   55 -166059.25 -168066.56  1.21%     -    0s
H    0     0                    -166864.6641 -168038.69  0.70%     -    0s
     0     0 -168038.69    0   55 -166864.66 -168038.69  0.70%     -    0s
     0     0 -167659.05    0   46 -166864.66 -167659.05  0.48%     -    0s
     0     0 -167533.18    0   44 -166864.66 -167533.18  0.40%     -    0s
     0     0 -167330.94    0   30 -166864.66 -167330.94  0.28%     -    0s
     0     0 -167275.08    0   28 -166864.66 -167275.08  0.25%     -    0s
     0     0 -167274.73    0   28 -166864.66 -167274.73  0.25%     -    0s
     0     0 -167247.91    0   11 -166864.66 -167247.91  0.23%     -    0s
     0     0 -167228.11    0   11 -166864.66 -167228.11  0.22%     -    0s
     0     0 -167203.52    0   11 -166864.66 -167203.52  0.20%     -    0s
     0     0 -167202.12    0   11 -166864.66 -167202.12  0.20%     -    0s
H    0     0                    -166971.3102 -167202.12  0.14%     -    0s
H    0     0                    -167012.8632 -167202.12  0.11%     -    0s
     0     0 -167202.12    0   64 -167012.86 -167202.12  0.11%     -    0s
     0     0 -167193.25    0   14 -167012.86 -167193.25  0.11%     -    0s
H    0     0                    -167056.7092 -167153.69  0.06%     -    0s
     0     0 -167153.69    0   10 -167056.71 -167153.69  0.06%     -    0s
*    0     0               0    -167073.6965 -167073.70  0.00%     -    0s

Cutting planes:
  Gomory: 23
  Implied bound: 17
  MIR: 38
  Flow cover: 6
  RLT: 2
  BQP: 1

Explored 1 nodes (870 simplex iterations) in 0.18 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -167074 -167057 -167013 ... 1.37626e+13
No other solutions better than -167074

Optimal solution found (tolerance 1.00e-06)
Best objective -1.670736965149e+05, best bound -1.670736965149e+05, gap 0.0000%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 201973.28
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -167073.70
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -167073.70 = 201973.28
  [DEBUG]   Current θ from Master = 206724.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4751.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 36785.79
  Lower Bound (LB) = 38960.40
  Gap (UB-LB) = 2577.0173, Absolute Gap = 2577.0173, Relative Gap = 0.062041
  Not converged yet (gap = 2577.02 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0xbf86fb83
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns (presolve time = 5s)...
Presolve removed 106050 rows and 43050 columns
Presolve time: 5.18s
Presolved: 124683 rows, 52810 columns, 767270 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -179585.9549

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.49s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 5.526e+06
 Factor NZ  : 1.225e+07 (roughly 170 MB of memory)
 Factor Ops : 2.568e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.90515472e+07  2.55812867e+08  2.38e+05 2.00e+01  1.42e+05     9s
   1  -2.29522624e+07  2.55665897e+08  1.72e+05 1.23e+02  1.02e+05     9s
   2  -1.33867223e+07  2.14384687e+08  9.66e+04 4.04e+01  5.91e+04     9s
   3  -2.19914594e+06  1.60076438e+08  1.25e+04 3.30e+00  8.35e+03     9s
   4  -7.10908759e+05  9.04765555e+07  1.04e+03 4.17e-01  9.97e+02     9s
   5  -6.25248012e+05  5.12456683e+07  5.25e+02 1.81e-01  4.99e+02     9s
   6  -5.29894065e+05  3.32772911e+07  1.66e+02 1.01e-01  2.27e+02     9s
   7  -4.07492613e+05  2.30771894e+07  3.72e+01 6.61e-02  1.19e+02     9s
   8  -2.56757355e+05  1.41157846e+07  4.00e+00 3.93e-02  6.43e+01     9s
   9  -1.53753947e+05  7.14301333e+06  1.95e+00 1.94e-02  3.23e+01     9s
  10  -1.27960930e+05  4.18815036e+06  1.26e+00 1.14e-02  1.91e+01    10s
  11  -1.00293733e+05  2.65973876e+06  6.99e-01 7.15e-03  1.22e+01    10s
  12  -6.11645076e+04  1.02959281e+06  3.12e-01 2.84e-03  4.79e+00    10s
  13  -2.82641980e+04  4.10785726e+05  1.50e-01 1.18e-03  1.93e+00    10s
  14   8.90970321e+03  2.56162316e+05  7.15e-02 1.97e-03  1.09e+00    10s
  15   1.92284943e+04  1.90215668e+05  5.67e-02 3.46e-03  7.51e-01    10s
  16   3.08388228e+04  1.58898522e+05  4.36e-02 2.18e-03  5.62e-01    10s
  17   4.23000806e+04  1.24007690e+05  3.06e-02 1.39e-03  3.59e-01    10s
  18   4.49132499e+04  1.17844568e+05  2.77e-02 1.23e-03  3.20e-01    10s
  19   5.12336618e+04  1.00371271e+05  2.10e-02 7.45e-04  2.16e-01    10s
  20   5.55870998e+04  9.65674510e+04  1.66e-02 6.36e-04  1.80e-01    11s
  21   5.76194924e+04  9.33188940e+04  1.47e-02 5.42e-04  1.57e-01    11s
  22   6.42617947e+04  8.92665680e+04  8.38e-03 5.10e-04  1.10e-01    11s
  23   6.66409232e+04  8.59484626e+04  6.29e-03 4.02e-04  8.48e-02    11s
  24   6.90022158e+04  8.10268641e+04  4.32e-03 2.14e-04  5.28e-02    11s
  25   7.05561538e+04  7.96580720e+04  3.12e-03 1.65e-04  4.00e-02    11s
  26   7.14286700e+04  7.84473851e+04  2.48e-03 1.21e-04  3.08e-02    11s
  27   7.21775461e+04  7.72699055e+04  1.94e-03 7.69e-05  2.24e-02    11s
  28   7.30741701e+04  7.67303981e+04  1.32e-03 5.68e-05  1.61e-02    12s
  29   7.34181034e+04  7.62547801e+04  1.09e-03 3.96e-05  1.25e-02    12s
  30   7.37354821e+04  7.57808960e+04  8.71e-04 2.25e-05  8.98e-03    12s
  31   7.41979599e+04  7.56153949e+04  5.70e-04 1.67e-05  6.22e-03    12s
  32   7.44752786e+04  7.54891155e+04  3.92e-04 1.23e-05  4.45e-03    12s
  33   7.47568214e+04  7.53437192e+04  2.13e-04 7.26e-06  2.58e-03    12s
  34   7.48265422e+04  7.52939695e+04  1.71e-04 5.55e-06  2.05e-03    12s
  35   7.49090667e+04  7.52648741e+04  1.21e-04 4.57e-06  1.56e-03    13s
  36   7.49841601e+04  7.52167169e+04  7.69e-05 2.95e-06  1.02e-03    13s
  37   7.50012536e+04  7.51843402e+04  6.70e-05 1.92e-06  8.04e-04    13s
  38   7.50159299e+04  7.51824565e+04  5.91e-05 1.86e-06  7.31e-04    13s
  39   7.51010882e+04  7.51415083e+04  1.08e-05 5.28e-07  1.77e-04    13s
  40   7.51209155e+04  7.51269826e+04  1.15e-06 1.89e-07  2.66e-05    13s
  41   7.51235316e+04  7.51240034e+04  9.46e-08 2.00e-07  2.07e-06    13s
  42   7.51238111e+04  7.51238133e+04  1.68e-09 1.37e-10  9.91e-09    13s
  43   7.51238127e+04  7.51238128e+04  3.22e-08 1.73e-09  2.50e-10    14s

Barrier solved model in 43 iterations and 13.60 seconds (11.79 work units)
Optimal objective 7.51238127e+04


Root crossover log...

  111570 DPushes remaining with DInf 0.0000000e+00                14s
   26282 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    2582 PPushes remaining with PInf 2.8648985e-05                17s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4565673e+00     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   50710    7.5123813e+04   0.000000e+00   1.456567e+00     18s
   50724    7.5123813e+04   0.000000e+00   0.000000e+00     18s
   50724    7.5123813e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 0.03s

Solved with barrier

Root relaxation: objective 7.512381e+04, 50724 iterations, 11.82 seconds (13.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 75123.8128    0  145 -179585.95 75123.8128   142%     -   18s
H    0     0                    -160888.6297 75123.8128   147%     -   19s
H    0     0                    -154377.3519 75123.8128   149%     -   20s
H    0     0                    -152955.5952 75123.8128   149%     -   20s
H    0     0                    -73506.57173 75123.8128   202%     -   20s
H    0     0                    -73337.43955 75123.8128   202%     -   21s
H    0     0                    -14133.25891 75123.8128   632%     -   21s
H    0     0                    -10532.98622 75123.8128   813%     -   21s
H    0     0                    12734.859252 75123.8128   490%     -   21s
H    0     0                    27355.591312 75123.8128   175%     -   22s
H    0     0                    28232.821149 69058.7115   145%     -   58s
H    0     0                    28413.116311 69058.7115   143%     -   58s
     0     0 69058.7115    0  104 28413.1163 69058.7115   143%     -   58s
     0     0 69043.0762    0  104 28413.1163 69043.0762   143%     -   62s
     0     0 69033.6376    0  104 28413.1163 69033.6376   143%     -   68s
     0     0 68967.9031    0  105 28413.1163 68967.9031   143%     -   73s
     0     0 68904.7057    0  115 28413.1163 68904.7057   143%     -   83s
     0     0 68869.2657    0  115 28413.1163 68869.2657   142%     -   86s
     0     0 68868.7671    0  115 28413.1163 68868.7671   142%     -   87s
H    0     0                    30475.993929 64869.9583   113%     -  150s
     0     0 64869.9583    0  267 30475.9939 64869.9583   113%     -  150s
H    0     0                    31583.305934 64869.7448   105%     -  151s
H    0     0                    31743.689127 64869.7448   104%     -  152s
     0     0 64428.9982    0  267 31743.6891 64428.9982   103%     -  181s
     0     0 64315.6557    0  268 31743.6891 64315.6557   103%     -  195s
     0     0 64273.5570    0  283 31743.6891 64273.5570   102%     -  204s
     0     0 64259.5952    0  281 31743.6891 64259.5952   102%     -  210s
     0     0 64250.9052    0  280 31743.6891 64250.9052   102%     -  213s
     0     0 64249.5300    0  280 31743.6891 64249.5300   102%     -  214s
     0     0 64249.3943    0  280 31743.6891 64249.3943   102%     -  215s
H    0     0                    31967.687292 61438.2003  92.2%     -  305s
H    0     0                    32899.500073 61438.2003  86.7%     -  305s
H    0     0                    33397.675230 61438.2003  84.0%     -  305s
H    0     0                    33458.694510 61438.2003  83.6%     -  305s
     0     0 61438.2003    0  345 33458.6945 61438.2003  83.6%     -  306s
     0     0 60937.7067    0  362 33458.6945 60937.7067  82.1%     -  337s
     0     0 60807.2832    0  367 33458.6945 60807.2832  81.7%     -  367s
     0     0 60579.4754    0  362 33458.6945 60579.4754  81.1%     -  387s
     0     0 60407.8524    0  354 33458.6945 60407.8524  80.5%     -  407s
     0     0 60379.0560    0  367 33458.6945 60379.0560  80.5%     -  416s
     0     0 60317.4087    0  365 33458.6945 60317.4087  80.3%     -  425s
     0     0 60299.0999    0  354 33458.6945 60299.0999  80.2%     -  430s
     0     0 60292.1750    0  360 33458.6945 60292.1750  80.2%     -  432s
     0     0 60290.8105    0  364 33458.6945 60290.8105  80.2%     -  434s
     0     0 59208.4032    0  357 33458.6945 59208.4032  77.0%     -  482s
H    0     0                    35752.691043 59208.3836  65.6%     -  483s
H    0     0                    35882.167730 59208.3836  65.0%     -  483s
H    0     0                    35889.580087 59208.3836  65.0%     -  483s
H    0     0                    35921.860091 59208.3836  64.8%     -  483s
H    0     0                    35948.127122 59208.3836  64.7%     -  483s
H    0     0                    36076.954349 59208.3836  64.1%     -  483s
H    0     0                    36093.744216 59208.3836  64.0%     -  483s
     0     0 58973.5626    0  372 36093.7442 58973.5626  63.4%     -  510s
     0     0 58782.7731    0  382 36093.7442 58782.7731  62.9%     -  527s
     0     0 58732.6263    0  378 36093.7442 58732.6263  62.7%     -  539s
     0     0 58705.1755    0  384 36093.7442 58705.1755  62.6%     -  546s
     0     0 58675.7902    0  394 36093.7442 58675.7902  62.6%     -  554s
     0     0 58583.5890    0  371 36093.7442 58583.5890  62.3%     -  562s
     0     0 58538.8971    0  380 36093.7442 58538.8971  62.2%     -  570s
     0     0 58511.6315    0  385 36093.7442 58511.6315  62.1%     -  578s
     0     0 58498.1774    0  378 36093.7442 58498.1774  62.1%     -  583s
     0     0 58492.0057    0  388 36093.7442 58492.0057  62.1%     -  586s
     0     0 58489.4141    0  392 36093.7442 58489.4141  62.0%     -  588s
     0     0 58472.3575    0  380 36093.7442 58472.3575  62.0%     -  593s
     0     0 58467.0821    0  387 36093.7442 58467.0821  62.0%     -  594s
     0     0 58465.8879    0  389 36093.7442 58465.8879  62.0%     -  596s
     0     0 58137.5179    0  398 36093.7442 58137.5179  61.1%     -  620s
H    0     0                    36099.974679 58136.6918  61.0%     -  621s
     0     0 58055.5430    0  395 36099.9747 58055.5430  60.8%     -  632s
     0     0 58028.0483    0  397 36099.9747 58028.0483  60.7%     -  639s
     0     0 58012.1508    0  407 36099.9747 58012.1508  60.7%     -  646s
     0     0 58009.4212    0  408 36099.9747 58009.4212  60.7%     -  649s
     0     0 58008.1271    0  407 36099.9747 58008.1271  60.7%     -  651s
     0     0 57860.6688    0  386 36099.9747 57860.6688  60.3%     -  673s
     0     0 57833.0172    0  426 36099.9747 57833.0172  60.2%     -  685s
     0     0 57798.7549    0  381 36099.9747 57798.7549  60.1%     -  693s
     0     0 57790.6655    0  419 36099.9747 57790.6655  60.1%     -  697s
     0     0 57786.7403    0  422 36099.9747 57786.7403  60.1%     -  701s
     0     0 57782.1878    0  425 36099.9747 57782.1878  60.1%     -  706s
     0     0 57770.3014    0  440 36099.9747 57770.3014  60.0%     -  712s
     0     0 57767.6943    0  439 36099.9747 57767.6943  60.0%     -  715s
     0     0 57766.3304    0  435 36099.9747 57766.3304  60.0%     -  717s
     0     0 57703.5986    0  384 36099.9747 57703.5986  59.8%     -  730s
     0     0 57690.2272    0  389 36099.9747 57690.2272  59.8%     -  736s
     0     0 57685.0135    0  405 36099.9747 57685.0135  59.8%     -  740s
     0     0 57679.7415    0  396 36099.9747 57679.7415  59.8%     -  746s
     0     0 57678.2669    0  392 36099.9747 57678.2669  59.8%     -  748s
H    0     0                    36297.158900 57649.3804  58.8%     -  759s
H    0     0                    36383.295378 57649.3804  58.5%     -  759s
     0     0 57649.3804    0  397 36383.2954 57649.3804  58.5%     -  759s
     0     0 57633.8403    0  398 36383.2954 57633.8403  58.4%     -  767s
     0     0 57632.5580    0  401 36383.2954 57632.5580  58.4%     -  770s
     0     0 57618.1678    0  396 36383.2954 57618.1678  58.4%     -  778s
     0     0 57605.4868    0  398 36383.2954 57605.4868  58.3%     -  787s
     0     0 57601.6735    0  400 36383.2954 57601.6735  58.3%     -  794s
     0     0 57599.8549    0  485 36383.2954 57599.8549  58.3%     -  799s
     0     0 57574.7963    0  403 36383.2954 57574.7963  58.2%     -  810s
H    0     0                    36417.373031 57574.7201  58.1%     -  811s
     0     0 57569.2574    0  351 36417.3730 57569.2574  58.1%     -  815s
     0     0 57567.1600    0  391 36417.3730 57567.1600  58.1%     -  818s
     0     0 57523.4924    0  408 36417.3730 57523.4924  58.0%     -  827s
     0     0 57508.2826    0  479 36417.3730 57508.2826  57.9%     -  838s
     0     0 57503.4106    0  476 36417.3730 57503.4106  57.9%     -  842s
     0     0 57500.9646    0  472 36417.3730 57500.9646  57.9%     -  844s
     0     0 57499.2885    0  447 36417.3730 57499.2885  57.9%     -  846s
     0     0 57495.4812    0  421 36417.3730 57495.4812  57.9%     -  851s
     0     0 57494.2084    0  421 36417.3730 57494.2084  57.9%     -  854s
     0     0 57491.6331    0  413 36417.3730 57491.6331  57.9%     -  858s
     0     0 57488.8546    0  366 36417.3730 57488.8546  57.9%     -  863s
     0     0 57488.4836    0  365 36417.3730 57488.4836  57.9%     -  864s
     0     0 57486.8642    0  496 36417.3730 57486.8642  57.9%     -  870s
     0     0 57486.4650    0  499 36417.3730 57486.4650  57.9%     -  874s
     0     0 57484.9654    0  416 36417.3730 57484.9654  57.9%     -  877s
     0     0 57483.2381    0  416 36417.3730 57483.2381  57.8%     -  882s
H    0     0                    38269.075047 57483.2381  50.2%     - 1053s
H    0     0                    38328.692602 57483.2381  50.0%     - 1053s
H    0     0                    38456.944078 57483.2381  49.5%     - 1053s
H    0     0                    39072.189039 57483.2381  47.1%     - 1053s
H    0     0                    39517.245622 57483.2381  45.5%     - 1056s
H    0     0                    39611.804380 57483.2381  45.1%     - 1056s
     0     2 57483.2381    0  416 39611.8044 57483.2381  45.1%     - 1062s
     1     3 56845.1634    1  282 39611.8044 57483.0751  45.1% 12126 1086s
     2     5 56387.0037    2  345 39611.8044 57483.0751  45.1% 12348 1108s
     4    10 56491.4752    2  384 39611.8044 57325.5724  44.7% 10758 1143s
     9    20 56222.4279    3  342 39611.8044 57117.8814  44.2% 11436 1213s
    19    40 56152.2815    4  393 39611.8044 57009.9355  43.9% 14015 1250s
    39    52 55124.4652    5  320 39611.8044 56952.4500  43.8% 17713 1334s
    51    74 55230.1112    6  293 39611.8044 56952.4500  43.8% 19740 1406s
    73   166 55115.0516    7  321 39611.8044 56952.4500  43.8% 17509 1513s
H  165   211                    39721.765395 56952.4500  43.4% 12269 1555s
H  169   211                    39766.617568 56952.4500  43.2% 12122 1555s
H  174   211                    40542.572070 56952.4500  40.5% 11924 1555s
H  176   211                    40907.543397 56952.4500  39.2% 11834 1555s
H  181   211                    41047.340709 56952.4500  38.7% 11693 1555s
   210   293 54741.8937   10  348 41047.3407 56952.4500  38.7% 10871 1607s
   292   322 54517.4162   12  338 41047.3407 56952.4500  38.7%  9132 1645s
   321   359 54472.2700   13  332 41047.3407 56952.4500  38.7%  8840 1680s
H  347   359                    41099.060387 56952.4500  38.6%  8472 1680s
   358   389 54404.7323   14  332 41099.0604 56952.4500  38.6%  8420 1723s
   388   428 54206.5337   15  324 41099.0604 56952.4500  38.6%  8280 1770s
   433   473 52691.3366   20  351 41099.0604 56952.4500  38.6%  8102 1808s
   478   517 54167.9570   16  319 41099.0604 56952.4500  38.6%  8074 1845s
   522   561 53638.0632   17  271 41099.0604 56952.4500  38.6%  7846 1884s
   566   615 53616.8703   18  268 41099.0604 56952.4500  38.6%  7644 1916s
   620   664 53110.4761   19  254 41099.0604 56952.4500  38.6%  7514 1948s
   669   717 52487.7718   20  247 41099.0604 56952.4500  38.6%  7501 1976s
   722   763 52337.4893   21  242 41099.0604 56952.4500  38.6%  7519 2007s
   770   810 52208.0432   22  247 41099.0604 56952.4500  38.6%  7567 2034s
   817   867 51759.1117   23  239 41099.0604 56952.4500  38.6%  7552 2063s
   876   915 51677.5440   24  239 41099.0604 56952.4500  38.6%  7468 2092s
H  878   915                    41353.191600 56952.4500  37.7%  7461 2092s
   940   940 51323.0289   25  296 41353.1916 56952.4500  37.7%  7405 2258s
   989  1001 48768.9879   26  289 41353.1916 56952.4500  37.7%  7371 2297s
  1064  1095 48749.1404   27  283 41353.1916 56952.4500  37.7%  7430 2335s
  1172  1123 48198.3249   30  262 41353.1916 56952.4500  37.7%  7420 2372s
  1206  1158 47636.9754   31  244 41353.1916 56952.4500  37.7%  7497 2410s
H 1247  1158                    41362.145691 56952.4500  37.7%  7482 2410s
  1251  1280 47611.2055   32  244 41362.1457 56952.4500  37.7%  7492 2446s
  1395  1386 46576.4746   36  250 41362.1457 56952.4500  37.7%  7263 2487s
  1561  1447 45984.7767   41  218 41362.1457 56952.4500  37.7%  6896 2532s
  1676  1547 44388.1506   48  182 41362.1457 56952.4500  37.7%  6862 2576s
  1797  1650 44146.8209   52  172 41362.1457 56952.4500  37.7%  6862 2624s
  1930  1724 43391.1135   57  214 41362.1457 56952.4500  37.7%  6867 2672s
  2063  1801 42999.6583   63  149 41362.1457 56952.4500  37.7%  6901 2721s
  2197  1876 infeasible   65      41362.1457 56952.4500  37.7%  6945 2772s
  2334  1929     cutoff   25      41362.1457 56388.6265  36.3%  6922 2825s
H 2416  1878                    41905.709742 56388.5948  34.6%  6969 2825s
  2429  1960 55811.5582    6  338 41905.7097 56388.5948  34.6%  7009 2875s
  2582  2024 54503.1097    6  301 41905.7097 55811.5015  33.2%  7017 2932s
  2720  2113 54245.6915    7  372 41905.7097 55810.8958  33.2%  7099 2996s
  2851  2226 53998.5673    8  377 41905.7097 55121.7523  31.5%  7160 3052s
  3009  2353 53629.9366   10  344 41905.7097 55121.7523  31.5%  7184 3114s
  3192  2429 52409.5146   12  319 41905.7097 55074.8047  31.4%  7178 3185s
  3342  2548 51851.7557   12  306 41905.7097 55002.7602  31.3%  7238 3257s
  3525  2576 51695.8049   13  304 41905.7097 55002.7602  31.3%  7267 3312s
  3563  2634 51619.9076   14  292 41905.7097 54891.4082  31.0%  7334 3364s
  3665  2686 50947.8260   15  270 41905.7097 54891.4082  31.0%  7334 3436s
  3831  2754 51395.2345   13  292 41905.7097 54808.1398  30.8%  7354 3515s
  3972  2779 46576.1074   18  206 41905.7097 54808.1398  30.8%  7497 3588s
H 4015  2775                    41947.480856 54808.1398  30.7%  7504 3588s
  4065  2784 48959.6707   19  156 41947.4809 54808.1398  30.7%  7544 3600s

Cutting planes:
  Implied bound: 129
  MIR: 2867
  Flow cover: 3114
  RLT: 25
  Relax-and-lift: 333

Explored 4086 nodes (31358573 simplex iterations) in 3600.09 seconds (5726.13 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41947.5 41905.7 41362.1 ... 39721.8

Time limit reached
Best objective 4.194748085597e+04, best bound 5.480813976648e+04, gap 30.6590%
  WARNING: Time limit reached. Using best solution found (gap: 30.66%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 41947.48, θ = 205639.40
  Upper Bound (UB) = 41947.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205639.40
  [DEBUG]   ✓ Scenario 0: θ = 205639.40 ≤ Q = 205639.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205639.40 ≤ Q = 205639.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205639.40 ≤ Q = 205639.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 205639.40 ≤ Q = 205639.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 205639.40 ≤ Q = 205639.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x24145b8f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x24145b8f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-15, 2e+02]
Found heuristic solution: objective 1.382642e+13
Presolve removed 2597 rows and 1888 columns
Presolve time: 0.01s
Presolved: 496 rows, 501 columns, 1399 nonzeros
Found heuristic solution: objective 6177056.3739
Variable types: 341 continuous, 160 integer (160 binary)

Root relaxation: objective -1.946819e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194681.87    0  125 6177056.37 -194681.87   103%     -    0s
H    0     0                    -160708.6275 -194681.87  21.1%     -    0s
H    0     0                    -161621.8507 -194681.87  20.5%     -    0s
     0     0 -169395.23    0  106 -161621.85 -169395.23  4.81%     -    0s
H    0     0                    -164363.3109 -169276.38  2.99%     -    0s
H    0     0                    -164687.6514 -169276.38  2.79%     -    0s
     0     0 -166731.70    0  115 -164687.65 -166731.70  1.24%     -    0s
     0     0 -166714.52    0  115 -164687.65 -166714.52  1.23%     -    0s
     0     0 -166374.03    0  111 -164687.65 -166374.03  1.02%     -    0s
     0     0 -166303.17    0  111 -164687.65 -166303.17  0.98%     -    0s
     0     0 -166156.88    0  110 -164687.65 -166156.88  0.89%     -    0s
     0     0 -166154.09    0  110 -164687.65 -166154.09  0.89%     -    0s
H    0     0                    -164922.1674 -166146.00  0.74%     -    0s
     0     2 -166146.00    0  110 -164922.17 -166146.00  0.74%     -    0s
H   33    60                    -165129.8809 -165991.18  0.52%  20.3    0s
H  100   215                    -165135.5697 -165800.55  0.40%  18.1    0s
H  115   215                    -165184.6694 -165800.55  0.37%  16.7    0s
H  120   215                    -165198.8666 -165800.55  0.36%  16.3    0s
H  130   215                    -165217.2994 -165800.55  0.35%  15.5    0s
H  250   215                    -165261.6820 -165791.19  0.32%  11.9    0s
H  392   277                    -165414.4840 -165791.19  0.23%   9.8    0s
H  394   277                    -165439.9144 -165791.19  0.21%   9.8    0s

Cutting planes:
  Gomory: 49
  Implied bound: 2
  MIR: 211
  Flow cover: 5
  RLT: 4

Explored 1167 nodes (8076 simplex iterations) in 0.26 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -165440 -165414 -165262 ... -164688
No other solutions better than -165440

Optimal solution found (tolerance 1.00e-06)
Best objective -1.654399143747e+05, best bound -1.654399143747e+05, gap 0.0000%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 203607.06
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -165439.91
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -165439.91 = 203607.06
  [DEBUG]   Current θ from Master = 205639.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2032.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 39915.15
  Lower Bound (LB) = 39915.15
  Gap (UB-LB) = 2032.3358, Absolute Gap = 2032.3358, Relative Gap = 0.048450
  Not converged yet (gap = 2032.34 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0xc75afb87
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 4.95s
Presolved: 132903 rows, 56180 columns, 817884 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -179585.9549

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.69s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 6.196e+06
 Factor NZ  : 1.379e+07 (roughly 200 MB of memory)
 Factor Ops : 3.025e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.06233944e+07  2.70880635e+08  2.52e+05 1.92e+01  1.48e+05     9s
   1  -2.42896028e+07  3.01029078e+08  1.82e+05 1.11e+02  1.10e+05     9s
   2  -9.72252978e+06  2.16936365e+08  7.03e+04 1.55e+01  4.46e+04     9s
   3  -1.88546922e+06  1.69761107e+08  9.09e+03 3.86e+00  6.31e+03     9s
   4  -7.86293188e+05  1.04973526e+08  1.16e+03 6.88e-01  1.10e+03     9s
   5  -6.91858823e+05  5.72229814e+07  5.75e+02 3.21e-01  5.32e+02    10s
   6  -6.11256201e+05  3.88618977e+07  2.11e+02 1.91e-01  2.63e+02    10s
   7  -5.46727643e+05  2.87302815e+07  6.70e+01 1.34e-01  1.49e+02    10s
   8  -4.09912112e+05  1.88492801e+07  1.17e+01 8.35e-02  8.33e+01    10s
   9  -2.87939563e+05  9.38498271e+06  3.80e+00 3.99e-02  4.06e+01    10s
  10  -1.88960067e+05  5.89923015e+06  1.91e+00 2.47e-02  2.53e+01    10s
  11  -1.42494726e+05  4.34052597e+06  1.16e+00 1.79e-02  1.86e+01    10s
  12  -1.08578447e+05  2.45473509e+06  7.04e-01 1.02e-02  1.06e+01    10s
  13  -6.65362940e+04  1.07825256e+06  3.31e-01 4.29e-03  4.72e+00    10s
  14  -2.46272479e+04  4.08930555e+05  1.56e-01 1.38e-03  1.79e+00    11s
  15   8.54598877e+03  2.74904025e+05  8.09e-02 1.07e-03  1.10e+00    11s
  16   2.93921502e+04  1.89974000e+05  5.04e-02 2.34e-03  6.62e-01    11s
  17   3.38393028e+04  1.63026854e+05  4.35e-02 1.82e-03  5.33e-01    11s
  18   4.39772604e+04  1.30374330e+05  3.04e-02 1.17e-03  3.56e-01    11s
  19   5.21086505e+04  1.13278973e+05  2.07e-02 8.28e-04  2.52e-01    11s
  20   5.50654221e+04  1.02070360e+05  1.75e-02 5.91e-04  1.94e-01    12s
  21   5.90001720e+04  9.29288783e+04  1.36e-02 4.03e-04  1.40e-01    12s
  22   6.42179215e+04  8.75063277e+04  8.73e-03 2.77e-04  9.60e-02    12s
  23   6.69269321e+04  8.28789296e+04  6.36e-03 3.02e-04  6.58e-02    12s
  24   6.86934482e+04  7.99246042e+04  4.88e-03 1.93e-04  4.63e-02    12s
  25   7.00388954e+04  7.83549078e+04  3.81e-03 1.28e-04  3.43e-02    12s
  26   7.14094120e+04  7.74169450e+04  2.73e-03 8.34e-05  2.48e-02    13s
  27   7.22666234e+04  7.61727177e+04  2.06e-03 4.25e-05  1.61e-02    13s
  28   7.29314761e+04  7.59683926e+04  1.56e-03 3.41e-05  1.25e-02    13s
  29   7.33016579e+04  7.56584164e+04  1.28e-03 3.35e-05  9.72e-03    13s
  30   7.34425999e+04  7.55472445e+04  1.18e-03 2.69e-05  8.68e-03    13s
  31   7.37531451e+04  7.54414238e+04  9.48e-04 2.03e-05  6.96e-03    13s
  32   7.39282302e+04  7.53438972e+04  8.24e-04 1.42e-05  5.84e-03    14s
  33   7.44356613e+04  7.52475883e+04  4.50e-04 7.96e-06  3.35e-03    14s
  34   7.45942076e+04  7.52099054e+04  3.42e-04 5.94e-06  2.54e-03    14s
  35   7.47016390e+04  7.51652410e+04  2.63e-04 3.62e-06  1.91e-03    14s
  36   7.47510115e+04  7.51522959e+04  2.29e-04 2.96e-06  1.66e-03    14s
  37   7.48080963e+04  7.51450188e+04  1.89e-04 2.68e-06  1.39e-03    15s
  38   7.49025194e+04  7.51275514e+04  1.24e-04 1.73e-06  9.28e-04    15s
  39   7.50079023e+04  7.51139627e+04  5.08e-05 1.05e-06  4.37e-04    15s
  40   7.50160300e+04  7.51077149e+04  4.56e-05 7.99e-07  3.78e-04    15s
  41   7.50498758e+04  7.50989563e+04  2.34e-05 4.09e-07  2.02e-04    15s
  42   7.50844599e+04  7.50923246e+04  2.11e-06 2.84e-07  3.24e-05    15s
  43   7.50878519e+04  7.50898060e+04  3.06e-07 7.78e-08  8.05e-06    16s
  44   7.50884899e+04  7.50885819e+04  2.34e-08 1.31e-09  3.80e-07    16s
  45   7.50885342e+04  7.50885342e+04  1.67e-09 1.82e-10  1.48e-10    16s

Barrier solved model in 45 iterations and 15.95 seconds (13.57 work units)
Optimal objective 7.50885342e+04


Root crossover log...

  118991 DPushes remaining with DInf 0.0000000e+00                16s
    1943 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    1733 PPushes remaining with PInf 1.0945652e-05                21s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9497866e-10     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53199    7.5088534e+04   0.000000e+00   0.000000e+00     21s
   53199    7.5088534e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 7.508853e+04, 53199 iterations, 15.15 seconds (16.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 75088.5342    0  153 -179585.95 75088.5342   142%     -   22s
H    0     0                    -152357.4662 75088.5342   149%     -   23s
H    0     0                    -127933.7884 75088.5342   159%     -   23s
H    0     0                    -127443.3812 75088.5342   159%     -   24s
H    0     0                    -78199.79734 75088.5342   196%     -   24s
H    0     0                    -78030.66516 75088.5342   196%     -   25s
H    0     0                    14737.123437 75088.5342   410%     -   25s
H    0     0                    27524.214685 75088.5342   173%     -   27s
H    0     0                    27632.008263 75088.5342   172%     -   27s
H    0     0                    27889.444703 75088.5342   169%     -   27s
H    0     0                    28248.268519 75088.5342   166%     -   27s
H    0     0                    28459.397330 75088.5342   164%     -   27s
     0     0 68936.8624    0  177 28459.3973 68936.8624   142%     -  116s
H    0     0                    28771.118422 68936.8525   140%     -  117s
     0     0 68571.4652    0  183 28771.1184 68571.4652   138%     -  158s
     0     0 68547.0615    0  175 28771.1184 68547.0615   138%     -  164s
     0     0 68542.8729    0  175 28771.1184 68542.8729   138%     -  164s
     0     0 68522.3031    0  184 28771.1184 68522.3031   138%     -  169s
     0     0 68520.9798    0  190 28771.1184 68520.9798   138%     -  170s
     0     0 68520.8707    0  185 28771.1184 68520.8707   138%     -  171s
     0     0 66105.5863    0  291 28771.1184 66105.5863   130%     -  259s
H    0     0                    30287.252941 66105.5235   118%     -  260s
H    0     0                    30667.748488 66105.5235   116%     -  260s
H    0     0                    31081.682065 66105.5235   113%     -  260s
H    0     0                    31250.991505 66105.5235   112%     -  260s
     0     0 65463.7032    0  289 31250.9915 65463.7032   109%     -  315s
     0     0 65140.1290    0  298 31250.9915 65140.1290   108%     -  346s
     0     0 64868.3851    0  310 31250.9915 64868.3851   108%     -  375s
     0     0 64812.1924    0  306 31250.9915 64812.1924   107%     -  385s
     0     0 64747.9447    0  301 31250.9915 64747.9447   107%     -  400s
     0     0 64736.5175    0  306 31250.9915 64736.5175   107%     -  405s
     0     0 64702.1322    0  304 31250.9915 64702.1322   107%     -  416s
     0     0 64686.4644    0  304 31250.9915 64686.4644   107%     -  422s
     0     0 64676.2372    0  311 31250.9915 64676.2372   107%     -  428s
     0     0 64670.8009    0  313 31250.9915 64670.8009   107%     -  430s
     0     0 64663.7860    0  311 31250.9915 64663.7860   107%     -  434s
     0     0 64657.0683    0  309 31250.9915 64657.0683   107%     -  437s
     0     0 64650.8329    0  306 31250.9915 64650.8329   107%     -  439s
     0     0 64650.0515    0  306 31250.9915 64650.0515   107%     -  440s
     0     0 61519.6901    0  342 31250.9915 61519.6901  96.9%     -  564s
H    0     0                    33503.826068 61519.5018  83.6%     -  565s
     0     0 61095.8576    0  351 33503.8261 61095.8576  82.4%     -  636s
     0     0 60936.3746    0  356 33503.8261 60936.3746  81.9%     -  666s
     0     0 60849.2197    0  366 33503.8261 60849.2197  81.6%     -  694s
     0     0 60777.4341    0  358 33503.8261 60777.4341  81.4%     -  714s
     0     0 60737.9072    0  359 33503.8261 60737.9072  81.3%     -  733s
     0     0 60710.3073    0  352 33503.8261 60710.3073  81.2%     -  749s
     0     0 60691.7980    0  368 33503.8261 60691.7980  81.1%     -  758s
     0     0 60661.6691    0  347 33503.8261 60661.6691  81.1%     -  769s
     0     0 60645.6857    0  351 33503.8261 60645.6857  81.0%     -  777s
     0     0 60636.9729    0  350 33503.8261 60636.9729  81.0%     -  782s
     0     0 60633.3081    0  346 33503.8261 60633.3081  81.0%     -  786s
     0     0 60632.8825    0  343 33503.8261 60632.8825  81.0%     -  788s
     0     0 59589.1509    0  366 33503.8261 59589.1509  77.9%     -  877s
     0     0 59266.3078    0  359 33503.8261 59266.3078  76.9%     -  926s
     0     0 59137.4740    0  358 33503.8261 59137.4740  76.5%     -  952s
     0     0 59071.1241    0  359 33503.8261 59071.1241  76.3%     -  976s
     0     0 59035.0373    0  373 33503.8261 59035.0373  76.2%     -  989s
     0     0 58992.0433    0  374 33503.8261 58992.0433  76.1%     - 1010s
     0     0 58980.9047    0  383 33503.8261 58980.9047  76.0%     - 1016s
     0     0 58971.9467    0  372 33503.8261 58971.9467  76.0%     - 1024s
     0     0 58964.4103    0  383 33503.8261 58964.4103  76.0%     - 1029s
     0     0 58956.4617    0  383 33503.8261 58956.4617  76.0%     - 1035s
     0     0 58949.4950    0  383 33503.8261 58949.4950  75.9%     - 1040s
     0     0 58942.9049    0  379 33503.8261 58942.9049  75.9%     - 1044s
     0     0 58934.9014    0  382 33503.8261 58934.9014  75.9%     - 1051s
     0     0 58919.8597    0  385 33503.8261 58919.8597  75.9%     - 1061s
     0     0 58911.4114    0  383 33503.8261 58911.4114  75.8%     - 1068s
     0     0 58903.6571    0  386 33503.8261 58903.6571  75.8%     - 1072s
     0     0 58896.4771    0  382 33503.8261 58896.4771  75.8%     - 1076s
     0     0 58893.7861    0  382 33503.8261 58893.7861  75.8%     - 1079s
     0     0 58893.0175    0  383 33503.8261 58893.0175  75.8%     - 1081s
     0     0 58640.7498    0  412 33503.8261 58640.7498  75.0%     - 1121s
H    0     0                    33522.612576 58640.7012  74.9%     - 1123s
     0     0 58539.9179    0  415 33522.6126 58539.9179  74.6%     - 1147s
     0     0 58517.0424    0  323 33522.6126 58517.0424  74.6%     - 1155s
     0     0 58471.8226    0  410 33522.6126 58471.8226  74.4%     - 1173s
     0     0 58462.4943    0  326 33522.6126 58462.4943  74.4%     - 1187s
     0     0 58423.1896    0  319 33522.6126 58423.1896  74.3%     - 1198s
     0     0 58412.5389    0  323 33522.6126 58412.5389  74.2%     - 1208s
     0     0 58409.6984    0  427 33522.6126 58409.6984  74.2%     - 1216s
     0     0 58405.2076    0  428 33522.6126 58405.2076  74.2%     - 1220s
     0     0 58396.5306    0  430 33522.6126 58396.5306  74.2%     - 1226s
     0     0 58391.2477    0  435 33522.6126 58391.2477  74.2%     - 1229s
     0     0 58388.6499    0  431 33522.6126 58388.6499  74.2%     - 1232s
     0     0 58386.0722    0  433 33522.6126 58386.0722  74.2%     - 1235s
     0     0 58385.8809    0  435 33522.6126 58385.8809  74.2%     - 1237s
     0     0 58237.5821    0  409 33522.6126 58237.5821  73.7%     - 1257s
     0     0 58169.8573    0  382 33522.6126 58169.8573  73.5%     - 1280s
     0     0 58088.1523    0  411 33522.6126 58088.1523  73.3%     - 1296s
     0     0 58039.0819    0  437 33522.6126 58039.0819  73.1%     - 1311s
     0     0 58024.7809    0  395 33522.6126 58024.7809  73.1%     - 1320s
     0     0 58022.6809    0  431 33522.6126 58022.6809  73.1%     - 1324s
     0     0 57919.4243    0  404 33522.6126 57919.4243  72.8%     - 1349s
     0     0 57889.1123    0  413 33522.6126 57889.1123  72.7%     - 1357s
     0     0 57875.5199    0  407 33522.6126 57875.5199  72.6%     - 1364s
     0     0 57868.3014    0  403 33522.6126 57868.3014  72.6%     - 1369s
     0     0 57864.5528    0  407 33522.6126 57864.5528  72.6%     - 1373s
     0     0 57861.4234    0  402 33522.6126 57861.4234  72.6%     - 1376s
     0     0 57852.8370    0  403 33522.6126 57852.8370  72.6%     - 1382s
     0     0 57852.2399    0  401 33522.6126 57852.2399  72.6%     - 1385s
     0     0 57783.9072    0  345 33522.6126 57783.9072  72.4%     - 1403s
     0     0 57763.0122    0  343 33522.6126 57763.0122  72.3%     - 1411s
     0     0 57751.4330    0  345 33522.6126 57751.4330  72.3%     - 1418s
     0     0 57750.2371    0  338 33522.6126 57750.2371  72.3%     - 1421s
     0     0 57730.0638    0  341 33522.6126 57730.0638  72.2%     - 1432s
     0     0 57698.8663    0  453 33522.6126 57698.8663  72.1%     - 1447s
     0     0 57670.1988    0  449 33522.6126 57670.1988  72.0%     - 1457s
     0     0 57663.1103    0  415 33522.6126 57663.1103  72.0%     - 1464s
     0     0 57655.4731    0  441 33522.6126 57655.4731  72.0%     - 1470s
     0     0 57651.5643    0  452 33522.6126 57651.5643  72.0%     - 1476s
     0     0 57649.3005    0  409 33522.6126 57649.3005  72.0%     - 1478s
     0     0 57640.1364    0  401 33522.6126 57640.1364  71.9%     - 1486s
     0     0 57636.1454    0  398 33522.6126 57636.1454  71.9%     - 1499s
     0     0 57634.9071    0  396 33522.6126 57634.9071  71.9%     - 1502s
     0     0 57619.0766    0  392 33522.6126 57619.0766  71.9%     - 1512s
     0     0 57616.4657    0  393 33522.6126 57616.4657  71.9%     - 1519s
     0     0 57539.4119    0  384 33522.6126 57539.4119  71.6%     - 1541s
     0     0 57512.9256    0  422 33522.6126 57512.9256  71.6%     - 1553s
     0     0 57507.1333    0  391 33522.6126 57507.1333  71.5%     - 1558s
     0     0 57503.5306    0  429 33522.6126 57503.5306  71.5%     - 1562s
     0     0 57501.9034    0  431 33522.6126 57501.9034  71.5%     - 1565s
     0     0 57491.5016    0  440 33522.6126 57491.5016  71.5%     - 1574s
H    0     0                    36954.628170 57491.4902  55.6%     - 1609s
H    0     0                    37068.760262 57491.4902  55.1%     - 1609s
H    0     0                    37112.521988 57491.4902  54.9%     - 1611s
H    0     0                    37523.812347 57491.4902  53.2%     - 1611s
H    0     0                    38488.232500 57491.4902  49.4%     - 1616s
     0     0 57484.5643    0  438 38488.2325 57484.5643  49.4%     - 1623s
     0     0 57477.1856    0  445 38488.2325 57477.1856  49.3%     - 1628s
     0     0 57475.6724    0  443 38488.2325 57475.6724  49.3%     - 1632s
     0     0 57468.1754    0  389 38488.2325 57468.1754  49.3%     - 1642s
H    0     0                    38629.559354 57467.5554  48.8%     - 1643s
H    0     0                    39052.585397 57467.5554  47.2%     - 1643s
H    0     0                    40131.511835 57467.5554  43.2%     - 1643s
     0     0 57463.7568    0  392 40131.5118 57463.7568  43.2%     - 1648s
     0     0 57462.7497    0  390 40131.5118 57462.7497  43.2%     - 1651s
     0     0 57458.3213    0  390 40131.5118 57458.3213  43.2%     - 1657s
     0     0 57458.0640    0  390 40131.5118 57458.0640  43.2%     - 1658s
     0     0 57436.5018    0  398 40131.5118 57436.5018  43.1%     - 1669s
     0     0 57434.1309    0  403 40131.5118 57434.1309  43.1%     - 1673s
     0     0 57428.3881    0  393 40131.5118 57428.3881  43.1%     - 1680s
     0     0 57427.9210    0  393 40131.5118 57427.9210  43.1%     - 1684s
H    0     0                    40247.332997 57426.3917  42.7%     - 1781s
H    0     0                    40390.534879 57426.3917  42.2%     - 1781s
H    0     0                    40400.774508 57426.3917  42.1%     - 1781s
H    0     0                    41098.256272 57426.3917  39.7%     - 1781s
H    0     0                    41099.060387 57426.3917  39.7%     - 1781s
     0     2 57426.3917    0  393 41099.0604 57426.3917  39.7%     - 1951s
     1     4 57359.0423    1  373 41099.0604 57426.3917  39.7% 10578 1979s
     3     8 57298.7451    2  375 41099.0604 57358.4242  39.6% 10883 2027s
     7    16 57147.3035    3  418 41099.0604 57297.4351  39.4% 15080 2084s
    15    32 56921.3214    4  386 41099.0604 57144.8474  39.0% 17298 2158s
    31    48 56059.6561    5  358 41099.0604 56921.2957  38.5% 24020 2303s
    47    76 55165.9502    6  295 41099.0604 56921.2957  38.5% 27970 2421s
    75   115 55021.9331    7  348 41099.0604 56921.2957  38.5% 24368 2500s
   114   174 54937.1792    8  350 41099.0604 56921.2957  38.5% 20830 2589s
   173   224 54922.8118    9  351 41099.0604 56921.2957  38.5% 15530 2670s
H  218   224                    41291.814988 56921.2957  37.9% 13498 2670s
   223   301 54922.2130    8  347 41291.8150 56921.2957  37.9% 13299 2768s
H  300   381                    41353.191600 56921.2957  37.6% 11670 2853s
   380   449 54548.0422   11  342 41353.1916 56921.2957  37.6% 10406 2920s
   448   533 54782.1824    9  343 41353.1916 56921.2957  37.6% 10222 2969s
   532   609 54664.0418   12  300 41353.1916 56921.2957  37.6%  9773 3013s
   608   638 54090.7602   12  325 41353.1916 56921.2957  37.6%  9491 3058s
   637   674 54211.1171   12  346 41353.1916 56921.2957  37.6%  9486 3131s
   673   705 53986.6711   12  311 41353.1916 56921.2957  37.6%  9560 3177s
H  685   705                    41362.145691 56921.2957  37.6%  9518 3177s
   704   779 54487.1518   13  310 41362.1457 56921.2957  37.6%  9540 3218s
   778   816 53934.5552   14  298 41362.1457 56921.2957  37.6%  9410 3258s
   815   868 53014.0075   14  299 41362.1457 56921.2957  37.6%  9287 3315s
H  838   868                    41587.755182 56921.2957  36.9%  9219 3315s
   867   974 52756.6306   15  310 41587.7552 56921.2957  36.9%  9292 3351s
   989  1059 52078.5644   15  284 41587.7552 56921.2957  36.9%  8820 3396s
  1106  1116 52565.9466   15  247 41587.7552 56921.2957  36.9%  8444 3440s
  1215  1147 52089.5910   16  317 41587.7552 56921.2957  36.9%  8220 3493s
  1303  1164 51913.5433   16  306 41587.7552 56921.2957  36.9%  8211 3545s
  1372  1211 51609.4782   17  313 41587.7552 56921.2957  36.9%  8381 3600s

Cutting planes:
  Gomory: 1
  Implied bound: 220
  MIR: 2747
  Flow cover: 3176
  RLT: 40
  Relax-and-lift: 339
  BQP: 3

Explored 1454 nodes (13063020 simplex iterations) in 3600.07 seconds (5138.20 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41587.8 41362.1 41353.2 ... 39052.6

Time limit reached
Best objective 4.158775518208e+04, best bound 5.692129574907e+04, gap 36.8703%
  WARNING: Time limit reached. Using best solution found (gap: 36.87%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 41587.76, θ = 205462.40
  Upper Bound (UB) = 41587.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205462.40
  [DEBUG]   ✓ Scenario 0: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 205462.40 ≤ Q = 205462.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 205462.40 ≤ Q = 205462.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 205462.40 ≤ Q = 205462.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 205462.40 ≤ Q = 205462.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 205462.40 ≤ Q = 205462.40 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 205462.40 ≤ Q = 205462.40 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 205462.40 ≤ Q = 205462.40 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x28b91d5e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x28b91d5e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.378436e+13
Presolve removed 2598 rows and 1889 columns
Presolve time: 0.01s
Presolved: 495 rows, 500 columns, 1399 nonzeros
Found heuristic solution: objective 6162611.5879
Variable types: 340 continuous, 160 integer (160 binary)

Root relaxation: objective -1.949252e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -194925.24    0  125 6162611.59 -194925.24   103%     -    0s
H    0     0                    -160950.6948 -194925.24  21.1%     -    0s
H    0     0                    -161863.9179 -194925.24  20.4%     -    0s
     0     0 -174252.23    0  108 -161863.92 -174252.23  7.65%     -    0s
H    0     0                    -168476.2762 -174128.72  3.36%     -    0s
H    0     0                    -168800.6167 -174128.72  3.16%     -    0s
H    0     0                    -169425.0345 -174128.72  2.78%     -    0s
H    0     0                    -169749.3749 -174128.72  2.58%     -    0s
     0     0 -171557.22    0  112 -169749.37 -171557.22  1.07%     -    0s
H    0     0                    -169954.8485 -171548.86  0.94%     -    0s
     0     0 -171171.02    0   85 -169954.85 -171171.02  0.72%     -    0s
     0     0 -171037.96    0   94 -169954.85 -171037.96  0.64%     -    0s
     0     0 -171029.99    0   84 -169954.85 -171029.99  0.63%     -    0s
     0     0 -170931.31    0   85 -169954.85 -170931.31  0.57%     -    0s
     0     0 -170929.79    0   85 -169954.85 -170929.79  0.57%     -    0s
H    0     0                    -170164.3194 -170850.28  0.40%     -    0s
     0     2 -170850.28    0   85 -170164.32 -170850.28  0.40%     -    0s
H  268   210                    -170185.6093 -170465.52  0.16%   5.2    0s
H 1067   553                    -170207.4052 -170452.86  0.14%   3.6    0s

Cutting planes:
  Gomory: 42
  Implied bound: 4
  MIR: 183
  Flow cover: 11
  RLT: 25
  Relax-and-lift: 1
  BQP: 3

Explored 10726 nodes (37822 simplex iterations) in 0.44 seconds (0.26 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -170207 -170186 -170164 ... 1.37844e+13
No other solutions better than -170207

Optimal solution found (tolerance 1.00e-06)
Best objective -1.702074051641e+05, best bound -1.702074051641e+05, gap 0.0000%
  Subproblem solved in 0.48s
  Worst-case operational profit (Z_SP) = 198839.57
  Scenario: 50 demand increases, 10 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -170207.41
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -170207.41 = 198839.57
  [DEBUG]   Current θ from Master = 205462.40
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6622.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34964.93
  Lower Bound (LB) = 39915.15
  Gap (UB-LB) = 1672.6102, Absolute Gap = 1672.6102, Relative Gap = 0.040219
  Not converged yet (gap = 1672.61 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 50 increases, 10 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0xf50b0e87
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns (presolve time = 5s)...
Presolve removed 120190 rows and 48790 columns
Presolve time: 5.15s
Presolved: 141123 rows, 59550 columns, 868615 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -183458.7557

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.97s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 6.905e+06
 Factor NZ  : 1.544e+07 (roughly 200 MB of memory)
 Factor Ops : 3.645e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.19121997e+07  2.85704434e+08  2.67e+05 1.87e+01  1.54e+05     9s
   1  -2.53629784e+07  3.21617860e+08  1.93e+05 1.23e+02  1.14e+05    10s
   2  -1.28211420e+07  2.34473455e+08  9.38e+04 9.65e-01  5.78e+04    10s
   3  -2.03805064e+06  1.79704399e+08  1.07e+04 3.50e+00  7.13e+03    10s
   4  -7.57919447e+05  1.03026072e+08  1.06e+03 4.51e-01  9.98e+02    10s
   5  -6.72984506e+05  5.34731885e+07  5.36e+02 1.84e-01  4.78e+02    10s
   6  -5.96359676e+05  3.74555898e+07  2.20e+02 1.14e-01  2.50e+02    10s
   7  -4.98413183e+05  2.76572378e+07  5.52e+01 7.88e-02  1.32e+02    10s
   8  -3.48483184e+05  1.70767561e+07  8.11e+00 4.57e-02  7.02e+01    11s
   9  -2.58915449e+05  8.71332778e+06  3.28e+00 2.24e-02  3.54e+01    11s
  10  -1.60278850e+05  4.53084622e+06  1.42e+00 1.14e-02  1.83e+01    11s
  11  -1.20224628e+05  2.77494683e+06  7.92e-01 6.91e-03  1.13e+01    11s
  12  -8.97759997e+04  1.59483687e+06  4.59e-01 3.93e-03  6.56e+00    11s
  13  -6.20946222e+04  6.17096748e+05  2.70e-01 1.52e-03  2.64e+00    11s
  14  -2.66574598e+03  3.39945680e+05  7.03e-02 1.14e-03  1.33e+00    11s
  15   2.01505765e+04  2.16359761e+05  4.30e-02 1.85e-03  7.62e-01    11s
  16   2.80083809e+04  1.59586975e+05  3.60e-02 1.13e-03  5.11e-01    12s
  17   3.53307872e+04  1.34076980e+05  2.97e-02 7.96e-04  3.84e-01    12s
  18   3.66310553e+04  1.24988044e+05  2.85e-02 6.88e-04  3.43e-01    12s
  19   4.56810954e+04  1.15409824e+05  2.05e-02 5.66e-04  2.71e-01    12s
  20   4.91218427e+04  1.03675769e+05  1.77e-02 4.09e-04  2.12e-01    12s
  21   5.48068800e+04  9.70664180e+04  1.32e-02 3.19e-04  1.64e-01    13s
  22   5.77290464e+04  8.90930742e+04  1.09e-02 2.11e-04  1.22e-01    13s
  23   6.16869493e+04  8.32272748e+04  8.15e-03 2.03e-04  8.37e-02    13s
  24   6.46509875e+04  8.11541614e+04  6.18e-03 1.73e-04  6.41e-02    13s
  25   6.64000356e+04  7.96995417e+04  5.03e-03 1.34e-04  5.17e-02    14s
  26   6.84229352e+04  7.82421595e+04  3.73e-03 9.95e-05  3.81e-02    14s
  27   6.89716614e+04  7.71268360e+04  3.40e-03 1.30e-04  3.17e-02    14s
  28   7.06189488e+04  7.62518217e+04  2.38e-03 6.89e-05  2.19e-02    14s
  29   7.15993067e+04  7.57233371e+04  1.79e-03 4.45e-05  1.60e-02    14s
  30   7.30653659e+04  7.53700728e+04  9.10e-04 8.75e-05  8.95e-03    15s
  31   7.38883005e+04  7.49181315e+04  4.18e-04 6.94e-05  4.00e-03    15s
  32   7.40123582e+04  7.48943089e+04  3.50e-04 6.20e-05  3.43e-03    15s
  33   7.40531709e+04  7.48373965e+04  3.28e-04 4.39e-05  3.05e-03    15s
  34   7.43767177e+04  7.47710810e+04  1.59e-04 2.18e-05  1.53e-03    15s
  35   7.44014982e+04  7.47575667e+04  1.47e-04 1.77e-05  1.38e-03    16s
  36   7.44728019e+04  7.47344277e+04  1.11e-04 9.56e-06  1.02e-03    16s
  37   7.46156494e+04  7.47221327e+04  3.88e-05 5.76e-06  4.14e-04    16s
  38   7.46415925e+04  7.47147270e+04  2.59e-05 3.85e-06  2.84e-04    16s
  39   7.46773508e+04  7.47114104e+04  9.05e-06 3.21e-06  1.32e-04    16s
  40   7.46894408e+04  7.47075600e+04  3.22e-06 2.35e-06  7.04e-05    17s
  41   7.46912171e+04  7.47039816e+04  2.38e-06 1.58e-06  4.96e-05    17s
  42   7.46937039e+04  7.46992670e+04  1.20e-06 5.55e-07  2.16e-05    17s
  43   7.46944108e+04  7.46974259e+04  8.91e-07 2.58e-07  1.17e-05    17s
  44   7.46956973e+04  7.46971849e+04  3.74e-07 1.72e-07  5.79e-06    18s
  45   7.46961107e+04  7.46968484e+04  2.23e-07 7.06e-08  2.87e-06    18s
  46   7.46966814e+04  7.46967334e+04  1.91e-08 2.66e-08  2.03e-07    18s
  47   7.46967031e+04  7.46967210e+04  1.67e-07 4.84e-08  6.97e-08    18s
  48   7.46967031e+04  7.46967210e+04  5.40e-06 5.67e-08  6.96e-08    19s
  49   7.46967032e+04  7.46967217e+04  3.94e-06 5.05e-08  7.23e-08    19s
  50   7.46967176e+04  7.46967209e+04  7.40e-07 2.39e-09  1.30e-08    19s
  51   7.46967195e+04  7.46967209e+04  4.48e-06 1.56e-06  5.49e-09    19s
  52   7.46967202e+04  7.46967209e+04  4.61e-06 1.55e-06  2.92e-09    19s

Barrier solved model in 52 iterations and 19.42 seconds (16.11 work units)
Optimal objective 7.46967202e+04


Root crossover log...

  127071 DPushes remaining with DInf 0.0000000e+00                19s
   68895 DPushes remaining with DInf 0.0000000e+00                20s
   19354 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                29s

   26747 PPushes remaining with PInf 9.5119386e-05                29s
   17373 PPushes remaining with PInf 7.2538154e-05                30s
       0 PPushes remaining with PInf 0.0000000e+00                34s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.7460326e+04     34s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   98324    7.4696721e+04   0.000000e+00   8.746033e+04     34s
   99096    7.4696721e+04   0.000000e+00   0.000000e+00     35s
   99096    7.4696721e+04   0.000000e+00   0.000000e+00     35s
Concurrent spin time: 7.22s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 7.469672e+04, 99096 iterations, 36.05 seconds (36.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 74696.7209    0  145 -183458.76 74696.7209   141%     -   43s
H    0     0                    -146805.2624 74696.7209   151%     -   44s
H    0     0                    -143811.1241 74696.7209   152%     -   45s
H    0     0                    -143071.8122 74696.7209   152%     -   45s
H    0     0                    -142904.0201 74696.7209   152%     -   45s
H    0     0                    -140604.5051 74696.7209   153%     -   45s
H    0     0                    -77288.71489 74696.7209   197%     -   45s
H    0     0                    -77119.58272 74696.7209   197%     -   46s
H    0     0                    -7582.273809 74696.7209  1085%     -   46s
H    0     0                    11874.310775 74696.7209   529%     -   46s
H    0     0                    27355.591312 74696.7209   173%     -   47s
     0     0 68511.9378    0  189 27355.5913 68511.9378   150%     -  197s
H    0     0                    28195.404521 68511.9373   143%     -  198s
     0     0 68350.9557    0  205 28195.4045 68350.9557   142%     -  238s
     0     0 68227.6309    0  134 28195.4045 68227.6309   142%     -  260s
     0     0 68210.2789    0  204 28195.4045 68210.2789   142%     -  270s
     0     0 68179.0007    0  206 28195.4045 68179.0007   142%     -  280s
     0     0 68124.4581    0  128 28195.4045 68124.4581   142%     -  290s
     0     0 68115.1383    0  211 28195.4045 68115.1383   142%     -  294s
     0     0 68114.4514    0  207 28195.4045 68114.4514   142%     -  295s
     0     0 64720.1385    0  284 28195.4045 64720.1385   130%     -  401s
     0     0 64063.6740    0  290 28195.4045 64063.6740   127%     -  461s
     0     0 63908.5142    0  308 28195.4045 63908.5142   127%     -  487s
     0     0 63803.2395    0  307 28195.4045 63803.2395   126%     -  519s
     0     0 63589.1698    0  308 28195.4045 63589.1698   126%     -  551s
     0     0 63574.4119    0  311 28195.4045 63574.4119   125%     -  561s
     0     0 63561.2063    0  322 28195.4045 63561.2063   125%     -  567s
     0     0 63547.5623    0  321 28195.4045 63547.5623   125%     -  577s
     0     0 63536.1572    0  325 28195.4045 63536.1572   125%     -  583s
     0     0 63534.5688    0  326 28195.4045 63534.5688   125%     -  586s
     0     0 63533.0076    0  325 28195.4045 63533.0076   125%     -  588s
     0     0 63532.4934    0  326 28195.4045 63532.4934   125%     -  593s
     0     0 60922.2493    0  325 28195.4045 60922.2493   116%     -  737s
H    0     0                    28413.116311 60920.9785   114%     -  738s
H    0     0                    28701.824033 60920.9785   112%     -  738s
     0     0 60199.9944    0  318 28701.8240 60199.9944   110%     -  810s
     0     0 60032.2912    0  352 28701.8240 60032.2912   109%     -  854s
     0     0 59956.7409    0  273 28701.8240 59956.7409   109%     -  871s
     0     0 59890.6349    0  278 28701.8240 59890.6349   109%     -  892s
     0     0 59823.1115    0  274 28701.8240 59823.1115   108%     -  907s
     0     0 59752.5769    0  353 28701.8240 59752.5769   108%     -  928s
     0     0 59709.6555    0  350 28701.8240 59709.6555   108%     -  945s
     0     0 59657.5859    0  266 28701.8240 59657.5859   108%     -  962s
     0     0 59645.5829    0  266 28701.8240 59645.5829   108%     -  970s
     0     0 59643.6268    0  335 28701.8240 59643.6268   108%     -  975s
     0     0 59643.2383    0  342 28701.8240 59643.2383   108%     -  978s
     0     0 59080.1773    0  347 28701.8240 59080.1773   106%     - 1056s
     0     0 58775.7438    0  366 28701.8240 58775.7438   105%     - 1090s
     0     0 58641.9605    0  366 28701.8240 58641.9605   104%     - 1121s
     0     0 58416.1711    0  361 28701.8240 58416.1711   104%     - 1151s
     0     0 58313.1714    0  378 28701.8240 58313.1714   103%     - 1178s
     0     0 58266.2540    0  376 28701.8240 58266.2540   103%     - 1206s
     0     0 58248.3764    0  383 28701.8240 58248.3764   103%     - 1221s
     0     0 58231.6166    0  383 28701.8240 58231.6166   103%     - 1232s
     0     0 58219.0094    0  387 28701.8240 58219.0094   103%     - 1244s
     0     0 58189.8190    0  382 28701.8240 58189.8190   103%     - 1257s
     0     0 58172.7152    0  372 28701.8240 58172.7152   103%     - 1270s
     0     0 58115.2692    0  389 28701.8240 58115.2692   102%     - 1288s
     0     0 58099.5785    0  382 28701.8240 58099.5785   102%     - 1301s
     0     0 58088.6073    0  379 28701.8240 58088.6073   102%     - 1305s
     0     0 58086.9380    0  393 28701.8240 58086.9380   102%     - 1308s
     0     0 57795.6947    0  396 28701.8240 57795.6947   101%     - 1352s
H    0     0                    30598.583359 57795.6892  88.9%     - 1353s
H    0     0                    30899.405418 57795.6892  87.0%     - 1353s
H    0     0                    31073.728101 57795.6892  86.0%     - 1353s
     0     0 57756.4806    0  403 31073.7281 57756.4806  85.9%     - 1370s
     0     0 57731.9072    0  400 31073.7281 57731.9072  85.8%     - 1378s
     0     0 57720.2387    0  386 31073.7281 57720.2387  85.8%     - 1387s
     0     0 57712.3538    0  385 31073.7281 57712.3538  85.7%     - 1396s
     0     0 57684.3808    0  382 31073.7281 57684.3808  85.6%     - 1405s
     0     0 57653.6254    0  384 31073.7281 57653.6254  85.5%     - 1413s
     0     0 57630.5872    0  388 31073.7281 57630.5872  85.5%     - 1422s
     0     0 57623.2392    0  385 31073.7281 57623.2392  85.4%     - 1426s
     0     0 57601.1375    0  388 31073.7281 57601.1375  85.4%     - 1432s
     0     0 57598.3187    0  393 31073.7281 57598.3187  85.4%     - 1436s
     0     0 57597.5024    0  391 31073.7281 57597.5024  85.4%     - 1441s
     0     0 57437.3176    0  379 31073.7281 57437.3176  84.8%     - 1463s
H    0     0                    31364.661359 57437.0485  83.1%     - 1468s
H    0     0                    35348.141347 57437.0485  62.5%     - 1468s
     0     0 57381.5923    0  421 35348.1413 57381.5923  62.3%     - 1491s
     0     0 57353.1604    0  421 35348.1413 57353.1604  62.3%     - 1509s
     0     0 57333.0528    0  423 35348.1413 57333.0528  62.2%     - 1522s
     0     0 57320.8231    0  324 35348.1413 57320.8231  62.2%     - 1529s
     0     0 57317.9014    0  411 35348.1413 57317.9014  62.2%     - 1535s
     0     0 57315.6573    0  414 35348.1413 57315.6573  62.1%     - 1538s
     0     0 57187.6456    0  400 35348.1413 57187.6456  61.8%     - 1560s
H    0     0                    35924.775264 57187.5532  59.2%     - 1562s
H    0     0                    36040.411066 57187.5532  58.7%     - 1562s
H    0     0                    39141.890251 57187.5532  46.1%     - 1562s
     0     0 57140.5264    0  390 39141.8903 57140.5264  46.0%     - 1580s
     0     0 57118.0876    0  405 39141.8903 57118.0876  45.9%     - 1591s
     0     0 57111.9816    0  406 39141.8903 57111.9816  45.9%     - 1598s
     0     0 57107.6963    0  399 39141.8903 57107.6963  45.9%     - 1604s
     0     0 57102.0112    0  405 39141.8903 57102.0112  45.9%     - 1608s
     0     0 57100.6264    0  435 39141.8903 57100.6264  45.9%     - 1611s
     0     0 57067.1447    0  398 39141.8903 57067.1447  45.8%     - 1629s
     0     0 57031.5709    0  391 39141.8903 57031.5709  45.7%     - 1652s
     0     0 57021.6463    0  394 39141.8903 57021.6463  45.7%     - 1661s
     0     0 57016.9394    0  393 39141.8903 57016.9394  45.7%     - 1667s
     0     0 57016.3498    0  392 39141.8903 57016.3498  45.7%     - 1669s
     0     0 57005.2878    0  390 39141.8903 57005.2878  45.6%     - 1681s
H    0     0                    39540.073948 57005.0125  44.2%     - 1682s
     0     0 56996.4675    0  393 39540.0739 56996.4675  44.1%     - 1690s
     0     0 56995.3863    0  431 39540.0739 56995.3863  44.1%     - 1696s
     0     0 56981.1135    0  382 39540.0739 56981.1135  44.1%     - 1709s
     0     0 56977.0107    0  413 39540.0739 56977.0107  44.1%     - 1716s
     0     0 56973.3075    0  387 39540.0739 56973.3075  44.1%     - 1718s
     0     0 56972.8592    0  386 39540.0739 56972.8592  44.1%     - 1719s
     0     0 56924.3498    0  399 39540.0739 56924.3498  44.0%     - 1734s
     0     0 56916.8430    0  405 39540.0739 56916.8430  43.9%     - 1741s
     0     0 56915.3681    0  397 39540.0739 56915.3681  43.9%     - 1743s
     0     0 56912.7005    0  412 39540.0739 56912.7005  43.9%     - 1749s
     0     0 56909.2880    0  396 39540.0739 56909.2880  43.9%     - 1752s
     0     0 56908.6431    0  401 39540.0739 56908.6431  43.9%     - 1753s
     0     0 56890.5518    0  390 39540.0739 56890.5518  43.9%     - 1761s
     0     0 56882.4817    0  397 39540.0739 56882.4817  43.9%     - 1767s
     0     0 56879.4873    0  398 39540.0739 56879.4873  43.9%     - 1771s
     0     0 56876.0038    0  398 39540.0739 56876.0038  43.8%     - 1778s
     0     0 56868.9195    0  396 39540.0739 56868.9195  43.8%     - 1784s
     0     0 56868.0119    0  395 39540.0739 56868.0119  43.8%     - 1786s
     0     0 56856.1717    0  389 39540.0739 56856.1717  43.8%     - 1796s
     0     0 56854.5252    0  391 39540.0739 56854.5252  43.8%     - 1822s
     0     0 56853.6012    0  388 39540.0739 56853.6012  43.8%     - 1825s
H    0     0                    39551.661933 56853.4471  43.7%     - 1827s
H    0     0                    39629.139295 56853.4471  43.5%     - 1827s
     0     0 56853.1040    0  387 39629.1393 56853.1040  43.5%     - 1828s
     0     0 56847.5378    0  399 39629.1393 56847.5378  43.4%     - 1834s
H    0     0                    39659.492590 56847.4091  43.3%     - 1859s
H    0     0                    39682.589067 56847.4091  43.3%     - 1864s
H    0     0                    40607.162671 56847.4091  40.0%     - 1864s
     0     0 56844.6074    0  427 40607.1627 56844.6074  40.0%     - 1871s
     0     0 56843.8386    0  392 40607.1627 56843.8386  40.0%     - 1873s
     0     0 56842.3900    0  396 40607.1627 56842.3900  40.0%     - 1876s
     0     0 56841.8040    0  396 40607.1627 56841.8040  40.0%     - 1881s
H    0     0                    40644.408007 56841.8040  39.9%     - 2049s
H    0     0                    41035.887726 56841.8040  38.5%     - 2049s
H    0     0                    41170.294047 56841.8040  38.1%     - 2049s
H    0     0                    41353.191600 56841.8040  37.5%     - 2049s
     0     2 56841.8040    0  396 41353.1916 56841.8040  37.5%     - 2170s
     1     3 56101.1533    1  409 41353.1916 56841.8040  37.5% 13199 2198s
     2     4 56723.8612    1  382 41353.1916 56723.8612  37.2% 12114 2221s
     3     7 55822.1949    2  378 41353.1916 56723.8543  37.2% 10637 2254s
     6    12 55698.7374    3  366 41353.1916 56723.2085  37.2% 12086 2323s
    11    21 54809.5408    4  362 41353.1916 56132.6384  35.7% 15419 2377s
    20    30 53529.6672    5  328 41353.1916 55863.4981  35.1% 20619 2471s
    29    56 53061.7280    4  306 41353.1916 55400.4533  34.0% 18673 2732s
    55    88 52898.8876    5  291 41353.1916 55400.4533  34.0% 24813 2813s
    87   120 52893.8636    6  288 41353.1916 55400.4533  34.0% 25498 2878s
   119   191 52769.6141    7  292 41353.1916 55400.4533  34.0% 21167 2965s
H  188   191                    41362.145691 55400.4533  33.9% 15629 2965s
   190   253 52543.9918    8  287 41362.1457 55400.4533  33.9% 15605 3138s
   252   352 51909.6111   10  272 41362.1457 55400.4533  33.9% 14070 3227s
   351   435 51225.0449   13  255 41362.1457 55400.4533  33.9% 12229 3291s
   434   470 50910.0224   16  250 41362.1457 55400.4533  33.9% 11791 3332s
   469   522 50237.8565   17  305 41362.1457 55400.4533  33.9% 11859 3378s
   521   604 49179.8331   18  241 41362.1457 55400.4533  33.9% 11636 3418s
   609   688 49035.9631   19  227 41362.1457 55400.4533  33.9% 11078 3460s
   695   749 48806.6562   21  232 41362.1457 55400.4533  33.9% 10737 3494s
   774   792 48550.4700   24  216 41362.1457 55400.4533  33.9% 10500 3534s
   843   849 47707.7808   29  169 41362.1457 55400.4533  33.9% 10259 3579s
   924   849 42948.9540   26  313 41362.1457 55400.4533  33.9% 10018 3580s
   925   882 46819.1039   33  142 41362.1457 55400.4533  33.9% 10018 3600s

Cutting planes:
  Gomory: 1
  Implied bound: 224
  MIR: 2709
  Flow cover: 2799
  RLT: 38
  Relax-and-lift: 295

Explored 992 nodes (10448103 simplex iterations) in 3600.11 seconds (5006.68 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41362.1 41353.2 41170.3 ... 39551.7

Time limit reached
Best objective 4.136214569070e+04, best bound 5.540045331384e+04, gap 33.9400%
  WARNING: Time limit reached. Using best solution found (gap: 33.94%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 41362.15, θ = 204213.71
  Upper Bound (UB) = 41362.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 204213.71
  [DEBUG]   ✓ Scenario 0: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 204213.71 ≤ Q = 204213.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 204213.71 ≤ Q = 204213.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 204213.71 ≤ Q = 204213.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4b6b0fc5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb494f03b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.369690e+13
Presolve removed 2604 rows and 1894 columns
Presolve time: 0.01s
Presolved: 489 rows, 495 columns, 1383 nonzeros
Found heuristic solution: objective 6082988.2917
Variable types: 336 continuous, 159 integer (159 binary)
Found heuristic solution: objective 6082695.1249

Root relaxation: objective -1.963469e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -196346.90    0  125 6082695.12 -196346.90   103%     -    0s
H    0     0                    -154705.3856 -196346.90  26.9%     -    0s
H    0     0                    -154998.5524 -196346.90  26.7%     -    0s
H    0     0                    -155025.7809 -196180.27  26.5%     -    0s
     0     0 -170895.61    0   32 -155025.78 -170895.61  10.2%     -    0s
H    0     0                    -167830.0448 -170791.79  1.76%     -    0s
H    0     0                    -168163.2194 -170791.79  1.56%     -    0s
H    0     0                    -168723.2699 -170791.79  1.23%     -    0s
H    0     0                    -169056.4445 -170791.79  1.03%     -    0s
     0     0 -169784.71    0   25 -169056.44 -169784.71  0.43%     -    0s
     0     0 -169609.59    0   22 -169056.44 -169609.59  0.33%     -    0s
     0     0 -169554.52    0   22 -169056.44 -169554.52  0.29%     -    0s
     0     0 -169547.51    0   13 -169056.44 -169547.51  0.29%     -    0s
     0     0 -169535.08    0   12 -169056.44 -169535.08  0.28%     -    0s
H    0     0                    -169118.3248 -169535.08  0.25%     -    0s
H    0     0                    -169211.3185 -169533.16  0.19%     -    0s
H    0     0                    -169277.5708 -169533.16  0.15%     -    0s
H    0     0                    -169309.5677 -169533.16  0.13%     -    0s
     0     0 -169533.16    0   11 -169309.57 -169533.16  0.13%     -    0s
     0     0 -169459.10    0    9 -169309.57 -169459.10  0.09%     -    0s
     0     0 -169454.23    0    9 -169309.57 -169454.23  0.09%     -    0s
     0     0 -169419.23    0    8 -169309.57 -169419.23  0.06%     -    0s
     0     0 -169419.23    0   21 -169309.57 -169419.23  0.06%     -    0s
H    0     0                    -169348.6476 -169419.23  0.04%     -    0s
     0     0 -169364.61    0    2 -169348.65 -169364.61  0.01%     -    0s
*    0     0               0    -169362.4152 -169362.42  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 17
  Flow cover: 4
  Relax-and-lift: 1

Explored 1 nodes (593 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -169362 -169349 -169310 ... -154999
No other solutions better than -169362

Optimal solution found (tolerance 1.00e-06)
Best objective -1.693624152085e+05, best bound -1.693624152085e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 199684.56
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -169362.42
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -169362.42 = 199684.56
  [DEBUG]   Current θ from Master = 204213.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4529.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 36832.99
  Lower Bound (LB) = 39915.15
  Gap (UB-LB) = 1447.0007, Absolute Gap = 1447.0007, Relative Gap = 0.034984
  Not converged yet (gap = 1447.00 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0xb7f22565
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns (presolve time = 5s)...
Presolve removed 127260 rows and 51660 columns
Presolve time: 8.64s
Presolved: 149343 rows, 62920 columns, 918613 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -183458.7557

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.65s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 7.628e+06
 Factor NZ  : 1.731e+07 (roughly 230 MB of memory)
 Factor Ops : 4.327e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.32583757e+07  2.99997330e+08  2.78e+05 1.81e+01  1.60e+05    12s
   1  -2.65307733e+07  3.41067235e+08  2.01e+05 1.24e+02  1.19e+05    12s
   2  -1.43803648e+07  2.49278819e+08  1.05e+05 1.31e+00  6.42e+04    12s
   3  -2.24140491e+06  1.88746260e+08  1.22e+04 8.89e+00  7.98e+03    12s
   4  -8.28266330e+05  1.11906550e+08  1.58e+03 6.49e-01  1.30e+03    13s
   5  -6.83489024e+05  5.57257914e+07  6.08e+02 2.42e-01  5.12e+02    13s
   6  -5.96180321e+05  3.97141352e+07  2.17e+02 1.58e-01  2.50e+02    13s
   7  -5.34228067e+05  3.13940439e+07  1.07e+02 1.18e-01  1.64e+02    13s
   8  -3.71279678e+05  1.92284208e+07  1.25e+01 6.54e-02  7.63e+01    13s
   9  -2.70576563e+05  7.90177157e+06  5.12e+00 2.50e-02  3.09e+01    13s
  10  -1.71546826e+05  5.72785124e+06  2.47e+00 1.79e-02  2.20e+01    13s
  11  -1.29085104e+05  3.92004281e+06  1.35e+00 1.20e-02  1.50e+01    14s
  12  -9.18038588e+04  2.27397844e+06  6.05e-01 7.02e-03  8.71e+00    14s
  13  -6.20043170e+04  7.45433238e+05  3.14e-01 2.25e-03  2.97e+00    14s
  14  -1.80135072e+04  3.48597428e+05  1.36e-01 1.20e-03  1.35e+00    14s
  15   1.22755905e+04  2.37842418e+05  7.34e-02 2.27e-03  8.29e-01    14s
  16   2.51864954e+04  1.87858006e+05  5.47e-02 2.30e-03  5.98e-01    14s
  17   3.35514098e+04  1.55514306e+05  4.26e-02 1.98e-03  4.48e-01    15s
  18   4.10890050e+04  1.25962778e+05  3.28e-02 1.33e-03  3.12e-01    15s
  19   4.61558629e+04  1.05635356e+05  2.69e-02 8.11e-04  2.19e-01    15s
  20   4.97656665e+04  9.80243767e+04  2.31e-02 6.51e-04  1.77e-01    15s
  21   5.25219518e+04  9.24512034e+04  2.02e-02 5.12e-04  1.47e-01    15s
  22   5.71763684e+04  8.63745814e+04  1.56e-02 8.16e-04  1.07e-01    16s
  23   6.26165267e+04  8.29260877e+04  1.04e-02 5.76e-04  7.46e-02    16s
  24   6.55188048e+04  8.04724727e+04  7.71e-03 3.60e-04  5.49e-02    16s
  25   6.70717024e+04  7.93121696e+04  6.32e-03 3.06e-04  4.50e-02    16s
  26   6.77393310e+04  7.77791673e+04  5.75e-03 2.02e-04  3.69e-02    16s
  27   6.95939486e+04  7.65551554e+04  4.16e-03 1.18e-04  2.56e-02    17s
  28   7.16595013e+04  7.60240587e+04  2.41e-03 8.55e-05  1.60e-02    17s
  29   7.29051987e+04  7.53678947e+04  1.35e-03 7.13e-05  9.05e-03    17s
  30   7.40362942e+04  7.50827729e+04  4.75e-04 6.72e-05  3.84e-03    17s
  31   7.40680189e+04  7.49778413e+04  4.52e-04 4.90e-05  3.34e-03    18s
  32   7.42727061e+04  7.49058934e+04  3.00e-04 3.73e-05  2.33e-03    18s
  33   7.45148021e+04  7.48214047e+04  1.21e-04 2.17e-05  1.13e-03    18s
  34   7.46054840e+04  7.47604264e+04  5.74e-05 1.11e-05  5.69e-04    18s
  35   7.46166374e+04  7.47486900e+04  4.97e-05 9.17e-06  4.85e-04    19s
  36   7.46366015e+04  7.47324393e+04  3.68e-05 6.40e-06  3.52e-04    19s
  37   7.46384412e+04  7.47272740e+04  3.56e-05 5.52e-06  3.26e-04    19s
  38   7.46666993e+04  7.47100505e+04  1.67e-05 2.46e-06  1.59e-04    19s
  39   7.46883828e+04  7.46976522e+04  3.26e-06 1.24e-06  3.41e-05    19s
  40   7.46925275e+04  7.46949491e+04  8.41e-07 2.07e-07  8.90e-06    20s
  41   7.46941572e+04  7.46942264e+04  1.83e-08 5.51e-09  2.55e-07    20s
  42   7.46942088e+04  7.46942088e+04  7.78e-10 1.06e-09  2.55e-10    20s

Barrier solved model in 42 iterations and 20.04 seconds (14.08 work units)
Optimal objective 7.46942088e+04


Root crossover log...

  134491 DPushes remaining with DInf 0.0000000e+00                20s
    3228 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                26s

    2807 PPushes remaining with PInf 2.9529351e-05                26s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.5801716e-01     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   61344    7.4694209e+04   0.000000e+00   3.580172e-01     27s
   61350    7.4694209e+04   0.000000e+00   0.000000e+00     27s
   61350    7.4694209e+04   0.000000e+00   0.000000e+00     27s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 7.469421e+04, 61350 iterations, 17.05 seconds (19.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 74694.2088    0  140 -183458.76 74694.2088   141%     -   27s
H    0     0                    -94875.18222 74694.2088   179%     -   28s
H    0     0                    -94551.34910 74694.2088   179%     -   28s
H    0     0                    -70663.16425 74694.2088   206%     -   28s
H    0     0                    -69494.91940 74694.2088   207%     -   29s
H    0     0                    -61505.56315 74694.2088   221%     -   29s
H    0     0                    5625.7461847 74694.2088  1228%     -   29s
H    0     0                    7687.1754563 74694.2088   872%     -   30s
H    0     0                    10654.804714 74694.2088   601%     -   30s
H    0     0                    12659.779623 74694.2088   490%     -   30s
H    0     0                    13752.579307 74694.2088   443%     -   30s
H    0     0                    14034.942585 74694.2088   432%     -   30s
H    0     0                    14431.214466 74694.2088   418%     -   30s
     0     0 69021.3226    0  118 14431.2145 69021.3226   378%     -  127s
H    0     0                    19890.324795 69021.1490   247%     -  129s
H    0     0                    20881.872087 69021.1490   231%     -  129s
H    0     0                    25679.856579 69021.1490   169%     -  129s
     0     0 68649.6806    0  228 25679.8566 68649.6806   167%     -  175s
     0     0 68611.4938    0  223 25679.8566 68611.4938   167%     -  183s
     0     0 68580.1696    0  223 25679.8566 68580.1696   167%     -  194s
     0     0 68580.1226    0  223 25679.8566 68580.1226   167%     -  195s
     0     0 65324.0413    0  279 25679.8566 65324.0413   154%     -  318s
H    0     0                    30669.700673 65323.9372   113%     -  319s
H    0     0                    31048.770276 65323.9372   110%     -  320s
H    0     0                    31053.929201 65323.9372   110%     -  320s
H    0     0                    31083.117247 65323.9372   110%     -  320s
H    0     0                    31139.022165 65323.9372   110%     -  320s
H    0     0                    31180.104589 65323.9372   110%     -  320s
H    0     0                    31180.450577 65323.9372   110%     -  320s
H    0     0                    31239.581910 65323.9372   109%     -  320s
H    0     0                    31245.817635 65323.9372   109%     -  320s
H    0     0                    31277.791711 65323.9372   109%     -  320s
     0     0 64345.1430    0  283 31277.7917 64345.1430   106%     -  414s
     0     0 64037.3791    0  302 31277.7917 64037.3791   105%     -  458s
     0     0 63922.5373    0  303 31277.7917 63922.5373   104%     -  494s
     0     0 63830.1918    0  292 31277.7917 63830.1918   104%     -  526s
     0     0 63801.9467    0  293 31277.7917 63801.9467   104%     -  542s
     0     0 63766.1149    0  288 31277.7917 63766.1149   104%     -  553s
     0     0 63757.2713    0  293 31277.7917 63757.2713   104%     -  562s
     0     0 63712.7970    0  301 31277.7917 63712.7970   104%     -  576s
     0     0 63703.1004    0  302 31277.7917 63703.1004   104%     -  588s
     0     0 63699.6775    0  305 31277.7917 63699.6775   104%     -  592s
     0     0 63695.4597    0  305 31277.7917 63695.4597   104%     -  595s
     0     0 63695.1018    0  302 31277.7917 63695.1018   104%     -  597s
     0     0 61496.7297    0  248 31277.7917 61496.7297  96.6%     -  723s
H    0     0                    31578.167890 61496.7056  94.7%     -  724s
H    0     0                    32005.570316 61496.7056  92.1%     -  724s
H    0     0                    32603.255067 61496.7056  88.6%     -  724s
     0     0 60903.5400    0  340 32603.2551 60903.5400  86.8%     -  793s
     0     0 60612.2288    0  334 32603.2551 60612.2288  85.9%     -  855s
     0     0 60403.3199    0  337 32603.2551 60403.3199  85.3%     -  894s
     0     0 60330.5019    0  329 32603.2551 60330.5019  85.0%     -  923s
     0     0 60287.2353    0  336 32603.2551 60287.2353  84.9%     -  939s
     0     0 60280.9328    0  336 32603.2551 60280.9328  84.9%     -  945s
     0     0 60220.1881    0  342 32603.2551 60220.1881  84.7%     -  962s
     0     0 60176.0676    0  348 32603.2551 60176.0676  84.6%     -  984s
     0     0 60168.0631    0  345 32603.2551 60168.0631  84.5%     -  991s
     0     0 60164.2559    0  345 32603.2551 60164.2559  84.5%     -  999s
     0     0 60157.5819    0  343 32603.2551 60157.5819  84.5%     - 1004s
     0     0 60152.3469    0  345 32603.2551 60152.3469  84.5%     - 1009s
     0     0 60128.0865    0  345 32603.2551 60128.0865  84.4%     - 1020s
     0     0 60101.5528    0  351 32603.2551 60101.5528  84.3%     - 1030s
     0     0 60098.0076    0  352 32603.2551 60098.0076  84.3%     - 1037s
     0     0 60094.6464    0  351 32603.2551 60094.6464  84.3%     - 1043s
     0     0 60074.1415    0  349 32603.2551 60074.1415  84.3%     - 1056s
     0     0 60023.9888    0  341 32603.2551 60023.9888  84.1%     - 1073s
     0     0 60003.2215    0  347 32603.2551 60003.2215  84.0%     - 1079s
     0     0 59999.0630    0  344 32603.2551 59999.0630  84.0%     - 1083s
     0     0 59996.8134    0  346 32603.2551 59996.8134  84.0%     - 1086s
     0     0 59993.7169    0  351 32603.2551 59993.7169  84.0%     - 1089s
     0     0 59992.4109    0  345 32603.2551 59992.4109  84.0%     - 1091s
     0     0 58853.7906    0  353 32603.2551 58853.7906  80.5%     - 1174s
H    0     0                    33409.430694 58853.4618  76.2%     - 1176s
     0     0 58532.3805    0  365 33409.4307 58532.3805  75.2%     - 1224s
     0     0 58434.7659    0  357 33409.4307 58434.7659  74.9%     - 1252s
     0     0 58262.9305    0  373 33409.4307 58262.9305  74.4%     - 1292s
     0     0 58226.4086    0  366 33409.4307 58226.4086  74.3%     - 1306s
     0     0 58152.6338    0  377 33409.4307 58152.6338  74.1%     - 1326s
     0     0 58121.2433    0  376 33409.4307 58121.2433  74.0%     - 1337s
     0     0 58106.3945    0  379 33409.4307 58106.3945  73.9%     - 1346s
     0     0 58028.3317    0  372 33409.4307 58028.3317  73.7%     - 1366s
     0     0 58001.8389    0  394 33409.4307 58001.8389  73.6%     - 1377s
     0     0 57984.6058    0  406 33409.4307 57984.6058  73.6%     - 1388s
     0     0 57947.8072    0  421 33409.4307 57947.8072  73.4%     - 1401s
     0     0 57931.9753    0  409 33409.4307 57931.9753  73.4%     - 1407s
     0     0 57919.1069    0  410 33409.4307 57919.1069  73.4%     - 1415s
     0     0 57917.9608    0  416 33409.4307 57917.9608  73.4%     - 1417s
     0     0 57568.8632    0  306 33409.4307 57568.8632  72.3%     - 1445s
H    0     0                    34308.044675 57568.7710  67.8%     - 1446s
H    0     0                    34674.524205 57568.7710  66.0%     - 1447s
H    0     0                    34910.798990 57568.7710  64.9%     - 1447s
     0     0 57499.1158    0  320 34910.7990 57499.1158  64.7%     - 1476s
     0     0 57459.3053    0  373 34910.7990 57459.3053  64.6%     - 1499s
     0     0 57440.1449    0  321 34910.7990 57440.1449  64.5%     - 1509s
     0     0 57430.1467    0  380 34910.7990 57430.1467  64.5%     - 1515s
     0     0 57429.0502    0  324 34910.7990 57429.0502  64.5%     - 1517s
     0     0 57165.9220    0  414 34910.7990 57165.9220  63.7%     - 1545s
     0     0 57128.2072    0  429 34910.7990 57128.2072  63.6%     - 1568s
     0     0 57118.0852    0  387 34910.7990 57118.0852  63.6%     - 1574s
     0     0 57114.0025    0  401 34910.7990 57114.0025  63.6%     - 1580s
     0     0 57111.6758    0  384 34910.7990 57111.6758  63.6%     - 1585s
     0     0 57106.1224    0  402 34910.7990 57106.1224  63.6%     - 1589s
     0     0 57101.0456    0  394 34910.7990 57101.0456  63.6%     - 1593s
     0     0 57099.7458    0  394 34910.7990 57099.7458  63.6%     - 1594s
     0     0 56945.5350    0  402 34910.7990 56945.5350  63.1%     - 1626s
     0     0 56931.1870    0  419 34910.7990 56931.1870  63.1%     - 1639s
     0     0 56925.1074    0  418 34910.7990 56925.1074  63.1%     - 1649s
     0     0 56922.5221    0  379 34910.7990 56922.5221  63.1%     - 1657s
     0     0 56919.7054    0  408 34910.7990 56919.7054  63.0%     - 1661s
     0     0 56918.9655    0  403 34910.7990 56918.9655  63.0%     - 1664s
     0     0 56896.8003    0  419 34910.7990 56896.8003  63.0%     - 1683s
     0     0 56888.2122    0  401 34910.7990 56888.2122  63.0%     - 1696s
     0     0 56885.3304    0  414 34910.7990 56885.3304  62.9%     - 1699s
     0     0 56884.0427    0  401 34910.7990 56884.0427  62.9%     - 1701s
     0     0 56861.3783    0  420 34910.7990 56861.3783  62.9%     - 1714s
H    0     0                    34920.524833 56860.9542  62.8%     - 1715s
     0     0 56856.8786    0  425 34920.5248 56856.8786  62.8%     - 1719s
     0     0 56854.9200    0  415 34920.5248 56854.9200  62.8%     - 1723s
     0     0 56848.0381    0  419 34920.5248 56848.0381  62.8%     - 1733s
H    0     0                    34923.978005 56847.8995  62.8%     - 1736s
     0     0 56842.7705    0  352 34923.9780 56842.7705  62.8%     - 1744s
     0     0 56840.6544    0  418 34923.9780 56840.6544  62.8%     - 1746s
     0     0 56838.0277    0  455 34923.9780 56838.0277  62.7%     - 1757s
H    0     0                    35212.714643 56837.5939  61.4%     - 1758s
H    0     0                    35318.457174 56837.5939  60.9%     - 1758s
     0     0 56836.5165    0  414 35318.4572 56836.5165  60.9%     - 1760s
     0     0 56828.0059    0  417 35318.4572 56828.0059  60.9%     - 1767s
     0     0 56827.6042    0  417 35318.4572 56827.6042  60.9%     - 1773s
H    0     0                    35340.886159 56827.6042  60.8%     - 1882s
H    0     0                    35366.515061 56827.6042  60.7%     - 1882s
H    0     0                    39353.853578 56827.6042  44.4%     - 1976s
H    0     0                    39370.073392 56827.6042  44.3%     - 2006s
H    0     0                    39434.981240 56827.6042  44.1%     - 2006s
H    0     0                    39628.278987 56827.6042  43.4%     - 2006s
H    0     0                    40153.477759 56827.6042  41.5%     - 2014s
H    0     2                    41037.592267 56827.6042  38.5%     - 2229s
     0     2 56827.6042    0  417 41037.5923 56827.6042  38.5%     - 2229s
     1     4 56775.5066    1  385 41037.5923 56826.8815  38.5%  3483 2262s
     3     8 56719.6063    2  433 41037.5923 56775.1681  38.3%  9991 2295s
     7    16 56674.2421    3  397 41037.5923 56719.1590  38.2% 10733 2343s
    15    32 56332.6724    4  380 41037.5923 56667.0241  38.1% 14705 2386s
    31    48 55694.7323    5  331 41037.5923 56346.0452  37.3% 20120 2522s
    47    79 54972.6883    6  364 41037.5923 56346.0452  37.3% 19675 2610s
    78   148 54949.3109    7  365 41037.5923 56346.0452  37.3% 16682 2833s
   147   180 54893.7925   10  343 41037.5923 56346.0452  37.3% 12965 2904s
   179   212 54901.4787    8  357 41037.5923 56346.0452  37.3% 12052 2980s
   211   240 54852.6371   11  337 41037.5923 56346.0452  37.3% 12472 3055s
   239   273 54661.0869   11  338 41037.5923 56346.0452  37.3% 12093 3117s
   272   308 54115.3209    9  334 41037.5923 56346.0452  37.3% 11582 3185s
   307   341 54575.1457   12  340 41037.5923 56346.0452  37.3% 11205 3262s
   340   371 54593.8735   12  339 41037.5923 56346.0452  37.3% 10711 3341s
   370   404 54288.5990   12  336 41037.5923 56346.0452  37.3% 10906 3410s
   403   437 53804.2243   12  332 41037.5923 56346.0452  37.3% 11006 3489s
   436   469 53090.4824   13  311 41037.5923 56346.0452  37.3% 11043 3550s
   468   500 53185.6747   13  291 41037.5923 56346.0452  37.3% 11017 3600s

Cutting planes:
  Learned: 1
  Implied bound: 182
  MIR: 2730
  Flow cover: 3017
  RLT: 38
  Relax-and-lift: 315

Explored 499 nodes (6257239 simplex iterations) in 3600.06 seconds (5172.59 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 41037.6 40153.5 39628.3 ... 35212.7

Time limit reached
Best objective 4.103759226743e+04, best bound 5.634604520402e+04, gap 37.3035%
  WARNING: Time limit reached. Using best solution found (gap: 37.30%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 41037.59, θ = 207202.60
  Upper Bound (UB) = 41037.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 207202.60
  [DEBUG]   ✓ Scenario 0: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 207202.60 ≤ Q = 207202.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 207202.60 ≤ Q = 207202.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 207202.60 ≤ Q = 207202.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 207202.60 ≤ Q = 207202.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 207202.60 ≤ Q = 207202.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 207202.60 ≤ Q = 207202.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 207202.60 ≤ Q = 207202.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 207202.60 ≤ Q = 207202.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 207202.60 ≤ Q = 207202.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5365ad34
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xac9a52cc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.383473e+13
Presolve removed 2596 rows and 1887 columns
Presolve time: 0.01s
Presolved: 497 rows, 502 columns, 1402 nonzeros
Found heuristic solution: objective 6199812.7764
Variable types: 342 continuous, 160 integer (160 binary)

Root relaxation: objective -1.931612e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -193161.18    0  124 6199812.78 -193161.18   103%     -    0s
H    0     0                    -159260.5860 -193161.18  21.3%     -    0s
H    0     0                    -160331.2879 -193161.18  20.5%     -    0s
     0     0 -169433.37    0   63 -160331.29 -169433.37  5.68%     -    0s
H    0     0                    -165263.4125 -169320.52  2.45%     -    0s
H    0     0                    -165894.0604 -169320.52  2.07%     -    0s
H    0     0                    -166586.1418 -169320.52  1.64%     -    0s
H    0     0                    -167216.7898 -169320.52  1.26%     -    0s
     0     0 -167948.83    0   54 -167216.79 -167948.83  0.44%     -    0s
H    0     0                    -167230.1694 -167914.28  0.41%     -    0s
     0     0 -167914.28    0   52 -167230.17 -167914.28  0.41%     -    0s
     0     0 -167733.86    0   20 -167230.17 -167733.86  0.30%     -    0s
     0     0 -167688.40    0   19 -167230.17 -167688.40  0.27%     -    0s
     0     0 -167688.40    0   19 -167230.17 -167688.40  0.27%     -    0s
H    0     0                    -167331.6446 -167688.40  0.21%     -    0s
     0     0 -167616.08    0   19 -167331.64 -167616.08  0.17%     -    0s
     0     0 -167606.91    0   17 -167331.64 -167606.91  0.16%     -    0s
     0     0 -167606.91    0   17 -167331.64 -167606.91  0.16%     -    0s
     0     0 -167606.91    0   58 -167331.64 -167606.91  0.16%     -    0s
H    0     0                    -167344.3864 -167606.91  0.16%     -    0s
     0     0 -167479.14    0   13 -167344.39 -167479.14  0.08%     -    0s
H    0     0                    -167371.1731 -167477.89  0.06%     -    0s
H    0     0                    -167377.9562 -167477.89  0.06%     -    0s
     0     0 -167428.45    0    4 -167377.96 -167428.45  0.03%     -    0s
H    0     0                    -167425.0274 -167428.45  0.00%     -    0s
     0     0 -167427.70    0    2 -167425.03 -167427.70  0.00%     -    0s
H    0     0                    -167427.6507 -167427.70  0.00%     -    0s

Explored 1 nodes (782 simplex iterations) in 0.26 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -167428 -167425 -167378 ... -160331

Optimal solution found (tolerance 1.00e-06)
Best objective -1.674276506828e+05, best bound -1.674277044083e+05, gap 0.0000%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 201619.33
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -167427.65
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -167427.65 = 201619.33
  [DEBUG]   Current θ from Master = 207202.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5583.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 35454.32
  Lower Bound (LB) = 39915.15
  Gap (UB-LB) = 1122.4473, Absolute Gap = 1122.4473, Relative Gap = 0.027352
  Not converged yet (gap = 1122.45 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0xa0c7d03f
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134330 rows and 54530 columns (presolve time = 5s)...
Presolve removed 134330 rows and 54530 columns
Presolve time: 5.76s
Presolved: 157563 rows, 66290 columns, 969423 nonzeros
Variable types: 64031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -321001.0107
Found heuristic solution: objective -183458.7557

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.73s

Barrier statistics:
 Dense cols : 651
 AA' NZ     : 8.457e+06
 Factor NZ  : 1.916e+07 (roughly 250 MB of memory)
 Factor Ops : 5.010e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.46036912e+07  3.14503068e+08  2.89e+05 1.76e+01  1.65e+05     9s
   1  -2.76966996e+07  3.60805643e+08  2.10e+05 1.26e+02  1.23e+05     9s
   2  -1.54527544e+07  2.64032967e+08  1.12e+05 1.28e+00  6.82e+04    10s
   3  -2.39357426e+06  1.99093764e+08  1.32e+04 6.76e+00  8.61e+03    10s
   4  -8.55384176e+05  1.15342043e+08  1.75e+03 7.20e-01  1.39e+03    10s
   5  -6.91854200e+05  6.35763975e+07  6.37e+02 3.00e-01  5.50e+02    10s
   6  -6.09285597e+05  4.38215742e+07  2.33e+02 1.86e-01  2.66e+02    10s
   7  -5.57456157e+05  3.65473207e+07  1.21e+02 1.49e-01  1.84e+02    10s
   8  -4.39481819e+05  2.15007976e+07  2.32e+01 7.86e-02  8.48e+01    11s
   9  -2.93282812e+05  1.23021335e+07  2.45e+00 4.64e-02  4.45e+01    11s
  10  -1.97194030e+05  7.01343646e+06  1.40e+00 2.66e-02  2.53e+01    11s
  11  -1.85387603e+05  5.94620917e+06  1.25e+00 2.25e-02  2.15e+01    11s
  12  -1.64222795e+05  3.84817565e+06  1.01e+00 1.46e-02  1.41e+01    11s
  13  -1.20574519e+05  3.35801667e+06  5.79e-01 1.28e-02  1.21e+01    11s
  14  -8.29212360e+04  1.12475643e+06  2.24e-01 4.02e-03  4.21e+00    11s
  15  -3.33748325e+04  3.33774726e+05  9.00e-02 1.11e-03  1.28e+00    12s
  16   4.38251988e+03  2.34921789e+05  4.78e-02 2.85e-03  8.03e-01    12s
  17   2.10930302e+04  1.88209099e+05  3.41e-02 2.44e-03  5.82e-01    12s
  18   2.47719614e+04  1.66849992e+05  3.11e-02 2.00e-03  4.95e-01    12s
  19   3.21002854e+04  1.40411822e+05  2.62e-02 1.45e-03  3.77e-01    12s
  20   4.17361522e+04  1.17770878e+05  1.96e-02 9.59e-04  2.65e-01    13s
  21   4.64254146e+04  1.07871957e+05  1.64e-02 7.49e-04  2.14e-01    13s
  22   4.86745858e+04  1.03295181e+05  1.49e-02 6.48e-04  1.90e-01    13s
  23   5.22872053e+04  9.55770973e+04  1.26e-02 4.79e-04  1.51e-01    13s
  24   5.48799660e+04  9.18403845e+04  1.10e-02 3.96e-04  1.29e-01    14s
  25   5.75441381e+04  8.53055665e+04  9.34e-03 2.49e-04  9.67e-02    14s
  26   6.31114251e+04  8.23848219e+04  6.06e-03 1.81e-04  6.71e-02    14s
  27   6.68444797e+04  7.99680361e+04  3.96e-03 1.38e-04  4.57e-02    14s
  28   6.80471666e+04  7.90931953e+04  3.30e-03 1.16e-04  3.85e-02    15s
  29   6.91062883e+04  7.85775345e+04  2.73e-03 1.03e-04  3.30e-02    15s
  30   7.02739065e+04  7.76172690e+04  2.13e-03 7.71e-05  2.56e-02    15s
  31   7.09648339e+04  7.65860405e+04  1.76e-03 5.68e-05  1.96e-02    15s
  32   7.17928124e+04  7.59687226e+04  1.35e-03 3.41e-05  1.45e-02    15s
  33   7.27847530e+04  7.53616741e+04  8.76e-04 1.71e-05  8.98e-03    16s
  34   7.38312010e+04  7.50027287e+04  3.82e-04 7.48e-06  4.08e-03    16s
  35   7.40731339e+04  7.49497693e+04  2.71e-04 6.15e-06  3.05e-03    16s
  36   7.42192267e+04  7.49027390e+04  2.08e-04 5.01e-06  2.38e-03    16s
  37   7.43098452e+04  7.48684614e+04  1.66e-04 4.15e-06  1.95e-03    17s
  38   7.44386844e+04  7.48241127e+04  1.08e-04 3.05e-06  1.34e-03    17s
  39   7.45683095e+04  7.47611157e+04  4.90e-05 1.55e-06  6.71e-04    17s
  40   7.46118929e+04  7.47365301e+04  3.20e-05 1.53e-06  4.34e-04    17s
  41   7.46372923e+04  7.47292910e+04  2.16e-05 1.26e-06  3.20e-04    17s
  42   7.46475250e+04  7.47178227e+04  1.77e-05 8.31e-07  2.45e-04    18s
  43   7.46560334e+04  7.47092871e+04  1.45e-05 5.45e-07  1.85e-04    18s
  44   7.46846400e+04  7.47032524e+04  3.51e-06 3.48e-07  6.48e-05    18s
  45   7.46918873e+04  7.46957037e+04  7.04e-07 8.85e-08  1.33e-05    18s
  46   7.46940708e+04  7.46944941e+04  5.76e-08 3.45e-08  1.48e-06    19s
  47   7.46942085e+04  7.46942091e+04  4.22e-09 1.86e-10  2.39e-09    19s

Barrier solved model in 47 iterations and 18.76 seconds (16.34 work units)
Optimal objective 7.46942085e+04


Root crossover log...

  142110 DPushes remaining with DInf 0.0000000e+00                19s
   56392 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                25s

   15498 PPushes remaining with PInf 3.2812541e-04                25s
    8225 PPushes remaining with PInf 2.2388202e-04                25s
       0 PPushes remaining with PInf 0.0000000e+00                27s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1961381e+03     27s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   85709    7.4694209e+04   0.000000e+00   3.196138e+03     27s
   85973    7.4694209e+04   0.000000e+00   0.000000e+00     27s
   85973    7.4694209e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 7.469421e+04, 85973 iterations, 20.38 seconds (21.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 74694.2088    0  140 -183458.76 74694.2088   141%     -   28s
H    0     0                    -182421.9981 74694.2088   141%     -   30s
H    0     0                    -158543.8479 74694.2088   147%     -   30s
H    0     0                    -158441.2065 74694.2088   147%     -   30s
H    0     0                    -157921.7754 74694.2088   147%     -   32s
H    0     0                    -157412.9955 74694.2088   147%     -   32s
H    0     0                    -155917.3771 74694.2088   148%     -   32s
H    0     0                    -155904.1706 74694.2088   148%     -   32s
H    0     0                    -155705.3450 74694.2088   148%     -   32s
H    0     0                    -155670.5845 74694.2088   148%     -   32s
H    0     0                    -55346.23775 74694.2088   235%     -   32s
H    0     0                    11874.310775 74694.2088   529%     -   34s
H    0     0                    27355.591312 74694.2088   173%     -   34s
     0     0 68994.6750    0  181 27355.5913 68994.6750   152%     -  183s
H    0     0                    27616.259936 68994.6648   150%     -  185s
H    0     0                    27817.864622 68994.6648   148%     -  185s
     0     0 68718.0775    0  187 27817.8646 68718.0775   147%     -  264s
     0     0 68554.5463    0  219 27817.8646 68554.5463   146%     -  303s
     0     0 68481.8631    0  200 27817.8646 68481.8631   146%     -  322s
     0     0 68451.9654    0  204 27817.8646 68451.9654   146%     -  338s
     0     0 68101.2654    0  193 27817.8646 68101.2654   145%     -  365s
     0     0 68086.0518    0  189 27817.8646 68086.0518   145%     -  370s
     0     0 68061.8515    0  200 27817.8646 68061.8515   145%     -  375s
     0     0 68061.5654    0  200 27817.8646 68061.5654   145%     -  376s
     0     0 65036.6669    0  294 27817.8646 65036.6669   134%     -  494s
H    0     0                    28917.021634 65036.4223   125%     -  495s
H    0     0                    29141.317755 65036.4223   123%     -  495s
     0     0 63891.4531    0  293 29141.3178 63891.4531   119%     -  580s
     0     0 63810.4948    0  314 29141.3178 63810.4948   119%     -  611s
     0     0 63562.2330    0  312 29141.3178 63562.2330   118%     -  667s
     0     0 63450.0094    0  303 29141.3178 63450.0094   118%     -  697s
     0     0 63414.8778    0  300 29141.3178 63414.8778   118%     -  715s
     0     0 63267.8673    0  305 29141.3178 63267.8673   117%     -  744s
     0     0 63122.7879    0  308 29141.3178 63122.7879   117%     -  767s
     0     0 63088.1102    0  305 29141.3178 63088.1102   116%     -  780s
     0     0 63037.1207    0  311 29141.3178 63037.1207   116%     -  791s
     0     0 63021.9425    0  299 29141.3178 63021.9425   116%     -  801s
     0     0 63011.3801    0  309 29141.3178 63011.3801   116%     -  807s
     0     0 63010.0775    0  310 29141.3178 63010.0775   116%     -  808s
     0     0 63009.7417    0  309 29141.3178 63009.7417   116%     -  809s
     0     0 60882.5496    0  317 29141.3178 60882.5496   109%     -  946s
H    0     0                    31860.216932 60882.2564  91.1%     -  948s
H    0     0                    31960.638963 60882.2564  90.5%     -  948s
     0     0 60189.3410    0  368 31960.6390 60189.3410  88.3%     - 1030s
     0     0 59866.9318    0  368 31960.6390 59866.9318  87.3%     - 1077s
     0     0 59541.5358    0  361 31960.6390 59541.5358  86.3%     - 1120s
     0     0 59471.6240    0  379 31960.6390 59471.6240  86.1%     - 1149s
     0     0 59374.2101    0  366 31960.6390 59374.2101  85.8%     - 1169s
     0     0 59353.8928    0  380 31960.6390 59353.8928  85.7%     - 1178s
     0     0 59339.3460    0  371 31960.6390 59339.3460  85.7%     - 1188s
     0     0 59332.2892    0  373 31960.6390 59332.2892  85.6%     - 1192s
     0     0 59324.1575    0  366 31960.6390 59324.1575  85.6%     - 1196s
     0     0 59322.0975    0  369 31960.6390 59322.0975  85.6%     - 1198s
     0     0 59320.8366    0  374 31960.6390 59320.8366  85.6%     - 1199s
     0     0 58418.0428    0  393 31960.6390 58418.0428  82.8%     - 1289s
     0     0 58084.7385    0  370 31960.6390 58084.7385  81.7%     - 1336s
     0     0 58022.7534    0  384 31960.6390 58022.7534  81.5%     - 1353s
     0     0 57941.7216    0  392 31960.6390 57941.7216  81.3%     - 1375s
     0     0 57867.8785    0  395 31960.6390 57867.8785  81.1%     - 1389s
     0     0 57854.8205    0  388 31960.6390 57854.8205  81.0%     - 1399s
     0     0 57817.3629    0  381 31960.6390 57817.3629  80.9%     - 1415s
     0     0 57804.5929    0  408 31960.6390 57804.5929  80.9%     - 1421s
     0     0 57768.7503    0  394 31960.6390 57768.7503  80.7%     - 1435s
     0     0 57753.9488    0  388 31960.6390 57753.9488  80.7%     - 1441s
     0     0 57751.6355    0  420 31960.6390 57751.6355  80.7%     - 1447s
     0     0 57745.1783    0  387 31960.6390 57745.1783  80.7%     - 1451s
     0     0 57740.9229    0  386 31960.6390 57740.9229  80.7%     - 1455s
     0     0 57723.6902    0  386 31960.6390 57723.6902  80.6%     - 1460s
     0     0 57721.6535    0  381 31960.6390 57721.6535  80.6%     - 1464s
     0     0 57517.2350    0  391 31960.6390 57517.2350  80.0%     - 1488s
H    0     0                    32105.291171 57515.2840  79.1%     - 1491s
H    0     0                    32173.353354 57515.2840  78.8%     - 1491s
H    0     0                    32174.432439 57515.2840  78.8%     - 1491s
H    0     0                    32371.896872 57515.2840  77.7%     - 1491s
     0     0 57416.8988    0  383 32371.8969 57416.8988  77.4%     - 1511s
     0     0 57393.1358    0  425 32371.8969 57393.1358  77.3%     - 1523s
     0     0 57382.6218    0  388 32371.8969 57382.6218  77.3%     - 1532s
     0     0 57374.6243    0  390 32371.8969 57374.6243  77.2%     - 1539s
     0     0 57372.4377    0  380 32371.8969 57372.4377  77.2%     - 1543s
     0     0 57369.2581    0  388 32371.8969 57369.2581  77.2%     - 1546s
     0     0 57367.3248    0  427 32371.8969 57367.3248  77.2%     - 1551s
     0     0 57212.8966    0  397 32371.8969 57212.8966  76.7%     - 1577s
H    0     0                    39168.995571 57212.8836  46.1%     - 1590s
     0     0 57189.8059    0  389 39168.9956 57189.8059  46.0%     - 1602s
     0     0 57173.5979    0  396 39168.9956 57173.5979  46.0%     - 1615s
     0     0 57168.2992    0  397 39168.9956 57168.2992  46.0%     - 1621s
     0     0 57161.2587    0  402 39168.9956 57161.2587  45.9%     - 1627s
     0     0 57160.2042    0  399 39168.9956 57160.2042  45.9%     - 1630s
     0     0 57133.6046    0  398 39168.9956 57133.6046  45.9%     - 1647s
H    0     0                    39664.267074 57133.5779  44.0%     - 1648s
H    0     0                    39826.794579 57133.5779  43.5%     - 1648s
     0     0 57124.5493    0  431 39826.7946 57124.5493  43.4%     - 1661s
     0     0 57119.2927    0  381 39826.7946 57119.2927  43.4%     - 1669s
     0     0 57115.8516    0  392 39826.7946 57115.8516  43.4%     - 1674s
     0     0 57109.1530    0  392 39826.7946 57109.1530  43.4%     - 1681s
     0     0 57107.6171    0  388 39826.7946 57107.6171  43.4%     - 1686s
     0     0 57034.0669    0  387 39826.7946 57034.0669  43.2%     - 1711s
     0     0 57029.5697    0  401 39826.7946 57029.5697  43.2%     - 1725s
     0     0 57024.2079    0  401 39826.7946 57024.2079  43.2%     - 1729s
     0     0 57021.0873    0  394 39826.7946 57021.0873  43.2%     - 1735s
     0     0 57015.5632    0  390 39826.7946 57015.5632  43.2%     - 1739s
     0     0 57014.1509    0  390 39826.7946 57014.1509  43.2%     - 1741s
     0     0 57007.4007    0  404 39826.7946 57007.4007  43.1%     - 1751s
     0     0 56981.4065    0  400 39826.7946 56981.4065  43.1%     - 1763s
     0     0 56973.8312    0  406 39826.7946 56973.8312  43.1%     - 1769s
     0     0 56972.6780    0  407 39826.7946 56972.6780  43.1%     - 1771s
     0     0 56967.5127    0  393 39826.7946 56967.5127  43.0%     - 1779s
H    0     0                    39830.524929 56967.0634  43.0%     - 1825s
H    0     0                    39955.612294 56967.0634  42.6%     - 1828s
     0     0 56962.5056    0  391 39955.6123 56962.5056  42.6%     - 1834s
     0     0 56959.9997    0  389 39955.6123 56959.9997  42.6%     - 1838s
     0     0 56959.7194    0  391 39955.6123 56959.7194  42.6%     - 1839s
     0     0 56956.7259    0  396 39955.6123 56956.7259  42.6%     - 1846s
     0     0 56955.9412    0  389 39955.6123 56955.9412  42.5%     - 1849s
     0     0 56954.2937    0  387 39955.6123 56954.2937  42.5%     - 1854s
     0     0 56948.2820    0  392 39955.6123 56948.2820  42.5%     - 1858s
     0     0 56947.0572    0  391 39955.6123 56947.0572  42.5%     - 1860s
     0     0 56942.5467    0  394 39955.6123 56942.5467  42.5%     - 1867s
     0     0 56942.4602    0  394 39955.6123 56942.4602  42.5%     - 1873s
H    0     0                    40002.660692 56942.4602  42.3%     - 2240s
     0     2 56942.4602    0  394 40002.6607 56942.4602  42.3%     - 2255s
     1     3 56302.0286    1  361 40002.6607 56942.0481  42.3% 18843 2306s
     2     4 56585.9893    1  437 40002.6607 56585.9893  41.5% 21576 2376s
     3     6 56381.5694    2  410 40002.6607 56585.8984  41.5% 19456 2420s
     5    12 56016.8442    3  323 40002.6607 56585.8984  41.5% 15897 2463s
    11    24 55676.5984    4  329 40002.6607 56175.9121  40.4% 14924 2501s
    23    36 54346.7204    5  376 40002.6607 56058.5168  40.1% 22122 2616s
    35    66 53299.3392    6  327 40002.6607 56058.5168  40.1% 28562 3600s
H   39    66                    40040.166774 56058.5168  40.0% 27384 3600s

Cutting planes:
  Learned: 4
  Implied bound: 185
  MIR: 2352
  Flow cover: 2611
  RLT: 41
  Relax-and-lift: 343

Explored 65 nodes (2897631 simplex iterations) in 3600.24 seconds (4152.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 40040.2 40002.7 39955.6 ... 32173.4

Time limit reached
Best objective 4.004016677424e+04, best bound 5.577363989792e+04, gap 39.2942%
  WARNING: Time limit reached. Using best solution found (gap: 39.29%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.28s
  Master Objective (UB) = 40040.17, θ = 207798.80
  Upper Bound (UB) = 40040.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 207798.80
  [DEBUG]   ✓ Scenario 0: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 207798.80 ≤ Q = 207798.80 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 207798.80 ≤ Q = 207798.80 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x58956ff9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa76a9007
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.391096e+13
Presolve removed 2597 rows and 1888 columns
Presolve time: 0.01s
Presolved: 496 rows, 501 columns, 1401 nonzeros
Found heuristic solution: objective 6213764.2934
Variable types: 341 continuous, 160 integer (160 binary)

Root relaxation: objective -1.938025e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -193802.50    0  128 6213764.29 -193802.50   103%     -    0s
H    0     0                    -157289.2319 -193802.50  23.2%     -    0s
H    0     0                    -158163.1552 -193802.50  22.5%     -    0s
     0     0 -171396.48    0   55 -158163.16 -171396.48  8.37%     -    0s
H    0     0                    -169463.3524 -171315.68  1.09%     -    0s
H    0     0                    -170385.9470 -171310.70  0.54%     -    0s
     0     0 -171310.70    0   54 -170385.95 -171310.70  0.54%     -    0s
H    0     0                    -170735.1335 -171310.70  0.34%     -    0s
     0     0 -170950.35    0   30 -170735.13 -170950.35  0.13%     -    0s
     0     0 -170910.23    0   23 -170735.13 -170910.23  0.10%     -    0s
     0     0 -170909.94    0   15 -170735.13 -170909.94  0.10%     -    0s
     0     0 -170878.96    0   14 -170735.13 -170878.96  0.08%     -    0s
     0     0 -170811.51    0   13 -170735.13 -170811.51  0.04%     -    0s
     0     0 -170811.51    0   23 -170735.13 -170811.51  0.04%     -    0s
     0     0 -170802.46    0    9 -170735.13 -170802.46  0.04%     -    0s
H    0     0                    -170746.0917 -170798.04  0.03%     -    0s
H    0     0                    -170753.8810 -170783.38  0.02%     -    0s
     0     0 -170783.38    0    4 -170753.88 -170783.38  0.02%     -    0s
H    0     0                    -170780.4561 -170783.38  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 4
  MIR: 15
  Flow cover: 8
  Relax-and-lift: 3

Explored 1 nodes (644 simplex iterations) in 0.22 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -170780 -170754 -170746 ... 6.21376e+06
No other solutions better than -170780

Optimal solution found (tolerance 1.00e-06)
Best objective -1.707804560934e+05, best bound -1.707804560934e+05, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 198266.52
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -170780.46
  [DEBUG]   S×d_nominal = 369046.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 369046.98 + -170780.46 = 198266.52
  [DEBUG]   Current θ from Master = 207798.80
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9532.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30507.89
  Lower Bound (LB) = 39915.15
  Gap (UB-LB) = 125.0218, Absolute Gap = 125.0218, Relative Gap = 0.003122
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 19
Total Time: 55521.37s
Converged: True
Final Lower Bound: 39915.1450
Final Upper Bound: 40040.1668
Final Gap: 125.021765
Number of Critical Scenarios: 19
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 2, 3, 6, 7] (5/10)
Active Routes (Plant→DC): 14
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 19
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-04 01:10:46
Total Time: 55521.37s
Optimal Value: 39915.15
Lower Bound: 39915.15
Upper Bound: 40040.17
Gap: 125.021765
Plants Opened: {0: [1], 1: [1], 2: [0]} (3 plants)
DCs Opened: [0, 2, 3, 6, 7] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed14_HD_gamma20_20260104_011046.csv

Total Execution Time: 55521.84 seconds
End Time: 2026-01-04 01:10:46

All tasks completed successfully!

