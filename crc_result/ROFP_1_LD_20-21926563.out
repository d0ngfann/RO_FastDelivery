
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 1
DI Scenario: LD
Start Time: 2026-01-03 10:33:23
================================================================================
Loading data from data/DH_data_full_seed1.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.049', '1.100'] (k=0.118)
  Product 1: ['1.000', '1.031', '1.062'] (k=0.074)
  Product 2: ['1.000', '1.086', '1.180'] (k=0.205)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1048, max=1594
  DC capacity (MC): min=421, max=847

Demand Structure (s_rk matrix):
  Total customer-product pairs: 72/150 (52.0% sparse)
  Average products per customer: 1.44

Demand (only non-zero entries):
  Nominal (μ): min=8.40, max=34.85, count=72
  Deviation (μ̂): min=4.14, max=9.90

Costs:
  Plant fixed cost: min=5206, max=9604
  DC fixed cost: min=3061, max=5976
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.366', '1.865'] (k=0.769)
    Product 1: ['1.000', '1.358', '1.845'] (k=0.755)
    Product 2: ['1.000', '1.346', '1.811'] (k=0.732)
  MD:
    Product 0: ['1.000', '1.213', '1.472'] (k=0.477)
    Product 1: ['1.000', '1.148', '1.319'] (k=0.341)
    Product 2: ['1.000', '1.175', '1.382'] (k=0.399)
  LD:
    Product 0: ['1.000', '1.049', '1.100'] (k=0.118)
    Product 1: ['1.000', '1.031', '1.062'] (k=0.074)
    Product 2: ['1.000', '1.086', '1.180'] (k=0.205)
  Mixed:
    Product 0: ['1.000', '1.366', '1.865'] (k=0.769)
    Product 1: ['1.000', '1.148', '1.319'] (k=0.341)
    Product 2: ['1.000', '1.086', '1.180'] (k=0.205)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48726 nonzeros
Model fingerprint: 0x52d8f33a
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 12199 rows and 3199 columns
Presolve time: 0.06s
Presolved: 4474 rows, 5301 columns, 31241 nonzeros
Variable types: 3042 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -334411.3745
Found heuristic solution: objective -165265.7005

Root relaxation: objective 4.043370e+04, 4558 iterations, 0.15 seconds (0.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 40433.6976    0  594 -165265.70 40433.6976   124%     -    0s
H    0     0                    -148618.4134 40433.6976   127%     -    0s
     0     0 38366.0883    0  878 -148618.41 38366.0883   126%     -    0s
     0     0 38339.6219    0  878 -148618.41 38339.6219   126%     -    0s
     0     0 38338.5137    0  882 -148618.41 38338.5137   126%     -    0s
     0     0 38338.5079    0  882 -148618.41 38338.5079   126%     -    0s
H    0     0                    -133778.3895 35342.6700   126%     -    1s
     0     0 35342.6700    0 1097 -133778.39 35342.6700   126%     -    1s
H    0     0                    -133622.0985 35342.6700   126%     -    1s
     0     0 34575.8998    0 1096 -133622.10 34575.8998   126%     -    1s
     0     0 34575.8998    0 1201 -133622.10 34575.8998   126%     -    1s
     0     0 34575.8998    0 1205 -133622.10 34575.8998   126%     -    1s
H    0     0                    -126611.5395 34036.5369   127%     -    2s
H    0     0                    -124509.0998 34036.5369   127%     -    2s
H    0     0                    -76204.23095 33001.1094   143%     -    2s
H    0     0                    6206.9446453 33001.1094   432%     -    2s
H    0     0                    6387.0530083 33001.1094   417%     -    2s
H    0     0                    6394.4626410 33001.1094   416%     -    2s
     0     0 33001.1094    0 1067 6394.46264 33001.1094   416%     -    2s
     0     0 32946.7707    0 1067 6394.46264 32946.7707   415%     -    2s
     0     2 32946.7707    0 1067 6394.46264 32946.7707   415%     -    2s
    15    32 31322.3076    4  973 6394.46264 32674.0554   411%  1361    5s
H  480   480                    6503.3921382 30697.5221   372%   484    8s
H  871   955                    6818.2309063 30110.7866   342%   316    9s
H  877   955                    6853.6431952 30110.7866   339%   314    9s
H  890   955                    6925.9890283 30110.7866   335%   311    9s
H 1128  1111                    7021.4422858 30034.9326   328%   271    9s
H 1138  1111                    7213.0983187 30034.9326   316%   270    9s
H 1167  1111                    7229.2491133 30034.9326   315%   269    9s
H 1344  1316                    7229.9171024 28952.6538   300%   249   10s
H 1345  1316                    7524.9884834 28952.6538   285%   249   10s
H 1589  1584                    7556.8418685 28952.6538   283%   229   10s
H 1606  1584                    7625.4941812 28952.6538   280%   229   10s
H 1641  1584                    7656.0230881 28952.6538   278%   226   10s
H 2222  2134                    7656.1659074 28952.6538   278%   191   11s
H 2241  2134                    7660.6321683 28952.6538   278%   190   11s
H 2263  2134                    7663.4353641 28952.6538   278%   189   11s
H 3480  2950                    7766.5405498 28354.9948   265%   151   15s
  3484  2953 14597.6980   15  526 7766.54055 14597.6980  88.0%   151   20s
H 3493  2810                    7787.0137206 11536.6489  48.2%   151   23s
H 3493  2670                    7909.4037153 11536.6489  45.9%   151   23s
H 3494  2537                    7911.7575994 11383.8443  43.9%   151   24s
H 3494  2410                    7915.3076910 11383.8443  43.8%   151   24s
H 3497  2291                    7977.5200764 11053.3031  38.6%   151   25s
H 3497  2176                    8010.8233738 11053.3031  38.0%   151   25s
  3601  2158     cutoff   17      8010.82337 9872.94961  23.2%   159   30s
H 3738  1999                    8017.1601012 8845.50152  10.3%   157   31s

Cutting planes:
  Gomory: 4
  Implied bound: 13
  Projected implied bound: 60
  MIR: 122
  Flow cover: 358
  Zero half: 3
  RLT: 19
  Relax-and-lift: 129

Explored 3838 nodes (603703 simplex iterations) in 31.56 seconds (65.82 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 8017.16 8010.82 7977.52 ... 7660.63

Optimal solution found (tolerance 1.00e-06)
Best objective 8.017160101167e+03, best bound 8.017160101167e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 31.57s
  Master Objective (UB) = 8017.16, θ = 119375.79
  Upper Bound (UB) = 8017.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119375.79
  [DEBUG]   ✓ Scenario 0: θ = 119375.79 ≤ Q = 119375.79 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xaa0d864
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0aa0d864
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-01, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6964397.5464
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.008126e+05, 213 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -100812.61    0  122 6964397.55 -100812.61   101%     -    0s
H    0     0                    -71636.15628 -100812.61  40.7%     -    0s
H    0     0                    -72577.50501 -100812.61  38.9%     -    0s
*    0     0               0    -73714.81121 -73714.811  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 194

Explored 1 nodes (336 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -73714.8 -72577.5 -71636.2 ... 1.42686e+13
No other solutions better than -73714.8

Optimal solution found (tolerance 1.00e-06)
Best objective -7.371481121217e+04, best bound -7.371481121217e+04, gap 0.0000%
  Subproblem solved in 0.02s
  Worst-case operational profit (Z_SP) = 84434.42
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -73714.81
  [DEBUG]   S×d_nominal = 158149.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 158149.23 + -73714.81 = 84434.42
  [DEBUG]   Current θ from Master = 119375.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 34941.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26924.21
  Lower Bound (LB) = -26924.21
  Gap (UB-LB) = 34941.3725, Absolute Gap = 34941.3725, Relative Gap = 4.358323
  Not converged yet (gap = 34941.37 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91933 nonzeros
Model fingerprint: 0x1653304b
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -26924.2 (0.01s)
MIP start from previous solve produced solution with objective -26924.2 (0.01s)
Loaded MIP start from previous solve with objective -26924.2

Presolve removed 15757 rows and 6396 columns
Presolve time: 0.24s
Presolved: 16206 rows, 8344 columns, 89438 nonzeros
Variable types: 6085 continuous, 2259 integer (2259 binary)

Root relaxation: objective -2.153071e+03, 10856 iterations, 1.71 seconds (3.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -2153.0708    0  607 -26924.212 -2153.0708  92.0%     -    2s
H    0     0                    -25330.83825 -2153.0708  91.5%     -    2s
H    0     0                    -24862.82285 -2153.0708  91.3%     -    2s
H    0     0                    -24860.41759 -2153.0708  91.3%     -    2s
H    0     0                    -24847.56638 -2153.0708  91.3%     -    2s
H    0     0                    -24846.13965 -2153.0708  91.3%     -    2s
H    0     0                    -24827.24217 -2153.0708  91.3%     -    2s
H    0     0                    -24568.06229 -9379.1987  61.8%     -    3s
H    0     0                    -24452.68417 -9379.1987  61.6%     -    3s
     0     0 -9379.1987    0  929 -24452.684 -9379.1987  61.6%     -    4s
     0     0 -9451.6564    0  945 -24452.684 -9451.6564  61.3%     -    4s
     0     0 -9454.6268    0  946 -24452.684 -9454.6268  61.3%     -    4s
     0     0 -9455.0192    0  946 -24452.684 -9455.0192  61.3%     -    4s
H    0     0                    -24096.59109 -9455.0192  60.8%     -    4s
H    0     0                    -24015.66790 -9455.0192  60.6%     -    4s
H    0     0                    -23963.95635 -9455.0192  60.5%     -    4s
H    0     0                    -23824.03676 -13558.614  43.1%     -    6s
     0     0 -13558.614    0  854 -23824.037 -13558.614  43.1%     -    6s
     0     0 -13997.133    0  862 -23824.037 -13997.133  41.2%     -    7s
     0     0 -14016.203    0  854 -23824.037 -14016.203  41.2%     -    7s
     0     0 -14019.601    0  871 -23824.037 -14019.601  41.2%     -    7s
H    0     0                    -23806.94627 -14019.601  41.1%     -    9s
     0     0 -15527.352    0  889 -23806.946 -15527.352  34.8%     -   11s
H    0     0                    -23596.87244 -15528.189  34.2%     -   11s
H    0     0                    -23588.83842 -15528.189  34.2%     -   11s
     0     0 -15916.226    0  985 -23588.838 -15916.226  32.5%     -   12s
     0     0 -15942.088    0 1006 -23588.838 -15942.088  32.4%     -   12s
     0     0 -15953.001    0 1005 -23588.838 -15953.001  32.4%     -   12s
     0     0 -15953.777    0 1017 -23588.838 -15953.777  32.4%     -   12s
H    0     0                    -23586.29017 -15953.777  32.4%     -   14s
H    0     0                    -23564.02896 -16764.960  28.9%     -   16s
H    0     0                    -23546.93847 -16764.960  28.8%     -   16s
     0     0 -16764.960    0  979 -23546.938 -16764.960  28.8%     -   16s
     0     0 -16877.227    0  978 -23546.938 -16877.227  28.3%     -   17s
     0     0 -16899.073    0 1079 -23546.938 -16899.073  28.2%     -   17s
     0     0 -16904.168    0 1093 -23546.938 -16904.168  28.2%     -   18s
     0     0 -17120.046    0  874 -23546.938 -17120.046  27.3%     -   19s
     0     0 -17147.786    0  779 -23546.938 -17147.786  27.2%     -   20s
     0     0 -17159.761    0  763 -23546.938 -17159.761  27.1%     -   20s
     0     0 -17165.176    0  674 -23546.938 -17165.176  27.1%     -   20s
     0     0 -17244.591    0  845 -23546.938 -17244.591  26.8%     -   21s
     0     0 -17256.338    0  564 -23546.938 -17256.338  26.7%     -   22s
     0     0 -17257.856    0  841 -23546.938 -17257.856  26.7%     -   22s
     0     0 -17341.243    0  867 -23546.938 -17341.243  26.4%     -   23s
     0     0 -17352.283    0  794 -23546.938 -17352.283  26.3%     -   23s
     0     0 -17361.576    0  797 -23546.938 -17361.576  26.3%     -   23s
     0     0 -17362.149    0  809 -23546.938 -17362.149  26.3%     -   23s
     0     0 -17374.454    0  789 -23546.938 -17374.454  26.2%     -   24s
     0     0 -17376.543    0  777 -23546.938 -17376.543  26.2%     -   24s
     0     0 -17406.503    0  786 -23546.938 -17406.503  26.1%     -   25s
     0     0 -17407.643    0  786 -23546.938 -17407.643  26.1%     -   25s
     0     2 -17407.647    0  786 -23546.938 -17407.647  26.1%     -   30s
    31    46 -22121.568    5  629 -23546.938 -18369.528  22.0%  1076   35s
   694    88 -22165.026   16  302 -23546.938 -19414.937  17.5%   266   40s
H 1905   635                    -23521.55423 -21712.869  7.69%   168   42s
H 1921   635                    -23443.41824 -21712.869  7.38%   167   42s
H 1957   635                    -23393.10302 -21712.869  7.18%   165   42s
H 4893  1665                    -23391.43403 -22710.830  2.91%  84.8   44s
H 4893  1662                    -23390.01950 -22710.830  2.90%  84.8   44s
H 4893  1634                    -23372.07224 -22710.830  2.83%  84.8   45s
  4894  1626 -23170.947   48  786 -23372.072 -22710.830  2.83%  84.8   54s
H 4895  1545                    -23369.00718 -22710.830  2.82%  84.8   56s
H 4895  1468                    -23358.01936 -22710.830  2.77%  84.8   56s
H 4897  1395                    -23348.46593 -22710.830  2.73%  84.8   60s
H 4900  1327                    -23347.50868 -22710.830  2.73%  84.7   62s
H 4901  1262                    -23347.49683 -22710.830  2.73%  84.7   63s
  4903  1263 -23048.336   40  761 -23347.497 -22710.830  2.73%  84.7   65s
  4908  1266 -22965.960   40  660 -23347.497 -22710.830  2.73%  84.6   70s
H 4909  1203                    -23346.48231 -22710.830  2.72%  84.5   76s
  4925  1212 -22710.830   13  590 -23346.482 -22710.830  2.72%  95.1   80s
H 4941  1147                    -23337.79181 -22710.830  2.69%  96.6   80s
  5032  1108 -22710.830   22  366 -23337.792 -22710.830  2.69%   102   85s
H 5983  1105                    -23324.86131 -23221.960  0.44%  88.8   88s
H 6883   947                    -23324.26578 -23247.652  0.33%  77.9   88s
H 7065   878                    -23322.94701 -23257.259  0.28%  76.0   88s

Cutting planes:
  Gomory: 6
  MIR: 193
  Flow cover: 563
  Zero half: 22
  RLT: 2
  Relax-and-lift: 35

Explored 12150 nodes (611767 simplex iterations) in 89.82 seconds (200.67 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -23322.9 -23324.3 -23324.9 ... -23372.1
No other solutions better than -23322.9

Optimal solution found (tolerance 1.00e-06)
Best objective -2.332294700780e+04, best bound -2.332294700780e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 89.83s
  Master Objective (UB) = -23322.95, θ = 81424.38
  Upper Bound (UB) = -23322.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 81424.38
  [DEBUG]   ✓ Scenario 0: θ = 81424.38 ≤ Q = 81424.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 81424.38 ≤ Q = 81424.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7cdbb0ca
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x83244f36
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.235509e+13
Presolve removed 2669 rows and 1964 columns
Presolve time: 0.00s
Presolved: 424 rows, 425 columns, 1160 nonzeros
Found heuristic solution: objective 6027686.9218
Variable types: 285 continuous, 140 integer (140 binary)

Root relaxation: objective -1.051921e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -105192.06    0  121 6027686.92 -105192.06   102%     -    0s
H    0     0                    -65673.27414 -105192.06  60.2%     -    0s
H    0     0                    -67171.67378 -105192.06  56.6%     -    0s
H    0     0                    -96704.39357 -105192.06  8.78%     -    0s
     0     0 -97971.015    0  108 -96704.394 -97971.015  1.31%     -    0s
H    0     0                    -97012.01673 -97966.612  0.98%     -    0s
     0     0 -97885.609    0  110 -97012.017 -97885.609  0.90%     -    0s
     0     0 -97497.172    0  100 -97012.017 -97497.172  0.50%     -    0s
     0     0 -97180.473    0   43 -97012.017 -97180.473  0.17%     -    0s
     0     0 -97137.395    0   26 -97012.017 -97137.395  0.13%     -    0s
     0     0 -97097.397    0   16 -97012.017 -97097.397  0.09%     -    0s
     0     0 -97059.335    0    9 -97012.017 -97059.335  0.05%     -    0s
     0     0 -97026.559    0    3 -97012.017 -97026.559  0.01%     -    0s
     0     0 -97017.229    0    2 -97012.017 -97017.229  0.01%     -    0s
     0     0     cutoff    0      -97012.017 -97012.017  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 44
  RLT: 148
  Relax-and-lift: 22
  BQP: 17

Explored 1 nodes (653 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 6: -97012 -96704.4 -67171.7 ... 1.23551e+13
No other solutions better than -97012

Optimal solution found (tolerance 1.00e-06)
Best objective -9.701201672828e+04, best bound -9.701201672828e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 58894.65
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -97012.02
  [DEBUG]   S×d_nominal = 155906.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 155906.66 + -97012.02 = 58894.65
  [DEBUG]   Current θ from Master = 81424.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22529.74 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -45852.68
  Lower Bound (LB) = -26924.21
  Gap (UB-LB) = 3601.2654, Absolute Gap = 3601.2654, Relative Gap = 0.154409
  Not converged yet (gap = 3601.27 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135140 nonzeros
Model fingerprint: 0x07f2b9c5
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -45852.7 (0.02s)
Loaded MIP start from previous solve with objective -45852.7

Presolve removed 23634 rows and 9594 columns
Presolve time: 0.29s
Presolved: 23619 rows, 11386 columns, 131849 nonzeros
Variable types: 9127 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.17s

Solved with dual simplex

Root relaxation: objective -3.888310e+03, 13881 iterations, 2.34 seconds (5.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -3888.3102    0  501 -45852.683 -3888.3102  91.5%     -    2s
H    0     0                    -39207.97775 -3888.3102  90.1%     -    2s
H    0     0                    -38420.37189 -3888.3102  89.9%     -    2s
H    0     0                    -37233.42106 -3888.3102  89.6%     -    2s
H    0     0                    -36439.16455 -3888.3102  89.3%     -    3s
H    0     0                    -36437.08056 -3888.3102  89.3%     -    3s
H    0     0                    -35906.39072 -3888.3102  89.2%     -    3s
     0     0 -10088.367    0  876 -35906.391 -10088.367  71.9%     -    5s
H    0     0                    -35879.44867 -10093.304  71.9%     -    5s
H    0     0                    -35869.23631 -10093.304  71.9%     -    5s
H    0     0                    -35794.39326 -10093.304  71.8%     -    5s
H    0     0                    -35791.04465 -10093.304  71.8%     -    5s
     0     0 -10205.353    0  939 -35791.045 -10205.353  71.5%     -    5s
     0     0 -10218.216    0  938 -35791.045 -10218.216  71.5%     -    6s
     0     0 -10219.607    0  886 -35791.045 -10219.607  71.4%     -    6s
H    0     0                    -32193.14159 -15105.320  53.1%     -   10s
H    0     0                    -31903.55871 -15105.320  52.7%     -   10s
H    0     0                    -31871.03038 -15105.320  52.6%     -   10s
H    0     0                    -31805.11657 -15105.320  52.5%     -   10s
H    0     0                    -27565.35700 -15105.320  45.2%     -   10s
H    0     0                    -26949.52138 -15105.320  43.9%     -   10s
H    0     0                    -26573.28291 -15105.320  43.2%     -   10s
H    0     0                    -24090.76636 -15105.320  37.3%     -   10s
H    0     0                    -24040.16235 -15105.320  37.2%     -   10s
H    0     0                    -24000.43065 -15105.320  37.1%     -   10s
     0     0 -15105.320    0  823 -24000.431 -15105.320  37.1%     -   10s
H    0     0                    -23946.22727 -15105.900  36.9%     -   10s
H    0     0                    -23945.01248 -15105.900  36.9%     -   10s
H    0     0                    -23936.97846 -15105.900  36.9%     -   10s
     0     0 -15445.373    0  841 -23936.978 -15445.373  35.5%     -   11s
H    0     0                    -23880.04839 -15632.624  34.5%     -   12s
H    0     0                    -23846.00759 -15632.624  34.4%     -   12s
     0     0 -15632.624    0  929 -23846.008 -15632.624  34.4%     -   12s
     0     0 -15650.810    0  856 -23846.008 -15650.810  34.4%     -   12s
     0     0 -15654.082    0  851 -23846.008 -15654.082  34.4%     -   12s
     0     0 -15654.276    0  862 -23846.008 -15654.276  34.4%     -   12s
H    0     0                    -23636.98246 -17822.325  24.6%     -   17s
H    0     0                    -23616.17823 -17822.325  24.5%     -   17s
H    0     0                    -23586.18811 -17822.325  24.4%     -   17s
H    0     0                    -23546.93847 -17822.325  24.3%     -   17s
     0     0 -17822.773    0  760 -23546.938 -17822.773  24.3%     -   17s
     0     0 -18145.880    0  960 -23546.938 -18145.880  22.9%     -   19s
     0     0 -18322.340    0  891 -23546.938 -18322.340  22.2%     -   21s
     0     0 -18356.989    0  887 -23546.938 -18356.989  22.0%     -   21s
     0     0 -18374.361    0  892 -23546.938 -18374.361  22.0%     -   22s
     0     0 -18375.569    0  889 -23546.938 -18375.569  22.0%     -   22s
     0     0 -19422.513    0  732 -23546.938 -19422.513  17.5%     -   28s
     0     0 -19639.897    0  857 -23546.938 -19639.897  16.6%     -   30s
     0     0 -19752.493    0  731 -23546.938 -19752.493  16.1%     -   31s
     0     0 -19778.924    0  765 -23546.938 -19778.924  16.0%     -   32s
     0     0 -19788.779    0  764 -23546.938 -19788.779  16.0%     -   32s
     0     0 -19789.722    0  773 -23546.938 -19789.722  16.0%     -   32s
     0     0 -19994.282    0 1023 -23546.938 -19994.282  15.1%     -   35s
     0     0 -20051.917    0  763 -23546.938 -20051.917  14.8%     -   36s
     0     0 -20063.876    0  950 -23546.938 -20063.876  14.8%     -   37s
     0     0 -20070.946    0  877 -23546.938 -20070.946  14.8%     -   37s
     0     0 -20071.544    0  883 -23546.938 -20071.544  14.8%     -   37s
     0     0 -20147.980    0  739 -23546.938 -20147.980  14.4%     -   40s
     0     0 -20172.014    0  836 -23546.938 -20172.014  14.3%     -   41s
     0     0 -20177.845    0  658 -23546.938 -20177.845  14.3%     -   42s
     0     0 -20231.482    0  831 -23546.938 -20231.482  14.1%     -   43s
     0     0 -20250.450    0 1029 -23546.938 -20250.450  14.0%     -   44s
     0     0 -20252.514    0 1042 -23546.938 -20252.514  14.0%     -   44s
     0     0 -20295.215    0 1021 -23546.938 -20295.215  13.8%     -   46s
     0     0 -20309.473    0  749 -23546.938 -20309.473  13.7%     -   46s
     0     0 -20313.019    0  755 -23546.938 -20313.019  13.7%     -   47s
     0     0 -20338.362    0  752 -23546.938 -20338.362  13.6%     -   48s
     0     0 -20348.738    0  743 -23546.938 -20348.738  13.6%     -   49s
     0     0 -20348.738    0  743 -23546.938 -20348.738  13.6%     -   49s
     0     0 -20351.187    0  733 -23546.938 -20351.187  13.6%     -   49s
     0     0 -20414.207    0  746 -23546.938 -20414.207  13.3%     -   51s
     0     0 -20423.869    0  756 -23546.938 -20423.869  13.3%     -   52s
     0     0 -20429.433    0  746 -23546.938 -20429.433  13.2%     -   52s
     0     0 -20494.662    0  754 -23546.938 -20494.662  13.0%     -   54s
     0     0 -20494.662    0  754 -23546.938 -20494.662  13.0%     -   54s
     0     0 -20513.410    0  729 -23546.938 -20513.410  12.9%     -   55s
     0     0 -20522.243    0  752 -23546.938 -20522.243  12.8%     -   56s
     0     0 -20525.408    0  843 -23546.938 -20525.408  12.8%     -   56s
     0     0 -20538.028    0  748 -23546.938 -20538.028  12.8%     -   57s
     0     0 -20538.501    0  748 -23546.938 -20538.501  12.8%     -   58s
     0     2 -20538.501    0  748 -23546.938 -20538.501  12.8%     -   64s
     1     4 -20769.903    1  577 -23546.938 -20538.669  12.8%  4574   66s
     7    10 -21368.227    3  648 -23546.938 -21159.108  10.1%  2808   70s
   107    60 -22461.505    9  624 -23546.938 -22077.447  6.24%   946   75s
   471   194     cutoff   12      -23546.938 -22077.453  6.24%   420   80s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 5
  MIR: 2162
  Flow cover: 1687
  Zero half: 7
  RLT: 143
  Relax-and-lift: 455

Explored 1053 nodes (397496 simplex iterations) in 82.94 seconds (198.68 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -23546.9 -23586.2 -23616.2 ... -24000.4
No other solutions better than -23546.9

Optimal solution found (tolerance 1.00e-06)
Best objective -2.354693846684e+04, best bound -2.354693846684e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 82.95s
  Master Objective (UB) = -23546.94, θ = 86817.11
  Upper Bound (UB) = -23546.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 86817.11
  [DEBUG]   ✓ Scenario 0: θ = 86817.11 ≤ Q = 86817.11 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 86817.11 ≤ Q = 86817.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 86817.11 ≤ Q = 86817.11 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x11bfbfc5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xee40403b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.409920e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6563286.6509
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.149834e+05, 208 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -114983.37    0  120 6563286.65 -114983.37   102%     -    0s
H    0     0                    -78505.41419 -114983.37  46.5%     -    0s
H    0     0                    -78738.46714 -114983.37  46.0%     -    0s
H    0     0                    -82125.47230 -114983.37  40.0%     -    0s
H    0     0                    -97864.13710 -114983.37  17.5%     -    0s
     0     0 -102506.88    0   57 -97864.137 -102506.88  4.74%     -    0s
H    0     0                    -101110.7234 -102432.17  1.31%     -    0s
     0     0 -102075.89    0   59 -101110.72 -102075.89  0.95%     -    0s
     0     0 -102051.20    0   59 -101110.72 -102051.20  0.93%     -    0s
     0     0 -101528.11    0   24 -101110.72 -101528.11  0.41%     -    0s
H    0     0                    -101342.2642 -101342.26  0.00%     -    0s
     0     0          -    0      -101342.26 -101342.26  0.00%     -    0s

Cutting planes:
  Gomory: 24
  Implied bound: 1
  MIR: 71
  Flow cover: 2
  RLT: 85
  Relax-and-lift: 1
  BQP: 8

Explored 1 nodes (490 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -101342 -97864.1 -82125.5 ... 1.40992e+13
No other solutions better than -101342

Optimal solution found (tolerance 1.00e-06)
Best objective -1.013422642157e+05, best bound -1.013422642157e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 66869.96
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101342.26
  [DEBUG]   S×d_nominal = 168212.22
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168212.22 + -101342.26 = 66869.96
  [DEBUG]   Current θ from Master = 86817.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19947.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -43494.09
  Lower Bound (LB) = -26924.21
  Gap (UB-LB) = 3377.2739, Absolute Gap = 3377.2739, Relative Gap = 0.143427
  Not converged yet (gap = 3377.27 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178347 nonzeros
Model fingerprint: 0xebf22b1f
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31512 rows and 12792 columns
Presolve time: 0.38s
Presolved: 31031 rows, 14428 columns, 173959 nonzeros
Variable types: 12169 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27737   -5.9949498e+03   0.000000e+00   2.522529e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23981   -3.8883102e+03   0.000000e+00   0.000000e+00      7s

Root relaxation: objective -3.888310e+03, 23981 iterations, 6.26 seconds (13.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -3888.3102    0  501 -205910.05 -3888.3102  98.1%     -    6s
H    0     0                    -197077.5162 -3888.3102  98.0%     -    6s
H    0     0                    -129765.9037 -3888.3102  97.0%     -    6s
H    0     0                    -127827.6692 -3888.3102  97.0%     -    6s
H    0     0                    -68010.75998 -3888.3102  94.3%     -    7s
H    0     0                    -67816.57868 -3888.3102  94.3%     -    7s
H    0     0                    -47277.12167 -3888.3102  91.8%     -    7s
H    0     0                    -46125.28710 -3888.3102  91.6%     -    7s
     0     0 -10100.269    0  944 -46125.287 -10100.269  78.1%     -   11s
     0     0 -10192.713    0  883 -46125.287 -10192.713  77.9%     -   11s
     0     0 -10201.076    0  884 -46125.287 -10201.076  77.9%     -   11s
     0     0 -10209.752    0  886 -46125.287 -10209.752  77.9%     -   11s
     0     0 -10209.931    0  886 -46125.287 -10209.931  77.9%     -   11s
H    0     0                    -44362.67837 -14692.942  66.9%     -   17s
H    0     0                    -39119.41689 -14692.942  62.4%     -   17s
H    0     0                    -39027.85524 -14692.942  62.4%     -   17s
H    0     0                    -38962.53122 -14692.942  62.3%     -   17s
H    0     0                    -38374.78760 -14692.942  61.7%     -   17s
H    0     0                    -38314.82959 -14692.942  61.7%     -   17s
H    0     0                    -38004.03605 -14692.942  61.3%     -   17s
H    0     0                    -29503.86057 -14692.942  50.2%     -   17s
H    0     0                    -29224.06588 -14692.942  49.7%     -   17s
     0     0 -14692.942    0  897 -29224.066 -14692.942  49.7%     -   17s
H    0     0                    -25373.04768 -14693.502  42.1%     -   17s
H    0     0                    -25278.93714 -14693.502  41.9%     -   17s
H    0     0                    -25263.96413 -14693.502  41.8%     -   17s
H    0     0                    -24997.65033 -14693.502  41.2%     -   17s
H    0     0                    -24940.52688 -14693.502  41.1%     -   17s
H    0     0                    -24634.85144 -14693.502  40.4%     -   17s
H    0     0                    -24614.77651 -15362.002  37.6%     -   19s
     0     0 -15362.002    0  837 -24614.777 -15362.002  37.6%     -   19s
H    0     0                    -24610.82529 -15464.434  37.2%     -   20s
     0     0 -15464.434    0  839 -24610.825 -15464.434  37.2%     -   20s
     0     0 -15488.459    0  840 -24610.825 -15488.459  37.1%     -   21s
     0     0 -15491.311    0  841 -24610.825 -15491.311  37.1%     -   21s
     0     0 -15491.347    0  836 -24610.825 -15491.347  37.1%     -   21s
H    0     0                    -24317.98253 -17721.912  27.1%     -   28s
H    0     0                    -24262.15105 -17721.912  27.0%     -   28s
H    0     0                    -24236.11215 -17721.912  26.9%     -   28s
     0     0 -17721.912    0  765 -24236.112 -17721.912  26.9%     -   28s
H    0     0                    -24103.38479 -17722.435  26.5%     -   29s
H    0     0                    -24095.35078 -17722.435  26.4%     -   29s
     0     0 -18187.008    0  891 -24095.351 -18187.008  24.5%     -   32s
     0     0 -18343.007    0  887 -24095.351 -18343.007  23.9%     -   34s
     0     0 -18377.085    0  801 -24095.351 -18377.085  23.7%     -   35s
     0     0 -18384.427    0  894 -24095.351 -18384.427  23.7%     -   36s
     0     0 -18384.710    0  889 -24095.351 -18384.710  23.7%     -   36s
H    0     0                    -24017.21001 -19278.317  19.7%     -   45s
H    0     0                    -24013.73914 -19278.317  19.7%     -   45s
     0     0 -19278.317    0  760 -24013.739 -19278.317  19.7%     -   45s
     0     0 -19531.346    0  740 -24013.739 -19531.346  18.7%     -   47s
     0     0 -19601.528    0  846 -24013.739 -19601.528  18.4%     -   49s
     0     0 -19619.984    0  864 -24013.739 -19619.984  18.3%     -   50s
     0     0 -19629.992    0  864 -24013.739 -19629.992  18.3%     -   50s
     0     0 -19633.667    0  876 -24013.739 -19633.667  18.2%     -   51s
     0     0 -19854.861    0  747 -24013.739 -19854.861  17.3%     -   54s
     0     0 -19900.388    0  915 -24013.739 -19900.388  17.1%     -   55s
     0     0 -19973.640    0 1018 -24013.739 -19973.640  16.8%     -   57s
     0     0 -19982.075    0 1015 -24013.739 -19982.075  16.8%     -   58s
     0     0 -19983.724    0  674 -24013.739 -19983.724  16.8%     -   58s
     0     0 -20071.423    0  822 -24013.739 -20071.423  16.4%     -   60s
     0     0 -20093.256    0  927 -24013.739 -20093.256  16.3%     -   62s
     0     0 -20100.875    0  937 -24013.739 -20100.875  16.3%     -   62s
     0     0 -20106.883    0  943 -24013.739 -20106.883  16.3%     -   63s
     0     0 -20111.605    0  952 -24013.739 -20111.605  16.2%     -   63s
H    0     0                    -24005.66837 -20111.605  16.2%     -   64s
H    0     0                    -23984.86414 -20111.605  16.1%     -   64s
     0     0 -20184.620    0  572 -23984.864 -20184.620  15.8%     -   66s
     0     0 -20198.880    0  590 -23984.864 -20198.880  15.8%     -   67s
     0     0 -20200.996    0  679 -23984.864 -20200.996  15.8%     -   67s
     0     0 -20229.244    0  578 -23984.864 -20229.244  15.7%     -   69s
     0     0 -20239.450    0  581 -23984.864 -20239.450  15.6%     -   70s
     0     0 -20240.171    0  923 -23984.864 -20240.171  15.6%     -   71s
     0     0 -20275.166    0  564 -23984.864 -20275.166  15.5%     -   73s
     0     0 -20276.243    0  564 -23984.864 -20276.243  15.5%     -   73s
     0     2 -20276.243    0  564 -23984.864 -20276.243  15.5%     -   86s
     3     8 -20956.815    2  643 -23984.864 -20442.054  14.8%  4422   90s
    15    28 -21432.579    4  442 -23984.864 -20871.859  13.0%  3287   96s
    91    59 -21774.662    7  438 -23984.864 -21138.681  11.9%  1934  102s
   134    68 -21805.247    8  442 -23984.864 -21383.075  10.8%  1668  105s
H  163    68                    -23963.18511 -21383.075  10.8%  1502  105s
   532   353 -22708.634   14  320 -23963.185 -21383.075  10.8%   691  110s
   887   375 -23648.744   16  369 -23963.185 -21813.707  8.97%   512  115s
  1342   337 -23301.275   14  367 -23963.185 -22338.837  6.78%   479  120s
  1650   266 -23414.064   15  300 -23963.185 -22507.536  6.07%   460  126s
  2017    98 infeasible   17      -23963.185 -22942.322  4.26%   438  130s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 42
  MIR: 2685
  Flow cover: 1854
  Zero half: 3
  RLT: 153
  Relax-and-lift: 529

Explored 2382 nodes (1114018 simplex iterations) in 132.01 seconds (323.35 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -23963.2 -23984.9 -24005.7 ... -24318
No other solutions better than -23963.2

Optimal solution found (tolerance 1.00e-06)
Best objective -2.396318511153e+04, best bound -2.396318511153e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 132.02s
  Master Objective (UB) = -23963.19, θ = 87377.75
  Upper Bound (UB) = -23963.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87377.75
  [DEBUG]   ✓ Scenario 0: θ = 87377.75 ≤ Q = 87377.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87377.75 ≤ Q = 87377.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87377.75 ≤ Q = 87377.75 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87377.75 ≤ Q = 87377.75 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x167e80f5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe9817f0b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6659341.9528
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.087892e+05, 213 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108789.21    0  122 6659341.95 -108789.21   102%     -    0s
H    0     0                    -78930.29101 -108789.21  37.8%     -    0s
H    0     0                    -79341.56102 -108789.21  37.1%     -    0s
     0     0 -86390.526    0   54 -79341.561 -86390.526  8.88%     -    0s
H    0     0                    -84875.49878 -86311.901  1.69%     -    0s
     0     0 -85913.020    0   55 -84875.499 -85913.020  1.22%     -    0s
     0     0 -85872.959    0   55 -84875.499 -85872.959  1.18%     -    0s
H    0     0                    -85131.66612 -85872.959  0.87%     -    0s
H    0     0                    -85131.66942 -85872.959  0.87%     -    0s
     0     0 -85698.362    0   57 -85131.669 -85698.362  0.67%     -    0s
     0     0 -85659.051    0   57 -85131.669 -85659.051  0.62%     -    0s
     0     0 -85659.051    0   57 -85131.669 -85659.051  0.62%     -    0s
     0     0 -85270.343    0   14 -85131.669 -85270.343  0.16%     -    0s
     0     0 -85238.265    0   10 -85131.669 -85238.265  0.13%     -    0s
     0     0 -85205.794    0    6 -85131.669 -85205.794  0.09%     -    0s
     0     0 -85184.663    0    4 -85131.669 -85184.663  0.06%     -    0s
     0     0 -85142.743    0    2 -85131.669 -85142.743  0.01%     -    0s
     0     0     cutoff    0      -85131.669 -85131.669  0.00%     -    0s

Cutting planes:
  Gomory: 9
  MIR: 111
  Flow cover: 3
  RLT: 52
  Relax-and-lift: 14
  BQP: 8

Explored 1 nodes (539 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -85131.7 -79341.6 -78930.3 ... 1.42347e+13
No other solutions better than -85131.7

Optimal solution found (tolerance 1.00e-06)
Best objective -8.513166942425e+04, best bound -8.513166942425e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 83186.10
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -85131.67
  [DEBUG]   S×d_nominal = 168317.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168317.77 + -85131.67 = 83186.10
  [DEBUG]   Current θ from Master = 87377.75
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4191.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28154.83
  Lower Bound (LB) = -26924.21
  Gap (UB-LB) = 2961.0273, Absolute Gap = 2961.0273, Relative Gap = 0.123566
  Not converged yet (gap = 2961.03 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221554 nonzeros
Model fingerprint: 0x21c18c02
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 39390 rows and 15990 columns
Presolve time: 0.51s
Presolved: 38443 rows, 17470 columns, 237669 nonzeros
Variable types: 15211 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 38443 rows, 17470 columns, 237669 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30362   -1.9722788e+04   0.000000e+00   3.993369e+06      5s
   42248   -1.4872103e+04   0.000000e+00   4.483934e+05     10s
Concurrent spin time: 3.20s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -1.361859e+04, 35856 iterations, 12.73 seconds (25.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13618.591    0  456 -205910.05 -13618.591  93.4%     -   13s
H    0     0                    -189344.5681 -13618.591  92.8%     -   13s
H    0     0                    -132141.2778 -13618.591  89.7%     -   13s
H    0     0                    -130541.3119 -13618.591  89.6%     -   13s
H    0     0                    -130484.4958 -13618.591  89.6%     -   13s
H    0     0                    -82619.64710 -13618.591  83.5%     -   13s
H    0     0                    -81961.83830 -13618.591  83.4%     -   13s
H    0     0                    -69068.28914 -13618.591  80.3%     -   13s
H    0     0                    -67328.09435 -13618.591  79.8%     -   13s
H    0     0                    -46371.13777 -13618.591  70.6%     -   14s
H    0     0                    -45552.25541 -13618.591  70.1%     -   14s
H    0     0                    -45534.23792 -13618.591  70.1%     -   14s
H    0     0                    -45491.17038 -13618.591  70.1%     -   14s
     0     0 -16677.294    0  580 -45491.170 -16677.294  63.3%     -   19s
H    0     0                    -41876.25439 -16677.294  60.2%     -   19s
H    0     0                    -41824.02031 -16677.294  60.1%     -   19s
H    0     0                    -41217.73951 -16677.294  59.5%     -   19s
H    0     0                    -41064.02939 -16677.294  59.4%     -   19s
     0     0 -16915.300    0  584 -41064.029 -16915.300  58.8%     -   20s
     0     0 -16949.972    0  582 -41064.029 -16949.972  58.7%     -   21s
     0     0 -16954.596    0  569 -41064.029 -16954.596  58.7%     -   21s
     0     0 -17040.418    0  572 -41064.029 -17040.418  58.5%     -   21s
     0     0 -17040.418    0  572 -41064.029 -17040.418  58.5%     -   22s
     0     0 -18219.835    0  796 -41064.029 -18219.835  55.6%     -   26s
H    0     0                    -35717.19366 -18220.180  49.0%     -   26s
H    0     0                    -35557.05811 -18220.180  48.8%     -   26s
     0     0 -18422.316    0  789 -35557.058 -18422.316  48.2%     -   27s
     0     0 -18445.623    0  792 -35557.058 -18445.623  48.1%     -   28s
     0     0 -18501.643    0  669 -35557.058 -18501.643  48.0%     -   28s
H    0     0                    -26412.76064 -18552.128  29.8%     -   29s
H    0     0                    -25080.05193 -18552.128  26.0%     -   29s
H    0     0                    -24951.89999 -18552.128  25.6%     -   29s
H    0     0                    -24941.25968 -18552.128  25.6%     -   29s
H    0     0                    -24702.66302 -18552.128  24.9%     -   29s
H    0     0                    -24433.67016 -18552.128  24.1%     -   29s
H    0     0                    -24332.62187 -18552.128  23.8%     -   29s
H    0     0                    -24306.90847 -18552.128  23.7%     -   29s
H    0     0                    -24305.69369 -18552.128  23.7%     -   29s
H    0     0                    -24284.61403 -18552.128  23.6%     -   29s
H    0     0                    -24265.58628 -18552.128  23.5%     -   29s
     0     0 -18552.128    0  735 -24265.586 -18552.128  23.5%     -   29s
H    0     0                    -24219.93738 -18621.290  23.1%     -   30s
H    0     0                    -24167.79777 -18621.290  22.9%     -   30s
H    0     0                    -24166.58299 -18621.290  22.9%     -   30s
H    0     0                    -24158.54897 -18621.290  22.9%     -   30s
     0     0 -18621.290    0  732 -24158.549 -18621.290  22.9%     -   31s
     0     0 -18633.252    0  796 -24158.549 -18633.252  22.9%     -   31s
     0     0 -18634.269    0  729 -24158.549 -18634.269  22.9%     -   31s
     0     0 -18634.605    0  733 -24158.549 -18634.605  22.9%     -   31s
H    0     0                    -24058.30033 -18634.605  22.5%     -   33s
H    0     0                    -24054.34912 -19211.098  20.1%     -   37s
     0     0 -19211.098    0  705 -24054.349 -19211.098  20.1%     -   37s
     0     0 -19543.229    0  722 -24054.349 -19543.229  18.8%     -   39s
     0     0 -19631.796    0  689 -24054.349 -19631.796  18.4%     -   41s
     0     0 -19664.946    0  536 -24054.349 -19664.946  18.2%     -   42s
     0     0 -19672.594    0  681 -24054.349 -19672.594  18.2%     -   42s
     0     0 -19675.339    0  686 -24054.349 -19675.339  18.2%     -   42s
     0     0 -19675.855    0  689 -24054.349 -19675.855  18.2%     -   42s
     0     0 -19833.879    0  702 -24054.349 -19833.879  17.5%     -   47s
H    0     0                    -24033.97107 -19834.437  17.5%     -   47s
H    0     0                    -24029.40793 -19834.437  17.5%     -   47s
     0     0 -19869.606    0  701 -24029.408 -19869.606  17.3%     -   48s
     0     0 -19899.872    0  703 -24029.408 -19899.872  17.2%     -   49s
     0     0 -19904.821    0  701 -24029.408 -19904.821  17.2%     -   49s
     0     0 -19905.417    0  699 -24029.408 -19905.417  17.2%     -   49s
H    0     0                    -23984.86414 -20014.237  16.6%     -   52s
     0     0 -20014.237    0  698 -23984.864 -20014.237  16.6%     -   52s
     0     0 -20032.608    0  697 -23984.864 -20032.608  16.5%     -   53s
     0     0 -20039.389    0  634 -23984.864 -20039.389  16.4%     -   54s
     0     0 -20040.702    0  706 -23984.864 -20040.702  16.4%     -   54s
     0     0 -20042.339    0  705 -23984.864 -20042.339  16.4%     -   54s
     0     0 -20043.600    0  707 -23984.864 -20043.600  16.4%     -   55s
     0     0 -20043.835    0  708 -23984.864 -20043.835  16.4%     -   55s
     0     0 -20132.041    0  621 -23984.864 -20132.041  16.1%     -   57s
     0     0 -20195.171    0  779 -23984.864 -20195.171  15.8%     -   59s
     0     0 -20211.152    0  788 -23984.864 -20211.152  15.7%     -   60s
     0     0 -20215.833    0  791 -23984.864 -20215.833  15.7%     -   60s
     0     0 -20216.437    0  794 -23984.864 -20216.437  15.7%     -   60s
     0     0 -20274.430    0  642 -23984.864 -20274.430  15.5%     -   63s
     0     0 -20279.894    0  724 -23984.864 -20279.894  15.4%     -   63s
     0     0 -20281.423    0  735 -23984.864 -20281.423  15.4%     -   64s
     0     0 -20282.490    0  736 -23984.864 -20282.490  15.4%     -   64s
     0     0 -20283.307    0  736 -23984.864 -20283.307  15.4%     -   64s
     0     0 -20320.180    0  723 -23984.864 -20320.180  15.3%     -   66s
     0     0 -20323.969    0  733 -23984.864 -20323.969  15.3%     -   67s
     0     0 -20325.300    0  739 -23984.864 -20325.300  15.3%     -   67s
     0     0 -20327.143    0  737 -23984.864 -20327.143  15.3%     -   67s
     0     0 -20327.464    0  737 -23984.864 -20327.464  15.2%     -   68s
     0     0 -20340.327    0  756 -23984.864 -20340.327  15.2%     -   69s
     0     0 -20345.111    0  744 -23984.864 -20345.111  15.2%     -   69s
     0     0 -20346.221    0  752 -23984.864 -20346.221  15.2%     -   70s
     0     0 -20346.488    0  750 -23984.864 -20346.488  15.2%     -   70s
     0     0 -20350.997    0  759 -23984.864 -20350.997  15.2%     -   71s
     0     0 -20353.580    0  764 -23984.864 -20353.580  15.1%     -   71s
     0     0 -20354.161    0  770 -23984.864 -20354.161  15.1%     -   71s
     0     0 -20364.898    0  766 -23984.864 -20364.898  15.1%     -   73s
     0     0 -20366.114    0  767 -23984.864 -20366.114  15.1%     -   73s
     0     0 -20366.809    0  765 -23984.864 -20366.809  15.1%     -   73s
     0     0 -20369.648    0  756 -23984.864 -20369.648  15.1%     -   74s
     0     0 -20370.258    0  752 -23984.864 -20370.258  15.1%     -   76s
     0     0 -20373.101    0  756 -23984.864 -20373.101  15.1%     -   77s
     0     0 -20374.754    0  750 -23984.864 -20374.754  15.1%     -   77s
     0     0 -20374.903    0  749 -23984.864 -20374.903  15.1%     -   77s
     0     0 -20376.827    0  750 -23984.864 -20376.827  15.0%     -   78s
     0     0 -20377.358    0  750 -23984.864 -20377.358  15.0%     -   79s
     0     2 -20377.358    0  750 -23984.864 -20377.358  15.0%     -   91s
     3     8 -21000.959    2  624 -23984.864 -20516.079  14.5%  2906   97s
    15    30 -21601.829    4  850 -23984.864 -20923.370  12.8%  2819  102s
    31    54 -21733.335    5  853 -23984.864 -20965.649  12.6%  2403  106s
    93   162 -21847.495    7  854 -23984.864 -21103.652  12.0%  2231  111s
   298   170 -22351.926    9  632 -23984.864 -21103.652  12.0%  1098  119s
   392   158 -22735.964    9  752 -23984.864 -21325.023  11.1%   999  121s
   571   122 -23869.089   10  537 -23984.864 -21325.023  11.1%   911  127s
   647   110 -23454.255   10  744 -23984.864 -21325.023  11.1%   903  130s
   798   104     cutoff   12      -23984.864 -21640.186  9.78%   868  138s
   849   118     cutoff   12      -23984.864 -21640.186  9.78%   867  140s
  1033   128 -23483.519    7   66 -23984.864 -22443.251  6.43%   819  145s
  1173    95     cutoff    8      -23984.864 -22513.616  6.13%   798  150s
  1386     7     cutoff   21      -23984.864 -22838.380  4.78%   778  155s

Cutting planes:
  Implied bound: 23
  MIR: 308
  Flow cover: 911
  Zero half: 19
  RLT: 17
  Relax-and-lift: 33

Explored 1532 nodes (1234475 simplex iterations) in 157.21 seconds (452.11 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -23984.9 -24029.4 -24034 ... -24265.6
No other solutions better than -23984.9

Optimal solution found (tolerance 1.00e-06)
Best objective -2.398486413710e+04, best bound -2.398486413710e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 157.21s
  Master Objective (UB) = -23984.86, θ = 87070.95
  Upper Bound (UB) = -23984.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87070.95
  [DEBUG]   ✓ Scenario 0: θ = 87070.95 ≤ Q = 87070.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87070.95 ≤ Q = 87070.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87070.95 ≤ Q = 87070.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87070.95 ≤ Q = 87070.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87070.95 ≤ Q = 87070.95 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e5e722
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfa1a18de
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6665455.2086
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.090582e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -109058.21    0  122 6665455.21 -109058.21   102%     -    0s
H    0     0                    -79164.03437 -109058.21  37.8%     -    0s
H    0     0                    -79590.04490 -109058.21  37.0%     -    0s
     0     0 -86258.423    0   51 -79590.045 -86258.423  8.38%     -    0s
H    0     0                    -84371.07040 -86201.541  2.17%     -    0s
     0     0 -85931.476    0   55 -84371.070 -85931.476  1.85%     -    0s
H    0     0                    -84811.04297 -85922.836  1.31%     -    0s
H    0     0                    -84936.67685 -85922.836  1.16%     -    0s
     0     0 -85879.586    0   55 -84936.677 -85879.586  1.11%     -    0s
     0     0 -85818.375    0   55 -84936.677 -85818.375  1.04%     -    0s
     0     2 -85818.375    0   55 -84936.677 -85818.375  1.04%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 128

Explored 67 nodes (641 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -84936.7 -79590 -79164 ... 1.42347e+13
No other solutions better than -84936.7

Optimal solution found (tolerance 1.00e-06)
Best objective -8.493667684797e+04, best bound -8.493667684797e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 83289.04
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84936.68
  [DEBUG]   S×d_nominal = 168225.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168225.72 + -84936.68 = 83289.04
  [DEBUG]   Current θ from Master = 87070.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3781.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27766.77
  Lower Bound (LB) = -26924.21
  Gap (UB-LB) = 2939.3482, Absolute Gap = 2939.3482, Relative Gap = 0.122550
  Not converged yet (gap = 2939.35 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264761 nonzeros
Model fingerprint: 0x4985fe93
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 47268 rows and 19188 columns
Presolve time: 0.63s
Presolved: 45855 rows, 20512 columns, 284099 nonzeros
Variable types: 18253 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 45855 rows, 20512 columns, 284099 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30024   -1.7134598e+04   0.000000e+00   3.990893e+06      5s
   39218   -1.5028067e+04   0.000000e+00   1.233459e+06     10s
Concurrent spin time: 3.36s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective -1.361859e+04, 42558 iterations, 14.99 seconds (31.19 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13618.591    0  456 -205910.05 -13618.591  93.4%     -   16s
H    0     0                    -193691.1654 -13618.591  93.0%     -   16s
H    0     0                    -136969.3565 -13618.591  90.1%     -   16s
H    0     0                    -136738.8278 -13618.591  90.0%     -   16s
H    0     0                    -136608.8673 -13618.591  90.0%     -   16s
H    0     0                    -136578.0757 -13618.591  90.0%     -   16s
H    0     0                    -136014.7790 -13618.591  90.0%     -   16s
H    0     0                    -81811.79470 -13618.591  83.4%     -   16s
H    0     0                    -81443.20451 -13618.591  83.3%     -   16s
H    0     0                    -73385.25681 -13618.591  81.4%     -   16s
H    0     0                    -73190.01995 -13618.591  81.4%     -   16s
H    0     0                    -67212.93556 -13618.591  79.7%     -   16s
H    0     0                    -59413.80904 -13618.591  77.1%     -   17s
H    0     0                    -48043.30775 -13618.591  71.7%     -   17s
H    0     0                    -45275.10169 -13618.591  69.9%     -   17s
     0     0 -16717.083    0  592 -45275.102 -16717.083  63.1%     -   23s
H    0     0                    -44946.82391 -16721.254  62.8%     -   23s
     0     0 -17016.345    0  595 -44946.824 -17016.345  62.1%     -   25s
H    0     0                    -28590.14096 -17034.880  40.4%     -   26s
H    0     0                    -28582.10694 -17034.880  40.4%     -   26s
     0     0 -17194.484    0  595 -28582.107 -17194.484  39.8%     -   26s
     0     0 -17195.586    0  595 -28582.107 -17195.586  39.8%     -   26s
     0     0 -18214.563    0  448 -28582.107 -18214.563  36.3%     -   30s
H    0     0                    -26193.56005 -18214.563  30.5%     -   31s
H    0     0                    -25419.41340 -18214.563  28.3%     -   31s
     0     0 -18217.710    0  736 -25419.413 -18217.710  28.3%     -   33s
H    0     0                    -25404.88880 -18235.559  28.2%     -   34s
H    0     0                    -24292.90553 -18235.559  24.9%     -   34s
H    0     0                    -24201.24910 -18235.559  24.7%     -   34s
     0     0 -18235.559    0  670 -24201.249 -18235.559  24.7%     -   34s
     0     0 -18270.831    0  615 -24201.249 -18270.831  24.5%     -   35s
     0     0 -18273.597    0  616 -24201.249 -18273.597  24.5%     -   35s
     0     0 -18321.710    0  735 -24201.249 -18321.710  24.3%     -   36s
     0     0 -18322.293    0  735 -24201.249 -18322.293  24.3%     -   36s
     0     0 -18322.293    0  735 -24201.249 -18322.293  24.3%     -   36s
H    0     0                    -24197.74724 -19021.650  21.4%     -   42s
H    0     0                    -24076.86592 -19021.650  21.0%     -   42s
     0     0 -19021.650    0  662 -24076.866 -19021.650  21.0%     -   42s
H    0     0                    -24073.39505 -19023.018  21.0%     -   43s
     0     0 -19388.721    0  790 -24073.395 -19388.721  19.5%     -   46s
     0     0 -19457.926    0  811 -24073.395 -19457.926  19.2%     -   48s
     0     0 -19493.622    0  794 -24073.395 -19493.622  19.0%     -   49s
     0     0 -19561.237    0  862 -24073.395 -19561.237  18.7%     -   50s
     0     0 -19584.117    0  801 -24073.395 -19584.117  18.6%     -   51s
     0     0 -19590.395    0  807 -24073.395 -19590.395  18.6%     -   51s
     0     0 -19596.643    0  670 -24073.395 -19596.643  18.6%     -   52s
     0     0 -19596.643    0  670 -24073.395 -19596.643  18.6%     -   52s
     0     0 -19597.107    0  670 -24073.395 -19597.107  18.6%     -   52s
     0     0 -19934.706    0  692 -24073.395 -19934.706  17.2%     -   57s
H    0     0                    -24049.61237 -19935.642  17.1%     -   58s
     0     0 -19983.556    0  861 -24049.612 -19983.556  16.9%     -   59s
     0     0 -19997.101    0  861 -24049.612 -19997.101  16.9%     -   60s
     0     0 -20001.080    0  795 -24049.612 -20001.080  16.8%     -   61s
     0     0 -20002.058    0  858 -24049.612 -20002.058  16.8%     -   61s
     0     0 -20003.459    0  863 -24049.612 -20003.459  16.8%     -   61s
     0     0 -20004.840    0  860 -24049.612 -20004.840  16.8%     -   62s
     0     0 -20008.043    0  797 -24049.612 -20008.043  16.8%     -   62s
     0     0 -20008.211    0  797 -24049.612 -20008.211  16.8%     -   62s
     0     0 -20107.689    0  792 -24049.612 -20107.689  16.4%     -   65s
     0     0 -20136.452    0  778 -24049.612 -20136.452  16.3%     -   67s
     0     0 -20139.527    0  883 -24049.612 -20139.527  16.3%     -   67s
     0     0 -20147.195    0  874 -24049.612 -20147.195  16.2%     -   68s
     0     0 -20147.822    0  877 -24049.612 -20147.822  16.2%     -   68s
     0     0 -20213.411    0  881 -24049.612 -20213.411  16.0%     -   70s
     0     0 -20224.605    0  887 -24049.612 -20224.605  15.9%     -   72s
     0     0 -20224.605    0  887 -24049.612 -20224.605  15.9%     -   72s
     0     0 -20228.425    0  804 -24049.612 -20228.425  15.9%     -   72s
     0     0 -20229.091    0  727 -24049.612 -20229.091  15.9%     -   73s
     0     0 -20240.627    0  735 -24049.612 -20240.627  15.8%     -   74s
     0     0 -20243.179    0  812 -24049.612 -20243.179  15.8%     -   74s
     0     0 -20249.930    0  815 -24049.612 -20249.930  15.8%     -   75s
     0     0 -20250.329    0  813 -24049.612 -20250.329  15.8%     -   75s
     0     0 -20257.158    0  810 -24049.612 -20257.158  15.8%     -   76s
     0     0 -20257.449    0  820 -24049.612 -20257.449  15.8%     -   77s
     0     0 -20258.166    0  743 -24049.612 -20258.166  15.8%     -   78s
     0     0 -20258.833    0  900 -24049.612 -20258.833  15.8%     -   78s
     0     0 -20261.550    0  818 -24049.612 -20261.550  15.8%     -   80s
     0     0 -20261.928    0  735 -24049.612 -20261.928  15.7%     -   80s
     0     0 -20265.454    0  739 -24049.612 -20265.454  15.7%     -   81s
     0     0 -20265.503    0  739 -24049.612 -20265.503  15.7%     -   83s
     0     2 -20265.618    0  739 -24049.612 -20265.618  15.7%     -   93s
     1     4 -20317.838    1  680 -24049.612 -20265.656  15.7%  1571   96s
     7    16 -20785.606    3  928 -24049.612 -20415.887  15.1%  3325  100s
    31    44 -21276.921    5  926 -24049.612 -20965.204  12.8%  3390  109s
    57    68 -21484.510    6  938 -24049.612 -21109.184  12.2%  4140  113s
    89   156 -21505.761    7  933 -24049.612 -21189.628  11.9%  3716  118s
   177   202 -21511.721    8  939 -24049.612 -21195.932  11.9%  2473  121s
   270   235 -21608.770   10  870 -24049.612 -21195.932  11.9%  1976  126s
   333   266 -22832.301   10  572 -24049.612 -21221.210  11.8%  1894  130s
   412   282 -21898.641   11  933 -24049.612 -21221.210  11.8%  1771  135s
   521   316 -22237.406   12  938 -24049.612 -21318.056  11.4%  1738  144s
   563   331 -22841.389   13  900 -24049.612 -21331.098  11.3%  1765  149s
   630   336 -22987.363   14  907 -24049.612 -21331.098  11.3%  1713  153s
H  656   336                    -24034.08760 -21331.098  11.2%  1689  153s
   693   327 -23178.923   15  820 -24034.088 -21331.098  11.2%  1653  156s
   785   316 -23212.661   16  814 -24034.088 -21331.098  11.2%  1576  161s
   859   311 -23563.459   17  680 -24034.088 -21514.126  10.5%  1529  166s
   937   303     cutoff   18      -24034.088 -21596.670  10.1%  1516  171s
H  948   303                    -24026.42947 -21596.670  10.1%  1522  171s
  1014   307 -23989.820   12  203 -24026.429 -21596.670  10.1%  1516  176s
  1092   303     cutoff   13      -24026.429 -21676.822  9.78%  1496  180s
  1166   297 infeasible   10      -24026.429 -21709.400  9.64%  1507  186s
  1279   300     cutoff   15      -24026.429 -21798.579  9.27%  1455  192s
  1346   302     cutoff   16      -24026.429 -21808.441  9.23%  1474  197s
  1445   267 -23929.697   12  421 -24026.429 -21808.441  9.23%  1454  201s
  1560   261     cutoff   13      -24026.429 -21808.441  9.23%  1427  206s
  1624   240 -23724.162    8   45 -24026.429 -21838.180  9.11%  1437  212s
  1713   195     cutoff    9      -24026.429 -22343.071  7.01%  1448  217s
  1813   138 -23649.298   19  327 -24026.429 -22343.071  7.01%  1437  222s
  1958    87     cutoff   23      -24026.429 -22343.071  7.01%  1391  226s
  2066    21 -23972.362   17  316 -24026.429 -22343.071  7.01%  1369  230s

Cutting planes:
  Implied bound: 35
  MIR: 393
  Flow cover: 1215
  Zero half: 10
  RLT: 20
  Relax-and-lift: 37

Explored 2203 nodes (3027627 simplex iterations) in 232.30 seconds (692.82 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24026.4 -24034.1 -24049.6 ... -25419.4
No other solutions better than -24026.4

Optimal solution found (tolerance 1.00e-06)
Best objective -2.402642947479e+04, best bound -2.402642947479e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 232.31s
  Master Objective (UB) = -24026.43, θ = 87318.63
  Upper Bound (UB) = -24026.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87318.63
  [DEBUG]   ✓ Scenario 0: θ = 87318.63 ≤ Q = 87318.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87318.63 ≤ Q = 87318.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87318.63 ≤ Q = 87318.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87318.63 ≤ Q = 87318.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87318.63 ≤ Q = 87318.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87318.63 ≤ Q = 87318.63 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3739f305
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc8c60cfb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6653900.0016
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.089722e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108972.20    0  122 6653900.00 -108972.20   102%     -    0s
H    0     0                    -79086.94905 -108972.20  37.8%     -    0s
H    0     0                    -79498.21906 -108972.20  37.1%     -    0s
     0     0 -86725.562    0   53 -79498.219 -86725.562  9.09%     -    0s
H    0     0                    -84837.59224 -86723.697  2.22%     -    0s
     0     0 -86547.523    0   51 -84837.592 -86547.523  2.02%     -    0s
     0     0 -86510.259    0   46 -84837.592 -86510.259  1.97%     -    0s
H    0     0                    -85364.23793 -86510.259  1.34%     -    0s
H    0     0                    -85371.79274 -86510.259  1.33%     -    0s
     0     0 -86403.269    0   56 -85371.793 -86403.269  1.21%     -    0s
     0     0 -86364.299    0   56 -85371.793 -86364.299  1.16%     -    0s
     0     2 -86362.222    0   56 -85371.793 -86362.222  1.16%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 3
  MIR: 143

Explored 137 nodes (985 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -85371.8 -79498.2 -79086.9 ... 1.42686e+13
No other solutions better than -85371.8

Optimal solution found (tolerance 1.00e-06)
Best objective -8.537179273768e+04, best bound -8.537179273768e+04, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 83043.51
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -85371.79
  [DEBUG]   S×d_nominal = 168415.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168415.30 + -85371.79 = 83043.51
  [DEBUG]   Current θ from Master = 87318.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4275.12 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28301.54
  Lower Bound (LB) = -26924.21
  Gap (UB-LB) = 2897.7829, Absolute Gap = 2897.7829, Relative Gap = 0.120608
  Not converged yet (gap = 2897.78 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 307968 nonzeros
Model fingerprint: 0x081dab29
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 55146 rows and 22386 columns
Presolve time: 0.74s
Presolved: 53267 rows, 23554 columns, 330529 nonzeros
Variable types: 21295 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53267 rows, 23554 columns, 330529 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32298   -4.5473597e+04   0.000000e+00   1.593501e+07      5s
   42399   -2.6903590e+04   0.000000e+00   1.955844e+07     10s
   50535   -2.2117817e+04   0.000000e+00   1.473661e+06     15s
Concurrent spin time: 0.22s

Solved with dual simplex

Root relaxation: objective -1.361859e+04, 46926 iterations, 18.87 seconds (44.27 work units)
Total elapsed time = 20.04s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13618.591    0  456 -205910.05 -13618.591  93.4%     -   20s
H    0     0                    -199196.5838 -13618.591  93.2%     -   20s
H    0     0                    -188402.3592 -13618.591  92.8%     -   20s
H    0     0                    -184630.7592 -13618.591  92.6%     -   20s
H    0     0                    -166225.4279 -13618.591  91.8%     -   20s
H    0     0                    -165971.9592 -13618.591  91.8%     -   20s
H    0     0                    -153725.4263 -13618.591  91.1%     -   20s
H    0     0                    -82341.40561 -13618.591  83.5%     -   20s
H    0     0                    -81683.59680 -13618.591  83.3%     -   20s
H    0     0                    -69241.17817 -13618.591  80.3%     -   20s
H    0     0                    -67328.09435 -13618.591  79.8%     -   20s
H    0     0                    -59413.80904 -13618.591  77.1%     -   21s
H    0     0                    -52361.92237 -13618.591  74.0%     -   21s
H    0     0                    -45305.65095 -13618.591  69.9%     -   21s
     0     0 -16674.142    0  589 -45305.651 -16674.142  63.2%     -   29s
H    0     0                    -41251.26437 -16674.780  59.6%     -   29s
H    0     0                    -40940.50982 -16674.780  59.3%     -   29s
     0     0 -17084.201    0  579 -40940.510 -17084.201  58.3%     -   30s
     0     0 -17084.201    0  580 -40940.510 -17084.201  58.3%     -   31s
     0     0 -17123.858    0  578 -40940.510 -17123.858  58.2%     -   31s
     0     0 -17123.858    0  581 -40940.510 -17123.858  58.2%     -   32s
     0     0 -17123.858    0  581 -40940.510 -17123.858  58.2%     -   32s
     0     0 -17123.858    0  595 -40940.510 -17123.858  58.2%     -   33s
     0     0 -17123.858    0  594 -40940.510 -17123.858  58.2%     -   33s
     0     0 -17123.858    0  593 -40940.510 -17123.858  58.2%     -   33s
     0     0 -18277.415    0  661 -40940.510 -18277.415  55.4%     -   40s
H    0     0                    -34635.73128 -18278.709  47.2%     -   40s
H    0     0                    -34518.08637 -18278.709  47.0%     -   40s
     0     0 -18540.154    0  793 -34518.086 -18540.154  46.3%     -   43s
H    0     0                    -25911.30862 -18602.805  28.2%     -   45s
H    0     0                    -25811.95302 -18602.805  27.9%     -   45s
H    0     0                    -25553.16271 -18602.805  27.2%     -   45s
H    0     0                    -24257.55226 -18602.805  23.3%     -   45s
     0     0 -18602.805    0  728 -24257.552 -18602.805  23.3%     -   45s
     0     0 -18628.087    0  663 -24257.552 -18628.087  23.2%     -   46s
     0     0 -18629.873    0  664 -24257.552 -18629.873  23.2%     -   46s
     0     0 -18661.537    0  664 -24257.552 -18661.537  23.1%     -   47s
     0     0 -18664.164    0  676 -24257.552 -18664.164  23.1%     -   48s
     0     0 -18664.914    0  677 -24257.552 -18664.914  23.1%     -   48s
     0     0 -18665.084    0  676 -24257.552 -18665.084  23.1%     -   48s
H    0     0                    -24215.98617 -19077.276  21.2%     -   54s
     0     0 -19077.276    0  668 -24215.986 -19077.276  21.2%     -   54s
     0     0 -19253.006    0  671 -24215.986 -19253.006  20.5%     -   57s
H    0     0                    -24183.18584 -19340.781  20.0%     -   60s
     0     0 -19340.781    0  572 -24183.186 -19340.781  20.0%     -   60s
     0     0 -19352.192    0  514 -24183.186 -19352.192  20.0%     -   62s
H    0     0                    -24180.20739 -19429.454  19.6%     -   65s
     0     0 -19429.454    0  743 -24180.207 -19429.454  19.6%     -   65s
     0     0 -19481.148    0  666 -24180.207 -19481.148  19.4%     -   66s
     0     0 -19597.371    0  669 -24180.207 -19597.371  19.0%     -   68s
     0     0 -19636.188    0  693 -24180.207 -19636.188  18.8%     -   69s
     0     0 -19660.539    0  688 -24180.207 -19660.539  18.7%     -   69s
     0     0 -19668.055    0  690 -24180.207 -19668.055  18.7%     -   70s
     0     0 -19669.187    0  694 -24180.207 -19669.187  18.7%     -   70s
     0     0 -19669.476    0  695 -24180.207 -19669.476  18.7%     -   70s
H    0     0                    -24145.22001 -19832.921  17.9%     -   75s
     0     0 -19832.921    0  709 -24145.220 -19832.921  17.9%     -   75s
H    0     0                    -24120.07011 -19890.131  17.5%     -   77s
     0     0 -19890.131    0  689 -24120.070 -19890.131  17.5%     -   77s
     0     0 -19918.974    0  703 -24120.070 -19918.974  17.4%     -   78s
     0     0 -19933.158    0  785 -24120.070 -19933.158  17.4%     -   79s
     0     0 -19934.275    0  720 -24120.070 -19934.275  17.4%     -   79s
     0     0 -19935.676    0  630 -24120.070 -19935.676  17.3%     -   79s
     0     0 -19936.826    0  796 -24120.070 -19936.826  17.3%     -   80s
     0     0 -19937.515    0  716 -24120.070 -19937.515  17.3%     -   80s
     0     0 -19984.779    0  614 -24120.070 -19984.779  17.1%     -   82s
     0     0 -19990.747    0  840 -24120.070 -19990.747  17.1%     -   83s
     0     0 -19994.765    0  840 -24120.070 -19994.765  17.1%     -   83s
     0     0 -19995.340    0  838 -24120.070 -19995.340  17.1%     -   83s
     0     0 -20027.533    0  516 -24120.070 -20027.533  17.0%     -   85s
H    0     0                    -24109.20738 -20028.333  16.9%     -   87s
     0     0 -20033.235    0  518 -24109.207 -20033.235  16.9%     -   88s
     0     0 -20034.739    0  517 -24109.207 -20034.739  16.9%     -   88s
     0     0 -20034.824    0  517 -24109.207 -20034.824  16.9%     -   88s
     0     0 -20055.281    0  712 -24109.207 -20055.281  16.8%     -   90s
     0     0 -20058.597    0  719 -24109.207 -20058.597  16.8%     -   90s
     0     0 -20058.953    0  723 -24109.207 -20058.953  16.8%     -   91s
H    0     0                    -24078.65112 -20058.953  16.7%     -   92s
H    0     0                    -24070.61710 -20058.953  16.7%     -   92s
     0     0 -20065.791    0  726 -24070.617 -20065.791  16.6%     -   92s
H    0     0                    -24053.56358 -20066.044  16.6%     -   92s
     0     0 -20067.483    0  725 -24053.564 -20067.483  16.6%     -   93s
     0     0 -20067.748    0  728 -24053.564 -20067.748  16.6%     -   93s
     0     0 -20074.158    0  644 -24053.564 -20074.158  16.5%     -   94s
     0     0 -20077.214    0  631 -24053.564 -20077.214  16.5%     -   94s
     0     0 -20077.732    0  628 -24053.564 -20077.732  16.5%     -   95s
     0     0 -20081.626    0  650 -24053.564 -20081.626  16.5%     -   96s
H    0     0                    -24049.61237 -20081.907  16.5%     -   98s
     0     0 -20081.907    0  648 -24049.612 -20081.907  16.5%     -   98s
     0     0 -20093.681    0  630 -24049.612 -20093.681  16.4%     -  100s
     0     0 -20095.189    0  779 -24049.612 -20095.189  16.4%     -  101s
     0     0 -20095.430    0  632 -24049.612 -20095.430  16.4%     -  101s
     0     0 -20146.513    0  614 -24049.612 -20146.513  16.2%     -  104s
     0     0 -20176.338    0  698 -24049.612 -20176.338  16.1%     -  106s
     0     0 -20179.782    0  705 -24049.612 -20179.782  16.1%     -  106s
     0     0 -20183.596    0  711 -24049.612 -20183.596  16.1%     -  106s
     0     0 -20186.138    0  783 -24049.612 -20186.138  16.1%     -  107s
     0     0 -20187.741    0  710 -24049.612 -20187.741  16.1%     -  107s
     0     0 -20188.343    0  699 -24049.612 -20188.343  16.1%     -  107s
     0     0 -20206.117    0  719 -24049.612 -20206.117  16.0%     -  109s
     0     0 -20207.655    0  794 -24049.612 -20207.655  16.0%     -  110s
     0     0 -20207.846    0  722 -24049.612 -20207.846  16.0%     -  110s
     0     0 -20213.756    0  707 -24049.612 -20213.756  15.9%     -  112s
     0     0 -20214.535    0  688 -24049.612 -20214.535  15.9%     -  112s
     0     0 -20215.643    0  803 -24049.612 -20215.643  15.9%     -  114s
     0     0 -20216.628    0  700 -24049.612 -20216.628  15.9%     -  114s
     0     0 -20217.218    0  701 -24049.612 -20217.218  15.9%     -  115s
     0     0 -20218.941    0  707 -24049.612 -20218.941  15.9%     -  116s
     0     0 -20219.177    0  707 -24049.612 -20219.177  15.9%     -  118s
     0     2 -20219.177    0  707 -24049.612 -20219.177  15.9%     -  130s
     1     4 -20373.417    1  684 -24049.612 -20219.177  15.9%  2479  136s
     7    12 -20550.937    3  941 -24049.612 -20474.834  14.9%  4508  141s
    27    48 -21081.750    5  947 -24049.612 -20636.892  14.2%  3657  148s
    51    78 -21118.355    6  947 -24049.612 -20779.239  13.6%  3959  152s
    83   153 -21261.489    7  937 -24049.612 -20893.139  13.1%  3467  156s
   175   189 -21983.525    8  556 -24049.612 -20935.928  12.9%  2524  161s
   252   209 -21280.162    8  791 -24049.612 -20937.570  12.9%  2152  166s
   294   228 -22076.945    9  513 -24049.612 -20937.570  12.9%  2148  171s
   349   245 -22229.710   10  717 -24049.612 -20937.570  12.9%  2159  176s
   404   262 -22308.272   11  624 -24049.612 -20937.570  12.9%  2218  180s
   449   275 -22255.679   11  801 -24049.612 -20937.570  12.9%  2258  185s
   500   283     cutoff   12      -24049.612 -20937.570  12.9%  2337  191s
   560   293     cutoff   12      -24049.612 -20937.570  12.9%  2367  195s
   623   313 -22790.690   12  545 -24049.612 -20937.570  12.9%  2380  202s
   663   334 -23088.617   13  510 -24049.612 -21053.695  12.5%  2359  207s
   716   351 -23098.036   14  574 -24049.612 -21053.695  12.5%  2382  211s
   782   375 -23105.978   15  590 -24049.612 -21118.154  12.2%  2354  215s
   843   402 -23136.621   16  569 -24049.612 -21118.154  12.2%  2317  221s
   900   434 -23145.487   17  568 -24049.612 -21118.154  12.2%  2342  227s
   975   471 -23299.843   18  519 -24049.612 -21118.154  12.2%  2345  231s
  1051   532 -23313.660   19  516 -24049.612 -21160.022  12.0%  2323  237s
  1138   578 -23334.974   20  511 -24049.612 -21160.022  12.0%  2282  240s
  1229   607 -23681.378   21  515 -24049.612 -21160.022  12.0%  2224  247s
  1354   601 -23368.430   28   83 -24049.612 -21249.134  11.6%  2164  252s
  1492   612 -23071.508   11  250 -24049.612 -21537.521  10.4%  2105  256s
  1609   611 -23828.582   13  251 -24049.612 -21537.521  10.4%  2108  263s
  1713   615     cutoff   14      -24049.612 -21637.384  10.0%  2142  269s
  1810   608 -22600.628   13  287 -24049.612 -21637.384  10.0%  2178  275s
  1937   616 infeasible   15      -24049.612 -21637.384  10.0%  2185  281s
  2040   617 infeasible   21      -24049.612 -21695.614  9.79%  2221  286s
  2167   607 infeasible   13      -24049.612 -21955.020  8.71%  2240  292s
  2294   600 -23383.571   11  561 -24049.612 -22061.187  8.27%  2233  298s
  2455   586 -23837.317   18  281 -24049.612 -22061.187  8.27%  2227  306s
  2548   583     cutoff   12      -24049.612 -22213.430  7.63%  2263  312s
  2667   566 -23838.800   24  323 -24049.612 -22264.517  7.42%  2276  319s
  2820   541 infeasible   14      -24049.612 -22268.766  7.40%  2259  326s
  2971   490 infeasible   17      -24049.612 -22400.155  6.86%  2272  334s
  3133   433     cutoff   19      -24049.612 -22489.847  6.49%  2261  341s
  3369   369 infeasible   20      -24049.612 -22577.862  6.12%  2218  349s
  3565   279     cutoff   15      -24049.612 -22727.845  5.50%  2214  355s
  3792   150 -23958.757   16  469 -24049.612 -22819.431  5.12%  2179  364s
  4118    11 infeasible   21      -24049.612 -23051.698  4.15%  2110  369s

Cutting planes:
  Learned: 1
  Cover: 2
  Implied bound: 30
  MIR: 415
  Flow cover: 1519
  Zero half: 12
  RLT: 17
  Relax-and-lift: 47

Explored 4367 nodes (9059878 simplex iterations) in 369.55 seconds (1108.91 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24049.6 -24053.6 -24070.6 ... -24216
No other solutions better than -24049.6

Optimal solution found (tolerance 1.00e-06)
Best objective -2.404961236716e+04, best bound -2.404961236716e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 369.57s
  Master Objective (UB) = -24049.61, θ = 87139.97
  Upper Bound (UB) = -24049.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87139.97
  [DEBUG]   ✓ Scenario 0: θ = 87139.97 ≤ Q = 87139.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87139.97 ≤ Q = 87139.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87139.97 ≤ Q = 87139.97 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87139.97 ≤ Q = 87139.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87139.97 ≤ Q = 87139.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87139.97 ≤ Q = 87139.97 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87139.97 ≤ Q = 87139.97 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1a1f0576
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1a1f0576
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.420083e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6665325.4738
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.086358e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108635.75    0  122 6665325.47 -108635.75   102%     -    0s
H    0     0                    -78794.80134 -108635.75  37.9%     -    0s
H    0     0                    -79220.81187 -108635.75  37.1%     -    0s
H    0     0                    -84530.21138 -86016.592  1.76%     -    0s
     0     0 -86016.592    0   55 -84530.211 -86016.592  1.76%     -    0s
     0     0 -85729.751    0   55 -84530.211 -85729.751  1.42%     -    0s
H    0     0                    -84815.98794 -85729.751  1.08%     -    0s
     0     0 -85616.788    0   56 -84815.988 -85616.788  0.94%     -    0s
H    0     0                    -84816.18353 -85616.788  0.94%     -    0s
     0     0 -85567.985    0   58 -84816.184 -85567.985  0.89%     -    0s
     0     0 -85533.754    0   57 -84816.184 -85533.754  0.85%     -    0s
     0     0 -85533.754    0   55 -84816.184 -85533.754  0.85%     -    0s
     0     0 -85083.282    0   44 -84816.184 -85083.282  0.31%     -    0s
     0     0 -84978.006    0   37 -84816.184 -84978.006  0.19%     -    0s
     0     0 -84892.436    0   14 -84816.184 -84892.436  0.09%     -    0s
     0     0 -84848.489    0    6 -84816.184 -84848.489  0.04%     -    0s
     0     0     cutoff    0      -84816.184 -84816.184  0.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 128
  Flow cover: 15
  RLT: 29
  Relax-and-lift: 7
  BQP: 11

Explored 1 nodes (543 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -84816.2 -79220.8 -78794.8 ... 1.42008e+13
No other solutions better than -84816.2

Optimal solution found (tolerance 1.00e-06)
Best objective -8.481618352558e+04, best bound -8.481618352558e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 83109.32
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84816.18
  [DEBUG]   S×d_nominal = 167925.50
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 167925.50 + -84816.18 = 83109.32
  [DEBUG]   Current θ from Master = 87139.97
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4030.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28080.26
  Lower Bound (LB) = -26924.21
  Gap (UB-LB) = 2874.6000, Absolute Gap = 2874.6000, Relative Gap = 0.119528
  Not converged yet (gap = 2874.60 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351175 nonzeros
Model fingerprint: 0x928d26dd
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63024 rows and 25584 columns
Presolve time: 0.84s
Presolved: 60679 rows, 26596 columns, 376959 nonzeros
Variable types: 24337 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60679 rows, 26596 columns, 376959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31648   -3.0157812e+04   0.000000e+00   2.037684e+07      5s
   40488   -2.1297727e+04   0.000000e+00   4.331878e+06     10s
   47577   -1.6533451e+04   0.000000e+00   3.761666e+06     15s
   55243   -1.5175442e+04   0.000000e+00   1.937210e+06     20s
   61411   -1.5005590e+04   0.000000e+00   1.684773e+06     25s
   66845   -1.4998314e+04   0.000000e+00   1.343128e+07     30s
   72422   -1.4945053e+04   0.000000e+00   1.000974e+07     35s
   77713   -1.4916543e+04   0.000000e+00   2.378292e+06     40s
   83818   -1.4664266e+04   0.000000e+00   4.084554e+05     45s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective -1.361868e+04, 70880 iterations, 47.36 seconds (102.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13618.675    0  456 -205910.05 -13618.675  93.4%     -   48s
H    0     0                    -201621.8549 -13618.675  93.2%     -   48s
H    0     0                    -163810.3803 -13618.675  91.7%     -   48s
H    0     0                    -163707.6197 -13618.675  91.7%     -   48s
H    0     0                    -163109.0782 -13618.675  91.7%     -   49s
H    0     0                    -162970.2033 -13618.675  91.6%     -   49s
H    0     0                    -162925.6499 -13618.675  91.6%     -   49s
H    0     0                    -162786.7750 -13618.675  91.6%     -   49s
H    0     0                    -155254.0972 -13618.675  91.2%     -   49s
H    0     0                    -82659.11968 -13618.675  83.5%     -   49s
H    0     0                    -82290.52949 -13618.675  83.5%     -   49s
H    0     0                    -73453.44519 -13618.675  81.5%     -   49s
H    0     0                    -73258.20834 -13618.675  81.4%     -   49s
H    0     0                    -67369.18388 -13618.675  79.8%     -   49s
H    0     0                    -67296.91641 -13618.675  79.8%     -   49s
H    0     0                    -59559.46822 -13618.675  77.1%     -   50s
H    0     0                    -45275.10169 -13618.675  69.9%     -   50s
     0     0 -17050.199    0  590 -45275.102 -17050.199  62.3%     -   60s
H    0     0                    -42836.25229 -17050.199  60.2%     -   60s
H    0     0                    -41001.67082 -17050.199  58.4%     -   60s
H    0     0                    -40847.96070 -17050.199  58.3%     -   60s
     0     0 -17131.686    0  590 -40847.961 -17131.686  58.1%     -   63s
     0     0 -17171.783    0  597 -40847.961 -17171.783  58.0%     -   63s
     0     0 -17171.783    0  589 -40847.961 -17171.783  58.0%     -   65s
     0     0 -17171.783    0  593 -40847.961 -17171.783  58.0%     -   65s
     0     0 -17171.783    0  587 -40847.961 -17171.783  58.0%     -   66s
     0     0 -17171.783    0  597 -40847.961 -17171.783  58.0%     -   67s
     0     0 -17171.783    0  597 -40847.961 -17171.783  58.0%     -   67s
     0     0 -17171.783    0  599 -40847.961 -17171.783  58.0%     -   68s
     0     0 -17171.783    0  597 -40847.961 -17171.783  58.0%     -   68s
     0     0 -17174.627    0  597 -40847.961 -17174.627  58.0%     -   68s
     0     0 -17174.627    0  597 -40847.961 -17174.627  58.0%     -   68s
     0     0 -18214.536    0  798 -40847.961 -18214.536  55.4%     -   75s
H    0     0                    -36349.94062 -18216.261  49.9%     -   75s
H    0     0                    -35310.33725 -18216.261  48.4%     -   75s
H    0     0                    -35238.57333 -18216.261  48.3%     -   75s
     0     0 -18479.335    0  719 -35238.573 -18479.335  47.6%     -   77s
     0     0 -18579.237    0  787 -35238.573 -18579.237  47.3%     -   79s
H    0     0                    -25016.29747 -18587.444  25.7%     -   79s
H    0     0                    -24781.43957 -18587.444  25.0%     -   79s
H    0     0                    -24314.29451 -18587.444  23.6%     -   79s
H    0     0                    -24311.80302 -18587.444  23.5%     -   79s
H    0     0                    -24250.24192 -18587.444  23.4%     -   79s
     0     0 -18587.444    0  788 -24250.242 -18587.444  23.4%     -   79s
     0     0 -18587.590    0  791 -24250.242 -18587.590  23.4%     -   80s
H    0     0                    -24247.14694 -19052.059  21.4%     -   87s
H    0     0                    -24221.99705 -19052.059  21.3%     -   87s
     0     0 -19052.059    0  578 -24221.997 -19052.059  21.3%     -   87s
     0     0 -19253.802    0  657 -24221.997 -19253.802  20.5%     -   90s
H    0     0                    -24218.04584 -19320.256  20.2%     -   92s
     0     0 -19320.256    0  655 -24218.046 -19320.256  20.2%     -   92s
H    0     0                    -24094.39133 -19348.917  19.7%     -   93s
     0     0 -19348.917    0  658 -24094.391 -19348.917  19.7%     -   93s
     0     0 -19384.162    0  584 -24094.391 -19384.162  19.5%     -   95s
     0     0 -19387.508    0  591 -24094.391 -19387.508  19.5%     -   96s
     0     0 -19396.690    0  576 -24094.391 -19396.690  19.5%     -   97s
     0     0 -19398.674    0  580 -24094.391 -19398.674  19.5%     -   97s
     0     0 -19402.980    0  659 -24094.391 -19402.980  19.5%     -   97s
     0     0 -19404.072    0  674 -24094.391 -19404.072  19.5%     -   98s
     0     0 -19404.085    0  675 -24094.391 -19404.085  19.5%     -   98s
     0     0 -19565.823    0  600 -24094.391 -19565.823  18.8%     -  104s
H    0     0                    -24077.30083 -19631.695  18.5%     -  106s
     0     0 -19631.695    0  611 -24077.301 -19631.695  18.5%     -  106s
     0     0 -19657.145    0  616 -24077.301 -19657.145  18.4%     -  107s
     0     0 -19757.269    0  766 -24077.301 -19757.269  17.9%     -  110s
     0     0 -19788.432    0  612 -24077.301 -19788.432  17.8%     -  111s
     0     0 -19806.498    0  698 -24077.301 -19806.498  17.7%     -  112s
     0     0 -19814.329    0  694 -24077.301 -19814.329  17.7%     -  113s
     0     0 -19825.633    0  614 -24077.301 -19825.633  17.7%     -  114s
     0     0 -19843.620    0  703 -24077.301 -19843.620  17.6%     -  115s
     0     0 -19846.088    0  708 -24077.301 -19846.088  17.6%     -  116s
     0     0 -19847.005    0  712 -24077.301 -19847.005  17.6%     -  116s
     0     0 -19847.997    0  718 -24077.301 -19847.997  17.6%     -  116s
     0     0 -19848.695    0  722 -24077.301 -19848.695  17.6%     -  116s
     0     0 -19934.852    0  766 -24077.301 -19934.852  17.2%     -  120s
     0     0 -19959.560    0  696 -24077.301 -19959.560  17.1%     -  122s
     0     0 -19967.207    0  713 -24077.301 -19967.207  17.1%     -  123s
     0     0 -19970.696    0  712 -24077.301 -19970.696  17.1%     -  123s
     0     0 -19974.080    0  707 -24077.301 -19974.080  17.0%     -  124s
     0     0 -19976.701    0  714 -24077.301 -19976.701  17.0%     -  124s
     0     0 -19977.237    0  710 -24077.301 -19977.237  17.0%     -  124s
     0     0 -20055.891    0  709 -24077.301 -20055.891  16.7%     -  129s
H    0     0                    -24072.73768 -20072.896  16.6%     -  130s
     0     0 -20072.896    0  725 -24072.738 -20072.896  16.6%     -  130s
     0     0 -20083.711    0  722 -24072.738 -20083.711  16.6%     -  131s
     0     0 -20088.822    0  644 -24072.738 -20088.822  16.5%     -  132s
     0     0 -20088.985    0  650 -24072.738 -20088.985  16.5%     -  132s
     0     0 -20165.613    0  721 -24072.738 -20165.613  16.2%     -  135s
     0     0 -20182.437    0  721 -24072.738 -20182.437  16.2%     -  136s
     0     0 -20201.699    0  815 -24072.738 -20201.699  16.1%     -  137s
     0     0 -20212.473    0  729 -24072.738 -20212.473  16.0%     -  137s
     0     0 -20223.059    0  727 -24072.738 -20223.059  16.0%     -  138s
     0     0 -20227.031    0  745 -24072.738 -20227.031  16.0%     -  139s
     0     0 -20228.299    0  749 -24072.738 -20228.299  16.0%     -  139s
     0     0 -20228.974    0  753 -24072.738 -20228.974  16.0%     -  139s
     0     0 -20282.415    0  722 -24072.738 -20282.415  15.7%     -  142s
     0     0 -20288.734    0  742 -24072.738 -20288.734  15.7%     -  143s
     0     0 -20291.809    0  749 -24072.738 -20291.809  15.7%     -  143s
     0     0 -20301.411    0  747 -24072.738 -20301.411  15.7%     -  144s
     0     0 -20304.365    0  739 -24072.738 -20304.365  15.7%     -  144s
     0     0 -20304.930    0  747 -24072.738 -20304.930  15.7%     -  145s
     0     0 -20323.908    0  736 -24072.738 -20323.908  15.6%     -  147s
     0     0 -20326.882    0  736 -24072.738 -20326.882  15.6%     -  147s
     0     0 -20329.419    0  741 -24072.738 -20329.419  15.6%     -  148s
     0     0 -20331.048    0  737 -24072.738 -20331.048  15.5%     -  148s
     0     0 -20334.163    0  747 -24072.738 -20334.163  15.5%     -  149s
     0     0 -20334.845    0  746 -24072.738 -20334.845  15.5%     -  149s
     0     0 -20357.698    0  733 -24072.738 -20357.698  15.4%     -  151s
     0     0 -20384.849    0  728 -24072.738 -20384.849  15.3%     -  153s
     0     0 -20387.116    0  745 -24072.738 -20387.116  15.3%     -  153s
     0     0 -20387.493    0  740 -24072.738 -20387.493  15.3%     -  154s
     0     0 -20399.882    0  751 -24072.738 -20399.882  15.3%     -  156s
     0     0 -20402.863    0  730 -24072.738 -20402.863  15.2%     -  157s
     0     0 -20405.822    0  749 -24072.738 -20405.822  15.2%     -  157s
     0     0 -20405.966    0  746 -24072.738 -20405.966  15.2%     -  158s
     0     0 -20419.064    0  749 -24072.738 -20419.064  15.2%     -  159s
     0     0 -20422.566    0  753 -24072.738 -20422.566  15.2%     -  162s
     0     0 -20422.955    0  761 -24072.738 -20422.955  15.2%     -  162s
     0     0 -20425.239    0  749 -24072.738 -20425.239  15.2%     -  164s
     0     0 -20425.721    0  754 -24072.738 -20425.721  15.1%     -  164s
     0     0 -20425.721    0  752 -24072.738 -20425.721  15.1%     -  165s
     0     0 -20425.833    0  548 -24072.738 -20425.833  15.1%     -  166s
     0     0 -20432.856    0  580 -24072.738 -20432.856  15.1%     -  167s
     0     0 -20437.874    0  587 -24072.738 -20437.874  15.1%     -  168s
     0     0 -20438.311    0  588 -24072.738 -20438.311  15.1%     -  168s
     0     0 -20448.240    0  579 -24072.738 -20448.240  15.1%     -  169s
     0     0 -20450.841    0  578 -24072.738 -20450.841  15.0%     -  175s
     0     0 -20452.177    0  583 -24072.738 -20452.177  15.0%     -  176s
     0     0 -20453.468    0  660 -24072.738 -20453.468  15.0%     -  176s
     0     0 -20453.585    0  659 -24072.738 -20453.585  15.0%     -  177s
     0     0 -20457.929    0  735 -24072.738 -20457.929  15.0%     -  178s
     0     0 -20459.512    0  738 -24072.738 -20459.512  15.0%     -  179s
     0     0 -20460.421    0  816 -24072.738 -20460.421  15.0%     -  179s
     0     0 -20460.602    0  552 -24072.738 -20460.602  15.0%     -  179s
     0     0 -20468.319    0  884 -24072.738 -20468.319  15.0%     -  181s
     0     0 -20474.786    0  755 -24072.738 -20474.786  14.9%     -  182s
     0     0 -20475.047    0  758 -24072.738 -20475.047  14.9%     -  182s
     0     0 -20497.068    0  841 -24072.738 -20497.068  14.9%     -  185s
     0     0 -20503.138    0  570 -24072.738 -20503.138  14.8%     -  186s
     0     0 -20504.676    0  756 -24072.738 -20504.676  14.8%     -  186s
     0     0 -20511.921    0  839 -24072.738 -20511.921  14.8%     -  187s
     0     0 -20512.760    0  839 -24072.738 -20512.760  14.8%     -  188s
     0     0 -20519.130    0  845 -24072.738 -20519.130  14.8%     -  189s
     0     0 -20521.608    0  840 -24072.738 -20521.608  14.8%     -  192s
     0     0 -20521.895    0  839 -24072.738 -20521.895  14.8%     -  192s
     0     0 -20523.137    0  841 -24072.738 -20523.137  14.7%     -  193s
     0     0 -20523.251    0  842 -24072.738 -20523.251  14.7%     -  194s
     0     0 -20523.574    0  841 -24072.738 -20523.574  14.7%     -  195s
     0     0 -20523.708    0  841 -24072.738 -20523.708  14.7%     -  197s
     0     2 -20523.708    0  841 -24072.738 -20523.708  14.7%     -  211s
     3     8 -20664.472    2  875 -24072.738 -20566.182  14.6%  3485  217s
     7    16 -20712.644    3  950 -24072.738 -20667.042  14.1%  3682  222s
    15    30 -20718.202    4  952 -24072.738 -20715.972  13.9%  2951  225s
    31    43 -20826.457    5  949 -24072.738 -20718.643  13.9%  3177  232s
    60    74 -20838.167    6  882 -24072.738 -20718.643  13.9%  3980  235s
   154   141 -21690.155    8  623 -24072.738 -20718.643  13.9%  2738  245s
   246   158 -20912.554    8  960 -24072.738 -20838.430  13.4%  2169  250s
   315   177 -20963.358    9  944 -24072.738 -20838.430  13.4%  2078  256s
   378   191 -21000.303   10  854 -24072.738 -20838.430  13.4%  2030  262s
   433   199 -21096.577   11  844 -24072.738 -20838.430  13.4%  2009  268s
   498   204 -21395.114   12  830 -24072.738 -20838.430  13.4%  1972  274s
   578   186 -22003.606   14  534 -24072.738 -20914.842  13.1%  2063  280s
   652   183 infeasible   12      -24072.738 -21000.904  12.8%  2020  286s
   714   171 -22901.500   10  245 -24072.738 -21000.904  12.8%  2105  292s
   765   162 infeasible   15      -24072.738 -21000.904  12.8%  2139  298s
   824   160 infeasible   10      -24072.738 -21000.904  12.8%  2150  304s
   877   174 infeasible   15      -24072.738 -21311.527  11.5%  2241  309s
   927   158     cutoff   14      -24072.738 -21311.527  11.5%  2222  315s
   992   139 infeasible   17      -24072.738 -22115.564  8.13%  2183  321s
  1065   107 -24012.929   10   80 -24072.738 -22115.564  8.13%  2124  326s
  1159    69 infeasible   11      -24072.738 -22115.564  8.13%  2024  330s
  1232    11 -23871.401   19  335 -24072.738 -22115.564  8.13%  1966  335s
  1302     3 infeasible   20      -24072.738 -22115.564  8.13%  1904  340s
  1315     0 infeasible   15      -24072.738 -23872.552  0.83%  1900  345s

Cutting planes:
  Cover: 1
  Implied bound: 5
  MIR: 505
  StrongCG: 1
  Flow cover: 1397
  Zero half: 11
  RLT: 17
  Relax-and-lift: 88

Explored 1317 nodes (2773667 simplex iterations) in 345.32 seconds (950.90 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24072.7 -24077.3 -24094.4 ... -24781.4
No other solutions better than -24072.7

Optimal solution found (tolerance 1.00e-06)
Best objective -2.407273768303e+04, best bound -2.407273768303e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 345.33s
  Master Objective (UB) = -24072.74, θ = 87511.05
  Upper Bound (UB) = -24072.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87511.05
  [DEBUG]   ✓ Scenario 0: θ = 87511.05 ≤ Q = 87511.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87511.05 ≤ Q = 87511.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87511.05 ≤ Q = 87511.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87511.05 ≤ Q = 87511.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87511.05 ≤ Q = 87511.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87511.05 ≤ Q = 87511.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87511.05 ≤ Q = 87511.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87511.05 ≤ Q = 87511.05 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6b007b68
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6b007b68
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-12, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6665668.0529
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.086308e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108630.81    0  122 6665668.05 -108630.81   102%     -    0s
H    0     0                    -78796.98237 -108630.81  37.9%     -    0s
H    0     0                    -79208.25238 -108630.81  37.1%     -    0s
     0     0 -84064.970    0   55 -79208.252 -84064.970  6.13%     -    0s
H    0     0                    -82134.02409 -84014.840  2.29%     -    0s
     0     0 -83874.772    0   58 -82134.024 -83874.772  2.12%     -    0s
H    0     0                    -82762.94127 -83724.537  1.16%     -    0s
H    0     0                    -82768.12969 -83724.537  1.16%     -    0s
     0     0 -83724.537    0   58 -82768.130 -83724.537  1.16%     -    0s
     0     0 -83658.645    0   58 -82768.130 -83658.645  1.08%     -    0s
     0     2 -83657.535    0   58 -82768.130 -83657.535  1.07%     -    0s

Cutting planes:
  Gomory: 14
  MIR: 163

Explored 84 nodes (713 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -82768.1 -79208.3 -78797 ... 1.42347e+13
No other solutions better than -82768.1

Optimal solution found (tolerance 1.00e-06)
Best objective -8.276812968504e+04, best bound -8.276812968504e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 85549.64
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82768.13
  [DEBUG]   S×d_nominal = 168317.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168317.77 + -82768.13 = 85549.64
  [DEBUG]   Current θ from Master = 87511.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1961.42 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26034.16
  Lower Bound (LB) = -26034.16
  Gap (UB-LB) = 1961.4188, Absolute Gap = 1961.4188, Relative Gap = 0.081479
  Not converged yet (gap = 1961.42 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394382 nonzeros
Model fingerprint: 0x49e3e817
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70902 rows and 28782 columns
Presolve time: 0.94s
Presolved: 68091 rows, 29638 columns, 423389 nonzeros
Variable types: 27379 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68091 rows, 29638 columns, 423389 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36842   -3.2102990e+04   0.000000e+00   7.493499e+07      5s
   45956   -2.8050363e+04   0.000000e+00   3.421244e+06     10s
   53107   -2.5554035e+04   0.000000e+00   1.715450e+06     15s
   59728   -2.1428998e+04   0.000000e+00   5.674095e+06     20s
   67490   -1.9166679e+04   0.000000e+00   6.767415e+06     25s
   74023   -1.7418518e+04   0.000000e+00   6.050828e+05     30s
   80384   -1.6095828e+04   0.000000e+00   4.224495e+06     35s
   86014   -1.5847244e+04   0.000000e+00   1.562120e+06     40s
   91864   -1.5498704e+04   0.000000e+00   1.790531e+07     45s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective -1.361868e+04, 82157 iterations, 48.12 seconds (107.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13618.675    0  456 -205910.05 -13618.675  93.4%     -   49s
H    0     0                    -202439.8367 -13618.675  93.3%     -   49s
H    0     0                    -134454.5513 -13618.675  89.9%     -   49s
H    0     0                    -130800.8949 -13618.675  89.6%     -   49s
H    0     0                    -125047.0870 -13618.675  89.1%     -   49s
H    0     0                    -82070.10463 -13618.675  83.4%     -   49s
H    0     0                    -81412.29583 -13618.675  83.3%     -   50s
H    0     0                    -69325.15901 -13618.675  80.4%     -   50s
H    0     0                    -67584.67157 -13618.675  79.8%     -   50s
H    0     0                    -67498.52398 -13618.675  79.8%     -   50s
H    0     0                    -67412.07519 -13618.675  79.8%     -   50s
H    0     0                    -59559.46822 -13618.675  77.1%     -   51s
H    0     0                    -45275.10169 -13618.675  69.9%     -   51s
     0     0 -17044.366    0  596 -45275.102 -17044.366  62.4%     -   62s
H    0     0                    -44647.64691 -17044.366  61.8%     -   63s
H    0     0                    -40777.69151 -17044.366  58.2%     -   63s
     0     0 -17144.668    0  589 -40777.692 -17144.668  58.0%     -   65s
     0     0 -17144.668    0  590 -40777.692 -17144.668  58.0%     -   65s
     0     0 -17160.424    0  595 -40777.692 -17160.424  57.9%     -   66s
     0     0 -17160.424    0  596 -40777.692 -17160.424  57.9%     -   66s
     0     0 -17189.362    0  594 -40777.692 -17189.362  57.8%     -   68s
     0     0 -17189.362    0  595 -40777.692 -17189.362  57.8%     -   69s
     0     0 -17189.362    0  596 -40777.692 -17189.362  57.8%     -   69s
     0     0 -18299.742    0  795 -40777.692 -18299.742  55.1%     -   79s
H    0     0                    -35505.00150 -18299.855  48.5%     -   79s
H    0     0                    -35366.20661 -18299.855  48.3%     -   79s
H    0     0                    -35327.73129 -18299.855  48.2%     -   79s
H    0     0                    -26209.15802 -18473.870  29.5%     -   83s
     0     0 -18473.870    0  802 -26209.158 -18473.870  29.5%     -   83s
     0     0 -18525.166    0  801 -26209.158 -18525.166  29.3%     -   84s
H    0     0                    -25607.75236 -18549.236  27.6%     -   85s
     0     0 -18549.236    0  811 -25607.752 -18549.236  27.6%     -   85s
H    0     0                    -24666.64233 -18551.341  24.8%     -   85s
H    0     0                    -24486.31343 -18551.341  24.2%     -   85s
H    0     0                    -24440.52336 -18551.341  24.1%     -   85s
H    0     0                    -24436.40939 -18551.341  24.1%     -   85s
H    0     0                    -24416.70593 -18551.341  24.0%     -   85s
H    0     0                    -24395.78614 -18551.341  24.0%     -   85s
     0     0 -18551.341    0  814 -24395.786 -18551.341  24.0%     -   85s
     0     0 -18652.873    0  813 -24395.786 -18652.873  23.5%     -   87s
     0     0 -18674.990    0  823 -24395.786 -18674.990  23.4%     -   88s
     0     0 -18742.547    0  810 -24395.786 -18742.547  23.2%     -   90s
     0     0 -18745.809    0  811 -24395.786 -18745.809  23.2%     -   90s
     0     0 -18763.437    0  821 -24395.786 -18763.437  23.1%     -   91s
     0     0 -18779.320    0  821 -24395.786 -18779.320  23.0%     -   91s
     0     0 -18779.320    0  821 -24395.786 -18779.320  23.0%     -   91s
H    0     0                    -24319.80265 -19469.276  19.9%     -  102s
H    0     0                    -24258.81708 -19469.276  19.7%     -  102s
     0     0 -19469.276    0  830 -24258.817 -19469.276  19.7%     -  102s
H    0     0                    -24255.34622 -19470.208  19.7%     -  102s
H    0     0                    -24254.60805 -19470.208  19.7%     -  102s
H    0     0                    -24253.10994 -19470.208  19.7%     -  102s
H    0     0                    -24246.29070 -19470.208  19.7%     -  102s
H    0     0                    -24243.19573 -19470.208  19.7%     -  102s
     0     0 -19591.625    0  832 -24243.196 -19591.625  19.2%     -  106s
     0     0 -19667.121    0  770 -24243.196 -19667.121  18.9%     -  109s
     0     0 -19679.040    0  688 -24243.196 -19679.040  18.8%     -  110s
     0     0 -19697.109    0  699 -24243.196 -19697.109  18.8%     -  111s
     0     0 -19716.084    0  688 -24243.196 -19716.084  18.7%     -  112s
     0     0 -19722.277    0  685 -24243.196 -19722.277  18.6%     -  113s
     0     0 -19723.183    0  691 -24243.196 -19723.183  18.6%     -  113s
     0     0 -19723.268    0  692 -24243.196 -19723.268  18.6%     -  114s
     0     0 -19952.309    0  624 -24243.196 -19952.309  17.7%     -  120s
     0     0 -20033.119    0  852 -24243.196 -20033.119  17.4%     -  124s
     0     0 -20033.119    0  852 -24243.196 -20033.119  17.4%     -  124s
     0     0 -20065.635    0  843 -24243.196 -20065.635  17.2%     -  126s
     0     0 -20069.783    0  859 -24243.196 -20069.783  17.2%     -  126s
     0     0 -20069.783    0  859 -24243.196 -20069.783  17.2%     -  126s
     0     0 -20072.316    0  858 -24243.196 -20072.316  17.2%     -  127s
     0     0 -20073.315    0  858 -24243.196 -20073.315  17.2%     -  127s
     0     0 -20073.315    0  858 -24243.196 -20073.315  17.2%     -  127s
     0     0 -20084.956    0  848 -24243.196 -20084.956  17.2%     -  128s
     0     0 -20087.326    0  859 -24243.196 -20087.326  17.1%     -  129s
     0     0 -20087.878    0  860 -24243.196 -20087.878  17.1%     -  129s
     0     0 -20149.192    0  855 -24243.196 -20149.192  16.9%     -  134s
     0     0 -20157.604    0  804 -24243.196 -20157.604  16.9%     -  135s
     0     0 -20162.038    0  791 -24243.196 -20162.038  16.8%     -  136s
     0     0 -20162.038    0  791 -24243.196 -20162.038  16.8%     -  136s
     0     0 -20162.530    0  796 -24243.196 -20162.530  16.8%     -  136s
     0     0 -20190.119    0  798 -24243.196 -20190.119  16.7%     -  139s
     0     0 -20196.815    0  876 -24243.196 -20196.815  16.7%     -  141s
     0     0 -20197.185    0  876 -24243.196 -20197.185  16.7%     -  142s
     0     0 -20230.748    0  879 -24243.196 -20230.748  16.6%     -  146s
     0     0 -20242.308    0  876 -24243.196 -20242.308  16.5%     -  147s
     0     0 -20246.363    0  808 -24243.196 -20246.363  16.5%     -  148s
     0     0 -20247.673    0  883 -24243.196 -20247.673  16.5%     -  149s
     0     0 -20248.640    0  896 -24243.196 -20248.640  16.5%     -  149s
     0     0 -20249.300    0  886 -24243.196 -20249.300  16.5%     -  150s
     0     0 -20257.047    0  893 -24243.196 -20257.047  16.4%     -  152s
     0     0 -20267.431    0  830 -24243.196 -20267.431  16.4%     -  153s
     0     0 -20268.731    0  560 -24243.196 -20268.731  16.4%     -  154s
     0     0 -20269.177    0  562 -24243.196 -20269.177  16.4%     -  154s
     0     0 -20277.089    0  834 -24243.196 -20277.089  16.4%     -  156s
     0     0 -20279.795    0  831 -24243.196 -20279.795  16.3%     -  157s
     0     0 -20281.071    0  829 -24243.196 -20281.071  16.3%     -  157s
     0     0 -20281.268    0  831 -24243.196 -20281.268  16.3%     -  157s
     0     0 -20283.657    0  820 -24243.196 -20283.657  16.3%     -  159s
     0     0 -20284.030    0  830 -24243.196 -20284.030  16.3%     -  160s
     0     0 -20296.738    0  829 -24243.196 -20296.738  16.3%     -  162s
H    0     0                    -24174.01235 -20305.130  16.0%     -  163s
H    0     0                    -24132.11239 -20305.130  15.9%     -  163s
H    0     0                    -24089.56137 -20305.130  15.7%     -  163s
     0     0 -20305.130    0  907 -24089.561 -20305.130  15.7%     -  164s
     0     0 -20306.615    0  914 -24089.561 -20306.615  15.7%     -  164s
     0     0 -20306.957    0  921 -24089.561 -20306.957  15.7%     -  164s
H    0     0                    -24079.16084 -20330.818  15.6%     -  167s
     0     0 -20330.818    0  921 -24079.161 -20330.818  15.6%     -  167s
     0     0 -20331.295    0  923 -24079.161 -20331.295  15.6%     -  167s
     0     0 -20332.768    0  841 -24079.161 -20332.768  15.6%     -  169s
     0     0 -20333.705    0  837 -24079.161 -20333.705  15.6%     -  170s
     0     0 -20334.397    0  836 -24079.161 -20334.397  15.6%     -  170s
     0     0 -20335.662    0  845 -24079.161 -20335.662  15.5%     -  171s
     0     0 -20335.662    0  845 -24079.161 -20335.662  15.5%     -  171s
     0     0 -20336.491    0  845 -24079.161 -20336.491  15.5%     -  172s
     0     0 -20338.571    0  849 -24079.161 -20338.571  15.5%     -  173s
     0     0 -20338.637    0  849 -24079.161 -20338.637  15.5%     -  176s
     0     2 -20338.637    0  849 -24079.161 -20338.637  15.5%     -  189s
     1     4 -20408.783    1  876 -24079.161 -20339.076  15.5%  2932  192s
     3     8 -20417.200    2  875 -24079.161 -20408.871  15.2%  2759  199s
     7    16 -20547.147    3  804 -24079.161 -20417.556  15.2%  3659  201s
    15    32 -20576.811    4  817 -24079.161 -20495.060  14.9%  3081  207s
    31    60 -20705.102    5  859 -24079.161 -20580.587  14.5%  4300  214s
    63    92 -20786.415    6  861 -24079.161 -20705.420  14.0%  3950  220s
    95   138 -21024.365    7  865 -24079.161 -20787.534  13.7%  4226  226s
   163   142 -21613.389    8  525 -24079.161 -20787.534  13.7%  3341  234s
   242   161 -21027.495    8  863 -24079.161 -21024.373  12.7%  3280  239s
   293   189 -21085.626    9  849 -24079.161 -21024.373  12.7%  3109  245s
   385   188 infeasible   11      -24079.161 -21029.337  12.7%  2948  252s
   457   197 -21127.702   10  847 -24079.161 -21029.337  12.7%  2961  258s
   532   207 infeasible   13      -24079.161 -21029.337  12.7%  2885  265s
   594   212 -23812.502   15   44 -24079.161 -21029.337  12.7%  2863  272s
   660   207 infeasible   12      -24079.161 -21029.337  12.7%  2958  279s
   719   195 infeasible   13      -24079.161 -21168.646  12.1%  3037  286s
   781   203 -23270.687   10  434 -24079.161 -21376.067  11.2%  3078  291s
   833   197 -23682.692   11  419 -24079.161 -21376.067  11.2%  3125  297s
   906   200     cutoff   12      -24079.161 -21376.067  11.2%  2993  304s
   961   186 infeasible   11      -24079.161 -21376.067  11.2%  2947  310s
  1038   165 infeasible   17      -24079.161 -21723.738  9.78%  2909  316s
  1101   135 infeasible   18      -24079.161 -21822.522  9.37%  2893  322s
  1194   113 infeasible   19      -24079.161 -22134.896  8.07%  2855  328s
  1281    99 infeasible   11      -24079.161 -22135.222  8.07%  2821  336s
  1362    45 infeasible   13      -24079.161 -22135.222  8.07%  2794  340s
  1453    23 infeasible    9      -24079.161 -22870.478  5.02%  2763  345s
  1536    13 infeasible   24      -24079.161 -23745.102  1.39%  2725  353s
  1600     7 -24017.255   15   29 -24079.161 -23967.766  0.46%  2641  355s

Cutting planes:
  Learned: 1
  Implied bound: 6
  MIR: 500
  Flow cover: 1602
  Zero half: 8
  RLT: 17
  Relax-and-lift: 68

Explored 1646 nodes (4482043 simplex iterations) in 356.11 seconds (973.22 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24079.2 -24089.6 -24132.1 ... -24258.8
No other solutions better than -24079.2

Optimal solution found (tolerance 1.00e-06)
Best objective -2.407916084138e+04, best bound -2.407916084138e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 356.11s
  Master Objective (UB) = -24079.16, θ = 87216.27
  Upper Bound (UB) = -24079.16

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87216.27
  [DEBUG]   ✓ Scenario 0: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87216.27 ≤ Q = 87216.27 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x496ca252
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb6935dae
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6659756.4923
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.087920e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108791.99    0  122 6659756.49 -108791.99   102%     -    0s
H    0     0                    -78929.26096 -108791.99  37.8%     -    0s
H    0     0                    -79355.27150 -108791.99  37.1%     -    0s
     0     0 -84745.561    0   55 -79355.271 -84745.561  6.79%     -    0s
H    0     0                    -82702.26385 -84651.603  2.36%     -    0s
     0     0 -84508.280    0   56 -82702.264 -84508.280  2.18%     -    0s
H    0     0                    -83319.62175 -84441.854  1.35%     -    0s
H    0     0                    -83337.33009 -84441.854  1.33%     -    0s
     0     0 -84283.348    0   58 -83337.330 -84283.348  1.14%     -    0s
     0     0 -84227.296    0   59 -83337.330 -84227.296  1.07%     -    0s
     0     0 -84226.437    0   60 -83337.330 -84226.437  1.07%     -    0s
     0     0 -84194.830    0   61 -83337.330 -84194.830  1.03%     -    0s
     0     0 -84168.822    0   61 -83337.330 -84168.822  1.00%     -    0s
     0     2 -84168.822    0   61 -83337.330 -84168.822  1.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 132
  BQP: 1

Explored 70 nodes (700 simplex iterations) in 0.10 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -83337.3 -79355.3 -78929.3 ... 1.42347e+13
No other solutions better than -83337.3

Optimal solution found (tolerance 1.00e-06)
Best objective -8.333733008587e+04, best bound -8.333733008587e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 84793.00
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83337.33
  [DEBUG]   S×d_nominal = 168130.33
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168130.33 + -83337.33 = 84793.00
  [DEBUG]   Current θ from Master = 87216.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2423.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26502.43
  Lower Bound (LB) = -26034.16
  Gap (UB-LB) = 1954.9956, Absolute Gap = 1954.9956, Relative Gap = 0.081190
  Not converged yet (gap = 1955.00 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437589 nonzeros
Model fingerprint: 0x7ef5562f
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78780 rows and 31980 columns
Presolve time: 1.07s
Presolved: 75503 rows, 32680 columns, 469819 nonzeros
Variable types: 30421 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75503 rows, 32680 columns, 469819 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34487   -3.4766356e+04   0.000000e+00   1.553090e+07      5s
   44362   -1.7751589e+04   0.000000e+00   4.047600e+06     10s
   50364   -1.7109445e+04   0.000000e+00   8.879525e+05     15s
   56330   -1.6508438e+04   0.000000e+00   6.610725e+05     20s
   61511   -1.6196980e+04   0.000000e+00   1.610576e+07     25s
   66535   -1.6169239e+04   0.000000e+00   2.234424e+06     30s
   71402   -1.6011300e+04   0.000000e+00   7.119500e+06     35s
Concurrent spin time: 3.29s

Solved with dual simplex

Root relaxation: objective -1.361868e+04, 63206 iterations, 37.42 seconds (85.93 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -13618.675    0  456 -205910.05 -13618.675  93.4%     -   39s
H    0     0                    -204215.3983 -13618.675  93.3%     -   39s
H    0     0                    -178040.8937 -13618.675  92.4%     -   39s
H    0     0                    -145773.0765 -13618.675  90.7%     -   39s
H    0     0                    -145403.6728 -13618.675  90.6%     -   39s
H    0     0                    -142530.1750 -13618.675  90.4%     -   39s
H    0     0                    -142299.6464 -13618.675  90.4%     -   39s
H    0     0                    -141779.7400 -13618.675  90.4%     -   39s
H    0     0                    -139369.3195 -13618.675  90.2%     -   39s
H    0     0                    -139243.8202 -13618.675  90.2%     -   39s
H    0     0                    -90070.92644 -13618.675  84.9%     -   39s
H    0     0                    -89702.33624 -13618.675  84.8%     -   39s
H    0     0                    -89557.28677 -13618.675  84.8%     -   39s
H    0     0                    -86377.88842 -13618.675  84.2%     -   39s
H    0     0                    -69187.29043 -13618.675  80.3%     -   39s
H    0     0                    -67296.91641 -13618.675  79.8%     -   39s
H    0     0                    -51380.39282 -13618.675  73.5%     -   41s
H    0     0                    -51210.88559 -13618.675  73.4%     -   41s
H    0     0                    -50423.88531 -13618.675  73.0%     -   41s
H    0     0                    -50415.85129 -13618.675  73.0%     -   41s
     0     0 -16678.102    0  588 -50415.851 -16678.102  66.9%     -   53s
H    0     0                    -46981.08890 -16683.160  64.5%     -   53s
H    0     0                    -46054.18104 -16683.160  63.8%     -   53s
H    0     0                    -46036.16354 -16683.160  63.8%     -   53s
     0     0 -16982.084    0  574 -46036.164 -16982.084  63.1%     -   56s
     0     0 -16982.084    0  587 -46036.164 -16982.084  63.1%     -   59s
     0     0 -16982.084    0  574 -46036.164 -16982.084  63.1%     -   59s
     0     0 -17009.187    0  571 -46036.164 -17009.187  63.1%     -   60s
     0     0 -17009.450    0  583 -46036.164 -17009.450  63.1%     -   60s
H    0     0                    -40994.56939 -18220.008  55.6%     -   69s
H    0     0                    -40909.10822 -18220.008  55.5%     -   69s
H    0     0                    -40907.69143 -18220.008  55.5%     -   69s
H    0     0                    -40882.41052 -18220.008  55.4%     -   69s
H    0     0                    -40880.77264 -18220.008  55.4%     -   69s
H    0     0                    -40880.27480 -18220.008  55.4%     -   69s
H    0     0                    -40878.64231 -18220.008  55.4%     -   69s
H    0     0                    -40878.50368 -18220.008  55.4%     -   69s
     0     0 -18220.008    0  795 -40878.504 -18220.008  55.4%     -   69s
H    0     0                    -30609.86674 -18220.064  40.5%     -   69s
H    0     0                    -26819.56414 -18220.064  32.1%     -   70s
H    0     0                    -26694.87122 -18220.064  31.7%     -   70s
     0     0 -18385.958    0  669 -26694.871 -18385.958  31.1%     -   72s
H    0     0                    -26458.70405 -18393.518  30.5%     -   73s
H    0     0                    -24326.96988 -18393.518  24.4%     -   73s
H    0     0                    -24325.75509 -18393.518  24.4%     -   73s
     0     0 -18393.518    0  669 -24325.755 -18393.518  24.4%     -   73s
     0     0 -18398.290    0  665 -24325.755 -18398.290  24.4%     -   73s
     0     0 -18461.150    0  731 -24325.755 -18461.150  24.1%     -   75s
     0     0 -18529.499    0  673 -24325.755 -18529.499  23.8%     -   77s
     0     0 -18531.691    0  675 -24325.755 -18531.691  23.8%     -   78s
     0     0 -18532.930    0  677 -24325.755 -18532.930  23.8%     -   78s
     0     0 -18534.151    0  674 -24325.755 -18534.151  23.8%     -   79s
     0     0 -18535.501    0  680 -24325.755 -18535.501  23.8%     -   79s
     0     0 -18558.912    0  685 -24325.755 -18558.912  23.7%     -   80s
     0     0 -18559.392    0  685 -24325.755 -18559.392  23.7%     -   80s
     0     0 -19079.348    0  714 -24325.755 -19079.348  21.6%     -   88s
H    0     0                    -24323.10098 -19081.139  21.6%     -   89s
H    0     0                    -24319.76916 -19081.139  21.5%     -   89s
H    0     0                    -24299.47251 -19081.139  21.5%     -   89s
H    0     0                    -24243.93104 -19293.035  20.4%     -   93s
     0     0 -19293.035    0  744 -24243.931 -19293.035  20.4%     -   93s
     0     0 -19376.939    0  670 -24243.931 -19376.939  20.1%     -   97s
H    0     0                    -24242.16738 -19446.898  19.8%     -   99s
H    0     0                    -24234.13336 -19446.898  19.8%     -   99s
H    0     0                    -24232.91858 -19446.898  19.8%     -   99s
     0     0 -19446.898    0  677 -24232.919 -19446.898  19.8%     -   99s
     0     0 -19451.451    0  692 -24232.919 -19451.451  19.7%     -  100s
     0     0 -19572.444    0  742 -24232.919 -19572.444  19.2%     -  103s
     0     0 -19617.327    0  752 -24232.919 -19617.327  19.0%     -  105s
     0     0 -19627.481    0  755 -24232.919 -19627.481  19.0%     -  106s
     0     0 -19631.342    0  756 -24232.919 -19631.342  19.0%     -  107s
     0     0 -19631.516    0  758 -24232.919 -19631.516  19.0%     -  107s
     0     0 -19812.707    0  603 -24232.919 -19812.707  18.2%     -  114s
H    0     0                    -24173.13588 -19853.972  17.9%     -  117s
     0     0 -19853.972    0  622 -24173.136 -19853.972  17.9%     -  117s
     0     0 -19864.071    0  530 -24173.136 -19864.071  17.8%     -  119s
     0     0 -19866.633    0  622 -24173.136 -19866.633  17.8%     -  120s
     0     0 -19869.355    0  625 -24173.136 -19869.355  17.8%     -  121s
     0     0 -19870.113    0  539 -24173.136 -19870.113  17.8%     -  122s
     0     0 -19935.941    0  620 -24173.136 -19935.941  17.5%     -  126s
H    0     0                    -24162.07423 -19935.990  17.5%     -  126s
H    0     0                    -24156.08236 -19975.911  17.3%     -  129s
     0     0 -19975.911    0  606 -24156.082 -19975.911  17.3%     -  129s
H    0     0                    -24153.70417 -20009.200  17.2%     -  131s
H    0     0                    -24132.99198 -20009.200  17.1%     -  131s
H    0     0                    -24132.87790 -20009.200  17.1%     -  131s
     0     0 -20009.200    0  630 -24132.878 -20009.200  17.1%     -  131s
     0     0 -20030.758    0  627 -24132.878 -20030.758  17.0%     -  133s
     0     0 -20034.239    0  631 -24132.878 -20034.239  17.0%     -  133s
     0     0 -20039.131    0  719 -24132.878 -20039.131  17.0%     -  134s
     0     0 -20040.576    0  638 -24132.878 -20040.576  17.0%     -  135s
     0     0 -20073.993    0  619 -24132.878 -20073.993  16.8%     -  138s
     0     0 -20076.024    0  540 -24132.878 -20076.024  16.8%     -  139s
     0     0 -20077.335    0  541 -24132.878 -20077.335  16.8%     -  139s
     0     0 -20077.465    0  547 -24132.878 -20077.465  16.8%     -  139s
     0     0 -20159.861    0  641 -24132.878 -20159.861  16.5%     -  143s
H    0     0                    -24126.10706 -20160.744  16.4%     -  144s
H    0     0                    -24123.25496 -20160.744  16.4%     -  144s
H    0     0                    -24112.44127 -20160.744  16.4%     -  144s
H    0     0                    -24111.50720 -20160.744  16.4%     -  144s
H    0     0                    -24097.88758 -20160.744  16.3%     -  144s
     0     0 -20181.981    0  723 -24097.888 -20181.981  16.2%     -  147s
     0     0 -20186.189    0  706 -24097.888 -20186.189  16.2%     -  148s
     0     0 -20186.353    0  707 -24097.888 -20186.353  16.2%     -  148s
     0     0 -20215.335    0  771 -24097.888 -20215.335  16.1%     -  151s
     0     0 -20228.007    0  780 -24097.888 -20228.007  16.1%     -  152s
     0     0 -20234.939    0  783 -24097.888 -20234.939  16.0%     -  154s
     0     0 -20237.816    0  790 -24097.888 -20237.816  16.0%     -  154s
     0     0 -20238.248    0  792 -24097.888 -20238.248  16.0%     -  155s
     0     0 -20257.320    0  881 -24097.888 -20257.320  15.9%     -  158s
H    0     0                    -24094.41671 -20258.132  15.9%     -  159s
     0     0 -20261.571    0  570 -24094.417 -20261.571  15.9%     -  160s
     0     0 -20262.425    0  581 -24094.417 -20262.425  15.9%     -  160s
     0     0 -20262.754    0  580 -24094.417 -20262.754  15.9%     -  160s
     0     0 -20262.754    0  580 -24094.417 -20262.754  15.9%     -  160s
     0     0 -20277.115    0  842 -24094.417 -20277.115  15.8%     -  163s
     0     0 -20283.630    0  761 -24094.417 -20283.630  15.8%     -  164s
     0     0 -20285.062    0  680 -24094.417 -20285.062  15.8%     -  164s
     0     0 -20285.062    0  680 -24094.417 -20285.062  15.8%     -  165s
     0     0 -20285.638    0  683 -24094.417 -20285.638  15.8%     -  165s
     0     0 -20295.061    0  674 -24094.417 -20295.061  15.8%     -  167s
     0     0 -20299.787    0  682 -24094.417 -20299.787  15.7%     -  171s
     0     0 -20301.771    0  682 -24094.417 -20301.771  15.7%     -  172s
     0     0 -20302.797    0  767 -24094.417 -20302.797  15.7%     -  173s
     0     0 -20302.803    0  768 -24094.417 -20302.803  15.7%     -  173s
     0     0 -20311.175    0  593 -24094.417 -20311.175  15.7%     -  176s
     0     0 -20313.875    0  771 -24094.417 -20313.875  15.7%     -  177s
     0     0 -20314.980    0  771 -24094.417 -20314.980  15.7%     -  178s
     0     0 -20315.005    0  772 -24094.417 -20315.005  15.7%     -  178s
     0     0 -20317.097    0  738 -24094.417 -20317.097  15.7%     -  180s
     0     0 -20318.845    0  746 -24094.417 -20318.845  15.7%     -  181s
     0     0 -20318.933    0  744 -24094.417 -20318.933  15.7%     -  182s
     0     0 -20322.205    0  753 -24094.417 -20322.205  15.7%     -  184s
     0     0 -20323.787    0  701 -24094.417 -20323.787  15.6%     -  184s
     0     0 -20324.101    0  700 -24094.417 -20324.101  15.6%     -  185s
     0     0 -20332.721    0  735 -24094.417 -20332.721  15.6%     -  188s
     0     0 -20342.842    0  737 -24094.417 -20342.842  15.6%     -  190s
     0     0 -20344.756    0  824 -24094.417 -20344.756  15.6%     -  191s
     0     0 -20347.000    0  835 -24094.417 -20347.000  15.6%     -  192s
     0     0 -20347.080    0  831 -24094.417 -20347.080  15.6%     -  192s
     0     0 -20351.132    0  826 -24094.417 -20351.132  15.5%     -  194s
     0     0 -20351.633    0  829 -24094.417 -20351.633  15.5%     -  195s
     0     0 -20353.074    0  829 -24094.417 -20353.074  15.5%     -  196s
     0     0 -20353.677    0  834 -24094.417 -20353.677  15.5%     -  204s
     0     0 -20355.775    0  832 -24094.417 -20355.775  15.5%     -  206s
     0     0 -20356.245    0  832 -24094.417 -20356.245  15.5%     -  207s
     0     0 -20358.313    0  825 -24094.417 -20358.313  15.5%     -  209s
     0     0 -20359.537    0  825 -24094.417 -20359.537  15.5%     -  211s
     0     2 -20359.537    0  825 -24094.417 -20359.537  15.5%     -  227s
     1     3 -20645.732    1  592 -24094.417 -20359.537  15.5%  3214  231s
     2     6 -21611.393    2   92 -24094.417 -20359.537  15.5%  4441  235s
     5    11 -22048.745    3   92 -24094.417 -20632.261  14.4%  4900  244s
    10    22 -22349.859    4  100 -24094.417 -20632.261  14.4%  5177  249s
    21    31     cutoff    5      -24094.417 -21033.054  12.7%  7022  261s
    37    55 -21155.672    6  505 -24094.417 -21045.761  12.7%  9226  301s
    67    88     cutoff    7      -24094.417 -21156.542  12.2% 10000  311s
   164   109 -22656.714    9   69 -24094.417 -21310.404  11.6%  6750  318s
   224   109 infeasible   10      -24094.417 -21310.404  11.6%  5803  326s
   296   117 -23371.698    5  523 -24094.417 -21310.404  11.6%  5319  333s
   361   131 infeasible   14      -24094.417 -21310.404  11.6%  5071  340s
   427   137 infeasible    6      -24094.417 -21310.404  11.6%  4806  346s
   493   143 -23353.654    6  187 -24094.417 -21310.404  11.6%  4554  354s
   563   153 infeasible    6      -24094.417 -21310.404  11.6%  4378  361s
   609   176 -23158.696   15  131 -24094.417 -21310.404  11.6%  4424  368s
   677   180 -23418.013   17  127 -24094.417 -21310.404  11.6%  4275  375s
   740   171 infeasible   18      -24094.417 -21416.503  11.1%  4145  382s
   807   161 infeasible   18      -24094.417 -21659.752  10.1%  4063  389s
   861   153 infeasible   17      -24094.417 -21659.819  10.1%  4078  397s
   925   150 infeasible   13      -24094.417 -21659.819  10.1%  4067  404s
   976   140 infeasible   14      -24094.417 -21659.819  10.1%  4101  411s
  1034   128 infeasible   10      -24094.417 -21659.819  10.1%  4103  418s
  1092    82 -23581.798   12  533 -24094.417 -21659.819  10.1%  4091  425s
  1161    41 infeasible   12      -24094.417 -22646.128  6.01%  4010  431s
  1224    16 -23768.419   10   58 -24094.417 -22646.128  6.01%  3933  437s
  1325     0 -24091.512   21   20 -24094.417 -24091.512  0.01%  3702  440s

Cutting planes:
  Implied bound: 20
  MIR: 575
  Flow cover: 1874
  Zero half: 11
  RLT: 19
  Relax-and-lift: 114

Explored 1328 nodes (5186551 simplex iterations) in 440.53 seconds (1241.46 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24094.4 -24097.9 -24111.5 ... -24156.1
No other solutions better than -24094.4

Optimal solution found (tolerance 1.00e-06)
Best objective -2.409441670860e+04, best bound -2.409441670860e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 440.55s
  Master Objective (UB) = -24094.42, θ = 87204.26
  Upper Bound (UB) = -24094.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87204.26
  [DEBUG]   ✓ Scenario 0: θ = 87204.26 ≤ Q = 87204.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87204.26 ≤ Q = 87204.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87204.26 ≤ Q = 87204.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87204.26 ≤ Q = 87204.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87204.26 ≤ Q = 87204.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87204.26 ≤ Q = 87204.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87204.26 ≤ Q = 87204.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87204.26 ≤ Q = 87204.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87204.26 ≤ Q = 87204.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87204.26 ≤ Q = 87204.26 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x272bea2d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x272bea2d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6671781.3086
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.088998e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108899.81    0  122 6671781.31 -108899.81   102%     -    0s
H    0     0                    -79030.72573 -108899.81  37.8%     -    0s
H    0     0                    -79456.73627 -108899.81  37.1%     -    0s
     0     0 -83985.586    0   53 -79456.736 -83985.586  5.70%     -    0s
H    0     0                    -82037.60383 -83906.367  2.28%     -    0s
     0     0 -83734.889    0   55 -82037.604 -83734.889  2.07%     -    0s
H    0     0                    -82566.35389 -83731.787  1.41%     -    0s
H    0     0                    -82576.17716 -83731.787  1.40%     -    0s
     0     0 -83701.601    0   58 -82576.177 -83701.601  1.36%     -    0s
     0     0 -83655.994    0   58 -82576.177 -83655.994  1.31%     -    0s
     0     2 -83655.994    0   58 -82576.177 -83655.994  1.31%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 141

Explored 184 nodes (959 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -82576.2 -79456.7 -79030.7 ... 1.42347e+13
No other solutions better than -82576.2

Optimal solution found (tolerance 1.00e-06)
Best objective -8.257617716281e+04, best bound -8.257617716281e+04, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 85649.54
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82576.18
  [DEBUG]   S×d_nominal = 168225.72
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168225.72 + -82576.18 = 85649.54
  [DEBUG]   Current θ from Master = 87204.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1554.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25649.14
  Lower Bound (LB) = -25649.14
  Gap (UB-LB) = 1554.7192, Absolute Gap = 1554.7192, Relative Gap = 0.064526
  Not converged yet (gap = 1554.72 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480796 nonzeros
Model fingerprint: 0x9c9f0af5
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86658 rows and 35178 columns
Presolve time: 1.04s
Presolved: 82915 rows, 35722 columns, 509275 nonzeros
Variable types: 33463 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402567.5784
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.14s

Barrier statistics:
 Dense cols : 524
 AA' NZ     : 3.289e+06
 Factor NZ  : 7.290e+06 (roughly 100 MB of memory)
 Factor Ops : 1.256e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.21833211e+07  1.58852125e+08  2.52e+05 2.80e+01  1.02e+05     3s
   1  -2.69373358e+07  1.55358164e+08  2.02e+05 8.71e+01  8.11e+04     3s
   2  -1.08886327e+07  1.11500514e+08  7.79e+04 1.11e+00  3.27e+04     3s
   3  -3.05708937e+06  1.14728364e+08  1.86e+04 3.39e+01  8.41e+03     3s
   4  -7.84447048e+05  5.14492478e+07  1.68e+03 2.85e+00  9.94e+02     3s
   5  -5.94640530e+05  3.82434848e+07  5.61e+02 1.98e+00  4.61e+02     3s
   6  -4.96598964e+05  1.77177741e+07  2.03e+02 7.11e-01  1.84e+02     3s
   7  -3.23949641e+05  1.18425364e+07  5.86e+01 4.15e-01  9.61e+01     3s
   8  -2.51110886e+05  7.50996453e+06  3.59e+01 1.61e-01  5.88e+01     3s
   9  -2.12365114e+05  5.52769499e+06  2.67e+01 6.16e-02  4.24e+01     3s
  10  -1.58031264e+05  2.28414003e+06  1.59e+01 2.52e-03  1.76e+01     3s
  11  -1.03299510e+05  7.21302041e+05  6.37e+00 5.65e-03  5.69e+00     3s
  12  -6.52620533e+04  3.60262743e+05  2.96e+00 3.15e-04  2.87e+00     3s
  13  -4.35834485e+04  2.21849590e+05  1.56e+00 2.17e-04  1.77e+00     3s
  14  -3.53385485e+04  1.17625600e+05  1.01e+00 1.83e-04  1.02e+00     3s
  15  -2.97880252e+04  5.04473460e+04  6.95e-01 1.01e-04  5.33e-01     3s
  16  -2.50199047e+04  2.36631089e+04  5.04e-01 1.07e-03  3.24e-01     3s
  17  -2.24231790e+04  1.37079565e+04  4.08e-01 7.96e-04  2.40e-01     3s
  18  -1.95423975e+04  7.54650775e+03  3.02e-01 6.21e-04  1.80e-01     3s
  19  -1.80049147e+04  4.83315579e+03  2.52e-01 7.62e-04  1.52e-01     3s
  20  -1.56174230e+04  2.70912079e+03  1.77e-01 6.62e-04  1.22e-01     3s
  21  -1.45038759e+04  1.34414421e+02  1.46e-01 8.19e-04  9.71e-02     3s
  22  -1.40434413e+04 -7.73173139e+02  1.32e-01 7.01e-04  8.80e-02     3s
  23  -1.21984137e+04 -2.26716531e+03  8.01e-02 7.44e-04  6.57e-02     3s
  24  -1.16409341e+04 -3.34598308e+03  6.77e-02 6.97e-04  5.49e-02     3s
  25  -1.12499067e+04 -3.66947201e+03  5.92e-02 6.40e-04  5.01e-02     3s
  26  -1.08572974e+04 -4.22328026e+03  5.11e-02 8.16e-04  4.39e-02     3s
  27  -1.06748141e+04 -4.78100455e+03  4.76e-02 9.25e-04  3.90e-02     3s
  28  -1.01674791e+04 -5.04954809e+03  3.79e-02 8.43e-04  3.38e-02     3s
  29  -9.98619958e+03 -5.43945824e+03  3.46e-02 7.86e-04  3.01e-02     3s
  30  -9.35857903e+03 -6.05483580e+03  2.36e-02 5.58e-04  2.18e-02     3s
  31  -8.70777489e+03 -6.55035241e+03  1.30e-02 5.65e-04  1.42e-02     3s
  32  -8.37808785e+03 -6.82305991e+03  8.11e-03 4.70e-04  1.03e-02     3s
  33  -8.07027757e+03 -7.35916473e+03  3.84e-03 2.60e-04  4.69e-03     3s
  34  -7.96595939e+03 -7.48263966e+03  2.53e-03 1.78e-04  3.19e-03     3s
  35  -7.88880048e+03 -7.54755000e+03  1.59e-03 1.35e-04  2.25e-03     3s
  36  -7.87750214e+03 -7.57598604e+03  1.46e-03 1.18e-04  1.99e-03     3s
  37  -7.83809475e+03 -7.62262242e+03  9.92e-04 8.40e-05  1.42e-03     3s
  38  -7.82881541e+03 -7.64795523e+03  8.66e-04 6.85e-05  1.19e-03     3s
  39  -7.80893575e+03 -7.68133251e+03  6.01e-04 4.69e-05  8.41e-04     4s
  40  -7.80131855e+03 -7.69342893e+03  5.08e-04 3.92e-05  7.11e-04     4s
  41  -7.79564458e+03 -7.70655612e+03  4.36e-04 3.04e-05  5.87e-04     4s
  42  -7.78757316e+03 -7.73598477e+03  3.52e-04 1.04e-05  3.41e-04     4s
  43  -7.78008038e+03 -7.74212185e+03  2.61e-04 8.58e-06  2.51e-04     4s
  44  -7.77627106e+03 -7.74659841e+03  2.12e-04 6.05e-06  1.96e-04     4s
  45  -7.77215497e+03 -7.75002079e+03  1.58e-04 5.07e-06  1.46e-04     4s
  46  -7.76961516e+03 -7.75098548e+03  1.35e-04 4.01e-06  1.23e-04     4s
  47  -7.76465650e+03 -7.75243178e+03  8.35e-05 3.82e-06  8.07e-05     4s
  48  -7.76193684e+03 -7.75390062e+03  5.20e-05 3.15e-06  5.31e-05     4s
  49  -7.76017686e+03 -7.75550024e+03  3.22e-05 1.15e-06  3.09e-05     4s
  50  -7.75817659e+03 -7.75616410e+03  1.25e-05 8.55e-07  1.33e-05     4s
  51  -7.75746950e+03 -7.75649092e+03  5.74e-06 4.04e-07  6.46e-06     4s
  52  -7.75710143e+03 -7.75672697e+03  2.34e-06 8.94e-08  2.47e-06     4s
  53  -7.75693196e+03 -7.75673404e+03  1.85e-06 1.92e-07  1.30e-06     4s
  54  -7.75688984e+03 -7.75678196e+03  1.71e-06 6.87e-08  7.13e-07     4s
  55  -7.75681945e+03 -7.75680525e+03  6.89e-07 1.08e-07  9.37e-08     4s
  56  -7.75680765e+03 -7.75680701e+03  3.18e-08 4.13e-09  4.27e-09     4s
  57  -7.75680722e+03 -7.75680715e+03  3.61e-08 2.57e-10  4.40e-10     4s

Barrier solved model in 57 iterations and 4.07 seconds (7.98 work units)
Optimal objective -7.75680722e+03


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    8405 PPushes remaining with PInf 8.4036974e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.6939218e+03      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   43601   -7.7568072e+03   0.000000e+00   4.693922e+03      6s
   43798   -7.7568072e+03   0.000000e+00   0.000000e+00      6s
   43798   -7.7568072e+03   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.30s

Solved with barrier

Root relaxation: objective -7.756807e+03, 43798 iterations, 4.58 seconds (12.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -7756.8072    0  451 -205910.05 -7756.8072  96.2%     -    6s
H    0     0                    -204134.4918 -7756.8072  96.2%     -    7s
H    0     0                    -49832.66184 -7756.8072  84.4%     -    7s
H    0     0                    -49823.92554 -7756.8072  84.4%     -    7s
H    0     0                    -49823.47123 -7756.8072  84.4%     -    7s
H    0     0                    -47165.67789 -7756.8072  83.6%     -    7s
H    0     0                    -29296.27313 -7756.8072  73.5%     -    7s
H    0     0                    -29158.05882 -7756.8072  73.4%     -    7s
H    0     0                    -29074.11566 -7756.8072  73.3%     -    7s
H    0     0                    -29063.47698 -7756.8072  73.3%     -    7s
H    0     0                    -24745.53272 -7756.8072  68.7%     -    9s
H    0     0                    -24629.71554 -7756.8072  68.5%     -    9s
H    0     0                    -24621.79771 -7756.8072  68.5%     -    9s
H    0     0                    -24615.14460 -7756.8072  68.5%     -    9s
H    0     0                    -24614.14552 -7756.8072  68.5%     -    9s
H    0     0                    -24599.13162 -7756.8072  68.5%     -    9s
H    0     0                    -24589.00676 -7756.8072  68.5%     -    9s
H    0     0                    -24503.07452 -11977.112  51.1%     -   27s
H    0     0                    -24343.19394 -11977.112  50.8%     -   27s
     0     0 -11977.112    0  545 -24343.194 -11977.112  50.8%     -   27s
H    0     0                    -24269.42143 -11978.824  50.6%     -   27s
     0     0 -12389.268    0  463 -24269.421 -12389.268  49.0%     -   34s
     0     0 -12389.268    0  465 -24269.421 -12389.268  49.0%     -   35s
     0     0 -12389.880    0  465 -24269.421 -12389.880  48.9%     -   36s
     0     0 -12423.805    0  465 -24269.421 -12423.805  48.8%     -   37s
     0     0 -12423.855    0  467 -24269.421 -12423.855  48.8%     -   38s
     0     0 -15941.437    0  604 -24269.421 -15941.437  34.3%     -   58s
H    0     0                    -24267.94418 -15951.220  34.3%     -   58s
H    0     0                    -24260.73064 -15951.220  34.3%     -   58s
H    0     0                    -24256.65122 -15951.220  34.2%     -   58s
H    0     0                    -24251.59565 -15951.220  34.2%     -   58s
     0     0 -16198.361    0  630 -24251.596 -16198.361  33.2%     -   64s
     0     0 -16243.614    0  621 -24251.596 -16243.614  33.0%     -   67s
     0     0 -16359.743    0  628 -24251.596 -16359.743  32.5%     -   70s
     0     0 -16362.400    0  631 -24251.596 -16362.400  32.5%     -   70s
     0     0 -16362.400    0  631 -24251.596 -16362.400  32.5%     -   70s
H    0     0                    -24251.34677 -18097.680  25.4%     -   92s
H    0     0                    -24249.82831 -18097.680  25.4%     -   92s
H    0     0                    -24243.90379 -18097.680  25.4%     -   92s
H    0     0                    -24242.17219 -18097.680  25.3%     -   92s
     0     0 -18097.680    0  797 -24242.172 -18097.680  25.3%     -   92s
     0     0 -18388.327    0  790 -24242.172 -18388.327  24.1%     -  100s
     0     0 -18455.917    0  801 -24242.172 -18455.917  23.9%     -  104s
     0     0 -18629.349    0  741 -24242.172 -18629.349  23.2%     -  107s
     0     0 -18703.352    0  801 -24242.172 -18703.352  22.8%     -  110s
     0     0 -18710.354    0  807 -24242.172 -18710.354  22.8%     -  111s
     0     0 -18712.706    0  806 -24242.172 -18712.706  22.8%     -  112s
     0     0 -18714.728    0  807 -24242.172 -18714.728  22.8%     -  112s
     0     0 -18774.096    0  859 -24242.172 -18774.096  22.6%     -  115s
     0     0 -18789.245    0  816 -24242.172 -18789.245  22.5%     -  116s
     0     0 -18939.417    0  756 -24242.172 -18939.417  21.9%     -  119s
     0     0 -18943.217    0  762 -24242.172 -18943.217  21.9%     -  120s
     0     0 -18944.242    0  821 -24242.172 -18944.242  21.9%     -  121s
H    0     0                    -24239.46636 -19582.079  19.2%     -  135s
H    0     0                    -24237.38786 -19582.079  19.2%     -  135s
H    0     0                    -24232.64712 -19582.079  19.2%     -  135s
H    0     0                    -24225.94896 -19582.079  19.2%     -  135s
H    0     0                    -24219.87691 -19582.079  19.1%     -  135s
     0     0 -19582.079    0  751 -24219.877 -19582.079  19.1%     -  135s
     0     0 -19713.675    0  778 -24219.877 -19713.675  18.6%     -  141s
     0     0 -19740.981    0  763 -24219.877 -19740.981  18.5%     -  145s
     0     0 -19755.682    0  771 -24219.877 -19755.682  18.4%     -  147s
     0     0 -19767.667    0  706 -24219.877 -19767.667  18.4%     -  150s
     0     0 -19784.117    0  708 -24219.877 -19784.117  18.3%     -  153s
     0     0 -19791.109    0  712 -24219.877 -19791.109  18.3%     -  155s
     0     0 -19802.637    0  717 -24219.877 -19802.637  18.2%     -  158s
     0     0 -19805.094    0  719 -24219.877 -19805.094  18.2%     -  159s
     0     0 -19849.882    0  714 -24219.877 -19849.882  18.0%     -  164s
     0     0 -19860.557    0  716 -24219.877 -19860.557  18.0%     -  166s
     0     0 -19866.602    0  716 -24219.877 -19866.602  18.0%     -  168s
     0     0 -19867.476    0  720 -24219.877 -19867.476  18.0%     -  169s
     0     0 -20027.241    0  710 -24219.877 -20027.241  17.3%     -  177s
     0     0 -20059.572    0  785 -24219.877 -20059.572  17.2%     -  184s
     0     0 -20069.836    0  796 -24219.877 -20069.836  17.1%     -  190s
     0     0 -20075.245    0  792 -24219.877 -20075.245  17.1%     -  192s
     0     0 -20083.741    0  806 -24219.877 -20083.741  17.1%     -  194s
     0     0 -20086.751    0  817 -24219.877 -20086.751  17.1%     -  195s
     0     0 -20087.050    0  816 -24219.877 -20087.050  17.1%     -  197s
     0     0 -20147.369    0  645 -24219.877 -20147.369  16.8%     -  205s
     0     0 -20160.879    0  650 -24219.877 -20160.879  16.8%     -  209s
     0     0 -20165.464    0  654 -24219.877 -20165.464  16.7%     -  211s
     0     0 -20170.162    0  653 -24219.877 -20170.162  16.7%     -  212s
     0     0 -20170.900    0  663 -24219.877 -20170.900  16.7%     -  213s
     0     0 -20225.349    0  715 -24219.877 -20225.349  16.5%     -  222s
     0     0 -20250.442    0  792 -24219.877 -20250.442  16.4%     -  226s
     0     0 -20253.495    0  878 -24219.877 -20253.495  16.4%     -  227s
     0     0 -20253.557    0  877 -24219.877 -20253.557  16.4%     -  227s
     0     0 -20272.326    0  807 -24219.877 -20272.326  16.3%     -  232s
     0     0 -20275.439    0  808 -24219.877 -20275.439  16.3%     -  234s
     0     0 -20276.157    0  813 -24219.877 -20276.157  16.3%     -  235s
     0     0 -20293.397    0  668 -24219.877 -20293.397  16.2%     -  238s
     0     0 -20296.697    0  680 -24219.877 -20296.697  16.2%     -  239s
     0     0 -20299.179    0  751 -24219.877 -20299.179  16.2%     -  241s
     0     0 -20303.053    0  756 -24219.877 -20303.053  16.2%     -  242s
     0     0 -20303.409    0  768 -24219.877 -20303.409  16.2%     -  243s
H    0     0                    -24170.11945 -20309.345  16.0%     -  246s
H    0     0                    -24134.32014 -20309.345  15.8%     -  246s
     0     0 -20309.345    0  763 -24134.320 -20309.345  15.8%     -  246s
H    0     0                    -24111.90102 -20315.028  15.7%     -  248s
H    0     0                    -24110.80005 -20315.028  15.7%     -  248s
     0     0 -20315.028    0  759 -24110.800 -20315.028  15.7%     -  248s
     0     0 -20316.116    0  763 -24110.800 -20316.116  15.7%     -  249s
     0     0 -20326.730    0  688 -24110.800 -20326.730  15.7%     -  253s
     0     0 -20327.140    0  688 -24110.800 -20327.140  15.7%     -  256s
     0     2 -20327.140    0  688 -24110.800 -20327.140  15.7%     -  279s
     1     3 -22194.897    1  418 -24110.800 -20327.140  15.7%  9062  287s
     5     7 infeasible    3      -24110.800 -20456.580  15.2%  3456  295s
    10    14 -20694.089    3  543 -24110.800 -20456.823  15.2%  3934  301s
    17    15 -20741.526    4  541 -24110.800 -20694.337  14.2%  6257  309s
    30    26 -20764.975    5  540 -24110.800 -20730.766  14.0%  5456  320s
    45    42 -21074.855    6  749 -24110.800 -20765.197  13.9%  5826  335s
    71    69 -21093.628    7  741 -24110.800 -20914.728  13.3%  5139  345s
   108   111 -21940.085    8  658 -24110.800 -20914.728  13.3%  5461  356s
   176   131 -21398.992    8  683 -24110.800 -20914.728  13.3%  4227  365s
H  184   131                    -24103.19221 -20914.728  13.2%  4179  365s
   246   151 -21463.080    9  674 -24103.192 -20914.728  13.2%  3723  374s
   316   154 -21670.646   10  653 -24103.192 -20914.728  13.2%  3710  384s
   366   152     cutoff   11      -24103.192 -20914.728  13.2%  3671  394s
   421   161 -22340.746   11  611 -24103.192 -20916.008  13.2%  3609  403s
   479   171 infeasible   11      -24103.192 -21015.910  12.8%  3809  414s
   525   176 -22652.306   13  613 -24103.192 -21015.910  12.8%  3777  423s
   589   185 -22832.569   15  376 -24103.192 -21015.910  12.8%  3760  433s
   658   192 -22952.954   16  463 -24103.192 -21015.910  12.8%  3853  442s
   718   226 -23080.632   17  539 -24103.192 -21015.910  12.8%  3857  448s
   793   253 -23292.367   19  517 -24103.192 -21015.910  12.8%  3918  457s
   868   278 -23181.728   20  534 -24103.192 -21015.910  12.8%  3917  465s
   955   266 -23355.321   22  519 -24103.192 -21015.910  12.8%  3805  476s
  1017   272 -23398.471   23  524 -24103.192 -21803.108  9.54%  3778  482s
  1069   287 -23462.543   24  440 -24103.192 -21803.108  9.54%  3807  490s
  1146   305 -23473.626   25  346 -24103.192 -21803.108  9.54%  3736  500s
  1230   301 -23667.623   28  276 -24103.192 -21803.108  9.54%  3673  509s
  1321   283 -23683.296   29  430 -24103.192 -21803.108  9.54%  3652  520s
  1414   307 -23995.764   30  238 -24103.192 -21803.108  9.54%  3636  529s
  1501   319 -23781.083    9  125 -24103.192 -21803.108  9.54%  3641  539s
  1549   333     cutoff   10      -24103.192 -22059.552  8.48%  3631  547s
  1612   354 -23526.332   20  553 -24103.192 -22059.552  8.48%  3622  556s
  1703   366 -23656.997   21  527 -24103.192 -22059.552  8.48%  3613  566s
  1829   389 -23919.439   23  530 -24103.192 -22927.967  4.88%  3571  576s
  1989   394 infeasible   25      -24103.192 -22930.921  4.86%  3492  586s
  2156   376 infeasible   23      -24103.192 -23002.248  4.57%  3433  595s
  2239   390 infeasible   22      -24103.192 -23038.219  4.42%  3472  605s
  2391   387 -23767.621   22  350 -24103.192 -23038.219  4.42%  3431  616s
  2539   369 -24028.679   25  412 -24103.192 -23336.371  3.18%  3415  626s
  2718   345 infeasible   22      -24103.192 -23427.295  2.80%  3382  636s
  2889   329 -24070.960   23  571 -24103.192 -23504.489  2.48%  3353  646s
  3038   268 infeasible   21      -24103.192 -23562.250  2.24%  3345  658s
  3228   181 -24053.419   27  455 -24103.192 -23594.554  2.11%  3324  669s
  3408    99 infeasible   23      -24103.192 -23624.662  1.99%  3297  679s
  3660    36 -24014.124   13   70 -24103.192 -23744.706  1.49%  3194  689s
  3891    14 -24060.843   25  453 -24103.192 -23800.760  1.25%  3086  693s
  4049     0     cutoff   26      -24103.192 -23965.408  0.57%  2987  695s

Cutting planes:
  Learned: 5
  Gomory: 2
  Implied bound: 64
  MIR: 1787
  Flow cover: 2387
  Zero half: 13
  RLT: 117
  Relax-and-lift: 322

Explored 4073 nodes (12530868 simplex iterations) in 695.63 seconds (1977.51 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24103.2 -24110.8 -24111.9 ... -24239.5
No other solutions better than -24103.2

Optimal solution found (tolerance 1.00e-06)
Best objective -2.410319221444e+04, best bound -2.410319221444e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 695.68s
  Master Objective (UB) = -24103.19, θ = 87077.01
  Upper Bound (UB) = -24103.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87077.01
  [DEBUG]   ✓ Scenario 0: θ = 87077.01 ≤ Q = 87077.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87077.01 ≤ Q = 87077.01 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87077.01 ≤ Q = 87077.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x46821c6f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x46821c6f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6686946.2887
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.084361e+05, 211 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108436.06    0  122 6686946.29 -108436.06   102%     -    0s
H    0     0                    -78614.55744 -108436.06  37.9%     -    0s
H    0     0                    -79040.56797 -108436.06  37.2%     -    0s
     0     0 -84049.356    0   55 -79040.568 -84049.356  6.34%     -    0s
H    0     0                    -81879.40770 -84015.281  2.61%     -    0s
     0     0 -83791.834    0   56 -81879.408 -83791.834  2.34%     -    0s
H    0     0                    -82555.19537 -83548.833  1.20%     -    0s
H    0     0                    -82563.40055 -83548.833  1.19%     -    0s
     0     0 -83548.833    0   56 -82563.401 -83548.833  1.19%     -    0s
     0     0 -83474.121    0   56 -82563.401 -83474.121  1.10%     -    0s
     0     0 -83469.294    0   56 -82563.401 -83469.294  1.10%     -    0s
     0     0 -83381.145    0   58 -82563.401 -83381.145  0.99%     -    0s
     0     0 -83335.827    0   58 -82563.401 -83335.827  0.94%     -    0s
     0     2 -83332.174    0   58 -82563.401 -83332.174  0.93%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 139
  BQP: 1

Explored 60 nodes (667 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -82563.4 -79040.6 -78614.6 ... 1.42347e+13
No other solutions better than -82563.4

Optimal solution found (tolerance 1.00e-06)
Best objective -8.256340054532e+04, best bound -8.256340054532e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 85081.80
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82563.40
  [DEBUG]   S×d_nominal = 167645.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 167645.20 + -82563.40 = 85081.80
  [DEBUG]   Current θ from Master = 87077.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1995.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26098.41
  Lower Bound (LB) = -25649.14
  Gap (UB-LB) = 1545.9437, Absolute Gap = 1545.9437, Relative Gap = 0.064139
  Not converged yet (gap = 1545.94 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524003 nonzeros
Model fingerprint: 0x504c1186
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94536 rows and 38376 columns
Presolve time: 1.55s
Presolved: 90327 rows, 38764 columns, 552887 nonzeros
Variable types: 36505 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -403385.4355
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 524
 AA' NZ     : 3.740e+06
 Factor NZ  : 8.260e+06 (roughly 120 MB of memory)
 Factor Ops : 1.476e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.28905882e+07  1.72777819e+08  2.57e+05 2.78e+01  1.03e+05     3s
   1  -2.78757847e+07  1.68505216e+08  2.10e+05 8.08e+01  8.30e+04     3s
   2  -1.16285114e+07  1.19816266e+08  8.31e+04 6.53e-01  3.44e+04     3s
   3  -1.20865832e+06  8.09583139e+07  5.86e+03 1.11e+00  2.90e+03     3s
   4  -5.41301627e+05  3.44359353e+07  8.42e+02 2.03e-01  5.19e+02     3s
   5  -4.24171529e+05  1.74264750e+07  3.52e+02 7.41e-02  2.23e+02     3s
   6  -2.50129525e+05  1.19723627e+07  8.81e+01 4.82e-02  9.98e+01     3s
   7  -1.54174149e+05  8.23404777e+06  3.11e+01 3.07e-02  5.82e+01     3s
   8  -1.22141517e+05  4.19295709e+06  1.96e+01 1.50e-02  2.91e+01     3s
   9  -1.00805746e+05  2.24285404e+06  1.22e+01 7.48e-03  1.53e+01     3s
  10  -5.82255053e+04  7.47616829e+05  2.33e+00 2.17e-03  4.96e+00     3s
  11  -4.50972131e+04  3.42266592e+05  1.71e+00 7.57e-04  2.38e+00     3s
  12  -3.47631053e+04  1.09044417e+05  7.91e-01 4.09e-04  8.75e-01     3s
  13  -2.93362813e+04  6.45278348e+04  5.62e-01 5.81e-04  5.70e-01     3s
  14  -2.57034897e+04  3.98113363e+04  4.37e-01 4.10e-04  3.97e-01     3s
  15  -2.30099679e+04  2.92848328e+04  3.55e-01 5.05e-04  3.17e-01     3s
  16  -1.94998619e+04  1.90255720e+04  2.57e-01 8.52e-04  2.33e-01     3s
  17  -1.67340086e+04  1.30692818e+04  1.91e-01 7.67e-04  1.80e-01     3s
  18  -1.50705315e+04  5.22632682e+03  1.55e-01 1.28e-03  1.23e-01     3s
  19  -1.34745198e+04  2.62927881e+03  1.28e-01 1.08e-03  9.74e-02     3s
  20  -1.19040663e+04  8.65872090e+02  9.79e-02 1.01e-03  7.72e-02     3s
  21  -1.09669663e+04 -1.22773523e+03  8.10e-02 1.14e-03  5.89e-02     3s
  22  -1.07775523e+04 -1.65367133e+03  7.76e-02 1.11e-03  5.52e-02     3s
  23  -9.99295106e+03 -2.62602318e+03  6.38e-02 9.99e-04  4.46e-02     3s
  24  -9.41998332e+03 -3.15673385e+03  5.35e-02 8.32e-04  3.79e-02     3s
  25  -8.58308439e+03 -3.43985579e+03  3.92e-02 7.19e-04  3.11e-02     3s
  26  -8.29202010e+03 -3.79994604e+03  3.43e-02 9.45e-04  2.72e-02     3s
  27  -7.89783298e+03 -4.01062902e+03  2.77e-02 6.88e-04  2.35e-02     3s
  28  -7.80678237e+03 -4.50816821e+03  2.58e-02 7.12e-04  1.99e-02     3s
  29  -7.39661011e+03 -4.85394798e+03  1.94e-02 6.14e-04  1.54e-02     3s
  30  -7.21693464e+03 -5.18002944e+03  1.67e-02 5.38e-04  1.23e-02     3s
  31  -6.92366484e+03 -5.22977929e+03  1.23e-02 5.32e-04  1.02e-02     3s
  32  -6.75271458e+03 -5.32348469e+03  9.79e-03 4.70e-04  8.63e-03     3s
  33  -6.68912051e+03 -5.45822552e+03  8.82e-03 3.88e-04  7.44e-03     3s
  34  -6.61019964e+03 -5.55244678e+03  7.63e-03 3.26e-04  6.39e-03     4s
  35  -6.52054385e+03 -5.67021467e+03  6.27e-03 2.57e-04  5.14e-03     4s
  36  -6.40407656e+03 -5.68520305e+03  4.63e-03 2.24e-04  4.34e-03     4s
  37  -6.32156298e+03 -5.80389979e+03  3.42e-03 1.47e-04  3.13e-03     4s
  38  -6.28423396e+03 -5.88784302e+03  2.90e-03 1.02e-04  2.40e-03     4s
  39  -6.20022437e+03 -5.94476809e+03  1.71e-03 6.98e-05  1.54e-03     4s
  40  -6.18228982e+03 -5.96336922e+03  1.46e-03 6.33e-05  1.32e-03     4s
  41  -6.16804965e+03 -5.97557411e+03  1.27e-03 5.54e-05  1.16e-03     4s
  42  -6.14861324e+03 -6.00053679e+03  1.00e-03 4.11e-05  8.95e-04     4s
  43  -6.12232614e+03 -6.01709026e+03  6.53e-04 3.40e-05  6.36e-04     4s
  44  -6.11664176e+03 -6.02505850e+03  5.78e-04 2.87e-05  5.53e-04     4s
  45  -6.09930832e+03 -6.04263805e+03  3.49e-04 2.06e-05  3.42e-04     4s
  46  -6.08932634e+03 -6.05337405e+03  2.21e-04 1.50e-05  2.17e-04     4s
  47  -6.08349920e+03 -6.05710570e+03  1.48e-04 1.17e-05  1.59e-04     4s
  48  -6.08081656e+03 -6.06478034e+03  1.16e-04 5.16e-06  9.69e-05     4s
  49  -6.07746988e+03 -6.06545979e+03  7.56e-05 4.58e-06  7.25e-05     4s
  50  -6.07514808e+03 -6.06697584e+03  4.79e-05 3.28e-06  4.94e-05     4s
  51  -6.07266243e+03 -6.06921359e+03  1.88e-05 1.34e-06  2.08e-05     4s
  52  -6.07129933e+03 -6.07014673e+03  3.49e-06 6.37e-07  6.95e-06     4s
  53  -6.07110226e+03 -6.07086068e+03  1.65e-06 4.20e-08  1.46e-06     4s
  54  -6.07102385e+03 -6.07088943e+03  9.08e-07 2.22e-08  8.12e-07     4s
  55  -6.07093267e+03 -6.07092096e+03  8.47e-08 1.09e-09  7.08e-08     4s
  56  -6.07092563e+03 -6.07092225e+03  5.46e-08 1.76e-09  2.05e-08     4s
  57  -6.07092252e+03 -6.07092226e+03  4.64e-08 2.98e-08  1.53e-09     4s
  58  -6.07092226e+03 -6.07092226e+03  3.69e-09 1.20e-10  8.27e-12     4s

Barrier solved model in 58 iterations and 4.33 seconds (8.92 work units)
Optimal objective -6.07092226e+03


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    3706 PPushes remaining with PInf 5.0938837e-07                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.6442826e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32705   -6.0709223e+03   0.000000e+00   0.000000e+00      8s
   32705   -6.0709223e+03   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 1.09s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -6.070922e+03, 32705 iterations, 6.63 seconds (16.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6070.9223    0  646 -205910.05 -6070.9223  97.1%     -    9s
H    0     0                    -201563.4561 -6070.9223  97.0%     -    9s
H    0     0                    -104301.1278 -6070.9223  94.2%     -    9s
H    0     0                    -78242.43490 -6070.9223  92.2%     -    9s
H    0     0                    -29590.18433 -6070.9223  79.5%     -    9s
H    0     0                    -29210.49761 -6070.9223  79.2%     -    9s
H    0     0                    -29046.04653 -6070.9223  79.1%     -    9s
H    0     0                    -29044.83174 -6070.9223  79.1%     -    9s
H    0     0                    -28916.07890 -11433.673  60.5%     -   75s
H    0     0                    -28880.74426 -11433.673  60.4%     -   75s
H    0     0                    -28876.40032 -11433.673  60.4%     -   75s
     0     0 -11433.673    0  757 -28876.400 -11433.673  60.4%     -   75s
H    0     0                    -28778.53455 -11433.728  60.3%     -   76s
H    0     0                    -28751.71329 -11789.324  59.0%     -   95s
H    0     0                    -28724.40171 -11789.324  59.0%     -   95s
H    0     0                    -28661.37329 -11789.324  58.9%     -   95s
     0     0 -11953.252    0  766 -28661.373 -11953.252  58.3%     -   95s
     0     0 -12067.686    0  776 -28661.373 -12067.686  57.9%     -  109s
     0     0 -12149.720    0  765 -28661.373 -12149.720  57.6%     -  122s
     0     0 -12194.866    0  759 -28661.373 -12194.866  57.5%     -  130s
     0     0 -12196.352    0  763 -28661.373 -12196.352  57.4%     -  132s
     0     0 -12196.804    0  762 -28661.373 -12196.804  57.4%     -  133s
H    0     0                    -24501.10131 -14794.575  39.6%     -  205s
H    0     0                    -24195.93438 -14794.575  38.9%     -  205s
H    0     0                    -24161.89359 -14794.575  38.8%     -  205s
H    0     0                    -24145.65859 -14794.575  38.7%     -  205s
H    0     0                    -24142.56362 -14794.575  38.7%     -  205s
     0     0 -14843.706    0  823 -24142.564 -14843.706  38.5%     -  205s
H    0     0                    -24138.61241 -14843.706  38.5%     -  206s
H    0     0                    -24118.46500 -15168.717  37.1%     -  249s
H    0     0                    -24114.51379 -15168.717  37.1%     -  249s
     0     0 -15168.717    0  822 -24114.514 -15168.717  37.1%     -  249s
     0     0 -15209.792    0  754 -24114.514 -15209.792  36.9%     -  263s
     0     0 -15252.525    0  774 -24114.514 -15252.525  36.7%     -  275s
     0     0 -15278.163    0  809 -24114.514 -15278.163  36.6%     -  290s
     0     0 -15308.091    0  761 -24114.514 -15308.091  36.5%     -  304s
     0     0 -15332.062    0  822 -24114.514 -15332.062  36.4%     -  316s
     0     0 -15334.332    0  824 -24114.514 -15334.332  36.4%     -  320s
     0     0 -15340.998    0  823 -24114.514 -15340.998  36.4%     -  326s
     0     0 -15341.957    0  825 -24114.514 -15341.957  36.4%     -  329s
     0     0 -17188.213    0  696 -24114.514 -17188.213  28.7%     -  396s
     0     0 -17717.564    0  827 -24114.514 -17717.564  26.5%     -  420s
     0     0 -17825.528    0  764 -24114.514 -17825.528  26.1%     -  432s
     0     0 -17865.170    0  766 -24114.514 -17865.170  25.9%     -  441s
     0     0 -17965.287    0  773 -24114.514 -17965.287  25.5%     -  451s
     0     0 -17980.917    0  698 -24114.514 -17980.917  25.4%     -  453s
     0     0 -18064.903    0  714 -24114.514 -18064.903  25.1%     -  458s
     0     0 -18068.253    0  729 -24114.514 -18068.253  25.1%     -  459s
     0     0 -18086.980    0  716 -24114.514 -18086.980  25.0%     -  463s
     0     0 -18149.132    0  793 -24114.514 -18149.132  24.7%     -  469s
     0     0 -18173.943    0  719 -24114.514 -18173.943  24.6%     -  472s
     0     0 -18174.874    0  717 -24114.514 -18174.874  24.6%     -  472s
     0     0 -19189.949    0  772 -24114.514 -19189.949  20.4%     -  496s
     0     0 -19455.388    0  852 -24114.514 -19455.388  19.3%     -  506s
     0     0 -19581.190    0  771 -24114.514 -19581.190  18.8%     -  513s
     0     0 -19657.096    0  763 -24114.514 -19657.096  18.5%     -  517s
     0     0 -19681.990    0  697 -24114.514 -19681.990  18.4%     -  521s
     0     0 -19688.095    0  709 -24114.514 -19688.095  18.4%     -  522s
     0     0 -19689.545    0  710 -24114.514 -19689.545  18.3%     -  523s
     0     0 -19889.697    0  838 -24114.514 -19889.697  17.5%     -  534s
     0     0 -19916.122    0  971 -24114.514 -19916.122  17.4%     -  538s
     0     0 -19925.444    0  951 -24114.514 -19925.444  17.4%     -  540s
     0     0 -19942.572    0  814 -24114.514 -19942.572  17.3%     -  542s
     0     0 -19948.640    0  884 -24114.514 -19948.640  17.3%     -  544s
     0     0 -19955.496    0  884 -24114.514 -19955.496  17.2%     -  546s
     0     0 -19956.102    0  891 -24114.514 -19956.102  17.2%     -  546s
     0     0 -20012.199    0  789 -24114.514 -20012.199  17.0%     -  554s
     0     0 -20020.490    0  795 -24114.514 -20020.490  17.0%     -  557s
     0     0 -20031.290    0  794 -24114.514 -20031.290  16.9%     -  559s
     0     0 -20034.566    0  792 -24114.514 -20034.566  16.9%     -  561s
     0     0 -20036.545    0  811 -24114.514 -20036.545  16.9%     -  562s
     0     0 -20064.813    0  814 -24114.514 -20064.813  16.8%     -  568s
     0     0 -20066.610    0  815 -24114.514 -20066.610  16.8%     -  569s
     0     0 -20080.179    0  893 -24114.514 -20080.179  16.7%     -  574s
     0     0 -20084.926    0  735 -24114.514 -20084.926  16.7%     -  576s
     0     0 -20087.431    0  898 -24114.514 -20087.431  16.7%     -  578s
     0     0 -20087.974    0  820 -24114.514 -20087.974  16.7%     -  579s
     0     0 -20114.533    0  820 -24114.514 -20114.533  16.6%     -  584s
     0     0 -20119.221    0  737 -24114.514 -20119.221  16.6%     -  587s
     0     0 -20120.133    0  742 -24114.514 -20120.133  16.6%     -  588s
     0     0 -20129.990    0  719 -24114.514 -20129.990  16.5%     -  591s
     0     0 -20131.998    0  721 -24114.514 -20131.998  16.5%     -  593s
     0     0 -20148.775    0  811 -24114.514 -20148.775  16.4%     -  598s
     0     0 -20150.076    0  816 -24114.514 -20150.076  16.4%     -  599s
     0     0 -20153.047    0  820 -24114.514 -20153.047  16.4%     -  602s
     0     0 -20153.791    0  820 -24114.514 -20153.791  16.4%     -  608s
     0     2 -20153.791    0  820 -24114.514 -20153.791  16.4%     -  666s
     1     3 -20329.881    1  485 -24114.514 -20153.791  16.4%  3164  675s
     2     6 -21153.355    2  145 -24114.514 -20153.791  16.4%  5938  682s
     5    12 -21224.849    3  131 -24114.514 -20612.732  14.5%  4438  689s
    11    24 -21257.083    4  123 -24114.514 -20725.130  14.1%  4505  698s
    23    34 -23246.670    4  437 -24114.514 -20766.841  13.9%  7522  723s
    35    63 -21943.980    6  164 -24114.514 -20766.841  13.9%  8284  815s
    64    93 -22182.694    7  121 -24114.514 -20766.841  13.9% 12319  826s
    96   177 -22199.054    8  115 -24114.514 -20766.841  13.9%  9722  841s
   200   183 -23639.096    9   64 -24114.514 -20766.841  13.9%  6867  855s
   288   192 -23670.114   10   55 -24114.514 -20766.841  13.9%  6028  866s
   362   221     cutoff   12      -24114.514 -20766.841  13.9%  5590  876s
   464   226 infeasible   13      -24114.514 -20766.841  13.9%  5133  888s
   526   226     cutoff   11      -24114.514 -20766.841  13.9%  4970  898s
   607   220 -23673.037   17  432 -24114.514 -20766.841  13.9%  4725  905s
   688   239 -23893.878   18  429 -24114.514 -20766.841  13.9%  4568  912s
   760   267 -23948.393   19  361 -24114.514 -20766.841  13.9%  4434  920s
   819   293 -24040.457   20  488 -24114.514 -20766.841  13.9%  4375  929s
   899   307 infeasible   21      -24114.514 -20766.841  13.9%  4245  938s
   982   298 infeasible    9      -24114.514 -20766.841  13.9%  4193  946s
  1075   295 infeasible   10      -24114.514 -20766.841  13.9%  4136  956s
  1126   296 infeasible   11      -24114.514 -20766.841  13.9%  4162  965s
  1180   299 -23401.868   12  141 -24114.514 -20766.841  13.9%  4166  976s
  1250   296 infeasible   13      -24114.514 -20766.841  13.9%  4099  985s
  1337   275 -23599.904   14  506 -24114.514 -20766.841  13.9%  4059  996s
  1434   261 infeasible   16      -24114.514 -20766.841  13.9%  4017 1008s
  1520   258 -23083.075    8   74 -24114.514 -20766.841  13.9%  4048 1020s
  1585   237 -22223.004    9  603 -24114.514 -20766.841  13.9%  4089 1033s
  1679   210 -22259.947   10  335 -24114.514 -20766.841  13.9%  4107 1045s
  1778   165 -23834.677   10  218 -24114.514 -20766.841  13.9%  4070 1058s
  1888   130 infeasible   11      -24114.514 -20766.841  13.9%  4019 1072s
  2018   101 infeasible   16      -24114.514 -20766.841  13.9%  3965 1087s
  2119    46 infeasible   17      -24114.514 -20766.841  13.9%  3923 1098s
  2241    53 -23508.994   19  563 -24114.514 -20766.841  13.9%  3777 1109s
  2318    55 -23529.840   20  496 -24114.514 -20766.841  13.9%  3723 1117s
  2432    19 -23775.272   21  502 -24114.514 -20766.841  13.9%  3622 1122s
  2548    21 -23899.500   22  546 -24114.514 -20766.841  13.9%  3499 1131s
  2607    16 infeasible   26      -24114.514 -20986.182  13.0%  3453 1143s
  2666     4 -24035.383   25  426 -24114.514 -20986.553  13.0%  3397 1155s
  2690     8 -22482.631    7  488 -24114.514 -20986.553  13.0%  3387 1166s
  2694    11 -22864.456    8  451 -24114.514 -20986.553  13.0%  3395 1175s
  2703    10 -23150.327    9  622 -24114.514 -22325.087  7.42%  3421 1185s
  2720    10 -23560.426   10  612 -24114.514 -22512.767  6.64%  3421 1195s
  2730     9 -23685.437   11  587 -24114.514 -22517.886  6.62%  3431 1207s
  2741    10 infeasible   12      -24114.514 -23249.520  3.59%  3437 1215s
  2758     4 -23898.041   14  679 -24114.514 -23364.638  3.11%  3446 1226s
  2770     4 infeasible   15      -24114.514 -23620.829  2.05%  3444 1233s
  2776     2 infeasible   12      -24114.514 -23768.676  1.43%  3440 1240s
  2780     1 -24034.914   14  359 -24114.514 -23975.646  0.58%  3444 1246s

Cutting planes:
  Learned: 1
  Gomory: 5
  Implied bound: 172
  MIR: 1970
  Flow cover: 2899
  Inf proof: 1
  Zero half: 5
  RLT: 111
  Relax-and-lift: 783

Explored 2786 nodes (10122488 simplex iterations) in 1246.76 seconds (3150.78 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24114.5 -24118.5 -24138.6 ... -28724.4
No other solutions better than -24114.5

Optimal solution found (tolerance 1.00e-06)
Best objective -2.411451378548e+04, best bound -2.411451378548e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1246.78s
  Master Objective (UB) = -24114.51, θ = 86983.65
  Upper Bound (UB) = -24114.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 86983.65
  [DEBUG]   ✓ Scenario 0: θ = 86983.65 ≤ Q = 86983.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 86983.65 ≤ Q = 86983.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 86983.65 ≤ Q = 86983.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 86983.65 ≤ Q = 86983.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 86983.65 ≤ Q = 86983.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 86983.65 ≤ Q = 86983.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 86983.65 ≤ Q = 86983.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 86983.65 ≤ Q = 86983.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 86983.65 ≤ Q = 86983.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 86983.65 ≤ Q = 86983.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 86983.65 ≤ Q = 86983.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 86983.65 ≤ Q = 86983.65 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x51dbdb52
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x51dbdb52
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6681405.5455
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.086378e+05, 211 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108637.82    0  122 6681405.55 -108637.82   102%     -    0s
H    0     0                    -78789.76505 -108637.82  37.9%     -    0s
H    0     0                    -79215.77559 -108637.82  37.1%     -    0s
     0     0 -84127.180    0   54 -79215.776 -84127.180  6.20%     -    0s
H    0     0                    -82104.12263 -84101.649  2.43%     -    0s
     0     0 -83877.150    0   55 -82104.123 -83877.150  2.16%     -    0s
H    0     0                    -82774.85857 -83845.938  1.29%     -    0s
H    0     0                    -82782.99701 -83845.938  1.28%     -    0s
     0     0 -83626.985    0   56 -82782.997 -83626.985  1.02%     -    0s
     0     0 -83605.701    0   56 -82782.997 -83605.701  0.99%     -    0s
     0     0 -83604.344    0   56 -82782.997 -83604.344  0.99%     -    0s
     0     0 -83095.962    0   34 -82782.997 -83095.962  0.38%     -    0s
     0     0 -83018.334    0   27 -82782.997 -83018.334  0.28%     -    0s
     0     0 -82861.297    0   23 -82782.997 -82861.297  0.09%     -    0s
     0     0 -82825.353    0    6 -82782.997 -82825.353  0.05%     -    0s
     0     0     cutoff    0      -82782.997 -82782.997  0.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 139
  Flow cover: 1
  RLT: 35
  Relax-and-lift: 8
  BQP: 11

Explored 1 nodes (523 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -82783 -79215.8 -78789.8 ... 1.42347e+13
No other solutions better than -82783

Optimal solution found (tolerance 1.00e-06)
Best objective -8.278299700967e+04, best bound -8.278299700967e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 84958.45
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82783.00
  [DEBUG]   S×d_nominal = 167741.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 167741.45 + -82783.00 = 84958.45
  [DEBUG]   Current θ from Master = 86983.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2025.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26139.71
  Lower Bound (LB) = -25649.14
  Gap (UB-LB) = 1534.6221, Absolute Gap = 1534.6221, Relative Gap = 0.063639
  Not converged yet (gap = 1534.62 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567210 nonzeros
Model fingerprint: 0x85d42aad
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 102414 rows and 41574 columns
Presolve time: 1.32s
Presolved: 97739 rows, 41806 columns, 596018 nonzeros
Variable types: 39547 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -403385.4355
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 524
 AA' NZ     : 4.228e+06
 Factor NZ  : 9.401e+06 (roughly 130 MB of memory)
 Factor Ops : 1.761e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.33677036e+07  1.85878528e+08  2.61e+05 2.78e+01  1.03e+05     3s
   1  -2.85728031e+07  1.80804670e+08  2.15e+05 7.50e+01  8.42e+04     3s
   2  -1.12546809e+07  1.20032395e+08  7.96e+04 1.22e+00  3.27e+04     3s
   3  -7.84510466e+06  1.20429888e+08  5.45e+04 1.20e+00  2.26e+04     3s
   4  -1.35402665e+06  7.95115528e+07  5.43e+03 8.19e-01  2.62e+03     3s
   5  -6.68722800e+05  5.44443275e+07  7.31e+02 4.27e-01  5.81e+02     3s
   6  -5.79286930e+05  2.75539526e+07  3.60e+02 1.87e-01  2.77e+02     3s
   7  -4.20847345e+05  1.90899402e+07  9.72e+01 1.22e-01  1.38e+02     3s
   8  -3.29443735e+05  1.36493158e+07  4.66e+01 8.34e-02  9.02e+01     3s
   9  -2.69024856e+05  1.03642719e+07  2.81e+01 6.14e-02  6.55e+01     3s
  10  -1.81004408e+05  5.55760985e+06  1.35e+01 3.05e-02  3.40e+01     3s
  11  -1.18092612e+05  1.66765511e+06  5.57e+00 7.86e-03  1.03e+01     3s
  12  -7.65565911e+04  9.67129932e+05  3.07e+00 4.46e-03  5.94e+00     3s
  13  -5.51552136e+04  5.13299916e+05  1.97e+00 2.35e-03  3.22e+00     3s
  14  -4.34002640e+04  2.80301495e+05  1.24e+00 1.21e-03  1.82e+00     3s
  15  -3.30905206e+04  1.22534199e+05  7.02e-01 1.06e-03  8.73e-01     3s
  16  -2.52847223e+04  6.54667340e+04  3.76e-01 1.47e-03  5.08e-01     3s
  17  -2.23316416e+04  4.30349277e+04  2.96e-01 1.34e-03  3.66e-01     3s
  18  -1.85741003e+04  2.53558475e+04  2.11e-01 1.38e-03  2.46e-01     3s
  19  -1.66384859e+04  1.82425860e+04  1.74e-01 1.08e-03  1.95e-01     3s
  20  -1.41983825e+04  8.97822362e+03  1.30e-01 1.45e-03  1.30e-01     3s
  21  -1.21443810e+04  3.19173765e+03  9.73e-02 1.47e-03  8.58e-02     3s
  22  -1.13495482e+04  1.18507588e+03  8.49e-02 1.83e-03  7.01e-02     3s
  23  -1.06038390e+04 -2.05011145e+02  7.43e-02 1.83e-03  5.82e-02     3s
  24  -9.95190461e+03 -1.07699225e+03  6.44e-02 1.78e-03  4.96e-02     3s
  25  -9.55989952e+03 -1.76337896e+03  5.85e-02 1.51e-03  4.36e-02     3s
  26  -9.31417211e+03 -2.56867178e+03  5.49e-02 1.33e-03  3.77e-02     3s
  27  -8.81577615e+03 -2.93951369e+03  4.79e-02 1.50e-03  3.29e-02     3s
  28  -8.48978308e+03 -3.28693554e+03  4.34e-02 1.65e-03  2.91e-02     3s
  29  -7.56115080e+03 -3.45293184e+03  3.05e-02 1.48e-03  2.30e-02     3s
  30  -7.24327225e+03 -3.62562501e+03  2.61e-02 1.24e-03  2.02e-02     3s
  31  -6.90430121e+03 -3.84021685e+03  2.16e-02 1.11e-03  1.71e-02     3s
  32  -6.52727139e+03 -4.26294764e+03  1.65e-02 8.92e-04  1.27e-02     3s
  33  -6.44516680e+03 -4.43016126e+03  1.54e-02 7.38e-04  1.13e-02     4s
  34  -6.11700701e+03 -4.61635017e+03  1.12e-02 6.17e-04  8.39e-03     4s
  35  -5.88327549e+03 -4.76979076e+03  8.02e-03 6.01e-04  6.23e-03     4s
  36  -5.75922531e+03 -4.80668138e+03  6.47e-03 5.51e-04  5.33e-03     4s
  37  -5.75104494e+03 -4.89784038e+03  6.37e-03 4.39e-04  4.77e-03     4s
  38  -5.64532149e+03 -5.01034600e+03  4.97e-03 2.84e-04  3.55e-03     4s
  39  -5.52574973e+03 -5.09229339e+03  3.37e-03 1.84e-04  2.42e-03     4s
  40  -5.47301759e+03 -5.15107748e+03  2.68e-03 1.32e-04  1.80e-03     4s
  41  -5.42130232e+03 -5.17787631e+03  2.01e-03 1.01e-04  1.36e-03     4s
  42  -5.38185365e+03 -5.20762920e+03  1.50e-03 5.39e-05  9.75e-04     4s
  43  -5.33939598e+03 -5.22402151e+03  9.63e-04 3.53e-05  6.45e-04     4s
  44  -5.31340516e+03 -5.22983634e+03  6.40e-04 3.03e-05  4.67e-04     4s
  45  -5.29775501e+03 -5.24224541e+03  4.44e-04 1.74e-05  3.10e-04     4s
  46  -5.28319923e+03 -5.24413608e+03  2.72e-04 1.55e-05  2.18e-04     4s
  47  -5.28001203e+03 -5.24729730e+03  2.33e-04 1.25e-05  1.83e-04     4s
  48  -5.27654381e+03 -5.25195349e+03  1.90e-04 7.60e-06  1.38e-04     4s
  49  -5.27453480e+03 -5.25512817e+03  1.68e-04 4.68e-06  1.09e-04     4s
  50  -5.26974940e+03 -5.25651761e+03  1.12e-04 3.33e-06  7.40e-05     4s
  51  -5.26746310e+03 -5.25833453e+03  8.39e-05 3.02e-06  5.11e-05     4s
  52  -5.26371211e+03 -5.25902908e+03  3.91e-05 1.84e-06  2.62e-05     4s
  53  -5.26100336e+03 -5.25993009e+03  7.91e-06 1.26e-06  6.00e-06     4s
  54  -5.26038007e+03 -5.26018629e+03  1.23e-06 1.79e-07  1.08e-06     4s
  55  -5.26024955e+03 -5.26023409e+03  5.72e-08 4.87e-08  8.63e-08     4s
  56  -5.26024523e+03 -5.26024468e+03  3.59e-08 1.10e-09  3.09e-09     4s
  57  -5.26024474e+03 -5.26024474e+03  3.36e-08 2.29e-08  1.03e-11     4s

Barrier solved model in 57 iterations and 4.45 seconds (9.41 work units)
Optimal objective -5.26024474e+03


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    3719 PPushes remaining with PInf 8.2282305e-07                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3898127e-01      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36624   -5.2602447e+03   0.000000e+00   1.389813e-01      7s
   36627   -5.2602447e+03   0.000000e+00   0.000000e+00      7s
   36627   -5.2602447e+03   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -5.260245e+03, 36627 iterations, 5.22 seconds (14.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -5260.2447    0  654 -205910.05 -5260.2447  97.4%     -    7s
H    0     0                    -203790.9858 -5260.2447  97.4%     -    7s
H    0     0                    -100404.0154 -5260.2447  94.8%     -    7s
H    0     0                    -100267.8038 -5260.2447  94.8%     -    7s
H    0     0                    -63879.36910 -5260.2447  91.8%     -    7s
H    0     0                    -43091.32226 -5260.2447  87.8%     -    8s
H    0     0                    -42868.86400 -5260.2447  87.7%     -    8s
H    0     0                    -30162.49087 -5260.2447  82.6%     -   10s
H    0     0                    -29189.49635 -5260.2447  82.0%     -   10s
H    0     0                    -28953.08566 -11208.293  61.3%     -   73s
H    0     0                    -28939.69238 -11208.293  61.3%     -   73s
     0     0 -11208.293    0  795 -28939.692 -11208.293  61.3%     -   73s
H    0     0                    -28884.83460 -11211.640  61.2%     -   74s
H    0     0                    -28884.35127 -11211.640  61.2%     -   74s
H    0     0                    -28881.25629 -11211.640  61.2%     -   74s
     0     0 -11714.252    0  783 -28881.256 -11714.252  59.4%     -  105s
     0     0 -11939.041    0  779 -28881.256 -11939.041  58.7%     -  127s
     0     0 -12012.979    0  791 -28881.256 -12012.979  58.4%     -  143s
     0     0 -12053.972    0  794 -28881.256 -12053.972  58.3%     -  154s
     0     0 -12054.060    0  797 -28881.256 -12054.060  58.3%     -  160s
     0     0 -12084.513    0  798 -28881.256 -12084.513  58.2%     -  163s
H    0     0                    -28621.27827 -12084.513  57.8%     -  168s
     0     0 -12084.513    0  804 -28621.278 -12084.513  57.8%     -  168s
     0     0 -12084.513    0  806 -28621.278 -12084.513  57.8%     -  173s
H    0     0                    -28620.17729 -12091.786  57.8%     -  186s
     0     0 -12091.786    0  793 -28620.177 -12091.786  57.8%     -  186s
     0     0 -12094.473    0  797 -28620.177 -12094.473  57.7%     -  190s
     0     0 -12095.440    0  797 -28620.177 -12095.440  57.7%     -  192s
     0     0 -12095.457    0  797 -28620.177 -12095.457  57.7%     -  192s
H    0     0                    -25879.85947 -14536.359  43.8%     -  269s
H    0     0                    -25827.89036 -14536.359  43.7%     -  269s
H    0     0                    -25812.62244 -14536.359  43.7%     -  269s
H    0     0                    -25780.74952 -14536.359  43.6%     -  269s
H    0     0                    -25769.91577 -14536.359  43.6%     -  269s
H    0     0                    -25768.19284 -14536.359  43.6%     -  269s
H    0     0                    -25767.72808 -14536.359  43.6%     -  269s
     0     0 -14802.735    0  710 -25767.728 -14802.735  42.6%     -  269s
H    0     0                    -25194.27985 -14802.735  41.2%     -  270s
H    0     0                    -24899.88823 -14802.735  40.6%     -  270s
H    0     0                    -24723.53533 -14802.735  40.1%     -  270s
H    0     0                    -24665.03297 -16278.099  34.0%     -  333s
H    0     0                    -24263.63783 -16278.099  32.9%     -  333s
H    0     0                    -24168.61147 -16278.099  32.6%     -  333s
     0     0 -16278.099    0  838 -24168.611 -16278.099  32.6%     -  333s
H    0     0                    -24136.44677 -16601.976  31.2%     -  358s
H    0     0                    -24117.87478 -16601.976  31.2%     -  358s
H    0     0                    -24115.99731 -16601.976  31.2%     -  358s
H    0     0                    -24114.89633 -16601.976  31.2%     -  358s
     0     0 -16601.976    0  814 -24114.896 -16601.976  31.2%     -  358s
     0     0 -16717.157    0  821 -24114.896 -16717.157  30.7%     -  369s
     0     0 -16881.622    0  817 -24114.896 -16881.622  30.0%     -  375s
     0     0 -16955.671    0  817 -24114.896 -16955.671  29.7%     -  383s
     0     0 -16978.438    0  812 -24114.896 -16978.438  29.6%     -  387s
     0     0 -17011.676    0  810 -24114.896 -17011.676  29.5%     -  390s
     0     0 -17013.503    0  812 -24114.896 -17013.503  29.4%     -  390s
     0     0 -17015.205    0  808 -24114.896 -17015.205  29.4%     -  391s
     0     0 -17015.296    0  811 -24114.896 -17015.296  29.4%     -  391s
     0     0 -18456.633    0  762 -24114.896 -18456.633  23.5%     -  451s
     0     0 -18725.057    0  759 -24114.896 -18725.057  22.4%     -  470s
     0     0 -18795.514    0  764 -24114.896 -18795.514  22.1%     -  475s
     0     0 -18848.233    0  683 -24114.896 -18848.233  21.8%     -  481s
     0     0 -18858.231    0  694 -24114.896 -18858.231  21.8%     -  483s
     0     0 -18861.641    0  689 -24114.896 -18861.641  21.8%     -  484s
     0     0 -18864.502    0  685 -24114.896 -18864.502  21.8%     -  485s
     0     0 -18864.502    0  685 -24114.896 -18864.502  21.8%     -  485s
     0     0 -19428.069    0  675 -24114.896 -19428.069  19.4%     -  502s
     0     0 -19558.244    0  758 -24114.896 -19558.244  18.9%     -  510s
     0     0 -19663.729    0  842 -24114.896 -19663.729  18.5%     -  520s
     0     0 -19686.908    0  832 -24114.896 -19686.908  18.4%     -  524s
     0     0 -19702.562    0  848 -24114.896 -19702.562  18.3%     -  527s
     0     0 -19704.198    0  845 -24114.896 -19704.198  18.3%     -  528s
     0     0 -19797.669    0  618 -24114.896 -19797.669  17.9%     -  539s
     0     0 -19857.192    0  843 -24114.896 -19857.192  17.7%     -  546s
     0     0 -19895.725    0  777 -24114.896 -19895.725  17.5%     -  552s
     0     0 -19923.325    0  785 -24114.896 -19923.325  17.4%     -  557s
     0     0 -19927.652    0  786 -24114.896 -19927.652  17.4%     -  559s
     0     0 -19928.353    0  801 -24114.896 -19928.353  17.4%     -  559s
     0     0 -20014.449    0  714 -24114.896 -20014.449  17.0%     -  569s
     0     0 -20049.984    0  727 -24114.896 -20049.984  16.9%     -  578s
     0     0 -20066.684    0  725 -24114.896 -20066.684  16.8%     -  580s
     0     0 -20067.167    0  728 -24114.896 -20067.167  16.8%     -  581s
     0     0 -20104.852    0  743 -24114.896 -20104.852  16.6%     -  587s
     0     0 -20119.978    0  755 -24114.896 -20119.978  16.6%     -  591s
     0     0 -20129.752    0  745 -24114.896 -20129.752  16.5%     -  595s
     0     0 -20154.770    0  833 -24114.896 -20154.770  16.4%     -  601s
     0     0 -20159.659    0  832 -24114.896 -20159.659  16.4%     -  604s
     0     0 -20162.054    0  842 -24114.896 -20162.054  16.4%     -  605s
     0     0 -20200.983    0  742 -24114.896 -20200.983  16.2%     -  613s
     0     0 -20211.114    0  724 -24114.896 -20211.114  16.2%     -  617s
     0     0 -20216.161    0  742 -24114.896 -20216.161  16.2%     -  619s
     0     0 -20217.374    0  740 -24114.896 -20217.374  16.2%     -  620s
     0     0 -20292.713    0  807 -24114.896 -20292.713  15.8%     -  628s
     0     0 -20307.007    0  722 -24114.896 -20307.007  15.8%     -  635s
     0     0 -20320.535    0  878 -24114.896 -20320.535  15.7%     -  642s
     0     0 -20322.130    0  890 -24114.896 -20322.130  15.7%     -  645s
     0     0 -20354.200    0  751 -24114.896 -20354.200  15.6%     -  651s
     0     0 -20361.237    0  822 -24114.896 -20361.237  15.6%     -  655s
     0     0 -20362.531    0  764 -24114.896 -20362.531  15.6%     -  656s
     0     0 -20368.249    0  765 -24114.896 -20368.249  15.5%     -  660s
     0     0 -20369.825    0  755 -24114.896 -20369.825  15.5%     -  662s
     0     0 -20373.404    0  766 -24114.896 -20373.404  15.5%     -  665s
     0     0 -20373.633    0  766 -24114.896 -20373.633  15.5%     -  671s
     0     2 -20374.154    0  766 -24114.896 -20374.154  15.5%     -  761s
     1     3 -20478.588    1  412 -24114.896 -20375.767  15.5%  3301  765s
     2     5 -20611.172    2  544 -24114.896 -20375.767  15.5%  3166  781s
     4    10 -20872.050    3  673 -24114.896 -20478.881  15.1%  8450  791s
     9    20 -20938.421    4  598 -24114.896 -20873.329  13.4%  7992  802s
    19    31 -22103.535    4  121 -24114.896 -20938.466  13.2%  9998 1223s
    30    59 -21724.571    5  124 -24114.896 -20938.466  13.2% 13144 1389s
    60    90 -22375.835    6  127 -24114.896 -21135.307  12.4% 18507 1420s
    92   202 -22440.841    7  113 -24114.896 -21397.920  11.3% 15192 1437s
   229   209 -22773.855   12   73 -24114.896 -21398.524  11.3%  8440 1449s
   325   209 infeasible   13      -24114.896 -21398.524  11.3%  7157 1461s
   388   224 -22578.159    8  363 -24114.896 -21398.524  11.3%  6895 1472s
   440   240 -22828.820    9  247 -24114.896 -21398.524  11.3%  7131 1483s
   496   262 -22864.535   10  248 -24114.896 -21398.524  11.3%  6882 1495s
   576   272 -23161.578   12  436 -24114.896 -21519.069  10.8%  6639 1506s
   626   284 -23165.469   13  434 -24114.896 -21519.069  10.8%  6552 1519s
   686   293 -23258.742   16  535 -24114.896 -21519.069  10.8%  6569 1532s
   734   311 -23318.754   17  511 -24114.896 -21519.069  10.8%  6496 1546s
   773   330 -23492.910   18  591 -24114.896 -21519.069  10.8%  6436 1562s
   809   342 -23578.462   19  503 -24114.896 -21519.069  10.8%  6381 1579s
   865   363 -23716.202   24  570 -24114.896 -21519.069  10.8%  6271 1588s
   934   372 infeasible   25      -24114.896 -21549.282  10.6%  6148 1599s
  1006   420 -23225.600   18  576 -24114.896 -21549.282  10.6%  6055 1611s
  1084   474 -23371.398   21  568 -24114.896 -21549.282  10.6%  5955 1622s
  1182   544 -23490.776   28  455 -24114.896 -21549.282  10.6%  5749 1632s
  1310   570 -23724.504   33  565 -24114.896 -21549.282  10.6%  5494 1645s
  1426   541 infeasible   34      -24114.896 -21549.282  10.6%  5372 1659s
  1558   516 -24053.318    8   74 -24114.896 -22077.306  8.45%  5188 1672s
  1665   498 infeasible   14      -24114.896 -22268.141  7.66%  5179 1687s
  1761   486 -23612.874    8  714 -24114.896 -22371.968  7.23%  5151 1703s
  1830   467 infeasible   15      -24114.896 -22405.273  7.09%  5214 1718s
  1932   452 infeasible   14      -24114.896 -22552.592  6.48%  5262 1734s
  1997   444 -23617.152   10  527 -24114.896 -22566.850  6.42%  5271 1754s
  2068   410 -23659.748   11  455 -24114.896 -22566.850  6.42%  5370 1771s
  2162   378 infeasible   12      -24114.896 -22825.337  5.35%  5432 1789s
  2262   335 infeasible   11      -24114.896 -22956.494  4.80%  5487 1807s
  2390   308 -23815.966   16  494 -24114.896 -23026.418  4.51%  5500 1830s
  2479   262 infeasible   17      -24114.896 -23096.306  4.22%  5496 1863s
  2666   141     cutoff   20      -24114.896 -23271.069  3.50%  5355 1881s
  2880    62 infeasible   28      -24114.896 -23437.051  2.81%  5214 1900s
  3081    14 infeasible   19      -24114.896 -23590.780  2.17%  5062 1908s

Cutting planes:
  Learned: 3
  Gomory: 2
  Implied bound: 322
  MIR: 3093
  Flow cover: 3606
  Zero half: 3
  RLT: 166
  Relax-and-lift: 831

Explored 3260 nodes (16364136 simplex iterations) in 1909.00 seconds (3883.19 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24114.9 -24116 -24117.9 ... -25194.3
No other solutions better than -24114.9

Optimal solution found (tolerance 1.00e-06)
Best objective -2.411489633441e+04, best bound -2.411489633441e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1909.03s
  Master Objective (UB) = -24114.90, θ = 87039.98
  Upper Bound (UB) = -24114.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87039.98
  [DEBUG]   ✓ Scenario 0: θ = 87039.98 ≤ Q = 87039.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87039.98 ≤ Q = 87039.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87039.98 ≤ Q = 87039.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87039.98 ≤ Q = 87039.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87039.98 ≤ Q = 87039.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87039.98 ≤ Q = 87039.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87039.98 ≤ Q = 87039.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87039.98 ≤ Q = 87039.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87039.98 ≤ Q = 87039.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87039.98 ≤ Q = 87039.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87039.98 ≤ Q = 87039.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87039.98 ≤ Q = 87039.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87039.98 ≤ Q = 87039.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x78bedea
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x078bedea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6662087.5615
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.091475e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -109147.45    0  122 6662087.56 -109147.45   102%     -    0s
H    0     0                    -79236.81984 -109147.45  37.7%     -    0s
H    0     0                    -79662.83038 -109147.45  37.0%     -    0s
     0     0 -84899.719    0   53 -79662.830 -84899.719  6.57%     -    0s
H    0     0                    -82980.63060 -84898.493  2.31%     -    0s
     0     0 -84733.757    0   56 -82980.631 -84733.757  2.11%     -    0s
H    0     0                    -83611.22196 -84661.923  1.26%     -    0s
H    0     0                    -83616.37700 -84481.582  1.03%     -    0s
     0     0 -84481.582    0   59 -83616.377 -84481.582  1.03%     -    0s
     0     0 -84441.167    0   59 -83616.377 -84441.167  0.99%     -    0s
     0     0 -84050.301    0   28 -83616.377 -84050.301  0.52%     -    0s
     0     0 -83953.551    0   31 -83616.377 -83953.551  0.40%     -    0s
     0     0 -83875.066    0   28 -83616.377 -83875.066  0.31%     -    0s
     0     0 -83806.187    0   26 -83616.377 -83806.187  0.23%     -    0s
     0     0 -83695.977    0   17 -83616.377 -83695.977  0.10%     -    0s
     0     0 -83624.666    0    8 -83616.377 -83624.666  0.01%     -    0s
     0     0     cutoff    0      -83616.377 -83616.377  0.00%     -    0s

Cutting planes:
  Gomory: 17
  MIR: 120
  Flow cover: 4
  RLT: 43
  Relax-and-lift: 1
  BQP: 6

Explored 1 nodes (521 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -83616.4 -79662.8 -79236.8 ... 1.42686e+13
No other solutions better than -83616.4

Optimal solution found (tolerance 1.00e-06)
Best objective -8.361637700497e+04, best bound -8.361637700497e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 84645.22
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83616.38
  [DEBUG]   S×d_nominal = 168261.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168261.60 + -83616.38 = 84645.22
  [DEBUG]   Current θ from Master = 87039.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2394.75 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26509.65
  Lower Bound (LB) = -25649.14
  Gap (UB-LB) = 1534.2396, Absolute Gap = 1534.2396, Relative Gap = 0.063622
  Not converged yet (gap = 1534.24 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610417 nonzeros
Model fingerprint: 0x4ec38fb5
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 110292 rows and 44772 columns
Presolve time: 1.63s
Presolved: 105151 rows, 44848 columns, 638123 nonzeros
Variable types: 42589 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -403358.4564
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 524
 AA' NZ     : 4.697e+06
 Factor NZ  : 1.070e+07 (roughly 150 MB of memory)
 Factor Ops : 2.106e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.36107678e+07  1.98414061e+08  2.63e+05 2.77e+01  1.03e+05     3s
   1  -2.89912141e+07  1.92393751e+08  2.19e+05 6.94e+01  8.46e+04     3s
   2  -9.50751665e+06  1.22583261e+08  7.08e+04 1.58e+00  2.87e+04     3s
   3  -7.06206921e+06  1.22365865e+08  5.19e+04 2.83e+00  2.12e+04     3s
   4  -9.85054761e+05  8.25110444e+07  2.61e+03 8.84e-01  1.46e+03     3s
   5  -6.87840917e+05  3.17587539e+07  6.36e+02 2.23e-01  3.85e+02     3s
   6  -4.01678661e+05  1.92836528e+07  2.54e+02 1.15e-01  1.81e+02     3s
   7  -2.71527412e+05  1.40772035e+07  1.05e+02 7.54e-02  1.04e+02     3s
   8  -1.72595260e+05  8.91992280e+06  3.94e+01 4.33e-02  5.62e+01     3s
   9  -1.36782019e+05  6.95346271e+06  2.60e+01 3.27e-02  4.18e+01     3s
  10  -1.15553700e+05  3.75416927e+06  1.64e+01 1.64e-02  2.22e+01     3s
  11  -9.42387249e+04  2.25185867e+06  1.13e+01 9.47e-03  1.31e+01     3s
  12  -5.21722884e+04  1.50529641e+06  2.88e+00 6.17e-03  8.26e+00     3s
  13  -4.39715365e+04  5.73767986e+05  2.00e+00 2.31e-03  3.26e+00     3s
  14  -3.53333657e+04  2.71142760e+05  9.52e-01 1.12e-03  1.60e+00     3s
  15  -3.03305747e+04  1.11008483e+05  5.72e-01 5.42e-04  7.38e-01     3s
  16  -2.67005333e+04  5.95322879e+04  4.41e-01 1.08e-03  4.50e-01     3s
  17  -2.42545022e+04  3.91117494e+04  3.72e-01 8.34e-04  3.30e-01     3s
  18  -2.16234286e+04  2.40180897e+04  3.05e-01 1.08e-03  2.38e-01     3s
  19  -2.00169405e+04  1.63967165e+04  2.67e-01 1.58e-03  1.90e-01     4s
  20  -1.81778199e+04  1.06423219e+04  2.28e-01 8.63e-04  1.50e-01     4s
  21  -1.56911267e+04  5.15800222e+03  1.78e-01 1.04e-03  1.09e-01     4s
  22  -1.42455673e+04  1.25005264e+03  1.50e-01 2.07e-03  8.07e-02     4s
  23  -1.28968658e+04 -5.06755552e+02  1.23e-01 1.71e-03  6.45e-02     4s
  24  -1.23098051e+04 -2.42004886e+03  1.12e-01 1.95e-03  5.15e-02     4s
  25  -1.10037926e+04 -3.05614805e+03  8.87e-02 1.43e-03  4.14e-02     4s
  26  -1.03126111e+04 -3.74497696e+03  7.52e-02 1.28e-03  3.42e-02     4s
  27  -9.62899609e+03 -4.35662132e+03  6.24e-02 1.22e-03  2.75e-02     4s
  28  -8.62323976e+03 -4.74519208e+03  4.44e-02 1.07e-03  2.02e-02     4s
  29  -8.29608796e+03 -5.11234895e+03  3.82e-02 8.00e-04  1.66e-02     4s
  30  -8.07299224e+03 -5.34574756e+03  3.42e-02 5.74e-04  1.42e-02     4s
  31  -7.59441627e+03 -5.53118021e+03  2.59e-02 5.44e-04  1.07e-02     4s
  32  -7.24279203e+03 -5.68309857e+03  1.98e-02 3.68e-04  8.13e-03     4s
  33  -6.95737438e+03 -5.84857728e+03  1.48e-02 7.78e-04  5.78e-03     4s
  34  -6.71123756e+03 -5.91056738e+03  1.05e-02 6.57e-04  4.17e-03     4s
  35  -6.53322130e+03 -5.96050973e+03  7.42e-03 4.77e-04  2.98e-03     4s
  36  -6.39835316e+03 -5.98697225e+03  5.05e-03 3.40e-04  2.14e-03     4s
  37  -6.34623617e+03 -6.02434822e+03  4.18e-03 2.25e-04  1.68e-03     4s
  38  -6.25467086e+03 -6.04382042e+03  2.66e-03 1.00e-04  1.10e-03     4s
  39  -6.18053066e+03 -6.05574897e+03  1.44e-03 6.95e-05  6.50e-04     4s
  40  -6.13451756e+03 -6.06887739e+03  6.96e-04 4.20e-05  3.42e-04     4s
  41  -6.11863602e+03 -6.07399452e+03  4.47e-04 3.07e-05  2.32e-04     4s
  42  -6.11697727e+03 -6.07624110e+03  4.23e-04 2.56e-05  2.12e-04     4s
  43  -6.11375978e+03 -6.08291537e+03  3.73e-04 1.12e-05  1.61e-04     4s
  44  -6.09921237e+03 -6.08555745e+03  1.49e-04 5.73e-06  7.11e-05     4s
  45  -6.09068995e+03 -6.08745687e+03  2.56e-05 2.32e-06  1.68e-05     5s
  46  -6.08941895e+03 -6.08828403e+03  7.41e-06 8.92e-07  5.90e-06     5s
  47  -6.08895500e+03 -6.08872525e+03  1.77e-06 3.77e-07  1.19e-06     5s
  48  -6.08879340e+03 -6.08878955e+03  2.40e-08 9.82e-09  2.00e-08     5s
  49  -6.08879069e+03 -6.08879063e+03  1.08e-08 1.64e-11  3.15e-10     5s

Barrier solved model in 49 iterations and 4.69 seconds (9.25 work units)
Optimal objective -6.08879069e+03


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 8s

   11464 PPushes remaining with PInf 3.8421062e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.1980215e+01      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47846   -6.0887906e+03   0.000000e+00   6.198022e+01      9s
   47868   -6.0887906e+03   0.000000e+00   0.000000e+00      9s
   47868   -6.0887906e+03   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.38s

Solved with barrier

Root relaxation: objective -6.088791e+03, 47868 iterations, 6.95 seconds (18.57 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6088.7906    0  592 -205910.05 -6088.7906  97.0%     -    9s
H    0     0                    -194310.1257 -6088.7906  96.9%     -   10s
H    0     0                    -192135.8371 -6088.7906  96.8%     -   10s
H    0     0                    -189947.9421 -6088.7906  96.8%     -   10s
H    0     0                    -138669.7393 -6088.7906  95.6%     -   10s
H    0     0                    -138250.7480 -6088.7906  95.6%     -   10s
H    0     0                    -131942.2113 -6088.7906  95.4%     -   10s
H    0     0                    -131918.2002 -6088.7906  95.4%     -   10s
H    0     0                    -94020.21743 -6088.7906  93.5%     -   10s
H    0     0                    -84043.73434 -6088.7906  92.8%     -   10s
H    0     0                    -83808.70718 -6088.7906  92.7%     -   10s
H    0     0                    -71078.04664 -6088.7906  91.4%     -   13s
H    0     0                    -62106.61505 -6088.7906  90.2%     -   13s
H    0     0                    -62023.18043 -6088.7906  90.2%     -   13s
H    0     0                    -62016.94081 -6088.7906  90.2%     -   13s
H    0     0                    -62006.30212 -6088.7906  90.2%     -   13s
H    0     0                    -62004.14281 -6088.7906  90.2%     -   13s
H    0     0                    -61997.36082 -6088.7906  90.2%     -   13s
H    0     0                    -61786.90962 -9851.0537  84.1%     -   61s
H    0     0                    -56235.91622 -9851.0537  82.5%     -   61s
H    0     0                    -56136.57557 -9851.0537  82.5%     -   61s
H    0     0                    -56116.06000 -9851.0537  82.4%     -   61s
     0     0 -9981.3487    0  788 -56116.060 -9981.3487  82.2%     -   61s
H    0     0                    -56104.93101 -9981.3487  82.2%     -   62s
     0     0 -10012.636    0  811 -56104.931 -10012.636  82.2%     -   75s
     0     0 -10050.038    0  799 -56104.931 -10050.038  82.1%     -   81s
     0     0 -10053.532    0  795 -56104.931 -10053.532  82.1%     -   82s
     0     0 -10061.629    0  789 -56104.931 -10061.629  82.1%     -   91s
     0     0 -10063.229    0  797 -56104.931 -10063.229  82.1%     -   95s
     0     0 -10063.277    0  797 -56104.931 -10063.277  82.1%     -   96s
H    0     0                    -55998.16712 -13372.379  76.1%     -  196s
     0     0 -13372.379    0  836 -55998.167 -13372.379  76.1%     -  196s
H    0     0                    -51180.18443 -13372.497  73.9%     -  197s
H    0     0                    -51134.53409 -13372.497  73.8%     -  197s
H    0     0                    -50889.88179 -13372.497  73.7%     -  197s
H    0     0                    -50870.93669 -13372.497  73.7%     -  197s
H    0     0                    -50864.00365 -13372.497  73.7%     -  197s
H    0     0                    -50862.90267 -13372.497  73.7%     -  197s
     0     0 -14857.681    0  921 -50862.903 -14857.681  70.8%     -  293s
H    0     0                    -49933.83454 -15099.816  69.8%     -  319s
H    0     0                    -25434.13070 -15099.816  40.6%     -  319s
H    0     0                    -25432.91707 -15099.816  40.6%     -  319s
H    0     0                    -25413.67476 -15099.816  40.6%     -  319s
H    0     0                    -25295.29580 -15099.816  40.3%     -  319s
H    0     0                    -25278.90559 -15099.816  40.3%     -  319s
H    0     0                    -25256.93858 -15099.816  40.2%     -  319s
     0     0 -15099.816    0  942 -25256.939 -15099.816  40.2%     -  319s
     0     0 -15235.436    0  924 -25256.939 -15235.436  39.7%     -  340s
     0     0 -15250.072    0  912 -25256.939 -15250.072  39.6%     -  347s
     0     0 -15255.452    0  905 -25256.939 -15255.452  39.6%     -  350s
     0     0 -15278.900    0  925 -25256.939 -15278.900  39.5%     -  359s
     0     0 -15289.578    0  917 -25256.939 -15289.578  39.5%     -  367s
     0     0 -15295.907    0  912 -25256.939 -15295.907  39.4%     -  374s
     0     0 -15296.348    0  912 -25256.939 -15296.348  39.4%     -  376s
H    0     0                    -24239.16011 -17462.669  28.0%     -  499s
H    0     0                    -24192.20296 -17462.669  27.8%     -  499s
     0     0 -17462.669    0  787 -24192.203 -17462.669  27.8%     -  499s
H    0     0                    -24139.72214 -17462.718  27.7%     -  500s
     0     0 -18079.463    0  813 -24139.722 -18079.463  25.1%     -  539s
     0     0 -18239.666    0  800 -24139.722 -18239.666  24.4%     -  557s
     0     0 -18324.475    0  802 -24139.722 -18324.475  24.1%     -  566s
     0     0 -18476.482    0  793 -24139.722 -18476.482  23.5%     -  579s
     0     0 -18547.412    0  804 -24139.722 -18547.412  23.2%     -  588s
     0     0 -18552.351    0  817 -24139.722 -18552.351  23.1%     -  592s
     0     0 -18559.202    0  808 -24139.722 -18559.202  23.1%     -  595s
     0     0 -18565.258    0  807 -24139.722 -18565.258  23.1%     -  599s
     0     0 -18590.277    0  803 -24139.722 -18590.277  23.0%     -  603s
     0     0 -18647.660    0  885 -24139.722 -18647.660  22.8%     -  609s
     0     0 -18697.262    0  817 -24139.722 -18697.262  22.5%     -  618s
     0     0 -18708.014    0  894 -24139.722 -18708.014  22.5%     -  622s
     0     0 -18712.660    0  809 -24139.722 -18712.660  22.5%     -  625s
     0     0 -18738.343    0  816 -24139.722 -18738.343  22.4%     -  629s
     0     0 -18738.826    0  810 -24139.722 -18738.826  22.4%     -  630s
     0     0 -19457.413    0  676 -24139.722 -19457.413  19.4%     -  656s
H    0     0                    -24135.77093 -19457.824  19.4%     -  657s
     0     0 -19585.570    0  844 -24135.771 -19585.570  18.9%     -  671s
     0     0 -19718.516    0  844 -24135.771 -19718.516  18.3%     -  680s
H    0     0                    -24133.31652 -19741.291  18.2%     -  685s
     0     0 -19741.291    0  692 -24133.317 -19741.291  18.2%     -  685s
     0     0 -19747.696    0  607 -24133.317 -19747.696  18.2%     -  688s
     0     0 -19763.431    0  522 -24133.317 -19763.431  18.1%     -  692s
     0     0 -19767.213    0  699 -24133.317 -19767.213  18.1%     -  694s
     0     0 -19768.904    0  604 -24133.317 -19768.904  18.1%     -  696s
     0     0 -19889.536    0  601 -24133.317 -19889.536  17.6%     -  713s
     0     0 -19910.665    0  706 -24133.317 -19910.665  17.5%     -  720s
     0     0 -19924.748    0  600 -24133.317 -19924.748  17.4%     -  725s
     0     0 -19938.267    0  926 -24133.317 -19938.267  17.4%     -  730s
     0     0 -19943.327    0  933 -24133.317 -19943.327  17.4%     -  733s
     0     0 -19945.330    0  775 -24133.317 -19945.330  17.4%     -  735s
     0     0 -20113.382    0  799 -24133.317 -20113.382  16.7%     -  749s
     0     0 -20145.146    0  541 -24133.317 -20145.146  16.5%     -  759s
     0     0 -20167.663    0  783 -24133.317 -20167.663  16.4%     -  762s
     0     0 -20184.109    0  790 -24133.317 -20184.109  16.4%     -  765s
     0     0 -20186.038    0  545 -24133.317 -20186.038  16.4%     -  767s
     0     0 -20234.192    0  867 -24133.317 -20234.192  16.2%     -  777s
     0     0 -20245.056    0  883 -24133.317 -20245.056  16.1%     -  781s
     0     0 -20264.120    0  901 -24133.317 -20264.120  16.0%     -  788s
     0     0 -20268.571    0  916 -24133.317 -20268.571  16.0%     -  791s
     0     0 -20270.177    0  990 -24133.317 -20270.177  16.0%     -  793s
     0     0 -20308.873    0  566 -24133.317 -20308.873  15.8%     -  801s
     0     0 -20313.049    0  663 -24133.317 -20313.049  15.8%     -  805s
     0     0 -20316.310    0  574 -24133.317 -20316.310  15.8%     -  807s
     0     0 -20319.128    0  579 -24133.317 -20319.128  15.8%     -  808s
     0     0 -20319.132    0  578 -24133.317 -20319.132  15.8%     -  809s
     0     0 -20341.145    0  818 -24133.317 -20341.145  15.7%     -  815s
     0     0 -20345.214    0  826 -24133.317 -20345.214  15.7%     -  818s
     0     0 -20348.483    0  748 -24133.317 -20348.483  15.7%     -  819s
     0     0 -20348.881    0  746 -24133.317 -20348.881  15.7%     -  820s
     0     0 -20363.616    0  648 -24133.317 -20363.616  15.6%     -  825s
     0     0 -20366.975    0  653 -24133.317 -20366.975  15.6%     -  828s
     0     0 -20367.888    0  649 -24133.317 -20367.888  15.6%     -  830s
     0     0 -20390.352    0  657 -24133.317 -20390.352  15.5%     -  834s
     0     0 -20396.955    0  669 -24133.317 -20396.955  15.5%     -  837s
     0     0 -20399.223    0  665 -24133.317 -20399.223  15.5%     -  838s
     0     0 -20437.049    0  731 -24133.317 -20437.049  15.3%     -  845s
     0     0 -20440.005    0  634 -24133.317 -20440.005  15.3%     -  861s
     0     0 -20440.282    0  720 -24133.317 -20440.282  15.3%     -  863s
     0     0 -20447.683    0  720 -24133.317 -20447.683  15.3%     -  867s
     0     0 -20448.170    0  721 -24133.317 -20448.170  15.3%     -  869s
     0     0 -20451.601    0  713 -24133.317 -20451.601  15.3%     -  872s
     0     0 -20451.751    0  713 -24133.317 -20451.751  15.3%     -  880s
H    0     0                    -24125.86680 -20451.751  15.2%     -  939s
H    0     2                    -24119.94228 -20451.751  15.2%     -  944s
     0     2 -20451.751    0  713 -24119.942 -20451.751  15.2%     -  944s
     1     3 -20877.284    1  510 -24119.942 -20451.774  15.2% 15895  952s
     2     6 -20915.345    2  353 -24119.942 -20451.774  15.2%  8652  958s
     5    12 -21118.915    3  565 -24119.942 -20536.056  14.9%  6201  968s
    11    24 -22468.540    4  557 -24119.942 -20568.861  14.7%  9407  980s
    23    37 -22757.456    5   83 -24119.942 -20613.482  14.5% 10285 1007s
    36    63 -21562.499    6  131 -24119.942 -20613.482  14.5% 10176 1096s
H   60    63                    -24115.84500 -20613.482  14.5%  6686 1096s
    68   142 -21568.620    7  120 -24115.845 -20657.232  14.3% 11160 1119s
   197   165 -22667.033   10   98 -24115.845 -21152.184  12.3%  6962 1129s
   283   159 -21734.023   10  108 -24115.845 -21165.137  12.2%  5899 1141s
   373   179 -23348.640   11   86 -24115.845 -21165.137  12.2%  5382 1152s
   425   204 -23627.600   12   89 -24115.845 -21224.521  12.0%  5311 1162s
   502   219 -23578.335   12   79 -24115.845 -21224.521  12.0%  5045 1172s
   562   220 -23742.184   13   81 -24115.845 -21224.521  12.0%  4871 1184s
   609   217 infeasible   14      -24115.845 -21224.521  12.0%  4880 1194s
   655   202 -24053.001   16   41 -24115.845 -21224.521  12.0%  4856 1206s
   714   204 -24055.143   17   43 -24115.845 -21224.521  12.0%  4790 1216s
   758   201 -22359.013   13  476 -24115.845 -21224.521  12.0%  4838 1226s
   818   198 -22570.149   14  373 -24115.845 -21224.521  12.0%  4822 1237s
   891   195 -22966.739   15  597 -24115.845 -21243.119  11.9%  4782 1247s
   953   212 -23610.551   16  670 -24115.845 -21243.119  11.9%  4773 1258s
  1029   220 -23635.437   17  739 -24115.845 -21243.119  11.9%  4716 1267s
  1097   255 -23682.183   18  442 -24115.845 -21243.119  11.9%  4724 1277s
  1152   288 -23723.945   19  508 -24115.845 -21405.251  11.2%  4760 1288s
  1251   283 -24045.174   20  548 -24115.845 -21405.251  11.2%  4623 1300s
  1350   264 infeasible   22      -24115.845 -21405.251  11.2%  4544 1314s
  1445   259 -23804.975   13  762 -24115.845 -21405.251  11.2%  4506 1328s
  1521   232 -23923.628   14  635 -24115.845 -21405.251  11.2%  4529 1344s
  1615   228 infeasible   14      -24115.845 -21702.056  10.0%  4495 1362s
  1666   216 -23770.277    8  909 -24115.845 -21702.056  10.0%  4550 1384s
  1743   195 -24011.462    9  756 -24115.845 -21702.056  10.0%  4555 1398s
  1836   174 infeasible    9      -24115.845 -22140.261  8.19%  4542 1415s
  1957   162 -23059.246   20  562 -24115.845 -22140.261  8.19%  4525 1431s
  2103   163     cutoff   23      -24115.845 -22140.261  8.19%  4446 1449s
  2209   183 -23597.960   23  344 -24115.845 -22140.261  8.19%  4355 1465s
  2411    73 infeasible   31      -24115.845 -22140.261  8.19%  4180 1482s
  2621    44     cutoff    5      -24115.845 -22468.879  6.83%  4058 1502s
  2770    12 infeasible    6      -24115.845 -23061.856  4.37%  3930 1517s
  2885     0 infeasible    8      -24115.845 -23062.766  4.37%  3806 1525s

Cutting planes:
  Learned: 1
  Implied bound: 455
  MIR: 3347
  Flow cover: 3999
  Zero half: 7
  RLT: 211
  Relax-and-lift: 1011

Explored 2908 nodes (11840130 simplex iterations) in 1525.94 seconds (3459.96 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24115.8 -24119.9 -24125.9 ... -25278.9
No other solutions better than -24115.8

Optimal solution found (tolerance 1.00e-06)
Best objective -2.411584499730e+04, best bound -2.411584499730e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1525.99s
  Master Objective (UB) = -24115.84, θ = 87267.44
  Upper Bound (UB) = -24115.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87267.44
  [DEBUG]   ✓ Scenario 0: θ = 87267.44 ≤ Q = 87267.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87267.44 ≤ Q = 87267.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87267.44 ≤ Q = 87267.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87267.44 ≤ Q = 87267.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87267.44 ≤ Q = 87267.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87267.44 ≤ Q = 87267.44 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x42af737c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbd508c84
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6676662.6424
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.083082e+05, 211 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108308.16    0  122 6676662.64 -108308.16   102%     -    0s
H    0     0                    -78509.55078 -108308.16  38.0%     -    0s
H    0     0                    -78935.56132 -108308.16  37.2%     -    0s
     0     0 -83923.491    0   56 -78935.561 -83923.491  6.32%     -    0s
H    0     0                    -81917.82661 -83869.377  2.38%     -    0s
     0     0 -83727.077    0   57 -81917.827 -83727.077  2.21%     -    0s
     0     0 -83492.636    0   57 -81917.827 -83492.636  1.92%     -    0s
H    0     0                    -82644.80913 -83404.904  0.92%     -    0s
H    0     0                    -82646.05955 -83404.904  0.92%     -    0s
     0     0 -83404.904    0   58 -82646.060 -83404.904  0.92%     -    0s
     0     0 -83403.127    0   58 -82646.060 -83403.127  0.92%     -    0s
     0     0 -83030.646    0   28 -82646.060 -83030.646  0.47%     -    0s
     0     0 -82947.745    0   32 -82646.060 -82947.745  0.37%     -    0s
     0     0 -82946.759    0   33 -82646.060 -82946.759  0.36%     -    0s
     0     0 -82752.248    0   18 -82646.060 -82752.248  0.13%     -    0s
     0     0 -82649.097    0   11 -82646.060 -82649.097  0.00%     -    0s
     0     0     cutoff    0      -82646.060 -82646.060  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 8
  MIR: 107
  Flow cover: 8
  RLT: 56
  Relax-and-lift: 6
  BQP: 7

Explored 1 nodes (547 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -82646.1 -78935.6 -78509.6 ... 1.42347e+13
No other solutions better than -82646.1

Optimal solution found (tolerance 1.00e-06)
Best objective -8.264605954933e+04, best bound -8.264605954933e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 85118.29
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82646.06
  [DEBUG]   S×d_nominal = 167764.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 167764.35 + -82646.06 = 85118.29
  [DEBUG]   Current θ from Master = 87267.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2149.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26264.99
  Lower Bound (LB) = -25649.14
  Gap (UB-LB) = 1533.2909, Absolute Gap = 1533.2909, Relative Gap = 0.063580
  Not converged yet (gap = 1533.29 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653624 nonzeros
Model fingerprint: 0x8048ecf0
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 118170 rows and 47970 columns
Presolve time: 2.74s
Presolved: 112563 rows, 47890 columns, 681269 nonzeros
Variable types: 45631 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -403358.4564
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 521
 AA' NZ     : 5.253e+06
 Factor NZ  : 1.197e+07 (roughly 160 MB of memory)
 Factor Ops : 2.449e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.38306620e+07  2.12859661e+08  2.65e+05 2.78e+01  1.04e+05     4s
   1  -2.94574679e+07  2.06106228e+08  2.22e+05 6.45e+01  8.60e+04     4s
   2  -8.97212325e+06  1.30363002e+08  6.64e+04 6.05e+00  2.71e+04     4s
   3  -1.91139955e+06  9.84985914e+07  9.53e+03 1.94e+00  4.24e+03     4s
   4  -7.12024253e+05  4.23137072e+07  1.09e+03 3.34e-01  5.97e+02     4s
   5  -4.35175735e+05  2.28909361e+07  5.21e+02 1.53e-01  2.80e+02     4s
   6  -2.90547098e+05  1.65231070e+07  1.66e+02 9.73e-02  1.31e+02     4s
   7  -1.71139338e+05  1.18683811e+07  5.62e+01 6.45e-02  7.30e+01     5s
   8  -1.38827387e+05  8.28107837e+06  3.71e+01 4.36e-02  4.88e+01     5s
   9  -1.09475431e+05  5.71129869e+06  2.34e+01 2.88e-02  3.21e+01     5s
  10  -8.29873446e+04  2.14385058e+06  1.28e+01 9.57e-03  1.18e+01     5s
  11  -5.15775646e+04  5.12005679e+05  5.10e+00 1.80e-03  2.88e+00     5s
  12  -4.26625361e+04  2.22897951e+05  2.98e+00 9.49e-04  1.33e+00     5s
  13  -3.32039388e+04  1.06105924e+05  1.57e+00 6.70e-04  6.89e-01     5s
  14  -2.97141249e+04  7.54274685e+04  1.21e+00 6.02e-04  5.18e-01     5s
  15  -2.61508003e+04  4.58929430e+04  9.41e-01 8.49e-04  3.54e-01     5s
  16  -2.19268682e+04  3.17805754e+04  6.29e-01 1.44e-03  2.63e-01     5s
  17  -2.00618272e+04  2.08527719e+04  5.27e-01 1.98e-03  2.00e-01     5s
  18  -1.73991384e+04  1.10212879e+04  3.80e-01 1.73e-03  1.39e-01     5s
  19  -1.54208656e+04  7.35609021e+03  2.92e-01 9.83e-04  1.11e-01     5s
  20  -1.43314982e+04  4.60924579e+03  2.53e-01 1.04e-03  9.25e-02     5s
  21  -1.29025689e+04  1.51541972e+03  2.06e-01 1.34e-03  7.04e-02     5s
  22  -1.21336075e+04  4.71841758e+01  1.77e-01 1.20e-03  5.95e-02     5s
  23  -1.12613858e+04 -2.31693138e+03  1.49e-01 1.40e-03  4.37e-02     5s
  24  -1.05721445e+04 -3.31349817e+03  1.28e-01 1.59e-03  3.54e-02     5s
  25  -1.01739728e+04 -3.98936223e+03  1.16e-01 1.59e-03  3.02e-02     5s
  26  -9.58871541e+03 -4.43155451e+03  9.78e-02 1.30e-03  2.52e-02     5s
  27  -9.04890178e+03 -4.76868991e+03  8.17e-02 1.58e-03  2.09e-02     5s
  28  -8.46292158e+03 -5.14164883e+03  6.51e-02 1.07e-03  1.62e-02     5s
  29  -7.92646783e+03 -5.38603334e+03  4.98e-02 8.05e-04  1.24e-02     5s
  30  -7.58649525e+03 -5.61451268e+03  4.02e-02 6.36e-04  9.63e-03     5s
  31  -7.29070553e+03 -5.78872122e+03  3.22e-02 6.03e-04  7.34e-03     5s
  32  -7.02151775e+03 -5.87832087e+03  2.48e-02 1.04e-03  5.59e-03     6s
  33  -6.71759326e+03 -5.93468617e+03  1.65e-02 7.77e-04  3.82e-03     6s
  34  -6.62018772e+03 -5.94944727e+03  1.40e-02 9.24e-04  3.28e-03     6s
  35  -6.55548088e+03 -5.97004245e+03  1.23e-02 9.16e-04  2.86e-03     6s
  36  -6.42839536e+03 -5.98898433e+03  8.96e-03 8.31e-04  2.15e-03     6s
  37  -6.33723938e+03 -6.01462591e+03  6.52e-03 7.11e-04  1.58e-03     6s
  38  -6.26247648e+03 -6.03662284e+03  4.52e-03 5.40e-04  1.10e-03     6s
  39  -6.19192040e+03 -6.05847183e+03  2.65e-03 5.94e-04  6.51e-04     6s
  40  -6.12592622e+03 -6.06660280e+03  8.97e-04 4.33e-04  2.89e-04     6s
  41  -6.11751724e+03 -6.07427225e+03  6.86e-04 2.77e-04  2.11e-04     6s
  42  -6.11690660e+03 -6.07917892e+03  6.72e-04 1.83e-04  1.84e-04     6s
  43  -6.10895217e+03 -6.08126695e+03  4.81e-04 1.41e-04  1.35e-04     6s
  44  -6.10130359e+03 -6.08478993e+03  3.03e-04 6.57e-05  8.06e-05     6s
  45  -6.09273381e+03 -6.08739501e+03  9.39e-05 2.20e-05  2.60e-05     6s
  46  -6.09100483e+03 -6.08768313e+03  5.26e-05 1.74e-05  1.62e-05     6s
  47  -6.08944871e+03 -6.08843870e+03  1.49e-05 5.08e-06  4.92e-06     6s
  48  -6.08892738e+03 -6.08874345e+03  2.97e-06 6.10e-07  8.97e-07     6s
  49  -6.08879152e+03 -6.08879017e+03  1.44e-08 7.01e-09  6.57e-09     6s
  50  -6.08879098e+03 -6.08879062e+03  4.19e-08 6.49e-09  1.72e-09     6s
  51  -6.08879063e+03 -6.08879063e+03  5.85e-08 1.89e-09  1.65e-11     6s

Barrier solved model in 51 iterations and 6.34 seconds (10.16 work units)
Optimal objective -6.08879063e+03


Root crossover log...

   82035 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    5171 PPushes remaining with PInf 1.3298911e-06                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.5112098e-11      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   41146   -6.0887906e+03   0.000000e+00   0.000000e+00      9s
   41146   -6.0887906e+03   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.41s

Solved with barrier

Root relaxation: objective -6.088791e+03, 41146 iterations, 6.53 seconds (15.40 work units)
Total elapsed time = 10.10s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -6088.7906    0  592 -205910.05 -6088.7906  97.0%     -   10s
H    0     0                    -168009.1254 -6088.7906  96.4%     -   10s
H    0     0                    -167918.3255 -6088.7906  96.4%     -   10s
H    0     0                    -167738.0767 -6088.7906  96.4%     -   10s
H    0     0                    -154784.1819 -6088.7906  96.1%     -   10s
H    0     0                    -152247.5263 -6088.7906  96.0%     -   10s
H    0     0                    -146132.6985 -6088.7906  95.8%     -   10s
H    0     0                    -144872.7935 -6088.7906  95.8%     -   11s
H    0     0                    -93963.02253 -6088.7906  93.5%     -   11s
H    0     0                    -93828.75710 -6088.7906  93.5%     -   11s
H    0     0                    -83984.83661 -6088.7906  92.8%     -   11s
H    0     0                    -83722.27049 -6088.7906  92.7%     -   11s
H    0     0                    -72217.87596 -6088.7906  91.6%     -   13s
H    0     0                    -62126.51974 -6088.7906  90.2%     -   13s
H    0     0                    -61934.51614 -6088.7906  90.2%     -   13s
H    0     0                    -61930.94620 -6088.7906  90.2%     -   13s
H    0     0                    -61928.27652 -6088.7906  90.2%     -   13s
H    0     0                    -61917.63783 -6088.7906  90.2%     -   13s
H    0     0                    -61915.47852 -6088.7906  90.2%     -   13s
H    0     0                    -61910.05998 -6088.7906  90.2%     -   13s
     0     0 -9869.5948    0  800 -61910.060 -9869.5948  84.1%     -   79s
H    0     0                    -59912.18942 -9869.5948  83.5%     -   79s
H    0     0                    -58937.05952 -9869.5948  83.3%     -   80s
     0     0 -10005.788    0  896 -58937.060 -10005.788  83.0%     -   94s
     0     0 -10010.075    0  894 -58937.060 -10010.075  83.0%     -  101s
     0     0 -10019.653    0  894 -58937.060 -10019.653  83.0%     -  105s
     0     0 -10025.730    0  900 -58937.060 -10025.730  83.0%     -  117s
     0     0 -10025.730    0  896 -58937.060 -10025.730  83.0%     -  121s
     0     0 -10025.730    0  898 -58937.060 -10025.730  83.0%     -  122s
H    0     0                    -55927.39444 -13247.021  76.3%     -  220s
H    0     0                    -55314.09846 -13247.021  76.1%     -  220s
H    0     0                    -55306.06444 -13247.021  76.0%     -  220s
     0     0 -13247.021    0  931 -55306.064 -13247.021  76.0%     -  220s
H    0     0                    -48952.09379 -13247.570  72.9%     -  220s
H    0     0                    -48899.06484 -13247.570  72.9%     -  220s
H    0     0                    -48572.61273 -13247.570  72.7%     -  221s
H    0     0                    -48516.98980 -13247.570  72.7%     -  221s
H    0     0                    -48430.10436 -13247.570  72.6%     -  221s
H    0     0                    -48374.48144 -13247.570  72.6%     -  221s
H    0     0                    -48370.53023 -13247.570  72.6%     -  221s
H    0     0                    -47858.43859 -13247.570  72.3%     -  221s
H    0     0                    -47802.81566 -13247.570  72.3%     -  221s
H    0     0                    -47798.86445 -13247.570  72.3%     -  221s
H    0     0                    -47771.88534 -13247.570  72.3%     -  221s
     0     0 -14888.064    0  956 -47771.885 -14888.064  68.8%     -  322s
H    0     0                    -29221.43324 -15089.275  48.4%     -  354s
H    0     0                    -28886.46382 -15089.275  47.8%     -  354s
H    0     0                    -28825.07005 -15089.275  47.7%     -  354s
H    0     0                    -28762.04163 -15089.275  47.5%     -  354s
H    0     0                    -28717.44442 -15089.275  47.5%     -  354s
H    0     0                    -28703.06835 -15089.275  47.4%     -  354s
H    0     0                    -28658.47114 -15089.275  47.3%     -  354s
     0     0 -15089.275    0  925 -28658.471 -15089.275  47.3%     -  354s
H    0     0                    -26316.14332 -15152.059  42.4%     -  378s
H    0     0                    -24468.87675 -15152.059  38.1%     -  378s
H    0     0                    -24300.99302 -15152.059  37.6%     -  378s
H    0     0                    -24296.97297 -15152.059  37.6%     -  378s
H    0     0                    -24273.87450 -15152.059  37.6%     -  378s
H    0     0                    -24266.63274 -15152.059  37.6%     -  378s
H    0     0                    -24254.20155 -15152.059  37.5%     -  378s
     0     0 -15152.059    0  857 -24254.202 -15152.059  37.5%     -  378s
     0     0 -15206.798    0  846 -24254.202 -15206.798  37.3%     -  405s
     0     0 -15222.543    0  846 -24254.202 -15222.543  37.2%     -  417s
     0     0 -15291.148    0  847 -24254.202 -15291.148  37.0%     -  441s
     0     0 -15328.020    0  911 -24254.202 -15328.020  36.8%     -  451s
     0     0 -15346.178    0  837 -24254.202 -15346.178  36.7%     -  456s
     0     0 -15358.623    0  834 -24254.202 -15358.623  36.7%     -  461s
     0     0 -15416.580    0  916 -24254.202 -15416.580  36.4%     -  473s
     0     0 -15426.348    0  835 -24254.202 -15426.348  36.4%     -  478s
     0     0 -15428.622    0  842 -24254.202 -15428.622  36.4%     -  482s
     0     0 -15430.961    0  842 -24254.202 -15430.961  36.4%     -  484s
     0     0 -15433.517    0  843 -24254.202 -15433.517  36.4%     -  488s
     0     0 -15434.583    0  845 -24254.202 -15434.583  36.4%     -  490s
     0     0 -15454.141    0  829 -24254.202 -15454.141  36.3%     -  498s
     0     0 -15457.829    0  841 -24254.202 -15457.829  36.3%     -  501s
     0     0 -15458.980    0  843 -24254.202 -15458.980  36.3%     -  507s
     0     0 -15459.541    0  848 -24254.202 -15459.541  36.3%     -  510s
H    0     0                    -24229.92804 -17723.573  26.9%     -  632s
H    0     0                    -24201.43419 -17723.573  26.8%     -  632s
H    0     0                    -24171.74928 -17723.573  26.7%     -  632s
H    0     0                    -24168.27841 -17723.573  26.7%     -  632s
H    0     0                    -24156.92728 -17723.573  26.6%     -  632s
H    0     0                    -24152.97607 -17723.573  26.6%     -  632s
     0     0 -17723.573    0  756 -24152.976 -17723.573  26.6%     -  632s
     0     0 -18160.697    0  862 -24152.976 -18160.697  24.8%     -  657s
H    0     0                    -24149.99699 -18272.352  24.3%     -  671s
H    0     0                    -24141.70738 -18272.352  24.3%     -  671s
H    0     0                    -24136.37736 -18272.352  24.3%     -  671s
H    0     0                    -24133.31422 -18272.352  24.3%     -  671s
H    0     0                    -24132.83387 -18272.352  24.3%     -  671s
     0     0 -18272.352    0  681 -24132.834 -18272.352  24.3%     -  671s
     0     0 -18286.764    0  679 -24132.834 -18286.764  24.2%     -  676s
     0     0 -18289.027    0  861 -24132.834 -18289.027  24.2%     -  679s
     0     0 -18336.151    0  859 -24132.834 -18336.151  24.0%     -  686s
     0     0 -18340.915    0  860 -24132.834 -18340.915  24.0%     -  689s
     0     0 -18350.851    0  855 -24132.834 -18350.851  24.0%     -  693s
     0     0 -18354.051    0  869 -24132.834 -18354.051  23.9%     -  696s
     0     0 -18360.243    0  873 -24132.834 -18360.243  23.9%     -  699s
     0     0 -18379.227    0  874 -24132.834 -18379.227  23.8%     -  702s
     0     0 -18381.075    0  879 -24132.834 -18381.075  23.8%     -  704s
     0     0 -19231.480    0  775 -24132.834 -19231.480  20.3%     -  738s
     0     0 -19473.968    0  805 -24132.834 -19473.968  19.3%     -  759s
     0     0 -19528.184    0  720 -24132.834 -19528.184  19.1%     -  770s
     0     0 -19582.692    0  904 -24132.834 -19582.692  18.9%     -  781s
     0     0 -19595.864    0  812 -24132.834 -19595.864  18.8%     -  787s
     0     0 -19613.748    0  898 -24132.834 -19613.748  18.7%     -  791s
     0     0 -19615.812    0  910 -24132.834 -19615.812  18.7%     -  793s
     0     0 -19841.051    0  792 -24132.834 -19841.051  17.8%     -  815s
     0     0 -19901.252    0  807 -24132.834 -19901.252  17.5%     -  825s
     0     0 -19932.555    0  800 -24132.834 -19932.555  17.4%     -  832s
     0     0 -19946.508    0  808 -24132.834 -19946.508  17.3%     -  836s
     0     0 -19985.212    0  725 -24132.834 -19985.212  17.2%     -  845s
     0     0 -20001.126    0  815 -24132.834 -20001.126  17.1%     -  849s
     0     0 -20006.805    0  809 -24132.834 -20006.805  17.1%     -  853s
     0     0 -20010.417    0  710 -24132.834 -20010.417  17.1%     -  855s
     0     0 -20018.940    0  812 -24132.834 -20018.940  17.0%     -  857s
     0     0 -20024.699    0  810 -24132.834 -20024.699  17.0%     -  860s
     0     0 -20025.818    0  820 -24132.834 -20025.818  17.0%     -  862s
     0     0 -20121.882    0  898 -24132.834 -20121.882  16.6%     -  878s
     0     0 -20182.969    0  964 -24132.834 -20182.969  16.4%     -  894s
     0     0 -20196.683    0  905 -24132.834 -20196.683  16.3%     -  899s
     0     0 -20205.737    0  827 -24132.834 -20205.737  16.3%     -  904s
     0     0 -20206.639    0  839 -24132.834 -20206.639  16.3%     -  905s
     0     0 -20254.897    0  823 -24132.834 -20254.897  16.1%     -  919s
     0     0 -20266.071    0  823 -24132.834 -20266.071  16.0%     -  923s
     0     0 -20266.715    0  816 -24132.834 -20266.715  16.0%     -  925s
     0     0 -20288.173    0  754 -24132.834 -20288.173  15.9%     -  938s
     0     0 -20294.909    0  755 -24132.834 -20294.909  15.9%     -  944s
     0     0 -20297.429    0  750 -24132.834 -20297.429  15.9%     -  946s
     0     0 -20320.136    0  838 -24132.834 -20320.136  15.8%     -  953s
     0     0 -20323.765    0  759 -24132.834 -20323.765  15.8%     -  956s
     0     0 -20331.608    0  758 -24132.834 -20331.608  15.8%     -  960s
     0     0 -20335.531    0  761 -24132.834 -20335.531  15.7%     -  961s
     0     0 -20337.420    0  767 -24132.834 -20337.420  15.7%     -  963s
     0     0 -20360.849    0  841 -24132.834 -20360.849  15.6%     -  972s
     0     0 -20365.716    0  857 -24132.834 -20365.716  15.6%     -  976s
     0     0 -20367.851    0  769 -24132.834 -20367.851  15.6%     -  978s
     0     0 -20385.842    0  866 -24132.834 -20385.842  15.5%     -  986s
     0     0 -20387.372    0  860 -24132.834 -20387.372  15.5%     -  991s
     0     0 -20410.597    0  880 -24132.834 -20410.597  15.4%     - 1001s
     0     0 -20417.299    0  788 -24132.834 -20417.299  15.4%     - 1005s
     0     0 -20420.762    0  871 -24132.834 -20420.762  15.4%     - 1013s
     0     0 -20422.549    0  872 -24132.834 -20422.549  15.4%     - 1014s
     0     0 -20422.549    0  872 -24132.834 -20422.549  15.4%     - 1014s
     0     0 -20428.017    0  864 -24132.834 -20428.017  15.4%     - 1020s
     0     0 -20428.634    0  866 -24132.834 -20428.634  15.3%     - 1039s
     0     0 -20436.517    0  934 -24132.834 -20436.517  15.3%     - 1045s
     0     0 -20436.779    0  934 -24132.834 -20436.779  15.3%     - 1055s
     0     2 -20436.779    0  934 -24132.834 -20436.779  15.3%     - 1091s
     1     3 -21041.988    1  231 -24132.834 -20436.779  15.3% 35661 1106s
     2     5 -21333.238    2  228 -24132.834 -20436.779  15.3% 20438 1111s
     4     8 -20614.123    2  925 -24132.834 -20528.867  14.9% 12581 1132s
     7    15 -21651.192    3  481 -24132.834 -20528.867  14.9% 17610 1147s
    14    20 -21921.751    4  480 -24132.834 -20617.536  14.6% 12785 1184s
    21    28 -22302.675    5  123 -24132.834 -20617.536  14.6% 11584 1241s
    39    36 -22519.955    6  114 -24132.834 -20617.536  14.6% 19321 1311s
    63    46 infeasible    7      -24132.834 -20668.758  14.4% 16270 1338s
    95   105 -20873.342    6  555 -24132.834 -20809.045  13.8% 13892 1366s
   182   150 -21474.680    7  595 -24132.834 -20860.250  13.6% 10422 1387s
   287   129 -22937.172   15   64 -24132.834 -20860.250  13.6%  7908 1401s
   390   105 -21517.583    8  668 -24132.834 -20860.250  13.6%  6803 1417s
   450   105 -22272.404    8   95 -24132.834 -20875.050  13.5%  6751 1434s
   476   102 infeasible    9      -24132.834 -20875.050  13.5%  6877 1449s
   526   112     cutoff   11      -24132.834 -21673.433  10.2%  7044 1465s
   580   126 -22316.078   11  653 -24132.834 -21673.433  10.2%  6917 1480s
   666   139 -22421.627   12  631 -24132.834 -21673.433  10.2%  6531 1496s
   741   194 -22843.378   13  485 -24132.834 -21673.433  10.2%  6246 1510s
   841   228 -22885.566   14  499 -24132.834 -21673.433  10.2%  5804 1521s
   928   198 -23120.061   15  631 -24132.834 -21673.433  10.2%  5451 1533s
  1058   199 -23068.840   14  158 -24132.834 -21673.433  10.2%  5063 1545s
  1109   185 infeasible   15      -24132.834 -21673.433  10.2%  5015 1559s
  1171   187     cutoff   14      -24132.834 -21673.433  10.2%  4961 1572s
  1231   197 -23040.449   20  322 -24132.834 -21673.433  10.2%  4986 1588s
  1289   219 -23557.587   22  338 -24132.834 -21673.433  10.2%  4961 1601s
  1359   240 infeasible   24      -24132.834 -21673.433  10.2%  4957 1612s
  1426   254 infeasible   26      -24132.834 -21673.433  10.2%  4965 1626s
  1490   248 infeasible   26      -24132.834 -21923.491  9.15%  4934 1640s
  1556   237 infeasible   24      -24132.834 -22572.132  6.47%  4974 1655s
  1641   249 -23713.907   16  446 -24132.834 -22572.132  6.47%  4962 1668s
  1717   253 -23795.469   17  442 -24132.834 -22572.132  6.47%  4955 1685s
  1792   256 infeasible   20      -24132.834 -22763.584  5.67%  4958 1699s
  1903   222 -24040.163   18  524 -24132.834 -22911.880  5.06%  4914 1713s
  2017   207 infeasible   23      -24132.834 -22979.725  4.78%  4909 1727s
  2140   147 infeasible   28      -24132.834 -23037.419  4.54%  4874 1741s
  2275    96 -23727.421   21  594 -24132.834 -23337.494  3.30%  4849 1760s
  2414    65 infeasible   21      -24132.834 -23441.829  2.86%  4828 1775s
  2481    32 infeasible   25      -24132.834 -23444.215  2.85%  4829 1785s
  2567    13 infeasible   25      -24132.834 -23444.215  2.85%  4741 1795s
  2630     4 infeasible   17      -24132.834 -23930.902  0.84%  4687 1802s
  2649    12 -24022.615   18   60 -24132.834 -23959.726  0.72%  4663 1810s
  2684     7     cutoff   20      -24132.834 -24001.473  0.54%  4613 1819s
  2710     5 -24076.123   22   29 -24132.834 -24076.123  0.23%  4573 1829s
  2737     2 -24131.449   27    8 -24132.834 -24090.887  0.17%  4531 1835s

Cutting planes:
  Learned: 2
  Implied bound: 279
  MIR: 3587
  Flow cover: 4119
  Zero half: 9
  RLT: 193
  Relax-and-lift: 1114

Explored 2747 nodes (13301071 simplex iterations) in 1836.00 seconds (4041.70 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24132.8 -24133.3 -24136.4 ... -24201.4
No other solutions better than -24132.8

Optimal solution found (tolerance 1.00e-06)
Best objective -2.413283387494e+04, best bound -2.413283387494e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1836.04s
  Master Objective (UB) = -24132.83, θ = 87301.55
  Upper Bound (UB) = -24132.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87301.55
  [DEBUG]   ✓ Scenario 0: θ = 87301.55 ≤ Q = 87301.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87301.55 ≤ Q = 87301.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87301.55 ≤ Q = 87301.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87301.55 ≤ Q = 87301.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87301.55 ≤ Q = 87301.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87301.55 ≤ Q = 87301.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87301.55 ≤ Q = 87301.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87301.55 ≤ Q = 87301.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87301.55 ≤ Q = 87301.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87301.55 ≤ Q = 87301.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87301.55 ≤ Q = 87301.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87301.55 ≤ Q = 87301.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87301.55 ≤ Q = 87301.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87301.55 ≤ Q = 87301.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87301.55 ≤ Q = 87301.55 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x52d74b24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x52d74b24
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6661452.5684
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.089001e+05, 212 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108900.13    0  122 6661452.57 -108900.13   102%     -    0s
H    0     0                    -79024.98454 -108900.13  37.8%     -    0s
H    0     0                    -79436.25455 -108900.13  37.1%     -    0s
     0     0 -85582.239    0   53 -79436.255 -85582.239  7.74%     -    0s
H    0     0                    -83744.82040 -85565.476  2.17%     -    0s
     0     0 -85348.068    0   54 -83744.820 -85348.068  1.91%     -    0s
H    0     0                    -84255.64047 -85271.382  1.21%     -    0s
H    0     0                    -84267.86600 -85110.946  1.00%     -    0s
     0     0 -85110.946    0   56 -84267.866 -85110.946  1.00%     -    0s
     0     0 -85050.303    0   58 -84267.866 -85050.303  0.93%     -    0s
     0     0 -85043.883    0   58 -84267.866 -85043.883  0.92%     -    0s
     0     0 -84617.758    0   45 -84267.866 -84617.758  0.42%     -    0s
     0     0 -84612.814    0   20 -84267.866 -84612.814  0.41%     -    0s
     0     0 -84498.504    0   28 -84267.866 -84498.504  0.27%     -    0s
     0     0 -84363.132    0   20 -84267.866 -84363.132  0.11%     -    0s
     0     0 -84290.595    0    8 -84267.866 -84290.595  0.03%     -    0s
     0     0 -84275.986    0    4 -84267.866 -84275.986  0.01%     -    0s
     0     0     cutoff    0      -84267.866 -84267.866  0.00%     -    0s

Cutting planes:
  Gomory: 14
  MIR: 126
  Flow cover: 1
  RLT: 37
  Relax-and-lift: 1
  BQP: 10

Explored 1 nodes (529 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -84267.9 -79436.3 -79025 ... 1.42347e+13
No other solutions better than -84267.9

Optimal solution found (tolerance 1.00e-06)
Best objective -8.426786600021e+04, best bound -8.426786600021e+04, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 84011.42
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84267.87
  [DEBUG]   S×d_nominal = 168279.29
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168279.29 + -84267.87 = 84011.42
  [DEBUG]   Current θ from Master = 87301.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3290.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27422.96
  Lower Bound (LB) = -25649.14
  Gap (UB-LB) = 1516.3021, Absolute Gap = 1516.3021, Relative Gap = 0.062831
  Not converged yet (gap = 1516.30 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 696831 nonzeros
Model fingerprint: 0x694ab270
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 126048 rows and 51168 columns
Presolve time: 1.65s
Presolved: 119975 rows, 50932 columns, 741339 nonzeros
Variable types: 48673 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402510.6796
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 527
 AA' NZ     : 6.564e+06
 Factor NZ  : 1.424e+07 (roughly 200 MB of memory)
 Factor Ops : 3.110e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.22366598e+07  2.16938803e+08  2.53e+05 2.70e+01  9.74e+04     3s
   1  -2.77464306e+07  2.07478809e+08  2.10e+05 5.55e+01  8.01e+04     3s
   2  -1.11031852e+07  1.32530872e+08  7.80e+04 3.31e+00  3.14e+04     3s
   3  -4.03055677e+06  1.24107812e+08  2.57e+04 2.15e+00  1.07e+04     3s
   4  -1.47078042e+06  7.00550029e+07  6.89e+03 6.06e-01  2.90e+03     3s
   5  -5.99643121e+05  4.83481594e+07  9.85e+02 3.07e-01  5.75e+02     3s
   6  -4.99004359e+05  2.37912494e+07  4.99e+02 1.05e-01  2.70e+02     3s
   7  -3.79261608e+05  1.68284928e+07  1.88e+02 7.01e-02  1.34e+02     3s
   8  -2.71613693e+05  1.14214759e+07  5.14e+01 4.12e-02  6.65e+01     3s
   9  -1.31461971e+05  8.93360667e+06  1.00e+01 3.08e-02  4.35e+01     3s
  10  -1.12504091e+05  5.78854610e+06  6.34e+00 1.97e-02  2.79e+01     3s
  11  -8.96277934e+04  2.20386091e+06  2.74e+00 7.16e-03  1.06e+01     3s
  12  -6.96207964e+04  1.00684186e+06  6.44e-01 3.18e-03  4.93e+00     3s
  13  -5.92591895e+04  4.29167788e+05  4.04e-01 1.31e-03  2.23e+00     3s
  14  -5.06402552e+04  3.46993239e+05  2.78e-01 1.06e-03  1.82e+00     3s
  15  -4.38529673e+04  1.67122926e+05  2.01e-01 5.26e-04  9.63e-01     3s
  16  -3.79253422e+04  1.33449949e+05  1.57e-01 8.66e-04  7.82e-01     4s
  17  -3.44454929e+04  8.90047310e+04  1.32e-01 1.23e-03  5.64e-01     4s
  18  -3.00033650e+04  7.10481042e+04  1.04e-01 1.08e-03  4.61e-01     4s
  19  -2.75671610e+04  4.91994422e+04  8.77e-02 1.77e-03  3.50e-01     4s
  20  -2.52928643e+04  2.94377132e+04  7.36e-02 2.07e-03  2.50e-01     4s
  21  -2.31038173e+04  1.56930501e+04  6.09e-02 1.29e-03  1.77e-01     4s
  22  -2.12855014e+04  8.33342850e+03  5.07e-02 1.28e-03  1.35e-01     4s
  23  -1.98770287e+04  4.66510712e+03  4.35e-02 1.07e-03  1.12e-01     4s
  24  -1.83674305e+04  3.26394639e+03  3.63e-02 1.02e-03  9.88e-02     4s
  25  -1.74840896e+04  1.11269998e+03  3.24e-02 8.51e-04  8.49e-02     4s
  26  -1.70893947e+04  6.30775416e+02  3.06e-02 8.05e-04  8.09e-02     4s
  27  -1.62203260e+04 -2.64277014e+03  2.65e-02 5.59e-04  6.20e-02     4s
  28  -1.53665560e+04 -3.47647732e+03  2.28e-02 4.95e-04  5.43e-02     4s
  29  -1.46311506e+04 -4.99231041e+03  1.96e-02 3.78e-04  4.40e-02     4s
  30  -1.37947082e+04 -5.63041738e+03  1.62e-02 3.35e-04  3.73e-02     4s
  31  -1.32026377e+04 -6.33940545e+03  1.39e-02 2.78e-04  3.13e-02     4s
  32  -1.23882828e+04 -7.14177558e+03  1.08e-02 2.03e-04  2.40e-02     4s
  33  -1.16971793e+04 -7.97902886e+03  8.25e-03 1.19e-04  1.70e-02     4s
  34  -1.15442631e+04 -8.02087557e+03  7.70e-03 1.16e-04  1.61e-02     4s
  35  -1.12160754e+04 -8.34912404e+03  6.52e-03 8.67e-05  1.31e-02     4s
  36  -1.09644227e+04 -8.52676142e+03  5.66e-03 7.40e-05  1.11e-02     4s
  37  -1.07162049e+04 -8.60302680e+03  4.79e-03 6.59e-05  9.65e-03     4s
  38  -1.04374024e+04 -8.77135085e+03  3.81e-03 5.02e-05  7.61e-03     5s
  39  -1.00462803e+04 -8.85557335e+03  2.48e-03 4.09e-05  5.44e-03     5s
  40  -9.97960164e+03 -9.03244095e+03  2.26e-03 2.45e-05  4.33e-03     5s
  41  -9.84262051e+03 -9.07490227e+03  1.79e-03 2.02e-05  3.51e-03     5s
  42  -9.75804215e+03 -9.13293658e+03  1.52e-03 1.69e-05  2.86e-03     5s
  43  -9.64705385e+03 -9.17592388e+03  1.16e-03 1.21e-05  2.15e-03     5s
  44  -9.61319088e+03 -9.19198864e+03  1.04e-03 1.02e-05  1.92e-03     5s
  45  -9.56265335e+03 -9.21467624e+03  8.72e-04 7.94e-06  1.59e-03     5s
  46  -9.50941498e+03 -9.22660771e+03  6.90e-04 1.13e-05  1.29e-03     5s
  47  -9.48469727e+03 -9.25250059e+03  6.02e-04 9.56e-06  1.06e-03     5s
  48  -9.47942802e+03 -9.25761443e+03  5.86e-04 8.72e-06  1.01e-03     5s
  49  -9.42904269e+03 -9.26819505e+03  4.13e-04 6.38e-06  7.35e-04     5s
  50  -9.39274159e+03 -9.27728917e+03  2.90e-04 7.74e-06  5.28e-04     5s
  51  -9.36304364e+03 -9.28165683e+03  1.91e-04 5.88e-06  3.72e-04     5s
  52  -9.34939993e+03 -9.29010629e+03  1.47e-04 3.95e-06  2.71e-04     5s
  53  -9.34197320e+03 -9.29150886e+03  1.23e-04 3.46e-06  2.31e-04     5s
  54  -9.32467111e+03 -9.29681427e+03  6.88e-05 1.52e-06  1.27e-04     5s
  55  -9.31652581e+03 -9.29854418e+03  4.38e-05 2.65e-06  8.22e-05     5s
  56  -9.31366502e+03 -9.29883759e+03  3.54e-05 2.36e-06  6.78e-05     5s
  57  -9.30736572e+03 -9.29911342e+03  1.67e-05 2.12e-06  3.77e-05     6s
  58  -9.30310887e+03 -9.30021575e+03  3.82e-06 1.12e-06  1.32e-05     6s
  59  -9.30215165e+03 -9.30109857e+03  1.47e-06 2.70e-07  4.81e-06     6s
  60  -9.30163897e+03 -9.30130851e+03  3.65e-07 9.41e-08  1.51e-06     6s
  61  -9.30153697e+03 -9.30142092e+03  1.86e-07 4.50e-09  5.30e-07     6s
  62  -9.30147695e+03 -9.30142825e+03  2.44e-06 1.02e-06  2.22e-07     6s
  63  -9.30146908e+03 -9.30142875e+03  2.00e-06 7.77e-07  1.84e-07     6s
  64  -9.30146119e+03 -9.30142970e+03  1.96e-06 4.30e-07  1.43e-07     6s
  65  -9.30145708e+03 -9.30142972e+03  1.87e-06 4.23e-07  1.24e-07     6s
  66  -9.30144547e+03 -9.30143026e+03  1.11e-06 2.80e-07  6.92e-08     6s
  67  -9.30143863e+03 -9.30143058e+03  8.75e-07 1.87e-07  3.58e-08     6s
  68  -9.30143849e+03 -9.30143072e+03  1.17e-06 1.53e-07  3.46e-08     6s
  69  -9.30143654e+03 -9.30143096e+03  6.12e-06 9.50e-08  2.42e-08     6s
  70  -9.30143405e+03 -9.30143113e+03  7.90e-06 5.40e-08  1.21e-08     6s
  71  -9.30143284e+03 -9.30143126e+03  4.22e-06 1.62e-08  6.57e-09     6s
  72  -9.30143216e+03 -9.30143128e+03  3.58e-06 4.97e-08  3.53e-09     6s
  73  -9.30143197e+03 -9.30143128e+03  3.28e-06 4.50e-08  2.79e-09     6s
  74  -9.30143188e+03 -9.30143128e+03  2.94e-06 4.23e-08  2.48e-09     6s
  75  -9.30143168e+03 -9.30143131e+03  2.00e-06 3.65e-08  1.54e-09     6s
  76  -9.30143161e+03 -9.30143131e+03  4.93e-06 3.52e-08  1.13e-09     6s
  77  -9.30143158e+03 -9.30143131e+03  4.30e-06 4.41e-08  7.86e-10     7s
  78  -9.30143138e+03 -9.30143131e+03  1.55e-06 2.96e-08  2.58e-10     7s

Barrier solved model in 78 iterations and 6.60 seconds (17.03 work units)
Optimal objective -9.30143138e+03


Root crossover log...

   97560 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

   10357 PPushes remaining with PInf 1.3993762e-04                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3689393e+03      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   64340   -9.3014314e+03   0.000000e+00   1.368939e+03     10s
   64535   -9.3014313e+03   0.000000e+00   0.000000e+00     10s
   64535   -9.3014313e+03   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 3.26s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -9.301431e+03, 64535 iterations, 10.98 seconds (22.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -9301.4313    0  431 -205910.05 -9301.4313  95.5%     -   13s
H    0     0                    -87897.31943 -9301.4313  89.4%     -   14s
H    0     0                    -68751.19382 -9301.4313  86.5%     -   14s
H    0     0                    -64341.82109 -9301.4313  85.5%     -   14s
H    0     0                    -59306.86994 -9301.4313  84.3%     -   14s
H    0     0                    -59269.03751 -9301.4313  84.3%     -   14s
H    0     0                    -25804.01883 -9301.4313  64.0%     -   14s
H    0     0                    -24674.44475 -9301.4313  62.3%     -   14s
H    0     0                    -24644.74378 -9301.4313  62.3%     -   14s
H    0     0                    -24621.45389 -9301.4313  62.2%     -   14s
H    0     0                    -24599.11991 -9301.4313  62.2%     -   14s
H    0     0                    -24567.56662 -9301.4313  62.1%     -   14s
H    0     0                    -24542.53637 -9301.4313  62.1%     -   14s
H    0     0                    -24532.39156 -9301.4313  62.1%     -   14s
H    0     0                    -24496.54387 -9301.4313  62.0%     -   17s
H    0     0                    -24491.98352 -9301.4313  62.0%     -   17s
H    0     0                    -24484.42645 -9301.4313  62.0%     -   17s
H    0     0                    -24452.71893 -13108.216  46.4%     -   55s
H    0     0                    -24441.13820 -13108.216  46.4%     -   55s
     0     0 -13108.216    0  456 -24441.138 -13108.216  46.4%     -   55s
     0     0 -13289.365    0  548 -24441.138 -13289.365  45.6%     -   66s
     0     0 -13383.192    0  545 -24441.138 -13383.192  45.2%     -   70s
     0     0 -13462.140    0  544 -24441.138 -13462.140  44.9%     -   81s
     0     0 -13463.371    0  549 -24441.138 -13463.371  44.9%     -   86s
     0     0 -13463.371    0  549 -24441.138 -13463.371  44.9%     -   86s
     0     0 -16290.021    0  621 -24441.138 -16290.021  33.3%     -  124s
H    0     0                    -24409.89668 -16294.202  33.2%     -  124s
H    0     0                    -24401.86266 -16294.202  33.2%     -  124s
     0     0 -16460.399    0  622 -24401.863 -16460.399  32.5%     -  131s
     0     0 -16516.955    0  695 -24401.863 -16516.955  32.3%     -  133s
     0     0 -16572.244    0  703 -24401.863 -16572.244  32.1%     -  135s
     0     0 -16596.320    0  633 -24401.863 -16596.320  32.0%     -  138s
     0     0 -16607.490    0  625 -24401.863 -16607.490  31.9%     -  140s
     0     0 -16607.490    0  625 -24401.863 -16607.490  31.9%     -  141s
H    0     0                    -24351.68986 -18104.679  25.7%     -  166s
H    0     0                    -24243.95606 -18104.679  25.3%     -  166s
H    0     0                    -24233.59052 -18104.679  25.3%     -  166s
     0     0 -18104.679    0  721 -24233.591 -18104.679  25.3%     -  166s
H    0     0                    -24206.90993 -18336.411  24.3%     -  179s
H    0     0                    -24203.81495 -18336.411  24.2%     -  179s
H    0     0                    -24202.29649 -18336.411  24.2%     -  179s
H    0     0                    -24196.37197 -18336.411  24.2%     -  179s
     0     0 -18336.411    0  795 -24196.372 -18336.411  24.2%     -  180s
H    0     0                    -24195.59851 -18374.009  24.1%     -  184s
     0     0 -18374.009    0  801 -24195.599 -18374.009  24.1%     -  184s
H    0     0                    -24193.96064 -18466.152  23.7%     -  191s
H    0     0                    -24182.94573 -18466.152  23.6%     -  191s
H    0     0                    -24168.81075 -18466.152  23.6%     -  191s
H    0     0                    -24157.79583 -18466.152  23.6%     -  191s
     0     0 -18466.152    0  797 -24157.796 -18466.152  23.6%     -  191s
     0     0 -18496.211    0  802 -24157.796 -18496.211  23.4%     -  195s
     0     0 -18507.909    0  801 -24157.796 -18507.909  23.4%     -  197s
     0     0 -18555.357    0  800 -24157.796 -18555.357  23.2%     -  199s
     0     0 -18680.517    0  810 -24157.796 -18680.517  22.7%     -  204s
     0     0 -18703.958    0  808 -24157.796 -18703.958  22.6%     -  206s
     0     0 -18750.374    0  803 -24157.796 -18750.374  22.4%     -  210s
     0     0 -18751.811    0  803 -24157.796 -18751.811  22.4%     -  211s
     0     0 -18751.901    0  802 -24157.796 -18751.901  22.4%     -  212s
H    0     0                    -24151.34651 -19381.864  19.7%     -  234s
     0     0 -19381.864    0  687 -24151.347 -19381.864  19.7%     -  234s
     0     0 -19552.785    0  802 -24151.347 -19552.785  19.0%     -  243s
     0     0 -19570.547    0  741 -24151.347 -19570.547  19.0%     -  246s
     0     0 -19581.989    0  740 -24151.347 -19581.989  18.9%     -  249s
     0     0 -19582.818    0  652 -24151.347 -19582.818  18.9%     -  250s
     0     0 -19815.958    0  744 -24151.347 -19815.958  18.0%     -  262s
     0     0 -19852.948    0  676 -24151.347 -19852.948  17.8%     -  267s
     0     0 -19866.275    0  683 -24151.347 -19866.275  17.7%     -  271s
     0     0 -19896.116    0  682 -24151.347 -19896.116  17.6%     -  274s
     0     0 -19898.406    0  683 -24151.347 -19898.406  17.6%     -  276s
     0     0 -19898.655    0  685 -24151.347 -19898.655  17.6%     -  277s
     0     0 -19982.705    0  771 -24151.347 -19982.705  17.3%     -  287s
     0     0 -20003.751    0  686 -24151.347 -20003.751  17.2%     -  292s
     0     0 -20028.076    0  766 -24151.347 -20028.076  17.1%     -  298s
     0     0 -20037.219    0  787 -24151.347 -20037.219  17.0%     -  300s
     0     0 -20045.842    0  780 -24151.347 -20045.842  17.0%     -  304s
     0     0 -20060.839    0  852 -24151.347 -20060.839  16.9%     -  308s
     0     0 -20077.269    0  772 -24151.347 -20077.269  16.9%     -  311s
     0     0 -20078.002    0  771 -24151.347 -20078.002  16.9%     -  312s
     0     0 -20186.014    0  702 -24151.347 -20186.014  16.4%     -  322s
H    0     0                    -24151.23250 -20186.253  16.4%     -  323s
     0     0 -20208.135    0  707 -24151.232 -20208.135  16.3%     -  327s
     0     0 -20213.928    0  710 -24151.232 -20213.928  16.3%     -  329s
     0     0 -20216.447    0  712 -24151.232 -20216.447  16.3%     -  330s
     0     0 -20219.397    0  743 -24151.232 -20219.397  16.3%     -  332s
     0     0 -20219.637    0  737 -24151.232 -20219.637  16.3%     -  333s
     0     0 -20257.274    0  562 -24151.232 -20257.274  16.1%     -  340s
     0     0 -20276.054    0  730 -24151.232 -20276.054  16.0%     -  345s
     0     0 -20278.524    0  736 -24151.232 -20278.524  16.0%     -  346s
     0     0 -20278.937    0  742 -24151.232 -20278.937  16.0%     -  347s
     0     0 -20278.937    0  742 -24151.232 -20278.937  16.0%     -  348s
     0     0 -20304.006    0  743 -24151.232 -20304.006  15.9%     -  354s
     0     0 -20308.467    0  665 -24151.232 -20308.467  15.9%     -  358s
     0     0 -20311.047    0  736 -24151.232 -20311.047  15.9%     -  359s
     0     0 -20311.974    0  740 -24151.232 -20311.974  15.9%     -  360s
     0     0 -20321.971    0  587 -24151.232 -20321.971  15.9%     -  384s
     0     0 -20325.429    0  574 -24151.232 -20325.429  15.8%     -  386s
     0     0 -20326.694    0  579 -24151.232 -20326.694  15.8%     -  396s
     0     0 -20343.242    0  658 -24151.232 -20343.242  15.8%     -  402s
     0     0 -20345.888    0  655 -24151.232 -20345.888  15.8%     -  404s
     0     0 -20347.485    0  582 -24151.232 -20347.485  15.7%     -  405s
     0     0 -20347.662    0  667 -24151.232 -20347.662  15.7%     -  406s
     0     0 -20355.000    0  587 -24151.232 -20355.000  15.7%     -  410s
     0     0 -20357.383    0  590 -24151.232 -20357.383  15.7%     -  416s
     0     0 -20357.607    0  595 -24151.232 -20357.607  15.7%     -  417s
     0     0 -20359.900    0  651 -24151.232 -20359.900  15.7%     -  420s
     0     0 -20360.312    0  672 -24151.232 -20360.312  15.7%     -  422s
     0     0 -20361.529    0  813 -24151.232 -20361.529  15.7%     -  425s
     0     0 -20362.363    0  675 -24151.232 -20362.363  15.7%     -  428s
     0     0 -20364.959    0  831 -24151.232 -20364.959  15.7%     -  432s
     0     0 -20365.435    0  831 -24151.232 -20365.435  15.7%     -  439s
     0     2 -20365.435    0  831 -24151.232 -20365.435  15.7%     -  483s
     1     3 -22294.317    1  367 -24151.232 -20365.435  15.7% 27350  494s
     2     6 -22766.418    2   87 -24151.232 -20365.435  15.7% 15548  499s
     5    12 -23198.642    3   72 -24151.232 -20421.485  15.4%  8372  506s
    11    24 -23627.428    4   78 -24151.232 -20500.804  15.1%  7509  518s
    23    32 -23638.284    5   78 -24151.232 -20617.335  14.6% 10161  548s
    39    46 -23722.428    6   85 -24151.232 -20617.335  14.6%  9368  667s
H   54    45                    -24133.31652 -20617.335  14.6%  7386  667s
    71    82 infeasible    7      -24133.317 -20652.288  14.4% 12449  699s
   152   102 -22785.166    7  150 -24133.317 -20698.721  14.2%  8824  712s
   242   104 -22934.444    8  131 -24133.317 -20698.721  14.2%  6937  727s
   331    92 -23242.075    9  142 -24133.317 -20698.721  14.2%  6351  742s
   410    67 infeasible    8      -24133.317 -20698.721  14.2%  6098  756s
   473    55 infeasible   11      -24133.317 -20698.721  14.2%  5980  768s
   532    64 -22139.693   12  619 -24133.317 -20698.721  14.2%  5879  779s
   598    37 -22201.826   13  672 -24133.317 -20698.721  14.2%  5497  791s
   669    34 infeasible   14      -24133.317 -20698.721  14.2%  5165  800s
   698    49 -22254.862   13  633 -24133.317 -20698.721  14.2%  5121  814s
   731    68 -22421.293   15  558 -24133.317 -20806.147  13.8%  5219  826s
   768   129 -22616.133   16  528 -24133.317 -20806.147  13.8%  5416  838s
   829   194 -22940.058   18  515 -24133.317 -20806.147  13.8%  5405  848s
   906   267 -22942.675   19  517 -24133.317 -20806.147  13.8%  5204  858s
  1002   288 -23192.724   22  137 -24133.317 -20806.147  13.8%  4989  872s
  1040   314 -23286.785   23  137 -24133.317 -20806.147  13.8%  4929  885s
  1084   346 -23297.892   24  137 -24133.317 -20806.147  13.8%  4844  895s
  1127   377 -23328.234   25  133 -24133.317 -20806.147  13.8%  4743  902s
  1183   419 -23362.475   26  133 -24133.317 -20806.147  13.8%  4633  913s
  1268   439 -23480.773   27  121 -24133.317 -21840.355  9.50%  4439  926s
  1311   501 -23851.581   28  122 -24133.317 -21960.272  9.00%  4366  937s
  1419   509 -23900.121   30   98 -24133.317 -21960.272  9.00%  4125  952s
  1539   522 -22858.215   15  614 -24133.317 -21961.242  9.00%  4020  965s
  1632   528 -23001.340   18  659 -24133.317 -21961.242  9.00%  4023  979s
  1714   541 -23570.523   20  540 -24133.317 -21961.242  9.00%  4069  992s
  1787   545 -24077.042   22  522 -24133.317 -21961.242  9.00%  4114 1009s
  1869   544 infeasible   24      -24133.317 -22543.588  6.59%  4189 1026s
  1941   533 -23123.971   18  588 -24133.317 -22543.588  6.59%  4266 1043s
  2003   526 -23618.731   19  570 -24133.317 -22543.588  6.59%  4301 1059s
  2088   527 -23721.280   20  492 -24133.317 -22543.588  6.59%  4377 1073s
  2192   499 -24035.185   23  429 -24133.317 -22543.588  6.59%  4411 1090s
  2309   489 -23785.004   21  432 -24133.317 -22543.588  6.59%  4462 1109s
  2414   465 infeasible   23      -24133.317 -22543.588  6.59%  4516 1126s
  2534   435 -23921.643   20  500 -24133.317 -22543.588  6.59%  4572 1146s
  2669   371 infeasible   21      -24133.317 -22956.162  4.88%  4595 1164s
  2829   293 infeasible    9      -24133.317 -23073.885  4.39%  4600 1181s
  3011   185 -23791.520   16  625 -24133.317 -23222.196  3.78%  4555 1196s
  3215    87 infeasible   17      -24133.317 -23222.196  3.78%  4480 1213s
  3435    30 -23922.380   21  477 -24133.317 -23404.941  3.02%  4367 1223s
  3512    15 -24056.492   22  352 -24133.317 -23643.179  2.03%  4317 1231s
  3575     0 infeasible   23      -24133.317 -23945.963  0.78%  4249 1235s

Cutting planes:
  Learned: 1
  Implied bound: 189
  MIR: 2444
  Flow cover: 3467
  Zero half: 9
  RLT: 98
  Relax-and-lift: 493
  PSD: 1

Explored 3616 nodes (15706472 simplex iterations) in 1235.60 seconds (2992.26 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24133.3 -24151.2 -24151.3 ... -24202.3
No other solutions better than -24133.3

Optimal solution found (tolerance 1.00e-06)
Best objective -2.413331651612e+04, best bound -2.413331651612e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1235.66s
  Master Objective (UB) = -24133.32, θ = 87342.34
  Upper Bound (UB) = -24133.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87342.34
  [DEBUG]   ✓ Scenario 0: θ = 87342.34 ≤ Q = 87342.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87342.34 ≤ Q = 87342.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87342.34 ≤ Q = 87342.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 87342.34 ≤ Q = 87342.34 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4b683428
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4b683428
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6674731.3337
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.087848e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108784.78    0  122 6674731.33 -108784.78   102%     -    0s
H    0     0                    -78933.93642 -108784.78  37.8%     -    0s
H    0     0                    -79359.94696 -108784.78  37.1%     -    0s
     0     0 -83398.924    0  126 -79359.947 -83398.924  5.09%     -    0s
H    0     0                    -80621.50134 -83302.795  3.33%     -    0s
     0     0 -82965.755    0  128 -80621.501 -82965.755  2.91%     -    0s
H    0     0                    -80919.26281 -82919.300  2.47%     -    0s
     0     0 -82765.369    0  132 -80919.263 -82765.369  2.28%     -    0s
     0     0 -82734.439    0  132 -80919.263 -82734.439  2.24%     -    0s
     0     0 -82615.997    0  132 -80919.263 -82615.997  2.10%     -    0s
     0     2 -82611.957    0  132 -80919.263 -82611.957  2.09%     -    0s
H   41    50                    -80934.68020 -82128.689  1.48%  13.4    0s
H   52    47                    -81256.89600 -81998.863  0.91%  14.7    0s

Cutting planes:
  Gomory: 26
  Implied bound: 6
  MIR: 239

Explored 608 nodes (4705 simplex iterations) in 0.13 seconds (0.08 work units)
Thread count was 32 (of 256 available processors)

Solution count 8: -81256.9 -80934.7 -80919.3 ... 1.42347e+13
No other solutions better than -81256.9

Optimal solution found (tolerance 1.00e-06)
Best objective -8.125689600280e+04, best bound -8.125689600280e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 87004.70
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81256.90
  [DEBUG]   S×d_nominal = 168261.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168261.60 + -81256.90 = 87004.70
  [DEBUG]   Current θ from Master = 87342.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 337.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24470.95
  Lower Bound (LB) = -24470.95
  Gap (UB-LB) = 337.6332, Absolute Gap = 337.6332, Relative Gap = 0.013990
  Not converged yet (gap = 337.63 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740038 nonzeros
Model fingerprint: 0x8570e2aa
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 133926 rows and 54366 columns
Presolve time: 1.82s
Presolved: 127387 rows, 53974 columns, 787293 nonzeros
Variable types: 51715 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402295.8488
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 527
 AA' NZ     : 7.337e+06
 Factor NZ  : 1.591e+07 (roughly 200 MB of memory)
 Factor Ops : 3.639e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.22568288e+07  2.29464585e+08  2.53e+05 2.69e+01  9.73e+04     3s
   1  -2.78812442e+07  2.18643637e+08  2.11e+05 5.14e+01  8.04e+04     3s
   2  -1.14283751e+07  1.44830025e+08  8.01e+04 7.57e+00  3.22e+04     3s
   3  -9.35609779e+06  1.33813349e+08  6.52e+04 5.34e+00  2.62e+04     3s
   4  -2.36464865e+06  1.22992731e+08  1.16e+04 3.88e+00  5.19e+03     4s
   5  -9.27809353e+05  6.11211334e+07  1.77e+03 4.95e-01  9.18e+02     4s
   6  -7.46080775e+05  4.97995708e+07  6.16e+02 3.83e-01  4.36e+02     4s
   7  -6.88035313e+05  3.06363216e+07  5.08e+02 1.10e-01  3.00e+02     4s
   8  -5.51909657e+05  1.81068145e+07  9.18e+01 6.01e-02  1.07e+02     4s
   9  -4.75130968e+05  1.33321699e+07  5.53e+01 4.04e-02  7.33e+01     4s
  10  -2.94499544e+05  7.55127011e+06  1.00e+01 1.87e-02  3.56e+01     4s
  11  -1.69510681e+05  2.97958758e+06  4.32e+00 2.30e-03  1.39e+01     4s
  12  -1.24111300e+05  1.75751235e+06  2.43e+00 2.95e-03  8.23e+00     4s
  13  -1.12988186e+05  1.30830374e+06  2.01e+00 1.02e-03  6.20e+00     4s
  14  -1.04782549e+05  9.77944986e+05  1.69e+00 7.65e-04  4.71e+00     4s
  15  -7.45438192e+04  4.90315801e+05  8.94e-01 3.42e-04  2.44e+00     4s
  16  -4.79281847e+04  2.32280341e+05  3.66e-01 2.11e-04  1.21e+00     4s
  17  -3.86660418e+04  1.46437793e+05  2.58e-01 1.83e-04  7.97e-01     4s
  18  -3.38962889e+04  7.80159488e+04  2.05e-01 2.62e-04  4.82e-01     4s
  19  -3.10544289e+04  5.61011731e+04  1.77e-01 5.16e-04  3.76e-01     4s
  20  -2.85329942e+04  3.80005497e+04  1.53e-01 6.90e-04  2.87e-01     4s
  21  -2.49737475e+04  2.75681226e+04  1.19e-01 8.31e-04  2.26e-01     4s
  22  -2.26769618e+04  1.53164485e+04  9.66e-02 8.32e-04  1.64e-01     4s
  23  -2.14099379e+04  1.25977143e+04  8.54e-02 8.28e-04  1.47e-01     4s
  24  -1.98197627e+04  8.45586991e+03  7.04e-02 7.86e-04  1.22e-01     4s
  25  -1.85605522e+04  4.01655753e+03  5.97e-02 1.33e-03  9.73e-02     4s
  26  -1.76990418e+04  7.66704975e+02  5.32e-02 9.78e-04  7.96e-02     4s
  27  -1.65932240e+04  1.57443665e+02  4.51e-02 8.93e-04  7.22e-02     4s
  28  -1.58232234e+04 -1.18192521e+03  4.00e-02 9.45e-04  6.31e-02     5s
  29  -1.53427148e+04 -2.32998433e+03  3.67e-02 8.76e-04  5.61e-02     5s
  30  -1.49665295e+04 -2.46763855e+03  3.40e-02 8.47e-04  5.39e-02     5s
  31  -1.48353786e+04 -2.70322420e+03  3.29e-02 7.88e-04  5.23e-02     5s
  32  -1.45028954e+04 -3.36615396e+03  3.04e-02 7.36e-04  4.80e-02     5s
  33  -1.39750372e+04 -3.92192559e+03  2.67e-02 6.64e-04  4.33e-02     5s
  34  -1.31206191e+04 -5.21732692e+03  2.11e-02 4.74e-04  3.41e-02     5s
  35  -1.22358734e+04 -6.31430507e+03  1.59e-02 3.44e-04  2.55e-02     5s
  36  -1.15599835e+04 -7.17439046e+03  1.24e-02 2.92e-04  1.89e-02     5s
  37  -1.11558943e+04 -7.69196463e+03  1.03e-02 2.13e-04  1.49e-02     5s
  38  -1.06072468e+04 -7.99280690e+03  7.47e-03 1.56e-04  1.13e-02     5s
  39  -1.01262819e+04 -8.47384835e+03  5.11e-03 8.62e-05  7.12e-03     5s
  40  -9.86676321e+03 -8.59878053e+03  3.86e-03 6.50e-05  5.47e-03     5s
  41  -9.77578026e+03 -8.63591745e+03  3.44e-03 5.94e-05  4.91e-03     5s
  42  -9.64599765e+03 -8.75254837e+03  2.83e-03 4.06e-05  3.85e-03     5s
  43  -9.44428749e+03 -8.84296397e+03  1.92e-03 3.77e-05  2.59e-03     5s
  44  -9.42252330e+03 -8.89988551e+03  1.82e-03 3.60e-05  2.25e-03     5s
  45  -9.36934388e+03 -8.91998149e+03  1.57e-03 2.72e-05  1.94e-03     5s
  46  -9.28307863e+03 -8.92503111e+03  1.17e-03 2.58e-05  1.54e-03     6s
  47  -9.22378594e+03 -8.95233978e+03  9.06e-04 1.93e-05  1.17e-03     6s
  48  -9.17458482e+03 -8.96703906e+03  6.65e-04 1.52e-05  8.95e-04     6s
  49  -9.13512960e+03 -8.98505041e+03  4.70e-04 1.29e-05  6.47e-04     6s
  50  -9.11853975e+03 -8.99031811e+03  3.86e-04 1.15e-05  5.53e-04     6s
  51  -9.09957812e+03 -8.99569570e+03  2.98e-04 9.97e-06  4.48e-04     6s
  52  -9.09147830e+03 -9.00091696e+03  2.61e-04 8.44e-06  3.90e-04     6s
  53  -9.08600657e+03 -9.00741315e+03  2.34e-04 6.65e-06  3.39e-04     6s
  54  -9.07675210e+03 -9.00833548e+03  1.94e-04 6.35e-06  2.95e-04     6s
  55  -9.05779805e+03 -9.01848449e+03  1.16e-04 3.00e-06  1.69e-04     6s
  56  -9.05525687e+03 -9.02115681e+03  1.05e-04 2.35e-06  1.47e-04     6s
  57  -9.04891689e+03 -9.02234165e+03  7.40e-05 2.10e-06  1.15e-04     6s
  58  -9.04531496e+03 -9.02454730e+03  5.78e-05 1.59e-06  8.95e-05     6s
  59  -9.03835399e+03 -9.02692572e+03  2.69e-05 1.04e-06  4.92e-05     6s
  60  -9.03703011e+03 -9.02948789e+03  2.14e-05 4.41e-07  3.25e-05     6s
  61  -9.03422049e+03 -9.02966310e+03  1.03e-05 4.04e-07  1.96e-05     6s
  62  -9.03349661e+03 -9.02980909e+03  7.45e-06 3.70e-07  1.59e-05     7s
  63  -9.03263507e+03 -9.03012029e+03  4.19e-06 3.01e-07  1.08e-05     7s
  64  -9.03177214e+03 -9.03108307e+03  9.98e-07 1.27e-07  2.97e-06     7s
  65  -9.03164544e+03 -9.03123471e+03  5.78e-07 3.50e-07  1.77e-06     7s
  66  -9.03153519e+03 -9.03134325e+03  2.89e-07 1.43e-07  8.26e-07     7s
  67  -9.03148471e+03 -9.03139908e+03  2.19e-07 3.72e-08  3.69e-07     7s
  68  -9.03143372e+03 -9.03141726e+03  7.78e-07 3.31e-08  7.08e-08     7s
  69  -9.03142663e+03 -9.03141931e+03  3.82e-07 1.03e-08  3.14e-08     7s
  70  -9.03142077e+03 -9.03141988e+03  6.16e-08 3.64e-09  3.81e-09     7s
  71  -9.03142012e+03 -9.03142002e+03  5.28e-07 2.70e-07  4.04e-10     7s
  72  -9.03142006e+03 -9.03142002e+03  2.84e-07 2.39e-07  1.57e-10     7s

Barrier solved model in 72 iterations and 7.09 seconds (17.21 work units)
Optimal objective -9.03142006e+03


Root crossover log...

  110462 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    7877 PPushes remaining with PInf 4.9602021e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.9913524e+03     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   65654   -9.0314200e+03   0.000000e+00   7.991352e+03     10s
   66063   -9.0314200e+03   0.000000e+00   0.000000e+00     10s
   66063   -9.0314200e+03   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.44s

Solved with barrier

Root relaxation: objective -9.031420e+03, 66063 iterations, 8.53 seconds (22.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -9031.4200    0  308 -205910.05 -9031.4200  95.6%     -   11s
H    0     0                    -95560.64526 -9031.4200  90.5%     -   11s
H    0     0                    -95505.38092 -9031.4200  90.5%     -   11s
H    0     0                    -95275.07710 -9031.4200  90.5%     -   11s
H    0     0                    -61263.44970 -9031.4200  85.3%     -   11s
H    0     0                    -29170.83463 -9031.4200  69.0%     -   12s
H    0     0                    -29161.86199 -9031.4200  69.0%     -   12s
H    0     0                    -28988.33100 -9031.4200  68.8%     -   12s
H    0     0                    -28963.87483 -9031.4200  68.8%     -   12s
H    0     0                    -28957.36085 -9031.4200  68.8%     -   12s
H    0     0                    -28957.24677 -9031.4200  68.8%     -   12s
H    0     0                    -28953.40963 -9031.5186  68.8%     -   14s
H    0     0                    -28953.29555 -9031.5186  68.8%     -   14s
     0     0 -12912.422    0  447 -28953.296 -12912.422  55.4%     -   58s
     0     0 -13141.669    0  536 -28953.296 -13141.669  54.6%     -   73s
     0     0 -13207.111    0  536 -28953.296 -13207.111  54.4%     -   83s
     0     0 -13207.111    0  532 -28953.296 -13207.111  54.4%     -   86s
     0     0 -13255.221    0  534 -28953.296 -13255.221  54.2%     -   97s
     0     0 -13255.221    0  534 -28953.296 -13255.221  54.2%     -   98s
     0     0 -16195.222    0  616 -28953.296 -16195.222  44.1%     -  136s
H    0     0                    -24551.23320 -16196.540  34.0%     -  136s
H    0     0                    -24497.04529 -16196.540  33.9%     -  136s
H    0     0                    -24496.10760 -16196.540  33.9%     -  136s
H    0     0                    -24475.64777 -16196.540  33.8%     -  136s
H    0     0                    -24473.93238 -16196.540  33.8%     -  136s
     0     0 -16342.431    0  610 -24473.932 -16342.431  33.2%     -  144s
     0     0 -16374.772    0  604 -24473.932 -16374.772  33.1%     -  147s
     0     0 -16466.938    0  610 -24473.932 -16466.938  32.7%     -  153s
     0     0 -16480.119    0  621 -24473.932 -16480.119  32.7%     -  159s
     0     0 -16538.086    0  621 -24473.932 -16538.086  32.4%     -  166s
     0     0 -16538.176    0  622 -24473.932 -16538.176  32.4%     -  167s
H    0     0                    -24443.45355 -18039.966  26.2%     -  210s
H    0     0                    -24435.41953 -18039.966  26.2%     -  210s
     0     0 -18039.966    0  726 -24435.420 -18039.966  26.2%     -  210s
H    0     0                    -24409.05864 -18039.987  26.1%     -  211s
H    0     0                    -24391.96815 -18039.987  26.0%     -  211s
H    0     0                    -24309.26522 -18039.987  25.8%     -  211s
H    0     0                    -24273.65154 -18039.987  25.7%     -  211s
H    0     0                    -24263.42336 -18039.987  25.6%     -  211s
H    0     0                    -24254.70731 -18039.987  25.6%     -  211s
H    0     0                    -24229.90582 -18565.351  23.4%     -  234s
H    0     0                    -24221.87180 -18565.351  23.4%     -  234s
     0     0 -18565.351    0  720 -24221.872 -18565.351  23.4%     -  234s
     0     0 -18733.838    0  776 -24221.872 -18733.838  22.7%     -  241s
     0     0 -18767.063    0  791 -24221.872 -18767.063  22.5%     -  244s
H    0     0                    -24215.82200 -18785.249  22.4%     -  246s
H    0     0                    -24196.94376 -18785.249  22.4%     -  246s
     0     0 -18785.249    0  787 -24196.944 -18785.249  22.4%     -  246s
     0     0 -18788.151    0  787 -24196.944 -18788.151  22.4%     -  247s
     0     0 -18805.882    0  811 -24196.944 -18805.882  22.3%     -  250s
     0     0 -18806.281    0  803 -24196.944 -18806.281  22.3%     -  250s
H    0     0                    -24191.91381 -19430.695  19.7%     -  272s
H    0     0                    -24183.87980 -19430.695  19.7%     -  272s
H    0     0                    -24174.20455 -19430.695  19.6%     -  272s
     0     0 -19430.695    0  748 -24174.205 -19430.695  19.6%     -  272s
     0     0 -19529.127    0  761 -24174.205 -19529.127  19.2%     -  279s
     0     0 -19638.468    0  759 -24174.205 -19638.468  18.8%     -  285s
     0     0 -19651.894    0  759 -24174.205 -19651.894  18.7%     -  289s
     0     0 -19661.689    0  759 -24174.205 -19661.689  18.7%     -  292s
     0     0 -19682.795    0  771 -24174.205 -19682.795  18.6%     -  295s
H    0     0                    -24161.41324 -19683.068  18.5%     -  296s
     0     0 -19683.068    0  782 -24161.413 -19683.068  18.5%     -  296s
H    0     0                    -24157.94237 -19874.337  17.7%     -  315s
     0     0 -19874.337    0  911 -24157.942 -19874.337  17.7%     -  315s
     0     0 -19931.007    0  844 -24157.942 -19931.007  17.5%     -  325s
     0     0 -19976.045    0  770 -24157.942 -19976.045  17.3%     -  333s
     0     0 -19999.926    0  784 -24157.942 -19999.926  17.2%     -  339s
     0     0 -20005.362    0  789 -24157.942 -20005.362  17.2%     -  341s
     0     0 -20006.465    0  788 -24157.942 -20006.465  17.2%     -  342s
     0     0 -20062.726    0  787 -24157.942 -20062.726  17.0%     -  353s
     0     0 -20087.303    0  699 -24157.942 -20087.303  16.9%     -  360s
     0     0 -20106.869    0  705 -24157.942 -20106.869  16.8%     -  365s
     0     0 -20118.215    0  709 -24157.942 -20118.215  16.7%     -  368s
     0     0 -20121.035    0  705 -24157.942 -20121.035  16.7%     -  370s
     0     0 -20124.460    0  633 -24157.942 -20124.460  16.7%     -  372s
     0     0 -20125.458    0  639 -24157.942 -20125.458  16.7%     -  373s
     0     0 -20204.591    0  934 -24157.942 -20204.591  16.4%     -  385s
     0     0 -20225.471    0  773 -24157.942 -20225.471  16.3%     -  389s
     0     0 -20238.869    0  578 -24157.942 -20238.869  16.2%     -  393s
     0     0 -20241.387    0  883 -24157.942 -20241.387  16.2%     -  395s
     0     0 -20248.280    0  805 -24157.942 -20248.280  16.2%     -  397s
     0     0 -20255.799    0  744 -24157.942 -20255.799  16.2%     -  400s
     0     0 -20256.224    0  822 -24157.942 -20256.224  16.2%     -  400s
     0     0 -20295.046    0  730 -24157.942 -20295.046  16.0%     -  409s
H    0     0                    -24156.08236 -20295.913  16.0%     -  411s
     0     0 -20304.246    0  882 -24156.082 -20304.246  15.9%     -  415s
     0     0 -20306.665    0  811 -24156.082 -20306.665  15.9%     -  417s
     0     0 -20307.626    0  811 -24156.082 -20307.626  15.9%     -  418s
     0     0 -20331.366    0  741 -24156.082 -20331.366  15.8%     -  425s
     0     0 -20337.794    0  675 -24156.082 -20337.794  15.8%     -  428s
     0     0 -20339.130    0  678 -24156.082 -20339.130  15.8%     -  429s
     0     0 -20349.335    0  750 -24156.082 -20349.335  15.8%     -  435s
     0     0 -20349.963    0  749 -24156.082 -20349.963  15.8%     -  438s
     0     0 -20356.714    0  820 -24156.082 -20356.714  15.7%     -  442s
     0     0 -20357.912    0  820 -24156.082 -20357.912  15.7%     -  444s
     0     0 -20371.547    0  748 -24156.082 -20371.547  15.7%     -  450s
     0     0 -20373.168    0  686 -24156.082 -20373.168  15.7%     -  453s
     0     0 -20378.534    0  672 -24156.082 -20378.534  15.6%     -  458s
     0     0 -20379.935    0  670 -24156.082 -20379.935  15.6%     -  459s
     0     0 -20382.115    0  731 -24156.082 -20382.115  15.6%     -  463s
     0     0 -20382.422    0  731 -24156.082 -20382.422  15.6%     -  470s
H    0     0                    -24136.37736 -20382.903  15.6%     -  600s
     0     2 -20382.903    0  731 -24136.377 -20382.903  15.6%     -  612s
     1     3 -21896.650    1  300 -24136.377 -20382.903  15.6% 28179  624s
     2     5 -22028.295    2  288 -24136.377 -20382.903  15.6% 16338  633s
     4     9 -22532.302    3  374 -24136.377 -20532.897  14.9% 13246  643s
     8    16 -20919.457    3  427 -24136.377 -20538.566  14.9% 13747  652s
    17    23 -21320.891    4  446 -24136.377 -20669.457  14.4%  9782  671s
    24    41 -21797.365    5  526 -24136.377 -20669.457  14.4%  8212  763s
    45    65 -21807.791    6  609 -24136.377 -20669.457  14.4% 12613  786s
    76    70 -21953.052    7  606 -24136.377 -20669.457  14.4% 11512  809s
   155    71 -22536.416    9  112 -24136.377 -20669.457  14.4%  8028  828s
   204    54 -23470.849   10   90 -24136.377 -20669.457  14.4%  7865  856s
   278    50 -21236.315    6  753 -24136.377 -20669.457  14.4%  7070  879s
   319    51 -21272.400    7  747 -24136.377 -20669.457  14.4%  6989  895s
   364    61 -21492.745    8  652 -24136.377 -20669.457  14.4%  6760  908s
   414    61 -23405.054    9   90 -24136.377 -20669.457  14.4%  6669  922s
   490    34 infeasible   10      -24136.377 -20669.457  14.4%  6479  934s
   549    33 -22255.727   11  631 -24136.377 -20669.457  14.4%  6167  948s
   595    33 -22740.130   12  569 -24136.377 -20669.457  14.4%  6024  958s
   637    31 -22916.525   13  474 -24136.377 -20669.457  14.4%  5886  970s
   668    28 -22929.822   14  473 -24136.377 -20669.457  14.4%  5833  983s
   706    29 -22987.247   15  563 -24136.377 -20669.457  14.4%  5716  996s
   735    52 -23007.796   16  563 -24136.377 -20669.457  14.4%  5694 1008s
   771    93 -23245.093   17  556 -24136.377 -20788.410  13.9%  5739 1020s
   839   111 -23478.792   18  397 -24136.377 -20788.410  13.9%  5585 1031s
   927   114     cutoff   19      -24136.377 -20789.468  13.9%  5344 1043s
   976   114 -23859.835   19  298 -24136.377 -20789.468  13.9%  5325 1054s
  1027    94     cutoff   20      -24136.377 -20789.468  13.9%  5275 1069s
  1093    72 infeasible   20      -24136.377 -20789.468  13.9%  5145 1082s
  1171    48 -24023.239   23  361 -24136.377 -20789.468  13.9%  5028 1097s
  1259    34 infeasible   22      -24136.377 -20789.468  13.9%  4823 1109s
  1325    23 -22609.026   10  756 -24136.377 -20789.468  13.9%  4681 1124s
  1386    14 -22984.024   11  725 -24136.377 -20789.468  13.9%  4542 1136s
* 1413    14              27    -24134.89867 -22515.781  6.71%  4516 1136s
  1420    12 -23001.502   12  721 -24134.899 -22515.781  6.71%  4500 1147s
  1436    15 infeasible   13      -24134.899 -22642.509  6.18%  4518 1156s
  1453    21 -22854.806   14  773 -24134.899 -22763.521  5.68%  4529 1164s
  1473    28 -22880.265   15  769 -24134.899 -22854.848  5.30%  4542 1181s
  1502    26 infeasible   16      -24134.899 -22984.494  4.77%  4572 1192s
  1552     8     cutoff   19      -24134.899 -22984.614  4.77%  4547 1207s
  1582     2 -23445.850   21  711 -24134.899 -23219.826  3.79%  4520 1221s
  1591     3 -23570.786   22  704 -24134.899 -23451.242  2.83%  4507 1232s
  1594     3 infeasible   24      -24134.899 -23451.242  2.83%  4506 1239s
  1598     2 -23826.608   26  526 -24134.899 -23720.425  1.72%  4514 1254s
  1601     1 infeasible   27      -24134.899 -23826.875  1.28%  4508 1264s
  1604     0     cutoff   28      -24134.899 -24134.899  0.00%  4514 1269s

Cutting planes:
  Learned: 3
  Implied bound: 162
  MIR: 2382
  Flow cover: 3697
  Zero half: 16
  RLT: 95
  Relax-and-lift: 547

Explored 1605 nodes (7722810 simplex iterations) in 1269.35 seconds (3217.85 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24134.9 -24136.4 -24156.1 ... -24215.8
No other solutions better than -24134.9

Optimal solution found (tolerance 1.00e-06)
Best objective -2.413489866669e+04, best bound -2.413489866669e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1269.43s
  Master Objective (UB) = -24134.90, θ = 87105.27
  Upper Bound (UB) = -24134.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87105.27
  [DEBUG]   ✓ Scenario 0: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87105.27 ≤ Q = 87105.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87105.27 ≤ Q = 87105.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87105.27 ≤ Q = 87105.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 87105.27 ≤ Q = 87105.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 87105.27 ≤ Q = 87105.27 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1e901115
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe16feeeb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6686078.5879
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.087822e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108782.15    0  122 6686078.59 -108782.15   102%     -    0s
H    0     0                    -78916.60322 -108782.15  37.8%     -    0s
H    0     0                    -79342.61376 -108782.15  37.1%     -    0s
     0     0 -83476.907    0  111 -79342.614 -83476.907  5.21%     -    0s
H    0     0                    -82026.48963 -83435.553  1.72%     -    0s
     0     0 -83234.863    0   55 -82026.490 -83234.863  1.47%     -    0s
     0     0 -83057.671    0   55 -82026.490 -83057.671  1.26%     -    0s
     0     0 -82986.063    0   55 -82026.490 -82986.063  1.17%     -    0s
     0     0 -82815.480    0   58 -82026.490 -82815.480  0.96%     -    0s
     0     0 -82773.575    0   58 -82026.490 -82773.575  0.91%     -    0s
     0     0 -82731.697    0   58 -82026.490 -82731.697  0.86%     -    0s
     0     2 -82729.067    0   58 -82026.490 -82729.067  0.86%     -    0s

Cutting planes:
  Gomory: 34
  MIR: 156
  Flow cover: 3
  RLT: 3
  BQP: 1

Explored 43 nodes (751 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -82026.5 -79342.6 -78916.6 ... 1.42686e+13

Optimal solution found (tolerance 1.00e-06)
Best objective -8.202648963419e+04, best bound -8.202653154086e+04, gap 0.0001%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 85971.71
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82026.49
  [DEBUG]   S×d_nominal = 167998.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 167998.19 + -82026.49 = 85971.71
  [DEBUG]   Current θ from Master = 87105.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1133.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25268.46
  Lower Bound (LB) = -24470.95
  Gap (UB-LB) = 336.0510, Absolute Gap = 336.0510, Relative Gap = 0.013924
  Not converged yet (gap = 336.05 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783245 nonzeros
Model fingerprint: 0x22c2a057
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 141804 rows and 57564 columns
Presolve time: 4.03s
Presolved: 134799 rows, 57016 columns, 832995 nonzeros
Variable types: 54757 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402295.8488
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.46s

Barrier statistics:
 Dense cols : 527
 AA' NZ     : 8.145e+06
 Factor NZ  : 1.726e+07 (roughly 200 MB of memory)
 Factor Ops : 3.920e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.21868638e+07  2.41488664e+08  2.53e+05 2.68e+01  9.69e+04     7s
   1  -2.79087638e+07  2.29223877e+08  2.11e+05 4.78e+01  8.03e+04     7s
   2  -1.08036264e+07  1.53951239e+08  8.15e+04 8.99e+00  3.27e+04     7s
   3  -8.85298781e+06  1.41650423e+08  6.64e+04 6.33e+00  2.66e+04     7s
   4  -1.86341336e+06  1.27921455e+08  9.02e+03 4.11e+00  4.13e+03     7s
   5  -8.37155631e+05  6.11208620e+07  1.66e+03 5.35e-01  8.60e+02     7s
   6  -6.08554158e+05  3.23175987e+07  5.89e+02 2.27e-01  3.29e+02     8s
   7  -4.03990514e+05  2.29680061e+07  2.12e+02 1.37e-01  1.61e+02     8s
   8  -2.92331816e+05  1.49439480e+07  1.04e+02 4.02e-02  9.00e+01     8s
   9  -1.81615884e+05  1.05985057e+07  4.07e+01 1.01e-02  5.31e+01     8s
  10  -1.33623509e+05  6.82601095e+06  1.96e+01 6.11e-03  3.16e+01     8s
  11  -1.06700088e+05  2.34543213e+06  9.87e+00 1.80e-03  1.08e+01     8s
  12  -9.34465685e+04  1.40978784e+06  6.40e+00 1.06e-03  6.45e+00     8s
  13  -7.13445299e+04  6.04691912e+05  2.35e+00 4.33e-04  2.81e+00     8s
  14  -5.17326954e+04  2.64752340e+05  1.15e+00 2.15e-04  1.30e+00     8s
  15  -4.21095151e+04  1.31913006e+05  7.36e-01 1.18e-04  7.14e-01     8s
  16  -3.24678595e+04  1.00323992e+05  4.32e-01 1.40e-04  5.43e-01     8s
  17  -3.02011886e+04  7.23927413e+04  3.70e-01 2.82e-04  4.20e-01     8s
  18  -2.71944152e+04  4.71065969e+04  2.96e-01 4.87e-04  3.04e-01     8s
  19  -2.55193296e+04  3.78103949e+04  2.58e-01 5.41e-04  2.59e-01     8s
  20  -2.46948451e+04  3.36418028e+04  2.40e-01 5.77e-04  2.38e-01     8s
  21  -2.31051610e+04  2.25528435e+04  2.06e-01 6.47e-04  1.87e-01     8s
  22  -2.14661773e+04  1.47746574e+04  1.72e-01 5.64e-04  1.48e-01     8s
  23  -2.00326912e+04  7.43475323e+03  1.45e-01 1.16e-03  1.12e-01     8s
  24  -1.87247213e+04  3.58763048e+03  1.23e-01 7.82e-04  9.13e-02     8s
  25  -1.81339357e+04  2.07550844e+03  1.13e-01 8.69e-04  8.27e-02     9s
  26  -1.68695042e+04  1.02990781e+03  9.29e-02 7.98e-04  7.32e-02     9s
  27  -1.65571010e+04 -1.78960567e+03  8.82e-02 7.66e-04  6.04e-02     9s
  28  -1.59555327e+04 -2.47719596e+03  8.01e-02 6.38e-04  5.52e-02     9s
  29  -1.53032456e+04 -3.74092767e+03  7.11e-02 6.77e-04  4.73e-02     9s
  30  -1.47929993e+04 -4.85701335e+03  6.39e-02 8.84e-04  4.07e-02     9s
  31  -1.40524544e+04 -5.14842118e+03  5.36e-02 8.69e-04  3.64e-02     9s
  32  -1.31552049e+04 -6.09485103e+03  4.28e-02 8.18e-04  2.89e-02     9s
  33  -1.22356722e+04 -7.02812911e+03  3.29e-02 1.79e-03  2.13e-02     9s
  34  -1.14692243e+04 -7.31688526e+03  2.47e-02 1.50e-03  1.70e-02     9s
  35  -1.11311036e+04 -7.78183374e+03  2.13e-02 1.11e-03  1.37e-02     9s
  36  -1.10235786e+04 -7.80892056e+03  2.02e-02 1.08e-03  1.32e-02     9s
  37  -1.08499727e+04 -8.19597359e+03  1.85e-02 7.28e-04  1.09e-02     9s
  38  -1.03299357e+04 -8.37247900e+03  1.35e-02 5.55e-04  8.02e-03     9s
  39  -1.02034201e+04 -8.48494842e+03  1.22e-02 4.33e-04  7.04e-03     9s
  40  -9.83091687e+03 -8.54738619e+03  8.73e-03 3.64e-04  5.26e-03     9s
  41  -9.61739466e+03 -8.63064100e+03  6.67e-03 2.78e-04  4.04e-03     9s
  42  -9.39342241e+03 -8.72476268e+03  4.51e-03 1.80e-04  2.74e-03    10s
  43  -9.38508048e+03 -8.76220259e+03  4.43e-03 1.42e-04  2.55e-03    10s
  44  -9.24854792e+03 -8.80030097e+03  3.13e-03 1.02e-04  1.84e-03    10s
  45  -9.17626330e+03 -8.82856064e+03  2.45e-03 7.27e-05  1.42e-03    10s
  46  -9.14478671e+03 -8.84848400e+03  2.15e-03 5.42e-05  1.21e-03    10s
  47  -9.09287698e+03 -8.86419021e+03  1.66e-03 4.18e-05  9.37e-04    10s
  48  -9.07647943e+03 -8.87685513e+03  1.50e-03 3.11e-05  8.18e-04    10s
  49  -9.04258204e+03 -8.88024618e+03  1.17e-03 2.81e-05  6.65e-04    10s
  50  -9.01710813e+03 -8.89046543e+03  9.38e-04 2.12e-05  5.19e-04    10s
  51  -9.00961590e+03 -8.89093029e+03  8.73e-04 2.04e-05  4.87e-04    10s
  52  -9.00809117e+03 -8.89559554e+03  8.59e-04 1.61e-05  4.61e-04    10s
  53  -8.98610499e+03 -8.89717263e+03  6.48e-04 1.42e-05  3.65e-04    10s
  54  -8.96390798e+03 -8.90271340e+03  4.46e-04 6.89e-06  2.51e-04    10s
  55  -8.96138122e+03 -8.90459193e+03  4.24e-04 5.43e-06  2.33e-04    10s
  56  -8.95674887e+03 -8.90527756e+03  3.84e-04 4.93e-06  2.11e-04    10s
  57  -8.95423997e+03 -8.90663189e+03  3.62e-04 4.40e-06  1.95e-04    11s
  58  -8.94008285e+03 -8.90907864e+03  2.23e-04 3.52e-06  1.27e-04    11s
  59  -8.93774862e+03 -8.91060051e+03  2.02e-04 2.72e-06  1.11e-04    11s
  60  -8.93216719e+03 -8.91272296e+03  1.50e-04 3.09e-06  7.97e-05    11s
  61  -8.92741001e+03 -8.91329217e+03  1.05e-04 2.48e-06  5.79e-05    11s
  62  -8.92494015e+03 -8.91385346e+03  8.26e-05 1.81e-06  4.55e-05    11s
  63  -8.92201318e+03 -8.91464238e+03  5.53e-05 8.84e-07  3.02e-05    11s
  64  -8.91703398e+03 -8.91525567e+03  1.19e-05 1.09e-06  7.28e-06    11s
  65  -8.91573684e+03 -8.91543132e+03  1.63e-06 2.22e-07  1.25e-06    11s
  66  -8.91552217e+03 -8.91548259e+03  3.81e-07 5.76e-08  1.62e-07    11s
  67  -8.91549176e+03 -8.91548504e+03  9.80e-08 6.67e-08  2.75e-08    11s
  68  -8.91548916e+03 -8.91548751e+03  3.87e-07 1.08e-08  6.85e-09    11s
  69  -8.91548793e+03 -8.91548791e+03  9.49e-08 3.92e-10  8.93e-11    11s

Barrier solved model in 69 iterations and 11.33 seconds (18.07 work units)
Optimal objective -8.91548793e+03


Root crossover log...

  116384 DPushes remaining with DInf 0.0000000e+00                11s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    5667 PPushes remaining with PInf 1.0493499e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.2622094e+01     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66313   -8.9154879e+03   0.000000e+00   6.262209e+01     14s
   66335   -8.9154879e+03   0.000000e+00   0.000000e+00     14s
   66335   -8.9154879e+03   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.82s

Solved with barrier

Root relaxation: objective -8.915488e+03, 66335 iterations, 9.89 seconds (19.99 work units)
Total elapsed time = 15.12s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -8915.4879    0  309 -205910.05 -8915.4879  95.7%     -   15s
H    0     0                    -189013.0759 -8915.4879  95.3%     -   15s
H    0     0                    -73006.49185 -8915.4879  87.8%     -   15s
H    0     0                    -32668.93465 -8915.4879  72.7%     -   15s
H    0     0                    -32244.65582 -8915.4879  72.4%     -   15s
H    0     0                    -32165.49573 -8915.4879  72.3%     -   15s
H    0     0                    -32076.93133 -8915.4879  72.2%     -   15s
H    0     0                    -24682.72491 -8915.4879  63.9%     -   16s
H    0     0                    -24652.56720 -8915.4879  63.8%     -   16s
H    0     0                    -24610.66724 -8915.4879  63.8%     -   20s
     0     0 -13052.817    0  450 -24610.667 -13052.817  47.0%     -   60s
     0     0 -13191.132    0  460 -24610.667 -13191.132  46.4%     -   67s
     0     0 -13321.801    0  531 -24610.667 -13321.801  45.9%     -   77s
     0     0 -13350.744    0  534 -24610.667 -13350.744  45.8%     -   81s
     0     0 -13385.002    0  535 -24610.667 -13385.002  45.6%     -   83s
     0     0 -13386.461    0  536 -24610.667 -13386.461  45.6%     -   87s
     0     0 -13386.462    0  536 -24610.667 -13386.462  45.6%     -   88s
     0     0 -16076.065    0  619 -24610.667 -16076.065  34.7%     -  125s
H    0     0                    -24569.20437 -16076.480  34.6%     -  125s
     0     0 -16260.741    0  635 -24569.204 -16260.741  33.8%     -  134s
     0     0 -16315.707    0  647 -24569.204 -16315.707  33.6%     -  140s
     0     0 -16336.097    0  650 -24569.204 -16336.097  33.5%     -  147s
     0     0 -16337.651    0  646 -24569.204 -16337.651  33.5%     -  148s
     0     0 -16338.052    0  644 -24569.204 -16338.052  33.5%     -  150s
     0     0 -17859.185    0  701 -24569.204 -17859.185  27.3%     -  196s
H    0     0                    -24558.64297 -17859.925  27.3%     -  197s
     0     0 -18021.408    0  775 -24558.643 -18021.408  26.6%     -  210s
     0     0 -18079.887    0  725 -24558.643 -18079.887  26.4%     -  222s
     0     0 -18131.517    0  716 -24558.643 -18131.517  26.2%     -  237s
     0     0 -18132.512    0  723 -24558.643 -18132.512  26.2%     -  240s
     0     0 -18779.706    0  719 -24558.643 -18779.706  23.5%     -  272s
H    0     0                    -24541.58945 -18780.266  23.5%     -  272s
     0     0 -18876.842    0  772 -24541.589 -18876.842  23.1%     -  285s
     0     0 -18912.215    0  699 -24541.589 -18912.215  22.9%     -  294s
     0     0 -18925.043    0  653 -24541.589 -18925.043  22.9%     -  298s
     0     0 -19107.926    0  776 -24541.589 -19107.926  22.1%     -  311s
     0     0 -19179.367    0  700 -24541.589 -19179.367  21.8%     -  319s
     0     0 -19207.115    0  625 -24541.589 -19207.115  21.7%     -  326s
     0     0 -19210.948    0  634 -24541.589 -19210.948  21.7%     -  329s
     0     0 -19266.970    0  786 -24541.589 -19266.970  21.5%     -  336s
     0     0 -19274.546    0  724 -24541.589 -19274.546  21.5%     -  338s
     0     0 -19274.929    0  802 -24541.589 -19274.929  21.5%     -  339s
     0     0 -19487.789    0  874 -24541.589 -19487.789  20.6%     -  361s
H    0     0                    -24329.89126 -19487.913  19.9%     -  361s
H    0     0                    -24326.91281 -19487.913  19.9%     -  361s
H    0     0                    -24318.87879 -19487.913  19.9%     -  362s
H    0     0                    -24310.72825 -19487.913  19.8%     -  362s
H    0     0                    -24309.51347 -19487.913  19.8%     -  362s
H    0     0                    -24307.74980 -19487.913  19.8%     -  362s
H    0     0                    -24306.53501 -19487.913  19.8%     -  362s
     0     0 -19548.115    0  720 -24306.535 -19548.115  19.6%     -  371s
     0     0 -19603.881    0  784 -24306.535 -19603.881  19.3%     -  378s
     0     0 -19644.046    0  703 -24306.535 -19644.046  19.2%     -  385s
     0     0 -19653.353    0  706 -24306.535 -19653.353  19.1%     -  388s
     0     0 -19656.977    0  719 -24306.535 -19656.977  19.1%     -  390s
     0     0 -19659.043    0  717 -24306.535 -19659.043  19.1%     -  392s
     0     0 -19683.685    0  790 -24306.535 -19683.685  19.0%     -  397s
     0     0 -19685.907    0  799 -24306.535 -19685.907  19.0%     -  399s
     0     0 -19689.484    0  800 -24306.535 -19689.484  19.0%     -  400s
     0     0 -19725.989    0  879 -24306.535 -19725.989  18.8%     -  405s
     0     0 -19739.410    0  722 -24306.535 -19739.410  18.8%     -  408s
     0     0 -19740.713    0  803 -24306.535 -19740.713  18.8%     -  410s
     0     0 -19862.015    0  721 -24306.535 -19862.015  18.3%     -  422s
H    0     0                    -24280.49611 -19862.507  18.2%     -  424s
     0     0 -19910.546    0  653 -24280.496 -19910.546  18.0%     -  429s
     0     0 -19916.553    0  654 -24280.496 -19916.553  18.0%     -  431s
     0     0 -19920.266    0  741 -24280.496 -19920.266  18.0%     -  432s
     0     0 -19921.052    0  743 -24280.496 -19921.052  18.0%     -  432s
     0     0 -19975.259    0  740 -24280.496 -19975.259  17.7%     -  438s
     0     0 -19992.338    0  657 -24280.496 -19992.338  17.7%     -  440s
     0     0 -19995.502    0  754 -24280.496 -19995.502  17.6%     -  442s
     0     0 -20003.620    0  758 -24280.496 -20003.620  17.6%     -  443s
     0     0 -20003.620    0  758 -24280.496 -20003.620  17.6%     -  443s
     0     0 -20012.281    0  760 -24280.496 -20012.281  17.6%     -  446s
     0     0 -20013.461    0  677 -24280.496 -20013.461  17.6%     -  447s
     0     0 -20082.583    0  672 -24280.496 -20082.583  17.3%     -  456s
     0     0 -20089.540    0  679 -24280.496 -20089.540  17.3%     -  459s
     0     0 -20092.536    0  674 -24280.496 -20092.536  17.2%     -  460s
     0     0 -20094.490    0  663 -24280.496 -20094.490  17.2%     -  461s
     0     0 -20095.082    0  673 -24280.496 -20095.082  17.2%     -  462s
     0     0 -20119.963    0  670 -24280.496 -20119.963  17.1%     -  468s
     0     0 -20123.148    0  675 -24280.496 -20123.148  17.1%     -  471s
     0     0 -20127.243    0  677 -24280.496 -20127.243  17.1%     -  472s
     0     0 -20127.243    0  677 -24280.496 -20127.243  17.1%     -  473s
     0     0 -20127.645    0  680 -24280.496 -20127.645  17.1%     -  473s
     0     0 -20127.645    0  680 -24280.496 -20127.645  17.1%     -  473s
     0     0 -20158.878    0  751 -24280.496 -20158.878  17.0%     -  482s
     0     0 -20164.584    0  757 -24280.496 -20164.584  17.0%     -  486s
     0     0 -20166.723    0  666 -24280.496 -20166.723  16.9%     -  488s
     0     0 -20166.769    0  665 -24280.496 -20166.769  16.9%     -  488s
     0     0 -20199.449    0  738 -24280.496 -20199.449  16.8%     -  495s
     0     0 -20242.146    0  736 -24280.496 -20242.146  16.6%     -  502s
     0     0 -20246.772    0  739 -24280.496 -20246.772  16.6%     -  504s
     0     0 -20248.533    0  741 -24280.496 -20248.533  16.6%     -  506s
     0     0 -20248.877    0  744 -24280.496 -20248.877  16.6%     -  506s
     0     0 -20268.851    0  758 -24280.496 -20268.851  16.5%     -  514s
H    0     0                    -24278.70246 -20269.216  16.5%     -  515s
H    0     0                    -24267.57347 -20269.216  16.5%     -  515s
H    0     0                    -24264.59502 -20269.216  16.5%     -  515s
H    0     0                    -24259.53945 -20269.216  16.4%     -  515s
     0     0 -20281.386    0  755 -24259.539 -20281.386  16.4%     -  520s
     0     0 -20282.468    0  767 -24259.539 -20282.468  16.4%     -  521s
     0     0 -20298.715    0  758 -24259.539 -20298.715  16.3%     -  526s
     0     0 -20300.275    0  760 -24259.539 -20300.275  16.3%     -  528s
     0     0 -20311.610    0  765 -24259.539 -20311.610  16.3%     -  534s
H    0     0                    -24256.97212 -20311.740  16.3%     -  535s
H    0     0                    -24255.45366 -20311.740  16.3%     -  535s
     0     0 -20312.293    0  766 -24255.454 -20312.293  16.3%     -  536s
     0     0 -20318.072    0  755 -24255.454 -20318.072  16.2%     -  542s
     0     0 -20320.034    0  771 -24255.454 -20320.034  16.2%     -  544s
     0     0 -20320.264    0  776 -24255.454 -20320.264  16.2%     -  544s
     0     0 -20323.448    0  776 -24255.454 -20323.448  16.2%     -  549s
     0     0 -20323.807    0  776 -24255.454 -20323.807  16.2%     -  557s
H    0     0                    -24252.47521 -20323.948  16.2%     -  565s
H    0     0                    -24242.17219 -20323.948  16.2%     -  608s
     0     2 -20323.948    0  776 -24242.172 -20323.948  16.2%     -  615s
     1     4 -20343.549    1  854 -24242.172 -20323.948  16.2%  2855  626s
     3     8 -20451.190    2  760 -24242.172 -20344.352  16.1% 11458  639s
     7    15 -20573.967    3  819 -24242.172 -20451.821  15.6% 11143  655s
    14    30 -20616.381    4  966 -24242.172 -20574.059  15.1%  9298  670s
    29    43 -21188.905    5  641 -24242.172 -20616.686  15.0% 10140  702s
    44    65 -23361.763    6   85 -24242.172 -20616.686  15.0% 10567  815s
H   46    65                    -24184.26487 -20616.686  14.8% 10370  815s
H   62    64                    -24178.06548 -20616.686  14.7%  9362  815s
    68   142 -23375.014    7   79 -24178.065 -20616.686  14.7% 11252  845s
   182   184 -23857.214   12   62 -24178.065 -20616.686  14.7%  7494  860s
H  186   184                    -24162.06005 -20616.686  14.7%  7388  860s
H  189   184                    -24161.01196 -20616.686  14.7%  7298  860s
H  198   184                    -24145.89549 -20616.686  14.6%  7062  860s
   273   167 -23029.093   10  103 -24145.895 -20616.686  14.6%  6096  877s
   383   169 infeasible   12      -24145.895 -20616.686  14.6%  5091  890s
   479   175 infeasible   13      -24145.895 -20616.686  14.6%  4658  901s
   562   156 infeasible   11      -24145.895 -20616.686  14.6%  4493  914s
   646   152 -22148.320   10  577 -24145.895 -20616.686  14.6%  4412  926s
H  671   152                    -24136.37736 -20616.686  14.6%  4419  926s
   719   139 -22520.549   11  471 -24136.377 -20616.686  14.6%  4298  938s
   796   117 infeasible   12      -24136.377 -20616.686  14.6%  4215  948s
   860   112 -22846.130   13  542 -24136.377 -20616.686  14.6%  4199  961s
   911   110 -23086.570   14  421 -24136.377 -20616.686  14.6%  4175  972s
   958   111 -23115.407   15  358 -24136.377 -20616.686  14.6%  4234  985s
  1013   120 -23304.438   17  265 -24136.377 -20616.686  14.6%  4220  997s
  1060   146 -23339.876   18  258 -24136.377 -20616.686  14.6%  4220 1014s
  1114   174 infeasible   20      -24136.377 -20616.686  14.6%  4287 1026s
  1182   195 -23924.192   21  304 -24136.377 -20616.686  14.6%  4258 1037s
  1258   186 -23569.268   22  115 -24136.377 -20616.686  14.6%  4246 1050s
  1320   167 infeasible   23      -24136.377 -20616.686  14.6%  4260 1064s
  1397   168 infeasible   23      -24136.377 -20616.686  14.6%  4265 1078s
  1468   157 infeasible    8      -24136.377 -20616.686  14.6%  4277 1095s
  1520   154 infeasible    8      -24136.377 -20616.686  14.6%  4296 1124s
  1611   151 -23757.284   22  323 -24136.377 -20616.686  14.6%  4256 1138s
  1715   151 -24086.703   26  232 -24136.377 -20616.686  14.6%  4192 1155s
  1775   116 -24118.373   27  231 -24136.377 -20616.686  14.6%  4181 1169s
  1898    87 -24121.752   26  320 -24136.377 -20616.686  14.6%  4124 1185s
  2019    39 -23410.657    7  340 -24136.377 -20616.686  14.6%  4073 1202s
  2119    15 infeasible    9      -24136.377 -20616.686  14.6%  4036 1218s
  2187     9     cutoff    7      -24136.377 -20616.686  14.6%  4014 1231s
  2239     2 -24129.613   27   16 -24136.377 -20616.686  14.6%  3954 1242s
  2249     3 -22209.731    6  898 -24136.377 -21345.906  11.6%  3942 1264s
  2250     5 -22364.005    7  879 -24136.377 -21345.906  11.6%  3943 1275s
  2252     5 -23599.270    8  164 -24136.377 -22209.768  7.98%  3951 1285s
  2258     3 infeasible    9      -24136.377 -22500.164  6.78%  3953 1297s
  2262     9 -23423.227    9  586 -24136.377 -22500.306  6.78%  3954 1309s
  2268    11 -23618.043   10  561 -24136.377 -23340.083  3.30%  3961 1323s
  2280     7 infeasible   11      -24136.377 -23341.600  3.29%  3958 1338s
  2290     6 infeasible   12      -24136.377 -23496.398  2.65%  3970 1354s
  2295     2 infeasible   14      -24136.377 -23581.148  2.30%  3978 1361s
  2301     1 infeasible   12      -24136.377 -23968.762  0.69%  3987 1374s
  2304     0 infeasible   13      -24136.377 -24136.377  0.00%  3986 1376s

Cutting planes:
  Learned: 2
  Implied bound: 245
  MIR: 2653
  Flow cover: 3913
  Zero half: 11
  RLT: 87
  Relax-and-lift: 683

Explored 2305 nodes (9778430 simplex iterations) in 1376.04 seconds (3395.53 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24136.4 -24145.9 -24161 ... -24257
No other solutions better than -24136.4

Optimal solution found (tolerance 1.00e-06)
Best objective -2.413637736214e+04, best bound -2.413637736214e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1376.10s
  Master Objective (UB) = -24136.38, θ = 87507.37
  Upper Bound (UB) = -24136.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87507.37
  [DEBUG]   ✓ Scenario 0: θ = 87507.37 ≤ Q = 87507.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87507.37 ≤ Q = 87507.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87507.37 ≤ Q = 87507.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 87507.37 ≤ Q = 87507.37 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 87507.37 ≤ Q = 87507.37 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 87507.37 ≤ Q = 87507.37 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x269c31af
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x269c31af
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6677710.9830
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.086381e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108638.10    0  122 6677710.98 -108638.10   102%     -    0s
H    0     0                    -78800.66404 -108638.10  37.9%     -    0s
H    0     0                    -79211.93405 -108638.10  37.1%     -    0s
     0     0 -83293.339    0  126 -79211.934 -83293.339  5.15%     -    0s
H    0     0                    -80414.41835 -83215.394  3.48%     -    0s
     0     0 -82836.099    0  128 -80414.418 -82836.099  3.01%     -    0s
H    0     0                    -80712.17981 -82767.809  2.55%     -    0s
     0     0 -82668.650    0  130 -80712.180 -82668.650  2.42%     -    0s
     0     0 -82647.542    0  130 -80712.180 -82647.542  2.40%     -    0s
     0     2 -82647.542    0  130 -80712.180 -82647.542  2.40%     -    0s
H   48    56                    -81403.90985 -82166.736  0.94%  11.3    0s

Cutting planes:
  Gomory: 12
  Implied bound: 2
  MIR: 164

Explored 343 nodes (2549 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -81403.9 -80712.2 -80414.4 ... 1.42686e+13
No other solutions better than -81403.9

Optimal solution found (tolerance 1.00e-06)
Best objective -8.140390984565e+04, best bound -8.140390984565e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 86913.86
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81403.91
  [DEBUG]   S×d_nominal = 168317.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168317.77 + -81403.91 = 86913.86
  [DEBUG]   Current θ from Master = 87507.37
  [DEBUG]   ⚠️  Z_SP ≤ θ by 593.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24729.89
  Lower Bound (LB) = -24470.95
  Gap (UB-LB) = 334.5724, Absolute Gap = 334.5724, Relative Gap = 0.013862
  Not converged yet (gap = 334.57 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826452 nonzeros
Model fingerprint: 0xcbf69aa4
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 149682 rows and 60762 columns
Presolve time: 2.19s
Presolved: 142211 rows, 60058 columns, 878773 nonzeros
Variable types: 57799 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 1067
 AA' NZ     : 3.688e+06
 Factor NZ  : 9.816e+06 (roughly 160 MB of memory)
 Factor Ops : 3.003e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.22145000e+07  2.53932124e+08  2.53e+05 2.68e+01  9.68e+04     4s
   1  -2.80225273e+07  2.40168080e+08  2.12e+05 4.45e+01  8.05e+04     4s
   2  -1.02800674e+07  1.63646656e+08  7.76e+04 1.05e+01  3.10e+04     4s
   3  -8.51313284e+06  1.49663349e+08  6.39e+04 7.41e+00  2.55e+04     4s
   4  -2.42206286e+06  1.42958474e+08  1.38e+04 5.91e+00  6.01e+03     4s
   5  -8.12397548e+05  9.14846106e+07  2.06e+03 1.93e+00  1.13e+03     4s
   6  -5.80151672e+05  4.56053772e+07  7.11e+02 6.80e-01  4.20e+02     4s
   7  -4.30020558e+05  3.05466436e+07  2.74e+02 3.74e-01  2.06e+02     4s
   8  -3.10442217e+05  1.93169466e+07  7.14e+01 1.56e-01  9.57e+01     4s
   9  -1.64085149e+05  1.28289517e+07  1.32e+01 4.64e-02  5.30e+01     4s
  10  -1.32904885e+05  6.98510016e+06  7.17e+00 1.78e-02  2.84e+01     4s
  11  -1.13323578e+05  4.90554364e+06  4.55e+00 1.23e-02  1.98e+01     4s
  12  -9.88559360e+04  3.15871649e+06  3.06e+00 7.82e-03  1.28e+01     5s
  13  -9.03689380e+04  2.61618119e+06  2.05e+00 6.48e-03  1.06e+01     5s
  14  -6.89080945e+04  1.48602812e+06  4.96e-01 3.70e-03  6.01e+00     5s
  15  -5.48613082e+04  3.55842243e+05  2.23e-01 1.01e-03  1.58e+00     5s
  16  -4.15545793e+04  1.87486747e+05  1.37e-01 5.45e-04  8.83e-01     5s
  17  -3.58497414e+04  1.24929672e+05  1.07e-01 6.63e-04  6.20e-01     5s
  18  -3.16051538e+04  9.30615905e+04  8.45e-02 1.29e-03  4.81e-01     5s
  19  -2.81846292e+04  5.97329028e+04  6.80e-02 8.77e-04  3.39e-01     5s
  20  -2.60978634e+04  4.61079209e+04  5.81e-02 1.54e-03  2.78e-01     5s
  21  -2.45826156e+04  3.80936388e+04  5.13e-02 1.49e-03  2.42e-01     5s
  22  -2.26428075e+04  2.30789220e+04  4.27e-02 2.19e-03  1.76e-01     5s
  23  -2.07949475e+04  1.36802341e+04  3.49e-02 2.65e-03  1.33e-01     5s
  24  -1.91187555e+04  7.95329543e+03  2.85e-02 2.04e-03  1.04e-01     5s
  25  -1.84028317e+04  5.15727488e+03  2.59e-02 1.78e-03  9.09e-02     5s
  26  -1.74120285e+04  3.34642232e+03  2.25e-02 1.61e-03  8.01e-02     5s
  27  -1.71132385e+04  3.10484366e+03  2.15e-02 1.57e-03  7.80e-02     5s
  28  -1.66646308e+04  1.54977699e+02  2.02e-02 1.23e-03  6.49e-02     5s
  29  -1.59753324e+04 -8.08863275e+02  1.82e-02 1.11e-03  5.85e-02     5s
  30  -1.57704943e+04 -1.53566921e+03  1.76e-02 1.02e-03  5.49e-02     5s
  31  -1.54035231e+04 -2.62061977e+03  1.65e-02 8.81e-04  4.93e-02     5s
  32  -1.52071802e+04 -3.86072522e+03  1.59e-02 7.45e-04  4.38e-02     6s
  33  -1.46326391e+04 -4.46320857e+03  1.41e-02 6.65e-04  3.92e-02     6s
  34  -1.37830642e+04 -4.84803157e+03  1.17e-02 6.18e-04  3.45e-02     6s
  35  -1.30264798e+04 -5.65618359e+03  9.71e-03 5.07e-04  2.84e-02     6s
  36  -1.26665577e+04 -6.82419830e+03  8.82e-03 3.15e-04  2.25e-02     6s
  37  -1.16582297e+04 -7.38244711e+03  6.38e-03 2.35e-04  1.65e-02     6s
  38  -1.14629164e+04 -7.76152121e+03  5.91e-03 1.78e-04  1.43e-02     6s
  39  -1.08806198e+04 -7.84415724e+03  4.60e-03 1.65e-04  1.17e-02     6s
  40  -1.06958440e+04 -7.99511069e+03  4.17e-03 1.40e-04  1.04e-02     6s
  41  -1.02852810e+04 -8.22015407e+03  3.24e-03 1.01e-04  7.97e-03     6s
  42  -1.00829329e+04 -8.27616376e+03  2.77e-03 9.17e-05  6.97e-03     6s
  43  -9.91875528e+03 -8.44898457e+03  2.38e-03 6.53e-05  5.67e-03     6s
  44  -9.56905206e+03 -8.59101536e+03  1.57e-03 4.25e-05  3.77e-03     6s
  45  -9.54789872e+03 -8.65707265e+03  1.52e-03 3.25e-05  3.44e-03     6s
  46  -9.45795204e+03 -8.74767125e+03  1.31e-03 1.08e-04  2.74e-03     7s
  47  -9.23786211e+03 -8.77195940e+03  7.70e-04 8.66e-05  1.80e-03     7s
  48  -9.12433477e+03 -8.81952650e+03  5.18e-04 4.75e-05  1.18e-03     7s
  49  -9.09362130e+03 -8.83655358e+03  4.51e-04 3.65e-05  9.92e-04     7s
  50  -9.07082575e+03 -8.84159633e+03  4.03e-04 3.28e-05  8.85e-04     7s
  51  -9.02953628e+03 -8.84407370e+03  3.10e-04 3.10e-05  7.16e-04     7s
  52  -9.00781331e+03 -8.85379083e+03  2.61e-04 2.35e-05  5.94e-04     7s
  53  -8.99809322e+03 -8.85902579e+03  2.38e-04 2.04e-05  5.37e-04     7s
  54  -8.97513120e+03 -8.86397924e+03  1.86e-04 1.63e-05  4.29e-04     7s
  55  -8.96382042e+03 -8.86835580e+03  1.62e-04 1.04e-05  3.68e-04     7s
  56  -8.95519930e+03 -8.87025173e+03  1.44e-04 8.99e-06  3.28e-04     7s
  57  -8.94600393e+03 -8.87473976e+03  1.23e-04 6.61e-06  2.75e-04     7s
  58  -8.92443916e+03 -8.87815409e+03  7.98e-05 4.17e-06  1.79e-04     7s
  59  -8.92366190e+03 -8.87897629e+03  7.82e-05 3.69e-06  1.72e-04     7s
  60  -8.92163635e+03 -8.87981225e+03  7.39e-05 3.33e-06  1.61e-04     8s
  61  -8.91812051e+03 -8.88160974e+03  6.61e-05 2.76e-06  1.41e-04     8s
  62  -8.91388267e+03 -8.88442814e+03  5.59e-05 1.68e-06  1.14e-04     8s
  63  -8.90461686e+03 -8.88573828e+03  3.46e-05 2.80e-06  7.29e-05     8s
  64  -8.90171745e+03 -8.88676170e+03  2.80e-05 1.79e-06  5.77e-05     8s
  65  -8.90114532e+03 -8.88691697e+03  2.67e-05 1.67e-06  5.49e-05     8s
  66  -8.89805947e+03 -8.88717687e+03  2.00e-05 1.47e-06  4.20e-05     8s
  67  -8.89607914e+03 -8.88754293e+03  1.55e-05 1.12e-06  3.30e-05     8s
  68  -8.89318828e+03 -8.88792640e+03  9.20e-06 7.99e-07  2.03e-05     8s
  69  -8.89213133e+03 -8.88823774e+03  6.86e-06 5.19e-07  1.50e-05     8s
  70  -8.89210737e+03 -8.88831248e+03  6.80e-06 4.59e-07  1.47e-05     8s
  71  -8.89139228e+03 -8.88839010e+03  5.24e-06 3.92e-07  1.16e-05     8s
  72  -8.89045564e+03 -8.88850193e+03  3.20e-06 2.92e-07  7.54e-06     8s
  73  -8.88981680e+03 -8.88871484e+03  1.85e-06 1.24e-07  4.26e-06     9s
  74  -8.88958751e+03 -8.88872160e+03  1.40e-06 1.16e-07  3.34e-06     9s
  75  -8.88925014e+03 -8.88877814e+03  7.21e-07 7.22e-08  1.82e-06     9s
  76  -8.88902504e+03 -8.88880672e+03  2.66e-07 5.84e-08  8.43e-07     9s
  77  -8.88896492e+03 -8.88885516e+03  1.40e-07 2.16e-08  4.24e-07     9s
  78  -8.88893252e+03 -8.88887988e+03  1.12e-07 1.63e-09  2.04e-07     9s
  79  -8.88889092e+03 -8.88888255e+03  8.86e-08 4.50e-08  3.24e-08     9s
  80  -8.88888837e+03 -8.88888283e+03  5.31e-07 2.88e-08  2.15e-08     9s
  81  -8.88888398e+03 -8.88888326e+03  1.77e-07 4.80e-09  2.77e-09     9s
  82  -8.88888344e+03 -8.88888334e+03  2.71e-07 1.81e-07  4.36e-10     9s
  83  -8.88888335e+03 -8.88888334e+03  3.78e-08 5.36e-09  5.67e-11     9s

Barrier solved model in 83 iterations and 9.11 seconds (18.17 work units)
Optimal objective -8.88888335e+03


Root crossover log...

  114249 DPushes remaining with DInf 0.0000000e+00                 9s
   23674 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    4956 PPushes remaining with PInf 1.1039296e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7836366e+01     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62821   -8.8888833e+03   0.000000e+00   1.783637e+01     12s
   62879   -8.8888833e+03   0.000000e+00   0.000000e+00     12s
   62879   -8.8888833e+03   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 2.23s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -8.888883e+03, 62879 iterations, 11.49 seconds (21.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -8888.8833    0  445 -205910.05 -8888.8833  95.7%     -   15s
H    0     0                    -139379.8183 -8888.8833  93.6%     -   15s
H    0     0                    -78221.80041 -8888.8833  88.6%     -   15s
H    0     0                    -58007.37294 -8888.8833  84.7%     -   15s
H    0     0                    -57784.31351 -8888.8833  84.6%     -   15s
H    0     0                    -45833.84251 -8888.8833  80.6%     -   16s
H    0     0                    -25042.47448 -8888.8833  64.5%     -   16s
H    0     0                    -24584.54034 -8888.8833  63.8%     -   16s
H    0     0                    -24522.87469 -8888.8833  63.8%     -   16s
H    0     0                    -24497.72480 -8888.8833  63.7%     -   16s
     0     0 -13153.758    0  537 -24497.725 -13153.758  46.3%     -   58s
H    0     0                    -24491.00452 -13154.312  46.3%     -   59s
H    0     0                    -24470.54710 -13154.312  46.2%     -   59s
H    0     0                    -24466.20144 -13154.312  46.2%     -   59s
H    0     0                    -24465.89811 -13154.312  46.2%     -   59s
H    0     0                    -24446.95388 -13154.312  46.2%     -   59s
     0     0 -13471.498    0  542 -24446.954 -13471.498  44.9%     -   69s
     0     0 -13477.891    0  548 -24446.954 -13477.891  44.9%     -   71s
     0     0 -13531.665    0  548 -24446.954 -13531.665  44.6%     -   76s
     0     0 -13535.085    0  547 -24446.954 -13535.085  44.6%     -   78s
     0     0 -13607.729    0  546 -24446.954 -13607.729  44.3%     -   86s
     0     0 -13649.414    0  547 -24446.954 -13649.414  44.2%     -   88s
     0     0 -13740.887    0  545 -24446.954 -13740.887  43.8%     -   93s
     0     0 -13746.510    0  545 -24446.954 -13746.510  43.8%     -   97s
     0     0 -13746.525    0  546 -24446.954 -13746.525  43.8%     -   97s
     0     0 -16084.792    0  615 -24446.954 -16084.792  34.2%     -  129s
H    0     0                    -24409.38692 -16085.550  34.1%     -  129s
H    0     0                    -24381.65030 -16085.550  34.0%     -  130s
     0     0 -16273.136    0  648 -24381.650 -16273.136  33.3%     -  138s
     0     0 -16322.482    0  707 -24381.650 -16322.482  33.1%     -  143s
     0     0 -16336.847    0  640 -24381.650 -16336.847  33.0%     -  146s
     0     0 -16341.721    0  707 -24381.650 -16341.721  33.0%     -  148s
     0     0 -16360.290    0  712 -24381.650 -16360.290  32.9%     -  150s
     0     0 -16399.586    0  705 -24381.650 -16399.586  32.7%     -  154s
     0     0 -16424.403    0  643 -24381.650 -16424.403  32.6%     -  160s
     0     0 -16576.114    0  625 -24381.650 -16576.114  32.0%     -  170s
     0     0 -16628.792    0  622 -24381.650 -16628.792  31.8%     -  174s
     0     0 -16634.623    0  633 -24381.650 -16634.623  31.8%     -  175s
     0     0 -16658.198    0  647 -24381.650 -16658.198  31.7%     -  176s
     0     0 -16658.255    0  645 -24381.650 -16658.255  31.7%     -  177s
     0     0 -18056.137    0  791 -24381.650 -18056.137  25.9%     -  219s
     0     0 -18309.213    0  836 -24381.650 -18309.213  24.9%     -  236s
     0     0 -18329.112    0  848 -24381.650 -18329.112  24.8%     -  241s
     0     0 -18365.012    0  855 -24381.650 -18365.012  24.7%     -  246s
     0     0 -18384.808    0  850 -24381.650 -18384.808  24.6%     -  251s
     0     0 -18387.475    0  850 -24381.650 -18387.475  24.6%     -  253s
     0     0 -18404.892    0  848 -24381.650 -18404.892  24.5%     -  259s
     0     0 -18522.998    0  805 -24381.650 -18522.998  24.0%     -  269s
     0     0 -18525.057    0  864 -24381.650 -18525.057  24.0%     -  272s
     0     0 -18529.270    0  857 -24381.650 -18529.270  24.0%     -  273s
     0     0 -18534.788    0  857 -24381.650 -18534.788  24.0%     -  275s
     0     0 -18536.451    0  844 -24381.650 -18536.451  24.0%     -  278s
     0     0 -18572.560    0  788 -24381.650 -18572.560  23.8%     -  280s
     0     0 -18586.843    0  849 -24381.650 -18586.843  23.8%     -  283s
     0     0 -18587.336    0  861 -24381.650 -18587.336  23.8%     -  284s
     0     0 -19188.540    0  694 -24381.650 -19188.540  21.3%     -  311s
     0     0 -19325.151    0  776 -24381.650 -19325.151  20.7%     -  322s
     0     0 -19343.898    0  699 -24381.650 -19343.898  20.7%     -  328s
     0     0 -19377.893    0  799 -24381.650 -19377.893  20.5%     -  332s
     0     0 -19391.214    0  724 -24381.650 -19391.214  20.5%     -  336s
     0     0 -19399.647    0  730 -24381.650 -19399.647  20.4%     -  339s
     0     0 -19429.158    0  730 -24381.650 -19429.158  20.3%     -  342s
     0     0 -19437.697    0  735 -24381.650 -19437.697  20.3%     -  344s
     0     0 -19441.374    0  730 -24381.650 -19441.374  20.3%     -  345s
     0     0 -19442.880    0  734 -24381.650 -19442.880  20.3%     -  346s
     0     0 -19443.888    0  728 -24381.650 -19443.888  20.3%     -  347s
     0     0 -19648.546    0  800 -24381.650 -19648.546  19.4%     -  367s
     0     0 -19740.740    0  816 -24381.650 -19740.740  19.0%     -  375s
     0     0 -19772.725    0  810 -24381.650 -19772.725  18.9%     -  380s
     0     0 -19784.015    0  825 -24381.650 -19784.015  18.9%     -  383s
     0     0 -19795.124    0  809 -24381.650 -19795.124  18.8%     -  386s
     0     0 -19798.621    0  813 -24381.650 -19798.621  18.8%     -  388s
     0     0 -19801.100    0  817 -24381.650 -19801.100  18.8%     -  391s
     0     0 -19804.774    0  816 -24381.650 -19804.774  18.8%     -  393s
     0     0 -19805.480    0  813 -24381.650 -19805.480  18.8%     -  395s
     0     0 -19927.228    0  887 -24381.650 -19927.228  18.3%     -  409s
H    0     0                    -24370.22910 -19927.552  18.2%     -  410s
H    0     0                    -24347.95522 -19927.552  18.2%     -  410s
H    0     0                    -24338.59467 -19927.552  18.1%     -  410s
H    0     0                    -24330.56065 -19927.552  18.1%     -  410s
     0     0 -19961.839    0  839 -24330.561 -19961.839  18.0%     -  415s
     0     0 -19966.635    0  838 -24330.561 -19966.635  17.9%     -  416s
     0     0 -19970.473    0  840 -24330.561 -19970.473  17.9%     -  418s
     0     0 -19974.236    0  919 -24330.561 -19974.236  17.9%     -  419s
     0     0 -19974.607    0  840 -24330.561 -19974.607  17.9%     -  420s
     0     0 -20015.406    0  737 -24330.561 -20015.406  17.7%     -  430s
H    0     0                    -24251.86945 -20015.728  17.5%     -  431s
H    0     0                    -24248.89100 -20015.728  17.5%     -  431s
H    0     0                    -24246.49004 -20015.728  17.4%     -  431s
     0     0 -20028.960    0  748 -24246.490 -20028.960  17.4%     -  435s
     0     0 -20051.227    0  816 -24246.490 -20051.227  17.3%     -  439s
     0     0 -20056.265    0  816 -24246.490 -20056.265  17.3%     -  442s
     0     0 -20056.265    0  816 -24246.490 -20056.265  17.3%     -  442s
     0     0 -20059.025    0  817 -24246.490 -20059.025  17.3%     -  443s
     0     0 -20060.254    0  752 -24246.490 -20060.254  17.3%     -  444s
     0     0 -20121.063    0  751 -24246.490 -20121.063  17.0%     -  457s
     0     0 -20145.527    0  748 -24246.490 -20145.527  16.9%     -  465s
     0     0 -20152.842    0  749 -24246.490 -20152.842  16.9%     -  468s
     0     0 -20154.814    0  809 -24246.490 -20154.814  16.9%     -  470s
     0     0 -20159.932    0  761 -24246.490 -20159.932  16.9%     -  473s
     0     0 -20160.656    0  769 -24246.490 -20160.656  16.9%     -  474s
     0     0 -20183.705    0  753 -24246.490 -20183.705  16.8%     -  481s
H    0     0                    -24237.98079 -20183.795  16.7%     -  482s
H    0     0                    -24227.54581 -20183.795  16.7%     -  482s
     0     0 -20204.180    0  751 -24227.546 -20204.180  16.6%     -  486s
     0     0 -20210.776    0  758 -24227.546 -20210.776  16.6%     -  489s
     0     0 -20212.694    0  751 -24227.546 -20212.694  16.6%     -  490s
     0     0 -20213.249    0  750 -24227.546 -20213.249  16.6%     -  492s
     0     0 -20235.928    0  907 -24227.546 -20235.928  16.5%     -  501s
H    0     0                    -24227.26708 -20236.052  16.5%     -  503s
H    0     0                    -24225.09883 -20236.052  16.5%     -  503s
H    0     0                    -24214.12245 -20236.052  16.4%     -  503s
H    0     0                    -24206.01322 -20236.052  16.4%     -  503s
H    0     0                    -24202.54235 -20236.052  16.4%     -  503s
H    0     0                    -24185.78297 -20236.052  16.3%     -  503s
     0     0 -20242.751    0  889 -24185.783 -20242.751  16.3%     -  507s
     0     0 -20244.301    0  895 -24185.783 -20244.301  16.3%     -  508s
     0     0 -20253.996    0  754 -24185.783 -20253.996  16.3%     -  515s
     0     0 -20259.362    0  895 -24185.783 -20259.362  16.2%     -  519s
     0     0 -20260.266    0  843 -24185.783 -20260.266  16.2%     -  520s
     0     0 -20260.266    0  843 -24185.783 -20260.266  16.2%     -  521s
     0     0 -20270.401    0  959 -24185.783 -20270.401  16.2%     -  529s
H    0     0                    -24184.55036 -20271.130  16.2%     -  533s
H    0     0                    -24184.51339 -20271.130  16.2%     -  533s
     0     0 -20273.122    0  905 -24184.513 -20273.122  16.2%     -  535s
     0     0 -20274.663    0  916 -24184.513 -20274.663  16.2%     -  537s
     0     0 -20285.686    0  861 -24184.513 -20285.686  16.1%     -  544s
     0     0 -20286.916    0  855 -24184.513 -20286.916  16.1%     -  547s
     0     0 -20291.267    0  914 -24184.513 -20291.267  16.1%     -  554s
     0     0 -20291.305    0  914 -24184.513 -20291.305  16.1%     -  565s
H    0     0                    -24181.87857 -20291.345  16.1%     -  584s
H    0     0                    -24181.53494 -20291.345  16.1%     -  584s
H    0     0                    -24171.67552 -20291.345  16.1%     -  656s
H    0     0                    -24171.32951 -20291.345  16.1%     -  656s
H    0     0                    -24170.44292 -20291.345  16.0%     -  657s
H    0     2                    -24141.68200 -20291.345  15.9%     -  660s
     0     2 -20291.345    0  914 -24141.682 -20291.345  15.9%     -  660s
     1     3 -22443.650    1  313 -24141.682 -20291.345  15.9% 27480  675s
     2     6 -23786.731    2   88 -24141.682 -20291.345  15.9% 16446  681s
     5    10 -24055.425    3   94 -24141.682 -20390.988  15.5%  8423  700s
    11    13 infeasible    4      -24141.682 -20443.379  15.3%  6807  710s
    18    20 -21621.762    4  137 -24141.682 -20443.597  15.3%  6374  731s
    27    32 -22451.221    5  130 -24141.682 -20518.182  15.0%  7613  830s
H   35    32                    -24141.56792 -20518.182  15.0%  7256  830s
    46    47 -21292.668    5  263 -24141.568 -20567.109  14.8% 15893  865s
    75    82 -21327.396    6  257 -24141.568 -20655.349  14.4% 12240  892s
   145   112 -21574.240    9  243 -24141.568 -20660.799  14.4%  7863  910s
   221   119 -21813.149   11  238 -24141.568 -20660.799  14.4%  6503  924s
   261   106 -22701.974   12  246 -24141.568 -20660.799  14.4%  5867  943s
   321   110 -22931.243   13  115 -24141.568 -20660.799  14.4%  5212  960s
   353    92 infeasible   14      -24141.568 -20660.799  14.4%  5101  979s
   404    68 -23533.991   11  219 -24141.568 -20660.799  14.4%  4896  998s
   447    66 infeasible   12      -24141.568 -20660.799  14.4%  4786 1017s
   492    59 infeasible   11      -24141.568 -20660.799  14.4%  4582 1036s
   536    50 -21432.592   12  743 -24141.568 -20750.255  14.0%  4543 1055s
   573    57 -21491.018   13  724 -24141.568 -20750.255  14.0%  4552 1072s
   628    77 -21778.259   14  648 -24141.568 -20750.255  14.0%  4369 1088s
   697    73 -22423.517   16  617 -24141.568 -20750.255  14.0%  4124 1101s
   782    57 -22449.889   17  614 -24141.568 -20750.255  14.0%  3852 1117s
   847    59 -22462.917   18  613 -24141.568 -20750.255  14.0%  3664 1131s
   898    84 -22288.535   17  637 -24141.568 -20750.255  14.0%  3555 1147s
   958   118 -22860.461   22  405 -24141.568 -20750.255  14.0%  3439 1163s
  1032   129 infeasible   24      -24141.568 -20750.255  14.0%  3313 1178s
  1113   142 -22914.365   24  308 -24141.568 -20750.255  14.0%  3161 1199s
  1170   147 infeasible   25      -24141.568 -20750.255  14.0%  3113 1217s
  1222   149 -23063.872   25  397 -24141.568 -20750.255  14.0%  3080 1242s
  1303   145 infeasible   26      -24141.568 -21894.263  9.31%  3014 1262s
  1361   144 infeasible   26      -24141.568 -21925.656  9.18%  3043 1281s
  1429   142 infeasible   13      -24141.568 -21925.656  9.18%  3078 1302s
  1498   148 -22451.037   11  696 -24141.568 -21925.656  9.18%  3109 1322s
  1595   132 -23620.465   19  472 -24141.568 -21925.656  9.18%  3069 1341s
  1686   120 -23804.073   12  289 -24141.568 -21925.656  9.18%  3067 1361s
  1814    93 -23819.541   13  278 -24141.568 -21925.656  9.18%  2988 1384s
  1940    78 -23434.266   18  441 -24141.568 -21925.656  9.18%  2972 1403s
  2076    24 infeasible   23      -24141.568 -22516.815  6.73%  2916 1418s
  2207     7 -23737.328   16  529 -24141.568 -23444.563  2.89%  2834 1431s
  2245     4 -24001.144   17  511 -24141.568 -23619.476  2.16%  2816 1439s
  2252     0     cutoff   18      -24141.568 -23842.819  1.24%  2812 1446s

Cutting planes:
  Gomory: 1
  Implied bound: 193
  MIR: 2672
  Flow cover: 3969
  Zero half: 21
  RLT: 88
  Relax-and-lift: 637

Explored 2258 nodes (6965603 simplex iterations) in 1446.58 seconds (3483.64 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24141.6 -24141.7 -24170.4 ... -24185.8
No other solutions better than -24141.6

Optimal solution found (tolerance 1.00e-06)
Best objective -2.414156791862e+04, best bound -2.414156791862e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1446.68s
  Master Objective (UB) = -24141.57, θ = 87383.71
  Upper Bound (UB) = -24141.57

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87383.71
  [DEBUG]   ✓ Scenario 0: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87383.71 ≤ Q = 87383.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87383.71 ≤ Q = 87383.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 87383.71 ≤ Q = 87383.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x26bd272a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd942d8d6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6684460.3959
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.083744e+05, 211 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108374.43    0  122 6684460.40 -108374.43   102%     -    0s
H    0     0                    -78565.46116 -108374.43  37.9%     -    0s
H    0     0                    -78991.47169 -108374.43  37.2%     -    0s
     0     0 -83133.432    0   56 -78991.472 -83133.432  5.24%     -    0s
H    0     0                    -81767.39769 -83080.746  1.61%     -    0s
     0     0 -82915.625    0   58 -81767.398 -82915.625  1.40%     -    0s
     0     0 -82752.920    0   57 -81767.398 -82752.920  1.21%     -    0s
     0     0 -82685.918    0   57 -81767.398 -82685.918  1.12%     -    0s
     0     2 -82685.918    0   57 -81767.398 -82685.918  1.12%     -    0s

Cutting planes:
  Gomory: 39
  MIR: 151
  RLT: 2

Explored 101 nodes (942 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -81767.4 -78991.5 -78565.5 ... 1.42686e+13
No other solutions better than -81767.4

Optimal solution found (tolerance 1.00e-06)
Best objective -8.176739769443e+04, best bound -8.176739769443e+04, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 86169.14
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81767.40
  [DEBUG]   S×d_nominal = 167936.54
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 167936.54 + -81767.40 = 86169.14
  [DEBUG]   Current θ from Master = 87383.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1214.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25356.14
  Lower Bound (LB) = -24470.95
  Gap (UB-LB) = 329.3818, Absolute Gap = 329.3818, Relative Gap = 0.013644
  Not converged yet (gap = 329.38 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 869659 nonzeros
Model fingerprint: 0xe18cc644
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 157560 rows and 63960 columns
Presolve time: 2.57s
Presolved: 149623 rows, 63100 columns, 924578 nonzeros
Variable types: 60841 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 1066
 AA' NZ     : 4.020e+06
 Factor NZ  : 1.096e+07 (roughly 180 MB of memory)
 Factor Ops : 3.926e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.23371118e+07  2.66608231e+08  2.54e+05 2.66e+01  9.70e+04     5s
   1  -2.82364523e+07  2.51433129e+08  2.14e+05 4.12e+01  8.10e+04     5s
   2  -1.04185287e+07  1.70076446e+08  7.87e+04 2.06e+00  3.18e+04     5s
   3  -2.16494414e+06  1.73658222e+08  1.33e+04 1.05e+01  5.90e+03     5s
   4  -7.25535376e+05  9.98529207e+07  1.79e+03 3.82e-01  1.04e+03     5s
   5  -5.40275034e+05  7.41537360e+07  6.36e+02 2.66e-01  5.02e+02     5s
   6  -4.55093120e+05  4.21941216e+07  2.47e+02 4.35e-01  2.36e+02     5s
   7  -3.76306584e+05  3.03820625e+07  8.33e+01 8.94e-02  1.37e+02     5s
   8  -2.84359199e+05  2.46834830e+07  2.13e+01 7.10e-02  9.71e+01     5s
   9  -2.01374909e+05  1.37201152e+07  5.01e+00 3.83e-02  5.19e+01     5s
  10  -1.57855359e+05  8.24346117e+06  1.96e+00 2.27e-02  3.10e+01     5s
  11  -1.23874219e+05  4.54396914e+06  1.03e+00 1.19e-02  1.72e+01     5s
  12  -1.07864192e+05  3.36964299e+06  7.00e-01 8.89e-03  1.28e+01     5s
  13  -9.79072267e+04  2.51593275e+06  5.28e-01 6.62e-03  9.60e+00     5s
  14  -8.20920669e+04  1.84998583e+06  2.65e-01 4.91e-03  7.09e+00     5s
  15  -5.94591163e+04  1.45340151e+06  9.37e-02 3.79e-03  5.54e+00     5s
  16  -4.54474721e+04  3.34167759e+05  4.29e-02 8.82e-04  1.39e+00     5s
  17  -3.71817707e+04  2.12190280e+05  3.00e-02 6.95e-04  9.14e-01     5s
  18  -3.32400473e+04  1.29006764e+05  2.41e-02 5.83e-04  5.94e-01     5s
  19  -2.78468824e+04  9.13440228e+04  1.71e-02 1.39e-03  4.37e-01     5s
  20  -2.49342880e+04  6.51669471e+04  1.34e-02 5.78e-03  3.30e-01     5s
  21  -2.27930393e+04  5.50027173e+04  1.08e-02 4.78e-03  2.85e-01     6s
  22  -2.14569976e+04  3.14266043e+04  9.37e-03 2.91e-03  1.94e-01     6s
  23  -1.97024508e+04  1.97041557e+04  7.60e-03 1.97e-03  1.44e-01     6s
  24  -1.88511355e+04  1.53987548e+04  6.80e-03 1.68e-03  1.25e-01     6s
  25  -1.77905082e+04  1.06396866e+04  5.87e-03 1.37e-03  1.04e-01     6s
  26  -1.61851293e+04  6.64475647e+03  4.52e-03 1.11e-03  8.36e-02     6s
  27  -1.57073840e+04  3.68421389e+03  4.15e-03 9.05e-04  7.11e-02     6s
  28  -1.47960923e+04  2.40317645e+03  3.42e-03 8.17e-04  6.30e-02     6s
  29  -1.37931506e+04  1.16471309e+03  2.69e-03 7.31e-04  5.48e-02     6s
  30  -1.30899863e+04 -1.71276081e+03  2.20e-03 5.83e-04  4.17e-02     6s
  31  -1.28188046e+04 -2.40138165e+03  2.03e-03 5.30e-04  3.82e-02     6s
  32  -1.20278434e+04 -3.20067547e+03  1.59e-03 4.66e-04  3.23e-02     6s
  33  -1.10653771e+04 -5.04935279e+03  1.08e-03 3.01e-04  2.20e-02     6s
  34  -1.05296320e+04 -6.60600392e+03  8.22e-04 1.48e-04  1.44e-02     6s
  35  -9.94497733e+03 -7.46715908e+03  5.53e-04 9.15e-05  9.08e-03     6s
  36  -9.58407287e+03 -7.74961314e+03  3.95e-04 7.62e-05  6.72e-03     6s
  37  -9.50465766e+03 -8.04489707e+03  3.61e-04 4.75e-05  5.35e-03     6s
  38  -9.13389473e+03 -8.26589355e+03  2.06e-04 3.22e-05  3.18e-03     7s
  39  -9.04980251e+03 -8.34253996e+03  1.73e-04 2.41e-05  2.59e-03     7s
  40  -8.85550359e+03 -8.47455729e+03  9.30e-05 1.43e-05  1.40e-03     7s
  41  -8.79600733e+03 -8.51649160e+03  6.88e-05 9.54e-06  1.02e-03     7s
  42  -8.76984085e+03 -8.53390237e+03  5.80e-05 7.87e-06  8.64e-04     7s
  43  -8.74795874e+03 -8.55140022e+03  4.92e-05 6.30e-06  7.20e-04     7s
  44  -8.73114001e+03 -8.56205780e+03  4.23e-05 5.26e-06  6.19e-04     7s
  45  -8.71440043e+03 -8.57467183e+03  3.57e-05 3.91e-06  5.12e-04     7s
  46  -8.69903746e+03 -8.58245356e+03  2.94e-05 3.50e-06  4.27e-04     7s
  47  -8.68830019e+03 -8.58624875e+03  2.52e-05 3.41e-06  3.74e-04     7s
  48  -8.67517104e+03 -8.59001429e+03  1.96e-05 2.94e-06  3.12e-04     7s
  49  -8.66670729e+03 -8.59741967e+03  1.61e-05 2.41e-06  2.54e-04     7s
  50  -8.65474643e+03 -8.60611919e+03  1.17e-05 1.58e-06  1.78e-04     7s
  51  -8.65263111e+03 -8.60810718e+03  1.08e-05 1.24e-06  1.63e-04     7s
  52  -8.64705491e+03 -8.60985223e+03  8.82e-06 1.08e-06  1.36e-04     7s
  53  -8.63713987e+03 -8.61600130e+03  5.14e-06 5.34e-07  7.75e-05     8s
  54  -8.63138320e+03 -8.61906502e+03  3.07e-06 1.99e-07  4.51e-05     8s
  55  -8.63062337e+03 -8.61967975e+03  2.80e-06 1.66e-07  4.01e-05     8s
  56  -8.62993574e+03 -8.62050513e+03  2.52e-06 1.28e-07  3.46e-05     8s
  57  -8.62797402e+03 -8.62058911e+03  1.75e-06 1.24e-07  2.71e-05     8s
  58  -8.62699257e+03 -8.62186924e+03  1.39e-06 7.32e-08  1.88e-05     8s
  59  -8.62594513e+03 -8.62259529e+03  9.86e-07 1.36e-07  1.23e-05     8s
  60  -8.62536746e+03 -8.62288929e+03  7.69e-07 1.29e-07  9.09e-06     8s
  61  -8.62461114e+03 -8.62294795e+03  4.98e-07 1.01e-07  6.10e-06     8s
  62  -8.62452442e+03 -8.62298887e+03  4.64e-07 8.89e-08  5.63e-06     8s
  63  -8.62435572e+03 -8.62303358e+03  4.00e-07 7.86e-08  4.85e-06     8s
  64  -8.62408116e+03 -8.62308580e+03  2.97e-07 5.43e-08  3.65e-06     8s
  65  -8.62385592e+03 -8.62312029e+03  2.15e-07 4.23e-08  2.70e-06     8s
  66  -8.62367699e+03 -8.62316584e+03  1.51e-07 2.60e-08  1.88e-06     9s
  67  -8.62345287e+03 -8.62319207e+03  5.98e-08 1.63e-08  9.57e-07     9s
  68  -8.62338459e+03 -8.62322105e+03  2.51e-07 7.62e-09  6.01e-07     9s
  69  -8.62331789e+03 -8.62323759e+03  1.26e-07 3.24e-09  2.95e-07     9s
  70  -8.62327378e+03 -8.62324446e+03  9.00e-08 1.06e-09  1.08e-07     9s
  71  -8.62326261e+03 -8.62324927e+03  2.90e-07 1.37e-08  4.90e-08     9s
  72  -8.62325601e+03 -8.62324949e+03  1.33e-07 7.61e-09  2.40e-08     9s
  73  -8.62325390e+03 -8.62324963e+03  1.70e-07 6.08e-09  1.57e-08     9s
  74  -8.62325015e+03 -8.62324989e+03  1.63e-08 1.03e-09  9.28e-10     9s
  75  -8.62325000e+03 -8.62324996e+03  5.84e-07 5.38e-09  1.26e-10     9s

Barrier solved model in 75 iterations and 9.21 seconds (18.95 work units)
Optimal objective -8.62325000e+03


Root crossover log...

  119948 DPushes remaining with DInf 0.0000000e+00                 9s
   59922 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    8930 PPushes remaining with PInf 3.8902058e-05                15s
    3569 PPushes remaining with PInf 1.8367032e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.7635237e+01     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   72566   -8.6232500e+03   0.000000e+00   7.763524e+01     16s
   72654   -8.6232500e+03   0.000000e+00   0.000000e+00     16s
   72654   -8.6232500e+03   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 3.84s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -8.623250e+03, 72654 iterations, 16.18 seconds (32.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -8623.2500    0  447 -205910.05 -8623.2500  95.8%     -   20s
H    0     0                    -51245.86946 -8623.2500  83.2%     -   20s
H    0     0                    -51054.43358 -8623.2500  83.1%     -   20s
H    0     0                    -24680.20747 -8623.2500  65.1%     -   21s
H    0     0                    -24631.43969 -8623.2500  65.0%     -   21s
H    0     0                    -24608.14980 -8623.2500  65.0%     -   21s
     0     0 -12379.826    0  516 -24608.150 -12379.826  49.7%     -   75s
H    0     0                    -24528.55885 -12379.873  49.5%     -   75s
H    0     0                    -24520.52483 -12379.873  49.5%     -   76s
H    0     0                    -24477.80340 -12379.873  49.4%     -   76s
     0     0 -12633.667    0  520 -24477.803 -12633.667  48.4%     -   89s
     0     0 -12679.578    0  522 -24477.803 -12679.578  48.2%     -   95s
     0     0 -12724.556    0  531 -24477.803 -12724.556  48.0%     -   98s
     0     0 -12757.750    0  523 -24477.803 -12757.750  47.9%     -  103s
     0     0 -12790.972    0  529 -24477.803 -12790.972  47.7%     -  107s
     0     0 -12831.800    0  603 -24477.803 -12831.800  47.6%     -  111s
     0     0 -12862.528    0  613 -24477.803 -12862.528  47.5%     -  114s
     0     0 -12866.828    0  611 -24477.803 -12866.828  47.4%     -  115s
     0     0 -12913.056    0  608 -24477.803 -12913.056  47.2%     -  118s
     0     0 -12916.974    0  608 -24477.803 -12916.974  47.2%     -  119s
     0     0 -12917.574    0  609 -24477.803 -12917.574  47.2%     -  119s
     0     0 -13044.257    0  601 -24477.803 -13044.257  46.7%     -  124s
     0     0 -13046.986    0  607 -24477.803 -13046.986  46.7%     -  126s
     0     0 -13113.619    0  601 -24477.803 -13113.619  46.4%     -  130s
     0     0 -13113.622    0  601 -24477.803 -13113.622  46.4%     -  130s
     0     0 -15693.061    0  628 -24477.803 -15693.061  35.9%     -  172s
H    0     0                    -24473.00600 -15693.610  35.9%     -  173s
H    0     0                    -24466.18677 -15693.610  35.9%     -  173s
H    0     0                    -24464.97199 -15693.610  35.9%     -  173s
     0     0 -15810.381    0  629 -24464.972 -15810.381  35.4%     -  178s
     0     0 -16000.101    0  638 -24464.972 -16000.101  34.6%     -  188s
     0     0 -16069.823    0  632 -24464.972 -16069.823  34.3%     -  195s
     0     0 -16149.528    0  685 -24464.972 -16149.528  34.0%     -  203s
     0     0 -16189.267    0  624 -24464.972 -16189.267  33.8%     -  207s
     0     0 -16216.491    0  632 -24464.972 -16216.491  33.7%     -  210s
     0     0 -16217.367    0  636 -24464.972 -16217.367  33.7%     -  211s
     0     0 -18089.154    0  890 -24464.972 -18089.154  26.1%     -  259s
     0     0 -18286.824    0  828 -24464.972 -18286.824  25.3%     -  270s
     0     0 -18330.404    0  779 -24464.972 -18330.404  25.1%     -  276s
     0     0 -18339.200    0  838 -24464.972 -18339.200  25.0%     -  279s
     0     0 -18353.752    0  897 -24464.972 -18353.752  25.0%     -  282s
     0     0 -18354.938    0  896 -24464.972 -18354.938  25.0%     -  283s
     0     0 -19156.290    0  782 -24464.972 -19156.290  21.7%     -  318s
H    0     0                    -24432.14577 -19156.384  21.6%     -  318s
     0     0 -19314.209    0  780 -24432.146 -19314.209  20.9%     -  336s
     0     0 -19385.638    0  782 -24432.146 -19385.638  20.7%     -  346s
     0     0 -19403.648    0  788 -24432.146 -19403.648  20.6%     -  352s
     0     0 -19415.944    0  852 -24432.146 -19415.944  20.5%     -  358s
     0     0 -19418.691    0  788 -24432.146 -19418.691  20.5%     -  360s
     0     0 -19418.971    0  795 -24432.146 -19418.971  20.5%     -  361s
     0     0 -19627.171    0  795 -24432.146 -19627.171  19.7%     -  378s
H    0     0                    -24379.32202 -19627.745  19.5%     -  378s
H    0     0                    -24376.34357 -19627.745  19.5%     -  378s
H    0     0                    -24368.30956 -19627.745  19.5%     -  378s
H    0     0                    -24360.37780 -19627.745  19.4%     -  378s
H    0     0                    -24357.39935 -19627.745  19.4%     -  378s
H    0     0                    -24349.36533 -19627.745  19.4%     -  378s
     0     0 -19706.266    0  856 -24349.365 -19706.266  19.1%     -  385s
     0     0 -19727.585    0  868 -24349.365 -19727.585  19.0%     -  392s
     0     0 -19774.290    0  870 -24349.365 -19774.290  18.8%     -  400s
     0     0 -19779.191    0  860 -24349.365 -19779.191  18.8%     -  403s
     0     0 -19787.724    0  866 -24349.365 -19787.724  18.7%     -  406s
     0     0 -19790.264    0  866 -24349.365 -19790.264  18.7%     -  409s
     0     0 -19791.033    0  868 -24349.365 -19791.033  18.7%     -  410s
     0     0 -19881.536    0  752 -24349.365 -19881.536  18.3%     -  427s
     0     0 -19906.111    0  754 -24349.365 -19906.111  18.2%     -  435s
     0     0 -19918.588    0  825 -24349.365 -19918.588  18.2%     -  439s
     0     0 -19919.230    0  753 -24349.365 -19919.230  18.2%     -  440s
     0     0 -19989.640    0  759 -24349.365 -19989.640  17.9%     -  456s
H    0     0                    -24332.25702 -19989.684  17.8%     -  457s
H    0     0                    -24308.55130 -19989.684  17.8%     -  457s
H    0     0                    -24300.51728 -19989.684  17.7%     -  457s
     0     0 -19993.894    0  773 -24300.517 -19993.894  17.7%     -  460s
     0     0 -19994.467    0  771 -24300.517 -19994.467  17.7%     -  460s
     0     0 -20011.370    0  752 -24300.517 -20011.370  17.7%     -  469s
     0     0 -20013.987    0  899 -24300.517 -20013.987  17.6%     -  474s
     0     0 -20016.698    0  901 -24300.517 -20016.698  17.6%     -  476s
     0     0 -20043.982    0  882 -24300.517 -20043.982  17.5%     -  481s
     0     0 -20047.050    0  897 -24300.517 -20047.050  17.5%     -  484s
     0     0 -20053.217    0  900 -24300.517 -20053.217  17.5%     -  488s
     0     0 -20053.942    0  898 -24300.517 -20053.942  17.5%     -  489s
     0     0 -20090.496    0  771 -24300.517 -20090.496  17.3%     -  500s
     0     0 -20104.273    0  829 -24300.517 -20104.273  17.3%     -  506s
     0     0 -20111.702    0  836 -24300.517 -20111.702  17.2%     -  509s
     0     0 -20127.612    0  851 -24300.517 -20127.612  17.2%     -  514s
     0     0 -20129.105    0  846 -24300.517 -20129.105  17.2%     -  516s
     0     0 -20156.150    0  826 -24300.517 -20156.150  17.1%     -  525s
     0     0 -20165.547    0  837 -24300.517 -20165.547  17.0%     -  530s
     0     0 -20176.230    0  838 -24300.517 -20176.230  17.0%     -  535s
     0     0 -20178.015    0  821 -24300.517 -20178.015  17.0%     -  538s
     0     0 -20178.164    0  823 -24300.517 -20178.164  17.0%     -  539s
     0     0 -20199.728    0  812 -24300.517 -20199.728  16.9%     -  549s
     0     0 -20207.343    0  899 -24300.517 -20207.343  16.8%     -  554s
     0     0 -20208.584    0  904 -24300.517 -20208.584  16.8%     -  556s
     0     0 -20222.696    0  895 -24300.517 -20222.696  16.8%     -  565s
H    0     0                    -24267.00237 -20223.039  16.7%     -  579s
     0     0 -20224.569    0  896 -24267.002 -20224.569  16.7%     -  581s
     0     0 -20226.960    0  763 -24267.002 -20226.960  16.6%     -  584s
     0     0 -20227.877    0  824 -24267.002 -20227.877  16.6%     -  585s
     0     0 -20236.550    0  839 -24267.002 -20236.550  16.6%     -  593s
H    0     0                    -24242.33257 -20238.383  16.5%     -  594s
     0     0 -20239.506    0  906 -24242.333 -20239.506  16.5%     -  597s
     0     0 -20240.169    0  903 -24242.333 -20240.169  16.5%     -  598s
     0     0 -20245.152    0  911 -24242.333 -20245.152  16.5%     -  604s
H    0     0                    -24231.98279 -20245.324  16.5%     -  607s
H    0     0                    -24161.94352 -20245.324  16.2%     -  607s
H    0     0                    -24153.90950 -20245.324  16.2%     -  607s
H    0     0                    -24152.26828 -20245.324  16.2%     -  607s
     0     0 -20245.843    0  907 -24152.268 -20245.843  16.2%     -  609s
     0     0 -20247.949    0  912 -24152.268 -20247.949  16.2%     -  615s
     0     0 -20248.079    0  912 -24152.268 -20248.079  16.2%     -  626s
     0     2 -20248.171    0  912 -24152.268 -20248.171  16.2%     -  698s
     1     3 -20458.944    1  544 -24152.268 -20249.892  16.2% 20657  707s
     2     4 -20271.794    1  832 -24152.268 -20271.794  16.1% 11993  717s
     3     6 -20331.142    2  824 -24152.268 -20273.870  16.1% 11712  733s
     5    11 -21289.256    3  149 -24152.268 -20273.870  16.1% 10311  750s
    10    18 -20748.284    4  531 -24152.268 -20332.877  15.8% 10029  767s
    19    24 -22013.101    5  133 -24152.268 -20341.475  15.8% 10837  836s
H   27    45                    -24149.28983 -20749.087  14.1% 12475  978s
    48    73 -23319.586    6  564 -24149.290 -20752.140  14.1% 21253 1000s
    80   119 -23617.166    7  546 -24149.290 -20752.140  14.1% 15832 1026s
   185   136 infeasible   10      -24149.290 -20752.140  14.1% 11795 1043s
   287   145 infeasible   12      -24149.290 -20752.140  14.1%  9275 1058s
   323   155 -23394.136   15  127 -24149.290 -20752.140  14.1%  8848 1073s
   377   170 -23698.677   16  108 -24149.290 -20752.140  14.1%  8337 1087s
   416   175 infeasible   17      -24149.290 -20752.140  14.1%  8073 1100s
   459   172     cutoff   13      -24149.290 -20752.140  14.1%  7678 1115s
   520   165 infeasible   16      -24149.290 -20752.140  14.1%  7202 1128s
   577   151 -23458.011   11  278 -24149.290 -20752.140  14.1%  7101 1141s
   646   160 -23274.088   10  284 -24149.290 -20752.140  14.1%  6872 1155s
   703   153 -23300.723   11  261 -24149.290 -20752.140  14.1%  6752 1172s
   763   159 -23455.352   12  254 -24149.290 -20752.140  14.1%  6620 1186s
H  775   159                    -24146.22024 -20752.140  14.1%  6580 1186s
   826   151 -23824.809   13  516 -24146.220 -20752.140  14.1%  6392 1203s
   929   143 -23851.203   14  340 -24146.220 -20752.140  14.1%  5975 1217s
  1042   146 -24066.469   16  499 -24146.220 -20752.140  14.1%  5644 1230s
  1091   133 -24068.514   17  351 -24146.220 -20752.140  14.1%  5597 1246s
  1158   108 infeasible   18      -24146.220 -20752.140  14.1%  5481 1260s
  1228   115 -24101.476   17   81 -24146.220 -20752.140  14.1%  5385 1274s
  1299   103 -24083.168   13  758 -24146.220 -20752.140  14.1%  5257 1289s
* 1327   103              19    -24143.90149 -20752.140  14.0%  5226 1289s
  1399    82 infeasible   14      -24143.901 -20752.140  14.0%  5072 1305s
* 1509    82              19    -24142.80052 -20752.140  14.0%  4839 1305s
  1561    55 -22372.276    7  357 -24142.801 -20752.140  14.0%  4754 1321s
  1668    43 -22626.285    8  574 -24142.801 -20752.140  14.0%  4628 1338s
  1738    23 -22738.189    9  386 -24142.801 -20752.140  14.0%  4620 1353s
  1795    17 -22740.860   10  381 -24142.801 -21304.317  11.8%  4580 1370s
  1825    25 -22923.940   11  132 -24142.801 -21304.927  11.8%  4597 1381s
  1843    55 -23636.882   12  125 -24142.801 -21304.927  11.8%  4628 1397s
  1901   131 -24095.296   17   88 -24142.801 -22036.782  8.72%  4612 1412s
  2080    82 -23706.998   24  121 -24142.801 -22036.782  8.72%  4396 1429s
  2266    40 -24099.652   14  468 -24142.801 -22460.943  6.97%  4205 1444s
  2373    12 -22907.657   10  516 -24142.801 -22812.736  5.51%  4147 1454s
  2434     7 -22956.504   11  509 -24142.801 -22812.736  5.51%  4129 1465s
  2449     7 -23130.989   12  557 -24142.801 -22959.339  4.90%  4126 1478s
  2457    10 infeasible   13      -24142.801 -23275.236  3.59%  4146 1487s
  2466    24 -23982.940   15  505 -24142.801 -23377.871  3.17%  4163 1497s
  2490    28 infeasible   16      -24142.801 -23517.637  2.59%  4166 1516s
  2532    13 infeasible   14      -24142.801 -23693.187  1.86%  4216 1527s
  2571     2     cutoff   19      -24142.801 -23775.628  1.52%  4248 1537s

Cutting planes:
  Learned: 6
  Implied bound: 202
  MIR: 2867
  Flow cover: 3851
  Inf proof: 1
  Zero half: 12
  RLT: 88
  Relax-and-lift: 705

Explored 2588 nodes (11742625 simplex iterations) in 1538.11 seconds (3943.92 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24142.8 -24143.9 -24146.2 ... -24267
No other solutions better than -24142.8

Optimal solution found (tolerance 1.00e-06)
Best objective -2.414280052050e+04, best bound -2.414280052050e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1538.15s
  Master Objective (UB) = -24142.80, θ = 87212.58
  Upper Bound (UB) = -24142.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87212.58
  [DEBUG]   ✓ Scenario 0: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 87212.58 ≤ Q = 87212.58 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 87212.58 ≤ Q = 87212.58 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x64f4c070
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9b0b3f90
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6671799.4223
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.087993e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108799.29    0  122 6671799.42 -108799.29   102%     -    0s
H    0     0                    -78932.94263 -108799.29  37.8%     -    0s
H    0     0                    -79358.95317 -108799.29  37.1%     -    0s
     0     0 -83429.990    0  117 -79358.953 -83429.990  5.13%     -    0s
H    0     0                    -81381.58034 -83410.734  2.49%     -    0s
     0     0 -83168.312    0  113 -81381.580 -83168.312  2.20%     -    0s
H    0     0                    -81973.11025 -83152.730  1.44%     -    0s
     0     0 -83027.957    0  111 -81973.110 -83027.957  1.29%     -    0s
     0     0 -83018.758    0  110 -81973.110 -83018.758  1.28%     -    0s
     0     0 -82939.411    0  110 -81973.110 -82939.411  1.18%     -    0s
     0     2 -82939.411    0  110 -81973.110 -82939.411  1.18%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 129

Explored 122 nodes (938 simplex iterations) in 0.17 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 6: -81973.1 -81381.6 -79359 ... 1.42686e+13

Optimal solution found (tolerance 1.00e-06)
Best objective -8.197311024649e+04, best bound -8.197311921683e+04, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 86157.22
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81973.11
  [DEBUG]   S×d_nominal = 168130.33
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168130.33 + -81973.11 = 86157.22
  [DEBUG]   Current θ from Master = 87212.58
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1055.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25198.17
  Lower Bound (LB) = -24470.95
  Gap (UB-LB) = 328.1492, Absolute Gap = 328.1492, Relative Gap = 0.013592
  Not converged yet (gap = 328.15 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 912866 nonzeros
Model fingerprint: 0xac5fceba
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 165438 rows and 67158 columns
Presolve time: 2.61s
Presolved: 157035 rows, 66142 columns, 970409 nonzeros
Variable types: 63883 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402581.1845
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 1065
 AA' NZ     : 4.364e+06
 Factor NZ  : 1.187e+07 (roughly 200 MB of memory)
 Factor Ops : 4.312e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.23612260e+07  2.78994335e+08  2.54e+05 2.66e+01  9.69e+04     5s
   1  -2.82731581e+07  2.62315900e+08  2.15e+05 4.12e+01  8.13e+04     5s
   2  -1.44963087e+07  1.80082783e+08  1.03e+05 1.17e+01  4.09e+04     5s
   3  -7.45501548e+06  1.58129719e+08  5.18e+04 5.79e+00  2.07e+04     5s
   4  -1.29191591e+06  1.08102837e+08  5.31e+03 2.27e+00  2.43e+03     5s
   5  -6.30929130e+05  7.76332854e+07  9.33e+02 1.13e+00  6.14e+02     5s
   6  -5.41777881e+05  3.77962173e+07  5.24e+02 4.38e-01  3.05e+02     5s
   7  -4.30669718e+05  2.79392085e+07  2.02e+02 2.97e-01  1.61e+02     5s
   8  -3.35110842e+05  1.79396800e+07  8.18e+01 1.76e-01  8.56e+01     5s
   9  -2.02563637e+05  1.07107168e+07  1.97e+01 9.86e-02  4.23e+01     5s
  10  -1.32276061e+05  7.25779274e+06  6.81e+00 6.69e-02  2.69e+01     5s
  11  -1.18213940e+05  5.33494994e+06  4.87e+00 4.86e-02  1.96e+01     5s
  12  -1.05660657e+05  3.83177259e+06  3.36e+00 3.47e-02  1.41e+01     5s
  13  -1.01496188e+05  3.19607581e+06  2.78e+00 2.88e-02  1.17e+01     5s
  14  -8.13867925e+04  2.10022654e+06  1.01e+00 1.92e-02  7.67e+00     5s
  15  -6.48557351e+04  9.16683782e+05  3.36e-01 8.28e-03  3.44e+00     5s
  16  -5.40118650e+04  3.26623896e+05  1.94e-01 2.97e-03  1.33e+00     5s
  17  -4.31824045e+04  2.14936097e+05  1.29e-01 2.18e-03  9.02e-01     5s
  18  -3.71096634e+04  1.59633081e+05  9.82e-02 1.72e-03  6.88e-01     5s
  19  -3.14075891e+04  9.70219227e+04  6.94e-02 1.17e-03  4.49e-01     5s
  20  -2.80088618e+04  6.50765710e+04  5.46e-02 1.17e-03  3.25e-01     6s
  21  -2.66717691e+04  4.35498923e+04  4.93e-02 1.49e-03  2.45e-01     6s
  22  -2.37415354e+04  3.05079820e+04  3.74e-02 1.38e-03  1.90e-01     6s
  23  -2.18353157e+04  2.12309429e+04  3.10e-02 1.31e-03  1.50e-01     6s
  24  -2.07760224e+04  1.34948235e+04  2.76e-02 9.97e-04  1.20e-01     6s
  25  -2.00301134e+04  1.05366772e+04  2.54e-02 8.82e-04  1.07e-01     6s
  26  -1.89760133e+04  4.32026151e+03  2.23e-02 6.91e-04  8.14e-02     6s
  27  -1.85598340e+04  3.66859854e+03  2.11e-02 6.59e-04  7.77e-02     6s
  28  -1.73765924e+04  2.27741967e+03  1.82e-02 5.88e-04  6.87e-02     6s
  29  -1.66254814e+04  1.22811058e+03  1.64e-02 5.37e-04  6.24e-02     6s
  30  -1.57604034e+04 -7.91077032e+02  1.43e-02 4.44e-04  5.23e-02     6s
  31  -1.53077098e+04 -2.16439523e+03  1.30e-02 3.78e-04  4.59e-02     6s
  32  -1.44143585e+04 -3.45720606e+03  1.09e-02 3.08e-04  3.83e-02     6s
  33  -1.40224653e+04 -4.75308565e+03  9.95e-03 3.32e-04  3.24e-02     6s
  34  -1.27226908e+04 -5.60142934e+03  7.33e-03 2.55e-04  2.49e-02     6s
  35  -1.18637680e+04 -6.14044040e+03  5.63e-03 2.00e-04  2.00e-02     6s
  36  -1.13698117e+04 -7.19417978e+03  4.76e-03 1.21e-04  1.46e-02     7s
  37  -1.08521239e+04 -7.40951789e+03  3.84e-03 1.02e-04  1.20e-02     7s
  38  -1.04231721e+04 -7.88199873e+03  3.08e-03 5.82e-05  8.88e-03     7s
  39  -1.00127658e+04 -8.09580734e+03  2.35e-03 1.11e-04  6.70e-03     7s
  40  -9.65785962e+03 -8.20324183e+03  1.73e-03 8.63e-05  5.09e-03     7s
  41  -9.45455118e+03 -8.28039025e+03  1.40e-03 7.60e-05  4.10e-03     7s
  42  -9.08305215e+03 -8.37591715e+03  7.61e-04 5.43e-05  2.47e-03     7s
  43  -8.94471613e+03 -8.47034894e+03  5.20e-04 6.15e-05  1.66e-03     7s
  44  -8.85746805e+03 -8.51713531e+03  3.75e-04 5.68e-05  1.19e-03     7s
  45  -8.83336798e+03 -8.53370920e+03  3.36e-04 4.70e-05  1.05e-03     7s
  46  -8.78628926e+03 -8.55248942e+03  2.59e-04 3.62e-05  8.17e-04     7s
  47  -8.76822469e+03 -8.57008693e+03  2.30e-04 2.73e-05  6.93e-04     7s
  48  -8.74369873e+03 -8.57713026e+03  1.90e-04 2.35e-05  5.82e-04     7s
  49  -8.72023936e+03 -8.58993692e+03  1.54e-04 1.96e-05  4.56e-04     7s
  50  -8.71626243e+03 -8.59394417e+03  1.47e-04 1.73e-05  4.28e-04     7s
  51  -8.70614791e+03 -8.59477313e+03  1.31e-04 1.65e-05  3.89e-04     8s
  52  -8.69362804e+03 -8.59807682e+03  1.10e-04 1.40e-05  3.34e-04     8s
  53  -8.67914373e+03 -8.60879074e+03  8.56e-05 8.54e-06  2.46e-04     8s
  54  -8.65833711e+03 -8.60958536e+03  5.42e-05 8.12e-06  1.70e-04     8s
  55  -8.65686092e+03 -8.61334738e+03  5.20e-05 5.75e-06  1.52e-04     8s
  56  -8.65488736e+03 -8.61416643e+03  4.87e-05 5.39e-06  1.42e-04     8s
  57  -8.65041110e+03 -8.61473918e+03  4.19e-05 4.85e-06  1.25e-04     8s
  58  -8.63417577e+03 -8.61840169e+03  1.65e-05 2.39e-06  5.51e-05     8s
  59  -8.63200730e+03 -8.62021688e+03  1.34e-05 1.27e-06  4.12e-05     8s
  60  -8.63147313e+03 -8.62045558e+03  1.26e-05 1.15e-06  3.85e-05     8s
  61  -8.63120338e+03 -8.62065201e+03  1.21e-05 1.06e-06  3.69e-05     8s
  62  -8.63010629e+03 -8.62090823e+03  1.03e-05 9.64e-07  3.22e-05     8s
  63  -8.62798800e+03 -8.62122888e+03  6.86e-06 8.41e-07  2.37e-05     8s
  64  -8.62751852e+03 -8.62139313e+03  6.21e-06 7.69e-07  2.14e-05     9s
  65  -8.62692260e+03 -8.62229036e+03  5.23e-06 3.33e-07  1.62e-05     9s
  66  -8.62593442e+03 -8.62272107e+03  3.76e-06 1.57e-07  1.13e-05     9s
  67  -8.62552549e+03 -8.62281572e+03  3.17e-06 1.19e-07  9.49e-06     9s
  68  -8.62478332e+03 -8.62292226e+03  2.03e-06 2.08e-07  6.52e-06     9s
  69  -8.62465968e+03 -8.62298420e+03  1.87e-06 1.64e-07  5.87e-06     9s
  70  -8.62460030e+03 -8.62300391e+03  1.79e-06 1.58e-07  5.60e-06     9s
  71  -8.62435314e+03 -8.62303156e+03  1.46e-06 1.40e-07  4.63e-06     9s
  72  -8.62428861e+03 -8.62308606e+03  1.37e-06 1.11e-07  4.22e-06     9s
  73  -8.62413943e+03 -8.62313420e+03  1.17e-06 7.52e-08  3.52e-06     9s
  74  -8.62383502e+03 -8.62316579e+03  7.72e-07 6.90e-08  2.35e-06     9s
  75  -8.62366646e+03 -8.62319537e+03  5.43e-07 4.43e-08  1.65e-06     9s
  76  -8.62349070e+03 -8.62321341e+03  3.11e-07 2.39e-08  9.73e-07     9s
  77  -8.62334686e+03 -8.62323725e+03  1.20e-07 6.44e-09  3.85e-07    10s
  78  -8.62328506e+03 -8.62324350e+03  6.26e-08 2.60e-09  1.46e-07    10s
  79  -8.62327426e+03 -8.62324643e+03  4.24e-08 1.88e-09  9.77e-08    10s
  80  -8.62326426e+03 -8.62324748e+03  4.05e-07 6.71e-09  5.89e-08    10s
  81  -8.62325756e+03 -8.62324854e+03  2.06e-07 3.85e-09  3.17e-08    10s
  82  -8.62325538e+03 -8.62324913e+03  1.47e-07 2.28e-09  2.19e-08    10s
  83  -8.62325195e+03 -8.62324953e+03  5.13e-08 1.05e-09  8.50e-09    10s
  84  -8.62325134e+03 -8.62324959e+03  3.75e-08 8.98e-10  6.15e-09    10s
  85  -8.62325027e+03 -8.62324982e+03  4.99e-07 1.66e-09  1.70e-09    10s
  86  -8.62325001e+03 -8.62324996e+03  9.00e-08 2.87e-09  2.05e-10    10s

Barrier solved model in 86 iterations and 10.10 seconds (21.93 work units)
Optimal objective -8.62325001e+03


Root crossover log...

  125770 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   13597 PPushes remaining with PInf 9.1034384e-05                14s
     947 PPushes remaining with PInf 2.2065825e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.7940143e+02     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   82385   -8.6232500e+03   0.000000e+00   4.794014e+02     15s
   82642   -8.6232500e+03   0.000000e+00   0.000000e+00     16s
   82642   -8.6232500e+03   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 1.95s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -8.623250e+03, 82642 iterations, 14.35 seconds (32.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -8623.2500    0  447 -205910.05 -8623.2500  95.8%     -   18s
H    0     0                    -78216.02995 -8623.2500  89.0%     -   19s
H    0     0                    -51054.43358 -8623.2500  83.1%     -   19s
H    0     0                    -24680.20747 -8623.2500  65.1%     -   19s
H    0     0                    -24631.43969 -8623.2500  65.0%     -   20s
H    0     0                    -24608.14980 -8623.2500  65.0%     -   20s
     0     0 -12421.639    0  468 -24608.150 -12421.639  49.5%     -   69s
H    0     0                    -24555.87043 -12422.275  49.4%     -   69s
H    0     0                    -24520.52483 -12422.275  49.3%     -   70s
H    0     0                    -24499.43567 -12422.275  49.3%     -   70s
H    0     0                    -24496.73087 -12422.275  49.3%     -   70s
H    0     0                    -24492.01230 -12422.275  49.3%     -   70s
     0     0 -12662.347    0  466 -24492.012 -12662.347  48.3%     -   86s
     0     0 -12709.722    0  465 -24492.012 -12709.722  48.1%     -   93s
     0     0 -12809.250    0  463 -24492.012 -12809.250  47.7%     -   99s
     0     0 -12810.985    0  468 -24492.012 -12810.985  47.7%     -  100s
     0     0 -12845.539    0  473 -24492.012 -12845.539  47.6%     -  103s
     0     0 -12891.489    0  475 -24492.012 -12891.489  47.4%     -  107s
     0     0 -13000.581    0  486 -24492.012 -13000.581  46.9%     -  110s
     0     0 -13048.876    0  486 -24492.012 -13048.876  46.7%     -  115s
     0     0 -13050.855    0  484 -24492.012 -13050.855  46.7%     -  116s
     0     0 -13096.124    0  471 -24492.012 -13096.124  46.5%     -  121s
     0     0 -13098.635    0  473 -24492.012 -13098.635  46.5%     -  122s
     0     0 -13098.635    0  473 -24492.012 -13098.635  46.5%     -  124s
     0     0 -15433.058    0  601 -24492.012 -15433.058  37.0%     -  156s
     0     0 -15676.947    0  617 -24492.012 -15676.947  36.0%     -  165s
     0     0 -15786.054    0  631 -24492.012 -15786.054  35.5%     -  170s
     0     0 -15801.735    0  634 -24492.012 -15801.735  35.5%     -  173s
     0     0 -15813.066    0  632 -24492.012 -15813.066  35.4%     -  174s
     0     0 -15939.067    0  675 -24492.012 -15939.067  34.9%     -  184s
     0     0 -15955.655    0  683 -24492.012 -15955.655  34.9%     -  187s
     0     0 -15955.695    0  683 -24492.012 -15955.695  34.9%     -  188s
     0     0 -17936.426    0  755 -24492.012 -17936.426  26.8%     -  238s
H    0     0                    -24339.36638 -17936.971  26.3%     -  239s
H    0     0                    -24338.98460 -17936.971  26.3%     -  239s
H    0     0                    -24325.25893 -17936.971  26.3%     -  239s
     0     0 -18166.220    0  812 -24325.259 -18166.220  25.3%     -  253s
     0     0 -18279.785    0  766 -24325.259 -18279.785  24.9%     -  262s
     0     0 -18334.585    0  769 -24325.259 -18334.585  24.6%     -  268s
     0     0 -18348.616    0  764 -24325.259 -18348.616  24.6%     -  271s
     0     0 -18370.303    0  762 -24325.259 -18370.303  24.5%     -  274s
     0     0 -18386.295    0  836 -24325.259 -18386.295  24.4%     -  277s
     0     0 -18388.195    0  774 -24325.259 -18388.195  24.4%     -  279s
     0     0 -18388.594    0  770 -24325.259 -18388.594  24.4%     -  281s
     0     0 -19090.255    0  831 -24325.259 -19090.255  21.5%     -  314s
H    0     0                    -24299.22003 -19090.735  21.4%     -  314s
     0     0 -19279.576    0  894 -24299.220 -19279.576  20.7%     -  327s
     0     0 -19299.056    0  832 -24299.220 -19299.056  20.6%     -  332s
     0     0 -19325.826    0  832 -24299.220 -19325.826  20.5%     -  337s
     0     0 -19334.275    0  836 -24299.220 -19334.275  20.4%     -  340s
     0     0 -19355.948    0  831 -24299.220 -19355.948  20.3%     -  344s
     0     0 -19391.425    0  898 -24299.220 -19391.425  20.2%     -  349s
     0     0 -19394.711    0  901 -24299.220 -19394.711  20.2%     -  351s
     0     0 -19397.391    0  838 -24299.220 -19397.391  20.2%     -  353s
     0     0 -19397.528    0  836 -24299.220 -19397.528  20.2%     -  354s
     0     0 -19598.951    0  824 -24299.220 -19598.951  19.3%     -  373s
H    0     0                    -24284.39075 -19599.006  19.3%     -  374s
H    0     0                    -24280.34323 -19599.006  19.3%     -  374s
H    0     0                    -24278.82477 -19599.006  19.3%     -  374s
     0     0 -19679.125    0  754 -24278.825 -19679.125  18.9%     -  382s
     0     0 -19727.860    0  836 -24278.825 -19727.860  18.7%     -  391s
     0     0 -19740.275    0  860 -24278.825 -19740.275  18.7%     -  395s
     0     0 -19746.538    0  857 -24278.825 -19746.538  18.7%     -  399s
     0     0 -19747.507    0  861 -24278.825 -19747.507  18.7%     -  400s
     0     0 -19832.218    0  839 -24278.825 -19832.218  18.3%     -  413s
H    0     0                    -24253.70048 -19832.241  18.2%     -  415s
     0     0 -19845.474    0  916 -24253.700 -19845.474  18.2%     -  422s
     0     0 -19849.195    0  919 -24253.700 -19849.195  18.2%     -  425s
     0     0 -19863.713    0  769 -24253.700 -19863.713  18.1%     -  428s
     0     0 -19872.497    0  999 -24253.700 -19872.497  18.1%     -  431s
     0     0 -19873.618    0  993 -24253.700 -19873.618  18.1%     -  433s
     0     0 -19901.618    0  919 -24253.700 -19901.618  17.9%     -  444s
     0     0 -19913.597    0  925 -24253.700 -19913.597  17.9%     -  448s
     0     0 -19917.798    0  931 -24253.700 -19917.798  17.9%     -  451s
     0     0 -19921.373    0  936 -24253.700 -19921.373  17.9%     -  454s
     0     0 -19921.825    0  940 -24253.700 -19921.825  17.9%     -  455s
     0     0 -19981.246    0  934 -24253.700 -19981.246  17.6%     -  467s
     0     0 -19994.117    0  869 -24253.700 -19994.117  17.6%     -  473s
     0     0 -20025.009    0  791 -24253.700 -20025.009  17.4%     -  481s
     0     0 -20025.009    0  791 -24253.700 -20025.009  17.4%     -  482s
     0     0 -20027.211    0  798 -24253.700 -20027.211  17.4%     -  484s
     0     0 -20027.843    0  804 -24253.700 -20027.843  17.4%     -  485s
     0     0 -20066.425    0  997 -24253.700 -20066.425  17.3%     -  495s
     0     0 -20073.269    0  784 -24253.700 -20073.269  17.2%     -  499s
     0     0 -20075.556    0  928 -24253.700 -20075.556  17.2%     -  502s
     0     0 -20078.704    0  997 -24253.700 -20078.704  17.2%     -  504s
     0     0 -20079.387    0 1003 -24253.700 -20079.387  17.2%     -  506s
     0     0 -20153.133    0  695 -24253.700 -20153.133  16.9%     -  516s
H    0     0                    -24253.20806 -20153.383  16.9%     -  521s
     0     0 -20185.601    0  701 -24253.208 -20185.601  16.8%     -  526s
     0     0 -20188.607    0  713 -24253.208 -20188.607  16.8%     -  528s
     0     0 -20191.505    0  855 -24253.208 -20191.505  16.7%     -  530s
     0     0 -20192.218    0  859 -24253.208 -20192.218  16.7%     -  531s
     0     0 -20209.432    0  856 -24253.208 -20209.432  16.7%     -  539s
     0     0 -20217.736    0  834 -24253.208 -20217.736  16.6%     -  544s
     0     0 -20224.393    0  704 -24253.208 -20224.393  16.6%     -  546s
     0     0 -20227.310    0  845 -24253.208 -20227.310  16.6%     -  549s
     0     0 -20227.898    0  772 -24253.208 -20227.898  16.6%     -  550s
     0     0 -20243.158    0  926 -24253.208 -20243.158  16.5%     -  558s
H    0     0                    -24249.25685 -20243.196  16.5%     -  565s
H    0     0                    -24246.88224 -20243.196  16.5%     -  565s
     0     0 -20247.854    0  934 -24246.882 -20247.854  16.5%     -  568s
     0     0 -20248.020    0  933 -24246.882 -20248.020  16.5%     -  568s
     0     0 -20251.540    0  939 -24246.882 -20251.540  16.5%     -  573s
     0     0 -20252.354    0  942 -24246.882 -20252.354  16.5%     -  575s
     0     0 -20255.838    0  946 -24246.882 -20255.838  16.5%     -  580s
H    0     0                    -24199.02806 -20255.851  16.3%     -  592s
H    0     0                    -24154.93394 -20255.851  16.1%     -  592s
     0     0 -20256.756    0  946 -24154.934 -20256.756  16.1%     -  594s
     0     0 -20257.449    0  712 -24154.934 -20257.449  16.1%     -  597s
     0     0 -20258.359    0  947 -24154.934 -20258.359  16.1%     -  599s
     0     0 -20261.055    0  875 -24154.934 -20261.055  16.1%     -  603s
     0     0 -20261.721    0  875 -24154.934 -20261.721  16.1%     -  610s
H    0     0                    -24151.95549 -20261.721  16.1%     -  658s
     0     2 -20261.721    0  875 -24151.955 -20261.721  16.1%     -  667s
     1     4 -20419.204    1  854 -24151.955 -20261.932  16.1% 20009  676s
     3     8 -20625.513    2  763 -24151.955 -20419.622  15.5% 18172  695s
     7    15 -20666.198    3  530 -24151.955 -20595.461  14.7% 16571  706s
    14    22 -21044.009    4  618 -24151.955 -20625.664  14.6% 12319  741s
    21    44 -21280.922    4  530 -24151.955 -20666.222  14.4% 11920  878s
    43    76 -21764.059    5  454 -24151.955 -20824.775  13.8% 30155  906s
    75   140 -21805.276    6  521 -24151.955 -21093.702  12.7% 20832  933s
   157   150 -23650.162    7  121 -24151.955 -21093.702  12.7% 11860  952s
   214   162 -21869.486    7  579 -24151.955 -21093.702  12.7%  9633  970s
   277   182 -22314.459    8  503 -24151.955 -21093.702  12.7%  8226  991s
   337   192 infeasible    8      -24151.955 -21093.702  12.7%  7379 1010s
   402   181     cutoff    9      -24151.955 -21093.702  12.7%  6694 1030s
   455   174 -23694.656   12   70 -24151.955 -21093.702  12.7%  6274 1050s
   505   161 infeasible    9      -24151.955 -21093.702  12.7%  5988 1071s
   555   160 -21641.395    7  122 -24151.955 -21260.556  12.0%  5767 1091s
   594   150 -22800.105    8   73 -24151.955 -21260.556  12.0%  5744 1110s
   652   139 infeasible    9      -24151.955 -21260.843  12.0%  5536 1132s
   695   145 -22493.135    9  809 -24151.955 -21260.843  12.0%  5514 1155s
   738   150 infeasible   13      -24151.955 -21552.371  10.8%  5471 1177s
   777   180 -23655.867   16  347 -24151.955 -21552.371  10.8%  5453 1197s
   842   186 -23696.688   17  347 -24151.955 -21552.371  10.8%  5274 1214s
   914   183 infeasible   19      -24151.955 -21552.371  10.8%  5087 1238s
   980   172 infeasible   18      -24151.955 -21552.371  10.8%  4957 1261s
  1043   163 infeasible   18      -24151.955 -21552.371  10.8%  4915 1289s
  1087   155 -23516.639   11  586 -24151.955 -21552.371  10.8%  4874 1314s
  1144   151 infeasible   12      -24151.955 -22530.168  6.71%  4909 1344s
  1188   143 infeasible    9      -24151.955 -22530.168  6.71%  4892 1369s
  1251   127 infeasible   15      -24151.955 -22609.749  6.39%  4817 1394s
  1338   109 infeasible   10      -24151.955 -22609.749  6.39%  4701 1414s
  1414   102 infeasible   16      -24151.955 -22609.749  6.39%  4588 1436s
  1521    74 infeasible    8      -24151.955 -23391.072  3.15%  4436 1459s
  1643    43 -23988.272   15  453 -24151.955 -23553.524  2.48%  4265 1481s
  1731    39 -23988.634   13   64 -24151.955 -23553.524  2.48%  4161 1492s
* 1815    39              24    -24149.31521 -23553.524  2.47%  4015 1492s
  1840    11     cutoff   19      -24149.315 -23926.462  0.92%  3978 1505s
* 1855    11              22    -24146.22024 -23926.462  0.91%  3950 1505s

Cutting planes:
  Learned: 3
  Implied bound: 249
  MIR: 3296
  Flow cover: 4790
  Zero half: 6
  RLT: 101
  Relax-and-lift: 694

Explored 1953 nodes (8374233 simplex iterations) in 1507.11 seconds (3435.57 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24146.2 -24149.3 -24152 ... -24278.8
No other solutions better than -24146.2

Optimal solution found (tolerance 1.00e-06)
Best objective -2.414622023773e+04, best bound -2.414622023773e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1507.15s
  Master Objective (UB) = -24146.22, θ = 87011.90
  Upper Bound (UB) = -24146.22

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87011.90
  [DEBUG]   ✓ Scenario 0: θ = 87011.90 ≤ Q = 87011.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87011.90 ≤ Q = 87011.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87011.90 ≤ Q = 87011.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87011.90 ≤ Q = 87011.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87011.90 ≤ Q = 87011.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87011.90 ≤ Q = 87011.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87011.90 ≤ Q = 87011.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87011.90 ≤ Q = 87011.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 87011.90 ≤ Q = 87011.90 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xe710c6c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf18ef394
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.00s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6680537.8448
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.089839e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108983.92    0  122 6680537.84 -108983.92   102%     -    0s
H    0     0                    -79091.81083 -108983.92  37.8%     -    0s
H    0     0                    -79517.82137 -108983.92  37.1%     -    0s
     0     0 -83589.855    0  117 -79517.821 -83589.855  5.12%     -    0s
H    0     0                    -81654.58354 -83568.626  2.34%     -    0s
     0     0 -83326.521    0  114 -81654.584 -83326.521  2.05%     -    0s
H    0     0                    -82246.11345 -83309.585  1.29%     -    0s
     0     0 -83204.211    0  111 -82246.113 -83204.211  1.16%     -    0s
     0     0 -83177.244    0  111 -82246.113 -83177.244  1.13%     -    0s
     0     0 -83097.897    0  111 -82246.113 -83097.897  1.04%     -    0s
     0     2 -83097.897    0  111 -82246.113 -83097.897  1.04%     -    0s

Cutting planes:
  Gomory: 9
  MIR: 142

Explored 70 nodes (755 simplex iterations) in 0.11 seconds (0.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 6: -82246.1 -81654.6 -79517.8 ... 1.42686e+13
No other solutions better than -82246.1

Optimal solution found (tolerance 1.00e-06)
Best objective -8.224611345398e+04, best bound -8.224611345398e+04, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 85848.33
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -82246.11
  [DEBUG]   S×d_nominal = 168094.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168094.45 + -82246.11 = 85848.33
  [DEBUG]   Current θ from Master = 87011.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1163.57 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25309.79
  Lower Bound (LB) = -24470.95
  Gap (UB-LB) = 324.7295, Absolute Gap = 324.7295, Relative Gap = 0.013448
  Not converged yet (gap = 324.73 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956073 nonzeros
Model fingerprint: 0xc2fc13cc
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 173316 rows and 70356 columns
Presolve time: 2.92s
Presolved: 164447 rows, 69184 columns, 1015697 nonzeros
Variable types: 66925 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402510.6796
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.37s

Barrier statistics:
 Dense cols : 1062
 AA' NZ     : 4.724e+06
 Factor NZ  : 1.303e+07 (roughly 200 MB of memory)
 Factor Ops : 4.862e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.23928993e+07  2.91366350e+08  2.55e+05 2.65e+01  9.68e+04     5s
   1  -2.83704740e+07  2.73334647e+08  2.16e+05 4.15e+01  8.14e+04     5s
   2  -1.46503898e+07  1.86784451e+08  1.04e+05 1.71e+00  4.17e+04     5s
   3  -2.29731749e+06  1.91806573e+08  1.26e+04 1.26e+01  5.59e+03     5s
   4  -9.24679587e+05  1.03201398e+08  2.71e+03 2.20e+00  1.37e+03     5s
   5  -6.14307549e+05  8.82957681e+07  7.63e+02 1.62e+00  5.75e+02     5s
   6  -5.33714757e+05  5.03527638e+07  3.59e+02 3.13e-01  2.88e+02     5s
   7  -4.51834979e+05  3.70900559e+07  1.07e+02 9.67e-02  1.58e+02     5s
   8  -3.76930761e+05  2.65054277e+07  3.24e+01 6.63e-02  9.83e+01     5s
   9  -2.90620603e+05  1.64183770e+07  1.04e+01 3.99e-02  5.78e+01     5s
  10  -1.96024285e+05  1.01081094e+07  2.53e+00 2.41e-02  3.47e+01     5s
  11  -1.37704110e+05  5.11855576e+06  1.03e+00 1.20e-02  1.76e+01     6s
  12  -1.16354051e+05  3.97688761e+06  7.00e-01 9.22e-03  1.37e+01     6s
  13  -1.01338337e+05  3.31336987e+06  4.81e-01 7.60e-03  1.14e+01     6s
  14  -9.18365880e+04  2.50774400e+06  3.44e-01 5.70e-03  8.69e+00     6s
  15  -7.56456800e+04  1.82793659e+06  1.85e-01 4.11e-03  6.36e+00     6s
  16  -5.51291096e+04  6.77495660e+05  5.33e-02 2.46e-03  2.44e+00     6s
  17  -4.26478075e+04  2.31757246e+05  3.08e-02 5.51e-04  9.16e-01     6s
  18  -3.64995829e+04  1.60570390e+05  2.34e-02 3.67e-04  6.58e-01     6s
  19  -3.01523482e+04  1.24694864e+05  1.57e-02 3.70e-04  5.17e-01     6s
  20  -2.79867259e+04  1.01913303e+05  1.33e-02 5.64e-04  4.33e-01     6s
  21  -2.48787257e+04  6.22451015e+04  1.01e-02 9.19e-04  2.91e-01     6s
  22  -2.22419241e+04  3.91889050e+04  7.70e-03 2.01e-03  2.05e-01     6s
  23  -2.06863009e+04  2.13142029e+04  6.44e-03 2.82e-03  1.40e-01     6s
  24  -1.94795957e+04  1.44227651e+04  5.59e-03 2.49e-03  1.13e-01     6s
  25  -1.80679200e+04  1.03762740e+04  4.66e-03 2.07e-03  9.49e-02     6s
  26  -1.70964888e+04  7.50802400e+03  4.11e-03 1.74e-03  8.21e-02     6s
  27  -1.65087801e+04  3.05329951e+03  3.78e-03 1.35e-03  6.53e-02     6s
  28  -1.60088938e+04  1.00568094e+03  3.49e-03 1.13e-03  5.68e-02     7s
  29  -1.54765477e+04  5.66755241e+01  3.18e-03 1.03e-03  5.18e-02     7s
  30  -1.51643169e+04 -1.94594286e+03  3.01e-03 8.45e-04  4.41e-02     7s
  31  -1.49432626e+04 -2.37403083e+03  2.89e-03 8.08e-04  4.19e-02     7s
  32  -1.42094690e+04 -3.70815067e+03  2.51e-03 6.51e-04  3.50e-02     7s
  33  -1.32198209e+04 -4.85371632e+03  2.04e-03 5.01e-04  2.79e-02     7s
  34  -1.24848306e+04 -5.84839793e+03  1.71e-03 3.79e-04  2.21e-02     7s
  35  -1.16945070e+04 -6.33281865e+03  1.35e-03 3.07e-04  1.79e-02     7s
  36  -1.13478667e+04 -7.45707309e+03  1.20e-03 1.46e-04  1.30e-02     7s
  37  -1.04885185e+04 -7.60820031e+03  8.10e-04 1.25e-04  9.61e-03     7s
  38  -1.01203558e+04 -7.86196484e+03  6.50e-04 8.77e-05  7.54e-03     7s
  39  -9.59428983e+03 -8.01082349e+03  4.24e-04 6.88e-05  5.28e-03     7s
  40  -9.29157443e+03 -8.38447791e+03  2.95e-04 2.18e-05  3.03e-03     8s
  41  -9.07220367e+03 -8.45935827e+03  1.97e-04 1.27e-05  2.04e-03     8s
  42  -8.95592942e+03 -8.47405271e+03  1.49e-04 1.11e-05  1.61e-03     8s
  43  -8.93553958e+03 -8.48900133e+03  1.41e-04 9.48e-06  1.49e-03     8s
  44  -8.89713454e+03 -8.50463067e+03  1.25e-04 7.81e-06  1.31e-03     8s
  45  -8.83154750e+03 -8.51757090e+03  9.77e-05 6.51e-06  1.05e-03     8s
  46  -8.82852832e+03 -8.52779689e+03  9.64e-05 5.52e-06  1.00e-03     8s
  47  -8.76880483e+03 -8.54323652e+03  7.18e-05 4.32e-06  7.53e-04     8s
  48  -8.75252632e+03 -8.56668595e+03  6.47e-05 2.18e-06  6.20e-04     8s
  49  -8.70425766e+03 -8.57008666e+03  4.35e-05 1.95e-06  4.48e-04     8s
  50  -8.69420041e+03 -8.57181946e+03  3.91e-05 1.83e-06  4.08e-04     8s
  51  -8.66561483e+03 -8.57549960e+03  2.86e-05 1.43e-06  3.01e-04     9s
  52  -8.66131529e+03 -8.57739477e+03  2.70e-05 1.32e-06  2.80e-04     9s
  53  -8.65890558e+03 -8.57966781e+03  2.60e-05 1.15e-06  2.64e-04     9s
  54  -8.65619678e+03 -8.58102417e+03  2.49e-05 1.07e-06  2.51e-04     9s
  55  -8.65295789e+03 -8.58270426e+03  2.35e-05 9.60e-07  2.34e-04     9s
  56  -8.63986146e+03 -8.58933828e+03  1.76e-05 6.91e-07  1.69e-04     9s
  57  -8.63536823e+03 -8.59248553e+03  1.57e-05 6.55e-07  1.43e-04     9s
  58  -8.62513757e+03 -8.59388666e+03  1.13e-05 2.20e-07  1.04e-04     9s
  59  -8.62138862e+03 -8.59474743e+03  9.73e-06 1.72e-07  8.89e-05     9s
  60  -8.61454541e+03 -8.59553871e+03  6.88e-06 3.90e-07  6.34e-05     9s
  61  -8.61123427e+03 -8.59594990e+03  5.48e-06 1.60e-07  5.10e-05     9s
  62  -8.60913032e+03 -8.59623152e+03  4.59e-06 1.33e-07  4.30e-05    10s
  63  -8.60731177e+03 -8.59675842e+03  3.81e-06 1.69e-07  3.52e-05    10s
  64  -8.60326759e+03 -8.59713079e+03  2.10e-06 4.43e-07  2.05e-05    10s
  65  -8.60162625e+03 -8.59719685e+03  1.45e-06 4.10e-07  1.48e-05    10s
  66  -8.60129072e+03 -8.59727318e+03  1.31e-06 3.71e-07  1.34e-05    10s
  67  -8.60107337e+03 -8.59733560e+03  1.22e-06 3.42e-07  1.25e-05    10s
  68  -8.60068579e+03 -8.59758176e+03  1.06e-06 2.26e-07  1.04e-05    10s
  69  -8.60029766e+03 -8.59761201e+03  8.97e-07 2.06e-07  8.96e-06    10s
  70  -8.60013367e+03 -8.59766689e+03  8.33e-07 1.73e-07  8.23e-06    10s
  71  -8.59955992e+03 -8.59785911e+03  5.98e-07 8.19e-08  5.68e-06    10s
  72  -8.59833979e+03 -8.59798507e+03  1.01e-07 3.31e-09  1.19e-06    11s
  73  -8.59811009e+03 -8.59802584e+03  4.43e-07 2.98e-08  2.82e-07    11s
  74  -8.59805248e+03 -8.59803189e+03  1.87e-07 7.26e-09  6.88e-08    11s
  75  -8.59803904e+03 -8.59803353e+03  5.42e-08 1.03e-09  1.84e-08    11s
  76  -8.59803566e+03 -8.59803382e+03  1.66e-07 2.46e-09  6.15e-09    11s
  77  -8.59803403e+03 -8.59803386e+03  6.60e-07 2.86e-10  6.71e-10    11s
  78  -8.59803397e+03 -8.59803386e+03  4.20e-07 5.16e-10  4.28e-10    11s
  79  -8.59803387e+03 -8.59803386e+03  7.61e-09 3.76e-11  8.00e-12    11s

Barrier solved model in 79 iterations and 11.12 seconds (22.87 work units)
Optimal objective -8.59803387e+03


Root crossover log...

  130420 DPushes remaining with DInf 0.0000000e+00                11s
   13614 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

    4559 PPushes remaining with PInf 1.7524010e-06                17s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1886038e-10     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   65251   -8.5980339e+03   0.000000e+00   0.000000e+00     17s
   65251   -8.5980339e+03   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective -8.598034e+03, 65251 iterations, 13.59 seconds (25.86 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -8598.0339    0  453 -205910.05 -8598.0339  95.8%     -   18s
H    0     0                    -25503.05987 -8598.0339  66.3%     -   18s
H    0     0                    -25311.77464 -8598.0339  66.0%     -   19s
H    0     0                    -25070.72808 -8598.0339  65.7%     -   19s
H    0     0                    -24897.53583 -8598.0339  65.5%     -   20s
H    0     0                    -24890.28220 -8598.0339  65.5%     -   20s
H    0     0                    -24828.61655 -8598.0339  65.4%     -   20s
H    0     0                    -24826.90622 -8598.0339  65.4%     -   20s
     0     0 -12748.685    0  471 -24826.906 -12748.685  48.6%     -   76s
H    0     0                    -24698.13886 -12750.058  48.4%     -   78s
H    0     0                    -24640.39061 -12750.058  48.3%     -   78s
H    0     0                    -24592.10838 -12750.058  48.2%     -   78s
H    0     0                    -24570.56975 -12750.058  48.1%     -   78s
H    0     0                    -24568.37659 -12750.058  48.1%     -   78s
H    0     0                    -24565.85117 -12750.058  48.1%     -   78s
     0     0 -13112.380    0  558 -24565.851 -13112.380  46.6%     -   99s
     0     0 -13180.654    0  574 -24565.851 -13180.654  46.3%     -  107s
     0     0 -13289.610    0  567 -24565.851 -13289.610  45.9%     -  118s
     0     0 -13312.389    0  566 -24565.851 -13312.389  45.8%     -  126s
     0     0 -13312.400    0  567 -24565.851 -13312.400  45.8%     -  127s
     0     0 -15532.845    0  642 -24565.851 -15532.845  36.8%     -  193s
H    0     0                    -24562.65747 -15536.362  36.7%     -  194s
H    0     0                    -24553.49282 -15536.362  36.7%     -  194s
H    0     0                    -24534.92084 -15536.362  36.7%     -  194s
     0     0 -15853.899    0  643 -24534.921 -15853.899  35.4%     -  221s
     0     0 -15917.576    0  660 -24534.921 -15917.576  35.1%     -  230s
     0     0 -15929.233    0  660 -24534.921 -15929.233  35.1%     -  235s
     0     0 -15950.678    0  654 -24534.921 -15950.678  35.0%     -  243s
     0     0 -15995.842    0  651 -24534.921 -15995.842  34.8%     -  253s
     0     0 -16008.399    0  647 -24534.921 -16008.399  34.8%     -  259s
     0     0 -16053.868    0  641 -24534.921 -16053.868  34.6%     -  270s
     0     0 -16087.028    0  641 -24534.921 -16087.028  34.4%     -  281s
     0     0 -16099.129    0  665 -24534.921 -16099.129  34.4%     -  285s
     0     0 -16099.621    0  657 -24534.921 -16099.621  34.4%     -  287s
     0     0 -17685.199    0  772 -24534.921 -17685.199  27.9%     -  375s
H    0     0                    -24513.90301 -17686.028  27.9%     -  376s
H    0     0                    -24375.33741 -17686.028  27.4%     -  376s
H    0     0                    -24331.67815 -17686.028  27.3%     -  376s
H    0     0                    -24313.69447 -17686.028  27.3%     -  377s
H    0     0                    -24306.79850 -17686.028  27.2%     -  377s
H    0     0                    -24303.12999 -17686.028  27.2%     -  377s
H    0     0                    -24301.77884 -17686.028  27.2%     -  377s
H    0     0                    -24297.28300 -17686.028  27.2%     -  377s
H    0     0                    -24295.09597 -17686.028  27.2%     -  377s
H    0     0                    -24273.28500 -17686.028  27.1%     -  377s
     0     0 -17878.698    0  753 -24273.285 -17878.698  26.3%     -  401s
     0     0 -17908.357    0  760 -24273.285 -17908.357  26.2%     -  417s
     0     0 -17973.663    0  770 -24273.285 -17973.663  26.0%     -  428s
     0     0 -17977.408    0  772 -24273.285 -17977.408  25.9%     -  433s
     0     0 -17982.445    0  771 -24273.285 -17982.445  25.9%     -  441s
     0     0 -17987.274    0  774 -24273.285 -17987.274  25.9%     -  447s
     0     0 -17990.276    0  771 -24273.285 -17990.276  25.9%     -  452s
     0     0 -18162.655    0  765 -24273.285 -18162.655  25.2%     -  475s
     0     0 -18180.613    0  773 -24273.285 -18180.613  25.1%     -  482s
     0     0 -18223.669    0  760 -24273.285 -18223.669  24.9%     -  494s
     0     0 -18236.861    0  769 -24273.285 -18236.861  24.9%     -  500s
     0     0 -18265.495    0  822 -24273.285 -18265.495  24.8%     -  507s
     0     0 -18275.227    0  828 -24273.285 -18275.227  24.7%     -  511s
     0     0 -18275.475    0  832 -24273.285 -18275.475  24.7%     -  512s
     0     0 -18942.451    0  864 -24273.285 -18942.451  22.0%     -  577s
     0     0 -19147.704    0  798 -24273.285 -19147.704  21.1%     -  606s
     0     0 -19209.906    0  795 -24273.285 -19209.906  20.9%     -  620s
     0     0 -19230.888    0  809 -24273.285 -19230.888  20.8%     -  629s
     0     0 -19237.724    0  806 -24273.285 -19237.724  20.7%     -  632s
     0     0 -19240.646    0  795 -24273.285 -19240.646  20.7%     -  635s
     0     0 -19243.290    0  806 -24273.285 -19243.290  20.7%     -  638s
     0     0 -19246.604    0  805 -24273.285 -19246.604  20.7%     -  641s
     0     0 -19248.599    0  815 -24273.285 -19248.599  20.7%     -  644s
     0     0 -19249.200    0  813 -24273.285 -19249.200  20.7%     -  645s
     0     0 -19432.937    0  791 -24273.285 -19432.937  19.9%     -  675s
     0     0 -19459.555    0  799 -24273.285 -19459.555  19.8%     -  689s
     0     0 -19463.026    0  816 -24273.285 -19463.026  19.8%     -  692s
     0     0 -19467.194    0  886 -24273.285 -19467.194  19.8%     -  699s
     0     0 -19470.433    0  960 -24273.285 -19470.433  19.8%     -  705s
     0     0 -19471.208    0  887 -24273.285 -19471.208  19.8%     -  707s
     0     0 -19572.643    0  814 -24273.285 -19572.643  19.4%     -  733s
H    0     0                    -24268.32125 -19572.689  19.3%     -  738s
H    0     0                    -24245.64306 -19572.689  19.3%     -  738s
     0     0 -19593.171    0  892 -24245.643 -19593.171  19.2%     -  748s
     0     0 -19601.310    0  808 -24245.643 -19601.310  19.2%     -  755s
     0     0 -19608.845    0  821 -24245.643 -19608.845  19.1%     -  760s
     0     0 -19615.231    0  821 -24245.643 -19615.231  19.1%     -  769s
     0     0 -19616.336    0  816 -24245.643 -19616.336  19.1%     -  770s
     0     0 -19701.127    0  818 -24245.643 -19701.127  18.7%     -  790s
     0     0 -19750.397    0  826 -24245.643 -19750.397  18.5%     -  807s
     0     0 -19767.245    0  978 -24245.643 -19767.245  18.5%     -  816s
     0     0 -19768.300    0  981 -24245.643 -19768.300  18.5%     -  819s
     0     0 -19847.612    0  907 -24245.643 -19847.612  18.1%     -  844s
     0     0 -19866.318    0  896 -24245.643 -19866.318  18.1%     -  853s
     0     0 -19876.012    0  908 -24245.643 -19876.012  18.0%     -  858s
     0     0 -19877.646    0  907 -24245.643 -19877.646  18.0%     -  862s
     0     0 -19878.119    0  917 -24245.643 -19878.119  18.0%     -  864s
     0     0 -19946.386    0  825 -24245.643 -19946.386  17.7%     -  879s
     0     0 -19959.991    0  917 -24245.643 -19959.991  17.7%     -  893s
     0     0 -19962.919    0  912 -24245.643 -19962.919  17.7%     -  897s
     0     0 -19963.696    0  911 -24245.643 -19963.696  17.7%     -  900s
     0     0 -20000.639    0  738 -24245.643 -20000.639  17.5%     -  917s
H    0     0                    -24243.60420 -20001.338  17.5%     -  926s
H    0     0                    -24241.61482 -20001.338  17.5%     -  926s
H    0     0                    -24226.51371 -20001.338  17.4%     -  926s
     0     0 -20007.042    0  836 -24226.514 -20007.042  17.4%     -  934s
     0     0 -20009.522    0  767 -24226.514 -20009.522  17.4%     -  936s
     0     0 -20011.380    0  843 -24226.514 -20011.380  17.4%     -  939s
     0     0 -20016.332    0  838 -24226.514 -20016.332  17.4%     -  944s
     0     0 -20018.465    0  913 -24226.514 -20018.465  17.4%     -  952s
     0     0 -20019.315    0  841 -24226.514 -20019.315  17.4%     -  954s
     0     0 -20029.510    0  833 -24226.514 -20029.510  17.3%     -  964s
     0     0 -20035.902    0  840 -24226.514 -20035.902  17.3%     -  972s
     0     0 -20037.714    0  913 -24226.514 -20037.714  17.3%     -  976s
     0     0 -20037.851    0  914 -24226.514 -20037.851  17.3%     -  977s
     0     0 -20044.660    0  912 -24226.514 -20044.660  17.3%     -  989s
H    0     0                    -24223.41873 -20045.632  17.2%     -  997s
H    0     0                    -24215.38471 -20045.632  17.2%     -  999s
     0     0 -20048.091    0  825 -24215.385 -20048.091  17.2%     - 1004s
     0     0 -20050.167    0  921 -24215.385 -20050.167  17.2%     - 1007s
     0     0 -20050.534    0  922 -24215.385 -20050.534  17.2%     - 1009s
     0     0 -20061.861    0  929 -24215.385 -20061.861  17.2%     - 1020s
     0     0 -20063.727    0  926 -24215.385 -20063.727  17.1%     - 1024s
     0     0 -20065.127    0  924 -24215.385 -20065.127  17.1%     - 1027s
     0     0 -20069.552    0  919 -24215.385 -20069.552  17.1%     - 1036s
H    0     0                    -24156.08236 -20069.702  16.9%     - 1072s
H    0     0                    -24150.93105 -20069.702  16.9%     - 1079s
H    0     0                    -24150.39080 -20069.702  16.9%     - 1079s
     0     0 -20069.897    0  914 -24150.391 -20069.897  16.9%     - 1082s
     0     0 -20070.790    0  924 -24150.391 -20070.790  16.9%     - 1088s
H    0     0                    -24149.28983 -20070.800  16.9%     - 1089s
     0     0 -20071.138    0  929 -24149.290 -20071.138  16.9%     - 1091s
     0     0 -20072.039    0  926 -24149.290 -20072.039  16.9%     - 1097s
     0     0 -20072.051    0  926 -24149.290 -20072.051  16.9%     - 1110s
     0     2 -20072.059    0  926 -24149.290 -20072.059  16.9%     - 1213s
     1     3 -20317.744    1  560 -24149.290 -20072.059  16.9%  9224 1225s
     2     4 -20136.747    1  814 -24149.290 -20136.747  16.6%  8141 1239s
     3     6 -20438.681    2  646 -24149.290 -20136.861  16.6%  7481 1256s
     5    12 -20533.589    3  626 -24149.290 -20136.861  16.6%  7904 1277s
    11    20 -20553.448    4  646 -24149.290 -20273.339  16.0%  7720 1304s
    23    26 -21068.058    4  155 -24149.290 -20347.518  15.7% 11346 1333s
    31    48 -21544.693    6  157 -24149.290 -20347.518  15.7% 10599 1539s
    53    78 -21597.257    7  141 -24149.290 -20347.878  15.7% 14365 1552s
    85   134 -23113.252    8  128 -24149.290 -20347.878  15.7% 11592 1570s
   159   173 infeasible   10      -24149.290 -20347.878  15.7%  9383 1587s
   267   195 -23549.342    8  109 -24149.290 -20347.878  15.7%  6883 1598s
   366   186 infeasible   12      -24149.290 -20347.878  15.7%  5850 1609s
   454   174 infeasible   12      -24149.290 -20347.878  15.7%  5448 1620s
   538   175 -22987.208    9  141 -24149.290 -20347.878  15.7%  5137 1631s
   622   162 -23085.028    9  122 -24149.290 -20347.878  15.7%  4772 1642s
   714   145 -21914.532    8  192 -24149.290 -20347.878  15.7%  4498 1652s
   777   124 -23598.675    9  130 -24149.290 -20347.878  15.7%  4522 1664s
   846   114 infeasible   10      -24149.290 -20347.878  15.7%  4517 1677s
   901    95 -23491.209   10  120 -24149.290 -20347.878  15.7%  4541 1687s
   947    89 -23741.096   11  125 -24149.290 -20347.878  15.7%  4481 1699s
   989    81 -22458.483   13  466 -24149.290 -20347.878  15.7%  4498 1709s
  1058    67     cutoff   10      -24149.290 -20347.878  15.7%  4374 1720s
  1125    59 -22585.421   15  388 -24149.290 -20347.878  15.7%  4374 1734s
  1196    71 -22922.104   17  535 -24149.290 -20347.878  15.7%  4287 1747s
  1260    74 -23102.751   18  591 -24149.290 -20347.878  15.7%  4221 1758s
  1360    89 -23144.006   19  649 -24149.290 -20347.878  15.7%  4084 1772s
  1432    96 -23210.896   20  457 -24149.290 -20347.878  15.7%  4071 1788s
  1507    98     cutoff   21      -24149.290 -20347.878  15.7%  4072 1804s
  1591    70 -23599.413   19  443 -24149.290 -20347.878  15.7%  4060 1820s
  1670    46 -23848.291   20  440 -24149.290 -20347.878  15.7%  4046 1835s
  1714    31 infeasible   21      -24149.290 -20347.878  15.7%  4102 1850s
  1747    19 -22760.477   12  137 -24149.290 -20347.878  15.7%  4086 1867s
  1771    22 infeasible   13      -24149.290 -20347.878  15.7%  4099 1881s
  1788    16 -22725.185    6  120 -24149.290 -20347.878  15.7%  4118 1899s
  1814    16 -22879.863    7  123 -24149.290 -20347.878  15.7%  4125 1913s
  1826    10 infeasible    8      -24149.290 -20347.878  15.7%  4134 1929s
  1840    11     cutoff    8      -24149.290 -20347.878  15.7%  4187 1944s
  1846    12     cutoff    8      -24149.290 -20347.878  15.7%  4204 1960s
  1854    13 -23939.944   17  469 -24149.290 -20347.878  15.7%  4245 1980s
  1858    15 -24041.048   18  304 -24149.290 -20347.878  15.7%  4259 1993s
  1866    10     cutoff   12      -24149.290 -20347.878  15.7%  4279 2008s
  1875    10     cutoff   11      -24149.290 -20347.878  15.7%  4282 2022s
  1884     8 infeasible   12      -24149.290 -20347.878  15.7%  4301 2033s
  1892     9 -23558.004   14  545 -24149.290 -20621.701  14.6%  4309 2051s
  1895    12 -24002.949   14  485 -24149.290 -20621.701  14.6%  4328 2065s
  1902     6     cutoff   15      -24149.290 -20621.735  14.6%  4355 2082s
  1910     4 infeasible   17      -24149.290 -20621.735  14.6%  4365 2095s
  1914     6 -22631.636    6  279 -24149.290 -21058.086  12.8%  4369 2105s
  1916     6 infeasible    7      -24149.290 -21059.055  12.8%  4370 2119s
  1918     8 -22962.663    6  877 -24149.290 -21875.438  9.42%  4378 2136s
  1920     6 infeasible    9      -24149.290 -21875.438  9.42%  4378 2147s
  1926     5 infeasible    8      -24149.290 -22351.432  7.44%  4382 2162s
  1929     5     cutoff   11      -24149.290 -22351.478  7.44%  4394 2173s
  1933     4 -23475.007   12  390 -24149.290 -22930.248  5.05%  4414 2185s
  1936     3 infeasible   13      -24149.290 -22930.248  5.05%  4415 2197s
  1939     1 infeasible    9      -24149.290 -23475.520  2.79%  4416 2207s
  1942     2 -23815.633   10  626 -24149.290 -23815.633  1.38%  4426 2224s
  1943     1 infeasible   11      -24149.290 -23816.293  1.38%  4424 2233s
  1944     0     cutoff   11      -24149.290 -24149.290  0.00%  4432 2249s

Cutting planes:
  Learned: 4
  Gomory: 2
  Implied bound: 387
  MIR: 3912
  Flow cover: 5320
  Zero half: 15
  RLT: 139
  Relax-and-lift: 979

Explored 1945 nodes (9377699 simplex iterations) in 2249.24 seconds (4698.06 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24149.3 -24150.4 -24150.9 ... -24245.6
No other solutions better than -24149.3

Optimal solution found (tolerance 1.00e-06)
Best objective -2.414928982952e+04, best bound -2.414928982952e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2249.28s
  Master Objective (UB) = -24149.29, θ = 87293.95
  Upper Bound (UB) = -24149.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87293.95
  [DEBUG]   ✓ Scenario 0: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 87293.95 ≤ Q = 87293.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 87293.95 ≤ Q = 87293.95 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e408de7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa1bf7219
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426859e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.01s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6679894.1380
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.086115e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108611.51    0  122 6679894.14 -108611.51   102%     -    0s
H    0     0                    -78781.20414 -108611.51  37.9%     -    0s
H    0     0                    -79207.21468 -108611.51  37.1%     -    0s
     0     0 -83175.653    0  117 -79207.215 -83175.653  5.01%     -    0s
H    0     0                    -81457.17627 -83172.486  2.11%     -    0s
H    0     0                    -81737.05220 -83172.486  1.76%     -    0s
     0     0 -82937.477    0  115 -81737.052 -82937.477  1.47%     -    0s
H    0     0                    -81900.81754 -82921.941  1.25%     -    0s
     0     0 -82672.557    0  116 -81900.818 -82672.557  0.94%     -    0s
     0     0 -82664.485    0   58 -81900.818 -82664.485  0.93%     -    0s
     0     0 -82482.610    0   42 -81900.818 -82482.610  0.71%     -    0s
     0     0 -82433.554    0   50 -81900.818 -82433.554  0.65%     -    0s
     0     0 -82428.962    0   50 -81900.818 -82428.962  0.64%     -    0s
     0     0 -81921.080    0    6 -81900.818 -81921.080  0.02%     -    0s
     0     0 -81910.448    0    1 -81900.818 -81910.448  0.01%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 108
  Flow cover: 7
  RLT: 61
  Relax-and-lift: 10
  BQP: 10

Explored 1 nodes (553 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -81900.8 -81737.1 -81457.2 ... 1.42686e+13
No other solutions better than -81900.8

Optimal solution found (tolerance 1.00e-06)
Best objective -8.190081753965e+04, best bound -8.190081753965e+04, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 86184.40
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81900.82
  [DEBUG]   S×d_nominal = 168085.22
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168085.22 + -81900.82 = 86184.40
  [DEBUG]   Current θ from Master = 87293.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1109.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25258.84
  Lower Bound (LB) = -24470.95
  Gap (UB-LB) = 321.6599, Absolute Gap = 321.6599, Relative Gap = 0.013320
  Not converged yet (gap = 321.66 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 999280 nonzeros
Model fingerprint: 0xf3cc9ee5
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-02, 7e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 181194 rows and 73554 columns
Presolve time: 3.58s
Presolved: 171859 rows, 72226 columns, 1061900 nonzeros
Variable types: 69967 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -402510.6796
Found heuristic solution: objective -205910.0534

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.40s

Barrier statistics:
 Dense cols : 1062
 AA' NZ     : 5.101e+06
 Factor NZ  : 1.401e+07 (roughly 200 MB of memory)
 Factor Ops : 5.253e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -3.24145446e+07  3.03555704e+08  2.55e+05 2.64e+01  9.67e+04     6s
   1  -2.84032981e+07  2.83821427e+08  2.16e+05 3.93e+01  8.14e+04     6s
   2  -1.50905761e+07  1.91834220e+08  1.08e+05 3.13e+00  4.28e+04     6s
   3  -4.93449321e+06  1.95395309e+08  3.25e+04 8.05e+00  1.34e+04     6s
   4  -1.01532694e+06  1.14772551e+08  3.22e+03 1.55e+00  1.62e+03     6s
   5  -6.39166427e+05  8.53536160e+07  8.51e+02 9.12e-01  5.89e+02     6s
   6  -5.64999301e+05  4.28406441e+07  4.91e+02 3.68e-01  3.01e+02     6s
   7  -4.73919548e+05  3.13754632e+07  2.10e+02 2.50e-01  1.67e+02     6s
   8  -3.71194637e+05  1.92649996e+07  6.23e+01 1.36e-01  7.92e+01     6s
   9  -2.78417253e+05  1.49247249e+07  2.29e+01 1.01e-01  5.38e+01     6s
  10  -1.45775331e+05  7.80367528e+06  6.31e+00 4.91e-02  2.63e+01     6s
  11  -1.25171451e+05  6.12754154e+06  4.24e+00 3.83e-02  2.05e+01     6s
  12  -1.12506429e+05  4.36272489e+06  3.04e+00 2.72e-02  1.46e+01     6s
  13  -1.00778041e+05  2.81790799e+06  2.16e+00 1.74e-02  9.45e+00     7s
  14  -8.27090211e+04  1.86312085e+06  1.07e+00 1.14e-02  6.26e+00     7s
  15  -6.31737493e+04  1.06619875e+06  3.97e-01 6.49e-03  3.62e+00     7s
  16  -5.04468299e+04  6.49276284e+05  2.08e-01 3.94e-03  2.24e+00     7s
  17  -3.99237041e+04  2.47215971e+05  1.22e-01 1.72e-03  9.18e-01     7s
  18  -3.36848512e+04  1.14339124e+05  8.43e-02 1.25e-03  4.73e-01     7s
  19  -2.87412476e+04  6.33954251e+04  6.17e-02 1.36e-03  2.94e-01     7s
  20  -2.70599327e+04  5.05184297e+04  5.44e-02 1.25e-03  2.48e-01     7s
  21  -2.44126733e+04  3.40424209e+04  4.41e-02 1.77e-03  1.87e-01     7s
  22  -2.30288156e+04  2.97973017e+04  3.89e-02 1.63e-03  1.69e-01     7s
  23  -2.13304826e+04  2.00135459e+04  3.25e-02 1.24e-03  1.32e-01     7s
  24  -2.00627905e+04  1.13891363e+04  2.81e-02 9.52e-04  1.01e-01     7s
  25  -1.89264278e+04  5.38235679e+03  2.45e-02 7.39e-04  7.77e-02     7s
  26  -1.72199153e+04  3.88634540e+03  1.92e-02 6.61e-04  6.75e-02     7s
  27  -1.66455540e+04  3.55506011e+03  1.75e-02 6.43e-04  6.46e-02     7s
  28  -1.57448636e+04  1.96388237e+03  1.49e-02 5.60e-04  5.66e-02     8s
  29  -1.53214541e+04 -3.34984780e+02  1.38e-02 5.08e-04  4.79e-02     8s
  30  -1.47775522e+04 -6.38455080e+02  1.23e-02 4.94e-04  4.52e-02     8s
  31  -1.44862667e+04 -1.50942119e+03  1.15e-02 4.52e-04  4.15e-02     8s
  32  -1.42861617e+04 -1.74409855e+03  1.10e-02 4.39e-04  4.01e-02     8s
  33  -1.35604093e+04 -3.28430223e+03  9.28e-03 3.73e-04  3.28e-02     8s
  34  -1.29773233e+04 -4.65893703e+03  7.96e-03 3.09e-04  2.66e-02     8s
  35  -1.17011525e+04 -5.24026843e+03  5.25e-03 2.64e-04  2.06e-02     8s
  36  -1.11110814e+04 -6.85839880e+03  4.16e-03 1.36e-04  1.36e-02     8s
  37  -1.05862495e+04 -7.28540694e+03  3.26e-03 1.86e-04  1.06e-02     8s
  38  -9.85961167e+03 -7.70056519e+03  2.03e-03 1.21e-04  6.90e-03     8s
  39  -9.71719288e+03 -7.76971010e+03  1.80e-03 1.11e-04  6.22e-03     8s
  40  -9.45066606e+03 -7.98871066e+03  1.36e-03 7.78e-05  4.67e-03     9s
  41  -8.99588260e+03 -8.16058022e+03  6.45e-04 5.35e-05  2.67e-03     9s
  42  -8.83362467e+03 -8.34588274e+03  3.96e-04 2.67e-05  1.56e-03     9s
  43  -8.78747051e+03 -8.37269545e+03  3.31e-04 2.30e-05  1.33e-03     9s
  44  -8.76499201e+03 -8.39868298e+03  2.99e-04 1.96e-05  1.17e-03     9s
  45  -8.75617900e+03 -8.41128502e+03  2.87e-04 1.80e-05  1.10e-03     9s
  46  -8.71728125e+03 -8.43909823e+03  2.31e-04 1.39e-05  8.89e-04     9s
  47  -8.69231728e+03 -8.45862570e+03  1.93e-04 1.16e-05  7.47e-04     9s
  48  -8.67087270e+03 -8.47369230e+03  1.59e-04 9.81e-06  6.30e-04     9s
  49  -8.65203102e+03 -8.48969855e+03  1.32e-04 8.04e-06  5.19e-04     9s
  50  -8.64182637e+03 -8.49171765e+03  1.17e-04 7.80e-06  4.80e-04     9s
  51  -8.63533759e+03 -8.49844423e+03  1.07e-04 7.07e-06  4.37e-04    10s
  52  -8.62651963e+03 -8.50482638e+03  9.29e-05 6.36e-06  3.89e-04    10s
  53  -8.62095796e+03 -8.51750656e+03  8.39e-05 5.00e-06  3.31e-04    10s
  54  -8.60490594e+03 -8.51880906e+03  5.96e-05 4.86e-06  2.75e-04    10s
  55  -8.59660126e+03 -8.52530791e+03  4.79e-05 4.18e-06  2.28e-04    10s
  56  -8.58832665e+03 -8.53023501e+03  3.70e-05 3.29e-06  1.86e-04    10s
  57  -8.57969670e+03 -8.54426313e+03  2.52e-05 1.70e-06  1.13e-04    10s
  58  -8.57608636e+03 -8.54808796e+03  2.03e-05 1.30e-06  8.95e-05    10s
  59  -8.57534820e+03 -8.54926825e+03  1.90e-05 1.20e-06  8.33e-05    10s
  60  -8.57324167e+03 -8.54990956e+03  1.62e-05 1.21e-06  7.46e-05    10s
  61  -8.56929083e+03 -8.55352786e+03  1.05e-05 1.40e-06  5.04e-05    10s
  62  -8.56703205e+03 -8.55776333e+03  7.25e-06 6.47e-07  2.96e-05    10s
  63  -8.56649985e+03 -8.55869324e+03  6.54e-06 5.53e-07  2.50e-05    11s
  64  -8.56557823e+03 -8.55976676e+03  5.28e-06 3.34e-07  1.86e-05    11s
  65  -8.56496868e+03 -8.56034402e+03  4.41e-06 2.42e-07  1.48e-05    11s
  66  -8.56424742e+03 -8.56059957e+03  3.40e-06 1.98e-07  1.17e-05    11s
  67  -8.56342968e+03 -8.56076400e+03  2.31e-06 1.68e-07  8.53e-06    11s
  68  -8.56313660e+03 -8.56099713e+03  1.91e-06 1.27e-07  6.85e-06    11s
  69  -8.56309162e+03 -8.56102058e+03  1.85e-06 1.23e-07  6.63e-06    11s
  70  -8.56266045e+03 -8.56120864e+03  1.24e-06 8.86e-08  4.65e-06    11s
  71  -8.56248528e+03 -8.56140250e+03  1.00e-06 5.38e-08  3.47e-06    11s
  72  -8.56226650e+03 -8.56143354e+03  7.14e-07 4.85e-08  2.67e-06    11s
  73  -8.56221984e+03 -8.56146767e+03  6.53e-07 4.28e-08  2.41e-06    11s
  74  -8.56193164e+03 -8.56162466e+03  2.65e-07 1.60e-08  9.84e-07    12s
  75  -8.56177011e+03 -8.56170631e+03  6.26e-08 1.71e-08  2.05e-07    12s
  76  -8.56175446e+03 -8.56170698e+03  5.17e-08 1.59e-08  1.52e-07    12s
  77  -8.56174316e+03 -8.56171238e+03  3.87e-08 1.65e-08  9.88e-08    12s
  78  -8.56173605e+03 -8.56171527e+03  3.54e-08 1.31e-07  6.68e-08    12s
  79  -8.56172864e+03 -8.56171614e+03  4.17e-08 6.94e-08  4.02e-08    12s
  80  -8.56172387e+03 -8.56171649e+03  2.47e-08 4.95e-08  2.37e-08    12s
  81  -8.56171821e+03 -8.56171728e+03  4.21e-08 9.06e-09  3.01e-09    12s
  82  -8.56171747e+03 -8.56171738e+03  5.85e-07 4.07e-08  3.19e-10    12s
  83  -8.56171739e+03 -8.56171739e+03  1.73e-08 2.86e-08  8.25e-12    12s

Barrier solved model in 83 iterations and 12.24 seconds (23.58 work units)
Optimal objective -8.56171739e+03


Root crossover log...

  136893 DPushes remaining with DInf 0.0000000e+00                12s
    1447 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

    4731 PPushes remaining with PInf 1.1888641e-06                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.6568474e-02     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70872   -8.5617174e+03   0.000000e+00   7.656847e-02     17s
   70876   -8.5617174e+03   0.000000e+00   0.000000e+00     17s
   70876   -8.5617174e+03   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 5.25s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective -8.561717e+03, 70876 iterations, 17.52 seconds (24.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -8561.7174    0  448 -205910.05 -8561.7174  95.8%     -   23s
H    0     0                    -51245.86946 -8561.7174  83.3%     -   23s
H    0     0                    -44474.80399 -8561.7174  80.7%     -   24s
H    0     0                    -24992.17934 -8561.7174  65.7%     -   24s
H    0     0                    -24730.98017 -8561.7174  65.4%     -   24s
H    0     0                    -24642.19060 -8561.7174  65.3%     -   25s
     0     0 -12571.807    0  468 -24642.191 -12571.807  49.0%     -   92s
H    0     0                    -24519.19830 -12577.766  48.7%     -   93s
H    0     0                    -24511.16428 -12577.766  48.7%     -   93s
H    0     0                    -24455.67264 -12577.766  48.6%     -   93s
     0     0 -12725.950    0  466 -24455.673 -12725.950  48.0%     -  103s
     0     0 -12778.038    0  466 -24455.673 -12778.038  47.8%     -  110s
     0     0 -12789.631    0  471 -24455.673 -12789.631  47.7%     -  113s
     0     0 -12867.598    0  482 -24455.673 -12867.598  47.4%     -  117s
     0     0 -12867.641    0  482 -24455.673 -12867.641  47.4%     -  119s
     0     0 -15496.587    0  621 -24455.673 -15496.587  36.6%     -  188s
     0     0 -15679.418    0  619 -24455.673 -15679.418  35.9%     -  201s
     0     0 -15718.556    0  627 -24455.673 -15718.556  35.7%     -  207s
     0     0 -15736.382    0  619 -24455.673 -15736.382  35.7%     -  211s
     0     0 -15812.474    0  622 -24455.673 -15812.474  35.3%     -  219s
     0     0 -15836.643    0  621 -24455.673 -15836.643  35.2%     -  223s
     0     0 -15857.390    0  629 -24455.673 -15857.390  35.2%     -  229s
     0     0 -15870.142    0  625 -24455.673 -15870.142  35.1%     -  233s
     0     0 -15951.331    0  631 -24455.673 -15951.331  34.8%     -  250s
     0     0 -15953.085    0  626 -24455.673 -15953.085  34.8%     -  254s
     0     0 -16055.851    0  641 -24455.673 -16055.851  34.3%     -  265s
     0     0 -16063.315    0  642 -24455.673 -16063.315  34.3%     -  268s
     0     0 -16067.478    0  645 -24455.673 -16067.478  34.3%     -  273s
     0     0 -16068.397    0  650 -24455.673 -16068.397  34.3%     -  277s
     0     0 -16068.461    0  646 -24455.673 -16068.461  34.3%     -  279s
     0     0 -17758.476    0  744 -24455.673 -17758.476  27.4%     -  371s
H    0     0                    -24391.83642 -17759.482  27.2%     -  372s
H    0     0                    -24282.28385 -17759.482  26.9%     -  373s
     0     0 -18065.269    0  811 -24282.284 -18065.269  25.6%     -  404s
     0     0 -18108.733    0  759 -24282.284 -18108.733  25.4%     -  418s
     0     0 -18121.480    0  810 -24282.284 -18121.480  25.4%     -  430s
     0     0 -18142.021    0  812 -24282.284 -18142.021  25.3%     -  442s
     0     0 -18144.405    0  816 -24282.284 -18144.405  25.3%     -  447s
     0     0 -18168.799    0  813 -24282.284 -18168.799  25.2%     -  454s
     0     0 -18169.503    0  814 -24282.284 -18169.503  25.2%     -  456s
     0     0 -18866.770    0  842 -24282.284 -18866.770  22.3%     -  510s
     0     0 -19008.176    0  778 -24282.284 -19008.176  21.7%     -  528s
     0     0 -19036.545    0  845 -24282.284 -19036.545  21.6%     -  536s
     0     0 -19042.250    0  853 -24282.284 -19042.250  21.6%     -  539s
     0     0 -19050.861    0  852 -24282.284 -19050.861  21.5%     -  543s
     0     0 -19057.926    0  848 -24282.284 -19057.926  21.5%     -  546s
     0     0 -19059.541    0  854 -24282.284 -19059.541  21.5%     -  548s
     0     0 -19074.477    0  854 -24282.284 -19074.477  21.4%     -  552s
     0     0 -19081.951    0  865 -24282.284 -19081.951  21.4%     -  556s
     0     0 -19086.067    0  865 -24282.284 -19086.067  21.4%     -  558s
     0     0 -19169.554    0  855 -24282.284 -19169.554  21.1%     -  569s
     0     0 -19171.534    0  860 -24282.284 -19171.534  21.0%     -  571s
     0     0 -19171.672    0  860 -24282.284 -19171.672  21.0%     -  572s
     0     0 -19424.384    0  923 -24282.284 -19424.384  20.0%     -  615s
     0     0 -19488.836    0  918 -24282.284 -19488.836  19.7%     -  635s
     0     0 -19507.304    0  930 -24282.284 -19507.304  19.7%     -  644s
     0     0 -19512.651    0  943 -24282.284 -19512.651  19.6%     -  649s
     0     0 -19512.999    0  871 -24282.284 -19512.999  19.6%     -  651s
     0     0 -19656.770    0  943 -24282.284 -19656.770  19.0%     -  689s
     0     0 -19717.641    0  804 -24282.284 -19717.641  18.8%     -  709s
     0     0 -19733.648    0  879 -24282.284 -19733.648  18.7%     -  716s
     0     0 -19736.013    0  819 -24282.284 -19736.013  18.7%     -  720s
     0     0 -19737.907    0  830 -24282.284 -19737.907  18.7%     -  722s
     0     0 -19739.167    0  826 -24282.284 -19739.167  18.7%     -  725s
     0     0 -19819.086    0  881 -24282.284 -19819.086  18.4%     -  747s
     0     0 -19838.983    0  828 -24282.284 -19838.983  18.3%     -  755s
     0     0 -19838.983    0  828 -24282.284 -19838.983  18.3%     -  755s
     0     0 -19846.993    0  886 -24282.284 -19846.993  18.3%     -  760s
     0     0 -19848.106    0  885 -24282.284 -19848.106  18.3%     -  761s
     0     0 -20006.030    0  918 -24282.284 -20006.030  17.6%     -  794s
H    0     0                    -24278.81298 -20006.442  17.6%     -  798s
     0     0 -20066.870    0  900 -24278.813 -20066.870  17.3%     -  815s
     0     0 -20090.470    0  905 -24278.813 -20090.470  17.3%     -  829s
     0     0 -20094.487    0  898 -24278.813 -20094.487  17.2%     -  836s
     0     0 -20096.359    0  827 -24278.813 -20096.359  17.2%     -  841s
     0     0 -20098.218    0  896 -24278.813 -20098.218  17.2%     -  845s
     0     0 -20099.942    0  906 -24278.813 -20099.942  17.2%     -  849s
     0     0 -20108.689    0  908 -24278.813 -20108.689  17.2%     -  856s
     0     0 -20112.022    0  915 -24278.813 -20112.022  17.2%     -  859s
     0     0 -20112.806    0  917 -24278.813 -20112.806  17.2%     -  861s
     0     0 -20162.893    0  840 -24278.813 -20162.893  17.0%     -  877s
     0     0 -20171.294    0  824 -24278.813 -20171.294  16.9%     -  882s
     0     0 -20174.735    0  827 -24278.813 -20174.735  16.9%     -  885s
     0     0 -20174.944    0  835 -24278.813 -20174.944  16.9%     -  886s
     0     0 -20196.735    0  853 -24278.813 -20196.735  16.8%     -  900s
H    0     0                    -24276.07656 -20196.780  16.8%     -  903s
H    0     0                    -24274.86177 -20196.780  16.8%     -  903s
     0     0 -20199.819    0  858 -24274.862 -20199.819  16.8%     -  907s
     0     0 -20202.396    0  865 -24274.862 -20202.396  16.8%     -  911s
     0     0 -20204.026    0  866 -24274.862 -20204.026  16.8%     -  912s
     0     0 -20210.923    0  933 -24274.862 -20210.923  16.7%     -  922s
     0     0 -20211.383    0  935 -24274.862 -20211.383  16.7%     -  925s
     0     0 -20216.462    0  939 -24274.862 -20216.462  16.7%     -  935s
H    0     0                    -24273.29835 -20217.010  16.7%     -  937s
H    0     0                    -24254.16037 -20217.010  16.6%     -  937s
H    0     0                    -24245.98677 -20217.010  16.6%     -  937s
H    0     0                    -24217.46687 -20217.010  16.5%     -  937s
     0     0 -20218.894    0 1016 -24217.467 -20218.894  16.5%     -  942s
     0     0 -20219.794    0  948 -24217.467 -20219.794  16.5%     -  944s
     0     0 -20228.851    0  923 -24217.467 -20228.851  16.5%     -  954s
     0     0 -20230.241    0  923 -24217.467 -20230.241  16.5%     -  968s
H    0     0                    -24183.02991 -20230.241  16.3%     -  992s
H    0     0                    -24181.16990 -20230.241  16.3%     -  992s
     0     2 -20230.241    0  923 -24181.170 -20230.241  16.3%     - 1081s
     1     3 -21798.846    1  403 -24181.170 -20230.241  16.3% 32566 1103s
     2     6 -22157.953    2  103 -24181.170 -20230.241  16.3% 19522 1110s
     5     9 -22478.994    3   91 -24181.170 -20312.749  16.0%  9630 1129s
    10    18 -22804.096    4   95 -24181.170 -20319.514  16.0%  9575 1139s
    19    25     cutoff    4      -24181.170 -20582.886  14.9% 10949 1185s
    28    42 -23566.911    6   76 -24181.170 -20582.886  14.9% 11744 1306s
H   29    42                    -24156.08236 -20582.886  14.8% 11339 1306s
    50    57 -22483.973    5  120 -24156.082 -20582.886  14.8% 15596 1314s
    82    82 -22520.078    6  116 -24156.082 -20582.886  14.8% 11748 1327s
H  122   100                    -24151.95549 -20582.886  14.8%  9844 1347s
   182   108 -23465.947    8   92 -24151.955 -20582.886  14.8%  8528 1360s
   259    98 infeasible   11      -24151.955 -20582.886  14.8%  7648 1373s
   329    92 infeasible   10      -24151.955 -20582.886  14.8%  7289 1388s
   397   104 -24033.674   11  434 -24151.955 -20582.886  14.8%  6978 1400s
   470    95 infeasible   12      -24151.955 -20582.886  14.8%  6557 1412s
   568    57 infeasible   13      -24151.955 -20582.886  14.8%  5979 1424s
   660    35 -23913.156   11   73 -24151.955 -20582.886  14.8%  5644 1434s
   708    29     cutoff   12      -24151.955 -20582.886  14.8%  5520 1443s
   761    24 -24109.093   13   38 -24151.955 -20582.886  14.8%  5304 1449s
   812    32 -24139.753   14   25 -24151.955 -20582.886  14.8%  5045 1461s
   885    10 -24140.382   15   26 -24151.955 -20582.886  14.8%  4672 1469s
   945     3     cutoff   16      -24151.955 -20582.886  14.8%  4417 1476s
   962     2     cutoff   30      -24151.955 -20582.886  14.8%  4344 1485s
   963     3 -20666.119    4  632 -24151.955 -20614.803  14.6%  4343 1529s
   964     4 -22365.412    5   83 -24151.955 -20614.803  14.6%  4357 1539s
   965     8 -22451.809    6   77 -24151.955 -20614.803  14.6%  4355 1546s
   969    11     cutoff    7      -24151.955 -20862.837  13.6%  4389 1557s
   974    11 infeasible    9      -24151.955 -20862.837  13.6%  4409 1570s
   980    10 infeasible    7      -24151.955 -20864.859  13.6%  4421 1581s
   989     7 infeasible    8      -24151.955 -20864.859  13.6%  4449 1594s
   996    10 -24110.482   10   38 -24151.955 -20864.859  13.6%  4447 1604s
   999    11 -24133.722   12   42 -24151.955 -20864.859  13.6%  4439 1615s
  1006    12     cutoff   13      -24151.955 -21005.897  13.0%  4460 1629s
  1015    11     cutoff   13      -24151.955 -21005.897  13.0%  4455 1641s
  1020    16 -23549.032    5  805 -24151.955 -21167.172  12.4%  4455 1653s
  1027    18 infeasible   13      -24151.955 -21606.495  10.5%  4469 1669s
  1033    14 -22288.622   13  461 -24151.955 -21606.495  10.5%  4480 1681s
  1047    14 infeasible   14      -24151.955 -21772.747  9.85%  4487 1692s
  1053    10 infeasible   14      -24151.955 -21772.747  9.85%  4501 1701s
  1063    12 -22509.113   15  488 -24151.955 -21821.645  9.65%  4502 1715s
  1071    18 -22746.678   16  464 -24151.955 -22122.952  8.40%  4499 1727s
  1081    33 -22793.927   17  477 -24151.955 -22122.952  8.40%  4535 1739s
  1098    74 -23081.631   18  469 -24151.955 -22122.952  8.40%  4653 1749s
  1139   106 -23151.075   19  456 -24151.955 -22122.952  8.40%  4753 1761s
  1171   135 -23274.975   20  435 -24151.955 -22122.952  8.40%  4891 1772s
  1202   170 -23777.563   21  360 -24151.955 -22122.952  8.40%  4917 1783s
  1247   193 -23796.845   22  362 -24151.955 -22122.952  8.40%  4938 1797s
  1308   185 -23834.993   23  355 -24151.955 -22122.952  8.40%  4936 1811s
  1372   189 infeasible   24      -24151.955 -22122.952  8.40%  4971 1824s
  1431   175 -24095.838   25  489 -24151.955 -22122.952  8.40%  5011 1839s
  1489   177 -24095.909   26  425 -24151.955 -22722.905  5.92%  5072 1855s
  1541   174 infeasible   27      -24151.955 -22722.905  5.92%  5144 1869s
  1603   169 infeasible   21      -24151.955 -22875.046  5.29%  5180 1887s
  1669   166 -23586.520   22  222 -24151.955 -22875.046  5.29%  5184 1905s
  1732   168 infeasible   23      -24151.955 -22875.046  5.29%  5207 1920s
  1806   158 -23461.528   21  527 -24151.955 -23008.871  4.73%  5264 1957s
  1863   150 -23477.635   22  537 -24151.955 -23105.721  4.33%  5318 1986s
  1927   135 -23875.066   23  308 -24151.955 -23130.135  4.23%  5361 2010s
  2009   132 -23936.606   24  308 -24151.955 -23130.135  4.23%  5382 2032s
  2101    60 infeasible   29      -24151.955 -23130.135  4.23%  5413 2050s
  2228    21     cutoff   26      -24151.955 -23130.135  4.23%  5333 2070s
  2300     7 infeasible   25      -24151.955 -23664.276  2.02%  5314 2082s
  2327     4 infeasible   26      -24151.955 -23942.788  0.87%  5314 2092s

Cutting planes:
  Learned: 1
  Implied bound: 314
  MIR: 3509
  Flow cover: 5258
  Zero half: 8
  RLT: 78
  Relax-and-lift: 673

Explored 2338 nodes (13077014 simplex iterations) in 2093.06 seconds (4323.39 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -24152 -24156.1 -24181.2 ... -24276.1
No other solutions better than -24152

Optimal solution found (tolerance 1.00e-06)
Best objective -2.415195548754e+04, best bound -2.415195548754e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2093.14s
  Master Objective (UB) = -24151.96, θ = 87323.70
  Upper Bound (UB) = -24151.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87323.70
  [DEBUG]   ✓ Scenario 0: θ = 87323.70 ≤ Q = 87323.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87323.70 ≤ Q = 87323.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87323.70 ≤ Q = 87323.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 87323.70 ≤ Q = 87323.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 87323.70 ≤ Q = 87323.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x542cd0a8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xabd32f58
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.423471e+13
Presolve removed 2653 rows and 1946 columns
Presolve time: 0.01s
Presolved: 440 rows, 443 columns, 1202 nonzeros
Found heuristic solution: objective 6684650.9112
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.085363e+05, 214 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -108536.34    0  122 6684650.91 -108536.34   102%     -    0s
H    0     0                    -78719.66932 -108536.34  37.9%     -    0s
H    0     0                    -79145.67986 -108536.34  37.1%     -    0s
     0     0 -82867.461    0  126 -79145.680 -82867.461  4.70%     -    0s
H    0     0                    -80037.08658 -82852.816  3.52%     -    0s
     0     0 -82513.568    0  130 -80037.087 -82513.568  3.09%     -    0s
H    0     0                    -80335.59598 -82481.489  2.67%     -    0s
     0     0 -82417.721    0  130 -80335.596 -82417.721  2.59%     -    0s
     0     0 -82352.591    0  132 -80335.596 -82352.591  2.51%     -    0s
     0     2 -82321.661    0  132 -80335.596 -82321.661  2.47%     -    0s
H   47    61                    -80649.55194 -81800.522  1.43%  10.0    0s
H  292   184                    -80778.40974 -81748.484  1.20%   6.3    0s
H  587   161                    -80815.73600 -81536.063  0.89%   5.9    0s
*  825   128              27    -80828.16105 -81536.063  0.88%   5.8    0s
* 1102     7              28    -80828.18780 -81470.334  0.79%   5.5    0s

Cutting planes:
  Gomory: 21
  Implied bound: 3
  MIR: 198

Explored 1190 nodes (6813 simplex iterations) in 0.21 seconds (0.08 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -80828.2 -80828.2 -80815.7 ... 6.68465e+06
No other solutions better than -80828.2

Optimal solution found (tolerance 1.00e-06)
Best objective -8.082818779759e+04, best bound -8.082818779759e+04, gap 0.0000%
  Subproblem solved in 0.23s
  Worst-case operational profit (Z_SP) = 87199.98
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -80828.19
  [DEBUG]   S×d_nominal = 168028.17
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 168028.17 + -80828.19 = 87199.98
  [DEBUG]   Current θ from Master = 87323.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 123.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24275.67
  Lower Bound (LB) = -24275.67
  Gap (UB-LB) = 123.7161, Absolute Gap = 123.7161, Relative Gap = 0.005122
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 23
Total Time: 22176.60s
Converged: True
Final Lower Bound: -24275.6716
Final Upper Bound: -24151.9555
Final Gap: 123.716132
Number of Critical Scenarios: 23
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [5, 9] (2/10)
Active Routes (Plant→DC): 6
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 3 customers  Mode 1: 19 customers  Mode 2: 28 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 23
Start Time: 2026-01-03 10:33:23
End Time: 2026-01-03 16:43:00
Total Time: 22176.60s
Optimal Value: -24275.67
Lower Bound: -24275.67
Upper Bound: -24151.96
Gap: 123.716132
Plants Opened: {0: [2], 1: [2], 2: [2]} (3 plants)
DCs Opened: [5, 9] (2 DCs)
================================================================================

Results saved to: result/DH_single_full_seed1_LD_gamma20_20260103_164300.csv

Total Execution Time: 22177.92 seconds
End Time: 2026-01-03 16:43:01

All tasks completed successfully!

