
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 15
DI Scenario: MD
Start Time: 2026-01-03 09:45:24
================================================================================
Loading data from data/DH_data_full_seed15.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.250', '1.561'] (k=0.549)
  Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
  Product 2: ['1.000', '1.287', '1.656'] (k=0.622)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=903, max=1768
  DC capacity (MC): min=414, max=867

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.05, max=34.96, count=80
  Deviation (μ̂): min=4.07, max=9.96

Costs:
  Plant fixed cost: min=5260, max=9753
  DC fixed cost: min=3497, max=5949
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.335', '1.783'] (k=0.713)
    Product 2: ['1.000', '1.424', '2.029'] (k=0.873)
  MD:
    Product 0: ['1.000', '1.250', '1.561'] (k=0.549)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.287', '1.656'] (k=0.622)
  LD:
    Product 0: ['1.000', '1.113', '1.238'] (k=0.263)
    Product 1: ['1.000', '1.016', '1.032'] (k=0.039)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
  Mixed:
    Product 0: ['1.000', '1.426', '2.034'] (k=0.876)
    Product 1: ['1.000', '1.279', '1.636'] (k=0.607)
    Product 2: ['1.000', '1.122', '1.259'] (k=0.284)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0x66e0fdc3
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.12s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -281539.5314
Found heuristic solution: objective -194606.4683

Root relaxation: objective 1.213047e+05, 4938 iterations, 0.34 seconds (0.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 121304.747    0  504 -194606.47 121304.747   162%     -    0s
H    0     0                    -192016.6225 121304.747   163%     -    0s
H    0     0                    -190113.0011 121304.747   164%     -    0s
H    0     0                    -186346.4697 111065.493   160%     -    1s
     0     0 111065.493    0  731 -186346.47 111065.493   160%     -    1s
     0     0 110743.922    0  726 -186346.47 110743.922   159%     -    1s
     0     0 110735.423    0  731 -186346.47 110735.423   159%     -    1s
     0     0 110735.293    0  731 -186346.47 110735.293   159%     -    1s
     0     0 105200.742    0  910 -186346.47 105200.742   156%     -    3s
     0     0 104644.446    0  907 -186346.47 104644.446   156%     -    3s
     0     0 104585.025    0  916 -186346.47 104585.025   156%     -    3s
     0     0 104559.962    0  929 -186346.47 104559.962   156%     -    4s
     0     0 104558.334    0  929 -186346.47 104558.334   156%     -    4s
H    0     0                    -141440.7061 101632.719   172%     -    6s
H    0     0                    -141101.6462 101632.719   172%     -    6s
H    0     0                    -140695.0516 101632.719   172%     -    6s
H    0     0                    -140292.2411 101632.719   172%     -    6s
H    0     0                    -139928.6824 101632.719   173%     -    6s
H    0     0                    -139483.5530 101632.719   173%     -    6s
H    0     0                    -139110.0038 101632.719   173%     -    6s
H    0     0                    -138640.5668 101632.719   173%     -    6s
H    0     0                    -138069.5339 101632.719   174%     -    6s
H    0     0                    -137644.1190 101632.719   174%     -    6s
H    0     0                    -137199.4452 101632.719   174%     -    6s
H    0     0                    -136741.4938 101632.719   174%     -    6s
H    0     0                    -136225.1582 101632.719   175%     -    6s
     0     0 101632.719    0 1014 -136225.16 101632.719   175%     -    6s
     0     0 101326.699    0 1011 -136225.16 101326.699   174%     -    6s
     0     0 101263.789    0 1020 -136225.16 101263.789   174%     -    6s
     0     0 101254.155    0 1019 -136225.16 101254.155   174%     -    6s
     0     0 101253.585    0 1020 -136225.16 101253.585   174%     -    6s
H    0     0                    -115225.4356 101253.585   188%     -    7s
H    0     0                    -105472.4215 101253.585   196%     -    7s
H    0     0                    -73870.78278 101253.585   237%     -    7s
H    0     0                    -64117.76870 101253.585   258%     -    7s
H    0     0                    -49324.34077 101253.585   305%     -    7s
H    0     0                    -39571.32670 101253.585   356%     -    7s
H    0     0                    -38502.35890 101253.585   363%     -    7s
H    0     0                    5876.9734464 101253.585  1623%     -    7s
H    0     0                    15629.987522 101253.585   548%     -    7s
H    0     0                    33580.300650 101253.585   202%     -    7s
H    0     0                    33646.745845 97034.4616   188%     -    9s
H    0     0                    34073.973883 97034.4616   185%     -    9s
H    0     0                    34196.160970 97034.4616   184%     -    9s
H    0     0                    34633.363692 97034.4616   180%     -    9s
H    0     0                    35069.467412 97034.4616   177%     -    9s
H    0     0                    35543.556827 97034.4616   173%     -    9s
H    0     0                    36785.603899 97034.4616   164%     -    9s
H    0     0                    37534.099223 97034.4616   159%     -    9s
H    0     0                    37546.326247 97034.4616   158%     -    9s
H    0     0                    37746.499507 97034.4616   157%     -    9s
H    0     0                    37824.962419 97034.4616   157%     -    9s
H    0     0                    37865.669249 97034.4616   156%     -    9s
     0     0 97034.4616    0 1069 37865.6692 97034.4616   156%     -    9s
     0     0 96469.2085    0 1064 37865.6692 96469.2085   155%     -   10s
     0     0 96355.7497    0 1072 37865.6692 96355.7497   154%     -   10s
     0     0 96328.0443    0 1089 37865.6692 96328.0443   154%     -   10s
     0     0 96321.8834    0 1085 37865.6692 96321.8834   154%     -   11s
H    0     0                    39229.127295 96321.8834   146%     -   11s
H    0     0                    39617.051929 96321.8834   143%     -   11s
H    0     0                    39707.711465 96321.8834   143%     -   11s
H    0     0                    39859.734678 96321.8834   142%     -   11s
H    0     0                    40085.678201 96321.8834   140%     -   11s
H    0     0                    40097.937722 96321.8834   140%     -   11s
H    0     0                    40152.197245 96321.8834   140%     -   11s
H    0     0                    40296.639862 94828.2207   135%     -   12s
H    0     0                    40444.848705 94828.2207   134%     -   12s
H    0     0                    40493.817049 94828.2207   134%     -   12s
H    0     0                    40499.473785 94828.2207   134%     -   12s
     0     0 94828.2207    0  981 40499.4738 94828.2207   134%     -   12s
H    0     0                    40829.133749 94534.9659   132%     -   13s
H    0     0                    44112.053270 94534.9659   114%     -   13s
H    0     0                    44989.457153 94534.9659   110%     -   13s
H    0     0                    45416.685575 94534.9659   108%     -   13s
H    0     0                    45470.945099 94534.9659   108%     -   13s
H    0     0                    45703.420289 94534.9659   107%     -   13s
H    0     0                    45731.111007 94534.9659   107%     -   13s
H    0     0                    46137.510281 94534.9659   105%     -   13s
     0     0 94534.9659    0 1083 46137.5103 94534.9659   105%     -   13s
     0     0 94460.7789    0 1095 46137.5103 94460.7789   105%     -   14s
H    0     0                    46148.501365 94442.8167   105%     -   14s
H    0     0                    46153.250969 94442.8167   105%     -   14s
     0     0 94442.8167    0 1088 46153.2510 94442.8167   105%     -   14s
     0     0 94436.7760    0 1095 46153.2510 94436.7760   105%     -   14s
H    0     0                    46156.276013 93514.8360   103%     -   16s
H    0     0                    46460.217391 93514.8360   101%     -   16s
     0     0 93514.8360    0 1072 46460.2174 93514.8360   101%     -   16s
H    0     0                    46534.083741 93331.9491   101%     -   16s
H    0     0                    46713.767385 93331.9491   100%     -   16s
H    0     0                    46832.696884 93331.9491  99.3%     -   16s
H    0     0                    46835.721928 93331.9491  99.3%     -   16s
     0     0 93331.9491    0 1128 46835.7219 93331.9491  99.3%     -   16s
     0     0 93293.5201    0 1139 46835.7219 93293.5201  99.2%     -   17s
     0     0 93284.3378    0 1158 46835.7219 93284.3378  99.2%     -   17s
     0     0 92643.4596    0 1051 46835.7219 92643.4596  97.8%     -   18s
     0     0 92539.1021    0 1075 46835.7219 92539.1021  97.6%     -   19s
     0     0 92496.2664    0 1106 46835.7219 92496.2664  97.5%     -   20s
     0     0 92488.3190    0 1127 46835.7219 92488.3190  97.5%     -   20s
     0     0 92169.6819    0  948 46835.7219 92169.6819  96.8%     -   21s
H    0     0                    47194.807459 92107.1099  95.2%     -   22s
H    0     0                    47419.855179 92107.1099  94.2%     -   22s
H    0     0                    51725.456026 92107.1099  78.1%     -   22s
H    0     0                    53693.153018 92107.1099  71.5%     -   22s
H    0     0                    54640.402093 92107.1099  68.6%     -   22s
H    0     0                    54730.100542 92107.1099  68.3%     -   22s
H    0     0                    55004.044177 92107.1099  67.5%     -   22s
H    0     0                    55340.882678 92107.1099  66.4%     -   22s
H    0     0                    55356.916559 92107.1099  66.4%     -   22s
H    0     0                    55364.978790 92107.1099  66.4%     -   22s
H    0     0                    55372.269660 92107.1099  66.3%     -   22s
H    0     0                    55483.466359 92107.1099  66.0%     -   22s
     0     0 92107.1099    0  978 55483.4664 92107.1099  66.0%     -   22s
H    0     0                    55581.902383 92085.5905  65.7%     -   23s
H    0     0                    55970.043562 92085.5905  64.5%     -   23s
     0     0 92085.5905    0 1103 55970.0436 92085.5905  64.5%     -   23s
H    0     0                    56302.323098 91434.4044  62.4%     -   25s
H    0     0                    56339.261522 91434.4044  62.3%     -   25s
H    0     0                    56799.177839 91434.4044  61.0%     -   25s
H    0     0                    57502.770636 91434.4044  59.0%     -   25s
H    0     0                    57516.745657 91434.4044  59.0%     -   25s
H    0     0                    57689.676224 91434.4044  58.5%     -   25s
     0     0 91434.4044    0  973 57689.6762 91434.4044  58.5%     -   25s
H    0     0                    58088.340941 91256.3393  57.1%     -   26s
     0     0 91256.3393    0 1061 58088.3409 91256.3393  57.1%     -   26s
     0     0 91198.9054    0  987 58088.3409 91198.9054  57.0%     -   27s
     0     0 91182.9258    0 1068 58088.3409 91182.9258  57.0%     -   27s
     0     0 89148.0179    0  999 58088.3409 89148.0179  53.5%     -   30s
     0     0 88917.2746    0 1022 58088.3409 88917.2746  53.1%     -   31s
     0     0 88861.4188    0 1054 58088.3409 88861.4188  53.0%     -   31s
     0     0 88844.2350    0 1043 58088.3409 88844.2350  52.9%     -   32s
     0     0 84354.5172    0  917 58088.3409 84354.5172  45.2%     -   35s
     0     0 83935.5303    0  950 58088.3409 83935.5303  44.5%     -   35s
     0     0 83777.7425    0  958 58088.3409 83777.7425  44.2%     -   36s
     0     0 83735.6430    0 1005 58088.3409 83735.6430  44.2%     -   36s
     0     0 83719.2762    0  972 58088.3409 83719.2762  44.1%     -   36s
     0     0 77235.4517    0  663 58088.3409 77235.4517  33.0%     -   39s
     0     0 76281.1602    0  666 58088.3409 76281.1602  31.3%     -   41s
     0     0 76057.2957    0  767 58088.3409 76057.2957  30.9%     -   41s
     0     0 75961.3335    0  821 58088.3409 75961.3335  30.8%     -   42s
     0     0 75910.8404    0  796 58088.3409 75910.8404  30.7%     -   42s
     0     0 75874.8984    0  839 58088.3409 75874.8984  30.6%     -   42s
     0     0 75851.7803    0  887 58088.3409 75851.7803  30.6%     -   42s
     0     0 74747.2317    0  808 58088.3409 74747.2317  28.7%     -   43s
     0     0 74373.2496    0  805 58088.3409 74373.2496  28.0%     -   44s
     0     0 74265.9352    0  896 58088.3409 74265.9352  27.8%     -   45s
     0     0 74215.0447    0  835 58088.3409 74215.0447  27.8%     -   45s
     0     0 74193.8369    0  864 58088.3409 74193.8369  27.7%     -   46s
     0     0 73571.5722    0  803 58088.3409 73571.5722  26.7%     -   47s
     0     0 73356.8494    0  863 58088.3409 73356.8494  26.3%     -   48s
     0     0 73272.4067    0  871 58088.3409 73272.4067  26.1%     -   48s
     0     0 73219.7977    0  816 58088.3409 73219.7977  26.0%     -   49s
     0     0 73200.1951    0  885 58088.3409 73200.1951  26.0%     -   49s
     0     0 72815.2388    0  853 58088.3409 72815.2388  25.4%     -   51s
     0     0 72655.2014    0  840 58088.3409 72655.2014  25.1%     -   51s
     0     0 72624.1844    0  811 58088.3409 72624.1844  25.0%     -   52s
     0     0 72306.4998    0  753 58088.3409 72306.4998  24.5%     -   53s
     0     0 72164.9890    0  763 58088.3409 72164.9890  24.2%     -   54s
     0     0 72119.9167    0  760 58088.3409 72119.9167  24.2%     -   54s
     0     0 71986.3501    0  765 58088.3409 71986.3501  23.9%     -   55s
     0     0 71985.8378    0  765 58088.3409 71985.8378  23.9%     -   55s
     0     2 71985.8378    0  765 58088.3409 71985.8378  23.9%     -   57s
     3     8 70496.7396    2  606 58088.3409 71958.8069  23.9%  2010   61s
    15    32 68939.5173    4  562 58088.3409 71007.0349  22.2%  2583   65s
    95   205 65663.6900    7  610 58088.3409 70853.0905  22.0%  2094   70s
   391   389 64792.7325   13  595 58088.3409 70554.3699  21.5%   935   75s
   585   526 63327.7427   16  525 58088.3409 70213.0689  20.9%   822   80s
   758   680 63675.4431   18  565 58088.3409 69989.6761  20.5%   841   86s
  1003   880 61525.3590   20  529 58088.3409 69930.8045  20.4%   774   91s
  1316  1150 60898.1503   26  375 58088.3409 69724.2815  20.0%   689   96s
  1728  1436 59850.5629   31  475 58088.3409 69570.0520  19.8%   618  101s
  2106  1665 64766.0283   18  386 58088.3409 69559.8807  19.7%   595  106s
  2359  1738 63401.1247   25  410 58088.3409 69376.6249  19.4%   587  110s
  2551  1846 62886.7422   30  430 58088.3409 69376.6249  19.4%   589  116s
  2804  2009 60507.0879   57  179 58088.3409 69376.6249  19.4%   586  120s
  3276  2285 59936.5944   10  558 58088.3409 68931.3200  18.7%   581  126s
  3647  2455 66388.0027    8  556 58088.3409 68530.7356  18.0%   575  130s
  4075  2665 60630.9774   13  512 58088.3409 68265.2330  17.5%   571  135s
  4392  2724 59346.4446   26  765 58088.3409 68013.1416  17.1%   570  151s
  4411  2737 60217.7814   37  415 58088.3409 68013.1416  17.1%   567  155s
  4428  2753 67671.2086   13  331 58088.3409 67857.3803  16.8%   569  160s
  4816  2807     cutoff   21      58088.3409 64384.0562  10.8%   547  165s
  5658  2354     cutoff   23      58088.3409 59106.8662  1.75%   490  170s

Cutting planes:
  Gomory: 1
  Implied bound: 8
  Projected implied bound: 4
  MIR: 87
  Flow cover: 299
  RLT: 5
  Relax-and-lift: 54

Explored 5961 nodes (2884697 simplex iterations) in 174.06 seconds (229.49 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 58088.3 57689.7 57516.7 ... 55372.3

Optimal solution found (tolerance 1.00e-06)
Best objective 5.808834094149e+04, best bound 5.808834094149e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 174.07s
  Master Objective (UB) = 58088.34, θ = 206092.31
  Upper Bound (UB) = 58088.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 206092.31
  [DEBUG]   ✓ Scenario 0: θ = 206092.31 ≤ Q = 206092.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4426de9e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4426de9e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.427014e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6854416.9343
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.569784e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156978.41    0  124 6854416.93 -156978.41   102%     -    0s
H    0     0                    -121844.8990 -156978.41  28.8%     -    0s
H    0     0                    -122108.1516 -156978.41  28.6%     -    0s
H    0     0                    -126290.1586 -126290.16  0.00%     -    0s
     0     0          -    0      -126290.16 -126290.16  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 204

Explored 1 nodes (371 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -126290 -122108 -121845 ... 1.42701e+13
No other solutions better than -126290

Optimal solution found (tolerance 1.00e-06)
Best objective -1.262901585962e+05, best bound -1.262901585962e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 172857.65
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126290.16
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -126290.16 = 172857.65
  [DEBUG]   Current θ from Master = 206092.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33234.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24853.68
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 33234.6590, Absolute Gap = 33234.6590, Relative Gap = 0.572140
  Not converged yet (gap = 33234.66 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x2e2fc957
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 24853.7 (0.02s)
MIP start from previous solve produced solution with objective 24853.7 (0.02s)
Loaded MIP start from previous solve with objective 24853.7

Presolve removed 14231 rows and 5770 columns
Presolve time: 0.49s
Presolved: 17732 rows, 8970 columns, 98128 nonzeros
Variable types: 6711 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.737268e+04, 10334 iterations, 1.88 seconds (2.42 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67372.6778    0  247 24853.6819 67372.6778   171%     -    2s
H    0     0                    27803.070518 67372.6778   142%     -    2s
H    0     0                    28909.185287 67372.6778   133%     -    2s
H    0     0                    29023.939018 67372.6778   132%     -    2s
H    0     0                    29041.887481 67372.6778   132%     -    2s
H    0     0                    29114.534898 67372.6778   131%     -    3s
H    0     0                    29140.437607 67372.6778   131%     -    3s
H    0     0                    29201.133532 67372.6778   131%     -    4s
H    0     0                    29252.118167 67372.6778   130%     -    4s
H    0     0                    29358.761833 67372.6778   129%     -    4s
H    0     0                    29689.888025 67372.6778   127%     -    4s
H    0     0                    29707.260002 67372.6778   127%     -    4s
H    0     0                    29714.801653 67372.6778   127%     -    4s
H    0     0                    29862.479789 67372.6778   126%     -    4s
H    0     0                    29989.564374 67372.6778   125%     -    4s
H    0     0                    30074.474673 67372.6778   124%     -    4s
H    0     0                    30128.149280 67372.6778   124%     -    4s
     0     0 57372.5594    0  482 30128.1493 57372.5594  90.4%     -    5s
H    0     0                    30257.806709 57370.8656  89.6%     -    6s
     0     0 57020.2128    0  492 30257.8067 57020.2128  88.4%     -    6s
     0     0 57020.1863    0  495 30257.8067 57020.1863  88.4%     -    6s
     0     0 49727.6460    0  472 30257.8067 49727.6460  64.3%     -    9s
H    0     0                    30259.646374 49726.3569  64.3%     -    9s
H    0     0                    30348.996639 49726.3569  63.8%     -    9s
H    0     0                    30363.679488 49726.3569  63.8%     -    9s
     0     0 49220.4945    0  481 30363.6795 49220.4945  62.1%     -    9s
     0     0 49123.1505    0  476 30363.6795 49123.1505  61.8%     -    9s
     0     0 49117.5396    0  471 30363.6795 49117.5396  61.8%     -   10s
     0     0 49116.9622    0  475 30363.6795 49116.9622  61.8%     -   10s
H    0     0                    30375.300774 49116.9622  61.7%     -   11s
H    0     0                    30419.088388 49116.9622  61.5%     -   11s
H    0     0                    30468.126085 49116.9622  61.2%     -   11s
H    0     0                    30497.826784 49116.9622  61.1%     -   11s
     0     0 45508.0272    0  374 30497.8268 45508.0272  49.2%     -   12s
     0     0 44772.6081    0  382 30497.8268 44772.6081  46.8%     -   14s
     0     0 44495.6649    0  476 30497.8268 44495.6649  45.9%     -   14s
     0     0 44441.6671    0  392 30497.8268 44441.6671  45.7%     -   15s
     0     0 44422.7601    0  403 30497.8268 44422.7601  45.7%     -   15s
     0     0 44389.9957    0  399 30497.8268 44389.9957  45.6%     -   15s
     0     0 44388.3246    0  400 30497.8268 44388.3246  45.5%     -   15s
     0     0 43388.3454    0  435 30497.8268 43388.3454  42.3%     -   18s
     0     0 43090.1884    0  472 30497.8268 43090.1884  41.3%     -   19s
     0     0 42975.1409    0  481 30497.8268 42975.1409  40.9%     -   19s
     0     0 42894.8245    0  543 30497.8268 42894.8245  40.6%     -   20s
     0     0 42847.0572    0  540 30497.8268 42847.0572  40.5%     -   20s
     0     0 42839.1056    0  540 30497.8268 42839.1056  40.5%     -   20s
     0     0 42831.7504    0  541 30497.8268 42831.7504  40.4%     -   20s
     0     0 42828.6899    0  541 30497.8268 42828.6899  40.4%     -   20s
     0     0 42416.0229    0  456 30497.8268 42416.0229  39.1%     -   22s
     0     0 42341.7187    0  456 30497.8268 42341.7187  38.8%     -   22s
     0     0 42317.8430    0  455 30497.8268 42317.8430  38.8%     -   23s
     0     0 42295.7116    0  471 30497.8268 42295.7116  38.7%     -   23s
     0     0 42284.8629    0  474 30497.8268 42284.8629  38.6%     -   23s
     0     0 42283.9351    0  466 30497.8268 42283.9351  38.6%     -   23s
     0     0 42182.1087    0  546 30497.8268 42182.1087  38.3%     -   24s
     0     0 42162.0468    0  539 30497.8268 42162.0468  38.2%     -   25s
     0     0 42155.4010    0  536 30497.8268 42155.4010  38.2%     -   25s
     0     0 42111.5018    0  527 30497.8268 42111.5018  38.1%     -   26s
     0     0 42108.9318    0  447 30497.8268 42108.9318  38.1%     -   27s
     0     0 42024.6678    0  452 30497.8268 42024.6678  37.8%     -   28s
     0     0 41956.8218    0  451 30497.8268 41956.8218  37.6%     -   29s
     0     0 41939.1284    0  459 30497.8268 41939.1284  37.5%     -   29s
     0     0 41933.2836    0  455 30497.8268 41933.2836  37.5%     -   29s
     0     0 41893.5695    0  448 30497.8268 41893.5695  37.4%     -   30s
     0     0 41888.9415    0  459 30497.8268 41888.9415  37.4%     -   30s
     0     0 41870.2053    0  453 30497.8268 41870.2053  37.3%     -   31s
     0     0 41865.5941    0  448 30497.8268 41865.5941  37.3%     -   31s
     0     0 41859.0320    0  447 30497.8268 41859.0320  37.3%     -   31s
     0     0 41858.8471    0  447 30497.8268 41858.8471  37.3%     -   32s
     0     2 41858.8240    0  447 30497.8268 41858.8240  37.3%     -   37s
    15    32 40631.8937    4  357 30497.8268 41186.0183  35.0%   828   40s
    95   141 37991.3293    7  317 30497.8268 40887.2719  34.1%   946   46s
   293   309 32684.8464   10  332 30497.8268 40887.2186  34.1%   658   50s
H  467   412                    30515.121727 40756.5328  33.6%   574   51s
H  516   412                    30538.578027 40756.5328  33.5%   540   51s
   706   584 38757.1626    9  331 30538.5780 40642.9900  33.1%   489   55s
H  800   651                    30544.310493 40642.9900  33.1%   458   55s
  1462  1116 32101.3689   33  252 30544.3105 40155.6155  31.5%   327   60s
H 1493  1116                    30583.809170 40155.6155  31.3%   326   60s
H 1840  1342                    30597.122338 40155.6155  31.2%   300   62s
  2107  1615 infeasible   12      30597.1223 39732.5362  29.9%   279   65s
  2682  1837 35537.8569   11  248 30597.1223 39394.1707  28.8%   270   70s
  3273  2091 32195.5462   12  270 30597.1223 39394.1707  28.8%   262   75s
  4127  2489 37233.9598    9  256 30597.1223 38922.7537  27.2%   254   81s
  4561  2681     cutoff   14      30597.1223 38776.9127  26.7%   256   85s
  5271  2744 35351.9827   10  384 30597.1223 38041.1218  24.3%   250   90s
  5966  2946 30964.3051   19  172 30597.1223 37522.3764  22.6%   255   95s
  6972  3193 32874.6288   29  447 30597.1223 36619.4191  19.7%   251  108s
  6974  3194 34257.5725   21   71 30597.1223 36619.4191  19.7%   251  110s
  6979  3198 33556.9111   11  436 30597.1223 36619.4191  19.7%   251  115s
  6989  3204 31293.5934   33  426 30597.1223 36619.4191  19.7%   250  120s
  6995  3208 33658.7282   15  407 30597.1223 36619.4191  19.7%   250  125s
  6998  3210 32373.9756   35  452 30597.1223 36619.4191  19.7%   250  131s
  7005  3224 36619.4191   12  257 30597.1223 36619.4191  19.7%   254  135s
  7093  3312 35632.9255   16  291 30597.1223 36619.4191  19.7%   260  140s
  7385  3334 31425.3987   23  206 30597.1223 36619.4191  19.7%   266  146s
  7608  3313 36619.4191   19  263 30597.1223 36619.4191  19.7%   271  150s
  8020  3247 31286.8954   25  107 30597.1223 36619.4191  19.7%   276  155s
  8446  3152 31078.4245   33   50 30597.1223 36619.4191  19.7%   279  160s
  9025  2928 33991.2808   20  261 30597.1223 36619.4191  19.7%   280  166s
  9476  2658 32700.7559   24  258 30597.1223 35011.4177  14.4%   280  170s
H10107  2230                    30600.151839 33476.0923  9.40%   272  172s
 11547  1908 30671.2103   42   39 30600.1518 30812.8999  0.70%   241  175s
*13262  1019              68    30607.493866 30716.5755  0.36%   212  177s

Cutting planes:
  MIR: 129
  Flow cover: 605
  RLT: 8
  Relax-and-lift: 75

Explored 13898 nodes (2857300 simplex iterations) in 178.30 seconds (275.58 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 30607.5 30600.2 30597.1 ... 30419.1

Optimal solution found (tolerance 1.00e-06)
Best objective 3.060749386607e+04, best bound 3.060749386607e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 178.32s
  Master Objective (UB) = 30607.49, θ = 158435.92
  Upper Bound (UB) = 30607.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 158435.92
  [DEBUG]   ✓ Scenario 0: θ = 158435.92 ≤ Q = 158435.92 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 158435.92 ≤ Q = 158435.92 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e2bf07f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa1d40f81
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.459918e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.01s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 7417353.5091
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.485426e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148542.56    0  126 7417353.51 -148542.56   102%     -    0s
H    0     0                    -115084.4191 -148542.56  29.1%     -    0s
H    0     0                    -115883.3152 -148542.56  28.2%     -    0s
H    0     0                    -126663.2616 -148542.56  17.3%     -    0s
     0     0 -137664.13    0   76 -126663.26 -137664.13  8.69%     -    0s
H    0     0                    -135787.5625 -137623.91  1.35%     -    0s
H    0     0                    -136289.0353 -137310.83  0.75%     -    0s
     0     0 -137310.83    0   77 -136289.04 -137310.83  0.75%     -    0s
     0     0 -137298.20    0   77 -136289.04 -137298.20  0.74%     -    0s
     0     0 -136607.05    0   36 -136289.04 -136607.05  0.23%     -    0s
     0     0 -136527.90    0   23 -136289.04 -136527.90  0.18%     -    0s
     0     0 -136491.65    0   21 -136289.04 -136491.65  0.15%     -    0s
     0     0 -136480.34    0   21 -136289.04 -136480.34  0.14%     -    0s
     0     0 -136463.40    0   20 -136289.04 -136463.40  0.13%     -    0s
     0     0 -136455.89    0   20 -136289.04 -136455.89  0.12%     -    0s
     0     0 -136452.57    0   20 -136289.04 -136452.57  0.12%     -    0s
     0     0 -136451.10    0   20 -136289.04 -136451.10  0.12%     -    0s
     0     0 -136429.68    0   19 -136289.04 -136429.68  0.10%     -    0s
     0     0 -136423.40    0   19 -136289.04 -136423.40  0.10%     -    0s
     0     0 -136419.44    0   19 -136289.04 -136419.44  0.10%     -    0s
     0     0 -136417.68    0   19 -136289.04 -136417.68  0.09%     -    0s
     0     0 -136416.91    0   19 -136289.04 -136416.91  0.09%     -    0s
     0     0 -136323.08    0    7 -136289.04 -136323.08  0.02%     -    0s
     0     0 -136306.87    0    4 -136289.04 -136306.87  0.01%     -    0s
H    0     0                    -136295.9207 -136306.87  0.01%     -    0s
*    0     0               0    -136296.9348 -136296.93  0.00%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 3
  Relax-and-lift: 1

Explored 1 nodes (673 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -136297 -136296 -136289 ... 1.45992e+13
No other solutions better than -136297

Optimal solution found (tolerance 1.00e-06)
Best objective -1.362969348279e+05, best bound -1.362969348279e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 132301.70
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136296.93
  [DEBUG]   S×d_nominal = 268598.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 268598.64 + -136296.93 = 132301.70
  [DEBUG]   Current θ from Master = 158435.92
  [DEBUG]   ⚠️  Z_SP ≤ θ by 26134.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4473.28
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 5753.8119, Absolute Gap = 5753.8119, Relative Gap = 0.187987
  Not converged yet (gap = 5753.81 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xe73ceb3a
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 4473.28 (0.03s)
MIP start from previous solve produced solution with objective 4473.28 (0.03s)
Loaded MIP start from previous solve with objective 4473.28

Presolve removed 21310 rows and 8660 columns
Presolve time: 0.65s
Presolved: 25943 rows, 12320 columns, 159749 nonzeros
Variable types: 10061 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36266    4.9039470e+04   0.000000e+00   3.028795e+05      5s
Concurrent spin time: 0.13s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16908    5.3313221e+04   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 5.331322e+04, 16908 iterations, 4.35 seconds (5.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53313.2209    0   71 4473.28237 53313.2209  1092%     -    5s
H    0     0                    21701.389761 53313.2209   146%     -    5s
H    0     0                    25115.171762 53313.2209   112%     -    5s
H    0     0                    25333.365753 53313.2209   110%     -    5s
H    0     0                    25513.935203 53313.2209   109%     -    5s
     0     0 49393.7886    0  172 25513.9352 49393.7886  93.6%     -    7s
H    0     0                    25906.041314 49393.7886  90.7%     -    8s
     0     0 48865.8805    0  235 25906.0413 48865.8805  88.6%     -    8s
     0     0 48865.8805    0  235 25906.0413 48865.8805  88.6%     -    9s
     0     0 48865.8690    0  239 25906.0413 48865.8690  88.6%     -    9s
     0     0 46584.5745    0  220 25906.0413 46584.5745  79.8%     -   11s
     0     0 45995.0293    0  266 25906.0413 45995.0293  77.5%     -   12s
     0     0 45673.1796    0  257 25906.0413 45673.1796  76.3%     -   12s
     0     0 45622.9682    0  259 25906.0413 45622.9682  76.1%     -   12s
     0     0 45598.5654    0  268 25906.0413 45598.5654  76.0%     -   12s
     0     0 45592.3524    0  268 25906.0413 45592.3524  76.0%     -   13s
     0     0 45591.6086    0  268 25906.0413 45591.6086  76.0%     -   13s
     0     0 45591.4355    0  268 25906.0413 45591.4355  76.0%     -   13s
H    0     0                    26878.023243 44240.5122  64.6%     -   15s
H    0     0                    27401.106081 44240.5122  61.5%     -   15s
H    0     0                    27421.212027 44240.5122  61.3%     -   15s
     0     0 44240.5122    0  336 27421.2120 44240.5122  61.3%     -   15s
     0     0 43731.6820    0  301 27421.2120 43731.6820  59.5%     -   16s
     0     0 43506.5481    0  301 27421.2120 43506.5481  58.7%     -   16s
     0     0 43354.1104    0  307 27421.2120 43354.1104  58.1%     -   17s
     0     0 43333.8794    0  320 27421.2120 43333.8794  58.0%     -   17s
     0     0 43327.5083    0  317 27421.2120 43327.5083  58.0%     -   17s
     0     0 43327.4700    0  319 27421.2120 43327.4700  58.0%     -   17s
H    0     0                    27481.364678 43327.4700  57.7%     -   19s
H    0     0                    27495.325319 43327.4700  57.6%     -   19s
H    0     0                    27516.290568 43327.4700  57.5%     -   19s
H    0     0                    27518.205171 43327.4700  57.5%     -   19s
     0     0 42603.1200    0  343 27518.2052 42603.1200  54.8%     -   20s
H    0     0                    27525.256524 42602.7905  54.8%     -   21s
H    0     0                    27539.647012 42602.7905  54.7%     -   21s
     0     0 42196.3202    0  345 27539.6470 42196.3202  53.2%     -   21s
     0     0 42082.3116    0  354 27539.6470 42082.3116  52.8%     -   22s
     0     0 42019.4934    0  363 27539.6470 42019.4934  52.6%     -   22s
     0     0 42001.0624    0  357 27539.6470 42001.0624  52.5%     -   23s
     0     0 41986.7284    0  358 27539.6470 41986.7284  52.5%     -   23s
     0     0 41981.4767    0  361 27539.6470 41981.4767  52.4%     -   23s
     0     0 41974.6281    0  362 27539.6470 41974.6281  52.4%     -   23s
     0     0 41967.2619    0  362 27539.6470 41967.2619  52.4%     -   23s
     0     0 41961.1282    0  367 27539.6470 41961.1282  52.4%     -   24s
     0     0 41960.0374    0  364 27539.6470 41960.0374  52.4%     -   24s
     0     0 41770.1358    0  415 27539.6470 41770.1358  51.7%     -   25s
     0     0 41719.3341    0  432 27539.6470 41719.3341  51.5%     -   26s
     0     0 41656.5840    0  420 27539.6470 41656.5840  51.3%     -   26s
     0     0 41637.0050    0  422 27539.6470 41637.0050  51.2%     -   26s
     0     0 41621.0483    0  420 27539.6470 41621.0483  51.1%     -   27s
     0     0 41613.8120    0  422 27539.6470 41613.8120  51.1%     -   27s
     0     0 41606.7367    0  425 27539.6470 41606.7367  51.1%     -   27s
     0     0 41604.9099    0  428 27539.6470 41604.9099  51.1%     -   28s
     0     0 41604.3744    0  427 27539.6470 41604.3744  51.1%     -   28s
     0     0 41483.0081    0  385 27539.6470 41483.0081  50.6%     -   29s
H    0     0                    27551.262887 41482.4351  50.6%     -   30s
H    0     0                    27598.778355 41482.4351  50.3%     -   30s
     0     0 41422.3103    0  390 27598.7784 41422.3103  50.1%     -   31s
     0     0 41417.0043    0  390 27598.7784 41417.0043  50.1%     -   31s
     0     0 41404.3751    0  398 27598.7784 41404.3751  50.0%     -   31s
     0     0 41402.7599    0  386 27598.7784 41402.7599  50.0%     -   32s
     0     0 41401.7932    0  393 27598.7784 41401.7932  50.0%     -   32s
     0     0 41338.7409    0  392 27598.7784 41338.7409  49.8%     -   33s
     0     0 41283.9123    0  426 27598.7784 41283.9123  49.6%     -   34s
     0     0 41259.2962    0  427 27598.7784 41259.2962  49.5%     -   34s
     0     0 41249.2681    0  391 27598.7784 41249.2681  49.5%     -   35s
     0     0 41246.7037    0  390 27598.7784 41246.7037  49.5%     -   35s
     0     0 41246.2262    0  389 27598.7784 41246.2262  49.4%     -   35s
     0     0 41209.2286    0  429 27598.7784 41209.2286  49.3%     -   36s
     0     0 41194.7005    0  441 27598.7784 41194.7005  49.3%     -   36s
     0     0 41184.9397    0  443 27598.7784 41184.9397  49.2%     -   37s
     0     0 41179.5641    0  401 27598.7784 41179.5641  49.2%     -   37s
     0     0 41178.9535    0  401 27598.7784 41178.9535  49.2%     -   37s
     0     0 41156.8057    0  390 27598.7784 41156.8057  49.1%     -   38s
H    0     0                    27646.867616 41155.2464  48.9%     -   38s
     0     0 41142.3744    0  394 27646.8676 41142.3744  48.8%     -   38s
     0     0 41135.2449    0  395 27646.8676 41135.2449  48.8%     -   38s
     0     0 41134.1761    0  396 27646.8676 41134.1761  48.8%     -   38s
     0     0 41125.0839    0  386 27646.8676 41125.0839  48.8%     -   39s
     0     0 41118.6870    0  436 27646.8676 41118.6870  48.7%     -   39s
     0     0 41116.3347    0  440 27646.8676 41116.3347  48.7%     -   39s
     0     0 41116.0259    0  392 27646.8676 41116.0259  48.7%     -   39s
     0     0 41091.3694    0  431 27646.8676 41091.3694  48.6%     -   40s
     0     0 41081.2741    0  438 27646.8676 41081.2741  48.6%     -   40s
     0     0 41080.0791    0  446 27646.8676 41080.0791  48.6%     -   41s
     0     0 41071.3651    0  387 27646.8676 41071.3651  48.6%     -   41s
     0     0 41070.6723    0  387 27646.8676 41070.6723  48.6%     -   41s
     0     0 41069.4470    0  389 27646.8676 41069.4470  48.6%     -   42s
     0     0 41067.8436    0  388 27646.8676 41067.8436  48.5%     -   42s
     0     0 41066.6960    0  393 27646.8676 41066.6960  48.5%     -   42s
     0     0 41065.3585    0  388 27646.8676 41065.3585  48.5%     -   43s
H    0     0                    27768.083287 41064.5108  47.9%     -   43s
     0     0 41064.0594    0  399 27768.0833 41064.0594  47.9%     -   43s
     0     0 41061.5602    0  392 27768.0833 41061.5602  47.9%     -   44s
     0     0 41061.2572    0  392 27768.0833 41061.2572  47.9%     -   44s
     0     2 41061.2427    0  392 27768.0833 41061.2427  47.9%     -   50s
     7    16 40840.4504    3  382 27768.0833 40915.1875  47.3%  1502   55s
    31    64 40437.1875    5  384 27768.0833 40485.2335  45.8%  2989   60s
   139   238 39802.1560    8  388 27768.0833 40436.8354  45.6%  1519   67s
   239   320 39333.8603    8  433 27768.0833 40436.8354  45.6%  1131   70s
   447   474 39170.8827   10  384 27768.0833 40436.8354  45.6%   930   76s
   536   552 39072.0002   12  383 27768.0833 40355.1028  45.3%   872   81s
   630   635 38827.9660   14  439 27768.0833 40114.6241  44.5%   828   88s
   734   732 38529.6679   16  446 27768.0833 40114.6241  44.5%   794   91s
   904   869 38345.4751   18  436 27768.0833 40114.6241  44.5%   753   96s
  1029   961 36417.5875   19  279 27768.0833 40001.9105  44.1%   741  100s
  1185  1149 37507.3850   20  427 27768.0833 39366.1580  41.8%   711  105s
  1411  1351 35689.3507   21  394 27768.0833 39366.1580  41.8%   675  111s
  1694  1609 35729.8196   22  297 27768.0833 39333.4361  41.6%   635  116s
  2024  1797 35493.1587   24  401 27768.0833 39320.4222  41.6%   599  121s
  2349  2005 35346.0935   26  340 27768.0833 39131.6959  40.9%   585  127s
  2533  2095 35071.3741   29  260 27768.0833 39122.5662  40.9%   576  130s
  2858  2359 32314.4823   32  172 27768.0833 39122.5662  40.9%   574  136s
  3256  2548 29946.1966   36  218 27768.0833 39122.5662  40.9%   564  142s
  3427  2651 29001.2053   39  206 27768.0833 39056.5647  40.7%   568  145s
  3820  2918 37092.2364   15  193 27768.0833 39056.5647  40.7%   570  152s
  4049  2919 32178.7289   15  392 27768.0833 39056.5647  40.7%   567  162s
  4051  2920 38253.1263   15   71 27768.0833 39056.5647  40.7%   567  168s
  4052  2921 30295.8631   32  213 27768.0833 39056.5647  40.7%   567  173s
  4053  2922 30175.2883   45  360 27768.0833 39056.5647  40.7%   566  176s
  4056  2924 38005.5813    9  403 27768.0833 39056.5647  40.7%   566  181s
  4062  2928 30559.4832   10  336 27768.0833 39056.5647  40.7%   565  185s
  4069  2932 35604.5404   18  395 27768.0833 39056.5647  40.7%   564  191s
  4073  2935 37140.4117   12  443 27768.0833 39056.5647  40.7%   564  196s
  4076  2937 34578.7112   23  456 27768.0833 39056.5647  40.7%   563  201s
  4079  2939 35919.5619   19  451 27768.0833 39056.5647  40.7%   563  205s
  4084  2942 30855.6124   19  454 27768.0833 39056.5647  40.7%   562  210s
  4088  2945 37926.0472   10  432 27768.0833 39056.5647  40.7%   562  215s
  4092  2948 29880.2568   32  465 27768.0833 39056.5647  40.7%   561  232s
  4093  2948 35582.4147   14  465 27768.0833 39056.5647  40.7%   561  240s
  4096  2955 35374.1201   17  459 27768.0833 39056.5647  40.7%   579  247s
  4108  2975 34658.3193   19  440 27768.0833 39056.5647  40.7%   582  253s
  4124  2997 34169.3817   20  414 27768.0833 39056.5647  40.7%   586  257s
  4156  3011 33833.4937   21  366 27768.0833 39056.5647  40.7%   602  261s
  4254  3090 32977.5013   24  344 27768.0833 39056.5647  40.7%   624  267s
  4385  3124 32406.3659   25  301 27768.0833 39056.5647  40.7%   636  272s
  4492  3119 31037.7643   26  270 27768.0833 39056.5647  40.7%   643  276s
  4608  3120 29895.6134   27  282 27768.0833 39056.5647  40.7%   645  282s
  4667  3126 28612.1682   28  300 27768.0833 39056.5647  40.7%   648  285s
  4792  3153 30738.1019   29  250 27768.0833 39056.5647  40.7%   659  290s
  4944  3161 35058.5066   28  200 27768.0833 39056.5647  40.7%   661  297s
  5032  3160 31377.1873   30  127 27768.0833 38591.9590  39.0%   663  301s
  5117  3162 30554.7533   32   77 27768.0833 38591.5063  39.0%   667  305s
  5252  3159 36232.8964   28  208 27768.0833 38591.5063  39.0%   671  311s
  5338  3153 32736.0236   30  137 27768.0833 38591.5063  39.0%   673  315s
  5543  3144 29834.1132   31  299 27768.0833 37374.7180  34.6%   678  321s
  5629  3145 28027.5185   31  150 27768.0833 37374.7180  34.6%   681  326s
  5871  3127 29971.8380   30  209 27768.0833 37220.3983  34.0%   686  332s
  6000  3108     cutoff   31      27768.0833 37220.3983  34.0%   688  335s
* 6219  2886              71    27934.585800 36740.5500  31.5%   684  338s
  6314  2873 33435.2581   27  280 27934.5858 36638.7242  31.2%   686  342s
H 6325  2729                    27954.619560 36638.7242  31.1%   686  342s
H 6344  2589                    28781.978817 36638.7242  27.3%   687  342s
  6408  2595 33163.9593   28  199 28781.9788 36638.7242  27.3%   689  345s
  6543  2563 31822.1490   30  203 28781.9788 36638.7242  27.3%   691  350s
H 6660  2397                    28855.959745 36147.1458  25.3%   694  350s
  6677  2406     cutoff   32      28855.9597 36147.1458  25.3%   696  356s
  6904  2334 33500.6967   24  247 28855.9597 35902.4460  24.4%   700  363s
  7056  2288 30241.4870   26  156 28855.9597 35809.2327  24.1%   700  368s
  7191  2247 29158.4641   24  212 28855.9597 35809.2327  24.1%   702  373s
  7404  2195 30084.1543   31  173 28855.9597 35347.2142  22.5%   703  377s
  7575  2120     cutoff   33      28855.9597 34873.3159  20.9%   701  382s
  7833  2020     cutoff   28      28855.9597 34808.6104  20.6%   701  387s
  8088  1911 30972.8514   30  206 28855.9597 34698.0550  20.2%   704  391s
  8395  1760     cutoff   29      28855.9597 34255.5161  18.7%   704  396s
  8707  1593     cutoff   30      28855.9597 33773.9753  17.0%   705  400s
  9004  1381     cutoff   30      28855.9597 33472.7453  16.0%   704  405s
  9383  1044     cutoff   32      28855.9597 33084.0198  14.7%   698  410s
 10364   311 30391.9980   25  280 28855.9597 31210.8177  8.16%   670  418s

Cutting planes:
  Lift-and-project: 1
  MIR: 155
  Mixing: 1
  Flow cover: 807
  RLT: 15
  Relax-and-lift: 73

Explored 10551 nodes (7031510 simplex iterations) in 418.33 seconds (727.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 28856 28782 27954.6 ... 27525.3

Optimal solution found (tolerance 1.00e-06)
Best objective 2.885595974532e+04, best bound 2.885595974532e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 418.33s
  Master Objective (UB) = 28855.96, θ = 172064.09
  Upper Bound (UB) = 28855.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172064.09
  [DEBUG]   ✓ Scenario 0: θ = 172064.09 ≤ Q = 172064.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172064.09 ≤ Q = 172064.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172064.09 ≤ Q = 172064.09 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x36396bd5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x36396bd5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.394163e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6733989.1027
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.611501e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161150.12    0  127 6733989.10 -161150.12   102%     -    0s
H    0     0                    -125745.2219 -161150.12  28.2%     -    0s
H    0     0                    -126514.1412 -161150.12  27.4%     -    0s
H    0     0                    -132544.2869 -161150.12  21.6%     -    0s
H    0     0                    -137466.6302 -161150.12  17.2%     -    0s
H    0     0                    -146562.4233 -149262.71  1.84%     -    0s
     0     0 -149262.71    0   76 -146562.42 -149262.71  1.84%     -    0s
     0     0 -148689.06    0   77 -146562.42 -148689.06  1.45%     -    0s
     0     0 -148677.33    0   77 -146562.42 -148677.33  1.44%     -    0s
H    0     0                    -147275.4245 -148677.33  0.95%     -    0s
     0     0 -148045.66    0   35 -147275.42 -148045.66  0.52%     -    0s
H    0     0                    -147293.1430 -147977.45  0.46%     -    0s
     0     0 -147902.03    0   27 -147293.14 -147902.03  0.41%     -    0s
     0     0 -147884.87    0   28 -147293.14 -147884.87  0.40%     -    0s
     0     0 -147884.23    0   28 -147293.14 -147884.23  0.40%     -    0s
     0     0 -147657.32    0   18 -147293.14 -147657.32  0.25%     -    0s
H    0     0                    -147301.3411 -147638.06  0.23%     -    0s
H    0     0                    -147343.2844 -147638.06  0.20%     -    0s
     0     0 -147638.06    0   19 -147343.28 -147638.06  0.20%     -    0s
     0     0 -147573.05    0   15 -147343.28 -147573.05  0.16%     -    0s
     0     0 -147482.30    0   12 -147343.28 -147482.30  0.09%     -    0s
     0     0 -147482.30    0   17 -147343.28 -147482.30  0.09%     -    0s
     0     0 -147380.73    0    3 -147343.28 -147380.73  0.03%     -    0s
H    0     0                    -147346.9010 -147373.23  0.02%     -    0s
     0     0 -147373.23    0    3 -147346.90 -147373.23  0.02%     -    0s
     0     0 -147370.09    0    2 -147346.90 -147370.09  0.02%     -    0s
H    0     0                    -147362.8944 -147370.09  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 2
  MIR: 11
  Flow cover: 5
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (757 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -147363 -147347 -147343 ... -125745
No other solutions better than -147363

Optimal solution found (tolerance 1.00e-06)
Best objective -1.473628944011e+05, best bound -1.473628944011e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 151784.92
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147362.89
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -147362.89 = 151784.92
  [DEBUG]   Current θ from Master = 172064.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20279.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8576.79
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 4002.2778, Absolute Gap = 4002.2778, Relative Gap = 0.138698
  Not converged yet (gap = 4002.28 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0xffbf06d2
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 8576.79 (0.15s)
Loaded MIP start from previous solve with objective 8576.79

Presolve removed 28400 rows and 11540 columns
Presolve time: 2.63s
Presolved: 34143 rows, 15680 columns, 211199 nonzeros
Variable types: 13421 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34143 rows, 15680 columns, 211199 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25460    9.1286804e+02   0.000000e+00   4.879575e+06      5s
   37904    4.4885883e+04   0.000000e+00   6.182400e+07     10s
Concurrent spin time: 0.73s

Solved with dual simplex

Root relaxation: objective 5.295265e+04, 23612 iterations, 9.67 seconds (12.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52952.6545    0   80 8576.78841 52952.6545   517%     -   12s
H    0     0                    19279.075651 52952.6545   175%     -   12s
H    0     0                    24518.252402 52952.6545   116%     -   13s
H    0     0                    26213.959600 52952.6545   102%     -   13s
H    0     0                    26727.933191 52952.6545  98.1%     -   13s
     0     0 48905.7640    0  232 26727.9332 48905.7640  83.0%     -   17s
     0     0 48905.7640    0  241 26727.9332 48905.7640  83.0%     -   18s
     0     0 48905.7640    0  242 26727.9332 48905.7640  83.0%     -   18s
     0     0 46264.9797    0  253 26727.9332 46264.9797  73.1%     -   22s
     0     0 46004.0639    0  240 26727.9332 46004.0639  72.1%     -   23s
     0     0 45867.1985    0  261 26727.9332 45867.1985  71.6%     -   24s
     0     0 45639.5248    0  262 26727.9332 45639.5248  70.8%     -   25s
     0     0 45623.8209    0  264 26727.9332 45623.8209  70.7%     -   26s
     0     0 45620.8568    0  266 26727.9332 45620.8568  70.7%     -   26s
     0     0 45620.6199    0  268 26727.9332 45620.6199  70.7%     -   26s
     0     0 43720.2327    0  267 26727.9332 43720.2327  63.6%     -   31s
     0     0 43301.0494    0  317 26727.9332 43301.0494  62.0%     -   34s
     0     0 43187.3438    0  319 26727.9332 43187.3438  61.6%     -   35s
     0     0 43112.3795    0  328 26727.9332 43112.3795  61.3%     -   36s
     0     0 43106.0255    0  332 26727.9332 43106.0255  61.3%     -   36s
     0     0 43104.2976    0  334 26727.9332 43104.2976  61.3%     -   36s
     0     0 43103.7478    0  336 26727.9332 43103.7478  61.3%     -   36s
H    0     0                    26876.360026 42207.5826  57.0%     -   43s
H    0     0                    26904.181015 42207.5826  56.9%     -   43s
     0     0 42207.5826    0  344 26904.1810 42207.5826  56.9%     -   43s
H    0     0                    27178.076438 42207.2631  55.3%     -   44s
     0     0 41858.4467    0  357 27178.0764 41858.4467  54.0%     -   45s
     0     0 41675.5813    0  367 27178.0764 41675.5813  53.3%     -   47s
     0     0 41588.0640    0  414 27178.0764 41588.0640  53.0%     -   49s
     0     0 41556.5254    0  377 27178.0764 41556.5254  52.9%     -   49s
     0     0 41536.2789    0  381 27178.0764 41536.2789  52.8%     -   50s
     0     0 41518.7387    0  384 27178.0764 41518.7387  52.8%     -   50s
     0     0 41513.0299    0  423 27178.0764 41513.0299  52.7%     -   51s
     0     0 41510.4701    0  382 27178.0764 41510.4701  52.7%     -   51s
     0     0 41509.6476    0  382 27178.0764 41509.6476  52.7%     -   51s
     0     0 41277.6496    0  378 27178.0764 41277.6496  51.9%     -   53s
H    0     0                    28153.886977 41277.4673  46.6%     -   54s
     0     0 41224.8271    0  420 28153.8870 41224.8271  46.4%     -   54s
     0     0 41187.8747    0  422 28153.8870 41187.8747  46.3%     -   55s
     0     0 41161.8136    0  421 28153.8870 41161.8136  46.2%     -   56s
     0     0 41155.8168    0  432 28153.8870 41155.8168  46.2%     -   56s
     0     0 41153.4708    0  431 28153.8870 41153.4708  46.2%     -   56s
     0     0 41152.1087    0  438 28153.8870 41152.1087  46.2%     -   56s
     0     0 41106.4289    0  426 28153.8870 41106.4289  46.0%     -   58s
     0     0 41097.5302    0  435 28153.8870 41097.5302  46.0%     -   59s
     0     0 41089.7165    0  442 28153.8870 41089.7165  45.9%     -   59s
     0     0 41081.0521    0  436 28153.8870 41081.0521  45.9%     -   60s
     0     0 41078.9493    0  443 28153.8870 41078.9493  45.9%     -   60s
     0     0 41078.8548    0  439 28153.8870 41078.8548  45.9%     -   60s
     0     0 41060.2096    0  431 28153.8870 41060.2096  45.8%     -   61s
     0     0 41048.3537    0  437 28153.8870 41048.3537  45.8%     -   62s
     0     0 41046.3481    0  433 28153.8870 41046.3481  45.8%     -   62s
     0     0 41045.7504    0  435 28153.8870 41045.7504  45.8%     -   62s
     0     0 41030.0653    0  437 28153.8870 41030.0653  45.7%     -   63s
     0     0 41019.2130    0  434 28153.8870 41019.2130  45.7%     -   64s
     0     0 41012.8126    0  384 28153.8870 41012.8126  45.7%     -   64s
     0     0 41011.6978    0  435 28153.8870 41011.6978  45.7%     -   64s
     0     0 40999.1291    0  440 28153.8870 40999.1291  45.6%     -   65s
     0     0 40997.8869    0  446 28153.8870 40997.8869  45.6%     -   66s
     0     0 40979.5444    0  390 28153.8870 40979.5444  45.6%     -   67s
     0     0 40966.1573    0  442 28153.8870 40966.1573  45.5%     -   68s
     0     0 40962.2930    0  436 28153.8870 40962.2930  45.5%     -   68s
     0     0 40959.7640    0  441 28153.8870 40959.7640  45.5%     -   68s
     0     0 40959.3230    0  436 28153.8870 40959.3230  45.5%     -   68s
     0     0 40954.0610    0  441 28153.8870 40954.0610  45.5%     -   69s
     0     0 40951.3852    0  441 28153.8870 40951.3852  45.5%     -   69s
     0     0 40951.0525    0  440 28153.8870 40951.0525  45.5%     -   69s
     0     0 40949.1770    0  443 28153.8870 40949.1770  45.4%     -   70s
     0     0 40948.3588    0  388 28153.8870 40948.3588  45.4%     -   72s
     0     0 40946.7568    0  375 28153.8870 40946.7568  45.4%     -   73s
     0     0 40943.9498    0  434 28153.8870 40943.9498  45.4%     -   73s
     0     0 40943.0488    0  441 28153.8870 40943.0488  45.4%     -   74s
     0     0 40939.8178    0  435 28153.8870 40939.8178  45.4%     -   74s
     0     0 40934.4623    0  442 28153.8870 40934.4623  45.4%     -   75s
     0     0 40934.3855    0  440 28153.8870 40934.3855  45.4%     -   75s
     0     0 40925.7908    0  431 28153.8870 40925.7908  45.4%     -   76s
     0     0 40924.3620    0  431 28153.8870 40924.3620  45.4%     -   76s
     0     2 40924.3620    0  431 28153.8870 40924.3620  45.4%     -   86s
     3     8 40687.2834    2  424 28153.8870 40830.4497  45.0%  1493   90s
    15    32 40015.7066    4  385 28153.8870 40401.6974  43.5%  1773   97s
    31    64 39905.5992    5  385 28153.8870 40330.2408  43.2%  2196  101s
    95   139 39604.1533    7  373 28153.8870 40113.5720  42.5%  1858  112s
   138   212 39570.1330    8  376 28153.8870 40113.5720  42.5%  1479  116s
   290   347 39166.3258   10  385 28153.8870 40113.5720  42.5%  1157  124s
   352   390 38605.0461   11  322 28153.8870 40113.5720  42.5%  1161  127s
   399   459 38732.4637   11  311 28153.8870 40113.5720  42.5%  1159  130s
   552   579 38324.9848   13  381 28153.8870 40113.5720  42.5%  1045  136s
   696   681 38318.8899   14  317 28153.8870 39983.1911  42.0%   996  142s
   764   741 38130.0700   16  312 28153.8870 39983.1911  42.0%   988  146s
   918   887 37706.7629   20  325 28153.8870 39983.1911  42.0%   951  153s
  1004   923 37291.3764   21  250 28153.8870 39855.8070  41.6%   930  157s
  1054   999 37056.3263   22  305 28153.8870 39855.8070  41.6%   923  160s
  1246  1165 35664.7144   24  296 28153.8870 39741.1965  41.2%   881  166s
  1445  1347 34996.7274   28  300 28153.8870 39723.6260  41.1%   862  173s
  1570  1452 34415.8581   32  286 28153.8870 39723.6260  41.1%   843  176s
  1707  1583 34000.2800   34  257 28153.8870 39723.6260  41.1%   815  181s
  1970  1736     cutoff   36      28153.8870 39297.7708  39.6%   777  189s
  2092  1813     cutoff   37      28153.8870 39297.7708  39.6%   778  193s
  2201  1898 31466.3671   39  166 28153.8870 39297.7708  39.6%   770  201s
  2361  1976 30141.0450   43  211 28153.8870 39297.7708  39.6%   764  205s
  2526  2107 infeasible   45      28153.8870 39297.7708  39.6%   757  212s
  2741  2226 37492.5394   15  226 28153.8870 39223.9673  39.3%   737  219s
  2941  2341 36574.1458   17  309 28153.8870 39206.1644  39.3%   727  225s
  3135  2423 34650.6550   22  194 28153.8870 39165.2781  39.1%   721  230s
  3421  2601     cutoff   42      28153.8870 39122.9732  39.0%   724  239s
  3611  2709 32245.7628    9  374 28153.8870 39122.9732  39.0%   718  245s
  3844  2820 31884.6204   10  321 28153.8870 39122.9732  39.0%   713  250s
  4015  2840 29314.5485   11  227 28153.8870 38977.3772  38.4%   718  256s
  4059  2871 30357.6411   10  349 28153.8870 38926.7923  38.3%   722  263s
H 4085  2870                    28211.360679 38926.7923  38.0%   724  263s
  4093  2871 36963.8108    7  431 28211.3607 38926.7923  38.0%   724  282s
  4095  2872 33832.7942   17   80 28211.3607 38926.7923  38.0%   724  294s
  4096  2873 37869.8188   12  328 28211.3607 38926.7923  38.0%   724  302s
  4097  2874 38290.1037   14  331 28211.3607 38926.7923  38.0%   723  306s
  4099  2875 35728.3391   23  371 28211.3607 38926.7923  38.0%   723  311s
  4102  2877 35729.1512   20  424 28211.3607 38926.7923  38.0%   722  315s
  4109  2882 29874.6366   28  439 28211.3607 38926.7923  38.0%   721  322s
  4113  2884 35140.7988   25  448 28211.3607 38926.7923  38.0%   721  325s
  4116  2886 34245.8998   31  445 28211.3607 38926.7923  38.0%   720  330s
  4119  2888 36939.1016   17  395 28211.3607 38926.7923  38.0%   719  335s
  4123  2891 35026.7919   15  445 28211.3607 38926.7923  38.0%   719  341s
  4126  2893 30432.4725   20  458 28211.3607 38926.7923  38.0%   718  346s
  4129  2895 35997.6174   20  449 28211.3607 38926.7923  38.0%   718  350s
  4131  2896 34925.0054   25  478 28211.3607 38926.7923  38.0%   717  365s
  4132  2897 30795.8136   49  478 28211.3607 38926.7923  38.0%   717  373s
  4133  2901 38926.7923   15  444 28211.3607 38926.7923  38.0%   734  380s
  4135  2904 38926.7923   16  413 28211.3607 38926.7923  38.0%   734  385s
  4139  2911 38926.7923   17  415 28211.3607 38926.7923  38.0%   737  394s
  4147  2924 38926.7923   18  439 28211.3607 38926.7923  38.0%   741  401s
  4163  2947 38926.7923   19  433 28211.3607 38926.7923  38.0%   762  408s
  4195  2968 38926.7923   20  376 28211.3607 38926.7923  38.0%   774  415s
  4227  3011 38926.7923   21  377 28211.3607 38926.7923  38.0%   784  423s
  4283  3043 38652.1839   23  359 28211.3607 38926.7923  38.0%   809  429s
  4342  3081 37912.4935   23  297 28211.3607 38926.7923  38.0%   833  438s
  4410  3108 33034.6256   24  368 28211.3607 38926.7923  38.0%   849  444s
  4478  3132 38178.0614   25  358 28211.3607 38926.7923  38.0%   860  453s
  4553  3149 37997.5487   26  287 28211.3607 38926.7923  38.0%   867  457s
  4633  3153 37650.0799   27  313 28211.3607 38926.7923  38.0%   873  462s
  4708  3161 35692.6736   28  202 28211.3607 38926.7923  38.0%   878  465s
  4774  3161 33597.4291   29  189 28211.3607 38804.8255  37.6%   885  471s
  4844  3163 33921.8009   29  202 28211.3607 38804.8255  37.6%   890  478s
  4914  3171 32990.8457   30  199 28211.3607 38797.6249  37.5%   898  483s
  4971  3178 32118.6377   31  152 28211.3607 38797.6249  37.5%   906  490s
  5044  3167 29250.4288   32  248 28211.3607 38797.6249  37.5%   911  496s
  5109  3164     cutoff   33      28211.3607 38545.0561  36.6%   919  503s
  5194  3163 33830.4962   22  321 28211.3607 38375.6800  36.0%   930  507s
  5248  3172 33530.1148   23  257 28211.3607 38226.0568  35.5%   932  512s
  5336  3166 33338.2265   25  240 28211.3607 38226.0568  35.5%   937  519s
  5426  3159 32380.5234   27  252 28211.3607 37909.2497  34.4%   943  526s
  5538  3141 31398.9582   29  219 28211.3607 37909.2497  34.4%   948  531s
  5634  3142 infeasible   31      28211.3607 37789.8854  34.0%   955  538s
  5746  3145 35440.1313   24  292 28211.3607 37789.8854  34.0%   962  544s
  5843  3146 34557.2284   26  197 28211.3607 37535.6141  33.1%   967  550s
  5970  3118 33750.7554   28  188 28211.3607 37535.6141  33.1%   971  557s
  6079  3099 30060.3943   30  110 28211.3607 37526.6447  33.0%   973  563s
  6207  3091 28560.7824   31  210 28211.3607 37291.2762  32.2%   977  570s
  6338  3058 33268.2433   29  278 28211.3607 37248.9291  32.0%   984  578s
  6454  3039 29781.7771   32  172 28211.3607 37111.7978  31.5%   987  584s
  6495  3046     cutoff   33      28211.3607 37111.7978  31.5%   988  590s
  6537  3048     cutoff   33      28211.3607 37111.7978  31.5%   992  596s
  6580  3027 33769.8830   22  328 28211.3607 37075.7800  31.4%   993  603s
  6655  3022 33434.8876   23  314 28211.3607 37075.7800  31.4%   994  614s
  6730  3025 32443.0201   24  290 28211.3607 36919.4730  30.9%   996  621s
  6860  3001 30872.6353   28  158 28211.3607 36897.8628  30.8%   998  629s
  7033  2974 31979.2692   26  327 28211.3607 36752.4767  30.3%  1005  637s
  7212  2943 31453.0325   28  274 28211.3607 36519.9998  29.5%  1009  646s
  7420  2873     cutoff   29      28211.3607 36503.0196  29.4%  1015  657s
  7639  2837 29427.9152   24  346 28211.3607 36363.4282  28.9%  1022  666s
  7863  2804     cutoff   30      28211.3607 35917.8893  27.3%  1027  677s
  8131  2755 29657.7037   29  274 28211.3607 35841.4523  27.0%  1030  687s
  8424  2683 32173.2849   30  187 28211.3607 35793.8763  26.9%  1029  696s
  8715  2607 31334.2944   29  227 28211.3607 35719.3943  26.6%  1032  707s
  8988  2495     cutoff   31      28211.3607 35508.1459  25.9%  1038  719s
  9331  2349     cutoff   30      28211.3607 34835.2131  23.5%  1042  730s
  9693  2204 28479.2518   35  239 28211.3607 34504.6215  22.3%  1042  739s
 10057  2048 30408.2896   32  210 28211.3607 34232.3801  21.3%  1042  750s
 10446  1865     cutoff   30      28211.3607 34001.7780  20.5%  1043  761s
 10865  1615 31068.2174   28  210 28211.3607 33863.7088  20.0%  1041  774s
 11304  1362 29154.0902   30  256 28211.3607 33324.3213  18.1%  1039  785s
 11788  1062 30919.1149   28  180 28211.3607 33029.0136  17.1%  1033  797s
 12333   614 29039.6666   27  209 28211.3607 32450.6131  15.0%  1025  810s
 12955    95     cutoff   25      28211.3607 31809.1009  12.8%  1010  821s

Cutting planes:
  Learned: 1
  MIR: 253
  Flow cover: 915
  RLT: 15
  Relax-and-lift: 73

Explored 13765 nodes (13565536 simplex iterations) in 824.40 seconds (1579.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 28211.4 28153.9 27178.1 ... 8576.79

Optimal solution found (tolerance 1.00e-06)
Best objective 2.821136067939e+04, best bound 2.821136067939e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 824.41s
  Master Objective (UB) = 28211.36, θ = 171638.28
  Upper Bound (UB) = 28211.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171638.28
  [DEBUG]   ✓ Scenario 0: θ = 171638.28 ≤ Q = 171638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171638.28 ≤ Q = 171638.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171638.28 ≤ Q = 171638.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171638.28 ≤ Q = 171638.28 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2e407e6b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2e407e6b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.377418e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6653566.6568
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.583035e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158303.51    0  124 6653566.66 -158303.51   102%     -    0s
H    0     0                    -123204.5963 -158303.51  28.5%     -    0s
H    0     0                    -123467.8488 -158303.51  28.2%     -    0s
H    0     0                    -127536.9213 -158303.51  24.1%     -    0s
H    0     0                    -128243.7385 -141452.16  10.3%     -    0s
     0     0 -141452.16    0   68 -128243.74 -141452.16  10.3%     -    0s
H    0     0                    -138067.7660 -141350.22  2.38%     -    0s
H    0     0                    -139335.4089 -141350.22  1.45%     -    0s
     0     0 -140549.31    0   70 -139335.41 -140549.31  0.87%     -    0s
H    0     0                    -139342.9502 -140524.34  0.85%     -    0s
     0     0 -140059.41    0   66 -139342.95 -140059.41  0.51%     -    0s
     0     0 -140052.80    0   66 -139342.95 -140052.80  0.51%     -    0s
H    0     0                    -139392.1422 -140052.80  0.47%     -    0s
     0     0 -139883.20    0   36 -139392.14 -139883.20  0.35%     -    0s
     0     0 -139702.24    0   37 -139392.14 -139702.24  0.22%     -    0s
     0     0 -139687.48    0   34 -139392.14 -139687.48  0.21%     -    0s
     0     0 -139645.02    0   25 -139392.14 -139645.02  0.18%     -    0s
     0     0 -139628.55    0   33 -139392.14 -139628.55  0.17%     -    0s
     0     0 -139624.35    0   24 -139392.14 -139624.35  0.17%     -    0s
     0     0 -139579.36    0   17 -139392.14 -139579.36  0.13%     -    0s
     0     0 -139579.36    0   21 -139392.14 -139579.36  0.13%     -    0s
H    0     0                    -139423.3661 -139579.36  0.11%     -    0s
     0     0 -139522.14    0    3 -139423.37 -139522.14  0.07%     -    0s
H    0     0                    -139483.1131 -139517.18  0.02%     -    0s
*    0     0               0    -139516.8802 -139516.88  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 13
  Flow cover: 8

Explored 1 nodes (844 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -139517 -139483 -139423 ... -123468
No other solutions better than -139517

Optimal solution found (tolerance 1.00e-06)
Best objective -1.395168802161e+05, best bound -1.395168802161e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 159630.93
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139516.88
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -139516.88 = 159630.93
  [DEBUG]   Current θ from Master = 171638.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12007.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16204.02
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 3357.6787, Absolute Gap = 3357.6787, Relative Gap = 0.119019
  Not converged yet (gap = 3357.68 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x27d2cbbb
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35470 rows and 14410 columns
Presolve time: 1.72s
Presolved: 42363 rows, 19050 columns, 262709 nonzeros
Variable types: 16791 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -222583.0639

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42363 rows, 19050 columns, 262709 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22612    1.7205137e+04   0.000000e+00   7.774480e+06      5s
   33590    3.7176644e+04   0.000000e+00   8.440345e+05     10s
Concurrent spin time: 1.08s

Solved with dual simplex

Root relaxation: objective 5.270266e+04, 28728 iterations, 12.96 seconds (17.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52702.6579    0  159 -222583.06 52702.6579   124%     -   15s
H    0     0                    -213887.6736 52702.6579   125%     -   15s
H    0     0                    -129624.0039 52702.6579   141%     -   15s
H    0     0                    -112597.7952 52702.6579   147%     -   15s
H    0     0                    -112531.6882 52702.6579   147%     -   15s
H    0     0                    -41781.98050 52702.6579   226%     -   15s
H    0     0                    -41400.75499 52702.6579   227%     -   15s
H    0     0                    -18723.21533 52702.6579   381%     -   15s
H    0     0                    1522.4122638 52702.6579  3362%     -   15s
H    0     0                    8138.7121338 52702.6579   548%     -   15s
H    0     0                    23558.079770 52702.6579   124%     -   16s
H    0     0                    23822.236175 52702.6579   121%     -   16s
H    0     0                    24851.829948 52702.6579   112%     -   16s
H    0     0                    25090.141702 48201.8093  92.1%     -   22s
     0     0 48201.8093    0  189 25090.1417 48201.8093  92.1%     -   22s
     0     0 47413.1740    0  283 25090.1417 47413.1740  89.0%     -   26s
     0     0 47386.2599    0  231 25090.1417 47386.2599  88.9%     -   26s
     0     0 47386.2599    0  238 25090.1417 47386.2599  88.9%     -   27s
     0     0 47386.2599    0  243 25090.1417 47386.2599  88.9%     -   27s
     0     0 47386.2599    0  245 25090.1417 47386.2599  88.9%     -   27s
     0     0 45561.7802    0  276 25090.1417 45561.7802  81.6%     -   33s
     0     0 45189.2013    0  288 25090.1417 45189.2013  80.1%     -   37s
     0     0 44897.1170    0  288 25090.1417 44897.1170  78.9%     -   38s
     0     0 44662.5172    0  293 25090.1417 44662.5172  78.0%     -   40s
     0     0 44603.8587    0  309 25090.1417 44603.8587  77.8%     -   41s
     0     0 44588.0698    0  309 25090.1417 44588.0698  77.7%     -   41s
     0     0 44586.8527    0  307 25090.1417 44586.8527  77.7%     -   41s
H    0     0                    25422.499880 44586.8527  75.4%     -   45s
H    0     0                    25454.619627 44586.8527  75.2%     -   45s
H    0     0                    25786.566700 44586.8527  72.9%     -   45s
     0     0 43199.1699    0  323 25786.5667 43199.1699  67.5%     -   51s
H    0     0                    25794.326166 43199.1010  67.5%     -   51s
H    0     0                    25800.845280 43199.1010  67.4%     -   51s
     0     0 42985.3736    0  334 25800.8453 42985.3736  66.6%     -   53s
     0     0 42849.2785    0  336 25800.8453 42849.2785  66.1%     -   55s
     0     0 42787.4818    0  331 25800.8453 42787.4818  65.8%     -   57s
     0     0 42771.9682    0  324 25800.8453 42771.9682  65.8%     -   58s
     0     0 42756.6290    0  326 25800.8453 42756.6290  65.7%     -   60s
     0     0 42741.6384    0  334 25800.8453 42741.6384  65.7%     -   61s
     0     0 42739.4724    0  334 25800.8453 42739.4724  65.7%     -   61s
     0     0 42738.6525    0  337 25800.8453 42738.6525  65.6%     -   62s
     0     0 41853.2016    0  361 25800.8453 41853.2016  62.2%     -   69s
     0     0 41645.0849    0  359 25800.8453 41645.0849  61.4%     -   72s
     0     0 41506.4911    0  408 25800.8453 41506.4911  60.9%     -   74s
     0     0 41467.5319    0  410 25800.8453 41467.5319  60.7%     -   75s
     0     0 41431.3680    0  408 25800.8453 41431.3680  60.6%     -   77s
     0     0 41394.4064    0  422 25800.8453 41394.4064  60.4%     -   78s
     0     0 41380.7088    0  421 25800.8453 41380.7088  60.4%     -   79s
     0     0 41374.0224    0  422 25800.8453 41374.0224  60.4%     -   79s
     0     0 41371.8519    0  415 25800.8453 41371.8519  60.4%     -   79s
     0     0 41370.6903    0  418 25800.8453 41370.6903  60.3%     -   79s
     0     0 41303.1412    0  381 25800.8453 41303.1412  60.1%     -   81s
     0     0 41282.6401    0  384 25800.8453 41282.6401  60.0%     -   82s
     0     0 41250.4673    0  394 25800.8453 41250.4673  59.9%     -   84s
     0     0 41225.6075    0  393 25800.8453 41225.6075  59.8%     -   85s
     0     0 41214.0471    0  393 25800.8453 41214.0471  59.7%     -   85s
     0     0 41212.0580    0  397 25800.8453 41212.0580  59.7%     -   86s
     0     0 41208.2424    0  398 25800.8453 41208.2424  59.7%     -   86s
     0     0 41206.7764    0  396 25800.8453 41206.7764  59.7%     -   86s
     0     0 41206.3631    0  397 25800.8453 41206.3631  59.7%     -   86s
     0     0 41179.7596    0  449 25800.8453 41179.7596  59.6%     -   88s
     0     0 41159.1223    0  443 25800.8453 41159.1223  59.5%     -   90s
     0     0 41149.8920    0  393 25800.8453 41149.8920  59.5%     -   90s
     0     0 41141.7282    0  401 25800.8453 41141.7282  59.5%     -   91s
     0     0 41136.4574    0  406 25800.8453 41136.4574  59.4%     -   91s
     0     0 41134.5367    0  403 25800.8453 41134.5367  59.4%     -   91s
     0     0 41133.6884    0  405 25800.8453 41133.6884  59.4%     -   91s
     0     0 41109.5202    0  443 25800.8453 41109.5202  59.3%     -   92s
     0     0 41103.0331    0  448 25800.8453 41103.0331  59.3%     -   93s
     0     0 41100.6506    0  449 25800.8453 41100.6506  59.3%     -   93s
     0     0 41098.6793    0  454 25800.8453 41098.6793  59.3%     -   93s
     0     0 41098.1277    0  452 25800.8453 41098.1277  59.3%     -   94s
     0     0 41080.5986    0  403 25800.8453 41080.5986  59.2%     -   95s
H    0     0                    25906.041314 41080.2711  58.6%     -   98s
     0     0 41071.0298    0  407 25906.0413 41071.0298  58.5%     -   99s
     0     0 41065.4517    0  457 25906.0413 41065.4517  58.5%     -  100s
     0     0 41062.8442    0  411 25906.0413 41062.8442  58.5%     -  100s
     0     0 41061.8922    0  411 25906.0413 41061.8922  58.5%     -  100s
     0     0 41047.4602    0  414 25906.0413 41047.4602  58.4%     -  101s
     0     0 41044.8867    0  410 25906.0413 41044.8867  58.4%     -  102s
     0     0 41043.5102    0  460 25906.0413 41043.5102  58.4%     -  102s
     0     0 41036.6070    0  410 25906.0413 41036.6070  58.4%     -  104s
     0     0 41034.0441    0  417 25906.0413 41034.0441  58.4%     -  104s
     0     0 41026.3772    0  416 25906.0413 41026.3772  58.4%     -  104s
     0     0 41023.7046    0  464 25906.0413 41023.7046  58.4%     -  105s
     0     0 41020.6850    0  456 25906.0413 41020.6850  58.3%     -  105s
     0     0 41017.4391    0  464 25906.0413 41017.4391  58.3%     -  105s
     0     0 41016.5967    0  464 25906.0413 41016.5967  58.3%     -  105s
     0     0 41012.6521    0  412 25906.0413 41012.6521  58.3%     -  107s
     0     0 41008.0117    0  462 25906.0413 41008.0117  58.3%     -  107s
     0     0 41005.6918    0  464 25906.0413 41005.6918  58.3%     -  108s
     0     0 41005.0819    0  462 25906.0413 41005.0819  58.3%     -  108s
     0     0 41003.1882    0  461 25906.0413 41003.1882  58.3%     -  109s
     0     0 41001.4461    0  468 25906.0413 41001.4461  58.3%     -  109s
     0     0 41000.3770    0  464 25906.0413 41000.3770  58.3%     -  109s
     0     0 40998.6559    0  467 25906.0413 40998.6559  58.3%     -  110s
     0     0 40997.7650    0  468 25906.0413 40997.7650  58.3%     -  111s
     0     0 40994.0461    0  456 25906.0413 40994.0461  58.2%     -  112s
     0     0 40992.8013    0  456 25906.0413 40992.8013  58.2%     -  113s
H    0     0                    26079.237668 40989.8186  57.2%     -  140s
     0     2 40989.8186    0  456 26079.2377 40989.8186  57.2%     -  140s
     3     8 40728.7718    2  386 26079.2377 40831.5286  56.6%  3093  149s
     7    16 40650.0682    3  402 26079.2377 40725.1382  56.2%  3751  153s
    15    32 40385.6466    4  450 26079.2377 40649.2517  55.9%  3840  159s
    31    58 38792.8631    5  354 26079.2377 40385.5697  54.9%  5670  172s
H   57    90                    26093.046232 40384.5224  54.8%  5282  179s
H   66    90                    26140.272110 40384.5224  54.5%  5040  179s
    89   174 38760.9349    7  308 26140.2721 40384.5224  54.5%  4111  187s
   173   275 38674.3062   10  300 26140.2721 40384.5224  54.5%  2655  197s
H  184   275                    26197.505001 40384.5224  54.2%  2612  197s
   280   359 38259.7656   12  242 26197.5050 40384.5224  54.2%  2302  206s
   374   420 38215.1047   13  242 26197.5050 40384.5224  54.2%  2109  214s
   449   484 38123.1041   14  240 26197.5050 40384.5224  54.2%  2123  224s
   525   530 37822.3881   13  232 26197.5050 40384.5224  54.2%  2041  227s
   581   598 37827.8293   15  282 26197.5050 40384.5224  54.2%  1986  233s
   661   644 36851.8332   15  197 26197.5050 40106.1866  53.1%  1912  238s
   719   710 37789.2533   15  284 26197.5050 40106.1866  53.1%  1861  243s
   797   759 37345.4561   16  286 26197.5050 40106.1866  53.1%  1781  249s
   866   816 37636.0022   16  272 26197.5050 40106.1866  53.1%  1769  258s
   947   876 37572.8746   17  262 26197.5050 40106.1866  53.1%  1736  263s
  1023   913 37538.8725   18  195 26197.5050 40106.1866  53.1%  1715  272s
  1080   973 37085.9468   19  329 26197.5050 40063.3513  52.9%  1714  278s
  1162  1058 35286.4143   20  304 26197.5050 40063.3513  52.9%  1700  282s
  1259  1151 32330.8536   18  211 26197.5050 40063.3513  52.9%  1654  292s
  1369  1275 35512.8918   21  173 26197.5050 40063.3513  52.9%  1598  297s
  1520  1393 35088.4826   22  183 26197.5050 40063.3513  52.9%  1515  303s
  1670  1535 34642.9563   23  147 26197.5050 40063.3513  52.9%  1456  310s
  1832  1709 34241.1929   26  165 26197.5050 39746.2799  51.7%  1399  315s
  2036  1912 34059.1153   27  144 26197.5050 39746.2799  51.7%  1324  325s
  2475  2309 32737.5489   32  169 26197.5050 39600.3267  51.2%  1194  336s
  2743  2538 32439.3797   35  198 26197.5050 39600.3267  51.2%  1132  345s
  3012  2694 32055.7230   38  180 26197.5050 39482.8277  50.7%  1085  354s
  3276  2789 31880.8163   41  152 26197.5050 39482.8277  50.7%  1050  362s
  3461  2865 infeasible   42      26197.5050 39482.8277  50.7%  1048  369s
  3559  2921 infeasible   44      26197.5050 39482.8277  50.7%  1058  375s
  3650  2922 29011.7249   49  456 26197.5050 39252.4020  49.8%  1058  405s
  3652  2923 26894.9673   63  159 26197.5050 39252.4020  49.8%  1057  427s
  3653  2924 30875.0249   50  290 26197.5050 39252.4020  49.8%  1057  440s
  3654  2925 37162.3639   17  329 26197.5050 39252.4020  49.8%  1057  449s
  3655  2925 32092.7974   44  409 26197.5050 39252.4020  49.8%  1057  454s
  3656  2926 33601.6443   25  379 26197.5050 39252.4020  49.8%  1056  457s
  3657  2927 29424.5675   43  399 26197.5050 39252.4020  49.8%  1056  460s
  3660  2929 34279.9866   31  445 26197.5050 39252.4020  49.8%  1055  465s
  3665  2932 32323.1616   41  401 26197.5050 39252.4020  49.8%  1054  470s
  3666  2933 37072.0953   16  435 26197.5050 39252.4020  49.8%  1053  475s
  3670  2935 33675.7660   44  398 26197.5050 39252.4020  49.8%  1052  481s
  3673  2937 29333.2132   78  442 26197.5050 39252.4020  49.8%  1051  487s
  3676  2939 36759.0110   12  438 26197.5050 39252.4020  49.8%  1051  492s
  3678  2941 29790.7278   61  448 26197.5050 39252.4020  49.8%  1050  498s
  3680  2942 28676.7884   69  447 26197.5050 39252.4020  49.8%  1049  500s
  3682  2943 29294.5340   16  456 26197.5050 39252.4020  49.8%  1049  505s
  3684  2945 32271.2661   11  444 26197.5050 39252.4020  49.8%  1048  510s
  3687  2947 36739.8979   16  439 26197.5050 39252.4020  49.8%  1047  518s
  3688  2947 34867.2833   29  439 26197.5050 39252.4020  49.8%  1047  539s
  3689  2948 35122.2833   16  439 26197.5050 39252.4020  49.8%  1047  552s
  3690  2952 39252.4020   12  429 26197.5050 39252.4020  49.8%  1078  565s
  3692  2955 39252.4020   13  446 26197.5050 39252.4020  49.8%  1079  572s
  3696  2962 39252.4020   14  435 26197.5050 39252.4020  49.8%  1082  581s
  3704  2975 39252.4020   15  376 26197.5050 39252.4020  49.8%  1089  595s
  3720  2990 39252.4020   16  319 26197.5050 39252.4020  49.8%  1121  613s
  3740  3012 39252.4020   17  369 26197.5050 39252.4020  49.8%  1148  625s
  3772  3108 39252.4020   18  365 26197.5050 39252.4020  49.8%  1167  642s
  3896  3115 33500.5682   20  322 26197.5050 39252.4020  49.8%  1201  656s
  3966  3114 38302.5085   21  234 26197.5050 39252.4020  49.8%  1252  664s
H 3991  2956                    26306.202333 39252.4020  49.2%  1254  664s
  4014  2979 38945.4383   21  266 26306.2023 39252.4020  49.2%  1263  673s
  4101  2987 35764.1171   23  243 26306.2023 39252.4020  49.2%  1278  680s
H 4102  2846                    26677.359888 39252.4020  47.1%  1278  680s
H 4107  2711                    26846.707581 39252.4020  46.2%  1279  680s
H 4134  2575                    27189.124652 39252.4020  44.4%  1283  680s
  4154  2583 34947.5042   23  218 27189.1247 39252.4020  44.4%  1285  688s
  4237  2584 33403.9495   24  216 27189.1247 39252.4020  44.4%  1297  697s
H 4241  2463                    27389.593884 39252.4020  43.3%  1297  697s
H 4247  2346                    27714.071233 39252.4020  41.6%  1300  697s
  4287  2376     cutoff   25      27714.0712 39252.4020  41.6%  1304  705s
  4367  2370     cutoff   26      27714.0712 39250.7485  41.6%  1313  713s
H 4378  2257                    27943.045152 39250.7485  40.5%  1314  713s
  4427  2266 28905.1494   27  194 27943.0452 39250.7485  40.5%  1319  724s
  4503  2263     cutoff   29      27943.0452 39250.7485  40.5%  1330  732s
  4566  2265     cutoff   29      27943.0452 38350.0961  37.2%  1338  740s
  4639  2267 36191.3875   19  323 27943.0452 38350.0961  37.2%  1352  748s
  4717  2262 35908.6629   20  314 27943.0452 38314.0519  37.1%  1362  756s
  4771  2261 35134.0668   21  321 27943.0452 38314.0519  37.1%  1372  763s
  4814  2273 34985.7487   22  313 27943.0452 38314.0519  37.1%  1380  771s
  4860  2277 32718.2571   24  329 27943.0452 38210.1012  36.7%  1391  780s
  4916  2284 28177.8005   26  321 27943.0452 38210.1012  36.7%  1401  790s
  4980  2285 30713.4078   18  406 27943.0452 38210.1012  36.7%  1410  801s
  5057  2257 30597.0144   19  357 27943.0452 38210.1012  36.7%  1418  809s
  5154  2255     cutoff   20      27943.0452 38035.8502  36.1%  1428  819s
  5255  2240 28602.2477   20  273 27943.0452 37544.0130  34.4%  1439  827s
  5375  2216 28234.7556   21  263 27943.0452 37544.0130  34.4%  1444  836s
  5494  2193 28050.3821   22  261 27943.0452 37221.5544  33.2%  1453  842s
  5535  2183     cutoff   23      27943.0452 37137.0029  32.9%  1455  853s
  5619  2171     cutoff   22      27943.0452 37137.0029  32.9%  1459  862s
  5700  2143     cutoff   24      27943.0452 37079.4668  32.7%  1469  873s
  5832  2106 35275.7457   21  319 27943.0452 37000.4109  32.4%  1474  883s
  5963  2112 28164.4846   22  175 27943.0452 36729.7036  31.4%  1487  891s
  6094  2089     cutoff   23      27943.0452 36591.1403  30.9%  1497  903s
  6253  2062 29974.3392   22  257 27943.0452 36458.9115  30.5%  1506  914s
  6432  2017     cutoff   25      27943.0452 36354.6889  30.1%  1510  929s
  6610  2011 infeasible   26      27943.0452 36171.7428  29.4%  1520  941s
  6790  1962 33093.8834   19  322 27943.0452 36129.6092  29.3%  1527  957s
  6996  1922 31662.9740   23  211 27943.0452 36075.3482  29.1%  1532  970s
  7243  1857     cutoff   27      27943.0452 35952.1546  28.7%  1529  982s
  7489  1816 33615.5059   23  241 27943.0452 35506.5121  27.1%  1530  996s
  7719  1753 31104.0518   25  227 27943.0452 35427.8355  26.8%  1535 1014s
  7969  1667     cutoff   29      27943.0452 35037.6399  25.4%  1537 1032s
  8242  1603 infeasible   24      27943.0452 34825.1682  24.6%  1539 1046s
  8550  1509 27971.3351   37  114 27943.0452 34484.1873  23.4%  1535 1063s
  8864  1403 28043.6597   24  253 27943.0452 34246.3992  22.6%  1530 1079s
  9204  1276     cutoff   24      27943.0452 34036.1726  21.8%  1531 1096s
  9551  1142 infeasible   27      27943.0452 33901.9587  21.3%  1530 1115s
  9972   989 29217.7079   29   95 27943.0452 33534.9961  20.0%  1524 1136s
 10327   944 28459.1862   30   50 27943.0452 33209.6950  18.8%  1523 1153s
 10820   858     cutoff   20      27943.0452 32556.4728  16.5%  1512 1169s
 11219   727 29040.6123   26  214 27943.0452 32309.1805  15.6%  1502 1188s
 11640   564 29944.3282   20  262 27943.0452 32061.9123  14.7%  1490 1207s
 12307   208 infeasible   25      27943.0452 31125.8276  11.4%  1464 1223s
 13415    81     cutoff   30      27943.0452 30321.0979  8.51%  1383 1232s
 14919     0 28052.0157   41   12 27943.0452 28091.2822  0.53%  1253 1235s

Cutting planes:
  MIR: 410
  Mixing: 1
  Flow cover: 1271
  RLT: 17
  Relax-and-lift: 106

Explored 15010 nodes (18828512 simplex iterations) in 1235.04 seconds (2348.24 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 27943 27714.1 27389.6 ... 26093

Optimal solution found (tolerance 1.00e-06)
Best objective 2.794304515160e+04, best bound 2.794304515160e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1235.05s
  Master Objective (UB) = 27943.05, θ = 172131.74
  Upper Bound (UB) = 27943.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172131.74
  [DEBUG]   ✓ Scenario 0: θ = 172131.74 ≤ Q = 172131.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172131.74 ≤ Q = 172131.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172131.74 ≤ Q = 172131.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172131.74 ≤ Q = 172131.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172131.74 ≤ Q = 172131.74 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6d3af763
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x92c5089d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-15, 2e+02]
Found heuristic solution: objective 1.375947e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6663914.6606
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.574203e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157420.28    0  124 6663914.66 -157420.28   102%     -    0s
H    0     0                    -122333.3578 -157420.28  28.7%     -    0s
H    0     0                    -122596.6104 -157420.28  28.4%     -    0s
H    0     0                    -125687.4024 -157420.28  25.2%     -    0s
H    0     0                    -126461.7231 -139208.07  10.1%     -    0s
H    0     0                    -127835.2094 -139208.07  8.90%     -    0s
     0     0 -139208.07    0  107 -127835.21 -139208.07  8.90%     -    0s
H    0     0                    -135178.6866 -139179.29  2.96%     -    0s
     0     0 -138013.32    0  112 -135178.69 -138013.32  2.10%     -    0s
H    0     0                    -136109.3141 -138000.15  1.39%     -    0s
     0     0 -138000.15    0  112 -136109.31 -138000.15  1.39%     -    0s
H    0     0                    -136179.2331 -138000.15  1.34%     -    0s
H    0     0                    -136209.6660 -137283.48  0.79%     -    0s
     0     0 -137283.48    0   56 -136209.67 -137283.48  0.79%     -    0s
     0     0 -137235.15    0   59 -136209.67 -137235.15  0.75%     -    0s
     0     0 -137143.94    0   71 -136209.67 -137143.94  0.69%     -    0s
     0     0 -137126.58    0   53 -136209.67 -137126.58  0.67%     -    0s
     0     0 -136959.27    0   56 -136209.67 -136959.27  0.55%     -    0s
     0     0 -136925.30    0   55 -136209.67 -136925.30  0.53%     -    0s
     0     0 -136922.99    0   55 -136209.67 -136922.99  0.52%     -    0s
     0     0 -136856.41    0   45 -136209.67 -136856.41  0.47%     -    0s
H    0     0                    -136602.2267 -136852.86  0.18%     -    0s
     0     0 -136852.86    0   48 -136602.23 -136852.86  0.18%     -    0s
     0     0 -136833.51    0   53 -136602.23 -136833.51  0.17%     -    0s
     0     0 -136831.89    0   53 -136602.23 -136831.89  0.17%     -    0s
     0     0 -136831.89    0   45 -136602.23 -136831.89  0.17%     -    0s
H    0     0                    -136731.0633 -136831.89  0.07%     -    0s
     0     0 -136831.89    0   51 -136731.06 -136831.89  0.07%     -    0s
     0     0 -136831.89    0   41 -136731.06 -136831.89  0.07%     -    0s
     0     0 -136817.70    0    2 -136731.06 -136817.70  0.06%     -    0s
*    0     0               0    -136816.8144 -136816.81  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 3
  MIR: 48
  Flow cover: 14
  RLT: 1

Explored 1 nodes (948 simplex iterations) in 0.18 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -136817 -136731 -136602 ... -122597
No other solutions better than -136817

Optimal solution found (tolerance 1.00e-06)
Best objective -1.368168143728e+05, best bound -1.368168143728e+05, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 161814.16
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136816.81
  [DEBUG]   S×d_nominal = 298630.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298630.97 + -136816.81 = 161814.16
  [DEBUG]   Current θ from Master = 172131.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10317.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17625.47
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 3089.3632, Absolute Gap = 3089.3632, Relative Gap = 0.110559
  Not converged yet (gap = 3089.36 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x77500626
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42580 rows and 17300 columns
Presolve time: 1.41s
Presolved: 50543 rows, 22400 columns, 314099 nonzeros
Variable types: 20141 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -222583.0639

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50543 rows, 22400 columns, 314099 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27232   -4.3180214e+04   0.000000e+00   5.688739e+06      5s
   38206    1.4461517e+04   0.000000e+00   1.608640e+08     10s
   47041    3.4433034e+04   0.000000e+00   1.129616e+07     15s
   54870    3.9503066e+04   0.000000e+00   3.292726e+06     20s
   62152    4.3840931e+04   0.000000e+00   2.795462e+07     25s
   68407    4.6633346e+04   0.000000e+00   1.824531e+07     30s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 5.270266e+04, 36877 iterations, 31.28 seconds (41.61 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52702.6579    0  159 -222583.06 52702.6579   124%     -   33s
H    0     0                    -215135.3696 52702.6579   124%     -   33s
H    0     0                    -139044.5802 52702.6579   138%     -   33s
H    0     0                    -44867.89506 52702.6579   217%     -   33s
H    0     0                    -44486.66955 52702.6579   218%     -   33s
H    0     0                    24346.857673 52702.6579   116%     -   33s
H    0     0                    24838.461681 52702.6579   112%     -   34s
H    0     0                    24851.829948 52702.6579   112%     -   34s
H    0     0                    25090.141702 48486.3983  93.2%     -   44s
     0     0 48486.3983    0  111 25090.1417 48486.3983  93.2%     -   44s
     0     0 47402.0867    0  241 25090.1417 47402.0867  88.9%     -   50s
     0     0 47402.0867    0  279 25090.1417 47402.0867  88.9%     -   51s
     0     0 47402.0867    0  231 25090.1417 47402.0867  88.9%     -   52s
     0     0 47402.0867    0  285 25090.1417 47402.0867  88.9%     -   53s
     0     0 47401.7531    0  241 25090.1417 47401.7531  88.9%     -   53s
     0     0 47401.4601    0  241 25090.1417 47401.4601  88.9%     -   53s
     0     0 45112.5887    0  281 25090.1417 45112.5887  79.8%     -   64s
     0     0 44658.8384    0  286 25090.1417 44658.8384  78.0%     -   68s
     0     0 44565.8734    0  285 25090.1417 44565.8734  77.6%     -   69s
     0     0 44287.0150    0  292 25090.1417 44287.0150  76.5%     -   73s
     0     0 44230.0853    0  299 25090.1417 44230.0853  76.3%     -   74s
     0     0 44217.2192    0  295 25090.1417 44217.2192  76.2%     -   75s
     0     0 44207.6859    0  300 25090.1417 44207.6859  76.2%     -   75s
     0     0 44206.2079    0  308 25090.1417 44206.2079  76.2%     -   76s
     0     0 44205.5977    0  306 25090.1417 44205.5977  76.2%     -   76s
H    0     0                    25222.678524 44205.5977  75.3%     -   83s
     0     0 42756.5875    0  340 25222.6785 42756.5875  69.5%     -   92s
H    0     0                    25400.005947 42756.5214  68.3%     -   92s
H    0     0                    25642.666420 42756.5214  66.7%     -   92s
     0     0 42379.1931    0  341 25642.6664 42379.1931  65.3%     -   97s
     0     0 42225.8670    0  342 25642.6664 42225.8670  64.7%     -  101s
     0     0 42153.9885    0  353 25642.6664 42153.9885  64.4%     -  104s
     0     0 42118.0869    0  352 25642.6664 42118.0869  64.3%     -  105s
     0     0 42092.7677    0  353 25642.6664 42092.7677  64.2%     -  106s
     0     0 42084.5726    0  391 25642.6664 42084.5726  64.1%     -  108s
     0     0 42078.9098    0  402 25642.6664 42078.9098  64.1%     -  109s
     0     0 42078.2236    0  359 25642.6664 42078.2236  64.1%     -  109s
H    0     0                    26287.645534 41686.0049  58.6%     -  116s
     0     0 41686.0049    0  375 26287.6455 41686.0049  58.6%     -  116s
H    0     0                    26317.933703 41487.1038  57.6%     -  120s
     0     0 41487.1038    0  404 26317.9337 41487.1038  57.6%     -  120s
     0     0 41428.6892    0  374 26317.9337 41428.6892  57.4%     -  122s
     0     0 41399.6685    0  425 26317.9337 41399.6685  57.3%     -  123s
     0     0 41376.7477    0  427 26317.9337 41376.7477  57.2%     -  125s
     0     0 41364.9885    0  426 26317.9337 41364.9885  57.2%     -  126s
     0     0 41358.8178    0  426 26317.9337 41358.8178  57.2%     -  127s
     0     0 41350.0329    0  388 26317.9337 41350.0329  57.1%     -  128s
     0     0 41347.0715    0  391 26317.9337 41347.0715  57.1%     -  128s
     0     0 41341.9026    0  391 26317.9337 41341.9026  57.1%     -  129s
     0     0 41340.7896    0  395 26317.9337 41340.7896  57.1%     -  129s
     0     0 41284.4733    0  379 26317.9337 41284.4733  56.9%     -  132s
     0     0 41259.7602    0  382 26317.9337 41259.7602  56.8%     -  134s
     0     0 41255.2060    0  384 26317.9337 41255.2060  56.8%     -  135s
     0     0 41236.1473    0  384 26317.9337 41236.1473  56.7%     -  135s
     0     0 41225.0850    0  383 26317.9337 41225.0850  56.6%     -  136s
     0     0 41221.3747    0  389 26317.9337 41221.3747  56.6%     -  137s
     0     0 41220.2492    0  383 26317.9337 41220.2492  56.6%     -  137s
     0     0 41195.0865    0  388 26317.9337 41195.0865  56.5%     -  139s
     0     0 41188.0775    0  398 26317.9337 41188.0775  56.5%     -  143s
     0     0 41185.8126    0  403 26317.9337 41185.8126  56.5%     -  143s
     0     0 41183.7638    0  440 26317.9337 41183.7638  56.5%     -  144s
     0     0 41183.3230    0  446 26317.9337 41183.3230  56.5%     -  144s
     0     0 41165.0859    0  437 26317.9337 41165.0859  56.4%     -  145s
     0     0 41151.1044    0  442 26317.9337 41151.1044  56.4%     -  147s
     0     0 41145.4196    0  442 26317.9337 41145.4196  56.3%     -  147s
     0     0 41144.0085    0  440 26317.9337 41144.0085  56.3%     -  148s
     0     0 41143.0562    0  440 26317.9337 41143.0562  56.3%     -  148s
     0     0 41119.1730    0  435 26317.9337 41119.1730  56.2%     -  150s
H    0     0                    26493.917811 41119.0337  55.2%     -  154s
     0     0 41112.2283    0  445 26493.9178 41112.2283  55.2%     -  155s
     0     0 41110.1176    0  448 26493.9178 41110.1176  55.2%     -  155s
     0     0 41103.0719    0  436 26493.9178 41103.0719  55.1%     -  156s
     0     0 41097.5801    0  449 26493.9178 41097.5801  55.1%     -  157s
     0     0 41095.8506    0  449 26493.9178 41095.8506  55.1%     -  157s
     0     0 41094.1795    0  449 26493.9178 41094.1795  55.1%     -  158s
     0     0 41093.6135    0  448 26493.9178 41093.6135  55.1%     -  158s
     0     0 41078.1107    0  448 26493.9178 41078.1107  55.0%     -  160s
     0     0 41066.7273    0  435 26493.9178 41066.7273  55.0%     -  161s
     0     0 41061.4550    0  440 26493.9178 41061.4550  55.0%     -  162s
     0     0 41058.9013    0  453 26493.9178 41058.9013  55.0%     -  162s
     0     0 41058.4426    0  452 26493.9178 41058.4426  55.0%     -  163s
     0     0 41051.1993    0  453 26493.9178 41051.1993  54.9%     -  164s
     0     0 41050.1602    0  454 26493.9178 41050.1602  54.9%     -  165s
     0     0 41048.2876    0  449 26493.9178 41048.2876  54.9%     -  166s
     0     0 41044.4541    0  449 26493.9178 41044.4541  54.9%     -  167s
     0     0 41043.5235    0  449 26493.9178 41043.5235  54.9%     -  168s
     0     0 41042.7890    0  439 26493.9178 41042.7890  54.9%     -  169s
     0     0 41042.4996    0  443 26493.9178 41042.4996  54.9%     -  169s
     0     0 41042.4996    0  444 26493.9178 41042.4996  54.9%     -  170s
     0     0 41041.9452    0  444 26493.9178 41041.9452  54.9%     -  171s
H    0     0                    26530.444107 41041.6269  54.7%     -  194s
     0     2 41041.6269    0  444 26530.4441 41041.6269  54.7%     -  194s
     1     4 40822.0334    1  383 26530.4441 41041.6269  54.7%  2380  200s
     3     8 40666.3658    2  376 26530.4441 40820.4387  53.9%  4042  205s
     7    16 40305.5312    3  380 26530.4441 40661.1152  53.3%  4968  212s
    15    32 40157.3536    4  389 26530.4441 40305.2931  51.9%  4632  222s
    31    49 34653.4771    5  215 26530.4441 40157.2884  51.4%  5940  238s
    48    81 38827.9766    6  304 26530.4441 40157.2884  51.4%  5655  261s
    80   234 38629.1656    7  293 26530.4441 40157.2884  51.4%  4398  277s
   237   262 38206.5305   10  352 26530.4441 40157.2884  51.4%  2417  287s
H  238   262                    26534.399708 40157.2884  51.3%  2407  287s
   275   309 37924.2738   10  347 26534.3997 40157.2884  51.3%  2304  299s
   348   348 38214.4353   10  265 26534.3997 40157.2884  51.3%  2268  306s
   392   390 38143.1077    9  238 26534.3997 40157.2884  51.3%  2233  317s
   449   440 37928.4452    9  223 26534.3997 40157.2884  51.3%  2214  326s
   501   507 37999.4615   11  293 26534.3997 40157.2884  51.3%  2193  333s
   574   590 37743.0956   11  290 26534.3997 40157.2884  51.3%  2118  339s
   667   667 37782.9995   12  349 26534.3997 40157.2884  51.3%  1982  346s
   770   687 36616.9424   12  258 26534.3997 40157.2884  51.3%  1848  355s
   812   715 36626.3555   12  269 26534.3997 39990.8383  50.7%  1827  365s
H  827   715                    26558.337345 39990.8383  50.6%  1826  365s
   854   771 36999.6793   13  305 26558.3373 39990.8383  50.6%  1841  375s
   942   847 34283.4481   13  307 26558.3373 39990.8383  50.6%  1805  382s
  1039   946 36521.4249   14  253 26558.3373 39990.8383  50.6%  1758  388s
  1160  1044 35764.4517   16  187 26558.3373 39990.8383  50.6%  1677  397s
  1290  1141 35631.1162   17  168 26558.3373 39914.7262  50.3%  1603  404s
  1420  1195 34805.5645   19  162 26558.3373 39914.7262  50.3%  1551  412s
H 1432  1195                    26900.870654 39914.7262  48.4%  1545  412s
  1510  1272 35097.0527   19  147 26900.8707 39914.7262  48.4%  1531  424s
  1633  1355 34293.6694   20  163 26900.8707 39747.2234  47.8%  1505  433s
  1748  1439 34509.6042   21  139 26900.8707 39747.2234  47.8%  1498  440s
  1849  1469 28137.0781   23   89 26900.8707 39747.2234  47.8%  1501  448s
  1883  1489 28894.5133   22  129 26900.8707 39386.9983  46.4%  1514  454s
H 1911  1489                    26938.452499 39386.9983  46.2%  1522  454s
  1925  1595 33789.3753   24  276 26938.4525 39386.9983  46.2%  1525  465s
  2071  1616 33683.3184   26  184 26938.4525 39363.6228  46.1%  1499  476s
H 2076  1616                    26959.791610 39363.6228  46.0%  1499  476s
H 2106  1616                    27123.830326 39210.9204  44.6%  1503  476s
  2110  1724 33320.9561   26  187 27123.8303 39210.9204  44.6%  1503  485s
  2272  1754 33517.1020   30  252 27123.8303 39210.9204  44.6%  1483  490s
H 2291  1754                    27534.965464 39210.9204  42.4%  1484  490s
  2306  1866 33348.0699   31  246 27534.9655 39210.9204  42.4%  1485  501s
  2480  1963 32682.0476   35   98 27534.9655 39210.9204  42.4%  1449  511s
  2672  2109 32641.2808   36   90 27534.9655 38925.2202  41.4%  1425  519s
  2873  2282 32160.1226   37  108 27534.9655 38925.2202  41.4%  1398  531s
  3100  2442     cutoff   43      27534.9655 38925.2202  41.4%  1364  544s
  3340  2523 31426.4877   42   91 27534.9655 38846.2578  41.1%  1329  552s
H 3347  2511                    27614.482083 38846.2578  40.7%  1328  552s
H 3361  2498                    27746.075272 38846.2578  40.0%  1329  552s
H 3389  2481                    27834.997606 38846.2578  39.6%  1322  552s
  3461  2649 31338.5192   44   87 27834.9976 38846.2578  39.6%  1315  563s
  3708  2650 28493.5509   28  444 27834.9976 38690.4874  39.0%  1290  601s
  3710  2651 35351.7290   24  159 27834.9976 38690.4874  39.0%  1289  641s
  3711  2652 30073.5634   78  296 27834.9976 38690.4874  39.0%  1289  658s
  3712  2653 31020.8468   25  342 27834.9976 38690.4874  39.0%  1289  672s
  3713  2653 35390.7233   13  407 27834.9976 38690.4874  39.0%  1288  680s
  3714  2654 35396.7601   10  377 27834.9976 38690.4874  39.0%  1288  687s
  3715  2655 29869.4286   61  384 27834.9976 38690.4874  39.0%  1287  691s
  3717  2656 29801.1452   46  391 27834.9976 38690.4874  39.0%  1287  696s
  3719  2657 27949.3823   22  442 27834.9976 38690.4874  39.0%  1286  701s
  3722  2659 29365.0676   26  440 27834.9976 38690.4874  39.0%  1285  706s
  3724  2661 28330.4143   30  376 27834.9976 38690.4874  39.0%  1284  714s
  3725  2661 31312.1086   29  416 27834.9976 38690.4874  39.0%  1284  716s
  3728  2663 31584.9246   53  376 27834.9976 38690.4874  39.0%  1283  720s
  3729  2664 29971.7658   44  391 27834.9976 38690.4874  39.0%  1283  725s
  3732  2666 29792.0166    9  455 27834.9976 38690.4874  39.0%  1282  730s
  3733  2667 34179.7822   28  388 27834.9976 38690.4874  39.0%  1281  736s
  3736  2669 36996.6147   15  459 27834.9976 38690.4874  39.0%  1280  741s
  3737  2669 28639.8615   31  448 27834.9976 38690.4874  39.0%  1280  745s
  3739  2671 29039.4472   29  406 27834.9976 38690.4874  39.0%  1279  753s
  3740  2671 35658.0920   14  443 27834.9976 38690.4874  39.0%  1279  755s
  3742  2673 32058.2105   29  446 27834.9976 38690.4874  39.0%  1278  761s
  3744  2674 31773.5304   21  443 27834.9976 38690.4874  39.0%  1278  769s
  3745  2675 34233.8173   22  437 27834.9976 38690.4874  39.0%  1277  772s
  3746  2675 28221.1198   32  443 27834.9976 38690.4874  39.0%  1277  775s
  3748  2677 35885.3329   17  446 27834.9976 38690.4874  39.0%  1276  780s
  3749  2677 34157.3994   27  446 27834.9976 38690.4874  39.0%  1276  816s
  3750  2678 31765.5886   33  446 27834.9976 38690.4874  39.0%  1275  835s
  3751  2682 38690.4874   16  437 27834.9976 38690.4874  39.0%  1323  862s
  3753  2685 38690.4874   17  440 27834.9976 38690.4874  39.0%  1325  872s
  3757  2692 38690.4874   18  436 27834.9976 38690.4874  39.0%  1328  883s
  3765  2705 38690.4874   19  434 27834.9976 38690.4874  39.0%  1332  897s
  3781  2719 38690.4874   20  438 27834.9976 38690.4874  39.0%  1378  919s
  3800  2743 38690.4874   21  452 27834.9976 38690.4874  39.0%  1401  941s
  3831  2824 38690.4874   22  444 27834.9976 38690.4874  39.0%  1450  961s
  3925  2824 33962.6624   23  473 27834.9976 38690.4874  39.0%  1506  970s
  3957  2840 38690.4874   24  430 27834.9976 38690.4874  39.0%  1515  983s
  4009  2857 37348.8146   25  302 27834.9976 38690.4874  39.0%  1533  997s
  4080  2885 37263.6419   26  350 27834.9976 38690.4874  39.0%  1556 1012s
  4169  2920 36832.5983   27  259 27834.9976 38690.4874  39.0%  1572 1025s
  4268  2935 36052.8100   28  186 27834.9976 38690.4874  39.0%  1582 1038s
  4345  2953 30159.2370   37  142 27834.9976 38690.4874  39.0%  1590 1052s
  4436  2952 35527.6317   29  234 27834.9976 38690.4874  39.0%  1597 1065s
  4523  2955     cutoff   29      27834.9976 38690.4874  39.0%  1606 1077s
  4611  2963 33774.5234   31  195 27834.9976 38690.4874  39.0%  1612 1090s
  4691  2980 33669.7054   31  208 27834.9976 38690.4874  39.0%  1621 1102s
  4768  2975     cutoff   32      27834.9976 38690.4874  39.0%  1631 1115s
  4855  2978 33621.1950   35  180 27834.9976 38690.4874  39.0%  1638 1128s
  4946  2984     cutoff   38      27834.9976 38225.7915  37.3%  1644 1139s
  5039  2992 infeasible   42      27834.9976 38225.7915  37.3%  1648 1150s
  5138  3006 29177.9910   45   56 27834.9976 38161.7648  37.1%  1660 1165s
  5239  3009 31785.1919   46  171 27834.9976 38161.7648  37.1%  1671 1181s
  5357  3013     cutoff   49      27834.9976 38161.7648  37.1%  1678 1195s
  5454  3009 30641.1189   23  343 27834.9976 38161.7648  37.1%  1691 1207s
  5554  3026 29558.0389   25  231 27834.9976 38161.7648  37.1%  1708 1219s
  5668  3024     cutoff   28      27834.9976 37932.3143  36.3%  1718 1233s
  5793  3032 infeasible   28      27834.9976 37332.2248  34.1%  1728 1248s
  5925  3038 35029.5221   29  174 27834.9976 36933.4192  32.7%  1740 1262s
  6033  3076 33719.8710   31  263 27834.9976 36881.6660  32.5%  1743 1276s
  6179  3076 30782.6348   35  109 27834.9976 36685.6740  31.8%  1752 1292s
  6335  3107     cutoff   39      27834.9976 36685.6740  31.8%  1763 1309s
  6502  3115 29832.1765   25  100 27834.9976 36609.6519  31.5%  1770 1324s
  6688  3104 infeasible   27      27834.9976 36442.4948  30.9%  1771 1339s
  6883  3098     cutoff   34      27834.9976 36442.4948  30.9%  1775 1357s
  7041  3099 infeasible   41      27834.9976 36026.7887  29.4%  1789 1374s
  7239  3089     cutoff   42      27834.9976 36026.7887  29.4%  1787 1392s
  7477  3084 34056.7917   31  156 27834.9976 35819.9712  28.7%  1784 1413s
  7758  3009 34348.4465   23  160 27834.9976 35748.6811  28.4%  1783 1429s
  7809  3009 33831.3714   24  246 27834.9976 35748.6811  28.4%  1791 1446s
  7855  3022 33511.6408   25  204 27834.9976 35748.6811  28.4%  1795 1464s
  7941  3027 32733.5531   26  237 27834.9976 35748.6811  28.4%  1797 1486s
  8113  3008 32647.9805   27  171 27834.9976 35349.5278  27.0%  1802 1505s
  8339  2979 29186.1183   31  177 27834.9976 35216.6387  26.5%  1805 1527s
  8602  2961 33079.8849   25  267 27834.9976 35004.6382  25.8%  1801 1548s
  8852  2899 28844.7414   30  189 27834.9976 34948.2250  25.6%  1810 1568s
  9057  2849 30794.1103   26  159 27834.9976 34935.4522  25.5%  1813 1587s
  9279  2826     cutoff   25      27834.9976 34794.5529  25.0%  1813 1609s
  9625  2733 31982.2649   26  196 27834.9976 34569.7281  24.2%  1812 1631s
  9972  2666 infeasible   35      27834.9976 34415.8986  23.6%  1820 1658s
 10391  2572 infeasible   35      27834.9976 34209.7379  22.9%  1820 1683s
 10795  2470 29450.8787   33  201 27834.9976 34040.3809  22.3%  1826 1710s
 11154  2369     cutoff   33      27834.9976 33883.9985  21.7%  1834 1737s
 11577  2245 32216.0211   25  255 27834.9976 33732.6098  21.2%  1837 1768s
 12057  2193 28176.4975   40  176 27834.9976 33547.3601  20.5%  1836 1799s
 12528  2176 28673.5793   30  153 27834.9976 33427.8064  20.1%  1839 1832s
 13094  2184 30330.0915   32  198 27834.9976 33363.6790  19.9%  1835 1869s
 13610  2153     cutoff   32      27834.9976 33101.2352  18.9%  1836 1904s
 14114  2081 30681.5717   28  143 27834.9976 32831.1152  17.9%  1841 1939s
 14687  2026     cutoff   28      27834.9976 32585.5073  17.1%  1842 1973s
 15278  1925     cutoff   28      27834.9976 32380.7138  16.3%  1842 2009s
 15954  1763 29205.3247   37  116 27834.9976 32184.2042  15.6%  1836 2045s
 16671  1740 28439.9644   38  221 27834.9976 31982.6075  14.9%  1826 2079s
 16799  1574 30769.0214   29  187 27834.9976 31982.6075  14.9%  1826 2117s
 17427  1300 28554.8058   40   18 27834.9976 31753.2042  14.1%  1812 2157s
 18346   993 28668.1492   32   88 27834.9976 31293.5731  12.4%  1792 2199s
 19270   415     cutoff   31      27834.9976 30898.6481  11.0%  1773 2239s
 20619    72     cutoff   32      27834.9976 29712.1086  6.74%  1719 2261s

Cutting planes:
  Learned: 1
  MIR: 450
  Flow cover: 1514
  RLT: 19
  Relax-and-lift: 112

Explored 22898 nodes (35970390 simplex iterations) in 2264.59 seconds (4499.50 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 27835 27746.1 27614.5 ... 26534.4

Optimal solution found (tolerance 1.00e-06)
Best objective 2.783499760563e+04, best bound 2.783499760563e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2264.60s
  Master Objective (UB) = 27835.00, θ = 172449.70
  Upper Bound (UB) = 27835.00

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172449.70
  [DEBUG]   ✓ Scenario 0: θ = 172449.70 ≤ Q = 172449.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172449.70 ≤ Q = 172449.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172449.70 ≤ Q = 172449.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172449.70 ≤ Q = 172449.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172449.70 ≤ Q = 172449.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172449.70 ≤ Q = 172449.70 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x361c12ec
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc9e3ed14
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.377774e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6669944.7690
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.576305e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157630.55    0  124 6669944.77 -157630.55   102%     -    0s
H    0     0                    -122412.7391 -157630.55  28.8%     -    0s
H    0     0                    -122675.9917 -157630.55  28.5%     -    0s
H    0     0                    -126288.1448 -157630.55  24.8%     -    0s
H    0     0                    -128472.4909 -139389.01  8.50%     -    0s
     0     0 -139389.01    0  110 -128472.49 -139389.01  8.50%     -    0s
H    0     0                    -134148.5592 -139279.34  3.82%     -    0s
H    0     0                    -135628.4443 -139279.34  2.69%     -    0s
     0     0 -137752.01    0  112 -135628.44 -137752.01  1.57%     -    0s
H    0     0                    -135851.8419 -137655.46  1.33%     -    0s
     0     0 -136999.86    0   86 -135851.84 -136999.86  0.85%     -    0s
     0     0 -136857.37    0   95 -135851.84 -136857.37  0.74%     -    0s
     0     0 -136830.08    0   85 -135851.84 -136830.08  0.72%     -    0s
     0     0 -136802.63    0   91 -135851.84 -136802.63  0.70%     -    0s
     0     0 -136535.34    0   72 -135851.84 -136535.34  0.50%     -    0s
     0     0 -136490.54    0   79 -135851.84 -136490.54  0.47%     -    0s
     0     0 -136486.54    0   70 -135851.84 -136486.54  0.47%     -    0s
     0     0 -136327.90    0   48 -135851.84 -136327.90  0.35%     -    0s
     0     0 -136308.15    0   50 -135851.84 -136308.15  0.34%     -    0s
     0     0 -136283.05    0   66 -135851.84 -136283.05  0.32%     -    0s
     0     0 -136282.31    0   66 -135851.84 -136282.31  0.32%     -    0s
H    0     0                    -136105.0342 -136280.09  0.13%     -    0s
     0     0 -136280.09    0   76 -136105.03 -136280.09  0.13%     -    0s
     0     0 -136280.09    0   55 -136105.03 -136280.09  0.13%     -    0s
     0     0 -136275.91    0   49 -136105.03 -136275.91  0.13%     -    0s
     0     0 -136255.30    0   45 -136105.03 -136255.30  0.11%     -    0s
     0     0 -136255.05    0   46 -136105.03 -136255.05  0.11%     -    0s
     0     0 -136237.89    0   39 -136105.03 -136237.89  0.10%     -    0s
     0     0 -136234.78    0   39 -136105.03 -136234.78  0.10%     -    0s
     0     0 -136234.78    0   40 -136105.03 -136234.78  0.10%     -    0s
     0     0 -136234.78    0   40 -136105.03 -136234.78  0.10%     -    0s
H    0     0                    -136217.6213 -136234.78  0.01%     -    0s
     0     0 -136234.78    0   39 -136217.62 -136234.78  0.01%     -    0s
     0     0 -136234.78    0   36 -136217.62 -136234.78  0.01%     -    0s
     0     0 -136234.78    0   33 -136217.62 -136234.78  0.01%     -    0s
     0     0 -136234.78    0   33 -136217.62 -136234.78  0.01%     -    0s
     0     0 -136234.78    0   33 -136217.62 -136234.78  0.01%     -    0s
     0     0 -136234.78    0   29 -136217.62 -136234.78  0.01%     -    0s
     0     0 -136220.03    0    4 -136217.62 -136220.03  0.00%     -    0s
     0     0     cutoff    0      -136217.62 -136217.62  0.00%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 2
  MIR: 47
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (1408 simplex iterations) in 0.30 seconds (0.09 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -136218 -136173 -136105 ... -122413
No other solutions better than -136218

Optimal solution found (tolerance 1.00e-06)
Best objective -1.362176212897e+05, best bound -1.362176212897e+05, gap 0.0000%
  Subproblem solved in 0.33s
  Worst-case operational profit (Z_SP) = 162930.19
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136217.62
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -136217.62 = 162930.19
  [DEBUG]   Current θ from Master = 172449.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9519.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18315.49
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 2981.3157, Absolute Gap = 2981.3157, Relative Gap = 0.107107
  Not converged yet (gap = 2981.32 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0x9533f488
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49690 rows and 20190 columns
Presolve time: 1.84s
Presolved: 58723 rows, 25750 columns, 365489 nonzeros
Variable types: 23491 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -222583.0639

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58723 rows, 25750 columns, 365489 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   25030   -9.8632778e+04   0.000000e+00   3.387325e+07      5s
   39129    6.3164683e+03   0.000000e+00   2.558652e+07     10s
   48453    3.7138599e+04   0.000000e+00   1.851233e+07     15s
   56419    4.1814465e+04   0.000000e+00   2.978385e+06     20s
   65443    4.5541629e+04   0.000000e+00   4.823101e+06     25s
   72337    4.8825272e+04   0.000000e+00   3.349163e+05     30s
Concurrent spin time: 0.99s

Solved with dual simplex

Root relaxation: objective 5.270266e+04, 44957 iterations, 30.40 seconds (43.44 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52702.6579    0  159 -222583.06 52702.6579   124%     -   33s
H    0     0                    -215135.3696 52702.6579   124%     -   33s
H    0     0                    -105726.4946 52702.6579   150%     -   33s
H    0     0                    -100661.4484 52702.6579   152%     -   33s
H    0     0                    -100474.3831 52702.6579   152%     -   33s
H    0     0                    -100473.9880 52702.6579   152%     -   33s
H    0     0                    -44867.89506 52702.6579   217%     -   33s
H    0     0                    -44486.66955 52702.6579   218%     -   33s
H    0     0                    12256.142973 52702.6579   330%     -   33s
H    0     0                    17246.577127 52702.6579   206%     -   34s
H    0     0                    18100.262512 52702.6579   191%     -   34s
H    0     0                    18411.207721 52702.6579   186%     -   34s
H    0     0                    19014.039154 52702.6579   177%     -   34s
H    0     0                    20389.103408 52702.6579   158%     -   34s
     0     0 48583.1462    0  277 20389.1034 48583.1462   138%     -   44s
H    0     0                    20628.474782 48582.9784   136%     -   45s
H    0     0                    20976.561327 48582.9784   132%     -   45s
H    0     0                    21001.366035 48160.0404   129%     -   49s
H    0     0                    21025.904419 48160.0404   129%     -   49s
H    0     0                    21030.590327 48160.0404   129%     -   49s
     0     0 48160.0404    0  289 21030.5903 48160.0404   129%     -   49s
     0     0 48126.4507    0  285 21030.5903 48126.4507   129%     -   50s
     0     0 48108.4276    0  284 21030.5903 48108.4276   129%     -   51s
     0     0 48090.8998    0  289 21030.5903 48090.8998   129%     -   52s
     0     0 48087.6920    0  291 21030.5903 48087.6920   129%     -   52s
     0     0 48086.5823    0  293 21030.5903 48086.5823   129%     -   52s
     0     0 48086.5121    0  293 21030.5903 48086.5121   129%     -   52s
     0     0 45794.3134    0  283 21030.5903 45794.3134   118%     -   63s
     0     0 45188.6292    0  290 21030.5903 45188.6292   115%     -   68s
     0     0 45041.1899    0  279 21030.5903 45041.1899   114%     -   71s
     0     0 44963.6200    0  282 21030.5903 44963.6200   114%     -   73s
     0     0 44927.3253    0  285 21030.5903 44927.3253   114%     -   74s
     0     0 44918.6003    0  287 21030.5903 44918.6003   114%     -   75s
     0     0 44884.2622    0  290 21030.5903 44884.2622   113%     -   77s
     0     0 44870.9959    0  286 21030.5903 44870.9959   113%     -   78s
     0     0 44858.4151    0  290 21030.5903 44858.4151   113%     -   79s
     0     0 44857.9543    0  299 21030.5903 44857.9543   113%     -   79s
H    0     0                    23584.883363 43206.8402  83.2%     -   96s
H    0     0                    24820.620570 43206.8402  74.1%     -   96s
H    0     0                    25297.776965 43206.8402  70.8%     -   96s
H    0     0                    25317.183030 43206.8402  70.7%     -   96s
H    0     0                    25330.275904 43206.8402  70.6%     -   96s
H    0     0                    25411.551321 43206.8402  70.0%     -   96s
H    0     0                    25525.048332 43206.8402  69.3%     -   96s
H    0     0                    25673.920061 43206.8402  68.3%     -   96s
H    0     0                    25784.048735 43206.8402  67.6%     -   96s
     0     0 43206.8402    0  337 25784.0487 43206.8402  67.6%     -   96s
     0     0 42832.4837    0  347 25784.0487 42832.4837  66.1%     -  105s
     0     0 42657.5815    0  343 25784.0487 42657.5815  65.4%     -  109s
     0     0 42550.7024    0  338 25784.0487 42550.7024  65.0%     -  111s
     0     0 42521.5107    0  351 25784.0487 42521.5107  64.9%     -  114s
     0     0 42481.2691    0  353 25784.0487 42481.2691  64.8%     -  116s
     0     0 42458.9348    0  352 25784.0487 42458.9348  64.7%     -  117s
     0     0 42450.4785    0  355 25784.0487 42450.4785  64.6%     -  118s
     0     0 42419.0342    0  397 25784.0487 42419.0342  64.5%     -  119s
     0     0 42402.5083    0  358 25784.0487 42402.5083  64.5%     -  120s
     0     0 42399.5923    0  402 25784.0487 42399.5923  64.4%     -  121s
     0     0 42398.2030    0  406 25784.0487 42398.2030  64.4%     -  121s
     0     0 42397.7134    0  406 25784.0487 42397.7134  64.4%     -  121s
     0     0 41767.8442    0  376 25784.0487 41767.8442  62.0%     -  132s
     0     0 41563.8779    0  381 25784.0487 41563.8779  61.2%     -  137s
     0     0 41484.0266    0  381 25784.0487 41484.0266  60.9%     -  140s
     0     0 41438.6345    0  380 25784.0487 41438.6345  60.7%     -  142s
     0     0 41414.5117    0  389 25784.0487 41414.5117  60.6%     -  145s
     0     0 41398.5593    0  386 25784.0487 41398.5593  60.6%     -  146s
     0     0 41376.9219    0  383 25784.0487 41376.9219  60.5%     -  147s
     0     0 41369.3546    0  384 25784.0487 41369.3546  60.4%     -  148s
     0     0 41364.9388    0  386 25784.0487 41364.9388  60.4%     -  149s
     0     0 41362.4699    0  389 25784.0487 41362.4699  60.4%     -  149s
     0     0 41354.5060    0  388 25784.0487 41354.5060  60.4%     -  150s
     0     0 41353.7671    0  388 25784.0487 41353.7671  60.4%     -  150s
     0     0 41248.8189    0  382 25784.0487 41248.8189  60.0%     -  154s
     0     0 41230.1380    0  391 25784.0487 41230.1380  59.9%     -  156s
     0     0 41212.5986    0  383 25784.0487 41212.5986  59.8%     -  158s
     0     0 41201.6280    0  436 25784.0487 41201.6280  59.8%     -  160s
     0     0 41198.1122    0  437 25784.0487 41198.1122  59.8%     -  160s
     0     0 41184.4596    0  423 25784.0487 41184.4596  59.7%     -  162s
     0     0 41179.5850    0  385 25784.0487 41179.5850  59.7%     -  162s
     0     0 41176.3354    0  429 25784.0487 41176.3354  59.7%     -  163s
     0     0 41170.7084    0  432 25784.0487 41170.7084  59.7%     -  163s
     0     0 41166.4312    0  436 25784.0487 41166.4312  59.7%     -  165s
     0     0 41164.6701    0  441 25784.0487 41164.6701  59.7%     -  165s
     0     0 41163.9326    0  441 25784.0487 41163.9326  59.6%     -  165s
     0     0 41122.5847    0  426 25784.0487 41122.5847  59.5%     -  168s
H    0     0                    25903.246522 41122.0059  58.8%     -  170s
     0     0 41115.0048    0  431 25903.2465 41115.0048  58.7%     -  171s
     0     0 41111.3419    0  436 25903.2465 41111.3419  58.7%     -  172s
     0     0 41106.6352    0  391 25903.2465 41106.6352  58.7%     -  172s
     0     0 41104.8089    0  443 25903.2465 41104.8089  58.7%     -  173s
     0     0 41104.1966    0  438 25903.2465 41104.1966  58.7%     -  173s
     0     0 41087.2030    0  442 25903.2465 41087.2030  58.6%     -  175s
H    0     0                    25906.041314 41086.9474  58.6%     -  176s
     0     0 41080.3070    0  442 25906.0413 41080.3070  58.6%     -  176s
     0     0 41077.7014    0  447 25906.0413 41077.7014  58.6%     -  177s
     0     0 41076.3421    0  445 25906.0413 41076.3421  58.6%     -  177s
     0     0 41064.8285    0  402 25906.0413 41064.8285  58.5%     -  179s
H    0     0                    25940.891397 41064.7281  58.3%     -  182s
     0     0 41061.1481    0  392 25940.8914 41061.1481  58.3%     -  184s
     0     0 41059.9491    0  398 25940.8914 41059.9491  58.3%     -  184s
     0     0 41055.7996    0  402 25940.8914 41055.7996  58.3%     -  185s
     0     0 41045.8076    0  448 25940.8914 41045.8076  58.2%     -  186s
     0     0 41043.1278    0  403 25940.8914 41043.1278  58.2%     -  187s
     0     0 41042.1412    0  401 25940.8914 41042.1412  58.2%     -  187s
     0     0 41012.7630    0  441 25940.8914 41012.7630  58.1%     -  190s
     0     0 41010.0556    0  444 25940.8914 41010.0556  58.1%     -  191s
     0     0 41008.6863    0  448 25940.8914 41008.6863  58.1%     -  191s
     0     0 41008.1233    0  450 25940.8914 41008.1233  58.1%     -  191s
     0     0 41006.0868    0  444 25940.8914 41006.0868  58.1%     -  192s
     0     0 41004.4251    0  404 25940.8914 41004.4251  58.1%     -  193s
     0     0 41004.0427    0  403 25940.8914 41004.0427  58.1%     -  194s
     0     0 40979.9471    0  385 25940.8914 40979.9471  58.0%     -  195s
     0     0 40970.3876    0  393 25940.8914 40970.3876  57.9%     -  197s
     0     0 40967.8771    0  400 25940.8914 40967.8771  57.9%     -  197s
     0     0 40966.1447    0  399 25940.8914 40966.1447  57.9%     -  198s
     0     0 40965.5431    0  401 25940.8914 40965.5431  57.9%     -  198s
     0     0 40959.4654    0  390 25940.8914 40959.4654  57.9%     -  199s
     0     0 40951.1994    0  387 25940.8914 40951.1994  57.9%     -  201s
     0     0 40949.7651    0  391 25940.8914 40949.7651  57.9%     -  201s
     0     0 40949.4286    0  390 25940.8914 40949.4286  57.9%     -  201s
     0     0 40947.8162    0  393 25940.8914 40947.8162  57.9%     -  202s
     0     0 40947.1627    0  395 25940.8914 40947.1627  57.8%     -  203s
     0     0 40944.2464    0  394 25940.8914 40944.2464  57.8%     -  204s
     0     0 40943.5685    0  392 25940.8914 40943.5685  57.8%     -  204s
     0     0 40943.5685    0  392 25940.8914 40943.5685  57.8%     -  206s
     0     0 40943.0536    0  392 25940.8914 40943.0536  57.8%     -  207s
     0     2 40943.0536    0  392 25940.8914 40943.0536  57.8%     -  258s
     1     4 40814.7707    1  378 25940.8914 40943.0536  57.8%  2580  261s
     3     8 40575.6267    2  365 25940.8914 40814.6504  57.3%  4032  268s
     7    16 40246.7611    3  320 25940.8914 40575.4051  56.4%  5110  277s
    15    32 39995.7489    4  394 25940.8914 40246.4423  55.1%  5945  287s
    31    46 37805.6813    5  371 25940.8914 39995.7010  54.2%  8778  309s
    47    78 38488.9623    6  369 25940.8914 39995.7010  54.2%  8354  322s
    79   136 38430.2200    7  360 25940.8914 39887.4781  53.8%  6757  348s
   137   265 38280.4513    8  383 25940.8914 39887.4781  53.8%  5041  364s
   270   293 38257.8009    9  395 25940.8914 39887.4781  53.8%  3692  374s
   306   343 38152.0967   10  329 25940.8914 39887.4781  53.8%  3456  384s
   360   415 37958.1367    9  377 25940.8914 39887.4781  53.8%  3234  395s
   446   475 34926.8750   10  216 25940.8914 39887.4781  53.8%  2897  405s
   527   533 37684.5532   10  340 25940.8914 39887.4781  53.8%  2730  417s
   615   604 37512.5872   11  330 25940.8914 39887.4781  53.8%  2624  428s
   702   684 32326.3659   11  323 25940.8914 39683.2349  53.0%  2479  438s
   790   722 37338.7968   12  320 25940.8914 39683.2349  53.0%  2382  449s
H  836   722                    26056.679512 39683.2349  52.3%  2308  449s
   854   795 37325.1494   12  330 26056.6795 39683.2349  52.3%  2285  459s
   954   857 37114.2474   15  357 26056.6795 39578.7988  51.9%  2181  470s
H  955   857                    26093.046232 39578.7988  51.7%  2178  470s
H  958   857                    26309.349490 39578.7988  50.4%  2176  470s
  1028   914 36832.0232   13  316 26309.3495 39507.0307  50.2%  2120  482s
H 1029   914                    26775.822982 39507.0307  47.5%  2118  482s
H 1102   971                    26802.870150 39507.0307  47.4%  2072  494s
H 1153   971                    26835.217941 39081.8836  45.6%  2032  494s
  1177  1068 36908.8924   19  345 26835.2179 39081.8836  45.6%  2018  505s
  1298  1171 36807.5885   21  253 26835.2179 39081.8836  45.6%  1947  514s
H 1330  1171                    27048.374040 39081.8836  44.5%  1923  514s
  1423  1280 36475.7105   26  323 27048.3740 39073.2975  44.5%  1887  525s
H 1554  1373                    27085.375463 39073.2975  44.3%  1835  537s
H 1589  1373                    27173.331158 39073.2975  43.8%  1823  537s
H 1607  1373                    27200.267032 39073.2975  43.7%  1810  537s
  1675  1447 36099.1834   30  235 27200.2670 39073.2975  43.7%  1791  551s
  1791  1529 35957.2543   33  194 27200.2670 39073.2975  43.7%  1768  565s
H 1830  1529                    27318.391962 39073.2975  43.0%  1758  565s
  1916  1677 35510.9698   37  191 27318.3920 39073.2975  43.0%  1735  577s
  2082  1828 35725.4310   38  204 27318.3920 39073.2975  43.0%  1691  590s
H 2105  1828                    27410.423814 39073.2975  42.5%  1677  590s
  2291  1899 35281.4963   43  116 27410.4238 39073.2975  42.5%  1616  604s
  2490  1994 34816.8874   45  153 27410.4238 39073.2975  42.5%  1572  618s
H 2613  1993                    27469.338708 39034.6622  42.1%  1570  618s
  2631  2112 34521.9378   49  110 27469.3387 39012.4482  42.0%  1571  631s
  2826  2242 34259.3316   52  112 27469.3387 39001.9322  42.0%  1553  646s
  2986  2349 33989.3096   54  113 27469.3387 38991.0367  41.9%  1547  659s
  3135  2443 33140.3168   56  229 27469.3387 38991.0367  41.9%  1551  674s
  3283  2529 33022.4863   58  236 27469.3387 38844.9328  41.4%  1550  690s
H 3340  2521                    27574.038611 38844.9328  40.9%  1542  690s
  3414  2679 32531.8530   59  180 27574.0386 38761.1074  40.6%  1549  704s
  3623  2680 37249.4033   27  392 27574.0386 38761.1074  40.6%  1539  746s
  3625  2681 30455.1633   17  159 27574.0386 38761.1074  40.6%  1538  782s
  3626  2682 32611.1097   14  293 27574.0386 38761.1074  40.6%  1538  801s
  3627  2683 31191.8420   15  340 27574.0386 38761.1074  40.6%  1537  815s
  3628  2683 35380.2867   34  306 27574.0386 38761.1074  40.6%  1537  827s
  3629  2684 31286.7430   76  379 27574.0386 38761.1074  40.6%  1537  833s
  3630  2685 32325.5657   12  420 27574.0386 38761.1074  40.6%  1536  838s
  3631  2685 31832.5518   56  377 27574.0386 38761.1074  40.6%  1536  844s
  3632  2686 35168.4217   18  381 27574.0386 38761.1074  40.6%  1535  849s
  3633  2687 36626.6926    9  395 27574.0386 38761.1074  40.6%  1535  851s
  3635  2688 34938.6336   23  431 27574.0386 38761.1074  40.6%  1534  856s
  3637  2689 30099.5834   15  385 27574.0386 38761.1074  40.6%  1533  862s
  3639  2691 29923.5670   39  434 27574.0386 38761.1074  40.6%  1532  866s
  3640  2691 35058.7062   43  393 27574.0386 38761.1074  40.6%  1532  872s
  3642  2693 37364.0130    8  394 27574.0386 38761.1074  40.6%  1531  876s
  3644  2694 30052.3118   69  410 27574.0386 38761.1074  40.6%  1530  884s
  3645  2695 32924.8672   65  401 27574.0386 38761.1074  40.6%  1530  886s
  3647  2696 35348.8355   29  380 27574.0386 38761.1074  40.6%  1529  893s
  3648  2697 35898.3546   20  429 27574.0386 38761.1074  40.6%  1529  895s
  3651  2699 34785.3883   13  400 27574.0386 38761.1074  40.6%  1527  903s
  3652  2699 34487.4980   29  390 27574.0386 38761.1074  40.6%  1527  905s
  3653  2700 33345.1849   15  481 27574.0386 38761.1074  40.6%  1527  913s
  3654  2701 33528.9525   36  490 27574.0386 38761.1074  40.6%  1526  916s
  3655  2701 30578.2137   14  482 27574.0386 38761.1074  40.6%  1526  922s
  3657  2703 28466.8159   36  441 27574.0386 38761.1074  40.6%  1525  926s
H 3659  2568                    27629.789323 38761.1074  40.3%  1524  935s
H 3659  2439                    27811.950543 38761.1074  39.4%  1524  935s
  3662  2441 35233.6436   25  442 27811.9505 38761.1074  39.4%  1523  945s
  3665  2443 35401.6950   27  440 27811.9505 38761.1074  39.4%  1522  955s
  3667  2444 36479.3121   28  446 27811.9505 38761.1074  39.4%  1521  960s
  3669  2446 37036.5067    9  491 27811.9505 38761.1074  39.4%  1520  970s
  3671  2447 31332.9355   65  450 27811.9505 38761.1074  39.4%  1519  975s
  3672  2448 36778.0026   11  498 27811.9505 38761.1074  39.4%  1519  982s
  3673  2448 28974.6146   46  449 27811.9505 38761.1074  39.4%  1518  985s
  3675  2450 33367.9863   14  468 27811.9505 38761.1074  39.4%  1517 1022s
  3676  2450 36860.3782   15  468 27811.9505 38761.1074  39.4%  1517 1044s
  3677  2454 38761.1074   12  440 27811.9505 38761.1074  39.4%  1575 1064s
  3679  2457 38761.1074   13  448 27811.9505 38761.1074  39.4%  1577 1080s
  3683  2464 38761.1074   14  450 27811.9505 38761.1074  39.4%  1581 1112s
  3691  2477 38761.1074   15  451 27811.9505 38761.1074  39.4%  1593 1138s
  3707  2488 37399.5090   16  314 27811.9505 38761.1074  39.4%  1629 1165s
  3723  2500 35224.4136   17  284 27811.9505 38761.1074  39.4%  1686 1198s
  3754  2542 34858.5756   18  252 27811.9505 38761.1074  39.4%  1716 1226s
  3809  2571 33793.1558   19  309 27811.9505 38761.1074  39.4%  1815 1249s
  3867  2661 33743.9562   20  302 27811.9505 38761.1074  39.4%  1841 1269s
  3998  2696 32353.5675   24  154 27811.9505 38761.1074  39.4%  1852 1284s
  4106  2725 32177.2570   26  288 27811.9505 38761.1074  39.4%  1851 1303s
  4204  2752 31841.2214   27  282 27811.9505 38761.1074  39.4%  1852 1318s
  4299  2762 31454.8264   31  264 27811.9505 38761.1074  39.4%  1853 1330s
  4386  2750     cutoff   33      27811.9505 38761.1074  39.4%  1851 1343s
  4422  2760 30937.7126   35  109 27811.9505 38761.1074  39.4%  1853 1355s
  4460  2770 30691.0608   36  132 27811.9505 38761.1074  39.4%  1857 1368s
  4508  2782     cutoff   36      27811.9505 38761.1074  39.4%  1857 1378s
  4559  2789 35703.7287   17  427 27811.9505 38761.1074  39.4%  1863 1391s
  4615  2791 35643.4554   18  415 27811.9505 38761.1074  39.4%  1868 1406s
  4670  2792 35597.1819   19  420 27811.9505 38761.1074  39.4%  1875 1418s
  4715  2799 34629.2540   20  346 27811.9505 38761.1074  39.4%  1878 1431s
  4752  2809 34553.0132   21  264 27811.9505 38761.1074  39.4%  1882 1441s
  4798  2805 34502.2331   22  237 27811.9505 38761.1074  39.4%  1882 1457s
  4869  2805 34069.0894   24  291 27811.9505 38761.1074  39.4%  1883 1472s
  4943  2817 33858.3628   27  185 27811.9505 38761.1074  39.4%  1885 1490s
  5019  2839     cutoff   28      27811.9505 38761.1074  39.4%  1894 1504s
  5098  2863 31990.5473   32  187 27811.9505 38478.8610  38.4%  1903 1520s
  5182  2885 28442.2671   35   64 27811.9505 38478.8610  38.4%  1916 1535s
  5269  2901     cutoff   39      27811.9505 38478.8610  38.4%  1929 1556s
  5362  2914 36466.8469   21  329 27811.9505 37939.0840  36.4%  1947 1579s
  5467  2948 35939.9937   23  232 27811.9505 37939.0840  36.4%  1961 1597s
  5592  2981 34224.4306   25  284 27811.9505 37939.0840  36.4%  1970 1617s
  5722  2987 33232.5489   27  232 27811.9505 37939.0840  36.4%  1980 1637s
H 5836  2825                    27826.358147 37909.7303  36.2%  1985 1637s
  5874  2866     cutoff   32      27826.3581 37909.7303  36.2%  1990 1667s
  6004  2878     cutoff   33      27826.3581 37606.0718  35.1%  2011 1687s
  6142  2893 35972.9070   26  253 27826.3581 37221.2215  33.8%  2031 1709s
  6305  2903 34166.7200   29  313 27826.3581 37221.2215  33.8%  2043 1731s
  6470  2916 29912.7494   34  161 27826.3581 37221.2215  33.8%  2058 1756s
  6643  2915 30372.1749   24  337 27826.3581 37073.3709  33.2%  2081 1784s
  6843  2908 28899.1824   29  236 27826.3581 37073.3709  33.2%  2090 1811s
  7004  2928 30018.5806   22  380 27826.3581 37015.0981  33.0%  2109 1836s
  7220  2906 29368.7317   25  315 27826.3581 36868.5479  32.5%  2115 1863s
  7443  2910 31592.7317   24  202 27826.3581 36868.5479  32.5%  2125 1890s
  7657  2874 infeasible   26      27826.3581 36731.9776  32.0%  2142 1919s
  7911  2861 31394.9234   24  266 27826.3581 36731.9776  32.0%  2150 1948s
  8127  2831 29195.6629   27  255 27826.3581 36243.4074  30.2%  2170 1978s
  8398  2802 34750.0076   23  218 27826.3581 36006.7466  29.4%  2178 2012s
  8684  2772 30836.1501   28  273 27826.3581 35901.9317  29.0%  2187 2045s
  8995  2691 28394.3858   24  174 27826.3581 35692.9635  28.3%  2195 2076s
  9251  2636     cutoff   25      27826.3581 35537.4501  27.7%  2204 2110s
  9552  2590 28624.9110   28  278 27826.3581 35443.0949  27.4%  2218 2144s
  9913  2481 28436.4677   23  273 27826.3581 35231.7726  26.6%  2227 2181s
 10326  2376 28142.1016   32  195 27826.3581 35054.7763  26.0%  2229 2218s
 10670  2240 28444.6012   30  176 27826.3581 34936.2370  25.6%  2243 2254s
 11050  2223 32465.3792   28  246 27826.3581 34786.4463  25.0%  2256 2291s
 11460  2220     cutoff   27      27826.3581 34611.1384  24.4%  2271 2332s
 11927  2215 28008.5642   31  283 27826.3581 34250.1164  23.1%  2272 2377s
 12379  2174     cutoff   28      27826.3581 34025.7587  22.3%  2280 2417s
 12893  2135 31527.7896   21  333 27826.3581 33886.0115  21.8%  2283 2458s
 13462  2114     cutoff   31      27826.3581 33762.9112  21.3%  2274 2503s
 13974  2080     cutoff   32      27826.3581 33619.6674  20.8%  2281 2547s
 14583  2004 28171.0205   32   80 27826.3581 33293.8504  19.6%  2275 2590s
 15017  1924 30812.0194   34  114 27826.3581 32881.0027  18.2%  2280 2632s
 15300  1777     cutoff   34      27826.3581 32847.7448  18.0%  2279 2678s
 15952  1593 28429.2038   29  237 27826.3581 32791.4560  17.8%  2260 2729s
 16711  1347 30749.5854   21  359 27826.3581 32257.7293  15.9%  2240 2782s
 17557  1016 28473.1151   26  200 27826.3581 31734.9344  14.0%  2224 2839s
 18526   432     cutoff   29      27826.3581 31067.4041  11.6%  2197 2893s
 20059   112     cutoff   21      27826.3581 30182.5478  8.47%  2105 2937s
 20973     0     cutoff   39      27826.3581 29030.6877  4.33%  2030 2943s

Cutting planes:
  Learned: 1
  MIR: 605
  Mixing: 1
  Flow cover: 2484
  RLT: 19
  Relax-and-lift: 201

Explored 21671 nodes (42845104 simplex iterations) in 2943.27 seconds (5715.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 27826.4 27812 27629.8 ... 27085.4

Optimal solution found (tolerance 1.00e-06)
Best objective 2.782635814737e+04, best bound 2.782635814737e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2943.30s
  Master Objective (UB) = 27826.36, θ = 171816.08
  Upper Bound (UB) = 27826.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171816.08
  [DEBUG]   ✓ Scenario 0: θ = 171816.08 ≤ Q = 171816.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171816.08 ≤ Q = 171816.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171816.08 ≤ Q = 171816.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171816.08 ≤ Q = 171816.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 171816.08 ≤ Q = 171816.08 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 171816.08 ≤ Q = 171816.08 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 171816.08 ≤ Q = 171816.08 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x180210e8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe7fdef18
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.379244e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6615026.3313
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.580658e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158065.81    0  124 6615026.33 -158065.81   102%     -    0s
H    0     0                    -122921.0291 -158065.81  28.6%     -    0s
H    0     0                    -123184.2817 -158065.81  28.3%     -    0s
H    0     0                    -126698.2930 -158065.81  24.8%     -    0s
H    0     0                    -128502.4190 -139216.27  8.34%     -    0s
H    0     0                    -128870.6723 -139216.27  8.03%     -    0s
H    0     0                    -133284.8367 -139216.27  4.45%     -    0s
     0     0 -139216.27    0  133 -133284.84 -139216.27  4.45%     -    0s
H    0     0                    -134937.1842 -139080.98  3.07%     -    0s
     0     0 -137397.74    0  131 -134937.18 -137397.74  1.82%     -    0s
H    0     0                    -135459.2154 -137320.55  1.37%     -    0s
     0     0 -137320.55    0  131 -135459.22 -137320.55  1.37%     -    0s
     0     0 -136740.99    0  110 -135459.22 -136740.99  0.95%     -    0s
     0     0 -136674.25    0  111 -135459.22 -136674.25  0.90%     -    0s
     0     0 -136667.13    0  111 -135459.22 -136667.13  0.89%     -    0s
     0     0 -136223.35    0   77 -135459.22 -136223.35  0.56%     -    0s
     0     0 -136173.16    0   88 -135459.22 -136173.16  0.53%     -    0s
     0     0 -136172.97    0   88 -135459.22 -136172.97  0.53%     -    0s
     0     0 -135995.58    0   66 -135459.22 -135995.58  0.40%     -    0s
     0     0 -135960.86    0   66 -135459.22 -135960.86  0.37%     -    0s
     0     0 -135835.77    0   77 -135459.22 -135835.77  0.28%     -    0s
     0     0 -135821.10    0   77 -135459.22 -135821.10  0.27%     -    0s
H    0     0                    -135480.7131 -135808.84  0.24%     -    0s
     0     2 -135808.84    0   77 -135480.71 -135808.84  0.24%     -    0s
*  108    32              13    -135509.4963 -135554.31  0.03%   5.1    0s
*  123    32              14    -135509.8478 -135550.58  0.03%   5.0    0s
*  142     3              14    -135517.3101 -135550.58  0.02%   4.8    0s

Cutting planes:
  Gomory: 46
  Implied bound: 5
  MIR: 155
  Flow cover: 12
  RLT: 47
  Relax-and-lift: 7
  BQP: 6

Explored 176 nodes (1576 simplex iterations) in 0.26 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -135517 -135510 -135509 ... -122921
No other solutions better than -135517

Optimal solution found (tolerance 1.00e-06)
Best objective -1.355173100988e+05, best bound -1.355173100988e+05, gap 0.0000%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 163630.50
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135517.31
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -135517.31 = 163630.50
  [DEBUG]   Current θ from Master = 171816.08
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8185.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19640.78
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 2972.6762, Absolute Gap = 2972.6762, Relative Gap = 0.106830
  Not converged yet (gap = 2972.68 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x76438677
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56760 rows and 23060 columns
Presolve time: 1.92s
Presolved: 66943 rows, 29120 columns, 416999 nonzeros
Variable types: 26861 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66943 rows, 29120 columns, 416999 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23860   -1.5588836e+05   0.000000e+00   5.271056e+07      5s
   36072   -1.3400937e+04   0.000000e+00   5.868065e+06     10s
   43631    1.3489355e+04   0.000000e+00   2.258827e+07     15s
   49935    2.1115895e+04   0.000000e+00   2.649347e+07     20s
   55696    3.2450292e+04   0.000000e+00   7.928072e+06     25s
   62413    3.7333186e+04   0.000000e+00   1.482942e+07     30s
   68276    3.8508091e+04   0.000000e+00   6.273072e+07     35s
   74323    3.9850915e+04   0.000000e+00   1.108615e+06     40s
   79629    4.1199444e+04   0.000000e+00   7.064313e+05     45s
Concurrent spin time: 0.60s

Solved with dual simplex

Root relaxation: objective 5.119419e+04, 54548 iterations, 43.66 seconds (58.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51194.1883    0   68 -239613.87 51194.1883   121%     -   46s
H    0     0                    -226156.4263 51194.1883   123%     -   46s
H    0     0                    -138076.3350 51194.1883   137%     -   46s
H    0     0                    -138005.4494 51194.1883   137%     -   46s
H    0     0                    -39267.17551 51194.1883   230%     -   46s
H    0     0                    -39103.08115 51194.1883   231%     -   46s
H    0     0                    15644.184173 51194.1883   227%     -   46s
H    0     0                    24791.558471 51194.1883   106%     -   47s
H    0     0                    25184.901562 51194.1883   103%     -   47s
H    0     0                    25397.168176 51194.1883   102%     -   47s
H    0     0                    25435.742582 51194.1883   101%     -   48s
     0     0 46806.7457    0  234 25435.7426 46806.7457  84.0%     -   56s
     0     0 46607.7962    0  226 25435.7426 46607.7962  83.2%     -   58s
     0     0 46599.5008    0  228 25435.7426 46599.5008  83.2%     -   58s
     0     0 46599.5008    0  228 25435.7426 46599.5008  83.2%     -   59s
H    0     0                    25546.039905 44213.6149  73.1%     -   71s
     0     0 44042.2214    0  229 25546.0399 44042.2214  72.4%     -   71s
     0     0 43463.1885    0  237 25546.0399 43463.1885  70.1%     -   80s
     0     0 43356.3482    0  243 25546.0399 43356.3482  69.7%     -   83s
     0     0 43284.3599    0  240 25546.0399 43284.3599  69.4%     -   85s
     0     0 43266.2684    0  245 25546.0399 43266.2684  69.4%     -   86s
     0     0 43214.8017    0  244 25546.0399 43214.8017  69.2%     -   87s
     0     0 43171.4193    0  243 25546.0399 43171.4193  69.0%     -   89s
     0     0 43164.9170    0  279 25546.0399 43164.9170  69.0%     -   90s
     0     0 43164.3272    0  281 25546.0399 43164.3272  69.0%     -   90s
H    0     0                    25637.191182 41722.5124  62.7%     -  107s
     0     0 41722.5124    0  301 25637.1912 41722.5124  62.7%     -  107s
     0     0 41140.2745    0  311 25637.1912 41140.2745  60.5%     -  118s
     0     0 40943.0437    0  317 25637.1912 40943.0437  59.7%     -  122s
     0     0 40804.1681    0  319 25637.1912 40804.1681  59.2%     -  124s
     0     0 40747.0436    0  330 25637.1912 40747.0436  58.9%     -  127s
     0     0 40737.5506    0  329 25637.1912 40737.5506  58.9%     -  129s
     0     0 40731.4120    0  326 25637.1912 40731.4120  58.9%     -  130s
     0     0 40726.8766    0  338 25637.1912 40726.8766  58.9%     -  130s
     0     0 40714.8642    0  341 25637.1912 40714.8642  58.8%     -  132s
     0     0 40714.2084    0  336 25637.1912 40714.2084  58.8%     -  132s
     0     0 40033.3604    0  356 25637.1912 40033.3604  56.2%     -  147s
     0     0 39650.6428    0  347 25637.1912 39650.6428  54.7%     -  153s
     0     0 39545.2629    0  366 25637.1912 39545.2629  54.2%     -  157s
     0     0 39519.1649    0  357 25637.1912 39519.1649  54.1%     -  160s
     0     0 39499.9025    0  364 25637.1912 39499.9025  54.1%     -  161s
     0     0 39481.6756    0  357 25637.1912 39481.6756  54.0%     -  162s
     0     0 39475.6130    0  359 25637.1912 39475.6130  54.0%     -  164s
     0     0 39464.5245    0  355 25637.1912 39464.5245  53.9%     -  166s
     0     0 39443.0844    0  356 25637.1912 39443.0844  53.9%     -  168s
     0     0 39427.2987    0  397 25637.1912 39427.2987  53.8%     -  169s
     0     0 39423.0310    0  364 25637.1912 39423.0310  53.8%     -  169s
     0     0 39415.7505    0  365 25637.1912 39415.7505  53.7%     -  170s
     0     0 39410.9648    0  410 25637.1912 39410.9648  53.7%     -  171s
     0     0 39408.5134    0  367 25637.1912 39408.5134  53.7%     -  171s
     0     0 39408.4764    0  369 25637.1912 39408.4764  53.7%     -  172s
     0     0 39280.9136    0  392 25637.1912 39280.9136  53.2%     -  176s
     0     0 39263.3165    0  358 25637.1912 39263.3165  53.1%     -  179s
     0     0 39237.6867    0  406 25637.1912 39237.6867  53.0%     -  182s
     0     0 39221.2915    0  366 25637.1912 39221.2915  53.0%     -  184s
     0     0 39183.4048    0  369 25637.1912 39183.4048  52.8%     -  186s
     0     0 39100.1594    0  416 25637.1912 39100.1594  52.5%     -  189s
     0     0 39090.8840    0  366 25637.1912 39090.8840  52.5%     -  190s
     0     0 39074.6851    0  429 25637.1912 39074.6851  52.4%     -  191s
     0     0 39061.1291    0  415 25637.1912 39061.1291  52.4%     -  192s
     0     0 39056.8880    0  360 25637.1912 39056.8880  52.3%     -  193s
     0     0 39053.8621    0  411 25637.1912 39053.8621  52.3%     -  193s
     0     0 39049.8059    0  417 25637.1912 39049.8059  52.3%     -  194s
     0     0 39049.2025    0  416 25637.1912 39049.2025  52.3%     -  194s
     0     0 38957.6985    0  377 25637.1912 38957.6985  52.0%     -  198s
H    0     0                    25655.263242 38952.3516  51.8%     -  202s
H    0     0                    25658.058034 38952.3516  51.8%     -  203s
H    0     0                    25906.041314 38952.3516  50.4%     -  203s
     0     0 38929.2199    0  384 25906.0413 38929.2199  50.3%     -  205s
     0     0 38916.0115    0  388 25906.0413 38916.0115  50.2%     -  206s
     0     0 38904.9580    0  383 25906.0413 38904.9580  50.2%     -  208s
     0     0 38898.5143    0  427 25906.0413 38898.5143  50.2%     -  208s
     0     0 38893.3699    0  422 25906.0413 38893.3699  50.1%     -  209s
     0     0 38890.5550    0  424 25906.0413 38890.5550  50.1%     -  210s
     0     0 38887.6780    0  425 25906.0413 38887.6780  50.1%     -  210s
     0     0 38885.2062    0  422 25906.0413 38885.2062  50.1%     -  211s
     0     0 38883.7706    0  425 25906.0413 38883.7706  50.1%     -  211s
     0     0 38883.3018    0  425 25906.0413 38883.3018  50.1%     -  212s
     0     0 38850.5776    0  428 25906.0413 38850.5776  50.0%     -  213s
     0     0 38841.2973    0  437 25906.0413 38841.2973  49.9%     -  215s
     0     0 38823.0345    0  433 25906.0413 38823.0345  49.9%     -  216s
     0     0 38814.3987    0  433 25906.0413 38814.3987  49.8%     -  217s
     0     0 38812.8358    0  432 25906.0413 38812.8358  49.8%     -  218s
     0     0 38811.3528    0  434 25906.0413 38811.3528  49.8%     -  218s
     0     0 38810.5483    0  429 25906.0413 38810.5483  49.8%     -  219s
     0     0 38770.2544    0  439 25906.0413 38770.2544  49.7%     -  222s
     0     0 38764.8933    0  432 25906.0413 38764.8933  49.6%     -  231s
     0     0 38762.9935    0  389 25906.0413 38762.9935  49.6%     -  232s
     0     0 38762.2000    0  389 25906.0413 38762.2000  49.6%     -  232s
     0     0 38752.7264    0  391 25906.0413 38752.7264  49.6%     -  234s
     0     0 38751.7591    0  395 25906.0413 38751.7591  49.6%     -  236s
     0     0 38737.4663    0  398 25906.0413 38737.4663  49.5%     -  238s
     0     0 38735.0154    0  444 25906.0413 38735.0154  49.5%     -  239s
     0     0 38734.7459    0  434 25906.0413 38734.7459  49.5%     -  239s
     0     0 38733.4140    0  405 25906.0413 38733.4140  49.5%     -  241s
     0     0 38731.9755    0  449 25906.0413 38731.9755  49.5%     -  242s
     0     0 38727.7491    0  440 25906.0413 38727.7491  49.5%     -  244s
     0     0 38725.5451    0  454 25906.0413 38725.5451  49.5%     -  245s
     0     0 38724.5903    0  436 25906.0413 38724.5903  49.5%     -  246s
     0     0 38721.7085    0  446 25906.0413 38721.7085  49.5%     -  248s
     0     0 38721.6067    0  446 25906.0413 38721.6067  49.5%     -  249s
     0     2 38720.6288    0  446 25906.0413 38720.6288  49.5%     -  298s
     1     4 38618.6203    1  396 25906.0413 38720.4344  49.5%  1277  303s
     3     8 38593.6707    2  381 25906.0413 38618.4828  49.1%  3482  309s
     7    16 38443.6096    3  388 25906.0413 38593.4281  49.0%  5281  318s
    15    32 38358.0843    4  403 25906.0413 38442.1867  48.4%  6291  328s
    31    48 37813.0702    5  412 25906.0413 38356.3673  48.1%  7735  351s
    47    80 37208.0408    6  322 25906.0413 38356.3673  48.1%  9672  365s
    79   161 37175.0225    7  311 25906.0413 38356.3673  48.1%  7724  378s
   160   193 37050.1190   10  361 25906.0413 38356.3673  48.1%  5415  384s
   192   226 36912.5466   10  361 25906.0413 38356.3673  48.1%  4809  397s
H  206   226                    25940.891397 38356.3673  47.9%  4689  397s
   233   324 37073.4427    9  349 25940.8914 38356.3673  47.9%  4387  412s
   341   407 36969.4618   12  358 25940.8914 38356.3673  47.9%  3662  425s
   440   439 36746.9004   13  361 25940.8914 38356.3673  47.9%  3339  437s
   512   474 36574.9097   13  350 25940.8914 38356.3673  47.9%  3359  449s
   567   501 31466.5668   14  368 25940.8914 38356.3673  47.9%  3552  460s
   604   552 36707.5380   13  350 25940.8914 38356.3673  47.9%  3660  471s
   677   613 36302.2386   14  343 25940.8914 38356.3673  47.9%  3677  483s
   746   676 36431.2535   14  293 25940.8914 38356.3673  47.9%  3641  493s
   815   735 36259.4935   15  338 25940.8914 38356.3673  47.9%  3700  503s
   898   812 36213.0485   16  278 25940.8914 38356.3673  47.9%  3612  514s
   993   852 33115.4272   17  313 25940.8914 38356.3673  47.9%  3556  526s
  1047   907 36208.8629   16  345 25940.8914 38356.3673  47.9%  3556  537s
  1132   949 35291.9260   17  196 25940.8914 38356.3673  47.9%  3495  550s
  1234   973 35028.0991   18  200 25940.8914 38356.3673  47.9%  3404  563s
  1283  1007 33317.2057   17  311 25940.8914 38356.3673  47.9%  3399  576s
  1361  1047 34124.9443   19  288 25940.8914 38356.3673  47.9%  3360  586s
  1441  1067 34416.7741   19  256 25940.8914 38356.3673  47.9%  3362  595s
  1482  1099 34232.0499   19  247 25940.8914 38356.3673  47.9%  3373  609s
  1530  1140 33469.0665   20  211 25940.8914 38356.3673  47.9%  3385  623s
  1613  1187 33281.3625   20  285 25940.8914 38356.3673  47.9%  3353  637s
  1694  1229 34092.1547   20  234 25940.8914 38356.3673  47.9%  3326  650s
  1770  1310 33319.2575   21  192 25940.8914 38356.3673  47.9%  3336  660s
  1869  1409 32975.4221   23  197 25940.8914 38356.3673  47.9%  3310  673s
  2002  1478 32510.8062   25  195 25940.8914 38356.3673  47.9%  3263  689s
  2107  1548 29894.4915   27   93 25940.8914 38356.3673  47.9%  3229  702s
  2229  1641 31653.4169   31  213 25940.8914 38356.3673  47.9%  3211  717s
  2358  1757 28029.8143   36   48 25940.8914 37886.6715  46.0%  3208  730s
  2540  1847 31031.8306   39  120 25940.8914 37849.1479  45.9%  3137  747s
  2700  1966 30094.2125   46   93 25940.8914 37551.0456  44.8%  3105  764s
  2852  2063 27092.9525   47   58 25940.8914 37551.0456  44.8%  3113  778s
  3017  2167 29890.4857   48   78 25940.8914 37274.0420  43.7%  3110  797s
  3169  2273 infeasible   55      25940.8914 37274.0420  43.7%  3138  815s
  3359  2371 28323.9828   61   78 25940.8914 37274.0420  43.7%  3127  833s
  3542  2385 28241.9473   62  123 25940.8914 36729.9434  41.6%  3147  852s
  3610  2440     cutoff   65      25940.8914 36729.9434  41.6%  3165  867s
  3679  2479 26378.9857   74  123 25940.8914 36729.9434  41.6%  3182  886s
  3782  2574 28886.9784   11  327 25940.8914 36638.6629  41.2%  3195  904s
  3961  2712 27281.8557   13  274 25940.8914 36574.1592  41.0%  3197  923s
H 4146  2700                    26197.505001 36574.1592  39.6%  3222 1011s
  4147  2699 30849.6967   20  446 26197.5050 36574.1592  39.6%  3221 1043s
  4149  2700 27981.1083   37   68 26197.5050 36574.1592  39.6%  3219 1091s
  4150  2701 35971.7938    5  293 26197.5050 36574.1592  39.6%  3219 1112s
  4151  2702 27231.1251   13  323 26197.5050 36574.1592  39.6%  3218 1128s
  4152  2702 33216.3072   21  382 26197.5050 36574.1592  39.6%  3217 1142s
  4153  2703 27586.9662   36  413 26197.5050 36574.1592  39.6%  3216 1151s
  4154  2704 30589.4416   42  353 26197.5050 36574.1592  39.6%  3215 1157s
  4155  2704 29047.9615   57  346 26197.5050 36574.1592  39.6%  3215 1165s
  4157  2706 29300.6286   14  447 26197.5050 36574.1592  39.6%  3213 1170s
  4160  2708 35457.6568   15  434 26197.5050 36574.1592  39.6%  3211 1176s
  4163  2710 30466.8476   33  379 26197.5050 36574.1592  39.6%  3208 1185s
  4165  2711 31662.9732   32  390 26197.5050 36574.1592  39.6%  3207 1191s
  4166  2712 29849.3968   23  424 26197.5050 36574.1592  39.6%  3206 1196s
  4169  2714 27642.5380   32  443 26197.5050 36574.1592  39.6%  3204 1201s
  4170  2714 33972.9532   16  454 26197.5050 36574.1592  39.6%  3203 1207s
  4172  2716 26653.9880   41  432 26197.5050 36574.1592  39.6%  3202 1216s
  4175  2718 32215.1394   23  438 26197.5050 36574.1592  39.6%  3199 1220s
  4176  2718 35312.4462    9  398 26197.5050 36574.1592  39.6%  3198 1226s
  4178  2720 31495.8594   29  424 26197.5050 36574.1592  39.6%  3197 1234s
  4179  2720 30400.5175   23  432 26197.5050 36574.1592  39.6%  3196 1235s
  4181  2722 27069.2841   48  451 26197.5050 36574.1592  39.6%  3195 1245s
  4184  2724 32371.3490   22  451 26197.5050 36574.1592  39.6%  3192 1255s
  4186  2725 26407.2988   72  447 26197.5050 36574.1592  39.6%  3191 1262s
  4187  2726 27712.5213   41  447 26197.5050 36574.1592  39.6%  3190 1310s
  4188  2726 31480.0716   34  447 26197.5050 36574.1592  39.6%  3189 1340s
  4189  2730 36574.1592   16  421 26197.5050 36574.1592  39.6%  3248 1400s
  4191  2733 36574.1592   17  426 26197.5050 36574.1592  39.6%  3248 1428s
  4195  2740 36574.1592   18  435 26197.5050 36574.1592  39.6%  3253 1443s
  4203  2753 36574.1592   19  439 26197.5050 36574.1592  39.6%  3263 1458s
  4219  2765 34156.5143   20  240 26197.5050 36574.1592  39.6%  3290 1486s
  4236  2778 35282.9456   21  377 26197.5050 36574.1592  39.6%  3326 1507s
  4268  2857 34527.2273   22  256 26197.5050 36574.1592  39.6%  3366 1534s
  4363  2880 32737.6101   24  241 26197.5050 36574.1592  39.6%  3433 1551s
  4428  2899 32806.8431   25  228 26197.5050 36574.1592  39.6%  3448 1566s
  4491  2902 32660.4211   25  228 26197.5050 36574.1592  39.6%  3443 1582s
  4527  2917 27592.1193   25  285 26197.5050 36574.1592  39.6%  3451 1598s
  4575  2939 33180.8696   23  233 26197.5050 36574.1592  39.6%  3464 1611s
  4629  2956 32271.0808   26  330 26197.5050 36574.1592  39.6%  3482 1624s
  4687  2974 32276.6988   26  227 26197.5050 36574.1592  39.6%  3483 1642s
  4756  2989 31918.3164   27  333 26197.5050 36574.1592  39.6%  3489 1659s
  4822  3008 30997.0975   28  218 26197.5050 36574.1592  39.6%  3497 1671s
  4888  3016 29283.3511   29  207 26197.5050 36574.1592  39.6%  3512 1686s
  4941  3034 30489.2227   29  199 26197.5050 36574.1592  39.6%  3519 1700s
  5018  3052 30161.1224   30  210 26197.5050 36574.1592  39.6%  3514 1713s
  5078  3059 29859.3311   31  255 26197.5050 36574.1592  39.6%  3525 1729s
  5153  3066 28835.9420   30  156 26197.5050 36392.8511  38.9%  3518 1742s
  5229  3063 infeasible   30      26197.5050 36392.8511  38.9%  3520 1757s
  5300  3091     cutoff   31      26197.5050 36392.8511  38.9%  3519 1771s
  5369  3109 29223.0183   35  192 26197.5050 36392.8511  38.9%  3514 1787s
  5451  3113 28878.9154   36  150 26197.5050 36392.8511  38.9%  3519 1804s
  5557  3127     cutoff   36      26197.5050 36392.8511  38.9%  3509 1820s
  5650  3120 27909.1576   38  137 26197.5050 36392.8511  38.9%  3515 1836s
  5700  3147 26777.2636   39  177 26197.5050 36392.8511  38.9%  3530 1854s
  5791  3153     cutoff   40      26197.5050 35851.5310  36.9%  3536 1871s
  5896  3165 34912.8310   23  420 26197.5050 35649.6043  36.1%  3559 1890s
  5980  3198 33500.6856   26  330 26197.5050 35649.6043  36.1%  3603 1909s
  6075  3231 31560.1582   28  278 26197.5050 35649.6043  36.1%  3633 1928s
  6196  3256 28562.5089   30  270 26197.5050 35348.1080  34.9%  3643 1945s
  6342  3279 28187.6572   32  189 26197.5050 35348.1080  34.9%  3647 1967s
  6485  3319 27467.4436   35  196 26197.5050 35154.5849  34.2%  3653 1987s
  6650  3290     cutoff   37      26197.5050 34940.2720  33.4%  3656 2009s
  6795  3319 33732.4156   23  307 26197.5050 34940.2720  33.4%  3636 2032s
  6949  3339 32593.9086   25  253 26197.5050 34867.8343  33.1%  3635 2058s
  7130  3367 31650.8836   28  188 26197.5050 34867.8343  33.1%  3636 2082s
  7302  3381 30861.3350   32  172 26197.5050 34704.3943  32.5%  3653 2108s
  7501  3418 28742.3558   39  108 26197.5050 34704.3943  32.5%  3653 2132s
  7682  3456 27008.8731   50   97 26197.5050 34704.3943  32.5%  3665 2157s
  7881  3476     cutoff   26      26197.5050 34704.3943  32.5%  3672 2181s
H 7918  3327                    26197.517504 34704.3943  32.5%  3676 2181s
  8050  3380 26789.6428   27  349 26197.5175 34473.8806  31.6%  3666 2208s
  8273  3425 32387.0521   24  293 26197.5175 34296.4935  30.9%  3677 2236s
  8511  3448 30163.5528   31  311 26197.5175 34179.9527  30.5%  3675 2264s
  8747  3498 27863.3362   39  187 26197.5175 34092.0937  30.1%  3692 2293s
H 9044  3342                    26256.399391 33979.7399  29.4%  3698 2324s
H 9058  3213                    26282.690725 33957.7350  29.2%  3700 2324s
H 9241  3034                    26290.480859 33957.7350  29.2%  3689 2324s
H 9287  2973                    26294.753694 33957.7350  29.1%  3692 2351s
  9479  2994 26394.5463   30  149 26294.7537 33957.7350  29.1%  3706 2384s
  9832  2960 28967.0815   32  202 26294.7537 33957.7350  29.1%  3690 2414s
 10129  2938     cutoff   34      26294.7537 33750.6227  28.4%  3690 2448s
 10391  2914 26950.2042   39  226 26294.7537 33671.5056  28.1%  3690 2480s
 10630  2954 28145.2972   28  106 26294.7537 33671.5056  28.1%  3702 2511s
 10904  3034     cutoff   31      26294.7537 33511.8440  27.4%  3703 2548s
 11215  3138     cutoff   34      26294.7537 33511.8440  27.4%  3699 2585s
 11493  3274 infeasible   42      26294.7537 33203.2924  26.3%  3716 2625s
 11888  3369 31396.3799   32  208 26294.7537 33203.2924  26.3%  3723 2663s
 12279  3457 30547.6019   37   96 26294.7537 33133.1804  26.0%  3748 2703s
 12614  3588     cutoff   44      26294.7537 33133.1804  26.0%  3749 2745s
 13073  3687     cutoff   30      26294.7537 33080.0248  25.8%  3761 2792s
 13616  3896 31128.6868   34  275 26294.7537 32950.5039  25.3%  3755 2836s
 14170  4036     cutoff   43      26294.7537 32766.2253  24.6%  3744 2881s
 14710  4145 29022.5948   31  205 26294.7537 32597.9151  24.0%  3752 2933s
 15195  4273 31430.6141   29  383 26294.7537 32367.8006  23.1%  3752 2980s
 15837  4429     cutoff   42      26294.7537 32274.7989  22.7%  3747 3034s
 16489  4552 26757.0311   37  182 26294.7537 32161.8635  22.3%  3750 3088s
 17071  4566 27586.1375   35  187 26294.7537 31999.3872  21.7%  3769 3136s
 17120  4595 27439.9045   36  188 26294.7537 31999.3872  21.7%  3772 3185s
 17273  4688 27252.0474   37  101 26294.7537 31897.7352  21.3%  3770 3238s
 17776  4867     cutoff   34      26294.7537 31832.5550  21.1%  3765 3299s
 18528  4979     cutoff   39      26294.7537 31758.5047  20.8%  3753 3359s
 19305  5053 29876.8557   30  414 26294.7537 31568.3863  20.1%  3750 3424s
 20164  5161     cutoff   41      26294.7537 31421.0549  19.5%  3740 3496s
 20987  5259     cutoff   32      26294.7537 31241.1209  18.8%  3742 3561s
 21833  5232 27194.3715   34  190 26294.7537 31040.2708  18.0%  3743 3600s

Cutting planes:
  MIR: 508
  Flow cover: 2240
  RLT: 15
  Relax-and-lift: 229

Explored 22421 nodes (83884842 simplex iterations) in 3600.05 seconds (7482.70 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 26294.8 26290.5 26282.7 ... 25655.3

Time limit reached
Best objective 2.629475369399e+04, best bound 3.096536802113e+04, gap 17.7625%
  WARNING: Time limit reached. Using best solution found (gap: 17.76%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 26294.75, θ = 171942.49
  Upper Bound (UB) = 26294.75

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171942.49
  [DEBUG]   ✓ Scenario 0: θ = 171942.49 ≤ Q = 171942.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171942.49 ≤ Q = 171942.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171942.49 ≤ Q = 171942.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171942.49 ≤ Q = 171942.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 171942.49 ≤ Q = 171942.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 171942.49 ≤ Q = 171942.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 171942.49 ≤ Q = 171942.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 171942.49 ≤ Q = 171942.49 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3c86c97a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc3793686
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.422475e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6945229.2233
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.619661e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161966.06    0  127 6945229.22 -161966.06   102%     -    0s
H    0     0                    -127314.4721 -161966.06  27.2%     -    0s
H    0     0                    -128099.4590 -161966.06  26.4%     -    0s
H    0     0                    -134447.1407 -140474.07  4.48%     -    0s
     0     0 -140474.07    0   35 -134447.14 -140474.07  4.48%     -    0s
H    0     0                    -139726.3488 -140461.76  0.53%     -    0s
     0     0 -140420.00    0   34 -139726.35 -140420.00  0.50%     -    0s
     0     0 -140146.00    0    8 -139726.35 -140146.00  0.30%     -    0s
H    0     0                    -140092.5767 -140145.14  0.04%     -    0s
     0     0 -140143.25    0    4 -140092.58 -140143.25  0.04%     -    0s
H    0     0                    -140114.4630 -140143.25  0.02%     -    0s
     0     0 -140138.05    0    2 -140114.46 -140138.05  0.02%     -    0s
     0     0 -140138.05    0    9 -140114.46 -140138.05  0.02%     -    0s
H    0     0                    -140117.8824 -140133.32  0.01%     -    0s
H    0     0                    -140133.3223 -140133.32  0.00%     -    0s
     0     0          -    0      -140133.32 -140133.32  0.00%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 7

Explored 1 nodes (495 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -140133 -140118 -140114 ... 1.42248e+13
No other solutions better than -140133

Optimal solution found (tolerance 1.00e-06)
Best objective -1.401333222501e+05, best bound -1.401333222501e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 158497.65
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140133.32
  [DEBUG]   S×d_nominal = 298630.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298630.97 + -140133.32 = 158497.65
  [DEBUG]   Current θ from Master = 171942.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13444.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12849.91
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 1441.0718, Absolute Gap = 1441.0718, Relative Gap = 0.054805
  Not converged yet (gap = 1441.07 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x5f775ebb
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63890 rows and 25960 columns
Presolve time: 2.35s
Presolved: 75103 rows, 32460 columns, 468329 nonzeros
Variable types: 30201 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75103 rows, 32460 columns, 468329 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   22828   -1.9423607e+05   0.000000e+00   5.053434e+06      5s
   35651   -1.8598408e+04   0.000000e+00   2.062633e+07     10s
   45540    1.4286162e+04   0.000000e+00   4.511901e+06     15s
   52096    2.3591710e+04   0.000000e+00   8.490736e+06     20s
   58282    2.5997239e+04   0.000000e+00   4.348660e+06     25s
   62756    2.6448114e+04   0.000000e+00   1.855343e+07     30s
   68545    3.0871345e+04   0.000000e+00   2.027906e+07     35s
   74694    3.4714799e+04   0.000000e+00   6.665884e+07     40s
   80110    3.7528960e+04   0.000000e+00   8.976044e+07     45s
   86161    4.2422532e+04   0.000000e+00   1.021821e+07     50s
   92374    4.4045350e+04   0.000000e+00   7.315119e+06     55s
Concurrent spin time: 2.59s

Solved with dual simplex

Root relaxation: objective 5.116890e+04, 61901 iterations, 56.51 seconds (73.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 51168.9043    0   71 -239613.87 51168.9043   121%     -   59s
H    0     0                    -230047.8529 51168.9043   122%     -   60s
H    0     0                    -174000.1226 51168.9043   129%     -   60s
H    0     0                    -173099.6655 51168.9043   130%     -   60s
H    0     0                    -155759.3418 51168.9043   133%     -   60s
H    0     0                    -155348.7755 51168.9043   133%     -   60s
H    0     0                    -155134.0640 51168.9043   133%     -   60s
H    0     0                    -154086.6728 51168.9043   133%     -   60s
H    0     0                    -39267.17551 51168.9043   230%     -   61s
H    0     0                    -39103.08115 51168.9043   231%     -   61s
H    0     0                    -2336.649595 51168.9043  2290%     -   61s
H    0     0                    6292.9636961 51168.9043   713%     -   61s
H    0     0                    18543.014542 51168.9043   176%     -   61s
H    0     0                    23972.541403 51168.9043   113%     -   61s
H    0     0                    25184.901562 51168.9043   103%     -   61s
H    0     0                    25226.270760 51168.9043   103%     -   62s
H    0     0                    25513.935203 51168.9043   101%     -   62s
H    0     0                    25636.614269 46759.7763  82.4%     -   74s
     0     0 46757.4739    0  219 25636.6143 46757.4739  82.4%     -   75s
     0     0 46574.9319    0  228 25636.6143 46574.9319  81.7%     -   78s
     0     0 46574.9319    0  220 25636.6143 46574.9319  81.7%     -   80s
     0     0 46574.9319    0  220 25636.6143 46574.9319  81.7%     -   80s
H    0     0                    25701.355897 44056.1444  71.4%     -   92s
     0     0 44056.1444    0  207 25701.3559 44056.1444  71.4%     -   92s
     0     0 43471.8010    0  248 25701.3559 43471.8010  69.1%     -  101s
     0     0 43362.4272    0  235 25701.3559 43362.4272  68.7%     -  105s
     0     0 43213.0253    0  258 25701.3559 43213.0253  68.1%     -  110s
     0     0 43060.3088    0  264 25701.3559 43060.3088  67.5%     -  114s
     0     0 43053.0808    0  263 25701.3559 43053.0808  67.5%     -  116s
     0     0 43052.6088    0  263 25701.3559 43052.6088  67.5%     -  116s
     0     0 41258.6520    0  251 25701.3559 41258.6520  60.5%     -  137s
H    0     0                    25728.624783 40599.7951  57.8%     -  150s
     0     0 40599.7951    0  352 25728.6248 40599.7951  57.8%     -  150s
     0     0 40407.8461    0  357 25728.6248 40407.8461  57.1%     -  156s
     0     0 40347.7864    0  357 25728.6248 40347.7864  56.8%     -  160s
     0     0 40325.9393    0  356 25728.6248 40325.9393  56.7%     -  162s
     0     0 40315.0841    0  367 25728.6248 40315.0841  56.7%     -  164s
     0     0 40297.1465    0  366 25728.6248 40297.1465  56.6%     -  166s
     0     0 40293.9453    0  363 25728.6248 40293.9453  56.6%     -  167s
     0     0 40288.0445    0  364 25728.6248 40288.0445  56.6%     -  169s
     0     0 40287.1984    0  364 25728.6248 40287.1984  56.6%     -  170s
     0     0 39741.0271    0  392 25728.6248 39741.0271  54.5%     -  190s
     0     0 39513.8081    0  396 25728.6248 39513.8081  53.6%     -  197s
     0     0 39422.4738    0  401 25728.6248 39422.4738  53.2%     -  201s
     0     0 39373.9047    0  410 25728.6248 39373.9047  53.0%     -  204s
     0     0 39346.7997    0  416 25728.6248 39346.7997  52.9%     -  207s
     0     0 39333.7446    0  414 25728.6248 39333.7446  52.9%     -  208s
     0     0 39294.9610    0  407 25728.6248 39294.9610  52.7%     -  212s
     0     0 39279.2394    0  408 25728.6248 39279.2394  52.7%     -  214s
     0     0 39263.9435    0  418 25728.6248 39263.9435  52.6%     -  217s
     0     0 39256.1579    0  416 25728.6248 39256.1579  52.6%     -  218s
     0     0 39246.3496    0  414 25728.6248 39246.3496  52.5%     -  220s
     0     0 39242.1574    0  418 25728.6248 39242.1574  52.5%     -  220s
     0     0 39229.7727    0  420 25728.6248 39229.7727  52.5%     -  222s
     0     0 39184.2245    0  400 25728.6248 39184.2245  52.3%     -  226s
     0     0 39175.1057    0  413 25728.6248 39175.1057  52.3%     -  228s
     0     0 39173.3985    0  410 25728.6248 39173.3985  52.3%     -  230s
     0     0 39172.0050    0  412 25728.6248 39172.0050  52.3%     -  230s
     0     0 39171.4748    0  412 25728.6248 39171.4748  52.2%     -  231s
     0     0 39030.0240    0  420 25728.6248 39030.0240  51.7%     -  238s
     0     0 38995.7139    0  471 25728.6248 38995.7139  51.6%     -  242s
     0     0 38973.6201    0  472 25728.6248 38973.6201  51.5%     -  244s
     0     0 38953.6808    0  472 25728.6248 38953.6808  51.4%     -  247s
     0     0 38946.5512    0  480 25728.6248 38946.5512  51.4%     -  248s
     0     0 38940.2967    0  483 25728.6248 38940.2967  51.4%     -  249s
     0     0 38935.3147    0  488 25728.6248 38935.3147  51.3%     -  250s
     0     0 38929.2753    0  483 25728.6248 38929.2753  51.3%     -  251s
     0     0 38925.9614    0  483 25728.6248 38925.9614  51.3%     -  252s
     0     0 38924.9157    0  482 25728.6248 38924.9157  51.3%     -  253s
     0     0 38882.4322    0  475 25728.6248 38882.4322  51.1%     -  258s
     0     0 38855.3165    0  474 25728.6248 38855.3165  51.0%     -  265s
     0     0 38844.5073    0  484 25728.6248 38844.5073  51.0%     -  267s
     0     0 38824.9667    0  484 25728.6248 38824.9667  50.9%     -  269s
     0     0 38818.5217    0  485 25728.6248 38818.5217  50.9%     -  271s
     0     0 38817.1817    0  488 25728.6248 38817.1817  50.9%     -  271s
     0     0 38787.1049    0  487 25728.6248 38787.1049  50.8%     -  276s
     0     0 38781.5481    0  491 25728.6248 38781.5481  50.7%     -  279s
     0     0 38776.4868    0  492 25728.6248 38776.4868  50.7%     -  280s
     0     0 38766.7435    0  491 25728.6248 38766.7435  50.7%     -  282s
     0     0 38764.1591    0  494 25728.6248 38764.1591  50.7%     -  283s
     0     0 38763.6025    0  496 25728.6248 38763.6025  50.7%     -  283s
     0     0 38749.9892    0  491 25728.6248 38749.9892  50.6%     -  286s
     0     0 38740.7304    0  495 25728.6248 38740.7304  50.6%     -  296s
     0     0 38738.4501    0  496 25728.6248 38738.4501  50.6%     -  297s
     0     0 38736.9809    0  491 25728.6248 38736.9809  50.6%     -  297s
     0     0 38735.3732    0  444 25728.6248 38735.3732  50.6%     -  298s
     0     0 38734.9940    0  450 25728.6248 38734.9940  50.6%     -  299s
     0     0 38723.1468    0  499 25728.6248 38723.1468  50.5%     -  301s
     0     0 38718.5423    0  504 25728.6248 38718.5423  50.5%     -  302s
     0     0 38717.1715    0  505 25728.6248 38717.1715  50.5%     -  303s
     0     0 38715.3129    0  458 25728.6248 38715.3129  50.5%     -  305s
     0     0 38714.2662    0  457 25728.6248 38714.2662  50.5%     -  306s
     0     0 38709.4859    0  454 25728.6248 38709.4859  50.5%     -  307s
     0     0 38708.0479    0  452 25728.6248 38708.0479  50.4%     -  308s
     0     0 38698.7404    0  450 25728.6248 38698.7404  50.4%     -  310s
     0     0 38698.5194    0  450 25728.6248 38698.5194  50.4%     -  312s
     0     2 38698.5194    0  450 25728.6248 38698.5194  50.4%     -  371s
     1     4 38654.2340    1  433 25728.6248 38694.2783  50.4%  1561  380s
     3     7 38007.3808    2  364 25728.6248 38651.7898  50.2%  5482  393s
     6    14 37414.7659    3  418 25728.6248 38651.7898  50.2%  7664  405s
    13    28 37073.0991    4  407 25728.6248 38176.0515  48.4%  7438  417s
    27    42 37486.5342    4  460 25728.6248 37931.8028  47.4% 10084  447s
    41    74 36598.8886    5  393 25728.6248 37931.8028  47.4%  9234  492s
    73   158 36407.7142    6  366 25728.6248 37677.7730  46.4%  9028  517s
   157   257 35727.7954    8  287 25728.6248 37676.0135  46.4%  6279  537s
   256   336 35505.9611   10  397 25728.6248 37676.0135  46.4%  4955  553s
   335   403 34678.2794   12  325 25728.6248 37676.0135  46.4%  4494  566s
   402   467 34629.5404   13  323 25728.6248 37676.0135  46.4%  4323  580s
   480   515 34010.4157   16  327 25728.6248 37676.0135  46.4%  4024  597s
   546   565 33489.2772   18  265 25728.6248 37676.0135  46.4%  3843  611s
   612   625 33275.2752   20  265 25728.6248 37535.0643  45.9%  3716  626s
   686   694 32258.2666   22  204 25728.6248 37535.0643  45.9%  3589  638s
   761   725 32085.1332   25  267 25728.6248 37535.0643  45.9%  3487  652s
   792   762 32036.6658   26  302 25728.6248 37535.0643  45.9%  3441  661s
   831   805 32035.8470   27  265 25728.6248 37535.0643  45.9%  3370  673s
   876   866 31932.6733   28  255 25728.6248 37535.0643  45.9%  3325  685s
   950   936 31883.1321   29  255 25728.6248 37416.6357  45.4%  3180  697s
  1031  1008 31701.2618   30  175 25728.6248 37416.6357  45.4%  3030  710s
  1131  1060 31200.4398   32  183 25728.6248 37351.7896  45.2%  2883  723s
  1218  1137 30604.7457   38  199 25728.6248 37351.7896  45.2%  2819  738s
  1301  1219 29925.6704   46  190 25728.6248 37351.7896  45.2%  2768  754s
  1391  1285 29327.6472   52  224 25728.6248 37351.7896  45.2%  2722  772s
  1482  1359 28495.6502   59  151 25728.6248 37351.7896  45.2%  2686  788s
  1582  1417 27773.4073   69  174 25728.6248 37351.7896  45.2%  2628  806s
  1682  1505 26986.3630   76  117 25728.6248 37351.7896  45.2%  2598  824s
  1792  1615 35780.2406   13  266 25728.6248 37351.7896  45.2%  2600  843s
  1935  1706 34997.4166   15  292 25728.6248 37351.7896  45.2%  2556  863s
  2081  1782 32885.7914   16  260 25728.6248 37351.7896  45.2%  2489  884s
  2212  1907 32528.2402   17  209 25728.6248 37351.7896  45.2%  2467  902s
  2375  1991 26750.2879   19  112 25728.6248 37351.7896  45.2%  2425  924s
  2528  2061     cutoff   23      25728.6248 37141.8149  44.4%  2388  947s
  2662  2134 infeasible   37      25728.6248 37069.8250  44.1%  2392  970s
  2825  2209 27703.0429   61  214 25728.6248 36995.6787  43.8%  2387  991s
  2984  2293 36364.3416    6  237 25728.6248 36995.6787  43.8%  2379 1012s
H 3014  2293                    25779.548317 36995.6787  43.5%  2381 1012s
  3110  2413 35071.8658    8  238 25779.5483 36995.6787  43.5%  2371 1034s
  3313  2515 33250.0900   12  204 25779.5483 36940.4995  43.3%  2353 1057s
  3489  2537 32434.0490   15  199 25779.5483 36923.6074  43.2%  2357 1074s
H 3503  2537                    25802.918666 36901.7727  43.0%  2357 1074s
H 3507  2537                    25857.679318 36901.7727  42.7%  2359 1074s
  3531  2674 31998.0676   16  252 25857.6793 36901.7727  42.7%  2367 1099s
H 3690  2669                    26027.541065 36901.7727  41.8%  2379 1135s
  3691  2670 31104.9873   42  450 26027.5411 36901.7727  41.8%  2378 1193s
  3693  2671 35434.0513   19   71 26027.5411 36901.7727  41.8%  2377 1262s
H 3693  2537                    26101.521993 36901.7727  41.4%  2377 1284s
  3694  2538 33966.2436   18  236 26101.5220 36901.7727  41.4%  2376 1289s
  3695  2539 34507.5687   21  327 26101.5220 36901.7727  41.4%  2376 1307s
  3696  2539 32244.6548   33  380 26101.5220 36901.7727  41.4%  2375 1325s
  3697  2540 31260.7152   18  410 26101.5220 36901.7727  41.4%  2374 1333s
  3698  2541 33171.6760   30  403 26101.5220 36901.7727  41.4%  2374 1340s
  3700  2542 27933.7440   43  475 26101.5220 36901.7727  41.4%  2373 1349s
  3701  2543 34942.4578   14  470 26101.5220 36901.7727  41.4%  2372 1355s
  3703  2544 27261.1745   47  438 26101.5220 36901.7727  41.4%  2371 1362s
  3705  2545 30599.9518   42  436 26101.5220 36901.7727  41.4%  2369 1365s
  3708  2547 31218.0339   31  450 26101.5220 36901.7727  41.4%  2367 1372s
  3709  2548 31944.2895   46  512 26101.5220 36901.7727  41.4%  2367 1382s
  3710  2549 35111.2353   11  495 26101.5220 36901.7727  41.4%  2366 1385s
  3713  2551 35840.5102   10  503 26101.5220 36901.7727  41.4%  2364 1393s
  3714  2551 36342.8656    9  521 26101.5220 36901.7727  41.4%  2364 1402s
  3715  2552 32520.5115   18  525 26101.5220 36901.7727  41.4%  2363 1405s
  3717  2553 30267.8278   31  525 26101.5220 36901.7727  41.4%  2362 1412s
  3718  2554 29842.8990   16  486 26101.5220 36901.7727  41.4%  2361 1423s
  3719  2555 35573.9518   12  508 26101.5220 36901.7727  41.4%  2360 1426s
  3720  2555 31563.9592   28  510 26101.5220 36901.7727  41.4%  2360 1431s
  3721  2556 34974.4253   13  516 26101.5220 36901.7727  41.4%  2359 1438s
  3722  2557 29337.7499   23  528 26101.5220 36901.7727  41.4%  2359 1440s
  3723  2557 29507.8092   61  522 26101.5220 36901.7727  41.4%  2358 1445s
  3724  2558 33503.0628   12  515 26101.5220 36901.7727  41.4%  2357 1455s
  3726  2559 34315.6790   15  519 26101.5220 36901.7727  41.4%  2356 1460s
  3727  2560 32827.7718   36  535 26101.5220 36901.7727  41.4%  2355 1467s
  3729  2561 32146.9445   33  534 26101.5220 36901.7727  41.4%  2354 1470s
  3730  2562 31050.5393   29  530 26101.5220 36901.7727  41.4%  2353 1475s
  3731  2563 31060.3134   21  549 26101.5220 36901.7727  41.4%  2353 1487s
  3732  2563 28470.0718   20  542 26101.5220 36901.7727  41.4%  2352 1490s
  3733  2564 28541.3196   31  542 26101.5220 36901.7727  41.4%  2352 1495s
  3734  2565 35060.3105   14  518 26101.5220 36901.7727  41.4%  2351 1502s
  3735  2565 27550.3164   67  526 26101.5220 36901.7727  41.4%  2350 1506s
  3736  2566 34450.5322   13  535 26101.5220 36901.7727  41.4%  2350 1515s
  3738  2567 28355.2854   23  533 26101.5220 36901.7727  41.4%  2348 1526s
  3740  2569 30048.4652   23  537 26101.5220 36901.7727  41.4%  2347 1533s
  3741  2569 29666.7989   26  537 26101.5220 36901.7727  41.4%  2347 1557s
  3742  2570 26265.0979   68  537 26101.5220 36901.7727  41.4%  2346 1562s
  3743  2571 34191.4921   15  519 26101.5220 36901.7727  41.4%  2345 1568s
  3744  2571 32357.6854   23  519 26101.5220 36901.7727  41.4%  2345 1642s
  3745  2572 35476.2487    8  519 26101.5220 36901.7727  41.4%  2344 1678s
  3746  2576 36901.7727   13  515 26101.5220 36901.7727  41.4%  2416 1702s
  3748  2579 36901.7727   14  510 26101.5220 36901.7727  41.4%  2418 1728s
  3752  2586 36901.7727   15  516 26101.5220 36901.7727  41.4%  2424 1758s
  3760  2599 36901.7727   16  505 26101.5220 36901.7727  41.4%  2435 1783s
  3776  2610 34903.6798   17  424 26101.5220 36901.7727  41.4%  2490 1829s
  3792  2636 33078.1466   18  275 26101.5220 36901.7727  41.4%  2519 1864s
  3824  2700 32501.5063   19  271 26101.5220 36901.7727  41.4%  2548 1895s
  3898  2705 31897.2312   21  265 26101.5220 36901.7727  41.4%  2615 1917s
  3930  2734 32234.2074   20  258 26101.5220 36901.7727  41.4%  2622 1939s
  3970  2785 29756.0303   22  248 26101.5220 36901.7727  41.4%  2650 1959s
  4037  2810 31563.8411   21  255 26101.5220 36901.7727  41.4%  2665 1981s
  4118  2816 27131.8277   23  229 26101.5220 36901.7727  41.4%  2684 2000s
  4195  2804 29660.2534   23  239 26101.5220 36901.7727  41.4%  2705 2020s
  4275  2800 28238.0747   26  342 26101.5220 36901.7727  41.4%  2746 2037s
  4342  2790     cutoff   24      26101.5220 36901.7727  41.4%  2772 2057s
  4414  2781 26277.6583   29  193 26101.5220 36901.7727  41.4%  2808 2077s
  4491  2779 33455.0734   20  360 26101.5220 36901.7727  41.4%  2828 2097s
  4565  2771 33010.3588   21  340 26101.5220 36741.3404  40.8%  2852 2115s
  4624  2787 32277.4661   22  290 26101.5220 36741.3404  40.8%  2877 2129s
  4690  2821 31975.8032   24  227 26101.5220 36698.0069  40.6%  2894 2146s
  4765  2840 31605.7732   26  283 26101.5220 36698.0069  40.6%  2903 2166s
  4841  2831 31210.3677   27  241 26101.5220 36698.0069  40.6%  2918 2189s
  4917  2832 31075.9556   29  148 26101.5220 36692.8275  40.6%  2927 2212s
  5007  2843 29943.5553   32  291 26101.5220 36454.6496  39.7%  2960 2231s
  5084  2880 29531.5359   34   95 26101.5220 36454.6496  39.7%  2991 2257s
  5177  2886 28494.8730   37  146 26101.5220 35942.8530  37.7%  3021 2278s
  5263  2886 27007.1066   42  113 26101.5220 35942.8530  37.7%  3056 2302s
  5377  2869 32263.6130   18  255 26101.5220 35942.8530  37.7%  3083 2319s
  5424  2885 29627.8168   19  293 26101.5220 35942.8530  37.7%  3119 2341s
  5501  2906 29537.3412   20  304 26101.5220 35942.8530  37.7%  3135 2365s
  5594  2898 28214.4161   23  271 26101.5220 35942.8530  37.7%  3166 2389s
  5714  2919     cutoff   23      26101.5220 35433.4364  35.8%  3176 2415s
  5828  2925 34519.0868   20  292 26101.5220 35433.4364  35.8%  3197 2442s
  5947  2942 33290.9928   23  192 26101.5220 35433.4364  35.8%  3231 2472s
  6077  2965 32691.1471   25  247 26101.5220 35046.5330  34.3%  3258 2501s
  6228  2980 32110.2409   28  239 26101.5220 34898.9552  33.7%  3292 2536s
  6377  2991 29285.1017   32  127 26101.5220 34787.4782  33.3%  3310 2567s
  6526  3019 27557.2944   36  114 26101.5220 34507.3432  32.2%  3352 2597s
  6686  3055     cutoff   41      26101.5220 34440.1512  31.9%  3379 2628s
  6848  3076 31070.5930   20  341 26101.5220 34439.3533  31.9%  3412 2660s
  7034  3073 30145.2049   22  328 26101.5220 34312.8392  31.5%  3425 2691s
  7179  3124 29859.7028   23  356 26101.5220 34312.8392  31.5%  3432 2722s
  7348  3138 28731.4569   25  246 26101.5220 34312.8392  31.5%  3452 2757s
  7551  3166     cutoff   29      26101.5220 34007.1946  30.3%  3485 2793s
  7776  3161     cutoff   32      26101.5220 34007.1946  30.3%  3495 2833s
  8058  3117 infeasible   23      26101.5220 33298.9520  27.6%  3514 2870s
  8289  3085     cutoff   27      26101.5220 33166.3625  27.1%  3565 2905s
  8475  3122 31962.1439   24  363 26101.5220 33166.3625  27.1%  3589 2947s
  8735  3106 30403.2388   31  258 26101.5220 33106.2414  26.8%  3621 2991s
  9078  3077 27231.1174   42  165 26101.5220 32933.1252  26.2%  3621 3034s
  9373  3070 29094.0531   30  119 26101.5220 32706.4351  25.3%  3661 3076s
  9562  3064 26820.0281   34  277 26101.5220 32631.1088  25.0%  3684 3119s
  9957  2952 28890.0869   22  223 26101.5220 32539.9701  24.7%  3693 3153s
  9999  2961 28844.7787   23  216 26101.5220 32487.7052  24.5%  3704 3194s
 10045  2970 28774.7368   24  205 26101.5220 32487.7052  24.5%  3709 3240s
 10150  2969     cutoff   38      26101.5220 32380.4497  24.1%  3716 3287s
 10448  2968 27358.1378   29  333 26101.5220 32351.0527  23.9%  3728 3340s
 10843  2892 27266.7942   21  316 26101.5220 32283.4902  23.7%  3757 3395s
 11268  2854     cutoff   26      26101.5220 32013.2029  22.6%  3778 3451s
 11690  2843 27940.1210   27  178 26101.5220 31920.2879  22.3%  3813 3507s
 12154  2831     cutoff   26      26101.5220 31891.0479  22.2%  3842 3568s
 12656  2806 27349.3294   27  232 26101.5220 31717.8861  21.5%  3864 3600s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 509
  Mixing: 3
  Flow cover: 2382
  RLT: 25
  Relax-and-lift: 210

Explored 12995 nodes (50386964 simplex iterations) in 3600.05 seconds (6729.60 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 26101.5 26027.5 25857.7 ... 25226.3

Time limit reached
Best objective 2.610152199267e+04, best bound 3.171788606446e+04, gap 21.5174%
  WARNING: Time limit reached. Using best solution found (gap: 21.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 26101.52, θ = 173143.30
  Upper Bound (UB) = 26101.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173143.30
  [DEBUG]   ✓ Scenario 0: θ = 173143.30 ≤ Q = 173143.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173143.30 ≤ Q = 173143.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173143.30 ≤ Q = 173143.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173143.30 ≤ Q = 173143.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173143.30 ≤ Q = 173143.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173143.30 ≤ Q = 173143.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173143.30 ≤ Q = 173143.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173143.30 ≤ Q = 173143.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173143.30 ≤ Q = 173143.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x14625f34
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeb9da0cc
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.432035e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6945047.4938
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.590731e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159073.10    0  129 6945047.49 -159073.10   102%     -    0s
H    0     0                    -120040.1733 -159073.10  32.5%     -    0s
H    0     0                    -121391.2128 -159073.10  31.0%     -    0s
H    0     0                    -130465.6433 -159073.10  21.9%     -    0s
H    0     0                    -140856.0260 -143063.29  1.57%     -    0s
     0     0 -143063.29    0   67 -140856.03 -143063.29  1.57%     -    0s
H    0     0                    -141115.3632 -142956.68  1.30%     -    0s
H    0     0                    -141359.4537 -142956.68  1.13%     -    0s
H    0     0                    -141618.7908 -142956.68  0.94%     -    0s
     0     0 -142597.05    0   62 -141618.79 -142597.05  0.69%     -    0s
     0     0 -141995.99    0   33 -141618.79 -141995.99  0.27%     -    0s
     0     0 -141995.99    0   32 -141618.79 -141995.99  0.27%     -    0s
H    0     0                    -141639.0452 -141975.17  0.24%     -    0s
     0     0 -141975.17    0   15 -141639.05 -141975.17  0.24%     -    0s
     0     0 -141823.76    0   23 -141639.05 -141823.76  0.13%     -    0s
     0     0 -141805.07    0   21 -141639.05 -141805.07  0.12%     -    0s
     0     0 -141805.06    0   13 -141639.05 -141805.06  0.12%     -    0s
     0     0 -141692.79    0    8 -141639.05 -141692.79  0.04%     -    0s
     0     0 -141677.82    0    7 -141639.05 -141677.82  0.03%     -    0s
H    0     0                    -141660.2801 -141677.82  0.01%     -    0s
     0     0     cutoff    0      -141660.28 -141660.28  0.00%     -    0s

Cutting planes:
  Implied bound: 5
  MIR: 5
  Flow cover: 2
  RLT: 3

Explored 1 nodes (636 simplex iterations) in 0.12 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -141660 -141639 -141619 ... 1.43204e+13
No other solutions better than -141660

Optimal solution found (tolerance 1.00e-06)
Best objective -1.416602800681e+05, best bound -1.416602800681e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 157487.53
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141660.28
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -141660.28 = 157487.53
  [DEBUG]   Current θ from Master = 173143.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15655.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10445.75
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 1247.8401, Absolute Gap = 1247.8401, Relative Gap = 0.047807
  Not converged yet (gap = 1247.84 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xf33f334b
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 71020 rows and 28860 columns
Presolve time: 2.95s
Presolved: 83263 rows, 35800 columns, 510409 nonzeros
Variable types: 33541 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345649.7179
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.561e+06
 Factor NZ  : 7.675e+06 (roughly 100 MB of memory)
 Factor Ops : 1.320e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82663327e+07  1.64783421e+08  1.13e+05 2.23e+01  8.26e+04     5s
   1  -1.36603634e+07  1.44984447e+08  7.75e+04 8.20e+01  5.59e+04     5s
   2  -4.30148548e+06  1.08047587e+08  2.42e+04 1.19e-11  1.85e+04     5s
   3  -8.96192934e+05  7.20300504e+07  2.43e+03 1.12e+00  2.20e+03     5s
   4  -4.98015257e+05  3.47182234e+07  4.73e+02 4.04e-01  5.30e+02     5s
   5  -3.89228643e+05  1.91756917e+07  1.91e+02 1.79e-01  2.36e+02     5s
   6  -2.70517463e+05  1.37841599e+07  7.94e+01 1.18e-01  1.32e+02     5s
   7  -1.73538118e+05  9.80908620e+06  3.89e+01 7.79e-02  8.18e+01     5s
   8  -1.16004620e+05  5.25245883e+06  1.52e+01 3.64e-02  3.94e+01     5s
   9  -9.43576087e+04  3.68804025e+06  8.90e+00 2.47e-02  2.66e+01     5s
  10  -7.96793488e+04  1.35257546e+06  5.61e+00 8.24e-03  9.90e+00     5s
  11  -3.28558320e+04  3.09365997e+05  1.51e+00 2.01e-03  2.29e+00     5s
  12  -1.44320400e+04  1.99681326e+05  1.02e+00 1.21e-03  1.42e+00     5s
  13  -5.51973989e+03  1.39770517e+05  8.36e-01 1.95e-03  9.66e-01     5s
  14   3.11835998e+03  1.08215469e+05  6.78e-01 1.62e-03  6.99e-01     5s
  15   1.09282006e+04  9.61185481e+04  5.56e-01 1.92e-03  5.67e-01     5s
  16   2.38292805e+04  8.75043600e+04  3.60e-01 1.77e-03  4.22e-01     6s
  17   2.79967480e+04  8.18113249e+04  3.00e-01 1.88e-03  3.57e-01     6s
  18   3.05884630e+04  7.16541973e+04  2.61e-01 2.17e-03  2.72e-01     6s
  19   3.34860147e+04  6.60667310e+04  2.22e-01 2.11e-03  2.16e-01     6s
  20   3.86815270e+04  6.43166867e+04  1.56e-01 1.85e-03  1.70e-01     6s
  21   4.01516995e+04  6.29715358e+04  1.38e-01 1.86e-03  1.51e-01     6s
  22   4.39412876e+04  6.00324361e+04  9.42e-02 1.49e-03  1.07e-01     6s
  23   4.52687151e+04  5.82777690e+04  8.05e-02 9.75e-04  8.62e-02     6s
  24   4.65310747e+04  5.69915958e+04  6.75e-02 1.69e-03  6.94e-02     6s
  25   4.70734699e+04  5.65139120e+04  6.19e-02 1.90e-03  6.26e-02     6s
  26   4.80191546e+04  5.57216474e+04  5.24e-02 1.44e-03  5.11e-02     6s
  27   4.92364126e+04  5.55035252e+04  4.05e-02 1.72e-03  4.15e-02     6s
  28   4.99805180e+04  5.48745763e+04  3.34e-02 1.25e-03  3.25e-02     6s
  29   5.08292267e+04  5.46551335e+04  2.52e-02 9.37e-04  2.54e-02     6s
  30   5.14807349e+04  5.44478465e+04  1.88e-02 7.71e-04  1.97e-02     6s
  31   5.16905707e+04  5.41545562e+04  1.68e-02 6.47e-04  1.63e-02     7s
  32   5.22804777e+04  5.39412105e+04  1.14e-02 7.25e-04  1.10e-02     7s
  33   5.27924860e+04  5.38008047e+04  6.83e-03 3.89e-04  6.69e-03     7s
  34   5.30526838e+04  5.37036391e+04  4.54e-03 1.97e-04  4.32e-03     7s
  35   5.32617025e+04  5.36390199e+04  2.76e-03 7.26e-05  2.51e-03     7s
  36   5.34803208e+04  5.36080026e+04  9.46e-04 2.47e-05  8.48e-04     7s
  37   5.35771764e+04  5.36005903e+04  1.42e-04 2.74e-05  1.55e-04     7s
  38   5.35901431e+04  5.35964863e+04  4.27e-05 6.94e-06  4.21e-05     7s
  39   5.35957765e+04  5.35958404e+04  1.16e-07 1.83e-07  4.19e-07     7s
  40   5.35958207e+04  5.35958207e+04  1.14e-09 6.34e-11  5.52e-11     7s

Barrier solved model in 40 iterations and 7.17 seconds (6.06 work units)
Optimal objective 5.35958207e+04


Root crossover log...

   75399 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

     950 PPushes remaining with PInf 1.0115241e-06                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.8929147e-02      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35841    5.3595821e+04   0.000000e+00   5.892915e-02      9s
   35842    5.3595821e+04   0.000000e+00   0.000000e+00      9s
   35842    5.3595821e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.359582e+04, 35842 iterations, 5.91 seconds (7.01 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53595.8207    0  123 -239613.87 53595.8207   122%     -    9s
H    0     0                    -230047.8529 53595.8207   123%     -    9s
H    0     0                    -163321.2013 53595.8207   133%     -   10s
H    0     0                    -162913.1836 53595.8207   133%     -   10s
H    0     0                    -143329.6768 53595.8207   137%     -   10s
H    0     0                    -142770.7354 53595.8207   138%     -   10s
H    0     0                    -142513.3214 53595.8207   138%     -   10s
H    0     0                    -55578.76060 53595.8207   196%     -   10s
H    0     0                    -55074.32119 53595.8207   197%     -   10s
H    0     0                    16258.373537 53595.8207   230%     -   10s
H    0     0                    16993.628841 53595.8207   215%     -   11s
H    0     0                    17063.987304 53595.8207   214%     -   11s
H    0     0                    18797.523923 53595.8207   185%     -   12s
     0     0 47674.4860    0   97 18797.5239 47674.4860   154%     -   29s
H    0     0                    19952.028502 47673.5878   139%     -   30s
     0     0 46895.5805    0  249 19952.0285 46895.5805   135%     -   41s
     0     0 46770.6155    0  244 19952.0285 46770.6155   134%     -   44s
     0     0 46770.6155    0  244 19952.0285 46770.6155   134%     -   45s
H    0     0                    20737.344060 44319.1415   114%     -   62s
H    0     0                    21628.100356 44319.1415   105%     -   62s
H    0     0                    22509.500833 44319.1415  96.9%     -   62s
     0     0 44319.1415    0  316 22509.5008 44319.1415  96.9%     -   62s
     0     0 43716.0426    0  258 22509.5008 43716.0426  94.2%     -   73s
     0     0 43419.9694    0  323 22509.5008 43419.9694  92.9%     -   81s
     0     0 43388.4763    0  327 22509.5008 43388.4763  92.8%     -   85s
     0     0 43266.2949    0  317 22509.5008 43266.2949  92.2%     -   90s
     0     0 43198.2343    0  327 22509.5008 43198.2343  91.9%     -   93s
     0     0 43105.2506    0  330 22509.5008 43105.2506  91.5%     -   96s
     0     0 43041.0366    0  334 22509.5008 43041.0366  91.2%     -   98s
     0     0 43008.9139    0  338 22509.5008 43008.9139  91.1%     -  100s
     0     0 42983.8411    0  332 22509.5008 42983.8411  91.0%     -  101s
     0     0 42983.3480    0  332 22509.5008 42983.3480  91.0%     -  101s
     0     0 41226.2370    0  313 22509.5008 41226.2370  83.2%     -  133s
H    0     0                    22648.155757 41225.3718  82.0%     -  134s
H    0     0                    22662.709113 41225.3718  81.9%     -  134s
     0     0 40473.3194    0  334 22662.7091 40473.3194  78.6%     -  159s
     0     0 40336.8156    0  342 22662.7091 40336.8156  78.0%     -  168s
     0     0 40274.9401    0  341 22662.7091 40274.9401  77.7%     -  174s
     0     0 40172.0824    0  351 22662.7091 40172.0824  77.3%     -  181s
     0     0 40115.9503    0  350 22662.7091 40115.9503  77.0%     -  185s
     0     0 40100.8327    0  351 22662.7091 40100.8327  76.9%     -  189s
     0     0 40086.1194    0  359 22662.7091 40086.1194  76.9%     -  190s
     0     0 40038.9279    0  360 22662.7091 40038.9279  76.7%     -  194s
     0     0 40026.2916    0  356 22662.7091 40026.2916  76.6%     -  196s
     0     0 40018.6650    0  356 22662.7091 40018.6650  76.6%     -  197s
     0     0 40000.8825    0  358 22662.7091 40000.8825  76.5%     -  200s
     0     0 39995.1378    0  400 22662.7091 39995.1378  76.5%     -  202s
     0     0 39991.1982    0  362 22662.7091 39991.1982  76.5%     -  203s
     0     0 39988.3026    0  396 22662.7091 39988.3026  76.4%     -  204s
     0     0 39987.4110    0  352 22662.7091 39987.4110  76.4%     -  205s
     0     0 39403.2740    0  420 22662.7091 39403.2740  73.9%     -  218s
     0     0 39266.4486    0  420 22662.7091 39266.4486  73.3%     -  226s
     0     0 39182.6754    0  417 22662.7091 39182.6754  72.9%     -  232s
     0     0 39155.9242    0  418 22662.7091 39155.9242  72.8%     -  236s
     0     0 39127.9044    0  419 22662.7091 39127.9044  72.7%     -  240s
     0     0 39068.1940    0  414 22662.7091 39068.1940  72.4%     -  245s
     0     0 39060.1710    0  418 22662.7091 39060.1710  72.4%     -  247s
     0     0 39057.3000    0  418 22662.7091 39057.3000  72.3%     -  249s
     0     0 39050.1304    0  419 22662.7091 39050.1304  72.3%     -  251s
     0     0 39014.6824    0  430 22662.7091 39014.6824  72.2%     -  252s
     0     0 39013.5841    0  429 22662.7091 39013.5841  72.1%     -  253s
H    0     0                    22702.764099 38900.6091  71.3%     -  260s
H    0     0                    22710.505979 38900.6091  71.3%     -  260s
     0     0 38900.6091    0  413 22710.5060 38900.6091  71.3%     -  260s
     0     0 38821.7713    0  430 22710.5060 38821.7713  70.9%     -  266s
     0     0 38803.7230    0  423 22710.5060 38803.7230  70.9%     -  270s
     0     0 38787.6288    0  434 22710.5060 38787.6288  70.8%     -  272s
     0     0 38777.9503    0  426 22710.5060 38777.9503  70.7%     -  274s
     0     0 38776.5855    0  428 22710.5060 38776.5855  70.7%     -  274s
     0     0 38671.3266    0  429 22710.5060 38671.3266  70.3%     -  281s
H    0     0                    23052.636471 38671.0155  67.8%     -  286s
H    0     0                    23142.397625 38671.0155  67.1%     -  286s
H    0     0                    24160.822493 38671.0155  60.1%     -  286s
H    0     0                    24691.213545 38671.0155  56.6%     -  287s
     0     0 38640.1567    0  433 24691.2135 38640.1567  56.5%     -  291s
     0     0 38631.9323    0  382 24691.2135 38631.9323  56.5%     -  294s
     0     0 38624.0715    0  434 24691.2135 38624.0715  56.4%     -  296s
     0     0 38617.5956    0  385 24691.2135 38617.5956  56.4%     -  298s
     0     0 38612.1822    0  378 24691.2135 38612.1822  56.4%     -  299s
     0     0 38609.1852    0  375 24691.2135 38609.1852  56.4%     -  300s
     0     0 38607.3265    0  376 24691.2135 38607.3265  56.4%     -  301s
     0     0 38550.4220    0  432 24691.2135 38550.4220  56.1%     -  306s
H    0     0                    25109.864520 38550.4130  53.5%     -  306s
H    0     0                    25479.567142 38550.4130  51.3%     -  306s
     0     0 38542.3020    0  379 25479.5671 38542.3020  51.3%     -  308s
     0     0 38536.7778    0  425 25479.5671 38536.7778  51.2%     -  310s
     0     0 38534.1563    0  390 25479.5671 38534.1563  51.2%     -  311s
     0     0 38533.0319    0  432 25479.5671 38533.0319  51.2%     -  312s
     0     0 38516.7944    0  395 25479.5671 38516.7944  51.2%     -  315s
H    0     0                    25636.614269 38516.3339  50.2%     -  322s
H    0     0                    25698.561105 38516.3339  49.9%     -  324s
     0     0 38514.2382    0  395 25698.5611 38514.2382  49.9%     -  325s
     0     0 38513.3090    0  391 25698.5611 38513.3090  49.9%     -  326s
     0     0 38501.6747    0  434 25698.5611 38501.6747  49.8%     -  330s
     0     0 38493.0772    0  434 25698.5611 38493.0772  49.8%     -  332s
     0     0 38490.1823    0  432 25698.5611 38490.1823  49.8%     -  333s
     0     0 38488.2082    0  432 25698.5611 38488.2082  49.8%     -  334s
     0     0 38487.6489    0  427 25698.5611 38487.6489  49.8%     -  334s
     0     0 38482.5627    0  379 25698.5611 38482.5627  49.7%     -  338s
     0     0 38481.0140    0  476 25698.5611 38481.0140  49.7%     -  340s
     0     0 38469.4640    0  439 25698.5611 38469.4640  49.7%     -  344s
     0     0 38463.9378    0  447 25698.5611 38463.9378  49.7%     -  347s
     0     0 38462.7453    0  446 25698.5611 38462.7453  49.7%     -  348s
     0     0 38457.3962    0  440 25698.5611 38457.3962  49.6%     -  350s
     0     0 38456.8204    0  444 25698.5611 38456.8204  49.6%     -  351s
     0     0 38450.8065    0  432 25698.5611 38450.8065  49.6%     -  354s
     0     0 38450.7606    0  432 25698.5611 38450.7606  49.6%     -  356s
H    0     0                    25728.624783 38450.7606  49.4%     -  396s
     0     2 38450.7606    0  432 25728.6248 38450.7606  49.4%     -  437s
     1     4 38371.7812    1  411 25728.6248 38450.6222  49.4%  4275  452s
     3     7 38122.2211    2  415 25728.6248 38371.5908  49.1%  7331  470s
     6    14 37999.2904    3  378 25728.6248 38122.1272  48.2%  8206  484s
    13    28 37886.9211    4  389 25728.6248 37998.6053  47.7%  8035  500s
    27    42 37258.5951    5  419 25728.6248 37886.2105  47.3% 11237  551s
    41    74 36814.4680    6  375 25728.6248 37886.2105  47.3% 12185  641s
    73   118 36774.1667    7  419 25728.6248 37575.7179  46.0% 11468  667s
   117   166 36735.6988    8  370 25728.6248 37575.4721  46.0%  9387  692s
   165   211 36651.7597    9  369 25728.6248 37575.4721  46.0%  7881  720s
   210   260 36537.0699   10  402 25728.6248 37575.4721  46.0%  7467  741s
   259   313 36374.8526   11  400 25728.6248 37575.4721  46.0%  6820  760s
   314   369 36352.6360   12  398 25728.6248 37575.4721  46.0%  6419  781s
   372   408 35683.2315   13  395 25728.6248 37575.4721  46.0%  5883  809s
   433   448 35626.5971   14  397 25728.6248 37575.4721  46.0%  5532  833s
   482   501 35576.6897   15  411 25728.6248 37575.4721  46.0%  5379  854s
   548   562 35443.8156   16  401 25728.6248 37575.4721  46.0%  5097  874s
   617   632 35427.5979   17  392 25728.6248 37575.4721  46.0%  4848  896s
   695   695 35424.3503   18  346 25728.6248 37513.8007  45.8%  4615  916s
   768   763 35299.8951   19  352 25728.6248 37513.8007  45.8%  4427  935s
   838   861 35031.8815   20  338 25728.6248 37513.8007  45.8%  4306  951s
   938   921 34773.7691   21  328 25728.6248 37513.8007  45.8%  4047  978s
  1010   968 34593.6530   22  342 25728.6248 37513.8007  45.8%  3955  995s
  1073  1035 34560.5328   23  337 25728.6248 37350.1965  45.2%  3829 1016s
  1153  1112 34391.6215   24  287 25728.6248 37350.1965  45.2%  3747 1035s
  1250  1178 34135.0512   25  295 25728.6248 37216.5147  44.7%  3632 1056s
  1331  1210 33750.2684   26  340 25728.6248 37216.5147  44.7%  3633 1076s
  1380  1289 32709.9789   27  319 25728.6248 37216.5147  44.7%  3645 1101s
  1477  1375 32338.8917   28  255 25728.6248 37216.5147  44.7%  3598 1123s
  1594  1419 30219.1516   33  185 25728.6248 37144.2889  44.4%  3529 1146s
  1651  1491 26102.5611   36  140 25728.6248 37058.8621  44.0%  3498 1170s
  1755  1573 34678.3478   14  259 25728.6248 37058.8621  44.0%  3464 1195s
  1867  1659 34188.8067   16  229 25728.6248 37058.8621  44.0%  3420 1220s
  1999  1704 29448.1889   18  206 25728.6248 37035.9788  43.9%  3378 1249s
  2080  1823 29157.5247   21  168 25728.6248 37028.6456  43.9%  3385 1281s
  2211  1948 27980.7787   29  215 25728.6248 37028.6456  43.9%  3380 1312s
  2380  2084 27009.1205   38  242 25728.6248 37028.6456  43.9%  3342 1341s
  2599  2200 infeasible   47      25728.6248 36971.7371  43.7%  3244 1375s
  2804  2302 35010.2019   15  272 25728.6248 36971.7371  43.7%  3179 1404s
  2989  2388 34563.4688   16  267 25728.6248 36971.7371  43.7%  3103 1442s
  3148  2525 27848.3291   18  230 25728.6248 36901.8035  43.4%  3082 1478s
  3342  2696 27590.1630   20  151 25728.6248 36660.2839  42.5%  3078 1518s
  3559  2922 26176.9726   32  150 25728.6248 36660.2839  42.5%  3049 1555s
  3884  2923 35961.0085    7  432 25728.6248 36660.2839  42.5%  2962 1682s
  3886  2924 26298.5281   49   71 25728.6248 36660.2839  42.5%  2961 1699s
  3887  2925 35686.9274   10  253 25728.6248 36660.2839  42.5%  2960 1744s
  3888  2926 27659.3586   22  329 25728.6248 36660.2839  42.5%  2959 1784s
  3889  2926 27787.2054   51  387 25728.6248 36660.2839  42.5%  2959 1811s
  3890  2927 26682.8174   35  367 25728.6248 36660.2839  42.5%  2958 1828s
  3891  2928 30114.2134   28  423 25728.6248 36660.2839  42.5%  2957 1843s
  3892  2928 28825.9861   38  426 25728.6248 36660.2839  42.5%  2956 1855s
  3893  2929 26542.7226   56  428 25728.6248 36660.2839  42.5%  2956 1866s
  3894  2930 32974.7003   13  434 25728.6248 36660.2839  42.5%  2955 1875s
  3895  2930 34880.2439   10  440 25728.6248 36660.2839  42.5%  2954 1881s
  3896  2931 31370.7790   14  447 25728.6248 36660.2839  42.5%  2953 1887s
  3897  2932 32161.3878   31  447 25728.6248 36660.2839  42.5%  2953 1890s
  3899  2933 34997.8722   11  390 25728.6248 36660.2839  42.5%  2951 1898s
  3900  2934 28756.3311   53  397 25728.6248 36660.2839  42.5%  2950 1903s
  3901  2934 35046.7913   13  438 25728.6248 36660.2839  42.5%  2950 1906s
  3902  2935 35836.5872   10  436 25728.6248 36660.2839  42.5%  2949 1911s
  3903  2936 32963.0995   27  453 25728.6248 36660.2839  42.5%  2948 1922s
  3904  2936 27690.1601   19  386 25728.6248 36660.2839  42.5%  2947 1926s
  3906  2938 33588.3112   35  447 25728.6248 36660.2839  42.5%  2946 1938s
  3907  2938 28913.7591   57  379 25728.6248 36660.2839  42.5%  2945 1942s
  3908  2939 35908.6014    8  377 25728.6248 36660.2839  42.5%  2944 1946s
  3909  2940 27622.4617   22  436 25728.6248 36660.2839  42.5%  2944 1955s
  3911  2941 32837.1102   20  446 25728.6248 36660.2839  42.5%  2942 1967s
  3913  2942 26502.2572   43  442 25728.6248 36660.2839  42.5%  2941 1973s
  3914  2943 35086.4267   15  439 25728.6248 36660.2839  42.5%  2940 1987s
  3915  2944 27489.0263   63  437 25728.6248 36660.2839  42.5%  2939 1991s
  3916  2944 26242.4618   45  442 25728.6248 36660.2839  42.5%  2938 1999s
H 3916  2796                    25818.308570 36660.2839  42.0%  2938 2000s
  3918  2798 29547.2261   25  455 25818.3086 36660.2839  42.0%  2937 2013s
  3919  2798 31231.1942   34  445 25818.3086 36660.2839  42.0%  2936 2015s
  3921  2800 34645.3015    9  458 25818.3086 36660.2839  42.0%  2935 2030s
  3923  2801 35875.7982   10  476 25818.3086 36660.2839  42.0%  2933 2038s
  3924  2802 29133.4335   45  466 25818.3086 36660.2839  42.0%  2932 2048s
  3925  2802 27788.4118   25  466 25818.3086 36660.2839  42.0%  2932 2063s
  3926  2803 35593.9649   16  466 25818.3086 36660.2839  42.0%  2931 2130s
  3927  2807 36660.2839   16  444 25818.3086 36660.2839  42.0%  2999 2201s
  3929  2810 36660.2839   17  384 25818.3086 36660.2839  42.0%  3000 2239s
  3933  2817 36660.2839   18  454 25818.3086 36660.2839  42.0%  3006 2279s
  3941  2830 36660.2839   19  445 25818.3086 36660.2839  42.0%  3021 2313s
  3957  2841 36660.2839   20  444 25818.3086 36660.2839  42.0%  3080 2397s
  3973  2867 33170.0463   21  264 25818.3086 36660.2839  42.0%  3110 2438s
H 3985  2722                    25836.954608 36660.2839  41.9%  3139 2438s
H 3986  2588                    25860.796437 36660.2839  41.8%  3142 2438s
  4005  2726 33062.5916   22  258 25860.7964 36660.2839  41.8%  3185 2482s
  4152  2727 32687.9110   26  322 25860.7964 36660.2839  41.8%  3160 2505s
  4207  2751 32858.9703   25  259 25860.7964 36660.2839  41.8%  3150 2537s
  4260  2768 31290.1863   24  209 25860.7964 36660.2839  41.8%  3182 2557s
  4312  2799 32623.7435   27  316 25860.7964 36660.2839  41.8%  3216 2580s
  4378  2806 32087.4761   26  332 25860.7964 36660.2839  41.8%  3245 2600s
  4436  2803 31936.1703   26  232 25860.7964 36660.2839  41.8%  3270 2619s
  4469  2799 31627.8341   27  315 25860.7964 36660.2839  41.8%  3293 2648s
  4510  2794 31554.8556   28  316 25860.7964 36660.2839  41.8%  3320 2668s
  4562  2793 31136.9317   31  158 25860.7964 36660.2839  41.8%  3348 2700s
  4618  2795 30219.0437   33  233 25860.7964 36660.2839  41.8%  3376 2731s
  4673  2797 30377.6125   31  171 25860.7964 36660.2839  41.8%  3411 2754s
  4729  2795 30911.3978   33  156 25860.7964 36660.2839  41.8%  3421 2772s
  4781  2796 30079.0519   34  165 25860.7964 36660.2839  41.8%  3436 2802s
  4823  2801 29523.4533   37  143 25860.7964 36660.2839  41.8%  3449 2827s
  4879  2807 27175.8561   41  143 25860.7964 36660.2839  41.8%  3471 2856s
  4933  2807 28552.7084   40  127 25860.7964 36660.2839  41.8%  3510 2874s
  4983  2809 28268.1571   40  172 25860.7964 36660.2839  41.8%  3552 2899s
  5027  2815     cutoff   43      25860.7964 36660.2839  41.8%  3567 2928s
  5077  2832 infeasible   42      25860.7964 36650.1838  41.7%  3601 2960s
  5142  2829 33451.5507   22  364 25860.7964 36622.9673  41.6%  3643 2982s
  5215  2833 33376.9837   23  310 25860.7964 36622.9673  41.6%  3680 3006s
  5299  2853 32056.5575   25  305 25860.7964 36622.9673  41.6%  3717 3037s
  5406  2830 28936.5866   27  307 25860.7964 36622.9673  41.6%  3755 3067s
  5499  2839 26599.5669   30  250 25860.7964 36072.8605  39.5%  3813 3106s
  5617  2839 infeasible   33      25860.7964 36060.6534  39.4%  3851 3145s
  5713  2844 33335.7098   27  253 25860.7964 35699.5677  38.0%  3917 3176s
  5836  2825 27270.8610   29  174 25860.7964 35699.5677  38.0%  3950 3204s
  5874  2843 26338.5663   30  160 25860.7964 35579.5642  37.6%  3985 3231s
  5928  2837     cutoff   31      25860.7964 35579.5642  37.6%  4020 3257s
  5991  2845 26816.2662   30  251 25860.7964 35186.5234  36.1%  4055 3294s
  6052  2849     cutoff   31      25860.7964 35186.5234  36.1%  4083 3325s
  6135  2845     cutoff   32      25860.7964 35186.5234  36.1%  4106 3358s
H 6221  2689                    25920.534173 35183.7494  35.7%  4135 3358s
  6224  2724 27691.7387   27  233 25920.5342 35183.7494  35.7%  4138 3398s
  6406  2688 infeasible   29      25920.5342 35183.7494  35.7%  4181 3437s
  6541  2720 26588.1925   26  208 25920.5342 35183.7494  35.7%  4253 3479s
  6713  2705 infeasible   27      25920.5342 34450.2911  32.9%  4288 3519s
  6883  2698     cutoff   24      25920.5342 34361.0134  32.6%  4334 3564s
  7043  2701     cutoff   21      25920.5342 34340.8664  32.5%  4379 3600s

Cutting planes:
  MIR: 552
  Mixing: 1
  Flow cover: 2391
  RLT: 16
  Relax-and-lift: 207

Explored 7218 nodes (32150170 simplex iterations) in 3600.10 seconds (6335.68 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25920.5 25860.8 25837 ... 24691.2

Time limit reached
Best objective 2.592053417296e+04, best bound 3.426709359226e+04, gap 32.2006%
  WARNING: Time limit reached. Using best solution found (gap: 32.20%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 25920.53, θ = 171684.05
  Upper Bound (UB) = 25920.53

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171684.05
  [DEBUG]   ✓ Scenario 0: θ = 171684.05 ≤ Q = 171684.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 171684.05 ≤ Q = 171684.05 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2c54ad1d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2c54ad1d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.422119e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6919670.3373
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.595658e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159565.81    0  129 6919670.34 -159565.81   102%     -    0s
H    0     0                    -122245.1896 -159565.81  30.5%     -    0s
H    0     0                    -128224.0304 -159565.81  24.4%     -    0s
H    0     0                    -135723.0515 -159565.81  17.6%     -    0s
H    0     0                    -139424.5866 -141938.46  1.80%     -    0s
     0     0 -141938.46    0   61 -139424.59 -141938.46  1.80%     -    0s
     0     0 -141415.35    0   61 -139424.59 -141415.35  1.43%     -    0s
     0     0 -141409.76    0   61 -139424.59 -141409.76  1.42%     -    0s
H    0     0                    -139863.5817 -141409.38  1.11%     -    0s
     0     0 -141409.38    0   61 -139863.58 -141409.38  1.11%     -    0s
     0     0 -140476.37    0   31 -139863.58 -140476.37  0.44%     -    0s
H    0     0                    -140011.7033 -140438.08  0.30%     -    0s
H    0     0                    -140091.0649 -140332.82  0.17%     -    0s
     0     0 -140301.61    0   15 -140091.06 -140301.61  0.15%     -    0s
     0     0 -140293.47    0   21 -140091.06 -140293.47  0.14%     -    0s
     0     0 -140292.23    0   21 -140091.06 -140292.23  0.14%     -    0s
H    0     0                    -140193.1319 -140292.23  0.07%     -    0s
     0     0 -140214.20    0    9 -140193.13 -140214.20  0.02%     -    0s
     0     0 -140198.93    0    5 -140193.13 -140198.93  0.00%     -    0s
     0     0 -140196.49    0    4 -140193.13 -140196.49  0.00%     -    0s
     0     0 -140194.36    0    2 -140193.13 -140194.36  0.00%     -    0s

Explored 1 nodes (618 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -140193 -140096 -140091 ... 6.91967e+06
No other solutions better than -140193

Optimal solution found (tolerance 1.00e-06)
Best objective -1.401931318665e+05, best bound -1.401931318665e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 158954.68
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140193.13
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -140193.13 = 158954.68
  [DEBUG]   Current θ from Master = 171684.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12729.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13191.16
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 1066.8522, Absolute Gap = 1066.8522, Relative Gap = 0.041159
  Not converged yet (gap = 1066.85 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x44b69860
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 78110 rows and 31740 columns
Presolve time: 2.56s
Presolved: 91463 rows, 39160 columns, 556391 nonzeros
Variable types: 36901 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346407.4889
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 637
 AA' NZ     : 3.028e+06
 Factor NZ  : 7.076e+06 (roughly 100 MB of memory)
 Factor Ops : 1.289e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82781964e+07  1.79680526e+08  1.13e+05 2.07e+01  8.22e+04     4s
   1  -1.37374647e+07  1.58498983e+08  7.82e+04 7.95e+01  5.63e+04     4s
   2  -4.40039159e+06  1.21147532e+08  2.48e+04 9.47e-01  1.90e+04     4s
   3  -1.01003563e+06  8.45750095e+07  2.89e+03 1.49e+00  2.57e+03     4s
   4  -5.28473256e+05  4.84570603e+07  4.90e+02 4.68e-01  6.09e+02     5s
   5  -4.22137998e+05  2.53801645e+07  1.95e+02 1.96e-01  2.65e+02     5s
   6  -3.09010040e+05  1.85129191e+07  6.71e+01 1.31e-01  1.47e+02     5s
   7  -1.68618150e+05  1.30153932e+07  1.37e+01 8.65e-02  8.44e+01     5s
   8  -1.08075481e+05  6.29186801e+06  6.95e+00 3.95e-02  3.98e+01     5s
   9  -7.06119271e+04  2.44048013e+06  2.55e+00 1.44e-02  1.52e+01     5s
  10  -4.31242161e+04  1.01828895e+06  1.07e+00 5.74e-03  6.38e+00     5s
  11  -2.12012191e+04  4.78534281e+05  6.24e-01 2.53e-03  2.99e+00     5s
  12  -7.36658500e+03  2.97615525e+05  4.16e-01 1.55e-03  1.82e+00     5s
  13   5.54917025e+02  2.02372685e+05  3.15e-01 1.06e-03  1.21e+00     5s
  14   7.60057293e+03  1.38224071e+05  2.55e-01 2.55e-03  7.81e-01     5s
  15   1.49931096e+04  1.16064531e+05  2.06e-01 1.81e-03  6.04e-01     5s
  16   2.15407689e+04  9.73736623e+04  1.66e-01 1.60e-03  4.53e-01     6s
  17   2.74447513e+04  8.70462543e+04  1.33e-01 1.82e-03  3.56e-01     6s
  18   3.19387475e+04  7.56731888e+04  1.08e-01 1.83e-03  2.61e-01     6s
  19   3.57466628e+04  6.89466195e+04  8.76e-02 1.99e-03  1.98e-01     6s
  20   3.91851092e+04  6.44635256e+04  6.92e-02 1.76e-03  1.51e-01     6s
  21   4.09039642e+04  6.13335766e+04  6.05e-02 2.03e-03  1.22e-01     6s
  22   4.37969553e+04  5.99422837e+04  4.59e-02 1.88e-03  9.65e-02     6s
  23   4.47289902e+04  5.79909621e+04  4.12e-02 2.70e-03  7.93e-02     6s
  24   4.64214759e+04  5.68645226e+04  3.30e-02 1.90e-03  6.24e-02     6s
  25   4.73966417e+04  5.64807158e+04  2.85e-02 1.74e-03  5.43e-02     6s
  26   4.82471312e+04  5.57818409e+04  2.46e-02 1.36e-03  4.51e-02     6s
  27   4.90740031e+04  5.52876900e+04  2.07e-02 1.02e-03  3.72e-02     7s
  28   5.02008593e+04  5.50787692e+04  1.56e-02 8.83e-04  2.92e-02     7s
  29   5.05371213e+04  5.48157508e+04  1.40e-02 7.10e-04  2.56e-02     7s
  30   5.08550763e+04  5.45643624e+04  1.25e-02 5.47e-04  2.22e-02     7s
  31   5.11634749e+04  5.43917727e+04  1.10e-02 4.45e-04  1.93e-02     7s
  32   5.16096078e+04  5.42925890e+04  8.94e-03 3.88e-04  1.60e-02     7s
  33   5.18513864e+04  5.41127074e+04  7.81e-03 2.86e-04  1.35e-02     7s
  34   5.21614362e+04  5.39723002e+04  6.43e-03 2.45e-04  1.08e-02     7s
  35   5.23732807e+04  5.38740568e+04  5.45e-03 1.76e-04  8.98e-03     7s
  36   5.26997423e+04  5.37923044e+04  3.98e-03 1.17e-04  6.54e-03     8s
  37   5.30031823e+04  5.37350019e+04  2.62e-03 7.86e-05  4.38e-03     8s
  38   5.33158660e+04  5.36701946e+04  1.19e-03 3.38e-05  2.12e-03     8s
  39   5.34472100e+04  5.36565100e+04  6.56e-04 4.59e-05  1.25e-03     8s
  40   5.34693261e+04  5.36292327e+04  5.66e-04 1.80e-05  9.56e-04     8s
  41   5.35720692e+04  5.36176304e+04  1.42e-04 7.66e-06  2.72e-04     8s
  42   5.35972550e+04  5.36112829e+04  4.04e-05 2.00e-06  8.38e-05     8s
  43   5.36087357e+04  5.36093777e+04  1.52e-06 1.15e-06  3.84e-06     8s
  44   5.36092265e+04  5.36092266e+04  5.70e-10 2.76e-09  3.26e-10     8s

Barrier solved model in 44 iterations and 8.39 seconds (7.09 work units)
Optimal objective 5.36092265e+04


Root crossover log...

   81906 DPushes remaining with DInf 0.0000000e+00                 8s
    8590 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    2605 PPushes remaining with PInf 3.0054478e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.0754797e-03     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38918    5.3609227e+04   0.000000e+00   6.075480e-03     11s
   38920    5.3609227e+04   0.000000e+00   0.000000e+00     11s
   38920    5.3609227e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.360923e+04, 38920 iterations, 8.12 seconds (8.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53609.2266    0  138 -239613.87 53609.2266   122%     -   11s
H    0     0                    -234851.8166 53609.2266   123%     -   11s
H    0     0                    -185991.5006 53609.2266   129%     -   12s
H    0     0                    -165787.9208 53609.2266   132%     -   12s
H    0     0                    -152612.3756 53609.2266   135%     -   13s
H    0     0                    -151400.9993 53609.2266   135%     -   13s
H    0     0                    -149856.9012 53609.2266   136%     -   13s
H    0     0                    -149450.2942 53609.2266   136%     -   13s
H    0     0                    -56925.01676 53609.2266   194%     -   13s
H    0     0                    -56751.24811 53609.2266   194%     -   13s
H    0     0                    -21467.74757 53609.2266   350%     -   13s
H    0     0                    14790.355777 53609.2266   262%     -   13s
H    0     0                    15754.335197 53609.2266   240%     -   13s
H    0     0                    16534.399563 53609.2266   224%     -   14s
H    0     0                    16930.611306 53609.2266   217%     -   14s
H    0     0                    17063.987304 48778.4471   186%     -   47s
H    0     0                    17065.712792 48778.4471   186%     -   47s
     0     0 48760.6764    0  280 17065.7128 48760.6764   186%     -   47s
     0     0 47850.1821    0  284 17065.7128 47850.1821   180%     -   68s
     0     0 47850.1821    0  290 17065.7128 47850.1821   180%     -   71s
     0     0 47850.1821    0  283 17065.7128 47850.1821   180%     -   73s
     0     0 47850.1821    0  283 17065.7128 47850.1821   180%     -   73s
H    0     0                    18505.308549 44509.3029   141%     -  100s
H    0     0                    18515.454739 44509.3029   140%     -  100s
H    0     0                    18564.703619 44509.3029   140%     -  100s
H    0     0                    18567.170671 44509.3029   140%     -  100s
     0     0 44509.3029    0  275 18567.1707 44509.3029   140%     -  101s
H    0     0                    21979.941400 44509.1638   102%     -  101s
     0     0 44160.3651    0  279 21979.9414 44160.3651   101%     -  113s
     0     0 44087.2817    0  281 21979.9414 44087.2817   101%     -  123s
     0     0 44029.3642    0  291 21979.9414 44029.3642   100%     -  129s
     0     0 43987.2180    0  280 21979.9414 43987.2180   100%     -  136s
     0     0 43959.8133    0  318 21979.9414 43959.8133   100%     -  142s
     0     0 43943.5420    0  286 21979.9414 43943.5420   100%     -  149s
     0     0 43855.1485    0  276 21979.9414 43855.1485   100%     -  155s
     0     0 43755.2441    0  322 21979.9414 43755.2441  99.1%     -  162s
     0     0 43749.3660    0  327 21979.9414 43749.3660  99.0%     -  165s
     0     0 43702.6427    0  332 21979.9414 43702.6427  98.8%     -  170s
     0     0 43689.2867    0  340 21979.9414 43689.2867  98.8%     -  173s
     0     0 43685.3747    0  343 21979.9414 43685.3747  98.8%     -  175s
     0     0 43685.1197    0  345 21979.9414 43685.1197  98.7%     -  176s
H    0     0                    22121.059279 41626.1491  88.2%     -  219s
     0     0 41626.1491    0  318 22121.0593 41626.1491  88.2%     -  219s
H    0     0                    22512.133152 41625.7657  84.9%     -  219s
H    0     0                    22624.679386 41625.7657  84.0%     -  220s
H    0     0                    22946.096482 41625.7657  81.4%     -  220s
     0     0 41182.9921    0  344 22946.0965 41182.9921  79.5%     -  233s
     0     0 40976.0882    0  349 22946.0965 40976.0882  78.6%     -  243s
     0     0 40902.7173    0  338 22946.0965 40902.7173  78.3%     -  250s
     0     0 40880.4039    0  346 22946.0965 40880.4039  78.2%     -  255s
     0     0 40856.9485    0  358 22946.0965 40856.9485  78.1%     -  260s
     0     0 40842.3172    0  361 22946.0965 40842.3172  78.0%     -  263s
     0     0 40830.3425    0  359 22946.0965 40830.3425  77.9%     -  265s
     0     0 40804.5000    0  360 22946.0965 40804.5000  77.8%     -  269s
     0     0 40789.8146    0  361 22946.0965 40789.8146  77.8%     -  271s
     0     0 40786.4228    0  356 22946.0965 40786.4228  77.7%     -  273s
     0     0 40784.0753    0  364 22946.0965 40784.0753  77.7%     -  274s
     0     0 40782.0708    0  362 22946.0965 40782.0708  77.7%     -  275s
     0     0 40782.0427    0  362 22946.0965 40782.0427  77.7%     -  275s
H    0     0                    23368.579122 39937.5193  70.9%     -  309s
H    0     0                    23369.010385 39937.5193  70.9%     -  309s
H    0     0                    23387.271522 39937.5193  70.8%     -  309s
H    0     0                    23523.793501 39937.5193  69.8%     -  309s
     0     0 39937.5193    0  352 23523.7935 39937.5193  69.8%     -  309s
H    0     0                    23577.687772 39937.4536  69.4%     -  309s
H    0     0                    25002.416800 39732.6117  58.9%     -  322s
     0     0 39732.6117    0  405 25002.4168 39732.6117  58.9%     -  322s
     0     0 39597.8641    0  376 25002.4168 39597.8641  58.4%     -  331s
     0     0 39424.9618    0  408 25002.4168 39424.9618  57.7%     -  342s
     0     0 39385.4117    0  400 25002.4168 39385.4117  57.5%     -  347s
     0     0 39330.9235    0  412 25002.4168 39330.9235  57.3%     -  353s
     0     0 39314.5683    0  421 25002.4168 39314.5683  57.2%     -  358s
     0     0 39306.5492    0  419 25002.4168 39306.5492  57.2%     -  361s
     0     0 39299.6286    0  430 25002.4168 39299.6286  57.2%     -  363s
     0     0 39291.6513    0  433 25002.4168 39291.6513  57.2%     -  366s
     0     0 39286.5100    0  428 25002.4168 39286.5100  57.1%     -  368s
     0     0 39282.6677    0  427 25002.4168 39282.6677  57.1%     -  369s
     0     0 39282.0289    0  428 25002.4168 39282.0289  57.1%     -  370s
H    0     0                    25298.719588 39089.6261  54.5%     -  380s
     0     0 39089.6261    0  441 25298.7196 39089.6261  54.5%     -  381s
     0     0 39020.1703    0  388 25298.7196 39020.1703  54.2%     -  386s
     0     0 38984.1087    0  430 25298.7196 38984.1087  54.1%     -  391s
     0     0 38950.3887    0  391 25298.7196 38950.3887  54.0%     -  395s
     0     0 38945.8546    0  398 25298.7196 38945.8546  53.9%     -  397s
     0     0 38932.9805    0  391 25298.7196 38932.9805  53.9%     -  399s
     0     0 38928.1312    0  389 25298.7196 38928.1312  53.9%     -  402s
     0     0 38925.1114    0  394 25298.7196 38925.1114  53.9%     -  403s
     0     0 38923.8940    0  389 25298.7196 38923.8940  53.9%     -  404s
     0     0 38872.9783    0  394 25298.7196 38872.9783  53.7%     -  411s
     0     0 38862.8103    0  436 25298.7196 38862.8103  53.6%     -  416s
     0     0 38856.5165    0  449 25298.7196 38856.5165  53.6%     -  418s
     0     0 38827.1625    0  398 25298.7196 38827.1625  53.5%     -  420s
     0     0 38817.2479    0  404 25298.7196 38817.2479  53.4%     -  422s
     0     0 38816.7426    0  409 25298.7196 38816.7426  53.4%     -  423s
     0     0 38772.6684    0  430 25298.7196 38772.6684  53.3%     -  430s
     0     0 38767.5544    0  395 25298.7196 38767.5544  53.2%     -  433s
     0     0 38762.6992    0  398 25298.7196 38762.6992  53.2%     -  435s
     0     0 38757.3175    0  391 25298.7196 38757.3175  53.2%     -  438s
     0     0 38753.9955    0  401 25298.7196 38753.9955  53.2%     -  440s
     0     0 38752.4662    0  395 25298.7196 38752.4662  53.2%     -  442s
     0     0 38736.5185    0  417 25298.7196 38736.5185  53.1%     -  447s
H    0     0                    25439.824327 38735.7684  52.3%     -  448s
     0     0 38728.9204    0  410 25439.8243 38728.9204  52.2%     -  451s
     0     0 38725.4658    0  407 25439.8243 38725.4658  52.2%     -  452s
     0     0 38721.6939    0  415 25439.8243 38721.6939  52.2%     -  455s
     0     0 38719.5064    0  410 25439.8243 38719.5064  52.2%     -  456s
     0     0 38717.9711    0  422 25439.8243 38717.9711  52.2%     -  457s
     0     0 38707.1368    0  402 25439.8243 38707.1368  52.2%     -  463s
H    0     0                    25456.634967 38706.8712  52.1%     -  464s
     0     0 38704.5263    0  407 25456.6350 38704.5263  52.0%     -  466s
     0     0 38703.1944    0  461 25456.6350 38703.1944  52.0%     -  468s
     0     0 38678.6902    0  406 25456.6350 38678.6902  51.9%     -  473s
     0     0 38667.1778    0  456 25456.6350 38667.1778  51.9%     -  478s
     0     0 38664.1463    0  465 25456.6350 38664.1463  51.9%     -  480s
     0     0 38663.3590    0  461 25456.6350 38663.3590  51.9%     -  481s
     0     0 38650.2480    0  413 25456.6350 38650.2480  51.8%     -  485s
     0     0 38645.7429    0  406 25456.6350 38645.7429  51.8%     -  488s
     0     0 38642.8165    0  409 25456.6350 38642.8165  51.8%     -  490s
     0     0 38639.6671    0  414 25456.6350 38639.6671  51.8%     -  492s
     0     0 38638.3819    0  415 25456.6350 38638.3819  51.8%     -  493s
     0     0 38632.7501    0  397 25456.6350 38632.7501  51.8%     -  497s
     0     0 38629.7510    0  456 25456.6350 38629.7510  51.7%     -  499s
     0     0 38628.1758    0  410 25456.6350 38628.1758  51.7%     -  501s
     0     0 38615.7646    0  458 25456.6350 38615.7646  51.7%     -  504s
     0     0 38593.8779    0  407 25456.6350 38593.8779  51.6%     -  511s
     0     0 38582.9200    0  402 25456.6350 38582.9200  51.6%     -  513s
     0     0 38580.7285    0  409 25456.6350 38580.7285  51.6%     -  515s
     0     0 38579.3605    0  411 25456.6350 38579.3605  51.5%     -  516s
     0     0 38576.0099    0  412 25456.6350 38576.0099  51.5%     -  520s
H    0     0                    25479.407184 38575.9545  51.4%     -  554s
H    0     0                    25496.217824 38575.9545  51.3%     -  556s
     0     0 38574.9635    0  418 25496.2178 38574.9635  51.3%     -  557s
     0     0 38573.2316    0  421 25496.2178 38573.2316  51.3%     -  559s
     0     0 38571.6904    0  418 25496.2178 38571.6904  51.3%     -  561s
     0     0 38570.3544    0  416 25496.2178 38570.3544  51.3%     -  563s
     0     0 38569.5567    0  410 25496.2178 38569.5567  51.3%     -  564s
     0     0 38569.0783    0  416 25496.2178 38569.0783  51.3%     -  566s
     0     0 38568.5964    0  416 25496.2178 38568.5964  51.3%     -  570s
H    0     0                    25627.911616 38568.5244  50.5%     -  675s
H    0     0                    25683.577883 38568.5244  50.2%     -  675s
     0     2 38568.5244    0  416 25683.5779 38568.5244  50.2%     -  677s
     1     3 37971.2458    1  455 25683.5779 38567.8431  50.2%  9460  692s
     2     4 38394.9519    1  397 25683.5779 38394.9519  49.5%  6407  704s
     3     8 37873.5887    2  404 25683.5779 38394.7859  49.5%  7966  718s
     7    16 37546.4389    3  388 25683.5779 38284.3927  49.1%  6031  748s
    15    32 37174.6829    4  383 25683.5779 37898.1528  47.6%  9441  773s
    31    48 36887.3354    5  394 25683.5779 37598.0425  46.4% 13783  827s
    47    80 36481.9661    6  375 25683.5779 37598.0425  46.4% 13147  852s
    79   182 36450.2480    7  368 25683.5779 37598.0425  46.4% 10947  886s
   181   214 36049.6001   12  357 25683.5779 37598.0425  46.4%  7577  900s
   213   245 35892.6654   13  362 25683.5779 37598.0425  46.4%  6922  916s
H  216   245                    25684.964064 37598.0425  46.4%  6884  916s
   246   293 35545.2723   12  359 25684.9641 37598.0425  46.4%  6570  943s
   302   339 35537.2671   14  364 25684.9641 37598.0425  46.4%  5957  969s
H  306   339                    25684.970397 37598.0425  46.4%  5914  969s
   362   408 35518.3063   15  358 25684.9704 37598.0425  46.4%  5546  991s
   440   483 35241.5414   18  365 25684.9704 37598.0425  46.4%  5091 1012s
   519   516 34695.2101   20  329 25684.9704 37598.0425  46.4%  4754 1035s
   566   549 34197.4619   21  277 25684.9704 37598.0425  46.4%  4631 1057s
   618   610 34100.6883   22  323 25684.9704 37598.0425  46.4%  4523 1076s
   687   664 34062.6594   23  327 25684.9704 37598.0425  46.4%  4396 1096s
   747   719 33951.1079   24  317 25684.9704 37598.0425  46.4%  4288 1114s
   814   801 33876.3932   25  328 25684.9704 37598.0425  46.4%  4175 1133s
   907   854 33380.2671   26  297 25684.9704 37598.0425  46.4%  3943 1152s
   984   920 33272.2634   27  238 25684.9704 37598.0425  46.4%  3789 1176s
  1082   963 32870.7404   29  230 25684.9704 37598.0425  46.4%  3632 1195s
H 1132   963                    25699.798210 37598.0425  46.3%  3590 1195s
  1155  1025 32401.8611   31  329 25699.7982 37598.0425  46.3%  3561 1218s
  1239  1081 32355.6040   32  335 25699.7982 37598.0425  46.3%  3506 1240s
  1349  1139 31146.8124   34  303 25699.7982 37598.0425  46.3%  3420 1264s
  1445  1197 31072.6372   35  333 25699.7982 37598.0425  46.3%  3352 1286s
  1552  1273 30646.7722   39  166 25699.7982 37598.0425  46.3%  3297 1315s
  1682  1330 29728.9940   43  210 25699.7982 37598.0425  46.3%  3190 1342s
  1782  1353 29041.4743   45  163 25699.7982 37598.0425  46.3%  3162 1368s
  1863  1371 29004.1495   46  159 25699.7982 37598.0425  46.3%  3124 1397s
H 1947  1371                    25836.954608 37229.8265  44.1%  3095 1397s
  1955  1389 28722.3303   47  161 25836.9546 37229.8265  44.1%  3096 1423s
  1991  1411 28365.4114   48  330 25836.9546 37229.8265  44.1%  3117 1452s
  2031  1433 28200.7692   49  332 25836.9546 37229.8265  44.1%  3160 1482s
  2069  1455 28191.3602   50  330 25836.9546 37229.8265  44.1%  3203 1505s
  2105  1480 28155.0470   51  164 25836.9546 37229.8265  44.1%  3223 1534s
  2142  1509 28130.0676   52  165 25836.9546 36939.1873  43.0%  3251 1559s
  2177  1543 27913.7115   53  125 25836.9546 36939.1873  43.0%  3280 1585s
  2213  1592 27858.1933   54   88 25836.9546 36939.1873  43.0%  3305 1609s
  2291  1628     cutoff   65      25836.9546 36832.6935  42.6%  3285 1641s
  2367  1665 35918.3308    6  379 25836.9546 36832.6935  42.6%  3280 1675s
  2433  1711 35205.5865    8  362 25836.9546 36832.6935  42.6%  3324 1710s
  2511  1786 34936.1976   10  391 25836.9546 36832.6935  42.6%  3351 1744s
  2602  1834 33565.5112   13  311 25836.9546 36832.6935  42.6%  3371 1777s
  2696  1918 31868.1376   16  223 25836.9546 36832.6935  42.6%  3381 1817s
  2814  1976 31115.6402   19  232 25836.9546 36762.1179  42.3%  3399 1857s
  2930  2081 30880.1906   22  247 25836.9546 36579.8281  41.6%  3396 1903s
  3090  2193 29812.2428   27  197 25836.9546 36579.8281  41.6%  3389 1948s
  3281  2254 26989.7127   30  143 25836.9546 36565.7111  41.5%  3367 1987s
  3414  2318 26466.9895   39  133 25836.9546 36386.0090  40.8%  3342 2033s
  3534  2401 34115.6655   10  340 25836.9546 36386.0090  40.8%  3370 2086s
  3682  2528 32895.3274   13  267 25836.9546 36386.0090  40.8%  3406 2142s
  3892  2630 30855.7484   17  333 25836.9546 36342.2929  40.7%  3413 2197s
  4090  2761 29527.2289   21  253 25836.9546 36180.2132  40.0%  3426 2255s
  4313  2762 35006.0541   10  416 25836.9546 36180.2132  40.0%  3424 2595s
  4315  2763 34070.3250   10  120 25836.9546 36180.2132  40.0%  3422 2610s
  4316  2764 32515.7493   32  284 25836.9546 36180.2132  40.0%  3421 2664s
  4317  2765 31644.1897   24  336 25836.9546 36180.2132  40.0%  3420 2704s
  4318  2765 34496.4233   10  403 25836.9546 36180.2132  40.0%  3420 2731s
  4319  2766 34897.9285    9  388 25836.9546 36180.2132  40.0%  3419 2756s
  4320  2767 32042.7165   21  429 25836.9546 36180.2132  40.0%  3418 2771s
  4321  2767 28724.1400   42  440 25836.9546 36180.2132  40.0%  3417 2779s
  4322  2768 29283.5456   35  392 25836.9546 36180.2132  40.0%  3416 2789s
  4323  2769 32238.0785   15  460 25836.9546 36180.2132  40.0%  3416 2797s
  4324  2769 34336.6683   13  380 25836.9546 36180.2132  40.0%  3415 2806s
  4325  2770 35776.1985   12  446 25836.9546 36180.2132  40.0%  3414 2812s
  4326  2771 27203.2753   57  456 25836.9546 36180.2132  40.0%  3413 2817s
  4327  2771 25894.4864   54  447 25836.9546 36180.2132  40.0%  3412 2823s
  4328  2772 34557.6335   14  402 25836.9546 36180.2132  40.0%  3412 2827s
  4329  2773 35630.0755    8  406 25836.9546 36180.2132  40.0%  3411 2831s
  4330  2773 29112.3024   17  454 25836.9546 36180.2132  40.0%  3410 2847s
  4331  2774 32817.6713   12  460 25836.9546 36180.2132  40.0%  3409 2852s
  4332  2775 35631.2444    9  457 25836.9546 36180.2132  40.0%  3409 2857s
  4333  2775 30151.5940   27  459 25836.9546 36180.2132  40.0%  3408 2870s
  4335  2777 28363.8300   19  457 25836.9546 36180.2132  40.0%  3406 2876s
  4337  2778 35513.2021    9  398 25836.9546 36180.2132  40.0%  3405 2883s
  4338  2779 32778.5289   13  455 25836.9546 36180.2132  40.0%  3404 2895s
  4340  2780 31223.4262   15  457 25836.9546 36180.2132  40.0%  3402 2909s
  4341  2781 27156.4854   57  455 25836.9546 36180.2132  40.0%  3401 2914s
  4342  2781 35652.5680   12  380 25836.9546 36180.2132  40.0%  3401 2928s
  4343  2782 31934.7031   31  441 25836.9546 36180.2132  40.0%  3400 2933s
  4344  2783 31387.7327   24  440 25836.9546 36180.2132  40.0%  3399 2938s
  4345  2783 31244.1167   18  387 25836.9546 36180.2132  40.0%  3398 2948s
  4346  2784 33884.9620   15  444 25836.9546 36180.2132  40.0%  3398 2954s
  4347  2785 28929.9756   31  454 25836.9546 36180.2132  40.0%  3397 2965s
  4348  2785 34179.2179   20  444 25836.9546 36180.2132  40.0%  3396 2971s
  4349  2786 28126.5100   32  457 25836.9546 36180.2132  40.0%  3395 2980s
  4351  2787 26628.2392   53  503 25836.9546 36180.2132  40.0%  3394 2990s
  4352  2788 31710.2246   14  456 25836.9546 36180.2132  40.0%  3393 2998s
  4353  2789 29732.6919   20  456 25836.9546 36180.2132  40.0%  3392 3019s
  4354  2789 28436.1629   17  456 25836.9546 36180.2132  40.0%  3391 3098s
  4355  2793 36180.2132   16  436 25836.9546 36180.2132  40.0%  3454 3214s
  4357  2796 36180.2132   17  435 25836.9546 36180.2132  40.0%  3456 3309s
  4361  2803 36180.2132   18  428 25836.9546 36180.2132  40.0%  3465 3372s
  4369  2816 36180.2132   19  436 25836.9546 36180.2132  40.0%  3483 3421s
  4385  2826 35167.4289   20  390 25836.9546 36180.2132  40.0%  3545 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 6
  Projected implied bound: 1
  MIR: 325
  Mixing: 1
  Flow cover: 1494
  RLT: 5
  Relax-and-lift: 198

Explored 4400 nodes (16347832 simplex iterations) in 3600.07 seconds (5640.72 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25837 25699.8 25685 ... 25439.8

Time limit reached
Best objective 2.583695460769e+04, best bound 3.618021316986e+04, gap 40.0328%
  WARNING: Time limit reached. Using best solution found (gap: 40.03%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 25836.95, θ = 173322.14
  Upper Bound (UB) = 25836.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173322.14
  [DEBUG]   ✓ Scenario 0: θ = 173322.14 ≤ Q = 173322.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173322.14 ≤ Q = 173322.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173322.14 ≤ Q = 173322.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173322.14 ≤ Q = 173322.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173322.14 ≤ Q = 173322.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173322.14 ≤ Q = 173322.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173322.14 ≤ Q = 173322.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173322.14 ≤ Q = 173322.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173322.14 ≤ Q = 173322.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173322.14 ≤ Q = 173322.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 173322.14 ≤ Q = 173322.14 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x74722db9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8b8dd247
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.436994e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6973926.7168
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.565941e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156594.15    0  124 6973926.72 -156594.15   102%     -    0s
H    0     0                    -121474.9710 -156594.15  28.9%     -    0s
H    0     0                    -121720.3670 -156594.15  28.7%     -    0s
     0     0 -136256.43    0   70 -121720.37 -136256.43  11.9%     -    0s
H    0     0                    -132610.9147 -136115.79  2.64%     -    0s
     0     0 -135440.45    0   66 -132610.91 -135440.45  2.13%     -    0s
H    0     0                    -134082.6735 -135360.29  0.95%     -    0s
     0     0 -134943.87    0   49 -134082.67 -134943.87  0.64%     -    0s
H    0     0                    -134107.0539 -134896.71  0.59%     -    0s
     0     0 -134746.26    0   39 -134107.05 -134746.26  0.48%     -    0s
     0     0 -134712.86    0   41 -134107.05 -134712.86  0.45%     -    0s
     0     0 -134711.43    0   43 -134107.05 -134711.43  0.45%     -    0s
     0     0 -134496.94    0   30 -134107.05 -134496.94  0.29%     -    0s
H    0     0                    -134135.1618 -134488.46  0.26%     -    0s
     0     0 -134479.48    0   36 -134135.16 -134479.48  0.26%     -    0s
     0     0 -134378.46    0   19 -134135.16 -134378.46  0.18%     -    0s
H    0     0                    -134164.7969 -134357.68  0.14%     -    0s
     0     0 -134357.68    0   25 -134164.80 -134357.68  0.14%     -    0s
     0     0 -134312.33    0   11 -134164.80 -134312.33  0.11%     -    0s
     0     0 -134312.33    0   17 -134164.80 -134312.33  0.11%     -    0s
     0     0 -134227.40    0    7 -134164.80 -134227.40  0.05%     -    0s
H    0     0                    -134165.6955 -134224.59  0.04%     -    0s
H    0     0                    -134187.9322 -134224.59  0.03%     -    0s
H    0     0                    -134207.7482 -134224.59  0.01%     -    0s
     0     0 -134223.44    0    7 -134207.75 -134223.44  0.01%     -    0s
     0     0 -134215.29    0    5 -134207.75 -134215.29  0.01%     -    0s
     0     0 -134215.26    0    5 -134207.75 -134215.26  0.01%     -    0s
H    0     0                    -134212.8331 -134215.26  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 10
  Flow cover: 3
  Relax-and-lift: 6

Explored 1 nodes (829 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -134213 -134208 -134188 ... -121720
No other solutions better than -134213

Optimal solution found (tolerance 1.00e-06)
Best objective -1.342128331010e+05, best bound -1.342128331010e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 164934.98
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134212.83
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -134212.83 = 164934.98
  [DEBUG]   Current θ from Master = 173322.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8387.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17449.80
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 983.2727, Absolute Gap = 983.2727, Relative Gap = 0.038057
  Not converged yet (gap = 983.27 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x35acf21e
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 85200 rows and 34620 columns
Presolve time: 3.86s
Presolved: 99663 rows, 42520 columns, 606161 nonzeros
Variable types: 40261 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -347810.0461
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 Dense cols : 638
 AA' NZ     : 3.493e+06
 Factor NZ  : 8.192e+06 (roughly 120 MB of memory)
 Factor Ops : 1.558e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82802924e+07  1.94026878e+08  1.13e+05 1.94e+01  8.18e+04     6s
   1  -1.37662565e+07  1.71087223e+08  7.83e+04 7.63e+01  5.61e+04     6s
   2  -4.46247190e+06  1.31083886e+08  2.51e+04 6.00e-01  1.91e+04     6s
   3  -1.04990399e+06  9.20343988e+07  2.97e+03 1.29e+00  2.62e+03     6s
   4  -5.54718415e+05  5.33080305e+07  5.66e+02 4.55e-01  6.65e+02     6s
   5  -4.59295241e+05  3.37010713e+07  2.85e+02 2.43e-01  3.56e+02     6s
   6  -3.46375195e+05  2.35142304e+07  8.59e+01 1.56e-01  1.77e+02     6s
   7  -2.61499585e+05  1.70161237e+07  3.91e+01 1.08e-01  1.13e+02     6s
   8  -1.35509187e+05  1.22690164e+07  9.72e+00 7.42e-02  7.15e+01     6s
   9  -8.56830189e+04  5.43274392e+06  4.15e+00 3.11e-02  3.10e+01     6s
  10  -7.00036969e+04  2.03390095e+06  2.92e+00 1.12e-02  1.18e+01     6s
  11  -4.59489613e+04  1.41110803e+06  1.69e+00 7.64e-03  8.07e+00     7s
  12  -1.85925121e+04  8.01633037e+05  8.76e-01 4.21e-03  4.52e+00     7s
  13  -9.81266437e+03  4.84000344e+05  6.43e-01 2.79e-03  2.72e+00     7s
  14   4.19790910e+03  2.13977905e+05  3.16e-01 1.24e-03  1.15e+00     7s
  15   1.04497684e+04  1.65241365e+05  2.55e-01 1.20e-03  8.50e-01     7s
  16   1.83190179e+04  1.25492681e+05  1.92e-01 1.23e-03  5.88e-01     7s
  17   2.25777279e+04  1.07983807e+05  1.64e-01 1.48e-03  4.69e-01     7s
  18   2.84611738e+04  9.45268891e+04  1.28e-01 1.49e-03  3.63e-01     7s
  19   3.56216923e+04  7.88022616e+04  8.80e-02 1.58e-03  2.37e-01     7s
  20   3.71201616e+04  7.29955092e+04  8.00e-02 1.12e-03  1.97e-01     7s
  21   3.96384589e+04  6.84433564e+04  6.70e-02 1.20e-03  1.58e-01     7s
  22   4.27279487e+04  6.48203796e+04  5.14e-02 1.66e-03  1.21e-01     7s
  23   4.39953258e+04  6.26740061e+04  4.52e-02 1.54e-03  1.03e-01     7s
  24   4.64156624e+04  6.15577717e+04  3.35e-02 1.36e-03  8.31e-02     8s
  25   4.70929540e+04  5.98271582e+04  3.02e-02 1.07e-03  6.99e-02     8s
  26   4.80576258e+04  5.86912694e+04  2.56e-02 9.98e-04  5.84e-02     8s
  27   4.92944924e+04  5.72083823e+04  1.98e-02 7.81e-04  4.34e-02     8s
  28   5.02143952e+04  5.67095016e+04  1.56e-02 6.71e-04  3.56e-02     8s
  29   5.05473864e+04  5.56286223e+04  1.42e-02 4.23e-04  2.79e-02     8s
  30   5.10560132e+04  5.55257742e+04  1.20e-02 3.97e-04  2.45e-02     8s
  31   5.13922746e+04  5.53007630e+04  1.06e-02 4.15e-04  2.15e-02     8s
  32   5.18346547e+04  5.49806926e+04  8.76e-03 3.27e-04  1.73e-02     8s
  33   5.21809322e+04  5.49012346e+04  7.34e-03 3.00e-04  1.49e-02     8s
  34   5.23414997e+04  5.47109054e+04  6.65e-03 3.26e-04  1.30e-02     9s
  35   5.23958368e+04  5.46836215e+04  6.42e-03 3.15e-04  1.26e-02     9s
  36   5.24286691e+04  5.46076746e+04  6.28e-03 2.79e-04  1.20e-02     9s
  37   5.25955686e+04  5.44695736e+04  5.59e-03 2.18e-04  1.03e-02     9s
  38   5.27363601e+04  5.43652077e+04  4.97e-03 1.74e-04  8.95e-03     9s
  39   5.28322888e+04  5.43156932e+04  4.57e-03 1.37e-04  8.15e-03     9s
  40   5.30507223e+04  5.42955216e+04  3.66e-03 1.29e-04  6.84e-03     9s
  41   5.31261349e+04  5.41940525e+04  3.33e-03 8.56e-05  5.87e-03     9s
  42   5.33072526e+04  5.41443772e+04  2.56e-03 9.10e-05  4.60e-03     9s
  43   5.33553718e+04  5.41227483e+04  2.37e-03 8.17e-05  4.21e-03    10s
  44   5.33779786e+04  5.41059054e+04  2.27e-03 6.97e-05  4.00e-03    10s
  45   5.34374323e+04  5.40411426e+04  2.03e-03 4.04e-05  3.32e-03    10s
  46   5.35830536e+04  5.39968540e+04  1.42e-03 2.50e-05  2.27e-03    10s
  47   5.36933313e+04  5.39743716e+04  9.53e-04 2.42e-05  1.54e-03    10s
  48   5.37059184e+04  5.39596458e+04  8.91e-04 1.61e-05  1.39e-03    10s
  49   5.37549428e+04  5.39540257e+04  6.87e-04 1.31e-05  1.09e-03    10s
  50   5.37980489e+04  5.39517005e+04  5.17e-04 1.18e-05  8.44e-04    10s
  51   5.38220900e+04  5.39480128e+04  4.16e-04 1.03e-05  6.92e-04    10s
  52   5.38373266e+04  5.39411759e+04  3.53e-04 6.90e-06  5.71e-04    11s
  53   5.38512021e+04  5.39373525e+04  2.99e-04 5.20e-06  4.73e-04    11s
  54   5.38734528e+04  5.39352023e+04  2.11e-04 3.83e-06  3.39e-04    11s
  55   5.38824451e+04  5.39344846e+04  1.75e-04 3.51e-06  2.86e-04    11s
  56   5.38904713e+04  5.39327125e+04  1.44e-04 2.24e-06  2.32e-04    11s
  57   5.38960941e+04  5.39317047e+04  1.22e-04 1.77e-06  1.96e-04    11s
  58   5.39080220e+04  5.39302990e+04  7.46e-05 1.21e-06  1.22e-04    11s
  59   5.39088303e+04  5.39298975e+04  7.16e-05 1.06e-06  1.16e-04    11s
  60   5.39143832e+04  5.39294032e+04  5.07e-05 7.01e-07  8.25e-05    11s
  61   5.39269623e+04  5.39283527e+04  2.77e-06 1.67e-06  7.63e-06    12s
  62   5.39280236e+04  5.39280429e+04  1.02e-08 1.77e-07  1.05e-07    12s
  63   5.39280380e+04  5.39280381e+04  1.70e-08 7.77e-08  8.94e-10    12s

Barrier solved model in 63 iterations and 11.83 seconds (10.29 work units)
Optimal objective 5.39280380e+04


Root crossover log...

   88641 DPushes remaining with DInf 0.0000000e+00                12s
       4 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    7719 PPushes remaining with PInf 4.2406772e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1232214e+04     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47609    5.3928038e+04   0.000000e+00   1.123221e+04     16s
   47808    5.3928038e+04   0.000000e+00   0.000000e+00     16s
   47808    5.3928038e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.24s

Solved with barrier

Root relaxation: objective 5.392804e+04, 47808 iterations, 11.75 seconds (13.96 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53928.0381    0  145 -239613.87 53928.0381   123%     -   16s
H    0     0                    -192915.8408 53928.0381   128%     -   17s
H    0     0                    -192334.2903 53928.0381   128%     -   17s
H    0     0                    -191364.7417 53928.0381   128%     -   17s
H    0     0                    -190656.2495 53928.0381   128%     -   17s
H    0     0                    -181533.0566 53928.0381   130%     -   17s
H    0     0                    -166527.5333 53928.0381   132%     -   17s
H    0     0                    -159174.1820 53928.0381   134%     -   17s
H    0     0                    -157105.5182 53928.0381   134%     -   17s
H    0     0                    -53417.81801 53928.0381   201%     -   18s
H    0     0                    -53244.04936 53928.0381   201%     -   18s
H    0     0                    -18790.13610 53928.0381   387%     -   18s
H    0     0                    -6531.521700 53928.0381   926%     -   18s
H    0     0                    9525.1212437 53928.0381   466%     -   18s
H    0     0                    12772.303280 53928.0381   322%     -   19s
H    0     0                    12855.233257 53928.0381   320%     -   19s
H    0     0                    12904.660773 53928.0381   318%     -   19s
H    0     0                    13005.024006 53928.0381   315%     -   19s
H    0     0                    13098.427969 53928.0381   312%     -   19s
H    0     0                    13334.850690 53928.0381   304%     -   21s
H    0     0                    13361.678619 53928.0381   304%     -   21s
H    0     0                    13763.337913 53928.0381   292%     -   21s
H    0     0                    14011.663059 53928.0381   285%     -   21s
H    0     0                    15080.959582 53928.0381   258%     -   21s
H    0     0                    15187.124461 53928.0381   255%     -   21s
H    0     0                    15302.983501 53928.0381   252%     -   21s
H    0     0                    15596.497528 53928.0381   246%     -   21s
H    0     0                    16143.748682 48272.0593   199%     -   61s
H    0     0                    16468.341244 48272.0593   193%     -   61s
H    0     0                    16601.717242 48272.0593   191%     -   61s
H    0     0                    16888.819774 48272.0593   186%     -   61s
H    0     0                    17061.991637 48272.0593   183%     -   61s
     0     0 48272.0593    0  290 17061.9916 48272.0593   183%     -   62s
     0     0 48032.6598    0  302 17061.9916 48032.6598   182%     -   84s
     0     0 48032.6598    0  293 17061.9916 48032.6598   182%     -   91s
     0     0 48032.6598    0  293 17061.9916 48032.6598   182%     -   92s
     0     0 48032.6598    0  293 17061.9916 48032.6598   182%     -   92s
H    0     0                    18582.694166 44345.9489   139%     -  152s
H    0     0                    20909.473092 44345.9489   112%     -  152s
H    0     0                    20923.178828 44345.9489   112%     -  152s
     0     0 44345.9489    0  334 20923.1788 44345.9489   112%     -  152s
H    0     0                    21612.372641 44345.7989   105%     -  152s
     0     0 43585.8188    0  327 21612.3726 43585.8188   102%     -  185s
     0     0 43381.8607    0  338 21612.3726 43381.8607   101%     -  194s
     0     0 43347.5693    0  344 21612.3726 43347.5693   101%     -  198s
     0     0 43224.0296    0  336 21612.3726 43224.0296   100%     -  204s
     0     0 43169.5397    0  327 21612.3726 43169.5397   100%     -  209s
     0     0 43126.2197    0  348 21612.3726 43126.2197   100%     -  215s
     0     0 43056.0147    0  335 21612.3726 43056.0147  99.2%     -  221s
     0     0 43024.9960    0  340 21612.3726 43024.9960  99.1%     -  226s
     0     0 43006.3518    0  348 21612.3726 43006.3518  99.0%     -  229s
     0     0 42998.4519    0  342 21612.3726 42998.4519  99.0%     -  232s
     0     0 42998.1660    0  340 21612.3726 42998.1660  99.0%     -  233s
H    0     0                    22242.915057 42998.1660  93.3%     -  247s
H    0     0                    22880.784643 42998.1660  87.9%     -  247s
H    0     0                    23210.078652 42998.1660  85.3%     -  247s
H    0     0                    23228.019806 42998.1660  85.1%     -  247s
     0     0 41345.9832    0  356 23228.0198 41345.9832  78.0%     -  278s
H    0     0                    23292.374639 41345.1286  77.5%     -  279s
H    0     0                    23374.380990 41345.1286  76.9%     -  279s
     0     0 40865.4456    0  278 23374.3810 40865.4456  74.8%     -  295s
     0     0 40739.1598    0  299 23374.3810 40739.1598  74.3%     -  305s
     0     0 40671.4119    0  295 23374.3810 40671.4119  74.0%     -  311s
     0     0 40661.6710    0  298 23374.3810 40661.6710  74.0%     -  314s
     0     0 40619.1819    0  333 23374.3810 40619.1819  73.8%     -  319s
     0     0 40583.7273    0  342 23374.3810 40583.7273  73.6%     -  322s
     0     0 40576.9752    0  290 23374.3810 40576.9752  73.6%     -  323s
H    0     0                    23577.772344 40544.4600  72.0%     -  327s
     0     0 40544.4600    0  336 23577.7723 40544.4600  72.0%     -  327s
     0     0 40516.4468    0  300 23577.7723 40516.4468  71.8%     -  331s
     0     0 40508.3357    0  341 23577.7723 40508.3357  71.8%     -  333s
     0     0 40504.1452    0  295 23577.7723 40504.1452  71.8%     -  335s
     0     0 40503.9081    0  345 23577.7723 40503.9081  71.8%     -  336s
     0     0 39849.1303    0  357 23577.7723 39849.1303  69.0%     -  366s
     0     0 39641.7881    0  382 23577.7723 39641.7881  68.1%     -  379s
     0     0 39554.6964    0  425 23577.7723 39554.6964  67.8%     -  388s
     0     0 39485.2407    0  420 23577.7723 39485.2407  67.5%     -  395s
     0     0 39460.9750    0  427 23577.7723 39460.9750  67.4%     -  400s
     0     0 39427.7359    0  431 23577.7723 39427.7359  67.2%     -  403s
     0     0 39408.2604    0  442 23577.7723 39408.2604  67.1%     -  406s
     0     0 39380.8633    0  428 23577.7723 39380.8633  67.0%     -  409s
     0     0 39364.9701    0  437 23577.7723 39364.9701  67.0%     -  412s
     0     0 39358.0101    0  436 23577.7723 39358.0101  66.9%     -  414s
     0     0 39351.0118    0  440 23577.7723 39351.0118  66.9%     -  418s
     0     0 39348.3333    0  445 23577.7723 39348.3333  66.9%     -  420s
     0     0 39346.3123    0  444 23577.7723 39346.3123  66.9%     -  421s
     0     0 39345.1598    0  440 23577.7723 39345.1598  66.9%     -  422s
     0     0 39144.1207    0  393 23577.7723 39144.1207  66.0%     -  436s
H    0     0                    23661.180465 39143.1063  65.4%     -  437s
H    0     0                    23682.510255 39143.1063  65.3%     -  437s
     0     0 39062.0425    0  440 23682.5103 39062.0425  64.9%     -  446s
     0     0 39036.0900    0  431 23682.5103 39036.0900  64.8%     -  451s
     0     0 39025.2360    0  430 23682.5103 39025.2360  64.8%     -  455s
     0     0 39020.0378    0  430 23682.5103 39020.0378  64.8%     -  457s
     0     0 39010.6899    0  435 23682.5103 39010.6899  64.7%     -  459s
     0     0 38998.6171    0  387 23682.5103 38998.6171  64.7%     -  463s
     0     0 38983.9299    0  431 23682.5103 38983.9299  64.6%     -  466s
     0     0 38980.6650    0  442 23682.5103 38980.6650  64.6%     -  468s
     0     0 38979.3624    0  437 23682.5103 38979.3624  64.6%     -  469s
     0     0 38913.8783    0  446 23682.5103 38913.8783  64.3%     -  481s
H    0     0                    24048.300452 38913.4801  61.8%     -  491s
H    0     0                    24116.859966 38913.4801  61.4%     -  491s
H    0     0                    24237.813544 38913.4801  60.5%     -  492s
     0     0 38902.9071    0  450 24237.8135 38902.9071  60.5%     -  498s
     0     0 38892.4589    0  444 24237.8135 38892.4589  60.5%     -  502s
     0     0 38890.2430    0  435 24237.8135 38890.2430  60.5%     -  504s
     0     0 38887.9983    0  444 24237.8135 38887.9983  60.4%     -  504s
     0     0 38886.1461    0  446 24237.8135 38886.1461  60.4%     -  506s
     0     0 38865.3061    0  436 24237.8135 38865.3061  60.3%     -  512s
H    0     0                    24335.097221 38865.2683  59.7%     -  513s
     0     0 38859.8467    0  397 24335.0972 38859.8467  59.7%     -  515s
     0     0 38859.1620    0  399 24335.0972 38859.1620  59.7%     -  517s
     0     0 38845.1850    0  435 24335.0972 38845.1850  59.6%     -  523s
     0     0 38837.7372    0  440 24335.0972 38837.7372  59.6%     -  527s
     0     0 38832.8096    0  407 24335.0972 38832.8096  59.6%     -  529s
     0     0 38831.6761    0  356 24335.0972 38831.6761  59.6%     -  530s
     0     0 38802.1750    0  421 24335.0972 38802.1750  59.4%     -  537s
     0     0 38791.4521    0  392 24335.0972 38791.4521  59.4%     -  542s
     0     0 38788.4046    0  442 24335.0972 38788.4046  59.4%     -  543s
     0     0 38786.8404    0  446 24335.0972 38786.8404  59.4%     -  544s
     0     0 38774.1165    0  437 24335.0972 38774.1165  59.3%     -  549s
H    0     0                    24441.347886 38773.8290  58.6%     -  560s
H    0     0                    24454.306165 38773.8290  58.6%     -  562s
     0     0 38765.3183    0  379 24454.3062 38765.3183  58.5%     -  564s
     0     0 38761.9897    0  380 24454.3062 38761.9897  58.5%     -  566s
     0     0 38760.9587    0  390 24454.3062 38760.9587  58.5%     -  567s
     0     0 38749.8717    0  447 24454.3062 38749.8717  58.5%     -  572s
     0     0 38744.4719    0  396 24454.3062 38744.4719  58.4%     -  574s
     0     0 38742.1594    0  397 24454.3062 38742.1594  58.4%     -  575s
     0     0 38741.8495    0  400 24454.3062 38741.8495  58.4%     -  576s
     0     0 38736.2721    0  343 24454.3062 38736.2721  58.4%     -  579s
     0     0 38733.7740    0  394 24454.3062 38733.7740  58.4%     -  580s
     0     0 38731.2228    0  396 24454.3062 38731.2228  58.4%     -  582s
     0     0 38728.4581    0  393 24454.3062 38728.4581  58.4%     -  585s
     0     0 38727.9371    0  349 24454.3062 38727.9371  58.4%     -  587s
     0     0 38724.8414    0  442 24454.3062 38724.8414  58.4%     -  592s
     0     0 38723.4016    0  403 24454.3062 38723.4016  58.4%     -  594s
     0     0 38714.8769    0  431 24454.3062 38714.8769  58.3%     -  601s
     0     0 38703.6218    0  446 24454.3062 38703.6218  58.3%     -  607s
     0     0 38698.9439    0  439 24454.3062 38698.9439  58.3%     -  610s
     0     0 38697.8509    0  449 24454.3062 38697.8509  58.2%     -  612s
     0     0 38685.0333    0  395 24454.3062 38685.0333  58.2%     -  618s
     0     0 38683.0831    0  449 24454.3062 38683.0831  58.2%     -  621s
     0     0 38679.0683    0  449 24454.3062 38679.0683  58.2%     -  625s
     0     0 38677.7904    0  445 24454.3062 38677.7904  58.2%     -  626s
     0     0 38676.8333    0  446 24454.3062 38676.8333  58.2%     -  629s
     0     0 38676.5083    0  449 24454.3062 38676.5083  58.2%     -  631s
     0     0 38673.1263    0  453 24454.3062 38673.1263  58.1%     -  634s
     0     0 38673.0086    0  453 24454.3062 38673.0086  58.1%     -  638s
     0     2 38672.6858    0  453 24454.3062 38672.6858  58.1%     -  806s
     1     4 38638.1096    1  367 24454.3062 38672.2441  58.1%  1619  818s
     3     8 38375.7291    2  337 24454.3062 38636.7425  58.0%  6839  843s
     7    15 38120.5766    3  335 24454.3062 38373.0912  56.9% 10591  869s
    14    30 37948.6579    4  414 24454.3062 38120.5621  55.9% 11397  888s
    29    45 37224.5924    5  388 24454.3062 37947.7354  55.2% 14949 2231s
    44    76 37085.4486    6  327 24454.3062 37947.7354  55.2% 23051 2347s
    75   161 37067.5670    7  326 24454.3062 37444.7813  53.1% 18033 2393s
   160   231 37040.2368    9  313 24454.3062 37444.7813  53.1% 11503 2424s
H  166   231                    24634.334412 37444.7813  52.0% 11296 2424s
H  205   231                    25521.326155 37444.7813  46.7% 10203 2424s
   230   304 36627.5799   11  310 25521.3262 37444.7813  46.7%  9987 2457s
H  303   338                    25728.624783 37444.7813  45.5%  8935 2482s
   341   389 36451.2963   13  251 25728.6248 37444.7813  45.5%  8971 2512s
   408   436 36169.0122   15  291 25728.6248 37444.7813  45.5%  8584 2543s
   470   491 36039.4819   16  219 25728.6248 37444.7813  45.5%  8040 2574s
   540   562 35382.2717   18  194 25728.6248 37444.7813  45.5%  7520 2607s
   621   622 34971.0660   22  187 25728.6248 37444.7813  45.5%  6909 2636s
   703   641 34670.3216   26  185 25728.6248 37444.7813  45.5%  6408 2659s
   736   660 34165.1393   27  287 25728.6248 37444.7813  45.5%  6280 2684s
   773   695 34148.1240   28  281 25728.6248 37444.7813  45.5%  6135 2702s
   816   732 34065.6184   29  284 25728.6248 37444.7813  45.5%  5977 2722s
   861   775 34033.0169   30  220 25728.6248 37444.7813  45.5%  5852 2745s
   918   814 34008.4866   31  220 25728.6248 37444.7813  45.5%  5635 2768s
   965   854 33997.4463   32  226 25728.6248 37444.7813  45.5%  5514 2793s
  1031   901 33960.8570   33  221 25728.6248 37444.7813  45.5%  5364 2815s
  1096   940 33715.5058   34  208 25728.6248 37444.7813  45.5%  5181 2844s
  1157   988 33126.0858   35  200 25728.6248 37444.7813  45.5%  5079 2878s
  1249  1014 30726.8205   36  215 25728.6248 37444.7813  45.5%  4882 2904s
  1285  1067 29803.1522   37  208 25728.6248 37444.7813  45.5%  4872 2929s
  1370  1165 infeasible   38      25728.6248 37444.7813  45.5%  4750 2959s
  1500  1255 29477.0297    9  329 25728.6248 37444.7813  45.5%  4531 2990s
  1632  1360     cutoff   10      25728.6248 37444.7813  45.5%  4345 3021s
  1768  1461 29398.2825   10  288 25728.6248 37444.7813  45.5%  4215 3058s
  1929  1534 29093.0131   13  286 25728.6248 37444.7813  45.5%  4053 3096s
  2092  1593 28054.7342   16  343 25728.6248 37444.7813  45.5%  3934 3135s
  2209  1666 27577.1569   17  222 25728.6248 37444.7813  45.5%  3902 3177s
  2326  1759 26896.6301   20  279 25728.6248 37444.7813  45.5%  3872 3218s
  2468  1865 26664.8288   23  290 25728.6248 37444.7813  45.5%  3831 3259s
  2619  1990 26482.8409   25  303 25728.6248 37444.7813  45.5%  3783 3302s
  2790  2047 infeasible   31      25728.6248 37444.7813  45.5%  3725 3346s
  2941  2102 36511.6687    6  348 25728.6248 37444.7813  45.5%  3722 3394s
  3077  2173 32949.5470    8  212 25728.6248 37444.7813  45.5%  3727 3448s
  3200  2197 32916.7488    9  216 25728.6248 37114.5912  44.3%  3751 3491s
  3236  2215 29597.2781   10  273 25728.6248 37114.5912  44.3%  3762 3534s
  3284  2246 28766.2751   11  252 25728.6248 37114.5912  44.3%  3784 3574s
  3322  2272 28381.1443   12  230 25728.6248 37114.5912  44.3%  3803 3600s

Cutting planes:
  Gomory: 6
  Implied bound: 77
  MIR: 1788
  Flow cover: 2721
  RLT: 67
  Relax-and-lift: 499

Explored 3354 nodes (13232308 simplex iterations) in 3600.07 seconds (4735.98 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25728.6 25521.3 24634.3 ... 23682.5

Time limit reached
Best objective 2.572862478343e+04, best bound 3.711459116954e+04, gap 44.2541%
  WARNING: Time limit reached. Using best solution found (gap: 44.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 25728.62, θ = 173206.17
  Upper Bound (UB) = 25728.62

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173206.17
  [DEBUG]   ✓ Scenario 0: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173206.17 ≤ Q = 173206.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173206.17 ≤ Q = 173206.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 173206.17 ≤ Q = 173206.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 173206.17 ≤ Q = 173206.17 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x21634448
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x21634448
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.430501e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6802836.2046
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.566727e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156672.70    0  124 6802836.20 -156672.70   102%     -    0s
H    0     0                    -121599.7911 -156672.70  28.8%     -    0s
H    0     0                    -121863.0437 -156672.70  28.6%     -    0s
     0     0 -135724.86    0   67 -121863.04 -135724.86  11.4%     -    0s
H    0     0                    -132774.5192 -135595.08  2.12%     -    0s
     0     0 -134939.38    0   66 -132774.52 -134939.38  1.63%     -    0s
H    0     0                    -133661.6742 -134900.33  0.93%     -    0s
H    0     0                    -133832.0931 -134900.33  0.80%     -    0s
     0     0 -134837.72    0   65 -133832.09 -134837.72  0.75%     -    0s
H    0     0                    -133989.8787 -134837.72  0.63%     -    0s
     0     0 -134837.72    0   65 -133989.88 -134837.72  0.63%     -    0s
H    0     0                    -134010.8309 -134837.72  0.62%     -    0s
     0     0 -134302.28    0   22 -134010.83 -134302.28  0.22%     -    0s
     0     0 -134296.55    0   18 -134010.83 -134296.55  0.21%     -    0s
     0     0 -134254.13    0   26 -134010.83 -134254.13  0.18%     -    0s
     0     0 -134253.35    0   24 -134010.83 -134253.35  0.18%     -    0s
     0     0 -134226.18    0   21 -134010.83 -134226.18  0.16%     -    0s
     0     0 -134226.11    0   21 -134010.83 -134226.11  0.16%     -    0s
     0     0 -134225.23    0   22 -134010.83 -134225.23  0.16%     -    0s
     0     0 -134125.14    0    8 -134010.83 -134125.14  0.09%     -    0s
     0     0 -134125.14    0   10 -134010.83 -134125.14  0.09%     -    0s
H    0     0                    -134049.1044 -134125.14  0.06%     -    0s
     0     0 -134085.69    0    5 -134049.10 -134085.69  0.03%     -    0s
H    0     0                    -134081.3057 -134084.04  0.00%     -    0s
     0     0 -134081.85    0    2 -134081.31 -134081.85  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 4
  Flow cover: 5
  Relax-and-lift: 1

Explored 1 nodes (781 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -134081 -134049 -134011 ... 6.80284e+06
No other solutions better than -134081

Optimal solution found (tolerance 1.00e-06)
Best objective -1.340813056960e+05, best bound -1.340813056960e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 165066.51
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134081.31
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -134081.31 = 165066.51
  [DEBUG]   Current θ from Master = 173206.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8139.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17588.96
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 874.9428, Absolute Gap = 874.9428, Relative Gap = 0.034007
  Not converged yet (gap = 874.94 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x724865fb
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 92330 rows and 37520 columns
Presolve time: 3.69s
Presolved: 107823 rows, 45860 columns, 651061 nonzeros
Variable types: 43601 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -350500.7547
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.29s

Barrier statistics:
 Dense cols : 628
 AA' NZ     : 3.897e+06
 Factor NZ  : 9.335e+06 (roughly 140 MB of memory)
 Factor Ops : 1.807e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82860073e+07  2.08136020e+08  1.13e+05 1.65e+01  8.13e+04     7s
   1  -1.38361819e+07  1.83836860e+08  7.87e+04 7.43e+01  5.59e+04     7s
   2  -4.37092586e+06  1.40848554e+08  2.47e+04 5.70e-01  1.86e+04     7s
   3  -9.33961303e+05  9.88316979e+07  2.16e+03 1.90e+00  2.03e+03     7s
   4  -5.59884462e+05  4.55743283e+07  5.22e+02 5.67e-01  5.58e+02     7s
   5  -4.27166140e+05  2.66037708e+07  1.89e+02 2.60e-01  2.43e+02     7s
   6  -3.10222142e+05  1.98470137e+07  7.24e+01 1.79e-01  1.39e+02     7s
   7  -1.71456103e+05  1.51789925e+07  2.10e+01 1.31e-01  8.69e+01     7s
   8  -1.08599039e+05  9.87852852e+06  9.11e+00 8.13e-02  5.35e+01     7s
   9  -7.97426707e+04  3.66751616e+06  4.31e+00 2.77e-02  1.96e+01     7s
  10  -4.73290775e+04  1.45145401e+06  1.91e+00 1.03e-02  7.71e+00     8s
  11  -2.32743925e+04  8.29614846e+05  1.07e+00 5.57e-03  4.36e+00     8s
  12  -9.96945128e+03  4.74651960e+05  7.45e-01 3.09e-03  2.47e+00     8s
  13   4.11818178e+03  2.48890179e+05  3.72e-01 1.61e-03  1.24e+00     8s
  14   1.09583842e+04  1.54055364e+05  2.67e-01 1.08e-03  7.27e-01     8s
  15   1.70083215e+04  1.32175528e+05  2.18e-01 1.36e-03  5.85e-01     8s
  16   2.33978332e+04  1.12056728e+05  1.73e-01 1.61e-03  4.50e-01     8s
  17   2.72319694e+04  9.96861629e+04  1.51e-01 1.65e-03  3.68e-01     8s
  18   3.12912082e+04  8.29133780e+04  1.26e-01 1.51e-03  2.62e-01     8s
  19   3.83655415e+04  7.57576366e+04  8.86e-02 1.95e-03  1.90e-01     8s
  20   3.97506954e+04  6.87448955e+04  8.11e-02 1.65e-03  1.47e-01     8s
  21   4.10191457e+04  6.62294995e+04  7.47e-02 1.65e-03  1.28e-01     9s
  22   4.37795307e+04  6.35565477e+04  6.13e-02 1.41e-03  1.01e-01     9s
  23   4.66496256e+04  6.15792189e+04  4.72e-02 1.35e-03  7.59e-02     9s
  24   4.89745385e+04  6.08506703e+04  3.62e-02 1.41e-03  6.04e-02     9s
  25   4.94452821e+04  5.99519068e+04  3.39e-02 1.31e-03  5.34e-02     9s
  26   5.10311087e+04  5.95022368e+04  2.66e-02 1.14e-03  4.31e-02     9s
  27   5.18396545e+04  5.88475516e+04  2.28e-02 9.74e-04  3.56e-02     9s
  28   5.23639664e+04  5.85382141e+04  2.03e-02 1.36e-03  3.14e-02     9s
  29   5.38385050e+04  5.82185606e+04  1.35e-02 1.10e-03  2.23e-02     9s
  30   5.43735557e+04  5.80246855e+04  1.09e-02 1.09e-03  1.86e-02     9s
  31   5.49082409e+04  5.76887157e+04  8.47e-03 7.76e-04  1.41e-02    10s
  32   5.50851594e+04  5.74956658e+04  7.66e-03 5.26e-04  1.23e-02    10s
  33   5.53455270e+04  5.73433437e+04  6.47e-03 4.72e-04  1.02e-02    10s
  34   5.53866673e+04  5.73062062e+04  6.27e-03 4.43e-04  9.76e-03    10s
  35   5.55722994e+04  5.72092642e+04  5.43e-03 3.67e-04  8.32e-03    10s
  36   5.58072474e+04  5.71742208e+04  4.38e-03 3.73e-04  6.95e-03    10s
  37   5.59601208e+04  5.71352341e+04  3.67e-03 3.17e-04  5.97e-03    10s
  38   5.60803794e+04  5.70713689e+04  3.11e-03 2.53e-04  5.04e-03    10s
  39   5.61757798e+04  5.70178761e+04  2.69e-03 2.06e-04  4.28e-03    11s
  40   5.63064660e+04  5.69608380e+04  2.08e-03 1.54e-04  3.33e-03    11s
  41   5.64913433e+04  5.68718181e+04  1.24e-03 1.35e-04  1.93e-03    11s
  42   5.65098589e+04  5.68649479e+04  1.15e-03 1.24e-04  1.80e-03    11s
  43   5.65695975e+04  5.68517850e+04  8.99e-04 1.02e-04  1.43e-03    11s
  44   5.65841627e+04  5.68393996e+04  8.37e-04 8.26e-05  1.30e-03    11s
  45   5.66379348e+04  5.68253119e+04  6.06e-04 5.72e-05  9.52e-04    11s
  46   5.67007336e+04  5.68083404e+04  3.38e-04 2.98e-05  5.47e-04    11s
  47   5.67491075e+04  5.67953881e+04  1.50e-04 8.68e-06  2.35e-04    12s
  48   5.67656866e+04  5.67920613e+04  8.84e-05 1.49e-05  1.34e-04    12s
  49   5.67846786e+04  5.67914603e+04  1.61e-05 9.47e-06  3.44e-05    12s
  50   5.67885158e+04  5.67903948e+04  3.14e-06 3.24e-06  9.53e-06    12s
  51   5.67889622e+04  5.67900629e+04  1.96e-06 1.63e-06  5.59e-06    12s
  52   5.67892858e+04  5.67897879e+04  1.11e-06 3.61e-07  2.55e-06    12s
  53   5.67896852e+04  5.67897139e+04  3.46e-08 3.98e-07  1.45e-07    12s
  54   5.67896856e+04  5.67897131e+04  3.28e-07 3.66e-07  1.39e-07    12s
  55   5.67897039e+04  5.67897040e+04  3.97e-10 1.97e-09  1.42e-10    12s

Barrier solved model in 55 iterations and 12.45 seconds (10.26 work units)
Optimal objective 5.67897039e+04


Root crossover log...

   92952 DPushes remaining with DInf 0.0000000e+00                13s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    2347 PPushes remaining with PInf 1.4301017e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.4657506e-11     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36749    5.6789704e+04   0.000000e+00   0.000000e+00     15s
   36749    5.6789704e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.678970e+04, 36749 iterations, 10.35 seconds (10.55 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56789.7040    0  244 -239613.87 56789.7040   124%     -   15s
H    0     0                    -233684.6241 56789.7040   124%     -   15s
H    0     0                    -156299.3676 56789.7040   136%     -   16s
H    0     0                    -155371.7822 56789.7040   137%     -   16s
H    0     0                    -154638.4215 56789.7040   137%     -   16s
H    0     0                    -154614.3665 56789.7040   137%     -   16s
H    0     0                    -62028.75240 56789.7040   192%     -   16s
H    0     0                    -61720.47214 56789.7040   192%     -   16s
H    0     0                    -19129.07815 56789.7040   397%     -   17s
H    0     0                    -16825.19514 56789.7040   438%     -   17s
H    0     0                    -15606.29026 56789.7040   464%     -   17s
H    0     0                    -13827.35228 56789.7040   511%     -   17s
H    0     0                    -12144.40263 56789.7040   568%     -   17s
H    0     0                    -11844.51464 56789.7040   579%     -   17s
H    0     0                    -11784.63708 56789.7040   582%     -   17s
H    0     0                    -11387.40804 56789.7040   599%     -   17s
H    0     0                    -11346.34964 56789.7040   601%     -   17s
H    0     0                    -7480.557845 49653.0500   764%     -   54s
H    0     0                    10142.740877 49653.0500   390%     -   54s
H    0     0                    10211.217573 49653.0500   386%     -   54s
H    0     0                    10644.916836 49653.0500   366%     -   54s
     0     0 49645.4261    0  304 10644.9168 49645.4261   366%     -   54s
     0     0 49008.5026    0  306 10644.9168 49008.5026   360%     -   77s
     0     0 48855.3038    0  310 10644.9168 48855.3038   359%     -   84s
     0     0 48855.3038    0  305 10644.9168 48855.3038   359%     -   87s
     0     0 48755.3560    0  318 10644.9168 48755.3560   358%     -   94s
     0     0 48624.4845    0  303 10644.9168 48624.4845   357%     -  103s
     0     0 48620.9180    0  305 10644.9168 48620.9180   357%     -  105s
H    0     0                    14599.573187 45237.8854   210%     -  163s
H    0     0                    15025.253665 45237.8854   201%     -  163s
     0     0 45237.8854    0  397 15025.2537 45237.8854   201%     -  163s
H    0     0                    22298.940212 45237.7004   103%     -  164s
     0     0 44577.4871    0  406 22298.9402 44577.4871   100%     -  192s
     0     0 44448.4019    0  402 22298.9402 44448.4019  99.3%     -  205s
     0     0 44355.1819    0  413 22298.9402 44355.1819  98.9%     -  217s
     0     0 44280.1473    0  416 22298.9402 44280.1473  98.6%     -  228s
     0     0 44249.3963    0  420 22298.9402 44249.3963  98.4%     -  233s
     0     0 44230.1077    0  415 22298.9402 44230.1077  98.4%     -  241s
     0     0 44226.1920    0  421 22298.9402 44226.1920  98.3%     -  243s
     0     0 44131.4173    0  424 22298.9402 44131.4173  97.9%     -  251s
     0     0 44123.4121    0  428 22298.9402 44123.4121  97.9%     -  254s
     0     0 44120.4703    0  430 22298.9402 44120.4703  97.9%     -  255s
     0     0 44114.0817    0  427 22298.9402 44114.0817  97.8%     -  257s
     0     0 44113.8546    0  434 22298.9402 44113.8546  97.8%     -  257s
     0     0 41744.3434    0  386 22298.9402 41744.3434  87.2%     -  336s
H    0     0                    24374.378064 41744.1851  71.3%     -  337s
H    0     0                    25452.217640 41744.1851  64.0%     -  337s
H    0     0                    25476.434371 41744.1851  63.9%     -  337s
H    0     0                    25673.001272 41744.1851  62.6%     -  337s
H    0     0                    25684.970397 41744.1851  62.5%     -  337s
     0     0 41158.5353    0  348 25684.9704 41158.5353  60.2%     -  369s
     0     0 41028.1085    0  359 25684.9704 41028.1085  59.7%     -  380s
     0     0 40884.7257    0  377 25684.9704 40884.7257  59.2%     -  393s
     0     0 40769.0109    0  385 25684.9704 40769.0109  58.7%     -  403s
     0     0 40704.2972    0  399 25684.9704 40704.2972  58.5%     -  409s
     0     0 40665.8572    0  390 25684.9704 40665.8572  58.3%     -  416s
     0     0 40600.7324    0  382 25684.9704 40600.7324  58.1%     -  424s
     0     0 40586.0990    0  381 25684.9704 40586.0990  58.0%     -  429s
     0     0 40565.0193    0  386 25684.9704 40565.0193  57.9%     -  434s
     0     0 40537.6628    0  385 25684.9704 40537.6628  57.8%     -  439s
     0     0 40537.4192    0  385 25684.9704 40537.4192  57.8%     -  442s
     0     0 39871.9898    0  416 25684.9704 39871.9898  55.2%     -  484s
     0     0 39464.4613    0  394 25684.9704 39464.4613  53.6%     -  504s
     0     0 39300.1186    0  441 25684.9704 39300.1186  53.0%     -  519s
     0     0 39220.8026    0  441 25684.9704 39220.8026  52.7%     -  530s
     0     0 39206.9852    0  442 25684.9704 39206.9852  52.6%     -  534s
     0     0 39192.4834    0  447 25684.9704 39192.4834  52.6%     -  539s
     0     0 39175.6623    0  453 25684.9704 39175.6623  52.5%     -  546s
     0     0 39129.0813    0  435 25684.9704 39129.0813  52.3%     -  553s
     0     0 39116.3208    0  456 25684.9704 39116.3208  52.3%     -  558s
     0     0 39110.9372    0  449 25684.9704 39110.9372  52.3%     -  560s
     0     0 39108.9514    0  448 25684.9704 39108.9514  52.3%     -  563s
     0     0 38917.4099    0  456 25684.9704 38917.4099  51.5%     -  582s
     0     0 38861.2478    0  462 25684.9704 38861.2478  51.3%     -  593s
     0     0 38835.0720    0  461 25684.9704 38835.0720  51.2%     -  599s
     0     0 38814.1358    0  468 25684.9704 38814.1358  51.1%     -  605s
     0     0 38807.3903    0  430 25684.9704 38807.3903  51.1%     -  609s
     0     0 38800.0630    0  470 25684.9704 38800.0630  51.1%     -  613s
     0     0 38797.8950    0  470 25684.9704 38797.8950  51.1%     -  616s
     0     0 38736.0882    0  459 25684.9704 38736.0882  50.8%     -  627s
     0     0 38720.4481    0  463 25684.9704 38720.4481  50.8%     -  642s
     0     0 38704.7145    0  459 25684.9704 38704.7145  50.7%     -  647s
     0     0 38700.2087    0  467 25684.9704 38700.2087  50.7%     -  650s
     0     0 38696.8479    0  464 25684.9704 38696.8479  50.7%     -  653s
     0     0 38679.8581    0  467 25684.9704 38679.8581  50.6%     -  657s
     0     0 38656.1683    0  459 25684.9704 38656.1683  50.5%     -  662s
     0     0 38650.9968    0  460 25684.9704 38650.9968  50.5%     -  665s
     0     0 38645.3394    0  462 25684.9704 38645.3394  50.5%     -  668s
     0     0 38640.9009    0  435 25684.9704 38640.9009  50.4%     -  670s
     0     0 38630.5177    0  409 25684.9704 38630.5177  50.4%     -  673s
     0     0 38628.4152    0  433 25684.9704 38628.4152  50.4%     -  675s
     0     0 38578.0781    0  422 25684.9704 38578.0781  50.2%     -  685s
     0     0 38552.5979    0  415 25684.9704 38552.5979  50.1%     -  691s
     0     0 38549.3161    0  410 25684.9704 38549.3161  50.1%     -  693s
     0     0 38546.0417    0  414 25684.9704 38546.0417  50.1%     -  694s
     0     0 38543.6923    0  413 25684.9704 38543.6923  50.1%     -  697s
     0     0 38519.0119    0  434 25684.9704 38519.0119  50.0%     -  703s
     0     0 38505.3550    0  487 25684.9704 38505.3550  49.9%     -  712s
     0     0 38502.3303    0  486 25684.9704 38502.3303  49.9%     -  715s
     0     0 38496.3368    0  481 25684.9704 38496.3368  49.9%     -  719s
     0     0 38494.0942    0  439 25684.9704 38494.0942  49.9%     -  720s
     0     0 38482.0893    0  411 25684.9704 38482.0893  49.8%     -  727s
     0     0 38480.3197    0  416 25684.9704 38480.3197  49.8%     -  730s
     0     0 38477.1033    0  516 25684.9704 38477.1033  49.8%     -  735s
     0     0 38474.8987    0  424 25684.9704 38474.8987  49.8%     -  742s
     0     0 38458.7183    0  459 25684.9704 38458.7183  49.7%     -  750s
     0     0 38451.7041    0  466 25684.9704 38451.7041  49.7%     -  757s
     0     0 38448.8055    0  514 25684.9704 38448.8055  49.7%     -  760s
     0     0 38447.1939    0  506 25684.9704 38447.1939  49.7%     -  761s
     0     0 38443.4369    0  465 25684.9704 38443.4369  49.7%     -  765s
     0     0 38443.2207    0  465 25684.9704 38443.2207  49.7%     -  771s
     0     2 38443.1526    0  465 25684.9704 38443.1526  49.7%     -  933s
     1     3 38331.5219    1  461 25684.9704 38443.0571  49.7%  8065  942s
     2     4 38323.2829    1  357 25684.9704 38331.2146  49.2%  5684  952s
     3     6 38179.0726    2  464 25684.9704 38331.2146  49.2%  6891  966s
     5    10 37991.6127    3  438 25684.9704 38331.2146  49.2%  8074  987s
     9    20 37401.1731    4  441 25684.9704 38179.0481  48.6%  9457 1018s
    19    40 37055.5348    5  414 25684.9704 37870.2798  47.4% 10734 1042s
    39    52 36899.8850    6  439 25684.9704 37826.1436  47.3% 14951 1105s
    51    75 36555.8413    6  399 25684.9704 37826.1436  47.3% 14399 1166s
    74   180 35891.0113    7  376 25684.9704 37826.1436  47.3% 13283 1217s
   179   254 35311.9309   11  346 25684.9704 37826.1436  47.3%  9311 1252s
   253   302 35282.8305   13  355 25684.9704 37826.1436  47.3%  7856 1284s
   307   336 35417.3128   12  392 25684.9704 37826.1436  47.3%  7161 1313s
   351   386 34785.3933   15  323 25684.9704 37826.1436  47.3%  6902 1345s
   414   411 31470.7375   13  445 25684.9704 37826.1436  47.3%  6478 1375s
   463   452 34324.3766   17  330 25684.9704 37826.1436  47.3%  6238 1406s
   516   487 34231.7922   19  326 25684.9704 37826.1436  47.3%  6136 1433s
   578   516 33940.4996   21  271 25684.9704 37826.1436  47.3%  5889 1461s
   637   560     cutoff   22      25684.9704 37826.1436  47.3%  5702 1488s
   699   620 30604.0194   19  365 25684.9704 37826.1436  47.3%  5562 1512s
   781   643 32088.3937   27  345 25684.9704 37826.1436  47.3%  5316 1535s
   814   665 32026.1019   28  280 25684.9704 37826.1436  47.3%  5290 1558s
   852   691 31964.7066   29  281 25684.9704 37826.1436  47.3%  5268 1580s
   884   729 31787.1090   30  287 25684.9704 37826.1436  47.3%  5218 1606s
   932   752 31682.3619   31  276 25684.9704 37826.1436  47.3%  5112 1629s
   977   796 31649.2101   32  278 25684.9704 37826.1436  47.3%  4997 1650s
  1037   839 31648.8562   33  275 25684.9704 37826.1436  47.3%  4841 1675s
  1102   911 31564.7729   34  278 25684.9704 37826.1436  47.3%  4704 1701s
  1208   958 31467.5381   35  261 25684.9704 37826.1436  47.3%  4481 1730s
  1328  1018 31455.6530   36  263 25684.9704 37826.1436  47.3%  4258 1760s
  1414  1066     cutoff   39      25684.9704 37826.1436  47.3%  4193 1791s
  1514  1162 28029.3934   42  213 25684.9704 37826.1436  47.3%  4180 1825s
  1637  1199 27515.1514   48  172 25684.9704 37826.1436  47.3%  4090 1863s
  1760  1272 26780.5453   50  154 25684.9704 37826.1436  47.3%  4017 1904s
  1905  1379     cutoff   54      25684.9704 37826.1436  47.3%  3908 1942s
  2091  1447 30416.1137    8  323 25684.9704 37826.1436  47.3%  3759 1970s
  2223  1506 28530.7148    9  287 25684.9704 37826.1436  47.3%  3660 2007s
  2350  1581 28482.8606   10  287 25684.9704 37386.6445  45.6%  3595 2043s
  2465  1635 28345.0928   11  206 25684.9704 37386.6445  45.6%  3571 2081s
  2577  1707 27465.6889   12  190 25684.9704 37386.6445  45.6%  3562 2129s
  2703  1829 27196.0062   13  194 25684.9704 37040.0437  44.2%  3549 2174s
  2878  1926 26360.1873   15  251 25684.9704 37040.0437  44.2%  3526 2220s
  3061  2029     cutoff   17      25684.9704 37040.0437  44.2%  3487 2273s
  3230  2143 35136.7223   12  306 25684.9704 37040.0437  44.2%  3472 2322s
  3393  2249 33753.0839   15  321 25684.9704 37040.0437  44.2%  3500 2378s
  3593  2317 32849.6731   16  312 25684.9704 36598.0098  42.5%  3483 2433s
  3760  2384 26705.1572   20  155 25684.9704 36545.9402  42.3%  3501 2509s
  3953  2453     cutoff   12      25684.9704 36545.9402  42.3%  3520 2572s
  4126  2548 infeasible   39      25684.9704 36452.6594  41.9%  3548 2637s
  4291  2692 27461.8369   11  195 25684.9704 36394.4402  41.7%  3586 2702s
  4515  2693 35150.8962    9  465 25684.9704 36394.4402  41.7%  3581 2946s
  4517  2694 32729.6247   24   74 25684.9704 36394.4402  41.7%  3579 2964s
  4518  2695 33603.8094   17  297 25684.9704 36394.4402  41.7%  3579 3063s
  4519  2696 31129.1427   15  378 25684.9704 36394.4402  41.7%  3578 3156s
  4520  2696 26507.3801   40  374 25684.9704 36394.4402  41.7%  3577 3213s
  4521  2697 33132.9312   19  428 25684.9704 36394.4402  41.7%  3576 3247s
  4522  2698 33844.9400   20  439 25684.9704 36394.4402  41.7%  3575 3271s
  4523  2698 30047.2267   36  455 25684.9704 36394.4402  41.7%  3575 3293s
  4524  2699 34659.0972   10  461 25684.9704 36394.4402  41.7%  3574 3316s
  4525  2700 30545.8585   23  495 25684.9704 36394.4402  41.7%  3573 3328s
  4526  2700 27433.8614   37  419 25684.9704 36394.4402  41.7%  3572 3338s
  4527  2701 27987.4651   28  466 25684.9704 36394.4402  41.7%  3571 3349s
  4528  2702 27157.5021   59  474 25684.9704 36394.4402  41.7%  3571 3353s
  4529  2702 26628.8354   52  455 25684.9704 36394.4402  41.7%  3570 3358s
  4530  2703 35591.1775   10  458 25684.9704 36394.4402  41.7%  3569 3362s
  4531  2704 35776.5712    9  452 25684.9704 36394.4402  41.7%  3568 3367s
  4532  2704 28541.6140   29  449 25684.9704 36394.4402  41.7%  3568 3373s
  4533  2705 32568.1337   34  495 25684.9704 36394.4402  41.7%  3567 3376s
  4535  2706 26480.7543   30  455 25684.9704 36394.4402  41.7%  3565 3385s
  4536  2707 31958.2071   24  454 25684.9704 36394.4402  41.7%  3564 3390s
  4537  2708 31305.1599   19  452 25684.9704 36394.4402  41.7%  3564 3397s
  4538  2708 28589.1321   32  402 25684.9704 36394.4402  41.7%  3563 3418s
  4539  2709 31678.6388   27  415 25684.9704 36394.4402  41.7%  3562 3427s
  4540  2710 32837.3589   16  505 25684.9704 36394.4402  41.7%  3561 3435s
  4542  2711 28161.3913   49  411 25684.9704 36394.4402  41.7%  3560 3445s
  4543  2712 31116.0111   21  492 25684.9704 36394.4402  41.7%  3559 3463s
  4544  2712 27149.5767   40  507 25684.9704 36394.4402  41.7%  3558 3471s
  4545  2713 27360.2641   14  409 25684.9704 36394.4402  41.7%  3557 3477s
  4546  2714 27453.7370   19  392 25684.9704 36394.4402  41.7%  3557 3492s
  4547  2714 32087.0730   28  406 25684.9704 36394.4402  41.7%  3556 3497s
  4548  2715 27865.8192   37  404 25684.9704 36394.4402  41.7%  3555 3502s
  4549  2716 27364.5655   36  438 25684.9704 36394.4402  41.7%  3554 3516s
  4550  2716 30250.4305   40  439 25684.9704 36394.4402  41.7%  3553 3522s
  4551  2717 26333.2301   72  499 25684.9704 36394.4402  41.7%  3553 3529s
  4552  2718 29140.8900   40  469 25684.9704 36394.4402  41.7%  3552 3553s
  4553  2718 29535.0535   32  457 25684.9704 36394.4402  41.7%  3551 3558s
  4554  2719 29802.3054   38  468 25684.9704 36394.4402  41.7%  3550 3561s
  4555  2720 27799.4530   47  466 25684.9704 36394.4402  41.7%  3550 3565s
  4556  2720 27281.3708   36  407 25684.9704 36394.4402  41.7%  3549 3574s
  4557  2721 36000.2813   11  414 25684.9704 36394.4402  41.7%  3548 3581s
  4558  2722 26960.1014   32  478 25684.9704 36394.4402  41.7%  3547 3593s
  4559  2722 34421.7952   17  463 25684.9704 36394.4402  41.7%  3546 3599s

Cutting planes:
  MIR: 179
  Flow cover: 918
  RLT: 18
  Relax-and-lift: 100

Explored 4559 nodes (17128635 simplex iterations) in 3600.08 seconds (5352.90 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25685 25673 25476.4 ... 10211.2

Time limit reached
Best objective 2.568497039702e+04, best bound 3.639444023883e+04, gap 41.6955%
  WARNING: Time limit reached. Using best solution found (gap: 41.70%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 25684.97, θ = 172270.94
  Upper Bound (UB) = 25684.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172270.94
  [DEBUG]   ✓ Scenario 0: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172270.94 ≤ Q = 172270.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172270.94 ≤ Q = 172270.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172270.94 ≤ Q = 172270.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 172270.94 ≤ Q = 172270.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 172270.94 ≤ Q = 172270.94 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4525053
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfbadafad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426390e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.01s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 6856563.3827
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.576430e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157642.97    0  124 6856563.38 -157642.97   102%     -    0s
H    0     0                    -122450.2332 -157642.97  28.7%     -    0s
H    0     0                    -122713.4858 -157642.97  28.5%     -    0s
H    0     0                    -122871.8401 -139801.66  13.8%     -    0s
H    0     0                    -123028.4264 -139801.66  13.6%     -    0s
H    0     0                    -132409.1246 -139801.66  5.58%     -    0s
     0     0 -139801.66    0  104 -132409.12 -139801.66  5.58%     -    0s
H    0     0                    -135674.9102 -139722.45  2.98%     -    0s
H    0     0                    -137022.0984 -139722.45  1.97%     -    0s
     0     0 -138520.40    0  106 -137022.10 -138520.40  1.09%     -    0s
     0     0 -138444.36    0   96 -137022.10 -138444.36  1.04%     -    0s
     0     0 -138360.58    0  107 -137022.10 -138360.58  0.98%     -    0s
     0     0 -138360.58    0  107 -137022.10 -138360.58  0.98%     -    0s
     0     0 -137800.30    0   54 -137022.10 -137800.30  0.57%     -    0s
     0     0 -137505.04    0   73 -137022.10 -137505.04  0.35%     -    0s
     0     0 -137504.83    0   62 -137022.10 -137504.83  0.35%     -    0s
     0     0 -137491.97    0   58 -137022.10 -137491.97  0.34%     -    0s
     0     0 -137259.39    0   44 -137022.10 -137259.39  0.17%     -    0s
     0     0 -137249.79    0   36 -137022.10 -137249.79  0.17%     -    0s
     0     0 -137192.54    0   31 -137022.10 -137192.54  0.12%     -    0s
     0     0 -137192.54    0   44 -137022.10 -137192.54  0.12%     -    0s
     0     0 -137192.54    0   44 -137022.10 -137192.54  0.12%     -    0s
     0     0 -137192.54    0   38 -137022.10 -137192.54  0.12%     -    0s
H    0     0                    -137043.2058 -137192.54  0.11%     -    0s
     0     0 -137134.13    0   22 -137043.21 -137134.13  0.07%     -    0s
     0     0 -137109.18    0    5 -137043.21 -137109.18  0.05%     -    0s
     0     0 -137106.89    0    5 -137043.21 -137106.89  0.05%     -    0s
     0     0 -137069.89    0    2 -137043.21 -137069.89  0.02%     -    0s
H    0     0                    -137069.2380 -137069.24  0.00%     -    0s

Cutting planes:
  Gomory: 13
  MIR: 26
  Flow cover: 11
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (1077 simplex iterations) in 0.13 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -137069 -137043 -137022 ... -122450
No other solutions better than -137069

Optimal solution found (tolerance 1.00e-06)
Best objective -1.370692379831e+05, best bound -1.370692379831e+05, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 162078.57
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137069.24
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -137069.24 = 162078.57
  [DEBUG]   Current θ from Master = 172270.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10192.37 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15492.60
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 831.2885, Absolute Gap = 831.2885, Relative Gap = 0.032365
  Not converged yet (gap = 831.29 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x47eb9560
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 99420 rows and 40400 columns
Presolve time: 4.80s
Presolved: 116023 rows, 49220 columns, 700139 nonzeros
Variable types: 46961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -350500.7547
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 623
 AA' NZ     : 4.467e+06
 Factor NZ  : 1.078e+07 (roughly 150 MB of memory)
 Factor Ops : 2.219e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82854642e+07  2.22436642e+08  1.13e+05 1.59e+01  8.08e+04     7s
   1  -1.38516490e+07  1.96444025e+08  7.86e+04 7.14e+01  5.56e+04     7s
   2  -4.70772094e+06  1.51080851e+08  2.66e+04 5.38e-01  1.99e+04     7s
   3  -1.11471417e+06  1.11760618e+08  2.88e+03 1.22e+00  2.54e+03     7s
   4  -5.96292625e+05  6.49337038e+07  6.00e+02 4.00e-01  6.94e+02     7s
   5  -5.68854098e+05  3.28971751e+07  4.69e+02 1.49e-01  4.21e+02     7s
   6  -3.89196357e+05  2.51150754e+07  1.51e+02 1.02e-01  2.00e+02     7s
   7  -2.70373316e+05  1.72740009e+07  6.19e+01 6.29e-02  1.11e+02     8s
   8  -1.49278513e+05  1.10783264e+07  1.91e+01 3.65e-02  5.97e+01     8s
   9  -8.53422424e+04  6.40662915e+06  6.46e+00 2.00e-02  3.20e+01     8s
  10  -6.99008284e+04  2.20905417e+06  4.32e+00 6.27e-03  1.11e+01     8s
  11  -4.22887805e+04  1.49526334e+06  2.38e+00 4.18e-03  7.40e+00     8s
  12  -1.65799472e+04  7.46263903e+05  1.32e+00 1.93e-03  3.64e+00     8s
  13  -1.07812888e+04  4.87947642e+05  1.04e+00 1.32e-03  2.37e+00     8s
  14   5.78731367e+03  1.91479987e+05  4.57e-01 7.05e-04  8.80e-01     8s
  15   1.16103492e+04  1.59410268e+05  3.73e-01 7.58e-04  7.00e-01     8s
  16   1.74904345e+04  1.21667953e+05  3.03e-01 1.91e-03  4.93e-01     8s
  17   2.23013339e+04  1.07944810e+05  2.57e-01 1.34e-03  4.05e-01     9s
  18   2.69759173e+04  1.00897231e+05  2.10e-01 1.63e-03  3.50e-01     9s
  19   3.12045472e+04  8.71533654e+04  1.72e-01 1.50e-03  2.65e-01     9s
  20   3.77363140e+04  7.87570662e+04  1.25e-01 1.66e-03  1.94e-01     9s
  21   3.90948217e+04  7.20133595e+04  1.15e-01 1.60e-03  1.56e-01     9s
  22   4.23912923e+04  6.92303766e+04  9.20e-02 1.39e-03  1.27e-01     9s
  23   4.47336915e+04  6.46684091e+04  7.61e-02 1.35e-03  9.43e-02     9s
  24   4.66709798e+04  6.36556531e+04  6.30e-02 1.41e-03  8.04e-02     9s
  25   4.88115737e+04  6.20286493e+04  4.89e-02 1.36e-03  6.25e-02     9s
  26   4.98733393e+04  6.05201620e+04  4.23e-02 1.51e-03  5.04e-02    10s
  27   5.16115282e+04  6.00632894e+04  3.14e-02 1.12e-03  4.00e-02    10s
  28   5.27812511e+04  5.95520398e+04  2.44e-02 1.00e-03  3.20e-02    10s
  29   5.37666579e+04  5.86254114e+04  1.84e-02 1.32e-03  2.30e-02    10s
  30   5.42018899e+04  5.84772822e+04  1.57e-02 1.31e-03  2.02e-02    10s
  31   5.46079765e+04  5.80592544e+04  1.32e-02 9.77e-04  1.63e-02    10s
  32   5.50929863e+04  5.79237858e+04  1.04e-02 9.30e-04  1.34e-02    10s
  33   5.55392953e+04  5.77043736e+04  7.79e-03 7.20e-04  1.02e-02    10s
  34   5.57231958e+04  5.73910350e+04  6.74e-03 4.00e-04  7.89e-03    10s
  35   5.58700199e+04  5.72690117e+04  5.89e-03 2.90e-04  6.62e-03    11s
  36   5.61583664e+04  5.71961301e+04  4.24e-03 2.45e-04  4.91e-03    11s
  37   5.62986251e+04  5.70441340e+04  3.46e-03 1.34e-04  3.53e-03    11s
  38   5.65540741e+04  5.70210481e+04  1.99e-03 7.28e-05  2.21e-03    11s
  39   5.66045563e+04  5.69951861e+04  1.71e-03 5.54e-05  1.85e-03    11s
  40   5.66755217e+04  5.69916059e+04  1.35e-03 5.07e-05  1.50e-03    11s
  41   5.68140679e+04  5.69709336e+04  6.24e-04 2.92e-05  7.42e-04    11s
  42   5.68666985e+04  5.69499957e+04  3.46e-04 8.65e-06  3.94e-04    12s
  43   5.68955697e+04  5.69469720e+04  2.04e-04 5.44e-06  2.43e-04    12s
  44   5.69097894e+04  5.69450591e+04  1.38e-04 3.88e-06  1.67e-04    12s
  45   5.69157036e+04  5.69415891e+04  1.10e-04 1.09e-06  1.23e-04    12s
  46   5.69337851e+04  5.69399932e+04  2.50e-05 1.71e-07  2.94e-05    12s
  47   5.69371784e+04  5.69395719e+04  9.76e-06 3.32e-06  1.13e-05    12s
  48   5.69393419e+04  5.69395198e+04  6.84e-07 4.18e-07  8.42e-07    12s
  49   5.69395104e+04  5.69395105e+04  4.88e-10 4.11e-10  5.14e-10    12s

Barrier solved model in 49 iterations and 12.44 seconds (10.06 work units)
Optimal objective 5.69395104e+04


Root crossover log...

   99658 DPushes remaining with DInf 0.0000000e+00                12s
    1428 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                15s

    5513 PPushes remaining with PInf 4.7349674e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                16s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0872446e+02     16s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48963    5.6939510e+04   0.000000e+00   1.087245e+02     16s
   48973    5.6939510e+04   0.000000e+00   0.000000e+00     16s
   48973    5.6939510e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 5.693951e+04, 48973 iterations, 10.27 seconds (11.59 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56939.5105    0  245 -239613.87 56939.5105   124%     -   16s
H    0     0                    -234932.3201 56939.5105   124%     -   16s
H    0     0                    -180353.0664 56939.5105   132%     -   17s
H    0     0                    -180242.6210 56939.5105   132%     -   17s
H    0     0                    -161274.4418 56939.5105   135%     -   17s
H    0     0                    -148595.5414 56939.5105   138%     -   18s
H    0     0                    -140835.0685 56939.5105   140%     -   18s
H    0     0                    -91556.43265 56939.5105   162%     -   18s
H    0     0                    -91374.03776 56939.5105   162%     -   19s
H    0     0                    -25079.50413 56939.5105   327%     -   19s
H    0     0                    -12639.74595 56939.5105   550%     -   19s
H    0     0                    -12500.95324 56939.5105   555%     -   19s
     0     0 50199.2926    0  293 -12500.953 50199.2926   502%     -   50s
H    0     0                    -2347.056860 50196.7822  2239%     -   51s
H    0     0                     851.1301645 50196.7822  5798%     -   52s
H    0     0                     937.3937009 50196.7822  5255%     -   52s
H    0     0                    1077.4114947 50196.7822  4559%     -   52s
H    0     0                    1239.6975991 50196.7822  3949%     -   52s
H    0     0                    10424.692214 49563.1313   375%     -   73s
H    0     0                    10695.234992 49563.1313   363%     -   73s
H    0     0                    10885.406992 49563.1313   355%     -   73s
H    0     0                    11494.268097 49563.1313   331%     -   73s
     0     0 49563.1313    0  315 11494.2681 49563.1313   331%     -   73s
     0     0 49488.9130    0  363 11494.2681 49488.9130   331%     -   82s
     0     0 49207.3928    0  347 11494.2681 49207.3928   328%     -   93s
     0     0 49119.3152    0  303 11494.2681 49119.3152   327%     -   97s
     0     0 49117.5526    0  360 11494.2681 49117.5526   327%     -  100s
     0     0 49116.4147    0  365 11494.2681 49116.4147   327%     -  104s
     0     0 48806.0649    0  371 11494.2681 48806.0649   325%     -  125s
     0     0 48769.3497    0  409 11494.2681 48769.3497   324%     -  132s
     0     0 48756.2132    0  402 11494.2681 48756.2132   324%     -  135s
     0     0 48751.1272    0  403 11494.2681 48751.1272   324%     -  136s
     0     0 48749.9925    0  403 11494.2681 48749.9925   324%     -  137s
     0     0 48749.9925    0  403 11494.2681 48749.9925   324%     -  137s
H    0     0                    13992.960487 44849.5565   221%     -  198s
H    0     0                    14405.690825 44849.5565   211%     -  198s
H    0     0                    14678.214926 44849.5565   206%     -  198s
     0     0 44849.5565    0  390 14678.2149 44849.5565   206%     -  198s
H    0     0                    20810.007138 44849.2002   116%     -  199s
H    0     0                    20953.416739 44849.2002   114%     -  199s
     0     0 44077.8285    0  417 20953.4167 44077.8285   110%     -  226s
     0     0 43805.0754    0  416 20953.4167 43805.0754   109%     -  245s
     0     0 43667.3351    0  389 20953.4167 43667.3351   108%     -  262s
     0     0 43616.8539    0  407 20953.4167 43616.8539   108%     -  270s
     0     0 43605.2134    0  407 20953.4167 43605.2134   108%     -  274s
     0     0 43597.0713    0  405 20953.4167 43597.0713   108%     -  277s
     0     0 43583.0333    0  411 20953.4167 43583.0333   108%     -  281s
     0     0 43572.6756    0  410 20953.4167 43572.6756   108%     -  284s
     0     0 43554.9113    0  410 20953.4167 43554.9113   108%     -  289s
     0     0 43553.9744    0  413 20953.4167 43553.9744   108%     -  291s
     0     0 41361.4513    0  362 20953.4167 41361.4513  97.4%     -  368s
H    0     0                    21035.502676 41361.3925  96.6%     -  369s
     0     0 40764.3312    0  384 21035.5027 40764.3312  93.8%     -  407s
H    0     0                    21058.727037 40606.0684  92.8%     -  427s
H    0     0                    21408.574083 40606.0684  89.7%     -  427s
H    0     0                    21766.843860 40606.0684  86.6%     -  427s
H    0     0                    21975.225429 40606.0684  84.8%     -  427s
H    0     0                    22050.990125 40606.0684  84.1%     -  427s
     0     0 40606.0684    0  449 22050.9901 40606.0684  84.1%     -  427s
     0     0 40540.4545    0  397 22050.9901 40540.4545  83.8%     -  438s
     0     0 40500.4163    0  419 22050.9901 40500.4163  83.7%     -  447s
     0     0 40476.6566    0  394 22050.9901 40476.6566  83.6%     -  454s
H    0     0                    24667.615683 40416.5882  63.8%     -  466s
     0     0 40416.5882    0  395 24667.6157 40416.5882  63.8%     -  466s
H    0     0                    24946.373833 40381.6217  61.9%     -  475s
H    0     0                    25636.614269 40381.6217  57.5%     -  475s
     0     0 40381.6217    0  384 25636.6143 40381.6217  57.5%     -  475s
     0     0 40370.1639    0  405 25636.6143 40370.1639  57.5%     -  481s
     0     0 40362.5949    0  408 25636.6143 40362.5949  57.4%     -  485s
     0     0 40336.6798    0  391 25636.6143 40336.6798  57.3%     -  491s
     0     0 40328.2358    0  411 25636.6143 40328.2358  57.3%     -  496s
     0     0 40327.4296    0  416 25636.6143 40327.4296  57.3%     -  498s
     0     0 39496.8527    0  425 25636.6143 39496.8527  54.1%     -  562s
     0     0 39169.4355    0  428 25636.6143 39169.4355  52.8%     -  603s
     0     0 39102.8895    0  446 25636.6143 39102.8895  52.5%     -  616s
     0     0 39084.8639    0  398 25636.6143 39084.8639  52.5%     -  623s
     0     0 39057.9153    0  446 25636.6143 39057.9153  52.4%     -  632s
     0     0 39039.8794    0  395 25636.6143 39039.8794  52.3%     -  637s
     0     0 39031.8374    0  397 25636.6143 39031.8374  52.3%     -  640s
     0     0 38999.0903    0  442 25636.6143 38999.0903  52.1%     -  649s
     0     0 38991.7585    0  433 25636.6143 38991.7585  52.1%     -  654s
     0     0 38988.1259    0  445 25636.6143 38988.1259  52.1%     -  658s
     0     0 38985.5575    0  446 25636.6143 38985.5575  52.1%     -  660s
     0     0 38860.0388    0  429 25636.6143 38860.0388  51.6%     -  677s
     0     0 38839.7996    0  398 25636.6143 38839.7996  51.5%     -  685s
     0     0 38832.8942    0  395 25636.6143 38832.8942  51.5%     -  690s
     0     0 38830.7743    0  401 25636.6143 38830.7743  51.5%     -  693s
     0     0 38792.7798    0  444 25636.6143 38792.7798  51.3%     -  705s
     0     0 38774.6771    0  441 25636.6143 38774.6771  51.2%     -  717s
     0     0 38755.0228    0  391 25636.6143 38755.0228  51.2%     -  722s
     0     0 38740.2247    0  370 25636.6143 38740.2247  51.1%     -  727s
     0     0 38730.2141    0  385 25636.6143 38730.2141  51.1%     -  730s
     0     0 38727.2665    0  383 25636.6143 38727.2665  51.1%     -  733s
     0     0 38720.4582    0  421 25636.6143 38720.4582  51.0%     -  738s
     0     0 38719.9320    0  430 25636.6143 38719.9320  51.0%     -  739s
     0     0 38665.9524    0  437 25636.6143 38665.9524  50.8%     -  750s
     0     0 38650.3239    0  386 25636.6143 38650.3239  50.8%     -  756s
     0     0 38643.1805    0  438 25636.6143 38643.1805  50.7%     -  759s
     0     0 38638.2579    0  437 25636.6143 38638.2579  50.7%     -  762s
     0     0 38636.6575    0  443 25636.6143 38636.6575  50.7%     -  763s
     0     0 38617.6948    0  452 25636.6143 38617.6948  50.6%     -  774s
     0     0 38605.5645    0  444 25636.6143 38605.5645  50.6%     -  783s
     0     0 38600.1505    0  444 25636.6143 38600.1505  50.6%     -  788s
     0     0 38598.3192    0  398 25636.6143 38598.3192  50.6%     -  796s
     0     0 38581.2203    0  451 25636.6143 38581.2203  50.5%     -  804s
     0     0 38566.9408    0  443 25636.6143 38566.9408  50.4%     -  808s
     0     0 38563.3153    0  442 25636.6143 38563.3153  50.4%     -  812s
     0     0 38555.3260    0  450 25636.6143 38555.3260  50.4%     -  816s
     0     0 38553.5749    0  459 25636.6143 38553.5749  50.4%     -  819s
     0     0 38548.6474    0  402 25636.6143 38548.6474  50.4%     -  824s
     0     0 38545.7933    0  399 25636.6143 38545.7933  50.4%     -  829s
     0     0 38543.1093    0  449 25636.6143 38543.1093  50.3%     -  830s
     0     0 38536.2417    0  395 25636.6143 38536.2417  50.3%     -  837s
     0     0 38532.9249    0  458 25636.6143 38532.9249  50.3%     -  842s
     0     0 38527.5308    0  453 25636.6143 38527.5308  50.3%     -  845s
     0     0 38525.7741    0  453 25636.6143 38525.7741  50.3%     -  847s
     0     0 38521.6298    0  408 25636.6143 38521.6298  50.3%     -  852s
     0     0 38521.6214    0  408 25636.6143 38521.6214  50.3%     -  857s
H    0     0                    25663.612218 38521.6205  50.1%     - 1059s
     0     2 38521.6205    0  408 25663.6122 38521.6205  50.1%     - 1073s
     1     4 38495.4605    1  375 25663.6122 38521.6205  50.1%  5152 1082s
     3     8 38306.1913    2  380 25663.6122 38495.3559  50.0%  6839 1103s
     7    15 38154.6879    3  446 25663.6122 38304.0332  49.3% 10617 1157s
    14    30 37971.0792    4  441 25663.6122 38153.6621  48.7% 14053 1179s
    29    45 37607.4373    5  444 25663.6122 37970.9481  48.0% 16681 1257s
    44    70 34895.2940    6  251 25663.6122 37970.9481  48.0% 19716 1454s
    69   134 36414.7308    6  409 25663.6122 37769.3668  47.2% 20935 1514s
   133   181 36381.6273    7  395 25663.6122 37769.3668  47.2% 15224 1555s
   181   224 34433.5878   10  268 25663.6122 37769.3668  47.2% 14032 1601s
   242   269 36265.7066    9  397 25663.6122 37769.3668  47.2% 12598 1646s
   305   295 35415.1692   10  394 25663.6122 37769.3668  47.2% 11930 1683s
   358   325 35219.6612   11  381 25663.6122 37769.3668  47.2% 11804 1723s
   413   353 35215.8085   12  363 25663.6122 37769.3668  47.2% 11905 1760s
   477   393 35205.9291   13  358 25663.6122 37769.3668  47.2% 11776 1797s
   545   440 34892.5944   15  363 25663.6122 37769.3668  47.2% 11373 1831s
   628   505 34406.9287   17  304 25663.6122 37769.3668  47.2% 11054 1864s
   713   532 32335.1406   18  230 25663.6122 37769.3668  47.2% 10467 1894s
   761   570 29676.8553   19  338 25663.6122 37769.3668  47.2% 10366 1924s
   824   601 29616.5883   20  332 25663.6122 37769.3668  47.2% 10109 1949s
   909   610 25952.8515   48  117 25663.6122 37769.3668  47.2%  9595 1976s
   956   648 29350.9652   22  337 25663.6122 37769.3668  47.2%  9383 2001s
  1026   676 28083.4674   24  325 25663.6122 37769.3668  47.2%  9268 2031s
  1114   730 27727.9570   27  311 25663.6122 37769.3668  47.2%  9165 2062s
  1219   785 27681.3702   31  322 25663.6122 37769.3668  47.2%  8901 2091s
  1328   818 27391.2651   36  313 25663.6122 37769.3668  47.2%  8571 2125s
  1437   862 27104.7438   39  273 25663.6122 37769.3668  47.2%  8289 2157s
  1529   909 26433.5264   44  244 25663.6122 37769.3668  47.2%  8259 2195s
  1626   970 26023.9885   49  212 25663.6122 37769.3668  47.2%  8259 2233s
  1734  1019 34208.9402   13  356 25663.6122 37769.3668  47.2%  8240 2272s
  1853  1079 33514.6953   15  238 25663.6122 37769.3668  47.2%  8145 2310s
  1967  1119 31674.6757   17  348 25663.6122 37769.3668  47.2%  8180 2357s
  2080  1157 31044.8395   19  205 25663.6122 37769.3668  47.2%  8165 2401s
  2174  1172     cutoff   21      25663.6122 37769.3668  47.2%  8257 2441s
  2271  1221 29289.1810   21  266 25663.6122 37769.3668  47.2%  8268 2491s
  2361  1269 infeasible   21      25663.6122 37769.3668  47.2%  8385 2541s
  2455  1303 31133.6546   12  209 25663.6122 37769.3668  47.2%  8516 2594s
  2565  1365 27135.1139   14  273 25663.6122 37769.3668  47.2%  8538 2647s
  2679  1409 25949.4566   17  223 25663.6122 37769.3668  47.2%  8580 2703s
  2799  1420 infeasible   20      25663.6122 37769.3668  47.2%  8628 2761s
  2906  1451 32448.4157   11  301 25663.6122 37769.3668  47.2%  8703 2824s
  2989  1494 32422.3795   12  246 25663.6122 37769.3668  47.2%  8750 2937s
  3074  1577 30553.8072   14  317 25663.6122 37769.3668  47.2%  8865 2996s
  3193  1666 27945.3966   19  136 25663.6122 37769.3668  47.2%  8972 3065s
  3376  1753 35340.4565   12  302 25663.6122 37239.4969  45.1%  8956 3129s
  3574  1833 30009.1448   14  267 25663.6122 37239.4969  45.1%  8914 3195s
  3770  1898 27622.3855   16  262 25663.6122 37171.7653  44.8%  8914 3265s
  3999  1938 26451.6945   22  222 25663.6122 36853.7441  43.6%  8831 3333s
  4149  1973 infeasible   11      25663.6122 36853.7441  43.6%  8800 3404s
  4268  2023 30051.7806   13  269 25663.6122 36853.7441  43.6%  8885 3468s
  4338  2072 29040.7842   17  249 25663.6122 36853.7441  43.6%  9011 3536s
  4459  2085 infeasible   23      25663.6122 36853.7441  43.6%  9017 3600s

Cutting planes:
  Learned: 5
  Gomory: 25
  Implied bound: 304
  MIR: 2629
  Flow cover: 3675
  RLT: 135
  Relax-and-lift: 1232

Explored 4562 nodes (41976385 simplex iterations) in 3600.08 seconds (6022.92 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25663.6 25636.6 24946.4 ... 21035.5

Time limit reached
Best objective 2.566361221819e+04, best bound 3.605330962383e+04, gap 40.4842%
  WARNING: Time limit reached. Using best solution found (gap: 40.48%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 25663.61, θ = 173340.60
  Upper Bound (UB) = 25663.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173340.60
  [DEBUG]   ✓ Scenario 0: θ = 173340.60 ≤ Q = 173340.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173340.60 ≤ Q = 173340.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173340.60 ≤ Q = 173340.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173340.60 ≤ Q = 173340.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173340.60 ≤ Q = 173340.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173340.60 ≤ Q = 173340.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173340.60 ≤ Q = 173340.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173340.60 ≤ Q = 173340.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173340.60 ≤ Q = 173340.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173340.60 ≤ Q = 173340.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 173340.60 ≤ Q = 173340.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 173340.60 ≤ Q = 173340.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 173340.60 ≤ Q = 173340.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 173340.60 ≤ Q = 173340.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7c9a8a79
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7c9a8a79
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.433632e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6848840.7625
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.565584e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156558.40    0  124 6848840.76 -156558.40   102%     -    0s
H    0     0                    -121470.9543 -156558.40  28.9%     -    0s
H    0     0                    -121734.2068 -156558.40  28.6%     -    0s
     0     0 -137040.99    0   68 -121734.21 -137040.99  12.6%     -    0s
H    0     0                    -134760.6763 -136948.97  1.62%     -    0s
H    0     0                    -135122.0677 -136948.97  1.35%     -    0s
H    0     0                    -135430.5697 -136948.97  1.12%     -    0s
H    0     0                    -135434.2256 -136179.42  0.55%     -    0s
     0     0 -136179.42    0   53 -135434.23 -136179.42  0.55%     -    0s
H    0     0                    -135463.4087 -136118.20  0.48%     -    0s
     0     0 -135879.87    0   29 -135463.41 -135879.87  0.31%     -    0s
     0     0 -135877.34    0   29 -135463.41 -135877.34  0.31%     -    0s
     0     0 -135557.59    0   18 -135463.41 -135557.59  0.07%     -    0s
     0     0 -135547.15    0   16 -135463.41 -135547.15  0.06%     -    0s
     0     0 -135543.59    0   16 -135463.41 -135543.59  0.06%     -    0s
     0     0 -135542.88    0   16 -135463.41 -135542.88  0.06%     -    0s
     0     0 -135509.36    0    9 -135463.41 -135509.36  0.03%     -    0s
     0     0 -135506.89    0    9 -135463.41 -135506.89  0.03%     -    0s
     0     0 -135481.39    0    3 -135463.41 -135481.39  0.01%     -    0s
     0     0 -135479.16    0    3 -135463.41 -135479.16  0.01%     -    0s
H    0     0                    -135472.7217 -135479.16  0.00%     -    0s
*    0     0               0    -135477.9916 -135477.99  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  Flow cover: 3
  Relax-and-lift: 1

Explored 1 nodes (599 simplex iterations) in 0.12 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -135478 -135473 -135463 ... 1.43363e+13
No other solutions better than -135478

Optimal solution found (tolerance 1.00e-06)
Best objective -1.354779916483e+05, best bound -1.354779916483e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 163669.82
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135477.99
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -135477.99 = 163669.82
  [DEBUG]   Current θ from Master = 173340.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9670.78 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15992.84
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 809.9303, Absolute Gap = 809.9303, Relative Gap = 0.031559
  Not converged yet (gap = 809.93 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0xee35a520
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106514 rows and 43282 columns (presolve time = 5s)...
Presolve removed 106514 rows and 43282 columns
Presolve time: 5.65s
Presolved: 124219 rows, 52578 columns, 766186 nonzeros
Variable types: 50319 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.45s

Barrier statistics:
 Dense cols : 657
 AA' NZ     : 5.478e+06
 Factor NZ  : 1.239e+07 (roughly 170 MB of memory)
 Factor Ops : 2.737e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82683021e+07  2.36375190e+08  1.15e+05 1.82e+01  8.05e+04     8s
   1  -1.39127761e+07  2.07188751e+08  7.93e+04 6.56e+01  5.52e+04     8s
   2  -4.77052938e+06  1.52606471e+08  2.65e+04 7.74e-01  1.96e+04     8s
   3  -1.06980131e+06  1.08539218e+08  3.27e+03 1.53e+00  2.75e+03     8s
   4  -5.79827284e+05  5.88216196e+07  6.80e+02 6.12e-01  6.92e+02     8s
   5  -4.69299117e+05  3.27014549e+07  3.04e+02 2.45e-01  3.19e+02     9s
   6  -3.53212441e+05  2.47909350e+07  9.16e+01 1.71e-01  1.59e+02     9s
   7  -2.45344537e+05  1.80256494e+07  2.59e+01 1.16e-01  9.25e+01     9s
   8  -1.42910788e+05  1.26734841e+07  8.05e+00 7.87e-02  5.94e+01     9s
   9  -1.04644918e+05  4.95672970e+06  3.76e+00 2.88e-02  2.29e+01     9s
  10  -9.04623609e+04  2.36848865e+06  2.38e+00 1.34e-02  1.10e+01     9s
  11  -6.89422415e+04  9.61331536e+05  1.16e+00 5.30e-03  4.59e+00     9s
  12  -3.85396405e+04  4.61065859e+05  5.09e-01 2.48e-03  2.21e+00     9s
  13  -1.44714729e+04  2.65713128e+05  2.87e-01 1.47e-03  1.24e+00     9s
  14   1.24131886e+02  2.18997628e+05  1.94e-01 1.19e-03  9.67e-01     9s
  15   6.81952122e+03  1.70448663e+05  1.65e-01 1.20e-03  7.23e-01     9s
  16   1.33839801e+04  1.29260168e+05  1.36e-01 1.40e-03  5.12e-01    10s
  17   1.81748022e+04  1.14164149e+05  1.17e-01 1.38e-03  4.24e-01    10s
  18   2.36109389e+04  9.79923866e+04  9.49e-02 1.64e-03  3.29e-01    10s
  19   2.86283065e+04  8.07494663e+04  7.46e-02 1.54e-03  2.30e-01    10s
  20   3.20295609e+04  7.24106724e+04  6.27e-02 1.66e-03  1.79e-01    10s
  21   3.53763236e+04  6.88280687e+04  5.13e-02 1.49e-03  1.48e-01    10s
  22   3.76013468e+04  6.40672038e+04  4.40e-02 1.54e-03  1.17e-01    10s
  23   3.95406736e+04  6.13802354e+04  3.80e-02 1.25e-03  9.66e-02    10s
  24   4.26230443e+04  5.90183579e+04  2.88e-02 1.49e-03  7.26e-02    10s
  25   4.42502776e+04  5.79814220e+04  2.40e-02 1.38e-03  6.08e-02    10s
  26   4.63311186e+04  5.69517599e+04  1.78e-02 1.06e-03  4.70e-02    11s
  27   4.69898925e+04  5.49573635e+04  1.59e-02 4.73e-04  3.53e-02    11s
  28   4.83374777e+04  5.46397438e+04  1.23e-02 3.99e-04  2.79e-02    11s
  29   4.92718798e+04  5.41366014e+04  9.59e-03 2.85e-04  2.15e-02    11s
  30   4.96230395e+04  5.37752472e+04  8.62e-03 2.07e-04  1.84e-02    11s
  31   5.01994241e+04  5.34753203e+04  7.08e-03 1.42e-04  1.45e-02    11s
  32   5.04022252e+04  5.33693056e+04  6.55e-03 1.23e-04  1.31e-02    11s
  33   5.05541705e+04  5.33301701e+04  6.13e-03 1.14e-04  1.23e-02    12s
  34   5.07910630e+04  5.32578298e+04  5.53e-03 9.44e-05  1.09e-02    12s
  35   5.11480723e+04  5.31344393e+04  4.55e-03 6.36e-05  8.80e-03    12s
  36   5.15382730e+04  5.31213704e+04  3.49e-03 6.05e-05  7.01e-03    12s
  37   5.17739990e+04  5.30486810e+04  2.87e-03 1.15e-04  5.65e-03    12s
  38   5.21021058e+04  5.29872897e+04  1.98e-03 6.37e-05  3.92e-03    12s
  39   5.24602698e+04  5.29713975e+04  1.01e-03 5.56e-05  2.26e-03    12s
  40   5.26058139e+04  5.28997749e+04  6.29e-04 3.70e-05  1.30e-03    12s
  41   5.27279706e+04  5.28764470e+04  3.16e-04 1.25e-05  6.58e-04    13s
  42   5.28344811e+04  5.28667963e+04  5.88e-05 3.30e-06  1.43e-04    13s
  43   5.28579841e+04  5.28616761e+04  6.69e-06 1.24e-07  1.63e-05    13s
  44   5.28613305e+04  5.28613394e+04  7.63e-08 6.58e-07  3.94e-08    13s
  45   5.28613309e+04  5.28613394e+04  5.38e-06 6.57e-07  3.52e-08    13s
  46   5.28613332e+04  5.28613379e+04  3.20e-06 2.14e-07  1.82e-08    13s
  47   5.28613371e+04  5.28613373e+04  2.60e-07 1.18e-07  6.96e-10    13s

Barrier solved model in 47 iterations and 13.24 seconds (11.20 work units)
Optimal objective 5.28613371e+04


Root crossover log...

  113568 DPushes remaining with DInf 0.0000000e+00                13s
   27665 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

    5233 PPushes remaining with PInf 4.9447589e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.7042666e+00     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62310    5.2861337e+04   0.000000e+00   3.704267e+00     20s
   62332    5.2861337e+04   0.000000e+00   0.000000e+00     20s
   62332    5.2861337e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 0.07s

Solved with barrier

Root relaxation: objective 5.286134e+04, 62332 iterations, 13.63 seconds (17.30 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52861.3373    0   94 -239613.87 52861.3373   122%     -   21s
H    0     0                    -212336.4913 52861.3373   125%     -   21s
H    0     0                    -189893.4088 52861.3373   128%     -   21s
H    0     0                    -169057.4849 52861.3373   131%     -   22s
H    0     0                    -167395.2926 52861.3373   132%     -   22s
H    0     0                    -166018.6994 52861.3373   132%     -   22s
H    0     0                    -165997.1099 52861.3373   132%     -   22s
H    0     0                    -56472.32618 52861.3373   194%     -   22s
H    0     0                    -56146.20082 52861.3373   194%     -   23s
H    0     0                    -4372.852597 52861.3373  1309%     -   23s
H    0     0                    23107.442155 52861.3373   129%     -   23s
H    0     0                    24093.071975 52861.3373   119%     -   24s
H    0     0                    24284.967787 52861.3373   118%     -   24s
H    0     0                    25011.859949 52861.3373   111%     -   24s
H    0     0                    25147.019562 52861.3373   110%     -   26s
H    0     0                    25340.774428 47350.6347  86.9%     -   83s
H    0     0                    25348.544636 47350.6347  86.8%     -   83s
H    0     0                    25424.829677 47350.6347  86.2%     -   83s
     0     0 47345.8306    0  123 25424.8297 47345.8306  86.2%     -   84s
     0     0 46943.2361    0  251 25424.8297 46943.2361  84.6%     -  112s
     0     0 46832.0781    0  251 25424.8297 46832.0781  84.2%     -  127s
     0     0 46832.0781    0  250 25424.8297 46832.0781  84.2%     -  128s
     0     0 46832.0781    0  249 25424.8297 46832.0781  84.2%     -  129s
     0     0 46832.0781    0  249 25424.8297 46832.0781  84.2%     -  129s
     0     0 44277.2590    0  240 25424.8297 44277.2590  74.1%     -  173s
     0     0 43923.4769    0  274 25424.8297 43923.4769  72.8%     -  193s
     0     0 43879.6498    0  248 25424.8297 43879.6498  72.6%     -  203s
     0     0 43815.3987    0  244 25424.8297 43815.3987  72.3%     -  212s
     0     0 43809.3625    0  245 25424.8297 43809.3625  72.3%     -  217s
     0     0 43759.9330    0  247 25424.8297 43759.9330  72.1%     -  224s
     0     0 43745.1402    0  244 25424.8297 43745.1402  72.1%     -  228s
     0     0 43696.7675    0  240 25424.8297 43696.7675  71.9%     -  237s
     0     0 43610.0501    0  287 25424.8297 43610.0501  71.5%     -  245s
     0     0 43604.6835    0  287 25424.8297 43604.6835  71.5%     -  247s
     0     0 43532.3820    0  250 25424.8297 43532.3820  71.2%     -  253s
     0     0 43520.9627    0  306 25424.8297 43520.9627  71.2%     -  257s
     0     0 43518.6210    0  301 25424.8297 43518.6210  71.2%     -  259s
     0     0 43454.3660    0  308 25424.8297 43454.3660  70.9%     -  268s
     0     0 43450.6954    0  314 25424.8297 43450.6954  70.9%     -  272s
     0     0 43417.9379    0  309 25424.8297 43417.9379  70.8%     -  277s
     0     0 43407.5085    0  310 25424.8297 43407.5085  70.7%     -  282s
     0     0 43394.5318    0  308 25424.8297 43394.5318  70.7%     -  285s
     0     0 43391.8903    0  308 25424.8297 43391.8903  70.7%     -  286s
     0     0 43387.5276    0  311 25424.8297 43387.5276  70.7%     -  290s
     0     0 43383.6373    0  308 25424.8297 43383.6373  70.6%     -  291s
     0     0 43382.9697    0  310 25424.8297 43382.9697  70.6%     -  292s
     0     0 41396.0263    0  302 25424.8297 41396.0263  62.8%     -  349s
     0     0 41004.9939    0  319 25424.8297 41004.9939  61.3%     -  370s
     0     0 40886.8156    0  319 25424.8297 40886.8156  60.8%     -  382s
     0     0 40785.6873    0  314 25424.8297 40785.6873  60.4%     -  390s
     0     0 40739.2343    0  316 25424.8297 40739.2343  60.2%     -  396s
     0     0 40703.3922    0  323 25424.8297 40703.3922  60.1%     -  404s
     0     0 40678.8971    0  329 25424.8297 40678.8971  60.0%     -  410s
     0     0 40659.0370    0  330 25424.8297 40659.0370  59.9%     -  415s
     0     0 40608.4379    0  332 25424.8297 40608.4379  59.7%     -  422s
     0     0 40601.2560    0  340 25424.8297 40601.2560  59.7%     -  426s
     0     0 40553.1556    0  336 25424.8297 40553.1556  59.5%     -  429s
     0     0 40538.3395    0  342 25424.8297 40538.3395  59.4%     -  432s
     0     0 40533.8151    0  341 25424.8297 40533.8151  59.4%     -  434s
     0     0 40528.8603    0  338 25424.8297 40528.8603  59.4%     -  436s
     0     0 40518.2394    0  335 25424.8297 40518.2394  59.4%     -  438s
     0     0 40465.2877    0  335 25424.8297 40465.2877  59.2%     -  444s
     0     0 40421.1612    0  335 25424.8297 40421.1612  59.0%     -  449s
     0     0 40411.5073    0  335 25424.8297 40411.5073  58.9%     -  451s
     0     0 40410.9204    0  339 25424.8297 40410.9204  58.9%     -  453s
     0     0 39676.9048    0  393 25424.8297 39676.9048  56.1%     -  491s
     0     0 39442.0951    0  391 25424.8297 39442.0951  55.1%     -  506s
     0     0 39373.6814    0  405 25424.8297 39373.6814  54.9%     -  515s
     0     0 39349.9547    0  404 25424.8297 39349.9547  54.8%     -  521s
     0     0 39334.1941    0  400 25424.8297 39334.1941  54.7%     -  525s
     0     0 39327.9975    0  406 25424.8297 39327.9975  54.7%     -  529s
     0     0 39325.9746    0  414 25424.8297 39325.9746  54.7%     -  532s
     0     0 39316.5555    0  407 25424.8297 39316.5555  54.6%     -  537s
     0     0 39311.6051    0  412 25424.8297 39311.6051  54.6%     -  540s
     0     0 39311.0389    0  413 25424.8297 39311.0389  54.6%     -  542s
     0     0 39140.7712    0  410 25424.8297 39140.7712  53.9%     -  560s
     0     0 39074.1775    0  417 25424.8297 39074.1775  53.7%     -  570s
     0     0 39010.3866    0  413 25424.8297 39010.3866  53.4%     -  578s
     0     0 39001.4872    0  420 25424.8297 39001.4872  53.4%     -  582s
     0     0 38989.8043    0  425 25424.8297 38989.8043  53.4%     -  587s
     0     0 38982.2207    0  412 25424.8297 38982.2207  53.3%     -  590s
     0     0 38974.6120    0  418 25424.8297 38974.6120  53.3%     -  593s
     0     0 38952.2776    0  413 25424.8297 38952.2776  53.2%     -  597s
     0     0 38944.7786    0  423 25424.8297 38944.7786  53.2%     -  601s
     0     0 38942.1397    0  418 25424.8297 38942.1397  53.2%     -  603s
     0     0 38939.3323    0  419 25424.8297 38939.3323  53.2%     -  605s
     0     0 38936.1582    0  420 25424.8297 38936.1582  53.1%     -  607s
     0     0 38932.7372    0  411 25424.8297 38932.7372  53.1%     -  608s
     0     0 38928.5626    0  419 25424.8297 38928.5626  53.1%     -  610s
     0     0 38926.8347    0  415 25424.8297 38926.8347  53.1%     -  612s
     0     0 38926.5567    0  415 25424.8297 38926.5567  53.1%     -  612s
     0     0 38878.5032    0  406 25424.8297 38878.5032  52.9%     -  620s
H    0     0                    25545.990495 38877.1406  52.2%     -  638s
     0     0 38851.6162    0  418 25545.9905 38851.6162  52.1%     -  652s
     0     0 38841.4057    0  420 25545.9905 38841.4057  52.0%     -  655s
     0     0 38833.8365    0  425 25545.9905 38833.8365  52.0%     -  660s
     0     0 38830.6465    0  424 25545.9905 38830.6465  52.0%     -  663s
     0     0 38830.1026    0  429 25545.9905 38830.1026  52.0%     -  663s
     0     0 38755.7045    0  421 25545.9905 38755.7045  51.7%     -  679s
     0     0 38719.8156    0  393 25545.9905 38719.8156  51.6%     -  687s
     0     0 38714.8615    0  399 25545.9905 38714.8615  51.5%     -  691s
     0     0 38713.0879    0  400 25545.9905 38713.0879  51.5%     -  692s
     0     0 38711.3721    0  400 25545.9905 38711.3721  51.5%     -  693s
     0     0 38706.2542    0  393 25545.9905 38706.2542  51.5%     -  696s
     0     0 38700.1270    0  393 25545.9905 38700.1270  51.5%     -  699s
     0     0 38698.9076    0  392 25545.9905 38698.9076  51.5%     -  701s
     0     0 38669.5388    0  402 25545.9905 38669.5388  51.4%     -  706s
H    0     0                    25548.785286 38668.7342  51.4%     -  728s
H    0     0                    25627.300363 38668.7342  50.9%     -  728s
H    0     0                    25630.095155 38668.7342  50.9%     -  730s
     0     0 38664.0826    0  410 25630.0952 38664.0826  50.9%     -  742s
     0     0 38662.3624    0  408 25630.0952 38662.3624  50.8%     -  743s
     0     0 38661.0176    0  407 25630.0952 38661.0176  50.8%     -  744s
     0     0 38625.9735    0  396 25630.0952 38625.9735  50.7%     -  753s
     0     0 38617.1252    0  404 25630.0952 38617.1252  50.7%     -  756s
     0     0 38613.6117    0  400 25630.0952 38613.6117  50.7%     -  759s
     0     0 38612.8125    0  402 25630.0952 38612.8125  50.7%     -  760s
     0     0 38605.5218    0  397 25630.0952 38605.5218  50.6%     -  766s
     0     0 38601.8298    0  401 25630.0952 38601.8298  50.6%     -  767s
     0     0 38599.5263    0  401 25630.0952 38599.5263  50.6%     -  769s
     0     0 38596.3094    0  444 25630.0952 38596.3094  50.6%     -  771s
     0     0 38594.9414    0  444 25630.0952 38594.9414  50.6%     -  772s
     0     0 38583.8661    0  395 25630.0952 38583.8661  50.5%     -  776s
     0     0 38582.0804    0  399 25630.0952 38582.0804  50.5%     -  778s
     0     0 38579.5776    0  396 25630.0952 38579.5776  50.5%     -  780s
     0     0 38579.0046    0  399 25630.0952 38579.0046  50.5%     -  781s
     0     0 38572.4366    0  391 25630.0952 38572.4366  50.5%     -  785s
     0     0 38570.6396    0  393 25630.0952 38570.6396  50.5%     -  787s
     0     0 38570.1417    0  393 25630.0952 38570.1417  50.5%     -  788s
     0     0 38564.7667    0  390 25630.0952 38564.7667  50.5%     -  791s
     0     0 38563.1149    0  391 25630.0952 38563.1149  50.5%     -  794s
     0     0 38561.2184    0  388 25630.0952 38561.2184  50.5%     -  797s
     0     0 38560.1072    0  388 25630.0952 38560.1072  50.4%     -  802s
     0     2 38559.9352    0  388 25630.0952 38559.9352  50.4%     -  997s
     1     4 38463.4402    1  396 25630.0952 38558.8074  50.4%  3644 1031s
     3     7 38267.7607    2  393 25630.0952 38463.1109  50.1%  9589 1061s
     6    13 37981.3250    3  380 25630.0952 38267.2836  49.3% 12091 1082s
    12    26 37809.0398    4  394 25630.0952 38267.2836  49.3% 10944 1103s
    25    39 37213.6194    5  389 25630.0952 37808.5101  47.5% 15118 1157s
    38    71 35865.1284    6  365 25630.0952 37808.5101  47.5% 16313 1327s
    70   145 35676.9459    7  356 25630.0952 37400.7844  45.9% 17795 1386s
   144   175 34893.5200    7  385 25630.0952 37400.7844  45.9% 11741 1421s
   174   249 35306.7814    9  343 25630.0952 37400.7844  45.9% 10849 1455s
   248   319 35130.2290   11  342 25630.0952 37400.7844  45.9%  8717 1492s
   318   382 34584.8480   13  384 25630.0952 37400.7844  45.9%  7727 1523s
   381   425 34382.6663   15  373 25630.0952 37400.7844  45.9%  7147 1562s
   429   462 34025.3017   16  328 25630.0952 37400.7844  45.9%  7122 1589s
   445   462 26603.0424   23  159 25630.0952 37400.7844  45.9%  7221 1590s
   475   524 33914.1651   17  303 25630.0952 37400.7844  45.9%  7280 1620s
   552   588 33379.8038   20  305 25630.0952 37400.7844  45.9%  7173 1646s
   622   617 32804.3841   24  294 25630.0952 37400.7844  45.9%  7207 1671s
   665   668 32776.6799   25  288 25630.0952 37400.7844  45.9%  7224 1694s
   727   733 32654.9974   28  291 25630.0952 37400.7844  45.9%  7216 1715s
   808   800 32389.3597   30  244 25630.0952 37400.7844  45.9%  7079 1737s
   893   872 31952.0130   33  293 25630.0952 37400.7844  45.9%  6859 1759s
   980   939 31409.3378   36  328 25630.0952 37142.2625  44.9%  6704 1780s
  1081   990 31058.9391   39  274 25630.0952 37126.4887  44.9%  6515 1807s
  1178  1044 infeasible   41      25630.0952 37126.4887  44.9%  6369 1833s
  1267  1124 30217.3808   43  266 25630.0952 37126.4887  44.9%  6318 1858s
  1365  1195 29235.2323   47  208 25630.0952 37126.4887  44.9%  6256 1886s
  1476  1271 26632.3816   51  178 25630.0952 37126.4887  44.9%  6195 1912s
  1578  1359 25854.5644   59  218 25630.0952 37126.4887  44.9%  6162 1940s
  1706  1429 31925.7438   22  372 25630.0952 37126.4887  44.9%  6064 1968s
  1846  1467 31513.6946   23  335 25630.0952 37126.4887  44.9%  5970 1996s
  1916  1517 30939.9478   23  275 25630.0952 37126.4887  44.9%  6024 2028s
  2004  1572 31495.6377   24  289 25630.0952 37126.4887  44.9%  6003 2057s
  2109  1644 30840.0739   25  202 25630.0952 37126.4887  44.9%  6041 2090s
  2207  1720 27256.5389   26  155 25630.0952 37126.4887  44.9%  6081 2126s
  2326  1791 30672.8581   26  153 25630.0952 37126.4887  44.9%  6093 2164s
  2450  1865 30296.2218   28  205 25630.0952 37126.4887  44.9%  6121 2198s
  2566  1951 29792.1500   31  297 25630.0952 37126.4887  44.9%  6152 2236s
  2717  2065 29187.1306   33  256 25630.0952 37126.4887  44.9%  6154 2272s
  2878  2168 27180.5857   37  153 25630.0952 36955.9599  44.2%  6143 2309s
  3043  2252 infeasible   35      25630.0952 36687.3159  43.1%  6172 2350s
  3217  2275 28265.6885   40  150 25630.0952 36544.8632  42.6%  6171 2392s
  3258  2306 26180.0416   40  180 25630.0952 36474.8135  42.3%  6208 2427s
  3291  2327 infeasible   39      25630.0952 36474.8135  42.3%  6244 2463s
  3332  2355 28009.4359   40  155 25630.0952 36474.8135  42.3%  6267 2495s
  3367  2399     cutoff   38      25630.0952 36473.1029  42.3%  6283 2531s
  3419  2489 27431.9064   41  240 25630.0952 36473.1029  42.3%  6279 2564s
  3523  2583 28009.5450   40  154 25630.0952 36473.1029  42.3%  6191 2618s
  3663  2584 31276.2288   25  388 25630.0952 36473.1029  42.3%  6083 2843s
  3665  2585 30620.6002   38  120 25630.0952 36473.1029  42.3%  6080 2866s
  3666  2586 27055.6427   22  326 25630.0952 36473.1029  42.3%  6078 2991s
  3667  2587 33105.4720   18  331 25630.0952 36473.1029  42.3%  6077 3077s
  3668  2587 28790.8498   37  402 25630.0952 36473.1029  42.3%  6075 3136s
  3669  2588 25797.9040   19  370 25630.0952 36473.1029  42.3%  6073 3161s
  3670  2589 32423.3287   27  384 25630.0952 36473.1029  42.3%  6072 3174s
  3671  2589 26545.3945   45  385 25630.0952 36473.1029  42.3%  6070 3189s
  3672  2590 31334.1212   40  423 25630.0952 36473.1029  42.3%  6068 3203s
  3673  2591 29407.2423   51  394 25630.0952 36473.1029  42.3%  6067 3213s
  3674  2591 30507.7287   13  395 25630.0952 36473.1029  42.3%  6065 3222s
  3675  2592 28681.5160   41  390 25630.0952 36473.1029  42.3%  6063 3231s
  3676  2593 26856.3763   24  397 25630.0952 36473.1029  42.3%  6062 3238s
  3677  2593 28771.8705   34  439 25630.0952 36473.1029  42.3%  6060 3248s
  3678  2594 26479.9708   21  403 25630.0952 36473.1029  42.3%  6058 3254s
  3679  2595 33919.3574   22  402 25630.0952 36473.1029  42.3%  6057 3260s
  3680  2595 28350.5803   11  395 25630.0952 36473.1029  42.3%  6055 3284s
  3681  2596 34622.9129   10  396 25630.0952 36473.1029  42.3%  6054 3291s
  3682  2597 28367.9755   57  394 25630.0952 36473.1029  42.3%  6052 3297s
  3683  2597 31376.7642   31  393 25630.0952 36473.1029  42.3%  6050 3304s
  3684  2598 32295.8640   23  454 25630.0952 36473.1029  42.3%  6049 3311s
  3685  2599 29009.2933   34  390 25630.0952 36473.1029  42.3%  6047 3320s
  3686  2599 28579.7614   38  449 25630.0952 36473.1029  42.3%  6045 3341s
  3687  2600 33088.8516   26  443 25630.0952 36473.1029  42.3%  6044 3348s
  3688  2601 34181.9523   12  406 25630.0952 36473.1029  42.3%  6042 3351s
  3689  2601 30187.2414   30  459 25630.0952 36473.1029  42.3%  6040 3360s
  3690  2602 28441.3411   41  426 25630.0952 36473.1029  42.3%  6039 3380s
  3691  2603 26243.4314   17  452 25630.0952 36473.1029  42.3%  6037 3386s
  3692  2603 31076.5260   17  460 25630.0952 36473.1029  42.3%  6036 3390s
  3693  2604 27390.2304   45  398 25630.0952 36473.1029  42.3%  6034 3397s
  3694  2605 27366.6972   32  387 25630.0952 36473.1029  42.3%  6032 3411s
  3695  2605 34664.7591    9  442 25630.0952 36473.1029  42.3%  6031 3416s
  3696  2606 28754.5753   18  393 25630.0952 36473.1029  42.3%  6029 3422s
  3697  2607 26458.3271   18  403 25630.0952 36473.1029  42.3%  6027 3428s
  3698  2607 29791.7041   33  486 25630.0952 36473.1029  42.3%  6026 3455s
  3699  2608 33006.9260   17  477 25630.0952 36473.1029  42.3%  6024 3464s
  3700  2609 27197.1776   15  480 25630.0952 36473.1029  42.3%  6022 3471s
  3701  2609 27186.2844   51  489 25630.0952 36473.1029  42.3%  6021 3485s
  3702  2610 29906.1437   46  490 25630.0952 36473.1029  42.3%  6019 3490s
  3703  2611 30117.4171   20  483 25630.0952 36473.1029  42.3%  6018 3497s
  3704  2611 30616.5016    8  502 25630.0952 36473.1029  42.3%  6016 3514s
  3705  2612 34413.3412   11  498 25630.0952 36473.1029  42.3%  6014 3521s
  3706  2613 35335.9770   10  495 25630.0952 36473.1029  42.3%  6013 3532s
  3707  2613 33817.8358   20  456 25630.0952 36473.1029  42.3%  6011 3538s
  3708  2614 31485.7666   28  460 25630.0952 36473.1029  42.3%  6009 3549s
  3709  2615 33357.4283   20  460 25630.0952 36473.1029  42.3%  6008 3579s

Cutting planes:
  Learned: 2
  MIR: 150
  Flow cover: 720
  RLT: 6
  Relax-and-lift: 75

Explored 3709 nodes (23149244 simplex iterations) in 3600.04 seconds (5498.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25630.1 25627.3 25548.8 ... 24285

Time limit reached
Best objective 2.563009515460e+04, best bound 3.647310286988e+04, gap 42.3058%
  WARNING: Time limit reached. Using best solution found (gap: 42.31%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.28s
  Master Objective (UB) = 25630.10, θ = 173031.90
  Upper Bound (UB) = 25630.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173031.90
  [DEBUG]   ✓ Scenario 0: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173031.90 ≤ Q = 173031.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173031.90 ≤ Q = 173031.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173031.90 ≤ Q = 173031.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173031.90 ≤ Q = 173031.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 173031.90 ≤ Q = 173031.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 173031.90 ≤ Q = 173031.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 173031.90 ≤ Q = 173031.90 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x449a4a31
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x449a4a31
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.427204e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6837968.3905
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.568123e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156812.26    0  124 6837968.39 -156812.26   102%     -    0s
H    0     0                    -121696.7788 -156812.26  28.9%     -    0s
H    0     0                    -121960.0313 -156812.26  28.6%     -    0s
H    0     0                    -131847.1811 -134370.16  1.91%     -    0s
     0     0 -134370.16    0   64 -131847.18 -134370.16  1.91%     -    0s
H    0     0                    -132614.5387 -134238.09  1.22%     -    0s
     0     0 -133382.60    0   66 -132614.54 -133382.60  0.58%     -    0s
H    0     0                    -132634.7665 -133325.79  0.52%     -    0s
     0     0 -133129.73    0   65 -132634.77 -133129.73  0.37%     -    0s
     0     0 -132906.23    0   17 -132634.77 -132906.23  0.20%     -    0s
     0     0 -132897.81    0   18 -132634.77 -132897.81  0.20%     -    0s
     0     0 -132725.81    0    8 -132634.77 -132725.81  0.07%     -    0s
     0     0 -132697.19    0    8 -132634.77 -132697.19  0.05%     -    0s
     0     0 -132687.61    0    7 -132634.77 -132687.61  0.04%     -    0s
     0     0 -132687.52    0    7 -132634.77 -132687.52  0.04%     -    0s
     0     0 -132657.26    0    4 -132634.77 -132657.26  0.02%     -    0s
     0     0 -132647.24    0    2 -132634.77 -132647.24  0.01%     -    0s
H    0     0                    -132644.0957 -132647.24  0.00%     -    0s

Cutting planes:
  MIR: 1

Explored 1 nodes (633 simplex iterations) in 0.26 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -132644 -132635 -132615 ... 1.4272e+13
No other solutions better than -132644

Optimal solution found (tolerance 1.00e-06)
Best objective -1.326440956619e+05, best bound -1.326440956619e+05, gap 0.0000%
  Subproblem solved in 0.29s
  Worst-case operational profit (Z_SP) = 166503.72
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132644.10
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -132644.10 = 166503.72
  [DEBUG]   Current θ from Master = 173031.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6528.18 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19101.91
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 776.4132, Absolute Gap = 776.4132, Relative Gap = 0.030293
  Not converged yet (gap = 776.41 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0xda728f11
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113624 rows and 46172 columns
Presolve time: 4.83s
Presolved: 132399 rows, 55928 columns, 817295 nonzeros
Variable types: 53669 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.55s

Barrier statistics:
 Dense cols : 653
 AA' NZ     : 6.204e+06
 Factor NZ  : 1.375e+07 (roughly 200 MB of memory)
 Factor Ops : 3.020e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82449047e+07  2.49796752e+08  1.14e+05 1.73e+01  8.00e+04     8s
   1  -1.39219344e+07  2.18600042e+08  7.92e+04 6.36e+01  5.50e+04     9s
   2  -4.74652670e+06  1.60914056e+08  2.63e+04 7.51e-01  1.94e+04     9s
   3  -1.09492282e+06  1.14947723e+08  3.38e+03 1.92e+00  2.82e+03     9s
   4  -5.77007673e+05  4.79754155e+07  6.54e+02 3.18e-01  6.03e+02     9s
   5  -4.63634269e+05  2.89146772e+07  3.10e+02 1.57e-01  2.95e+02     9s
   6  -3.13748554e+05  2.33373473e+07  8.07e+01 1.16e-01  1.40e+02     9s
   7  -1.86852256e+05  1.64720293e+07  1.76e+01 7.63e-02  7.67e+01     9s
   8  -1.38755816e+05  1.09119820e+07  1.01e+01 4.89e-02  4.90e+01    10s
   9  -1.02522042e+05  6.93281435e+06  3.68e+00 3.00e-02  2.99e+01    10s
  10  -9.27334160e+04  1.95986164e+06  2.64e+00 8.07e-03  8.68e+00    10s
  11  -7.27049289e+04  7.90542149e+05  1.46e+00 3.07e-03  3.62e+00    10s
  12  -4.14062306e+04  3.90010712e+05  7.05e-01 1.47e-03  1.80e+00    10s
  13  -1.63903555e+04  2.39397086e+05  4.22e-01 1.04e-03  1.06e+00    10s
  14  -8.40348330e+03  2.09448304e+05  3.59e-01 1.11e-03  9.06e-01    10s
  15   8.21558031e+01  1.66285811e+05  2.96e-01 1.18e-03  6.91e-01    11s
  16   1.00042022e+04  1.25351817e+05  2.35e-01 1.41e-03  4.80e-01    11s
  17   1.19512452e+04  1.19413802e+05  2.23e-01 1.32e-03  4.47e-01    11s
  18   2.23154009e+04  1.06944248e+05  1.56e-01 1.37e-03  3.52e-01    11s
  19   2.62429146e+04  8.86609383e+04  1.33e-01 1.30e-03  2.60e-01    11s
  20   2.99025421e+04  8.11802068e+04  1.11e-01 1.48e-03  2.13e-01    11s
  21   3.32946244e+04  7.11499830e+04  9.16e-02 1.50e-03  1.58e-01    11s
  22   3.63945343e+04  6.68729469e+04  7.57e-02 1.68e-03  1.27e-01    12s
  23   3.78357505e+04  6.41918687e+04  6.82e-02 1.55e-03  1.10e-01    12s
  24   3.94210512e+04  6.34135081e+04  6.07e-02 1.69e-03  9.99e-02    12s
  25   4.14989291e+04  5.99954060e+04  5.10e-02 1.40e-03  7.71e-02    12s
  26   4.39345815e+04  5.89311032e+04  4.03e-02 1.68e-03  6.25e-02    12s
  27   4.46160067e+04  5.74955094e+04  3.72e-02 1.88e-03  5.37e-02    12s
  28   4.60086511e+04  5.63738120e+04  3.14e-02 1.92e-03  4.32e-02    13s
  29   4.67134292e+04  5.57753466e+04  2.83e-02 1.71e-03  3.78e-02    13s
  30   4.78789285e+04  5.55714279e+04  2.32e-02 1.52e-03  3.21e-02    13s
  31   4.87965679e+04  5.49371401e+04  1.93e-02 1.08e-03  2.56e-02    13s
  32   4.96801681e+04  5.46547442e+04  1.57e-02 8.59e-04  2.07e-02    13s
  33   4.99546038e+04  5.45476876e+04  1.44e-02 7.89e-04  1.92e-02    13s
  34   5.04681029e+04  5.42496734e+04  1.22e-02 5.84e-04  1.58e-02    14s
  35   5.09060494e+04  5.40474571e+04  1.04e-02 4.36e-04  1.31e-02    14s
  36   5.14127741e+04  5.39157808e+04  8.31e-03 3.25e-04  1.04e-02    14s
  37   5.16626552e+04  5.38437740e+04  7.24e-03 2.80e-04  9.10e-03    14s
  38   5.22902584e+04  5.35734839e+04  4.59e-03 9.91e-04  5.36e-03    14s
  39   5.24663447e+04  5.35297052e+04  3.86e-03 6.80e-04  4.44e-03    15s
  40   5.25014926e+04  5.35118172e+04  3.71e-03 5.72e-04  4.22e-03    15s
  41   5.29570138e+04  5.34991746e+04  1.81e-03 4.66e-04  2.26e-03    15s
  42   5.31007853e+04  5.34680816e+04  1.23e-03 2.63e-04  1.53e-03    15s
  43   5.31086576e+04  5.34449545e+04  1.20e-03 1.36e-04  1.40e-03    15s
  44   5.31560306e+04  5.34343111e+04  1.01e-03 5.23e-05  1.16e-03    16s
  45   5.33271105e+04  5.34291127e+04  3.41e-04 3.09e-05  4.26e-04    16s
  46   5.33627452e+04  5.34237024e+04  2.05e-04 1.12e-05  2.54e-04    16s
  47   5.33902898e+04  5.34218275e+04  1.03e-04 4.05e-06  1.32e-04    16s
  48   5.34169643e+04  5.34205608e+04  1.16e-05 3.37e-07  1.50e-05    16s
  49   5.34199690e+04  5.34204913e+04  2.05e-06 8.08e-08  2.18e-06    16s
  50   5.34204861e+04  5.34204865e+04  5.05e-09 6.46e-11  1.72e-09    17s

Barrier solved model in 50 iterations and 16.62 seconds (12.86 work units)
Optimal objective 5.34204861e+04


Root crossover log...

  120639 DPushes remaining with DInf 0.0000000e+00                17s
   27413 DPushes remaining with DInf 0.0000000e+00                20s
    1679 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                26s

   18511 PPushes remaining with PInf 1.1062108e-04                26s
       0 PPushes remaining with PInf 0.0000000e+00                29s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.3828764e+04     29s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   87077    5.3420487e+04   0.000000e+00   7.382876e+04     29s
   87520    5.3420487e+04   0.000000e+00   7.345360e+03     30s
   89316    5.3420487e+04   0.000000e+00   0.000000e+00     33s
   89316    5.3420487e+04   0.000000e+00   0.000000e+00     33s
Concurrent spin time: 5.67s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.342049e+04, 89316 iterations, 33.20 seconds (38.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53420.4865    0  110 -239613.87 53420.4865   122%     -   40s
H    0     0                    -219248.2816 53420.4865   124%     -   41s
H    0     0                    -217073.2264 53420.4865   125%     -   41s
H    0     0                    -215715.8479 53420.4865   125%     -   41s
H    0     0                    -202085.0043 53420.4865   126%     -   42s
H    0     0                    -201941.1589 53420.4865   126%     -   42s
H    0     0                    -201667.4845 53420.4865   126%     -   42s
H    0     0                    -201665.6268 53420.4865   126%     -   42s
H    0     0                    -53048.43950 53420.4865   201%     -   43s
H    0     0                    -52678.88467 53420.4865   201%     -   43s
H    0     0                    23832.472477 53420.4865   124%     -   43s
H    0     0                    24613.814462 53420.4865   117%     -   43s
H    0     0                    25049.464246 53420.4865   113%     -   44s
H    0     0                    25075.654117 53420.4865   113%     -   44s
H    0     0                    25241.428431 53420.4865   112%     -   44s
H    0     0                    25267.992349 47710.7281  88.8%     -  150s
H    0     0                    25511.492803 47710.7281  87.0%     -  150s
     0     0 47710.6620    0  245 25511.4928 47710.6620  87.0%     -  150s
     0     0 47455.5994    0  257 25511.4928 47455.5994  86.0%     -  175s
     0     0 47455.5994    0  263 25511.4928 47455.5994  86.0%     -  182s
     0     0 47243.9464    0  282 25511.4928 47243.9464  85.2%     -  205s
     0     0 47243.9464    0  282 25511.4928 47243.9464  85.2%     -  207s
     0     0 47243.9464    0  282 25511.4928 47243.9464  85.2%     -  208s
     0     0 47243.9464    0  286 25511.4928 47243.9464  85.2%     -  209s
     0     0 43418.9516    0  240 25511.4928 43418.9516  70.2%     -  268s
     0     0 43143.8459    0  247 25511.4928 43143.8459  69.1%     -  293s
     0     0 43079.8922    0  249 25511.4928 43079.8922  68.9%     -  304s
     0     0 42979.0792    0  246 25511.4928 42979.0792  68.5%     -  319s
     0     0 42937.2597    0  254 25511.4928 42937.2597  68.3%     -  328s
     0     0 42894.4638    0  259 25511.4928 42894.4638  68.1%     -  334s
     0     0 42883.0479    0  265 25511.4928 42883.0479  68.1%     -  337s
     0     0 42816.6250    0  259 25511.4928 42816.6250  67.8%     -  353s
     0     0 42799.8700    0  263 25511.4928 42799.8700  67.8%     -  358s
     0     0 42757.7282    0  266 25511.4928 42757.7282  67.6%     -  365s
     0     0 42754.7742    0  263 25511.4928 42754.7742  67.6%     -  367s
     0     0 42741.2650    0  264 25511.4928 42741.2650  67.5%     -  371s
     0     0 42737.6575    0  269 25511.4928 42737.6575  67.5%     -  374s
     0     0 42702.9695    0  270 25511.4928 42702.9695  67.4%     -  381s
     0     0 42700.3224    0  271 25511.4928 42700.3224  67.4%     -  382s
     0     0 42700.0567    0  272 25511.4928 42700.0567  67.4%     -  383s
     0     0 41128.6965    0  310 25511.4928 41128.6965  61.2%     -  436s
     0     0 40611.1965    0  325 25511.4928 40611.1965  59.2%     -  475s
     0     0 40479.8717    0  334 25511.4928 40479.8717  58.7%     -  494s
     0     0 40444.9565    0  335 25511.4928 40444.9565  58.5%     -  503s
     0     0 40410.9173    0  332 25511.4928 40410.9173  58.4%     -  515s
     0     0 40387.0282    0  341 25511.4928 40387.0282  58.3%     -  521s
     0     0 40375.8301    0  341 25511.4928 40375.8301  58.3%     -  524s
     0     0 40373.1333    0  339 25511.4928 40373.1333  58.3%     -  525s
     0     0 40372.4161    0  336 25511.4928 40372.4161  58.3%     -  526s
     0     0 39796.4929    0  391 25511.4928 39796.4929  56.0%     -  566s
     0     0 39674.4890    0  380 25511.4928 39674.4890  55.5%     -  581s
     0     0 39588.3344    0  390 25511.4928 39588.3344  55.2%     -  596s
     0     0 39564.5970    0  400 25511.4928 39564.5970  55.1%     -  603s
     0     0 39546.8506    0  401 25511.4928 39546.8506  55.0%     -  610s
     0     0 39510.9712    0  393 25511.4928 39510.9712  54.9%     -  619s
     0     0 39485.0487    0  402 25511.4928 39485.0487  54.8%     -  625s
     0     0 39470.4868    0  401 25511.4928 39470.4868  54.7%     -  630s
     0     0 39453.4198    0  391 25511.4928 39453.4198  54.6%     -  637s
     0     0 39431.8621    0  397 25511.4928 39431.8621  54.6%     -  642s
     0     0 39424.3176    0  397 25511.4928 39424.3176  54.5%     -  645s
     0     0 39417.4898    0  402 25511.4928 39417.4898  54.5%     -  649s
     0     0 39416.0941    0  406 25511.4928 39416.0941  54.5%     -  650s
     0     0 39209.3637    0  419 25511.4928 39209.3637  53.7%     -  680s
     0     0 39133.9102    0  418 25511.4928 39133.9102  53.4%     -  692s
     0     0 39115.6402    0  414 25511.4928 39115.6402  53.3%     -  699s
     0     0 39105.2235    0  428 25511.4928 39105.2235  53.3%     -  702s
     0     0 39098.0934    0  420 25511.4928 39098.0934  53.3%     -  707s
     0     0 39091.9616    0  426 25511.4928 39091.9616  53.2%     -  710s
     0     0 39083.9986    0  423 25511.4928 39083.9986  53.2%     -  714s
     0     0 39073.6214    0  418 25511.4928 39073.6214  53.2%     -  718s
     0     0 39070.0199    0  423 25511.4928 39070.0199  53.1%     -  720s
     0     0 39029.0799    0  424 25511.4928 39029.0799  53.0%     -  728s
     0     0 39023.0249    0  427 25511.4928 39023.0249  53.0%     -  732s
     0     0 39019.2671    0  431 25511.4928 39019.2671  52.9%     -  734s
     0     0 39014.6783    0  436 25511.4928 39014.6783  52.9%     -  737s
     0     0 39013.6282    0  436 25511.4928 39013.6282  52.9%     -  738s
     0     0 38936.3698    0  426 25511.4928 38936.3698  52.6%     -  753s
H    0     0                    25576.229952 38933.3098  52.2%     -  770s
     0     0 38901.8868    0  429 25576.2300 38901.8868  52.1%     -  783s
     0     0 38887.3109    0  432 25576.2300 38887.3109  52.0%     -  790s
     0     0 38880.9836    0  430 25576.2300 38880.9836  52.0%     -  796s
     0     0 38868.8655    0  428 25576.2300 38868.8655  52.0%     -  801s
     0     0 38857.0758    0  434 25576.2300 38857.0758  51.9%     -  807s
     0     0 38849.1359    0  434 25576.2300 38849.1359  51.9%     -  811s
     0     0 38845.4853    0  441 25576.2300 38845.4853  51.9%     -  815s
     0     0 38839.0276    0  396 25576.2300 38839.0276  51.9%     -  820s
     0     0 38835.0547    0  397 25576.2300 38835.0547  51.8%     -  824s
     0     0 38832.6387    0  401 25576.2300 38832.6387  51.8%     -  825s
     0     0 38831.0636    0  399 25576.2300 38831.0636  51.8%     -  830s
     0     0 38809.2419    0  412 25576.2300 38809.2419  51.7%     -  837s
     0     0 38799.7328    0  410 25576.2300 38799.7328  51.7%     -  842s
     0     0 38797.6586    0  410 25576.2300 38797.6586  51.7%     -  845s
     0     0 38796.1110    0  414 25576.2300 38796.1110  51.7%     -  847s
     0     0 38789.0888    0  409 25576.2300 38789.0888  51.7%     -  855s
     0     0 38783.8780    0  413 25576.2300 38783.8780  51.6%     -  893s
     0     0 38767.9131    0  412 25576.2300 38767.9131  51.6%     -  901s
     0     0 38760.2429    0  415 25576.2300 38760.2429  51.5%     -  909s
     0     0 38754.3981    0  413 25576.2300 38754.3981  51.5%     -  917s
     0     0 38703.8608    0  402 25576.2300 38703.8608  51.3%     -  931s
     0     0 38698.7898    0  411 25576.2300 38698.7898  51.3%     -  936s
     0     0 38692.9646    0  408 25576.2300 38692.9646  51.3%     -  939s
     0     0 38691.4121    0  413 25576.2300 38691.4121  51.3%     -  941s
     0     0 38671.7912    0  408 25576.2300 38671.7912  51.2%     -  952s
     0     0 38666.2141    0  413 25576.2300 38666.2141  51.2%     -  956s
     0     0 38664.9877    0  410 25576.2300 38664.9877  51.2%     -  958s
     0     0 38652.3941    0  404 25576.2300 38652.3941  51.1%     -  966s
     0     0 38639.1351    0  360 25576.2300 38639.1351  51.1%     -  974s
     0     0 38633.4457    0  416 25576.2300 38633.4457  51.1%     -  977s
     0     0 38629.3164    0  421 25576.2300 38629.3164  51.0%     -  978s
     0     0 38626.8444    0  421 25576.2300 38626.8444  51.0%     -  980s
     0     0 38625.2672    0  424 25576.2300 38625.2672  51.0%     -  981s
     0     0 38605.3706    0  372 25576.2300 38605.3706  50.9%     -  989s
     0     0 38600.3650    0  416 25576.2300 38600.3650  50.9%     -  993s
     0     0 38575.0960    0  454 25576.2300 38575.0960  50.8%     -  997s
     0     0 38569.2739    0  459 25576.2300 38569.2739  50.8%     - 1001s
     0     0 38568.0576    0  410 25576.2300 38568.0576  50.8%     - 1003s
     0     0 38508.4880    0  388 25576.2300 38508.4880  50.6%     - 1020s
     0     0 38490.5619    0  387 25576.2300 38490.5619  50.5%     - 1028s
     0     0 38486.7337    0  445 25576.2300 38486.7337  50.5%     - 1030s
     0     0 38484.4466    0  396 25576.2300 38484.4466  50.5%     - 1031s
     0     0 38480.1615    0  450 25576.2300 38480.1615  50.5%     - 1033s
     0     0 38479.0778    0  397 25576.2300 38479.0778  50.4%     - 1034s
     0     0 38474.2202    0  402 25576.2300 38474.2202  50.4%     - 1040s
     0     0 38472.8005    0  406 25576.2300 38472.8005  50.4%     - 1045s
     0     0 38471.3248    0  398 25576.2300 38471.3248  50.4%     - 1049s
     0     0 38470.2846    0  398 25576.2300 38470.2846  50.4%     - 1051s
     0     0 38469.1798    0  397 25576.2300 38469.1798  50.4%     - 1056s
     0     0 38453.5213    0  394 25576.2300 38453.5213  50.3%     - 1062s
     0     0 38450.6632    0  397 25576.2300 38450.6632  50.3%     - 1064s
     0     0 38449.2218    0  397 25576.2300 38449.2218  50.3%     - 1066s
     0     0 38445.1915    0  407 25576.2300 38445.1915  50.3%     - 1071s
     0     0 38442.9762    0  403 25576.2300 38442.9762  50.3%     - 1073s
     0     0 38441.8375    0  404 25576.2300 38441.8375  50.3%     - 1074s
     0     0 38440.3416    0  406 25576.2300 38440.3416  50.3%     - 1078s
     0     0 38439.2287    0  458 25576.2300 38439.2287  50.3%     - 1080s
     0     0 38438.4959    0  406 25576.2300 38438.4959  50.3%     - 1083s
     0     0 38437.8974    0  407 25576.2300 38437.8974  50.3%     - 1085s
     0     0 38435.9750    0  411 25576.2300 38435.9750  50.3%     - 1088s
     0     0 38433.1379    0  411 25576.2300 38433.1379  50.3%     - 1093s
H    0     0                    25592.450279 38431.2633  50.2%     - 1296s
     0     2 38431.2633    0  411 25592.4503 38431.2633  50.2%     - 1299s
     1     4 38373.1268    1  344 25592.4503 38425.5027  50.1%  3396 1306s
     3     6 37174.0736    2  314 25592.4503 38376.1654  50.0% 10053 1349s
     5    10 36908.0736    3  319 25592.4503 38376.1654  50.0% 10612 1373s
     9    20 36599.4739    3  306 25592.4503 38075.0524  48.8%  9388 1407s
    19    40 36250.3095    4  358 25592.4503 37939.3177  48.2%  9610 1433s
    39    52 37031.5948    5  340 25592.4503 37553.4102  46.7% 14706 1515s
    51    74 36244.9669    6  318 25592.4503 37553.4102  46.7% 14366 1573s
    73   116 36178.4932    7  308 25592.4503 37553.4102  46.7% 12535 1613s
   115   214 36091.6159    9  294 25592.4503 37553.4102  46.7%  9917 1659s
   213   278 36038.7477   11  354 25592.4503 37553.4102  46.7%  7787 1698s
   277   317 35778.0915   13  300 25592.4503 37553.4102  46.7%  6893 1728s
   316   362 35701.9065   14  289 25592.4503 37553.4102  46.7%  6660 1770s
   367   418 34715.5206   15  267 25592.4503 37553.4102  46.7%  6470 1810s
   424   474 27786.9346   17  198 25592.4503 37553.4102  46.7%  6443 1843s
   486   522 34677.3631   16  261 25592.4503 37553.4102  46.7%  6336 1870s
   561   567 34272.8854   17  190 25592.4503 37553.4102  46.7%  6145 1925s
   636   621     cutoff   22      25592.4503 37553.4102  46.7%  6106 1948s
   703   682 34178.6581   18  228 25592.4503 37553.4102  46.7%  6170 1979s
   774   722 31257.3822   15  244 25592.4503 37553.4102  46.7%  6186 2001s
   834   772 35928.6171   11  351 25592.4503 37553.4102  46.7%  6159 2024s
   892   800 31520.2813   37  322 25592.4503 37553.4102  46.7%  6171 2047s
   926   837 31493.1143   38  305 25592.4503 37553.4102  46.7%  6270 2073s
   965   878 31377.4267   39  171 25592.4503 37553.4102  46.7%  6332 2095s
  1016   913 31373.0870   40  166 25592.4503 37553.4102  46.7%  6258 2116s
  1067   953 31371.8227   41  227 25592.4503 37553.4102  46.7%  6235 2142s
  1138  1007 30057.2685   42  258 25592.4503 37553.4102  46.7%  6185 2171s
  1206  1071 28020.5592   43  137 25592.4503 37553.4102  46.7%  6234 2202s
  1308  1135 26497.2231   44   95 25592.4503 37553.4102  46.7%  6118 2228s
  1418  1212 26058.5725   45   48 25592.4503 37553.4102  46.7%  5986 2257s
  1547  1292     cutoff   47      25592.4503 37553.4102  46.7%  5878 2291s
  1691  1371 29676.8606   39  144 25592.4503 37553.4102  46.7%  5739 2323s
  1826  1460 27727.8485   44   97 25592.4503 37553.4102  46.7%  5670 2357s
  1961  1554 26539.2879   53  131 25592.4503 37553.4102  46.7%  5613 2391s
  2127  1660     cutoff   59      25592.4503 37536.6196  46.7%  5512 2425s
  2290  1775 31234.5947    6  419 25592.4503 37536.6196  46.7%  5467 2459s
  2469  1849 28969.7790    7  395 25592.4503 37536.6196  46.7%  5403 2503s
  2623  1922 28720.1316    8  394 25592.4503 37536.6196  46.7%  5388 2543s
  2775  1990 27740.3437    9  265 25592.4503 37536.6196  46.7%  5411 2583s
  2910  2052     cutoff   11      25592.4503 37101.7839  45.0%  5460 2629s
  3035  2143 infeasible   10      25592.4503 37101.7839  45.0%  5527 2677s
  3166  2239 34272.0978   11  356 25592.4503 37101.7839  45.0%  5613 2722s
  3340  2320 33549.1077   13  335 25592.4503 37101.7839  45.0%  5644 2769s
  3476  2421 28846.3553   16  306 25592.4503 36336.6923  42.0%  5765 2820s
  3616  2474 28002.3594   17  161 25592.4503 36336.6923  42.0%  5879 2862s
  3693  2502 27680.1964   18  307 25592.4503 36336.6923  42.0%  5930 2902s
  3753  2545 25998.2586   19  284 25592.4503 36336.6923  42.0%  5940 2944s
  3834  2623 25952.0740   20  280 25592.4503 36336.6923  42.0%  5955 2994s
  3981  2749 28521.2093   52   58 25592.4503 36243.5879  41.6%  5924 3050s
  4209  2750 28067.0933   22  411 25592.4503 36243.5879  41.6%  5873 3398s
  4211  2751 31858.2967   20   78 25592.4503 36243.5879  41.6%  5870 3421s
  4212  2752 26621.2863   25  333 25592.4503 36243.5879  41.6%  5869 3539s

Cutting planes:
  MIR: 367
  Flow cover: 697
  RLT: 17
  Relax-and-lift: 79

Explored 4212 nodes (25473015 simplex iterations) in 3600.09 seconds (5537.67 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25592.5 25576.2 25511.5 ... -52678.9

Time limit reached
Best objective 2.559245027907e+04, best bound 3.624358793408e+04, gap 41.6183%
  WARNING: Time limit reached. Using best solution found (gap: 41.62%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.24s
  Master Objective (UB) = 25592.45, θ = 173188.71
  Upper Bound (UB) = 25592.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173188.71
  [DEBUG]   ✓ Scenario 0: θ = 173188.71 ≤ Q = 173188.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173188.71 ≤ Q = 173188.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173188.71 ≤ Q = 173188.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173188.71 ≤ Q = 173188.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 173188.71 ≤ Q = 173188.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 173188.71 ≤ Q = 173188.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 173188.71 ≤ Q = 173188.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4ae29f90
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4ae29f90
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.424072e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6827956.6941
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.566773e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156677.29    0  124 6827956.69 -156677.29   102%     -    0s
H    0     0                    -121589.5880 -156677.29  28.9%     -    0s
H    0     0                    -121852.8405 -156677.29  28.6%     -    0s
     0     0 -131363.39    0   66 -121852.84 -131363.39  7.80%     -    0s
H    0     0                    -128534.0836 -131265.33  2.12%     -    0s
H    0     0                    -128833.9263 -131265.33  1.89%     -    0s
H    0     0                    -129255.2951 -131265.33  1.56%     -    0s
H    0     0                    -129555.1379 -131265.33  1.32%     -    0s
     0     0 -130391.69    0   56 -129555.14 -130391.69  0.65%     -    0s
     0     0 -130249.81    0   43 -129555.14 -130249.81  0.54%     -    0s
H    0     0                    -129592.4046 -130249.81  0.51%     -    0s
     0     0 -130013.09    0   39 -129592.40 -130013.09  0.32%     -    0s
     0     0 -129982.89    0   40 -129592.40 -129982.89  0.30%     -    0s
     0     0 -129968.59    0   40 -129592.40 -129968.59  0.29%     -    0s
     0     0 -129867.00    0   38 -129592.40 -129867.00  0.21%     -    0s
     0     0 -129860.58    0   37 -129592.40 -129860.58  0.21%     -    0s
     0     0 -129828.15    0   37 -129592.40 -129828.15  0.18%     -    0s
H    0     0                    -129604.6590 -129827.18  0.17%     -    0s
H    0     0                    -129651.2952 -129827.18  0.14%     -    0s
H    0     0                    -129670.3039 -129827.18  0.12%     -    0s
     0     0 -129827.18    0   50 -129670.30 -129827.18  0.12%     -    0s
     0     0 -129827.18    0   50 -129670.30 -129827.18  0.12%     -    0s
H    0     0                    -129688.0110 -129827.18  0.11%     -    0s
     0     0 -129827.18    0   36 -129688.01 -129827.18  0.11%     -    0s
     0     0 -129767.80    0   29 -129688.01 -129767.80  0.06%     -    0s
     0     0 -129767.27    0   29 -129688.01 -129767.27  0.06%     -    0s
     0     0 -129756.51    0   28 -129688.01 -129756.51  0.05%     -    0s
     0     0 -129747.22    0   28 -129688.01 -129747.22  0.05%     -    0s
     0     0 -129747.22    0   26 -129688.01 -129747.22  0.05%     -    0s

Cutting planes:
  Gomory: 16
  Implied bound: 5
  MIR: 39
  Flow cover: 11
  RLT: 14

Explored 1 nodes (823 simplex iterations) in 0.13 seconds (0.06 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -129688 -129670 -129651 ... 6.82796e+06
No other solutions better than -129688

Optimal solution found (tolerance 1.00e-06)
Best objective -1.296880109546e+05, best bound -1.296880109546e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 169459.80
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129688.01
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -129688.01 = 169459.80
  [DEBUG]   Current θ from Master = 173188.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3728.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21863.54
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 738.7683, Absolute Gap = 738.7683, Relative Gap = 0.028867
  Not converged yet (gap = 738.77 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0x03075708
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120752 rows and 49071 columns (presolve time = 5s)...
Presolve removed 120752 rows and 49071 columns
Presolve time: 5.07s
Presolved: 140561 rows, 59269 columns, 867179 nonzeros
Variable types: 57010 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.53s

Barrier statistics:
 Dense cols : 656
 AA' NZ     : 6.863e+06
 Factor NZ  : 1.550e+07 (roughly 200 MB of memory)
 Factor Ops : 3.719e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.86835603e+07  2.62672844e+08  1.17e+05 1.74e+01  8.14e+04     8s
   1  -1.42966417e+07  2.30503644e+08  8.11e+04 6.42e+01  5.59e+04     8s
   2  -5.16886457e+06  1.69829264e+08  2.86e+04 1.05e+00  2.09e+04     8s
   3  -1.14535360e+06  1.22827951e+08  3.64e+03 1.52e+00  2.99e+03     8s
   4  -6.24861320e+05  7.42081386e+07  8.64e+02 7.05e-01  8.45e+02     8s
   5  -4.92423956e+05  3.79679694e+07  3.64e+02 2.49e-01  3.58e+02     8s
   6  -3.77451643e+05  2.74686158e+07  1.15e+02 1.61e-01  1.70e+02     8s
   7  -2.67666035e+05  1.89464048e+07  3.44e+01 1.01e-01  9.06e+01     9s
   8  -1.69723568e+05  1.21993730e+07  1.42e+01 6.20e-02  5.31e+01     9s
   9  -1.20296121e+05  5.76216465e+06  7.17e+00 2.69e-02  2.43e+01     9s
  10  -9.48979570e+04  2.96311969e+06  3.36e+00 1.34e-02  1.23e+01     9s
  11  -8.09984235e+04  1.61998260e+06  2.07e+00 7.11e-03  6.76e+00     9s
  12  -5.69774761e+04  5.14367416e+05  9.39e-01 2.22e-03  2.25e+00     9s
  13  -2.45037872e+04  3.09584280e+05  4.50e-01 1.31e-03  1.31e+00     9s
  14  -1.04290911e+04  2.20394732e+05  3.37e-01 1.22e-03  9.05e-01    10s
  15  -1.42551121e+03  1.80102666e+05  2.81e-01 1.11e-03  7.11e-01    10s
  16   8.15009493e+03  1.33187968e+05  2.27e-01 1.51e-03  4.90e-01    10s
  17   1.52521685e+04  1.18380844e+05  1.85e-01 1.34e-03  4.04e-01    10s
  18   2.03774687e+04  9.87318026e+04  1.56e-01 1.64e-03  3.07e-01    10s
  19   2.51041148e+04  7.89729005e+04  1.30e-01 2.06e-03  2.11e-01    10s
  20   2.93053339e+04  7.15902821e+04  1.08e-01 1.74e-03  1.66e-01    10s
  21   3.36224673e+04  6.67250070e+04  8.57e-02 1.50e-03  1.30e-01    11s
  22   3.63571965e+04  6.27464302e+04  7.22e-02 2.62e-03  1.04e-01    11s
  23   3.96664034e+04  6.03289332e+04  5.66e-02 1.96e-03  8.11e-02    11s
  24   4.12388326e+04  5.87635048e+04  4.96e-02 1.65e-03  6.88e-02    11s
  25   4.21982185e+04  5.77055894e+04  4.52e-02 1.89e-03  6.09e-02    11s
  26   4.40212957e+04  5.62154603e+04  3.74e-02 1.35e-03  4.79e-02    11s
  27   4.55758106e+04  5.55889993e+04  3.05e-02 1.38e-03  3.94e-02    11s
  28   4.62875812e+04  5.50487026e+04  2.76e-02 1.35e-03  3.44e-02    11s
  29   4.74291312e+04  5.47812627e+04  2.26e-02 1.21e-03  2.89e-02    12s
  30   4.79786574e+04  5.41322710e+04  2.03e-02 9.26e-04  2.42e-02    12s
  31   4.92127844e+04  5.39563971e+04  1.49e-02 8.02e-04  1.86e-02    12s
  32   4.96491510e+04  5.39254024e+04  1.30e-02 7.80e-04  1.68e-02    12s
  33   5.02151134e+04  5.34724850e+04  1.06e-02 4.63e-04  1.28e-02    12s
  34   5.04517801e+04  5.33551964e+04  9.64e-03 3.74e-04  1.14e-02    13s
  35   5.05995218e+04  5.33339789e+04  9.02e-03 3.59e-04  1.08e-02    13s
  36   5.06466359e+04  5.32585249e+04  8.83e-03 3.05e-04  1.03e-02    13s
  37   5.12155502e+04  5.31672901e+04  6.50e-03 1.95e-04  7.68e-03    13s
  38   5.17123991e+04  5.31035955e+04  4.44e-03 1.57e-04  5.47e-03    13s
  39   5.18621201e+04  5.30587169e+04  3.80e-03 1.30e-04  4.70e-03    14s
  40   5.21234578e+04  5.30296726e+04  2.79e-03 1.15e-04  3.56e-03    14s
  41   5.22241906e+04  5.29912693e+04  2.39e-03 9.15e-05  3.02e-03    14s
  42   5.23273841e+04  5.29256215e+04  1.99e-03 5.18e-05  2.35e-03    14s
  43   5.24187455e+04  5.29041917e+04  1.62e-03 3.94e-05  1.91e-03    14s
  44   5.25247354e+04  5.28934602e+04  1.19e-03 3.80e-05  1.45e-03    14s
  45   5.26200036e+04  5.28741724e+04  8.05e-04 3.68e-05  9.99e-04    15s
  46   5.26911939e+04  5.28612007e+04  5.23e-04 4.36e-05  6.68e-04    15s
  47   5.27657699e+04  5.28466422e+04  2.38e-04 2.09e-05  3.18e-04    15s
  48   5.27678139e+04  5.28424237e+04  2.31e-04 1.46e-05  2.93e-04    15s
  49   5.27930983e+04  5.28388006e+04  1.39e-04 8.83e-06  1.80e-04    15s
  50   5.28182443e+04  5.28377028e+04  4.77e-05 7.09e-06  7.64e-05    16s
  51   5.28223087e+04  5.28347973e+04  3.31e-05 3.97e-06  4.90e-05    16s
  52   5.28273962e+04  5.28334569e+04  1.67e-05 1.49e-06  2.38e-05    16s
  53   5.28283150e+04  5.28334292e+04  1.37e-05 1.44e-06  2.01e-05    16s
  54   5.28303904e+04  5.28328933e+04  6.87e-06 4.46e-07  9.83e-06    16s
  55   5.28318708e+04  5.28327722e+04  1.90e-06 2.68e-07  3.54e-06    16s
  56   5.28323264e+04  5.28326872e+04  6.65e-07 1.31e-07  1.42e-06    17s
  57   5.28323462e+04  5.28326316e+04  6.16e-07 5.46e-08  1.12e-06    17s
  58   5.28325926e+04  5.28325930e+04  1.48e-07 8.07e-08  1.50e-09    17s

Barrier solved model in 58 iterations and 16.99 seconds (15.01 work units)
Optimal objective 5.28325926e+04


Root crossover log...

  125388 DPushes remaining with DInf 0.0000000e+00                17s
   32811 DPushes remaining with DInf 0.0000000e+00                20s
     822 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                26s

   13393 PPushes remaining with PInf 4.3770914e-05                26s
       0 PPushes remaining with PInf 0.0000000e+00                28s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.4827813e+02     28s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   78549    5.2832593e+04   0.000000e+00   8.482781e+02     28s
   78705    5.2832593e+04   0.000000e+00   0.000000e+00     28s
   78705    5.2832593e+04   0.000000e+00   0.000000e+00     28s
Concurrent spin time: 6.75s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.283259e+04, 78705 iterations, 28.74 seconds (31.95 work units)
Total elapsed time = 35.34s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52832.5929    0  145 -239613.87 52832.5929   122%     -   35s
H    0     0                    -213982.2109 52832.5929   125%     -   37s
H    0     0                    -212981.6844 52832.5929   125%     -   37s
H    0     0                    -212783.3529 52832.5929   125%     -   37s
H    0     0                    -203032.9669 52832.5929   126%     -   39s
H    0     0                    -56472.32618 52832.5929   194%     -   39s
H    0     0                    -56146.20082 52832.5929   194%     -   39s
H    0     0                    -26515.61061 52832.5929   299%     -   39s
H    0     0                    -21789.30525 52832.5929   342%     -   39s
H    0     0                    24373.154169 52832.5929   117%     -   40s
H    0     0                    24908.631106 52832.5929   112%     -   40s
H    0     0                    25011.859949 52832.5929   111%     -   41s
H    0     0                    25090.028157 52832.5929   111%     -   41s
H    0     0                    25147.019562 52832.5929   110%     -   41s
     0     0 47238.2419    0  261 25147.0196 47238.2419  87.8%     -  122s
     0     0 46836.1688    0  244 25147.0196 46836.1688  86.2%     -  163s
     0     0 46504.1316    0  257 25147.0196 46504.1316  84.9%     -  197s
     0     0 46490.5341    0  292 25147.0196 46490.5341  84.9%     -  210s
     0     0 46485.6369    0  294 25147.0196 46485.6369  84.9%     -  215s
     0     0 46465.3368    0  295 25147.0196 46465.3368  84.8%     -  222s
     0     0 46465.2179    0  293 25147.0196 46465.2179  84.8%     -  223s
     0     0 43964.0390    0  302 25147.0196 43964.0390  74.8%     -  288s
     0     0 43392.9645    0  303 25147.0196 43392.9645  72.6%     -  320s
     0     0 43315.2111    0  310 25147.0196 43315.2111  72.2%     -  334s
     0     0 43261.8488    0  308 25147.0196 43261.8488  72.0%     -  346s
     0     0 43210.2767    0  305 25147.0196 43210.2767  71.8%     -  354s
     0     0 43025.5193    0  294 25147.0196 43025.5193  71.1%     -  375s
     0     0 42991.6568    0  290 25147.0196 42991.6568  71.0%     -  386s
     0     0 42974.9077    0  289 25147.0196 42974.9077  70.9%     -  394s
     0     0 42957.9806    0  299 25147.0196 42957.9806  70.8%     -  400s
     0     0 42956.8604    0  307 25147.0196 42956.8604  70.8%     -  402s
     0     0 42956.6181    0  307 25147.0196 42956.6181  70.8%     -  403s
     0     0 41154.1172    0  304 25147.0196 41154.1172  63.7%     -  494s
H    0     0                    25424.829677 41152.8629  61.9%     -  495s
     0     0 40626.1663    0  338 25424.8297 40626.1663  59.8%     -  533s
     0     0 40482.7811    0  307 25424.8297 40482.7811  59.2%     -  545s
     0     0 40387.5457    0  318 25424.8297 40387.5457  58.9%     -  557s
     0     0 40276.2046    0  310 25424.8297 40276.2046  58.4%     -  571s
     0     0 40224.7126    0  330 25424.8297 40224.7126  58.2%     -  579s
     0     0 40211.3220    0  332 25424.8297 40211.3220  58.2%     -  584s
     0     0 40179.8267    0  327 25424.8297 40179.8267  58.0%     -  591s
     0     0 40167.2459    0  332 25424.8297 40167.2459  58.0%     -  597s
     0     0 40165.7035    0  334 25424.8297 40165.7035  58.0%     -  598s
     0     0 40155.8046    0  328 25424.8297 40155.8046  57.9%     -  601s
     0     0 40155.7710    0  328 25424.8297 40155.7710  57.9%     -  602s
     0     0 39530.8942    0  406 25424.8297 39530.8942  55.5%     -  655s
     0     0 39356.8395    0  402 25424.8297 39356.8395  54.8%     -  677s
     0     0 39274.0547    0  366 25424.8297 39274.0547  54.5%     -  689s
     0     0 39235.1665    0  406 25424.8297 39235.1665  54.3%     -  700s
     0     0 39182.7726    0  372 25424.8297 39182.7726  54.1%     -  709s
     0     0 39155.3028    0  370 25424.8297 39155.3028  54.0%     -  716s
     0     0 39139.9930    0  376 25424.8297 39139.9930  53.9%     -  724s
     0     0 39135.9265    0  374 25424.8297 39135.9265  53.9%     -  727s
     0     0 39131.7745    0  372 25424.8297 39131.7745  53.9%     -  730s
     0     0 39124.8241    0  374 25424.8297 39124.8241  53.9%     -  733s
     0     0 39100.6479    0  369 25424.8297 39100.6479  53.8%     -  738s
     0     0 39095.0146    0  371 25424.8297 39095.0146  53.8%     -  742s
     0     0 39093.5133    0  370 25424.8297 39093.5133  53.8%     -  745s
     0     0 38963.9834    0  380 25424.8297 38963.9834  53.3%     -  759s
     0     0 38933.2489    0  433 25424.8297 38933.2489  53.1%     -  768s
     0     0 38915.5687    0  433 25424.8297 38915.5687  53.1%     -  777s
     0     0 38905.3098    0  431 25424.8297 38905.3098  53.0%     -  782s
     0     0 38894.8466    0  433 25424.8297 38894.8466  53.0%     -  788s
     0     0 38891.5943    0  436 25424.8297 38891.5943  53.0%     -  790s
     0     0 38876.0244    0  432 25424.8297 38876.0244  52.9%     -  796s
     0     0 38866.3048    0  434 25424.8297 38866.3048  52.9%     -  802s
     0     0 38854.9719    0  430 25424.8297 38854.9719  52.8%     -  808s
     0     0 38852.4404    0  434 25424.8297 38852.4404  52.8%     -  810s
     0     0 38850.7043    0  435 25424.8297 38850.7043  52.8%     -  813s
     0     0 38847.2488    0  389 25424.8297 38847.2488  52.8%     -  816s
     0     0 38842.8290    0  436 25424.8297 38842.8290  52.8%     -  819s
     0     0 38841.4622    0  438 25424.8297 38841.4622  52.8%     -  821s
     0     0 38813.1379    0  382 25424.8297 38813.1379  52.7%     -  828s
     0     0 38806.0740    0  392 25424.8297 38806.0740  52.6%     -  835s
     0     0 38803.5364    0  392 25424.8297 38803.5364  52.6%     -  837s
     0     0 38802.9376    0  394 25424.8297 38802.9376  52.6%     -  839s
     0     0 38782.4876    0  385 25424.8297 38782.4876  52.5%     -  848s
     0     0 38773.8108    0  393 25424.8297 38773.8108  52.5%     -  854s
     0     0 38770.4195    0  384 25424.8297 38770.4195  52.5%     -  856s
     0     0 38768.8102    0  383 25424.8297 38768.8102  52.5%     -  858s
     0     0 38762.7272    0  396 25424.8297 38762.7272  52.5%     -  864s
     0     0 38758.5280    0  363 25424.8297 38758.5280  52.4%     -  869s
     0     0 38755.3850    0  402 25424.8297 38755.3850  52.4%     -  872s
     0     0 38754.9016    0  397 25424.8297 38754.9016  52.4%     -  873s
     0     0 38751.1114    0  394 25424.8297 38751.1114  52.4%     -  879s
     0     0 38749.1261    0  409 25424.8297 38749.1261  52.4%     -  882s
     0     0 38747.2564    0  398 25424.8297 38747.2564  52.4%     -  884s
     0     0 38747.0126    0  400 25424.8297 38747.0126  52.4%     -  885s
     0     0 38743.1999    0  407 25424.8297 38743.1999  52.4%     -  889s
     0     0 38741.6741    0  386 25424.8297 38741.6741  52.4%     -  892s
     0     0 38740.2286    0  393 25424.8297 38740.2286  52.4%     -  896s
     0     0 38739.3770    0  393 25424.8297 38739.3770  52.4%     -  902s
     0     2 38738.9924    0  393 25424.8297 38738.9924  52.4%     - 1096s
     1     3 38635.4440    1  369 25424.8297 38733.5598  52.3%  6870 1109s
     2     4 38509.7988    1  415 25424.8297 38635.3529  52.0%  9021 1125s
     3     7 37899.2899    2  385 25424.8297 38628.7903  51.9%  9589 1142s
     6    13 38005.4892    3  387 25424.8297 38505.2366  51.4%  9403 1163s
    12    26 37739.4014    4  373 25424.8297 38438.6919  51.2%  9734 1196s
    25    39 37107.0723    5  320 25424.8297 38207.9960  50.3% 15570 1311s
H   38    71                    25459.197738 38207.9960  50.1% 15379 1601s
    70   200 35939.3785    6  304 25459.1977 38102.6868  49.7% 17461 1661s
   199   231 35500.2977   11  280 25459.1977 38102.3139  49.7%  8740 1685s
H  208   231                    25545.990495 38102.3139  49.2%  8433 1685s
   230   262 35482.7899   12  282 25545.9905 38102.3139  49.2%  8051 1711s
   261   292 35434.0455   13  275 25545.9905 38102.3139  49.2%  7685 1744s
   291   324 35172.2741   14  282 25545.9905 38102.3139  49.2%  7509 1772s
   323   351 35067.3799   15  277 25545.9905 38102.3139  49.2%  7308 1802s
   356   379 35059.7781   16  271 25545.9905 38102.3139  49.2%  7238 1844s
   399   404 34158.4704   17  304 25545.9905 38102.3139  49.2%  7025 1876s
   427   435 33964.4502   18  316 25545.9905 38102.3139  49.2%  6863 1907s
   466   471 33876.4856   22  260 25545.9905 38102.3139  49.2%  6912 1932s
   512   512 33105.1501   25  292 25545.9905 38102.3139  49.2%  7001 1958s
   561   542 29880.7630   27  158 25545.9905 38102.3139  49.2%  7215 1986s
   609   578 29849.8406   28  143 25545.9905 38102.3139  49.2%  7266 2012s
   656   620 28963.3431   31  136 25545.9905 38102.3139  49.2%  7374 2037s
   707   657 27959.7460   34  185 25545.9905 38102.3139  49.2%  7444 2070s
   752   708 27932.0525   35  180 25545.9905 38102.3139  49.2%  7484 2096s
   821   755     cutoff   40      25545.9905 38102.3139  49.2%  7347 2123s
   884   815 32583.4447   15  254 25545.9905 38102.3139  49.2%  7269 2152s
   966   856 33464.2526   14  289 25545.9905 38102.3139  49.2%  7194 2178s
  1051   901 28370.7400   15  260 25545.9905 38102.3139  49.2%  7081 2208s
  1142   965 28150.7772   16  262 25545.9905 38102.3139  49.2%  6905 2239s
  1237  1013 27072.2064   18  240 25545.9905 38102.3139  49.2%  6841 2270s
  1321  1074     cutoff   19      25545.9905 38102.3139  49.2%  6833 2302s
  1424  1119 26192.7862   22  166 25545.9905 38102.3139  49.2%  6708 2335s
  1537  1200 31449.6800   34  157 25545.9905 38102.3139  49.2%  6607 2365s
  1662  1282 31024.1412   38  137 25545.9905 38102.3139  49.2%  6569 2401s
  1806  1338 30747.4527   42  120 25545.9905 38102.3139  49.2%  6453 2435s
  1913  1433 30628.2081   44  118 25545.9905 37968.1335  48.6%  6416 2468s
  2026  1535 30327.1537   45  126 25545.9905 37968.1335  48.6%  6378 2504s
  2150  1640 26866.2233   46  111 25545.9905 37968.1335  48.6%  6310 2540s
  2315  1746 29609.7315   49  114 25545.9905 37968.1335  48.6%  6198 2580s
  2466  1872     cutoff   47      25545.9905 37968.1335  48.6%  6124 2620s
  2668  1965 29197.6628   56  119 25545.9905 37968.1335  48.6%  5995 2663s
  2847  2072 28715.0489   61   91 25545.9905 37968.1335  48.6%  5910 2705s
  3022  2156 28645.8528   63   84 25545.9905 37741.8306  47.7%  5901 2752s
  3158  2281 28085.4074   66   88 25545.9905 37741.8306  47.7%  5978 2800s
  3341  2409 27572.4343   70   93 25545.9905 37741.8306  47.7%  5984 2845s
  3523  2547 26546.0289   73   76 25545.9905 37741.8306  47.7%  6015 2893s
  3727  2548 29571.7938   40  393 25545.9905 37727.6256  47.7%  6006 3284s
  3729  2549 35007.2947   14  120 25545.9905 37727.6256  47.7%  6003 3316s
  3730  2550 34779.5784   19  323 25545.9905 37727.6256  47.7%  6001 3491s
  3731  2551 30299.5826   16  319 25545.9905 37727.6256  47.7%  6000 3599s

Cutting planes:
  MIR: 191
  Flow cover: 588
  RLT: 17
  Relax-and-lift: 99

Explored 3731 nodes (23094706 simplex iterations) in 3600.09 seconds (5354.73 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25546 25459.2 25424.8 ... -26515.6

Time limit reached
Best objective 2.554599049462e+04, best bound 3.772762564203e+04, gap 47.6851%
  WARNING: Time limit reached. Using best solution found (gap: 47.69%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 25545.99, θ = 172717.38
  Upper Bound (UB) = 25545.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172717.38
  [DEBUG]   ✓ Scenario 0: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 172717.38 ≤ Q = 172717.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 172717.38 ≤ Q = 172717.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 172717.38 ≤ Q = 172717.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x854aa11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf7ab55ef
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [7e-16, 2e+02]
Found heuristic solution: objective 1.430501e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6842629.3816
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.571617e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157161.71    0  124 6842629.38 -157161.71   102%     -    0s
H    0     0                    -122011.3004 -157161.71  28.8%     -    0s
H    0     0                    -122274.5529 -157161.71  28.5%     -    0s
     0     0 -129991.01    0   62 -122274.55 -129991.01  6.31%     -    0s
H    0     0                    -127721.7924 -129858.94  1.67%     -    0s
H    0     0                    -128267.0903 -129858.94  1.24%     -    0s
     0     0 -129167.33    0   64 -128267.09 -129167.33  0.70%     -    0s
     0     0 -128802.02    0   44 -128267.09 -128802.02  0.42%     -    0s
H    0     0                    -128270.1614 -128764.99  0.39%     -    0s
H    0     0                    -128290.2230 -128764.99  0.37%     -    0s
     0     0 -128764.99    0   45 -128290.22 -128764.99  0.37%     -    0s
     0     0 -128620.91    0   40 -128290.22 -128620.91  0.26%     -    0s
     0     0 -128573.13    0   40 -128290.22 -128573.13  0.22%     -    0s
     0     0 -128573.13    0   47 -128290.22 -128573.13  0.22%     -    0s
     0     0 -128573.13    0   47 -128290.22 -128573.13  0.22%     -    0s
     0     0 -128573.13    0   34 -128290.22 -128573.13  0.22%     -    0s
H    0     0                    -128302.9723 -128510.85  0.16%     -    0s
     0     0 -128510.85    0   31 -128302.97 -128510.85  0.16%     -    0s
     0     0 -128461.26    0   32 -128302.97 -128461.26  0.12%     -    0s
     0     0 -128459.90    0   32 -128302.97 -128459.90  0.12%     -    0s
     0     0 -128437.16    0   31 -128302.97 -128437.16  0.10%     -    0s
     0     0 -128432.34    0   31 -128302.97 -128432.34  0.10%     -    0s
     0     0 -128432.34    0   28 -128302.97 -128432.34  0.10%     -    0s
     0     0 -128430.83    0   28 -128302.97 -128430.83  0.10%     -    0s
     0     0 -128430.83    0   37 -128302.97 -128430.83  0.10%     -    0s
     0     0 -128430.83    0   31 -128302.97 -128430.83  0.10%     -    0s
     0     0 -128430.83    0   28 -128302.97 -128430.83  0.10%     -    0s
     0     0 -128430.83    0   27 -128302.97 -128430.83  0.10%     -    0s
     0     0 -128409.42    0   26 -128302.97 -128409.42  0.08%     -    0s
     0     0 -128394.88    0   26 -128302.97 -128394.88  0.07%     -    0s
H    0     0                    -128329.7255 -128394.88  0.05%     -    0s
     0     0 -128370.61    0   26 -128329.73 -128370.61  0.03%     -    0s
     0     2 -128370.61    0   26 -128329.73 -128370.61  0.03%     -    0s

Cutting planes:
  Gomory: 15
  Implied bound: 2
  MIR: 37
  Flow cover: 8

Explored 4 nodes (1158 simplex iterations) in 0.28 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -128330 -128303 -128290 ... 1.4305e+13
No other solutions better than -128330

Optimal solution found (tolerance 1.00e-06)
Best objective -1.283297254512e+05, best bound -1.283297254512e+05, gap 0.0000%
  Subproblem solved in 0.31s
  Worst-case operational profit (Z_SP) = 170818.09
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128329.73
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -128329.73 = 170818.09
  [DEBUG]   Current θ from Master = 172717.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1899.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23646.70
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 692.3086, Absolute Gap = 692.3086, Relative Gap = 0.027100
  Not converged yet (gap = 692.31 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0x172ee5ca
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127880 rows and 51970 columns (presolve time = 5s)...
Presolve removed 127880 rows and 51970 columns
Presolve time: 5.30s
Presolved: 148723 rows, 62610 columns, 918023 nonzeros
Variable types: 60351 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.59s

Barrier statistics:
 Dense cols : 656
 AA' NZ     : 7.617e+06
 Factor NZ  : 1.717e+07 (roughly 220 MB of memory)
 Factor Ops : 4.289e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.92303009e+07  2.75471150e+08  1.20e+05 1.66e+01  8.33e+04     8s
   1  -1.47568628e+07  2.42472374e+08  8.36e+04 6.48e+01  5.74e+04     8s
   2  -5.49586565e+06  1.78602656e+08  3.03e+04 1.13e+00  2.21e+04     9s
   3  -1.21697037e+06  1.30401229e+08  4.02e+03 1.64e+00  3.25e+03     9s
   4  -6.26193998e+05  8.34549231e+07  8.39e+02 7.55e-01  8.51e+02     9s
   5  -5.00669963e+05  4.24775019e+07  3.64e+02 2.96e-01  3.67e+02     9s
   6  -3.92889767e+05  3.07345752e+07  1.17e+02 1.88e-01  1.77e+02     9s
   7  -2.96006763e+05  2.16202036e+07  3.57e+01 1.22e-01  9.73e+01     9s
   8  -2.11605087e+05  1.46538085e+07  1.67e+01 7.81e-02  6.08e+01     9s
   9  -1.44673181e+05  8.42401366e+06  7.03e+00 4.23e-02  3.33e+01     9s
  10  -1.01462782e+05  4.18954458e+06  2.86e+00 1.99e-02  1.62e+01    10s
  11  -9.24535964e+04  2.74456331e+06  2.15e+00 1.30e-02  1.07e+01    10s
  12  -7.16995496e+04  1.55415305e+06  1.13e+00 7.27e-03  6.05e+00    10s
  13  -4.90556393e+04  5.90375428e+05  5.12e-01 2.73e-03  2.37e+00    10s
  14  -1.44418564e+04  3.11658816e+05  2.39e-01 1.33e-03  1.21e+00    10s
  15  -3.05782126e+03  2.47230591e+05  1.81e-01 1.05e-03  9.25e-01    10s
  16   7.57150734e+03  1.79629381e+05  1.35e-01 1.12e-03  6.36e-01    10s
  17   1.32304437e+04  1.50268276e+05  1.13e-01 1.21e-03  5.07e-01    10s
  18   2.05817001e+04  1.19859718e+05  8.61e-02 1.10e-03  3.67e-01    10s
  19   2.58920446e+04  9.34031606e+04  6.78e-02 1.32e-03  2.50e-01    11s
  20   3.09807728e+04  8.14574732e+04  5.21e-02 2.54e-03  1.87e-01    11s
  21   3.37030642e+04  7.79342350e+04  4.43e-02 2.46e-03  1.64e-01    11s
  22   3.60345071e+04  6.67728619e+04  3.81e-02 1.62e-03  1.14e-01    11s
  23   3.81381457e+04  6.42356381e+04  3.30e-02 1.58e-03  9.65e-02    11s
  24   4.11074591e+04  6.17250016e+04  2.59e-02 1.64e-03  7.63e-02    11s
  25   4.33661067e+04  5.91527119e+04  2.06e-02 1.15e-03  5.84e-02    11s
  26   4.48082564e+04  5.76435794e+04  1.74e-02 8.58e-04  4.75e-02    11s
  27   4.65203547e+04  5.65451590e+04  1.35e-02 6.63e-04  3.71e-02    12s
  28   4.72414799e+04  5.59261097e+04  1.19e-02 5.52e-04  3.21e-02    12s
  29   4.89410550e+04  5.56232303e+04  8.18e-03 4.92e-04  2.47e-02    12s
  30   4.96065725e+04  5.42051767e+04  6.81e-03 2.33e-04  1.70e-02    12s
  31   4.97778408e+04  5.40687006e+04  6.46e-03 2.07e-04  1.59e-02    12s
  32   5.06357374e+04  5.39093707e+04  4.73e-03 1.79e-04  1.21e-02    12s
  33   5.11135508e+04  5.36967128e+04  3.73e-03 1.36e-04  9.56e-03    13s
  34   5.13408502e+04  5.35973845e+04  3.28e-03 1.17e-04  8.35e-03    13s
  35   5.14665093e+04  5.34461064e+04  3.02e-03 8.76e-05  7.33e-03    13s
  36   5.18071466e+04  5.33383676e+04  2.33e-03 6.57e-05  5.67e-03    13s
  37   5.20845536e+04  5.32779288e+04  1.77e-03 5.31e-05  4.42e-03    13s
  38   5.21657549e+04  5.31996094e+04  1.60e-03 3.84e-05  3.83e-03    13s
  39   5.24037113e+04  5.31348488e+04  1.12e-03 2.59e-05  2.71e-03    14s
  40   5.24732488e+04  5.31136278e+04  9.81e-04 2.22e-05  2.37e-03    14s
  41   5.25632238e+04  5.30604453e+04  8.05e-04 5.02e-05  1.84e-03    14s
  42   5.25972668e+04  5.30254475e+04  7.38e-04 2.89e-05  1.59e-03    14s
  43   5.27931082e+04  5.30102096e+04  3.47e-04 1.62e-05  8.04e-04    14s
  44   5.28209125e+04  5.29972225e+04  2.94e-04 7.76e-06  6.53e-04    14s
  45   5.28329595e+04  5.29923053e+04  2.71e-04 5.73e-06  5.90e-04    15s
  46   5.28586966e+04  5.29905511e+04  2.22e-04 4.89e-06  4.88e-04    15s
  47   5.28797627e+04  5.29897977e+04  1.83e-04 4.60e-06  4.07e-04    15s
  48   5.28934212e+04  5.29846005e+04  1.58e-04 7.74e-06  3.38e-04    15s
  49   5.29316518e+04  5.29836377e+04  8.75e-05 6.39e-06  1.93e-04    15s
  50   5.29647404e+04  5.29799162e+04  2.39e-05 1.08e-06  5.62e-05    16s
  51   5.29770698e+04  5.29787419e+04  2.55e-06 3.97e-06  6.19e-06    16s
  52   5.29786097e+04  5.29786285e+04  3.77e-08 1.43e-07  6.96e-08    16s
  53   5.29786249e+04  5.29786249e+04  5.12e-10 8.47e-11  1.01e-10    16s

Barrier solved model in 53 iterations and 15.93 seconds (15.84 work units)
Optimal objective 5.29786249e+04


Root crossover log...

  134389 DPushes remaining with DInf 0.0000000e+00                16s
    5706 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

    3197 PPushes remaining with PInf 2.3810845e-05                22s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.0705233e+01     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63037    5.2978625e+04   0.000000e+00   8.070523e+01     22s
   63147    5.2978625e+04   0.000000e+00   0.000000e+00     22s
   63147    5.2978625e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 5.297862e+04, 63147 iterations, 15.62 seconds (19.32 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52978.6249    0  101 -239613.87 52978.6249   122%     -   22s
H    0     0                    -236970.1399 52978.6249   122%     -   22s
H    0     0                    -230517.6236 52978.6249   123%     -   23s
H    0     0                    -227779.8691 52978.6249   123%     -   23s
H    0     0                    -175642.2886 52978.6249   130%     -   24s
H    0     0                    -164718.1577 52978.6249   132%     -   25s
H    0     0                    -164665.1333 52978.6249   132%     -   25s
H    0     0                    -56472.32618 52978.6249   194%     -   25s
H    0     0                    -56310.29519 52978.6249   194%     -   25s
H    0     0                    14728.094768 52978.6249   260%     -   25s
H    0     0                    23979.811078 52978.6249   121%     -   26s
H    0     0                    24908.631106 52978.6249   113%     -   26s
     0     0 47221.7264    0  118 24908.6311 47221.7264  89.6%     -   93s
H    0     0                    25424.829677 47221.3590  85.7%     -   94s
     0     0 46845.6299    0  243 25424.8297 46845.6299  84.3%     -  128s
     0     0 46843.4910    0  245 25424.8297 46843.4910  84.2%     -  132s
     0     0 46841.8690    0  245 25424.8297 46841.8690  84.2%     -  133s
     0     0 46824.4302    0  251 25424.8297 46824.4302  84.2%     -  136s
     0     0 46703.0938    0  253 25424.8297 46703.0938  83.7%     -  146s
     0     0 46581.5719    0  295 25424.8297 46581.5719  83.2%     -  161s
     0     0 46580.3006    0  296 25424.8297 46580.3006  83.2%     -  163s
     0     0 46580.1262    0  300 25424.8297 46580.1262  83.2%     -  164s
     0     0 44213.4774    0  196 25424.8297 44213.4774  73.9%     -  217s
     0     0 43610.8808    0  210 25424.8297 43610.8808  71.5%     -  240s
     0     0 43319.5541    0  254 25424.8297 43319.5541  70.4%     -  256s
     0     0 43244.2994    0  213 25424.8297 43244.2994  70.1%     -  266s
     0     0 43225.5455    0  255 25424.8297 43225.5455  70.0%     -  274s
     0     0 43222.7892    0  257 25424.8297 43222.7892  70.0%     -  280s
     0     0 43219.0199    0  258 25424.8297 43219.0199  70.0%     -  285s
     0     0 43218.6998    0  260 25424.8297 43218.6998  70.0%     -  286s
     0     0 41136.2681    0  306 25424.8297 41136.2681  61.8%     -  380s
     0     0 40741.8443    0  362 25424.8297 40741.8443  60.2%     -  424s
     0     0 40611.0958    0  358 25424.8297 40611.0958  59.7%     -  440s
     0     0 40533.7169    0  367 25424.8297 40533.7169  59.4%     -  452s
     0     0 40516.0117    0  375 25424.8297 40516.0117  59.4%     -  457s
     0     0 40484.8027    0  375 25424.8297 40484.8027  59.2%     -  466s
     0     0 40460.1652    0  378 25424.8297 40460.1652  59.1%     -  472s
     0     0 40453.5398    0  376 25424.8297 40453.5398  59.1%     -  476s
     0     0 40436.9145    0  377 25424.8297 40436.9145  59.0%     -  480s
     0     0 40432.8360    0  379 25424.8297 40432.8360  59.0%     -  482s
     0     0 40430.6135    0  384 25424.8297 40430.6135  59.0%     -  484s
     0     0 40428.1384    0  382 25424.8297 40428.1384  59.0%     -  486s
     0     0 40420.1955    0  344 25424.8297 40420.1955  59.0%     -  489s
     0     0 40418.1086    0  343 25424.8297 40418.1086  59.0%     -  490s
     0     0 40418.0255    0  343 25424.8297 40418.0255  59.0%     -  491s
     0     0 40011.7232    0  409 25424.8297 40011.7232  57.4%     -  536s
     0     0 39822.7489    0  402 25424.8297 39822.7489  56.6%     -  561s
     0     0 39727.6168    0  357 25424.8297 39727.6168  56.3%     -  576s
     0     0 39658.8574    0  403 25424.8297 39658.8574  56.0%     -  589s
     0     0 39634.7739    0  366 25424.8297 39634.7739  55.9%     -  597s
     0     0 39627.6144    0  364 25424.8297 39627.6144  55.9%     -  602s
     0     0 39622.7527    0  416 25424.8297 39622.7527  55.8%     -  605s
     0     0 39603.0267    0  415 25424.8297 39603.0267  55.8%     -  610s
     0     0 39558.4382    0  408 25424.8297 39558.4382  55.6%     -  621s
     0     0 39530.5165    0  408 25424.8297 39530.5165  55.5%     -  629s
     0     0 39521.0135    0  416 25424.8297 39521.0135  55.4%     -  634s
     0     0 39518.0543    0  421 25424.8297 39518.0543  55.4%     -  636s
     0     0 39515.1845    0  420 25424.8297 39515.1845  55.4%     -  638s
     0     0 39499.0912    0  415 25424.8297 39499.0912  55.4%     -  642s
     0     0 39496.9403    0  427 25424.8297 39496.9403  55.3%     -  644s
     0     0 39493.0114    0  423 25424.8297 39493.0114  55.3%     -  647s
     0     0 39491.6869    0  425 25424.8297 39491.6869  55.3%     -  648s
     0     0 39190.2328    0  420 25424.8297 39190.2328  54.1%     -  668s
     0     0 39140.3384    0  421 25424.8297 39140.3384  53.9%     -  679s
     0     0 39104.8296    0  420 25424.8297 39104.8296  53.8%     -  688s
     0     0 39093.0989    0  417 25424.8297 39093.0989  53.8%     -  693s
     0     0 39078.2787    0  415 25424.8297 39078.2787  53.7%     -  700s
     0     0 39074.4962    0  413 25424.8297 39074.4962  53.7%     -  704s
     0     0 39068.7709    0  419 25424.8297 39068.7709  53.7%     -  706s
     0     0 39067.6759    0  420 25424.8297 39067.6759  53.7%     -  708s
     0     0 38956.3100    0  423 25424.8297 38956.3100  53.2%     -  723s
H    0     0                    25486.195688 38956.0457  52.9%     -  740s
     0     0 38896.7227    0  426 25486.1957 38896.7227  52.6%     -  751s
     0     0 38881.2246    0  432 25486.1957 38881.2246  52.6%     -  759s
     0     0 38871.9320    0  430 25486.1957 38871.9320  52.5%     -  765s
     0     0 38859.4673    0  433 25486.1957 38859.4673  52.5%     -  771s
     0     0 38847.3353    0  436 25486.1957 38847.3353  52.4%     -  777s
     0     0 38842.6558    0  437 25486.1957 38842.6558  52.4%     -  781s
     0     0 38838.7304    0  432 25486.1957 38838.7304  52.4%     -  783s
     0     0 38835.4263    0  434 25486.1957 38835.4263  52.4%     -  786s
     0     0 38832.7143    0  438 25486.1957 38832.7143  52.4%     -  789s
     0     0 38831.5667    0  437 25486.1957 38831.5667  52.4%     -  792s
     0     0 38785.2135    0  443 25486.1957 38785.2135  52.2%     -  804s
     0     0 38779.1088    0  442 25486.1957 38779.1088  52.2%     -  810s
     0     0 38758.2692    0  445 25486.1957 38758.2692  52.1%     -  818s
     0     0 38730.0744    0  445 25486.1957 38730.0744  52.0%     -  826s
     0     0 38725.7147    0  400 25486.1957 38725.7147  51.9%     -  830s
     0     0 38712.2888    0  395 25486.1957 38712.2888  51.9%     -  833s
     0     0 38708.1929    0  439 25486.1957 38708.1929  51.9%     -  836s
     0     0 38705.9517    0  436 25486.1957 38705.9517  51.9%     -  838s
     0     0 38704.7190    0  434 25486.1957 38704.7190  51.9%     -  840s
     0     0 38681.4040    0  432 25486.1957 38681.4040  51.8%     -  852s
H    0     0                    25511.140411 38681.0952  51.6%     -  873s
     0     0 38672.8778    0  400 25511.1404 38672.8778  51.6%     -  881s
     0     0 38670.2853    0  439 25511.1404 38670.2853  51.6%     -  883s
     0     0 38667.9454    0  438 25511.1404 38667.9454  51.6%     -  885s
     0     0 38666.8326    0  440 25511.1404 38666.8326  51.6%     -  887s
     0     0 38656.5591    0  347 25511.1404 38656.5591  51.5%     -  894s
H    0     0                    25513.935203 38656.4981  51.5%     -  895s
     0     0 38644.9583    0  444 25513.9352 38644.9583  51.5%     -  901s
     0     0 38642.9521    0  449 25513.9352 38642.9521  51.5%     -  903s
     0     0 38642.3939    0  449 25513.9352 38642.3939  51.5%     -  905s
     0     0 38625.9955    0  484 25513.9352 38625.9955  51.4%     -  917s
     0     0 38613.1266    0  389 25513.9352 38613.1266  51.3%     -  924s
     0     0 38607.3828    0  443 25513.9352 38607.3828  51.3%     -  931s
     0     0 38594.5415    0  434 25513.9352 38594.5415  51.3%     -  936s
     0     0 38591.4453    0  442 25513.9352 38591.4453  51.3%     -  938s
     0     0 38589.3689    0  393 25513.9352 38589.3689  51.2%     -  940s
     0     0 38587.1743    0  442 25513.9352 38587.1743  51.2%     -  944s
     0     0 38585.4180    0  442 25513.9352 38585.4180  51.2%     -  946s
     0     0 38585.1369    0  446 25513.9352 38585.1369  51.2%     -  948s
     0     0 38575.0100    0  445 25513.9352 38575.0100  51.2%     -  954s
     0     0 38572.3602    0  440 25513.9352 38572.3602  51.2%     -  958s
     0     0 38569.9350    0  452 25513.9352 38569.9350  51.2%     -  960s
     0     0 38569.3204    0  487 25513.9352 38569.3204  51.2%     -  962s
     0     0 38565.3266    0  447 25513.9352 38565.3266  51.2%     -  968s
     0     0 38563.5218    0  442 25513.9352 38563.5218  51.1%     -  971s
     0     0 38559.7990    0  396 25513.9352 38559.7990  51.1%     -  975s
     0     0 38558.5685    0  442 25513.9352 38558.5685  51.1%     -  979s
     0     0 38556.8678    0  441 25513.9352 38556.8678  51.1%     -  984s
     0     0 38556.5535    0  445 25513.9352 38556.5535  51.1%     -  986s
     0     0 38554.8696    0  442 25513.9352 38554.8696  51.1%     -  991s
     0     0 38554.7613    0  442 25513.9352 38554.7613  51.1%     -  998s
     0     2 38554.1691    0  442 25513.9352 38554.1691  51.1%     - 1586s
     1     4 38525.1239    1  383 25513.9352 38554.0944  51.1%  5051 1609s
     3     8 38435.7112    2  372 25513.9352 38524.0674  51.0%  7964 1640s
     7    16 38163.6201    3  370 25513.9352 38435.2612  50.6% 10830 1726s
    15    32 37726.3655    4  367 25513.9352 38163.2259  49.6% 14433 1776s
    31    48 37431.4499    5  371 25513.9352 37792.2335  48.1% 18562 1913s
    47    80 36745.2468    6  381 25513.9352 37792.2335  48.1% 21828 1985s
    79   162 36694.7348    7  327 25513.9352 37792.2335  48.1% 18125 2058s
   161   231 36129.2254    9  308 25513.9352 37792.2335  48.1% 12615 2111s
   230   290 36243.7014   11  348 25513.9352 37792.2335  48.1% 10777 2163s
   289   350 35744.2544   10  361 25513.9352 37792.2335  48.1%  9703 2206s
   349   409 35917.5160   10  360 25513.9352 37792.2335  48.1%  8894 2249s
   410   464 36117.4849   11  344 25513.9352 37792.2335  48.1%  8445 2286s
   465   541 35128.9505   11  223 25513.9352 37792.2335  48.1%  8253 2320s
   542   571 35643.4756   12  338 25513.9352 37792.2335  48.1%  7875 2349s
   572   602 35700.7023   13  342 25513.9352 37792.2335  48.1%  7844 2372s
   603   640 35404.6843   15  337 25513.9352 37792.2335  48.1%  7903 2396s
   643   680 35173.8923   18  383 25513.9352 37792.2335  48.1%  7757 2418s
   692   733 34881.6424   20  377 25513.9352 37792.2335  48.1%  7655 2441s
   751   778 35074.7497   19  390 25513.9352 37792.2335  48.1%  7426 2503s
   806   825 34795.6089   21  326 25513.9352 37792.2335  48.1%  7225 2531s
   875   887 34579.5036   22  324 25513.9352 37792.2335  48.1%  7117 2562s
   941   929 34192.0534   22  297 25513.9352 37792.2335  48.1%  7010 2611s
   999   992 34544.7892   22  316 25513.9352 37792.2335  48.1%  6961 2644s
  1078  1066 33874.8877   23  235 25513.9352 37792.2335  48.1%  6932 2675s
  1175  1109 34307.8778   23  310 25513.9352 37792.2335  48.1%  6742 2707s
  1278  1187 33838.4827   24  271 25513.9352 37792.2335  48.1%  6606 2740s
  1378  1268 32625.2158   24  274 25513.9352 37792.2335  48.1%  6546 2773s
  1511  1349 32445.1445   25  203 25513.9352 37792.2335  48.1%  6394 2812s
  1632  1430 32035.3748   28  236 25513.9352 37792.2335  48.1%  6343 2846s
  1755  1540 30805.1536   29  206 25513.9352 37792.2335  48.1%  6347 2881s
  1912  1645 31757.0212   30  186 25513.9352 37792.2335  48.1%  6171 2919s
  2085  1715 31423.1048   32  191 25513.9352 37792.2335  48.1%  6068 2960s
  2255  1805 31001.1567   34  118 25513.9352 37792.2335  48.1%  5961 3003s
  2436  1881 30771.9288   36  123 25513.9352 37722.1534  47.8%  5864 3046s
  2590  1934 29888.3860   39  159 25513.9352 37722.1534  47.8%  5824 3092s
  2703  2025 30490.8944   38  166 25513.9352 37722.1534  47.8%  5853 3138s
  2848  2048 29903.5230   42  152 25513.9352 37722.1534  47.8%  5879 3186s
  2885  2100 29464.1151   43  156 25513.9352 37614.6323  47.4%  5939 3236s
  2983  2167 29690.2130   42  112 25513.9352 37614.6323  47.4%  5962 3294s
  3122  2275 28912.2470   44  173 25513.9352 37614.6323  47.4%  5997 3350s
  3287  2409 26934.1701   45  138 25513.9352 37614.6323  47.4%  6018 3403s
  3491  2502 28444.8771   47  171 25513.9352 37614.6323  47.4%  5988 3458s
  3650  2595 27880.3671   49   93 25513.9352 37414.2163  46.6%  6062 3519s
  3803  2703 27444.6014   52   87 25513.9352 37414.2163  46.6%  6163 3576s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 13
  MIR: 1615
  Flow cover: 3601
  RLT: 54
  Relax-and-lift: 397

Explored 3981 nodes (25352223 simplex iterations) in 3600.18 seconds (5954.80 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25513.9 25511.1 25486.2 ... -164665

Time limit reached
Best objective 2.551393520282e+04, best bound 3.726881086652e+04, gap 46.0724%
  WARNING: Time limit reached. Using best solution found (gap: 46.07%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.23s
  Master Objective (UB) = 25513.94, θ = 172837.61
  Upper Bound (UB) = 25513.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172837.61
  [DEBUG]   ✓ Scenario 0: θ = 172837.61 ≤ Q = 172837.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172837.61 ≤ Q = 172837.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172837.61 ≤ Q = 172837.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 172837.61 ≤ Q = 172837.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 172837.61 ≤ Q = 172837.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 172837.61 ≤ Q = 172837.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 172837.61 ≤ Q = 172837.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 172837.61 ≤ Q = 172837.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2efeaddf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2efeaddf
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.433632e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6853907.0615
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.570864e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157086.35    0  124 6853907.06 -157086.35   102%     -    0s
H    0     0                    -121940.6970 -157086.35  28.8%     -    0s
H    0     0                    -122203.9495 -157086.35  28.5%     -    0s
     0     0 -129945.42    0   68 -122203.95 -129945.42  6.33%     -    0s
H    0     0                    -127059.7232 -129813.35  2.17%     -    0s
H    0     0                    -127359.5659 -129813.35  1.93%     -    0s
H    0     0                    -127882.0058 -129813.35  1.51%     -    0s
H    0     0                    -128181.8485 -129813.35  1.27%     -    0s
     0     0 -128964.10    0   69 -128181.85 -128964.10  0.61%     -    0s
H    0     0                    -128214.0918 -128925.97  0.56%     -    0s
H    0     0                    -128230.8085 -128925.97  0.54%     -    0s
     0     0 -128664.30    0   49 -128230.81 -128664.30  0.34%     -    0s
     0     0 -128639.20    0   62 -128230.81 -128639.20  0.32%     -    0s
     0     0 -128639.09    0   62 -128230.81 -128639.09  0.32%     -    0s
     0     0 -128637.63    0   63 -128230.81 -128637.63  0.32%     -    0s
     0     0 -128554.86    0   46 -128230.81 -128554.86  0.25%     -    0s
     0     0 -128528.31    0   45 -128230.81 -128528.31  0.23%     -    0s
     0     0 -128528.31    0   70 -128230.81 -128528.31  0.23%     -    0s
     0     0 -128528.31    0   50 -128230.81 -128528.31  0.23%     -    0s
     0     0 -128513.38    0   44 -128230.81 -128513.38  0.22%     -    0s
     0     0 -128490.07    0   42 -128230.81 -128490.07  0.20%     -    0s
     0     0 -128421.17    0   41 -128230.81 -128421.17  0.15%     -    0s
     0     0 -128418.92    0   41 -128230.81 -128418.92  0.15%     -    0s
     0     0 -128416.57    0   42 -128230.81 -128416.57  0.14%     -    0s
     0     0 -128414.11    0   32 -128230.81 -128414.11  0.14%     -    0s
     0     0 -128413.58    0   32 -128230.81 -128413.58  0.14%     -    0s
     0     0 -128413.51    0   32 -128230.81 -128413.51  0.14%     -    0s
     0     0 -128413.51    0   45 -128230.81 -128413.51  0.14%     -    0s
     0     0 -128413.51    0   39 -128230.81 -128413.51  0.14%     -    0s
     0     0 -128413.51    0   41 -128230.81 -128413.51  0.14%     -    0s
     0     0 -128383.77    0   40 -128230.81 -128383.77  0.12%     -    0s
     0     0 -128338.54    0   10 -128230.81 -128338.54  0.08%     -    0s
     0     0 -128330.90    0    7 -128230.81 -128330.90  0.08%     -    0s
     0     0 -128304.29    0    6 -128230.81 -128304.29  0.06%     -    0s
     0     0 -128276.99    0    5 -128230.81 -128276.99  0.04%     -    0s
     0     0 -128255.51    0    3 -128230.81 -128255.51  0.02%     -    0s
     0     0     cutoff    0      -128230.81 -128230.81  0.00%     -    0s

Cutting planes:
  Gomory: 16
  Implied bound: 1
  MIR: 36
  Flow cover: 5
  RLT: 2
  Relax-and-lift: 2

Explored 1 nodes (1256 simplex iterations) in 0.25 seconds (0.08 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -128231 -128214 -128182 ... 1.43363e+13
No other solutions better than -128231

Optimal solution found (tolerance 1.00e-06)
Best objective -1.282308084970e+05, best bound -1.282308084970e+05, gap 0.0000%
  Subproblem solved in 0.28s
  Worst-case operational profit (Z_SP) = 170917.00
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128230.81
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -128230.81 = 170917.00
  [DEBUG]   Current θ from Master = 172837.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1920.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23593.33
  Lower Bound (LB) = 24853.68
  Gap (UB-LB) = 660.2533, Absolute Gap = 660.2533, Relative Gap = 0.025878
  Not converged yet (gap = 660.25 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 826908 nonzeros
Model fingerprint: 0x66d5d390
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134990 rows and 54860 columns (presolve time = 5s)...
Presolve removed 134990 rows and 54860 columns
Presolve time: 5.52s
Presolved: 156903 rows, 65960 columns, 968117 nonzeros
Variable types: 63701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.64s

Barrier statistics:
 Dense cols : 655
 AA' NZ     : 8.392e+06
 Factor NZ  : 1.890e+07 (roughly 240 MB of memory)
 Factor Ops : 4.921e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.97604656e+07  2.88688634e+08  1.24e+05 1.67e+01  8.52e+04     9s
   1  -1.52107101e+07  2.55028916e+08  8.62e+04 6.51e+01  5.88e+04     9s
   2  -5.66650409e+06  1.87571007e+08  3.14e+04 8.18e-01  2.28e+04     9s
   3  -1.25312135e+06  1.38269532e+08  4.21e+03 1.71e+00  3.38e+03     9s
   4  -6.16990090e+05  9.09339701e+07  7.78e+02 8.21e-01  8.21e+02     9s
   5  -5.02488467e+05  4.66311440e+07  3.56e+02 3.04e-01  3.68e+02     9s
   6  -3.98879604e+05  3.40718772e+07  1.15e+02 1.96e-01  1.82e+02    10s
   7  -3.15544934e+05  2.39955407e+07  3.93e+01 1.29e-01  1.03e+02    10s
   8  -1.92986282e+05  1.91302736e+07  7.74e+00 9.96e-02  7.07e+01    10s
   9  -1.38094223e+05  8.59264032e+06  2.71e+00 4.27e-02  3.11e+01    10s
  10  -1.00600713e+05  4.38017782e+06  1.17e+00 2.11e-02  1.58e+01    10s
  11  -8.79611808e+04  2.73402801e+06  7.78e-01 1.30e-02  9.92e+00    10s
  12  -6.57659611e+04  1.24895974e+06  3.38e-01 5.58e-03  4.61e+00    11s
  13  -3.72115524e+04  4.96699142e+05  1.55e-01 2.12e-03  1.87e+00    11s
  14  -1.05473807e+04  2.83820762e+05  7.42e-02 1.15e-03  1.03e+00    11s
  15  -2.66919042e+03  2.19178919e+05  6.18e-02 1.49e-03  7.76e-01    11s
  16   7.70210119e+03  1.61672866e+05  4.74e-02 2.07e-03  5.39e-01    11s
  17   1.70240674e+04  1.20528155e+05  3.55e-02 2.18e-03  3.62e-01    11s
  18   2.17298209e+04  1.03372513e+05  2.99e-02 1.63e-03  2.86e-01    12s
  19   2.59189683e+04  8.96182571e+04  2.49e-02 1.21e-03  2.23e-01    12s
  20   2.94028354e+04  8.07210499e+04  2.10e-02 9.59e-04  1.80e-01    12s
  21   3.31832670e+04  7.40207618e+04  1.70e-02 8.66e-04  1.43e-01    12s
  22   3.58363598e+04  7.03601786e+04  1.43e-02 7.23e-04  1.21e-01    12s
  23   3.78523731e+04  6.67958536e+04  1.23e-02 5.62e-04  1.01e-01    13s
  24   3.98813746e+04  6.34149895e+04  1.05e-02 4.31e-04  8.24e-02    13s
  25   4.19520820e+04  5.99430416e+04  8.63e-03 3.17e-04  6.30e-02    13s
  26   4.39578451e+04  5.84804933e+04  6.98e-03 2.66e-04  5.08e-02    13s
  27   4.50449361e+04  5.70757108e+04  6.09e-03 2.05e-04  4.21e-02    14s
  28   4.64027755e+04  5.63962551e+04  5.00e-03 1.88e-04  3.50e-02    14s
  29   4.75371080e+04  5.53566788e+04  4.06e-03 1.59e-04  2.74e-02    14s
  30   4.82852861e+04  5.50850960e+04  3.48e-03 1.54e-04  2.38e-02    14s
  31   4.93711243e+04  5.46234889e+04  2.60e-03 1.24e-04  1.84e-02    15s
  32   4.96031649e+04  5.41597693e+04  2.42e-03 9.34e-05  1.60e-02    15s
  33   5.05429055e+04  5.39818123e+04  1.68e-03 8.04e-05  1.20e-02    15s
  34   5.09209992e+04  5.34929502e+04  1.40e-03 8.02e-05  9.00e-03    15s
  35   5.14287638e+04  5.33229883e+04  1.02e-03 6.18e-05  6.63e-03    16s
  36   5.16233740e+04  5.32327095e+04  8.69e-04 5.05e-05  5.63e-03    16s
  37   5.19178179e+04  5.31727201e+04  6.52e-04 4.25e-05  4.39e-03    16s
  38   5.20242647e+04  5.30857363e+04  5.75e-04 3.15e-05  3.72e-03    16s
  39   5.22116243e+04  5.30255896e+04  4.37e-04 2.37e-05  2.85e-03    17s
  40   5.23486876e+04  5.29502078e+04  3.33e-04 1.48e-05  2.11e-03    17s
  41   5.24565119e+04  5.29199087e+04  2.57e-04 1.15e-05  1.62e-03    17s
  42   5.25253454e+04  5.29086357e+04  2.10e-04 1.02e-05  1.34e-03    17s
  43   5.25497059e+04  5.28843630e+04  1.91e-04 7.38e-06  1.17e-03    18s
  44   5.25835109e+04  5.28727411e+04  1.66e-04 6.08e-06  1.01e-03    18s
  45   5.26479823e+04  5.28646925e+04  1.19e-04 5.27e-06  7.59e-04    18s
  46   5.27067967e+04  5.28507776e+04  7.82e-05 3.69e-06  5.04e-04    18s
  47   5.27417081e+04  5.28301849e+04  5.30e-05 1.31e-06  3.10e-04    19s
  48   5.27491608e+04  5.28291557e+04  4.76e-05 1.20e-06  2.80e-04    19s
  49   5.27780147e+04  5.28222487e+04  2.78e-05 3.44e-07  1.55e-04    19s
  50   5.27848938e+04  5.28212280e+04  2.29e-05 2.47e-07  1.27e-04    19s
  51   5.27904828e+04  5.28202940e+04  1.89e-05 1.25e-07  1.04e-04    20s
  52   5.27921822e+04  5.28201504e+04  1.76e-05 1.17e-07  9.79e-05    20s
  53   5.27949891e+04  5.28199169e+04  1.56e-05 1.03e-07  8.73e-05    20s
  54   5.28021435e+04  5.28193964e+04  1.08e-05 7.06e-08  6.04e-05    20s
  55   5.28138220e+04  5.28188151e+04  3.01e-06 1.01e-06  1.75e-05    21s
  56   5.28176675e+04  5.28185221e+04  3.95e-07 1.32e-07  2.99e-06    21s
  57   5.28183385e+04  5.28183903e+04  1.04e-07 1.37e-08  1.81e-07    21s
  58   5.28183728e+04  5.28183729e+04  1.06e-09 1.87e-10  6.34e-10    21s

Barrier solved model in 58 iterations and 21.26 seconds (18.75 work units)
Optimal objective 5.28183728e+04


Root crossover log...

  138671 DPushes remaining with DInf 0.0000000e+00                21s
   28373 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                29s

    8364 PPushes remaining with PInf 7.9392583e-05                29s
    3582 PPushes remaining with PInf 2.4250907e-05                30s
       0 PPushes remaining with PInf 0.0000000e+00                31s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.4469231e+04     31s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   73552    5.2818373e+04   0.000000e+00   4.446923e+04     31s
   73698    5.2818373e+04   0.000000e+00   0.000000e+00     31s
   73698    5.2818373e+04   0.000000e+00   0.000000e+00     31s
Concurrent spin time: 1.33s

Solved with barrier

Root relaxation: objective 5.281837e+04, 73698 iterations, 25.62 seconds (30.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52818.3729    0  149 -239613.87 52818.3729   122%     -   33s
H    0     0                    -204372.9638 52818.3729   126%     -   34s
H    0     0                    -201167.7873 52818.3729   126%     -   34s
H    0     0                    -200199.0948 52818.3729   126%     -   35s
H    0     0                    -195345.4872 52818.3729   127%     -   36s
H    0     0                    -193201.3782 52818.3729   127%     -   36s
H    0     0                    -193121.2540 52818.3729   127%     -   36s
H    0     0                    -192758.9149 52818.3729   127%     -   36s
H    0     0                    -192189.1169 52818.3729   127%     -   37s
H    0     0                    -192166.1651 52818.3729   127%     -   37s
H    0     0                    -56472.32618 52818.3729   194%     -   37s
H    0     0                    -56146.20082 52818.3729   194%     -   37s
H    0     0                    24781.357579 52818.3729   113%     -   37s
H    0     0                    25147.019562 52818.3729   110%     -   37s
     0     0 47012.3238    0  255 25147.0196 47012.3238  86.9%     -  120s
     0     0 46569.3426    0  240 25147.0196 46569.3426  85.2%     -  168s
     0     0 46518.3747    0  254 25147.0196 46518.3747  85.0%     -  175s
     0     0 46512.2357    0  250 25147.0196 46512.2357  85.0%     -  182s
     0     0 46496.1783    0  248 25147.0196 46496.1783  84.9%     -  189s
     0     0 46494.4058    0  246 25147.0196 46494.4058  84.9%     -  192s
     0     0 46487.0162    0  248 25147.0196 46487.0162  84.9%     -  203s
     0     0 46211.0734    0  294 25147.0196 46211.0734  83.8%     -  228s
     0     0 46207.6204    0  295 25147.0196 46207.6204  83.7%     -  236s
     0     0 46207.5993    0  295 25147.0196 46207.5993  83.7%     -  238s
     0     0 43734.9628    0  224 25147.0196 43734.9628  73.9%     -  328s
     0     0 43278.2076    0  217 25147.0196 43278.2076  72.1%     -  368s
     0     0 43011.6472    0  255 25147.0196 43011.6472  71.0%     -  398s
     0     0 42902.0564    0  225 25147.0196 42902.0564  70.6%     -  418s
     0     0 42833.0627    0  310 25147.0196 42833.0627  70.3%     -  437s
     0     0 42816.9878    0  278 25147.0196 42816.9878  70.3%     -  445s
     0     0 42815.5587    0  276 25147.0196 42815.5587  70.3%     -  448s
     0     0 42780.2220    0  268 25147.0196 42780.2220  70.1%     -  458s
     0     0 42768.9165    0  267 25147.0196 42768.9165  70.1%     -  463s
     0     0 42768.3604    0  273 25147.0196 42768.3604  70.1%     -  466s
     0     0 40866.0211    0  375 25147.0196 40866.0211  62.5%     -  544s
H    0     0                    25424.829677 40865.0002  60.7%     -  545s
     0     0 40448.0235    0  382 25424.8297 40448.0235  59.1%     -  572s
     0     0 40286.1059    0  386 25424.8297 40286.1059  58.5%     -  596s
     0     0 40215.7561    0  391 25424.8297 40215.7561  58.2%     -  611s
     0     0 40167.2702    0  385 25424.8297 40167.2702  58.0%     -  621s
     0     0 40157.4365    0  386 25424.8297 40157.4365  57.9%     -  627s
     0     0 40142.0022    0  384 25424.8297 40142.0022  57.9%     -  633s
     0     0 40118.5147    0  390 25424.8297 40118.5147  57.8%     -  642s
     0     0 40108.4463    0  393 25424.8297 40108.4463  57.8%     -  648s
     0     0 40104.3810    0  394 25424.8297 40104.3810  57.7%     -  652s
     0     0 40100.8573    0  393 25424.8297 40100.8573  57.7%     -  655s
     0     0 40099.0809    0  393 25424.8297 40099.0809  57.7%     -  659s
     0     0 40074.9106    0  398 25424.8297 40074.9106  57.6%     -  662s
     0     0 40070.8936    0  400 25424.8297 40070.8936  57.6%     -  666s
     0     0 40025.5043    0  401 25424.8297 40025.5043  57.4%     -  674s
     0     0 39986.0242    0  402 25424.8297 39986.0242  57.3%     -  680s
     0     0 39972.3240    0  406 25424.8297 39972.3240  57.2%     -  687s
     0     0 39970.5705    0  403 25424.8297 39970.5705  57.2%     -  691s
     0     0 39965.2423    0  409 25424.8297 39965.2423  57.2%     -  695s
     0     0 39963.0607    0  410 25424.8297 39963.0607  57.2%     -  697s
     0     0 39961.2554    0  410 25424.8297 39961.2554  57.2%     -  700s
     0     0 39960.0886    0  413 25424.8297 39960.0886  57.2%     -  701s
     0     0 39372.3140    0  375 25424.8297 39372.3140  54.9%     -  749s
     0     0 39120.6657    0  427 25424.8297 39120.6657  53.9%     -  771s
     0     0 39066.4863    0  391 25424.8297 39066.4863  53.7%     -  791s
     0     0 39042.7311    0  436 25424.8297 39042.7311  53.6%     -  800s
     0     0 39021.0028    0  427 25424.8297 39021.0028  53.5%     -  809s
     0     0 39006.6684    0  432 25424.8297 39006.6684  53.4%     -  817s
     0     0 38999.4456    0  431 25424.8297 38999.4456  53.4%     -  821s
     0     0 38991.5918    0  433 25424.8297 38991.5918  53.4%     -  828s
     0     0 38979.4938    0  433 25424.8297 38979.4938  53.3%     -  833s
     0     0 38964.7914    0  429 25424.8297 38964.7914  53.3%     -  841s
     0     0 38957.1502    0  429 25424.8297 38957.1502  53.2%     -  845s
     0     0 38952.2123    0  431 25424.8297 38952.2123  53.2%     -  848s
     0     0 38946.6763    0  429 25424.8297 38946.6763  53.2%     -  850s
     0     0 38944.7907    0  432 25424.8297 38944.7907  53.2%     -  854s
     0     0 38939.7709    0  439 25424.8297 38939.7709  53.2%     -  857s
     0     0 38937.9119    0  434 25424.8297 38937.9119  53.1%     -  859s
     0     0 38937.3379    0  433 25424.8297 38937.3379  53.1%     -  861s
     0     0 38878.9254    0  439 25424.8297 38878.9254  52.9%     -  879s
     0     0 38862.6282    0  442 25424.8297 38862.6282  52.9%     -  886s
     0     0 38856.6077    0  442 25424.8297 38856.6077  52.8%     -  891s
     0     0 38851.6411    0  398 25424.8297 38851.6411  52.8%     -  895s
     0     0 38844.0926    0  446 25424.8297 38844.0926  52.8%     -  900s
     0     0 38838.8367    0  400 25424.8297 38838.8367  52.8%     -  905s
     0     0 38837.3527    0  401 25424.8297 38837.3527  52.8%     -  907s
     0     0 38822.3137    0  401 25424.8297 38822.3137  52.7%     -  917s
H    0     0                    25449.032835 38822.2460  52.5%     -  940s
H    0     0                    25483.400896 38822.2460  52.3%     -  944s
     0     0 38806.2736    0  393 25483.4009 38806.2736  52.3%     -  950s
     0     0 38793.4882    0  442 25483.4009 38793.4882  52.2%     -  954s
     0     0 38772.0518    0  396 25483.4009 38772.0518  52.1%     -  962s
     0     0 38761.4857    0  399 25483.4009 38761.4857  52.1%     -  971s
     0     0 38758.8189    0  404 25483.4009 38758.8189  52.1%     -  974s
     0     0 38755.9258    0  413 25483.4009 38755.9258  52.1%     -  978s
     0     0 38752.8776    0  416 25483.4009 38752.8776  52.1%     -  979s
     0     0 38748.0700    0  405 25483.4009 38748.0700  52.1%     -  981s
     0     0 38744.6139    0  413 25483.4009 38744.6139  52.0%     -  984s
     0     0 38742.3813    0  413 25483.4009 38742.3813  52.0%     -  986s
     0     0 38739.5736    0  408 25483.4009 38739.5736  52.0%     -  988s
     0     0 38738.8028    0  413 25483.4009 38738.8028  52.0%     -  991s
     0     0 38715.1667    0  452 25483.4009 38715.1667  51.9%     - 1002s
H    0     0                    25486.195688 38713.5892  51.9%     - 1004s
H    0     0                    25494.920084 38713.5892  51.8%     - 1009s
     0     0 38704.8468    0  410 25494.9201 38704.8468  51.8%     - 1017s
     0     0 38698.9899    0  453 25494.9201 38698.9899  51.8%     - 1020s
     0     0 38698.1532    0  457 25494.9201 38698.1532  51.8%     - 1022s
     0     0 38682.9930    0  447 25494.9201 38682.9930  51.7%     - 1031s
     0     0 38680.5232    0  406 25494.9201 38680.5232  51.7%     - 1063s
     0     0 38679.7494    0  406 25494.9201 38679.7494  51.7%     - 1066s
     0     0 38667.9923    0  406 25494.9201 38667.9923  51.7%     - 1073s
     0     0 38663.0881    0  409 25494.9201 38663.0881  51.7%     - 1077s
     0     0 38659.2339    0  455 25494.9201 38659.2339  51.6%     - 1080s
     0     0 38657.0794    0  457 25494.9201 38657.0794  51.6%     - 1082s
     0     0 38655.3731    0  456 25494.9201 38655.3731  51.6%     - 1083s
     0     0 38654.1486    0  460 25494.9201 38654.1486  51.6%     - 1085s
     0     0 38648.8492    0  409 25494.9201 38648.8492  51.6%     - 1090s
     0     0 38646.4281    0  410 25494.9201 38646.4281  51.6%     - 1093s
     0     0 38644.1952    0  406 25494.9201 38644.1952  51.6%     - 1095s
     0     0 38641.7114    0  408 25494.9201 38641.7114  51.6%     - 1100s
     0     0 38640.4299    0  409 25494.9201 38640.4299  51.6%     - 1102s
     0     0 38637.7108    0  407 25494.9201 38637.7108  51.6%     - 1109s
     0     0 38631.5155    0  442 25494.9201 38631.5155  51.5%     - 1115s
     0     0 38629.1599    0  446 25494.9201 38629.1599  51.5%     - 1118s
     0     0 38628.7476    0  447 25494.9201 38628.7476  51.5%     - 1119s
     0     0 38626.0949    0  448 25494.9201 38626.0949  51.5%     - 1125s
     0     0 38625.0954    0  443 25494.9201 38625.0954  51.5%     - 1127s
     0     0 38621.6096    0  445 25494.9201 38621.6096  51.5%     - 1133s
     0     0 38621.1981    0  445 25494.9201 38621.1981  51.5%     - 1141s
H    0     0                    25504.621297 38620.9555  51.4%     - 1264s
H    0     0                    25511.140411 38620.9555  51.4%     - 1264s
     0     2 38620.9555    0  445 25511.1404 38620.9555  51.4%     - 1382s
     1     3 38284.5461    1  406 25511.1404 38620.1595  51.4% 11663 1403s
     2     4 38512.2070    1  388 25511.1404 38512.2070  51.0% 10308 1417s
     3     5 37642.1360    2  392 25511.1404 38509.5134  51.0% 12847 1448s
     4    10 37196.1552    3  374 25511.1404 38509.5134  51.0% 12299 1475s
     9    20 37141.0841    4  379 25511.1404 38243.9491  49.9% 10435 1541s
    19    40 36516.5164    5  364 25511.1404 38214.5442  49.8% 12018 1587s
    39    52 37129.9249    5  372 25511.1404 37984.0019  48.9% 19231 1701s
    51    75 37142.5385    6  416 25511.1404 37984.0019  48.9% 18564 1780s
    74   169 36977.6776    7  358 25511.1404 37984.0019  48.9% 15585 1863s
   168   201 34377.0821    9  277 25511.1404 37984.0019  48.9% 10045 1896s
   200   223 34232.2910   10  324 25511.1404 37984.0019  48.9% 10694 1940s
   222   249 35806.7169   13  362 25511.1404 37984.0019  48.9% 10408 1990s
   248   276 34192.7055   11  332 25511.1404 37984.0019  48.9% 10096 2031s
   279   301 34165.0268   12  327 25511.1404 37984.0019  48.9%  9965 2077s
   310   325 32688.0364   10  276 25511.1404 37984.0019  48.9%  9575 2123s
   343   348 32305.1203   11  274 25511.1404 37984.0019  48.9%  9141 2172s
   374   376 26811.6859   12  274 25511.1404 37984.0019  48.9%  8935 2211s
   408   409 33746.9197   13  311 25511.1404 37984.0019  48.9%  8993 2247s
   447   445 33659.2923   14  306 25511.1404 37984.0019  48.9%  9019 2282s
   491   499 26042.6589   15  148 25511.1404 37984.0019  48.9%  8998 2320s
   545   564 28576.4547   13  369 25511.1404 37984.0019  48.9%  8836 2359s
   617   600 27395.2812   14  263 25511.1404 37984.0019  48.9%  8502 2391s
   681   622 25950.5297   16  144 25511.1404 37984.0019  48.9%  8278 2422s
   743   658 33415.9136   15  259 25511.1404 37756.2089  48.0%  8150 2455s
   797   705 32507.7661   14  254 25511.1404 37756.2089  48.0%  8189 2489s
   871   737 25829.4134   16  148 25511.1404 37756.2089  48.0%  8234 2522s
   961   781     cutoff   18      25511.1404 37756.2089  48.0%  8039 2557s
  1041   803 infeasible   18      25511.1404 37756.2089  48.0%  7939 2593s
  1114   840 27245.6770   29  277 25511.1404 37756.2089  48.0%  7859 2622s
  1205   901 33089.5715   12  210 25511.1404 37756.2089  48.0%  7829 2661s
  1315   987 29860.3120   13  193 25511.1404 37756.2089  48.0%  7721 2699s
  1443  1036 29574.6051   14  189 25511.1404 37756.2089  48.0%  7544 2739s
  1560  1076 28460.3603   15  176 25511.1404 37756.2089  48.0%  7446 2779s
  1661  1134 infeasible   17      25511.1404 37558.5194  47.2%  7527 2828s
  1777  1214 27425.9680   18  326 25511.1404 37558.5194  47.2%  7553 2873s
  1920  1303     cutoff   19      25511.1404 37558.5194  47.2%  7485 2917s
  2085  1408 27302.1351   22  212 25511.1404 37558.5194  47.2%  7406 2969s
  2256  1478 25895.9721   28  122 25511.1404 37558.5194  47.2%  7328 3018s
  2414  1545 infeasible   16      25511.1404 37558.5194  47.2%  7334 3070s
  2558  1592 28279.6509   13  145 25511.1404 37558.5194  47.2%  7392 3127s
  2676  1629 infeasible   14      25511.1404 37558.5194  47.2%  7527 3189s
  2785  1688 infeasible   23      25511.1404 37558.5194  47.2%  7613 3248s
  2941  1753 infeasible   28      25511.1404 37444.7969  46.8%  7594 3309s
  3098  1846 36859.6162    7  415 25511.1404 37419.8665  46.7%  7617 3373s
  3270  1988 35504.7546    9  370 25511.1404 37419.8665  46.7%  7639 3440s
  3480  2073 32633.2823   11  304 25511.1404 37419.8665  46.7%  7603 3502s
  3683  2143 32357.8872   14  286 25511.1404 37419.8665  46.7%  7610 3571s
  3875  2166 30064.3931   27  224 25511.1404 37419.8665  46.7%  7620 3600s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 12
  MIR: 1400
  Flow cover: 3352
  RLT: 43
  Relax-and-lift: 335

Explored 3955 nodes (30868462 simplex iterations) in 3600.11 seconds (5808.56 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25511.1 25504.6 25494.9 ... -56146.2

Time limit reached
Best objective 2.551114041095e+04, best bound 3.741986654513e+04, gap 46.6805%
  WARNING: Time limit reached. Using best solution found (gap: 46.68%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 25511.14, θ = 172855.90
  Upper Bound (UB) = 25511.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172855.90
  [DEBUG]   ✓ Scenario 0: θ = 172855.90 ≤ Q = 172855.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172855.90 ≤ Q = 172855.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172855.90 ≤ Q = 172855.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 172855.90 ≤ Q = 172855.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 172855.90 ≤ Q = 172855.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 172855.90 ≤ Q = 172855.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 172855.90 ≤ Q = 172855.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 172855.90 ≤ Q = 172855.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 172855.90 ≤ Q = 172855.90 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x10de106
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfef21efa
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.430501e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.01s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 6843262.3733
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.570565e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157056.54    0  124 6843262.37 -157056.54   102%     -    0s
H    0     0                    -121922.4033 -157056.54  28.8%     -    0s
H    0     0                    -122185.6558 -157056.54  28.5%     -    0s
     0     0 -128481.22    0   66 -122185.66 -128481.22  5.15%     -    0s
H    0     0                    -125752.3346 -128383.17  2.09%     -    0s
H    0     0                    -126052.1773 -128383.17  1.85%     -    0s
H    0     0                    -126405.2838 -128383.17  1.56%     -    0s
H    0     0                    -126705.1265 -128383.17  1.32%     -    0s
     0     0 -127486.48    0   68 -126705.13 -127486.48  0.62%     -    0s
H    0     0                    -126730.3777 -127476.77  0.59%     -    0s
H    0     0                    -126742.3932 -127476.77  0.58%     -    0s
     0     0 -127306.55    0   68 -126742.39 -127306.55  0.45%     -    0s
     0     0 -127303.14    0   69 -126742.39 -127303.14  0.44%     -    0s
H    0     0                    -126802.0024 -127289.05  0.38%     -    0s
     0     0 -127289.05    0   79 -126802.00 -127289.05  0.38%     -    0s
H    0     0                    -126819.7094 -127289.05  0.37%     -    0s
     0     0 -127289.05    0   67 -126819.71 -127289.05  0.37%     -    0s
     0     0 -127289.05    0   69 -126819.71 -127289.05  0.37%     -    0s
     0     0 -127268.74    0   67 -126819.71 -127268.74  0.35%     -    0s
     0     0 -127264.61    0   67 -126819.71 -127264.61  0.35%     -    0s
     0     0 -127188.26    0   67 -126819.71 -127188.26  0.29%     -    0s
     0     0 -127143.71    0   65 -126819.71 -127143.71  0.26%     -    0s
     0     0 -127088.33    0   65 -126819.71 -127088.33  0.21%     -    0s
     0     0 -127084.04    0   66 -126819.71 -127084.04  0.21%     -    0s
     0     0 -127074.94    0   55 -126819.71 -127074.94  0.20%     -    0s
     0     0 -127071.86    0   66 -126819.71 -127071.86  0.20%     -    0s
     0     0 -127071.86    0   55 -126819.71 -127071.86  0.20%     -    0s
     0     0 -127067.81    0   55 -126819.71 -127067.81  0.20%     -    0s
     0     2 -127067.81    0   55 -126819.71 -127067.81  0.20%     -    0s
*  150     0              19    -126839.4945 -126888.70  0.04%   6.5    0s

Cutting planes:
  Gomory: 32
  Implied bound: 2
  MIR: 103
  Flow cover: 20
  RLT: 2
  BQP: 1

Explored 172 nodes (2131 simplex iterations) in 0.44 seconds (0.10 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -126839 -126820 -126802 ... 6.84326e+06
No other solutions better than -126839

Optimal solution found (tolerance 1.00e-06)
Best objective -1.268394945250e+05, best bound -1.268394945250e+05, gap 0.0000%
  Subproblem solved in 0.47s
  Worst-case operational profit (Z_SP) = 172308.32
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126839.49
  [DEBUG]   S×d_nominal = 299147.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 299147.81 + -126839.49 = 172308.32
  [DEBUG]   Current θ from Master = 172855.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 547.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24963.56
  Lower Bound (LB) = 24963.56
  Gap (UB-LB) = 547.5819, Absolute Gap = 547.5819, Relative Gap = 0.021464
  Not converged yet (gap = 547.58 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870139 nonzeros
Model fingerprint: 0xb8cd637f
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 142118 rows and 57759 columns (presolve time = 5s)...
Presolve removed 142118 rows and 57759 columns
Presolve time: 6.27s
Presolved: 165065 rows, 69301 columns, 1019129 nonzeros
Variable types: 67042 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -345417.1031
Found heuristic solution: objective -239613.8705

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.13s

Barrier statistics:
 Dense cols : 1136
 AA' NZ     : 3.995e+06
 Factor NZ  : 1.101e+07 (roughly 200 MB of memory)
 Factor Ops : 3.615e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.02570488e+07  3.01329913e+08  1.27e+05 1.59e+01  8.69e+04    11s
   1  -1.56300057e+07  2.66818968e+08  8.86e+04 6.57e+01  6.01e+04    11s
   2  -5.89387425e+06  1.96209287e+08  3.26e+04 1.70e+00  2.35e+04    11s
   3  -1.30612192e+06  1.45337114e+08  4.47e+03 2.07e+00  3.55e+03    11s
   4  -6.50111826e+05  9.98613635e+07  9.13e+02 1.02e+00  9.24e+02    11s
   5  -5.17602980e+05  5.08281442e+07  3.96e+02 3.72e-01  3.98e+02    11s
   6  -4.12031433e+05  3.54950155e+07  1.28e+02 2.35e-01  1.87e+02    12s
   7  -3.24684892e+05  2.65594405e+07  3.81e+01 1.64e-01  1.07e+02    12s
   8  -2.42067081e+05  1.86632779e+07  1.67e+01 1.11e-01  6.92e+01    12s
   9  -1.54698943e+05  9.60556266e+06  4.18e+00 5.25e-02  3.34e+01    12s
  10  -1.17186368e+05  5.55209648e+06  2.17e+00 2.95e-02  1.92e+01    12s
  11  -9.84320722e+04  3.28958796e+06  1.38e+00 1.72e-02  1.14e+01    12s
  12  -8.30806148e+04  2.03481199e+06  8.29e-01 1.05e-02  7.09e+00    12s
  13  -5.74484553e+04  5.68823826e+05  3.94e-01 2.70e-03  2.09e+00    12s
  14  -2.08859900e+04  2.66724847e+05  1.31e-01 1.68e-03  9.58e-01    13s
  15  -7.75296151e+03  2.16060069e+05  9.54e-02 1.13e-03  7.45e-01    13s
  16   1.03636568e+03  1.67015863e+05  8.01e-02 1.79e-03  5.53e-01    13s
  17   1.00418130e+04  1.25669831e+05  6.52e-02 2.20e-03  3.85e-01    13s
  18   1.74031453e+04  1.11151420e+05  5.33e-02 1.76e-03  3.12e-01    13s
  19   2.14869584e+04  9.43202482e+04  4.62e-02 1.80e-03  2.43e-01    13s
  20   2.62720733e+04  8.39205109e+04  3.82e-02 2.62e-03  1.92e-01    14s
  21   3.02444611e+04  7.87932506e+04  3.17e-02 2.19e-03  1.62e-01    14s
  22   3.29805946e+04  6.89925252e+04  2.73e-02 1.41e-03  1.20e-01    14s
  23   3.69336674e+04  6.71926654e+04  2.14e-02 1.26e-03  1.01e-01    14s
  24   3.91975122e+04  6.37499257e+04  1.81e-02 9.43e-04  8.18e-02    14s
  25   4.12669862e+04  6.16999608e+04  1.52e-02 7.70e-04  6.81e-02    14s
  26   4.31738559e+04  5.99475248e+04  1.27e-02 6.09e-04  5.59e-02    15s
  27   4.37498211e+04  5.83630096e+04  1.19e-02 4.78e-04  4.87e-02    15s
  28   4.51629184e+04  5.76027773e+04  1.01e-02 4.03e-04  4.14e-02    15s
  29   4.64618518e+04  5.66489586e+04  8.47e-03 3.08e-04  3.39e-02    15s
  30   4.75239730e+04  5.61747385e+04  7.12e-03 2.67e-04  2.88e-02    16s
  31   4.84895900e+04  5.58676821e+04  5.91e-03 4.17e-04  2.46e-02    16s
  32   4.90159580e+04  5.54650776e+04  5.24e-03 3.55e-04  2.15e-02    16s
  33   4.96992728e+04  5.52390176e+04  4.42e-03 3.19e-04  1.85e-02    16s
  34   4.98094177e+04  5.48336660e+04  4.28e-03 2.51e-04  1.67e-02    16s
  35   5.06218727e+04  5.46644348e+04  3.26e-03 2.23e-04  1.35e-02    17s
  36   5.08578909e+04  5.46076017e+04  2.98e-03 2.12e-04  1.25e-02    17s
  37   5.10956530e+04  5.42985899e+04  2.69e-03 1.58e-04  1.07e-02    17s
  38   5.13799947e+04  5.41262047e+04  2.34e-03 1.27e-04  9.15e-03    17s
  39   5.15144620e+04  5.40415929e+04  2.19e-03 1.13e-04  8.42e-03    17s
  40   5.16751932e+04  5.39534914e+04  1.98e-03 9.88e-05  7.59e-03    18s
  41   5.20122359e+04  5.37978140e+04  1.59e-03 8.40e-05  5.95e-03    18s
  42   5.21840893e+04  5.37793764e+04  1.40e-03 7.89e-05  5.32e-03    18s
  43   5.24675664e+04  5.36824151e+04  1.06e-03 6.42e-05  4.05e-03    18s
  44   5.26572722e+04  5.35473873e+04  8.33e-04 5.03e-05  2.97e-03    18s
  45   5.28204545e+04  5.35049959e+04  6.39e-04 3.46e-05  2.28e-03    19s
  46   5.28697325e+04  5.34825037e+04  5.85e-04 2.74e-05  2.04e-03    19s
  47   5.29156157e+04  5.34765306e+04  5.33e-04 2.57e-05  1.87e-03    19s
  48   5.30584962e+04  5.34337942e+04  3.66e-04 1.11e-05  1.25e-03    19s
  49   5.30753236e+04  5.34275172e+04  3.48e-04 9.50e-06  1.17e-03    20s
  50   5.31926875e+04  5.34220117e+04  2.15e-04 8.29e-06  7.64e-04    20s
  51   5.32898168e+04  5.34096940e+04  1.08e-04 4.71e-06  4.00e-04    20s
  52   5.33373690e+04  5.34025815e+04  5.48e-05 1.15e-05  2.17e-04    20s
  53   5.33673307e+04  5.33955903e+04  2.43e-05 2.92e-06  9.42e-05    20s
  54   5.33882617e+04  5.33938599e+04  2.93e-06 9.96e-07  1.86e-05    21s
  55   5.33921608e+04  5.33925723e+04  1.21e-07 5.08e-08  1.37e-06    21s
  56   5.33924512e+04  5.33924516e+04  4.48e-09 8.91e-10  1.23e-09    21s

Barrier solved model in 56 iterations and 20.88 seconds (17.11 work units)
Optimal objective 5.33924512e+04


Root crossover log...

  149958 DPushes remaining with DInf 0.0000000e+00                21s
   33867 DPushes remaining with DInf 0.0000000e+00                25s
     236 DPushes remaining with DInf 0.0000000e+00                30s
       0 DPushes remaining with DInf 0.0000000e+00                30s

   13255 PPushes remaining with PInf 9.7960034e-05                30s
       0 PPushes remaining with PInf 0.0000000e+00                32s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4158243e+06     33s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   89182    5.3392451e+04   0.000000e+00   2.415824e+06     33s
   89877    5.3392451e+04   0.000000e+00   0.000000e+00     34s
   89877    5.3392451e+04   0.000000e+00   0.000000e+00     34s
Concurrent spin time: 1.50s

Solved with barrier

Root relaxation: objective 5.339245e+04, 89877 iterations, 27.86 seconds (33.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53392.4514    0  116 -239613.87 53392.4514   122%     -   36s
H    0     0                    -236583.8234 53392.4514   123%     -   36s
H    0     0                    -195349.9593 53392.4514   127%     -   37s
H    0     0                    -177921.1376 53392.4514   130%     -   38s
H    0     0                    -174585.0679 53392.4514   131%     -   39s
H    0     0                    -174266.8131 53392.4514   131%     -   39s
H    0     0                    -174200.5558 53392.4514   131%     -   39s
H    0     0                    -47697.51657 53392.4514   212%     -   39s
H    0     0                    -47513.14459 53392.4514   212%     -   39s
H    0     0                    24376.349404 53392.4514   119%     -   40s
H    0     0                    24418.298712 53392.4514   119%     -   41s
H    0     0                    24782.162865 53392.4514   115%     -   41s
H    0     0                    24835.695231 53392.4514   115%     -   41s
H    0     0                    25049.464246 53392.4514   113%     -   41s
     0     0 47834.3199    0  255 25049.4642 47834.3199  91.0%     -  195s
     0     0 47706.4613    0  259 25049.4642 47706.4613  90.4%     -  261s
     0     0 47699.8230    0  257 25049.4642 47699.8230  90.4%     -  275s
     0     0 47696.9469    0  259 25049.4642 47696.9469  90.4%     -  280s
     0     0 47696.3753    0  259 25049.4642 47696.3753  90.4%     -  282s
     0     0 44018.7547    0  281 25049.4642 44018.7547  75.7%     -  442s
     0     0 43696.1572    0  255 25049.4642 43696.1572  74.4%     -  485s
     0     0 43623.5265    0  248 25049.4642 43623.5265  74.1%     -  504s
     0     0 43616.6580    0  291 25049.4642 43616.6580  74.1%     -  513s
     0     0 43592.6308    0  261 25049.4642 43592.6308  74.0%     -  525s
     0     0 43585.1201    0  303 25049.4642 43585.1201  74.0%     -  532s
     0     0 43576.9397    0  253 25049.4642 43576.9397  74.0%     -  538s
     0     0 43575.5691    0  261 25049.4642 43575.5691  74.0%     -  542s
     0     0 43462.4877    0  252 25049.4642 43462.4877  73.5%     -  564s
     0     0 43450.1712    0  254 25049.4642 43450.1712  73.5%     -  571s
     0     0 43444.5922    0  254 25049.4642 43444.5922  73.4%     -  577s
     0     0 43444.5662    0  256 25049.4642 43444.5662  73.4%     -  577s
     0     0 41735.2642    0  298 25049.4642 41735.2642  66.6%     -  689s
H    0     0                    25159.289168 41735.1244  65.9%     -  690s
H    0     0                    25163.678376 41735.1244  65.9%     -  690s
H    0     0                    25194.134345 41735.1244  65.7%     -  690s
     0     0 41231.6635    0  298 25194.1343 41231.6635  63.7%     -  746s
     0     0 40972.0642    0  295 25194.1343 40972.0642  62.6%     -  788s
     0     0 40865.0185    0  316 25194.1343 40865.0185  62.2%     -  806s
     0     0 40836.9654    0  314 25194.1343 40836.9654  62.1%     -  818s
     0     0 40823.7059    0  315 25194.1343 40823.7059  62.0%     -  826s
     0     0 40809.3106    0  311 25194.1343 40809.3106  62.0%     -  833s
     0     0 40797.4463    0  315 25194.1343 40797.4463  61.9%     -  838s
     0     0 40789.8060    0  321 25194.1343 40789.8060  61.9%     -  843s
     0     0 40772.1467    0  325 25194.1343 40772.1467  61.8%     -  849s
     0     0 40762.0656    0  323 25194.1343 40762.0656  61.8%     -  856s
     0     0 40741.2634    0  328 25194.1343 40741.2634  61.7%     -  862s
     0     0 40731.9764    0  325 25194.1343 40731.9764  61.7%     -  867s
     0     0 40722.2659    0  328 25194.1343 40722.2659  61.6%     -  872s
     0     0 40717.9798    0  330 25194.1343 40717.9798  61.6%     -  880s
     0     0 40703.7830    0  326 25194.1343 40703.7830  61.6%     -  884s
     0     0 40702.8456    0  322 25194.1343 40702.8456  61.6%     -  886s
     0     0 39945.2453    0  342 25194.1343 39945.2453  58.5%     -  948s
H    0     0                    25228.502406 39943.1137  58.3%     -  949s
     0     0 39749.4691    0  346 25228.5024 39749.4691  57.6%     -  973s
     0     0 39702.0462    0  348 25228.5024 39702.0462  57.4%     -  984s
     0     0 39663.1334    0  344 25228.5024 39663.1334  57.2%     -  995s
     0     0 39638.9647    0  342 25228.5024 39638.9647  57.1%     - 1003s
     0     0 39613.3532    0  351 25228.5024 39613.3532  57.0%     - 1014s
     0     0 39592.8893    0  350 25228.5024 39592.8893  56.9%     - 1023s
     0     0 39573.6745    0  352 25228.5024 39573.6745  56.9%     - 1036s
     0     0 39564.8934    0  357 25228.5024 39564.8934  56.8%     - 1044s
     0     0 39558.9088    0  355 25228.5024 39558.9088  56.8%     - 1051s
     0     0 39509.6122    0  354 25228.5024 39509.6122  56.6%     - 1066s
     0     0 39464.4663    0  389 25228.5024 39464.4663  56.4%     - 1082s
     0     0 39425.3000    0  348 25228.5024 39425.3000  56.3%     - 1096s
     0     0 39411.8204    0  350 25228.5024 39411.8204  56.2%     - 1106s
     0     0 39399.9041    0  366 25228.5024 39399.9041  56.2%     - 1117s
     0     0 39395.9136    0  367 25228.5024 39395.9136  56.2%     - 1132s
     0     0 39391.3220    0  366 25228.5024 39391.3220  56.1%     - 1136s
     0     0 39382.2152    0  365 25228.5024 39382.2152  56.1%     - 1144s
     0     0 39380.4770    0  361 25228.5024 39380.4770  56.1%     - 1148s
     0     0 39368.6257    0  403 25228.5024 39368.6257  56.0%     - 1158s
     0     0 39362.3021    0  365 25228.5024 39362.3021  56.0%     - 1164s
     0     0 39361.6426    0  365 25228.5024 39361.6426  56.0%     - 1167s
     0     0 39231.0066    0  419 25228.5024 39231.0066  55.5%     - 1194s
H    0     0                    25356.796497 39230.6343  54.7%     - 1196s
H    0     0                    25394.460589 39230.6343  54.5%     - 1196s
H    0     0                    25418.743333 39230.6343  54.3%     - 1196s
     0     0 39164.5646    0  426 25418.7433 39164.5646  54.1%     - 1216s
     0     0 39136.8375    0  434 25418.7433 39136.8375  54.0%     - 1231s
     0     0 39129.3392    0  420 25418.7433 39129.3392  53.9%     - 1237s
     0     0 39118.7988    0  426 25418.7433 39118.7988  53.9%     - 1245s
     0     0 39082.2435    0  428 25418.7433 39082.2435  53.8%     - 1257s
     0     0 39074.4878    0  425 25418.7433 39074.4878  53.7%     - 1263s
     0     0 39071.9514    0  421 25418.7433 39071.9514  53.7%     - 1268s
     0     0 39069.7748    0  421 25418.7433 39069.7748  53.7%     - 1271s
     0     0 39066.3574    0  423 25418.7433 39066.3574  53.7%     - 1276s
     0     0 39063.7008    0  429 25418.7433 39063.7008  53.7%     - 1279s
     0     0 39061.5741    0  431 25418.7433 39061.5741  53.7%     - 1281s
     0     0 39059.1254    0  429 25418.7433 39059.1254  53.7%     - 1285s
     0     0 39057.4507    0  433 25418.7433 39057.4507  53.7%     - 1286s
     0     0 39055.4281    0  433 25418.7433 39055.4281  53.6%     - 1288s
     0     0 39052.6402    0  433 25418.7433 39052.6402  53.6%     - 1290s
     0     0 39052.5551    0  430 25418.7433 39052.5551  53.6%     - 1292s
     0     0 38965.0542    0  444 25418.7433 38965.0542  53.3%     - 1313s
H    0     0                    25494.920084 38964.0732  52.8%     - 1338s
     0     0 38949.5807    0  435 25494.9201 38949.5807  52.8%     - 1350s
     0     0 38928.9543    0  427 25494.9201 38928.9543  52.7%     - 1357s
     0     0 38922.5055    0  435 25494.9201 38922.5055  52.7%     - 1362s
     0     0 38911.6873    0  435 25494.9201 38911.6873  52.6%     - 1370s
     0     0 38908.1767    0  441 25494.9201 38908.1767  52.6%     - 1375s
     0     0 38907.5935    0  439 25494.9201 38907.5935  52.6%     - 1378s
     0     0 38860.3576    0  449 25494.9201 38860.3576  52.4%     - 1400s
     0     0 38849.5391    0  441 25494.9201 38849.5391  52.4%     - 1407s
     0     0 38842.8218    0  448 25494.9201 38842.8218  52.4%     - 1411s
     0     0 38839.1186    0  450 25494.9201 38839.1186  52.3%     - 1415s
     0     0 38838.3138    0  401 25494.9201 38838.3138  52.3%     - 1416s
     0     0 38801.3333    0  441 25494.9201 38801.3333  52.2%     - 1435s
     0     0 38791.4482    0  442 25494.9201 38791.4482  52.2%     - 1448s
     0     0 38787.3316    0  444 25494.9201 38787.3316  52.1%     - 1454s
     0     0 38783.0616    0  437 25494.9201 38783.0616  52.1%     - 1460s
     0     0 38780.5050    0  441 25494.9201 38780.5050  52.1%     - 1465s
     0     0 38779.1721    0  444 25494.9201 38779.1721  52.1%     - 1467s
     0     0 38768.9989    0  441 25494.9201 38768.9989  52.1%     - 1479s
     0     0 38764.8530    0  446 25494.9201 38764.8530  52.0%     - 1485s
     0     0 38761.3816    0  451 25494.9201 38761.3816  52.0%     - 1489s
     0     0 38759.7378    0  451 25494.9201 38759.7378  52.0%     - 1492s
     0     0 38753.0783    0  449 25494.9201 38753.0783  52.0%     - 1499s
H    0     0                    25503.891344 38752.5333  51.9%     - 1535s
     0     0 38749.3534    0  452 25503.8913 38749.3534  51.9%     - 1540s
     0     0 38748.8076    0  452 25503.8913 38748.8076  51.9%     - 1541s
     0     0 38739.4282    0  447 25503.8913 38739.4282  51.9%     - 1552s
     0     0 38738.3311    0  453 25503.8913 38738.3311  51.9%     - 1556s
     0     0 38731.4943    0  449 25503.8913 38731.4943  51.9%     - 1567s
     0     0 38731.4191    0  449 25503.8913 38731.4191  51.9%     - 1576s
H    0     0                    25504.621297 38731.4191  51.9%     - 1703s
     0     2 38731.4191    0  449 25504.6213 38731.4191  51.9%     - 1968s
     1     4 38674.0874    1  385 25504.6213 38731.0119  51.9%  7784 2003s
     3     8 38498.5740    2  428 25504.6213 38674.0678  51.6% 10646 2066s
     7    16 38475.8381    3  445 25504.6213 38497.9034  50.9% 14134 2161s
    15    32 38221.2418    4  443 25504.6213 38475.6096  50.9% 16299 2215s
    31    48 37299.7950    5  421 25504.6213 38221.2218  49.9% 24854 2354s
    47    78 36595.6595    6  320 25504.6213 38221.2218  49.9% 27190 2462s
    77   167 36444.6052    7  353 25504.6213 38221.2218  49.9% 23316 2591s
   166   199 35393.9849    8  244 25504.6213 38221.2218  49.9% 15178 2640s
   198   229 35345.8354    9  247 25504.6213 38221.2218  49.9% 14813 2696s
   228   260 35323.3411   10  245 25504.6213 38221.2218  49.9% 14137 2760s
H  249   260                    25521.492298 38221.2218  49.8% 13331 2760s
   264   289 34996.2588   10  241 25521.4923 38221.2218  49.8% 12952 2827s
   301   357 35351.9278    9  239 25521.4923 38221.2218  49.8% 12349 2893s
   371   450 35074.9374   11  246 25521.4923 38221.2218  49.8% 11331 2948s
   474   538 32489.5273   11  224 25521.4923 38221.2218  49.8% 10262 2989s
   578   600 31121.6438   29  162 25521.4923 38221.2218  49.8%  9645 3029s
   668   629 infeasible   32      25521.4923 38221.2218  49.8%  9168 3067s
   736   674 28958.5705   33  174 25521.4923 38221.2218  49.8%  8924 3097s
   803   744 31433.9161   12  215 25521.4923 38221.2218  49.8%  8805 3134s
   891   816 30957.4793   13  195 25521.4923 38221.2218  49.8%  8584 3171s
   985   911 30306.8369   14  158 25521.4923 38221.2218  49.8%  8364 3205s
  1103  1013 30013.0071   17  141 25521.4923 38221.2218  49.8%  7959 3241s
  1247  1105 29920.6242   19  149 25521.4923 38221.2218  49.8%  7557 3275s
  1401  1140 29798.9275   20  151 25521.4923 38221.2218  49.8%  7180 3313s
  1485  1222 28533.9711   20  131 25521.4923 38221.2218  49.8%  7019 3347s
  1645  1328 29750.8110   21  149 25521.4923 38221.2218  49.8%  6658 3382s
  1837  1384 29208.1012   26  117 25521.4923 38221.2218  49.8%  6292 3423s
  2026  1434 28943.6717   27  113 25521.4923 38221.2218  49.8%  6021 3461s
  2183  1437 27888.5108   26  113 25521.4923 38221.2218  49.8%  5889 3505s
  2294  1473 26452.8912   30   84 25521.4923 38221.2218  49.8%  5864 3553s
  2401  1550 34344.4026   14  302 25521.4923 38221.2218  49.8%  5868 3597s
  2534  1549     cutoff   64      25521.4923 38221.2218  49.8%  5856 3600s

Cutting planes:
  Learned: 1
  Gomory: 12
  Implied bound: 14
  MIR: 1589
  Flow cover: 3772
  RLT: 38
  Relax-and-lift: 409

Explored 2537 nodes (15570339 simplex iterations) in 3600.11 seconds (5216.86 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 25521.5 25504.6 25503.9 ... 25163.7

Time limit reached
Warning: max constraint violation (2.6412e-09) exceeds tolerance
Best objective 2.552149229764e+04, best bound 3.822122175545e+04, gap 49.7609%
  WARNING: Time limit reached. Using best solution found (gap: 49.76%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 25521.49, θ = 173230.56
  Upper Bound (UB) = 25521.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173230.56
  [DEBUG]   ✓ Scenario 0: θ = 173230.56 ≤ Q = 175714.36 (slack: 2483.80)
  [DEBUG]   ✓ Scenario 1: θ = 173230.56 ≤ Q = 173230.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173230.56 ≤ Q = 173230.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173230.56 ≤ Q = 173230.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173230.56 ≤ Q = 173230.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173230.56 ≤ Q = 173230.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 173230.56 ≤ Q = 175597.84 (slack: 2367.27)
  [DEBUG]   ✓ Scenario 12: θ = 173230.56 ≤ Q = 173230.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 173230.56 ≤ Q = 173230.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 173230.56 ≤ Q = 173230.56 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5dcb0763
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5dcb0763
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-09, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-12, 2e+02]
Found heuristic solution: objective 1.425543e+13
Presolve removed 275 rows and 275 columns
Presolve time: 0.00s

Cleanup yields a better solution

Explored 0 nodes (0 simplex iterations) in 0.00 seconds (0.00 work units)
Thread count was 1 (of 32 available processors)

Solution count 2: -7.87588e+21 1.42554e+13 
No other solutions better than 0

Model is unbounded
Warning: max constraint violation (6.9904e-09) exceeds tolerance
Best objective -7.875883427157e+21, best bound -, gap -
  Subproblem failed to solve! Status: 5
ERROR: Subproblem failed. Terminating.

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 20
Total Time: 54857.65s
Converged: False
Final Lower Bound: 24963.5585
Final Upper Bound: 25521.4923
Final Gap: 557.933823
Number of Critical Scenarios: 20
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: False
Iterations: 20
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-04 00:59:42
Total Time: 54857.65s
Optimal Value: N/A
Lower Bound: 24963.56
Upper Bound: 25521.49
Gap: 557.933823
Plants Opened: [] (0 plants)
DCs Opened: [] (0 DCs)
================================================================================

Results saved to: result/DH_single_full_seed15_MD_gamma20_20260104_005943.csv

Total Execution Time: 54858.23 seconds
End Time: 2026-01-04 00:59:43

All tasks completed successfully!

