
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 32
DI Scenario: LD
Start Time: 2026-01-04 04:19:57
================================================================================
Loading data from data/DH_data_full_seed32.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.114', '1.241'] (k=0.266)
  Product 1: ['1.000', '1.080', '1.167'] (k=0.190)
  Product 2: ['1.000', '1.084', '1.175'] (k=0.199)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=907, max=1758
  DC capacity (MC): min=414, max=848

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.36, max=34.58, count=82
  Deviation (μ̂): min=4.01, max=9.93

Costs:
  Plant fixed cost: min=5128, max=9874
  DC fixed cost: min=3187, max=5281
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.388', '1.927'] (k=0.809)
    Product 1: ['1.000', '1.413', '1.997'] (k=0.853)
    Product 2: ['1.000', '1.367', '1.870'] (k=0.772)
  MD:
    Product 0: ['1.000', '1.243', '1.546'] (k=0.537)
    Product 1: ['1.000', '1.244', '1.547'] (k=0.538)
    Product 2: ['1.000', '1.196', '1.430'] (k=0.441)
  LD:
    Product 0: ['1.000', '1.114', '1.241'] (k=0.266)
    Product 1: ['1.000', '1.080', '1.167'] (k=0.190)
    Product 2: ['1.000', '1.084', '1.175'] (k=0.199)
  Mixed:
    Product 0: ['1.000', '1.388', '1.927'] (k=0.809)
    Product 1: ['1.000', '1.244', '1.547'] (k=0.538)
    Product 2: ['1.000', '1.084', '1.175'] (k=0.199)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0x32921d26
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 8e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.08s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314720.4181
Found heuristic solution: objective -194692.4827

Root relaxation: objective 5.470637e+04, 4484 iterations, 0.13 seconds (0.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54706.3711    0  600 -194692.48 54706.3711   128%     -    0s
H    0     0                    -141182.1511 54706.3711   139%     -    0s
H    0     0                    -136053.8413 54706.3711   140%     -    0s
     0     0 51291.6836    0  811 -136053.84 51291.6836   138%     -    0s
     0     0 50990.5057    0  912 -136053.84 50990.5057   137%     -    0s
     0     0 50980.5696    0  914 -136053.84 50980.5696   137%     -    0s
     0     0 50978.7959    0  912 -136053.84 50978.7959   137%     -    0s
     0     0 50978.1201    0  915 -136053.84 50978.1201   137%     -    1s
     0     0 50978.0852    0  914 -136053.84 50978.0852   137%     -    1s
     0     0 47183.7725    0 1149 -136053.84 47183.7725   135%     -    2s
     0     0 46933.8010    0 1171 -136053.84 46933.8010   134%     -    2s
     0     0 46861.6799    0 1193 -136053.84 46861.6799   134%     -    2s
H    0     0                    -108534.0899 46856.4033   143%     -    2s
     0     0 46856.4033    0 1198 -108534.09 46856.4033   143%     -    2s
     0     0 46856.4014    0 1198 -108534.09 46856.4014   143%     -    2s
H    0     0                    -93521.05027 43871.7099   147%     -    3s
H    0     0                    -91867.05921 43871.7099   148%     -    3s
H    0     0                    -34446.00045 43871.7099   227%     -    3s
H    0     0                    -27650.91059 43871.7099   259%     -    3s
H    0     0                    -12132.37216 43871.7099   462%     -    3s
     0     0 43871.7099    0 1278 -12132.372 43871.7099   462%     -    3s
     0     0 43513.4466    0 1282 -12132.372 43513.4466   459%     -    4s
     0     0 43466.6573    0 1291 -12132.372 43466.6573   458%     -    4s
     0     0 43464.7273    0 1295 -12132.372 43464.7273   458%     -    4s
H    0     0                    -11756.69605 43464.7273   470%     -    5s
H    0     0                    -11736.97168 43464.7273   470%     -    5s
H    0     0                    -11717.36699 43464.7273   471%     -    5s
H    0     0                    -11672.24293 43464.7273   472%     -    5s
H    0     0                    -11599.70347 43464.7273   475%     -    5s
H    0     0                    -10650.84411 43464.7273   508%     -    5s
H    0     0                    -10612.73912 43464.7273   510%     -    5s
H    0     0                    -10309.32763 43464.7273   522%     -    5s
H    0     0                    -10294.42240 43464.7273   522%     -    5s
H    0     0                    -10285.46628 43464.7273   523%     -    5s
H    0     0                    -10277.81773 41168.5767   501%     -    6s
H    0     0                    -10237.23356 41168.5767   502%     -    6s
H    0     0                    -10193.36461 41168.5767   504%     -    6s
H    0     0                    -10111.99003 41168.5767   507%     -    6s
H    0     0                    -10107.27935 41168.5767   507%     -    6s
H    0     0                    -10104.18213 41168.5767   507%     -    6s
H    0     0                    -10080.99696 41168.5767   508%     -    6s
H    0     0                    -10074.77943 41168.5767   509%     -    6s
H    0     0                    -10072.30514 41168.5767   509%     -    6s
H    0     0                    -9618.771820 41168.5767   528%     -    6s
     0     0 41168.5767    0 1285 -9618.7718 41168.5767   528%     -    6s
H    0     0                    -5891.570691 40839.0979   793%     -    7s
H    0     0                    -5614.203433 40839.0979   827%     -    7s
H    0     0                    -5524.110207 40839.0979   839%     -    7s
H    0     0                    -5480.572951 40839.0979   845%     -    7s
H    0     0                    -4987.492943 40839.0979   919%     -    7s
H    0     0                    -4973.315401 40839.0979   921%     -    7s
H    0     0                    2531.7482591 40839.0979  1513%     -    7s
H    0     0                    2540.7159667 40839.0979  1507%     -    7s
H    0     0                    2620.3230027 40839.0979  1459%     -    7s
H    0     0                    2624.5395265 40839.0979  1456%     -    7s
H    0     0                    2649.8424529 40839.0979  1441%     -    7s
H    0     0                    2654.0589767 40839.0979  1439%     -    7s
H    0     0                    2657.2828875 40839.0979  1437%     -    7s
H    0     0                    2686.5286983 40839.0979  1420%     -    7s
H    0     0                    2874.0171285 40839.0979  1321%     -    7s
H    0     0                    2953.5362293 40839.0979  1283%     -    7s
H    0     0                    2972.9025129 40839.0979  1274%     -    7s
     0     0 40839.0979    0 1312 2972.90251 40839.0979  1274%     -    7s
     0     0 40754.4956    0 1305 2972.90251 40754.4956  1271%     -    7s
     0     0 40740.9312    0 1318 2972.90251 40740.9312  1270%     -    7s
     0     0 40737.6095    0 1321 2972.90251 40737.6095  1270%     -    7s
H    0     0                    3977.1061550 39186.1293   885%     -    9s
H    0     0                    4124.8109227 39186.1293   850%     -    9s
H    0     0                    4160.7782505 39186.1293   842%     -    9s
H    0     0                    4300.4700987 39186.1293   811%     -    9s
H    0     0                    4332.7799600 39186.1293   804%     -    9s
H    0     0                    4335.9486999 39186.1293   804%     -    9s
H    0     0                    4346.3808319 39186.1293   802%     -    9s
     0     0 39186.1293    0 1348 4346.38083 39186.1293   802%     -    9s
     0     0 38925.1804    0 1370 4346.38083 38925.1804   796%     -    9s
     0     0 38879.4163    0 1420 4346.38083 38879.4163   795%     -   10s
     0     0 38872.0904    0 1412 4346.38083 38872.0904   794%     -   10s
H    0     0                    4555.4199640 37770.5595   729%     -   11s
H    0     0                    4570.9787731 37770.5595   726%     -   11s
H    0     0                    4588.4925673 37770.5595   723%     -   11s
     0     0 37770.5595    0 1353 4588.49257 37770.5595   723%     -   11s
     0     0 37514.5757    0 1404 4588.49257 37514.5757   718%     -   12s
     0     0 37477.3178    0 1411 4588.49257 37477.3178   717%     -   13s
     0     0 37466.1433    0 1425 4588.49257 37466.1433   717%     -   13s
H    0     0                    4724.9932351 37466.1433   693%     -   13s
H    0     0                    5029.8118574 36645.9408   629%     -   15s
H    0     0                    5052.7406701 36645.9408   625%     -   15s
H    0     0                    5138.5867655 36645.9408   613%     -   15s
     0     0 36645.9408    0 1401 5138.58677 36645.9408   613%     -   15s
     0     0 36432.9549    0 1446 5138.58677 36432.9549   609%     -   16s
     0     0 36374.5699    0 1455 5138.58677 36374.5699   608%     -   16s
     0     0 36368.3749    0 1456 5138.58677 36368.3749   608%     -   17s
     0     0 35716.4802    0 1379 5138.58677 35716.4802   595%     -   19s
     0     0 35567.8685    0 1425 5138.58677 35567.8685   592%     -   20s
     0     0 35527.6675    0 1440 5138.58677 35527.6675   591%     -   20s
     0     0 35522.5062    0 1455 5138.58677 35522.5062   591%     -   20s
H    0     0                    5208.0558773 35011.2399   572%     -   22s
H    0     0                    5311.0892060 35011.2399   559%     -   22s
H    0     0                    5333.2094650 35011.2399   556%     -   22s
H    0     0                    5377.9631693 35011.2399   551%     -   22s
     0     0 35011.2399    0 1368 5377.96317 35011.2399   551%     -   22s
     0     0 34908.1740    0 1419 5377.96317 34908.1740   549%     -   23s
H    0     0                    5426.2701537 34884.8143   543%     -   23s
     0     0 34884.8143    0 1444 5426.27015 34884.8143   543%     -   23s
     0     0 34880.2137    0 1464 5426.27015 34880.2137   543%     -   23s
H    0     0                    5448.7344227 34422.2103   532%     -   25s
H    0     0                    5531.2696034 34422.2103   522%     -   25s
H    0     0                    5858.6654770 34422.2103   488%     -   25s
H    0     0                    5885.1469788 34422.2103   485%     -   25s
H    0     0                    6043.5211547 34422.2103   470%     -   25s
H    0     0                    6074.9581961 34422.2103   467%     -   25s
H    0     0                    6194.0420633 34422.2103   456%     -   25s
H    0     0                    6226.6182199 34422.2103   453%     -   25s
H    0     0                    6247.5091048 34422.2103   451%     -   25s
H    0     0                    6278.9461462 34422.2103   448%     -   25s
H    0     0                    6327.6567748 34422.2103   444%     -   25s
     0     0 34422.2103    0 1463 6327.65677 34422.2103   444%     -   25s
H    0     0                    6440.0359645 34422.0913   435%     -   25s
H    0     0                    6737.2314579 34344.4808   410%     -   26s
H    0     0                    6737.9190265 34344.4808   410%     -   26s
H    0     0                    6988.2233275 34344.4808   391%     -   26s
H    0     0                    6997.3722448 34344.4808   391%     -   26s
H    0     0                    7003.1915854 34344.4808   390%     -   26s
H    0     0                    7026.9319406 34344.4808   389%     -   26s
H    0     0                    7027.7300006 34344.4808   389%     -   26s
H    0     0                    7037.4459010 34344.4808   388%     -   26s
     0     0 34344.4808    0 1487 7037.44590 34344.4808   388%     -   26s
     0     0 34323.3147    0 1514 7037.44590 34323.3147   388%     -   26s
     0     0 34316.5382    0 1520 7037.44590 34316.5382   388%     -   27s
H    0     0                    7089.3507584 33870.0690   378%     -   28s
H    0     0                    7093.5672822 33870.0690   377%     -   28s
H    0     0                    7103.0931534 33870.0690   377%     -   28s
H    0     0                    7104.9879903 33870.0690   377%     -   28s
     0     0 33870.0690    0 1396 7104.98799 33870.0690   377%     -   28s
H    0     0                    7161.8425565 33760.5043   371%     -   29s
H    0     0                    7162.3109630 33760.5043   371%     -   29s
H    0     0                    7191.8304132 33760.5043   369%     -   29s
H    0     0                    7197.0487919 33760.5043   369%     -   29s
     0     0 33760.5043    0 1447 7197.04879 33760.5043   369%     -   29s
     0     0 33737.7715    0 1442 7197.04879 33737.7715   369%     -   30s
     0     0 33730.8128    0 1458 7197.04879 33730.8128   369%     -   30s
     0     0 33420.3578    0 1392 7197.04879 33420.3578   364%     -   32s
H    0     0                    7210.2415848 33420.3227   364%     -   32s
     0     0 33325.0523    0 1460 7210.24158 33325.0523   362%     -   33s
     0     0 33304.3273    0 1456 7210.24158 33304.3273   362%     -   34s
H    0     0                    7276.5965369 33036.6103   354%     -   36s
H    0     0                    7337.8083697 33036.6103   350%     -   36s
H    0     0                    7361.8022979 33036.6103   349%     -   36s
H    0     0                    7365.5088285 33036.6103   349%     -   36s
H    0     0                    7384.9887022 33036.6103   347%     -   36s
H    0     0                    7505.0625098 33036.6103   340%     -   36s
     0     0 33036.6103    0 1416 7505.06251 33036.6103   340%     -   36s
     0     0 32970.4696    0 1424 7505.06251 32970.4696   339%     -   37s
     0     0 32955.2606    0 1436 7505.06251 32955.2606   339%     -   37s
     0     0 32730.3382    0 1419 7505.06251 32730.3382   336%     -   39s
     0     0 32670.6814    0 1426 7505.06251 32670.6814   335%     -   39s
     0     0 32652.7029    0 1447 7505.06251 32652.7029   335%     -   40s
     0     0 32471.9603    0 1411 7505.06251 32471.9603   333%     -   41s
     0     0 32471.9295    0 1411 7505.06251 32471.9295   333%     -   41s
     0     2 32471.8316    0 1411 7505.06251 32471.8316   333%     -   45s
     3     7 32079.6887    2 1176 7505.06251 32252.1752   330%  6310   55s
    13    28 30448.5722    4  969 7505.06251 31539.2690   320%  4673   60s
H   34    54                    7514.7526214 30442.6818   305%  4464   62s
    87   193 27186.5416    7  647 7514.75262 28597.2754   281%  4196   65s
H  640   622                    7579.6622847 28597.2754   277%  1043   69s
   772   705 9088.26327   22  298 7579.66228 28597.2754   277%   920   71s
H  813   737                    7622.0308661 28597.2754   275%   908   72s
  1129  1078 15335.9038   27  330 7622.03087 26593.9430   249%   766   75s
  2118  1729 19155.0701   10  484 7622.03087 25443.6920   234%   530   80s
H 2892  2149                    7635.9889299 24771.2598   224%   455   83s
H 2913  2148                    7654.8553580 24771.2598   224%   454   83s
  3512  2786 15596.7797   31  446 7654.85536 24456.5730   219%   413   85s
H 3826  2786                    7666.9185849 24456.5730   219%   395   91s
  3827  2787 12518.3451   10 1411 7666.91858 24456.5730   219%   395  107s
  3837  2794 17968.7492   23  467 7666.91858 20167.1467   163%   394  110s
  3856  2811 18428.3552   17  485 7666.91858 18428.3552   140%   398  115s
H 4193  2727                    8149.1394015 16227.6016  99.1%   407  118s
H 4316  2580                    8211.7253003 14923.0577  81.7%   402  118s
H 4321  2451                    8238.9423477 14923.0577  81.1%   402  118s
H 4383  2311                    8266.9267464 14778.3647  78.8%   400  118s
H 4474  2153                    8350.6363583 14778.3647  77.0%   397  119s
H 4479  2043                    8379.8474428 14778.3647  76.4%   397  119s
H 4628  1878                    8389.5027191 14319.7725  70.7%   393  120s
H 4635  1778                    8398.3246979 13816.3873  64.5%   393  120s
H 4638  1683                    8403.4454411 13816.3873  64.4%   393  120s
H 4639  1594                    8405.0817438 13816.3873  64.4%   393  120s
H 4643  1509                    8413.9037226 13816.3873  64.2%   393  120s
H 4807  1325                    8423.5589989 13697.4456  62.6%   387  120s
H 4811  1248                    8427.8464447 13697.4456  62.5%   387  120s
H 4836  1167                    8428.2877489 13697.4456  62.5%   386  120s
H 4970   984                    8437.9430252 13328.0260  58.0%   381  121s
H 4981   915                    8451.8857473 13328.0260  57.7%   381  121s
* 5143   750              37    8452.3013792 11935.8192  41.2%   373  121s
H 5158   686                    8457.8269011 11935.8192  41.1%   372  121s

Cutting planes:
  Gomory: 4
  Implied bound: 23
  Projected implied bound: 57
  MIR: 313
  Flow cover: 759
  RLT: 11
  Relax-and-lift: 240

Explored 5197 nodes (2029688 simplex iterations) in 121.90 seconds (244.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 8457.83 8452.3 8451.89 ... 8403.45

Optimal solution found (tolerance 1.00e-06)
Best objective 8.457826901132e+03, best bound 8.457826901132e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 121.91s
  Master Objective (UB) = 8457.83, θ = 130265.18
  Upper Bound (UB) = 8457.83

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 130265.18
  [DEBUG]   ✓ Scenario 0: θ = 130265.18 ≤ Q = 130265.18 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x12f62bad
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x12f62bad
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.363459e+13
Presolve removed 2592 rows and 1886 columns
Presolve time: 0.00s
Presolved: 501 rows, 503 columns, 1412 nonzeros
Found heuristic solution: objective 6887207.2985
Variable types: 339 continuous, 164 integer (164 binary)

Root relaxation: objective -1.275150e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127514.97    0  124 6887207.30 -127514.97   102%     -    0s
H    0     0                    -93412.72933 -127514.97  36.5%     -    0s
H    0     0                    -93896.65178 -127514.97  35.8%     -    0s
*    0     0               0    -96261.16953 -96261.170  0.00%     -    0s

Cutting planes:
  Gomory: 14
  MIR: 195

Explored 1 nodes (378 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -96261.2 -93896.7 -93412.7 ... 1.36346e+13
No other solutions better than -96261.2

Optimal solution found (tolerance 1.00e-06)
Best objective -9.626116952744e+04, best bound -9.626116952744e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 99883.84
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -96261.17
  [DEBUG]   S×d_nominal = 196145.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 196145.01 + -96261.17 = 99883.84
  [DEBUG]   Current θ from Master = 130265.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 30381.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21923.51
  Lower Bound (LB) = -21923.51
  Gap (UB-LB) = 30381.3418, Absolute Gap = 30381.3418, Relative Gap = 3.592098
  Not converged yet (gap = 30381.34 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0x82954a39
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 8e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -21923.5 (0.01s)
Loaded MIP start from previous solve with objective -21923.5

Presolve removed 13767 rows and 5586 columns
Presolve time: 0.32s
Presolved: 18196 rows, 9154 columns, 100768 nonzeros
Variable types: 6895 continuous, 2259 integer (2259 binary)

Root relaxation: objective 1.585875e+04, 8829 iterations, 0.97 seconds (1.92 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15858.7488    0  283 -21923.515 15858.7488   172%     -    1s
H    0     0                    -21670.44390 15858.7488   173%     -    1s
H    0     0                    -20508.33720 15858.7488   177%     -    1s
H    0     0                    -20500.07143 15858.7488   177%     -    1s
H    0     0                    -18840.53570 15858.7488   184%     -    1s
H    0     0                    -18635.12786 15858.7488   185%     -    1s
H    0     0                    -18629.75127 15858.7488   185%     -    1s
     0     0 7511.62551    0  632 -18629.751 7511.62551   140%     -    3s
H    0     0                    -16539.22265 7511.23533   145%     -    3s
H    0     0                    -16394.48822 7511.23533   146%     -    3s
     0     0 7366.28378    0  651 -16394.488 7366.28378   145%     -    3s
     0     0 7365.55533    0  654 -16394.488 7365.55533   145%     -    3s
     0     0  613.95534    0  709 -16394.488  613.95534   104%     -    6s
H    0     0                    -9967.640007  609.38672   106%     -    6s
     0     0   22.32498    0  732 -9967.6400   22.32498   100%     -    6s
     0     0  -56.59282    0  734 -9967.6400  -56.59282  99.4%     -    7s
     0     0  -87.14076    0  732 -9967.6400  -87.14076  99.1%     -    7s
     0     0  -90.42333    0  735 -9967.6400  -90.42333  99.1%     -    7s
     0     0  -90.48635    0  733 -9967.6400  -90.48635  99.1%     -    7s
H    0     0                    -9033.139881 -3340.2168  63.0%     -   10s
H    0     0                    -9009.148932 -3340.2168  62.9%     -   10s
H    0     0                    -8988.394701 -3340.2168  62.8%     -   10s
H    0     0                    -8957.538365 -3340.2168  62.7%     -   10s
H    0     0                    -8957.179821 -3340.2168  62.7%     -   10s
H    0     0                    -8955.656030 -3340.2168  62.7%     -   10s
H    0     0                    -8955.515646 -3340.2168  62.7%     -   10s
H    0     0                    -8953.973424 -3340.2168  62.7%     -   10s
H    0     0                    -8886.029194 -3340.2168  62.4%     -   10s
H    0     0                    -8771.750644 -3340.2168  61.9%     -   10s
H    0     0                    -8620.943279 -3340.2168  61.3%     -   10s
H    0     0                    -8568.421160 -3340.2168  61.0%     -   10s
H    0     0                    -8555.663401 -3340.2168  61.0%     -   10s
H    0     0                    -8524.524900 -3340.2168  60.8%     -   10s
H    0     0                    -8520.949085 -3340.2168  60.8%     -   10s
     0     0 -3340.2168    0  661 -8520.9491 -3340.2168  60.8%     -   10s
H    0     0                    -8513.959995 -3340.3534  60.8%     -   10s
H    0     0                    -8496.174878 -3774.7993  55.6%     -   11s
H    0     0                    -8495.353211 -3774.7993  55.6%     -   11s
     0     0 -3774.7993    0  761 -8495.3532 -3774.7993  55.6%     -   11s
H    0     0                    -8489.637977 -3866.9833  54.5%     -   12s
H    0     0                    -8478.237777 -3866.9833  54.4%     -   12s
H    0     0                    -8477.488053 -3866.9833  54.4%     -   12s
H    0     0                    -8476.666386 -3866.9833  54.4%     -   12s
H    0     0                    -8467.538123 -3866.9833  54.3%     -   12s
H    0     0                    -8462.379239 -3866.9833  54.3%     -   12s
H    0     0                    -8461.952991 -3866.9833  54.3%     -   12s
     0     0 -3866.9833    0  878 -8461.9530 -3866.9833  54.3%     -   12s
     0     0 -3894.9078    0  815 -8461.9530 -3894.9078  54.0%     -   12s
     0     0 -3898.1856    0  875 -8461.9530 -3898.1856  53.9%     -   12s
H    0     0                    -8418.728334 -3898.1856  53.7%     -   14s
H    0     0                    -8401.331367 -3898.1856  53.6%     -   14s
H    0     0                    -8400.509700 -3898.1856  53.6%     -   14s
H    0     0                    -8400.133345 -3898.1856  53.6%     -   14s
     0     0 -4726.8373    0  707 -8400.1333 -4726.8373  43.7%     -   15s
H    0     0                    -8391.765583 -4727.2001  43.7%     -   16s
     0     0 -5004.1463    0  742 -8391.7656 -5004.1463  40.4%     -   17s
     0     0 -5067.0941    0  831 -8391.7656 -5067.0941  39.6%     -   17s
     0     0 -5083.9467    0  793 -8391.7656 -5083.9467  39.4%     -   18s
     0     0 -5085.4612    0  798 -8391.7656 -5085.4612  39.4%     -   18s
     0     0 -5406.6736    0  651 -8391.7656 -5406.6736  35.6%     -   19s
     0     0 -5450.0316    0  711 -8391.7656 -5450.0316  35.1%     -   20s
     0     0 -5480.8312    0  817 -8391.7656 -5480.8312  34.7%     -   20s
     0     0 -5486.7007    0  792 -8391.7656 -5486.7007  34.6%     -   21s
     0     0 -5599.6450    0  518 -8391.7656 -5599.6450  33.3%     -   22s
     0     0 -5660.7328    0  725 -8391.7656 -5660.7328  32.5%     -   23s
     0     0 -5684.2867    0  433 -8391.7656 -5684.2867  32.3%     -   23s
     0     0 -5686.3498    0  437 -8391.7656 -5686.3498  32.2%     -   23s
     0     0 -5808.2985    0  808 -8391.7656 -5808.2985  30.8%     -   25s
     0     0 -5835.8902    0  889 -8391.7656 -5835.8902  30.5%     -   25s
     0     0 -5843.9363    0  946 -8391.7656 -5843.9363  30.4%     -   26s
     0     0 -5845.5842    0  957 -8391.7656 -5845.5842  30.3%     -   26s
     0     0 -5935.8954    0  796 -8391.7656 -5935.8954  29.3%     -   28s
     0     0 -5956.0268    0  813 -8391.7656 -5956.0268  29.0%     -   28s
     0     0 -5961.9185    0  808 -8391.7656 -5961.9185  29.0%     -   28s
     0     0 -6005.1464    0  799 -8391.7656 -6005.1464  28.4%     -   30s
     0     0 -6047.2805    0  807 -8391.7656 -6047.2805  27.9%     -   30s
     0     0 -6055.5906    0  753 -8391.7656 -6055.5906  27.8%     -   31s
     0     0 -6059.2746    0  832 -8391.7656 -6059.2746  27.8%     -   31s
     0     0 -6109.9373    0  820 -8391.7656 -6109.9373  27.2%     -   32s
     0     0 -6122.7155    0  828 -8391.7656 -6122.7155  27.0%     -   33s
     0     0 -6125.4224    0  832 -8391.7656 -6125.4224  27.0%     -   33s
     0     0 -6167.6750    0  833 -8391.7656 -6167.6750  26.5%     -   34s
     0     0 -6176.1843    0  810 -8391.7656 -6176.1843  26.4%     -   35s
     0     0 -6179.2406    0  812 -8391.7656 -6179.2406  26.4%     -   35s
     0     0 -6202.2038    0  619 -8391.7656 -6202.2038  26.1%     -   36s
     0     0 -6204.9354    0  724 -8391.7656 -6204.9354  26.1%     -   37s
     0     0 -6229.2855    0  638 -8391.7656 -6229.2855  25.8%     -   37s
     0     0 -6229.3953    0  638 -8391.7656 -6229.3953  25.8%     -   38s
     0     2 -6229.3953    0  638 -8391.7656 -6229.3953  25.8%     -   42s
     7     4 -6328.6736    3  340 -8391.7656 -6264.6501  25.3%   809   46s
   397   348 -7587.3521   20  346 -8391.7656 -6560.9580  21.8%   271   50s
  2001  1225 -8302.8285   31  257 -8391.7656 -6933.8931  17.4%   174   55s
  4862  2022 -8045.9515   32  121 -8391.7656 -7394.6351  11.9%   147   60s
  6417  2374 -8372.9484   39  638 -8391.7656 -7482.6063  10.8%   132   72s
  6420  2376 -8182.4743   47  538 -8391.7656 -7482.6063  10.8%   132   76s
  6427  2381 -8001.9764   36  602 -8391.7656 -7482.6063  10.8%   131   80s
  6436  2387 -8037.8864   22  510 -8391.7656 -7482.6063  10.8%   131   86s
  6445  2393 -7954.3982   34  604 -8391.7656 -7482.6063  10.8%   131   90s
  6450  2396 -8237.0311   41  620 -8391.7656 -7482.6063  10.8%   131   95s
  6455  2399 -8085.5160   44  610 -8391.7656 -7482.6063  10.8%   131  101s
  6457  2401 -8197.0471   24  610 -8391.7656 -7482.6063  10.8%   131  106s
  6468  2401 -7482.6063   20  318 -8391.7656 -7482.6063  10.8%   138  110s

Cutting planes:
  Cover: 11
  Implied bound: 19
  Projected implied bound: 1
  MIR: 100
  Flow cover: 472
  GUB cover: 13
  RLT: 2
  Relax-and-lift: 30

Explored 6653 nodes (964963 simplex iterations) in 113.50 seconds (224.46 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8391.77 -8400.13 -8400.51 ... -8477.49
No other solutions better than -8391.77

Optimal solution found (tolerance 1.00e-06)
Best objective -8.391765583360e+03, best bound -8.391765583360e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 113.52s
  Master Objective (UB) = -8391.77, θ = 96513.82
  Upper Bound (UB) = -8391.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 96513.82
  [DEBUG]   ✓ Scenario 0: θ = 96513.82 ≤ Q = 96513.82 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 96513.82 ≤ Q = 96513.82 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3988a72f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc67758d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.428851e+13
Presolve removed 2598 rows and 1929 columns
Presolve time: 0.00s
Presolved: 495 rows, 460 columns, 1360 nonzeros
Found heuristic solution: objective 4661078.8747
Variable types: 296 continuous, 164 integer (164 binary)

Root relaxation: objective -1.293851e+05, 286 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129385.12    0  130 4661078.87 -129385.12   103%     -    0s
H    0     0                    -90771.56476 -129385.12  42.5%     -    0s
H    0     0                    -92010.37829 -129385.12  40.6%     -    0s
H    0     0                    -105622.9747 -129385.12  22.5%     -    0s
H    0     0                    -106001.4153 -129385.12  22.1%     -    0s
H    0     0                    -106048.4063 -115207.49  8.64%     -    0s
H    0     0                    -111628.7730 -115207.49  3.21%     -    0s
     0     0 -115207.49    0   59 -111628.77 -115207.49  3.21%     -    0s
H    0     0                    -112280.3033 -115200.03  2.60%     -    0s
H    0     0                    -112329.4727 -115200.03  2.56%     -    0s
H    0     0                    -112981.0029 -115200.03  1.96%     -    0s
     0     0 -115118.15    0   61 -112981.00 -115118.15  1.89%     -    0s
     0     0 -114907.50    0   62 -112981.00 -114907.50  1.71%     -    0s
     0     0 -114228.46    0   36 -112981.00 -114228.46  1.10%     -    0s
     0     0 -114206.55    0   40 -112981.00 -114206.55  1.08%     -    0s
     0     0 -114202.60    0   39 -112981.00 -114202.60  1.08%     -    0s
     0     0 -113856.18    0   44 -112981.00 -113856.18  0.77%     -    0s
     0     0 -113682.48    0   36 -112981.00 -113682.48  0.62%     -    0s
     0     0 -113653.41    0   35 -112981.00 -113653.41  0.60%     -    0s
     0     0 -113648.83    0   36 -112981.00 -113648.83  0.59%     -    0s
     0     0 -113312.65    0   35 -112981.00 -113312.65  0.29%     -    0s
     0     0 -113178.02    0   35 -112981.00 -113178.02  0.17%     -    0s
     0     0 -113157.85    0   19 -112981.00 -113157.85  0.16%     -    0s
     0     0 -113154.73    0   31 -112981.00 -113154.73  0.15%     -    0s
     0     0 -113092.39    0   20 -112981.00 -113092.39  0.10%     -    0s
     0     0 -113092.39    0   30 -112981.00 -113092.39  0.10%     -    0s
     0     0 -113092.39    0   31 -112981.00 -113092.39  0.10%     -    0s
     0     0 -113092.39    0   31 -112981.00 -113092.39  0.10%     -    0s
     0     0 -113043.94    0   20 -112981.00 -113043.94  0.06%     -    0s
     0     0 -113016.97    0   17 -112981.00 -113016.97  0.03%     -    0s
     0     0 -113013.23    0   17 -112981.00 -113013.23  0.03%     -    0s
     0     0 -113013.19    0   16 -112981.00 -113013.19  0.03%     -    0s
     0     0 -112997.55    0    5 -112981.00 -112997.55  0.01%     -    0s
     0     0 -112997.55    0   15 -112981.00 -112997.55  0.01%     -    0s
     0     0 -112997.55    0   11 -112981.00 -112997.55  0.01%     -    0s
     0     0 -112997.55    0    6 -112981.00 -112997.55  0.01%     -    0s
     0     0 -112997.55    0    5 -112981.00 -112997.55  0.01%     -    0s
     0     0 -112997.55    0    4 -112981.00 -112997.55  0.01%     -    0s
H    0     0                    -112991.6025 -112997.55  0.01%     -    0s
     0     0     cutoff    0      -112991.60 -112991.60  0.00%     -    0s

Cutting planes:
  MIR: 1
  Flow cover: 1

Explored 1 nodes (1054 simplex iterations) in 0.14 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -112992 -112981 -112980 ... -92010.4
No other solutions better than -112992

Optimal solution found (tolerance 1.00e-06)
Best objective -1.129916024845e+05, best bound -1.129916024845e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 74232.55
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -112991.60
  [DEBUG]   S×d_nominal = 187224.16
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 187224.16 + -112991.60 = 74232.55
  [DEBUG]   Current θ from Master = 96513.82
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22281.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30673.03
  Lower Bound (LB) = -21923.51
  Gap (UB-LB) = 13531.7493, Absolute Gap = 13531.7493, Relative Gap = 1.612503
  Not converged yet (gap = 13531.75 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0x64d4b349
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 8e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -30673 (0.02s)
MIP start from previous solve produced solution with objective -30673 (0.02s)
Loaded MIP start from previous solve with objective -30673

Presolve removed 20624 rows and 8374 columns
Presolve time: 0.41s
Presolved: 26629 rows, 12606 columns, 163799 nonzeros
Variable types: 10347 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.938989e+03, 14958 iterations, 3.49 seconds (6.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 1938.98919    0  137 -30673.029 1938.98919   106%     -    4s
H    0     0                    -13695.71174 1938.98919   114%     -    4s
H    0     0                    -10112.08082 1938.98919   119%     -    4s
     0     0 -1515.2715    0  442 -10112.081 -1515.2715  85.0%     -    6s
H    0     0                    -10032.39100 -1515.8083  84.9%     -    6s
H    0     0                    -9938.800544 -1515.8083  84.7%     -    6s
H    0     0                    -9843.615465 -1864.5602  81.1%     -    7s
     0     0 -1864.5602    0  419 -9843.6155 -1864.5602  81.1%     -    7s
     0     0 -1890.4862    0  431 -9843.6155 -1890.4862  80.8%     -    8s
     0     0 -1890.4862    0  431 -9843.6155 -1890.4862  80.8%     -    8s
H    0     0                    -9588.635690 -3456.9552  63.9%     -   10s
     0     0 -3471.5704    0  422 -9588.6357 -3471.5704  63.8%     -   10s
H    0     0                    -9316.873835 -3471.5704  62.7%     -   10s
H    0     0                    -9254.857861 -3471.5704  62.5%     -   10s
H    0     0                    -9251.133509 -3471.5704  62.5%     -   10s
H    0     0                    -9242.877852 -3471.5704  62.4%     -   10s
H    0     0                    -9191.280007 -3471.5704  62.2%     -   10s
     0     0 -3753.2879    0  191 -9191.2800 -3753.2879  59.2%     -   12s
     0     0 -3763.7284    0  494 -9191.2800 -3763.7284  59.1%     -   12s
     0     0 -3768.5909    0  504 -9191.2800 -3768.5909  59.0%     -   12s
     0     0 -3777.3944    0  199 -9191.2800 -3777.3944  58.9%     -   12s
     0     0 -3778.7771    0  203 -9191.2800 -3778.7771  58.9%     -   12s
     0     0 -3778.8700    0  206 -9191.2800 -3778.8700  58.9%     -   12s
     0     0 -4638.5833    0  552 -9191.2800 -4638.5833  49.5%     -   15s
H    0     0                    -9123.587497 -4639.2185  49.2%     -   15s
H    0     0                    -9080.843105 -4639.2185  48.9%     -   15s
H    0     0                    -9074.391035 -4639.2185  48.9%     -   15s
     0     0 -4852.1057    0  546 -9074.3910 -4852.1057  46.5%     -   17s
H    0     0                    -9052.270510 -5021.2503  44.5%     -   18s
H    0     0                    -9046.240730 -5021.2503  44.5%     -   18s
H    0     0                    -9041.841724 -5021.2503  44.5%     -   18s
     0     0 -5021.2503    0  546 -9041.8417 -5021.2503  44.5%     -   18s
     0     0 -5063.7158    0  556 -9041.8417 -5063.7158  44.0%     -   18s
     0     0 -5071.7011    0  556 -9041.8417 -5071.7011  43.9%     -   18s
     0     0 -5071.7628    0  555 -9041.8417 -5071.7628  43.9%     -   19s
H    0     0                    -9032.928131 -5512.1275  39.0%     -   22s
H    0     0                    -9032.559880 -5512.1275  39.0%     -   22s
H    0     0                    -9015.214486 -5512.1275  38.9%     -   22s
H    0     0                    -9014.556478 -5512.1275  38.9%     -   22s
H    0     0                    -9013.698944 -5512.1275  38.8%     -   22s
     0     0 -5512.1275    0  530 -9013.6989 -5512.1275  38.8%     -   22s
     0     0 -5570.9638    0  550 -9013.6989 -5570.9638  38.2%     -   23s
H    0     0                    -9013.427289 -5679.0305  37.0%     -   24s
H    0     0                    -9013.179861 -5679.0305  37.0%     -   24s
H    0     0                    -9012.563004 -5679.0305  37.0%     -   24s
H    0     0                    -9012.434479 -5679.0305  37.0%     -   24s
     0     0 -5679.0305    0  479 -9012.4345 -5679.0305  37.0%     -   24s
H    0     0                    -8952.099267 -5701.5835  36.3%     -   25s
     0     0 -5701.5835    0  532 -8952.0993 -5701.5835  36.3%     -   25s
     0     0 -5724.4887    0  485 -8952.0993 -5724.4887  36.1%     -   26s
     0     0 -5725.3019    0  552 -8952.0993 -5725.3019  36.0%     -   26s
     0     0 -5836.3439    0  460 -8952.0993 -5836.3439  34.8%     -   27s
H    0     0                    -8949.652516 -5836.8956  34.8%     -   27s
     0     0 -5858.5365    0  456 -8949.6525 -5858.5365  34.5%     -   28s
     0     0 -5865.7511    0  485 -8949.6525 -5865.7511  34.5%     -   28s
     0     0 -5870.3694    0  461 -8949.6525 -5870.3694  34.4%     -   29s
     0     0 -5871.5352    0  488 -8949.6525 -5871.5352  34.4%     -   29s
     0     0 -5872.0544    0  496 -8949.6525 -5872.0544  34.4%     -   29s
     0     0 -5941.9399    0  493 -8949.6525 -5941.9399  33.6%     -   30s
H    0     0                    -8945.760118 -5941.9579  33.6%     -   31s
H    0     0                    -8926.016181 -5941.9579  33.4%     -   31s
     0     0 -5977.9694    0  501 -8926.0162 -5977.9694  33.0%     -   31s
     0     0 -5996.6899    0  515 -8926.0162 -5996.6899  32.8%     -   32s
     0     0 -5999.4834    0  511 -8926.0162 -5999.4834  32.8%     -   32s
     0     0 -5999.7086    0  511 -8926.0162 -5999.7086  32.8%     -   32s
     0     0 -6042.3873    0  500 -8926.0162 -6042.3873  32.3%     -   33s
     0     0 -6054.2422    0  500 -8926.0162 -6054.2422  32.2%     -   33s
     0     0 -6071.1670    0  500 -8926.0162 -6071.1670  32.0%     -   34s
     0     0 -6081.3745    0  510 -8926.0162 -6081.3745  31.9%     -   34s
     0     0 -6081.7153    0  512 -8926.0162 -6081.7153  31.9%     -   34s
H    0     0                    -8912.431262 -6145.7671  31.0%     -   35s
H    0     0                    -8903.483121 -6145.7671  31.0%     -   35s
H    0     0                    -8903.351277 -6145.7671  31.0%     -   35s
H    0     0                    -8901.147935 -6145.7671  31.0%     -   35s
     0     0 -6145.7671    0  528 -8901.1479 -6145.7671  31.0%     -   35s
H    0     0                    -8900.589752 -6145.8682  30.9%     -   36s
H    0     0                    -8898.589396 -6145.8682  30.9%     -   36s
     0     0 -6163.3939    0  521 -8898.5894 -6163.3939  30.7%     -   36s
     0     0 -6168.3409    0  530 -8898.5894 -6168.3409  30.7%     -   36s
     0     0 -6169.2407    0  532 -8898.5894 -6169.2407  30.7%     -   36s
     0     0 -6193.1559    0  545 -8898.5894 -6193.1559  30.4%     -   37s
H    0     0                    -8871.395993 -6193.2261  30.2%     -   37s
     0     0 -6204.4312    0  546 -8871.3960 -6204.4312  30.1%     -   38s
     0     0 -6207.1932    0  551 -8871.3960 -6207.1932  30.0%     -   38s
     0     0 -6209.0358    0  553 -8871.3960 -6209.0358  30.0%     -   38s
     0     0 -6209.5813    0  561 -8871.3960 -6209.5813  30.0%     -   38s
     0     0 -6237.8844    0  549 -8871.3960 -6237.8844  29.7%     -   39s
H    0     0                    -8860.411587 -6238.1704  29.6%     -   40s
     0     0 -6248.6148    0  541 -8860.4116 -6248.6148  29.5%     -   40s
     0     0 -6259.2524    0  546 -8860.4116 -6259.2524  29.4%     -   40s
     0     0 -6266.3747    0  546 -8860.4116 -6266.3747  29.3%     -   40s
     0     0 -6269.9670    0  547 -8860.4116 -6269.9670  29.2%     -   41s
     0     0 -6273.0038    0  542 -8860.4116 -6273.0038  29.2%     -   41s
     0     0 -6273.0215    0  543 -8860.4116 -6273.0215  29.2%     -   41s
     0     0 -6295.7127    0  560 -8860.4116 -6295.7127  28.9%     -   42s
     0     0 -6302.1879    0  565 -8860.4116 -6302.1879  28.9%     -   42s
     0     0 -6305.0937    0  568 -8860.4116 -6305.0937  28.8%     -   43s
     0     0 -6305.3300    0  564 -8860.4116 -6305.3300  28.8%     -   43s
     0     0 -6316.3047    0  564 -8860.4116 -6316.3047  28.7%     -   43s
H    0     0                    -8858.405874 -6316.3620  28.7%     -   44s
     0     0 -6319.6664    0  561 -8858.4059 -6319.6664  28.7%     -   44s
     0     0 -6320.0583    0  564 -8858.4059 -6320.0583  28.7%     -   44s
     0     0 -6322.6436    0  569 -8858.4059 -6322.6436  28.6%     -   45s
     0     0 -6324.4501    0  571 -8858.4059 -6324.4501  28.6%     -   45s
     0     0 -6325.3307    0  570 -8858.4059 -6325.3307  28.6%     -   46s
     0     0 -6327.8882    0  577 -8858.4059 -6327.8882  28.6%     -   46s
     0     0 -6328.3903    0  579 -8858.4059 -6328.3903  28.6%     -   46s
     0     0 -6330.5156    0  572 -8858.4059 -6330.5156  28.5%     -   47s
     0     0 -6330.5855    0  572 -8858.4059 -6330.5855  28.5%     -   48s
     0     2 -6330.5855    0  572 -8858.4059 -6330.5855  28.5%     -   54s
     1     4 -6343.8480    1  571 -8858.4059 -6330.9119  28.5%   497   55s
    15    26 -7111.7789    4  626 -8858.4059 -6565.2693  25.9%  2176   60s
    85    90 -7598.6461    7  669 -8858.4059 -6748.7627  23.8%  1561   65s
   190   200 -7721.8855    9  657 -8858.4059 -6799.7962  23.2%  1535   70s
   354   283     cutoff   11      -8858.4059 -6821.7605  23.0%  1285   77s
   518   309 -8205.0168   13  535 -8858.4059 -6821.7605  23.0%  1162   81s
   674   348     cutoff   15      -8858.4059 -6821.7605  23.0%  1091   85s
   852   381     cutoff   15      -8858.4059 -6872.1980  22.4%  1020   91s
  1027   481 -7813.7692    9  303 -8858.4059 -6872.1980  22.4%   959   97s
  1131   552 -8172.4883   10  258 -8858.4059 -7060.2774  20.3%   920  100s
  1406   716 -8462.6791   18  287 -8858.4059 -7105.2565  19.8%   824  105s
  1701   770 -8191.2887   15  207 -8858.4059 -7136.2635  19.4%   753  111s
  1963   801 -8319.1349   24  332 -8858.4059 -7223.4284  18.5%   733  117s
  2239   754 -8612.5052   37  153 -8858.4059 -7397.4945  16.5%   718  122s
  2521   648     cutoff   12      -8858.4059 -7621.2210  14.0%   700  126s
  3598   763     cutoff   19      -8858.4059 -7941.8500  10.3%   553  131s
  6188    70 -8852.2879   49   14 -8858.4059 -8575.8062  3.19%   369  135s

Cutting planes:
  Gomory: 4
  Implied bound: 23
  MIR: 189
  Flow cover: 701
  Zero half: 5
  RLT: 10
  Relax-and-lift: 32

Explored 7295 nodes (2398101 simplex iterations) in 135.77 seconds (352.22 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -8858.41 -8860.41 -8871.4 ... -8945.76
No other solutions better than -8858.41

Optimal solution found (tolerance 1.00e-06)
Best objective -8.858405873816e+03, best bound -8.858405873816e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 135.79s
  Master Objective (UB) = -8858.41, θ = 96047.25
  Upper Bound (UB) = -8858.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 96047.25
  [DEBUG]   ✓ Scenario 0: θ = 96047.25 ≤ Q = 96047.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 96047.25 ≤ Q = 96047.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 96047.25 ≤ Q = 96047.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3a426e97
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc5bd9169
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.419024e+13
Presolve removed 2598 rows and 1977 columns
Presolve time: 0.00s
Presolved: 495 rows, 412 columns, 1312 nonzeros
Found heuristic solution: objective -79497.83675
Variable types: 248 continuous, 164 integer (164 binary)

Root relaxation: objective -1.219431e+05, 306 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -121943.08    0  124 -79497.837 -121943.08  53.4%     -    0s
H    0     0                    -87880.14635 -121943.08  38.8%     -    0s
H    0     0                    -88269.92677 -121943.08  38.1%     -    0s
H    0     0                    -96818.29402 -121943.08  26.0%     -    0s
H    0     0                    -98623.17301 -114021.65  15.6%     -    0s
H    0     0                    -102861.5240 -114021.65  10.8%     -    0s
     0     0 -114021.65    0  119 -102861.52 -114021.65  10.8%     -    0s
H    0     0                    -108336.0470 -113959.90  5.19%     -    0s
     0     0 -113453.53    0  119 -108336.05 -113453.53  4.72%     -    0s
     0     0 -113319.87    0  119 -108336.05 -113319.87  4.60%     -    0s
H    0     0                    -109115.5693 -113319.87  3.85%     -    0s
     0     0 -112850.59    0  121 -109115.57 -112850.59  3.42%     -    0s
H    0     0                    -109286.6933 -112847.63  3.26%     -    0s
     0     0 -112446.76    0  124 -109286.69 -112446.76  2.89%     -    0s
     0     0 -111997.73    0  126 -109286.69 -111997.73  2.48%     -    0s
H    0     0                    -109343.7664 -111981.93  2.41%     -    0s
     0     0 -111607.84    0  130 -109343.77 -111607.84  2.07%     -    0s
     0     0 -111179.69    0  105 -109343.77 -111179.69  1.68%     -    0s
     0     0 -111169.52    0  113 -109343.77 -111169.52  1.67%     -    0s
     0     0 -111157.52    0  118 -109343.77 -111157.52  1.66%     -    0s
     0     0 -111147.88    0  117 -109343.77 -111147.88  1.65%     -    0s
     0     0 -111146.59    0  117 -109343.77 -111146.59  1.65%     -    0s
     0     0 -110602.14    0  119 -109343.77 -110602.14  1.15%     -    0s
     0     0 -110227.01    0   58 -109343.77 -110227.01  0.81%     -    0s
     0     0 -110087.88    0   68 -109343.77 -110087.88  0.68%     -    0s
     0     0 -109964.57    0   81 -109343.77 -109964.57  0.57%     -    0s
     0     0 -109937.14    0   86 -109343.77 -109937.14  0.54%     -    0s
     0     0 -109920.45    0   86 -109343.77 -109920.45  0.53%     -    0s
     0     0 -109918.76    0   86 -109343.77 -109918.76  0.53%     -    0s
     0     0 -109558.03    0   30 -109343.77 -109558.03  0.20%     -    0s
     0     0 -109554.70    0   28 -109343.77 -109554.70  0.19%     -    0s
     0     0 -109516.96    0   27 -109343.77 -109516.96  0.16%     -    0s
     0     0 -109490.88    0   37 -109343.77 -109490.88  0.13%     -    0s
     0     0 -109485.06    0   33 -109343.77 -109485.06  0.13%     -    0s
     0     0 -109484.10    0   33 -109343.77 -109484.10  0.13%     -    0s
     0     0 -109463.47    0   18 -109343.77 -109463.47  0.11%     -    0s
     0     0 -109462.22    0   17 -109343.77 -109462.22  0.11%     -    0s
     0     0 -109422.20    0   10 -109343.77 -109422.20  0.07%     -    0s
     0     0 -109422.20    0   15 -109343.77 -109422.20  0.07%     -    0s
H    0     0                    -109356.4984 -109422.20  0.06%     -    0s
     0     0 -109406.46    0    7 -109356.50 -109406.46  0.05%     -    0s
H    0     0                    -109384.1719 -109402.87  0.02%     -    0s
     0     0 -109397.30    0    2 -109384.17 -109397.30  0.01%     -    0s
     0     0 -109393.05    0    5 -109384.17 -109393.05  0.01%     -    0s
H    0     0                    -109388.1272 -109393.05  0.00%     -    0s
     0     0 -109389.71    0    2 -109388.13 -109389.71  0.00%     -    0s
     0     0 -109389.71    0    3 -109388.13 -109389.71  0.00%     -    0s
     0     0 -109389.71    0    2 -109388.13 -109389.71  0.00%     -    0s
H    0     0                    -109389.3909 -109389.53  0.00%     -    0s
     0     0     cutoff    0      -109389.39 -109389.39  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 1

Explored 1 nodes (1489 simplex iterations) in 0.13 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109389 -109388 -109388 ... -108336
No other solutions better than -109389

Optimal solution found (tolerance 1.00e-06)
Best objective -1.093893909481e+05, best bound -1.093893909481e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 77363.79
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109389.39
  [DEBUG]   S×d_nominal = 186753.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186753.18 + -109389.39 = 77363.79
  [DEBUG]   Current θ from Master = 96047.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18683.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27541.87
  Lower Bound (LB) = -21923.51
  Gap (UB-LB) = 13065.1090, Absolute Gap = 13065.1090, Relative Gap = 1.474883
  Not converged yet (gap = 13065.11 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0xb05d50b8
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 8e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -27541.9 (0.05s)
MIP start from previous solve produced solution with objective -27541.9 (0.06s)
Loaded MIP start from previous solve with objective -27541.9

Presolve removed 27492 rows and 11162 columns
Presolve time: 0.56s
Presolved: 35051 rows, 16058 columns, 216579 nonzeros
Variable types: 13799 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35051 rows, 16058 columns, 216579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40639   -9.2148402e+03   0.000000e+00   1.660619e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.289500e+02, 23819 iterations, 5.76 seconds (11.87 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  328.94998    0  157 -27541.869  328.94998   101%     -    6s
H    0     0                    -27128.08486  328.94998   101%     -    6s
H    0     0                    -27114.46905  328.94998   101%     -    6s
H    0     0                    -25130.13993  328.94998   101%     -    6s
H    0     0                    -24798.52074  328.94998   101%     -    6s
H    0     0                    -24702.60124  328.94998   101%     -    6s
H    0     0                    -24682.16858  328.94998   101%     -    6s
H    0     0                    -24679.47482  328.94998   101%     -    6s
H    0     0                    -24674.71975  328.94998   101%     -    6s
H    0     0                    -24672.47789  328.94998   101%     -    6s
H    0     0                    -24663.90960  328.94998   101%     -    6s
     0     0 -2178.5485    0  184 -24663.910 -2178.5485  91.2%     -    9s
H    0     0                    -23517.05825 -2178.5485  90.7%     -   10s
H    0     0                    -23515.65076 -2178.5485  90.7%     -   10s
H    0     0                    -23468.07400 -2178.5485  90.7%     -   10s
H    0     0                    -22957.47967 -3237.4311  85.9%     -   12s
H    0     0                    -22819.17790 -3237.4311  85.8%     -   12s
H    0     0                    -22794.12334 -3237.4311  85.8%     -   12s
     0     0 -3384.7136    0  453 -22794.123 -3384.7136  85.2%     -   12s
H    0     0                    -22328.57228 -3546.0092  84.1%     -   13s
H    0     0                    -21644.69767 -3546.0092  83.6%     -   13s
H    0     0                    -21574.92779 -3546.0092  83.6%     -   13s
H    0     0                    -21565.20935 -3546.0092  83.6%     -   13s
H    0     0                    -21561.84997 -3546.0092  83.6%     -   13s
H    0     0                    -21559.59084 -3546.0092  83.6%     -   13s
     0     0 -3562.1362    0  473 -21559.591 -3562.1362  83.5%     -   14s
     0     0 -3563.2002    0  465 -21559.591 -3563.2002  83.5%     -   14s
     0     0 -5402.6606    0  202 -21559.591 -5402.6606  74.9%     -   17s
     0     0 -5609.2040    0  382 -21559.591 -5609.2040  74.0%     -   18s
     0     0 -5774.7636    0  464 -21559.591 -5774.7636  73.2%     -   20s
     0     0 -5917.4680    0  435 -21559.591 -5917.4680  72.6%     -   21s
     0     0 -5942.6593    0  395 -21559.591 -5942.6593  72.4%     -   21s
     0     0 -5950.6151    0  393 -21559.591 -5950.6151  72.4%     -   21s
     0     0 -5963.8290    0  446 -21559.591 -5963.8290  72.3%     -   22s
     0     0 -5965.8002    0  399 -21559.591 -5965.8002  72.3%     -   22s
     0     0 -5965.8296    0  399 -21559.591 -5965.8296  72.3%     -   22s
H    0     0                    -20822.72015 -6691.0422  67.9%     -   27s
H    0     0                    -20763.06837 -6691.0422  67.8%     -   27s
H    0     0                    -20708.45907 -6691.0422  67.7%     -   27s
H    0     0                    -20692.63587 -6691.0422  67.7%     -   27s
H    0     0                    -20692.18545 -6691.0422  67.7%     -   27s
H    0     0                    -20683.43529 -6691.0422  67.7%     -   27s
H    0     0                    -20671.22793 -6691.0422  67.6%     -   27s
H    0     0                    -20668.26250 -6691.0422  67.6%     -   27s
     0     0 -6691.0422    0  564 -20668.262 -6691.0422  67.6%     -   27s
H    0     0                    -20662.72890 -6693.3366  67.6%     -   27s
     0     0 -7135.6824    0  493 -20662.729 -7135.6824  65.5%     -   31s
     0     0 -7237.9218    0  568 -20662.729 -7237.9218  65.0%     -   32s
     0     0 -7282.8778    0  572 -20662.729 -7282.8778  64.8%     -   33s
     0     0 -7314.5214    0  573 -20662.729 -7314.5214  64.6%     -   33s
     0     0 -7328.9123    0  579 -20662.729 -7328.9123  64.5%     -   34s
     0     0 -7342.5794    0  583 -20662.729 -7342.5794  64.5%     -   34s
     0     0 -7343.0460    0  588 -20662.729 -7343.0460  64.5%     -   34s
H    0     0                    -20661.67998 -7343.0460  64.5%     -   37s
     0     0 -7796.0759    0  442 -20661.680 -7796.0759  62.3%     -   39s
     0     0 -8045.6227    0  449 -20661.680 -8045.6227  61.1%     -   42s
     0     0 -8209.7606    0  576 -20661.680 -8209.7606  60.3%     -   44s
     0     0 -8244.6870    0  527 -20661.680 -8244.6870  60.1%     -   45s
     0     0 -8251.6910    0  547 -20661.680 -8251.6910  60.1%     -   45s
     0     0 -8259.9624    0  550 -20661.680 -8259.9624  60.0%     -   46s
     0     0 -8261.7773    0  552 -20661.680 -8261.7773  60.0%     -   46s
     0     0 -8262.6905    0  555 -20661.680 -8262.6905  60.0%     -   46s
     0     0 -8427.3031    0  541 -20661.680 -8427.3031  59.2%     -   49s
H    0     0                    -20642.23143 -8427.3458  59.2%     -   50s
H    0     0                    -20637.89431 -8427.3458  59.2%     -   50s
     0     0 -8464.1744    0  559 -20637.894 -8464.1744  59.0%     -   51s
     0     0 -8480.9488    0  557 -20637.894 -8480.9488  58.9%     -   51s
     0     0 -8485.4145    0  546 -20637.894 -8485.4145  58.9%     -   51s
     0     0 -8487.9161    0  549 -20637.894 -8487.9161  58.9%     -   51s
     0     0 -8488.2076    0  543 -20637.894 -8488.2076  58.9%     -   52s
     0     0 -8620.3012    0  566 -20637.894 -8620.3012  58.2%     -   54s
     0     0 -8642.2165    0  631 -20637.894 -8642.2165  58.1%     -   55s
     0     0 -8651.9298    0  632 -20637.894 -8651.9298  58.1%     -   56s
     0     0 -8656.0169    0  590 -20637.894 -8656.0169  58.1%     -   56s
     0     0 -8658.1414    0  583 -20637.894 -8658.1414  58.0%     -   56s
     0     0 -8658.5422    0  586 -20637.894 -8658.5422  58.0%     -   56s
     0     0 -8705.3307    0  593 -20637.894 -8705.3307  57.8%     -   58s
     0     0 -8711.9494    0  563 -20637.894 -8711.9494  57.8%     -   59s
     0     0 -8716.2976    0  642 -20637.894 -8716.2976  57.8%     -   59s
     0     0 -8716.9909    0  574 -20637.894 -8716.9909  57.8%     -   59s
     0     0 -8759.8102    0  594 -20637.894 -8759.8102  57.6%     -   61s
     0     0 -8766.7308    0  614 -20637.894 -8766.7308  57.5%     -   61s
     0     0 -8771.0271    0  610 -20637.894 -8771.0271  57.5%     -   62s
     0     0 -8771.5595    0  661 -20637.894 -8771.5595  57.5%     -   62s
     0     0 -8805.4539    0  582 -20637.894 -8805.4539  57.3%     -   63s
     0     0 -8821.0743    0  544 -20637.894 -8821.0743  57.3%     -   65s
     0     0 -8826.6070    0  540 -20637.894 -8826.6070  57.2%     -   65s
     0     0 -8828.4130    0  545 -20637.894 -8828.4130  57.2%     -   65s
     0     0 -8829.2503    0  548 -20637.894 -8829.2503  57.2%     -   65s
     0     0 -8864.3936    0  549 -20637.894 -8864.3936  57.0%     -   67s
     0     0 -8870.0164    0  557 -20637.894 -8870.0164  57.0%     -   68s
     0     0 -8870.7265    0  551 -20637.894 -8870.7265  57.0%     -   68s
     0     0 -8889.6506    0  630 -20637.894 -8889.6506  56.9%     -   69s
     0     0 -8894.6175    0  640 -20637.894 -8894.6175  56.9%     -   70s
     0     0 -8897.3695    0  649 -20637.894 -8897.3695  56.9%     -   70s
     0     0 -8899.6154    0  646 -20637.894 -8899.6154  56.9%     -   71s
     0     0 -8899.8129    0  648 -20637.894 -8899.8129  56.9%     -   71s
     0     0 -8905.8422    0  643 -20637.894 -8905.8422  56.8%     -   72s
     0     0 -8907.5896    0  641 -20637.894 -8907.5896  56.8%     -   72s
     0     0 -8908.4422    0  649 -20637.894 -8908.4422  56.8%     -   73s
     0     0 -8912.2982    0  650 -20637.894 -8912.2982  56.8%     -   73s
     0     0 -8913.9558    0  640 -20637.894 -8913.9558  56.8%     -   74s
     0     0 -8914.6045    0  640 -20637.894 -8914.6045  56.8%     -   74s
     0     0 -8916.7111    0  645 -20637.894 -8916.7111  56.8%     -   75s
     0     0 -8917.4429    0  644 -20637.894 -8917.4429  56.8%     -   75s
     0     0 -8943.9483    0  592 -20637.894 -8943.9483  56.7%     -   77s
     0     0 -8962.5010    0  598 -20637.894 -8962.5010  56.6%     -   78s
     0     0 -8966.3977    0  596 -20637.894 -8966.3977  56.6%     -   78s
     0     0 -8967.0641    0  597 -20637.894 -8967.0641  56.6%     -   78s
     0     0 -8994.4459    0  671 -20637.894 -8994.4459  56.4%     -   79s
H    0     0                    -20637.38899 -8994.4991  56.4%     -   80s
     0     0 -9003.0388    0  684 -20637.389 -9003.0388  56.4%     -   80s
     0     0 -9004.3419    0  701 -20637.389 -9004.3419  56.4%     -   81s
     0     0 -9040.1552    0  698 -20637.389 -9040.1552  56.2%     -   82s
     0     0 -9047.8448    0  698 -20637.389 -9047.8448  56.2%     -   83s
     0     0 -9050.4335    0  696 -20637.389 -9050.4335  56.1%     -   83s
     0     0 -9051.3261    0  710 -20637.389 -9051.3261  56.1%     -   84s
     0     0 -9072.9765    0  700 -20637.389 -9072.9765  56.0%     -   85s
     0     0 -9084.8290    0  709 -20637.389 -9084.8290  56.0%     -   86s
     0     0 -9086.9630    0  710 -20637.389 -9086.9630  56.0%     -   86s
     0     0 -9088.1134    0  722 -20637.389 -9088.1134  56.0%     -   86s
     0     0 -9127.2399    0  712 -20637.389 -9127.2399  55.8%     -   88s
     0     0 -9131.0362    0  721 -20637.389 -9131.0362  55.8%     -   89s
     0     0 -9133.0795    0  726 -20637.389 -9133.0795  55.7%     -   89s
     0     0 -9134.0217    0  725 -20637.389 -9134.0217  55.7%     -   89s
     0     0 -9149.7585    0  711 -20637.389 -9149.7585  55.7%     -   91s
     0     0 -9153.0039    0  714 -20637.389 -9153.0039  55.6%     -   91s
     0     0 -9155.2577    0  711 -20637.389 -9155.2577  55.6%     -   91s
     0     0 -9156.7266    0  709 -20637.389 -9156.7266  55.6%     -   92s
     0     0 -9157.2050    0  713 -20637.389 -9157.2050  55.6%     -   92s
     0     0 -9169.6905    0  641 -20637.389 -9169.6905  55.6%     -   93s
     0     0 -9173.1041    0  651 -20637.389 -9173.1041  55.6%     -   93s
     0     0 -9174.1659    0  652 -20637.389 -9174.1659  55.5%     -   94s
     0     0 -9182.4975    0  631 -20637.389 -9182.4975  55.5%     -   95s
     0     0 -9184.9314    0  644 -20637.389 -9184.9314  55.5%     -   95s
     0     0 -9185.6678    0  647 -20637.389 -9185.6678  55.5%     -   95s
     0     0 -9194.3148    0  642 -20637.389 -9194.3148  55.4%     -   96s
     0     0 -9194.3852    0  642 -20637.389 -9194.3852  55.4%     -   97s
H    0     0                    -20547.57540 -9194.8502  55.3%     -  109s
H    0     0                    -20514.90106 -9194.8502  55.2%     -  109s
H    0     2                    -20512.97874 -9194.8502  55.2%     -  110s
     0     2 -9194.8502    0  642 -20512.979 -9194.8502  55.2%     -  110s
     7    16 -9718.6500    3  567 -20512.979 -9302.2945  54.7%  1694  115s
H   31    64                    -20492.30612 -9457.8732  53.8%  3005  120s
H   33    64                    -20489.13455 -9457.8732  53.8%  2943  120s
H   37    64                    -20480.88971 -9457.8732  53.8%  2778  120s
H   42    64                    -20479.62609 -9457.8732  53.8%  2620  120s
H   45    64                    -20474.77299 -9457.8732  53.8%  2561  120s
    63    96 -10543.706    6  550 -20474.773 -9653.1509  52.9%  2407  126s
    95   150 -11240.691    7  604 -20474.773 -9653.5885  52.9%  2598  131s
   149   223 -11501.089    8  585 -20474.773 -9653.5885  52.9%  2569  137s
   222   293 -11720.466    9  585 -20474.773 -9653.5885  52.9%  2369  141s
H  248   293                    -20092.96274 -9653.5885  52.0%  2351  141s
   292   362 -12244.721    9  484 -20092.963 -9653.5885  52.0%  2183  147s
H  372   431                    -20047.73898 -9653.5885  51.8%  1982  152s
H  374   431                    -20039.47355 -9653.5885  51.8%  1999  152s
H  443   431                    -20009.56597 -9677.0601  51.6%  1865  152s
   456   492 -15757.425   11  335 -20009.566 -9677.0601  51.6%  1864  157s
   540   542 -12068.383   11  631 -20009.566 -9677.0601  51.6%  1764  160s
H  544   542                    -19976.89163 -9677.0601  51.6%  1777  160s
H  546   542                    -19843.90915 -9677.0601  51.2%  1775  160s
H  550   542                    -19833.79887 -9677.0601  51.2%  1784  160s
H  578   542                    -19831.25635 -9677.0601  51.2%  1773  160s
   658   591 -11875.213   14  409 -19831.256 -9677.0601  51.2%  1714  170s
H  674   591                    -19823.83445 -9677.0601  51.2%  1735  170s
H  676   591                    -19818.56434 -9678.4513  51.2%  1731  170s
H  681   591                    -19817.13510 -9678.4513  51.2%  1725  170s
   764   694 -12887.052   14  574 -19817.135 -9680.8403  51.1%  1689  177s
H  769   694                    -19816.86127 -9680.8403  51.1%  1687  177s
H  771   694                    -19804.53528 -9680.8403  51.1%  1686  177s
   820   765 -13050.124   15  490 -19804.535 -9680.8403  51.1%  1652  182s
H  934   810                    -19802.05747 -9715.5692  50.9%  1580  184s
   981   895 -14546.717   16  538 -19802.057 -9715.5692  50.9%  1552  188s
  1074   928 -19684.573   16  326 -19802.057 -9715.5692  50.9%  1511  192s
  1119   986 -14958.604   17  467 -19802.057 -9715.5692  50.9%  1487  195s
  1251  1147 -17447.101   20  337 -19802.057 -9715.5692  50.9%  1451  204s
  1371  1181     cutoff   21      -19802.057 -9715.5692  50.9%  1387  207s
H 1413  1181                    -18986.70969 -9814.1100  48.3%  1377  207s
  1576  1482 -17826.108   22  310 -18986.710 -9814.1100  48.3%  1301  214s
  1783  1704 -18251.591   25  361 -18986.710 -9814.1100  48.3%  1212  219s
  2043  1966 -16918.668    9  222 -18986.710 -9836.5701  48.2%  1110  223s
  2334  2172 -18383.314   20  104 -18986.710 -9844.1077  48.2%  1011  229s
H 2687  2265                    -18868.33233 -9844.1077  47.8%   906  233s
H 2730  2227                    -18430.57126 -9868.8983  46.5%   898  233s
* 2731  2203              95    -18296.14226 -9868.8983  46.1%   897  233s
H 2822  2196                    -18222.13221 -9868.8983  45.8%   879  233s
* 2912  2190              67    -18170.27200 -9868.8983  45.7%   862  233s
H 2999  2180                    -18074.30837 -9868.8983  45.4%   848  233s
* 3000  2176              92    -18037.61856 -9868.8983  45.3%   848  233s
  3006  2176 -12518.296    8  307 -18037.619 -9868.8983  45.3%   849  238s
H 3011  2059                    -17193.87082 -9868.8983  42.6%   850  238s
H 3062  2029                    -17044.70838 -9891.6864  42.0%   853  238s
  3082  2034 -13202.273    8  460 -17044.708 -9891.6864  42.0%   856  243s
  3175  2085 -14833.701    9  329 -17044.708 -9891.6864  42.0%   876  248s
  3272  2155 -15016.519   10  547 -17044.708 -9964.9549  41.5%   887  255s
  3396  2225 -15100.658   10  269 -17044.708 -9964.9549  41.5%   889  261s
  3525  2262     cutoff   10      -17044.708 -10005.579  41.3%   896  267s
  3662  2330 -15421.762   12  350 -17044.708 -10005.579  41.3%   902  273s
  3864  2350 infeasible   15      -17044.708 -10054.002  41.0%   895  278s
H 3868  2286                    -16831.30262 -10054.002  40.3%   895  278s
H 3872  2283                    -16813.42691 -10054.002  40.2%   896  278s
  3917  2307 -10722.182    8  469 -16813.427 -10111.070  39.9%   898  282s
  4001  2316 -10799.577    9  389 -16813.427 -10111.070  39.9%   894  287s
  4052  2352 -10849.829   10  376 -16813.427 -10123.251  39.8%   897  293s
  4151  2396 -11795.347   13  271 -16813.427 -10168.741  39.5%   902  299s
  4267  2422 -14169.255   18  249 -16813.427 -10170.204  39.5%   904  305s
  4409  2470 -15443.931    9  341 -16813.427 -10171.326  39.5%   906  310s
  4508  2507 -15966.664   10  316 -16813.427 -10229.360  39.2%   909  317s
  4629  2534     cutoff   13      -16813.427 -10232.299  39.1%   911  323s
  4749  2566     cutoff   11      -16813.427 -10247.799  39.0%   914  328s
  4861  2615 -11548.627   11  476 -16813.427 -10247.799  39.0%   917  334s
  5033  2643 -12477.422   15  310 -16813.427 -10287.280  38.8%   916  341s
  5144  2691 -14721.024   18  300 -16813.427 -10291.127  38.8%   920  347s
  5332  2759 -11773.055   15  494 -16813.427 -10310.118  38.7%   924  352s
  5491  2812 -12355.838   18  303 -16813.427 -10335.158  38.5%   933  361s
  5753  2876 -15881.793   24  265 -16813.427 -10349.622  38.4%   935  371s
  5957  2968 -16319.665   12  342 -16813.427 -10389.891  38.2%   951  377s
  6209  2969 -15785.873   46  642 -16813.427 -10389.891  38.2%   955  405s
  6211  2970 -10592.089    8  157 -16813.427 -10389.891  38.2%   955  414s
  6212  2971 -14876.280   69  499 -16813.427 -10389.891  38.2%   955  422s
  6213  2972 -11543.423   21  592 -16813.427 -10389.891  38.2%   955  427s
  6214  2972 -12649.791   12  472 -16813.427 -10389.891  38.2%   954  432s
  6215  2973 -15468.938   21  614 -16813.427 -10389.891  38.2%   954  435s
  6217  2974 -12417.420   14  633 -16813.427 -10389.891  38.2%   954  441s
  6220  2976 -13224.495   15  605 -16813.427 -10389.891  38.2%   954  445s
  6225  2980 -14429.330   55  641 -16813.427 -10389.891  38.2%   953  450s
  6226  2980 -10708.363   14  615 -16813.427 -10389.891  38.2%   953  455s
  6231  2984 -11516.133   20  633 -16813.427 -10389.891  38.2%   952  463s
  6233  2985 -15972.301   56  684 -16813.427 -10389.891  38.2%   952  466s
  6236  2987 -15490.501   28  620 -16813.427 -10389.891  38.2%   951  472s
  6238  2988 -12493.817   27  657 -16813.427 -10389.891  38.2%   951  475s
  6240  2990 -16213.357   55  635 -16813.427 -10389.891  38.2%   950  480s
  6243  2992 -13393.575   17  550 -16813.427 -10389.891  38.2%   950  486s
  6245  2993 -12520.271   16  638 -16813.427 -10389.891  38.2%   950  491s
  6248  2995 -14422.932   61  644 -16813.427 -10389.891  38.2%   949  497s
  6250  2996 -14370.325   51  619 -16813.427 -10389.891  38.2%   949  501s
  6252  2998 -13017.889   15  623 -16813.427 -10389.891  38.2%   949  506s
  6253  2998 -12486.603   26  623 -16813.427 -10389.891  38.2%   948  519s
  6254  2999 -15866.023   20  623 -16813.427 -10389.891  38.2%   948  530s
  6255  3003 -10389.891   14  702 -16813.427 -10389.891  38.2%   967  537s
  6257  3006 -10389.891   15  630 -16813.427 -10389.891  38.2%   968  540s
  6261  3013 -10389.891   16  694 -16813.427 -10389.891  38.2%   969  545s
  6269  3020 -10389.891   17  700 -16813.427 -10389.891  38.2%   971  551s
  6285  3035 -11030.814   18  637 -16813.427 -10389.891  38.2%   985  557s
  6311  3055 -11108.488   19  638 -16813.427 -10389.891  38.2%   997  568s
  6342  3063 -13423.787   20  316 -16813.427 -10829.881  35.6%  1021  577s
  6365  3094     cutoff   21      -16813.427 -10936.421  35.0%  1043  587s
  6441  3131 -11240.381   21  619 -16813.427 -10936.421  35.0%  1082  597s
  6530  3157 -12122.378   23  438 -16813.427 -10936.421  35.0%  1099  606s
  6624  3180 -12284.508   25  361 -16813.427 -10975.949  34.7%  1104  612s
  6727  3179 -13004.533   27  309 -16813.427 -11055.731  34.2%  1103  619s
  6818  3163 -13030.148   28  310 -16813.427 -11142.091  33.7%  1105  627s
  6900  3146 -13701.642   31  321 -16813.427 -11241.940  33.1%  1107  635s
  6983  3130 -14605.561   33  242 -16813.427 -11287.348  32.9%  1110  641s
  7028  3128 -14922.857   34  294 -16813.427 -11287.348  32.9%  1114  649s
  7104  3102     cutoff   38      -16813.427 -11446.182  31.9%  1115  654s
  7176  3087 -13142.521   26  532 -16813.427 -11446.182  31.9%  1115  660s
  7303  3050 -13665.605   28  412 -16813.427 -11446.182  31.9%  1124  671s
  7398  3021 -13927.625   31  299 -16813.427 -12075.397  28.2%  1125  677s
  7467  3004 -14519.102   32  285 -16813.427 -12120.486  27.9%  1128  684s
  7580  2968     cutoff   34      -16813.427 -12120.486  27.9%  1132  691s
  7694  2918     cutoff   24      -16813.427 -12631.118  24.9%  1133  699s
  7816  2867 -15694.986   23  376 -16813.427 -12631.203  24.9%  1133  706s
  7944  2816 -16755.776   25  508 -16813.427 -12817.729  23.8%  1136  713s
  8089  2752     cutoff   26      -16813.427 -13033.377  22.5%  1135  718s
  8249  2674 -16382.243   26  480 -16813.427 -13305.073  20.9%  1133  724s
  8404  2592     cutoff   27      -16813.427 -13575.235  19.3%  1134  731s
  8511  2536 -15132.150   26  461 -16813.427 -13839.213  17.7%  1136  739s
  8653  2438 -16096.862   29  283 -16813.427 -13839.213  17.7%  1135  746s
  8822  2319 infeasible   27      -16813.427 -14177.884  15.7%  1136  752s
  9003  2211 infeasible   24      -16813.427 -14242.806  15.3%  1131  759s
  9164  2084     cutoff   30      -16813.427 -14242.806  15.3%  1126  764s
  9325  1992     cutoff   27      -16813.427 -14242.806  15.3%  1119  768s
  9375  1969     cutoff   30      -16813.427 -15605.189  7.19%  1116  772s
  9395  1955     cutoff   31      -16813.427 -16165.783  3.85%  1115  775s

Cutting planes:
  MIR: 353
  Mixing: 1
  Flow cover: 1641
  RLT: 14
  Relax-and-lift: 113

Explored 9427 nodes (10621352 simplex iterations) in 777.82 seconds (2013.46 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -16813.4 -16831.3 -17044.7 ... -18986.7
No other solutions better than -16813.4

Optimal solution found (tolerance 1.00e-06)
Best objective -1.681342691090e+04, best bound -1.681342691090e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 777.83s
  Master Objective (UB) = -16813.43, θ = 87753.30
  Upper Bound (UB) = -16813.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87753.30
  [DEBUG]   ✓ Scenario 0: θ = 87753.30 ≤ Q = 87753.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87753.30 ≤ Q = 87753.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87753.30 ≤ Q = 87753.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87753.30 ≤ Q = 87753.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1327616b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xecd89e95
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.422299e+13
Presolve removed 2598 rows and 1977 columns
Presolve time: 0.00s
Presolved: 495 rows, 412 columns, 1312 nonzeros
Found heuristic solution: objective -55196.39421
Variable types: 248 continuous, 164 integer (164 binary)

Root relaxation: objective -1.139799e+05, 270 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113979.86    0  123 -55196.394 -113979.86   106%     -    0s
H    0     0                    -80158.87283 -113979.86  42.2%     -    0s
H    0     0                    -81112.66044 -113979.86  40.5%     -    0s
     0     0 -90076.393    0   65 -81112.660 -90076.393  11.1%     -    0s
H    0     0                    -86565.77120 -90000.424  3.97%     -    0s
H    0     0                    -86901.15301 -90000.424  3.57%     -    0s
H    0     0                    -86907.85639 -90000.424  3.56%     -    0s
H    0     0                    -87243.23820 -90000.424  3.16%     -    0s
     0     0 -89698.444    0   65 -87243.238 -89698.444  2.81%     -    0s
     0     0 -89616.083    0   62 -87243.238 -89616.083  2.72%     -    0s
     0     0 -89312.122    0   61 -87243.238 -89312.122  2.37%     -    0s
     0     0 -88795.267    0   43 -87243.238 -88795.267  1.78%     -    0s
     0     0 -88746.393    0   44 -87243.238 -88746.393  1.72%     -    0s
     0     0 -88738.141    0   45 -87243.238 -88738.141  1.71%     -    0s
     0     0 -88448.293    0   45 -87243.238 -88448.293  1.38%     -    0s
H    0     0                    -87256.43260 -88411.605  1.32%     -    0s
H    0     0                    -87389.39393 -88317.692  1.06%     -    0s
     0     0 -88317.692    0   33 -87389.394 -88317.692  1.06%     -    0s
     0     0 -88303.451    0   33 -87389.394 -88303.451  1.05%     -    0s
     0     0 -88123.216    0   36 -87389.394 -88123.216  0.84%     -    0s
     0     0 -88083.664    0   31 -87389.394 -88083.664  0.79%     -    0s
     0     0 -88079.611    0   31 -87389.394 -88079.611  0.79%     -    0s
     0     0 -87940.128    0   36 -87389.394 -87940.128  0.63%     -    0s
     0     0 -87886.340    0   36 -87389.394 -87886.340  0.57%     -    0s
     0     0 -87852.775    0   33 -87389.394 -87852.775  0.53%     -    0s
     0     0 -87836.243    0   37 -87389.394 -87836.243  0.51%     -    0s
     0     0 -87594.203    0   41 -87389.394 -87594.203  0.23%     -    0s
     0     0 -87567.548    0   20 -87389.394 -87567.548  0.20%     -    0s
     0     0 -87562.838    0   19 -87389.394 -87562.838  0.20%     -    0s
     0     0 -87522.715    0   18 -87389.394 -87522.715  0.15%     -    0s
     0     0 -87522.715    0   23 -87389.394 -87522.715  0.15%     -    0s
     0     0 -87485.174    0    6 -87389.394 -87485.174  0.11%     -    0s
     0     0 -87485.174    0   18 -87402.495 -87485.174  0.09%     -    0s
H    0     0                    -87420.45159 -87485.174  0.07%     -    0s
     0     0 -87485.174    0   10 -87420.452 -87485.174  0.07%     -    0s
H    0     0                    -87431.63894 -87480.721  0.06%     -    0s
H    0     0                    -87447.61311 -87470.876  0.03%     -    0s
     0     0 -87470.876    0    4 -87447.613 -87470.876  0.03%     -    0s
     0     0 -87469.638    0    2 -87447.613 -87469.638  0.03%     -    0s
     0     0 -87469.638    0    6 -87447.613 -87469.638  0.03%     -    0s
H    0     0                    -87469.40241 -87469.638  0.00%     -    0s
     0     0 -87469.638    0    2 -87469.402 -87469.638  0.00%     -    0s
     0     0 -87469.411    0    1 -87469.402 -87469.411  0.00%     -    0s

Explored 1 nodes (1212 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -87469.4 -87468.9 -87447.6 ... -86907.9

Optimal solution found (tolerance 1.00e-06)
Best objective -8.746940240990e+04, best bound -8.746941071178e+04, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 84706.55
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -87469.40
  [DEBUG]   S×d_nominal = 172175.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 172175.95 + -87469.40 = 84706.55
  [DEBUG]   Current θ from Master = 87753.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3046.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19860.18
  Lower Bound (LB) = -19860.18
  Gap (UB-LB) = 3046.7555, Absolute Gap = 3046.7555, Relative Gap = 0.181210
  Not converged yet (gap = 3046.76 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0xf5ce12ee
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [3e-01, 8e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34360 rows and 13950 columns
Presolve time: 0.71s
Presolved: 43473 rows, 19510 columns, 269359 nonzeros
Variable types: 17251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -378117.7382
Found heuristic solution: objective -214575.9106

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43473 rows, 19510 columns, 269359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30476   -1.5052970e+04   0.000000e+00   3.969805e+06      5s
   40957   -6.4500072e+03   0.000000e+00   1.041225e+07     10s
   49431   -5.4156346e+03   0.000000e+00   3.869307e+06     15s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.088973e+02, 34168 iterations, 14.18 seconds (27.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0  308.89734    0  165 -214575.91  308.89734   100%     -   15s
H    0     0                    -207236.1287  308.89734   100%     -   15s
H    0     0                    -158545.8614  308.89734   100%     -   15s
H    0     0                    -158415.9891  308.89734   100%     -   15s
H    0     0                    -65047.78605  308.89734   100%     -   15s
H    0     0                    -64775.46742  308.89734   100%     -   15s
H    0     0                    -50889.37994  308.89734   101%     -   15s
H    0     0                    -50834.24494  308.89734   101%     -   15s
H    0     0                    -48859.12581  308.89734   101%     -   15s
H    0     0                    -21730.39477  308.89734   101%     -   15s
H    0     0                    -21591.05234 -3183.9432  85.3%     -   23s
H    0     0                    -21587.22352 -3183.9432  85.3%     -   23s
     0     0 -3568.5656    0  439 -21587.224 -3568.5656  83.5%     -   23s
     0     0 -3657.6631    0  451 -21587.224 -3657.6631  83.1%     -   27s
     0     0 -3657.6631    0  466 -21587.224 -3657.6631  83.1%     -   28s
     0     0 -3657.6631    0  392 -21587.224 -3657.6631  83.1%     -   28s
     0     0 -3657.6631    0  392 -21587.224 -3657.6631  83.1%     -   28s
H    0     0                    -21511.75519 -5311.8978  75.3%     -   33s
     0     0 -5311.8978    0  275 -21511.755 -5311.8978  75.3%     -   33s
H    0     0                    -21454.37911 -5311.9272  75.2%     -   34s
     0     0 -5400.1184    0  281 -21454.379 -5400.1184  74.8%     -   36s
     0     0 -5423.6622    0  291 -21454.379 -5423.6622  74.7%     -   37s
     0     0 -5702.2722    0  274 -21454.379 -5702.2722  73.4%     -   39s
H    0     0                    -21428.76230 -5729.4393  73.3%     -   40s
     0     0 -5729.4393    0  281 -21428.762 -5729.4393  73.3%     -   40s
     0     0 -5740.5148    0  290 -21428.762 -5740.5148  73.2%     -   41s
     0     0 -5742.0968    0  296 -21428.762 -5742.0968  73.2%     -   41s
     0     0 -5742.1408    0  296 -21428.762 -5742.1408  73.2%     -   41s
H    0     0                    -21419.10702 -5742.1408  73.2%     -   44s
H    0     0                    -20696.07499 -6716.8001  67.5%     -   49s
H    0     0                    -20686.90833 -6716.8001  67.5%     -   49s
     0     0 -6716.8001    0  457 -20686.908 -6716.8001  67.5%     -   49s
H    0     0                    -20567.47043 -6717.4730  67.3%     -   49s
H    0     0                    -20549.55195 -6717.4730  67.3%     -   49s
H    0     0                    -20527.65831 -7057.2683  65.6%     -   53s
H    0     0                    -20479.76023 -7057.2683  65.5%     -   53s
H    0     0                    -20476.67070 -7057.2683  65.5%     -   53s
     0     0 -7057.2683    0  348 -20476.671 -7057.2683  65.5%     -   53s
     0     0 -7241.7069    0  425 -20476.671 -7241.7069  64.6%     -   55s
     0     0 -7355.8969    0  458 -20476.671 -7355.8969  64.1%     -   57s
     0     0 -7412.3843    0  501 -20476.671 -7412.3843  63.8%     -   58s
     0     0 -7420.2958    0  512 -20476.671 -7420.2958  63.8%     -   59s
     0     0 -7421.7963    0  515 -20476.671 -7421.7963  63.8%     -   59s
     0     0 -7423.0484    0  458 -20476.671 -7423.0484  63.7%     -   59s
     0     0 -7423.3362    0  460 -20476.671 -7423.3362  63.7%     -   59s
     0     0 -7902.9867    0  489 -20476.671 -7902.9867  61.4%     -   69s
     0     0 -8057.4131    0  492 -20476.671 -8057.4131  60.7%     -   74s
     0     0 -8086.2216    0  502 -20476.671 -8086.2216  60.5%     -   75s
     0     0 -8109.6159    0  564 -20476.671 -8109.6159  60.4%     -   76s
     0     0 -8151.4726    0  505 -20476.671 -8151.4726  60.2%     -   77s
     0     0 -8156.1947    0  569 -20476.671 -8156.1947  60.2%     -   78s
     0     0 -8160.0217    0  573 -20476.671 -8160.0217  60.1%     -   78s
     0     0 -8161.3432    0  567 -20476.671 -8161.3432  60.1%     -   78s
     0     0 -8162.6215    0  574 -20476.671 -8162.6215  60.1%     -   79s
     0     0 -8163.5807    0  567 -20476.671 -8163.5807  60.1%     -   79s
     0     0 -8368.2597    0  501 -20476.671 -8368.2597  59.1%     -   83s
H    0     0                    -20443.39684 -8368.4794  59.1%     -   83s
H    0     0                    -20384.73903 -8368.4794  58.9%     -   83s
     0     0 -8406.6376    0  573 -20384.739 -8406.6376  58.8%     -   85s
     0     0 -8416.0300    0  508 -20384.739 -8416.0300  58.7%     -   86s
     0     0 -8418.8163    0  516 -20384.739 -8418.8163  58.7%     -   86s
     0     0 -8419.4147    0  515 -20384.739 -8419.4147  58.7%     -   87s
     0     0 -8483.6099    0  620 -20384.739 -8483.6099  58.4%     -   90s
     0     0 -8507.6560    0  634 -20384.739 -8507.6560  58.3%     -   93s
     0     0 -8518.6230    0  643 -20384.739 -8518.6230  58.2%     -   94s
     0     0 -8523.2736    0  635 -20384.739 -8523.2736  58.2%     -   95s
     0     0 -8524.2939    0  645 -20384.739 -8524.2939  58.2%     -   95s
     0     0 -8598.8399    0  602 -20384.739 -8598.8399  57.8%     -   99s
     0     0 -8610.5639    0  609 -20384.739 -8610.5639  57.8%     -  100s
     0     0 -8617.9718    0  618 -20384.739 -8617.9718  57.7%     -  101s
     0     0 -8622.5030    0  560 -20384.739 -8622.5030  57.7%     -  101s
     0     0 -8625.6351    0  564 -20384.739 -8625.6351  57.7%     -  102s
     0     0 -8627.4037    0  561 -20384.739 -8627.4037  57.7%     -  102s
     0     0 -8628.3971    0  564 -20384.739 -8628.3971  57.7%     -  102s
     0     0 -8701.4840    0  556 -20384.739 -8701.4840  57.3%     -  105s
H    0     0                    -20382.79077 -8701.6645  57.3%     -  105s
H    0     0                    -20382.14129 -8701.6645  57.3%     -  105s
     0     0 -8715.2970    0  552 -20382.141 -8715.2970  57.2%     -  106s
     0     0 -8720.0122    0  552 -20382.141 -8720.0122  57.2%     -  107s
     0     0 -8720.9909    0  559 -20382.141 -8720.9909  57.2%     -  108s
     0     0 -8742.7082    0  553 -20382.141 -8742.7082  57.1%     -  110s
     0     0 -8750.9041    0  539 -20382.141 -8750.9041  57.1%     -  111s
     0     0 -8754.1364    0  552 -20382.141 -8754.1364  57.0%     -  112s
     0     0 -8755.4080    0  550 -20382.141 -8755.4080  57.0%     -  112s
     0     0 -8755.6665    0  553 -20382.141 -8755.6665  57.0%     -  112s
     0     0 -8768.7958    0  554 -20382.141 -8768.7958  57.0%     -  114s
     0     0 -8776.5570    0  566 -20382.141 -8776.5570  56.9%     -  116s
     0     0 -8777.0771    0  565 -20382.141 -8777.0771  56.9%     -  116s
     0     0 -8801.5216    0  613 -20382.141 -8801.5216  56.8%     -  119s
     0     0 -8810.6954    0  635 -20382.141 -8810.6954  56.8%     -  121s
     0     0 -8815.2072    0  557 -20382.141 -8815.2072  56.8%     -  122s
     0     0 -8816.4493    0  571 -20382.141 -8816.4493  56.7%     -  122s
     0     0 -8827.6762    0  573 -20382.141 -8827.6762  56.7%     -  124s
     0     0 -8833.6542    0  564 -20382.141 -8833.6542  56.7%     -  125s
     0     0 -8837.1342    0  560 -20382.141 -8837.1342  56.6%     -  125s
     0     0 -8837.6277    0  562 -20382.141 -8837.6277  56.6%     -  126s
     0     0 -8855.0491    0  598 -20382.141 -8855.0491  56.6%     -  128s
     0     0 -8855.8589    0  557 -20382.141 -8855.8589  56.6%     -  128s
     0     0 -8861.9462    0  612 -20382.141 -8861.9462  56.5%     -  130s
     0     0 -8864.1020    0  625 -20382.141 -8864.1020  56.5%     -  148s
     0     0 -8865.8742    0  619 -20382.141 -8865.8742  56.5%     -  149s
     0     0 -8866.2423    0  628 -20382.141 -8866.2423  56.5%     -  149s
     0     0 -8868.2818    0  623 -20382.141 -8868.2818  56.5%     -  150s
     0     0 -8868.9190    0  563 -20382.141 -8868.9190  56.5%     -  151s
     0     0 -8870.2164    0  627 -20382.141 -8870.2164  56.5%     -  152s
     0     0 -8870.2165    0  627 -20382.141 -8870.2165  56.5%     -  153s
     0     2 -8870.2165    0  627 -20382.141 -8870.2165  56.5%     -  169s
     1     4 -9095.1442    1  527 -20382.141 -8870.2165  56.5%  4715  173s
     3     8 -9121.6042    2  533 -20382.141 -8923.4388  56.2%  2606  175s
     7    15 -9011.0216    3  599 -20382.141 -8990.8381  55.9%  2050  182s
    14    30 -9518.1953    4  586 -20382.141 -9013.6235  55.8%  3233  189s
    29    60 -9806.6566    5  568 -20382.141 -9267.1442  54.5%  5413  197s
    59    71 -10139.353    6  497 -20382.141 -9764.4837  52.1%  4924  210s
    70   125 -9974.8186    7  411 -20382.141 -9764.4837  52.1%  5360  221s
   124   236 -10028.371   10  482 -20382.141 -9897.3092  51.4%  4446  231s
   235   315 -16823.735   14  306 -20382.141 -9897.3092  51.4%  3858  237s
   325   398 -17612.543   19  250 -20382.141 -9897.3092  51.4%  3562  243s
   430   458 -17819.158   23  225 -20382.141 -9897.3092  51.4%  3138  249s
   528   505 -18096.311   26  185 -20382.141 -9932.4719  51.3%  2880  256s
H  618   543                    -20373.71482 -9932.4719  51.2%  2749  262s
H  661   543                    -20350.79712 -9932.4719  51.2%  2729  262s
   680   566 -19835.625   32  223 -20350.797 -9932.4719  51.2%  2704  266s
   724   588 -20086.465   33  235 -20350.797 -9946.7554  51.1%  2747  271s
   774   613 -20092.367   34  149 -20350.797 -9946.7554  51.1%  2792  278s
   811   637     cutoff   35      -20350.797 -9946.7554  51.1%  2850  281s
   867   665 -11496.506    8  322 -20350.797 -9946.7554  51.1%  2851  285s
   931   703 -11548.377    9  314 -20350.797 -9946.7554  51.1%  2827  292s
   987   755 -11577.681   10  317 -20350.797 -9946.7554  51.1%  2831  297s
  1061   813 -11652.797   12  253 -20350.797 -9946.7554  51.1%  2819  300s
  1227   966 -12694.068   18  219 -20350.797 -9946.7554  51.1%  2746  310s
  1332  1013     cutoff   17      -20350.797 -9946.7554  51.1%  2676  316s
  1387  1077 -19636.207   18  117 -20350.797 -9974.8349  51.0%  2668  320s
  1467  1142 -14033.597   23  279 -20350.797 -9974.8349  51.0%  2625  327s
  1562  1277 -14231.044   24  194 -20350.797 -9974.8349  51.0%  2574  333s
  1715  1479 -14534.809   26  305 -20350.797 -9974.8349  51.0%  2452  340s
  1937  1716 -15532.073   31  184 -20350.797 -9974.8349  51.0%  2266  345s
H 1999  1716                    -18165.08097 -9974.8349  45.1%  2204  345s
H 2140  1716                    -17614.10751 -9974.8349  43.4%  2092  345s
H 2141  1716                    -17572.45772 -9974.8349  43.2%  2091  345s
  2229  1784 -15547.265   36  238 -17572.458 -9974.8349  43.2%  2042  351s
  2456  1820 -16554.082   45  213 -17572.458 -10014.485  43.0%  1936  358s
H 2626  1814                    -17289.72269 -10022.292  42.0%  1905  365s
H 2667  1814                    -17132.00127 -10022.292  41.5%  1922  365s
  2774  1813 -15099.088   18  430 -17132.001 -10022.292  41.5%  1907  372s
  2904  1758 -15340.295   19  402 -17132.001 -10022.292  41.5%  1926  376s
H 2947  1758                    -16964.05019 -10022.292  40.9%  1937  376s
  2948  1816 -16949.587   20  299 -16964.050 -10022.292  40.9%  1939  384s
H 2972  1816                    -16864.82091 -10022.292  40.6%  1939  384s
  3102  1744 -16637.610   21  333 -16864.821 -10022.292  40.6%  1934  390s
  3151  1765 -16739.577   22  321 -16864.821 -10036.899  40.5%  1943  395s
  3193  1794     cutoff   23      -16864.821 -10129.114  39.9%  1963  403s
  3276  1852     cutoff   25      -16864.821 -10177.964  39.6%  1954  410s
  3429  1943 -15098.881   10  258 -16864.821 -10177.964  39.6%  1933  415s
  3658  2002 -16193.387   12  241 -16864.821 -10177.964  39.6%  1890  423s
  3872  2080 -10644.655   10  474 -16864.821 -10177.964  39.6%  1888  432s
  4068  2176 -11959.247   12  340 -16864.821 -10202.577  39.5%  1893  441s
  4251  2291 -12338.100   14  387 -16864.821 -10239.540  39.3%  1906  449s
  4431  2292 -12836.196   27  627 -16864.821 -10280.008  39.0%  1923  483s
  4433  2293 -14802.535   42  165 -16864.821 -10280.008  39.0%  1922  499s
  4434  2294 -13754.273   19  409 -16864.821 -10280.008  39.0%  1922  510s
  4435  2295 -11727.252   12  576 -16864.821 -10280.008  39.0%  1921  518s
  4436  2295 -14374.960   19  527 -16864.821 -10280.008  39.0%  1921  524s
  4437  2296 -11700.238   15  536 -16864.821 -10280.008  39.0%  1920  529s
  4438  2297 -12284.896   11  552 -16864.821 -10280.008  39.0%  1920  532s
  4439  2297 -13484.783   15  634 -16864.821 -10280.008  39.0%  1920  535s
  4441  2299 -14786.118   30  585 -16864.821 -10280.008  39.0%  1919  541s
  4443  2300 -13650.286   31  611 -16864.821 -10280.008  39.0%  1918  545s
  4446  2302 -14328.111   44  666 -16864.821 -10280.008  39.0%  1916  557s
  4448  2303 -13529.591   21  618 -16864.821 -10280.008  39.0%  1916  561s
  4450  2305 -14550.675   21  698 -16864.821 -10280.008  39.0%  1915  565s
  4451  2305 -13369.228   20  556 -16864.821 -10280.008  39.0%  1914  571s
  4453  2307 -14777.302   34  537 -16864.821 -10280.008  39.0%  1913  575s
  4455  2308 -12286.035   15  609 -16864.821 -10280.008  39.0%  1913  581s
  4457  2309 -10885.525    6  612 -16864.821 -10280.008  39.0%  1912  585s
  4458  2310 -15622.030   43  611 -16864.821 -10280.008  39.0%  1911  590s
  4461  2312 -13303.628   21  673 -16864.821 -10280.008  39.0%  1910  598s
  4462  2313 -11890.301   12  673 -16864.821 -10280.008  39.0%  1910  601s
  4463  2313 -12162.734   11  617 -16864.821 -10280.008  39.0%  1909  605s
  4465  2315 -13820.166   22  618 -16864.821 -10280.008  39.0%  1908  611s
  4467  2316 -16033.701   59  616 -16864.821 -10280.008  39.0%  1907  617s
  4469  2317 -14597.909   29  620 -16864.821 -10280.008  39.0%  1907  622s
  4470  2318 -12628.067   13  620 -16864.821 -10280.008  39.0%  1906  640s
  4471  2319 -14206.017   28  620 -16864.821 -10280.008  39.0%  1906  655s
  4472  2322 -10280.008   12  618 -16864.821 -10280.008  39.0%  1940  666s
  4474  2326 -10280.008   13  598 -16864.821 -10280.008  39.0%  1941  678s
  4478  2332 -10519.851   14  682 -16864.821 -10280.008  39.0%  1944  691s
  4486  2345 -11031.284   15  579 -16864.821 -10280.008  39.0%  1951  704s
  4501  2356 -10280.008   16  621 -16864.821 -10280.008  39.0%  1989  726s
  4521  2359     cutoff   17      -16864.821 -10280.008  39.0%  2007  734s
  4553  2403 infeasible   18      -16864.821 -10283.455  39.0%  2023  750s
  4637  2427 -10479.012   18  462 -16864.821 -10283.455  39.0%  2031  767s
  4723  2458 -11228.022   20  423 -16864.821 -10283.455  39.0%  2043  775s
  4795  2476 -11549.335   21  302 -16864.821 -10283.455  39.0%  2054  783s
  4877  2487 -12136.638   24  298 -16864.821 -10283.455  39.0%  2054  791s
  4957  2490 -13065.625   27  178 -16864.821 -10283.455  39.0%  2052  799s
  5044  2487 -13664.309   30  157 -16864.821 -10283.455  39.0%  2050  811s
  5132  2473 -14484.151   34  224 -16864.821 -10479.193  37.9%  2045  817s
  5227  2475 -14941.991   38  204 -16864.821 -10492.937  37.8%  2035  824s
  5318  2475 -15810.342   43  125 -16864.821 -10492.937  37.8%  2022  831s
  5415  2453     cutoff   47      -16864.821 -10492.937  37.8%  2008  838s
  5500  2446 -13267.989   24  312 -16864.821 -10492.937  37.8%  2002  846s
  5554  2455 -13581.992   25  343 -16864.821 -10868.256  35.6%  1999  853s
  5626  2470 -13907.378   26  410 -16864.821 -11393.669  32.4%  1995  858s
  5717  2448 -14231.832   29  264 -16864.821 -11393.669  32.4%  1985  866s
  5765  2455 -14315.087   30  283 -16864.821 -11393.669  32.4%  1984  872s
  5822  2463 -14914.569   31  324 -16864.821 -11393.669  32.4%  1980  880s
  5893  2466 -15011.664   33  300 -16864.821 -11438.286  32.2%  1974  890s
  5969  2450 -14649.370   22  410 -16864.821 -11438.286  32.2%  1964  899s
  6047  2461 -15105.059   24  474 -16864.821 -11438.286  32.2%  1957  908s
  6141  2450 -15967.846   27  411 -16864.821 -11438.286  32.2%  1951  916s
  6255  2437 -16483.010   30  343 -16864.821 -11532.101  31.6%  1942  925s
  6380  2418     cutoff   23      -16864.821 -11989.132  28.9%  1930  936s
  6494  2420 -16659.409   20  345 -16864.821 -12116.419  28.2%  1920  944s
  6623  2390 -13351.092   23  549 -16864.821 -12116.419  28.2%  1915  953s
  6731  2389 -13421.096   24  459 -16864.821 -12116.419  28.2%  1906  963s
  6874  2346 -13964.432   26  498 -16864.821 -12116.419  28.2%  1899  974s
  7033  2298 -14414.063   29  463 -16864.821 -12116.419  28.2%  1894  984s
  7207  2241 -16220.355   35  200 -16864.821 -12822.901  24.0%  1886  996s
  7376  2195 infeasible   32      -16864.821 -12948.715  23.2%  1880 1007s
  7552  2118 -14851.246   20  303 -16864.821 -12948.715  23.2%  1875 1018s
  7756  1989     cutoff   22      -16864.821 -13211.892  21.7%  1864 1028s
  7959  1808     cutoff   30      -16864.821 -13538.445  19.7%  1849 1039s
  8221  1548 -15770.214   26  391 -16864.821 -13813.195  18.1%  1829 1049s
  8550  1172 -15419.296   25  420 -16864.821 -13904.270  17.6%  1799 1059s
  8959   848 infeasible   26      -16864.821 -14562.858  13.6%  1751 1066s
  9203   746 -16152.888   25  474 -16864.821 -14971.524  11.2%  1718 1073s

Cutting planes:
  Gomory: 1
  MIR: 478
  Flow cover: 2045
  RLT: 19
  Relax-and-lift: 137

Explored 9240 nodes (15995171 simplex iterations) in 1073.77 seconds (2816.98 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -16864.8 -16864.8 -16964.1 ... -20373.7
No other solutions better than -16864.8

Optimal solution found (tolerance 1.00e-06)
Warning: max constraint violation (4.3894e-09) exceeds tolerance
Best objective -1.686482091396e+04, best bound -1.686482091396e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 1073.78s
  Master Objective (UB) = -16864.82, θ = 87969.00
  Upper Bound (UB) = -16864.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 87969.00
  [DEBUG]   ✓ Scenario 0: θ = 87969.00 ≤ Q = 87969.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 87969.00 ≤ Q = 87969.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 87969.00 ≤ Q = 87969.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 87969.00 ≤ Q = 87969.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 87969.00 ≤ Q = 87969.00 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x27aa8900
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd8557700
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-14, 2e+02]
Found heuristic solution: objective 1.419024e+13
Presolve removed 168 rows and 168 columns
Presolve time: 0.00s

Cleanup yields a better solution

Explored 0 nodes (0 simplex iterations) in 0.00 seconds (0.00 work units)
Thread count was 1 (of 64 available processors)

Solution count 2: -1.91175e+22 1.41902e+13 
No other solutions better than 0

Model is unbounded
Warning: max constraint violation (6.9985e-09) exceeds tolerance
Best objective -1.911753203878e+22, best bound -, gap -
  Subproblem failed to solve! Status: 5
ERROR: Subproblem failed. Terminating.

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 5
Total Time: 2224.76s
Converged: False
Final Lower Bound: -19860.1824
Final Upper Bound: -16864.8209
Final Gap: 2995.361480
Number of Critical Scenarios: 5
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: False
Iterations: 5
Start Time: 2026-01-04 04:19:57
End Time: 2026-01-04 04:57:01
Total Time: 2224.76s
Optimal Value: N/A
Lower Bound: -19860.18
Upper Bound: -16864.82
Gap: 2995.361480
Plants Opened: [] (0 plants)
DCs Opened: [] (0 DCs)
================================================================================

Results saved to: result/DH_single_full_seed32_LD_gamma20_20260104_045702.csv

Total Execution Time: 2224.95 seconds
End Time: 2026-01-04 04:57:02

All tasks completed successfully!

