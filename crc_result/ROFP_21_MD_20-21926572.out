
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 21
DI Scenario: MD
Start Time: 2026-01-03 10:52:06
================================================================================
Loading data from data/DH_data_full_seed21.pkl...

Applying DI scenario: MD
DI values:
  Product 0: ['1.000', '1.180', '1.392'] (k=0.408)
  Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
  Product 2: ['1.000', '1.175', '1.380'] (k=0.398)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1719
  DC capacity (MC): min=431, max=842

Demand Structure (s_rk matrix):
  Total customer-product pairs: 84/150 (44.0% sparse)
  Average products per customer: 1.68

Demand (only non-zero entries):
  Nominal (μ): min=8.24, max=34.94, count=84
  Deviation (μ̂): min=4.05, max=9.88

Costs:
  Plant fixed cost: min=5672, max=9774
  DC fixed cost: min=3426, max=5483
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
    Product 1: ['1.000', '1.474', '2.173'] (k=0.957)
    Product 2: ['1.000', '1.444', '2.085'] (k=0.906)
  MD:
    Product 0: ['1.000', '1.180', '1.392'] (k=0.408)
    Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
    Product 2: ['1.000', '1.175', '1.380'] (k=0.398)
  LD:
    Product 0: ['1.000', '1.105', '1.221'] (k=0.246)
    Product 1: ['1.000', '1.060', '1.123'] (k=0.143)
    Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
  Mixed:
    Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
    Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
    Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48762 nonzeros
Model fingerprint: 0x13fea3f9
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11707 rows and 2707 columns
Presolve time: 0.08s
Presolved: 4966 rows, 5793 columns, 34451 nonzeros
Variable types: 3534 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -268669.2751
Found heuristic solution: objective -193271.6795

Root relaxation: objective 1.108516e+05, 4922 iterations, 0.19 seconds (0.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 110851.600    0  571 -193271.68 110851.600   157%     -    0s
H    0     0                    -184315.3993 110851.600   160%     -    0s
     0     0 105854.768    0  756 -184315.40 105854.768   157%     -    0s
H    0     0                    -181792.5739 105839.478   158%     -    0s
     0     0 105432.677    0  842 -181792.57 105432.677   158%     -    1s
     0     0 105419.412    0  836 -181792.57 105419.412   158%     -    1s
     0     0 105417.641    0  845 -181792.57 105417.641   158%     -    1s
     0     0 99958.5551    0  955 -181792.57 99958.5551   155%     -    1s
H    0     0                    -179168.1152 99957.9314   156%     -    1s
     0     0 99841.1682    0  909 -179168.12 99841.1682   156%     -    2s
     0     0 99794.8895    0  987 -179168.12 99794.8895   156%     -    2s
     0     0 99791.7597    0  984 -179168.12 99791.7597   156%     -    2s
     0     0 99791.1568    0  985 -179168.12 99791.1568   156%     -    2s
H    0     0                    -116005.3035 96528.8719   183%     -    3s
H    0     0                    -115842.2826 96528.8719   183%     -    3s
H    0     0                    -115531.0938 96528.8719   184%     -    3s
H    0     0                    -115261.5797 96528.8719   184%     -    3s
H    0     0                    -115002.3536 96528.8719   184%     -    3s
H    0     0                    -114747.8575 96528.8719   184%     -    3s
     0     0 96528.8719    0 1022 -114747.86 96528.8719   184%     -    3s
     0     0 96320.3742    0 1022 -114747.86 96320.3742   184%     -    3s
     0     0 96291.9632    0 1027 -114747.86 96291.9632   184%     -    3s
     0     0 96290.3366    0 1012 -114747.86 96290.3366   184%     -    3s
H    0     0                    -93574.23955 93480.0040   200%     -    4s
H    0     0                    -85313.62824 93480.0040   210%     -    4s
H    0     0                    -54242.27035 93480.0040   272%     -    4s
H    0     0                    -45981.65904 93480.0040   303%     -    4s
H    0     0                    -44130.92801 93480.0040   312%     -    4s
H    0     0                    23396.831529 93480.0040   300%     -    4s
     0     0 93480.0040    0 1066 23396.8315 93480.0040   300%     -    4s
     0     0 93130.3896    0 1104 23396.8315 93130.3896   298%     -    4s
     0     0 93076.1661    0 1122 23396.8315 93076.1661   298%     -    5s
     0     0 93067.9130    0 1129 23396.8315 93067.9130   298%     -    5s
     0     0 93066.1557    0 1130 23396.8315 93066.1557   298%     -    5s
H    0     0                    23537.040736 90278.3057   284%     -    6s
H    0     0                    23804.918203 90278.3057   279%     -    6s
H    0     0                    26563.155080 90278.3057   240%     -    6s
H    0     0                    30707.312318 90278.3057   194%     -    6s
H    0     0                    30719.997377 90278.3057   194%     -    6s
H    0     0                    32789.278683 90278.3057   175%     -    6s
     0     0 90278.3057    0 1000 32789.2787 90278.3057   175%     -    6s
     0     0 89837.1085    0 1090 32789.2787 89837.1085   174%     -    6s
     0     0 89710.9870    0 1102 32789.2787 89710.9870   174%     -    7s
     0     0 89693.1810    0 1123 32789.2787 89693.1810   174%     -    7s
     0     0 89690.3860    0 1128 32789.2787 89690.3860   174%     -    7s
H    0     0                    32822.888514 87496.3938   167%     -    8s
H    0     0                    32839.595085 87496.3938   166%     -    8s
H    0     0                    32899.278738 87496.3938   166%     -    8s
H    0     0                    32911.221515 87496.3938   166%     -    8s
H    0     0                    32924.962086 87496.3938   166%     -    8s
H    0     0                    33330.824831 87496.3938   163%     -    8s
H    0     0                    33597.953752 87496.3938   160%     -    8s
H    0     0                    33679.226510 87496.3938   160%     -    8s
H    0     0                    33807.980318 87496.3938   159%     -    8s
H    0     0                    33857.888400 87496.3938   158%     -    8s
H    0     0                    33877.114577 87496.3938   158%     -    8s
H    0     0                    33880.934818 87496.3938   158%     -    8s
H    0     0                    34224.608193 87496.3938   156%     -    8s
H    0     0                    34716.030246 87496.3938   152%     -    8s
H    0     0                    34812.636711 87496.3938   151%     -    8s
H    0     0                    34974.478743 87496.3938   150%     -    8s
H    0     0                    35082.718101 87496.3938   149%     -    8s
     0     0 87496.3938    0 1090 35082.7181 87496.3938   149%     -    8s
     0     0 87073.0666    0 1161 35082.7181 87073.0666   148%     -    8s
H    0     0                    35137.954774 86961.0427   147%     -    9s
     0     0 86961.0427    0 1155 35137.9548 86961.0427   147%     -    9s
H    0     0                    35159.716407 86944.9643   147%     -    9s
     0     0 86944.9643    0 1175 35159.7164 86944.9643   147%     -    9s
H    0     0                    35190.354946 86939.5452   147%     -    9s
H    0     0                    35207.608140 86939.5452   147%     -    9s
     0     0 86939.5452    0 1173 35207.6081 86939.5452   147%     -    9s
H    0     0                    36716.649764 85591.0663   133%     -   10s
H    0     0                    37478.148425 85591.0663   128%     -   10s
H    0     0                    37526.584247 85591.0663   128%     -   10s
H    0     0                    37600.029889 85591.0663   128%     -   10s
H    0     0                    37632.511480 85591.0663   127%     -   10s
H    0     0                    37705.957121 85591.0663   127%     -   10s
     0     0 85591.0663    0 1086 37705.9571 85591.0663   127%     -   10s
H    0     0                    37835.569640 85224.8691   125%     -   11s
     0     0 85224.8691    0 1120 37835.5696 85224.8691   125%     -   11s
     0     0 85138.1481    0 1156 37835.5696 85138.1481   125%     -   11s
     0     0 85108.8076    0 1155 37835.5696 85108.8076   125%     -   12s
     0     0 85104.1830    0 1176 37835.5696 85104.1830   125%     -   12s
     0     0 83952.3124    0 1140 37835.5696 83952.3124   122%     -   13s
H    0     0                    38169.466294 83757.8284   119%     -   14s
H    0     0                    38523.483481 83757.8284   117%     -   14s
H    0     0                    40641.652899 83757.8284   106%     -   14s
H    0     0                    41210.695479 83757.8284   103%     -   14s
H    0     0                    41273.967603 83757.8284   103%     -   14s
     0     0 83757.8284    0 1159 41273.9676 83757.8284   103%     -   14s
     0     0 83717.6962    0 1182 41273.9676 83717.6962   103%     -   14s
     0     0 83701.1535    0 1193 41273.9676 83701.1535   103%     -   14s
H    0     0                    41281.944884 83135.5922   101%     -   16s
     0     0 83135.5922    0 1161 41281.9449 83135.5922   101%     -   16s
     0     0 82955.3051    0 1188 41281.9449 82955.3051   101%     -   16s
H    0     0                    41284.824190 82912.8118   101%     -   17s
H    0     0                    41358.700351 82912.8118   100%     -   17s
     0     0 82912.8118    0 1207 41358.7004 82912.8118   100%     -   17s
     0     0 82898.6732    0 1194 41358.7004 82898.6732   100%     -   17s
     0     0 82413.7872    0 1101 41358.7004 82413.7872  99.3%     -   19s
     0     0 82342.5800    0 1091 41358.7004 82342.5800  99.1%     -   19s
     0     0 82319.0481    0 1154 41358.7004 82319.0481  99.0%     -   20s
H    0     0                    41409.323070 81923.4944  97.8%     -   21s
H    0     0                    41424.252900 81923.4944  97.8%     -   21s
H    0     0                    41528.269780 81923.4944  97.3%     -   21s
H    0     0                    41737.373749 81923.4944  96.3%     -   21s
H    0     0                    41758.646866 81923.4944  96.2%     -   21s
H    0     0                    41956.555926 81923.4944  95.3%     -   21s
     0     0 81923.4944    0 1073 41956.5559 81923.4944  95.3%     -   21s
     0     0 81822.3024    0 1124 41956.5559 81822.3024  95.0%     -   22s
     0     0 81789.6805    0 1132 41956.5559 81789.6805  94.9%     -   22s
     0     0 81782.2891    0 1173 41956.5559 81782.2891  94.9%     -   22s
     0     0 81498.6759    0 1082 41956.5559 81498.6759  94.2%     -   23s
H    0     0                    42075.741285 81426.9675  93.5%     -   24s
     0     0 81426.9675    0 1100 42075.7413 81426.9675  93.5%     -   24s
     0     0 81410.3870    0 1143 42075.7413 81410.3870  93.5%     -   25s
     0     0 81189.8399    0 1056 42075.7413 81189.8399  93.0%     -   26s
     0     0 81139.0958    0 1098 42075.7413 81139.0958  92.8%     -   26s
     0     0 81119.2656    0 1098 42075.7413 81119.2656  92.8%     -   27s
     0     0 80885.6314    0 1082 42075.7413 80885.6314  92.2%     -   28s
     0     0 80885.5026    0 1082 42075.7413 80885.5026  92.2%     -   28s
H    0     2                    42267.796990 80885.5026  91.4%     -   29s
     0     2 80885.5026    0 1082 42267.7970 80885.5026  91.4%     -   29s
     1     4 80616.2792    1  964 42267.7970 80885.5026  91.4%  3962   32s
     7    16 80040.1224    3  801 42267.7970 80346.0118  90.1%  4272   35s
    31    64 69670.0022    5  546 42267.7970 76232.6604  80.4%  4089   40s
H   35    64                    42276.351891 76232.6604  80.3%  4217   40s
H   53    64                    42385.782076 74068.3490  74.7%  5330   40s
H  116   251                    42394.336977 74068.3490  74.7%  3504   42s
H  150   251                    42627.700738 74068.3490  73.8%  2843   42s
H  442   448                    42701.844452 74068.3490  73.5%  1295   44s
   457   506 66886.1735   16  464 42701.8445 73670.6240  72.5%  1270   45s
H  467   506                    42841.127113 73670.6240  72.0%  1257   45s
H  486   506                    43016.606050 73670.6240  71.3%  1228   45s
H  600   647                    43031.751281 73648.3889  71.1%  1103   46s
H  747   774                    43146.256827 73648.3889  70.7%  1007   48s
   944   935 53715.9158   21  369 43146.2568 72680.1174  68.5%   947   50s
  1099  1047 58906.5681   23  473 43146.2568 72677.3283  68.4%   909   56s
H 1457  1323                    43296.523111 71974.3994  66.2%   790   58s
  1653  1647 56111.6819   29  436 43296.5231 71808.9515  65.9%   747   60s
  2700  2457 53069.6252   15  194 43296.5231 71027.8966  64.0%   574   66s
  3682  3089 68131.3842    7  584 43296.5231 69662.0777  60.9%   493   70s
  3878  3090 66543.1618   11 1082 43296.5231 69662.0777  60.9%   490   84s
  3880  3091 55093.3578   17  254 43296.5231 68138.1297  57.4%   490   85s
  3902  3111 54221.0659   12  428 43296.5231 54324.9829  25.5%   492   90s
H 4205  3067                    44200.948542 53334.7646  20.7%   487   92s
  4767  2929 47110.1391   21  323 44200.9485 52373.6447  18.5%   466   95s
  5974  2466 44995.1654   26  162 44200.9485 47852.1337  8.26%   420  100s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 22
  MIR: 202
  Flow cover: 408
  RLT: 12
  Relax-and-lift: 94

Explored 7665 nodes (2711420 simplex iterations) in 101.14 seconds (215.34 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 44200.9 43296.5 43146.3 ... 42385.8

Optimal solution found (tolerance 1.00e-06)
Best objective 4.420094854225e+04, best bound 4.420094854225e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 101.15s
  Master Objective (UB) = 44200.95, θ = 191865.64
  Upper Bound (UB) = 44200.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191865.64
  [DEBUG]   ✓ Scenario 0: θ = 191865.64 ≤ Q = 191865.64 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x53d41d65
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x53d41d65
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362824e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6949378.2017
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.424125e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142412.46    0  123 6949378.20 -142412.46   102%     -    0s
H    0     0                    -107808.0193 -142412.46  32.1%     -    0s
H    0     0                    -107985.0392 -142412.46  31.9%     -    0s
H    0     0                    -111114.9257 -111114.93  0.00%     -    0s
     0     0          -    0      -111114.93 -111114.93  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 207

Explored 1 nodes (380 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -111115 -107985 -107808 ... 1.36282e+13
No other solutions better than -111115

Optimal solution found (tolerance 1.00e-06)
Best objective -1.111149256695e+05, best bound -1.111149256695e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 160254.45
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111114.93
  [DEBUG]   S×d_nominal = 271369.37
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 271369.37 + -111114.93 = 160254.45
  [DEBUG]   Current θ from Master = 191865.64
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31611.19 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12589.76
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 31611.1868, Absolute Gap = 31611.1868, Relative Gap = 0.715170
  Not converged yet (gap = 31611.19 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92005 nonzeros
Model fingerprint: 0xcb2f47f5
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 12589.8 (0.01s)
MIP start from previous solve produced solution with objective 12589.8 (0.01s)
Loaded MIP start from previous solve with objective 12589.8

Presolve removed 13363 rows and 5422 columns
Presolve time: 0.34s
Presolved: 18600 rows, 9318 columns, 103068 nonzeros
Variable types: 7059 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.420285e+04, 11473 iterations, 1.66 seconds (3.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54202.8509    0  433 12589.7617 54202.8509   331%     -    2s
H    0     0                    15074.305920 54202.8509   260%     -    2s
H    0     0                    15400.080673 54202.8509   252%     -    2s
     0     0 46170.5829    0  494 15400.0807 46170.5829   200%     -    3s
H    0     0                    15744.449200 46170.0671   193%     -    3s
H    0     0                    16044.269912 46170.0671   188%     -    3s
     0     0 45938.8109    0  503 16044.2699 45938.8109   186%     -    4s
     0     0 45934.2836    0  513 16044.2699 45934.2836   186%     -    4s
     0     0 45933.9967    0  513 16044.2699 45933.9967   186%     -    4s
     0     0 39692.6643    0  589 16044.2699 39692.6643   147%     -    6s
H    0     0                    16051.772808 39691.8635   147%     -    6s
H    0     0                    16057.905166 39691.8635   147%     -    6s
H    0     0                    16095.545328 38805.3121   141%     -    7s
     0     0 38805.3121    0  667 16095.5453 38805.3121   141%     -    7s
     0     0 38682.8078    0  680 16095.5453 38682.8078   140%     -    7s
     0     0 38656.3641    0  671 16095.5453 38656.3641   140%     -    7s
     0     0 38654.4676    0  673 16095.5453 38654.4676   140%     -    7s
     0     0 34606.6588    0  509 16095.5453 34606.6588   115%     -   10s
     0     0 34019.2277    0  579 16095.5453 34019.2277   111%     -   11s
     0     0 33871.8999    0  587 16095.5453 33871.8999   110%     -   12s
     0     0 33823.1593    0  613 16095.5453 33823.1593   110%     -   12s
     0     0 33811.0994    0  626 16095.5453 33811.0994   110%     -   12s
     0     0 33808.0374    0  631 16095.5453 33808.0374   110%     -   12s
H    0     0                    17584.417473 31703.0885  80.3%     -   16s
H    0     0                    17585.591912 31703.0885  80.3%     -   16s
H    0     0                    17859.821751 31703.0885  77.5%     -   16s
H    0     0                    18155.583861 31703.0885  74.6%     -   16s
H    0     0                    18173.582712 31703.0885  74.4%     -   16s
H    0     0                    18182.651954 31703.0885  74.4%     -   16s
H    0     0                    18195.286101 31703.0885  74.2%     -   16s
H    0     0                    18243.557001 31703.0885  73.8%     -   16s
     0     0 31703.0885    0  534 18243.5570 31703.0885  73.8%     -   16s
H    0     0                    18254.324266 31702.7847  73.7%     -   16s
H    0     0                    18259.331928 31702.7847  73.6%     -   16s
H    0     0                    18273.547941 31702.7847  73.5%     -   16s
H    0     0                    18275.703301 31702.7847  73.5%     -   16s
     0     0 31304.9300    0  536 18275.7033 31304.9300  71.3%     -   17s
     0     0 31217.4843    0  531 18275.7033 31217.4843  70.8%     -   17s
     0     0 31172.7335    0  539 18275.7033 31172.7335  70.6%     -   18s
     0     0 31160.8100    0  547 18275.7033 31160.8100  70.5%     -   18s
     0     0 31158.8443    0  550 18275.7033 31158.8443  70.5%     -   18s
H    0     0                    18343.933323 30710.3935  67.4%     -   19s
H    0     0                    18353.368914 30710.3935  67.3%     -   19s
     0     0 30710.3935    0  505 18353.3689 30710.3935  67.3%     -   19s
     0     0 30602.3950    0  535 18353.3689 30602.3950  66.7%     -   19s
     0     0 30543.3993    0  566 18353.3689 30543.3993  66.4%     -   20s
     0     0 30508.5140    0  631 18353.3689 30508.5140  66.2%     -   20s
     0     0 30494.5494    0  567 18353.3689 30494.5494  66.2%     -   20s
     0     0 30491.4121    0  562 18353.3689 30491.4121  66.1%     -   20s
     0     0 30345.1329    0  485 18353.3689 30345.1329  65.3%     -   21s
     0     0 30287.6954    0  564 18353.3689 30287.6954  65.0%     -   22s
     0     0 30264.9473    0  560 18353.3689 30264.9473  64.9%     -   22s
     0     0 30256.9698    0  567 18353.3689 30256.9698  64.9%     -   22s
     0     0 30255.8595    0  568 18353.3689 30255.8595  64.9%     -   22s
     0     0 30185.4727    0  520 18353.3689 30185.4727  64.5%     -   23s
H    0     0                    18424.033200 30176.1771  63.8%     -   23s
     0     0 30176.1771    0  477 18424.0332 30176.1771  63.8%     -   23s
     0     0 30174.6495    0  477 18424.0332 30174.6495  63.8%     -   23s
     0     0 30159.1796    0  539 18424.0332 30159.1796  63.7%     -   24s
     0     0 30150.0355    0  473 18424.0332 30150.0355  63.6%     -   24s
     0     0 30148.0544    0  403 18424.0332 30148.0544  63.6%     -   24s
     0     0 30135.3558    0  538 18424.0332 30135.3558  63.6%     -   24s
     0     0 30135.0857    0  538 18424.0332 30135.0857  63.6%     -   25s
     0     2 30134.7333    0  538 18424.0332 30134.7333  63.6%     -   30s
    31    64 28906.2077    5  499 18424.0332 29256.4138  58.8%  1320   35s
H   36    64                    18431.672516 29256.4138  58.7%  1216   35s
H  116   159                    18458.509887 28904.6567  56.6%   906   37s
   337   386 27229.4973   13  297 18458.5099 28904.6567  56.6%   609   40s
   607   630 25081.1198   19  299 18458.5099 28904.6567  56.6%   534   45s
   898   880 25604.3242   28  241 18458.5099 28599.7009  54.9%   496   50s
  1279  1264 24516.7964   34  226 18458.5099 28368.8366  53.7%   431   55s
  2165  2040 20905.8977   60  139 18458.5099 28254.0882  53.1%   328   60s
  2844  2554 26047.9423   11  365 18458.5099 28155.5103  52.5%   289   65s
  3526  2849 23561.3263   35  538 18458.5099 28120.8203  52.3%   272   81s
  3530  2852 24187.6890   27  412 18458.5099 28120.8203  52.3%   272   85s
  3543  2860 19320.3587   62  411 18458.5099 28120.8203  52.3%   271   90s
  3555  2868 21936.5885   43  394 18458.5099 28120.8203  52.3%   270   95s
  3565  2875 22356.4118   49  511 18458.5099 28120.8203  52.3%   269  100s
  3568  2880 28120.8203   14  464 18458.5099 28120.8203  52.3%   278  105s
  3596  2921 25394.1878   18  371 18458.5099 28120.8203  52.3%   286  112s
H 3648  2774                    18460.870821 28120.8203  52.3%   298  113s
  3656  2793     cutoff   20      18460.8708 28059.2493  52.0%   300  115s
H 3737  2698                    18468.235768 27803.5334  50.5%   312  118s
H 3760  2559                    18506.136372 27803.5334  50.2%   314  118s
  3886  2636 21795.1721   25  185 18506.1364 27803.5334  50.2%   319  120s
  4239  2685     cutoff   35      18506.1364 27144.8955  46.7%   320  125s
H 4256  2556                    18507.472532 27023.8318  46.0%   320  125s
  4528  2551 25508.7607   27  275 18507.4725 26945.5109  45.6%   321  130s
  4882  2559 22202.2874   35  218 18507.4725 25886.5874  39.9%   326  135s
* 5162  2397             105    18509.110318 25775.9304  39.3%   324  137s
* 5229  2262             100    18512.390786 25507.0554  37.8%   325  137s
H 5335  2185                    18530.316654 25472.8185  37.5%   325  138s
H 5338  2083                    18560.389163 25472.8185  37.2%   325  138s
* 5377  2022              64    18568.502607 25472.8185  37.2%   325  139s
  5503  2013 20318.6877   30  185 18568.5026 25472.8185  37.2%   324  140s
* 5625  1881              74    18896.582441 25218.1254  33.5%   323  140s
H 5657  1787                    18944.038201 25218.1254  33.1%   324  141s
H 5671  1700                    18976.128412 25218.1254  32.9%   324  141s
H 5678  1620                    19490.453754 25218.1254  29.4%   324  141s
H 5695  1540                    19526.419620 25017.4988  28.1%   324  141s
H 5709  1464                    19595.810773 24985.7283  27.5%   325  141s
  6109  1395 22533.1532   26  234 19595.8108 24687.2031  26.0%   327  145s
  6892  1109 22858.8813   25  207 19595.8108 23631.8230  20.6%   331  150s
  7777   795 21366.5331   26  313 19595.8108 23278.4606  18.8%   332  156s
H 8097   737                    19628.412353 22691.5434  15.6%   331  157s
H 8302   737                    19631.272970 22431.5555  14.3%   331  157s
H 8304   737                    19680.762843 22431.5555  14.0%   331  157s
H 8341   636                    19681.019299 22431.5555  14.0%   331  159s
H 8366   636                    19824.344116 22402.8207  13.0%   330  159s
  8605   472 infeasible   37      19824.3441 22202.0152  12.0%   329  160s
* 9447   225              59    19850.849802 21537.6184  8.50%   318  162s
H 9514   361                    19977.869801 21316.5369  6.70%   317  162s

Cutting planes:
  Learned: 1
  MIR: 288
  Flow cover: 781
  RLT: 50
  Relax-and-lift: 59

Explored 11404 nodes (3101479 simplex iterations) in 163.62 seconds (365.95 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 19977.9 19850.8 19824.3 ... 19490.5

Optimal solution found (tolerance 1.00e-06)
Best objective 1.997786980117e+04, best bound 1.997786980117e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 163.63s
  Master Objective (UB) = 19977.87, θ = 156162.83
  Upper Bound (UB) = 19977.87

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156162.83
  [DEBUG]   ✓ Scenario 0: θ = 156162.83 ≤ Q = 156162.83 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156162.83 ≤ Q = 156162.83 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5bd12062
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5bd12062
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.445824e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.01s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 7637825.1015
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.436278e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143627.84    0  132 7637825.10 -143627.84   102%     -    0s
H    0     0                    -108863.7120 -143627.84  31.9%     -    0s
H    0     0                    -109831.8085 -143627.84  30.8%     -    0s
H    0     0                    -124176.7878 -143627.84  15.7%     -    0s
     0     0 -130682.22    0  133 -124176.79 -130682.22  5.24%     -    0s
H    0     0                    -127191.4660 -130591.11  2.67%     -    0s
     0     0 -130325.19    0  134 -127191.47 -130325.19  2.46%     -    0s
     0     0 -130314.09    0  133 -127191.47 -130314.09  2.46%     -    0s
H    0     0                    -128076.3931 -130314.09  1.75%     -    0s
     0     0 -129493.77    0  121 -128076.39 -129493.77  1.11%     -    0s
H    0     0                    -128258.5762 -129434.59  0.92%     -    0s
     0     0 -129316.75    0  103 -128258.58 -129316.75  0.83%     -    0s
     0     0 -129308.65    0  118 -128258.58 -129308.65  0.82%     -    0s
     0     0 -129276.61    0  112 -128258.58 -129276.61  0.79%     -    0s
     0     0 -128799.51    0   42 -128258.58 -128799.51  0.42%     -    0s
     0     0 -128616.50    0   43 -128258.58 -128616.50  0.28%     -    0s
     0     0 -128602.06    0   35 -128258.58 -128602.06  0.27%     -    0s
     0     0 -128460.34    0   17 -128258.58 -128460.34  0.16%     -    0s
H    0     0                    -128291.4862 -128453.82  0.13%     -    0s
     0     0 -128429.33    0   23 -128291.49 -128429.33  0.11%     -    0s
     0     0 -128428.27    0   13 -128291.49 -128428.27  0.11%     -    0s
     0     0 -128386.99    0   11 -128291.49 -128386.99  0.07%     -    0s
     0     0 -128386.99    0   12 -128291.49 -128386.99  0.07%     -    0s
H    0     0                    -128338.8275 -128386.99  0.04%     -    0s
     0     0 -128346.49    0    2 -128338.83 -128346.49  0.01%     -    0s
*    0     0               0    -128343.8633 -128343.86  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 6
  MIR: 1
  Flow cover: 11
  Relax-and-lift: 1

Explored 1 nodes (1030 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128344 -128339 -128291 ... 7.63783e+06
No other solutions better than -128344

Optimal solution found (tolerance 1.00e-06)
Best objective -1.283438633234e+05, best bound -1.283438633234e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 135598.59
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128343.86
  [DEBUG]   S×d_nominal = 263942.45
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 263942.45 + -128343.86 = 135598.59
  [DEBUG]   Current θ from Master = 156162.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20564.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -586.37
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 7388.1081, Absolute Gap = 7388.1081, Relative Gap = 0.369815
  Not converged yet (gap = 7388.11 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135248 nonzeros
Model fingerprint: 0x1ccf8a2e
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -586.369 (0.02s)
Loaded MIP start from previous solve with objective -586.369

Presolve removed 20018 rows and 8128 columns
Presolve time: 0.42s
Presolved: 27235 rows, 12852 columns, 167609 nonzeros
Variable types: 10593 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.951668e+04, 17738 iterations, 4.12 seconds (8.02 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39516.6766    0  233 -586.36920 39516.6766  6839%     -    4s
H    0     0                    -535.8053685 39516.6766  7475%     -    4s
H    0     0                    -305.8779354 39516.6766      -     -    4s
H    0     0                     995.4505214 39516.6766  3870%     -    4s
H    0     0                    1000.8212850 39516.6766  3848%     -    5s
H    0     0                    1102.5642400 39516.6766  3484%     -    5s
H    0     0                    1141.2569636 39516.6766  3363%     -    5s
H    0     0                    6114.5864146 39516.6766   546%     -    5s
H    0     0                    6637.4360475 39516.6766   495%     -    5s
H    0     0                    7589.6214441 39516.6766   421%     -    5s
H    0     0                    7722.2002321 39516.6766   412%     -    5s
H    0     0                    7853.5820218 39516.6766   403%     -    5s
     0     0 34775.1090    0  286 7853.58202 34775.1090   343%     -    7s
H    0     0                    8066.7587769 34774.6189   331%     -    7s
H    0     0                    8213.8297516 34774.6189   323%     -    7s
H    0     0                    8736.2804034 33607.8358   285%     -    7s
     0     0 33607.8358    0  287 8736.28040 33607.8358   285%     -    7s
     0     0 33542.7757    0  325 8736.28040 33542.7757   284%     -    8s
     0     0 33525.7717    0  320 8736.28040 33525.7717   284%     -    8s
     0     0 33512.4282    0  324 8736.28040 33512.4282   284%     -    8s
     0     0 33511.6117    0  324 8736.28040 33511.6117   284%     -    8s
     0     0 33511.3732    0  326 8736.28040 33511.3732   284%     -    8s
     0     0 30692.0029    0  356 8736.28040 30692.0029   251%     -   10s
     0     0 30078.1032    0  354 8736.28040 30078.1032   244%     -   11s
     0     0 29631.2980    0  364 8736.28040 29631.2980   239%     -   11s
     0     0 29529.8566    0  371 8736.28040 29529.8566   238%     -   11s
     0     0 29416.7100    0  374 8736.28040 29416.7100   237%     -   12s
     0     0 29410.6273    0  373 8736.28040 29410.6273   237%     -   12s
     0     0 29409.4139    0  374 8736.28040 29409.4139   237%     -   12s
     0     0 29407.8923    0  380 8736.28040 29407.8923   237%     -   12s
     0     0 29407.8634    0  380 8736.28040 29407.8634   237%     -   12s
H    0     0                    8955.7812996 29407.8634   228%     -   13s
H    0     0                    9267.8198666 29407.8634   217%     -   13s
     0     0 28252.3625    0  409 9267.81987 28252.3625   205%     -   14s
     0     0 27957.6086    0  443 9267.81987 27957.6086   202%     -   15s
     0     0 27793.0805    0  442 9267.81987 27793.0805   200%     -   16s
     0     0 27752.3800    0  446 9267.81987 27752.3800   199%     -   16s
     0     0 27745.7198    0  425 9267.81987 27745.7198   199%     -   16s
     0     0 27726.3336    0  425 9267.81987 27726.3336   199%     -   17s
     0     0 27721.0454    0  426 9267.81987 27721.0454   199%     -   17s
H    0     0                    9518.0704337 27720.4694   191%     -   17s
H    0     0                    9569.9426595 27720.4694   190%     -   17s
H    0     0                    9583.7435288 27720.4694   189%     -   17s
H    0     0                    9586.0830362 27720.4694   189%     -   17s
H    0     0                    9900.6804372 27720.4694   180%     -   17s
H    0     0                    9995.7617023 27720.4694   177%     -   17s
H    0     0                    10029.514515 27720.4694   176%     -   17s
H    0     0                    10079.834043 27720.4694   175%     -   17s
     0     0 27720.4694    0  427 10079.8340 27720.4694   175%     -   17s
H    0     0                    10115.693329 27720.4694   174%     -   18s
H    0     0                    10424.127346 27271.3858   162%     -   19s
H    0     0                    10676.130320 27271.3858   155%     -   19s
H    0     0                    10703.905957 27271.3858   155%     -   19s
H    0     0                    10737.530035 27271.3858   154%     -   19s
H    0     0                    10752.949077 27271.3858   154%     -   19s
     0     0 27271.3858    0  449 10752.9491 27271.3858   154%     -   19s
     0     0 27142.8027    0  452 10752.9491 27142.8027   152%     -   20s
     0     0 27093.3425    0  440 10752.9491 27093.3425   152%     -   20s
     0     0 27073.9853    0  443 10752.9491 27073.9853   152%     -   21s
     0     0 27070.0750    0  452 10752.9491 27070.0750   152%     -   21s
     0     0 27068.6952    0  451 10752.9491 27068.6952   152%     -   21s
     0     0 27004.8595    0  452 10752.9491 27004.8595   151%     -   22s
     0     0 26973.8719    0  456 10752.9491 26973.8719   151%     -   22s
     0     0 26965.9438    0  456 10752.9491 26965.9438   151%     -   23s
     0     0 26962.8229    0  454 10752.9491 26962.8229   151%     -   23s
     0     0 26960.8005    0  455 10752.9491 26960.8005   151%     -   23s
     0     0 26960.3859    0  465 10752.9491 26960.3859   151%     -   23s
H    0     0                    11045.143320 26888.3136   143%     -   24s
     0     0 26888.3136    0  482 11045.1433 26888.3136   143%     -   24s
     0     0 26873.5234    0  488 11045.1433 26873.5234   143%     -   24s
     0     0 26861.6469    0  461 11045.1433 26861.6469   143%     -   24s
     0     0 26859.5902    0  462 11045.1433 26859.5902   143%     -   25s
H    0     0                    11080.008075 26856.9443   142%     -   25s
     0     0 26856.9443    0  458 11080.0081 26856.9443   142%     -   25s
H    0     0                    11081.248556 26856.3147   142%     -   25s
H    0     0                    11131.376390 26856.3147   141%     -   25s
H    0     0                    11136.340208 26856.3147   141%     -   25s
H    0     0                    11159.807694 26856.3147   141%     -   25s
     0     0 26856.3147    0  464 11159.8077 26856.3147   141%     -   25s
     0     0 26830.2308    0  458 11159.8077 26830.2308   140%     -   26s
     0     0 26798.8634    0  468 11159.8077 26798.8634   140%     -   27s
H    0     0                    11197.652727 26791.4605   139%     -   27s
     0     0 26791.4605    0  494 11197.6527 26791.4605   139%     -   27s
H    0     0                    11204.771231 26790.5268   139%     -   27s
     0     0 26790.5268    0  496 11204.7712 26790.5268   139%     -   27s
     0     0 26778.4732    0  458 11204.7712 26778.4732   139%     -   28s
     0     0 26776.6948    0  467 11204.7712 26776.6948   139%     -   28s
     0     0 26775.9466    0  464 11204.7712 26775.9466   139%     -   28s
     0     0 26757.4679    0  467 11204.7712 26757.4679   139%     -   28s
     0     0 26755.4743    0  466 11204.7712 26755.4743   139%     -   28s
     0     0 26752.8674    0  468 11204.7712 26752.8674   139%     -   29s
     0     0 26752.2633    0  475 11204.7712 26752.2633   139%     -   29s
     0     0 26715.9228    0  503 11204.7712 26715.9228   138%     -   29s
H    0     0                    11220.002534 26715.9190   138%     -   29s
H    0     0                    11282.560572 26715.9190   137%     -   29s
     0     0 26698.8080    0  491 11282.5606 26698.8080   137%     -   30s
     0     0 26691.4747    0  469 11282.5606 26691.4747   137%     -   30s
     0     0 26686.6452    0  459 11282.5606 26686.6452   137%     -   30s
     0     0 26685.8885    0  466 11282.5606 26685.8885   137%     -   30s
     0     0 26680.6389    0  479 11282.5606 26680.6389   136%     -   30s
     0     0 26675.7683    0  482 11282.5606 26675.7683   136%     -   31s
     0     0 26674.4730    0  486 11282.5606 26674.4730   136%     -   31s
     0     0 26671.3842    0  483 11282.5606 26671.3842   136%     -   31s
H    0     0                    11293.035540 26671.3210   136%     -   31s
     0     0 26669.9507    0  488 11293.0355 26669.9507   136%     -   31s
     0     0 26667.5316    0  486 11293.0355 26667.5316   136%     -   32s
     0     0 26667.0528    0  517 11293.0355 26667.0528   136%     -   32s
     0     0 26664.0608    0  484 11293.0355 26664.0608   136%     -   33s
     0     0 26663.9883    0  484 11293.0355 26663.9883   136%     -   33s
H    0     0                    11315.222651 26663.9489   136%     -   41s
H    0     0                    12123.100251 26663.9489   120%     -   43s
H    0     0                    12411.610428 26663.9489   115%     -   43s
H    0     2                    13135.576520 26663.9489   103%     -   43s
     0     2 26663.9489    0  484 13135.5765 26663.9489   103%     -   43s
     3     8 26076.8496    2  455 13135.5765 26460.5122   101%  1860   46s
    15    32 25433.1455    4  493 13135.5765 25841.1556  96.7%  3084   51s
H   31    64                    13294.135063 25433.1011  91.3%  3747   53s
H   34    64                    13735.451546 25431.6663  85.2%  3551   53s
H   41    64                    15163.650574 25431.6663  67.7%  3210   53s
    63    96 25162.5727    6  485 15163.6506 25325.0972  67.0%  3038   55s
H   64    96                    15211.669306 25325.0972  66.5%  2991   55s
H   65    96                    15243.848894 25325.0972  66.1%  2960   55s
H   66    96                    15311.167303 25325.0972  65.4%  2946   55s
H   68    96                    15599.460715 25325.0972  62.3%  2916   55s
H   69    96                    15627.640507 25325.0972  62.1%  2919   55s
H   73    96                    15829.761686 25325.0972  60.0%  2852   55s
H   90    96                    15889.207847 25325.0972  59.4%  2610   55s
H  212   269                    15913.370903 25325.0972  59.1%  1573   58s
   274   313 24890.0117    9  518 15913.3709 25325.0972  59.1%  1430   60s
   389   438 24731.2139   11  457 15913.3709 25161.9852  58.1%  1383   65s
   611   635 23504.6281   15  429 15913.3709 25161.9852  58.1%  1176   70s
   815   817 23181.8513   18  413 15913.3709 25109.1777  57.8%  1032   75s
   956   928 20347.1152   19  390 15913.3709 24948.3618  56.8%   970   80s
  1128  1039 22396.5035   22  404 15913.3709 24906.8389  56.5%   934   87s
  1253  1171 22132.1039   24  419 15913.3709 24906.8389  56.5%   925   93s
  1338  1256 21706.1390   24  384 15913.3709 24906.8389  56.5%   904   95s
  1671  1593 21264.7927   26  319 15913.3709 24906.8389  56.5%   825  101s
  1987  1743 20926.8296   27  377 15913.3709 24906.8389  56.5%   761  106s
  2202  1898 21521.7855   28  388 15913.3709 24889.7532  56.4%   763  112s
  2460  2029 21040.8178   29  319 15913.3709 24889.7532  56.4%   763  117s
  2686  2228 21032.1348   31  326 15913.3709 24824.9038  56.0%   772  123s
  2840  2371 20825.9449   32  295 15913.3709 24824.9038  56.0%   767  126s
  3224  2640 20269.9357   33  383 15913.3709 24592.3957  54.5%   739  132s
  3453  2789     cutoff   34      15913.3709 24441.4144  53.6%   727  135s
  3667  2790 18969.4419   28  484 15913.3709 24350.7617  53.0%   716  144s
  3669  2791 22889.9944   11  233 15913.3709 24350.7617  53.0%   716  150s
  3671  2793 17403.1742   29  425 15913.3709 24350.7617  53.0%   715  156s
  3675  2795 21954.8838   16  461 15913.3709 24350.7617  53.0%   715  160s
  3684  2801 17840.6819   42  475 15913.3709 24350.7617  53.0%   713  165s
  3689  2805 19470.8528   23  477 15913.3709 24350.7617  53.0%   712  170s
  3695  2809 20717.8762   37  516 15913.3709 24350.7617  53.0%   711  175s
  3698  2811 20251.7633   32  487 15913.3709 24350.7617  53.0%   710  184s
  3699  2811 16990.5854   66  487 15913.3709 24350.7617  53.0%   710  188s
  3700  2815 24350.7617   12  459 15913.3709 24350.7617  53.0%   726  191s
  3706  2825 24350.7617   14  380 15913.3709 24350.7617  53.0%   730  195s
  3730  2853 24336.3322   16  414 15913.3709 24350.7617  53.0%   747  202s
  3760  2875 24097.0522   17  417 15913.3709 24350.7617  53.0%   756  205s
  3826  2925 23389.0574   19  416 15913.3709 24141.9652  51.7%   792  211s
  3910  2960 23093.5199   20  364 15913.3709 24141.9652  51.7%   805  215s
  4005  2982 22678.2068   21  414 15913.3709 24141.9652  51.7%   813  221s
  4155  2998 21836.1532   22  393 15913.3709 24141.9652  51.7%   822  227s
  4304  3010 21278.6298   23  266 15913.3709 24141.9652  51.7%   826  231s
  4452  3013 21013.2011   24  317 15913.3709 24141.9652  51.7%   824  235s
  4581  3000 19807.2418   25  218 15913.3709 24141.9652  51.7%   826  241s
  4680  2979 16136.8697   26  177 15913.3709 22942.2502  44.2%   826  245s
  4844  2956     cutoff   28      15913.3709 22942.2502  44.2%   830  252s
  4965  2950 16275.2429   31   77 15913.3709 22260.3507  39.9%   833  256s
  5106  2941 16284.0017   37  150 15913.3709 22260.3507  39.9%   832  262s
  5256  2923 18961.3940   23  188 15913.3709 21862.8817  37.4%   836  268s
  5349  2923 17561.7525   26  166 15913.3709 21756.4764  36.7%   836  273s
  5482  2888 16606.9726   28  173 15913.3709 21756.4764  36.7%   837  276s
  5755  2839 17166.4369   20  208 15913.3709 21468.7002  34.9%   841  282s
  5919  2786     cutoff   22      15913.3709 21308.7324  33.9%   839  285s
  6305  2686 18415.4677   26  136 15913.3709 21022.0668  32.1%   835  291s
  6688  2605 18024.2006   21  178 15913.3709 20447.4412  28.5%   834  298s
  6852  2586 16812.7598   24  194 15913.3709 20304.3239  27.6%   835  301s
  7349  2431 16736.8802   28  249 15913.3709 20216.3744  27.0%   827  307s
  7646  2302 17025.7864   29  123 15913.3709 20172.8766  26.8%   822  311s
  7956  2189 17539.4769   23  254 15913.3709 19714.2330  23.9%   819  316s
  8211  2067 16423.2126   25  266 15913.3709 19714.2330  23.9%   817  320s
  8876  1767     cutoff   26      15913.3709 19101.6232  20.0%   814  328s
  9220  1617     cutoff   29      15913.3709 18934.1144  19.0%   811  333s
  9536  1368 16313.5801   27  322 15913.3709 18818.7391  18.3%   808  337s
 10008   972 16965.3276   34  198 15913.3709 18599.9659  16.9%   800  341s
 10506   733 16531.1973   21  213 15913.3709 17872.9113  12.3%   786  346s
*10748   511              71    15957.586216 17605.6524  10.3%   772  346s
*10757   374              53    15967.230986 17605.6524  10.3%   772  346s
*11117   191              55    15979.384667 17539.7765  9.77%   752  346s
*11566   153              58    16000.863976 16829.4419  5.18%   726  347s
*11681   153              49    16001.421146 16829.4419  5.17%   719  347s
*11683   153              50    16007.553504 16829.4419  5.13%   719  347s
*11950   153              55    16040.789892 16758.3882  4.47%   703  347s
*12251     0              61    16042.608415 16178.9868  0.85%   687  347s
*12252     0              61    16044.507424 16178.9868  0.84%   687  347s

Cutting planes:
  MIR: 268
  Mixing: 1
  Flow cover: 723
  RLT: 15
  Relax-and-lift: 59

Explored 12363 nodes (8473085 simplex iterations) in 347.52 seconds (921.20 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 16044.5 16042.6 16040.8 ... 15913.4

Optimal solution found (tolerance 1.00e-06)
Best objective 1.604450742351e+04, best bound 1.604450742351e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 347.53s
  Master Objective (UB) = 16044.51, θ = 159324.81
  Upper Bound (UB) = 16044.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 159324.81
  [DEBUG]   ✓ Scenario 0: θ = 159324.81 ≤ Q = 159324.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 159324.81 ≤ Q = 159324.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 159324.81 ≤ Q = 159324.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x150e0fae
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x150e0fae
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.238635e+13
Presolve removed 2594 rows and 1883 columns
Presolve time: 0.00s
Presolved: 499 rows, 506 columns, 1410 nonzeros
Found heuristic solution: objective 6130428.5949
Variable types: 341 continuous, 165 integer (165 binary)

Root relaxation: objective -1.489405e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148940.52    0  130 6130428.59 -148940.52   102%     -    0s
H    0     0                    -111909.4010 -148940.52  33.1%     -    0s
H    0     0                    -132198.8408 -148940.52  12.7%     -    0s
     0     0 -135692.23    0   71 -132198.84 -135692.23  2.64%     -    0s
H    0     0                    -134040.2186 -135630.64  1.19%     -    0s
H    0     0                    -134389.4222 -134752.34  0.27%     -    0s
     0     0 -134752.34    0   68 -134389.42 -134752.34  0.27%     -    0s
     0     0 -134641.32    0   54 -134389.42 -134641.32  0.19%     -    0s
     0     0 -134565.83    0   26 -134389.42 -134565.83  0.13%     -    0s
     0     0 -134558.86    0   25 -134389.42 -134558.86  0.13%     -    0s
     0     0 -134558.58    0   25 -134389.42 -134558.58  0.13%     -    0s
     0     0 -134554.60    0   24 -134389.42 -134554.60  0.12%     -    0s
     0     0 -134554.42    0   24 -134389.42 -134554.42  0.12%     -    0s
     0     0 -134473.47    0   10 -134389.42 -134473.47  0.06%     -    0s
     0     0 -134473.47    0   17 -134389.42 -134473.47  0.06%     -    0s
     0     0 -134429.78    0    8 -134389.42 -134429.78  0.03%     -    0s
H    0     0                    -134402.0210 -134425.61  0.02%     -    0s
     0     0 -134425.37    0    6 -134402.02 -134425.37  0.02%     -    0s
     0     0 -134422.24    0    5 -134402.02 -134422.24  0.02%     -    0s
     0     0 -134422.24    0    9 -134402.02 -134422.24  0.02%     -    0s
H    0     0                    -134412.8214 -134422.24  0.01%     -    0s
     0     0 -134422.24    0    2 -134412.82 -134422.24  0.01%     -    0s
*    0     0               0    -134422.1856 -134422.19  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 2
  Flow cover: 3
  Relax-and-lift: 3

Explored 1 nodes (694 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -134422 -134413 -134402 ... 1.23863e+13
No other solutions better than -134422

Optimal solution found (tolerance 1.00e-06)
Best objective -1.344221856346e+05, best bound -1.344221856346e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 137016.05
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -134422.19
  [DEBUG]   S×d_nominal = 271438.24
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 271438.24 + -134422.19 = 137016.05
  [DEBUG]   Current θ from Master = 159324.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22308.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6264.25
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 3454.7457, Absolute Gap = 3454.7457, Relative Gap = 0.215323
  Not converged yet (gap = 3454.75 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178491 nonzeros
Model fingerprint: 0xb79330e2
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -6264.25 (0.04s)
Loaded MIP start from previous solve with objective -6264.25

Presolve removed 26684 rows and 10834 columns
Presolve time: 0.57s
Presolved: 35859 rows, 16386 columns, 221659 nonzeros
Variable types: 14127 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35859 rows, 16386 columns, 221659 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52647    2.5407936e+04   0.000000e+00   8.859185e+07      5s
Concurrent spin time: 2.31s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.951668e+04, 32849 iterations, 8.60 seconds (15.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39516.6766    0  233 -6264.2532 39516.6766   731%     -    9s
H    0     0                    -1710.605525 39516.6766  2410%     -    9s
H    0     0                    -1699.680580 39516.6766  2425%     -    9s
H    0     0                    7355.4917949 39516.6766   437%     -    9s
H    0     0                    8676.4148641 39516.6766   355%     -    9s
H    0     0                    11575.016885 39516.6766   241%     -    9s
H    0     0                    11819.735067 39516.6766   234%     -    9s
H    0     0                    12344.352176 39516.6766   220%     -    9s
H    0     0                    13365.479864 34848.9333   161%     -   13s
     0     0 34848.9333    0  287 13365.4799 34848.9333   161%     -   13s
     0     0 33566.2833    0  280 13365.4799 33566.2833   151%     -   15s
     0     0 33510.8817    0  299 13365.4799 33510.8817   151%     -   15s
     0     0 33510.8103    0  303 13365.4799 33510.8103   151%     -   16s
     0     0 33510.8103    0  299 13365.4799 33510.8103   151%     -   16s
     0     0 33510.8103    0  329 13365.4799 33510.8103   151%     -   16s
     0     0 33510.8103    0  328 13365.4799 33510.8103   151%     -   17s
     0     0 33510.7914    0  328 13365.4799 33510.7914   151%     -   17s
     0     0 31030.9262    0  343 13365.4799 31030.9262   132%     -   21s
H    0     0                    13421.762848 31030.9262   131%     -   21s
H    0     0                    13424.143765 31030.9262   131%     -   21s
     0     0 30384.4064    0  349 13424.1438 30384.4064   126%     -   23s
     0     0 30154.3897    0  368 13424.1438 30154.3897   125%     -   24s
H    0     0                    13471.723832 29770.5173   121%     -   25s
     0     0 29770.5173    0  364 13471.7238 29770.5173   121%     -   25s
     0     0 29695.3617    0  369 13471.7238 29695.3617   120%     -   26s
     0     0 29644.5898    0  371 13471.7238 29644.5898   120%     -   26s
     0     0 29508.0922    0  373 13471.7238 29508.0922   119%     -   27s
     0     0 29482.9778    0  382 13471.7238 29482.9778   119%     -   27s
     0     0 29480.3182    0  385 13471.7238 29480.3182   119%     -   27s
     0     0 29479.4127    0  383 13471.7238 29479.4127   119%     -   27s
     0     0 28581.2033    0  435 13471.7238 28581.2033   112%     -   32s
     0     0 28129.6926    0  422 13471.7238 28129.6926   109%     -   34s
     0     0 27965.4357    0  419 13471.7238 27965.4357   108%     -   35s
     0     0 27867.6291    0  417 13471.7238 27867.6291   107%     -   35s
     0     0 27825.6149    0  430 13471.7238 27825.6149   107%     -   36s
     0     0 27809.9346    0  426 13471.7238 27809.9346   106%     -   36s
     0     0 27775.3753    0  418 13471.7238 27775.3753   106%     -   37s
     0     0 27758.7854    0  426 13471.7238 27758.7854   106%     -   37s
     0     0 27751.7172    0  428 13471.7238 27751.7172   106%     -   37s
     0     0 27746.2631    0  425 13471.7238 27746.2631   106%     -   37s
     0     0 27740.5545    0  422 13471.7238 27740.5545   106%     -   37s
     0     0 27737.4250    0  423 13471.7238 27737.4250   106%     -   38s
     0     0 27736.1781    0  425 13471.7238 27736.1781   106%     -   38s
     0     0 27052.6149    0  451 13471.7238 27052.6149   101%     -   42s
H    0     0                    13502.829301 26858.3161  98.9%     -   44s
H    0     0                    13508.188960 26858.3161  98.8%     -   44s
H    0     0                    13525.023495 26858.3161  98.6%     -   44s
     0     0 26858.3161    0  431 13525.0235 26858.3161  98.6%     -   44s
     0     0 26813.1408    0  441 13525.0235 26813.1408  98.2%     -   45s
     0     0 26792.0686    0  436 13525.0235 26792.0686  98.1%     -   45s
     0     0 26779.3317    0  443 13525.0235 26779.3317  98.0%     -   45s
     0     0 26774.7311    0  438 13525.0235 26774.7311  98.0%     -   46s
     0     0 26770.8140    0  442 13525.0235 26770.8140  97.9%     -   46s
     0     0 26770.1338    0  445 13525.0235 26770.1338  97.9%     -   46s
     0     0 26733.3817    0  434 13525.0235 26733.3817  97.7%     -   47s
H    0     0                    13549.353756 26733.1812  97.3%     -   47s
H    0     0                    13637.993886 26733.1812  96.0%     -   47s
     0     0 26712.2575    0  446 13637.9939 26712.2575  95.9%     -   48s
     0     0 26703.3373    0  454 13637.9939 26703.3373  95.8%     -   48s
     0     0 26702.1613    0  456 13637.9939 26702.1613  95.8%     -   48s
     0     0 26685.8229    0  457 13637.9939 26685.8229  95.7%     -   49s
H    0     0                    13758.781657 26684.5669  93.9%     -   49s
H    0     0                    13768.810923 26684.5669  93.8%     -   49s
     0     0 26678.9106    0  451 13768.8109 26678.9106  93.8%     -   49s
     0     0 26662.6422    0  453 13768.8109 26662.6422  93.6%     -   50s
     0     0 26658.4204    0  460 13768.8109 26658.4204  93.6%     -   50s
     0     0 26657.1099    0  404 13768.8109 26657.1099  93.6%     -   50s
     0     0 26649.9091    0  400 13768.8109 26649.9091  93.6%     -   51s
     0     0 26646.6111    0  441 13768.8109 26646.6111  93.5%     -   51s
     0     0 26641.6011    0  446 13768.8109 26641.6011  93.5%     -   51s
     0     0 26641.0134    0  453 13768.8109 26641.0134  93.5%     -   51s
     0     0 26618.3490    0  446 13768.8109 26618.3490  93.3%     -   52s
     0     0 26613.5489    0  443 13768.8109 26613.5489  93.3%     -   53s
     0     0 26610.9314    0  400 13768.8109 26610.9314  93.3%     -   53s
     0     0 26610.0049    0  445 13768.8109 26610.0049  93.3%     -   53s
     0     0 26606.2543    0  457 13768.8109 26606.2543  93.2%     -   54s
     0     0 26604.2405    0  413 13768.8109 26604.2405  93.2%     -   54s
     0     0 26603.3355    0  403 13768.8109 26603.3355  93.2%     -   54s
     0     0 26600.7190    0  464 13768.8109 26600.7190  93.2%     -   55s
H    0     0                    13790.128372 26600.6982  92.9%     -   56s
     0     0 26599.6651    0  457 13790.1284 26599.6651  92.9%     -   56s
     0     0 26598.4418    0  453 13790.1284 26598.4418  92.9%     -   56s
     0     0 26597.8159    0  453 13790.1284 26597.8159  92.9%     -   57s
H    0     0                    13859.187229 26596.9462  91.9%     -   65s
H    0     2                    13945.321774 26596.9462  90.7%     -   65s
     0     2 26596.9462    0  453 13945.3218 26596.9462  90.7%     -   65s
     7    16 26079.2675    3  494 13945.3218 26251.7162  88.2%  3333   73s
    15    32 25639.4437    4  479 13945.3218 26076.7013  87.0%  3622   77s
    31    59 25582.0179    5  494 13945.3218 25638.8351  83.9%  5082   84s
    58    91 25546.7333    6  502 13945.3218 25581.7025  83.4%  4956   89s
H   61    91                    14050.757301 25546.7185  81.8%  4840   89s
H   86    91                    14992.809619 25546.7185  70.4%  4005   89s
    90   151 25538.4459    7  500 14992.8096 25546.4084  70.4%  3885   94s
   150   183 25478.4060    8  494 14992.8096 25546.4084  70.4%  2796   98s
H  152   183                    15232.988603 25546.4084  67.7%  2763   98s
H  160   183                    15431.517760 25546.4084  65.5%  2667   98s
H  174   183                    15442.944978 25546.4084  65.4%  2546   98s
H  180   183                    15669.842527 25546.4084  63.0%  2496   98s
   182   302 24578.7025    8  481 15669.8425 25546.4084  63.0%  2510  102s
   313   374 25452.0206    9  500 15669.8425 25546.4084  63.0%  1936  108s
   408   455 25380.6256   10  492 15669.8425 25546.4084  63.0%  1826  111s
   499   532 25304.8114   11  505 15669.8425 25546.4084  63.0%  1721  115s
   664   665 24703.8871   13  501 15669.8425 25380.3712  62.0%  1593  121s
   810   779 24162.1645   16  448 15669.8425 25159.2031  60.6%  1542  130s
   973   937 23531.1991   18  417 15669.8425 25159.2031  60.6%  1506  137s
  1079  1018 23438.3018   19  414 15669.8425 25060.4407  59.9%  1458  142s
  1198  1099 22609.4035   21  424 15669.8425 25060.4407  59.9%  1410  146s
  1307  1162 21719.1509   21  341 15669.8425 25048.3107  59.9%  1359  152s
  1440  1192 19473.8514   22  428 15669.8425 25048.3107  59.9%  1329  156s
  1624  1306 20254.1100   24  309 15669.8425 25048.3107  59.9%  1300  163s
  1715  1363 18787.0795   25  256 15669.8425 24912.0194  59.0%  1301  167s
  1840  1449 18293.0202   26  348 15669.8425 24912.0194  59.0%  1291  172s
H 1864  1449                    15913.370903 24912.0194  56.5%  1289  172s
  1960  1523 18126.4485   27  261 15913.3709 24826.2061  56.0%  1278  177s
  2090  1586 infeasible   29      15913.3709 24826.2061  56.0%  1268  180s
  2244  1645 21840.9872   14  413 15913.3709 24826.2061  56.0%  1250  186s
  2402  1692 20275.3545   15  382 15913.3709 24826.2061  56.0%  1239  191s
  2549  1710 23499.2002   14  453 15913.3709 24826.2061  56.0%  1232  195s
  2648  1757 21383.1910   15  316 15913.3709 24781.4774  55.7%  1246  202s
  2704  1784 19912.5694   16  278 15913.3709 24781.4774  55.7%  1251  207s
  2787  1825 21814.3655   16  285 15913.3709 24781.4774  55.7%  1250  213s
  2909  1879 21138.3960   16  300 15913.3709 24781.4774  55.7%  1247  217s
  3016  1959 19863.9746   17  206 15913.3709 24561.4176  54.3%  1250  223s
  3171  2025     cutoff   18      15913.3709 24561.4176  54.3%  1253  228s
  3326  2109 20389.7431   20  277 15913.3709 24513.0895  54.0%  1255  234s
  3502  2203 20216.0525   20  185 15913.3709 24513.0895  54.0%  1255  240s
  3697  2283 20218.5259   21  214 15913.3709 24513.0895  54.0%  1256  246s
  3921  2396 infeasible   24      15913.3709 24513.0895  54.0%  1249  253s
  4142  2478 18261.2381   30  133 15913.3709 24513.0895  54.0%  1239  260s
  4398  2549 16965.3807   35  188 15913.3709 24275.1586  52.5%  1231  266s
  4628  2641 21742.2586   14  388 15913.3709 24179.9874  51.9%  1233  275s
  4822  2792 20374.1528   17  230 15913.3709 24179.9874  51.9%  1245  282s
  5110  2793 21893.1382   23  453 15913.3709 24170.6399  51.9%  1231  299s
  5112  2794 22516.3148   17  233 15913.3709 24170.6399  51.9%  1231  308s
  5113  2795 21010.4240   18  374 15913.3709 24170.6399  51.9%  1231  315s
  5114  2796 19101.7730   26  436 15913.3709 24170.6399  51.9%  1230  320s
  5116  2797 23039.6743   17  468 15913.3709 24170.6399  51.9%  1230  325s
  5119  2799 23194.0541   12  450 15913.3709 24170.6399  51.9%  1229  330s
  5123  2802 19735.1830   16  443 15913.3709 24170.6399  51.9%  1228  335s
  5128  2805 20602.5877   42  373 15913.3709 24170.6399  51.9%  1227  340s
  5132  2808 23375.4795    9  459 15913.3709 24170.6399  51.9%  1226  345s
  5136  2810 22985.5596   11  444 15913.3709 24170.6399  51.9%  1225  350s
  5141  2814 18503.2342   25  447 15913.3709 24170.6399  51.9%  1224  363s
  5142  2814 23059.4973   12  447 15913.3709 24170.6399  51.9%  1224  370s
  5143  2818 24170.6399   13  467 15913.3709 24170.6399  51.9%  1241  378s
  5145  2821 24170.6399   14  466 15913.3709 24170.6399  51.9%  1242  383s
  5149  2828 24170.6399   15  472 15913.3709 24170.6399  51.9%  1243  389s
  5157  2841 24170.6399   16  477 15913.3709 24170.6399  51.9%  1247  396s
  5173  2854 21330.4464   17  370 15913.3709 24170.6399  51.9%  1264  405s
  5197  2878 20923.5799   18  259 15913.3709 24170.6399  51.9%  1289  412s
  5229  2967 20475.7197   19  275 15913.3709 24170.6399  51.9%  1299  419s
  5337  2959 18903.2613   22  229 15913.3709 24170.6399  51.9%  1325  422s
  5372  2990 18533.9410   23  227 15913.3709 24170.6399  51.9%  1333  426s
  5431  3005     cutoff   24      15913.3709 24170.6399  51.9%  1342  433s
  5515  2994 17987.3289   24  255 15913.3709 24170.6399  51.9%  1358  441s
  5593  2998 17771.8282   26  117 15913.3709 24170.6399  51.9%  1382  447s
  5664  3004     cutoff   27      15913.3709 24170.6399  51.9%  1401  452s
  5743  2997     cutoff   30      15913.3709 24170.6399  51.9%  1414  458s
  5819  2994 21200.3887   21  355 15913.3709 24170.6399  51.9%  1425  466s
  5903  3005 20677.1896   23  275 15913.3709 24170.6399  51.9%  1436  470s
  6038  3052 19396.2767   29  220 15913.3709 24170.6399  51.9%  1456  478s
  6124  3070 19263.0720   30  221 15913.3709 24170.6399  51.9%  1459  485s
  6217  3055 18938.1416   33  161 15913.3709 23797.4550  49.5%  1464  490s
  6304  3066 17788.6409   37  142 15913.3709 23797.4550  49.5%  1479  495s
  6392  3051 17107.6938   40  137 15913.3709 23720.3248  49.1%  1491  502s
  6473  3061     cutoff   45      15913.3709 23720.3248  49.1%  1500  507s
  6560  3050 20716.1200   21  351 15913.3709 23478.5992  47.5%  1515  513s
  6625  3048 20052.5156   23  268 15913.3709 23478.5992  47.5%  1521  518s
  6711  3041 19126.0924   25  239 15913.3709 23478.5992  47.5%  1533  525s
  6801  3051 18759.7322   26  225 15913.3709 23413.4105  47.1%  1544  531s
  6904  3049 18263.8006   29  170 15913.3709 23413.4105  47.1%  1560  539s
  7028  3031 17776.5466   32  228 15913.3709 23413.4105  47.1%  1567  545s
  7150  3029 17072.2437   38  126 15913.3709 23375.2485  46.9%  1577  552s
  7275  3057 21067.1052   24  381 15913.3709 22506.5020  41.4%  1597  558s
  7392  3065 19633.0830   27  357 15913.3709 22390.2912  40.7%  1611  564s
  7532  3043 18416.9534   31  279 15913.3709 22390.2912  40.7%  1614  569s
  7640  3053 17335.9672   34  258 15913.3709 22382.7682  40.7%  1623  576s
  7782  3060 19386.4340   21  422 15913.3709 22382.7682  40.7%  1628  582s
  7936  3055 19037.4918   23  415 15913.3709 22382.7682  40.7%  1636  589s
  8101  3019 18454.2071   26  216 15913.3709 21512.6067  35.2%  1644  594s
  8284  2960 17166.7223   29  253 15913.3709 21301.1370  33.9%  1651  600s
  8345  2947     cutoff   30      15913.3709 21171.5961  33.0%  1654  606s
  8409  2948 17593.5781   29  209 15913.3709 21171.5961  33.0%  1660  612s
  8463  2946 17494.5122   30  217 15913.3709 21171.5961  33.0%  1667  619s
  8587  2938 17303.6856   31  202 15913.3709 21171.5961  33.0%  1673  626s
  8720  2916 16799.3979   35  312 15913.3709 21171.5961  33.0%  1680  635s
  8909  2912 16523.9743   37  273 15913.3709 21021.9509  32.1%  1684  643s
  9136  2883 18391.7888   27  316 15913.3709 20922.2148  31.5%  1698  652s
  9390  2864     cutoff   29      15913.3709 20922.2148  31.5%  1707  661s
  9667  2835 17004.1689   28  234 15913.3709 20527.5672  29.0%  1717  669s
 10003  2753 16242.8598   21  306 15913.3709 20463.2145  28.6%  1722  679s
 10174  2732     cutoff   23      15913.3709 20201.2415  26.9%  1732  688s
 10517  2640 16494.9263   28  129 15913.3709 20169.0092  26.7%  1737  697s
 10860  2563 16102.8418   22  293 15913.3709 19959.8160  25.4%  1752  708s
 11240  2421     cutoff   27      15913.3709 19798.6422  24.4%  1760  719s
 11615  2292 17499.7333   29  305 15913.3709 19610.4717  23.2%  1774  729s
 11992  2139 16377.5884   29  164 15913.3709 19383.5020  21.8%  1786  740s
 12444  1971     cutoff   30      15913.3709 19152.9197  20.4%  1785  751s
 12932  1715 16583.5434   39  188 15913.3709 18978.6364  19.3%  1784  762s
 13428  1425     cutoff   35      15913.3709 18755.2879  17.9%  1786  773s
 13988  1111 16597.5191   26  318 15913.3709 18582.3705  16.8%  1780  785s
 14608   587 infeasible   22      15913.3709 18238.5194  14.6%  1769  797s
 15504    20 16057.6639   25  233 15913.3709 17814.4274  11.9%  1726  806s
 16203     5 16617.1548   29  183 15913.3709 17066.4451  7.25%  1680  816s

Cutting planes:
  Learned: 3
  MIR: 402
  Mixing: 1
  Flow cover: 880
  RLT: 31
  Relax-and-lift: 79

Explored 16235 nodes (27328435 simplex iterations) in 816.32 seconds (2484.78 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15913.4 15669.8 15442.9 ... 13790.1

Optimal solution found (tolerance 1.00e-06)
Best objective 1.591337090305e+04, best bound 1.591337090305e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 816.34s
  Master Objective (UB) = 15913.37, θ = 159235.17
  Upper Bound (UB) = 15913.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 159235.17
  [DEBUG]   ✓ Scenario 0: θ = 159235.17 ≤ Q = 159235.17 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 159235.17 ≤ Q = 159235.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 159235.17 ≤ Q = 159235.17 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 159235.17 ≤ Q = 159235.17 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3e5a1f1d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3e5a1f1d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.329427e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6654294.4674
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.495796e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149579.60    0  127 6654294.47 -149579.60   102%     -    0s
H    0     0                    -110237.8747 -149579.60  35.7%     -    0s
H    0     0                    -120453.3236 -149579.60  24.2%     -    0s
H    0     0                    -127476.3117 -128940.81  1.15%     -    0s
     0     0 -128940.81    0   76 -127476.31 -128940.81  1.15%     -    0s
H    0     0                    -127607.1994 -128583.72  0.77%     -    0s
     0     0 -128583.72    0   80 -127607.20 -128583.72  0.77%     -    0s
     0     0 -128579.81    0   80 -127607.20 -128579.81  0.76%     -    0s
     0     0 -128319.73    0   60 -127607.20 -128319.73  0.56%     -    0s
     0     0 -128190.64    0   58 -127607.20 -128190.64  0.46%     -    0s
     0     0 -128190.04    0   58 -127607.20 -128190.04  0.46%     -    0s
     0     0 -127956.79    0   31 -127607.20 -127956.79  0.27%     -    0s
     0     0 -127956.76    0   30 -127607.20 -127956.76  0.27%     -    0s
H    0     0                    -127688.6135 -127934.18  0.19%     -    0s
     0     0 -127934.18    0   34 -127688.61 -127934.18  0.19%     -    0s
     0     0 -127934.18    0   33 -127688.61 -127934.18  0.19%     -    0s
     0     0 -127903.27    0   29 -127688.61 -127903.27  0.17%     -    0s
     0     0 -127900.25    0   31 -127688.61 -127900.25  0.17%     -    0s
     0     0 -127778.12    0   15 -127688.61 -127778.12  0.07%     -    0s
     0     0 -127778.12    0   16 -127688.61 -127778.12  0.07%     -    0s
     0     0 -127739.96    0   10 -127688.61 -127739.96  0.04%     -    0s
H    0     0                    -127714.5511 -127737.21  0.02%     -    0s
     0     0 -127737.21    0    6 -127714.55 -127737.21  0.02%     -    0s
     0     0 -127728.90    0    2 -127714.55 -127728.90  0.01%     -    0s
     0     0 -127728.90    0    2 -127714.55 -127728.90  0.01%     -    0s
H    0     0                    -127724.5229 -127728.90  0.00%     -    0s
     0     0 -127726.18    0    4 -127724.52 -127726.18  0.00%     -    0s
     0     0     cutoff    0      -127724.52 -127724.52  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  Flow cover: 2

Explored 1 nodes (791 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -127725 -127715 -127705 ... 1.32943e+13
No other solutions better than -127725

Optimal solution found (tolerance 1.00e-06)
Best objective -1.277245228811e+05, best bound -1.277245228811e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 145136.30
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127724.52
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -127724.52 = 145136.30
  [DEBUG]   Current θ from Master = 159235.17
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14098.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1814.50
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 3323.6092, Absolute Gap = 3323.6092, Relative Gap = 0.208856
  Not converged yet (gap = 3323.61 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221734 nonzeros
Model fingerprint: 0x6f40b2b6
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33350 rows and 13540 columns
Presolve time: 0.69s
Presolved: 44483 rows, 19920 columns, 275709 nonzeros
Variable types: 17661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 44483 rows, 19920 columns, 275709 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   29607    9.7535044e+03   0.000000e+00   8.782414e+06      5s
   42636    2.7174407e+04   0.000000e+00   5.082567e+06     10s
Concurrent spin time: 3.16s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.951668e+04, 43641 iterations, 14.82 seconds (27.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39516.6753    0  236 -190754.47 39516.6753   121%     -   15s
H    0     0                    -178946.3584 39516.6753   122%     -   15s
H    0     0                    -170355.5431 39516.6753   123%     -   16s
H    0     0                    -167114.5159 39516.6753   124%     -   16s
H    0     0                    -166759.6328 39516.6753   124%     -   16s
H    0     0                    -164734.7578 39516.6753   124%     -   16s
H    0     0                    -164689.4873 39516.6753   124%     -   16s
H    0     0                    -164678.2952 39516.6753   124%     -   16s
H    0     0                    -164665.2678 39516.6753   124%     -   16s
H    0     0                    -74725.89547 39516.6753   153%     -   16s
H    0     0                    -74418.27002 39516.6753   153%     -   16s
H    0     0                    -74404.08300 39516.6753   153%     -   16s
H    0     0                    -36194.75864 39516.6753   209%     -   16s
H    0     0                    -35588.25899 39516.6753   211%     -   16s
H    0     0                    -15804.41011 39516.6753   350%     -   16s
H    0     0                    -15401.75113 39516.6753   357%     -   17s
H    0     0                    -15377.58807 39516.6753   357%     -   17s
H    0     0                    10761.810258 34817.9544   224%     -   20s
     0     0 34817.9544    0  286 10761.8103 34817.9544   224%     -   20s
H    0     0                    11816.435400 34817.8439   195%     -   20s
H    0     0                    12092.991926 34817.8439   188%     -   20s
     0     0 33616.6294    0  288 12092.9919 33616.6294   178%     -   24s
     0     0 33544.9220    0  322 12092.9919 33544.9220   177%     -   24s
     0     0 33532.3619    0  324 12092.9919 33532.3619   177%     -   25s
     0     0 33514.3220    0  326 12092.9919 33514.3220   177%     -   25s
     0     0 33513.0347    0  328 12092.9919 33513.0347   177%     -   25s
     0     0 33513.0347    0  323 12092.9919 33513.0347   177%     -   26s
     0     0 33513.0347    0  325 12092.9919 33513.0347   177%     -   26s
     0     0 33513.0347    0  325 12092.9919 33513.0347   177%     -   26s
     0     0 30902.8183    0  354 12092.9919 30902.8183   156%     -   30s
     0     0 29982.3496    0  353 12092.9919 29982.3496   148%     -   33s
     0     0 29672.0880    0  363 12092.9919 29672.0880   145%     -   35s
     0     0 29578.6597    0  371 12092.9919 29578.6597   145%     -   36s
     0     0 29508.0604    0  378 12092.9919 29508.0604   144%     -   37s
     0     0 29489.4043    0  383 12092.9919 29489.4043   144%     -   37s
     0     0 29467.8922    0  387 12092.9919 29467.8922   144%     -   38s
     0     0 29462.7173    0  393 12092.9919 29462.7173   144%     -   38s
     0     0 29404.7716    0  381 12092.9919 29404.7716   143%     -   39s
     0     0 29397.0236    0  385 12092.9919 29397.0236   143%     -   39s
     0     0 29341.8979    0  374 12092.9919 29341.8979   143%     -   40s
     0     0 29340.7873    0  376 12092.9919 29340.7873   143%     -   40s
     0     0 29340.6680    0  376 12092.9919 29340.6680   143%     -   40s
     0     0 28261.8656    0  437 12092.9919 28261.8656   134%     -   45s
H    0     0                    12185.721947 28261.2664   132%     -   45s
H    0     0                    12346.726427 28261.2664   129%     -   45s
H    0     0                    12827.688359 28261.2664   120%     -   45s
     0     0 27766.7254    0  426 12827.6884 27766.7254   116%     -   49s
     0     0 27616.3207    0  444 12827.6884 27616.3207   115%     -   51s
     0     0 27578.3568    0  436 12827.6884 27578.3568   115%     -   53s
     0     0 27567.8555    0  446 12827.6884 27567.8555   115%     -   53s
     0     0 27555.7681    0  445 12827.6884 27555.7681   115%     -   53s
     0     0 27543.4501    0  442 12827.6884 27543.4501   115%     -   54s
     0     0 27542.7780    0  443 12827.6884 27542.7780   115%     -   54s
     0     0 27016.2689    0  452 12827.6884 27016.2689   111%     -   59s
     0     0 26872.0766    0  461 12827.6884 26872.0766   109%     -   61s
H    0     0                    12879.923949 26765.4431   108%     -   62s
     0     0 26765.4431    0  467 12879.9239 26765.4431   108%     -   62s
     0     0 26743.5424    0  453 12879.9239 26743.5424   108%     -   63s
H    0     0                    14040.146389 26717.3209  90.3%     -   64s
     0     0 26717.3209    0  462 14040.1464 26717.3209  90.3%     -   64s
     0     0 26698.7653    0  460 14040.1464 26698.7653  90.2%     -   65s
     0     0 26696.5555    0  458 14040.1464 26696.5555  90.1%     -   65s
     0     0 26692.2834    0  456 14040.1464 26692.2834  90.1%     -   65s
     0     0 26690.8799    0  496 14040.1464 26690.8799  90.1%     -   65s
     0     0 26663.9188    0  448 14040.1464 26663.9188  89.9%     -   67s
     0     0 26652.4779    0  453 14040.1464 26652.4779  89.8%     -   67s
     0     0 26644.4393    0  450 14040.1464 26644.4393  89.8%     -   68s
     0     0 26642.5861    0  453 14040.1464 26642.5861  89.8%     -   68s
     0     0 26641.9156    0  454 14040.1464 26641.9156  89.8%     -   68s
     0     0 26631.3759    0  452 14040.1464 26631.3759  89.7%     -   69s
H    0     0                    14775.078649 26630.2822  80.2%     -   70s
     0     0 26626.1796    0  459 14775.0786 26626.1796  80.2%     -   71s
     0     0 26622.2803    0  448 14775.0786 26622.2803  80.2%     -   71s
     0     0 26620.4833    0  454 14775.0786 26620.4833  80.2%     -   71s
     0     0 26620.0103    0  460 14775.0786 26620.0103  80.2%     -   71s
     0     0 26609.1159    0  449 14775.0786 26609.1159  80.1%     -   72s
H    0     0                    14946.506463 26608.8632  78.0%     -   72s
     0     0 26595.4749    0  459 14946.5065 26595.4749  77.9%     -   73s
     0     0 26591.2477    0  461 14946.5065 26591.2477  77.9%     -   73s
     0     0 26590.4368    0  462 14946.5065 26590.4368  77.9%     -   73s
     0     0 26584.9674    0  464 14946.5065 26584.9674  77.9%     -   74s
H    0     0                    14965.441507 26584.7452  77.6%     -   76s
     0     0 26584.4720    0  466 14965.4415 26584.4720  77.6%     -   76s
     0     0 26582.5337    0  475 14965.4415 26582.5337  77.6%     -   77s
     0     0 26581.7771    0  466 14965.4415 26581.7771  77.6%     -   77s
     0     0 26580.4113    0  471 14965.4415 26580.4113  77.6%     -   78s
     0     0 26579.1907    0  464 14965.4415 26579.1907  77.6%     -   78s
     0     0 26578.9805    0  470 14965.4415 26578.9805  77.6%     -   78s
     0     0 26575.1972    0  470 14965.4415 26575.1972  77.6%     -   79s
H    0     0                    15014.995140 26575.1013  77.0%     -   84s
H    0     0                    15050.316197 26575.1013  76.6%     -   84s
     0     2 26575.1013    0  470 15050.3162 26575.1013  76.6%     -   91s
     3     8 26271.9821    2  454 15050.3162 26432.9928  75.6%  2733   97s
     7    16 25814.7009    3  411 15050.3162 26347.4969  75.1%  3625  104s
    15    32 25463.7026    4  550 15050.3162 25814.2150  71.5%  5156  109s
    31    50 24833.1153    5  485 15050.3162 25463.6437  69.2%  6449  119s
    49    82 23844.0589    6  456 15050.3162 25463.6437  69.2%  7769  124s
H   53    82                    15149.009119 25463.6437  68.1%  7350  124s
    81   165 23707.0443    7  445 15149.0091 25463.6437  68.1%  5806  131s
   170   285 23686.2984    9  440 15149.0091 25463.6437  68.1%  3437  137s
   300   353 23515.1240   13  433 15149.0091 25463.6437  68.1%  2563  144s
   385   423 23218.6283   13  426 15149.0091 25463.6437  68.1%  2351  151s
   480   482 22842.5069   11  470 15149.0091 25463.6437  68.1%  2124  157s
H  481   482                    15196.007056 25463.6437  67.6%  2120  157s
   559   533 23276.9214   14  418 15196.0071 25463.6437  67.6%  1979  164s
   649   572 21583.6816   24  275 15196.0071 25463.6437  67.6%  1863  169s
H  651   572                    15524.742178 25463.6437  64.0%  1857  169s
H  670   572                    15611.034974 25463.6437  63.1%  1837  169s
   714   640 22809.9214   14  413 15611.0350 25463.6437  63.1%  1813  176s
   801   697 19724.5027   14  413 15611.0350 25463.6437  63.1%  1737  182s
   870   769 18365.6405   14  156 15611.0350 25463.6437  63.1%  1693  186s
  1063   859 21865.6294   17  223 15611.0350 25463.6437  63.1%  1542  194s
  1130   913 20895.9777   16  399 15611.0350 25285.8222  62.0%  1527  200s
  1222   980 20957.9200   19  270 15611.0350 25285.8222  62.0%  1495  205s
  1326  1009 infeasible   19      15611.0350 25285.8222  62.0%  1469  210s
  1387  1048 20329.0672   20  261 15611.0350 25285.8222  62.0%  1458  215s
  1448  1098 20023.1909   22  254 15611.0350 25285.8222  62.0%  1470  221s
H 1471  1098                    15636.684354 25285.8222  61.7%  1466  221s
  1527  1158 18684.6250   24  106 15636.6844 25058.9930  60.3%  1483  227s
  1635  1233 18055.6664   30   74 15636.6844 25058.9930  60.3%  1463  231s
  1756  1284 16916.9129   37   39 15636.6844 25058.9930  60.3%  1436  238s
H 1786  1284                    15654.696266 25058.9930  60.1%  1425  238s
  1862  1365     cutoff   40      15654.6963 24592.6627  57.1%  1418  243s
  1993  1416 21919.0756   10  318 15654.6963 24592.6627  57.1%  1409  249s
  2105  1482 21359.0817   12  274 15654.6963 24284.1418  55.1%  1419  256s
  2259  1542 21016.5701   15  241 15654.6963 24167.7941  54.4%  1443  265s
  2358  1593 20343.8124   16  295 15654.6963 24167.7941  54.4%  1440  273s
  2485  1643 20062.7992   17  235 15654.6963 24167.7941  54.4%  1441  279s
  2635  1718 18599.3878   19  164 15654.6963 24167.7941  54.4%  1430  283s
  2770  1781     cutoff   25      15654.6963 24167.7941  54.4%  1433  291s
  2951  1829     cutoff   31      15654.6963 23873.2426  52.5%  1429  297s
  3092  1915 infeasible   36      15654.6963 23734.1545  51.6%  1429  304s
  3267  1988 20995.4646    9  277 15654.6963 23734.1343  51.6%  1423  311s
  3453  2061 16191.3297   10  162 15654.6963 23734.1343  51.6%  1423  317s
  3650  2122 20825.2815   10  183 15654.6963 23544.8899  50.4%  1419  324s
  3815  2189 16150.5665   11  157 15654.6963 23441.9350  49.7%  1432  332s
  4013  2257 infeasible   15      15654.6963 23441.9350  49.7%  1430  338s
  4237  2316 20224.4723   12  268 15654.6963 23441.9350  49.7%  1412  346s
  4488  2367 18769.5286   18  142 15654.6963 23441.9350  49.7%  1398  354s
  4722  2459 16881.3102   24  150 15654.6963 23232.8888  48.4%  1396  364s
  4950  2519 20753.9586   14  211 15654.6963 23152.8620  47.9%  1397  374s
  5199  2552 19475.7904   19  232 15654.6963 23137.3442  47.8%  1397  383s
  5284  2603 19259.4141   20  264 15654.6963 23137.3442  47.8%  1408  393s
  5405  2706 17135.6934   23  201 15654.6963 23137.3442  47.8%  1410  403s
  5669  2707 17214.0901   38  470 15654.6963 23084.7527  47.5%  1408  448s
  5671  2708 19829.7693   16  236 15654.6963 23084.7527  47.5%  1408  460s
  5672  2709 21646.2178   14  401 15654.6963 23084.7527  47.5%  1408  471s
  5673  2710 16414.9532   15  440 15654.6963 23084.7527  47.5%  1407  478s
  5674  2710 21254.3685    8  465 15654.6963 23084.7527  47.5%  1407  482s
  5675  2711 21001.9835   22  471 15654.6963 23084.7527  47.5%  1407  486s
  5677  2712 16640.3533   25  464 15654.6963 23084.7527  47.5%  1406  491s
  5680  2714 19400.0615   16  472 15654.6963 23084.7527  47.5%  1406  495s
  5684  2717 19888.1979   10  488 15654.6963 23084.7527  47.5%  1405  501s
  5686  2718 17341.8471   35  499 15654.6963 23084.7527  47.5%  1404  506s
  5689  2720 20134.2637   17  472 15654.6963 23084.7527  47.5%  1403  511s
  5691  2722 20205.1855   17  514 15654.6963 23084.7527  47.5%  1403  516s
  5693  2723 21933.0282    9  514 15654.6963 23084.7527  47.5%  1402  520s
  5696  2725 18404.3296   20  506 15654.6963 23084.7527  47.5%  1402  534s
  5697  2726 17726.6465   14  506 15654.6963 23084.7527  47.5%  1401  545s
  5698  2729 23084.7527   12  490 15654.6963 23084.7527  47.5%  1422  555s
  5700  2733 23084.7527   13  508 15654.6963 23084.7527  47.5%  1423  564s
  5704  2739 23084.7527   14  509 15654.6963 23084.7527  47.5%  1426  572s
  5712  2751 23084.7527   15  503 15654.6963 23084.7527  47.5%  1433  580s
  5728  2756 22409.0918   16  382 15654.6963 23084.7527  47.5%  1450  595s
  5743  2777 19617.3238   17  372 15654.6963 23084.7527  47.5%  1473  609s
  5775  2850 19301.0517   18  381 15654.6963 23084.7527  47.5%  1498  623s
  5865  2894 18515.8300   23  290 15654.6963 23084.7527  47.5%  1552  631s
  5952  2886 17020.9561   26  296 15654.6963 23084.7527  47.5%  1568  637s
  5997  2900 16882.6844   27  224 15654.6963 23084.7527  47.5%  1572  642s
  6076  2898 16855.1547   28  222 15654.6963 23084.7527  47.5%  1569  649s
  6153  2902     cutoff   30      15654.6963 23084.7527  47.5%  1574  655s
  6231  2906 15730.7693   30  234 15654.6963 23084.7527  47.5%  1577  663s
  6309  2914     cutoff   31      15654.6963 23084.7527  47.5%  1587  671s
  6376  2941 19663.6192   19  422 15654.6963 23084.7527  47.5%  1598  677s
  6441  2948 19313.4650   20  410 15654.6963 23084.7527  47.5%  1603  683s
  6511  2948 18752.7408   21  359 15654.6963 23084.7527  47.5%  1606  690s
  6594  2948     cutoff   22      15654.6963 23084.7527  47.5%  1609  697s
  6674  2938 17239.3749   24  304 15654.6963 23084.7527  47.5%  1615  705s
  6756  2920 infeasible   26      15654.6963 23084.7527  47.5%  1622  713s
  6822  2920 17760.6180   20  382 15654.6963 23084.7527  47.5%  1630  719s
  6893  2909 17662.9769   21  384 15654.6963 23084.7527  47.5%  1635  727s
  6971  2914 16833.7081   24  324 15654.6963 23084.7527  47.5%  1640  736s
  7047  2934 16484.4005   27  250 15654.6963 23084.7527  47.5%  1647  744s
  7122  2943 16060.5747   31  116 15654.6963 23084.7527  47.5%  1655  751s
  7225  2953 18997.4082   19  332 15654.6963 23084.7527  47.5%  1659  759s
  7337  2955 17785.1790   23  311 15654.6963 23084.7527  47.5%  1663  766s
  7438  2970 16368.5464   27  164 15654.6963 23084.7527  47.5%  1666  775s
  7571  2971 19515.9636   27  348 15654.6963 22408.2213  43.1%  1670  783s
  7699  2965 19080.3276   29  268 15654.6963 22259.0871  42.2%  1671  791s
  7842  2934 18084.7498   30  213 15654.6963 22196.8549  41.8%  1673  796s
  7882  2933 17218.8894   31  262 15654.6963 22196.8549  41.8%  1677  803s
  7947  2934 16479.4534   31  168 15654.6963 22196.8549  41.8%  1676  810s
  8026  2923 16243.2861   32  177 15654.6963 22196.8549  41.8%  1678  820s
  8142  2899     cutoff   32      15654.6963 21602.6338  38.0%  1681  828s
  8278  2889 19730.6887   23  263 15654.6963 21599.4462  38.0%  1683  837s
  8446  2866 18112.2955   27  290 15654.6963 21599.4462  38.0%  1686  846s
  8650  2833 17103.0918   20  264 15654.6963 21418.9347  36.8%  1685  858s
  8832  2796 16526.3726   24  219 15654.6963 21285.0660  36.0%  1689  868s
  9019  2813 17972.2637   19  207 15654.6963 21041.5430  34.4%  1690  878s
  9217  2801 16631.3098   25  221 15654.6963 20874.4218  33.3%  1691  887s
  9448  2781     cutoff   22      15654.6963 20749.2331  32.5%  1690  898s
  9677  2739 16642.4235   27  302 15654.6963 20719.3182  32.4%  1691  906s
  9727  2769 16230.8061   28  209 15654.6963 20681.1812  32.1%  1690  917s
* 9852  2591              34    15707.728536 20681.1812  31.7%  1692  917s
  9955  2593 17970.9331   20  352 15707.7285 20681.1812  31.7%  1687  930s
 10222  2530     cutoff   24      15707.7285 20487.7580  30.4%  1687  942s
 10510  2479 16534.9599   26  199 15707.7285 20249.7342  28.9%  1688  954s
 10788  2423     cutoff   25      15707.7285 20157.9747  28.3%  1691  967s
 11111  2376 19382.6860   24  230 15707.7285 20094.0088  27.9%  1690  978s
 11512  2247     cutoff   30      15707.7285 20094.0088  27.9%  1680  992s
 11903  2162 18259.7868   29  308 15707.7285 19581.5684  24.7%  1675 1006s
 12279  2036 16820.4353   30  346 15707.7285 19447.6461  23.8%  1676 1019s
 12727  1865 17479.2702   27  181 15707.7285 19340.7676  23.1%  1668 1033s
 13194  1720 16988.3746   27  268 15707.7285 19028.9497  21.1%  1660 1049s
 13650  1555 16572.1116   30  157 15707.7285 18832.3716  19.9%  1656 1067s
 14153  1488     cutoff   30      15707.7285 18795.3605  19.7%  1650 1081s
 14616  1363 16037.6949   30  174 15707.7285 18471.2587  17.6%  1645 1097s
 15221  1173     cutoff   26      15707.7285 18232.4879  16.1%  1631 1113s
 15883   582 16460.3776   34  105 15707.7285 17971.9455  14.4%  1616 1131s
 16813    21 infeasible   23      15707.7285 17440.2550  11.0%  1575 1144s
 17627     0     cutoff   30      15707.7285 16370.0530  4.22%  1524 1145s

Cutting planes:
  Learned: 1
  MIR: 481
  Mixing: 3
  Flow cover: 1283
  RLT: 29
  Relax-and-lift: 109

Explored 17652 nodes (27002536 simplex iterations) in 1145.54 seconds (3455.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15707.7 15654.7 15636.7 ... 14965.4

Optimal solution found (tolerance 1.00e-06)
Best objective 1.570772853554e+04, best bound 1.570772853554e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1145.57s
  Master Objective (UB) = 15707.73, θ = 161456.93
  Upper Bound (UB) = 15707.73

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161456.93
  [DEBUG]   ✓ Scenario 0: θ = 161456.93 ≤ Q = 161456.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161456.93 ≤ Q = 161456.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 161456.93 ≤ Q = 161456.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 161456.93 ≤ Q = 161456.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 161456.93 ≤ Q = 161456.93 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5151dfab
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaeae2055
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-16, 2e+02]
Found heuristic solution: objective 1.337712e+13
Presolve removed 2588 rows and 1890 columns
Presolve time: 0.00s
Presolved: 505 rows, 499 columns, 1414 nonzeros
Found heuristic solution: objective 6068268.7259
Variable types: 333 continuous, 166 integer (166 binary)
Found heuristic solution: objective 6067932.0253

Root relaxation: objective -1.467523e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146752.25    0  126 6067932.03 -146752.25   102%     -    0s
H    0     0                    -105824.5987 -146752.25  38.7%     -    0s
H    0     0                    -114539.6720 -146752.25  28.1%     -    0s
H    0     0                    -114785.5073 -146752.25  27.8%     -    0s
H    0     0                    -114839.1436 -146516.24  27.6%     -    0s
H    0     0                    -115812.1514 -130794.23  12.9%     -    0s
H    0     0                    -121819.2623 -130794.23  7.37%     -    0s
     0     0 -130794.23    0   62 -121819.26 -130794.23  7.37%     -    0s
H    0     0                    -129596.6787 -130790.81  0.92%     -    0s
H    0     0                    -129737.2478 -130464.80  0.56%     -    0s
     0     0 -130464.80    0   63 -129737.25 -130464.80  0.56%     -    0s
     0     0 -130457.74    0   63 -129737.25 -130457.74  0.56%     -    0s
     0     0 -129974.05    0   27 -129737.25 -129974.05  0.18%     -    0s
     0     0 -129954.98    0   19 -129737.25 -129954.98  0.17%     -    0s
     0     0 -129953.65    0   21 -129737.25 -129953.65  0.17%     -    0s
     0     0 -129938.74    0   22 -129737.25 -129938.74  0.16%     -    0s
     0     0 -129936.74    0   22 -129737.25 -129936.74  0.15%     -    0s
     0     0 -129931.40    0   20 -129737.25 -129931.40  0.15%     -    0s
     0     0 -129929.53    0   20 -129737.25 -129929.53  0.15%     -    0s
     0     0 -129810.31    0    9 -129737.25 -129810.31  0.06%     -    0s
     0     0 -129810.31    0   16 -129737.25 -129810.31  0.06%     -    0s
H    0     0                    -129741.6380 -129810.31  0.05%     -    0s
     0     0 -129769.60    0    7 -129741.64 -129769.60  0.02%     -    0s
H    0     0                    -129751.3000 -129768.96  0.01%     -    0s
H    0     0                    -129756.8811 -129768.11  0.01%     -    0s
H    0     0                    -129759.4889 -129768.11  0.01%     -    0s
     0     0 -129768.11    0    5 -129759.49 -129768.11  0.01%     -    0s
     0     0 -129761.76    0    5 -129759.49 -129761.76  0.00%     -    0s
     0     0 -129761.76    0    6 -129759.49 -129761.76  0.00%     -    0s
     0     0 -129761.76    0    4 -129759.49 -129761.76  0.00%     -    0s
     0     0 -129761.05    0    2 -129759.49 -129761.05  0.00%     -    0s
H    0     0                    -129761.0500 -129761.05  0.00%     -    0s

Cutting planes:
  MIR: 3
  Flow cover: 1

Explored 1 nodes (680 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -129761 -129759 -129757 ... -121819
No other solutions better than -129761

Optimal solution found (tolerance 1.00e-06)
Best objective -1.297610500108e+05, best bound -1.297610500108e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 141792.47
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129761.05
  [DEBUG]   S×d_nominal = 271553.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 271553.52 + -129761.05 = 141792.47
  [DEBUG]   Current θ from Master = 161456.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19664.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3956.73
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 3117.9668, Absolute Gap = 3117.9668, Relative Gap = 0.198499
  Not converged yet (gap = 3117.97 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264977 nonzeros
Model fingerprint: 0x09604924
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40036 rows and 16256 columns
Presolve time: 0.87s
Presolved: 53087 rows, 23444 columns, 329699 nonzeros
Variable types: 21185 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53087 rows, 23444 columns, 329699 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32460   -2.7116266e+03   0.000000e+00   2.480913e+08      5s
   48466    2.4537056e+04   0.000000e+00   1.255742e+09     10s
Concurrent spin time: 0.12s

Solved with dual simplex

Root relaxation: objective 3.947916e+04, 31019 iterations, 9.54 seconds (20.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39479.1592    0  238 -190754.47 39479.1592   121%     -   10s
H    0     0                    -178946.3584 39479.1592   122%     -   10s
H    0     0                    -76415.21885 39479.1592   152%     -   11s
H    0     0                    -76068.31335 39479.1592   152%     -   11s
H    0     0                    -75732.21857 39479.1592   152%     -   11s
H    0     0                    -46001.98012 39479.1592   186%     -   11s
H    0     0                    -24545.70966 39479.1592   261%     -   11s
H    0     0                    -21229.54283 39479.1592   286%     -   11s
H    0     0                    -21224.61064 39479.1592   286%     -   11s
H    0     0                    -16039.82632 39479.1592   346%     -   12s
H    0     0                    -11622.60947 34901.2160   400%     -   17s
H    0     0                    -5156.986779 34901.2160   777%     -   17s
H    0     0                    -4921.472468 34901.2160   809%     -   17s
     0     0 34841.5064    0  277 -4921.4725 34841.5064   808%     -   17s
H    0     0                      84.7262878 34841.5064      -     -   17s
H    0     0                    1392.8939167 34841.5064  2401%     -   17s
H    0     0                    1966.3350134 34841.5064  1672%     -   17s
H    0     0                    2293.2236131 34841.5064  1419%     -   17s
H    0     0                    2394.8038225 34841.5064  1355%     -   17s
H    0     0                    2728.4644120 34841.5064  1177%     -   17s
H    0     0                    2765.5462406 34841.5064  1160%     -   17s
H    0     0                    2804.7285947 34841.5064  1142%     -   17s
H    0     0                    2809.5259989 34841.5064  1140%     -   17s
H    0     0                    2824.2620033 34841.5064  1134%     -   17s
H    0     0                    2963.6125933 34841.5064  1076%     -   17s
     0     0 33391.3354    0  279 2963.61259 33391.3354  1027%     -   20s
     0     0 33324.6932    0  281 2963.61259 33324.6932  1024%     -   22s
     0     0 33312.3743    0  283 2963.61259 33312.3743  1024%     -   23s
     0     0 33312.3743    0  287 2963.61259 33312.3743  1024%     -   24s
     0     0 33312.3743    0  301 2963.61259 33312.3743  1024%     -   24s
     0     0 33312.3743    0  298 2963.61259 33312.3743  1024%     -   25s
     0     0 33312.3743    0  298 2963.61259 33312.3743  1024%     -   25s
H    0     0                    3659.3978661 30860.4836   743%     -   35s
H    0     0                    4154.9653826 30860.4836   643%     -   35s
H    0     0                    4213.6369207 30860.4836   632%     -   35s
H    0     0                    4244.5097723 30860.4836   627%     -   35s
H    0     0                    4279.2800180 30860.4836   621%     -   35s
     0     0 30603.2977    0  362 4279.28002 30603.2977   615%     -   35s
H    0     0                    8802.2014590 30603.2977   248%     -   35s
H    0     0                    9153.1123937 30140.1374   229%     -   40s
     0     0 30140.1374    0  392 9153.11239 30140.1374   229%     -   40s
     0     0 29918.5780    0  381 9153.11239 29918.5780   227%     -   43s
     0     0 29836.4773    0  408 9153.11239 29836.4773   226%     -   45s
     0     0 29782.3479    0  403 9153.11239 29782.3479   225%     -   46s
     0     0 29559.2500    0  389 9153.11239 29559.2500   223%     -   48s
     0     0 29506.4461    0  392 9153.11239 29506.4461   222%     -   49s
     0     0 29373.1376    0  378 9153.11239 29373.1376   221%     -   52s
     0     0 29281.4527    0  400 9153.11239 29281.4527   220%     -   53s
     0     0 29269.0164    0  403 9153.11239 29269.0164   220%     -   54s
     0     0 29244.7969    0  414 9153.11239 29244.7969   220%     -   55s
     0     0 29241.4878    0  412 9153.11239 29241.4878   219%     -   56s
     0     0 29240.4038    0  414 9153.11239 29240.4038   219%     -   56s
     0     0 29237.5360    0  393 9153.11239 29237.5360   219%     -   56s
     0     0 29236.2274    0  416 9153.11239 29236.2274   219%     -   56s
     0     0 29235.7065    0  416 9153.11239 29235.7065   219%     -   57s
H    0     0                    9387.3409411 29235.7065   211%     -   60s
H    0     0                    9484.8028446 29235.7065   208%     -   60s
H    0     0                    9549.4285355 29235.7065   206%     -   60s
H    0     0                    9638.1998038 29235.7065   203%     -   60s
     0     0 28287.7444    0  432 9638.19980 28287.7444   193%     -   69s
H    0     0                    9757.0322767 28287.2587   190%     -   69s
H    0     0                    9867.9669183 28287.2587   187%     -   69s
H    0     0                    10173.647024 28287.2587   178%     -   69s
H    0     0                    10261.158439 28287.2587   176%     -   69s
H    0     0                    10590.782107 28287.2587   167%     -   69s
     0     0 27954.5674    0  442 10590.7821 27954.5674   164%     -   73s
     0     0 27802.9071    0  479 10590.7821 27802.9071   163%     -   76s
     0     0 27742.8187    0  397 10590.7821 27742.8187   162%     -   77s
     0     0 27668.4415    0  476 10590.7821 27668.4415   161%     -   79s
     0     0 27656.0248    0  446 10590.7821 27656.0248   161%     -   80s
     0     0 27652.4764    0  440 10590.7821 27652.4764   161%     -   81s
     0     0 27642.8572    0  448 10590.7821 27642.8572   161%     -   81s
     0     0 27623.8007    0  446 10590.7821 27623.8007   161%     -   82s
     0     0 27622.9920    0  446 10590.7821 27622.9920   161%     -   82s
H    0     0                    10705.422308 27622.9920   158%     -   85s
H    0     0                    10811.476366 27622.9920   155%     -   85s
H    0     0                    11183.083136 27622.9920   147%     -   85s
H    0     0                    12159.849334 27622.9920   127%     -   85s
H    0     0                    12313.842506 27622.9920   124%     -   85s
     0     0 27265.2290    0  484 12313.8425 27265.2290   121%     -   89s
     0     0 26968.6743    0  460 12313.8425 26968.6743   119%     -   92s
     0     0 26903.1871    0  463 12313.8425 26903.1871   118%     -   93s
     0     0 26851.5904    0  473 12313.8425 26851.5904   118%     -   95s
     0     0 26836.6304    0  478 12313.8425 26836.6304   118%     -   95s
     0     0 26818.8818    0  468 12313.8425 26818.8818   118%     -   96s
     0     0 26817.1503    0  468 12313.8425 26817.1503   118%     -   96s
     0     0 26816.3191    0  469 12313.8425 26816.3191   118%     -   97s
     0     0 26729.5963    0  465 12313.8425 26729.5963   117%     -  100s
H    0     0                    12376.795576 26728.7064   116%     -  100s
     0     0 26686.3182    0  470 12376.7956 26686.3182   116%     -  101s
     0     0 26680.1960    0  473 12376.7956 26680.1960   116%     -  101s
     0     0 26675.0792    0  473 12376.7956 26675.0792   116%     -  102s
     0     0 26673.4956    0  473 12376.7956 26673.4956   116%     -  102s
     0     0 26668.0994    0  478 12376.7956 26668.0994   115%     -  102s
     0     0 26667.0273    0  480 12376.7956 26667.0273   115%     -  102s
     0     0 26650.9542    0  473 12376.7956 26650.9542   115%     -  103s
H    0     0                    13737.580083 26650.7141  94.0%     -  105s
     0     0 26641.8361    0  467 13737.5801 26641.8361  93.9%     -  105s
     0     0 26640.0573    0  465 13737.5801 26640.0573  93.9%     -  106s
     0     0 26637.8429    0  477 13737.5801 26637.8429  93.9%     -  106s
     0     0 26636.3198    0  461 13737.5801 26636.3198  93.9%     -  106s
     0     0 26627.7664    0  470 13737.5801 26627.7664  93.8%     -  107s
H    0     0                    13952.789573 26627.1574  90.8%     -  107s
H    0     0                    14100.451827 26627.1574  88.8%     -  107s
     0     0 26624.2764    0  503 14100.4518 26624.2764  88.8%     -  108s
     0     0 26623.4639    0  502 14100.4518 26623.4639  88.8%     -  108s
     0     0 26613.3806    0  501 14100.4518 26613.3806  88.7%     -  109s
H    0     0                    14195.626184 26612.8000  87.5%     -  110s
H    0     0                    14308.217457 26612.8000  86.0%     -  110s
     0     0 26602.3136    0  503 14308.2175 26602.3136  85.9%     -  112s
     0     0 26599.8458    0  475 14308.2175 26599.8458  85.9%     -  112s
     0     0 26599.0970    0  467 14308.2175 26599.0970  85.9%     -  112s
     0     0 26594.0241    0  467 14308.2175 26594.0241  85.9%     -  113s
     0     0 26592.1583    0  472 14308.2175 26592.1583  85.9%     -  114s
     0     0 26591.2122    0  469 14308.2175 26591.2122  85.8%     -  114s
     0     0 26582.9150    0  475 14308.2175 26582.9150  85.8%     -  115s
H    0     0                    14316.139979 26582.4642  85.7%     -  118s
     0     0 26581.7121    0  480 14316.1400 26581.7121  85.7%     -  119s
     0     0 26577.1758    0  485 14316.1400 26577.1758  85.6%     -  120s
     0     0 26573.8308    0  486 14316.1400 26573.8308  85.6%     -  120s
     0     0 26573.8308    0  491 14316.1400 26573.8308  85.6%     -  121s
     0     0 26573.8308    0  491 14316.1400 26573.8308  85.6%     -  122s
H    0     0                    14411.369525 26573.8308  84.4%     -  141s
     0     2 26573.8308    0  491 14411.3695 26573.8308  84.4%     -  141s
     1     4 26359.1857    1  456 14411.3695 26573.8308  84.4%  4158  147s
     3     8 26229.7909    2  468 14411.3695 26358.9333  82.9%  5559  152s
     7    16 25871.9174    3  471 14411.3695 26229.7022  82.0%  5435  158s
    15    32 25722.8045    4  475 14411.3695 25871.5749  79.5%  5259  164s
    31    52 24702.1083    5  466 14411.3695 25722.0173  78.5%  7448  187s
    51    84 23643.2983    6  314 14411.3695 25720.7241  78.5%  7407  194s
H   53    84                    14414.316041 25720.7241  78.4%  7205  194s
H   57    84                    14922.616479 25720.7241  72.4%  7087  194s
    83   234 23315.0678    7  304 14922.6165 25720.7241  72.4%  6041  202s
   233   331 23031.7054   10  352 14922.6165 25720.7241  72.4%  3543  208s
H  305   331                    14973.952618 25720.7241  71.8%  3109  208s
   330   409 23261.6976    8  301 14973.9526 25720.7241  71.8%  2967  215s
   414   440 23010.4616   11  393 14973.9526 25720.7241  71.8%  2654  221s
H  418   440                    15181.866014 25720.7241  69.4%  2641  221s
H  437   440                    15191.404808 25720.7241  69.3%  2596  221s
   452   490 17477.6548   11  203 15191.4048 25720.7241  69.3%  2546  227s
H  545   526                    15287.030986 25720.7241  68.3%  2410  229s
   558   569 23947.5812   15  475 15287.0310 25720.7241  68.3%  2399  235s
   623   602 22742.5888   12  343 15287.0310 25720.7241  68.3%  2313  241s
   696   631 22638.2851   12  320 15287.0310 25720.7241  68.3%  2240  247s
   767   654 21561.9139   13  214 15287.0310 25642.9405  67.7%  2238  254s
   808   687 21931.8365   13  294 15287.0310 25642.6569  67.7%  2275  261s
   847   714 21653.6884   14  321 15287.0310 25288.6022  65.4%  2308  268s
   884   755 21291.5992   13  285 15287.0310 25288.6022  65.4%  2334  275s
H  888   755                    15336.599041 25288.6022  64.9%  2332  275s
   941   789 20395.8397   15  254 15336.5990 25288.6022  64.9%  2332  281s
H  945   789                    15499.189977 25288.6022  63.2%  2334  281s
   979   864 20642.3421   14  286 15499.1900 25288.6022  63.2%  2349  286s
  1071   883 18833.1023   15  357 15499.1900 25288.6022  63.2%  2279  291s
H 1103   883                    15529.957070 24665.3625  58.8%  2268  291s
  1111   933 16170.8061   14  166 15529.9571 24665.3625  58.8%  2266  299s
  1195   958 16994.0215   16  175 15529.9571 24664.2227  58.8%  2238  306s
H 1196   958                    15539.916517 24664.2227  58.7%  2236  306s
H 1200   958                    15579.212833 24664.2227  58.3%  2235  306s
  1232  1032 18327.4692   17  196 15579.2128 24664.2227  58.3%  2239  312s
  1316  1103 19234.1015   17  232 15579.2128 24503.0552  57.3%  2231  320s
  1423  1162 17326.5630   19  224 15579.2128 24503.0552  57.3%  2190  326s
  1514  1199 16529.9534   18  183 15579.2128 24503.0552  57.3%  2154  335s
  1613  1251 17061.3999   18  200 15579.2128 24503.0552  57.3%  2150  343s
  1711  1316 17014.0754   21  181 15579.2128 24503.0552  57.3%  2159  351s
  1818  1335 22127.4721    9  386 15579.2128 24346.3023  56.3%  2154  357s
  1863  1371 21231.8218   10  364 15579.2128 24340.5759  56.2%  2152  365s
  1927  1435 17913.6234   12  290 15579.2128 24298.5027  56.0%  2149  375s
  2045  1536 16965.3787   15  193 15579.2128 24298.5027  56.0%  2112  384s
  2205  1626     cutoff   18      15579.2128 24140.0039  55.0%  2052  391s
  2357  1682 21241.9291    9  301 15579.2128 24033.7761  54.3%  1992  402s
  2533  1762 19912.1240   11  191 15579.2128 24033.7761  54.3%  1953  412s
  2679  1813 18924.4034   15  203 15579.2128 24033.7761  54.3%  1946  421s
  2814  1884 18604.3307   18  189 15579.2128 24033.7761  54.3%  1950  431s
  2963  1961 18199.6769   22  258 15579.2128 23855.9361  53.1%  1953  441s
  3120  2032 17348.2230   33  194 15579.2128 23847.5134  53.1%  1960  451s
  3259  2108     cutoff   46      15579.2128 23841.3445  53.0%  1978  461s
  3405  2134 17299.3150   11  338 15579.2128 23834.6797  53.0%  1994  468s
  3443  2154 16834.9137   12  285 15579.2128 23834.6797  53.0%  2007  476s
  3491  2178 16516.9288   13  340 15579.2128 23834.6797  53.0%  2009  484s
  3533  2199 15876.4992   14  331 15579.2128 23834.6797  53.0%  2017  493s
  3603  2203 infeasible   15      15579.2128 23834.6797  53.0%  2013  503s
  3691  2263 21551.1966   10  407 15579.2128 23834.6797  53.0%  2018  514s
  3781  2320 17673.7450   11  376 15579.2128 23834.6797  53.0%  2025  527s
  3977  2418 17441.0646   12  371 15579.2128 23834.6797  53.0%  2013  540s
  4146  2492     cutoff   16      15579.2128 23582.0836  51.4%  2020  552s
  4358  2580 19250.3656   21  316 15579.2128 23560.0386  51.2%  2021  568s
  4588  2701 16282.0714   26  255 15579.2128 23451.2186  50.5%  2017  584s
  4836  2702 17127.3361   33  491 15579.2128 23401.6418  50.2%  2013  623s
  4838  2703 18237.3352   23  238 15579.2128 23401.6418  50.2%  2012  643s
  4839  2704 17702.8390   32  415 15579.2128 23401.6418  50.2%  2012  658s
  4840  2705 19263.2675   13  462 15579.2128 23401.6418  50.2%  2012  668s
  4841  2705 22888.6056   13  436 15579.2128 23401.6418  50.2%  2011  677s
  4842  2706 18009.0658   20  446 15579.2128 23401.6418  50.2%  2011  684s
  4843  2707 18266.9377   13  471 15579.2128 23401.6418  50.2%  2010  687s
  4845  2708 18863.0270   14  489 15579.2128 23401.6418  50.2%  2009  691s
  4848  2710 18578.3897   19  485 15579.2128 23401.6418  50.2%  2008  695s
  4850  2711 22112.4670   10  474 15579.2128 23401.6418  50.2%  2007  700s
  4853  2713 17028.3958   37  449 15579.2128 23401.6418  50.2%  2006  706s
  4855  2715 17379.5870   21  471 15579.2128 23401.6418  50.2%  2005  710s
  4858  2717 21442.6942    8  444 15579.2128 23401.6418  50.2%  2004  715s
  4860  2718 17721.3951   29  401 15579.2128 23401.6418  50.2%  2003  720s
  4863  2720 17620.0401   14  511 15579.2128 23401.6418  50.2%  2002  727s
  4865  2721 18404.7163   20  494 15579.2128 23401.6418  50.2%  2001  731s
  4866  2722 18992.0960   19  494 15579.2128 23401.6418  50.2%  2001  759s
  4867  2723 19513.2175   23  494 15579.2128 23401.6418  50.2%  2000  778s
  4868  2726 23401.6418   14  491 15579.2128 23401.6418  50.2%  2030  783s
  4870  2730 23401.6418   15  495 15579.2128 23401.6418  50.2%  2031  797s
  4874  2736 23401.6418   16  499 15579.2128 23401.6418  50.2%  2033  805s
  4882  2750 23401.6418   17  491 15579.2128 23401.6418  50.2%  2042  825s
  4898  2760 23401.6418   18  438 15579.2128 23401.6418  50.2%  2058  935s
  4914  2775 22541.6597   19  366 15579.2128 23401.6418  50.2%  2119  950s
  4946  2838 22491.1404   20  366 15579.2128 23401.6418  50.2%  2123  968s
  5034  2845 22285.2653   21  350 15579.2128 23401.6418  50.2%  2155  980s
  5094  2870 19521.0450   21  175 15579.2128 23401.6418  50.2%  2172  989s
  5197  2884 21044.8976   22  257 15579.2128 23401.6418  50.2%  2175  999s
  5293  2877 21349.5697   22  330 15579.2128 23401.6418  50.2%  2169 1015s
  5387  2872 18352.6919   22  177 15579.2128 23401.6418  50.2%  2168 1023s
  5474  2871 17049.4601   23  150 15579.2128 23401.6418  50.2%  2167 1031s
  5547  2860 17045.2190   24  145 15579.2128 23401.6418  50.2%  2168 1040s
  5619  2866 16674.3797   26  147 15579.2128 23401.6418  50.2%  2170 1048s
  5684  2859 16437.5995   27  129 15579.2128 23401.6418  50.2%  2170 1056s
  5768  2852 16163.4075   29  201 15579.2128 23401.6418  50.2%  2170 1065s
  5850  2845     cutoff   28      15579.2128 23401.6418  50.2%  2167 1073s
  5930  2839 infeasible   35      15579.2128 23401.6418  50.2%  2167 1083s
  5984  2850 19870.7442   20  481 15579.2128 23401.6418  50.2%  2173 1092s
  6045  2877 18964.7863   22  326 15579.2128 23401.6418  50.2%  2182 1100s
  6129  2891 18467.7738   23  285 15579.2128 23401.6418  50.2%  2177 1109s
  6238  2891 16043.4888   25  204 15579.2128 23401.6418  50.2%  2165 1118s
  6340  2908 20160.8536   20  157 15579.2128 23401.6418  50.2%  2163 1127s
  6452  2893 19785.6553   21  318 15579.2128 23401.6418  50.2%  2161 1135s
  6497  2922 19513.0752   22  274 15579.2128 23401.6418  50.2%  2164 1143s
  6564  2954 18476.0913   24  263 15579.2128 23401.6418  50.2%  2167 1154s
  6666  2938 18068.9341   27  183 15579.2128 23401.6418  50.2%  2165 1165s
  6781  2928 16485.5758   31  149 15579.2128 23344.1653  49.8%  2169 1175s
  6886  2943 17390.5653   25  315 15579.2128 23344.1653  49.8%  2179 1184s
  6975  2950     cutoff   26      15579.2128 23344.1653  49.8%  2188 1196s
  7105  2954     cutoff   29      15579.2128 23344.0239  49.8%  2185 1207s
  7234  2939     cutoff   24      15579.2128 22896.1665  47.0%  2188 1219s
  7400  2947 17377.6840   21  294 15579.2128 22896.1665  47.0%  2184 1231s
  7541  2955     cutoff   22      15579.2128 22896.1665  47.0%  2193 1242s
  7709  2930 15583.0486   23  273 15579.2128 22896.1665  47.0%  2194 1255s
  7888  2914     cutoff   23      15579.2128 21316.0387  36.8%  2194 1269s
  8087  2865     cutoff   24      15579.2128 21316.0387  36.8%  2188 1281s
  8246  2885 15648.4262   26  349 15579.2128 20821.8313  33.7%  2182 1296s
  8423  2891 18617.9344   22  288 15579.2128 20699.3039  32.9%  2183 1311s
  8650  2857     cutoff   29      15579.2128 20671.4657  32.7%  2175 1328s
  8854  2801 16125.3392   25  267 15579.2128 20547.0304  31.9%  2180 1342s
  9004  2772     cutoff   26      15579.2128 20488.3185  31.5%  2185 1356s
  9130  2764     cutoff   28      15579.2128 20353.7547  30.6%  2192 1369s
  9353  2739     cutoff   28      15579.2128 20353.7547  30.6%  2181 1384s
  9530  2717 16511.3048   25  145 15579.2128 19996.1533  28.4%  2183 1401s
  9837  2649 17674.5884   31  127 15579.2128 19751.6419  26.8%  2178 1417s
 10152  2603 17036.6676   23  438 15579.2128 19602.2378  25.8%  2176 1435s
 10461  2562 17662.6653   28  186 15579.2128 19437.6810  24.8%  2176 1456s
 10817  2416     cutoff   30      15579.2128 19301.5413  23.9%  2166 1475s
 11210  2272 17619.1386   32  150 15579.2128 18968.5302  21.8%  2160 1496s
 11641  2131     cutoff   32      15579.2128 18878.8255  21.2%  2146 1517s
 12100  1935 infeasible   36      15579.2128 18678.2611  19.9%  2130 1537s
 12551  1737 infeasible   34      15579.2128 18486.2407  18.7%  2119 1559s
 13098  1472 infeasible   24      15579.2128 18327.8822  17.6%  2097 1583s
 13678  1262 15981.9807   25  328 15579.2128 17985.4457  15.4%  2076 1603s
 14277  1039 16110.0717   35  296 15579.2128 17876.1514  14.7%  2044 1625s
 15124  1013 15898.8158   35  389 15579.2128 17458.3034  12.1%  1991 1642s
 15226   683     cutoff   36      15579.2128 17458.3034  12.1%  1984 1661s
 15917    63 infeasible   45      15579.2128 17307.5753  11.1%  1931 1679s
 17127     0 15931.1682   47   88 15579.2128 16895.4949  8.45%  1829 1682s

Cutting planes:
  Learned: 3
  MIR: 519
  Mixing: 2
  Flow cover: 1352
  RLT: 38
  Relax-and-lift: 124

Explored 17224 nodes (31543606 simplex iterations) in 1682.93 seconds (4785.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15579.2 15539.9 15530 ... 14922.6

Optimal solution found (tolerance 1.00e-06)
Best objective 1.557921283318e+04, best bound 1.557921283318e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1682.95s
  Master Objective (UB) = 15579.21, θ = 158161.25
  Upper Bound (UB) = 15579.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 158161.25
  [DEBUG]   ✓ Scenario 0: θ = 158161.25 ≤ Q = 158161.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 158161.25 ≤ Q = 158161.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 158161.25 ≤ Q = 158161.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 158161.25 ≤ Q = 158161.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 158161.25 ≤ Q = 158161.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 158161.25 ≤ Q = 158161.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5cc6a1e7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa3395e19
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.323399e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6597431.8328
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.467916e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146791.62    0  122 6597431.83 -146791.62   102%     -    0s
H    0     0                    -106362.5813 -146791.62  38.0%     -    0s
H    0     0                    -114554.2995 -146791.62  28.1%     -    0s
H    0     0                    -115540.8292 -146791.62  27.0%     -    0s
H    0     0                    -115775.7023 -146585.79  26.6%     -    0s
     0     0 -128074.98    0   60 -115775.70 -128074.98  10.6%     -    0s
H    0     0                    -125487.3938 -128020.98  2.02%     -    0s
H    0     0                    -126102.5300 -128020.98  1.52%     -    0s
H    0     0                    -126661.6558 -128020.98  1.07%     -    0s
     0     0 -127305.62    0   44 -126661.66 -127305.62  0.51%     -    0s
H    0     0                    -126785.4947 -127284.85  0.39%     -    0s
     0     0 -127224.46    0   41 -126785.49 -127224.46  0.35%     -    0s
     0     0 -127111.48    0   21 -126785.49 -127111.48  0.26%     -    0s
     0     0 -127111.47    0   20 -126785.49 -127111.47  0.26%     -    0s
     0     0 -127077.13    0   21 -126785.49 -127077.13  0.23%     -    0s
     0     0 -127048.07    0   19 -126785.49 -127048.07  0.21%     -    0s
     0     0 -127048.07    0   30 -126785.49 -127048.07  0.21%     -    0s
     0     0 -126986.31    0   15 -126785.49 -126986.31  0.16%     -    0s
H    0     0                    -126793.2149 -126947.17  0.12%     -    0s
H    0     0                    -126861.4304 -126947.17  0.07%     -    0s
     0     0 -126936.30    0    5 -126861.43 -126936.30  0.06%     -    0s
     0     0 -126924.61    0    3 -126861.43 -126924.61  0.05%     -    0s
     0     0 -126915.22    0    3 -126861.43 -126915.22  0.04%     -    0s
     0     0 -126915.22    0    6 -126861.43 -126915.22  0.04%     -    0s
H    0     0                    -126886.7009 -126915.22  0.02%     -    0s
*    0     0               0    -126908.8789 -126908.88  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  Flow cover: 5
  Relax-and-lift: 1

Explored 1 nodes (843 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -126909 -126887 -126861 ... -115541
No other solutions better than -126909

Optimal solution found (tolerance 1.00e-06)
Best objective -1.269088788612e+05, best bound -1.269088788612e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 145951.94
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126908.88
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -126908.88 = 145951.94
  [DEBUG]   Current θ from Master = 158161.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12209.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3369.91
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2989.4511, Absolute Gap = 2989.4511, Relative Gap = 0.191887
  Not converged yet (gap = 2989.45 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308220 nonzeros
Model fingerprint: 0x175ae5df
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 46722 rows and 18972 columns
Presolve time: 1.21s
Presolved: 61691 rows, 26968 columns, 383689 nonzeros
Variable types: 24709 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 61691 rows, 26968 columns, 383689 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35654   -2.2022894e+04   0.000000e+00   1.176731e+08      5s
   50356    1.4724891e+04   0.000000e+00   2.433777e+06     10s
   60109    1.7351628e+04   0.000000e+00   8.659579e+06     15s
   68999    1.9161211e+04   0.000000e+00   2.936064e+08     20s
   77495    2.2026973e+04   0.000000e+00   8.515672e+08     25s
Concurrent spin time: 7.45s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.947916e+04, 62343 iterations, 30.40 seconds (51.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39479.1592    0  238 -190754.47 39479.1592   121%     -   32s
H    0     0                    -174760.3793 39479.1592   123%     -   32s
H    0     0                    -171195.6689 39479.1592   123%     -   32s
H    0     0                    -157663.5094 39479.1592   125%     -   32s
H    0     0                    -156790.2960 39479.1592   125%     -   32s
H    0     0                    -156623.3162 39479.1592   125%     -   32s
H    0     0                    -155879.5691 39479.1592   125%     -   32s
H    0     0                    -155676.5859 39479.1592   125%     -   32s
H    0     0                    -155519.9996 39479.1592   125%     -   32s
H    0     0                    -155438.6657 39479.1592   125%     -   32s
H    0     0                    -155286.6980 39479.1592   125%     -   32s
H    0     0                    -155249.2368 39479.1592   125%     -   32s
H    0     0                    -155126.0457 39479.1592   125%     -   32s
H    0     0                    -75555.50153 39479.1592   152%     -   33s
H    0     0                    -75162.88505 39479.1592   153%     -   33s
H    0     0                    -75148.69803 39479.1592   153%     -   33s
H    0     0                    -22957.28770 39479.1592   272%     -   33s
H    0     0                    -21248.77369 39479.1592   286%     -   33s
H    0     0                    -21229.54283 39479.1592   286%     -   33s
H    0     0                    -21224.61064 39479.1592   286%     -   33s
H    0     0                    -16103.54798 34825.9088   316%     -   41s
H    0     0                    -16039.82632 34825.9088   317%     -   41s
     0     0 34825.9088    0  283 -16039.826 34825.9088   317%     -   42s
H    0     0                    -15073.10252 34825.5596   331%     -   42s
H    0     0                    -8710.542002 34825.5596   500%     -   42s
H    0     0                    -8621.063213 34825.5596   504%     -   42s
H    0     0                    -8181.554233 34825.5596   526%     -   42s
H    0     0                    -7856.158925 34825.5596   543%     -   42s
H    0     0                    -7612.174289 33524.5497   540%     -   48s
H    0     0                    -7395.407312 33524.5497   553%     -   48s
     0     0 33406.5459    0  273 -7395.4073 33406.5459   552%     -   48s
     0     0 33262.6534    0  293 -7395.4073 33262.6534   550%     -   51s
     0     0 33256.4327    0  292 -7395.4073 33256.4327   550%     -   52s
     0     0 33256.4327    0  299 -7395.4073 33256.4327   550%     -   53s
     0     0 33256.4327    0  300 -7395.4073 33256.4327   550%     -   54s
     0     0 33256.4327    0  296 -7395.4073 33256.4327   550%     -   54s
     0     0 33256.4327    0  300 -7395.4073 33256.4327   550%     -   54s
H    0     0                    -7208.879081 30660.8289   525%     -   62s
H    0     0                    -7074.655151 30660.8289   533%     -   62s
     0     0 30560.1608    0  332 -7074.6552 30560.1608   532%     -   62s
H    0     0                    9252.9773009 30560.1608   230%     -   62s
     0     0 30098.7458    0  385 9252.97730 30098.7458   225%     -   67s
     0     0 29985.3565    0  383 9252.97730 29985.3565   224%     -   71s
     0     0 29881.0164    0  388 9252.97730 29881.0164   223%     -   74s
     0     0 29815.0313    0  392 9252.97730 29815.0313   222%     -   75s
H    0     0                    9499.0732391 29567.0881   211%     -   79s
H    0     0                    9866.7316639 29567.0881   200%     -   79s
H    0     0                    9928.1517330 29567.0881   198%     -   79s
     0     0 29567.0881    0  383 9928.15173 29567.0881   198%     -   79s
     0     0 29491.2022    0  388 9928.15173 29491.2022   197%     -   81s
     0     0 29456.9059    0  395 9928.15173 29456.9059   197%     -   81s
     0     0 29447.3124    0  402 9928.15173 29447.3124   197%     -   82s
     0     0 29445.3197    0  405 9928.15173 29445.3197   197%     -   82s
     0     0 29326.8628    0  386 9928.15173 29326.8628   195%     -   85s
H    0     0                    10032.485441 29304.6277   192%     -   86s
H    0     0                    10081.096190 29304.6277   191%     -   86s
H    0     0                    10093.698788 29304.6277   190%     -   86s
     0     0 29304.6277    0  399 10093.6988 29304.6277   190%     -   86s
     0     0 29297.5282    0  398 10093.6988 29297.5282   190%     -   87s
     0     0 29294.9678    0  404 10093.6988 29294.9678   190%     -   87s
     0     0 29293.2380    0  405 10093.6988 29293.2380   190%     -   88s
     0     0 29292.9437    0  407 10093.6988 29292.9437   190%     -   88s
     0     0 28306.4738    0  421 10093.6988 28306.4738   180%     -  107s
H    0     0                    10290.465507 28305.5943   175%     -  107s
H    0     0                    10357.244029 28305.5943   173%     -  107s
H    0     0                    10402.139978 28305.5943   172%     -  107s
H    0     0                    10468.918500 28305.5943   170%     -  107s
     0     0 28050.3213    0  428 10468.9185 28050.3213   168%     -  111s
     0     0 27898.9673    0  430 10468.9185 27898.9673   166%     -  114s
     0     0 27796.1036    0  447 10468.9185 27796.1036   166%     -  118s
     0     0 27727.5940    0  445 10468.9185 27727.5940   165%     -  120s
     0     0 27682.4082    0  442 10468.9185 27682.4082   164%     -  123s
     0     0 27674.2030    0  443 10468.9185 27674.2030   164%     -  123s
     0     0 27667.6915    0  438 10468.9185 27667.6915   164%     -  124s
     0     0 27661.1166    0  438 10468.9185 27661.1166   164%     -  124s
     0     0 27650.1970    0  433 10468.9185 27650.1970   164%     -  125s
     0     0 27645.8529    0  440 10468.9185 27645.8529   164%     -  125s
     0     0 27625.3450    0  436 10468.9185 27625.3450   164%     -  126s
     0     0 27603.7635    0  442 10468.9185 27603.7635   164%     -  127s
     0     0 27603.1034    0  441 10468.9185 27603.1034   164%     -  128s
H    0     0                    10491.124991 27603.1034   163%     -  132s
H    0     0                    10650.008990 27603.1034   159%     -  132s
     0     0 27167.4630    0  452 10650.0090 27167.4630   155%     -  138s
H    0     0                    10674.474448 27065.9056   154%     -  141s
     0     0 27065.9056    0  448 10674.4744 27065.9056   154%     -  141s
     0     0 27027.1229    0  449 10674.4744 27027.1229   153%     -  143s
     0     0 27002.6504    0  454 10674.4744 27002.6504   153%     -  144s
     0     0 26983.6777    0  464 10674.4744 26983.6777   153%     -  145s
     0     0 26975.6459    0  468 10674.4744 26975.6459   153%     -  145s
     0     0 26966.1552    0  459 10674.4744 26966.1552   153%     -  146s
     0     0 26959.6354    0  463 10674.4744 26959.6354   153%     -  147s
     0     0 26957.9955    0  464 10674.4744 26957.9955   153%     -  147s
     0     0 26955.3430    0  465 10674.4744 26955.3430   153%     -  147s
     0     0 26954.8153    0  466 10674.4744 26954.8153   153%     -  147s
     0     0 26842.1921    0  472 10674.4744 26842.1921   151%     -  151s
H    0     0                    10831.089036 26842.0994   148%     -  151s
H    0     0                    10855.252092 26842.0994   147%     -  151s
     0     0 26821.8237    0  452 10855.2521 26821.8237   147%     -  153s
     0     0 26814.3879    0  457 10855.2521 26814.3879   147%     -  154s
     0     0 26810.7516    0  450 10855.2521 26810.7516   147%     -  154s
     0     0 26809.3162    0  454 10855.2521 26809.3162   147%     -  154s
     0     0 26789.2359    0  455 10855.2521 26789.2359   147%     -  156s
H    0     0                    12005.897649 26789.0683   123%     -  157s
H    0     0                    12019.928752 26789.0683   123%     -  158s
H    0     0                    12173.693417 26789.0683   120%     -  158s
H    0     0                    12197.856473 26789.0683   120%     -  159s
H    0     0                    12263.237807 26789.0683   118%     -  159s
     0     0 26765.0915    0  454 12263.2378 26765.0915   118%     -  160s
     0     0 26753.2221    0  454 12263.2378 26753.2221   118%     -  161s
     0     0 26750.3604    0  462 12263.2378 26750.3604   118%     -  162s
     0     0 26748.7073    0  463 12263.2378 26748.7073   118%     -  162s
     0     0 26747.9997    0  465 12263.2378 26747.9997   118%     -  162s
     0     0 26725.4807    0  468 12263.2378 26725.4807   118%     -  164s
H    0     0                    12364.780324 26725.1410   116%     -  164s
H    0     0                    12429.767110 26725.1410   115%     -  164s
     0     0 26715.4859    0  467 12429.7671 26715.4859   115%     -  165s
     0     0 26709.2468    0  471 12429.7671 26709.2468   115%     -  166s
     0     0 26702.6545    0  481 12429.7671 26702.6545   115%     -  167s
     0     0 26701.8303    0  481 12429.7671 26701.8303   115%     -  167s
     0     0 26692.5984    0  474 12429.7671 26692.5984   115%     -  169s
H    0     0                    12443.798213 26691.1828   114%     -  170s
     0     0 26688.2539    0  485 12443.7982 26688.2539   114%     -  170s
     0     0 26686.6352    0  476 12443.7982 26686.6352   114%     -  171s
     0     0 26685.1783    0  484 12443.7982 26685.1783   114%     -  171s
     0     0 26679.2438    0  479 12443.7982 26679.2438   114%     -  172s
H    0     0                    12595.362408 26679.2268   112%     -  172s
H    0     0                    12705.889240 26679.2268   110%     -  172s
H    0     0                    12714.642571 26679.2268   110%     -  172s
     0     0 26676.9688    0  486 12714.6426 26676.9688   110%     -  173s
     0     0 26676.7678    0  487 12714.6426 26676.7678   110%     -  173s
     0     0 26673.0810    0  485 12714.6426 26673.0810   110%     -  174s
H    0     0                    12826.679137 26672.9296   108%     -  177s
H    0     0                    12914.364245 26672.9296   107%     -  178s
H    0     0                    12928.221654 26672.9296   106%     -  178s
H    0     0                    12929.754204 26672.9296   106%     -  178s
     0     0 26672.3102    0  478 12929.7542 26672.3102   106%     -  178s
     0     0 26667.6869    0  477 12929.7542 26667.6869   106%     -  179s
     0     0 26667.0167    0  477 12929.7542 26667.0167   106%     -  180s
H    0     0                    13138.506037 26667.0167   103%     -  190s
H    0     0                    13203.000936 26667.0167   102%     -  190s
H    0     0                    13339.062305 26667.0167   100%     -  190s
H    0     0                    13404.981270 26667.0167  98.9%     -  190s
H    0     0                    13457.422692 26667.0167  98.2%     -  190s
H    0     0                    13481.585749 26667.0167  97.8%     -  190s
H    0     0                    13484.834912 26667.0167  97.8%     -  201s
     0     2 26667.0167    0  477 13484.8349 26667.0167  97.8%     -  202s
     3     8 26364.8518    2  445 13484.8349 26638.7312  97.5%  3902  209s
     7    16 26135.7226    3  463 13484.8349 26620.3058  97.4%  5030  218s
    15    32 25880.9028    4  504 13484.8349 26277.8139  94.9%  7153  225s
    31    48 24917.1593    5  443 13484.8349 26032.4717  93.0%  8841  244s
    47    80 22909.7281    6  413 13484.8349 26032.4717  93.0% 12449  256s
    79   146 22770.3968    7  404 13484.8349 26032.4717  93.0%  9280  281s
   145   255 22718.3817    9  330 13484.8349 26032.4717  93.0%  6529  291s
H  150   255                    14308.834981 26032.4717  81.9%  6370  291s
H  225   255                    14570.548510 26032.4717  78.7%  4787  291s
H  242   255                    14810.483763 26032.4717  75.8%  4582  291s
   254   354 22619.4897   10  327 14810.4838 26032.4717  75.8%  4439  298s
   361   417 22561.1424   11  388 14810.4838 26032.4717  75.8%  3671  306s
   438   487 20586.3666   12  322 14810.4838 26032.4717  75.8%  3435  314s
   531   533 22001.4310   13  334 14810.4838 26032.4717  75.8%  3092  322s
   595   591 22047.6239   11  257 14810.4838 26032.4717  75.8%  3001  330s
   674   657 21549.1215   14  309 14810.4838 26032.4717  75.8%  2844  338s
   766   712 17740.6559   28  144 14810.4838 26032.4717  75.8%  2646  345s
   857   768 20871.3843   14  266 14810.4838 26032.4717  75.8%  2512  352s
   953   828 20521.3281   13  314 14810.4838 26032.4717  75.8%  2401  360s
  1055   863 21287.2267   16  313 14810.4838 26032.4717  75.8%  2305  368s
H 1081   863                    14819.716352 26032.4717  75.7%  2279  368s
H 1088   863                    14845.270092 26032.4717  75.4%  2273  368s
H 1097   863                    15007.888197 26032.4717  73.5%  2271  368s
  1123   891 21136.9161   17  275 15007.8882 26032.4717  73.5%  2266  376s
  1235   922 20999.7137   20  235 15007.8882 26032.4717  73.5%  2180  386s
  1306   962 20563.8179   22  240 15007.8882 26032.4717  73.5%  2179  394s
  1386  1015 19394.0952   22  151 15007.8882 26032.4717  73.5%  2171  403s
  1451  1064 17194.9893   25  254 15007.8882 26032.4717  73.5%  2197  413s
H 1500  1064                    15039.276060 26032.4717  73.1%  2186  413s
  1520  1129 18537.5348   23  128 15039.2761 26032.4717  73.1%  2200  422s
  1624  1199 17378.6483   24  113 15039.2761 25879.8942  72.1%  2176  432s
H 1750  1247                    15081.277334 25879.8942  71.6%  2130  441s
H 1754  1247                    15096.840987 25879.8942  71.4%  2132  441s
H 1818  1247                    15123.953346 25879.8942  71.1%  2104  441s
  1866  1295 infeasible   26      15123.9533 25879.8942  71.1%  2093  452s
  1970  1365 22037.3138    8  254 15123.9533 25879.8942  71.1%  2111  461s
H 1976  1365                    15232.724042 25879.8942  69.9%  2112  461s
  2072  1423 21240.2716   10  185 15232.7240 25879.8942  69.9%  2103  472s
  2174  1476 15905.3073   13  135 15232.7240 25879.8942  69.9%  2109  482s
  2263  1569 15441.8291   15  223 15232.7240 25879.8942  69.9%  2089  491s
  2388  1642 19378.3342    9  417 15232.7240 25879.8942  69.9%  2070  502s
  2515  1742 18512.6808   12  416 15232.7240 25879.8942  69.9%  2048  513s
  2679  1837 18450.2654   14  333 15232.7240 25879.8942  69.9%  2023  525s
  2865  1919 17490.2569   16  298 15232.7240 25879.8942  69.9%  1987  537s
  3017  1954 infeasible   17      15232.7240 25321.3585  66.2%  1982  546s
  3081  1986 15843.6463   19  210 15232.7240 25318.3799  66.2%  1980  556s
  3147  2012 15639.0829   20  169 15232.7240 25318.3799  66.2%  1994  566s
  3185  2049 15460.1887   21  164 15232.7240 25318.3799  66.2%  2001  580s
  3297  2140 20858.4405    8  387 15232.7240 25318.3799  66.2%  1983  592s
  3414  2226 20193.5119   13  273 15232.7240 25318.3799  66.2%  1984  606s
  3613  2321 18849.2717   16  352 15232.7240 25318.3799  66.2%  1958  620s
  3794  2398 17953.6478   22  195 15232.7240 24682.8663  62.0%  1963  633s
  3963  2452 15414.7274   29  193 15232.7240 24568.5185  61.3%  1981  651s
  4127  2548 19502.9698   13  302 15232.7240 24568.5185  61.3%  2005  665s
  4349  2620 19246.9357   13  223 15232.7240 24426.2718  60.4%  2006  682s
  4593  2728     cutoff   16      15232.7240 24426.2718  60.4%  1999  697s
  4830  2900 19092.5660   12  289 15232.7240 24426.2718  60.4%  2001  716s
  5177  2901 18974.8405   23  477 15232.7240 24426.2718  60.4%  1960  770s
  5179  2902 18794.6499   22  238 15232.7240 24426.2718  60.4%  1959  800s
  5180  2903 20295.5450   17  414 15232.7240 24426.2718  60.4%  1959  821s
  5181  2904 20531.0620   16  434 15232.7240 24426.2718  60.4%  1958  833s
  5182  2904 16595.6820   32  433 15232.7240 24426.2718  60.4%  1958  845s
  5183  2905 20615.6894   14  470 15232.7240 24426.2718  60.4%  1957  851s
  5184  2906 17586.0191   34  458 15232.7240 24426.2718  60.4%  1957  855s
  5186  2907 18561.0606   28  464 15232.7240 24426.2718  60.4%  1956  861s
  5188  2908 17500.2838   46  458 15232.7240 24426.2718  60.4%  1956  866s
  5190  2910 17971.1849   18  467 15232.7240 24426.2718  60.4%  1955  870s
  5193  2912 21225.2706   12  462 15232.7240 24426.2718  60.4%  1954  875s
  5194  2912 16878.7492   15  493 15232.7240 24426.2718  60.4%  1953  881s
  5196  2914 16347.8678   52  472 15232.7240 24426.2718  60.4%  1953  885s
  5198  2915 22760.5432    6  470 15232.7240 24426.2718  60.4%  1952  891s
  5201  2917 21059.3052   28  523 15232.7240 24426.2718  60.4%  1951  897s
  5203  2918 16192.5543   26  517 15232.7240 24426.2718  60.4%  1950  900s
  5205  2920 20524.3843   12  518 15232.7240 24426.2718  60.4%  1949  906s
  5206  2920 18256.1261   51  509 15232.7240 24426.2718  60.4%  1949  911s
  5208  2922 17088.5272   16  539 15232.7240 24426.2718  60.4%  1948  916s
  5210  2923 20513.0566   16  515 15232.7240 24426.2718  60.4%  1947  922s
  5212  2924 21676.8726   12  551 15232.7240 24426.2718  60.4%  1947  927s
  5213  2925 20320.6290   16  554 15232.7240 24426.2718  60.4%  1946  930s
  5215  2926 19004.8670   18  555 15232.7240 24426.2718  60.4%  1945  963s
  5216  2927 16420.8854   29  555 15232.7240 24426.2718  60.4%  1945  981s
  5217  2931 24426.2718   14  505 15232.7240 24426.2718  60.4%  1986 1014s
  5219  2934 24426.2718   15  501 15232.7240 24426.2718  60.4%  1988 1030s
  5223  2941 24426.2718   16  502 15232.7240 24426.2718  60.4%  1993 1047s
  5231  2954 24426.2718   17  504 15232.7240 24426.2718  60.4%  2003 1062s
  5247  2966 23177.3018   18  437 15232.7240 24426.2718  60.4%  2034 1083s
  5265  2978 23437.2431   19  423 15232.7240 24426.2718  60.4%  2065 1099s
  5297  3027 21348.6594   20  374 15232.7240 24426.2718  60.4%  2080 1114s
  5371  3032 20579.2654   22  209 15232.7240 24426.2718  60.4%  2113 1124s
  5408  3049 20567.6240   22  379 15232.7240 24426.2718  60.4%  2126 1135s
  5459  3065 19906.9496   23  324 15232.7240 24426.2718  60.4%  2156 1146s
  5523  3090 17863.4341   23  333 15232.7240 24426.2718  60.4%  2181 1160s
  5598  3095 19324.5822   24  298 15232.7240 24426.2718  60.4%  2192 1171s
  5675  3093     cutoff   26      15232.7240 24426.2718  60.4%  2199 1187s
  5759  3104 18472.1720   28  327 15232.7240 24426.2718  60.4%  2201 1199s
  5836  3111 18115.6374   32  284 15232.7240 24426.2718  60.4%  2206 1208s
  5900  3115 17853.2329   34  179 15232.7240 24426.2718  60.4%  2211 1217s
  5977  3120     cutoff   35      15232.7240 24426.2718  60.4%  2212 1227s
  6058  3119 16628.1600   39  214 15232.7240 24426.2718  60.4%  2211 1237s
  6133  3105     cutoff   40      15232.7240 24426.2718  60.4%  2213 1250s
  6205  3104     cutoff   42      15232.7240 24426.2718  60.4%  2219 1261s
  6276  3084 15668.7614   25  252 15232.7240 24426.2718  60.4%  2228 1271s
  6342  3093 15668.6452   26  251 15232.7240 23387.4575  53.5%  2227 1281s
  6426  3104 22755.4444   20  455 15232.7240 23386.2861  53.5%  2229 1296s
  6500  3119 22515.1802   21  451 15232.7240 23386.2861  53.5%  2232 1307s
  6581  3136 22236.0001   22  451 15232.7240 23386.2861  53.5%  2241 1321s
  6681  3130 21993.7017   23  380 15232.7240 23386.2861  53.5%  2237 1332s
  6789  3117 19484.1213   26  371 15232.7240 23386.2861  53.5%  2240 1338s
  6829  3131 18175.5059   27  294 15232.7240 23386.2861  53.5%  2240 1350s
  6870  3147 17346.1878   28  255 15232.7240 23386.2861  53.5%  2244 1362s
  6924  3149 17298.2354   29  254 15232.7240 23386.2861  53.5%  2240 1374s
  6989  3161 15514.0061   30  237 15232.7240 22754.9896  49.4%  2240 1387s
  7055  3176     cutoff   31      15232.7240 22514.5710  47.8%  2243 1400s
  7143  3151 15439.6960   31  165 15232.7240 22359.8563  46.8%  2245 1413s
  7267  3140 15407.5271   32  170 15232.7240 22359.8563  46.8%  2242 1428s
  7364  3161 infeasible   25      15232.7240 21881.3703  43.6%  2251 1442s
  7491  3164 16766.1593   25  420 15232.7240 21881.3703  43.6%  2262 1457s
  7628  3145 16238.9205   27  291 15232.7240 21735.4381  42.7%  2271 1474s
  7820  3119 15841.6027   28  383 15232.7240 21693.9544  42.4%  2265 1491s
  7980  3056 16648.1938   20  304 15232.7240 21228.0333  39.4%  2272 1509s
  8176  3017 infeasible   23      15232.7240 21221.5922  39.3%  2269 1525s
  8349  2983     cutoff   29      15232.7240 21221.5922  39.3%  2282 1543s
  8550  2954 17140.0217   21  417 15232.7240 21076.2734  38.4%  2287 1562s
  8736  2950 15339.6611   26  214 15232.7240 21044.3315  38.2%  2291 1580s
  8960  2918 16094.1654   26  151 15232.7240 21044.3315  38.2%  2293 1600s
  9211  2879     cutoff   29      15232.7240 20847.2246  36.9%  2288 1623s
  9441  2846     cutoff   32      15232.7240 20511.5944  34.7%  2292 1644s
  9681  2766 16911.5696   23  336 15232.7240 20356.0965  33.6%  2300 1662s
  9742  2758 16853.3388   24  279 15232.7240 20227.6251  32.8%  2307 1682s
  9796  2752 16674.2216   25  279 15232.7240 20227.6251  32.8%  2310 1697s
  9861  2741     cutoff   26      15232.7240 20227.6251  32.8%  2311 1716s
  9974  2713 15849.3623   27  264 15232.7240 20227.6251  32.8%  2308 1739s
 10131  2689     cutoff   26      15232.7240 20161.5536  32.4%  2311 1761s
 10361  2609 17847.4098   23  390 15232.7240 20019.2908  31.4%  2315 1788s
 10714  2504 17022.0053   28  307 15232.7240 19932.7440  30.9%  2309 1815s
 11106  2433     cutoff   28      15232.7240 19632.6644  28.9%  2301 1841s
 11476  2291 18229.0009   22  319 15232.7240 19445.2773  27.7%  2301 1869s
 11916  2114     cutoff   29      15232.7240 19324.1650  26.9%  2290 1898s
 12365  1877 16749.6330   24  304 15232.7240 19022.1996  24.9%  2281 1927s
 12876  1576     cutoff   28      15232.7240 18753.3754  23.1%  2268 1958s
 13483  1163     cutoff   34      15232.7240 18265.6972  19.9%  2245 1986s
 14090   556     cutoff   38      15232.7240 18023.8875  18.3%  2225 2016s
 14911    78     cutoff   29      15232.7240 17401.6972  14.2%  2171 2040s
*16171    37              51    15300.508041 16429.8917  7.38%  2042 2044s
 16333     0     cutoff   42      15300.5080 15401.8851  0.66%  2023 2061s

Cutting planes:
  Learned: 3
  MIR: 680
  Mixing: 1
  Flow cover: 1893
  RLT: 35
  Relax-and-lift: 160

Explored 16380 nodes (33279556 simplex iterations) in 2061.51 seconds (5947.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15300.5 15232.7 15124 ... 14810.5

Optimal solution found (tolerance 1.00e-06)
Best objective 1.530050804124e+04, best bound 1.530050804124e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2061.59s
  Master Objective (UB) = 15300.51, θ = 160838.27
  Upper Bound (UB) = 15300.51

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160838.27
  [DEBUG]   ✓ Scenario 0: θ = 160838.27 ≤ Q = 160838.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160838.27 ≤ Q = 160838.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160838.27 ≤ Q = 160838.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160838.27 ≤ Q = 160838.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160838.27 ≤ Q = 160838.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160838.27 ≤ Q = 160838.27 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160838.27 ≤ Q = 160838.27 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x73668cda
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8c997326
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.242549e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6250526.5826
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.450043e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -145004.26    0  132 6250526.58 -145004.26   102%     -    0s
H    0     0                    -106401.1115 -145004.26  36.3%     -    0s
H    0     0                    -108991.6587 -145004.26  33.0%     -    0s
H    0     0                    -113430.1471 -124475.47  9.74%     -    0s
     0     0 -124472.16    0   68 -113430.15 -124472.16  9.73%     -    0s
H    0     0                    -122828.8705 -124472.16  1.34%     -    0s
H    0     0                    -123304.2752 -124134.78  0.67%     -    0s
     0     0 -124134.78    0   69 -123304.28 -124134.78  0.67%     -    0s
     0     0 -124129.45    0   69 -123304.28 -124129.45  0.67%     -    0s
     0     0 -123786.71    0   48 -123304.28 -123786.71  0.39%     -    0s
     0     0 -123759.74    0   45 -123304.28 -123759.74  0.37%     -    0s
     0     0 -123757.32    0   44 -123304.28 -123757.32  0.37%     -    0s
     0     0 -123530.68    0   22 -123304.28 -123530.68  0.18%     -    0s
     0     0 -123527.10    0   19 -123304.28 -123527.10  0.18%     -    0s
H    0     0                    -123325.9723 -123493.46  0.14%     -    0s
     0     0 -123474.55    0   24 -123325.97 -123474.55  0.12%     -    0s
     0     0 -123459.77    0   23 -123325.97 -123459.77  0.11%     -    0s
     0     0 -123457.02    0   18 -123325.97 -123457.02  0.11%     -    0s
     0     0 -123455.43    0   18 -123325.97 -123455.43  0.10%     -    0s
     0     0 -123455.12    0   18 -123325.97 -123455.12  0.10%     -    0s
     0     0 -123405.03    0    9 -123325.97 -123405.03  0.06%     -    0s
     0     0 -123405.03    0   14 -123325.97 -123405.03  0.06%     -    0s
     0     0 -123401.65    0   11 -123325.97 -123401.65  0.06%     -    0s
H    0     0                    -123355.4811 -123399.50  0.04%     -    0s
     0     0 -123392.26    0    6 -123355.48 -123392.26  0.03%     -    0s
     0     0 -123389.36    0    3 -123355.48 -123389.36  0.03%     -    0s
H    0     0                    -123389.3238 -123389.32  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 11
  Flow cover: 6
  Relax-and-lift: 4

Explored 1 nodes (761 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123389 -123355 -123326 ... 1.24255e+13
No other solutions better than -123389

Optimal solution found (tolerance 1.00e-06)
Best objective -1.233893238463e+05, best bound -1.233893238463e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 147886.77
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123389.32
  [DEBUG]   S×d_nominal = 271276.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 271276.10 + -123389.32 = 147886.77
  [DEBUG]   Current θ from Master = 160838.27
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12951.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2349.01
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2710.7463, Absolute Gap = 2710.7463, Relative Gap = 0.177167
  Not converged yet (gap = 2710.75 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351463 nonzeros
Model fingerprint: 0x66d0e0ac
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 53408 rows and 21688 columns
Presolve time: 1.15s
Presolved: 70295 rows, 30492 columns, 437679 nonzeros
Variable types: 28233 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 70295 rows, 30492 columns, 437679 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33244   -8.6849710e+04   0.000000e+00   6.982027e+07      5s
   46065   -7.7287477e+03   0.000000e+00   3.251041e+06     10s
   56809    1.7347353e+04   0.000000e+00   5.931899e+06     15s
   64217    1.8745722e+04   0.000000e+00   5.411787e+06     20s
   70920    1.9362482e+04   0.000000e+00   3.178011e+07     25s
   78436    2.1941178e+04   0.000000e+00   3.304317e+07     30s
Concurrent spin time: 6.77s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.947915e+04, 76293 iterations, 36.79 seconds (63.18 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39479.1505    0  238 -190754.47 39479.1505   121%     -   38s
H    0     0                    -182095.7579 39479.1505   122%     -   38s
H    0     0                    -139515.2919 39479.1505   128%     -   38s
H    0     0                    -137721.2403 39479.1505   129%     -   38s
H    0     0                    -97431.76126 39479.1505   141%     -   39s
H    0     0                    -97084.85576 39479.1505   141%     -   39s
H    0     0                    -96748.76098 39479.1505   141%     -   39s
H    0     0                    -42928.86084 39479.1505   192%     -   39s
H    0     0                    -21533.52131 39479.1505   283%     -   39s
H    0     0                    -21262.33419 39479.1505   286%     -   39s
H    0     0                    -21224.61064 39479.1505   286%     -   39s
H    0     0                    -16063.98938 39479.1505   346%     -   40s
     0     0 34159.8195    0  291 -16063.989 34159.8195   313%     -   49s
H    0     0                    -12133.00015 34159.7555   382%     -   50s
H    0     0                    -10165.93624 34159.7555   436%     -   50s
H    0     0                    -9819.872197 34159.7555   448%     -   50s
H    0     0                    -9795.709141 34159.7555   449%     -   50s
H    0     0                    4457.6427097 33526.0782   652%     -   55s
H    0     0                    4495.1405829 33526.0782   646%     -   55s
     0     0 33526.0782    0  285 4495.14058 33526.0782   646%     -   55s
     0     0 33473.7575    0  283 4495.14058 33473.7575   645%     -   57s
     0     0 33348.3594    0  291 4495.14058 33348.3594   642%     -   58s
     0     0 33284.5560    0  277 4495.14058 33284.5560   640%     -   60s
     0     0 33272.6139    0  293 4495.14058 33272.6139   640%     -   62s
     0     0 33261.8002    0  285 4495.14058 33261.8002   640%     -   63s
     0     0 33260.0480    0  300 4495.14058 33260.0480   640%     -   63s
     0     0 33260.0480    0  301 4495.14058 33260.0480   640%     -   64s
     0     0 33260.0480    0  302 4495.14058 33260.0480   640%     -   64s
     0     0 33260.0480    0  300 4495.14058 33260.0480   640%     -   65s
     0     0 33260.0480    0  300 4495.14058 33260.0480   640%     -   65s
     0     0 30665.0143    0  349 4495.14058 30665.0143   582%     -   75s
H    0     0                    10914.780963 30664.8361   181%     -   76s
     0     0 30116.0572    0  359 10914.7810 30116.0572   176%     -   84s
     0     0 30027.3855    0  388 10914.7810 30027.3855   175%     -   88s
     0     0 29943.1477    0  377 10914.7810 29943.1477   174%     -   91s
     0     0 29872.0978    0  377 10914.7810 29872.0978   174%     -   94s
     0     0 29834.6347    0  394 10914.7810 29834.6347   173%     -   96s
     0     0 29825.1548    0  389 10914.7810 29825.1548   173%     -   98s
     0     0 29480.9097    0  380 10914.7810 29480.9097   170%     -  102s
     0     0 29380.8451    0  383 10914.7810 29380.8451   169%     -  105s
     0     0 29371.8102    0  390 10914.7810 29371.8102   169%     -  107s
     0     0 29369.5120    0  385 10914.7810 29369.5120   169%     -  108s
     0     0 29315.9965    0  387 10914.7810 29315.9965   169%     -  110s
     0     0 29313.3619    0  390 10914.7810 29313.3619   169%     -  111s
     0     0 29306.5048    0  395 10914.7810 29306.5048   169%     -  112s
     0     0 29298.3760    0  394 10914.7810 29298.3760   168%     -  112s
     0     0 29297.8335    0  396 10914.7810 29297.8335   168%     -  113s
     0     0 28329.8659    0  414 10914.7810 28329.8659   160%     -  128s
H    0     0                    11402.031153 28329.5286   148%     -  128s
H    0     0                    11520.515051 28329.5286   146%     -  129s
H    0     0                    11621.428199 28329.5286   144%     -  129s
     0     0 27945.0219    0  434 11621.4282 27945.0219   140%     -  138s
     0     0 27802.7290    0  379 11621.4282 27802.7290   139%     -  145s
     0     0 27728.0003    0  437 11621.4282 27728.0003   139%     -  150s
     0     0 27699.7985    0  441 11621.4282 27699.7985   138%     -  152s
     0     0 27656.2642    0  447 11621.4282 27656.2642   138%     -  154s
     0     0 27614.1446    0  447 11621.4282 27614.1446   138%     -  156s
     0     0 27595.7538    0  452 11621.4282 27595.7538   137%     -  157s
     0     0 27588.2412    0  457 11621.4282 27588.2412   137%     -  158s
     0     0 27585.9562    0  456 11621.4282 27585.9562   137%     -  159s
     0     0 27581.9595    0  450 11621.4282 27581.9595   137%     -  159s
     0     0 27565.6097    0  445 11621.4282 27565.6097   137%     -  160s
     0     0 27562.9728    0  452 11621.4282 27562.9728   137%     -  160s
     0     0 27560.7564    0  458 11621.4282 27560.7564   137%     -  161s
     0     0 27554.9414    0  449 11621.4282 27554.9414   137%     -  161s
     0     0 27553.6004    0  453 11621.4282 27553.6004   137%     -  161s
     0     0 27552.9266    0  453 11621.4282 27552.9266   137%     -  162s
     0     0 27124.6047    0  451 11621.4282 27124.6047   133%     -  170s
     0     0 26971.8613    0  453 11621.4282 26971.8613   132%     -  175s
     0     0 26888.4723    0  448 11621.4282 26888.4723   131%     -  178s
     0     0 26867.4732    0  448 11621.4282 26867.4732   131%     -  179s
     0     0 26860.6628    0  446 11621.4282 26860.6628   131%     -  180s
     0     0 26848.8329    0  451 11621.4282 26848.8329   131%     -  181s
     0     0 26842.0488    0  449 11621.4282 26842.0488   131%     -  182s
     0     0 26837.1058    0  450 11621.4282 26837.1058   131%     -  183s
     0     0 26835.2395    0  452 11621.4282 26835.2395   131%     -  183s
     0     0 26834.3251    0  453 11621.4282 26834.3251   131%     -  184s
     0     0 26762.8446    0  484 11621.4282 26762.8446   130%     -  187s
     0     0 26744.6770    0  496 11621.4282 26744.6770   130%     -  188s
     0     0 26736.3990    0  494 11621.4282 26736.3990   130%     -  189s
     0     0 26730.7488    0  497 11621.4282 26730.7488   130%     -  190s
     0     0 26728.4036    0  487 11621.4282 26728.4036   130%     -  190s
     0     0 26727.6509    0  491 11621.4282 26727.6509   130%     -  190s
     0     0 26701.9279    0  466 11621.4282 26701.9279   130%     -  193s
H    0     0                    12332.637200 26701.2258   117%     -  195s
H    0     0                    12401.789983 26701.2258   115%     -  195s
     0     0 26689.2585    0  476 12401.7900 26689.2585   115%     -  197s
     0     0 26686.3938    0  472 12401.7900 26686.3938   115%     -  198s
     0     0 26684.6218    0  463 12401.7900 26684.6218   115%     -  199s
     0     0 26684.3798    0  466 12401.7900 26684.3798   115%     -  199s
     0     0 26669.9198    0  476 12401.7900 26669.9198   115%     -  201s
     0     0 26662.3826    0  465 12401.7900 26662.3826   115%     -  203s
     0     0 26660.0789    0  465 12401.7900 26660.0789   115%     -  204s
     0     0 26656.5812    0  469 12401.7900 26656.5812   115%     -  205s
     0     0 26655.0892    0  469 12401.7900 26655.0892   115%     -  205s
     0     0 26633.1424    0  468 12401.7900 26633.1424   115%     -  208s
H    0     0                    12693.436995 26633.0767   110%     -  208s
H    0     0                    14044.453250 26633.0767  89.6%     -  208s
H    0     0                    14068.616306 26633.0767  89.3%     -  209s
     0     0 26622.6963    0  471 14068.6163 26622.6963  89.2%     -  210s
     0     0 26618.0801    0  471 14068.6163 26618.0801  89.2%     -  211s
     0     0 26617.5906    0  471 14068.6163 26617.5906  89.2%     -  212s
     0     0 26606.8129    0  503 14068.6163 26606.8129  89.1%     -  213s
     0     0 26604.0919    0  469 14068.6163 26604.0919  89.1%     -  214s
     0     0 26602.7592    0  459 14068.6163 26602.7592  89.1%     -  215s
     0     0 26597.0985    0  501 14068.6163 26597.0985  89.1%     -  216s
H    0     0                    14175.964282 26596.1764  87.6%     -  221s
H    0     0                    14257.367743 26596.1764  86.5%     -  221s
     0     0 26596.1764    0  490 14257.3677 26596.1764  86.5%     -  222s
     0     0 26590.4798    0  479 14257.3677 26590.4798  86.5%     -  223s
     0     0 26586.3363    0  492 14257.3677 26586.3363  86.5%     -  224s
     0     0 26584.2805    0  469 14257.3677 26584.2805  86.5%     -  224s
     0     0 26583.1413    0  505 14257.3677 26583.1413  86.5%     -  225s
     0     0 26580.2810    0  473 14257.3677 26580.2810  86.4%     -  226s
     0     0 26579.9871    0  473 14257.3677 26579.9871  86.4%     -  227s
H    0     0                    14269.282002 26579.6288  86.3%     -  238s
H    0     0                    14293.445058 26579.6288  86.0%     -  238s
     0     2 26579.6288    0  473 14293.4451 26579.6288  86.0%     -  261s
     1     4 26250.9732    1  494 14293.4451 26579.6288  86.0%  6277  267s
     3     8 26046.9499    2  493 14293.4451 26250.5038  83.7%  6250  278s
     7    16 25886.4652    3  466 14293.4451 26046.9277  82.2%  8554  284s
    15    32 25406.0551    4  488 14293.4451 25937.6965  81.5%  7673  296s
    31    48 24695.5600    5  456 14293.4451 25405.6778  77.7% 12632  328s
    47    80 24277.8282    6  464 14293.4451 25405.6778  77.7% 10600  338s
H   50    80                    14321.546307 25405.6778  77.4% 10203  338s
H   63    80                    14363.967817 25405.6778  76.9%  9495  338s
    79   112 24008.1199    7  465 14363.9678 25405.6778  76.9%  8175  347s
   111   144 23992.0671    8  468 14363.9678 25405.6778  76.9%  6449  354s
H  139   144                    14390.170194 25405.6778  76.5%  5476  354s
   143   237 23408.9013    9  394 14390.1702 25405.6778  76.5%  5421  367s
   236   268 23948.9257   10  461 14390.1702 25405.6778  76.5%  4548  376s
   267   305 23298.3511   10  443 14390.1702 25405.6778  76.5%  4329  383s
   304   341 23727.4211   11  416 14390.1702 25405.6778  76.5%  4181  390s
   340   377 23766.1177   11  456 14390.1702 25405.6778  76.5%  4082  396s
   376   409 23332.6500   10  398 14390.1702 25405.6778  76.5%  3971  414s
   408   458 23136.8492   10  394 14390.1702 25405.6778  76.5%  3860  419s
   460   522 23331.9911   12  414 14390.1702 25405.6778  76.5%  3616  429s
   526   580 23191.8401   11  433 14390.1702 25405.6778  76.5%  3387  439s
   596   649 23440.0290   12  391 14390.1702 25405.6778  76.5%  3230  445s
H  598   649                    14445.545533 25405.6778  75.9%  3220  445s
   673   738 23446.0257   12  424 14445.5455 25405.6778  75.9%  3057  456s
   779   811 23004.3286   11  455 14445.5455 25405.6778  75.9%  2848  466s
   868   877 23414.2722   12  373 14445.5455 25405.6778  75.9%  2756  475s
   966   946 23267.2673   13  410 14445.5455 25405.6778  75.9%  2674  485s
  1089  1009 21985.2072   13  318 14445.5455 25405.6778  75.9%  2549  495s
  1190  1066 22838.2765   13  390 14445.5455 25405.6778  75.9%  2496  506s
  1277  1132 22061.2656   14  375 14445.5455 25405.6778  75.9%  2485  515s
  1374  1193 22968.7205   14  407 14445.5455 25405.6778  75.9%  2474  527s
  1474  1264 21679.0026   14  307 14445.5455 25405.6778  75.9%  2466  538s
  1610  1327 21925.8925   13  303 14445.5455 25405.6778  75.9%  2403  550s
  1740  1401 21733.2451   13  295 14445.5455 25405.6778  75.9%  2375  563s
  1847  1489 20486.4081   15  296 14445.5455 25405.6778  75.9%  2360  575s
  1963  1591 20887.2367   16  274 14445.5455 25405.6778  75.9%  2347  587s
  2095  1672 20314.9941   18  336 14445.5455 25405.6778  75.9%  2329  600s
  2234  1796 20110.0701   21  315 14445.5455 24934.2251  72.6%  2307  613s
  2408  1916 19923.2398   25  316 14445.5455 24934.2251  72.6%  2264  627s
  2609  2015 19579.8134   26  158 14445.5455 24934.2251  72.6%  2200  640s
  2791  2139 18813.4724   33  127 14445.5455 24934.2251  72.6%  2166  653s
  2951  2243 infeasible   40      14445.5455 24320.1691  68.4%  2168  666s
  3107  2355 17691.8830   45   76 14445.5455 24030.8870  66.4%  2159  679s
  3253  2504 17674.3030   46   76 14445.5455 24030.8870  66.4%  2158  695s
  3427  2707 17436.6255   47   55 14445.5455 23891.2875  65.4%  2146  710s
  3695  2708 22768.1365   13  473 14445.5455 23889.1179  65.4%  2093  767s
  3697  2709 19047.8427   26  238 14445.5455 23889.1179  65.4%  2092  800s
  3698  2710 18025.4009   43  417 14445.5455 23889.1179  65.4%  2091  823s
  3699  2711 17051.7854   47  448 14445.5455 23889.1179  65.4%  2091  845s
  3700  2711 22038.4473   14  472 14445.5455 23889.1179  65.4%  2090  855s
  3701  2712 15952.4224   21  447 14445.5455 23889.1179  65.4%  2090  864s
  3702  2713 18360.2489   51  460 14445.5455 23889.1179  65.4%  2089  873s
  3703  2713 17120.0569   33  460 14445.5455 23889.1179  65.4%  2089  877s
  3704  2714 17969.6823   17  460 14445.5455 23889.1179  65.4%  2088  881s
  3705  2715 21129.3061   16  499 14445.5455 23889.1179  65.4%  2087  885s
  3706  2715 17511.1921   25  512 14445.5455 23889.1179  65.4%  2087  891s
  3708  2717 19354.2974   13  479 14445.5455 23889.1179  65.4%  2086  895s
  3710  2718 17524.0363   53  459 14445.5455 23889.1179  65.4%  2085  905s
  3711  2719 18416.0502   30  494 14445.5455 23889.1179  65.4%  2084  910s
  3713  2720 21456.9039   15  401 14445.5455 23889.1179  65.4%  2083  915s
  3714  2721 20092.9985   35  489 14445.5455 23889.1179  65.4%  2082  921s
  3716  2722 22669.5046   10  376 14445.5455 23889.1179  65.4%  2081  926s
  3718  2723 16099.9409   17  483 14445.5455 23889.1179  65.4%  2080  933s
  3719  2724 21859.5183   17  379 14445.5455 23889.1179  65.4%  2080  936s
  3720  2725 21696.5795   10  456 14445.5455 23889.1179  65.4%  2079  944s
  3721  2725 17962.2735   54  459 14445.5455 23889.1179  65.4%  2078  946s
  3722  2726 15450.0001   35  468 14445.5455 23889.1179  65.4%  2078  951s
  3724  2727 21217.6176   20  395 14445.5455 23889.1179  65.4%  2077  957s
  3726  2729 23167.0761   12  464 14445.5455 23889.1179  65.4%  2076  962s
  3727  2729 19061.9230   38  470 14445.5455 23889.1179  65.4%  2075  965s
  3729  2731 15806.3851   59  435 14445.5455 23889.1179  65.4%  2074 1002s
  3730  2731 17258.5321   62  435 14445.5455 23889.1179  65.4%  2073 1033s
  3731  2734 23889.1179   11  426 14445.5455 23889.1179  65.4%  2133 1049s
  3732  2737 23889.1179   12  404 14445.5455 23889.1179  65.4%  2134 1064s
  3735  2742 23765.1048   13  398 14445.5455 23889.1179  65.4%  2138 1081s
  3741  2752 23630.5016   14  389 14445.5455 23889.1179  65.4%  2148 1100s
  3753  2760 23889.1179   14  476 14445.5455 23889.1179  65.4%  2167 1120s
  3765  2788 23453.7777   15  376 14445.5455 23889.1179  65.4%  2226 1150s
  3797  2831 22787.6193   16  342 14445.5455 23889.1179  65.4%  2299 1171s
  3851  2865 22553.8626   17  303 14445.5455 23889.1179  65.4%  2395 1190s
  3905  2895 22475.0651   17  334 14445.5455 23889.1179  65.4%  2411 1207s
  3973  2929 22429.3662   18  294 14445.5455 23889.1179  65.4%  2426 1230s
H 4007  2780                    15004.636840 23889.1179  59.2%  2440 1230s
H 4039  2639                    15090.661932 23889.1179  58.3%  2445 1230s
  4041  2714 20886.4012   18  321 15090.6619 23889.1179  58.3%  2447 1247s
  4135  2740 20997.9712   19  288 15090.6619 23889.1179  58.3%  2474 1261s
H 4195  2596                    15103.073464 23889.1179  58.2%  2473 1261s
  4230  2642 21653.2176   19  346 15103.0735 23889.1179  58.2%  2478 1278s
  4323  2660 19239.0752   20  363 15103.0735 23889.1179  58.2%  2480 1289s
H 4356  2532                    15123.953346 23889.1179  58.0%  2479 1289s
  4398  2546 21838.4679   19  260 15123.9533 23889.1179  58.0%  2491 1305s
  4486  2554 16750.0425   20  180 15123.9533 23889.1179  58.0%  2489 1316s
  4560  2572     cutoff   22      15123.9533 23889.1179  58.0%  2490 1336s
  4643  2580 18779.1207   24  406 15123.9533 23889.1179  58.0%  2490 1347s
  4720  2586 16119.5243   24  183 15123.9533 23889.1179  58.0%  2494 1363s
  4821  2579 15603.5810   25  182 15123.9533 23889.1179  58.0%  2487 1375s
  4903  2581 18555.2588   25  320 15123.9533 23889.1179  58.0%  2493 1395s
  4997  2583 18142.7177   26  439 15123.9533 23358.0064  54.4%  2492 1409s
  5074  2593 17501.7710   26  417 15123.9533 23358.0064  54.4%  2495 1424s
  5174  2608     cutoff   26      15123.9533 23358.0064  54.4%  2502 1438s
  5274  2644 15451.5556   27  403 15123.9533 23244.7632  53.7%  2503 1451s
  5366  2635 15447.9362   28  400 15123.9533 23244.7632  53.7%  2513 1460s
  5404  2643 16236.2231   29  347 15123.9533 23113.1471  52.8%  2515 1468s
  5447  2653 15428.6584   29  402 15123.9533 23113.1471  52.8%  2516 1481s
  5505  2675 15420.9596   30  407 15123.9533 23062.5598  52.5%  2515 1497s
  5602  2697 21184.3908   17  321 15123.9533 23019.1846  52.2%  2517 1513s
  5735  2734 19686.6825   20  225 15123.9533 23008.5281  52.1%  2515 1530s
  5865  2761 18864.5042   26  107 15123.9533 23008.5281  52.1%  2519 1552s
  5982  2763 18352.4666   28  347 15123.9533 22968.7186  51.9%  2532 1572s
  6086  2794     cutoff   24      15123.9533 22726.7922  50.3%  2532 1591s
  6236  2831 17216.5872   22  215 15123.9533 22647.3122  49.7%  2534 1615s
  6389  2842     cutoff   27      15123.9533 22647.3122  49.7%  2542 1645s
  6552  2849 15340.6659   30  299 15123.9533 22647.3122  49.7%  2547 1667s
  6717  2876 19364.0213   20  323 15123.9533 22647.3122  49.7%  2555 1689s
  6887  2896 18775.1698   22  219 15123.9533 22513.8532  48.9%  2566 1708s
  7031  2914 15646.8733   26  268 15123.9533 22475.0574  48.6%  2574 1728s
  7152  2934 19540.2426   19  410 15123.9533 22422.2490  48.3%  2575 1748s
  7285  2974 15833.3436   20  188 15123.9533 22283.1707  47.3%  2566 1772s
  7506  3036 18248.7040   20  286 15123.9533 22094.1406  46.1%  2567 1797s
  7752  3028 15881.9954   24  300 15123.9533 22024.8252  45.6%  2564 1826s
  7993  3064     cutoff   23      15123.9533 21926.9320  45.0%  2570 1855s
  8246  3119 16866.8968   25  340 15123.9533 21890.8444  44.7%  2581 1883s
  8519  3107 15913.9458   33  285 15123.9533 21833.3870  44.4%  2584 1908s
  8773  3128 18380.0774   20  321 15123.9533 21831.9175  44.4%  2578 1937s
  9055  3139 16188.7300   26  179 15123.9533 21767.8205  43.9%  2580 1966s
  9327  3172 17514.3881   24  298 15123.9533 21652.1529  43.2%  2590 2000s
  9661  3222 19386.1812   23  404 15123.9533 21573.4083  42.6%  2591 2030s
 10059  3194 17617.1622   27  359 15123.9533 21572.2745  42.6%  2580 2064s
 10453  3189 18136.2207   23  343 15123.9533 21473.4611  42.0%  2572 2101s
 10843  3290 19576.3009   22  298 15123.9533 21473.4611  42.0%  2575 2138s
 11254  3378 18759.3466   24  151 15123.9533 21206.0936  40.2%  2572 2176s
 11653  3496     cutoff   34      15123.9533 20963.4374  38.6%  2577 2217s
 12083  3613 16519.4787   29  269 15123.9533 20930.4251  38.4%  2578 2258s
 12519  3720 17184.8278   22  337 15123.9533 20658.8039  36.6%  2581 2304s
 12977  3855 18134.3364   22  302 15123.9533 20613.7239  36.3%  2584 2348s
 13432  4039 16158.9624   27  301 15123.9533 20605.1550  36.2%  2576 2400s
 13962  4176 18458.1610   25  229 15123.9533 20482.3506  35.4%  2574 2448s
 14432  4309 16014.9954   30  189 15123.9533 20271.1526  34.0%  2581 2500s
 14993  4429 18590.4163   22  334 15123.9533 20149.6343  33.2%  2581 2551s
 15543  4550 16067.3079   26  423 15123.9533 20099.4097  32.9%  2586 2606s
 16129  4656 16779.2616   29  366 15123.9533 19925.6566  31.7%  2593 2662s
 16766  4769 17312.0084   21  209 15123.9533 19724.5740  30.4%  2594 2719s
 17433  4865 16076.2910   27  390 15123.9533 19620.2688  29.7%  2595 2778s
 18163  4863 15450.0953   25  257 15123.9533 19496.1030  28.9%  2592 2819s
 18269  4935     cutoff   26      15123.9533 19496.1030  28.9%  2593 2874s
 18783  4975 16709.3490   26  388 15123.9533 19483.6593  28.8%  2595 2940s
 19564  5027 17968.9299   24  162 15123.9533 19284.5997  27.5%  2591 3011s
 20369  5087     cutoff   25      15123.9533 19113.7195  26.4%  2589 3080s
 21189  5129 16836.3714   23  455 15123.9533 18968.0697  25.4%  2590 3154s
 22101  5093 16007.9795   30  427 15123.9533 18825.6508  24.5%  2583 3229s
 22986  5120 15181.2571   31   20 15123.9533 18668.0539  23.4%  2583 3307s
 23953  5147 16465.0003   24  361 15123.9533 18559.2048  22.7%  2577 3388s
 24965  5118 17198.6844   30  261 15123.9533 18405.3366  21.7%  2571 3473s
 26018  5109 15874.0490   32  200 15123.9533 18278.4511  20.9%  2565 3559s
 27225  5008     cutoff   25      15123.9533 18147.7878  20.0%  2544 3600s

Cutting planes:
  Learned: 1
  MIR: 736
  Flow cover: 1962
  RLT: 45
  Relax-and-lift: 198

Explored 27903 nodes (70912455 simplex iterations) in 3600.04 seconds (10399.15 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15124 15103.1 15090.7 ... 14269.3

Time limit reached
Best objective 1.512395334581e+04, best bound 1.799870241346e+04, gap 19.0079%
  WARNING: Time limit reached. Using best solution found (gap: 19.01%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 15123.95, θ = 162252.85
  Upper Bound (UB) = 15123.95

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 162252.85
  [DEBUG]   ✓ Scenario 0: θ = 162252.85 ≤ Q = 162252.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 162252.85 ≤ Q = 162252.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 162252.85 ≤ Q = 162252.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 162252.85 ≤ Q = 162252.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 162252.85 ≤ Q = 162252.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 162252.85 ≤ Q = 162252.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 162252.85 ≤ Q = 162252.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 162252.85 ≤ Q = 162252.85 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7281f2cb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7281f2cb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.363433e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 7023819.8169
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.471904e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147190.37    0  130 7023819.82 -147190.37   102%     -    0s
H    0     0                    -110502.4919 -147190.37  33.2%     -    0s
H    0     0                    -110742.5282 -147190.37  32.9%     -    0s
H    0     0                    -114566.6317 -124945.04  9.06%     -    0s
H    0     0                    -120147.1846 -124945.04  3.99%     -    0s
     0     0 -124945.04    0   35 -120147.18 -124945.04  3.99%     -    0s
H    0     0                    -124222.9171 -124940.07  0.58%     -    0s
H    0     0                    -124753.5367 -124940.07  0.15%     -    0s
     0     0 -124857.45    0   34 -124753.54 -124857.45  0.08%     -    0s
     0     0 -124821.62    0    6 -124753.54 -124821.62  0.05%     -    0s
     0     0 -124817.28    0    6 -124753.54 -124817.28  0.05%     -    0s
*    0     0               0    -124794.8952 -124794.90  0.00%     -    0s

Cutting planes:
  Gomory: 14
  Implied bound: 1
  MIR: 113
  Flow cover: 1
  RLT: 27

Explored 1 nodes (446 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -124795 -124754 -124223 ... 1.36343e+13
No other solutions better than -124795

Optimal solution found (tolerance 1.00e-06)
Best objective -1.247948952169e+05, best bound -1.247948952169e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 148065.93
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124794.90
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -124794.90 = 148065.93
  [DEBUG]   Current θ from Master = 162252.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14186.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 937.03
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2534.1916, Absolute Gap = 2534.1916, Relative Gap = 0.167561
  Not converged yet (gap = 2534.19 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394706 nonzeros
Model fingerprint: 0xf1c9448f
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 60094 rows and 24404 columns
Presolve time: 1.17s
Presolved: 78899 rows, 34016 columns, 483947 nonzeros
Variable types: 31757 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 78899 rows, 34016 columns, 483947 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31269   -9.7572626e+04   0.000000e+00   1.088974e+07      5s
   45543   -7.6126707e+03   0.000000e+00   7.955380e+06     10s
   54051    6.5545779e+03   0.000000e+00   4.483126e+06     15s
   63095    1.4757026e+04   0.000000e+00   1.604846e+06     20s
   70481    1.7284538e+04   0.000000e+00   1.351588e+07     25s
   76900    1.9347824e+04   0.000000e+00   1.310532e+08     30s
   84588    2.6081426e+04   0.000000e+00   6.263012e+06     35s
Concurrent spin time: 10.09s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.265563e+04, 75179 iterations, 44.78 seconds (77.98 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42655.6332    0  308 -190754.47 42655.6332   122%     -   46s
H    0     0                    -177415.1025 42655.6332   124%     -   46s
H    0     0                    -160772.8720 42655.6332   127%     -   46s
H    0     0                    -160689.3504 42655.6332   127%     -   46s
H    0     0                    -150099.3195 42655.6332   128%     -   46s
H    0     0                    -144427.1461 42655.6332   130%     -   46s
H    0     0                    -141113.2948 42655.6332   130%     -   47s
H    0     0                    -134339.8902 42655.6332   132%     -   47s
H    0     0                    -76610.93887 42655.6332   156%     -   47s
H    0     0                    -76347.31532 42655.6332   156%     -   47s
H    0     0                    -32343.15451 42655.6332   232%     -   47s
H    0     0                    -22295.03967 42655.6332   291%     -   47s
H    0     0                    -22273.07684 42655.6332   292%     -   47s
H    0     0                    -1317.635361 36719.8564  2887%     -   59s
H    0     0                    -690.6860626 36719.8564  5416%     -   59s
H    0     0                    -100.8629262 36719.8564      -     -   59s
     0     0 36719.8564    0  309 -100.86293 36719.8564      -     -   59s
H    0     0                    1795.1326449 36717.2929  1945%     -   59s
H    0     0                    4050.6853696 36717.2929   806%     -   59s
H    0     0                    4148.9300200 36717.2929   785%     -   59s
H    0     0                    4242.3102444 36717.2929   766%     -   59s
H    0     0                    4421.1163754 36717.2929   730%     -   59s
     0     0 36204.8600    0  305 4421.11638 36204.8600   719%     -   63s
     0     0 35902.7425    0  304 4421.11638 35902.7425   712%     -   66s
     0     0 35726.8522    0  315 4421.11638 35726.8522   708%     -   68s
     0     0 35686.6663    0  318 4421.11638 35686.6663   707%     -   68s
     0     0 35658.3690    0  304 4421.11638 35658.3690   707%     -   69s
     0     0 35656.7394    0  310 4421.11638 35656.7394   707%     -   70s
     0     0 35655.2691    0  307 4421.11638 35655.2691   706%     -   72s
     0     0 35653.7861    0  301 4421.11638 35653.7861   706%     -   72s
     0     0 35652.7342    0  303 4421.11638 35652.7342   706%     -   72s
     0     0 35652.5320    0  303 4421.11638 35652.5320   706%     -   72s
H    0     0                    4711.4859162 32425.3848   588%     -   87s
H    0     0                    4713.8326769 32425.3848   588%     -   87s
H    0     0                    4870.6533097 32425.3848   566%     -   87s
H    0     0                    5366.2846402 32425.3848   504%     -   87s
H    0     0                    5446.4019605 32425.3848   495%     -   87s
     0     0 32275.8872    0  379 5446.40196 32275.8872   493%     -   87s
H    0     0                    10366.900558 32275.8872   211%     -   87s
     0     0 31632.6098    0  397 10366.9006 31632.6098   205%     -   94s
     0     0 31431.3376    0  422 10366.9006 31431.3376   203%     -   98s
     0     0 31253.3049    0  431 10366.9006 31253.3049   201%     -  102s
     0     0 31174.3859    0  435 10366.9006 31174.3859   201%     -  105s
     0     0 31147.8142    0  437 10366.9006 31147.8142   200%     -  106s
     0     0 31139.3075    0  434 10366.9006 31139.3075   200%     -  107s
     0     0 31139.1188    0  428 10366.9006 31139.1188   200%     -  107s
H    0     0                    10929.646981 29008.6786   165%     -  127s
     0     0 29008.6786    0  442 10929.6470 29008.6786   165%     -  127s
H    0     0                    10947.567561 29008.2166   165%     -  128s
H    0     0                    10948.948045 29008.2166   165%     -  128s
H    0     0                    11064.016599 29008.2166   162%     -  128s
H    0     0                    11201.238466 29008.2166   159%     -  128s
     0     0 28755.6851    0  491 11201.2385 28755.6851   157%     -  135s
     0     0 28652.6165    0  455 11201.2385 28652.6165   156%     -  138s
H    0     0                    12201.002627 28570.3315   134%     -  143s
H    0     0                    12277.366553 28570.3315   133%     -  143s
H    0     0                    12299.698578 28570.3315   132%     -  143s
     0     0 28570.3315    0  503 12299.6986 28570.3315   132%     -  143s
     0     0 28510.7434    0  492 12299.6986 28510.7434   132%     -  147s
     0     0 28482.0868    0  458 12299.6986 28482.0868   132%     -  150s
     0     0 28459.2059    0  473 12299.6986 28459.2059   131%     -  152s
     0     0 28450.0372    0  470 12299.6986 28450.0372   131%     -  154s
     0     0 28447.9013    0  471 12299.6986 28447.9013   131%     -  154s
     0     0 28445.9956    0  474 12299.6986 28445.9956   131%     -  155s
H    0     0                    13866.087195 27556.5974  98.7%     -  173s
     0     0 27556.5974    0  468 13866.0872 27556.5974  98.7%     -  173s
     0     0 27320.9160    0  453 13866.0872 27320.9160  97.0%     -  179s
     0     0 27262.3700    0  474 13866.0872 27262.3700  96.6%     -  181s
     0     0 27237.0802    0  478 13866.0872 27237.0802  96.4%     -  184s
     0     0 27197.4673    0  483 13866.0872 27197.4673  96.1%     -  186s
     0     0 27170.8095    0  490 13866.0872 27170.8095  96.0%     -  188s
     0     0 27148.9794    0  492 13866.0872 27148.9794  95.8%     -  190s
     0     0 27129.2818    0  492 13866.0872 27129.2818  95.7%     -  192s
     0     0 27114.5260    0  491 13866.0872 27114.5260  95.5%     -  193s
     0     0 27105.2858    0  494 13866.0872 27105.2858  95.5%     -  194s
     0     0 27079.8762    0  505 13866.0872 27079.8762  95.3%     -  196s
     0     0 27077.4007    0  503 13866.0872 27077.4007  95.3%     -  197s
     0     0 27075.6630    0  507 13866.0872 27075.6630  95.3%     -  197s
     0     0 26912.3430    0  461 13866.0872 26912.3430  94.1%     -  203s
     0     0 26862.9965    0  471 13866.0872 26862.9965  93.7%     -  206s
     0     0 26837.9581    0  472 13866.0872 26837.9581  93.6%     -  209s
     0     0 26831.6068    0  464 13866.0872 26831.6068  93.5%     -  209s
     0     0 26807.3291    0  468 13866.0872 26807.3291  93.3%     -  212s
     0     0 26790.2387    0  469 13866.0872 26790.2387  93.2%     -  214s
     0     0 26788.3037    0  472 13866.0872 26788.3037  93.2%     -  215s
     0     0 26745.1757    0  477 13866.0872 26745.1757  92.9%     -  219s
H    0     0                    14038.470914 26745.1027  90.5%     -  223s
     0     0 26723.6001    0  458 14038.4709 26723.6001  90.4%     -  225s
     0     0 26720.4757    0  483 14038.4709 26720.4757  90.3%     -  227s
     0     0 26718.2984    0  478 14038.4709 26718.2984  90.3%     -  228s
     0     0 26692.1894    0  477 14038.4709 26692.1894  90.1%     -  232s
     0     0 26687.6833    0  493 14038.4709 26687.6833  90.1%     -  233s
     0     0 26685.6409    0  504 14038.4709 26685.6409  90.1%     -  234s
     0     0 26668.9765    0  488 14038.4709 26668.9765  90.0%     -  238s
H    0     0                    14106.781522 26664.3988  89.0%     -  240s
     0     0 26664.3988    0  484 14106.7815 26664.3988  89.0%     -  240s
     0     0 26662.1076    0  476 14106.7815 26662.1076  89.0%     -  242s
     0     0 26659.4155    0  472 14106.7815 26659.4155  89.0%     -  244s
     0     0 26657.2949    0  483 14106.7815 26657.2949  89.0%     -  245s
     0     0 26651.0752    0  457 14106.7815 26651.0752  88.9%     -  247s
     0     0 26651.0105    0  457 14106.7815 26651.0105  88.9%     -  249s
H    0     0                    14172.164697 26650.8529  88.1%     -  285s
     0     2 26650.8529    0  457 14172.1647 26650.8529  88.1%     -  307s
     1     4 26509.8497    1  457 14172.1647 26650.1410  88.0%  6940  315s
     3     8 26377.4367    2  487 14172.1647 26509.8135  87.1%  7576  322s
     7    16 26076.9657    3  504 14172.1647 26375.7554  86.1%  7168  338s
    15    32 25949.9893    4  520 14172.1647 26075.6514  84.0%  9318  347s
    31    48 24469.8817    5  456 14172.1647 25949.3896  83.1% 11477  376s
    47    80 23737.3259    6  455 14172.1647 25949.3896  83.1% 14184  389s
    79   156 23629.8084    7  455 14172.1647 25949.3896  83.1% 10594  413s
   159   188 23257.9472    9  390 14172.1647 25949.3896  83.1%  7249  428s
   191   219 23062.5802    9  301 14172.1647 25949.3896  83.1%  6522  447s
   226   244 23467.6548    8  385 14172.1647 25949.3896  83.1%  5881  460s
H  261   244                    14507.268694 25949.3896  78.9%  5476  460s
   263   302 23202.4930   10  381 14507.2687 25949.3896  78.9%  5496  476s
   355   348 23034.1758    9  432 14507.2687 25949.3896  78.9%  4970  485s
H  368   348                    14531.431751 25949.3896  78.6%  5029  485s
   403   426 22955.2226   10  298 14531.4318 25949.3896  78.6%  4965  499s
   505   475 21878.1167   11  353 14531.4318 25949.3896  78.6%  4474  510s
   597   524 22566.2812   10  276 14531.4318 25949.3896  78.6%  4222  521s
   685   565 21365.9848   11  359 14531.4318 25949.3896  78.6%  4229  531s
   774   605 21401.7292   11  407 14531.4318 25949.3896  78.6%  4127  541s
   842   656 20822.9734   12  446 14531.4318 25949.3896  78.6%  4148  553s
   909   726 18631.0265   12  347 14531.4318 25949.3896  78.6%  4199  563s
   985   808 19923.2578   12  331 14531.4318 25949.3896  78.6%  4202  571s
  1087   913     cutoff   13      14531.4318 25949.3896  78.6%  4146  580s
  1209   998 16313.4739   37  182 14531.4318 25949.3896  78.6%  3989  590s
  1336  1066 19065.3744   17  243 14531.4318 25949.3896  78.6%  3857  601s
  1463  1086 18849.9304   18  170 14531.4318 25949.3896  78.6%  3744  612s
  1499  1100 17265.9376   19  157 14531.4318 25949.3896  78.6%  3762  623s
  1550  1116     cutoff   20      14531.4318 25949.3896  78.6%  3762  632s
  1604  1184     cutoff   20      14531.4318 25949.3896  78.6%  3760  644s
  1701  1259 17569.9535   20  256 14531.4318 25949.3896  78.6%  3722  655s
  1844  1324 17239.5139   21  172 14531.4318 25949.3896  78.6%  3619  669s
  1997  1395 16650.7305   22  169 14531.4318 25733.0829  77.1%  3546  682s
  2139  1423 16477.1623   23  171 14531.4318 25733.0829  77.1%  3521  696s
  2229  1487 15863.3739   26  111 14531.4318 25733.0829  77.1%  3598  709s
  2320  1545     cutoff   32      14531.4318 25733.0829  77.1%  3675  722s
  2425  1607 21351.2711    7  290 14531.4318 25733.0829  77.1%  3767  735s
  2545  1635 20024.6330    8  288 14531.4318 25733.0829  77.1%  3826  746s
  2581  1663 19176.8574    9  198 14531.4318 25733.0829  77.1%  3877  758s
H 2588  1663                    14773.699516 25733.0829  74.2%  3874  758s
  2619  1721 18755.8174   10  242 14773.6995 25733.0829  74.2%  3902  775s
  2804  1810 18155.3145   12  228 14773.6995 25702.6363  74.0%  3867  790s
  3044  1880 17450.5107   15  190 14773.6995 25702.6363  74.0%  3757  808s
  3247  1928     cutoff   17      14773.6995 25702.6363  74.0%  3727  824s
  3337  1996 16451.7495   20  194 14773.6995 25702.6363  74.0%  3827  840s
  3439  2069 15040.2621   23  248 14773.6995 25441.7951  72.2%  3914  857s
H 3602  2105                    14774.273961 24918.2110  68.7%  3952  873s
  3678  2218 23306.5431    8  326 14774.2740 24487.4769  65.7%  3981  892s
  3918  2314 20929.8107   11  217 14774.2740 24327.3206  64.7%  3967  914s
  4170  2409 16114.3734   22   97 14774.2740 23792.1108  61.0%  3931  935s
H 4345  2467                    14798.437017 23792.1108  60.8%  3988  955s
H 4361  2460                    14865.271424 23685.5185  59.3%  3990  955s
  4517  2553 19207.1186    8  233 14865.2714 23588.5877  58.7%  4000  979s
  4718  2681 16029.1723   11   71 14865.2714 23532.7547  58.3%  4022 1004s
H 4964  2668                    14898.673294 23324.5242  56.6%  4020 1056s
H 4964  2666                    14922.836351 23324.5242  56.3%  4020 1058s
  4965  2667 15843.5887   48  457 14922.8364 23324.5242  56.3%  4020 1152s
  4967  2668 19958.6398   18  291 14922.8364 23324.5242  56.3%  4018 1197s
  4968  2669 22416.2534    9  425 14922.8364 23324.5242  56.3%  4017 1223s
  4969  2670 17049.1748   39  480 14922.8364 23324.5242  56.3%  4016 1242s
  4970  2670 16728.5589   18  448 14922.8364 23324.5242  56.3%  4016 1251s
  4971  2671 15590.3692   26  455 14922.8364 23324.5242  56.3%  4015 1256s
  4972  2672 21037.2857   15  466 14922.8364 23324.5242  56.3%  4014 1262s
  4973  2672 16442.9854   16  468 14922.8364 23324.5242  56.3%  4013 1266s
  4974  2673 17010.2985   17  465 14922.8364 23324.5242  56.3%  4012 1271s
  4975  2674 16841.5449   26  481 14922.8364 23324.5242  56.3%  4011 1275s
  4977  2675 21596.7917   11  507 14922.8364 23324.5242  56.3%  4010 1280s
  4979  2676 22745.9914    8  504 14922.8364 23324.5242  56.3%  4008 1288s
  4980  2677 16605.5266   31  512 14922.8364 23324.5242  56.3%  4007 1298s
  4981  2678 16502.6343   30  494 14922.8364 23324.5242  56.3%  4007 1302s
  4982  2678 20439.0733   11  532 14922.8364 23324.5242  56.3%  4006 1306s
  4983  2679 17903.9249   41  474 14922.8364 23324.5242  56.3%  4005 1310s
  4984  2680 16968.7105   32  483 14922.8364 23324.5242  56.3%  4004 1317s
  4985  2680 20112.3015   17  499 14922.8364 23324.5242  56.3%  4003 1322s
  4986  2681 15644.0767   55  480 14922.8364 23324.5242  56.3%  4003 1328s
  4987  2682 15098.3160   32  527 14922.8364 23324.5242  56.3%  4002 1332s
  4988  2682 19397.0291   25  481 14922.8364 23324.5242  56.3%  4001 1337s
  4989  2683 21621.9979   12  479 14922.8364 23324.5242  56.3%  4000 1341s
  4990  2684 17067.3171   36  490 14922.8364 23324.5242  56.3%  3999 1350s
  4991  2684 17248.1233   14  556 14922.8364 23324.5242  56.3%  3999 1355s
  4992  2685 15356.0027   41  495 14922.8364 23324.5242  56.3%  3998 1361s
  4994  2686 16933.3203   28  488 14922.8364 23324.5242  56.3%  3996 1370s
  4995  2687 20871.3318   11  488 14922.8364 23324.5242  56.3%  3995 1406s
  4996  2688 18098.7289   18  488 14922.8364 23324.5242  56.3%  3995 1436s
  4997  2691 23324.5242   15  523 14922.8364 23324.5242  56.3%  4043 1460s
  4999  2695 23324.5242   16  512 14922.8364 23324.5242  56.3%  4044 1485s
  5003  2701 23324.5242   17  507 14922.8364 23324.5242  56.3%  4048 1503s
  5011  2715 23324.5242   18  543 14922.8364 23324.5242  56.3%  4063 1528s
  5027  2721 23324.5242   19  470 14922.8364 23324.5242  56.3%  4077 1563s
  5043  2742 22841.1453   20  462 14922.8364 23324.5242  56.3%  4129 1595s
  5071  2786 21593.2318   21  446 14922.8364 23324.5242  56.3%  4163 1629s
  5124  2799 21458.8793   22  437 14922.8364 23324.5242  56.3%  4177 1646s
  5157  2851 20882.9114   22  423 14922.8364 23324.5242  56.3%  4178 1670s
  5231  2896 20506.7943   24  398 14922.8364 23324.5242  56.3%  4169 1699s
  5337  2901 20198.4468   25  366 14922.8364 23324.5242  56.3%  4146 1717s
  5434  2909 19584.1352   25  359 14922.8364 23324.5242  56.3%  4137 1737s
  5533  2916 18967.0885   26  345 14922.8364 23324.5242  56.3%  4104 1752s
  5612  2913 18665.9092   26  201 14922.8364 23324.5242  56.3%  4084 1768s
  5697  2901 17829.1941   28  188 14922.8364 23324.5242  56.3%  4054 1784s
  5768  2896 17569.1054   31  257 14922.8364 23324.5242  56.3%  4040 1800s
  5827  2896 16431.6344   34  230 14922.8364 23324.5242  56.3%  4036 1819s
  5897  2896     cutoff   34      14922.8364 23324.5242  56.3%  4023 1833s
  5965  2915     cutoff   28      14922.8364 23324.5242  56.3%  4014 1850s
  6049  2937 21404.4025   22  477 14922.8364 23324.5242  56.3%  3994 1871s
  6136  2953 19819.0875   24  452 14922.8364 23324.5242  56.3%  3983 1888s
  6220  2947 19067.1704   25  430 14922.8364 23324.5242  56.3%  3974 1905s
  6314  2949 18704.0862   27  364 14922.8364 23324.5242  56.3%  3957 1922s
  6411  2954 17378.5572   29  173 14922.8364 23324.5242  56.3%  3940 1943s
  6523  2944     cutoff   31      14922.8364 23324.5242  56.3%  3916 1962s
  6641  2941     cutoff   32      14922.8364 23324.5242  56.3%  3897 1989s
  6725  2964 17950.5506   29  427 14922.8364 23324.5242  56.3%  3896 2009s
  6829  2990 17704.9289   31  336 14922.8364 23324.5242  56.3%  3891 2029s
  6934  2999 17365.9664   36  303 14922.8364 23324.5242  56.3%  3886 2052s
  7054  3002 16037.8077   41  206 14922.8364 23324.5242  56.3%  3874 2072s
  7219  3007 17781.5146   24  406 14922.8364 23130.4135  55.0%  3844 2095s
  7350  2999 15022.8907   24  472 14922.8364 23130.4135  55.0%  3832 2119s
  7511  2997     cutoff   25      14922.8364 23130.4135  55.0%  3806 2150s
  7662  2966 15514.6496   28  206 14922.8364 22349.2847  49.8%  3787 2175s
H 7688  2822                    14926.531817 22349.2847  49.7%  3786 2175s
  7774  2861 16021.3409   28  320 14926.5318 22349.2847  49.7%  3778 2202s
  7932  2849     cutoff   30      14926.5318 22349.2847  49.7%  3764 2227s
  8082  2835     cutoff   29      14926.5318 21719.6883  45.5%  3757 2254s
  8244  2833 infeasible   31      14926.5318 21600.4636  44.7%  3748 2281s
  8416  2840 15347.8879   26  217 14926.5318 21600.4636  44.7%  3740 2315s
  8625  2820 infeasible   26      14926.5318 21600.4636  44.7%  3717 2345s
  8847  2783 17466.0627   25  300 14926.5318 21600.4636  44.7%  3699 2373s
  9023  2780 16283.2007   31  195 14926.5318 21092.6325  41.3%  3681 2404s
  9248  2764     cutoff   33      14926.5318 20930.7872  40.2%  3661 2437s
* 9326  2609              47    15004.663961 20915.1078  39.4%  3655 2437s
* 9329  2487              49    15014.716026 20915.1078  39.3%  3654 2437s
  9490  2502 16394.0657   20  334 15014.7160 20826.4517  38.7%  3643 2469s
  9696  2493 15258.4967   26  262 15014.7160 20826.4517  38.7%  3643 2504s
 10000  2466 15373.0164   27  287 15014.7160 20801.8207  38.5%  3613 2544s
 10322  2462 17978.9973   37  168 15014.7160 20438.8639  36.1%  3583 2583s
 10664  2422     cutoff   33      15014.7160 20355.3259  35.6%  3550 2623s
 10978  2409 15169.6136   30  327 15014.7160 20167.7993  34.3%  3533 2665s
 11316  2334     cutoff   31      15014.7160 20056.1305  33.6%  3510 2707s
 11681  2306 16711.3565   30  292 15014.7160 19898.7592  32.5%  3489 2753s
 12043  2267 16140.0694   30  258 15014.7160 19708.5867  31.3%  3466 2804s
 12388  2279 16498.7638   26  416 15014.7160 19695.3058  31.2%  3455 2850s
 12770  2349     cutoff   30      15014.7160 19438.7674  29.5%  3440 2897s
 13219  2402     cutoff   35      15014.7160 19268.5536  28.3%  3415 2945s
 13629  2463 15332.1341   35  336 15014.7160 19102.7185  27.2%  3401 2996s
 14072  2484 17703.4920   30  272 15014.7160 19022.3087  26.7%  3376 3043s
 14518  2536 15327.8149   41  371 15014.7160 18890.7264  25.8%  3348 3098s
 15000  2582 16394.1238   36  147 15014.7160 18784.1403  25.1%  3330 3160s
 15511  2604 16146.5802   30  420 15014.7160 18628.3260  24.1%  3318 3222s
 16124  2578 16816.8248   31  294 15014.7160 18521.7166  23.4%  3290 3285s
 16727  2515     cutoff   30      15014.7160 18268.1312  21.7%  3269 3354s
 17408  2494     cutoff   28      15014.7160 18035.0579  20.1%  3240 3425s
 18025  2411 15502.2753   37  242 15014.7160 17862.7504  19.0%  3227 3494s
 18737  2319     cutoff   28      15014.7160 17715.1235  18.0%  3202 3564s
 19492  2191 16360.6475   40  178 15014.7160 17551.7339  16.9%  3175 3600s

Cutting planes:
  Learned: 5
  Gomory: 1
  Projected implied bound: 54
  MIR: 1235
  Mixing: 1
  Flow cover: 2285
  RLT: 25
  Relax-and-lift: 203

Explored 20000 nodes (63246193 simplex iterations) in 3600.03 seconds (10016.99 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15014.7 15004.7 14926.5 ... 14531.4

Time limit reached
Best objective 1.501471602578e+04, best bound 1.737611893889e+04, gap 15.7273%
  WARNING: Time limit reached. Using best solution found (gap: 15.73%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 15014.72, θ = 152009.91
  Upper Bound (UB) = 15014.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152009.91
  [DEBUG]   ✓ Scenario 0: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 152009.91 ≤ Q = 152009.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1e223bec
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe1ddc414
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-15, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-17, 2e+02]
Found heuristic solution: objective 1.285393e+13
Presolve removed 2594 rows and 1883 columns
Presolve time: 0.00s
Presolved: 499 rows, 506 columns, 1410 nonzeros
Found heuristic solution: objective 6181086.7939
Variable types: 341 continuous, 165 integer (165 binary)

Root relaxation: objective -1.575855e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157585.53    0  125 6181086.79 -157585.53   103%     -    0s
H    0     0                    -117930.7194 -157585.53  33.6%     -    0s
H    0     0                    -127056.3981 -157585.53  24.0%     -    0s
     0     0 -136832.18    0   58 -127056.40 -136832.18  7.69%     -    0s
H    0     0                    -134430.8313 -136739.87  1.72%     -    0s
H    0     0                    -135440.0989 -136422.22  0.73%     -    0s
     0     0 -136422.22    0   61 -135440.10 -136422.22  0.73%     -    0s
     0     0 -136417.46    0   61 -135440.10 -136417.46  0.72%     -    0s
H    0     0                    -135462.2403 -136412.63  0.70%     -    0s
     0     0 -136412.63    0   61 -135462.24 -136412.63  0.70%     -    0s
     0     0 -136094.35    0   36 -135462.24 -136094.35  0.47%     -    0s
H    0     0                    -135725.9317 -136091.58  0.27%     -    0s
     0     0 -136013.56    0   27 -135725.93 -136013.56  0.21%     -    0s
     0     0 -135994.48    0   20 -135725.93 -135994.48  0.20%     -    0s
     0     0 -135967.40    0   24 -135725.93 -135967.40  0.18%     -    0s
     0     0 -135966.89    0   24 -135725.93 -135966.89  0.18%     -    0s
     0     0 -135965.03    0   24 -135725.93 -135965.03  0.18%     -    0s
     0     0 -135799.71    0   11 -135725.93 -135799.71  0.05%     -    0s
     0     0 -135799.71    0   16 -135725.93 -135799.71  0.05%     -    0s
     0     0 -135770.11    0    9 -135725.93 -135770.11  0.03%     -    0s
H    0     0                    -135728.7191 -135767.36  0.03%     -    0s
H    0     0                    -135762.2907 -135767.36  0.00%     -    0s
     0     0 -135767.07    0    5 -135762.29 -135767.07  0.00%     -    0s
     0     0     cutoff    0      -135762.29 -135762.29  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 14
  Flow cover: 1

Explored 1 nodes (686 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -135762 -135729 -135726 ... 6.18109e+06
No other solutions better than -135762

Optimal solution found (tolerance 1.00e-06)
Best objective -1.357622906575e+05, best bound -1.357622906575e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 137098.53
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135762.29
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -135762.29 = 137098.53
  [DEBUG]   Current θ from Master = 152009.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14911.38 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 103.34
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2424.9543, Absolute Gap = 2424.9543, Relative Gap = 0.161505
  Not converged yet (gap = 2424.95 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437949 nonzeros
Model fingerprint: 0xa7a055d1
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 66760 rows and 27110 columns
Presolve time: 1.36s
Presolved: 87523 rows, 37550 columns, 533019 nonzeros
Variable types: 35291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -341056.2733
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.755e+06
 Factor NZ  : 8.145e+06 (roughly 120 MB of memory)
 Factor Ops : 1.400e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.59671682e+07  1.54630022e+08  9.72e+04 1.90e+01  6.97e+04     3s
   1  -1.19267255e+07  1.36238782e+08  6.71e+04 6.78e+01  4.76e+04     3s
   2  -3.94221932e+06  1.02110199e+08  2.21e+04 1.09e-11  1.66e+04     3s
   3  -7.56515266e+05  6.99561438e+07  1.96e+03 1.55e+00  1.81e+03     3s
   4  -4.19747680e+05  2.51012269e+07  3.67e+02 2.73e-01  3.82e+02     3s
   5  -2.97211266e+05  1.79184776e+07  1.22e+02 1.75e-01  1.82e+02     3s
   6  -1.96534566e+05  1.23058320e+07  4.83e+01 1.09e-01  1.01e+02     3s
   7  -1.18279621e+05  8.56284158e+06  1.87e+01 7.03e-02  6.13e+01     3s
   8  -8.33924371e+04  4.57364095e+06  9.45e+00 3.46e-02  3.13e+01     3s
   9  -6.80616696e+04  2.82531352e+06  6.24e+00 2.06e-02  1.90e+01     3s
  10  -3.47825920e+04  6.23956928e+05  1.85e+00 3.79e-03  4.19e+00     3s
  11  -1.01123317e+04  2.84570887e+05  1.03e+00 1.84e-03  1.86e+00     3s
  12   2.92994431e+03  1.72995132e+05  5.80e-01 1.31e-03  1.07e+00     3s
  13   6.22195521e+03  1.22397777e+05  5.01e-01 1.03e-03  7.29e-01     4s
  14   1.12258309e+04  9.96550699e+04  3.96e-01 1.26e-03  5.54e-01     4s
  15   1.55321999e+04  8.33355848e+04  3.31e-01 1.57e-03  4.25e-01     4s
  16   2.02904373e+04  7.49672200e+04  2.69e-01 1.75e-03  3.42e-01     4s
  17   2.38931752e+04  6.37613782e+04  2.23e-01 1.91e-03  2.50e-01     4s
  18   2.86318851e+04  5.79008146e+04  1.69e-01 1.96e-03  1.83e-01     4s
  19   3.20768266e+04  5.55663745e+04  1.31e-01 1.92e-03  1.47e-01     4s
  20   3.35519362e+04  5.30810454e+04  1.14e-01 3.10e-03  1.22e-01     4s
  21   3.57492271e+04  4.97189728e+04  8.94e-02 4.91e-03  8.75e-02     4s
  22   3.60475188e+04  4.88360982e+04  8.52e-02 3.49e-03  8.01e-02     4s
  23   3.75667566e+04  4.78104394e+04  6.86e-02 1.68e-03  6.42e-02     4s
  24   3.86597520e+04  4.67803508e+04  5.70e-02 1.28e-03  5.09e-02     4s
  25   3.98359545e+04  4.60912674e+04  4.52e-02 1.00e-03  3.92e-02     4s
  26   4.03963937e+04  4.57785613e+04  3.94e-02 1.01e-03  3.37e-02     4s
  27   4.14171328e+04  4.53606305e+04  2.89e-02 1.68e-03  2.47e-02     4s
  28   4.21285956e+04  4.50069751e+04  2.16e-02 1.48e-03  1.80e-02     4s
  29   4.22767235e+04  4.49539672e+04  2.01e-02 1.30e-03  1.68e-02     4s
  30   4.27689731e+04  4.48174717e+04  1.53e-02 1.03e-03  1.28e-02     4s
  31   4.32765663e+04  4.47066511e+04  1.04e-02 7.32e-04  8.96e-03     4s
  32   4.33507540e+04  4.46721188e+04  9.68e-03 6.54e-04  8.28e-03     5s
  33   4.35131376e+04  4.45452692e+04  8.10e-03 3.55e-04  6.47e-03     5s
  34   4.39958043e+04  4.44461339e+04  3.54e-03 4.62e-04  2.82e-03     5s
  35   4.42753955e+04  4.44145700e+04  9.25e-04 1.75e-04  8.71e-04     5s
  36   4.43263678e+04  4.43964797e+04  4.98e-04 3.82e-05  4.39e-04     5s
  37   4.43768922e+04  4.43950289e+04  9.35e-05 3.01e-05  1.13e-04     5s
  38   4.43836143e+04  4.43924865e+04  4.23e-05 1.42e-05  5.54e-05     5s
  39   4.43877403e+04  4.43904771e+04  1.41e-05 2.38e-06  1.71e-05     5s
  40   4.43895479e+04  4.43899870e+04  2.68e-06 3.23e-07  2.75e-06     5s
  41   4.43898471e+04  4.43899822e+04  8.13e-07 1.06e-07  8.45e-07     5s
  42   4.43898924e+04  4.43899831e+04  3.63e-06 1.22e-06  5.68e-07     5s
  43   4.43899214e+04  4.43899830e+04  3.74e-06 1.12e-06  3.87e-07     5s
  44   4.43899496e+04  4.43899827e+04  1.97e-06 9.85e-07  2.08e-07     5s
  45   4.43899549e+04  4.43899817e+04  1.69e-06 3.49e-07  1.68e-07     5s
  46   4.43899718e+04  4.43899810e+04  6.63e-07 1.23e-08  5.80e-08     5s
  47   4.43899810e+04  4.43899810e+04  7.21e-09 5.20e-11  3.25e-11     5s

Barrier solved model in 47 iterations and 5.43 seconds (7.18 work units)
Optimal objective 4.43899810e+04


Root crossover log...

   70993 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2010 PPushes remaining with PInf 3.7776641e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.4271306e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   27005    4.4389981e+04   0.000000e+00   0.000000e+00      7s
   27005    4.4389981e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.438998e+04, 27005 iterations, 4.73 seconds (8.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 44389.9810    0  377 -190754.47 44389.9810   123%     -    7s
H    0     0                    -178739.6584 44389.9810   125%     -    7s
H    0     0                    -166445.7292 44389.9810   127%     -    7s
H    0     0                    -149122.5621 44389.9810   130%     -    7s
H    0     0                    -147785.9420 44389.9810   130%     -    7s
H    0     0                    -60193.11837 44389.9810   174%     -    7s
H    0     0                    -55098.18224 44389.9810   181%     -    7s
H    0     0                    -33815.36928 44389.9810   231%     -    8s
H    0     0                    -33603.77950 44389.9810   232%     -    8s
H    0     0                    -33398.86488 44389.9810   233%     -    8s
H    0     0                    -33323.55019 44389.9810   233%     -    8s
H    0     0                    -33291.45173 44389.9810   233%     -    8s
H    0     0                    -33156.34787 44389.9810   234%     -    8s
H    0     0                    -11831.69390 44389.9810   475%     -    9s
H    0     0                    -10708.10464 44389.9810   515%     -    9s
H    0     0                    -8691.867016 44389.9810   611%     -    9s
     0     0 38145.4515    0  438 -8691.8670 38145.4515   539%     -   25s
H    0     0                    -6257.036466 38144.9188   710%     -   25s
     0     0 37462.5801    0  428 -6257.0365 37462.5801   699%     -   36s
     0     0 37267.6949    0  426 -6257.0365 37267.6949   696%     -   44s
     0     0 37267.6949    0  421 -6257.0365 37267.6949   696%     -   46s
     0     0 37267.6949    0  418 -6257.0365 37267.6949   696%     -   49s
     0     0 37267.6949    0  426 -6257.0365 37267.6949   696%     -   50s
     0     0 37265.8698    0  411 -6257.0365 37265.8698   696%     -   50s
     0     0 37265.1616    0  417 -6257.0365 37265.1616   696%     -   51s
H    0     0                    -3408.493887 33512.6022  1083%     -   72s
H    0     0                    -3149.009069 33512.6022  1164%     -   72s
H    0     0                    -2979.567746 33512.6022  1225%     -   72s
H    0     0                    -2927.517060 33512.6022  1245%     -   72s
     0     0 33512.6022    0  437 -2927.5171 33512.6022  1245%     -   72s
H    0     0                    -905.4490166 33512.4910  3801%     -   72s
H    0     0                    -722.7767320 33512.4910  4737%     -   72s
     0     0 32479.8236    0  408 -722.77673 32479.8236  4594%     -   88s
     0     0 32297.3659    0  410 -722.77673 32297.3659  4569%     -   98s
     0     0 32120.2623    0  435 -722.77673 32120.2623  4544%     -  107s
     0     0 31766.0665    0  489 -722.77673 31766.0665  4495%     -  116s
H    0     0                    1239.8549553 31709.8487  2458%     -  120s
     0     0 31709.8487    0  465 1239.85496 31709.8487  2458%     -  120s
     0     0 31700.2708    0  450 1239.85496 31700.2708  2457%     -  122s
H    0     0                    1700.2705897 31685.9167  1764%     -  123s
H    0     0                    1759.5498348 31685.9167  1701%     -  123s
H    0     0                    1795.9411689 31685.9167  1664%     -  123s
H    0     0                    1801.6291381 31685.9167  1659%     -  123s
     0     0 31685.9167    0  457 1801.62914 31685.9167  1659%     -  124s
     0     0 31667.3449    0  477 1801.62914 31667.3449  1658%     -  126s
     0     0 31566.1551    0  450 1801.62914 31566.1551  1652%     -  131s
     0     0 31556.1006    0  468 1801.62914 31556.1006  1652%     -  133s
     0     0 31544.9050    0  471 1801.62914 31544.9050  1651%     -  134s
     0     0 31539.6152    0  475 1801.62914 31539.6152  1651%     -  136s
     0     0 31537.1238    0  468 1801.62914 31537.1238  1650%     -  136s
     0     0 31536.6065    0  474 1801.62914 31536.6065  1650%     -  137s
H    0     0                    1931.0855427 29565.3639  1431%     -  176s
H    0     0                    3992.4113223 29565.3639   641%     -  176s
H    0     0                    4175.0836068 29565.3639   608%     -  176s
H    0     0                    4327.4213101 29565.3639   583%     -  176s
     0     0 29565.3639    0  463 4327.42131 29565.3639   583%     -  177s
     0     0 28929.6298    0  470 4327.42131 28929.6298   569%     -  193s
     0     0 28670.4849    0  473 4327.42131 28670.4849   563%     -  204s
     0     0 28600.5209    0  472 4327.42131 28600.5209   561%     -  209s
     0     0 28583.1195    0  475 4327.42131 28583.1195   561%     -  212s
     0     0 28549.2907    0  478 4327.42131 28549.2907   560%     -  216s
     0     0 28525.0337    0  488 4327.42131 28525.0337   559%     -  219s
     0     0 28517.6804    0  487 4327.42131 28517.6804   559%     -  220s
     0     0 28500.1516    0  485 4327.42131 28500.1516   559%     -  223s
     0     0 28491.0636    0  492 4327.42131 28491.0636   558%     -  225s
     0     0 28458.4965    0  490 4327.42131 28458.4965   558%     -  227s
     0     0 28453.5243    0  501 4327.42131 28453.5243   558%     -  228s
     0     0 28451.1640    0  493 4327.42131 28451.1640   557%     -  229s
     0     0 27558.0567    0  516 4327.42131 27558.0567   537%     -  250s
     0     0 27395.4764    0  490 4327.42131 27395.4764   533%     -  258s
     0     0 27337.9912    0  486 4327.42131 27337.9912   532%     -  263s
     0     0 27292.4170    0  531 4327.42131 27292.4170   531%     -  267s
     0     0 27271.1104    0  527 4327.42131 27271.1104   530%     -  272s
     0     0 27248.9650    0  532 4327.42131 27248.9650   530%     -  274s
     0     0 27238.5132    0  540 4327.42131 27238.5132   529%     -  276s
     0     0 27223.6325    0  528 4327.42131 27223.6325   529%     -  281s
     0     0 27213.6285    0  530 4327.42131 27213.6285   529%     -  283s
H    0     0                    4359.1298332 27207.7958   524%     -  285s
     0     0 27207.7958    0  543 4359.12983 27207.7958   524%     -  285s
     0     0 27206.5204    0  547 4359.12983 27206.5204   524%     -  286s
     0     0 27013.8591    0  482 4359.12983 27013.8591   520%     -  295s
     0     0 26960.1564    0  468 4359.12983 26960.1564   518%     -  301s
     0     0 26944.5783    0  466 4359.12983 26944.5783   518%     -  304s
     0     0 26938.8048    0  472 4359.12983 26938.8048   518%     -  306s
     0     0 26935.9709    0  475 4359.12983 26935.9709   518%     -  307s
     0     0 26858.0947    0  472 4359.12983 26858.0947   516%     -  316s
H    0     0                    6086.2335077 26858.0318   341%     -  321s
H    0     0                    9960.0286433 26858.0318   170%     -  321s
H    0     0                    12208.834896 26858.0318   120%     -  321s
     0     0 26835.5517    0  471 12208.8349 26835.5517   120%     -  324s
     0     0 26825.8254    0  461 12208.8349 26825.8254   120%     -  326s
     0     0 26816.8485    0  468 12208.8349 26816.8485   120%     -  328s
     0     0 26813.7227    0  467 12208.8349 26813.7227   120%     -  329s
     0     0 26812.7058    0  466 12208.8349 26812.7058   120%     -  330s
     0     0 26778.7219    0  464 12208.8349 26778.7219   119%     -  334s
H    0     0                    12241.626253 26774.3724   119%     -  335s
H    0     0                    12265.789309 26774.3724   118%     -  335s
H    0     0                    12605.524050 26774.3724   112%     -  335s
H    0     0                    12734.668080 26774.3724   110%     -  335s
H    0     0                    12758.831137 26774.3724   110%     -  335s
H    0     0                    12800.087291 26774.3724   109%     -  335s
     0     0 26751.6582    0  467 12800.0873 26751.6582   109%     -  337s
     0     0 26746.4040    0  465 12800.0873 26746.4040   109%     -  339s
     0     0 26744.8278    0  478 12800.0873 26744.8278   109%     -  340s
     0     0 26729.7816    0  469 12800.0873 26729.7816   109%     -  343s
     0     0 26727.6778    0  466 12800.0873 26727.6778   109%     -  345s
     0     0 26718.7063    0  470 12800.0873 26718.7063   109%     -  348s
     0     0 26717.6946    0  471 12800.0873 26717.6946   109%     -  349s
     0     0 26712.5177    0  468 12800.0873 26712.5177   109%     -  351s
     0     0 26712.2964    0  468 12800.0873 26712.2964   109%     -  354s
H    0     0                    13148.335995 26712.2964   103%     -  407s
H    0     0                    13318.183949 26712.2964   101%     -  414s
H    0     0                    13557.027077 26712.2964  97.0%     -  416s
H    0     0                    13581.190133 26712.2964  96.7%     -  417s
     0     2 26712.2964    0  468 13581.1901 26712.2964  96.7%     -  418s
     1     3 25210.7476    1  471 13581.1901 26712.2964  96.7% 16495  432s
     2     6 24863.3969    2  457 13581.1901 26712.2964  96.7% 11933  438s
     5     9 26009.6230    2  480 13581.1901 26588.0863  95.8%  7954  450s
     8    18 25490.4160    3  473 13581.1901 26588.0863  95.8%  9588  461s
    17    36 25315.3916    4  522 13581.1901 26198.7309  92.9%  7641  486s
    35    50 24187.1413    4  461 13581.1901 26013.5263  91.5% 14556  524s
    49    78 25331.7140    6  485 13581.1901 26013.5263  91.5% 13298  553s
H   68    78                    13588.055717 26013.5263  91.4% 10693  553s
    77   174 24958.5372    7  478 13588.0557 26013.5263  91.4%  9927  604s
   173   206 24942.7269    9  470 13588.0557 26013.5263  91.4%  6182  619s
   205   238 24257.7513   10  446 13588.0557 26013.5263  91.4%  5641  635s
H  209   238                    13668.776407 26013.5263  90.3%  5625  635s
H  217   238                    13714.575999 26013.5263  89.7%  5515  635s
   237   338 24074.8309   11  459 13714.5760 26013.5263  89.7%  5294  657s
   337   414 23555.0794   15  354 13714.5760 26013.5263  89.7%  4669  674s
   413   502 19813.6728   17  190 13714.5760 26013.5263  89.7%  4415  689s
   501   580 18569.0415   20  183 13714.5760 26013.5263  89.7%  4128  703s
   581   637 17446.3151   25  164 13714.5760 26013.5263  89.7%  3919  717s
   642   684 15644.4706   30  171 13714.5760 26013.5263  89.7%  3850  731s
   701   732     cutoff   34      13714.5760 26013.5263  89.7%  3830  745s
   754   791     cutoff   34      13714.5760 26013.5263  89.7%  3834  760s
   826   867 15487.3879   32  157 13714.5760 26013.5263  89.7%  3705  773s
   910   920 21465.8850   22  310 13714.5760 26013.5263  89.7%  3551  789s
   979   996 20377.9325   22  160 13714.5760 26013.5263  89.7%  3492  803s
  1080  1053 18439.6028   24  353 13714.5760 26013.5263  89.7%  3360  819s
  1173  1096 infeasible   41      13714.5760 26013.5263  89.7%  3284  835s
  1275  1115 21563.6284   14  280 13714.5760 26013.5263  89.7%  3190  851s
  1312  1142 20899.7236   15  263 13714.5760 26013.5263  89.7%  3223  865s
  1365  1177 20834.8536   16  259 13714.5760 26013.5263  89.7%  3242  881s
H 1417  1177                    13813.746909 25934.8992  87.7%  3273  881s
  1423  1236 19226.1154   17  222 13813.7469 25934.8992  87.7%  3274  900s
  1525  1284 18959.2491   21  315 13813.7469 25933.9415  87.7%  3275  920s
  1635  1372 18485.0010   24  281 13813.7469 25933.9415  87.7%  3240  943s
  1752  1442 17761.7260   32  136 13813.7469 25933.9415  87.7%  3207  965s
  1876  1510 17039.5416   35  138 13813.7469 25752.5460  86.4%  3193  990s
  2006  1580 16459.0334   40  173 13813.7469 25752.5460  86.4%  3162 1011s
  2130  1654 15293.0938   47  272 13813.7469 25640.6930  85.6%  3168 1034s
  2250  1723 infeasible   55      13813.7469 25640.6930  85.6%  3164 1059s
  2387  1787 13954.4310   56  188 13813.7469 25640.6930  85.6%  3140 1084s
  2532  1809 22268.2935    9  498 13813.7469 25640.6930  85.6%  3135 1102s
  2574  1834 22142.3470    9  413 13813.7469 25053.9220  81.4%  3146 1128s
H 2575  1828                    14085.959391 25053.9220  77.9%  3145 1128s
H 2613  1820                    14513.848590 25053.9220  72.6%  3163 1149s
H 2663  1814                    14539.767970 25053.9220  72.3%  3154 1149s
H 2665  1810                    14564.762514 25053.9220  72.0%  3155 1149s
H 2668  1809                    14599.609390 25053.9220  71.6%  3158 1149s
H 2677  1793                    14739.410568 25053.9220  70.0%  3160 1149s
H 2683  1778                    14830.865508 25053.9220  68.9%  3162 1149s
  2687  1894 21880.4224   11  325 14830.8655 25053.9220  68.9%  3166 1175s
  2838  2044 21064.1375   15  189 14830.8655 25053.9220  68.9%  3159 1201s
  3030  2159 16445.3050   20  108 14830.8655 24959.6622  68.3%  3120 1233s
  3244  2220 19577.6406   23  164 14830.8655 24959.6622  68.3%  3065 1262s
  3383  2246 18369.8451   26  211 14830.8655 24959.6622  68.3%  3082 1288s
H 3419  2260                    14863.641315 24959.6622  67.9%  3116 1313s
H 3449  2257                    14884.610228 24959.6622  67.7%  3122 1313s
  3468  2388 17661.1352   28  241 14884.6102 24792.4974  66.6%  3136 1344s
H 3660  2439                    14925.990286 24591.6375  64.8%  3127 1374s
  3795  2537 infeasible   36      14925.9903 24591.6375  64.8%  3120 1409s
  4004  2613 infeasible   43      14925.9903 24496.6698  64.1%  3128 1447s
  4189  2706 20940.3994   16  331 14925.9903 24334.2497  63.0%  3155 1487s
  4375  2707 21597.9864   19  468 14925.9903 24334.2497  63.0%  3184 1694s
  4377  2708 16927.5582   34  327 14925.9903 24334.2497  63.0%  3183 1707s
  4378  2709 20698.5398   16  404 14925.9903 24334.2497  63.0%  3182 1758s
  4379  2710 22777.1096    9  427 14925.9903 24334.2497  63.0%  3181 1796s
  4380  2710 15424.3942   40  467 14925.9903 24334.2497  63.0%  3181 1820s
  4381  2711 21636.9226   13  449 14925.9903 24334.2497  63.0%  3180 1832s
  4382  2712 17790.5652   31  462 14925.9903 24334.2497  63.0%  3179 1846s
  4383  2712 21065.0072   19  487 14925.9903 24334.2497  63.0%  3178 1856s
  4384  2713 16031.1431   48  496 14925.9903 24334.2497  63.0%  3178 1862s
  4385  2714 20969.6968   25  494 14925.9903 24334.2497  63.0%  3177 1866s
  4386  2714 19887.1269   16  475 14925.9903 24334.2497  63.0%  3176 1872s
  4387  2715 19410.6399   26  463 14925.9903 24334.2497  63.0%  3176 1877s
  4389  2716 19456.5019   14  462 14925.9903 24334.2497  63.0%  3174 1882s
  4390  2717 17700.3736   30  461 14925.9903 24334.2497  63.0%  3173 1886s
  4391  2718 15169.8022   50  484 14925.9903 24334.2497  63.0%  3173 1900s
  4392  2718 23755.1879   16  453 14925.9903 24334.2497  63.0%  3172 1907s
  4393  2719 20938.7713   17  466 14925.9903 24334.2497  63.0%  3171 1912s
  4394  2720 23072.9650   12  470 14925.9903 24334.2497  63.0%  3171 1917s
  4395  2720 15626.9675   20  490 14925.9903 24334.2497  63.0%  3170 1930s
  4396  2721 22143.0980   15  509 14925.9903 24334.2497  63.0%  3169 1936s
  4397  2722 22105.3236   10  513 14925.9903 24334.2497  63.0%  3168 1943s
  4398  2722 21800.2795   23  545 14925.9903 24334.2497  63.0%  3168 1948s
  4399  2723 16628.1634   49  505 14925.9903 24334.2497  63.0%  3167 1951s
  4400  2724 22863.5984   18  499 14925.9903 24334.2497  63.0%  3166 1955s
  4401  2724 21497.8504   18  443 14925.9903 24334.2497  63.0%  3165 1962s
  4402  2725 21179.7467   17  460 14925.9903 24334.2497  63.0%  3165 1965s
  4403  2726 17056.8475   40  470 14925.9903 24334.2497  63.0%  3164 1973s
  4404  2726 15423.8187   19  465 14925.9903 24334.2497  63.0%  3163 1976s
  4405  2727 18933.8001   31  473 14925.9903 24334.2497  63.0%  3163 1982s
  4406  2728 22737.6275   10  473 14925.9903 24334.2497  63.0%  3162 1986s
  4407  2728 22344.5821   13  476 14925.9903 24334.2497  63.0%  3161 1990s
  4408  2729 19410.6399   26  477 14925.9903 24334.2497  63.0%  3160 1997s
  4409  2730 18055.8775   27  493 14925.9903 24334.2497  63.0%  3160 2003s
  4410  2730 20131.9684   20  470 14925.9903 24334.2497  63.0%  3159 2008s
  4411  2731 18135.5067   21  477 14925.9903 24334.2497  63.0%  3158 2011s
  4412  2732 22975.7011    8  479 14925.9903 24334.2497  63.0%  3158 2018s
  4413  2732 20398.7249   20  485 14925.9903 24334.2497  63.0%  3157 2021s
  4414  2733 21769.3122   16  474 14925.9903 24334.2497  63.0%  3156 2025s
  4415  2734 20112.2731   17  474 14925.9903 24334.2497  63.0%  3155 2038s
  4416  2734 19956.1388   20  474 14925.9903 24334.2497  63.0%  3155 2085s
  4417  2738 24334.2497   11  470 14925.9903 24334.2497  63.0%  3223 2107s
  4419  2739 24334.2497   12  361 14925.9903 24334.2497  63.0%  3224 2140s
  4421  2743 24334.2497   13  468 14925.9903 24334.2497  63.0%  3230 2162s
  4425  2751 24334.2497   13  414 14925.9903 24334.2497  63.0%  3233 2197s
  4435  2768 24311.4586   14  422 14925.9903 24334.2497  63.0%  3248 2231s
  4455  2773 24334.2497   15  496 14925.9903 24334.2497  63.0%  3304 2278s
  4467  2793 23621.7803   16  438 14925.9903 24334.2497  63.0%  3374 2324s
  4491  2862 22039.5970   17  433 14925.9903 24334.2497  63.0%  3407 2370s
  4576  2897 21713.2525   20  454 14925.9903 24334.2497  63.0%  3539 2400s
  4639  2942 21159.5170   22  414 14925.9903 24334.2497  63.0%  3574 2427s
  4707  2971 20570.6640   24  359 14925.9903 24334.2497  63.0%  3597 2451s
  4768  2977 20357.4854   26  290 14925.9903 24334.2497  63.0%  3622 2476s
  4834  2975 18877.8347   29  251 14925.9903 24334.2497  63.0%  3640 2501s
  4864  2988 18859.6229   30  250 14925.9903 24334.2497  63.0%  3647 2519s
  4913  2989 18857.8331   31  249 14925.9903 24334.2497  63.0%  3650 2539s
  4952  2994 18802.6901   32  142 14925.9903 24334.2497  63.0%  3653 2557s
  4998  2999 18374.3007   33  146 14925.9903 24334.2497  63.0%  3660 2577s
  5045  2997 17586.7925   34  225 14925.9903 24334.2497  63.0%  3663 2597s
H 5092  2843                    14943.347522 24334.2497  62.8%  3667 2597s
  5094  2854 15659.7396   35  148 14943.3475 24334.2497  62.8%  3670 2621s
  5167  2845 15597.5929   36  166 14943.3475 24334.2497  62.8%  3673 2653s
H 5187  2708                    14954.033523 24334.2497  62.7%  3675 2653s
  5239  2695 infeasible   39      14954.0335 24334.2497  62.7%  3683 2674s
  5315  2685 15722.5920   18  426 14954.0335 24334.2497  62.7%  3682 2701s
H 5316  2560                    14978.196579 24334.2497  62.5%  3681 2701s
  5382  2568 15645.5918   19  402 14978.1966 24334.2497  62.5%  3690 2729s
  5454  2568 infeasible   22      14978.1966 24334.2497  62.5%  3704 2757s
  5509  2589 19903.2142   23  439 14978.1966 24334.2497  62.5%  3730 2781s
  5585  2587 19800.9115   24  366 14978.1966 24334.2497  62.5%  3741 2805s
  5668  2577 19348.6297   26  292 14978.1966 24334.2497  62.5%  3748 2837s
  5751  2587 18428.0860   27  205 14978.1966 24334.2497  62.5%  3758 2865s
  5837  2600 16753.7440   31  165 14978.1966 24334.2497  62.5%  3772 2894s
  5921  2588     cutoff   35      14978.1966 24317.8485  62.4%  3784 2920s
  5982  2590 19822.5394   23  419 14978.1966 24317.8485  62.4%  3794 2964s
  6035  2610 19403.5827   24  282 14978.1966 24317.8485  62.4%  3811 2995s
  6110  2629 18205.1729   28  187 14978.1966 24317.8485  62.4%  3835 3027s
  6204  2616 17231.8448   30  176 14978.1966 24317.8485  62.4%  3853 3049s
  6241  2636     cutoff   31      14978.1966 24317.8485  62.4%  3861 3074s
  6307  2640 15342.0793   32  186 14978.1966 24317.8485  62.4%  3865 3108s
  6414  2647     cutoff   37      14978.1966 24317.8485  62.4%  3878 3145s
  6515  2632     cutoff   22      14978.1966 22699.9426  51.6%  3900 3184s
  6626  2637     cutoff   24      14978.1966 22565.8550  50.7%  3926 3224s
  6748  2642 17905.1514   18  325 14978.1966 22565.8550  50.7%  3944 3265s
  6889  2625 17531.3345   20  400 14978.1966 22493.6318  50.2%  3965 3302s
  6964  2641 17352.0489   23  373 14978.1966 22252.2408  48.6%  3991 3337s
  7026  2665 16062.1074   28  116 14978.1966 22119.9835  47.7%  4004 3370s
  7098  2716 19502.9031   20  391 14978.1966 22119.9835  47.7%  4005 3413s
  7260  2702 17823.0992   25  211 14978.1966 22109.7240  47.6%  4006 3469s
  7428  2682 16700.0462   28  286 14978.1966 22109.7240  47.6%  4024 3529s
  7591  2707 infeasible   35      14978.1966 22109.7240  47.6%  4051 3583s
  7763  2674 infeasible   26      14978.1966 22109.7240  47.6%  4078 3600s

Cutting planes:
  Learned: 3
  Gomory: 8
  Implied bound: 38
  Projected implied bound: 340
  MIR: 1304
  Mixing: 3
  Flow cover: 2216
  RLT: 77
  Relax-and-lift: 302

Explored 7828 nodes (32295679 simplex iterations) in 3600.05 seconds (9064.63 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14978.2 14954 14943.3 ... 14564.8

Time limit reached
Best objective 1.497819657909e+04, best bound 2.210972398372e+04, gap 47.6127%
  WARNING: Time limit reached. Using best solution found (gap: 47.61%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 14978.20, θ = 160460.88
  Upper Bound (UB) = 14978.20

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160460.88
  [DEBUG]   ✓ Scenario 0: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160460.88 ≤ Q = 160460.88 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160460.88 ≤ Q = 160460.88 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x28046c6d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x28046c6d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.240362e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6137632.7483
Variable types: 346 continuous, 166 integer (166 binary)

Root relaxation: objective -1.444703e+05, 254 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144470.29    0  128 6137632.75 -144470.29   102%     -    0s
H    0     0                    -107980.4271 -144470.29  33.8%     -    0s
H    0     0                    -120320.6858 -144470.29  20.1%     -    0s
H    0     0                    -120542.5323 -144470.29  19.9%     -    0s
H    0     0                    -121070.1435 -144229.79  19.1%     -    0s
H    0     0                    -127313.9176 -129523.46  1.74%     -    0s
     0     0 -129523.46    0   64 -127313.92 -129523.46  1.74%     -    0s
H    0     0                    -127663.7802 -129441.01  1.39%     -    0s
H    0     0                    -127907.1129 -129282.46  1.08%     -    0s
     0     0 -129282.46    0   66 -127907.11 -129282.46  1.08%     -    0s
     0     0 -128467.70    0   27 -127907.11 -128467.70  0.44%     -    0s
     0     0 -128400.65    0   29 -127907.11 -128400.65  0.39%     -    0s
     0     0 -128396.74    0   24 -127907.11 -128396.74  0.38%     -    0s
     0     0 -128395.93    0   27 -127907.11 -128395.93  0.38%     -    0s
H    0     0                    -128151.6273 -128395.93  0.19%     -    0s
     0     0 -128350.31    0   16 -128151.63 -128350.31  0.16%     -    0s
H    0     0                    -128155.6670 -128343.40  0.15%     -    0s
     0     0 -128329.83    0   18 -128155.67 -128329.83  0.14%     -    0s
     0     0 -128297.85    0   12 -128155.67 -128297.85  0.11%     -    0s
     0     0 -128297.85    0   20 -128155.67 -128297.85  0.11%     -    0s
H    0     0                    -128190.1452 -128297.85  0.08%     -    0s
     0     0 -128278.15    0   13 -128190.15 -128278.15  0.07%     -    0s
H    0     0                    -128234.2037 -128275.68  0.03%     -    0s
     0     0 -128268.96    0    6 -128234.20 -128268.96  0.03%     -    0s
     0     0 -128262.75    0    8 -128234.20 -128262.75  0.02%     -    0s
     0     0 -128257.30    0    8 -128234.20 -128257.30  0.02%     -    0s
     0     0 -128257.17    0    6 -128234.20 -128257.17  0.02%     -    0s
H    0     0                    -128234.5081 -128257.17  0.02%     -    0s
     0     0 -128251.69    0    6 -128234.51 -128251.69  0.01%     -    0s
     0     0 -128251.69    0   11 -128234.51 -128251.69  0.01%     -    0s
H    0     0                    -128235.7642 -128251.69  0.01%     -    0s
     0     0 -128247.05    0    8 -128235.76 -128247.05  0.01%     -    0s
H    0     0                    -128241.2973 -128244.94  0.00%     -    0s
     0     0 -128243.18    0    8 -128241.30 -128243.18  0.00%     -    0s
     0     0          -    0      -128241.30 -128241.33  0.00%     -    0s

Cutting planes:
  Gomory: 4
  MIR: 4
  Flow cover: 7

Explored 1 nodes (819 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128241 -128236 -128235 ... -127314

Optimal solution found (tolerance 1.00e-06)
Best objective -1.282412972699e+05, best bound -1.282413317075e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 143616.64
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128241.30
  [DEBUG]   S×d_nominal = 271857.94
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 271857.94 + -128241.30 = 143616.64
  [DEBUG]   Current θ from Master = 160460.88
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16844.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -1866.04
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2388.4349, Absolute Gap = 2388.4349, Relative Gap = 0.159461
  Not converged yet (gap = 2388.43 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481192 nonzeros
Model fingerprint: 0xd2acb5f9
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 73426 rows and 29816 columns
Presolve time: 1.43s
Presolved: 96147 rows, 41084 columns, 583181 nonzeros
Variable types: 38825 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -343834.5651
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.333e+06
 Factor NZ  : 9.498e+06 (roughly 130 MB of memory)
 Factor Ops : 1.733e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.64168703e+07  1.68373112e+08  1.00e+05 1.79e+01  7.12e+04     3s
   1  -1.23003417e+07  1.49127705e+08  6.90e+04 6.55e+01  4.86e+04     3s
   2  -3.69467163e+06  1.11334629e+08  2.04e+04 8.84e-12  1.53e+04     3s
   3  -7.78800555e+05  7.73193789e+07  1.91e+03 5.46e-01  1.76e+03     3s
   4  -4.81161381e+05  3.23341753e+07  4.49e+02 6.74e-02  4.61e+02     3s
   5  -3.81820480e+05  2.17724970e+07  2.11e+02 3.84e-02  2.45e+02     3s
   6  -2.76419204e+05  1.65207911e+07  8.53e+01 2.61e-02  1.39e+02     3s
   7  -1.32892993e+05  1.19826813e+07  1.61e+01 1.71e-02  7.58e+01     3s
   8  -9.78471260e+04  5.48305312e+06  1.06e+01 7.54e-03  3.44e+01     3s
   9  -6.71389121e+04  2.88906877e+06  5.99e+00 3.62e-03  1.77e+01     3s
  10  -4.71077807e+04  9.00443188e+05  3.76e+00 9.01e-04  5.59e+00     3s
  11  -1.27394786e+04  3.78494089e+05  1.84e+00 5.67e-04  2.27e+00     3s
  12  -8.32997012e+01  1.76542379e+05  1.09e+00 8.38e-04  1.02e+00     3s
  13   5.87147131e+03  1.18389076e+05  8.32e-01 8.93e-04  6.46e-01     3s
  14   1.03074711e+04  9.45598329e+04  6.79e-01 1.16e-03  4.83e-01     3s
  15   1.56838235e+04  8.02052023e+04  5.23e-01 1.35e-03  3.70e-01     4s
  16   2.13513837e+04  7.35636636e+04  3.88e-01 1.83e-03  2.99e-01     4s
  17   2.66149329e+04  6.60643702e+04  2.93e-01 2.14e-03  2.26e-01     4s
  18   2.99429446e+04  6.00912614e+04  2.34e-01 1.99e-03  1.72e-01     4s
  19   3.31893766e+04  5.51147976e+04  1.81e-01 2.61e-03  1.25e-01     4s
  20   3.44461789e+04  5.28016113e+04  1.59e-01 3.44e-03  1.05e-01     4s
  21   3.62418073e+04  5.14280896e+04  1.29e-01 3.22e-03  8.68e-02     4s
  22   3.79331357e+04  4.90919954e+04  1.01e-01 2.51e-03  6.38e-02     4s
  23   3.87775779e+04  4.78623513e+04  8.82e-02 1.56e-03  5.20e-02     4s
  24   3.95646157e+04  4.74048479e+04  7.61e-02 1.44e-03  4.49e-02     4s
  25   4.04610680e+04  4.67082881e+04  6.25e-02 1.44e-03  3.58e-02     4s
  26   4.15160789e+04  4.62012056e+04  4.69e-02 1.18e-03  2.68e-02     4s
  27   4.24103314e+04  4.59610044e+04  3.40e-02 1.05e-03  2.03e-02     4s
  28   4.29393860e+04  4.55896738e+04  2.64e-02 7.21e-04  1.52e-02     4s
  29   4.31531754e+04  4.54755727e+04  2.32e-02 7.22e-04  1.33e-02     4s
  30   4.32991948e+04  4.53638733e+04  2.11e-02 6.22e-04  1.18e-02     4s
  31   4.36156841e+04  4.52296103e+04  1.65e-02 5.53e-04  9.24e-03     4s
  32   4.38216109e+04  4.51359756e+04  1.35e-02 4.85e-04  7.52e-03     5s
  33   4.40211443e+04  4.50341329e+04  1.06e-02 3.61e-04  5.80e-03     5s
  34   4.43121817e+04  4.50088018e+04  6.53e-03 3.59e-04  3.98e-03     5s
  35   4.43996308e+04  4.49392738e+04  5.34e-03 2.88e-04  3.09e-03     5s
  36   4.44900427e+04  4.48838077e+04  4.17e-03 1.38e-04  2.25e-03     5s
  37   4.45231764e+04  4.48693700e+04  3.73e-03 1.32e-04  1.98e-03     5s
  38   4.46109947e+04  4.48576008e+04  2.58e-03 1.04e-04  1.41e-03     5s
  39   4.46910102e+04  4.48481507e+04  1.52e-03 8.27e-05  8.99e-04     5s
  40   4.47540735e+04  4.48330991e+04  7.17e-04 4.64e-05  4.52e-04     5s
  41   4.47666394e+04  4.48222429e+04  5.52e-04 2.95e-05  3.18e-04     5s
  42   4.47957695e+04  4.48137583e+04  1.91e-04 2.68e-05  1.03e-04     5s
  43   4.48004872e+04  4.48116243e+04  1.30e-04 1.03e-05  6.38e-05     5s
  44   4.48023523e+04  4.48115199e+04  1.06e-04 7.91e-06  5.25e-05     5s
  45   4.48090972e+04  4.48113809e+04  2.34e-05 2.20e-06  1.31e-05     5s
  46   4.48109772e+04  4.48112097e+04  2.55e-06 2.33e-07  1.33e-06     5s
  47   4.48110922e+04  4.48112104e+04  1.63e-06 1.31e-06  6.79e-07     5s
  48   4.48111970e+04  4.48112074e+04  1.39e-07 8.48e-08  6.02e-08     6s
  49   4.48112070e+04  4.48112074e+04  1.30e-07 8.88e-09  2.33e-09     6s

Barrier solved model in 49 iterations and 5.61 seconds (8.16 work units)
Optimal objective 4.48112070e+04


Root crossover log...

   76799 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

   20648 PPushes remaining with PInf 9.4217877e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 5.7708017e+04      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57724    4.4811207e+04   0.000000e+00   5.770802e+04      9s
   57993    4.4811207e+04   0.000000e+00   0.000000e+00      9s
   57993    4.4811207e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.31s

Solved with barrier

Root relaxation: objective 4.481121e+04, 57993 iterations, 7.73 seconds (15.11 work units)
Total elapsed time = 10.05s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 44811.2074    0  411 -190754.47 44811.2074   123%     -   10s
H    0     0                    -185867.1182 44811.2074   124%     -   10s
H    0     0                    -183965.7562 44811.2074   124%     -   11s
H    0     0                    -183851.5680 44811.2074   124%     -   11s
H    0     0                    -64694.73182 44811.2074   169%     -   11s
H    0     0                    -22875.11617 44811.2074   296%     -   11s
H    0     0                    -22617.64856 44811.2074   298%     -   11s
H    0     0                    -22586.56465 44811.2074   298%     -   11s
H    0     0                    -13889.29018 38142.8149   375%     -   37s
H    0     0                    -9794.845453 38142.8149   489%     -   37s
H    0     0                    -9747.821658 38142.8149   491%     -   37s
H    0     0                    -9709.776703 38142.8149   493%     -   37s
     0     0 38142.8149    0  491 -9709.7767 38142.8149   493%     -   37s
H    0     0                    -5566.895036 38140.9279   785%     -   38s
H    0     0                    -4876.643817 38140.9279   882%     -   38s
H    0     0                    -4788.726337 38140.9279   896%     -   38s
H    0     0                    -4763.141865 38140.9279   901%     -   38s
     0     0 36832.5922    0  501 -4763.1419 36832.5922   873%     -   56s
     0     0 36832.5922    0  506 -4763.1419 36832.5922   873%     -   59s
     0     0 36832.5922    0  502 -4763.1419 36832.5922   873%     -   61s
     0     0 36832.5922    0  502 -4763.1419 36832.5922   873%     -   61s
     0     0 36832.5922    0  510 -4763.1419 36832.5922   873%     -   64s
     0     0 36832.5922    0  499 -4763.1419 36832.5922   873%     -   65s
     0     0 36832.5922    0  499 -4763.1419 36832.5922   873%     -   66s
     0     0 36832.5922    0  497 -4763.1419 36832.5922   873%     -   66s
     0     0 33514.2407    0  498 -4763.1419 33514.2407   804%     -  101s
H    0     0                    -1389.826724 33514.1986  2511%     -  101s
H    0     0                    -712.0233767 33514.1986  4807%     -  102s
     0     0 32711.9901    0  445 -712.02338 32711.9901  4694%     -  123s
     0     0 32410.8010    0  447 -712.02338 32410.8010  4652%     -  141s
     0     0 32333.1603    0  476 -712.02338 32333.1603  4641%     -  152s
     0     0 32296.5044    0  513 -712.02338 32296.5044  4636%     -  158s
     0     0 32260.9193    0  472 -712.02338 32260.9193  4631%     -  164s
     0     0 32246.3584    0  476 -712.02338 32246.3584  4629%     -  167s
     0     0 32232.5394    0  478 -712.02338 32232.5394  4627%     -  170s
     0     0 32214.0358    0  469 -712.02338 32214.0358  4624%     -  172s
     0     0 32208.8961    0  483 -712.02338 32208.8961  4624%     -  175s
     0     0 32171.9032    0  467 -712.02338 32171.9032  4618%     -  178s
     0     0 32161.2848    0  476 -712.02338 32161.2848  4617%     -  180s
     0     0 32154.7931    0  486 -712.02338 32154.7931  4616%     -  183s
     0     0 32143.9319    0  487 -712.02338 32143.9319  4614%     -  184s
     0     0 32139.9778    0  486 -712.02338 32139.9778  4614%     -  186s
H    0     0                    2761.2231285 32134.6358  1064%     -  187s
H    0     0                    3110.2513624 32134.6358   933%     -  187s
H    0     0                    3893.1584206 32134.6358   725%     -  187s
H    0     0                    4055.2750824 32134.6358   692%     -  187s
     0     0 32134.6358    0  474 4055.27508 32134.6358   692%     -  187s
     0     0 32134.2783    0  483 4055.27508 32134.2783   692%     -  189s
H    0     0                    4380.7707243 30114.3655   587%     -  245s
H    0     0                    4733.2532117 30114.3655   536%     -  245s
     0     0 30114.3655    0  439 4733.25321 30114.3655   536%     -  245s
H    0     0                    4829.0338819 29506.6475   511%     -  273s
H    0     0                    4914.1026313 29506.6475   500%     -  273s
H    0     0                    4946.9883014 29506.6475   496%     -  273s
H    0     0                    5431.4237768 29506.6475   443%     -  273s
H    0     0                    5486.3418806 29506.6475   438%     -  273s
     0     0 29506.6475    0  508 5486.34188 29506.6475   438%     -  273s
     0     0 29294.9072    0  481 5486.34188 29294.9072   434%     -  288s
     0     0 29184.2756    0  499 5486.34188 29184.2756   432%     -  301s
     0     0 29094.6833    0  489 5486.34188 29094.6833   430%     -  315s
     0     0 29056.4381    0  512 5486.34188 29056.4381   430%     -  322s
     0     0 29035.4650    0  505 5486.34188 29035.4650   429%     -  328s
     0     0 29022.8047    0  514 5486.34188 29022.8047   429%     -  332s
     0     0 28973.1880    0  519 5486.34188 28973.1880   428%     -  338s
H    0     0                    6627.8234394 28931.4979   337%     -  345s
H    0     0                    7686.5585424 28931.4979   276%     -  345s
     0     0 28931.4979    0  507 7686.55854 28931.4979   276%     -  345s
H    0     0                    7863.3338260 28860.1394   267%     -  356s
     0     0 28860.1394    0  516 7863.33383 28860.1394   267%     -  356s
     0     0 28834.9989    0  537 7863.33383 28834.9989   267%     -  361s
     0     0 28822.6005    0  509 7863.33383 28822.6005   267%     -  364s
     0     0 28817.6280    0  530 7863.33383 28817.6280   266%     -  367s
     0     0 28796.3396    0  530 7863.33383 28796.3396   266%     -  370s
     0     0 28792.4752    0  524 7863.33383 28792.4752   266%     -  373s
     0     0 28790.6743    0  522 7863.33383 28790.6743   266%     -  374s
H    0     0                    9585.2031879 27921.7115   191%     -  409s
H    0     0                    9650.7745852 27921.7115   189%     -  409s
H    0     0                    9674.9376416 27921.7115   189%     -  409s
H    0     0                    10013.467149 27921.7115   179%     -  409s
H    0     0                    10188.388985 27921.7115   174%     -  409s
H    0     0                    10253.960383 27921.7115   172%     -  409s
H    0     0                    10352.205033 27921.7115   170%     -  409s
H    0     0                    10511.052975 27921.7115   166%     -  409s
     0     0 27921.7115    0  460 10511.0530 27921.7115   166%     -  409s
H    0     0                    10679.317769 27710.4353   159%     -  420s
     0     0 27710.4353    0  467 10679.3178 27710.4353   159%     -  420s
     0     0 27501.5758    0  493 10679.3178 27501.5758   158%     -  433s
H    0     0                    10749.038613 27455.9380   155%     -  439s
     0     0 27455.9380    0  489 10749.0386 27455.9380   155%     -  439s
     0     0 27439.0447    0  488 10749.0386 27439.0447   155%     -  442s
     0     0 27416.4721    0  485 10749.0386 27416.4721   155%     -  447s
     0     0 27408.1850    0  482 10749.0386 27408.1850   155%     -  449s
     0     0 27402.5705    0  491 10749.0386 27402.5705   155%     -  451s
     0     0 27398.3772    0  486 10749.0386 27398.3772   155%     -  452s
     0     0 27395.2803    0  485 10749.0386 27395.2803   155%     -  453s
     0     0 27391.2901    0  494 10749.0386 27391.2901   155%     -  455s
     0     0 27386.2981    0  499 10749.0386 27386.2981   155%     -  456s
     0     0 27383.6548    0  497 10749.0386 27383.6548   155%     -  458s
     0     0 27127.7538    0  475 10749.0386 27127.7538   152%     -  471s
H    0     0                    10794.522068 27127.3161   151%     -  472s
H    0     0                    11479.954728 27127.3161   136%     -  472s
H    0     0                    11515.854339 27127.3161   136%     -  472s
H    0     0                    11661.997787 27127.3161   133%     -  472s
H    0     0                    11671.580144 27127.3161   132%     -  472s
     0     0 27073.9766    0  480 11671.5801 27073.9766   132%     -  481s
     0     0 27048.3286    0  470 11671.5801 27048.3286   132%     -  486s
     0     0 27038.4955    0  484 11671.5801 27038.4955   132%     -  490s
     0     0 27034.7457    0  488 11671.5801 27034.7457   132%     -  493s
     0     0 27030.6256    0  480 11671.5801 27030.6256   132%     -  496s
     0     0 27024.5068    0  481 11671.5801 27024.5068   132%     -  498s
     0     0 27019.6082    0  480 11671.5801 27019.6082   131%     -  499s
     0     0 27016.1169    0  470 11671.5801 27016.1169   131%     -  501s
     0     0 27013.1156    0  479 11671.5801 27013.1156   131%     -  502s
     0     0 26909.8472    0  494 11671.5801 26909.8472   131%     -  514s
H    0     0                    11813.554659 26909.4963   128%     -  529s
H    0     0                    11957.046722 26909.4963   125%     -  530s
H    0     0                    12797.464083 26909.4963   110%     -  530s
H    0     0                    13097.863849 26909.4963   105%     -  530s
H    0     0                    13153.507290 26909.4963   105%     -  530s
H    0     0                    13892.143603 26909.4963  93.7%     -  530s
H    0     0                    14140.251482 26909.4963  90.3%     -  530s
     0     0 26871.7857    0  495 14140.2515 26871.7857  90.0%     -  535s
     0     0 26862.1866    0  495 14140.2515 26862.1866  90.0%     -  538s
     0     0 26850.7978    0  494 14140.2515 26850.7978  89.9%     -  540s
     0     0 26844.5451    0  492 14140.2515 26844.5451  89.8%     -  543s
     0     0 26843.3174    0  504 14140.2515 26843.3174  89.8%     -  545s
     0     0 26823.6817    0  485 14140.2515 26823.6817  89.7%     -  550s
     0     0 26813.0527    0  493 14140.2515 26813.0527  89.6%     -  553s
     0     0 26807.1094    0  502 14140.2515 26807.1094  89.6%     -  556s
     0     0 26804.1280    0  502 14140.2515 26804.1280  89.6%     -  557s
     0     0 26785.5270    0  495 14140.2515 26785.5270  89.4%     -  563s
     0     0 26782.2072    0  487 14140.2515 26782.2072  89.4%     -  566s
     0     0 26778.8909    0  487 14140.2515 26778.8909  89.4%     -  568s
     0     0 26773.6305    0  483 14140.2515 26773.6305  89.3%     -  570s
     0     0 26772.4920    0  487 14140.2515 26772.4920  89.3%     -  571s
     0     0 26766.0006    0  493 14140.2515 26766.0006  89.3%     -  574s
     0     0 26763.1612    0  504 14140.2515 26763.1612  89.3%     -  576s
     0     0 26753.4795    0  497 14140.2515 26753.4795  89.2%     -  580s
     0     0 26753.0110    0  497 14140.2515 26753.0110  89.2%     -  582s
H    0     0                    14322.907878 26752.9095  86.8%     -  711s
H    0     0                    14616.943490 26752.9095  83.0%     -  711s
H    0     0                    14641.106546 26752.9095  82.7%     -  716s
H    0     0                    14664.022077 26752.9095  82.4%     -  762s
     0     2 26752.9095    0  497 14664.0221 26752.9095  82.4%     -  764s
     1     3 26377.0665    1  441 14664.0221 26752.9095  82.4%  9224  773s
     2     4 26475.1316    1  484 14664.0221 26475.1316  80.5%  8088  781s
     3     6 26236.2720    2  487 14664.0221 26473.9656  80.5%  7712  790s
     5    11 24560.8104    3  446 14664.0221 26473.9656  80.5%  8069  802s
    10    17 25767.3766    4  475 14664.0221 26234.5810  78.9%  7971  848s
    16    23 22948.7367    5  246 14664.0221 26167.7880  78.4% 17180  874s
    22    42 24900.9631    4  470 14664.0221 25767.3644  75.7% 15505  926s
    41    74 24295.8087    5  460 14664.0221 25767.3644  75.7% 16191  958s
H   44    74                    14947.400930 25767.3644  72.4% 15696  958s
    73   177 24265.4244    6  463 14947.4009 25767.3644  72.4% 17594 1004s
   176   210 24251.9838    9  456 14947.4009 25767.3644  72.4%  9098 1024s
H  180   210                    14990.941090 25767.3644  71.9%  8966 1024s
   213   261 24058.5907   10  457 14990.9411 25767.3644  71.9%  8068 1051s
   269   333 23045.4475   11  336 14990.9411 25767.3644  71.9%  7301 1075s
   345   365 22961.5415   12  356 14990.9411 25767.3644  71.9%  6497 1097s
   377   397 22878.0223   13  356 14990.9411 25767.3644  71.9%  6272 1136s
H  381   397                    15232.724042 25767.3644  69.2%  6241 1136s
   417   448 22818.7546   14  346 15232.7240 25767.3644  69.2%  5977 1161s
   472   504 22629.1746   15  347 15232.7240 25767.3644  69.2%  5732 1184s
   534   564 21871.7694   17  345 15232.7240 25767.3644  69.2%  5456 1208s
   602   592 16724.4705   27  198 15232.7240 25767.3644  69.2%  5177 1230s
   665   638 21215.2567   18  296 15232.7240 25767.3644  69.2%  4963 1251s
   725   696 21126.0441   19  246 15232.7240 25767.3644  69.2%  4805 1273s
   809   751 20632.5889   23  295 15232.7240 25767.3644  69.2%  4599 1293s
   884   840 20299.3964   26  271 15232.7240 25767.3644  69.2%  4387 1311s
   981   927 19687.3903   31  231 15232.7240 25767.3644  69.2%  4191 1332s
  1083  1016 19010.4554   34  214 15232.7240 25767.3644  69.2%  4035 1352s
  1195  1075 16283.2636   40  155 15232.7240 25767.3644  69.2%  3864 1377s
  1288  1136 15602.6624   47  155 15232.7240 25767.3644  69.2%  3736 1399s
  1399  1201     cutoff   30      15232.7240 25767.3644  69.2%  3579 1418s
  1525  1273 15825.4795   30   79 15232.7240 25767.3644  69.2%  3421 1440s
  1647  1341 20454.2526   31  397 15232.7240 25767.3644  69.2%  3337 1464s
  1757  1386 20367.7511   32  429 15232.7240 25767.3644  69.2%  3292 1491s
  1856  1469 18377.8070   34  341 15232.7240 25767.3644  69.2%  3279 1517s
  1979  1552 17442.1306   35  229 15232.7240 25767.3644  69.2%  3243 1541s
  2110  1619 16745.4907   37  233 15232.7240 25471.6349  67.2%  3210 1567s
  2230  1710 16483.3445   40  233 15232.7240 25471.6349  67.2%  3198 1596s
  2358  1777 infeasible   43      15232.7240 25471.6349  67.2%  3197 1623s
  2457  1847     cutoff   45      15232.7240 25471.6349  67.2%  3177 1656s
  2602  1921 21560.2445   11  450 15232.7240 25125.6072  64.9%  3135 1686s
  2754  2010 21390.4731   13  444 15232.7240 25125.6072  64.9%  3085 1721s
  2883  2107 20796.9792   16  431 15232.7240 25125.6072  64.9%  3077 1753s
  3044  2197 20668.8497   17  407 15232.7240 24723.9914  62.3%  3054 1790s
  3174  2284 19908.8138   20  366 15232.7240 24723.9914  62.3%  3058 1827s
  3316  2358 19659.5799   22  446 15232.7240 24723.9914  62.3%  3060 1870s
  3452  2458 18143.6417   24  251 15232.7240 24723.9914  62.3%  3076 1913s
  3592  2564 16795.0426   26  234 15232.7240 24723.9914  62.3%  3100 1952s
  3743  2565 19608.2604   34  497 15232.7240 24723.9914  62.3%  3132 2348s
  3745  2566 23967.3359    9  327 15232.7240 24723.9914  62.3%  3130 2367s
  3746  2567 16449.9055   41  433 15232.7240 24723.9914  62.3%  3129 2445s
  3747  2568 23044.9534    9  430 15232.7240 24723.9914  62.3%  3128 2486s
  3748  2568 18147.9703   35  470 15232.7240 24723.9914  62.3%  3127 2513s
  3749  2569 23276.3495   16  462 15232.7240 24723.9914  62.3%  3127 2538s
  3750  2570 19128.2352   23  475 15232.7240 24723.9914  62.3%  3126 2553s
  3751  2570 18605.9802   21  480 15232.7240 24723.9914  62.3%  3125 2567s
  3752  2571 23293.3940    9  481 15232.7240 24723.9914  62.3%  3124 2577s
  3753  2572 16328.5500   52  498 15232.7240 24723.9914  62.3%  3123 2584s
  3754  2572 19738.4930   37  488 15232.7240 24723.9914  62.3%  3122 2590s
  3755  2573 16817.9840   62  498 15232.7240 24723.9914  62.3%  3122 2595s
  3757  2574 21295.3953   15  510 15232.7240 24723.9914  62.3%  3120 2604s
  3758  2575 15744.3863   52  484 15232.7240 24723.9914  62.3%  3119 2616s
  3759  2576 17793.8801   60  482 15232.7240 24723.9914  62.3%  3118 2624s
  3760  2576 15547.5066   43  486 15232.7240 24723.9914  62.3%  3117 2628s
  3761  2577 15909.3390   51  481 15232.7240 24723.9914  62.3%  3117 2633s
  3762  2578 17478.5206   31  528 15232.7240 24723.9914  62.3%  3116 2644s
  3763  2578 21294.6949   14  497 15232.7240 24723.9914  62.3%  3115 2651s
  3764  2579 20197.2475   31  487 15232.7240 24723.9914  62.3%  3114 2656s
  3765  2580 16469.3976   48  487 15232.7240 24723.9914  62.3%  3113 2667s
  3766  2580 18029.1757   26  486 15232.7240 24723.9914  62.3%  3112 2672s
  3767  2581 23090.2772   20  480 15232.7240 24723.9914  62.3%  3112 2682s
  3768  2582 23145.3522   23  495 15232.7240 24723.9914  62.3%  3111 2687s
  3769  2582 21903.2456   15  521 15232.7240 24723.9914  62.3%  3110 2691s
  3770  2583 16377.7230   45  510 15232.7240 24723.9914  62.3%  3109 2704s
  3771  2584 17275.2179   52  545 15232.7240 24723.9914  62.3%  3108 2710s
  3772  2584 22616.7038   13  525 15232.7240 24723.9914  62.3%  3108 2715s
  3774  2586 20883.6585   25  521 15232.7240 24723.9914  62.3%  3106 2729s
  3775  2586 23144.1286   19  520 15232.7240 24723.9914  62.3%  3105 2735s
  3776  2587 20678.0976   32  513 15232.7240 24723.9914  62.3%  3104 2741s
  3777  2588 17001.0175   45  551 15232.7240 24723.9914  62.3%  3103 2748s
  3778  2588 16981.9578   19  493 15232.7240 24723.9914  62.3%  3103 2759s
  3779  2589 18231.1031   34  545 15232.7240 24723.9914  62.3%  3102 2765s
  3780  2590 20715.7567   27  549 15232.7240 24723.9914  62.3%  3101 2775s
  3781  2590 18670.8259   49  519 15232.7240 24723.9914  62.3%  3100 2783s
  3782  2591 18530.2321   27  512 15232.7240 24723.9914  62.3%  3099 2791s
  3783  2592 21140.9969   23  512 15232.7240 24723.9914  62.3%  3098 2813s
  3784  2592 16593.1816   24  512 15232.7240 24723.9914  62.3%  3098 2883s
  3785  2596 24723.9914   11  519 15232.7240 24723.9914  62.3%  3201 3001s
  3787  2599 24723.9914   12  512 15232.7240 24723.9914  62.3%  3204 3017s
  3791  2606 24723.9914   13  498 15232.7240 24723.9914  62.3%  3212 3052s
  3799  2619 24723.9914   14  485 15232.7240 24723.9914  62.3%  3221 3075s
  3815  2632 23675.6006   15  497 15232.7240 24723.9914  62.3%  3315 3144s
  3833  2657 20774.7056   16  492 15232.7240 24723.9914  62.3%  3346 3191s
  3865  2772 20529.7055   17  466 15232.7240 24723.9914  62.3%  3444 3233s
  4003  2773 19884.6769   22  402 15232.7240 24723.9914  62.3%  3460 3253s
  4063  2813 19805.5106   22  383 15232.7240 24723.9914  62.3%  3495 3272s
  4131  2809 18519.2565   24  364 15232.7240 24723.9914  62.3%  3526 3286s
  4163  2820 18310.0448   23  369 15232.7240 24723.9914  62.3%  3557 3302s
  4198  2833 19291.4072   23  376 15232.7240 24723.9914  62.3%  3579 3321s
  4240  2829 17533.9722   25  291 15232.7240 24723.9914  62.3%  3611 3341s
  4281  2848 15973.6604   23  343 15232.7240 24723.9914  62.3%  3626 3358s
  4343  2852 19309.1743   25  207 15232.7240 24723.9914  62.3%  3645 3387s
  4409  2848 infeasible   25      15232.7240 24723.9914  62.3%  3661 3412s
  4485  2851 16888.7737   29  164 15232.7240 24723.9914  62.3%  3681 3443s
  4553  2853 16203.3744   30  177 15232.7240 24723.9914  62.3%  3692 3466s
  4624  2842     cutoff   31      15232.7240 24723.9914  62.3%  3709 3490s
  4688  2857 infeasible   34      15232.7240 24723.9914  62.3%  3740 3509s
  4759  2858 20860.9190   23  328 15232.7240 24723.9914  62.3%  3762 3526s
  4821  2856 19725.8177   25  204 15232.7240 24723.9914  62.3%  3799 3544s
  4873  2854 19674.1091   26  280 15232.7240 24723.9914  62.3%  3824 3561s
  4938  2843 19948.8833   26  306 15232.7240 24723.9914  62.3%  3851 3593s
  5011  2815 15655.8784   27  145 15232.7240 24723.9914  62.3%  3885 3600s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 64
  Projected implied bound: 385
  MIR: 1146
  Mixing: 1
  Flow cover: 2227
  RLT: 72
  Relax-and-lift: 356

Explored 5042 nodes (20239721 simplex iterations) in 3600.08 seconds (8819.93 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15232.7 14990.9 14947.4 ... 13153.5

Time limit reached
Best objective 1.523272404154e+04, best bound 2.472399135723e+04, gap 62.3084%
  WARNING: Time limit reached. Using best solution found (gap: 62.31%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 15232.72, θ = 158146.61
  Upper Bound (UB) = 15232.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 158146.61
  [DEBUG]   ✓ Scenario 0: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 158146.61 ≤ Q = 158146.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 158146.61 ≤ Q = 158146.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 158146.61 ≤ Q = 158146.61 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3416a81a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcbe957e6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.318727e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6652549.8582
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.464487e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146448.73    0  124 6652549.86 -146448.73   102%     -    0s
H    0     0                    -111817.5790 -146448.73  31.0%     -    0s
H    0     0                    -112346.9330 -146448.73  30.4%     -    0s
     0     0 -124802.59    0  111 -112346.93 -124802.59  11.1%     -    0s
H    0     0                    -121024.9823 -124799.74  3.12%     -    0s
     0     0 -123483.77    0  115 -121024.98 -123483.77  2.03%     -    0s
H    0     0                    -122020.9985 -123449.32  1.17%     -    0s
H    0     0                    -122243.0947 -123449.32  0.99%     -    0s
     0     0 -123119.29    0  118 -122243.09 -123119.29  0.72%     -    0s
     0     0 -122952.14    0  117 -122243.09 -122952.14  0.58%     -    0s
     0     0 -122939.33    0  117 -122243.09 -122939.33  0.57%     -    0s
     0     0 -122801.85    0   88 -122243.09 -122801.85  0.46%     -    0s
     0     0 -122779.58    0   90 -122243.09 -122779.58  0.44%     -    0s
     0     0 -122660.68    0   90 -122243.09 -122660.68  0.34%     -    0s
     0     0 -122643.26    0   90 -122243.09 -122643.26  0.33%     -    0s
     0     2 -122643.26    0   90 -122243.09 -122643.26  0.33%     -    0s
H   44    21                    -122247.6375 -122522.50  0.22%  11.7    0s
H   86    73                    -122256.7375 -122517.64  0.21%  10.7    0s
H  116    73                    -122256.8377 -122517.64  0.21%   8.9    0s
H  136    73                    -122257.4765 -122517.64  0.21%   8.2    0s
H  170    73                    -122285.9436 -122507.27  0.18%   7.1    0s
H  350   244                    -122299.4300 -122497.14  0.16%   6.1    0s
H 1802   635                    -122300.9320 -122434.14  0.11%   4.7    0s
H 3008   661                    -122302.0191 -122371.00  0.06%   4.8    0s
* 4476   425              28    -122304.5384 -122343.70  0.03%   4.9    0s
* 4987    17              32    -122307.7038 -122328.93  0.02%   4.9    0s

Cutting planes:
  Gomory: 55
  Implied bound: 6
  MIR: 163
  Flow cover: 8
  RLT: 34
  Relax-and-lift: 6
  BQP: 2

Explored 5293 nodes (26743 simplex iterations) in 0.24 seconds (0.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -122308 -122305 -122302 ... -122248
No other solutions better than -122308

Optimal solution found (tolerance 1.00e-06)
Best objective -1.223077037624e+05, best bound -1.223077037624e+05, gap 0.0000%
  Subproblem solved in 0.26s
  Worst-case operational profit (Z_SP) = 150553.12
  Scenario: 49 demand increases, 11 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122307.70
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -122307.70 = 150553.12
  [DEBUG]   Current θ from Master = 158146.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7593.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7639.23
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2642.9623, Absolute Gap = 2642.9623, Relative Gap = 0.173506
  Not converged yet (gap = 2642.96 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 49 increases, 11 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524435 nonzeros
Model fingerprint: 0xf35076f1
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80092 rows and 32522 columns
Presolve time: 1.74s
Presolved: 104771 rows, 44618 columns, 632579 nonzeros
Variable types: 42359 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346169.1772
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 650
 AA' NZ     : 3.616e+06
 Factor NZ  : 8.668e+06 (roughly 130 MB of memory)
 Factor Ops : 1.652e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.69777317e+07  1.82417789e+08  1.03e+05 1.83e+01  7.32e+04     3s
   1  -1.28246085e+07  1.62658264e+08  7.19e+04 6.32e+01  5.03e+04     3s
   2  -4.00860400e+06  1.20910978e+08  2.23e+04 8.40e-01  1.66e+04     3s
   3  -9.60086714e+05  9.04105765e+07  3.15e+03 1.31e+00  2.65e+03     3s
   4  -4.59975530e+05  4.27442356e+07  4.57e+02 1.96e-01  5.09e+02     3s
   5  -3.81129949e+05  2.86159040e+07  2.41e+02 1.17e-01  2.88e+02     3s
   6  -2.75968912e+05  2.03616683e+07  7.10e+01 7.65e-02  1.44e+02     3s
   7  -1.50601670e+05  1.47426591e+07  9.06e+00 5.23e-02  8.16e+01     3s
   8  -9.39915902e+04  7.97414769e+06  3.37e+00 2.69e-02  4.29e+01     4s
   9  -7.08679718e+04  5.14811817e+06  2.13e+00 1.72e-02  2.76e+01     4s
  10  -5.08675162e+04  1.25622003e+06  1.43e+00 4.00e-03  6.88e+00     4s
  11  -1.43431524e+04  4.71148484e+05  7.23e-01 1.33e-03  2.55e+00     4s
  12   3.65459521e+03  1.86783966e+05  3.40e-01 8.93e-04  9.58e-01     4s
  13   1.10203655e+04  1.33204142e+05  2.45e-01 6.09e-04  6.39e-01     4s
  14   1.87542838e+04  1.14449328e+05  1.68e-01 4.44e-04  5.00e-01     4s
  15   2.13992480e+04  9.76509869e+04  1.44e-01 5.76e-04  3.98e-01     4s
  16   2.63385379e+04  7.95879992e+04  1.07e-01 1.06e-03  2.78e-01     4s
  17   3.02345076e+04  7.22153059e+04  8.07e-02 1.14e-03  2.19e-01     4s
  18   3.24486545e+04  6.33405478e+04  6.69e-02 7.63e-04  1.61e-01     4s
  19   3.43378195e+04  5.91136972e+04  5.59e-02 9.75e-04  1.29e-01     4s
  20   3.53557686e+04  5.66201181e+04  4.96e-02 9.47e-04  1.11e-01     4s
  21   3.73918030e+04  5.26501996e+04  3.81e-02 1.04e-03  7.97e-02     4s
  22   3.85734966e+04  5.06617952e+04  3.18e-02 1.53e-03  6.31e-02     4s
  23   4.00517537e+04  4.93597052e+04  2.40e-02 1.63e-03  4.86e-02     4s
  24   4.11429522e+04  4.87541300e+04  1.87e-02 1.41e-03  3.97e-02     4s
  25   4.18998987e+04  4.77164853e+04  1.49e-02 9.94e-04  3.04e-02     5s
  26   4.24603358e+04  4.70811884e+04  1.19e-02 7.71e-04  2.41e-02     5s
  27   4.30947655e+04  4.62192458e+04  8.73e-03 4.39e-04  1.63e-02     5s
  28   4.38800751e+04  4.60720449e+04  4.89e-03 3.86e-04  1.14e-02     5s
  29   4.39442144e+04  4.57319961e+04  4.59e-03 2.69e-04  9.33e-03     5s
  30   4.42244795e+04  4.55730499e+04  3.33e-03 1.90e-04  7.04e-03     5s
  31   4.43689796e+04  4.54697968e+04  2.68e-03 1.57e-04  5.75e-03     5s
  32   4.45454884e+04  4.52643329e+04  1.86e-03 9.49e-05  3.75e-03     5s
  33   4.46871769e+04  4.51523146e+04  1.18e-03 6.16e-05  2.43e-03     5s
  34   4.47674551e+04  4.51147819e+04  8.24e-04 4.78e-05  1.81e-03     5s
  35   4.47944046e+04  4.50557709e+04  7.08e-04 2.89e-05  1.36e-03     5s
  36   4.48438486e+04  4.50283956e+04  4.98e-04 1.98e-05  9.64e-04     5s
  37   4.48788911e+04  4.50102794e+04  3.50e-04 1.38e-05  6.86e-04     5s
  38   4.49250865e+04  4.49923568e+04  1.58e-04 1.21e-05  3.51e-04     6s
  39   4.49415886e+04  4.49873279e+04  9.43e-05 9.79e-06  2.39e-04     6s
  40   4.49519141e+04  4.49809667e+04  5.05e-05 6.78e-06  1.52e-04     6s
  41   4.49617234e+04  4.49779174e+04  1.34e-05 5.38e-06  8.44e-05     6s
  42   4.49640673e+04  4.49677032e+04  5.72e-06 7.37e-07  1.90e-05     6s
  43   4.49653669e+04  4.49667536e+04  1.86e-06 5.79e-07  7.23e-06     6s
  44   4.49659904e+04  4.49660973e+04  1.50e-08 1.75e-07  5.57e-07     6s
  45   4.49659977e+04  4.49659979e+04  2.84e-09 5.95e-09  1.19e-09     6s

Barrier solved model in 45 iterations and 6.05 seconds (8.59 work units)
Optimal objective 4.49659977e+04


Root crossover log...

   81724 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    9959 PPushes remaining with PInf 3.6777423e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1953190e+00      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   44495    4.4965998e+04   0.000000e+00   3.195319e+00      9s
   44497    4.4965998e+04   0.000000e+00   0.000000e+00      9s
   44497    4.4965998e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.12s

Solved with barrier

Root relaxation: objective 4.496600e+04, 44497 iterations, 6.91 seconds (13.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 44965.9978    0  447 -190754.47 44965.9978   124%     -    9s
H    0     0                    -183309.8528 44965.9978   125%     -    9s
H    0     0                    -170827.2796 44965.9978   126%     -   11s
H    0     0                    -170299.1365 44965.9978   126%     -   11s
H    0     0                    -169003.9584 44965.9978   127%     -   11s
H    0     0                    -124417.8877 44965.9978   136%     -   11s
H    0     0                    -90439.11424 44965.9978   150%     -   11s
H    0     0                    -90366.19480 44965.9978   150%     -   11s
H    0     0                    -65946.99719 38471.3151   158%     -   40s
H    0     0                    -46541.59371 38471.3151   183%     -   40s
H    0     0                    -41525.61255 38471.3151   193%     -   40s
H    0     0                    -40431.60968 38471.3151   195%     -   40s
H    0     0                    -34729.31787 38471.3151   211%     -   44s
H    0     0                    -14775.76075 38471.3151   360%     -   44s
H    0     0                    -12149.71646 38471.3151   417%     -   44s
H    0     0                    -11823.94171 38471.3151   425%     -   44s
     0     0 38471.3151    0  509 -11823.942 38471.3151   425%     -   44s
H    0     0                    -11510.44748 38470.8656   434%     -   45s
H    0     0                    -11486.28442 38470.8656   435%     -   45s
     0     0 37578.3586    0  548 -11486.284 37578.3586   427%     -   67s
     0     0 37511.0160    0  563 -11486.284 37511.0160   427%     -   74s
     0     0 37509.7383    0  546 -11486.284 37509.7383   427%     -   77s
     0     0 37509.7050    0  555 -11486.284 37509.7050   427%     -   83s
     0     0 37509.7050    0  548 -11486.284 37509.7050   427%     -   85s
     0     0 37509.7050    0  548 -11486.284 37509.7050   427%     -   87s
     0     0 37509.7050    0  545 -11486.284 37509.7050   427%     -   88s
H    0     0                    -11405.87517 34059.6920   399%     -  125s
H    0     0                    -11192.82370 34059.6920   404%     -  125s
H    0     0                    -11033.19929 34059.6920   409%     -  125s
H    0     0                    -11032.15806 34059.6920   409%     -  125s
     0     0 34036.7811    0  582 -11032.158 34036.7811   409%     -  125s
H    0     0                    -2505.049680 34036.7811  1459%     -  126s
H    0     0                    4586.9484666 34036.7811   642%     -  126s
H    0     0                    4951.7094277 34036.7811   587%     -  126s
H    0     0                    5841.8561927 34036.7811   483%     -  126s
H    0     0                    6039.1849480 34036.7811   464%     -  126s
     0     0 32864.1046    0  635 6039.18495 32864.1046   444%     -  166s
     0     0 32579.3921    0  572 6039.18495 32579.3921   439%     -  188s
H    0     0                    9268.2083905 32379.0280   249%     -  211s
H    0     0                    9488.4546948 32379.0280   241%     -  211s
H    0     0                    9518.9077232 32379.0280   240%     -  211s
     0     0 32379.0280    0  642 9518.90772 32379.0280   240%     -  211s
     0     0 32323.5253    0  633 9518.90772 32323.5253   240%     -  221s
     0     0 32286.3231    0  636 9518.90772 32286.3231   239%     -  232s
     0     0 32269.2448    0  638 9518.90772 32269.2448   239%     -  238s
H    0     0                    9858.7969911 32228.4812   227%     -  246s
     0     0 32228.4812    0  631 9858.79699 32228.4812   227%     -  246s
     0     0 32212.8184    0  641 9858.79699 32212.8184   227%     -  250s
     0     0 32205.9869    0  635 9858.79699 32205.9869   227%     -  254s
     0     0 32020.6307    0  627 9858.79699 32020.6307   225%     -  264s
     0     0 32005.9603    0  644 9858.79699 32005.9603   225%     -  270s
     0     0 32004.2824    0  643 9858.79699 32004.2824   225%     -  273s
     0     0 32003.4674    0  643 9858.79699 32003.4674   225%     -  274s
H    0     0                    11084.323454 29922.4913   170%     -  336s
H    0     0                    11188.613103 29922.4913   167%     -  336s
     0     0 29922.4913    0  460 11188.6131 29922.4913   167%     -  336s
H    0     0                    11469.459087 29922.4290   161%     -  336s
H    0     0                    11472.978168 29922.4290   161%     -  336s
H    0     0                    11687.086911 29409.5188   152%     -  362s
H    0     0                    11892.302806 29409.5188   147%     -  362s
     0     0 29409.5188    0  473 11892.3028 29409.5188   147%     -  362s
     0     0 29162.1431    0  473 11892.3028 29162.1431   145%     -  382s
     0     0 29014.1925    0  475 11892.3028 29014.1925   144%     -  393s
     0     0 28952.8228    0  482 11892.3028 28952.8228   143%     -  400s
     0     0 28911.7777    0  482 11892.3028 28911.7777   143%     -  407s
     0     0 28850.4279    0  498 11892.3028 28850.4279   143%     -  416s
     0     0 28823.6731    0  492 11892.3028 28823.6731   142%     -  421s
     0     0 28812.7834    0  490 11892.3028 28812.7834   142%     -  424s
     0     0 28798.1193    0  492 11892.3028 28798.1193   142%     -  427s
     0     0 28794.7027    0  485 11892.3028 28794.7027   142%     -  430s
     0     0 28787.3827    0  488 11892.3028 28787.3827   142%     -  432s
     0     0 28785.7991    0  495 11892.3028 28785.7991   142%     -  433s
     0     0 27772.6853    0  501 11892.3028 27772.6853   134%     -  463s
     0     0 27567.7778    0  533 11892.3028 27567.7778   132%     -  480s
     0     0 27471.2591    0  537 11892.3028 27471.2591   131%     -  490s
     0     0 27445.2551    0  527 11892.3028 27445.2551   131%     -  494s
     0     0 27428.4123    0  525 11892.3028 27428.4123   131%     -  499s
     0     0 27413.3424    0  561 11892.3028 27413.3424   131%     -  504s
     0     0 27375.4702    0  567 11892.3028 27375.4702   130%     -  509s
     0     0 27366.4049    0  541 11892.3028 27366.4049   130%     -  513s
     0     0 27359.1077    0  531 11892.3028 27359.1077   130%     -  515s
     0     0 27341.1657    0  545 11892.3028 27341.1657   130%     -  518s
     0     0 27331.9469    0  539 11892.3028 27331.9469   130%     -  520s
     0     0 27329.0388    0  551 11892.3028 27329.0388   130%     -  522s
     0     0 27147.8289    0  529 11892.3028 27147.8289   128%     -  536s
     0     0 27117.4212    0  487 11892.3028 27117.4212   128%     -  543s
     0     0 27095.2829    0  520 11892.3028 27095.2829   128%     -  549s
     0     0 27085.5592    0  526 11892.3028 27085.5592   128%     -  553s
     0     0 27076.4572    0  511 11892.3028 27076.4572   128%     -  556s
     0     0 27068.4156    0  521 11892.3028 27068.4156   128%     -  561s
     0     0 27066.4811    0  510 11892.3028 27066.4811   128%     -  564s
     0     0 26952.6312    0  519 11892.3028 26952.6312   127%     -  576s
H    0     0                    12339.045001 26952.3718   118%     -  589s
H    0     0                    13864.382331 26952.3718  94.4%     -  595s
H    0     0                    13944.390850 26952.3718  93.3%     -  595s
     0     0 26905.2174    0  516 13944.3909 26905.2174  92.9%     -  607s
     0     0 26894.5173    0  518 13944.3909 26894.5173  92.9%     -  610s
     0     0 26890.9590    0  511 13944.3909 26890.9590  92.8%     -  612s
     0     0 26886.8777    0  499 13944.3909 26886.8777  92.8%     -  615s
     0     0 26883.3988    0  505 13944.3909 26883.3988  92.8%     -  618s
     0     0 26881.3625    0  515 13944.3909 26881.3625  92.8%     -  620s
     0     0 26836.2497    0  496 13944.3909 26836.2497  92.5%     -  629s
     0     0 26803.1379    0  539 13944.3909 26803.1379  92.2%     -  637s
     0     0 26796.7034    0  541 13944.3909 26796.7034  92.2%     -  641s
     0     0 26794.5205    0  509 13944.3909 26794.5205  92.2%     -  643s
     0     0 26770.3520    0  499 13944.3909 26770.3520  92.0%     -  648s
     0     0 26766.5395    0  506 13944.3909 26766.5395  92.0%     -  650s
     0     0 26764.8042    0  510 13944.3909 26764.8042  91.9%     -  652s
     0     0 26747.8219    0  492 13944.3909 26747.8219  91.8%     -  656s
     0     0 26741.6285    0  492 13944.3909 26741.6285  91.8%     -  660s
     0     0 26740.6947    0  485 13944.3909 26740.6947  91.8%     -  661s
     0     0 26724.7201    0  490 13944.3909 26724.7201  91.7%     -  666s
     0     0 26724.4840    0  490 13944.3909 26724.4840  91.7%     -  669s
H    0     0                    14025.691899 26724.4840  90.5%     -  736s
H    0     0                    14044.626943 26724.4129  90.3%     -  810s
H    0     0                    14068.616306 26724.4129  90.0%     -  810s
H    0     0                    14140.494921 26724.4129  89.0%     -  821s
H    0     0                    14172.164697 26724.4129  88.6%     -  826s
H    0     0                    14197.735325 26724.4129  88.2%     -  826s
     0     2 26724.4129    0  490 14197.7353 26724.4129  88.2%     -  922s
     1     3 25711.1055    1  460 14197.7353 26724.4129  88.2% 14301  939s
     2     4 26438.2013    1  570 14197.7353 26438.2013  86.2% 15060  953s
     3     7 25191.2460    2  467 14197.7353 26437.9804  86.2% 13347  965s
     6    13 25050.2308    3  451 14197.7353 26437.8964  86.2% 10745  983s
    12    25 24426.4920    4  444 14197.7353 26000.6273  83.1% 12032 1014s
    24    38 23881.4295    5  460 14197.7353 25923.2677  82.6% 19379 1077s
    37    70 24300.5802    5  497 14197.7353 25822.0895  81.9% 17173 1237s
H   46    70                    14203.956255 25822.0895  81.8% 15831 1237s
H   47    70                    14236.264795 25822.0895  81.4% 15759 1237s
    69   184 24149.1310    6  471 14236.2648 25439.8045  78.7% 19691 1284s
   183   250 23883.3623    8  477 14236.2648 25439.8045  78.7% 12135 1308s
H  185   250                    14238.092922 25439.8045  78.7% 12020 1308s
H  215   250                    14298.057278 25439.8045  77.9% 11121 1308s
   253   299 22644.7424   10  454 14298.0573 25439.8045  77.9% 10417 1332s
   314   323 22624.2943   12  435 14298.0573 25439.8045  77.9%  9552 1354s
   362   368 22388.2023   13  441 14298.0573 25439.8045  77.9%  9110 1378s
   420   396 22226.6540   15  444 14298.0573 25439.8045  77.9%  8822 1402s
   458   443 22191.3006   16  410 14298.0573 25439.8045  77.9%  9008 1425s
   515   473 22077.3593   17  402 14298.0573 25439.8045  77.9%  8902 1443s
   555   506 22072.9096   18  326 14298.0573 25439.8045  77.9%  8758 1462s
   600   551 21820.2344   20  325 14298.0573 25439.8045  77.9%  8616 1482s
   657   575 21773.3591   21  415 14298.0573 25439.8045  77.9%  8449 1529s
   691   600 21565.9842   22  391 14298.0573 25439.8045  77.9%  8418 1585s
   736   644 21552.2753   23  313 14298.0573 25439.8045  77.9%  8279 1633s
   780   689 21281.5175   24  354 14298.0573 25439.8045  77.9%  8198 1649s
H  824   689                    14352.650505 25439.8045  77.2%  8081 1649s
   829   800 21109.4178   25  339 14352.6505 25439.8045  77.2%  8047 1665s
H  948   878                    14440.161920 25439.8045  76.2%  7583 1683s
H  951   878                    14457.258267 25439.8045  76.0%  7576 1683s
H  976   878                    14599.071707 25439.8045  74.3%  7457 1683s
  1050   890 20671.6370   31  396 14599.0717 25439.8045  74.3%  7257 1702s
  1118   937 20306.1631   32  319 14599.0717 25439.8045  74.3%  7097 1723s
  1187  1001 20267.3214   33  310 14599.0717 25439.8045  74.3%  7037 1744s
  1267  1063 20164.9987   34  329 14599.0717 25439.8045  74.3%  7020 1765s
  1361  1114 16142.8127   35  317 14599.0717 25439.8045  74.3%  6957 1787s
  1448  1200 15977.0598   36  334 14599.0717 25439.8045  74.3%  6822 1810s
  1563  1275 15717.1408   37  323 14599.0717 25439.8045  74.3%  6733 1834s
  1663  1352 15530.6585   38  338 14599.0717 25388.7606  73.9%  6708 1860s
  1771  1448 14889.2533   41  332 14599.0717 25388.7606  73.9%  6684 1885s
  1925  1526 15942.6555   16  471 14599.0717 25388.7606  73.9%  6529 1910s
  2064  1615 15659.5847   18  438 14599.0717 25388.7606  73.9%  6427 1937s
  2205  1697 15314.1913   20  415 14599.0717 24725.2310  69.4%  6332 1965s
  2364  1803 14727.7618   24  411 14599.0717 24725.2310  69.4%  6232 1993s
  2525  1868 19982.7505   13  459 14599.0717 24725.2310  69.4%  6200 2023s
  2662  1932 19870.8216   14  462 14599.0717 24725.2310  69.4%  6210 2055s
  2790  2016 19720.6167   15  333 14599.0717 24512.1243  67.9%  6250 2089s
  2917  2110 19138.1038   17  425 14599.0717 24512.1243  67.9%  6323 2124s
  3071  2161 18139.1268   21  279 14599.0717 24487.5746  67.7%  6325 2157s
  3208  2222 15337.4199   23  151 14599.0717 24427.5712  67.3%  6367 2194s
  3317  2313     cutoff   42      14599.0717 24289.2689  66.4%  6525 2233s
  3448  2402 22625.7518   13  326 14599.0717 24289.2689  66.4%  6621 2275s
  3581  2514 22093.9806   15  422 14599.0717 24289.2689  66.4%  6715 2319s
  3739  2557 17104.4331   18  151 14599.0717 24289.2689  66.4%  6774 2356s
  3834  2648 20541.5394   20  309 14599.0717 24247.0312  66.1%  6868 2396s
H 3961  2648                    14616.921276 24247.0312  65.9%  6917 2535s
  3962  2649 22740.2043   15  490 14616.9213 24247.0312  65.9%  6916 2926s
  3964  2650 20341.6380   18  344 14616.9213 24247.0312  65.9%  6912 2938s
  3965  2651 16520.7656   28  413 14616.9213 24247.0312  65.9%  6910 3002s
  3966  2652 18003.6831   57  425 14616.9213 24247.0312  65.9%  6909 3057s
  3967  2652 24003.7459    8  493 14616.9213 24247.0312  65.9%  6907 3093s
  3968  2653 16806.9250   20  464 14616.9213 24247.0312  65.9%  6905 3121s
  3969  2654 15434.4127   52  478 14616.9213 24247.0312  65.9%  6903 3140s
  3970  2654 15762.6722   43  516 14616.9213 24247.0312  65.9%  6902 3151s
  3971  2655 17537.9843   16  499 14616.9213 24247.0312  65.9%  6900 3162s
  3972  2656 19758.5319   16  502 14616.9213 24247.0312  65.9%  6898 3173s
  3973  2656 23919.7971    8  504 14616.9213 24247.0312  65.9%  6896 3181s
  3974  2657 15280.2579   31  500 14616.9213 24247.0312  65.9%  6895 3189s
  3975  2658 19746.0660   10  497 14616.9213 24247.0312  65.9%  6893 3199s
  3976  2658 21730.4531   19  498 14616.9213 24247.0312  65.9%  6891 3207s
  3977  2659 19845.8953   16  490 14616.9213 24247.0312  65.9%  6890 3215s
  3978  2660 19718.8485   47  500 14616.9213 24247.0312  65.9%  6888 3222s
  3979  2660 18864.9504   19  490 14616.9213 24247.0312  65.9%  6886 3226s
  3980  2661 15199.5254   42  496 14616.9213 24247.0312  65.9%  6884 3233s
  3981  2662 21793.0352   12  488 14616.9213 24247.0312  65.9%  6883 3238s
  3982  2662 20856.8091   10  486 14616.9213 24247.0312  65.9%  6881 3242s
  3983  2663 17870.4099   45  480 14616.9213 24247.0312  65.9%  6879 3246s
  3984  2664 15656.8960   49  486 14616.9213 24247.0312  65.9%  6877 3251s
  3985  2664 17873.3634   50  485 14616.9213 24247.0312  65.9%  6876 3268s
  3986  2665 19576.9985   27  464 14616.9213 24247.0312  65.9%  6874 3274s
  3987  2666 19335.0153   33  458 14616.9213 24247.0312  65.9%  6872 3278s
  3988  2666 15971.9850   37  467 14616.9213 24247.0312  65.9%  6871 3283s
  3989  2667 19569.6643   30  500 14616.9213 24247.0312  65.9%  6869 3294s
  3990  2668 18218.3972   39  472 14616.9213 24247.0312  65.9%  6867 3304s
  3991  2668 17596.2924   22  467 14616.9213 24247.0312  65.9%  6865 3309s
  3992  2669 23005.3493   16  480 14616.9213 24247.0312  65.9%  6864 3315s
  3993  2670 15872.3962   48  494 14616.9213 24247.0312  65.9%  6862 3324s
  3994  2670 19883.7782   41  476 14616.9213 24247.0312  65.9%  6860 3331s
  3995  2671 16418.5218   43  473 14616.9213 24247.0312  65.9%  6859 3339s
  3996  2672 17900.8793   29  486 14616.9213 24247.0312  65.9%  6857 3344s
  3997  2672 15719.4358   35  478 14616.9213 24247.0312  65.9%  6855 3354s
  3998  2673 23912.4332   13  483 14616.9213 24247.0312  65.9%  6853 3360s
  3999  2674 23692.0268    8  488 14616.9213 24247.0312  65.9%  6852 3369s
  4000  2674 18579.4232   35  481 14616.9213 24247.0312  65.9%  6850 3374s
  4001  2675 15356.5379   30  482 14616.9213 24247.0312  65.9%  6848 3382s
  4002  2676 19841.2546   32  479 14616.9213 24247.0312  65.9%  6847 3385s
  4003  2676 20006.6910   19  483 14616.9213 24247.0312  65.9%  6845 3393s
  4004  2677 17071.4131   37  483 14616.9213 24247.0312  65.9%  6843 3397s
  4005  2678 18284.1211   20  485 14616.9213 24247.0312  65.9%  6841 3404s
  4006  2678 16508.6123   13  485 14616.9213 24247.0312  65.9%  6840 3419s
  4007  2679 16222.3986   52  485 14616.9213 24247.0312  65.9%  6838 3501s
  4008  2682 24247.0312   16  440 14616.9213 24247.0312  65.9%  6936 3533s
  4009  2682 24247.0312   16  486 14616.9213 24247.0312  65.9%  6936 3551s
  4010  2685 24247.0312   17  398 14616.9213 24247.0312  65.9%  6936 3574s
  4013  2690 23831.4305   18  464 14616.9213 24247.0312  65.9%  6938 3600s

Cutting planes:
  Learned: 2
  Gomory: 12
  Implied bound: 60
  Projected implied bound: 396
  MIR: 894
  Mixing: 1
  Flow cover: 1105
  RLT: 53
  Relax-and-lift: 296

Explored 4019 nodes (28616963 simplex iterations) in 3600.06 seconds (8565.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14616.9 14599.1 14457.3 ... 14197.7

Time limit reached
Best objective 1.461692127581e+04, best bound 2.424703117812e+04, gap 65.8833%
  WARNING: Time limit reached. Using best solution found (gap: 65.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 14616.92, θ = 160847.63
  Upper Bound (UB) = 14616.92

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160847.63
  [DEBUG]   ✓ Scenario 0: θ = 160847.63 ≤ Q = 160847.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160847.63 ≤ Q = 160847.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 160847.63 ≤ Q = 160847.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x65578d45
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x65578d45
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.347843e+13
Presolve removed 2588 rows and 1890 columns
Presolve time: 0.00s
Presolved: 505 rows, 499 columns, 1414 nonzeros
Found heuristic solution: objective 6122039.0059
Variable types: 333 continuous, 166 integer (166 binary)
Found heuristic solution: objective 6121702.3053

Root relaxation: objective -1.438504e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143850.43    0  118 6121702.31 -143850.43   102%     -    0s
H    0     0                    -100883.9602 -143850.43  42.6%     -    0s
H    0     0                    -103629.8117 -143850.43  38.8%     -    0s
H    0     0                    -114424.4138 -143850.43  25.7%     -    0s
     0     0 -123804.37    0   73 -114424.41 -123804.37  8.20%     -    0s
H    0     0                    -122246.7630 -123715.50  1.20%     -    0s
H    0     0                    -122570.6642 -123715.50  0.93%     -    0s
     0     0 -123110.20    0   61 -122570.66 -123110.20  0.44%     -    0s
     0     0 -123055.76    0   50 -122570.66 -123055.76  0.40%     -    0s
     0     0 -123040.77    0   51 -122570.66 -123040.77  0.38%     -    0s
H    0     0                    -122573.6880 -122819.89  0.20%     -    0s
     0     0 -122819.89    0   23 -122573.69 -122819.89  0.20%     -    0s
     0     0 -122819.84    0   22 -122573.69 -122819.84  0.20%     -    0s
     0     0 -122796.52    0   20 -122573.69 -122796.52  0.18%     -    0s
     0     0 -122795.22    0   21 -122573.69 -122795.22  0.18%     -    0s
     0     0 -122732.03    0   17 -122573.69 -122732.03  0.13%     -    0s
     0     0 -122732.03    0   29 -122573.69 -122732.03  0.13%     -    0s
     0     0 -122610.07    0   15 -122573.69 -122610.07  0.03%     -    0s
     0     0 -122609.24    0   14 -122573.69 -122609.24  0.03%     -    0s
H    0     0                    -122591.5437 -122604.84  0.01%     -    0s
     0     0 -122602.15    0   14 -122591.54 -122602.15  0.01%     -    0s
     0     0 -122600.44    0    4 -122591.54 -122600.44  0.01%     -    0s
     0     0 -122600.24    0    2 -122591.54 -122600.24  0.01%     -    0s
H    0     0                    -122599.0924 -122600.24  0.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 10
  Flow cover: 11
  Relax-and-lift: 7

Explored 1 nodes (746 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -122599 -122592 -122574 ... 6.12204e+06
No other solutions better than -122599

Optimal solution found (tolerance 1.00e-06)
Best objective -1.225990923742e+05, best bound -1.225990923742e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 150077.58
  Scenario: 32 demand increases, 28 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122599.09
  [DEBUG]   S×d_nominal = 272676.68
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272676.68 + -122599.09 = 150077.58
  [DEBUG]   Current θ from Master = 160847.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10770.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3846.87
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2027.1596, Absolute Gap = 2027.1596, Relative Gap = 0.138686
  Not converged yet (gap = 2027.16 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 32 increases, 28 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567678 nonzeros
Model fingerprint: 0x37401930
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86758 rows and 35228 columns
Presolve time: 1.82s
Presolved: 113395 rows, 48152 columns, 683715 nonzeros
Variable types: 45893 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346169.1772
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 642
 AA' NZ     : 4.174e+06
 Factor NZ  : 1.108e+07 (roughly 160 MB of memory)
 Factor Ops : 3.806e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.75721258e+07  1.95854306e+08  1.07e+05 1.78e+01  7.53e+04     3s
   1  -1.33081800e+07  1.75554097e+08  7.46e+04 6.21e+01  5.19e+04     3s
   2  -4.33339477e+06  1.30113408e+08  2.43e+04 1.72e+00  1.80e+04     3s
   3  -8.01567729e+05  9.36094727e+07  2.11e+03 1.47e+00  1.91e+03     3s
   4  -4.60254611e+05  5.19682158e+07  4.56e+02 5.56e-01  5.38e+02     3s
   5  -3.90985933e+05  3.69786308e+07  2.51e+02 3.56e-01  3.26e+02     3s
   6  -3.02027977e+05  2.45549662e+07  7.40e+01 2.14e-01  1.58e+02     4s
   7  -2.15644412e+05  1.78094565e+07  2.28e+01 1.48e-01  9.70e+01     4s
   8  -1.44882658e+05  8.95970794e+06  4.52e+00 7.30e-02  4.52e+01     4s
   9  -8.80857338e+04  4.93103316e+06  2.08e+00 3.79e-02  2.45e+01     4s
  10  -4.72552985e+04  2.22506319e+06  1.01e+00 1.63e-02  1.10e+01     4s
  11  -1.56503578e+04  1.08488103e+06  4.26e-01 7.76e-03  5.32e+00     4s
  12  -6.25395661e+03  5.95407608e+05  2.99e-01 4.19e-03  2.91e+00     4s
  13   3.49136324e+03  2.96367217e+05  1.72e-01 2.11e-03  1.41e+00     4s
  14   1.45183649e+04  1.73560012e+05  8.14e-02 1.26e-03  7.67e-01     4s
  15   1.62289275e+04  1.58826379e+05  7.35e-02 1.14e-03  6.88e-01     4s
  16   2.10784247e+04  1.29066775e+05  5.39e-02 8.73e-04  5.21e-01     4s
  17   2.48535693e+04  1.13944756e+05  4.10e-02 8.50e-04  4.30e-01     4s
  18   2.79213904e+04  8.51445166e+04  3.21e-02 1.05e-03  2.76e-01     4s
  19   3.14292666e+04  7.24295668e+04  2.38e-02 9.40e-04  1.98e-01     4s
  20   3.26905501e+04  6.76281627e+04  2.11e-02 8.02e-04  1.68e-01     4s
  21   3.47869686e+04  6.18051648e+04  1.72e-02 5.90e-04  1.30e-01     5s
  22   3.55053085e+04  5.80122698e+04  1.58e-02 4.59e-04  1.09e-01     5s
  23   3.77898445e+04  5.49535991e+04  1.16e-02 3.42e-04  8.28e-02     5s
  24   3.90153501e+04  5.14906013e+04  9.47e-03 2.16e-04  6.02e-02     5s
  25   4.01831636e+04  4.99920612e+04  7.55e-03 1.86e-04  4.73e-02     5s
  26   4.11642215e+04  4.91018468e+04  6.00e-03 1.51e-04  3.83e-02     5s
  27   4.17241022e+04  4.77693711e+04  5.10e-03 1.18e-04  2.92e-02     5s
  28   4.24118631e+04  4.71499478e+04  4.01e-03 9.64e-05  2.28e-02     5s
  29   4.31410521e+04  4.64671994e+04  2.91e-03 6.33e-05  1.60e-02     5s
  30   4.36154259e+04  4.61635643e+04  2.17e-03 4.89e-05  1.23e-02     5s
  31   4.38046481e+04  4.57784412e+04  1.89e-03 3.19e-05  9.52e-03     5s
  32   4.41978414e+04  4.56416569e+04  1.29e-03 2.52e-05  6.96e-03     6s
  33   4.42961297e+04  4.54802877e+04  1.14e-03 1.76e-05  5.71e-03     6s
  34   4.46390802e+04  4.53905475e+04  6.31e-04 1.33e-05  3.62e-03     6s
  35   4.47535115e+04  4.52668865e+04  4.67e-04 7.51e-06  2.48e-03     6s
  36   4.49213156e+04  4.51998606e+04  2.34e-04 4.38e-06  1.34e-03     6s
  37   4.49398102e+04  4.51783151e+04  2.08e-04 3.43e-06  1.15e-03     6s
  38   4.49744142e+04  4.51499398e+04  1.60e-04 2.21e-06  8.46e-04     6s
  39   4.50337470e+04  4.51232397e+04  7.93e-05 9.27e-07  4.32e-04     6s
  40   4.50659525e+04  4.51097371e+04  4.05e-05 3.79e-07  2.11e-04     6s
  41   4.50680171e+04  4.51044806e+04  3.79e-05 1.81e-07  1.76e-04     6s
  42   4.50962685e+04  4.51023723e+04  3.91e-06 9.77e-08  2.94e-05     6s
  43   4.50976312e+04  4.50998341e+04  2.37e-06 1.34e-09  1.06e-05     6s
  44   4.50984562e+04  4.50998216e+04  1.42e-06 1.12e-09  6.58e-06     6s
  45   4.50997308e+04  4.50997592e+04  2.51e-08 7.39e-08  1.37e-07     7s
  46   4.50997560e+04  4.50997560e+04  3.41e-09 4.38e-09  9.76e-11     7s

Barrier solved model in 46 iterations and 6.68 seconds (10.18 work units)
Optimal objective 4.50997560e+04


Root crossover log...

   88982 DPushes remaining with DInf 1.8114292e-09                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    3558 PPushes remaining with PInf 9.0487894e-06                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.8167241e-01      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35409    4.5099756e+04   0.000000e+00   1.816724e-01      9s
   35410    4.5099756e+04   0.000000e+00   0.000000e+00      9s
   35410    4.5099756e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.509976e+04, 35410 iterations, 6.88 seconds (13.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45099.7560    0  445 -190754.47 45099.7560   124%     -    9s
H    0     0                    -188403.9081 45099.7560   124%     -    9s
H    0     0                    -183765.0641 45099.7560   125%     -   11s
H    0     0                    -183660.6502 45099.7560   125%     -   11s
H    0     0                    -182488.3940 45099.7560   125%     -   11s
H    0     0                    -181643.0942 45099.7560   125%     -   11s
H    0     0                    -147553.2221 45099.7560   131%     -   11s
H    0     0                    -146245.8523 45099.7560   131%     -   11s
H    0     0                    -130571.8769 45099.7560   135%     -   11s
H    0     0                    -120474.6063 45099.7560   137%     -   11s
H    0     0                    -117827.5655 45099.7560   138%     -   11s
H    0     0                    -105402.4632 45099.7560   143%     -   11s
H    0     0                    -67665.71404 45099.7560   167%     -   11s
H    0     0                    -66002.47280 45099.7560   168%     -   13s
H    0     0                    -64495.34231 45099.7560   170%     -   13s
H    0     0                    -39689.74765 45099.7560   214%     -   13s
H    0     0                    -37313.36792 45099.7560   221%     -   13s
H    0     0                    -14829.31197 38834.7819   362%     -   42s
H    0     0                    -8160.448237 38834.7819   576%     -   42s
H    0     0                    -8124.965881 38834.7819   578%     -   42s
H    0     0                    -8027.194897 38834.7819   584%     -   42s
H    0     0                    -8001.030296 38834.7819   585%     -   42s
H    0     0                    -7827.493185 38834.7819   596%     -   42s
     0     0 38834.7819    0  520 -7827.4932 38834.7819   596%     -   42s
H    0     0                    -7393.784412 38834.5240   625%     -   43s
H    0     0                    -7305.013144 38834.5240   632%     -   43s
H    0     0                    -7141.486289 38834.5240   644%     -   43s
     0     0 38160.0580    0  538 -7141.4863 38160.0580   634%     -   54s
     0     0 38097.5905    0  533 -7141.4863 38097.5905   633%     -   60s
     0     0 38023.3035    0  532 -7141.4863 38023.3035   632%     -   68s
     0     0 38005.3511    0  528 -7141.4863 38005.3511   632%     -   69s
     0     0 38003.1032    0  537 -7141.4863 38003.1032   632%     -   69s
     0     0 38001.8817    0  537 -7141.4863 38001.8817   632%     -   70s
     0     0 38001.1688    0  542 -7141.4863 38001.1688   632%     -   70s
H    0     0                    -4608.735883 34701.1437   853%     -  117s
H    0     0                    -4579.194771 34701.1437   858%     -  117s
H    0     0                    -3990.991144 34701.1437   969%     -  117s
H    0     0                    -3969.541314 34701.1437   974%     -  117s
H    0     0                    -3957.522225 34701.1437   977%     -  117s
H    0     0                    -3887.251221 34701.1437   993%     -  117s
H    0     0                    -3826.740883 34701.1437  1007%     -  117s
H    0     0                    -3718.496442 34701.1437  1033%     -  117s
H    0     0                    -3691.961633 34701.1437  1040%     -  117s
     0     0 34701.1437    0  483 -3691.9616 34701.1437  1040%     -  117s
H    0     0                    -630.9781307 34701.0555  5600%     -  118s
H    0     0                    8665.9545248 34701.0555   300%     -  118s
H    0     0                    8872.0843415 34701.0555   291%     -  118s
     0     0 33311.0337    0  538 8872.08434 33311.0337   275%     -  172s
     0     0 33048.7492    0  519 8872.08434 33048.7492   273%     -  197s
H    0     0                    8972.0612443 33003.2681   268%     -  211s
H    0     0                    9140.4441044 33003.2681   261%     -  211s
     0     0 33003.2681    0  510 9140.44410 33003.2681   261%     -  211s
H    0     0                    9877.7722252 32826.9522   232%     -  235s
     0     0 32826.9522    0  530 9877.77223 32826.9522   232%     -  235s
     0     0 32747.7598    0  522 9877.77223 32747.7598   232%     -  245s
     0     0 32735.5382    0  529 9877.77223 32735.5382   231%     -  250s
     0     0 32702.7154    0  515 9877.77223 32702.7154   231%     -  257s
     0     0 32684.1952    0  543 9877.77223 32684.1952   231%     -  262s
     0     0 32680.4045    0  542 9877.77223 32680.4045   231%     -  265s
     0     0 32656.7034    0  553 9877.77223 32656.7034   231%     -  273s
     0     0 32613.9601    0  589 9877.77223 32613.9601   230%     -  282s
     0     0 32588.4413    0  574 9877.77223 32588.4413   230%     -  287s
     0     0 32557.5629    0  585 9877.77223 32557.5629   230%     -  293s
     0     0 32552.7663    0  598 9877.77223 32552.7663   230%     -  296s
     0     0 32549.2564    0  577 9877.77223 32549.2564   230%     -  298s
     0     0 32530.9138    0  581 9877.77223 32530.9138   229%     -  302s
     0     0 32521.7057    0  585 9877.77223 32521.7057   229%     -  306s
     0     0 32521.4739    0  587 9877.77223 32521.4739   229%     -  307s
     0     0 29830.4437    0  511 9877.77223 29830.4437   202%     -  388s
H    0     0                    9928.6312650 29184.2393   194%     -  428s
     0     0 29184.2393    0  605 9928.63127 29184.2393   194%     -  428s
     0     0 28915.0161    0  599 9928.63127 28915.0161   191%     -  451s
     0     0 28797.4593    0  555 9928.63127 28797.4593   190%     -  467s
H    0     0                    10016.806274 28739.5950   187%     -  477s
     0     0 28739.5950    0  614 10016.8063 28739.5950   187%     -  477s
H    0     0                    10960.627534 28698.9535   162%     -  485s
H    0     0                    11439.976253 28698.9535   151%     -  485s
H    0     0                    11470.311446 28698.9535   150%     -  485s
     0     0 28698.9535    0  612 11470.3114 28698.9535   150%     -  485s
H    0     0                    11488.507304 28669.0577   150%     -  493s
     0     0 28669.0577    0  610 11488.5073 28669.0577   150%     -  493s
     0     0 28659.8433    0  610 11488.5073 28659.8433   149%     -  498s
     0     0 28645.2943    0  600 11488.5073 28645.2943   149%     -  502s
     0     0 28619.9799    0  607 11488.5073 28619.9799   149%     -  508s
     0     0 28609.7197    0  603 11488.5073 28609.7197   149%     -  511s
     0     0 28603.2297    0  655 11488.5073 28603.2297   149%     -  514s
     0     0 28595.7888    0  595 11488.5073 28595.7888   149%     -  517s
     0     0 28571.7023    0  625 11488.5073 28571.7023   149%     -  522s
     0     0 28565.5483    0  620 11488.5073 28565.5483   149%     -  526s
     0     0 28564.2282    0  627 11488.5073 28564.2282   149%     -  527s
     0     0 27726.1968    0  495 11488.5073 27726.1968   141%     -  572s
H    0     0                    11786.251056 27502.5076   133%     -  586s
     0     0 27502.5076    0  497 11786.2511 27502.5076   133%     -  586s
H    0     0                    11812.670071 27395.3459   132%     -  596s
H    0     0                    11836.833127 27395.3459   131%     -  596s
H    0     0                    11992.312850 27395.3459   128%     -  596s
     0     0 27395.3459    0  505 11992.3128 27395.3459   128%     -  596s
     0     0 27315.3829    0  520 11992.3128 27315.3829   128%     -  606s
H    0     0                    12140.347808 27271.1491   125%     -  612s
H    0     0                    12164.212099 27271.1491   124%     -  612s
     0     0 27271.1491    0  501 12164.2121 27271.1491   124%     -  612s
     0     0 27256.0118    0  519 12164.2121 27256.0118   124%     -  616s
     0     0 27243.4593    0  523 12164.2121 27243.4593   124%     -  619s
     0     0 27187.7327    0  512 12164.2121 27187.7327   124%     -  628s
     0     0 27172.5163    0  527 12164.2121 27172.5163   123%     -  634s
     0     0 27169.3342    0  532 12164.2121 27169.3342   123%     -  637s
     0     0 27167.8000    0  536 12164.2121 27167.8000   123%     -  638s
H    0     0                    12790.317793 27014.0517   111%     -  654s
     0     0 27014.0517    0  506 12790.3178 27014.0517   111%     -  654s
H    0     0                    13721.750926 27013.9118  96.9%     -  655s
H    0     0                    13960.915081 27013.9118  93.5%     -  655s
H    0     0                    13968.725347 27013.9118  93.4%     -  655s
H    0     0                    14001.618680 27013.9118  92.9%     -  655s
     0     0 26935.2790    0  512 14001.6187 26935.2790  92.4%     -  663s
     0     0 26928.1860    0  509 14001.6187 26928.1860  92.3%     -  666s
     0     0 26924.6157    0  504 14001.6187 26924.6157  92.3%     -  668s
     0     0 26922.7993    0  507 14001.6187 26922.7993  92.3%     -  669s
     0     0 26849.4569    0  490 14001.6187 26849.4569  91.8%     -  683s
H    0     0                    14072.060063 26849.4426  90.8%     -  687s
     0     0 26802.1636    0  517 14072.0601 26802.1636  90.5%     -  697s
     0     0 26789.1447    0  560 14072.0601 26789.1447  90.4%     -  703s
     0     0 26782.9126    0  518 14072.0601 26782.9126  90.3%     -  709s
     0     0 26777.6983    0  513 14072.0601 26777.6983  90.3%     -  711s
     0     0 26775.6322    0  512 14072.0601 26775.6322  90.3%     -  713s
     0     0 26725.2761    0  526 14072.0601 26725.2761  89.9%     -  724s
     0     0 26709.2757    0  517 14072.0601 26709.2757  89.8%     -  730s
     0     0 26703.6141    0  531 14072.0601 26703.6141  89.8%     -  734s
     0     0 26700.5673    0  524 14072.0601 26700.5673  89.7%     -  736s
     0     0 26686.7437    0  519 14072.0601 26686.7437  89.6%     -  743s
     0     0 26684.1471    0  521 14072.0601 26684.1471  89.6%     -  745s
     0     0 26675.5043    0  523 14072.0601 26675.5043  89.6%     -  751s
     0     0 26672.8367    0  514 14072.0601 26672.8367  89.5%     -  755s
     0     0 26666.9029    0  525 14072.0601 26666.9029  89.5%     -  760s
     0     0 26666.8279    0  525 14072.0601 26666.8279  89.5%     -  763s
H    0     0                    14078.538284 26666.8279  89.4%     -  837s
H    0     0                    14087.835160 26666.8279  89.3%     -  837s
H    0     0                    14143.676798 26666.8279  88.5%     -  837s
H    0     0                    14191.275069 26666.8279  87.9%     -  837s
H    0     0                    14279.638279 26666.8049  86.7%     -  939s
     0     2 26666.8049    0  525 14279.6383 26666.8049  86.7%     -  966s
     1     3 26240.2262    1  463 14279.6383 26666.7797  86.7% 15582  984s
     2     4 26417.4680    1  520 14279.6383 26417.4680  85.0% 12834  994s
     3     7 24705.0330    2  482 14279.6383 26417.4001  85.0% 11532 1012s
     6    14 25982.5226    3  518 14279.6383 26417.1550  85.0% 12410 1041s
    13    28 25613.4123    4  509 14279.6383 26096.3648  82.8% 13592 1083s
    27    42 24199.0172    5  437 14279.6383 25647.1845  79.6% 26460 1240s
    41    73 22045.9867    5  405 14279.6383 25647.1845  79.6% 22997 1343s
    72   140 21872.4572    6  405 14279.6383 25490.0151  78.5% 21859 1391s
   141   170 21639.0297    8  406 14279.6383 25460.6164  78.3% 14673 1424s
   171   202     cutoff    8      14279.6383 25460.3976  78.3% 13058 1475s
   205   237 21357.9350   10  389 14279.6383 25460.3976  78.3% 12215 1512s
   240   281 21336.9386    9  381 14279.6383 25460.3976  78.3% 11373 1557s
   284   329 21348.1964   11  371 14279.6383 25451.3307  78.2% 10589 1588s
H  289   329                    14413.252695 25451.3307  76.6% 10447 1588s
   336   404 18386.1362   10  317 14413.2527 25451.3307  76.6%  9811 1626s
   418   431 21139.3665   12  394 14413.2527 25451.3307  76.6%  9095 1678s
   453   464 20250.0854   12  400 14413.2527 25450.5534  76.6%  9106 1755s
H  461   464                    14477.981700 25450.5534  75.8%  9104 1755s
H  470   464                    14484.452605 25450.5534  75.7%  9133 1755s
   492   545     cutoff   11      14484.4526 25450.5534  75.7%  9560 1789s
   597   621 19505.0321   13  396 14484.4526 25450.5534  75.7%  9224 1818s
   701   680 19555.6381   29  239 14484.4526 25305.1411  74.7%  8865 1843s
   785   752 18751.4873   14  394 14484.4526 25305.1411  74.7%  8592 1863s
   861   843 18609.9808   15  396 14484.4526 25305.1411  74.7%  8516 1889s
   968   898 17639.8125   40  266 14484.4526 25305.1411  74.7%  8210 1912s
  1051   950 18445.6860   15  399 14484.4526 25305.1411  74.7%  8085 1938s
  1131  1021 18034.0412   17  406 14484.4526 25305.1411  74.7%  8074 1964s
  1230  1101 17924.0384   19  381 14484.4526 25305.1411  74.7%  8001 1987s
  1350  1201 17729.1955   20  392 14484.4526 25305.1411  74.7%  7821 2015s
  1479  1246 17476.8107   22  416 14484.4526 25305.1411  74.7%  7717 2042s
  1600  1306 15007.0320   23  402 14484.4526 25305.1411  74.7%  7612 2072s
  1729  1355     cutoff   24      14484.4526 25305.1411  74.7%  7479 2103s
  1879  1429 infeasible   47      14484.4526 25305.1411  74.7%  7251 2133s
  2009  1537 19722.7924   28  250 14484.4526 25305.1411  74.7%  7190 2167s
  2146  1665 19208.1038   35  138 14484.4526 25305.1411  74.7%  7163 2200s
  2322  1823 18608.6404   43  140 14484.4526 25305.1411  74.7%  7081 2234s
  2506  1825 17653.3017   50  113 14484.4526 24579.8445  69.7%  6962 2270s
  2658  1873     cutoff   26      14484.4526 24579.8445  69.7%  6936 2312s
  2767  1918 infeasible   29      14484.4526 24450.6218  68.8%  7032 2352s
  2864  1986 23678.8793    6  461 14484.4526 24450.6218  68.8%  7143 2393s
  2992  2043 23452.8397    7  478 14484.4526 24450.6218  68.8%  7180 2432s
  3133  2109 22190.1643   10  440 14484.4526 24450.6218  68.8%  7190 2476s
  3285  2198 22016.1098   11  419 14484.4526 24450.6218  68.8%  7231 2523s
  3437  2258 19644.8743   13  167 14484.4526 24450.6218  68.8%  7313 2572s
  3564  2315 16028.0409   15  106 14484.4526 24450.6218  68.8%  7377 2620s
  3718  2389 16305.3249   53  188 14484.4526 24450.6218  68.8%  7460 2668s
  3869  2462 15891.0450   56  211 14484.4526 24450.6218  68.8%  7580 2718s
  4020  2539 infeasible   45      14484.4526 24146.1952  66.7%  7693 2777s
  4165  2639 21787.2097    7  460 14484.4526 24137.5081  66.6%  7825 2838s
H 4349  2637                    14563.781448 24137.5081  65.7%  7861 2897s
H 4349  2621                    14707.106775 24137.5081  64.1%  7861 2914s
  4350  2614 15804.1378   16  525 14707.1068 24137.5081  64.1%  7859 3381s
  4352  2615 21155.0517   17  356 14707.1068 24137.5081  64.1%  7856 3399s
  4353  2616 22505.4139   11  440 14707.1068 24137.5081  64.1%  7854 3471s
  4354  2617 21672.7511   10  499 14707.1068 24137.5081  64.1%  7852 3542s
  4355  2617 15840.4420   46  523 14707.1068 24137.5081  64.1%  7850 3589s

Cutting planes:
  Learned: 1
  Gomory: 14
  Implied bound: 112
  Projected implied bound: 612
  MIR: 1125
  Flow cover: 844
  RLT: 88
  Relax-and-lift: 263

Explored 4355 nodes (35149779 simplex iterations) in 3600.05 seconds (8491.22 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14707.1 14563.8 14484.5 ... 14078.5

Time limit reached
Best objective 1.470710677531e+04, best bound 2.413750810575e+04, gap 64.1214%
  WARNING: Time limit reached. Using best solution found (gap: 64.12%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 14707.11, θ = 157557.84
  Upper Bound (UB) = 14707.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157557.84
  [DEBUG]   ✓ Scenario 0: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157557.84 ≤ Q = 157557.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157557.84 ≤ Q = 157557.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 157557.84 ≤ Q = 157557.84 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x54947917
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x54947917
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.324156e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6572559.9214
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.473617e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147361.70    0  122 6572559.92 -147361.70   102%     -    0s
H    0     0                    -103573.5281 -147361.70  42.3%     -    0s
H    0     0                    -103686.2700 -147361.70  42.1%     -    0s
H    0     0                    -119196.8895 -147361.70  23.6%     -    0s
     0     0 -124713.52    0   63 -119196.89 -124713.52  4.63%     -    0s
H    0     0                    -122569.5337 -124654.77  1.70%     -    0s
H    0     0                    -123294.3202 -124654.77  1.10%     -    0s
     0     0 -123892.87    0   56 -123294.32 -123892.87  0.49%     -    0s
     0     0 -123845.45    0   56 -123294.32 -123845.45  0.45%     -    0s
     0     0 -123578.75    0   22 -123294.32 -123578.75  0.23%     -    0s
     0     0 -123578.06    0   21 -123294.32 -123578.06  0.23%     -    0s
     0     0 -123544.97    0   15 -123294.32 -123544.97  0.20%     -    0s
     0     0 -123509.82    0   13 -123294.32 -123509.82  0.17%     -    0s
     0     0 -123509.82    0   26 -123294.32 -123509.82  0.17%     -    0s
     0     0 -123397.22    0    6 -123294.32 -123397.22  0.08%     -    0s
H    0     0                    -123389.0951 -123397.03  0.01%     -    0s
     0     0 -123393.55    0    4 -123389.10 -123393.55  0.00%     -    0s
     0     0 -123393.55    0    4 -123389.10 -123393.55  0.00%     -    0s
H    0     0                    -123390.0006 -123393.55  0.00%     -    0s
     0     0 -123393.55    0    3 -123390.00 -123393.55  0.00%     -    0s
H    0     0                    -123392.9640 -123393.55  0.00%     -    0s
H    0     0                    -123393.3194 -123393.55  0.00%     -    0s
     0     0          -    0      -123393.32 -123393.33  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 2
  Flow cover: 2

Explored 1 nodes (788 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123393 -123393 -123390 ... -103574

Optimal solution found (tolerance 1.00e-06)
Best objective -1.233933194394e+05, best bound -1.233933331368e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 149467.50
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123393.32
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -123393.32 = 149467.50
  [DEBUG]   Current θ from Master = 157557.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8090.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6616.77
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2117.3451, Absolute Gap = 2117.3451, Relative Gap = 0.143967
  Not converged yet (gap = 2117.35 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610921 nonzeros
Model fingerprint: 0xfa0d0f3c
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 93424 rows and 37934 columns
Presolve time: 2.17s
Presolved: 122019 rows, 51686 columns, 751222 nonzeros
Variable types: 49427 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339222.7835
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.05s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 5.152e+06
 Factor NZ  : 1.148e+07 (roughly 160 MB of memory)
 Factor Ops : 2.343e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83802089e+07  2.08691283e+08  1.13e+05 1.67e+01  7.83e+04     5s
   1  -1.39633600e+07  1.86881885e+08  7.93e+04 6.02e+01  5.45e+04     5s
   2  -4.96419505e+06  1.38809687e+08  2.78e+04 9.22e-01  2.03e+04     5s
   3  -8.57125722e+05  1.00262152e+08  2.26e+03 1.56e+00  2.01e+03     5s
   4  -4.93069630e+05  4.29752726e+07  4.55e+02 3.69e-01  4.74e+02     5s
   5  -4.03387312e+05  2.82945506e+07  2.15e+02 2.16e-01  2.50e+02     5s
   6  -3.07908052e+05  2.18808339e+07  7.47e+01 1.56e-01  1.38e+02     5s
   7  -2.30681905e+05  1.67507898e+07  3.35e+01 1.13e-01  9.14e+01     5s
   8  -1.47146105e+05  1.09521238e+07  4.91e+00 7.39e-02  5.15e+01     5s
   9  -1.22200878e+05  8.83641222e+06  3.47e+00 5.93e-02  4.12e+01     5s
  10  -9.52626844e+04  4.00498106e+06  1.70e+00 2.55e-02  1.86e+01     5s
  11  -7.08413137e+04  1.17413764e+06  7.62e-01 7.09e-03  5.62e+00     5s
  12  -3.78379320e+04  4.43070249e+05  2.94e-01 2.57e-03  2.16e+00     5s
  13  -6.46418755e+03  2.20169671e+05  1.12e-01 1.36e-03  1.02e+00     5s
  14   2.84756510e+03  1.40920074e+05  8.06e-02 1.29e-03  6.20e-01     6s
  15   7.89095424e+03  1.15767570e+05  6.80e-02 1.11e-03  4.84e-01     6s
  16   1.50010943e+04  9.56631189e+04  4.99e-02 1.51e-03  3.62e-01     6s
  17   1.84273098e+04  8.37485165e+04  4.22e-02 1.45e-03  2.93e-01     6s
  18   2.17908206e+04  7.10141099e+04  3.49e-02 1.12e-03  2.21e-01     6s
  19   2.57102591e+04  6.16606950e+04  2.70e-02 7.75e-04  1.61e-01     6s
  20   2.86082194e+04  5.91971552e+04  2.16e-02 6.78e-04  1.37e-01     6s
  21   3.06902279e+04  5.41235101e+04  1.80e-02 4.76e-04  1.05e-01     6s
  22   3.12905652e+04  5.26229151e+04  1.69e-02 4.18e-04  9.58e-02     6s
  23   3.29041572e+04  5.06324820e+04  1.43e-02 3.46e-04  7.96e-02     6s
  24   3.47690105e+04  4.82027995e+04  1.12e-02 2.41e-04  6.03e-02     6s
  25   3.55837681e+04  4.66369049e+04  9.93e-03 2.00e-04  4.97e-02     7s
  26   3.67023853e+04  4.59642079e+04  8.20e-03 2.26e-04  4.16e-02     7s
  27   3.76033475e+04  4.45268026e+04  6.83e-03 1.55e-04  3.11e-02     7s
  28   3.86424402e+04  4.38786246e+04  5.28e-03 1.08e-04  2.35e-02     7s
  29   3.90561605e+04  4.34421182e+04  4.68e-03 1.67e-04  1.97e-02     7s
  30   3.96862261e+04  4.32122023e+04  3.73e-03 1.32e-04  1.58e-02     7s
  31   3.97907864e+04  4.31545507e+04  3.58e-03 1.24e-04  1.51e-02     7s
  32   4.03192907e+04  4.30646465e+04  2.80e-03 1.12e-04  1.23e-02     7s
  33   4.05014863e+04  4.29489173e+04  2.53e-03 9.50e-05  1.10e-02     7s
  34   4.08029881e+04  4.27989211e+04  2.11e-03 7.20e-05  8.97e-03     7s
  35   4.10850701e+04  4.26723079e+04  1.72e-03 5.44e-05  7.13e-03     8s
  36   4.13990442e+04  4.25769637e+04  1.24e-03 3.96e-05  5.29e-03     8s
  37   4.14706488e+04  4.25176569e+04  1.14e-03 3.14e-05  4.71e-03     8s
  38   4.15848157e+04  4.24383238e+04  9.74e-04 2.01e-05  3.84e-03     8s
  39   4.17388287e+04  4.24146365e+04  7.50e-04 1.69e-05  3.04e-03     8s
  40   4.17895498e+04  4.23949640e+04  6.79e-04 1.43e-05  2.72e-03     8s
  41   4.19211729e+04  4.23843086e+04  4.98e-04 1.29e-05  2.08e-03     8s
  42   4.19696218e+04  4.23732569e+04  4.27e-04 1.15e-05  1.81e-03     8s
  43   4.20582408e+04  4.23401316e+04  2.98e-04 1.39e-05  1.27e-03     8s
  44   4.21125021e+04  4.23220834e+04  2.21e-04 9.83e-06  9.42e-04     9s
  45   4.21423298e+04  4.23139006e+04  1.81e-04 7.02e-06  7.71e-04     9s
  46   4.22224067e+04  4.22864169e+04  7.02e-05 1.43e-06  2.88e-04     9s
  47   4.22488404e+04  4.22805651e+04  3.49e-05 6.38e-07  1.43e-04     9s
  48   4.22638719e+04  4.22785911e+04  1.63e-05 1.24e-06  6.62e-05     9s
  49   4.22750879e+04  4.22778795e+04  1.88e-06 5.85e-07  1.25e-05     9s
  50   4.22765753e+04  4.22774565e+04  5.52e-07 1.99e-07  3.96e-06     9s
  51   4.22766105e+04  4.22774460e+04  5.22e-07 1.87e-07  3.76e-06     9s
  52   4.22767756e+04  4.22773642e+04  3.82e-07 1.07e-07  2.65e-06     9s
  53   4.22772041e+04  4.22773501e+04  1.87e-08 9.20e-08  6.56e-07     9s
  54   4.22772238e+04  4.22772433e+04  1.01e-08 5.10e-09  8.81e-08    10s
  55   4.22772240e+04  4.22772433e+04  7.57e-07 6.46e-09  8.72e-08    10s
  56   4.22772343e+04  4.22772427e+04  1.29e-06 1.30e-06  3.95e-08    10s
  57   4.22772353e+04  4.22772427e+04  1.10e-06 1.39e-06  3.39e-08    10s
  58   4.22772353e+04  4.22772427e+04  1.10e-06 1.37e-06  3.38e-08    10s
  59   4.22772386e+04  4.22772425e+04  3.84e-06 9.09e-06  1.80e-08    10s
  60   4.22772393e+04  4.22772423e+04  2.92e-06 4.85e-06  1.33e-08    10s
  61   4.22772395e+04  4.22772423e+04  2.70e-06 4.55e-06  1.24e-08    10s
  62   4.22772409e+04  4.22772422e+04  3.81e-06 6.60e-06  5.50e-09    10s
  63   4.22772414e+04  4.22772422e+04  3.13e-06 4.23e-06  3.98e-09    11s
  64   4.22772413e+04  4.22772422e+04  3.16e-06 4.23e-06  3.97e-09    11s
  65   4.22772413e+04  4.22772422e+04  3.15e-06 4.19e-06  3.95e-09    11s
  66   4.22772415e+04  4.22772422e+04  3.91e-06 3.61e-06  3.79e-09    11s

Barrier solved model in 66 iterations and 10.93 seconds (15.18 work units)
Optimal objective 4.22772415e+04


Root crossover log...

   99796 DPushes remaining with DInf 0.0000000e+00                11s
   16875 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                18s

   35754 PPushes remaining with PInf 1.3486379e-04                18s
       0 PPushes remaining with PInf 0.0000000e+00                20s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3992919e+06     20s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   93386    4.2277242e+04   0.000000e+00   1.399292e+06     20s
   95117    4.2277242e+04   0.000000e+00   0.000000e+00     22s
   95117    4.2277242e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 2.66s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.227724e+04, 95117 iterations, 21.84 seconds (37.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42277.2420    0  380 -190754.47 42277.2420   122%     -   25s
H    0     0                    -186184.2792 42277.2420   123%     -   25s
H    0     0                    -58121.48433 42277.2420   173%     -   25s
H    0     0                    -56570.00336 42277.2420   175%     -   26s
H    0     0                    -47909.10619 42277.2420   188%     -   26s
H    0     0                    -8402.109035 42277.2420   603%     -   26s
H    0     0                    -8027.648585 42277.2420   627%     -   26s
H    0     0                    -601.2174116 42277.2420  7132%     -   28s
H    0     0                    3872.5826838 42277.2420   992%     -   28s
H    0     0                    4638.1153878 42277.2420   812%     -   28s
H    0     0                    4700.1579044 42277.2420   799%     -   28s
     0     0 35280.6314    0  326 4700.15790 35280.6314   651%     -   57s
H    0     0                    4981.3192809 35277.1231   608%     -   58s
     0     0 34591.3638    0  325 4981.31928 34591.3638   594%     -   67s
     0     0 34556.6277    0  342 4981.31928 34556.6277   594%     -   71s
     0     0 34455.0352    0  346 4981.31928 34455.0352   592%     -   77s
     0     0 34439.6730    0  335 4981.31928 34439.6730   591%     -   82s
     0     0 34429.1695    0  337 4981.31928 34429.1695   591%     -   84s
     0     0 34161.8924    0  339 4981.31928 34161.8924   586%     -   93s
     0     0 34149.0514    0  339 4981.31928 34149.0514   586%     -   99s
     0     0 34146.8760    0  342 4981.31928 34146.8760   585%     -  101s
     0     0 34111.3528    0  328 4981.31928 34111.3528   585%     -  105s
     0     0 34015.0563    0  375 4981.31928 34015.0563   583%     -  114s
     0     0 34010.1083    0  386 4981.31928 34010.1083   583%     -  117s
     0     0 34009.0636    0  384 4981.31928 34009.0636   583%     -  118s
     0     0 34006.6758    0  399 4981.31928 34006.6758   583%     -  121s
     0     0 34006.4934    0  399 4981.31928 34006.4934   583%     -  122s
     0     0 31140.8820    0  392 4981.31928 31140.8820   525%     -  156s
H    0     0                    9181.5199052 31140.3628   239%     -  157s
H    0     0                    9416.5852765 31140.3628   231%     -  157s
H    0     0                    9702.9405090 31140.3628   221%     -  157s
H    0     0                    9900.4125867 31140.3628   215%     -  157s
     0     0 30504.3365    0  419 9900.41259 30504.3365   208%     -  182s
     0     0 30319.4762    0  427 9900.41259 30319.4762   206%     -  195s
     0     0 30231.6028    0  426 9900.41259 30231.6028   205%     -  206s
     0     0 30097.1095    0  429 9900.41259 30097.1095   204%     -  217s
     0     0 30065.1419    0  432 9900.41259 30065.1419   204%     -  222s
     0     0 30030.6819    0  432 9900.41259 30030.6819   203%     -  227s
     0     0 30018.0245    0  428 9900.41259 30018.0245   203%     -  231s
     0     0 30013.1806    0  429 9900.41259 30013.1806   203%     -  234s
     0     0 30009.0588    0  438 9900.41259 30009.0588   203%     -  236s
     0     0 30005.1469    0  435 9900.41259 30005.1469   203%     -  237s
     0     0 29968.2638    0  432 9900.41259 29968.2638   203%     -  242s
     0     0 29958.4303    0  448 9900.41259 29958.4303   203%     -  244s
     0     0 29957.5111    0  447 9900.41259 29957.5111   203%     -  245s
     0     0 28481.6993    0  442 9900.41259 28481.6993   188%     -  287s
H    0     0                    10165.437599 28191.6527   177%     -  307s
H    0     0                    10627.324984 28191.6527   165%     -  307s
H    0     0                    10681.686547 28191.6527   164%     -  307s
H    0     0                    10705.849603 28191.6527   163%     -  307s
     0     0 28191.6527    0  433 10705.8496 28191.6527   163%     -  307s
     0     0 28109.3441    0  453 10705.8496 28109.3441   163%     -  317s
     0     0 28062.0617    0  458 10705.8496 28062.0617   162%     -  324s
     0     0 27949.1758    0  450 10705.8496 27949.1758   161%     -  332s
     0     0 27922.6014    0  450 10705.8496 27922.6014   161%     -  337s
     0     0 27894.7111    0  452 10705.8496 27894.7111   161%     -  342s
     0     0 27890.7115    0  461 10705.8496 27890.7115   161%     -  344s
     0     0 27871.5344    0  456 10705.8496 27871.5344   160%     -  346s
     0     0 27868.1892    0  460 10705.8496 27868.1892   160%     -  348s
     0     0 27865.8672    0  459 10705.8496 27865.8672   160%     -  349s
     0     0 27837.7348    0  464 10705.8496 27837.7348   160%     -  354s
     0     0 27825.2351    0  461 10705.8496 27825.2351   160%     -  357s
     0     0 27807.5496    0  460 10705.8496 27807.5496   160%     -  362s
     0     0 27804.8382    0  458 10705.8496 27804.8382   160%     -  363s
     0     0 27804.4935    0  464 10705.8496 27804.4935   160%     -  364s
     0     0 27241.6984    0  438 10705.8496 27241.6984   154%     -  394s
     0     0 27066.5966    0  467 10705.8496 27066.5966   153%     -  407s
     0     0 27019.1122    0  471 10705.8496 27019.1122   152%     -  414s
     0     0 26983.3346    0  461 10705.8496 26983.3346   152%     -  422s
     0     0 26931.2421    0  458 10705.8496 26931.2421   152%     -  428s
     0     0 26915.9010    0  464 10705.8496 26915.9010   151%     -  435s
     0     0 26902.6446    0  464 10705.8496 26902.6446   151%     -  438s
     0     0 26892.9473    0  473 10705.8496 26892.9473   151%     -  441s
     0     0 26890.4117    0  468 10705.8496 26890.4117   151%     -  443s
     0     0 26884.9296    0  452 10705.8496 26884.9296   151%     -  446s
     0     0 26865.5609    0  456 10705.8496 26865.5609   151%     -  450s
     0     0 26860.7661    0  462 10705.8496 26860.7661   151%     -  453s
     0     0 26860.1730    0  459 10705.8496 26860.1730   151%     -  454s
     0     0 26793.0503    0  468 10705.8496 26793.0503   150%     -  464s
H    0     0                    10782.911271 26793.0095   148%     -  464s
     0     0 26769.7230    0  481 10782.9113 26769.7230   148%     -  470s
     0     0 26750.1589    0  479 10782.9113 26750.1589   148%     -  476s
     0     0 26745.4624    0  478 10782.9113 26745.4624   148%     -  479s
     0     0 26742.2688    0  485 10782.9113 26742.2688   148%     -  481s
     0     0 26739.3942    0  475 10782.9113 26739.3942   148%     -  482s
     0     0 26738.9643    0  484 10782.9113 26738.9643   148%     -  483s
     0     0 26725.6899    0  471 10782.9113 26725.6899   148%     -  488s
H    0     0                    12247.704037 26725.5572   118%     -  493s
H    0     0                    12920.050533 26725.5572   107%     -  495s
H    0     0                    12932.967075 26725.5572   107%     -  495s
H    0     0                    12937.560289 26725.5572   107%     -  495s
     0     0 26712.1435    0  466 12937.5603 26712.1435   106%     -  500s
     0     0 26703.0177    0  473 12937.5603 26703.0177   106%     -  502s
     0     0 26700.9347    0  471 12937.5603 26700.9347   106%     -  503s
     0     0 26688.1610    0  475 12937.5603 26688.1610   106%     -  508s
H    0     0                    13167.002365 26688.0139   103%     -  509s
     0     0 26685.0501    0  470 13167.0024 26685.0501   103%     -  510s
     0     0 26680.4541    0  481 13167.0024 26680.4541   103%     -  512s
     0     0 26679.9680    0  481 13167.0024 26679.9680   103%     -  513s
     0     0 26621.4962    0  465 13167.0024 26621.4962   102%     -  522s
H    0     0                    13217.586743 26621.4035   101%     -  523s
H    0     0                    13417.513574 26621.4035  98.4%     -  524s
     0     0 26610.2470    0  486 13417.5136 26610.2470  98.3%     -  528s
     0     0 26606.4102    0  484 13417.5136 26606.4102  98.3%     -  530s
     0     0 26604.6083    0  522 13417.5136 26604.6083  98.3%     -  533s
     0     0 26585.7645    0  498 13417.5136 26585.7645  98.1%     -  540s
H    0     0                    13466.184884 26584.0049  97.4%     -  540s
     0     0 26580.6852    0  467 13466.1849 26580.6852  97.4%     -  543s
     0     0 26579.5070    0  424 13466.1849 26579.5070  97.4%     -  546s
     0     0 26573.1621    0  480 13466.1849 26573.1621  97.3%     -  550s
H    0     0                    14012.013055 26572.7322  89.6%     -  565s
H    0     0                    14286.626927 26572.7322  86.0%     -  566s
     0     0 26569.8642    0  478 14286.6269 26569.8642  86.0%     -  567s
     0     0 26567.0907    0  477 14286.6269 26567.0907  86.0%     -  569s
     0     0 26566.3654    0  418 14286.6269 26566.3654  86.0%     -  570s
     0     0 26563.3178    0  478 14286.6269 26563.3178  85.9%     -  574s
     0     0 26562.0195    0  472 14286.6269 26562.0195  85.9%     -  575s
     0     0 26559.3581    0  418 14286.6269 26559.3581  85.9%     -  578s
     0     0 26559.0015    0  490 14286.6269 26559.0015  85.9%     -  579s
     0     0 26558.7901    0  414 14286.6269 26558.7901  85.9%     -  581s
     0     0 26558.5846    0  414 14286.6269 26558.5846  85.9%     -  585s
H    0     0                    14297.770237 26558.5846  85.8%     -  634s
H    0     0                    14340.073818 26558.5846  85.2%     -  634s
H    0     0                    14359.502241 26558.3272  85.0%     -  720s
H    0     0                    14571.335389 26558.3272  82.3%     -  720s
     0     2 26558.3272    0  414 14571.3354 26558.3272  82.3%     -  721s
     1     3 26355.8708    1  442 14571.3354 26558.3272  82.3%  9406  731s
     2     4 26323.6533    1  409 14571.3354 26355.5165  80.9%  9432  741s
     3     5 24815.3575    2  428 14571.3354 26355.5165  80.9% 12516  760s
     4    10 24471.8966    3  348 14571.3354 26355.5165  80.9% 12074  783s
     9    20 23405.8093    4  344 14571.3354 25997.0507  78.4% 11013  810s
    19    40 22697.1013    5  298 14571.3354 25771.6058  76.9% 11961  837s
    39    52 25181.3697    5  458 14571.3354 25726.4288  76.6% 16919  896s
    51    76 24275.0128    6  451 14571.3354 25726.4288  76.6% 17426  948s
H   57    76                    14727.847187 25726.4288  74.7% 16898  948s
H   74    76                    14786.864469 25726.4288  74.0% 15203  948s
    75   131 24159.7132    7  442 14786.8645 25726.4288  74.0% 15239  991s
H  130   206                    14837.237270 25726.4288  73.4% 12274 1026s
H  161   206                    14881.603691 25726.4288  72.9% 10515 1026s
   205   284 23728.0580   10  473 14881.6037 25726.4288  72.9%  8924 1057s
   287   348 20672.6469   12   90 14881.6037 25726.4288  72.9%  7553 1087s
   358   377 23346.5485   11  423 14881.6037 25726.4288  72.9%  6838 1113s
   389   414 21369.1853   14  324 14881.6037 25726.4288  72.9%  6675 1147s
   433   449 18881.9832   13   84 14881.6037 25726.4288  72.9%  6401 1188s
   468   484 19481.7587   13  102 14881.6037 25726.4288  72.9%  6280 1210s
   509   519 18776.7421   14   80 14881.6037 25726.4288  72.9%  6112 1236s
   546   549 16644.6741   15   80 14881.6037 25726.4288  72.9%  5977 1259s
   586   593 15519.1903   16   96 14881.6037 25726.4288  72.9%  5899 1282s
   633   621 infeasible   14      14881.6037 25726.4288  72.9%  5742 1305s
   685   655 20973.3888   16  271 14881.6037 25726.4288  72.9%  5580 1329s
   731   683 19951.4869   17  234 14881.6037 25726.4288  72.9%  5574 1355s
   767   711 19065.1520   18  243 14881.6037 25726.4288  72.9%  5545 1380s
   811   748 17770.4589   19  220 14881.6037 25726.4288  72.9%  5520 1402s
   858   773 infeasible   20      14881.6037 25726.4288  72.9%  5477 1428s
   911   818 17423.0290   21  244 14881.6037 25726.4288  72.9%  5402 1447s
   968   863 17377.9486   22  241 14881.6037 25726.4288  72.9%  5300 1473s
  1025   897 17205.8864   23  285 14881.6037 25726.4288  72.9%  5205 1496s
  1069   939 17021.4769   24  224 14881.6037 25726.4288  72.9%  5128 1519s
  1131   993 16587.8019   25  228 14881.6037 25726.4288  72.9%  5043 1545s
  1209  1049 infeasible   26      14881.6037 25640.8328  72.3%  4893 1569s
  1308  1112 16176.6980   25  227 14881.6037 25640.2330  72.3%  4692 1595s
  1399  1142 infeasible   26      14881.6037 25640.2330  72.3%  4558 1627s
  1488  1181 17243.1947   32  331 14881.6037 25640.2330  72.3%  4463 1658s
  1555  1225 infeasible   21      14881.6037 25640.2330  72.3%  4393 1691s
  1637  1259 16622.6764   45  127 14881.6037 25640.2330  72.3%  4359 1731s
  1726  1316 16189.8167   46  134 14881.6037 25640.2330  72.3%  4281 1767s
  1822  1382 15662.3232   47  162 14881.6037 25640.2330  72.3%  4245 1803s
  1942  1465 15337.8755   48  128 14881.6037 25507.8321  71.4%  4175 1849s
  2083  1502 15067.0563   49  132 14881.6037 25507.8321  71.4%  4098 1886s
  2189  1556     cutoff   50      14881.6037 25507.8321  71.4%  4058 1927s
  2311  1614     cutoff   49      14881.6037 25507.8321  71.4%  4044 1967s
  2408  1680 15109.4665   50  144 14881.6037 25507.8321  71.4%  4059 2013s
  2522  1746 14974.2654   51   74 14881.6037 25507.8321  71.4%  4090 2063s
  2638  1827     cutoff   52      14881.6037 25507.8321  71.4%  4143 2112s
  2785  1888 14913.0932   51  137 14881.6037 24310.5085  63.4%  4128 2158s
  2910  1943 20600.7249    9  391 14881.6037 24310.5085  63.4%  4129 2210s
  3051  1986 19976.3231   12  379 14881.6037 24179.2013  62.5%  4145 2261s
  3159  2066 18793.2418   15  365 14881.6037 24068.4159  61.7%  4210 2318s
  3265  2159 17080.2258   22  349 14881.6037 24068.4159  61.7%  4295 2371s
  3433  2302 15968.9838   31  323 14881.6037 24068.4159  61.7%  4302 2428s
  3636  2425 infeasible   43      14881.6037 24046.4882  61.6%  4280 2487s
  3882  2533 20920.3377   14  455 14881.6037 24006.7957  61.3%  4227 2550s
  4100  2643 19404.9803   17  234 14881.6037 24006.7957  61.3%  4217 2620s
  4279  2644 20402.8627   16  414 14881.6037 23837.4207  60.2%  4260 2975s
  4281  2645 20334.9966   13  296 14881.6037 23837.4207  60.2%  4258 2991s
  4282  2646 17946.7069   17  414 14881.6037 23837.4207  60.2%  4257 3078s
  4283  2647 22810.3467   14  428 14881.6037 23837.4207  60.2%  4256 3149s
  4284  2647 17444.5178   28  467 14881.6037 23837.4207  60.2%  4255 3181s
  4285  2648 17990.6063   24  437 14881.6037 23837.4207  60.2%  4254 3200s
  4286  2649 20181.4931   27  460 14881.6037 23837.4207  60.2%  4253 3217s
  4287  2649 20346.4108   23  456 14881.6037 23837.4207  60.2%  4252 3234s
  4288  2650 22511.2755    6  466 14881.6037 23837.4207  60.2%  4251 3247s
  4289  2651 18186.9469   11  462 14881.6037 23837.4207  60.2%  4250 3257s
  4290  2651 18251.4688   27  457 14881.6037 23837.4207  60.2%  4249 3265s
  4291  2652 22131.3376   11  461 14881.6037 23837.4207  60.2%  4248 3275s
  4292  2653 17117.9371   38  475 14881.6037 23837.4207  60.2%  4247 3282s
  4293  2653 19517.3541   17  464 14881.6037 23837.4207  60.2%  4246 3287s
  4294  2654 20214.6872   26  500 14881.6037 23837.4207  60.2%  4245 3294s
  4295  2655 23147.0931   11  494 14881.6037 23837.4207  60.2%  4244 3317s
  4296  2655 19121.0324   29  467 14881.6037 23837.4207  60.2%  4243 3324s
  4297  2656 18928.7788   20  457 14881.6037 23837.4207  60.2%  4242 3331s
  4298  2657 15482.2513   58  450 14881.6037 23837.4207  60.2%  4241 3337s
  4299  2657 17889.5329   27  484 14881.6037 23837.4207  60.2%  4240 3350s
  4300  2658 22579.3850    7  460 14881.6037 23837.4207  60.2%  4239 3355s
  4301  2659 17033.8286   40  491 14881.6037 23837.4207  60.2%  4238 3363s
  4302  2659 17001.0798   28  491 14881.6037 23837.4207  60.2%  4237 3381s
  4303  2660 17204.9676   21  493 14881.6037 23837.4207  60.2%  4236 3387s
  4304  2661 21075.2956   20  492 14881.6037 23837.4207  60.2%  4235 3399s
  4305  2661 15710.0044   26  389 14881.6037 23837.4207  60.2%  4234 3408s
  4306  2662 17079.5947   27  505 14881.6037 23837.4207  60.2%  4233 3421s
  4307  2663 17058.2095   23  511 14881.6037 23837.4207  60.2%  4232 3428s
  4308  2663 18043.5178   23  501 14881.6037 23837.4207  60.2%  4231 3435s
  4310  2665 21063.9054    9  504 14881.6037 23837.4207  60.2%  4229 3448s
  4311  2665 22305.7863   11  508 14881.6037 23837.4207  60.2%  4228 3452s
  4312  2666 21586.5006   10  502 14881.6037 23837.4207  60.2%  4227 3461s
  4313  2667 21326.2595   14  502 14881.6037 23837.4207  60.2%  4226 3476s
  4314  2667 19513.1358   14  502 14881.6037 23837.4207  60.2%  4225 3573s

Cutting planes:
  Learned: 2
  Gomory: 2
  Implied bound: 9
  Projected implied bound: 107
  MIR: 724
  Mixing: 1
  Flow cover: 758
  RLT: 26
  Relax-and-lift: 106

Explored 4315 nodes (19181241 simplex iterations) in 3600.05 seconds (8207.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14881.6 14837.2 14786.9 ... 14012

Time limit reached
Best objective 1.488160369108e+04, best bound 2.383742073032e+04, gap 60.1805%
  WARNING: Time limit reached. Using best solution found (gap: 60.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 14881.60, θ = 162341.66
  Upper Bound (UB) = 14881.60

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 162341.66
  [DEBUG]   ✓ Scenario 0: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 162341.66 ≤ Q = 162341.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 162341.66 ≤ Q = 162341.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 162341.66 ≤ Q = 162341.66 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 162341.66 ≤ Q = 162341.66 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 162341.66 ≤ Q = 162341.66 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2b7cc6a5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd483395b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362059e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6978785.1213
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.418962e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141896.15    0  123 6978785.12 -141896.15   102%     -    0s
H    0     0                    -107212.8553 -141896.15  32.3%     -    0s
H    0     0                    -107389.8752 -141896.15  32.1%     -    0s
H    0     0                    -120624.9881 -122345.22  1.43%     -    0s
     0     0 -122345.22    0   64 -120624.99 -122345.22  1.43%     -    0s
H    0     0                    -121173.1238 -122277.65  0.91%     -    0s
     0     0 -121599.04    0   31 -121173.12 -121599.04  0.35%     -    0s
     0     0 -121457.61    0   31 -121173.12 -121457.61  0.23%     -    0s
     0     0 -121451.64    0   29 -121173.12 -121451.64  0.23%     -    0s
     0     0 -121436.68    0   29 -121173.12 -121436.68  0.22%     -    0s
     0     0 -121326.15    0   16 -121173.12 -121326.15  0.13%     -    0s
     0     0 -121326.15    0   26 -121173.12 -121326.15  0.13%     -    0s
     0     0 -121240.70    0   11 -121173.12 -121240.70  0.06%     -    0s
H    0     0                    -121177.1516 -121237.08  0.05%     -    0s
     0     0 -121234.98    0    8 -121177.15 -121234.98  0.05%     -    0s
     0     0 -121222.04    0    4 -121177.15 -121222.04  0.04%     -    0s
H    0     0                    -121221.8056 -121222.04  0.00%     -    0s
     0     0 -121221.95    0    4 -121221.81 -121221.95  0.00%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 6
  MIR: 10
  Flow cover: 10

Explored 1 nodes (737 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -121222 -121177 -121173 ... 1.36206e+13
No other solutions better than -121222

Optimal solution found (tolerance 1.00e-06)
Best objective -1.212218056430e+05, best bound -1.212218056430e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 151639.02
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121221.81
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -121221.81 = 151639.02
  [DEBUG]   Current θ from Master = 162341.66
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10702.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4178.96
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2291.8420, Absolute Gap = 2291.8420, Relative Gap = 0.154005
  Not converged yet (gap = 2291.84 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654164 nonzeros
Model fingerprint: 0xf50760e4
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 100090 rows and 40640 columns
Presolve time: 2.37s
Presolved: 130643 rows, 55220 columns, 804398 nonzeros
Variable types: 52961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339222.7835
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.36s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 5.828e+06
 Factor NZ  : 1.377e+07 (roughly 200 MB of memory)
 Factor Ops : 4.198e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.88871887e+07  2.21511496e+08  1.16e+05 1.62e+01  8.00e+04     4s
   1  -1.43949498e+07  1.99057393e+08  8.17e+04 5.91e+01  5.59e+04     4s
   2  -5.31636884e+06  1.47685910e+08  2.97e+04 2.03e+00  2.16e+04     4s
   3  -8.83952030e+05  1.07978897e+08  2.34e+03 1.76e+00  2.06e+03     4s
   4  -5.03252005e+05  4.65582914e+07  4.80e+02 4.27e-01  4.91e+02     4s
   5  -4.10588182e+05  3.03210153e+07  2.27e+02 2.43e-01  2.56e+02     5s
   6  -3.15471441e+05  2.35580028e+07  7.82e+01 1.76e-01  1.41e+02     5s
   7  -2.42851815e+05  1.74620169e+07  3.66e+01 1.23e-01  9.08e+01     5s
   8  -1.47579521e+05  1.08358693e+07  7.55e+00 7.29e-02  4.86e+01     5s
   9  -1.21451517e+05  7.69294401e+06  5.13e+00 5.05e-02  3.41e+01     5s
  10  -9.05201383e+04  3.37485431e+06  2.51e+00 2.11e-02  1.48e+01     5s
  11  -6.20131605e+04  7.34727273e+05  8.15e-01 4.23e-03  3.37e+00     5s
  12  -3.18530787e+04  3.13641915e+05  3.65e-01 3.51e-03  1.45e+00     5s
  13  -4.58844512e+03  1.97985830e+05  1.80e-01 2.46e-03  8.51e-01     5s
  14   1.43751911e+03  1.41810689e+05  1.49e-01 1.67e-03  5.90e-01     5s
  15   6.77889501e+03  1.17429960e+05  1.23e-01 1.29e-03  4.65e-01     5s
  16   1.20002191e+04  9.00211118e+04  1.02e-01 3.33e-03  3.28e-01     5s
  17   1.62490333e+04  8.13774064e+04  8.59e-02 3.06e-03  2.74e-01     5s
  18   2.05410755e+04  7.15560267e+04  6.95e-02 2.92e-03  2.15e-01     6s
  19   2.48356481e+04  6.08170518e+04  5.36e-02 2.53e-03  1.51e-01     6s
  20   2.85770390e+04  5.74147796e+04  4.10e-02 2.48e-03  1.21e-01     6s
  21   2.92961958e+04  5.15880141e+04  3.89e-02 1.60e-03  9.38e-02     6s
  22   3.20115644e+04  5.01793346e+04  3.05e-02 1.36e-03  7.65e-02     6s
  23   3.34626298e+04  4.85549643e+04  2.62e-02 1.06e-03  6.35e-02     6s
  24   3.51132288e+04  4.64311262e+04  2.11e-02 7.02e-04  4.76e-02     6s
  25   3.59696874e+04  4.56245117e+04  1.85e-02 5.56e-04  4.07e-02     6s
  26   3.74141883e+04  4.44980152e+04  1.43e-02 3.20e-04  2.98e-02     6s
  27   3.85021166e+04  4.38002367e+04  1.12e-02 2.02e-04  2.23e-02     7s
  28   3.89969752e+04  4.34427196e+04  9.73e-03 2.23e-04  1.87e-02     7s
  29   3.98044750e+04  4.31885753e+04  7.48e-03 1.54e-04  1.43e-02     7s
  30   4.00298007e+04  4.30821315e+04  6.83e-03 1.08e-04  1.29e-02     7s
  31   4.05927616e+04  4.30048341e+04  5.29e-03 8.69e-05  1.02e-02     7s
  32   4.09147676e+04  4.29816433e+04  4.41e-03 8.27e-05  8.71e-03     7s
  33   4.11216829e+04  4.29369330e+04  3.80e-03 7.54e-05  7.65e-03     7s
  34   4.13525960e+04  4.27693498e+04  3.17e-03 7.91e-05  5.97e-03     7s
  35   4.16597192e+04  4.26998310e+04  2.32e-03 6.53e-05  4.38e-03     7s
  36   4.17105747e+04  4.26664033e+04  2.18e-03 6.68e-05  4.03e-03     7s
  37   4.17873394e+04  4.25956649e+04  1.96e-03 6.44e-05  3.41e-03     8s
  38   4.19311066e+04  4.25751212e+04  1.55e-03 4.89e-05  2.71e-03     8s
  39   4.20492143e+04  4.25667664e+04  1.23e-03 4.27e-05  2.18e-03     8s
  40   4.20902605e+04  4.25605797e+04  1.12e-03 3.85e-05  1.98e-03     8s
  41   4.21179475e+04  4.25417046e+04  1.05e-03 1.96e-05  1.79e-03     8s
  42   4.21912779e+04  4.25275593e+04  8.47e-04 1.53e-05  1.42e-03     8s
  43   4.22372015e+04  4.25249236e+04  7.14e-04 1.36e-05  1.21e-03     8s
  44   4.22882974e+04  4.25238833e+04  5.73e-04 1.28e-05  9.93e-04     8s
  45   4.23067617e+04  4.25155942e+04  5.23e-04 8.50e-06  8.81e-04     8s
  46   4.23809748e+04  4.25126095e+04  3.15e-04 6.99e-06  5.55e-04     8s
  47   4.24066083e+04  4.25080216e+04  2.46e-04 4.44e-06  4.28e-04     9s
  48   4.24295499e+04  4.25058883e+04  1.85e-04 3.04e-06  3.22e-04     9s
  49   4.24451349e+04  4.25015432e+04  1.44e-04 9.76e-06  2.38e-04     9s
  50   4.24526580e+04  4.25014653e+04  1.23e-04 9.21e-06  2.06e-04     9s
  51   4.24565066e+04  4.25009234e+04  1.13e-04 7.13e-06  1.87e-04     9s
  52   4.24676599e+04  4.24999960e+04  8.21e-05 7.92e-06  1.36e-04     9s
  53   4.24790253e+04  4.24996643e+04  5.21e-05 5.30e-06  8.71e-05     9s
  54   4.24825947e+04  4.24995474e+04  4.30e-05 4.58e-06  7.15e-05     9s
  55   4.24948011e+04  4.24993302e+04  1.03e-05 2.06e-06  1.91e-05     9s
  56   4.24967018e+04  4.24991327e+04  5.46e-06 9.10e-07  1.03e-05    10s
  57   4.24982293e+04  4.24989918e+04  1.81e-06 9.39e-08  3.22e-06    10s
  58   4.24989746e+04  4.24989789e+04  1.54e-07 6.53e-09  1.80e-08    10s
  59   4.24989768e+04  4.24989781e+04  3.00e-07 4.06e-08  5.22e-09    10s
  60   4.24989779e+04  4.24989781e+04  1.33e-07 4.19e-08  7.53e-10    10s

Barrier solved model in 60 iterations and 9.85 seconds (14.33 work units)
Optimal objective 4.24989779e+04


Root crossover log...

  106856 DPushes remaining with DInf 0.0000000e+00                10s
   60093 DPushes remaining with DInf 0.0000000e+00                11s
   30913 DPushes remaining with DInf 0.0000000e+00                15s
     671 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

   11389 PPushes remaining with PInf 1.5564029e-04                21s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.8851063e+03     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   65259    4.2498978e+04   0.000000e+00   6.885106e+03     22s
   65481    4.2498978e+04   0.000000e+00   0.000000e+00     22s
   65481    4.2498978e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.249898e+04, 65481 iterations, 19.43 seconds (30.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42498.9781    0  378 -190754.47 42498.9781   122%     -   23s
H    0     0                    -186184.2792 42498.9781   123%     -   23s
H    0     0                    -56746.41516 42498.9781   175%     -   23s
H    0     0                    -55160.82399 42498.9781   177%     -   24s
H    0     0                    -53991.86336 42498.9781   179%     -   24s
H    0     0                    -47909.10619 42498.9781   189%     -   24s
H    0     0                    -8402.109035 42498.9781   606%     -   24s
H    0     0                    -8027.648585 42498.9781   629%     -   24s
H    0     0                    2703.4194647 42498.9781  1472%     -   28s
H    0     0                    4512.7549340 42498.9781   842%     -   28s
H    0     0                    4538.9927611 42498.9781   836%     -   28s
H    0     0                    4594.7172433 42498.9781   825%     -   28s
H    0     0                    4697.1113404 42498.9781   805%     -   28s
H    0     0                    4924.0910690 35040.9130   612%     -   73s
     0     0 34951.0529    0  309 4924.09107 34951.0529   610%     -   73s
H    0     0                    5106.0679101 34951.0529   585%     -   74s
H    0     0                    5124.8562782 34951.0529   582%     -   74s
H    0     0                    5304.4287822 34951.0529   559%     -   74s
H    0     0                    5514.4889353 34951.0529   534%     -   74s
     0     0 33906.8167    0  381 5514.48894 33906.8167   515%     -  100s
     0     0 33790.3917    0  388 5514.48894 33790.3917   513%     -  111s
     0     0 33749.5553    0  349 5514.48894 33749.5553   512%     -  117s
     0     0 33749.5553    0  359 5514.48894 33749.5553   512%     -  121s
     0     0 33686.5636    0  366 5514.48894 33686.5636   511%     -  125s
     0     0 33686.5636    0  389 5514.48894 33686.5636   511%     -  129s
     0     0 33657.1081    0  363 5514.48894 33657.1081   510%     -  139s
     0     0 33657.1081    0  358 5514.48894 33657.1081   510%     -  143s
     0     0 33582.3911    0  361 5514.48894 33582.3911   509%     -  147s
     0     0 33582.2816    0  365 5514.48894 33582.2816   509%     -  151s
     0     0 33582.2816    0  406 5514.48894 33582.2816   509%     -  157s
     0     0 33582.2816    0  405 5514.48894 33582.2816   509%     -  159s
     0     0 33582.2816    0  405 5514.48894 33582.2816   509%     -  160s
H    0     0                    5650.8972035 30834.8704   446%     -  209s
H    0     0                    5681.5868786 30834.8704   443%     -  209s
     0     0 30834.8704    0  392 5681.58688 30834.8704   443%     -  210s
H    0     0                    10173.271824 30834.5704   203%     -  210s
H    0     0                    10659.322265 30834.5704   189%     -  211s
     0     0 30402.5696    0  390 10659.3223 30402.5696   185%     -  237s
     0     0 30284.8707    0  392 10659.3223 30284.8707   184%     -  257s
     0     0 30203.9850    0  386 10659.3223 30203.9850   183%     -  271s
     0     0 30112.0413    0  394 10659.3223 30112.0413   182%     -  282s
     0     0 30084.6187    0  396 10659.3223 30084.6187   182%     -  289s
     0     0 29987.0236    0  391 10659.3223 29987.0236   181%     -  299s
     0     0 29908.6429    0  345 10659.3223 29908.6429   181%     -  310s
     0     0 29871.4461    0  347 10659.3223 29871.4461   180%     -  320s
     0     0 29808.1318    0  389 10659.3223 29808.1318   180%     -  330s
     0     0 29786.5081    0  388 10659.3223 29786.5081   179%     -  339s
     0     0 29765.1536    0  403 10659.3223 29765.1536   179%     -  346s
     0     0 29753.5053    0  416 10659.3223 29753.5053   179%     -  350s
     0     0 29751.0202    0  415 10659.3223 29751.0202   179%     -  355s
     0     0 29737.9850    0  405 10659.3223 29737.9850   179%     -  358s
     0     0 29735.9852    0  424 10659.3223 29735.9852   179%     -  360s
     0     0 29733.4545    0  369 10659.3223 29733.4545   179%     -  363s
     0     0 29732.8133    0  364 10659.3223 29732.8133   179%     -  364s
     0     0 28760.3456    0  437 10659.3223 28760.3456   170%     -  425s
     0     0 28514.4834    0  445 10659.3223 28514.4834   168%     -  450s
     0     0 28347.5178    0  449 10659.3223 28347.5178   166%     -  462s
     0     0 28285.9453    0  448 10659.3223 28285.9453   165%     -  473s
     0     0 28251.4591    0  459 10659.3223 28251.4591   165%     -  482s
     0     0 28220.2053    0  437 10659.3223 28220.2053   165%     -  486s
     0     0 28081.8696    0  435 10659.3223 28081.8696   163%     -  496s
H    0     0                    10680.618623 28064.8337   163%     -  503s
H    0     0                    11595.830484 28064.8337   142%     -  503s
H    0     0                    11761.838816 28064.8337   139%     -  503s
H    0     0                    11951.356434 28064.8337   135%     -  503s
     0     0 28064.8337    0  456 11951.3564 28064.8337   135%     -  503s
H    0     0                    12130.250679 28035.3742   131%     -  508s
     0     0 28035.3742    0  458 12130.2507 28035.3742   131%     -  508s
     0     0 28018.7638    0  471 12130.2507 28018.7638   131%     -  511s
     0     0 27995.8937    0  465 12130.2507 27995.8937   131%     -  517s
     0     0 27978.6903    0  459 12130.2507 27978.6903   131%     -  520s
     0     0 27959.0260    0  463 12130.2507 27959.0260   130%     -  523s
     0     0 27931.6360    0  466 12130.2507 27931.6360   130%     -  526s
H    0     0                    12199.220126 27916.8980   129%     -  530s
     0     0 27916.8980    0  466 12199.2201 27916.8980   129%     -  530s
     0     0 27901.5147    0  466 12199.2201 27901.5147   129%     -  533s
     0     0 27893.3354    0  474 12199.2201 27893.3354   129%     -  537s
     0     0 27891.7770    0  476 12199.2201 27891.7770   129%     -  538s
     0     0 27434.2386    0  482 12199.2201 27434.2386   125%     -  565s
     0     0 27295.9864    0  534 12199.2201 27295.9864   124%     -  578s
     0     0 27275.5667    0  507 12199.2201 27275.5667   124%     -  584s
H    0     0                    12427.338703 27258.0861   119%     -  589s
     0     0 27258.0861    0  476 12427.3387 27258.0861   119%     -  589s
H    0     0                    12942.186404 27245.3301   111%     -  592s
H    0     0                    13047.167378 27245.3301   109%     -  592s
     0     0 27245.3301    0  503 13047.1674 27245.3301   109%     -  592s
     0     0 27238.9064    0  540 13047.1674 27238.9064   109%     -  596s
     0     0 27235.1572    0  527 13047.1674 27235.1572   109%     -  599s
     0     0 27227.1226    0  510 13047.1674 27227.1226   109%     -  603s
     0     0 27219.2923    0  528 13047.1674 27219.2923   109%     -  607s
     0     0 27214.8260    0  528 13047.1674 27214.8260   109%     -  610s
     0     0 27213.2244    0  531 13047.1674 27213.2244   109%     -  612s
     0     0 27072.7993    0  476 13047.1674 27072.7993   107%     -  628s
     0     0 27019.5325    0  480 13047.1674 27019.5325   107%     -  639s
     0     0 26999.5063    0  486 13047.1674 26999.5063   107%     -  645s
     0     0 26994.4388    0  493 13047.1674 26994.4388   107%     -  648s
     0     0 26985.4312    0  483 13047.1674 26985.4312   107%     -  653s
     0     0 26984.0391    0  501 13047.1674 26984.0391   107%     -  655s
     0     0 26939.5966    0  489 13047.1674 26939.5966   106%     -  666s
H    0     0                    13150.574195 26939.5430   105%     -  677s
     0     0 26924.6942    0  477 13150.5742 26924.6942   105%     -  683s
     0     0 26916.2079    0  484 13150.5742 26916.2079   105%     -  687s
     0     0 26912.3437    0  486 13150.5742 26912.3437   105%     -  691s
     0     0 26907.8088    0  487 13150.5742 26907.8088   105%     -  694s
     0     0 26905.7742    0  482 13150.5742 26905.7742   105%     -  697s
     0     0 26883.6598    0  479 13150.5742 26883.6598   104%     -  706s
H    0     0                    13463.659172 26883.6282   100%     -  707s
H    0     0                    13487.822229 26883.6282  99.3%     -  707s
     0     0 26871.5711    0  494 13487.8222 26871.5711  99.2%     -  712s
     0     0 26868.1128    0  494 13487.8222 26868.1128  99.2%     -  715s
     0     0 26865.5187    0  489 13487.8222 26865.5187  99.2%     -  718s
     0     0 26862.9641    0  488 13487.8222 26862.9641  99.2%     -  721s
     0     0 26862.0027    0  484 13487.8222 26862.0027  99.2%     -  722s
     0     0 26847.9949    0  486 13487.8222 26847.9949  99.1%     -  731s
     0     0 26844.4485    0  481 13487.8222 26844.4485  99.0%     -  738s
     0     0 26843.4486    0  489 13487.8222 26843.4486  99.0%     -  738s
     0     0 26838.9033    0  481 13487.8222 26838.9033  99.0%     -  745s
     0     0 26834.8318    0  494 13487.8222 26834.8318  99.0%     -  749s
     0     0 26834.6270    0  492 13487.8222 26834.6270  99.0%     -  750s
     0     0 26825.9113    0  500 13487.8222 26825.9113  98.9%     -  756s
     0     0 26825.0709    0  497 13487.8222 26825.0709  98.9%     -  788s
     0     0 26822.8147    0  507 13487.8222 26822.8147  98.9%     -  793s
     0     0 26822.7885    0  507 13487.8222 26822.7885  98.9%     -  798s
H    0     0                    13691.931530 26822.3669  95.9%     -  966s
H    0     2                    13789.803586 26822.3669  94.5%     -  975s
     0     2 26822.3669    0  507 13789.8036 26822.3669  94.5%     -  975s
     1     3 26500.9070    1  467 13789.8036 26822.3669  94.5% 11994  989s
     2     4 26584.7826    1  506 13789.8036 26584.7826  92.8% 10640 1008s
     3     8 26070.1642    2  483 13789.8036 26584.6002  92.8% 12285 1030s
     7    16 25679.7603    3  494 13789.8036 26496.5824  92.1% 10465 1075s
    15    32 25592.7827    4  481 13789.8036 26381.4546  91.3% 15521 1106s
    31    48 24379.0267    5  524 13789.8036 26163.6567  89.7% 21308 1194s
H   47    80                    13981.634103 26163.6567  87.1% 26691 1231s
H   48    80                    14118.633799 26163.6567  85.3% 26504 1231s
H   65    80                    14279.638279 26163.6567  83.2% 22421 1231s
    79   145 22705.8846    7  336 14279.6383 26163.6567  83.2% 19223 1332s
   144   181 22636.9371    9  335 14279.6383 26163.6567  83.2% 14634 1371s
   180   262 22615.9370   10  408 14279.6383 26163.6567  83.2% 12444 1406s
   261   329 22577.1715   11  401 14279.6383 26163.6567  83.2%  9565 1442s
   340   378 22465.5684   14  331 14279.6383 26163.6567  83.2%  8332 1476s
   404   412 21868.7263   15  319 14279.6383 26163.6567  83.2%  7750 1508s
   459   424 21458.2559   12  436 14279.6383 26163.6567  83.2%  7503 1542s
   483   457 19838.3391   16  283 14279.6383 26163.6567  83.2%  7528 1575s
   520   492 16781.5695   18  138 14279.6383 26163.6567  83.2%  7448 1607s
   570   516     cutoff   21      14279.6383 26163.6567  83.2%  7346 1638s
   619   545 18107.5236   27  195 14279.6383 26163.6567  83.2%  7124 1667s
   670   595 infeasible   19      14279.6383 26163.6567  83.2%  6933 1698s
   738   652 17293.1073   33  212 14279.6383 26163.6567  83.2%  6615 1724s
   811   736 16833.0348   36  227 14279.6383 26163.6567  83.2%  6281 1745s
   928   805 16324.1241   42  151 14279.6383 26163.6567  83.2%  5725 1768s
  1040   817 16175.5282   45  145 14279.6383 26163.6567  83.2%  5308 1793s
  1153   832 18345.1667   18  389 14279.6383 26163.6567  83.2%  5031 1821s
  1231   856 18226.3988   19  383 14279.6383 26163.6567  83.2%  4892 1852s
  1310   892 infeasible   21      14279.6383 26163.6567  83.2%  4836 1882s
  1408   922 17688.8105   20  321 14279.6383 26163.6567  83.2%  4714 1926s
  1501   986 infeasible   22      14279.6383 26163.6567  83.2%  4621 1957s
  1623  1059 17194.6780   21  336 14279.6383 26163.6567  83.2%  4460 1988s
  1769  1157 15162.9507   21  133 14279.6383 26163.6567  83.2%  4291 2022s
  1926  1219 16137.2640   23  161 14279.6383 26163.6567  83.2%  4105 2054s
  2086  1240 15553.3085   27  149 14279.6383 26163.6567  83.2%  3990 2090s
  2219  1280 15539.6204   27  149 14279.6383 26163.6567  83.2%  3935 2127s
  2328  1340 21709.8361   10  291 14279.6383 26163.6567  83.2%  3946 2169s
  2436  1400 19607.8419   10  257 14279.6383 26163.6567  83.2%  3944 2213s
  2557  1472 18239.2467   12  315 14279.6383 26163.6567  83.2%  3911 2256s
  2668  1518 17295.3479   14  261 14279.6383 26163.6567  83.2%  3921 2300s
  2794  1554 15601.5045   16  213 14279.6383 26163.6567  83.2%  3921 2348s
  2899  1624 infeasible   19      14279.6383 26163.6567  83.2%  3959 2395s
  3029  1773 20221.8456   13  399 14279.6383 26163.6567  83.2%  3983 2439s
  3227  1856 17951.4115   15  269 14279.6383 26163.6567  83.2%  3933 2483s
  3431  1883 infeasible   19      14279.6383 26163.6567  83.2%  3875 2533s
  3559  1943 14792.6634   19  291 14279.6383 26163.6567  83.2%  3879 2592s
  3682  2052     cutoff   20      14279.6383 25880.8770  81.2%  3905 2650s
  3838  2175 22270.4440    8  415 14279.6383 25880.7707  81.2%  3930 2706s
  4021  2297 21605.0497   10  354 14279.6383 25880.7707  81.2%  3946 2777s
  4203  2298 14404.5418   17  507 14279.6383 25571.2757  79.1%  3960 3118s
  4205  2299 15021.9412   50  296 14279.6383 25571.2757  79.1%  3958 3132s
  4206  2300 14620.8970   52  414 14279.6383 25571.2757  79.1%  3957 3223s
  4207  2301 21907.9142   15  459 14279.6383 25571.2757  79.1%  3956 3289s
  4208  2301 16507.5026   35  471 14279.6383 25571.2757  79.1%  3955 3330s
  4209  2302 15896.4153   33  448 14279.6383 25571.2757  79.1%  3954 3353s
  4210  2303 19885.1052   17  506 14279.6383 25571.2757  79.1%  3953 3375s
  4211  2303 22709.4191    9  486 14279.6383 25571.2757  79.1%  3952 3396s
  4212  2304 15411.6539   57  473 14279.6383 25571.2757  79.1%  3951 3413s
  4213  2305 15551.9641   31  470 14279.6383 25571.2757  79.1%  3950 3425s
  4214  2305 21140.9420   13  481 14279.6383 25571.2757  79.1%  3949 3438s
  4215  2306 18900.4780   16  489 14279.6383 25571.2757  79.1%  3948 3445s
  4216  2307 20776.2925   25  492 14279.6383 25571.2757  79.1%  3947 3452s
  4217  2307 21410.4131   13  497 14279.6383 25571.2757  79.1%  3946 3456s
  4218  2308 14744.9667   29  501 14279.6383 25571.2757  79.1%  3946 3466s
  4219  2309 17663.8076   21  490 14279.6383 25571.2757  79.1%  3945 3484s
  4220  2309 14627.0772   36  408 14279.6383 25571.2757  79.1%  3944 3490s
  4221  2310 17925.7857   17  474 14279.6383 25571.2757  79.1%  3943 3497s
  4222  2311 14571.9160   51  461 14279.6383 25571.2757  79.1%  3942 3504s
  4223  2311 21464.2235   12  472 14279.6383 25571.2757  79.1%  3941 3508s
  4224  2312 15990.2403   53  466 14279.6383 25571.2757  79.1%  3940 3512s
  4225  2313 14589.2054   28  477 14279.6383 25571.2757  79.1%  3939 3518s
  4226  2313 14808.8285   29  481 14279.6383 25571.2757  79.1%  3938 3535s
  4227  2314 15430.6885   55  475 14279.6383 25571.2757  79.1%  3937 3540s
  4229  2315 15685.6035   18  487 14279.6383 25571.2757  79.1%  3935 3550s
  4230  2316 16867.2902   20  502 14279.6383 25571.2757  79.1%  3934 3569s
  4231  2317 15401.8795   29  509 14279.6383 25571.2757  79.1%  3933 3577s
  4232  2317 19958.5616   17  505 14279.6383 25571.2757  79.1%  3932 3583s
  4233  2318 16231.3336   48  549 14279.6383 25571.2757  79.1%  3932 3599s

Cutting planes:
  Implied bound: 11
  Projected implied bound: 136
  MIR: 1116
  Flow cover: 1028
  RLT: 29
  Relax-and-lift: 178

Explored 4233 nodes (17608854 simplex iterations) in 3600.04 seconds (7588.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14279.6 14118.6 13981.6 ... 12942.2

Time limit reached
Best objective 1.427963827924e+04, best bound 2.557127574380e+04, gap 79.0751%
  WARNING: Time limit reached. Using best solution found (gap: 79.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 14279.64, θ = 162373.55
  Upper Bound (UB) = 14279.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 162373.55
  [DEBUG]   ✓ Scenario 0: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 162373.55 ≤ Q = 162373.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 162373.55 ≤ Q = 162373.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 162373.55 ≤ Q = 162373.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 162373.55 ≤ Q = 162373.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 162373.55 ≤ Q = 162373.55 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 162373.55 ≤ Q = 162373.55 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 162373.55 ≤ Q = 162373.55 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4379588f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbc86a771
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.336636e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6815837.8915
Variable types: 346 continuous, 166 integer (166 binary)

Root relaxation: objective -1.427473e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142747.33    0  128 6815837.89 -142747.33   102%     -    0s
H    0     0                    -102332.8878 -142747.33  39.5%     -    0s
H    0     0                    -111162.2995 -142747.33  28.4%     -    0s
H    0     0                    -111554.4273 -142747.33  28.0%     -    0s
     0     0 -121000.96    0   62 -111554.43 -121000.96  8.47%     -    0s
H    0     0                    -120642.7298 -120995.41  0.29%     -    0s
     0     0 -120735.87    0   39 -120642.73 -120735.87  0.08%     -    0s
     0     0 -120734.47    0   39 -120642.73 -120734.47  0.08%     -    0s
     0     0 -120699.83    0    4 -120642.73 -120699.83  0.05%     -    0s
     0     0 -120699.83    0   31 -120642.73 -120699.83  0.05%     -    0s
H    0     0                    -120664.9242 -120699.83  0.03%     -    0s
     0     0 -120686.57    0    2 -120664.92 -120686.57  0.02%     -    0s
H    0     0                    -120677.1844 -120686.33  0.01%     -    0s
H    0     0                    -120686.3328 -120686.33  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 25
  Flow cover: 8
  RLT: 1

Explored 1 nodes (574 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -120686 -120677 -120665 ... 1.33664e+13
No other solutions better than -120686

Optimal solution found (tolerance 1.00e-06)
Best objective -1.206863327712e+05, best bound -1.206863327712e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 152174.49
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120686.33
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -120686.33 = 152174.49
  [DEBUG]   Current θ from Master = 162373.55
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10199.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4080.58
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 1689.8766, Absolute Gap = 1689.8766, Relative Gap = 0.118342
  Not converged yet (gap = 1689.88 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697407 nonzeros
Model fingerprint: 0xe9f32a0f
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106746 rows and 43341 columns
Presolve time: 2.51s
Presolved: 139277 rows, 58759 columns, 857626 nonzeros
Variable types: 56500 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339664.2147
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.21s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 6.538e+06
 Factor NZ  : 1.454e+07 (roughly 200 MB of memory)
 Factor Ops : 3.244e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.94258396e+07  2.33935252e+08  1.19e+05 1.57e+01  8.18e+04     5s
   1  -1.48655126e+07  2.10923209e+08  8.43e+04 5.85e+01  5.73e+04     5s
   2  -5.50754692e+06  1.56492436e+08  3.08e+04 3.94e+00  2.22e+04     5s
   3  -8.88169200e+05  1.15038314e+08  2.39e+03 1.50e+00  2.09e+03     5s
   4  -5.00540787e+05  6.30601273e+07  5.08e+02 5.54e-01  5.68e+02     5s
   5  -4.27452147e+05  3.91511666e+07  2.61e+02 2.88e-01  3.04e+02     5s
   6  -3.48245123e+05  2.92176310e+07  9.64e+01 1.98e-01  1.67e+02     5s
   7  -2.77558608e+05  2.19687092e+07  3.75e+01 1.40e-01  1.05e+02     6s
   8  -1.59309628e+05  1.70825394e+07  3.32e+00 1.06e-01  6.92e+01     6s
   9  -1.31868940e+05  7.69970389e+06  2.27e+00 4.67e-02  3.12e+01     6s
  10  -9.19573566e+04  3.41760452e+06  9.32e-01 2.01e-02  1.39e+01     6s
  11  -6.45235048e+04  9.94906222e+05  4.25e-01 5.55e-03  4.18e+00     6s
  12  -2.15385653e+04  2.92713937e+05  1.00e-01 1.38e-03  1.24e+00     6s
  13  -1.57234749e+03  2.01061587e+05  5.83e-02 1.14e-03  7.98e-01     6s
  14   5.52089080e+03  1.41760326e+05  4.59e-02 1.11e-03  5.36e-01     6s
  15   1.17126978e+04  1.18923476e+05  3.62e-02 1.29e-03  4.22e-01     6s
  16   1.69207369e+04  9.69832614e+04  2.86e-02 1.18e-03  3.15e-01     6s
  17   2.13955468e+04  8.04531028e+04  2.23e-02 9.74e-04  2.32e-01     6s
  18   2.60754855e+04  6.97526588e+04  1.63e-02 7.09e-04  1.72e-01     6s
  19   2.93325402e+04  6.16622885e+04  1.24e-02 5.21e-04  1.27e-01     7s
  20   3.13564344e+04  5.63798652e+04  1.03e-02 3.79e-04  9.85e-02     7s
  21   3.43750179e+04  5.10728837e+04  7.27e-03 2.32e-04  6.57e-02     7s
  22   3.57243496e+04  4.95036098e+04  5.90e-03 1.91e-04  5.43e-02     7s
  23   3.69493943e+04  4.74252187e+04  4.79e-03 1.45e-04  4.12e-02     7s
  24   3.83492137e+04  4.55385990e+04  3.51e-03 1.30e-04  2.83e-02     7s
  25   3.89782695e+04  4.47633684e+04  2.97e-03 9.54e-05  2.28e-02     7s
  26   3.98298472e+04  4.39095134e+04  2.23e-03 5.76e-05  1.61e-02     7s
  27   3.99085242e+04  4.36459366e+04  2.16e-03 9.59e-05  1.47e-02     7s
  28   4.06862299e+04  4.32486868e+04  1.50e-03 9.73e-05  1.01e-02     8s
  29   4.07964807e+04  4.31790941e+04  1.40e-03 8.77e-05  9.38e-03     8s
  30   4.11570862e+04  4.30418589e+04  1.10e-03 6.85e-05  7.42e-03     8s
  31   4.12403529e+04  4.29178541e+04  1.03e-03 6.27e-05  6.61e-03     8s
  32   4.16525711e+04  4.28768670e+04  6.92e-04 5.61e-05  4.82e-03     8s
  33   4.20049336e+04  4.27945727e+04  3.98e-04 4.29e-05  3.11e-03     8s
  34   4.23010121e+04  4.27291091e+04  1.46e-04 3.20e-05  1.69e-03     8s
  35   4.23500858e+04  4.26846051e+04  1.12e-04 2.52e-05  1.32e-03     8s
  36   4.23626584e+04  4.26539616e+04  1.03e-04 2.06e-05  1.15e-03     9s
  37   4.24209720e+04  4.26390135e+04  6.39e-05 1.83e-05  8.58e-04     9s
  38   4.24601831e+04  4.25776334e+04  3.74e-05 9.00e-06  4.62e-04     9s
  39   4.24799468e+04  4.25603753e+04  2.36e-05 6.40e-06  3.17e-04     9s
  40   4.24965735e+04  4.25347075e+04  1.24e-05 2.65e-06  1.50e-04     9s
  41   4.25130125e+04  4.25199671e+04  1.68e-06 4.70e-07  2.74e-05     9s
  42   4.25160333e+04  4.25177426e+04  3.23e-07 1.85e-07  6.73e-06     9s
  43   4.25164837e+04  4.25169030e+04  1.24e-07 2.31e-08  1.65e-06     9s
  44   4.25166596e+04  4.25167722e+04  4.66e-08 1.01e-07  4.44e-07     9s
  45   4.25166956e+04  4.25167713e+04  2.46e-06 7.08e-08  2.99e-07     9s
  46   4.25167682e+04  4.25167690e+04  2.59e-08 1.07e-09  3.05e-09    10s
  47   4.25167685e+04  4.25167690e+04  4.72e-07 6.51e-10  2.12e-09    10s
  48   4.25167689e+04  4.25167690e+04  1.84e-06 1.07e-09  4.98e-10    10s

Barrier solved model in 48 iterations and 9.76 seconds (14.34 work units)
Optimal objective 4.25167689e+04


Root crossover log...

  114973 DPushes remaining with DInf 0.0000000e+00                10s
   62367 DPushes remaining with DInf 0.0000000e+00                12s
   39468 DPushes remaining with DInf 0.0000000e+00                15s
    3551 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

    8854 PPushes remaining with PInf 5.3044379e-05                22s
       0 PPushes remaining with PInf 0.0000000e+00                23s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.4051898e+01     23s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63348    4.2516769e+04   0.000000e+00   3.405190e+01     23s
   63379    4.2516769e+04   0.000000e+00   0.000000e+00     24s
   63379    4.2516769e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.251677e+04, 63379 iterations, 20.54 seconds (31.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42516.7690    0  367 -190754.47 42516.7690   122%     -   24s
H    0     0                    -183309.8528 42516.7690   123%     -   24s
H    0     0                    -90383.86596 42516.7690   147%     -   25s
H    0     0                    -89826.50648 42516.7690   147%     -   25s
H    0     0                    -47770.39372 42516.7690   189%     -   25s
H    0     0                    -9736.265815 42516.7690   537%     -   25s
H    0     0                    -7902.288131 42516.7690   638%     -   26s
     0     0 35488.8717    0  366 -7902.2881 35488.8717   549%     -   84s
H    0     0                    -6701.913912 35486.3212   629%     -   85s
H    0     0                    -5632.030678 35486.3212   730%     -   85s
H    0     0                    -1349.324455 35486.3212  2730%     -   85s
H    0     0                    -1108.590989 35486.3212  3301%     -   85s
H    0     0                    -1054.243066 35486.3212  3466%     -   85s
H    0     0                    -1021.569813 35486.3212  3574%     -   85s
     0     0 34968.5801    0  372 -1021.5698 34968.5801  3523%     -  118s
     0     0 34955.3314    0  370 -1021.5698 34955.3314  3522%     -  130s
     0     0 34918.5656    0  379 -1021.5698 34918.5656  3518%     -  140s
     0     0 34818.9557    0  374 -1021.5698 34818.9557  3508%     -  151s
     0     0 34794.0960    0  379 -1021.5698 34794.0960  3506%     -  156s
     0     0 34756.9824    0  376 -1021.5698 34756.9824  3502%     -  163s
     0     0 34745.9471    0  369 -1021.5698 34745.9471  3501%     -  166s
     0     0 34667.3084    0  385 -1021.5698 34667.3084  3494%     -  172s
     0     0 34448.2507    0  371 -1021.5698 34448.2507  3472%     -  187s
     0     0 34438.1043    0  370 -1021.5698 34438.1043  3471%     -  192s
     0     0 34436.1693    0  395 -1021.5698 34436.1693  3471%     -  194s
     0     0 34409.7130    0  393 -1021.5698 34409.7130  3468%     -  198s
     0     0 34392.8856    0  366 -1021.5698 34392.8856  3467%     -  203s
     0     0 34391.0118    0  354 -1021.5698 34391.0118  3466%     -  204s
     0     0 34364.9009    0  360 -1021.5698 34364.9009  3464%     -  207s
     0     0 34363.9178    0  356 -1021.5698 34363.9178  3464%     -  208s
     0     0 34359.6014    0  359 -1021.5698 34359.6014  3463%     -  210s
     0     0 34356.5285    0  384 -1021.5698 34356.5285  3463%     -  213s
     0     0 34356.2764    0  387 -1021.5698 34356.2764  3463%     -  214s
     0     0 31055.4747    0  414 -1021.5698 31055.4747  3140%     -  274s
H    0     0                    7872.5852183 31055.4737   294%     -  275s
H    0     0                    8141.4390634 31055.4737   281%     -  275s
     0     0 30523.9389    0  443 8141.43906 30523.9389   275%     -  301s
     0     0 30427.2086    0  430 8141.43906 30427.2086   274%     -  315s
     0     0 30312.6628    0  444 8141.43906 30312.6628   272%     -  330s
     0     0 30251.9363    0  439 8141.43906 30251.9363   272%     -  340s
     0     0 30245.8257    0  444 8141.43906 30245.8257   272%     -  346s
     0     0 30234.8840    0  444 8141.43906 30234.8840   271%     -  351s
     0     0 30229.8892    0  448 8141.43906 30229.8892   271%     -  356s
     0     0 30229.7546    0  448 8141.43906 30229.7546   271%     -  357s
     0     0 28676.7406    0  527 8141.43906 28676.7406   252%     -  432s
H    0     0                    9566.4335019 28676.7331   200%     -  433s
H    0     0                    9642.5631895 28676.7331   197%     -  433s
H    0     0                    9649.7636510 28676.7331   197%     -  433s
H    0     0                    9934.0514653 28676.7331   189%     -  433s
H    0     0                    9941.6513310 28676.7331   188%     -  433s
H    0     0                    9946.2445450 28676.7331   188%     -  433s
     0     0 28374.1942    0  447 9946.24454 28374.1942   185%     -  453s
     0     0 28313.1363    0  469 9946.24454 28313.1363   185%     -  463s
     0     0 28273.4697    0  471 9946.24454 28273.4697   184%     -  473s
     0     0 28245.2223    0  478 9946.24454 28245.2223   184%     -  479s
     0     0 28239.9801    0  485 9946.24454 28239.9801   184%     -  483s
     0     0 28222.8105    0  500 9946.24454 28222.8105   184%     -  489s
     0     0 28206.1718    0  497 9946.24454 28206.1718   184%     -  494s
     0     0 28196.8116    0  497 9946.24454 28196.8116   183%     -  500s
     0     0 28150.7716    0  491 9946.24454 28150.7716   183%     -  507s
     0     0 28140.9041    0  480 9946.24454 28140.9041   183%     -  512s
     0     0 28135.0743    0  488 9946.24454 28135.0743   183%     -  516s
     0     0 28134.0996    0  492 9946.24454 28134.0996   183%     -  519s
     0     0 27355.5096    0  463 9946.24454 27355.5096   175%     -  559s
H    0     0                    10082.313260 27355.2478   171%     -  561s
H    0     0                    10153.181713 27355.2478   169%     -  561s
     0     0 27249.1048    0  481 10153.1817 27249.1048   168%     -  579s
     0     0 27214.7016    0  487 10153.1817 27214.7016   168%     -  586s
     0     0 27182.9408    0  488 10153.1817 27182.9408   168%     -  597s
     0     0 27149.7164    0  494 10153.1817 27149.7164   167%     -  609s
     0     0 27133.5221    0  481 10153.1817 27133.5221   167%     -  618s
     0     0 27128.6073    0  481 10153.1817 27128.6073   167%     -  621s
     0     0 27123.1029    0  478 10153.1817 27123.1029   167%     -  625s
     0     0 27107.9640    0  472 10153.1817 27107.9640   167%     -  631s
     0     0 27103.5086    0  470 10153.1817 27103.5086   167%     -  634s
     0     0 27095.5740    0  469 10153.1817 27095.5740   167%     -  637s
     0     0 27093.4653    0  468 10153.1817 27093.4653   167%     -  640s
     0     0 26866.1118    0  463 10153.1817 26866.1118   165%     -  658s
H    0     0                    10276.583153 26866.0488   161%     -  659s
H    0     0                    10300.746210 26866.0488   161%     -  659s
     0     0 26839.6680    0  473 10300.7462 26839.6680   161%     -  667s
     0     0 26821.9217    0  463 10300.7462 26821.9217   160%     -  672s
     0     0 26813.6664    0  470 10300.7462 26813.6664   160%     -  676s
     0     0 26808.2186    0  463 10300.7462 26808.2186   160%     -  679s
     0     0 26806.4879    0  477 10300.7462 26806.4879   160%     -  680s
     0     0 26718.2646    0  468 10300.7462 26718.2646   159%     -  698s
H    0     0                    10541.972733 26718.0785   153%     -  708s
H    0     0                    10546.565947 26718.0785   153%     -  712s
H    0     0                    10996.558025 26718.0785   143%     -  712s
H    0     0                    11146.791381 26718.0785   140%     -  714s
H    0     0                    11147.588622 26718.0785   140%     -  714s
H    0     0                    11163.577640 26718.0785   139%     -  714s
     0     0 26683.4259    0  466 11163.5776 26683.4259   139%     -  722s
     0     0 26666.2556    0  474 11163.5776 26666.2556   139%     -  727s
     0     0 26648.8534    0  472 11163.5776 26648.8534   139%     -  733s
     0     0 26644.1222    0  485 11163.5776 26644.1222   139%     -  736s
     0     0 26642.0284    0  496 11163.5776 26642.0284   139%     -  738s
     0     0 26618.7959    0  475 11163.5776 26618.7959   138%     -  750s
H    0     0                    11617.649664 26618.1448   129%     -  751s
H    0     0                    11800.677500 26618.1448   126%     -  751s
     0     0 26611.6226    0  469 11800.6775 26611.6226   126%     -  756s
     0     0 26606.3500    0  489 11800.6775 26606.3500   125%     -  761s
     0     0 26601.9068    0  476 11800.6775 26601.9068   125%     -  763s
     0     0 26600.9446    0  489 11800.6775 26600.9446   125%     -  764s
     0     0 26572.0875    0  525 11800.6775 26572.0875   125%     -  775s
H    0     0                    11808.623269 26569.9665   125%     -  779s
H    0     0                    11832.200974 26569.9665   125%     -  779s
H    0     0                    11873.656035 26569.9665   124%     -  780s
H    0     0                    11890.626811 26569.9665   123%     -  780s
     0     0 26568.9661    0  524 11890.6268 26568.9661   123%     -  784s
     0     0 26563.9141    0  521 11890.6268 26563.9141   123%     -  787s
     0     0 26563.4954    0  518 11890.6268 26563.4954   123%     -  789s
     0     0 26556.7912    0  485 11890.6268 26556.7912   123%     -  796s
     0     0 26555.2638    0  478 11890.6268 26555.2638   123%     -  799s
     0     0 26547.9502    0  477 11890.6268 26547.9502   123%     -  803s
H    0     0                    11897.065692 26547.8839   123%     -  805s
     0     0 26544.9943    0  475 11897.0657 26544.9943   123%     -  809s
     0     0 26544.6524    0  514 11897.0657 26544.6524   123%     -  810s
     0     0 26542.4679    0  515 11897.0657 26542.4679   123%     -  815s
     0     0 26542.3361    0  515 11897.0657 26542.3361   123%     -  821s
H    0     0                    11985.537551 26540.3124   121%     -  905s
H    0     0                    12506.636297 26540.3124   112%     - 1008s
H    0     0                    12582.356987 26540.3124   111%     - 1008s
H    0     2                    12631.981359 26540.3124   110%     - 1012s
     0     2 26540.3124    0  515 12631.9814 26540.3124   110%     - 1012s
     1     3 26181.0459    1  425 12631.9814 26540.3124   110% 10465 1023s
     2     4 26269.9969    1  518 12631.9814 26269.9969   108% 13552 1041s
     3     7 25695.9497    2  430 12631.9814 26269.8594   108% 10555 1059s
     6    12 25335.4658    3  481 12631.9814 26269.8346   108% 10729 1126s
    11    24 23714.0314    4  371 12631.9814 25967.9975   106% 17247 1162s
    23    36 25170.8245    5  563 12631.9814 25738.2437   104% 20994 1229s
    35    67 23537.8235    6  541 12631.9814 25738.2437   104% 21781 1381s
    66   123 22770.8244    7  439 12631.9814 25148.4173  99.1% 25299 1435s
H   77   123                    13564.323818 25148.4173  85.4% 23966 1435s
   122   232 22740.0495    8  433 13564.3238 25113.3543  85.1% 19377 1493s
   231   353 22146.3132   10  466 13564.3238 25113.3543  85.1% 13014 1523s
   352   397 22099.4236   12  468 13564.3238 25113.3543  85.1%  9988 1545s
H  357   397                    14103.697612 25113.3543  78.1%  9875 1545s
   398   458 22050.6114   14  449 14103.6976 25113.3543  78.1%  9327 1571s
   471   518 21619.1743   17  429 14103.6976 25113.3543  78.1%  8786 1595s
H  480   518                    14153.764912 25113.3543  77.4%  8681 1595s
H  488   518                    14249.798621 25113.3543  76.2%  8644 1595s
H  515   518                    14254.980000 25113.3543  76.2%  8630 1595s
   535   579 20929.5477   19  398 14254.9800 25113.3543  76.2%  8558 1616s
   596   634 20886.8580   20  406 14254.9800 25113.3543  76.2%  8260 1637s
H  607   634                    14340.073818 25113.3543  75.1%  8184 1637s
H  631   634                    14588.853964 25113.3543  72.1%  8153 1637s
   661   659 20623.8614   25  422 14588.8540 25113.3543  72.1%  8058 1681s
   696   689 19529.1444   26  209 14588.8540 25113.3543  72.1%  7973 1702s
H  707   689                    14727.847187 25113.3543  70.5%  7968 1702s
   734   717     cutoff   27      14727.8472 25113.3543  70.5%  8025 1724s
   788   744 19138.5989   27  336 14727.8472 25113.3543  70.5%  8087 1745s
   826   786 18958.8351   28  326 14727.8472 25113.3543  70.5%  8220 1766s
   888   812 18626.3957   29  332 14727.8472 25113.3543  70.5%  8155 1787s
   938   849 17220.6803   30  320 14727.8472 25113.3543  70.5%  8093 1810s
  1002   865 17065.3073   32  280 14727.8472 25113.3543  70.5%  8067 1832s
  1057   889 16310.3355   33  223 14727.8472 24801.6828  68.4%  8009 1856s
  1123   940 15595.9908   35  280 14727.8472 24801.6828  68.4%  7957 1882s
H 1148   940                    14772.351898 24801.6828  67.9%  7905 1882s
  1204  1018 infeasible   38      14772.3519 24801.6828  67.9%  7817 1909s
  1332  1069     cutoff   44      14772.3519 24801.6828  67.9%  7586 1940s
  1449  1137 16652.4675   16  240 14772.3519 24801.6828  67.9%  7485 1971s
  1565  1172 16074.0375   30  371 14772.3519 24801.6828  67.9%  7317 2003s
  1672  1228 15737.6405   32  330 14772.3519 24801.6828  67.9%  7206 2035s
  1764  1281 14874.3204   41  210 14772.3519 24801.6828  67.9%  7233 2066s
  1848  1350 19882.5288   15  263 14772.3519 24801.6828  67.9%  7353 2104s
  1946  1426 22327.9581   12  287 14772.3519 24801.6828  67.9%  7468 2136s
  2039  1472 22266.2880   13  407 14772.3519 24801.6828  67.9%  7475 2169s
  2133  1509 21329.7740   15  375 14772.3519 24801.6828  67.9%  7551 2206s
  2192  1599 21264.6349   16  333 14772.3519 24801.6828  67.9%  7621 2278s
  2316  1652 21212.1861   17  223 14772.3519 24801.6828  67.9%  7652 2317s
  2467  1717 20856.5953   18  290 14772.3519 24801.6828  67.9%  7644 2361s
  2612  1753 20510.2945   20  160 14772.3519 24801.6828  67.9%  7689 2401s
  2747  1826 18474.4112   24  267 14772.3519 24801.6828  67.9%  7733 2444s
  2858  1915 17086.4361   32  279 14772.3519 24801.6828  67.9%  7854 2486s
  3006  1962 22897.1128   12  451 14772.3519 24801.6828  67.9%  7930 2538s
  3113  2051 21563.5885   13  341 14772.3519 24299.4398  64.5%  7889 2590s
  3270  2122 21069.0739   16  339 14772.3519 24299.4398  64.5%  7908 2643s
  3421  2162 19724.9722   20  257 14772.3519 24299.4398  64.5%  7970 2702s
  3514  2240 19564.9368   21  243 14772.3519 23979.1248  62.3%  8030 2752s
  3650  2293 18799.9416   23  314 14772.3519 23701.0335  60.4%  8039 2813s
  3764  2363 18098.0232   28  229 14772.3519 23701.0335  60.4%  8122 2871s
  3898  2441 16580.4071   34  364 14772.3519 23701.0335  60.4%  8200 2940s
  4037  2491 15642.0047   47  315 14772.3519 23551.5320  59.4%  8300 3012s
  4169  2563 16151.5410   28  317 14772.3519 23551.5320  59.4%  8410 3078s
  4345  2626 infeasible   31      14772.3519 23491.4846  59.0%  8500 3150s
  4526  2731 20459.6964   12  216 14772.3519 23409.4032  58.5%  8607 3223s
  4793  2813 16309.0090   15  135 14772.3519 23409.4032  58.5%  8575 3303s

Cutting planes:
  Learned: 2
  Gomory: 1
  Implied bound: 209
  MIR: 3313
  Flow cover: 3384
  RLT: 109
  Relax-and-lift: 719

Explored 4949 nodes (43859228 simplex iterations) in 3600.11 seconds (8118.39 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14772.4 14727.8 14588.9 ... 12632

Time limit reached
Best objective 1.477235189829e+04, best bound 2.340650647426e+04, gap 58.4481%
  WARNING: Time limit reached. Using best solution found (gap: 58.45%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 14772.35, θ = 157370.54
  Upper Bound (UB) = 14772.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157370.54
  [DEBUG]   ✓ Scenario 0: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157370.54 ≤ Q = 157370.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157370.54 ≤ Q = 157370.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157370.54 ≤ Q = 157370.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 157370.54 ≤ Q = 157370.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 157370.54 ≤ Q = 157370.54 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x71b2f0bf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8e4d0f41
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.325511e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.01s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6591677.5411
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.476482e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147648.17    0  122 6591677.54 -147648.17   102%     -    0s
H    0     0                    -101546.4994 -147648.17  45.4%     -    0s
H    0     0                    -110872.8997 -147648.17  33.2%     -    0s
H    0     0                    -111607.3507 -147648.17  32.3%     -    0s
H    0     0                    -118711.4574 -121364.74  2.24%     -    0s
     0     0 -121364.74    0   77 -118711.46 -121364.74  2.24%     -    0s
H    0     0                    -118963.7066 -121281.05  1.95%     -    0s
H    0     0                    -119530.7784 -121281.05  1.46%     -    0s
H    0     0                    -119783.0277 -121281.05  1.25%     -    0s
     0     0 -120489.33    0   78 -119783.03 -120489.33  0.59%     -    0s
     0     0 -120452.73    0   77 -119783.03 -120452.73  0.56%     -    0s
     0     0 -120210.41    0   54 -119783.03 -120210.41  0.36%     -    0s
     0     0 -120162.09    0   58 -119783.03 -120162.09  0.32%     -    0s
     0     0 -120156.06    0   57 -119783.03 -120156.06  0.31%     -    0s
     0     0 -120150.35    0   45 -119783.03 -120150.35  0.31%     -    0s
     0     0 -120109.03    0   43 -119783.03 -120109.03  0.27%     -    0s
     0     0 -120080.56    0   41 -119783.03 -120080.56  0.25%     -    0s
     0     0 -120061.86    0   42 -119783.03 -120061.86  0.23%     -    0s
     0     0 -120040.38    0   42 -119783.03 -120040.38  0.21%     -    0s
H    0     0                    -119841.6562 -120040.38  0.17%     -    0s
     0     0 -120040.38    0   63 -119841.66 -120040.38  0.17%     -    0s
     0     0 -120040.38    0   40 -119841.66 -120040.38  0.17%     -    0s
     0     0 -119992.56    0   35 -119841.66 -119992.56  0.13%     -    0s
     0     0 -119957.61    0   33 -119841.66 -119957.61  0.10%     -    0s
     0     0 -119956.10    0    9 -119841.66 -119956.10  0.10%     -    0s
     0     0 -119947.00    0    8 -119841.66 -119947.00  0.09%     -    0s
     0     0 -119915.85    0    8 -119841.66 -119915.85  0.06%     -    0s
     0     0 -119915.85    0   13 -119841.66 -119915.85  0.06%     -    0s
     0     0 -119878.16    0    9 -119841.66 -119878.16  0.03%     -    0s
H    0     0                    -119844.2810 -119875.63  0.03%     -    0s
H    0     0                    -119853.8643 -119875.63  0.02%     -    0s
H    0     0                    -119854.4920 -119873.37  0.02%     -    0s
     0     0 -119873.37    0    5 -119854.49 -119873.37  0.02%     -    0s
     0     0 -119871.49    0    3 -119854.49 -119871.49  0.01%     -    0s
H    0     0                    -119855.8110 -119871.49  0.01%     -    0s
     0     0 -119868.28    0    2 -119855.81 -119868.28  0.01%     -    0s
H    0     0                    -119856.2259 -119867.56  0.01%     -    0s
H    0     0                    -119862.4614 -119867.56  0.00%     -    0s
*    0     0               0    -119862.8762 -119862.88  0.00%     -    0s

Cutting planes:
  Gomory: 9
  MIR: 5
  Flow cover: 6
  Relax-and-lift: 3

Explored 1 nodes (1103 simplex iterations) in 0.20 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119863 -119862 -119856 ... -119713
No other solutions better than -119863

Optimal solution found (tolerance 1.00e-06)
Best objective -1.198628762419e+05, best bound -1.198628762419e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 152997.95
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119862.88
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -119862.88 = 152997.95
  [DEBUG]   Current θ from Master = 157370.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4372.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 10399.76
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2182.5902, Absolute Gap = 2182.5902, Relative Gap = 0.147748
  Not converged yet (gap = 2182.59 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740650 nonzeros
Model fingerprint: 0x5fbbbb83
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113422 rows and 46052 columns
Presolve time: 3.56s
Presolved: 147891 rows, 62288 columns, 911128 nonzeros
Variable types: 60029 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339222.7835
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.44s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 7.307e+06
 Factor NZ  : 1.714e+07 (roughly 220 MB of memory)
 Factor Ops : 5.479e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.99064271e+07  2.46337324e+08  1.22e+05 1.52e+01  8.34e+04     6s
   1  -1.52647049e+07  2.22684479e+08  8.64e+04 5.75e+01  5.85e+04     6s
   2  -5.70528390e+06  1.65876093e+08  3.18e+04 6.18e+00  2.29e+04     6s
   3  -9.94326602e+05  1.33892191e+08  2.13e+03 1.79e+00  1.97e+03     6s
   4  -5.65283319e+05  8.09328848e+07  5.04e+02 8.50e-01  6.22e+02     6s
   5  -5.25732425e+05  4.57023267e+07  3.58e+02 3.86e-01  3.74e+02     6s
   6  -4.19878381e+05  3.61409895e+07  1.20e+02 2.81e-01  2.01e+02     6s
   7  -3.75849228e+05  2.61001085e+07  7.73e+01 1.91e-01  1.35e+02     6s
   8  -2.38684927e+05  1.80862380e+07  7.05e+00 1.24e-01  7.07e+01     6s
   9  -1.62190818e+05  1.39419820e+07  2.18e+00 9.46e-02  5.30e+01     6s
  10  -1.26700581e+05  5.87241535e+06  1.24e+00 3.93e-02  2.24e+01     6s
  11  -9.12738284e+04  3.36444760e+06  5.04e-01 2.21e-02  1.29e+01     7s
  12  -7.81987981e+04  2.09510233e+06  3.41e-01 1.40e-02  8.07e+00     7s
  13  -4.59461687e+04  6.79582242e+05  1.24e-01 4.09e-03  2.69e+00     7s
  14  -1.61251524e+04  3.02520717e+05  5.83e-02 1.78e-03  1.18e+00     7s
  15   3.25159731e+02  1.84735821e+05  3.53e-02 1.63e-03  6.84e-01     7s
  16   6.90237929e+03  1.39600504e+05  2.80e-02 1.52e-03  4.92e-01     7s
  17   1.20564116e+04  1.10957534e+05  2.28e-02 1.54e-03  3.67e-01     7s
  18   1.69079424e+04  9.03959699e+04  1.84e-02 1.09e-03  2.73e-01     7s
  19   2.09785561e+04  7.34046398e+04  1.49e-02 7.32e-04  1.94e-01     7s
  20   2.53547762e+04  6.59393715e+04  1.14e-02 5.60e-04  1.51e-01     7s
  21   2.88105826e+04  5.95161638e+04  8.79e-03 4.21e-04  1.14e-01     8s
  22   3.00981601e+04  5.43448752e+04  7.89e-03 2.99e-04  8.99e-02     8s
  23   3.22157357e+04  5.00635099e+04  6.42e-03 1.82e-04  6.62e-02     8s
  24   3.35750377e+04  4.81003302e+04  5.52e-03 1.35e-04  5.39e-02     8s
  25   3.54832473e+04  4.62481439e+04  4.24e-03 1.26e-04  3.99e-02     8s
  26   3.72497973e+04  4.47171562e+04  3.09e-03 1.05e-04  2.77e-02     8s
  27   3.82328529e+04  4.41423445e+04  2.45e-03 7.90e-05  2.19e-02     8s
  28   3.89286269e+04  4.35239368e+04  2.03e-03 5.29e-05  1.70e-02     8s
  29   3.94468444e+04  4.31589523e+04  1.70e-03 3.73e-05  1.38e-02     9s
  30   3.97363723e+04  4.30737130e+04  1.53e-03 3.36e-05  1.24e-02     9s
  31   3.98188795e+04  4.29128529e+04  1.47e-03 2.69e-05  1.15e-02     9s
  32   4.05673298e+04  4.27688972e+04  1.01e-03 2.08e-05  8.17e-03     9s
  33   4.10139443e+04  4.26133985e+04  7.30e-04 3.47e-05  5.93e-03     9s
  34   4.12890960e+04  4.25713136e+04  5.65e-04 3.03e-05  4.76e-03     9s
  35   4.13250352e+04  4.24653173e+04  5.43e-04 1.99e-05  4.23e-03     9s
  36   4.14815389e+04  4.24605493e+04  4.53e-04 1.93e-05  3.63e-03     9s
  37   4.15336996e+04  4.24039139e+04  4.21e-04 1.42e-05  3.23e-03    10s
  38   4.17492167e+04  4.23835115e+04  2.97e-04 1.33e-05  2.35e-03    10s
  39   4.18344899e+04  4.23416679e+04  2.47e-04 1.38e-05  1.88e-03    10s
  40   4.19382142e+04  4.23134124e+04  1.85e-04 9.36e-06  1.39e-03    10s
  41   4.19730336e+04  4.23057686e+04  1.65e-04 7.97e-06  1.23e-03    10s
  42   4.20133868e+04  4.22870750e+04  1.42e-04 5.78e-06  1.02e-03    10s
  43   4.20413191e+04  4.22852027e+04  1.25e-04 5.45e-06  9.05e-04    10s
  44   4.20456128e+04  4.22838884e+04  1.23e-04 5.21e-06  8.84e-04    10s
  45   4.20803357e+04  4.22781589e+04  1.03e-04 4.29e-06  7.34e-04    11s
  46   4.21230681e+04  4.22726362e+04  7.43e-05 3.35e-06  5.55e-04    11s
  47   4.21555724e+04  4.22702640e+04  5.57e-05 2.93e-06  4.26e-04    11s
  48   4.21612503e+04  4.22681194e+04  5.23e-05 2.58e-06  3.97e-04    11s
  49   4.21734964e+04  4.22643922e+04  4.48e-05 2.01e-06  3.37e-04    11s
  50   4.21853042e+04  4.22603479e+04  3.80e-05 1.35e-06  2.78e-04    11s
  51   4.22383306e+04  4.22562060e+04  7.01e-06 5.96e-07  6.63e-05    11s
  52   4.22437177e+04  4.22549325e+04  4.03e-06 4.24e-07  4.16e-05    11s
  53   4.22478953e+04  4.22540976e+04  1.84e-06 3.05e-07  2.30e-05    12s
  54   4.22506433e+04  4.22531778e+04  5.19e-07 1.80e-07  9.41e-06    12s
  55   4.22514314e+04  4.22523126e+04  1.71e-07 6.00e-08  3.27e-06    12s
  56   4.22517490e+04  4.22521690e+04  3.92e-08 4.10e-08  1.56e-06    12s
  57   4.22518432e+04  4.22518792e+04  2.61e-08 9.87e-09  1.34e-07    12s
  58   4.22518556e+04  4.22518573e+04  2.84e-09 1.74e-09  6.34e-09    12s
  59   4.22518563e+04  4.22518572e+04  3.14e-07 6.29e-08  3.64e-09    12s
  60   4.22518568e+04  4.22518574e+04  2.78e-06 1.33e-05  1.60e-09    12s
  61   4.22518568e+04  4.22518574e+04  2.76e-06 1.31e-05  1.59e-09    13s
  62   4.22518568e+04  4.22518574e+04  2.72e-06 1.28e-05  1.57e-09    13s
  63   4.22518568e+04  4.22518574e+04  2.70e-06 1.22e-05  1.52e-09    13s

Barrier solved model in 63 iterations and 12.74 seconds (18.74 work units)
Optimal objective 4.22518568e+04


Root crossover log...

  121651 DPushes remaining with DInf 0.0000000e+00                13s
   16291 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   27848 PPushes remaining with PInf 2.4239423e-04                16s
       0 PPushes remaining with PInf 0.0000000e+00                18s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8956326e+05     18s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   95908    4.2251857e+04   0.000000e+00   2.895633e+05     18s
   96293    4.2251857e+04   0.000000e+00   0.000000e+00     19s
   96293    4.2251857e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 4.52s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.225186e+04, 96293 iterations, 18.75 seconds (25.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42251.8572    0  366 -190754.47 42251.8572   122%     -   24s
H    0     0                    -181296.9238 42251.8572   123%     -   24s
H    0     0                    -59041.65255 42251.8572   172%     -   24s
H    0     0                    -57490.17159 42251.8572   173%     -   24s
H    0     0                    -46887.16767 42251.8572   190%     -   24s
H    0     0                    -11078.51522 42251.8572   481%     -   25s
H    0     0                    -4049.235806 42251.8572  1143%     -   25s
H    0     0                    -4022.997979 42251.8572  1150%     -   25s
     0     0 35608.2074    0  302 -4022.9980 35608.2074   985%     -   82s
H    0     0                    3040.9905177 35607.4153  1071%     -   83s
H    0     0                    3287.4686575 35607.4153   983%     -   83s
H    0     0                    3655.6962779 35607.4153   874%     -   83s
H    0     0                    3766.8958388 35607.4153   845%     -   83s
     0     0 34679.7488    0  359 3766.89584 34679.7488   821%     -  106s
     0     0 34583.8196    0  346 3766.89584 34583.8196   818%     -  118s
     0     0 34501.7422    0  355 3766.89584 34501.7422   816%     -  122s
     0     0 34492.6416    0  345 3766.89584 34492.6416   816%     -  126s
     0     0 34425.3211    0  350 3766.89584 34425.3211   814%     -  131s
     0     0 34421.2389    0  350 3766.89584 34421.2389   814%     -  133s
     0     0 34400.6378    0  354 3766.89584 34400.6378   813%     -  136s
     0     0 34234.4694    0  358 3766.89584 34234.4694   809%     -  142s
     0     0 34212.9491    0  369 3766.89584 34212.9491   808%     -  146s
     0     0 34205.0954    0  362 3766.89584 34205.0954   808%     -  150s
     0     0 34170.8190    0  358 3766.89584 34170.8190   807%     -  155s
     0     0 34162.7092    0  361 3766.89584 34162.7092   807%     -  159s
     0     0 34148.1750    0  364 3766.89584 34148.1750   807%     -  164s
     0     0 34133.6493    0  364 3766.89584 34133.6493   806%     -  167s
     0     0 34080.9937    0  380 3766.89584 34080.9937   805%     -  171s
     0     0 34074.1157    0  383 3766.89584 34074.1157   805%     -  173s
     0     0 34073.7093    0  383 3766.89584 34073.7093   805%     -  173s
     0     0 30869.6621    0  423 3766.89584 30869.6621   719%     -  231s
H    0     0                    10217.890397 30869.4020   202%     -  231s
     0     0 30489.6863    0  415 10217.8904 30489.6863   198%     -  251s
     0     0 30289.2898    0  415 10217.8904 30289.2898   196%     -  266s
     0     0 30147.7578    0  427 10217.8904 30147.7578   195%     -  280s
     0     0 30083.8980    0  433 10217.8904 30083.8980   194%     -  288s
     0     0 30075.5182    0  431 10217.8904 30075.5182   194%     -  292s
     0     0 30071.4891    0  430 10217.8904 30071.4891   194%     -  295s
     0     0 30066.8313    0  443 10217.8904 30066.8313   194%     -  297s
     0     0 30056.4595    0  383 10217.8904 30056.4595   194%     -  302s
     0     0 30033.7214    0  376 10217.8904 30033.7214   194%     -  307s
     0     0 30026.2930    0  380 10217.8904 30026.2930   194%     -  310s
     0     0 30001.3554    0  378 10217.8904 30001.3554   194%     -  315s
     0     0 29995.2020    0  386 10217.8904 29995.2020   194%     -  319s
     0     0 29993.1654    0  382 10217.8904 29993.1654   194%     -  322s
     0     0 29988.3133    0  411 10217.8904 29988.3133   193%     -  327s
     0     0 29962.2958    0  405 10217.8904 29962.2958   193%     -  335s
     0     0 29957.9171    0  409 10217.8904 29957.9171   193%     -  339s
     0     0 29956.6850    0  411 10217.8904 29956.6850   193%     -  340s
     0     0 28634.5420    0  439 10217.8904 28634.5420   180%     -  392s
H    0     0                    10220.903964 28634.5296   180%     -  393s
     0     0 28416.2616    0  432 10220.9040 28416.2616   178%     -  410s
     0     0 28333.1496    0  447 10220.9040 28333.1496   177%     -  422s
     0     0 28252.3956    0  447 10220.9040 28252.3956   176%     -  434s
     0     0 28215.5233    0  451 10220.9040 28215.5233   176%     -  444s
     0     0 28194.0454    0  460 10220.9040 28194.0454   176%     -  451s
     0     0 28182.8109    0  457 10220.9040 28182.8109   176%     -  456s
     0     0 28167.8614    0  468 10220.9040 28167.8614   176%     -  462s
     0     0 28166.5126    0  450 10220.9040 28166.5126   176%     -  464s
     0     0 27429.8716    0  454 10220.9040 27429.8716   168%     -  502s
     0     0 27246.1233    0  465 10220.9040 27246.1233   167%     -  521s
     0     0 27202.2799    0  484 10220.9040 27202.2799   166%     -  530s
     0     0 27161.9589    0  475 10220.9040 27161.9589   166%     -  540s
     0     0 27135.8939    0  464 10220.9040 27135.8939   165%     -  546s
     0     0 27108.4237    0  483 10220.9040 27108.4237   165%     -  553s
     0     0 27084.9127    0  473 10220.9040 27084.9127   165%     -  559s
     0     0 27076.0294    0  466 10220.9040 27076.0294   165%     -  563s
     0     0 27066.0106    0  487 10220.9040 27066.0106   165%     -  566s
     0     0 27060.1003    0  480 10220.9040 27060.1003   165%     -  569s
     0     0 27048.2688    0  474 10220.9040 27048.2688   165%     -  573s
     0     0 27043.2070    0  493 10220.9040 27043.2070   165%     -  575s
     0     0 27042.4661    0  492 10220.9040 27042.4661   165%     -  576s
     0     0 26926.1020    0  456 10220.9040 26926.1020   163%     -  590s
H    0     0                    11578.596470 26925.9136   133%     -  590s
H    0     0                    11602.759526 26925.9136   132%     -  590s
     0     0 26886.0210    0  467 11602.7595 26886.0210   132%     -  597s
     0     0 26870.1280    0  469 11602.7595 26870.1280   132%     -  601s
     0     0 26864.1059    0  475 11602.7595 26864.1059   132%     -  605s
     0     0 26860.0077    0  473 11602.7595 26860.0077   131%     -  608s
     0     0 26856.6668    0  469 11602.7595 26856.6668   131%     -  611s
     0     0 26853.5201    0  474 11602.7595 26853.5201   131%     -  613s
     0     0 26842.6095    0  459 11602.7595 26842.6095   131%     -  616s
     0     0 26840.2021    0  475 11602.7595 26840.2021   131%     -  617s
     0     0 26837.7795    0  468 11602.7595 26837.7795   131%     -  619s
     0     0 26836.9195    0  467 11602.7595 26836.9195   131%     -  620s
     0     0 26786.4769    0  535 11602.7595 26786.4769   131%     -  631s
H    0     0                    12879.723955 26786.2459   108%     -  643s
H    0     0                    12890.648900 26786.2459   108%     -  644s
     0     0 26756.3742    0  484 12890.6489 26756.3742   108%     -  652s
     0     0 26744.2649    0  540 12890.6489 26744.2649   107%     -  658s
     0     0 26743.1572    0  533 12890.6489 26743.1572   107%     -  660s
     0     0 26732.9370    0  524 12890.6489 26732.9370   107%     -  668s
H    0     0                    12903.887012 26732.4857   107%     -  669s
     0     0 26731.1801    0  528 12903.8870 26731.1801   107%     -  672s
     0     0 26703.4823    0  483 12903.8870 26703.4823   107%     -  682s
     0     0 26697.5052    0  480 12903.8870 26697.5052   107%     -  687s
     0     0 26693.9521    0  475 12903.8870 26693.9521   107%     -  691s
     0     0 26693.1212    0  488 12903.8870 26693.1212   107%     -  693s
     0     0 26686.8848    0  484 12903.8870 26686.8848   107%     -  698s
     0     0 26686.4380    0  471 12903.8870 26686.4380   107%     -  700s
     0     0 26684.9376    0  479 12903.8870 26684.9376   107%     -  705s
H    0     0                    13012.889115 26684.5982   105%     -  738s
H    0     0                    13262.329180 26684.5982   101%     -  738s
     0     0 26684.0820    0  474 13262.3292 26684.0820   101%     -  742s
     0     0 26683.6051    0  469 13262.3292 26683.6051   101%     -  745s
     0     0 26683.4426    0  469 13262.3292 26683.4426   101%     -  751s
H    0     0                    13380.338302 26683.4412  99.4%     -  912s
H    0     0                    13421.927700 26683.4412  98.8%     -  912s
H    0     0                    13565.937455 26683.4412  96.7%     -  912s
     0     2 26683.4412    0  469 13565.9375 26683.4412  96.7%     -  916s
     1     3 26461.1016    1  440 13565.9375 26683.4175  96.7%  8508  930s
     2     4 26450.3046    1  473 13565.9375 26461.0484  95.1%  9630  944s
     3     5 25922.5073    2  445 13565.9375 26461.0484  95.1% 10759  961s
     4     7 25905.0669    2  459 13565.9375 26450.2691  95.0% 10165  984s
     6    11 25579.0537    3  477 13565.9375 26450.2691  95.0% 10851 1015s
    10    22 25710.7560    4  519 13565.9375 26450.2691  95.0% 12301 1049s
    21    33 25455.5855    5  463 13565.9375 25858.7591  90.6% 16354 1126s
    32    64 23263.6576    6  453 13565.9375 25858.7591  90.6% 16810 1397s
    63    96 23188.0099    7  440 13565.9375 25735.8069  89.7% 26611 1498s
H   71    96                    13683.946577 25735.8069  88.1% 25292 1498s
    95   234 23151.4925    8  444 13683.9466 25572.9672  86.9% 21755 1571s
H  115   234                    13764.504292 25572.9672  85.8% 18663 1571s
   233   337 22313.7706   13  363 13764.5043 25572.9672  85.8% 11697 1613s
   336   390 22994.0259   13  419 13764.5043 25572.9672  85.8%  9238 1640s
   402   426 20754.9370   13  192 13764.5043 25572.9672  85.8%  8757 1668s
   459   456 20315.6970   14  160 13764.5043 25572.9672  85.8%  8517 1698s
   507   474 19290.8753   16  150 13764.5043 25572.9672  85.8%  8596 1724s
   552   500 19627.7963   16  124 13764.5043 25572.9672  85.8%  8626 1750s
H  569   500                    13861.189587 25572.9672  84.5%  8638 1750s
   602   518 17381.3036   18  139 13861.1896 25572.9672  84.5%  8856 1779s
   634   544 14073.0018   19  126 13861.1896 25572.9672  84.5%  9019 1805s
   688   568 infeasible   20      13861.1896 25572.9672  84.5%  9132 1831s
   749   585 24284.1285   11  393 13861.1896 25572.9672  84.5%  9203 1859s
   800   619 23067.1658   12  460 13861.1896 25572.9672  84.5%  9130 1886s
   854   660 21826.4102   13  444 13861.1896 25572.9672  84.5%  9100 1911s
H  882   660                    14100.181709 25572.9672  81.4%  9109 1911s
   917   666 21736.7886   14  452 14100.1817 25572.9672  81.4%  8999 1939s
   996   669 18560.5136   39  350 14100.1817 25572.9672  81.4%  8852 1971s
  1037   712 16894.6467   14  415 14100.1817 25572.9672  81.4%  8808 1999s
  1103   763 infeasible   15      14100.1817 25572.9672  81.4%  8811 2027s
H 1121   763                    14263.809140 25572.9672  79.3%  8799 2027s
  1174   822 19396.6237   17  306 14263.8091 25572.9672  79.3%  8773 2055s
  1265   875 19139.9095   18  216 14263.8091 25572.9672  79.3%  8708 2086s
  1353   904 17405.5549   19  238 14263.8091 25572.9672  79.3%  8643 2117s
  1458   923 17085.9061   20  330 14263.8091 25572.9672  79.3%  8563 2152s
  1543   950 16761.0686   22  316 14263.8091 25572.9672  79.3%  8564 2189s
H 1570   950                    14397.129129 25572.9672  77.6%  8669 2189s
  1601   997 16666.2826   23  283 14397.1291 25572.9672  77.6%  8674 2228s
  1682  1036 15945.6876   28  318 14397.1291 25305.6430  75.8%  8815 2259s
  1727  1089 14995.8692   32  252 14397.1291 25305.6430  75.8%  8943 2296s
H 1782  1089                    14421.428087 25305.6430  75.5%  8955 2296s
  1821  1100 infeasible   37      14421.4281 25305.6430  75.5%  8963 2327s
H 1829  1100                    14474.312086 25305.6430  74.8%  8989 2327s
H 1844  1100                    14477.957543 25305.6430  74.8%  9014 2328s
  1861  1129     cutoff   37      14477.9575 25305.6430  74.8%  9054 2372s
  1951  1165 21967.6488   10  456 14477.9575 25305.6430  74.8%  9152 2416s
H 1983  1165                    14519.211151 25305.6430  74.3%  9293 2416s
  2021  1172 21098.8806   11  459 14519.2112 25305.6430  74.3%  9343 2459s
  2086  1197 19415.5079   12  457 14519.2112 25305.6430  74.3%  9460 2502s
  2123  1220 14885.6878   13  393 14519.2112 25305.6430  74.3%  9618 2540s
  2176  1251     cutoff   14      14519.2112 25305.6430  74.3%  9711 2588s
  2251  1287 17365.5298   17  379 14519.2112 24785.2623  70.7%  9814 2632s
  2332  1336 16770.0808   18  306 14519.2112 24785.2623  70.7%  9888 2679s
  2427  1378 14868.3905   19  293 14519.2112 24785.2623  70.7% 10037 2730s
  2545  1432 14828.7799   20  257 14519.2112 24785.2623  70.7% 10147 2798s
  2670  1488 infeasible   20      14519.2112 24785.2623  70.7% 10220 2856s
  2781  1556 15759.0906   22  190 14519.2112 24785.2623  70.7% 10311 2920s
  2905  1632 14599.1240   28  128 14519.2112 24785.2623  70.7% 10393 2987s
  3045  1700 17643.7488   17  204 14519.2112 24785.2623  70.7% 10399 3061s
  3203  1771 14984.1677   20  170 14519.2112 24785.2623  70.7% 10452 3133s
  3372  1862 17303.7955   15  344 14519.2112 24785.2623  70.7% 10445 3211s
  3543  1903 17019.1239   17  306 14519.2112 24785.2623  70.7% 10412 3287s
  3687  1960 infeasible   19      14519.2112 24785.2623  70.7% 10456 3357s
  3812  2012 22763.0324   13  347 14519.2112 24514.0732  68.8% 10539 3437s
  3976  2059 20017.6548   15  301 14519.2112 24512.7486  68.8% 10521 3519s
  4134  2085 16379.5130   20   64 14519.2112 24327.5860  67.6% 10595 3590s
  4172  2086 15863.5072   21   44 14519.2112 24300.6996  67.4% 10651 3600s

Cutting planes:
  Learned: 1
  Gomory: 8
  Implied bound: 208
  MIR: 3231
  Flow cover: 3310
  Zero half: 1
  RLT: 116
  Relax-and-lift: 574

Explored 4187 nodes (45181506 simplex iterations) in 3600.07 seconds (8713.44 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14519.2 14478 14474.3 ... 13683.9

Time limit reached
Best objective 1.451921115067e+04, best bound 2.430069960797e+04, gap 67.3693%
  WARNING: Time limit reached. Using best solution found (gap: 67.37%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 14519.21, θ = 160189.06
  Upper Bound (UB) = 14519.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160189.06
  [DEBUG]   ✓ Scenario 0: θ = 160189.06 ≤ Q = 160189.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160189.06 ≤ Q = 160189.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160189.06 ≤ Q = 160189.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 160189.06 ≤ Q = 160189.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 160189.06 ≤ Q = 160189.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 160189.06 ≤ Q = 160189.06 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 160189.06 ≤ Q = 160189.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x55ba69e2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaa45961e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.234559e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6085970.6439
Variable types: 346 continuous, 166 integer (166 binary)

Root relaxation: objective -1.448282e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144828.24    0  120 6085970.64 -144828.24   102%     -    0s
H    0     0                    -107910.6067 -144828.24  34.2%     -    0s
H    0     0                    -111067.2395 -144828.24  30.4%     -    0s
H    0     0                    -112033.8681 -144828.24  29.3%     -    0s
     0     0 -125200.73    0   54 -112033.87 -125200.73  11.8%     -    0s
H    0     0                    -123085.8731 -125136.15  1.67%     -    0s
H    0     0                    -123427.4731 -125136.15  1.38%     -    0s
H    0     0                    -123806.2974 -125136.15  1.07%     -    0s
     0     0 -124463.08    0   48 -123806.30 -124463.08  0.53%     -    0s
H    0     0                    -123818.6250 -124461.73  0.52%     -    0s
     0     0 -124300.36    0   44 -123818.63 -124300.36  0.39%     -    0s
     0     0 -124300.36    0   45 -123818.63 -124300.36  0.39%     -    0s
H    0     0                    -123847.6255 -124122.28  0.22%     -    0s
     0     0 -124122.28    0   20 -123847.63 -124122.28  0.22%     -    0s
H    0     0                    -123886.4363 -124103.19  0.17%     -    0s
     0     0 -124073.46    0   15 -123886.44 -124073.46  0.15%     -    0s
     0     0 -124072.19    0   13 -123886.44 -124072.19  0.15%     -    0s
     0     0 -124043.95    0   12 -123886.44 -124043.95  0.13%     -    0s
     0     0 -124043.95    0   19 -123886.44 -124043.95  0.13%     -    0s
H    0     0                    -123887.5134 -124043.95  0.13%     -    0s
     0     0 -123972.41    0    8 -123887.51 -123972.41  0.07%     -    0s
H    0     0                    -123965.4153 -123967.82  0.00%     -    0s
     0     0 -123967.82    0    2 -123965.42 -123967.82  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 9
  Flow cover: 9
  Relax-and-lift: 1

Explored 1 nodes (713 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123965 -123888 -123886 ... -107911
No other solutions better than -123965

Optimal solution found (tolerance 1.00e-06)
Best objective -1.239654152944e+05, best bound -1.239654152944e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 148711.26
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123965.42
  [DEBUG]   S×d_nominal = 272676.68
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272676.68 + -123965.42 = 148711.26
  [DEBUG]   Current θ from Master = 160189.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11477.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3041.41
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 1929.4494, Absolute Gap = 1929.4494, Relative Gap = 0.132889
  Not converged yet (gap = 1929.45 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783893 nonzeros
Model fingerprint: 0x1586939a
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120088 rows and 48758 columns
Presolve time: 3.16s
Presolved: 156515 rows, 65822 columns, 963696 nonzeros
Variable types: 63563 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.47s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 8.082e+06
 Factor NZ  : 1.836e+07 (roughly 240 MB of memory)
 Factor Ops : 4.750e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.03591046e+07  2.58868848e+08  1.25e+05 1.49e+01  8.49e+04     5s
   1  -1.56164132e+07  2.34672754e+08  8.82e+04 5.68e+01  5.95e+04     5s
   2  -6.23525489e+06  1.75346816e+08  3.47e+04 6.84e+00  2.48e+04     5s
   3  -1.16215322e+06  1.41722273e+08  2.79e+03 1.84e+00  2.44e+03     6s
   4  -7.35613094e+05  9.88024038e+07  5.56e+02 9.70e-01  7.11e+02     6s
   5  -5.37955965e+05  6.06351576e+07  4.07e+02 4.81e-01  4.54e+02     6s
   6  -4.37902684e+05  4.61209531e+07  1.26e+02 3.42e-01  2.33e+02     6s
   7  -4.01812187e+05  3.31660877e+07  8.34e+01 2.33e-01  1.59e+02     6s
   8  -3.62646027e+05  2.54481684e+07  5.17e+01 1.72e-01  1.13e+02     6s
   9  -2.54507437e+05  1.90713698e+07  5.51e+00 1.23e-01  6.98e+01     6s
  10  -1.63267588e+05  1.07672301e+07  1.44e+00 6.67e-02  3.86e+01     6s
  11  -1.21865775e+05  5.09900476e+06  8.12e-01 3.14e-02  1.84e+01     6s
  12  -8.69906669e+04  3.04125142e+06  3.72e-01 1.85e-02  1.10e+01     6s
  13  -6.48703488e+04  1.72345931e+06  1.88e-01 1.04e-02  6.27e+00     7s
  14  -3.42224579e+04  5.74676404e+05  7.51e-02 3.16e-03  2.13e+00     7s
  15  -1.79252284e+04  3.23856366e+05  4.48e-02 1.89e-03  1.20e+00     7s
  16  -8.91744205e+02  1.77494657e+05  2.78e-02 1.44e-03  6.25e-01     7s
  17   4.96204425e+03  1.44938808e+05  2.35e-02 1.37e-03  4.91e-01     7s
  18   1.07328463e+04  1.13429810e+05  1.95e-02 9.41e-04  3.60e-01     7s
  19   1.81894871e+04  9.56288657e+04  1.43e-02 7.00e-04  2.71e-01     7s
  20   2.18622017e+04  7.72062171e+04  1.18e-02 4.64e-04  1.94e-01     7s
  21   2.67477067e+04  6.94527895e+04  8.62e-03 5.22e-04  1.50e-01     8s
  22   3.00532924e+04  6.16243232e+04  6.66e-03 3.68e-04  1.11e-01     8s
  23   3.24673106e+04  5.64302693e+04  5.28e-03 2.65e-04  8.40e-02     8s
  24   3.40559066e+04  5.37733463e+04  4.42e-03 2.11e-04  6.91e-02     8s
  25   3.54121396e+04  5.03030212e+04  3.68e-03 1.43e-04  5.22e-02     8s
  26   3.78545305e+04  4.84716511e+04  2.41e-03 1.73e-04  3.72e-02     8s
  27   3.88049879e+04  4.69516273e+04  1.94e-03 1.24e-04  2.86e-02     8s
  28   3.96861513e+04  4.57076559e+04  1.51e-03 8.36e-05  2.11e-02     9s
  29   4.05591562e+04  4.49636428e+04  1.10e-03 5.91e-05  1.54e-02     9s
  30   4.08311532e+04  4.46399414e+04  9.81e-04 4.83e-05  1.34e-02     9s
  31   4.10877831e+04  4.42618296e+04  8.57e-04 3.81e-05  1.11e-02     9s
  32   4.13476112e+04  4.39822920e+04  7.39e-04 2.93e-05  9.24e-03     9s
  33   4.16575709e+04  4.37957733e+04  6.06e-04 2.34e-05  7.50e-03     9s
  34   4.17257191e+04  4.37396188e+04  5.75e-04 2.16e-05  7.06e-03     9s
  35   4.19134176e+04  4.36101426e+04  4.90e-04 1.72e-05  5.95e-03    10s
  36   4.22646484e+04  4.35435363e+04  3.40e-04 1.51e-05  4.48e-03    10s
  37   4.23427629e+04  4.34692650e+04  3.06e-04 1.26e-05  3.95e-03    10s
  38   4.24498799e+04  4.33676014e+04  2.58e-04 8.72e-06  3.22e-03    10s
  39   4.24919485e+04  4.33036136e+04  2.40e-04 6.85e-06  2.85e-03    10s
  40   4.25604710e+04  4.32971533e+04  2.11e-04 6.65e-06  2.58e-03    10s
  41   4.26373919e+04  4.32824176e+04  1.78e-04 6.25e-06  2.26e-03    10s
  42   4.26983421e+04  4.32454508e+04  1.52e-04 5.16e-06  1.92e-03    11s
  43   4.27124067e+04  4.31698218e+04  1.45e-04 3.10e-06  1.60e-03    11s
  44   4.27551190e+04  4.31582359e+04  1.26e-04 2.76e-06  1.41e-03    11s
  45   4.27705775e+04  4.31485273e+04  1.20e-04 2.50e-06  1.33e-03    11s
  46   4.28430059e+04  4.31384765e+04  8.96e-05 2.21e-06  1.04e-03    11s
  47   4.28927325e+04  4.31094455e+04  6.82e-05 1.41e-06  7.60e-04    11s
  48   4.29553518e+04  4.30962381e+04  4.15e-05 1.04e-06  4.94e-04    11s
  49   4.29704852e+04  4.30764156e+04  3.55e-05 4.37e-07  3.71e-04    12s
  50   4.29858419e+04  4.30679768e+04  2.93e-05 2.25e-07  2.88e-04    12s
  51   4.29994897e+04  4.30667215e+04  2.39e-05 2.24e-07  2.36e-04    12s
  52   4.30031841e+04  4.30658803e+04  2.24e-05 1.95e-07  2.20e-04    12s
  53   4.30213322e+04  4.30624805e+04  1.50e-05 9.12e-08  1.44e-04    12s
  54   4.30359400e+04  4.30620649e+04  9.27e-06 8.13e-08  9.16e-05    12s
  55   4.30398374e+04  4.30610007e+04  7.71e-06 1.10e-07  7.42e-05    12s
  56   4.30460057e+04  4.30604045e+04  5.14e-06 7.62e-08  5.05e-05    13s
  57   4.30480278e+04  4.30603132e+04  4.35e-06 7.11e-08  4.31e-05    13s
  58   4.30536389e+04  4.30595442e+04  2.10e-06 2.02e-08  2.07e-05    13s
  59   4.30537349e+04  4.30594876e+04  2.08e-06 1.73e-06  2.02e-05    13s
  60   4.30554804e+04  4.30594203e+04  1.37e-06 1.38e-06  1.38e-05    13s
  61   4.30584730e+04  4.30592989e+04  2.43e-07 5.36e-07  2.90e-06    13s
  62   4.30590388e+04  4.30591941e+04  1.74e-07 3.11e-07  5.45e-07    13s
  63   4.30591740e+04  4.30591744e+04  7.11e-09 5.15e-08  1.24e-09    13s

Barrier solved model in 63 iterations and 13.44 seconds (20.17 work units)
Optimal objective 4.30591740e+04


Root crossover log...

  128936 DPushes remaining with DInf 0.0000000e+00                14s
   46947 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

   18172 PPushes remaining with PInf 1.2726228e-04                19s
    7638 PPushes remaining with PInf 6.9955207e-05                20s
       0 PPushes remaining with PInf 0.0000000e+00                21s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.1277946e+03     21s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   82877    4.3059174e+04   0.000000e+00   4.127795e+03     21s
   83030    4.3059174e+04   0.000000e+00   0.000000e+00     21s
   83030    4.3059174e+04   0.000000e+00   0.000000e+00     21s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.305917e+04, 83030 iterations, 17.47 seconds (33.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43059.1743    0  361 -190754.47 43059.1743   123%     -   22s
H    0     0                    -188197.2082 43059.1743   123%     -   22s
H    0     0                    -136579.1883 43059.1743   132%     -   23s
H    0     0                    -114495.4604 43059.1743   138%     -   23s
H    0     0                    -100507.2680 43059.1743   143%     -   23s
H    0     0                    -48205.01537 43059.1743   189%     -   23s
H    0     0                    -15041.92287 43059.1743   386%     -   23s
H    0     0                    -4463.082658 43059.1743  1065%     -   23s
H    0     0                    -4012.389558 43059.1743  1173%     -   23s
     0     0 36013.8256    0  334 -4012.3896 36013.8256   998%     -   85s
H    0     0                    -585.3009010 36012.2733  6253%     -   86s
H    0     0                    -298.0513528 36012.2733      -     -   86s
     0     0 35083.9841    0  341 -298.05135 35083.9841      -     -  113s
     0     0 35002.6156    0  354 -298.05135 35002.6156      -     -  120s
     0     0 34988.2303    0  355 -298.05135 34988.2303      -     -  124s
     0     0 34974.0037    0  345 -298.05135 34974.0037      -     -  128s
     0     0 34884.5722    0  356 -298.05135 34884.5722      -     -  138s
     0     0 34881.8406    0  354 -298.05135 34881.8406      -     -  141s
     0     0 34877.6381    0  352 -298.05135 34877.6381      -     -  143s
     0     0 34875.6007    0  354 -298.05135 34875.6007      -     -  146s
     0     0 34874.7863    0  356 -298.05135 34874.7863      -     -  147s
     0     0 31763.5845    0  417 -298.05135 31763.5845      -     -  223s
H    0     0                    8607.2547432 31763.2940   269%     -  224s
H    0     0                    8832.8916165 31763.2940   260%     -  224s
     0     0 31224.8051    0  415 8832.89162 31224.8051   254%     -  250s
     0     0 31109.0123    0  424 8832.89162 31109.0123   252%     -  262s
     0     0 31050.3218    0  426 8832.89162 31050.3218   252%     -  271s
     0     0 30877.8041    0  437 8832.89162 30877.8041   250%     -  290s
     0     0 30773.1720    0  437 8832.89162 30773.1720   248%     -  304s
     0     0 30713.8636    0  429 8832.89162 30713.8636   248%     -  315s
     0     0 30698.6859    0  437 8832.89162 30698.6859   248%     -  320s
     0     0 30677.4779    0  437 8832.89162 30677.4779   247%     -  326s
     0     0 30668.7864    0  435 8832.89162 30668.7864   247%     -  330s
     0     0 30660.1375    0  439 8832.89162 30660.1375   247%     -  334s
     0     0 30622.3508    0  412 8832.89162 30622.3508   247%     -  343s
     0     0 30601.9525    0  437 8832.89162 30601.9525   246%     -  351s
     0     0 30567.2962    0  407 8832.89162 30567.2962   246%     -  359s
     0     0 30562.5158    0  437 8832.89162 30562.5158   246%     -  364s
     0     0 30536.8071    0  415 8832.89162 30536.8071   246%     -  368s
     0     0 30515.2610    0  429 8832.89162 30515.2610   245%     -  374s
     0     0 30490.0656    0  435 8832.89162 30490.0656   245%     -  378s
     0     0 30273.8362    0  414 8832.89162 30273.8362   243%     -  394s
     0     0 30219.9116    0  453 8832.89162 30219.9116   242%     -  403s
     0     0 30214.3469    0  460 8832.89162 30214.3469   242%     -  408s
     0     0 30209.2125    0  460 8832.89162 30209.2125   242%     -  411s
     0     0 30203.9711    0  466 8832.89162 30203.9711   242%     -  414s
     0     0 30203.6266    0  466 8832.89162 30203.6266   242%     -  415s
     0     0 28736.4137    0  439 8832.89162 28736.4137   225%     -  479s
H    0     0                    10114.197860 28735.8893   184%     -  480s
     0     0 28400.0097    0  462 10114.1979 28400.0097   181%     -  513s
     0     0 28294.5624    0  460 10114.1979 28294.5624   180%     -  529s
     0     0 28198.8448    0  453 10114.1979 28198.8448   179%     -  542s
     0     0 28138.7642    0  479 10114.1979 28138.7642   178%     -  552s
     0     0 28114.4234    0  483 10114.1979 28114.4234   178%     -  557s
     0     0 28098.4251    0  501 10114.1979 28098.4251   178%     -  563s
     0     0 28088.1284    0  489 10114.1979 28088.1284   178%     -  567s
     0     0 28079.8341    0  499 10114.1979 28079.8341   178%     -  571s
     0     0 28042.7915    0  512 10114.1979 28042.7915   177%     -  579s
     0     0 28030.5809    0  508 10114.1979 28030.5809   177%     -  585s
     0     0 28006.5981    0  516 10114.1979 28006.5981   177%     -  590s
     0     0 27990.5667    0  510 10114.1979 27990.5667   177%     -  597s
     0     0 27985.7984    0  508 10114.1979 27985.7984   177%     -  601s
     0     0 27982.4266    0  519 10114.1979 27982.4266   177%     -  603s
     0     0 27979.6319    0  509 10114.1979 27979.6319   177%     -  605s
     0     0 27975.2861    0  507 10114.1979 27975.2861   177%     -  607s
     0     0 27971.6340    0  500 10114.1979 27971.6340   177%     -  609s
     0     0 27970.2419    0  507 10114.1979 27970.2419   177%     -  611s
     0     0 27514.8157    0  478 10114.1979 27514.8157   172%     -  646s
H    0     0                    10121.843896 27514.5122   172%     -  647s
H    0     0                    10308.567329 27514.5122   167%     -  648s
     0     0 27369.3896    0  469 10308.5673 27369.3896   166%     -  661s
     0     0 27333.8996    0  461 10308.5673 27333.8996   165%     -  671s
     0     0 27292.9130    0  479 10308.5673 27292.9130   165%     -  679s
     0     0 27274.9826    0  491 10308.5673 27274.9826   165%     -  686s
     0     0 27263.2321    0  494 10308.5673 27263.2321   164%     -  690s
     0     0 27239.6345    0  482 10308.5673 27239.6345   164%     -  695s
     0     0 27221.3899    0  480 10308.5673 27221.3899   164%     -  699s
     0     0 27215.0498    0  489 10308.5673 27215.0498   164%     -  701s
     0     0 27205.3488    0  489 10308.5673 27205.3488   164%     -  706s
     0     0 27198.1632    0  491 10308.5673 27198.1632   164%     -  710s
     0     0 27195.9224    0  492 10308.5673 27195.9224   164%     -  712s
     0     0 27190.1477    0  489 10308.5673 27190.1477   164%     -  716s
     0     0 27187.6954    0  496 10308.5673 27187.6954   164%     -  719s
     0     0 27177.6076    0  481 10308.5673 27177.6076   164%     -  723s
     0     0 27176.8258    0  481 10308.5673 27176.8258   164%     -  724s
     0     0 26979.8410    0  473 10308.5673 26979.8410   162%     -  742s
H    0     0                    10485.002500 26979.8336   157%     -  753s
     0     0 26909.4770    0  486 10485.0025 26909.4770   157%     -  765s
     0     0 26887.0586    0  497 10485.0025 26887.0586   156%     -  772s
     0     0 26876.8591    0  485 10485.0025 26876.8591   156%     -  777s
     0     0 26873.4226    0  486 10485.0025 26873.4226   156%     -  780s
     0     0 26870.9969    0  492 10485.0025 26870.9969   156%     -  781s
     0     0 26870.5028    0  495 10485.0025 26870.5028   156%     -  782s
     0     0 26818.5684    0  494 10485.0025 26818.5684   156%     -  796s
H    0     0                    11884.112771 26817.3881   126%     -  810s
H    0     0                    12082.192347 26817.3881   122%     -  812s
H    0     0                    12144.717180 26817.3881   121%     -  812s
     0     0 26792.9038    0  491 12144.7172 26792.9038   121%     -  820s
     0     0 26786.9181    0  502 12144.7172 26786.9181   121%     -  823s
     0     0 26781.5228    0  490 12144.7172 26781.5228   121%     -  828s
     0     0 26778.9254    0  494 12144.7172 26778.9254   120%     -  831s
     0     0 26777.1455    0  490 12144.7172 26777.1455   120%     -  834s
     0     0 26753.5256    0  490 12144.7172 26753.5256   120%     -  845s
     0     0 26749.0769    0  492 12144.7172 26749.0769   120%     -  849s
     0     0 26746.9679    0  486 12144.7172 26746.9679   120%     -  851s
     0     0 26728.2757    0  496 12144.7172 26728.2757   120%     -  859s
H    0     0                    12458.393447 26727.3737   115%     -  862s
     0     0 26720.0110    0  496 12458.3934 26720.0110   114%     -  867s
     0     0 26717.5717    0  503 12458.3934 26717.5717   114%     -  869s
     0     0 26708.2211    0  497 12458.3934 26708.2211   114%     -  871s
     0     0 26705.1558    0  484 12458.3934 26705.1558   114%     -  874s
     0     0 26701.3805    0  486 12458.3934 26701.3805   114%     -  876s
     0     0 26700.1648    0  490 12458.3934 26700.1648   114%     -  877s
     0     0 26683.5335    0  503 12458.3934 26683.5335   114%     -  883s
     0     0 26677.4574    0  499 12458.3934 26677.4574   114%     -  888s
     0     0 26676.2530    0  500 12458.3934 26676.2530   114%     -  891s
     0     0 26667.5925    0  516 12458.3934 26667.5925   114%     -  898s
     0     0 26665.9350    0  500 12458.3934 26665.9350   114%     -  906s
     0     0 26663.5547    0  503 12458.3934 26663.5547   114%     -  911s
     0     0 26662.0779    0  506 12458.3934 26662.0779   114%     -  913s
     0     0 26658.3391    0  535 12458.3934 26658.3391   114%     -  918s
     0     0 26658.2366    0  535 12458.3934 26658.2366   114%     -  925s
H    0     0                    12727.794620 26658.2291   109%     - 1090s
H    0     0                    12788.889505 26658.2291   108%     - 1098s
H    0     0                    13372.110910 26658.2291  99.4%     - 1098s
H    0     0                    13613.152886 26658.2291  95.8%     - 1136s
     0     2 26658.2291    0  535 13613.1529 26658.2291  95.8%     - 1140s
     1     3 26557.5427    1  480 13613.1529 26657.3684  95.8%  4587 1146s
     2     4 26457.6087    1  497 13613.1529 26557.4553  95.1%  9776 1164s
     3     6 26275.3138    2  491 13613.1529 26557.4553  95.1%  9296 1197s
     5     9 25972.3017    3  492 13613.1529 26557.4553  95.1% 12236 1226s
     8    16 25890.3024    4  481 13613.1529 26274.8941  93.0% 11218 1253s
    15    30 25823.4409    5  490 13613.1529 25971.5017  90.8% 11579 1289s
    29    44 24288.2263    5  397 13613.1529 25889.5024  90.2% 17162 1377s
    43    73 24419.6065    6  432 13613.1529 25822.9843  89.7% 20601 1517s
    72   115 24346.9483    7  427 13613.1529 25822.9843  89.7% 19168 1640s
   114   148 24249.8309    8  427 13613.1529 25822.9843  89.7% 15200 1688s
H  142   148                    13743.908327 25822.9843  87.9% 13430 1688s
H  146   148                    13988.445194 25822.9843  84.6% 13429 1688s
   147   281 24112.2195    9  421 13988.4452 25822.9843  84.6% 13421 1745s
   292   324 23924.1189   14  407 13988.4452 25822.9843  84.6%  9137 1782s
   347   345 22821.0766   15  371 13988.4452 25822.9843  84.6%  8702 1814s
   380   363 23878.8783   14  406 13988.4452 25822.9843  84.6%  8845 1843s
   411   380 23897.5434   11  445 13988.4452 25822.9843  84.6%  9130 1874s
   450   392 22838.7479   15  342 13988.4452 25822.9843  84.6%  9100 1905s
   480   411 21291.1307   15  366 13988.4452 25822.9843  84.6%  9154 1943s
   519   441 22440.0026   16  346 13988.4452 25822.9843  84.6%  9438 1975s
   581   456 20990.1719   17  380 13988.4452 25822.9843  84.6%  9525 2007s
   653   477 22243.3585   17  327 13988.4452 25822.9843  84.6%  9388 2042s
   708   498 19479.4201   23  273 13988.4452 25822.9843  84.6%  9280 2072s
   767   522 20599.1853   19  296 13988.4452 25822.9843  84.6%  9273 2099s
H  787   522                    13995.792915 25822.9843  84.5%  9310 2099s
   795   583 infeasible   20      13995.7929 25822.9843  84.5%  9321 2129s
   882   657 19409.7265   21  239 13995.7929 25822.9843  84.5%  9020 2155s
   980   764 19368.2038   22  248 13995.7929 25822.9843  84.5%  8599 2181s
  1120   795 19025.9492   24  246 13995.7929 25822.9843  84.5%  8123 2208s
H 1132   795                    14007.630621 25822.9843  84.3%  8116 2208s
H 1149   795                    14022.352172 25822.9843  84.2%  8119 2208s
  1177   859 17948.7489   25  233 14022.3522 25822.9843  84.2%  8055 2237s
  1321   908 14766.6019   35  312 14022.3522 25822.9843  84.2%  7679 2266s
  1451   940 infeasible   25      14022.3522 25822.9843  84.2%  7382 2299s
  1574   966 17650.3675   25  229 14022.3522 25822.9843  84.2%  7217 2333s
  1664  1030 16023.0837   26  129 14022.3522 25822.9843  84.2%  7216 2365s
  1766  1097 15537.7551   30  133 14022.3522 25822.9843  84.2%  7208 2401s
  1877  1208 15028.2519   36  121 14022.3522 25822.9843  84.2%  7179 2436s
  2042  1290 14460.4249   43  192 14022.3522 25822.9843  84.2%  7011 2471s
  2214  1334 16267.5288   36  208 14022.3522 25822.9843  84.2%  6891 2510s
  2300  1370 15969.7086   37  117 14022.3522 25822.9843  84.2%  6941 2545s
  2412  1419 15769.7580   38  240 14022.3522 25822.9843  84.2%  6902 2587s
  2497  1459 14641.4297   46  159 14022.3522 25822.9843  84.2%  7037 2634s
  2593  1497 17831.2539   22  304 14022.3522 25822.9843  84.2%  7111 2678s
H 2681  1497                    14081.843006 25822.9843  83.4%  7183 2678s
  2689  1556 17730.8950   23  250 14081.8430 25822.9843  83.4%  7210 2724s
  2772  1642 16429.7192   26  160 14081.8430 25822.9843  83.4%  7399 2768s
  2890  1700 14903.3316   27  141 14081.8430 25822.9843  83.4%  7506 2813s
  3022  1772 19513.1657   11  339 14081.8430 25822.9843  83.4%  7615 2864s
  3147  1866 17862.3754   12  115 14081.8430 25822.9843  83.4%  7750 2912s
  3293  1946 15278.1492   14  109 14081.8430 25822.9843  83.4%  7818 2965s
  3449  2028     cutoff   20      14081.8430 25822.9843  83.4%  7893 3021s
  3593  2084 21848.4251   17  410 14081.8430 25656.4852  82.2%  7944 3083s
  3719  2201 20236.4702   21  301 14081.8430 25655.9971  82.2%  8070 3142s
  3888  2243 19223.6195   25  214 14081.8430 25655.9971  82.2%  8113 3193s
  3984  2293 18977.0210   26  194 14081.8430 25655.9971  82.2%  8157 3251s
H 4001  2292                    14099.326692 25655.9971  82.0%  8166 3251s
  4090  2378 17430.4436   29  291 14099.3267 25655.9971  82.0%  8271 3323s
H 4241  2378                    14110.012693 25655.9971  81.8%  8389 3431s

Cutting planes:
  Learned: 1
  Gomory: 2
  Implied bound: 178
  MIR: 3781
  Flow cover: 3590
  Inf proof: 1
  RLT: 116
  Relax-and-lift: 833

Explored 4241 nodes (36352061 simplex iterations) in 3600.08 seconds (8579.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14110 14099.3 14081.8 ... 13372.1

Time limit reached
Best objective 1.411001269271e+04, best bound 2.565599707390e+04, gap 81.8283%
  WARNING: Time limit reached. Using best solution found (gap: 81.83%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = 14110.01, θ = 160589.48
  Upper Bound (UB) = 14110.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160589.48
  [DEBUG]   ✓ Scenario 0: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160589.48 ≤ Q = 160589.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160589.48 ≤ Q = 160589.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 160589.48 ≤ Q = 160589.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 160589.48 ≤ Q = 160589.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x123bd656
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x123bd656
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.235690e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6118898.8923
Variable types: 346 continuous, 166 integer (166 binary)

Root relaxation: objective -1.439668e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143966.78    0  120 6118898.89 -143966.78   102%     -    0s
H    0     0                    -102903.8093 -143966.78  39.9%     -    0s
H    0     0                    -104403.6906 -143966.78  37.9%     -    0s
H    0     0                    -105370.3193 -143966.78  36.6%     -    0s
     0     0 -120289.97    0   61 -105370.32 -120289.97  14.2%     -    0s
H    0     0                    -118076.0071 -120210.11  1.81%     -    0s
H    0     0                    -118422.5755 -120210.11  1.51%     -    0s
H    0     0                    -118735.4120 -120210.11  1.24%     -    0s
H    0     0                    -119081.9804 -120210.11  0.95%     -    0s
     0     0 -119825.28    0   47 -119081.98 -119825.28  0.62%     -    0s
     0     0 -119503.22    0   39 -119081.98 -119503.22  0.35%     -    0s
     0     0 -119503.04    0   39 -119081.98 -119503.04  0.35%     -    0s
     0     0 -119272.13    0   18 -119081.98 -119272.13  0.16%     -    0s
     0     0 -119179.90    0   13 -119081.98 -119179.90  0.08%     -    0s
     0     0 -119179.77    0   14 -119081.98 -119179.77  0.08%     -    0s
     0     0 -119131.76    0    7 -119081.98 -119131.76  0.04%     -    0s
     0     0 -119131.76    0   12 -119081.98 -119131.76  0.04%     -    0s
H    0     0                    -119097.3772 -119131.76  0.03%     -    0s
     0     0 -119097.64    0    2 -119097.38 -119097.64  0.00%     -    0s
     0     0     cutoff    0      -119097.38 -119097.38  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 6
  MIR: 3
  Flow cover: 4
  RLT: 1
  Relax-and-lift: 2

Explored 1 nodes (664 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -119097 -119082 -119033 ... 1.23569e+13
No other solutions better than -119097

Optimal solution found (tolerance 1.00e-06)
Best objective -1.190973772112e+05, best bound -1.190973772112e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 153178.41
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119097.38
  [DEBUG]   S×d_nominal = 272275.79
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272275.79 + -119097.38 = 153178.41
  [DEBUG]   Current θ from Master = 160589.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7411.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6698.95
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 1520.2510, Absolute Gap = 1520.2510, Relative Gap = 0.107743
  Not converged yet (gap = 1520.25 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827136 nonzeros
Model fingerprint: 0x7ef3ec86
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 126754 rows and 51464 columns
Presolve time: 3.07s
Presolved: 165139 rows, 69356 columns, 1016704 nonzeros
Variable types: 67097 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.55s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 8.911e+06
 Factor NZ  : 2.018e+07 (roughly 260 MB of memory)
 Factor Ops : 5.349e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.07996684e+07  2.71209625e+08  1.28e+05 1.45e+01  8.62e+04     5s
   1  -1.59811265e+07  2.46444647e+08  9.02e+04 5.59e+01  6.05e+04     5s
   2  -6.48597860e+06  1.85588881e+08  3.61e+04 3.67e+00  2.57e+04     6s
   3  -8.69518546e+05  1.48101505e+08  1.46e+03 2.04e+00  1.52e+03     6s
   4  -5.81869590e+05  5.81025167e+07  3.99e+02 4.41e-01  4.41e+02     6s
   5  -4.36029912e+05  4.10915035e+07  1.31e+02 2.79e-01  2.13e+02     6s
   6  -3.85236587e+05  3.03390259e+07  7.05e+01 1.95e-01  1.38e+02     6s
   7  -3.05973093e+05  2.36273915e+07  2.69e+01 1.46e-01  9.17e+01     6s
   8  -1.79268841e+05  1.30655691e+07  3.26e+00 8.35e-02  4.51e+01     6s
   9  -1.39740559e+05  6.56730094e+06  2.20e+00 4.07e-02  2.27e+01     6s
  10  -1.00754251e+05  3.81494663e+06  1.12e+00 2.30e-02  1.31e+01     6s
  11  -6.76915113e+04  1.63997897e+06  3.45e-01 9.36e-03  5.69e+00     7s
  12  -3.26686568e+04  4.42717700e+05  9.50e-02 2.25e-03  1.58e+00     7s
  13  -2.02256033e+04  2.68544669e+05  6.47e-02 1.54e-03  9.60e-01     7s
  14  -2.68199405e+03  1.78287621e+05  4.03e-02 1.52e-03  6.02e-01     7s
  15   4.51019232e+03  1.35241488e+05  3.29e-02 7.46e-04  4.35e-01     7s
  16   8.58069722e+03  1.10809700e+05  2.88e-02 8.75e-04  3.40e-01     7s
  17   1.43269957e+04  9.80603346e+04  2.34e-02 7.10e-04  2.78e-01     7s
  18   1.93537924e+04  8.64375301e+04  1.87e-02 5.62e-04  2.23e-01     7s
  19   2.27130747e+04  6.93608245e+04  1.54e-02 4.17e-04  1.55e-01     8s
  20   2.60552717e+04  6.16417847e+04  1.26e-02 3.10e-04  1.18e-01     8s
  21   2.98410679e+04  5.71277038e+04  9.43e-03 2.47e-04  9.07e-02     8s
  22   3.12067896e+04  5.49065261e+04  8.30e-03 3.10e-04  7.88e-02     8s
  23   3.42241171e+04  5.17215493e+04  6.02e-03 2.81e-04  5.82e-02     8s
  24   3.54119819e+04  4.96427259e+04  5.13e-03 2.02e-04  4.73e-02     8s
  25   3.71509953e+04  4.82493824e+04  3.86e-03 1.60e-04  3.69e-02     8s
  26   3.84730319e+04  4.66806052e+04  2.94e-03 1.15e-04  2.73e-02     9s
  27   3.89122833e+04  4.59930764e+04  2.64e-03 1.10e-04  2.35e-02     9s
  28   3.98908151e+04  4.49604975e+04  1.99e-03 6.96e-05  1.69e-02     9s
  29   4.04792591e+04  4.46035094e+04  1.61e-03 5.58e-05  1.37e-02     9s
  30   4.06517599e+04  4.44011457e+04  1.50e-03 4.77e-05  1.25e-02     9s
  31   4.08086248e+04  4.42741006e+04  1.40e-03 4.25e-05  1.15e-02     9s
  32   4.10423496e+04  4.40357557e+04  1.25e-03 3.40e-05  9.96e-03     9s
  33   4.14019063e+04  4.38606145e+04  1.01e-03 2.78e-05  8.18e-03    10s
  34   4.16200832e+04  4.37137143e+04  8.77e-04 2.31e-05  6.96e-03    10s
  35   4.18741110e+04  4.36140737e+04  7.21e-04 3.54e-05  5.79e-03    10s
  36   4.21416231e+04  4.34981934e+04  5.51e-04 2.78e-05  4.51e-03    10s
  37   4.23490073e+04  4.34780168e+04  4.26e-04 2.65e-05  3.75e-03    10s
  38   4.24471699e+04  4.33432634e+04  3.65e-04 1.76e-05  2.98e-03    10s
  39   4.24787351e+04  4.33077207e+04  3.45e-04 1.45e-05  2.76e-03    11s
  40   4.25738075e+04  4.32264022e+04  2.87e-04 9.54e-06  2.17e-03    11s
  41   4.26905915e+04  4.31989126e+04  2.18e-04 8.00e-06  1.69e-03    11s
  42   4.27564465e+04  4.31910694e+04  1.80e-04 7.52e-06  1.45e-03    11s
  43   4.27779366e+04  4.31687602e+04  1.65e-04 6.31e-06  1.30e-03    11s
  44   4.28295152e+04  4.31456633e+04  1.33e-04 4.99e-06  1.05e-03    11s
  45   4.28787808e+04  4.31287750e+04  1.03e-04 4.04e-06  8.31e-04    11s
  46   4.29255259e+04  4.31029422e+04  7.62e-05 2.49e-06  5.90e-04    12s
  47   4.29837926e+04  4.30823885e+04  4.24e-05 1.26e-06  3.28e-04    12s
  48   4.29852070e+04  4.30748908e+04  4.16e-05 8.54e-07  2.98e-04    12s
  49   4.29953719e+04  4.30739125e+04  3.57e-05 7.96e-07  2.61e-04    12s
  50   4.30203706e+04  4.30686452e+04  2.12e-05 5.12e-07  1.61e-04    12s
  51   4.30222635e+04  4.30642355e+04  2.01e-05 2.74e-07  1.40e-04    12s
  52   4.30424740e+04  4.30636820e+04  8.75e-06 2.45e-07  7.05e-05    12s
  53   4.30444452e+04  4.30614443e+04  7.74e-06 1.03e-07  5.66e-05    13s
  54   4.30519443e+04  4.30604435e+04  3.66e-06 5.22e-08  2.83e-05    13s
  55   4.30526385e+04  4.30596640e+04  3.29e-06 2.01e-08  2.34e-05    13s
  56   4.30561501e+04  4.30595770e+04  1.52e-06 2.65e-08  1.14e-05    13s
  57   4.30585241e+04  4.30594065e+04  3.08e-07 2.05e-08  2.94e-06    13s
  58   4.30589999e+04  4.30592088e+04  8.11e-08 3.00e-09  6.95e-07    13s
  59   4.30591457e+04  4.30591744e+04  4.42e-07 3.85e-08  9.51e-08    13s
  60   4.30591643e+04  4.30591743e+04  7.72e-07 8.40e-07  3.32e-08    14s
  61   4.30591640e+04  4.30591743e+04  2.33e-06 8.39e-07  3.32e-08    14s
  62   4.30591641e+04  4.30591752e+04  2.31e-06 6.75e-07  3.61e-08    14s
  63   4.30591693e+04  4.30591743e+04  1.12e-06 1.92e-09  1.60e-08    14s
  64   4.30591726e+04  4.30591743e+04  1.51e-06 1.80e-10  5.79e-09    14s
  65   4.30591734e+04  4.30591743e+04  3.16e-06 2.71e-09  2.99e-09    14s
  66   4.30591737e+04  4.30591743e+04  1.93e-06 7.26e-08  1.82e-09    14s
  67   4.30591739e+04  4.30591743e+04  1.31e-06 1.66e-07  1.24e-09    14s

Barrier solved model in 67 iterations and 14.42 seconds (22.03 work units)
Optimal objective 4.30591739e+04


Root crossover log...

  135494 DPushes remaining with DInf 0.0000000e+00                14s
   68047 DPushes remaining with DInf 0.0000000e+00                15s
    8080 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

   27830 PPushes remaining with PInf 1.3286291e-04                21s
       0 PPushes remaining with PInf 0.0000000e+00                24s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.1418217e+04     24s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  100870    4.3059174e+04   0.000000e+00   7.141822e+04     24s
  101051    4.3059174e+04   0.000000e+00   0.000000e+00     24s
  101051    4.3059174e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 1.89s

Solved with barrier

Root relaxation: objective 4.305917e+04, 101051 iterations, 22.22 seconds (39.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43059.1743    0  361 -190754.47 43059.1743   123%     -   27s
H    0     0                    -157267.5948 43059.1743   127%     -   27s
H    0     0                    -114495.4604 43059.1743   138%     -   27s
H    0     0                    -100507.2680 43059.1743   143%     -   27s
H    0     0                    -69588.85102 43059.1743   162%     -   27s
H    0     0                    -69577.92608 43059.1743   162%     -   28s
H    0     0                    -14338.55914 43059.1743   400%     -   28s
H    0     0                    -4074.914391 43059.1743  1157%     -   28s
H    0     0                    -4012.389558 43059.1743  1173%     -   28s
     0     0 35871.2467    0  322 -4012.3896 35871.2467   994%     -  101s
H    0     0                    -298.0513528 35871.0087      -     -  102s
     0     0 34926.5336    0  346 -298.05135 34926.5336      -     -  127s
     0     0 34891.3751    0  346 -298.05135 34891.3751      -     -  136s
     0     0 34850.8305    0  343 -298.05135 34850.8305      -     -  144s
     0     0 34791.7753    0  354 -298.05135 34791.7753      -     -  150s
     0     0 34790.1127    0  349 -298.05135 34790.1127      -     -  152s
     0     0 34787.0755    0  359 -298.05135 34787.0755      -     -  158s
     0     0 34784.7486    0  356 -298.05135 34784.7486      -     -  161s
     0     0 34783.7625    0  356 -298.05135 34783.7625      -     -  163s
     0     0 34760.0129    0  343 -298.05135 34760.0129      -     -  165s
     0     0 34648.5621    0  354 -298.05135 34648.5621      -     -  178s
     0     0 34631.8733    0  362 -298.05135 34631.8733      -     -  182s
     0     0 34622.8612    0  355 -298.05135 34622.8612      -     -  185s
     0     0 34621.3654    0  355 -298.05135 34621.3654      -     -  187s
     0     0 34621.0495    0  355 -298.05135 34621.0495      -     -  188s
     0     0 32030.8396    0  390 -298.05135 32030.8396      -     -  244s
H    0     0                    8667.3614879 32030.8029   270%     -  245s
H    0     0                    8832.8916165 32030.8029   263%     -  245s
H    0     0                    9018.7738763 32030.8029   255%     -  245s
     0     0 31619.7985    0  395 9018.77388 31619.7985   251%     -  280s
     0     0 31471.9482    0  419 9018.77388 31471.9482   249%     -  297s
     0     0 31403.1432    0  434 9018.77388 31403.1432   248%     -  309s
     0     0 31374.6914    0  436 9018.77388 31374.6914   248%     -  317s
     0     0 31366.0251    0  430 9018.77388 31366.0251   248%     -  323s
     0     0 31346.8814    0  424 9018.77388 31346.8814   248%     -  331s
     0     0 31250.6239    0  421 9018.77388 31250.6239   247%     -  342s
     0     0 31235.2362    0  409 9018.77388 31235.2362   246%     -  347s
     0     0 31224.1504    0  402 9018.77388 31224.1504   246%     -  351s
     0     0 31167.0897    0  398 9018.77388 31167.0897   246%     -  359s
     0     0 31092.5606    0  409 9018.77388 31092.5606   245%     -  370s
     0     0 31075.5314    0  406 9018.77388 31075.5314   245%     -  375s
     0     0 31063.3147    0  400 9018.77388 31063.3147   244%     -  380s
     0     0 31052.3475    0  406 9018.77388 31052.3475   244%     -  388s
     0     0 31046.3516    0  409 9018.77388 31046.3516   244%     -  394s
     0     0 31029.5100    0  403 9018.77388 31029.5100   244%     -  399s
     0     0 30994.3699    0  404 9018.77388 30994.3699   244%     -  408s
     0     0 30991.9930    0  402 9018.77388 30991.9930   244%     -  410s
     0     0 30991.7439    0  404 9018.77388 30991.7439   244%     -  411s
     0     0 28993.9957    0  448 9018.77388 28993.9957   221%     -  497s
H    0     0                    9296.6448120 28993.8004   212%     -  498s
H    0     0                    9815.9815758 28993.8004   195%     -  498s
H    0     0                    9930.1497798 28993.8004   192%     -  498s
     0     0 28531.8264    0  458 9930.14978 28531.8264   187%     -  532s
     0     0 28384.2770    0  469 9930.14978 28384.2770   186%     -  544s
     0     0 28320.5825    0  469 9930.14978 28320.5825   185%     -  553s
     0     0 28293.2731    0  468 9930.14978 28293.2731   185%     -  559s
     0     0 28253.9899    0  467 9930.14978 28253.9899   185%     -  567s
     0     0 28242.3800    0  468 9930.14978 28242.3800   184%     -  572s
     0     0 28234.5157    0  479 9930.14978 28234.5157   184%     -  577s
     0     0 28218.6656    0  463 9930.14978 28218.6656   184%     -  583s
     0     0 28209.0022    0  470 9930.14978 28209.0022   184%     -  588s
     0     0 28200.8320    0  465 9930.14978 28200.8320   184%     -  594s
     0     0 28199.2283    0  479 9930.14978 28199.2283   184%     -  596s
     0     0 27352.9589    0  469 9930.14978 27352.9589   175%     -  645s
     0     0 27175.0336    0  483 9930.14978 27175.0336   174%     -  663s
     0     0 27116.1588    0  467 9930.14978 27116.1588   173%     -  676s
     0     0 27074.9062    0  473 9930.14978 27074.9062   173%     -  684s
     0     0 27051.7471    0  474 9930.14978 27051.7471   172%     -  692s
     0     0 27036.7599    0  476 9930.14978 27036.7599   172%     -  696s
     0     0 27003.9040    0  469 9930.14978 27003.9040   172%     -  703s
     0     0 26981.8827    0  471 9930.14978 26981.8827   172%     -  710s
     0     0 26957.3765    0  477 9930.14978 26957.3765   171%     -  717s
     0     0 26934.3796    0  476 9930.14978 26934.3796   171%     -  723s
     0     0 26928.2306    0  478 9930.14978 26928.2306   171%     -  727s
     0     0 26918.8551    0  484 9930.14978 26918.8551   171%     -  732s
     0     0 26913.3137    0  481 9930.14978 26913.3137   171%     -  736s
     0     0 26902.5191    0  480 9930.14978 26902.5191   171%     -  739s
     0     0 26899.1713    0  480 9930.14978 26899.1713   171%     -  742s
     0     0 26897.0606    0  481 9930.14978 26897.0606   171%     -  743s
     0     0 26837.2511    0  472 9930.14978 26837.2511   170%     -  754s
     0     0 26824.5394    0  486 9930.14978 26824.5394   170%     -  763s
     0     0 26818.3880    0  484 9930.14978 26818.3880   170%     -  767s
     0     0 26808.0768    0  477 9930.14978 26808.0768   170%     -  773s
     0     0 26801.9637    0  485 9930.14978 26801.9637   170%     -  779s
     0     0 26799.5919    0  477 9930.14978 26799.5919   170%     -  782s
     0     0 26796.9457    0  478 9930.14978 26796.9457   170%     -  785s
     0     0 26796.1290    0  482 9930.14978 26796.1290   170%     -  787s
     0     0 26775.3424    0  506 9930.14978 26775.3424   170%     -  800s
H    0     0                    10446.562695 26775.3134   156%     -  837s
H    0     0                    10910.450415 26775.3134   145%     -  837s
H    0     0                    10982.402832 26775.3134   144%     -  837s
H    0     0                    11412.678434 26775.3134   135%     -  841s
     0     0 26764.6448    0  516 11412.6784 26764.6448   135%     -  849s
     0     0 26763.0390    0  517 11412.6784 26763.0390   135%     -  851s
     0     0 26745.4689    0  479 11412.6784 26745.4689   134%     -  861s
H    0     0                    11555.591224 26745.2307   131%     -  862s
H    0     0                    11783.083408 26745.2307   127%     -  862s
     0     0 26737.2793    0  480 11783.0834 26737.2793   127%     -  866s
     0     0 26734.1854    0  477 11783.0834 26734.1854   127%     -  867s
     0     0 26733.0340    0  481 11783.0834 26733.0340   127%     -  869s
     0     0 26722.4078    0  470 11783.0834 26722.4078   127%     -  875s
     0     0 26717.7069    0  464 11783.0834 26717.7069   127%     -  879s
     0     0 26715.5054    0  471 11783.0834 26715.5054   127%     -  882s
     0     0 26702.2526    0  470 11783.0834 26702.2526   127%     -  890s
H    0     0                    11806.954131 26701.9299   126%     -  891s
H    0     0                    11818.492571 26701.9299   126%     -  891s
H    0     0                    11888.213415 26701.9299   125%     -  891s
     0     0 26690.7041    0  482 11888.2134 26690.7041   125%     -  897s
     0     0 26684.1618    0  487 11888.2134 26684.1618   124%     -  902s
     0     0 26679.7352    0  478 11888.2134 26679.7352   124%     -  908s
     0     0 26678.4378    0  480 11888.2134 26678.4378   124%     -  911s
     0     0 26673.8167    0  471 11888.2134 26673.8167   124%     -  915s
     0     0 26671.7201    0  464 11888.2134 26671.7201   124%     -  918s
     0     0 26664.6324    0  479 11888.2134 26664.6324   124%     -  923s
     0     0 26662.1166    0  478 11888.2134 26662.1166   124%     -  926s
     0     0 26660.2018    0  472 11888.2134 26660.2018   124%     -  927s
     0     0 26654.7398    0  470 11888.2134 26654.7398   124%     -  932s
     0     0 26653.1902    0  481 11888.2134 26653.1902   124%     -  935s
     0     0 26647.5996    0  467 11888.2134 26647.5996   124%     -  941s
     0     0 26647.5244    0  467 11888.2134 26647.5244   124%     -  947s
H    0     0                    11966.371136 26647.4615   123%     - 1011s
H    0     0                    12016.425094 26647.4615   122%     - 1107s
H    0     0                    12038.783802 26647.4615   121%     - 1107s
H    0     0                    12154.217063 26647.4615   119%     - 1107s
H    0     0                    12249.368455 26647.4615   118%     - 1110s
H    0     0                    12283.797604 26647.4615   117%     - 1110s
H    0     0                    12294.768407 26647.4615   117%     - 1110s
H    0     2                    12304.458401 26647.4615   117%     - 1113s
     0     2 26647.4615    0  467 12304.4584 26647.4615   117%     - 1113s
     1     3 26290.1222    1  437 12304.4584 26647.0166   117% 14904 1130s
     2     4 26439.4581    1  471 12304.4584 26439.4581   115% 13716 1143s
     3     7 26276.6414    2  468 12304.4584 26436.9861   115% 12683 1161s
     6    13 26141.6622    3  441 12304.4584 26436.9861   115% 12385 1192s
    12    26 26056.0510    4  452 12304.4584 26275.5679   114% 13959 1227s
    25    39 25440.8652    5  471 12304.4584 26055.9754   112% 21934 1313s
H   38    71                    12420.499271 26055.9754   110% 19753 1491s
H   40    71                    12525.891466 26055.9754   108% 19862 1491s
    70   155 24398.7485    7  366 12525.8915 25761.2204   106% 21904 1576s
   154   186 24378.0860   10  366 12525.8915 25760.8501   106% 14005 1615s
H  158   186                    12642.030288 25760.8501   104% 13755 1615s
H  161   186                    14022.294607 25760.8501  83.7% 13650 1615s
   185   234 23448.3137    8  360 14022.2946 25760.8501  83.7% 13006 1670s
   233   315 23685.6116   11  346 14022.2946 25760.8501  83.7% 12232 1721s
   316   365 23439.4301   12  338 14022.2946 25760.8501  83.7% 11030 1763s
   380   415 20304.5989   14  166 14022.2946 25760.8501  83.7% 10437 1806s
   441   482 18649.8884   15  178 14022.2946 25760.8501  83.7% 10432 1843s
   518   543 16781.3925   18  151 14022.2946 25760.8501  83.7% 10431 1872s
   607   619 14180.3810   23  100 14022.2946 25760.8501  83.7%  9955 1900s
   710   694 24795.0622   10  373 14022.2946 25760.8501  83.7%  9408 1925s
   801   742 21300.9336   19  204 14022.2946 25760.8501  83.7%  8944 1951s
   897   795 20765.7103   19  222 14022.2946 25760.8501  83.7%  8552 1977s
  1000   871 18633.7997   20  322 14022.2946 25760.8501  83.7%  8227 2001s
  1101   925 18629.1312   21  310 14022.2946 25760.8501  83.7%  7972 2026s
  1209   980 17051.4658   27  241 14022.2946 25760.8501  83.7%  7763 2052s
  1323  1036 15510.7731   29  124 14022.2946 25760.8501  83.7%  7470 2077s
  1442  1101     cutoff   33      14022.2946 25636.6812  82.8%  7250 2103s
  1577  1160     cutoff   36      14022.2946 25597.2890  82.5%  7023 2130s
  1720  1171     cutoff   40      14022.2946 25583.4600  82.4%  6771 2160s
H 1721  1171                    14144.325572 25583.4600  80.9%  6767 2160s
H 1731  1171                    14646.348940 25583.4600  74.7%  6747 2160s
H 1772  1171                    14747.478239 25583.4600  73.5%  6730 2160s
  1786  1209 22001.0183   11  467 14747.4782 25583.4600  73.5%  6752 2190s
  1882  1256 21928.8678   14  427 14747.4782 25583.4600  73.5%  6779 2225s
  1974  1326 21662.1494   17  396 14747.4782 25583.4600  73.5%  6828 2260s
  2058  1417 21375.7277   22  348 14747.4782 25583.4600  73.5%  6912 2297s
  2177  1517 20728.7161   30  297 14747.4782 25583.4600  73.5%  6894 2332s
  2343  1566 20056.1028   36  244 14747.4782 25583.4600  73.5%  6784 2371s
  2482  1610 18463.4368   39  100 14747.4782 25583.4600  73.5%  6752 2409s
  2592  1676 15215.5298   50   17 14747.4782 25583.4600  73.5%  6828 2452s
  2701  1707 21173.7002    8  436 14747.4782 25583.4600  73.5%  6915 2494s
  2775  1713 21020.2815    9  452 14747.4782 25583.4600  73.5%  7019 2533s
  2815  1731 20720.2561   10  443 14747.4782 25583.4600  73.5%  7159 2570s
  2868  1737 20640.8890   11  383 14747.4782 25583.4600  73.5%  7260 2611s
  2929  1789 20561.4938   12  376 14747.4782 25583.4600  73.5%  7343 2650s
  3014  1870 20376.8098   14  391 14747.4782 25583.4600  73.5%  7437 2699s
  3138  1895 20011.4936   18  372 14747.4782 24947.7465  69.2%  7522 2739s
  3175  1918 19121.6611   19  268 14747.4782 24947.7465  69.2%  7597 2784s
  3214  1960     cutoff   20      14747.4782 24854.0294  68.5%  7696 2831s
  3276  2016 19029.2788   21  270 14747.4782 24854.0294  68.5%  7745 2880s
  3367  2072 18919.5612   22  308 14747.4782 24793.5244  68.1%  7815 2929s
  3479  2153 18577.8264   26  182 14747.4782 24793.5244  68.1%  7877 2987s
  3624  2223 18027.4078   33  303 14747.4782 24793.3127  68.1%  7945 3043s
  3776  2280 17651.1769   40  125 14747.4782 24793.3127  68.1%  8035 3116s
  3889  2340 17123.4982   44  270 14747.4782 24787.8859  68.1%  8061 3182s
  3997  2391 16576.9044   51  307 14747.4782 24787.8859  68.1%  8172 3252s
  4116  2455 15238.9576   64  123 14747.4782 24787.8859  68.1%  8262 3323s
  4244  2535 23058.6935    8  424 14747.4782 24621.0042  67.0%  8320 3395s

Cutting planes:
  Learned: 6
  Gomory: 2
  Implied bound: 206
  MIR: 3893
  Flow cover: 3804
  RLT: 105
  Relax-and-lift: 717

Explored 4371 nodes (37601923 simplex iterations) in 3600.17 seconds (8569.85 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14747.5 14646.3 14144.3 ... 12283.8

Time limit reached
Best objective 1.474747823904e+04, best bound 2.462100421095e+04, gap 66.9506%
  WARNING: Time limit reached. Using best solution found (gap: 66.95%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.22s
  Master Objective (UB) = 14747.48, θ = 158194.48
  Upper Bound (UB) = 14747.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 158194.48
  [DEBUG]   ✓ Scenario 0: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 158194.48 ≤ Q = 158194.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 158194.48 ≤ Q = 158194.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 158194.48 ≤ Q = 158194.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 158194.48 ≤ Q = 158194.48 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 158194.48 ≤ Q = 158194.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x8a88127
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x08a88127
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.321436e+13
Presolve removed 2575 rows and 1867 columns
Presolve time: 0.00s
Presolved: 518 rows, 522 columns, 1461 nonzeros
Found heuristic solution: objective 6638409.9426
Variable types: 354 continuous, 168 integer (168 binary)

Root relaxation: objective -1.463667e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146366.73    0  123 6638409.94 -146366.73   102%     -    0s
H    0     0                    -111780.9242 -146366.73  30.9%     -    0s
H    0     0                    -112310.2782 -146366.73  30.3%     -    0s
     0     0 -123923.10    0   62 -112310.28 -123923.10  10.3%     -    0s
H    0     0                    -120671.7261 -123882.75  2.66%     -    0s
H    0     0                    -121251.5647 -123882.75  2.17%     -    0s
H    0     0                    -121734.7922 -123882.75  1.76%     -    0s
H    0     0                    -122314.6307 -123882.75  1.28%     -    0s
     0     0 -123158.78    0   39 -122314.63 -123158.78  0.69%     -    0s
     0     0 -123144.91    0   40 -122314.63 -123144.91  0.68%     -    0s
     0     0 -122930.63    0   23 -122314.63 -122930.63  0.50%     -    0s
H    0     0                    -122325.5830 -122873.17  0.45%     -    0s
     0     0 -122873.17    0   23 -122325.58 -122873.17  0.45%     -    0s
     0     0 -122862.87    0   18 -122325.58 -122862.87  0.44%     -    0s
     0     0 -122844.92    0   21 -122325.58 -122844.92  0.42%     -    0s
     0     0 -122844.92    0   23 -122325.58 -122844.92  0.42%     -    0s
     0     0 -122844.92    0   23 -122325.58 -122844.92  0.42%     -    0s
     0     0 -122844.92    0   71 -122325.58 -122844.92  0.42%     -    0s
     0     0 -122767.32    0   16 -122325.58 -122767.32  0.36%     -    0s
H    0     0                    -122415.9008 -122729.93  0.26%     -    0s
     0     0 -122729.93    0   16 -122415.90 -122729.93  0.26%     -    0s
H    0     0                    -122452.7644 -122601.75  0.12%     -    0s
     0     0 -122601.75    0   13 -122452.76 -122601.75  0.12%     -    0s
H    0     0                    -122506.8756 -122598.65  0.07%     -    0s
     0     0 -122583.25    0   14 -122506.88 -122583.25  0.06%     -    0s
     0     0 -122574.48    0   12 -122506.88 -122574.48  0.06%     -    0s
     0     0 -122558.52    0   11 -122506.88 -122558.52  0.04%     -    0s
     0     0 -122556.23    0   12 -122506.88 -122556.23  0.04%     -    0s
     0     0 -122553.81    0   12 -122506.88 -122553.81  0.04%     -    0s
     0     0 -122553.64    0   12 -122506.88 -122553.64  0.04%     -    0s
     0     0 -122545.57    0   10 -122506.88 -122545.57  0.03%     -    0s
     0     0 -122545.57    0   10 -122506.88 -122545.57  0.03%     -    0s
H    0     0                    -122518.9764 -122545.57  0.02%     -    0s
*    0     0               0    -122531.6475 -122531.65  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 3
  Flow cover: 6
  Relax-and-lift: 1

Explored 1 nodes (1018 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -122532 -122519 -122507 ... -111781
No other solutions better than -122532

Optimal solution found (tolerance 1.00e-06)
Best objective -1.225316475022e+05, best bound -1.225316475022e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 150329.17
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122531.65
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -122531.65 = 150329.17
  [DEBUG]   Current θ from Master = 158194.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7865.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6882.17
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2157.7165, Absolute Gap = 2157.7165, Relative Gap = 0.146311
  Not converged yet (gap = 2157.72 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870379 nonzeros
Model fingerprint: 0x5a243924
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 133440 rows and 54180 columns
Presolve time: 3.76s
Presolved: 173743 rows, 72880 columns, 1070041 nonzeros
Variable types: 70621 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.67s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 9.795e+06
 Factor NZ  : 2.175e+07 (roughly 300 MB of memory)
 Factor Ops : 5.739e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.11820988e+07  2.83122430e+08  1.30e+05 1.41e+01  8.73e+04     7s
   1  -1.63118487e+07  2.57684088e+08  9.20e+04 5.51e+01  6.14e+04     7s
   2  -6.61388435e+06  1.95999543e+08  3.66e+04 3.91e+00  2.59e+04     7s
   3  -1.59242414e+06  1.61285295e+08  5.00e+03 1.66e+00  3.92e+03     8s
   4  -8.32590168e+05  1.17316888e+08  9.69e+02 8.04e-01  1.00e+03     8s
   5  -5.40549061e+05  1.08740156e+08  3.83e+02 7.32e-01  5.90e+02     8s
   6  -4.94613655e+05  6.25767501e+07  2.58e+02 3.53e-01  3.44e+02     8s
   7  -4.08323796e+05  4.57712471e+07  8.48e+01 2.40e-01  1.90e+02     8s
   8  -3.59201611e+05  3.37472427e+07  2.93e+01 1.73e-01  1.21e+02     8s
   9  -2.77047057e+05  2.48945340e+07  4.37e+00 1.24e-01  8.12e+01     8s
  10  -1.74630528e+05  9.24074434e+06  6.20e-01 4.40e-02  2.98e+01     8s
  11  -1.11743467e+05  3.92026636e+06  3.69e-01 1.86e-02  1.28e+01     8s
  12  -7.98708614e+04  2.41556395e+06  1.70e-01 1.13e-02  7.89e+00     9s
  13  -6.78582253e+04  1.70379026e+06  1.23e-01 7.91e-03  5.60e+00     9s
  14  -3.17917464e+04  5.02556320e+05  4.36e-02 2.15e-03  1.69e+00     9s
  15  -1.04100305e+04  3.15589123e+05  2.71e-02 1.39e-03  1.03e+00     9s
  16  -1.15026802e+03  2.04862020e+05  2.04e-02 9.08e-04  6.51e-01     9s
  17   4.80986443e+03  1.59889428e+05  1.72e-02 6.53e-04  4.90e-01     9s
  18   1.44592530e+04  1.32984956e+05  1.21e-02 5.01e-04  3.75e-01     9s
  19   1.95018591e+04  9.68161780e+04  9.45e-03 3.71e-04  2.44e-01     9s
  20   2.27656621e+04  8.12694684e+04  7.87e-03 3.69e-04  1.85e-01     9s
  21   2.65446385e+04  6.98852723e+04  6.15e-03 2.66e-04  1.37e-01    10s
  22   2.97892258e+04  6.24685741e+04  4.73e-03 1.97e-04  1.03e-01    10s
  23   3.28204821e+04  5.41571764e+04  3.51e-03 2.09e-04  6.74e-02    10s
  24   3.44038155e+04  5.31446486e+04  2.90e-03 1.91e-04  5.92e-02    10s
  25   3.49013090e+04  4.89416856e+04  2.70e-03 1.19e-04  4.44e-02    10s
  26   3.60054669e+04  4.79561959e+04  2.29e-03 1.01e-04  3.78e-02    10s
  27   3.67255595e+04  4.61113431e+04  2.03e-03 6.67e-05  2.97e-02    10s
  28   3.76393860e+04  4.52014707e+04  1.70e-03 4.86e-05  2.39e-02    11s
  29   3.87546125e+04  4.44233778e+04  1.30e-03 3.35e-05  1.79e-02    11s
  30   3.95105657e+04  4.38153797e+04  1.03e-03 2.25e-05  1.36e-02    11s
  31   3.99384489e+04  4.34690066e+04  8.77e-04 1.62e-05  1.12e-02    11s
  32   4.06673994e+04  4.32912709e+04  6.15e-04 1.30e-05  8.29e-03    11s
  33   4.09020233e+04  4.31739900e+04  5.39e-04 1.10e-05  7.18e-03    11s
  34   4.12411590e+04  4.30764883e+04  4.23e-04 1.40e-05  5.80e-03    11s
  35   4.14566743e+04  4.28668875e+04  3.50e-04 8.71e-06  4.46e-03    12s
  36   4.17099915e+04  4.28095997e+04  2.67e-04 7.18e-06  3.48e-03    12s
  37   4.19220285e+04  4.27473046e+04  1.96e-04 5.34e-06  2.61e-03    12s
  38   4.20429408e+04  4.27384445e+04  1.58e-04 5.14e-06  2.20e-03    12s
  39   4.20803602e+04  4.26711933e+04  1.46e-04 3.56e-06  1.87e-03    12s
  40   4.22003113e+04  4.26455830e+04  1.06e-04 2.83e-06  1.41e-03    12s
  41   4.22704217e+04  4.25925149e+04  8.29e-05 1.50e-06  1.02e-03    13s
  42   4.23136470e+04  4.25763535e+04  6.93e-05 1.39e-06  8.31e-04    13s
  43   4.23213159e+04  4.25698078e+04  6.68e-05 1.23e-06  7.86e-04    13s
  44   4.23945237e+04  4.25611843e+04  4.17e-05 1.44e-06  5.27e-04    13s
  45   4.24284731e+04  4.25544474e+04  3.08e-05 2.40e-06  3.98e-04    13s
  46   4.24665848e+04  4.25470219e+04  1.91e-05 1.53e-06  2.54e-04    13s
  47   4.24961699e+04  4.25340512e+04  9.94e-06 3.16e-07  1.20e-04    14s
  48   4.25075342e+04  4.25319332e+04  6.59e-06 1.57e-07  7.72e-05    14s
  49   4.25224047e+04  4.25314272e+04  2.16e-06 1.37e-07  2.85e-05    14s
  50   4.25256328e+04  4.25308897e+04  1.24e-06 1.01e-07  1.66e-05    14s
  51   4.25260308e+04  4.25306633e+04  1.95e-06 1.30e-06  1.47e-05    14s
  52   4.25296114e+04  4.25305016e+04  3.17e-07 5.67e-07  2.82e-06    14s
  53   4.25298732e+04  4.25304801e+04  2.14e-07 4.77e-07  1.92e-06    14s
  54   4.25302277e+04  4.25304719e+04  2.64e-07 4.51e-07  7.73e-07    14s
  55   4.25303589e+04  4.25304060e+04  1.55e-08 1.54e-07  1.49e-07    14s
  56   4.25303696e+04  4.25303703e+04  1.03e-08 2.33e-10  2.12e-09    15s
  57   4.25303700e+04  4.25303700e+04  4.95e-08 4.50e-09  1.00e-10    15s

Barrier solved model in 57 iterations and 14.74 seconds (22.89 work units)
Optimal objective 4.25303700e+04


Root crossover log...

  141443 DPushes remaining with DInf 0.0000000e+00                15s
   71466 DPushes remaining with DInf 0.0000000e+00                17s
   25143 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    5308 PPushes remaining with PInf 2.3161944e-05                24s
    1660 PPushes remaining with PInf 3.3404837e-07                25s
       0 PPushes remaining with PInf 0.0000000e+00                25s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.1251398e+00     25s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   65829    4.2530370e+04   0.000000e+00   2.125140e+00     25s
   65841    4.2530370e+04   0.000000e+00   0.000000e+00     25s
   65841    4.2530370e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 6.07s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.253037e+04, 65841 iterations, 27.01 seconds (48.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42530.3700    0  384 -190754.47 42530.3700   122%     -   32s
H    0     0                    -186184.2792 42530.3700   123%     -   32s
H    0     0                    -139742.6123 42530.3700   130%     -   33s
H    0     0                    -86997.31553 42530.3700   149%     -   33s
H    0     0                    -85768.07417 42530.3700   150%     -   33s
H    0     0                    -75730.25971 42530.3700   156%     -   33s
H    0     0                    -75556.68225 42530.3700   156%     -   34s
H    0     0                    -16874.35404 42530.3700   352%     -   34s
H    0     0                    -16133.37709 42530.3700   364%     -   34s
     0     0 35335.5244    0  344 -16133.377 35335.5244   319%     -   90s
H    0     0                    -1433.479465 35335.4185  2565%     -   91s
H    0     0                    -1089.002703 35335.4185  3345%     -   92s
H    0     0                    -1029.557572 35335.4185  3532%     -   92s
H    0     0                    -996.1833948 35335.4185  3647%     -   92s
     0     0 34973.3022    0  351 -996.18339 34973.3022  3611%     -  112s
     0     0 34845.0163    0  358 -996.18339 34845.0163  3598%     -  129s
     0     0 34803.2191    0  355 -996.18339 34803.2191  3594%     -  136s
     0     0 34798.5763    0  354 -996.18339 34798.5763  3593%     -  139s
     0     0 34786.9442    0  360 -996.18339 34786.9442  3592%     -  142s
     0     0 34752.0214    0  357 -996.18339 34752.0214  3589%     -  146s
     0     0 34658.7206    0  347 -996.18339 34658.7206  3579%     -  155s
     0     0 34601.4016    0  345 -996.18339 34601.4016  3573%     -  162s
     0     0 34457.8870    0  354 -996.18339 34457.8870  3559%     -  174s
     0     0 34434.0796    0  357 -996.18339 34434.0796  3557%     -  179s
     0     0 34387.6705    0  359 -996.18339 34387.6705  3552%     -  191s
     0     0 34322.9712    0  362 -996.18339 34322.9712  3545%     -  196s
     0     0 34271.7295    0  363 -996.18339 34271.7295  3540%     -  202s
     0     0 34271.6807    0  365 -996.18339 34271.6807  3540%     -  204s
     0     0 31899.1428    0  358 -996.18339 31899.1428  3302%     -  262s
H    0     0                    7826.8645764 31899.0176   308%     -  263s
     0     0 31548.8934    0  404 7826.86458 31548.8934   303%     -  297s
     0     0 31442.2015    0  400 7826.86458 31442.2015   302%     -  321s
     0     0 31404.0496    0  414 7826.86458 31404.0496   301%     -  336s
     0     0 31359.3111    0  414 7826.86458 31359.3111   301%     -  347s
     0     0 31318.7925    0  411 7826.86458 31318.7925   300%     -  356s
     0     0 31310.2457    0  409 7826.86458 31310.2457   300%     -  359s
     0     0 31220.1607    0  404 7826.86458 31220.1607   299%     -  375s
     0     0 31191.2800    0  415 7826.86458 31191.2800   299%     -  384s
     0     0 31184.8957    0  417 7826.86458 31184.8957   298%     -  387s
     0     0 31018.3515    0  402 7826.86458 31018.3515   296%     -  405s
     0     0 30989.6698    0  408 7826.86458 30989.6698   296%     -  411s
     0     0 30950.6757    0  424 7826.86458 30950.6757   295%     -  421s
     0     0 30942.0655    0  425 7826.86458 30942.0655   295%     -  425s
     0     0 30939.8985    0  425 7826.86458 30939.8985   295%     -  429s
     0     0 30915.5887    0  428 7826.86458 30915.5887   295%     -  436s
     0     0 30896.6017    0  430 7826.86458 30896.6017   295%     -  440s
     0     0 30895.7426    0  427 7826.86458 30895.7426   295%     -  444s
     0     0 28860.1114    0  411 7826.86458 28860.1114   269%     -  519s
H    0     0                    9810.8484581 28860.0592   194%     -  520s
H    0     0                    9835.0115144 28860.0592   193%     -  520s
H    0     0                    9851.9543976 28860.0592   193%     -  520s
H    0     0                    9859.7938073 28860.0592   193%     -  520s
     0     0 28467.1202    0  433 9859.79381 28467.1202   189%     -  545s
     0     0 28317.1601    0  447 9859.79381 28317.1601   187%     -  563s
     0     0 28271.9918    0  452 9859.79381 28271.9918   187%     -  576s
     0     0 28251.2611    0  459 9859.79381 28251.2611   187%     -  582s
     0     0 28228.8727    0  451 9859.79381 28228.8727   186%     -  590s
     0     0 28226.2367    0  456 9859.79381 28226.2367   186%     -  594s
     0     0 28221.8299    0  450 9859.79381 28221.8299   186%     -  597s
     0     0 28217.7047    0  451 9859.79381 28217.7047   186%     -  601s
     0     0 28216.3080    0  463 9859.79381 28216.3080   186%     -  604s
     0     0 27651.9172    0  469 9859.79381 27651.9172   180%     -  642s
     0     0 27390.8726    0  462 9859.79381 27390.8726   178%     -  668s
     0     0 27311.8557    0  477 9859.79381 27311.8557   177%     -  685s
     0     0 27287.2580    0  489 9859.79381 27287.2580   177%     -  693s
     0     0 27267.8255    0  499 9859.79381 27267.8255   177%     -  700s
     0     0 27262.4973    0  528 9859.79381 27262.4973   177%     -  705s
     0     0 27256.5399    0  486 9859.79381 27256.5399   176%     -  708s
     0     0 27247.4864    0  493 9859.79381 27247.4864   176%     -  712s
     0     0 27235.2626    0  431 9859.79381 27235.2626   176%     -  719s
     0     0 27233.5502    0  432 9859.79381 27233.5502   176%     -  721s
     0     0 27061.5226    0  513 9859.79381 27061.5226   174%     -  748s
     0     0 27014.2428    0  522 9859.79381 27014.2428   174%     -  761s
     0     0 26994.2152    0  492 9859.79381 26994.2152   174%     -  774s
     0     0 26986.1685    0  495 9859.79381 26986.1685   174%     -  787s
     0     0 26982.6547    0  485 9859.79381 26982.6547   174%     -  792s
     0     0 26979.9309    0  516 9859.79381 26979.9309   174%     -  796s
     0     0 26962.3461    0  513 9859.79381 26962.3461   173%     -  807s
     0     0 26957.8493    0  485 9859.79381 26957.8493   173%     -  811s
     0     0 26954.4049    0  483 9859.79381 26954.4049   173%     -  818s
     0     0 26953.6567    0  481 9859.79381 26953.6567   173%     -  820s
     0     0 26874.1919    0  503 9859.79381 26874.1919   173%     -  838s
H    0     0                    10016.058955 26874.0318   168%     -  841s
H    0     0                    10040.222011 26874.0318   168%     -  841s
H    0     0                    10855.834351 26874.0318   148%     -  842s
     0     0 26836.8109    0  501 10855.8344 26836.8109   147%     -  853s
     0     0 26825.8518    0  475 10855.8344 26825.8518   147%     -  862s
     0     0 26819.5500    0  470 10855.8344 26819.5500   147%     -  868s
     0     0 26816.8625    0  499 10855.8344 26816.8625   147%     -  872s
     0     0 26815.4127    0  497 10855.8344 26815.4127   147%     -  875s
     0     0 26762.7742    0  501 10855.8344 26762.7742   147%     -  892s
H    0     0                    11065.606994 26762.5059   142%     -  893s
     0     0 26733.9249    0  458 11065.6070 26733.9249   142%     -  903s
     0     0 26716.0594    0  515 11065.6070 26716.0594   141%     -  913s
     0     0 26712.8883    0  512 11065.6070 26712.8883   141%     -  917s
     0     0 26712.1483    0  501 11065.6070 26712.1483   141%     -  919s
     0     0 26700.9787    0  463 11065.6070 26700.9787   141%     -  928s
H    0     0                    11230.835180 26700.7004   138%     -  929s
H    0     0                    11299.564591 26700.7004   136%     -  930s
H    0     0                    11362.089424 26700.7004   135%     -  930s
H    0     0                    11468.219945 26700.7004   133%     -  930s
H    0     0                    11609.350632 26700.7004   130%     -  930s
H    0     0                    11637.372000 26700.7004   129%     -  930s
     0     0 26696.2210    0  488 11637.3720 26696.2210   129%     -  937s
     0     0 26683.5832    0  490 11637.3720 26683.5832   129%     -  942s
     0     0 26675.7634    0  524 11637.3720 26675.7634   129%     -  947s
     0     0 26673.0411    0  491 11637.3720 26673.0411   129%     -  950s
     0     0 26667.5451    0  530 11637.3720 26667.5451   129%     -  954s
     0     0 26666.9940    0  524 11637.3720 26666.9940   129%     -  956s
     0     0 26663.8115    0  556 11637.3720 26663.8115   129%     -  961s
     0     0 26662.0543    0  552 11637.3720 26662.0543   129%     -  964s
     0     0 26659.6450    0  487 11637.3720 26659.6450   129%     -  969s
     0     0 26657.7176    0  530 11637.3720 26657.7176   129%     -  979s
     0     0 26655.1681    0  508 11637.3720 26655.1681   129%     -  985s
     0     0 26653.9081    0  514 11637.3720 26653.9081   129%     -  989s
     0     0 26648.4692    0  487 11637.3720 26648.4692   129%     -  996s
     0     0 26647.4244    0  515 11637.3720 26647.4244   129%     - 1001s
     0     0 26645.7289    0  486 11637.3720 26645.7289   129%     - 1008s
     0     0 26645.6681    0  486 11637.3720 26645.6681   129%     - 1015s
H    0     0                    11867.448583 26645.6681   125%     - 1215s
H    0     0                    12190.733847 26645.6681   119%     - 1221s
H    0     0                    12253.258680 26645.6681   117%     - 1225s
H    0     0                    12277.421736 26645.6681   117%     - 1225s
     0     2 26645.6681    0  486 12277.4217 26645.6681   117%     - 1227s
     1     3 26422.2893    1  443 12277.4217 26645.5436   117% 12427 1244s
     2     4 26426.2033    1  517 12277.4217 26426.2033   115% 13760 1263s
     3     6 26268.4094    2  455 12277.4217 26424.0713   115% 12351 1277s
     5    10 26226.3110    3  466 12277.4217 26424.0713   115% 11402 1304s
     9    19 25817.4256    4  526 12277.4217 26266.8621   114% 12274 1341s
    18    36 25698.6054    5  507 12277.4217 26225.8548   114% 13548 1395s
    35    49 25097.6701    6  476 12277.4217 25943.2639   111% 25615 1505s
H   48    75                    12280.534426 25943.2639   111% 23933 1594s
H   49    75                    12315.335345 25943.2639   111% 23906 1594s
H   51    75                    12323.908807 25943.2639   111% 23269 1594s
    74   158 22833.3144    6  297 12323.9088 25758.2069   109% 19245 1680s
H  157   190                    12989.949588 25758.2069  98.3% 12084 1728s
   189   286 22632.4659    8  296 12989.9496 25758.2069  98.3% 11206 1778s
   285   349 22492.4731   13  324 12989.9496 25758.2069  98.3%  8945 1816s
   348   407 22368.1846    8  280 12989.9496 25758.2069  98.3%  8718 1857s
   406   444 22230.1546    9  292 12989.9496 25758.2069  98.3%  8173 1897s
   459   478 21975.9731   14  334 12989.9496 25758.2069  98.3%  7950 1929s
   505   525 21305.2509   10  282 12989.9496 25758.2069  98.3%  8294 1972s
   560   570 19818.4574   11  236 12989.9496 25758.2069  98.3%  8054 2009s
   607   612 19659.3337   12  181 12989.9496 25758.2069  98.3%  7782 2048s
   673   652 19560.2276   13  223 12989.9496 25758.2069  98.3%  7355 2083s
   753   704 19549.0689   14  176 12989.9496 25758.2069  98.3%  6973 2118s
   831   777     cutoff   40      12989.9496 25758.2069  98.3%  6671 2150s
   926   862 18813.2788   17  236 12989.9496 25758.2069  98.3%  6308 2183s
  1027   921 18014.9723   18  215 12989.9496 25758.2069  98.3%  5973 2218s
  1138  1012 17943.5380   19  216 12989.9496 25758.2069  98.3%  5645 2252s
  1267  1106 16922.1537   20  215 12989.9496 25758.2069  98.3%  5355 2284s
  1391  1188 16693.0526   22  210 12989.9496 25758.2069  98.3%  5079 2320s
  1541  1265 16494.8043   28  214 12989.9496 25758.2069  98.3%  4827 2355s
  1703  1356 15993.3576   30  256 12989.9496 25758.2069  98.3%  4634 2390s
  1884  1425 15689.2754   34  241 12989.9496 25758.2069  98.3%  4402 2429s
  2043  1571 15642.9622   35  243 12989.9496 25758.2069  98.3%  4209 2465s
H 2159  1571                    13322.179061 25758.2069  93.3%  4095 2465s
  2256  1643 15507.2041   36  235 13322.1791 25758.2069  93.3%  4013 2507s
  2460  1672 14874.2090   41  133 13322.1791 25758.2069  93.3%  3858 2550s
  2585  1685     cutoff   52      13322.1791 25758.2069  93.3%  3829 2597s
  2656  1708 infeasible   67      13322.1791 25757.8600  93.3%  3867 2652s
  2717  1740 25312.2339    7  482 13322.1791 25757.8600  93.3%  3904 2717s
  2779  1754 15701.4709   36  319 13322.1791 25757.8600  93.3%  3950 2778s
  2826  1767 infeasible   34      13322.1791 25757.8600  93.3%  4006 2834s
  2881  1779 13437.5626   72   79 13322.1791 25757.8600  93.3%  4050 2914s
  2915  1788 infeasible   73      13322.1791 25757.8600  93.3%  4093 3008s
H 2922  1699                    14127.946643 25757.8600  82.3%  4095 3008s
  2960  1758 21412.9213   13  363 14127.9466 25757.8600  82.3%  4145 3067s
  3058  1754 20843.5234   16  376 14127.9466 25757.8600  82.3%  4180 3125s
  3173  1797     cutoff   56      14127.9466 25757.8600  82.3%  4170 3184s
  3276  1805 19980.0035   16  284 14127.9466 25757.8600  82.3%  4166 3262s
  3314  1841 18571.9906   17  227 14127.9466 25564.6521  81.0%  4202 3372s
H 3367  1841                    14146.047319 25348.6407  79.2%  4234 3372s
H 3375  1832                    14204.652075 25348.6407  78.5%  4242 3372s
  3378  1851     cutoff   18      14204.6521 25348.6407  78.5%  4250 3426s
  3417  1875     cutoff   25      14204.6521 25348.6407  78.5%  4316 3489s
H 3429  1762                    14588.434634 25348.6407  73.8%  4333 3489s
  3453  1814 24078.4403    6  421 14588.4346 25348.6407  73.8%  4369 3556s
  3551  1856 23623.7152    8  444 14588.4346 25348.6407  73.8%  4425 3600s

Cutting planes:
  Learned: 4
  Gomory: 2
  Implied bound: 151
  MIR: 4621
  Flow cover: 4209
  Zero half: 1
  RLT: 116
  Relax-and-lift: 733

Explored 3631 nodes (16935139 simplex iterations) in 3600.11 seconds (7919.70 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14588.4 14204.7 14146 ... 12277.4

Time limit reached
Best objective 1.458843463397e+04, best bound 2.534864066063e+04, gap 73.7585%
  WARNING: Time limit reached. Using best solution found (gap: 73.76%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 14588.43, θ = 158118.21
  Upper Bound (UB) = 14588.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 158118.21
  [DEBUG]   ✓ Scenario 0: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 158118.21 ≤ Q = 158118.21 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2530ad3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x02530ad3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.324754e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6633703.2346
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.465535e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146553.47    0  122 6633703.23 -146553.47   102%     -    0s
H    0     0                    -100531.8540 -146553.47  45.8%     -    0s
H    0     0                    -109498.4346 -146553.47  33.8%     -    0s
H    0     0                    -109709.7087 -146553.47  33.6%     -    0s
     0     0 -121709.29    0   30 -109709.71 -121709.29  10.9%     -    0s
H    0     0                    -120559.1144 -121684.27  0.93%     -    0s
H    0     0                    -120846.3716 -121684.27  0.69%     -    0s
H    0     0                    -121092.8182 -121684.27  0.49%     -    0s
     0     0 -121392.66    0   19 -121092.82 -121392.66  0.25%     -    0s
     0     0 -121340.04    0   13 -121092.82 -121340.04  0.20%     -    0s
     0     0 -121294.41    0   13 -121092.82 -121294.41  0.17%     -    0s
     0     0 -121292.48    0   13 -121092.82 -121292.48  0.16%     -    0s
H    0     0                    -121158.0563 -121292.48  0.11%     -    0s
H    0     0                    -121229.5078 -121292.48  0.05%     -    0s
     0     0 -121243.65    0    4 -121229.51 -121243.65  0.01%     -    0s
     0     0 -121243.65    0    8 -121229.51 -121243.65  0.01%     -    0s
*    0     0               0    -121230.1427 -121230.14  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 4
  MIR: 8
  RLT: 2

Explored 1 nodes (493 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -121230 -121230 -121158 ... -100532
No other solutions better than -121230

Optimal solution found (tolerance 1.00e-06)
Best objective -1.212301426510e+05, best bound -1.212301426510e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 151353.25
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121230.14
  [DEBUG]   S×d_nominal = 272583.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272583.40 + -121230.14 = 151353.25
  [DEBUG]   Current θ from Master = 158118.21
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6764.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7823.48
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 1998.6729, Absolute Gap = 1998.6729, Relative Gap = 0.137004
  Not converged yet (gap = 1998.67 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913622 nonzeros
Model fingerprint: 0x0e548221
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 140126 rows and 56896 columns
Presolve time: 4.18s
Presolved: 182347 rows, 76404 columns, 1122919 nonzeros
Variable types: 74145 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.46s

Barrier statistics:
 Dense cols : 1202
 AA' NZ     : 4.334e+06
 Factor NZ  : 1.226e+07 (roughly 200 MB of memory)
 Factor Ops : 4.357e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.19412617e+07  2.94687073e+08  1.35e+05 1.38e+01  9.00e+04     7s
   1  -1.69297376e+07  2.69353691e+08  9.54e+04 5.54e+01  6.33e+04     8s
   2  -6.96918099e+06  2.05264927e+08  3.86e+04 4.82e+00  2.73e+04     8s
   3  -1.11170256e+06  1.63286304e+08  2.93e+03 3.08e+00  2.47e+03     8s
   4  -5.96783991e+05  1.27611149e+08  7.18e+02 2.03e+00  8.52e+02     8s
   5  -4.81370477e+05  7.05422911e+07  3.22e+02 9.43e-01  4.03e+02     8s
   6  -4.14406891e+05  5.25078478e+07  1.33e+02 6.61e-01  2.32e+02     8s
   7  -3.85726455e+05  4.02937046e+07  7.81e+01 4.86e-01  1.61e+02     8s
   8  -3.17587586e+05  2.88929042e+07  1.04e+01 3.36e-01  9.25e+01     8s
   9  -2.22986360e+05  1.53546933e+07  1.61e+00 1.76e-01  4.73e+01     8s
  10  -1.40182728e+05  4.31018635e+06  5.07e-01 4.72e-02  1.34e+01     8s
  11  -1.01036639e+05  3.14156443e+06  3.09e-01 3.37e-02  9.79e+00     8s
  12  -8.11459332e+04  2.24526720e+06  2.08e-01 2.42e-02  7.02e+00     9s
  13  -6.25566105e+04  1.42901733e+06  1.27e-01 1.52e-02  4.50e+00     9s
  14  -3.01152255e+04  4.03674073e+05  5.05e-02 3.89e-03  1.31e+00     9s
  15  -6.61446112e+03  2.60702456e+05  2.93e-02 2.42e-03  8.05e-01     9s
  16   6.06682183e+02  1.76308408e+05  2.36e-02 1.64e-03  5.29e-01     9s
  17   5.90236453e+03  1.44444696e+05  2.02e-02 1.25e-03  4.17e-01     9s
  18   1.44534268e+04  1.16668380e+05  1.46e-02 9.05e-04  3.08e-01     9s
  19   2.12195354e+04  8.59613354e+04  1.03e-02 6.56e-04  1.95e-01     9s
  20   2.37702174e+04  7.42741130e+04  8.83e-03 4.85e-04  1.52e-01     9s
  21   2.70936675e+04  6.52252876e+04  7.09e-03 3.45e-04  1.15e-01    10s
  22   3.04351324e+04  6.00779763e+04  5.39e-03 2.79e-04  8.93e-02    10s
  23   3.23145899e+04  5.68920378e+04  4.42e-03 2.30e-04  7.40e-02    10s
  24   3.45563742e+04  5.25571502e+04  3.36e-03 2.36e-04  5.42e-02    10s
  25   3.57913546e+04  4.94373858e+04  2.80e-03 1.63e-04  4.11e-02    10s
  26   3.74671138e+04  4.73222841e+04  2.07e-03 1.11e-04  2.97e-02    10s
  27   3.81507040e+04  4.64783310e+04  1.78e-03 9.04e-05  2.51e-02    10s
  28   3.90469874e+04  4.50310024e+04  1.40e-03 5.53e-05  1.80e-02    11s
  29   3.98717783e+04  4.41868834e+04  1.06e-03 3.50e-05  1.30e-02    11s
  30   4.02177485e+04  4.38522096e+04  9.18e-04 2.73e-05  1.10e-02    11s
  31   4.06129145e+04  4.35759388e+04  7.64e-04 2.08e-05  8.93e-03    11s
  32   4.08690193e+04  4.33554648e+04  6.62e-04 1.58e-05  7.49e-03    11s
  33   4.11858043e+04  4.32806530e+04  5.42e-04 1.41e-05  6.31e-03    11s
  34   4.14112875e+04  4.30113618e+04  4.56e-04 8.13e-06  4.82e-03    11s
  35   4.16194258e+04  4.29966712e+04  3.79e-04 7.75e-06  4.15e-03    11s
  36   4.17291168e+04  4.28810538e+04  3.39e-04 5.30e-06  3.47e-03    12s
  37   4.19764155e+04  4.28549101e+04  2.49e-04 4.62e-06  2.65e-03    12s
  38   4.21481239e+04  4.28180465e+04  1.83e-04 3.75e-06  2.02e-03    12s
  39   4.22065875e+04  4.27430993e+04  1.61e-04 2.05e-06  1.62e-03    12s
  40   4.22671552e+04  4.27312644e+04  1.38e-04 1.78e-06  1.40e-03    12s
  41   4.23022881e+04  4.27119781e+04  1.25e-04 1.35e-06  1.23e-03    12s
  42   4.23458961e+04  4.27102708e+04  1.09e-04 1.31e-06  1.10e-03    12s
  43   4.23911307e+04  4.27083472e+04  9.25e-05 1.27e-06  9.56e-04    13s
  44   4.24223791e+04  4.27017681e+04  8.09e-05 1.12e-06  8.42e-04    13s
  45   4.24385667e+04  4.26937175e+04  7.49e-05 9.30e-07  7.69e-04    13s
  46   4.24788016e+04  4.26817043e+04  5.99e-05 6.85e-07  6.12e-04    13s
  47   4.25551828e+04  4.26732769e+04  3.17e-05 5.02e-07  3.56e-04    13s
  48   4.25652831e+04  4.26667957e+04  2.81e-05 3.61e-07  3.06e-04    13s
  49   4.25864527e+04  4.26563394e+04  2.07e-05 1.88e-07  2.11e-04    13s
  50   4.26233383e+04  4.26494856e+04  8.19e-06 2.50e-07  7.88e-05    14s
  51   4.26256984e+04  4.26492974e+04  7.36e-06 2.20e-07  7.11e-05    14s
  52   4.26442072e+04  4.26490598e+04  1.05e-06 1.87e-07  1.46e-05    14s
  53   4.26474712e+04  4.26478715e+04  9.32e-08 5.48e-08  1.21e-06    14s
  54   4.26477668e+04  4.26478094e+04  6.48e-08 3.04e-10  1.28e-07    14s
  55   4.26478023e+04  4.26478093e+04  3.38e-06 7.87e-10  2.14e-08    14s
  56   4.26478048e+04  4.26478093e+04  2.14e-06 1.10e-07  1.36e-08    14s
  57   4.26478070e+04  4.26478093e+04  1.09e-06 9.36e-08  6.92e-09    14s
  58   4.26478076e+04  4.26478093e+04  1.54e-06 8.19e-08  5.01e-09    14s
  59   4.26478076e+04  4.26478093e+04  5.30e-06 4.68e-07  5.01e-09    15s
  60   4.26478076e+04  4.26478093e+04  5.30e-06 4.51e-07  5.06e-09    15s
  61   4.26478078e+04  4.26478096e+04  4.69e-06 1.83e-07  5.48e-09    15s
  62   4.26478087e+04  4.26478093e+04  1.75e-06 1.16e-07  1.72e-09    15s
  63   4.26478093e+04  4.26478093e+04  1.10e-08 9.89e-08  1.07e-11    15s

Barrier solved model in 63 iterations and 15.01 seconds (20.57 work units)
Optimal objective 4.26478093e+04


Root crossover log...

  147926 DPushes remaining with DInf 0.0000000e+00                15s
   13209 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                22s

    4105 PPushes remaining with PInf 3.0506301e-06                23s
       0 PPushes remaining with PInf 0.0000000e+00                23s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5783221e-01     23s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62953    4.2647809e+04   0.000000e+00   1.578322e-01     23s
   62954    4.2647809e+04   0.000000e+00   0.000000e+00     23s
   62954    4.2647809e+04   0.000000e+00   0.000000e+00     23s
Concurrent spin time: 2.13s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.264781e+04, 62954 iterations, 20.08 seconds (36.63 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42647.8093    0  382 -190754.47 42647.8093   122%     -   26s
H    0     0                    -186184.2792 42647.8093   123%     -   26s
H    0     0                    -177698.1159 42647.8093   124%     -   27s
H    0     0                    -175608.0329 42647.8093   124%     -   27s
H    0     0                    -175241.9727 42647.8093   124%     -   27s
H    0     0                    -157434.6410 42647.8093   127%     -   27s
H    0     0                    -157350.4834 42647.8093   127%     -   27s
H    0     0                    -157141.3452 42647.8093   127%     -   27s
H    0     0                    -72743.84915 42647.8093   159%     -   27s
H    0     0                    -72570.27169 42647.8093   159%     -   27s
H    0     0                    -37406.92781 42647.8093   214%     -   28s
H    0     0                    -7127.353481 42647.8093   698%     -   28s
H    0     0                    -6442.201669 42647.8093   762%     -   28s
H    0     0                    -5031.427402 42647.8093   948%     -   28s
H    0     0                    -3319.508380 42647.8093  1385%     -   28s
H    0     0                    -3072.682956 42647.8093  1488%     -   28s
H    0     0                    -2454.955203 42647.8093  1837%     -   28s
     0     0 35292.4127    0  343 -2454.9552 35292.4127  1538%     -   89s
H    0     0                    2799.7938199 35290.5530  1160%     -   90s
H    0     0                    4039.5049568 35290.5530   774%     -   90s
H    0     0                    4074.3650999 35290.5530   766%     -   90s
H    0     0                    4195.8832945 35290.5530   741%     -   90s
     0     0 35116.3295    0  367 4195.88329 35116.3295   737%     -  105s
     0     0 35067.0035    0  348 4195.88329 35067.0035   736%     -  111s
     0     0 35054.8664    0  347 4195.88329 35054.8664   735%     -  117s
     0     0 35043.8590    0  350 4195.88329 35043.8590   735%     -  125s
     0     0 34963.1336    0  335 4195.88329 34963.1336   733%     -  132s
     0     0 34909.4467    0  355 4195.88329 34909.4467   732%     -  138s
     0     0 34812.9603    0  346 4195.88329 34812.9603   730%     -  145s
     0     0 34758.9747    0  340 4195.88329 34758.9747   728%     -  152s
     0     0 34746.0872    0  351 4195.88329 34746.0872   728%     -  155s
     0     0 34745.2392    0  344 4195.88329 34745.2392   728%     -  156s
     0     0 32062.6702    0  420 4195.88329 32062.6702   664%     -  220s
H    0     0                    5428.4062022 32062.1253   491%     -  220s
H    0     0                    6185.9247766 32062.1253   418%     -  220s
     0     0 31719.5121    0  441 6185.92478 31719.5121   413%     -  248s
     0     0 31664.2560    0  442 6185.92478 31664.2560   412%     -  259s
     0     0 31575.3040    0  441 6185.92478 31575.3040   410%     -  271s
     0     0 31549.1481    0  449 6185.92478 31549.1481   410%     -  280s
     0     0 31501.3552    0  426 6185.92478 31501.3552   409%     -  291s
     0     0 31478.8986    0  453 6185.92478 31478.8986   409%     -  299s
     0     0 31418.7938    0  454 6185.92478 31418.7938   408%     -  308s
     0     0 31387.5658    0  447 6185.92478 31387.5658   407%     -  314s
     0     0 31245.0473    0  453 6185.92478 31245.0473   405%     -  329s
     0     0 31220.0565    0  454 6185.92478 31220.0565   405%     -  336s
     0     0 31085.3501    0  450 6185.92478 31085.3501   403%     -  353s
     0     0 31008.8972    0  444 6185.92478 31008.8972   401%     -  362s
     0     0 30998.7174    0  448 6185.92478 30998.7174   401%     -  370s
     0     0 30991.5386    0  446 6185.92478 30991.5386   401%     -  375s
     0     0 30988.4011    0  450 6185.92478 30988.4011   401%     -  378s
     0     0 30987.0549    0  457 6185.92478 30987.0549   401%     -  380s
     0     0 30984.4050    0  469 6185.92478 30984.4050   401%     -  383s
     0     0 30974.4499    0  462 6185.92478 30974.4499   401%     -  387s
     0     0 30949.3707    0  464 6185.92478 30949.3707   400%     -  394s
     0     0 30942.9893    0  472 6185.92478 30942.9893   400%     -  398s
     0     0 30909.2577    0  468 6185.92478 30909.2577   400%     -  404s
     0     0 30903.5787    0  471 6185.92478 30903.5787   400%     -  408s
     0     0 30895.3776    0  468 6185.92478 30895.3776   399%     -  411s
     0     0 30874.7876    0  463 6185.92478 30874.7876   399%     -  418s
     0     0 30869.5565    0  469 6185.92478 30869.5565   399%     -  422s
     0     0 30868.1109    0  473 6185.92478 30868.1109   399%     -  424s
     0     0 30867.7898    0  470 6185.92478 30867.7898   399%     -  425s
     0     0 28874.9302    0  433 6185.92478 28874.9302   367%     -  501s
H    0     0                    6583.7129283 28874.8984   339%     -  502s
H    0     0                    6833.2373914 28874.8984   323%     -  502s
     0     0 28373.1509    0  441 6833.23739 28373.1509   315%     -  532s
     0     0 28246.0773    0  455 6833.23739 28246.0773   313%     -  547s
     0     0 28207.9119    0  454 6833.23739 28207.9119   313%     -  558s
     0     0 28187.7790    0  458 6833.23739 28187.7790   313%     -  566s
     0     0 28165.4894    0  452 6833.23739 28165.4894   312%     -  572s
     0     0 28152.9603    0  453 6833.23739 28152.9603   312%     -  577s
     0     0 28141.3231    0  469 6833.23739 28141.3231   312%     -  581s
     0     0 28133.0613    0  470 6833.23739 28133.0613   312%     -  585s
     0     0 28131.3238    0  474 6833.23739 28131.3238   312%     -  587s
     0     0 27321.7345    0  474 6833.23739 27321.7345   300%     -  646s
H    0     0                    8225.0409041 27321.6472   232%     -  648s
     0     0 27214.6741    0  495 8225.04090 27214.6741   231%     -  666s
     0     0 27146.8390    0  491 8225.04090 27146.8390   230%     -  679s
     0     0 27118.7482    0  486 8225.04090 27118.7482   230%     -  690s
     0     0 27114.0531    0  480 8225.04090 27114.0531   230%     -  696s
     0     0 27106.5111    0  476 8225.04090 27106.5111   230%     -  702s
     0     0 27084.8404    0  481 8225.04090 27084.8404   229%     -  710s
     0     0 27078.9907    0  485 8225.04090 27078.9907   229%     -  716s
     0     0 27075.7624    0  475 8225.04090 27075.7624   229%     -  719s
     0     0 27056.5797    0  483 8225.04090 27056.5797   229%     -  726s
     0     0 27041.6897    0  482 8225.04090 27041.6897   229%     -  731s
     0     0 27040.0061    0  491 8225.04090 27040.0061   229%     -  735s
     0     0 26924.0440    0  499 8225.04090 26924.0440   227%     -  760s
     0     0 26882.0805    0  486 8225.04090 26882.0805   227%     -  773s
     0     0 26860.7613    0  494 8225.04090 26860.7613   227%     -  783s
     0     0 26850.2066    0  512 8225.04090 26850.2066   226%     -  790s
     0     0 26838.1903    0  500 8225.04090 26838.1903   226%     -  795s
     0     0 26832.4632    0  502 8225.04090 26832.4632   226%     -  800s
     0     0 26830.0547    0  508 8225.04090 26830.0547   226%     -  802s
     0     0 26826.6682    0  508 8225.04090 26826.6682   226%     -  804s
     0     0 26826.2475    0  512 8225.04090 26826.2475   226%     -  806s
     0     0 26786.8969    0  457 8225.04090 26786.8969   226%     -  818s
H    0     0                    8366.5390970 26786.5600   220%     -  865s
H    0     0                    9104.9401156 26786.5600   194%     -  881s
H    0     0                    9230.3005694 26786.5600   190%     -  881s
H    0     0                    9916.3216282 26786.5600   170%     -  885s
H    0     0                    10054.939735 26786.5600   166%     -  885s
H    0     0                    10477.635646 26786.5600   156%     -  885s
H    0     0                    11351.477274 26786.5600   136%     -  896s
     0     0 26776.3884    0  488 11351.4773 26776.3884   136%     -  905s
     0     0 26771.8650    0  481 11351.4773 26771.8650   136%     -  910s
     0     0 26764.2889    0  499 11351.4773 26764.2889   136%     -  918s
     0     0 26761.9307    0  493 11351.4773 26761.9307   136%     -  922s
     0     0 26761.1412    0  488 11351.4773 26761.1412   136%     -  924s
     0     0 26746.5364    0  497 11351.4773 26746.5364   136%     -  934s
H    0     0                    11429.293818 26746.1765   134%     -  936s
H    0     0                    11548.948421 26746.1765   132%     -  936s
     0     0 26734.8256    0  497 11548.9484 26734.8256   131%     -  941s
     0     0 26733.3011    0  488 11548.9484 26733.3011   131%     -  945s
     0     0 26731.3355    0  489 11548.9484 26731.3355   131%     -  951s
     0     0 26729.7912    0  485 11548.9484 26729.7912   131%     -  954s
     0     0 26725.9676    0  489 11548.9484 26725.9676   131%     -  961s
H    0     0                    11618.669264 26725.7477   130%     -  962s
     0     0 26717.2520    0  476 11618.6693 26717.2520   130%     -  970s
     0     0 26715.8013    0  478 11618.6693 26715.8013   130%     -  973s
     0     0 26706.9760    0  479 11618.6693 26706.9760   130%     -  982s
     0     0 26706.4409    0  479 11618.6693 26706.4409   130%     -  990s
H    0     0                    11720.120860 26706.4409   128%     - 1078s
H    0     0                    11900.307191 26706.4409   124%     - 1078s
H    0     0                    11907.754310 26706.4409   124%     - 1078s
H    0     0                    11911.574179 26706.4409   124%     - 1169s
H    0     0                    11926.802265 26706.4409   124%     - 1178s
H    0     0                    12041.161157 26706.4409   122%     - 1183s
     0     2 26706.4409    0  479 12041.1612 26706.4409   122%     - 1189s
     1     3 26102.9291    1  425 12041.1612 26706.4409   122% 16331 1215s
     2     4 26439.2371    1  514 12041.1612 26439.2371   120% 16558 1238s
     3     5 25254.3901    2  496 12041.1612 26438.8627   120% 19360 1275s
     4     6 24694.4838    2  479 12041.1612 26438.8627   120% 19800 1310s
     5    11 25937.0423    2  529 12041.1612 26438.2737   120% 16201 1335s
    10    21 25659.8595    3  472 12041.1612 25936.7440   115% 14928 1379s
    20    31 23667.0841    4  379 12041.1612 25936.7440   115% 19350 1491s
    30    61 24382.5435    6  527 12041.1612 25659.8584   113% 19212 1819s
H   32    61                    12108.141781 25659.8584   112% 18349 1819s
H   41    61                    12133.374205 25659.8584   111% 17176 1819s
    60    93 23780.6733    7  439 12133.3742 25659.8584   111% 32077 1861s
    92   125 23665.2400    8  452 12133.3742 25659.8584   111% 27054 1902s
H  104   125                    12431.539184 25659.8584   106% 25347 1902s
H  106   125                    13336.062150 25659.8584  92.4% 25222 1902s
   124   209 23622.0585    9  399 13336.0621 25659.8584  92.4% 23071 1974s
H  163   209                    13371.059611 25659.8584  91.9% 19071 1974s
   208   275 23597.0581   10  393 13371.0596 25659.8584  91.9% 16383 2020s
   274   323 23542.2880   13  383 13371.0596 25659.8584  91.9% 14469 2058s
   322   375 23435.6464   12  393 13371.0596 25659.8584  91.9% 13476 2098s
   374   403 23473.3289   15  384 13371.0596 25659.8584  91.9% 12805 2150s
   402   436 23381.2583   15  480 13371.0596 25659.8584  91.9% 12718 2237s
   435   475 22892.9750   16  224 13371.0596 25659.8584  91.9% 12657 2294s
   476   510 23355.9710   16  417 13371.0596 25659.8584  91.9% 12358 2354s
   511   550 22767.4973   16  218 13371.0596 25659.8584  91.9% 12240 2384s
   553   576 23273.4189   16  463 13371.0596 25659.8584  91.9% 11994 2419s
   595   609 22649.5152   17  430 13371.0596 25659.8584  91.9% 12114 2452s
   634   648 21220.0613   17  384 13371.0596 25659.8584  91.9% 12211 2489s
   679   673 19814.0266   27  335 13371.0596 25659.8584  91.9% 12466 2521s
   716   713 22705.5431   17  287 13371.0596 25659.8584  91.9% 12422 2561s
   761   736 17994.4915   29  276 13371.0596 25659.8584  91.9% 12414 2599s
   804   775 22197.2679   17  214 13371.0596 25659.8584  91.9% 12257 2637s
   857   820 22491.3030   17  237 13371.0596 25659.8584  91.9% 12195 2677s
   910   875 22224.1112   18  432 13371.0596 25659.8584  91.9% 12188 2714s
   971   913 21670.5291   18  300 13371.0596 25659.8584  91.9% 12142 2748s
  1025   970 19615.3904   18  215 13371.0596 25659.8584  91.9% 12059 2783s
  1094  1030 20824.9622   19  244 13371.0596 25659.8584  91.9% 11785 2827s
  1171  1069 22107.2605   19  439 13371.0596 25659.8584  91.9% 11699 2868s
H 1177  1069                    13498.594168 25659.8584  90.1% 11694 2868s
  1232  1161 20353.6098   18  416 13498.5942 25659.8584  90.1% 11572 2913s
  1348  1276 21233.9352   21  411 13498.5942 25521.8489  89.1% 11326 2969s
  1486  1394 21126.8517   23  385 13498.5942 25521.8489  89.1% 10990 3014s
  1636  1501 20990.7830   26  346 13498.5942 25521.8489  89.1% 10678 3062s
  1781  1625 18597.2744   30  135 13498.5942 25521.7256  89.1% 10408 3110s
  1954  1719 14395.4019   28  260 13498.5942 25521.7256  89.1% 10127 3163s
  2115  1822 infeasible   30      13498.5942 25521.7256  89.1% 10020 3218s
  2256  1845 19977.1241   34  156 13498.5942 25033.5287  85.5% 10029 3263s
H 2272  1845                    13588.194895 25024.0064  84.2% 10063 3263s
H 2280  1841                    13647.603347 25024.0064  83.4% 10081 3263s
  2293  1906 18529.6561   35  244 13647.6033 25024.0064  83.4% 10104 3309s
H 2294  1876                    13944.538286 25024.0064  79.5% 10099 3309s
  2388  1969 18655.1380   35  223 13944.5383 24994.8495  79.2% 10115 3364s
  2553  2094 18121.1721   37  259 13944.5383 24994.7375  79.2% 10112 3420s
  2736  2225 18082.7844   40  135 13944.5383 24994.7375  79.2% 10019 3479s
  2942  2415 15993.6301   45  118 13944.5383 24994.7375  79.2%  9903 3541s
  3178  2512 15486.9510   49   99 13944.5383 24994.7375  79.2%  9715 3600s

Cutting planes:
  Learned: 1
  Gomory: 7
  Implied bound: 233
  MIR: 3965
  Flow cover: 3807
  Zero half: 1
  RLT: 130
  Relax-and-lift: 766

Explored 3331 nodes (32877999 simplex iterations) in 3600.11 seconds (8743.41 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13944.5 13647.6 13588.2 ... 12041.2

Time limit reached
Best objective 1.394453828642e+04, best bound 2.499473749981e+04, gap 79.2439%
  WARNING: Time limit reached. Using best solution found (gap: 79.24%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 13944.54, θ = 158056.52
  Upper Bound (UB) = 13944.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 158056.52
  [DEBUG]   ✓ Scenario 0: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 158056.52 ≤ Q = 158056.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 18: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 158056.52 ≤ Q = 158056.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x27487e80
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd8b78180
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.318727e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6608276.9249
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.466569e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146656.92    0  122 6608276.92 -146656.92   102%     -    0s
H    0     0                    -102271.4609 -146656.92  43.4%     -    0s
H    0     0                    -111431.9482 -146656.92  31.6%     -    0s
H    0     0                    -111884.4199 -146656.92  31.1%     -    0s
H    0     0                    -112509.8656 -146450.93  30.2%     -    0s
     0     0 -121649.22    0  106 -112509.87 -121649.22  8.12%     -    0s
H    0     0                    -119969.8666 -121646.33  1.40%     -    0s
H    0     0                    -120233.9088 -121646.33  1.17%     -    0s
     0     0 -120859.74    0   57 -120233.91 -120859.74  0.52%     -    0s
     0     0 -120835.38    0   54 -120233.91 -120835.38  0.50%     -    0s
     0     0 -120829.31    0   54 -120233.91 -120829.31  0.50%     -    0s
     0     0 -120640.03    0   40 -120233.91 -120640.03  0.34%     -    0s
     0     0 -120571.29    0   29 -120233.91 -120571.29  0.28%     -    0s
     0     0 -120567.35    0   27 -120233.91 -120567.35  0.28%     -    0s
     0     0 -120555.32    0   30 -120233.91 -120555.32  0.27%     -    0s
     0     0 -120551.79    0   27 -120233.91 -120551.79  0.26%     -    0s
     0     0 -120472.02    0   20 -120233.91 -120472.02  0.20%     -    0s
     0     0 -120469.43    0   19 -120233.91 -120469.43  0.20%     -    0s
     0     0 -120456.17    0   19 -120233.91 -120456.17  0.18%     -    0s
     0     0 -120418.21    0   18 -120233.91 -120418.21  0.15%     -    0s
     0     0 -120418.21    0   60 -120233.91 -120418.21  0.15%     -    0s
H    0     0                    -120240.1310 -120418.21  0.15%     -    0s
     0     0 -120352.80    0   17 -120240.13 -120352.80  0.09%     -    0s
H    0     0                    -120303.4975 -120350.44  0.04%     -    0s
     0     0 -120303.88    0    8 -120303.50 -120303.88  0.00%     -    0s
     0     0     cutoff    0      -120303.50 -120303.50  0.00%     -    0s

Cutting planes:
  Gomory: 11
  Implied bound: 13
  MIR: 38
  Flow cover: 17

Explored 1 nodes (919 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120303 -120240 -120234 ... -102271
No other solutions better than -120303

Optimal solution found (tolerance 1.00e-06)
Best objective -1.203034975350e+05, best bound -1.203034975350e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 152557.32
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120303.50
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -120303.50 = 152557.32
  [DEBUG]   Current θ from Master = 158056.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5499.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8445.34
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 1354.7766, Absolute Gap = 1354.7766, Relative Gap = 0.097155
  Not converged yet (gap = 1354.78 > ε = 200)

  [DEBUG] Adding NEW scenario 21 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 21 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 21 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 21]
    [DEBUG]   - Total constraints in model: 337763
    [DEBUG]   - Total variables in model: 139540
  [DEBUG] Total scenarios in Master: 22
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 22
================================================================================
[Iteration 22] Solving Master Problem...
  Current scenarios in Master: 22
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 337763 rows, 139540 columns and 956865 nonzeros
Model fingerprint: 0x677548c9
Variable types: 137281 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 146792 rows and 59602 columns
Presolve time: 4.26s
Presolved: 190971 rows, 79938 columns, 1175845 nonzeros
Variable types: 77679 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339222.7835
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.66s

Barrier statistics:
 Dense cols : 1201
 AA' NZ     : 4.672e+06
 Factor NZ  : 1.317e+07 (roughly 200 MB of memory)
 Factor Ops : 4.727e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.27550866e+07  3.07062909e+08  1.40e+05 1.35e+01  9.28e+04     8s
   1  -1.75923075e+07  2.82015522e+08  9.92e+04 5.52e+01  6.55e+04     8s
   2  -7.31797789e+06  2.15130478e+08  4.06e+04 7.64e+00  2.86e+04     8s
   3  -2.21783619e+06  1.97830254e+08  8.53e+03 4.68e+00  6.39e+03     8s
   4  -8.66666304e+05  1.61226805e+08  1.29e+03 2.66e+00  1.33e+03     8s
   5  -6.97135229e+05  7.42569415e+07  9.91e+02 8.19e-01  8.04e+02     8s
   6  -5.94439442e+05  5.60720872e+07  6.26e+02 5.46e-01  5.20e+02     8s
   7  -4.35809300e+05  4.26645414e+07  1.88e+02 3.66e-01  2.27e+02     9s
   8  -3.76575077e+05  2.88430417e+07  8.36e+01 2.17e-01  1.25e+02     9s
   9  -2.43153095e+05  1.98440362e+07  4.80e+00 1.38e-01  5.97e+01     9s
  10  -1.46458719e+05  1.02606002e+07  1.02e+00 6.97e-02  3.02e+01     9s
  11  -1.24492062e+05  6.97310998e+06  7.31e-01 4.68e-02  2.05e+01     9s
  12  -1.00543780e+05  4.32573038e+06  4.33e-01 2.85e-02  1.28e+01     9s
  13  -8.61561928e+04  2.89986005e+06  2.75e-01 1.88e-02  8.61e+00     9s
  14  -6.18300215e+04  1.40129624e+06  1.17e-01 9.41e-03  4.21e+00     9s
  15  -3.62392378e+04  4.53484514e+05  5.71e-02 3.01e-03  1.41e+00     9s
  16  -5.49782670e+03  2.26678714e+05  2.23e-02 1.96e-03  6.68e-01     9s
  17   8.84255390e+02  1.63375510e+05  1.80e-02 1.31e-03  4.68e-01    10s
  18   7.85233774e+03  1.33671679e+05  1.46e-02 9.75e-04  3.62e-01    10s
  19   1.37003718e+04  1.03873844e+05  1.16e-02 5.71e-04  2.59e-01    10s
  20   1.89192791e+04  8.57559760e+04  9.16e-03 6.62e-04  1.92e-01    10s
  21   2.23960756e+04  7.24259600e+04  7.61e-03 5.16e-04  1.44e-01    10s
  22   2.65052351e+04  6.53681896e+04  5.77e-03 3.96e-04  1.12e-01    10s
  23   2.85421533e+04  6.02740208e+04  4.94e-03 2.98e-04  9.13e-02    10s
  24   3.08768468e+04  5.63244188e+04  4.05e-03 2.31e-04  7.32e-02    11s
  25   3.28158191e+04  5.30353048e+04  3.32e-03 1.66e-04  5.82e-02    11s
  26   3.37966703e+04  5.20025347e+04  2.97e-03 1.50e-04  5.24e-02    11s
  27   3.46904338e+04  4.86515786e+04  2.64e-03 9.80e-05  4.02e-02    11s
  28   3.60144797e+04  4.82726598e+04  2.18e-03 9.20e-05  3.53e-02    11s
  29   3.68749640e+04  4.66485072e+04  1.86e-03 6.70e-05  2.81e-02    11s
  30   3.75583822e+04  4.56857327e+04  1.63e-03 5.02e-05  2.34e-02    11s
  31   3.83609498e+04  4.47053223e+04  1.37e-03 3.30e-05  1.83e-02    12s
  32   3.96267541e+04  4.41219767e+04  9.51e-04 2.33e-05  1.29e-02    12s
  33   4.02071274e+04  4.36364111e+04  7.59e-04 1.58e-05  9.87e-03    12s
  34   4.05183902e+04  4.35865297e+04  6.66e-04 1.50e-05  8.83e-03    12s
  35   4.09915086e+04  4.34037881e+04  5.12e-04 1.19e-05  6.94e-03    12s
  36   4.10673038e+04  4.33070023e+04  4.88e-04 1.04e-05  6.45e-03    12s
  37   4.14202190e+04  4.32312267e+04  3.74e-04 9.29e-06  5.21e-03    12s
  38   4.16946494e+04  4.31458559e+04  2.87e-04 7.97e-06  4.18e-03    13s
  39   4.17710261e+04  4.29682056e+04  2.64e-04 5.22e-06  3.45e-03    13s
  40   4.18731947e+04  4.29316690e+04  2.32e-04 4.60e-06  3.05e-03    13s
  41   4.21008342e+04  4.28473103e+04  1.61e-04 3.13e-06  2.15e-03    13s
  42   4.23025657e+04  4.27994004e+04  9.98e-05 2.30e-06  1.43e-03    13s
  43   4.23988906e+04  4.27358018e+04  7.09e-05 1.61e-06  9.70e-04    13s
  44   4.24351742e+04  4.27269049e+04  6.06e-05 1.47e-06  8.40e-04    13s
  45   4.24605220e+04  4.27154508e+04  5.34e-05 1.24e-06  7.34e-04    14s
  46   4.24988921e+04  4.26951642e+04  4.20e-05 8.67e-07  5.65e-04    14s
  47   4.25206861e+04  4.26855825e+04  3.56e-05 6.83e-07  4.75e-04    14s
  48   4.25579420e+04  4.26732800e+04  2.48e-05 4.57e-07  3.32e-04    14s
  49   4.26101873e+04  4.26626084e+04  9.83e-06 2.64e-07  1.51e-04    14s
  50   4.26263074e+04  4.26599448e+04  5.45e-06 2.11e-07  9.68e-05    14s
  51   4.26349281e+04  4.26552490e+04  3.13e-06 1.25e-07  5.85e-05    14s
  52   4.26408542e+04  4.26532436e+04  1.68e-06 9.10e-08  3.57e-05    15s
  53   4.26425683e+04  4.26518935e+04  1.26e-06 7.00e-08  2.68e-05    15s
  54   4.26449464e+04  4.26502333e+04  6.68e-07 4.06e-08  1.52e-05    15s
  55   4.26464698e+04  4.26486099e+04  2.94e-07 1.40e-08  6.16e-06    15s
  56   4.26474867e+04  4.26482335e+04  6.23e-08 7.70e-09  2.15e-06    15s
  57   4.26477150e+04  4.26478002e+04  1.99e-08 7.88e-10  2.46e-07    15s
  58   4.26477779e+04  4.26477802e+04  1.07e-09 1.39e-10  6.85e-09    15s
  59   4.26477798e+04  4.26477798e+04  1.09e-09 8.79e-11  1.05e-11    15s

Barrier solved model in 59 iterations and 15.35 seconds (21.13 work units)
Optimal objective 4.26477798e+04


Root crossover log...

  157058 DPushes remaining with DInf 0.0000000e+00                15s
    4889 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                21s

    4419 PPushes remaining with PInf 2.5179949e-06                21s
       0 PPushes remaining with PInf 0.0000000e+00                22s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.3287798e-10     22s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   63335    4.2647780e+04   0.000000e+00   0.000000e+00     22s
   63335    4.2647780e+04   0.000000e+00   0.000000e+00     22s
Concurrent spin time: 0.48s

Solved with barrier

Root relaxation: objective 4.264778e+04, 63335 iterations, 17.21 seconds (31.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 42647.7798    0  370 -190754.47 42647.7798   122%     -   23s
H    0     0                    -84360.60900 42647.7798   151%     -   24s
H    0     0                    -83549.13793 42647.7798   151%     -   24s
H    0     0                    -82861.79644 42647.7798   151%     -   24s
H    0     0                    -82794.66098 42647.7798   152%     -   24s
H    0     0                    -82694.53063 42647.7798   152%     -   24s
H    0     0                    -69591.20338 42647.7798   161%     -   24s
H    0     0                    -69570.12187 42647.7798   161%     -   25s
H    0     0                    -63564.24215 42647.7798   167%     -   25s
H    0     0                    -39364.67411 42647.7798   208%     -   26s
H    0     0                    -39337.48068 42647.7798   208%     -   26s
     0     0 35637.8636    0  388 -39337.481 35637.8636   191%     -   87s
H    0     0                    -36710.30743 35637.0320   197%     -   88s
H    0     0                    -36480.66628 35637.0320   198%     -   88s
H    0     0                    -5219.396184 35637.0320   783%     -   88s
H    0     0                    -4716.090081 35637.0320   856%     -   89s
H    0     0                    -4650.670871 35637.0320   866%     -   89s
     0     0 35413.5973    0  385 -4650.6709 35413.5973   861%     -  107s
     0     0 35404.4054    0  377 -4650.6709 35404.4054   861%     -  116s
     0     0 35388.1146    0  375 -4650.6709 35388.1146   861%     -  122s
     0     0 35330.7835    0  392 -4650.6709 35330.7835   860%     -  135s
     0     0 35256.1418    0  394 -4650.6709 35256.1418   858%     -  143s
     0     0 35254.2757    0  392 -4650.6709 35254.2757   858%     -  146s
     0     0 35233.9197    0  385 -4650.6709 35233.9197   858%     -  155s
     0     0 35223.5609    0  383 -4650.6709 35223.5609   857%     -  162s
     0     0 35209.7463    0  394 -4650.6709 35209.7463   857%     -  170s
     0     0 35205.6713    0  391 -4650.6709 35205.6713   857%     -  173s
     0     0 35203.1293    0  396 -4650.6709 35203.1293   857%     -  176s
     0     0 35140.9992    0  394 -4650.6709 35140.9992   856%     -  194s
     0     0 35119.4626    0  391 -4650.6709 35119.4626   855%     -  204s
     0     0 35117.8610    0  400 -4650.6709 35117.8610   855%     -  209s
     0     0 35114.6997    0  396 -4650.6709 35114.6997   855%     -  212s
     0     0 35018.9168    0  376 -4650.6709 35018.9168   853%     -  225s
     0     0 35016.6503    0  381 -4650.6709 35016.6503   853%     -  228s
     0     0 34975.3472    0  399 -4650.6709 34975.3472   852%     -  238s
     0     0 34973.0296    0  373 -4650.6709 34973.0296   852%     -  241s
     0     0 34972.7874    0  406 -4650.6709 34972.7874   852%     -  242s
     0     0 31856.6691    0  402 -4650.6709 31856.6691   785%     -  304s
H    0     0                    -1011.076804 31856.0889  3251%     -  305s
H    0     0                    3595.2922950 31856.0889   786%     -  305s
H    0     0                    3850.7933163 31856.0889   727%     -  305s
H    0     0                    4306.0510903 31856.0889   640%     -  305s
     0     0 31388.7798    0  388 4306.05109 31388.7798   629%     -  334s
     0     0 31320.6009    0  395 4306.05109 31320.6009   627%     -  347s
     0     0 31229.4432    0  404 4306.05109 31229.4432   625%     -  360s
     0     0 31130.3518    0  402 4306.05109 31130.3518   623%     -  376s
     0     0 31056.3831    0  403 4306.05109 31056.3831   621%     -  387s
     0     0 31028.6824    0  407 4306.05109 31028.6824   621%     -  394s
     0     0 30993.4388    0  396 4306.05109 30993.4388   620%     -  400s
     0     0 30969.2796    0  405 4306.05109 30969.2796   619%     -  406s
     0     0 30940.9567    0  406 4306.05109 30940.9567   619%     -  413s
     0     0 30831.8139    0  407 4306.05109 30831.8139   616%     -  426s
     0     0 30813.6897    0  401 4306.05109 30813.6897   616%     -  434s
     0     0 30799.3750    0  402 4306.05109 30799.3750   615%     -  441s
     0     0 30776.4469    0  400 4306.05109 30776.4469   615%     -  447s
     0     0 30772.0143    0  412 4306.05109 30772.0143   615%     -  450s
     0     0 30754.3856    0  414 4306.05109 30754.3856   614%     -  455s
     0     0 30752.6050    0  414 4306.05109 30752.6050   614%     -  458s
     0     0 30752.5813    0  414 4306.05109 30752.5813   614%     -  460s
     0     0 28821.6478    0  440 4306.05109 28821.6478   569%     -  541s
     0     0 28424.4140    0  441 4306.05109 28424.4140   560%     -  582s
     0     0 28261.9754    0  451 4306.05109 28261.9754   556%     -  611s
     0     0 28218.9913    0  450 4306.05109 28218.9913   555%     -  622s
     0     0 28185.5219    0  463 4306.05109 28185.5219   555%     -  632s
     0     0 28165.5786    0  458 4306.05109 28165.5786   554%     -  640s
     0     0 28150.0781    0  447 4306.05109 28150.0781   554%     -  651s
     0     0 28116.1018    0  470 4306.05109 28116.1018   553%     -  658s
     0     0 28114.1811    0  471 4306.05109 28114.1811   553%     -  661s
     0     0 28099.5124    0  453 4306.05109 28099.5124   553%     -  666s
     0     0 28094.1369    0  463 4306.05109 28094.1369   552%     -  671s
     0     0 28092.0016    0  463 4306.05109 28092.0016   552%     -  674s
     0     0 28088.7084    0  457 4306.05109 28088.7084   552%     -  676s
     0     0 28082.8762    0  458 4306.05109 28082.8762   552%     -  679s
     0     0 28080.9846    0  470 4306.05109 28080.9846   552%     -  682s
     0     0 27569.0227    0  467 4306.05109 27569.0227   540%     -  729s
     0     0 27458.2241    0  473 4306.05109 27458.2241   538%     -  746s
     0     0 27348.2537    0  458 4306.05109 27348.2537   535%     -  757s
     0     0 27321.9290    0  474 4306.05109 27321.9290   535%     -  764s
     0     0 27227.5677    0  458 4306.05109 27227.5677   532%     -  774s
     0     0 27205.7935    0  474 4306.05109 27205.7935   532%     -  780s
     0     0 27197.2182    0  479 4306.05109 27197.2182   532%     -  786s
     0     0 27193.4658    0  474 4306.05109 27193.4658   532%     -  790s
     0     0 27169.7063    0  470 4306.05109 27169.7063   531%     -  798s
     0     0 27150.3960    0  479 4306.05109 27150.3960   531%     -  806s
     0     0 27144.0797    0  480 4306.05109 27144.0797   530%     -  812s
     0     0 27138.8283    0  485 4306.05109 27138.8283   530%     -  817s
     0     0 27135.6249    0  481 4306.05109 27135.6249   530%     -  821s
     0     0 27133.0454    0  481 4306.05109 27133.0454   530%     -  824s
     0     0 27131.1511    0  486 4306.05109 27131.1511   530%     -  829s
     0     0 26967.4124    0  485 4306.05109 26967.4124   526%     -  858s
     0     0 26931.2575    0  484 4306.05109 26931.2575   525%     -  870s
     0     0 26913.6203    0  498 4306.05109 26913.6203   525%     -  876s
     0     0 26897.6924    0  474 4306.05109 26897.6924   525%     -  884s
     0     0 26892.5567    0  510 4306.05109 26892.5567   525%     -  889s
     0     0 26890.1797    0  507 4306.05109 26890.1797   524%     -  895s
     0     0 26885.9893    0  505 4306.05109 26885.9893   524%     -  898s
     0     0 26882.8195    0  467 4306.05109 26882.8195   524%     -  902s
     0     0 26882.1873    0  472 4306.05109 26882.1873   524%     -  904s
     0     0 26802.6260    0  491 4306.05109 26802.6260   522%     -  918s
H    0     0                    12284.828107 26802.6187   118%     -  940s
H    0     0                    12940.771781 26802.6187   107%     -  942s
H    0     0                    13117.469362 26802.6187   104%     -  942s
     0     0 26778.8501    0  472 13117.4694 26778.8501   104%     -  952s
     0     0 26772.2268    0  497 13117.4694 26772.2268   104%     -  958s
     0     0 26770.1893    0  500 13117.4694 26770.1893   104%     -  962s
     0     0 26721.5370    0  450 13117.4694 26721.5370   104%     -  979s
H    0     0                    13130.847529 26721.3793   104%     -  980s
     0     0 26712.4619    0  456 13130.8475 26712.4619   103%     -  990s
     0     0 26708.9719    0  502 13130.8475 26708.9719   103%     -  996s
     0     0 26708.4645    0  468 13130.8475 26708.4645   103%     -  997s
     0     0 26686.7017    0  467 13130.8475 26686.7017   103%     - 1009s
     0     0 26676.4322    0  501 13130.8475 26676.4322   103%     - 1020s
     0     0 26669.0225    0  495 13130.8475 26669.0225   103%     - 1025s
     0     0 26667.5001    0  504 13130.8475 26667.5001   103%     - 1027s
     0     0 26661.5553    0  475 13130.8475 26661.5553   103%     - 1036s
     0     0 26654.1546    0  478 13130.8475 26654.1546   103%     - 1041s
     0     0 26649.1163    0  477 13130.8475 26649.1163   103%     - 1046s
     0     0 26648.5300    0  476 13130.8475 26648.5300   103%     - 1049s
     0     0 26639.8464    0  486 13130.8475 26639.8464   103%     - 1056s
     0     0 26637.9278    0  470 13130.8475 26637.9278   103%     - 1081s
     0     0 26633.6690    0  473 13130.8475 26633.6690   103%     - 1087s
H    0     0                    13150.180169 26633.5778   103%     - 1088s
     0     0 26632.9134    0  482 13150.1802 26632.9134   103%     - 1090s
     0     0 26618.8083    0  471 13150.1802 26618.8083   102%     - 1098s
     0     0 26618.6836    0  471 13150.1802 26618.6836   102%     - 1105s
H    0     0                    13204.660407 26618.6154   102%     - 1160s
H    0     0                    13230.231034 26618.6154   101%     - 1160s
H    0     0                    13479.353067 26618.6154  97.5%     - 1160s
H    0     0                    13501.135732 26618.6154  97.2%     - 1275s
H    0     0                    13848.695541 26618.6154  92.2%     - 1282s
     0     2 26618.6154    0  471 13848.6955 26618.6154  92.2%     - 1288s
     1     3 26292.4652    1  419 13848.6955 26618.5336  92.2% 15113 1308s
     2     4 26397.8793    1  513 13848.6955 26397.8793  90.6% 14024 1338s
     3     7 24883.4361    2  421 13848.6955 26397.8568  90.6% 14610 1374s
     6    14 25270.5265    3  477 13848.6955 26396.1140  90.6% 14753 1407s
    13    27 24982.0134    4  462 13848.6955 26176.4831  89.0% 15885 1481s
    26    40 24385.6394    5  440 13848.6955 25795.3969  86.3% 30419 1668s
    39    71 23894.5383    4  523 13848.6955 25795.3969  86.3% 28117 1920s
H   63    71                    13912.043899 25795.3969  85.4% 23088 1920s
    70   139 23859.5894    5  526 13912.0439 25795.3969  85.4% 28957 2001s
   142   234 22546.8022    6  442 13912.0439 25795.3969  85.4% 19476 2060s
   239   301 22398.3629    8  433 13912.0439 25795.3969  85.4% 14543 2107s
   318   318 20916.2530    9  386 13912.0439 25795.3969  85.4% 12862 2141s
H  342   318                    14091.080639 25795.3969  83.1% 12538 2141s
   352   324 20677.8841   10  378 14091.0806 25795.3969  83.1% 12433 2194s
   396   354 17969.6575   12  122 14091.0806 25795.3969  83.1% 11982 2235s
   438   402 16260.5593   15  121 14091.0806 25795.3969  83.1% 12314 2275s
   499   417 14873.9701   17  106 14091.0806 25795.3969  83.1% 12082 2309s
H  513   417                    14146.917114 25795.3969  82.3% 12051 2309s
H  517   417                    14670.434597 25795.3969  75.8% 11970 2309s
H  548   417                    14774.653422 25795.3969  74.6% 11762 2309s
   571   423 21734.8552   15  462 14774.6534 25795.3969  74.6% 11748 2344s
   611   446 21378.0621   16  464 14774.6534 25795.3969  74.6% 11862 2379s
   644   481 20629.0005   17  435 14774.6534 25795.3969  74.6% 12114 2415s
   699   524 infeasible   18      14774.6534 25795.3969  74.6% 12236 2446s
   764   573 20176.2202   18  371 14774.6534 25795.3969  74.6% 12032 2478s
   840   628 19229.8200   19  352 14774.6534 25795.3969  74.6% 11704 2510s
   929   670 17015.0471   20  201 14774.6534 25795.3969  74.6% 11151 2541s
  1019   699 16578.3651   21   74 14774.6534 25795.3969  74.6% 10816 2576s
  1100   755 15725.0945   23  126 14774.6534 25795.3969  74.6% 10645 2604s
  1192   831 15588.7819   25  111 14774.6534 25795.3969  74.6% 10254 2638s
  1333   849 15186.9296   30  104 14774.6534 25795.3969  74.6%  9659 2675s
  1457   924 14901.3818   35  105 14774.6534 25795.3969  74.6%  9308 2710s
  1580   959 23235.4538    9  402 14774.6534 25795.3969  74.6%  9079 2747s
  1695  1019 22798.4391   10  395 14774.6534 25795.3969  74.6%  8912 2781s
  1821  1072 15042.9460   41   98 14774.6534 25795.3969  74.6%  8701 2823s
  1940  1108 infeasible   41      14774.6534 25795.3969  74.6%  8605 2866s
  2049  1163 20929.1179   16  355 14774.6534 25795.3969  74.6%  8459 2910s
  2172  1196 19654.1258   17  319 14774.6534 25795.3969  74.6%  8409 2968s
  2284  1206 19567.3827   18  336 14774.6534 25795.3969  74.6%  8343 3041s
  2365  1234 18965.8010   19  315 14774.6534 25795.3969  74.6%  8394 3090s
  2411  1285 15114.0282   21  218 14774.6534 25795.3969  74.6%  8638 3141s
  2480  1311 14849.3324   23  170 14774.6534 25795.3969  74.6%  8850 3187s
  2528  1341 22112.6764    8  300 14774.6534 25795.3969  74.6%  8979 3234s
  2564  1370 22070.0256    9  300 14774.6534 25795.3969  74.6%  9113 3283s
  2621  1433 22048.0237   10  274 14774.6534 25795.3969  74.6%  9183 3328s
  2700  1487 21872.7532   11  252 14774.6534 25795.3969  74.6%  9249 3375s
  2778  1536 21805.3965   12  135 14774.6534 25795.3969  74.6%  9322 3422s
  2863  1602     cutoff   13      14774.6534 25795.3969  74.6%  9379 3472s
  2977  1666 21257.4946   15  146 14774.6534 25795.3969  74.6%  9401 3531s
  3104  1745 20445.5297   21  148 14774.6534 25795.3969  74.6%  9428 3595s
  3266  1713 14848.7218   34  132 14774.6534 25795.3969  74.6%  9341 3600s

Cutting planes:
  Learned: 1
  Gomory: 1
  Implied bound: 250
  MIR: 4748
  Flow cover: 4414
  Zero half: 2
  RLT: 128
  Relax-and-lift: 867

Explored 3279 nodes (31397888 simplex iterations) in 3600.11 seconds (8499.40 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14774.7 14670.4 14146.9 ... 13204.7

Time limit reached
Best objective 1.477465342226e+04, best bound 2.579539689469e+04, gap 74.5922%
  WARNING: Time limit reached. Using best solution found (gap: 74.59%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 14774.65, θ = 161473.28
  Upper Bound (UB) = 14774.65

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161473.28
  [DEBUG]   ✓ Scenario 0: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 161473.28 ≤ Q = 164637.17 (slack: 3163.89)
  [DEBUG]   ✓ Scenario 3: θ = 161473.28 ≤ Q = 161473.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 161473.28 ≤ Q = 161473.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 161473.28 ≤ Q = 161473.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 161473.28 ≤ Q = 161473.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 161473.28 ≤ Q = 161473.28 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 22] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x58b94535
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa746bacb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.360115e+13
Presolve removed 2581 rows and 1872 columns
Presolve time: 0.00s
Presolved: 512 rows, 517 columns, 1445 nonzeros
Found heuristic solution: objective 6886524.8784
Variable types: 350 continuous, 167 integer (167 binary)

Root relaxation: objective -1.431276e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143127.64    0  122 6886524.88 -143127.64   102%     -    0s
H    0     0                    -98974.78269 -143127.64  44.6%     -    0s
H    0     0                    -103117.1287 -143127.64  38.8%     -    0s
H    0     0                    -113440.2581 -143127.64  26.2%     -    0s
H    0     0                    -117716.2296 -120711.92  2.54%     -    0s
     0     0 -120711.92    0  110 -117716.23 -120711.92  2.54%     -    0s
H    0     0                    -118470.9102 -120609.94  1.81%     -    0s
     0     0 -119639.70    0  113 -118470.91 -119639.70  0.99%     -    0s
H    0     0                    -118722.3131 -119617.13  0.75%     -    0s
     0     0 -119617.13    0  113 -118722.31 -119617.13  0.75%     -    0s
     0     0 -119316.56    0  103 -118722.31 -119316.56  0.50%     -    0s
     0     0 -119250.23    0   98 -118722.31 -119250.23  0.44%     -    0s
     0     0 -119238.86    0   91 -118722.31 -119238.86  0.44%     -    0s
     0     0 -119123.41    0   63 -118722.31 -119123.41  0.34%     -    0s
     0     0 -119117.19    0   67 -118722.31 -119117.19  0.33%     -    0s
     0     0 -119050.98    0   60 -118722.31 -119050.98  0.28%     -    0s
H    0     0                    -118723.8359 -119050.98  0.28%     -    0s
     0     0 -119050.89    0   60 -118723.84 -119050.89  0.28%     -    0s
     0     0 -119050.86    0   75 -118723.84 -119050.86  0.28%     -    0s
     0     0 -119050.86    0   36 -118723.84 -119050.86  0.28%     -    0s
H    0     0                    -118905.5370 -119050.86  0.12%     -    0s
H    0     0                    -118909.0944 -119050.86  0.12%     -    0s
     0     0 -119050.86    0   54 -118909.09 -119050.86  0.12%     -    0s
     0     0 -119009.60    0   52 -118909.09 -119009.60  0.08%     -    0s
     0     0 -119002.77    0   51 -118909.09 -119002.77  0.08%     -    0s
     0     0 -118971.51    0   48 -118909.09 -118971.51  0.05%     -    0s
     0     0 -118969.96    0   48 -118909.09 -118969.96  0.05%     -    0s
     0     0 -118960.40    0   48 -118909.09 -118960.40  0.04%     -    0s
     0     0 -118957.88    0   48 -118909.09 -118957.88  0.04%     -    0s
H    0     0                    -118917.8215 -118957.88  0.03%     -    0s
     0     0 -118957.88    0   46 -118917.82 -118957.88  0.03%     -    0s
     0     0 -118957.88    0   44 -118917.82 -118957.88  0.03%     -    0s
     0     0 -118957.88    0   43 -118917.82 -118957.88  0.03%     -    0s
     0     0 -118949.98    0   44 -118917.82 -118949.98  0.03%     -    0s
     0     0 -118949.89    0   44 -118917.82 -118949.89  0.03%     -    0s
     0     0 -118935.78    0   38 -118917.82 -118935.78  0.02%     -    0s
     0     0 -118933.38    0   36 -118917.82 -118933.38  0.01%     -    0s
H    0     0                    -118924.6679 -118933.38  0.01%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 1
  MIR: 40
  Flow cover: 15
  RLT: 18

Explored 1 nodes (1521 simplex iterations) in 0.12 seconds (0.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118925 -118918 -118909 ... -98974.8
No other solutions better than -118925

Optimal solution found (tolerance 1.00e-06)
Best objective -1.189246679171e+05, best bound -1.189246679171e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 153936.15
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118924.67
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -118924.67 = 153936.15
  [DEBUG]   Current θ from Master = 161473.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7537.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7237.53
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 2184.8917, Absolute Gap = 2184.8917, Relative Gap = 0.147881
  Not converged yet (gap = 2184.89 > ε = 200)

  [DEBUG] Adding NEW scenario 22 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 22 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 22 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 22]
    [DEBUG]   - Total constraints in model: 353053
    [DEBUG]   - Total variables in model: 145780
  [DEBUG] Total scenarios in Master: 23
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 23
================================================================================
[Iteration 23] Solving Master Problem...
  Current scenarios in Master: 23
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 353053 rows, 145780 columns and 1000108 nonzeros
Model fingerprint: 0x7e2cfbf2
Variable types: 143521 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 153478 rows and 62318 columns (presolve time = 5s)...
Presolve removed 153478 rows and 62318 columns
Presolve time: 5.20s
Presolved: 199575 rows, 83462 columns, 1227665 nonzeros
Variable types: 81203 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.78s

Barrier statistics:
 Dense cols : 1201
 AA' NZ     : 5.013e+06
 Factor NZ  : 1.410e+07 (roughly 230 MB of memory)
 Factor Ops : 5.071e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.33894471e+07  3.18843380e+08  1.44e+05 1.32e+01  9.50e+04     9s
   1  -1.80729011e+07  2.93900285e+08  1.02e+05 5.49e+01  6.69e+04     9s
   2  -7.33197459e+06  2.24016706e+08  4.06e+04 8.07e+00  2.85e+04     9s
   3  -5.61739616e+06  2.23446146e+08  3.06e+04 7.89e+00  2.17e+04     9s
   4  -1.76361598e+06  1.94623619e+08  6.01e+03 3.98e+00  4.66e+03     9s
   5  -7.99707434e+05  1.70355758e+08  1.14e+03 2.85e+00  1.23e+03    10s
   6  -5.43777130e+05  7.43093676e+07  3.36e+02 8.27e-01  4.05e+02    10s
   7  -4.54203964e+05  5.75831709e+07  1.56e+02 6.02e-01  2.47e+02    10s
   8  -4.10687340e+05  3.91473184e+07  8.06e+01 3.83e-01  1.49e+02    10s
   9  -3.45392160e+05  2.81361187e+07  2.53e+01 2.60e-01  8.92e+01    10s
  10  -2.19032941e+05  1.52494310e+07  2.19e+00 1.33e-01  4.32e+01    10s
  11  -1.48299293e+05  6.47394226e+06  7.11e-01 5.57e-02  1.83e+01    10s
  12  -1.14218120e+05  4.52008755e+06  4.59e-01 3.84e-02  1.28e+01    10s
  13  -9.43385737e+04  3.06261100e+06  3.03e-01 2.57e-02  8.71e+00    10s
  14  -7.75336244e+04  1.76448742e+06  1.96e-01 1.45e-02  5.08e+00    10s
  15  -4.15141237e+04  5.84590190e+05  6.87e-02 4.19e-03  1.73e+00    11s
  16  -1.87760437e+04  2.75083424e+05  3.99e-02 2.14e-03  8.10e-01    11s
  17  -4.07673630e+03  1.76593839e+05  2.78e-02 2.86e-03  4.98e-01    11s
  18   4.17795619e+03  1.38056656e+05  2.26e-02 2.02e-03  3.69e-01    11s
  19   1.18789765e+04  1.05770755e+05  1.77e-02 1.33e-03  2.59e-01    11s
  20   1.68248073e+04  8.68014007e+04  1.47e-02 9.42e-04  1.93e-01    11s
  21   2.01550959e+04  7.84729861e+04  1.26e-02 7.66e-04  1.61e-01    11s
  22   2.46377055e+04  6.78479484e+04  9.88e-03 5.46e-04  1.19e-01    11s
  23   2.78754325e+04  6.05164318e+04  7.97e-03 3.85e-04  8.99e-02    12s
  24   3.01488352e+04  5.56342010e+04  6.72e-03 5.48e-04  7.02e-02    12s
  25   3.28120229e+04  5.19500716e+04  5.25e-03 4.27e-04  5.27e-02    12s
  26   3.45043393e+04  4.96137344e+04  4.33e-03 3.12e-04  4.16e-02    12s
  27   3.57588278e+04  4.84079058e+04  3.68e-03 2.49e-04  3.49e-02    12s
  28   3.63940843e+04  4.69778092e+04  3.35e-03 1.83e-04  2.92e-02    12s
  29   3.79061516e+04  4.58601451e+04  2.61e-03 1.03e-04  2.19e-02    12s
  30   3.89230312e+04  4.50082921e+04  2.12e-03 6.78e-05  1.68e-02    13s
  31   3.99994425e+04  4.44620304e+04  1.57e-03 4.60e-05  1.23e-02    13s
  32   4.04589848e+04  4.41540255e+04  1.34e-03 3.41e-05  1.02e-02    13s
  33   4.10422046e+04  4.39643423e+04  1.05e-03 2.64e-05  8.05e-03    13s
  34   4.14548163e+04  4.38807453e+04  8.43e-04 2.32e-05  6.69e-03    13s
  35   4.16830381e+04  4.38153125e+04  7.33e-04 2.10e-05  5.88e-03    13s
  36   4.18702598e+04  4.36216851e+04  6.42e-04 1.38e-05  4.83e-03    13s
  37   4.20570440e+04  4.35387836e+04  5.54e-04 1.07e-05  4.08e-03    14s
  38   4.22951557e+04  4.34832073e+04  4.43e-04 8.41e-06  3.27e-03    14s
  39   4.24521527e+04  4.34319202e+04  3.71e-04 6.58e-06  2.70e-03    14s
  40   4.25262413e+04  4.33840818e+04  3.36e-04 4.85e-06  2.36e-03    14s
  41   4.27106603e+04  4.33486843e+04  2.50e-04 3.53e-06  1.76e-03    14s
  42   4.27271896e+04  4.33216845e+04  2.42e-04 2.52e-06  1.64e-03    14s
  43   4.29416091e+04  4.33136609e+04  1.44e-04 2.19e-06  1.03e-03    15s
  44   4.29952479e+04  4.32964787e+04  1.18e-04 1.50e-06  8.30e-04    15s
  45   4.30375474e+04  4.32855741e+04  9.85e-05 1.11e-06  6.84e-04    15s
  46   4.31105848e+04  4.32795893e+04  6.56e-05 8.72e-07  4.66e-04    15s
  47   4.31194962e+04  4.32731311e+04  6.16e-05 7.40e-07  4.23e-04    15s
  48   4.31354921e+04  4.32698668e+04  5.44e-05 7.57e-07  3.70e-04    15s
  49   4.31729191e+04  4.32654573e+04  3.71e-05 1.64e-06  2.55e-04    15s
  50   4.31904129e+04  4.32605471e+04  2.93e-05 5.47e-07  1.93e-04    16s
  51   4.32438811e+04  4.32559555e+04  4.61e-06 1.33e-07  3.33e-05    16s
  52   4.32533788e+04  4.32542817e+04  2.73e-07 1.68e-08  2.49e-06    16s
  53   4.32540947e+04  4.32540966e+04  9.40e-10 1.18e-08  5.29e-09    16s
  54   4.32540959e+04  4.32540960e+04  2.30e-08 2.16e-10  2.68e-10    16s

Barrier solved model in 54 iterations and 16.13 seconds (21.32 work units)
Optimal objective 4.32540959e+04


Root crossover log...

  166489 DPushes remaining with DInf 0.0000000e+00                16s
   51818 DPushes remaining with DInf 0.0000000e+00                20s
    7400 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                28s

   10145 PPushes remaining with PInf 2.7519641e-05                28s
       0 PPushes remaining with PInf 0.0000000e+00                29s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.9222175e+02     29s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   85104    4.3254096e+04   0.000000e+00   7.922217e+02     29s
   85213    4.3254096e+04   0.000000e+00   0.000000e+00     29s
   85213    4.3254096e+04   0.000000e+00   0.000000e+00     29s
Concurrent spin time: 6.71s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.325410e+04, 85213 iterations, 29.47 seconds (50.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43254.0960    0  333 -190754.47 43254.0960   123%     -   37s
H    0     0                    -183737.1327 43254.0960   124%     -   38s
H    0     0                    -169494.1088 43254.0960   126%     -   39s
H    0     0                    -168926.2086 43254.0960   126%     -   41s
H    0     0                    -168513.7225 43254.0960   126%     -   42s
H    0     0                    -167763.1361 43254.0960   126%     -   42s
H    0     0                    -163491.5040 43254.0960   126%     -   43s
H    0     0                    -155238.3946 43254.0960   128%     -   43s
H    0     0                    -152138.7726 43254.0960   128%     -   43s
H    0     0                    -149871.3647 43254.0960   129%     -   44s
H    0     0                    -147900.4548 43254.0960   129%     -   44s
H    0     0                    -147126.9980 43254.0960   129%     -   44s
H    0     0                    -146188.3457 43254.0960   130%     -   44s
H    0     0                    -146121.8556 43254.0960   130%     -   44s
H    0     0                    -145995.8547 43254.0960   130%     -   44s
H    0     0                    -145963.3162 43254.0960   130%     -   44s
H    0     0                    -145917.0761 43254.0960   130%     -   44s
H    0     0                    -58215.23515 43254.0960   174%     -   45s
H    0     0                    -56621.67451 43254.0960   176%     -   45s
H    0     0                    -56552.92677 43254.0960   176%     -   45s
     0     0 36428.7932    0  341 -56552.927 36428.7932   164%     -  121s
H    0     0                    -48672.81630 36428.7680   175%     -  122s
H    0     0                    -48513.93364 36428.7680   175%     -  122s
H    0     0                    -37222.02813 36428.7680   198%     -  122s
H    0     0                    -34299.09612 36428.7680   206%     -  123s
H    0     0                    -34285.68725 36428.7680   206%     -  123s
H    0     0                    -23464.40782 36428.7680   255%     -  123s
H    0     0                    -19130.29680 36428.7680   290%     -  123s
     0     0 35942.8289    0  368 -19130.297 35942.8289   288%     -  159s
     0     0 35879.2749    0  372 -19130.297 35879.2749   288%     -  176s
     0     0 35870.7133    0  371 -19130.297 35870.7133   288%     -  183s
     0     0 35861.0553    0  373 -19130.297 35861.0553   287%     -  189s
     0     0 35859.8960    0  373 -19130.297 35859.8960   287%     -  190s
     0     0 35855.7372    0  373 -19130.297 35855.7372   287%     -  196s
     0     0 35851.5637    0  366 -19130.297 35851.5637   287%     -  205s
     0     0 35829.7510    0  361 -19130.297 35829.7510   287%     -  210s
     0     0 35818.6272    0  361 -19130.297 35818.6272   287%     -  212s
     0     0 35785.4391    0  371 -19130.297 35785.4391   287%     -  217s
     0     0 35693.1439    0  359 -19130.297 35693.1439   287%     -  235s
     0     0 35675.9370    0  368 -19130.297 35675.9370   286%     -  241s
     0     0 35670.3005    0  359 -19130.297 35670.3005   286%     -  243s
     0     0 35657.8627    0  359 -19130.297 35657.8627   286%     -  248s
     0     0 35593.4763    0  367 -19130.297 35593.4763   286%     -  258s
     0     0 35571.2323    0  364 -19130.297 35571.2323   286%     -  266s
     0     0 35565.2346    0  367 -19130.297 35565.2346   286%     -  270s
     0     0 35564.9722    0  367 -19130.297 35564.9722   286%     -  272s
     0     0 32224.6030    0  392 -19130.297 32224.6030   268%     -  352s
H    0     0                    -1599.040812 32223.9062  2115%     -  353s
H    0     0                    -1534.919364 32223.9062  2199%     -  354s
H    0     0                    -1181.766645 32223.9062  2827%     -  354s
H    0     0                    -1177.173431 32223.9062  2837%     -  354s
     0     0 31667.4227    0  409 -1177.1734 31667.4227  2790%     -  397s
     0     0 31485.5891    0  447 -1177.1734 31485.5891  2775%     -  420s
     0     0 31411.0739    0  447 -1177.1734 31411.0739  2768%     -  431s
     0     0 31352.8398    0  445 -1177.1734 31352.8398  2763%     -  445s
     0     0 31321.5751    0  455 -1177.1734 31321.5751  2761%     -  456s
     0     0 31302.3041    0  458 -1177.1734 31302.3041  2759%     -  466s
     0     0 31253.6207    0  437 -1177.1734 31253.6207  2755%     -  479s
     0     0 31233.0033    0  438 -1177.1734 31233.0033  2753%     -  485s
     0     0 31186.6572    0  396 -1177.1734 31186.6572  2749%     -  494s
     0     0 31105.9972    0  397 -1177.1734 31105.9972  2742%     -  507s
     0     0 31099.0973    0  401 -1177.1734 31099.0973  2742%     -  512s
     0     0 31096.2300    0  435 -1177.1734 31096.2300  2742%     -  515s
     0     0 31078.7477    0  455 -1177.1734 31078.7477  2740%     -  523s
     0     0 31048.8023    0  454 -1177.1734 31048.8023  2738%     -  530s
     0     0 31038.2478    0  469 -1177.1734 31038.2478  2737%     -  535s
     0     0 31037.5748    0  469 -1177.1734 31037.5748  2737%     -  537s
     0     0 29032.3856    0  430 -1177.1734 29032.3856  2566%     -  633s
H    0     0                    1762.1242984 29032.1133  1548%     -  634s
H    0     0                    1772.4201481 29032.1133  1538%     -  634s
H    0     0                    2266.9444891 29032.1133  1181%     -  634s
     0     0 28739.7204    0  446 2266.94449 28739.7204  1168%     -  668s
     0     0 28539.6466    0  525 2266.94449 28539.6466  1159%     -  701s
     0     0 28470.9754    0  458 2266.94449 28470.9754  1156%     -  718s
     0     0 28454.9251    0  448 2266.94449 28454.9251  1155%     -  727s
     0     0 28449.2947    0  460 2266.94449 28449.2947  1155%     -  732s
     0     0 28445.8026    0  464 2266.94449 28445.8026  1155%     -  736s
     0     0 28437.4235    0  466 2266.94449 28437.4235  1154%     -  744s
     0     0 28435.2085    0  504 2266.94449 28435.2085  1154%     -  750s
     0     0 28429.0630    0  499 2266.94449 28429.0630  1154%     -  757s
     0     0 28424.6291    0  474 2266.94449 28424.6291  1154%     -  761s
     0     0 28422.9623    0  464 2266.94449 28422.9623  1154%     -  765s
     0     0 27463.7171    0  469 2266.94449 27463.7171  1111%     -  838s
     0     0 27328.9704    0  465 2266.94449 27328.9704  1106%     -  870s
     0     0 27271.8544    0  470 2266.94449 27271.8544  1103%     -  893s
     0     0 27257.8157    0  468 2266.94449 27257.8157  1102%     -  903s
     0     0 27247.5304    0  456 2266.94449 27247.5304  1102%     -  913s
     0     0 27236.8642    0  475 2266.94449 27236.8642  1101%     -  920s
     0     0 27227.8723    0  480 2266.94449 27227.8723  1101%     -  928s
     0     0 27218.3989    0  475 2266.94449 27218.3989  1101%     -  936s
     0     0 27211.4759    0  474 2266.94449 27211.4759  1100%     -  941s
     0     0 27206.6866    0  488 2266.94449 27206.6866  1100%     -  946s
     0     0 27193.9748    0  482 2266.94449 27193.9748  1100%     -  954s
     0     0 27192.6844    0  478 2266.94449 27192.6844  1100%     -  956s
     0     0 27103.8560    0  464 2266.94449 27103.8560  1096%     -  979s
     0     0 27078.8947    0  480 2266.94449 27078.8947  1095%     -  994s
     0     0 27068.7372    0  484 2266.94449 27068.7372  1094%     - 1006s
     0     0 27054.1586    0  486 2266.94449 27054.1586  1093%     - 1015s
     0     0 27048.1225    0  477 2266.94449 27048.1225  1093%     - 1023s
     0     0 27047.1178    0  478 2266.94449 27047.1178  1093%     - 1026s
     0     0 26999.1377    0  468 2266.94449 26999.1377  1091%     - 1046s
H    0     0                    2467.2574880 26999.1235   994%     - 1066s
H    0     0                    2867.9987874 26999.1235   841%     - 1066s
H    0     0                    2999.2922233 26999.1235   800%     - 1066s
H    0     0                    4837.6497685 26999.1235   458%     - 1068s
     0     0 26984.0015    0  481 4837.64977 26984.0015   458%     - 1079s
     0     0 26980.0116    0  483 4837.64977 26980.0116   458%     - 1087s
     0     0 26972.6450    0  486 4837.64977 26972.6450   458%     - 1097s
     0     0 26970.9049    0  484 4837.64977 26970.9049   458%     - 1103s
     0     0 26950.6134    0  520 4837.64977 26950.6134   457%     - 1123s
H    0     0                    5289.6162085 26950.4428   409%     - 1123s
H    0     0                    5693.0009088 26950.4428   373%     - 1124s
     0     0 26945.9032    0  488 5693.00091 26945.9032   373%     - 1131s
     0     0 26936.0890    0  517 5693.00091 26936.0890   373%     - 1138s
     0     0 26930.1524    0  527 5693.00091 26930.1524   373%     - 1143s
     0     0 26924.2404    0  530 5693.00091 26924.2404   373%     - 1150s
     0     0 26914.0597    0  474 5693.00091 26914.0597   373%     - 1157s
     0     0 26901.1885    0  512 5693.00091 26901.1885   373%     - 1168s
     0     0 26897.1473    0  480 5693.00091 26897.1473   372%     - 1176s
     0     0 26896.1796    0  479 5693.00091 26896.1796   372%     - 1179s
     0     0 26868.1095    0  494 5693.00091 26868.1095   372%     - 1194s
H    0     0                    6745.7625152 26867.7150   298%     - 1195s
H    0     0                    7088.3960361 26867.7150   279%     - 1196s
H    0     0                    8029.5916741 26867.7150   235%     - 1198s
H    0     0                    8383.4296942 26867.7150   220%     - 1198s
H    0     0                    8843.5894613 26867.7150   204%     - 1198s
H    0     0                    8879.7214151 26867.7150   203%     - 1198s
H    0     0                    9076.5711202 26867.7150   196%     - 1198s
H    0     0                    9260.6665634 26867.7150   190%     - 1200s
     0     0 26856.0364    0  490 9260.66656 26856.0364   190%     - 1213s
     0     0 26847.8156    0  485 9260.66656 26847.8156   190%     - 1224s
     0     0 26839.9110    0  480 9260.66656 26839.9110   190%     - 1234s
     0     0 26835.8590    0  474 9260.66656 26835.8590   190%     - 1239s
     0     0 26834.3249    0  489 9260.66656 26834.3249   190%     - 1243s
     0     0 26811.4832    0  515 9260.66656 26811.4832   190%     - 1265s
     0     0 26808.9261    0  515 9260.66656 26808.9261   189%     - 1271s
     0     0 26808.4564    0  519 9260.66656 26808.4564   189%     - 1273s
     0     0 26800.9684    0  479 9260.66656 26800.9684   189%     - 1283s
H    0     0                    11295.034215 26800.8983   137%     - 1320s
H    0     0                    11508.508985 26800.8983   133%     - 1320s
H    0     0                    11614.966983 26800.8983   131%     - 1323s
H    0     0                    11865.552524 26800.8983   126%     - 1323s
H    0     0                    11888.103832 26800.8983   125%     - 1323s
H    0     0                    11912.858962 26800.8983   125%     - 1323s
H    0     0                    12083.295911 26800.8983   122%     - 1323s
     0     0 26798.8485    0  470 12083.2959 26798.8485   122%     - 1328s
     0     0 26794.0983    0  480 12083.2959 26794.0983   122%     - 1338s
     0     0 26792.3525    0  483 12083.2959 26792.3525   122%     - 1342s
     0     0 26791.2262    0  487 12083.2959 26791.2262   122%     - 1352s
     0     0 26791.0585    0  487 12083.2959 26791.0585   122%     - 1362s
H    0     0                    12115.969164 26791.0585   121%     - 1524s
H    0     0                    12148.749205 26791.0585   121%     - 1641s
H    0     0                    12230.754043 26791.0585   119%     - 1641s
H    0     0                    12249.789132 26791.0585   119%     - 1644s
H    0     0                    12434.086954 26791.0585   115%     - 1644s
H    0     2                    12582.356987 26791.0585   113%     - 1666s
     0     2 26791.0585    0  487 12582.3570 26791.0585   113%     - 1666s
     1     3 26253.2854    1  453 12582.3570 26790.0876   113% 16573 1701s
     2     5 25853.7989    2  480 12582.3570 26790.0876   113% 19967 1747s
     4     9 25740.6824    3  480 12582.3570 26520.3502   111% 16076 1804s
     8    18 25937.0069    3  521 12582.3570 26520.1582   111% 16852 1859s
    17    36 25489.0415    4  517 12582.3570 26134.9011   108% 19173 1919s
    35    50 25640.2074    5  537 12582.3570 25909.2777   106% 26238 2066s
    49    78 24861.8593    6  473 12582.3570 25909.2777   106% 32574 2153s
H   56    78                    12601.322752 25909.2777   106% 30461 2153s
H   66    78                    12674.489475 25909.2777   104% 28444 2153s
    77   181 24805.7217    7  396 12674.4895 25909.2777   104% 25976 2241s
   180   211 24401.8312   11  378 12674.4895 25909.2777   104% 17123 2288s
H  188   211                    12931.539552 25909.2777   100% 16651 2288s
H  207   211                    12975.613338 25909.2777   100% 15832 2288s
   210   279 24380.1484   12  382 12975.6133 25909.2777   100% 15703 2344s
   278   329 24274.2159   17  368 12975.6133 25909.2777   100% 12973 2391s
H  284   329                    12993.809195 25909.2777  99.4% 12805 2391s
H  313   329                    13556.474033 25909.2777  91.1% 11999 2391s
   328   384 24267.1477   18  364 13556.4740 25909.2777  91.1% 11697 2441s
H  383   426                    13648.078420 25909.2777  89.8% 10742 2493s
H  410   426                    13724.562879 25909.2777  88.8% 10435 2493s
H  423   426                    13823.980253 25909.2777  87.4% 10322 2493s
   430   460 24082.1193   20  362 13823.9803 25909.2777  87.4% 10283 2542s
   466   490 23860.7449   21  355 13823.9803 25909.2777  87.4% 10064 2593s
H  468   490                    13873.747771 25909.2777  86.8% 10053 2593s
H  477   490                    13937.182472 25909.2777  85.9% 10001 2593s
H  483   490                    14113.860877 25909.2777  83.6%  9940 2593s
H  492   490                    14187.529751 25909.2777  82.6%  9873 2593s
   498   509 23578.9323   22  355 14187.5298 25909.2777  82.6%  9830 2642s
   527   546 23378.0100   23  412 14187.5298 25909.2777  82.6%  9709 2699s
   566   589 22971.7908   24  425 14187.5298 25909.2777  82.6%  9579 2777s
   623   628 22931.2150   26  422 14187.5298 25909.2777  82.6%  9291 2821s
H  647   628                    14227.212388 25909.2777  82.1%  9129 2821s
   685   679 22543.7757   27  342 14227.2124 25909.2777  82.1%  8872 2872s
   754   714 infeasible   28      14227.2124 25909.2777  82.1%  8380 2935s
   815   742 22378.8117   31  310 14227.2124 25909.2777  82.1%  8102 2980s
   873   772 14648.9751   27  213 14227.2124 25909.2777  82.1%  7888 3026s
   937   789 16689.3366   18  129 14227.2124 25909.2777  82.1%  7643 3073s
  1017   827 16157.4936   19  100 14227.2124 25909.2777  82.1%  7408 3129s
  1075   924 15631.7687   24   95 14227.2124 25909.2777  82.1%  7257 3223s
  1190  1033 15269.1070   31   79 14227.2124 25909.2777  82.1%  6890 3269s
  1345  1107 infeasible   38      14227.2124 25909.2777  82.1%  6415 3313s
  1505  1153 17490.5754   44  189 14227.2124 25909.2777  82.1%  6014 3365s
  1650  1192 16621.9038   45  176 14227.2124 25909.2777  82.1%  5795 3414s
  1790  1195 14996.9259   46  164 14227.2124 25909.2777  82.1%  5603 3470s
  1865  1218 14589.1901   47  157 14227.2124 25909.2777  82.1%  5589 3532s
  1950  1241 14493.2103   38  178 14227.2124 25909.2777  82.1%  5591 3598s
  2024  1240 infeasible   30      14227.2124 25909.2777  82.1%  5566 3600s

Cutting planes:
  Learned: 1
  Implied bound: 167
  MIR: 4615
  Flow cover: 4759
  Zero half: 1
  RLT: 136
  Relax-and-lift: 923

Explored 2027 nodes (12190633 simplex iterations) in 3600.06 seconds (8256.26 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 14227.2 14187.5 14113.9 ... 12993.8

Time limit reached
Best objective 1.422721238813e+04, best bound 2.590927773277e+04, gap 82.1107%
  WARNING: Time limit reached. Using best solution found (gap: 82.11%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 14227.21, θ = 160814.51
  Upper Bound (UB) = 14227.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160814.51
  [DEBUG]   ✓ Scenario 0: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160814.51 ≤ Q = 160814.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160814.51 ≤ Q = 160814.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 160814.51 ≤ Q = 160814.51 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 23] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1d8e2ee0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1d8e2ee0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.235690e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6121856.1320
Variable types: 346 continuous, 166 integer (166 binary)

Root relaxation: objective -1.435385e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143538.46    0  119 6121856.13 -143538.46   102%     -    0s
H    0     0                    -103488.4686 -143538.46  38.7%     -    0s
H    0     0                    -104351.3634 -143538.46  37.6%     -    0s
H    0     0                    -106482.6554 -143538.46  34.8%     -    0s
     0     0 -120291.01    0  100 -106482.66 -120291.01  13.0%     -    0s
H    0     0                    -117044.9351 -120187.70  2.69%     -    0s
H    0     0                    -117813.3446 -120187.70  2.02%     -    0s
     0     0 -119125.10    0  104 -117813.34 -119125.10  1.11%     -    0s
H    0     0                    -117887.0632 -119075.69  1.01%     -    0s
     0     0 -118763.19    0   93 -117887.06 -118763.19  0.74%     -    0s
H    0     0                    -118088.8668 -118708.43  0.52%     -    0s
     0     0 -118708.43    0   93 -118088.87 -118708.43  0.52%     -    0s
     0     0 -118436.42    0   62 -118088.87 -118436.42  0.29%     -    0s
     0     0 -118423.85    0   60 -118088.87 -118423.85  0.28%     -    0s
     0     0 -118378.74    0   76 -118088.87 -118378.74  0.25%     -    0s
     0     0 -118375.46    0   77 -118088.87 -118375.46  0.24%     -    0s
     0     0 -118329.78    0   70 -118088.87 -118329.78  0.20%     -    0s
     0     0 -118328.09    0   70 -118088.87 -118328.09  0.20%     -    0s
H    0     0                    -118135.6450 -118328.09  0.16%     -    0s
     0     0 -118328.09    0   71 -118135.65 -118328.09  0.16%     -    0s
     0     0 -118328.09    0   74 -118135.65 -118328.09  0.16%     -    0s
     0     0 -118328.09    0   74 -118135.65 -118328.09  0.16%     -    0s
     0     0 -118328.09    0   48 -118135.65 -118328.09  0.16%     -    0s
     0     0 -118328.09    0   22 -118135.65 -118328.09  0.16%     -    0s
     0     0 -118309.86    0   22 -118135.65 -118309.86  0.15%     -    0s
     0     0 -118207.27    0    8 -118135.65 -118207.27  0.06%     -    0s
     0     0 -118185.28    0    9 -118135.65 -118185.28  0.04%     -    0s
     0     0 -118185.28    0   12 -118135.65 -118185.28  0.04%     -    0s
H    0     0                    -118142.4367 -118185.28  0.04%     -    0s
     0     0 -118165.47    0    7 -118142.44 -118165.47  0.02%     -    0s
     0     0 -118161.62    0    6 -118142.44 -118161.62  0.02%     -    0s
H    0     0                    -118150.1297 -118161.62  0.01%     -    0s
     0     0 -118160.29    0    3 -118150.13 -118160.29  0.01%     -    0s
     0     0 -118151.73    0    2 -118150.13 -118151.73  0.00%     -    0s

Cutting planes:
  Gomory: 8
  MIR: 4
  Flow cover: 5
  Relax-and-lift: 4

Explored 1 nodes (1289 simplex iterations) in 0.11 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118150 -118142 -118136 ... -103488
No other solutions better than -118150

Optimal solution found (tolerance 1.00e-06)
Best objective -1.181501296668e+05, best bound -1.181501296668e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 153891.95
  Scenario: 43 demand increases, 17 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118150.13
  [DEBUG]   S×d_nominal = 272042.08
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272042.08 + -118150.13 = 153891.95
  [DEBUG]   Current θ from Master = 160814.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6922.56 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7304.66
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 1637.4507, Absolute Gap = 1637.4507, Relative Gap = 0.115093
  Not converged yet (gap = 1637.45 > ε = 200)

  [DEBUG] Adding NEW scenario 23 to Master Problem...
  [DEBUG] New scenario pattern: 43 increases, 17 decreases
    [DEBUG] Scenario 23 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 23 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 23]
    [DEBUG]   - Total constraints in model: 368343
    [DEBUG]   - Total variables in model: 152020
  [DEBUG] Total scenarios in Master: 24
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 24
================================================================================
[Iteration 24] Solving Master Problem...
  Current scenarios in Master: 24
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 368343 rows, 152020 columns and 1043351 nonzeros
Model fingerprint: 0x371995a1
Variable types: 149761 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 160144 rows and 65024 columns (presolve time = 5s)...
Presolve removed 160144 rows and 65024 columns
Presolve time: 5.72s
Presolved: 208199 rows, 86996 columns, 1280845 nonzeros
Variable types: 84737 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.96s

Barrier statistics:
 Dense cols : 1200
 AA' NZ     : 5.387e+06
 Factor NZ  : 1.513e+07 (roughly 240 MB of memory)
 Factor Ops : 5.473e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.37897387e+07  3.32175643e+08  1.46e+05 1.29e+01  9.72e+04    10s
   1  -1.84938346e+07  3.07051350e+08  1.04e+05 5.39e+01  6.89e+04    10s
   2  -7.61734290e+06  2.37192876e+08  4.24e+04 6.27e+00  2.98e+04    10s
   3  -3.08316370e+06  1.95504608e+08  1.32e+04 3.57e+00  9.63e+03    10s
   4  -8.68665039e+05  1.44691675e+08  1.29e+03 1.18e+00  1.24e+03    10s
   5  -7.13358139e+05  1.16567636e+08  4.81e+02 8.45e-01  6.15e+02    10s
   6  -6.76511801e+05  7.46728078e+07  3.97e+02 4.81e-01  4.30e+02    10s
   7  -6.02866609e+05  6.09517873e+07  1.33e+02 3.69e-01  2.37e+02    10s
   8  -5.54558963e+05  4.19386482e+07  3.86e+01 2.42e-01  1.31e+02    10s
   9  -4.21438675e+05  2.99511201e+07  4.31e+00 1.67e-01  8.19e+01    10s
  10  -2.02640808e+05  1.32693849e+07  6.96e-03 7.24e-02  3.56e+01    11s
  11  -1.38005840e+05  7.35286413e+06  3.41e-03 4.02e-02  1.98e+01    11s
  12  -1.10191532e+05  4.92826340e+06  2.24e-03 2.66e-02  1.33e+01    11s
  13  -9.24394762e+04  3.25521707e+06  1.44e-03 1.74e-02  8.84e+00    11s
  14  -6.82131616e+04  1.97064324e+06  7.45e-04 1.04e-02  5.38e+00    11s
  15  -4.06588769e+04  7.19085777e+05  3.37e-04 3.78e-03  2.01e+00    11s
  16  -1.46099235e+04  3.37983235e+05  1.77e-04 1.71e-03  9.31e-01    11s
  17  -4.04578776e+03  2.22975885e+05  1.31e-04 1.05e-03  5.99e-01    11s
  18   5.37952812e+03  1.70619263e+05  1.02e-04 7.39e-04  4.36e-01    11s
  19   1.21968714e+04  1.49362131e+05  8.06e-05 6.15e-04  3.62e-01    12s
  20   1.71875942e+04  1.12367116e+05  6.49e-05 4.19e-04  2.51e-01    12s
  21   2.16007825e+04  8.70987641e+04  5.17e-05 2.77e-04  1.73e-01    12s
  22   2.63174261e+04  7.77787955e+04  3.87e-05 2.19e-04  1.36e-01    12s
  23   2.95053131e+04  6.70896178e+04  3.01e-05 1.53e-04  9.92e-02    12s
  24   3.16065121e+04  6.03753078e+04  2.49e-05 1.10e-04  7.60e-02    12s
  25   3.44928676e+04  5.53107935e+04  1.80e-05 7.74e-05  5.50e-02    12s
  26   3.55408686e+04  5.28692528e+04  1.56e-05 6.26e-05  4.58e-02    13s
  27   3.73079918e+04  4.99370309e+04  1.17e-05 4.35e-05  3.33e-02    13s
  28   3.86010829e+04  4.86741829e+04  9.06e-06 3.50e-05  2.66e-02    13s
  29   3.94585207e+04  4.73052786e+04  7.22e-06 2.63e-05  2.07e-02    13s
  30   4.04756964e+04  4.57868333e+04  5.16e-06 1.63e-05  1.40e-02    13s
  31   4.07614120e+04  4.53158119e+04  4.58e-06 1.34e-05  1.20e-02    13s
  32   4.10974173e+04  4.47325328e+04  3.93e-06 9.49e-06  9.60e-03    13s
  33   4.14402941e+04  4.43919343e+04  3.27e-06 7.37e-06  7.79e-03    14s
  34   4.18178145e+04  4.42774035e+04  2.58e-06 6.62e-06  6.49e-03    14s
  35   4.20745883e+04  4.41329390e+04  2.11e-06 5.65e-06  5.43e-03    14s
  36   4.23317963e+04  4.38079392e+04  1.63e-06 3.54e-06  3.90e-03    14s
  37   4.25144135e+04  4.36481129e+04  1.31e-06 2.46e-06  2.99e-03    14s
  38   4.25909109e+04  4.35797155e+04  1.17e-06 2.04e-06  2.61e-03    14s
  39   4.27402118e+04  4.34746852e+04  8.94e-07 1.35e-06  1.94e-03    15s
  40   4.28662312e+04  4.34138982e+04  6.68e-07 9.82e-07  1.45e-03    15s
  41   4.28819200e+04  4.33662558e+04  6.40e-07 6.81e-07  1.28e-03    15s
  42   4.30332032e+04  4.33412524e+04  3.74e-07 5.23e-07  8.13e-04    15s
  43   4.30507761e+04  4.33201701e+04  3.43e-07 3.97e-07  7.11e-04    15s
  44   4.31207105e+04  4.33070329e+04  2.25e-07 3.14e-07  4.92e-04    16s
  45   4.31233679e+04  4.32962282e+04  2.21e-07 2.50e-07  4.56e-04    16s
  46   4.31596949e+04  4.32901877e+04  1.57e-07 2.14e-07  3.45e-04    16s
  47   4.31784592e+04  4.32853436e+04  1.26e-07 1.85e-07  2.82e-04    16s
  48   4.31995314e+04  4.32732959e+04  8.92e-08 1.07e-07  1.95e-04    17s
  49   4.32371098e+04  4.32611413e+04  7.08e-08 3.69e-08  6.35e-05    17s
  50   4.32515025e+04  4.32549109e+04  4.77e-08 3.49e-09  9.00e-06    17s
  51   4.32540449e+04  4.32541040e+04  5.39e-09 3.52e-10  1.56e-07    17s
  52   4.32540960e+04  4.32540960e+04  9.05e-11 6.74e-11  5.06e-12    17s

Barrier solved model in 52 iterations and 17.47 seconds (25.16 work units)
Optimal objective 4.32540960e+04


Root crossover log...

  173595 DPushes remaining with DInf 0.0000000e+00                18s
   37610 DPushes remaining with DInf 0.0000000e+00                20s
       0 DPushes remaining with DInf 0.0000000e+00                24s

    4059 PPushes remaining with PInf 3.4108933e-06                24s
       0 PPushes remaining with PInf 0.0000000e+00                24s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.9014552e-10     24s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   71409    4.3254096e+04   0.000000e+00   0.000000e+00     24s
   71409    4.3254096e+04   0.000000e+00   0.000000e+00     24s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.325410e+04, 71409 iterations, 17.37 seconds (32.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43254.0960    0  333 -190754.47 43254.0960   123%     -   25s
H    0     0                    -135168.4018 43254.0960   132%     -   26s
H    0     0                    -132611.1364 43254.0960   133%     -   26s
H    0     0                    -127855.6451 43254.0960   134%     -   26s
H    0     0                    -95116.54732 43254.0960   145%     -   26s
H    0     0                    -94832.03075 43254.0960   146%     -   27s
H    0     0                    -94224.73212 43254.0960   146%     -   27s
H    0     0                    -93840.71006 43254.0960   146%     -   27s
H    0     0                    -43981.29540 43254.0960   198%     -   27s
H    0     0                    -42817.24386 43254.0960   201%     -   27s
H    0     0                    -42223.27831 43254.0960   202%     -   27s
     0     0 36779.8190    0  309 -42223.278 36779.8190   187%     -  115s
H    0     0                    -13794.46592 36779.8184   367%     -  116s
H    0     0                    -13293.61472 36779.8184   377%     -  116s
     0     0 35953.6842    0  366 -13293.615 35953.6842   370%     -  156s
     0     0 35832.1917    0  352 -13293.615 35832.1917   370%     -  173s
     0     0 35798.9023    0  356 -13293.615 35798.9023   369%     -  177s
     0     0 35766.7885    0  353 -13293.615 35766.7885   369%     -  185s
     0     0 35705.5922    0  367 -13293.615 35705.5922   369%     -  188s
     0     0 35705.1677    0  372 -13293.615 35705.1677   369%     -  191s
     0     0 32520.5029    0  346 -13293.615 32520.5029   345%     -  284s
H    0     0                    -5772.924479 32520.3248   663%     -  285s
H    0     0                    -5637.836207 32520.3248   677%     -  286s
H    0     0                    -5632.450401 32520.3248   677%     -  286s
H    0     0                    -5622.478624 32520.3248   678%     -  286s
H    0     0                    -5594.087143 32520.3248   681%     -  286s
     0     0 31983.0645    0  386 -5594.0871 31983.0645   672%     -  328s
     0     0 31818.8041    0  390 -5594.0871 31818.8041   669%     -  362s
     0     0 31750.6608    0  361 -5594.0871 31750.6608   668%     -  381s
     0     0 31633.6807    0  374 -5594.0871 31633.6807   665%     -  403s
     0     0 31579.5923    0  390 -5594.0871 31579.5923   665%     -  420s
     0     0 31521.8385    0  380 -5594.0871 31521.8385   663%     -  434s
     0     0 31465.5856    0  391 -5594.0871 31465.5856   662%     -  452s
     0     0 31448.0937    0  389 -5594.0871 31448.0937   662%     -  462s
     0     0 31377.8822    0  392 -5594.0871 31377.8822   661%     -  485s
     0     0 31366.4824    0  400 -5594.0871 31366.4824   661%     -  492s
     0     0 31326.5144    0  399 -5594.0871 31326.5144   660%     -  501s
     0     0 31323.1389    0  408 -5594.0871 31323.1389   660%     -  506s
     0     0 31250.3781    0  396 -5594.0871 31250.3781   659%     -  523s
     0     0 31245.1468    0  396 -5594.0871 31245.1468   659%     -  529s
     0     0 31206.2855    0  396 -5594.0871 31206.2855   658%     -  543s
     0     0 31204.7764    0  401 -5594.0871 31204.7764   658%     -  547s
     0     0 31176.4591    0  426 -5594.0871 31176.4591   657%     -  560s
     0     0 31154.6737    0  401 -5594.0871 31154.6737   657%     -  573s
     0     0 31145.5182    0  417 -5594.0871 31145.5182   657%     -  579s
     0     0 31141.4662    0  408 -5594.0871 31141.4662   657%     -  582s
     0     0 31140.4611    0  414 -5594.0871 31140.4611   657%     -  585s
     0     0 29337.6063    0  488 -5594.0871 29337.6063   624%     -  688s
H    0     0                    -5010.655194 29337.3483   685%     -  689s
H    0     0                    -4275.784644 29337.3483   786%     -  689s
H    0     0                    -4059.346400 29337.3483   823%     -  689s
H    0     0                    -3670.367253 29337.3483   899%     -  689s
H    0     0                    -3443.841726 29337.3483   952%     -  689s
     0     0 28674.8170    0  448 -3443.8417 28674.8170   933%     -  757s
     0     0 28559.7835    0  463 -3443.8417 28559.7835   929%     -  785s
     0     0 28494.4119    0  470 -3443.8417 28494.4119   927%     -  809s
     0     0 28439.8968    0  468 -3443.8417 28439.8968   926%     -  834s
     0     0 28421.0341    0  479 -3443.8417 28421.0341   925%     -  847s
     0     0 28372.9467    0  459 -3443.8417 28372.9467   924%     -  860s
     0     0 28339.6281    0  472 -3443.8417 28339.6281   923%     -  870s
     0     0 28326.9713    0  475 -3443.8417 28326.9713   923%     -  881s
     0     0 28325.0076    0  478 -3443.8417 28325.0076   922%     -  885s
     0     0 28320.8148    0  475 -3443.8417 28320.8148   922%     -  891s
     0     0 28319.4043    0  479 -3443.8417 28319.4043   922%     -  896s
     0     0 27549.2218    0  489 -3443.8417 27549.2218   900%     -  971s
H    0     0                    -3435.994751 27548.8656   902%     -  972s
H    0     0                    -3396.643219 27548.8656   911%     -  972s
H    0     0                    -3328.897300 27548.8656   928%     -  973s
H    0     0                    -3321.328529 27548.8656   929%     -  973s
H    0     0                    -3316.088116 27548.8656   931%     -  973s
     0     0 27309.1087    0  498 -3316.0881 27309.1087   924%     - 1014s
     0     0 27241.5169    0  485 -3316.0881 27241.5169   921%     - 1038s
     0     0 27157.1309    0  487 -3316.0881 27157.1309   919%     - 1061s
     0     0 27126.1833    0  482 -3316.0881 27126.1833   918%     - 1076s
     0     0 27114.6212    0  518 -3316.0881 27114.6212   918%     - 1086s
     0     0 27112.4747    0  520 -3316.0881 27112.4747   918%     - 1093s
     0     0 27008.5135    0  512 -3316.0881 27008.5135   914%     - 1126s
     0     0 26973.0416    0  512 -3316.0881 26973.0416   913%     - 1149s
     0     0 26950.8070    0  514 -3316.0881 26950.8070   913%     - 1169s
     0     0 26927.3753    0  514 -3316.0881 26927.3753   912%     - 1182s
     0     0 26917.7990    0  472 -3316.0881 26917.7990   912%     - 1190s
     0     0 26906.6754    0  517 -3316.0881 26906.6754   911%     - 1202s
     0     0 26895.2377    0  541 -3316.0881 26895.2377   911%     - 1215s
     0     0 26880.6986    0  549 -3316.0881 26880.6986   911%     - 1225s
     0     0 26873.0556    0  507 -3316.0881 26873.0556   910%     - 1236s
     0     0 26871.7405    0  518 -3316.0881 26871.7405   910%     - 1241s
     0     0 26841.7147    0  473 -3316.0881 26841.7147   909%     - 1253s
H    0     0                    -2423.171793 26841.4527  1208%     - 1256s
H    0     0                    2679.9961050 26841.4527   902%     - 1256s
H    0     0                    3776.4076409 26841.4527   611%     - 1256s
H    0     0                    4243.6353363 26841.4527   533%     - 1256s
H    0     0                    9037.3118446 26841.4527   197%     - 1256s
H    0     0                    9157.1430005 26841.4527   193%     - 1259s
     0     0 26823.5094    0  483 9157.14300 26823.5094   193%     - 1270s
     0     0 26815.6109    0  479 9157.14300 26815.6109   193%     - 1281s
     0     0 26811.5157    0  486 9157.14300 26811.5157   193%     - 1287s
     0     0 26804.2497    0  480 9157.14300 26804.2497   193%     - 1293s
     0     0 26801.2635    0  486 9157.14300 26801.2635   193%     - 1298s
     0     0 26800.3431    0  482 9157.14300 26800.3431   193%     - 1302s
     0     0 26784.9465    0  471 9157.14300 26784.9465   193%     - 1311s
     0     0 26772.0357    0  470 9157.14300 26772.0357   192%     - 1319s
     0     0 26769.1376    0  470 9157.14300 26769.1376   192%     - 1322s
     0     0 26767.9786    0  470 9157.14300 26767.9786   192%     - 1324s
     0     0 26759.3237    0  487 9157.14300 26759.3237   192%     - 1333s
     0     0 26756.2224    0  474 9157.14300 26756.2224   192%     - 1340s
     0     0 26755.1063    0  475 9157.14300 26755.1063   192%     - 1342s
     0     0 26748.6027    0  479 9157.14300 26748.6027   192%     - 1352s
     0     0 26747.3243    0  477 9157.14300 26747.3243   192%     - 1356s
     0     0 26743.3847    0  475 9157.14300 26743.3847   192%     - 1364s
H    0     0                    9201.7443622 26742.7097   191%     - 1367s
     0     0 26740.4208    0  484 9201.74436 26740.4208   191%     - 1376s
     0     0 26738.8622    0  473 9201.74436 26738.8622   191%     - 1380s
     0     0 26720.9170    0  478 9201.74436 26720.9170   190%     - 1394s
     0     0 26720.7073    0  478 9201.74436 26720.7073   190%     - 1404s
H    0     0                    9474.7033266 26720.6574   182%     - 1520s
H    0     0                    9742.9017414 26720.6574   174%     - 1651s
H    0     0                    10092.960456 26720.6574   165%     - 1655s
H    0     0                    10416.193905 26720.6574   157%     - 1655s
     0     2 26720.6574    0  478 10416.1939 26720.6574   157%     - 1660s
     1     3 26437.3276    1  445 10416.1939 26720.1184   157% 16141 1683s
     2     4 26489.0208    1  478 10416.1939 26489.0208   154% 16962 1712s
     3     5 25175.8262    2  453 10416.1939 26489.0108   154% 18460 1742s
     4     9 26316.1639    2  491 10416.1939 26489.0072   154% 15706 1769s
     8    16 25667.5509    3  493 10416.1939 26315.2236   153% 15594 1851s
    15    31 25005.8574    4  467 10416.1939 26315.2236   153% 19328 1902s
    30    46 24385.6231    5  466 10416.1939 25918.5048   149% 28611 2042s
    45    76 23971.1539    6  476 10416.1939 25918.5048   149% 34709 2334s
H   46    76                    10553.098884 25918.5048   146% 33955 2334s
H   50    76                    12315.853685 25918.5048   110% 32593 2334s
    75   175 25260.8775    5  501 12315.8537 25918.5048   110% 28155 2456s
   174   207 25193.9424    7  481 12315.8537 25918.5048   110% 17918 2501s
H  181   207                    12601.848661 25918.5048   106% 17628 2501s
H  187   207                    13057.490801 25918.5048  98.5% 17285 2501s
   206   269 25161.3095    8  494 13057.4908 25918.5048  98.5% 16714 2574s
   278   301 22517.7359   10  439 13057.4908 25918.5048  98.5% 14925 2635s
   340   316 24729.3281    9  458 13057.4908 25918.5048  98.5% 14524 2685s
   390   315 22126.9019    9  351 13057.4908 25918.5048  98.5% 14322 2738s
   439   335 21386.6753   10  350 13057.4908 25918.5048  98.5% 14027 2793s
   486   330     cutoff   12      13057.4908 25918.5048  98.5% 14173 2842s
   532   350 20086.3813   10  388 13057.4908 25918.5048  98.5% 14285 2894s
   568   400 19516.8100   16  387 13057.4908 25918.5048  98.5% 14481 2938s
   634   456 19508.5299   17  326 13057.4908 25918.5048  98.5% 14357 2980s
   726   491 14511.1194   19  103 13057.4908 25918.5048  98.5% 13668 3017s
   827   500 14252.4667   24  115 13057.4908 25918.5048  98.5% 12738 3053s
   914   527 14049.5612   28   78 13057.4908 25918.5048  98.5% 12186 3089s
   977   564 13405.7793   32   64 13057.4908 25918.5048  98.5% 12112 3125s
  1053   635 19270.0556   22  251 13057.4908 25918.5048  98.5% 11989 3163s
  1152   698 19138.1864   24  250 13057.4908 25918.5048  98.5% 11814 3201s
  1275   715 14872.6642   31   84 13057.4908 25918.5048  98.5% 11461 3240s
  1382   738 infeasible   37      13057.4908 25918.5048  98.5% 10994 3286s
  1462   773 17874.3756   15  143 13057.4908 25918.5048  98.5% 10899 3329s
  1554   779 16399.4272   17  102 13057.4908 25918.5048  98.5% 10695 3374s
  1610   817 15577.5412   20   88 13057.4908 25918.5048  98.5% 10721 3420s
  1684   852 13931.5099   24   38 13057.4908 25918.5048  98.5% 10680 3467s
  1806   863 infeasible   30      13057.4908 25918.5048  98.5% 10419 3518s
  1885   889 17022.2696   14  512 13057.4908 25918.5048  98.5% 10377 3576s
H 1922   889                    13640.115931 25918.5048  90.0% 10525 3576s
  1930   897 infeasible   23      13640.1159 25918.5048  90.0% 10555 3600s

Cutting planes:
  Learned: 7
  Gomory: 3
  Implied bound: 183
  MIR: 4892
  Flow cover: 4862
  RLT: 119
  Relax-and-lift: 761

Explored 1966 nodes (21713642 simplex iterations) in 3600.13 seconds (8078.10 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13640.1 13057.5 12601.8 ... 9201.74

Time limit reached
Best objective 1.364011593057e+04, best bound 2.591850475178e+04, gap 90.0167%
  WARNING: Time limit reached. Using best solution found (gap: 90.02%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 13640.12, θ = 161243.26
  Upper Bound (UB) = 13640.12

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161243.26
  [DEBUG]   ✓ Scenario 0: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 161243.26 ≤ Q = 161243.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 161243.26 ≤ Q = 161243.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 161243.26 ≤ Q = 161243.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 161243.26 ≤ Q = 161243.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 161243.26 ≤ Q = 161243.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 19: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 22: θ = 161243.26 ≤ Q = 161243.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 23: θ = 161243.26 ≤ Q = 161243.26 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 24] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x408de0bd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbf721f43
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.344037e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1429 nonzeros
Found heuristic solution: objective 6772433.1279
Variable types: 346 continuous, 166 integer (166 binary)

Root relaxation: objective -1.438511e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143851.11    0  120 6772433.13 -143851.11   102%     -    0s
H    0     0                    -94926.15099 -143851.11  51.5%     -    0s
H    0     0                    -95854.62522 -143851.11  50.1%     -    0s
H    0     0                    -107667.7445 -143851.11  33.6%     -    0s
     0     0 -117992.27    0   61 -107667.74 -117992.27  9.59%     -    0s
H    0     0                    -115602.6731 -117930.66  2.01%     -    0s
H    0     0                    -116781.5023 -117930.66  0.98%     -    0s
     0     0 -117367.39    0   65 -116781.50 -117367.39  0.50%     -    0s
     0     0 -117190.91    0   41 -116781.50 -117190.91  0.35%     -    0s
     0     0 -117167.17    0   39 -116781.50 -117167.17  0.33%     -    0s
     0     0 -117087.15    0   37 -116781.50 -117087.15  0.26%     -    0s
     0     0 -117060.89    0   37 -116781.50 -117060.89  0.24%     -    0s
H    0     0                    -116788.6232 -117060.89  0.23%     -    0s
     0     0 -117060.89    0   71 -116788.62 -117060.89  0.23%     -    0s
     0     0 -117060.89    0   38 -116788.62 -117060.89  0.23%     -    0s
     0     0 -117060.89    0   37 -116788.62 -117060.89  0.23%     -    0s
     0     0 -117025.30    0   38 -116788.62 -117025.30  0.20%     -    0s
     0     0 -117019.19    0   38 -116788.62 -117019.19  0.20%     -    0s
     0     0 -117018.05    0   38 -116788.62 -117018.05  0.20%     -    0s
H    0     0                    -116812.6653 -117018.05  0.18%     -    0s
     0     0 -116951.73    0   34 -116812.67 -116951.73  0.12%     -    0s
     0     0 -116933.62    0   19 -116812.67 -116933.62  0.10%     -    0s
     0     0 -116918.82    0   21 -116812.67 -116918.82  0.09%     -    0s
     0     0 -116912.87    0   16 -116812.67 -116912.87  0.09%     -    0s
     0     0 -116896.93    0   17 -116812.67 -116896.93  0.07%     -    0s
     0     0 -116896.84    0   17 -116812.67 -116896.84  0.07%     -    0s
     0     0 -116833.47    0    6 -116812.67 -116833.47  0.02%     -    0s
     0     0 -116829.79    0    8 -116812.67 -116829.79  0.01%     -    0s
     0     0 -116815.53    0    2 -116812.67 -116815.53  0.00%     -    0s
*    0     0               0    -116813.8972 -116813.90  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 2
  Flow cover: 2
  Relax-and-lift: 3

Explored 1 nodes (1007 simplex iterations) in 0.10 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -116814 -116813 -116789 ... 6.77243e+06
No other solutions better than -116814

Optimal solution found (tolerance 1.00e-06)
Best objective -1.168138972255e+05, best bound -1.168138972255e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 156046.93
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116813.90
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -116813.90 = 156046.93
  [DEBUG]   Current θ from Master = 161243.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5196.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 8443.78
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 1050.3542, Absolute Gap = 1050.3542, Relative Gap = 0.077005
  Not converged yet (gap = 1050.35 > ε = 200)

  [DEBUG] Adding NEW scenario 24 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 24 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 24 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 24]
    [DEBUG]   - Total constraints in model: 383633
    [DEBUG]   - Total variables in model: 158260
  [DEBUG] Total scenarios in Master: 25
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 25
================================================================================
[Iteration 25] Solving Master Problem...
  Current scenarios in Master: 25
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 383633 rows, 158260 columns and 1086594 nonzeros
Model fingerprint: 0x2e6cd23b
Variable types: 156001 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 166810 rows and 67730 columns (presolve time = 5s)...
Presolve removed 166810 rows and 67730 columns
Presolve time: 5.26s
Presolved: 216823 rows, 90530 columns, 1333842 nonzeros
Variable types: 88271 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -338809.9989
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.98s

Barrier statistics:
 Dense cols : 1200
 AA' NZ     : 5.759e+06
 Factor NZ  : 1.617e+07 (roughly 260 MB of memory)
 Factor Ops : 5.988e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.44218913e+07  3.43975558e+08  1.50e+05 1.26e+01  9.93e+04     9s
   1  -1.91613092e+07  3.18967280e+08  1.09e+05 5.36e+01  7.12e+04    10s
   2  -8.32250781e+06  2.45845757e+08  4.63e+04 7.28e+00  3.24e+04    10s
   3  -2.16672837e+06  2.23635347e+08  8.37e+03 4.04e+00  6.26e+03    10s
   4  -7.47012995e+05  1.38823395e+08  1.40e+03 7.39e-01  1.25e+03    10s
   5  -5.27172707e+05  9.41446222e+07  4.85e+02 4.22e-01  5.31e+02    10s
   6  -4.35739390e+05  7.05389925e+07  1.72e+02 2.90e-01  2.77e+02    10s
   7  -4.01080237e+05  4.85386826e+07  7.71e+01 1.92e-01  1.63e+02    10s
   8  -3.75755360e+05  3.49369024e+07  3.17e+01 1.32e-01  1.03e+02    10s
   9  -3.65528334e+05  2.69464396e+07  2.57e+01 1.01e-01  7.89e+01    10s
  10  -2.59147650e+05  2.00153687e+07  3.26e+00 7.27e-02  5.24e+01    11s
  11  -2.00922067e+05  9.14821934e+06  1.23e+00 3.17e-02  2.39e+01    11s
  12  -1.16621868e+05  5.98372074e+06  4.95e-01 2.03e-02  1.55e+01    11s
  13  -1.11738173e+05  5.42625353e+06  4.42e-01 1.84e-02  1.41e+01    11s
  14  -8.37767902e+04  2.68323452e+06  2.14e-01 8.85e-03  7.03e+00    11s
  15  -6.24792374e+04  1.91974981e+06  1.11e-01 6.26e-03  5.03e+00    11s
  16  -3.68142916e+04  4.56227122e+05  3.89e-02 1.30e-03  1.25e+00    11s
  17  -2.18431045e+04  3.12076318e+05  2.59e-02 1.01e-03  8.47e-01    11s
  18  -2.36181746e+03  1.99886420e+05  1.58e-02 1.31e-03  5.13e-01    11s
  19   7.44895453e+03  1.32335203e+05  1.23e-02 6.91e-04  3.17e-01    11s
  20   1.56650734e+04  1.10849623e+05  9.17e-03 5.19e-04  2.41e-01    12s
  21   1.87046446e+04  1.00907036e+05  7.96e-03 4.44e-04  2.09e-01    12s
  22   2.15593226e+04  8.17336962e+04  6.86e-03 3.06e-04  1.53e-01    12s
  23   2.49986332e+04  7.16238781e+04  5.55e-03 4.38e-04  1.18e-01    12s
  24   2.84258133e+04  6.66056367e+04  4.35e-03 3.65e-04  9.69e-02    12s
  25   3.06394784e+04  6.12658328e+04  3.60e-03 2.83e-04  7.77e-02    12s
  26   3.18097959e+04  5.69013853e+04  3.23e-03 2.51e-04  6.37e-02    12s
  27   3.32804202e+04  5.38893635e+04  2.79e-03 1.97e-04  5.23e-02    13s
  28   3.48600245e+04  5.29066468e+04  2.30e-03 1.78e-04  4.58e-02    13s
  29   3.53599228e+04  4.92411954e+04  2.14e-03 2.33e-04  3.52e-02    13s
  30   3.70579272e+04  4.81588883e+04  1.65e-03 1.90e-04  2.82e-02    13s
  31   3.82155785e+04  4.72523574e+04  1.34e-03 1.54e-04  2.29e-02    13s
  32   3.89324609e+04  4.62035281e+04  1.14e-03 1.23e-04  1.84e-02    13s
  33   3.98374536e+04  4.55761866e+04  8.89e-04 9.45e-05  1.46e-02    13s
  34   4.05400767e+04  4.52500199e+04  6.91e-04 8.01e-05  1.19e-02    14s
  35   4.07921906e+04  4.50816405e+04  6.20e-04 7.35e-05  1.09e-02    14s
  36   4.13089286e+04  4.44597781e+04  4.86e-04 4.83e-05  7.99e-03    14s
  37   4.17764127e+04  4.43568710e+04  3.65e-04 4.40e-05  6.55e-03    14s
  38   4.19299301e+04  4.42534871e+04  3.25e-04 4.01e-05  5.89e-03    14s
  39   4.20269670e+04  4.39340302e+04  2.99e-04 2.77e-05  4.84e-03    14s
  40   4.23486941e+04  4.36760791e+04  2.18e-04 1.65e-05  3.37e-03    15s
  41   4.25275148e+04  4.35554553e+04  1.74e-04 1.14e-05  2.61e-03    15s
  42   4.26280599e+04  4.34865622e+04  1.50e-04 8.79e-06  2.18e-03    15s
  43   4.27764268e+04  4.34351631e+04  1.14e-04 6.75e-06  1.67e-03    15s
  44   4.29329071e+04  4.33764131e+04  7.57e-05 4.57e-06  1.13e-03    15s
  45   4.29609051e+04  4.33445751e+04  6.90e-05 3.38e-06  9.73e-04    15s
  46   4.30164265e+04  4.33085384e+04  5.59e-05 3.65e-06  7.41e-04    16s
  47   4.30669624e+04  4.32904033e+04  4.41e-05 2.54e-06  5.67e-04    16s
  48   4.30999486e+04  4.32851025e+04  3.62e-05 2.17e-06  4.70e-04    16s
  49   4.31386782e+04  4.32724289e+04  2.68e-05 1.73e-06  3.39e-04    16s
  50   4.31504717e+04  4.32713938e+04  2.41e-05 1.64e-06  3.07e-04    16s
  51   4.31656337e+04  4.32645224e+04  2.04e-05 1.12e-06  2.51e-04    16s
  52   4.32070189e+04  4.32610122e+04  1.08e-05 3.09e-06  1.37e-04    16s
  53   4.32344271e+04  4.32576368e+04  4.14e-06 1.41e-06  5.89e-05    17s
  54   4.32519599e+04  4.32548914e+04  3.95e-07 4.48e-07  7.44e-06    17s
  55   4.32540518e+04  4.32541260e+04  7.68e-09 1.18e-08  1.89e-07    17s
  56   4.32540960e+04  4.32540960e+04  4.03e-10 1.34e-10  1.93e-11    17s

Barrier solved model in 56 iterations and 16.93 seconds (24.22 work units)
Optimal objective 4.32540960e+04


Root crossover log...

  180944 DPushes remaining with DInf 3.9508334e-09                17s
   50880 DPushes remaining with DInf 0.0000000e+00                20s
    1603 DPushes remaining with DInf 0.0000000e+00                25s
       0 DPushes remaining with DInf 0.0000000e+00                26s

    4969 PPushes remaining with PInf 4.8855190e-06                26s
       0 PPushes remaining with PInf 0.0000000e+00                26s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6131381e-10     26s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   74716    4.3254096e+04   0.000000e+00   0.000000e+00     26s
   74716    4.3254096e+04   0.000000e+00   0.000000e+00     26s
Concurrent spin time: 3.16s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.325410e+04, 74716 iterations, 23.07 seconds (43.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43254.0960    0  333 -190754.47 43254.0960   123%     -   30s
H    0     0                    -186184.2792 43254.0960   123%     -   30s
H    0     0                    -92850.93897 43254.0960   147%     -   31s
H    0     0                    -92079.73161 43254.0960   147%     -   32s
H    0     0                    -91785.15855 43254.0960   147%     -   32s
H    0     0                    -91466.91768 43254.0960   147%     -   32s
H    0     0                    -91293.34023 43254.0960   147%     -   32s
H    0     0                    -91204.75293 43254.0960   147%     -   32s
H    0     0                    -5058.451034 43254.0960   955%     -   32s
H    0     0                    -4995.926201 43254.0960   966%     -   32s
H    0     0                    -4930.020272 43254.0960   977%     -   33s
H    0     0                    -4888.513046 43254.0960   985%     -   33s
H    0     0                    -4878.907356 43254.0960   987%     -   33s
H    0     0                    -4850.140909 43254.0960   992%     -   33s
     0     0 36519.1783    0  324 -4850.1409 36519.1783   853%     -  113s
H    0     0                    -2855.478939 36518.6421  1379%     -  116s
H    0     0                    -2853.241271 36518.6421  1380%     -  116s
H    0     0                    -2757.452672 36518.6421  1424%     -  116s
H    0     0                    -2667.172778 36518.6421  1469%     -  116s
H    0     0                    -2518.236007 36518.6421  1550%     -  116s
     0     0 35975.7440    0  365 -2518.2360 35975.7440  1529%     -  146s
     0     0 35893.1567    0  348 -2518.2360 35893.1567  1525%     -  160s
     0     0 35870.7677    0  355 -2518.2360 35870.7677  1524%     -  166s
     0     0 35868.9948    0  355 -2518.2360 35868.9948  1524%     -  168s
     0     0 35818.2797    0  354 -2518.2360 35818.2797  1522%     -  176s
     0     0 35806.7630    0  359 -2518.2360 35806.7630  1522%     -  179s
     0     0 35806.5138    0  356 -2518.2360 35806.5138  1522%     -  181s
     0     0 32340.6982    0  371 -2518.2360 32340.6982  1384%     -  261s
H    0     0                    6567.7834261 32340.4105   392%     -  262s
H    0     0                    6801.7937644 32340.4105   375%     -  262s
H    0     0                    6923.9385253 32340.4105   367%     -  262s
H    0     0                    6948.6422154 32340.4105   365%     -  262s
H    0     0                    7104.1248563 32340.4105   355%     -  262s
     0     0 31869.6624    0  433 7104.12486 31869.6624   349%     -  312s
     0     0 31793.1551    0  434 7104.12486 31793.1551   348%     -  334s
     0     0 31757.5916    0  401 7104.12486 31757.5916   347%     -  352s
     0     0 31735.4396    0  421 7104.12486 31735.4396   347%     -  367s
     0     0 31557.1507    0  438 7104.12486 31557.1507   344%     -  392s
     0     0 31516.0740    0  439 7104.12486 31516.0740   344%     -  408s
     0     0 31443.6230    0  428 7104.12486 31443.6230   343%     -  432s
     0     0 31431.3265    0  430 7104.12486 31431.3265   342%     -  447s
     0     0 31384.0935    0  432 7104.12486 31384.0935   342%     -  467s
     0     0 31256.2048    0  454 7104.12486 31256.2048   340%     -  490s
     0     0 31245.5918    0  455 7104.12486 31245.5918   340%     -  502s
     0     0 31224.0366    0  449 7104.12486 31224.0366   340%     -  516s
     0     0 31206.9149    0  459 7104.12486 31206.9149   339%     -  528s
     0     0 31204.6350    0  455 7104.12486 31204.6350   339%     -  533s
     0     0 31174.8315    0  461 7104.12486 31174.8315   339%     -  545s
     0     0 31150.6680    0  445 7104.12486 31150.6680   338%     -  556s
     0     0 31143.8201    0  444 7104.12486 31143.8201   338%     -  565s
     0     0 31140.5177    0  451 7104.12486 31140.5177   338%     -  571s
     0     0 31092.4831    0  456 7104.12486 31092.4831   338%     -  582s
     0     0 31083.3128    0  465 7104.12486 31083.3128   338%     -  592s
     0     0 31080.2244    0  463 7104.12486 31080.2244   337%     -  596s
     0     0 31071.4587    0  468 7104.12486 31071.4587   337%     -  601s
     0     0 31066.8116    0  469 7104.12486 31066.8116   337%     -  604s
     0     0 31065.3856    0  476 7104.12486 31065.3856   337%     -  606s
     0     0 31033.2641    0  467 7104.12486 31033.2641   337%     -  617s
     0     0 31026.1325    0  473 7104.12486 31026.1325   337%     -  622s
     0     0 31025.3426    0  467 7104.12486 31025.3426   337%     -  623s
     0     0 29202.0528    0  377 7104.12486 29202.0528   311%     -  719s
H    0     0                    7150.5321630 29202.0136   308%     -  720s
     0     0 28735.9649    0  455 7150.53216 28735.9649   302%     -  771s
     0     0 28509.2014    0  445 7150.53216 28509.2014   299%     -  809s
     0     0 28388.1379    0  488 7150.53216 28388.1379   297%     -  830s
     0     0 28347.5564    0  493 7150.53216 28347.5564   296%     -  840s
     0     0 28333.8167    0  490 7150.53216 28333.8167   296%     -  848s
     0     0 28317.0576    0  498 7150.53216 28317.0576   296%     -  856s
     0     0 28303.6271    0  497 7150.53216 28303.6271   296%     -  864s
     0     0 28298.7780    0  497 7150.53216 28298.7780   296%     -  870s
     0     0 28225.9516    0  503 7150.53216 28225.9516   295%     -  886s
     0     0 28217.9354    0  509 7150.53216 28217.9354   295%     -  892s
     0     0 28211.6514    0  504 7150.53216 28211.6514   295%     -  897s
     0     0 28208.5395    0  507 7150.53216 28208.5395   294%     -  900s
     0     0 28201.6653    0  509 7150.53216 28201.6653   294%     -  905s
     0     0 28186.9145    0  504 7150.53216 28186.9145   294%     -  914s
     0     0 28161.4619    0  508 7150.53216 28161.4619   294%     -  925s
     0     0 28155.4840    0  509 7150.53216 28155.4840   294%     -  934s
     0     0 28151.8258    0  510 7150.53216 28151.8258   294%     -  941s
     0     0 28149.7214    0  510 7150.53216 28149.7214   294%     -  947s
     0     0 28148.1172    0  511 7150.53216 28148.1172   294%     -  952s
     0     0 27469.8768    0  474 7150.53216 27469.8768   284%     - 1032s
H    0     0                    7153.8427202 27469.7777   284%     - 1033s
     0     0 27350.8116    0  482 7153.84272 27350.8116   282%     - 1058s
     0     0 27299.4926    0  470 7153.84272 27299.4926   282%     - 1076s
     0     0 27269.1442    0  467 7153.84272 27269.1442   281%     - 1086s
     0     0 27260.3177    0  464 7153.84272 27260.3177   281%     - 1095s
     0     0 27256.8706    0  474 7153.84272 27256.8706   281%     - 1099s
     0     0 27248.6594    0  477 7153.84272 27248.6594   281%     - 1103s
     0     0 27239.8421    0  474 7153.84272 27239.8421   281%     - 1110s
     0     0 27232.9236    0  461 7153.84272 27232.9236   281%     - 1116s
     0     0 27217.1402    0  470 7153.84272 27217.1402   280%     - 1124s
     0     0 27208.8923    0  476 7153.84272 27208.8923   280%     - 1131s
     0     0 27202.8448    0  463 7153.84272 27202.8448   280%     - 1136s
     0     0 27201.6251    0  480 7153.84272 27201.6251   280%     - 1138s
     0     0 27123.1978    0  500 7153.84272 27123.1978   279%     - 1168s
     0     0 27064.7846    0  505 7153.84272 27064.7846   278%     - 1194s
     0     0 27049.0818    0  557 7153.84272 27049.0818   278%     - 1206s
     0     0 27038.9347    0  551 7153.84272 27038.9347   278%     - 1218s
     0     0 27030.5687    0  503 7153.84272 27030.5687   278%     - 1227s
     0     0 27025.9214    0  500 7153.84272 27025.9214   278%     - 1234s
     0     0 27024.1404    0  499 7153.84272 27024.1404   278%     - 1237s
     0     0 26965.1121    0  475 7153.84272 26965.1121   277%     - 1261s
H    0     0                    7328.2442683 26964.9466   268%     - 1262s
H    0     0                    7398.9951936 26964.9466   264%     - 1263s
H    0     0                    7498.3218079 26964.9466   260%     - 1263s
H    0     0                    7499.1373898 26964.9466   260%     - 1263s
H    0     0                    7508.4305994 26964.9466   259%     - 1263s
     0     0 26933.8486    0  489 7508.43060 26933.8486   259%     - 1279s
     0     0 26920.2385    0  493 7508.43060 26920.2385   259%     - 1290s
     0     0 26915.9502    0  499 7508.43060 26915.9502   258%     - 1295s
     0     0 26914.5713    0  502 7508.43060 26914.5713   258%     - 1300s
     0     0 26865.0237    0  517 7508.43060 26865.0237   258%     - 1324s
     0     0 26852.5261    0  506 7508.43060 26852.5261   258%     - 1339s
     0     0 26846.1415    0  506 7508.43060 26846.1415   258%     - 1347s
     0     0 26840.3001    0  502 7508.43060 26840.3001   257%     - 1353s
     0     0 26836.5024    0  492 7508.43060 26836.5024   257%     - 1359s
     0     0 26834.6961    0  504 7508.43060 26834.6961   257%     - 1363s
     0     0 26810.3836    0  489 7508.43060 26810.3836   257%     - 1379s
H    0     0                    7546.8027369 26809.2445   255%     - 1380s
     0     0 26797.0100    0  490 7546.80274 26797.0100   255%     - 1391s
     0     0 26791.8867    0  498 7546.80274 26791.8867   255%     - 1399s
     0     0 26789.5328    0  499 7546.80274 26789.5328   255%     - 1403s
     0     0 26783.4223    0  483 7546.80274 26783.4223   255%     - 1415s
     0     0 26781.6885    0  488 7546.80274 26781.6885   255%     - 1421s
     0     0 26775.4321    0  494 7546.80274 26775.4321   255%     - 1434s
H    0     0                    8575.2291966 26775.2519   212%     - 1435s
     0     0 26768.7290    0  496 8575.22920 26768.7290   212%     - 1446s
     0     0 26767.0848    0  506 8575.22920 26767.0848   212%     - 1450s
     0     0 26765.6801    0  501 8575.22920 26765.6801   212%     - 1456s
H    0     0                    8852.9591182 26764.5000   202%     - 1457s
H    0     0                    8915.4839514 26764.5000   200%     - 1457s
     0     0 26764.5000    0  505 8915.48395 26764.5000   200%     - 1459s
     0     0 26762.5248    0  501 8915.48395 26762.5248   200%     - 1467s
     0     0 26762.4483    0  501 8915.48395 26762.4483   200%     - 1480s
H    0     0                    9914.9427291 26762.3543   170%     - 1564s
H    0     0                    9919.5359431 26762.3543   170%     - 1564s
H    0     0                    10297.046880 26762.3543   160%     - 1691s
H    0     0                    10678.877712 26762.3543   151%     - 1691s
H    0     0                    11389.319525 26762.3543   135%     - 1698s
H    0     0                    12275.251969 26762.3543   118%     - 1698s
H    0     0                    12308.043325 26762.3543   117%     - 1698s
H    0     0                    12336.799596 26762.3543   117%     - 1699s
H    0     0                    12453.282747 26762.3543   115%     - 1699s
     0     2 26762.3543    0  501 12453.2827 26762.3543   115%     - 1701s
     1     3 26504.1698    1  452 12453.2827 26762.2466   115% 12355 1722s
     2     4 26466.8625    1  475 12453.2827 26504.1275   113% 17256 1754s
     3     5 24772.6124    2  451 12453.2827 26504.1275   113% 25538 1823s
     4    10 24486.6125    3  447 12453.2827 26504.1275   113% 22766 1857s
     9    16 23560.8575    4  432 12453.2827 26271.4771   111% 18162 1951s
    15    32 23512.3290    5  431 12453.2827 26267.1488   111% 23019 1997s
    31    48 25165.9664    4  503 12453.2827 25806.6743   107% 27122 2122s
    47    78 22954.4087    5  393 12453.2827 25806.6743   107% 31818 2203s
H   48    78                    12507.685461 25806.6743   106% 31155 2203s
    77   177 22947.9131    6  372 12507.6855 25806.6743   106% 23930 2290s
   176   209 22384.0927    8  363 12507.6855 25806.6743   106% 14447 2336s
H  190   209                    12541.614372 25806.6743   106% 13812 2336s
H  208   236                    13242.379476 25806.6743  94.9% 13525 2373s
   236   321 21196.8747   10  274 13242.3795 25806.6743  94.9% 12976 2417s
   336   366 21177.5051   11  286 13242.3795 25806.6743  94.9% 11003 2448s
   432   379 20659.4954   12  278 13242.3795 25806.6743  94.9% 10026 2479s
   508   395 20248.5010   13  190 13242.3795 25806.6743  94.9%  9559 2504s
   518   395     cutoff   24      13242.3795 25806.6743  94.9%  9555 2505s
   573   398 19769.1320   15  185 13242.3795 25806.6743  94.9%  9475 2532s
   636   394 infeasible   23      13242.3795 25806.6743  94.9%  9319 2563s
   680   438 19756.7991   14  194 13242.3795 25806.6743  94.9%  9268 2590s
   756   486 18370.7308   22  250 13242.3795 25806.6743  94.9%  8984 2612s
   844   484 17779.9082   15  176 13242.3795 25806.6743  94.9%  8558 2636s
   941   487 17243.2667   16  154 13242.3795 25806.6743  94.9%  8177 2662s
   995   516 14765.2921   16  181 13242.3795 25806.6743  94.9%  8190 2690s
  1044   505 14143.9528   17  166 13242.3795 25806.6743  94.9%  8252 2718s
  1125   499     cutoff   28      13242.3795 25806.6743  94.9%  8084 2755s
  1169   537 21964.3755   15  395 13242.3795 25806.6743  94.9%  8026 2788s
  1211   572 21871.8601   17  316 13242.3795 25806.6743  94.9%  8085 2820s
  1264   599 17653.8506   18  169 13242.3795 25806.6743  94.9%  8094 2850s
  1335   601 19366.6810   16  348 13242.3795 25806.6743  94.9%  8056 2885s
  1407   606 16511.5763   19  246 13242.3795 25806.6743  94.9%  7977 2928s
  1464   620 15524.2252   19  231 13242.3795 25806.6743  94.9%  8101 2997s
  1529   647 16317.4916   20  162 13242.3795 25806.6743  94.9%  8088 3034s
  1582   704 15225.8174   22  157 13242.3795 25806.6743  94.9%  8264 3071s
  1657   802 14974.8456   23  141 13242.3795 25806.6743  94.9%  8333 3112s
  1786   905     cutoff   24      13242.3795 25806.6743  94.9%  8284 3155s
  1919  1006 infeasible   36      13242.3795 25806.6743  94.9%  8235 3194s
  2056  1077 14026.7091   37  198 13242.3795 25806.6743  94.9%  8161 3234s
  2215  1151 13566.6106   40  191 13242.3795 25806.6743  94.9%  8001 3276s
  2402  1203 13355.8315   42  100 13242.3795 25806.6743  94.9%  7842 3320s
  2574  1232 13985.4126   44  122 13242.3795 25806.6743  94.9%  7696 3369s
  2706  1251 13450.1744   47  121 13242.3795 25806.6743  94.9%  7662 3423s
  2822  1269 21935.8640    9  272 13242.3795 25806.6743  94.9%  7658 3477s
  2877  1332 16690.5255   10  152 13242.3795 25806.6743  94.9%  7720 3535s
  2984  1369 19515.5446   19  274 13242.3795 25806.6743  94.9%  7797 3594s
  3084  1367 infeasible   21      13242.3795 25806.6743  94.9%  7899 3600s

Cutting planes:
  Learned: 3
  Gomory: 1
  Implied bound: 237
  MIR: 5577
  Flow cover: 5583
  Zero half: 1
  RLT: 111
  Relax-and-lift: 918

Explored 3092 nodes (25368413 simplex iterations) in 3600.09 seconds (8204.88 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13242.4 12541.6 12507.7 ... 10297

Time limit reached
Best objective 1.324237947563e+04, best bound 2.580667429473e+04, gap 94.8794%
  WARNING: Time limit reached. Using best solution found (gap: 94.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 13242.38, θ = 159811.10
  Upper Bound (UB) = 13242.38

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 159811.10
  [DEBUG]   ✓ Scenario 0: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 21: θ = 159811.10 ≤ Q = 159811.10 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG]   ✓ Scenario 24: θ = 159811.10 ≤ Q = 159811.10 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 25] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xf4194bd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf0be6b43
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.323772e+13
Presolve removed 2574 rows and 1866 columns
Presolve time: 0.00s
Presolved: 519 rows, 523 columns, 1464 nonzeros
Found heuristic solution: objective 6683817.2846
Variable types: 355 continuous, 168 integer (168 binary)

Root relaxation: objective -1.448330e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144833.00    0  122 6683817.28 -144833.00   102%     -    0s
H    0     0                    -110001.1873 -144833.00  31.7%     -    0s
H    0     0                    -110519.3352 -144833.00  31.0%     -    0s
     0     0 -122500.81    0  112 -110519.34 -122500.81  10.8%     -    0s
H    0     0                    -118400.9532 -122351.20  3.34%     -    0s
     0     0 -121284.64    0  112 -118400.95 -121284.64  2.44%     -    0s
H    0     0                    -119888.1354 -121279.58  1.16%     -    0s
     0     0 -121209.54    0  112 -119888.14 -121209.54  1.10%     -    0s
     0     0 -121067.43    0   89 -119888.14 -121067.43  0.98%     -    0s
     0     0 -120895.44    0   86 -119888.14 -120895.44  0.84%     -    0s
     0     0 -120796.02    0   92 -119888.14 -120796.02  0.76%     -    0s
H    0     0                    -119897.0163 -120775.09  0.73%     -    0s
     0     0 -120730.20    0   90 -119897.02 -120730.20  0.69%     -    0s
     0     0 -120715.52    0   92 -119897.02 -120715.52  0.68%     -    0s
     0     0 -120554.75    0   88 -119897.02 -120554.75  0.55%     -    0s
     0     0 -120492.98    0   88 -119897.02 -120492.98  0.50%     -    0s
     0     0 -120487.58    0   91 -119897.02 -120487.58  0.49%     -    0s
     0     0 -120450.00    0   88 -119897.02 -120450.00  0.46%     -    0s
     0     0 -120448.89    0   88 -119897.02 -120448.89  0.46%     -    0s
H    0     0                    -120032.1282 -120448.89  0.35%     -    0s
H    0     0                    -120075.2545 -120448.89  0.31%     -    0s
     0     2 -120448.89    0   88 -120075.25 -120448.89  0.31%     -    0s
H   33    44                    -120100.4791 -120349.62  0.21%  17.2    0s
H   36    42                    -120161.1738 -120340.29  0.15%  16.6    0s
H   41    41                    -120162.6234 -120339.79  0.15%  15.7    0s
H  266   217                    -120163.6090 -120277.64  0.09%   7.1    0s
H  296   217                    -120173.5458 -120277.64  0.09%   7.0    0s
H  361   217                    -120186.3983 -120277.64  0.08%   6.8    0s
H  584   307                    -120198.0755 -120263.32  0.05%   6.0    0s
*  734   286              27    -120198.8190 -120253.17  0.05%   6.0    0s
H  832   286                    -120208.8257 -120251.34  0.04%   5.9    0s
H  954   240                    -120215.2328 -120247.37  0.03%   5.9    0s
H 1008   240                    -120216.4232 -120247.37  0.03%   5.9    0s

Cutting planes:
  Gomory: 45
  Implied bound: 4
  MIR: 172
  Flow cover: 14
  RLT: 25
  Relax-and-lift: 1
  BQP: 2

Explored 1397 nodes (8293 simplex iterations) in 0.12 seconds (0.12 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120216 -120215 -120209 ... -120161
No other solutions better than -120216

Optimal solution found (tolerance 1.00e-06)
Best objective -1.202164231579e+05, best bound -1.202164231579e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 152644.40
  Scenario: 19 demand increases, 41 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120216.42
  [DEBUG]   S×d_nominal = 272860.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 272860.82 + -120216.42 = 152644.40
  [DEBUG]   Current θ from Master = 159811.10
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7166.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6075.68
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = 652.6178, Absolute Gap = 652.6178, Relative Gap = 0.049283
  Not converged yet (gap = 652.62 > ε = 200)

  [DEBUG] Adding NEW scenario 25 to Master Problem...
  [DEBUG] New scenario pattern: 19 increases, 41 decreases
    [DEBUG] Scenario 25 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 25 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 25]
    [DEBUG]   - Total constraints in model: 398923
    [DEBUG]   - Total variables in model: 164500
  [DEBUG] Total scenarios in Master: 26
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 26
================================================================================
[Iteration 26] Solving Master Problem...
  Current scenarios in Master: 26
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 398923 rows, 164500 columns and 1129837 nonzeros
Model fingerprint: 0xff998c2a
Variable types: 162241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 173496 rows and 70446 columns (presolve time = 5s)...
Presolve removed 173496 rows and 70446 columns
Presolve time: 5.95s
Presolved: 225427 rows, 94054 columns, 1386518 nonzeros
Variable types: 91795 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -339222.7835
Found heuristic solution: objective -190754.4736

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 2.22s

Barrier statistics:
 Dense cols : 1200
 AA' NZ     : 6.134e+06
 Factor NZ  : 1.732e+07 (roughly 270 MB of memory)
 Factor Ops : 6.649e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.51380490e+07  3.55684092e+08  1.55e+05 1.24e+01  1.02e+05    10s
   1  -1.99285778e+07  3.31089302e+08  1.13e+05 5.34e+01  7.40e+04    10s
   2  -7.96832289e+06  2.60295623e+08  4.63e+04 6.47e+00  3.21e+04    11s
   3  -6.43609804e+06  2.46817344e+08  3.73e+04 4.33e+00  2.58e+04    11s
   4  -2.55692326e+06  2.31200047e+08  1.07e+04 3.24e+00  7.89e+03    11s
   5  -9.32117517e+05  1.46826286e+08  1.66e+03 5.31e-01  1.43e+03    11s
   6  -7.16192827e+05  1.15788129e+08  5.22e+02 3.79e-01  6.07e+02    11s
   7  -5.04151622e+05  7.51446465e+07  3.84e+02 2.12e-01  4.03e+02    11s
   8  -4.50764754e+05  5.32588123e+07  2.17e+02 1.42e-01  2.47e+02    11s
   9  -3.84933733e+05  3.39506694e+07  6.97e+01 8.30e-02  1.17e+02    11s
  10  -2.95459187e+05  2.33867419e+07  1.53e+01 5.32e-02  6.38e+01    12s
  11  -1.80998146e+05  1.96763438e+07  3.40e+00 4.42e-02  4.96e+01    12s
  12  -1.50571088e+05  1.21783827e+07  2.35e+00 2.69e-02  3.06e+01    12s
  13  -1.27894306e+05  8.35319678e+06  1.67e+00 1.83e-02  2.10e+01    12s
  14  -9.53103389e+04  4.88991828e+06  8.00e-01 1.05e-02  1.22e+01    12s
  15  -8.56516306e+04  3.39076494e+06  5.77e-01 7.25e-03  8.52e+00    12s
  16  -6.15321397e+04  6.74506673e+05  2.26e-01 1.35e-03  1.80e+00    12s
  17  -4.08221745e+04  3.39455885e+05  1.32e-01 9.95e-04  9.29e-01    12s
  18  -1.08732291e+04  2.21795635e+05  6.86e-02 1.15e-03  5.68e-01    12s
  19  -6.80032842e+02  1.48188438e+05  5.35e-02 1.20e-03  3.64e-01    13s
  20   6.98686400e+03  1.21235421e+05  4.40e-02 1.75e-03  2.79e-01    13s
  21   1.09460896e+04  1.12345816e+05  3.90e-02 1.67e-03  2.48e-01    13s
  22   1.46602829e+04  9.67211286e+04  3.41e-02 1.32e-03  2.00e-01    13s
  23   1.92523354e+04  8.66361455e+04  2.82e-02 1.33e-03  1.65e-01    13s
  24   2.37401849e+04  7.34280552e+04  2.22e-02 1.23e-03  1.21e-01    13s
  25   2.52767495e+04  6.49374770e+04  2.03e-02 9.47e-04  9.69e-02    13s
  26   2.84002886e+04  6.15381239e+04  1.65e-02 7.68e-04  8.10e-02    13s
  27   3.09631756e+04  5.66381513e+04  1.34e-02 5.71e-04  6.27e-02    14s
  28   3.22814018e+04  5.41835894e+04  1.18e-02 5.93e-04  5.35e-02    14s
  29   3.36831722e+04  5.15724571e+04  1.01e-02 3.17e-04  4.37e-02    14s
  30   3.50570850e+04  4.95590648e+04  8.54e-03 2.77e-04  3.54e-02    14s
  31   3.61676516e+04  4.84615185e+04  7.31e-03 2.28e-04  3.00e-02    14s
  32   3.70371410e+04  4.76838953e+04  6.36e-03 1.94e-04  2.60e-02    14s
  33   3.75084137e+04  4.70098724e+04  5.87e-03 1.68e-04  2.32e-02    15s
  34   3.84860395e+04  4.61613445e+04  4.85e-03 1.24e-04  1.88e-02    15s
  35   3.92778074e+04  4.51509830e+04  4.01e-03 7.81e-05  1.44e-02    15s
  36   4.01328797e+04  4.45411310e+04  3.12e-03 7.01e-05  1.08e-02    15s
  37   4.05800219e+04  4.41777289e+04  2.64e-03 7.36e-05  8.79e-03    15s
  38   4.07991099e+04  4.40176507e+04  2.40e-03 6.05e-05  7.87e-03    15s
  39   4.10141447e+04  4.39847958e+04  2.20e-03 5.81e-05  7.26e-03    15s
  40   4.13672091e+04  4.38542601e+04  1.85e-03 4.68e-05  6.08e-03    16s
  41   4.16958051e+04  4.38027539e+04  1.54e-03 4.28e-05  5.15e-03    16s
  42   4.19833035e+04  4.37391423e+04  1.26e-03 5.30e-05  4.29e-03    16s
  43   4.22066829e+04  4.36513517e+04  1.04e-03 4.29e-05  3.53e-03    16s
  44   4.23242720e+04  4.35796628e+04  9.22e-04 3.44e-05  3.07e-03    16s
  45   4.23452272e+04  4.34921737e+04  9.00e-04 2.45e-05  2.80e-03    16s
  46   4.26468731e+04  4.34503084e+04  6.03e-04 1.97e-05  1.96e-03    17s
  47   4.27637193e+04  4.34001614e+04  4.90e-04 1.71e-05  1.56e-03    17s
  48   4.29605573e+04  4.33748614e+04  3.06e-04 1.35e-05  1.01e-03    17s
  49   4.29689777e+04  4.33678119e+04  2.98e-04 1.25e-05  9.75e-04    17s
  50   4.29987853e+04  4.33454619e+04  2.70e-04 9.51e-06  8.47e-04    17s
  51   4.30766113e+04  4.33369187e+04  1.96e-04 8.22e-06  6.36e-04    17s
  52   4.31290015e+04  4.33312754e+04  1.44e-04 7.37e-06  4.94e-04    18s
  53   4.32063945e+04  4.33279510e+04  7.21e-05 6.88e-06  2.97e-04    18s
  54   4.32350733e+04  4.33056461e+04  4.49e-05 3.40e-06  1.72e-04    18s
  55   4.32441084e+04  4.32893588e+04  3.61e-05 5.59e-07  1.11e-04    18s
  56   4.32525448e+04  4.32868004e+04  2.83e-05 3.03e-06  8.37e-05    18s
  57   4.32769678e+04  4.32852028e+04  6.22e-06 3.48e-06  2.01e-05    18s
  58   4.32782031e+04  4.32844331e+04  5.12e-06 7.78e-07  1.52e-05    19s
  59   4.32820951e+04  4.32843391e+04  1.79e-06 4.17e-07  5.49e-06    19s
  60   4.32831812e+04  4.32843346e+04  8.62e-07 4.09e-07  2.82e-06    19s
  61   4.32841661e+04  4.32842218e+04  4.55e-08 5.08e-08  1.36e-07    19s
  62   4.32841702e+04  4.32842217e+04  9.64e-07 4.70e-08  1.26e-07    19s
  63   4.32841844e+04  4.32842205e+04  6.92e-07 1.27e-08  8.83e-08    19s
  64   4.32841908e+04  4.32842205e+04  1.97e-06 1.89e-08  7.23e-08    20s
  65   4.32841933e+04  4.32842205e+04  7.85e-06 8.21e-08  6.60e-08    20s
  66   4.32841943e+04  4.32842205e+04  9.44e-06 8.24e-08  6.43e-08    20s
  67   4.32842012e+04  4.32842205e+04  1.14e-05 9.21e-07  4.67e-08    20s
  68   4.32842200e+04  4.32842205e+04  2.83e-07 8.50e-07  1.15e-09    20s
  69   4.32842200e+04  4.32842205e+04  5.66e-07 9.41e-07  1.15e-09    20s
  70   4.32842200e+04  4.32842205e+04  5.66e-07 8.39e-07  1.17e-09    20s
  71   4.32842222e+04  4.32842205e+04  2.51e-06 7.25e-07  1.15e-09    21s

Barrier solved model in 71 iterations and 20.55 seconds (28.14 work units)
Optimal objective 4.32842222e+04


Root crossover log...

  187719 DPushes remaining with DInf 0.0000000e+00                21s
   60485 DPushes remaining with DInf 0.0000000e+00                25s
   35919 DPushes remaining with DInf 0.0000000e+00                30s
   18810 DPushes remaining with DInf 0.0000000e+00                35s
       0 DPushes remaining with DInf 0.0000000e+00                40s

   45276 PPushes remaining with PInf 2.2210659e-04                40s
    3534 PPushes remaining with PInf 1.6614772e-04                45s
       0 PPushes remaining with PInf 0.0000000e+00                46s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4012215e+05     46s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  148151    4.3284220e+04   0.000000e+00   1.401221e+05     46s
  148400    4.3284220e+04   0.000000e+00   0.000000e+00     47s
  148400    4.3284220e+04   0.000000e+00   0.000000e+00     47s
Concurrent spin time: 15.08s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.328422e+04, 148400 iterations, 54.97 seconds (91.88 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 43284.2205    0  334 -190754.47 43284.2205   123%     -   63s
H    0     0                    -143089.3318 43284.2205   130%     -   64s
H    0     0                    -95068.63735 43284.2205   146%     -   65s
H    0     0                    -94483.73235 43284.2205   146%     -   65s
H    0     0                    -94310.15490 43284.2205   146%     -   65s
H    0     0                    -24795.75386 43284.2205   275%     -   65s
H    0     0                    -24537.97814 43284.2205   276%     -   65s
     0     0 36789.9136    0  310 -24537.978 36789.9136   250%     -  163s
H    0     0                    -10685.25084 36789.3812   444%     -  165s
H    0     0                    -9381.445588 36789.3812   492%     -  165s
H    0     0                    -5988.120344 36789.3812   714%     -  165s
H    0     0                    -5633.768831 36789.3812   753%     -  165s
H    0     0                    -5128.833495 36789.3812   817%     -  165s
H    0     0                    -5068.670572 36789.3812   826%     -  165s
     0     0 35819.2768    0  331 -5068.6706 35819.2768   807%     -  216s
     0     0 35765.1433    0  378 -5068.6706 35765.1433   806%     -  230s
     0     0 35761.3628    0  341 -5068.6706 35761.3628   806%     -  237s
     0     0 35705.7393    0  358 -5068.6706 35705.7393   804%     -  250s
     0     0 35685.4893    0  367 -5068.6706 35685.4893   804%     -  259s
     0     0 35663.5295    0  366 -5068.6706 35663.5295   804%     -  264s
     0     0 35594.1875    0  362 -5068.6706 35594.1875   802%     -  273s
     0     0 35592.4154    0  367 -5068.6706 35592.4154   802%     -  278s
     0     0 35549.3257    0  371 -5068.6706 35549.3257   801%     -  286s
     0     0 35548.7582    0  370 -5068.6706 35548.7582   801%     -  289s
     0     0 32764.6710    0  404 -5068.6706 32764.6710   746%     -  375s
H    0     0                    7654.1145486 32764.3550   328%     -  377s
H    0     0                    8142.8373189 32764.3550   302%     -  377s
H    0     0                    8186.9114168 32764.3550   300%     -  377s
H    0     0                    8359.7308174 32764.3550   292%     -  377s
     0     0 32007.3860    0  436 8359.73082 32007.3860   283%     -  424s
     0     0 31707.3221    0  422 8359.73082 31707.3221   279%     -  461s
     0     0 31656.1866    0  432 8359.73082 31656.1866   279%     -  476s
     0     0 31513.4100    0  440 8359.73082 31513.4100   277%     -  510s
     0     0 31495.2665    0  415 8359.73082 31495.2665   277%     -  526s
     0     0 31473.6873    0  451 8359.73082 31473.6873   276%     -  544s
     0     0 31436.6292    0  450 8359.73082 31436.6292   276%     -  560s
     0     0 31411.4293    0  450 8359.73082 31411.4293   276%     -  572s
     0     0 31388.6042    0  455 8359.73082 31388.6042   275%     -  583s
     0     0 31369.7783    0  419 8359.73082 31369.7783   275%     -  602s
     0     0 31307.2047    0  460 8359.73082 31307.2047   275%     -  628s
     0     0 31256.9610    0  461 8359.73082 31256.9610   274%     -  650s
     0     0 31236.8108    0  454 8359.73082 31236.8108   274%     -  664s
     0     0 31234.6234    0  454 8359.73082 31234.6234   274%     -  669s
     0     0 31234.3521    0  454 8359.73082 31234.3521   274%     -  672s
     0     0 29562.3361    0  424 8359.73082 29562.3361   254%     -  809s
H    0     0                    9992.2874392 29561.9061   196%     -  810s
H    0     0                    10394.279443 29561.9061   184%     -  810s
H    0     0                    10562.052672 29561.9061   180%     -  811s
H    0     0                    10649.564087 29561.9061   178%     -  811s
H    0     0                    10649.737781 29561.9061   178%     -  811s
     0     0 29010.8059    0  433 10649.7378 29010.8059   172%     -  863s
     0     0 28883.5044    0  440 10649.7378 28883.5044   171%     -  884s
     0     0 28805.4908    0  444 10649.7378 28805.4908   170%     -  905s
     0     0 28764.6605    0  466 10649.7378 28764.6605   170%     -  926s
     0     0 28735.0495    0  472 10649.7378 28735.0495   170%     -  943s
     0     0 28717.8913    0  476 10649.7378 28717.8913   170%     -  953s
     0     0 28706.7946    0  460 10649.7378 28706.7946   170%     -  964s
     0     0 28705.5132    0  466 10649.7378 28705.5132   170%     -  970s
     0     0 27721.4131    0  455 10649.7378 27721.4131   160%     - 1053s
H    0     0                    10730.242359 27721.3358   158%     - 1054s
     0     0 27527.4022    0  460 10730.2424 27527.4022   157%     - 1106s
     0     0 27443.5734    0  468 10730.2424 27443.5734   156%     - 1129s
     0     0 27388.3150    0  466 10730.2424 27388.3150   155%     - 1146s
     0     0 27370.9452    0  478 10730.2424 27370.9452   155%     - 1158s
     0     0 27365.4472    0  480 10730.2424 27365.4472   155%     - 1164s
     0     0 27360.5509    0  481 10730.2424 27360.5509   155%     - 1170s
     0     0 27357.0126    0  481 10730.2424 27357.0126   155%     - 1176s
     0     0 27351.3690    0  493 10730.2424 27351.3690   155%     - 1185s
     0     0 27348.8361    0  513 10730.2424 27348.8361   155%     - 1190s
     0     0 27323.0120    0  487 10730.2424 27323.0120   155%     - 1198s
     0     0 27316.3381    0  494 10730.2424 27316.3381   155%     - 1203s
     0     0 27308.0324    0  486 10730.2424 27308.0324   154%     - 1209s
     0     0 27302.9472    0  489 10730.2424 27302.9472   154%     - 1214s
     0     0 27298.8618    0  494 10730.2424 27298.8618   154%     - 1219s
     0     0 27293.1975    0  488 10730.2424 27293.1975   154%     - 1225s
     0     0 27289.8074    0  497 10730.2424 27289.8074   154%     - 1232s
     0     0 27281.6800    0  488 10730.2424 27281.6800   154%     - 1240s
     0     0 27273.7365    0  491 10730.2424 27273.7365   154%     - 1248s
     0     0 27269.5072    0  483 10730.2424 27269.5072   154%     - 1257s
     0     0 27266.9094    0  489 10730.2424 27266.9094   154%     - 1262s
     0     0 27265.1289    0  526 10730.2424 27265.1289   154%     - 1268s
     0     0 27106.6990    0  476 10730.2424 27106.6990   153%     - 1302s
H    0     0                    10738.206240 27106.5810   152%     - 1303s
H    0     0                    10876.931591 27106.5810   149%     - 1303s
     0     0 27022.2353    0  522 10876.9316 27022.2353   148%     - 1329s
     0     0 26997.3481    0  463 10876.9316 26997.3481   148%     - 1353s
     0     0 26985.5027    0  471 10876.9316 26985.5027   148%     - 1363s
     0     0 26975.9041    0  503 10876.9316 26975.9041   148%     - 1374s
     0     0 26971.7779    0  463 10876.9316 26971.7779   148%     - 1381s
     0     0 26969.6655    0  468 10876.9316 26969.6655   148%     - 1388s
     0     0 26943.4715    0  483 10876.9316 26943.4715   148%     - 1409s
H    0     0                    11093.360746 26942.5161   143%     - 1421s
H    0     0                    11214.698508 26942.5161   140%     - 1438s
H    0     0                    11521.332564 26942.5161   134%     - 1438s
H    0     0                    11723.864812 26942.5161   130%     - 1441s
     0     0 26933.1782    0  511 11723.8648 26933.1782   130%     - 1456s
     0     0 26921.3996    0  521 11723.8648 26921.3996   130%     - 1470s
     0     0 26916.1934    0  515 11723.8648 26916.1934   130%     - 1475s
     0     0 26913.4546    0  522 11723.8648 26913.4546   130%     - 1479s
     0     0 26910.6997    0  523 11723.8648 26910.6997   130%     - 1483s
     0     0 26909.8933    0  518 11723.8648 26909.8933   130%     - 1486s
     0     0 26893.6385    0  451 11723.8648 26893.6385   129%     - 1501s
H    0     0                    12074.801587 26893.6200   123%     - 1503s
     0     0 26886.3164    0  510 12074.8016 26886.3164   123%     - 1516s
     0     0 26883.4448    0  455 12074.8016 26883.4448   123%     - 1523s
     0     0 26881.8347    0  483 12074.8016 26881.8347   123%     - 1527s
     0     0 26874.4818    0  509 12074.8016 26874.4818   123%     - 1539s
     0     0 26873.2493    0  521 12074.8016 26873.2493   123%     - 1549s
     0     0 26866.9513    0  462 12074.8016 26866.9513   123%     - 1559s
     0     0 26864.8651    0  493 12074.8016 26864.8651   122%     - 1566s
     0     0 26855.1226    0  474 12074.8016 26855.1226   122%     - 1581s
     0     0 26854.9684    0  474 12074.8016 26854.9684   122%     - 1593s
H    0     0                    12076.666475 26854.6882   122%     - 1693s
H    0     0                    12111.373849 26854.6882   122%     - 1693s
H    0     0                    12189.081646 26854.6882   120%     - 1837s
H    0     0                    12313.685990 26854.6882   118%     - 1847s
H    0     0                    12456.638980 26854.6882   116%     - 1854s
     0     2 26854.6882    0  474 12456.6390 26854.6882   116%     - 2022s
     1     4 26632.4444    1  510 12456.6390 26854.6882   116% 28956 2077s
     3     7 26567.8601    2  502 12456.6390 26631.6422   114% 23894 2169s
     6    14 26330.1111    3  471 12456.6390 26567.3022   113% 23040 2232s
    13    28 25895.0960    4  479 12456.6390 26330.0311   111% 25575 2303s
    27    42 24937.6249    5  379 12456.6390 25898.4811   108% 37920 2517s
    41    74 24437.3027    6  404 12456.6390 25898.4811   108% 34325 3289s
    73   187 24318.4593    7  444 12456.6390 25734.7063   107% 34736 3437s
   186   217 24132.7417   10  411 12456.6390 25734.2521   107% 18951 3493s
H  195   217                    12467.520734 25734.2521   106% 18525 3493s
H  213   217                    12528.211196 25734.2521   105% 17936 3493s
   216   295 23975.5579   11  291 12528.2112 25734.2521   105% 17860 3571s
   294   347 23736.5256   14  405 12528.2112 25734.2521   105% 15520 3600s

Cutting planes:
  Learned: 3
  Gomory: 12
  Implied bound: 240
  MIR: 5270
  Flow cover: 4518
  Zero half: 1
  RLT: 108
  Relax-and-lift: 762

Explored 346 nodes (6183936 simplex iterations) in 3600.21 seconds (8596.93 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12528.2 12467.5 12456.6 ... 11521.3

Time limit reached
Best objective 1.252821119639e+04, best bound 2.573425214396e+04, gap 105.4104%
  WARNING: Time limit reached. Using best solution found (gap: 105.41%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.23s
  Master Objective (UB) = 12528.21, θ = 157998.51
  Upper Bound (UB) = 12528.21

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 157998.51
  [DEBUG]   ✓ Scenario 0: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 157998.51 ≤ Q = 157998.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 157998.51 ≤ Q = 157998.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 157998.51 ≤ Q = 157998.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 157998.51 ≤ Q = 157998.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 157998.51 ≤ Q = 157998.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 157998.51 ≤ Q = 157998.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 20: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 21: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 22: θ = 157998.51 ≤ Q = 157998.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 23: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 24: θ = 157998.51 ≤ Q = 157998.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 25: θ = 157998.51 ≤ Q = 157998.51 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 26] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6a1b1003
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6a1b1003
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.240586e+13
Presolve removed 2593 rows and 1882 columns
Presolve time: 0.00s
Presolved: 500 rows, 507 columns, 1413 nonzeros
Found heuristic solution: objective 6068846.0589
Variable types: 342 continuous, 165 integer (165 binary)
Found heuristic solution: objective 6068635.3689

Root relaxation: objective -1.460156e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146015.56    0  130 6068635.37 -146015.56   102%     -    0s
H    0     0                    -108320.7867 -146015.56  34.8%     -    0s
H    0     0                    -108531.4767 -146015.56  34.5%     -    0s
H    0     0                    -108546.7612 -145776.44  34.3%     -    0s
H    0     0                    -108757.4512 -145776.44  34.0%     -    0s
H    0     0                    -109897.3437 -124198.54  13.0%     -    0s
H    0     0                    -118529.2241 -124198.54  4.78%     -    0s
     0     0 -124198.54    0   30 -118529.22 -124198.54  4.78%     -    0s
H    0     0                    -123278.8092 -124135.03  0.69%     -    0s
     0     0 -123996.52    0   25 -123278.81 -123996.52  0.58%     -    0s
     0     0 -123995.16    0   26 -123278.81 -123995.16  0.58%     -    0s
     0     0 -123825.54    0   14 -123278.81 -123825.54  0.44%     -    0s
H    0     0                    -123357.5015 -123825.54  0.38%     -    0s
H    0     0                    -123685.0908 -123825.54  0.11%     -    0s
     0     0 -123802.31    0    8 -123685.09 -123802.31  0.09%     -    0s
     0     0 -123801.16    0    7 -123685.09 -123801.16  0.09%     -    0s
H    0     0                    -123710.4881 -123795.56  0.07%     -    0s
     0     0 -123795.56    0    6 -123710.49 -123795.56  0.07%     -    0s
H    0     0                    -123712.3980 -123795.56  0.07%     -    0s
     0     0 -123776.03    0    7 -123712.40 -123776.03  0.05%     -    0s
     0     0 -123776.03    0   20 -123712.40 -123776.03  0.05%     -    0s
*    0     0               0    -123737.0423 -123737.04  0.00%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 14
  Flow cover: 8

Explored 1 nodes (536 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123737 -123712 -123710 ... -108547
No other solutions better than -123737

Optimal solution found (tolerance 1.00e-06)
Best objective -1.237370423401e+05, best bound -1.237370423401e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 147816.48
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123737.04
  [DEBUG]   S×d_nominal = 271553.52
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 271553.52 + -123737.04 = 147816.48
  [DEBUG]   Current θ from Master = 157998.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10182.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2346.18
  Lower Bound (LB) = 12589.76
  Gap (UB-LB) = -61.5505, Absolute Gap = 61.5505, Relative Gap = -0.004913
  *** CONVERGED (small negative gap: -61.55 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 26
Total Time: 74739.23s
Converged: True
Final Lower Bound: 12589.7617
Final Upper Bound: 12528.2112
Final Gap: -61.550517
Number of Critical Scenarios: 26
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 2, 5, 7] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 1 customers  Mode 2: 49 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 26
Start Time: 2026-01-03 10:52:06
End Time: 2026-01-04 07:37:46
Total Time: 74739.23s
Optimal Value: 12589.76
Lower Bound: 12589.76
Upper Bound: 12528.21
Gap: -61.550517
Plants Opened: {0: [0], 1: [1], 2: [1]} (3 plants)
DCs Opened: [0, 2, 5, 7] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed21_MD_gamma20_20260104_073746.csv

Total Execution Time: 74739.76 seconds
End Time: 2026-01-04 07:37:46

All tasks completed successfully!

