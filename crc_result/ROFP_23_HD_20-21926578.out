
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 23
DI Scenario: HD
Start Time: 2026-01-03 11:12:25
================================================================================
Loading data from data/DH_data_full_seed23.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
  Product 1: ['1.000', '1.427', '2.036'] (k=0.877)
  Product 2: ['1.000', '1.404', '1.970'] (k=0.836)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=957, max=1788
  DC capacity (MC): min=424, max=888

Demand Structure (s_rk matrix):
  Total customer-product pairs: 82/150 (45.3% sparse)
  Average products per customer: 1.64

Demand (only non-zero entries):
  Nominal (μ): min=8.22, max=34.68, count=82
  Deviation (μ̂): min=4.01, max=9.75

Costs:
  Plant fixed cost: min=5308, max=9514
  DC fixed cost: min=3659, max=5984
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
    Product 1: ['1.000', '1.427', '2.036'] (k=0.877)
    Product 2: ['1.000', '1.404', '1.970'] (k=0.836)
  MD:
    Product 0: ['1.000', '1.153', '1.329'] (k=0.351)
    Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
    Product 2: ['1.000', '1.264', '1.598'] (k=0.578)
  LD:
    Product 0: ['1.000', '1.094', '1.197'] (k=0.222)
    Product 1: ['1.000', '1.121', '1.257'] (k=0.282)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
  Mixed:
    Product 0: ['1.000', '1.483', '2.198'] (k=0.971)
    Product 1: ['1.000', '1.151', '1.325'] (k=0.347)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.049)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48756 nonzeros
Model fingerprint: 0x4cb6adcf
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11789 rows and 2789 columns
Presolve time: 0.07s
Presolved: 4884 rows, 5711 columns, 33922 nonzeros
Variable types: 3452 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -305639.8511
Found heuristic solution: objective -188519.7825

Root relaxation: objective 1.729990e+05, 5439 iterations, 0.26 seconds (0.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 172998.955    0  514 -188519.78 172998.955   192%     -    0s
H    0     0                    -182149.8726 172998.955   195%     -    0s
     0     0 150009.660    0  762 -182149.87 150009.660   182%     -    1s
     0     0 149646.044    0  782 -182149.87 149646.044   182%     -    1s
     0     0 149605.809    0  793 -182149.87 149605.809   182%     -    1s
     0     0 149604.947    0  793 -182149.87 149604.947   182%     -    1s
     0     0 124593.083    0  448 -182149.87 124593.083   168%     -    2s
     0     0 123782.220    0  452 -182149.87 123782.220   168%     -    2s
     0     0 123660.778    0  443 -182149.87 123660.778   168%     -    2s
     0     0 123608.819    0  446 -182149.87 123608.819   168%     -    2s
     0     0 123596.648    0  457 -182149.87 123596.648   168%     -    2s
H    0     0                    -159393.6744 111271.655   170%     -    3s
H    0     0                    49352.756989 111271.655   125%     -    3s
     0     0 111271.655    0  434 49352.7570 111271.655   125%     -    3s
     0     0 110155.351    0  463 49352.7570 110155.351   123%     -    3s
     0     0 109910.729    0  510 49352.7570 109910.729   123%     -    3s
     0     0 109851.476    0  512 49352.7570 109851.476   123%     -    3s
     0     0 109814.935    0  517 49352.7570 109814.935   123%     -    3s
     0     0 109811.872    0  514 49352.7570 109811.872   123%     -    3s
H    0     0                    49535.461679 109811.872   122%     -    4s
H    0     0                    49633.909706 109811.872   121%     -    4s
H    0     0                    49685.594773 105516.166   112%     -    4s
H    0     0                    49835.791032 105516.166   112%     -    4s
H    0     0                    49836.118083 105516.166   112%     -    4s
H    0     0                    50032.685719 105516.166   111%     -    4s
H    0     0                    51637.426521 105516.166   104%     -    4s
H    0     0                    51803.420919 105516.166   104%     -    4s
H    0     0                    51822.223201 105516.166   104%     -    4s
H    0     0                    51991.988952 105516.166   103%     -    4s
H    0     0                    52572.006600 105516.166   101%     -    4s
H    0     0                    52676.624925 105516.166   100%     -    4s
H    0     0                    52720.402542 105516.166   100%     -    4s
     0     0 105516.166    0  585 52720.4025 105516.166   100%     -    4s
H    0     0                    53495.291532 104996.918  96.3%     -    5s
     0     0 104996.918    0  563 53495.2915 104996.918  96.3%     -    5s
     0     0 104885.235    0  623 53495.2915 104885.235  96.1%     -    5s
     0     0 104846.187    0  629 53495.2915 104846.187  96.0%     -    5s
     0     0 104830.416    0  626 53495.2915 104830.416  96.0%     -    5s
     0     0 103389.285    0  551 53495.2915 103389.285  93.3%     -    5s
     0     0 103081.119    0  573 53495.2915 103081.119  92.7%     -    5s
     0     0 103038.129    0  625 53495.2915 103038.129  92.6%     -    6s
     0     0 103018.587    0  567 53495.2915 103018.587  92.6%     -    6s
     0     0 102016.469    0  647 53495.2915 102016.469  90.7%     -    6s
     0     0 101679.344    0  683 53495.2915 101679.344  90.1%     -    6s
     0     0 101557.725    0  714 53495.2915 101557.725  89.8%     -    7s
     0     0 101535.189    0  703 53495.2915 101535.189  89.8%     -    7s
     0     0 100701.837    0  647 53495.2915 100701.837  88.2%     -    7s
     0     0 100492.952    0  636 53495.2915 100492.952  87.9%     -    7s
     0     0 100427.499    0  747 53495.2915 100427.499  87.7%     -    8s
     0     0 100401.332    0  719 53495.2915 100401.332  87.7%     -    8s
H    0     0                    53762.774682 99587.6460  85.2%     -    8s
H    0     0                    54976.544329 99587.6460  81.1%     -    8s
H    0     0                    56060.367813 99587.6460  77.6%     -    8s
H    0     0                    56373.540642 99587.6460  76.7%     -    8s
H    0     0                    57097.226430 99587.6460  74.4%     -    8s
H    0     0                    57137.067130 99587.6460  74.3%     -    8s
H    0     0                    57515.780626 99587.6460  73.1%     -    8s
     0     0 99587.6460    0  695 57515.7806 99587.6460  73.1%     -    8s
H    0     0                    57588.111695 99376.2925  72.6%     -    9s
H    0     0                    57639.822106 99376.2925  72.4%     -    9s
H    0     0                    57928.868890 99376.2925  71.5%     -    9s
     0     0 99376.2925    0  752 57928.8689 99376.2925  71.5%     -    9s
     0     0 99333.2430    0  743 57928.8689 99333.2430  71.5%     -    9s
H    0     0                    58063.731634 98796.2032  70.2%     -    9s
H    0     0                    58216.740879 98796.2032  69.7%     -    9s
     0     0 98796.2032    0  641 58216.7409 98796.2032  69.7%     -    9s
     0     0 98605.3374    0  681 58216.7409 98605.3374  69.4%     -   10s
     0     0 98521.6126    0  790 58216.7409 98521.6126  69.2%     -   10s
     0     0 98486.0938    0  813 58216.7409 98486.0938  69.2%     -   10s
     0     0 97894.5866    0  658 58216.7409 97894.5866  68.2%     -   11s
     0     0 97769.1389    0  663 58216.7409 97769.1389  67.9%     -   11s
     0     0 97742.3421    0  658 58216.7409 97742.3421  67.9%     -   12s
     0     0 97527.3217    0  543 58216.7409 97527.3217  67.5%     -   12s
     0     0 97402.0451    0  611 58216.7409 97402.0451  67.3%     -   12s
     0     0 97385.1574    0  595 58216.7409 97385.1574  67.3%     -   13s
     0     0 97098.0585    0  690 58216.7409 97098.0585  66.8%     -   13s
     0     0 97097.4329    0  690 58216.7409 97097.4329  66.8%     -   13s
     0     2 97097.4329    0  690 58216.7409 97097.4329  66.8%     -   14s
     3     8 96886.7856    2  740 58216.7409 97094.4188  66.8%   737   15s
H   44    64                    58226.659390 96539.8357  65.8%  2270   19s
    63    96 94065.5304    6  653 58226.6594 96373.6360  65.5%  2366   20s
H  357   393                    58230.846468 96373.6360  65.5%   985   24s
H  363   393                    58323.645659 96373.6360  65.2%   984   24s
   495   579 90144.1266   13  371 58323.6457 96373.6360  65.2%   853   25s
H  766   808                    60479.290672 96373.6360  59.3%   751   26s
H  821   886                    60485.048542 96373.6360  59.3%   739   27s
H  827   886                    60576.225715 96373.6360  59.1%   738   27s
H  839   886                    60817.070502 96373.6360  58.5%   730   27s
H  858   886                    60945.163266 96373.6360  58.1%   720   27s
H  978  1076                    61014.922506 96373.6360  58.0%   684   28s
  1298  1371 90253.5445   20  584 61014.9225 96209.0144  57.7%   608   30s
H 1426  1418                    61194.510540 96209.0144  57.2%   603   30s
H 1444  1418                    62653.401119 96209.0144  53.6%   605   30s
H 1568  1518                    62827.476841 96209.0144  53.1%   622   32s
H 1572  1518                    65545.704945 96209.0144  46.8%   625   32s
H 1679  1616                    65596.366522 96209.0144  46.7%   634   33s
  1938  1867 84547.6302   28  514 65596.3665 96209.0144  46.7%   641   35s
H 1973  1867                    65669.168509 96209.0144  46.5%   635   35s
H 1978  1861                    65920.029492 96209.0144  45.9%   634   35s
H 3252  3078                    66065.228504 96209.0144  45.6%   511   39s
H 3254  3041                    67785.655885 96209.0144  41.9%   511   39s
  3283  3348 79334.5844   44  386 67785.6559 96209.0144  41.9%   510   40s
H 3670  3400                    67838.283420 95804.7957  41.2%   487   41s
H 3706  3376                    68256.932556 95804.7957  40.4%   488   41s
  4428  3929 72713.1344   81  690 68256.9326 95355.3573  39.7%   476   55s
  4466  3954 78811.5002   26  340 68256.9326 91321.8980  33.8%   472   60s
  4866  4166 75565.8384   20  260 68256.9326 86789.0082  27.2%   473   65s
H 5070  4025                    69463.222033 85558.7183  23.2%   466   66s
H 5079  3871                    69464.435087 85558.7183  23.2%   466   66s
H 5100  3685                    69466.694415 85558.7183  23.2%   465   66s
H 5541  3510                    69510.878380 83651.6000  20.3%   446   68s
H 5939  3345                    69899.677214 83651.6000  19.7%   431   69s
H 5991  3174                    69919.348986 83651.6000  19.6%   429   69s
H 6157  3026                    70018.499527 82190.7964  17.4%   424   69s
  6244  3026 70375.5666   38  101 70018.4995 82190.7964  17.4%   421   70s
  8587  2710     cutoff   22      70018.4995 77544.6717  10.7%   370   75s
 13291  1158     cutoff   21      70018.4995 74417.0450  6.28%   314   80s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  Projected implied bound: 11
  MIR: 279
  Mixing: 1
  Flow cover: 456
  RLT: 49
  Relax-and-lift: 62

Explored 17847 nodes (4799904 simplex iterations) in 82.96 seconds (196.84 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 70018.5 69919.3 69899.7 ... 65920

Optimal solution found (tolerance 1.00e-06)
Best objective 7.001849952680e+04, best bound 7.001849952680e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 82.96s
  Master Objective (UB) = 70018.50, θ = 259056.36
  Upper Bound (UB) = 70018.50

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 259056.36
  [DEBUG]   ✓ Scenario 0: θ = 259056.36 ≤ Q = 259056.36 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x71d5702b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x71d5702b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.418747e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.00s
Presolved: 508 rows, 514 columns, 1439 nonzeros
Found heuristic solution: objective 6861622.0275
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.745708e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174570.78    0  123 6861622.03 -174570.78   103%     -    0s
H    0     0                    -141468.2932 -174570.78  23.4%     -    0s
H    0     0                    -141755.1558 -174570.78  23.1%     -    0s
*    0     0               0    -144002.0672 -144002.07  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (377 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 256 available processors)

Solution count 5: -144002 -141755 -141468 ... 1.41875e+13
No other solutions better than -144002

Optimal solution found (tolerance 1.00e-06)
Best objective -1.440020671700e+05, best bound -1.440020671700e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 227445.13
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144002.07
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -144002.07 = 227445.13
  [DEBUG]   Current θ from Master = 259056.36
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31611.23 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 38407.27
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 31611.2295, Absolute Gap = 31611.2295, Relative Gap = 0.451470
  Not converged yet (gap = 31611.23 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91993 nonzeros
Model fingerprint: 0xf3aacf2a
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 38407.3 (0.01s)
MIP start from previous solve produced solution with objective 38407.3 (0.01s)
Loaded MIP start from previous solve with objective 38407.3

Presolve removed 13767 rows and 5586 columns
Presolve time: 0.27s
Presolved: 18196 rows, 9154 columns, 100768 nonzeros
Variable types: 6895 continuous, 2259 integer (2259 binary)

Root relaxation: objective 9.242080e+04, 8743 iterations, 0.65 seconds (1.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 92420.8019    0  222 38407.2701 92420.8019   141%     -    1s
H    0     0                    38892.713883 92420.8019   138%     -    1s
H    0     0                    39407.684082 92420.8019   135%     -    1s
H    0     0                    39841.108479 92420.8019   132%     -    1s
     0     0 83276.1948    0  315 39841.1085 83276.1948   109%     -    1s
H    0     0                    39930.152036 83227.7683   108%     -    2s
H    0     0                    40042.730370 83227.7683   108%     -    2s
H    0     0                    40087.311230 83227.7683   108%     -    2s
H    0     0                    40247.211983 83227.7683   107%     -    2s
H    0     0                    40335.190793 83227.7683   106%     -    2s
     0     0 82973.2698    0  338 40335.1908 82973.2698   106%     -    2s
     0     0 82970.7688    0  328 40335.1908 82970.7688   106%     -    2s
     0     0 77452.1306    0  396 40335.1908 77452.1306  92.0%     -    3s
     0     0 77028.5179    0  433 40335.1908 77028.5179  91.0%     -    3s
     0     0 76855.0593    0  444 40335.1908 76855.0593  90.5%     -    3s
     0     0 76773.9252    0  443 40335.1908 76773.9252  90.3%     -    4s
     0     0 76771.6180    0  440 40335.1908 76771.6180  90.3%     -    4s
     0     0 73834.8855    0  383 40335.1908 73834.8855  83.1%     -    5s
     0     0 73202.3595    0  439 40335.1908 73202.3595  81.5%     -    6s
     0     0 72847.6860    0  515 40335.1908 72847.6860  80.6%     -    6s
     0     0 72747.9919    0  513 40335.1908 72747.9919  80.4%     -    6s
     0     0 72634.7958    0  524 40335.1908 72634.7958  80.1%     -    6s
     0     0 72605.2106    0  518 40335.1908 72605.2106  80.0%     -    6s
     0     0 72599.5600    0  518 40335.1908 72599.5600  80.0%     -    6s
     0     0 72597.7122    0  526 40335.1908 72597.7122  80.0%     -    6s
     0     0 71016.4679    0  377 40335.1908 71016.4679  76.1%     -    8s
H    0     0                    40795.381721 71016.4027  74.1%     -    8s
     0     0 70714.0830    0  375 40795.3817 70714.0830  73.3%     -    9s
     0     0 70633.7030    0  390 40795.3817 70633.7030  73.1%     -    9s
     0     0 70620.5199    0  393 40795.3817 70620.5199  73.1%     -    9s
     0     0 70606.5270    0  428 40795.3817 70606.5270  73.1%     -    9s
     0     0 70604.1646    0  427 40795.3817 70604.1646  73.1%     -    9s
H    0     0                    45289.544902 70049.9903  54.7%     -   10s
H    0     0                    45295.467799 70049.9903  54.7%     -   10s
H    0     0                    45611.084447 70049.9903  53.6%     -   10s
     0     0 70049.9903    0  407 45611.0844 70049.9903  53.6%     -   10s
H    0     0                    46539.586448 70045.7133  50.5%     -   10s
H    0     0                    46572.416743 70045.7133  50.4%     -   10s
H    0     0                    46919.632209 70045.7133  49.3%     -   10s
H    0     0                    46973.498809 70045.7133  49.1%     -   10s
H    0     0                    46977.986596 70045.7133  49.1%     -   10s
     0     0 69981.0410    0  373 46977.9866 69981.0410  49.0%     -   10s
     0     0 69950.5361    0  390 46977.9866 69950.5361  48.9%     -   10s
     0     0 69946.3916    0  387 46977.9866 69946.3916  48.9%     -   10s
H    0     0                    48084.067142 69494.4740  44.5%     -   11s
     0     0 69494.4740    0  461 48084.0671 69494.4740  44.5%     -   11s
H    0     0                    48472.645045 69494.3662  43.4%     -   11s
     0     0 69430.1505    0  412 48472.6450 69430.1505  43.2%     -   12s
     0     0 69407.9891    0  370 48472.6450 69407.9891  43.2%     -   12s
     0     0 69398.8615    0  452 48472.6450 69398.8615  43.2%     -   12s
     0     0 69369.2059    0  496 48472.6450 69369.2059  43.1%     -   12s
     0     0 69362.1848    0  486 48472.6450 69362.1848  43.1%     -   12s
     0     0 69359.6814    0  482 48472.6450 69359.6814  43.1%     -   12s
     0     0 69238.1440    0  358 48472.6450 69238.1440  42.8%     -   13s
H    0     0                    48512.137543 69238.0726  42.7%     -   13s
     0     0 69208.1599    0  537 48512.1375 69208.1599  42.7%     -   13s
     0     0 69203.7965    0  486 48512.1375 69203.7965  42.7%     -   14s
     0     0 69117.7165    0  482 48512.1375 69117.7165  42.5%     -   14s
     0     0 69090.9238    0  422 48512.1375 69090.9238  42.4%     -   14s
     0     0 69084.2039    0  393 48512.1375 69084.2039  42.4%     -   15s
     0     0 69081.3884    0  490 48512.1375 69081.3884  42.4%     -   15s
     0     0 69031.3503    0  366 48512.1375 69031.3503  42.3%     -   15s
     0     0 69020.2699    0  370 48512.1375 69020.2699  42.3%     -   15s
     0     0 69018.0045    0  370 48512.1375 69018.0045  42.3%     -   15s
     0     0 68997.1568    0  482 48512.1375 68997.1568  42.2%     -   16s
H    0     0                    48935.571349 68996.2790  41.0%     -   16s
     0     0 68990.6885    0  373 48935.5713 68990.6885  41.0%     -   16s
     0     0 68963.4441    0  408 48935.5713 68963.4441  40.9%     -   16s
     0     0 68963.4349    0  408 48935.5713 68963.4349  40.9%     -   17s
     0     2 68963.3613    0  408 48935.5713 68963.3613  40.9%     -   19s
     1     4 68854.2784    1  405 48935.5713 68963.3613  40.9%   568   20s
    31    64 66460.3829    5  392 48935.5713 66933.2925  36.8%  1527   25s
H  179   256                    48958.954160 66453.8178  35.7%  1005   28s
H  255   316                    48998.375360 66453.8178  35.6%   828   29s
H  258   316                    49055.318409 66453.8178  35.5%   835   29s
   317   376 65441.8398   11  344 49055.3184 66453.8178  35.5%   785   30s
   659   685 62098.7338   15  241 49055.3184 66351.6481  35.3%   702   35s
H  715   717                    49079.565231 66351.6481  35.2%   697   36s
H  898   849                    49093.393388 66351.6481  35.2%   639   38s
  1018   948 57096.9475   20  343 49093.3934 66351.6481  35.2%   616   40s
H 1095   998                    49142.328898 66351.6481  35.0%   608   42s
  1801  1823 54032.9233   48  224 49142.3289 66351.6481  35.0%   458   45s
  2578  2429 61635.5911    8  368 49142.3289 66152.7349  34.6%   378   51s
H 3082  2633                    49328.310895 65967.0292  33.7%   372   54s
H 3101  2633                    49336.806187 65967.0292  33.7%   372   54s
H 3113  2631                    49588.080909 65967.0292  33.0%   371   54s
H 3123  2524                    50840.003870 65967.0292  29.8%   371   54s
  3125  2593 56857.9702   18  284 50840.0039 65967.0292  29.8%   372   56s
H 3416  2721                    50886.026672 65910.5507  29.5%   379   59s
H 3438  2714                    50920.672790 65910.5507  29.4%   380   59s
  3473  2845 62948.0231   11  363 50920.6728 65910.5507  29.4%   381   60s
H 3640  2774                    51314.815288 65910.5507  28.4%   381   62s
  3641  2775 56328.4459   34  408 51314.8153 65910.5507  28.4%   381   67s
H 3642  2637                    51728.261497 65910.5507  27.4%   381   67s
H 3642  2505                    51999.092903 65910.5507  26.8%   381   67s
H 3643  2380                    52044.053542 65910.5507  26.6%   380   69s
H 3643  2260                    52053.193813 65910.5507  26.6%   380   69s
H 3643  2147                    52183.631731 65910.5507  26.3%   380   69s
  3644  2148 54012.9267   26  311 52183.6317 65910.5507  26.3%   380   70s
  3657  2157 52183.6317   91  443 52183.6317 65910.5507  26.3%   379   75s
  3666  2163 54336.4041   26  499 52183.6317 65910.5507  26.3%   378   80s
H 3666  2055                    52192.721961 65910.5507  26.3%   378   80s
H 3666  1952                    52291.219949 65910.5507  26.0%   378   80s
H 3666  1854                    52291.364249 65910.5507  26.0%   378   80s
H 3666  1761                    52383.353904 65910.5507  25.8%   378   81s
  3682  1788 65497.6678   19  339 52383.3539 65910.5507  25.8%   387   85s
  3862  1909 63577.1121   24  288 52383.3539 65286.8983  24.6%   403   90s
  4132  2009 58618.6404   27  191 52383.3539 64868.4515  23.8%   418   95s
  4517  2010 57104.2492   23  265 52383.3539 63378.2086  21.0%   428  100s
  5040  2008 53634.8723   25  268 52383.3539 63351.7631  20.9%   424  105s
  5658  1950 56612.5408   28  235 52383.3539 60983.3065  16.4%   423  110s
  6668  1734 53438.5892   29  217 52383.3539 60472.6607  15.4%   414  115s
  7203  1565 53139.1167   29  227 52383.3539 59410.5074  13.4%   418  120s
  8020  1278 52788.2449   34  251 52383.3539 58728.1190  12.1%   417  126s
  9015   923     cutoff   36      52383.3539 57563.8139  9.89%   413  131s
 10227   654 53073.1187   26  237 52383.3539 55913.8876  6.74%   406  135s
 12904   125 52394.0001   41   61 52383.3539 53485.4232  2.10%   353  140s

Cutting planes:
  MIR: 221
  Flow cover: 439
  RLT: 5
  Relax-and-lift: 39

Explored 14491 nodes (4651619 simplex iterations) in 140.32 seconds (383.34 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 52383.4 52291.4 52291.2 ... 51314.8

Optimal solution found (tolerance 1.00e-06)
Best objective 5.238335390430e+04, best bound 5.238335390430e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 140.32s
  Master Objective (UB) = 52383.35, θ = 229979.01
  Upper Bound (UB) = 52383.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229979.01
  [DEBUG]   ✓ Scenario 0: θ = 229979.01 ≤ Q = 229979.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229979.01 ≤ Q = 229979.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6a52bae8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x95ad4518
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.338420e+13
Presolve removed 2588 rows and 1879 columns
Presolve time: 0.00s
Presolved: 505 rows, 510 columns, 1433 nonzeros
Found heuristic solution: objective 6533217.3548
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.720377e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -172037.65    0  120 6533217.35 -172037.65   103%     -    0s
H    0     0                    -136454.1298 -172037.65  26.1%     -    0s
H    0     0                    -136839.8749 -172037.65  25.7%     -    0s
H    0     0                    -150606.0656 -172037.65  14.2%     -    0s
H    0     0                    -151302.0346 -159646.60  5.52%     -    0s
H    0     0                    -156364.6209 -159646.60  2.10%     -    0s
     0     0 -159646.60    0  122 -156364.62 -159646.60  2.10%     -    0s
     0     0 -159120.43    0  109 -156364.62 -159120.43  1.76%     -    0s
H    0     0                    -157246.6485 -159120.43  1.19%     -    0s
     0     0 -157928.87    0   86 -157246.65 -157928.87  0.43%     -    0s
H    0     0                    -157255.1956 -157921.48  0.42%     -    0s
     0     0 -157916.59    0   85 -157255.20 -157916.59  0.42%     -    0s
     0     0 -157916.54    0   87 -157255.20 -157916.54  0.42%     -    0s
     0     0 -157764.62    0   80 -157255.20 -157764.62  0.32%     -    0s
     0     0 -157757.23    0   79 -157255.20 -157757.23  0.32%     -    0s
     0     0 -157704.84    0   79 -157255.20 -157704.84  0.29%     -    0s
     0     0 -157703.02    0   79 -157255.20 -157703.02  0.28%     -    0s
     0     2 -157703.02    0   79 -157255.20 -157703.02  0.28%     -    0s
H  388   130                    -157255.2700 -157391.64  0.09%   5.8    0s
H 1500   194                    -157258.2945 -157304.47  0.03%   4.2    0s
H 1500   194                    -157258.7636 -157304.47  0.03%   4.2    0s
* 1573    63              45    -157263.0386 -157298.09  0.02%   4.2    0s
* 1794    63              44    -157263.1130 -157282.63  0.01%   4.2    0s

Cutting planes:
  Gomory: 50
  Implied bound: 3
  MIR: 171
  Flow cover: 15
  RLT: 41

Explored 1886 nodes (8399 simplex iterations) in 0.20 seconds (0.16 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -157263 -157263 -157259 ... -136454
No other solutions better than -157263

Optimal solution found (tolerance 1.00e-06)
Best objective -1.572631130472e+05, best bound -1.572631130472e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 209402.22
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -157263.11
  [DEBUG]   S×d_nominal = 366665.33
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 366665.33 + -157263.11 = 209402.22
  [DEBUG]   Current θ from Master = 229979.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20576.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 31806.56
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 13976.0838, Absolute Gap = 13976.0838, Relative Gap = 0.266804
  Not converged yet (gap = 13976.08 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135230 nonzeros
Model fingerprint: 0x3af20b08
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 31806.6 (0.02s)
Loaded MIP start from previous solve with objective 31806.6

Presolve removed 20624 rows and 8374 columns
Presolve time: 0.35s
Presolved: 26629 rows, 12606 columns, 163799 nonzeros
Variable types: 10347 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.07s

Solved with dual simplex

Root relaxation: objective 7.841539e+04, 16926 iterations, 2.92 seconds (6.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78415.3910    0   93 31806.5589 78415.3910   147%     -    3s
H    0     0                    34612.685489 78415.3910   127%     -    3s
H    0     0                    35350.773939 78415.3910   122%     -    3s
H    0     0                    35358.563013 78415.3910   122%     -    3s
     0     0 71765.8285    0  164 35358.5630 71765.8285   103%     -    5s
     0     0 70959.0317    0  196 35358.5630 70959.0317   101%     -    6s
     0     0 70959.0317    0  180 35358.5630 70959.0317   101%     -    6s
     0     0 70959.0317    0  198 35358.5630 70959.0317   101%     -    6s
     0     0 70959.0317    0  197 35358.5630 70959.0317   101%     -    6s
H    0     0                    35571.183832 68117.9132  91.5%     -    7s
     0     0 68096.9975    0  231 35571.1838 68096.9975  91.4%     -    7s
H    0     0                    36766.673426 68096.9975  85.2%     -    7s
H    0     0                    37361.410278 68096.9975  82.3%     -    7s
H    0     0                    38799.747353 68096.9975  75.5%     -    7s
H    0     0                    39182.572713 68096.9975  73.8%     -    7s
H    0     0                    39706.692970 68096.9975  71.5%     -    7s
H    0     0                    39860.031600 68096.9975  70.8%     -    8s
     0     0 67770.9327    0  236 39860.0316 67770.9327  70.0%     -    8s
     0     0 67627.9744    0  233 39860.0316 67627.9744  69.7%     -    9s
     0     0 67572.5825    0  242 39860.0316 67572.5825  69.5%     -    9s
     0     0 67565.9629    0  246 39860.0316 67565.9629  69.5%     -    9s
     0     0 67564.6706    0  248 39860.0316 67564.6706  69.5%     -    9s
     0     0 67564.6546    0  252 39860.0316 67564.6546  69.5%     -    9s
H    0     0                    41217.667465 66277.3258  60.8%     -   12s
     0     0 66277.3258    0  315 41217.6675 66277.3258  60.8%     -   12s
H    0     0                    41226.222174 65826.6703  59.7%     -   13s
     0     0 65826.6703    0  305 41226.2222 65826.6703  59.7%     -   13s
     0     0 65533.4003    0  314 41226.2222 65533.4003  59.0%     -   13s
     0     0 65483.6018    0  318 41226.2222 65483.6018  58.8%     -   13s
     0     0 65446.2858    0  323 41226.2222 65446.2858  58.7%     -   14s
     0     0 65423.0738    0  319 41226.2222 65423.0738  58.7%     -   14s
     0     0 65405.3252    0  324 41226.2222 65405.3252  58.6%     -   14s
     0     0 65381.8830    0  326 41226.2222 65381.8830  58.6%     -   14s
     0     0 65374.7677    0  326 41226.2222 65374.7677  58.6%     -   14s
     0     0 65373.2312    0  326 41226.2222 65373.2312  58.6%     -   15s
     0     0 65371.8140    0  324 41226.2222 65371.8140  58.6%     -   15s
     0     0 65112.9024    0  341 41226.2222 65112.9024  57.9%     -   16s
H    0     0                    41257.334264 65109.0061  57.8%     -   16s
H    0     0                    41340.948692 65109.0061  57.5%     -   16s
H    0     0                    41348.992441 65109.0061  57.5%     -   16s
H    0     0                    41367.428328 64864.9036  56.8%     -   17s
     0     0 64864.9036    0  356 41367.4283 64864.9036  56.8%     -   17s
     0     0 64829.7375    0  364 41367.4283 64829.7375  56.7%     -   17s
     0     0 64798.1543    0  371 41367.4283 64798.1543  56.6%     -   18s
     0     0 64790.5867    0  375 41367.4283 64790.5867  56.6%     -   18s
     0     0 64788.0780    0  336 41367.4283 64788.0780  56.6%     -   18s
     0     0 64776.3147    0  365 41367.4283 64776.3147  56.6%     -   18s
     0     0 64773.8223    0  366 41367.4283 64773.8223  56.6%     -   18s
     0     0 64773.6632    0  368 41367.4283 64773.6632  56.6%     -   18s
     0     0 64701.2294    0  335 41367.4283 64701.2294  56.4%     -   19s
     0     0 64687.3511    0  334 41367.4283 64687.3511  56.4%     -   19s
     0     0 64684.8075    0  335 41367.4283 64684.8075  56.4%     -   19s
     0     0 64683.6789    0  336 41367.4283 64683.6789  56.4%     -   19s
     0     0 64667.1697    0  338 41367.4283 64667.1697  56.3%     -   19s
     0     0 64664.3002    0  347 41367.4283 64664.3002  56.3%     -   20s
     0     0 64662.8461    0  348 41367.4283 64662.8461  56.3%     -   20s
     0     0 64657.0393    0  345 41367.4283 64657.0393  56.3%     -   20s
     0     0 64655.6650    0  341 41367.4283 64655.6650  56.3%     -   20s
     0     0 64647.2473    0  352 41367.4283 64647.2473  56.3%     -   21s
H    0     0                    41588.726858 64646.5659  55.4%     -   21s
H    0     0                    41618.577948 64646.5659  55.3%     -   21s
H    0     0                    41652.107075 64646.5659  55.2%     -   21s
     0     0 64643.0928    0  355 41652.1071 64643.0928  55.2%     -   21s
     0     0 64642.4116    0  352 41652.1071 64642.4116  55.2%     -   21s
     0     0 64640.1250    0  359 41652.1071 64640.1250  55.2%     -   22s
H    0     0                    41671.502815 64640.1029  55.1%     -   22s
     0     0 64638.4398    0  386 41671.5028 64638.4398  55.1%     -   22s
     0     0 64634.3778    0  380 41671.5028 64634.3778  55.1%     -   22s
     0     0 64633.2302    0  380 41671.5028 64633.2302  55.1%     -   22s
H    0     0                    41698.959175 64630.2029  55.0%     -   26s
H    0     0                    41730.494793 64630.2029  54.9%     -   26s
H    0     0                    41841.672287 64630.2029  54.5%     -   26s
H    0     0                    41847.694213 64630.2029  54.4%     -   26s
H    0     0                    42265.204228 64630.2029  52.9%     -   26s
     0     2 64630.2029    0  380 42265.2042 64630.2029  52.9%     -   26s
    15    32 64069.4312    4  333 42265.2042 64277.1930  52.1%  1867   31s
H   31    64                    42462.344505 64068.7374  50.9%  3517   33s
H   34    64                    42492.606910 64068.2257  50.8%  3288   33s
H   37    64                    42538.124514 64068.2257  50.6%  3097   33s
    95   212 63833.1303    7  329 42538.1245 64026.5557  50.5%  2263   37s
   277   329 63093.1981   12  380 42538.1245 64026.5557  50.5%  1471   40s
   440   471 61805.6404   14  319 42538.1245 64026.5557  50.5%  1476   45s
   551   588 60488.8077   16  379 42538.1245 64026.5557  50.5%  1517   51s
   643   671 60065.3093   17  348 42538.1245 63973.6285  50.4%  1551   56s
   813   852 59933.2748   20  372 42538.1245 63862.8811  50.1%  1462   61s
   952   979 58792.5194   23  333 42538.1245 63862.8811  50.1%  1400   65s
H 1118  1059                    42726.786044 63862.8811  49.5%  1355   69s
  1155  1090 57090.5533   24  329 42726.7860 63756.1113  49.2%  1353   71s
H 1180  1090                    42777.662833 63756.1113  49.0%  1361   71s
  1281  1239 55489.0711   27  298 42777.6628 63756.1113  49.0%  1345   75s
  1603  1555 54543.5466   30  225 42777.6628 63746.1750  49.0%  1222   80s
  1770  1624 50620.8854   34  187 42777.6628 63083.4621  47.5%  1194   85s
H 1787  1624                    42812.308951 63083.4621  47.3%  1194   85s
  2107  2008 49521.5063   46  155 42812.3090 63083.4621  47.3%  1106   92s
  2473  2360 45864.1798   65   55 42812.3090 62948.2526  47.0%  1048   97s
  2716  2563 45435.9254   78   46 42812.3090 62848.4445  46.8%  1000  100s
  3076  2743 58108.3555   11  306 42812.3090 62740.7068  46.5%   949  105s
  3496  2934 56469.5313   15  380 42812.3090 62740.7068  46.5%   898  114s
  3498  2935 51106.7839   39   93 42812.3090 62740.7068  46.5%   898  119s
  3499  2936 59419.3173   16  254 42812.3090 62740.7068  46.5%   898  122s
  3501  2937 49470.9759   37  365 42812.3090 62740.7068  46.5%   897  125s
  3510  2943 56674.1195   24  366 42812.3090 62740.7068  46.5%   895  130s
  3519  2949 50020.6252   21  334 42812.3090 62740.7068  46.5%   893  135s
  3526  2954 57154.5175   16  336 42812.3090 62740.7068  46.5%   891  144s
  3527  2955 43439.7057   51  336 42812.3090 62740.7068  46.5%   891  149s
  3528  2958 62350.1843   16  375 42812.3090 62740.7068  46.5%   906  151s
  3534  2968 61980.1588   18  339 42812.3090 62339.6830  45.6%   907  157s
  3542  2982 60793.6232   19  348 42812.3090 61977.4397  44.8%   915  160s
  3590  3030 57993.3352   21  369 42812.3090 60351.4580  41.0%   957  169s
  3622  3101 57786.4083   22  347 42812.3090 60351.4580  41.0%  1028  174s
  3704  3141 55439.7616   24  292 42812.3090 60351.4580  41.0%  1065  176s
  3808  3166 53497.6801   25  239 42812.3090 60351.4580  41.0%  1097  184s
  3843  3186 53075.5683   26  249 42812.3090 60351.4580  41.0%  1106  186s
H 3878  3052                    42852.567409 60351.4580  40.8%  1112  189s
  3913  3059 52742.1913   27  248 42852.5674 60351.4580  40.8%  1115  191s
  4044  3112 48974.2051   29  172 42852.5674 60065.8348  40.2%  1119  196s
  4220  3144     cutoff   32      42852.5674 59036.0373  37.8%  1129  201s
  4394  3169 52308.6527   25  241 42852.5674 57516.7741  34.2%  1131  205s
  4582  3177 45900.5154   30  164 42852.5674 57509.8986  34.2%  1127  210s
  4810  3219 51191.3629   26  263 42852.5674 56518.5872  31.9%  1123  216s
  4959  3218 48893.6765   30  246 42852.5674 56475.0036  31.8%  1121  221s
  5047  3240 47383.4348   32  233 42852.5674 56325.4444  31.4%  1118  225s
  5174  3234 46390.6927   34  234 42852.5674 56299.3484  31.4%  1117  232s
  5236  3250 45981.0775   35  220 42852.5674 56299.3484  31.4%  1121  235s
  5444  3267 44500.9339   37  158 42852.5674 56287.0143  31.4%  1118  241s
  5713  3282 53548.6494   25  274 42852.5674 55651.8354  29.9%  1114  247s
  5880  3304 46444.4583   30  193 42852.5674 55651.8354  29.9%  1114  251s
  6057  3295     cutoff   35      42852.5674 55305.8029  29.1%  1111  255s
  6408  3313 48966.0073   28  246 42852.5674 55296.1604  29.0%  1112  263s
  6602  3307 45309.4321   32  225 42852.5674 55296.1604  29.0%  1110  266s
H 6611  3163                    43514.924923 55296.1604  27.1%  1110  266s
H 6796  2983                    43619.346195 54407.9758  24.7%  1109  270s
H 6800  2855                    43679.059441 54407.9758  24.6%  1109  270s
H 6827  2725                    43795.653462 54313.7879  24.0%  1110  270s
  7089  2705     cutoff   29      43795.6535 54108.5408  23.5%  1105  277s
H 7093  2589                    43894.151451 54108.5408  23.3%  1105  277s
H 7095  2479                    44029.488475 54108.5408  22.9%  1105  277s
  7139  2511 46867.6344   27  297 44029.4885 54108.5408  22.9%  1106  281s
  7391  2484 47613.8301   25  193 44029.4885 54108.5408  22.9%  1103  285s
  7889  2347 47150.4420   26  210 44029.4885 53396.4294  21.3%  1104  293s
  8180  2272 44329.1391   26  294 44029.4885 52814.0441  20.0%  1104  298s
  8482  2195     cutoff   28      44029.4885 52594.1020  19.5%  1102  302s
  8754  2150     cutoff   29      44029.4885 52412.8645  19.0%  1105  308s
  9044  2091 45114.8837   27  261 44029.4885 52106.6561  18.3%  1108  313s
  9368  2035 48389.7442   23  278 44029.4885 51991.2668  18.1%  1109  318s
  9670  1968 45065.5152   27  271 44029.4885 51991.2668  18.1%  1104  324s
 10028  2005     cutoff   32      44029.4885 51704.8400  17.4%  1105  329s
 10434  2028 47299.8902   28  213 44029.4885 51474.9020  16.9%  1103  335s
 10791  2068 45810.7215   28  267 44029.4885 51285.2461  16.5%  1102  341s
 11194  2064 44522.3218   28  155 44029.4885 51068.5001  16.0%  1102  347s
 11314  2080     cutoff   28      44029.4885 51068.5001  16.0%  1103  353s
 11624  2103     cutoff   27      44029.4885 50814.8454  15.4%  1099  360s
 12081  2109     cutoff   29      44029.4885 50694.1701  15.1%  1098  366s
 12653  2108 45482.1689   28  255 44029.4885 50297.6635  14.2%  1090  373s
 13231  2103 46265.4956   29  253 44029.4885 50081.8301  13.7%  1085  379s
 13711  2110 45945.5809   29  235 44029.4885 49835.9785  13.2%  1083  386s
 14365  2114 44119.7440   31  232 44029.4885 49639.1616  12.7%  1075  392s
H14367  2098                    44122.973132 49639.1616  12.5%  1075  392s
 14441  2078     cutoff   32      44122.9731 49639.1616  12.5%  1075  400s
 14751  2016 45933.1161   27  200 44122.9731 49501.9867  12.2%  1071  408s
 15407  1946     cutoff   29      44122.9731 49326.6176  11.8%  1067  415s
 16098  1841     cutoff   32      44122.9731 48854.7307  10.7%  1063  426s
 16746  1662     cutoff   27      44122.9731 48598.2279  10.1%  1059  434s
 17584  1456     cutoff   26      44122.9731 48258.1871  9.37%  1051  443s
 18390  1137     cutoff   28      44122.9731 47869.4868  8.49%  1046  453s
 19287   582 infeasible   27      44122.9731 47274.3146  7.14%  1039  461s
 24197   413     cutoff   53      44122.9731 44683.3513  1.27%   868  465s
*24652   413              73    44152.732382 44670.9656  1.17%   852  465s
*25616   413              90    44183.546235 44590.0635  0.92%   822  465s

Cutting planes:
  Learned: 1
  MIR: 383
  Flow cover: 780
  RLT: 16
  Relax-and-lift: 79

Explored 28120 nodes (21190172 simplex iterations) in 465.61 seconds (1485.26 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 44183.5 44152.7 44123 ... 42852.6

Optimal solution found (tolerance 1.00e-06)
Best objective 4.418354623474e+04, best bound 4.418354623474e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 465.62s
  Master Objective (UB) = 44183.55, θ = 218294.23
  Upper Bound (UB) = 44183.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 218294.23
  [DEBUG]   ✓ Scenario 0: θ = 218294.23 ≤ Q = 218294.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 218294.23 ≤ Q = 218294.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 218294.23 ≤ Q = 218294.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x34ff95d8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x34ff95d8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.331388e+13
Presolve removed 2588 rows and 1879 columns
Presolve time: 0.00s
Presolved: 505 rows, 510 columns, 1430 nonzeros
Found heuristic solution: objective 6614174.4458
Variable types: 346 continuous, 164 integer (164 binary)

Root relaxation: objective -1.639209e+05, 269 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163920.89    0  131 6614174.45 -163920.89   102%     -    0s
H    0     0                    -127065.5255 -163920.89  29.0%     -    0s
H    0     0                    -129862.4898 -163920.89  26.2%     -    0s
H    0     0                    -147113.3089 -163920.89  11.4%     -    0s
     0     0 -151008.39    0   89 -147113.31 -151008.39  2.65%     -    0s
H    0     0                    -149210.8223 -150925.20  1.15%     -    0s
     0     0 -150108.99    0   93 -149210.82 -150108.99  0.60%     -    0s
     0     0 -150091.67    0   93 -149210.82 -150091.67  0.59%     -    0s
     0     0 -150046.45    0   93 -149210.82 -150046.45  0.56%     -    0s
     0     0 -149640.24    0   35 -149210.82 -149640.24  0.29%     -    0s
H    0     0                    -149550.4293 -149639.20  0.06%     -    0s
     0     0 -149635.73    0   24 -149550.43 -149635.73  0.06%     -    0s
     0     0 -149594.79    0   20 -149550.43 -149594.79  0.03%     -    0s
     0     0 -149586.27    0    7 -149550.43 -149586.27  0.02%     -    0s
     0     0 -149576.85    0    4 -149550.43 -149576.85  0.02%     -    0s
     0     0 -149576.85    0    8 -149550.43 -149576.85  0.02%     -    0s
H    0     0                    -149551.0670 -149576.85  0.02%     -    0s
     0     0 -149565.04    0    2 -149551.07 -149565.04  0.01%     -    0s
H    0     0                    -149563.3283 -149563.33  0.00%     -    0s

Cutting planes:
  Implied bound: 2
  MIR: 3
  Flow cover: 3
  Relax-and-lift: 1

Explored 1 nodes (712 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -149563 -149551 -149550 ... 6.61417e+06
No other solutions better than -149563

Optimal solution found (tolerance 1.00e-06)
Best objective -1.495633283271e+05, best bound -1.495633283271e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 199234.13
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149563.33
  [DEBUG]   S×d_nominal = 348797.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 348797.46 + -149563.33 = 199234.13
  [DEBUG]   Current θ from Master = 218294.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19060.10 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25123.44
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 5776.2762, Absolute Gap = 5776.2762, Relative Gap = 0.130734
  Not converged yet (gap = 5776.28 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178467 nonzeros
Model fingerprint: 0x2b52ce99
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective 25123.4 (0.08s)
Loaded MIP start from previous solve with objective 25123.4

Presolve removed 27492 rows and 11162 columns
Presolve time: 0.45s
Presolved: 35051 rows, 16058 columns, 216579 nonzeros
Variable types: 13799 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35051 rows, 16058 columns, 216579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56122    6.0002919e+04   0.000000e+00   1.184274e+07      5s
Concurrent spin time: 0.21s

Solved with dual simplex

Root relaxation: objective 7.821683e+04, 25197 iterations, 5.72 seconds (12.85 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78216.8282    0   92 25123.4449 78216.8282   211%     -    6s
H    0     0                    25619.854208 78216.8282   205%     -    6s
H    0     0                    38788.560130 78216.8282   102%     -    6s
H    0     0                    41244.720829 78216.8282  89.6%     -    6s
H    0     0                    41419.436955 78216.8282  88.8%     -    6s
     0     0 71958.9256    0  218 41419.4370 71958.9256  73.7%     -    9s
     0     0 71449.9330    0  207 41419.4370 71449.9330  72.5%     -   10s
     0     0 71243.7879    0  203 41419.4370 71243.7879  72.0%     -   11s
     0     0 71232.3264    0  210 41419.4370 71232.3264  72.0%     -   11s
     0     0 71232.3179    0  210 41419.4370 71232.3179  72.0%     -   11s
     0     0 68563.9890    0  234 41419.4370 68563.9890  65.5%     -   14s
     0     0 68249.7483    0  230 41419.4370 68249.7483  64.8%     -   14s
     0     0 68022.6733    0  241 41419.4370 68022.6733  64.2%     -   15s
     0     0 67980.5951    0  248 41419.4370 67980.5951  64.1%     -   16s
     0     0 67959.3923    0  245 41419.4370 67959.3923  64.1%     -   16s
     0     0 67957.8120    0  246 41419.4370 67957.8120  64.1%     -   17s
     0     0 67957.6369    0  274 41419.4370 67957.6369  64.1%     -   17s
     0     0 66214.3218    0  294 41419.4370 66214.3218  59.9%     -   21s
     0     0 65801.3125    0  303 41419.4370 65801.3125  58.9%     -   22s
     0     0 65679.3811    0  309 41419.4370 65679.3811  58.6%     -   23s
     0     0 65638.8305    0  311 41419.4370 65638.8305  58.5%     -   23s
     0     0 65629.9552    0  316 41419.4370 65629.9552  58.5%     -   24s
     0     0 65623.7354    0  319 41419.4370 65623.7354  58.4%     -   24s
     0     0 65620.1259    0  321 41419.4370 65620.1259  58.4%     -   24s
     0     0 65617.2451    0  320 41419.4370 65617.2451  58.4%     -   24s
     0     0 65615.0649    0  322 41419.4370 65615.0649  58.4%     -   24s
     0     0 65613.8356    0  322 41419.4370 65613.8356  58.4%     -   24s
     0     0 65121.2584    0  329 41419.4370 65121.2584  57.2%     -   27s
H    0     0                    41687.365384 65113.6453  56.2%     -   27s
H    0     0                    42277.229607 65113.6453  54.0%     -   27s
     0     0 65005.7133    0  332 42277.2296 65005.7133  53.8%     -   28s
     0     0 64914.2595    0  326 42277.2296 64914.2595  53.5%     -   28s
     0     0 64888.5410    0  326 42277.2296 64888.5410  53.5%     -   28s
     0     0 64877.8601    0  331 42277.2296 64877.8601  53.5%     -   29s
     0     0 64872.8213    0  335 42277.2296 64872.8213  53.4%     -   29s
     0     0 64871.5223    0  336 42277.2296 64871.5223  53.4%     -   29s
     0     0 64797.7475    0  341 42277.2296 64797.7475  53.3%     -   30s
H    0     0                    42392.216177 64797.1659  52.9%     -   30s
     0     0 64757.3434    0  385 42392.2162 64757.3434  52.8%     -   31s
     0     0 64738.9224    0  332 42392.2162 64738.9224  52.7%     -   31s
     0     0 64726.9110    0  358 42392.2162 64726.9110  52.7%     -   31s
     0     0 64721.5289    0  374 42392.2162 64721.5289  52.7%     -   31s
     0     0 64718.7166    0  371 42392.2162 64718.7166  52.7%     -   31s
     0     0 64717.3326    0  405 42392.2162 64717.3326  52.7%     -   32s
     0     0 64631.2535    0  382 42392.2162 64631.2535  52.5%     -   32s
     0     0 64622.3801    0  361 42392.2162 64622.3801  52.4%     -   33s
     0     0 64621.4167    0  365 42392.2162 64621.4167  52.4%     -   33s
     0     0 64589.1550    0  391 42392.2162 64589.1550  52.4%     -   34s
     0     0 64578.4143    0  377 42392.2162 64578.4143  52.3%     -   34s
     0     0 64576.0003    0  379 42392.2162 64576.0003  52.3%     -   34s
     0     0 64572.1312    0  385 42392.2162 64572.1312  52.3%     -   34s
     0     0 64570.8001    0  377 42392.2162 64570.8001  52.3%     -   34s
     0     0 64556.5893    0  383 42392.2162 64556.5893  52.3%     -   35s
     0     0 64552.5889    0  391 42392.2162 64552.5889  52.3%     -   36s
     0     0 64552.2303    0  391 42392.2162 64552.2303  52.3%     -   36s
     0     0 64549.3173    0  395 42392.2162 64549.3173  52.3%     -   36s
     0     0 64545.6176    0  390 42392.2162 64545.6176  52.3%     -   36s
     0     0 64545.6176    0  390 42392.2162 64545.6176  52.3%     -   37s
     0     0 64545.5487    0  395 42392.2162 64545.5487  52.3%     -   37s
     0     0 64537.0132    0  390 42392.2162 64537.0132  52.2%     -   38s
     0     0 64536.0889    0  390 42392.2162 64536.0889  52.2%     -   38s
     0     2 64535.5940    0  390 42392.2162 64535.5940  52.2%     -   44s
     1     4 64504.6432    1  370 42392.2162 64535.5940  52.2%   557   45s
    15    32 64149.2737    4  373 42392.2162 64265.1415  51.6%  2632   51s
    31    64 64000.5258    5  367 42392.2162 64205.3845  51.5%  3730   55s
    63    89 63524.5218    6  332 42392.2162 64000.4870  51.0%  3610   61s
    88   121 62952.5014    7  328 42392.2162 64000.4870  51.0%  4419   70s
H  136   215                    42408.832739 64000.4870  50.9%  3508   74s
H  142   215                    42433.129486 64000.4870  50.8%  3426   74s
H  153   215                    42459.260788 64000.4870  50.7%  3247   74s
   214   317 61675.9366    8  302 42459.2608 64000.4870  50.7%  2647   79s
   316   398 61849.3836    9  344 42459.2608 64000.4870  50.7%  2258   82s
   397   491 62643.6951    9  351 42459.2608 64000.4870  50.7%  2122   85s
   567   642 61238.4044   10  337 42459.2608 64000.4870  50.7%  1855   92s
   732   827 61827.3944   12  292 42459.2608 64000.4870  50.7%  1672   98s
   828   859 61149.3917   12  274 42459.2608 64000.4870  50.7%  1585  102s
   860   898 61645.1315   13  298 42459.2608 64000.4870  50.7%  1573  105s
   966   996 61458.5866   15  299 42459.2608 64000.4870  50.7%  1490  112s
  1003  1030 60718.7928   15  356 42459.2608 64000.4870  50.7%  1480  115s
  1074  1108 60708.8835   17  306 42459.2608 64000.4870  50.7%  1461  121s
  1187  1228 61109.5232   17  328 42459.2608 64000.4870  50.7%  1398  125s
  1339  1396 60396.6638   18  302 42459.2608 63948.3435  50.6%  1345  131s
  1549  1597 60824.6713   18  315 42459.2608 63948.3435  50.6%  1267  137s
  1680  1692 57629.5871   18  292 42459.2608 63943.0129  50.6%  1221  141s
H 1803  1727                    42507.326182 63629.6608  49.7%  1203  144s
H 1809  1727                    42651.664912 63629.6608  49.2%  1207  144s
  1831  1830 58855.7308   19  274 42651.6649 63629.6608  49.2%  1213  147s
  1964  1969 59139.3782   19  271 42651.6649 63539.3965  49.0%  1200  151s
  2117  2096 60058.1480   20  290 42651.6649 63539.3965  49.0%  1186  155s
  2451  2486 58811.2565   23  329 42651.6649 63444.6147  48.8%  1152  162s
  2684  2756 57589.7678   24  334 42651.6649 63444.6147  48.8%  1105  165s
H 3278  3040                    42677.476790 63444.6147  48.7%   992  173s
H 3313  3040                    42732.849335 63444.6147  48.5%   992  173s
  3358  3301 56921.3842   28  248 42732.8493 63444.6147  48.5%   993  178s
  3688  3667 56265.0694   30  247 42732.8493 63444.6147  48.5%   948  182s
  4081  3668 45774.5051   64  390 42732.8493 63207.5181  47.9%   897  195s
  4083  3669 60036.7627   10   92 42732.8493 63207.5181  47.9%   897  202s
  4084  3670 49111.0533   45  258 42732.8493 63207.5181  47.9%   896  207s
  4086  3671 57441.5233   16  343 42732.8493 63207.5181  47.9%   896  211s
  4089  3673 47427.2029   72  365 42732.8493 63207.5181  47.9%   895  215s
  4098  3679 55450.4561   34  389 42732.8493 63207.5181  47.9%   893  221s
  4102  3682 48508.6967   57  349 42732.8493 63207.5181  47.9%   892  226s
  4106  3685 49065.0239   55  375 42732.8493 63207.5181  47.9%   892  230s
  4111  3688 59006.3019   22  396 42732.8493 63207.5181  47.9%   890  235s
  4114  3690 53277.3068   24  383 42732.8493 63207.5181  47.9%   890  244s
  4115  3691 51782.6024   41  383 42732.8493 63207.5181  47.9%   890  250s
  4118  3698 63207.5181   12  377 42732.8493 63207.5181  47.9%   905  261s
  4122  3704 63207.5181   13  386 42732.8493 63207.5181  47.9%   908  268s
  4130  3718 63207.5181   14  389 42732.8493 63207.5181  47.9%   919  275s
  4146  3731 55354.3041   15  296 42732.8493 63207.5181  47.9%   937  284s
H 4165  3571                    42750.869948 63207.5181  47.9%   972  293s
H 4168  3395                    42902.425761 63207.5181  47.3%   975  293s
  4197  3540 59288.3921   17  318 42902.4258 63207.5181  47.3%   988  301s
  4352  3558 58743.5245   20  329 42902.4258 63207.5181  47.3%  1026  305s
  4480  3624 58699.8921   21  338 42902.4258 63207.5181  47.3%  1057  313s
  4534  3666 54869.8106   21  303 42902.4258 63207.5181  47.3%  1078  318s
  4605  3689 56354.9879   21  255 42902.4258 63207.5181  47.3%  1089  322s
  4675  3715 57907.5841   21  293 42902.4258 63207.5181  47.3%  1097  326s
  4757  3713 53166.4713   22  213 42902.4258 63207.5181  47.3%  1099  330s
  4792  3711 56600.2055   22  331 42902.4258 63207.5181  47.3%  1104  337s
  4858  3713 50897.1879   23  223 42902.4258 63207.5181  47.3%  1115  342s
  4927  3719 54864.2636   23  289 42902.4258 63207.5181  47.3%  1122  347s
  4999  3715 53057.5140   22  329 42902.4258 63207.5181  47.3%  1131  353s
  5040  3726 45227.1640   23  232 42902.4258 63207.5181  47.3%  1145  359s
  5094  3736 54047.3507   24  310 42902.4258 63207.5181  47.3%  1159  363s
  5127  3756 49529.7546   23  217 42902.4258 63207.5181  47.3%  1174  367s
  5160  3768 53294.6934   24  196 42902.4258 63207.5181  47.3%  1186  372s
  5199  3799 51032.8867   25  249 42902.4258 63207.5181  47.3%  1193  375s
  5252  3827 49380.8782   25  237 42902.4258 63207.5181  47.3%  1199  380s
  5317  3861 46484.5971   26  266 42902.4258 63207.5181  47.3%  1208  386s
  5391  3902 51810.7708   25  295 42902.4258 63207.5181  47.3%  1214  390s
  5473  3949 49377.9279   26  231 42902.4258 63207.5181  47.3%  1222  396s
  5603  3971 47839.2215   30  177 42902.4258 63207.5181  47.3%  1218  401s
  5725  3988 46090.1235   32  160 42902.4258 60635.2492  41.3%  1218  408s
  5858  3993 45616.2419   34  117 42902.4258 60635.2492  41.3%  1221  414s
  6003  4012 44238.2290   38  131 42902.4258 60048.8346  40.0%  1226  421s
  6118  4037 43550.1797   48  186 42902.4258 59953.5834  39.7%  1236  427s
  6243  4054 43000.7902   60  167 42902.4258 59953.5834  39.7%  1240  435s
  6363  4090 51583.1106   18  299 42902.4258 59767.8348  39.3%  1253  443s
  6510  4112 44099.7520   20  284 42902.4258 59767.8348  39.3%  1263  449s
  6638  4157     cutoff   23      42902.4258 59767.8348  39.3%  1272  456s
  6777  4211 53328.0011   21  273 42902.4258 59767.8348  39.3%  1283  463s
  6931  4246 49167.4311   24  198 42902.4258 59767.8348  39.3%  1291  470s
  7108  4245 43721.3535   31  129 42902.4258 59767.8348  39.3%  1297  477s
  7268  4260 53504.2578   19  304 42902.4258 59767.8348  39.3%  1294  485s
  7470  4266 48430.6576   22  258 42902.4258 59154.7903  37.9%  1297  492s
  7650  4233 46036.8724   28  169 42902.4258 57966.2010  35.1%  1308  497s
  7715  4276 45325.0072   29  182 42902.4258 57966.2010  35.1%  1308  506s
  7921  4328 44002.8864   32  162 42902.4258 57493.6233  34.0%  1310  514s
  8190  4335 52129.2063   23  314 42902.4258 57493.6233  34.0%  1312  523s
  8437  4367 51437.2533   26  256 42902.4258 57330.4676  33.6%  1321  531s
  8606  4470 50183.5427   28  238 42902.4258 57330.4676  33.6%  1329  540s
  8950  4464 45024.3846   31  185 42902.4258 57330.4676  33.6%  1323  550s
  9250  4484 46767.6104   20  247 42902.4258 57311.8098  33.6%  1327  560s
  9534  4507 47270.7335   24  218 42902.4258 56651.2505  32.0%  1330  570s
  9845  4533 52902.8854   18  289 42902.4258 56187.3684  31.0%  1336  580s
H 9937  4324                    43127.308091 56187.3684  30.3%  1336  580s
 10087  4405 48710.2301   23  225 43127.3081 56187.3684  30.3%  1338  591s
 10481  4423 52604.9404   22  275 43127.3081 56037.7229  29.9%  1335  603s
 10826  4504 47968.0205   31  199 43127.3081 55949.1928  29.7%  1341  616s
H11189  4304                    43525.425215 55949.1928  28.5%  1346  628s
 11592  4305     cutoff   37      43525.4252 55660.6261  27.9%  1341  642s
 11994  4255 48820.2941   22  221 43525.4252 55426.2012  27.3%  1345  655s
 12425  4217 51265.0487   25  278 43525.4252 55426.2012  27.3%  1350  670s
 12747  4287 44761.4202   28  208 43525.4252 55218.6228  26.9%  1354  683s
 13150  4299 50240.3330   19  241 43525.4252 55185.0423  26.8%  1362  698s
 13625  4457 46977.4974   27  198 43525.4252 55185.0423  26.8%  1368  715s
 14084  4485 46708.2087   24  288 43525.4252 54481.0218  25.2%  1376  727s
H14118  4390                    43802.592468 54481.0218  24.4%  1377  727s
H14134  4333                    43969.775228 54481.0218  23.9%  1378  727s
 14137  4442 46455.0400   25  261 43969.7752 54481.0218  23.9%  1379  745s
 14653  4616 45562.2047   25  231 43969.7752 54469.0295  23.9%  1383  760s
 15190  4694 44417.6864   28  249 43969.7752 54124.1086  23.1%  1386  777s
H15242  4669                    44029.488475 54124.1086  22.9%  1387  777s
 15532  4857 45210.5202   31  186 44029.4885 53919.5289  22.5%  1394  794s
 16139  4975 45851.4101   29  219 44029.4885 53907.8870  22.4%  1393  813s
 16739  5096 45674.6621   25  289 44029.4885 53413.3945  21.3%  1398  831s
 17313  5253 47652.7850   24  233 44029.4885 53402.3238  21.3%  1405  852s
 17989  5455 45296.6377   26  253 44029.4885 53161.6474  20.7%  1406  873s
 18672  5612 46450.7722   24  299 44029.4885 52992.3388  20.4%  1408  895s
 19348  5693     cutoff   23      44029.4885 52981.4036  20.3%  1412  918s
 20059  5837 45582.5461   32  230 44029.4885 52892.1539  20.1%  1416  941s
 20781  6003 46986.8162   27  160 44029.4885 52596.0691  19.5%  1422  964s
 21614  6184     cutoff   24      44029.4885 52546.9831  19.3%  1421  989s
 22496  6282 45197.7041   21  238 44029.4885 52273.5950  18.7%  1419 1013s
 23466  6347 49476.8476   19  227 44029.4885 52213.9159  18.6%  1415 1035s
 23798  6568 47943.0421   22  250 44029.4885 52213.9159  18.6%  1415 1061s
 24766  6730 44292.2958   42  105 44029.4885 51957.1079  18.0%  1412 1085s
 25663  6895     cutoff   29      44029.4885 51730.6802  17.5%  1418 1112s
 26726  7061     cutoff   29      44029.4885 51573.1369  17.1%  1417 1139s
 27742  7244 45567.2543   28  166 44029.4885 51428.8633  16.8%  1419 1167s
 28887  7289 45412.1957   30  183 44029.4885 51274.4103  16.5%  1417 1193s
 29097  7999     cutoff   34      44029.4885 51253.7389  16.4%  1418 1328s
 34078  8132     cutoff   23      44029.4885 50583.9244  14.9%  1414 1362s
 35566  8306     cutoff   29      44029.4885 50250.6437  14.1%  1409 1400s
 37061  8445 48101.4784   30  300 44029.4885 50031.7164  13.6%  1405 1436s
 38479  8549 44662.8811   29  248 44029.4885 49842.8828  13.2%  1403 1475s
 40091  8661 44382.3215   32  328 44029.4885 49667.2902  12.8%  1396 1514s
 41607  8739 45354.2948   27  218 44029.4885 49480.7347  12.4%  1395 1553s
 43280  8755 44943.0770   32  191 44029.4885 49278.5455  11.9%  1392 1593s
 45048  8777     cutoff   27      44029.4885 49082.7582  11.5%  1387 1636s
 46805  8794 44368.9386   30  193 44029.4885 48952.4064  11.2%  1384 1679s
 48631  8720 44324.9162   26  245 44029.4885 48706.6657  10.6%  1382 1721s
 50536  8635     cutoff   26      44029.4885 48443.9697  10.0%  1379 1766s
 52593  8537 44503.0974   23  322 44029.4885 48228.9505  9.54%  1374 1813s
 54810  8375 44670.8207   27  275 44029.4885 47963.3355  8.93%  1366 1860s
 57170  8085 infeasible   41      44029.4885 47726.6630  8.40%  1356 1907s
 59693  7620     cutoff   38      44029.4885 47471.3488  7.82%  1345 1961s
 62163  6999 infeasible   25      44029.4885 47186.9733  7.17%  1337 2012s
 64842  5969     cutoff   25      44029.4885 46873.2527  6.46%  1325 2062s
 67841  4425     cutoff   33      44029.4885 46437.7804  5.47%  1310 2112s
 71595  2436 44848.6618   46  125 44029.4885 45926.9098  4.31%  1281 2148s
 75603   275     cutoff   35      44029.4885 45216.3068  2.70%  1236 2167s

Cutting planes:
  MIR: 758
  Mixing: 3
  Flow cover: 1297
  RLT: 26
  Relax-and-lift: 83

Explored 79706 nodes (94348706 simplex iterations) in 2167.77 seconds (6985.41 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 44029.5 44029.5 43969.8 ... 42677.5

Optimal solution found (tolerance 1.00e-06)
Best objective 4.402948847466e+04, best bound 4.402948847466e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2167.79s
  Master Objective (UB) = 44029.49, θ = 227191.33
  Upper Bound (UB) = 44029.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227191.33
  [DEBUG]   ✓ Scenario 0: θ = 227191.33 ≤ Q = 238143.92 (slack: 10952.59)
  [DEBUG]   ✓ Scenario 1: θ = 227191.33 ≤ Q = 227191.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227191.33 ≤ Q = 227191.33 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227191.33 ≤ Q = 227944.14 (slack: 752.80)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x19995f1a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x19995f1a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.392333e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.00s
Presolved: 508 rows, 514 columns, 1433 nonzeros
Found heuristic solution: objective 6922841.4540
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.761623e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -176162.28    0  122 6922841.45 -176162.28   103%     -    0s
H    0     0                    -139909.6854 -176162.28  25.9%     -    0s
H    0     0                    -140247.3741 -176162.28  25.6%     -    0s
H    0     0                    -144548.6385 -155352.47  7.47%     -    0s
H    0     0                    -148759.0015 -155352.47  4.43%     -    0s
     0     0 -155352.47    0   57 -148759.00 -155352.47  4.43%     -    0s
H    0     0                    -152464.3037 -155302.96  1.86%     -    0s
H    0     0                    -152807.8353 -155302.96  1.63%     -    0s
H    0     0                    -153755.8279 -155093.86  0.87%     -    0s
H    0     0                    -154110.5888 -155093.86  0.64%     -    0s
     0     0 -155093.86    0   44 -154110.59 -155093.86  0.64%     -    0s
     0     0 -155091.96    0   54 -154110.59 -155091.96  0.64%     -    0s
     0     0 -154686.48    0   42 -154110.59 -154686.48  0.37%     -    0s
H    0     0                    -154248.9976 -154674.09  0.28%     -    0s
     0     0 -154631.54    0   42 -154249.00 -154631.54  0.25%     -    0s
     0     0 -154607.01    0   39 -154249.00 -154607.01  0.23%     -    0s
     0     0 -154605.92    0   37 -154249.00 -154605.92  0.23%     -    0s
     0     0 -154572.25    0   41 -154249.00 -154572.25  0.21%     -    0s
H    0     0                    -154282.1177 -154572.25  0.19%     -    0s
     0     0 -154485.45    0   16 -154282.12 -154485.45  0.13%     -    0s
     0     0 -154455.18    0   14 -154282.12 -154455.18  0.11%     -    0s
     0     0 -154443.51    0   12 -154282.12 -154443.51  0.10%     -    0s
H    0     0                    -154304.7645 -154443.51  0.09%     -    0s
     0     0 -154399.84    0   13 -154304.76 -154399.84  0.06%     -    0s
     0     0 -154399.32    0    7 -154304.76 -154399.32  0.06%     -    0s
     0     0 -154399.00    0    8 -154304.76 -154399.00  0.06%     -    0s
     0     0 -154378.40    0    6 -154304.76 -154378.40  0.05%     -    0s
     0     0 -154378.40    0   14 -154304.76 -154378.40  0.05%     -    0s
H    0     0                    -154305.5875 -154378.40  0.05%     -    0s
     0     0 -154355.30    0    4 -154305.59 -154355.30  0.03%     -    0s
H    0     0                    -154332.9990 -154351.31  0.01%     -    0s
H    0     0                    -154338.7077 -154340.49  0.00%     -    0s
     0     0 -154340.49    0    4 -154338.71 -154340.49  0.00%     -    0s
     0     0     cutoff    0      -154338.71 -154338.71  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 3
  MIR: 6
  Flow cover: 2
  Relax-and-lift: 2

Explored 1 nodes (688 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -154339 -154333 -154306 ... -152464
No other solutions better than -154339

Optimal solution found (tolerance 1.00e-06)
Best objective -1.543387076505e+05, best bound -1.543387076505e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 213613.49
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154338.71
  [DEBUG]   S×d_nominal = 367952.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367952.20 + -154338.71 = 213613.49
  [DEBUG]   Current θ from Master = 227191.33
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13577.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30451.65
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 5622.2184, Absolute Gap = 5622.2184, Relative Gap = 0.127692
  Not converged yet (gap = 5622.22 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221704 nonzeros
Model fingerprint: 0xd2156b12
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 34360 rows and 13950 columns
Presolve time: 0.56s
Presolved: 43473 rows, 19510 columns, 269359 nonzeros
Variable types: 17251 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 43473 rows, 19510 columns, 269359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34187    5.1304969e+04   0.000000e+00   9.946690e+06      5s
Concurrent spin time: 0.08s

Solved with dual simplex

Root relaxation: objective 7.821429e+04, 22614 iterations, 5.34 seconds (12.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78214.2895    0   90 -183060.80 78214.2895   143%     -    6s
H    0     0                    -176523.5981 78214.2895   144%     -    6s
H    0     0                    -53690.15807 78214.2895   246%     -    6s
H    0     0                    -53668.17036 78214.2895   246%     -    6s
H    0     0                    -1118.572809 78214.2895  7092%     -    6s
H    0     0                    13908.975260 78214.2895   462%     -    6s
H    0     0                    36986.981336 78214.2895   111%     -    6s
H    0     0                    37149.531445 78214.2895   111%     -    6s
H    0     0                    37984.148515 72021.7943  89.6%     -   10s
H    0     0                    38425.515868 72021.7943  87.4%     -   10s
     0     0 72013.1262    0  174 38425.5159 72013.1262  87.4%     -   10s
     0     0 71400.1410    0  169 38425.5159 71400.1410  85.8%     -   12s
     0     0 71210.5481    0  205 38425.5159 71210.5481  85.3%     -   13s
     0     0 71210.5481    0  200 38425.5159 71210.5481  85.3%     -   13s
     0     0 71210.5481    0  202 38425.5159 71210.5481  85.3%     -   13s
     0     0 71210.5481    0  204 38425.5159 71210.5481  85.3%     -   13s
     0     0 71210.5481    0  204 38425.5159 71210.5481  85.3%     -   13s
     0     0 68610.0812    0  254 38425.5159 68610.0812  78.6%     -   17s
H    0     0                    39327.850960 68610.0812  74.5%     -   18s
H    0     0                    39457.145898 68610.0812  73.9%     -   18s
H    0     0                    40042.368565 68610.0812  71.3%     -   18s
H    0     0                    40171.663504 68610.0812  70.8%     -   18s
     0     0 68054.2265    0  259 40171.6635 68054.2265  69.4%     -   21s
     0     0 67851.4699    0  261 40171.6635 67851.4699  68.9%     -   23s
     0     0 67838.5231    0  260 40171.6635 67838.5231  68.9%     -   23s
     0     0 67813.0131    0  257 40171.6635 67813.0131  68.8%     -   23s
     0     0 67797.4855    0  264 40171.6635 67797.4855  68.8%     -   24s
     0     0 67795.6082    0  262 40171.6635 67795.6082  68.8%     -   24s
     0     0 67795.2166    0  264 40171.6635 67795.2166  68.8%     -   24s
     0     0 66181.3031    0  307 40171.6635 66181.3031  64.7%     -   30s
     0     0 65668.6353    0  302 40171.6635 65668.6353  63.5%     -   33s
     0     0 65503.9841    0  310 40171.6635 65503.9841  63.1%     -   34s
     0     0 65456.2861    0  311 40171.6635 65456.2861  62.9%     -   34s
     0     0 65433.6645    0  317 40171.6635 65433.6645  62.9%     -   35s
     0     0 65416.7670    0  314 40171.6635 65416.7670  62.8%     -   35s
     0     0 65405.0800    0  319 40171.6635 65405.0800  62.8%     -   35s
     0     0 65381.5019    0  324 40171.6635 65381.5019  62.8%     -   36s
     0     0 65375.4268    0  322 40171.6635 65375.4268  62.7%     -   36s
     0     0 65374.1860    0  324 40171.6635 65374.1860  62.7%     -   36s
     0     0 64991.7608    0  329 40171.6635 64991.7608  61.8%     -   40s
H    0     0                    40350.272585 64903.2521  60.8%     -   41s
H    0     0                    41462.349586 64903.2521  56.5%     -   41s
     0     0 64903.2521    0  329 41462.3496 64903.2521  56.5%     -   41s
     0     0 64867.3833    0  324 41462.3496 64867.3833  56.4%     -   42s
     0     0 64841.5531    0  358 41462.3496 64841.5531  56.4%     -   42s
     0     0 64826.5995    0  354 41462.3496 64826.5995  56.4%     -   43s
     0     0 64821.9108    0  359 41462.3496 64821.9108  56.3%     -   43s
     0     0 64815.9590    0  331 41462.3496 64815.9590  56.3%     -   43s
     0     0 64813.9976    0  331 41462.3496 64813.9976  56.3%     -   43s
     0     0 64809.7689    0  354 41462.3496 64809.7689  56.3%     -   44s
     0     0 64809.2062    0  354 41462.3496 64809.2062  56.3%     -   44s
     0     0 64684.0998    0  355 41462.3496 64684.0998  56.0%     -   46s
H    0     0                    41552.415517 64683.2547  55.7%     -   46s
H    0     0                    41567.268988 64683.2547  55.6%     -   46s
H    0     0                    41607.687533 64683.2547  55.5%     -   46s
     0     0 64660.0985    0  399 41607.6875 64660.0985  55.4%     -   46s
     0     0 64648.7356    0  403 41607.6875 64648.7356  55.4%     -   47s
     0     0 64647.8945    0  405 41607.6875 64647.8945  55.4%     -   47s
     0     0 64618.1162    0  372 41607.6875 64618.1162  55.3%     -   48s
     0     0 64599.5013    0  374 41607.6875 64599.5013  55.3%     -   49s
     0     0 64596.5405    0  373 41607.6875 64596.5405  55.3%     -   50s
     0     0 64594.5292    0  376 41607.6875 64594.5292  55.2%     -   50s
     0     0 64594.0101    0  375 41607.6875 64594.0101  55.2%     -   50s
     0     0 64582.4451    0  374 41607.6875 64582.4451  55.2%     -   51s
     0     0 64575.7302    0  409 41607.6875 64575.7302  55.2%     -   51s
     0     0 64572.9840    0  341 41607.6875 64572.9840  55.2%     -   52s
     0     0 64571.2481    0  393 41607.6875 64571.2481  55.2%     -   52s
     0     0 64570.5316    0  392 41607.6875 64570.5316  55.2%     -   52s
     0     0 64553.4554    0  419 41607.6875 64553.4554  55.1%     -   53s
H    0     0                    41657.385965 64552.9642  55.0%     -   53s
H    0     0                    42165.333380 64552.9642  53.1%     -   53s
H    0     0                    42580.234814 64552.9642  51.6%     -   53s
     0     0 64545.2120    0  417 42580.2348 64545.2120  51.6%     -   54s
     0     0 64542.4824    0  423 42580.2348 64542.4824  51.6%     -   54s
     0     0 64541.8320    0  422 42580.2348 64541.8320  51.6%     -   54s
     0     0 64529.9814    0  416 42580.2348 64529.9814  51.5%     -   55s
     0     0 64526.4556    0  421 42580.2348 64526.4556  51.5%     -   55s
     0     0 64524.7091    0  421 42580.2348 64524.7091  51.5%     -   56s
     0     0 64524.4072    0  416 42580.2348 64524.4072  51.5%     -   56s
     0     0 64517.0746    0  390 42580.2348 64517.0746  51.5%     -   56s
     0     0 64513.6264    0  381 42580.2348 64513.6264  51.5%     -   57s
     0     0 64512.5504    0  386 42580.2348 64512.5504  51.5%     -   58s
     0     0 64506.9656    0  385 42580.2348 64506.9656  51.5%     -   58s
     0     0 64506.0986    0  390 42580.2348 64506.0986  51.5%     -   59s
     0     0 64503.4492    0  387 42580.2348 64503.4492  51.5%     -   59s
     0     0 64503.1657    0  387 42580.2348 64503.1657  51.5%     -   60s
H    0     0                    42582.938847 64503.1657  51.5%     -   67s
     0     2 64503.1657    0  387 42582.9388 64503.1657  51.5%     -   68s
     3     8 64323.9972    2  370 42582.9388 64428.8802  51.3%  2479   71s
     7    16 64235.9726    3  341 42582.9388 64314.2619  51.0%  2197   76s
    15    32 64090.7661    4  340 42582.9388 64233.8589  50.8%  3876   82s
    31    48 63008.1687    5  322 42582.9388 64090.6864  50.5%  6285   93s
H   47    80                    42686.801671 64090.6864  50.1%  5644  100s
H   49    80                    42805.467325 64090.6864  49.7%  5623  100s
H   50    80                    42825.540587 64090.6864  49.7%  5580  100s
    79   143 61596.5233    7  292 42825.5406 64090.6864  49.7%  5106  114s
   142   236 61482.3842    9  294 42825.5406 64090.6864  49.7%  3599  121s
H  157   236                    43224.933809 64090.6864  48.3%  3405  121s
   235   342 61278.4014    8  284 43224.9338 64090.6864  48.3%  2881  127s
   341   448 61277.0297   10  292 43224.9338 64090.6864  48.3%  2495  132s
   447   552 57790.8368    9  279 43224.9338 64090.6864  48.3%  2230  137s
   555   604 60554.8574   11  334 43224.9338 64090.6864  48.3%  2046  142s
   625   670 59982.0699   11  253 43224.9338 64090.6864  48.3%  2026  145s
   703   712 58702.6612   10  328 43224.9338 64090.6864  48.3%  1968  152s
   772   766 55724.0904   10  274 43224.9338 64090.6864  48.3%  1948  158s
   846   793 59201.9075   11  282 43224.9338 64090.6864  48.3%  1929  164s
   881   826 55495.7979   11  282 43224.9338 64090.6864  48.3%  1924  169s
   930   868 57680.8034   12  337 43224.9338 64090.6864  48.3%  1910  173s
   982   899 59738.8346   12  330 43224.9338 64090.6864  48.3%  1883  178s
  1045   925 57034.7458   12  299 43224.9338 64090.6864  48.3%  1859  182s
H 1070   925                    43305.691819 64090.6864  48.0%  1857  182s
  1085  1016 58500.7739   12  286 43305.6918 64090.6864  48.0%  1853  188s
  1219  1102 58471.9908   13  287 43305.6918 64090.6864  48.0%  1751  192s
  1337  1201 54593.1285   15  262 43305.6918 64090.6864  48.0%  1695  200s
  1463  1291 52965.7091   13  275 43305.6918 64016.1818  47.8%  1654  205s
  1602  1388 54951.9797   16  283 43305.6918 64015.8645  47.8%  1614  212s
  1731  1413 54184.7884   17  277 43305.6918 64015.8645  47.8%  1594  217s
  1768  1446 53766.5385   16  245 43305.6918 63694.6693  47.1%  1604  224s
  1809  1474 53494.4315   17  239 43305.6918 63694.6693  47.1%  1640  231s
  1896  1577 49049.3693   17  268 43305.6918 63694.6693  47.1%  1635  239s
  1980  1628 52224.0397   19  242 43305.6918 63694.6693  47.1%  1615  245s
  2098  1667 52094.3373   20  216 43305.6918 63530.4574  46.7%  1583  252s
  2191  1742 48655.0294   18  242 43305.6918 63530.4574  46.7%  1574  259s
  2346  1829 52956.8585   19  247 43305.6918 63385.0674  46.4%  1561  267s
  2497  1896 50549.3427   21  190 43305.6918 62730.0821  44.9%  1553  273s
  2616  1976 47445.1068   20  248 43305.6918 62721.7138  44.8%  1569  280s
  2730  2077 50740.3747   22  170 43305.6918 62721.7138  44.8%  1593  288s
  2873  2178 44935.1260   23  159 43305.6918 62635.6686  44.6%  1603  297s
  3019  2298 46731.0846   25  151 43305.6918 62497.9303  44.3%  1613  304s
  3204  2451 44780.3629   26  152 43305.6918 62379.2829  44.0%  1606  312s
  3414  2640 43844.5297   26  133 43305.6918 61967.6614  43.1%  1592  320s
  3662  2641 50036.6791   37  387 43305.6918 61783.2638  42.7%  1563  338s
  3664  2642 57291.9800   16   90 43305.6918 61783.2638  42.7%  1562  351s
  3665  2643 55067.5611   18  293 43305.6918 61783.2638  42.7%  1561  360s
  3666  2644 48546.2153   17  302 43305.6918 61783.2638  42.7%  1561  365s
  3668  2645 55351.4757   21  333 43305.6918 61783.2638  42.7%  1560  370s
  3671  2647 51862.0804   23  372 43305.6918 61783.2638  42.7%  1559  375s
  3676  2650 46785.3428   33  378 43305.6918 61783.2638  42.7%  1557  381s
  3679  2652 43638.7316   42  420 43305.6918 61783.2638  42.7%  1555  386s
  3682  2654 45497.4885   22  406 43305.6918 61783.2638  42.7%  1554  392s
  3684  2656 58437.9480    9  347 43305.6918 61783.2638  42.7%  1553  395s
  3687  2658 44849.5013   29  388 43305.6918 61783.2638  42.7%  1552  400s
  3692  2661 53498.2667   32  398 43305.6918 61783.2638  42.7%  1550  407s
  3694  2662 46004.5006   55  396 43305.6918 61783.2638  42.7%  1549  411s
  3695  2663 54952.0777   15  396 43305.6918 61783.2638  42.7%  1549  423s
  3696  2664 49895.1218   30  396 43305.6918 61783.2638  42.7%  1548  439s
  3697  2667 61783.2638   15  337 43305.6918 61783.2638  42.7%  1582  448s
  3699  2671 61783.2638   16  383 43305.6918 61783.2638  42.7%  1582  458s
  3703  2677 61783.2638   17  380 43305.6918 61783.2638  42.7%  1588  465s
  3711  2691 61783.2638   18  363 43305.6918 61783.2638  42.7%  1596  474s
  3727  2701 61783.2638   19  394 43305.6918 61783.2638  42.7%  1608  488s
  3743  2728 57232.9277   20  368 43305.6918 61783.2638  42.7%  1656  498s
  3775  2755 57051.9833   21  333 43305.6918 61783.2638  42.7%  1687  507s
  3813  2832 56962.8553   22  316 43305.6918 61783.2638  42.7%  1702  518s
  3904  2883 56566.8214   23  348 43305.6918 61783.2638  42.7%  1727  527s
  4020  2863 53830.8779   24  274 43305.6918 61783.2638  42.7%  1742  531s
  4055  2878 48335.0488   24  260 43305.6918 61783.2638  42.7%  1746  540s
  4095  2881 55367.2714   24  315 43305.6918 61783.2638  42.7%  1747  550s
  4145  2874 55884.4807   23  334 43305.6918 61783.2638  42.7%  1753  561s
  4190  2880 55938.8079   24  299 43305.6918 61783.2638  42.7%  1760  570s
  4239  2891 52754.9585   25  290 43305.6918 61783.2638  42.7%  1766  577s
  4285  2902 52253.0389   26  246 43305.6918 61783.2638  42.7%  1774  585s
  4342  2904 50982.6486   27  259 43305.6918 61783.2638  42.7%  1781  594s
  4404  2902 49169.3493   27  199 43305.6918 61783.2638  42.7%  1792  603s
  4467  2911 50176.9377   28  217 43305.6918 61783.2638  42.7%  1800  612s
  4526  2926 49670.3668   29  217 43305.6918 61783.2638  42.7%  1807  619s
  4599  2936 49292.9449   30  224 43305.6918 61783.2638  42.7%  1813  628s
  4678  2939 48688.2705   31  291 43305.6918 61783.2638  42.7%  1821  635s
  4737  2960 49307.5208   30  221 43305.6918 61783.2638  42.7%  1832  644s
  4818  2982 47872.7365   32  234 43305.6918 60320.6213  39.3%  1846  654s
  4913  2980 47032.0800   32  216 43305.6918 60320.6213  39.3%  1857  665s
  5002  2996 45082.9123   32  241 43305.6918 60320.6213  39.3%  1880  674s
  5101  2986     cutoff   34      43305.6918 60244.7003  39.1%  1896  684s
  5204  3003 44123.7942   34  223 43305.6918 60244.7003  39.1%  1914  695s
  5293  3035 43658.4314   38  250 43305.6918 58753.3991  35.7%  1938  705s
  5395  3054 51698.1638   22  351 43305.6918 58360.4567  34.8%  1957  717s
  5509  3055 48971.2430   24  279 43305.6918 58360.4567  34.8%  1973  728s
  5622  3042 45114.4360   27  257 43305.6918 58360.4567  34.8%  1991  739s
  5766  3039 44732.5037   27  254 43305.6918 57679.2710  33.2%  1998  751s
  5883  3065     cutoff   30      43305.6918 57633.3935  33.1%  2016  763s
  6019  3089 50889.2209   27  282 43305.6918 57501.8344  32.8%  2023  774s
  6161  3085 45243.0690   30  262 43305.6918 56984.0771  31.6%  2034  788s
  6330  3075 infeasible   35      43305.6918 56825.9403  31.2%  2037  802s
  6479  3092 51259.3855   27  245 43305.6918 56556.8113  30.6%  2056  816s
  6633  3083 infeasible   34      43305.6918 56417.3224  30.3%  2068  833s
  6801  3073 51777.2608   27  265 43305.6918 55964.9341  29.2%  2078  847s
  6967  3055 45171.5753   31  195 43305.6918 55888.3450  29.1%  2097  864s
  7154  3043 46994.2586   27  251 43305.6918 55488.6400  28.1%  2108  880s
  7336  3083 43877.9705   34  188 43305.6918 55279.3497  27.6%  2122  895s
  7557  3061 47300.9706   25  293 43305.6918 55190.7460  27.4%  2124  911s
  7785  3065 44198.4779   30  199 43305.6918 55143.6672  27.3%  2129  927s
  7979  3059 48203.8386   27  220 43305.6918 55143.6672  27.3%  2143  944s
  8170  3057 46046.2860   31  144 43305.6918 55143.6672  27.3%  2150  963s
  8403  3015 50717.1394   27  281 43305.6918 54640.3578  26.2%  2163  979s
  8533  3071     cutoff   29      43305.6918 54524.5823  25.9%  2184  996s
  8768  3061 43952.0355   31  293 43305.6918 54452.2898  25.7%  2197 1016s
  9065  3119 48100.2020   27  264 43305.6918 54190.0755  25.1%  2208 1034s
  9442  3052 45583.0948   28  232 43305.6918 54093.8347  24.9%  2198 1056s
  9746  3034     cutoff   32      43305.6918 53849.0182  24.3%  2210 1074s
 10008  3039 48743.7538   29  326 43305.6918 53751.9844  24.1%  2212 1097s
 10322  2991 infeasible   35      43305.6918 53515.3343  23.6%  2220 1119s
 10628  3013 47236.3413   28  310 43305.6918 53281.5101  23.0%  2239 1141s
 10985  2984 48679.5876   24  267 43305.6918 53133.5691  22.7%  2253 1165s
 11365  2968 44027.4577   30  195 43305.6918 53078.0892  22.6%  2265 1188s
 11807  2972 48792.7789   34  231 43305.6918 52706.6260  21.7%  2265 1212s
 12246  3067 infeasible   29      43305.6918 52504.2910  21.2%  2270 1239s
 12683  3220 45911.2847   34  190 43305.6918 52261.2874  20.7%  2275 1265s
 13168  3399 infeasible   26      43305.6918 52066.4076  20.2%  2279 1293s
 13737  3455 46306.5609   27  220 43305.6918 51882.0524  19.8%  2271 1319s
 14244  3473 44710.3917   23  213 43305.6918 51776.0035  19.6%  2278 1346s
 14718  3505     cutoff   24      43305.6918 51587.0190  19.1%  2293 1367s
 14799  3529 46316.7877   33  191 43305.6918 51587.0190  19.1%  2295 1398s
 15158  3581 infeasible   28      43305.6918 51537.6897  19.0%  2300 1432s
 15760  3667     cutoff   39      43305.6918 51336.7291  18.5%  2303 1463s
 16353  3798 infeasible   29      43305.6918 51048.1756  17.9%  2309 1497s
 17025  3885 infeasible   36      43305.6918 50823.2122  17.4%  2311 1534s
 17674  3969     cutoff   28      43305.6918 50676.1996  17.0%  2312 1574s
 18415  4024     cutoff   31      43305.6918 50501.8273  16.6%  2310 1614s
 19082  4134 43650.1388   27  217 43305.6918 50205.8223  15.9%  2319 1655s
 19837  4213 infeasible   24      43305.6918 50074.5341  15.6%  2320 1698s
 20617  4233 46986.2357   27  226 43305.6918 49893.2230  15.2%  2323 1741s
 21409  4306 infeasible   31      43305.6918 49701.4435  14.8%  2329 1785s
 22343  4383 infeasible   32      43305.6918 49344.0780  13.9%  2324 1828s
 23320  4364 infeasible   33      43305.6918 49086.5464  13.3%  2318 1876s
 24322  4374     cutoff   32      43305.6918 48930.4509  13.0%  2312 1921s
 25279  4361 45403.9962   26  263 43305.6918 48717.8075  12.5%  2313 1965s
 26330  4300 infeasible   32      43305.6918 48510.5935  12.0%  2309 2011s
 27417  4227 infeasible   30      43305.6918 48188.0199  11.3%  2307 2058s
 28548  4154 43722.8662   28  314 43305.6918 47939.5127  10.7%  2306 2113s
 29768  3964 44426.7037   29  265 43305.6918 47668.6225  10.1%  2300 2165s
 30936  3712 infeasible   34      43305.6918 47389.4299  9.43%  2300 2227s
 32181  3459 43872.9350   31  208 43305.6918 47080.5954  8.72%  2300 2285s
 33359  3077 infeasible   28      43305.6918 46945.9508  8.41%  2295 2350s
 34818  2462 43512.9005   29  230 43305.6918 46323.5857  6.97%  2288 2410s
 36451  1641 43625.1286   32  202 43305.6918 45909.5893  6.01%  2273 2469s
 38237  1019     cutoff   33      43305.6918 45294.8180  4.59%  2254 2523s
*39499  1019              49    43522.991627 45183.9101  3.82%  2224 2523s
 39668    19 infeasible   34      43522.9916 44854.8991  3.06%  2220 2547s

Cutting planes:
  Learned: 2
  MIR: 845
  Mixing: 2
  Flow cover: 1472
  Inf proof: 10
  RLT: 20
  Relax-and-lift: 134

Explored 42689 nodes (89503699 simplex iterations) in 2548.70 seconds (7759.65 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 43523 43523 43305.7 ... 42165.3

Optimal solution found (tolerance 1.00e-06)
Best objective 4.352299162703e+04, best bound 4.352299162703e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2548.72s
  Master Objective (UB) = 43522.99, θ = 226248.68
  Upper Bound (UB) = 43522.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226248.68
  [DEBUG]   ✓ Scenario 0: θ = 226248.68 ≤ Q = 226248.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226248.68 ≤ Q = 226248.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226248.68 ≤ Q = 226267.94 (slack: 19.26)
  [DEBUG]   ✓ Scenario 3: θ = 226248.68 ≤ Q = 226248.68 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226248.68 ≤ Q = 226260.09 (slack: 11.40)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d251af6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc2dae50a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.394338e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.00s
Presolved: 508 rows, 514 columns, 1433 nonzeros
Found heuristic solution: objective 6949383.1879
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.785497e+05, 272 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -178549.67    0  128 6949383.19 -178549.67   103%     -    0s
H    0     0                    -142546.0113 -178549.67  25.3%     -    0s
H    0     0                    -143783.9704 -178549.67  24.2%     -    0s
H    0     0                    -157847.4452 -161380.07  2.24%     -    0s
H    0     0                    -159567.5696 -161380.07  1.14%     -    0s
     0     0 -161380.07    0   58 -159567.57 -161380.07  1.14%     -    0s
H    0     0                    -160948.0548 -161355.65  0.25%     -    0s
     0     0 -161241.67    0   47 -160948.05 -161241.67  0.18%     -    0s
     0     0 -161204.33    0   36 -160948.05 -161204.33  0.16%     -    0s
     0     0 -161165.65    0   27 -160948.05 -161165.65  0.14%     -    0s
     0     0 -161153.38    0   25 -160948.05 -161153.38  0.13%     -    0s
     0     0 -161128.14    0   23 -160948.05 -161128.14  0.11%     -    0s
     0     0 -161125.51    0   24 -160948.05 -161125.51  0.11%     -    0s
     0     0 -160990.69    0   10 -160948.05 -160990.69  0.03%     -    0s
     0     0 -160979.22    0    8 -160948.05 -160979.22  0.02%     -    0s
H    0     0                    -160964.3217 -160979.22  0.01%     -    0s
     0     0 -160965.67    0    6 -160964.32 -160965.67  0.00%     -    0s
     0     0 -160964.85    0    2 -160964.32 -160964.85  0.00%     -    0s
*    0     0               0    -160964.8072 -160964.81  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 4
  Flow cover: 2
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (602 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -160965 -160964 -160948 ... 6.94938e+06
No other solutions better than -160965

Optimal solution found (tolerance 1.00e-06)
Best objective -1.609648071613e+05, best bound -1.609648071613e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 206987.39
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -160964.81
  [DEBUG]   S×d_nominal = 367952.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367952.20 + -160964.81 = 206987.39
  [DEBUG]   Current θ from Master = 226248.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19261.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 24261.70
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 5115.7216, Absolute Gap = 5115.7216, Relative Gap = 0.117541
  Not converged yet (gap = 5115.72 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264941 nonzeros
Model fingerprint: 0x01f01506
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 41228 rows and 16738 columns
Presolve time: 0.70s
Presolved: 51895 rows, 22962 columns, 322139 nonzeros
Variable types: 20703 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 51895 rows, 22962 columns, 322139 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35003    2.2058526e+04   0.000000e+00   3.005093e+06      5s
   49681    4.9185037e+04   0.000000e+00   2.010018e+06     10s
Concurrent spin time: 2.32s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 7.821429e+04, 48216 iterations, 14.25 seconds (31.70 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78214.2895    0   90 -183060.80 78214.2895   143%     -   15s
H    0     0                    -176523.5981 78214.2895   144%     -   15s
H    0     0                    -172975.8184 78214.2895   145%     -   15s
H    0     0                    -170462.0408 78214.2895   146%     -   15s
H    0     0                    -169699.4905 78214.2895   146%     -   15s
H    0     0                    -72819.86679 78214.2895   207%     -   15s
H    0     0                    -72797.87908 78214.2895   207%     -   15s
H    0     0                    -24015.54726 78214.2895   426%     -   15s
H    0     0                    -18874.57159 78214.2895   514%     -   15s
H    0     0                    26417.185655 78214.2895   196%     -   15s
H    0     0                    27336.208363 78214.2895   186%     -   15s
H    0     0                    29368.873435 78214.2895   166%     -   15s
H    0     0                    33216.266913 78214.2895   135%     -   15s
H    0     0                    33776.731274 78214.2895   132%     -   15s
H    0     0                    33914.699134 78214.2895   131%     -   16s
     0     0 71766.9467    0  189 33914.6991 71766.9467   112%     -   21s
H    0     0                    34704.558844 71766.7413   107%     -   22s
H    0     0                    36497.945370 71766.7413  96.6%     -   22s
H    0     0                    37676.170224 71766.7413  90.5%     -   22s
H    0     0                    38212.714298 71766.7413  87.8%     -   22s
H    0     0                    38378.318537 71766.7413  87.0%     -   22s
H    0     0                    38423.836142 71766.7413  86.8%     -   22s
     0     0 71449.0658    0  211 38423.8361 71449.0658  85.9%     -   23s
     0     0 71191.7478    0  212 38423.8361 71191.7478  85.3%     -   25s
     0     0 71174.4144    0  216 38423.8361 71174.4144  85.2%     -   25s
     0     0 71174.0724    0  206 38423.8361 71174.0724  85.2%     -   25s
     0     0 71174.0724    0  216 38423.8361 71174.0724  85.2%     -   25s
     0     0 68486.7300    0  244 38423.8361 68486.7300  78.2%     -   31s
H    0     0                    39420.654179 68486.7300  73.7%     -   31s
H    0     0                    40630.174705 68486.7300  68.6%     -   31s
     0     0 68043.0036    0  244 40630.1747 68043.0036  67.5%     -   34s
     0     0 67867.7283    0  247 40630.1747 67867.7283  67.0%     -   36s
     0     0 67838.7480    0  250 40630.1747 67838.7480  67.0%     -   36s
     0     0 67820.4899    0  251 40630.1747 67820.4899  66.9%     -   37s
     0     0 67813.3078    0  251 40630.1747 67813.3078  66.9%     -   37s
     0     0 67812.0205    0  255 40630.1747 67812.0205  66.9%     -   37s
     0     0 67811.8671    0  251 40630.1747 67811.8671  66.9%     -   37s
     0     0 66024.9439    0  331 40630.1747 66024.9439  62.5%     -   45s
H    0     0                    40808.340983 66024.9277  61.8%     -   46s
     0     0 65564.8609    0  302 40808.3410 65564.8609  60.7%     -   49s
     0     0 65427.1576    0  317 40808.3410 65427.1576  60.3%     -   51s
     0     0 65331.7437    0  349 40808.3410 65331.7437  60.1%     -   53s
     0     0 65316.0465    0  316 40808.3410 65316.0465  60.1%     -   53s
     0     0 65309.0355    0  318 40808.3410 65309.0355  60.0%     -   54s
     0     0 65292.8427    0  335 40808.3410 65292.8427  60.0%     -   54s
     0     0 65289.9774    0  336 40808.3410 65289.9774  60.0%     -   54s
     0     0 65281.6789    0  307 40808.3410 65281.6789  60.0%     -   55s
     0     0 65280.2619    0  337 40808.3410 65280.2619  60.0%     -   55s
     0     0 65278.3563    0  342 40808.3410 65278.3563  60.0%     -   55s
     0     0 65275.1571    0  318 40808.3410 65275.1571  60.0%     -   55s
     0     0 65274.5774    0  311 40808.3410 65274.5774  60.0%     -   56s
     0     0 65048.3895    0  351 40808.3410 65048.3895  59.4%     -   59s
     0     0 64848.3605    0  325 40808.3410 64848.3605  58.9%     -   61s
     0     0 64799.1253    0  358 40808.3410 64799.1253  58.8%     -   62s
     0     0 64772.4233    0  362 40808.3410 64772.4233  58.7%     -   63s
     0     0 64768.2727    0  359 40808.3410 64768.2727  58.7%     -   63s
     0     0 64754.2787    0  355 40808.3410 64754.2787  58.7%     -   64s
     0     0 64729.1867    0  359 40808.3410 64729.1867  58.6%     -   64s
     0     0 64721.2784    0  359 40808.3410 64721.2784  58.6%     -   65s
     0     0 64719.2761    0  359 40808.3410 64719.2761  58.6%     -   65s
     0     0 64718.9133    0  358 40808.3410 64718.9133  58.6%     -   65s
     0     0 64666.4204    0  334 40808.3410 64666.4204  58.5%     -   66s
     0     0 64644.5130    0  367 40808.3410 64644.5130  58.4%     -   67s
     0     0 64631.9338    0  338 40808.3410 64631.9338  58.4%     -   68s
     0     0 64629.2037    0  340 40808.3410 64629.2037  58.4%     -   68s
     0     0 64628.8763    0  376 40808.3410 64628.8763  58.4%     -   68s
     0     0 64602.9806    0  365 40808.3410 64602.9806  58.3%     -   69s
     0     0 64589.3730    0  372 40808.3410 64589.3730  58.3%     -   70s
     0     0 64587.7771    0  336 40808.3410 64587.7771  58.3%     -   71s
     0     0 64585.8057    0  378 40808.3410 64585.8057  58.3%     -   71s
     0     0 64585.3598    0  381 40808.3410 64585.3598  58.3%     -   71s
     0     0 64575.4338    0  338 40808.3410 64575.4338  58.2%     -   72s
     0     0 64572.7688    0  339 40808.3410 64572.7688  58.2%     -   73s
     0     0 64571.7248    0  344 40808.3410 64571.7248  58.2%     -   73s
     0     0 64559.7639    0  338 40808.3410 64559.7639  58.2%     -   74s
     0     0 64546.2729    0  346 40808.3410 64546.2729  58.2%     -   76s
     0     0 64545.4879    0  346 40808.3410 64545.4879  58.2%     -   76s
     0     0 64541.8773    0  347 40808.3410 64541.8773  58.2%     -   77s
H    0     0                    40959.575859 64541.8142  57.6%     -   77s
     0     0 64539.4534    0  348 40959.5759 64539.4534  57.6%     -   77s
     0     0 64538.8141    0  341 40959.5759 64538.8141  57.6%     -   77s
     0     0 64536.5558    0  345 40959.5759 64536.5558  57.6%     -   78s
     0     0 64534.6712    0  344 40959.5759 64534.6712  57.6%     -   79s
     0     0 64533.8089    0  338 40959.5759 64533.8089  57.6%     -   80s
     0     0 64532.4541    0  348 40959.5759 64532.4541  57.6%     -   80s
     0     0 64530.5479    0  344 40959.5759 64530.5479  57.5%     -   81s
     0     0 64529.9704    0  351 40959.5759 64529.9704  57.5%     -   81s
     0     0 64529.2423    0  351 40959.5759 64529.2423  57.5%     -   82s
H    0     0                    40973.547998 64529.2423  57.5%     -   93s
     0     2 64529.2423    0  351 40973.5480 64529.2423  57.5%     -   93s
     3     8 64293.7256    2  408 40973.5480 64466.0377  57.3%  3271  100s
     7    16 64112.6795    3  405 40973.5480 64293.6187  56.9%  5342  105s
    15    32 63990.0697    4  396 40973.5480 64146.0949  56.6%  5630  110s
    31    50 60042.5514    5  313 40973.5480 63987.7664  56.2%  7272  121s
    49    82 61060.7988    6  306 40973.5480 63987.7664  56.2%  9330  130s
H   68    82                    41631.917524 63987.7664  53.7%  7949  130s
    81   142 60903.9916    7  282 41631.9175 63987.7664  53.7%  7313  137s
   141   255 60831.5372    8  279 41631.9175 63987.7664  53.7%  5551  145s
H  163   255                    42388.043444 63987.7664  51.0%  5075  145s
H  249   255                    42484.560535 63987.7664  50.6%  4113  145s
   254   332 60565.3977   10  281 42484.5605 63987.7664  50.6%  4087  152s
   331   415 60332.6806   11  283 42484.5605 63987.7664  50.6%  3796  159s
H  346   415                    42774.617387 63987.7664  49.6%  3753  159s
   414   491 60385.3317   11  275 42774.6174 63987.7664  49.6%  3474  164s
   494   575 60203.8644   12  272 42774.6174 63987.7664  49.6%  3227  172s
   598   651 59891.6084   13  261 42774.6174 63987.7664  49.6%  2884  178s
   680   736 59669.8696   14  291 42774.6174 63987.7664  49.6%  2740  184s
H  739   736                    42801.465359 63987.7664  49.5%  2613  184s
H  773   736                    43094.541688 63987.7664  48.5%  2549  184s
   778   804 57173.7262   15  273 43094.5417 63987.7664  48.5%  2546  191s
   858   858 58238.8891   15  326 43094.5417 63919.7770  48.3%  2434  195s
H  901   858                    43125.391626 63919.7770  48.2%  2366  195s
   925   954 57519.6674   13  275 43125.3916 63919.7770  48.2%  2351  201s
  1034   984 59345.7002   15  292 43125.3916 63919.7770  48.2%  2209  207s
  1083  1035 58870.6435   15  288 43125.3916 63919.7770  48.2%  2176  213s
  1152  1078 56927.4009   16  304 43125.3916 63919.7770  48.2%  2158  218s
  1221  1111 57801.9808   16  291 43125.3916 63919.7770  48.2%  2133  225s
  1280  1137 56673.6402   16  280 43125.3916 63919.7770  48.2%  2142  230s
  1318  1166 56474.4829   16  252 43125.3916 63919.7770  48.2%  2152  238s
  1369  1229 57878.7785   16  253 43125.3916 63919.7770  48.2%  2181  245s
  1448  1320 57429.9767   17  260 43125.3916 63919.7770  48.2%  2167  252s
  1547  1360 56888.7893   18  322 43125.3916 63919.7770  48.2%  2127  257s
  1597  1437 55572.8097   18  236 43125.3916 63919.7770  48.2%  2116  266s
H 1629  1437                    43143.477617 63919.7770  48.2%  2118  266s
  1694  1571 56395.5012   19  256 43143.4776 63919.7770  48.2%  2068  273s
  1862  1703 56134.7170   20  259 43143.4776 63919.7770  48.2%  1983  280s
  2044  1735 54883.1485   21  239 43143.4776 63919.7770  48.2%  1903  288s
H 2051  1735                    43305.691819 63919.7770  47.6%  1902  288s
  2076  1828 55615.2603   21  261 43305.6918 63919.7770  47.6%  1913  295s
  2185  1974 55100.3146   22  240 43305.6918 63919.7770  47.6%  1860  302s
  2369  2127 55455.1067   21  211 43305.6918 63785.5183  47.3%  1785  308s
  2566  2267 54226.7592   22  241 43305.6918 63782.5684  47.3%  1720  316s
  2792  2422 53971.3919   23  232 43305.6918 63782.5684  47.3%  1661  323s
  2971  2576 54706.8311   24  182 43305.6918 63782.5684  47.3%  1632  331s
  3178  2664 52924.8502   26  151 43305.6918 63538.7767  46.7%  1605  337s
  3296  2767 53578.5914   26  196 43305.6918 63538.7767  46.7%  1582  346s
  3456  2936 47096.4362   30  159 43305.6918 62580.9917  44.5%  1574  355s
  3660  2937 50294.3424   22  351 43305.6918 62580.9917  44.5%  1553  379s
  3662  2938 54057.2964   14   90 43305.6918 62580.9917  44.5%  1553  400s
  3663  2939 53887.0102   13  274 43305.6918 62580.9917  44.5%  1552  413s
  3664  2940 44367.5630   63  297 43305.6918 62580.9917  44.5%  1552  419s
  3665  2940 48495.6081   33  346 43305.6918 62580.9917  44.5%  1551  423s
  3666  2941 53241.1115   49  322 43305.6918 62580.9917  44.5%  1551  427s
  3667  2942 55572.2658   19  327 43305.6918 62580.9917  44.5%  1550  430s
  3670  2944 53890.2526   20  370 43305.6918 62580.9917  44.5%  1549  436s
  3675  2947 48913.0568   26  400 43305.6918 62580.9917  44.5%  1547  440s
  3678  2949 56418.5331   10  344 43305.6918 62580.9917  44.5%  1546  446s
  3681  2951 56110.8664   17  342 43305.6918 62580.9917  44.5%  1545  452s
  3683  2952 45021.0063   91  333 43305.6918 62580.9917  44.5%  1544  455s
  3686  2954 45005.9307   84  340 43305.6918 62580.9917  44.5%  1542  460s
  3689  2956 56488.8605   18  337 43305.6918 62580.9917  44.5%  1541  466s
  3691  2958 46241.4574   31  351 43305.6918 62580.9917  44.5%  1540  470s
  3694  2960 53453.9130   42  450 43305.6918 62580.9917  44.5%  1539  492s
  3695  2960 53398.2564   22  450 43305.6918 62580.9917  44.5%  1539  501s
  3696  2964 62580.9917   10  369 43305.6918 62580.9917  44.5%  1581  513s
  3698  2967 62580.9917   11  386 43305.6918 62580.9917  44.5%  1584  519s
  3702  2974 62580.9917   12  347 43305.6918 62580.9917  44.5%  1587  530s
  3710  2987 62580.9917   13  388 43305.6918 62580.9917  44.5%  1597  545s
  3726  3002 61778.2726   14  361 43305.6918 62580.9917  44.5%  1657  568s
  3746  3027 59312.1149   15  365 43305.6918 62580.9917  44.5%  1699  581s
  3778  3112 56115.5384   16  340 43305.6918 62580.9917  44.5%  1767  598s
  3873  3157 54013.3864   18  327 43305.6918 62580.9917  44.5%  1914  611s
  3961  3195 46426.5573   18  263 43305.6918 62580.9917  44.5%  1966  621s
  4055  3182 53703.6156   19  328 43305.6918 62580.9917  44.5%  1992  630s
  4100  3191 51862.8201   19  284 43305.6918 62580.9917  44.5%  2003  636s
  4141  3188 52316.1990   19  313 43305.6918 62580.9917  44.5%  2011  648s
  4201  3190 52400.8146   19  256 43305.6918 62580.9917  44.5%  2023  657s
  4239  3199 52473.2556   20  327 43305.6918 62580.9917  44.5%  2043  666s
  4293  3204 48955.6956   20  315 43305.6918 62580.9917  44.5%  2056  675s
  4340  3206 51942.4564   20  339 43305.6918 62580.9917  44.5%  2069  685s
  4392  3214 50351.9624   21  338 43305.6918 62580.9917  44.5%  2081  692s
  4437  3229 48734.0417   20  308 43305.6918 61997.5870  43.2%  2099  701s
  4482  3238 47664.5356   22  279 43305.6918 61997.5870  43.2%  2111  709s
  4522  3256 43365.7983   23  251 43305.6918 61997.5870  43.2%  2120  718s
  4572  3277 44140.1542   23  296 43305.6918 61555.3115  42.1%  2135  726s
  4631  3288 47533.0991   22  342 43305.6918 61555.3115  42.1%  2147  737s
  4720  3281 43627.6575   23  336 43305.6918 61252.6680  41.4%  2152  746s
  4796  3298     cutoff   23      43305.6918 60590.3045  39.9%  2166  758s
  4886  3331 50170.9699   17  311 43305.6918 60590.3045  39.9%  2183  769s
  4993  3357 48628.4522   18  312 43305.6918 60590.3045  39.9%  2189  780s
  5117  3340 48273.9182   19  266 43305.6918 60333.7479  39.3%  2191  788s
  5155  3361 47386.9491   20  225 43305.6918 60333.7479  39.3%  2199  796s
  5197  3380 46984.1152   21  216 43305.6918 60333.7479  39.3%  2208  803s
  5246  3394 43661.6491   23  194 43305.6918 60333.7479  39.3%  2211  812s
  5300  3398     cutoff   24      43305.6918 58606.3177  35.3%  2213  823s
  5354  3422 52210.8764   19  262 43305.6918 58606.3177  35.3%  2218  834s
  5438  3446 48667.8997   20  234 43305.6918 58606.3177  35.3%  2218  847s
  5549  3471 45231.5629   21  246 43305.6918 58606.3177  35.3%  2214  861s
  5704  3475     cutoff   22      43305.6918 57743.1313  33.3%  2206  876s
  5861  3493 48925.6030   23  210 43305.6918 57641.4865  33.1%  2212  888s
  6004  3504 46546.0367   24  203 43305.6918 57612.0348  33.0%  2224  904s
  6160  3528     cutoff   27      43305.6918 57029.5308  31.7%  2237  920s
  6305  3540 51387.4330   21  303 43305.6918 57015.2321  31.7%  2256  935s
  6478  3575 49154.6661   25  261 43305.6918 57015.2321  31.7%  2272  951s
  6671  3597 46887.1777   33  175 43305.6918 56917.0494  31.4%  2279  971s
  6872  3618 50061.3559   22  205 43305.6918 56917.0494  31.4%  2288  990s
  7068  3650 46529.3556   28  182 43305.6918 56917.0494  31.4%  2300 1008s
  7285  3688 48352.2288   18  295 43305.6918 56484.7307  30.4%  2304 1027s
  7533  3683     cutoff   22      43305.6918 56406.2721  30.3%  2302 1046s
  7761  3713 43965.1211   21  195 43305.6918 55841.1097  28.9%  2310 1066s
  7987  3721 51718.2409   18  330 43305.6918 55841.1097  28.9%  2320 1088s
  8228  3720 48176.2620   21  306 43305.6918 55841.1097  28.9%  2331 1106s
  8383  3822 45972.1027   23  255 43305.6918 55527.2140  28.2%  2340 1127s
  8675  3861 49579.7033   21  366 43305.6918 55492.4381  28.1%  2341 1150s
  9061  3905 44634.9521   27  254 43305.6918 55492.4381  28.1%  2325 1172s
  9341  3883     cutoff   19      43305.6918 55016.3831  27.0%  2339 1198s
  9695  3857 46423.9595   20  284 43305.6918 54968.4346  26.9%  2340 1223s
 10046  3802 infeasible   23      43305.6918 53612.0583  23.8%  2345 1250s
 10405  3826 45501.7171   20  326 43305.6918 53385.2503  23.3%  2349 1281s
 10835  3837     cutoff   26      43305.6918 53283.5092  23.0%  2344 1312s
 11244  3809 44213.5098   31  229 43305.6918 52787.1223  21.9%  2343 1341s
 11646  3770 43432.1075   19  283 43305.6918 52787.1223  21.9%  2350 1373s
 12106  3637 46048.9616   23  256 43305.6918 52645.5255  21.6%  2345 1407s
 12635  3545 46128.7161   19  269 43305.6918 52362.4673  20.9%  2324 1438s
 12999  3665 44308.5094   21  256 43305.6918 52351.9629  20.9%  2318 1472s
 13499  3811 48592.4133   23  244 43305.6918 52325.1871  20.8%  2318 1507s
 14074  3866     cutoff   43      43305.6918 52071.0978  20.2%  2312 1540s
 14660  3974 47735.0183   22  264 43305.6918 51577.5269  19.1%  2312 1576s
 15262  4014     cutoff   27      43305.6918 51383.9295  18.7%  2309 1605s
 15544  4190 47721.5613   23  300 43305.6918 51356.9048  18.6%  2309 1640s
 16162  4319 44611.8130   22  318 43305.6918 51256.2315  18.4%  2303 1675s
 16805  4377 44643.3796   25  271 43305.6918 50970.8299  17.7%  2303 1713s
 17488  4469     cutoff   27      43305.6918 50801.3968  17.3%  2302 1751s
 18221  4509 46913.7255   21  343 43305.6918 50754.3104  17.2%  2297 1792s
 18938  4575 45909.5123   22  174 43305.6918 50440.2670  16.5%  2300 1831s
 19679  4615     cutoff   23      43305.6918 50214.9909  16.0%  2298 1873s
 20484  4690 infeasible   21      43305.6918 50038.8740  15.5%  2297 1917s
 21356  4779 45782.7042   21  278 43305.6918 49887.1799  15.2%  2292 1963s
 22264  4802 43392.5432   24  281 43305.6918 49679.4301  14.7%  2286 2012s
 23165  4820 45836.5083   24  321 43305.6918 49491.2307  14.3%  2285 2059s
 24104  4787     cutoff   31      43305.6918 49477.1279  14.3%  2282 2111s
 25041  4776     cutoff   22      43305.6918 49100.2929  13.4%  2283 2167s
 25986  4759     cutoff   20      43305.6918 48859.4251  12.8%  2285 2222s
 27027  4706 44179.1375   20  341 43305.6918 48665.1097  12.4%  2282 2286s
 28145  4589 44608.1236   27  177 43305.6918 48475.0634  11.9%  2275 2348s
 29384  4412     cutoff   23      43305.6918 48241.2403  11.4%  2264 2411s
 30621  4129     cutoff   29      43305.6918 47934.2551  10.7%  2257 2480s
 31961  3870 43635.8848   19  270 43305.6918 47668.4628  10.1%  2247 2550s
 33265  3517 infeasible   23      43305.6918 47334.0914  9.30%  2240 2621s
 34749  2939     cutoff   23      43305.6918 46965.0754  8.45%  2226 2698s
 36321  2256 45788.7342   25  264 43305.6918 46619.6523  7.65%  2210 2774s
 38131  1150     cutoff   26      43305.6918 46172.0868  6.62%  2183 2845s
 41164   294     cutoff   36      43305.6918 45380.7948  4.79%  2091 2870s

Cutting planes:
  MIR: 1208
  Mixing: 6
  Flow cover: 1822
  RLT: 29
  Relax-and-lift: 143

Explored 47150 nodes (87402807 simplex iterations) in 2875.06 seconds (8424.79 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 43305.7 43305.7 43143.5 ... 41631.9

Optimal solution found (tolerance 1.00e-06)
Best objective 4.330569181869e+04, best bound 4.330569181869e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2875.08s
  Master Objective (UB) = 43305.69, θ = 228975.76
  Upper Bound (UB) = 43305.69

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228975.76
  [DEBUG]   ✓ Scenario 0: θ = 228975.76 ≤ Q = 228975.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228975.76 ≤ Q = 228975.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228975.76 ≤ Q = 230887.13 (slack: 1911.37)
  [DEBUG]   ✓ Scenario 3: θ = 228975.76 ≤ Q = 228975.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228975.76 ≤ Q = 228975.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228975.76 ≤ Q = 228975.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1af6dbdb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe5092425
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.399079e+13
Presolve removed 2584 rows and 1874 columns
Presolve time: 0.00s
Presolved: 509 rows, 515 columns, 1436 nonzeros
Found heuristic solution: objective 6921410.0620
Variable types: 351 continuous, 164 integer (164 binary)

Root relaxation: objective -1.756043e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -175604.28    0  122 6921410.06 -175604.28   103%     -    0s
H    0     0                    -139270.9581 -175604.28  26.1%     -    0s
H    0     0                    -139649.3811 -175604.28  25.7%     -    0s
H    0     0                    -144498.6378 -157408.30  8.93%     -    0s
H    0     0                    -148524.8252 -157408.30  5.98%     -    0s
     0     0 -157408.30    0   53 -148524.83 -157408.30  5.98%     -    0s
H    0     0                    -149758.2793 -157385.04  5.09%     -    0s
H    0     0                    -151181.9265 -157385.04  4.10%     -    0s
H    0     0                    -154178.6846 -157385.04  2.08%     -    0s
     0     0 -155966.36    0   52 -154178.68 -155966.36  1.16%     -    0s
     0     0 -155951.79    0   69 -154178.68 -155951.79  1.15%     -    0s
     0     0 -155951.79    0   69 -154178.68 -155951.79  1.15%     -    0s
     0     0 -155946.84    0   59 -154178.68 -155946.84  1.15%     -    0s
     0     0 -155170.15    0   64 -154178.68 -155170.15  0.64%     -    0s
H    0     0                    -154727.7125 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   64 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   54 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   54 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   51 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   50 -154727.71 -155103.26  0.24%     -    0s
     0     0 -155103.26    0   50 -154727.71 -155103.26  0.24%     -    0s
     0     0 -154900.78    0   27 -154727.71 -154900.78  0.11%     -    0s
     0     0 -154889.25    0   23 -154727.71 -154889.25  0.10%     -    0s
     0     0 -154881.09    0   20 -154727.71 -154881.09  0.10%     -    0s
     0     0 -154842.44    0   22 -154727.71 -154842.44  0.07%     -    0s
     0     0 -154839.75    0   20 -154727.71 -154839.75  0.07%     -    0s
     0     0 -154836.84    0   20 -154727.71 -154836.84  0.07%     -    0s
     0     0 -154836.82    0   19 -154727.71 -154836.82  0.07%     -    0s
     0     0 -154799.22    0   10 -154727.71 -154799.22  0.05%     -    0s
     0     0 -154784.67    0    8 -154727.71 -154784.67  0.04%     -    0s
H    0     0                    -154768.0247 -154784.67  0.01%     -    0s
     0     0     cutoff    0      -154768.02 -154768.02  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 4
  MIR: 1
  Flow cover: 4
  RLT: 1

Explored 1 nodes (825 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -154768 -154728 -154563 ... -139271
No other solutions better than -154768

Optimal solution found (tolerance 1.00e-06)
Best objective -1.547680246864e+05, best bound -1.547680246864e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 213844.17
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -154768.02
  [DEBUG]   S×d_nominal = 368612.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 368612.19 + -154768.02 = 213844.17
  [DEBUG]   Current θ from Master = 228975.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15131.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 28174.09
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 4898.4218, Absolute Gap = 4898.4218, Relative Gap = 0.113113
  Not converged yet (gap = 4898.42 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308178 nonzeros
Model fingerprint: 0x14fbee55
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 48096 rows and 19526 columns
Presolve time: 0.81s
Presolved: 60317 rows, 26414 columns, 374919 nonzeros
Variable types: 24155 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 60317 rows, 26414 columns, 374919 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35261   -2.3645611e+04   0.000000e+00   2.221092e+08      5s
   52567    3.7320759e+04   0.000000e+00   1.471270e+07     10s
Concurrent spin time: 1.78s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 7.812100e+04, 42544 iterations, 15.58 seconds (33.65 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78121.0047    0   95 -183060.80 78121.0047   143%     -   16s
H    0     0                    -173155.1453 78121.0047   145%     -   16s
H    0     0                    -137375.2236 78121.0047   157%     -   17s
H    0     0                    -75689.62373 78121.0047   203%     -   17s
H    0     0                    -21101.48861 78121.0047   470%     -   17s
H    0     0                    -13260.04016 78121.0047   689%     -   17s
H    0     0                    -13017.86892 78121.0047   700%     -   17s
H    0     0                    -2097.964271 78121.0047  3824%     -   17s
H    0     0                    -1753.984105 78121.0047  4554%     -   17s
H    0     0                    10939.909746 78121.0047   614%     -   17s
H    0     0                    17503.082103 78121.0047   346%     -   17s
H    0     0                    27841.206751 78121.0047   181%     -   17s
H    0     0                    27940.762507 78121.0047   180%     -   17s
H    0     0                    28247.849671 78121.0047   177%     -   17s
H    0     0                    29699.990444 78120.6145   163%     -   18s
     0     0 71621.5056    0  212 29699.9904 71621.5056   141%     -   25s
H    0     0                    30064.256554 71621.3937   138%     -   25s
H    0     0                    30175.704957 71621.3937   137%     -   25s
H    0     0                    30374.873615 71621.3937   136%     -   25s
H    0     0                    30534.592755 71621.3937   135%     -   25s
H    0     0                    30845.209817 71621.3937   132%     -   25s
     0     0 71245.7426    0  208 30845.2098 71245.7426   131%     -   28s
     0     0 71098.5259    0  213 30845.2098 71098.5259   131%     -   30s
     0     0 71098.5259    0  216 30845.2098 71098.5259   131%     -   30s
     0     0 71098.5259    0  211 30845.2098 71098.5259   131%     -   31s
     0     0 71098.5259    0  201 30845.2098 71098.5259   131%     -   31s
     0     0 71098.3077    0  211 30845.2098 71098.3077   131%     -   31s
H    0     0                    30929.845845 68500.6766   121%     -   39s
H    0     0                    30974.504755 68500.6766   121%     -   39s
     0     0 68500.6766    0  223 30974.5048 68500.6766   121%     -   39s
H    0     0                    32201.353855 68500.5387   113%     -   39s
H    0     0                    32398.830822 68500.5387   111%     -   39s
H    0     0                    33077.303155 68500.5387   107%     -   39s
H    0     0                    33116.875564 68500.5387   107%     -   39s
     0     0 68014.3268    0  241 33116.8756 68014.3268   105%     -   44s
     0     0 67924.0298    0  278 33116.8756 67924.0298   105%     -   46s
     0     0 67889.8229    0  242 33116.8756 67889.8229   105%     -   47s
     0     0 67841.1970    0  274 33116.8756 67841.1970   105%     -   48s
     0     0 67838.0795    0  272 33116.8756 67838.0795   105%     -   49s
     0     0 67832.6803    0  274 33116.8756 67832.6803   105%     -   49s
     0     0 67807.9728    0  269 33116.8756 67807.9728   105%     -   50s
     0     0 67804.1974    0  271 33116.8756 67804.1974   105%     -   50s
     0     0 67803.6085    0  271 33116.8756 67803.6085   105%     -   51s
     0     0 66168.2629    0  299 33116.8756 66168.2629   100%     -   63s
     0     0 65923.6171    0  312 33116.8756 65923.6171  99.1%     -   67s
H    0     0                    39581.327958 65727.1930  66.1%     -   70s
     0     0 65727.1930    0  302 39581.3280 65727.1930  66.1%     -   70s
     0     0 65613.0552    0  312 39581.3280 65613.0552  65.8%     -   72s
     0     0 65565.0509    0  316 39581.3280 65565.0509  65.6%     -   74s
     0     0 65516.2152    0  316 39581.3280 65516.2152  65.5%     -   75s
     0     0 65484.0876    0  309 39581.3280 65484.0876  65.4%     -   76s
     0     0 65474.6534    0  312 39581.3280 65474.6534  65.4%     -   76s
     0     0 65472.6308    0  311 39581.3280 65472.6308  65.4%     -   77s
     0     0 65470.9549    0  311 39581.3280 65470.9549  65.4%     -   77s
     0     0 65470.8686    0  310 39581.3280 65470.8686  65.4%     -   77s
H    0     0                    39656.555607 64898.9547  63.7%     -   82s
     0     0 64898.9547    0  320 39656.5556 64898.9547  63.7%     -   82s
H    0     0                    40303.716947 64803.6986  60.8%     -   84s
     0     0 64803.6986    0  323 40303.7169 64803.6986  60.8%     -   84s
H    0     0                    40339.057809 64761.0104  60.5%     -   86s
H    0     0                    40354.378524 64761.0104  60.5%     -   86s
H    0     0                    40516.928633 64761.0104  59.8%     -   86s
     0     0 64761.0104    0  362 40516.9286 64761.0104  59.8%     -   86s
     0     0 64753.3887    0  369 40516.9286 64753.3887  59.8%     -   87s
     0     0 64747.7969    0  365 40516.9286 64747.7969  59.8%     -   87s
     0     0 64741.3296    0  364 40516.9286 64741.3296  59.8%     -   88s
     0     0 64738.0387    0  359 40516.9286 64738.0387  59.8%     -   88s
     0     0 64735.1388    0  361 40516.9286 64735.1388  59.8%     -   88s
     0     0 64733.6651    0  365 40516.9286 64733.6651  59.8%     -   89s
     0     0 64674.7012    0  332 40516.9286 64674.7012  59.6%     -   90s
     0     0 64646.0031    0  370 40516.9286 64646.0031  59.6%     -   92s
     0     0 64638.2612    0  372 40516.9286 64638.2612  59.5%     -   92s
     0     0 64636.2945    0  374 40516.9286 64636.2945  59.5%     -   92s
     0     0 64635.8608    0  375 40516.9286 64635.8608  59.5%     -   93s
     0     0 64617.7034    0  379 40516.9286 64617.7034  59.5%     -   93s
     0     0 64605.8576    0  413 40516.9286 64605.8576  59.5%     -   95s
     0     0 64602.9745    0  418 40516.9286 64602.9745  59.4%     -   95s
     0     0 64600.9247    0  419 40516.9286 64600.9247  59.4%     -   96s
     0     0 64600.6357    0  394 40516.9286 64600.6357  59.4%     -   96s
     0     0 64547.2143    0  346 40516.9286 64547.2143  59.3%     -   98s
     0     0 64538.2725    0  349 40516.9286 64538.2725  59.3%     -   98s
     0     0 64532.9054    0  347 40516.9286 64532.9054  59.3%     -   99s
     0     0 64532.3424    0  344 40516.9286 64532.3424  59.3%     -   99s
     0     0 64518.3659    0  354 40516.9286 64518.3659  59.2%     -  100s
     0     0 64511.6072    0  355 40516.9286 64511.6072  59.2%     -  101s
     0     0 64509.3765    0  354 40516.9286 64509.3765  59.2%     -  102s
     0     0 64508.4409    0  353 40516.9286 64508.4409  59.2%     -  102s
     0     0 64502.9154    0  382 40516.9286 64502.9154  59.2%     -  103s
     0     0 64499.7856    0  423 40516.9286 64499.7856  59.2%     -  104s
     0     0 64496.8832    0  387 40516.9286 64496.8832  59.2%     -  104s
     0     0 64496.3315    0  362 40516.9286 64496.3315  59.2%     -  104s
     0     0 64496.0858    0  382 40516.9286 64496.0858  59.2%     -  105s
H    0     0                    40597.025838 64488.6623  58.9%     -  107s
     0     0 64488.6623    0  396 40597.0258 64488.6623  58.9%     -  107s
     0     0 64488.6623    0  382 40597.0258 64488.6623  58.9%     -  108s
     0     0 64488.6623    0  382 40597.0258 64488.6623  58.9%     -  108s
H    0     0                    41322.014554 64488.6623  56.1%     -  129s
H    0     2                    41403.420578 64488.6623  55.8%     -  129s
     0     2 64488.6623    0  382 41403.4206 64488.6623  55.8%     -  129s
     1     4 64454.2824    1  381 41403.4206 64488.6623  55.8%  1331  131s
     3     8 64409.0978    2  377 41403.4206 64453.5416  55.7%  2363  139s
     7    16 64352.4973    3  411 41403.4206 64408.2697  55.6%  5408  147s
    15    32 64214.6229    4  337 41403.4206 64352.1488  55.4%  6533  153s
    31    48 62095.8170    5  334 41403.4206 64213.8406  55.1%  9592  172s
    47    80 61686.3445    6  366 41403.4206 64213.8406  55.1%  9327  181s
H   48    80                    41532.715516 64213.8406  54.6%  9132  181s
H   56    80                    41639.938407 64213.8406  54.2%  8537  181s
H   62    80                    41758.120181 64213.8406  53.8%  8051  181s
    79   143 61601.2535    7  334 41758.1202 64213.8406  53.8%  6889  207s
   142   278 60991.5009    8  336 41758.1202 64213.8406  53.8%  4796  219s
H  210   278                    41831.317998 64213.8406  53.5%  3915  219s
   277   378 61355.5978   10  328 41831.3180 64213.8406  53.5%  3664  230s
H  377   473                    41845.385185 64213.8406  53.5%  3314  241s
H  434   473                    41849.565602 64213.8406  53.4%  3169  241s
   472   563 61042.7280   11  331 41849.5656 64213.8406  53.4%  3094  245s
H  570   595                    41927.162959 64213.8406  53.2%  2895  248s
H  584   595                    42165.807116 64213.8406  52.3%  2887  248s
   594   674 60665.1169   10  300 42165.8071 64213.8406  52.3%  2874  254s
   673   710 59528.3226   10  280 42165.8071 64213.8406  52.3%  2797  259s
   709   765 59057.2542   11  289 42165.8071 64213.8406  52.3%  2799  264s
   764   797 60990.8691   12  332 42165.8071 64213.8406  52.3%  2749  268s
H  778   797                    42244.730482 64213.8406  52.0%  2749  268s
   796   893 61077.1008   12  316 42244.7305 64213.8406  52.0%  2745  272s
   897   921 60998.2101   12  379 42244.7305 64213.8406  52.0%  2637  280s
H  929   921                    42299.433167 64213.8406  51.8%  2616  280s
   931  1022 58790.2875   12  286 42299.4332 64213.8406  51.8%  2628  285s
  1094  1118 58817.5255   12  294 42299.4332 64213.8406  51.8%  2558  296s
  1172  1174 60692.7722   13  303 42299.4332 64213.8406  51.8%  2542  303s
  1260  1220 60709.8817   13  310 42299.4332 64213.8406  51.8%  2557  312s
  1340  1255 60544.0564   13  303 42299.4332 64213.8406  51.8%  2607  321s
  1429  1323 60887.1649   14  309 42299.4332 64213.8406  51.8%  2670  331s
  1527  1388 60935.9936   14  305 42299.4332 64213.8406  51.8%  2709  338s
  1621  1463 60517.5592   14  338 42299.4332 64213.8406  51.8%  2767  347s
  1708  1532 56381.7486   13  285 42299.4332 64213.8406  51.8%  2816  354s
  1791  1623 60693.1841   15  343 42299.4332 64213.8406  51.8%  2883  363s
  1894  1706 60680.8682   15  304 42299.4332 64213.8406  51.8%  2913  372s
  2021  1782 60286.2771   15  338 42299.4332 64213.8406  51.8%  2925  380s
  2147  1818 60160.7523   16  300 42299.4332 63810.7075  50.9%  2950  389s
  2189  1885 58465.5821   15  355 42299.4332 63810.7075  50.9%  3009  398s
H 2227  1885                    42333.755125 63810.7075  50.7%  3021  398s
  2288  1955 58394.1106   15  316 42333.7551 63810.7075  50.7%  3037  408s
  2414  2040 60242.8322   16  303 42333.7551 63810.7075  50.7%  3100  418s
  2547  2147 59774.0390   17  330 42333.7551 63810.7075  50.7%  3153  429s
  2672  2178 56347.3375   18  306 42333.7551 63810.7075  50.7%  3216  435s
H 2673  2178                    42384.416702 63810.7075  50.6%  3215  435s
H 2675  2176                    42569.678210 63810.7075  49.9%  3217  435s
H 2677  2176                    42586.661122 63810.7075  49.8%  3218  435s
H 2691  2176                    42653.391423 63810.7075  49.6%  3236  435s
H 2696  2174                    42837.231738 63810.7075  49.0%  3236  435s
  2705  2317 56858.6948   17  289 42837.2317 63810.7075  49.0%  3240  446s
  2872  2508 52898.5003   20  282 42837.2317 63810.7075  49.0%  3236  456s
  3087  2536 53997.7189   19  319 42837.2317 63810.7075  49.0%  3198  466s
  3121  2569 56097.7343   19  310 42837.2317 63810.7075  49.0%  3200  473s
  3164  2599 54891.8048   20  302 42837.2317 62973.0539  47.0%  3204  481s
  3202  2653 55512.3619   20  254 42837.2317 62973.0539  47.0%  3200  489s
  3257  2654 50425.7494   18  382 42837.2317 62973.0539  47.0%  3188  518s
  3259  2655 50833.6674   25   95 42837.2317 62973.0539  47.0%  3186  542s
  3260  2656 57442.9387   14  297 42837.2317 62973.0539  47.0%  3185  561s
  3261  2657 58508.6413    9  339 42837.2317 62973.0539  47.0%  3184  571s
  3262  2657 47049.2419   58  342 42837.2317 62973.0539  47.0%  3183  578s
  3263  2658 54148.9028   43  366 42837.2317 62973.0539  47.0%  3182  581s
  3266  2660 48625.3285   45  364 42837.2317 62973.0539  47.0%  3179  585s
  3272  2664 57208.0852   23  418 42837.2317 62973.0539  47.0%  3173  593s
  3274  2665 57052.6015   13  374 42837.2317 62973.0539  47.0%  3171  595s
  3276  2667 45647.9697   43  420 42837.2317 62973.0539  47.0%  3169  600s
  3279  2669 52994.4713   34  389 42837.2317 62973.0539  47.0%  3166  605s
  3281  2670 53059.2940   24  417 42837.2317 62973.0539  47.0%  3164  610s
  3283  2671 46214.2561   53  436 42837.2317 62973.0539  47.0%  3163  617s
  3287  2674 52643.3351   22  476 42837.2317 62973.0539  47.0%  3159  624s
  3288  2675 60597.8144   10  455 42837.2317 62973.0539  47.0%  3158  625s
  3290  2676 60915.5953   12  407 42837.2317 62973.0539  47.0%  3156  632s
  3293  2678 50710.8656   28  438 42837.2317 62973.0539  47.0%  3153  638s
  3294  2679 55589.3476   22  443 42837.2317 62973.0539  47.0%  3152  640s
  3296  2680 59328.1086   22  411 42837.2317 62973.0539  47.0%  3150  663s
  3297  2681 55835.9275   16  411 42837.2317 62973.0539  47.0%  3149  682s
  3298  2684 62973.0539   11  348 42837.2317 62973.0539  47.0%  3204  699s
  3300  2688 62973.0539   12  356 42837.2317 62973.0539  47.0%  3205  715s
  3304  2694 62973.0539   13  356 42837.2317 62973.0539  47.0%  3213  730s
  3312  2708 62973.0539   14  346 42837.2317 62973.0539  47.0%  3228  744s
  3328  2721 59604.9305   15  333 42837.2317 62973.0539  47.0%  3294  776s
  3347  2747 59691.2967   16  338 42837.2317 62973.0539  47.0%  3333  800s
  3379  2768 56753.7210   17  314 42837.2317 62973.0539  47.0%  3383  817s
H 3394  2628                    42851.677345 62973.0539  47.0%  3445  817s
  3411  2726 56615.1379   18  309 42851.6773 62973.0539  47.0%  3515  848s
  3525  2752 54424.2627   22  300 42851.6773 62973.0539  47.0%  3583  866s
  3603  2751 53491.7988   22  277 42851.6773 62973.0539  47.0%  3628  879s
  3642  2764 53364.1585   23  273 42851.6773 62720.1140  46.4%  3655  895s
  3698  2756 52583.9101   23  266 42851.6773 62716.1376  46.4%  3670  912s
  3752  2767 52003.8425   22  285 42851.6773 62716.1376  46.4%  3680  928s
  3803  2782 51384.6895   22  287 42851.6773 61602.2048  43.8%  3695  941s
  3849  2793 51493.5314   23  276 42851.6773 61602.2048  43.8%  3707  951s
  3899  2811 51397.3087   24  281 42851.6773 61602.2048  43.8%  3713  965s
  3958  2825 51695.7340   24  241 42851.6773 60741.3512  41.7%  3714  983s
  4027  2839 50024.3057   25  236 42851.6773 60741.3512  41.7%  3707  996s
  4078  2862 48370.9931   25  249 42851.6773 60741.3512  41.7%  3719 1011s
  4141  2877 49021.3172   26  247 42851.6773 60741.3512  41.7%  3719 1024s
  4199  2886 48487.9095   27  242 42851.6773 60352.1189  40.8%  3719 1041s
  4262  2907 48019.5103   28  240 42851.6773 60352.1189  40.8%  3730 1055s
  4327  2924 45418.1972   29  289 42851.6773 60352.1189  40.8%  3738 1069s
  4393  2951     cutoff   29      42851.6773 60293.3913  40.7%  3738 1086s
  4494  2957 46551.1146   28  236 42851.6773 60293.3913  40.7%  3718 1106s
  4590  2955 43690.0872   30  152 42851.6773 60293.3913  40.7%  3697 1124s
  4676  2973 45409.1979   29  267 42851.6773 60293.3913  40.7%  3703 1145s
  4757  3010     cutoff   30      42851.6773 60293.3913  40.7%  3717 1166s
  4854  3042 49617.8857   18  306 42851.6773 60293.3913  40.7%  3728 1185s
  4974  3052 52098.7162   18  303 42851.6773 60293.3913  40.7%  3724 1209s
  5098  3075 47647.6701   19  280 42851.6773 59707.7327  39.3%  3722 1234s
  5209  3105 47148.9217   20  285 42851.6773 59707.7327  39.3%  3732 1257s
  5331  3136 infeasible   22      42851.6773 59707.7327  39.3%  3739 1281s
  5474  3153 45066.8493   22  280 42851.6773 59707.7327  39.3%  3737 1303s
  5619  3164 55215.3435   19  314 42851.6773 58544.0704  36.6%  3737 1326s
  5761  3208 52722.6936   21  319 42851.6773 58544.0704  36.6%  3739 1352s
  5909  3241 48620.7394   24  249 42851.6773 58544.0704  36.6%  3737 1377s
  6069  3267 45907.8443   27  217 42851.6773 58260.2284  36.0%  3731 1403s
  6276  3275 43170.6843   30  228 42851.6773 58135.4367  35.7%  3704 1437s
  6481  3318 49997.7759   22  243 42851.6773 58135.4367  35.7%  3689 1463s
  6642  3342 46144.1892   26  267 42851.6773 58135.4367  35.7%  3698 1494s
  6869  3368     cutoff   29      42851.6773 58135.4367  35.7%  3670 1524s
  7106  3420 50246.5935   24  251 42851.6773 57755.7885  34.8%  3647 1553s
  7337  3423 45029.3570   29  131 42851.6773 57487.2082  34.2%  3630 1586s
  7548  3425     cutoff   29      42851.6773 57341.2873  33.8%  3630 1615s
  7778  3471 53276.9290   20  313 42851.6773 57341.2873  33.8%  3628 1650s
  8002  3493 49709.9985   27  231 42851.6773 57341.2873  33.8%  3631 1681s
H 8093  3327                    43071.887177 57341.2873  33.1%  3630 1681s
  8202  3415 47090.9819   36   98 43071.8872 57341.2873  33.1%  3616 1720s
  8532  3415 43170.8290   64   83 43071.8872 57341.2873  33.1%  3585 1760s
  8789  3468 48341.5400   23  294 43071.8872 57341.2873  33.1%  3592 1800s
  9139  3386 43296.4636   29  267 43071.8872 56968.9116  32.3%  3563 1836s
H 9212  3239                    43088.777552 56968.9116  32.2%  3558 1836s
  9264  3323 43512.0692   27  264 43088.7776 56968.9116  32.2%  3557 1872s
H 9269  3195                    43139.439129 56968.9116  32.1%  3557 1872s
H 9294  3064                    43272.406354 56968.9116  31.7%  3558 1872s
  9540  3175     cutoff   26      43272.4064 56677.5573  31.0%  3544 1917s
  9908  3273 49411.6684   22  251 43272.4064 56213.6236  29.9%  3524 1963s
 10300  3387     cutoff   30      43272.4064 55725.1287  28.8%  3506 2017s
 10676  3527     cutoff   24      43272.4064 55664.9303  28.6%  3499 2069s
 11102  3636 43875.8363   26  235 43272.4064 55369.7251  28.0%  3489 2126s
 11469  3757 43534.2220   25  191 43272.4064 55249.7382  27.7%  3493 2178s
 11862  3888     cutoff   26      43272.4064 55114.1555  27.4%  3496 2238s
 12290  4013 44980.6014   26  182 43272.4064 55114.1555  27.4%  3491 2292s
 12710  4162 49216.1102   23  212 43272.4064 55114.1555  27.4%  3494 2354s
 13189  4277 46321.0401   26  249 43272.4064 54349.8346  25.6%  3489 2410s
 13613  4440 45702.7677   26  195 43272.4064 54130.9318  25.1%  3500 2468s
 14111  4540     cutoff   23      43272.4064 53820.2120  24.4%  3502 2528s
 14752  4667 44244.5560   28  192 43272.4064 53807.0203  24.3%  3468 2585s
H14929  4660                    43304.457955 53797.6368  24.2%  3462 2585s
 15262  4801     cutoff   24      43304.4580 53633.3430  23.9%  3449 2648s
 15808  4921 44447.4154   31  273 43304.4580 53387.4711  23.3%  3450 2716s
 16441  5054 46932.2389   20  246 43304.4580 53183.4141  22.8%  3441 2792s
 17113  5225     cutoff   27      43304.4580 53044.0836  22.5%  3432 2863s
 17794  5381 43377.2382   28  201 43304.4580 52700.8645  21.7%  3423 2933s
 18494  5587 43636.0856   24  258 43304.4580 52653.0182  21.6%  3416 3012s
 19248  5749 46789.9960   25  293 43304.4580 52362.9686  20.9%  3401 3093s
 20005  5921     cutoff   24      43304.4580 52166.4747  20.5%  3397 3175s
 20790  6165 44607.2308   29  118 43304.4580 52155.0390  20.4%  3390 3258s
 21667  6305 48120.9836   27  230 43304.4580 51990.5520  20.1%  3363 3352s
 22575  6545     cutoff   29      43304.4580 51818.2099  19.7%  3344 3452s
 23546  6700 44363.4578   21  239 43304.4580 51493.1232  18.9%  3325 3558s
 24431  6687 47174.7465   29  297 43304.4580 51307.2560  18.5%  3322 3600s

Cutting planes:
  Learned: 1
  MIR: 1159
  Mixing: 5
  Flow cover: 2328
  RLT: 17
  Relax-and-lift: 168

Explored 24891 nodes (82535359 simplex iterations) in 3600.04 seconds (9707.50 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 43304.5 43272.4 43139.4 ... 42569.7

Time limit reached
Best objective 4.330445795493e+04, best bound 5.130725597052e+04, gap 18.4803%
  WARNING: Time limit reached. Using best solution found (gap: 18.48%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 43304.46, θ = 226307.14
  Upper Bound (UB) = 43304.46

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226307.14
  [DEBUG]   ✓ Scenario 0: θ = 226307.14 ≤ Q = 226307.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226307.14 ≤ Q = 226307.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 226307.14 ≤ Q = 226307.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7af40c2f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x850bf3d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.396629e+13
Presolve removed 2587 rows and 1877 columns
Presolve time: 0.00s
Presolved: 506 rows, 512 columns, 1433 nonzeros
Found heuristic solution: objective 6960139.4907
Variable types: 348 continuous, 164 integer (164 binary)

Root relaxation: objective -1.796769e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -179676.87    0  127 6960139.49 -179676.87   103%     -    0s
H    0     0                    -141626.4793 -179676.87  26.9%     -    0s
H    0     0                    -141913.3419 -179676.87  26.6%     -    0s
H    0     0                    -146471.8852 -179676.87  22.7%     -    0s
H    0     0                    -160790.9159 -179676.87  11.7%     -    0s
     0     0 -164398.53    0   60 -160790.92 -164398.53  2.24%     -    0s
H    0     0                    -162646.1214 -164386.07  1.07%     -    0s
     0     0 -163360.15    0   47 -162646.12 -163360.15  0.44%     -    0s
     0     0 -163268.44    0   12 -162646.12 -163268.44  0.38%     -    0s
H    0     0                    -163127.2458 -163267.44  0.09%     -    0s
H    0     0                    -163134.2804 -163249.16  0.07%     -    0s
     0     0 -163249.16    0    9 -163134.28 -163249.16  0.07%     -    0s
     0     0 -163187.51    0    8 -163134.28 -163187.51  0.03%     -    0s
     0     0 -163179.26    0    6 -163134.28 -163179.26  0.03%     -    0s
H    0     0                    -163150.5032 -163179.26  0.02%     -    0s
H    0     0                    -163164.3288 -163179.26  0.01%     -    0s
*    0     0               0    -163165.6805 -163165.68  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  MIR: 1
  Flow cover: 2

Explored 1 nodes (585 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -163166 -163164 -163151 ... -141626
No other solutions better than -163166

Optimal solution found (tolerance 1.00e-06)
Best objective -1.631656804504e+05, best bound -1.631656804504e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 204786.52
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -163165.68
  [DEBUG]   S×d_nominal = 367952.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367952.20 + -163165.68 = 204786.52
  [DEBUG]   Current θ from Master = 226307.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21520.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21783.83
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 4897.1879, Absolute Gap = 4897.1879, Relative Gap = 0.113087
  Not converged yet (gap = 4897.19 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351415 nonzeros
Model fingerprint: 0xc4a734dc
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 54984 rows and 22324 columns
Presolve time: 1.00s
Presolved: 68719 rows, 29856 columns, 427639 nonzeros
Variable types: 27597 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 68719 rows, 29856 columns, 427639 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30062   -6.7101418e+04   0.000000e+00   1.481872e+08      5s
   43677    3.4353212e+04   0.000000e+00   1.320503e+07     10s
   53322    4.2477533e+04   0.000000e+00   1.162977e+07     15s
   64259    5.2098715e+04   0.000000e+00   4.501201e+07     20s
   74208    5.9804351e+04   0.000000e+00   4.174574e+06     25s
   84900    6.3918502e+04   0.000000e+00   1.359402e+06     30s
Concurrent spin time: 6.27s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 7.812100e+04, 77095 iterations, 35.39 seconds (67.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 78121.0047    0   95 -183060.80 78121.0047   143%     -   36s
H    0     0                    -169322.6190 78121.0047   146%     -   36s
H    0     0                    -164769.8270 78121.0047   147%     -   37s
H    0     0                    -146022.9314 78121.0047   153%     -   37s
H    0     0                    -145772.8260 78121.0047   154%     -   37s
H    0     0                    -142068.5001 78121.0047   155%     -   37s
H    0     0                    -142035.3921 78121.0047   155%     -   37s
H    0     0                    -141888.5124 78121.0047   155%     -   37s
H    0     0                    -141586.7095 78121.0047   155%     -   37s
H    0     0                    -72287.70022 78121.0047   208%     -   37s
H    0     0                    -72265.71251 78121.0047   208%     -   37s
H    0     0                    -27566.17091 78121.0047   383%     -   37s
H    0     0                    5834.8439971 78121.0047  1239%     -   37s
H    0     0                    24930.919732 78121.0047   213%     -   37s
H    0     0                    25470.921919 78121.0047   207%     -   37s
H    0     0                    25727.360687 78121.0047   204%     -   37s
H    0     0                    27824.395323 78121.0047   181%     -   37s
H    0     0                    27940.762507 78121.0047   180%     -   37s
H    0     0                    28247.849671 78121.0047   177%     -   37s
H    0     0                    30801.227107 71635.7991   133%     -   51s
H    0     0                    30845.209817 71635.7991   132%     -   51s
H    0     0                    31111.844169 71635.7991   130%     -   51s
     0     0 71262.8618    0  212 31111.8442 71262.8618   129%     -   51s
     0     0 71073.6735    0  209 31111.8442 71073.6735   128%     -   56s
     0     0 71073.6735    0  211 31111.8442 71073.6735   128%     -   57s
     0     0 71073.6735    0  214 31111.8442 71073.6735   128%     -   59s
     0     0 71073.6735    0  212 31111.8442 71073.6735   128%     -   61s
     0     0 71073.6735    0  211 31111.8442 71073.6735   128%     -   61s
     0     0 71073.6735    0  211 31111.8442 71073.6735   128%     -   61s
H    0     0                    31423.452113 68235.2604   117%     -   74s
H    0     0                    31499.834771 68235.2604   117%     -   74s
     0     0 68155.3709    0  242 31499.8348 68155.3709   116%     -   74s
H    0     0                    37859.430294 68155.3709  80.0%     -   74s
     0     0 67940.8981    0  235 37859.4303 67940.8981  79.5%     -   81s
     0     0 67803.9884    0  242 37859.4303 67803.9884  79.1%     -   85s
     0     0 67713.7956    0  234 37859.4303 67713.7956  78.9%     -   87s
     0     0 67689.8303    0  244 37859.4303 67689.8303  78.8%     -   88s
     0     0 67685.5107    0  244 37859.4303 67685.5107  78.8%     -   88s
     0     0 67680.8745    0  246 37859.4303 67680.8745  78.8%     -   89s
     0     0 67676.8564    0  250 37859.4303 67676.8564  78.8%     -   90s
     0     0 67676.2801    0  250 37859.4303 67676.2801  78.8%     -   90s
     0     0 66013.2004    0  302 37859.4303 66013.2004  74.4%     -  109s
     0     0 65585.7459    0  331 37859.4303 65585.7459  73.2%     -  114s
H    0     0                    38664.995352 65474.7089  69.3%     -  117s
H    0     0                    39686.617432 65474.7089  65.0%     -  117s
H    0     0                    39829.180171 65474.7089  64.4%     -  117s
H    0     0                    39874.515878 65474.7089  64.2%     -  117s
     0     0 65474.7089    0  306 39874.5159 65474.7089  64.2%     -  117s
     0     0 65424.5151    0  310 39874.5159 65424.5151  64.1%     -  119s
     0     0 65392.0515    0  313 39874.5159 65392.0515  64.0%     -  120s
     0     0 65324.8954    0  305 39874.5159 65324.8954  63.8%     -  121s
     0     0 65306.1308    0  314 39874.5159 65306.1308  63.8%     -  122s
     0     0 65267.0532    0  307 39874.5159 65267.0532  63.7%     -  123s
     0     0 65263.7936    0  311 39874.5159 65263.7936  63.7%     -  124s
H    0     0                    40040.445699 65259.4425  63.0%     -  124s
     0     0 65259.4425    0  315 40040.4457 65259.4425  63.0%     -  124s
     0     0 65255.1857    0  317 40040.4457 65255.1857  63.0%     -  125s
     0     0 65253.7506    0  319 40040.4457 65253.7506  63.0%     -  126s
     0     0 65250.9373    0  314 40040.4457 65250.9373  63.0%     -  126s
     0     0 65249.9301    0  315 40040.4457 65249.9301  63.0%     -  127s
     0     0 64923.5575    0  338 40040.4457 64923.5575  62.1%     -  133s
     0     0 64824.9285    0  334 40040.4457 64824.9285  61.9%     -  136s
     0     0 64786.5554    0  324 40040.4457 64786.5554  61.8%     -  137s
     0     0 64775.7746    0  331 40040.4457 64775.7746  61.8%     -  137s
     0     0 64758.4619    0  331 40040.4457 64758.4619  61.7%     -  139s
     0     0 64753.1173    0  327 40040.4457 64753.1173  61.7%     -  140s
     0     0 64747.8457    0  335 40040.4457 64747.8457  61.7%     -  140s
     0     0 64745.3032    0  340 40040.4457 64745.3032  61.7%     -  141s
     0     0 64744.4218    0  355 40040.4457 64744.4218  61.7%     -  141s
     0     0 64709.5881    0  370 40040.4457 64709.5881  61.6%     -  143s
H    0     0                    40108.986040 64709.3667  61.3%     -  144s
     0     0 64688.7738    0  362 40108.9860 64688.7738  61.3%     -  144s
     0     0 64686.7703    0  366 40108.9860 64686.7703  61.3%     -  145s
     0     0 64682.0608    0  372 40108.9860 64682.0608  61.3%     -  145s
     0     0 64672.9941    0  372 40108.9860 64672.9941  61.2%     -  146s
     0     0 64669.0839    0  368 40108.9860 64669.0839  61.2%     -  146s
     0     0 64665.8453    0  395 40108.9860 64665.8453  61.2%     -  147s
     0     0 64664.7262    0  404 40108.9860 64664.7262  61.2%     -  147s
     0     0 64634.0359    0  365 40108.9860 64634.0359  61.1%     -  149s
H    0     0                    40585.554229 64633.5331  59.3%     -  151s
     0     0 64603.7350    0  396 40585.5542 64603.7350  59.2%     -  154s
     0     0 64594.3623    0  435 40585.5542 64594.3623  59.2%     -  155s
     0     0 64586.0855    0  439 40585.5542 64586.0855  59.1%     -  156s
     0     0 64584.5284    0  340 40585.5542 64584.5284  59.1%     -  156s
     0     0 64583.6253    0  343 40585.5542 64583.6253  59.1%     -  157s
     0     0 64572.7905    0  413 40585.5542 64572.7905  59.1%     -  158s
     0     0 64570.7828    0  412 40585.5542 64570.7828  59.1%     -  159s
     0     0 64569.6735    0  410 40585.5542 64569.6735  59.1%     -  159s
     0     0 64555.8180    0  405 40585.5542 64555.8180  59.1%     -  161s
     0     0 64541.7469    0  414 40585.5542 64541.7469  59.0%     -  164s
     0     0 64539.9434    0  415 40585.5542 64539.9434  59.0%     -  164s
     0     0 64539.3712    0  409 40585.5542 64539.3712  59.0%     -  164s
     0     0 64525.5450    0  408 40585.5542 64525.5450  59.0%     -  165s
     0     0 64521.2005    0  421 40585.5542 64521.2005  59.0%     -  166s
     0     0 64520.3704    0  359 40585.5542 64520.3704  59.0%     -  166s
     0     0 64513.4576    0  412 40585.5542 64513.4576  59.0%     -  168s
H    0     0                    40912.611226 64512.4782  57.7%     -  173s
     0     0 64510.5708    0  381 40912.6112 64510.5708  57.7%     -  174s
     0     0 64509.4972    0  383 40912.6112 64509.4972  57.7%     -  174s
     0     0 64506.9470    0  388 40912.6112 64506.9470  57.7%     -  176s
     0     0 64506.2750    0  388 40912.6112 64506.2750  57.7%     -  176s
     0     0 64504.4074    0  363 40912.6112 64504.4074  57.7%     -  177s
     0     0 64502.4880    0  357 40912.6112 64502.4880  57.7%     -  178s
     0     0 64501.1168    0  360 40912.6112 64501.1168  57.7%     -  178s
     0     0 64500.7933    0  359 40912.6112 64500.7933  57.7%     -  179s
     0     0 64500.7132    0  359 40912.6112 64500.7132  57.7%     -  180s
H    0     0                    40930.025681 64500.7132  57.6%     -  206s
H    0     0                    41236.940983 64500.7132  56.4%     -  209s
H    0     0                    41285.236104 64500.7132  56.2%     -  209s
H    0     0                    41335.897681 64500.7132  56.0%     -  210s
     0     2 64500.7132    0  359 41335.8977 64500.7132  56.0%     -  211s
     1     4 64384.3532    1  342 41335.8977 64500.3577  56.0%  4250  216s
     3     7 64336.4846    2  338 41335.8977 64384.3353  55.8%  5309  221s
     6    13 64266.6352    3  352 41335.8977 64335.9784  55.6%  5498  229s
    12    26 64147.4606    4  380 41335.8977 64287.9422  55.5%  6765  238s
    25    39 63607.8029    5  336 41335.8977 64147.3764  55.2%  9567  256s
    38    71 62802.8030    6  307 41335.8977 64147.3764  55.2%  8946  282s
H   45    71                    41383.149975 64147.3764  55.0%  8914  282s
H   53    71                    41423.655453 64147.3764  54.9%  8759  282s
    70   164 62592.4332    7  306 41423.6555 63823.5134  54.1%  9643  299s
   163   268 62492.6301   10  300 41423.6555 63823.5134  54.1%  6058  311s
H  182   268                    41802.181494 63823.5134  52.7%  5715  311s
   267   340 62094.9187   13  297 41802.1815 63823.5134  52.7%  4826  321s
   339   401 61632.9045   15  312 41802.1815 63823.5134  52.7%  4572  331s
H  345   401                    41852.843071 63823.5134  52.5%  4523  331s
   400   473 61230.3450   16  320 41852.8431 63823.5134  52.5%  4368  343s
   472   531 61155.0732   18  318 41852.8431 63823.5134  52.5%  4122  351s
   530   595 60285.6758   20  283 41852.8431 63823.5134  52.5%  4160  359s
   600   645 60115.6963   21  274 41852.8431 63823.5134  52.5%  4154  369s
   650   700 59920.4345   23  330 41852.8431 63823.5134  52.5%  4183  378s
   709   768 59683.9445   24  328 41852.8431 63723.7704  52.3%  4116  387s
   782   831 59617.1207   25  328 41852.8431 63723.7704  52.3%  3968  395s
   853   859 59178.6542   27  327 41852.8431 63656.3255  52.1%  3860  403s
   889   891 58881.3226   28  329 41852.8431 63656.3255  52.1%  3819  413s
   925   922 58780.1949   29  337 41852.8431 63656.3255  52.1%  3788  422s
   956   952 56647.6839   36  303 41852.8431 63656.3255  52.1%  3744  430s
H  982   952                    42179.144620 63656.3255  50.9%  3707  430s
H  986   952                    42408.009677 63656.3255  50.1%  3696  430s
   988  1059 58617.0162   30  326 42408.0097 63656.3255  50.1%  3691  439s
  1115  1110 58310.5160   32  328 42408.0097 63656.3255  50.1%  3425  449s
H 1148  1110                    42503.744398 63656.3255  49.8%  3361  449s
H 1151  1110                    42510.384698 63656.3255  49.7%  3358  449s
  1184  1207 58162.9052   33  269 42510.3847 63656.3255  49.7%  3301  459s
  1301  1260 57555.4745   36  221 42510.3847 63550.7403  49.5%  3159  469s
H 1312  1260                    42552.912090 63550.7403  49.3%  3141  469s
  1370  1357 57321.3048   37  241 42552.9121 63550.7403  49.3%  3101  479s
  1507  1442 56905.5282   39  231 42552.9121 63496.2076  49.2%  2960  491s
  1640  1526 55860.7396   42  221 42552.9121 63496.2076  49.2%  2866  503s
  1750  1556 55620.9713   45  218 42552.9121 63496.2076  49.2%  2834  514s
  1780  1588 55463.5841   46  219 42552.9121 63496.2076  49.2%  2861  523s
  1814  1625 55423.7760   47  215 42552.9121 63496.2076  49.2%  2880  531s
  1855  1703 55280.4768   48  210 42552.9121 63496.2076  49.2%  2880  542s
  1953  1789 54923.3536   51  195 42552.9121 63496.2076  49.2%  2807  554s
  2071  1877 53549.1026   62  190 42552.9121 63496.2076  49.2%  2741  564s
  2166  1974 52979.8217   64  188 42552.9121 63384.1440  49.0%  2695  576s
  2283  2109 52811.9883   69  206 42552.9121 63384.1440  49.0%  2666  588s
  2442  2305 51939.1050   78  225 42552.9121 63384.1440  49.0%  2610  599s
  2650  2459 48704.3016   89  199 42552.9121 63384.1440  49.0%  2526  612s
  2853  2520 45795.6971  106  142 42552.9121 63384.1440  49.0%  2454  627s
  2963  2607 47462.0078   43  112 42552.9121 63346.7081  48.9%  2477  645s
  3078  2718 56015.1448   10  285 42552.9121 63346.7081  48.9%  2499  660s
  3221  2829 55231.8392   12  286 42552.9121 63346.7081  48.9%  2515  676s
  3390  2947 49727.8657   15  260 42552.9121 63148.4529  48.4%  2500  694s
  3548  2948 52761.0985   37  359 42552.9121 63113.6971  48.3%  2506  739s
  3550  2949 52915.6515   15   95 42552.9121 63113.6971  48.3%  2505  758s
  3551  2950 49167.8595   77  297 42552.9121 63113.6971  48.3%  2504  776s
  3552  2951 60110.2508   18  316 42552.9121 63113.6971  48.3%  2504  787s
  3553  2951 46129.0532   70  328 42552.9121 63113.6971  48.3%  2503  794s
  3554  2952 54919.8331   39  362 42552.9121 63113.6971  48.3%  2502  799s
  3555  2953 60365.3601   22  373 42552.9121 63113.6971  48.3%  2501  803s
  3556  2953 57345.1610   12  342 42552.9121 63113.6971  48.3%  2501  805s
  3558  2955 49589.2956   40  377 42552.9121 63113.6971  48.3%  2499  810s
  3562  2957 50571.3335   58  359 42552.9121 63113.6971  48.3%  2496  815s
  3564  2959 44471.6786   83  423 42552.9121 63113.6971  48.3%  2495  820s
  3568  2961 52018.1454   57  394 42552.9121 63113.6971  48.3%  2492  825s
  3570  2963 62359.4343   11  409 42552.9121 63113.6971  48.3%  2491  831s
  3571  2963 49085.5749   27  399 42552.9121 63113.6971  48.3%  2490  835s
  3573  2965 52211.0629   44  397 42552.9121 63113.6971  48.3%  2489  840s
  3576  2967 47670.9751   20  393 42552.9121 63113.6971  48.3%  2487  846s
  3577  2967 51474.5994   54  397 42552.9121 63113.6971  48.3%  2486  850s
  3580  2969 53550.1277   17  343 42552.9121 63113.6971  48.3%  2484  855s
  3583  2971 55474.3563   23  389 42552.9121 63113.6971  48.3%  2482  862s
  3584  2972 48084.7085   49  389 42552.9121 63113.6971  48.3%  2481  881s
  3585  2973 44868.2740   54  389 42552.9121 63113.6971  48.3%  2480  901s
  3586  2976 63113.6971   12  388 42552.9121 63113.6971  48.3%  2529  919s
  3588  2980 63113.6971   13  382 42552.9121 63113.6971  48.3%  2531  929s
  3592  2986 63113.6971   14  386 42552.9121 63113.6971  48.3%  2541  945s
  3600  3000 63113.6971   15  378 42552.9121 63113.6971  48.3%  2554  960s
  3616  3010 62888.5392   16  393 42552.9121 63113.6971  48.3%  2592  984s
  3632  3037 60802.4944   17  350 42552.9121 63113.6971  48.3%  2655 1005s
  3664  3162 60767.1807   18  344 42552.9121 63113.6971  48.3%  2729 1025s
  3800  3187 60206.5225   22  331 42552.9121 63113.6971  48.3%  2783 1038s
  3870  3223 60044.6552   22  332 42552.9121 63113.6971  48.3%  2796 1051s
  3929  3264 57378.7093   21  278 42552.9121 63113.6971  48.3%  2832 1063s
  3994  3273 57203.1257   23  358 42552.9121 63113.6971  48.3%  2858 1075s
  4042  3284 58606.2085   24  290 42552.9121 63113.6971  48.3%  2882 1084s
  4072  3307 59124.3502   23  314 42552.9121 63113.6971  48.3%  2909 1095s
  4111  3323 58544.3231   23  258 42552.9121 63113.6971  48.3%  2939 1106s
H 4112  3173                    42721.699268 63113.6971  47.7%  2939 1106s
  4153  3184 59180.4337   24  312 42721.6993 63113.6971  47.7%  2969 1122s
  4221  3178 58404.6158   24  264 42721.6993 63113.6971  47.7%  3008 1137s
  4300  3176 55836.0245   25  252 42721.6993 63113.6971  47.7%  3057 1149s
  4361  3172 54128.3239   24  266 42721.6993 63113.6971  47.7%  3101 1164s
  4416  3165 54230.5390   26  278 42721.6993 63113.6971  47.7%  3169 1180s
  4476  3171 53791.1345   27  284 42721.6993 63113.6971  47.7%  3226 1192s
  4517  3176 53202.2050   28  282 42721.6993 63113.6971  47.7%  3300 1204s
  4553  3195 52928.1021   29  277 42721.6993 63113.6971  47.7%  3371 1218s
  4594  3208 52617.7904   31  234 42721.6993 63113.6971  47.7%  3407 1232s
  4628  3221 52531.1089   32  232 42721.6993 63113.6971  47.7%  3427 1253s
  4674  3242 51062.9981   32  247 42721.6993 63113.6971  47.7%  3465 1271s
  4725  3253 50102.1640   33  269 42721.6993 63113.6971  47.7%  3520 1285s
H 4735  3107                    42786.567547 63113.6971  47.5%  3532 1285s
  4767  3149 50814.8599   33  255 42786.5675 63113.6971  47.5%  3568 1302s
  4839  3149 47992.8646   33  128 42786.5675 62015.6211  44.9%  3593 1317s
H 4850  3011                    42848.975528 62015.6211  44.7%  3610 1317s
  4878  3034 48563.0731   33  153 42848.9755 62013.9802  44.7%  3627 1330s
  4927  3044 50750.1788   34  241 42848.9755 62013.9802  44.7%  3637 1350s
  5012  3053 49506.5556   36  199 42848.9755 62013.9802  44.7%  3655 1368s
  5099  3070 48655.0898   38  172 42848.9755 62013.9802  44.7%  3717 1388s
  5182  3094 46527.4484   40  196 42848.9755 61725.5825  44.1%  3759 1407s
  5283  3111 46084.0532   43  161 42848.9755 61725.5825  44.1%  3785 1430s
  5403  3130     cutoff   49      42848.9755 61725.5825  44.1%  3815 1451s
  5526  3150 43688.2797   59  113 42848.9755 61725.5825  44.1%  3862 1473s
  5640  3151 52520.6022   17  267 42848.9755 61725.5825  44.1%  3895 1492s
H 5676  3011                    43041.736112 61725.5825  43.4%  3902 1492s
  5713  3070 55764.1009   17  270 43041.7361 61725.5825  43.4%  3916 1515s
  5865  3062 51866.9409   19  303 43041.7361 61725.5825  43.4%  3949 1538s
  5944  3093 51084.3929   20  258 43041.7361 61725.5825  43.4%  3972 1562s
  6066  3126 52086.3159   21  241 43041.7361 61725.5825  43.4%  4021 1592s
  6210  3176 49006.3852   23  210 43041.7361 61725.5825  43.4%  4050 1621s
  6363  3187 44852.2433   29  114 43041.7361 59575.0217  38.4%  4069 1653s
  6561  3213 52312.2219   20  344 43041.7361 59575.0217  38.4%  4105 1688s
  6709  3218 44341.6322   22  273 43041.7361 59575.0217  38.4%  4139 1718s
H 6720  3092                    43076.728951 59575.0217  38.3%  4136 1718s
  6859  3121 48264.0326   22  313 43076.7290 59412.7332  37.9%  4148 1752s
  7034  3168 52229.7089   21  316 43076.7290 59157.7168  37.3%  4204 1788s
  7197  3171 46044.8662   24  257 43076.7290 59105.5385  37.2%  4268 1826s
  7416  3153     cutoff   26      43076.7290 58999.0047  37.0%  4313 1864s
  7633  3108     cutoff   27      43076.7290 58589.8820  36.0%  4350 1889s
  7697  3114 52977.6640   18  303 43076.7290 58558.6091  35.9%  4368 1914s
  7735  3153 51679.7555   19  301 43076.7290 58558.6091  35.9%  4378 1941s
  7834  3183 49838.0978   20  288 43076.7290 58558.6091  35.9%  4378 1975s
  8046  3205 49738.4443   21  284 43076.7290 58401.4845  35.6%  4402 2009s
  8294  3243 45541.5183   25  237 43076.7290 58198.2324  35.1%  4444 2050s
  8587  3282     cutoff   29      43076.7290 58044.4654  34.7%  4477 2088s
  8877  3291 50531.3970   20  270 43076.7290 58044.4654  34.7%  4528 2128s
  9136  3346 48249.6472   24  259 43076.7290 58044.4654  34.7%  4604 2168s
  9373  3404 49184.1632   25  280 43076.7290 57865.1748  34.3%  4693 2205s
  9696  3447     cutoff   28      43076.7290 57770.3482  34.1%  4759 2245s
 10127  3427     cutoff   34      43076.7290 57672.5478  33.9%  4761 2287s
 10458  3466 49684.5686   27  236 43076.7290 57096.5907  32.5%  4807 2327s
 10860  3608 44988.3798   40  175 43076.7290 56888.0348  32.1%  4845 2371s
 11309  3731     cutoff   27      43076.7290 56849.4257  32.0%  4866 2419s
 11692  3879 47777.3020   24  328 43076.7290 56552.2657  31.3%  4912 2465s
 12081  3973 infeasible   28      43076.7290 56509.2791  31.2%  4966 2513s
 12435  4131 51107.9184   19  302 43076.7290 56238.5621  30.6%  4996 2562s
 12827  4267 49094.8156   21  303 43076.7290 56238.5621  30.6%  5080 2611s
 13343  4379 44359.7402   26  273 43076.7290 55834.2085  29.6%  5107 2666s
 13897  4502 43481.1980   27  231 43076.7290 55675.6700  29.2%  5128 2722s
 14416  4672 44433.5247   25  298 43076.7290 55289.1033  28.4%  5161 2782s
 14948  4828 44435.1193   27  275 43076.7290 55084.0674  27.9%  5202 2852s
 15436  5058 44697.6692   33  249 43076.7290 54938.8928  27.5%  5232 2918s
 16032  5204 45237.7454   22  242 43076.7290 54803.5886  27.2%  5257 2982s
 16580  5397 46261.1735   28  162 43076.7290 54673.7769  26.9%  5286 3054s
 17169  5660 43763.4125   26  277 43076.7290 54270.0042  26.0%  5325 3142s
 17788  5915 43912.5662   35  237 43076.7290 54267.6536  26.0%  5362 3221s
 18485  6089 infeasible   26      43076.7290 54004.2208  25.4%  5380 3318s
 19165  6283 44530.5648   26  249 43076.7290 53799.5158  24.9%  5415 3411s
 19824  6536 50019.5688   24  262 43076.7290 53799.5158  24.9%  5461 3506s
 20618  6561 43831.1732   33  130 43076.7290 53572.6974  24.4%  5473 3583s
 20727  6580     cutoff   35      43076.7290 53572.6974  24.4%  5475 3600s

Cutting planes:
  Learned: 2
  MIR: 928
  Mixing: 3
  Flow cover: 2095
  RLT: 19
  Relax-and-lift: 169

Explored 20803 nodes (114155033 simplex iterations) in 3600.03 seconds (10652.92 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 43076.7 43041.7 42849 ... 42179.1

Time limit reached
Best objective 4.307672895064e+04, best bound 5.357269741007e+04, gap 24.3658%
  WARNING: Time limit reached. Using best solution found (gap: 24.37%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 43076.73, θ = 226454.11
  Upper Bound (UB) = 43076.73

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 226454.11
  [DEBUG]   ✓ Scenario 0: θ = 226454.11 ≤ Q = 226454.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 226454.11 ≤ Q = 226454.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 226454.11 ≤ Q = 226454.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 226454.11 ≤ Q = 226454.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 226454.11 ≤ Q = 226454.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 226454.11 ≤ Q = 226454.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 226454.11 ≤ Q = 226454.11 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 226454.11 ≤ Q = 226454.11 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4725328c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb8dacd74
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.396946e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.00s
Presolved: 508 rows, 514 columns, 1433 nonzeros
Found heuristic solution: objective 6933230.7058
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.765351e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -176535.06    0  123 6933230.71 -176535.06   103%     -    0s
H    0     0                    -139736.9952 -176535.06  26.3%     -    0s
H    0     0                    -140069.4265 -176535.06  26.0%     -    0s
H    0     0                    -146689.6364 -176535.06  20.3%     -    0s
H    0     0                    -149426.9081 -153711.22  2.87%     -    0s
     0     0 -153138.31    0   64 -149426.91 -153138.31  2.48%     -    0s
H    0     0                    -152367.0107 -153138.31  0.51%     -    0s
     0     0 -153056.36    0   58 -152367.01 -153056.36  0.45%     -    0s
     0     0 -153054.29    0   55 -152367.01 -153054.29  0.45%     -    0s
     0     0 -153051.75    0   54 -152367.01 -153051.75  0.45%     -    0s
     0     0 -153039.97    0   54 -152367.01 -153039.97  0.44%     -    0s
     0     0 -152478.03    0   19 -152367.01 -152478.03  0.07%     -    0s
     0     0 -152449.95    0    8 -152367.01 -152449.95  0.05%     -    0s
H    0     0                    -152425.2455 -152448.00  0.01%     -    0s
     0     0 -152439.72    0    6 -152425.25 -152439.72  0.01%     -    0s
     0     0 -152438.20    0    2 -152425.25 -152438.20  0.01%     -    0s
     0     0 -152438.20    0    9 -152425.25 -152438.20  0.01%     -    0s
H    0     0                    -152434.5436 -152438.20  0.00%     -    0s
H    0     0                    -152436.7330 -152438.20  0.00%     -    0s
     0     0     cutoff    0      -152436.73 -152436.73  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 3
  Flow cover: 1
  RLT: 5
  Relax-and-lift: 1

Explored 1 nodes (562 simplex iterations) in 0.13 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -152437 -152435 -152425 ... 6.93323e+06
No other solutions better than -152437

Optimal solution found (tolerance 1.00e-06)
Best objective -1.524367329995e+05, best bound -1.524367329995e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 215515.47
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -152436.73
  [DEBUG]   S×d_nominal = 367952.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 367952.20 + -152436.73 = 215515.47
  [DEBUG]   Current θ from Master = 226454.11
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10938.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32138.09
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 4669.4589, Absolute Gap = 4669.4589, Relative Gap = 0.108399
  Not converged yet (gap = 4669.46 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394652 nonzeros
Model fingerprint: 0x0fef10ad
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 61872 rows and 25122 columns
Presolve time: 1.13s
Presolved: 77121 rows, 33298 columns, 472961 nonzeros
Variable types: 31039 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 77121 rows, 33298 columns, 472961 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   38268   -2.6751696e+04   0.000000e+00   3.579824e+08      5s
   51949    2.7351453e+04   0.000000e+00   2.458957e+06     10s
   60831    4.0763616e+04   0.000000e+00   2.504309e+07     15s
Concurrent spin time: 5.52s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.308352e+04, 51194 iterations, 23.99 seconds (47.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 83083.5247    0  173 -183060.80 83083.5247   145%     -   25s
H    0     0                    -171128.6265 83083.5247   149%     -   25s
H    0     0                    -163215.9128 83083.5247   151%     -   25s
H    0     0                    -163094.6048 83083.5247   151%     -   25s
H    0     0                    -124960.3114 83083.5247   166%     -   25s
H    0     0                    -113763.8205 83083.5247   173%     -   26s
H    0     0                    -113597.3726 83083.5247   173%     -   26s
H    0     0                    -113580.9874 83083.5247   173%     -   26s
H    0     0                    -52014.55916 83083.5247   260%     -   26s
H    0     0                    7381.6436658 83083.5247  1026%     -   26s
H    0     0                    15956.283252 83083.5247   421%     -   26s
H    0     0                    23030.623783 83083.5247   261%     -   26s
H    0     0                    26660.576132 83083.5247   212%     -   26s
H    0     0                    27065.257846 83083.5247   207%     -   26s
H    0     0                    27209.319224 83083.5247   205%     -   26s
H    0     0                    27325.282746 83083.5247   204%     -   26s
H    0     0                    27431.101355 83083.5247   203%     -   26s
H    0     0                    27970.785870 74679.4172   167%     -   36s
H    0     0                    30047.127591 74679.4172   149%     -   36s
H    0     0                    30068.867755 74679.4172   148%     -   36s
H    0     0                    30984.524518 74679.4172   141%     -   36s
H    0     0                    31065.234732 74679.4172   140%     -   36s
H    0     0                    31152.574085 74679.4172   140%     -   36s
H    0     0                    31777.892493 74679.4172   135%     -   36s
H    0     0                    31778.186587 74679.4172   135%     -   36s
H    0     0                    32376.766988 74679.4172   131%     -   36s
H    0     0                    32382.341021 74679.4172   131%     -   36s
     0     0 74564.9202    0  160 32382.3410 74564.9202   130%     -   37s
H    0     0                    32555.674126 74564.9202   129%     -   37s
H    0     0                    32625.139321 74564.9202   129%     -   37s
     0     0 74070.2736    0  164 32625.1393 74070.2736   127%     -   40s
     0     0 73838.6307    0  182 32625.1393 73838.6307   126%     -   44s
     0     0 73838.6307    0  175 32625.1393 73838.6307   126%     -   47s
     0     0 73838.6307    0  167 32625.1393 73838.6307   126%     -   48s
     0     0 73838.6307    0  167 32625.1393 73838.6307   126%     -   48s
     0     0 73838.4532    0  171 32625.1393 73838.4532   126%     -   48s
H    0     0                    33418.218007 70824.5143   112%     -   58s
H    0     0                    33448.162964 70824.5143   112%     -   58s
H    0     0                    33505.916336 70824.5143   111%     -   58s
     0     0 70824.5143    0  228 33505.9163 70824.5143   111%     -   59s
H    0     0                    33584.929072 70824.2064   111%     -   59s
     0     0 69919.2953    0  271 33584.9291 69919.2953   108%     -   66s
     0     0 69719.8089    0  262 33584.9291 69719.8089   108%     -   69s
     0     0 69618.3012    0  286 33584.9291 69618.3012   107%     -   71s
     0     0 69536.2039    0  292 33584.9291 69536.2039   107%     -   74s
     0     0 69508.7503    0  288 33584.9291 69508.7503   107%     -   76s
     0     0 69506.4125    0  291 33584.9291 69506.4125   107%     -   76s
     0     0 69484.9467    0  288 33584.9291 69484.9467   107%     -   78s
     0     0 69481.0893    0  295 33584.9291 69481.0893   107%     -   78s
     0     0 69481.0363    0  295 33584.9291 69481.0363   107%     -   78s
H    0     0                    33802.511245 66538.3561  96.8%     -   92s
H    0     0                    33920.357906 66538.3561  96.2%     -   92s
H    0     0                    34050.137441 66538.3561  95.4%     -   92s
H    0     0                    34071.250757 66538.3561  95.3%     -   92s
     0     0 66538.3561    0  307 34071.2508 66538.3561  95.3%     -   92s
H    0     0                    34074.851805 66537.9465  95.3%     -   93s
H    0     0                    34190.043435 66537.9465  94.6%     -   93s
H    0     0                    34347.605953 66061.0718  92.3%     -   98s
     0     0 66061.0718    0  330 34347.6060 66061.0718  92.3%     -   98s
     0     0 65811.6133    0  333 34347.6060 65811.6133  91.6%     -  101s
H    0     0                    34381.948556 65750.6929  91.2%     -  104s
H    0     0                    34461.289272 65750.6929  90.8%     -  104s
H    0     0                    34462.738889 65750.6929  90.8%     -  104s
H    0     0                    34492.128848 65750.6929  90.6%     -  104s
     0     0 65750.6929    0  332 34492.1288 65750.6929  90.6%     -  104s
     0     0 65642.4918    0  337 34492.1288 65642.4918  90.3%     -  107s
     0     0 65625.7636    0  332 34492.1288 65625.7636  90.3%     -  108s
     0     0 65612.4330    0  341 34492.1288 65612.4330  90.2%     -  109s
H    0     0                    34549.364688 65594.6375  89.9%     -  110s
H    0     0                    34666.896551 65594.6375  89.2%     -  110s
H    0     0                    35117.617305 65594.6375  86.8%     -  110s
     0     0 65594.6375    0  337 35117.6173 65594.6375  86.8%     -  110s
     0     0 65582.8316    0  345 35117.6173 65582.8316  86.8%     -  111s
H    0     0                    35174.483091 65569.0530  86.4%     -  112s
H    0     0                    35177.134055 65569.0530  86.4%     -  112s
H    0     0                    35177.913272 65569.0530  86.4%     -  112s
     0     0 65569.0530    0  342 35177.9133 65569.0530  86.4%     -  112s
     0     0 65557.2595    0  336 35177.9133 65557.2595  86.4%     -  114s
     0     0 65552.4832    0  336 35177.9133 65552.4832  86.3%     -  114s
     0     0 65551.0305    0  345 35177.9133 65551.0305  86.3%     -  114s
H    0     0                    35303.107612 65551.0305  85.7%     -  117s
H    0     0                    35346.213999 65551.0305  85.5%     -  117s
H    0     0                    35673.406613 65551.0305  83.8%     -  117s
H    0     0                    35706.899181 65551.0305  83.6%     -  117s
H    0     0                    35736.278511 65551.0305  83.4%     -  117s
H    0     0                    35751.416784 65551.0305  83.4%     -  117s
H    0     0                    35756.972325 65551.0305  83.3%     -  117s
     0     0 65010.3738    0  343 35756.9723 65010.3738  81.8%     -  122s
H    0     0                    35804.615213 65010.3000  81.6%     -  122s
     0     0 64911.9459    0  361 35804.6152 64911.9459  81.3%     -  125s
     0     0 64836.7269    0  373 35804.6152 64836.7269  81.1%     -  127s
     0     0 64821.9692    0  381 35804.6152 64821.9692  81.0%     -  129s
     0     0 64813.9326    0  347 35804.6152 64813.9326  81.0%     -  130s
     0     0 64798.5311    0  381 35804.6152 64798.5311  81.0%     -  131s
     0     0 64791.5216    0  375 35804.6152 64791.5216  81.0%     -  131s
     0     0 64788.7050    0  373 35804.6152 64788.7050  81.0%     -  132s
     0     0 64788.4856    0  375 35804.6152 64788.4856  81.0%     -  132s
     0     0 64681.4668    0  375 35804.6152 64681.4668  80.7%     -  136s
H    0     0                    35822.249480 64680.9147  80.6%     -  137s
     0     0 64639.3174    0  383 35822.2495 64639.3174  80.4%     -  139s
     0     0 64629.9483    0  388 35822.2495 64629.9483  80.4%     -  140s
     0     0 64616.8816    0  388 35822.2495 64616.8816  80.4%     -  141s
     0     0 64613.3511    0  387 35822.2495 64613.3511  80.4%     -  142s
     0     0 64612.1393    0  385 35822.2495 64612.1393  80.4%     -  142s
H    0     0                    35878.001814 64548.8954  79.9%     -  145s
     0     0 64548.8954    0  350 35878.0018 64548.8954  79.9%     -  146s
     0     0 64540.4586    0  385 35878.0018 64540.4586  79.9%     -  147s
     0     0 64539.2505    0  391 35878.0018 64539.2505  79.9%     -  147s
     0     0 64523.9875    0  352 35878.0018 64523.9875  79.8%     -  149s
H    0     0                    35992.787554 64523.7871  79.3%     -  150s
     0     0 64519.8388    0  381 35992.7876 64519.8388  79.3%     -  151s
     0     0 64518.0114    0  430 35992.7876 64518.0114  79.3%     -  152s
     0     0 64500.8969    0  389 35992.7876 64500.8969  79.2%     -  154s
H    0     0                    36027.604458 64500.8243  79.0%     -  154s
H    0     0                    36144.771632 64500.8243  78.5%     -  155s
H    0     0                    36433.123768 64500.8243  77.0%     -  155s
     0     0 64498.9442    0  388 36433.1238 64498.9442  77.0%     -  156s
     0     0 64494.1066    0  388 36433.1238 64494.1066  77.0%     -  157s
H    0     0                    36596.984200 64493.4932  76.2%     -  158s
H    0     0                    36841.039648 64493.4932  75.1%     -  158s
     0     0 64493.0361    0  355 36841.0396 64493.0361  75.1%     -  158s
     0     0 64482.6616    0  400 36841.0396 64482.6616  75.0%     -  161s
     0     0 64482.4785    0  400 36841.0396 64482.4785  75.0%     -  162s
H    0     0                    36891.493997 64482.3724  74.8%     -  193s
H    0     2                    37174.026489 64482.3724  73.5%     -  200s
     0     2 64482.3724    0  400 37174.0265 64482.3724  73.5%     -  200s
     3     8 64329.7318    2  390 37174.0265 64426.1576  73.3%  5013  212s
     7    16 63931.0045    3  379 37174.0265 64415.5731  73.3%  6826  222s
    15    31 63817.8090    4  385 37174.0265 63957.3526  72.0%  8129  238s
    30    46 63339.5262    5  387 37174.0265 63817.7587  71.7% 13272  268s
    45    78 62453.4773    6  373 37174.0265 63817.7587  71.7% 11632  296s
    77   202 62421.0229    7  324 37174.0265 63763.9831  71.5% 10027  318s
H   87   202                    37261.995898 63763.9831  71.1%  9224  318s
H  126   202                    37322.338268 63763.9831  70.8%  7398  318s
H  138   202                    37341.039663 63763.9831  70.8%  6951  318s
H  149   202                    37379.978369 63763.9831  70.6%  6694  318s
   201   297 62027.2265   12  315 37379.9784 63763.8755  70.6%  6050  332s
   296   363 59643.9114   15  280 37379.9784 63763.8755  70.6%  4948  347s
   362   394 59394.2035   16  280 37379.9784 63763.8755  70.6%  4526  358s
   393   433 59312.2916   17  276 37379.9784 63763.8755  70.6%  4425  367s
   432   465 59136.9132   18  280 37379.9784 63763.8755  70.6%  4269  376s
   464   499 58526.6009   19  270 37379.9784 63763.8755  70.6%  4189  390s
   498   531 58436.7717   20  269 37379.9784 63763.8755  70.6%  4150  396s
   530   562 58300.0983   21  259 37379.9784 63763.8755  70.6%  4042  404s
   561   594 58253.1555   22  234 37379.9784 63763.8755  70.6%  3962  414s
   593   625 55421.7673   23  210 37379.9784 63763.8755  70.6%  3901  423s
H  603   625                    38364.639979 63763.8755  66.2%  3852  423s
   624   684 55396.6973   24  204 38364.6400 63763.8755  66.2%  3820  436s
H  634   684                    39019.128304 63763.8755  63.4%  3795  436s
   683   781 54769.7653   27  197 39019.1283 63763.8755  63.4%  3734  449s
   782   861 52942.6152   32  189 39019.1283 63763.8755  63.4%  3531  461s
   866   958 51779.7887   36  177 39019.1283 63763.8755  63.4%  3415  473s
   971  1032 51469.9775   42  159 39019.1283 63763.8755  63.4%  3240  486s
  1061  1061 51130.4166   49  134 39019.1283 63763.8755  63.4%  3147  497s
H 1092  1103                    39434.936066 63763.8755  61.7%  3142  509s
H 1110  1103                    39517.102060 63763.8755  61.4%  3127  509s
  1134  1217 50925.3754   51  155 39517.1021 63763.8755  61.4%  3117  521s
  1258  1331 49060.0586   59  117 39517.1021 63763.8755  61.4%  2991  534s
  1384  1446 46290.2566   65  106 39517.1021 63763.8755  61.4%  2885  548s
  1515  1556 44455.3029   74   87 39517.1021 63643.8599  61.1%  2806  562s
  1653  1668 43131.5670   84   74 39517.1021 63643.8599  61.1%  2729  578s
  1788  1752     cutoff   95      39517.1021 63643.8599  61.1%  2668  594s
  1924  1819 54332.0945   23  271 39517.1021 63643.8599  61.1%  2630  614s
  2027  1928 53635.8702   24  244 39517.1021 63643.8599  61.1%  2637  630s
  2150  1958 52817.6480   26  237 39517.1021 63437.2926  60.5%  2629  641s
  2184  1990 52786.6594   27  232 39517.1021 63437.2926  60.5%  2634  656s
  2220  2022 52443.5523   28  237 39517.1021 63437.2926  60.5%  2649  670s
  2258  2087 52409.4243   29  228 39517.1021 63423.7948  60.5%  2652  687s
  2327  2200 49167.1122   31  247 39517.1021 63423.7948  60.5%  2644  700s
  2450  2368 48356.5477   35  241 39517.1021 63423.7948  60.5%  2594  716s
  2663  2558 46874.3760   42  250 39517.1021 63417.5943  60.5%  2481  733s
H 2898  2634                    39522.074631 63417.5943  60.5%  2381  748s
H 2901  2631                    39715.515836 63417.5943  59.7%  2380  748s
H 2928  2630                    39944.383492 63417.5943  58.8%  2382  748s
  3038  2662 44169.2746   55  186 39944.3835 63261.2285  58.4%  2357  766s
H 3039  2662                    39997.177122 63261.2285  58.2%  2356  766s
  3078  2832 infeasible   56      39997.1771 63261.2285  58.2%  2379  785s
  3308  2928 40837.5012   75  130 39997.1771 63261.2285  58.2%  2336  807s
  3508  3069 61443.4906   11  326 39997.1771 63187.7100  58.0%  2337  831s
  3691  3070 53446.5214   12  400 39997.1771 63187.7100  58.0%  2345  888s
  3693  3071 55078.4993   32  131 39997.1771 63187.7100  58.0%  2344  927s
  3694  3072 62522.0496    7  293 39997.1771 63187.7100  58.0%  2343  949s
  3695  3073 50367.4039   53  303 39997.1771 63187.7100  58.0%  2343  962s
  3696  3073 44566.3111   43  365 39997.1771 63187.7100  58.0%  2342  971s
  3697  3074 58065.1632   36  340 39997.1771 63187.7100  58.0%  2342  978s
  3698  3075 56859.7650   39  366 39997.1771 63187.7100  58.0%  2341  983s
  3699  3075 58793.6769   22  392 39997.1771 63187.7100  58.0%  2340  987s
  3701  3077 54737.2054   49  399 39997.1771 63187.7100  58.0%  2339  992s
  3703  3078 56047.0724   20  404 39997.1771 63187.7100  58.0%  2338  995s
  3704  3079 57539.1287   36  361 39997.1771 63187.7100  58.0%  2337 1002s
  3705  3079 49471.7180   67  371 39997.1771 63187.7100  58.0%  2337 1005s
  3708  3081 56201.9756   45  362 39997.1771 63187.7100  58.0%  2335 1010s
  3709  3082 43428.6554   76  348 39997.1771 63187.7100  58.0%  2334 1016s
  3711  3083 59123.0533   28  420 39997.1771 63187.7100  58.0%  2333 1020s
  3714  3085 58442.9409   21  441 39997.1771 63187.7100  58.0%  2331 1029s
  3715  3086 60989.8880   19  425 39997.1771 63187.7100  58.0%  2330 1031s
  3717  3087 54433.2073   36  394 39997.1771 63187.7100  58.0%  2329 1038s
  3718  3088 53011.0324   31  389 39997.1771 63187.7100  58.0%  2328 1040s
  3719  3089 58999.1426   16  391 39997.1771 63187.7100  58.0%  2328 1045s
H 3721  2935                    40038.671333 63187.7100  57.8%  2326 1053s
  3722  2936 57800.1223   31  416 40038.6713 63187.7100  57.8%  2326 1055s
  3725  2938 54916.1803   50  433 40038.6713 63187.7100  57.8%  2324 1065s
  3727  2939 46291.3011   46  440 40038.6713 63187.7100  57.8%  2323 1070s
  3729  2940 60030.2962    7  433 40038.6713 63187.7100  57.8%  2321 1076s
  3730  2941 58588.1382   12  422 40038.6713 63187.7100  57.8%  2321 1081s
  3732  2942 49154.6981   36  351 40038.6713 63187.7100  57.8%  2320 1088s
  3733  2943 44566.3111   43  436 40038.6713 63187.7100  57.8%  2319 1090s
  3734  2944 41475.7717   96  439 40038.6713 63187.7100  57.8%  2318 1097s
  3736  2945 59401.5933   48  401 40038.6713 63187.7100  57.8%  2317 1104s
  3737  2946 61441.1513   14  401 40038.6713 63187.7100  57.8%  2317 1137s
  3738  2946 45389.8586  108  401 40038.6713 63187.7100  57.8%  2316 1168s
  3739  2950 63187.7100   13  391 40038.6713 63187.7100  57.8%  2379 1184s
  3741  2953 63187.7100   14  448 40038.6713 63187.7100  57.8%  2381 1201s
  3745  2960 63187.7100   15  401 40038.6713 63187.7100  57.8%  2387 1232s
  3753  2973 63085.1377   16  401 40038.6713 63187.7100  57.8%  2407 1260s
  3769  2984 61971.4518   17  391 40038.6713 63084.5629  57.6%  2486 1313s
  3785  3011 60881.7998   18  366 40038.6713 63084.5629  57.6%  2535 1353s
  3817  3116 60682.7799   19  366 40038.6713 63084.5629  57.6%  2621 1385s
  3933  3111 59116.1043   22  290 40038.6713 63084.5629  57.6%  2761 1402s
  3967  3154 56816.9853   26  282 40038.6713 63084.5629  57.6%  2776 1423s
  4021  3168 58193.7511   21  344 40038.6713 63084.5629  57.6%  2812 1439s
  4053  3186 58889.8504   23  296 40038.6713 63084.5629  57.6%  2832 1458s
  4082  3209 58020.9450   22  343 40038.6713 63084.5629  57.6%  2865 1474s
  4114  3248 57445.7143   24  289 40038.6713 63084.5629  57.6%  2919 1490s
  4166  3284 49413.3492   33  246 40038.6713 63084.5629  57.6%  2940 1508s
  4228  3309 56804.1124   25  291 40038.6713 63084.5629  57.6%  2965 1525s
  4299  3318 55178.5176   26  278 40038.6713 63084.5629  57.6%  2978 1542s
  4373  3331 53404.6579   27  275 40038.6713 63084.5629  57.6%  2999 1562s
  4454  3345 53149.7906   27  239 40038.6713 63084.5629  57.6%  3018 1586s
  4524  3349 53304.7425   26  263 40038.6713 63084.5629  57.6%  3046 1611s
  4592  3358 50015.8934   28  233 40038.6713 63084.5629  57.6%  3071 1629s
  4672  3368 52893.3324   28  287 40038.6713 63084.5629  57.6%  3083 1647s
  4752  3374 49541.1061   29  237 40038.6713 63084.5629  57.6%  3096 1664s
  4838  3400 48812.2257   30  241 40038.6713 63084.5629  57.6%  3104 1683s
  4929  3398 43180.7065   35  122 40038.6713 63084.5629  57.6%  3114 1699s
  4980  3396 42734.4393   36  105 40038.6713 63084.5629  57.6%  3116 1721s
  5039  3395 42198.4685   37  105 40038.6713 62525.0781  56.2%  3126 1746s
  5103  3399 41609.7436   38   92 40038.6713 62524.7038  56.2%  3135 1771s
  5163  3406 infeasible   39      40038.6713 62524.7038  56.2%  3147 1797s
  5234  3418 55566.2951   22  335 40038.6713 62524.7038  56.2%  3178 1823s
  5316  3443 55550.0952   22  339 40038.6713 62524.7038  56.2%  3202 1851s
  5413  3453 52695.5931   23  324 40038.6713 61757.2540  54.2%  3226 1880s
  5499  3474 50443.0788   24  333 40038.6713 61757.2540  54.2%  3260 1912s
  5596  3482 48551.2601   24  322 40038.6713 61757.2540  54.2%  3292 1942s
  5703  3476 49565.2852   25  341 40038.6713 60993.4084  52.3%  3322 1963s
  5766  3507 48914.4963   26  290 40038.6713 60993.2249  52.3%  3336 1995s
  5850  3557 46732.7094   27  262 40038.6713 60993.2249  52.3%  3364 2032s
  5971  3579 44866.3739   28  258 40038.6713 59947.2475  49.7%  3393 2071s
  6097  3596 43235.2978   30  200 40038.6713 59947.2475  49.7%  3419 2107s
  6222  3631 infeasible   32      40038.6713 59819.4834  49.4%  3464 2142s
  6354  3692 40614.1709   37  215 40038.6713 59350.2499  48.2%  3499 2178s
  6506  3759 55242.6770   18  298 40038.6713 59350.2499  48.2%  3530 2215s
  6689  3833 51150.6181   20  290 40038.6713 59350.2499  48.2%  3539 2248s
  6891  3912 48236.7110   22  212 40038.6713 59229.8175  47.9%  3553 2287s
  7156  3900 42823.1986   28   73 40038.6713 59229.8175  47.9%  3528 2319s
H 7195  3720                    40519.512505 59229.8175  46.2%  3537 2319s
H 7265  3535                    40723.486932 59229.8175  45.4%  3535 2319s
  7347  3575 53986.1078   21  247 40723.4869 59229.8175  45.4%  3519 2363s
  7542  3595 infeasible   25      40723.4869 59229.8175  45.4%  3545 2403s
  7749  3609 infeasible   31      40723.4869 59229.8175  45.4%  3567 2448s
  7945  3612 53231.9042   21  227 40723.4869 58351.5519  43.3%  3598 2493s
H 8035  3417                    40887.926228 58339.0736  42.7%  3628 2493s
  8129  3451 44882.5441   23  273 40887.9262 58339.0736  42.7%  3643 2539s
  8276  3523 41253.1337   25  216 40887.9262 58020.2921  41.9%  3700 2587s
  8449  3499 50074.3948   22  325 40887.9262 57889.4009  41.6%  3766 2623s
H 8456  3295                    41286.194892 57889.4009  40.2%  3769 2623s
H 8495  3052                    41751.703679 57889.4009  38.7%  3777 2623s
  8530  3117 49887.0129   23  324 41751.7037 57889.4009  38.7%  3786 2674s
  8752  3138 43785.4482   31  191 41751.7037 57658.6437  38.1%  3830 2740s
  9025  3085 46153.3795   29  305 41751.7037 57492.1783  37.7%  3857 2792s
  9255  3094 44514.7147   29  286 41751.7037 57385.2597  37.4%  3903 2850s
  9488  3073 52543.0410   26  257 41751.7037 57303.8156  37.2%  3952 2908s
H 9742  2883                    41767.930822 57303.8156  37.2%  3996 2956s
  9872  2861     cutoff   31      41767.9308 57108.9529  36.7%  4018 3019s
 10142  2853 49082.6567   22  303 41767.9308 57057.1817  36.6%  4071 3085s
 10406  2926     cutoff   28      41767.9308 56929.7053  36.3%  4123 3156s
 10763  3005 49532.9870   24  305 41767.9308 56646.0776  35.6%  4150 3212s
 10902  3041 45125.1434   28  247 41767.9308 56646.0776  35.6%  4173 3263s
H10911  3026                    41791.682426 56646.0776  35.5%  4171 3263s
H10912  2947                    42096.195975 56646.0776  34.6%  4172 3263s
H10977  2939                    42114.481932 56646.0776  34.5%  4181 3263s
 10982  2963 42319.0582   32  245 42114.4819 56646.0776  34.5%  4183 3317s
H10991  2917                    42250.940036 56646.0776  34.1%  4185 3317s
 11021  3043     cutoff   32      42250.9400 56646.0776  34.1%  4190 3396s
 11387  3185 46365.6118   24  267 42250.9400 56646.0776  34.1%  4215 3487s
 11763  3262 50133.5743   23  249 42250.9400 56195.4010  33.0%  4245 3583s
 12103  3276 49673.3093   24  337 42250.9400 56005.1390  32.6%  4303 3600s

Cutting planes:
  Learned: 1
  Gomory: 11
  Projected implied bound: 58
  MIR: 1610
  Mixing: 6
  Flow cover: 2869
  RLT: 22
  Relax-and-lift: 276

Explored 12146 nodes (52555044 simplex iterations) in 3600.03 seconds (9709.27 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 42250.9 42114.5 42096.2 ... 40038.7

Time limit reached
Best objective 4.225094003616e+04, best bound 5.600513896428e+04, gap 32.5536%
  WARNING: Time limit reached. Using best solution found (gap: 32.55%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 42250.94, θ = 219224.15
  Upper Bound (UB) = 42250.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 219224.15
  [DEBUG]   ✓ Scenario 0: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 219224.15 ≤ Q = 219224.15 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x167865bc
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe9879a44
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.342565e+13
Presolve removed 2587 rows and 1878 columns
Presolve time: 0.00s
Presolved: 506 rows, 511 columns, 1433 nonzeros
Found heuristic solution: objective 6621493.7595
Variable types: 347 continuous, 164 integer (164 binary)

Root relaxation: objective -1.608861e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160886.13    0  132 6621493.76 -160886.13   102%     -    0s
H    0     0                    -126772.5558 -160886.13  26.9%     -    0s
H    0     0                    -127688.3032 -160886.13  26.0%     -    0s
     0     0 -140455.52    0   97 -127688.30 -140455.52  10.0%     -    0s
H    0     0                    -137094.7300 -140379.27  2.40%     -    0s
     0     0 -140379.27    0   85 -137094.73 -140379.27  2.40%     -    0s
     0     0 -140379.27    0   84 -137094.73 -140379.27  2.40%     -    0s
     0     0 -140089.88    0   88 -137094.73 -140089.88  2.18%     -    0s
H    0     0                    -139312.6437 -140081.15  0.55%     -    0s
     0     0 -140056.79    0   95 -139312.64 -140056.79  0.53%     -    0s
     0     0 -140052.37    0   87 -139312.64 -140052.37  0.53%     -    0s
     0     0 -139974.38    0   89 -139312.64 -139974.38  0.48%     -    0s
     0     0 -139971.63    0   89 -139312.64 -139971.63  0.47%     -    0s
H    0     0                    -139357.4665 -139971.63  0.44%     -    0s
     0     2 -139971.63    0   89 -139357.47 -139971.63  0.44%     -    0s
H   40    12                    -139361.5859 -139819.29  0.33%  14.9    0s
H  508    92                    -139380.3619 -139655.26  0.20%   6.1    0s
H  814   146                    -139386.7766 -139586.99  0.14%   5.2    0s
* 1262   153              45    -139401.2175 -139584.61  0.13%   4.8    0s

Cutting planes:
  Gomory: 43
  Implied bound: 5
  MIR: 160
  Flow cover: 14
  RLT: 23
  BQP: 1

Explored 1647 nodes (8431 simplex iterations) in 0.23 seconds (0.11 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -139401 -139387 -139380 ... 6.62149e+06
No other solutions better than -139401

Optimal solution found (tolerance 1.00e-06)
Best objective -1.394012175289e+05, best bound -1.394012175289e+05, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 209903.44
  Scenario: 28 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139401.22
  [DEBUG]   S×d_nominal = 349304.66
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 349304.66 + -139401.22 = 209903.44
  [DEBUG]   Current θ from Master = 219224.15
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9320.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32930.24
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 3843.6700, Absolute Gap = 3843.6700, Relative Gap = 0.090972
  Not converged yet (gap = 3843.67 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 28 increases, 32 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437889 nonzeros
Model fingerprint: 0xf8801256
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 68740 rows and 27910 columns
Presolve time: 1.05s
Presolved: 85543 rows, 36750 columns, 521739 nonzeros
Variable types: 34491 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314147.0382
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.693e+06
 Factor NZ  : 8.006e+06 (roughly 110 MB of memory)
 Factor Ops : 1.394e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.57931502e+07  1.68359431e+08  1.25e+05 2.11e+01  7.83e+04     2s
   1  -1.19952969e+07  1.53654275e+08  8.75e+04 1.09e+02  5.45e+04     2s
   2  -4.58618217e+06  1.23013001e+08  3.38e+04 2.84e-01  2.20e+04     2s
   3  -1.87196224e+06  9.93751005e+07  8.11e+03 6.30e+00  5.67e+03     2s
   4  -7.91809744e+05  5.26882120e+07  9.01e+02 5.57e-01  8.52e+02     2s
   5  -6.92565419e+05  4.46759309e+07  3.88e+02 4.45e-01  5.01e+02     2s
   6  -6.27501540e+05  3.89831781e+07  3.37e+02 3.32e-01  4.29e+02     2s
   7  -5.71983138e+05  2.29029412e+07  1.92e+02 1.66e-01  2.38e+02     2s
   8  -4.03672715e+05  1.64427717e+07  1.00e+02 9.23e-02  1.49e+02     2s
   9  -3.73791694e+05  1.42236488e+07  8.72e+01 6.17e-02  1.26e+02     2s
  10  -1.90966478e+05  1.05207145e+07  2.34e+01 1.03e-10  7.59e+01     2s
  11  -1.39729528e+05  5.24346684e+06  1.37e+01 4.73e-11  3.70e+01     2s
  12  -1.06324422e+05  3.91694648e+06  6.36e+00 3.43e-11  2.66e+01     2s
  13  -6.16109557e+04  1.64126753e+06  2.32e+00 1.35e-11  1.10e+01     2s
  14  -2.14370931e+04  6.02423723e+05  9.11e-01 4.66e-12  4.00e+00     2s
  15  -7.90906784e+03  3.81562926e+05  7.09e-01 2.73e-12  2.49e+00     2s
  16   1.07286207e+04  3.02810701e+05  4.84e-01 2.16e-12  1.87e+00     2s
  17   2.01975030e+04  2.72699774e+05  3.91e-01 1.59e-12  1.61e+00     2s
  18   3.07577382e+04  1.86354900e+05  3.10e-01 1.23e-03  9.94e-01     2s
  19   3.58480151e+04  1.59344294e+05  2.76e-01 9.31e-04  7.89e-01     2s
  20   4.24669575e+04  1.37212018e+05  2.31e-01 2.19e-03  6.06e-01     3s
  21   5.31484876e+04  1.25155579e+05  1.62e-01 1.73e-03  4.60e-01     3s
  22   6.01866019e+04  1.12195942e+05  1.16e-01 1.54e-03  3.32e-01     3s
  23   6.46276429e+04  1.02058387e+05  8.97e-02 1.68e-03  2.39e-01     3s
  24   6.80620853e+04  9.83603729e+04  7.00e-02 1.21e-03  1.93e-01     3s
  25   7.08795032e+04  9.55742822e+04  5.44e-02 1.19e-03  1.58e-01     3s
  26   7.25578974e+04  9.13357692e+04  4.52e-02 1.47e-03  1.20e-01     3s
  27   7.38952540e+04  8.89616096e+04  3.83e-02 1.36e-03  9.62e-02     3s
  28   7.58491765e+04  8.77173271e+04  2.86e-02 9.53e-04  7.58e-02     3s
  29   7.66965317e+04  8.69371664e+04  2.44e-02 1.01e-03  6.54e-02     3s
  30   7.84599417e+04  8.55016368e+04  1.62e-02 7.58e-04  4.50e-02     3s
  31   7.88844665e+04  8.43320891e+04  1.43e-02 5.02e-04  3.48e-02     3s
  32   7.96591950e+04  8.41386496e+04  1.10e-02 4.54e-04  2.86e-02     3s
  33   8.00748516e+04  8.37830197e+04  9.17e-03 3.74e-04  2.37e-02     3s
  34   8.06294974e+04  8.35112750e+04  6.70e-03 3.06e-04  1.84e-02     3s
  35   8.09626214e+04  8.31563596e+04  5.25e-03 2.23e-04  1.40e-02     3s
  36   8.13348674e+04  8.28171794e+04  3.64e-03 1.38e-04  9.47e-03     3s
  37   8.17057137e+04  8.27007736e+04  2.07e-03 1.09e-04  6.35e-03     3s
  38   8.18619927e+04  8.25175045e+04  1.46e-03 6.61e-05  4.18e-03     3s
  39   8.19047811e+04  8.24508838e+04  1.28e-03 5.04e-05  3.49e-03     3s
  40   8.19300487e+04  8.23893267e+04  1.18e-03 3.59e-05  2.93e-03     3s
  41   8.19654449e+04  8.23780658e+04  1.04e-03 3.31e-05  2.64e-03     3s
  42   8.21308938e+04  8.23449929e+04  4.08e-04 2.49e-05  1.37e-03     3s
  43   8.21518652e+04  8.23086112e+04  3.30e-04 1.60e-05  1.00e-03     3s
  44   8.21718256e+04  8.22891125e+04  2.51e-04 1.12e-05  7.49e-04     3s
  45   8.22171525e+04  8.22689040e+04  7.93e-05 2.41e-05  3.30e-04     3s
  46   8.22265418e+04  8.22634571e+04  4.78e-05 1.96e-05  2.35e-04     3s
  47   8.22364441e+04  8.22464272e+04  1.27e-05 3.41e-06  6.36e-05     3s
  48   8.22401119e+04  8.22418112e+04  1.62e-06 1.72e-06  1.08e-05     3s
  49   8.22402438e+04  8.22417400e+04  1.28e-06 1.60e-06  9.53e-06     3s
  50   8.22404487e+04  8.22414003e+04  7.49e-07 1.06e-06  6.06e-06     3s
  51   8.22407306e+04  8.22407835e+04  1.16e-08 7.28e-08  3.37e-07     3s
  52   8.22407404e+04  8.22407411e+04  1.27e-09 8.62e-10  4.62e-09     4s

Barrier solved model in 52 iterations and 3.51 seconds (7.68 work units)
Optimal objective 8.22407404e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

    5196 PPushes remaining with PInf 4.9046602e-05                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.3013994e+03      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40220    8.2240741e+04   0.000000e+00   3.301399e+03      6s
   40263    8.2240741e+04   0.000000e+00   0.000000e+00      6s
   40263    8.2240741e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.32s

Solved with barrier

Root relaxation: objective 8.224074e+04, 40263 iterations, 4.69 seconds (12.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82240.7406    0  176 -183060.80 82240.7406   145%     -    6s
H    0     0                    -176995.7004 82240.7406   146%     -    6s
H    0     0                    -73056.56870 82240.7406   213%     -    6s
H    0     0                    -73034.58099 82240.7406   213%     -    6s
H    0     0                    -45153.00533 82240.7406   282%     -    6s
H    0     0                    -26509.34309 82240.7406   410%     -    6s
H    0     0                    -18032.10691 82240.7406   556%     -    7s
H    0     0                    -3514.057060 82240.7406  2440%     -    7s
H    0     0                    13438.795870 82240.7406   512%     -    7s
H    0     0                    16221.071568 82240.7406   407%     -    7s
H    0     0                    17674.746250 82240.7406   365%     -    7s
H    0     0                    18094.209439 82240.7406   355%     -    7s
H    0     0                    18404.828324 82240.7406   347%     -    7s
H    0     0                    21431.080340 75066.8792   250%     -   39s
H    0     0                    25435.970273 75066.8792   195%     -   39s
H    0     0                    27499.908932 75066.8792   173%     -   39s
H    0     0                    28046.100064 75066.8792   168%     -   39s
     0     0 75023.9858    0  305 28046.1001 75023.9858   168%     -   39s
H    0     0                    28243.018867 75023.9858   166%     -   40s
     0     0 74204.0105    0  309 28243.0189 74204.0105   163%     -   53s
     0     0 73965.7845    0  321 28243.0189 73965.7845   162%     -   63s
     0     0 73960.4429    0  320 28243.0189 73960.4429   162%     -   66s
     0     0 73960.4429    0  318 28243.0189 73960.4429   162%     -   68s
     0     0 73960.4429    0  306 28243.0189 73960.4429   162%     -   70s
     0     0 73955.0078    0  325 28243.0189 73955.0078   162%     -   71s
     0     0 73954.4989    0  323 28243.0189 73954.4989   162%     -   71s
H    0     0                    29080.140297 70332.1772   142%     -  103s
H    0     0                    29368.603638 70332.1772   139%     -  103s
H    0     0                    29487.520942 70332.1772   139%     -  103s
H    0     0                    29534.105700 70332.1772   138%     -  103s
H    0     0                    29538.184084 70332.1772   138%     -  103s
H    0     0                    29589.221485 70332.1772   138%     -  103s
     0     0 70332.1772    0  235 29589.2215 70332.1772   138%     -  103s
H    0     0                    31899.091178 70332.1083   120%     -  104s
H    0     0                    32307.194494 70332.1083   118%     -  104s
H    0     0                    32419.304401 70332.1083   117%     -  104s
H    0     0                    33317.970350 70332.1083   111%     -  104s
H    0     0                    33410.351033 70332.1083   111%     -  104s
H    0     0                    33486.957810 70332.1083   110%     -  104s
     0     0 69644.7122    0  309 33486.9578 69644.7122   108%     -  123s
     0     0 69346.7056    0  280 33486.9578 69346.7056   107%     -  132s
     0     0 69080.0257    0  285 33486.9578 69080.0257   106%     -  141s
     0     0 69034.9746    0  292 33486.9578 69034.9746   106%     -  145s
     0     0 68999.9250    0  316 33486.9578 68999.9250   106%     -  150s
H    0     0                    33739.576915 68978.7205   104%     -  153s
H    0     0                    34167.155653 68978.7205   102%     -  153s
     0     0 68978.7205    0  284 34167.1557 68978.7205   102%     -  153s
     0     0 68959.7692    0  287 34167.1557 68959.7692   102%     -  155s
     0     0 68866.6373    0  287 34167.1557 68866.6373   102%     -  161s
     0     0 68839.7313    0  291 34167.1557 68839.7313   101%     -  164s
     0     0 68823.0782    0  283 34167.1557 68823.0782   101%     -  167s
     0     0 68822.3220    0  291 34167.1557 68822.3220   101%     -  168s
     0     0 66475.9269    0  323 34167.1557 66475.9269  94.6%     -  196s
H    0     0                    34286.284958 66039.0491  92.6%     -  209s
     0     0 66039.0491    0  327 34286.2850 66039.0491  92.6%     -  209s
H    0     0                    34513.214647 65852.2706  90.8%     -  217s
H    0     0                    35275.182881 65852.2706  86.7%     -  217s
H    0     0                    35480.905220 65852.2706  85.6%     -  217s
H    0     0                    35529.854790 65852.2706  85.3%     -  217s
H    0     0                    35542.681892 65852.2706  85.3%     -  217s
H    0     0                    35631.396086 65852.2706  84.8%     -  217s
H    0     0                    35810.356741 65852.2706  83.9%     -  217s
H    0     0                    35813.078342 65852.2706  83.9%     -  217s
     0     0 65852.2706    0  329 35813.0783 65852.2706  83.9%     -  217s
     0     0 65749.4334    0  332 35813.0783 65749.4334  83.6%     -  222s
     0     0 65684.2720    0  328 35813.0783 65684.2720  83.4%     -  226s
     0     0 65657.3986    0  335 35813.0783 65657.3986  83.3%     -  230s
     0     0 65651.6967    0  367 35813.0783 65651.6967  83.3%     -  232s
     0     0 65634.2408    0  348 35813.0783 65634.2408  83.3%     -  235s
     0     0 65630.6359    0  376 35813.0783 65630.6359  83.3%     -  236s
     0     0 65629.7496    0  348 35813.0783 65629.7496  83.3%     -  237s
     0     0 65157.2585    0  397 35813.0783 65157.2585  81.9%     -  253s
H    0     0                    35865.511506 65156.9094  81.7%     -  255s
H    0     0                    35907.330140 65156.9094  81.5%     -  255s
H    0     0                    35974.105122 64949.6408  80.5%     -  262s
     0     0 64949.6408    0  431 35974.1051 64949.6408  80.5%     -  262s
     0     0 64820.8339    0  401 35974.1051 64820.8339  80.2%     -  269s
H    0     0                    35996.265722 64778.5722  80.0%     -  274s
H    0     0                    36055.696298 64778.5722  79.7%     -  274s
     0     0 64778.5722    0  410 36055.6963 64778.5722  79.7%     -  274s
     0     0 64758.6311    0  416 36055.6963 64758.6311  79.6%     -  277s
     0     0 64753.7806    0  424 36055.6963 64753.7806  79.6%     -  279s
     0     0 64749.9088    0  414 36055.6963 64749.9088  79.6%     -  280s
     0     0 64749.0905    0  420 36055.6963 64749.0905  79.6%     -  281s
     0     0 64642.2634    0  363 36055.6963 64642.2634  79.3%     -  287s
H    0     0                    36075.934011 64642.1447  79.2%     -  288s
     0     0 64627.3521    0  403 36075.9340 64627.3521  79.1%     -  290s
     0     0 64619.6199    0  455 36075.9340 64619.6199  79.1%     -  293s
     0     0 64616.3212    0  406 36075.9340 64616.3212  79.1%     -  294s
     0     0 64615.6469    0  376 36075.9340 64615.6469  79.1%     -  294s
     0     0 64577.1477    0  391 36075.9340 64577.1477  79.0%     -  299s
H    0     0                    36158.447986 64576.6981  78.6%     -  300s
H    0     0                    36510.297780 64576.6981  76.9%     -  300s
     0     0 64568.0390    0  425 36510.2978 64568.0390  76.8%     -  302s
     0     0 64563.6995    0  395 36510.2978 64563.6995  76.8%     -  304s
     0     0 64562.4058    0  450 36510.2978 64562.4058  76.8%     -  305s
     0     0 64554.4641    0  362 36510.2978 64554.4641  76.8%     -  307s
     0     0 64553.0678    0  373 36510.2978 64553.0678  76.8%     -  309s
     0     0 64546.8463    0  367 36510.2978 64546.8463  76.8%     -  311s
H    0     0                    36582.586616 64546.5599  76.4%     -  312s
     0     0 64543.3085    0  365 36582.5866 64543.3085  76.4%     -  314s
     0     0 64542.0177    0  370 36582.5866 64542.0177  76.4%     -  315s
     0     0 64534.1274    0  363 36582.5866 64534.1274  76.4%     -  316s
H    0     0                    36710.494096 64532.9254  75.8%     -  317s
H    0     0                    36777.499173 64532.9254  75.5%     -  317s
     0     0 64532.5196    0  369 36777.4992 64532.5196  75.5%     -  318s
     0     0 64531.9927    0  364 36777.4992 64531.9927  75.5%     -  319s
     0     0 64531.1477    0  364 36777.4992 64531.1477  75.5%     -  320s
H    0     0                    36892.773699 64531.1477  74.9%     -  394s
H    0     0                    37718.144562 64531.1477  71.1%     -  395s
H    0     0                    37792.269021 64531.1477  70.8%     -  396s
H    0     0                    37919.102154 64531.1477  70.2%     -  397s
H    0     0                    37950.709456 64531.1477  70.0%     -  397s
H    0     2                    38594.761713 64531.1477  67.2%     -  418s
     0     2 64531.1477    0  364 38594.7617 64531.1477  67.2%     -  418s
     1     4 64205.6843    1  364 38594.7617 64527.8438  67.2%  9312  431s
     3     8 63929.2784    2  345 38594.7617 64205.6718  66.4% 10630  445s
     7    16 63775.3567    3  390 38594.7617 63927.9181  65.6% 10211  460s
    15    32 63591.9649    4  446 38594.7617 63775.2707  65.2% 10353  484s
    31    48 63425.3467    5  359 38594.7617 63591.9615  64.8% 14604  543s
H   47    79                    38675.088619 63591.9615  64.4% 14011  580s
H   51    79                    38809.910848 63591.9615  63.9% 14193  580s
H   62    79                    38910.910072 63591.9615  63.4% 14425  580s
H   68    79                    39132.613183 63591.9615  62.5% 13601  580s
H   72    79                    39244.160299 63591.9615  62.0% 13081  580s
    78   178 61927.3679    7  319 39244.1603 63591.9615  62.0% 12530  620s
   177   272 61226.8899   10  303 39244.1603 63591.9615  62.0%  8973  648s
   271   334 60879.7806   11  305 39244.1603 63591.9615  62.0%  7185  671s
   333   363 60972.4863   11  290 39244.1603 63591.9615  62.0%  6605  689s
   362   404 60858.0040   11  286 39244.1603 63591.9615  62.0%  6474  709s
   403   430 60946.8712   12  291 39244.1603 63591.9615  62.0%  6181  729s
   429   461 60617.7011   12  297 39244.1603 63591.9615  62.0%  6106  744s
   460   492 58570.1629   12  285 39244.1603 63591.9615  62.0%  6001  759s
H  474   492                    39473.891332 63591.9615  61.1%  5939  759s
   491   556 60797.4305   12  372 39473.8913 63591.9615  61.1%  5853  780s
   555   623 60407.9173   12  299 39473.8913 63591.9615  61.1%  5610  800s
   622   702 60614.5305   13  280 39473.8913 63591.9615  61.1%  5349  820s
   703   728 60009.6207   14  260 39473.8913 63591.9615  61.1%  5069  839s
H  709   728                    39740.717653 63591.9615  60.0%  5063  839s
   729   797 58473.0236   15  261 39740.7177 63591.9615  60.0%  5033  857s
   802   890 59111.4873   22  263 39740.7177 63591.9615  60.0%  4824  877s
   899   991 58173.3102   15  236 39740.7177 63591.9615  60.0%  4561  895s
  1000  1022 54506.9589   24  260 39740.7177 63591.9615  60.0%  4339  925s
  1033  1125 54290.7398   25  254 39740.7177 63591.9615  60.0%  4302  942s
  1136  1187 52063.4093   27  251 39740.7177 63591.9615  60.0%  4151  955s
H 1137  1187                    39826.442101 63591.9615  59.7%  4147  955s
  1212  1215 54093.4228   16  272 39826.4421 63591.9615  59.7%  4016  971s
H 1221  1215                    39849.901058 63591.9615  59.6%  4011  971s
  1244  1280 53803.0995   17  246 39849.9011 63591.9615  59.6%  4002  992s
  1363  1358 52415.3011   18  234 39849.9011 63591.9615  59.6%  3842 1012s
  1499  1432 51619.1304   19  225 39849.9011 63591.9615  59.6%  3695 1036s
  1651  1533 51165.4564   20  240 39849.9011 63591.9615  59.6%  3566 1056s
  1816  1639 51262.6408   20  228 39849.9011 63591.9615  59.6%  3405 1083s
  2008  1796 46144.9522   21  206 39849.9011 63591.9615  59.6%  3208 1105s
  2225  1815 49822.0422   21  233 39849.9011 63591.9615  59.6%  3025 1128s
  2264  1828 50094.6704   22  205 39849.9011 63591.9615  59.6%  3042 1151s
H 2270  1828                    39885.483806 63506.4755  59.2%  3040 1151s
  2313  1942 48935.7272   22  212 39885.4838 63506.4755  59.2%  3071 1179s
  2483  1999 48374.2043   23  191 39885.4838 63506.4755  59.2%  3005 1205s
  2638  2086 48137.7914   24  165 39885.4838 63235.5727  58.5%  2946 1233s
  2801  2151 45230.2165   24  180 39885.4838 63235.5727  58.5%  2920 1261s
  2926  2239 46320.0428   28  195 39885.4838 63235.5727  58.5%  2947 1292s
  3068  2344 44152.6457   29  120 39885.4838 63042.5982  58.1%  2958 1324s
  3219  2446 42188.8727   40   53 39885.4838 63042.5982  58.1%  2964 1356s
  3387  2473 infeasible   48      39885.4838 63042.5982  58.1%  2956 1383s
  3420  2524 44030.0551   73   60 39885.4838 62305.2836  56.2%  2983 1409s
  3499  2595 56406.2149    8  269 39885.4838 62305.2836  56.2%  2981 1440s
  3610  2758 53754.5193   11  274 39885.4838 62197.8912  55.9%  2966 1474s
  3832  2759 41476.1807   65  364 39885.4838 62197.8912  55.9%  2915 1615s
  3834  2760 47275.8664   64  176 39885.4838 62197.8912  55.9%  2914 1622s
  3835  2761 49623.1623   42  304 39885.4838 62197.8912  55.9%  2913 1666s
  3836  2762 45914.0956   48  364 39885.4838 62197.8912  55.9%  2912 1706s
  3837  2762 58484.9415   12  301 39885.4838 62197.8912  55.9%  2911 1727s
  3838  2763 51122.5184   22  372 39885.4838 62197.8912  55.9%  2911 1743s
  3839  2764 41631.7020   80  342 39885.4838 62197.8912  55.9%  2910 1753s
  3840  2764 47077.6820   52  385 39885.4838 62197.8912  55.9%  2909 1760s
  3842  2766 55616.4933   12  349 39885.4838 62197.8912  55.9%  2908 1768s
  3843  2766 57017.4924   16  358 39885.4838 62197.8912  55.9%  2907 1773s
  3844  2767 58356.5558   10  354 39885.4838 62197.8912  55.9%  2906 1778s
  3845  2768 42755.7829   53  345 39885.4838 62197.8912  55.9%  2905 1783s
  3846  2768 43623.3042   50  397 39885.4838 62197.8912  55.9%  2904 1787s
  3847  2769 54534.9714   23  419 39885.4838 62197.8912  55.9%  2904 1792s
  3848  2770 58070.0836   10  378 39885.4838 62197.8912  55.9%  2903 1802s
  3849  2770 54567.5458   15  388 39885.4838 62197.8912  55.9%  2902 1807s
  3850  2771 50166.2695   40  382 39885.4838 62197.8912  55.9%  2901 1810s
  3851  2772 43007.5615   33  392 39885.4838 62197.8912  55.9%  2901 1815s
  3852  2772 47655.2080   20  451 39885.4838 62197.8912  55.9%  2900 1828s
  3853  2773 47493.1833   60  396 39885.4838 62197.8912  55.9%  2899 1830s
  3854  2774 47614.7232   41  417 39885.4838 62197.8912  55.9%  2898 1835s
  3855  2774 44351.6829   36  392 39885.4838 62197.8912  55.9%  2898 1845s
  3856  2775 42442.3749   57  391 39885.4838 62197.8912  55.9%  2897 1850s
  3857  2776 48548.7763   38  391 39885.4838 62197.8912  55.9%  2896 1857s
  3859  2777 46153.0847   52  436 39885.4838 62197.8912  55.9%  2895 1867s
  3860  2778 60936.1759    7  390 39885.4838 62197.8912  55.9%  2894 1872s
  3861  2778 42659.6370   68  399 39885.4838 62197.8912  55.9%  2893 1876s
  3862  2779 43600.9935   27  415 39885.4838 62197.8912  55.9%  2892 1883s
  3863  2780 48132.3606   42  454 39885.4838 62197.8912  55.9%  2892 1888s
  3864  2780 56927.0928    9  424 39885.4838 62197.8912  55.9%  2891 1892s
  3865  2781 44606.2015   42  428 39885.4838 62197.8912  55.9%  2890 1899s
  3866  2782 41546.8759   45  440 39885.4838 62197.8912  55.9%  2889 1904s
  3867  2782 58389.0109    9  434 39885.4838 62197.8912  55.9%  2889 1917s
H 3867  2642                    39909.418276 62197.8912  55.8%  2889 1921s
  3869  2644 58471.0461   14  486 39909.4183 62197.8912  55.8%  2887 1933s
  3870  2644 53685.7041   26  486 39909.4183 62197.8912  55.8%  2886 1945s
  3871  2645 48053.7436   53  486 39909.4183 62197.8912  55.8%  2886 2004s
  3872  2649 62197.8912   10  468 39909.4183 62197.8912  55.8%  2969 2072s
  3874  2652 62197.8912   11  418 39909.4183 62197.8912  55.8%  2972 2125s
  3878  2657 62197.8912   12  434 39909.4183 62197.8912  55.8%  2982 2167s
  3884  2669 62197.8912   13  439 39909.4183 62197.8912  55.8%  3008 2216s
  3898  2678 61210.5966   14  429 39909.4183 62197.8912  55.8%  3086 2325s
  3912  2705 59768.1643   15  427 39909.4183 62197.8912  55.8%  3163 2414s
H 3944  2621                    40012.416805 62197.8912  55.4%  3316 2465s
H 3953  2492                    40029.399227 62197.8912  55.4%  3336 2465s
H 3965  2368                    40104.036531 62197.8912  55.1%  3352 2465s
  4003  2467 57780.9110   18  322 40104.0365 62197.8912  55.1%  3447 2517s
  4115  2502 57164.2827   20  319 40104.0365 62197.8912  55.1%  3564 2551s
  4187  2510 53534.7460   24  366 40104.0365 62197.8912  55.1%  3631 2575s
  4219  2538 53465.1209   25  363 40104.0365 62197.8912  55.1%  3671 2600s
  4258  2568 51995.3446   27  299 40104.0365 62197.8912  55.1%  3705 2624s
  4301  2611 48134.5036   29  225 40104.0365 62197.8912  55.1%  3758 2646s
  4361  2658 47078.6829   32  161 40104.0365 62197.8912  55.1%  3799 2667s
  4433  2693 46561.6570   37  144 40104.0365 62197.8912  55.1%  3825 2690s
  4515  2715 45848.3091   42  120 40104.0365 62197.8912  55.1%  3850 2715s
  4592  2738 42610.2916   46  171 40104.0365 62197.8912  55.1%  3890 2736s
  4676  2761     cutoff   48      40104.0365 62197.8912  55.1%  3933 2759s
  4763  2778 41296.9962   50  117 40104.0365 61736.2823  53.9%  3937 2781s
  4851  2779     cutoff   56      40104.0365 61736.2823  53.9%  3956 2816s
  4942  2783 57372.3424   18  348 40104.0365 61736.2823  53.9%  3993 2848s
  5021  2822 55088.0563   19  382 40104.0365 61736.2823  53.9%  4060 2872s
  5107  2833 54680.5517   20  329 40104.0365 61736.2823  53.9%  4130 2902s
  5217  2857 53317.0402   23  302 40104.0365 61652.4872  53.7%  4181 2930s
  5323  2873 51214.1435   25  302 40104.0365 61652.4872  53.7%  4214 2957s
  5437  2892 47371.6017   26  295 40104.0365 61652.4872  53.7%  4251 2986s
  5529  2922 46567.8555   28  254 40104.0365 61652.4872  53.7%  4304 3015s
  5636  2950 46173.8944   30  282 40104.0365 61652.4872  53.7%  4343 3044s
  5738  2990 43915.1469   34  286 40104.0365 61652.4872  53.7%  4371 3078s
  5861  3017 49595.2757   28  310 40104.0365 61652.4872  53.7%  4396 3118s
  5997  3041 47289.4407   30  278 40104.0365 61652.4872  53.7%  4439 3154s
  6128  3080 45569.2701   34  231 40104.0365 61652.4872  53.7%  4478 3189s
  6272  3115 44087.3050   41  209 40104.0365 61652.4872  53.7%  4521 3230s
  6418  3149 40361.7178   51  159 40104.0365 61652.4872  53.7%  4563 3266s
  6556  3180     cutoff   45      40104.0365 61652.4872  53.7%  4622 3314s
  6730  3211     cutoff   50      40104.0365 60962.2713  52.0%  4642 3355s
  6862  3275 55402.0782   17  352 40104.0365 60962.2713  52.0%  4699 3393s
  7041  3292 52791.1478   19  318 40104.0365 60094.3735  49.8%  4742 3439s
  7211  3329 51040.9397   23  249 40104.0365 60094.3735  49.8%  4799 3484s
  7335  3397 48250.9673   26  194 40104.0365 59827.3999  49.2%  4891 3530s
  7506  3467 45398.2666   35  152 40104.0365 59827.3999  49.2%  4928 3578s
  7705  3455 41248.4905   39  190 40104.0365 59827.3999  49.2%  4960 3600s
H 7715  3222                    41165.392945 59827.3999  45.3%  4958 3600s

Cutting planes:
  Learned: 5
  Gomory: 32
  Implied bound: 61
  Projected implied bound: 387
  MIR: 1816
  Mixing: 9
  Flow cover: 2794
  RLT: 46
  Relax-and-lift: 406

Explored 7814 nodes (39103569 simplex iterations) in 3600.05 seconds (9548.35 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 41165.4 40104 40029.4 ... 39473.9

Time limit reached
Best objective 4.116539294460e+04, best bound 5.982739992303e+04, gap 45.3342%
  WARNING: Time limit reached. Using best solution found (gap: 45.33%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 41165.39, θ = 217726.70
  Upper Bound (UB) = 41165.39

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 217726.70
  [DEBUG]   ✓ Scenario 0: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 217726.70 ≤ Q = 217726.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x40eac04a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x40eac04a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.342565e+13
Presolve removed 2587 rows and 1878 columns
Presolve time: 0.00s
Presolved: 506 rows, 511 columns, 1433 nonzeros
Found heuristic solution: objective 6573034.3024
Variable types: 347 continuous, 164 integer (164 binary)

Root relaxation: objective -1.630052e+05, 263 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163005.21    0  127 6573034.30 -163005.21   102%     -    0s
H    0     0                    -127206.0186 -163005.21  28.1%     -    0s
H    0     0                    -127492.8812 -163005.21  27.9%     -    0s
H    0     0                    -131575.0264 -144664.33  9.95%     -    0s
H    0     0                    -137133.9458 -144664.33  5.49%     -    0s
     0     0 -144664.33    0   73 -137133.95 -144664.33  5.49%     -    0s
H    0     0                    -142602.6289 -144638.75  1.43%     -    0s
     0     0 -144539.11    0   73 -142602.63 -144539.11  1.36%     -    0s
     0     0 -144051.77    0   91 -142602.63 -144051.77  1.02%     -    0s
H    0     0                    -143590.1246 -144048.77  0.32%     -    0s
H    0     0                    -143592.1061 -144021.13  0.30%     -    0s
     0     0 -144018.94    0   82 -143592.11 -144018.94  0.30%     -    0s
     0     0 -144002.59    0   77 -143592.11 -144002.59  0.29%     -    0s
     0     0 -144002.52    0   77 -143592.11 -144002.52  0.29%     -    0s
     0     0 -143823.97    0   41 -143592.11 -143823.97  0.16%     -    0s
     0     0 -143819.43    0   34 -143592.11 -143819.43  0.16%     -    0s
     0     0 -143814.21    0   31 -143592.11 -143814.21  0.15%     -    0s
H    0     0                    -143605.6061 -143814.21  0.15%     -    0s
     0     0 -143764.41    0   16 -143605.61 -143764.41  0.11%     -    0s
     0     0 -143764.41    0   36 -143605.61 -143764.41  0.11%     -    0s
     0     0 -143690.12    0   11 -143605.61 -143690.12  0.06%     -    0s
H    0     0                    -143667.0421 -143685.60  0.01%     -    0s
     0     0 -143684.70    0   10 -143667.04 -143684.70  0.01%     -    0s
     0     0 -143676.71    0    2 -143667.04 -143676.71  0.01%     -    0s
     0     0 -143676.71    0    8 -143667.04 -143676.71  0.01%     -    0s
H    0     0                    -143669.1352 -143676.71  0.01%     -    0s
H    0     0                    -143669.8345 -143676.71  0.00%     -    0s
     0     0 -143670.71    0    4 -143669.83 -143670.71  0.00%     -    0s
     0     0 -143670.27    0    2 -143669.83 -143670.27  0.00%     -    0s
     0     0 -143670.11    0    2 -143669.83 -143670.11  0.00%     -    0s
     0     0     cutoff    0      -143669.83 -143669.83  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 2
  Flow cover: 3

Explored 1 nodes (942 simplex iterations) in 0.19 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -143670 -143669 -143667 ... -137134
No other solutions better than -143670

Optimal solution found (tolerance 1.00e-06)
Best objective -1.436698344863e+05, best bound -1.436698344863e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 206687.04
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -143669.83
  [DEBUG]   S×d_nominal = 350356.88
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 350356.88 + -143669.83 = 206687.04
  [DEBUG]   Current θ from Master = 217726.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11039.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30125.74
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 2758.1229, Absolute Gap = 2758.1229, Relative Gap = 0.067001
  Not converged yet (gap = 2758.12 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481126 nonzeros
Model fingerprint: 0xe79a59d6
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 75628 rows and 30708 columns
Presolve time: 1.14s
Presolved: 93945 rows, 40192 columns, 569557 nonzeros
Variable types: 37933 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -325702.3089
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.229e+06
 Factor NZ  : 9.287e+06 (roughly 130 MB of memory)
 Factor Ops : 1.720e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.63563643e+07  1.83268799e+08  1.29e+05 2.02e+01  8.07e+04     2s
   1  -1.24456869e+07  1.68555304e+08  9.08e+04 1.09e+02  5.62e+04     2s
   2  -3.76833286e+06  1.34689387e+08  2.79e+04 1.37e+00  1.83e+04     2s
   3  -3.17283092e+06  1.34214791e+08  2.11e+04 1.67e+01  1.40e+04     2s
   4  -1.13300497e+06  8.72075373e+07  4.57e+03 2.59e-11  3.28e+03     2s
   5  -5.76796559e+05  6.69825711e+07  7.59e+02 3.25e-01  8.30e+02     2s
   6  -4.57351924e+05  3.33505853e+07  3.41e+02 2.39e-11  3.67e+02     2s
   7  -3.32557384e+05  2.74044833e+07  1.12e+02 1.27e-11  2.14e+02     2s
   8  -2.32454887e+05  1.75596417e+07  3.55e+01 1.32e-11  1.17e+02     2s
   9  -1.90032704e+05  1.47805489e+07  2.36e+01 1.04e-11  9.53e+01     2s
  10  -1.53299418e+05  8.60003792e+06  1.68e+01 7.68e-12  5.49e+01     2s
  11  -9.65761523e+04  3.51247159e+06  9.07e+00 4.70e-12  2.21e+01     3s
  12  -3.28490190e+04  1.73226136e+06  1.91e+00 1.83e-02  1.04e+01     3s
  13  -1.37229782e+04  5.54227024e+05  1.19e+00 1.54e-12  3.33e+00     3s
  14   3.08326920e+03  3.72100137e+05  8.28e-01 1.27e-12  2.16e+00     3s
  15   1.44180587e+04  2.63242613e+05  6.07e-01 7.71e-13  1.45e+00     3s
  16   2.30172556e+04  2.13046139e+05  4.84e-01 6.38e-13  1.11e+00     3s
  17   3.26724335e+04  1.84184832e+05  3.79e-01 6.24e-13  8.83e-01     3s
  18   3.98589039e+04  1.43866522e+05  3.16e-01 4.41e-13  6.07e-01     3s
  19   4.75733876e+04  1.31548625e+05  2.52e-01 2.21e-04  4.90e-01     3s
  20   5.39830630e+04  1.23041203e+05  1.98e-01 6.37e-04  4.02e-01     3s
  21   5.67077853e+04  1.08242509e+05  1.78e-01 6.56e-04  3.00e-01     3s
  22   6.29336915e+04  1.00368400e+05  1.30e-01 5.06e-03  2.18e-01     3s
  23   6.93551038e+04  9.52051422e+04  8.18e-02 2.84e-03  1.51e-01     3s
  24   7.09654172e+04  9.20716315e+04  6.94e-02 2.35e-03  1.23e-01     3s
  25   7.32353433e+04  8.87708937e+04  5.43e-02 2.10e-03  9.05e-02     3s
  26   7.44575121e+04  8.75680978e+04  4.58e-02 1.75e-03  7.64e-02     3s
  27   7.53838037e+04  8.61357517e+04  3.93e-02 1.48e-03  6.27e-02     3s
  28   7.63249722e+04  8.54536859e+04  3.33e-02 1.48e-03  5.32e-02     3s
  29   7.72511186e+04  8.45081307e+04  2.75e-02 1.38e-03  4.23e-02     3s
  30   7.82049316e+04  8.40779876e+04  2.18e-02 1.16e-03  3.42e-02     3s
  31   7.93401523e+04  8.37245352e+04  1.51e-02 9.81e-04  2.55e-02     3s
  32   7.97767879e+04  8.34122742e+04  1.24e-02 8.04e-04  2.12e-02     3s
  33   8.01056206e+04  8.31105999e+04  1.04e-02 6.46e-04  1.75e-02     3s
  34   8.05434174e+04  8.27824706e+04  7.83e-03 4.58e-04  1.30e-02     3s
  35   8.08124530e+04  8.26761927e+04  6.26e-03 4.00e-04  1.09e-02     3s
  36   8.10089078e+04  8.24983391e+04  5.14e-03 2.98e-04  8.68e-03     3s
  37   8.12749509e+04  8.24341806e+04  3.69e-03 2.62e-04  6.75e-03     3s
  38   8.14534043e+04  8.22746364e+04  2.67e-03 1.73e-04  4.78e-03     3s
  39   8.16082857e+04  8.21760838e+04  1.84e-03 1.19e-04  3.31e-03     3s
  40   8.18379989e+04  8.21157170e+04  5.55e-04 8.55e-05  1.62e-03     3s
  41   8.18998262e+04  8.20132911e+04  2.46e-04 3.03e-05  6.60e-04     3s
  42   8.19111157e+04  8.19870600e+04  1.94e-04 1.66e-05  4.42e-04     3s
  43   8.19337626e+04  8.19807446e+04  8.81e-05 1.33e-05  2.73e-04     4s
  44   8.19498576e+04  8.19641748e+04  1.34e-05 6.09e-06  8.32e-05     4s
  45   8.19537001e+04  8.19564644e+04  2.63e-06 9.61e-07  1.61e-05     4s
  46   8.19548007e+04  8.19548827e+04  9.89e-08 7.47e-08  4.76e-07     4s
  47   8.19548620e+04  8.19548620e+04  2.25e-09 9.98e-09  8.41e-11     4s

Barrier solved model in 47 iterations and 3.64 seconds (7.89 work units)
Optimal objective 8.19548620e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 5s

    1435 PPushes remaining with PInf 8.1702197e-06                 5s
       0 PPushes remaining with PInf 0.0000000e+00                 5s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3066320e-10      5s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32402    8.1954862e+04   0.000000e+00   0.000000e+00      5s
   32402    8.1954862e+04   0.000000e+00   0.000000e+00      5s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 8.195486e+04, 32402 iterations, 3.58 seconds (9.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81954.8620    0  197 -183060.80 81954.8620   145%     -    5s
H    0     0                    -179692.3469 81954.8620   146%     -    5s
H    0     0                    -122540.2169 81954.8620   167%     -    5s
H    0     0                    -120190.7712 81954.8620   168%     -    5s
H    0     0                    -119238.0181 81954.8620   169%     -    6s
H    0     0                    -77886.48807 81954.8620   205%     -    6s
H    0     0                    20312.313061 81954.8620   303%     -    6s
H    0     0                    24437.314407 81954.8620   235%     -    6s
H    0     0                    25880.760461 81954.8620   217%     -    6s
H    0     0                    26171.404731 81954.8620   213%     -    6s
H    0     0                    26310.774169 81954.8620   211%     -    6s
H    0     0                    28082.619586 75527.4937   169%     -   35s
H    0     0                    28238.307389 75527.4937   167%     -   35s
H    0     0                    30115.206098 75527.4937   151%     -   35s
H    0     0                    30361.782327 75527.4937   149%     -   35s
     0     0 75527.4937    0  285 30361.7823 75527.4937   149%     -   35s
     0     0 74601.9700    0  322 30361.7823 74601.9700   146%     -   54s
     0     0 74532.3226    0  314 30361.7823 74532.3226   145%     -   62s
     0     0 74532.3226    0  314 30361.7823 74532.3226   145%     -   64s
     0     0 74532.3226    0  317 30361.7823 74532.3226   145%     -   70s
     0     0 74532.3226    0  322 30361.7823 74532.3226   145%     -   71s
     0     0 74532.3226    0  320 30361.7823 74532.3226   145%     -   73s
     0     0 74532.3226    0  320 30361.7823 74532.3226   145%     -   73s
H    0     0                    30518.219764 70570.1168   131%     -  118s
H    0     0                    30560.291818 70570.1168   131%     -  118s
     0     0 70570.1168    0  371 30560.2918 70570.1168   131%     -  118s
H    0     0                    32075.449741 70570.0615   120%     -  118s
H    0     0                    32481.908843 70570.0615   117%     -  118s
     0     0 69845.7273    0  398 32481.9088 69845.7273   115%     -  141s
     0     0 69567.5107    0  402 32481.9088 69567.5107   114%     -  155s
     0     0 69527.4029    0  405 32481.9088 69527.4029   114%     -  162s
     0     0 69488.8162    0  398 32481.9088 69488.8162   114%     -  167s
     0     0 69445.6514    0  396 32481.9088 69445.6514   114%     -  175s
H    0     0                    35927.931856 69423.9365  93.2%     -  179s
H    0     0                    36464.331398 69423.9365  90.4%     -  179s
H    0     0                    36504.190429 69423.9365  90.2%     -  179s
H    0     0                    36962.275683 69423.9365  87.8%     -  179s
H    0     0                    36965.679897 69423.9365  87.8%     -  179s
H    0     0                    37005.538929 69423.9365  87.6%     -  179s
H    0     0                    37183.121262 69423.9365  86.7%     -  179s
     0     0 69423.9365    0  398 37183.1213 69423.9365  86.7%     -  179s
     0     0 69387.1779    0  403 37183.1213 69387.1779  86.6%     -  184s
     0     0 69260.3103    0  398 37183.1213 69260.3103  86.3%     -  192s
     0     0 69242.0221    0  388 37183.1213 69242.0221  86.2%     -  195s
     0     0 69226.8502    0  392 37183.1213 69226.8502  86.2%     -  199s
     0     0 69224.0814    0  396 37183.1213 69224.0814  86.2%     -  201s
     0     0 69223.4957    0  393 37183.1213 69223.4957  86.2%     -  201s
     0     0 67196.0212    0  326 37183.1213 67196.0212  80.7%     -  249s
     0     0 66521.8754    0  335 37183.1213 66521.8754  78.9%     -  265s
     0     0 66324.5936    0  343 37183.1213 66324.5936  78.4%     -  274s
     0     0 66239.8625    0  343 37183.1213 66239.8625  78.1%     -  280s
     0     0 66184.8849    0  345 37183.1213 66184.8849  78.0%     -  286s
     0     0 66053.6521    0  348 37183.1213 66053.6521  77.6%     -  296s
     0     0 66004.6304    0  481 37183.1213 66004.6304  77.5%     -  301s
     0     0 65968.2024    0  358 37183.1213 65968.2024  77.4%     -  306s
     0     0 65950.7928    0  358 37183.1213 65950.7928  77.4%     -  310s
     0     0 65937.9008    0  354 37183.1213 65937.9008  77.3%     -  313s
     0     0 65930.5159    0  357 37183.1213 65930.5159  77.3%     -  315s
     0     0 65927.7331    0  360 37183.1213 65927.7331  77.3%     -  317s
     0     0 65924.7553    0  473 37183.1213 65924.7553  77.3%     -  319s
     0     0 65920.2713    0  473 37183.1213 65920.2713  77.3%     -  321s
     0     0 65918.0286    0  466 37183.1213 65918.0286  77.3%     -  322s
     0     0 65237.3592    0  334 37183.1213 65237.3592  75.4%     -  342s
H    0     0                    39043.049531 65237.1912  67.1%     -  343s
     0     0 65030.5208    0  445 39043.0495 65030.5208  66.6%     -  355s
     0     0 64946.2421    0  432 39043.0495 64946.2421  66.3%     -  364s
     0     0 64921.9443    0  470 39043.0495 64921.9443  66.3%     -  368s
     0     0 64903.9218    0  437 39043.0495 64903.9218  66.2%     -  371s
     0     0 64874.4473    0  430 39043.0495 64874.4473  66.2%     -  376s
     0     0 64863.9966    0  482 39043.0495 64863.9966  66.1%     -  379s
     0     0 64861.0104    0  431 39043.0495 64861.0104  66.1%     -  381s
     0     0 64852.1273    0  439 39043.0495 64852.1273  66.1%     -  383s
     0     0 64850.2983    0  481 39043.0495 64850.2983  66.1%     -  385s
     0     0 64665.8640    0  460 39043.0495 64665.8640  65.6%     -  397s
     0     0 64627.5296    0  549 39043.0495 64627.5296  65.5%     -  403s
     0     0 64610.5435    0  518 39043.0495 64610.5435  65.5%     -  408s
     0     0 64591.9289    0  512 39043.0495 64591.9289  65.4%     -  411s
     0     0 64583.1805    0  511 39043.0495 64583.1805  65.4%     -  413s
     0     0 64579.4095    0  545 39043.0495 64579.4095  65.4%     -  415s
     0     0 64577.1780    0  546 39043.0495 64577.1780  65.4%     -  417s
     0     0 64531.8481    0  454 39043.0495 64531.8481  65.3%     -  424s
     0     0 64515.0796    0  434 39043.0495 64515.0796  65.2%     -  431s
     0     0 64508.8502    0  418 39043.0495 64508.8502  65.2%     -  433s
     0     0 64501.4220    0  467 39043.0495 64501.4220  65.2%     -  435s
     0     0 64497.3342    0  466 39043.0495 64497.3342  65.2%     -  437s
     0     0 64496.5139    0  470 39043.0495 64496.5139  65.2%     -  437s
     0     0 64466.6059    0  456 39043.0495 64466.6059  65.1%     -  443s
     0     0 64459.0955    0  400 39043.0495 64459.0955  65.1%     -  446s
     0     0 64455.7406    0  402 39043.0495 64455.7406  65.1%     -  448s
     0     0 64454.3558    0  472 39043.0495 64454.3558  65.1%     -  449s
     0     0 64431.6845    0  482 39043.0495 64431.6845  65.0%     -  454s
     0     0 64424.3478    0  482 39043.0495 64424.3478  65.0%     -  457s
     0     0 64421.9168    0  464 39043.0495 64421.9168  65.0%     -  458s
     0     0 64406.8940    0  466 39043.0495 64406.8940  65.0%     -  464s
     0     0 64397.8114    0  477 39043.0495 64397.8114  64.9%     -  467s
     0     0 64395.1351    0  469 39043.0495 64395.1351  64.9%     -  469s
     0     0 64381.9948    0  466 39043.0495 64381.9948  64.9%     -  473s
     0     0 64381.4358    0  466 39043.0495 64381.4358  64.9%     -  475s
H    0     0                    39065.965312 64381.4241  64.8%     -  558s
H    0     0                    39132.621520 64381.4241  64.5%     -  558s
H    0     0                    39169.849028 64381.4241  64.4%     -  558s
H    0     0                    39264.036319 64381.4241  64.0%     -  559s
H    0     0                    39390.476272 64381.4241  63.4%     -  559s
H    0     2                    39469.706581 64381.4241  63.1%     -  566s
     0     2 64381.4241    0  466 39469.7066 64381.4241  63.1%     -  566s
     1     3 63214.0875    1  309 39469.7066 64381.4241  63.1% 17069  581s
     2     5 62262.2295    2  336 39469.7066 64381.4241  63.1% 16732  600s
     4    10 64022.7963    2  348 39469.7066 64250.0590  62.8% 12385  614s
     9    19 63184.9441    3  333 39469.7066 64119.8500  62.5% 10773  640s
    18    38 63137.4587    4  343 39469.7066 63804.5322  61.7% 12909  668s
    37    51 61542.7483    5  346 39469.7066 63717.9520  61.4% 18690  752s
H   50    75                    39599.145820 63717.9520  60.9% 22006  800s
H   65    75                    39613.117958 63717.9520  60.9% 19926  800s
    74   146 60373.4402    7  376 39613.1180 63717.9520  60.9% 18382  855s
   145   257 60203.2421   10  380 39613.1180 63717.9520  60.9% 11436  890s
   256   347 60078.3142   12  313 39613.1180 63717.9520  60.9%  8631  914s
   346   414 59830.3074   15  304 39613.1180 63717.9520  60.9%  7533  937s
   413   446 59719.8880   17  342 39613.1180 63717.9520  60.9%  6914  952s
   445   472 59663.8910   18  342 39613.1180 63717.9520  60.9%  6818  970s
   471   504 59651.7111   19  285 39613.1180 63717.9520  60.9%  6770  988s
   503   541 59474.1087   20  326 39613.1180 63717.9520  60.9%  6822 1008s
   540   578 59184.6149   21  316 39613.1180 63717.9520  60.9%  6703 1026s
   577   617 58890.8679   22  312 39613.1180 63717.9520  60.9%  6694 1044s
   616   651 58515.3790   25  237 39613.1180 63717.9520  60.9%  6628 1063s
   650   687 58645.5964   23  278 39613.1180 63717.9520  60.9%  6672 1082s
   686   730 58402.0039   24  247 39613.1180 63717.9520  60.9%  6580 1098s
   729   774 58266.7437   25  281 39613.1180 63717.9520  60.9%  6551 1113s
   773   819 57979.9739   26  281 39613.1180 63717.9520  60.9%  6676 1129s
   818   852 57835.4393   27  290 39613.1180 63717.9520  60.9%  6587 1144s
   851   892 57712.5906   28  297 39613.1180 63717.9520  60.9%  6624 1160s
H  891   921                    39700.240908 63717.9520  60.5%  6608 1177s
   924   990 57488.1835   30  276 39700.2409 63717.9520  60.5%  6667 1201s
   997  1026 57172.1441   34  258 39700.2409 63717.9520  60.5%  6535 1220s
H 1001  1026                    39756.682616 63717.9520  60.3%  6512 1220s
  1033  1123 57155.8850   35  224 39756.6826 63717.9520  60.3%  6450 1245s
  1142  1233 56568.0793   37  266 39756.6826 63717.9520  60.3%  6117 1269s
  1258  1358 56014.7033   39  328 39756.6826 63717.9520  60.3%  5821 1299s
  1393  1387 55383.1880   44  261 39756.6826 63717.9520  60.3%  5518 1318s
H 1394  1387                    39807.595478 63717.9520  60.1%  5514 1318s
  1422  1531 55179.0469   45  253 39807.5955 63717.9520  60.1%  5469 1347s
  1578  1560 54542.1584   52  272 39807.5955 63717.9520  60.1%  5153 1367s
H 1590  1560                    39969.531665 63717.9520  59.4%  5130 1367s
  1609  1708 54369.1103   53  291 39969.5317 63717.9520  59.4%  5116 1395s
  1781  1894 53845.4739   58  267 39969.5317 63717.9520  59.4%  4817 1422s
  2002  1919 50591.2295   61  253 39969.5317 63717.9520  59.4%  4465 1446s
H 2022  1919                    40038.671333 63717.9520  59.1%  4463 1446s
  2036  2069 50559.4601   62  210 40038.6713 63717.9520  59.1%  4460 1476s
  2251  2211 49234.5222   66  234 40038.6713 63717.9520  59.1%  4217 1503s
  2459  2354 47301.4044   81  141 40038.6713 63345.0361  58.2%  4024 1535s
  2671  2482 46465.8863   97  123 40038.6713 63288.7974  58.1%  3854 1567s
  2857  2548 41148.0066  114  138 40038.6713 63288.7974  58.1%  3765 1606s
  2961  2659 45729.6470   61  308 40038.6713 63288.7974  58.1%  3743 1641s
  3098  2732 44352.4313   62  263 40038.6713 63288.7974  58.1%  3705 1672s
  3220  2790 infeasible   63      40038.6713 63288.7974  58.1%  3662 1712s
  3348  2904 40960.3770   68  186 40038.6713 63288.7974  58.1%  3673 1753s
  3522  3030 59983.0788    7  324 40038.6713 63288.7974  58.1%  3661 1796s
  3728  3192 59131.2296    8  366 40038.6713 63288.7974  58.1%  3623 1841s
  3919  3193 44414.7718   79  466 40038.6713 63288.7974  58.1%  3604 2007s
  3921  3194 54098.6671   25  181 40038.6713 63288.7974  58.1%  3602 2015s
  3922  3195 51363.5554   55  300 40038.6713 63288.7974  58.1%  3601 2061s
  3923  3196 40691.6309   82  293 40038.6713 63288.7974  58.1%  3600 2108s
  3924  3196 57170.2173   35  322 40038.6713 63288.7974  58.1%  3599 2140s
  3925  3197 59201.3985   17  330 40038.6713 63288.7974  58.1%  3598 2159s
  3926  3198 49466.1234   59  374 40038.6713 63288.7974  58.1%  3598 2173s
  3927  3198 60218.6104   16  351 40038.6713 63288.7974  58.1%  3597 2184s
  3928  3199 56938.8689   32  369 40038.6713 63288.7974  58.1%  3596 2195s
  3929  3200 58018.0780    8  396 40038.6713 63288.7974  58.1%  3595 2202s
  3930  3200 58250.5028   27  418 40038.6713 63288.7974  58.1%  3594 2209s
  3931  3201 53826.5088   18  375 40038.6713 63288.7974  58.1%  3593 2217s
  3932  3202 48925.0325   87  389 40038.6713 63288.7974  58.1%  3592 2222s
  3933  3202 51739.6836   21  397 40038.6713 63288.7974  58.1%  3591 2227s
  3934  3203 56535.1023   34  445 40038.6713 63288.7974  58.1%  3590 2233s
  3935  3204 56132.8042   23  398 40038.6713 63288.7974  58.1%  3589 2237s
  3936  3204 41122.6831   79  450 40038.6713 63288.7974  58.1%  3588 2240s
  3939  3206 54361.2827   40  453 40038.6713 63288.7974  58.1%  3586 2255s
  3940  3207 45102.7684   57  432 40038.6713 63288.7974  58.1%  3585 2264s
  3941  3208 56770.8136   22  425 40038.6713 63288.7974  58.1%  3584 2271s
  3943  3209 47878.0343   60  440 40038.6713 63288.7974  58.1%  3582 2276s
  3945  3210 41543.0809   68  435 40038.6713 63288.7974  58.1%  3580 2281s
  3946  3211 54538.7452   53  447 40038.6713 63288.7974  58.1%  3579 2290s
  3948  3212 61279.8104    8  487 40038.6713 63288.7974  58.1%  3578 2296s
  3950  3214 58810.2614   22  485 40038.6713 63288.7974  58.1%  3576 2311s
  3952  3215 46463.2304   98  454 40038.6713 63288.7974  58.1%  3574 2318s
  3953  3216 42948.7608   29  410 40038.6713 63288.7974  58.1%  3573 2326s
  3955  3217 44070.2872   36  409 40038.6713 63288.7974  58.1%  3571 2330s
  3957  3218 42308.6846  109  488 40038.6713 63288.7974  58.1%  3569 2345s
  3958  3219 48946.2105   86  493 40038.6713 63288.7974  58.1%  3568 2351s
  3960  3220 56465.4941   27  453 40038.6713 63288.7974  58.1%  3567 2358s
  3961  3221 58510.9452    7  363 40038.6713 63288.7974  58.1%  3566 2366s
  3962  3222 57316.3345   23  366 40038.6713 63288.7974  58.1%  3565 2370s
  3964  3223 56833.4506   14  377 40038.6713 63288.7974  58.1%  3563 2376s
  3965  3224 59385.0585   28  471 40038.6713 63288.7974  58.1%  3562 2386s
  3966  3224 59979.6875    8  451 40038.6713 63288.7974  58.1%  3561 2396s
  3967  3225 50930.8719   37  456 40038.6713 63282.3349  58.1%  3560 2402s
  3969  3226 42672.3505   60  471 40038.6713 63271.9283  58.0%  3559 2407s
  3970  3227 45865.2261   55  416 40038.6713 63194.5034  57.8%  3558 2417s
  3971  3228 60079.5238   25  371 40038.6713 63170.9702  57.8%  3557 2422s
  3973  3229 61198.1163   10  468 40038.6713 63160.7291  57.7%  3555 2427s
  3974  3230 44002.0862   63  418 40038.6713 63131.3945  57.7%  3554 2439s
  3975  3230 60939.0363   17  467 40038.6713 63131.3945  57.7%  3553 2441s
  3977  3232 42745.8667   86  460 40038.6713 63100.2756  57.6%  3551 2449s
  3978  3232 55504.4110   30  472 40038.6713 63100.2756  57.6%  3551 2451s
  3980  3234 43261.1865   52  469 40038.6713 63094.5646  57.6%  3549 2475s
  3982  3235 57219.8125   34  424 40038.6713 63090.1565  57.6%  3547 2482s
  3983  3236 60503.1000   11  465 40038.6713 63090.1565  57.6%  3546 2485s
  3984  3236 56056.2786   26  465 40038.6713 63079.7716  57.5%  3545 2490s
  3986  3238 54762.1933   18  470 40038.6713 63069.7037  57.5%  3543 2500s
  3987  3238 56288.8860   38  470 40038.6713 63065.1606  57.5%  3543 2515s
  3988  3239 60079.5238   25  470 40038.6713 63065.1606  57.5%  3542 2580s
  3989  3242 62915.6474   10  445 40038.6713 63065.1606  57.5%  3655 2622s
  3990  3242 63026.7051   10  467 40038.6713 63026.7051  57.4%  3654 2634s
  3991  3246 62691.3921   11  437 40038.6713 63026.6453  57.4%  3656 2671s
  3995  3252 61806.4322   12  395 40038.6713 62785.5106  56.8%  3661 2735s
  4002  3264 61588.0052   13  448 40038.6713 62664.8313  56.5%  3687 2771s
  4017  3274 60638.5229   14  401 40038.6713 62488.7276  56.1%  3791 3359s
  4032  3300 57974.3145   15  399 40038.6713 62488.7276  56.1%  3895 3438s
  4063  3414 57762.3523   16  409 40038.6713 62032.3823  54.9%  4027 3505s
  4187  3405 54148.3466   19  313 40038.6713 61679.9146  54.1%  4192 3537s
  4219  3435 53281.0146   20  287 40038.6713 61679.9146  54.1%  4225 3573s
  4260  3463 51845.4998   22  292 40038.6713 61679.9146  54.1%  4257 3600s

Cutting planes:
  Learned: 1
  Gomory: 28
  Implied bound: 21
  Projected implied bound: 347
  MIR: 1415
  Mixing: 11
  Flow cover: 2141
  RLT: 67
  Relax-and-lift: 317

Explored 4302 nodes (18924916 simplex iterations) in 3600.04 seconds (8123.61 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 40038.7 39969.5 39807.6 ... 39264

Time limit reached
Best objective 4.003867133330e+04, best bound 6.167991461880e+04, gap 54.0509%
  WARNING: Time limit reached. Using best solution found (gap: 54.05%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 40038.67, θ = 229556.62
  Upper Bound (UB) = 40038.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229556.62
  [DEBUG]   ✓ Scenario 0: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229556.62 ≤ Q = 229556.62 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 229556.62 ≤ Q = 230039.06 (slack: 482.44)
  [DEBUG]   ✓ Scenario 10: θ = 229556.62 ≤ Q = 229556.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3d8c720b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc2738df5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.409542e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.00s
Presolved: 508 rows, 514 columns, 1439 nonzeros
Found heuristic solution: objective 6817561.3537
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.752418e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -175241.81    0  127 6817561.35 -175241.81   103%     -    0s
H    0     0                    -139114.9466 -175241.81  26.0%     -    0s
H    0     0                    -139522.8127 -175241.81  25.6%     -    0s
H    0     0                    -144641.9966 -159591.27  10.3%     -    0s
H    0     0                    -150270.6190 -159591.27  6.20%     -    0s
     0     0 -159591.27    0   56 -150270.62 -159591.27  6.20%     -    0s
H    0     0                    -158469.4409 -159588.11  0.71%     -    0s
H    0     0                    -158904.8584 -159588.11  0.43%     -    0s
     0     0 -159497.63    0   40 -158904.86 -159497.63  0.37%     -    0s
     0     0 -159496.53    0   33 -158904.86 -159496.53  0.37%     -    0s
     0     0 -159174.56    0   10 -158904.86 -159174.56  0.17%     -    0s
H    0     0                    -158978.5613 -159163.02  0.12%     -    0s
     0     0 -159069.92    0    4 -158978.56 -159069.92  0.06%     -    0s
     0     0 -159062.31    0    2 -158978.56 -159062.31  0.05%     -    0s
     0     0 -159062.31    0   12 -158978.56 -159062.31  0.05%     -    0s
H    0     0                    -159033.7453 -159062.31  0.02%     -    0s
*    0     0               0    -159037.9812 -159037.98  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 2
  MIR: 5
  Flow cover: 6
  Relax-and-lift: 2

Explored 1 nodes (592 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -159038 -159034 -158979 ... 6.81756e+06
No other solutions better than -159038

Optimal solution found (tolerance 1.00e-06)
Best objective -1.590379811727e+05, best bound -1.590379811727e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 212409.22
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -159037.98
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -159037.98 = 212409.22
  [DEBUG]   Current θ from Master = 229556.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17147.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22891.27
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1631.4013, Absolute Gap = 1631.4013, Relative Gap = 0.040746
  Not converged yet (gap = 1631.40 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524363 nonzeros
Model fingerprint: 0x0f7fc8a8
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82516 rows and 33506 columns
Presolve time: 1.33s
Presolved: 102347 rows, 43634 columns, 618947 nonzeros
Variable types: 41375 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -327140.1202
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 674
 AA' NZ     : 3.347e+06
 Factor NZ  : 8.129e+06 (roughly 130 MB of memory)
 Factor Ops : 1.589e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68445946e+07  1.97713396e+08  1.33e+05 1.94e+01  8.27e+04     2s
   1  -1.29647069e+07  1.82868595e+08  9.42e+04 1.08e+02  5.78e+04     2s
   2  -6.46272579e+06  1.44490115e+08  4.53e+04 1.65e+01  2.90e+04     2s
   3  -1.47263295e+06  1.08873777e+08  6.57e+03 1.06e+00  4.60e+03     2s
   4  -6.42793684e+05  6.08505572e+07  8.52e+02 3.09e-01  8.06e+02     2s
   5  -4.60699175e+05  3.33915403e+07  3.63e+02 1.34e-01  3.61e+02     3s
   6  -3.60783599e+05  2.58143033e+07  1.69e+02 9.72e-02  2.19e+02     3s
   7  -2.91626683e+05  1.99753314e+07  7.64e+01 7.09e-02  1.40e+02     3s
   8  -1.75797238e+05  1.25983505e+07  2.96e+01 4.10e-02  7.79e+01     3s
   9  -1.45804009e+05  9.61080245e+06  2.24e+01 3.01e-02  5.81e+01     3s
  10  -1.07426264e+05  5.87819682e+06  1.42e+01 1.74e-02  3.46e+01     3s
  11  -6.12568573e+04  1.83579731e+06  5.17e+00 4.92e-03  1.05e+01     3s
  12  -9.63518460e+03  5.13515659e+05  1.64e+00 1.55e-03  2.83e+00     3s
  13   4.27273831e+03  3.37240323e+05  1.22e+00 1.18e-03  1.80e+00     3s
  14   1.17323774e+04  2.33900162e+05  9.84e-01 1.45e-03  1.20e+00     3s
  15   2.14945266e+04  1.84535460e+05  7.71e-01 1.36e-03  8.78e-01     3s
  16   3.64006371e+04  1.52983339e+05  5.33e-01 2.81e-03  6.27e-01     3s
  17   4.44732165e+04  1.26944009e+05  4.32e-01 3.76e-03  4.44e-01     3s
  18   4.92633229e+04  1.19424865e+05  3.62e-01 2.99e-03  3.77e-01     3s
  19   5.44550363e+04  1.07194710e+05  2.99e-01 3.03e-03  2.84e-01     3s
  20   6.01949215e+04  1.01614572e+05  2.35e-01 1.98e-03  2.23e-01     3s
  21   6.46740129e+04  9.52655265e+04  1.83e-01 1.59e-03  1.64e-01     3s
  22   6.76002772e+04  9.14841866e+04  1.48e-01 2.01e-03  1.28e-01     3s
  23   7.05048924e+04  8.98421249e+04  1.16e-01 1.89e-03  1.04e-01     3s
  24   7.13615013e+04  8.78602439e+04  1.06e-01 1.59e-03  8.87e-02     3s
  25   7.36815045e+04  8.68277113e+04  8.14e-02 1.88e-03  7.06e-02     3s
  26   7.48395987e+04  8.54817922e+04  6.90e-02 1.74e-03  5.72e-02     3s
  27   7.59641630e+04  8.43659393e+04  5.78e-02 1.11e-03  4.52e-02     3s
  28   7.67140549e+04  8.40886874e+04  5.05e-02 1.15e-03  3.96e-02     3s
  29   7.76931760e+04  8.35483677e+04  4.07e-02 9.53e-04  3.15e-02     3s
  30   7.84626601e+04  8.33799446e+04  3.32e-02 9.33e-04  2.64e-02     3s
  31   7.91719512e+04  8.29118972e+04  2.63e-02 9.44e-04  2.01e-02     3s
  32   7.96686943e+04  8.27300034e+04  2.16e-02 8.08e-04  1.65e-02     3s
  33   8.00145397e+04  8.24468140e+04  1.82e-02 1.24e-03  1.31e-02     3s
  34   8.04936779e+04  8.23523411e+04  1.37e-02 1.24e-03  1.00e-02     4s
  35   8.08885242e+04  8.22916765e+04  1.00e-02 1.00e-03  7.54e-03     4s
  36   8.11716846e+04  8.21912673e+04  7.40e-03 6.39e-04  5.48e-03     4s
  37   8.13635249e+04  8.21614829e+04  5.61e-03 5.35e-04  4.29e-03     4s
  38   8.14862321e+04  8.21153813e+04  4.46e-03 3.86e-04  3.38e-03     4s
  39   8.16020232e+04  8.20781664e+04  3.41e-03 2.58e-04  2.56e-03     4s
  40   8.17879079e+04  8.20719165e+04  1.80e-03 2.37e-04  1.53e-03     4s
  41   8.18184473e+04  8.20341942e+04  1.53e-03 1.22e-04  1.16e-03     4s
  42   8.19397704e+04  8.20068872e+04  4.72e-04 6.32e-05  3.61e-04     4s
  43   8.19809275e+04  8.19990909e+04  1.17e-04 3.98e-05  9.76e-05     4s
  44   8.19907780e+04  8.19969566e+04  3.65e-05 1.61e-05  3.32e-05     4s
  45   8.19942431e+04  8.19956158e+04  8.30e-06 2.20e-06  7.37e-06     4s
  46   8.19953039e+04  8.19954382e+04  4.40e-07 4.22e-07  7.19e-07     4s
  47   8.19953969e+04  8.19953970e+04  2.91e-10 1.39e-09  4.16e-10     4s

Barrier solved model in 47 iterations and 4.06 seconds (8.23 work units)
Optimal objective 8.19953969e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    2888 PPushes remaining with PInf 2.3441483e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2474075e+01      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39093    8.1995397e+04   0.000000e+00   3.247408e+01      6s
   39098    8.1995397e+04   0.000000e+00   0.000000e+00      6s
   39098    8.1995397e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 8.199540e+04, 39098 iterations, 4.18 seconds (10.58 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 81995.3969    0  175 -183060.80 81995.3969   145%     -    6s
H    0     0                    -178545.4061 81995.3969   146%     -    6s
H    0     0                    -177425.1628 81995.3969   146%     -    6s
H    0     0                    -177230.4963 81995.3969   146%     -    6s
H    0     0                    -173027.3787 81995.3969   147%     -    6s
H    0     0                    -171486.7561 81995.3969   148%     -    6s
H    0     0                    -165238.3836 81995.3969   150%     -    7s
H    0     0                    -164592.3506 81995.3969   150%     -    7s
H    0     0                    -164414.2044 81995.3969   150%     -    7s
H    0     0                    -163768.1714 81995.3969   150%     -    7s
H    0     0                    -143376.7743 81995.3969   157%     -    7s
H    0     0                    -141347.1411 81995.3969   158%     -    7s
H    0     0                    -141336.2908 81995.3969   158%     -    8s
H    0     0                    -70943.90833 81995.3969   216%     -    8s
H    0     0                    -44729.57460 81995.3969   283%     -    8s
H    0     0                    -3224.035816 81995.3969  2643%     -    8s
H    0     0                    -2877.492942 81995.3969  2950%     -    8s
H    0     0                    -2810.472343 81995.3969  3017%     -    8s
H    0     0                    -1195.666471 75910.7946  6449%     -   32s
H    0     0                    -1189.970465 75910.7946  6479%     -   32s
H    0     0                    -540.0267205 75910.7946      -     -   32s
H    0     0                     -30.9995090 75910.7946      -     -   32s
H    0     0                     365.4754355 75910.7946      -     -   32s
H    0     0                    17664.113682 75910.7946   330%     -   32s
H    0     0                    18335.934586 75910.7946   314%     -   32s
H    0     0                    18707.208889 75910.7946   306%     -   32s
     0     0 75910.7946    0  309 18707.2089 75910.7946   306%     -   32s
H    0     0                    20191.007131 75910.6133   276%     -   33s
H    0     0                    21548.361066 75910.6133   252%     -   33s
H    0     0                    22210.536887 75910.6133   242%     -   33s
H    0     0                    24163.061764 75910.6133   214%     -   33s
H    0     0                    24170.173850 75910.6133   214%     -   33s
H    0     0                    28321.942795 75910.6133   168%     -   33s
     0     0 75475.4505    0  344 28321.9428 75475.4505   166%     -   46s
     0     0 75391.1563    0  335 28321.9428 75391.1563   166%     -   51s
     0     0 75375.8085    0  326 28321.9428 75375.8085   166%     -   53s
     0     0 75366.4900    0  343 28321.9428 75366.4900   166%     -   55s
     0     0 75365.8173    0  344 28321.9428 75365.8173   166%     -   56s
H    0     0                    30470.419478 70800.4260   132%     -   98s
H    0     0                    31937.917273 70800.4260   122%     -   98s
H    0     0                    32306.669158 70800.4260   119%     -   98s
H    0     0                    32400.116942 70800.4260   119%     -   98s
H    0     0                    32400.853073 70800.4260   119%     -   98s
H    0     0                    32424.333610 70800.4260   118%     -   98s
     0     0 70800.4260    0  381 32424.3336 70800.4260   118%     -   98s
H    0     0                    32471.891743 70800.4125   118%     -   99s
H    0     0                    33160.311766 70800.4125   114%     -   99s
H    0     0                    33388.523055 70800.4125   112%     -   99s
H    0     0                    33694.242181 70800.4125   110%     -   99s
     0     0 70131.8423    0  442 33694.2422 70131.8423   108%     -  125s
     0     0 69873.1042    0  449 33694.2422 69873.1042   107%     -  141s
H    0     0                    34491.206659 69785.8297   102%     -  151s
H    0     0                    36258.027998 69785.8297  92.5%     -  151s
H    0     0                    36556.596376 69785.8297  90.9%     -  151s
H    0     0                    36833.555861 69785.8297  89.5%     -  151s
H    0     0                    37102.680530 69785.8297  88.1%     -  151s
     0     0 69785.8297    0  468 37102.6805 69785.8297  88.1%     -  151s
H    0     0                    38242.264786 69747.0520  82.4%     -  157s
     0     0 69747.0520    0  456 38242.2648 69747.0520  82.4%     -  157s
     0     0 69495.0725    0  474 38242.2648 69495.0725  81.7%     -  172s
     0     0 69482.1987    0  474 38242.2648 69482.1987  81.7%     -  177s
     0     0 69352.3260    0  494 38242.2648 69352.3260  81.3%     -  188s
     0     0 69332.3137    0  440 38242.2648 69332.3137  81.3%     -  194s
     0     0 69251.8386    0  433 38242.2648 69251.8386  81.1%     -  199s
     0     0 69245.9290    0  429 38242.2648 69245.9290  81.1%     -  202s
     0     0 69216.3861    0  486 38242.2648 69216.3861  81.0%     -  207s
     0     0 69185.7543    0  483 38242.2648 69185.7543  80.9%     -  213s
     0     0 69179.8803    0  486 38242.2648 69179.8803  80.9%     -  216s
     0     0 69178.5486    0  475 38242.2648 69178.5486  80.9%     -  217s
H    0     0                    38384.414747 67012.9439  74.6%     -  265s
H    0     0                    38607.525470 67012.9439  73.6%     -  265s
H    0     0                    38628.722591 67012.9439  73.5%     -  265s
     0     0 67012.9439    0  475 38628.7226 67012.9439  73.5%     -  265s
     0     0 66390.8276    0  412 38628.7226 66390.8276  71.9%     -  287s
     0     0 66127.1081    0  441 38628.7226 66127.1081  71.2%     -  301s
     0     0 66053.5596    0  434 38628.7226 66053.5596  71.0%     -  309s
     0     0 66014.9180    0  449 38628.7226 66014.9180  70.9%     -  313s
     0     0 65992.5241    0  438 38628.7226 65992.5241  70.8%     -  318s
     0     0 65959.7221    0  444 38628.7226 65959.7221  70.8%     -  322s
H    0     0                    38654.615979 65943.9068  70.6%     -  325s
H    0     0                    38744.523199 65943.9068  70.2%     -  325s
H    0     0                    38961.003120 65943.9068  69.3%     -  325s
     0     0 65943.9068    0  440 38961.0031 65943.9068  69.3%     -  325s
     0     0 65913.3348    0  453 38961.0031 65913.3348  69.2%     -  329s
     0     0 65903.4297    0  429 38961.0031 65903.4297  69.2%     -  331s
     0     0 65900.6132    0  472 38961.0031 65900.6132  69.1%     -  332s
     0     0 65899.0256    0  425 38961.0031 65899.0256  69.1%     -  334s
     0     0 65415.0466    0  458 38961.0031 65415.0466  67.9%     -  354s
     0     0 65224.6626    0  481 38961.0031 65224.6626  67.4%     -  367s
     0     0 65177.5941    0  521 38961.0031 65177.5941  67.3%     -  377s
     0     0 65149.9987    0  510 38961.0031 65149.9987  67.2%     -  382s
     0     0 65122.0984    0  519 38961.0031 65122.0984  67.1%     -  388s
H    0     0                    39070.862797 65090.2346  66.6%     -  393s
H    0     0                    39081.791560 65090.2346  66.5%     -  393s
H    0     0                    39092.169294 65090.2346  66.5%     -  393s
     0     0 65090.2346    0  522 39092.1693 65090.2346  66.5%     -  393s
     0     0 65060.3060    0  507 39092.1693 65060.3060  66.4%     -  396s
     0     0 65037.4451    0  511 39092.1693 65037.4451  66.4%     -  399s
     0     0 65032.5224    0  510 39092.1693 65032.5224  66.4%     -  401s
     0     0 65029.4797    0  535 39092.1693 65029.4797  66.3%     -  403s
     0     0 65027.5947    0  488 39092.1693 65027.5947  66.3%     -  404s
     0     0 64871.0209    0  377 39092.1693 64871.0209  65.9%     -  416s
     0     0 64807.8972    0  502 39092.1693 64807.8972  65.8%     -  424s
     0     0 64779.8993    0  482 39092.1693 64779.8993  65.7%     -  428s
     0     0 64768.7699    0  450 39092.1693 64768.7699  65.7%     -  431s
     0     0 64764.4203    0  489 39092.1693 64764.4203  65.7%     -  434s
     0     0 64759.8824    0  465 39092.1693 64759.8824  65.7%     -  435s
     0     0 64756.0657    0  464 39092.1693 64756.0657  65.6%     -  437s
     0     0 64755.3117    0  382 39092.1693 64755.3117  65.6%     -  438s
     0     0 64646.1012    0  508 39092.1693 64646.1012  65.4%     -  446s
H    0     0                    39127.656141 64645.6358  65.2%     -  447s
     0     0 64604.5546    0  512 39127.6561 64604.5546  65.1%     -  454s
     0     0 64592.1807    0  522 39127.6561 64592.1807  65.1%     -  457s
     0     0 64588.5528    0  520 39127.6561 64588.5528  65.1%     -  460s
     0     0 64586.4589    0  514 39127.6561 64586.4589  65.1%     -  462s
     0     0 64507.9543    0  519 39127.6561 64507.9543  64.9%     -  472s
     0     0 64482.6086    0  436 39127.6561 64482.6086  64.8%     -  479s
     0     0 64474.3017    0  410 39127.6561 64474.3017  64.8%     -  483s
     0     0 64468.9640    0  358 39127.6561 64468.9640  64.8%     -  486s
     0     0 64460.9923    0  503 39127.6561 64460.9923  64.7%     -  490s
     0     0 64457.7320    0  356 39127.6561 64457.7320  64.7%     -  492s
     0     0 64455.6148    0  488 39127.6561 64455.6148  64.7%     -  494s
     0     0 64424.3219    0  347 39127.6561 64424.3219  64.7%     -  502s
     0     0 64418.0400    0  485 39127.6561 64418.0400  64.6%     -  505s
     0     0 64415.6993    0  514 39127.6561 64415.6993  64.6%     -  506s
     0     0 64400.6457    0  490 39127.6561 64400.6457  64.6%     -  512s
     0     0 64397.3270    0  387 39127.6561 64397.3270  64.6%     -  515s
     0     0 64396.3210    0  523 39127.6561 64396.3210  64.6%     -  517s
     0     0 64389.0470    0  528 39127.6561 64389.0470  64.6%     -  520s
     0     0 64388.6794    0  528 39127.6561 64388.6794  64.6%     -  522s
     0     2 64388.6330    0  528 39127.6561 64388.6330  64.6%     -  610s
     1     3 64283.4167    1  388 39127.6561 64388.6330  64.6%  9908  617s
     2     4 64268.8625    1  401 39127.6561 64283.3752  64.3%  8364  624s
     3     6 63682.2567    2  483 39127.6561 64283.3731  64.3%  8011  651s
     5    10 63547.6474    3  520 39127.6561 64268.4788  64.3% 11407  673s
     9    19 63303.2711    3  347 39127.6561 63812.0812  63.1% 11687  692s
    18    38 62381.9641    4  336 39127.6561 63707.2509  62.8% 11273  718s
    37    51 62342.8904    5  375 39127.6561 63650.9856  62.7% 18370  795s
H   50    75                    39279.892706 63650.9856  62.0% 18938  850s
H   56    75                    39284.750906 63650.9856  62.0% 18014  850s
H   57    75                    39348.197952 63650.9856  61.8% 18000  850s
H   65    75                    39355.127347 63650.9856  61.7% 16824  850s
    74   134 61712.1413    7  332 39355.1273 63650.9856  61.7% 15569  917s
   133   204 61626.6754    9  322 39355.1273 63650.9856  61.7% 11070  954s
H  166   204                    39561.081489 63650.9856  60.9%  9556  954s
   203   285 61568.6960   11  314 39561.0815 63650.9856  60.9%  8655  995s
   284   317 61504.5651   12  303 39561.0815 63650.9856  60.9%  7609 1030s
   316   348 61320.7780   13  294 39561.0815 63650.9856  60.9%  7644 1085s
   347   379 61245.4969   14  295 39561.0815 63650.9856  60.9%  7660 1130s
   378   416 61023.6605   15  292 39561.0815 63650.9856  60.9%  7592 1157s
   415   454 60996.8787   16  294 39561.0815 63650.9856  60.9%  7487 1187s
   453   492 60328.7936   17  277 39561.0815 63650.9856  60.9%  7269 1213s
   491   529 60142.9377   18  276 39561.0815 63650.9856  60.9%  7117 1239s
   528   567 59769.7420   19  297 39561.0815 63650.9856  60.9%  6986 1267s
   566   611 59699.1972   20  300 39561.0815 63650.9856  60.9%  6893 1293s
   610   653 59463.2548   21  289 39561.0815 63650.9856  60.9%  6711 1318s
   652   695 59450.1966   22  289 39561.0815 63650.9856  60.9%  6485 1341s
   694   736 59434.8968   23  290 39561.0815 63650.9856  60.9%  6286 1365s
H  707   736                    39632.094868 63650.9856  60.6%  6270 1365s
   735   825 59311.2675   24  323 39632.0949 63650.9856  60.6%  6182 1396s
   824   919 58691.9298   27  249 39632.0949 63650.9856  60.6%  6000 1425s
H  829   919                    39637.260589 63650.9856  60.6%  5981 1425s
H  846   919                    39646.290569 63650.9856  60.5%  5946 1425s
H  865   919                    39675.741039 63650.9856  60.4%  5862 1425s
   918  1020 58334.1321   29  248 39675.7410 63650.9856  60.4%  5691 1456s
  1019  1139 57954.0877   31  354 39675.7410 63650.9856  60.4%  5477 1487s
  1144  1256 57380.9392   34  288 39675.7410 63650.9856  60.4%  5182 1527s
  1288  1325 56901.6941   37  272 39675.7410 63650.9856  60.4%  4883 1580s
  1413  1379 56254.3084   41  321 39675.7410 63650.9856  60.4%  4759 1627s
  1513  1420 55795.7464   43  322 39675.7410 63650.9856  60.4%  4695 1659s
  1583  1484 55463.3168   44  326 39675.7410 63650.9856  60.4%  4662 1698s
  1687  1549 55204.2411   48  328 39675.7410 63650.9856  60.4%  4617 1739s
  1766  1697 50311.2497   51  180 39675.7410 63650.9856  60.4%  4681 1778s
  1928  1717 48547.0355   63  167 39675.7410 63650.9856  60.4%  4574 1807s
  1963  1787 48411.0790   64  176 39675.7410 63308.5058  59.6%  4552 1842s
  2034  1902 46960.2601   71  147 39675.7410 63308.5058  59.6%  4527 1878s
H 2155  1901                    39995.871001 63308.5058  58.3%  4417 1878s
  2174  2032 44569.0139   84  152 39995.8710 63308.5058  58.3%  4397 1919s
  2363  2164 43713.7618   98   87 39995.8710 63308.5058  58.3%  4292 1961s
  2583  2246 42301.1899  110   97 39995.8710 63308.5058  58.3%  4168 2003s
  2753  2400 infeasible  117      39995.8710 63308.5058  58.3%  4161 2051s
H 2939  2422                    40005.756081 63308.5058  58.2%  4108 2093s
H 2940  2417                    40314.128007 63308.5058  57.0%  4107 2093s
  3003  2519 43957.2904   40  146 40314.1280 63308.5058  57.0%  4124 2144s
  3173  2606 43120.4846   44  131 40314.1280 63308.5058  57.0%  4107 2192s
  3326  2702 infeasible   47      40314.1280 63308.5058  57.0%  4140 2243s
  3486  2845 infeasible   47      40314.1280 63308.5058  57.0%  4164 2298s
H 3677  2845                    40314.662506 62399.2276  54.8%  4155 2324s
  3678  2846 55330.0347   27  528 40314.6625 62399.2276  54.8%  4154 2503s
  3680  2847 56079.9941   43  180 40314.6625 62399.2276  54.8%  4152 2514s
  3681  2848 47985.0566   35  326 40314.6625 62399.2276  54.8%  4151 2582s
  3682  2849 42961.5186   66  286 40314.6625 62399.2276  54.8%  4150 2641s
  3683  2849 59586.6956    7  359 40314.6625 62399.2276  54.8%  4149 2664s
  3684  2850 55117.8852   36  347 40314.6625 62399.2276  54.8%  4147 2679s
  3685  2851 51496.9345   15  376 40314.6625 62399.2276  54.8%  4146 2691s
  3686  2851 51938.1209   12  333 40314.6625 62399.2276  54.8%  4145 2703s
  3687  2852 42546.3716   61  388 40314.6625 62399.2276  54.8%  4144 2714s
  3688  2853 43260.0184   60  349 40314.6625 62399.2276  54.8%  4143 2721s
  3689  2853 51090.1026   24  392 40314.6625 62399.2276  54.8%  4142 2729s
  3690  2854 61326.9627   16  386 40314.6625 62399.2276  54.8%  4141 2735s
  3692  2855 60996.3386   17  390 40314.6625 62399.2276  54.8%  4139 2744s
  3693  2856 56766.5707   28  392 40314.6625 62399.2276  54.8%  4137 2748s
  3694  2857 47529.1394   60  349 40314.6625 62399.2276  54.8%  4136 2760s
  3696  2858 43877.5137   88  413 40314.6625 62399.2276  54.8%  4134 2768s
  3697  2859 42736.5217   56  415 40314.6625 62399.2276  54.8%  4133 2775s
  3699  2860 46731.9806   59  444 40314.6625 62399.2276  54.8%  4131 2783s
  3700  2861 43955.8614   94  441 40314.6625 62399.2276  54.8%  4130 2799s
  3701  2861 52816.3047   50  410 40314.6625 62399.2276  54.8%  4128 2805s
  3703  2863 53659.5199   19  435 40314.6625 62399.2276  54.8%  4126 2813s
  3704  2863 42552.6402  105  425 40314.6625 62399.2276  54.8%  4125 2817s
  3705  2864 45427.2686   16  396 40314.6625 62399.2276  54.8%  4124 2827s
  3706  2865 47401.3307   50  425 40314.6625 62399.2276  54.8%  4123 2832s
  3707  2865 56887.2654   42  434 40314.6625 62399.2276  54.8%  4122 2835s
  3708  2866 41812.1552   69  421 40314.6625 62399.2276  54.8%  4121 2849s
  3709  2867 47669.8125   39  460 40314.6625 62399.2276  54.8%  4120 2853s
  3710  2867 45877.7149   54  419 40314.6625 62399.2276  54.8%  4118 2857s
  3711  2868 47948.3326   43  417 40314.6625 62399.2276  54.8%  4117 2860s
  3712  2869 45502.5289   42  417 40314.6625 62399.2276  54.8%  4116 2870s
  3713  2869 45301.9802   57  453 40314.6625 62399.2276  54.8%  4115 2875s
  3715  2871 42084.9844   74  501 40314.6625 62399.2276  54.8%  4113 2884s
  3716  2871 58765.2448   25  461 40314.6625 62399.2276  54.8%  4112 2895s
  3717  2872 54986.9379   19  458 40314.6625 62399.2276  54.8%  4111 2900s
  3718  2873 55867.1502   16  467 40314.6625 62399.2276  54.8%  4110 2905s
  3719  2873 61211.7065   10  387 40314.6625 62399.2276  54.8%  4108 2914s
  3720  2874 59763.6915   11  480 40314.6625 62399.2276  54.8%  4107 2918s
  3721  2875 53566.0431   13  475 40314.6625 62399.2276  54.8%  4106 2922s
  3722  2875 58610.2699   20  462 40314.6625 62399.2276  54.8%  4105 2930s
  3724  2877 51182.4914   25  477 40314.6625 62399.2276  54.8%  4103 2939s
  3725  2877 57249.1417   26  477 40314.6625 62399.2276  54.8%  4102 2955s
  3726  2878 56892.1612   18  477 40314.6625 62399.2276  54.8%  4101 3036s
  3727  2882 62399.2276   15  469 40314.6625 62399.2276  54.8%  4223 3183s
  3729  2885 62399.2276   16  470 40314.6625 62399.2276  54.8%  4225 3233s
  3733  2892 62399.2276   17  452 40314.6625 62399.2276  54.8%  4243 3321s
  3741  2905 62399.2276   18  491 40314.6625 62399.2276  54.8%  4270 3371s
  3757  2918 60884.6129   19  419 40314.6625 62399.2276  54.8%  4403 3539s
  3775  2918 58640.5158   20  355 40314.6625 62399.2276  54.8%  4463 3600s

Cutting planes:
  Learned: 3
  Gomory: 16
  Implied bound: 45
  Projected implied bound: 280
  MIR: 1738
  Mixing: 14
  Flow cover: 1903
  RLT: 58
  Relax-and-lift: 436

Explored 3781 nodes (17583675 simplex iterations) in 3600.02 seconds (8562.64 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 40314.7 40005.8 39995.9 ... 39348.2

Time limit reached
Best objective 4.031466250551e+04, best bound 6.239922764860e+04, gap 54.7805%
  WARNING: Time limit reached. Using best solution found (gap: 54.78%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 40314.66, θ = 216693.19
  Upper Bound (UB) = 40314.66

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216693.19
  [DEBUG]   ✓ Scenario 0: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216693.19 ≤ Q = 216693.19 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216693.19 ≤ Q = 216693.19 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x514aac16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaeb553ea
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.333361e+13
Presolve removed 2586 rows and 1877 columns
Presolve time: 0.00s
Presolved: 507 rows, 512 columns, 1433 nonzeros
Found heuristic solution: objective 6542989.3657
Variable types: 348 continuous, 164 integer (164 binary)

Root relaxation: objective -1.666317e+05, 255 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -166631.67    0  129 6542989.37 -166631.67   103%     -    0s
H    0     0                    -133491.7485 -166631.67  24.8%     -    0s
H    0     0                    -133757.8694 -166631.67  24.6%     -    0s
     0     0 -147915.11    0   49 -133757.87 -147915.11  10.6%     -    0s
H    0     0                    -135104.1237 -147910.74  9.48%     -    0s
H    0     0                    -144475.9052 -147910.74  2.38%     -    0s
H    0     0                    -147284.3978 -147910.74  0.43%     -    0s
     0     0 -147852.79    0   41 -147284.40 -147852.79  0.39%     -    0s
     0     0 -147471.41    0   22 -147284.40 -147471.41  0.13%     -    0s
H    0     0                    -147373.6182 -147466.93  0.06%     -    0s
     0     0 -147465.20    0   17 -147373.62 -147465.20  0.06%     -    0s
     0     0 -147438.07    0   15 -147373.62 -147438.07  0.04%     -    0s
     0     0 -147426.12    0   10 -147373.62 -147426.12  0.04%     -    0s
     0     0 -147424.03    0    9 -147373.62 -147424.03  0.03%     -    0s
     0     0 -147397.18    0    8 -147373.62 -147397.18  0.02%     -    0s
     0     0 -147397.18    0    7 -147373.62 -147397.18  0.02%     -    0s
     0     0 -147377.05    0    4 -147373.62 -147377.05  0.00%     -    0s
     0     0     cutoff    0      -147373.62 -147373.62  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 1
  MIR: 3
  Flow cover: 2
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (575 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -147374 -147284 -146884 ... 1.33336e+13
No other solutions better than -147374

Optimal solution found (tolerance 1.00e-06)
Best objective -1.473736181967e+05, best bound -1.473736181967e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 202549.52
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147373.62
  [DEBUG]   S×d_nominal = 349923.14
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 349923.14 + -147373.62 = 202549.52
  [DEBUG]   Current θ from Master = 216693.19
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14143.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 26170.99
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1907.3924, Absolute Gap = 1907.3924, Relative Gap = 0.047313
  Not converged yet (gap = 1907.39 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567600 nonzeros
Model fingerprint: 0x602cd4bb
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89404 rows and 36304 columns
Presolve time: 2.21s
Presolved: 110749 rows, 47076 columns, 667769 nonzeros
Variable types: 44817 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -325718.8223
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 667
 AA' NZ     : 3.799e+06
 Factor NZ  : 9.938e+06 (roughly 140 MB of memory)
 Factor Ops : 2.865e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72579785e+07  2.11620559e+08  1.36e+05 1.87e+01  8.42e+04     3s
   1  -1.33652138e+07  1.96653307e+08  9.68e+04 1.08e+02  5.90e+04     3s
   2  -6.45742517e+06  1.56234908e+08  4.67e+04 1.93e+01  2.96e+04     4s
   3  -1.46227106e+06  1.22728361e+08  5.48e+03 1.54e+00  3.93e+03     4s
   4  -7.53728983e+05  6.27738553e+07  7.12e+02 1.93e-01  7.07e+02     4s
   5  -4.72304859e+05  3.25348712e+07  3.56e+02 7.88e-02  3.37e+02     4s
   6  -3.68492346e+05  2.50834787e+07  1.71e+02 5.51e-02  2.03e+02     4s
   7  -2.85568583e+05  1.84199576e+07  8.58e+01 3.70e-02  1.27e+02     4s
   8  -1.66442586e+05  1.26287022e+07  2.24e+01 2.42e-02  7.03e+01     4s
   9  -1.29421261e+05  1.06772889e+07  1.56e+01 2.00e-02  5.78e+01     4s
  10  -1.00647878e+05  5.13416208e+06  1.07e+01 8.86e-03  2.76e+01     4s
  11  -5.37431037e+04  1.77827045e+06  3.39e+00 2.74e-03  9.27e+00     4s
  12  -1.08533875e+04  5.55818338e+05  1.39e+00 8.08e-04  2.83e+00     4s
  13   4.59995537e+03  4.06907895e+05  9.89e-01 6.21e-04  2.00e+00     4s
  14   1.10928945e+04  2.63405287e+05  8.12e-01 1.29e-03  1.26e+00     4s
  15   1.73282241e+04  2.15521450e+05  6.99e-01 8.90e-04  9.86e-01     4s
  16   3.00935024e+04  1.59376795e+05  5.25e-01 9.27e-04  6.42e-01     4s
  17   3.89974307e+04  1.40883803e+05  4.29e-01 1.32e-03  5.06e-01     4s
  18   5.01967375e+04  1.28960710e+05  3.13e-01 2.27e-03  3.91e-01     4s
  19   5.74914650e+04  1.15621653e+05  2.31e-01 1.83e-03  2.88e-01     4s
  20   6.24545110e+04  1.07848755e+05  1.79e-01 1.60e-03  2.25e-01     4s
  21   6.87624904e+04  9.93236102e+04  1.19e-01 1.74e-03  1.52e-01     4s
  22   6.93744387e+04  9.29971318e+04  1.11e-01 1.36e-03  1.17e-01     4s
  23   7.23895381e+04  9.04055302e+04  8.40e-02 1.71e-03  8.94e-02     4s
  24   7.44190004e+04  8.91982322e+04  6.66e-02 1.67e-03  7.33e-02     4s
  25   7.52437707e+04  8.68594830e+04  5.98e-02 1.16e-03  5.76e-02     4s
  26   7.63638226e+04  8.65097858e+04  5.09e-02 1.10e-03  5.03e-02     4s
  27   7.70411487e+04  8.61983514e+04  4.52e-02 9.09e-04  4.54e-02     4s
  28   7.77933560e+04  8.51766435e+04  3.92e-02 1.02e-03  3.66e-02     4s
  29   7.92645470e+04  8.48005643e+04  2.74e-02 9.63e-04  2.75e-02     5s
  30   8.01089101e+04  8.43469569e+04  2.07e-02 8.98e-04  2.10e-02     5s
  31   8.08689045e+04  8.39068732e+04  1.49e-02 7.62e-04  1.51e-02     5s
  32   8.13605082e+04  8.35303404e+04  1.12e-02 5.54e-04  1.08e-02     5s
  33   8.15581826e+04  8.33719555e+04  9.74e-03 4.98e-04  9.00e-03     5s
  34   8.20435105e+04  8.32719058e+04  6.32e-03 3.79e-04  6.09e-03     5s
  35   8.22347825e+04  8.32354392e+04  4.95e-03 3.32e-04  4.96e-03     5s
  36   8.23481707e+04  8.31252936e+04  4.13e-03 2.02e-04  3.86e-03     5s
  37   8.24614361e+04  8.30784256e+04  3.28e-03 1.48e-04  3.06e-03     5s
  38   8.25276672e+04  8.30085891e+04  2.82e-03 7.33e-05  2.39e-03     5s
  39   8.26893313e+04  8.29853814e+04  1.67e-03 4.84e-05  1.47e-03     5s
  40   8.27478895e+04  8.29655847e+04  1.26e-03 2.98e-05  1.08e-03     5s
  41   8.27982205e+04  8.29538970e+04  9.16e-04 1.74e-05  7.73e-04     5s
  42   8.28180004e+04  8.29505325e+04  7.79e-04 1.40e-05  6.58e-04     5s
  43   8.28340606e+04  8.29464879e+04  6.72e-04 9.93e-06  5.58e-04     5s
  44   8.29171737e+04  8.29390864e+04  1.15e-04 1.99e-05  1.09e-04     5s
  45   8.29296378e+04  8.29360438e+04  3.11e-05 6.65e-06  3.18e-05     5s
  46   8.29340757e+04  8.29352619e+04  5.03e-06 1.29e-06  5.88e-06     5s
  47   8.29348910e+04  8.29350463e+04  7.04e-07 8.34e-08  7.70e-07     5s
  48   8.29350114e+04  8.29350322e+04  7.67e-08 3.49e-08  1.03e-07     5s
  49   8.29350271e+04  8.29350277e+04  3.23e-09 1.13e-10  2.78e-09     5s

Barrier solved model in 49 iterations and 5.43 seconds (9.43 work units)
Optimal objective 8.29350271e+04


Root crossover log...

   96328 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

   17102 PPushes remaining with PInf 6.9022458e-05                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.1217777e+03      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   61213    8.2935028e+04   0.000000e+00   4.121778e+03      9s
   61466    8.2935028e+04   0.000000e+00   0.000000e+00      9s
   61466    8.2935028e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.75s

Solved with barrier

Root relaxation: objective 8.293503e+04, 61466 iterations, 7.56 seconds (16.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82935.0275    0  191 -183060.80 82935.0275   145%     -   10s
H    0     0                    -178427.0846 82935.0275   146%     -   11s
H    0     0                    -151213.3814 82935.0275   155%     -   11s
H    0     0                    -146626.9742 82935.0275   157%     -   11s
H    0     0                    -146404.3325 82935.0275   157%     -   11s
H    0     0                    -145020.0222 82935.0275   157%     -   11s
H    0     0                    -144880.2434 82935.0275   157%     -   11s
H    0     0                    -144797.3152 82935.0275   157%     -   11s
H    0     0                    -56879.75761 82935.0275   246%     -   11s
H    0     0                    -56504.21940 82935.0275   247%     -   12s
H    0     0                    13914.528707 82935.0275   496%     -   12s
H    0     0                    29244.544211 82935.0275   184%     -   12s
H    0     0                    31366.016619 82935.0275   164%     -   12s
H    0     0                    31381.055965 82935.0275   164%     -   12s
H    0     0                    31566.317531 82935.0275   163%     -   12s
H    0     0                    31905.099207 82935.0275   160%     -   12s
H    0     0                    32109.410741 76595.9325   139%     -   42s
H    0     0                    32244.237782 76595.9325   138%     -   42s
H    0     0                    32374.856942 76595.9325   137%     -   42s
H    0     0                    32548.614285 76595.9325   135%     -   42s
H    0     0                    32729.598926 76595.9325   134%     -   42s
     0     0 76595.9325    0  330 32729.5989 76595.9325   134%     -   42s
     0     0 76206.1634    0  318 32729.5989 76206.1634   133%     -   55s
     0     0 76159.1628    0  323 32729.5989 76159.1628   133%     -   60s
     0     0 76144.2998    0  327 32729.5989 76144.2998   133%     -   61s
     0     0 76133.0453    0  324 32729.5989 76133.0453   133%     -   63s
     0     0 76114.8538    0  322 32729.5989 76114.8538   133%     -   65s
     0     0 76114.8538    0  328 32729.5989 76114.8538   133%     -   67s
     0     0 76114.2581    0  334 32729.5989 76114.2581   133%     -   70s
     0     0 76113.4060    0  328 32729.5989 76113.4060   133%     -   70s
     0     0 76113.3053    0  331 32729.5989 76113.3053   133%     -   71s
     0     0 71354.9001    0  363 32729.5989 71354.9001   118%     -  116s
     0     0 70379.5650    0  442 32729.5989 70379.5650   115%     -  149s
     0     0 70233.1570    0  399 32729.5989 70233.1570   115%     -  159s
     0     0 70182.7436    0  411 32729.5989 70182.7436   114%     -  164s
     0     0 70118.4509    0  431 32729.5989 70118.4509   114%     -  172s
     0     0 70056.1301    0  423 32729.5989 70056.1301   114%     -  178s
     0     0 70040.6828    0  423 32729.5989 70040.6828   114%     -  182s
     0     0 70037.3506    0  431 32729.5989 70037.3506   114%     -  183s
     0     0 70015.1355    0  425 32729.5989 70015.1355   114%     -  187s
     0     0 69946.0608    0  441 32729.5989 69946.0608   114%     -  195s
     0     0 69940.5399    0  437 32729.5989 69940.5399   114%     -  198s
     0     0 69916.4039    0  442 32729.5989 69916.4039   114%     -  201s
     0     0 69882.8408    0  451 32729.5989 69882.8408   114%     -  207s
     0     0 69867.3123    0  447 32729.5989 69867.3123   113%     -  210s
     0     0 69856.0215    0  444 32729.5989 69856.0215   113%     -  213s
     0     0 69855.3011    0  449 32729.5989 69855.3011   113%     -  214s
     0     0 66840.2905    0  444 32729.5989 66840.2905   104%     -  276s
     0     0 66357.3399    0  319 32729.5989 66357.3399   103%     -  300s
H    0     0                    34427.610035 66097.9183  92.0%     -  321s
H    0     0                    35545.357156 66097.9183  86.0%     -  321s
H    0     0                    35649.952951 66097.9183  85.4%     -  321s
H    0     0                    35816.501226 66097.9183  84.5%     -  321s
H    0     0                    35839.723954 66097.9183  84.4%     -  321s
     0     0 66097.9183    0  342 35839.7240 66097.9183  84.4%     -  321s
     0     0 66003.9842    0  350 35839.7240 66003.9842  84.2%     -  330s
     0     0 65966.8998    0  339 35839.7240 65966.8998  84.1%     -  337s
     0     0 65920.0659    0  340 35839.7240 65920.0659  83.9%     -  347s
     0     0 65893.0958    0  337 35839.7240 65893.0958  83.9%     -  353s
H    0     0                    36861.708602 65872.5430  78.7%     -  360s
H    0     0                    37433.193878 65872.5430  76.0%     -  360s
H    0     0                    37550.460301 65872.5430  75.4%     -  360s
     0     0 65872.5430    0  415 37550.4603 65872.5430  75.4%     -  360s
     0     0 65861.4976    0  361 37550.4603 65861.4976  75.4%     -  365s
     0     0 65852.1401    0  451 37550.4603 65852.1401  75.4%     -  369s
     0     0 65846.6184    0  363 37550.4603 65846.6184  75.4%     -  371s
     0     0 65838.5068    0  337 37550.4603 65838.5068  75.3%     -  376s
H    0     0                    37896.211958 65831.7482  73.7%     -  379s
H    0     0                    37901.686194 65831.7482  73.7%     -  379s
     0     0 65831.7482    0  452 37901.6862 65831.7482  73.7%     -  379s
H    0     0                    37907.919351 65822.6904  73.6%     -  382s
     0     0 65822.6904    0  492 37907.9194 65822.6904  73.6%     -  382s
     0     0 65816.9241    0  368 37907.9194 65816.9241  73.6%     -  384s
     0     0 65814.2742    0  367 37907.9194 65814.2742  73.6%     -  385s
     0     0 65811.3278    0  375 37907.9194 65811.3278  73.6%     -  386s
H    0     0                    38249.729018 65806.6541  72.0%     -  388s
H    0     0                    38388.905129 65806.6541  71.4%     -  388s
H    0     0                    38389.267138 65806.6541  71.4%     -  388s
H    0     0                    38423.913256 65806.6541  71.3%     -  388s
     0     0 65806.6541    0  363 38423.9133 65806.6541  71.3%     -  388s
     0     0 65806.2626    0  363 38423.9133 65806.2626  71.3%     -  389s
H    0     0                    38437.898200 65267.0159  69.8%     -  420s
H    0     0                    38449.768455 65267.0159  69.7%     -  420s
H    0     0                    38484.426539 65267.0159  69.6%     -  420s
     0     0 65267.0159    0  354 38484.4265 65267.0159  69.6%     -  420s
     0     0 65108.5636    0  503 38484.4265 65108.5636  69.2%     -  440s
     0     0 64984.1451    0  469 38484.4265 64984.1451  68.9%     -  455s
     0     0 64935.0886    0  445 38484.4265 64935.0886  68.7%     -  462s
     0     0 64905.8461    0  499 38484.4265 64905.8461  68.7%     -  469s
     0     0 64901.8244    0  474 38484.4265 64901.8244  68.6%     -  472s
     0     0 64899.4877    0  481 38484.4265 64899.4877  68.6%     -  473s
     0     0 64769.3957    0  365 38484.4265 64769.3957  68.3%     -  487s
     0     0 64701.5767    0  431 38484.4265 64701.5767  68.1%     -  496s
     0     0 64694.2815    0  437 38484.4265 64694.2815  68.1%     -  500s
     0     0 64687.1189    0  352 38484.4265 64687.1189  68.1%     -  503s
     0     0 64684.3034    0  351 38484.4265 64684.3034  68.1%     -  505s
     0     0 64620.4444    0  442 38484.4265 64620.4444  67.9%     -  516s
H    0     0                    38594.792639 64586.2637  67.3%     -  524s
     0     0 64586.2637    0  365 38594.7926 64586.2637  67.3%     -  524s
     0     0 64579.9691    0  492 38594.7926 64579.9691  67.3%     -  527s
     0     0 64576.1284    0  509 38594.7926 64576.1284  67.3%     -  530s
     0     0 64575.2778    0  467 38594.7926 64575.2778  67.3%     -  532s
     0     0 64548.3220    0  504 38594.7926 64548.3220  67.2%     -  539s
H    0     0                    38668.197774 64536.3788  66.9%     -  544s
     0     0 64536.3788    0  514 38668.1978 64536.3788  66.9%     -  544s
     0     0 64533.1038    0  469 38668.1978 64533.1038  66.9%     -  547s
     0     0 64531.0669    0  510 38668.1978 64531.0669  66.9%     -  550s
     0     0 64488.8743    0  373 38668.1978 64488.8743  66.8%     -  561s
     0     0 64474.5212    0  473 38668.1978 64474.5212  66.7%     -  575s
     0     0 64470.6874    0  367 38668.1978 64470.6874  66.7%     -  578s
     0     0 64469.2424    0  477 38668.1978 64469.2424  66.7%     -  580s
     0     0 64453.5500    0  404 38668.1978 64453.5500  66.7%     -  587s
     0     0 64447.7106    0  364 38668.1978 64447.7106  66.7%     -  590s
     0     0 64444.8081    0  431 38668.1978 64444.8081  66.7%     -  593s
     0     0 64436.8753    0  404 38668.1978 64436.8753  66.6%     -  597s
     0     0 64431.1138    0  373 38668.1978 64431.1138  66.6%     -  604s
     0     0 64430.3065    0  372 38668.1978 64430.3065  66.6%     -  605s
     0     0 64422.2913    0  373 38668.1978 64422.2913  66.6%     -  611s
     0     0 64422.1227    0  373 38668.1978 64422.1227  66.6%     -  613s
H    0     0                    38881.070767 64422.1227  65.7%     -  734s
H    0     2                    39109.007993 64422.1227  64.7%     -  735s
     0     2 64422.1227    0  373 39109.0080 64422.1227  64.7%     -  735s
     1     3 64381.9588    1  373 39109.0080 64422.1227  64.7%  6465  742s
     2     4 64370.7872    1  382 39109.0080 64381.8760  64.6%  8202  751s
     3     5 63596.2590    2  347 39109.0080 64381.8760  64.6% 10012  768s
     4    10 63190.7052    3  415 39109.0080 64381.8760  64.6% 10174  783s
     9    18 62966.4045    4  334 39109.0080 64123.9408  64.0%  9511  813s
    17    36 62812.5514    5  332 39109.0080 64053.3132  63.8% 12334  838s
    35    50 63349.5085    5  366 39109.0080 63845.7922  63.3% 16777  918s
    49    78 62826.5360    6  375 39109.0080 63845.7922  63.3% 19674  966s
    77   144 62814.5360    7  373 39109.0080 63845.7922  63.3% 15699 1009s
   143   231 62641.3328    9  370 39109.0080 63845.7922  63.3% 11658 1051s
H  160   231                    39397.352409 63845.7922  62.1% 10781 1051s
   230   296 62423.2360   14  336 39397.3524 63845.7922  62.1%  9092 1084s
   295   332 62379.3479   15  334 39397.3524 63845.7922  62.1%  8391 1111s
H  312   332                    39447.192347 63845.7922  61.9%  8145 1111s
H  317   332                    39448.265271 63845.7922  61.8%  8112 1111s
   331   370 62184.9181   16  330 39448.2653 63845.7922  61.8%  7984 1145s
   369   420 61981.7765   17  324 39448.2653 63845.7922  61.8%  7736 1175s
   419   463 61786.2426   18  327 39448.2653 63845.7922  61.8%  7493 1205s
   462   487 61604.0069   20  310 39448.2653 63845.7922  61.8%  8013 1233s
   486   515 61327.8231   21  311 39448.2653 63845.7922  61.8%  7971 1263s
H  489   515                    39469.988559 63845.7922  61.8%  7972 1263s
   514   541 61104.5190   22  295 39469.9886 63845.7922  61.8%  7969 1290s
   540   581 60882.6397   23  298 39469.9886 63845.7922  61.8%  8232 1316s
   580   610 59507.5563   24  238 39469.9886 63845.7922  61.8%  8079 1342s
   609   638 57560.0653   25  282 39469.9886 63845.7922  61.8%  7992 1370s
H  613   638                    39688.242671 63845.7922  60.9%  7968 1370s
   637   707 58766.5916   25  246 39688.2427 63845.7922  60.9%  7941 1401s
   706   754 57264.8112   31  285 39688.2427 63845.7922  60.9%  7559 1476s
   753   782 60760.2083   24  296 39688.2427 63845.7922  60.9%  7373 1505s
   781   812 60311.8534   25  297 39688.2427 63845.7922  60.9%  7301 1542s
   811   850 60168.3084   26  409 39688.2427 63845.7922  60.9%  7227 1576s
   849   880 60071.8505   27  381 39688.2427 63845.7922  60.9%  7092 1635s
   879   909 59776.4221   28  295 39688.2427 63845.7922  60.9%  7051 1671s
   908   950 59449.5391   29  453 39688.2427 63845.7922  60.9%  7119 1703s
   949   994 59297.9623   30  445 39688.2427 63845.7922  60.9%  7052 1734s
   993  1032 58901.5527   31  445 39688.2427 63845.7922  60.9%  6961 1779s
  1039  1078 58846.9228   32  451 39688.2427 63845.7922  60.9%  6898 1817s
  1095  1140 58769.2451   33  442 39688.2427 63845.7922  60.9%  6771 1853s
  1157  1218 58542.5550   34  444 39688.2427 63845.7922  60.9%  6697 1890s
  1235  1291 58338.1486   35  467 39688.2427 63845.7922  60.9%  6480 1925s
  1316  1389 58285.0157   36  456 39688.2427 63845.7922  60.9%  6237 1960s
  1428  1445 58130.5195   37  452 39688.2427 63845.7922  60.9%  5955 2004s
  1514  1524 57926.5288   38  478 39688.2427 63845.7922  60.9%  5839 2056s
  1611  1592 56064.4286   39  243 39688.2427 63845.7922  60.9%  5684 2100s
  1716  1615 55653.5683   40  249 39688.2427 63845.7922  60.9%  5519 2142s
  1743  1651 55503.8405   41  254 39688.2427 63845.7922  60.9%  5564 2185s
  1807  1684 55081.3071   42  354 39688.2427 63845.7922  60.9%  5569 2235s
  1882  1718 54639.5184   43  351 39688.2427 63845.7922  60.9%  5562 2285s
  1968  1789 54121.5678   44  353 39688.2427 63845.7922  60.9%  5629 2354s
  2073  1853 52985.6846   49  287 39688.2427 63845.7922  60.9%  5575 2410s
  2183  1966 51863.2089   56  243 39688.2427 63845.7922  60.9%  5583 2470s
  2330  2106 50683.1894   63  267 39688.2427 63665.1915  60.4%  5531 2529s
  2506  2229 50142.1812   69  235 39688.2427 63665.1915  60.4%  5475 2591s
  2669  2368 48918.8111   76  188 39688.2427 63665.1915  60.4%  5429 2657s
  2827  2494 46853.0141   93  136 39688.2427 63461.9015  59.9%  5431 2726s
  2995  2626 infeasible   94      39688.2427 63461.9015  59.9%  5442 2796s
  3163  2805 53800.8683    8  283 39688.2427 63461.9015  59.9%  5416 2869s
  3395  2806 40410.2726   60  373 39688.2427 63461.9015  59.9%  5356 3102s
  3397  2807 59753.2802   29  173 39688.2427 63461.9015  59.9%  5353 3115s
  3398  2808 55493.6276   42  350 39688.2427 63461.9015  59.9%  5351 3194s
  3399  2809 52900.1913   19  359 39688.2427 63461.9015  59.9%  5349 3250s
  3400  2809 49224.3824   74  355 39688.2427 63461.9015  59.9%  5348 3277s
  3401  2810 43339.5218   43  370 39688.2427 63461.9015  59.9%  5346 3306s
  3402  2811 60496.1378   14  354 39688.2427 63461.9015  59.9%  5345 3328s
  3403  2811 57179.6684   33  353 39688.2427 63461.9015  59.9%  5343 3341s
  3404  2812 58422.3985   38  403 39688.2427 63461.9015  59.9%  5342 3354s
  3405  2813 58255.4904   19  442 39688.2427 63461.9015  59.9%  5340 3364s
  3406  2813 60445.0526   19  399 39688.2427 63461.9015  59.9%  5338 3374s
  3407  2814 58612.6861   31  365 39688.2427 63461.9015  59.9%  5337 3379s
  3408  2815 56793.5767    8  369 39688.2427 63461.9015  59.9%  5335 3383s
  3409  2815 54819.9017   44  370 39688.2427 63461.9015  59.9%  5334 3386s
  3411  2817 54648.2901   32  364 39688.2427 63461.9015  59.9%  5331 3392s
  3412  2817 62266.3440    9  430 39688.2427 63461.9015  59.9%  5329 3410s
  3413  2818 55286.2560   42  377 39688.2427 63461.9015  59.9%  5327 3419s
  3414  2819 59313.5515   22  396 39688.2427 63461.9015  59.9%  5326 3422s
  3415  2819 62249.3105    7  408 39688.2427 63461.9015  59.9%  5324 3425s
  3417  2821 47577.0021   28  405 39688.2427 63461.9015  59.9%  5321 3431s
  3418  2821 61574.1961   18  405 39688.2427 63461.9015  59.9%  5320 3446s
  3419  2822 62404.4456    8  446 39688.2427 63461.9015  59.9%  5318 3452s
  3420  2823 46722.3305   59  415 39688.2427 63461.9015  59.9%  5317 3457s
  3421  2823 60054.7123   24  388 39688.2427 63461.9015  59.9%  5315 3461s
  3423  2825 41306.8296   49  409 39688.2427 63461.9015  59.9%  5312 3474s
  3424  2825 62306.7818   11  408 39688.2427 63461.9015  59.9%  5310 3481s
  3425  2826 42758.6411   53  443 39688.2427 63461.9015  59.9%  5309 3485s
  3426  2827 50208.4795   21  370 39688.2427 63461.9015  59.9%  5307 3493s
  3427  2827 62446.9214    7  358 39688.2427 63461.9015  59.9%  5306 3496s
  3429  2829 56793.5767    8  367 39688.2427 63461.9015  59.9%  5303 3512s
  3430  2829 51062.4816   69  392 39688.2427 63461.9015  59.9%  5301 3516s
  3431  2830 48006.9215   24  361 39688.2427 63461.9015  59.9%  5299 3523s
  3432  2831 52384.8815   17  482 39688.2427 63461.9015  59.9%  5298 3534s
  3433  2831 60959.8861   19  409 39688.2427 63461.9015  59.9%  5296 3538s
  3434  2832 60596.1285   16  433 39688.2427 63461.9015  59.9%  5295 3552s
  3435  2833 54684.8908   39  437 39688.2427 63461.9015  59.9%  5293 3558s
  3436  2833 44903.1119   65  435 39688.2427 63461.9015  59.9%  5292 3567s
  3437  2834 41800.2176   73  413 39688.2427 63461.9015  59.9%  5290 3572s
  3438  2835 43116.5792   38  371 39688.2427 63461.9015  59.9%  5289 3576s
  3439  2835 48301.2182   71  438 39688.2427 63461.9015  59.9%  5287 3586s

Cutting planes:
  Learned: 1
  Gomory: 29
  Implied bound: 40
  Projected implied bound: 350
  MIR: 993
  Mixing: 7
  Flow cover: 764
  RLT: 23
  Relax-and-lift: 212

Explored 3439 nodes (19269999 simplex iterations) in 3600.02 seconds (8095.80 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 39688.2 39470 39448.3 ... 38484.4

Time limit reached
Best objective 3.968824267064e+04, best bound 6.346190150197e+04, gap 59.9010%
  WARNING: Time limit reached. Using best solution found (gap: 59.90%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 39688.24, θ = 229159.12
  Upper Bound (UB) = 39688.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 229159.12
  [DEBUG]   ✓ Scenario 0: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 229159.12 ≤ Q = 229159.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 229159.12 ≤ Q = 229159.12 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 229159.12 ≤ Q = 229159.12 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x543ace1c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x543ace1c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.409542e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.00s
Presolved: 508 rows, 514 columns, 1439 nonzeros
Found heuristic solution: objective 6845740.5963
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.732582e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173258.23    0  130 6845740.60 -173258.23   103%     -    0s
H    0     0                    -139470.8246 -173258.23  24.2%     -    0s
H    0     0                    -140136.7257 -173258.23  23.6%     -    0s
     0     0 -150400.31    0   29 -140136.73 -150400.31  7.32%     -    0s
H    0     0                    -149487.5729 -150329.31  0.56%     -    0s
H    0     0                    -149757.4927 -150329.31  0.38%     -    0s
H    0     0                    -149892.6849 -150329.31  0.29%     -    0s
     0     0 -150329.31    0   32 -149892.68 -150329.31  0.29%     -    0s
     0     0 -150329.31    0   24 -149892.68 -150329.31  0.29%     -    0s
     0     0 -150055.36    0    8 -149892.68 -150055.36  0.11%     -    0s
     0     0 -150054.82    0    7 -149892.68 -150054.82  0.11%     -    0s
     0     0 -150013.64    0    6 -149892.68 -150013.64  0.08%     -    0s
*    0     0               0    -149965.0944 -149965.09  0.00%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 1
  MIR: 121
  Flow cover: 7
  RLT: 19

Explored 1 nodes (461 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -149965 -149893 -149488 ... 1.40954e+13
No other solutions better than -149965

Optimal solution found (tolerance 1.00e-06)
Best objective -1.499650943548e+05, best bound -1.499650943548e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 221482.11
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -149965.09
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -149965.09 = 221482.11
  [DEBUG]   Current θ from Master = 229159.12
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7677.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32011.23
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1280.9726, Absolute Gap = 1280.9726, Relative Gap = 0.032276
  Not converged yet (gap = 1280.97 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610837 nonzeros
Model fingerprint: 0xf16503a0
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 96292 rows and 39102 columns
Presolve time: 1.76s
Presolved: 119151 rows, 50518 columns, 732762 nonzeros
Variable types: 48259 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -312480.3870
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.93s

Barrier statistics:
 Dense cols : 700
 AA' NZ     : 4.666e+06
 Factor NZ  : 1.063e+07 (roughly 150 MB of memory)
 Factor Ops : 2.188e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78252174e+07  2.26787486e+08  1.42e+05 1.80e+01  8.66e+04     4s
   1  -1.38795645e+07  2.10731303e+08  1.02e+05 1.05e+02  6.15e+04     4s
   2  -5.66334866e+06  1.69775001e+08  4.15e+04 6.88e-01  2.64e+04     4s
   3  -1.41599078e+06  1.30436834e+08  5.45e+03 8.82e-01  3.91e+03     4s
   4  -7.23591241e+05  6.39530872e+07  7.10e+02 2.54e-01  6.86e+02     4s
   5  -5.55025721e+05  4.15648266e+07  2.96e+02 1.35e-01  3.42e+02     4s
   6  -3.86164328e+05  2.75431903e+07  1.08e+02 8.42e-02  1.77e+02     4s
   7  -3.21848559e+05  1.87591830e+07  5.76e+01 5.36e-02  1.10e+02     4s
   8  -2.53862086e+05  1.27231149e+07  3.65e+01 3.40e-02  7.08e+01     4s
   9  -1.86664249e+05  9.57560647e+06  1.93e+01 2.48e-02  4.97e+01     4s
  10  -1.36913956e+05  6.24737331e+06  1.11e+01 1.54e-02  3.13e+01     4s
  11  -1.10585471e+05  2.43958472e+06  5.11e+00 5.46e-03  1.21e+01     4s
  12  -5.87261161e+04  6.81293965e+05  1.65e+00 1.44e-03  3.45e+00     4s
  13  -1.84158599e+04  3.44444167e+05  7.62e-01 7.47e-04  1.68e+00     4s
  14  -7.17743609e+03  2.75917156e+05  6.42e-01 1.44e-03  1.31e+00     4s
  15   1.26433998e+04  2.29407325e+05  4.69e-01 1.19e-03  1.00e+00     4s
  16   2.20045882e+04  2.00430934e+05  4.12e-01 1.23e-03  8.25e-01     4s
  17   3.27079048e+04  1.70245708e+05  3.40e-01 1.11e-03  6.36e-01     5s
  18   3.92262070e+04  1.44910327e+05  2.88e-01 1.87e-03  4.89e-01     5s
  19   4.29954646e+04  1.37886256e+05  2.59e-01 1.73e-03  4.39e-01     5s
  20   5.12068373e+04  1.27837675e+05  2.06e-01 2.18e-03  3.54e-01     5s
  21   5.62419499e+04  1.17020960e+05  1.69e-01 2.15e-03  2.81e-01     5s
  22   6.43436077e+04  1.07211855e+05  1.08e-01 3.59e-03  1.98e-01     5s
  23   6.85355275e+04  1.03521157e+05  7.78e-02 3.30e-03  1.61e-01     5s
  24   7.05308331e+04  9.56951048e+04  6.31e-02 2.01e-03  1.16e-01     5s
  25   7.12692280e+04  9.40168347e+04  5.84e-02 1.67e-03  1.05e-01     5s
  26   7.34330883e+04  9.19231538e+04  4.51e-02 1.40e-03  8.54e-02     5s
  27   7.44148494e+04  9.06220814e+04  3.96e-02 1.19e-03  7.48e-02     5s
  28   7.57365237e+04  8.80019664e+04  3.21e-02 1.52e-03  5.67e-02     5s
  29   7.60562813e+04  8.74736152e+04  3.05e-02 1.62e-03  5.28e-02     5s
  30   7.63702422e+04  8.72956381e+04  2.86e-02 1.53e-03  5.05e-02     5s
  31   7.68551473e+04  8.62477981e+04  2.61e-02 1.12e-03  4.34e-02     5s
  32   7.76381336e+04  8.60215746e+04  2.20e-02 1.08e-03  3.87e-02     5s
  33   7.87428055e+04  8.53175990e+04  1.63e-02 9.06e-04  3.04e-02     5s
  34   7.91752500e+04  8.45814092e+04  1.42e-02 7.09e-04  2.50e-02     5s
  35   7.95284680e+04  8.43805817e+04  1.25e-02 6.45e-04  2.24e-02     5s
  36   7.98424779e+04  8.38404353e+04  1.10e-02 4.75e-04  1.85e-02     5s
  37   8.05590749e+04  8.33905385e+04  7.58e-03 5.34e-04  1.31e-02     5s
  38   8.09740355e+04  8.31194065e+04  5.65e-03 4.01e-04  9.91e-03     5s
  39   8.10511024e+04  8.29899012e+04  5.28e-03 3.41e-04  8.96e-03     6s
  40   8.13239020e+04  8.26887241e+04  4.04e-03 2.02e-04  6.31e-03     6s
  41   8.15218114e+04  8.25846555e+04  3.15e-03 1.53e-04  4.91e-03     6s
  42   8.15389486e+04  8.24854412e+04  3.07e-03 1.07e-04  4.38e-03     6s
  43   8.16820323e+04  8.24456062e+04  2.43e-03 8.82e-05  3.53e-03     6s
  44   8.18443495e+04  8.23723130e+04  1.72e-03 5.70e-05  2.44e-03     6s
  45   8.18925809e+04  8.23296503e+04  1.51e-03 6.95e-05  2.02e-03     6s
  46   8.19687825e+04  8.23044195e+04  1.18e-03 4.51e-05  1.55e-03     6s
  47   8.20030994e+04  8.22956495e+04  1.03e-03 3.75e-05  1.35e-03     6s
  48   8.21443533e+04  8.22888829e+04  4.36e-04 3.16e-05  6.68e-04     6s
  49   8.21586900e+04  8.22854944e+04  3.78e-04 2.85e-05  5.86e-04     6s
  50   8.21798120e+04  8.22794791e+04  2.92e-04 2.32e-05  4.61e-04     6s
  51   8.21995932e+04  8.22707149e+04  2.05e-04 1.61e-05  3.29e-04     6s
  52   8.22307608e+04  8.22639141e+04  7.77e-05 1.05e-05  1.53e-04     6s
  53   8.22399450e+04  8.22582904e+04  4.15e-05 5.56e-06  8.47e-05     6s
  54   8.22474251e+04  8.22563276e+04  1.38e-05 3.88e-06  4.10e-05     6s
  55   8.22501591e+04  8.22533238e+04  4.69e-06 1.30e-06  1.46e-05     7s
  56   8.22514784e+04  8.22520315e+04  5.46e-07 7.24e-07  2.55e-06     7s
  57   8.22517024e+04  8.22517647e+04  5.96e-09 1.21e-07  2.86e-07     7s
  58   8.22517069e+04  8.22517106e+04  9.87e-09 6.30e-09  1.72e-08     7s
  59   8.22517074e+04  8.22517074e+04  7.96e-10 9.19e-10  1.31e-11     7s

Barrier solved model in 59 iterations and 6.71 seconds (12.27 work units)
Optimal objective 8.22517074e+04


Root crossover log...

  106027 DPushes remaining with DInf 0.0000000e+00                 7s
    1038 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    1341 PPushes remaining with PInf 1.7405737e-06                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.1590892e-10     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48604    8.2251707e+04   0.000000e+00   0.000000e+00     10s
   48604    8.2251707e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 2.29s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.225171e+04, 48604 iterations, 10.44 seconds (19.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82251.7074    0  172 -183060.80 82251.7074   145%     -   13s
H    0     0                    -176011.3193 82251.7074   147%     -   13s
H    0     0                    -173052.1467 82251.7074   148%     -   13s
H    0     0                    -120005.2019 82251.7074   169%     -   13s
H    0     0                    -104655.0631 82251.7074   179%     -   13s
H    0     0                    -104147.6989 82251.7074   179%     -   14s
H    0     0                    -103045.4295 82251.7074   180%     -   14s
H    0     0                    -66782.91050 82251.7074   223%     -   14s
H    0     0                    -18763.35573 82251.7074   538%     -   14s
H    0     0                    -18359.19494 82251.7074   548%     -   14s
H    0     0                    18060.575180 82251.7074   355%     -   14s
H    0     0                    21802.661657 82251.7074   277%     -   15s
H    0     0                    22247.597982 82251.7074   270%     -   15s
H    0     0                    22675.409726 82251.7074   263%     -   15s
H    0     0                    23246.551887 82251.7074   254%     -   15s
H    0     0                    23736.801770 82251.7074   247%     -   15s
H    0     0                    23832.710334 82251.7074   245%     -   15s
H    0     0                    26769.409465 75513.4876   182%     -   58s
H    0     0                    26837.286120 75513.4876   181%     -   58s
H    0     0                    27061.715782 75513.4876   179%     -   58s
     0     0 75212.3770    0  229 27061.7158 75212.3770   178%     -   58s
     0     0 74972.3511    0  227 27061.7158 74972.3511   177%     -   75s
     0     0 74941.5986    0  234 27061.7158 74941.5986   177%     -   80s
     0     0 74870.0476    0  238 27061.7158 74870.0476   177%     -   86s
     0     0 74870.0319    0  234 27061.7158 74870.0319   177%     -   86s
     0     0 74870.0319    0  239 27061.7158 74870.0319   177%     -   97s
     0     0 74870.0319    0  239 27061.7158 74870.0319   177%     -   99s
     0     0 74870.0319    0  238 27061.7158 74870.0319   177%     -  101s
     0     0 74870.0319    0  241 27061.7158 74870.0319   177%     -  105s
     0     0 74870.0319    0  241 27061.7158 74870.0319   177%     -  105s
     0     0 74870.0319    0  238 27061.7158 74870.0319   177%     -  106s
     0     0 74870.0319    0  240 27061.7158 74870.0319   177%     -  107s
     0     0 74870.0319    0  240 27061.7158 74870.0319   177%     -  108s
H    0     0                    27502.039082 70939.8308   158%     -  153s
H    0     0                    29087.785539 70939.8308   144%     -  153s
H    0     0                    29293.297030 70939.8308   142%     -  153s
H    0     0                    29413.634924 70939.8308   141%     -  153s
     0     0 70939.8308    0  276 29413.6349 70939.8308   141%     -  153s
H    0     0                    32418.906723 70939.7656   119%     -  154s
H    0     0                    32627.784481 70939.7656   117%     -  154s
     0     0 70190.5767    0  322 32627.7845 70190.5767   115%     -  183s
     0     0 70012.2313    0  310 32627.7845 70012.2313   115%     -  203s
     0     0 69921.2538    0  312 32627.7845 69921.2538   114%     -  218s
     0     0 69844.6636    0  320 32627.7845 69844.6636   114%     -  228s
     0     0 69764.4842    0  318 32627.7845 69764.4842   114%     -  238s
     0     0 69756.9454    0  318 32627.7845 69756.9454   114%     -  242s
     0     0 69738.3963    0  325 32627.7845 69738.3963   114%     -  245s
     0     0 69671.2385    0  322 32627.7845 69671.2385   114%     -  252s
     0     0 69667.3871    0  323 32627.7845 69667.3871   114%     -  253s
     0     0 69656.8350    0  333 32627.7845 69656.8350   113%     -  256s
     0     0 69655.0176    0  335 32627.7845 69655.0176   113%     -  257s
     0     0 69654.2448    0  331 32627.7845 69654.2448   113%     -  258s
H    0     0                    34169.559176 66838.8394  95.6%     -  315s
H    0     0                    34170.783616 66838.8394  95.6%     -  315s
H    0     0                    34997.218162 66838.8394  91.0%     -  315s
H    0     0                    35294.781992 66838.8394  89.4%     -  315s
H    0     0                    35299.882936 66838.8394  89.3%     -  315s
H    0     0                    36161.226430 66838.8394  84.8%     -  315s
H    0     0                    36190.722270 66838.8394  84.7%     -  315s
H    0     0                    36244.555334 66838.8394  84.4%     -  315s
H    0     0                    36399.536601 66838.8394  83.6%     -  315s
     0     0 66838.8394    0  322 36399.5366 66838.8394  83.6%     -  315s
     0     0 66515.9521    0  334 36399.5366 66515.9521  82.7%     -  337s
     0     0 66448.7904    0  324 36399.5366 66448.7904  82.6%     -  346s
     0     0 66399.8743    0  329 36399.5366 66399.8743  82.4%     -  356s
     0     0 66376.1061    0  337 36399.5366 66376.1061  82.4%     -  360s
     0     0 66374.2729    0  331 36399.5366 66374.2729  82.3%     -  362s
H    0     0                    36561.969358 66374.2729  81.5%     -  373s
H    0     0                    36666.368056 66374.2729  81.0%     -  373s
H    0     0                    36674.891069 66374.2729  81.0%     -  373s
H    0     0                    36690.927617 66374.2729  80.9%     -  373s
     0     0 65211.1692    0  340 36690.9276 65211.1692  77.7%     -  409s
     0     0 65017.0997    0  378 36690.9276 65017.0997  77.2%     -  425s
     0     0 64919.9305    0  402 36690.9276 64919.9305  76.9%     -  437s
     0     0 64902.6448    0  424 36690.9276 64902.6448  76.9%     -  443s
     0     0 64892.2988    0  391 36690.9276 64892.2988  76.9%     -  449s
     0     0 64874.0903    0  390 36690.9276 64874.0903  76.8%     -  455s
     0     0 64856.6933    0  390 36690.9276 64856.6933  76.8%     -  462s
     0     0 64849.2128    0  418 36690.9276 64849.2128  76.7%     -  465s
     0     0 64847.5649    0  409 36690.9276 64847.5649  76.7%     -  466s
     0     0 64677.4375    0  436 36690.9276 64677.4375  76.3%     -  485s
H    0     0                    36829.284637 64677.3989  75.6%     -  486s
H    0     0                    36991.197891 64677.3989  74.8%     -  486s
H    0     0                    37004.139898 64677.3989  74.8%     -  486s
     0     0 64654.8506    0  427 37004.1399 64654.8506  74.7%     -  495s
     0     0 64642.0427    0  365 37004.1399 64642.0427  74.7%     -  499s
     0     0 64636.5257    0  391 37004.1399 64636.5257  74.7%     -  502s
     0     0 64634.5968    0  399 37004.1399 64634.5968  74.7%     -  504s
     0     0 64499.3832    0  374 37004.1399 64499.3832  74.3%     -  522s
H    0     0                    37050.543196 64499.3785  74.1%     -  526s
     0     0 64460.2382    0  362 37050.5432 64460.2382  74.0%     -  531s
     0     0 64453.8026    0  377 37050.5432 64453.8026  74.0%     -  534s
     0     0 64450.5717    0  375 37050.5432 64450.5717  74.0%     -  535s
     0     0 64449.1734    0  377 37050.5432 64449.1734  73.9%     -  536s
     0     0 64369.6349    0  379 37050.5432 64369.6349  73.7%     -  545s
H    0     0                    37273.948025 64369.3067  72.7%     -  545s
H    0     0                    37376.216077 64369.3067  72.2%     -  545s
H    0     0                    37397.497195 64369.3067  72.1%     -  545s
H    0     0                    37626.466970 64369.3067  71.1%     -  545s
     0     0 64353.5173    0  405 37626.4670 64353.5173  71.0%     -  550s
     0     0 64349.6758    0  406 37626.4670 64349.6758  71.0%     -  552s
     0     0 64347.0967    0  451 37626.4670 64347.0967  71.0%     -  553s
     0     0 64342.6106    0  461 37626.4670 64342.6106  71.0%     -  556s
     0     0 64341.1754    0  467 37626.4670 64341.1754  71.0%     -  559s
     0     0 64314.3195    0  455 37626.4670 64314.3195  70.9%     -  565s
     0     0 64308.5207    0  460 37626.4670 64308.5207  70.9%     -  568s
     0     0 64307.2083    0  463 37626.4670 64307.2083  70.9%     -  569s
     0     0 64298.9374    0  431 37626.4670 64298.9374  70.9%     -  573s
     0     0 64287.5566    0  433 37626.4670 64287.5566  70.9%     -  578s
     0     0 64285.3859    0  424 37626.4670 64285.3859  70.9%     -  580s
     0     0 64281.6975    0  383 37626.4670 64281.6975  70.8%     -  584s
     0     0 64280.3177    0  385 37626.4670 64280.3177  70.8%     -  592s
     0     0 64277.0556    0  430 37626.4670 64277.0556  70.8%     -  600s
H    0     0                    37631.554530 64276.7044  70.8%     -  601s
     0     0 64276.0054    0  435 37631.5545 64276.0054  70.8%     -  603s
     0     0 64272.6840    0  374 37631.5545 64272.6840  70.8%     -  607s
     0     0 64272.6553    0  374 37631.5545 64272.6553  70.8%     -  610s
H    0     0                    38406.069115 64272.3648  67.3%     -  721s
     0     2 64272.3648    0  374 38406.0691 64272.3648  67.3%     -  739s
     1     4 64227.3764    1  401 38406.0691 64272.3648  67.3%  3437  749s
     3     8 64213.7143    2  402 38406.0691 64227.2900  67.2%  6210  762s
     7    13 63808.7154    3  399 38406.0691 64213.6040  67.2%  8182  798s
    12    23 63659.1709    4  394 38406.0691 64168.9470  67.1% 13220  847s
    22    33 61527.8854    5  334 38406.0691 63682.6853  65.8% 19627  954s
H   32    61                    38823.071945 63682.6853  64.0% 20799 1125s
H   33    61                    38894.076100 63682.6853  63.7% 20816 1125s
H   37    61                    39411.323226 63682.6853  61.6% 20637 1125s
    60    93 59258.4337    6  283 39411.3232 63682.6853  61.6% 26830 1181s
    92   182 59242.8172    7  278 39411.3232 63682.6853  61.6% 21967 1386s
   181   299 58691.3620    9  268 39411.3232 63682.6853  61.6% 14065 1441s
   298   368 57036.7653   16  246 39411.3232 63682.6853  61.6% 10589 1475s
   367   451 57235.1086   12  244 39411.3232 63682.6853  61.6%  9635 1511s
   450   517 57147.2276   13  244 39411.3232 63682.6853  61.6%  8810 1546s
   516   573 56165.4471   16  221 39411.3232 63682.6853  61.6%  8385 1574s
   572   603 56156.8650   17  221 39411.3232 63682.6853  61.6%  8283 1607s
   602   639 56043.2572   18  215 39411.3232 63682.6853  61.6%  8441 1677s
   638   676 54353.1149   19  226 39411.3232 63682.6853  61.6%  8659 1712s
   675   714 53970.0688   20  222 39411.3232 63682.6853  61.6%  8908 1737s
   713   754 53693.0097   21  217 39411.3232 63682.6853  61.6%  8903 1764s
   753   793 53035.1092   22  192 39411.3232 63682.6853  61.6%  8943 1789s
   794   841 52280.5123   23  183 39411.3232 63682.6853  61.6%  8888 1815s
   844   898 52166.6207   24  187 39411.3232 63682.6853  61.6%  8814 1844s
   903   947 51912.3109   25  189 39411.3232 63682.6853  61.6%  8697 1869s
   956  1001 51796.0605   26  186 39411.3232 63682.6853  61.6%  8569 1896s
  1010  1033 51598.8229   27  187 39411.3232 63682.6853  61.6%  8573 1919s
  1042  1062 51523.3915   28  187 39411.3232 63682.6853  61.6%  8578 1948s
  1075  1102 51510.4479   29  183 39411.3232 63682.6853  61.6%  8577 1970s
  1115  1151 51419.6743   30  176 39411.3232 63682.6853  61.6%  8502 1998s
H 1137  1151                    39431.285244 63682.6853  61.5%  8464 1998s
  1164  1266 49380.6236   31  155 39431.2852 63682.6853  61.5%  8418 2032s
  1284  1384 47026.8689   38  126 39431.2852 63682.6853  61.5%  8270 2067s
  1410  1495 44312.1376   47  114 39431.2852 63682.6853  61.5%  8098 2103s
  1555  1585 50287.2983   84  179 39431.2852 63682.6853  61.5%  7856 2142s
  1697  1675 47639.3167   94   71 39431.2852 63682.6853  61.5%  7716 2182s
  1845  1811     cutoff  101      39431.2852 63682.6853  61.5%  7613 2226s
  2015  1991 61167.8681   10  354 39431.2852 63682.6853  61.5%  7346 2269s
  2225  2020 60714.7413   13  402 39431.2852 63682.5514  61.5%  7017 2301s
  2256  2080 59511.4135   14  379 39431.2852 63682.5514  61.5%  7071 2335s
  2336  2183 58631.4633   15  364 39431.2852 63682.5514  61.5%  7010 2370s
  2543  2301 58179.7211   16  346 39431.2852 63682.5514  61.5%  6677 2408s
  2747  2406 56724.1961   17  349 39431.2852 63682.5514  61.5%  6488 2449s
  2945  2500 56253.3326   18  359 39431.2852 63682.5514  61.5%  6287 2490s
  3088  2575 55112.6192   20  323 39431.2852 63682.5514  61.5%  6303 2542s
  3227  2671 54855.6819   23  328 39431.2852 63682.5514  61.5%  6383 2593s
  3327  2710 48750.3890   26  227 39431.2852 63682.5514  61.5%  6535 2639s
  3370  2778 48649.9309   27  240 39431.2852 63682.5514  61.5%  6634 2684s
  3448  2866 48586.1950   28  204 39431.2852 63682.5514  61.5%  6714 2731s
  3555  2867 54782.4846   15  374 39431.2852 63682.5514  61.5%  6754 2933s
  3557  2868 39871.5794   69  152 39431.2852 63682.5514  61.5%  6750 2950s
  3558  2869 42274.2334   84  270 39431.2852 63682.5514  61.5%  6748 3016s
  3559  2870 53385.5650   23  276 39431.2852 63682.5514  61.5%  6746 3073s
  3560  2870 50534.2808   82  359 39431.2852 63682.5514  61.5%  6744 3107s
  3561  2871 48925.6214   18  333 39431.2852 63682.5514  61.5%  6742 3134s
  3562  2872 51710.9965   48  341 39431.2852 63682.5514  61.5%  6740 3154s
  3563  2872 40837.2519   35  380 39431.2852 63682.5514  61.5%  6738 3169s
  3564  2873 49981.6838   62  361 39431.2852 63682.5514  61.5%  6737 3186s
  3565  2874 55441.5419   33  417 39431.2852 63682.5514  61.5%  6735 3208s
  3566  2874 53026.7118   18  400 39431.2852 63682.5514  61.5%  6733 3216s
  3567  2875 43623.2540   40  388 39431.2852 63682.5514  61.5%  6731 3221s
  3568  2876 60995.6090   17  371 39431.2852 63682.5514  61.5%  6729 3225s
  3570  2877 49040.9424   54  365 39431.2852 63682.5514  61.5%  6725 3233s
  3571  2878 43747.3841   54  370 39431.2852 63682.5514  61.5%  6723 3235s
  3573  2879 60124.2230   17  395 39431.2852 63682.5514  61.5%  6720 3252s
  3574  2880 55633.2995   33  363 39431.2852 63682.5514  61.5%  6718 3258s
  3575  2880 52314.2123   39  411 39431.2852 63682.5514  61.5%  6716 3261s
  3577  2882 58785.7467   12  407 39431.2852 63682.5514  61.5%  6712 3268s
  3578  2882 42275.8068  123  365 39431.2852 63682.5514  61.5%  6710 3277s
  3579  2883 59388.6203   20  373 39431.2852 63682.5514  61.5%  6708 3282s
  3580  2884 50816.5325   45  360 39431.2852 63682.5514  61.5%  6706 3286s
  3581  2884 48963.2336   40  351 39431.2852 63682.5514  61.5%  6705 3311s
  3582  2885 52278.5995   47  390 39431.2852 63682.5514  61.5%  6703 3325s
  3583  2886 54777.7062   21  408 39431.2852 63682.5514  61.5%  6701 3333s
  3584  2886 43503.4497   58  406 39431.2852 63682.5514  61.5%  6699 3338s
  3585  2887 43006.8210  117  402 39431.2852 63682.5514  61.5%  6697 3354s
  3586  2888 43724.5370   42  446 39431.2852 63682.5514  61.5%  6695 3367s
  3587  2888 60854.4251   16  413 39431.2852 63682.5514  61.5%  6693 3372s
  3588  2889 52406.3323   38  415 39431.2852 63682.5514  61.5%  6691 3376s
  3590  2890 47948.4442   75  416 39431.2852 63682.5514  61.5%  6688 3407s
  3591  2891 41828.1628   70  414 39431.2852 63682.5514  61.5%  6686 3424s
  3592  2892 46899.5839   60  417 39431.2852 63682.5514  61.5%  6684 3434s
  3593  2892 55441.5419   33  422 39431.2852 63682.5514  61.5%  6682 3440s
  3595  2894 55939.0893   27  416 39431.2852 63682.5514  61.5%  6678 3462s
  3596  2894 44891.6387  109  398 39431.2852 63646.3985  61.4%  6677 3475s
  3597  2895 54783.6061   57  457 39431.2852 63620.8612  61.3%  6675 3485s
  3598  2896 48734.5185   40  454 39431.2852 63614.0087  61.3%  6673 3490s
  3599  2896 53808.8587   46  457 39431.2852 63609.4151  61.3%  6671 3495s
  3601  2898 56371.0589   16  483 39431.2852 63582.8026  61.2%  6667 3520s
  3602  2898 57493.8845   15  469 39431.2852 63579.9874  61.2%  6665 3526s
  3603  2899 56213.7331   19  473 39431.2852 63573.2271  61.2%  6664 3532s
  3604  2900 41858.8229   56  463 39431.2852 63570.7055  61.2%  6662 3540s
  3605  2900 46326.8330   49  434 39431.2852 63538.2285  61.1%  6660 3557s
  3606  2901 60070.3310   13  484 39431.2852 63538.2285  61.1%  6658 3564s
  3607  2902 59014.9808   26  477 39431.2852 63537.1893  61.1%  6656 3572s
  3608  2902 60810.1133   14  441 39431.2852 63521.4048  61.1%  6654 3588s
  3609  2903 58863.6340   27  479 39431.2852 63521.4048  61.1%  6653 3597s

Cutting planes:
  Gomory: 28
  Implied bound: 26
  Projected implied bound: 235
  MIR: 1166
  Mixing: 4
  Flow cover: 926
  RLT: 16
  Relax-and-lift: 229

Explored 3609 nodes (25021337 simplex iterations) in 3600.05 seconds (7953.19 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 39431.3 39411.3 38894.1 ... 37273.9

Time limit reached
Best objective 3.943128524409e+04, best bound 6.352140482962e+04, gap 61.0939%
  WARNING: Time limit reached. Using best solution found (gap: 61.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 39431.29, θ = 228357.98
  Upper Bound (UB) = 39431.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228357.98
  [DEBUG]   ✓ Scenario 0: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 228357.98 ≤ Q = 228580.46 (slack: 222.48)
  [DEBUG]   ✓ Scenario 13: θ = 228357.98 ≤ Q = 228357.98 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x74cdb118
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x74cdb118
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-14, 2e+02]
Found heuristic solution: objective 1.408157e+13
Presolve removed 2584 rows and 1874 columns
Presolve time: 0.00s
Presolved: 509 rows, 515 columns, 1438 nonzeros
Found heuristic solution: objective 6800762.1751
Variable types: 351 continuous, 164 integer (164 binary)

Root relaxation: objective -1.743162e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174316.16    0  131 6800762.18 -174316.16   103%     -    0s
H    0     0                    -138531.1914 -174316.16  25.8%     -    0s
H    0     0                    -138962.9646 -174316.16  25.4%     -    0s
H    0     0                    -143036.9018 -158226.44  10.6%     -    0s
H    0     0                    -148930.4013 -158226.44  6.24%     -    0s
     0     0 -158226.44    0   68 -148930.40 -158226.44  6.24%     -    0s
H    0     0                    -156375.3496 -158119.44  1.12%     -    0s
     0     0 -158111.84    0   65 -156375.35 -158111.84  1.11%     -    0s
     0     0 -157037.69    0   42 -156375.35 -157037.69  0.42%     -    0s
H    0     0                    -156724.0622 -157037.69  0.20%     -    0s
     0     0 -157003.79    0   38 -156724.06 -157003.79  0.18%     -    0s
     0     0 -156978.55    0   20 -156724.06 -156978.55  0.16%     -    0s
     0     0 -156977.08    0   19 -156724.06 -156977.08  0.16%     -    0s
     0     0 -156910.19    0   16 -156724.06 -156910.19  0.12%     -    0s
     0     0 -156909.19    0   21 -156724.06 -156909.19  0.12%     -    0s
     0     0 -156855.18    0    9 -156724.06 -156855.18  0.08%     -    0s
     0     0 -156855.18    0   22 -156724.06 -156855.18  0.08%     -    0s
H    0     0                    -156750.3685 -156855.18  0.07%     -    0s
     0     0 -156823.88    0    5 -156750.37 -156823.88  0.05%     -    0s
     0     0 -156802.47    0    3 -156750.37 -156802.47  0.03%     -    0s
H    0     0                    -156784.1882 -156802.47  0.01%     -    0s
     0     0 -156802.47    0    3 -156784.19 -156802.47  0.01%     -    0s
*    0     0               0    -156789.7160 -156789.72  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 14
  Flow cover: 12

Explored 1 nodes (711 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -156790 -156784 -156750 ... -138531
No other solutions better than -156790

Optimal solution found (tolerance 1.00e-06)
Best objective -1.567897159822e+05, best bound -1.567897159822e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 214657.48
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -156789.72
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -156789.72 = 214657.48
  [DEBUG]   Current θ from Master = 228357.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13700.49 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25730.79
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1024.0152, Absolute Gap = 1024.0152, Relative Gap = 0.025970
  Not converged yet (gap = 1024.02 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654074 nonzeros
Model fingerprint: 0x5000bafd
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 103160 rows and 41890 columns
Presolve time: 1.74s
Presolved: 127573 rows, 53970 columns, 785107 nonzeros
Variable types: 51711 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -311899.6497
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 703
 AA' NZ     : 5.244e+06
 Factor NZ  : 1.216e+07 (roughly 170 MB of memory)
 Factor Ops : 2.761e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.82435821e+07  2.40866286e+08  1.45e+05 1.74e+01  8.82e+04     3s
   1  -1.42370862e+07  2.24758513e+08  1.05e+05 1.04e+02  6.27e+04     3s
   2  -4.52384686e+06  1.80634841e+08  3.30e+04 7.49e-01  2.12e+04     3s
   3  -1.05080433e+06  1.28951650e+08  3.59e+03 1.01e+00  2.74e+03     3s
   4  -5.96900859e+05  5.27635469e+07  5.64e+02 2.38e-01  5.33e+02     3s
   5  -4.67830142e+05  3.52299105e+07  2.72e+02 1.41e-01  2.88e+02     3s
   6  -3.58627886e+05  2.83078871e+07  1.25e+02 1.07e-01  1.81e+02     3s
   7  -2.97953978e+05  1.96447957e+07  6.33e+01 7.00e-02  1.11e+02     3s
   8  -2.10505183e+05  1.29554163e+07  2.85e+01 4.25e-02  6.55e+01     4s
   9  -1.69264285e+05  9.42356140e+06  2.00e+01 2.96e-02  4.62e+01     4s
  10  -1.36219931e+05  4.27343902e+06  1.29e+01 1.20e-02  2.07e+01     4s
  11  -8.66692161e+04  1.08936734e+06  4.80e+00 2.57e-03  5.28e+00     4s
  12  -4.06953265e+04  4.64269238e+05  1.57e+00 1.10e-03  2.21e+00     4s
  13  -1.76528271e+04  2.68801061e+05  9.64e-01 9.34e-04  1.25e+00     4s
  14  -3.74754278e+03  2.08611877e+05  7.55e-01 1.76e-03  9.23e-01     4s
  15   1.58643983e+04  1.75540633e+05  5.71e-01 3.12e-03  6.93e-01     4s
  16   2.92450836e+04  1.49362298e+05  4.60e-01 4.43e-03  5.21e-01     4s
  17   3.22723758e+04  1.38776919e+05  4.33e-01 3.80e-03  4.63e-01     4s
  18   4.60313794e+04  1.24433566e+05  3.06e-01 3.07e-03  3.40e-01     4s
  19   4.82548582e+04  1.18846121e+05  2.85e-01 2.79e-03  3.06e-01     4s
  20   5.25274498e+04  1.10913517e+05  2.46e-01 3.60e-03  2.53e-01     4s
  21   6.24437385e+04  1.02448085e+05  1.57e-01 4.52e-03  1.73e-01     4s
  22   6.51843935e+04  9.82653851e+04  1.33e-01 4.50e-03  1.43e-01     4s
  23   6.86391401e+04  9.54858318e+04  1.04e-01 4.39e-03  1.16e-01     4s
  24   6.91469430e+04  9.19847043e+04  9.82e-02 3.43e-03  9.91e-02     4s
  25   7.18100500e+04  9.00518424e+04  7.60e-02 3.04e-03  7.91e-02     4s
  26   7.34242712e+04  8.91792839e+04  6.39e-02 2.58e-03  6.83e-02     4s
  27   7.44728059e+04  8.74286449e+04  5.61e-02 2.06e-03  5.62e-02     4s
  28   7.55464306e+04  8.64533142e+04  4.84e-02 1.84e-03  4.73e-02     4s
  29   7.58745781e+04  8.60065595e+04  4.59e-02 1.61e-03  4.40e-02     5s
  30   7.72303044e+04  8.56519286e+04  3.63e-02 1.69e-03  3.65e-02     5s
  31   7.80188321e+04  8.52070395e+04  3.09e-02 1.40e-03  3.12e-02     5s
  32   7.92608343e+04  8.45085527e+04  2.21e-02 1.19e-03  2.28e-02     5s
  33   7.95220760e+04  8.41059307e+04  2.03e-02 1.19e-03  1.99e-02     5s
  34   8.03122783e+04  8.38130736e+04  1.51e-02 1.07e-03  1.52e-02     5s
  35   8.06849424e+04  8.33375047e+04  1.26e-02 6.35e-04  1.15e-02     5s
  36   8.14012896e+04  8.32521956e+04  8.12e-03 5.71e-04  8.03e-03     5s
  37   8.15511149e+04  8.31358916e+04  7.19e-03 4.49e-04  6.88e-03     5s
  38   8.17733196e+04  8.30398046e+04  5.72e-03 3.50e-04  5.50e-03     5s
  39   8.19826145e+04  8.29814251e+04  4.35e-03 2.87e-04  4.33e-03     5s
  40   8.21319610e+04  8.29381849e+04  3.41e-03 2.40e-04  3.50e-03     5s
  41   8.22862896e+04  8.28269151e+04  2.50e-03 1.17e-04  2.35e-03     5s
  42   8.24875798e+04  8.27836091e+04  1.28e-03 7.16e-05  1.28e-03     5s
  43   8.25994404e+04  8.27445951e+04  6.35e-04 3.21e-05  6.30e-04     5s
  44   8.26626039e+04  8.27345604e+04  2.65e-04 2.26e-05  3.12e-04     5s
  45   8.26840209e+04  8.27160190e+04  1.44e-04 8.10e-06  1.39e-04     5s
  46   8.27073864e+04  8.27124924e+04  1.65e-05 1.70e-06  2.21e-05     5s
  47   8.27103119e+04  8.27111846e+04  3.46e-06 7.73e-08  3.78e-06     5s
  48   8.27111231e+04  8.27111233e+04  5.98e-10 1.48e-09  9.49e-10     6s

Barrier solved model in 48 iterations and 5.54 seconds (10.92 work units)
Optimal objective 8.27111231e+04


Root crossover log...

  112841 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    4930 PPushes remaining with PInf 4.5067320e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.5499386e+01      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56729    8.2711123e+04   0.000000e+00   4.549939e+01      9s
   56733    8.2711123e+04   0.000000e+00   0.000000e+00      9s
   56733    8.2711123e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 1.63s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.271112e+04, 56733 iterations, 7.96 seconds (16.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82711.1233    0  163 -183060.80 82711.1233   145%     -   10s
H    0     0                    -176942.4595 82711.1233   147%     -   10s
H    0     0                    -115238.4824 82711.1233   172%     -   11s
H    0     0                    -114831.1904 82711.1233   172%     -   12s
H    0     0                    -109224.3661 82711.1233   176%     -   12s
H    0     0                    -108939.4116 82711.1233   176%     -   12s
H    0     0                    -66782.91050 82711.1233   224%     -   12s
H    0     0                    13389.732950 82711.1233   518%     -   12s
H    0     0                    17489.722922 82711.1233   373%     -   13s
H    0     0                    23709.484300 82711.1233   249%     -   13s
H    0     0                    23736.801770 82711.1233   248%     -   13s
H    0     0                    23832.710334 82711.1233   247%     -   13s
     0     0 75455.8132    0  223 23832.7103 75455.8132   217%     -   47s
     0     0 74784.9691    0  195 23832.7103 74784.9691   214%     -   60s
     0     0 74675.8118    0  195 23832.7103 74675.8118   213%     -   68s
     0     0 74603.4447    0  190 23832.7103 74603.4447   213%     -   73s
     0     0 74603.4447    0  201 23832.7103 74603.4447   213%     -   77s
     0     0 74603.4447    0  193 23832.7103 74603.4447   213%     -   82s
     0     0 74603.4447    0  194 23832.7103 74603.4447   213%     -   83s
     0     0 74603.4447    0  192 23832.7103 74603.4447   213%     -   85s
     0     0 74597.3378    0  192 23832.7103 74597.3378   213%     -   86s
     0     0 74593.2742    0  194 23832.7103 74593.2742   213%     -   88s
     0     0 74591.8201    0  196 23832.7103 74591.8201   213%     -   88s
     0     0 74584.3160    0  196 23832.7103 74584.3160   213%     -   89s
     0     0 74584.2283    0  197 23832.7103 74584.2283   213%     -   89s
     0     0 70653.5658    0  291 23832.7103 70653.5658   196%     -  146s
H    0     0                    32530.677825 70653.5166   117%     -  147s
     0     0 70110.0416    0  261 32530.6778 70110.0416   116%     -  168s
H    0     0                    35014.386614 69703.7092  99.1%     -  188s
H    0     0                    36053.049424 69703.7092  93.3%     -  188s
     0     0 69703.7092    0  340 36053.0494 69703.7092  93.3%     -  188s
     0     0 69601.7879    0  343 36053.0494 69601.7879  93.1%     -  199s
     0     0 69563.7246    0  342 36053.0494 69563.7246  92.9%     -  206s
     0     0 69543.9555    0  355 36053.0494 69543.9555  92.9%     -  212s
     0     0 69495.4995    0  349 36053.0494 69495.4995  92.8%     -  221s
     0     0 69466.3789    0  353 36053.0494 69466.3789  92.7%     -  225s
     0     0 69457.2686    0  349 36053.0494 69457.2686  92.7%     -  228s
     0     0 69455.0194    0  356 36053.0494 69455.0194  92.6%     -  230s
     0     0 69453.6540    0  350 36053.0494 69453.6540  92.6%     -  231s
     0     0 67122.1723    0  307 36053.0494 67122.1723  86.2%     -  277s
H    0     0                    36289.922939 67122.1531  85.0%     -  278s
H    0     0                    36630.052162 67122.1531  83.2%     -  278s
H    0     0                    36711.801716 67122.1531  82.8%     -  278s
H    0     0                    36834.190783 67122.1531  82.2%     -  278s
H    0     0                    36904.089824 67122.1531  81.9%     -  278s
H    0     0                    37159.466535 67122.1531  80.6%     -  278s
     0     0 66567.0723    0  315 37159.4665 66567.0723  79.1%     -  299s
     0     0 66346.8858    0  320 37159.4665 66346.8858  78.5%     -  313s
     0     0 66132.5754    0  359 37159.4665 66132.5754  78.0%     -  327s
     0     0 66100.0846    0  324 37159.4665 66100.0846  77.9%     -  333s
     0     0 66053.5679    0  325 37159.4665 66053.5679  77.8%     -  338s
     0     0 66014.5741    0  338 37159.4665 66014.5741  77.7%     -  342s
     0     0 65980.8723    0  323 37159.4665 65980.8723  77.6%     -  347s
     0     0 65966.6142    0  363 37159.4665 65966.6142  77.5%     -  351s
     0     0 65924.6392    0  324 37159.4665 65924.6392  77.4%     -  355s
     0     0 65901.4456    0  320 37159.4665 65901.4456  77.3%     -  357s
     0     0 65896.6957    0  330 37159.4665 65896.6957  77.3%     -  360s
     0     0 65861.3231    0  328 37159.4665 65861.3231  77.2%     -  365s
     0     0 65835.9610    0  329 37159.4665 65835.9610  77.2%     -  369s
     0     0 65825.9282    0  347 37159.4665 65825.9282  77.1%     -  374s
     0     0 65819.3848    0  337 37159.4665 65819.3848  77.1%     -  376s
     0     0 65805.3015    0  347 37159.4665 65805.3015  77.1%     -  378s
     0     0 65773.6943    0  340 37159.4665 65773.6943  77.0%     -  384s
     0     0 65769.0931    0  334 37159.4665 65769.0931  77.0%     -  386s
     0     0 65767.8359    0  335 37159.4665 65767.8359  77.0%     -  387s
     0     0 65105.0919    0  387 37159.4665 65105.0919  75.2%     -  418s
     0     0 64932.0591    0  355 37159.4665 64932.0591  74.7%     -  432s
     0     0 64883.4983    0  359 37159.4665 64883.4983  74.6%     -  437s
     0     0 64805.3673    0  368 37159.4665 64805.3673  74.4%     -  445s
     0     0 64797.3687    0  365 37159.4665 64797.3687  74.4%     -  447s
     0     0 64780.4055    0  355 37159.4665 64780.4055  74.3%     -  452s
     0     0 64748.2092    0  359 37159.4665 64748.2092  74.2%     -  457s
     0     0 64737.9497    0  395 37159.4665 64737.9497  74.2%     -  460s
     0     0 64731.9262    0  405 37159.4665 64731.9262  74.2%     -  462s
     0     0 64728.3851    0  355 37159.4665 64728.3851  74.2%     -  464s
     0     0 64727.4284    0  400 37159.4665 64727.4284  74.2%     -  465s
     0     0 64608.7123    0  394 37159.4665 64608.7123  73.9%     -  480s
     0     0 64595.9515    0  395 37159.4665 64595.9515  73.8%     -  486s
     0     0 64589.0766    0  376 37159.4665 64589.0766  73.8%     -  489s
     0     0 64585.6545    0  383 37159.4665 64585.6545  73.8%     -  492s
     0     0 64582.4803    0  428 37159.4665 64582.4803  73.8%     -  494s
     0     0 64581.3510    0  433 37159.4665 64581.3510  73.8%     -  495s
     0     0 64507.7683    0  375 37159.4665 64507.7683  73.6%     -  507s
     0     0 64466.9955    0  418 37159.4665 64466.9955  73.5%     -  516s
     0     0 64457.5932    0  432 37159.4665 64457.5932  73.5%     -  519s
H    0     0                    37321.756672 64449.4553  72.7%     -  522s
     0     0 64449.4553    0  422 37321.7567 64449.4553  72.7%     -  522s
     0     0 64442.1524    0  427 37321.7567 64442.1524  72.7%     -  526s
H    0     0                    37455.901672 64439.5263  72.0%     -  528s
     0     0 64439.5263    0  423 37455.9017 64439.5263  72.0%     -  528s
     0     0 64426.8211    0  382 37455.9017 64426.8211  72.0%     -  530s
     0     0 64425.4316    0  373 37455.9017 64425.4316  72.0%     -  531s
     0     0 64378.1287    0  387 37455.9017 64378.1287  71.9%     -  539s
H    0     0                    37580.699243 64377.7385  71.3%     -  540s
H    0     0                    38044.652307 64377.7385  69.2%     -  540s
     0     0 64359.8668    0  359 38044.6523 64359.8668  69.2%     -  542s
     0     0 64356.0998    0  368 38044.6523 64356.0998  69.2%     -  544s
     0     0 64355.7724    0  376 38044.6523 64355.7724  69.2%     -  545s
     0     0 64338.4740    0  362 38044.6523 64338.4740  69.1%     -  552s
     0     0 64333.8093    0  365 38044.6523 64333.8093  69.1%     -  556s
     0     0 64331.8074    0  369 38044.6523 64331.8074  69.1%     -  558s
     0     0 64322.3821    0  362 38044.6523 64322.3821  69.1%     -  563s
H    0     0                    38097.252125 64321.4181  68.8%     -  563s
     0     0 64318.8598    0  438 38097.2521 64318.8598  68.8%     -  567s
     0     0 64318.0501    0  439 38097.2521 64318.0501  68.8%     -  568s
H    0     0                    38213.207100 64306.8867  68.3%     -  575s
H    0     0                    38291.919887 64306.8867  67.9%     -  575s
H    0     0                    38493.748399 64306.8867  67.1%     -  575s
     0     0 64306.8867    0  406 38493.7484 64306.8867  67.1%     -  575s
     0     0 64303.9330    0  374 38493.7484 64303.9330  67.1%     -  578s
     0     0 64302.3115    0  407 38493.7484 64302.3115  67.0%     -  580s
     0     0 64292.5663    0  364 38493.7484 64292.5663  67.0%     -  585s
     0     0 64292.3483    0  364 38493.7484 64292.3483  67.0%     -  587s
H    0     0                    39123.242820 64292.1129  64.3%     -  700s
     0     2 64292.1129    0  364 39123.2428 64292.1129  64.3%     -  703s
     1     3 64017.7923    1  336 39123.2428 64291.2789  64.3% 11172  714s
     2     4 64215.0990    1  394 39123.2428 64215.0990  64.1%  7718  722s
     3     5 61250.5774    2  298 39123.2428 64213.8911  64.1% 13740  754s
     4     8 64019.9023    2  391 39123.2428 64213.3881  64.1% 11723  772s
     7    15 63876.2727    3  394 39123.2428 64213.3881  64.1%  9670  800s
    14    29 63458.3112    4  344 39123.2428 63894.1404  63.3% 11125  835s
    28    43 62356.5048    5  336 39123.2428 63894.1404  63.3% 19990  915s
    42    74 61500.9942    6  348 39123.2428 63553.2566  62.4% 18009  996s
H   57    74                    39174.155682 63553.2566  62.2% 16502  996s
    73   157 60506.0218    7  299 39174.1557 63553.2566  62.2% 16062 1101s
   156   249 60411.2870   10  313 39174.1557 63553.2566  62.2% 12321 1154s
   248   326 60348.1793   10  272 39174.1557 63553.2566  62.2%  9504 1200s
   325   357 60245.9311   11  272 39174.1557 63553.2566  62.2%  8440 1225s
   356   391 60024.5714   13  301 39174.1557 63553.2566  62.2%  8208 1254s
   390   426 59898.7674   13  302 39174.1557 63553.2566  62.2%  7930 1276s
H  397   426                    39188.461102 63553.2566  62.2%  7843 1276s
   425   494 60014.8080   14  283 39188.4611 63553.2566  62.2%  7667 1309s
   493   559 59770.3673   14  307 39188.4611 63553.2566  62.2%  7228 1343s
   558   607 59803.6371   14  292 39188.4611 63553.2566  62.2%  6880 1370s
H  560   607                    39397.351087 63553.2566  61.3%  6867 1370s
   606   673 59318.8496   15  295 39397.3511 63553.2566  61.3%  6657 1402s
H  672   718                    39411.323226 63553.2566  61.3%  6418 1430s
   719   787 59407.7276   15  294 39411.3232 63553.2566  61.3%  6285 1460s
   788   815 58827.5737   16  304 39411.3232 63553.2566  61.3%  6096 1488s
   818   851 59766.4494   16  278 39411.3232 63553.2566  61.3%  6073 1534s
   858   886 58312.9631   17  300 39411.3232 63553.2566  61.3%  6034 1557s
   899   934 58152.4537   18  297 39411.3232 63553.2566  61.3%  5954 1583s
   953   976 58845.9813   17  270 39411.3232 63553.2566  61.3%  5815 1609s
  1006  1003 58131.6494   19  285 39411.3232 63553.2566  61.3%  5720 1640s
  1047  1043 57991.9804   18  297 39411.3232 63553.2566  61.3%  5650 1666s
  1087  1080 57872.3803   19  282 39411.3232 63553.2566  61.3%  5603 1698s
  1126  1150 58066.3903   20  292 39411.3232 63553.2566  61.3%  5600 1724s
  1196  1215 58058.5435   21  292 39411.3232 63553.2566  61.3%  5423 1749s
  1267  1262 57967.6261   22  279 39411.3232 63553.2566  61.3%  5282 1784s
  1329  1315 57908.8621   23  278 39411.3232 63553.2566  61.3%  5182 1820s
  1396  1381 53586.5889   24  202 39411.3232 63553.2566  61.3%  5112 1857s
  1462  1441 53459.8705   25  197 39411.3232 63553.2566  61.3%  5090 1897s
  1522  1509 53382.7785   26  207 39411.3232 63553.2566  61.3%  5051 1934s
  1602  1551 42301.3440   26  186 39411.3232 63553.2566  61.3%  4971 1971s
  1663  1611 53399.2705   25  203 39411.3232 63553.2566  61.3%  4906 2021s
  1748  1639 53227.8572   27  203 39411.3232 63553.2566  61.3%  4925 2063s
  1786  1667 53203.7859   26  199 39411.3232 63553.2566  61.3%  4946 2115s
  1824  1720 52666.5932   27  189 39411.3232 63553.2566  61.3%  4965 2175s
  1877  1791 52549.0688   28  188 39411.3232 63553.2566  61.3%  4988 2221s
  1954  1871 45764.4170   29  181 39411.3232 63553.2566  61.3%  4978 2266s
  2054  1950 41727.9393   28  182 39411.3232 63553.2566  61.3%  4902 2313s
  2157  2013 41590.5958   29  169 39411.3232 63553.2566  61.3%  4808 2358s
  2254  2104 40972.2747   30  172 39411.3232 63377.4984  60.8%  4751 2407s
  2371  2196 infeasible   31      39411.3232 62622.6231  58.9%  4696 2457s
  2527  2276     cutoff   34      39411.3232 62622.6231  58.9%  4582 2510s
  2681  2366 40428.2837   39  168 39411.3232 62292.1717  58.1%  4512 2567s
  2828  2467 39756.0407   43  155 39411.3232 62292.1717  58.1%  4501 2634s
  2987  2543 59343.4060   10  332 39411.3232 62292.1717  58.1%  4500 2735s
  3109  2641 54461.2220   12  295 39411.3232 62292.1717  58.1%  4578 2805s
  3237  2752 54115.8452   15  284 39411.3232 62292.1717  58.1%  4643 2881s
  3376  2880 50118.9835   20  205 39411.3232 62292.1717  58.1%  4723 2965s
  3557  2881 58729.8080   11  364 39411.3232 62292.1717  58.1%  4759 3207s
  3559  2882 54353.1763   25  147 39411.3232 62292.1717  58.1%  4756 3220s
  3560  2883 59104.7313   19  279 39411.3232 62292.1717  58.1%  4755 3287s
  3561  2884 55245.7624   34  293 39411.3232 62292.1717  58.1%  4753 3346s
  3562  2884 52501.7072   47  332 39411.3232 62292.1717  58.1%  4752 3393s
  3563  2885 49727.3505   29  383 39411.3232 62292.1717  58.1%  4751 3424s
  3564  2886 53750.4829   23  359 39411.3232 62292.1717  58.1%  4749 3443s
  3565  2886 53197.6767   45  401 39411.3232 62292.1717  58.1%  4748 3476s
  3566  2887 54305.2979   36  358 39411.3232 62292.1717  58.1%  4747 3493s
  3567  2888 40655.3731   42  399 39411.3232 62292.1717  58.1%  4745 3507s
  3568  2888 57780.6428   20  403 39411.3232 62292.1717  58.1%  4744 3518s
  3569  2889 56095.9712   24  418 39411.3232 62292.1717  58.1%  4743 3526s
  3570  2890 59454.3043    8  367 39411.3232 62292.1717  58.1%  4741 3532s
  3571  2890 58409.5030   13  372 39411.3232 62292.1717  58.1%  4740 3537s
  3572  2891 50331.2229   69  419 39411.3232 62292.1717  58.1%  4739 3560s
  3574  2892 53011.1712   21  387 39411.3232 62292.1717  58.1%  4736 3568s
  3575  2893 54873.4887   27  388 39411.3232 62292.1717  58.1%  4735 3575s
  3576  2894 48230.9517   62  431 39411.3232 62292.1717  58.1%  4733 3592s
  3577  2894 43285.3251   27  394 39411.3232 62292.1717  58.1%  4732 3598s

Cutting planes:
  Gomory: 17
  Implied bound: 14
  Projected implied bound: 127
  MIR: 1058
  Mixing: 2
  Flow cover: 995
  RLT: 20
  Relax-and-lift: 247

Explored 3577 nodes (17804224 simplex iterations) in 3600.08 seconds (8549.18 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 39411.3 39397.4 39188.5 ... 38044.7

Time limit reached
Best objective 3.941132322578e+04, best bound 6.229217165663e+04, gap 58.0565%
  WARNING: Time limit reached. Using best solution found (gap: 58.06%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.14s
  Master Objective (UB) = 39411.32, θ = 227963.44
  Upper Bound (UB) = 39411.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227963.44
  [DEBUG]   ✓ Scenario 0: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227963.44 ≤ Q = 227963.44 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227963.44 ≤ Q = 227963.44 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 227963.44 ≤ Q = 227963.44 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4a92115
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x04a92115
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-15, 2e+02]
Found heuristic solution: objective 1.400020e+13
Presolve removed 2586 rows and 1876 columns
Presolve time: 0.00s
Presolved: 507 rows, 513 columns, 1439 nonzeros
Found heuristic solution: objective 6807775.1882
Variable types: 349 continuous, 164 integer (164 binary)

Root relaxation: objective -1.761562e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -176156.16    0  126 6807775.19 -176156.16   103%     -    0s
H    0     0                    -141093.8923 -176156.16  24.9%     -    0s
H    0     0                    -141380.7550 -176156.16  24.6%     -    0s
     0     0 -157264.14    0   44 -141380.75 -157264.14  11.2%     -    0s
H    0     0                    -156437.0853 -157247.80  0.52%     -    0s
H    0     0                    -156754.1047 -157247.80  0.31%     -    0s
H    0     0                    -156854.4190 -157205.64  0.22%     -    0s
     0     0 -157205.64    0   34 -156854.42 -157205.64  0.22%     -    0s
     0     0 -157166.21    0   18 -156854.42 -157166.21  0.20%     -    0s
     0     0 -157139.41    0   14 -156854.42 -157139.41  0.18%     -    0s
     0     0 -157132.86    0   13 -156854.42 -157132.86  0.18%     -    0s
     0     0 -156955.22    0    5 -156854.42 -156955.22  0.06%     -    0s
     0     0 -156955.22    0    8 -156854.42 -156955.22  0.06%     -    0s
H    0     0                    -156886.6926 -156955.22  0.04%     -    0s
*    0     0               0    -156943.8095 -156943.81  0.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 2
  Flow cover: 4
  Relax-and-lift: 4

Explored 1 nodes (546 simplex iterations) in 0.14 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 9: -156944 -156887 -156854 ... 1.40002e+13
No other solutions better than -156944

Optimal solution found (tolerance 1.00e-06)
Best objective -1.569438094766e+05, best bound -1.569438094766e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 214503.39
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -156943.81
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -156943.81 = 214503.39
  [DEBUG]   Current θ from Master = 227963.44
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13460.05 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25951.28
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1004.0532, Absolute Gap = 1004.0532, Relative Gap = 0.025476
  Not converged yet (gap = 1004.05 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697311 nonzeros
Model fingerprint: 0x7cac0317
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 110048 rows and 44688 columns
Presolve time: 2.14s
Presolved: 135975 rows, 57412 columns, 837058 nonzeros
Variable types: 55153 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.11s

Barrier statistics:
 Dense cols : 702
 AA' NZ     : 5.887e+06
 Factor NZ  : 1.336e+07 (roughly 200 MB of memory)
 Factor Ops : 2.996e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.87111241e+07  2.54681589e+08  1.49e+05 1.68e+01  9.00e+04     5s
   1  -1.46545103e+07  2.38630868e+08  1.07e+05 1.04e+02  6.41e+04     5s
   2  -4.69283629e+06  1.91687153e+08  3.42e+04 5.26e-01  2.18e+04     5s
   3  -1.11621005e+06  1.38020358e+08  4.01e+03 1.79e+00  3.00e+03     5s
   4  -6.20107531e+05  7.57424773e+07  5.86e+02 4.00e-01  6.30e+02     5s
   5  -5.12474525e+05  4.33709611e+07  2.76e+02 1.89e-01  3.12e+02     5s
   6  -3.88889551e+05  3.35478339e+07  9.27e+01 1.39e-01  1.79e+02     5s
   7  -3.32750345e+05  2.39149948e+07  5.47e+01 9.35e-02  1.19e+02     5s
   8  -2.12495239e+05  1.69636439e+07  1.58e+01 6.28e-02  7.43e+01     5s
   9  -1.90819097e+05  1.33380238e+07  1.27e+01 4.87e-02  5.79e+01     5s
  10  -1.51906020e+05  7.76337401e+06  7.88e+00 2.74e-02  3.32e+01     5s
  11  -1.07864240e+05  2.30388226e+06  3.93e+00 7.23e-03  9.97e+00     5s
  12  -6.10340119e+04  8.36356509e+05  1.62e+00 2.44e-03  3.66e+00     5s
  13  -2.19675827e+04  3.39483159e+05  7.54e-01 9.94e-04  1.47e+00     5s
  14  -7.58610607e+03  2.54212886e+05  6.38e-01 1.21e-03  1.06e+00     5s
  15   2.22825914e+04  2.11685911e+05  4.05e-01 3.16e-03  7.68e-01     5s
  16   3.12800641e+04  1.66333012e+05  3.46e-01 4.19e-03  5.48e-01     5s
  17   3.98633616e+04  1.50627427e+05  2.85e-01 3.43e-03  4.49e-01     5s
  18   5.51040432e+04  1.37877606e+05  1.74e-01 3.43e-03  3.35e-01     5s
  19   6.01328225e+04  1.20648526e+05  1.35e-01 2.99e-03  2.45e-01     6s
  20   6.44080590e+04  1.09717237e+05  1.05e-01 2.79e-03  1.84e-01     6s
  21   6.76593982e+04  1.03119791e+05  8.33e-02 2.07e-03  1.44e-01     6s
  22   6.95650843e+04  9.58413245e+04  6.98e-02 1.95e-03  1.07e-01     6s
  23   7.14029645e+04  9.30446280e+04  5.89e-02 2.31e-03  8.78e-02     6s
  24   7.37705770e+04  9.09369738e+04  4.55e-02 1.62e-03  6.96e-02     6s
  25   7.54337621e+04  8.92373368e+04  3.64e-02 1.65e-03  5.60e-02     6s
  26   7.67341426e+04  8.78743947e+04  2.95e-02 2.05e-03  4.52e-02     6s
  27   7.80782179e+04  8.73668975e+04  2.23e-02 1.97e-03  3.76e-02     6s
  28   7.91065383e+04  8.66737648e+04  1.68e-02 1.69e-03  3.07e-02     6s
  29   7.99608607e+04  8.57526667e+04  1.24e-02 1.31e-03  2.35e-02     6s
  30   8.03851431e+04  8.51766865e+04  1.03e-02 1.11e-03  1.94e-02     6s
  31   8.07464573e+04  8.43034155e+04  8.59e-03 7.67e-04  1.44e-02     6s
  32   8.10405558e+04  8.38592901e+04  7.22e-03 5.62e-04  1.14e-02     6s
  33   8.15866834e+04  8.34453745e+04  4.72e-03 3.53e-04  7.54e-03     6s
  34   8.19720887e+04  8.32637726e+04  3.01e-03 2.78e-04  5.23e-03     6s
  35   8.22077000e+04  8.30616457e+04  1.99e-03 1.80e-04  3.46e-03     7s
  36   8.23098967e+04  8.29987371e+04  1.57e-03 1.47e-04  2.79e-03     7s
  37   8.25027739e+04  8.29173292e+04  7.74e-04 1.03e-04  1.68e-03     7s
  38   8.26005144e+04  8.27599271e+04  3.91e-04 2.34e-05  6.46e-04     7s
  39   8.26438635e+04  8.27503856e+04  2.32e-04 1.87e-05  4.31e-04     7s
  40   8.26792796e+04  8.27265052e+04  1.05e-04 6.94e-06  1.91e-04     7s
  41   8.26988018e+04  8.27135573e+04  3.98e-05 9.38e-07  5.99e-05     7s
  42   8.27107846e+04  8.27113680e+04  5.97e-07 2.17e-07  2.36e-06     7s
  43   8.27111229e+04  8.27111235e+04  1.71e-10 9.47e-10  2.36e-09     7s

Barrier solved model in 43 iterations and 7.05 seconds (12.03 work units)
Optimal objective 8.27111229e+04


Root crossover log...

  120277 DPushes remaining with DInf 0.0000000e+00                 7s
    4840 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

   11773 PPushes remaining with PInf 8.0172732e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.3033222e+04     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   70478    8.2711123e+04   0.000000e+00   2.303322e+04     12s
   70648    8.2711123e+04   0.000000e+00   0.000000e+00     12s
   70648    8.2711123e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 1.98s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.271112e+04, 70648 iterations, 11.05 seconds (19.52 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82711.1233    0  163 -183060.80 82711.1233   145%     -   14s
H    0     0                    -151659.8884 82711.1233   155%     -   14s
H    0     0                    -118688.4114 82711.1233   170%     -   14s
H    0     0                    -86813.07389 82711.1233   195%     -   14s
H    0     0                    13389.732950 82711.1233   518%     -   15s
H    0     0                    21910.356884 82711.1233   277%     -   16s
H    0     0                    22298.665738 82711.1233   271%     -   16s
H    0     0                    23112.002638 82711.1233   258%     -   16s
H    0     0                    23489.621846 82711.1233   252%     -   16s
H    0     0                    23736.801770 82711.1233   248%     -   16s
H    0     0                    23832.710334 82711.1233   247%     -   16s
     0     0 75458.2901    0  235 23832.7103 75458.2901   217%     -   52s
     0     0 75458.2901    0  235 23832.7103 75458.2901   217%     -   53s
     0     0 74985.4944    0  246 23832.7103 74985.4944   215%     -   71s
     0     0 74886.1896    0  240 23832.7103 74886.1896   214%     -   77s
     0     0 74819.2945    0  259 23832.7103 74819.2945   214%     -   81s
     0     0 74774.1112    0  237 23832.7103 74774.1112   214%     -   83s
     0     0 74758.9444    0  262 23832.7103 74758.9444   214%     -   86s
     0     0 74696.2143    0  253 23832.7103 74696.2143   213%     -   90s
     0     0 74695.0428    0  249 23832.7103 74695.0428   213%     -   91s
     0     0 74694.8856    0  230 23832.7103 74694.8856   213%     -   92s
     0     0 71004.5831    0  293 23832.7103 71004.5831   198%     -  137s
H    0     0                    30985.137997 71004.3715   129%     -  137s
H    0     0                    32222.487088 71004.3715   120%     -  137s
H    0     0                    32245.914948 71004.3715   120%     -  137s
H    0     0                    32589.751530 71004.3715   118%     -  137s
     0     0 70351.3350    0  331 32589.7515 70351.3350   116%     -  162s
     0     0 70211.3409    0  325 32589.7515 70211.3409   115%     -  175s
     0     0 70112.9535    0  325 32589.7515 70112.9535   115%     -  184s
     0     0 70007.3583    0  319 32589.7515 70007.3583   115%     -  195s
     0     0 69960.1200    0  332 32589.7515 69960.1200   115%     -  202s
     0     0 69935.3718    0  345 32589.7515 69935.3718   115%     -  208s
     0     0 69901.7435    0  338 32589.7515 69901.7435   114%     -  211s
     0     0 69884.3638    0  346 32589.7515 69884.3638   114%     -  215s
     0     0 69878.6893    0  346 32589.7515 69878.6893   114%     -  218s
     0     0 69852.4348    0  335 32589.7515 69852.4348   114%     -  224s
     0     0 69830.0165    0  340 32589.7515 69830.0165   114%     -  227s
     0     0 69821.3045    0  343 32589.7515 69821.3045   114%     -  229s
     0     0 69819.5181    0  340 32589.7515 69819.5181   114%     -  230s
     0     0 69810.0725    0  346 32589.7515 69810.0725   114%     -  232s
     0     0 69808.8154    0  347 32589.7515 69808.8154   114%     -  233s
     0     0 67515.7474    0  293 32589.7515 67515.7474   107%     -  293s
H    0     0                    35879.569584 67515.5781  88.2%     -  294s
H    0     0                    37304.358433 67515.5781  81.0%     -  294s
H    0     0                    37311.148541 67515.5781  81.0%     -  294s
H    0     0                    38206.166083 67515.5781  76.7%     -  294s
     0     0 67187.6621    0  306 38206.1661 67187.6621  75.9%     -  313s
     0     0 67054.4056    0  310 38206.1661 67054.4056  75.5%     -  326s
     0     0 66979.7840    0  316 38206.1661 66979.7840  75.3%     -  336s
     0     0 66869.3423    0  375 38206.1661 66869.3423  75.0%     -  347s
     0     0 66800.2722    0  320 38206.1661 66800.2722  74.8%     -  353s
     0     0 66749.3175    0  313 38206.1661 66749.3175  74.7%     -  360s
     0     0 66645.7995    0  317 38206.1661 66645.7995  74.4%     -  367s
     0     0 66621.3457    0  318 38206.1661 66621.3457  74.4%     -  371s
     0     0 66611.3109    0  324 38206.1661 66611.3109  74.3%     -  376s
     0     0 66603.8884    0  319 38206.1661 66603.8884  74.3%     -  380s
     0     0 66586.3598    0  312 38206.1661 66586.3598  74.3%     -  383s
     0     0 66547.1656    0  314 38206.1661 66547.1656  74.2%     -  387s
     0     0 66546.7066    0  316 38206.1661 66546.7066  74.2%     -  388s
     0     0 65373.7480    0  363 38206.1661 65373.7480  71.1%     -  430s
     0     0 65157.1080    0  324 38206.1661 65157.1080  70.5%     -  445s
     0     0 65044.1060    0  315 38206.1661 65044.1060  70.2%     -  453s
     0     0 65016.5845    0  324 38206.1661 65016.5845  70.2%     -  457s
     0     0 64988.3182    0  357 38206.1661 64988.3182  70.1%     -  463s
     0     0 64983.3894    0  331 38206.1661 64983.3894  70.1%     -  465s
     0     0 64976.5384    0  360 38206.1661 64976.5384  70.1%     -  469s
     0     0 64969.3444    0  362 38206.1661 64969.3444  70.0%     -  470s
     0     0 64958.8679    0  370 38206.1661 64958.8679  70.0%     -  472s
     0     0 64956.5220    0  374 38206.1661 64956.5220  70.0%     -  474s
     0     0 64834.5948    0  350 38206.1661 64834.5948  69.7%     -  485s
H    0     0                    38421.320709 64834.1079  68.7%     -  486s
     0     0 64773.5501    0  348 38421.3207 64773.5501  68.6%     -  493s
     0     0 64736.3865    0  409 38421.3207 64736.3865  68.5%     -  502s
     0     0 64722.7306    0  360 38421.3207 64722.7306  68.5%     -  505s
     0     0 64710.8141    0  352 38421.3207 64710.8141  68.4%     -  508s
     0     0 64706.0312    0  410 38421.3207 64706.0312  68.4%     -  511s
     0     0 64702.5481    0  413 38421.3207 64702.5481  68.4%     -  513s
     0     0 64700.5459    0  411 38421.3207 64700.5459  68.4%     -  514s
     0     0 64647.8105    0  347 38421.3207 64647.8105  68.3%     -  522s
H    0     0                    38656.205815 64647.2656  67.2%     -  529s
     0     0 64578.9498    0  352 38656.2058 64578.9498  67.1%     -  539s
     0     0 64568.9031    0  351 38656.2058 64568.9031  67.0%     -  541s
     0     0 64565.7895    0  357 38656.2058 64565.7895  67.0%     -  544s
     0     0 64564.9127    0  354 38656.2058 64564.9127  67.0%     -  545s
     0     0 64524.6545    0  379 38656.2058 64524.6545  66.9%     -  552s
     0     0 64522.1291    0  382 38656.2058 64522.1291  66.9%     -  554s
     0     0 64514.8748    0  426 38656.2058 64514.8748  66.9%     -  558s
     0     0 64511.8507    0  390 38656.2058 64511.8507  66.9%     -  562s
     0     0 64509.2146    0  427 38656.2058 64509.2146  66.9%     -  564s
     0     0 64508.4796    0  425 38656.2058 64508.4796  66.9%     -  566s
     0     0 64492.4568    0  355 38656.2058 64492.4568  66.8%     -  574s
     0     0 64488.5671    0  414 38656.2058 64488.5671  66.8%     -  577s
     0     0 64486.7165    0  360 38656.2058 64486.7165  66.8%     -  578s
     0     0 64472.3322    0  357 38656.2058 64472.3322  66.8%     -  584s
     0     0 64472.0626    0  357 38656.2058 64472.0626  66.8%     -  587s
H    0     0                    39257.675983 64471.8427  64.2%     -  710s
H    0     0                    39377.445177 64471.8427  63.7%     -  716s
H    0     2                    39391.525397 64471.8427  63.7%     -  759s
     0     2 64471.8427    0  357 39391.5254 64471.8427  63.7%     -  759s
     1     4 64400.8492    1  340 39391.5254 64471.8427  63.7%  5153  771s
     3     8 64275.2735    2  335 39391.5254 64400.0978  63.5%  7266  792s
     7    14 63892.0862    3  354 39391.5254 64274.9381  63.2% 11695  839s
    10    14 62256.0653    3  308 39391.5254 64139.9450  62.8% 13305  840s
    13    28 63814.6551    4  349 39391.5254 64139.9450  62.8% 14080  875s
    27    42 62720.8130    5  364 39391.5254 63814.0718  62.0% 20513 1007s
    41    74 61599.9465    6  350 39391.5254 63814.0718  62.0% 21466 1184s
H   50    74                    39477.821495 63814.0718  61.6% 20438 1184s
    73   166 61460.2900    7  341 39477.8215 63443.4658  60.7% 21671 1346s
   165   284 60616.1207    9  284 39477.8215 63443.4658  60.7% 14967 1420s
H  207   284                    39514.402852 63443.4658  60.6% 12826 1420s
   283   364 60197.0632   11  324 39514.4029 63443.4658  60.6% 11247 1462s
   363   438 60059.5339   15  317 39514.4029 63443.4658  60.6%  9964 1509s
   437   493 59475.3541   19  278 39514.4029 63443.4658  60.6%  9189 1551s
   492   525 59702.6240   18  312 39514.4029 63443.4658  60.6%  8834 1575s
   524   558 59637.3263   19  313 39514.4029 63443.4658  60.6%  8786 1599s
   557   590 59525.2634   20  315 39514.4029 63443.4658  60.6%  8800 1621s
   589   621 59438.6411   21  312 39514.4029 63443.4658  60.6%  8713 1642s
   620   653 59317.6060   22  313 39514.4029 63443.4658  60.6%  8694 1664s
   652   685 59308.1600   23  308 39514.4029 63443.4658  60.6%  8753 1689s
   684   722 57693.6400   24  301 39514.4029 63443.4658  60.6%  8771 1712s
   721   761 57676.9204   25  291 39514.4029 63443.4658  60.6%  8769 1733s
   760   801 57666.3949   26  294 39514.4029 63443.4658  60.6%  8698 1767s
   800   852 57542.2864   27  288 39514.4029 63443.4658  60.6%  8669 1790s
   851   900 57481.7671   28  284 39514.4029 63443.4658  60.6%  8603 1817s
   899   963 57304.4334   29  284 39514.4029 63443.4658  60.6%  8613 1842s
   962  1032 56001.2433   30  267 39514.4029 63443.4658  60.6%  8563 1870s
  1031  1103 55952.9190   31  268 39514.4029 63443.4658  60.6%  8457 1911s
  1102  1190 55924.5841   32  255 39514.4029 63443.4658  60.6%  8398 1945s
  1189  1280 55339.1473   36  255 39514.4029 63443.4658  60.6%  8295 1988s
  1285  1317 55037.3062   37  249 39514.4029 63443.4658  60.6%  8172 2019s
  1322  1382 54783.3445   38  242 39514.4029 63443.4658  60.6%  8219 2055s
  1389  1497 54418.7477   41  231 39514.4029 63443.4658  60.6%  8321 2090s
  1518  1588 53378.1086   45  210 39514.4029 63443.4658  60.6%  8138 2126s
  1633  1681 46040.9997   47  210 39514.4029 63443.4658  60.6%  8118 2162s
  1761  1774 45553.4356   52  190 39514.4029 63443.4658  60.6%  8051 2205s
  1903  1863 41093.3811   61   98 39514.4029 63443.4658  60.6%  7914 2247s
  2032  1960 42418.8129   52  250 39514.4029 63443.4658  60.6%  7828 2293s
  2167  2049 40491.0891   56  172 39514.4029 63443.4658  60.6%  7828 2340s
  2329  2108 39671.0856   63  138 39514.4029 63443.4658  60.6%  7772 2390s
  2469  2196 41767.0013   66  134 39514.4029 63443.4658  60.6%  7762 2448s
  2595  2312 infeasible   67      39514.4029 63179.1555  59.9%  7843 2494s
  2754  2437 58844.0470    7  263 39514.4029 63179.1555  59.9%  7818 2548s
  2937  2550 58098.5819    9  275 39514.4029 63179.1555  59.9%  7762 2606s
  3114  2674 54118.0111   12  238 39514.4029 63179.1555  59.9%  7779 2668s
  3284  2837 53606.7959   17  237 39514.4029 63179.1555  59.9%  7810 2727s
  3485  3007 52639.0389   22  218 39514.4029 63179.1555  59.9%  7784 2792s
  3701  3008 59788.7611   25  357 39514.4029 63179.1555  59.9%  7751 3068s
  3703  3009 49281.0513   40  147 39514.4029 63179.1555  59.9%  7747 3082s
  3704  3010 44932.6118   56  290 39514.4029 63179.1555  59.9%  7745 3146s
  3705  3011 58149.8958   12  280 39514.4029 63179.1555  59.9%  7743 3215s
  3706  3011 42787.9124   50  354 39514.4029 63179.1555  59.9%  7740 3260s
  3707  3012 58994.8199   12  326 39514.4029 63179.1555  59.9%  7738 3298s
  3708  3013 41143.6128   61  393 39514.4029 63179.1555  59.9%  7736 3329s
  3709  3013 56388.1169   36  405 39514.4029 63179.1555  59.9%  7734 3346s
  3710  3014 56727.4488   28  374 39514.4029 63179.1555  59.9%  7732 3366s
  3711  3015 51390.7010   30  347 39514.4029 63179.1555  59.9%  7730 3379s
  3712  3015 58819.0896   20  353 39514.4029 63179.1555  59.9%  7728 3390s
  3713  3016 40362.3570   59  412 39514.4029 63179.1555  59.9%  7726 3401s
  3714  3017 42270.0146   81  407 39514.4029 63179.1555  59.9%  7724 3407s
  3715  3017 54221.9780   23  412 39514.4029 63179.1555  59.9%  7722 3410s
  3717  3019 57939.1550   33  450 39514.4029 63179.1555  59.9%  7718 3432s
  3718  3019 56688.8583   29  417 39514.4029 63179.1555  59.9%  7716 3442s
  3719  3020 61608.3206   11  418 39514.4029 63179.1555  59.9%  7713 3445s
  3720  3021 43844.1107   36  347 39514.4029 63179.1555  59.9%  7711 3453s
  3721  3021 59362.2516    6  361 39514.4029 63179.1555  59.9%  7709 3461s
  3722  3022 40171.3155   61  382 39514.4029 63179.1555  59.9%  7707 3466s
  3723  3023 40370.3250   59  381 39514.4029 63179.1555  59.9%  7705 3484s
  3724  3023 42807.5619   57  361 39514.4029 63179.1555  59.9%  7703 3490s
  3725  3024 60795.8809   16  409 39514.4029 63179.1555  59.9%  7701 3498s
  3726  3025 45470.4934   74  377 39514.4029 63179.1555  59.9%  7699 3503s
  3727  3025 40764.5923   80  426 39514.4029 63179.1555  59.9%  7697 3518s
  3728  3026 42068.5646   76  424 39514.4029 63179.1555  59.9%  7695 3523s
  3729  3027 41161.9858   46  447 39514.4029 63179.1555  59.9%  7693 3535s
  3730  3027 52010.4734   34  355 39514.4029 63179.1555  59.9%  7691 3546s
  3731  3028 54852.0991   40  377 39514.4029 63179.1555  59.9%  7689 3551s
  3732  3029 53965.1747   37  401 39514.4029 63179.1555  59.9%  7687 3558s
  3733  3029 51441.2328   55  373 39514.4029 63179.1555  59.9%  7685 3584s
  3734  3030 58589.9711    8  461 39514.4029 63179.1555  59.9%  7682 3599s

Cutting planes:
  Learned: 1
  Gomory: 22
  Implied bound: 7
  Projected implied bound: 224
  MIR: 1125
  Mixing: 2
  Flow cover: 883
  RLT: 11
  Relax-and-lift: 273

Explored 3734 nodes (29659595 simplex iterations) in 3600.03 seconds (8442.93 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 39514.4 39477.8 39391.5 ... 37304.4

Time limit reached
Best objective 3.951440285156e+04, best bound 6.317915553678e+04, gap 59.8889%
  WARNING: Time limit reached. Using best solution found (gap: 59.89%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 39514.40, θ = 228149.16
  Upper Bound (UB) = 39514.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 228149.16
  [DEBUG]   ✓ Scenario 0: θ = 228149.16 ≤ Q = 228149.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 228149.16 ≤ Q = 228149.16 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x455c8ce2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbaa3731e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.409694e+13
Presolve removed 2586 rows and 1876 columns
Presolve time: 0.00s
Presolved: 507 rows, 513 columns, 1438 nonzeros
Found heuristic solution: objective 6811063.5716
Variable types: 349 continuous, 164 integer (164 binary)

Root relaxation: objective -1.738960e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -173896.04    0  123 6811063.57 -173896.04   103%     -    0s
H    0     0                    -140730.0903 -173896.04  23.6%     -    0s
H    0     0                    -141062.5216 -173896.04  23.3%     -    0s
     0     0 -151752.65    0  103 -141062.52 -151752.65  7.58%     -    0s
H    0     0                    -147949.5656 -151631.11  2.49%     -    0s
H    0     0                    -148221.0163 -151631.11  2.30%     -    0s
H    0     0                    -148548.1962 -151631.11  2.08%     -    0s
H    0     0                    -148819.6470 -151631.11  1.89%     -    0s
     0     0 -149903.07    0  106 -148819.65 -149903.07  0.73%     -    0s
H    0     0                    -148846.2691 -149899.45  0.71%     -    0s
     0     0 -149876.32    0  106 -148846.27 -149876.32  0.69%     -    0s
     0     0 -149423.53    0   86 -148846.27 -149423.53  0.39%     -    0s
     0     0 -149293.29    0   81 -148846.27 -149293.29  0.30%     -    0s
     0     0 -149282.98    0   82 -148846.27 -149282.98  0.29%     -    0s
     0     0 -149279.47    0   81 -148846.27 -149279.47  0.29%     -    0s
     0     0 -149158.56    0   73 -148846.27 -149158.56  0.21%     -    0s
     0     0 -149114.26    0   62 -148846.27 -149114.26  0.18%     -    0s
     0     0 -149094.65    0   76 -148846.27 -149094.65  0.17%     -    0s
     0     0 -149054.62    0   76 -148846.27 -149054.62  0.14%     -    0s
     0     0 -149052.80    0   76 -148846.27 -149052.80  0.14%     -    0s
     0     0 -149052.80    0   78 -148846.27 -149052.80  0.14%     -    0s
     0     0 -149052.80    0   74 -148846.27 -149052.80  0.14%     -    0s
H    0     0                    -148854.0161 -149052.80  0.13%     -    0s
     0     0 -149052.80    0   51 -148854.02 -149052.80  0.13%     -    0s
     0     0 -149043.11    0   56 -148854.02 -149043.11  0.13%     -    0s
     0     0 -149039.47    0   51 -148854.02 -149039.47  0.12%     -    0s
     0     0 -149019.71    0   50 -148854.02 -149019.71  0.11%     -    0s
     0     0 -149018.15    0   51 -148854.02 -149018.15  0.11%     -    0s
     0     0 -149017.54    0   50 -148854.02 -149017.54  0.11%     -    0s
     0     0 -148953.85    0   54 -148854.02 -148953.85  0.07%     -    0s
     0     0 -148953.39    0   47 -148854.02 -148953.39  0.07%     -    0s
     0     0 -148952.84    0   46 -148854.02 -148952.84  0.07%     -    0s
     0     0 -148947.79    0   44 -148854.02 -148947.79  0.06%     -    0s
     0     0 -148945.15    0   44 -148854.02 -148945.15  0.06%     -    0s
H    0     0                    -148928.4357 -148945.15  0.01%     -    0s
H    0     0                    -148939.2812 -148945.15  0.00%     -    0s
     0     0 -148945.15    0   32 -148939.28 -148945.15  0.00%     -    0s
     0     0 -148945.15    0   45 -148939.28 -148945.15  0.00%     -    0s
     0     0 -148945.15    0   42 -148939.28 -148945.15  0.00%     -    0s
     0     0 -148945.15    0   39 -148939.28 -148945.15  0.00%     -    0s
     0     0 -148945.15    0   24 -148939.28 -148945.15  0.00%     -    0s
     0     0 -148945.15    0   24 -148939.28 -148945.15  0.00%     -    0s
     0     0 -148944.56    0   23 -148939.28 -148944.56  0.00%     -    0s
     0     0 -148942.96    0   23 -148939.28 -148942.96  0.00%     -    0s
     0     0 -148942.85    0   22 -148939.28 -148942.85  0.00%     -    0s

Cutting planes:
  Gomory: 21
  Implied bound: 9
  MIR: 38
  Flow cover: 6

Explored 1 nodes (1521 simplex iterations) in 0.19 seconds (0.10 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -148939 -148928 -148920 ... -141063
No other solutions better than -148939

Optimal solution found (tolerance 1.00e-06)
Best objective -1.489392811570e+05, best bound -1.489392811570e+05, gap 0.0000%
  Subproblem solved in 0.21s
  Worst-case operational profit (Z_SP) = 222507.92
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148939.28
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -148939.28 = 222507.92
  [DEBUG]   Current θ from Master = 228149.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5641.24 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 33873.16
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 1107.1328, Absolute Gap = 1107.1328, Relative Gap = 0.028018
  Not converged yet (gap = 1107.13 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740548 nonzeros
Model fingerprint: 0x9a41a814
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 116916 rows and 47476 columns
Presolve time: 2.14s
Presolved: 144397 rows, 60864 columns, 888417 nonzeros
Variable types: 58605 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309441.0403
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.34s

Barrier statistics:
 Dense cols : 694
 AA' NZ     : 6.649e+06
 Factor NZ  : 1.546e+07 (roughly 200 MB of memory)
 Factor Ops : 3.829e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.91229723e+07  2.68749440e+08  1.52e+05 1.62e+01  9.15e+04     4s
   1  -1.50161910e+07  2.52775254e+08  1.10e+05 1.03e+02  6.52e+04     4s
   2  -4.84260866e+06  2.03127565e+08  3.52e+04 8.99e-01  2.24e+04     4s
   3  -1.16993617e+06  1.47149904e+08  4.36e+03 6.68e-01  3.21e+03     4s
   4  -6.34294093e+05  8.41052010e+07  6.28e+02 2.54e-01  6.69e+02     4s
   5  -5.28494881e+05  4.80281426e+07  2.81e+02 1.23e-01  3.23e+02     4s
   6  -4.07112112e+05  3.63415061e+07  9.10e+01 8.83e-02  1.81e+02     4s
   7  -3.64622445e+05  2.64512785e+07  5.96e+01 6.18e-02  1.25e+02     4s
   8  -2.54339287e+05  2.03314548e+07  1.82e+01 4.62e-02  8.44e+01     4s
   9  -2.11111132e+05  1.34311534e+07  1.22e+01 2.95e-02  5.48e+01     4s
  10  -1.62797500e+05  9.26902625e+06  7.92e+00 1.98e-02  3.73e+01     4s
  11  -1.26124007e+05  3.03353969e+06  5.00e+00 6.02e-03  1.24e+01     4s
  12  -7.20868263e+04  1.51048827e+06  1.84e+00 2.88e-03  6.08e+00     4s
  13  -2.97177053e+04  5.64261863e+05  7.43e-01 9.90e-04  2.27e+00     4s
  14  -9.29679029e+03  3.36846436e+05  5.12e-01 5.72e-04  1.32e+00     4s
  15   9.96041528e+03  2.55369891e+05  3.73e-01 1.11e-03  9.36e-01     4s
  16   3.70191301e+04  2.08656373e+05  2.24e-01 8.75e-04  6.54e-01     5s
  17   4.26400088e+04  1.78102897e+05  1.90e-01 1.01e-03  5.16e-01     5s
  18   5.07215526e+04  1.61115346e+05  1.42e-01 1.11e-03  4.20e-01     5s
  19   5.68953265e+04  1.29524182e+05  1.07e-01 1.89e-03  2.77e-01     5s
  20   6.21632444e+04  1.14034663e+05  8.11e-02 1.52e-03  1.98e-01     5s
  21   6.59705549e+04  1.04808877e+05  6.41e-02 1.93e-03  1.48e-01     5s
  22   6.92276374e+04  9.88237087e+04  5.01e-02 1.06e-03  1.13e-01     5s
  23   7.06919619e+04  9.72887991e+04  4.35e-02 9.90e-04  1.01e-01     5s
  24   7.14713207e+04  9.25761073e+04  4.03e-02 1.28e-03  8.05e-02     5s
  25   7.34854847e+04  8.98949108e+04  3.25e-02 1.53e-03  6.26e-02     5s
  26   7.44930839e+04  8.86038262e+04  2.87e-02 1.65e-03  5.38e-02     5s
  27   7.51068685e+04  8.77155616e+04  2.65e-02 1.42e-03  4.81e-02     5s
  28   7.64705768e+04  8.67547611e+04  2.15e-02 1.11e-03  3.92e-02     5s
  29   7.81179569e+04  8.60487956e+04  1.54e-02 9.60e-04  3.02e-02     5s
  30   7.89573517e+04  8.56617010e+04  1.23e-02 8.13e-04  2.56e-02     5s
  31   7.94083335e+04  8.48974194e+04  1.07e-02 6.11e-04  2.09e-02     5s
  32   7.98588314e+04  8.43847885e+04  9.16e-03 4.87e-04  1.73e-02     5s
  33   8.05449327e+04  8.41048232e+04  6.75e-03 4.10e-04  1.36e-02     5s
  34   8.12116602e+04  8.37564390e+04  4.42e-03 3.16e-04  9.70e-03     5s
  35   8.13501311e+04  8.35384639e+04  3.96e-03 2.63e-04  8.34e-03     6s
  36   8.17577804e+04  8.32327102e+04  2.51e-03 1.80e-04  5.62e-03     6s
  37   8.19354472e+04  8.31265659e+04  1.91e-03 1.52e-04  4.54e-03     6s
  38   8.19990401e+04  8.28490027e+04  1.70e-03 1.08e-04  3.24e-03     6s
  39   8.21277624e+04  8.26980331e+04  1.27e-03 5.69e-05  2.18e-03     6s
  40   8.21651194e+04  8.26690546e+04  1.14e-03 4.88e-05  1.92e-03     6s
  41   8.22743015e+04  8.25953363e+04  7.92e-04 2.92e-05  1.23e-03     6s
  42   8.23298723e+04  8.25726319e+04  6.13e-04 1.77e-05  9.27e-04     6s
  43   8.24663562e+04  8.25541784e+04  1.78e-04 9.78e-06  3.35e-04     6s
  44   8.24798549e+04  8.25497340e+04  1.40e-04 7.80e-06  2.67e-04     6s
  45   8.24961871e+04  8.25400767e+04  9.27e-05 3.93e-06  1.67e-04     6s
  46   8.25237957e+04  8.25373018e+04  1.37e-05 2.79e-06  5.14e-05     6s
  47   8.25264375e+04  8.25312830e+04  7.70e-06 1.51e-06  1.85e-05     6s
  48   8.25291935e+04  8.25301546e+04  1.29e-06 4.23e-07  3.66e-06     6s
  49   8.25297954e+04  8.25298768e+04  1.32e-07 2.93e-08  3.11e-07     6s
  50   8.25298700e+04  8.25298702e+04  3.61e-09 2.44e-09  9.12e-10     6s

Barrier solved model in 50 iterations and 6.41 seconds (13.80 work units)
Optimal objective 8.25298700e+04


Root crossover log...

  126958 DPushes remaining with DInf 0.0000000e+00                 6s
    4887 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    9096 PPushes remaining with PInf 8.6279623e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.3861476e+03     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68861    8.2529870e+04   0.000000e+00   6.386148e+03     12s
   69162    8.2529870e+04   0.000000e+00   0.000000e+00     12s
   69162    8.2529870e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 4.22s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.252987e+04, 69162 iterations, 13.66 seconds (27.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82529.8702    0  182 -183060.80 82529.8702   145%     -   16s
H    0     0                    -168353.0609 82529.8702   149%     -   17s
H    0     0                    -126422.7558 82529.8702   165%     -   17s
H    0     0                    -125540.1712 82529.8702   166%     -   17s
H    0     0                    -125234.6019 82529.8702   166%     -   18s
H    0     0                    -59778.71181 82529.8702   238%     -   18s
H    0     0                    -25211.40978 82529.8702   427%     -   18s
H    0     0                    -21546.23952 82529.8702   483%     -   18s
H    0     0                    15267.656151 82529.8702   441%     -   19s
H    0     0                    20175.334851 82529.8702   309%     -   19s
H    0     0                    21891.901881 82529.8702   277%     -   19s
H    0     0                    22849.236336 82529.8702   261%     -   19s
H    0     0                    23076.648230 82529.8702   258%     -   19s
H    0     0                    23128.318757 82529.8702   257%     -   19s
H    0     0                    23157.546066 82529.8702   256%     -   19s
H    0     0                    23187.945218 82529.8702   256%     -   19s
H    0     0                    23246.113497 82529.8702   255%     -   19s
     0     0 75450.9364    0  274 23246.1135 75450.9364   225%     -   82s
     0     0 74933.8161    0  222 23246.1135 74933.8161   222%     -  103s
     0     0 74888.6383    0  218 23246.1135 74888.6383   222%     -  112s
     0     0 74570.3588    0  229 23246.1135 74570.3588   221%     -  121s
     0     0 74529.0009    0  230 23246.1135 74529.0009   221%     -  126s
     0     0 74522.8827    0  228 23246.1135 74522.8827   221%     -  128s
     0     0 74441.1553    0  237 23246.1135 74441.1553   220%     -  132s
     0     0 74378.2707    0  240 23246.1135 74378.2707   220%     -  135s
     0     0 74368.3918    0  276 23246.1135 74368.3918   220%     -  136s
     0     0 74367.7078    0  276 23246.1135 74367.7078   220%     -  137s
     0     0 70172.0563    0  248 23246.1135 70172.0563   202%     -  188s
H    0     0                    31502.024744 70171.9396   123%     -  189s
     0     0 69549.2505    0  300 31502.0247 69549.2505   121%     -  214s
     0     0 69549.2505    0  300 31502.0247 69549.2505   121%     -  214s
     0     0 69394.6023    0  325 31502.0247 69394.6023   120%     -  231s
     0     0 69239.0278    0  292 31502.0247 69239.0278   120%     -  244s
     0     0 69190.5281    0  333 31502.0247 69190.5281   120%     -  258s
     0     0 69124.5992    0  310 31502.0247 69124.5992   119%     -  267s
     0     0 69057.3897    0  310 31502.0247 69057.3897   119%     -  277s
     0     0 69040.1170    0  260 31502.0247 69040.1170   119%     -  281s
     0     0 68993.4734    0  308 31502.0247 68993.4734   119%     -  285s
     0     0 68964.8774    0  314 31502.0247 68964.8774   119%     -  288s
     0     0 68959.6797    0  323 31502.0247 68959.6797   119%     -  290s
     0     0 68920.7370    0  323 31502.0247 68920.7370   119%     -  296s
     0     0 68865.1819    0  321 31502.0247 68865.1819   119%     -  304s
     0     0 68862.8084    0  327 31502.0247 68862.8084   119%     -  306s
     0     0 68862.2588    0  324 31502.0247 68862.2588   119%     -  307s
     0     0 67230.7452    0  326 31502.0247 67230.7452   113%     -  351s
H    0     0                    36503.810095 67230.6764  84.2%     -  352s
H    0     0                    38395.183185 67230.6764  75.1%     -  352s
H    0     0                    38898.512053 67230.6764  72.8%     -  352s
H    0     0                    38958.758193 67230.6764  72.6%     -  352s
     0     0 66606.1874    0  331 38958.7582 66606.1874  71.0%     -  372s
     0     0 66410.0777    0  366 38958.7582 66410.0777  70.5%     -  388s
     0     0 66280.9616    0  362 38958.7582 66280.9616  70.1%     -  404s
     0     0 66250.4462    0  404 38958.7582 66250.4462  70.1%     -  413s
     0     0 66183.7055    0  357 38958.7582 66183.7055  69.9%     -  421s
     0     0 66168.5242    0  364 38958.7582 66168.5242  69.8%     -  426s
     0     0 66158.6894    0  402 38958.7582 66158.6894  69.8%     -  430s
     0     0 66154.0932    0  358 38958.7582 66154.0932  69.8%     -  435s
     0     0 66126.2449    0  364 38958.7582 66126.2449  69.7%     -  441s
     0     0 66112.4829    0  364 38958.7582 66112.4829  69.7%     -  443s
     0     0 66108.7681    0  362 38958.7582 66108.7681  69.7%     -  446s
     0     0 66106.0027    0  369 38958.7582 66106.0027  69.7%     -  448s
     0     0 66093.6344    0  370 38958.7582 66093.6344  69.7%     -  449s
     0     0 66084.1040    0  374 38958.7582 66084.1040  69.6%     -  452s
     0     0 66079.7089    0  375 38958.7582 66079.7089  69.6%     -  453s
     0     0 66079.4822    0  376 38958.7582 66079.4822  69.6%     -  454s
     0     0 65232.9223    0  389 38958.7582 65232.9223  67.4%     -  495s
     0     0 65079.0260    0  343 38958.7582 65079.0260  67.0%     -  513s
     0     0 65007.2957    0  416 38958.7582 65007.2957  66.9%     -  524s
     0     0 64989.9820    0  379 38958.7582 64989.9820  66.8%     -  529s
     0     0 64965.6113    0  428 38958.7582 64965.6113  66.8%     -  535s
     0     0 64947.5198    0  349 38958.7582 64947.5198  66.7%     -  540s
     0     0 64916.5039    0  401 38958.7582 64916.5039  66.6%     -  545s
     0     0 64900.2741    0  433 38958.7582 64900.2741  66.6%     -  551s
     0     0 64897.9896    0  436 38958.7582 64897.9896  66.6%     -  553s
     0     0 64796.7641    0  345 38958.7582 64796.7641  66.3%     -  569s
     0     0 64756.8373    0  389 38958.7582 64756.8373  66.2%     -  577s
     0     0 64746.0025    0  356 38958.7582 64746.0025  66.2%     -  582s
     0     0 64740.4605    0  344 38958.7582 64740.4605  66.2%     -  585s
     0     0 64732.7280    0  367 38958.7582 64732.7280  66.2%     -  588s
     0     0 64726.0767    0  420 38958.7582 64726.0767  66.1%     -  592s
     0     0 64720.9230    0  389 38958.7582 64720.9230  66.1%     -  594s
     0     0 64720.4919    0  385 38958.7582 64720.4919  66.1%     -  595s
     0     0 64654.4446    0  411 38958.7582 64654.4446  66.0%     -  605s
H    0     0                    39391.525397 64654.0247  64.1%     -  608s
     0     0 64640.8113    0  346 39391.5254 64640.8113  64.1%     -  612s
     0     0 64620.3550    0  345 39391.5254 64620.3550  64.0%     -  616s
     0     0 64615.9318    0  379 39391.5254 64615.9318  64.0%     -  619s
     0     0 64613.9581    0  425 39391.5254 64613.9581  64.0%     -  622s
     0     0 64589.9216    0  445 39391.5254 64589.9216  64.0%     -  628s
     0     0 64567.4664    0  472 39391.5254 64567.4664  63.9%     -  634s
     0     0 64564.9012    0  435 39391.5254 64564.9012  63.9%     -  636s
     0     0 64564.4503    0  435 39391.5254 64564.4503  63.9%     -  637s
     0     0 64540.6385    0  475 39391.5254 64540.6385  63.8%     -  644s
     0     0 64534.2108    0  482 39391.5254 64534.2108  63.8%     -  649s
     0     0 64527.9823    0  474 39391.5254 64527.9823  63.8%     -  651s
     0     0 64522.9940    0  489 39391.5254 64522.9940  63.8%     -  653s
     0     0 64521.6824    0  484 39391.5254 64521.6824  63.8%     -  655s
     0     0 64516.1839    0  478 39391.5254 64516.1839  63.8%     -  659s
     0     0 64511.1689    0  492 39391.5254 64511.1689  63.8%     -  661s
     0     0 64510.3670    0  479 39391.5254 64510.3670  63.8%     -  663s
     0     0 64500.6862    0  473 39391.5254 64500.6862  63.7%     -  667s
     0     0 64494.0893    0  488 39391.5254 64494.0893  63.7%     -  672s
     0     0 64492.2041    0  492 39391.5254 64492.2041  63.7%     -  674s
     0     0 64468.7185    0  464 39391.5254 64468.7185  63.7%     -  682s
     0     0 64464.3386    0  466 39391.5254 64464.3386  63.7%     -  685s
     0     0 64462.3675    0  465 39391.5254 64462.3675  63.6%     -  686s
     0     0 64441.6663    0  474 39391.5254 64441.6663  63.6%     -  693s
     0     0 64439.4957    0  484 39391.5254 64439.4957  63.6%     -  698s
     0     0 64438.3200    0  401 39391.5254 64438.3200  63.6%     -  701s
     0     0 64437.5238    0  405 39391.5254 64437.5238  63.6%     -  702s
     0     0 64433.8920    0  482 39391.5254 64433.8920  63.6%     -  706s
     0     0 64431.8753    0  405 39391.5254 64431.8753  63.6%     -  709s
     0     0 64425.3914    0  396 39391.5254 64425.3914  63.6%     -  713s
     0     0 64423.7671    0  402 39391.5254 64423.7671  63.5%     -  714s
     0     0 64422.7963    0  400 39391.5254 64422.7963  63.5%     -  717s
     0     0 64422.1209    0  400 39391.5254 64422.1209  63.5%     -  720s
     0     2 64422.1209    0  400 39391.5254 64422.1209  63.5%     - 1018s
     1     4 64397.6756    1  366 39391.5254 64422.1209  63.5%  4884 1029s
     3     8 64367.5331    2  383 39391.5254 64393.0883  63.5%  7234 1049s
     7    15 64194.0848    3  466 39391.5254 64366.6519  63.4% 10699 1077s
    14    30 64019.5858    4  472 39391.5254 64194.0502  63.0% 14118 1121s
    29    45 63284.7158    5  337 39391.5254 64019.2843  62.5% 25332 1228s
    44    76 62950.1136    6  372 39391.5254 64019.2843  62.5% 23703 1358s
    75   112 62873.5782    7  331 39391.5254 63689.5550  61.7% 22312 1477s
   111   145 62628.9666    8  346 39391.5254 63401.3883  61.0% 18857 1533s
   144   210 62414.1784    9  343 39391.5254 63401.2583  61.0% 17594 1606s
   209   326 61716.1823   10  290 39391.5254 63401.2583  61.0% 14320 1677s
   325   395 61330.4469   15  274 39391.5254 63401.2583  61.0% 11028 1737s
   394   424 59896.6143   17  262 39391.5254 63401.2583  61.0% 10091 1792s
   423   454 59442.2975   18  246 39391.5254 63401.2583  61.0% 10001 1835s
   453   485 59318.8080   19  226 39391.5254 63401.2583  61.0%  9938 1881s
   484   518 59247.7659   20  227 39391.5254 63401.2583  61.0%  9764 1940s
   517   552 58974.7672   21  224 39391.5254 63401.2583  61.0%  9637 1970s
   551   586 58820.7600   22  230 39391.5254 63401.2583  61.0%  9618 2001s
   585   623 58521.7055   23  228 39391.5254 63401.2583  61.0%  9768 2039s
   622   673 58055.9062   24  243 39391.5254 63401.2583  61.0%  9541 2081s
   674   732 58028.0696   25  238 39391.5254 63401.2583  61.0%  9185 2118s
   733   794 57801.4380   26  242 39391.5254 63401.2583  61.0%  8746 2155s
   795   860 57765.6086   27  237 39391.5254 63401.2583  61.0%  8412 2197s
   863   944 57754.1769   28  234 39391.5254 63401.2583  61.0%  8075 2235s
   951  1030 57608.5731   29  238 39391.5254 63401.2583  61.0%  7609 2276s
  1039  1119 57537.5481   30  235 39391.5254 63401.2583  61.0%  7242 2321s
  1134  1220 57273.3723   31  228 39391.5254 63401.2583  61.0%  6948 2366s
  1246  1322 57235.5272   32  229 39391.5254 63401.2583  61.0%  6604 2411s
  1354  1399 57006.6908   33  222 39391.5254 63401.2583  61.0%  6337 2459s
  1445  1513 56729.2869   34  205 39391.5254 63401.2583  61.0%  6206 2503s
  1567  1633 56409.7745   36  203 39391.5254 63401.2583  61.0%  5937 2546s
  1698  1711 55273.7805   39  159 39391.5254 63401.2583  61.0%  5705 2594s
  1845  1736 51027.2474   45  158 39391.5254 63401.2583  61.0%  5473 2650s
  1940  1774 49635.0157   48  142 39391.5254 63401.2583  61.0%  5421 2709s
  2018  1816 42518.5276   54  134 39391.5254 63313.3911  60.7%  5403 2772s
  2110  1875 39891.4599   67   97 39391.5254 63313.3911  60.7%  5378 2838s
  2213  1950 40430.4493   93  108 39391.5254 63313.3911  60.7%  5404 2901s
  2322  2039 40893.6623   86  138 39391.5254 62992.1671  59.9%  5413 2964s
  2439  2140 59297.1989    6  328 39391.5254 62992.1671  59.9%  5384 3036s
  2566  2272 59171.7907    7  344 39391.5254 62992.1671  59.9%  5363 3129s
  2714  2395 58772.6718    9  337 39391.5254 62992.1671  59.9%  5288 3222s
  2895  2576 57447.1137   12  346 39391.5254 62992.1671  59.9%  5235 3324s
  3124  2760 56359.6304   13  270 39391.5254 62992.1671  59.9%  5081 3401s

Cutting planes:
  Learned: 1
  Gomory: 19
  Implied bound: 145
  MIR: 3374
  Flow cover: 3187
  RLT: 63
  Relax-and-lift: 453

Explored 3341 nodes (17386568 simplex iterations) in 3600.02 seconds (8272.94 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 39391.5 38958.8 38898.5 ... 23128.3

Time limit reached
Best objective 3.939152539717e+04, best bound 6.299216709449e+04, gap 59.9130%
  WARNING: Time limit reached. Using best solution found (gap: 59.91%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 39391.53, θ = 227278.62
  Upper Bound (UB) = 39391.53

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227278.62
  [DEBUG]   ✓ Scenario 0: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 227278.62 ≤ Q = 227278.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 227278.62 ≤ Q = 228015.04 (slack: 736.42)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6e173306
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x91e8ccfa
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.408157e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.00s
Presolved: 508 rows, 514 columns, 1438 nonzeros
Found heuristic solution: objective 6817150.1586
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.751341e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -175134.15    0  128 6817150.16 -175134.15   103%     -    0s
H    0     0                    -140701.0348 -175134.15  24.5%     -    0s
H    0     0                    -141033.4660 -175134.15  24.2%     -    0s
     0     0 -151903.65    0   64 -141033.47 -151903.65  7.71%     -    0s
H    0     0                    -151152.3481 -151903.52  0.50%     -    0s
     0     0 -151807.21    0   64 -151152.35 -151807.21  0.43%     -    0s
     0     0 -151316.62    0   11 -151152.35 -151316.62  0.11%     -    0s
     0     0 -151297.29    0   11 -151152.35 -151297.29  0.10%     -    0s
     0     0 -151250.34    0    6 -151152.35 -151250.34  0.06%     -    0s
     0     0 -151250.34    0   27 -151152.35 -151250.34  0.06%     -    0s
     0     0 -151238.85    0    8 -151152.35 -151238.85  0.06%     -    0s
H    0     0                    -151190.7340 -151231.44  0.03%     -    0s
     0     0 -151215.81    0    8 -151190.73 -151215.81  0.02%     -    0s
*    0     0               0    -151204.8688 -151204.87  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 9
  MIR: 16
  Flow cover: 9
  Relax-and-lift: 1

Explored 1 nodes (620 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 256 available processors)

Solution count 7: -151205 -151191 -151152 ... 1.40816e+13
No other solutions better than -151205

Optimal solution found (tolerance 1.00e-06)
Best objective -1.512048688498e+05, best bound -1.512048688498e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 220242.33
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -151204.87
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -151204.87 = 220242.33
  [DEBUG]   Current θ from Master = 227278.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7036.29 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 32355.23
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 984.2553, Absolute Gap = 984.2553, Relative Gap = 0.024986
  Not converged yet (gap = 984.26 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783785 nonzeros
Model fingerprint: 0x96a0b3aa
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 123784 rows and 50264 columns
Presolve time: 2.44s
Presolved: 152819 rows, 64316 columns, 940199 nonzeros
Variable types: 62057 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314726.8092
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.47s

Barrier statistics:
 Dense cols : 694
 AA' NZ     : 7.368e+06
 Factor NZ  : 1.711e+07 (roughly 230 MB of memory)
 Factor Ops : 4.408e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.95313116e+07  2.82668970e+08  1.56e+05 1.57e+01  9.31e+04     5s
   1  -1.53828970e+07  2.66842108e+08  1.13e+05 1.02e+02  6.64e+04     5s
   2  -4.96761024e+06  2.14173817e+08  3.61e+04 9.20e-01  2.28e+04     5s
   3  -1.23312481e+06  1.55999778e+08  4.82e+03 1.00e+00  3.48e+03     5s
   4  -6.49445665e+05  9.71858241e+07  7.02e+02 2.64e-01  7.44e+02     5s
   5  -5.46779685e+05  5.31024324e+07  3.03e+02 1.23e-01  3.42e+02     5s
   6  -4.57929941e+05  3.98211458e+07  1.46e+02 8.72e-02  2.11e+02     5s
   7  -3.79998494e+05  2.87099572e+07  8.17e+01 5.91e-02  1.37e+02     5s
   8  -2.70347207e+05  2.06091150e+07  2.97e+01 4.05e-02  8.51e+01     5s
   9  -2.10580766e+05  1.61981277e+07  1.72e+01 3.11e-02  6.38e+01     5s
  10  -1.77488771e+05  9.21711986e+06  1.20e+01 1.70e-02  3.60e+01     5s
  11  -1.25631350e+05  4.51041149e+06  6.06e+00 8.22e-03  1.73e+01     5s
  12  -8.14203393e+04  2.09480194e+06  2.30e+00 3.70e-03  7.94e+00     5s
  13  -4.72158011e+04  6.36259823e+05  1.05e+00 1.04e-03  2.47e+00     5s
  14  -1.49014040e+04  3.23083000e+05  4.81e-01 5.01e-04  1.22e+00     5s
  15  -4.54601204e+03  2.44486175e+05  3.96e-01 1.27e-03  8.98e-01     5s
  16   2.80458878e+04  1.94694752e+05  2.32e-01 1.61e-03  6.00e-01     5s
  17   3.47437411e+04  1.61933006e+05  2.01e-01 1.34e-03  4.58e-01     6s
  18   4.36019579e+04  1.52107730e+05  1.60e-01 1.46e-03  3.91e-01     6s
  19   5.28983241e+04  1.27798377e+05  1.16e-01 1.17e-03  2.70e-01     6s
  20   5.95148246e+04  1.14684355e+05  8.57e-02 1.63e-03  1.99e-01     6s
  21   6.21294298e+04  1.06056290e+05  7.45e-02 1.36e-03  1.58e-01     6s
  22   6.72525179e+04  1.00505984e+05  5.38e-02 1.44e-03  1.20e-01     6s
  23   6.86208891e+04  9.44801934e+04  4.83e-02 2.05e-03  9.32e-02     6s
  24   7.03863250e+04  9.28107023e+04  4.14e-02 1.56e-03  8.08e-02     6s
  25   7.17027351e+04  8.97698743e+04  3.66e-02 8.75e-04  6.52e-02     6s
  26   7.31748255e+04  8.86892028e+04  3.13e-02 7.31e-04  5.60e-02     6s
  27   7.52243347e+04  8.74823215e+04  2.41e-02 9.68e-04  4.42e-02     6s
  28   7.59883672e+04  8.65407784e+04  2.14e-02 8.27e-04  3.81e-02     6s
  29   7.78214595e+04  8.57398287e+04  1.54e-02 6.49e-04  2.86e-02     6s
  30   7.87993602e+04  8.51333476e+04  1.21e-02 5.45e-04  2.28e-02     6s
  31   7.91914706e+04  8.46426219e+04  1.08e-02 8.25e-04  1.97e-02     6s
  32   8.00277355e+04  8.39747026e+04  8.12e-03 6.58e-04  1.42e-02     7s
  33   8.09210478e+04  8.36468314e+04  5.38e-03 4.38e-04  9.83e-03     7s
  34   8.15940452e+04  8.35728610e+04  3.21e-03 4.05e-04  7.13e-03     7s
  35   8.17424089e+04  8.34397777e+04  2.74e-03 3.46e-04  6.11e-03     7s
  36   8.20684866e+04  8.31469031e+04  1.73e-03 2.14e-04  3.88e-03     7s
  37   8.22529839e+04  8.30243242e+04  1.15e-03 1.58e-04  2.78e-03     7s
  38   8.24120923e+04  8.29355186e+04  7.03e-04 1.16e-04  1.88e-03     7s
  39   8.24362866e+04  8.28325845e+04  6.35e-04 7.05e-05  1.43e-03     7s
  40   8.25225416e+04  8.27745426e+04  4.07e-04 4.35e-05  9.08e-04     7s
  41   8.25568579e+04  8.27218042e+04  3.13e-04 1.99e-05  5.95e-04     7s
  42   8.26295634e+04  8.27027913e+04  1.16e-04 1.14e-05  2.64e-04     7s
  43   8.26404518e+04  8.26867617e+04  8.92e-05 4.04e-06  1.67e-04     7s
  44   8.26480520e+04  8.26806187e+04  7.01e-05 1.24e-06  1.17e-04     7s
  45   8.26685943e+04  8.26792991e+04  1.79e-05 7.44e-07  3.86e-05     8s
  46   8.26727679e+04  8.26782839e+04  8.95e-06 3.46e-07  1.99e-05     8s
  47   8.26762514e+04  8.26778653e+04  1.61e-06 2.02e-07  5.81e-06     8s
  48   8.26770609e+04  8.26773128e+04  3.18e-07 2.19e-08  9.08e-07     8s
  49   8.26772636e+04  8.26772802e+04  4.69e-08 1.32e-08  5.98e-08     8s
  50   8.26772754e+04  8.26772800e+04  1.29e-06 6.28e-10  1.68e-08     8s
  51   8.26772799e+04  8.26772800e+04  4.36e-07 2.43e-08  6.96e-10     8s

Barrier solved model in 51 iterations and 8.01 seconds (15.12 work units)
Optimal objective 8.26772799e+04


Root crossover log...

  134630 DPushes remaining with DInf 0.0000000e+00                 8s
   27918 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

    7804 PPushes remaining with PInf 8.7452075e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                13s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5669242e+04     13s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   69330    8.2677280e+04   0.000000e+00   1.566924e+04     14s
   69651    8.2677280e+04   0.000000e+00   0.000000e+00     14s
   69651    8.2677280e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 4.38s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.267728e+04, 69651 iterations, 15.15 seconds (27.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82677.2800    0  178 -183060.80 82677.2800   145%     -   18s
H    0     0                    -181038.9918 82677.2800   146%     -   18s
H    0     0                    -180927.0255 82677.2800   146%     -   20s
H    0     0                    -180636.5529 82677.2800   146%     -   20s
H    0     0                    -177501.3680 82677.2800   147%     -   21s
H    0     0                    -175643.9173 82677.2800   147%     -   21s
H    0     0                    -61041.35829 82677.2800   235%     -   21s
H    0     0                    -18734.68638 82677.2800   541%     -   21s
H    0     0                    -16495.04739 82677.2800   601%     -   22s
H    0     0                    1544.4745739 82677.2800  5253%     -   22s
H    0     0                    22185.607560 82677.2800   273%     -   22s
H    0     0                    22634.649587 82677.2800   265%     -   22s
H    0     0                    22652.145450 82677.2800   265%     -   22s
H    0     0                    22839.683849 82677.2800   262%     -   22s
H    0     0                    23229.834341 82677.2800   256%     -   22s
H    0     0                    23246.113497 82677.2800   256%     -   22s
     0     0 75207.8262    0  236 23246.1135 75207.8262   224%     -   75s
     0     0 74746.8057    0  230 23246.1135 74746.8057   222%     -   90s
     0     0 74736.5433    0  232 23246.1135 74736.5433   222%     -   94s
     0     0 74591.0013    0  226 23246.1135 74591.0013   221%     -  100s
     0     0 74518.0381    0  233 23246.1135 74518.0381   221%     -  105s
     0     0 74475.7128    0  236 23246.1135 74475.7128   220%     -  109s
     0     0 74417.6578    0  239 23246.1135 74417.6578   220%     -  115s
     0     0 74404.3752    0  244 23246.1135 74404.3752   220%     -  117s
     0     0 74392.2436    0  246 23246.1135 74392.2436   220%     -  120s
     0     0 74382.9778    0  240 23246.1135 74382.9778   220%     -  122s
     0     0 74368.9444    0  246 23246.1135 74368.9444   220%     -  123s
     0     0 74368.9203    0  246 23246.1135 74368.9203   220%     -  123s
     0     0 70269.1987    0  298 23246.1135 70269.1987   202%     -  202s
H    0     0                    31341.807892 70269.1469   124%     -  203s
     0     0 69689.7181    0  318 31341.8079 69689.7181   122%     -  260s
     0     0 69508.3307    0  355 31341.8079 69508.3307   122%     -  282s
     0     0 69439.5749    0  318 31341.8079 69439.5749   122%     -  293s
     0     0 69427.4535    0  327 31341.8079 69427.4535   122%     -  297s
     0     0 69388.9963    0  324 31341.8079 69388.9963   121%     -  306s
     0     0 69352.6725    0  362 31341.8079 69352.6725   121%     -  311s
     0     0 69265.3584    0  335 31341.8079 69265.3584   121%     -  321s
     0     0 69238.0272    0  337 31341.8079 69238.0272   121%     -  328s
     0     0 69232.9699    0  340 31341.8079 69232.9699   121%     -  332s
     0     0 69232.6518    0  340 31341.8079 69232.6518   121%     -  333s
     0     0 66533.3201    0  361 31341.8079 66533.3201   112%     -  396s
     0     0 66126.6022    0  376 31341.8079 66126.6022   111%     -  426s
     0     0 65900.1669    0  380 31341.8079 65900.1669   110%     -  446s
     0     0 65834.0858    0  362 31341.8079 65834.0858   110%     -  455s
     0     0 65786.4897    0  356 31341.8079 65786.4897   110%     -  461s
     0     0 65763.9187    0  361 31341.8079 65763.9187   110%     -  467s
     0     0 65720.8964    0  353 31341.8079 65720.8964   110%     -  475s
     0     0 65698.5138    0  363 31341.8079 65698.5138   110%     -  480s
     0     0 65691.4415    0  359 31341.8079 65691.4415   110%     -  482s
     0     0 65686.0784    0  360 31341.8079 65686.0784   110%     -  483s
     0     0 65682.4360    0  362 31341.8079 65682.4360   110%     -  487s
     0     0 65680.9013    0  360 31341.8079 65680.9013   110%     -  489s
     0     0 65004.5385    0  385 31341.8079 65004.5385   107%     -  535s
H    0     0                    31953.343321 65004.2615   103%     -  535s
     0     0 64870.8383    0  414 31953.3433 64870.8383   103%     -  551s
     0     0 64840.2589    0  427 31953.3433 64840.2589   103%     -  558s
     0     0 64825.8048    0  429 31953.3433 64825.8048   103%     -  564s
     0     0 64818.6878    0  432 31953.3433 64818.6878   103%     -  569s
     0     0 64813.3840    0  418 31953.3433 64813.3840   103%     -  573s
     0     0 64808.4218    0  439 31953.3433 64808.4218   103%     -  576s
     0     0 64807.7103    0  438 31953.3433 64807.7103   103%     -  577s
     0     0 64694.5073    0  346 31953.3433 64694.5073   102%     -  595s
     0     0 64669.8553    0  382 31953.3433 64669.8553   102%     -  605s
     0     0 64645.8345    0  352 31953.3433 64645.8345   102%     -  612s
     0     0 64641.4763    0  355 31953.3433 64641.4763   102%     -  616s
     0     0 64638.1275    0  351 31953.3433 64638.1275   102%     -  618s
     0     0 64637.4435    0  353 31953.3433 64637.4435   102%     -  620s
     0     0 64597.4107    0  438 31953.3433 64597.4107   102%     -  633s
     0     0 64585.4368    0  364 31953.3433 64585.4368   102%     -  641s
     0     0 64581.2480    0  347 31953.3433 64581.2480   102%     -  644s
     0     0 64580.1683    0  359 31953.3433 64580.1683   102%     -  647s
     0     0 64567.3999    0  392 31953.3433 64567.3999   102%     -  656s
     0     0 64564.4932    0  392 31953.3433 64564.4932   102%     -  661s
     0     0 64563.3023    0  355 31953.3433 64563.3023   102%     -  664s
     0     0 64541.1945    0  397 31953.3433 64541.1945   102%     -  672s
     0     0 64533.5214    0  402 31953.3433 64533.5214   102%     -  680s
     0     0 64526.4961    0  449 31953.3433 64526.4961   102%     -  686s
     0     0 64523.9350    0  474 31953.3433 64523.9350   102%     -  689s
     0     0 64521.6244    0  415 31953.3433 64521.6244   102%     -  691s
     0     0 64493.6330    0  363 31953.3433 64493.6330   102%     -  703s
     0     0 64484.5356    0  412 31953.3433 64484.5356   102%     -  710s
     0     0 64481.1241    0  361 31953.3433 64481.1241   102%     -  713s
     0     0 64480.0382    0  360 31953.3433 64480.0382   102%     -  715s
     0     0 64462.4653    0  371 31953.3433 64462.4653   102%     -  723s
     0     0 64458.5115    0  407 31953.3433 64458.5115   102%     -  727s
     0     0 64456.5112    0  465 31953.3433 64456.5112   102%     -  732s
     0     0 64440.8430    0  372 31953.3433 64440.8430   102%     -  738s
     0     0 64434.7880    0  415 31953.3433 64434.7880   102%     -  743s
     0     0 64433.7825    0  376 31953.3433 64433.7825   102%     -  744s
     0     0 64433.2864    0  410 31953.3433 64433.2864   102%     -  747s
H    0     0                    31999.211862 64433.1480   101%     -  749s
H    0     0                    32178.530604 64433.1480   100%     -  749s
     0     0 64432.6792    0  415 32178.5306 64432.6792   100%     -  750s
     0     0 64406.5777    0  406 32178.5306 64406.5777   100%     -  758s
     0     0 64402.7056    0  407 32178.5306 64402.7056   100%     -  762s
     0     0 64400.6348    0  411 32178.5306 64400.6348   100%     -  763s
     0     0 64386.6391    0  460 32178.5306 64386.6391   100%     -  769s
H    0     0                    32635.128757 64386.5806  97.3%     -  770s
     0     0 64385.2232    0  458 32635.1288 64385.2232  97.3%     -  772s
     0     0 64382.8544    0  411 32635.1288 64382.8544  97.3%     -  775s
H    0     0                    33806.849810 64382.5698  90.4%     -  776s
H    0     0                    34931.598667 64382.5698  84.3%     -  776s
H    0     0                    35220.217462 64382.5698  82.8%     -  776s
     0     0 64382.4440    0  373 35220.2175 64382.4440  82.8%     -  777s
     0     0 64371.9528    0  469 35220.2175 64371.9528  82.8%     -  782s
     0     0 64371.4045    0  469 35220.2175 64371.4045  82.8%     -  786s
H    0     0                    35448.154689 64371.3856  81.6%     -  872s
H    0     0                    36401.572750 64371.3856  76.8%     -  958s
H    0     0                    38114.411653 64371.3856  68.9%     -  958s
H    0     0                    38389.628650 64371.3856  67.7%     -  962s
H    0     0                    38403.337077 64371.3856  67.6%     -  965s
H    0     2                    38692.746911 64371.3856  66.4%     - 1013s
     0     2 64371.3856    0  469 38692.7469 64371.3856  66.4%     - 1013s
     1     4 64258.7507    1  439 38692.7469 64371.3856  66.4% 11533 1043s
     3     8 64239.2581    2  467 38692.7469 64258.4076  66.1% 15626 1124s
     7    16 64127.7419    3  414 38692.7469 64239.2352  66.0% 24058 1175s
    15    32 63985.3174    4  373 38692.7469 64150.3191  65.8% 21996 1225s
    31    48 62702.6108    5  362 38692.7469 63985.1124  65.4% 27443 1367s
    47    79 62228.7708    6  380 38692.7469 63985.1124  65.4% 32084 1483s
H   75    79                    38706.719050 63985.1124  65.3% 26112 1483s
    78   186 62224.8572    7  372 38706.7190 63985.1124  65.3% 25498 1581s
   185   267 62101.3758   11  355 38706.7190 63985.1124  65.3% 15473 1638s
   266   331 61865.0216   12  353 38706.7190 63985.1124  65.3% 13494 1681s
   330   359 61799.8478   13  345 38706.7190 63985.1124  65.3% 12246 1722s
   358   395 61594.7414   13  386 38706.7190 63985.1124  65.3% 12086 1759s
   394   426 61694.1109   14  372 38706.7190 63985.1124  65.3% 12016 1793s
   425   461 60902.2510   14  304 38706.7190 63985.1124  65.3% 11789 1832s
   460   494 61538.0592   15  340 38706.7190 63985.1124  65.3% 11725 1865s
   493   523 61420.1061   14  374 38706.7190 63985.1124  65.3% 11436 1899s
   522   552 58061.9318   20  262 38706.7190 63985.1124  65.3% 11578 1931s
H  545   552                    38808.926137 63985.1124  64.9% 11345 1931s
   551   640 58044.5055   21  257 38808.9261 63985.1124  64.9% 11280 1970s
   639   671 61538.0558   16  340 38808.9261 63985.1124  64.9% 10333 2006s
   670   702 57747.0489   23  259 38808.9261 63985.1124  64.9% 10111 2034s
   701   730 61432.4460   17  334 38808.9261 63985.1124  64.9%  9970 2075s
   729   758 61164.8679   18  329 38808.9261 63985.1124  64.9%  9794 2121s
H  736   758                    38814.221677 63985.1124  64.8%  9767 2121s
   757   834 61024.2592   18  326 38814.2217 63985.1124  64.8%  9687 2162s
   834   908 55640.6446   30  244 38814.2217 63985.1124  64.8%  9192 2208s
   914  1001 61093.0234   19  331 38814.2217 63985.1124  64.8%  8736 2254s
  1011  1084 60917.5234   19  323 38814.2217 63985.1124  64.8%  8188 2297s
  1096  1176 60917.8306   19  293 38814.2217 63985.1124  64.8%  7839 2338s
  1190  1268 61043.2027   20  358 38814.2217 63985.1124  64.8%  7516 2381s
  1286  1345 60881.3724   20  288 38814.2217 63985.1124  64.8%  7275 2423s
  1381  1421 49495.7165   63  173 38814.2217 63985.1124  64.8%  7080 2467s
  1486  1488 39238.2370   41  182 38814.2217 63985.1124  64.8%  6897 2514s
  1590  1573 42902.9177   79  101 38814.2217 63985.1124  64.8%  6729 2575s
  1719  1602 40816.7599   53  203 38814.2217 63985.1124  64.8%  6533 2650s
  1826  1621     cutoff   55      38814.2217 63985.1124  64.8%  6435 2698s
  1859  1640 50702.3591   48  239 38814.2217 63985.1124  64.8%  6495 2751s
H 1863  1640                    38941.021174 63985.1124  64.3%  6491 2751s
  1904  1717 47638.9856   49  186 38941.0212 63985.1124  64.3%  6559 2804s
  2049  1768 47199.0791   51  167 38941.0212 63985.1124  64.3%  6379 2866s
  2184  1791 44160.4352   54  134 38941.0212 63985.1124  64.3%  6230 2921s
H 2227  1791                    39079.290292 63985.1124  63.7%  6206 2921s
  2237  1865 43247.5376   58  122 39079.2903 63985.1124  63.7%  6215 2984s
  2363  1971 42193.5454   72  108 39079.2903 63985.1124  63.7%  6110 3052s
  2523  2047 infeasible   85      39079.2903 63833.5715  63.3%  5990 3124s
  2639  2163 56161.8703   10  241 39079.2903 63832.5462  63.3%  5978 3195s
  2785  2303 52726.8750   11  212 39079.2903 63832.5462  63.3%  5923 3275s
  2944  2450 50585.0785   13  209 39079.2903 63832.5462  63.3%  5825 3350s
  3121  2478 48261.3369   13  244 39079.2903 63832.5462  63.3%  5753 3424s
H 3152  2478                    39100.417197 63795.5719  63.2%  5816 3424s
  3155  2570 50488.3479   14  196 39100.4172 63795.5719  63.2%  5815 3533s
  3345  2620 42671.4705   16  159 39100.4172 63795.5719  63.2%  5748 3600s

Cutting planes:
  Learned: 3
  Gomory: 6
  Implied bound: 211
  MIR: 3678
  Flow cover: 3057
  RLT: 67
  Relax-and-lift: 548

Explored 3474 nodes (20724993 simplex iterations) in 3600.08 seconds (7815.75 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 39100.4 39079.3 38941 ... 36401.6

Time limit reached
Best objective 3.910041719727e+04, best bound 6.379557186924e+04, gap 63.1583%
  WARNING: Time limit reached. Using best solution found (gap: 63.16%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 39100.42, θ = 227918.30
  Upper Bound (UB) = 39100.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227918.30
  [DEBUG]   ✓ Scenario 0: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 227918.30 ≤ Q = 227918.30 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7692fc3e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x896d03c2
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.412150e+13
Presolve removed 2584 rows and 1874 columns
Presolve time: 0.00s
Presolved: 509 rows, 515 columns, 1438 nonzeros
Found heuristic solution: objective 6813063.8796
Variable types: 351 continuous, 164 integer (164 binary)

Root relaxation: objective -1.742039e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174203.85    0  123 6813063.88 -174203.85   103%     -    0s
H    0     0                    -141145.1068 -174203.85  23.4%     -    0s
H    0     0                    -141477.5380 -174203.85  23.1%     -    0s
     0     0 -154234.42    0   75 -141477.54 -154234.42  9.02%     -    0s
H    0     0                    -151339.9846 -154106.21  1.83%     -    0s
H    0     0                    -151611.4354 -154106.21  1.65%     -    0s
H    0     0                    -152050.6154 -154106.21  1.35%     -    0s
H    0     0                    -152322.0661 -154106.21  1.17%     -    0s
     0     0 -152651.79    0   65 -152322.07 -152651.79  0.22%     -    0s
     0     0 -152609.20    0   58 -152322.07 -152609.20  0.19%     -    0s
     0     0 -152590.68    0   25 -152322.07 -152590.68  0.18%     -    0s
     0     0 -152586.73    0   25 -152322.07 -152586.73  0.17%     -    0s
     0     0 -152586.73    0   25 -152322.07 -152586.73  0.17%     -    0s
     0     0 -152586.38    0   25 -152322.07 -152586.38  0.17%     -    0s
     0     0 -152499.25    0   12 -152322.07 -152499.25  0.12%     -    0s
     0     0 -152499.25    0   20 -152322.07 -152499.25  0.12%     -    0s
H    0     0                    -152372.3990 -152499.25  0.08%     -    0s
     0     0 -152412.37    0    4 -152372.40 -152412.37  0.03%     -    0s
     0     0 -152407.01    0    4 -152372.40 -152407.01  0.02%     -    0s
     0     0 -152403.07    0    2 -152372.40 -152403.07  0.02%     -    0s
H    0     0                    -152380.7786 -152403.07  0.01%     -    0s
     0     0 -152399.23    0    6 -152380.78 -152399.23  0.01%     -    0s
     0     0 -152399.05    0    2 -152380.78 -152399.05  0.01%     -    0s
*    0     0               0    -152396.6606 -152396.66  0.00%     -    0s

Cutting planes:
  Gomory: 11
  MIR: 7
  Flow cover: 8
  Relax-and-lift: 9

Explored 1 nodes (709 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -152397 -152381 -152372 ... 1.41215e+13
No other solutions better than -152397

Optimal solution found (tolerance 1.00e-06)
Best objective -1.523966605612e+05, best bound -1.523966605612e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 219050.54
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -152396.66
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -152396.66 = 219050.54
  [DEBUG]   Current θ from Master = 227918.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8867.76 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 30232.66
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 693.1471, Absolute Gap = 693.1471, Relative Gap = 0.017727
  Not converged yet (gap = 693.15 > ε = 200)

  [DEBUG] Adding NEW scenario 18 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 18 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 18 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 18]
    [DEBUG]   - Total constraints in model: 291893
    [DEBUG]   - Total variables in model: 120820
  [DEBUG] Total scenarios in Master: 19
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 19
================================================================================
[Iteration 19] Solving Master Problem...
  Current scenarios in Master: 19
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 291893 rows, 120820 columns and 827022 nonzeros
Model fingerprint: 0xa9c5de32
Variable types: 118561 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 130652 rows and 53052 columns
Presolve time: 2.42s
Presolved: 161241 rows, 67768 columns, 991988 nonzeros
Variable types: 65509 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314726.8092
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 693
 AA' NZ     : 8.135e+06
 Factor NZ  : 1.886e+07 (roughly 250 MB of memory)
 Factor Ops : 5.059e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.98969668e+07  2.96508582e+08  1.59e+05 1.52e+01  9.44e+04     4s
   1  -1.57056960e+07  2.80811332e+08  1.15e+05 1.02e+02  6.74e+04     4s
   2  -5.27039359e+06  2.24811950e+08  3.82e+04 2.81e+00  2.40e+04     4s
   3  -1.20345089e+06  1.60619145e+08  4.65e+03 8.77e-01  3.36e+03     5s
   4  -6.43741704e+05  1.05023176e+08  7.10e+02 3.36e-01  7.60e+02     5s
   5  -5.46161182e+05  5.89698627e+07  3.12e+02 1.48e-01  3.59e+02     5s
   6  -4.61434274e+05  4.34570046e+07  1.39e+02 1.04e-01  2.14e+02     5s
   7  -3.92428807e+05  3.15571741e+07  7.95e+01 7.09e-02  1.41e+02     5s
   8  -3.10225610e+05  2.18265381e+07  2.99e+01 4.57e-02  8.55e+01     5s
   9  -2.19415439e+05  1.79392689e+07  1.21e+01 3.68e-02  6.54e+01     5s
  10  -1.82456385e+05  1.21644210e+07  8.97e+00 2.45e-02  4.40e+01     5s
  11  -1.49033169e+05  5.59602256e+06  6.21e+00 1.08e-02  2.03e+01     5s
  12  -1.09567086e+05  2.97441841e+06  3.27e+00 5.50e-03  1.07e+01     5s
  13  -6.44622704e+04  1.63956385e+06  1.11e+00 2.88e-03  5.84e+00     5s
  14  -3.11354855e+04  5.89391891e+05  5.11e-01 1.03e-03  2.12e+00     5s
  15  -1.25899253e+04  3.19624511e+05  3.30e-01 3.72e-04  1.13e+00     5s
  16   1.23608117e+04  2.41189766e+05  2.26e-01 7.19e-04  7.81e-01     5s
  17   3.22705150e+04  1.91319098e+05  1.59e-01 1.15e-03  5.43e-01     5s
  18   4.28917027e+04  1.66283071e+05  1.22e-01 9.57e-04  4.21e-01     5s
  19   5.29077411e+04  1.34244254e+05  8.56e-02 1.19e-03  2.78e-01     5s
  20   5.86311814e+04  1.18213614e+05  6.63e-02 2.01e-03  2.03e-01     5s
  21   6.29582965e+04  1.14059993e+05  5.26e-02 1.70e-03  1.74e-01     5s
  22   6.53559299e+04  1.03972009e+05  4.51e-02 1.58e-03  1.32e-01     6s
  23   7.02928858e+04  9.99426725e+04  3.07e-02 1.30e-03  1.01e-01     6s
  24   7.09160878e+04  9.56823380e+04  2.82e-02 1.02e-03  8.45e-02     6s
  25   7.34177310e+04  9.40558092e+04  2.14e-02 1.02e-03  7.04e-02     6s
  26   7.46487617e+04  9.14278440e+04  1.82e-02 8.08e-04  5.72e-02     6s
  27   7.55723723e+04  8.84738758e+04  1.59e-02 5.50e-04  4.40e-02     6s
  28   7.65835276e+04  8.74601757e+04  1.34e-02 4.57e-04  3.71e-02     6s
  29   7.70782977e+04  8.67895793e+04  1.23e-02 3.96e-04  3.31e-02     6s
  30   7.76879236e+04  8.61014865e+04  1.09e-02 3.27e-04  2.87e-02     6s
  31   7.85715860e+04  8.55638408e+04  8.88e-03 2.76e-04  2.39e-02     6s
  32   7.94515824e+04  8.51023028e+04  6.90e-03 2.35e-04  1.93e-02     6s
  33   7.96133793e+04  8.49128877e+04  6.53e-03 2.17e-04  1.81e-02     6s
  34   7.99903126e+04  8.45615710e+04  5.69e-03 1.84e-04  1.56e-02     6s
  35   8.00632073e+04  8.42983144e+04  5.51e-03 1.59e-04  1.45e-02     6s
  36   8.04492832e+04  8.39050196e+04  4.67e-03 1.21e-04  1.18e-02     6s
  37   8.07988469e+04  8.36982389e+04  3.91e-03 9.96e-05  9.90e-03     7s
  38   8.11520776e+04  8.35311765e+04  3.18e-03 8.34e-05  8.12e-03     7s
  39   8.15309097e+04  8.32101569e+04  2.35e-03 1.57e-04  5.73e-03     7s
  40   8.18806508e+04  8.30594157e+04  1.60e-03 1.20e-04  4.02e-03     7s
  41   8.20153275e+04  8.29190096e+04  1.32e-03 8.67e-05  3.09e-03     7s
  42   8.22333621e+04  8.28568245e+04  8.67e-04 6.34e-05  2.13e-03     7s
  43   8.23506841e+04  8.27534076e+04  6.20e-04 3.35e-05  1.38e-03     7s
  44   8.24895238e+04  8.27401228e+04  3.58e-04 2.73e-05  8.56e-04     7s
  45   8.25327611e+04  8.27202291e+04  2.73e-04 1.89e-05  6.40e-04     7s
  46   8.25856054e+04  8.27040848e+04  1.69e-04 1.18e-05  4.05e-04     7s
  47   8.26027519e+04  8.26997183e+04  1.36e-04 9.66e-06  3.31e-04     7s
  48   8.26220269e+04  8.26849128e+04  9.97e-05 2.70e-06  2.15e-04     7s
  49   8.26621257e+04  8.26800204e+04  2.39e-05 3.41e-06  6.11e-05     7s
  50   8.26637289e+04  8.26793954e+04  2.14e-05 2.56e-06  5.35e-05     7s
  51   8.26707524e+04  8.26783085e+04  1.00e-05 1.15e-06  2.58e-05     7s
  52   8.26720585e+04  8.26782428e+04  7.93e-06 1.09e-06  2.11e-05     8s
  53   8.26769710e+04  8.26773334e+04  4.14e-07 3.66e-08  1.24e-06     8s
  54   8.26772781e+04  8.26772801e+04  2.88e-08 2.28e-08  6.75e-09     8s
  55   8.26772799e+04  8.26772800e+04  2.20e-07 1.67e-07  3.38e-10     8s

Barrier solved model in 55 iterations and 7.77 seconds (17.30 work units)
Optimal objective 8.26772799e+04


Root crossover log...

  141974 DPushes remaining with DInf 0.0000000e+00                 8s
   10577 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    5169 PPushes remaining with PInf 8.2419627e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.3945285e+00     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   68421    8.2677280e+04   0.000000e+00   8.394529e+00     12s
   68508    8.2677280e+04   0.000000e+00   0.000000e+00     12s
   68508    8.2677280e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 3.04s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.267728e+04, 68508 iterations, 12.32 seconds (26.16 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82677.2800    0  178 -183060.80 82677.2800   145%     -   16s
H    0     0                    -180310.9124 82677.2800   146%     -   16s
H    0     0                    -95489.17378 82677.2800   187%     -   16s
H    0     0                    -94963.04399 82677.2800   187%     -   17s
H    0     0                    -94577.41104 82677.2800   187%     -   17s
H    0     0                    -94334.51179 82677.2800   188%     -   17s
H    0     0                    -94267.81879 82677.2800   188%     -   17s
H    0     0                    -61041.35829 82677.2800   235%     -   17s
H    0     0                    -18734.68638 82677.2800   541%     -   18s
H    0     0                    -16751.46280 82677.2800   594%     -   18s
H    0     0                     659.8724021 82677.2800      -     -   18s
H    0     0                    16416.753200 82677.2800   404%     -   19s
H    0     0                    22185.607560 82677.2800   273%     -   19s
H    0     0                    22899.271752 82677.2800   261%     -   19s
H    0     0                    23038.743517 82677.2800   259%     -   19s
H    0     0                    23229.834341 82677.2800   256%     -   19s
H    0     0                    23272.617929 82677.2800   255%     -   19s
     0     0 75100.0991    0  220 23272.6179 75100.0991   223%     -   85s
H    0     0                    23879.430757 75099.7170   214%     -   86s
     0     0 74679.5590    0  240 23879.4308 74679.5590   213%     -  107s
     0     0 74508.1198    0  218 23879.4308 74508.1198   212%     -  121s
     0     0 74376.1219    0  231 23879.4308 74376.1219   211%     -  128s
     0     0 74311.3177    0  230 23879.4308 74311.3177   211%     -  133s
     0     0 74281.2488    0  230 23879.4308 74281.2488   211%     -  139s
     0     0 74223.2691    0  236 23879.4308 74223.2691   211%     -  144s
     0     0 74222.2669    0  241 23879.4308 74222.2669   211%     -  146s
     0     0 74210.7114    0  241 23879.4308 74210.7114   211%     -  150s
     0     0 74202.1293    0  243 23879.4308 74202.1293   211%     -  152s
     0     0 74202.1240    0  243 23879.4308 74202.1240   211%     -  152s
     0     0 69884.9725    0  301 23879.4308 69884.9725   193%     -  214s
H    0     0                    24190.762147 69884.4451   189%     -  214s
H    0     0                    31686.730787 69884.4451   121%     -  215s
H    0     0                    32284.486273 69884.4451   116%     -  215s
     0     0 69205.8705    0  320 32284.4863 69205.8705   114%     -  255s
     0     0 69070.2576    0  356 32284.4863 69070.2576   114%     -  273s
     0     0 68915.8838    0  348 32284.4863 68915.8838   113%     -  293s
     0     0 68897.1439    0  339 32284.4863 68897.1439   113%     -  301s
     0     0 68800.6077    0  345 32284.4863 68800.6077   113%     -  310s
     0     0 68767.8332    0  352 32284.4863 68767.8332   113%     -  317s
     0     0 68713.3111    0  349 32284.4863 68713.3111   113%     -  324s
     0     0 68693.0380    0  349 32284.4863 68693.0380   113%     -  328s
     0     0 68687.3959    0  350 32284.4863 68687.3959   113%     -  331s
     0     0 68680.1802    0  354 32284.4863 68680.1802   113%     -  334s
     0     0 68671.6448    0  357 32284.4863 68671.6448   113%     -  336s
     0     0 68667.7098    0  357 32284.4863 68667.7098   113%     -  337s
     0     0 68667.4085    0  357 32284.4863 68667.4085   113%     -  338s
     0     0 66326.1284    0  325 32284.4863 66326.1284   105%     -  392s
H    0     0                    35238.944615 66325.8342  88.2%     -  393s
H    0     0                    36129.052000 66325.8342  83.6%     -  393s
H    0     0                    36236.805278 66325.8342  83.0%     -  393s
H    0     0                    36336.143186 66325.8342  82.5%     -  393s
H    0     0                    36475.358377 66325.8342  81.8%     -  393s
H    0     0                    36812.897861 66325.8342  80.2%     -  393s
H    0     0                    37265.711849 66325.8342  78.0%     -  393s
H    0     0                    37311.591689 66325.8342  77.8%     -  393s
H    0     0                    37605.590465 66325.8342  76.4%     -  393s
H    0     0                    38082.345140 66325.8342  74.2%     -  393s
     0     0 66041.9315    0  373 38082.3451 66041.9315  73.4%     -  416s
     0     0 65886.6533    0  375 38082.3451 65886.6533  73.0%     -  433s
     0     0 65793.6609    0  390 38082.3451 65793.6609  72.8%     -  444s
     0     0 65744.7509    0  389 38082.3451 65744.7509  72.6%     -  454s
     0     0 65734.7097    0  390 38082.3451 65734.7097  72.6%     -  458s
     0     0 65722.0110    0  397 38082.3451 65722.0110  72.6%     -  465s
     0     0 65712.5239    0  392 38082.3451 65712.5239  72.6%     -  470s
     0     0 65685.9539    0  383 38082.3451 65685.9539  72.5%     -  478s
     0     0 65681.9561    0  382 38082.3451 65681.9561  72.5%     -  481s
     0     0 65672.7148    0  379 38082.3451 65672.7148  72.4%     -  484s
     0     0 65654.7102    0  385 38082.3451 65654.7102  72.4%     -  489s
     0     0 65647.3695    0  385 38082.3451 65647.3695  72.4%     -  493s
     0     0 65642.2564    0  380 38082.3451 65642.2564  72.4%     -  496s
     0     0 65637.2255    0  382 38082.3451 65637.2255  72.4%     -  498s
     0     0 65629.7852    0  380 38082.3451 65629.7852  72.3%     -  502s
     0     0 65627.9334    0  379 38082.3451 65627.9334  72.3%     -  504s
     0     0 64974.4192    0  453 38082.3451 64974.4192  70.6%     -  547s
H    0     0                    38180.843128 64973.1229  70.2%     -  548s
     0     0 64857.2978    0  365 38180.8431 64857.2978  69.9%     -  565s
     0     0 64810.5486    0  440 38180.8431 64810.5486  69.7%     -  578s
     0     0 64782.3366    0  441 38180.8431 64782.3366  69.7%     -  586s
     0     0 64767.5201    0  442 38180.8431 64767.5201  69.6%     -  590s
     0     0 64753.5353    0  452 38180.8431 64753.5353  69.6%     -  595s
     0     0 64748.1489    0  445 38180.8431 64748.1489  69.6%     -  598s
     0     0 64747.2844    0  445 38180.8431 64747.2844  69.6%     -  600s
     0     0 64681.9929    0  360 38180.8431 64681.9929  69.4%     -  610s
     0     0 64647.3818    0  408 38180.8431 64647.3818  69.3%     -  619s
     0     0 64638.7979    0  383 38180.8431 64638.7979  69.3%     -  623s
     0     0 64638.0382    0  379 38180.8431 64638.0382  69.3%     -  624s
     0     0 64567.0214    0  409 38180.8431 64567.0214  69.1%     -  639s
H    0     0                    38834.771630 64566.8326  66.3%     -  649s
     0     0 64559.6304    0  406 38834.7716 64559.6304  66.2%     -  657s
     0     0 64551.5767    0  374 38834.7716 64551.5767  66.2%     -  663s
     0     0 64542.3419    0  408 38834.7716 64542.3419  66.2%     -  668s
     0     0 64539.8030    0  406 38834.7716 64539.8030  66.2%     -  671s
     0     0 64538.9595    0  405 38834.7716 64538.9595  66.2%     -  672s
     0     0 64495.8443    0  395 38834.7716 64495.8443  66.1%     -  682s
     0     0 64488.4506    0  377 38834.7716 64488.4506  66.1%     -  687s
     0     0 64484.7617    0  368 38834.7716 64484.7617  66.0%     -  689s
     0     0 64483.2207    0  393 38834.7716 64483.2207  66.0%     -  691s
     0     0 64453.0734    0  404 38834.7716 64453.0734  66.0%     -  699s
     0     0 64449.0354    0  375 38834.7716 64449.0354  66.0%     -  703s
     0     0 64448.6709    0  407 38834.7716 64448.6709  66.0%     -  704s
     0     0 64436.2859    0  403 38834.7716 64436.2859  65.9%     -  712s
     0     0 64432.8089    0  367 38834.7716 64432.8089  65.9%     -  715s
     0     0 64430.7256    0  365 38834.7716 64430.7256  65.9%     -  718s
     0     0 64418.4941    0  408 38834.7716 64418.4941  65.9%     -  725s
     0     0 64411.0809    0  376 38834.7716 64411.0809  65.9%     -  733s
     0     0 64407.3567    0  413 38834.7716 64407.3567  65.8%     -  737s
     0     0 64405.6133    0  405 38834.7716 64405.6133  65.8%     -  739s
     0     0 64403.3352    0  402 38834.7716 64403.3352  65.8%     -  742s
     0     0 64403.0626    0  402 38834.7716 64403.0626  65.8%     -  746s
H    0     0                    39049.930374 64402.9213  64.9%     -  911s
     0     2 64402.9213    0  402 39049.9304 64402.9213  64.9%     -  917s
     1     3 63157.9061    1  302 39049.9304 64402.9213  64.9% 24488  949s
     2     4 64333.3889    1  398 39049.9304 64333.3889  64.7% 16444  963s
     3     6 64321.3344    2  370 39049.9304 64333.3697  64.7% 13621  981s
     5    11 61816.8986    3  331 39049.9304 64333.3697  64.7% 14178 1007s
    10    20 63756.4933    4  348 39049.9304 64321.2403  64.7% 14484 1042s
    19    29 62056.3160    4  348 39049.9304 63995.1600  63.9% 21955 1149s
    28    55 62703.6102    4  362 39049.9304 63987.1369  63.9% 21834 1374s
H   29    55                    39100.843236 63987.1369  63.6% 21081 1374s
H   38    55                    39257.675983 63987.1369  63.0% 20062 1374s
    54    87 62499.2687    5  349 39257.6760 63987.1369  63.0% 31316 1477s
    86   195 62215.0318    6  341 39257.6760 63987.1369  63.0% 27010 1590s
H  125   195                    39377.445177 63987.1369  62.5% 22305 1590s
   194   256 61568.7772    9  307 39377.4452 63987.1369  62.5% 18681 1655s
   255   306 61282.9513   10  312 39377.4452 63987.1369  62.5% 16905 1716s
   305   367 61225.5079   11  300 39377.4452 63987.1369  62.5% 16042 1774s
   366   397 61044.0259   15  312 39377.4452 63987.1369  62.5% 15199 1818s
   396   398 59753.1742   14  293 39377.4452 63987.1369  62.5% 15003 1884s
   397   426 60778.0825   16  312 39377.4452 63987.1369  62.5% 15024 1930s
   425   457 60734.1995   17  309 39377.4452 63987.1369  62.5% 15162 1969s
   456   489 60622.9597   18  300 39377.4452 63987.1369  62.5% 14812 2007s
   488   520 60562.5462   19  305 39377.4452 63987.1369  62.5% 14739 2043s
   519   552 60391.1126   20  291 39377.4452 63987.1369  62.5% 14741 2072s
   551   584 60380.3326   21  297 39377.4452 63987.1369  62.5% 14556 2106s
   583   616 60359.5790   22  294 39377.4452 63987.1369  62.5% 14394 2138s
   615   648 59868.2202   23  292 39377.4452 63987.1369  62.5% 14380 2171s
   647   680 59628.9246   24  301 39377.4452 63987.1369  62.5% 14344 2204s
   679   724 59499.7019   25  281 39377.4452 63987.1369  62.5% 14354 2243s
   723   767 59369.9667   27  310 39377.4452 63987.1369  62.5% 14194 2281s
   766   832 59006.9377   30  297 39377.4452 63987.1369  62.5% 14147 2317s
   831   864 58621.9541   34  295 39377.4452 63987.1369  62.5% 13784 2351s
   863   900 58572.8039   35  293 39377.4452 63987.1369  62.5% 13745 2383s
   899   956 58513.7497   36  288 39377.4452 63987.1369  62.5% 13686 2422s
   955  1041 58221.9682   39  278 39377.4452 63987.1369  62.5% 13578 2462s
  1040  1149 57468.4243   45  261 39377.4452 63987.1369  62.5% 13151 2504s
  1150  1248 51865.7935   50  316 39377.4452 63987.1369  62.5% 12700 2550s
  1261  1334 50739.5430   52  247 39377.4452 63987.1369  62.5% 12318 2604s
  1369  1443 49770.4899   56  199 39377.4452 63987.1369  62.5% 12139 2660s
  1486  1562 48965.4371   64  209 39377.4452 63987.1369  62.5% 11942 2717s
  1611  1691 43821.7232   74  141 39377.4452 63987.1369  62.5% 11811 2772s
  1760  1796 42038.5714   85   85 39377.4452 63987.1369  62.5% 11446 2825s
  1893  1875 61629.3523    8  335 39377.4452 63987.1369  62.5% 11357 2889s
  2006  1956 58626.8664    9  334 39377.4452 63987.1369  62.5% 11423 2950s
  2135  2032 52561.8698   10  321 39377.4452 63987.1369  62.5% 11402 3019s
  2268  2104 61490.8226    9  338 39377.4452 63987.1369  62.5% 11453 3093s
  2384  2227 56436.3604   11  264 39377.4452 63987.1369  62.5% 11580 3167s
  2540  2403 48524.5070   12  210 39377.4452 63987.1369  62.5% 11524 3231s
  2753  2581 52148.1460   12  294 39377.4452 63986.9285  62.5% 11221 3302s
  2979  2768 51081.9226   13  304 39377.4452 63986.9285  62.5% 10982 3375s
  3194  2956 infeasible   14      39377.4452 63986.9285  62.5% 10818 3450s

Cutting planes:
  Learned: 3
  Gomory: 11
  Implied bound: 229
  MIR: 3468
  Flow cover: 3303
  RLT: 66
  Relax-and-lift: 695

Explored 3434 nodes (37272177 simplex iterations) in 3600.03 seconds (8944.60 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 39377.4 39257.7 39100.8 ... 37265.7

Time limit reached
Best objective 3.937744517715e+04, best bound 6.374234466115e+04, gap 61.8753%
  WARNING: Time limit reached. Using best solution found (gap: 61.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 39377.45, θ = 227565.62
  Upper Bound (UB) = 39377.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 227565.62
  [DEBUG]   ✓ Scenario 0: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 227565.62 ≤ Q = 227565.62 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 19] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x21a88de7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x21a88de7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.408157e+13
Presolve removed 2585 rows and 1875 columns
Presolve time: 0.00s
Presolved: 508 rows, 514 columns, 1438 nonzeros
Found heuristic solution: objective 6824096.6094
Variable types: 350 continuous, 164 integer (164 binary)

Root relaxation: objective -1.745709e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -174570.88    0  123 6824096.61 -174570.88   103%     -    0s
H    0     0                    -141497.7870 -174570.88  23.4%     -    0s
H    0     0                    -141830.2183 -174570.88  23.1%     -    0s
     0     0 -149549.73    0   66 -141830.22 -149549.73  5.44%     -    0s
H    0     0                    -148082.3087 -149548.71  0.99%     -    0s
H    0     0                    -148199.3934 -149548.71  0.91%     -    0s
H    0     0                    -148318.3970 -149548.71  0.83%     -    0s
     0     0 -148717.94    0   36 -148318.40 -148717.94  0.27%     -    0s
     0     0 -148714.01    0   35 -148318.40 -148714.01  0.27%     -    0s
H    0     0                    -148379.0935 -148704.34  0.22%     -    0s
     0     0 -148577.94    0   30 -148379.09 -148577.94  0.13%     -    0s
     0     0 -148576.85    0   30 -148379.09 -148576.85  0.13%     -    0s
     0     0 -148576.81    0   30 -148379.09 -148576.81  0.13%     -    0s
     0     0 -148574.21    0   29 -148379.09 -148574.21  0.13%     -    0s
     0     0 -148573.42    0   29 -148379.09 -148573.42  0.13%     -    0s
     0     0 -148501.91    0   10 -148379.09 -148501.91  0.08%     -    0s
     0     0 -148501.91    0   32 -148379.09 -148501.91  0.08%     -    0s
H    0     0                    -148406.9979 -148501.91  0.06%     -    0s
     0     0 -148459.61    0    4 -148407.00 -148459.61  0.04%     -    0s
H    0     0                    -148416.0241 -148457.46  0.03%     -    0s
H    0     0                    -148429.6137 -148457.46  0.02%     -    0s
     0     0 -148451.04    0    2 -148429.61 -148451.04  0.01%     -    0s
     0     0 -148436.96    0    2 -148429.61 -148436.96  0.00%     -    0s
H    0     0                    -148431.6142 -148436.96  0.00%     -    0s
     0     0 -148434.55    0    2 -148431.61 -148434.55  0.00%     -    0s
     0     0     cutoff    0      -148431.61 -148431.61  0.00%     -    0s

Cutting planes:
  RLT: 1

Explored 1 nodes (664 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -148432 -148430 -148416 ... -141498
No other solutions better than -148432

Optimal solution found (tolerance 1.00e-06)
Best objective -1.484316142287e+05, best bound -1.484316142287e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 223015.59
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148431.61
  [DEBUG]   S×d_nominal = 371447.20
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 371447.20 + -148431.61 = 223015.59
  [DEBUG]   Current θ from Master = 227565.62
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4550.03 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 34827.41
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 970.1751, Absolute Gap = 970.1751, Relative Gap = 0.024638
  Not converged yet (gap = 970.18 > ε = 200)

  [DEBUG] Adding NEW scenario 19 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 19 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 19 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 19]
    [DEBUG]   - Total constraints in model: 307183
    [DEBUG]   - Total variables in model: 127060
  [DEBUG] Total scenarios in Master: 20
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 20
================================================================================
[Iteration 20] Solving Master Problem...
  Current scenarios in Master: 20
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 307183 rows, 127060 columns and 870259 nonzeros
Model fingerprint: 0x063cc053
Variable types: 124801 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 137520 rows and 55840 columns
Presolve time: 2.70s
Presolved: 169663 rows, 71220 columns, 1043483 nonzeros
Variable types: 68961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -314127.1816
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.30s

Barrier statistics:
 Dense cols : 1125
 AA' NZ     : 4.114e+06
 Factor NZ  : 1.148e+07 (roughly 200 MB of memory)
 Factor Ops : 3.863e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.02516215e+07  3.09882392e+08  1.62e+05 1.48e+01  9.56e+04     5s
   1  -1.60304796e+07  3.16453637e+08  1.17e+05 8.35e+01  7.05e+04     6s
   2  -7.33454857e+06  2.25073230e+08  5.09e+04 2.56e+00  3.26e+04     6s
   3  -1.39213801e+06  1.82185682e+08  5.95e+03 2.95e+00  4.27e+03     6s
   4  -6.31830779e+05  9.92347512e+07  8.29e+02 4.72e-01  7.93e+02     6s
   5  -5.09210654e+05  5.90619269e+07  4.01e+02 2.23e-01  3.98e+02     6s
   6  -4.50180430e+05  4.47009825e+07  2.28e+02 1.59e-01  2.55e+02     6s
   7  -4.03807679e+05  3.49300498e+07  1.16e+02 1.18e-01  1.66e+02     6s
   8  -3.45085408e+05  2.51968210e+07  6.00e+01 7.89e-02  1.06e+02     6s
   9  -2.33379446e+05  1.66845209e+07  1.78e+01 4.75e-02  6.01e+01     6s
  10  -1.69664235e+05  1.26022678e+07  8.55e+00 3.55e-02  4.34e+01     6s
  11  -1.29120240e+05  9.28492402e+06  5.15e+00 2.56e-02  3.14e+01     6s
  12  -1.13760170e+05  6.95125716e+06  3.58e+00 1.89e-02  2.34e+01     6s
  13  -9.18878064e+04  4.85295954e+06  1.57e+00 1.29e-02  1.62e+01     6s
  14  -6.65584829e+04  1.05805868e+06  5.48e-01 2.31e-03  3.65e+00     6s
  15  -3.63912680e+04  4.65878132e+05  2.88e-01 8.96e-04  1.63e+00     6s
  16  -6.11529846e+03  2.94002819e+05  1.49e-01 9.89e-04  9.73e-01     6s
  17  -4.55395701e+03  2.52246527e+05  1.46e-01 9.47e-04  8.32e-01     6s
  18   1.91941443e+04  2.09994163e+05  1.02e-01 1.66e-03  6.18e-01     6s
  19   3.28102921e+04  1.67882383e+05  7.90e-02 1.54e-03  4.38e-01     6s
  20   4.38370152e+04  1.50764419e+05  6.00e-02 2.22e-03  3.46e-01     6s
  21   5.00256542e+04  1.29549775e+05  4.84e-02 1.41e-03  2.58e-01     6s
  22   5.42769070e+04  1.19826874e+05  4.11e-02 1.11e-03  2.12e-01     6s
  23   5.87285211e+04  1.06482319e+05  3.37e-02 8.23e-04  1.55e-01     7s
  24   6.07614555e+04  1.03319971e+05  3.06e-02 7.15e-04  1.38e-01     7s
  25   6.57304789e+04  9.85518062e+04  2.29e-02 5.63e-04  1.06e-01     7s
  26   6.70472759e+04  9.58017276e+04  2.09e-02 4.87e-04  9.32e-02     7s
  27   6.95726502e+04  9.19762219e+04  1.70e-02 3.96e-04  7.26e-02     7s
  28   7.04537123e+04  9.01261229e+04  1.57e-02 3.49e-04  6.38e-02     7s
  29   7.16129549e+04  8.89902705e+04  1.41e-02 3.19e-04  5.63e-02     7s
  30   7.28109745e+04  8.69142774e+04  1.24e-02 2.24e-04  4.57e-02     7s
  31   7.35534680e+04  8.65980149e+04  1.14e-02 2.09e-04  4.23e-02     7s
  32   7.44112406e+04  8.56526705e+04  1.02e-02 1.53e-04  3.64e-02     7s
  33   7.47598604e+04  8.55235698e+04  9.70e-03 1.48e-04  3.49e-02     7s
  34   7.55159358e+04  8.48521424e+04  8.69e-03 2.10e-04  3.03e-02     7s
  35   7.64008531e+04  8.42974271e+04  7.54e-03 1.67e-04  2.56e-02     7s
  36   7.67812209e+04  8.38844909e+04  7.06e-03 1.27e-04  2.30e-02     7s
  37   7.81481725e+04  8.35466732e+04  5.29e-03 9.78e-05  1.75e-02     7s
  38   7.88790540e+04  8.34207226e+04  4.34e-03 9.41e-05  1.47e-02     7s
  39   7.92632710e+04  8.31802124e+04  3.85e-03 9.51e-05  1.27e-02     8s
  40   7.99514038e+04  8.30635898e+04  3.00e-03 7.98e-05  1.01e-02     8s
  41   8.01868043e+04  8.28177192e+04  2.70e-03 4.09e-05  8.53e-03     8s
  42   8.06824839e+04  8.27417412e+04  2.08e-03 3.25e-05  6.68e-03     8s
  43   8.09235515e+04  8.25753573e+04  1.78e-03 1.62e-05  5.36e-03     8s
  44   8.11658904e+04  8.25171530e+04  1.49e-03 3.61e-05  4.38e-03     8s
  45   8.13492283e+04  8.24793749e+04  1.26e-03 5.08e-05  3.67e-03     8s
  46   8.15903223e+04  8.24604509e+04  9.77e-04 3.85e-05  2.82e-03     8s
  47   8.17464257e+04  8.24497784e+04  7.95e-04 2.59e-05  2.28e-03     8s
  48   8.19349747e+04  8.24336428e+04  5.61e-04 1.64e-05  1.62e-03     8s
  49   8.22560258e+04  8.24219071e+04  1.62e-04 9.98e-06  5.38e-04     8s
  50   8.23386366e+04  8.24118941e+04  6.64e-05 4.61e-06  2.38e-04     8s
  51   8.23823244e+04  8.24031415e+04  1.77e-05 2.48e-06  6.75e-05     8s
  52   8.23827531e+04  8.24026001e+04  1.73e-05 2.01e-06  6.43e-05     8s
  53   8.23876024e+04  8.24014446e+04  1.22e-05 1.03e-06  4.49e-05     8s
  54   8.23973034e+04  8.24002758e+04  2.54e-06 2.12e-07  9.64e-06     8s
  55   8.23992857e+04  8.24000440e+04  5.63e-07 5.61e-08  2.46e-06     9s
  56   8.23995575e+04  8.23999693e+04  3.32e-07 1.66e-09  1.34e-06     9s
  57   8.23995895e+04  8.23999517e+04  3.75e-06 3.01e-09  1.17e-06     9s
  58   8.23998831e+04  8.23999506e+04  1.61e-06 5.85e-06  2.19e-07     9s
  59   8.23999418e+04  8.23999498e+04  1.15e-05 2.14e-06  2.56e-08     9s
  60   8.23999483e+04  8.23999493e+04  1.47e-06 4.94e-07  3.37e-09     9s
  61   8.23999488e+04  8.23999493e+04  7.92e-07 7.81e-09  1.79e-09     9s

Barrier solved model in 61 iterations and 8.92 seconds (18.25 work units)
Optimal objective 8.23999488e+04


Root crossover log...

  149113 DPushes remaining with DInf 0.0000000e+00                 9s
   56513 DPushes remaining with DInf 0.0000000e+00                10s
    1434 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   24665 PPushes remaining with PInf 1.5880317e-04                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.7417495e+04     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
  101184    8.2399949e+04   0.000000e+00   6.741749e+04     17s
  101996    8.2399949e+04   0.000000e+00   0.000000e+00     18s
  101996    8.2399949e+04   0.000000e+00   0.000000e+00     18s
Concurrent spin time: 6.47s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.239995e+04, 101996 iterations, 21.01 seconds (41.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82399.9493    0  172 -183060.80 82399.9493   145%     -   25s
H    0     0                    -178761.2066 82399.9493   146%     -   25s
H    0     0                    -159916.2061 82399.9493   152%     -   25s
H    0     0                    -136976.2343 82399.9493   160%     -   26s
H    0     0                    -136649.1824 82399.9493   160%     -   26s
H    0     0                    -136168.0333 82399.9493   161%     -   26s
H    0     0                    -135358.2516 82399.9493   161%     -   27s
H    0     0                    -134374.2376 82399.9493   161%     -   27s
H    0     0                    -133652.6394 82399.9493   162%     -   27s
H    0     0                    -84214.72804 82399.9493   198%     -   27s
H    0     0                    -11937.28115 82399.9493   790%     -   27s
H    0     0                    19318.655824 82399.9493   327%     -   28s
H    0     0                    20983.525347 82399.9493   293%     -   28s
H    0     0                    21747.994277 82399.9493   279%     -   28s
H    0     0                    26697.654935 82399.9493   209%     -   28s
H    0     0                    26856.693694 82399.9493   207%     -   28s
H    0     0                    26915.695001 82399.9493   206%     -   29s
H    0     0                    26972.093365 82399.9493   206%     -   29s
     0     0 74788.1420    0  248 26972.0934 74788.1420   177%     -   96s
H    0     0                    29489.085674 74788.0616   154%     -   97s
H    0     0                    30161.055739 74788.0616   148%     -   97s
H    0     0                    30761.887044 74788.0616   143%     -   97s
H    0     0                    30882.279500 74788.0616   142%     -   97s
     0     0 74505.2198    0  241 30882.2795 74505.2198   141%     -  117s
     0     0 74314.6965    0  254 30882.2795 74314.6965   141%     -  135s
     0     0 74143.0297    0  240 30882.2795 74143.0297   140%     -  149s
     0     0 74108.7110    0  246 30882.2795 74108.7110   140%     -  152s
     0     0 74082.0633    0  253 30882.2795 74082.0633   140%     -  155s
     0     0 74067.3043    0  249 30882.2795 74067.3043   140%     -  158s
     0     0 74062.2854    0  248 30882.2795 74062.2854   140%     -  160s
     0     0 74058.7907    0  250 30882.2795 74058.7907   140%     -  162s
     0     0 74057.0282    0  251 30882.2795 74057.0282   140%     -  163s
     0     0 74052.5250    0  250 30882.2795 74052.5250   140%     -  164s
     0     0 74052.5250    0  250 30882.2795 74052.5250   140%     -  164s
     0     0 70529.5957    0  287 30882.2795 70529.5957   128%     -  238s
H    0     0                    31163.595802 70529.5820   126%     -  238s
H    0     0                    31734.448060 70529.5820   122%     -  239s
H    0     0                    31863.057789 70529.5820   121%     -  239s
H    0     0                    32148.462209 70529.5820   119%     -  239s
H    0     0                    32419.319948 70529.5820   118%     -  239s
H    0     0                    32459.249993 70529.5820   117%     -  239s
H    0     0                    32467.522018 70529.5820   117%     -  239s
H    0     0                    32507.996213 70529.5820   117%     -  239s
H    0     0                    32519.541759 70529.5820   117%     -  239s
     0     0 69992.7513    0  314 32519.5418 69992.7513   115%     -  268s
     0     0 69752.5145    0  308 32519.5418 69752.5145   114%     -  285s
     0     0 69563.6550    0  308 32519.5418 69563.6550   114%     -  299s
     0     0 69493.9202    0  317 32519.5418 69493.9202   114%     -  309s
     0     0 69469.8425    0  319 32519.5418 69469.8425   114%     -  316s
     0     0 69459.6448    0  334 32519.5418 69459.6448   114%     -  319s
     0     0 69453.4729    0  328 32519.5418 69453.4729   114%     -  322s
     0     0 69451.1323    0  317 32519.5418 69451.1323   114%     -  324s
     0     0 69395.6761    0  339 32519.5418 69395.6761   113%     -  335s
     0     0 69385.3500    0  344 32519.5418 69385.3500   113%     -  339s
     0     0 69379.4680    0  334 32519.5418 69379.4680   113%     -  342s
     0     0 69377.3097    0  344 32519.5418 69377.3097   113%     -  346s
     0     0 69377.1265    0  344 32519.5418 69377.1265   113%     -  348s
     0     0 67030.5094    0  322 32519.5418 67030.5094   106%     -  414s
H    0     0                    32582.328372 67030.3078   106%     -  415s
     0     0 66560.8531    0  324 32582.3284 66560.8531   104%     -  441s
     0     0 66257.5700    0  360 32582.3284 66257.5700   103%     -  455s
     0     0 66170.1927    0  359 32582.3284 66170.1927   103%     -  472s
     0     0 66137.8299    0  339 32582.3284 66137.8299   103%     -  479s
     0     0 66080.2025    0  360 32582.3284 66080.2025   103%     -  489s
     0     0 66001.2363    0  362 32582.3284 66001.2363   103%     -  499s
     0     0 65971.6891    0  372 32582.3284 65971.6891   102%     -  504s
     0     0 65960.4550    0  371 32582.3284 65960.4550   102%     -  509s
     0     0 65956.9661    0  373 32582.3284 65956.9661   102%     -  511s
     0     0 65933.4993    0  366 32582.3284 65933.4993   102%     -  515s
     0     0 65917.2427    0  368 32582.3284 65917.2427   102%     -  519s
     0     0 65910.7867    0  363 32582.3284 65910.7867   102%     -  521s
     0     0 65904.6669    0  363 32582.3284 65904.6669   102%     -  525s
     0     0 65902.0026    0  366 32582.3284 65902.0026   102%     -  526s
     0     0 65899.0556    0  369 32582.3284 65899.0556   102%     -  529s
     0     0 65898.5134    0  364 32582.3284 65898.5134   102%     -  529s
     0     0 65314.3750    0  345 32582.3284 65314.3750   100%     -  565s
H    0     0                    32727.447006 65314.1006   100%     -  566s
H    0     0                    32761.399317 65314.1006  99.4%     -  566s
H    0     0                    32833.499891 65314.1006  98.9%     -  566s
H    0     0                    32841.168349 65314.1006  98.9%     -  566s
H    0     0                    32871.177777 65314.1006  98.7%     -  566s
     0     0 65134.9047    0  358 32871.1778 65134.9047  98.2%     -  582s
     0     0 65064.8595    0  342 32871.1778 65064.8595  97.9%     -  599s
     0     0 65053.0681    0  347 32871.1778 65053.0681  97.9%     -  605s
     0     0 65045.1815    0  349 32871.1778 65045.1815  97.9%     -  608s
     0     0 65028.9059    0  358 32871.1778 65028.9059  97.8%     -  615s
     0     0 65000.9041    0  344 32871.1778 65000.9041  97.7%     -  629s
     0     0 64989.6549    0  347 32871.1778 64989.6549  97.7%     -  637s
     0     0 64986.1598    0  346 32871.1778 64986.1598  97.7%     -  640s
     0     0 64967.1075    0  346 32871.1778 64967.1075  97.6%     -  646s
     0     0 64964.2194    0  343 32871.1778 64964.2194  97.6%     -  650s
     0     0 64960.9437    0  345 32871.1778 64960.9437  97.6%     -  654s
     0     0 64941.2247    0  353 32871.1778 64941.2247  97.6%     -  661s
     0     0 64939.7038    0  405 32871.1778 64939.7038  97.6%     -  665s
     0     0 64825.0130    0  402 32871.1778 64825.0130  97.2%     -  687s
     0     0 64790.8834    0  451 32871.1778 64790.8834  97.1%     -  701s
     0     0 64777.2573    0  454 32871.1778 64777.2573  97.1%     -  709s
     0     0 64770.0498    0  400 32871.1778 64770.0498  97.0%     -  714s
     0     0 64766.9551    0  446 32871.1778 64766.9551  97.0%     -  717s
     0     0 64764.8325    0  407 32871.1778 64764.8325  97.0%     -  719s
     0     0 64708.1534    0  424 32871.1778 64708.1534  96.9%     -  731s
     0     0 64688.2148    0  389 32871.1778 64688.2148  96.8%     -  746s
     0     0 64681.8769    0  417 32871.1778 64681.8769  96.8%     -  753s
     0     0 64677.7133    0  456 32871.1778 64677.7133  96.8%     -  759s
     0     0 64676.2559    0  464 32871.1778 64676.2559  96.8%     -  763s
     0     0 64653.9539    0  450 32871.1778 64653.9539  96.7%     -  773s
     0     0 64647.3820    0  453 32871.1778 64647.3820  96.7%     -  779s
     0     0 64642.5657    0  460 32871.1778 64642.5657  96.7%     -  785s
     0     0 64632.3689    0  460 32871.1778 64632.3689  96.6%     -  793s
     0     0 64623.5696    0  430 32871.1778 64623.5696  96.6%     -  800s
     0     0 64622.9521    0  463 32871.1778 64622.9521  96.6%     -  803s
     0     0 64601.3497    0  439 32871.1778 64601.3497  96.5%     -  814s
H    0     0                    33073.443901 64600.8203  95.3%     -  815s
H    0     0                    33149.201300 64600.8203  94.9%     -  816s
H    0     0                    33184.604807 64600.8203  94.7%     -  816s
H    0     0                    33259.051851 64600.8203  94.2%     -  816s
H    0     0                    33339.833243 64600.8203  93.8%     -  816s
H    0     0                    33467.423877 64600.8203  93.0%     -  816s
     0     0 64585.9327    0  443 33467.4239 64585.9327  93.0%     -  824s
     0     0 64583.8705    0  445 33467.4239 64583.8705  93.0%     -  828s
     0     0 64570.1975    0  450 33467.4239 64570.1975  92.9%     -  840s
H    0     0                    33660.535754 64569.1719  91.8%     -  842s
     0     0 64556.8696    0  493 33660.5358 64556.8696  91.8%     -  848s
     0     0 64553.9072    0  457 33660.5358 64553.9072  91.8%     -  850s
     0     0 64552.8797    0  457 33660.5358 64552.8797  91.8%     -  852s
     0     0 64541.7502    0  385 33660.5358 64541.7502  91.7%     -  863s
     0     0 64538.2297    0  461 33660.5358 64538.2297  91.7%     -  871s
     0     0 64536.5033    0  460 33660.5358 64536.5033  91.7%     -  874s
     0     0 64531.2325    0  432 33660.5358 64531.2325  91.7%     -  881s
     0     0 64529.8434    0  406 33660.5358 64529.8434  91.7%     -  887s
     0     0 64509.4637    0  407 33660.5358 64509.4637  91.6%     -  896s
H    0     0                    33843.641040 64509.4444  90.6%     -  906s
     0     0 64508.0636    0  422 33843.6410 64508.0636  90.6%     -  911s
     0     0 64500.4654    0  378 33843.6410 64500.4654  90.6%     -  918s
     0     0 64500.4364    0  378 33843.6410 64500.4364  90.6%     -  922s
H    0     0                    34231.074849 64500.4286  88.4%     - 1151s
     0     2 64500.4286    0  378 34231.0748 64500.4286  88.4%     - 1158s
     1     3 64324.1308    1  393 34231.0748 64500.4082  88.4%  8526 1169s
     2     4 64454.2785    1  366 34231.0748 64454.2785  88.3%  7724 1181s
     3     5 63658.2847    2  339 34231.0748 64453.7378  88.3% 10950 1199s
     4     8 63677.7815    2  366 34231.0748 64453.5262  88.3% 11238 1218s
     7    14 63526.8940    3  395 34231.0748 64270.5863  87.8% 10985 1271s
    13    27 63338.7277    4  350 34231.0748 64197.1053  87.5% 16278 1321s
    26    40 60666.3244    5  351 34231.0748 64058.1953  87.1% 28866 1459s
H   39    71                    34550.587550 64058.1953  85.4% 25829 1810s
H   41    71                    35993.209922 64058.1953  78.0% 25681 1810s
H   60    71                    36229.141413 64058.1953  76.8% 22914 1810s
H   64    71                    36273.250152 64058.1953  76.6% 21961 1810s
    70   154 59389.1320    7  293 36273.2502 64058.1953  76.6% 28915 1950s
   153   254 58957.1083   10  305 36273.2502 64058.1953  76.6% 19478 2015s
H  161   254                    36656.577794 64058.1953  74.8% 19006 2015s
H  164   254                    37768.341776 64058.1953  69.6% 18820 2015s
H  207   254                    38091.666399 64058.1953  68.2% 16223 2015s
   253   332 58572.3849   11  306 38091.6664 64058.1953  68.2% 15215 2065s
   331   381 58311.3176   12  293 38091.6664 64058.1953  68.2% 13213 2115s
   380   440 57938.6952   14  287 38091.6664 64058.1953  68.2% 12726 2156s
   439   470 57862.4027   15  292 38091.6664 64058.1953  68.2% 12582 2193s
   469   503 57517.2023   15  284 38091.6664 64058.1953  68.2% 12721 2230s
   502   539 57778.9422   16  285 38091.6664 64058.1953  68.2% 12930 2266s
   538   571 55765.2679   16  295 38091.6664 64058.1953  68.2% 13188 2299s
   570   606 57633.2882   17  284 38091.6664 64058.1953  68.2% 13139 2330s
   605   639 57547.5706   17  285 38091.6664 64058.1953  68.2% 13027 2361s
H  616   639                    38759.133911 64058.1953  65.3% 12961 2361s
   638   701 57447.3340   18  278 38759.1339 64058.1953  65.3% 12900 2396s
   700   775 57152.7861   19  280 38759.1339 64058.1953  65.3% 12679 2437s
   774   826 56940.5850   20  289 38759.1339 64058.1953  65.3% 12300 2490s
   825   886 56814.0301   21  275 38759.1339 64058.1953  65.3% 12250 2532s
   885   943 56481.5266   22  273 38759.1339 64058.1953  65.3% 12139 2571s
   949   974 56369.8652   23  275 38759.1339 64058.1953  65.3% 12032 2603s
   980  1007 56300.2979   24  277 38759.1339 64058.1953  65.3% 12114 2636s
  1013  1049 56126.1962   25  271 38759.1339 64058.1953  65.3% 12095 2672s
H 1016  1049                    38770.171433 64058.1953  65.2% 12073 2672s
H 1030  1049                    39047.588000 64058.1953  64.1% 12000 2672s
  1055  1163 55720.5222   26  266 39047.5880 64058.1953  64.1% 12039 2709s
  1169  1294 55629.5465   27  263 39047.5880 64058.1953  64.1% 11651 2749s
  1300  1394 55455.7636   30  260 39047.5880 64058.1953  64.1% 11168 2792s
  1422  1517 54932.6670   32  236 39047.5880 64058.1953  64.1% 10872 2854s
  1559  1671 53713.5895   33  246 39047.5880 64058.1953  64.1% 10545 2904s
  1729  1798 53038.4392   34  237 39047.5880 64058.1953  64.1% 10059 2951s
  1896  1872 53025.0327   35  235 39047.5880 64058.1953  64.1%  9733 2992s
H 1902  1872                    39139.776286 64058.1953  63.7%  9727 2992s
H 1921  1872                    39143.439270 64058.1953  63.6%  9733 2992s
  1999  1938 51280.8955   36  209 39143.4393 64058.1953  63.6%  9616 3072s
  2113  2019 50531.2331   37  209 39143.4393 64058.1953  63.6%  9523 3122s
  2263  2148 49043.0406   38  195 39143.4393 64058.1953  63.6%  9425 3179s
  2451  2223 48061.7965   39  228 39143.4393 64058.1953  63.6%  9240 3236s
  2607  2292 46225.4530   40  243 39143.4393 64058.1953  63.6%  9166 3298s
  2765  2339 46147.0240   41  242 39143.4393 64058.1953  63.6%  9193 3360s
  2884  2368 41559.0529   43  149 39143.4393 63901.5286  63.2%  9263 3424s
  2970  2393 39936.9690   44  136 39143.4393 63901.5286  63.2%  9514 3485s
  3005  2411 infeasible   45      39143.4393 63901.4202  63.2%  9687 3538s
  3049  2437 39666.5199   64  194 39143.4393 63901.4202  63.2%  9830 3597s
H 3084  2437                    39181.974927 63901.4202  63.1%  9975 3597s
  3087  2436 infeasible   65      39181.9749 63901.4202  63.1%  9991 3600s

Cutting planes:
  Learned: 3
  Gomory: 26
  Implied bound: 157
  MIR: 3722
  Flow cover: 3318
  RLT: 67
  Relax-and-lift: 599
  PSD: 2

Explored 3090 nodes (31660441 simplex iterations) in 3600.06 seconds (8650.36 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 39182 39143.4 39139.8 ... 36273.3

Time limit reached
Best objective 3.918197492739e+04, best bound 6.390142017565e+04, gap 63.0888%
  WARNING: Time limit reached. Using best solution found (gap: 63.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 39181.97, θ = 216644.77
  Upper Bound (UB) = 39181.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 216644.77
  [DEBUG]   ✓ Scenario 0: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 216644.77 ≤ Q = 216644.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 20] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7559185a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7559185a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.332731e+13
Presolve removed 2587 rows and 1878 columns
Presolve time: 0.00s
Presolved: 506 rows, 511 columns, 1433 nonzeros
Found heuristic solution: objective 6562250.6435
Variable types: 347 continuous, 164 integer (164 binary)

Root relaxation: objective -1.640537e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -164053.66    0  123 6562250.64 -164053.66   102%     -    0s
H    0     0                    -131274.0589 -164053.66  25.0%     -    0s
H    0     0                    -131571.7439 -164053.66  24.7%     -    0s
     0     0 -142953.88    0   74 -131571.74 -142953.88  8.65%     -    0s
H    0     0                    -140703.3039 -142825.80  1.51%     -    0s
H    0     0                    -141037.3186 -142825.80  1.27%     -    0s
     0     0 -142005.23    0   86 -141037.32 -142005.23  0.69%     -    0s
H    0     0                    -141246.6374 -141960.53  0.51%     -    0s
     0     0 -141960.53    0   69 -141246.64 -141960.53  0.51%     -    0s
     0     0 -141915.91    0   77 -141246.64 -141915.91  0.47%     -    0s
     0     0 -141915.73    0   77 -141246.64 -141915.73  0.47%     -    0s
     0     0 -141662.77    0   39 -141246.64 -141662.77  0.29%     -    0s
H    0     0                    -141249.9831 -141640.39  0.28%     -    0s
     0     0 -141512.54    0   50 -141249.98 -141512.54  0.19%     -    0s
     0     0 -141503.53    0   37 -141249.98 -141503.53  0.18%     -    0s
     0     0 -141462.52    0   44 -141249.98 -141462.52  0.15%     -    0s
     0     0 -141462.42    0   35 -141249.98 -141462.42  0.15%     -    0s
     0     0 -141460.93    0   35 -141249.98 -141460.93  0.15%     -    0s
H    0     0                    -141273.4362 -141455.91  0.13%     -    0s
     0     0 -141441.40    0   33 -141273.44 -141441.40  0.12%     -    0s
     0     0 -141397.51    0   35 -141273.44 -141397.51  0.09%     -    0s
     0     0 -141397.51    0   44 -141273.44 -141397.51  0.09%     -    0s
     0     0 -141397.51    0   46 -141273.44 -141397.51  0.09%     -    0s
     0     0 -141397.51    0   28 -141273.44 -141397.51  0.09%     -    0s
     0     0 -141357.03    0    8 -141273.44 -141357.03  0.06%     -    0s
     0     0 -141316.76    0    7 -141273.44 -141316.76  0.03%     -    0s
     0     0 -141291.87    0    3 -141273.44 -141291.87  0.01%     -    0s
H    0     0                    -141280.6867 -141287.00  0.00%     -    0s
     0     0 -141284.16    0    2 -141280.69 -141284.16  0.00%     -    0s
     0     0 -141280.95    0    2 -141280.69 -141280.95  0.00%     -    0s

Cutting planes:
  Gomory: 12
  Implied bound: 3
  MIR: 20
  Flow cover: 16
  RLT: 5

Explored 1 nodes (953 simplex iterations) in 0.18 seconds (0.05 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -141281 -141273 -141250 ... 1.33273e+13
No other solutions better than -141281

Optimal solution found (tolerance 1.00e-06)
Best objective -1.412806867467e+05, best bound -1.412806867467e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 208782.89
  Scenario: 31 demand increases, 29 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141280.69
  [DEBUG]   S×d_nominal = 350063.58
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 350063.58 + -141280.69 = 208782.89
  [DEBUG]   Current θ from Master = 216644.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7861.88 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 31320.10
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 774.7049, Absolute Gap = 774.7049, Relative Gap = 0.019772
  Not converged yet (gap = 774.70 > ε = 200)

  [DEBUG] Adding NEW scenario 20 to Master Problem...
  [DEBUG] New scenario pattern: 31 increases, 29 decreases
    [DEBUG] Scenario 20 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 20 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 20]
    [DEBUG]   - Total constraints in model: 322473
    [DEBUG]   - Total variables in model: 133300
  [DEBUG] Total scenarios in Master: 21
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 21
================================================================================
[Iteration 21] Solving Master Problem...
  Current scenarios in Master: 21
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 322473 rows, 133300 columns and 913496 nonzeros
Model fingerprint: 0x640d9fd9
Variable types: 131041 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 144388 rows and 58628 columns
Presolve time: 2.95s
Presolved: 178085 rows, 74672 columns, 1095229 nonzeros
Variable types: 72413 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -313100.6823
Found heuristic solution: objective -183060.7998

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.49s

Barrier statistics:
 Dense cols : 1124
 AA' NZ     : 4.461e+06
 Factor NZ  : 1.236e+07 (roughly 200 MB of memory)
 Factor Ops : 4.106e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.07942051e+07  3.23661206e+08  1.66e+05 1.43e+01  9.77e+04     6s
   1  -1.64841847e+07  3.33142354e+08  1.20e+05 8.60e+01  7.22e+04     6s
   2  -7.52224814e+06  2.36666622e+08  5.21e+04 1.25e+00  3.33e+04     6s
   3  -1.42776294e+06  1.91878856e+08  6.15e+03 2.35e+00  4.39e+03     6s
   4  -6.49288415e+05  1.06712068e+08  8.67e+02 5.20e-01  8.23e+02     6s
   5  -5.19837597e+05  6.25999024e+07  4.16e+02 2.40e-01  4.08e+02     6s
   6  -4.62451435e+05  4.78816575e+07  2.51e+02 1.68e-01  2.70e+02     6s
   7  -4.09577890e+05  3.83706956e+07  1.18e+02 1.28e-01  1.72e+02     7s
   8  -3.58519101e+05  2.64370133e+07  6.33e+01 8.20e-02  1.07e+02     7s
   9  -2.48169575e+05  1.72436708e+07  1.85e+01 4.87e-02  5.95e+01     7s
  10  -1.78461227e+05  1.33538281e+07  8.47e+00 3.74e-02  4.38e+01     7s
  11  -1.39053022e+05  1.02907896e+07  5.50e+00 2.83e-02  3.32e+01     7s
  12  -1.19380529e+05  8.59838839e+06  3.60e+00 2.36e-02  2.75e+01     7s
  13  -1.11588524e+05  6.53020465e+06  2.60e+00 1.78e-02  2.08e+01     7s
  14  -7.73147391e+04  2.95621770e+06  6.30e-01 7.75e-03  9.39e+00     7s
  15  -5.19326671e+04  7.52463838e+05  2.73e-01 1.82e-03  2.49e+00     7s
  16  -1.87682423e+04  3.68958228e+05  1.35e-01 7.63e-04  1.20e+00     7s
  17  -1.37189539e+03  2.96544238e+05  1.02e-01 5.81e-04  9.20e-01     7s
  18   6.00333515e+03  2.07448181e+05  9.22e-02 1.69e-03  6.22e-01     7s
  19   2.53929611e+04  1.76979594e+05  6.99e-02 2.73e-03  4.68e-01     7s
  20   3.48020657e+04  1.49217945e+05  5.92e-02 2.55e-03  3.53e-01     7s
  21   3.84020826e+04  1.40078316e+05  5.45e-02 2.18e-03  3.14e-01     7s
  22   4.48557954e+04  1.31194186e+05  4.73e-02 1.83e-03  2.67e-01     7s
  23   4.83593882e+04  1.19696579e+05  4.25e-02 1.35e-03  2.20e-01     7s
  24   5.23170521e+04  1.11927129e+05  3.72e-02 1.06e-03  1.84e-01     7s
  25   5.62682763e+04  1.07335121e+05  3.19e-02 8.91e-04  1.58e-01     7s
  26   5.97217081e+04  1.01868281e+05  2.75e-02 7.15e-04  1.30e-01     8s
  27   6.24334089e+04  9.67323561e+04  2.40e-02 8.16e-04  1.06e-01     8s
  28   6.65264534e+04  9.45581324e+04  1.90e-02 6.94e-04  8.66e-02     8s
  29   6.78055183e+04  9.10099627e+04  1.72e-02 5.23e-04  7.17e-02     8s
  30   6.93854779e+04  8.89736364e+04  1.51e-02 4.13e-04  6.05e-02     8s
  31   7.01174172e+04  8.82581548e+04  1.42e-02 3.68e-04  5.60e-02     8s
  32   7.16206960e+04  8.68790690e+04  1.24e-02 3.32e-04  4.71e-02     8s
  33   7.21307817e+04  8.61059441e+04  1.18e-02 2.69e-04  4.32e-02     8s
  34   7.44823180e+04  8.55598828e+04  8.95e-03 2.26e-04  3.42e-02     8s
  35   7.54516039e+04  8.53374837e+04  7.84e-03 2.06e-04  3.05e-02     8s
  36   7.64244205e+04  8.45681989e+04  6.73e-03 1.61e-04  2.52e-02     8s
  37   7.68567969e+04  8.41893032e+04  6.22e-03 1.46e-04  2.27e-02     8s
  38   7.69670481e+04  8.40549186e+04  6.09e-03 1.35e-04  2.19e-02     8s
  39   7.77088797e+04  8.39160323e+04  5.27e-03 1.21e-04  1.92e-02     8s
  40   7.81060142e+04  8.38171843e+04  4.82e-03 1.13e-04  1.76e-02     9s
  41   7.91225869e+04  8.36640998e+04  3.67e-03 9.72e-05  1.40e-02     9s
  42   7.96073191e+04  8.34303058e+04  3.12e-03 8.24e-05  1.18e-02     9s
  43   7.98729297e+04  8.32601949e+04  2.82e-03 6.71e-05  1.05e-02     9s
  44   8.06748669e+04  8.32216724e+04  1.94e-03 6.37e-05  7.87e-03     9s
  45   8.10084736e+04  8.30739631e+04  1.57e-03 5.16e-05  6.38e-03     9s
  46   8.10597621e+04  8.29793124e+04  1.51e-03 4.34e-05  5.93e-03     9s
  47   8.14261180e+04  8.28632382e+04  1.10e-03 3.32e-05  4.44e-03     9s
  48   8.15756936e+04  8.28374055e+04  9.46e-04 3.07e-05  3.90e-03     9s
  49   8.20245706e+04  8.27103611e+04  4.55e-04 1.93e-05  2.12e-03     9s
  50   8.21313721e+04  8.26037742e+04  3.47e-04 9.56e-06  1.46e-03     9s
  51   8.21700634e+04  8.25738027e+04  3.09e-04 7.17e-06  1.25e-03     9s
  52   8.23318393e+04  8.25533275e+04  1.44e-04 5.43e-06  6.84e-04     9s
  53   8.23986408e+04  8.25186809e+04  7.94e-05 2.54e-06  3.71e-04     9s
  54   8.24143593e+04  8.25126288e+04  6.52e-05 2.05e-06  3.03e-04    10s
  55   8.24300476e+04  8.25106356e+04  5.06e-05 1.90e-06  2.49e-04    10s
  56   8.24400373e+04  8.25081967e+04  4.11e-05 1.71e-06  2.10e-04    10s
  57   8.24613759e+04  8.24909245e+04  2.11e-05 4.09e-07  9.13e-05    10s
  58   8.24781739e+04  8.24874642e+04  6.53e-06 1.57e-07  2.87e-05    10s
  59   8.24855202e+04  8.24864469e+04  6.69e-07 1.77e-08  2.86e-06    10s
  60   8.24863870e+04  8.24863896e+04  3.27e-08 1.68e-07  8.04e-09    10s
  61   8.24863891e+04  8.24863895e+04  1.19e-06 7.37e-09  1.33e-09    10s

Barrier solved model in 61 iterations and 9.96 seconds (19.53 work units)
Optimal objective 8.24863891e+04


Root crossover log...

  156398 DPushes remaining with DInf 0.0000000e+00                10s
   13979 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                17s

   21033 PPushes remaining with PInf 1.1165222e-04                17s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.0909412e+05     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   97299    8.2486390e+04   0.000000e+00   2.090941e+05     19s
   98195    8.2486390e+04   0.000000e+00   0.000000e+00     19s
   98195    8.2486390e+04   0.000000e+00   0.000000e+00     20s
Concurrent spin time: 5.90s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 8.248639e+04, 98195 iterations, 21.62 seconds (43.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 82486.3895    0  179 -183060.80 82486.3895   145%     -   26s
H    0     0                    -95532.33469 82486.3895   186%     -   27s
H    0     0                    -93132.15614 82486.3895   189%     -   27s
H    0     0                    -92347.04758 82486.3895   189%     -   27s
H    0     0                    -90817.17864 82486.3895   191%     -   27s
H    0     0                    -90305.79684 82486.3895   191%     -   27s
H    0     0                    -90176.55621 82486.3895   191%     -   27s
H    0     0                    -59778.71181 82486.3895   238%     -   27s
H    0     0                    22257.388148 82486.3895   271%     -   28s
H    0     0                    24294.563175 82486.3895   240%     -   29s
H    0     0                    26856.693694 82486.3895   207%     -   29s
H    0     0                    26865.996892 82486.3895   207%     -   29s
H    0     0                    26937.805130 82486.3895   206%     -   29s
H    0     0                    26956.679567 82486.3895   206%     -   29s
H    0     0                    26972.093365 82486.3895   206%     -   29s
H    0     0                    27070.412208 82486.3895   205%     -   29s
     0     0 75474.8177    0  219 27070.4122 75474.8177   179%     -   82s
     0     0 75474.8177    0  219 27070.4122 75474.8177   179%     -   82s
H    0     0                    29096.114848 75474.5865   159%     -   84s
H    0     0                    29827.167174 75474.5865   153%     -   85s
H    0     0                    30828.508321 75474.5865   145%     -   85s
H    0     0                    31656.080270 75474.5865   138%     -   85s
H    0     0                    31667.505217 75474.5865   138%     -   85s
     0     0 75037.3947    0  240 31667.5052 75037.3947   137%     -  105s
     0     0 74773.6858    0  244 31667.5052 74773.6858   136%     -  116s
     0     0 74769.8587    0  245 31667.5052 74769.8587   136%     -  119s
     0     0 74739.6681    0  244 31667.5052 74739.6681   136%     -  121s
     0     0 74738.1925    0  240 31667.5052 74738.1925   136%     -  122s
     0     0 74727.2852    0  233 31667.5052 74727.2852   136%     -  125s
     0     0 74663.7528    0  239 31667.5052 74663.7528   136%     -  130s
     0     0 74658.9522    0  234 31667.5052 74658.9522   136%     -  134s
     0     0 74657.6950    0  243 31667.5052 74657.6950   136%     -  136s
     0     0 74657.3958    0  243 31667.5052 74657.3958   136%     -  136s
     0     0 70249.8546    0  316 31667.5052 70249.8546   122%     -  205s
H    0     0                    33088.157451 70248.7903   112%     -  205s
H    0     0                    33089.577779 70248.7903   112%     -  206s
H    0     0                    33237.498476 70248.7903   111%     -  206s
H    0     0                    33242.538969 70248.7903   111%     -  206s
H    0     0                    33314.486058 70248.7903   111%     -  206s
H    0     0                    33379.307130 70248.7903   110%     -  206s
H    0     0                    33497.997127 70248.7903   110%     -  206s
H    0     0                    33639.909064 70248.7903   109%     -  206s
H    0     0                    33684.559686 70248.7903   109%     -  206s
     0     0 69722.7824    0  298 33684.5597 69722.7824   107%     -  234s
     0     0 69611.4270    0  341 33684.5597 69611.4270   107%     -  254s
     0     0 69501.3294    0  346 33684.5597 69501.3294   106%     -  275s
     0     0 69421.9093    0  321 33684.5597 69421.9093   106%     -  288s
     0     0 69383.3578    0  326 33684.5597 69383.3578   106%     -  300s
     0     0 69322.0186    0  322 33684.5597 69322.0186   106%     -  319s
     0     0 69304.8668    0  328 33684.5597 69304.8668   106%     -  329s
     0     0 69270.1019    0  325 33684.5597 69270.1019   106%     -  342s
     0     0 69168.2217    0  326 33684.5597 69168.2217   105%     -  361s
     0     0 69133.3509    0  338 33684.5597 69133.3509   105%     -  375s
     0     0 69121.0010    0  334 33684.5597 69121.0010   105%     -  382s
     0     0 69118.9186    0  340 33684.5597 69118.9186   105%     -  384s
     0     0 69105.8353    0  338 33684.5597 69105.8353   105%     -  389s
     0     0 69052.9006    0  333 33684.5597 69052.9006   105%     -  403s
     0     0 69033.1824    0  322 33684.5597 69033.1824   105%     -  407s
     0     0 68975.1177    0  332 33684.5597 68975.1177   105%     -  416s
     0     0 68950.0081    0  327 33684.5597 68950.0081   105%     -  424s
     0     0 68946.9317    0  337 33684.5597 68946.9317   105%     -  426s
     0     0 68944.4719    0  335 33684.5597 68944.4719   105%     -  428s
     0     0 68941.4521    0  335 33684.5597 68941.4521   105%     -  429s
     0     0 68939.4028    0  340 33684.5597 68939.4028   105%     -  431s
     0     0 68932.2260    0  340 33684.5597 68932.2260   105%     -  435s
     0     0 68931.0717    0  346 33684.5597 68931.0717   105%     -  437s
     0     0 67318.2382    0  295 33684.5597 67318.2382   100%     -  505s
H    0     0                    33890.469659 67318.0862  98.6%     -  506s
H    0     0                    33977.451231 67318.0862  98.1%     -  506s
     0     0 66862.0859    0  324 33977.4512 66862.0859  96.8%     -  535s
     0     0 66642.8189    0  316 33977.4512 66642.8189  96.1%     -  556s
     0     0 66510.7736    0  348 33977.4512 66510.7736  95.7%     -  574s
     0     0 66477.6700    0  353 33977.4512 66477.6700  95.7%     -  581s
     0     0 66466.7880    0  322 33977.4512 66466.7880  95.6%     -  585s
     0     0 66440.9712    0  315 33977.4512 66440.9712  95.5%     -  593s
     0     0 66413.6881    0  320 33977.4512 66413.6881  95.5%     -  600s
     0     0 66386.9404    0  325 33977.4512 66386.9404  95.4%     -  608s
     0     0 66352.0460    0  327 33977.4512 66352.0460  95.3%     -  615s
     0     0 66312.0792    0  327 33977.4512 66312.0792  95.2%     -  627s
     0     0 66276.7706    0  362 33977.4512 66276.7706  95.1%     -  638s
     0     0 66266.3367    0  355 33977.4512 66266.3367  95.0%     -  644s
     0     0 66259.9052    0  361 33977.4512 66259.9052  95.0%     -  647s
     0     0 66247.8535    0  358 33977.4512 66247.8535  95.0%     -  652s
     0     0 66235.4691    0  347 33977.4512 66235.4691  94.9%     -  658s
     0     0 66230.8620    0  351 33977.4512 66230.8620  94.9%     -  661s
     0     0 66229.7085    0  351 33977.4512 66229.7085  94.9%     -  664s
     0     0 65402.2429    0  347 33977.4512 65402.2429  92.5%     -  717s
H    0     0                    35220.199045 65402.2049  85.7%     -  718s
H    0     0                    36080.196948 65402.2049  81.3%     -  718s
H    0     0                    36165.306495 65402.2049  80.8%     -  719s
H    0     0                    36184.408241 65402.2049  80.7%     -  719s
H    0     0                    36216.620765 65402.2049  80.6%     -  719s
H    0     0                    36226.056692 65402.2049  80.5%     -  719s
H    0     0                    36415.851449 65402.2049  79.6%     -  719s
     0     0 65185.4698    0  334 36415.8514 65185.4698  79.0%     -  743s
     0     0 65038.4906    0  403 36415.8514 65038.4906  78.6%     -  760s
     0     0 65002.1342    0  403 36415.8514 65002.1342  78.5%     -  769s
     0     0 64978.0866    0  405 36415.8514 64978.0866  78.4%     -  778s
     0     0 64955.0663    0  410 36415.8514 64955.0663  78.4%     -  784s
     0     0 64953.2481    0  417 36415.8514 64953.2481  78.4%     -  786s
     0     0 64754.6326    0  375 36415.8514 64754.6326  77.8%     -  822s
H    0     0                    36444.201140 64754.3603  77.7%     -  824s
     0     0 64696.3931    0  362 36444.2011 64696.3931  77.5%     -  847s
     0     0 64681.5875    0  373 36444.2011 64681.5875  77.5%     -  857s
     0     0 64676.4341    0  371 36444.2011 64676.4341  77.5%     -  861s
     0     0 64666.2316    0  369 36444.2011 64666.2316  77.4%     -  875s
     0     0 64660.4262    0  371 36444.2011 64660.4262  77.4%     -  884s
     0     0 64656.2867    0  369 36444.2011 64656.2867  77.4%     -  887s
     0     0 64656.0543    0  373 36444.2011 64656.0543  77.4%     -  888s
     0     0 64610.2691    0  427 36444.2011 64610.2691  77.3%     -  907s
     0     0 64587.4611    0  430 36444.2011 64587.4611  77.2%     -  922s
     0     0 64578.4468    0  401 36444.2011 64578.4468  77.2%     -  929s
     0     0 64573.7767    0  395 36444.2011 64573.7767  77.2%     -  933s
     0     0 64571.3060    0  426 36444.2011 64571.3060  77.2%     -  935s
     0     0 64565.4998    0  425 36444.2011 64565.4998  77.2%     -  938s
     0     0 64564.8444    0  391 36444.2011 64564.8444  77.2%     -  940s
     0     0 64515.8844    0  357 36444.2011 64515.8844  77.0%     -  956s
     0     0 64491.1931    0  369 36444.2011 64491.1931  77.0%     -  967s
     0     0 64468.4685    0  366 36444.2011 64468.4685  76.9%     -  979s
     0     0 64454.8941    0  369 36444.2011 64454.8941  76.9%     -  985s
     0     0 64448.7218    0  369 36444.2011 64448.7218  76.8%     -  989s
     0     0 64446.8719    0  370 36444.2011 64446.8719  76.8%     -  991s
     0     0 64428.1590    0  362 36444.2011 64428.1590  76.8%     - 1002s
H    0     0                    36449.395887 64427.5711  76.8%     - 1005s
     0     0 64422.8154    0  376 36449.3959 64422.8154  76.7%     - 1010s
     0     0 64422.0725    0  378 36449.3959 64422.0725  76.7%     - 1011s
     0     0 64390.2568    0  373 36449.3959 64390.2568  76.7%     - 1025s
     0     0 64383.1367    0  375 36449.3959 64383.1367  76.6%     - 1031s
     0     0 64379.4620    0  375 36449.3959 64379.4620  76.6%     - 1035s
     0     0 64379.0793    0  370 36449.3959 64379.0793  76.6%     - 1036s
     0     0 64355.5201    0  401 36449.3959 64355.5201  76.6%     - 1048s
H    0     0                    36578.855836 64354.8237  75.9%     - 1052s
H    0     0                    36589.848260 64354.8237  75.9%     - 1052s
     0     0 64347.5349    0  397 36589.8483 64347.5349  75.9%     - 1061s
     0     0 64344.8245    0  409 36589.8483 64344.8245  75.9%     - 1064s
     0     0 64344.6906    0  413 36589.8483 64344.6906  75.9%     - 1065s
     0     0 64332.2148    0  445 36589.8483 64332.2148  75.8%     - 1075s
     0     0 64325.3632    0  416 36589.8483 64325.3632  75.8%     - 1082s
     0     0 64323.7088    0  410 36589.8483 64323.7088  75.8%     - 1090s
     0     0 64321.5701    0  418 36589.8483 64321.5701  75.8%     - 1096s
H    0     0                    36671.324296 64321.3912  75.4%     - 1102s
     0     0 64319.6498    0  416 36671.3243 64319.6498  75.4%     - 1106s
     0     0 64310.2209    0  422 36671.3243 64310.2209  75.4%     - 1116s
     0     0 64310.1801    0  422 36671.3243 64310.1801  75.4%     - 1121s
H    0     0                    36733.428271 64310.1801  75.1%     - 1375s
H    0     0                    36823.685652 64310.1801  74.6%     - 1375s
     0     2 64310.1801    0  422 36823.6857 64310.1801  74.6%     - 1382s
     1     3 64206.0858    1  397 36823.6857 64310.0517  74.6% 16719 1400s
     2     4 64226.2008    1  419 36823.6857 64226.2008  74.4% 12619 1411s
     3     5 63909.6497    2  356 36823.6857 64226.1204  74.4% 15872 1434s
     4     9 63819.2380    2  364 36823.6857 64225.6997  74.4% 15496 1463s
     8    16 63507.3385    3  351 36823.6857 64061.6552  74.0% 15286 1529s
    15    32 62439.0157    4  370 36823.6857 64061.1231  74.0% 20418 1582s
    31    48 63292.7890    5  388 36823.6857 63811.2428  73.3% 27809 1743s
    47    74 62705.7656    6  389 36823.6857 63811.2428  73.3% 32725 1847s
H   62    74                    36839.320217 63811.2428  73.2% 29039 1847s
    73   154 62658.5124    7  362 36839.3202 63811.2428  73.2% 26877 2061s
   153   184 60886.0922    9  282 36839.3202 63811.2428  73.2% 19207 2126s
   183   226 60624.9102   10  288 36839.3202 63811.2428  73.2% 17575 2180s
H  198   226                    36908.802431 63811.2428  72.9% 16634 2180s
H  201   226                    36959.507898 63811.2428  72.7% 16473 2180s
H  203   226                    37743.306781 63811.2428  69.1% 16322 2180s
   225   339 60434.8624   15  290 37743.3068 63811.2428  69.1% 15440 2265s
   338   425 59399.7040   18  298 37743.3068 63811.2428  69.1% 12346 2323s
   424   469 58871.5577   22  270 37743.3068 63811.2428  69.1% 10920 2374s
   468   496 58466.9098   24  289 37743.3068 63811.2428  69.1% 10658 2417s
H  470   496                    37931.363892 63811.2428  68.2% 10638 2417s
   495   540 58193.8621   25  290 37931.3639 63811.2428  68.2% 10576 2468s
   539   591 57869.8821   26  283 37931.3639 63811.2428  68.2% 10344 2515s
   590   651 57474.0984   27  279 37931.3639 63811.2428  68.2% 10010 2564s
   650   716 57279.8111   29  268 37931.3639 63811.2428  68.2%  9578 2607s
   715   770 56629.8091   26  251 37931.3639 63811.2428  68.2%  9245 2655s
   769   830 56442.5492   31  275 37931.3639 63811.2428  68.2%  9039 2701s
   829   931 56337.9651   36  297 37931.3639 63811.2428  68.2%  8838 2742s
   930   962 55758.3633   41  331 37931.3639 63811.2428  68.2%  8388 2780s
   961   996 54452.2929   42  341 37931.3639 63811.2428  68.2%  8377 2813s
   995  1032 54444.0954   43  312 37931.3639 63811.2428  68.2%  8303 2847s
H 1005  1032                    38339.068217 63811.2428  66.4%  8267 2847s
  1031  1085 54316.5635   44  340 38339.0682 63811.2428  66.4%  8223 2897s
  1084  1113 53643.7551   46  262 38339.0682 63811.2428  66.4%  8109 2937s
H 1085  1113                    38346.374497 63811.2428  66.4%  8102 2937s
H 1090  1113                    38348.388070 63811.2428  66.4%  8097 2937s
H 1093  1113                    38474.395077 63811.2428  65.9%  8081 2937s
  1112  1223 53476.4077   47  287 38474.3951 63811.2428  65.9%  8126 2985s
  1222  1347 52773.6211   51  277 38474.3951 63811.2428  65.9%  7807 3035s
  1348  1478 48326.3364   56  256 38474.3951 63811.2428  65.9%  7455 3088s
  1489  1609 47325.2239   65  128 38474.3951 63811.2428  65.9%  7091 3139s
  1624  1794 44846.3428   75  122 38474.3951 63811.2428  65.9%  6841 3190s
  1823  1965 44182.4853   86  118 38474.3951 63811.2428  65.9%  6418 3243s
  2037  2044 42102.7094   95   96 38474.3951 63811.2428  65.9%  6014 3296s
  2210  2067 46429.5863   90  142 38474.3951 63811.2428  65.9%  5829 3364s
H 2219  2067                    38563.767342 63811.2428  65.5%  5814 3365s
  2243  2215 44788.7156   91  162 38563.7673 63811.2428  65.5%  5817 3423s
  2493  2335 47815.4969   47  271 38563.7673 63811.2428  65.5%  5521 3485s
  2732  2445 41446.2058   51  152 38563.7673 63811.2428  65.5%  5266 3562s
  2919  2506 40023.5231   56  201 38563.7673 63811.2428  65.5%  5184 3600s

Cutting planes:
  Learned: 2
  Gomory: 21
  Implied bound: 319
  MIR: 4533
  Flow cover: 3509
  RLT: 54
  Relax-and-lift: 680

Explored 3038 nodes (16491700 simplex iterations) in 3600.06 seconds (8355.53 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: 38563.8 38474.4 38348.4 ... 36733.4

Time limit reached
Best objective 3.856376734214e+04, best bound 6.381124276830e+04, gap 65.4694%
  WARNING: Time limit reached. Using best solution found (gap: 65.47%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 38563.77, θ = 215922.32
  Upper Bound (UB) = 38563.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 215922.32
  [DEBUG]   ✓ Scenario 0: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 18: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 19: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 20: θ = 215922.32 ≤ Q = 215922.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 21] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1baeec81
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9755 128-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 256 physical cores, 256 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1baeec81
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.339645e+13
Presolve removed 2586 rows and 1877 columns
Presolve time: 0.00s
Presolved: 507 rows, 512 columns, 1433 nonzeros
Found heuristic solution: objective 6562829.3778
Variable types: 348 continuous, 164 integer (164 binary)

Root relaxation: objective -1.650528e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165052.80    0  123 6562829.38 -165052.80   103%     -    0s
H    0     0                    -132103.8608 -165052.80  24.9%     -    0s
H    0     0                    -132447.1143 -165052.80  24.6%     -    0s
     0     0 -142369.02    0   45 -132447.11 -142369.02  7.49%     -    0s
H    0     0                    -140386.3026 -142307.98  1.37%     -    0s
H    0     0                    -140774.7046 -142307.98  1.09%     -    0s
H    0     0                    -141216.7886 -142307.98  0.77%     -    0s
H    0     0                    -141605.1906 -142307.98  0.50%     -    0s
     0     0 -141935.14    0   33 -141605.19 -141935.14  0.23%     -    0s
     0     0 -141927.28    0   20 -141605.19 -141927.28  0.23%     -    0s
     0     0 -141926.82    0   18 -141605.19 -141926.82  0.23%     -    0s
     0     0 -141899.16    0   19 -141605.19 -141899.16  0.21%     -    0s
     0     0 -141854.47    0   19 -141605.19 -141854.47  0.18%     -    0s
     0     0 -141854.47    0   33 -141605.19 -141854.47  0.18%     -    0s
     0     0 -141746.35    0   19 -141605.19 -141746.35  0.10%     -    0s
     0     0 -141737.72    0   19 -141605.19 -141737.72  0.09%     -    0s
     0     0 -141735.36    0   17 -141605.19 -141735.36  0.09%     -    0s
     0     0 -141727.56    0   16 -141605.19 -141727.56  0.09%     -    0s
     0     0 -141698.66    0   13 -141605.19 -141698.66  0.07%     -    0s
     0     0 -141676.98    0   14 -141605.19 -141676.98  0.05%     -    0s
     0     0 -141670.14    0   13 -141605.19 -141670.14  0.05%     -    0s
     0     0 -141658.05    0   16 -141605.19 -141658.05  0.04%     -    0s
     0     0 -141631.13    0    4 -141605.19 -141631.13  0.02%     -    0s
     0     0 -141631.13    0   11 -141605.19 -141631.13  0.02%     -    0s
     0     0 -141622.79    0    3 -141605.19 -141622.79  0.01%     -    0s
H    0     0                    -141619.1278 -141621.49  0.00%     -    0s
*    0     0               0    -141619.4270 -141619.43  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 1
  MIR: 3
  Flow cover: 6

Explored 1 nodes (792 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 256 available processors)

Solution count 10: -141619 -141619 -141605 ... 1.33964e+13
No other solutions better than -141619

Optimal solution found (tolerance 1.00e-06)
Best objective -1.416194269527e+05, best bound -1.416194269527e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 208942.74
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141619.43
  [DEBUG]   S×d_nominal = 350562.17
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 350562.17 + -141619.43 = 208942.74
  [DEBUG]   Current θ from Master = 215922.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6979.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 31584.19
  Lower Bound (LB) = 38407.27
  Gap (UB-LB) = 156.4973, Absolute Gap = 156.4973, Relative Gap = 0.004058
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 21
Total Time: 62291.58s
Converged: True
Final Lower Bound: 38407.2701
Final Upper Bound: 38563.7673
Final Gap: 156.497275
Number of Critical Scenarios: 21
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1, 2] (2/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 4
DCs Opened: [0, 4, 5, 7, 9] (5/10)
Active Routes (Plant→DC): 14
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 5 customers  Mode 2: 44 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 21
Start Time: 2026-01-03 11:12:25
End Time: 2026-01-04 04:30:37
Total Time: 62291.58s
Optimal Value: 38407.27
Lower Bound: 38407.27
Upper Bound: 38563.77
Gap: 156.497275
Plants Opened: {0: [2], 1: [1, 2], 2: [1]} (4 plants)
DCs Opened: [0, 4, 5, 7, 9] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed23_HD_gamma20_20260104_043037.csv

Total Execution Time: 62291.89 seconds
End Time: 2026-01-04 04:30:37

All tasks completed successfully!

