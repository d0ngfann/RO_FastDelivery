
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 12
DI Scenario: Mixed
Start Time: 2026-01-03 09:45:25
================================================================================
Loading data from data/DH_data_full_seed12.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.315', '1.730'] (k=0.676)
  Product 1: ['1.000', '1.193', '1.424'] (k=0.436)
  Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=928, max=1669
  DC capacity (MC): min=444, max=839

Demand Structure (s_rk matrix):
  Total customer-product pairs: 79/150 (47.3% sparse)
  Average products per customer: 1.58

Demand (only non-zero entries):
  Nominal (μ): min=8.02, max=34.77, count=79
  Deviation (μ̂): min=4.04, max=9.89

Costs:
  Plant fixed cost: min=5855, max=8988
  DC fixed cost: min=3255, max=5629
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.315', '1.730'] (k=0.676)
    Product 1: ['1.000', '1.459', '2.127'] (k=0.931)
    Product 2: ['1.000', '1.356', '1.838'] (k=0.751)
  MD:
    Product 0: ['1.000', '1.275', '1.626'] (k=0.599)
    Product 1: ['1.000', '1.193', '1.424'] (k=0.436)
    Product 2: ['1.000', '1.235', '1.525'] (k=0.521)
  LD:
    Product 0: ['1.000', '1.091', '1.191'] (k=0.215)
    Product 1: ['1.000', '1.071', '1.147'] (k=0.169)
    Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
  Mixed:
    Product 0: ['1.000', '1.315', '1.730'] (k=0.676)
    Product 1: ['1.000', '1.193', '1.424'] (k=0.436)
    Product 2: ['1.000', '1.055', '1.114'] (k=0.133)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48747 nonzeros
Model fingerprint: 0x3f068969
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11912 rows and 2912 columns
Presolve time: 0.15s
Presolved: 4761 rows, 5588 columns, 33115 nonzeros
Variable types: 3329 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -304342.5778
Found heuristic solution: objective -185355.3570

Root relaxation: objective 8.472681e+04, 4559 iterations, 0.26 seconds (0.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 84726.8111    0  569 -185355.36 84726.8111   146%     -    0s
H    0     0                    -183348.2604 84726.8111   146%     -    0s
     0     0 76168.3066    0  694 -183348.26 76168.3066   142%     -    1s
H    0     0                    -165957.4706 75733.0493   146%     -    1s
     0     0 75733.0493    0  699 -165957.47 75733.0493   146%     -    1s
     0     0 75725.0971    0  708 -165957.47 75725.0971   146%     -    1s
H    0     0                    -113548.4284 68851.2437   161%     -    3s
H    0     0                    -113268.9825 68851.2437   161%     -    3s
H    0     0                    -112942.5377 68851.2437   161%     -    3s
H    0     0                    -112843.2747 68851.2437   161%     -    3s
H    0     0                    -112603.9386 68851.2437   161%     -    3s
H    0     0                    -112391.6267 68851.2437   161%     -    3s
H    0     0                    -112184.5730 68851.2437   161%     -    3s
H    0     0                    -111863.2983 68851.2437   162%     -    3s
H    0     0                    -111639.1942 68851.2437   162%     -    3s
     0     0 68851.2437    0 1016 -111639.19 68851.2437   162%     -    3s
     0     0 68583.3244    0 1005 -111639.19 68583.3244   161%     -    3s
     0     0 68570.8162    0 1004 -111639.19 68570.8162   161%     -    3s
     0     0 68568.4861    0 1008 -111639.19 68568.4861   161%     -    3s
     0     0 64238.9893    0 1113 -111639.19 64238.9893   158%     -    5s
     0     0 63504.2848    0 1099 -111639.19 63504.2848   157%     -    6s
     0     0 63350.4101    0 1230 -111639.19 63350.4101   157%     -    7s
H    0     0                    -20497.68783 63342.3549   409%     -    7s
H    0     0                     105.0812646 63342.3549      -     -    7s
     0     0 63342.3549    0 1230  105.08126 63342.3549      -     -    7s
     0     0 63341.8254    0 1230  105.08126 63341.8254      -     -    7s
H    0     0                     240.0904448 60631.5012      -     -   10s
     0     0 60631.5012    0 1287  240.09044 60631.5012      -     -   10s
     0     0 60343.8174    0 1269  240.09044 60343.8174      -     -   10s
     0     0 60312.8926    0 1290  240.09044 60312.8926      -     -   10s
     0     0 60301.5238    0 1294  240.09044 60301.5238      -     -   11s
     0     0 60299.0522    0 1297  240.09044 60299.0522      -     -   11s
H    0     0                     274.6239595 58499.5790      -     -   13s
H    0     0                     476.6727826 58499.5790      -     -   13s
H    0     0                     805.4171749 58499.5790  7163%     -   13s
H    0     0                     807.3736352 58499.5790  7146%     -   13s
H    0     0                     853.0278543 58499.5790  6758%     -   13s
H    0     0                     865.8199534 58499.5790  6657%     -   13s
H    0     0                    1214.3595949 58499.5790  4717%     -   13s
H    0     0                    1352.9873808 58499.5790  4224%     -   13s
H    0     0                    1975.5984926 58499.5790  2861%     -   13s
     0     0 58499.5790    0 1250 1975.59849 58499.5790  2861%     -   13s
H    0     0                    1992.6394945 58222.8375  2822%     -   14s
H    0     0                    2639.5422849 58222.8375  2106%     -   14s
H    0     0                    2654.9008067 58222.8375  2093%     -   14s
H    0     0                    3160.2366699 58222.8375  1742%     -   14s
H    0     0                    3178.4196097 58222.8375  1732%     -   14s
H    0     0                    3287.6229842 58222.8375  1671%     -   14s
H    0     0                    3352.1083699 58222.8375  1637%     -   14s
H    0     0                    3524.5695620 58222.8375  1552%     -   14s
H    0     0                    3672.0326811 58222.8375  1486%     -   14s
H    0     0                    3675.3303353 58222.8375  1484%     -   14s
H    0     0                    4214.0171021 58222.8375  1282%     -   14s
     0     0 58222.8375    0 1296 4214.01710 58222.8375  1282%     -   14s
H    0     0                    4240.5010906 58185.6024  1272%     -   14s
H    0     0                    5655.4016577 58185.6024   929%     -   14s
     0     0 58185.6024    0 1309 5655.40166 58185.6024   929%     -   14s
     0     0 58177.6199    0 1312 5655.40166 58177.6199   929%     -   15s
H    0     0                    12297.071541 56837.8541   362%     -   18s
H    0     0                    12357.723750 56837.8541   360%     -   18s
H    0     0                    12368.842694 56837.8541   360%     -   18s
H    0     0                    12398.792501 56837.8541   358%     -   18s
H    0     0                    12487.708155 56837.8541   355%     -   18s
H    0     0                    12503.215999 56837.8541   355%     -   18s
H    0     0                    12562.729907 56837.8541   352%     -   18s
H    0     0                    12597.637739 56837.8541   351%     -   18s
H    0     0                    12639.751855 56837.8541   350%     -   18s
H    0     0                    13443.680759 56837.8541   323%     -   18s
H    0     0                    13898.269730 56837.8541   309%     -   18s
H    0     0                    13952.138961 56837.8541   307%     -   18s
H    0     0                    13959.273749 56837.8541   307%     -   18s
H    0     0                    13986.190326 56837.8541   306%     -   18s
H    0     0                    13997.496099 56837.8541   306%     -   18s
H    0     0                    14028.399520 56837.8541   305%     -   18s
H    0     0                    14120.805278 56837.8541   303%     -   18s
H    0     0                    15578.198819 56837.8541   265%     -   18s
H    0     0                    16014.966145 56837.8541   255%     -   18s
H    0     0                    16034.176012 56837.8541   254%     -   18s
H    0     0                    16318.256198 56837.8541   248%     -   18s
H    0     0                    17471.206881 56837.8541   225%     -   18s
H    0     0                    17472.548075 56837.8541   225%     -   18s
     0     0 56837.8541    0 1299 17472.5481 56837.8541   225%     -   18s
     0     0 56541.4916    0 1302 17472.5481 56541.4916   224%     -   19s
     0     0 56504.2807    0 1308 17472.5481 56504.2807   223%     -   20s
     0     0 56487.5371    0 1308 17472.5481 56487.5371   223%     -   20s
     0     0 55451.2535    0 1310 17472.5481 55451.2535   217%     -   23s
H    0     0                    17581.590452 55276.9067   214%     -   24s
H    0     0                    17585.507208 55276.9067   214%     -   24s
H    0     0                    17601.278899 55276.9067   214%     -   24s
     0     0 55276.9067    0 1315 17601.2789 55276.9067   214%     -   24s
     0     0 55252.8425    0 1339 17601.2789 55252.8425   214%     -   24s
     0     0 55245.9530    0 1350 17601.2789 55245.9530   214%     -   24s
H    0     0                    17655.790101 54490.9976   209%     -   27s
H    0     0                    17685.646859 54490.9976   208%     -   27s
H    0     0                    17829.083525 54490.9976   206%     -   27s
H    0     0                    17913.237105 54490.9976   204%     -   27s
H    0     0                    17915.033016 54490.9976   204%     -   27s
     0     0 54490.9976    0 1298 17915.0330 54490.9976   204%     -   27s
     0     0 54366.0216    0 1333 17915.0330 54366.0216   203%     -   28s
     0     0 54338.7376    0 1359 17915.0330 54338.7376   203%     -   29s
H    0     0                    18637.874112 54326.5324   191%     -   29s
H    0     0                    18729.607970 54326.5324   190%     -   29s
H    0     0                    19135.066406 54326.5324   184%     -   29s
H    0     0                    19137.431165 54326.5324   184%     -   29s
H    0     0                    19140.858139 54326.5324   184%     -   29s
H    0     0                    19143.343007 54326.5324   184%     -   29s
H    0     0                    19164.390793 54326.5324   183%     -   29s
     0     0 54326.5324    0 1363 19164.3908 54326.5324   183%     -   29s
H    0     0                    19231.278502 53677.2748   179%     -   33s
H    0     0                    19276.120208 53677.2748   178%     -   33s
H    0     0                    19286.191420 53677.2748   178%     -   33s
H    0     0                    19296.145311 53677.2748   178%     -   33s
H    0     0                    19306.216522 53677.2748   178%     -   33s
H    0     0                    19491.917396 53677.2748   175%     -   33s
H    0     0                    19529.511852 53677.2748   175%     -   33s
H    0     0                    19557.535279 53677.2748   174%     -   33s
     0     0 53677.2748    0 1298 19557.5353 53677.2748   174%     -   33s
     0     0 53552.4713    0 1337 19557.5353 53552.4713   174%     -   35s
     0     0 53524.6309    0 1344 19557.5353 53524.6309   174%     -   36s
     0     0 53517.3668    0 1344 19557.5353 53517.3668   174%     -   36s
H    0     0                    19571.583016 53119.7339   171%     -   39s
     0     0 53119.7339    0 1276 19571.5830 53119.7339   171%     -   39s
     0     0 53035.5683    0 1355 19571.5830 53035.5683   171%     -   40s
     0     0 53014.7520    0 1333 19571.5830 53014.7520   171%     -   41s
     0     0 52725.4195    0 1263 19571.5830 52725.4195   169%     -   44s
     0     0 52647.1062    0 1273 19571.5830 52647.1062   169%     -   45s
     0     0 52629.8025    0 1299 19571.5830 52629.8025   169%     -   46s
     0     0 52406.4917    0 1220 19571.5830 52406.4917   168%     -   48s
     0     0 52406.4077    0 1220 19571.5830 52406.4077   168%     -   48s
     0     2 52406.4077    0 1220 19571.5830 52406.4077   168%     -   51s
     3     8 50467.8638    2 1039 19571.5830 51922.2131   165%  5510   57s
     7    16 48308.2293    3  912 19571.5830 50453.2006   158%  4260   61s
    31    64 46282.0493    5  840 19571.5830 48204.9875   146%  3513   70s
H   37    64                    19598.305549 48204.9875   146%  3700   70s
H   41    64                    19784.271726 48203.6825   144%  3903   70s
   233   340 40225.8317    8  561 19784.2717 46788.7599   136%  1743   76s
H  401   407                    19811.507292 46788.7599   136%  1259   78s
H  449   434                    19811.756093 46788.7599   136%  1182   78s
H  459   506                    19812.023473 46788.7599   136%  1167   80s
H  461   506                    19839.737843 46788.7599   136%  1163   80s
H  495   506                    19899.083262 46788.7599   135%  1125   80s
H  515   506                    19918.909127 46788.7599   135%  1096   80s
H  631   613                    19925.958988 46486.4064   133%  1011   82s
H  785   729                    19941.456145 46452.7536   133%   932   84s
H  825   729                    20053.401364 46452.7536   132%   918   84s
   828   813 33618.2760   20  460 20053.4014 46452.7536   132%   917   86s
  1135  1014 31961.8831   26  358 20053.4014 44579.8154   122%   803   90s
H 1242  1081                    20081.588597 44454.8526   121%   784   91s
  1491  1390 28876.9293   36  370 20081.5886 44454.8526   121%   732   96s
  2049  1706     cutoff   54      20081.5886 43126.3091   115%   626  100s
  2572  2007 infeasible   19      20081.5886 42110.9864   110%   591  105s
H 2985  2123                    20087.949960 41993.1320   109%   572  107s
H 3042  2120                    20156.334166 41993.1320   108%   572  107s
  3282  2351 22897.1655   29  216 20156.3342 41993.1320   108%   561  110s
H 3941  2625                    20161.544118 41419.4795   105%   545  120s
  3942  2626 20989.7701   26 1220 20161.5441 41419.4795   105%   545  137s
  3950  2631 34153.8378   29  356 20161.5441 34153.8378  69.4%   544  140s
  3961  2639 23249.7204   41  471 20161.5441 32311.7496  60.3%   542  145s
H 4055  2576                    20162.885312 29783.3632  47.7%   546  149s
  4181  2579 23723.6436   20  324 20162.8853 29059.7256  44.1%   541  150s
H 4230  2448                    21110.414963 29059.7256  37.7%   537  151s
H 4248  2322                    23376.071950 29059.7256  24.3%   536  151s
H 4252  2208                    24856.358500 29059.7256  16.9%   536  151s
H 4667  2004                    25682.137846 27224.5108  6.01%   497  154s
H 4695  1893                    26046.137646 27187.6081  4.38%   495  154s
H 4722  1786                    26135.495841 27187.6081  4.03%   492  154s
H 4911  1467                    26260.442790 27172.9299  3.47%   474  154s
H 4932  1372                    26265.289009 27172.9299  3.46%   472  154s
H 4981  1301                    26287.567269 27170.2722  3.36%   468  154s
  5022  1335 26753.4322   28   39 26287.5673 27164.5896  3.34%   464  155s
H 5029  1254                    26553.459121 27164.5896  2.30%   464  155s
H 5038  1175                    26560.679045 27164.5896  2.27%   463  155s
H 5120  1076                    26563.541546 27159.4937  2.24%   456  155s
H 5265   934                    26581.172552 27158.1709  2.17%   444  155s
H 5490   831                    26701.562622 27081.1630  1.42%   427  155s
H 5657   694                    26722.056128 27081.1630  1.34%   415  155s
H 5680   629                    26733.563101 27081.1630  1.30%   413  155s
* 5920   469              49    26736.239009 27048.3217  1.17%   397  156s
* 6491   269              57    26763.182316 27021.5564  0.97%   364  156s
H 6603   149                    26791.040491 27021.5564  0.86%   359  156s
H 6726    88                    26791.567766 27021.5564  0.86%   352  156s
H 6800    88                    26792.544054 27021.5564  0.85%   349  156s
* 7328     9              49    26792.804069 27006.5474  0.80%   325  156s

Cutting planes:
  Implied bound: 7
  Projected implied bound: 53
  MIR: 192
  Flow cover: 459
  RLT: 16
  Relax-and-lift: 113

Explored 7379 nodes (2457713 simplex iterations) in 156.83 seconds (179.16 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 26792.8 26792.5 26791.6 ... 26581.2

Optimal solution found (tolerance 1.00e-06)
Best objective 2.679280406932e+04, best bound 2.679280406932e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 156.83s
  Master Objective (UB) = 26792.80, θ = 156741.74
  Upper Bound (UB) = 26792.80

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156741.74
  [DEBUG]   ✓ Scenario 0: θ = 156741.74 ≤ Q = 156741.74 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3799b81c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3799b81c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.409680e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6924679.7327
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.339111e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -133911.14    0  124 6924679.73 -133911.14   102%     -    0s
H    0     0                    -100892.0769 -133911.14  32.7%     -    0s
H    0     0                    -101420.8217 -133911.14  32.0%     -    0s
*    0     0               0    -103649.9305 -103649.93  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 203

Explored 1 nodes (371 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -103650 -101421 -100892 ... 1.40968e+13
No other solutions better than -103650

Optimal solution found (tolerance 1.00e-06)
Best objective -1.036499305373e+05, best bound -1.036499305373e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 123919.09
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103649.93
  [DEBUG]   S×d_nominal = 227569.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 227569.02 + -103649.93 = 123919.09
  [DEBUG]   Current θ from Master = 156741.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32822.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6029.84
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 32822.6453, Absolute Gap = 32822.6453, Relative Gap = 1.225055
  Not converged yet (gap = 32822.65 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91975 nonzeros
Model fingerprint: 0xbc6cbb72
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -6029.84 (0.03s)
MIP start from previous solve produced solution with objective -6029.84 (0.03s)
Loaded MIP start from previous solve with objective -6029.84

Presolve removed 14403 rows and 5842 columns
Presolve time: 0.58s
Presolved: 17560 rows, 8898 columns, 97148 nonzeros
Variable types: 6639 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.853265e+04, 8348 iterations, 1.88 seconds (2.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28532.6454    0  432 -6029.8412 28532.6454   573%     -    2s
H    0     0                    -5166.870364 28532.6454   652%     -    2s
H    0     0                    -5052.949126 28532.6454   665%     -    2s
H    0     0                    -3583.563523 28532.6454   896%     -    2s
H    0     0                    -3518.941279 28532.6454   911%     -    3s
     0     0 18518.8893    0  598 -3518.9413 18518.8893   626%     -    5s
H    0     0                    -3338.737534 18514.2393   655%     -    5s
     0     0 18417.6287    0  595 -3338.7375 18417.6287   652%     -    6s
     0     0 18416.8359    0  603 -3338.7375 18416.8359   652%     -    6s
     0     0 13742.3815    0  644 -3338.7375 13742.3815   512%     -    8s
     0     0 13326.1780    0  675 -3338.7375 13326.1780   499%     -    9s
     0     0 13219.3272    0  602 -3338.7375 13219.3272   496%     -    9s
     0     0 13183.7504    0  608 -3338.7375 13183.7504   495%     -    9s
     0     0 13182.9305    0  614 -3338.7375 13182.9305   495%     -   10s
     0     0 10628.1848    0  525 -3338.7375 10628.1848   418%     -   13s
     0     0 10350.4035    0  585 -3338.7375 10350.4035   410%     -   14s
     0     0 10285.3983    0  586 -3338.7375 10285.3983   408%     -   14s
     0     0 10250.5218    0  574 -3338.7375 10250.5218   407%     -   15s
     0     0 10238.8697    0  575 -3338.7375 10238.8697   407%     -   15s
     0     0 10234.8824    0  586 -3338.7375 10234.8824   407%     -   15s
     0     0 8596.88861    0  524 -3338.7375 8596.88861   357%     -   19s
     0     0 8045.60067    0  654 -3338.7375 8045.60067   341%     -   20s
     0     0 7974.58747    0  660 -3338.7375 7974.58747   339%     -   21s
     0     0 7885.08699    0  684 -3338.7375 7885.08699   336%     -   21s
     0     0 7857.55850    0  598 -3338.7375 7857.55850   335%     -   22s
     0     0 7851.36351    0  680 -3338.7375 7851.36351   335%     -   22s
     0     0 7848.92363    0  675 -3338.7375 7848.92363   335%     -   22s
     0     0 7145.79639    0  540 -3338.7375 7145.79639   314%     -   24s
     0     0 7071.45272    0  687 -3338.7375 7071.45272   312%     -   25s
     0     0 7031.18341    0  702 -3338.7375 7031.18341   311%     -   25s
     0     0 7022.49561    0  695 -3338.7375 7022.49561   310%     -   26s
     0     0 7020.80964    0  757 -3338.7375 7020.80964   310%     -   26s
     0     0 6778.48741    0  477 -3338.7375 6778.48741   303%     -   28s
H    0     0                    -3338.476024 6775.51116   303%     -   30s
H    0     0                    -2080.292651 6775.51116   426%     -   30s
H    0     0                    -1780.253508 6775.51116   481%     -   30s
H    0     0                    -1706.833190 6775.51116   497%     -   30s
H    0     0                    -1676.835774 6775.51116   504%     -   30s
H    0     0                    -1641.779865 6775.51116   513%     -   30s
H    0     0                    -1558.389002 6775.51116   535%     -   30s
H    0     0                    -1022.253212 6775.51116   763%     -   30s
H    0     0                    -987.3398153 6775.51116   786%     -   30s
H    0     0                    -904.0759850 6775.51116   849%     -   30s
     0     0 6707.91896    0  478 -904.07599 6707.91896   842%     -   30s
     0     0 6694.51949    0  481 -904.07599 6694.51949   840%     -   31s
     0     0 6691.82921    0  475 -904.07599 6691.82921   840%     -   31s
     0     0 6592.78377    0  473 -904.07599 6592.78377   829%     -   32s
     0     0 6565.68978    0  481 -904.07599 6565.68978   826%     -   32s
     0     0 6554.34197    0  479 -904.07599 6554.34197   825%     -   33s
     0     0 6551.28704    0  484 -904.07599 6551.28704   825%     -   33s
     0     0 6472.53273    0  406 -904.07599 6472.53273   816%     -   34s
     0     0 6442.53777    0  486 -904.07599 6442.53777   813%     -   34s
     0     0 6437.56019    0  495 -904.07599 6437.56019   812%     -   34s
     0     0 6391.63088    0  490 -904.07599 6391.63088   807%     -   35s
     0     0 6373.71633    0  501 -904.07599 6373.71633   805%     -   36s
     0     0 6369.13316    0  499 -904.07599 6369.13316   804%     -   36s
     0     0 6355.08704    0  417 -904.07599 6355.08704   803%     -   36s
     0     0 6351.11906    0  493 -904.07599 6351.11906   802%     -   37s
     0     0 6338.69723    0  489 -904.07599 6338.69723   801%     -   37s
     0     0 6333.76914    0  498 -904.07599 6333.76914   801%     -   38s
     0     0 6310.08484    0  496 -904.07599 6310.08484   798%     -   38s
     0     0 6309.93839    0  496 -904.07599 6309.93839   798%     -   39s
H    0     0                    -877.5545592 6309.84262   819%     -   48s
H    0     0                    -857.8113602 6309.84262   836%     -   48s
H    0     0                    -456.8618201 6309.84262  1481%     -   48s
H    0     0                    -316.8746590 6309.84262  2091%     -   48s
     0     2 6309.84262    0  496 -316.87466 6309.84262  2091%     -   49s
     1     4 6197.24367    1  426 -316.87466 6309.84262  2091%   710   51s
    31    58 3288.87822    5  383 -316.87466 5624.80547  1875%  1030   56s
H   77    82                    -303.9184045 5513.24533  1914%  1043   58s
    93   185 2857.48006    7  386 -303.91840 5451.26697  1894%  1029   60s
H  281   243                    -299.6777029 5354.39441  1887%   525   62s
   633   471  -24.90179   17  211 -299.67770 5168.57518  1825%   338   65s
  1118   715  136.07189   15  163 -299.67770 4989.39895  1765%   295   70s
  1668   896 infeasible   27      -299.67770 4623.64478  1643%   262   75s
  2325  1088 3136.92960   15  144 -299.67770 4367.82187  1558%   251   80s
  3305  1424 1122.23093   23  141 -299.67770 3779.34050  1361%   236   85s
* 3435  1424              53    -288.3456773 3751.84523  1401%   237   85s
  3991  1550 1306.88018   17  154 -288.34568 3309.12082  1248%   239   90s
H 4176  1550                    -210.2828088 3265.21815  1653%   237   90s
H 4179  1569                    -154.8652447 3265.21815  2208%   237   91s
H 4195  1569                     -95.3749935 3265.21815  3524%   237   91s
  4746  1608  656.12002   21  139  -95.37499 3127.29301  3379%   237   96s
  5350  1594     cutoff   14       -95.37499 2730.83859  2963%   242  101s
  6192  1569 1209.65386   15  123  -95.37499 2342.37612  2556%   238  105s
  6743  1461  268.72760   24  120  -95.37499 2016.30551  2214%   238  110s
  7750  1187  625.66652   35   67  -95.37499 1671.09774  1852%   233  116s
  9516   519     cutoff   10       -95.37499 1067.57214  1219%   221  120s

Cutting planes:
  Gomory: 11
  Implied bound: 1
  MIR: 1576
  Flow cover: 870
  Zero half: 4
  RLT: 67
  Relax-and-lift: 309

Explored 11658 nodes (2330271 simplex iterations) in 122.47 seconds (172.16 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -95.375 -154.865 -210.283 ... -877.555
No other solutions better than -95.375

Optimal solution found (tolerance 1.00e-06)
Best objective -9.537499346826e+01, best bound -9.537499346826e+01, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 122.50s
  Master Objective (UB) = -95.37, θ = 131547.79
  Upper Bound (UB) = -95.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 131547.79
  [DEBUG]   ✓ Scenario 0: θ = 131547.79 ≤ Q = 131547.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 131547.79 ≤ Q = 131547.79 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5b2a7cc3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa4d5833d
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.268478e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6269857.5588
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.324638e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132463.83    0  128 6269857.56 -132463.83   102%     -    0s
H    0     0                    -91535.78687 -132463.83  44.7%     -    0s
H    0     0                    -91843.91739 -132463.83  44.2%     -    0s
H    0     0                    -111598.2277 -132463.83  18.7%     -    0s
H    0     0                    -111644.7784 -132463.83  18.6%     -    0s
     0     0 -121537.55    0   83 -111644.78 -121537.55  8.86%     -    0s
H    0     0                    -117983.7636 -121443.21  2.93%     -    0s
     0     0 -121090.55    0   91 -117983.76 -121090.55  2.63%     -    0s
     0     0 -121090.44    0   91 -117983.76 -121090.44  2.63%     -    0s
     0     0 -120810.77    0   87 -117983.76 -120810.77  2.40%     -    0s
H    0     0                    -118756.4085 -120796.44  1.72%     -    0s
     0     0 -120787.76    0   84 -118756.41 -120787.76  1.71%     -    0s
H    0     0                    -120466.3538 -120787.76  0.27%     -    0s
     0     0 -120699.30    0   57 -120466.35 -120699.30  0.19%     -    0s
     0     0 -120659.55    0   33 -120466.35 -120659.55  0.16%     -    0s
     0     0 -120651.64    0   25 -120466.35 -120651.64  0.15%     -    0s
     0     0 -120650.17    0   23 -120466.35 -120650.17  0.15%     -    0s
H    0     0                    -120499.3924 -120585.30  0.07%     -    0s
     0     0 -120576.52    0   20 -120499.39 -120576.52  0.06%     -    0s
     0     0 -120550.43    0   11 -120499.39 -120550.43  0.04%     -    0s
     0     0 -120550.30    0   10 -120499.39 -120550.30  0.04%     -    0s
     0     0 -120526.70    0   12 -120499.39 -120526.70  0.02%     -    0s
     0     0 -120526.66    0   11 -120499.39 -120526.66  0.02%     -    0s
     0     0 -120525.69    0   11 -120499.39 -120525.69  0.02%     -    0s
     0     0 -120511.36    0    6 -120499.39 -120511.36  0.01%     -    0s
*    0     0               0    -120511.3379 -120511.34  0.00%     -    0s

Explored 1 nodes (731 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -120511 -120499 -120466 ... 6.26986e+06
No other solutions better than -120511

Optimal solution found (tolerance 1.00e-06)
Best objective -1.205113378941e+05, best bound -1.205113378941e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 106998.48
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120511.34
  [DEBUG]   S×d_nominal = 227509.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 227509.82 + -120511.34 = 106998.48
  [DEBUG]   Current θ from Master = 131547.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24549.31 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -24644.69
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 5934.4662, Absolute Gap = 5934.4662, Relative Gap = 62.222455
  Not converged yet (gap = 5934.47 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135203 nonzeros
Model fingerprint: 0x30f01f09
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -24644.7 (0.04s)
MIP start from previous solve produced solution with objective -24644.7 (0.05s)
Loaded MIP start from previous solve with objective -24644.7

Presolve removed 21603 rows and 8763 columns
Presolve time: 0.79s
Presolved: 25650 rows, 12217 columns, 143414 nonzeros
Variable types: 9958 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   23836    1.7468912e+04   0.000000e+00   1.277164e+10      5s
Concurrent spin time: 0.03s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   16909    2.8196676e+04   0.000000e+00   0.000000e+00      8s

Root relaxation: objective 2.819668e+04, 16909 iterations, 6.96 seconds (7.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 28196.6758    0  435 -24644.685 28196.6758   214%     -    8s
H    0     0                    -2463.635286 28196.6758  1245%     -    8s
H    0     0                    -1676.716486 28196.6758  1782%     -    8s
H    0     0                    -1665.017819 28196.6758  1793%     -    8s
H    0     0                    -1501.954470 28196.6758  1977%     -    9s
H    0     0                    -1490.255803 28196.6758  1992%     -    9s
H    0     0                    -1212.949850 17939.8278  1579%     -   13s
H    0     0                    -761.8884227 17939.8278  2455%     -   13s
H    0     0                    -721.7889276 17939.8278  2585%     -   13s
     0     0 17939.8278    0  599 -721.78893 17939.8278  2585%     -   13s
     0     0 17786.0185    0  605 -721.78893 17786.0185  2564%     -   14s
     0     0 17768.3341    0  610 -721.78893 17768.3341  2562%     -   15s
     0     0 17764.2657    0  614 -721.78893 17764.2657  2561%     -   15s
     0     0 17764.0914    0  619 -721.78893 17764.0914  2561%     -   15s
     0     0 13202.6850    0  587 -721.78893 13202.6850  1929%     -   21s
     0     0 12616.1596    0  625 -721.78893 12616.1596  1848%     -   23s
     0     0 12394.2407    0  613 -721.78893 12394.2407  1817%     -   24s
     0     0 12290.0029    0  611 -721.78893 12290.0029  1803%     -   25s
     0     0 12248.3840    0  617 -721.78893 12248.3840  1797%     -   25s
     0     0 12220.4321    0  613 -721.78893 12220.4321  1793%     -   26s
     0     0 12219.1007    0  607 -721.78893 12219.1007  1793%     -   26s
     0     0 8890.59039    0  598 -721.78893 8890.59039  1332%     -   35s
     0     0 8247.23267    0  618 -721.78893 8247.23267  1243%     -   38s
     0     0 7992.10459    0  777 -721.78893 7992.10459  1207%     -   40s
     0     0 7935.55320    0  653 -721.78893 7935.55320  1199%     -   41s
     0     0 7909.81181    0  720 -721.78893 7909.81181  1196%     -   42s
     0     0 7895.88144    0  722 -721.78893 7895.88144  1194%     -   42s
     0     0 7889.93036    0  649 -721.78893 7889.93036  1193%     -   42s
     0     0 7888.43558    0  721 -721.78893 7888.43558  1193%     -   42s
     0     0 6563.22861    0  487 -721.78893 6563.22861  1009%     -   50s
     0     0 6304.33997    0  578 -721.78893 6304.33997   973%     -   52s
     0     0 6190.89994    0  566 -721.78893 6190.89994   958%     -   54s
     0     0 6155.53073    0  635 -721.78893 6155.53073   953%     -   56s
     0     0 6137.97279    0  576 -721.78893 6137.97279   950%     -   56s
     0     0 6123.55568    0  635 -721.78893 6123.55568   948%     -   57s
     0     0 6119.28715    0  723 -721.78893 6119.28715   948%     -   57s
     0     0 5839.43774    0  568 -721.78893 5839.43774   909%     -   60s
H    0     0                    -717.6280867 5838.76596   914%     -   61s
H    0     0                    -654.5547266 5838.76596   992%     -   61s
     0     0 5762.26258    0  553 -654.55473 5762.26258   980%     -   62s
     0     0 5746.34714    0  554 -654.55473 5746.34714   978%     -   63s
     0     0 5743.19306    0  560 -654.55473 5743.19306   977%     -   64s
     0     0 5676.43511    0  490 -654.55473 5676.43511   967%     -   66s
     0     0 5665.77296    0  494 -654.55473 5665.77296   966%     -   67s
     0     0 5661.20198    0  494 -654.55473 5661.20198   965%     -   67s
     0     0 5618.92871    0  503 -654.55473 5618.92871   958%     -   69s
H    0     0                    -651.9007503 5618.51467   962%     -   69s
     0     0 5604.40364    0  510 -651.90075 5604.40364   960%     -   70s
     0     0 5599.38323    0  508 -651.90075 5599.38323   959%     -   70s
     0     0 5576.68355    0  519 -651.90075 5576.68355   955%     -   72s
     0     0 5576.08191    0  519 -651.90075 5576.08191   955%     -   72s
H    0     0                    -643.4294819 5576.08191   967%     -   86s
H    0     0                    -639.1507897 5576.08191   972%     -   86s
H    0     0                    -620.5272380 5576.08191   999%     -   87s
H    0     0                    -601.5002278 5576.08191  1027%     -   88s
H    0     0                    -578.3415566 5576.08191  1064%     -   88s
H    0     2                    -468.5673424 5576.08191  1290%     -   89s
     0     2 5576.08191    0  519 -468.56734 5576.08191  1290%     -   89s
     1     4 5452.65854    1  436 -468.56734 5575.43397  1290%  2786   92s
     7    16 5150.05955    3  484 -468.56734 5204.73997  1211%  2528   97s
    15    32 4540.42098    4  362 -468.56734 5149.86310  1199%  2441  102s
    31    64 4390.91037    5  520 -468.56734 5051.36687  1178%  3327  105s
    63    96 3156.20558    6  475 -468.56734 5039.10060  1175%  2718  110s
   197   226 2526.92384    9  484 -468.56734 5036.94456  1175%  1750  116s
   254   275 2514.45889   10  535 -468.56734 5036.94456  1175%  1601  121s
   409   374 2140.65906   13  444 -468.56734 4920.43629  1150%  1392  127s
   478   407     cutoff   14      -468.56734 4920.43629  1150%  1383  130s
   646   500     cutoff   16      -468.56734 4886.24860  1143%  1251  137s
   724   536  826.38985   12  402 -468.56734 4886.24860  1143%  1242  140s
H  830   539                    -464.6166455 4886.24860  1152%  1212  143s
   831   568     cutoff   12      -464.61665 4820.63935  1138%  1212  148s
   915   604 1129.60494    8  393 -464.61665 4820.63935  1138%  1209  152s
   990   632  379.40345    9  254 -464.61665 4820.63935  1138%  1181  156s
  1087   660  375.95916   10  260 -464.61665 4498.79863  1068%  1150  160s
H 1189   703                    -405.7603610 4498.79863  1209%  1116  163s
  1263   738  -78.14447   12  224 -405.76036 4498.79863  1209%  1114  166s
  1390   814     cutoff   13      -405.76036 4498.79863  1209%  1081  170s
  1650   972 3523.38412   13  306 -405.76036 4034.48828  1094%  1034  178s
  1770  1009 1721.63349   15  241 -405.76036 4034.48828  1094%  1032  181s
  1819  1035 1621.36440   16  246 -405.76036 4034.48828  1094%  1036  185s
  2017  1099 1350.56719   17  241 -405.76036 4034.48828  1094%  1025  193s
  2146  1117 2475.77186   15  266 -405.76036 3790.49636  1034%  1013  197s
  2316  1138 2406.67237   16  241 -405.76036 3693.11346  1010%   993  202s
  2441  1177 1331.63160   18  227 -405.76036 3693.11346  1010%   985  207s
  2593  1224 1298.01827   19  201 -405.76036 3574.18442   981%   984  211s
  2866  1299  939.32207   21  209 -405.76036 3424.94885   944%   979  219s
  3063  1369  492.62112   24  195 -405.76036 3413.83331   941%   963  223s
  3292  1392 -146.53213   32  101 -405.76036 3302.79581   914%   943  230s
  3731  1454 1961.10760   11  165 -405.76036 3097.71815   863%   930  240s
  3957  1481  716.35562   12  263 -405.76036 2983.39195   835%   923  246s
  4341  1545     cutoff   14      -405.76036 2915.81617   819%   908  253s
  4458  1553     cutoff   10      -405.76036 2868.79098   807%   908  257s
  4637  1576 -291.48425   11  364 -405.76036 2868.79098   807%   905  262s
  4832  1609 infeasible   21      -405.76036 2804.82159   791%   901  266s
  5060  1648  733.62819   14  266 -405.76036 2750.53087   778%   895  271s
  5406  1685  787.20132   27  141 -405.76036 2650.63856   753%   877  276s
  5709  1650     cutoff   13      -405.76036 2480.60359   711%   869  280s
  5891  1683  300.31085   25   99 -405.76036 2411.63767   694%   869  285s
  6267  1698     cutoff   17      -405.76036 2391.19684   689%   851  291s
  6673  1639  111.28493   22  169 -405.76036 2235.95859   651%   842  296s
  7038  1589 -176.65743   20   74 -405.76036 2148.78624   630%   839  300s
  7464  1551 infeasible   22      -405.76036 1973.12178   586%   831  307s
  8038  1580 -144.88306   16  164 -405.76036 1674.37296   513%   812  312s
  8775  1458   50.61916   18  132 -405.76036 1450.70892   458%   780  318s
  9500  1442     cutoff   22      -405.76036 1180.03514   391%   753  324s
 10544  1426 -245.19791   33   52 -405.76036 1041.49862   357%   711  328s
 11823  1549     cutoff   39      -405.76036  619.07095   253%   662  333s
 13693  1550 -243.10975   33  519 -405.76036  375.13896   192%   597  387s
 13695  1551  -49.45437   26  290 -405.76036  375.13896   192%   597  397s
 13696  1552  -12.85329   40  387 -405.76036  375.13896   192%   597  404s
 13697  1553  202.70940   33  469 -405.76036  375.13896   192%   597  408s
 13698  1553   34.32405   26  501 -405.76036  375.13896   192%   597  410s
 13703  1557   -5.29975   34  476 -405.76036  375.13896   192%   597  416s
 13705  1558  -55.60708   35  471 -405.76036  375.13896   192%   597  420s
 13707  1559 -127.43296   41  486 -405.76036  375.13896   192%   597  426s
 13710  1561  244.80163   29  473 -405.76036  375.13896   192%   596  432s
 13712  1563  279.86166   30  420 -405.76036  375.13896   192%   596  437s
 13714  1564 -100.57124   34  483 -405.76036  375.13896   192%   596  442s
 13716  1565 -275.06662   31  550 -405.76036  375.13896   192%   596  447s
 13718  1567  113.42313   52  574 -405.76036  375.13896   192%   596  451s
 13719  1567  108.85025   38  574 -405.76036  375.13896   192%   596  466s
 13720  1568 -232.85390   33  574 -405.76036  375.13896   192%   596  474s
 13721  1572  375.13896   12  390 -405.76036  375.13896   192%   601  479s
 13723  1575  375.13896   13  400 -405.76036  375.13896   192%   601  484s
 13727  1582  375.13896   14  432 -405.76036  375.13896   192%   602  488s
 13735  1593  375.13896   15  367 -405.76036  375.13896   192%   603  494s
 13751  1615  375.13896   16  315 -405.76036  375.13896   192%   606  498s
 13781  1621  365.15560   17  276 -405.76036  375.13896   192%   612  503s
 13813  1617     cutoff   18      -405.76036  375.13896   192%   615  508s
 13862  1593  375.13896   18  311 -405.76036  375.13896   192%   618  512s
 13959  1546     cutoff   19      -405.76036  375.13896   192%   623  518s
 14009  1504     cutoff   18      -405.76036  375.13896   192%   624  520s
 14123  1442     cutoff   21      -405.76036  349.42152   186%   624  526s
 14150  1442 -300.41169   27   14 -405.76036  -53.54167  86.8%   623  530s
 14297  1376 -360.08578   31   14 -405.76036 -354.01342  12.8%   617  535s

Cutting planes:
  Learned: 1
  Implied bound: 7
  Projected implied bound: 2
  MIR: 153
  Mixing: 1
  Flow cover: 412
  Zero half: 3
  RLT: 6
  Relax-and-lift: 21

Explored 14313 nodes (8917249 simplex iterations) in 535.33 seconds (755.35 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -405.76 -464.617 -468.567 ... -654.555
No other solutions better than -405.76

Optimal solution found (tolerance 1.00e-06)
Best objective -4.057603609860e+02, best bound -4.057603609860e+02, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 535.34s
  Master Objective (UB) = -405.76, θ = 130173.38
  Upper Bound (UB) = -405.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 130173.38
  [DEBUG]   ✓ Scenario 0: θ = 130173.38 ≤ Q = 130173.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 130173.38 ≤ Q = 130173.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 130173.38 ≤ Q = 130173.38 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x111a47da
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xeee5b826
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.286643e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6330684.8764
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.328458e+05, 266 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -132845.84    0  128 6330684.88 -132845.84   102%     -    0s
H    0     0                    -96968.23524 -132845.84  37.0%     -    0s
H    0     0                    -111415.6357 -132845.84  19.2%     -    0s
     0     0 -123337.46    0   87 -111415.64 -123337.46  10.7%     -    0s
H    0     0                    -120608.4023 -123291.63  2.22%     -    0s
     0     0 -123145.92    0   89 -120608.40 -123145.92  2.10%     -    0s
H    0     0                    -122150.4271 -123145.92  0.81%     -    0s
H    0     0                    -122439.9255 -122968.93  0.43%     -    0s
     0     0 -122966.12    0   60 -122439.93 -122966.12  0.43%     -    0s
     0     0 -122961.90    0   53 -122439.93 -122961.90  0.43%     -    0s
     0     0 -122960.95    0   52 -122439.93 -122960.95  0.43%     -    0s
     0     0 -122873.43    0   74 -122439.93 -122873.43  0.35%     -    0s
     0     0 -122855.39    0   58 -122439.93 -122855.39  0.34%     -    0s
     0     0 -122854.02    0   57 -122439.93 -122854.02  0.34%     -    0s
     0     0 -122757.92    0   51 -122439.93 -122757.92  0.26%     -    0s
     0     0 -122757.92    0   53 -122439.93 -122757.92  0.26%     -    0s
     0     0 -122757.92    0   52 -122439.93 -122757.92  0.26%     -    0s
     0     0 -122757.92    0   51 -122439.93 -122757.92  0.26%     -    0s
     0     0 -122734.51    0   53 -122439.93 -122734.51  0.24%     -    0s
     0     0 -122734.51    0   52 -122439.93 -122734.51  0.24%     -    0s
     0     0 -122732.08    0   52 -122439.93 -122732.08  0.24%     -    0s
     0     0 -122537.06    0   14 -122439.93 -122537.06  0.08%     -    0s
     0     0 -122520.37    0   12 -122439.93 -122520.37  0.07%     -    0s
H    0     0                    -122442.1846 -122520.37  0.06%     -    0s
     0     0 -122458.34    0    4 -122442.18 -122458.34  0.01%     -    0s
     0     0 -122457.72    0    2 -122442.18 -122457.72  0.01%     -    0s
H    0     0                    -122447.7274 -122450.71  0.00%     -    0s
*    0     0               0    -122450.7100 -122450.71  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 5
  Flow cover: 4
  Relax-and-lift: 2

Explored 1 nodes (791 simplex iterations) in 0.15 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -122451 -122448 -122442 ... 1.28664e+13
No other solutions better than -122451

Optimal solution found (tolerance 1.00e-06)
Best objective -1.224507100146e+05, best bound -1.224507100146e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 104972.71
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122450.71
  [DEBUG]   S×d_nominal = 227423.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 227423.42 + -122450.71 = 104972.71
  [DEBUG]   Current θ from Master = 130173.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 25200.67 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25606.43
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 5624.0808, Absolute Gap = 5624.0808, Relative Gap = 13.860597
  Not converged yet (gap = 5624.08 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178431 nonzeros
Model fingerprint: 0x8745c32b
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -25606.4 (0.04s)
Loaded MIP start from previous solve with objective -25606.4

Presolve removed 28764 rows and 11684 columns
Presolve time: 1.03s
Presolved: 33779 rows, 15536 columns, 208779 nonzeros
Variable types: 13277 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33779 rows, 15536 columns, 208779 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40263   -1.9131977e+04   0.000000e+00   3.365173e+06      5s
   49987    5.7804091e+03   0.000000e+00   1.069313e+06     10s
   57877    9.0369149e+03   0.000000e+00   1.632653e+05     15s
Concurrent spin time: 0.02s

Solved with dual simplex

Root relaxation: objective 1.549236e+04, 26277 iterations, 15.82 seconds (17.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15492.3552    0  286 -25606.434 15492.3552   161%     -   17s
H    0     0                    -20899.76350 15492.3552   174%     -   17s
H    0     0                    -9532.032507 15492.3552   263%     -   17s
H    0     0                    -8590.978437 15492.3552   280%     -   17s
H    0     0                    -4864.459610 15492.3552   418%     -   17s
H    0     0                    -4029.597405 15492.3552   484%     -   18s
H    0     0                    -4028.534326 15492.3552   485%     -   19s
H    0     0                    -4019.229425 15492.3552   485%     -   19s
     0     0 10716.3847    0  268 -4019.2294 10716.3847   367%     -   26s
H    0     0                    -3313.006555 10716.3847   423%     -   26s
     0     0 10694.4270    0  223 -3313.0066 10694.4270   423%     -   29s
     0     0 10694.4270    0  229 -3313.0066 10694.4270   423%     -   29s
     0     0 10694.4270    0  273 -3313.0066 10694.4270   423%     -   30s
     0     0 9195.12191    0  276 -3313.0066 9195.12191   378%     -   31s
     0     0 9195.09649    0  284 -3313.0066 9195.09649   378%     -   31s
     0     0 9195.09649    0  288 -3313.0066 9195.09649   378%     -   31s
     0     0 9034.97709    0  351 -3313.0066 9034.97709   373%     -   36s
H    0     0                    -2982.295247 9034.49114   403%     -   36s
H    0     0                    -2476.800722 9034.49114   465%     -   36s
H    0     0                    -2303.346315 9034.49114   492%     -   37s
H    0     0                    -2295.308252 9034.49114   494%     -   37s
H    0     0                    -2277.288933 9034.49114   497%     -   37s
H    0     0                    -2255.594125 9034.49114   501%     -   37s
H    0     0                    -2238.397169 9034.49114   504%     -   37s
     0     0 8691.32338    0  266 -2238.3972 8691.32338   488%     -   39s
     0     0 8514.08326    0  374 -2238.3972 8514.08326   480%     -   42s
     0     0 8447.47083    0  382 -2238.3972 8447.47083   477%     -   43s
     0     0 8362.62099    0  363 -2238.3972 8362.62099   474%     -   44s
     0     0 8308.85199    0  363 -2238.3972 8308.85199   471%     -   46s
     0     0 8306.46626    0  363 -2238.3972 8306.46626   471%     -   46s
     0     0 8306.41611    0  366 -2238.3972 8306.41611   471%     -   46s
     0     0 7424.42205    0  418 -2238.3972 7424.42205   432%     -   53s
     0     0 6775.47469    0  431 -2238.3972 6775.47469   403%     -   57s
     0     0 6640.80986    0  375 -2238.3972 6640.80986   397%     -   60s
     0     0 6560.85507    0  375 -2238.3972 6560.85507   393%     -   61s
     0     0 6500.56931    0  370 -2238.3972 6500.56931   390%     -   62s
     0     0 6463.08707    0  429 -2238.3972 6463.08707   389%     -   63s
     0     0 6456.61340    0  374 -2238.3972 6456.61340   388%     -   64s
     0     0 6454.43785    0  440 -2238.3972 6454.43785   388%     -   65s
     0     0 6450.71134    0  434 -2238.3972 6450.71134   388%     -   65s
     0     0 6449.49714    0  444 -2238.3972 6449.49714   388%     -   65s
     0     0 6447.92968    0  503 -2238.3972 6447.92968   388%     -   66s
     0     0 6446.59721    0  445 -2238.3972 6446.59721   388%     -   66s
     0     0 6446.34673    0  448 -2238.3972 6446.34673   388%     -   66s
     0     0 6006.72143    0  425 -2238.3972 6006.72143   368%     -   76s
     0     0 5839.97775    0  442 -2238.3972 5839.97775   361%     -   79s
     0     0 5757.60394    0  379 -2238.3972 5757.60394   357%     -   81s
     0     0 5721.89238    0  389 -2238.3972 5721.89238   356%     -   82s
     0     0 5704.66889    0  388 -2238.3972 5704.66889   355%     -   82s
H    0     0                    -2230.460203 5697.24960   355%     -   83s
H    0     0                    -2216.337598 5697.24960   357%     -   83s
H    0     0                    -2156.909579 5697.24960   364%     -   83s
H    0     0                    -2146.943326 5697.24960   365%     -   83s
H    0     0                    -2137.182088 5697.24960   367%     -   83s
     0     0 5697.24960    0  387 -2137.1821 5697.24960   367%     -   83s
     0     0 5694.08897    0  391 -2137.1821 5694.08897   366%     -   83s
     0     0 5692.27205    0  390 -2137.1821 5692.27205   366%     -   83s
     0     0 5691.37020    0  466 -2137.1821 5691.37020   366%     -   84s
     0     0 5618.11019    0  511 -2137.1821 5618.11019   363%     -   86s
     0     0 5545.88273    0  436 -2137.1821 5545.88273   359%     -   87s
     0     0 5531.06771    0  435 -2137.1821 5531.06771   359%     -   88s
     0     0 5516.65820    0  443 -2137.1821 5516.65820   358%     -   88s
     0     0 5512.48605    0  443 -2137.1821 5512.48605   358%     -   89s
     0     0 5510.41996    0  446 -2137.1821 5510.41996   358%     -   89s
     0     0 5509.28653    0  446 -2137.1821 5509.28653   358%     -   89s
     0     0 5452.53076    0  395 -2137.1821 5452.53076   355%     -   91s
     0     0 5430.86824    0  459 -2137.1821 5430.86824   354%     -   93s
     0     0 5420.72697    0  464 -2137.1821 5420.72697   354%     -   93s
     0     0 5419.44767    0  469 -2137.1821 5419.44767   354%     -   94s
     0     0 5418.52388    0  470 -2137.1821 5418.52388   354%     -   94s
     0     0 5409.24132    0  468 -2137.1821 5409.24132   353%     -   95s
     0     0 5406.76448    0  466 -2137.1821 5406.76448   353%     -   96s
     0     0 5404.90000    0  398 -2137.1821 5404.90000   353%     -   96s
     0     0 5404.56627    0  392 -2137.1821 5404.56627   353%     -   96s
     0     0 5363.86607    0  397 -2137.1821 5363.86607   351%     -   98s
     0     0 5353.72747    0  402 -2137.1821 5353.72747   351%     -   99s
     0     0 5293.10867    0  394 -2137.1821 5293.10867   348%     -  100s
     0     0 5292.33031    0  401 -2137.1821 5292.33031   348%     -  100s
     0     0 5282.59560    0  394 -2137.1821 5282.59560   347%     -  101s
     0     0 5277.07956    0  378 -2137.1821 5277.07956   347%     -  102s
     0     0 5276.25431    0  514 -2137.1821 5276.25431   347%     -  103s
     0     0 5271.12045    0  402 -2137.1821 5271.12045   347%     -  104s
H    0     0                    -2057.863458 5270.64926   356%     -  104s
H    0     0                    -2041.413815 5270.64926   358%     -  104s
H    0     0                    -2018.336398 5270.64926   361%     -  104s
H    0     0                    -1988.769825 5270.64926   365%     -  104s
     0     0 5268.08646    0  403 -1988.7698 5268.08646   365%     -  105s
     0     0 5268.08646    0  403 -1988.7698 5268.08646   365%     -  105s
     0     0 5266.91108    0  403 -1988.7698 5266.91108   365%     -  105s
     0     0 5260.86388    0  472 -1988.7698 5260.86388   365%     -  106s
     0     0 5257.08491    0  469 -1988.7698 5257.08491   364%     -  107s
     0     0 5256.02898    0  477 -1988.7698 5256.02898   364%     -  107s
     0     0 5254.64364    0  479 -1988.7698 5254.64364   364%     -  108s
     0     0 5254.59610    0  479 -1988.7698 5254.59610   364%     -  109s
H    0     0                    -1955.029044 5254.26735   369%     -  127s
H    0     0                    -1910.869164 5254.26735   375%     -  128s
H    0     0                    -1847.175185 5254.26735   384%     -  128s
     0     2 5254.26735    0  479 -1847.1752 5254.26735   384%     -  129s
     1     4 5082.79379    1  495 -1847.1752 5254.26735   384%  2625  131s
     7    16 4274.23225    3  572 -1847.1752 4995.26991   370%  2379  137s
    15    32 4116.81597    4  562 -1847.1752 4806.18473   360%  2416  141s
    31    64 3856.25318    5  561 -1847.1752 4423.20822   339%  3941  146s
H   32    64                    -1808.841681 4423.20822   345%  3817  146s
    95   170 2928.00118    7  501 -1808.8417 4393.54592   343%  2740  154s
   173   239 2916.63159    8  547 -1808.8417 4393.54592   343%  2052  159s
   260   269 2726.52199    9  541 -1808.8417 4393.54592   343%  1798  166s
   294   303 2160.52579    9  538 -1808.8417 4147.40917   329%  1894  173s
H  295   303                    -1789.619678 4147.40917   332%  1888  173s
   336   333 2530.11123   10  426 -1789.6197 4147.40917   332%  1962  177s
   370   360  937.31815   10  389 -1789.6197 4090.74090   329%  1931  181s
H  398   360                    -1776.573718 4090.74090   330%  1936  181s
   417   391 1943.23256   11  490 -1776.5737 4090.74090   330%  1898  186s
   475   429  657.12652   11  483 -1776.5737 3946.14857   322%  1979  192s
   527   469 1854.39454   12  426 -1776.5737 3895.86247   319%  1927  200s
   582   492     cutoff   13      -1776.5737 3891.42111   319%  1932  205s
   615   519  605.04759   14  419 -1776.5737 3891.42111   319%  2032  212s
   666   552  534.07558   15  489 -1776.5737 3891.42111   319%  2019  216s
   717   580 -1170.5894   16  471 -1776.5737 3891.42111   319%  2010  221s
   786   641 -410.99071   17  414 -1776.5737 3855.90491   317%  1939  226s
   858   694 -1327.9584   18  401 -1776.5737 3855.90491   317%  1875  231s
H  919   694                    -1769.820380 3855.90491   318%  1809  231s
   947   734 -1453.6247   19  352 -1769.8204 3855.90491   318%  1773  236s
  1055   776 2709.96147    7  326 -1769.8204 3855.90491   318%  1674  241s
H 1098   776                    -1758.921642 3855.90491   319%  1654  241s
H 1100   776                    -1704.430706 3855.90491   326%  1653  241s
  1153   807 2469.23061    8  306 -1704.4307 3855.90491   326%  1615  245s
  1221   845 1903.69133    9  300 -1704.4307 3855.90491   326%  1580  252s
  1309   911 1499.81060   10  345 -1704.4307 3855.90491   326%  1543  260s
  1414   963 1198.13637   12  336 -1704.4307 3855.90491   326%  1496  269s
  1529  1021  971.85286   15  279 -1704.4307 3637.75699   313%  1455  274s
  1670  1094  239.70359   22  236 -1704.4307 3637.75699   313%  1395  280s
  1830  1145 -269.85649   30  273 -1704.4307 3528.23582   307%  1338  285s
  2001  1179 -1579.2749   39   45 -1704.4307 3384.01616   299%  1285  290s
  2162  1203 1215.77056   11  267 -1704.4307 3370.07543   298%  1247  296s
  2283  1206 -1003.2079   14  188 -1704.4307 3370.07543   298%  1241  301s
  2395  1250     cutoff   16      -1704.4307 3240.96819   290%  1223  308s
  2516  1295 2269.03577    9  420 -1704.4307 3223.11424   289%  1220  316s
  2638  1357 infeasible   11      -1704.4307 3223.11424   289%  1225  322s
  2803  1417 infeasible   11      -1704.4307 3197.98650   288%  1205  330s
  2951  1448  513.57656   10  306 -1704.4307 3114.03112   283%  1197  336s
  3119  1490 -1250.7073   13  280 -1704.4307 3114.03112   283%  1183  344s
  3253  1545 -1550.1328   15  188 -1704.4307 3114.03112   283%  1177  352s
  3504  1574  533.38095   10  297 -1704.4307 2964.00957   274%  1146  360s
  3609  1623  207.30187   11  298 -1704.4307 2879.63368   269%  1151  367s
  3831  1667  904.59879   12  229 -1704.4307 2871.84446   268%  1130  374s
  4007  1702  -87.11321   14  245 -1704.4307 2871.84446   268%  1127  383s
  4160  1726     cutoff   16      -1704.4307 2871.84446   268%  1132  391s
  4335  1762     cutoff   25      -1704.4307 2646.98742   255%  1139  401s
  4523  1768 -606.12742   10  172 -1704.4307 2637.14257   255%  1140  410s
  4707  1787  931.83601   10  200 -1704.4307 2637.14257   255%  1148  421s
  4844  1790     cutoff   17      -1704.4307 2580.20739   251%  1154  433s
  5073  1784     cutoff   11      -1704.4307 2580.20739   251%  1154  443s
  5240  1793     cutoff   12      -1704.4307 2562.53682   250%  1169  456s
  5471  1799 -1229.2474   13  353 -1704.4307 2562.53682   250%  1170  466s
  5687  1802 infeasible   10      -1704.4307 2185.76549   228%  1178  475s
  5752  1826 -1497.6523   10  224 -1704.4307 2185.76549   228%  1178  487s
  5848  1824 infeasible   11      -1704.4307 2177.90026   228%  1178  497s
  5999  1824  -95.93751    9  245 -1704.4307 2144.40135   226%  1181  509s
  6171  1846 -900.71074   10  271 -1704.4307 2144.40135   226%  1184  521s
  6407  1855 -1398.6766   12  354 -1704.4307 1948.16286   214%  1186  534s
  6730  1878     cutoff   18      -1704.4307 1835.28005   208%  1177  549s
  7039  1935   53.61702   10  373 -1704.4307 1679.05931   199%  1176  562s
  7400  1945 infeasible   16      -1704.4307 1654.10247   197%  1165  576s
  7750  2009 -588.82625   20  278 -1704.4307 1548.23228   191%  1164  592s
  8061  2056 -1557.1823   22  399 -1704.4307 1421.53230   183%  1150  606s
  8579  2134 -137.82849   17  285 -1704.4307 1382.15220   181%  1132  619s
  9210  2150 -721.99693   14  355 -1704.4307 1194.80498   170%  1103  639s
  9493  2157     cutoff   20      -1704.4307 1044.99525   161%  1097  654s
 10054  2166 -657.78500   14  287 -1704.4307  971.19061   157%  1085  670s
 10697  2198     cutoff   16      -1704.4307  773.24231   145%  1068  686s
 11405  2198     cutoff   21      -1704.4307  654.86554   138%  1049  707s
 12194  2086 -1015.8774   15  318 -1704.4307  526.99310   131%  1028  727s
 12945  1995 -912.66744   21  264 -1704.4307  334.66741   120%  1013  746s
 13631  1760     cutoff   17      -1704.4307  145.48609   109%  1003  765s
 14454  1580 -1395.4443   15  112 -1704.4307  -90.19884  94.7%   988  781s
 15232  1265     cutoff   15      -1704.4307 -306.62948  82.0%   973  799s
 16367  1094 -1275.7840   34  221 -1704.4307 -638.13627  62.6%   944  817s
 18494  1166 -1465.5420   28  231 -1704.4307 -895.63604  47.5%   872  835s
 19490  1167 -1469.1074   31  479 -1704.4307 -991.39968  41.8%   839  891s
 19492  1168 -1286.3921   38  286 -1704.4307 -991.39968  41.8%   838  905s
 19493  1169 -1361.5953   32  370 -1704.4307 -991.39968  41.8%   838  916s
 19494  1170 -1436.9090   40  366 -1704.4307 -991.39968  41.8%   838  921s
 19495  1170 -1446.8542   30  500 -1704.4307 -991.39968  41.8%   838  926s
 19496  1171 -1154.6050   20  441 -1704.4307 -991.39968  41.8%   838  930s
 19498  1172 -1384.8603   34  514 -1704.4307 -991.39968  41.8%   838  936s
 19501  1174 -1358.4645   38  519 -1704.4307 -991.39968  41.8%   838  942s
 19503  1176 -1292.4212   31  414 -1704.4307 -991.39968  41.8%   838  950s
 19505  1177 -1281.3895   33  535 -1704.4307 -991.39968  41.8%   838  959s
 19506  1178 -1438.4861   32  533 -1704.4307 -991.39968  41.8%   838  962s
 19507  1178 -1372.7317   30  585 -1704.4307 -991.39968  41.8%   838  969s
 19508  1179 -1257.5141   29  589 -1704.4307 -991.39968  41.8%   838  972s
 19509  1180 -1243.9291   35  536 -1704.4307 -991.39968  41.8%   838  978s
 19510  1180 -1121.9829   28  583 -1704.4307 -991.39968  41.8%   838  981s
 19511  1181 -1252.5649   25  543 -1704.4307 -991.39968  41.8%   838  987s
 19512  1182 -1433.5164   25  543 -1704.4307 -991.39968  41.8%   838 1003s
 19513  1182 -1164.7702   23  543 -1704.4307 -991.39968  41.8%   838 1016s
 19514  1186 -991.39968   10  573 -1704.4307 -991.39968  41.8%   842 1029s
 19516  1189 -991.39968   11  577 -1704.4307 -991.39968  41.8%   842 1037s
 19520  1196 -991.39968   12  582 -1704.4307 -991.39968  41.8%   842 1044s
 19528  1209 -991.39968   13  582 -1704.4307 -991.39968  41.8%   843 1050s
 19544  1234 -991.39968   14  583 -1704.4307 -991.39968  41.8%   844 1059s
 19576  1249 -991.39968   15  571 -1704.4307 -991.39968  41.8%   848 1065s
 19608  1265 -991.39968   16  584 -1704.4307 -991.39968  41.8%   851 1072s
 19644  1290 -991.39968   17  496 -1704.4307 -991.39968  41.8%   855 1079s
 19685  1316 -991.39968   17  518 -1704.4307 -991.39968  41.8%   859 1087s
 19733  1328 -991.39968   18  499 -1704.4307 -991.39968  41.8%   864 1094s
 19794  1331 -991.39968   18  421 -1704.4307 -991.39968  41.8%   868 1103s
 19866  1324 -991.39968   19  493 -1704.4307 -991.39968  41.8%   870 1110s
 19934  1318 -991.39968   19  511 -1704.4307 -991.39968  41.8%   872 1115s
 19977  1321 -991.39968   20  456 -1704.4307 -991.39968  41.8%   874 1120s
 20026  1321 -991.39968   20  291 -1704.4307 -991.39968  41.8%   876 1125s
 20078  1310 -991.39968   21  210 -1704.4307 -991.39968  41.8%   879 1131s
 20138  1306     cutoff   21      -1704.4307 -991.39968  41.8%   880 1138s
 20218  1309 -991.39968   22  203 -1704.4307 -991.39968  41.8%   881 1145s
 20295  1271 -1485.5534   23  258 -1704.4307 -991.39968  41.8%   883 1154s
 20385  1249     cutoff   23      -1704.4307 -991.39968  41.8%   884 1160s
 20464  1243     cutoff   19      -1704.4307 -991.39968  41.8%   886 1166s
 20538  1234 -991.39968   18  325 -1704.4307 -991.39968  41.8%   888 1174s
 20636  1222 -991.39968   19  328 -1704.4307 -991.39968  41.8%   890 1180s
 20717  1209 -991.39968   20  378 -1704.4307 -991.39968  41.8%   892 1186s
 20760  1206 -991.39968   21  376 -1704.4307 -991.39968  41.8%   893 1194s
 20815  1210 -991.39968   22  281 -1704.4307 -991.39968  41.8%   895 1200s
 20887  1184 -991.39968   24  215 -1704.4307 -991.39968  41.8%   895 1205s
 20942  1171 -991.39968   25  210 -1704.4307 -991.39968  41.8%   896 1214s
 21027  1156     cutoff   26      -1704.4307 -991.39968  41.8%   898 1223s
 21131  1120 -1060.7886   27  288 -1704.4307 -991.39968  41.8%   899 1231s
 21238  1089 -1307.4297   29  290 -1704.4307 -991.39968  41.8%   903 1240s
 21349  1050 -991.39968   21  171 -1704.4307 -991.39968  41.8%   906 1247s
 21472   994 -991.39968   21  227 -1704.4307 -991.39968  41.8%   909 1256s
 21600   924     cutoff   23      -1704.4307 -991.39968  41.8%   912 1265s
 21746   857     cutoff   20      -1704.4307 -991.39968  41.8%   916 1274s
 21874   795     cutoff   22      -1704.4307 -991.39968  41.8%   920 1283s
 22030   702 -991.39968   26  234 -1704.4307 -991.39968  41.8%   923 1292s
 22191   571     cutoff   29      -1704.4307 -991.39968  41.8%   926 1302s
 22398   399     cutoff   19      -1704.4307 -991.39968  41.8%   928 1309s
 22583   237 -1608.0647   36   20 -1704.4307 -991.39968  41.8%   928 1321s
 22846   131 -1582.2156   34   22 -1704.4307 -991.39968  41.8%   923 1327s
 23491    96 -1581.6897   39   29 -1704.4307 -1435.3295  15.8%   901 1330s
*23585    96              67    -1704.333114 -1435.3295  15.8%   897 1330s
*23600    96              67    -1703.186849 -1435.3295  15.7%   897 1330s
*23629    96              66    -1692.573618 -1435.3295  15.2%   896 1330s
*24208    15              62    -1690.360616 -1574.5349  6.85%   875 1331s

Cutting planes:
  MIR: 248
  Mixing: 1
  Flow cover: 745
  Inf proof: 1
  Zero half: 3
  RLT: 13
  Relax-and-lift: 48

Explored 24402 nodes (21300184 simplex iterations) in 1332.34 seconds (2367.51 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -1690.36 -1692.57 -1703.19 ... -1808.84
No other solutions better than -1690.36

Optimal solution found (tolerance 1.00e-06)
Best objective -1.690360615548e+03, best bound -1.690360615548e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1332.36s
  Master Objective (UB) = -1690.36, θ = 129948.23
  Upper Bound (UB) = -1690.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 129948.23
  [DEBUG]   ✓ Scenario 0: θ = 129948.23 ≤ Q = 129948.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 129948.23 ≤ Q = 129948.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 129948.23 ≤ Q = 129948.23 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 129948.23 ≤ Q = 129948.23 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4c1bbfc4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb3e4403c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.285370e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6383966.3252
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.308316e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -130831.59    0  129 6383966.33 -130831.59   102%     -    0s
H    0     0                    -95889.86045 -130831.59  36.4%     -    0s
H    0     0                    -96121.90580 -130831.59  36.1%     -    0s
H    0     0                    -105062.7660 -130831.59  24.5%     -    0s
H    0     0                    -105289.7174 -115136.00  9.35%     -    0s
H    0     0                    -110406.6079 -115136.00  4.28%     -    0s
H    0     0                    -113250.7804 -115136.00  1.66%     -    0s
     0     0 -115136.00    0   94 -113250.78 -115136.00  1.66%     -    0s
     0     0 -114833.44    0   89 -113250.78 -114833.44  1.40%     -    0s
     0     0 -114391.61    0   77 -113250.78 -114391.61  1.01%     -    0s
H    0     0                    -113813.3411 -114353.11  0.47%     -    0s
H    0     0                    -113867.4414 -114353.11  0.43%     -    0s
     0     0 -114353.11    0   77 -113867.44 -114353.11  0.43%     -    0s
     0     0 -114026.34    0   36 -113867.44 -114026.34  0.14%     -    0s
     0     0 -113957.71    0   23 -113867.44 -113957.71  0.08%     -    0s
     0     0 -113928.25    0   11 -113867.44 -113928.25  0.05%     -    0s
     0     0 -113908.95    0   10 -113867.44 -113908.95  0.04%     -    0s
     0     0 -113901.40    0    9 -113867.44 -113901.40  0.03%     -    0s
     0     0 -113889.12    0    7 -113867.44 -113889.12  0.02%     -    0s
     0     0 -113874.60    0    7 -113867.44 -113874.60  0.01%     -    0s
*    0     0               0    -113871.7013 -113871.70  0.00%     -    0s

Explored 1 nodes (652 simplex iterations) in 0.19 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -113872 -113872 -113867 ... -105063
No other solutions better than -113872

Optimal solution found (tolerance 1.00e-06)
Best objective -1.138717012554e+05, best bound -1.138717012554e+05, gap 0.0000%
  Subproblem solved in 0.22s
  Worst-case operational profit (Z_SP) = 112515.28
  Scenario: 41 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113871.70
  [DEBUG]   S×d_nominal = 226386.98
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 226386.98 + -113871.70 = 112515.28
  [DEBUG]   Current θ from Master = 129948.23
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17432.95 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19123.31
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 4339.4806, Absolute Gap = 4339.4806, Relative Gap = 2.567192
  Not converged yet (gap = 4339.48 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 19 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221659 nonzeros
Model fingerprint: 0xb6d883d9
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35935 rows and 14595 columns
Presolve time: 1.31s
Presolved: 41898 rows, 18865 columns, 259654 nonzeros
Variable types: 16606 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -209054.8442

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41898 rows, 18865 columns, 259654 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24227   -3.4742709e+04   0.000000e+00   2.137649e+08      5s
   35594    2.6651823e+02   0.000000e+00   3.196924e+06     10s
   44240    6.1928744e+03   0.000000e+00   1.937087e+09     15s
   52406    9.6752540e+03   0.000000e+00   1.258957e+07     20s
   60313    1.0822404e+04   0.000000e+00   3.597325e+05     25s
Concurrent spin time: 0.35s

Solved with dual simplex

Root relaxation: objective 1.520539e+04, 35196 iterations, 25.06 seconds (28.64 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15205.3942    0  288 -209054.84 15205.3942   107%     -   27s
H    0     0                    -200071.2020 15205.3942   108%     -   27s
H    0     0                    -20580.95351 15205.3942   174%     -   27s
H    0     0                    -7957.837405 15205.3942   291%     -   27s
H    0     0                    -6798.946398 15205.3942   324%     -   27s
H    0     0                    -6534.404145 15205.3942   333%     -   27s
H    0     0                    -6496.305096 15205.3942   334%     -   27s
H    0     0                    -6492.315163 11401.9289   276%     -   38s
H    0     0                    -6439.872025 11401.9289   277%     -   38s
     0     0 10784.7362    0  215 -6439.8720 10784.7362   267%     -   38s
     0     0 10638.4989    0  278 -6439.8720 10638.4989   265%     -   43s
     0     0 10638.4989    0  276 -6439.8720 10638.4989   265%     -   44s
     0     0 10638.4989    0  277 -6439.8720 10638.4989   265%     -   45s
     0     0 10638.4989    0  283 -6439.8720 10638.4989   265%     -   45s
     0     0 10638.4989    0  271 -6439.8720 10638.4989   265%     -   45s
     0     0 10638.4989    0  272 -6439.8720 10638.4989   265%     -   45s
     0     0 8812.45517    0  350 -6439.8720 8812.45517   237%     -   56s
H    0     0                    -4679.596961 8812.45517   288%     -   57s
     0     0 8208.62615    0  427 -4679.5970 8208.62615   275%     -   64s
     0     0 8167.36482    0  380 -4679.5970 8167.36482   275%     -   65s
     0     0 8108.58113    0  384 -4679.5970 8108.58113   273%     -   67s
H    0     0                    -4645.096827 8051.42806   273%     -   70s
H    0     0                    -4622.997707 8051.42806   274%     -   70s
H    0     0                    -4456.555451 8051.42806   281%     -   70s
H    0     0                    -4236.613288 8051.42806   290%     -   70s
     0     0 8051.42806    0  373 -4236.6133 8051.42806   290%     -   70s
     0     0 8045.42326    0  373 -4236.6133 8045.42326   290%     -   71s
     0     0 8043.39293    0  380 -4236.6133 8043.39293   290%     -   72s
     0     0 8043.18540    0  378 -4236.6133 8043.18540   290%     -   72s
     0     0 6771.02330    0  395 -4236.6133 6771.02330   260%     -   84s
H    0     0                    -4183.822096 6770.94971   262%     -   84s
H    0     0                    -3893.382847 6770.94971   274%     -   85s
H    0     0                    -3803.173267 6770.94971   278%     -   85s
H    0     0                    -3781.094553 6770.94971   279%     -   85s
H    0     0                    -3762.509174 6770.94971   280%     -   85s
H    0     0                    -3670.903863 6770.94971   284%     -   85s
     0     0 6294.45876    0  465 -3670.9039 6294.45876   271%     -   90s
     0     0 6044.27887    0  405 -3670.9039 6044.27887   265%     -   94s
     0     0 6014.09922    0  462 -3670.9039 6014.09922   264%     -   96s
     0     0 5992.65854    0  414 -3670.9039 5992.65854   263%     -   97s
     0     0 5976.70483    0  413 -3670.9039 5976.70483   263%     -   98s
     0     0 5964.54498    0  417 -3670.9039 5964.54498   262%     -   98s
     0     0 5945.16687    0  415 -3670.9039 5945.16687   262%     -   99s
H    0     0                    -3519.211037 5922.69256   268%     -  100s
     0     0 5922.69256    0  418 -3519.2110 5922.69256   268%     -  100s
     0     0 5921.11787    0  417 -3519.2110 5921.11787   268%     -  101s
     0     0 5920.26137    0  419 -3519.2110 5920.26137   268%     -  101s
     0     0 5486.62407    0  391 -3519.2110 5486.62407   256%     -  111s
     0     0 5355.07170    0  456 -3519.2110 5355.07170   252%     -  115s
     0     0 5212.14193    0  452 -3519.2110 5212.14193   248%     -  119s
     0     0 5197.46660    0  497 -3519.2110 5197.46660   248%     -  121s
     0     0 5186.91194    0  499 -3519.2110 5186.91194   247%     -  121s
     0     0 5184.61454    0  497 -3519.2110 5184.61454   247%     -  122s
     0     0 5183.94153    0  502 -3519.2110 5183.94153   247%     -  123s
     0     0 5106.04604    0  469 -3519.2110 5106.04604   245%     -  127s
     0     0 5070.10295    0  475 -3519.2110 5070.10295   244%     -  129s
     0     0 5053.04589    0  469 -3519.2110 5053.04589   244%     -  131s
     0     0 5050.92103    0  467 -3519.2110 5050.92103   244%     -  132s
     0     0 5050.62574    0  468 -3519.2110 5050.62574   244%     -  132s
     0     0 5023.49512    0  409 -3519.2110 5023.49512   243%     -  134s
     0     0 5018.90663    0  410 -3519.2110 5018.90663   243%     -  135s
     0     0 5015.46893    0  404 -3519.2110 5015.46893   243%     -  136s
     0     0 5014.91552    0  414 -3519.2110 5014.91552   243%     -  136s
     0     0 4992.69738    0  523 -3519.2110 4992.69738   242%     -  138s
     0     0 4984.53805    0  585 -3519.2110 4984.53805   242%     -  140s
     0     0 4980.04635    0  400 -3519.2110 4980.04635   242%     -  141s
     0     0 4977.48712    0  586 -3519.2110 4977.48712   241%     -  141s
     0     0 4976.88060    0  402 -3519.2110 4976.88060   241%     -  141s
     0     0 4938.79029    0  580 -3519.2110 4938.79029   240%     -  144s
     0     0 4888.95645    0  406 -3519.2110 4888.95645   239%     -  146s
     0     0 4881.51554    0  407 -3519.2110 4881.51554   239%     -  146s
     0     0 4880.15328    0  405 -3519.2110 4880.15328   239%     -  147s
     0     0 4879.84476    0  408 -3519.2110 4879.84476   239%     -  147s
     0     0 4874.82782    0  400 -3519.2110 4874.82782   239%     -  148s
     0     0 4874.17225    0  410 -3519.2110 4874.17225   239%     -  148s
     0     0 4870.19640    0  416 -3519.2110 4870.19640   238%     -  149s
     0     0 4866.85658    0  411 -3519.2110 4866.85658   238%     -  150s
     0     0 4865.92537    0  412 -3519.2110 4865.92537   238%     -  150s
     0     0 4862.09288    0  411 -3519.2110 4862.09288   238%     -  151s
     0     0 4860.40135    0  407 -3519.2110 4860.40135   238%     -  152s
     0     0 4859.09493    0  410 -3519.2110 4859.09493   238%     -  153s
     0     0 4858.40497    0  409 -3519.2110 4858.40497   238%     -  153s
     0     0 4853.71226    0  418 -3519.2110 4853.71226   238%     -  154s
     0     0 4853.24695    0  418 -3519.2110 4853.24695   238%     -  155s
H    0     0                    -3505.782689 4853.24695   238%     -  179s
H    0     0                    -3478.546944 4853.24695   240%     -  179s
H    0     0                    -3435.665899 4853.24695   241%     -  182s
H    0     0                    -3414.273965 4853.24695   242%     -  182s
     0     2 4853.24695    0  418 -3414.2740 4853.24695   242%     -  189s
     1     4 4666.95861    1  397 -3414.2740 4853.24695   242%  2731  192s
     3     8 4646.28516    2  572 -3414.2740 4778.07189   240%  2464  199s
     7    16 4562.16282    3  568 -3414.2740 4645.94989   236%  3428  204s
    15    32 4341.72940    4  576 -3414.2740 4560.25306   234%  3855  213s
    31    50 1451.29578    5  245 -3414.2740 4352.48235   227%  5546  231s
H   49    82                    -3392.375866 4352.12634   228%  5313  240s
H   62    82                    -3338.737534 4352.12634   230%  4781  240s
    81   203 2572.55108    7  249 -3338.7375 4352.12634   230%  3981  251s
   202   274 1159.32483    9  249 -3338.7375 4352.12634   230%  2177  257s
   285   322 2222.64856    9  241 -3338.7375 4352.12634   230%  1710  266s
   374   357  886.37651   10  248 -3338.7375 4352.12634   230%  1485  276s
   452   388 -1456.5217    9  119 -3338.7375 4196.81740   226%  1448  284s
   514   422  736.45056   10  139 -3338.7375 4196.81740   226%  1470  293s
   579   452  411.72179    9  144 -3338.7375 4196.81740   226%  1434  302s
   641   479 1614.61762   10  235 -3338.7375 4196.81740   226%  1432  313s
   688   517 1225.95889   10  274 -3338.7375 4196.81740   226%  1490  322s
   740   562 1143.60759   11  233 -3338.7375 4138.59486   224%  1518  328s
   795   608 1163.01437   11  231 -3338.7375 4138.59486   224%  1541  337s
   864   644  573.14632   12  305 -3338.7375 4138.59486   224%  1528  345s
   939   674 -409.69667   12  193 -3338.7375 4138.59486   224%  1509  355s
  1006   700  587.19301   12  222 -3338.7375 4047.77519   221%  1519  363s
  1080   733 -452.64345   12  190 -3338.7375 4047.77519   221%  1537  375s
  1140   783 -3018.3351   11  192 -3338.7375 4047.77519   221%  1560  384s
  1234   843 -2728.0666   11  136 -3338.7375 4047.77519   221%  1546  394s
  1325   889  272.43779   13  292 -3338.7375 3696.76825   211%  1546  402s
  1433   923 -796.04480   13  273 -3338.7375 3669.45305   210%  1548  410s
  1534   934 -1710.8355   14  234 -3338.7375 3669.45305   210%  1544  419s
  1629   973 -1253.4437   13  210 -3338.7375 3669.45305   210%  1540  427s
  1705  1027 -2396.6189   13   49 -3338.7375 3480.00510   204%  1557  435s
  1784  1094 -2702.8754   14   55 -3338.7375 3480.00510   204%  1565  447s
  1897  1139 -1333.4334   14  226 -3338.7375 3480.00510   204%  1555  457s
  2026  1208 -3068.1960   15   40 -3338.7375 3480.00510   204%  1548  468s
  2176  1297     cutoff   16      -3338.7375 3480.00510   204%  1523  482s
  2368  1327 -948.47630   12  151 -3338.7375 3480.00510   204%  1476  491s
  2431  1423 -1729.5164   13  129 -3338.7375 3340.18736   200%  1472  503s
  2631  1487 infeasible   23      -3338.7375 3198.60602   196%  1429  513s
  2808  1571 -550.49379   11   98 -3338.7375 3115.36163   193%  1411  526s
  2965  1653 -2173.4427   14  102 -3338.7375 3006.23777   190%  1409  541s
  3147  1711 infeasible   23      -3338.7375 2877.13111   186%  1405  552s
  3315  1825 -832.97190   12  286 -3338.7375 2875.66916   186%  1409  566s
  3533  1915     cutoff   15      -3338.7375 2875.66916   186%  1391  580s
  3817  1983 1452.35618   12  255 -3338.7375 2762.71772   183%  1360  593s
  4003  2053 -457.38729   16  206 -3338.7375 2762.71772   183%  1362  604s
H 4010  2053                    -3326.781174 2762.71772   183%  1363  604s
H 4119  2049                    -3246.667070 2762.71772   185%  1359  604s
  4167  2106 infeasible   20      -3246.6671 2762.71772   185%  1352  621s
  4381  2174  852.00362   13  189 -3246.6671 2723.92115   184%  1356  637s
  4640  2231 -492.13390   14  182 -3246.6671 2723.92115   184%  1353  655s
  4862  2355 -230.10991   13  290 -3246.6671 2389.77261   174%  1362  669s
H 5168  2424                    -3173.130660 2389.77261   175%  1346  681s
H 5170  2420                    -3139.779319 2389.77261   176%  1346  681s
H 5171  2414                    -3125.992992 2389.77261   176%  1346  681s
H 5211  2402                    -3088.571553 2388.71680   177%  1339  681s
H 5272  2384                    -3051.551933 2388.71680   178%  1335  681s
  5350  2364 -1972.8638   20  418 -3051.5519 2216.82345   173%  1328  718s
H 5351  2246                    -3009.775962 2216.82345   174%  1328  745s
H 5351  2134                    -2968.529113 2216.82345   175%  1328  745s
  5353  2135 -1362.1407   12  319 -2968.5291 2216.82345   175%  1328  763s
  5354  2136 -2257.5403   34  437 -2968.5291 2216.82345   175%  1327  772s
H 5354  2029                    -2910.645381 2216.82345   176%  1327  780s
  5356  2030 -1786.9136   34  441 -2910.6454 2216.82345   176%  1327  790s
  5358  2031 -2714.2649   58  460 -2910.6454 2216.82345   176%  1326  796s
  5359  2032 -1285.3313   18  458 -2910.6454 2216.82345   176%  1326  801s
  5361  2033 -1896.7016   38  468 -2910.6454 2216.82345   176%  1326  805s
  5363  2035  911.09305   13  479 -2910.6454 2216.82345   176%  1325  813s
  5364  2035  526.88829   16  518 -2910.6454 2216.82345   176%  1325  816s
  5365  2036 1607.61984   17  406 -2910.6454 2216.82345   176%  1325  822s
  5367  2037  -98.63679    8  403 -2910.6454 2216.82345   176%  1324  827s
H 5367  1935                    -2910.192786 2216.82345   176%  1324  834s
  5369  1937  534.44223   14  407 -2910.1928 2216.82345   176%  1324  836s
H 5370  1840                    -2909.218975 2216.82345   176%  1323  845s
H 5372  1749                    -2897.648097 2216.82345   177%  1323  856s
  5375  1751  403.29907   10  423 -2897.6481 2216.82345   177%  1322  862s
  5376  1751  976.24015    9  607 -2897.6481 2216.82345   177%  1322  872s
  5378  1753 -2315.7142   20  418 -2897.6481 2216.82345   177%  1321  875s
H 5379  1665                    -2865.863346 2216.82345   177%  1321  883s
  5381  1667 -1252.5414   14  414 -2865.8633 2216.82345   177%  1321  886s
  5382  1667 -2102.9758   25  481 -2865.8633 2216.82345   177%  1320  890s
  5383  1668 -2422.7315   38  481 -2865.8633 2216.82345   177%  1320  920s
H 5383  1584                    -2845.269197 2216.82345   178%  1320  943s
H 5383  1504                    -2826.789387 2216.82345   178%  1320  943s
  5385  1508 2216.82345   13  485 -2826.7894 2216.82345   178%  1346  959s
  5387  1512 2216.82345   14  464 -2826.7894 2216.82345   178%  1348  970s
  5391  1518 2216.82345   15  453 -2826.7894 2216.82345   178%  1349  980s
  5399  1532 2216.82345   16  464 -2826.7894 2216.82345   178%  1352  990s
  5415  1546  524.19573   17  120 -2826.7894 2216.82345   178%  1367 1005s
  5435  1568 1795.04656   18  205 -2826.7894 2216.82345   178%  1388 1014s
  5467  1581  997.41676   19  277 -2826.7894 2216.82345   178%  1392 1027s
H 5480  1501                    -2821.530671 2216.82345   179%  1395 1027s
H 5517  1416                    -2817.696873 2216.82345   179%  1404 1027s
  5537  1418  621.72160   20  306 -2817.6969 2216.82345   179%  1404 1043s
  5619  1404 -156.08931   21  299 -2817.6969 2216.82345   179%  1410 1057s
  5676  1413 -608.53987   20  261 -2817.6969 2216.82345   179%  1426 1069s
  5744  1403 -416.45957   22  306 -2817.6969 2216.82345   179%  1436 1076s
  5796  1408     cutoff   22      -2817.6969 2216.82345   179%  1444 1087s
  5858  1398 -1881.9810   24  449 -2817.6969 2216.82345   179%  1451 1102s
  5907  1390 -1987.0470   25  342 -2817.6969 2216.82345   179%  1457 1114s
  5954  1391 -2083.8392   26  337 -2817.6969 2216.82345   179%  1465 1122s
  5992  1378 -2098.9811   27  335 -2817.6969 2216.82345   179%  1471 1132s
  6053  1375     cutoff   28      -2817.6969 2216.82345   179%  1477 1144s
  6124  1368 -2065.2944   28  310 -2817.6969 2216.82345   179%  1480 1153s
  6191  1350 -2223.1714   29  235 -2817.6969 2216.82345   179%  1487 1164s
  6270  1330     cutoff   31      -2817.6969 2216.82345   179%  1491 1175s
  6345  1318 -125.78317   22  292 -2817.6969 2216.82345   179%  1499 1184s
  6386  1326 -667.85834   23  279 -2817.6969 2216.82345   179%  1502 1191s
  6428  1319 -2159.4169   24  227 -2817.6969 2216.82345   179%  1511 1203s
  6485  1304 -2233.5242   25  229 -2817.6969 2216.82345   179%  1519 1211s
  6570  1282 -2454.4789   26  186 -2817.6969 2216.82345   179%  1521 1222s
  6659  1266     cutoff   27      -2817.6969 2216.82345   179%  1526 1233s
  6750  1255 -950.23796   22  265 -2817.6969 2216.82345   179%  1533 1245s
  6850  1227 -1061.5651   24  257 -2817.6969 2216.82345   179%  1538 1256s
H 6920  1136                    -2797.345128 1122.08947   140%  1540 1256s
  6950  1127 -1073.8427   25  267 -2797.3451 1122.08947   140%  1540 1267s
  7061  1091     cutoff   27      -2797.3451  988.06859   135%  1544 1279s
H 7065  1024                    -2785.538828  988.06859   135%  1544 1279s
  7168  1016 -2335.1541   30  234 -2785.5388  988.06859   135%  1548 1292s
  7324   983     cutoff   25      -2785.5388  253.36749   109%  1544 1304s
  7489   908 -2387.1899   31  225 -2785.5388   49.06363   102%  1536 1319s
  7676   851 -1375.0235   25  360 -2785.5388   49.06363   102%  1530 1331s
  7833   767     cutoff   25      -2785.5388 -196.75554  92.9%  1521 1346s
  8042   631 -2587.8418   26  124 -2785.5388 -319.76935  88.5%  1513 1358s
  8277   504 -2585.9452   25  310 -2785.5388 -319.76935  88.5%  1502 1368s
  8656   427     cutoff   30      -2785.5388 -755.64991  72.9%  1459 1375s
  9158   528 -2775.0360   62   30 -2785.5388 -830.40966  70.2%  1395 1382s
H 9636   528                    -2745.921990 -1193.2003  56.5%  1333 1382s
  9900   869 -2698.5528   69   32 -2745.9220 -1193.2003  56.5%  1299 1386s
 11948  1938     cutoff   59      -2745.9220 -2481.2432  9.64%  1086 1392s
 13292  2351 -2631.7369   55   36 -2745.9220 -2532.7857  7.76%   981 1396s
 16779  3346 -2741.4033   54   24 -2745.9220 -2574.6533  6.24%   787 1402s
 18649  3585     cutoff   60      -2745.9220 -2590.3414  5.67%   713 1407s
 20211  3763 -2727.0177   48   26 -2745.9220 -2600.3470  5.30%   662 1411s
 22702  4076 -2700.9859   50   19 -2745.9220 -2605.7689  5.10%   595 1417s
 23956  4242 -2701.9537   51   18 -2745.9220 -2610.0497  4.95%   566 1421s
 25161  4246 -2706.0919   52   24 -2745.9220 -2615.3096  4.76%   541 1425s
H25283  3652                    -2717.188597 -2619.1692  3.61%   539 1428s
 25697  3362     cutoff   53      -2717.1886 -2619.1692  3.61%   531 1431s
 30021  2137 -2680.5140   61   20 -2717.1886 -2655.1078  2.28%   461 1437s
 32191   921     cutoff   57      -2717.1886 -2669.9257  1.74%   432 1440s

Cutting planes:
  MIR: 372
  Mixing: 2
  Flow cover: 1043
  Zero half: 3
  RLT: 12
  Relax-and-lift: 62

Explored 35644 nodes (14140972 simplex iterations) in 1442.16 seconds (2268.97 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -2717.19 -2717.19 -2745.92 ... -2865.86
No other solutions better than -2717.19

Optimal solution found (tolerance 1.00e-06)
Best objective -2.717188596796e+03, best bound -2.717188596796e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1442.18s
  Master Objective (UB) = -2717.19, θ = 128662.03
  Upper Bound (UB) = -2717.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128662.03
  [DEBUG]   ✓ Scenario 0: θ = 128662.03 ≤ Q = 136158.40 (slack: 7496.37)
  [DEBUG]   ✓ Scenario 1: θ = 128662.03 ≤ Q = 128691.00 (slack: 28.97)
  [DEBUG]   ✓ Scenario 2: θ = 128662.03 ≤ Q = 128662.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128662.03 ≤ Q = 128662.03 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128662.03 ≤ Q = 128662.03 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x21aac4f9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xde553b07
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.276924e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6360967.7940
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.292687e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129268.74    0  129 6360967.79 -129268.74   102%     -    0s
H    0     0                    -95181.59321 -129268.74  35.8%     -    0s
H    0     0                    -103211.4495 -129268.74  25.2%     -    0s
     0     0 -111385.31    0   76 -103211.45 -111385.31  7.92%     -    0s
H    0     0                    -106753.5572 -111321.32  4.28%     -    0s
     0     0 -110942.50    0   78 -106753.56 -110942.50  3.92%     -    0s
     0     0 -110939.99    0   78 -106753.56 -110939.99  3.92%     -    0s
H    0     0                    -110404.1005 -110939.99  0.49%     -    0s
     0     0 -110576.07    0   56 -110404.10 -110576.07  0.16%     -    0s
     0     0 -110534.42    0   34 -110404.10 -110534.42  0.12%     -    0s
     0     0 -110500.76    0   30 -110404.10 -110500.76  0.09%     -    0s
     0     0 -110460.64    0   15 -110404.10 -110460.64  0.05%     -    0s
     0     0 -110434.44    0    5 -110404.10 -110434.44  0.03%     -    0s
     0     0 -110430.93    0    3 -110404.10 -110430.93  0.02%     -    0s
     0     0 -110413.78    0    2 -110404.10 -110413.78  0.01%     -    0s
     0     0 -110410.63    0    2 -110404.10 -110410.63  0.01%     -    0s
H    0     0                    -110410.2661 -110410.63  0.00%     -    0s

Explored 1 nodes (613 simplex iterations) in 0.08 seconds (0.03 work units)
Thread count was 32 (of 32 available processors)

Solution count 7: -110410 -110404 -110276 ... 1.27692e+13
No other solutions better than -110410

Optimal solution found (tolerance 1.00e-06)
Best objective -1.104102661203e+05, best bound -1.104102661203e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 113141.56
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -110410.27
  [DEBUG]   S×d_nominal = 223551.82
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 223551.82 + -110410.27 = 113141.56
  [DEBUG]   Current θ from Master = 128662.03
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15520.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -18237.67
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 3312.6526, Absolute Gap = 3312.6526, Relative Gap = 1.219147
  Not converged yet (gap = 3312.65 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264887 nonzeros
Model fingerprint: 0x39e4aae6
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43106 rows and 17506 columns
Presolve time: 1.88s
Presolved: 50017 rows, 22194 columns, 310529 nonzeros
Variable types: 19935 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -209054.8442

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50017 rows, 22194 columns, 310529 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   18325   -9.0310408e+04   0.000000e+00   1.786465e+08      5s
   29602   -1.0882790e+04   0.000000e+00   8.569952e+08     10s
   36774   -6.2096839e+03   0.000000e+00   5.761662e+06     15s
   42561   -2.1182230e+03   0.000000e+00   4.511836e+05     20s
   49155    6.0794748e+03   0.000000e+00   1.410059e+06     25s
   56227    8.8547824e+03   0.000000e+00   1.274704e+07     30s
Concurrent spin time: 2.02s

Solved with dual simplex

Root relaxation: objective 1.474417e+04, 41535 iterations, 30.37 seconds (35.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14744.1665    0  285 -209054.84 14744.1665   107%     -   33s
H    0     0                    -194905.1729 14744.1665   108%     -   33s
H    0     0                    -51851.88640 14744.1665   128%     -   33s
H    0     0                    -27277.05572 14744.1665   154%     -   33s
H    0     0                    -25873.56211 14744.1665   157%     -   33s
H    0     0                    -24165.08554 14744.1665   161%     -   33s
H    0     0                    -23528.39501 14744.1665   163%     -   33s
H    0     0                    -23472.96525 14744.1665   163%     -   33s
H    0     0                    -16208.13427 14744.1665   191%     -   34s
H    0     0                    -3865.634945 14744.1665   481%     -   34s
H    0     0                    -3672.023214 14744.1665   502%     -   34s
H    0     0                    -3660.088675 14744.1665   503%     -   34s
H    0     0                    -3502.236248 14744.1665   521%     -   34s
     0     0 10589.8050    0  221 -3502.2362 10589.8050   402%     -   48s
     0     0 10246.5454    0  331 -3502.2362 10246.5454   393%     -   52s
     0     0 10207.7634    0  275 -3502.2362 10207.7634   391%     -   55s
     0     0 10207.7634    0  287 -3502.2362 10207.7634   391%     -   56s
     0     0 10207.7634    0  292 -3502.2362 10207.7634   391%     -   57s
     0     0 10207.7634    0  294 -3502.2362 10207.7634   391%     -   58s
     0     0 10207.7613    0  293 -3502.2362 10207.7613   391%     -   58s
     0     0 8367.07305    0  372 -3502.2362 8367.07305   339%     -   71s
     0     0 8133.04027    0  376 -3502.2362 8133.04027   332%     -   76s
     0     0 7906.73770    0  372 -3502.2362 7906.73770   326%     -   80s
     0     0 7881.11015    0  373 -3502.2362 7881.11015   325%     -   81s
     0     0 7761.93450    0  314 -3502.2362 7761.93450   322%     -   84s
     0     0 7718.91301    0  365 -3502.2362 7718.91301   320%     -   85s
     0     0 7702.32540    0  371 -3502.2362 7702.32540   320%     -   86s
     0     0 7699.46560    0  369 -3502.2362 7699.46560   320%     -   87s
     0     0 7697.03663    0  375 -3502.2362 7697.03663   320%     -   87s
     0     0 7697.03663    0  375 -3502.2362 7697.03663   320%     -   87s
H    0     0                    -3431.904970 7697.03663   324%     -   95s
H    0     0                    -3414.273965 7697.03663   325%     -   95s
     0     0 6338.35994    0  336 -3414.2740 6338.35994   286%     -  108s
H    0     0                    -3342.649764 6338.23502   290%     -  109s
     0     0 6233.41223    0  393 -3342.6498 6233.41223   286%     -  111s
     0     0 6206.87046    0  442 -3342.6498 6206.87046   286%     -  113s
     0     0 6169.00246    0  342 -3342.6498 6169.00246   285%     -  115s
     0     0 6040.94476    0  397 -3342.6498 6040.94476   281%     -  119s
     0     0 6025.21047    0  461 -3342.6498 6025.21047   280%     -  120s
     0     0 6014.41871    0  403 -3342.6498 6014.41871   280%     -  121s
     0     0 6012.52720    0  408 -3342.6498 6012.52720   280%     -  122s
     0     0 6010.30792    0  410 -3342.6498 6010.30792   280%     -  122s
     0     0 6010.30792    0  410 -3342.6498 6010.30792   280%     -  122s
     0     0 5444.29459    0  454 -3342.6498 5444.29459   263%     -  136s
H    0     0                    -3338.737534 5444.16294   263%     -  137s
     0     0 5241.47689    0  500 -3338.7375 5241.47689   257%     -  142s
     0     0 5189.22297    0  453 -3338.7375 5189.22297   255%     -  145s
     0     0 5132.02518    0  391 -3338.7375 5132.02518   254%     -  147s
     0     0 5121.54412    0  466 -3338.7375 5121.54412   253%     -  149s
     0     0 5102.34072    0  472 -3338.7375 5102.34072   253%     -  150s
     0     0 5093.58300    0  466 -3338.7375 5093.58300   253%     -  151s
     0     0 5085.45020    0  472 -3338.7375 5085.45020   252%     -  152s
     0     0 5083.00176    0  473 -3338.7375 5083.00176   252%     -  153s
     0     0 5056.26941    0  458 -3338.7375 5056.26941   251%     -  154s
     0     0 5050.41368    0  453 -3338.7375 5050.41368   251%     -  156s
     0     0 5048.31977    0  455 -3338.7375 5048.31977   251%     -  156s
     0     0 5047.39562    0  464 -3338.7375 5047.39562   251%     -  157s
     0     0 4980.74796    0  463 -3338.7375 4980.74796   249%     -  161s
     0     0 4943.02265    0  454 -3338.7375 4943.02265   248%     -  164s
     0     0 4934.43532    0  414 -3338.7375 4934.43532   248%     -  165s
     0     0 4932.23647    0  425 -3338.7375 4932.23647   248%     -  165s
     0     0 4931.02260    0  425 -3338.7375 4931.02260   248%     -  165s
     0     0 4930.58374    0  425 -3338.7375 4930.58374   248%     -  166s
     0     0 4834.72192    0  499 -3338.7375 4834.72192   245%     -  170s
     0     0 4816.33158    0  431 -3338.7375 4816.33158   244%     -  173s
     0     0 4807.62934    0  433 -3338.7375 4807.62934   244%     -  174s
     0     0 4804.64800    0  437 -3338.7375 4804.64800   244%     -  175s
     0     0 4803.88866    0  439 -3338.7375 4803.88866   244%     -  175s
     0     0 4771.71026    0  506 -3338.7375 4771.71026   243%     -  177s
     0     0 4764.94514    0  513 -3338.7375 4764.94514   243%     -  178s
     0     0 4760.35372    0  519 -3338.7375 4760.35372   243%     -  179s
     0     0 4749.50878    0  514 -3338.7375 4749.50878   242%     -  180s
     0     0 4745.07523    0  510 -3338.7375 4745.07523   242%     -  180s
     0     0 4745.00061    0  510 -3338.7375 4745.00061   242%     -  181s
     0     0 4732.64207    0  511 -3338.7375 4732.64207   242%     -  183s
     0     0 4726.40487    0  510 -3338.7375 4726.40487   242%     -  184s
     0     0 4725.24367    0  521 -3338.7375 4725.24367   242%     -  184s
     0     0 4709.13311    0  411 -3338.7375 4709.13311   241%     -  186s
     0     0 4695.18086    0  404 -3338.7375 4695.18086   241%     -  187s
     0     0 4691.70760    0  412 -3338.7375 4691.70760   241%     -  189s
     0     0 4689.90483    0  420 -3338.7375 4689.90483   240%     -  189s
     0     0 4688.18160    0  467 -3338.7375 4688.18160   240%     -  190s
     0     0 4687.47821    0  415 -3338.7375 4687.47821   240%     -  190s
     0     0 4675.95505    0  462 -3338.7375 4675.95505   240%     -  191s
     0     0 4673.36456    0  459 -3338.7375 4673.36456   240%     -  193s
     0     0 4672.97251    0  418 -3338.7375 4672.97251   240%     -  193s
     0     0 4667.89258    0  411 -3338.7375 4667.89258   240%     -  195s
     0     0 4666.42975    0  524 -3338.7375 4666.42975   240%     -  196s
     0     0 4665.57912    0  414 -3338.7375 4665.57912   240%     -  197s
     0     0 4662.60636    0  487 -3338.7375 4662.60636   240%     -  198s
     0     0 4660.43061    0  481 -3338.7375 4660.43061   240%     -  202s
     0     0 4659.52780    0  527 -3338.7375 4659.52780   240%     -  202s
     0     0 4657.39879    0  414 -3338.7375 4657.39879   239%     -  204s
     0     0 4657.00429    0  426 -3338.7375 4657.00429   239%     -  205s
     0     0 4652.43742    0  412 -3338.7375 4652.43742   239%     -  206s
     0     0 4652.15448    0  412 -3338.7375 4652.15448   239%     -  208s
     0     2 4652.15448    0  412 -3338.7375 4652.15448   239%     -  245s
     3     8 4253.96445    2  481 -3338.7375 4475.47061   234%  3791  255s
     7    16 4151.23282    3  479 -3338.7375 4369.55325   231%  3672  262s
    15    32 3928.61553    4  479 -3338.7375 4149.93335   224%  3694  274s
    31    49 2837.21582    5  281 -3338.7375 3928.36280   218%  6481  290s
    48    81 3039.27533    6  387 -3338.7375 3928.36280   218%  5754  310s
    80   221 3010.09359    7  384 -3338.7375 3928.36280   218%  4489  321s
   228   286 2700.96516   11  271 -3338.7375 3928.36280   218%  2329  331s
   316   323 2085.12582   11  262 -3338.7375 3928.36280   218%  2059  341s
   393   356 2174.41619   10  365 -3338.7375 3928.36280   218%  1903  349s
   450   397  950.78565   10  209 -3338.7375 3928.36280   218%  1892  360s
   517   419 2598.27398   12  273 -3338.7375 3928.36280   218%  1817  370s
   555   450 2281.48903   12  263 -3338.7375 3928.36280   218%  1790  379s
   608   487 1775.77757   13  258 -3338.7375 3928.36280   218%  1752  389s
   672   530 1831.30464   12  270 -3338.7375 3928.36280   218%  1690  402s
   735   562 1634.49474   14  250 -3338.7375 3928.36280   218%  1644  412s
   799   570 1679.80829   14  263 -3338.7375 3928.36280   218%  1585  423s
   866   584 1536.34615   15  249 -3338.7375 3738.58013   212%  1566  434s
   914   605     cutoff   15      -3338.7375 3738.58013   212%  1569  444s
   991   635 1064.08539   17  236 -3338.7375 3738.58013   212%  1554  455s
  1049   671  976.13643   18  240 -3338.7375 3738.58013   212%  1558  466s
  1124   700  784.07602   19  240 -3338.7375 3677.64545   210%  1556  477s
  1214   752  553.05147   19  241 -3338.7375 3677.64545   210%  1528  487s
  1284   799  804.35988   18  235 -3338.7375 3677.64545   210%  1534  497s
  1357   880 infeasible   17      -3338.7375 3677.64545   210%  1548  508s
  1456   900  -22.30878   20  230 -3338.7375 3677.64545   210%  1536  517s
  1502   941   20.73971   19  217 -3338.7375 3677.64545   210%  1544  526s
  1563   978     cutoff   20      -3338.7375 3677.64545   210%  1532  533s
  1636  1040 -652.95963   21  214 -3338.7375 3677.64545   210%  1517  543s
  1748  1110 -896.08929   21  210 -3338.7375 3598.90969   208%  1484  557s
  1876  1195 -1439.3319   22  208 -3338.7375 3596.56515   208%  1454  571s
  2027  1270 -1436.1600   23  145 -3338.7375 3596.56515   208%  1423  585s
  2168  1342 -2320.2840   29  175 -3338.7375 3447.49871   203%  1415  599s
  2316  1376 -2683.1804   35  177 -3338.7375 3382.07549   201%  1405  614s
  2440  1430  526.07669    9  427 -3338.7375 3347.04483   200%  1426  630s
  2564  1471 -393.12779   11  368 -3338.7375 3347.04483   200%  1442  642s
  2691  1531 -1567.4831   15  276 -3338.7375 3347.04483   200%  1461  656s
  2831  1536 -2166.6075   21  325 -3338.7375 3281.57029   198%  1471  671s
  2943  1565 -2309.3863   23  315 -3338.7375 3176.35883   195%  1473  687s
  3058  1626     cutoff   31      -3338.7375 3176.35883   195%  1482  703s
  3201  1676 -2237.8342   11  126 -3338.7375 3176.35883   195%  1495  718s
  3388  1731 -2745.7477    7  121 -3338.7375 3176.35883   195%  1495  736s
  3589  1764     cutoff    8      -3338.7375 3176.35883   195%  1494  757s
  3765  1802   98.87512    9  204 -3338.7375 3176.35883   195%  1505  774s
  3954  1843     cutoff   10      -3338.7375 2572.56653   177%  1516  794s
  4133  1871 -1343.5778   11  384 -3338.7375 2417.37706   172%  1529  811s
  4309  1920     cutoff   12      -3338.7375 2416.56407   172%  1532  830s
  4495  1996 -2628.9599   14  383 -3338.7375 2307.97581   169%  1547  852s
  4724  2019     cutoff   14      -3338.7375 2273.76549   168%  1550  864s
  4765  2034  238.32126   11  358 -3338.7375 2209.99484   166%  1557  877s
  4812  2043 -1116.8738   12  241 -3338.7375 2209.99484   166%  1563  890s
  4869  2058 -1351.0028   13  243 -3338.7375 2190.21334   166%  1566  909s
  4936  2058 -1622.0144   14  267 -3338.7375 2190.21334   166%  1572  926s
  5034  2097 -2419.2535   15  121 -3338.7375 2190.21334   166%  1571  951s
  5141  2140 -2957.9177   16  124 -3338.7375 2185.65064   165%  1576  974s
  5356  2164 -2768.2969   16  265 -3338.7375 2174.91663   165%  1572  996s
  5554  2198     cutoff   18      -3338.7375 2091.09590   163%  1576 1022s
  5817  2254  937.09795   13  460 -3338.7375 2059.14562   162%  1582 1045s
  6122  2308 infeasible   16      -3338.7375 2059.14562   162%  1583 1074s
  6450  2373 -1231.7600   13  236 -3338.7375 1969.80543   159%  1583 1101s
  6802  2412     cutoff   34      -3338.7375 1896.91720   157%  1577 1127s
  7118  2446 -743.57297   12  323 -3338.7375 1821.29870   155%  1566 1159s
  7427  2453 -2943.9256   21  323 -3338.7375 1723.47464   152%  1570 1194s
  7764  2474 infeasible   17      -3338.7375 1362.59547   141%  1573 1225s
  8128  2493     cutoff   14      -3338.7375 1360.30759   141%  1580 1256s
  8472  2491 -2022.0033   15  145 -3338.7375 1034.73080   131%  1590 1292s
  8882  2485 -3128.6116   21  278 -3338.7375  770.07334   123%  1586 1326s
  9322  2503 -2894.2913   15  226 -3338.7375  598.81263   118%  1590 1360s
  9800  2538     cutoff   23      -3338.7375  445.31100   113%  1588 1399s
 10306  2644 -2644.1922   25  404 -3338.7375  325.09141   110%  1587 1435s
 10972  2645   -8.67954   10  412 -3338.7375   31.78116   101%  1565 1573s
 10974  2646 -1828.2569   19  285 -3338.7375   31.78116   101%  1565 1612s
 10975  2647 -1056.6618   12  346 -3338.7375   31.78116   101%  1565 1631s
 10976  2648 -2798.2367   27  402 -3338.7375   31.78116   101%  1565 1643s
 10977  2648 -776.28955   16  457 -3338.7375   31.78116   101%  1565 1651s
 10978  2649 -2430.8166   13  489 -3338.7375   31.78116   101%  1565 1657s
 10979  2650 -1456.2984   18  446 -3338.7375   31.78116   101%  1564 1662s
 10980  2650 -1834.4209   16  440 -3338.7375   31.78116   101%  1564 1666s
 10982  2652 -2599.0761   18  403 -3338.7375   31.78116   101%  1564 1670s
 10984  2653 -1689.5296   17  408 -3338.7375   31.78116   101%  1564 1680s
 10986  2654 -1003.1916   17  518 -3338.7375   31.78116   101%  1563 1685s
 10988  2656 -197.19272   18  523 -3338.7375   31.78116   101%  1563 1695s
 10990  2657 -2703.2244   17  483 -3338.7375   31.78116   101%  1563 1707s
 10992  2658 -787.93705   18  413 -3338.7375   31.78116   101%  1563 1712s
 10993  2659 -1292.6945   24  473 -3338.7375   31.78116   101%  1562 1717s
 10994  2660 -2975.1589   18  583 -3338.7375   31.78116   101%  1562 1722s
 10995  2660 -1184.3877   14  554 -3338.7375   31.78116   101%  1562 1728s
 10996  2661 -1581.8128   19  554 -3338.7375   31.78116   101%  1562 1768s
 10997  2662 -287.11967   14  554 -3338.7375   31.78116   101%  1562 1791s
 10998  2665   31.78116   15  531 -3338.7375   31.78116   101%  1573 1810s
 11000  2669   31.78116   16  532 -3338.7375   31.78116   101%  1574 1822s
 11004  2675   31.78116   17  538 -3338.7375   31.78116   101%  1575 1833s
 11012  2689   31.78116   18  525 -3338.7375   31.78116   101%  1578 1852s
 11028  2699   31.78116   19  439 -3338.7375   31.78116   101%  1585 1876s
 11044  2725   31.78116   20  417 -3338.7375   31.78116   101%  1600 1890s
 11076  2764   31.78116   21  400 -3338.7375   31.78116   101%  1604 1911s
 11159  2763   31.78116   23  444 -3338.7375   31.78116   101%  1620 1921s
 11196  2763   31.78116   23  249 -3338.7375   31.78116   101%  1625 1939s
 11248  2764   31.78116   24  333 -3338.7375   31.78116   101%  1634 1957s
 11309  2756 -2616.8066   24  337 -3338.7375   31.78116   101%  1645 1973s
 11379  2718 -828.31462   25  319 -3338.7375   31.78116   101%  1653 1988s
 11465  2682 -2081.0677   25  444 -3338.7375   31.78116   101%  1659 2002s
 11537  2656     cutoff   24      -3338.7375   31.78116   101%  1669 2018s
 11610  2643   31.78116   22  448 -3338.7375   31.78116   101%  1679 2037s
 11681  2644 -1109.4275   23  488 -3338.7375   31.78116   101%  1692 2053s
 11748  2634 -2053.4575   24  482 -3338.7375   31.78116   101%  1705 2070s
 11816  2622     cutoff   25      -3338.7375   31.78116   101%  1711 2088s
 11880  2612     cutoff   23      -3338.7375   31.78116   101%  1726 2104s
 11962  2595 -888.95631   24  441 -3338.7375   31.78116   101%  1739 2119s
 12026  2581 -3287.3286   26  440 -3338.7375   31.78116   101%  1752 2136s
 12109  2559 -1377.2380   26  358 -3338.7375   31.78116   101%  1757 2152s
 12202  2542     cutoff   28      -3338.7375   31.78116   101%  1771 2168s
 12296  2530     cutoff   28      -3338.7375   31.78116   101%  1783 2185s
 12410  2526 -2331.9702   31  362 -3338.7375   31.78116   101%  1791 2205s
 12521  2484     cutoff   32      -3338.7375   31.78116   101%  1804 2222s
 12651  2440 -2975.0019   35  337 -3338.7375   31.78116   101%  1811 2241s
 12707  2413 -2932.7248   35  345 -3338.7375   31.78116   101%  1822 2257s
 12778  2371 -2984.3323   35  262 -3338.7375   31.78116   101%  1826 2274s
 12889  2321 -3113.9019   35  257 -3338.7375   31.78116   101%  1830 2288s
 13044  2264     cutoff   23      -3338.7375   31.78116   101%  1836 2305s
 13220  2181 -2692.7619   26  289 -3338.7375   31.78116   101%  1841 2323s
 13433  2048     cutoff   27      -3338.7375   31.78116   101%  1840 2342s
 13673  1905     cutoff   29      -3338.7375   31.78116   101%  1838 2357s
 13897  1765     cutoff   26      -3338.7375 -451.14688  86.5%  1835 2373s
 14102  1678 -843.74166   25  390 -3338.7375 -453.76012  86.4%  1831 2389s
 14253  1585 -1813.6988   26  313 -3338.7375 -1139.8931  65.9%  1831 2400s
 14348  1557     cutoff   27      -3338.7375 -1139.8931  65.9%  1825 2413s
 14369  1544 -2788.8559   31  417 -3338.7375 -2323.1786  30.4%  1826 2426s
 14395  1529 -3046.7266   32  398 -3338.7375 -2565.3779  23.2%  1827 2435s

Cutting planes:
  Learned: 1
  MIR: 459
  Flow cover: 1141
  Zero half: 4
  RLT: 11
  Relax-and-lift: 80

Explored 14408 nodes (26469822 simplex iterations) in 2435.30 seconds (4082.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3338.74 -3342.65 -3414.27 ... -23473
No other solutions better than -3338.74

Optimal solution found (tolerance 1.00e-06)
Best objective -3.338737534232e+03, best bound -3.338737534232e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2435.38s
  Master Objective (UB) = -3338.74, θ = 124907.32
  Upper Bound (UB) = -3338.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 124907.32
  [DEBUG]   ✓ Scenario 0: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 124907.32 ≤ Q = 124907.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 124907.32 ≤ Q = 124907.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 124907.32 ≤ Q = 124907.32 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6deb93ec
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x92146c14
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.394759e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6690718.8197
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.438193e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -143819.28    0  128 6690718.82 -143819.28   102%     -    0s
H    0     0                    -107541.8102 -143819.28  33.7%     -    0s
H    0     0                    -108144.7725 -143819.28  33.0%     -    0s
H    0     0                    -116161.6513 -143819.28  23.8%     -    0s
     0     0 -122815.80    0   36 -116161.65 -122815.80  5.73%     -    0s
H    0     0                    -122331.3074 -122815.80  0.40%     -    0s
H    0     0                    -122471.4044 -122641.19  0.14%     -    0s
     0     0 -122641.19    0   28 -122471.40 -122641.19  0.14%     -    0s
     0     0 -122598.98    0    8 -122471.40 -122598.98  0.10%     -    0s
     0     0 -122597.74    0    5 -122471.40 -122597.74  0.10%     -    0s
     0     0 -122572.10    0    2 -122471.40 -122572.10  0.08%     -    0s
     0     0 -122572.10    0    5 -122471.40 -122572.10  0.08%     -    0s
H    0     0                    -122561.9691 -122572.10  0.01%     -    0s
     0     0     cutoff    0      -122561.97 -122561.97  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 4
  RLT: 1

Explored 1 nodes (492 simplex iterations) in 0.10 seconds (0.02 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -122562 -122471 -122062 ... 1.39476e+13
No other solutions better than -122562

Optimal solution found (tolerance 1.00e-06)
Best objective -1.225619691473e+05, best bound -1.225619691473e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 111189.41
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -122561.97
  [DEBUG]   S×d_nominal = 233751.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233751.38 + -122561.97 = 111189.41
  [DEBUG]   Current θ from Master = 124907.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13717.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -17056.65
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 2691.1037, Absolute Gap = 2691.1037, Relative Gap = 0.806024
  Not converged yet (gap = 2691.10 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308115 nonzeros
Model fingerprint: 0x4b4500f2
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50297 rows and 20427 columns
Presolve time: 2.34s
Presolved: 58116 rows, 25513 columns, 361344 nonzeros
Variable types: 23254 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -209054.8442

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58116 rows, 25513 columns, 361344 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   20949   -1.4187422e+05   0.000000e+00   5.831694e+06      5s
   32028   -2.9453433e+04   0.000000e+00   6.253067e+08     10s
   40824   -1.4617687e+03   0.000000e+00   1.123133e+06     15s
   45738    1.3388136e+03   0.000000e+00   8.494641e+06     20s
   51766    6.3515691e+03   0.000000e+00   3.879586e+08     25s
   56918    7.8386032e+03   0.000000e+00   8.025769e+06     30s
   61871    1.0712155e+04   0.000000e+00   5.749247e+05     35s
   65931    1.1989175e+04   0.000000e+00   6.499059e+06     40s
   70223    1.2916070e+04   0.000000e+00   1.109750e+06     45s
Concurrent spin time: 0.02s

Solved with dual simplex

Root relaxation: objective 1.439996e+04, 47123 iterations, 42.96 seconds (49.48 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14399.9573    0  344 -209054.84 14399.9573   107%     -   46s
H    0     0                    -200071.2020 14399.9573   107%     -   46s
H    0     0                    -82266.01976 14399.9573   118%     -   46s
H    0     0                    -15773.71783 14399.9573   191%     -   46s
H    0     0                    -15611.41464 14399.9573   192%     -   46s
H    0     0                    -3966.215138 14399.9573   463%     -   47s
H    0     0                    -3962.302908 14399.9573   463%     -   47s
H    0     0                    -3944.823204 14399.9573   465%     -   49s
H    0     0                    -3940.910974 14399.1365   465%     -   49s
     0     0 11673.2053    0  231 -3940.9110 11673.2053   396%     -   64s
H    0     0                    -3922.724084 11673.2053   398%     -   64s
     0     0 11205.9629    0  294 -3922.7241 11205.9629   386%     -   69s
     0     0 11016.0786    0  240 -3922.7241 11016.0786   381%     -   73s
     0     0 10698.5498    0  249 -3922.7241 10698.5498   373%     -   81s
     0     0 10698.5498    0  275 -3922.7241 10698.5498   373%     -   84s
     0     0 10698.5498    0  276 -3922.7241 10698.5498   373%     -   85s
     0     0 10698.5498    0  277 -3922.7241 10698.5498   373%     -   85s
     0     0 8467.19675    0  375 -3922.7241 8467.19675   316%     -  100s
     0     0 8223.85368    0  382 -3922.7241 8223.85368   310%     -  108s
     0     0 8135.48834    0  336 -3922.7241 8135.48834   307%     -  114s
     0     0 8124.24377    0  393 -3922.7241 8124.24377   307%     -  116s
H    0     0                    -3905.093079 8096.78699   307%     -  117s
     0     0 8096.78699    0  396 -3905.0931 8096.78699   307%     -  117s
     0     0 8073.55346    0  399 -3905.0931 8073.55346   307%     -  119s
     0     0 8036.16769    0  441 -3905.0931 8036.16769   306%     -  122s
     0     0 8034.58504    0  445 -3905.0931 8034.58504   306%     -  122s
     0     0 8034.58482    0  445 -3905.0931 8034.58482   306%     -  124s
     0     0 6783.57076    0  348 -3905.0931 6783.57076   274%     -  147s
     0     0 6467.72764    0  430 -3905.0931 6467.72764   266%     -  156s
     0     0 6253.17013    0  419 -3905.0931 6253.17013   260%     -  162s
     0     0 6119.17377    0  417 -3905.0931 6119.17377   257%     -  167s
     0     0 5983.80691    0  481 -3905.0931 5983.80691   253%     -  172s
     0     0 5959.82516    0  487 -3905.0931 5959.82516   253%     -  174s
     0     0 5948.69723    0  447 -3905.0931 5948.69723   252%     -  175s
     0     0 5944.86738    0  492 -3905.0931 5944.86738   252%     -  176s
     0     0 5938.48438    0  491 -3905.0931 5938.48438   252%     -  177s
     0     0 5936.22102    0  490 -3905.0931 5936.22102   252%     -  178s
     0     0 5932.71902    0  442 -3905.0931 5932.71902   252%     -  178s
     0     0 5932.29365    0  444 -3905.0931 5932.29365   252%     -  179s
     0     0 5406.63704    0  460 -3905.0931 5406.63704   238%     -  198s
     0     0 5222.51565    0  525 -3905.0931 5222.51565   234%     -  205s
     0     0 5144.26935    0  512 -3905.0931 5144.26935   232%     -  209s
     0     0 5107.79008    0  526 -3905.0931 5107.79008   231%     -  211s
     0     0 5072.92726    0  519 -3905.0931 5072.92726   230%     -  214s
     0     0 5062.86623    0  520 -3905.0931 5062.86623   230%     -  215s
     0     0 5052.94972    0  525 -3905.0931 5052.94972   229%     -  216s
     0     0 5042.76023    0  524 -3905.0931 5042.76023   229%     -  217s
     0     0 5039.17344    0  532 -3905.0931 5039.17344   229%     -  217s
     0     0 5036.37756    0  526 -3905.0931 5036.37756   229%     -  218s
     0     0 5033.70732    0  522 -3905.0931 5033.70732   229%     -  218s
     0     0 5033.23648    0  524 -3905.0931 5033.23648   229%     -  218s
     0     0 4854.82746    0  470 -3905.0931 4854.82746   224%     -  225s
     0     0 4830.49749    0  458 -3905.0931 4830.49749   224%     -  228s
     0     0 4816.58202    0  463 -3905.0931 4816.58202   223%     -  230s
     0     0 4805.84895    0  520 -3905.0931 4805.84895   223%     -  233s
     0     0 4796.94215    0  467 -3905.0931 4796.94215   223%     -  234s
     0     0 4793.93262    0  470 -3905.0931 4793.93262   223%     -  235s
     0     0 4793.24065    0  529 -3905.0931 4793.24065   223%     -  236s
     0     0 4747.77220    0  527 -3905.0931 4747.77220   222%     -  240s
     0     0 4697.38828    0  481 -3905.0931 4697.38828   220%     -  247s
     0     0 4695.93840    0  484 -3905.0931 4695.93840   220%     -  247s
     0     0 4694.68536    0  544 -3905.0931 4694.68536   220%     -  248s
     0     0 4693.80820    0  482 -3905.0931 4693.80820   220%     -  249s
     0     0 4670.21795    0  474 -3905.0931 4670.21795   220%     -  251s
     0     0 4666.88056    0  483 -3905.0931 4666.88056   220%     -  252s
     0     0 4660.87775    0  482 -3905.0931 4660.87775   219%     -  253s
     0     0 4659.37434    0  486 -3905.0931 4659.37434   219%     -  254s
     0     0 4659.32157    0  488 -3905.0931 4659.32157   219%     -  254s
     0     0 4634.33313    0  473 -3905.0931 4634.33313   219%     -  257s
     0     0 4631.77293    0  480 -3905.0931 4631.77293   219%     -  265s
     0     0 4631.45464    0  415 -3905.0931 4631.45464   219%     -  265s
     0     0 4629.50880    0  487 -3905.0931 4629.50880   219%     -  267s
     0     0 4628.23214    0  489 -3905.0931 4628.23214   219%     -  268s
     0     0 4625.72089    0  412 -3905.0931 4625.72089   218%     -  268s
     0     0 4624.80627    0  418 -3905.0931 4624.80627   218%     -  268s
     0     0 4621.52658    0  489 -3905.0931 4621.52658   218%     -  270s
     0     0 4620.74489    0  494 -3905.0931 4620.74489   218%     -  270s
     0     0 4612.74454    0  492 -3905.0931 4612.74454   218%     -  273s
     0     0 4612.20199    0  492 -3905.0931 4612.20199   218%     -  275s
     0     2 4612.20199    0  492 -3905.0931 4612.20199   218%     -  318s
     1     4 4485.71248    1  527 -3905.0931 4611.89798   218%  2796  326s
     3     8 4413.63994    2  473 -3905.0931 4485.62493   215%  4512  333s
     7    16 4318.97718    3  528 -3905.0931 4413.15252   213%  3933  343s
    15    32 4182.48854    4  536 -3905.0931 4318.90443   211%  5027  356s
    31    50  -95.95410    5  143 -3905.0931 4182.47362   207%  6737  379s
    49    82 3476.17988    6  529 -3905.0931 4182.37915   207%  6881  395s
    81   188 3459.43905    7  519 -3905.0931 4182.37915   207%  5387  412s
   187   267 3455.12472    8  527 -3905.0931 4182.37915   207%  2828  427s
   289   314 2799.30269   11  471 -3905.0931 4182.37915   207%  2314  439s
   372   358 2818.00234   11  491 -3905.0931 4182.37915   207%  2130  452s
   442   373 3086.83514   10  523 -3905.0931 4182.37915   207%  2063  466s
   514   392 2665.11439   12  478 -3905.0931 4182.37915   207%  1994  482s
   577   398 -1388.5362   12  130 -3905.0931 4182.37915   207%  1995  496s
   635   422 2715.51524   12  498 -3905.0931 4182.37915   207%  2001  509s
   703   449 -1178.5428   12  119 -3905.0931 4182.37915   207%  2002  522s
   760   493 2236.65095   13  404 -3905.0931 4182.37915   207%  2033  535s
   828   512 2391.48430   13  411 -3905.0931 4182.37915   207%  2013  548s
   875   529     cutoff   10      -3905.0931 4182.37915   207%  2061  563s
   944   553 -2929.0418   14  344 -3905.0931 4182.37915   207%  2064  575s
   986   582 -1569.6511   13  137 -3905.0931 4182.37915   207%  2039  590s
  1071   601 -3689.3834   15  240 -3905.0931 4182.37915   207%  1995  601s
  1126   621 infeasible   16      -3905.0931 4182.37915   207%  2007  615s
  1208   659  510.48438    7  254 -3905.0931 4182.37915   207%  1987  625s
  1294   712  -51.14678    8  310 -3905.0931 4182.37915   207%  1969  640s
  1406   776 -439.69480   10  306 -3905.0931 4182.37915   207%  1918  655s
  1510   810 -625.29135   12  376 -3905.0931 4182.37915   207%  1907  672s
  1646   846 -1289.5541   15  285 -3905.0931 4182.37915   207%  1866  689s
  1752   882 -1452.3000   17  250 -3905.0931 4182.37915   207%  1869  708s
  1854   904 -2237.8478   20  267 -3905.0931 3647.99558   193%  1877  718s
  1902   936 -2756.2933   21  188 -3905.0931 3117.17081   180%  1887  735s
  1980   992 -2818.3180   22  177 -3905.0931 3081.63062   179%  1878  752s
  2100  1049     cutoff   30      -3905.0931 3013.49480   177%  1857  771s
  2251  1119 2276.79123    6  384 -3905.0931 2984.75952   176%  1819  792s
  2379  1174 -2973.5168    7  305 -3905.0931 2921.70325   175%  1819  811s
  2526  1220 -3495.1705    9  329 -3905.0931 2921.70325   175%  1803  828s
  2612  1239 -3843.1900   10  332 -3905.0931 2885.29244   174%  1809  848s
  2792  1259     cutoff   11      -3905.0931 2859.90597   173%  1779  868s
  2932  1287 -1254.4555   17  480 -3905.0931 2733.42007   170%  1794  890s
  3082  1325 -2108.5013   20  505 -3905.0931 2672.68641   168%  1797  912s
  3272  1338 -3113.3299   24  314 -3905.0931 2672.68641   168%  1788  932s
  3415  1361 -3598.3610   26  229 -3905.0931 2672.68641   168%  1776  955s
  3585  1362 -3146.2396   13  218 -3905.0931 2590.83505   166%  1778  982s
  3767  1382 -2209.9429   14  472 -3905.0931 2590.83505   166%  1790 1008s
  3953  1459 -1989.1704   18  225 -3905.0931 2590.83505   166%  1808 1033s
  4191  1510 -3134.9142   28  160 -3905.0931 2590.83505   166%  1805 1056s
  4463  1599     cutoff   12      -3905.0931 1680.93762   143%  1792 1083s
  4712  1682     cutoff   12      -3905.0931 1303.33621   133%  1794 1112s
  5010  1730 -2373.9056   14  391 -3905.0931 1303.33621   133%  1773 1140s
  5242  1788 -2957.7338   16  250 -3905.0931 1303.33621   133%  1776 1170s
  5594  1818 -3402.8361   13  327 -3905.0931  923.63167   124%  1760 1201s
  5857  1819 -561.62456    9  221 -3905.0931  324.47928   108%  1771 1228s
  5918  1824     cutoff   10      -3905.0931  324.47928   108%  1782 1254s
  6024  1849     cutoff   10      -3905.0931  314.78051   108%  1783 1280s
  6210  1923 -814.46747   12  261 -3905.0931   74.88709   102%  1781 1312s
  6605  1944     cutoff   17      -3905.0931   31.69039   101%  1759 1349s
  6837  1955     cutoff   14      -3905.0931 -244.08162  93.7%  1761 1387s
  7202  1939     cutoff   20      -3905.0931 -477.52086  87.8%  1759 1424s
  7523  1937     cutoff   18      -3905.0931 -687.60631  82.4%  1766 1458s
  8050  1986     cutoff   32      -3905.0931 -960.52483  75.4%  1744 1501s
  8586  1979     cutoff   25      -3905.0931 -1047.2964  73.2%  1723 1539s
  9139  1970 -3527.4216   20  157 -3905.0931 -1299.8028  66.7%  1697 1578s
  9765  1956     cutoff   25      -3905.0931 -1505.6631  61.4%  1672 1620s
 10397  1972     cutoff   45      -3905.0931 -1849.6100  52.6%  1651 1662s
 11177  1960 -3674.7470   31  129 -3905.0931 -2050.7031  47.5%  1616 1702s
 12007  1930     cutoff   25      -3905.0931 -2259.9029  42.1%  1582 1743s
 12853  1804 -3522.3445   27  182 -3905.0931 -2445.6921  37.4%  1549 1784s
 13808  1654 -3487.0801   16  441 -3905.0931 -2585.6630  33.8%  1515 1824s
 14923  1614 -3440.9930   20  150 -3905.0931 -2787.8805  28.6%  1469 1866s
 15204  1405 -3490.6469   32  161 -3905.0931 -2859.9295  26.8%  1459 1913s
 16520  1062     cutoff   33      -3905.0931 -2976.7787  23.8%  1401 1951s
 18342   369 -3599.5793   25  129 -3905.0931 -3080.4575  21.1%  1320 1985s
 20975     0 -3773.8984   40  122 -3905.0931 -3395.0166  13.1%  1201 1996s

Cutting planes:
  Learned: 2
  Cover: 1
  Implied bound: 57
  MIR: 739
  Flow cover: 1374
  Zero half: 3
  RLT: 25
  Relax-and-lift: 95

Explored 21826 nodes (25599195 simplex iterations) in 1996.46 seconds (3547.53 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3905.09 -3922.72 -3940.91 ... -200071
No other solutions better than -3905.09

Optimal solution found (tolerance 1.00e-06)
Best objective -3.905093078594e+03, best bound -3.905093078594e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1996.54s
  Master Objective (UB) = -3905.09, θ = 123569.57
  Upper Bound (UB) = -3905.09

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 123569.57
  [DEBUG]   ✓ Scenario 0: θ = 123569.57 ≤ Q = 123700.32 (slack: 130.75)
  [DEBUG]   ✓ Scenario 1: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 123569.57 ≤ Q = 123569.57 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1e18c623
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1e18c623
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.400814e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6723361.5879
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.404035e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140403.46    0  125 6723361.59 -140403.46   102%     -    0s
H    0     0                    -107003.9994 -140403.46  31.2%     -    0s
H    0     0                    -107241.6269 -140403.46  30.9%     -    0s
     0     0 -117667.45    0   82 -107241.63 -117667.45  9.72%     -    0s
H    0     0                    -113192.7581 -117533.09  3.83%     -    0s
H    0     0                    -115422.7438 -117533.09  1.83%     -    0s
     0     0 -116779.37    0   82 -115422.74 -116779.37  1.18%     -    0s
H    0     0                    -115447.6648 -116748.52  1.13%     -    0s
     0     0 -116507.52    0   83 -115447.66 -116507.52  0.92%     -    0s
     0     0 -116507.52    0   83 -115447.66 -116507.52  0.92%     -    0s
     0     0 -116163.54    0   60 -115447.66 -116163.54  0.62%     -    0s
     0     0 -116055.12    0   64 -115447.66 -116055.12  0.53%     -    0s
     0     0 -116036.24    0   55 -115447.66 -116036.24  0.51%     -    0s
     0     0 -115756.52    0   34 -115447.66 -115756.52  0.27%     -    0s
     0     0 -115711.49    0   33 -115447.66 -115711.49  0.23%     -    0s
     0     0 -115693.83    0   31 -115447.66 -115693.83  0.21%     -    0s
     0     0 -115689.76    0   30 -115447.66 -115689.76  0.21%     -    0s
     0     0 -115609.57    0   20 -115447.66 -115609.57  0.14%     -    0s
     0     0 -115564.40    0   14 -115447.66 -115564.40  0.10%     -    0s
     0     0 -115560.01    0   15 -115447.66 -115560.01  0.10%     -    0s
     0     0 -115497.32    0    6 -115447.66 -115497.32  0.04%     -    0s
     0     0 -115497.32    0    9 -115447.66 -115497.32  0.04%     -    0s
H    0     0                    -115482.8511 -115497.32  0.01%     -    0s
     0     0 -115483.03    0    2 -115482.85 -115483.03  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 2
  Flow cover: 4
  RLT: 2

Explored 1 nodes (762 simplex iterations) in 0.14 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -115483 -115448 -115423 ... 1.40081e+13
No other solutions better than -115483

Optimal solution found (tolerance 1.00e-06)
Best objective -1.154828511488e+05, best bound -1.154828511488e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 117892.44
  Scenario: 38 demand increases, 22 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -115482.85
  [DEBUG]   S×d_nominal = 233375.29
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233375.29 + -115482.85 = 117892.44
  [DEBUG]   Current θ from Master = 123569.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5677.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -9582.22
  Lower Bound (LB) = -6029.84
  Gap (UB-LB) = 2124.7481, Absolute Gap = 2124.7481, Relative Gap = 0.544097
  Not converged yet (gap = 2124.75 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 22 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351343 nonzeros
Model fingerprint: 0x557ccbfd
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57468 rows and 23338 columns
Presolve time: 3.43s
Presolved: 66235 rows, 28842 columns, 412219 nonzeros
Variable types: 26583 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -209054.8442

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 66235 rows, 28842 columns, 412219 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   12443   -2.4364678e+05   0.000000e+00   2.730521e+07      5s
   30046   -6.8995897e+04   0.000000e+00   5.468447e+08     10s
   37860   -3.1714964e+04   0.000000e+00   1.218065e+08     15s
   43114   -2.7215268e+04   0.000000e+00   2.889879e+07     20s
   50953   -3.6075529e+03   0.000000e+00   3.212091e+06     25s
   55319   -2.7477281e+03   0.000000e+00   5.141044e+07     30s
   60372    2.0643140e+02   0.000000e+00   7.986735e+06     35s
   65565    3.1156357e+03   0.000000e+00   1.014823e+08     40s
   70787    6.5220451e+03   0.000000e+00   3.068538e+06     45s
   76209    7.2127228e+03   0.000000e+00   8.126537e+06     50s
   80433    7.4438393e+03   0.000000e+00   2.168066e+08     55s
Concurrent spin time: 0.34s

Solved with dual simplex

Root relaxation: objective 1.429297e+04, 55595 iterations, 51.54 seconds (64.27 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14292.9705    0  339 -209054.84 14292.9705   107%     -   56s
H    0     0                    -196369.6528 14292.9705   107%     -   56s
H    0     0                    -29038.69928 14292.9705   149%     -   56s
H    0     0                    -17783.90551 14292.9705   180%     -   56s
H    0     0                    -17691.34315 14292.9705   181%     -   56s
H    0     0                    -16817.51070 14292.9705   185%     -   57s
H    0     0                    -13499.35031 14292.9705   206%     -   57s
H    0     0                    -13374.43632 14292.9705   207%     -   57s
H    0     0                    -4497.603030 14292.9705   418%     -   57s
H    0     0                    -4460.869153 14292.9705   420%     -   57s
H    0     0                    -4409.887492 14292.9705   424%     -   57s
H    0     0                    -4034.128129 14292.9705   454%     -   57s
     0     0 11538.8110    0  274 -4034.1281 11538.8110   386%     -   81s
H    0     0                    -3953.507938 11538.8110   392%     -   82s
H    0     0                    -3946.940519 11538.8110   392%     -   82s
     0     0 11077.1488    0  230 -3946.9405 11077.1488   381%     -   90s
     0     0 10309.3097    0  196 -3946.9405 10309.3097   361%     -  107s
     0     0 10309.3097    0  242 -3946.9405 10309.3097   361%     -  114s
     0     0 10309.3097    0  285 -3946.9405 10309.3097   361%     -  121s
     0     0 8434.53043    0  284 -3946.9405 8434.53043   314%     -  128s
     0     0 8434.53043    0  282 -3946.9405 8434.53043   314%     -  131s
     0     0 8434.53043    0  279 -3946.9405 8434.53043   314%     -  132s
     0     0 8434.53043    0  282 -3946.9405 8434.53043   314%     -  132s
     0     0 8420.14359    0  427 -3946.9405 8420.14359   313%     -  159s
     0     0 7995.37579    0  441 -3946.9405 7995.37579   303%     -  171s
     0     0 7925.81249    0  435 -3946.9405 7925.81249   301%     -  176s
     0     0 7877.71032    0  430 -3946.9405 7877.71032   300%     -  181s
     0     0 7759.03579    0  431 -3946.9405 7759.03579   297%     -  186s
     0     0 7750.72732    0  432 -3946.9405 7750.72732   296%     -  187s
     0     0 7745.77970    0  434 -3946.9405 7745.77970   296%     -  188s
     0     0 7743.88556    0  433 -3946.9405 7743.88556   296%     -  189s
     0     0 7741.44836    0  431 -3946.9405 7741.44836   296%     -  190s
     0     0 7734.52570    0  431 -3946.9405 7734.52570   296%     -  191s
     0     0 7733.04442    0  430 -3946.9405 7733.04442   296%     -  191s
     0     0 7732.61540    0  428 -3946.9405 7732.61540   296%     -  191s
     0     0 6394.41175    0  426 -3946.9405 6394.41175   262%     -  218s
     0     0 6002.42833    0  374 -3946.9405 6002.42833   252%     -  229s
H    0     0                    -3929.309513 5905.78016   250%     -  238s
     0     0 5905.78016    0  454 -3929.3095 5905.78016   250%     -  238s
     0     0 5833.33946    0  502 -3929.3095 5833.33946   248%     -  243s
     0     0 5816.95527    0  451 -3929.3095 5816.95527   248%     -  247s
     0     0 5775.03101    0  451 -3929.3095 5775.03101   247%     -  252s
     0     0 5761.28755    0  383 -3929.3095 5761.28755   247%     -  255s
     0     0 5757.01956    0  400 -3929.3095 5757.01956   247%     -  257s
     0     0 5755.03061    0  383 -3929.3095 5755.03061   246%     -  258s
     0     0 5754.67319    0  384 -3929.3095 5754.67319   246%     -  258s
     0     0 5335.00203    0  522 -3929.3095 5335.00203   236%     -  280s
     0     0 5048.05984    0  522 -3929.3095 5048.05984   228%     -  291s
     0     0 4955.67299    0  456 -3929.3095 4955.67299   226%     -  297s
     0     0 4919.54572    0  460 -3929.3095 4919.54572   225%     -  301s
     0     0 4889.65669    0  467 -3929.3095 4889.65669   224%     -  303s
     0     0 4859.66833    0  466 -3929.3095 4859.66833   224%     -  306s
     0     0 4855.31553    0  471 -3929.3095 4855.31553   224%     -  308s
     0     0 4852.52505    0  462 -3929.3095 4852.52505   223%     -  308s
     0     0 4848.69257    0  467 -3929.3095 4848.69257   223%     -  309s
     0     0 4846.18930    0  468 -3929.3095 4846.18930   223%     -  311s
     0     0 4844.19319    0  471 -3929.3095 4844.19319   223%     -  312s
     0     0 4843.64796    0  472 -3929.3095 4843.64796   223%     -  312s
     0     0 4727.52067    0  400 -3929.3095 4727.52067   220%     -  320s
     0     0 4694.65359    0  403 -3929.3095 4694.65359   219%     -  325s
     0     0 4675.60740    0  397 -3929.3095 4675.60740   219%     -  329s
     0     0 4669.50594    0  406 -3929.3095 4669.50594   219%     -  330s
     0     0 4664.78587    0  406 -3929.3095 4664.78587   219%     -  331s
     0     0 4663.81527    0  404 -3929.3095 4663.81527   219%     -  332s
     0     0 4607.67435    0  524 -3929.3095 4607.67435   217%     -  339s
     0     0 4594.02880    0  405 -3929.3095 4594.02880   217%     -  343s
     0     0 4590.58909    0  528 -3929.3095 4590.58909   217%     -  344s
     0     0 4584.62753    0  529 -3929.3095 4584.62753   217%     -  346s
     0     0 4582.03579    0  519 -3929.3095 4582.03579   217%     -  346s
     0     0 4579.83477    0  528 -3929.3095 4579.83477   217%     -  347s
     0     0 4579.58680    0  527 -3929.3095 4579.58680   217%     -  348s
     0     0 4562.21292    0  407 -3929.3095 4562.21292   216%     -  351s
     0     0 4560.74507    0  527 -3929.3095 4560.74507   216%     -  353s
     0     0 4560.64051    0  407 -3929.3095 4560.64051   216%     -  353s
     0     0 4547.78463    0  522 -3929.3095 4547.78463   216%     -  358s
     0     0 4539.43983    0  398 -3929.3095 4539.43983   216%     -  360s
     0     0 4536.59482    0  524 -3929.3095 4536.59482   215%     -  360s
     0     0 4536.18836    0  524 -3929.3095 4536.18836   215%     -  361s
     0     0 4531.84644    0  411 -3929.3095 4531.84644   215%     -  363s
     0     0 4529.31121    0  462 -3929.3095 4529.31121   215%     -  365s
     0     0 4528.57414    0  467 -3929.3095 4528.57414   215%     -  365s
     0     0 4521.09978    0  408 -3929.3095 4521.09978   215%     -  368s
     0     0 4518.12022    0  415 -3929.3095 4518.12022   215%     -  369s
     0     0 4517.40184    0  410 -3929.3095 4517.40184   215%     -  370s
     0     0 4513.52293    0  412 -3929.3095 4513.52293   215%     -  372s
     0     0 4513.14216    0  412 -3929.3095 4513.14216   215%     -  373s
     0     0 4458.29942    0  460 -3929.3095 4458.29942   213%     -  379s
     0     0 4456.74632    0  460 -3929.3095 4456.74632   213%     -  380s
     0     0 4456.57112    0  458 -3929.3095 4456.57112   213%     -  381s
     0     0 4455.20435    0  469 -3929.3095 4455.20435   213%     -  382s
     0     0 4454.89251    0  468 -3929.3095 4454.89251   213%     -  384s
     0     0 4454.62761    0  466 -3929.3095 4454.62761   213%     -  385s
     0     0 4453.48549    0  470 -3929.3095 4453.48549   213%     -  387s
     0     0 4453.28694    0  469 -3929.3095 4453.28694   213%     -  388s
     0     0 4452.80665    0  469 -3929.3095 4452.80665   213%     -  391s
     0     2 4452.80665    0  469 -3929.3095 4452.80665   213%     -  453s
     1     4 4332.01996    1  453 -3929.3095 4452.80665   213%  2715  460s
     3     8 4279.52502    2  448 -3929.3095 4331.98163   210%  3260  470s
     7    16 4078.63441    3  463 -3929.3095 4279.41300   209%  4080  481s
    15    32 3861.24334    4  447 -3929.3095 4098.04410   204%  5292  492s
    31    50 -289.96658    5  163 -3929.3095 3860.97955   198%  7694  520s
    49    80 2934.96791    6  239 -3929.3095 3860.97955   198%  7461  537s
    81   144 2611.53955    7  283 -3929.3095 3860.97955   198%  6000  556s
   145   237 2520.68290    8  281 -3929.3095 3860.97955   198%  4060  572s
   242   300 2342.26837    9  277 -3929.3095 3860.97955   198%  3155  586s
   325   353 1917.03984   10  341 -3929.3095 3860.97955   198%  2783  599s
   413   364 2183.25630    9  272 -3929.3095 3860.97955   198%  2555  613s
   482   399 2154.98766    9  278 -3929.3095 3860.97955   198%  2447  626s
   557   430 2010.45154   10  278 -3929.3095 3860.97955   198%  2358  640s
   614   449 -2748.5578   18  302 -3929.3095 3860.97955   198%  2357  653s
   671   473 1423.92083   11  211 -3929.3095 3860.97955   198%  2331  667s
   729   499 1270.93015   12  265 -3929.3095 3860.97955   198%  2310  680s
   785   528 1022.82263   13  312 -3929.3095 3860.97955   198%  2320  692s
   830   563  731.52923   14  389 -3929.3095 3860.97955   198%  2326  706s
   885   591 -2132.5387   14  152 -3929.3095 3860.97955   198%  2345  719s
   941   618     cutoff   12      -3929.3095 3860.97955   198%  2345  732s
  1008   645  469.01861   15  389 -3929.3095 3860.97955   198%  2334  745s
  1057   692 infeasible   13      -3929.3095 3860.97955   198%  2329  756s
  1127   733  -53.53995   17  311 -3929.3095 3860.97955   198%  2297  769s
  1194   794 -2140.0371   17  418 -3929.3095 3860.97955   198%  2269  784s
  1277   870 -2623.5312   16  140 -3929.3095 3860.97955   198%  2234  800s
  1365   966  -60.39976   18  302 -3929.3095 3860.97955   198%  2214  815s
  1487  1045 -444.75324   20  316 -3929.3095 3860.97955   198%  2138  836s
  1632  1106 -3480.3109   21  275 -3929.3095 3860.97955   198%  2055  855s
  1752  1136 -691.86969   23  447 -3929.3095 3860.97955   198%  2029  871s
  1855  1174 -973.53959   24  398 -3929.3095 3568.49476   191%  1995  892s
  1961  1233 -1511.9263   26  312 -3929.3095 3568.49476   191%  2001  912s
  2065  1282 -2074.0182   28  247 -3929.3095 3568.49476   191%  1996  933s
  2158  1353 -2316.5031   30  250 -3929.3095 3568.49476   191%  1988  954s
  2288  1379 -2668.7949   31  296 -3929.3095 3333.13512   185%  1979  975s
  2337  1405 -3069.9626   32  257 -3929.3095 3333.13512   185%  1996  988s
  2373  1457 infeasible   32      -3929.3095 3327.19022   185%  2014 1003s
  2483  1480 -2904.8161   35  250 -3929.3095 3327.19022   185%  2000 1024s
  2588  1513 infeasible   10      -3929.3095 3210.94920   182%  2024 1047s
  2683  1581  348.15963   11  196 -3929.3095 3145.40444   180%  2041 1069s
  2811  1608 -3040.3186   18  112 -3929.3095 3067.01812   178%  2056 1094s
  2954  1679 -1236.6714   14  248 -3929.3095 3067.01812   178%  2066 1117s
  3063  1751 -2118.2210   16  208 -3929.3095 3067.01812   178%  2094 1140s
  3200  1819 -3548.9518   23  104 -3929.3095 2893.19522   174%  2108 1164s
  3361  1849 infeasible   41      -3929.3095 2849.43401   173%  2093 1188s
  3517  1889 infeasible   27      -3929.3095 2729.58133   169%  2105 1216s
  3675  1934 infeasible   10      -3929.3095 2729.58133   169%  2133 1242s
  3874  1981 infeasible   13      -3929.3095 2729.58133   169%  2148 1273s
  4055  2023 -3677.3316   23  236 -3929.3095 2387.06125   161%  2173 1303s
  4257  2081 -3474.3368   15  222 -3929.3095 2387.06125   161%  2190 1335s
  4461  2120 -1562.2627   16  327 -3929.3095 2308.24943   159%  2201 1366s
  4646  2190 -3437.5770   17  257 -3929.3095 2159.68850   155%  2207 1399s
  4842  2211 -1000.6865   19  307 -3929.3095 2091.76625   153%  2226 1430s
  4980  2255 -2352.4521   22  211 -3929.3095 2076.52475   153%  2265 1484s
  5206  2303 infeasible   16      -3929.3095 2001.64034   151%  2284 1541s
  5406  2359 -2671.4587   13  355 -3929.3095 2001.64034   151%  2311 1577s
  5668  2376 -3165.5945   14  416 -3929.3095 2001.64034   151%  2315 1616s
  5881  2420     cutoff   15      -3929.3095 1824.82229   146%  2331 1658s
  6177  2425 infeasible   11      -3929.3095 1775.21574   145%  2335 1689s
  6244  2469   74.69095   12  295 -3929.3095 1775.21574   145%  2346 1722s
  6368  2524 -252.79584   13  293 -3929.3095 1662.57384   142%  2348 1759s
  6611  2589 -2908.9146   18  286 -3929.3095 1627.19725   141%  2355 1807s
  6925  2646 infeasible   16      -3929.3095 1498.79037   138%  2363 1857s
  7238  2725 -2393.8194   32  264 -3929.3095 1200.74941   131%  2374 1907s
  7619  2726 -2706.8494   12  469 -3929.3095 1118.11751   128%  2373 1985s
  7621  2727 -3538.7581   19  339 -3929.3095 1118.11751   128%  2372 2045s
  7622  2728 -1502.6222    9  469 -3929.3095 1118.11751   128%  2372 2096s
  7623  2729 -1607.4736   31  440 -3929.3095 1118.11751   128%  2372 2121s
  7624  2729  957.22518   12  509 -3929.3095 1118.11751   128%  2371 2138s
  7625  2730  461.78809    8  505 -3929.3095 1118.11751   128%  2371 2148s
  7626  2731  748.29969   12  464 -3929.3095 1118.11751   128%  2371 2155s
  7627  2731 -2539.2819   17  474 -3929.3095 1118.11751   128%  2371 2162s
  7628  2732 -1659.4493   20  413 -3929.3095 1118.11751   128%  2370 2167s
  7630  2733 -1970.7433   16  424 -3929.3095 1118.11751   128%  2370 2174s
  7631  2734 -2585.5931   16  422 -3929.3095 1118.11751   128%  2369 2178s
  7632  2735 -1626.1007   16  435 -3929.3095 1118.11751   128%  2369 2182s
  7633  2735 -2963.4009   36  478 -3929.3095 1118.11751   128%  2369 2194s
  7634  2736 -436.13445    7  479 -3929.3095 1118.11751   128%  2368 2198s
  7635  2737 -2659.5218   30  484 -3929.3095 1118.11751   128%  2368 2202s
  7636  2737  697.39248   16  495 -3929.3095 1118.11751   128%  2368 2206s
  7637  2738  896.99472   14  533 -3929.3095 1118.11751   128%  2367 2218s
  7638  2739  -98.69036   15  525 -3929.3095 1118.11751   128%  2367 2221s
  7639  2739  739.04157   12  532 -3929.3095 1118.11751   128%  2367 2228s
  7640  2740 -1639.5885   24  451 -3929.3095 1118.11751   128%  2366 2239s
  7641  2741 -1202.0474   17  466 -3929.3095 1118.11751   128%  2366 2245s
  7642  2741 -1838.9626   19  482 -3929.3095 1118.11751   128%  2366 2255s
  7643  2742 -821.62067   11  487 -3929.3095 1118.11751   128%  2366 2260s
  7644  2743 -1564.2352   22  483 -3929.3095 1118.11751   128%  2365 2275s
  7645  2743  -49.74543   14  491 -3929.3095 1118.11751   128%  2365 2280s
  7646  2744 -2841.8723   21  413 -3929.3095 1118.11751   128%  2365 2290s
  7647  2745 -1715.9233   20  481 -3929.3095 1118.11751   128%  2364 2297s
  7648  2745 -1212.1847   10  413 -3929.3095 1118.11751   128%  2364 2308s
  7649  2746 -318.79812   11  413 -3929.3095 1118.11751   128%  2364 2366s
  7650  2747 -1821.6111   21  413 -3929.3095 1118.11751   128%  2363 2419s
  7651  2750 1118.11751   14  474 -3929.3095 1118.11751   128%  2387 2436s
  7653  2754 1118.11751   15  598 -3929.3095 1118.11751   128%  2388 2456s
  7657  2760 1118.11751   16  553 -3929.3095 1118.11751   128%  2389 2485s
  7665  2774 1118.11751   17  576 -3929.3095 1118.11751   128%  2394 2522s
  7681  2784 1118.11751   18  290 -3929.3095 1118.11751   128%  2414 2564s
  7697  2809  515.48278   19  356 -3929.3095 1118.11751   128%  2428 2588s
  7729  2875   53.66922   20  323 -3929.3095 1118.11751   128%  2441 2614s
  7840  2857 -848.89142   23  160 -3929.3095 1118.11751   128%  2450 2634s
  7919  2822 -2257.1261   22  265 -3929.3095 1118.11751   128%  2465 2653s
  7981  2801 -1115.3315   24  320 -3929.3095 1118.11751   128%  2491 2673s
  8020  2798 -1451.5812   24  161 -3929.3095 1118.11751   128%  2501 2693s
  8061  2783 -2231.1571   24  148 -3929.3095 1118.11751   128%  2510 2709s
  8095  2775 -2569.2789   25  135 -3929.3095 1118.11751   128%  2525 2731s
  8150  2756     cutoff   26      -3929.3095 1118.11751   128%  2537 2757s
  8188  2752 -1810.2594   25  148 -3929.3095 1118.11751   128%  2550 2777s
  8243  2734 -2163.1742   26  146 -3929.3095 1118.11751   128%  2573 2813s
  8318  2724 infeasible   27      -3929.3095 1118.11751   128%  2597 2833s
  8362  2717 -3113.9163   23  254 -3929.3095 1118.11751   128%  2637 2856s
  8410  2708     cutoff   23      -3929.3095 1118.11751   128%  2651 2876s
  8450  2696 -3284.7606   24  253 -3929.3095 1118.11751   128%  2660 2894s
  8504  2683     cutoff   25      -3929.3095 1118.11751   128%  2677 2913s
  8568  2671 -1660.5108   22  263 -3929.3095 1118.11751   128%  2698 2934s
  8634  2668 -1800.7141   23  248 -3929.3095 1118.11751   128%  2720 2955s
  8702  2653 -3019.9076   25  225 -3929.3095 1118.11751   128%  2737 2974s
  8777  2624     cutoff   26      -3929.3095 1118.11751   128%  2757 2995s
  8855  2608     cutoff   25      -3929.3095 1118.11751   128%  2770 3016s
  8927  2579 -2912.6758   25  332 -3929.3095 1118.11751   128%  2781 3039s
  9013  2556 -3512.9513   26  465 -3929.3095 1118.11751   128%  2791 3062s
  9094  2529 -3513.1566   27  462 -3929.3095 1118.11751   128%  2811 3086s
  9169  2496 infeasible   30      -3929.3095 1118.11751   128%  2831 3105s
  9257  2463 -2320.5096   22  372 -3929.3095 1118.11751   128%  2870 3127s
  9336  2443     cutoff   23      -3929.3095 1118.11751   128%  2894 3153s
  9419  2396 -1803.0721   25  258 -3929.3095  266.14847   107%  2923 3179s
  9498  2381 -1947.5868   26  255 -3929.3095  266.14847   107%  2955 3206s
  9611  2325 -2510.8750   29  197 -3929.3095  266.14847   107%  2988 3233s
  9719  2275 -2997.5090   31  211 -3929.3095  266.14847   107%  3019 3261s
  9881  2199 -3815.9012   22  168 -3929.3095 -555.58056  85.9%  3045 3289s
 10026  2112 -628.87321   24  329 -3929.3095 -563.95416  85.6%  3067 3316s
 10216  2050 -1294.6575   25  319 -3929.3095 -852.37643  78.3%  3089 3347s
 10398  1915 -2441.9465   27  280 -3929.3095 -1565.0621  60.2%  3104 3375s
 10611  1779     cutoff   28      -3929.3095 -2097.8665  46.6%  3117 3404s
 10743  1716 infeasible   25      -3929.3095 -2694.2487  31.4%  3122 3421s

Cutting planes:
  Learned: 2
  MIR: 493
  Flow cover: 1310
  Zero half: 1
  RLT: 14
  Relax-and-lift: 79

Explored 10787 nodes (33924094 simplex iterations) in 3421.83 seconds (5575.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -3929.31 -3946.94 -3953.51 ... -16817.5
No other solutions better than -3929.31

Optimal solution found (tolerance 1.00e-06)
Best objective -3.929309513250e+03, best bound -3.929309513250e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3421.87s
  Master Objective (UB) = -3929.31, θ = 123460.78
  Upper Bound (UB) = -3929.31

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 123460.78
  [DEBUG]   ✓ Scenario 0: θ = 123460.78 ≤ Q = 123460.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 123460.78 ≤ Q = 123460.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 123460.78 ≤ Q = 123460.78 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 123460.78 ≤ Q = 123460.78 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7a1b6a1c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x85e495e4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [5e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.404706e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6729016.5787
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.409317e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140931.66    0  125 6729016.58 -140931.66   102%     -    0s
H    0     0                    -107538.0200 -140931.66  31.1%     -    0s
H    0     0                    -107775.6475 -140931.66  30.8%     -    0s
     0     0 -112830.02    0   79 -107775.65 -112830.02  4.69%     -    0s
H    0     0                    -110348.5082 -112719.50  2.15%     -    0s
     0     0 -111743.26    0   82 -110348.51 -111743.26  1.26%     -    0s
     0     0 -111669.27    0   82 -110348.51 -111669.27  1.20%     -    0s
     0     0 -111525.99    0   83 -110348.51 -111525.99  1.07%     -    0s
     0     0 -111272.77    0   39 -110348.51 -111272.77  0.84%     -    0s
H    0     0                    -111060.6005 -111267.85  0.19%     -    0s
     0     0 -111228.32    0   34 -111060.60 -111228.32  0.15%     -    0s
     0     0 -111210.16    0   38 -111060.60 -111210.16  0.13%     -    0s
     0     0 -111113.82    0   22 -111060.60 -111113.82  0.05%     -    0s
     0     0 -111112.99    0   10 -111060.60 -111112.99  0.05%     -    0s
     0     0 -111106.83    0    8 -111060.60 -111106.83  0.04%     -    0s
     0     0 -111086.71    0    3 -111060.60 -111086.71  0.02%     -    0s
     0     0 -111086.71    0    5 -111060.60 -111086.71  0.02%     -    0s
     0     0 -111086.60    0    2 -111060.60 -111086.60  0.02%     -    0s
H    0     0                    -111086.4202 -111086.60  0.00%     -    0s

Cutting planes:
  MIR: 2

Explored 1 nodes (615 simplex iterations) in 0.16 seconds (0.04 work units)
Thread count was 32 (of 32 available processors)

Solution count 8: -111086 -111086 -111061 ... 1.40471e+13
No other solutions better than -111086

Optimal solution found (tolerance 1.00e-06)
Best objective -1.110864202188e+05, best bound -1.110864202188e+05, gap 0.0000%
  Subproblem solved in 0.20s
  Worst-case operational profit (Z_SP) = 122664.96
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -111086.42
  [DEBUG]   S×d_nominal = 233751.38
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233751.38 + -111086.42 = 122664.96
  [DEBUG]   Current θ from Master = 123460.78
  [DEBUG]   ⚠️  Z_SP ≤ θ by 795.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4725.13
  Lower Bound (LB) = -4725.13
  Gap (UB-LB) = 795.8163, Absolute Gap = 795.8163, Relative Gap = 0.202533
  Not converged yet (gap = 795.82 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394571 nonzeros
Model fingerprint: 0x51607c9d
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 64659 rows and 26259 columns
Presolve time: 2.76s
Presolved: 74334 rows, 32161 columns, 463034 nonzeros
Variable types: 29902 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -375121.6643
Found heuristic solution: objective -209054.8442

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 74334 rows, 32161 columns, 463034 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19456   -2.3135947e+05   0.000000e+00   4.463115e+06      5s
   37678   -6.6110822e+04   0.000000e+00   1.849558e+09     10s
   45564   -1.5677562e+04   0.000000e+00   1.357793e+07     15s
   52597   -1.0568908e+04   0.000000e+00   1.663487e+08     20s
   57767   -7.3002805e+03   0.000000e+00   4.261273e+08     25s
   62079   -6.2240515e+03   0.000000e+00   8.467985e+06     30s
   65878   -5.8198325e+03   0.000000e+00   3.008606e+07     35s
   69976   -3.9719917e+03   0.000000e+00   5.227863e+07     40s
   74998   -6.4860737e+02   0.000000e+00   3.127283e+07     45s
   78947    1.5938670e+03   0.000000e+00   4.724556e+06     50s
   82426    1.7903797e+03   0.000000e+00   6.175212e+06     55s
   86175    2.6073625e+03   0.000000e+00   1.171799e+06     60s
   90707    4.7547804e+03   0.000000e+00   3.886858e+07     65s
   95318    5.9716898e+03   0.000000e+00   1.539487e+07     70s
  100110    6.8966186e+03   0.000000e+00   7.115650e+05     75s
  103698    7.0501353e+03   0.000000e+00   6.681127e+06     80s
  107722    7.3626600e+03   0.000000e+00   5.350248e+06     85s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 1.428968e+04, 65003 iterations, 82.83 seconds (92.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14289.6776    0  339 -209054.84 14289.6776   107%     -   87s
H    0     0                    -197484.3705 14289.6776   107%     -   87s
H    0     0                    -33217.07746 14289.6776   143%     -   87s
H    0     0                    -22150.47543 14289.6776   165%     -   87s
H    0     0                    -22057.91306 14289.6776   165%     -   87s
H    0     0                    -21579.86311 14289.6776   166%     -   87s
H    0     0                    -19636.27182 14289.6776   173%     -   88s
H    0     0                    -4647.874676 14289.6776   407%     -   88s
H    0     0                    -4268.891398 14289.6776   435%     -   88s
H    0     0                    -4232.135629 14289.6776   438%     -   88s
H    0     0                    -4228.223400 14289.6776   438%     -   88s
H    0     0                    -4080.315598 14289.6776   450%     -   88s
H    0     0                    -4052.508705 14289.6776   453%     -   88s
H    0     0                    -4038.040359 14289.6776   454%     -   88s
H    0     0                    -4034.128129 14289.6776   454%     -   88s
     0     0 10974.6946    0  360 -4034.1281 10974.6946   372%     -  128s
     0     0 10368.1944    0  288 -4034.1281 10368.1944   357%     -  144s
     0     0 9977.32164    0  296 -4034.1281 9977.32164   347%     -  158s
     0     0 9944.88225    0  359 -4034.1281 9944.88225   347%     -  167s
     0     0 9944.88225    0  370 -4034.1281 9944.88225   347%     -  178s
     0     0 9944.88225    0  355 -4034.1281 9944.88225   347%     -  188s
H    0     0                    -4017.829206 9944.88225   348%     -  199s
H    0     0                    -4016.497124 9944.88225   348%     -  199s
     0     0 8377.12013    0  346 -4016.4971 8377.12013   309%     -  199s
     0     0 8377.12013    0  366 -4016.4971 8377.12013   309%     -  202s
     0     0 8377.12013    0  369 -4016.4971 8377.12013   309%     -  203s
     0     0 8377.12013    0  371 -4016.4971 8377.12013   309%     -  204s
     0     0 8377.12013    0  371 -4016.4971 8377.12013   309%     -  204s
     0     0 8377.12013    0  362 -4016.4971 8377.12013   309%     -  205s
     0     0 8377.12013    0  359 -4016.4971 8377.12013   309%     -  207s
     0     0 8377.12013    0  363 -4016.4971 8377.12013   309%     -  208s
     0     0 8377.12013    0  361 -4016.4971 8377.12013   309%     -  208s
     0     0 8377.12013    0  431 -4016.4971 8377.12013   309%     -  232s
     0     0 7748.67623    0  397 -4016.4971 7748.67623   293%     -  250s
     0     0 7651.45675    0  394 -4016.4971 7651.45675   291%     -  255s
     0     0 7615.29919    0  406 -4016.4971 7615.29919   290%     -  261s
     0     0 7603.61526    0  409 -4016.4971 7603.61526   289%     -  262s
     0     0 7574.99962    0  401 -4016.4971 7574.99962   289%     -  265s
     0     0 7571.64842    0  406 -4016.4971 7571.64842   289%     -  267s
     0     0 7512.21783    0  397 -4016.4971 7512.21783   287%     -  275s
     0     0 7491.63037    0  408 -4016.4971 7491.63037   287%     -  281s
     0     0 7489.19119    0  405 -4016.4971 7489.19119   286%     -  283s
     0     0 7488.24691    0  409 -4016.4971 7488.24691   286%     -  283s
     0     0 7468.30593    0  404 -4016.4971 7468.30593   286%     -  286s
     0     0 7458.28552    0  410 -4016.4971 7458.28552   286%     -  288s
     0     0 7457.74015    0  410 -4016.4971 7457.74015   286%     -  289s
     0     0 6469.95290    0  480 -4016.4971 6469.95290   261%     -  333s
H    0     0                    -4006.387557 6469.90769   261%     -  334s
     0     0 6105.94537    0  425 -4006.3876 6105.94537   252%     -  358s
     0     0 5897.03190    0  495 -4006.3876 5897.03190   247%     -  375s
     0     0 5853.88717    0  432 -4006.3876 5853.88717   246%     -  383s
     0     0 5831.44550    0  432 -4006.3876 5831.44550   246%     -  386s
     0     0 5826.59609    0  493 -4006.3876 5826.59609   245%     -  388s
     0     0 5815.25855    0  440 -4006.3876 5815.25855   245%     -  390s
     0     0 5812.28315    0  446 -4006.3876 5812.28315   245%     -  392s
     0     0 5809.81125    0  500 -4006.3876 5809.81125   245%     -  394s
     0     0 5802.96589    0  501 -4006.3876 5802.96589   245%     -  396s
     0     0 5800.85449    0  504 -4006.3876 5800.85449   245%     -  397s
     0     0 5800.48329    0  502 -4006.3876 5800.48329   245%     -  398s
     0     0 5323.96799    0  400 -4006.3876 5323.96799   233%     -  422s
     0     0 5180.33676    0  497 -4006.3876 5180.33676   229%     -  432s
     0     0 5072.36195    0  463 -4006.3876 5072.36195   227%     -  440s
     0     0 5041.72739    0  473 -4006.3876 5041.72739   226%     -  446s
     0     0 5020.37589    0  471 -4006.3876 5020.37589   225%     -  450s
     0     0 5006.63283    0  477 -4006.3876 5006.63283   225%     -  452s
     0     0 5000.69802    0  479 -4006.3876 5000.69802   225%     -  453s
     0     0 4999.07710    0  490 -4006.3876 4999.07710   225%     -  454s
     0     0 4991.53805    0  488 -4006.3876 4991.53805   225%     -  454s
     0     0 4989.18438    0  482 -4006.3876 4989.18438   225%     -  455s
     0     0 4988.81592    0  489 -4006.3876 4988.81592   225%     -  455s
     0     0 4915.60228    0  465 -4006.3876 4915.60228   223%     -  465s
     0     0 4907.19521    0  525 -4006.3876 4907.19521   222%     -  467s
     0     0 4848.23501    0  390 -4006.3876 4848.23501   221%     -  473s
     0     0 4824.00507    0  391 -4006.3876 4824.00507   220%     -  480s
     0     0 4815.80950    0  521 -4006.3876 4815.80950   220%     -  484s
     0     0 4810.83875    0  402 -4006.3876 4810.83875   220%     -  486s
     0     0 4809.50071    0  400 -4006.3876 4809.50071   220%     -  487s
     0     0 4808.83968    0  400 -4006.3876 4808.83968   220%     -  488s
     0     0 4770.78340    0  508 -4006.3876 4770.78340   219%     -  494s
     0     0 4750.35865    0  573 -4006.3876 4750.35865   219%     -  503s
     0     0 4740.20833    0  581 -4006.3876 4740.20833   218%     -  504s
     0     0 4730.45538    0  572 -4006.3876 4730.45538   218%     -  506s
     0     0 4726.85161    0  579 -4006.3876 4726.85161   218%     -  508s
     0     0 4725.68544    0  586 -4006.3876 4725.68544   218%     -  508s
     0     0 4725.55585    0  586 -4006.3876 4725.55585   218%     -  508s
     0     0 4696.21040    0  390 -4006.3876 4696.21040   217%     -  514s
     0     0 4687.76453    0  395 -4006.3876 4687.76453   217%     -  518s
     0     0 4683.94402    0  397 -4006.3876 4683.94402   217%     -  520s
     0     0 4683.30292    0  468 -4006.3876 4683.30292   217%     -  521s
     0     0 4675.19690    0  514 -4006.3876 4675.19690   217%     -  525s
H    0     0                    -4005.547456 4674.68766   217%     -  535s
     0     0 4671.23449    0  513 -4005.5475 4671.23449   217%     -  537s
     0     0 4669.51361    0  468 -4005.5475 4669.51361   217%     -  539s
     0     0 4668.85002    0  470 -4005.5475 4668.85002   217%     -  539s
     0     0 4665.72918    0  470 -4005.5475 4665.72918   216%     -  542s
     0     0 4664.76922    0  469 -4005.5475 4664.76922   216%     -  543s
     0     0 4661.37548    0  406 -4005.5475 4661.37548   216%     -  546s
     0     0 4660.54463    0  402 -4005.5475 4660.54463   216%     -  548s
     0     0 4649.42785    0  474 -4005.5475 4649.42785   216%     -  552s
     0     0 4646.66115    0  515 -4005.5475 4646.66115   216%     -  554s
     0     0 4646.13822    0  518 -4005.5475 4646.13822   216%     -  554s
     0     0 4645.25060    0  520 -4005.5475 4645.25060   216%     -  557s
     0     0 4645.05923    0  524 -4005.5475 4645.05923   216%     -  559s
     0     0 4642.58740    0  514 -4005.5475 4642.58740   216%     -  562s
     0     0 4642.42763    0  516 -4005.5475 4642.42763   216%     -  563s
     0     0 4642.05478    0  516 -4005.5475 4642.05478   216%     -  565s
     0     0 4641.88890    0  516 -4005.5475 4641.88890   216%     -  570s
     0     2 4641.81991    0  516 -4005.5475 4641.81991   216%     -  762s
     1     3 4354.79943    1  378 -4005.5475 4640.97023   216%  2745  770s
     2     6 3990.41889    2  355 -4005.5475 4640.97023   216%  4228  778s
     5    12 3582.82892    3  350 -4005.5475 4476.15507   212%  4190  790s
    11    24 3101.65277    4  325 -4005.5475 4272.30392   207%  5918  806s
    23    38 -202.67507    5  173 -4005.5475 4158.39205   204%  8435  836s
    37    70 3177.85165    5  293 -4005.5475 4158.36047   204%  8703  888s
    69   178 3151.27000    6  297 -4005.5475 3830.73988   196%  8257  911s
   181   267 2982.24246    8  281 -4005.5475 3830.49618   196%  4391  927s
   276   340 2971.10779    9  279 -4005.5475 3830.49618   196%  3648  939s
   371   376 2758.30606    9  270 -4005.5475 3830.49618   196%  3340  951s
   443   408 -3089.3735   24   67 -4005.5475 3830.49618   196%  3171  966s
   521   436 2571.48112   10  274 -4005.5475 3830.49618   196%  3049  979s
   583   465 2505.14679   10  271 -4005.5475 3830.49618   196%  3136  992s
   643   485     cutoff   15      -4005.5475 3830.49618   196%  3276 1003s
   699   510 -3308.5873   16  102 -4005.5475 3830.49618   196%  3268 1017s
   768   545 2115.75664   12  257 -4005.5475 3830.49618   196%  3237 1028s
   825   590 -1108.3937   13  165 -4005.5475 3830.49618   196%  3266 1042s
   901   621 1853.53571   13  262 -4005.5475 3830.49618   196%  3224 1055s
   980   656 -2056.5281   14  129 -4005.5475 3830.49618   196%  3244 1069s
  1057   696     cutoff   15      -4005.5475 3489.06548   187%  3282 1080s
  1118   716     cutoff   16      -4005.5475 3489.06548   187%  3301 1096s
  1158   742 infeasible   17      -4005.5475 3489.06548   187%  3361 1108s
  1202   765     cutoff   18      -4005.5475 3489.06548   187%  3367 1123s
  1249   807 2610.69937   12  410 -4005.5475 3489.06548   187%  3401 1138s
  1303   835  928.92618   21  344 -4005.5475 3489.06548   187%  3418 1152s
  1359   876  446.19610   22  319 -4005.5475 3489.06548   187%  3463 1168s
  1406   913  201.83134   23  313 -4005.5475 3489.06548   187%  3512 1182s
  1459   941   82.01682   24  381 -4005.5475 3489.06548   187%  3550 1196s
  1520   982 -151.29587   25  375 -4005.5475 3489.06548   187%  3591 1211s
  1599  1017 -336.64384   26  365 -4005.5475 3486.60239   187%  3599 1226s
  1675  1044 -768.41482   27  244 -4005.5475 3486.60239   187%  3646 1243s
  1748  1074     cutoff   28      -4005.5475 3486.60239   187%  3712 1261s
  1813  1108 -3757.9624   29  270 -4005.5475 3486.60239   187%  3778 1278s
  1887  1149 -3785.6087   30  210 -4005.5475 3486.60239   187%  3848 1295s
  1966  1185 -3813.8842   31  201 -4005.5475 3486.60239   187%  3907 1316s
  2069  1245 -369.92413   10  279 -4005.5475 3486.60239   187%  3924 1338s
  2177  1282 -1562.9416   12  155 -4005.5475 3353.43178   184%  3924 1358s
  2278  1310 -1949.8511   14  185 -4005.5475 3353.43178   184%  3908 1380s
  2328  1358 -2275.5195   16  181 -4005.5475 3353.43178   184%  3954 1401s
  2426  1423 -3850.1796   19  299 -4005.5475 3353.43178   184%  3935 1423s
  2533  1478     cutoff   21      -4005.5475 3195.44329   180%  3940 1447s
  2653  1519 1845.61086   12  372 -4005.5475 3195.44329   180%  3954 1473s
  2726  1618 -200.37028   13  241 -4005.5475 3195.44329   180%  3982 1496s
  2867  1719 -2553.9402   15   83 -4005.5475 3152.59227   179%  3988 1520s
  3073  1792 -3640.2951   28  334 -4005.5475 3152.59227   179%  3937 1546s
  3259  1871 -3894.4577   29  314 -4005.5475 3101.64673   177%  3925 1571s
  3397  1958 1289.94103    9  212 -4005.5475 3101.64673   177%  3976 1598s
  3556  2050     cutoff   11      -4005.5475 3101.64673   177%  3986 1630s
  3780  2126     cutoff   12      -4005.5475 3101.64673   177%  3951 1659s
  3993  2153  233.99117   10  234 -4005.5475 3101.64673   177%  3944 1680s
  4032  2198 -126.38414   11  218 -4005.5475 3101.64673   177%  3963 1711s
  4129  2309 -1316.6254   12  215 -4005.5475 3101.64673   177%  3951 1740s
  4312  2437 -2637.2356   13  176 -4005.5475 2893.07811   172%  3925 1771s
  4571  2438 -2912.0511   47  516 -4005.5475 2876.78542   172%  3889 1903s
  4573  2439 -3331.7035   24  339 -4005.5475 2876.78542   172%  3887 1961s
  4574  2440 -731.15220   16  451 -4005.5475 2876.78542   172%  3886 2038s
  4575  2441 -3498.7287   51  471 -4005.5475 2876.78542   172%  3885 2071s
  4576  2441 -2362.1112   28  487 -4005.5475 2876.78542   172%  3884 2093s
  4577  2442 -3075.5877   18  453 -4005.5475 2876.78542   172%  3884 2106s
  4578  2443 2058.59346   17  514 -4005.5475 2876.78542   172%  3883 2116s
  4579  2443 -1842.8020   27  511 -4005.5475 2876.78542   172%  3882 2126s
  4580  2444 1208.40107   11  388 -4005.5475 2876.78542   172%  3881 2133s
  4581  2445 -374.14005   10  513 -4005.5475 2876.78542   172%  3880 2150s
  4582  2445 -2940.2423   24  514 -4005.5475 2876.78542   172%  3879 2155s
  4584  2447 2525.02281    8  455 -4005.5475 2876.78542   172%  3878 2165s
  4586  2448  826.72679   26  468 -4005.5475 2876.78542   172%  3876 2174s
  4587  2449 -3593.7915   30  519 -4005.5475 2876.78542   172%  3875 2189s
  4588  2449 2325.03261    8  477 -4005.5475 2876.78542   172%  3874 2196s
  4589  2450 -1457.3344   22  516 -4005.5475 2876.78542   172%  3873 2200s
  4590  2451 -864.78435   16  561 -4005.5475 2876.78542   172%  3873 2207s
  4591  2451  333.08091   13  462 -4005.5475 2876.78542   172%  3872 2223s
  4592  2452 -1959.2388   16  459 -4005.5475 2876.78542   172%  3871 2228s
  4593  2453 -3755.0371   28  405 -4005.5475 2876.78542   172%  3870 2231s
  4594  2453 -3039.1785   18  472 -4005.5475 2876.78542   172%  3869 2235s
  4596  2455 -2969.7028   37  469 -4005.5475 2876.78542   172%  3867 2247s
  4597  2455 -353.74587    9  474 -4005.5475 2876.78542   172%  3867 2253s
  4598  2456 -847.78815   18  486 -4005.5475 2876.78542   172%  3866 2265s
  4599  2457 -3498.7287   51  520 -4005.5475 2876.78542   172%  3865 2272s
  4600  2457 -178.29354   11  530 -4005.5475 2876.78542   172%  3864 2288s
  4601  2458 -2534.9940   24  529 -4005.5475 2876.78542   172%  3863 2295s
  4602  2459 -3305.9649   32  499 -4005.5475 2876.78542   172%  3862 2312s
  4603  2459 -716.62664   17  538 -4005.5475 2876.78542   172%  3862 2318s
  4604  2460 -3334.6195   59  502 -4005.5475 2876.78542   172%  3861 2325s
  4605  2461 -3318.5995   17  503 -4005.5475 2876.78542   172%  3860 2336s
  4606  2461  463.54497   11  554 -4005.5475 2876.78542   172%  3859 2343s
  4607  2462 -2328.1859   26  424 -4005.5475 2876.78542   172%  3858 2350s
  4609  2463 -3354.4957   28  425 -4005.5475 2876.78542   172%  3857 2365s
  4610  2464 2428.33816   12  425 -4005.5475 2876.78542   172%  3856 2417s
  4611  2465 -2977.3035   28  425 -4005.5475 2876.78542   172%  3855 2451s
  4612  2468 2876.78542   13  537 -4005.5475 2876.78542   172%  3909 2480s
  4614  2472 2876.78542   14  414 -4005.5475 2876.78542   172%  3910 2523s
  4618  2478 2876.78542   15  472 -4005.5475 2876.78542   172%  3915 2566s
  4626  2492 2876.78542   16  543 -4005.5475 2876.78542   172%  3924 2599s
  4642  2506 -1845.3341   17  167 -4005.5475 2876.78542   172%  3959 2659s
  4662  2532 1714.99014   18  384 -4005.5475 2876.78542   172%  3990 2686s
  4694  2602 1227.10878   19  363 -4005.5475 2876.78542   172%  4000 2718s
  4805  2577  388.86147   22  365 -4005.5475 2876.78542   172%  3980 2746s
  4876  2569  -42.03878   21  541 -4005.5475 2876.78542   172%  3964 2783s
  4927  2573  209.16995   20  235 -4005.5475 2876.78542   172%  3968 2811s
  4969  2579  -83.72177   23  323 -4005.5475 2876.78542   172%  3971 2833s
  5016  2571 -1714.9986   23  412 -4005.5475 2876.78542   172%  4006 2866s
  5079  2559 -257.60562   24  351 -4005.5475 2876.78542   172%  3993 2895s
  5147  2539 -932.54273   24  256 -4005.5475 2876.78542   172%  3983 2927s
  5212  2520 -1286.9420   25  345 -4005.5475 2876.78542   172%  3964 2964s
  5277  2516     cutoff   26      -4005.5475 2876.78542   172%  3947 2988s
  5332  2504     cutoff   26      -4005.5475 2876.78542   172%  3946 3012s
  5394  2499 -3479.2754   23  456 -4005.5475 2876.78542   172%  3927 3036s
  5462  2492 -3759.5509   24  334 -4005.5475 2876.78542   172%  3910 3063s
  5518  2478     cutoff   24      -4005.5475 2876.78542   172%  3896 3086s
  5603  2467     cutoff   27      -4005.5475 2876.78542   172%  3876 3119s
  5664  2482 1954.94054   18  485 -4005.5475 2876.78542   172%  3868 3145s
  5759  2473 -3392.6880   33  202 -4005.5475 2876.78542   172%  3847 3175s
  5840  2446 -3405.1782   19  527 -4005.5475 2876.78542   172%  3830 3203s
  5948  2431 -3419.8976   20  386 -4005.5475 2876.78542   172%  3805 3230s
  6043  2429 -2778.3761   22  195 -4005.5475 2876.78542   172%  3789 3266s
  6131  2431 infeasible   26      -4005.5475 2876.78542   172%  3783 3293s
  6239  2400 -3210.1019   26  175 -4005.5475 2876.78542   172%  3766 3329s
  6360  2375 -3857.2779   31  173 -4005.5475 2876.78542   172%  3744 3369s
  6474  2333 -2008.3303   22  230 -4005.5475 1448.08111   136%  3725 3403s
  6604  2294     cutoff   23      -4005.5475 1334.98188   133%  3699 3431s
  6685  2279     cutoff   23      -4005.5475 1334.98188   133%  3690 3464s
  6778  2261     cutoff   24      -4005.5475  426.57411   111%  3678 3503s
  6874  2230 -1166.6723   21  454 -4005.5475  426.57411   111%  3671 3541s
  6995  2204     cutoff   23      -4005.5475  231.62984   106%  3666 3576s
  7112  2150     cutoff   23      -4005.5475  231.62984   106%  3656 3600s

Cutting planes:
  MIR: 771
  Mixing: 1
  Flow cover: 1906
  Zero half: 2
  RLT: 16
  Relax-and-lift: 95

Explored 7235 nodes (26548587 simplex iterations) in 3600.05 seconds (5470.69 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -4005.55 -4006.39 -4016.5 ... -4232.14

Time limit reached
Best objective -4.005547456244e+03, best bound -1.247049987396e+02, gap 96.8867%
  WARNING: Time limit reached. Using best solution found (gap: 96.89%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -4005.55, θ = 123384.54
  Upper Bound (UB) = -4005.55

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 123384.54
  [DEBUG]   ✓ Scenario 0: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 123384.54 ≤ Q = 123384.54 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1e201fcd
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1e201fcd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-01, 2e+02]
Found heuristic solution: objective 1.404706e+13
Presolve removed 2607 rows and 1900 columns
Presolve time: 0.01s
Presolved: 486 rows, 489 columns, 1370 nonzeros
Found heuristic solution: objective 6742467.2823
Variable types: 331 continuous, 158 integer (158 binary)

Root relaxation: objective -1.404719e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140471.85    0  125 6742467.28 -140471.85   102%     -    0s
H    0     0                    -107130.8943 -140471.85  31.1%     -    0s
H    0     0                    -107368.5219 -140471.85  30.8%     -    0s
     0     0 -111814.74    0   79 -107368.52 -111814.74  4.14%     -    0s
H    0     0                    -109161.6988 -111684.05  2.31%     -    0s
     0     0 -110680.99    0   82 -109161.70 -110680.99  1.39%     -    0s
     0     0 -110607.01    0   82 -109161.70 -110607.01  1.32%     -    0s
     0     0 -110533.87    0   82 -109161.70 -110533.87  1.26%     -    0s
     0     0 -110483.78    0   82 -109161.70 -110483.78  1.21%     -    0s
H    0     0                    -109195.4764 -110483.78  1.18%     -    0s
     0     2 -110483.78    0   82 -109195.48 -110483.78  1.18%     -    0s
H   31    45                    -109655.7731 -110147.92  0.45%  20.5    0s
*   47    36               5    -109919.5337 -110147.83  0.21%  17.6    0s
*  269     5              22    -109939.8115 -109939.81  0.00%   8.1    0s

Cutting planes:
  Gomory: 51
  Implied bound: 2
  MIR: 186
  BQP: 1

Explored 297 nodes (2772 simplex iterations) in 0.14 seconds (0.07 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -109940 -109920 -109656 ... 1.40471e+13
No other solutions better than -109940

Optimal solution found (tolerance 1.00e-06)
Best objective -1.099398115412e+05, best bound -1.099398115412e+05, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 123331.53
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109939.81
  [DEBUG]   S×d_nominal = 233271.34
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 233271.34 + -109939.81 = 123331.53
  [DEBUG]   Current θ from Master = 123384.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 53.01 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -4058.56
  Lower Bound (LB) = -4058.56
  Gap (UB-LB) = 53.0083, Absolute Gap = 53.0083, Relative Gap = 0.013234
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 9
Total Time: 15050.10s
Converged: True
Final Lower Bound: -4058.5558
Final Upper Bound: -4005.5475
Final Gap: 53.008335
Number of Critical Scenarios: 9
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [0] (1/3)
Total Plant Openings: 3
DCs Opened: [5, 8, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 7 customers  Mode 2: 43 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 9
Start Time: 2026-01-03 09:45:25
End Time: 2026-01-03 13:56:15
Total Time: 15050.10s
Optimal Value: -4058.56
Lower Bound: -4058.56
Upper Bound: -4005.55
Gap: 53.008335
Plants Opened: {0: [1], 1: [0], 2: [0]} (3 plants)
DCs Opened: [5, 8, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed12_Mixed_gamma20_20260103_135615.csv

Total Execution Time: 15051.51 seconds
End Time: 2026-01-03 13:56:16

All tasks completed successfully!

