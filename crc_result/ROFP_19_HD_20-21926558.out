
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 19
DI Scenario: HD
Start Time: 2026-01-03 10:17:46
================================================================================
Loading data from data/DH_data_full_seed19.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
  Product 1: ['1.000', '1.331', '1.773'] (k=0.706)
  Product 2: ['1.000', '1.311', '1.720'] (k=0.669)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=927, max=1790
  DC capacity (MC): min=401, max=818

Demand Structure (s_rk matrix):
  Total customer-product pairs: 78/150 (48.0% sparse)
  Average products per customer: 1.56

Demand (only non-zero entries):
  Nominal (μ): min=8.20, max=34.38, count=78
  Deviation (μ̂): min=4.15, max=10.00

Costs:
  Plant fixed cost: min=5642, max=9474
  DC fixed cost: min=3448, max=5966
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
    Product 1: ['1.000', '1.331', '1.773'] (k=0.706)
    Product 2: ['1.000', '1.311', '1.720'] (k=0.669)
  MD:
    Product 0: ['1.000', '1.286', '1.654'] (k=0.620)
    Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
    Product 2: ['1.000', '1.177', '1.385'] (k=0.402)
  LD:
    Product 0: ['1.000', '1.042', '1.086'] (k=0.102)
    Product 1: ['1.000', '1.040', '1.081'] (k=0.096)
    Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
  Mixed:
    Product 0: ['1.000', '1.369', '1.874'] (k=0.775)
    Product 1: ['1.000', '1.273', '1.620'] (k=0.595)
    Product 2: ['1.000', '1.028', '1.058'] (k=0.069)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48744 nonzeros
Model fingerprint: 0xad1d880e
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11953 rows and 2953 columns
Presolve time: 0.08s
Presolved: 4720 rows, 5547 columns, 32846 nonzeros
Variable types: 3288 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -285806.1604
Found heuristic solution: objective -185609.9094

Root relaxation: objective 1.215797e+05, 5001 iterations, 0.20 seconds (0.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 121579.749    0  530 -185609.91 121579.749   166%     -    0s
H    0     0                    -175745.6407 121579.749   169%     -    0s
     0     0 107609.965    0  750 -175745.64 107609.965   161%     -    0s
     0     0 107456.006    0  769 -175745.64 107456.006   161%     -    1s
     0     0 107444.369    0  769 -175745.64 107444.369   161%     -    1s
     0     0 107444.133    0  771 -175745.64 107444.133   161%     -    1s
H    0     0                    -150803.5465 98103.7859   165%     -    2s
     0     0 98103.7859    0  834 -150803.55 98103.7859   165%     -    2s
     0     0 97771.4336    0  851 -150803.55 97771.4336   165%     -    2s
     0     0 97738.5716    0  857 -150803.55 97738.5716   165%     -    2s
     0     0 97733.8628    0  873 -150803.55 97733.8628   165%     -    2s
     0     0 91228.4114    0  797 -150803.55 91228.4114   160%     -    3s
     0     0 90796.4428    0  877 -150803.55 90796.4428   160%     -    3s
     0     0 90705.7865    0  881 -150803.55 90705.7865   160%     -    3s
     0     0 90698.9070    0  879 -150803.55 90698.9070   160%     -    3s
H    0     0                    -147491.4005 90698.9070   161%     -    4s
H    0     0                    -147381.0853 90698.9070   162%     -    4s
H    0     0                    5952.5800041 90698.9070  1424%     -    4s
H    0     0                    5954.1882928 81304.5676  1266%     -    5s
H    0     0                    7023.8903639 81304.5676  1058%     -    5s
H    0     0                    7137.8036436 81304.5676  1039%     -    5s
H    0     0                    7580.2261118 81304.5676   973%     -    5s
H    0     0                    8037.3569248 81304.5676   912%     -    5s
H    0     0                    8344.1669291 81304.5676   874%     -    5s
H    0     0                    8545.5442401 81304.5676   851%     -    5s
H    0     0                    8880.9299223 81304.5676   815%     -    5s
     0     0 81304.5676    0  576 8880.92992 81304.5676   815%     -    5s
H    0     0                    8918.9457572 80451.7922   802%     -    5s
H    0     0                    8922.3972861 80451.7922   802%     -    5s
H    0     0                    9055.3747115 80451.7922   788%     -    5s
H    0     0                    9097.9461141 80451.7922   784%     -    5s
H    0     0                    9512.8892866 80451.7922   746%     -    5s
H    0     0                    14074.774599 80451.7922   472%     -    5s
H    0     0                    14187.411101 80451.7922   467%     -    5s
H    0     0                    14560.692370 80451.7922   453%     -    5s
H    0     0                    14807.916074 80451.7922   443%     -    5s
H    0     0                    15548.143339 80451.7922   417%     -    5s
H    0     0                    15551.274099 80451.7922   417%     -    5s
H    0     0                    15788.158771 80451.7922   410%     -    5s
     0     0 80451.7922    0  590 15788.1588 80451.7922   410%     -    5s
H    0     0                    15831.069146 80215.6022   407%     -    5s
H    0     0                    16170.719619 80215.6022   396%     -    5s
H    0     0                    16177.706133 80215.6022   396%     -    5s
H    0     0                    16273.690603 80215.6022   393%     -    5s
     0     0 80215.6022    0  649 16273.6906 80215.6022   393%     -    5s
     0     0 80175.6322    0  712 16273.6906 80175.6322   393%     -    5s
     0     0 80156.4750    0  668 16273.6906 80156.4750   393%     -    5s
     0     0 80153.2643    0  670 16273.6906 80153.2643   393%     -    5s
     0     0 77412.8038    0  661 16273.6906 77412.8038   376%     -    6s
     0     0 76915.1835    0  708 16273.6906 76915.1835   373%     -    6s
H    0     0                    16405.233805 76740.6879   368%     -    6s
H    0     0                    16405.235574 76740.6879   368%     -    6s
H    0     0                    16509.953768 76740.6879   365%     -    6s
H    0     0                    16574.580080 76740.6879   363%     -    6s
     0     0 76740.6879    0  694 16574.5801 76740.6879   363%     -    6s
     0     0 76695.3892    0  722 16574.5801 76695.3892   363%     -    6s
     0     0 76682.6943    0  711 16574.5801 76682.6943   363%     -    6s
H    0     0                    28775.142012 75063.0608   161%     -    7s
     0     0 75063.0608    0  736 28775.1420 75063.0608   161%     -    7s
     0     0 74531.9819    0  804 28775.1420 74531.9819   159%     -    7s
     0     0 74409.7832    0  837 28775.1420 74409.7832   159%     -    8s
     0     0 74378.2293    0  812 28775.1420 74378.2293   158%     -    8s
     0     0 74360.3864    0  893 28775.1420 74360.3864   158%     -    8s
H    0     0                    30019.919945 72914.0693   143%     -    9s
H    0     0                    31577.505461 72914.0693   131%     -    9s
H    0     0                    32740.627540 72914.0693   123%     -    9s
H    0     0                    33623.252088 72914.0693   117%     -    9s
H    0     0                    33708.229803 72914.0693   116%     -    9s
H    0     0                    33862.282286 72914.0693   115%     -    9s
     0     0 72914.0693    0  802 33862.2823 72914.0693   115%     -    9s
     0     0 72689.3258    0  784 33862.2823 72689.3258   115%     -    9s
     0     0 72626.2181    0  862 33862.2823 72626.2181   114%     -    9s
     0     0 72584.8557    0  875 33862.2823 72584.8557   114%     -    9s
H    0     0                    34602.443094 72570.3522   110%     -    9s
H    0     0                    34624.674858 72570.3522   110%     -    9s
H    0     0                    38002.740664 72570.3522  91.0%     -    9s
H    0     0                    38988.896423 72570.3522  86.1%     -    9s
H    0     0                    39538.887924 72570.3522  83.5%     -    9s
H    0     0                    39844.331586 72570.3522  82.1%     -    9s
H    0     0                    39859.475520 72570.3522  82.1%     -    9s
     0     0 72570.3522    0  868 39859.4755 72570.3522  82.1%     -    9s
H    0     0                    39976.587077 72570.3522  81.5%     -    9s
H    0     0                    40056.808109 71649.9372  78.9%     -   10s
     0     0 71649.9372    0  740 40056.8081 71649.9372  78.9%     -   10s
     0     0 71468.0388    0  780 40056.8081 71468.0388  78.4%     -   10s
     0     0 71407.9525    0  814 40056.8081 71407.9525  78.3%     -   11s
     0     0 71382.6749    0  823 40056.8081 71382.6749  78.2%     -   11s
     0     0 70721.6863    0  816 40056.8081 70721.6863  76.6%     -   11s
     0     0 70535.1729    0  800 40056.8081 70535.1729  76.1%     -   12s
     0     0 70482.0936    0  808 40056.8081 70482.0936  76.0%     -   12s
     0     0 70450.1846    0  838 40056.8081 70450.1846  75.9%     -   12s
H    0     0                    40106.197821 69906.7995  74.3%     -   13s
H    0     0                    40195.736578 69906.7995  73.9%     -   13s
H    0     0                    40278.425027 69906.7995  73.6%     -   13s
     0     0 69906.7995    0  819 40278.4250 69906.7995  73.6%     -   13s
     0     0 69757.7258    0  848 40278.4250 69757.7258  73.2%     -   13s
     0     0 69713.8299    0  883 40278.4250 69713.8299  73.1%     -   14s
     0     0 69695.8796    0  863 40278.4250 69695.8796  73.0%     -   14s
H    0     0                    40346.963475 69330.9975  71.8%     -   14s
H    0     0                    40350.388079 69330.9975  71.8%     -   14s
H    0     0                    40473.307385 69330.9975  71.3%     -   14s
H    0     0                    40517.992481 69330.9975  71.1%     -   14s
     0     0 69330.9975    0  825 40517.9925 69330.9975  71.1%     -   14s
     0     0 69207.6326    0  848 40517.9925 69207.6326  70.8%     -   15s
     0     0 69168.8403    0  857 40517.9925 69168.8403  70.7%     -   15s
H    0     0                    40633.035587 68857.0519  69.5%     -   15s
H    0     0                    40641.195759 68857.0519  69.4%     -   15s
     0     0 68857.0519    0  625 40641.1958 68857.0519  69.4%     -   15s
     0     0 68737.9103    0  718 40641.1958 68737.9103  69.1%     -   16s
     0     0 68698.3505    0  666 40641.1958 68698.3505  69.0%     -   16s
H    0     0                    40647.732975 68484.0455  68.5%     -   16s
H    0     0                    40668.769559 68484.0455  68.4%     -   16s
     0     0 68484.0455    0  757 40668.7696 68484.0455  68.4%     -   16s
     0     0 68483.9116    0  757 40668.7696 68483.9116  68.4%     -   16s
     0     2 68479.9449    0  757 40668.7696 68479.9449  68.4%     -   18s
     7    16 66741.5754    3  593 40668.7696 68107.4348  67.5%  2199   20s
H   95   182                    40783.366232 67064.5503  64.4%  1731   25s
H  113   182                    40824.922165 67064.5503  64.3%  1707   25s
H  161   182                    40841.468121 67064.5503  64.2%  1469   25s
H  306   322                    53390.157168 67064.5503  25.6%  1236   26s
H  483   458                    53572.069665 67064.5503  25.2%  1018   28s
H  498   458                    53700.279415 67064.5503  24.9%  1012   28s
   718   719 60525.4827   20  493 53700.2794 67051.4418  24.9%   825   30s
H 1342  1264                    54072.224929 66935.0385  23.8%   611   32s
  1763  1712 58841.8321   42  379 54072.2249 66935.0385  23.8%   538   35s
H 2017  1851                    54082.111771 66746.0975  23.4%   508   36s
  2514  2037 58258.0550   11  418 54082.1118 66500.1988  23.0%   528   40s
  3068  2250 56327.8603   10  499 54082.1118 65319.3889  20.8%   566   45s
  3718  2565 58887.6891    9  480 54082.1118 64791.3710  19.8%   578   50s
  4521  2818 54728.1705   13  432 54082.1118 64175.3284  18.7%   602   55s
  5366  2978 61086.3926    8  350 54082.1118 63673.1950  17.7%   609   60s
  6273  3226 54788.3920   12  442 54082.1118 63475.5702  17.4%   622   65s
  6591  3227 59769.8295   12  757 54082.1118 63273.2299  17.0%   617   73s
  6596  3230 61882.4290   22  379 54082.1118 63273.2299  17.0%   617   75s
  6689  3251 57037.4193   16  289 54082.1118 57626.7314  6.55%   616   80s

Cutting planes:
  Gomory: 1
  Implied bound: 4
  Projected implied bound: 11
  MIR: 87
  Flow cover: 290
  RLT: 4
  Relax-and-lift: 45
  BQP: 1

Explored 6990 nodes (4214017 simplex iterations) in 80.99 seconds (185.25 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 54082.1 54072.2 53700.3 ... 40647.7

Optimal solution found (tolerance 1.00e-06)
Best objective 5.408211177085e+04, best bound 5.408211177085e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 80.99s
  Master Objective (UB) = 54082.11, θ = 200067.61
  Upper Bound (UB) = 54082.11

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 200067.61
  [DEBUG]   ✓ Scenario 0: θ = 200067.61 ≤ Q = 200067.61 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7bd3a2d0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x842c5d30
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.404567e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 6431856.2739
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.603244e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160324.45    0  121 6431856.27 -160324.45   102%     -    0s
H    0     0                    -126811.4546 -160324.45  26.4%     -    0s
H    0     0                    -127360.5272 -160324.45  25.9%     -    0s
H    0     0                    -128658.4409 -128658.44  0.00%     -    0s
     0     0          -    0      -128658.44 -128658.44  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 199

Explored 1 nodes (350 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -128658 -127361 -126811 ... 1.40457e+13
No other solutions better than -128658

Optimal solution found (tolerance 1.00e-06)
Best objective -1.286584409435e+05, best bound -1.286584409435e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 169763.97
  Scenario: 0 demand increases, 59 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128658.44
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -128658.44 = 169763.97
  [DEBUG]   Current θ from Master = 200067.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 30303.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23778.48
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 30303.6343, Absolute Gap = 30303.6343, Relative Gap = 0.560326
  Not converged yet (gap = 30303.63 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 59 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91969 nonzeros
Model fingerprint: 0xe6c597d9
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 23778.5 (0.01s)
MIP start from previous solve produced solution with objective 23778.5 (0.01s)
Loaded MIP start from previous solve with objective 23778.5

Presolve removed 14605 rows and 5924 columns
Presolve time: 0.31s
Presolved: 17358 rows, 8816 columns, 95998 nonzeros
Variable types: 6557 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.087165e+04, 9988 iterations, 1.21 seconds (2.28 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 60871.6503    0  356 23778.4775 60871.6503   156%     -    1s
H    0     0                    23909.159764 60871.6503   155%     -    1s
     0     0 54500.7646    0  386 23909.1598 54500.7646   128%     -    2s
     0     0 54230.5935    0  358 23909.1598 54230.5935   127%     -    2s
     0     0 54217.7524    0  358 23909.1598 54217.7524   127%     -    3s
     0     0 54202.0445    0  364 23909.1598 54202.0445   127%     -    3s
     0     0 49568.9509    0  474 23909.1598 49568.9509   107%     -    4s
H    0     0                    23962.027349 49568.1949   107%     -    4s
H    0     0                    24010.730527 48300.0914   101%     -    4s
H    0     0                    24064.807958 48300.0914   101%     -    4s
     0     0 48300.0914    0  535 24064.8080 48300.0914   101%     -    4s
     0     0 48202.5733    0  544 24064.8080 48202.5733   100%     -    4s
     0     0 48189.6429    0  546 24064.8080 48189.6429   100%     -    4s
     0     0 48185.2945    0  542 24064.8080 48185.2945   100%     -    5s
     0     0 48185.2545    0  545 24064.8080 48185.2545   100%     -    5s
     0     0 44909.7900    0  434 24064.8080 44909.7900  86.6%     -    6s
     0     0 44243.3280    0  511 24064.8080 44243.3280  83.9%     -    7s
     0     0 44103.7202    0  532 24064.8080 44103.7202  83.3%     -    7s
     0     0 44072.1769    0  511 24064.8080 44072.1769  83.1%     -    8s
     0     0 44063.7294    0  519 24064.8080 44063.7294  83.1%     -    8s
     0     0 44058.6812    0  531 24064.8080 44058.6812  83.1%     -    8s
     0     0 44057.8937    0  527 24064.8080 44057.8937  83.1%     -    8s
     0     0 42216.6247    0  517 24064.8080 42216.6247  75.4%     -   10s
     0     0 41802.2102    0  543 24064.8080 41802.2102  73.7%     -   11s
     0     0 41689.2156    0  554 24064.8080 41689.2156  73.2%     -   11s
     0     0 41662.8687    0  560 24064.8080 41662.8687  73.1%     -   11s
     0     0 41645.1676    0  565 24064.8080 41645.1676  73.1%     -   11s
     0     0 41636.7003    0  570 24064.8080 41636.7003  73.0%     -   11s
     0     0 41635.6275    0  571 24064.8080 41635.6275  73.0%     -   11s
     0     0 40849.7440    0  527 24064.8080 40849.7440  69.7%     -   13s
     0     0 40744.0211    0  475 24064.8080 40744.0211  69.3%     -   13s
     0     0 40688.3176    0  527 24064.8080 40688.3176  69.1%     -   13s
     0     0 40678.0080    0  537 24064.8080 40678.0080  69.0%     -   14s
     0     0 40675.9578    0  531 24064.8080 40675.9578  69.0%     -   14s
     0     0 40400.8477    0  562 24064.8080 40400.8477  67.9%     -   15s
H    0     0                    24243.835171 40390.8420  66.6%     -   15s
     0     0 40318.2650    0  615 24243.8352 40318.2650  66.3%     -   16s
     0     0 40293.5865    0  617 24243.8352 40293.5865  66.2%     -   16s
     0     0 40290.4515    0  617 24243.8352 40290.4515  66.2%     -   16s
     0     0 40140.6313    0  499 24243.8352 40140.6313  65.6%     -   17s
     0     0 40104.1581    0  443 24243.8352 40104.1581  65.4%     -   17s
     0     0 40100.1014    0  440 24243.8352 40100.1014  65.4%     -   17s
     0     0 40016.9981    0  493 24243.8352 40016.9981  65.1%     -   18s
     0     0 39997.3627    0  507 24243.8352 39997.3627  65.0%     -   18s
     0     0 39991.3802    0  508 24243.8352 39991.3802  65.0%     -   18s
H    0     0                    24824.003900 39991.3802  61.1%     -   18s
H    0     0                    25029.591638 39991.3802  59.8%     -   18s
H    0     0                    25375.932726 39889.9768  57.2%     -   19s
H    0     0                    25400.619217 39889.9768  57.0%     -   19s
     0     0 39889.9768    0  487 25400.6192 39889.9768  57.0%     -   19s
H    0     0                    25514.565718 39887.1601  56.3%     -   19s
     0     0 39824.1170    0  507 25514.5657 39824.1170  56.1%     -   19s
     0     0 39810.9255    0  480 25514.5657 39810.9255  56.0%     -   19s
     0     0 39806.8261    0  484 25514.5657 39806.8261  56.0%     -   19s
     0     0 39761.7753    0  577 25514.5657 39761.7753  55.8%     -   20s
H    0     0                    25771.725109 39747.4403  54.2%     -   20s
H    0     0                    25872.133634 39747.4403  53.6%     -   20s
H    0     0                    25901.675898 39747.4403  53.5%     -   20s
     0     0 39747.4403    0  493 25901.6759 39747.4403  53.5%     -   20s
     0     0 39744.5534    0  500 25901.6759 39744.5534  53.4%     -   20s
     0     0 39731.8901    0  513 25901.6759 39731.8901  53.4%     -   21s
     0     0 39729.4553    0  516 25901.6759 39729.4553  53.4%     -   21s
     0     0 39715.7959    0  517 25901.6759 39715.7959  53.3%     -   21s
     0     0 39714.6790    0  510 25901.6759 39714.6790  53.3%     -   22s
     0     0 39710.2517    0  522 25901.6759 39710.2517  53.3%     -   22s
     0     0 39709.6779    0  522 25901.6759 39709.6779  53.3%     -   22s
H    0     0                    26157.355665 39705.1308  51.8%     -   25s
H    0     0                    26167.537662 39705.1308  51.7%     -   25s
     0     2 39705.1308    0  522 26167.5377 39705.1308  51.7%     -   25s
H   38    62                    26193.643854 38768.4820  48.0%  1223   29s
    63    94 37209.4211    6  403 26193.6439 37859.0528  44.5%  1165   30s
H  128   178                    26244.601506 37820.8343  44.1%   931   32s
H  180   210                    26852.367294 37820.8343  40.8%   778   32s
H  206   210                    27139.244176 37820.8343  39.4%   721   32s
   400   426 35641.2060   14  360 27139.2442 37820.8343  39.4%   607   36s
   689   600 32155.4629   18  292 27139.2442 37519.7912  38.2%   582   40s
H  979   828                    27157.358640 37208.9120  37.0%   510   41s
  1471  1079 33837.9553    9  365 27157.3586 36856.1321  35.7%   419   45s
H 1536  1079                    27254.046042 36849.5567  35.2%   417   45s
  2144  1521 28991.6479   24  235 27254.0460 36727.0346  34.8%   372   50s
H 2145  1521                    27303.927044 36727.0346  34.5%   372   50s
H 2151  1521                    27461.303621 36727.0346  33.7%   372   50s
  2749  1910 28343.5823    8  262 27461.3036 36509.6008  32.9%   349   55s
H 3088  1984                    27463.592472 36476.6479  32.8%   349   57s
  3460  2124     cutoff    9      27463.5925 36217.2537  31.9%   350   60s
  4032  2216 31600.4714   11  250 27463.5925 35920.7589  30.8%   351   65s
H 4357  2252                    27563.025580 35714.7808  29.6%   357   68s
  4664  2398 29990.0706   13  362 27563.0256 35631.9128  29.3%   361   71s
  5354  2517 30655.5189   11  326 27563.0256 35346.9970  28.2%   364   75s
H 5361  2513                    27592.155570 35346.9970  28.1%   365   75s
  5738  2655 30348.5510   14  211 27592.1556 35134.2079  27.3%   368   80s
  6476  2757 31514.3583   15  293 27592.1556 34627.1514  25.5%   376   85s
H 6714  2736                    27737.440982 34627.1514  24.8%   377   87s
H 7054  2799                    27906.036841 34486.2011  23.6%   378   90s
  7055  2800 29480.5760   20  522 27906.0368 34486.2011  23.6%   378   97s
  7058  2802 30690.1589   15  342 27906.0368 34486.2011  23.6%   377  100s
  7070  2810 28339.0371   20  438 27906.0368 34486.2011  23.6%   377  105s
  7081  2817 28942.4526   46  474 27906.0368 34486.2011  23.6%   376  111s
H 7081  2675                    27906.779743 34486.2011  23.6%   376  112s
H 7081  2541                    27929.598195 34486.2011  23.5%   376  112s
H 7081  2413                    27937.233737 34486.2011  23.4%   376  113s
  7083  2418 33730.1345   12  378 27937.2337 34486.2011  23.4%   381  115s
  7161  2476     cutoff   18      27937.2337 33522.7639  20.0%   386  120s
  7630  2397 29083.8556   21  309 27937.2337 32497.8759  16.3%   386  125s
H 7693  2255                    27957.116363 32497.8759  16.2%   386  125s
H 7848  2078                    27990.413099 32497.8759  16.1%   384  127s
  8110  1945     cutoff   26      27990.4131 30545.9087  9.13%   379  130s

Cutting planes:
  Learned: 1
  Lift-and-project: 1
  MIR: 139
  Mixing: 1
  Flow cover: 382
  RLT: 7
  Relax-and-lift: 40

Explored 8734 nodes (3190918 simplex iterations) in 132.71 seconds (335.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27990.4 27957.1 27937.2 ... 27463.6

Optimal solution found (tolerance 1.00e-06)
Best objective 2.799041309917e+04, best bound 2.799041309917e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 132.71s
  Master Objective (UB) = 27990.41, θ = 169246.70
  Upper Bound (UB) = 27990.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169246.70
  [DEBUG]   ✓ Scenario 0: θ = 169246.70 ≤ Q = 169246.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169246.70 ≤ Q = 169246.70 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x435d7ad8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x435d7ad8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.260047e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5820088.6102
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.612383e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161238.32    0  122 5820088.61 -161238.32   103%     -    0s
H    0     0                    -127417.8657 -161238.32  26.5%     -    0s
H    0     0                    -127845.6886 -161238.32  26.1%     -    0s
H    0     0                    -142211.7250 -161238.32  13.4%     -    0s
H    0     0                    -142253.9910 -150406.94  5.73%     -    0s
     0     0 -150406.94    0   82 -142253.99 -150406.94  5.73%     -    0s
H    0     0                    -147948.2349 -150393.86  1.65%     -    0s
H    0     0                    -148320.1282 -150393.86  1.40%     -    0s
H    0     0                    -148331.3927 -150393.86  1.39%     -    0s
H    0     0                    -148703.2860 -150393.86  1.14%     -    0s
     0     0 -150235.76    0   84 -148703.29 -150235.76  1.03%     -    0s
     0     0 -150223.71    0   84 -148703.29 -150223.71  1.02%     -    0s
     0     0 -149086.36    0   37 -148703.29 -149086.36  0.26%     -    0s
     0     0 -149078.13    0   35 -148703.29 -149078.13  0.25%     -    0s
     0     0 -149060.69    0   33 -148703.29 -149060.69  0.24%     -    0s
     0     0 -149058.90    0   31 -148703.29 -149058.90  0.24%     -    0s
     0     0 -148907.81    0    9 -148703.29 -148907.81  0.14%     -    0s
     0     0 -148878.88    0    5 -148703.29 -148878.88  0.12%     -    0s
     0     0 -148878.88    0   38 -148703.29 -148878.88  0.12%     -    0s
H    0     0                    -148762.5859 -148878.88  0.08%     -    0s
H    0     0                    -148818.0489 -148818.05  0.00%     -    0s
     0     0          -    0      -148818.05 -148818.05  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 4
  MIR: 16
  Flow cover: 12
  RLT: 2

Explored 1 nodes (733 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -148818 -148763 -148703 ... 5.82009e+06
No other solutions better than -148818

Optimal solution found (tolerance 1.00e-06)
Best objective -1.488180489250e+05, best bound -1.488180489250e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 146842.19
  Scenario: 39 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148818.05
  [DEBUG]   S×d_nominal = 295660.24
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 295660.24 + -148818.05 = 146842.19
  [DEBUG]   Current θ from Master = 169246.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22404.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5585.90
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 4211.9356, Absolute Gap = 4211.9356, Relative Gap = 0.150478
  Not converged yet (gap = 4211.94 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 20 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135194 nonzeros
Model fingerprint: 0xa5fae4e8
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 5585.9 (0.02s)
MIP start from previous solve produced solution with objective 5585.9 (0.02s)
Loaded MIP start from previous solve with objective 5585.9

Presolve removed 21876 rows and 8876 columns
Presolve time: 0.40s
Presolved: 25377 rows, 12104 columns, 141859 nonzeros
Variable types: 9845 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.11s

Solved with dual simplex

Root relaxation: objective 5.957188e+04, 16692 iterations, 2.86 seconds (5.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 59571.8773    0  349 5585.90075 59571.8773   966%     -    3s
H    0     0                    18970.721691 59571.8773   214%     -    3s
H    0     0                    23847.589532 59571.8773   150%     -    3s
H    0     0                    23875.130526 59571.8773   150%     -    3s
H    0     0                    24013.363682 59571.8773   148%     -    3s
H    0     0                    24185.707683 59571.8773   146%     -    4s
H    0     0                    24361.001800 59571.8773   145%     -    4s
     0     0 53480.8742    0  399 24361.0018 53480.8742   120%     -    5s
H    0     0                    24513.851721 53473.8081   118%     -    5s
     0     0 53171.7811    0  412 24513.8517 53171.7811   117%     -    6s
     0     0 52967.3444    0  438 24513.8517 52967.3444   116%     -    6s
     0     0 52965.5257    0  409 24513.8517 52965.5257   116%     -    6s
     0     0 52965.3712    0  409 24513.8517 52965.3712   116%     -    6s
     0     0 48048.5748    0  409 24513.8517 48048.5748  96.0%     -    8s
     0     0 46817.1146    0  521 24513.8517 46817.1146  91.0%     -   10s
     0     0 46724.4228    0  518 24513.8517 46724.4228  90.6%     -   10s
     0     0 46708.9043    0  523 24513.8517 46708.9043  90.5%     -   10s
     0     0 46705.1001    0  527 24513.8517 46705.1001  90.5%     -   10s
     0     0 46701.8109    0  484 24513.8517 46701.8109  90.5%     -   10s
     0     0 46701.8085    0  530 24513.8517 46701.8085  90.5%     -   10s
     0     0 43007.2706    0  402 24513.8517 43007.2706  75.4%     -   14s
     0     0 42410.8967    0  448 24513.8517 42410.8967  73.0%     -   15s
     0     0 42261.1342    0  545 24513.8517 42261.1342  72.4%     -   16s
     0     0 42239.1571    0  481 24513.8517 42239.1571  72.3%     -   17s
     0     0 42230.2138    0  480 24513.8517 42230.2138  72.3%     -   17s
     0     0 42222.8082    0  475 24513.8517 42222.8082  72.2%     -   17s
     0     0 42220.4511    0  475 24513.8517 42220.4511  72.2%     -   17s
     0     0 40330.6161    0  465 24513.8517 40330.6161  64.5%     -   21s
     0     0 40019.8545    0  467 24513.8517 40019.8545  63.3%     -   23s
     0     0 39859.4488    0  484 24513.8517 39859.4488  62.6%     -   24s
     0     0 39792.1099    0  484 24513.8517 39792.1099  62.3%     -   24s
     0     0 39779.8058    0  490 24513.8517 39779.8058  62.3%     -   25s
     0     0 39771.9267    0  494 24513.8517 39771.9267  62.2%     -   25s
     0     0 39769.1117    0  488 24513.8517 39769.1117  62.2%     -   25s
     0     0 39476.7595    0  570 24513.8517 39476.7595  61.0%     -   27s
     0     0 39359.8126    0  573 24513.8517 39359.8126  60.6%     -   28s
     0     0 39332.4217    0  574 24513.8517 39332.4217  60.4%     -   28s
     0     0 39325.0264    0  586 24513.8517 39325.0264  60.4%     -   28s
     0     0 39320.9310    0  587 24513.8517 39320.9310  60.4%     -   28s
     0     0 39156.7584    0  490 24513.8517 39156.7584  59.7%     -   30s
     0     0 39040.2604    0  533 24513.8517 39040.2604  59.3%     -   31s
     0     0 38992.1139    0  549 24513.8517 38992.1139  59.1%     -   32s
     0     0 38931.4660    0  509 24513.8517 38931.4660  58.8%     -   33s
     0     0 38913.1961    0  516 24513.8517 38913.1961  58.7%     -   33s
     0     0 38908.0340    0  514 24513.8517 38908.0340  58.7%     -   33s
     0     0 38803.5786    0  468 24513.8517 38803.5786  58.3%     -   35s
     0     0 38782.4305    0  491 24513.8517 38782.4305  58.2%     -   35s
     0     0 38772.1750    0  485 24513.8517 38772.1750  58.2%     -   35s
     0     0 38765.5172    0  493 24513.8517 38765.5172  58.1%     -   36s
     0     0 38763.8058    0  488 24513.8517 38763.8058  58.1%     -   36s
     0     0 38719.9565    0  501 24513.8517 38719.9565  58.0%     -   37s
H    0     0                    24771.128627 38719.4694  56.3%     -   37s
     0     0 38690.4880    0  487 24771.1286 38690.4880  56.2%     -   38s
     0     0 38688.4649    0  490 24771.1286 38688.4649  56.2%     -   38s
     0     0 38645.3646    0  473 24771.1286 38645.3646  56.0%     -   39s
H    0     0                    24821.307234 38642.9003  55.7%     -   39s
     0     0 38635.4650    0  478 24821.3072 38635.4650  55.7%     -   40s
     0     0 38633.3293    0  489 24821.3072 38633.3293  55.6%     -   40s
     0     0 38614.1745    0  479 24821.3072 38614.1745  55.6%     -   41s
H    0     0                    24829.182438 38614.1696  55.5%     -   41s
     0     0 38599.1045    0  484 24829.1824 38599.1045  55.5%     -   41s
     0     0 38591.9750    0  490 24829.1824 38591.9750  55.4%     -   42s
     0     0 38590.7972    0  477 24829.1824 38590.7972  55.4%     -   42s
     0     0 38575.6752    0  493 24829.1824 38575.6752  55.4%     -   43s
     0     0 38573.8554    0  493 24829.1824 38573.8554  55.4%     -   43s
H    0     0                    24987.519000 38573.8554  54.4%     -   48s
H    0     2                    25046.185914 38573.8554  54.0%     -   49s
     0     2 38573.8554    0  493 25046.1859 38573.8554  54.0%     -   49s
     1     4 38451.0908    1  511 25046.1859 38573.8554  54.0%  3422   51s
    15    32 37873.7752    4  431 25046.1859 38180.0233  52.4%  3207   57s
H   31    64                    25051.614164 37873.5347  51.2%  4640   60s
H   32    64                    25105.044854 37873.5347  50.9%  4528   60s
H   32    64                    25113.482571 37873.5347  50.8%  4528   60s
H   34    64                    25461.624040 37873.5347  48.7%  4386   60s
H   36    64                    25467.311276 37873.5347  48.7%  4276   60s
H  134   215                    25559.045054 37722.9483  47.6%  2520   64s
   214   287 36490.1078    8  450 25559.0451 37722.9483  47.6%  1985   66s
H  305   355                    25578.460556 37722.9483  47.5%  1879   68s
   354   435 34501.8468   11  352 25578.4606 37722.9483  47.5%  1769   70s
H  477   495                    25614.993061 37722.9483  47.3%  1702   72s
   502   561 34837.2327   12  377 25614.9931 37722.9483  47.3%  1649   75s
   633   619 34434.7378   13  409 25614.9931 37333.1502  45.7%  1664   80s
   723   690 32309.3426   14  401 25614.9931 37332.1548  45.7%  1869   85s
   816   783 31825.2099   15  403 25614.9931 37332.1548  45.7%  1976   92s
   929   903 28656.8275   16  385 25614.9931 37332.1548  45.7%  2035   97s
  1012   934 28526.2714   17  394 25614.9931 37332.1548  45.7%  1997  100s
H 1028   934                    25745.087229 37332.1548  45.0%  2009  100s
  1171  1087     cutoff   18      25745.0872 37332.1548  45.0%  1922  105s
H 1249  1087                    26092.940903 37208.6722  42.6%  1880  105s
H 1288  1123                    26378.305636 37208.6722  41.1%  1848  109s
H 1333  1123                    26465.260366 37208.6722  40.6%  1830  109s
  1400  1193 33762.7314   13  305 26465.2604 36890.2372  39.4%  1821  111s
H 1404  1193                    26491.698153 36890.2372  39.3%  1825  111s
H 1429  1193                    26576.347812 36890.2372  38.8%  1803  111s
H 1510  1223                    26583.054314 36890.2372  38.8%  1794  113s
H 1520  1223                    26599.166263 36890.2372  38.7%  1794  113s
  1541  1298 32234.0862   15  299 26599.1663 36890.2372  38.7%  1801  117s
H 1574  1298                    26602.400852 36890.2372  38.7%  1783  117s
H 1628  1298                    26669.390525 36890.2372  38.3%  1764  117s
  1784  1457 30510.1501   25  378 26669.3905 36890.2372  38.3%  1740  121s
  2088  1711 29213.6821   41  255 26669.3905 36890.2372  38.3%  1624  128s
  2269  1760     cutoff   45      26669.3905 36890.2372  38.3%  1563  131s
  2428  1761 27479.2329   12  392 26669.3905 36087.9226  35.3%  1584  135s
H 2512  1773                    26688.759439 36085.8206  35.2%  1574  138s
  2587  1887 27996.8727   11  435 26688.7594 36085.8206  35.2%  1573  141s
  2783  1943     cutoff   13      26688.7594 36085.8206  35.2%  1550  146s
H 2903  1940                    26709.211816 36022.8518  34.9%  1546  146s
  3085  2071 28613.8132    8  439 26709.2118 36022.8518  34.9%  1551  154s
  3224  2107 28243.5560    9  391 26709.2118 35993.3367  34.8%  1564  158s
  3341  2201     cutoff   10      26709.2118 35815.0290  34.1%  1568  163s
  3550  2297     cutoff   10      26709.2118 35786.7773  34.0%  1558  169s
  3750  2350 28444.7796   15  254 26709.2118 35759.2537  33.9%  1560  173s
  3899  2401     cutoff   16      26709.2118 35625.7303  33.4%  1582  178s
  4066  2438 28459.6523    8  393 26709.2118 35625.7303  33.4%  1601  183s
  4181  2476 27530.1482    9  402 26709.2118 35625.7303  33.4%  1610  187s
  4319  2507     cutoff   10      26709.2118 35625.7303  33.4%  1625  192s
  4418  2562     cutoff   13      26709.2118 35300.2195  32.2%  1646  197s
  4607  2647 28911.7271    8  283 26709.2118 35300.2195  32.2%  1653  202s
  4819  2725     cutoff   11      26709.2118 35142.8453  31.6%  1659  209s
  5061  2749 27353.7935   12  406 26709.2118 35121.7705  31.5%  1667  212s
  5107  2835     cutoff   13      26709.2118 35121.7705  31.5%  1681  216s
  5284  2836 34526.8390    6  493 26709.2118 35121.7705  31.5%  1681  239s
  5286  2837 28569.2547   15  196 26709.2118 35121.7705  31.5%  1681  243s
  5287  2838 33949.1620   10  373 26709.2118 35121.7705  31.5%  1681  247s
  5289  2839 28076.5557   22  461 26709.2118 35121.7705  31.5%  1680  250s
  5297  2845 29657.5172   21  451 26709.2118 35121.7705  31.5%  1677  255s
  5305  2850 28295.1395   11  436 26709.2118 35121.7705  31.5%  1675  260s
  5312  2855 26787.8176   41  441 26709.2118 35121.7705  31.5%  1673  266s
  5317  2858 27343.6619   29  504 26709.2118 35121.7705  31.5%  1671  270s
  5323  2862 27542.2354   29  521 26709.2118 35121.7705  31.5%  1669  279s
  5324  2863 29374.1044   17  521 26709.2118 35121.7705  31.5%  1669  284s
  5325  2866 35121.7705   11  445 26709.2118 35121.7705  31.5%  1683  289s
  5327  2870 31359.4807   12  404 26709.2118 35121.7705  31.5%  1684  291s
  5339  2880 29494.3114   14  367 26709.2118 34115.3798  27.7%  1687  296s
  5375  2888     cutoff   16      26709.2118 33661.8262  26.0%  1689  300s
  5437  2927 30642.7246   18  210 26709.2118 31621.4477  18.4%  1693  305s
  5551  2950 27275.5402   23  221 26709.2118 31495.7950  17.9%  1692  311s
  5725  2903     cutoff   26      26709.2118 31470.1837  17.8%  1669  316s
  5886  2843 27248.4610   21  235 26709.2118 31462.3333  17.8%  1646  320s
  6115  2780 28157.6477   21  217 26709.2118 31148.9609  16.6%  1616  326s
  6354  2719     cutoff   28      26709.2118 31148.9609  16.6%  1583  331s
H 6629  2497                    26755.381850 29954.7840  12.0%  1539  334s
  6721  2473     cutoff   21      26755.3819 29636.5534  10.8%  1526  336s
  7144  2265     cutoff   31      26755.3819 29229.9391  9.25%  1467  341s
* 7591  1916              39    26865.222170 28218.2386  5.04%  1405  344s
  7677  1872 26956.1566   23  251 26865.2222 28218.2386  5.04%  1391  346s
* 7740  1721              64    26896.064865 28218.2386  4.92%  1381  346s
* 7756  1593              60    27135.369931 28218.2386  3.99%  1378  346s
* 7986  1360              53    27304.740058 27500.4007  0.72%  1341  346s
* 8146  1164              52    27359.430481 27432.1657  0.27%  1315  347s

Cutting planes:
  MIR: 255
  Flow cover: 629
  RLT: 7
  Relax-and-lift: 55

Explored 8218 nodes (10812024 simplex iterations) in 347.29 seconds (969.11 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27359.4 27304.7 27135.4 ... 26602.4

Optimal solution found (tolerance 1.00e-06)
Best objective 2.735943048128e+04, best bound 2.735943048128e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 347.30s
  Master Objective (UB) = 27359.43, θ = 170779.54
  Upper Bound (UB) = 27359.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170779.54
  [DEBUG]   ✓ Scenario 0: θ = 170779.54 ≤ Q = 170779.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170779.54 ≤ Q = 170779.54 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170779.54 ≤ Q = 170779.54 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x69c47af0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x69c47af0
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.297076e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 5937739.7168
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.606692e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -160669.22    0  124 5937739.72 -160669.22   103%     -    0s
H    0     0                    -127572.8787 -160669.22  25.9%     -    0s
H    0     0                    -128121.9512 -160669.22  25.4%     -    0s
H    0     0                    -134106.3059 -160669.22  19.8%     -    0s
H    0     0                    -134221.7671 -149791.42  11.6%     -    0s
     0     0 -149791.42    0   85 -134221.77 -149791.42  11.6%     -    0s
H    0     0                    -147328.8251 -149705.56  1.61%     -    0s
H    0     0                    -147685.9610 -149705.56  1.37%     -    0s
H    0     0                    -147893.8878 -149421.72  1.03%     -    0s
     0     0 -149415.10    0   88 -147893.89 -149415.10  1.03%     -    0s
     0     0 -148473.59    0   60 -147893.89 -148473.59  0.39%     -    0s
     0     0 -148382.53    0   58 -147893.89 -148382.53  0.33%     -    0s
     0     0 -148377.95    0   38 -147893.89 -148377.95  0.33%     -    0s
     0     0 -148371.22    0   41 -147893.89 -148371.22  0.32%     -    0s
     0     0 -148157.70    0   14 -147893.89 -148157.70  0.18%     -    0s
     0     0 -148027.59    0   12 -147893.89 -148027.59  0.09%     -    0s
     0     0 -147999.00    0    5 -147893.89 -147999.00  0.07%     -    0s
     0     0 -147999.00    0   12 -147893.89 -147999.00  0.07%     -    0s
H    0     0                    -147946.5580 -147999.00  0.04%     -    0s
*    0     0               0    -147976.0640 -147976.06  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 4
  MIR: 6
  Flow cover: 8
  Relax-and-lift: 3

Explored 1 nodes (689 simplex iterations) in 0.10 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -147976 -147947 -147894 ... -127573
No other solutions better than -147976

Optimal solution found (tolerance 1.00e-06)
Best objective -1.479760640415e+05, best bound -1.479760640415e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 148941.40
  Scenario: 41 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -147976.06
  [DEBUG]   S×d_nominal = 296917.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 296917.47 + -147976.06 = 148941.40
  [DEBUG]   Current θ from Master = 170779.54
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21838.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5521.29
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 3580.9530, Absolute Gap = 3580.9530, Relative Gap = 0.130886
  Not converged yet (gap = 3580.95 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 18 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178419 nonzeros
Model fingerprint: 0x88087380
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 5521.29 (0.03s)
MIP start from previous solve produced solution with objective 5521.29 (0.04s)
Loaded MIP start from previous solve with objective 5521.29

Presolve removed 29128 rows and 11828 columns
Presolve time: 0.52s
Presolved: 33415 rows, 15392 columns, 206359 nonzeros
Variable types: 13133 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 33415 rows, 15392 columns, 206359 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40873    3.0383079e+04   0.000000e+00   1.077938e+06      5s
Concurrent spin time: 0.32s

Solved with dual simplex

Root relaxation: objective 5.004945e+04, 23638 iterations, 5.49 seconds (11.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50049.4505    0  194 5521.29105 50049.4505   806%     -    6s
H    0     0                    17801.457765 50049.4505   181%     -    6s
H    0     0                    18881.229787 50049.4505   165%     -    6s
H    0     0                    18894.342835 50049.4505   165%     -    6s
H    0     0                    21447.948946 50049.4505   133%     -    6s
H    0     0                    22662.228346 50049.4505   121%     -    6s
H    0     0                    22677.805146 50049.4505   121%     -    6s
     0     0 46474.6240    0  205 22677.8051 46474.6240   105%     -    9s
     0     0 45669.6165    0  271 22677.8051 45669.6165   101%     -   10s
     0     0 45468.5995    0  273 22677.8051 45468.5995   100%     -   11s
     0     0 45468.5995    0  283 22677.8051 45468.5995   100%     -   11s
     0     0 45468.5995    0  281 22677.8051 45468.5995   100%     -   11s
     0     0 45468.5995    0  281 22677.8051 45468.5995   100%     -   11s
     0     0 42018.0488    0  320 22677.8051 42018.0488  85.3%     -   15s
H    0     0                    22729.195667 42017.9143  84.9%     -   15s
H    0     0                    22852.225574 42017.9143  83.9%     -   15s
     0     0 41489.7928    0  331 22852.2256 41489.7928  81.6%     -   16s
     0     0 41345.7469    0  341 22852.2256 41345.7469  80.9%     -   17s
     0     0 41317.2979    0  346 22852.2256 41317.2979  80.8%     -   17s
     0     0 41303.8866    0  347 22852.2256 41303.8866  80.7%     -   17s
     0     0 41301.5738    0  345 22852.2256 41301.5738  80.7%     -   18s
     0     0 41295.5763    0  338 22852.2256 41295.5763  80.7%     -   18s
     0     0 41289.8397    0  348 22852.2256 41289.8397  80.7%     -   18s
     0     0 41288.7644    0  349 22852.2256 41288.7644  80.7%     -   18s
     0     0 41288.1967    0  349 22852.2256 41288.1967  80.7%     -   18s
H    0     0                    23761.680685 41288.1967  73.8%     -   20s
     0     0 39832.4131    0  366 23761.6807 39832.4131  67.6%     -   23s
H    0     0                    24258.981560 39505.3454  62.8%     -   24s
H    0     0                    24593.201397 39505.3454  60.6%     -   24s
     0     0 39505.3454    0  372 24593.2014 39505.3454  60.6%     -   24s
     0     0 39432.9702    0  384 24593.2014 39432.9702  60.3%     -   25s
     0     0 39373.2533    0  393 24593.2014 39373.2533  60.1%     -   26s
     0     0 39324.2198    0  397 24593.2014 39324.2198  59.9%     -   26s
     0     0 39274.7921    0  387 24593.2014 39274.7921  59.7%     -   27s
     0     0 39264.4513    0  384 24593.2014 39264.4513  59.7%     -   27s
     0     0 39259.4558    0  394 24593.2014 39259.4558  59.6%     -   27s
     0     0 39258.0683    0  395 24593.2014 39258.0683  59.6%     -   28s
     0     0 39257.0541    0  395 24593.2014 39257.0541  59.6%     -   28s
     0     0 38871.9640    0  403 24593.2014 38871.9640  58.1%     -   32s
H    0     0                    24606.583762 38622.9586  57.0%     -   33s
     0     0 38622.9586    0  456 24606.5838 38622.9586  57.0%     -   33s
     0     0 38489.7307    0  412 24606.5838 38489.7307  56.4%     -   35s
     0     0 38452.1685    0  443 24606.5838 38452.1685  56.3%     -   35s
     0     0 38426.6513    0  460 24606.5838 38426.6513  56.2%     -   36s
     0     0 38417.7329    0  461 24606.5838 38417.7329  56.1%     -   36s
     0     0 38414.1221    0  460 24606.5838 38414.1221  56.1%     -   36s
     0     0 38411.9928    0  459 24606.5838 38411.9928  56.1%     -   36s
     0     0 38406.4239    0  459 24606.5838 38406.4239  56.1%     -   36s
     0     0 38405.9289    0  460 24606.5838 38405.9289  56.1%     -   36s
     0     0 38305.0719    0  436 24606.5838 38305.0719  55.7%     -   38s
     0     0 38280.7141    0  442 24606.5838 38280.7141  55.6%     -   38s
     0     0 38277.0224    0  447 24606.5838 38277.0224  55.6%     -   39s
     0     0 38271.7067    0  492 24606.5838 38271.7067  55.5%     -   39s
     0     0 38270.2178    0  447 24606.5838 38270.2178  55.5%     -   39s
     0     0 38268.5649    0  498 24606.5838 38268.5649  55.5%     -   39s
     0     0 38267.7434    0  452 24606.5838 38267.7434  55.5%     -   39s
H    0     0                    24615.839306 38193.5094  55.2%     -   40s
     0     0 38193.5094    0  463 24615.8393 38193.5094  55.2%     -   40s
     0     0 38157.5060    0  440 24615.8393 38157.5060  55.0%     -   41s
     0     0 38126.3602    0  482 24615.8393 38126.3602  54.9%     -   42s
     0     0 38121.0167    0  485 24615.8393 38121.0167  54.9%     -   42s
     0     0 38116.4221    0  481 24615.8393 38116.4221  54.8%     -   42s
     0     0 38116.0175    0  484 24615.8393 38116.0175  54.8%     -   42s
     0     0 38087.8989    0  490 24615.8393 38087.8989  54.7%     -   43s
     0     0 38079.9881    0  489 24615.8393 38079.9881  54.7%     -   43s
     0     0 38077.4304    0  491 24615.8393 38077.4304  54.7%     -   43s
     0     0 38076.0590    0  492 24615.8393 38076.0590  54.7%     -   44s
     0     0 38063.5922    0  480 24615.8393 38063.5922  54.6%     -   44s
H    0     0                    24694.274273 38063.4910  54.1%     -   44s
H    0     0                    24732.688984 38063.4910  53.9%     -   44s
     0     0 38060.5033    0  441 24732.6890 38060.5033  53.9%     -   45s
     0     0 38059.3137    0  442 24732.6890 38059.3137  53.9%     -   45s
H    0     0                    24813.356827 38049.5399  53.3%     -   46s
     0     0 38049.5399    0  490 24813.3568 38049.5399  53.3%     -   46s
     0     0 38047.5238    0  499 24813.3568 38047.5238  53.3%     -   46s
     0     0 38047.2693    0  500 24813.3568 38047.2693  53.3%     -   46s
     0     0 38044.0061    0  455 24813.3568 38044.0061  53.3%     -   47s
     0     0 38036.6076    0  494 24813.3568 38036.6076  53.3%     -   47s
     0     0 38032.8403    0  496 24813.3568 38032.8403  53.3%     -   47s
     0     0 38032.4281    0  451 24813.3568 38032.4281  53.3%     -   47s
     0     0 38027.4208    0  464 24813.3568 38027.4208  53.3%     -   48s
     0     0 38026.7724    0  508 24813.3568 38026.7724  53.3%     -   48s
     0     0 38010.3793    0  503 24813.3568 38010.3793  53.2%     -   49s
H    0     0                    25056.015441 38010.0715  51.7%     -   49s
     0     0 38005.0110    0  499 25056.0154 38005.0110  51.7%     -   49s
     0     0 38000.6002    0  504 25056.0154 38000.6002  51.7%     -   50s
     0     0 37998.7910    0  515 25056.0154 37998.7910  51.7%     -   50s
     0     0 37998.4094    0  511 25056.0154 37998.4094  51.7%     -   50s
     0     0 37986.1047    0  506 25056.0154 37986.1047  51.6%     -   51s
H    0     0                    25209.154962 37985.2004  50.7%     -   51s
     0     0 37984.1649    0  513 25209.1550 37984.1649  50.7%     -   51s
     0     0 37983.4833    0  468 25209.1550 37983.4833  50.7%     -   51s
     0     0 37980.2566    0  507 25209.1550 37980.2566  50.7%     -   52s
     0     0 37978.5442    0  513 25209.1550 37978.5442  50.7%     -   54s
     0     0 37978.0863    0  515 25209.1550 37978.0863  50.7%     -   54s
     0     0 37972.1935    0  488 25209.1550 37972.1935  50.6%     -   54s
     0     0 37971.7333    0  501 25209.1550 37971.7333  50.6%     -   55s
     0     0 37970.4349    0  501 25209.1550 37970.4349  50.6%     -   55s
     0     0 37970.0240    0  501 25209.1550 37970.0240  50.6%     -   56s
H    0     0                    25271.197457 37970.0240  50.3%     -   58s
H    0     0                    25428.838442 37970.0240  49.3%     -   64s
     0     2 37970.0240    0  501 25428.8384 37970.0240  49.3%     -   64s
     1     4 37903.5645    1  484 25428.8384 37968.7196  49.3%   791   66s
     7    16 37240.8389    3  479 25428.8384 37846.4786  48.8%  2345   70s
    31    64 36591.1997    5  476 25428.8384 36893.5285  45.1%  5217   77s
    63    92 36391.4257    6  465 25428.8384 36590.6171  43.9%  4572   84s
    91   202 36328.6063    7  461 25428.8384 36590.6171  43.9%  5578   91s
H   99   202                    25429.548562 36590.6171  43.9%  5423   91s
H  143   202                    25442.145479 36590.6171  43.8%  4482   91s
   201   256 35908.0082    8  463 25442.1455 36590.6171  43.8%  3519   96s
   255   321 36087.5014    9  453 25442.1455 36590.6171  43.8%  3285  101s
   392   418 35742.3523   11  453 25442.1455 36590.6171  43.8%  2850  107s
   425   461 35418.8947   11  459 25442.1455 36590.6171  43.8%  2887  112s
   472   517 32057.5095   12  378 25442.1455 36590.6171  43.8%  2925  116s
   609   651 33910.3499   13  430 25442.1455 36220.8801  42.4%  2646  122s
   676   738 33166.3190   14  424 25442.1455 36220.8801  42.4%  2535  125s
   863   906 33077.3664   15  420 25442.1455 36220.8801  42.4%  2216  131s
   968   931 31335.3098   15  315 25442.1455 36220.8801  42.4%  2073  136s
  1013   954 32462.4170   16  389 25442.1455 36220.8801  42.4%  2052  140s
  1064  1000 32067.0380   16  423 25442.1455 36220.8801  42.4%  2030  145s
  1142  1054 32412.5303   17  394 25442.1455 36220.8801  42.4%  1982  150s
  1280  1206 32114.9909   20  372 25442.1455 36220.8801  42.4%  1949  156s
  1519  1470 31450.7945   28  357 25442.1455 36220.8801  42.4%  1773  164s
  1682  1539 29965.4894   33  125 25442.1455 35797.1139  40.7%  1665  168s
  1830  1595 28363.7875   35  315 25442.1455 35797.1139  40.7%  1613  172s
  1944  1683 28300.4470   36  285 25442.1455 35797.1139  40.7%  1599  176s
  2068  1787 27946.7291   42  212 25442.1455 35752.1056  40.5%  1574  180s
  2236  1850 26781.7170   47  228 25442.1455 35655.9922  40.1%  1548  186s
  2270  1880 26970.1752   47  234 25442.1455 35655.9922  40.1%  1553  190s
  2346  1964 26790.5143   49  226 25442.1455 35655.9922  40.1%  1551  197s
  2410  2052 26690.3106   50  220 25442.1455 35655.9922  40.1%  1533  200s
  2657  2248 25894.7795   57  201 25442.1455 35655.9922  40.1%  1449  207s
  2801  2303 29109.8280    8  240 25442.1455 35455.0044  39.4%  1427  211s
  2950  2367 31349.5065    8  269 25442.1455 35365.0209  39.0%  1418  216s
  3026  2445 30048.0545    9  288 25442.1455 35365.0209  39.0%  1424  222s
H 3039  2440                    25599.823851 35365.0209  38.1%  1423  222s
  3158  2561     cutoff   10      25599.8239 35365.0209  38.1%  1419  226s
  3345  2683 26618.2521   10  304 25599.8239 35365.0209  38.1%  1415  231s
  3561  2802     cutoff   11      25599.8239 35329.8186  38.0%  1400  237s
  3785  2873 27812.3705   11  293 25599.8239 35318.2834  38.0%  1390  244s
  3951  2953 27407.2526   12  277 25599.8239 35318.2834  38.0%  1408  250s
  4124  3027 26532.9007   13  215 25599.8239 35288.7507  37.8%  1425  256s
H 4324  3108                    25702.036566 35276.8925  37.3%  1429  262s
H 4326  3107                    25747.146670 35276.8925  37.0%  1430  262s
H 4339  3106                    25748.884320 35276.8925  37.0%  1427  262s
  4537  3206 29722.7210   11  245 25748.8843 35276.8925  37.0%  1421  269s
  4727  3207 27430.5743   31  501 25748.8843 35276.8925  37.0%  1436  284s
  4729  3208 26351.5180   58  194 25748.8843 35276.8925  37.0%  1435  289s
  4730  3209 31517.5770   15  334 25748.8843 35276.8925  37.0%  1435  296s
  4732  3210 31619.0484   19  457 25748.8843 35276.8925  37.0%  1435  302s
  4734  3212 27712.6322   41  488 25748.8843 35276.8925  37.0%  1434  305s
  4738  3214 26589.5345   34  459 25748.8843 35276.8925  37.0%  1433  310s
  4742  3217 29232.9434   16  526 25748.8843 35276.8925  37.0%  1431  315s
  4746  3220 28236.2225   58  489 25748.8843 35276.8925  37.0%  1430  320s
  4751  3223 27467.3061   29  459 25748.8843 35276.8925  37.0%  1429  327s
  4753  3224 28542.3620   11  546 25748.8843 35276.8925  37.0%  1428  330s
  4757  3227 29819.5043   18  502 25748.8843 35276.8925  37.0%  1427  336s
  4760  3229 28103.0352   22  448 25748.8843 35276.8925  37.0%  1426  344s
  4761  3230 27335.4676   38  448 25748.8843 35276.8925  37.0%  1426  350s
  4762  3233 35276.8925   12  445 25748.8843 35276.8925  37.0%  1443  357s
  4764  3237 35276.8925   13  434 25748.8843 35276.8925  37.0%  1443  364s
  4768  3243 35276.8925   14  478 25748.8843 35276.8925  37.0%  1445  369s
  4776  3257 35276.8925   15  407 25748.8843 35276.8925  37.0%  1454  376s
  4792  3280 35276.8925   16  418 25748.8843 35276.8925  37.0%  1477  387s
  4821  3303 33177.9754   17  464 25748.8843 35276.8925  37.0%  1519  394s
  4853  3373 31339.6701   18  491 25748.8843 35276.8925  37.0%  1551  401s
  4942  3392 30009.6298   21  361 25748.8843 35276.8925  37.0%  1588  407s
  5033  3388 29165.6475   20  420 25748.8843 35276.8925  37.0%  1602  413s
  5102  3390 29232.3143   22  417 25748.8843 35276.8925  37.0%  1610  418s
  5181  3369 27712.2423   22  394 25748.8843 35276.8925  37.0%  1618  424s
  5236  3375 27606.8172   22  357 25748.8843 35276.8925  37.0%  1633  430s
  5281  3383 27448.9093   23  300 25748.8843 35276.8925  37.0%  1643  435s
  5331  3386 27448.8783   24  277 25748.8843 35225.1960  36.8%  1647  441s
  5407  3367 infeasible   27      25748.8843 34533.0925  34.1%  1652  446s
  5479  3352 27982.2927   18  401 25748.8843 34533.0925  34.1%  1659  451s
  5551  3344 25998.7578   20  406 25748.8843 34533.0925  34.1%  1669  456s
  5612  3360 27340.2933   20  408 25748.8843 34528.9765  34.1%  1678  461s
  5674  3362     cutoff   22      25748.8843 34002.7218  32.1%  1687  468s
  5746  3357 29095.1278   21  336 25748.8843 34002.7218  32.1%  1694  474s
  5825  3345 27837.9668   23  296 25748.8843 34002.7218  32.1%  1700  480s
  5891  3348 27052.7171   25  219 25748.8843 34002.7218  32.1%  1708  485s
  5981  3327     cutoff   27      25748.8843 34002.7218  32.1%  1713  490s
  6034  3318     cutoff   28      25748.8843 34002.7218  32.1%  1716  495s
  6122  3294 26632.8018   28  179 25748.8843 34002.7218  32.1%  1717  500s
  6174  3286     cutoff   29      25748.8843 33413.5656  29.8%  1722  507s
  6239  3265 25979.8270   29  174 25748.8843 32533.9890  26.4%  1732  515s
  6313  3277 25962.0844   30  177 25748.8843 32404.1931  25.8%  1738  520s
  6377  3262 27715.3900   18  279 25748.8843 31691.3743  23.1%  1745  526s
H 6461  3071                    25784.822990 31457.6097  22.0%  1748  526s
  6468  3070 29139.4788   25  357 25784.8230 31457.6097  22.0%  1748  534s
  6608  3020 27680.1904   27  299 25784.8230 31457.6097  22.0%  1752  541s
  6746  2986 26654.1936   31  166 25784.8230 31457.6097  22.0%  1757  546s
  6819  2974 infeasible   35      25784.8230 31457.6097  22.0%  1760  553s
  6951  2910     cutoff   23      25784.8230 30925.6432  19.9%  1766  560s
  7098  2861 26521.9002   23  267 25784.8230 30722.4885  19.1%  1771  568s
  7246  2804 26380.1080   21  332 25784.8230 30427.6899  18.0%  1779  574s
  7418  2763 27686.4699   26  234 25784.8230 29998.3475  16.3%  1782  582s
  7610  2695 26669.3715   28  203 25784.8230 29998.3475  16.3%  1783  589s
  7791  2636 25961.2264   37  111 25784.8230 29741.2773  15.3%  1778  597s
  8002  2561 27799.8880   25  198 25784.8230 29528.7505  14.5%  1775  606s
  8232  2452 26753.6168   31  168 25784.8230 29277.3072  13.5%  1772  615s
  8491  2369 27578.2925   25  349 25784.8230 28808.5099  11.7%  1766  624s
  8776  2242 infeasible   36      25784.8230 28808.5099  11.7%  1754  632s
  9046  2116 27041.8795   25  213 25784.8230 28603.2601  10.9%  1744  640s
* 9362  1858              39    25804.522194 28282.5903  9.60%  1718  640s
  9452  1746 26693.8996   27  289 25804.5222 28214.0259  9.34%  1715  648s
* 9549  1567              52    26082.196134 28045.0070  7.53%  1705  648s
  9992  1243     cutoff   28      26082.1961 28045.0070  7.53%  1667  654s
*10328   992              51    26241.558680 27610.1969  5.22%  1624  654s
*10381   842              47    26444.662098 27610.1969  4.41%  1617  654s
*10390   714              45    26448.039635 27610.1969  4.39%  1616  654s
 10752   421     cutoff   30      26448.0396 27285.4592  3.17%  1569  655s
H10804   284                    26551.317851 27045.5914  1.86%  1562  655s
*11168     3              49    26551.487897 26559.6514  0.03%  1512  655s

Cutting planes:
  MIR: 373
  Flow cover: 918
  Zero half: 1
  RLT: 25
  Relax-and-lift: 83

Explored 11211 nodes (16988097 simplex iterations) in 655.61 seconds (1965.67 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26551.5 26551.3 26448 ... 25747.1

Optimal solution found (tolerance 1.00e-06)
Best objective 2.655148789742e+04, best bound 2.655148789742e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 655.61s
  Master Objective (UB) = 26551.49, θ = 170561.00
  Upper Bound (UB) = 26551.49

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170561.00
  [DEBUG]   ✓ Scenario 0: θ = 170561.00 ≤ Q = 170561.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170561.00 ≤ Q = 170561.00 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170561.00 ≤ Q = 170561.00 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 170561.00 ≤ Q = 170561.00 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x32143bf8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x32143bf8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-13, 2e+02]
Found heuristic solution: objective 1.302120e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 5926123.1562
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.629054e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -162905.41    0  124 5926123.16 -162905.41   103%     -    0s
H    0     0                    -127084.7265 -162905.41  28.2%     -    0s
H    0     0                    -127387.3036 -162905.41  27.9%     -    0s
H    0     0                    -136238.3162 -162905.41  19.6%     -    0s
     0     0 -147772.26    0   80 -136238.32 -147772.26  8.47%     -    0s
H    0     0                    -144721.0958 -147719.82  2.07%     -    0s
     0     0 -147068.34    0   85 -144721.10 -147068.34  1.62%     -    0s
     0     0 -147063.15    0   85 -144721.10 -147063.15  1.62%     -    0s
     0     0 -147063.13    0   85 -144721.10 -147063.13  1.62%     -    0s
     0     0 -146743.10    0   70 -144721.10 -146743.10  1.40%     -    0s
H    0     0                    -145883.0492 -146729.28  0.58%     -    0s
H    0     0                    -146172.0494 -146685.24  0.35%     -    0s
     0     0 -146685.24    0   62 -146172.05 -146685.24  0.35%     -    0s
     0     0 -146657.40    0   62 -146172.05 -146657.40  0.33%     -    0s
     0     0 -146644.16    0   62 -146172.05 -146644.16  0.32%     -    0s
     0     0 -146348.67    0   16 -146172.05 -146348.67  0.12%     -    0s
     0     0 -146332.57    0   13 -146172.05 -146332.57  0.11%     -    0s
H    0     0                    -146220.3897 -146318.52  0.07%     -    0s
     0     0 -146286.92    0   13 -146220.39 -146286.92  0.05%     -    0s
     0     0 -146286.85    0   11 -146220.39 -146286.85  0.05%     -    0s
     0     0 -146281.13    0    8 -146220.39 -146281.13  0.04%     -    0s
     0     0 -146247.78    0    4 -146220.39 -146247.78  0.02%     -    0s
     0     0 -146235.78    0    3 -146220.39 -146235.78  0.01%     -    0s
H    0     0                    -146232.6361 -146235.78  0.00%     -    0s
     0     0     cutoff    0      -146232.64 -146232.64  0.00%     -    0s

Cutting planes:
  Relax-and-lift: 1

Explored 1 nodes (658 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -146233 -146220 -146172 ... -127085
No other solutions better than -146233

Optimal solution found (tolerance 1.00e-06)
Best objective -1.462326360620e+05, best bound -1.462326360620e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 151149.23
  Scenario: 40 demand increases, 19 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -146232.64
  [DEBUG]   S×d_nominal = 297381.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 297381.87 + -146232.64 = 151149.23
  [DEBUG]   Current θ from Master = 170561.00
  [DEBUG]   ⚠️  Z_SP ≤ θ by 19411.77 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 7139.72
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 2773.0104, Absolute Gap = 2773.0104, Relative Gap = 0.104439
  Not converged yet (gap = 2773.01 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 19 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221644 nonzeros
Model fingerprint: 0x12ecca3e
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 36400 rows and 14780 columns
Presolve time: 0.64s
Presolved: 41433 rows, 18680 columns, 256599 nonzeros
Variable types: 16421 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -204344.1227

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 41433 rows, 18680 columns, 256599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34724    2.7152708e+04   0.000000e+00   2.031367e+06      5s
   54661    4.4372216e+04   0.000000e+00   1.668439e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.993757e+04, 29467 iterations, 10.45 seconds (21.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49937.5655    0  196 -204344.12 49937.5655   124%     -   11s
H    0     0                    -196437.8760 49937.5655   125%     -   11s
H    0     0                    -110619.9428 49937.5655   145%     -   11s
H    0     0                    -107627.9149 49937.5655   146%     -   11s
H    0     0                    -47258.79323 49937.5655   206%     -   11s
H    0     0                    -44225.83329 49937.5655   213%     -   11s
H    0     0                    -44092.89186 49937.5655   213%     -   11s
H    0     0                    -38324.14505 49937.5655   230%     -   11s
H    0     0                    5368.7333137 49937.5655   830%     -   11s
H    0     0                    8143.9936675 49937.5655   513%     -   11s
H    0     0                    15092.642851 46365.2299   207%     -   15s
H    0     0                    15207.263219 46365.2299   205%     -   15s
     0     0 46342.4352    0  234 15207.2632 46342.4352   205%     -   15s
H    0     0                    15674.738718 46342.4352   196%     -   16s
H    0     0                    17167.195753 46342.4352   170%     -   16s
H    0     0                    17335.871729 46342.4352   167%     -   16s
H    0     0                    18371.013265 46342.4352   152%     -   16s
H    0     0                    21432.259158 46342.4352   116%     -   16s
     0     0 45598.5831    0  248 21432.2592 45598.5831   113%     -   17s
     0     0 45181.2201    0  241 21432.2592 45181.2201   111%     -   18s
     0     0 45181.2201    0  279 21432.2592 45181.2201   111%     -   19s
     0     0 45181.2201    0  277 21432.2592 45181.2201   111%     -   19s
     0     0 45181.2201    0  277 21432.2592 45181.2201   111%     -   19s
     0     0 45181.2201    0  281 21432.2592 45181.2201   111%     -   19s
     0     0 42250.3549    0  320 21432.2592 42250.3549  97.1%     -   24s
H    0     0                    21485.012430 42250.3549  96.7%     -   25s
H    0     0                    21576.522573 42250.3549  95.8%     -   25s
H    0     0                    21793.821073 42250.3549  93.9%     -   25s
H    0     0                    21900.734123 42250.3549  92.9%     -   25s
     0     0 41791.4444    0  326 21900.7341 41791.4444  90.8%     -   27s
     0     0 41577.8156    0  331 21900.7341 41577.8156  89.8%     -   29s
     0     0 41435.9083    0  349 21900.7341 41435.9083  89.2%     -   30s
     0     0 41363.1869    0  342 21900.7341 41363.1869  88.9%     -   31s
     0     0 41356.7469    0  352 21900.7341 41356.7469  88.8%     -   31s
     0     0 41353.8226    0  353 21900.7341 41353.8226  88.8%     -   31s
     0     0 41353.2283    0  352 21900.7341 41353.2283  88.8%     -   31s
     0     0 40338.7585    0  368 21900.7341 40338.7585  84.2%     -   38s
H    0     0                    22735.783881 40337.8943  77.4%     -   38s
     0     0 39920.3183    0  372 22735.7839 39920.3183  75.6%     -   41s
     0     0 39753.6905    0  371 22735.7839 39753.6905  74.9%     -   43s
     0     0 39534.0652    0  386 22735.7839 39534.0652  73.9%     -   45s
     0     0 39490.2334    0  389 22735.7839 39490.2334  73.7%     -   46s
     0     0 39479.1546    0  393 22735.7839 39479.1546  73.6%     -   46s
     0     0 39474.8051    0  394 22735.7839 39474.8051  73.6%     -   46s
     0     0 39472.8423    0  397 22735.7839 39472.8423  73.6%     -   47s
     0     0 39469.7057    0  397 22735.7839 39469.7057  73.6%     -   47s
     0     0 39469.0132    0  397 22735.7839 39469.0132  73.6%     -   47s
     0     0 38959.7886    0  454 22735.7839 38959.7886  71.4%     -   54s
H    0     0                    23219.150377 38959.7387  67.8%     -   54s
H    0     0                    23447.005983 38773.5880  65.4%     -   57s
H    0     0                    23915.200838 38773.5880  62.1%     -   57s
H    0     0                    24704.360283 38773.5880  57.0%     -   57s
H    0     0                    24859.257717 38773.5880  56.0%     -   57s
H    0     0                    24907.498699 38773.5880  55.7%     -   57s
     0     0 38773.5880    0  476 24907.4987 38773.5880  55.7%     -   57s
H    0     0                    24942.894002 38684.5945  55.1%     -   58s
     0     0 38684.5945    0  429 24942.8940 38684.5945  55.1%     -   58s
     0     0 38633.6444    0  470 24942.8940 38633.6444  54.9%     -   59s
     0     0 38608.8225    0  479 24942.8940 38608.8225  54.8%     -   59s
     0     0 38602.3635    0  476 24942.8940 38602.3635  54.8%     -   59s
     0     0 38581.0946    0  469 24942.8940 38581.0946  54.7%     -   60s
     0     0 38578.9707    0  431 24942.8940 38578.9707  54.7%     -   60s
     0     0 38576.7126    0  476 24942.8940 38576.7126  54.7%     -   60s
     0     0 38575.7543    0  435 24942.8940 38575.7543  54.7%     -   61s
     0     0 38446.8146    0  473 24942.8940 38446.8146  54.1%     -   62s
H    0     0                    25276.381484 38446.5374  52.1%     -   63s
H    0     0                    25515.614836 38446.5374  50.7%     -   63s
     0     0 38407.2508    0  475 25515.6148 38407.2508  50.5%     -   63s
     0     0 38390.0150    0  489 25515.6148 38390.0150  50.5%     -   64s
     0     0 38380.4921    0  494 25515.6148 38380.4921  50.4%     -   64s
     0     0 38375.0360    0  496 25515.6148 38375.0360  50.4%     -   64s
     0     0 38374.3505    0  495 25515.6148 38374.3505  50.4%     -   64s
     0     0 38313.0483    0  430 25515.6148 38313.0483  50.2%     -   66s
     0     0 38307.3949    0  428 25515.6148 38307.3949  50.1%     -   67s
     0     0 38306.2249    0  430 25515.6148 38306.2249  50.1%     -   67s
     0     0 38246.3400    0  490 25515.6148 38246.3400  49.9%     -   69s
     0     0 38208.2130    0  483 25515.6148 38208.2130  49.7%     -   70s
     0     0 38194.5448    0  481 25515.6148 38194.5448  49.7%     -   70s
     0     0 38190.1663    0  476 25515.6148 38190.1663  49.7%     -   71s
     0     0 38188.6855    0  487 25515.6148 38188.6855  49.7%     -   71s
     0     0 38188.3358    0  488 25515.6148 38188.3358  49.7%     -   71s
     0     0 38155.6397    0  420 25515.6148 38155.6397  49.5%     -   72s
     0     0 38133.1062    0  440 25515.6148 38133.1062  49.5%     -   72s
     0     0 38131.7681    0  445 25515.6148 38131.7681  49.4%     -   73s
     0     0 38125.8225    0  440 25515.6148 38125.8225  49.4%     -   73s
     0     0 38121.6783    0  448 25515.6148 38121.6783  49.4%     -   74s
     0     0 38121.3215    0  450 25515.6148 38121.3215  49.4%     -   74s
     0     0 38117.3021    0  424 25515.6148 38117.3021  49.4%     -   75s
     0     0 38113.7502    0  438 25515.6148 38113.7502  49.4%     -   75s
     0     0 38109.2818    0  433 25515.6148 38109.2818  49.4%     -   75s
     0     0 38108.7671    0  441 25515.6148 38108.7671  49.4%     -   75s
     0     0 38092.3792    0  440 25515.6148 38092.3792  49.3%     -   76s
     0     0 38091.4978    0  439 25515.6148 38091.4978  49.3%     -   77s
     0     0 38086.7122    0  427 25515.6148 38086.7122  49.3%     -   78s
     0     0 38084.2183    0  451 25515.6148 38084.2183  49.3%     -   78s
     0     0 38083.6121    0  445 25515.6148 38083.6121  49.3%     -   78s
     0     0 38081.0393    0  451 25515.6148 38081.0393  49.2%     -   79s
H    0     0                    25543.020277 38079.7633  49.1%     -   79s
     0     0 38079.7633    0  442 25543.0203 38079.7633  49.1%     -   79s
H    0     0                    25614.440264 38079.7633  48.7%     -   80s
H    0     0                    25640.316461 38079.7633  48.5%     -   80s
H    0     0                    25650.112497 38079.7633  48.5%     -   80s
     0     0 38077.6126    0  452 25650.1125 38077.6126  48.5%     -   80s
     0     0 38076.4672    0  452 25650.1125 38076.4672  48.4%     -   80s
H    0     0                    25650.401656 38076.2793  48.4%     -   96s
H    0     0                    25703.618139 38076.2793  48.1%     -   97s
     0     2 38076.2793    0  452 25703.6181 38076.2793  48.1%     -   98s
     3     8 37962.1357    2  442 25703.6181 37989.3796  47.8%  1142  105s
     7    16 37927.0707    3  444 25703.6181 37962.0264  47.7%  2867  112s
    15    32 37712.2851    4  440 25703.6181 37926.3001  47.6%  4188  115s
    31    48 35354.2426    5  429 25703.6181 37732.5792  46.8%  5378  127s
    47    80 35678.6077    6  368 25703.6181 37732.5792  46.8%  7535  131s
    79   139 35617.7808    7  322 25703.6181 37732.5792  46.8%  5785  142s
   148   257 35396.2053    8  302 25703.6181 37732.5792  46.8%  4436  148s
   272   359 35312.5076    9  298 25703.6181 37732.5792  46.8%  3102  152s
   376   408 34026.9399   10  278 25703.6181 37732.5792  46.8%  2658  158s
   459   464 34670.0673   10  274 25703.6181 37732.5792  46.8%  2447  165s
   541   516 34538.8437   11  292 25703.6181 37732.5792  46.8%  2308  172s
   609   574 34645.9835   10  288 25703.6181 37732.5792  46.8%  2190  177s
   691   613 33522.2025   10  254 25703.6181 37732.5792  46.8%  2103  182s
H  713   613                    25784.822990 37732.5792  46.3%  2076  182s
   758   668 34289.7093   12  273 25784.8230 37712.1002  46.3%  2070  189s
   831   719 32430.2792   13  301 25784.8230 37712.1002  46.3%  2038  192s
   904   768 31598.8985   13  247 25784.8230 37311.8555  44.7%  1997  198s
   983   836 31606.2756   13  268 25784.8230 37311.8555  44.7%  1969  203s
  1076   878 30170.0790   13  268 25784.8230 37311.8555  44.7%  1909  207s
  1149   910 31483.9434   14  260 25784.8230 37311.8555  44.7%  1865  211s
  1244   941 30003.5733   14  227 25784.8230 37311.8555  44.7%  1815  218s
  1310   999 31321.3998   15  289 25784.8230 37311.8555  44.7%  1823  223s
  1382  1075     cutoff   15      25784.8230 37311.8555  44.7%  1838  229s
  1488  1159 29453.1319   17  251 25784.8230 37040.3964  43.7%  1801  234s
  1617  1259 28661.6516   20  227 25784.8230 37040.3964  43.7%  1744  242s
  1768  1371 28457.4122   24  195 25784.8230 36971.8376  43.4%  1682  247s
  1948  1472 28261.5729   31  200 25784.8230 36971.8376  43.4%  1603  254s
  2129  1533 28176.8236   32  210 25784.8230 36971.8376  43.4%  1543  260s
  2277  1590 26411.4425   35  181 25784.8230 36971.8376  43.4%  1515  268s
  2394  1611 27259.4947   36  191 25784.8230 36145.0799  40.2%  1519  273s
  2435  1634 27592.9864   36  185 25784.8230 36145.0799  40.2%  1530  281s
  2490  1685 27496.4360   37  181 25784.8230 36145.0799  40.2%  1536  288s
  2579  1768 26778.7416   42  184 25784.8230 36145.0799  40.2%  1534  295s
  2686  1851 26437.9637   43  165 25784.8230 35619.2461  38.1%  1529  304s
  2824  1952 28213.0468    7  418 25784.8230 35619.2461  38.1%  1515  311s
  2985  2062 infeasible    8      25784.8230 35367.7686  37.2%  1496  319s
  3184  2189     cutoff   10      25784.8230 35325.8586  37.0%  1477  325s
  3418  2260 31718.5714    8  271 25784.8230 35239.9970  36.7%  1449  335s
  3598  2373 29935.0229   11  311 25784.8230 35222.8970  36.6%  1448  344s
  3775  2506 28993.6002   14  293 25784.8230 35222.8970  36.6%  1446  352s
  4018  2614 27328.0450   20  242 25784.8230 35222.8970  36.6%  1427  361s
  4247  2615 29600.4390   16  452 25784.8230 35183.2831  36.4%  1419  383s
  4249  2616 27166.3091   31  196 25784.8230 35183.2831  36.4%  1418  392s
  4250  2617 30369.7861   21  345 25784.8230 35183.2831  36.4%  1418  403s
  4251  2618 31240.0421   13  374 25784.8230 35183.2831  36.4%  1418  408s
  4252  2618 30554.3829   14  396 25784.8230 35183.2831  36.4%  1417  412s
  4253  2619 29806.1581   19  460 25784.8230 35183.2831  36.4%  1417  415s
  4255  2620 33519.2889   11  443 25784.8230 35183.2831  36.4%  1416  420s
  4259  2623 27154.7209   46  457 25784.8230 35183.2831  36.4%  1415  425s
  4263  2626 27308.6766   34  517 25784.8230 35183.2831  36.4%  1414  430s
  4267  2628 30389.1677   23  487 25784.8230 35183.2831  36.4%  1412  436s
  4270  2630 30407.8120   14  477 25784.8230 35183.2831  36.4%  1411  440s
  4272  2632 27430.8693   43  483 25784.8230 35183.2831  36.4%  1411  445s
  4274  2633 28658.5029   21  541 25784.8230 35183.2831  36.4%  1410  450s
  4277  2635 31564.7859    9  529 25784.8230 35183.2831  36.4%  1409  455s
  4279  2636 30186.7531   14  493 25784.8230 35183.2831  36.4%  1408  460s
  4281  2638 27087.9387   26  515 25784.8230 35183.2831  36.4%  1408  465s
  4282  2638 27434.7876   16  515 25784.8230 35183.2831  36.4%  1407  474s
  4283  2639 28925.2049   20  515 25784.8230 35183.2831  36.4%  1407  490s
  4284  2643 35183.2831   12  530 25784.8230 35183.2831  36.4%  1433  496s
  4286  2646 35183.2831   13  531 25784.8230 35183.2831  36.4%  1435  503s
  4290  2653 35183.2831   14  523 25784.8230 35183.2831  36.4%  1437  511s
  4298  2666 35183.2831   15  538 25784.8230 35183.2831  36.4%  1441  521s
  4314  2684 35183.2831   16  452 25784.8230 35183.2831  36.4%  1473  534s
  4337  2708 30428.4373   17  347 25784.8230 35183.2831  36.4%  1498  544s
  4369  2746 30247.3762   18  348 25784.8230 35183.2831  36.4%  1535  553s
  4441  2759 29045.1549   20  313 25784.8230 35183.2831  36.4%  1574  563s
  4543  2764 27204.6166   20  241 25784.8230 35183.2831  36.4%  1590  570s
  4623  2786 28640.5930   21  382 25784.8230 35183.2831  36.4%  1601  576s
  4703  2806 27657.8281   22  345 25784.8230 35183.2831  36.4%  1611  583s
  4781  2796 27900.4136   23  300 25784.8230 35183.2831  36.4%  1614  590s
  4869  2811 26660.4489   25  270 25784.8230 35183.2831  36.4%  1611  600s
  4914  2805 26286.1955   26  231 25784.8230 34733.8739  34.7%  1612  606s
  4976  2791     cutoff   27      25784.8230 34733.8739  34.7%  1611  612s
  5054  2790 26251.7638   26  269 25784.8230 34292.6288  33.0%  1608  618s
  5117  2782     cutoff   28      25784.8230 34292.6288  33.0%  1611  625s
  5169  2775 28692.8821   20  375 25784.8230 33897.1685  31.5%  1613  630s
  5227  2777 28480.9638   21  315 25784.8230 33777.4223  31.0%  1617  636s
  5282  2795     cutoff   23      25784.8230 33777.4223  31.0%  1622  644s
  5349  2809     cutoff   21      25784.8230 33321.3658  29.2%  1629  650s
  5423  2795 30728.6170   17  385 25784.8230 33321.3658  29.2%  1637  658s
  5523  2786 31666.6874   17  358 25784.8230 33321.3658  29.2%  1638  666s
  5605  2753 30005.3916   18  349 25784.8230 32951.9530  27.8%  1645  674s
  5702  2737 28177.1860   19  345 25784.8230 32415.6061  25.7%  1654  682s
  5799  2696 26810.7947   20  353 25784.8230 32415.6061  25.7%  1656  691s
  5907  2676 29973.7029   18  371 25784.8230 32415.6061  25.7%  1666  697s
  5956  2671 27512.4121   20  360 25784.8230 31726.2849  23.0%  1675  705s
  6047  2647 26485.2268   22  337 25784.8230 31574.9581  22.5%  1677  711s
  6176  2635     cutoff   19      25784.8230 31574.9581  22.5%  1681  719s
  6314  2599     cutoff   21      25784.8230 31574.9581  22.5%  1683  726s
  6435  2562     cutoff   22      25784.8230 30786.5866  19.4%  1680  734s
  6584  2531 28346.3584   23  350 25784.8230 30663.9235  18.9%  1681  742s
  6730  2506 27689.5081   25  276 25784.8230 30663.9235  18.9%  1683  751s
  6909  2442 26817.7801   28  205 25784.8230 30663.9235  18.9%  1680  758s
  7103  2365     cutoff   23      25784.8230 29734.5220  15.3%  1681  767s
  7330  2288 26653.1308   28  129 25784.8230 29734.5220  15.3%  1672  774s
  7482  2218 26234.7653   29  286 25784.8230 29734.5220  15.3%  1669  781s
  7586  2159 26110.4985   30  266 25784.8230 29734.5220  15.3%  1666  789s
  7696  2127 25997.6926   31  207 25784.8230 29163.5416  13.1%  1664  797s
  7835  2045 25824.6377   32  151 25784.8230 29079.1634  12.8%  1658  804s
  8059  1919 26371.1550   28  137 25784.8230 28804.5178  11.7%  1647  814s
  8335  1834     cutoff   25      25784.8230 28442.3822  10.3%  1635  821s
* 8531  1636              34    25804.522194 28442.3822  10.2%  1623  821s
  8536  1524     cutoff   28      25804.5222 28442.3822  10.2%  1623  830s
  8977  1235     cutoff   30      25804.5222 27696.8628  7.33%  1596  839s
  9509   907     cutoff   33      25804.5222 27305.8161  5.82%  1555  846s
 10164   574 infeasible   30      25804.5222 26833.6712  3.99%  1489  851s
*10189   439              73    25816.164861 26833.6712  3.94%  1485  851s
*10615   177              74    25876.051023 26572.5435  2.69%  1432  852s
*10798    25              50    25880.849760 26170.1075  1.12%  1411  853s
*10876    25              49    25904.591865 26096.6572  0.74%  1402  853s

Cutting planes:
  Learned: 1
  MIR: 549
  Mixing: 2
  Flow cover: 1169
  Zero half: 1
  RLT: 24
  Relax-and-lift: 91

Explored 11024 nodes (15380372 simplex iterations) in 853.67 seconds (2434.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25904.6 25880.8 25876.1 ... 25640.3

Optimal solution found (tolerance 1.00e-06)
Best objective 2.590459186541e+04, best bound 2.590459186541e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 853.68s
  Master Objective (UB) = 25904.59, θ = 169987.13
  Upper Bound (UB) = 25904.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169987.13
  [DEBUG]   ✓ Scenario 0: θ = 169987.13 ≤ Q = 169987.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169987.13 ≤ Q = 169987.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169987.13 ≤ Q = 169987.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169987.13 ≤ Q = 169987.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169987.13 ≤ Q = 169987.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x416089c4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbe9f763c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.307612e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 5969130.0828
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.613031e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161303.09    0  126 5969130.08 -161303.09   103%     -    0s
H    0     0                    -124053.2055 -161303.09  30.0%     -    0s
H    0     0                    -124546.0576 -161303.09  29.5%     -    0s
H    0     0                    -133803.2229 -161303.09  20.6%     -    0s
     0     0 -142204.46    0   91 -133803.22 -142204.46  6.28%     -    0s
H    0     0                    -139018.3063 -142123.70  2.23%     -    0s
     0     0 -141840.58    0   87 -139018.31 -141840.58  2.03%     -    0s
     0     0 -141831.54    0   87 -139018.31 -141831.54  2.02%     -    0s
     0     0 -141393.05    0   50 -139018.31 -141393.05  1.71%     -    0s
H    0     0                    -140167.1394 -141387.21  0.87%     -    0s
     0     0 -141362.13    0   50 -140167.14 -141362.13  0.85%     -    0s
H    0     0                    -140818.7133 -141359.96  0.38%     -    0s
H    0     0                    -140920.3978 -141359.96  0.31%     -    0s
     0     0 -141294.67    0   37 -140920.40 -141294.67  0.27%     -    0s
     0     0 -141294.49    0   36 -140920.40 -141294.49  0.27%     -    0s
     0     0 -141285.66    0   29 -140920.40 -141285.66  0.26%     -    0s
     0     0 -141010.38    0    8 -140920.40 -141010.38  0.06%     -    0s
     0     0 -140978.65    0    9 -140920.40 -140978.65  0.04%     -    0s
     0     0 -140976.19    0   10 -140920.40 -140976.19  0.04%     -    0s
     0     0 -140950.71    0    4 -140920.40 -140950.71  0.02%     -    0s
     0     0 -140950.71    0    9 -140920.40 -140950.71  0.02%     -    0s
     0     0 -140950.71    0    8 -140920.40 -140950.71  0.02%     -    0s
H    0     0                    -140926.4255 -140950.71  0.02%     -    0s
     0     0          -    0      -140926.43 -140926.50  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 5
  Flow cover: 2

Explored 1 nodes (595 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -140926 -140920 -140738 ... 5.96913e+06

Optimal solution found (tolerance 1.00e-06)
Best objective -1.409264255083e+05, best bound -1.409265040033e+05, gap 0.0001%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 156455.44
  Scenario: 25 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140926.43
  [DEBUG]   S×d_nominal = 297381.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 297381.87 + -140926.43 = 156455.44
  [DEBUG]   Current θ from Master = 169987.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13531.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12372.90
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 2126.1144, Absolute Gap = 2126.1144, Relative Gap = 0.082075
  Not converged yet (gap = 2126.11 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 34 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264869 nonzeros
Model fingerprint: 0xb4184760
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 43692 rows and 17742 columns
Presolve time: 0.77s
Presolved: 49431 rows, 21958 columns, 306779 nonzeros
Variable types: 19699 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -204344.1227

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 49431 rows, 21958 columns, 306779 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35044    1.4841340e+03   0.000000e+00   1.431258e+07      5s
Warning: 1 variables dropped from basis
Warning: switch to quad precision
   41796    5.5680891e+03   0.000000e+00   2.216800e+06     10s
   43876    5.9712487e+03   0.000000e+00   1.469493e+09     15s
Concurrent spin time: 5.52s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.993757e+04, 35780 iterations, 18.92 seconds (28.21 work units)
Total elapsed time = 20.05s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49937.5655    0  196 -204344.12 49937.5655   124%     -   20s
H    0     0                    -200974.4605 49937.5655   125%     -   20s
H    0     0                    -127682.1970 49937.5655   139%     -   20s
H    0     0                    -118736.3305 49937.5655   142%     -   20s
H    0     0                    -81872.15689 49937.5655   161%     -   20s
H    0     0                    -80978.56535 49937.5655   162%     -   20s
H    0     0                    -22023.18692 49937.5655   327%     -   20s
H    0     0                    -19272.74965 49937.5655   359%     -   20s
H    0     0                    4942.4524160 49937.5655   910%     -   20s
H    0     0                    9841.8898956 49937.5655   407%     -   20s
H    0     0                    10206.096446 49937.5655   389%     -   20s
H    0     0                    10235.831698 49937.5655   388%     -   20s
H    0     0                    11111.470779 49937.5655   349%     -   20s
H    0     0                    11208.810266 49937.5655   346%     -   21s
H    0     0                    11593.697165 46337.9813   300%     -   27s
     0     0 46337.9813    0  252 11593.6972 46337.9813   300%     -   27s
     0     0 45312.2854    0  276 11593.6972 45312.2854   291%     -   30s
     0     0 45179.3323    0  279 11593.6972 45179.3323   290%     -   31s
     0     0 45179.3323    0  283 11593.6972 45179.3323   290%     -   32s
     0     0 45179.3323    0  282 11593.6972 45179.3323   290%     -   33s
     0     0 45179.3323    0  285 11593.6972 45179.3323   290%     -   33s
     0     0 45179.3323    0  285 11593.6972 45179.3323   290%     -   33s
     0     0 45179.3323    0  283 11593.6972 45179.3323   290%     -   33s
H    0     0                    14004.615422 42086.2451   201%     -   41s
H    0     0                    14363.966787 42086.2451   193%     -   41s
H    0     0                    14485.795750 42086.2451   191%     -   41s
H    0     0                    14629.526634 42086.2451   188%     -   41s
H    0     0                    17093.265914 42086.2451   146%     -   41s
     0     0 42086.2451    0  332 17093.2659 42086.2451   146%     -   41s
     0     0 41712.4676    0  332 17093.2659 41712.4676   144%     -   44s
H    0     0                    20553.017921 41492.2546   102%     -   46s
H    0     0                    20934.329558 41492.2546  98.2%     -   46s
H    0     0                    21158.839550 41492.2546  96.1%     -   46s
H    0     0                    21227.530487 41492.2546  95.5%     -   46s
H    0     0                    21264.599003 41492.2546  95.1%     -   46s
     0     0 41492.2546    0  347 21264.5990 41492.2546  95.1%     -   46s
     0     0 41452.1155    0  343 21264.5990 41452.1155  94.9%     -   47s
     0     0 41433.8828    0  341 21264.5990 41433.8828  94.8%     -   47s
H    0     0                    23059.842537 41430.4300  79.7%     -   48s
H    0     0                    23104.161160 41430.4300  79.3%     -   48s
H    0     0                    23143.958980 41430.4300  79.0%     -   48s
H    0     0                    23196.366362 41430.4300  78.6%     -   48s
     0     0 41430.4300    0  349 23196.3664 41430.4300  78.6%     -   48s
     0     0 41429.6931    0  350 23196.3664 41429.6931  78.6%     -   48s
     0     0 40281.0963    0  368 23196.3664 40281.0963  73.7%     -   56s
H    0     0                    23310.797386 40280.3507  72.8%     -   57s
H    0     0                    23529.488486 40280.3507  71.2%     -   57s
     0     0 39813.0503    0  396 23529.4885 39813.0503  69.2%     -   60s
     0     0 39609.7185    0  424 23529.4885 39609.7185  68.3%     -   63s
     0     0 39492.6110    0  440 23529.4885 39492.6110  67.8%     -   65s
     0     0 39435.1239    0  404 23529.4885 39435.1239  67.6%     -   66s
     0     0 39351.8236    0  405 23529.4885 39351.8236  67.2%     -   68s
     0     0 39337.9387    0  410 23529.4885 39337.9387  67.2%     -   68s
     0     0 39327.1309    0  409 23529.4885 39327.1309  67.1%     -   69s
     0     0 39322.9045    0  407 23529.4885 39322.9045  67.1%     -   69s
     0     0 39314.5686    0  412 23529.4885 39314.5686  67.1%     -   70s
     0     0 39313.0045    0  412 23529.4885 39313.0045  67.1%     -   70s
     0     0 39312.3163    0  411 23529.4885 39312.3163  67.1%     -   70s
H    0     0                    23739.048100 38835.4844  63.6%     -   77s
     0     0 38835.4844    0  432 23739.0481 38835.4844  63.6%     -   77s
     0     0 38686.5639    0  459 23739.0481 38686.5639  63.0%     -   79s
     0     0 38637.1938    0  450 23739.0481 38637.1938  62.8%     -   81s
     0     0 38558.7760    0  415 23739.0481 38558.7760  62.4%     -   82s
     0     0 38536.9816    0  461 23739.0481 38536.9816  62.3%     -   83s
     0     0 38529.3473    0  461 23739.0481 38529.3473  62.3%     -   84s
     0     0 38519.4168    0  449 23739.0481 38519.4168  62.3%     -   84s
     0     0 38516.7078    0  455 23739.0481 38516.7078  62.3%     -   85s
     0     0 38515.2513    0  454 23739.0481 38515.2513  62.2%     -   85s
     0     0 38512.8677    0  457 23739.0481 38512.8677  62.2%     -   85s
     0     0 38511.8607    0  457 23739.0481 38511.8607  62.2%     -   85s
     0     0 38440.4995    0  411 23739.0481 38440.4995  61.9%     -   88s
H    0     0                    23996.344675 38440.4087  60.2%     -   88s
H    0     0                    24011.412267 38440.4087  60.1%     -   88s
H    0     0                    24027.732671 38440.4087  60.0%     -   88s
H    0     0                    24050.428633 38440.4087  59.8%     -   88s
H    0     0                    24051.012516 38440.4087  59.8%     -   88s
     0     0 38418.8411    0  472 24051.0125 38418.8411  59.7%     -   90s
     0     0 38408.5279    0  421 24051.0125 38408.5279  59.7%     -   90s
     0     0 38404.1966    0  474 24051.0125 38404.1966  59.7%     -   91s
     0     0 38403.3882    0  424 24051.0125 38403.3882  59.7%     -   91s
     0     0 38366.6904    0  484 24051.0125 38366.6904  59.5%     -   92s
     0     0 38352.3748    0  482 24051.0125 38352.3748  59.5%     -   93s
     0     0 38346.4676    0  485 24051.0125 38346.4676  59.4%     -   94s
     0     0 38337.5160    0  483 24051.0125 38337.5160  59.4%     -   94s
     0     0 38333.4811    0  482 24051.0125 38333.4811  59.4%     -   94s
     0     0 38329.1629    0  481 24051.0125 38329.1629  59.4%     -   95s
     0     0 38328.2131    0  484 24051.0125 38328.2131  59.4%     -   95s
     0     0 38310.7393    0  485 24051.0125 38310.7393  59.3%     -   97s
     0     0 38267.9539    0  469 24051.0125 38267.9539  59.1%     -   98s
     0     0 38240.1284    0  488 24051.0125 38240.1284  59.0%     -   99s
     0     0 38230.5580    0  460 24051.0125 38230.5580  59.0%     -  100s
     0     0 38227.7407    0  459 24051.0125 38227.7407  58.9%     -  100s
     0     0 38227.1365    0  469 24051.0125 38227.1365  58.9%     -  100s
     0     0 38201.6986    0  415 24051.0125 38201.6986  58.8%     -  101s
     0     0 38195.1858    0  417 24051.0125 38195.1858  58.8%     -  103s
     0     0 38192.2060    0  411 24051.0125 38192.2060  58.8%     -  103s
     0     0 38191.7061    0  420 24051.0125 38191.7061  58.8%     -  103s
     0     0 38178.9072    0  479 24051.0125 38178.9072  58.7%     -  105s
     0     0 38177.4378    0  443 24051.0125 38177.4378  58.7%     -  105s
     0     0 38176.7272    0  445 24051.0125 38176.7272  58.7%     -  105s
     0     0 38158.5544    0  485 24051.0125 38158.5544  58.7%     -  107s
H    0     0                    24097.143719 38157.9119  58.4%     -  108s
     0     0 38154.3631    0  445 24097.1437 38154.3631  58.3%     -  108s
     0     0 38152.7644    0  495 24097.1437 38152.7644  58.3%     -  109s
     0     0 38152.2225    0  492 24097.1437 38152.2225  58.3%     -  109s
     0     0 38145.9642    0  494 24097.1437 38145.9642  58.3%     -  110s
     0     0 38145.4374    0  453 24097.1437 38145.4374  58.3%     -  110s
     0     0 38137.9297    0  487 24097.1437 38137.9297  58.3%     -  111s
H    0     0                    24159.506830 38137.4591  57.9%     -  111s
H    0     0                    24174.921991 38137.4591  57.8%     -  112s
     0     0 38133.2339    0  495 24174.9220 38133.2339  57.7%     -  112s
     0     0 38132.6077    0  497 24174.9220 38132.6077  57.7%     -  112s
     0     0 38129.9694    0  497 24174.9220 38129.9694  57.7%     -  113s
     0     0 38129.4089    0  497 24174.9220 38129.4089  57.7%     -  114s
H    0     0                    24222.313414 38129.4089  57.4%     -  127s
H    0     0                    24446.749487 38129.4089  56.0%     -  129s
H    0     2                    24517.394372 38129.4089  55.5%     -  130s
     0     2 38129.4089    0  497 24517.3944 38129.4089  55.5%     -  130s
     3     8 37838.4409    2  485 24517.3944 37875.3226  54.5%  2388  137s
     7    16 37436.4999    3  485 24517.3944 37838.0213  54.3%  3937  142s
    15    32 37310.7369    4  489 24517.3944 37436.1902  52.7%  5519  148s
    31    49 36653.1382    5  441 24517.3944 37310.3039  52.2%  8038  162s
    48    81 35855.7539    6  467 24517.3944 37310.1127  52.2%  7830  182s
    80   237 35822.0634    7  461 24517.3944 37310.1127  52.2%  6298  191s
H   83   237                    24557.039498 37310.1127  51.9%  6109  191s
H   88   237                    24632.419226 37310.1127  51.5%  5879  191s
H   93   237                    24644.290787 37310.1127  51.4%  5660  191s
H  171   237                    24647.486817 37310.1127  51.4%  3794  191s
H  190   237                    24759.315640 37310.1127  50.7%  3540  191s
   236   320 35055.8397   11  355 24759.3156 37310.1127  50.7%  3205  198s
   319   401 35652.7835   11  435 24759.3156 37310.1127  50.7%  2910  206s
   400   476 35734.7102    9  449 24759.3156 37310.1127  50.7%  2763  212s
   475   544 35281.5396   11  389 24759.3156 37310.1127  50.7%  2639  218s
   543   619 35560.6503   13  394 24759.3156 37310.1127  50.7%  2546  223s
   618   682 35297.8554   13  390 24759.3156 37310.1127  50.7%  2437  229s
   681   721 34542.5733   14  418 24759.3156 37310.1127  50.7%  2430  236s
   740   764 29094.2780   25  305 24759.3156 37310.1127  50.7%  2469  243s
   807   832 34093.8218   13  315 24759.3156 37310.1127  50.7%  2434  250s
   891   888 33842.9337   13  256 24759.3156 37310.1127  50.7%  2354  256s
   979   956 28374.8920   32  296 24759.3156 37206.3035  50.3%  2272  263s
  1091   987 34314.8501   14  374 24759.3156 37206.3035  50.3%  2163  270s
  1138  1024 34330.7757   15  368 24759.3156 37206.3035  50.3%  2165  278s
  1218  1045 34370.8184   15  371 24759.3156 37206.3035  50.3%  2127  284s
  1259  1069 34074.0734   14  313 24759.3156 37206.3035  50.3%  2122  291s
  1313  1116 31419.7105   14  239 24759.3156 37206.3035  50.3%  2128  298s
  1360  1179 32542.4655   16  395 24759.3156 37206.3035  50.3%  2127  305s
  1437  1200 31378.4441   16  332 24759.3156 37206.3035  50.3%  2101  313s
  1474  1245 32542.7156   16  372 24759.3156 37206.3035  50.3%  2084  317s
  1537  1315 32072.6977   17  313 24759.3156 37206.3035  50.3%  2050  323s
  1627  1389 32190.3998   17  340 24759.3156 37206.3035  50.3%  2001  332s
  1741  1484 31204.3598   17  339 24759.3156 37017.4113  49.5%  1966  340s
H 1755  1484                    24825.867163 37017.4113  49.1%  1967  340s
  1878  1586 26773.6880   17  339 24825.8672 37017.4113  49.1%  1916  349s
  2028  1689 29812.4952   19  281 24825.8672 37017.4113  49.1%  1876  357s
  2193  1823 26952.4093   17  313 24825.8672 37017.4113  49.1%  1837  365s
  2392  1961 29780.1518   20  254 24825.8672 36094.1502  45.4%  1789  375s
  2592  2049 29401.6942   21  204 24825.8672 36094.1502  45.4%  1739  385s
  2786  2144 28441.6808   23  155 24825.8672 36094.1502  45.4%  1711  393s
  2943  2264 26820.1911   23  163 24825.8672 36016.5822  45.1%  1706  403s
  3129  2364     cutoff   27      24825.8672 36016.5822  45.1%  1698  413s
  3275  2473 32276.1751    7  350 24825.8672 35747.0217  44.0%  1713  423s
  3440  2595 28229.9087   10  214 24825.8672 35745.5560  44.0%  1725  432s
  3637  2727 26904.2903   14  249 24825.8672 35745.5560  44.0%  1728  442s
H 3876  2685                    25593.359891 35745.5560  39.7%  1713  451s
H 3923  2625                    25784.822990 35745.5560  38.6%  1704  451s
  4062  2624 32035.9089   16  323 25784.8230 35507.7023  37.7%  1701  461s
  4126  2657 31953.0419   17  274 25784.8230 35481.5609  37.6%  1712  471s
  4167  2713 31133.6462   17  271 25784.8230 35481.5609  37.6%  1728  482s
  4269  2770 27025.3513   17  276 25784.8230 35481.5609  37.6%  1736  494s
  4440  2840 28302.6932   19  195 25784.8230 35481.5609  37.6%  1739  506s
  4663  2920 28138.5739   20  165 25784.8230 35408.1922  37.3%  1748  516s
  4843  2987 26807.4914   25  160 25784.8230 35324.0902  37.0%  1772  528s
  5080  3010 32681.1881   14  334 25784.8230 35324.0902  37.0%  1786  541s
  5218  3100 28034.8111   16  330 25784.8230 35205.3469  36.5%  1797  554s
  5436  3191 26100.9947   21  181 25784.8230 35101.7015  36.1%  1809  567s
  5700  3192 27077.5993   18  497 25784.8230 35015.5974  35.8%  1818  599s
  5702  3193 25939.2625   28  196 25784.8230 35015.5974  35.8%  1817  623s
  5703  3194 28545.5413   30  386 25784.8230 35015.5974  35.8%  1817  637s
  5704  3195 32187.2068   16  415 25784.8230 35015.5974  35.8%  1817  645s
  5706  3196 28014.9683   27  466 25784.8230 35015.5974  35.8%  1816  653s
  5707  3197 28954.7568   28  501 25784.8230 35015.5974  35.8%  1816  660s
  5709  3198 29478.6461   28  432 25784.8230 35015.5974  35.8%  1815  665s
  5713  3201 33573.6907   16  492 25784.8230 35015.5974  35.8%  1814  670s
  5715  3202 34575.0112    9  487 25784.8230 35015.5974  35.8%  1813  675s
  5717  3203 26411.1502   42  490 25784.8230 35015.5974  35.8%  1813  680s
  5721  3206 27472.0628   15  443 25784.8230 35015.5974  35.8%  1811  686s
  5722  3207 34105.5607    8  493 25784.8230 35015.5974  35.8%  1811  690s
  5725  3209 26308.1687   15  514 25784.8230 35015.5974  35.8%  1810  695s
  5726  3209 27508.7239   36  514 25784.8230 35015.5974  35.8%  1810  701s
  5728  3211 27339.9035   39  550 25784.8230 35015.5974  35.8%  1809  705s
  5730  3212 26817.9759   19  544 25784.8230 35015.5974  35.8%  1808  712s
  5731  3213 32079.0008   12  464 25784.8230 35015.5974  35.8%  1808  716s
  5732  3213 34138.3261   24  464 25784.8230 35015.5974  35.8%  1808  738s
  5733  3214 33098.0675   21  464 25784.8230 35015.5974  35.8%  1807  752s
  5734  3218 35015.5974   14  530 25784.8230 35015.5974  35.8%  1838  769s
  5736  3221 35015.5974   15  513 25784.8230 35015.5974  35.8%  1838  783s
  5740  3228 35015.5974   16  521 25784.8230 35015.5974  35.8%  1842  800s
  5748  3241 35015.5974   17  525 25784.8230 35015.5974  35.8%  1851  809s
  5764  3258 34667.6496   18  460 25784.8230 35015.5974  35.8%  1886  830s
  5786  3282 33543.9618   19  348 25784.8230 35015.5974  35.8%  1908  842s
  5818  3319 33367.8601   20  342 25784.8230 35015.5974  35.8%  1938  856s
  5867  3397 33319.0324   21  281 25784.8230 35015.5974  35.8%  1950  870s
  5978  3417 32282.8337   22  328 25784.8230 35015.5974  35.8%  2002  886s
  6083  3422 30550.2685   22  269 25784.8230 35015.5974  35.8%  2020  897s
  6183  3401 31238.9330   23  325 25784.8230 35015.5974  35.8%  2033  906s
  6231  3396 31234.1679   23  234 25784.8230 35015.5974  35.8%  2043  917s
  6291  3394 28191.6660   24  228 25784.8230 35015.5974  35.8%  2053  926s
  6331  3399 26575.3047   23  272 25784.8230 35015.5974  35.8%  2070  936s
  6378  3397     cutoff   23      25784.8230 35015.5974  35.8%  2077  943s
  6439  3388     cutoff   25      25784.8230 35015.5974  35.8%  2080  953s
  6493  3390 26439.5321   26  216 25784.8230 35015.5974  35.8%  2087  961s
  6554  3389     cutoff   27      25784.8230 35015.5974  35.8%  2095  968s
  6612  3395 31113.4756   23  252 25784.8230 34795.1611  34.9%  2104  977s
  6688  3380 30918.4422   24  284 25784.8230 34332.0421  33.1%  2110  984s
  6772  3371 30164.3570   25  243 25784.8230 34332.0421  33.1%  2114  995s
  6837  3368 28164.9070   26  258 25784.8230 34060.9118  32.1%  2124 1004s
  6920  3367     cutoff   27      25784.8230 33717.7011  30.8%  2135 1013s
  7026  3339 26134.7185   28  220 25784.8230 33450.5922  29.7%  2140 1023s
  7124  3307     cutoff   30      25784.8230 33450.5922  29.7%  2152 1033s
  7246  3288 29215.0572   23  347 25784.8230 33450.5922  29.7%  2160 1045s
  7350  3287 28398.2361   25  305 25784.8230 33450.5922  29.7%  2174 1055s
  7458  3251 25850.9689   28  233 25784.8230 33450.5922  29.7%  2189 1067s
  7594  3224 27328.7383   24  271 25784.8230 32855.0849  27.4%  2198 1077s
  7731  3211     cutoff   26      25784.8230 32469.7933  25.9%  2207 1089s
  7867  3195 25980.6770   26  229 25784.8230 32206.7842  24.9%  2219 1101s
  8026  3152     cutoff   28      25784.8230 32148.7533  24.7%  2221 1112s
  8176  3104     cutoff   28      25784.8230 32054.7869  24.3%  2232 1124s
  8328  3075     cutoff   26      25784.8230 31664.1773  22.8%  2246 1135s
  8426  3053     cutoff   22      25784.8230 31534.4833  22.3%  2253 1149s
  8576  3024 27396.1738   24  337 25784.8230 31362.8280  21.6%  2264 1163s
  8760  2974 27265.6711   26  320 25784.8230 31248.6804  21.2%  2267 1176s
  8930  2940     cutoff   30      25784.8230 31217.1353  21.1%  2281 1189s
  9128  2889     cutoff   31      25784.8230 30876.3610  19.7%  2287 1204s
  9354  2827 26176.2906   24  296 25784.8230 30544.6039  18.5%  2288 1221s
  9573  2739 26229.7159   24  350 25784.8230 30250.3622  17.3%  2295 1237s
  9767  2666     cutoff   27      25784.8230 30169.0447  17.0%  2297 1252s
  9997  2587     cutoff   26      25784.8230 29928.8027  16.1%  2303 1270s
 10295  2449     cutoff   23      25784.8230 29778.4915  15.5%  2301 1287s
 10569  2350 27551.7068   30  268 25784.8230 29542.2593  14.6%  2305 1305s
 10915  2180 27210.5865   22  218 25784.8230 29252.5955  13.4%  2296 1321s
 11341  2016     cutoff   24      25784.8230 28751.6298  11.5%  2277 1341s
 11795  1772 26682.8466   31  250 25784.8230 28585.0583  10.9%  2256 1359s
 12241  1549     cutoff   28      25784.8230 28064.9671  8.84%  2232 1377s
 12859  1125     cutoff   36      25784.8230 27594.5611  7.02%  2187 1393s
 13847   527 26299.7405   35  133 25784.8230 27222.9953  5.58%  2090 1402s
*14352   197              39    25804.522194 26919.8298  4.32%  2031 1402s

Cutting planes:
  Learned: 1
  MIR: 541
  Flow cover: 1219
  Zero half: 1
  RLT: 27
  Relax-and-lift: 107

Explored 14797 nodes (29419444 simplex iterations) in 1404.57 seconds (4318.58 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25804.5 25784.8 25593.4 ... 24517.4

Optimal solution found (tolerance 1.00e-06)
Best objective 2.580452219369e+04, best bound 2.580452219369e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1404.58s
  Master Objective (UB) = 25804.52, θ = 169051.95
  Upper Bound (UB) = 25804.52

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 169051.95
  [DEBUG]   ✓ Scenario 0: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 169051.95 ≤ Q = 169051.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 169051.95 ≤ Q = 169051.95 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5e40d628
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa1bf29d8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.342485e+13
Presolve removed 2614 rows and 1905 columns
Presolve time: 0.00s
Presolved: 479 rows, 484 columns, 1318 nonzeros
Found heuristic solution: objective 6114773.9192
Variable types: 328 continuous, 156 integer (156 binary)

Root relaxation: objective -1.618244e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161824.41    0  124 6114773.92 -161824.41   103%     -    0s
H    0     0                    -127427.6200 -161824.41  27.0%     -    0s
H    0     0                    -127905.7740 -161824.41  26.5%     -    0s
H    0     0                    -129400.7910 -161824.41  25.1%     -    0s
     0     0 -142410.52    0   83 -129400.79 -142410.52  10.1%     -    0s
H    0     0                    -140189.1671 -142366.81  1.55%     -    0s
     0     0 -142135.78    0   86 -140189.17 -142135.78  1.39%     -    0s
     0     0 -141380.88    0   70 -140189.17 -141380.88  0.85%     -    0s
H    0     0                    -140680.0319 -141378.23  0.50%     -    0s
     0     0 -141212.00    0   63 -140680.03 -141212.00  0.38%     -    0s
     0     0 -141201.15    0   58 -140680.03 -141201.15  0.37%     -    0s
     0     0 -141174.96    0   66 -140680.03 -141174.96  0.35%     -    0s
     0     0 -141173.27    0   66 -140680.03 -141173.27  0.35%     -    0s
     0     0 -141016.12    0   49 -140680.03 -141016.12  0.24%     -    0s
     0     0 -141013.70    0   48 -140680.03 -141013.70  0.24%     -    0s
H    0     0                    -140918.6662 -141009.50  0.06%     -    0s
     0     0 -141009.50    0   47 -140918.67 -141009.50  0.06%     -    0s
     0     0 -140974.34    0    4 -140918.67 -140974.34  0.04%     -    0s
     0     0 -140974.34    0   37 -140918.67 -140974.34  0.04%     -    0s
     0     0 -140974.34    0   37 -140918.67 -140974.34  0.04%     -    0s
H    0     0                    -140967.0591 -140974.34  0.01%     -    0s
     0     0 -140974.34    0   37 -140967.06 -140974.34  0.01%     -    0s
     0     0     cutoff    0      -140967.06 -140967.06  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 35
  Flow cover: 1

Explored 1 nodes (806 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -140967 -140919 -140680 ... 1.34249e+13
No other solutions better than -140967

Optimal solution found (tolerance 1.00e-06)
Best objective -1.409670590827e+05, best bound -1.409670590827e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 157455.35
  Scenario: 20 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140967.06
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -140967.06 = 157455.35
  [DEBUG]   Current θ from Master = 169051.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11596.59 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14207.93
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 2026.0447, Absolute Gap = 2026.0447, Relative Gap = 0.078515
  Not converged yet (gap = 2026.04 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 39 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308094 nonzeros
Model fingerprint: 0x46d09190
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50984 rows and 20704 columns
Presolve time: 0.92s
Presolved: 57429 rows, 25236 columns, 356959 nonzeros
Variable types: 22977 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -204344.1227

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 57429 rows, 25236 columns, 356959 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30738    1.3494767e+03   0.000000e+00   6.867134e+06      5s
   45298    2.8940919e+04   0.000000e+00   3.410895e+07     10s
   58096    3.9317118e+04   0.000000e+00   8.044564e+07     15s
   70128    4.1934544e+04   0.000000e+00   9.986171e+06     20s
   82923    4.6169413e+04   0.000000e+00   8.910310e+06     25s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 4.993757e+04, 50527 iterations, 24.03 seconds (50.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49937.5655    0  196 -204344.12 49937.5655   124%     -   25s
H    0     0                    -196437.8760 49937.5655   125%     -   25s
H    0     0                    -63902.45577 49937.5655   178%     -   25s
H    0     0                    -43563.74280 49937.5655   215%     -   25s
H    0     0                    -41265.96527 49937.5655   221%     -   25s
H    0     0                    -19470.78591 49937.5655   356%     -   25s
H    0     0                    -18827.79023 49937.5655   365%     -   25s
H    0     0                    -18788.83053 49937.5655   366%     -   25s
H    0     0                    -18711.14547 49937.5655   367%     -   25s
H    0     0                    5951.2286666 46109.0613   675%     -   33s
H    0     0                    7399.2585756 46109.0613   523%     -   33s
H    0     0                    8419.3040400 46109.0613   448%     -   33s
H    0     0                    8450.9847217 46109.0613   446%     -   33s
     0     0 45782.0197    0  246 8450.98472 45782.0197   442%     -   33s
H    0     0                    9058.1819077 45782.0197   405%     -   34s
H    0     0                    9077.0422005 45782.0197   404%     -   34s
H    0     0                    9151.0057925 45782.0197   400%     -   34s
H    0     0                    10340.963170 45782.0197   343%     -   34s
H    0     0                    10660.682347 45782.0197   329%     -   34s
     0     0 45287.1376    0  277 10660.6823 45287.1376   325%     -   37s
     0     0 45252.9321    0  287 10660.6823 45252.9321   324%     -   37s
     0     0 45252.9321    0  276 10660.6823 45252.9321   324%     -   38s
     0     0 45139.8546    0  282 10660.6823 45139.8546   323%     -   38s
     0     0 45106.0023    0  283 10660.6823 45106.0023   323%     -   39s
     0     0 45106.0023    0  284 10660.6823 45106.0023   323%     -   40s
     0     0 45106.0023    0  284 10660.6823 45106.0023   323%     -   40s
     0     0 45105.9752    0  270 10660.6823 45105.9752   323%     -   40s
     0     0 45105.9752    0  270 10660.6823 45105.9752   323%     -   40s
H    0     0                    11100.623155 42662.4592   284%     -   51s
H    0     0                    11902.186402 42662.4592   258%     -   51s
H    0     0                    11933.867084 42662.4592   257%     -   51s
     0     0 42520.9637    0  312 11933.8671 42520.9637   256%     -   51s
H    0     0                    13831.273547 42520.9637   207%     -   52s
H    0     0                    15632.669736 42520.9637   172%     -   52s
H    0     0                    15854.298504 42520.9637   168%     -   52s
H    0     0                    15957.524688 42520.9637   166%     -   52s
     0     0 42123.9655    0  316 15957.5247 42123.9655   164%     -   59s
     0     0 41856.9748    0  320 15957.5247 41856.9748   162%     -   63s
H    0     0                    16665.612511 41665.3567   150%     -   67s
H    0     0                    17545.648565 41665.3567   137%     -   67s
     0     0 41665.3567    0  333 17545.6486 41665.3567   137%     -   67s
     0     0 41625.2357    0  326 17545.6486 41625.2357   137%     -   69s
     0     0 41608.5824    0  360 17545.6486 41608.5824   137%     -   70s
     0     0 41601.7459    0  367 17545.6486 41601.7459   137%     -   70s
     0     0 41601.5919    0  368 17545.6486 41601.5919   137%     -   70s
     0     0 40160.1088    0  383 17545.6486 40160.1088   129%     -   82s
H    0     0                    18615.990025 40159.9738   116%     -   83s
H    0     0                    18803.370370 40159.9738   114%     -   83s
H    0     0                    18898.076480 39805.5402   111%     -   88s
H    0     0                    18929.874593 39805.5402   110%     -   88s
H    0     0                    18983.098138 39805.5402   110%     -   88s
H    0     0                    18999.467365 39805.5402   110%     -   88s
H    0     0                    21382.272362 39805.5402  86.2%     -   88s
H    0     0                    21414.941938 39805.5402  85.9%     -   88s
     0     0 39805.5402    0  396 21414.9419 39805.5402  85.9%     -   88s
H    0     0                    21449.147201 39609.1355  84.7%     -   93s
     0     0 39609.1355    0  395 21449.1472 39609.1355  84.7%     -   93s
     0     0 39534.7209    0  404 21449.1472 39534.7209  84.3%     -   96s
H    0     0                    21552.809371 39435.6800  83.0%     -   99s
     0     0 39435.6800    0  411 21552.8094 39435.6800  83.0%     -   99s
     0     0 39392.7612    0  408 21552.8094 39392.7612  82.8%     -  100s
     0     0 39369.6865    0  409 21552.8094 39369.6865  82.7%     -  101s
     0     0 39299.1259    0  402 21552.8094 39299.1259  82.3%     -  102s
H    0     0                    21586.513297 39212.0580  81.7%     -  104s
     0     0 39212.0580    0  432 21586.5133 39212.0580  81.7%     -  104s
     0     0 39195.7076    0  404 21586.5133 39195.7076  81.6%     -  104s
H    0     0                    21774.920058 39189.2179  80.0%     -  105s
H    0     0                    21877.707231 39189.2179  79.1%     -  105s
H    0     0                    21903.771017 39189.2179  78.9%     -  105s
H    0     0                    21920.014545 39189.2179  78.8%     -  105s
     0     0 39189.2179    0  393 21920.0145 39189.2179  78.8%     -  105s
     0     0 39184.0729    0  394 21920.0145 39184.0729  78.8%     -  105s
     0     0 39182.9762    0  403 21920.0145 39182.9762  78.8%     -  106s
     0     0 38728.5262    0  424 21920.0145 38728.5262  76.7%     -  115s
H    0     0                    22002.698660 38728.4489  76.0%     -  115s
H    0     0                    22035.151093 38728.4489  75.8%     -  115s
H    0     0                    22176.653836 38728.4489  74.6%     -  115s
H    0     0                    22190.300014 38728.4489  74.5%     -  115s
H    0     0                    22297.021385 38728.4489  73.7%     -  115s
     0     0 38570.4606    0  448 22297.0214 38570.4606  73.0%     -  118s
     0     0 38485.7939    0  452 22297.0214 38485.7939  72.6%     -  120s
     0     0 38447.6773    0  471 22297.0214 38447.6773  72.4%     -  122s
     0     0 38431.3626    0  456 22297.0214 38431.3626  72.4%     -  123s
     0     0 38426.9371    0  473 22297.0214 38426.9371  72.3%     -  124s
     0     0 38415.7940    0  414 22297.0214 38415.7940  72.3%     -  124s
     0     0 38383.3467    0  460 22297.0214 38383.3467  72.1%     -  125s
     0     0 38367.0726    0  472 22297.0214 38367.0726  72.1%     -  126s
     0     0 38362.7183    0  474 22297.0214 38362.7183  72.1%     -  126s
     0     0 38361.4187    0  481 22297.0214 38361.4187  72.0%     -  127s
     0     0 38203.3774    0  486 22297.0214 38203.3774  71.3%     -  131s
H    0     0                    22321.982585 38203.0070  71.1%     -  131s
H    0     0                    22424.195300 38203.0070  70.4%     -  131s
     0     0 38182.5185    0  474 22424.1953 38182.5185  70.3%     -  132s
     0     0 38178.8494    0  427 22424.1953 38178.8494  70.3%     -  133s
     0     0 38177.1816    0  469 22424.1953 38177.1816  70.2%     -  133s
     0     0 38174.5754    0  473 22424.1953 38174.5754  70.2%     -  133s
     0     0 38173.6470    0  476 22424.1953 38173.6470  70.2%     -  133s
     0     0 38148.6198    0  482 22424.1953 38148.6198  70.1%     -  135s
     0     0 38132.9150    0  489 22424.1953 38132.9150  70.1%     -  136s
     0     0 38128.1843    0  501 22424.1953 38128.1843  70.0%     -  137s
     0     0 38126.2136    0  497 22424.1953 38126.2136  70.0%     -  137s
     0     0 38125.2278    0  500 22424.1953 38125.2278  70.0%     -  138s
     0     0 38078.2905    0  490 22424.1953 38078.2905  69.8%     -  140s
     0     0 38066.1997    0  499 22424.1953 38066.1997  69.8%     -  142s
     0     0 38059.6417    0  442 22424.1953 38059.6417  69.7%     -  143s
     0     0 38053.5114    0  438 22424.1953 38053.5114  69.7%     -  143s
     0     0 38051.6651    0  441 22424.1953 38051.6651  69.7%     -  144s
     0     0 38051.4259    0  443 22424.1953 38051.4259  69.7%     -  144s
     0     0 38042.5357    0  439 22424.1953 38042.5357  69.6%     -  146s
     0     0 38039.9555    0  442 22424.1953 38039.9555  69.6%     -  146s
     0     0 38039.3078    0  440 22424.1953 38039.3078  69.6%     -  146s
     0     0 38019.4565    0  497 22424.1953 38019.4565  69.5%     -  149s
     0     0 38016.4573    0  445 22424.1953 38016.4573  69.5%     -  149s
     0     0 38015.4018    0  442 22424.1953 38015.4018  69.5%     -  150s
     0     0 38013.1140    0  437 22424.1953 38013.1140  69.5%     -  150s
     0     0 38012.5746    0  440 22424.1953 38012.5746  69.5%     -  151s
H    0     0                    22468.596924 38004.6071  69.1%     -  153s
H    0     0                    24749.448346 38004.6071  53.6%     -  153s
     0     0 38004.6071    0  431 24749.4483 38004.6071  53.6%     -  153s
H    0     0                    24857.498072 38004.4170  52.9%     -  153s
H    0     0                    24884.914607 38004.4170  52.7%     -  153s
H    0     0                    25024.472890 38004.4170  51.9%     -  153s
H    0     0                    25093.769973 38004.4170  51.4%     -  153s
H    0     0                    25112.972267 38004.4170  51.3%     -  153s
     0     0 38002.1710    0  444 25112.9723 38002.1710  51.3%     -  153s
     0     0 38001.1278    0  449 25112.9723 38001.1278  51.3%     -  154s
     0     0 37996.5049    0  505 25112.9723 37996.5049  51.3%     -  155s
     0     0 37994.4383    0  510 25112.9723 37994.4383  51.3%     -  157s
     0     0 37993.0611    0  454 25112.9723 37993.0611  51.3%     -  157s
     0     0 37986.0166    0  504 25112.9723 37986.0166  51.3%     -  158s
     0     0 37985.4532    0  504 25112.9723 37985.4532  51.3%     -  159s
H    0     0                    25138.304779 37985.4532  51.1%     -  181s
H    0     0                    25184.405041 37985.4532  50.8%     -  181s
H    0     0                    25717.522859 37985.4532  47.7%     -  181s
H    0     2                    25737.975236 37985.4532  47.6%     -  182s
     0     2 37985.4532    0  504 25737.9752 37985.4532  47.6%     -  182s
     3     8 37801.3131    2  437 25737.9752 37894.5051  47.2%  2703  189s
     7    16 37755.2357    3  479 25737.9752 37835.4055  47.0%  3745  202s
    15    32 37679.0126    4  437 25737.9752 37755.0767  46.7%  6278  211s
    31    48 36199.2199    5  425 25737.9752 37678.9145  46.4%  8762  231s
    47    80 35135.4117    6  420 25737.9752 37678.9145  46.4%  8312  238s
H   49    80                    25784.822990 37678.9145  46.1%  8052  238s
    79   144 34747.4002    7  419 25784.8230 37678.9145  46.1%  6493  260s
   143   271 34593.6701    9  393 25784.8230 37678.9145  46.1%  4746  269s
   270   342 34163.4515   11  437 25784.8230 37678.9145  46.1%  3631  277s
   345   399 33345.3582   10  387 25784.8230 37678.9145  46.1%  3433  283s
   402   465 33922.5895   10  372 25784.8230 37678.9145  46.1%  3358  291s
   468   501 34004.9538   12  434 25784.8230 37678.9145  46.1%  3363  297s
   504   548 32579.5291   12  415 25784.8230 37678.9145  46.1%  3345  304s
   565   586 33525.0821   12  373 25784.8230 37678.9145  46.1%  3335  311s
   623   617 33112.1905   11  378 25784.8230 37678.9145  46.1%  3304  319s
   694   642 32991.0149   13  363 25784.8230 37678.9145  46.1%  3240  328s
   759   669 31865.7114   12  405 25784.8230 37678.9145  46.1%  3182  335s
   842   688 31695.8169   13  449 25784.8230 37678.9145  46.1%  3080  342s
   897   731 32559.8517   13  403 25784.8230 37678.9145  46.1%  3040  351s
   959   751 30284.6032   13  419 25784.8230 37678.9145  46.1%  3033  360s
  1009   778 32253.2724   14  403 25784.8230 37678.9145  46.1%  3039  368s
  1055   811 31984.4923   15  363 25784.8230 37678.9145  46.1%  3041  376s
  1112   859 29520.4625   16  345 25784.8230 37678.9145  46.1%  3032  385s
  1190   934 28744.9676   16  374 25784.8230 37678.9145  46.1%  2998  394s
  1287   986 29629.8315   15  356 25784.8230 37678.9145  46.1%  2915  403s
  1390  1040 29445.2141   16  339 25784.8230 37678.9145  46.1%  2862  413s
  1496  1053 28718.6644   19  332 25784.8230 37678.9145  46.1%  2807  424s
  1542  1073 infeasible   19      25784.8230 37678.9145  46.1%  2821  445s
  1592  1103 27980.9418   21  317 25784.8230 37480.2426  45.4%  2876  458s
  1646  1141 27910.5240   22  265 25784.8230 37480.2426  45.4%  2914  467s
  1722  1184 27582.2147   23  308 25784.8230 37146.2303  44.1%  2901  476s
  1793  1207 27578.9015   24  301 25784.8230 37146.2303  44.1%  2911  486s
  1833  1237 27564.1641   25  266 25784.8230 37146.2303  44.1%  2920  495s
  1873  1277 27292.0524   26  273 25784.8230 37146.2303  44.1%  2930  505s
  1943  1317     cutoff   27      25784.8230 37146.2303  44.1%  2902  514s
  2025  1370     cutoff   27      25784.8230 37146.2303  44.1%  2898  525s
  2125  1427 33570.8076   13  414 25784.8230 37146.2303  44.1%  2879  537s
  2218  1488 32638.4335   14  406 25784.8230 37146.2303  44.1%  2866  550s
  2324  1564 29413.0475   15  404 25784.8230 37146.2303  44.1%  2838  562s
  2460  1622 27026.7285   16  401 25784.8230 37146.2303  44.1%  2797  574s
  2579  1668     cutoff   17      25784.8230 35712.0643  38.5%  2764  590s
  2714  1728 26230.5376   17  306 25784.8230 35712.0643  38.5%  2729  603s
  2834  1799 26045.2739   18  297 25784.8230 35575.7529  38.0%  2716  616s
  2987  1898     cutoff   19      25784.8230 35535.4275  37.8%  2693  630s
  3197  1956 32636.4612    9  330 25784.8230 35535.4275  37.8%  2633  643s
  3377  2016 31795.8494   10  325 25784.8230 35467.7161  37.6%  2606  656s
  3526  2153 31767.9425   11  270 25784.8230 35460.3990  37.5%  2597  673s
  3725  2263 30162.8372   12  276 25784.8230 35460.3990  37.5%  2567  688s
  3895  2350 29455.0113   13  203 25784.8230 35342.6781  37.1%  2535  705s
  4114  2417 29087.3236   14  184 25784.8230 35159.0023  36.4%  2520  722s
  4304  2569 27985.4892   16  192 25784.8230 35120.2239  36.2%  2527  739s
  4545  2570 32266.0897    9  504 25784.8230 35120.2239  36.2%  2523  780s
  4547  2571 29441.0521   24  196 25784.8230 35120.2239  36.2%  2522  818s
  4548  2572 27840.0214   39  393 25784.8230 35120.2239  36.2%  2521  847s
  4549  2573 31917.4492   11  393 25784.8230 35120.2239  36.2%  2520  859s
  4550  2573 27412.9437   10  407 25784.8230 35120.2239  36.2%  2520  866s
  4551  2574 28782.9762   24  456 25784.8230 35120.2239  36.2%  2519  873s
  4552  2575 25929.3643   41  458 25784.8230 35120.2239  36.2%  2519  878s
  4553  2575 28840.9582   33  438 25784.8230 35120.2239  36.2%  2518  881s
  4555  2577 27891.8568   25  493 25784.8230 35120.2239  36.2%  2517  887s
  4556  2577 27149.2177   37  498 25784.8230 35120.2239  36.2%  2517  890s
  4559  2579 33769.8426    8  461 25784.8230 35120.2239  36.2%  2515  898s
  4560  2580 27156.8697   25  465 25784.8230 35120.2239  36.2%  2514  900s
  4562  2581 29451.0144   20  470 25784.8230 35120.2239  36.2%  2513  909s
  4563  2582 31801.5918   12  468 25784.8230 35120.2239  36.2%  2513  912s
  4564  2583 27212.3176   21  520 25784.8230 35120.2239  36.2%  2512  915s
  4565  2583 26418.0525   32  510 25784.8230 35120.2239  36.2%  2512  922s
  4566  2584 31200.6006   14  510 25784.8230 35120.2239  36.2%  2511  925s
  4568  2585 28289.0916   23  518 25784.8230 35120.2239  36.2%  2510  931s
  4569  2586 31715.1881   20  521 25784.8230 35120.2239  36.2%  2509  936s
  4570  2587 27428.5053   14  520 25784.8230 35120.2239  36.2%  2509  940s
  4572  2588 30485.3559   17  522 25784.8230 35120.2239  36.2%  2508  946s
  4573  2589 26691.6627   45  520 25784.8230 35120.2239  36.2%  2507  951s
  4575  2590 30081.0073   25  482 25784.8230 35120.2239  36.2%  2506  957s
  4576  2591 26924.5487   31  482 25784.8230 35120.2239  36.2%  2506  985s
  4577  2591 34408.2742   12  482 25784.8230 35120.2239  36.2%  2505 1003s
  4578  2595 35120.2239   10  514 25784.8230 35120.2239  36.2%  2555 1027s
  4580  2598 35120.2239   11  504 25784.8230 35120.2239  36.2%  2559 1039s
  4584  2605 35120.2239   12  459 25784.8230 35120.2239  36.2%  2560 1054s
  4592  2618 35120.2239   13  458 25784.8230 35120.2239  36.2%  2568 1066s
  4608  2630 32761.6354   14  359 25784.8230 35120.2239  36.2%  2615 1095s
  4625  2656 34231.2622   15  419 25784.8230 35120.2239  36.2%  2635 1116s
  4657  2677 29633.0620   16  384 25784.8230 35120.2239  36.2%  2701 1135s
  4688  2704 29508.2384   17  405 25784.8230 35120.2239  36.2%  2777 1149s
  4728  2712 29394.4087   18  414 25784.8230 35120.2239  36.2%  2799 1166s
  4778  2731 28999.4457   19  395 25784.8230 35120.2239  36.2%  2823 1184s
  4852  2728 28197.1914   19  361 25784.8230 35120.2239  36.2%  2844 1201s
  4945  2694     cutoff   20      25784.8230 35120.2239  36.2%  2853 1215s
  5007  2672 infeasible   19      25784.8230 35120.2239  36.2%  2865 1231s
  5081  2664 31982.6611   15  373 25784.8230 35120.2239  36.2%  2882 1244s
  5151  2673 31824.7347   16  368 25784.8230 35120.2239  36.2%  2897 1260s
  5227  2688 30699.0898   18  329 25784.8230 35120.2239  36.2%  2900 1275s
  5303  2690 28847.5806   20  337 25784.8230 35120.2239  36.2%  2916 1288s
  5376  2689     cutoff   21      25784.8230 35120.2239  36.2%  2922 1294s
  5413  2708 29125.6291   20  257 25784.8230 35120.2239  36.2%  2928 1306s
  5475  2722 28643.1242   23  232 25784.8230 35120.2239  36.2%  2930 1317s
  5556  2717     cutoff   25      25784.8230 35120.2239  36.2%  2932 1327s
  5650  2705 26512.2822   26  222 25784.8230 35120.2239  36.2%  2934 1339s
  5709  2712 26199.1609   28  302 25784.8230 35120.2239  36.2%  2934 1351s
  5799  2703 25869.3544   32  230 25784.8230 34784.5724  34.9%  2934 1363s
  5903  2703 28179.4551   23  269 25784.8230 33472.7065  29.8%  2932 1376s
  5988  2695 27822.4812   25  279 25784.8230 33472.7065  29.8%  2944 1390s
  6079  2698 27220.9276   27  272 25784.8230 33472.7065  29.8%  2945 1403s
  6188  2678 26609.5586   29  273 25784.8230 33233.4771  28.9%  2951 1417s
  6317  2667 26196.0884   29  223 25784.8230 32818.5548  27.3%  2956 1431s
  6444  2633     cutoff   31      25784.8230 32818.5548  27.3%  2964 1447s
  6577  2611 26498.3254   19  305 25784.8230 32818.5548  27.3%  2970 1465s
  6740  2588 26469.9833   20  201 25784.8230 32818.5548  27.3%  2961 1480s
  6836  2583     cutoff   23      25784.8230 31812.5802  23.4%  2966 1495s
  6974  2566 27578.5881   17  371 25784.8230 31381.9031  21.7%  2967 1513s
  7125  2541 26079.5064   20  342 25784.8230 31095.4190  20.6%  2968 1532s
  7323  2485 27455.2314   17  340 25784.8230 30916.8405  19.9%  2959 1551s
  7511  2428     cutoff   19      25784.8230 30600.0458  18.7%  2961 1570s
  7696  2407     cutoff   17      25784.8230 30208.3343  17.2%  2957 1590s
  7938  2323 26684.5221   24  243 25784.8230 30208.3343  17.2%  2944 1609s
  8095  2293 26601.8222   28  166 25784.8230 29968.9446  16.2%  2943 1629s
  8319  2234 28313.1806   22  261 25784.8230 29931.3162  16.1%  2939 1653s
  8577  2130     cutoff   25      25784.8230 29671.6155  15.1%  2923 1674s
  8855  2042 infeasible   30      25784.8230 29278.6961  13.6%  2913 1696s
  9047  1953     cutoff   24      25784.8230 29061.6192  12.7%  2912 1718s
  9309  1882     cutoff   25      25784.8230 29037.1400  12.6%  2906 1740s
  9583  1760     cutoff   23      25784.8230 28714.5256  11.4%  2896 1764s
  9880  1630     cutoff   27      25784.8230 28572.7584  10.8%  2892 1790s
 10253  1467     cutoff   22      25784.8230 28179.1018  9.29%  2876 1816s
 10782  1136 26580.3170   34  189 25784.8230 27976.6680  8.50%  2828 1840s
 11281   683     cutoff   26      25784.8230 27631.9953  7.16%  2796 1862s
 12041   164     cutoff   27      25784.8230 27190.0398  5.45%  2702 1875s
 13330     3     cutoff   66      25784.8230 25932.2027  0.57%  2481 1892s
 13366     0     cutoff   44      25784.8230 25808.0841  0.09%  2474 1897s

Cutting planes:
  Learned: 1
  MIR: 483
  Flow cover: 1287
  Zero half: 1
  RLT: 23
  Relax-and-lift: 126

Explored 13379 nodes (33283031 simplex iterations) in 1897.44 seconds (5624.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25784.8 25738 25717.5 ... 24857.5

Optimal solution found (tolerance 1.00e-06)
Best objective 2.578482299012e+04, best bound 2.578482299012e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1897.45s
  Master Objective (UB) = 25784.82, θ = 172417.91
  Upper Bound (UB) = 25784.82

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172417.91
  [DEBUG]   ✓ Scenario 0: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172417.91 ≤ Q = 172417.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172417.91 ≤ Q = 172417.91 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172417.91 ≤ Q = 172417.91 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5d7eec8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x05d7eec8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.332576e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6135507.8389
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.550233e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155023.35    0  127 6135507.84 -155023.35   103%     -    0s
H    0     0                    -119820.4493 -155023.35  29.4%     -    0s
H    0     0                    -120873.0325 -155023.35  28.3%     -    0s
H    0     0                    -130144.6766 -155023.35  19.1%     -    0s
H    0     0                    -130345.4539 -140025.39  7.43%     -    0s
H    0     0                    -136602.0149 -140025.39  2.51%     -    0s
     0     0 -140025.39    0   97 -136602.01 -140025.39  2.51%     -    0s
     0     0 -139727.22    0  101 -136602.01 -139727.22  2.29%     -    0s
     0     0 -138699.95    0  102 -136602.01 -138699.95  1.54%     -    0s
H    0     0                    -137747.5181 -138631.48  0.64%     -    0s
     0     0 -138631.48    0  102 -137747.52 -138631.48  0.64%     -    0s
     0     0 -138127.96    0   54 -137747.52 -138127.96  0.28%     -    0s
     0     0 -138115.71    0   45 -137747.52 -138115.71  0.27%     -    0s
     0     0 -138107.18    0   43 -137747.52 -138107.18  0.26%     -    0s
     0     0 -138021.40    0   43 -137747.52 -138021.40  0.20%     -    0s
     0     0 -137992.86    0   29 -137747.52 -137992.86  0.18%     -    0s
     0     0 -137977.28    0   22 -137747.52 -137977.28  0.17%     -    0s
     0     0 -137977.01    0   22 -137747.52 -137977.01  0.17%     -    0s
     0     0 -137884.66    0   13 -137747.52 -137884.66  0.10%     -    0s
     0     0 -137884.66    0   18 -137747.52 -137884.66  0.10%     -    0s
     0     0 -137769.91    0    5 -137747.52 -137769.91  0.02%     -    0s
     0     0 -137768.02    0    4 -137747.52 -137768.02  0.01%     -    0s
H    0     0                    -137768.0212 -137768.02  0.00%     -    0s
     0     0 -137768.02    0    4 -137768.02 -137768.02  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 1
  MIR: 3
  Flow cover: 7
  Relax-and-lift: 3

Explored 1 nodes (769 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -137768 -137748 -136807 ... 6.13551e+06
No other solutions better than -137768

Optimal solution found (tolerance 1.00e-06)
Best objective -1.377680211852e+05, best bound -1.377680211852e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 157860.78
  Scenario: 46 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137768.02
  [DEBUG]   S×d_nominal = 295628.80
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 295628.80 + -137768.02 = 157860.78
  [DEBUG]   Current θ from Master = 172417.91
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14557.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11227.69
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 2006.3455, Absolute Gap = 2006.3455, Relative Gap = 0.077811
  Not converged yet (gap = 2006.35 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 13 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351319 nonzeros
Model fingerprint: 0x77310be0
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 58276 rows and 23666 columns
Presolve time: 1.04s
Presolved: 65427 rows, 28514 columns, 407139 nonzeros
Variable types: 26255 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 65427 rows, 28514 columns, 407139 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32562   -3.8565495e+04   0.000000e+00   1.375878e+08      5s
   45367    5.3262475e+02   0.000000e+00   1.994341e+08     10s
   55890    6.7038825e+03   0.000000e+00   7.370774e+06     15s
   66839    1.7341533e+04   0.000000e+00   3.083825e+07     20s
   77526    2.3733119e+04   0.000000e+00   2.133556e+07     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.958655e+04, 53965 iterations, 28.62 seconds (59.53 work units)
Total elapsed time = 30.06s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49586.5488    0  193 -207405.59 49586.5488   124%     -   30s
H    0     0                    -203514.6892 49586.5488   124%     -   30s
H    0     0                    -70676.71633 49586.5488   170%     -   30s
H    0     0                    -60169.81849 49586.5488   182%     -   30s
H    0     0                    -60067.55604 49586.5488   183%     -   30s
H    0     0                    -14238.02486 49586.5488   448%     -   30s
H    0     0                    -12335.52663 49586.5488   502%     -   31s
H    0     0                    -9725.672712 49586.5488   610%     -   31s
H    0     0                    -9703.502137 49586.5488   611%     -   31s
H    0     0                    -9593.259781 49586.5488   617%     -   31s
H    0     0                    4433.6730834 45672.1795   930%     -   41s
H    0     0                    4686.3909841 45672.1795   875%     -   41s
H    0     0                    5123.9280458 45672.1795   791%     -   41s
     0     0 45672.1795    0  261 5123.92805 45672.1795   791%     -   41s
H    0     0                    5366.4005307 45661.5004   751%     -   42s
     0     0 44957.1346    0  256 5366.40053 44957.1346   738%     -   46s
     0     0 44957.1346    0  268 5366.40053 44957.1346   738%     -   47s
     0     0 44957.1346    0  265 5366.40053 44957.1346   738%     -   47s
     0     0 44957.1346    0  264 5366.40053 44957.1346   738%     -   50s
     0     0 44957.1346    0  271 5366.40053 44957.1346   738%     -   51s
     0     0 44957.1346    0  269 5366.40053 44957.1346   738%     -   51s
     0     0 44957.1346    0  268 5366.40053 44957.1346   738%     -   52s
     0     0 44957.1346    0  268 5366.40053 44957.1346   738%     -   52s
     0     0 44957.1346    0  266 5366.40053 44957.1346   738%     -   52s
H    0     0                    10239.545685 42306.1239   313%     -   63s
H    0     0                    10327.476279 42306.1239   310%     -   63s
H    0     0                    10394.274452 42306.1239   307%     -   63s
     0     0 42214.4263    0  274 10394.2745 42214.4263   306%     -   63s
H    0     0                    14676.157767 42214.4263   188%     -   63s
H    0     0                    14802.857181 42214.4263   185%     -   64s
H    0     0                    15006.866064 42214.4263   181%     -   64s
H    0     0                    15293.895610 42214.4263   176%     -   64s
H    0     0                    15318.177339 42214.4263   176%     -   64s
     0     0 41596.0908    0  311 15318.1773 41596.0908   172%     -   70s
     0     0 41463.5894    0  310 15318.1773 41463.5894   171%     -   73s
     0     0 41353.5977    0  344 15318.1773 41353.5977   170%     -   76s
     0     0 41319.9235    0  347 15318.1773 41319.9235   170%     -   77s
     0     0 41278.2117    0  343 15318.1773 41278.2117   169%     -   80s
     0     0 41274.2833    0  315 15318.1773 41274.2833   169%     -   80s
     0     0 41272.5722    0  347 15318.1773 41272.5722   169%     -   81s
     0     0 41271.5300    0  315 15318.1773 41271.5300   169%     -   81s
     0     0 41270.8652    0  353 15318.1773 41270.8652   169%     -   82s
H    0     0                    15337.833175 41270.8652   169%     -   87s
H    0     0                    15437.661032 41270.8652   167%     -   87s
H    0     0                    15596.284187 41270.8652   165%     -   87s
H    0     0                    15924.991495 41270.8652   159%     -   87s
H    0     0                    16166.577262 39872.9684   147%     -   98s
H    0     0                    16210.049458 39872.9684   146%     -   98s
H    0     0                    16573.911583 39872.9684   141%     -   98s
     0     0 39872.9684    0  359 16573.9116 39872.9684   141%     -   98s
H    0     0                    16721.925473 39872.0551   138%     -   98s
H    0     0                    16914.197632 39872.0551   136%     -   98s
H    0     0                    16987.795187 39872.0551   135%     -   98s
H    0     0                    17043.537900 39872.0551   134%     -   98s
H    0     0                    17228.180885 39872.0551   131%     -   98s
H    0     0                    17287.528801 39872.0551   131%     -   98s
     0     0 39257.4377    0  369 17287.5288 39257.4377   127%     -  105s
     0     0 39115.0910    0  365 17287.5288 39115.0910   126%     -  107s
     0     0 39057.2031    0  372 17287.5288 39057.2031   126%     -  110s
H    0     0                    17592.596085 39020.4653   122%     -  111s
H    0     0                    17691.646021 39020.4653   121%     -  111s
H    0     0                    17719.151584 39020.4653   120%     -  111s
H    0     0                    17817.356833 39020.4653   119%     -  111s
H    0     0                    17830.853696 39020.4653   119%     -  111s
H    0     0                    17895.345834 39020.4653   118%     -  111s
     0     0 39020.4653    0  371 17895.3458 39020.4653   118%     -  111s
H    0     0                    19493.655595 38994.9438   100%     -  113s
H    0     0                    19561.395394 38994.9438  99.3%     -  113s
H    0     0                    20801.196515 38994.9438  87.5%     -  113s
     0     0 38994.9438    0  383 20801.1965 38994.9438  87.5%     -  113s
     0     0 38943.7796    0  380 20801.1965 38943.7796  87.2%     -  114s
     0     0 38917.0990    0  373 20801.1965 38917.0990  87.1%     -  115s
     0     0 38910.9143    0  380 20801.1965 38910.9143  87.1%     -  116s
     0     0 38899.9858    0  373 20801.1965 38899.9858  87.0%     -  118s
     0     0 38896.8693    0  392 20801.1965 38896.8693  87.0%     -  119s
     0     0 38883.9614    0  387 20801.1965 38883.9614  86.9%     -  120s
     0     0 38875.3778    0  384 20801.1965 38875.3778  86.9%     -  121s
     0     0 38874.1875    0  386 20801.1965 38874.1875  86.9%     -  122s
     0     0 38872.9947    0  388 20801.1965 38872.9947  86.9%     -  123s
     0     0 38872.4799    0  386 20801.1965 38872.4799  86.9%     -  124s
     0     0 38430.3535    0  411 20801.1965 38430.3535  84.8%     -  133s
H    0     0                    20879.298391 38427.7290  84.0%     -  134s
H    0     0                    20934.401318 38248.9390  82.7%     -  139s
H    0     0                    21340.805503 38248.9390  79.2%     -  139s
H    0     0                    21394.609431 38248.9390  78.8%     -  139s
H    0     0                    21425.059610 38248.9390  78.5%     -  139s
H    0     0                    21440.674424 38248.9390  78.4%     -  139s
     0     0 38248.9390    0  451 21440.6744 38248.9390  78.4%     -  139s
     0     0 38196.0941    0  453 21440.6744 38196.0941  78.1%     -  141s
     0     0 38177.8858    0  451 21440.6744 38177.8858  78.1%     -  142s
     0     0 38168.5018    0  457 21440.6744 38168.5018  78.0%     -  143s
     0     0 38156.7777    0  456 21440.6744 38156.7777  78.0%     -  144s
H    0     0                    21537.487848 38144.6721  77.1%     -  145s
     0     0 38144.6721    0  451 21537.4878 38144.6721  77.1%     -  145s
     0     0 38140.7812    0  455 21537.4878 38140.7812  77.1%     -  146s
     0     0 38138.2482    0  454 21537.4878 38138.2482  77.1%     -  146s
     0     0 38134.5873    0  453 21537.4878 38134.5873  77.1%     -  147s
     0     0 38133.7511    0  455 21537.4878 38133.7511  77.1%     -  147s
     0     0 38058.4474    0  464 21537.4878 38058.4474  76.7%     -  150s
H    0     0                    21656.553822 38055.8300  75.7%     -  150s
     0     0 38031.7712    0  463 21656.5538 38031.7712  75.6%     -  152s
     0     0 38022.2678    0  469 21656.5538 38022.2678  75.6%     -  153s
     0     0 38021.3320    0  467 21656.5538 38021.3320  75.6%     -  154s
     0     0 37975.7260    0  477 21656.5538 37975.7260  75.4%     -  157s
H    0     0                    21695.012616 37973.0814  75.0%     -  158s
     0     0 37965.8635    0  477 21695.0126 37965.8635  75.0%     -  160s
     0     0 37959.8919    0  481 21695.0126 37959.8919  75.0%     -  160s
     0     0 37956.1956    0  479 21695.0126 37956.1956  75.0%     -  161s
     0     0 37954.2442    0  482 21695.0126 37954.2442  74.9%     -  161s
     0     0 37953.9637    0  482 21695.0126 37953.9637  74.9%     -  161s
     0     0 37939.2148    0  488 21695.0126 37939.2148  74.9%     -  163s
H    0     0                    21702.579860 37937.9367  74.8%     -  163s
H    0     0                    21789.399460 37937.9367  74.1%     -  163s
H    0     0                    21832.809263 37937.9367  73.8%     -  163s
     0     0 37933.8845    0  492 21832.8093 37933.8845  73.7%     -  165s
     0     0 37932.5130    0  494 21832.8093 37932.5130  73.7%     -  165s
     0     0 37928.1701    0  522 21832.8093 37928.1701  73.7%     -  167s
     0     0 37926.2167    0  530 21832.8093 37926.2167  73.7%     -  169s
     0     0 37925.4251    0  525 21832.8093 37925.4251  73.7%     -  169s
H    0     0                    22073.471991 37912.5941  71.8%     -  172s
     0     0 37912.5941    0  523 22073.4720 37912.5941  71.8%     -  172s
H    0     0                    22728.426957 37911.3963  66.8%     -  172s
H    0     0                    22787.435596 37911.3963  66.4%     -  172s
     0     0 37909.9729    0  527 22787.4356 37909.9729  66.4%     -  174s
     0     0 37909.2506    0  530 22787.4356 37909.2506  66.4%     -  174s
     0     0 37900.6146    0  529 22787.4356 37900.6146  66.3%     -  176s
H    0     0                    23181.460972 37900.6092  63.5%     -  176s
H    0     0                    23201.253538 37900.6092  63.4%     -  177s
     0     0 37898.0886    0  533 23201.2535 37898.0886  63.3%     -  178s
     0     0 37897.2560    0  533 23201.2535 37897.2560  63.3%     -  178s
     0     0 37879.5933    0  538 23201.2535 37879.5933  63.3%     -  180s
H    0     0                    23319.390356 37879.5864  62.4%     -  181s
H    0     0                    23504.400279 37879.5864  61.2%     -  181s
     0     0 37874.3661    0  511 23504.4003 37874.3661  61.1%     -  181s
     0     0 37873.6617    0  510 23504.4003 37873.6617  61.1%     -  182s
     0     0 37858.9907    0  454 23504.4003 37858.9907  61.1%     -  183s
H    0     0                    23549.358608 37858.9713  60.8%     -  188s
H    0     0                    23657.017455 37858.9713  60.0%     -  188s
     0     0 37855.5818    0  540 23657.0175 37855.5818  60.0%     -  189s
     0     0 37855.3305    0  537 23657.0175 37855.3305  60.0%     -  189s
     0     0 37849.5952    0  492 23657.0175 37849.5952  60.0%     -  192s
     0     0 37849.0150    0  492 23657.0175 37849.0150  60.0%     -  192s
     0     0 37847.4953    0  544 23657.0175 37847.4953  60.0%     -  194s
     0     0 37846.7437    0  541 23657.0175 37846.7437  60.0%     -  194s
     0     0 37841.8842    0  540 23657.0175 37841.8842  60.0%     -  196s
     0     0 37841.8720    0  540 23657.0175 37841.8720  60.0%     -  197s
H    0     0                    23734.281164 37841.8692  59.4%     -  230s
     0     2 37841.8692    0  540 23734.2812 37841.8692  59.4%     -  231s
     1     3 36346.4656    1  407 23734.2812 37841.8488  59.4% 10402  238s
     2     6 35374.6646    2  340 23734.2812 37841.8488  59.4%  8752  243s
     5    12 34405.6262    3  346 23734.2812 37696.3383  58.8%  6072  252s
    11    24 33890.0404    4  462 23734.2812 37679.2956  58.8%  7552  260s
    23    36 36471.0371    4  495 23734.2812 37386.0398  57.5% 10601  279s
    35    68 34811.5189    5  370 23734.2812 37386.0398  57.5% 10496  311s
H   38    68                    23839.504421 37386.0398  56.8% 10356  311s
H   49    68                    23972.798387 37386.0398  56.0%  9879  311s
H   55    68                    23997.981883 37386.0398  55.8%  9348  311s
    67   170 34802.7232    6  363 23997.9819 37160.0084  54.8% 12019  331s
   169   273 33089.8846    8  333 23997.9819 37159.9798  54.8%  6922  341s
   272   334 33044.1071   10  337 23997.9819 37159.9798  54.8%  5639  350s
   333   365 33005.9355   10  335 23997.9819 37159.9798  54.8%  5498  358s
   364   405 32380.7111   11  371 23997.9819 37159.9798  54.8%  5625  365s
   404   435 32056.0433   12  360 23997.9819 37159.9798  54.8%  5660  376s
   434   462 31990.5561   13  363 23997.9819 37159.9798  54.8%  5720  396s
   465   489 31291.0550   14  236 23997.9819 37159.9798  54.8%  5719  409s
   498   519 31027.8729   15  220 23997.9819 37159.9798  54.8%  5769  417s
   530   553 30939.5687   16  229 23997.9819 37159.9798  54.8%  5889  426s
   568   580 28623.0395   15  269 23997.9819 37159.9798  54.8%  5854  436s
   601   612 28525.4013   16  265 23997.9819 37159.9798  54.8%  5835  444s
   635   642 28106.9442   17  223 23997.9819 37159.9798  54.8%  5876  450s
   669   672 28384.3432   17  253 23997.9819 37159.9798  54.8%  5855  457s
   703   704 28493.9259   16  221 23997.9819 37159.9798  54.8%  5845  463s
   737   742 27714.1078   17  228 23997.9819 37159.9798  54.8%  5763  468s
   776   777 27906.0714   18  260 23997.9819 37159.9798  54.8%  5684  478s
   825   827 27537.9164   18  198 23997.9819 37159.9798  54.8%  5546  485s
   877   885 27802.3305   19  252 23997.9819 37159.9798  54.8%  5481  493s
   941   926 27790.0003   19  257 23997.9819 37159.9798  54.8%  5298  502s
  1002   961 27789.1413   20  210 23997.9819 36910.4558  53.8%  5185  512s
  1051  1002 27620.4906   21  208 23997.9819 36606.5728  52.5%  5138  522s
  1122  1023     cutoff   22      23997.9819 36606.5728  52.5%  5136  533s
  1157  1057 26270.7508   23  159 23997.9819 36495.3948  52.1%  5181  542s
  1193  1105 25501.0190   24  154 23997.9819 36495.3948  52.1%  5274  552s
  1253  1161 25933.9754   23  216 23997.9819 36495.3948  52.1%  5259  562s
  1321  1222     cutoff   25      23997.9819 36495.3948  52.1%  5235  574s
  1412  1266 26136.3341   25  158 23997.9819 36495.3948  52.1%  5181  588s
  1496  1335     cutoff   29      23997.9819 36495.3948  52.1%  5142  602s
  1591  1414 24856.3352   33  157 23997.9819 36495.3948  52.1%  5117  612s
  1706  1499 24709.8090   40  125 23997.9819 36234.6091  51.0%  5034  624s
  1825  1527 24585.4184   45  122 23997.9819 36157.8625  50.7%  4990  634s
  1860  1549 infeasible   46      23997.9819 36082.0273  50.4%  4993  647s
H 1889  1549                    24791.238599 36082.0273  45.5%  4983  647s
H 1898  1549                    25664.830938 36082.0273  40.6%  4991  647s
  1904  1608 33859.7680    6  387 25664.8309 36082.0273  40.6%  5004  662s
  2085  1696 32294.2060    8  326 25664.8309 35858.0262  39.7%  4924  678s
  2223  1768 31338.2369    9  313 25664.8309 35857.7981  39.7%  4974  694s
  2375  1842 31665.9668   11  372 25664.8309 35857.7981  39.7%  4973  709s
  2541  1845 30718.7277   13  297 25664.8309 35857.7981  39.7%  4987  725s
  2694  1933 30780.9139   14  295 25664.8309 35625.2715  38.8%  5012  742s
  2840  2079 30177.8214   20  243 25664.8309 35625.2715  38.8%  5027  757s
  3036  2168 29990.4737   20  265 25664.8309 35625.2715  38.8%  4978  774s
  3217  2250 29484.0598   32  103 25664.8309 35625.2715  38.8%  4958  793s
  3414  2365 29088.0193   35  100 25664.8309 35625.2715  38.8%  4968  812s
  3639  2453 28266.3593   41   87 25664.8309 34782.5636  35.5%  4951  830s
  3825  2539 28006.9955   47   75 25664.8309 34489.6575  34.4%  4985  849s
  4037  2639 27022.2787   48   74 25664.8309 34334.4718  33.8%  5008  871s
  4248  2768 26817.2606   53   80 25664.8309 34318.6784  33.7%  5033  891s
H 4479  2754                    25726.252995 34200.9992  32.9%  5034  919s
  4480  2755 32987.6508    8  540 25726.2530 34200.9992  32.9%  5033 1071s
  4482  2756 28951.7278   42  193 25726.2530 34200.9992  32.9%  5031 1092s
  4483  2757 26687.1160   20  335 25726.2530 34200.9992  32.9%  5030 1115s
  4484  2758 28240.5178   31  397 25726.2530 34200.9992  32.9%  5029 1129s
  4485  2758 31577.4638   12  455 25726.2530 34200.9992  32.9%  5028 1138s
  4486  2759 27504.4963   14  491 25726.2530 34200.9992  32.9%  5027 1146s
  4487  2760 27566.3736   29  489 25726.2530 34200.9992  32.9%  5025 1155s
  4489  2761 27651.4969   24  487 25726.2530 34200.9992  32.9%  5023 1163s
  4490  2762 29506.0084   13  529 25726.2530 34200.9992  32.9%  5022 1166s
  4491  2762 31333.4572   12  527 25726.2530 34200.9992  32.9%  5021 1170s
  4494  2764 29878.8945   13  532 25726.2530 34200.9992  32.9%  5018 1178s
  4495  2765 29416.7518   31  486 25726.2530 34200.9992  32.9%  5016 1187s
  4496  2766 26103.5445   32  518 25726.2530 34200.9992  32.9%  5015 1190s
  4498  2767 27607.2364   25  472 25726.2530 34200.9992  32.9%  5013 1195s
  4499  2768 31803.4452    8  473 25726.2530 34200.9992  32.9%  5012 1202s
  4500  2768 29464.0811    8  488 25726.2530 34200.9992  32.9%  5011 1205s
  4501  2769 28945.6836   30  507 25726.2530 34200.9992  32.9%  5010 1212s
  4502  2770 30164.2473   12  509 25726.2530 34200.9992  32.9%  5009 1215s
  4504  2771 31637.1095   23  476 25726.2530 34200.9992  32.9%  5006 1221s
  4506  2772 28342.6215   40  495 25726.2530 34200.9992  32.9%  5004 1234s
  4507  2773 28095.4826   20  495 25726.2530 34200.9992  32.9%  5003 1236s
  4508  2774 26987.3774   27  494 25726.2530 34200.9992  32.9%  5002 1241s
  4510  2775 29101.6417   34  441 25726.2530 34200.9992  32.9%  5000 1249s
  4511  2776 27964.8384   25  438 25726.2530 34200.9992  32.9%  4999 1250s
  4513  2777 33349.9547    8  466 25726.2530 34200.9992  32.9%  4996 1258s
  4514  2778 27517.3325   32  466 25726.2530 34200.9992  32.9%  4995 1278s
  4515  2778 25944.6477   32  466 25726.2530 34200.9992  32.9%  4994 1332s
  4516  2781 34200.9992   10  359 25726.2530 34200.9992  32.9%  5041 1341s
  4517  2784 34200.9992   11  341 25726.2530 34200.9992  32.9%  5041 1354s
  4520  2789 33599.9879   12  314 25726.2530 34200.9992  32.9%  5042 1366s
  4526  2799 33402.6134   13  382 25726.2530 34200.9992  32.9%  5048 1379s
  4538  2807 34200.9992   13  426 25726.2530 34200.9992  32.9%  5072 1404s
  4550  2834 31743.8668   14  351 25726.2530 34200.9992  32.9%  5099 1432s
  4581  2861 34200.9992   14  411 25726.2530 34200.9992  32.9%  5143 1451s
  4619  2889 33073.7565   15  415 25726.2530 34200.9992  32.9%  5221 1468s
  4659  2912 33669.2267   17  388 25726.2530 34200.9992  32.9%  5224 1486s
  4698  2925 31964.0093   18  370 25726.2530 34200.9992  32.9%  5251 1503s
  4740  2925 31380.7643   19  376 25726.2530 34200.9992  32.9%  5273 1519s
  4798  2924 31324.3258   20  331 25726.2530 34200.9992  32.9%  5322 1546s
  4859  2922 30935.3055   21  293 25726.2530 34200.9992  32.9%  5355 1562s
  4918  2933 30679.8818   22  273 25726.2530 34200.9992  32.9%  5411 1576s
  4966  2938 30515.2358   24  217 25726.2530 34200.9992  32.9%  5434 1590s
  5021  2949 29720.6341   25  209 25726.2530 34200.9992  32.9%  5454 1602s
  5070  2957 29482.1497   27  136 25726.2530 34200.9992  32.9%  5466 1617s
  5126  2961 28376.5781   29  187 25726.2530 34200.9992  32.9%  5462 1629s
  5187  2969 28892.4800   31  248 25726.2530 34200.9992  32.9%  5460 1640s
  5243  2985 28851.3222   33  208 25726.2530 33535.4318  30.4%  5455 1652s
  5302  2977 28115.7708   35  160 25726.2530 33535.4318  30.4%  5442 1665s
  5367  2973 26801.3224   36  163 25726.2530 33535.4318  30.4%  5433 1678s
  5425  2972     cutoff   37      25726.2530 33535.4318  30.4%  5429 1691s
  5499  2989 27613.5071   19  361 25726.2530 33535.4318  30.4%  5437 1704s
  5572  2991 27364.3277   20  343 25726.2530 33535.4318  30.4%  5437 1718s
  5637  2988 27260.6624   21  336 25726.2530 33162.7385  28.9%  5421 1733s
  5727  2976 26141.0407   24  236 25726.2530 32487.3433  26.3%  5399 1748s
  5806  2982     cutoff   25      25726.2530 32487.3433  26.3%  5403 1763s
  5887  2986 26940.1404   29  174 25726.2530 32226.0114  25.3%  5393 1779s
  5982  2976 26263.0369   37  202 25726.2530 32226.0114  25.3%  5388 1796s
  6096  2963 28847.8508   18  251 25726.2530 32226.0114  25.3%  5369 1811s
  6170  2952 27377.9464   19  278 25726.2530 31795.8306  23.6%  5366 1827s
  6296  2905 27097.2713   20  233 25726.2530 31587.1449  22.8%  5345 1846s
  6440  2879 26385.3652   25  110 25726.2530 31541.3420  22.6%  5328 1867s
  6563  2850     cutoff   28      25726.2530 31541.3420  22.6%  5335 1890s
  6699  2813 29755.8342   22  405 25726.2530 31541.3420  22.6%  5332 1910s
  6822  2800 29155.7981   23  328 25726.2530 31541.3420  22.6%  5329 1931s
  6955  2789 27283.6644   24  211 25726.2530 31541.3420  22.6%  5337 1952s
  7120  2774 26764.0480   28  238 25726.2530 31541.3420  22.6%  5338 1974s
  7328  2715     cutoff   31      25726.2530 30331.9389  17.9%  5316 1999s
  7581  2637 27111.2265   19  266 25726.2530 30331.9389  17.9%  5275 2016s
  7633  2628 25915.7400   20  208 25726.2530 30331.9389  17.9%  5281 2033s
  7700  2624 25760.5141   21  157 25726.2530 29894.3053  16.2%  5273 2056s
  7822  2593 26226.4523   21  300 25726.2530 29894.3053  16.2%  5265 2081s
  8010  2567 26302.4520   24  316 25726.2530 29894.3053  16.2%  5258 2107s
  8277  2523 27343.4553   25  243 25726.2530 29894.3053  16.2%  5223 2132s
  8539  2498 26637.9009   25  255 25726.2530 29168.3830  13.4%  5207 2159s
  8867  2403     cutoff   21      25726.2530 29068.3941  13.0%  5162 2187s
  9216  2318 26190.7008   31  195 25726.2530 28800.5639  12.0%  5129 2215s
  9620  2188 26378.3811   25  235 25726.2530 28574.2332  11.1%  5073 2242s
 10039  2059 27318.4410   22  322 25726.2530 28352.4221  10.2%  5019 2269s
 10509  1901 25875.0776   33  176 25726.2530 27959.0682  8.68%  4954 2297s
 11094  1774 26883.4360   26   85 25726.2530 27674.2755  7.57%  4853 2327s
 11744  1527 26655.1881   30  187 25726.2530 27491.3709  6.86%  4740 2356s
 12429  1228 26041.1317   33  135 25726.2530 27285.8036  6.06%  4631 2382s
 13273   931 26312.0673   28  179 25726.2530 27086.7506  5.29%  4491 2409s
 14132   749     cutoff   30      25726.2530 26935.6409  4.70%  4364 2435s
 15165   228 26015.5470   23  272 25726.2530 26674.2037  3.68%  4205 2459s
 16593     0     cutoff   36      25726.2530 26399.8644  2.62%  3966 2469s

Cutting planes:
  Learned: 1
  Gomory: 1
  MIR: 454
  Mixing: 5
  Flow cover: 1341
  RLT: 21
  Relax-and-lift: 123

Explored 17062 nodes (66494282 simplex iterations) in 2469.35 seconds (8005.50 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25726.3 25664.8 24791.2 ... 23319.4

Optimal solution found (tolerance 1.00e-06)
Best objective 2.572625299460e+04, best bound 2.572625299460e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2469.36s
  Master Objective (UB) = 25726.25, θ = 173475.85
  Upper Bound (UB) = 25726.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173475.85
  [DEBUG]   ✓ Scenario 0: θ = 173475.85 ≤ Q = 173475.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173475.85 ≤ Q = 173475.85 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173475.85 ≤ Q = 173475.85 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173475.85 ≤ Q = 173475.85 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3239e23c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcdc61dc4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.340139e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6192626.4549
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.574125e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157412.46    0  127 6192626.45 -157412.46   103%     -    0s
H    0     0                    -122089.8789 -157412.46  28.9%     -    0s
H    0     0                    -123094.6341 -157412.46  27.9%     -    0s
H    0     0                    -129020.7617 -157412.46  22.0%     -    0s
H    0     0                    -137172.3230 -157412.46  14.8%     -    0s
     0     0 -141354.47    0   87 -137172.32 -141354.47  3.05%     -    0s
H    0     0                    -138460.8699 -141318.87  2.06%     -    0s
     0     0 -141001.29    0   88 -138460.87 -141001.29  1.83%     -    0s
     0     0 -140303.20    0   53 -138460.87 -140303.20  1.33%     -    0s
H    0     0                    -139364.1345 -140297.88  0.67%     -    0s
     0     0 -140220.68    0   52 -139364.13 -140220.68  0.61%     -    0s
H    0     0                    -139366.6631 -140220.68  0.61%     -    0s
     0     0 -139863.44    0   41 -139366.66 -139863.44  0.36%     -    0s
     0     0 -139836.76    0   45 -139366.66 -139836.76  0.34%     -    0s
     0     0 -139836.00    0   36 -139366.66 -139836.00  0.34%     -    0s
     0     0 -139696.42    0   31 -139366.66 -139696.42  0.24%     -    0s
     0     0 -139661.58    0   30 -139366.66 -139661.58  0.21%     -    0s
     0     0 -139637.11    0   26 -139366.66 -139637.11  0.19%     -    0s
H    0     0                    -139381.7456 -139593.02  0.15%     -    0s
     0     0 -139593.02    0   34 -139381.75 -139593.02  0.15%     -    0s
     0     0 -139573.33    0   35 -139381.75 -139573.33  0.14%     -    0s
     0     0 -139519.53    0   35 -139381.75 -139519.53  0.10%     -    0s
     0     0 -139519.53    0   31 -139381.75 -139519.53  0.10%     -    0s
     0     0 -139519.53    0   32 -139381.75 -139519.53  0.10%     -    0s
H    0     0                    -139385.6904 -139519.53  0.10%     -    0s
     0     0 -139482.10    0   30 -139385.69 -139482.10  0.07%     -    0s
     0     0 -139465.59    0   14 -139385.69 -139465.59  0.06%     -    0s
     0     0 -139463.40    0   11 -139385.69 -139463.40  0.06%     -    0s
     0     0 -139459.30    0   11 -139385.69 -139459.30  0.05%     -    0s
     0     0 -139405.91    0    4 -139385.69 -139405.91  0.01%     -    0s
H    0     0                    -139391.8902 -139404.25  0.01%     -    0s
     0     0 -139404.25    0    2 -139391.89 -139404.25  0.01%     -    0s
     0     0 -139404.25    0    8 -139391.89 -139404.25  0.01%     -    0s
*    0     0               0    -139404.0867 -139404.09  0.00%     -    0s

Cutting planes:
  MIR: 4
  Flow cover: 5

Explored 1 nodes (879 simplex iterations) in 0.08 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -139404 -139392 -139386 ... -123095
No other solutions better than -139404

Optimal solution found (tolerance 1.00e-06)
Best objective -1.394040867069e+05, best bound -1.394040867069e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 159018.33
  Scenario: 41 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -139404.09
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -139404.09 = 159018.33
  [DEBUG]   Current θ from Master = 173475.85
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14457.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11268.73
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 1947.7755, Absolute Gap = 1947.7755, Relative Gap = 0.075712
  Not converged yet (gap = 1947.78 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 41 increases, 18 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394544 nonzeros
Model fingerprint: 0x79d1dd85
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 65568 rows and 26628 columns
Presolve time: 1.20s
Presolved: 73425 rows, 31792 columns, 457319 nonzeros
Variable types: 29533 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 73425 rows, 31792 columns, 457319 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34763   -5.2848437e+04   0.000000e+00   1.733140e+09      5s
   50409    1.1855259e+04   0.000000e+00   4.250658e+06     10s
   62628    2.3896942e+04   0.000000e+00   2.239728e+06     15s
   73219    2.9460594e+04   0.000000e+00   2.563525e+07     20s
   83018    3.3164234e+04   0.000000e+00   1.826220e+06     25s
   93479    3.6609124e+04   0.000000e+00   2.838935e+07     30s
  101069    3.7041608e+04   0.000000e+00   1.973689e+07     35s
Concurrent spin time: 5.43s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.954059e+04, 96478 iterations, 43.25 seconds (78.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49540.5914    0  190 -207405.59 49540.5914   124%     -   45s
H    0     0                    -202172.9269 49540.5914   125%     -   45s
H    0     0                    -114692.8750 49540.5914   143%     -   45s
H    0     0                    -88356.35950 49540.5914   156%     -   45s
H    0     0                    -87658.86872 49540.5914   157%     -   45s
H    0     0                    -69365.66172 49540.5914   171%     -   45s
H    0     0                    -3636.644388 49540.5914  1462%     -   45s
H    0     0                    8489.7123737 49540.5914   484%     -   45s
H    0     0                    9804.6677677 49540.5914   405%     -   45s
H    0     0                    10235.831698 49540.5914   384%     -   45s
H    0     0                    10571.544102 45567.9134   331%     -   63s
H    0     0                    10751.060926 45567.9134   324%     -   63s
     0     0 45537.5057    0  182 10751.0609 45537.5057   324%     -   63s
     0     0 44528.7261    0  277 10751.0609 44528.7261   314%     -   73s
     0     0 44374.2362    0  244 10751.0609 44374.2362   313%     -   76s
     0     0 44373.8188    0  245 10751.0609 44373.8188   313%     -   76s
     0     0 44373.6277    0  246 10751.0609 44373.6277   313%     -   77s
     0     0 44373.6277    0  249 10751.0609 44373.6277   313%     -   80s
     0     0 44373.6277    0  276 10751.0609 44373.6277   313%     -   83s
     0     0 44373.6277    0  274 10751.0609 44373.6277   313%     -   84s
     0     0 44373.6277    0  278 10751.0609 44373.6277   313%     -   85s
     0     0 44373.6277    0  285 10751.0609 44373.6277   313%     -   85s
H    0     0                    15602.407213 41432.3195   166%     -  103s
H    0     0                    16067.753105 41432.3195   158%     -  103s
     0     0 41432.3195    0  323 16067.7531 41432.3195   158%     -  103s
H    0     0                    20257.601220 41432.2204   105%     -  104s
H    0     0                    20260.550012 41432.2204   104%     -  104s
H    0     0                    20421.135331 41432.2204   103%     -  104s
     0     0 41032.5944    0  326 20421.1353 41032.5944   101%     -  112s
     0     0 40836.9165    0  335 20421.1353 40836.9165   100%     -  117s
     0     0 40753.8443    0  377 20421.1353 40753.8443   100%     -  122s
     0     0 40705.4976    0  362 20421.1353 40705.4976  99.3%     -  124s
     0     0 40691.5581    0  371 20421.1353 40691.5581  99.3%     -  126s
     0     0 40677.2097    0  369 20421.1353 40677.2097  99.2%     -  127s
     0     0 40673.0912    0  363 20421.1353 40673.0912  99.2%     -  128s
     0     0 40664.9458    0  367 20421.1353 40664.9458  99.1%     -  129s
     0     0 40664.0537    0  367 20421.1353 40664.0537  99.1%     -  130s
     0     0 40658.9041    0  368 20421.1353 40658.9041  99.1%     -  131s
     0     0 40657.9890    0  375 20421.1353 40657.9890  99.1%     -  132s
     0     0 40652.1662    0  374 20421.1353 40652.1662  99.1%     -  132s
     0     0 40651.4712    0  372 20421.1353 40651.4712  99.1%     -  132s
     0     0 39457.8502    0  382 20421.1353 39457.8502  93.2%     -  153s
H    0     0                    22147.720201 39457.4402  78.2%     -  154s
H    0     0                    22190.846508 39457.4402  77.8%     -  154s
H    0     0                    22293.782818 39457.4402  77.0%     -  154s
     0     0 39133.8581    0  428 22293.7828 39133.8581  75.5%     -  162s
     0     0 38958.9636    0  397 22293.7828 38958.9636  74.8%     -  170s
     0     0 38912.9720    0  397 22293.7828 38912.9720  74.5%     -  173s
     0     0 38856.0447    0  397 22293.7828 38856.0447  74.3%     -  178s
     0     0 38823.2321    0  400 22293.7828 38823.2321  74.1%     -  180s
     0     0 38812.2548    0  398 22293.7828 38812.2548  74.1%     -  182s
     0     0 38802.5949    0  397 22293.7828 38802.5949  74.1%     -  184s
     0     0 38797.3643    0  409 22293.7828 38797.3643  74.0%     -  185s
     0     0 38751.3324    0  403 22293.7828 38751.3324  73.8%     -  188s
     0     0 38743.1762    0  404 22293.7828 38743.1762  73.8%     -  189s
     0     0 38738.5139    0  408 22293.7828 38738.5139  73.8%     -  190s
     0     0 38736.7981    0  403 22293.7828 38736.7981  73.8%     -  191s
     0     0 38735.8606    0  405 22293.7828 38735.8606  73.8%     -  192s
H    0     0                    22327.249618 38416.4527  72.1%     -  207s
     0     0 38416.4527    0  475 22327.2496 38416.4527  72.1%     -  207s
     0     0 38282.1379    0  469 22327.2496 38282.1379  71.5%     -  212s
     0     0 38229.8191    0  481 22327.2496 38229.8191  71.2%     -  216s
     0     0 38184.5786    0  482 22327.2496 38184.5786  71.0%     -  220s
     0     0 38168.5618    0  430 22327.2496 38168.5618  71.0%     -  222s
     0     0 38163.6205    0  483 22327.2496 38163.6205  70.9%     -  223s
     0     0 38160.8436    0  493 22327.2496 38160.8436  70.9%     -  224s
     0     0 38160.6061    0  488 22327.2496 38160.6061  70.9%     -  225s
     0     0 38051.2802    0  473 22327.2496 38051.2802  70.4%     -  232s
H    0     0                    22683.844001 38051.0444  67.7%     -  232s
     0     0 38012.1421    0  479 22683.8440 38012.1421  67.6%     -  236s
     0     0 37993.4365    0  474 22683.8440 37993.4365  67.5%     -  238s
     0     0 37986.2437    0  426 22683.8440 37986.2437  67.5%     -  239s
     0     0 37980.9310    0  421 22683.8440 37980.9310  67.4%     -  240s
     0     0 37977.8720    0  484 22683.8440 37977.8720  67.4%     -  241s
     0     0 37971.2744    0  481 22683.8440 37971.2744  67.4%     -  242s
     0     0 37965.2517    0  477 22683.8440 37965.2517  67.4%     -  244s
     0     0 37965.0996    0  425 22683.8440 37965.0996  67.4%     -  244s
     0     0 37851.7561    0  467 22683.8440 37851.7561  66.9%     -  249s
H    0     0                    22771.588261 37851.0670  66.2%     -  249s
     0     0 37824.4768    0  477 22771.5883 37824.4768  66.1%     -  252s
     0     0 37797.9416    0  476 22771.5883 37797.9416  66.0%     -  254s
     0     0 37787.6165    0  478 22771.5883 37787.6165  65.9%     -  255s
     0     0 37783.4339    0  474 22771.5883 37783.4339  65.9%     -  256s
     0     0 37781.8541    0  481 22771.5883 37781.8541  65.9%     -  257s
     0     0 37778.6822    0  471 22771.5883 37778.6822  65.9%     -  257s
     0     0 37777.7525    0  480 22771.5883 37777.7525  65.9%     -  258s
     0     0 37743.2084    0  478 22771.5883 37743.2084  65.7%     -  261s
H    0     0                    22855.769872 37743.2068  65.1%     -  262s
H    0     0                    22862.258120 37743.2068  65.1%     -  262s
H    0     0                    22898.987489 37743.2068  64.8%     -  262s
H    0     0                    22924.472930 37743.2068  64.6%     -  262s
     0     0 37724.0838    0  486 22924.4729 37724.0838  64.6%     -  264s
     0     0 37722.1912    0  480 22924.4729 37722.1912  64.5%     -  265s
     0     0 37721.7320    0  479 22924.4729 37721.7320  64.5%     -  265s
     0     0 37700.6645    0  486 22924.4729 37700.6645  64.5%     -  268s
     0     0 37698.3875    0  478 22924.4729 37698.3875  64.4%     -  268s
     0     0 37696.7502    0  479 22924.4729 37696.7502  64.4%     -  269s
     0     0 37696.7125    0  432 22924.4729 37696.7125  64.4%     -  269s
     0     0 37674.5691    0  467 22924.4729 37674.5691  64.3%     -  271s
     0     0 37671.0040    0  504 22924.4729 37671.0040  64.3%     -  272s
     0     0 37669.1699    0  480 22924.4729 37669.1699  64.3%     -  272s
     0     0 37668.4344    0  482 22924.4729 37668.4344  64.3%     -  273s
     0     0 37663.5285    0  506 22924.4729 37663.5285  64.3%     -  274s
H    0     0                    23012.403694 37663.2034  63.7%     -  275s
     0     0 37661.3979    0  482 23012.4037 37661.3979  63.7%     -  276s
     0     0 37660.9645    0  476 23012.4037 37660.9645  63.7%     -  276s
     0     0 37658.7914    0  428 23012.4037 37658.7914  63.6%     -  278s
     0     0 37657.3790    0  433 23012.4037 37657.3790  63.6%     -  279s
     0     0 37656.4463    0  492 23012.4037 37656.4463  63.6%     -  279s
     0     0 37645.3645    0  490 23012.4037 37645.3645  63.6%     -  281s
     0     0 37645.2267    0  490 23012.4037 37645.2267  63.6%     -  282s
H    0     0                    23042.167042 37645.2267  63.4%     -  326s
H    0     0                    23069.206663 37645.2267  63.2%     -  326s
H    0     0                    23075.789929 37645.2267  63.1%     -  326s
H    0     0                    23132.714987 37645.2267  62.7%     -  328s
     0     2 37645.2267    0  490 23132.7150 37645.2267  62.7%     -  338s
     1     4 37560.3234    1  469 23132.7150 37644.4130  62.7%  3077  344s
     3     8 36909.8212    2  435 23132.7150 37559.3085  62.4%  6458  353s
     7    16 36531.8102    3  432 23132.7150 36909.4997  59.6%  8104  368s
    15    32 36397.8230    4  477 23132.7150 36531.5437  57.9%  9757  384s
    31    48 35755.8827    5  447 23132.7150 36426.9712  57.5% 13627  411s
H   47    80                    23226.959399 36426.9712  56.8% 12174  426s
H   56    80                    23448.311456 36426.9712  55.4% 11569  426s
    79   144 35251.2434    7  431 23448.3115 36426.9712  55.4%  9893  469s
H  143   194                    23476.145728 36426.9712  55.2%  6796  484s
H  145   194                    23507.666846 36426.9712  55.0%  6767  484s
H  146   194                    23677.594162 36426.9712  53.8%  6740  484s
   193   322 35118.4944   10  415 23677.5942 36426.9712  53.8%  5834  499s
H  321   354                    23748.091676 36426.9712  53.4%  4638  510s
H  323   354                    23808.766841 36426.9712  53.0%  4630  510s
   353   428 34734.6332   14  399 23808.7668 36426.9712  53.0%  4505  522s
   427   501 34559.6213   12  391 23808.7668 36426.9712  53.0%  4415  533s
   502   567 34454.6759   15  392 23808.7668 36426.9712  53.0%  4338  547s
   568   658 34489.3324   14  346 23808.7668 36426.9712  53.0%  4218  561s
   661   737 34160.3550   15  367 23808.7668 36426.9712  53.0%  3963  571s
   740   820 34202.6836   15  380 23808.7668 36426.9712  53.0%  3834  582s
   825   911 34368.3814   15  376 23808.7668 36426.9712  53.0%  3675  592s
   916  1001 34270.1115   16  384 23808.7668 36426.9712  53.0%  3522  602s
  1012  1099 34084.6783   16  418 23808.7668 36426.9712  53.0%  3395  617s
  1126  1189 31431.9996   37  383 23808.7668 36426.9712  53.0%  3217  634s
  1254  1259 34149.8320   16  381 23808.7668 36426.9712  53.0%  3065  646s
  1349  1308 34021.3123   16  341 23808.7668 36426.9712  53.0%  3013  657s
  1441  1365 32651.6356   17  227 23808.7668 36426.9712  53.0%  2983  670s
  1545  1432 33267.8652   17  364 23808.7668 36426.9712  53.0%  2946  683s
  1634  1501 34066.8316   18  390 23808.7668 36426.9712  53.0%  2935  696s
  1719  1583 33651.5582   20  384 23808.7668 36426.9712  53.0%  2965  709s
  1823  1657 32398.7373   21  349 23808.7668 36426.9712  53.0%  2960  723s
  1931  1737 32978.6583   20  360 23808.7668 36426.9712  53.0%  2937  738s
  2043  1819 32328.9507   22  346 23808.7668 36426.9712  53.0%  2924  752s
  2164  1854 32436.3558   25  363 23808.7668 36426.9712  53.0%  2911  766s
H 2176  1854                    23920.124906 36426.9712  52.3%  2903  766s
  2227  1942 31033.5815   25  298 23920.1249 36426.9712  52.3%  2896  781s
  2345  1974 32138.6908   26  352 23920.1249 36051.3131  50.7%  2917  790s
  2377  2010 31032.6578   24  269 23920.1249 36051.3131  50.7%  2952  802s
H 2380  2010                    23997.981883 36051.3131  50.2%  2952  802s
  2413  2090 30882.6197   26  362 23997.9819 36051.3131  50.2%  2979  818s
  2517  2173 31815.1558   27  329 23997.9819 36051.3131  50.2%  2993  837s
  2624  2293 30749.0836   26  282 23997.9819 36051.3131  50.2%  3014  852s
  2757  2370 31423.5910   28  314 23997.9819 36051.3131  50.2%  3026  871s
  2906  2426 29122.9993   27  324 23997.9819 35872.4358  49.5%  3024  888s
  2968  2494 28750.4268   29  304 23997.9819 35816.2286  49.2%  3070  902s
H 2997  2471                    24609.038883 35816.2286  45.5%  3073  902s
H 3025  2462                    24677.454531 35816.2286  45.1%  3084  902s
  3056  2530 29223.5900   31  299 24677.4545 35816.2286  45.1%  3077  921s
  3223  2658 29044.5601   33  300 24677.4545 35816.2286  45.1%  3084  941s
  3398  2795 28147.4892   36  382 24677.4545 35493.7816  43.8%  3084  963s
H 3599  2740                    25042.134523 35493.7816  41.7%  3066  971s
H 3599  2646                    25447.774911 35493.7816  39.5%  3066  980s
H 3599  2645                    25461.017711 35493.7816  39.4%  3066  982s
H 3599  2641                    25474.891314 35493.7816  39.3%  3066  990s
  3600  2638 26508.2530   52  490 25474.8913 35493.7816  39.3%  3065 1023s
  3602  2639 33868.5194   17  190 25474.8913 35493.7816  39.3%  3063 1054s
H 3602  2507                    25491.216159 35493.7816  39.2%  3063 1081s
H 3602  2381                    25545.200083 35493.7816  38.9%  3063 1081s
  3604  2383 27135.6036   49  394 25545.2001 35493.7816  38.9%  3062 1098s
  3605  2383 33764.4332   19  447 25545.2001 35493.7816  38.9%  3061 1108s
  3606  2384 33103.5296    8  456 25545.2001 35493.7816  38.9%  3060 1115s
  3607  2385 34692.6599   14  461 25545.2001 35493.7816  38.9%  3059 1120s
  3608  2385 30816.7225   35  477 25545.2001 35493.7816  38.9%  3058 1126s
  3609  2386 31914.0270   23  480 25545.2001 35493.7816  38.9%  3057 1131s
  3611  2387 26912.2432   39  491 25545.2001 35493.7816  38.9%  3056 1137s
  3613  2389 27994.0640   46  511 25545.2001 35493.7816  38.9%  3054 1141s
  3615  2390 33915.9734   17  449 25545.2001 35493.7816  38.9%  3052 1147s
  3616  2391 34477.9421   14  481 25545.2001 35493.7816  38.9%  3051 1153s
  3617  2391 30458.3241   32  470 25545.2001 35493.7816  38.9%  3050 1155s
  3619  2393 25786.3421   40  485 25545.2001 35493.7816  38.9%  3049 1164s
  3620  2393 26182.1942   62  515 25545.2001 35493.7816  38.9%  3048 1165s
  3622  2395 25550.0198   53  486 25545.2001 35493.7816  38.9%  3046 1172s
  3623  2395 25939.1726   37  473 25545.2001 35493.7816  38.9%  3045 1175s
  3624  2396 26284.0489   46  490 25545.2001 35493.7816  38.9%  3045 1180s
  3626  2397 29942.1689   45  487 25545.2001 35493.7816  38.9%  3043 1185s
H 3626  2277                    25575.475032 35493.7816  38.8%  3043 1192s
  3629  2279 26052.5534   28  477 25575.4750 35493.7816  38.8%  3040 1196s
  3630  2280 32648.4107   10  476 25575.4750 35493.7816  38.8%  3040 1205s
  3632  2281 26307.0744   48  457 25575.4750 35493.7816  38.8%  3038 1211s
  3633  2282 25751.5458   33  512 25575.4750 35493.7816  38.8%  3037 1219s
  3634  2283 27122.7293   48  516 25575.4750 35493.7816  38.8%  3036 1222s
  3635  2283 29356.2499   34  526 25575.4750 35493.7816  38.8%  3035 1228s
  3636  2284 26887.0312   38  530 25575.4750 35493.7816  38.8%  3035 1231s
  3637  2285 30013.3025   20  520 25575.4750 35493.7816  38.8%  3034 1237s
  3638  2285 31201.8190   25  523 25575.4750 35493.7816  38.8%  3033 1240s
  3639  2286 25864.0077   42  525 25575.4750 35493.7816  38.8%  3032 1245s
  3641  2287 26529.7573   22  530 25575.4750 35493.7816  38.8%  3030 1250s
  3642  2288 31258.0551   28  527 25575.4750 35493.7816  38.8%  3030 1255s
  3643  2289 26017.8245   34  527 25575.4750 35493.7816  38.8%  3029 1287s
  3644  2289 28477.7220   30  527 25575.4750 35493.7816  38.8%  3028 1326s
  3645  2293 35493.7816   10  512 25575.4750 35493.7816  38.8%  3092 1370s
  3647  2296 35493.7816   11  518 25575.4750 35493.7816  38.8%  3094 1387s
  3651  2303 35493.7816   12  492 25575.4750 35493.7816  38.8%  3098 1403s
  3659  2316 35493.7816   13  484 25575.4750 35493.7816  38.8%  3124 1425s
  3675  2327 34384.3299   14  474 25575.4750 35493.7816  38.8%  3175 1467s
  3691  2354 33067.6952   15  450 25575.4750 35493.7816  38.8%  3264 1489s
  3723  2430 32771.6930   16  479 25575.4750 35493.7816  38.8%  3303 1511s
  3810  2433 32285.8339   18  391 25575.4750 35493.7816  38.8%  3421 1525s
  3842  2454 31934.3360   17  301 25575.4750 35493.7816  38.8%  3434 1539s
  3874  2477 31133.8173   18  379 25575.4750 35493.7816  38.8%  3481 1553s
  3907  2498 30946.8740   19  452 25575.4750 35493.7816  38.8%  3511 1565s
H 3934  2374                    25669.133781 35493.7816  38.3%  3521 1565s
  3939  2405 30730.4829   18  364 25669.1338 35493.7816  38.3%  3523 1577s
  3973  2439 28995.2083   19  333 25669.1338 35493.7816  38.3%  3538 1591s
  4036  2454 28122.4996   18  332 25669.1338 35493.7816  38.3%  3556 1607s
  4122  2449 30382.0410   19  368 25669.1338 35493.7816  38.3%  3559 1627s
  4204  2468 29627.7980   19  356 25669.1338 35493.7816  38.3%  3567 1641s
  4282  2471 30590.3891   20  446 25669.1338 35493.7816  38.3%  3571 1654s
  4361  2461 27997.1952   19  308 25669.1338 35493.7816  38.3%  3567 1667s
  4434  2450 30583.0402   21  400 25669.1338 35493.7816  38.3%  3563 1680s
  4496  2457 30275.7588   22  446 25669.1338 35493.7816  38.3%  3567 1696s
  4574  2431 28728.2808   23  454 25669.1338 35493.7816  38.3%  3565 1710s
  4645  2420 28265.2841   23  469 25669.1338 35493.7816  38.3%  3572 1731s
  4717  2438 28005.1571   22  305 25669.1338 35493.7816  38.3%  3573 1752s
  4791  2433 28230.6784   24  460 25669.1338 35493.7816  38.3%  3581 1768s
  4874  2442 27079.4427   23  344 25669.1338 35493.7816  38.3%  3585 1790s
  4946  2456 27888.7061   25  407 25669.1338 35180.7213  37.1%  3593 1806s
  5018  2461     cutoff   26      25669.1338 35180.7213  37.1%  3601 1824s
  5099  2444     cutoff   28      25669.1338 35031.2063  36.5%  3613 1840s
  5179  2450 30451.5403   17  361 25669.1338 34491.2916  34.4%  3627 1858s
  5261  2466 27659.0756   18  343 25669.1338 33690.5566  31.2%  3649 1876s
  5344  2484 26401.2230   20  309 25669.1338 33690.5566  31.2%  3669 1894s
  5446  2491 26069.7684   22  317 25669.1338 33621.5125  31.0%  3681 1914s
  5572  2462     cutoff   24      25669.1338 33621.5125  31.0%  3689 1933s
  5644  2468     cutoff   23      25669.1338 33621.5125  31.0%  3703 1952s
  5747  2463 27505.8665   30  249 25669.1338 33621.5125  31.0%  3712 1975s
  5870  2464 26708.3097   33  180 25669.1338 33621.5125  31.0%  3713 1999s
  6006  2459 26633.5992   38   94 25669.1338 32835.1968  27.9%  3726 2028s
  6157  2451 29169.0702   18  362 25669.1338 32835.1968  27.9%  3728 2055s
  6298  2438 27223.3051   23  294 25669.1338 32685.8068  27.3%  3748 2081s
  6449  2428 26296.7832   28  204 25669.1338 32685.8068  27.3%  3763 2108s
  6620  2398 29629.1106   18  422 25669.1338 32685.8068  27.3%  3773 2135s
  6795  2392 29171.0443   20  358 25669.1338 32364.4913  26.1%  3781 2165s
  6987  2345 28378.3978   23  321 25669.1338 31544.7021  22.9%  3788 2185s
  7031  2352 28097.5429   24  324 25669.1338 31341.4173  22.1%  3797 2212s
  7098  2397 27942.6608   24  381 25669.1338 31341.4173  22.1%  3799 2240s
  7267  2356 27576.2346   25  318 25669.1338 31291.7877  21.9%  3779 2267s
  7315  2352 27152.0060   26  255 25669.1338 31256.5461  21.8%  3786 2295s
  7372  2352 26845.9669   27  281 25669.1338 31256.5461  21.8%  3791 2326s
  7438  2367 25750.6020   26  109 25669.1338 31237.8371  21.7%  3800 2355s
  7565  2339     cutoff   27      25669.1338 31237.8371  21.7%  3796 2388s
  7736  2307 28357.7175   23  356 25669.1338 31130.2904  21.3%  3802 2427s
  7977  2269 27054.3025   25  360 25669.1338 31130.2904  21.3%  3811 2467s
  8244  2206     cutoff   31      25669.1338 30811.8630  20.0%  3814 2507s
  8520  2162 26029.4824   25  182 25669.1338 30731.0970  19.7%  3826 2548s
  8823  2111 25847.6022   25  312 25669.1338 30403.5221  18.4%  3833 2591s
  9145  2026 26781.4886   31  252 25669.1338 30262.7646  17.9%  3842 2636s
  9496  1930     cutoff   20      25669.1338 30027.4636  17.0%  3841 2680s
  9845  1812 26595.4054   28  223 25669.1338 29892.7266  16.5%  3848 2728s
 10205  1707 28985.9611   22  351 25669.1338 29727.5021  15.8%  3855 2776s
 10602  1714 26707.9842   20  229 25669.1338 29581.2256  15.2%  3860 2827s
 11017  1674 26748.1656   29  317 25669.1338 29403.8286  14.5%  3861 2882s
 11451  1676 27239.9515   24  181 25669.1338 29101.1691  13.4%  3857 2934s
 11962  1672 26111.7775   30  283 25669.1338 28987.0883  12.9%  3840 2988s
 12469  1622 infeasible   26      25669.1338 28708.4015  11.8%  3825 3044s
 13029  1570     cutoff   27      25669.1338 28647.5545  11.6%  3808 3100s
 13699  1491 26526.4094   22  298 25669.1338 28288.2760  10.2%  3771 3164s
 14360  1357 25968.5946   29  174 25669.1338 27956.9572  8.91%  3744 3226s
 15244  1174 26430.4924   25  290 25669.1338 27780.8069  8.23%  3673 3286s
 16147   887 26690.9041   27  167 25669.1338 27454.7056  6.96%  3610 3346s
 17319   349 26024.6862   32  219 25669.1338 27037.8020  5.33%  3508 3400s
 18893     0 25953.6332   33  106 25669.1338 26592.5412  3.60%  3348 3427s

Cutting planes:
  Learned: 1
  MIR: 602
  Flow cover: 1806
  Zero half: 1
  RLT: 19
  Relax-and-lift: 186

Explored 19435 nodes (64152539 simplex iterations) in 3427.10 seconds (10589.54 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25669.1 25575.5 25545.2 ... 24609

Optimal solution found (tolerance 1.00e-06)
Best objective 2.566913378063e+04, best bound 2.566913378063e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3427.17s
  Master Objective (UB) = 25669.13, θ = 172607.84
  Upper Bound (UB) = 25669.13

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 172607.84
  [DEBUG]   ✓ Scenario 0: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 172607.84 ≤ Q = 172607.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 172607.84 ≤ Q = 172607.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 172607.84 ≤ Q = 172607.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 172607.84 ≤ Q = 172607.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 172607.84 ≤ Q = 172607.84 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1ab9d56e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe5462a92
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [8e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [9e-15, 2e+02]
Found heuristic solution: objective 1.336640e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6149224.1765
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.573584e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157358.37    0  121 6149224.18 -157358.37   103%     -    0s
H    0     0                    -123831.3991 -157358.37  27.1%     -    0s
H    0     0                    -124293.7138 -157358.37  26.6%     -    0s
H    0     0                    -124293.8919 -157358.37  26.6%     -    0s
H    0     0                    -124770.3378 -135787.37  8.83%     -    0s
H    0     0                    -125202.0395 -135787.37  8.45%     -    0s
     0     0 -135787.37    0   84 -125202.04 -135787.37  8.45%     -    0s
H    0     0                    -132588.7417 -135752.91  2.39%     -    0s
H    0     0                    -132942.0926 -135752.91  2.11%     -    0s
H    0     0                    -133529.3512 -135752.91  1.67%     -    0s
H    0     0                    -133882.7021 -135752.91  1.40%     -    0s
     0     0 -134992.91    0   85 -133882.70 -134992.91  0.83%     -    0s
     0     0 -134956.49    0   85 -133882.70 -134956.49  0.80%     -    0s
H    0     0                    -133947.4024 -134956.49  0.75%     -    0s
     0     0 -134541.22    0   58 -133947.40 -134541.22  0.44%     -    0s
     0     0 -134496.05    0   59 -133947.40 -134496.05  0.41%     -    0s
     0     0 -134385.78    0   57 -133947.40 -134385.78  0.33%     -    0s
     0     0 -134363.39    0   57 -133947.40 -134363.39  0.31%     -    0s
     0     2 -134363.39    0   57 -133947.40 -134363.39  0.31%     -    0s
H  105    21                    -133948.4369 -134190.48  0.18%   6.7    0s
H  110    21                    -133953.6516 -134190.48  0.18%   6.6    0s
H  687    17                    -133956.2759 -134044.51  0.07%   3.4    0s
H  728    17                    -133959.4427 -134020.40  0.05%   3.4    0s
*  768     9              35    -133978.4006 -134020.40  0.03%   3.4    0s

Cutting planes:
  Gomory: 35
  Implied bound: 6
  MIR: 160
  Flow cover: 6
  RLT: 26
  BQP: 5

Explored 806 nodes (3193 simplex iterations) in 0.18 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -133978 -133959 -133956 ... -124294
No other solutions better than -133978

Optimal solution found (tolerance 1.00e-06)
Best objective -1.339784006114e+05, best bound -1.339784006114e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 164444.01
  Scenario: 38 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133978.40
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -133978.40 = 164444.01
  [DEBUG]   Current θ from Master = 172607.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8163.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17505.31
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 1890.6563, Absolute Gap = 1890.6563, Relative Gap = 0.073655
  Not converged yet (gap = 1890.66 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 38 increases, 21 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437769 nonzeros
Model fingerprint: 0x7178c17e
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 72840 rows and 29580 columns
Presolve time: 1.17s
Presolved: 81443 rows, 35080 columns, 500459 nonzeros
Variable types: 32821 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.15s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.390e+06
 Factor NZ  : 7.257e+06 (roughly 100 MB of memory)
 Factor Ops : 1.203e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67513878e+07  1.47004966e+08  1.05e+05 2.12e+01  7.49e+04     2s
   1  -1.21209061e+07  1.32545327e+08  7.03e+04 7.69e+01  5.01e+04     2s
   2  -3.82373794e+06  1.01708007e+08  2.22e+04 2.44e-11  1.66e+04     2s
   3  -1.05169270e+06  9.78710670e+07  3.39e+03 7.00e+00  3.07e+03     2s
   4  -4.90604606e+05  7.21092122e+07  4.93e+02 3.84e+00  8.16e+02     2s
   5  -4.70330023e+05  3.59252230e+07  4.18e+02 6.69e-12  4.88e+02     2s
   6  -3.64530819e+05  2.46341842e+07  1.22e+02 8.11e-12  2.33e+02     2s
   7  -3.06382730e+05  1.75525188e+07  5.88e+01 6.25e-12  1.48e+02     2s
   8  -1.98130942e+05  1.22089000e+07  1.09e+01 5.77e-12  8.72e+01     2s
   9  -1.32597488e+05  6.97219928e+06  4.80e+00 5.01e-12  4.87e+01     2s
  10  -1.02929020e+05  2.96319221e+06  2.96e+00 3.23e-12  2.09e+01     2s
  11  -5.05531116e+04  1.06838399e+06  4.87e-01 2.40e-12  7.50e+00     2s
  12  -2.21058094e+04  4.91513730e+05  2.27e-01 1.31e-12  3.44e+00     3s
  13  -3.87220904e+03  2.74491676e+05  1.33e-01 7.93e-13  1.86e+00     3s
  14   3.96339405e+03  1.94710505e+05  1.07e-01 1.08e-12  1.28e+00     3s
  15   1.21369848e+04  1.55754017e+05  8.32e-02 5.83e-13  9.61e-01     3s
  16   2.00218385e+04  1.25918278e+05  6.26e-02 5.56e-13  7.08e-01     3s
  17   2.38871122e+04  1.05900678e+05  5.33e-02 7.03e-13  5.49e-01     3s
  18   2.85228550e+04  9.27929643e+04  4.31e-02 1.32e-04  4.30e-01     3s
  19   3.50292895e+04  8.32808493e+04  2.93e-02 3.74e-04  3.23e-01     3s
  20   3.76011089e+04  7.02912297e+04  2.43e-02 4.48e-04  2.19e-01     3s
  21   4.00431954e+04  6.55624211e+04  1.99e-02 1.06e-03  1.71e-01     3s
  22   4.32088282e+04  6.22733430e+04  1.44e-02 9.27e-04  1.28e-01     3s
  23   4.64258526e+04  5.96760004e+04  8.79e-03 6.48e-04  8.87e-02     3s
  24   4.74337130e+04  5.65738096e+04  7.16e-03 3.94e-04  6.12e-02     3s
  25   4.83747637e+04  5.49605977e+04  5.73e-03 2.38e-04  4.41e-02     3s
  26   4.94228799e+04  5.44606568e+04  4.14e-03 1.93e-04  3.37e-02     3s
  27   4.97475915e+04  5.38149162e+04  3.66e-03 1.36e-04  2.72e-02     3s
  28   5.00582987e+04  5.36898721e+04  3.20e-03 1.24e-04  2.43e-02     3s
  29   5.06590134e+04  5.31744463e+04  2.32e-03 7.75e-05  1.68e-02     3s
  30   5.09225263e+04  5.27335448e+04  1.94e-03 1.90e-04  1.21e-02     3s
  31   5.14686821e+04  5.25904406e+04  1.14e-03 1.20e-04  7.51e-03     3s
  32   5.18857558e+04  5.25657260e+04  5.67e-04 1.08e-04  4.55e-03     3s
  33   5.20544181e+04  5.24230487e+04  3.46e-04 4.02e-05  2.47e-03     3s
  34   5.21594705e+04  5.23933053e+04  2.14e-04 2.57e-05  1.57e-03     3s
  35   5.22164949e+04  5.23824992e+04  1.43e-04 2.07e-05  1.11e-03     3s
  36   5.22618890e+04  5.23506477e+04  8.54e-05 5.05e-06  5.94e-04     3s
  37   5.22857112e+04  5.23457274e+04  5.72e-05 3.02e-06  4.02e-04     3s
  38   5.23111700e+04  5.23409008e+04  2.79e-05 1.24e-06  1.99e-04     3s
  39   5.23360395e+04  5.23385163e+04  1.22e-06 3.07e-06  1.66e-05     3s
  40   5.23369907e+04  5.23376518e+04  4.66e-07 1.61e-07  4.43e-06     3s
  41   5.23374203e+04  5.23376159e+04  1.36e-07 6.23e-08  1.31e-06     4s
  42   5.23375657e+04  5.23375936e+04  2.90e-08 2.57e-08  1.87e-07     4s
  43   5.23375878e+04  5.23375914e+04  4.99e-08 5.57e-10  2.43e-08     4s
  44   5.23375906e+04  5.23375914e+04  6.63e-07 3.06e-08  5.36e-09     4s
  45   5.23375914e+04  5.23375914e+04  8.40e-08 3.13e-08  6.39e-11     4s

Barrier solved model in 45 iterations and 3.66 seconds (6.93 work units)
Optimal objective 5.23375914e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

     866 PPushes remaining with PInf 2.8874752e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2987829e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35038    5.2337591e+04   0.000000e+00   0.000000e+00      6s
   35038    5.2337591e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.20s

Solved with barrier

Root relaxation: objective 5.233759e+04, 35038 iterations, 4.88 seconds (11.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 52337.5914    0  239 -207405.59 52337.5914   125%     -    6s
H    0     0                    -55648.62174 52337.5914   194%     -    7s
H    0     0                    -55149.27897 52337.5914   195%     -    7s
H    0     0                    -4555.314122 52337.5914  1249%     -    7s
H    0     0                    -3747.424661 52337.5914  1497%     -    8s
H    0     0                    -3336.952080 52337.5914  1668%     -    8s
H    0     0                    -757.6724537 52337.5914  7008%     -    9s
H    0     0                    -446.5991125 52337.5914      -     -    9s
H    0     0                     -18.0248225 52337.5914      -     -    9s
H    0     0                      10.0658834 52337.5914      -     -    9s
H    0     0                     145.0287989 52337.5914      -     -    9s
H    0     0                     166.6564714 52337.5914      -     -    9s
H    0     0                    3483.7318587 52336.6687  1402%     -    9s
H    0     0                    3503.5825154 52336.6687  1394%     -    9s
     0     0 46763.6480    0  249 3503.58252 46763.6480  1235%     -   26s
H    0     0                    3586.5444868 46753.7634  1204%     -   27s
H    0     0                    4633.1603584 46753.7634   909%     -   27s
H    0     0                    4807.8849527 46753.7634   872%     -   27s
H    0     0                    4810.1153107 46753.7634   872%     -   27s
H    0     0                    4819.2141119 46753.7634   870%     -   27s
     0     0 46273.8175    0  298 4819.21411 46273.8175   860%     -   41s
     0     0 46231.5558    0  301 4819.21411 46231.5558   859%     -   45s
     0     0 46227.0319    0  303 4819.21411 46227.0319   859%     -   46s
     0     0 46227.0319    0  301 4819.21411 46227.0319   859%     -   46s
H    0     0                    5370.4733256 43014.2842   701%     -   76s
H    0     0                    5582.8834709 43014.2842   670%     -   76s
     0     0 43014.2842    0  300 5582.88347 43014.2842   670%     -   76s
H    0     0                    10547.134914 43013.9526   308%     -   77s
H    0     0                    10870.851756 43013.9526   296%     -   77s
H    0     0                    10995.208808 43013.9526   291%     -   77s
H    0     0                    11059.640582 43013.9526   289%     -   77s
H    0     0                    11173.656369 43013.9526   285%     -   77s
H    0     0                    11254.088296 43013.9526   282%     -   77s
H    0     0                    11296.639326 43013.9526   281%     -   77s
     0     0 42509.3866    0  321 11296.6393 42509.3866   276%     -   91s
     0     0 42314.9688    0  334 11296.6393 42314.9688   275%     -  102s
     0     0 42152.1732    0  342 11296.6393 42152.1732   273%     -  108s
H    0     0                    13888.827884 42018.9363   203%     -  115s
H    0     0                    14129.308168 42018.9363   197%     -  115s
H    0     0                    14568.372748 42018.9363   188%     -  115s
H    0     0                    15251.950317 42018.9363   175%     -  115s
     0     0 42018.9363    0  336 15251.9503 42018.9363   175%     -  115s
     0     0 41998.1929    0  345 15251.9503 41998.1929   175%     -  118s
     0     0 41983.6335    0  361 15251.9503 41983.6335   175%     -  121s
     0     0 41819.0682    0  347 15251.9503 41819.0682   174%     -  128s
     0     0 41775.5312    0  347 15251.9503 41775.5312   174%     -  135s
     0     0 41753.8319    0  356 15251.9503 41753.8319   174%     -  139s
     0     0 41747.9441    0  362 15251.9503 41747.9441   174%     -  141s
     0     0 41745.4904    0  364 15251.9503 41745.4904   174%     -  142s
     0     0 41744.6584    0  361 15251.9503 41744.6584   174%     -  143s
     0     0 40320.8273    0  373 15251.9503 40320.8273   164%     -  174s
H    0     0                    15347.199239 40320.0782   163%     -  175s
H    0     0                    15519.178745 40320.0782   160%     -  175s
     0     0 39982.5591    0  392 15519.1787 39982.5591   158%     -  186s
     0     0 39845.8336    0  394 15519.1787 39845.8336   157%     -  194s
H    0     0                    22011.995324 39737.6322  80.5%     -  205s
H    0     0                    22138.733279 39737.6322  79.5%     -  205s
H    0     0                    22213.890365 39737.6322  78.9%     -  205s
H    0     0                    22230.280638 39737.6322  78.8%     -  205s
H    0     0                    22388.225785 39737.6322  77.5%     -  205s
H    0     0                    22557.077838 39737.6322  76.2%     -  205s
H    0     0                    22802.224930 39737.6322  74.3%     -  205s
H    0     0                    22820.063586 39737.6322  74.1%     -  205s
     0     0 39737.6322    0  369 22820.0636 39737.6322  74.1%     -  205s
     0     0 39673.1965    0  400 22820.0636 39673.1965  73.9%     -  212s
     0     0 39648.9135    0  400 22820.0636 39648.9135  73.7%     -  215s
     0     0 39641.6842    0  400 22820.0636 39641.6842  73.7%     -  218s
     0     0 39631.6407    0  400 22820.0636 39631.6407  73.7%     -  220s
     0     0 39621.0014    0  401 22820.0636 39621.0014  73.6%     -  221s
     0     0 39568.8862    0  396 22820.0636 39568.8862  73.4%     -  225s
     0     0 39563.4799    0  406 22820.0636 39563.4799  73.4%     -  227s
     0     0 39561.2993    0  396 22820.0636 39561.2993  73.4%     -  228s
     0     0 39559.7772    0  394 22820.0636 39559.7772  73.4%     -  229s
     0     0 39077.6090    0  417 22820.0636 39077.6090  71.2%     -  248s
     0     0 38870.2058    0  466 22820.0636 38870.2058  70.3%     -  258s
     0     0 38822.2664    0  455 22820.0636 38822.2664  70.1%     -  263s
     0     0 38735.1611    0  411 22820.0636 38735.1611  69.7%     -  269s
     0     0 38693.1651    0  413 22820.0636 38693.1651  69.6%     -  273s
     0     0 38677.4975    0  411 22820.0636 38677.4975  69.5%     -  275s
     0     0 38672.1777    0  419 22820.0636 38672.1777  69.5%     -  276s
     0     0 38666.6995    0  422 22820.0636 38666.6995  69.4%     -  278s
     0     0 38665.1627    0  422 22820.0636 38665.1627  69.4%     -  279s
     0     0 38504.7706    0  407 22820.0636 38504.7706  68.7%     -  286s
H    0     0                    22929.820553 38504.7381  67.9%     -  287s
     0     0 38467.2342    0  419 22929.8206 38467.2342  67.8%     -  292s
     0     0 38442.6734    0  438 22929.8206 38442.6734  67.7%     -  296s
     0     0 38429.3386    0  476 22929.8206 38429.3386  67.6%     -  298s
     0     0 38415.8604    0  481 22929.8206 38415.8604  67.5%     -  299s
     0     0 38410.2411    0  421 22929.8206 38410.2411  67.5%     -  300s
     0     0 38405.4943    0  421 22929.8206 38405.4943  67.5%     -  301s
     0     0 38400.2643    0  460 22929.8206 38400.2643  67.5%     -  303s
     0     0 38398.4033    0  466 22929.8206 38398.4033  67.5%     -  304s
     0     0 38321.0743    0  460 22929.8206 38321.0743  67.1%     -  310s
     0     0 38294.6391    0  470 22929.8206 38294.6391  67.0%     -  315s
     0     0 38272.8830    0  455 22929.8206 38272.8830  66.9%     -  318s
     0     0 38266.2303    0  451 22929.8206 38266.2303  66.9%     -  320s
     0     0 38264.3422    0  471 22929.8206 38264.3422  66.9%     -  321s
     0     0 38228.6178    0  468 22929.8206 38228.6178  66.7%     -  325s
     0     0 38215.5278    0  419 22929.8206 38215.5278  66.7%     -  328s
     0     0 38206.3691    0  424 22929.8206 38206.3691  66.6%     -  330s
     0     0 38204.4936    0  421 22929.8206 38204.4936  66.6%     -  331s
     0     0 38147.6083    0  420 22929.8206 38147.6083  66.4%     -  336s
     0     0 38124.1683    0  427 22929.8206 38124.1683  66.3%     -  341s
     0     0 38108.7625    0  483 22929.8206 38108.7625  66.2%     -  344s
     0     0 38103.7979    0  485 22929.8206 38103.7979  66.2%     -  347s
     0     0 38100.1352    0  480 22929.8206 38100.1352  66.2%     -  348s
     0     0 38099.4109    0  482 22929.8206 38099.4109  66.2%     -  349s
H    0     0                    23258.616952 38085.5178  63.7%     -  353s
H    0     0                    23320.248729 38085.5178  63.3%     -  353s
H    0     0                    23354.410863 38085.5178  63.1%     -  353s
H    0     0                    23372.213993 38085.5178  63.0%     -  353s
     0     0 38085.5178    0  478 23372.2140 38085.5178  63.0%     -  353s
H    0     0                    23464.905943 38085.3620  62.3%     -  353s
     0     0 38080.9178    0  492 23464.9059 38080.9178  62.3%     -  354s
     0     0 38078.2912    0  495 23464.9059 38078.2912  62.3%     -  356s
     0     0 38077.1508    0  443 23464.9059 38077.1508  62.3%     -  357s
     0     0 38073.3139    0  446 23464.9059 38073.3139  62.3%     -  359s
H    0     0                    23581.311079 38070.3171  61.4%     -  361s
H    0     0                    23626.044347 38070.3171  61.1%     -  361s
H    0     0                    23701.835070 38070.3171  60.6%     -  361s
H    0     0                    23737.106002 38070.3171  60.4%     -  361s
     0     0 38067.2902    0  449 23737.1060 38067.2902  60.4%     -  363s
     0     0 38061.6384    0  448 23737.1060 38061.6384  60.3%     -  365s
     0     0 38059.5983    0  448 23737.1060 38059.5983  60.3%     -  366s
     0     0 38059.0321    0  448 23737.1060 38059.0321  60.3%     -  366s
     0     0 38032.3877    0  450 23737.1060 38032.3877  60.2%     -  370s
     0     0 38027.5800    0  446 23737.1060 38027.5800  60.2%     -  371s
     0     0 38024.8652    0  438 23737.1060 38024.8652  60.2%     -  372s
     0     0 38021.8263    0  445 23737.1060 38021.8263  60.2%     -  373s
     0     0 38021.6889    0  443 23737.1060 38021.6889  60.2%     -  374s
     0     0 37970.3428    0  452 23737.1060 37970.3428  60.0%     -  379s
H    0     0                    23748.927418 37970.2826  59.9%     -  386s
H    0     0                    23767.812387 37970.2826  59.8%     -  386s
H    0     0                    23775.344787 37970.2826  59.7%     -  386s
     0     0 37964.6464    0  488 23775.3448 37964.6464  59.7%     -  388s
     0     0 37962.0551    0  494 23775.3448 37962.0551  59.7%     -  389s
     0     0 37961.1128    0  494 23775.3448 37961.1128  59.7%     -  389s
     0     0 37936.0359    0  491 23775.3448 37936.0359  59.6%     -  393s
     0     0 37924.3317    0  491 23775.3448 37924.3317  59.5%     -  396s
     0     0 37920.6097    0  494 23775.3448 37920.6097  59.5%     -  398s
     0     0 37917.7995    0  494 23775.3448 37917.7995  59.5%     -  399s
     0     0 37916.6374    0  493 23775.3448 37916.6374  59.5%     -  399s
     0     0 37910.0021    0  461 23775.3448 37910.0021  59.5%     -  402s
H    0     0                    23779.302389 37909.9102  59.4%     -  405s
     0     0 37907.5475    0  449 23779.3024 37907.5475  59.4%     -  407s
     0     0 37906.7995    0  457 23779.3024 37906.7995  59.4%     -  407s
     0     0 37901.4678    0  495 23779.3024 37901.4678  59.4%     -  409s
     0     0 37900.4512    0  497 23779.3024 37900.4512  59.4%     -  410s
     0     0 37900.4512    0  495 23779.3024 37900.4512  59.4%     -  412s
     0     0 37900.1146    0  452 23779.3024 37900.1146  59.4%     -  413s
     0     0 37896.2316    0  457 23779.3024 37896.2316  59.4%     -  414s
     0     0 37895.6722    0  457 23779.3024 37895.6722  59.4%     -  415s
H    0     0                    23878.458525 37895.3646  58.7%     -  499s
     0     2 37895.3646    0  457 23878.4585 37895.3646  58.7%     -  502s
     1     3 36443.8150    1  425 23878.4585 37895.3646  58.7%  9362  509s
     2     6 36389.6247    2  420 23878.4585 37895.3646  58.7%  6753  512s
     5    10 37688.4863    2  442 23878.4585 37808.1404  58.3%  5197  523s
     9    19 37329.8230    3  469 23878.4585 37688.4409  57.8%  8190  538s
    18    38 37025.1962    4  471 23878.4585 37669.0059  57.8%  9033  554s
    37    51 36066.8934    5  480 23878.4585 37396.5113  56.6% 13042  585s
H   50    76                    23948.452906 37396.5113  56.2% 12650  609s
H   57    76                    23953.168259 37396.5113  56.1% 12578  609s
H   62    76                    24046.855056 37396.5113  55.5% 12480  609s
H   64    76                    24101.771353 37396.5113  55.2% 12259  609s
H   68    76                    24117.268956 37396.5113  55.1% 11679  609s
H   72    76                    24119.036462 37396.5113  55.0% 11235  609s
    75   210 34489.7539    7  341 24119.0365 37396.5113  55.0% 10989  632s
   209   243 31388.1425   12  252 24119.0365 37396.5113  55.0%  6258  644s
H  212   243                    24251.488628 37396.5113  54.2%  6304  644s
   242   287 31216.6632   13  296 24251.4886 37396.5113  54.2%  6793  657s
   286   330 28369.4728   15  228 24251.4886 37396.5113  54.2%  6656  669s
   329   378 28265.0093   16  227 24251.4886 37396.5113  54.2%  6343  683s
   379   406 26663.3886   21  215 24251.4886 37396.5113  54.2%  6092  704s
   407   454 26624.9061   22  217 24251.4886 37396.5113  54.2%  5997  717s
   465   512 26222.6128   27  205 24251.4886 37396.5113  54.2%  5711  730s
   543   573 25758.9010   32  185 24251.4886 37396.5113  54.2%  5327  743s
   616   596     cutoff   33      24251.4886 37396.5113  54.2%  5040  755s
   649   625 25395.4350   33  171 24251.4886 37396.5113  54.2%  4970  765s
   690   642 24799.2814   34  156 24251.4886 37396.5113  54.2%  4841  777s
   725   656     cutoff   35      24251.4886 37396.5113  54.2%  4753  789s
   761   670     cutoff   34      24251.4886 37396.5113  54.2%  4646  802s
   800   687 27268.9134   23  251 24251.4886 37396.5113  54.2%  4574  814s
   834   708 27033.6716   24  320 24251.4886 37396.5113  54.2%  4522  827s
   867   731 29813.9254   14  363 24251.4886 37396.5113  54.2%  4512  841s
   902   758 29504.3680   15  250 24251.4886 37396.5113  54.2%  4480  852s
   941   783 29389.5166   16  238 24251.4886 37396.5113  54.2%  4430  864s
   974   814 29191.5084   17  238 24251.4886 37396.5113  54.2%  4394  877s
  1021   860 29138.2080   18  244 24251.4886 37396.5113  54.2%  4291  890s
  1091   880 28802.1516   20  262 24251.4886 37396.5113  54.2%  4161  904s
  1167   922 28426.6090   22  292 24251.4886 37396.5113  54.2%  4039  918s
  1235   976 28085.1579   25  165 24251.4886 37396.5113  54.2%  3978  933s
  1315  1011 26447.4747   29  132 24251.4886 37396.5113  54.2%  3926  952s
  1395  1040 infeasible   38      24251.4886 37396.5113  54.2%  3901  971s
  1485  1061 25144.1041   41  149 24251.4886 37396.5113  54.2%  3849  990s
H 1514  1061                    25084.863141 37396.5113  49.1%  3850  990s
  1554  1074     cutoff   41      25084.8631 36998.4614  47.5%  3859 1010s
  1650  1134 35912.2151    6  356 25084.8631 36998.3473  47.5%  3839 1030s
  1732  1198 26091.0125   14  335 25084.8631 36998.3473  47.5%  3892 1052s
  1836  1273 36984.4188    6  483 25084.8631 36984.4188  47.4%  3886 1072s
  1965  1361 33827.1813    7  325 25084.8631 36983.9503  47.4%  3861 1093s
  2095  1415 32923.6961    8  321 25084.8631 36983.9503  47.4%  3839 1116s
  2211  1513 32337.6911   10  363 25084.8631 36983.9503  47.4%  3844 1139s
  2367  1589 29558.1335   13  362 25084.8631 36983.9503  47.4%  3817 1162s
  2539  1651 29102.4943   16  364 25084.8631 36983.9503  47.4%  3778 1189s
  2677  1743 28551.3676   19  391 25084.8631 36983.9503  47.4%  3796 1214s
  2798  1852 27465.6610   24  344 25084.8631 36983.9503  47.4%  3850 1243s
  2978  1916     cutoff   28      25084.8631 36983.9503  47.4%  3816 1270s
  3142  2022     cutoff   31      25084.8631 35262.4678  40.6%  3813 1302s
  3310  2137 31663.5073   11  344 25084.8631 35134.0929  40.1%  3828 1330s
  3502  2221 29865.0792   14  323 25084.8631 35134.0929  40.1%  3828 1362s
  3695  2314 28324.3404   17  245 25084.8631 35134.0929  40.1%  3827 1396s
H 3860  2255                    25537.356157 34910.7941  36.7%  3855 1426s
  3905  2361 27405.4948   21  237 25537.3562 34910.7941  36.7%  3885 1461s
H 4071  2356                    25560.174609 34910.7941  36.6%  3931 1476s
H 4071  2356                    25565.439367 34910.7941  36.6%  3931 1476s
H 4071  2338                    25614.641032 34910.7941  36.3%  3931 1494s
  4072  2339 28516.9831   10  457 25614.6410 34910.7941  36.3%  3930 1556s
  4074  2340 32212.1978   16  227 25614.6410 34910.7941  36.3%  3928 1566s
  4075  2341 25770.9267   31  343 25614.6410 34910.7941  36.3%  3927 1613s
  4076  2342 30041.7780   21  427 25614.6410 34910.7941  36.3%  3926 1645s
  4077  2342 28059.6559   28  403 25614.6410 34910.7941  36.3%  3925 1670s
  4078  2343 26491.3907   19  368 25614.6410 34910.7941  36.3%  3924 1695s
  4079  2344 31164.9150   19  463 25614.6410 34910.7941  36.3%  3923 1707s
  4080  2344 26359.7817   30  419 25614.6410 34910.7941  36.3%  3922 1720s
  4081  2345 27560.1708   27  493 25614.6410 34910.7941  36.3%  3922 1728s
  4082  2346 29409.5224   16  455 25614.6410 34910.7941  36.3%  3921 1734s
  4083  2346 30426.7460   11  434 25614.6410 34910.7941  36.3%  3920 1738s
  4084  2347 26403.7307   40  500 25614.6410 34910.7941  36.3%  3919 1745s
  4085  2348 28451.4130   20  496 25614.6410 34910.7941  36.3%  3918 1750s
  4087  2349 28552.3520   21  499 25614.6410 34910.7941  36.3%  3916 1756s
  4088  2350 29314.3402   21  435 25614.6410 34910.7941  36.3%  3915 1766s
  4089  2350 28331.6878   27  434 25614.6410 34910.7941  36.3%  3914 1770s
  4091  2352 27581.4227   10  494 25614.6410 34910.7941  36.3%  3912 1777s
  4092  2352 27394.3158   22  496 25614.6410 34910.7941  36.3%  3911 1781s
  4093  2353 27261.9109   20  502 25614.6410 34910.7941  36.3%  3910 1790s
  4095  2354 26225.7462   14  495 25614.6410 34910.7941  36.3%  3908 1798s
  4096  2355 25941.8865   18  488 25614.6410 34910.7941  36.3%  3907 1810s
  4097  2356 26400.5879   28  489 25614.6410 34910.7941  36.3%  3906 1815s
  4098  2356 30879.6184   16  498 25614.6410 34910.7941  36.3%  3905 1822s
  4099  2357 26669.7350   11  517 25614.6410 34910.7941  36.3%  3904 1833s
  4100  2358 30182.1606   22  501 25614.6410 34910.7941  36.3%  3903 1835s
  4102  2359 32712.4407    8  535 25614.6410 34910.7941  36.3%  3901 1851s
  4103  2360 27405.8344   30  529 25614.6410 34910.7941  36.3%  3901 1855s
  4105  2361 32250.7750   11  507 25614.6410 34910.7941  36.3%  3899 1867s
  4106  2362 32388.7361    6  511 25614.6410 34910.7941  36.3%  3898 1872s
  4107  2362 27033.2000   29  537 25614.6410 34910.7941  36.3%  3897 1876s
  4108  2363 33563.0928   10  496 25614.6410 34910.7941  36.3%  3896 1887s
  4109  2364 31375.2047   14  504 25614.6410 34910.7941  36.3%  3895 1892s
  4110  2364 28097.4997   20  445 25614.6410 34910.7941  36.3%  3894 1904s
  4111  2365 29212.7123   26  431 25614.6410 34910.7941  36.3%  3893 1908s
  4112  2366 26252.3156   28  427 25614.6410 34910.7941  36.3%  3892 1912s
  4113  2366 32581.2138    7  430 25614.6410 34910.7941  36.3%  3891 1916s
  4114  2367 26812.8159   35  469 25614.6410 34910.7941  36.3%  3890 1926s
  4115  2368 28549.1369   16  508 25614.6410 34910.7941  36.3%  3889 1930s
  4117  2369 30849.3354   10  506 25614.6410 34910.7941  36.3%  3887 1937s
  4118  2370 32811.9958   17  518 25614.6410 34910.7941  36.3%  3886 1945s
  4119  2370 26822.9721   26  523 25614.6410 34910.7941  36.3%  3885 1950s
  4121  2372 28359.4655   19  521 25614.6410 34910.7941  36.3%  3883 1969s
  4122  2372 25744.2055   38  520 25614.6410 34910.7941  36.3%  3883 1974s
  4123  2373 28570.8666   36  469 25614.6410 34910.7941  36.3%  3882 1984s
  4124  2374 26065.1484   47  478 25614.6410 34910.7941  36.3%  3881 1989s
  4125  2374 29753.1229   13  529 25614.6410 34910.7941  36.3%  3880 1995s
  4126  2375 33695.2978    8  472 25614.6410 34910.7941  36.3%  3879 2001s
  4127  2376 30019.6908   19  472 25614.6410 34910.7941  36.3%  3878 2014s
  4128  2376 27513.3334   32  472 25614.6410 34910.7941  36.3%  3877 2124s
  4129  2380 34910.7941   11  470 25614.6410 34910.7941  36.3%  3971 2138s
  4131  2382 34910.7941   12  390 25614.6410 34910.7941  36.3%  3973 2164s
  4134  2387 34876.1895   13  406 25614.6410 34910.7941  36.3%  3979 2183s
  4140  2398 34910.7941   13  483 25614.6410 34910.7941  36.3%  3994 2207s
  4153  2407 34357.8667   14  502 25614.6410 34910.7941  36.3%  4037 2271s
  4166  2433 33428.4343   15  460 25614.6410 34910.7941  36.3%  4063 2364s
  4198  2465 33238.7649   16  455 25614.6410 34910.7941  36.3%  4196 2407s
  4241  2496 32934.3341   17  447 25614.6410 34910.7941  36.3%  4270 2434s
  4291  2521 32772.3449   18  497 25614.6410 34910.7941  36.3%  4331 2459s
  4345  2545 31616.3782   19  426 25614.6410 34910.7941  36.3%  4370 2491s
  4407  2553 31485.0736   20  478 25614.6410 34910.7941  36.3%  4433 2525s
  4482  2563 30995.2162   21  459 25614.6410 34910.7941  36.3%  4540 2547s
  4547  2568 30747.5560   22  343 25614.6410 34910.7941  36.3%  4607 2568s
  4620  2559 28974.7793   23  291 25614.6410 34910.7941  36.3%  4652 2588s
  4701  2539 28851.6502   24  244 25614.6410 34910.7941  36.3%  4676 2613s
  4753  2545 28430.6543   25  322 25614.6410 34910.7941  36.3%  4705 2632s
  4795  2546 27425.6141   26  306 25614.6410 34910.7941  36.3%  4769 2656s
  4852  2542 27016.9222   27  274 25614.6410 34910.7941  36.3%  4808 2674s
  4892  2553 25952.6120   28  359 25614.6410 34910.7941  36.3%  4852 2690s
  4940  2553 25906.2945   29  318 25614.6410 34910.7941  36.3%  4876 2708s
  5010  2546 26431.5456   23  345 25614.6410 34910.7941  36.3%  4895 2725s
  5062  2545 25820.6799   24  314 25614.6410 34772.1893  35.8%  4922 2754s
  5137  2525 32026.0862   18  459 25614.6410 34224.6890  33.6%  4958 2778s
  5206  2518 30803.2770   19  373 25614.6410 33956.3304  32.6%  5026 2800s
  5277  2492 31041.6480   18  283 25614.6410 33956.3304  32.6%  5065 2822s
  5324  2501 29255.1636   20  340 25614.6410 33956.3304  32.6%  5135 2844s
  5372  2512 28945.8007   21  321 25614.6410 33956.3304  32.6%  5183 2868s
  5445  2501     cutoff   22      25614.6410 33956.3304  32.6%  5233 2901s
  5534  2483 26681.5173   22  371 25614.6410 33529.7608  30.9%  5283 2933s
  5632  2451     cutoff   24      25614.6410 33529.7608  30.9%  5344 2960s
  5725  2446 29595.9717   20  370 25614.6410 32571.4780  27.2%  5409 2987s
  5813  2433 26851.0150   21  359 25614.6410 32571.4780  27.2%  5465 3016s
  5900  2437 25824.3612   23  297 25614.6410 32571.4780  27.2%  5539 3044s
  6017  2408 27127.2523   25  216 25614.6410 32170.0135  25.6%  5584 3082s
  6159  2390     cutoff   26      25614.6410 32170.0135  25.6%  5613 3114s
  6276  2369     cutoff   29      25614.6410 31618.4576  23.4%  5691 3149s
  6421  2332 26936.2180   22  325 25614.6410 31513.3402  23.0%  5739 3177s
  6472  2350 26745.0991   23  273 25614.6410 31513.3402  23.0%  5774 3205s
  6546  2343     cutoff   25      25614.6410 31513.3402  23.0%  5808 3239s
  6709  2310 25757.0724   25  437 25614.6410 31513.3402  23.0%  5829 3276s
  6891  2285     cutoff   26      25614.6410 31513.3402  23.0%  5840 3316s
  7083  2251 26135.1362   21  185 25614.6410 30620.3361  19.5%  5859 3355s
  7292  2207 28697.9691   18  410 25614.6410 30609.2050  19.5%  5888 3396s
  7499  2125 25960.2878   21  280 25614.6410 30282.2905  18.2%  5921 3436s
  7702  2072     cutoff   18      25614.6410 30282.2905  18.2%  5980 3481s
  7933  1988     cutoff   20      25614.6410 29873.6654  16.6%  6007 3526s
  8176  1904 26493.0589   21  360 25614.6410 29739.7273  16.1%  6037 3574s
  8457  1792     cutoff   22      25614.6410 29475.0060  15.1%  6063 3600s

Cutting planes:
  Gomory: 3
  Projected implied bound: 68
  MIR: 902
  Mixing: 3
  Flow cover: 1937
  Zero half: 1
  RLT: 15
  Relax-and-lift: 217

Explored 8640 nodes (52686028 simplex iterations) in 3600.04 seconds (10351.45 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25614.6 25565.4 25537.4 ... 23953.2

Time limit reached
Best objective 2.561464103162e+04, best bound 2.941886088102e+04, gap 14.8517%
  WARNING: Time limit reached. Using best solution found (gap: 14.85%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 25614.64, θ = 173241.52
  Upper Bound (UB) = 25614.64

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 173241.52
  [DEBUG]   ✓ Scenario 0: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 173241.52 ≤ Q = 173241.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 173241.52 ≤ Q = 173241.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 173241.52 ≤ Q = 173241.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 173241.52 ≤ Q = 173241.52 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 173241.52 ≤ Q = 173241.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x48a54c1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfb75ab3f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.342764e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6225814.1768
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.565986e+05, 234 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156598.61    0  122 6225814.18 -156598.61   103%     -    0s
H    0     0                    -122572.7141 -156598.61  27.8%     -    0s
H    0     0                    -123276.9224 -156598.61  27.0%     -    0s
H    0     0                    -125525.3447 -156598.61  24.8%     -    0s
     0     0 -139104.60    0   94 -125525.34 -139104.60  10.8%     -    0s
H    0     0                    -135978.9391 -139025.15  2.24%     -    0s
     0     0 -138092.03    0   89 -135978.94 -138092.03  1.55%     -    0s
     0     0 -138010.04    0   96 -135978.94 -138010.04  1.49%     -    0s
H    0     0                    -136944.8304 -138010.04  0.78%     -    0s
H    0     0                    -136971.4596 -138010.04  0.76%     -    0s
H    0     0                    -136976.1160 -137677.16  0.51%     -    0s
     0     0 -137677.16    0   68 -136976.12 -137677.16  0.51%     -    0s
H    0     0                    -136977.1333 -137473.94  0.36%     -    0s
     0     0 -137473.94    0   47 -136977.13 -137473.94  0.36%     -    0s
     0     0 -137468.51    0   34 -136977.13 -137468.51  0.36%     -    0s
     0     0 -137426.21    0   44 -136977.13 -137426.21  0.33%     -    0s
H    0     0                    -136993.7099 -137403.64  0.30%     -    0s
     0     0 -137403.64    0   45 -136993.71 -137403.64  0.30%     -    0s
     0     0 -137351.09    0   45 -136993.71 -137351.09  0.26%     -    0s
     0     0 -137338.09    0   45 -136993.71 -137338.09  0.25%     -    0s
     0     0 -137338.09    0   60 -136993.71 -137338.09  0.25%     -    0s
     0     0 -137338.09    0   38 -136993.71 -137338.09  0.25%     -    0s
     0     0 -137279.67    0   41 -136993.71 -137279.67  0.21%     -    0s
     0     0 -137243.40    0   34 -136993.71 -137243.40  0.18%     -    0s
     0     0 -137128.45    0   27 -136993.71 -137128.45  0.10%     -    0s
     0     0 -137124.89    0   27 -136993.71 -137124.89  0.10%     -    0s
     0     0 -137107.34    0   35 -136993.71 -137107.34  0.08%     -    0s
     0     0 -137098.52    0   34 -136993.71 -137098.52  0.08%     -    0s
     0     0 -137095.25    0   25 -136993.71 -137095.25  0.07%     -    0s
     0     0 -137084.99    0   35 -136993.71 -137084.99  0.07%     -    0s
     0     0 -137082.87    0   25 -136993.71 -137082.87  0.07%     -    0s
     0     0 -137065.42    0   35 -136993.71 -137065.42  0.05%     -    0s
     0     0 -137065.42    0   29 -136993.71 -137065.42  0.05%     -    0s
     0     0 -137065.42    0   27 -136993.71 -137065.42  0.05%     -    0s
H    0     0                    -136997.0416 -137065.42  0.05%     -    0s
     0     0 -137065.42    0   25 -136997.04 -137065.42  0.05%     -    0s
     0     0 -137065.42    0   26 -136997.04 -137065.42  0.05%     -    0s
     0     0 -137063.32    0   25 -136997.04 -137063.32  0.05%     -    0s
     0     0 -137058.60    0   25 -136997.04 -137058.60  0.04%     -    0s
     0     0 -137046.93    0   23 -136997.04 -137046.93  0.04%     -    0s
     0     0 -137046.04    0   23 -136997.04 -137046.04  0.04%     -    0s
     0     2 -137046.04    0   23 -136997.04 -137046.04  0.04%     -    0s

Cutting planes:
  Gomory: 14
  MIR: 38
  Flow cover: 13

Explored 18 nodes (1321 simplex iterations) in 0.13 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -136997 -136994 -136977 ... 6.22581e+06
No other solutions better than -136997

Optimal solution found (tolerance 1.00e-06)
Best objective -1.369970415546e+05, best bound -1.369970415546e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 161425.37
  Scenario: 45 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136997.04
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -136997.04 = 161425.37
  [DEBUG]   Current θ from Master = 173241.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11816.15 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13798.49
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 1836.1636, Absolute Gap = 1836.1636, Relative Gap = 0.071684
  Not converged yet (gap = 1836.16 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 45 increases, 14 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480994 nonzeros
Model fingerprint: 0xb89750f6
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80112 rows and 32532 columns
Presolve time: 1.35s
Presolved: 89461 rows, 38368 columns, 545369 nonzeros
Variable types: 36109 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -325498.4012
Found heuristic solution: objective -207405.5945

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.311e+06
 Factor NZ  : 7.434e+06 (roughly 110 MB of memory)
 Factor Ops : 1.292e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67920639e+07  1.60286126e+08  1.05e+05 1.97e+01  7.46e+04     2s
   1  -1.22945162e+07  1.44908088e+08  7.11e+04 7.42e+01  5.00e+04     2s
   2  -3.86770591e+06  1.11719640e+08  2.25e+04 5.40e-01  1.68e+04     2s
   3  -9.28636668e+05  7.86255199e+07  2.83e+03 1.37e+00  2.45e+03     3s
   4  -4.78967591e+05  3.78183992e+07  5.12e+02 4.20e-01  5.55e+02     3s
   5  -3.38876292e+05  2.23283898e+07  1.27e+02 1.96e-01  2.10e+02     3s
   6  -2.62701961e+05  1.59124107e+07  4.47e+01 1.31e-01  1.21e+02     3s
   7  -1.37048878e+05  1.13832573e+07  9.62e+00 8.95e-02  7.41e+01     3s
   8  -8.78487715e+04  6.94247211e+06  3.85e+00 5.46e-02  4.39e+01     3s
   9  -7.54467675e+04  3.86855249e+06  2.31e+00 3.00e-02  2.44e+01     3s
  10  -4.72024519e+04  2.14507152e+06  8.98e-01 1.63e-02  1.34e+01     3s
  11  -1.91316811e+04  4.14589767e+05  2.75e-01 2.46e-03  2.65e+00     3s
  12  -2.27132220e+02  2.29524641e+05  1.74e-01 1.49e-03  1.40e+00     3s
  13   5.98950966e+03  1.76492206e+05  1.38e-01 1.30e-03  1.04e+00     3s
  14   1.27029063e+04  1.49144613e+05  1.10e-01 1.20e-03  8.32e-01     3s
  15   1.73626656e+04  1.29153625e+05  9.25e-02 1.29e-03  6.82e-01     3s
  16   2.38850567e+04  1.06851125e+05  7.35e-02 1.42e-03  5.06e-01     3s
  17   3.02792635e+04  8.89070575e+04  5.46e-02 2.12e-03  3.57e-01     3s
  18   3.51951671e+04  8.15186585e+04  4.20e-02 2.16e-03  2.82e-01     3s
  19   3.88026376e+04  7.56282172e+04  3.32e-02 1.90e-03  2.24e-01     3s
  20   4.19454024e+04  6.88999266e+04  2.55e-02 1.29e-03  1.64e-01     3s
  21   4.37817536e+04  6.71021846e+04  2.15e-02 1.14e-03  1.42e-01     3s
  22   4.71825682e+04  6.28195347e+04  1.42e-02 7.48e-04  9.53e-02     3s
  23   4.85636751e+04  6.12143703e+04  1.15e-02 5.96e-04  7.71e-02     3s
  24   4.96834813e+04  6.01050567e+04  9.19e-03 4.95e-04  6.35e-02     3s
  25   5.05008321e+04  5.85393259e+04  7.54e-03 3.52e-04  4.90e-02     3s
  26   5.15243223e+04  5.72928691e+04  5.54e-03 2.38e-04  3.52e-02     3s
  27   5.22604544e+04  5.68456266e+04  4.12e-03 1.99e-04  2.79e-02     3s
  28   5.26707923e+04  5.63170410e+04  3.34e-03 1.53e-04  2.22e-02     3s
  29   5.33010382e+04  5.58948505e+04  2.25e-03 1.14e-04  1.58e-02     3s
  30   5.36005462e+04  5.55442775e+04  1.72e-03 8.13e-05  1.18e-02     3s
  31   5.38575820e+04  5.53406785e+04  1.28e-03 6.20e-05  9.04e-03     3s
  32   5.41103316e+04  5.51033534e+04  8.60e-04 4.05e-05  6.05e-03     3s
  33   5.43050121e+04  5.49420078e+04  5.50e-04 5.56e-05  3.88e-03     4s
  34   5.44398152e+04  5.47986788e+04  3.34e-04 2.55e-05  2.19e-03     4s
  35   5.45288887e+04  5.47670770e+04  2.00e-04 1.87e-05  1.45e-03     4s
  36   5.45728971e+04  5.47413759e+04  1.35e-04 1.37e-05  1.03e-03     4s
  37   5.45856659e+04  5.47173918e+04  1.17e-04 8.96e-06  8.03e-04     4s
  38   5.46026178e+04  5.47119768e+04  9.34e-05 7.92e-06  6.66e-04     4s
  39   5.46093082e+04  5.47072750e+04  8.42e-05 6.93e-06  5.97e-04     4s
  40   5.46221674e+04  5.46951956e+04  6.65e-05 4.64e-06  4.45e-04     4s
  41   5.46307314e+04  5.46926040e+04  5.48e-05 4.07e-06  3.77e-04     4s
  42   5.46320180e+04  5.46899863e+04  5.30e-05 3.62e-06  3.53e-04     4s
  43   5.46432938e+04  5.46860770e+04  3.73e-05 2.93e-06  2.61e-04     4s
  44   5.46448547e+04  5.46860057e+04  3.51e-05 2.91e-06  2.51e-04     4s
  45   5.46497141e+04  5.46824877e+04  2.81e-05 2.25e-06  2.00e-04     4s
  46   5.46499994e+04  5.46796040e+04  2.77e-05 1.75e-06  1.80e-04     4s
  47   5.46605071e+04  5.46770227e+04  1.26e-05 1.24e-06  1.01e-04     4s
  48   5.46640684e+04  5.46737555e+04  7.75e-06 5.95e-07  5.90e-05     4s
  49   5.46650553e+04  5.46722754e+04  6.37e-06 4.31e-07  4.40e-05     4s
  50   5.46652701e+04  5.46719557e+04  6.10e-06 3.97e-07  4.07e-05     4s
  51   5.46676210e+04  5.46711551e+04  3.07e-06 2.25e-07  2.15e-05     4s
  52   5.46688601e+04  5.46704407e+04  1.51e-06 7.47e-08  9.63e-06     4s
  53   5.46695045e+04  5.46702468e+04  7.36e-07 3.94e-08  4.52e-06     4s
  54   5.46696479e+04  5.46701650e+04  5.67e-07 9.76e-09  3.15e-06     4s
  55   5.46700013e+04  5.46701482e+04  1.61e-07 1.63e-09  8.95e-07     4s
  56   5.46701392e+04  5.46701468e+04  1.09e-07 7.56e-10  4.63e-08     4s
  57   5.46701400e+04  5.46701459e+04  3.79e-07 3.97e-08  3.59e-08     5s
  58   5.46701440e+04  5.46701441e+04  3.51e-08 1.36e-08  1.72e-10     5s

Barrier solved model in 58 iterations and 4.54 seconds (9.10 work units)
Optimal objective 5.46701440e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1710 PPushes remaining with PInf 1.0613073e-05                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.6651501e-01      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33190    5.4670144e+04   0.000000e+00   2.665150e-01      6s
   33192    5.4670144e+04   0.000000e+00   0.000000e+00      6s
   33192    5.4670144e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.37s

Solved with barrier

Root relaxation: objective 5.467014e+04, 33192 iterations, 4.95 seconds (11.11 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 54670.1441    0  286 -207405.59 54670.1441   126%     -    7s
H    0     0                    -135769.6719 54670.1441   140%     -    7s
H    0     0                    -110378.4482 54670.1441   150%     -    7s
H    0     0                    -86058.80479 54670.1441   164%     -    7s
H    0     0                    -64524.75554 54670.1441   185%     -    7s
H    0     0                    -10580.04636 54670.1441   617%     -    7s
H    0     0                    -10120.16297 54670.1441   640%     -    8s
H    0     0                    -6072.434317 54670.1441  1000%     -    8s
H    0     0                    -5978.468770 54670.1441  1014%     -    8s
H    0     0                    -4811.667378 54670.1441  1236%     -    8s
H    0     0                    -4589.549078 54670.1441  1291%     -    8s
H    0     0                    -4472.474869 54670.1441  1322%     -    8s
H    0     0                    -4425.353528 54670.1441  1335%     -    8s
H    0     0                    -4377.279592 54670.1441  1349%     -    8s
H    0     0                    -4300.360096 54670.1441  1371%     -    8s
H    0     0                    -4281.839484 54670.1441  1377%     -    8s
H    0     0                    -4234.165160 54670.1441  1391%     -    8s
H    0     0                    -4204.650492 54670.1441  1400%     -    8s
H    0     0                    -3301.985641 54670.1441  1756%     -   10s
H    0     0                    -2424.207087 54670.1441  2355%     -   10s
H    0     0                    -2281.335036 54670.1441  2496%     -   10s
H    0     0                    -1881.438173 54670.1441  3006%     -   10s
H    0     0                    -1576.403460 54670.1441  3568%     -   10s
H    0     0                    -1529.675295 54670.1441  3674%     -   10s
H    0     0                    -1503.737186 54670.1441  3736%     -   10s
H    0     0                    -1475.068829 54670.1441  3806%     -   10s
     0     0 47354.4440    0  328 -1475.0688 47354.4440  3310%     -   39s
H    0     0                    -1401.661383 47354.4029  3478%     -   39s
H    0     0                    -1209.092739 47354.4029  4017%     -   39s
     0     0 47125.3801    0  346 -1209.0927 47125.3801  3998%     -   51s
     0     0 47083.5574    0  340 -1209.0927 47083.5574  3994%     -   57s
     0     0 47083.5574    0  341 -1209.0927 47083.5574  3994%     -   59s
     0     0 46980.5644    0  351 -1209.0927 46980.5644  3986%     -   62s
     0     0 46978.0214    0  356 -1209.0927 46978.0214  3985%     -   66s
     0     0 46978.0214    0  356 -1209.0927 46978.0214  3985%     -   67s
H    0     0                    -1082.171514 43390.6312  4110%     -  114s
H    0     0                    -1005.953896 43390.6312  4413%     -  114s
H    0     0                    -807.5997961 43390.6312  5473%     -  114s
H    0     0                    -790.1231340 43390.6312  5592%     -  114s
H    0     0                    -745.7681350 43390.6312  5918%     -  114s
H    0     0                    -713.4315951 43390.6312  6182%     -  114s
     0     0 43390.6312    0  375 -713.43160 43390.6312  6182%     -  114s
H    0     0                    4855.0055883 43389.9993   794%     -  115s
H    0     0                    5005.2512793 43389.9993   767%     -  115s
H    0     0                    5312.3721331 43389.9993   717%     -  115s
H    0     0                    5561.7178787 43389.9993   680%     -  115s
H    0     0                    5642.8339252 43389.9993   669%     -  115s
     0     0 43016.6595    0  332 5642.83393 43016.6595   662%     -  137s
     0     0 42842.8148    0  370 5642.83393 42842.8148   659%     -  155s
     0     0 42783.3650    0  341 5642.83393 42783.3650   658%     -  160s
     0     0 42728.0379    0  366 5642.83393 42728.0379   657%     -  166s
     0     0 42693.6904    0  337 5642.83393 42693.6904   657%     -  171s
     0     0 42613.2756    0  368 5642.83393 42613.2756   655%     -  179s
     0     0 42464.1070    0  382 5642.83393 42464.1070   653%     -  190s
     0     0 42423.8294    0  384 5642.83393 42423.8294   652%     -  196s
     0     0 42375.4411    0  375 5642.83393 42375.4411   651%     -  203s
     0     0 42368.6821    0  380 5642.83393 42368.6821   651%     -  206s
     0     0 42367.7710    0  384 5642.83393 42367.7710   651%     -  207s
H    0     0                    5691.4340179 40759.2174   616%     -  264s
H    0     0                    5819.1649961 40759.2174   600%     -  264s
H    0     0                    5826.2648999 40759.2174   600%     -  264s
H    0     0                    5828.5873085 40759.2174   599%     -  264s
H    0     0                    5842.0098553 40759.2174   598%     -  264s
H    0     0                    5842.5805174 40759.2174   598%     -  264s
H    0     0                    5862.0824725 40759.2174   595%     -  264s
     0     0 40759.2174    0  408 5862.08247 40759.2174   595%     -  264s
     0     0 40332.3228    0  457 5862.08247 40332.3228   588%     -  282s
     0     0 40210.3224    0  467 5862.08247 40210.3224   586%     -  300s
H    0     0                    5866.2883977 40146.8802   584%     -  308s
H    0     0                    5941.2596504 40146.8802   576%     -  308s
H    0     0                    5942.7772919 40146.8802   576%     -  308s
H    0     0                    5965.4333116 40146.8802   573%     -  308s
     0     0 40146.8802    0  480 5965.43331 40146.8802   573%     -  308s
H    0     0                    6036.4815047 40047.4096   563%     -  321s
H    0     0                    6149.7443115 40047.4096   551%     -  321s
H    0     0                    6208.4055055 40047.4096   545%     -  321s
H    0     0                    6248.5963280 40047.4096   541%     -  321s
H    0     0                    6279.7758262 40047.4096   538%     -  321s
H    0     0                    6328.8778249 40047.4096   533%     -  321s
     0     0 40047.4096    0  485 6328.87782 40047.4096   533%     -  321s
     0     0 40018.4373    0  477 6328.87782 40018.4373   532%     -  327s
     0     0 40010.0994    0  482 6328.87782 40010.0994   532%     -  332s
     0     0 40002.7126    0  477 6328.87782 40002.7126   532%     -  336s
     0     0 39998.5007    0  494 6328.87782 39998.5007   532%     -  338s
     0     0 39997.0680    0  499 6328.87782 39997.0680   532%     -  341s
H    0     0                    6393.0018214 39225.0475   514%     -  386s
H    0     0                    6573.6659580 39225.0475   497%     -  386s
H    0     0                    6596.6132195 39225.0475   495%     -  386s
H    0     0                    6630.3802906 39225.0475   492%     -  386s
     0     0 39225.0475    0  388 6630.38029 39225.0475   492%     -  386s
H    0     0                    6658.7616759 39224.7489   489%     -  387s
H    0     0                    6696.6642977 39224.7489   486%     -  387s
     0     0 39000.7267    0  411 6696.66430 39000.7267   482%     -  398s
     0     0 38926.5557    0  406 6696.66430 38926.5557   481%     -  407s
     0     0 38901.6950    0  416 6696.66430 38901.6950   481%     -  412s
     0     0 38879.3848    0  403 6696.66430 38879.3848   481%     -  415s
     0     0 38869.1324    0  400 6696.66430 38869.1324   480%     -  417s
     0     0 38865.7092    0  414 6696.66430 38865.7092   480%     -  418s
     0     0 38864.4190    0  416 6696.66430 38864.4190   480%     -  419s
     0     0 38645.9330    0  442 6696.66430 38645.9330   477%     -  434s
     0     0 38554.2310    0  504 6696.66430 38554.2310   476%     -  443s
     0     0 38534.5164    0  431 6696.66430 38534.5164   475%     -  447s
     0     0 38499.0737    0  444 6696.66430 38499.0737   475%     -  454s
     0     0 38484.9163    0  444 6696.66430 38484.9163   475%     -  457s
     0     0 38481.3986    0  432 6696.66430 38481.3986   475%     -  459s
     0     0 38480.3182    0  444 6696.66430 38480.3182   475%     -  460s
     0     0 38362.0844    0  500 6696.66430 38362.0844   473%     -  471s
     0     0 38328.6813    0  494 6696.66430 38328.6813   472%     -  480s
     0     0 38317.5368    0  446 6696.66430 38317.5368   472%     -  482s
     0     0 38314.2572    0  490 6696.66430 38314.2572   472%     -  484s
     0     0 38311.1236    0  445 6696.66430 38311.1236   472%     -  485s
     0     0 38300.7245    0  481 6696.66430 38300.7245   472%     -  488s
     0     0 38290.8252    0  507 6696.66430 38290.8252   472%     -  490s
     0     0 38287.4244    0  509 6696.66430 38287.4244   472%     -  491s
     0     0 38286.2825    0  503 6696.66430 38286.2825   472%     -  492s
     0     0 38169.1817    0  493 6696.66430 38169.1817   470%     -  499s
     0     0 38133.0087    0  463 6696.66430 38133.0087   469%     -  506s
     0     0 38125.5848    0  474 6696.66430 38125.5848   469%     -  508s
     0     0 38121.0943    0  462 6696.66430 38121.0943   469%     -  509s
     0     0 38114.3085    0  466 6696.66430 38114.3085   469%     -  511s
     0     0 38111.7472    0  462 6696.66430 38111.7472   469%     -  513s
     0     0 38110.5314    0  480 6696.66430 38110.5314   469%     -  514s
     0     0 38053.7951    0  441 6696.66430 38053.7951   468%     -  519s
H    0     0                    8440.7258509 38053.2119   351%     -  520s
H    0     0                    8841.5233452 38053.2119   330%     -  520s
H    0     0                    8850.5134227 38053.2119   330%     -  520s
H    0     0                    9059.4713197 38053.2119   320%     -  521s
H    0     0                    9078.3680871 38053.2119   319%     -  521s
H    0     0                    9107.4465333 38053.2119   318%     -  521s
     0     0 38012.6082    0  440 9107.44653 38012.6082   317%     -  526s
     0     0 38000.9368    0  456 9107.44653 38000.9368   317%     -  528s
     0     0 37988.9750    0  453 9107.44653 37988.9750   317%     -  531s
     0     0 37985.1154    0  456 9107.44653 37985.1154   317%     -  532s
     0     0 37982.8021    0  454 9107.44653 37982.8021   317%     -  534s
     0     0 37930.2355    0  506 9107.44653 37930.2355   316%     -  540s
H    0     0                    9291.3624049 37930.1448   308%     -  541s
     0     0 37917.6643    0  535 9291.36240 37917.6643   308%     -  544s
     0     0 37910.7882    0  526 9291.36240 37910.7882   308%     -  546s
     0     0 37907.9574    0  532 9291.36240 37907.9574   308%     -  548s
     0     0 37906.8781    0  529 9291.36240 37906.8781   308%     -  549s
     0     0 37870.5778    0  466 9291.36240 37870.5778   308%     -  554s
H    0     0                    9346.6578005 37870.5210   305%     -  557s
H    0     0                    9348.1916533 37870.5210   305%     -  557s
H    0     0                    9426.1698706 37863.2914   302%     -  559s
H    0     0                    9448.3140009 37863.2914   301%     -  559s
     0     0 37863.2914    0  454 9448.31400 37863.2914   301%     -  559s
     0     0 37861.8988    0  458 9448.31400 37861.8988   301%     -  560s
     0     0 37850.0980    0  503 9448.31400 37850.0980   301%     -  564s
     0     0 37842.9159    0  460 9448.31400 37842.9159   301%     -  567s
     0     0 37841.3536    0  461 9448.31400 37841.3536   301%     -  568s
     0     0 37828.2848    0  503 9448.31400 37828.2848   300%     -  573s
     0     0 37827.7347    0  503 9448.31400 37827.7347   300%     -  575s
H    0     0                    9493.8715348 37827.6749   298%     -  626s
H    0     0                    10386.676386 37827.6749   264%     -  676s
H    0     0                    16648.304401 37827.6749   127%     -  676s
H    0     0                    18029.940282 37827.6749   110%     -  676s
H    0     0                    18380.720945 37827.6749   106%     -  678s
H    0     0                    19040.972227 37827.6749  98.7%     -  678s
H    0     0                    20849.309958 37827.6749  81.4%     -  680s
H    0     0                    21045.502092 37827.6749  79.7%     -  680s
H    0     0                    21249.173580 37827.6749  78.0%     -  680s
H    0     0                    21364.962683 37827.6749  77.1%     -  680s
H    0     0                    21468.477857 37827.6749  76.2%     -  681s
     0     2 37827.6749    0  503 21468.4779 37827.6749  76.2%     -  691s
     1     4 37731.2098    1  485 21468.4779 37827.6749  76.2% 11352  700s
     3     7 37703.0725    2  484 21468.4779 37750.7658  75.8%  7717  727s
     6    14 37636.0905    3  496 21468.4779 37750.5404  75.8% 10981  761s
    13    28 37421.1932    4  504 21468.4779 37635.5196  75.3% 13956  787s
    27    42 35865.6340    5  423 21468.4779 37418.1303  74.3% 21991  839s
    41    74 34228.0733    6  407 21468.4779 37418.1303  74.3% 20321  920s
H   45    74                    21488.435891 37418.1303  74.1% 19806  920s
H   46    74                    21641.959219 37418.1303  72.9% 19709  920s
H   68    74                    21859.146070 37418.1303  71.2% 16459  920s
    73   181 33770.7404    7  350 21859.1461 36977.4542  69.2% 19015  971s
   180   280 33571.1547   10  389 21859.1461 36977.4542  69.2% 11968  998s
   279   345 32976.3471   13  394 21859.1461 36977.4542  69.2%  9215 1022s
   344   396 32261.0261   15  379 21859.1461 36977.4542  69.2%  8504 1041s
   395   452 31596.2962   17  376 21859.1461 36977.4542  69.2%  8302 1070s
   453   483 31117.8866   20  373 21859.1461 36977.4542  69.2%  7878 1086s
   484   522 30971.0930   21  389 21859.1461 36977.4542  69.2%  7761 1102s
H  508   522                    21935.057000 36977.4542  68.6%  7588 1102s
   523   586 30237.0365   22  366 21935.0570 36977.4542  68.6%  7556 1122s
   595   658 30033.2970   23  384 21935.0570 36977.4542  68.6%  7174 1139s
   676   709 29799.5785   25  287 21935.0570 36977.4542  68.6%  6741 1156s
   735   757 26432.6444   28  295 21935.0570 36977.4542  68.6%  6604 1172s
   789   815 26236.8195   29  296 21935.0570 36977.4542  68.6%  6453 1188s
   857   828 25458.7268   33  263 21935.0570 36977.4542  68.6%  6224 1204s
   896   859 25188.8905   34  290 21935.0570 36977.4542  68.6%  6189 1224s
   941   883 25177.5091   35  256 21935.0570 36977.4542  68.6%  6095 1241s
   985   906 25101.9539   36  250 21935.0570 36977.4542  68.6%  6048 1259s
H 1013   906                    23083.885069 36977.4542  60.2%  6056 1259s
  1026   910 24762.5040   37  234 23083.8851 36977.4542  60.2%  6066 1282s
  1089   919     cutoff   39      23083.8851 36977.4542  60.2%  6032 1306s
  1140   946 infeasible   38      23083.8851 36826.0164  59.5%  6027 1332s
  1183   999 34407.8653    7  395 23083.8851 36826.0164  59.5%  6084 1356s
  1250  1057 34097.4738    8  408 23083.8851 36826.0164  59.5%  6073 1379s
  1334  1096 31763.4148    9  370 23083.8851 36826.0164  59.5%  5973 1404s
  1431  1142 31277.2835   10  347 23083.8851 36826.0164  59.5%  5936 1431s
  1511  1202 30055.6602   12  293 23083.8851 36826.0164  59.5%  5941 1458s
  1605  1240 27845.6550   14  305 23083.8851 36826.0164  59.5%  5904 1481s
H 1609  1240                    23625.171605 36826.0164  55.9%  5905 1481s
  1665  1350 27413.8388   15  317 23625.1716 36826.0164  55.9%  5872 1510s
  1810  1458 25209.0385   20  330 23625.1716 36656.8820  55.2%  5688 1540s
  1957  1587 24414.0391   24  271 23625.1716 36656.8820  55.2%  5584 1568s
  2154  1621 infeasible   26      23625.1716 36124.2776  52.9%  5368 1601s
  2304  1634 33468.8439    7  391 23625.1716 36099.2688  52.8%  5303 1631s
H 2310  1634                    23626.018942 36099.2688  52.8%  5312 1631s
  2349  1652 32736.1260    8  396 23626.0189 36099.2688  52.8%  5394 1660s
H 2350  1652                    23764.952994 36099.2688  51.9%  5392 1660s
H 2353  1652                    23893.208564 36099.2688  51.1%  5392 1660s
  2387  1709 28879.5148    9  363 23893.2086 36099.2688  51.1%  5459 1693s
  2492  1717 infeasible   10      23893.2086 36099.2688  51.1%  5474 1730s
H 2500  1717                    23897.373912 36099.2688  51.1%  5482 1730s
  2557  1762 30761.2955   10  363 23897.3739 36099.2688  51.1%  5489 1771s
  2640  1783 28987.8083   13  341 23897.3739 36099.2688  51.1%  5556 1809s
  2732  1843 28249.4829   16  262 23897.3739 36099.2688  51.1%  5622 1847s
  2873  1912 27138.8793   22  211 23897.3739 36099.2688  51.1%  5603 1886s
  3034  1977 26016.5632   31  204 23897.3739 35611.9208  49.0%  5572 1942s
H 3078  1943                    24063.401797 35611.9208  48.0%  5538 1942s
H 3148  1918                    24169.274232 35611.9208  47.3%  5545 1942s
  3151  1976 24908.5476   47  131 24169.2742 35611.9208  47.3%  5549 1990s
  3293  2061 29222.9691   13  291 24169.2742 35611.9208  47.3%  5568 2034s
  3422  2077 26186.8965   16  265 24169.2742 35611.9208  47.3%  5617 2077s
H 3458  2077                    24169.705969 35611.9208  47.3%  5652 2077s
  3470  2183     cutoff   17      24169.7060 35611.9208  47.3%  5656 2128s
  3652  2281 infeasible   18      24169.7060 35611.9208  47.3%  5653 2180s
  3831  2376 24783.8094   25  138 24169.7060 35088.7045  45.2%  5645 2237s
  4016  2479 27417.0929    7  398 24169.7060 35088.7045  45.2%  5660 2296s
  4180  2480 26042.7784   35  503 24169.7060 35088.7045  45.2%  5704 2407s
  4182  2481 26226.5604   18  244 24169.7060 35088.7045  45.2%  5701 2418s
  4183  2482 27524.0714   20  427 24169.7060 35088.7045  45.2%  5699 2480s
  4184  2483 28315.6451   18  427 24169.7060 35088.7045  45.2%  5698 2534s
  4185  2483 25008.9616   42  467 24169.7060 35088.7045  45.2%  5697 2580s
  4186  2484 26339.2712   22  464 24169.7060 35088.7045  45.2%  5695 2609s
  4187  2485 28197.5740   21  469 24169.7060 35088.7045  45.2%  5694 2625s
  4188  2485 24568.5630   15  462 24169.7060 35088.7045  45.2%  5693 2637s
  4189  2486 31456.6216   17  486 24169.7060 35088.7045  45.2%  5691 2648s
  4190  2487 26061.1066   10  500 24169.7060 35088.7045  45.2%  5690 2659s
  4191  2487 33751.5107    5  488 24169.7060 35088.7045  45.2%  5689 2667s
  4192  2488 28109.6920   18  496 24169.7060 35088.7045  45.2%  5687 2674s
  4193  2489 24470.8708   34  497 24169.7060 35088.7045  45.2%  5686 2685s
  4194  2489 27484.4865   27  515 24169.7060 35088.7045  45.2%  5685 2692s
  4195  2490 34676.5589   13  516 24169.7060 35088.7045  45.2%  5683 2699s
  4196  2491 29686.8908   23  530 24169.7060 35088.7045  45.2%  5682 2722s
  4197  2491 24652.5983   52  518 24169.7060 35088.7045  45.2%  5680 2735s
  4198  2492 30646.0279   18  527 24169.7060 35088.7045  45.2%  5679 2742s
  4199  2493 26299.1354   16  520 24169.7060 35088.7045  45.2%  5678 2748s
  4200  2493 31762.2366   13  530 24169.7060 35088.7045  45.2%  5676 2753s
  4201  2494 29053.9883   21  509 24169.7060 35088.7045  45.2%  5675 2765s
  4202  2495 26759.4632   17  511 24169.7060 35088.7045  45.2%  5674 2773s
  4203  2495 30941.3082   12  516 24169.7060 35088.7045  45.2%  5672 2777s
  4204  2496 32500.5615   14  509 24169.7060 35088.7045  45.2%  5671 2783s
  4205  2497 25997.9980   31  525 24169.7060 35088.7045  45.2%  5670 2795s
  4206  2497 25117.1223   46  542 24169.7060 35088.7045  45.2%  5668 2801s
  4207  2498 28919.4051   24  519 24169.7060 35088.7045  45.2%  5667 2806s
  4208  2499 27415.1926   17  523 24169.7060 35088.7045  45.2%  5666 2811s
  4209  2499 27911.0848   28  477 24169.7060 35088.7045  45.2%  5664 2820s
  4210  2500 30352.1965   23  494 24169.7060 35088.7045  45.2%  5663 2825s
  4211  2501 27077.9066   35  486 24169.7060 35088.7045  45.2%  5662 2831s
  4212  2501 34783.1116   13  559 24169.7060 35088.7045  45.2%  5660 2843s
  4213  2502 31956.4467   16  529 24169.7060 35088.7045  45.2%  5659 2849s
  4214  2503 34434.3839   16  542 24169.7060 35088.7045  45.2%  5658 2853s
  4215  2503 25479.4209   39  534 24169.7060 35088.7045  45.2%  5656 2857s
  4216  2504 27111.5459   15  524 24169.7060 35088.7045  45.2%  5655 2868s
  4217  2505 24470.8708   34  526 24169.7060 35088.7045  45.2%  5654 2872s
  4218  2505 31223.8295   10  541 24169.7060 35088.7045  45.2%  5652 2877s
  4219  2506 33525.2424   14  489 24169.7060 35088.7045  45.2%  5651 2886s
  4220  2507 26163.9125   14  489 24169.7060 35088.7045  45.2%  5649 2890s
  4222  2508 26723.5279   20  539 24169.7060 35088.7045  45.2%  5647 2903s
  4223  2509 28307.8328   28  539 24169.7060 35088.7045  45.2%  5645 2922s
  4224  2509 33084.0395   10  539 24169.7060 35088.7045  45.2%  5644 3070s
  4225  2512 35088.7045   10  512 24169.7060 35088.7045  45.2%  5751 3103s
  4226  2513 35088.7045   10  469 24169.7060 35088.7045  45.2%  5751 3119s
  4227  2516 35088.7045   11  479 24169.7060 35088.7045  45.2%  5752 3160s
  4231  2523 35088.7045   12  487 24169.7060 35088.7045  45.2%  5758 3212s
  4239  2536 34201.3394   13  435 24169.7060 35088.7045  45.2%  5780 3246s
  4255  2546 33704.3482   14  511 24169.7060 35088.7045  45.2%  5867 3600s

Cutting planes:
  Learned: 1
  Gomory: 14
  Implied bound: 15
  Projected implied bound: 238
  MIR: 984
  Flow cover: 1474
  RLT: 36
  Relax-and-lift: 296

Explored 4270 nodes (25841584 simplex iterations) in 3600.04 seconds (8864.40 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 24169.7 24169.3 24063.4 ... 21859.1

Time limit reached
Best objective 2.416970596851e+04, best bound 3.508870446068e+04, gap 45.1764%
  WARNING: Time limit reached. Using best solution found (gap: 45.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 24169.71, θ = 171751.71
  Upper Bound (UB) = 24169.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171751.71
  [DEBUG]   ✓ Scenario 0: θ = 171751.71 ≤ Q = 171751.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171751.71 ≤ Q = 171751.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 171751.71 ≤ Q = 171751.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x733a3b03
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8cc5c4fd
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.310346e+13
Presolve removed 2612 rows and 1903 columns
Presolve time: 0.00s
Presolved: 481 rows, 486 columns, 1321 nonzeros
Found heuristic solution: objective 6061599.4745
Variable types: 330 continuous, 156 integer (156 binary)

Root relaxation: objective -1.511400e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -151140.04    0  120 6061599.47 -151140.04   102%     -    0s
H    0     0                    -117783.5307 -151140.04  28.3%     -    0s
H    0     0                    -118226.8783 -151140.04  27.8%     -    0s
H    0     0                    -119801.6375 -151140.04  26.2%     -    0s
H    0     0                    -122057.6917 -132515.23  8.57%     -    0s
H    0     0                    -122432.0888 -132515.23  8.24%     -    0s
     0     0 -132515.23    0  127 -122432.09 -132515.23  8.24%     -    0s
H    0     0                    -127209.6761 -132442.49  4.11%     -    0s
     0     0 -130940.50    0  130 -127209.68 -130940.50  2.93%     -    0s
H    0     0                    -128206.5605 -130911.72  2.11%     -    0s
H    0     0                    -128657.9378 -130911.72  1.75%     -    0s
H    0     0                    -128834.1394 -130911.72  1.61%     -    0s
     0     0 -130499.66    0   95 -128834.14 -130499.66  1.29%     -    0s
     0     0 -130367.78    0  117 -128834.14 -130367.78  1.19%     -    0s
     0     0 -130356.63    0   89 -128834.14 -130356.63  1.18%     -    0s
     0     0 -130100.47    0   91 -128834.14 -130100.47  0.98%     -    0s
H    0     0                    -128845.6581 -130097.36  0.97%     -    0s
     0     0 -129965.43    0   82 -128845.66 -129965.43  0.87%     -    0s
     0     0 -129955.19    0   82 -128845.66 -129955.19  0.86%     -    0s
H    0     0                    -128847.1017 -129955.19  0.86%     -    0s
     0     2 -129955.19    0   82 -128847.10 -129955.19  0.86%     -    0s
H  119   112                    -128904.7671 -129578.49  0.52%   6.8    0s
H  408   246                    -128935.5897 -129563.33  0.49%   4.9    0s
H  448   246                    -128948.1156 -129563.33  0.48%   5.4    0s
H 1536   566                    -128948.3099 -129310.33  0.28%   5.0    0s

Cutting planes:
  Gomory: 59
  Implied bound: 3
  MIR: 185
  Flow cover: 7
  RLT: 42
  Relax-and-lift: 5
  BQP: 2

Explored 13211 nodes (51389 simplex iterations) in 0.28 seconds (0.38 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128948 -128948 -128936 ... -122432
No other solutions better than -128948

Optimal solution found (tolerance 1.00e-06)
Best objective -1.289483098541e+05, best bound -1.289483098541e+05, gap 0.0000%
  Subproblem solved in 0.30s
  Worst-case operational profit (Z_SP) = 162520.18
  Scenario: 59 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128948.31
  [DEBUG]   S×d_nominal = 291468.49
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 291468.49 + -128948.31 = 162520.18
  [DEBUG]   Current θ from Master = 171751.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9231.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14938.18
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 391.2285, Absolute Gap = 391.2285, Relative Gap = 0.016187
  Not converged yet (gap = 391.23 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 59 increases, 0 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524219 nonzeros
Model fingerprint: 0x8bd866a8
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 87384 rows and 35484 columns
Presolve time: 1.46s
Presolved: 97479 rows, 41656 columns, 592487 nonzeros
Variable types: 39397 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -323817.4629
Found heuristic solution: objective -217654.3735

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.18s

Barrier statistics:
 Dense cols : 572
 AA' NZ     : 3.783e+06
 Factor NZ  : 8.573e+06 (roughly 130 MB of memory)
 Factor Ops : 1.559e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68389696e+07  1.73589790e+08  1.11e+05 2.06e+01  7.44e+04     3s
   1  -1.24213041e+07  1.57166920e+08  7.58e+04 8.28e+01  5.02e+04     3s
   2  -3.59261577e+06  1.21253551e+08  2.20e+04 6.33e-01  1.56e+04     3s
   3  -9.08521841e+05  8.51267747e+07  2.83e+03 1.27e+00  2.33e+03     3s
   4  -4.93448193e+05  3.68240208e+07  5.36e+02 3.24e-01  5.22e+02     3s
   5  -3.63575472e+05  2.41434154e+07  2.01e+02 1.77e-01  2.45e+02     3s
   6  -2.70550430e+05  1.71508756e+07  6.41e+01 1.16e-01  1.28e+02     3s
   7  -1.88126650e+05  1.29703875e+07  2.41e+01 8.36e-02  8.36e+01     3s
   8  -1.31303807e+05  9.41142556e+06  1.12e+01 5.86e-02  5.71e+01     3s
   9  -9.27832981e+04  5.90507035e+06  6.79e+00 3.53e-02  3.51e+01     3s
  10  -7.54160130e+04  2.45368870e+06  3.82e+00 1.41e-02  1.46e+01     3s
  11  -2.76034340e+04  6.21830835e+05  1.03e+00 3.08e-03  3.67e+00     3s
  12  -9.54078181e+03  2.91477476e+05  6.60e-01 1.67e-03  1.70e+00     3s
  13  -8.63024105e+02  1.79853089e+05  4.83e-01 1.29e-03  1.02e+00     3s
  14   5.03254155e+03  1.42244716e+05  3.94e-01 1.66e-03  7.72e-01     3s
  15   1.16000012e+04  1.25112389e+05  3.10e-01 1.38e-03  6.38e-01     3s
  16   1.96210890e+04  1.06690323e+05  2.36e-01 1.33e-03  4.89e-01     3s
  17   2.46274120e+04  8.95498396e+04  1.95e-01 1.69e-03  3.65e-01     3s
  18   2.73698024e+04  8.15036304e+04  1.75e-01 1.40e-03  3.04e-01     3s
  19   3.62673656e+04  7.72938269e+04  1.07e-01 1.56e-03  2.30e-01     3s
  20   3.72222048e+04  7.02238229e+04  1.00e-01 1.56e-03  1.85e-01     3s
  21   3.98547986e+04  6.79395764e+04  8.22e-02 1.29e-03  1.58e-01     3s
  22   4.15215349e+04  6.64454786e+04  7.10e-02 1.26e-03  1.40e-01     3s
  23   4.35303811e+04  6.40068087e+04  5.78e-02 1.31e-03  1.15e-01     3s
  24   4.54763704e+04  6.09730405e+04  4.54e-02 1.00e-03  8.70e-02     3s
  25   4.68887548e+04  5.89678121e+04  3.63e-02 1.27e-03  6.78e-02     3s
  26   4.90958307e+04  5.74237074e+04  2.28e-02 1.24e-03  4.67e-02     3s
  27   4.93025554e+04  5.61971288e+04  2.12e-02 8.39e-04  3.87e-02     3s
  28   5.01276882e+04  5.53629526e+04  1.66e-02 6.06e-04  2.94e-02     4s
  29   5.07375537e+04  5.46803285e+04  1.31e-02 3.85e-04  2.21e-02     4s
  30   5.10249693e+04  5.42478588e+04  1.15e-02 2.75e-04  1.81e-02     4s
  31   5.13596878e+04  5.41370577e+04  9.72e-03 2.44e-04  1.56e-02     4s
  32   5.17719654e+04  5.39274771e+04  7.62e-03 1.82e-04  1.21e-02     4s
  33   5.20689682e+04  5.37750813e+04  6.00e-03 1.67e-04  9.58e-03     4s
  34   5.22101295e+04  5.36690370e+04  5.28e-03 1.44e-04  8.19e-03     4s
  35   5.25302788e+04  5.35617925e+04  3.60e-03 1.06e-04  5.79e-03     4s
  36   5.25937384e+04  5.34850892e+04  3.27e-03 8.84e-05  5.01e-03     4s
  37   5.26433674e+04  5.34457016e+04  3.01e-03 7.35e-05  4.51e-03     4s
  38   5.29334260e+04  5.33928697e+04  1.52e-03 5.18e-05  2.58e-03     4s
  39   5.29932602e+04  5.33422373e+04  1.24e-03 3.77e-05  1.96e-03     4s
  40   5.31261739e+04  5.33226845e+04  5.72e-04 2.94e-05  1.10e-03     4s
  41   5.31619653e+04  5.32956980e+04  4.07e-04 1.73e-05  7.51e-04     4s
  42   5.31831083e+04  5.32813728e+04  3.11e-04 9.32e-06  5.52e-04     4s
  43   5.32012466e+04  5.32648071e+04  2.29e-04 3.93e-06  3.57e-04     4s
  44   5.32161493e+04  5.32592728e+04  1.64e-04 1.08e-05  2.42e-04     4s
  45   5.32306509e+04  5.32573375e+04  9.99e-05 4.28e-06  1.50e-04     4s
  46   5.32411690e+04  5.32560728e+04  5.41e-05 5.71e-06  8.37e-05     4s
  47   5.32472757e+04  5.32554548e+04  2.83e-05 3.60e-06  4.59e-05     4s
  48   5.32525681e+04  5.32545000e+04  6.95e-06 1.03e-06  1.09e-05     4s
  49   5.32543580e+04  5.32543719e+04  1.79e-08 4.38e-07  7.79e-08     4s
  50   5.32543662e+04  5.32543676e+04  1.76e-07 3.20e-09  7.48e-09     4s
  51   5.32543670e+04  5.32543675e+04  6.47e-07 2.22e-08  2.97e-09     5s

Barrier solved model in 51 iterations and 4.54 seconds (9.02 work units)
Optimal objective 5.32543670e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

   20057 PPushes remaining with PInf 8.2180706e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0983776e+04      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   59857    5.3254368e+04   0.000000e+00   1.098378e+04      8s
   60141    5.3254368e+04   0.000000e+00   0.000000e+00      8s
   60141    5.3254368e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 1.28s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.325437e+04, 60141 iterations, 7.77 seconds (16.06 work units)
Total elapsed time = 10.05s (DegenMoves)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53254.3675    0  313 -217654.37 53254.3675   124%     -   10s
H    0     0                    -128312.5863 53254.3675   142%     -   10s
H    0     0                    -110670.3285 53254.3675   148%     -   10s
H    0     0                    -81634.36172 53254.3675   165%     -   10s
H    0     0                    -6436.722543 53254.3675   927%     -   10s
H    0     0                    -6379.268578 53254.3675   935%     -   11s
H    0     0                    -4894.659380 53254.3675  1188%     -   11s
H    0     0                    -4584.534314 53254.3675  1262%     -   11s
H    0     0                    -2095.178422 53254.3675  2642%     -   11s
H    0     0                     740.6203398 46034.1645  6116%     -   41s
H    0     0                    1788.5345083 46034.1645  2474%     -   41s
     0     0 45922.6782    0  215 1788.53451 45922.6782  2468%     -   41s
H    0     0                    2153.1044302 45922.6782  2033%     -   42s
H    0     0                    2257.4653203 45922.6782  1934%     -   42s
H    0     0                    2443.1598503 45922.6782  1780%     -   42s
     0     0 45756.7668    0  291 2443.15985 45756.7668  1773%     -   47s
     0     0 45746.5086    0  300 2443.15985 45746.5086  1772%     -   53s
     0     0 45746.5086    0  300 2443.15985 45746.5086  1772%     -   55s
     0     0 45746.5086    0  299 2443.15985 45746.5086  1772%     -   56s
     0     0 45746.5086    0  296 2443.15985 45746.5086  1772%     -   58s
     0     0 45746.5086    0  294 2443.15985 45746.5086  1772%     -   59s
     0     0 45746.3768    0  298 2443.15985 45746.3768  1772%     -   59s
     0     0 42417.0405    0  354 2443.15985 42417.0405  1636%     -   97s
H    0     0                    5330.4422826 42415.7639   696%     -   97s
     0     0 42005.8680    0  394 5330.44228 42005.8680   688%     -  119s
     0     0 41786.2328    0  420 5330.44228 41786.2328   684%     -  130s
     0     0 41646.9751    0  417 5330.44228 41646.9751   681%     -  136s
     0     0 41561.8100    0  417 5330.44228 41561.8100   680%     -  141s
     0     0 41302.6846    0  434 5330.44228 41302.6846   675%     -  148s
     0     0 41257.3240    0  438 5330.44228 41257.3240   674%     -  152s
     0     0 41253.9104    0  442 5330.44228 41253.9104   674%     -  153s
     0     0 41231.4886    0  441 5330.44228 41231.4886   674%     -  156s
     0     0 41228.3152    0  441 5330.44228 41228.3152   673%     -  157s
     0     0 41213.6591    0  434 5330.44228 41213.6591   673%     -  159s
H    0     0                    5344.7333836 41210.5111   671%     -  161s
H    0     0                    5459.4663783 41210.5111   655%     -  161s
     0     0 41210.5111    0  435 5459.46638 41210.5111   655%     -  161s
     0     0 41210.4241    0  435 5459.46638 41210.4241   655%     -  161s
H    0     0                    8300.0693296 39133.3554   371%     -  196s
H    0     0                    8371.6859575 39133.3554   367%     -  196s
     0     0 39133.3554    0  395 8371.68596 39133.3554   367%     -  196s
H    0     0                    8876.8139632 39133.1616   341%     -  196s
H    0     0                    8956.9199996 39133.1616   337%     -  196s
     0     0 38633.0938    0  385 8956.92000 38633.0938   331%     -  212s
     0     0 38514.3668    0  410 8956.92000 38514.3668   330%     -  219s
     0     0 38415.4709    0  461 8956.92000 38415.4709   329%     -  226s
     0     0 38315.3009    0  439 8956.92000 38315.3009   328%     -  231s
H    0     0                    11269.650389 38246.4603   239%     -  236s
     0     0 38246.4603    0  431 11269.6504 38246.4603   239%     -  236s
H    0     0                    11406.364156 38221.7663   235%     -  241s
H    0     0                    11420.250237 38221.7663   235%     -  241s
H    0     0                    14893.647231 38221.7663   157%     -  241s
H    0     0                    15481.207831 38221.7663   147%     -  241s
     0     0 38221.7663    0  491 15481.2078 38221.7663   147%     -  241s
     0     0 38212.2581    0  492 15481.2078 38212.2581   147%     -  243s
     0     0 38205.9829    0  482 15481.2078 38205.9829   147%     -  246s
     0     0 38203.0383    0  488 15481.2078 38203.0383   147%     -  247s
     0     0 38200.3210    0  486 15481.2078 38200.3210   147%     -  249s
     0     0 38134.8238    0  428 15481.2078 38134.8238   146%     -  255s
     0     0 38115.8922    0  477 15481.2078 38115.8922   146%     -  258s
     0     0 38090.3564    0  489 15481.2078 38090.3564   146%     -  261s
     0     0 38082.0968    0  486 15481.2078 38082.0968   146%     -  263s
     0     0 38076.5853    0  480 15481.2078 38076.5853   146%     -  264s
     0     0 38068.1291    0  489 15481.2078 38068.1291   146%     -  266s
     0     0 38065.8400    0  486 15481.2078 38065.8400   146%     -  267s
     0     0 38063.9715    0  489 15481.2078 38063.9715   146%     -  268s
H    0     0                    15491.783832 37218.2369   140%     -  288s
     0     0 37218.2369    0  440 15491.7838 37218.2369   140%     -  288s
H    0     0                    16199.974087 36842.8342   127%     -  297s
H    0     0                    16285.481428 36842.8342   126%     -  297s
H    0     0                    16550.581662 36842.8342   123%     -  297s
H    0     0                    16597.095156 36842.8342   122%     -  297s
     0     0 36842.8342    0  432 16597.0952 36842.8342   122%     -  297s
     0     0 36726.8979    0  493 16597.0952 36726.8979   121%     -  303s
     0     0 36649.7307    0  471 16597.0952 36649.7307   121%     -  309s
     0     0 36626.2664    0  468 16597.0952 36626.2664   121%     -  313s
     0     0 36592.3700    0  455 16597.0952 36592.3700   120%     -  315s
     0     0 36579.9880    0  467 16597.0952 36579.9880   120%     -  317s
     0     0 36557.7797    0  455 16597.0952 36557.7797   120%     -  320s
     0     0 36543.4201    0  461 16597.0952 36543.4201   120%     -  322s
     0     0 36539.6594    0  461 16597.0952 36539.6594   120%     -  323s
     0     0 36527.0849    0  462 16597.0952 36527.0849   120%     -  325s
     0     0 36524.9726    0  464 16597.0952 36524.9726   120%     -  326s
     0     0 36433.2472    0  428 16597.0952 36433.2472   120%     -  334s
     0     0 36412.8147    0  440 16597.0952 36412.8147   119%     -  337s
     0     0 36392.1955    0  456 16597.0952 36392.1955   119%     -  339s
     0     0 36386.4338    0  458 16597.0952 36386.4338   119%     -  340s
     0     0 36384.2911    0  444 16597.0952 36384.2911   119%     -  341s
     0     0 36282.9801    0  467 16597.0952 36282.9801   119%     -  350s
H    0     0                    16830.885836 36277.9173   116%     -  354s
H    0     0                    17296.297636 36277.9173   110%     -  355s
     0     0 36233.5981    0  465 17296.2976 36233.5981   109%     -  360s
     0     0 36167.7229    0  470 17296.2976 36167.7229   109%     -  367s
     0     0 36149.1202    0  471 17296.2976 36149.1202   109%     -  369s
     0     0 36137.8572    0  478 17296.2976 36137.8572   109%     -  371s
     0     0 36133.2447    0  493 17296.2976 36133.2447   109%     -  372s
     0     0 36123.0189    0  482 17296.2976 36123.0189   109%     -  374s
     0     0 36118.9378    0  475 17296.2976 36118.9378   109%     -  377s
     0     0 36116.5563    0  484 17296.2976 36116.5563   109%     -  378s
     0     0 36084.8868    0  481 17296.2976 36084.8868   109%     -  383s
H    0     0                    17299.870566 36083.2520   109%     -  384s
     0     0 36075.0276    0  486 17299.8706 36075.0276   109%     -  386s
     0     0 36072.4675    0  473 17299.8706 36072.4675   109%     -  387s
     0     0 36032.1204    0  448 17299.8706 36032.1204   108%     -  393s
H    0     0                    17353.787569 36031.9142   108%     -  395s
     0     0 36026.8005    0  487 17353.7876 36026.8005   108%     -  398s
     0     0 36023.1840    0  430 17353.7876 36023.1840   108%     -  400s
     0     0 36019.2396    0  481 17353.7876 36019.2396   108%     -  401s
     0     0 36016.7155    0  431 17353.7876 36016.7155   108%     -  402s
     0     0 35992.6164    0  423 17353.7876 35992.6164   107%     -  406s
     0     0 35985.7897    0  481 17353.7876 35985.7897   107%     -  408s
     0     0 35982.7928    0  483 17353.7876 35982.7928   107%     -  410s
     0     0 35981.5296    0  433 17353.7876 35981.5296   107%     -  411s
     0     0 35968.8285    0  487 17353.7876 35968.8285   107%     -  413s
H    0     0                    17415.353989 35967.9261   107%     -  421s
H    0     0                    17536.615705 35967.9261   105%     -  421s
H    0     0                    18054.543070 35967.9261  99.2%     -  421s
H    0     0                    18638.180049 35967.9261  93.0%     -  421s
H    0     0                    18670.501924 35967.9261  92.6%     -  423s
     0     0 35964.8057    0  485 18670.5019 35964.8057  92.6%     -  425s
     0     0 35957.1871    0  495 18670.5019 35957.1871  92.6%     -  426s
     0     0 35954.9075    0  495 18670.5019 35954.9075  92.6%     -  427s
     0     0 35917.3241    0  488 18670.5019 35917.3241  92.4%     -  431s
H    0     0                    18682.121096 35915.6275  92.2%     -  435s
     0     0 35897.1984    0  435 18682.1211 35897.1984  92.1%     -  437s
     0     0 35892.3310    0  438 18682.1211 35892.3310  92.1%     -  438s
     0     0 35888.9377    0  492 18682.1211 35888.9377  92.1%     -  439s
     0     0 35886.3202    0  445 18682.1211 35886.3202  92.1%     -  440s
     0     0 35839.8566    0  476 18682.1211 35839.8566  91.8%     -  444s
     0     0 35835.6251    0  434 18682.1211 35835.6251  91.8%     -  446s
     0     0 35833.1120    0  433 18682.1211 35833.1120  91.8%     -  447s
     0     0 35816.1250    0  448 18682.1211 35816.1250  91.7%     -  450s
     0     0 35810.1694    0  450 18682.1211 35810.1694  91.7%     -  451s
     0     0 35807.5023    0  501 18682.1211 35807.5023  91.7%     -  452s
     0     0 35806.7658    0  502 18682.1211 35806.7658  91.7%     -  453s
     0     0 35795.5546    0  486 18682.1211 35795.5546  91.6%     -  456s
     0     0 35795.4068    0  486 18682.1211 35795.4068  91.6%     -  458s
H    0     0                    18712.659137 35795.3815  91.3%     -  543s
H    0     0                    18723.235139 35795.3815  91.2%     -  551s
H    0     0                    18767.390777 35795.3815  90.7%     -  551s
H    0     0                    18798.419156 35795.3815  90.4%     -  551s
H    0     0                    18813.486747 35795.3815  90.3%     -  555s
H    0     0                    18932.238044 35795.3815  89.1%     -  564s
     0     2 35795.3815    0  486 18932.2380 35795.3815  89.1%     -  566s
     1     3 35289.1590    1  464 18932.2380 35794.2813  89.1% 10197  573s
     2     5 34801.0276    2  463 18932.2380 35794.2813  89.1%  9823  581s
     4     9 34722.6437    3  477 18932.2380 35532.2719  87.7%  8085  591s
     8    17 34443.3134    4  437 18932.2380 35530.2422  87.7%  8544  607s
    16    34 34925.2169    4  476 18932.2380 35358.3398  86.8% 11186  619s
    33    48 33839.0586    5  430 18932.2380 35086.5283  85.3% 16776 3600s

Cutting planes:
  Learned: 3
  Gomory: 25
  Implied bound: 144
  MIR: 2082
  Flow cover: 2123
  Zero half: 1
  RLT: 111
  Relax-and-lift: 521

Explored 47 nodes (1495519 simplex iterations) in 3600.14 seconds (5954.27 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 18932.2 18813.5 18798.4 ... 18054.5

Time limit reached
Best objective 1.893223804441e+04, best bound 3.508652827181e+04, gap 85.3269%
  WARNING: Time limit reached. Using best solution found (gap: 85.33%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 18932.24, θ = 174986.90
  Upper Bound (UB) = 18932.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 174986.90
  [DEBUG]   ✓ Scenario 0: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 174986.90 ≤ Q = 174986.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 174986.90 ≤ Q = 174986.90 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 174986.90 ≤ Q = 174986.90 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6d04b47f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6d04b47f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.139969e+13
Presolve removed 2611 rows and 1901 columns
Presolve time: 0.00s
Presolved: 482 rows, 488 columns, 1327 nonzeros
Found heuristic solution: objective 5044473.6855
Variable types: 332 continuous, 156 integer (156 binary)

Root relaxation: objective -1.582039e+05, 235 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158203.85    0  122 5044473.69 -158203.85   103%     -    0s
H    0     0                    -123080.7598 -158203.85  28.5%     -    0s
H    0     0                    -123321.9803 -158203.85  28.3%     -    0s
H    0     0                    -124635.5553 -137871.68  10.6%     -    0s
H    0     0                    -132837.4309 -137871.68  3.79%     -    0s
H    0     0                    -135771.1771 -137871.68  1.55%     -    0s
     0     0 -137871.68    0   40 -135771.18 -137871.68  1.55%     -    0s
     0     0 -137645.38    0   37 -135771.18 -137645.38  1.38%     -    0s
     0     0 -137645.38    0   37 -135771.18 -137645.38  1.38%     -    0s
H    0     0                    -136979.4177 -137325.29  0.25%     -    0s
     0     0 -137325.29    0   11 -136979.42 -137325.29  0.25%     -    0s
H    0     0                    -137113.8376 -137303.12  0.14%     -    0s
     0     0 -137267.85    0    6 -137113.84 -137267.85  0.11%     -    0s
H    0     0                    -137127.5131 -137267.85  0.10%     -    0s
     0     0 -137235.02    0    5 -137127.51 -137235.02  0.08%     -    0s
     0     0 -137235.02    0   13 -137127.51 -137235.02  0.08%     -    0s
H    0     0                    -137152.2896 -137235.02  0.06%     -    0s
     0     0 -137210.56    0    4 -137152.29 -137210.56  0.04%     -    0s
     0     0 -137194.46    0    4 -137152.29 -137194.46  0.03%     -    0s
H    0     0                    -137165.9651 -137194.46  0.02%     -    0s
     0     0 -137194.46    0    3 -137165.97 -137194.46  0.02%     -    0s
     0     0 -137194.46    0    2 -137165.97 -137194.46  0.02%     -    0s
H    0     0                    -137181.4729 -137194.23  0.01%     -    0s
     0     0 -137181.47    0    2 -137181.47 -137181.47  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 4
  MIR: 8
  Flow cover: 1
  Relax-and-lift: 1

Explored 1 nodes (545 simplex iterations) in 0.07 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -137181 -137166 -137152 ... -123322
No other solutions better than -137181

Optimal solution found (tolerance 1.00e-06)
Best objective -1.371814729158e+05, best bound -1.371814729158e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 161240.94
  Scenario: 14 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137181.47
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -137181.47 = 161240.94
  [DEBUG]   Current θ from Master = 174986.90
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13745.96 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 5186.28
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = -4846.2394, Absolute Gap = 4846.2394, Relative Gap = -0.255978
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 18932.24, LB = 23778.48, Gap = -4846.24
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 45 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567444 nonzeros
Model fingerprint: 0x62af1a0d
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 94656 rows and 38436 columns
Presolve time: 1.57s
Presolved: 105497 rows, 44944 columns, 640107 nonzeros
Variable types: 42685 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -334767.4776
Found heuristic solution: objective -217654.3735

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 566
 AA' NZ     : 4.358e+06
 Factor NZ  : 9.919e+06 (roughly 140 MB of memory)
 Factor Ops : 1.891e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73627430e+07  1.85717885e+08  1.15e+05 1.98e+01  7.63e+04     3s
   1  -1.28719591e+07  1.68645935e+08  7.85e+04 8.33e+01  5.17e+04     3s
   2  -3.82942515e+06  1.30641976e+08  2.35e+04 4.90e-01  1.65e+04     3s
   3  -1.02010148e+06  9.26122570e+07  3.49e+03 1.25e+00  2.76e+03     3s
   4  -5.16363695e+05  5.17294232e+07  5.94e+02 4.74e-01  6.23e+02     3s
   5  -4.05345369e+05  3.01443596e+07  2.48e+02 2.29e-01  2.91e+02     3s
   6  -3.07096733e+05  2.19782795e+07  8.80e+01 1.53e-01  1.59e+02     3s
   7  -2.14883152e+05  1.59183714e+07  3.08e+01 1.06e-01  9.64e+01     3s
   8  -1.47688029e+05  1.10307892e+07  1.46e+01 6.98e-02  6.27e+01     3s
   9  -1.07668431e+05  6.64803205e+06  9.37e+00 4.06e-02  3.70e+01     3s
  10  -7.37858506e+04  2.59843143e+06  5.05e+00 1.47e-02  1.43e+01     3s
  11  -3.71732648e+04  5.77500879e+05  2.44e+00 2.71e-03  3.26e+00     3s
  12  -1.31746010e+04  3.00698855e+05  1.33e+00 1.34e-03  1.65e+00     3s
  13  -4.85844682e+03  1.99783064e+05  1.03e+00 1.43e-03  1.07e+00     3s
  14   1.52818772e+03  1.68418452e+05  8.78e-01 1.70e-03  8.74e-01     3s
  15   8.20333195e+03  1.30946212e+05  7.30e-01 2.54e-03  6.43e-01     3s
  16   1.69446553e+04  1.08636384e+05  5.58e-01 2.82e-03  4.80e-01     3s
  17   2.22104005e+04  9.07288319e+04  4.66e-01 1.14e-03  3.58e-01     3s
  18   2.65201576e+04  8.12615284e+04  3.96e-01 1.80e-03  2.86e-01     3s
  19   3.25325253e+04  7.49006842e+04  3.01e-01 2.10e-03  2.22e-01     3s
  20   3.63814484e+04  6.96719935e+04  2.43e-01 1.55e-03  1.74e-01     3s
  21   3.96511536e+04  6.58859846e+04  1.95e-01 1.35e-03  1.37e-01     4s
  22   4.22115234e+04  6.33804129e+04  1.57e-01 1.09e-03  1.11e-01     4s
  23   4.31424120e+04  5.97528641e+04  1.43e-01 1.67e-03  8.69e-02     4s
  24   4.67723248e+04  5.84459225e+04  9.26e-02 1.25e-03  6.10e-02     4s
  25   4.81000215e+04  5.79870911e+04  7.42e-02 1.18e-03  5.16e-02     4s
  26   4.89858606e+04  5.74340955e+04  6.15e-02 1.03e-03  4.41e-02     4s
  27   4.94992877e+04  5.61289464e+04  5.45e-02 1.59e-03  3.47e-02     4s
  28   5.04641826e+04  5.54948068e+04  4.20e-02 1.59e-03  2.63e-02     4s
  29   5.11798972e+04  5.50474942e+04  3.21e-02 8.44e-04  2.02e-02     4s
  30   5.16151661e+04  5.47005784e+04  2.63e-02 8.45e-04  1.61e-02     4s
  31   5.19477013e+04  5.46163267e+04  2.20e-02 6.71e-04  1.39e-02     4s
  32   5.22940645e+04  5.43132593e+04  1.75e-02 1.75e-03  1.06e-02     4s
  33   5.25913350e+04  5.40621698e+04  1.38e-02 9.03e-04  7.70e-03     4s
  34   5.28119279e+04  5.40354009e+04  1.12e-02 8.68e-04  6.40e-03     4s
  35   5.30306510e+04  5.39285893e+04  8.61e-03 7.11e-04  4.70e-03     4s
  36   5.31691140e+04  5.38849095e+04  6.88e-03 6.39e-04  3.75e-03     4s
  37   5.32923378e+04  5.38546126e+04  5.34e-03 5.04e-04  2.94e-03     4s
  38   5.33620110e+04  5.38095627e+04  4.48e-03 3.01e-04  2.34e-03     4s
  39   5.34436115e+04  5.37868373e+04  3.47e-03 1.95e-04  1.80e-03     4s
  40   5.35592406e+04  5.37786982e+04  2.09e-03 1.49e-04  1.15e-03     4s
  41   5.36635412e+04  5.37622888e+04  8.72e-04 1.12e-04  5.16e-04     4s
  42   5.37231547e+04  5.37500333e+04  2.11e-04 5.28e-05  1.40e-04     4s
  43   5.37418116e+04  5.37461253e+04  2.13e-05 3.35e-05  2.25e-05     4s
  44   5.37437816e+04  5.37445493e+04  4.32e-06 5.73e-06  4.00e-06     4s
  45   5.37443490e+04  5.37443536e+04  1.77e-08 5.82e-08  2.36e-08     5s
  46   5.37443527e+04  5.37443527e+04  9.33e-11 9.41e-12  1.03e-12     5s

Barrier solved model in 46 iterations and 4.54 seconds (8.50 work units)
Optimal objective 5.37443527e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1865 PPushes remaining with PInf 4.4633542e-07                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1029947e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33674    5.3744353e+04   0.000000e+00   0.000000e+00      6s
   33674    5.3744353e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.374435e+04, 33674 iterations, 4.06 seconds (9.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53744.3527    0  292 -217654.37 53744.3527   125%     -    6s
H    0     0                    -215397.9309 53744.3527   125%     -    6s
H    0     0                    -95538.37318 53744.3527   156%     -    6s
H    0     0                    -78276.21649 53744.3527   169%     -    6s
H    0     0                    -77926.71752 53744.3527   169%     -    6s
H    0     0                    -77434.58540 53744.3527   169%     -    6s
H    0     0                    -74360.99534 53744.3527   172%     -    6s
H    0     0                    -23143.51247 53744.3527   332%     -    7s
H    0     0                    -12285.18916 53744.3527   537%     -    7s
H    0     0                    -12243.89938 53744.3527   539%     -    7s
H    0     0                    -12041.00823 53744.3527   546%     -    7s
H    0     0                    -12039.01348 53744.3527   546%     -    7s
H    0     0                    -6471.867137 53744.3527   930%     -    8s
H    0     0                    -6447.108664 53744.3527   934%     -    8s
H    0     0                    -6430.460358 53744.3527   936%     -    8s
H    0     0                    -5124.874052 53744.3527  1149%     -    8s
H    0     0                    -3337.113052 53744.3527  1711%     -    8s
H    0     0                    -3264.470232 53744.3527  1746%     -    8s
H    0     0                    -3253.451149 53744.3527  1752%     -    8s
H    0     0                    -2857.324084 47392.3093  1759%     -   27s
     0     0 47392.3093    0  241 -2857.3241 47392.3093  1759%     -   27s
H    0     0                    -1479.062373 47392.2921  3304%     -   27s
H    0     0                    -985.1832778 47392.2921  4911%     -   28s
H    0     0                    -915.2148661 47392.2921  5278%     -   28s
H    0     0                    1948.3854260 47392.2921  2332%     -   28s
     0     0 46906.8759    0  332 1948.38543 46906.8759  2307%     -   35s
     0     0 46906.7868    0  323 1948.38543 46906.7868  2307%     -   37s
     0     0 46870.1405    0  327 1948.38543 46870.1405  2306%     -   39s
     0     0 46870.1405    0  331 1948.38543 46870.1405  2306%     -   41s
     0     0 46636.6769    0  331 1948.38543 46636.6769  2294%     -   48s
     0     0 46626.9318    0  342 1948.38543 46626.9318  2293%     -   51s
     0     0 46621.7907    0  344 1948.38543 46621.7907  2293%     -   53s
     0     0 46620.1652    0  341 1948.38543 46620.1652  2293%     -   54s
     0     0 46619.8986    0  335 1948.38543 46619.8986  2293%     -   54s
H    0     0                    2354.3286564 43379.8499  1743%     -   86s
H    0     0                    2968.1408132 43379.8499  1362%     -   86s
H    0     0                    3387.6940303 43379.8499  1181%     -   86s
H    0     0                    3793.8490558 43379.8499  1043%     -   86s
H    0     0                    3975.7941143 43379.8499   991%     -   86s
H    0     0                    4042.3850323 43379.8499   973%     -   86s
H    0     0                    4189.1935076 43379.8499   936%     -   86s
H    0     0                    4198.8193625 43379.8499   933%     -   86s
H    0     0                    4238.5171528 43379.8499   923%     -   86s
H    0     0                    4259.0563600 43379.8499   919%     -   86s
     0     0 43379.8499    0  380 4259.05636 43379.8499   919%     -   86s
H    0     0                    6946.6336061 43379.7911   524%     -   86s
     0     0 42233.2137    0  417 6946.63361 42233.2137   508%     -  112s
H    0     0                    7595.1515280 41821.3895   451%     -  133s
H    0     0                    7622.5131570 41821.3895   449%     -  133s
H    0     0                    7661.3083265 41821.3895   446%     -  133s
H    0     0                    7705.2097253 41821.3895   443%     -  133s
H    0     0                    7783.4518211 41821.3895   437%     -  133s
     0     0 41821.3895    0  447 7783.45182 41821.3895   437%     -  133s
     0     0 41766.0474    0  456 7783.45182 41766.0474   437%     -  145s
     0     0 41749.6317    0  450 7783.45182 41749.6317   436%     -  152s
     0     0 41726.4232    0  456 7783.45182 41726.4232   436%     -  160s
     0     0 41650.3543    0  453 7783.45182 41650.3543   435%     -  167s
     0     0 41530.0355    0  454 7783.45182 41530.0355   434%     -  174s
     0     0 41463.3636    0  455 7783.45182 41463.3636   433%     -  184s
H    0     0                    16331.396336 41446.7246   154%     -  189s
H    0     0                    17971.901602 41446.7246   131%     -  189s
     0     0 41446.7246    0  458 17971.9016 41446.7246   131%     -  190s
     0     0 41436.4623    0  466 17971.9016 41436.4623   131%     -  193s
     0     0 41432.2187    0  468 17971.9016 41432.2187   131%     -  196s
     0     0 41427.0443    0  457 17971.9016 41427.0443   131%     -  198s
     0     0 41392.3972    0  493 17971.9016 41392.3972   130%     -  203s
     0     0 41390.4931    0  492 17971.9016 41390.4931   130%     -  205s
     0     0 41390.2511    0  495 17971.9016 41390.2511   130%     -  206s
H    0     0                    18012.044768 39153.1415   117%     -  257s
     0     0 39153.1415    0  408 18012.0448 39153.1415   117%     -  257s
H    0     0                    18820.320298 39152.8202   108%     -  258s
H    0     0                    19069.770249 39152.8202   105%     -  258s
     0     0 38796.7258    0  394 19069.7702 38796.7258   103%     -  275s
     0     0 38638.9320    0  390 19069.7702 38638.9320   103%     -  285s
     0     0 38594.2418    0  395 19069.7702 38594.2418   102%     -  292s
     0     0 38550.4269    0  401 19069.7702 38550.4269   102%     -  301s
     0     0 38526.4749    0  396 19069.7702 38526.4749   102%     -  307s
     0     0 38517.9033    0  388 19069.7702 38517.9033   102%     -  309s
     0     0 38512.9871    0  393 19069.7702 38512.9871   102%     -  312s
     0     0 38503.5807    0  399 19069.7702 38503.5807   102%     -  315s
     0     0 38496.9245    0  409 19069.7702 38496.9245   102%     -  319s
     0     0 38488.8115    0  413 19069.7702 38488.8115   102%     -  321s
     0     0 38480.5212    0  400 19069.7702 38480.5212   102%     -  323s
     0     0 38478.9331    0  403 19069.7702 38478.9331   102%     -  324s
     0     0 37501.1683    0  426 19069.7702 37501.1683  96.7%     -  360s
     0     0 37330.5914    0  462 19069.7702 37330.5914  95.8%     -  371s
     0     0 37183.7522    0  479 19069.7702 37183.7522  95.0%     -  381s
     0     0 37123.7708    0  429 19069.7702 37123.7708  94.7%     -  388s
     0     0 37086.8020    0  432 19069.7702 37086.8020  94.5%     -  393s
     0     0 36987.8648    0  424 19069.7702 36987.8648  94.0%     -  401s
     0     0 36945.4404    0  484 19069.7702 36945.4404  93.7%     -  406s
     0     0 36920.1506    0  487 19069.7702 36920.1506  93.6%     -  409s
     0     0 36908.6351    0  487 19069.7702 36908.6351  93.5%     -  412s
     0     0 36904.4918    0  479 19069.7702 36904.4918  93.5%     -  414s
     0     0 36877.6964    0  417 19069.7702 36877.6964  93.4%     -  416s
     0     0 36867.5586    0  430 19069.7702 36867.5586  93.3%     -  419s
     0     0 36862.0635    0  421 19069.7702 36862.0635  93.3%     -  421s
     0     0 36858.7876    0  425 19069.7702 36858.7876  93.3%     -  424s
     0     0 36858.1481    0  426 19069.7702 36858.1481  93.3%     -  424s
     0     0 36684.2989    0  487 19069.7702 36684.2989  92.4%     -  436s
     0     0 36642.5714    0  487 19069.7702 36642.5714  92.2%     -  443s
     0     0 36613.3555    0  489 19069.7702 36613.3555  92.0%     -  448s
     0     0 36587.4423    0  477 19069.7702 36587.4423  91.9%     -  451s
     0     0 36577.8625    0  469 19069.7702 36577.8625  91.8%     -  453s
     0     0 36543.3417    0  506 19069.7702 36543.3417  91.6%     -  457s
     0     0 36539.5571    0  498 19069.7702 36539.5571  91.6%     -  458s
     0     0 36538.9515    0  493 19069.7702 36538.9515  91.6%     -  460s
     0     0 36454.1772    0  421 19069.7702 36454.1772  91.2%     -  466s
     0     0 36445.6150    0  431 19069.7702 36445.6150  91.1%     -  468s
     0     0 36436.9238    0  473 19069.7702 36436.9238  91.1%     -  470s
H    0     0                    19099.296744 36427.6251  90.7%     -  473s
     0     0 36427.6251    0  473 19099.2967 36427.6251  90.7%     -  473s
     0     0 36426.4809    0  474 19099.2967 36426.4809  90.7%     -  474s
     0     0 36319.5659    0  436 19099.2967 36319.5659  90.2%     -  480s
H    0     0                    19257.034764 36317.6528  88.6%     -  481s
     0     0 36285.4783    0  452 19257.0348 36285.4783  88.4%     -  485s
     0     0 36273.4120    0  398 19257.0348 36273.4120  88.4%     -  488s
     0     0 36267.6062    0  392 19257.0348 36267.6062  88.3%     -  491s
     0     0 36264.7131    0  402 19257.0348 36264.7131  88.3%     -  492s
     0     0 36263.9689    0  397 19257.0348 36263.9689  88.3%     -  493s
     0     0 36215.3226    0  412 19257.0348 36215.3226  88.1%     -  499s
     0     0 36207.2442    0  411 19257.0348 36207.2442  88.0%     -  501s
     0     0 36205.5877    0  423 19257.0348 36205.5877  88.0%     -  502s
     0     0 36178.6769    0  438 19257.0348 36178.6769  87.9%     -  506s
     0     0 36175.7609    0  431 19257.0348 36175.7609  87.9%     -  508s
     0     0 36173.4435    0  491 19257.0348 36173.4435  87.8%     -  509s
     0     0 36162.8963    0  485 19257.0348 36162.8963  87.8%     -  513s
H    0     0                    19293.596938 36162.4752  87.4%     -  513s
     0     0 36160.5751    0  431 19293.5969 36160.5751  87.4%     -  515s
     0     0 36153.2045    0  410 19293.5969 36153.2045  87.4%     -  519s
     0     0 36153.1548    0  410 19293.5969 36153.1548  87.4%     -  521s
     0     2 36153.0903    0  410 19293.5969 36153.0903  87.4%     -  596s
     1     3 35928.4945    1  468 19293.5969 36152.7804  87.4% 11436  603s
     2     4 36013.0492    1  423 19293.5969 36013.0492  86.7%  7232  610s
     3     7 35873.3888    2  496 19293.5969 36012.6827  86.7%  8722  620s
     6    13 35584.2097    3  472 19293.5969 35925.4255  86.2%  9470  640s
    12    26 35400.4766    4  417 19293.5969 35870.5835  85.9% 13621  653s
    25    39 33716.8600    5  462 19293.5969 35604.4571  84.5% 16110  686s
    38    67 32558.7260    6  433 19293.5969 35604.0713  84.5% 20308  861s
    66   130 33807.5854    6  473 19293.5969 35418.5966  83.6% 26554  903s
   129   162 33746.2856    7  402 19293.5969 35279.3933  82.9% 20943  922s
   161   222 33678.7925    8  389 19293.5969 35279.3933  82.9% 19655  946s
H  215   222                    21034.560444 35279.3933  67.7% 16451  946s
   221   314 33530.2825    9  394 21034.5604 35279.3933  67.7% 16298  973s
H  313   393                    21538.112834 35279.3933  63.8% 13549  994s
H  316   393                    21539.880340 35279.3933  63.8% 13479  994s
H  351   393                    21844.405831 35279.3933  61.5% 12820  994s
   392   467 33083.5216   14  371 21844.4058 35279.3933  61.5% 12238 1013s
   466   530 32871.4323   16  361 21844.4058 35279.3933  61.5% 11375 1030s
H  467   530                    21846.839372 35279.3933  61.5% 11350 1030s
H  481   530                    21848.606878 35279.3933  61.5% 11203 1030s
   531   615 32304.9170   18  435 21848.6069 35279.3933  61.5% 10895 1045s
H  616   683                    22209.620782 35279.3933  58.8% 10210 1060s
   686   739 32236.7551   18  358 22209.6208 35279.3933  58.8% 10150 1074s
H  750   781                    22242.675341 35279.3933  58.6% 10158 1086s
H  759   781                    22271.245107 35279.3933  58.4% 10182 1086s
H  767   781                    22324.112692 35279.3933  58.0% 10181 1086s
H  770   781                    23266.535428 35279.3933  51.6% 10171 1086s
   800   845 31370.8580   21  343 23266.5354 35279.3933  51.6% 10160 1102s
   880   934 31217.1165   23  336 23266.5354 35279.3933  51.6%  9950 1114s
H  896   934                    23346.120009 35279.3933  51.1%  9907 1114s
   971  1017 29197.9482   27  212 23346.1200 35279.3933  51.1%  9736 1129s
  1076  1045 28738.9665   29  205 23346.1200 35279.3933  51.1%  9473 1142s
  1124  1089 28731.3969   30  202 23346.1200 35279.3933  51.1%  9417 1157s
  1200  1130 28501.3449   31  203 23346.1200 35279.3933  51.1%  9296 1173s
  1278  1198 28444.0476   33  225 23346.1200 35279.3933  51.1%  9173 1190s
  1366  1290 27711.6976   39  186 23346.1200 35279.3933  51.1%  9139 1208s
  1464  1376 27461.6905   41  171 23346.1200 35279.3933  51.1%  9080 1225s
  1582  1464 27250.5621   45  316 23346.1200 35279.3933  51.1%  8908 1245s
  1698  1511 26949.8999   50  265 23346.1200 35279.3933  51.1%  8862 1265s
  1805  1539 26427.3629   57  232 23346.1200 34378.6361  47.3%  8794 1284s
H 1832  1539                    23724.484860 34378.6361  44.9%  8793 1284s
  1855  1618 26218.7352   58  231 23724.4849 34378.6361  44.9%  8831 1308s
  1958  1725 25644.9626   68  258 23724.4849 34356.5549  44.8%  8893 1327s
  2075  1833 24836.8006   81  232 23724.4849 34279.9652  44.5%  8882 1347s
  2211  1946 infeasible   27      23724.4849 34264.2065  44.4%  8826 1368s
  2371  2023 31943.0566    8  381 23724.4849 34213.3470  44.2%  8731 1391s
H 2420  2021                    23747.303312 34213.1197  44.1%  8674 1391s
H 2483  2018                    23794.989630 34045.8393  43.1%  8652 1391s
  2492  2139 31412.1338    9  390 23794.9896 34045.8393  43.1%  8668 1413s
  2656  2244 28898.3410   11  288 23794.9896 33992.7667  42.9%  8563 1436s
  2823  2367 28423.8230   13  327 23794.9896 33992.7667  42.9%  8519 1460s
  2980  2410 26682.8286   15  354 23794.9896 33992.7667  42.9%  8537 1485s
H 2981  2385                    24066.523785 33992.7667  41.2%  8535 1485s
  3059  2502 26636.0997   16  355 24066.5238 33992.7667  41.2%  8551 1516s
  3232  2598 24744.3701   20  283 24066.5238 33848.1430  40.6%  8572 1546s
  3406  2729 24347.1625   49  251 24066.5238 33819.7775  40.5%  8557 1574s
  3597  2784 24182.0388   50  262 24066.5238 33819.7775  40.5%  8558 1609s
H 3622  2783                    24079.304054 33819.7775  40.5%  8575 1609s
  3692  2924 infeasible   51      24079.3041 33749.1717  40.2%  8579 1640s
H 3907  2923                    24132.171639 33749.1717  39.9%  8573 1676s
  3908  2924 24665.2285   45  410 24132.1716 33749.1717  39.9%  8571 1818s
  3910  2925 27807.1507   27  230 24132.1716 33749.1717  39.9%  8567 1831s
  3911  2926 27342.1713   56  407 24132.1716 33749.1717  39.9%  8564 1894s
  3912  2927 26372.1613   40  369 24132.1716 33749.1717  39.9%  8562 1940s
  3913  2927 24361.8529   50  433 24132.1716 33749.1717  39.9%  8560 1973s
  3914  2928 26263.6338   60  462 24132.1716 33749.1717  39.9%  8558 1998s
  3915  2929 28114.7594   23  422 24132.1716 33749.1717  39.9%  8556 2014s
  3916  2929 26532.6430   22  480 24132.1716 33749.1717  39.9%  8553 2034s
  3917  2930 26827.3225   29  481 24132.1716 33749.1717  39.9%  8551 2047s
  3918  2931 28372.9363   17  467 24132.1716 33749.1717  39.9%  8549 2056s
  3919  2931 27424.0303   24  412 24132.1716 33749.1717  39.9%  8547 2062s
  3920  2932 24907.8544   52  470 24132.1716 33749.1717  39.9%  8545 2069s
  3921  2933 24736.3928   26  416 24132.1716 33749.1717  39.9%  8543 2075s
  3922  2933 28802.9216   21  419 24132.1716 33749.1717  39.9%  8540 2080s
  3923  2934 24799.6436   24  458 24132.1716 33749.1717  39.9%  8538 2094s
  3924  2935 26900.2798   34  491 24132.1716 33749.1717  39.9%  8536 2106s
  3925  2935 31362.4312    6  459 24132.1716 33749.1717  39.9%  8534 2112s
  3926  2936 32031.5525    8  474 24132.1716 33749.1717  39.9%  8532 2116s
  3927  2937 30333.4869   14  433 24132.1716 33749.1717  39.9%  8530 2120s
  3928  2937 28278.2505   20  515 24132.1716 33749.1717  39.9%  8527 2133s
  3929  2938 27429.4473   21  514 24132.1716 33749.1717  39.9%  8525 2141s
  3930  2939 28951.9219   12  507 24132.1716 33749.1717  39.9%  8523 2147s
  3932  2940 32883.4814    8  508 24132.1716 33749.1717  39.9%  8519 2154s
  3933  2941 25612.3809   55  441 24132.1716 33749.1717  39.9%  8517 2165s
  3935  2942 33380.0413   16  502 24132.1716 33749.1717  39.9%  8512 2174s
  3936  2943 30500.4349    9  502 24132.1716 33749.1717  39.9%  8510 2180s
  3937  2943 27429.4473   21  482 24132.1716 33749.1717  39.9%  8508 2190s
  3939  2945 30419.7646   17  496 24132.1716 33749.1717  39.9%  8504 2197s
  3940  2945 28353.1730   24  478 24132.1716 33749.1717  39.9%  8501 2201s
  3941  2946 30767.8295   17  495 24132.1716 33749.1717  39.9%  8499 2227s
  3942  2947 27017.3879   31  523 24132.1716 33749.1717  39.9%  8497 2230s
  3943  2947 24968.0980   79  526 24132.1716 33749.1717  39.9%  8495 2235s
  3944  2948 26700.3133   29  472 24132.1716 33749.1717  39.9%  8493 2249s
  3945  2949 25259.4418   30  547 24132.1716 33749.1717  39.9%  8491 2252s
  3946  2949 30066.6687   16  551 24132.1716 33749.1717  39.9%  8488 2258s
  3947  2950 30548.4238   23  525 24132.1716 33749.1717  39.9%  8486 2270s
  3949  2951 27825.7640   24  522 24132.1716 33749.1717  39.9%  8482 2277s
  3950  2952 29005.1207   18  505 24132.1716 33749.1717  39.9%  8480 2287s
  3951  2953 26529.3419   34  501 24132.1716 33749.1717  39.9%  8478 2293s
  3952  2953 25554.7090   34  524 24132.1716 33749.1717  39.9%  8476 2304s
  3953  2954 30508.6202   24  524 24132.1716 33749.1717  39.9%  8473 2319s
  3954  2955 25888.0660   36  524 24132.1716 33749.1717  39.9%  8471 2381s
  3955  2958 33749.1717   16  516 24132.1716 33749.1717  39.9%  8579 2409s
  3957  2961 33749.1717   17  508 24132.1716 33749.1717  39.9%  8580 2449s
  3960  2966 33749.1717   18  486 24132.1716 33749.1717  39.9%  8587 2476s
  3966  2977 33749.1717   19  517 24132.1716 33749.1717  39.9%  8604 2501s
  3979  2985 33749.1717   20  532 24132.1716 33749.1717  39.9%  8646 2557s
  3992  3011 32447.7457   21  423 24132.1716 33749.1717  39.9%  8701 2825s
  4022  3089 32102.5294   22  373 24132.1716 33749.1717  39.9%  8889 2872s
  4110  3129 31795.7259   23  416 24132.1716 33749.1717  39.9%  8987 2904s
  4181  3162 31401.4803   25  340 24132.1716 33749.1717  39.9%  9038 2933s
  4248  3176 30715.3300   27  319 24132.1716 33749.1717  39.9%  9070 2958s
  4311  3180 28125.8712   28  284 24132.1716 33749.1717  39.9%  9123 2982s
  4362  3186 26235.7869   29  285 24132.1716 33749.1717  39.9%  9205 3003s
  4393  3179     cutoff   30      24132.1716 33749.1717  39.9%  9260 3023s
  4433  3181 29852.5557   26  431 24132.1716 33749.1717  39.9%  9307 3069s
  4471  3172 infeasible   31      24132.1716 33749.1717  39.9%  9338 3126s
  4512  3160 28043.0185   27  411 24132.1716 33749.1717  39.9%  9393 3167s
  4549  3156 27119.2253   28  417 24132.1716 33749.1717  39.9%  9453 3190s
  4591  3151 25288.7023   28  317 24132.1716 33749.1717  39.9%  9535 3212s
  4620  3155 31628.5866   26  487 24132.1716 33749.1717  39.9%  9559 3235s
  4654  3158 27139.4451   28  359 24132.1716 33749.1717  39.9%  9609 3257s
  4690  3166 26925.2016   29  305 24132.1716 33749.1717  39.9%  9640 3285s
  4724  3176 26064.8741   30  299 24132.1716 33749.1717  39.9%  9663 3309s
  4764  3181 25677.2556   31  337 24132.1716 33084.2159  37.1%  9705 3331s
  4802  3190 25657.5749   32  329 24132.1716 33084.2159  37.1%  9709 3353s
  4840  3196 24711.1607   33  218 24132.1716 33011.5914  36.8%  9718 3376s
  4872  3201     cutoff   34      24132.1716 33011.5914  36.8%  9735 3404s
  4912  3211 infeasible   34      24132.1716 33011.5914  36.8%  9747 3426s
  4957  3206     cutoff   34      24132.1716 33011.5914  36.8%  9781 3451s
  5004  3199 25795.7947   31  230 24132.1716 32436.2365  34.4%  9827 3476s
  5068  3200 25783.1039   32  229 24132.1716 32436.2365  34.4%  9860 3505s
  5128  3188 24560.9835   33  323 24132.1716 32436.2365  34.4%  9889 3535s
  5198  3182 24259.9316   34  294 24132.1716 32436.2365  34.4%  9916 3563s
  5280  3170 infeasible   35      24132.1716 32436.2365  34.4%  9916 3597s
  5344  3151 infeasible   29      24132.1716 32436.2365  34.4%  9936 3600s

Cutting planes:
  Gomory: 13
  Implied bound: 22
  Projected implied bound: 243
  MIR: 1077
  Flow cover: 2000
  Zero half: 1
  RLT: 28
  Relax-and-lift: 354

Explored 5351 nodes (53742125 simplex iterations) in 3600.05 seconds (9466.23 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 24132.2 24079.3 24066.5 ... 22271.2

Time limit reached
Best objective 2.413217163893e+04, best bound 3.243623646272e+04, gap 34.4108%
  WARNING: Time limit reached. Using best solution found (gap: 34.41%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 24132.17, θ = 170388.94
  Upper Bound (UB) = 24132.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170388.94
  [DEBUG]   ✓ Scenario 0: θ = 170388.94 ≤ Q = 170388.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170388.94 ≤ Q = 170388.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170388.94 ≤ Q = 170388.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 170388.94 ≤ Q = 170388.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 170388.94 ≤ Q = 170388.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 170388.94 ≤ Q = 170388.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 170388.94 ≤ Q = 170388.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 170388.94 ≤ Q = 170388.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 170388.94 ≤ Q = 170388.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 170388.94 ≤ Q = 170388.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 170388.94 ≤ Q = 170388.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 170388.94 ≤ Q = 170388.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 170388.94 ≤ Q = 170388.94 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7b61580f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7b61580f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.399974e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.01s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 6411024.6377
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.619754e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161975.44    0  127 6411024.64 -161975.44   103%     -    0s
H    0     0                    -125062.7968 -161975.44  29.5%     -    0s
H    0     0                    -126605.5328 -161975.44  27.9%     -    0s
     0     0 -139577.76    0   61 -126605.53 -139577.76  10.2%     -    0s
H    0     0                    -137954.4116 -139540.11  1.15%     -    0s
     0     0 -139450.62    0   61 -137954.41 -139450.62  1.08%     -    0s
H    0     0                    -138944.1027 -139450.62  0.36%     -    0s
H    0     0                    -138948.0410 -139450.62  0.36%     -    0s
     0     0 -139121.50    0   35 -138948.04 -139121.50  0.12%     -    0s
     0     0 -138990.39    0    6 -138948.04 -138990.39  0.03%     -    0s
     0     0 -138968.89    0    6 -138948.04 -138968.89  0.02%     -    0s
     0     0 -138968.80    0    6 -138948.04 -138968.80  0.01%     -    0s
H    0     0                    -138960.9890 -138968.80  0.01%     -    0s

Cutting planes:
  Gomory: 35
  MIR: 129
  RLT: 42
  BQP: 1

Explored 1 nodes (484 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -138961 -138948 -138944 ... 1.39997e+13
No other solutions better than -138961

Optimal solution found (tolerance 1.00e-06)
Best objective -1.389609890353e+05, best bound -1.389609890353e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 159461.42
  Scenario: 27 demand increases, 32 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138960.99
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -138960.99 = 159461.42
  [DEBUG]   Current θ from Master = 170388.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10927.51 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13204.66
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 353.6942, Absolute Gap = 353.6942, Relative Gap = 0.014657
  Not converged yet (gap = 353.69 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 32 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610669 nonzeros
Model fingerprint: 0x7989a1a8
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101948 rows and 41398 columns
Presolve time: 2.17s
Presolved: 113495 rows, 48222 columns, 686423 nonzeros
Variable types: 45963 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -334667.8726
Found heuristic solution: objective -217654.3735

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 564
 AA' NZ     : 4.889e+06
 Factor NZ  : 1.134e+07 (roughly 160 MB of memory)
 Factor Ops : 2.269e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78400997e+07  1.97773279e+08  1.18e+05 1.90e+01  7.79e+04     4s
   1  -1.32882583e+07  1.80268125e+08  8.08e+04 8.37e+01  5.29e+04     4s
   2  -4.08050913e+06  1.40316704e+08  2.49e+04 4.29e-01  1.73e+04     4s
   3  -1.11599156e+06  1.00426672e+08  3.99e+03 2.06e+00  3.08e+03     4s
   4  -5.50013610e+05  6.47030425e+07  7.01e+02 6.81e-01  7.37e+02     4s
   5  -4.05689737e+05  3.46242207e+07  2.49e+02 2.86e-01  3.01e+02     4s
   6  -3.15426526e+05  2.39448223e+07  8.00e+01 1.81e-01  1.55e+02     4s
   7  -2.34001502e+05  1.74514907e+07  3.11e+01 1.25e-01  9.80e+01     4s
   8  -1.62174146e+05  1.15844183e+07  9.68e+00 7.93e-02  5.96e+01     4s
   9  -1.23826764e+05  6.72487557e+06  6.25e+00 4.41e-02  3.42e+01     4s
  10  -8.32124171e+04  2.23398028e+06  3.86e+00 1.32e-02  1.15e+01     4s
  11  -4.24275473e+04  9.88481942e+05  1.93e+00 5.40e-03  5.04e+00     4s
  12  -1.51470765e+04  3.73900982e+05  1.02e+00 1.82e-03  1.89e+00     4s
  13  -1.83006914e+03  2.18706282e+05  6.30e-01 9.10e-04  1.07e+00     4s
  14   3.09485725e+03  1.75355482e+05  5.26e-01 7.42e-04  8.35e-01     4s
  15   9.04178252e+03  1.38802948e+05  4.18e-01 1.51e-03  6.29e-01     4s
  16   1.75985267e+04  1.15107552e+05  3.14e-01 1.13e-03  4.72e-01     4s
  17   2.53282640e+04  9.88884709e+04  2.32e-01 2.15e-03  3.56e-01     4s
  18   2.74472131e+04  8.79229001e+04  2.10e-01 1.60e-03  2.93e-01     4s
  19   3.27355691e+04  7.70721323e+04  1.63e-01 1.98e-03  2.15e-01     4s
  20   3.80108844e+04  7.16903949e+04  1.17e-01 1.77e-03  1.63e-01     4s
  21   4.12023641e+04  6.76384965e+04  9.08e-02 1.53e-03  1.28e-01     4s
  22   4.36052517e+04  6.52638846e+04  7.08e-02 1.32e-03  1.05e-01     4s
  23   4.47006735e+04  6.05323328e+04  6.21e-02 1.41e-03  7.66e-02     5s
  24   4.66428568e+04  5.92473911e+04  4.78e-02 1.12e-03  6.10e-02     5s
  25   4.78389736e+04  5.73825396e+04  3.83e-02 1.52e-03  4.62e-02     5s
  26   4.89282351e+04  5.61951645e+04  3.04e-02 1.53e-03  3.52e-02     5s
  27   4.98422357e+04  5.56462861e+04  2.38e-02 1.03e-03  2.81e-02     5s
  28   5.04755315e+04  5.51400595e+04  1.94e-02 9.04e-04  2.26e-02     5s
  29   5.10150407e+04  5.47385279e+04  1.56e-02 9.02e-04  1.80e-02     5s
  30   5.17347744e+04  5.42931202e+04  1.10e-02 5.83e-04  1.24e-02     5s
  31   5.18524055e+04  5.42738379e+04  1.02e-02 5.70e-04  1.17e-02     5s
  32   5.21085272e+04  5.40333222e+04  8.54e-03 4.57e-04  9.32e-03     5s
  33   5.23312481e+04  5.39886435e+04  7.11e-03 4.39e-04  8.02e-03     5s
  34   5.24321447e+04  5.39251591e+04  6.45e-03 3.61e-04  7.23e-03     5s
  35   5.27126731e+04  5.37561174e+04  4.49e-03 2.46e-04  5.05e-03     5s
  36   5.27754162e+04  5.36440080e+04  4.06e-03 1.75e-04  4.21e-03     5s
  37   5.28780939e+04  5.36081183e+04  3.39e-03 1.49e-04  3.53e-03     5s
  38   5.30662197e+04  5.35823840e+04  2.17e-03 1.26e-04  2.50e-03     5s
  39   5.31176235e+04  5.34958425e+04  1.84e-03 6.54e-05  1.83e-03     5s
  40   5.32610913e+04  5.34724892e+04  9.19e-04 5.24e-05  1.02e-03     5s
  41   5.33326594e+04  5.34385796e+04  4.93e-04 7.60e-05  5.13e-04     5s
  42   5.33730755e+04  5.34331635e+04  2.74e-04 4.26e-05  2.91e-04     5s
  43   5.34130723e+04  5.34271502e+04  6.19e-05 7.67e-06  6.81e-05     5s
  44   5.34175364e+04  5.34256371e+04  3.88e-05 9.62e-06  3.92e-05     6s
  45   5.34194934e+04  5.34255422e+04  2.88e-05 5.55e-06  2.93e-05     6s
  46   5.34248685e+04  5.34255400e+04  2.16e-06 4.80e-06  3.25e-06     6s
  47   5.34254227e+04  5.34254245e+04  1.51e-08 1.04e-07  8.35e-09     6s
  48   5.34254241e+04  5.34254241e+04  3.37e-10 8.71e-11  5.00e-12     6s

Barrier solved model in 48 iterations and 5.72 seconds (9.94 work units)
Optimal objective 5.34254241e+04


Root crossover log...

   95155 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    2010 PPushes remaining with PInf 9.3873944e-07                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.7419572e-11      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34827    5.3425424e+04   0.000000e+00   0.000000e+00      8s
   34827    5.3425424e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 2.53s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.342542e+04, 34827 iterations, 7.47 seconds (11.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53425.4241    0  302 -217654.37 53425.4241   125%     -   10s
H    0     0                    -108207.5034 53425.4241   149%     -   11s
H    0     0                    -89852.10275 53425.4241   159%     -   11s
H    0     0                    -89746.44383 53425.4241   160%     -   11s
H    0     0                    -81935.55715 53425.4241   165%     -   11s
H    0     0                    -8974.931761 53425.4241   695%     -   11s
H    0     0                    -8926.486037 53425.4241   699%     -   11s
H    0     0                    -7717.748872 53425.4241   792%     -   11s
H    0     0                    -6355.594811 47073.6438   841%     -   39s
H    0     0                    2049.9611435 47073.6438  2196%     -   39s
H    0     0                    3557.4085742 47073.6438  1223%     -   39s
H    0     0                    3562.8179567 47073.6438  1221%     -   39s
     0     0 47073.6438    0  335 3562.81796 47073.6438  1221%     -   39s
H    0     0                    7504.1240111 47073.4253   527%     -   40s
H    0     0                    7569.3115953 47073.4253   522%     -   40s
H    0     0                    7645.1082753 47073.4253   516%     -   40s
H    0     0                    7738.3754297 47073.4253   508%     -   40s
H    0     0                    7781.0189979 47073.4253   505%     -   40s
     0     0 46569.0849    0  353 7781.01900 46569.0849   498%     -   51s
     0     0 46540.4002    0  356 7781.01900 46540.4002   498%     -   53s
     0     0 46481.5477    0  316 7781.01900 46481.5477   497%     -   62s
     0     0 46481.5477    0  322 7781.01900 46481.5477   497%     -   65s
     0     0 46481.5477    0  357 7781.01900 46481.5477   497%     -   68s
     0     0 46481.5477    0  352 7781.01900 46481.5477   497%     -   69s
     0     0 46476.0208    0  352 7781.01900 46476.0208   497%     -   69s
     0     0 46475.9124    0  354 7781.01900 46475.9124   497%     -   70s
     0     0 43107.6601    0  454 7781.01900 43107.6601   454%     -  127s
H    0     0                    9752.3780968 43107.1167   342%     -  128s
H    0     0                    10468.867755 43107.1167   312%     -  128s
H    0     0                    10850.022837 43107.1167   297%     -  128s
     0     0 42325.7758    0  453 10850.0228 42325.7758   290%     -  155s
     0     0 42215.8901    0  433 10850.0228 42215.8901   289%     -  170s
     0     0 42177.9384    0  449 10850.0228 42177.9384   289%     -  179s
H    0     0                    11966.668808 41861.2566   250%     -  200s
H    0     0                    12036.391834 41861.2566   248%     -  200s
H    0     0                    12263.069291 41861.2566   241%     -  200s
     0     0 41861.2566    0  510 12263.0693 41861.2566   241%     -  200s
     0     0 41808.5619    0  530 12263.0693 41808.5619   241%     -  208s
     0     0 41784.5041    0  500 12263.0693 41784.5041   241%     -  215s
     0     0 41764.9865    0  510 12263.0693 41764.9865   241%     -  219s
     0     0 41579.9759    0  462 12263.0693 41579.9759   239%     -  229s
     0     0 41544.2351    0  460 12263.0693 41544.2351   239%     -  236s
     0     0 41538.1816    0  477 12263.0693 41538.1816   239%     -  239s
     0     0 41535.6758    0  476 12263.0693 41535.6758   239%     -  241s
     0     0 41529.2851    0  483 12263.0693 41529.2851   239%     -  242s
     0     0 41529.0368    0  480 12263.0693 41529.0368   239%     -  242s
     0     0 39332.0548    0  417 12263.0693 39332.0548   221%     -  293s
H    0     0                    12584.149394 39332.0524   213%     -  293s
H    0     0                    13115.903380 39332.0524   200%     -  294s
H    0     0                    13490.384330 39332.0524   192%     -  294s
H    0     0                    13496.384990 39332.0524   191%     -  294s
H    0     0                    13586.457115 38755.6516   185%     -  315s
H    0     0                    13609.275567 38755.6516   185%     -  315s
H    0     0                    14020.763772 38755.6516   176%     -  315s
     0     0 38755.6516    0  426 14020.7638 38755.6516   176%     -  317s
H    0     0                    14069.199899 38632.9142   175%     -  325s
H    0     0                    14922.729329 38632.9142   159%     -  325s
H    0     0                    15033.991909 38632.9142   157%     -  325s
     0     0 38632.9142    0  488 15033.9919 38632.9142   157%     -  325s
     0     0 38538.6944    0  476 15033.9919 38538.6944   156%     -  335s
     0     0 38471.6200    0  489 15033.9919 38471.6200   156%     -  345s
     0     0 38433.4152    0  508 15033.9919 38433.4152   156%     -  350s
     0     0 38426.1864    0  513 15033.9919 38426.1864   156%     -  353s
     0     0 38415.2374    0  508 15033.9919 38415.2374   156%     -  356s
     0     0 38394.9896    0  506 15033.9919 38394.9896   155%     -  358s
     0     0 38387.5371    0  516 15033.9919 38387.5371   155%     -  360s
     0     0 38374.8279    0  509 15033.9919 38374.8279   155%     -  362s
     0     0 38370.9181    0  520 15033.9919 38370.9181   155%     -  365s
     0     0 38369.6883    0  518 15033.9919 38369.6883   155%     -  366s
     0     0 37630.4838    0  512 15033.9919 37630.4838   150%     -  399s
     0     0 37458.6750    0  488 15033.9919 37458.6750   149%     -  415s
     0     0 37298.9159    0  488 15033.9919 37298.9159   148%     -  427s
     0     0 37242.7206    0  479 15033.9919 37242.7206   148%     -  434s
     0     0 37210.1417    0  500 15033.9919 37210.1417   148%     -  439s
     0     0 37183.1799    0  511 15033.9919 37183.1799   147%     -  447s
     0     0 37124.3620    0  502 15033.9919 37124.3620   147%     -  453s
     0     0 37108.9558    0  496 15033.9919 37108.9558   147%     -  456s
     0     0 37071.1726    0  471 15033.9919 37071.1726   147%     -  460s
     0     0 37039.7987    0  483 15033.9919 37039.7987   146%     -  466s
     0     0 37036.7471    0  484 15033.9919 37036.7471   146%     -  467s
     0     0 37031.3134    0  476 15033.9919 37031.3134   146%     -  469s
     0     0 37026.5857    0  484 15033.9919 37026.5857   146%     -  470s
     0     0 37025.1007    0  486 15033.9919 37025.1007   146%     -  471s
     0     0 36794.9659    0  518 15033.9919 36794.9659   145%     -  486s
H    0     0                    16383.545665 36793.8167   125%     -  487s
H    0     0                    16404.632840 36793.8167   124%     -  487s
     0     0 36730.2805    0  518 16404.6328 36730.2805   124%     -  494s
     0     0 36681.6240    0  524 16404.6328 36681.6240   124%     -  499s
     0     0 36672.5319    0  527 16404.6328 36672.5319   124%     -  505s
     0     0 36631.6935    0  510 16404.6328 36631.6935   123%     -  511s
     0     0 36629.3732    0  525 16404.6328 36629.3732   123%     -  513s
     0     0 36521.9061    0  511 16404.6328 36521.9061   123%     -  524s
     0     0 36492.9421    0  440 16404.6328 36492.9421   122%     -  540s
     0     0 36475.9964    0  442 16404.6328 36475.9964   122%     -  542s
     0     0 36440.7299    0  450 16404.6328 36440.7299   122%     -  548s
     0     0 36421.1711    0  482 16404.6328 36421.1711   122%     -  552s
     0     0 36414.9629    0  493 16404.6328 36414.9629   122%     -  554s
     0     0 36412.1401    0  433 16404.6328 36412.1401   122%     -  556s
     0     0 36408.0603    0  437 16404.6328 36408.0603   122%     -  558s
     0     0 36406.3406    0  447 16404.6328 36406.3406   122%     -  559s
     0     0 36318.2613    0  532 16404.6328 36318.2613   121%     -  568s
     0     0 36298.9366    0  522 16404.6328 36298.9366   121%     -  574s
     0     0 36293.9698    0  491 16404.6328 36293.9698   121%     -  576s
     0     0 36277.4297    0  486 16404.6328 36277.4297   121%     -  579s
     0     0 36276.2495    0  475 16404.6328 36276.2495   121%     -  580s
     0     0 36239.0236    0  517 16404.6328 36239.0236   121%     -  586s
     0     0 36227.1221    0  448 16404.6328 36227.1221   121%     -  592s
     0     0 36225.2899    0  448 16404.6328 36225.2899   121%     -  593s
     0     0 36203.9888    0  513 16404.6328 36203.9888   121%     -  598s
     0     0 36198.1016    0  527 16404.6328 36198.1016   121%     -  601s
     0     0 36197.0541    0  523 16404.6328 36197.0541   121%     -  602s
     0     0 36189.8689    0  510 16404.6328 36189.8689   121%     -  605s
H    0     0                    16458.549843 36189.7044   120%     -  607s
     0     0 36186.9455    0  451 16458.5498 36186.9455   120%     -  615s
     0     0 36183.7923    0  443 16458.5498 36183.7923   120%     -  617s
     0     0 36183.0461    0  524 16458.5498 36183.0461   120%     -  618s
     0     0 36178.1907    0  531 16458.5498 36178.1907   120%     -  622s
     0     0 36177.7925    0  531 16458.5498 36177.7925   120%     -  625s
H    0     0                    16469.125845 36177.7925   120%     -  724s
H    0     0                    17917.017245 36177.7925   102%     -  724s
H    0     0                    17918.350890 36177.7925   102%     -  725s
H    0     2                    17962.291937 36177.7925   101%     -  727s
     0     2 36177.7925    0  531 17962.2919 36177.7925   101%     -  727s
     1     3 34874.5247    1  428 17962.2919 36177.6901   101% 27234  753s
     2     5 34505.7699    2  426 17962.2919 36177.6901   101% 20445  766s
     4     9 34048.6061    3  407 17962.2919 35978.6356   100% 17833  784s
     8    18 35217.5037    3  430 17962.2919 35978.6356   100% 15944  803s
    17    36 35000.2928    4  450 17962.2919 35474.6803  97.5% 15366  817s
    35    50 34792.5247    5  449 17962.2919 35254.5001  96.3% 18793 2364s
    49    78 33606.9741    6  426 17962.2919 35254.5001  96.3% 26448 2400s
H   56    78                    18468.318810 35254.5001  90.9% 25792 2400s
    77   151 33540.8565    7  403 18468.3188 35254.5001  90.9% 22591 2453s
   150   260 33408.8233   10  393 18468.3188 35254.5001  90.9% 16761 2479s
H  154   260                    18491.600477 35254.5001  90.7% 16433 2479s
H  218   260                    18567.910157 35254.5001  89.9% 13151 2479s
   259   320 33253.2992   14  413 18567.9102 35254.5001  89.9% 11794 2501s
   319   369 33161.9386   15  425 18567.9102 35254.5001  89.9% 10726 2521s
H  321   369                    18591.191824 35254.5001  89.6% 10686 2521s
   368   432 33042.9794   17  414 18591.1918 35254.5001  89.6% 10051 2540s
   431   491 32906.0784   19  417 18591.1918 35254.5001  89.6%  9392 2558s
H  439   491                    18651.185876 35254.5001  89.0%  9294 2558s
   490   543 32875.1995   21  420 18651.1859 35254.5001  89.0%  8913 2576s
H  544   602                    18665.334807 35254.5001  88.9%  8576 2592s
   603   665 32552.3443   24  449 18665.3348 35254.5001  88.9%  8561 2606s
   666   731 32205.2153   26  439 18665.3348 35254.5001  88.9%  8750 2620s
   737   782 31918.5539   27  459 18665.3348 35254.5001  88.9%  8765 2636s
   798   831 30852.8299   28  397 18665.3348 35254.5001  88.9%  8815 2650s
H  804   831                    18670.038996 35254.5001  88.8%  8825 2650s
H  846   831                    18679.535314 35254.5001  88.7%  8910 2650s
   857   910 30253.2880   29  444 18679.5353 35254.5001  88.7%  8943 2666s
   940   939 30075.5627   31  429 18679.5353 35254.5001  88.7%  8918 2720s
   973  1008 26632.4467   37  237 18679.5353 35254.5001  88.7%  8984 2736s
H 1011  1008                    18848.274357 35254.5001  87.0%  8879 2736s
  1050  1036 26168.0423   39  266 18848.2744 35254.5001  87.0%  8966 2750s
  1080  1065 27993.4524   31  253 18848.2744 35254.5001  87.0%  8960 2763s
H 1092  1065                    18854.577803 35254.5001  87.0%  8969 2763s
  1115  1151 26527.8807   32  244 18854.5778 35254.5001  87.0%  9046 2780s
  1223  1242 26079.1873   33  261 18854.5778 35254.5001  87.0%  8874 2796s
  1354  1327 25435.1656   35  282 18854.5778 35254.5001  87.0%  8648 2816s
  1498  1408 21473.6092   36  274 18854.5778 35254.5001  87.0%  8366 2837s
  1641  1447 20554.2121   37  239 18854.5778 35254.5001  87.0%  8116 2857s
  1768  1463     cutoff   40      18854.5778 35254.5001  87.0%  8090 2880s
  1846  1517     cutoff   40      18854.5778 35254.5001  87.0%  8182 2904s
  1928  1590 28698.3783   14  410 18854.5778 35167.6522  86.5%  8378 2926s
  2021  1618 18999.3531   15  431 18854.5778 35167.6522  86.5%  8482 2952s
H 2029  1618                    19057.991864 35167.6522  84.5%  8516 2952s
H 2045  1618                    20615.474061 35167.6522  70.6%  8563 2952s
  2053  1652     cutoff   16      20615.4741 35167.6522  70.6%  8640 2976s
  2155  1709 25703.4824   17  363 20615.4741 35167.6522  70.6%  8705 3002s
* 2241  1709              44    20655.640727 35167.6522  70.3%  8724 3002s
  2264  1777 23421.5178   18  278 20655.6407 35167.6522  70.3%  8813 3025s
  2379  1798 23116.5999   20  325 20655.6407 35167.6522  70.3%  8840 3053s
  2517  1842 22358.7704   22  344 20655.6407 35167.6522  70.3%  8851 3080s
  2697  1932 21694.3475   24  376 20655.6407 35167.6522  70.3%  8755 3106s
  2833  2007 21571.2320   25  367 20655.6407 35167.6522  70.3%  8817 3133s
H 2835  2007                    20661.076964 35167.6522  70.2%  8819 3133s
H 2837  1990                    20814.179223 35167.6522  69.0%  8822 3133s
H 2853  1816                    22046.982894 35167.6522  59.5%  8788 3133s
H 2918  1816                    22665.608888 35167.6522  55.2%  8711 3133s
  2957  1720     cutoff   26      22665.6089 35167.6522  55.2%  8748 3168s
  3061  1736 32106.6779    7  353 22665.6089 35167.6522  55.2%  8775 3203s
  3116  1762 29229.0934   10  346 22665.6089 35167.6522  55.2%  8974 3242s
  3212  1803 25248.4110   12  303 22665.6089 35167.6522  55.2%  9076 3274s
  3343  1786 24009.7534   15  253 22665.6089 35167.6522  55.2%  9111 3310s
  3537  1827     cutoff   17      22665.6089 35167.6522  55.2%  9085 3350s
  3680  1851 30501.2431   13  338 22665.6089 35167.6522  55.2%  9182 3383s
  3726  1897 26788.5130   14  278 22665.6089 35167.6522  55.2%  9299 3417s
H 3734  1812                    22977.352824 35167.6522  53.1%  9302 3417s
  3804  1807 26479.4425   15  324 22977.3528 33628.5585  46.4%  9424 3446s
H 3806  1805                    23000.171276 33628.5585  46.2%  9420 3446s
H 3807  1796                    23028.171445 33628.5585  46.0%  9419 3446s
H 3837  1787                    23050.989897 33628.5585  45.9%  9442 3446s
  3873  1847     cutoff   16      23050.9899 33628.5585  45.9%  9458 3485s
  4019  1863 30857.0422   13  400 23050.9899 33628.5585  45.9%  9622 3528s
H 4029  1812                    23199.864838 33478.3444  44.3%  9655 3528s
  4063  1882 30659.7134   14  367 23199.8648 33478.3444  44.3%  9760 3570s
  4205  1943 24774.7458   17  319 23199.8648 33478.3444  44.3%  9933 3600s

Cutting planes:
  Learned: 1
  Gomory: 18
  Implied bound: 437
  MIR: 3186
  Flow cover: 3360
  RLT: 153
  Relax-and-lift: 843

Explored 4364 nodes (44069883 simplex iterations) in 3600.05 seconds (8052.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23199.9 23051 23028.2 ... 20655.6

Time limit reached
Best objective 2.319986483838e+04, best bound 3.323794552793e+04, gap 43.2678%
  WARNING: Time limit reached. Using best solution found (gap: 43.27%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 23199.86, θ = 171040.84
  Upper Bound (UB) = 23199.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 171040.84
  [DEBUG]   ✓ Scenario 0: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 171040.84 ≤ Q = 171040.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 171040.84 ≤ Q = 171040.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 171040.84 ≤ Q = 171040.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 171040.84 ≤ Q = 171040.84 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 171040.84 ≤ Q = 171040.84 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xa75c8e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xff58a372
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.403473e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.00s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 6442398.0643
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.613530e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -161353.02    0  126 6442398.06 -161353.02   103%     -    0s
H    0     0                    -122517.1916 -161353.02  31.7%     -    0s
H    0     0                    -123532.5313 -161353.02  30.6%     -    0s
H    0     0                    -135574.9132 -137379.84  1.33%     -    0s
     0     0 -137330.46    0   32 -135574.91 -137330.46  1.29%     -    0s
H    0     0                    -135963.4313 -137319.83  1.00%     -    0s
H    0     0                    -136320.5672 -137319.83  0.73%     -    0s
     0     0 -137181.33    0   25 -136320.57 -137181.33  0.63%     -    0s
H    0     0                    -136583.2301 -137042.58  0.34%     -    0s
H    0     0                    -137036.3538 -137042.58  0.00%     -    0s
     0     0 -137042.58    0    3 -137036.35 -137042.58  0.00%     -    0s
     0     0 -137038.80    0    2 -137036.35 -137038.80  0.00%     -    0s

Cutting planes:
  Gomory: 14
  MIR: 112
  Flow cover: 1
  RLT: 39
  Relax-and-lift: 1
  BQP: 5

Explored 1 nodes (419 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -137036 -136583 -136321 ... 1.40347e+13
No other solutions better than -137036

Optimal solution found (tolerance 1.00e-06)
Best objective -1.370363538102e+05, best bound -1.370363538102e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 161386.06
  Scenario: 11 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -137036.35
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -137036.35 = 161386.06
  [DEBUG]   Current θ from Master = 171040.84
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9654.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13545.08
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = -578.6126, Absolute Gap = 578.6126, Relative Gap = -0.024940
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 23199.86, LB = 23778.48, Gap = -578.61
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 11 increases, 48 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653894 nonzeros
Model fingerprint: 0x50771d41
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [2e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 109240 rows and 44360 columns
Presolve time: 1.97s
Presolved: 121493 rows, 51500 columns, 750807 nonzeros
Variable types: 49241 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -309974.6584
Found heuristic solution: objective -217654.3735

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 Dense cols : 576
 AA' NZ     : 6.156e+06
 Factor NZ  : 1.344e+07 (roughly 180 MB of memory)
 Factor Ops : 2.889e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.87085049e+07  2.09260255e+08  1.24e+05 1.71e+01  8.11e+04     3s
   1  -1.38465702e+07  1.90892175e+08  8.41e+04 8.32e+01  5.46e+04     3s
   2  -4.26854291e+06  1.49202109e+08  2.55e+04 5.43e-01  1.76e+04     4s
   3  -1.13185122e+06  1.06814921e+08  3.93e+03 1.40e+00  3.03e+03     4s
   4  -5.50221476e+05  6.61718978e+07  5.56e+02 3.79e-01  6.34e+02     4s
   5  -4.70487611e+05  3.55615886e+07  3.02e+02 1.63e-01  3.23e+02     4s
   6  -3.79142876e+05  2.54214906e+07  1.16e+02 1.07e-01  1.73e+02     4s
   7  -2.85038666e+05  1.93193390e+07  3.25e+01 7.73e-02  1.03e+02     4s
   8  -1.92370431e+05  1.18764560e+07  1.16e+01 4.69e-02  5.82e+01     4s
   9  -1.53854710e+05  7.81589189e+06  7.58e+00 2.99e-02  3.77e+01     4s
  10  -1.16833806e+05  3.27191652e+06  4.37e+00 1.15e-02  1.57e+01     4s
  11  -7.69763841e+04  8.91838974e+05  1.63e+00 2.88e-03  4.43e+00     4s
  12  -3.47923411e+04  3.49173254e+05  6.48e-01 1.29e-03  1.74e+00     4s
  13  -1.28724277e+04  2.45485376e+05  4.12e-01 9.23e-04  1.17e+00     4s
  14  -3.13371550e+03  1.84774488e+05  3.33e-01 1.40e-03  8.51e-01     4s
  15   2.40790063e+03  1.48862836e+05  2.89e-01 1.72e-03  6.64e-01     4s
  16   1.43012177e+04  1.11382982e+05  2.08e-01 2.17e-03  4.40e-01     4s
  17   2.14384091e+04  9.31454841e+04  1.59e-01 1.91e-03  3.25e-01     4s
  18   2.39635008e+04  8.45932011e+04  1.42e-01 1.55e-03  2.75e-01     4s
  19   3.00907447e+04  7.52548565e+04  1.04e-01 1.38e-03  2.05e-01     4s
  20   3.47625350e+04  6.81042627e+04  7.65e-02 1.39e-03  1.51e-01     4s
  21   3.71916632e+04  6.17895393e+04  6.32e-02 1.78e-03  1.12e-01     4s
  22   3.92915139e+04  5.95388264e+04  5.19e-02 1.37e-03  9.18e-02     4s
  23   4.04220409e+04  5.84836416e+04  4.62e-02 1.34e-03  8.19e-02     5s
  24   4.20436754e+04  5.74973566e+04  3.78e-02 1.27e-03  7.00e-02     5s
  25   4.40529197e+04  5.56329661e+04  2.79e-02 1.13e-03  5.25e-02     5s
  26   4.52423044e+04  5.38896765e+04  2.22e-02 2.25e-03  3.92e-02     5s
  27   4.67492408e+04  5.28932621e+04  1.51e-02 1.31e-03  2.78e-02     5s
  28   4.74531010e+04  5.17504805e+04  1.19e-02 1.40e-03  1.95e-02     5s
  29   4.84165619e+04  5.12641033e+04  7.74e-03 9.11e-04  1.29e-02     5s
  30   4.89602261e+04  5.07912479e+04  5.39e-03 8.13e-04  8.31e-03     5s
  31   4.91394680e+04  5.06915856e+04  4.61e-03 6.58e-04  7.04e-03     5s
  32   4.92780529e+04  5.06604021e+04  4.03e-03 6.08e-04  6.27e-03     5s
  33   4.95985125e+04  5.05588157e+04  2.64e-03 4.54e-04  4.36e-03     5s
  34   4.97300467e+04  5.04565672e+04  2.08e-03 3.02e-04  3.30e-03     5s
  35   4.99828676e+04  5.04012617e+04  1.01e-03 2.20e-04  1.90e-03     5s
  36   5.00463573e+04  5.03717083e+04  7.51e-04 1.77e-04  1.47e-03     5s
  37   5.00550221e+04  5.03310226e+04  7.13e-04 1.20e-04  1.25e-03     5s
  38   5.01070959e+04  5.03152983e+04  5.11e-04 9.72e-05  9.44e-04     5s
  39   5.01718018e+04  5.02726779e+04  2.51e-04 3.25e-05  4.57e-04     5s
  40   5.01745033e+04  5.02694379e+04  2.41e-04 2.87e-05  4.30e-04     5s
  41   5.02237870e+04  5.02659002e+04  6.86e-05 2.43e-05  1.90e-04     6s
  42   5.02321564e+04  5.02534220e+04  4.13e-05 9.00e-06  9.63e-05     6s
  43   5.02424056e+04  5.02506770e+04  7.33e-06 5.71e-06  3.73e-05     6s
  44   5.02438441e+04  5.02466680e+04  3.74e-06 1.17e-06  1.28e-05     6s
  45   5.02443211e+04  5.02466121e+04  2.72e-06 1.14e-06  1.04e-05     6s
  46   5.02444225e+04  5.02462117e+04  2.49e-06 6.67e-07  8.10e-06     6s
  47   5.02445393e+04  5.02461383e+04  2.24e-06 3.83e-06  7.23e-06     6s
  48   5.02447331e+04  5.02460074e+04  1.82e-06 9.53e-06  5.77e-06     6s
  49   5.02453408e+04  5.02456155e+04  5.24e-07 3.18e-07  1.25e-06     6s
  50   5.02455899e+04  5.02455902e+04  2.68e-09 1.25e-07  1.25e-09     6s

Barrier solved model in 50 iterations and 6.14 seconds (11.83 work units)
Optimal objective 5.02455899e+04


Root crossover log...

  105628 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    9539 PPushes remaining with PInf 6.5063272e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.4903483e+03     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   61071    5.0245590e+04   0.000000e+00   1.490348e+03     10s
   61155    5.0245590e+04   0.000000e+00   0.000000e+00     11s
   61155    5.0245590e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 1.57s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.024559e+04, 61155 iterations, 9.66 seconds (20.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50245.5901    0  201 -217654.37 50245.5901   123%     -   12s
H    0     0                    -138873.2085 50245.5901   136%     -   13s
H    0     0                    -138865.6949 50245.5901   136%     -   13s
H    0     0                    -138831.9032 50245.5901   136%     -   13s
H    0     0                    -138806.0897 50245.5901   136%     -   13s
H    0     0                    -95728.47925 50245.5901   152%     -   13s
H    0     0                    -95356.12722 50245.5901   153%     -   13s
H    0     0                    2697.6081027 50245.5901  1763%     -   13s
H    0     0                    4714.9814796 50245.5901   966%     -   14s
H    0     0                    4926.8409403 50245.5901   920%     -   14s
H    0     0                    5081.7014767 50245.5901   889%     -   14s
H    0     0                    5906.4284857 44643.4656   656%     -   39s
H    0     0                    6584.0700453 44643.4656   578%     -   39s
H    0     0                    6747.2174609 44643.4656   562%     -   39s
     0     0 44620.6762    0  260 6747.21746 44620.6762   561%     -   39s
     0     0 44171.0401    0  270 6747.21746 44171.0401   555%     -   54s
     0     0 44067.4795    0  269 6747.21746 44067.4795   553%     -   60s
     0     0 44027.4287    0  272 6747.21746 44027.4287   553%     -   61s
     0     0 44026.2403    0  272 6747.21746 44026.2403   553%     -   62s
     0     0 44025.7384    0  273 6747.21746 44025.7384   553%     -   63s
     0     0 44019.5489    0  271 6747.21746 44019.5489   552%     -   64s
     0     0 44019.5160    0  273 6747.21746 44019.5160   552%     -   65s
     0     0 44019.5160    0  273 6747.21746 44019.5160   552%     -   66s
H    0     0                    6799.6326555 41373.4800   508%     -  102s
H    0     0                    7187.8613671 41373.4800   476%     -  102s
H    0     0                    7195.2175162 41373.4800   475%     -  102s
H    0     0                    7244.5330920 41373.4800   471%     -  102s
H    0     0                    7314.3096755 41373.4800   466%     -  102s
H    0     0                    7431.6549212 41373.4800   457%     -  102s
H    0     0                    7495.3705302 41373.4800   452%     -  102s
H    0     0                    7499.5343899 41373.4800   452%     -  102s
H    0     0                    7617.7958157 41373.4800   443%     -  102s
     0     0 41373.4800    0  310 7617.79582 41373.4800   443%     -  102s
H    0     0                    11851.317745 41373.3745   249%     -  102s
     0     0 40742.5893    0  339 11851.3177 40742.5893   244%     -  115s
     0     0 40482.6814    0  334 11851.3177 40482.6814   242%     -  126s
     0     0 40367.9353    0  353 11851.3177 40367.9353   241%     -  137s
     0     0 40278.9834    0  346 11851.3177 40278.9834   240%     -  146s
     0     0 40267.4061    0  352 11851.3177 40267.4061   240%     -  149s
     0     0 40245.7407    0  341 11851.3177 40245.7407   240%     -  153s
     0     0 40223.2911    0  355 11851.3177 40223.2911   239%     -  156s
     0     0 40213.2857    0  355 11851.3177 40213.2857   239%     -  159s
     0     0 40189.0485    0  366 11851.3177 40189.0485   239%     -  163s
     0     0 40186.8994    0  367 11851.3177 40186.8994   239%     -  165s
     0     0 40186.3472    0  369 11851.3177 40186.3472   239%     -  166s
     0     0 38793.5175    0  387 11851.3177 38793.5175   227%     -  210s
H    0     0                    11877.113736 38793.2909   227%     -  210s
H    0     0                    11988.781993 38793.2909   224%     -  210s
H    0     0                    12142.765932 38793.2909   219%     -  211s
     0     0 38373.4872    0  397 12142.7659 38373.4872   216%     -  229s
     0     0 38291.9955    0  423 12142.7659 38291.9955   215%     -  239s
     0     0 38220.6100    0  384 12142.7659 38220.6100   215%     -  245s
     0     0 38186.7642    0  434 12142.7659 38186.7642   214%     -  251s
     0     0 38156.0290    0  438 12142.7659 38156.0290   214%     -  255s
     0     0 38143.2479    0  428 12142.7659 38143.2479   214%     -  257s
     0     0 38082.4676    0  430 12142.7659 38082.4676   214%     -  260s
H    0     0                    12471.829522 38071.0735   205%     -  264s
     0     0 38071.0735    0  432 12471.8295 38071.0735   205%     -  264s
H    0     0                    12494.647974 38065.4559   205%     -  267s
     0     0 38065.4559    0  439 12494.6480 38065.4559   205%     -  267s
     0     0 38050.4022    0  392 12494.6480 38050.4022   205%     -  271s
     0     0 38044.1099    0  393 12494.6480 38044.1099   204%     -  272s
     0     0 38036.3280    0  396 12494.6480 38036.3280   204%     -  273s
     0     0 38034.2125    0  398 12494.6480 38034.2125   204%     -  275s
     0     0 38018.9092    0  441 12494.6480 38018.9092   204%     -  277s
     0     0 38004.6411    0  433 12494.6480 38004.6411   204%     -  280s
H    0     0                    12553.687151 37982.5485   203%     -  283s
     0     0 37982.5485    0  443 12553.6872 37982.5485   203%     -  283s
     0     0 37961.7960    0  436 12553.6872 37961.7960   202%     -  286s
     0     0 37959.2476    0  445 12553.6872 37959.2476   202%     -  288s
     0     0 37957.6215    0  444 12553.6872 37957.6215   202%     -  289s
     0     0 37952.9696    0  446 12553.6872 37952.9696   202%     -  290s
     0     0 37951.6558    0  448 12553.6872 37951.6558   202%     -  291s
     0     0 37034.3949    0  428 12553.6872 37034.3949   195%     -  312s
H    0     0                    12700.562045 37026.8679   192%     -  312s
     0     0 36819.8275    0  407 12700.5620 36819.8275   190%     -  320s
     0     0 36651.0296    0  446 12700.5620 36651.0296   189%     -  328s
     0     0 36603.2297    0  445 12700.5620 36603.2297   188%     -  333s
     0     0 36581.7681    0  450 12700.5620 36581.7681   188%     -  336s
     0     0 36572.6307    0  449 12700.5620 36572.6307   188%     -  339s
     0     0 36565.6290    0  452 12700.5620 36565.6290   188%     -  341s
     0     0 36555.9273    0  455 12700.5620 36555.9273   188%     -  343s
     0     0 36553.9080    0  457 12700.5620 36553.9080   188%     -  344s
     0     0 36531.5077    0  459 12700.5620 36531.5077   188%     -  347s
     0     0 36530.1461    0  461 12700.5620 36530.1461   188%     -  349s
     0     0 36417.2598    0  421 12700.5620 36417.2598   187%     -  357s
     0     0 36351.1706    0  464 12700.5620 36351.1706   186%     -  363s
     0     0 36332.2659    0  429 12700.5620 36332.2659   186%     -  365s
     0     0 36324.6441    0  472 12700.5620 36324.6441   186%     -  368s
     0     0 36317.1312    0  431 12700.5620 36317.1312   186%     -  370s
     0     0 36315.2357    0  467 12700.5620 36315.2357   186%     -  371s
     0     0 36314.4664    0  466 12700.5620 36314.4664   186%     -  371s
     0     0 36172.7538    0  458 12700.5620 36172.7538   185%     -  379s
H    0     0                    14018.799210 36172.4497   158%     -  388s
H    0     0                    14176.053686 36172.4497   155%     -  388s
H    0     0                    14666.284277 36172.4497   147%     -  389s
     0     0 36145.2155    0  467 14666.2843 36145.2155   146%     -  392s
     0     0 36137.9954    0  467 14666.2843 36137.9954   146%     -  394s
     0     0 36129.5714    0  461 14666.2843 36129.5714   146%     -  396s
     0     0 36122.4921    0  459 14666.2843 36122.4921   146%     -  397s
     0     0 36119.8136    0  461 14666.2843 36119.8136   146%     -  398s
     0     0 36116.5764    0  460 14666.2843 36116.5764   146%     -  399s
     0     0 36113.4349    0  461 14666.2843 36113.4349   146%     -  400s
     0     0 36111.1040    0  477 14666.2843 36111.1040   146%     -  401s
     0     0 36110.0936    0  469 14666.2843 36110.0936   146%     -  402s
     0     0 36066.4473    0  470 14666.2843 36066.4473   146%     -  407s
H    0     0                    15132.848081 36065.9978   138%     -  408s
H    0     0                    15162.640196 36065.9978   138%     -  408s
     0     0 36062.3667    0  476 15162.6402 36062.3667   138%     -  410s
     0     0 36058.8501    0  472 15162.6402 36058.8501   138%     -  412s
     0     0 36056.1914    0  466 15162.6402 36056.1914   138%     -  414s
     0     0 36055.4273    0  470 15162.6402 36055.4273   138%     -  415s
     0     0 36004.5361    0  445 15162.6402 36004.5361   137%     -  423s
H    0     0                    15210.351701 36004.2724   137%     -  425s
H    0     0                    15292.438921 36004.2724   135%     -  425s
     0     0 35999.6424    0  447 15292.4389 35999.6424   135%     -  428s
     0     0 35997.7487    0  447 15292.4389 35997.7487   135%     -  428s
     0     0 35990.6291    0  457 15292.4389 35990.6291   135%     -  429s
     0     0 35990.2222    0  459 15292.4389 35990.2222   135%     -  429s
     0     0 35979.4641    0  484 15292.4389 35979.4641   135%     -  434s
     0     0 35976.3692    0  443 15292.4389 35976.3692   135%     -  436s
     0     0 35975.3143    0  441 15292.4389 35975.3143   135%     -  438s
     0     0 35956.8800    0  436 15292.4389 35956.8800   135%     -  443s
     0     0 35955.5786    0  445 15292.4389 35955.5786   135%     -  445s
     0     0 35917.3465    0  442 15292.4389 35917.3465   135%     -  450s
H    0     0                    15341.718458 35915.6634   134%     -  451s
     0     0 35902.3755    0  444 15341.7185 35902.3755   134%     -  453s
     0     0 35899.7154    0  445 15341.7185 35899.7154   134%     -  454s
     0     0 35898.2567    0  448 15341.7185 35898.2567   134%     -  456s
     0     0 35893.0469    0  446 15341.7185 35893.0469   134%     -  459s
H    0     0                    15454.378058 35890.6264   132%     -  469s
     0     0 35890.6264    0  452 15454.3781 35890.6264   132%     -  473s
     0     0 35879.7489    0  435 15454.3781 35879.7489   132%     -  477s
     0     0 35868.1330    0  445 15454.3781 35868.1330   132%     -  479s
     0     0 35861.5283    0  449 15454.3781 35861.5283   132%     -  481s
     0     0 35848.2140    0  446 15454.3781 35848.2140   132%     -  485s
     0     0 35836.7162    0  497 15454.3781 35836.7162   132%     -  487s
     0     0 35835.1133    0  500 15454.3781 35835.1133   132%     -  488s
     0     0 35809.8426    0  443 15454.3781 35809.8426   132%     -  492s
     0     0 35801.1121    0  494 15454.3781 35801.1121   132%     -  494s
     0     0 35799.9154    0  449 15454.3781 35799.9154   132%     -  496s
     0     0 35736.0704    0  454 15454.3781 35736.0704   131%     -  501s
     0     0 35727.2632    0  449 15454.3781 35727.2632   131%     -  504s
     0     0 35720.3500    0  452 15454.3781 35720.3500   131%     -  506s
     0     0 35714.4367    0  453 15454.3781 35714.4367   131%     -  507s
     0     0 35709.3105    0  456 15454.3781 35709.3105   131%     -  508s
     0     0 35705.2157    0  450 15454.3781 35705.2157   131%     -  509s
     0     0 35703.6718    0  451 15454.3781 35703.6718   131%     -  510s
     0     0 35685.2796    0  452 15454.3781 35685.2796   131%     -  513s
     0     0 35683.3806    0  460 15454.3781 35683.3806   131%     -  514s
     0     0 35682.9464    0  463 15454.3781 35682.9464   131%     -  514s
     0     0 35676.8032    0  460 15454.3781 35676.8032   131%     -  516s
     0     0 35675.0827    0  461 15454.3781 35675.0827   131%     -  517s
     0     0 35656.2268    0  449 15454.3781 35656.2268   131%     -  521s
     0     0 35649.9038    0  467 15454.3781 35649.9038   131%     -  522s
     0     0 35648.6288    0  467 15454.3781 35648.6288   131%     -  523s
     0     0 35640.6625    0  465 15454.3781 35640.6625   131%     -  526s
     0     0 35639.9096    0  464 15454.3781 35639.9096   131%     -  527s
     0     0 35635.7231    0  468 15454.3781 35635.7231   131%     -  529s
     0     0 35635.5922    0  468 15454.3781 35635.5922   131%     -  532s
     0     2 35635.5169    0  468 15454.3781 35635.5169   131%     -  638s
     1     4 35592.0495    1  438 15454.3781 35633.3802   131%  5042  641s
     3     6 34709.0330    2  445 15454.3781 35600.4364   130% 10377  660s
     5     8 35114.7659    2  446 15454.3781 35592.0389   130% 10275  668s
     7    15 35263.3973    3  480 15454.3781 35458.0673   129%  9951  680s
    14    30 35062.4684    4  410 15454.3781 35352.3291   129% 11360  693s
    29    45 34719.2321    5  466 15454.3781 35106.0731   127% 15654  722s
    44    77 33025.6586    6  417 15454.3781 35106.0731   127% 18219  831s
H   55    77                    15512.713230 35106.0731   126% 16851  831s
    76   192 32940.2786    7  402 15512.7132 35033.1398   126% 16713  855s
   191   223 32704.1456   10  353 15512.7132 35032.5048   126% 10564  894s
   222   251 32785.7624   11  440 15512.7132 35032.5048   126% 10021  909s
   250   286 32689.2601   11  382 15512.7132 35032.5048   126%  9761  922s
H  253   286                    17612.335353 35032.5048  98.9%  9718  922s
H  255   286                    20396.985884 35032.5048  71.8%  9678  922s
   285   318 32584.7034   12  443 20396.9859 35032.5048  71.8%  9396  935s
H  311   318                    21385.660645 35032.5048  63.8%  9179  935s
   317   348 32728.6999   11  348 21385.6606 35032.5048  63.8%  9159  951s
   347   385 32379.6641   13  427 21385.6606 35032.5048  63.8%  8848  966s
H  352   385                    22757.446609 35032.5048  53.9%  8790  966s
   384   458 32219.2194   14  393 22757.4466 35032.5048  53.9%  8572  984s
   457   489 31933.4143   16  392 22757.4466 35032.5048  53.9%  7965  999s
H  476   489                    22869.850190 35032.5048  53.2%  7838  999s
   488   571 31505.3231   16  341 22869.8502 35032.5048  53.2%  7734 1016s
   570   632 31875.5312   17  378 22869.8502 35032.5048  53.2%  7148 1033s
   631   683 32284.3405   15  368 22869.8502 35032.5048  53.2%  6845 1049s
   686   722 31689.5584   18  382 22869.8502 35032.5048  53.2%  6652 1071s
   731   751 30317.3475   19  418 22869.8502 35032.5048  53.2%  6619 1091s
   769   780 30281.4285   20  403 22869.8502 35032.5048  53.2%  6621 1113s
   812   801 28899.9093   22  298 22869.8502 35032.5048  53.2%  6586 1129s
H  829   801                    22936.309894 35032.5048  52.7%  6565 1129s
   839   841 28813.7203   23  298 22936.3099 35032.5048  52.7%  6584 1151s
   895   856 28314.0921   25  314 22936.3099 35032.5048  52.7%  6457 1170s
H  922   856                    22937.858007 35032.5048  52.7%  6449 1170s
   928   895 27904.3630   25  276 22937.8580 35032.5048  52.7%  6467 1188s
   995   920 28210.0148   26  299 22937.8580 35032.5048  52.7%  6306 1204s
H  999   920                    23000.797649 35032.5048  52.3%  6304 1204s
H 1017   920                    23083.967917 35032.5048  51.8%  6241 1204s
  1043   959 27971.0737   27  300 23083.9679 35032.5048  51.8%  6191 1229s
  1136  1012     cutoff   28      23083.9679 35032.5048  51.8%  6000 1250s
  1240  1034 26929.8096   29  284 23083.9679 35032.5048  51.8%  5785 1273s
  1315  1082 26536.0715   30  273 23083.9679 35032.5048  51.8%  5742 1299s
  1385  1107 26524.2409   31  276 23083.9679 35032.5048  51.8%  5707 1320s
H 1388  1107                    23232.487841 35032.5048  50.8%  5713 1320s
H 1420  1162                    23254.627719 35032.5048  50.6%  5764 1344s
H 1489  1162                    23257.595514 35032.5048  50.6%  5661 1344s
  1511  1233 25991.9492   34  232 23257.5955 35032.5048  50.6%  5656 1371s
  1614  1304 25227.0452   35  265 23257.5955 35032.5048  50.6%  5588 1396s
  1718  1358 24970.9166   37  223 23257.5955 34854.8117  49.9%  5561 1425s
  1811  1438 24655.7746   40  203 23257.5955 34854.8117  49.9%  5585 1454s
  1917  1560 24186.5820   46  184 23257.5955 34854.8117  49.9%  5568 1484s
  2065  1686 23673.8872   53  166 23257.5955 34854.8117  49.9%  5446 1512s
  2243  1809 26458.8751   17  151 23257.5955 34854.8117  49.9%  5284 1543s
  2450  1830 25465.6057   31   75 23257.5955 34854.8117  49.9%  5097 1574s
  2640  1855 23319.7291   43   28 23257.5955 34718.8427  49.3%  4979 1606s
H 2717  1855                    23263.031751 34718.7267  49.2%  5021 1606s
  2751  1884 31888.0078    6  360 23263.0318 34718.7267  49.2%  5011 1642s
  2849  1931 30148.3063    7  300 23263.0318 34718.7267  49.2%  5069 1679s
  2936  1986 28904.6573    9  333 23263.0318 34718.7267  49.2%  5146 1718s
  3039  2019 28278.5258   12  314 23263.0318 34718.7267  49.2%  5220 1758s
  3159  2044 27267.4145   15  309 23263.0318 34061.1257  46.4%  5283 1795s
H 3169  1967                    23673.787638 33944.7679  43.4%  5283 1795s
  3229  2024 26985.6272   16  309 23673.7876 33883.3265  43.1%  5315 1837s
  3350  2079 26011.8419   26  243 23673.7876 33880.3129  43.1%  5360 1879s
H 3361  2069                    23726.655223 33880.3129  42.8%  5350 1879s
H 3428  2039                    23844.874597 33880.3129  42.1%  5413 1879s
  3447  2143 24840.1428   37  212 23844.8746 33880.3129  42.1%  5427 1923s
  3620  2164 infeasible   42      23844.8746 33871.2466  42.0%  5428 1956s
H 3637  2158                    23872.825004 33581.8433  40.7%  5429 1956s
H 3639  2129                    23962.344693 33581.8433  40.1%  5430 1956s
  3678  2244 32054.9446   10  357 23962.3447 33581.8433  40.1%  5451 2008s
  3856  2265 29985.1271   11  305 23962.3447 33556.1841  40.0%  5441 2049s
  3898  2322 29611.8978   12  301 23962.3447 33488.9515  39.8%  5462 2088s
H 3899  2322                    23965.434875 33488.9515  39.7%  5460 2088s
  3996  2458 27296.7492   13  313 23965.4349 33488.9515  39.7%  5438 2140s
  4214  2459 29525.2824   16  468 23965.4349 33488.9515  39.7%  5421 2385s
  4216  2460 32223.5306   20  221 23965.4349 33488.9515  39.7%  5419 2399s
  4217  2461 31129.0021   17  368 23965.4349 33488.9515  39.7%  5417 2469s
  4218  2462 25756.9520   21  445 23965.4349 33488.9515  39.7%  5416 2540s
  4219  2462 30857.7089   19  445 23965.4349 33488.9515  39.7%  5415 2579s
  4220  2463 29670.5921   16  480 23965.4349 33488.9515  39.7%  5413 2596s
  4221  2464 30478.0301   12  469 23965.4349 33488.9515  39.7%  5412 2611s
  4222  2464 29899.9695   14  472 23965.4349 33488.9515  39.7%  5411 2622s
  4223  2465 28792.9820   18  425 23965.4349 33488.9515  39.7%  5410 2629s
  4224  2466 33184.8109   18  481 23965.4349 33488.9515  39.7%  5408 2636s
  4225  2466 24900.3072   41  471 23965.4349 33488.9515  39.7%  5407 2646s
  4226  2467 27368.0146   14  506 23965.4349 33488.9515  39.7%  5406 2652s
  4227  2468 29363.5152   15  503 23965.4349 33488.9515  39.7%  5404 2659s
  4228  2468 30187.6370   13  499 23965.4349 33488.9515  39.7%  5403 2664s
  4229  2469 25153.1089   28  484 23965.4349 33488.9515  39.7%  5402 2666s
  4230  2470 25599.2760   22  489 23965.4349 33488.9515  39.7%  5401 2672s
  4231  2470 29653.8034   13  497 23965.4349 33488.9515  39.7%  5399 2694s
  4232  2471 28388.1097   26  456 23965.4349 33488.9515  39.7%  5398 2705s
  4234  2472 32003.8463   14  455 23965.4349 33488.9515  39.7%  5395 2712s
  4235  2473 29104.7819   14  444 23965.4349 33488.9515  39.7%  5394 2717s
  4236  2474 27265.1042   19  444 23965.4349 33488.9515  39.7%  5393 2722s
  4237  2474 31577.8494    8  513 23965.4349 33488.9515  39.7%  5392 2738s
  4238  2475 30077.8268    8  453 23965.4349 33488.9515  39.7%  5390 2743s
  4239  2476 31157.0834   12  496 23965.4349 33488.9515  39.7%  5389 2746s
  4240  2476 28020.5019   37  504 23965.4349 33488.9515  39.7%  5388 2751s
  4241  2477 30538.7055   13  504 23965.4349 33488.9515  39.7%  5387 2766s
  4243  2478 31455.6079   13  505 23965.4349 33488.9515  39.7%  5384 2775s
  4244  2479 28278.1758   13  463 23965.4349 33488.9515  39.7%  5383 2785s
  4246  2480 27347.5101   22  472 23965.4349 33488.9515  39.7%  5380 2793s
  4247  2481 25958.5375   30  477 23965.4349 33488.9515  39.7%  5379 2824s
  4248  2482 26495.9207   15  537 23965.4349 33488.9515  39.7%  5378 2831s
  4249  2482 26770.0290   34  467 23965.4349 33488.9515  39.7%  5376 2838s
  4250  2483 25264.7576   25  497 23965.4349 33488.9515  39.7%  5375 2842s
  4251  2484 24339.8673   33  472 23965.4349 33488.9515  39.7%  5374 2848s
  4252  2484 24488.4891   15  473 23965.4349 33488.9515  39.7%  5373 2857s
  4253  2485 25300.4405   45  481 23965.4349 33488.9515  39.7%  5371 2862s
  4254  2486 28910.4935   22  532 23965.4349 33488.9515  39.7%  5370 2871s
  4255  2486 28373.9528   27  526 23965.4349 33488.9515  39.7%  5369 2876s
  4256  2487 32649.3974    5  524 23965.4349 33488.9515  39.7%  5368 2884s
  4257  2488 32134.0726   13  524 23965.4349 33488.9515  39.7%  5366 2902s
  4258  2488 32224.9928   33  524 23965.4349 33488.9515  39.7%  5365 2994s
  4259  2491 33488.9515   13  455 23965.4349 33488.9515  39.7%  5455 3022s
  4260  2494 33488.9515   14  470 23965.4349 33488.9515  39.7%  5457 3064s
  4263  2499 33180.6258   15  407 23965.4349 33488.9515  39.7%  5460 3120s
  4269  2509 32882.5405   16  445 23965.4349 33488.9515  39.7%  5486 3158s
  4281  2517 32377.8947   16  431 23965.4349 33488.9515  39.7%  5539 3206s
  4293  2545 31907.9492   17  450 23965.4349 33488.9515  39.7%  5616 3316s
  4325  2629 30538.0596   18  431 23965.4349 33488.9515  39.7%  5770 3376s
  4420  2651 30238.9871   21  417 23965.4349 33488.9515  39.7%  6088 3413s
  4475  2676 28428.0226   22  335 23965.4349 33488.9515  39.7%  6171 3446s
  4525  2689 29235.2953   21  311 23965.4349 33488.9515  39.7%  6277 3483s
  4567  2695 25260.5279   23  271 23965.4349 33488.9515  39.7%  6327 3516s
  4612  2693 29287.0553   22  429 23965.4349 33488.9515  39.7%  6418 3558s
  4646  2695 29045.6889   22  356 23965.4349 33488.9515  39.7%  6530 3600s

Cutting planes:
  Learned: 1
  Implied bound: 2
  Projected implied bound: 89
  MIR: 1424
  Flow cover: 2711
  Zero half: 1
  RLT: 24
  Relax-and-lift: 294

Explored 4688 nodes (31698962 simplex iterations) in 3600.10 seconds (9284.67 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 23965.4 23962.3 23872.8 ... 23232.5

Time limit reached
Best objective 2.396543487466e+04, best bound 3.348895151009e+04, gap 39.7386%
  WARNING: Time limit reached. Using best solution found (gap: 39.74%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 23965.43, θ = 170638.28
  Upper Bound (UB) = 23965.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 170638.28
  [DEBUG]   ✓ Scenario 0: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 170638.28 ≤ Q = 170638.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 170638.28 ≤ Q = 170638.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 170638.28 ≤ Q = 170638.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 170638.28 ≤ Q = 170638.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 170638.28 ≤ Q = 170638.28 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 170638.28 ≤ Q = 170638.28 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x420f53a2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbdf0ac5e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [6e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.408742e+13
Presolve removed 2613 rows and 1904 columns
Presolve time: 0.01s
Presolved: 480 rows, 485 columns, 1318 nonzeros
Found heuristic solution: objective 6468730.9412
Variable types: 329 continuous, 156 integer (156 binary)

Root relaxation: objective -1.594913e+05, 229 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -159491.30    0  121 6468730.94 -159491.30   102%     -    0s
H    0     0                    -125951.6566 -159491.30  26.6%     -    0s
H    0     0                    -126413.8933 -159491.30  26.2%     -    0s
     0     0 -136861.53    0   58 -126413.89 -136861.53  8.26%     -    0s
H    0     0                    -136186.5209 -136846.25  0.48%     -    0s
H    0     0                    -136292.1932 -136846.25  0.41%     -    0s
     0     0 -136581.32    0   22 -136292.19 -136581.32  0.21%     -    0s
     0     0 -136526.15    0    2 -136292.19 -136526.15  0.17%     -    0s
H    0     0                    -136511.3193 -136526.05  0.01%     -    0s
H    0     0                    -136514.2231 -136526.05  0.01%     -    0s

Explored 1 nodes (424 simplex iterations) in 0.06 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -136526 -136514 -136423 ... 1.40874e+13
No other solutions better than -136526

Optimal solution found (tolerance 1.00e-06)
Best objective -1.365260462131e+05, best bound -1.365260462131e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 161896.37
  Scenario: 14 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136526.05
  [DEBUG]   S×d_nominal = 298422.41
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 298422.41 + -136526.05 = 161896.37
  [DEBUG]   Current θ from Master = 170638.28
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8741.91 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15223.52
  Lower Bound (LB) = 23778.48
  Gap (UB-LB) = 186.9574, Absolute Gap = 186.9574, Relative Gap = 0.007801
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 15
Total Time: 32876.44s
Converged: True
Final Lower Bound: 23778.4775
Final Upper Bound: 23965.4349
Final Gap: 186.957410
Number of Critical Scenarios: 15
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [3, 4, 5, 6] (4/10)
Active Routes (Plant→DC): 10
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 0 customers  Mode 2: 50 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 15
Start Time: 2026-01-03 10:17:46
End Time: 2026-01-03 19:25:43
Total Time: 32876.44s
Optimal Value: 23778.48
Lower Bound: 23778.48
Upper Bound: 23965.43
Gap: 186.957410
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [3, 4, 5, 6] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed19_HD_gamma20_20260103_192543.csv

Total Execution Time: 32877.39 seconds
End Time: 2026-01-03 19:25:44

All tasks completed successfully!

