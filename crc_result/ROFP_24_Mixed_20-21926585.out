
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 24
DI Scenario: Mixed
Start Time: 2026-01-03 12:05:01
================================================================================
Loading data from data/DH_data_full_seed24.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
  Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
  Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=993, max=1652
  DC capacity (MC): min=447, max=853

Demand Structure (s_rk matrix):
  Total customer-product pairs: 87/150 (42.0% sparse)
  Average products per customer: 1.74

Demand (only non-zero entries):
  Nominal (μ): min=8.28, max=34.89, count=87
  Deviation (μ̂): min=4.03, max=9.95

Costs:
  Plant fixed cost: min=5996, max=9615
  DC fixed cost: min=3150, max=5670
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.499', '2.248'] (k=0.999)
    Product 2: ['1.000', '1.406', '1.976'] (k=0.840)
  MD:
    Product 0: ['1.000', '1.251', '1.565'] (k=0.553)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.267', '1.606'] (k=0.584)
  LD:
    Product 0: ['1.000', '1.019', '1.038'] (k=0.045)
    Product 1: ['1.000', '1.001', '1.001'] (k=0.001)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
  Mixed:
    Product 0: ['1.000', '1.430', '2.046'] (k=0.883)
    Product 1: ['1.000', '1.241', '1.541'] (k=0.533)
    Product 2: ['1.000', '1.020', '1.041'] (k=0.050)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48771 nonzeros
Model fingerprint: 0xc91219e9
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11584 rows and 2584 columns
Presolve time: 0.08s
Presolved: 5089 rows, 5916 columns, 35258 nonzeros
Variable types: 3657 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -292401.0271
Found heuristic solution: objective -195802.1610

Root relaxation: objective 1.140142e+05, 5330 iterations, 0.21 seconds (0.37 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 114014.189    0  497 -195802.16 114014.189   158%     -    0s
H    0     0                    -190773.4392 114014.189   160%     -    0s
     0     0 102216.038    0  811 -190773.44 102216.038   154%     -    1s
H    0     0                    -188142.9364 101851.440   154%     -    1s
     0     0 101851.440    0  820 -188142.94 101851.440   154%     -    1s
     0     0 101839.153    0  830 -188142.94 101839.153   154%     -    1s
     0     0 101838.659    0  832 -188142.94 101838.659   154%     -    1s
H    0     0                    -169973.7486 101838.659   160%     -    1s
H    0     0                    -146622.5362 95470.7292   165%     -    2s
H    0     0                    -146060.1775 95470.7292   165%     -    2s
     0     0 95470.7292    0  932 -146060.18 95470.7292   165%     -    2s
     0     0 95211.0143    0  931 -146060.18 95211.0143   165%     -    2s
     0     0 95186.5912    0  931 -146060.18 95186.5912   165%     -    2s
     0     0 95185.3578    0  946 -146060.18 95185.3578   165%     -    2s
     0     0 90127.8211    0 1010 -146060.18 90127.8211   162%     -    4s
     0     0 89807.6817    0 1018 -146060.18 89807.6817   161%     -    4s
H    0     0                    -75401.36811 89777.4703   219%     -    4s
     0     0 89777.4703    0 1011 -75401.368 89777.4703   219%     -    4s
H    0     0                    -36544.72332 89776.7958   346%     -    4s
     0     0 89776.7958    0 1011 -36544.723 89776.7958   346%     -    4s
H    0     0                    24240.406727 89776.7958   270%     -    4s
H    0     0                    24676.688752 85699.1863   247%     -    6s
H    0     0                    25203.046399 85699.1863   240%     -    6s
     0     0 85699.1863    0 1084 25203.0464 85699.1863   240%     -    6s
H    0     0                    25282.158000 85252.1125   237%     -    6s
H    0     0                    26113.047865 85252.1125   226%     -    6s
H    0     0                    26430.984885 85252.1125   223%     -    6s
H    0     0                    26478.489392 85252.1125   222%     -    6s
H    0     0                    27375.012698 85252.1125   211%     -    6s
H    0     0                    27434.112849 85252.1125   211%     -    6s
H    0     0                    27477.520958 85252.1125   210%     -    6s
H    0     0                    27522.891479 85252.1125   210%     -    6s
H    0     0                    27710.496950 85252.1125   208%     -    6s
H    0     0                    27752.852449 85252.1125   207%     -    6s
H    0     0                    27783.540627 85252.1125   207%     -    6s
     0     0 85252.1125    0 1085 27783.5406 85252.1125   207%     -    6s
H    0     0                    28633.791852 85174.0004   197%     -    6s
H    0     0                    28636.565146 85174.0004   197%     -    6s
H    0     0                    28832.901820 85174.0004   195%     -    6s
H    0     0                    29143.258749 85174.0004   192%     -    6s
H    0     0                    29156.399693 85174.0004   192%     -    6s
     0     0 85174.0004    0 1100 29156.3997 85174.0004   192%     -    6s
     0     0 85157.7253    0 1108 29156.3997 85157.7253   192%     -    6s
     0     0 85157.1481    0 1117 29156.3997 85157.1481   192%     -    6s
H    0     0                    29559.861626 81182.3883   175%     -    8s
H    0     0                    29564.362810 81182.3883   175%     -    8s
H    0     0                    29579.550975 81182.3883   174%     -    8s
H    0     0                    29601.313720 81182.3883   174%     -    8s
     0     0 81182.3883    0  997 29601.3137 81182.3883   174%     -    8s
H    0     0                    29668.870193 80534.0391   171%     -    8s
H    0     0                    29675.621360 80534.0391   171%     -    8s
     0     0 80534.0391    0 1047 29675.6214 80534.0391   171%     -    8s
     0     0 80433.9104    0 1065 29675.6214 80433.9104   171%     -    9s
     0     0 80414.8578    0 1065 29675.6214 80414.8578   171%     -    9s
H    0     0                    31521.762539 80407.4050   155%     -    9s
     0     0 80407.4050    0 1069 31521.7625 80407.4050   155%     -    9s
H    0     0                    31529.631450 73584.8896   133%     -   11s
H    0     0                    31580.110492 73584.8896   133%     -   11s
     0     0 73584.8896    0  822 31580.1105 73584.8896   133%     -   11s
H    0     0                    31612.660971 72552.3412   130%     -   11s
     0     0 72552.3412    0  843 31612.6610 72552.3412   130%     -   11s
     0     0 72515.7436    0  849 31612.6610 72515.7436   129%     -   11s
     0     0 72487.1219    0  873 31612.6610 72487.1219   129%     -   11s
     0     0 72475.0583    0  865 31612.6610 72475.0583   129%     -   12s
     0     0 67352.7168    0  761 31612.6610 67352.7168   113%     -   13s
H    0     0                    31661.219338 66555.3499   110%     -   13s
     0     0 66555.3499    0  793 31661.2193 66555.3499   110%     -   13s
     0     0 66327.9325    0  800 31661.2193 66327.9325   109%     -   14s
     0     0 66254.5035    0  819 31661.2193 66254.5035   109%     -   14s
H    0     0                    31781.046284 66214.5795   108%     -   14s
     0     0 66214.5795    0  816 31781.0463 66214.5795   108%     -   14s
     0     0 66209.2197    0  840 31781.0463 66209.2197   108%     -   14s
H    0     0                    31793.401539 64175.6479   102%     -   15s
H    0     0                    31856.194797 64175.6479   101%     -   15s
H    0     0                    31863.486270 64175.6479   101%     -   15s
H    0     0                    31938.886596 64175.6479   101%     -   15s
H    0     0                    31948.954335 64175.6479   101%     -   15s
H    0     0                    32015.660309 64175.6479   100%     -   15s
H    0     0                    32295.154429 64175.6479  98.7%     -   15s
H    0     0                    32432.462198 64175.6479  97.9%     -   15s
     0     0 64175.6479    0  776 32432.4622 64175.6479  97.9%     -   15s
     0     0 63750.5570    0  805 32432.4622 63750.5570  96.6%     -   16s
     0     0 63602.4594    0  800 32432.4622 63602.4594  96.1%     -   16s
H    0     0                    32443.505075 63561.3806  95.9%     -   16s
H    0     0                    32458.551718 63561.3806  95.8%     -   16s
     0     0 63561.3806    0  818 32458.5517 63561.3806  95.8%     -   16s
     0     0 63541.2689    0  821 32458.5517 63541.2689  95.8%     -   17s
H    0     0                    32462.500607 61998.3759  91.0%     -   18s
H    0     0                    35017.291666 61998.3759  77.1%     -   18s
H    0     0                    35258.421508 61998.3759  75.8%     -   18s
H    0     0                    35281.829940 61998.3759  75.7%     -   18s
     0     0 61998.3759    0  766 35281.8299 61998.3759  75.7%     -   18s
     0     0 61729.4922    0  816 35281.8299 61729.4922  75.0%     -   18s
     0     0 61660.7877    0  833 35281.8299 61660.7877  74.8%     -   19s
H    0     0                    35451.899836 61640.6030  73.9%     -   19s
H    0     0                    37227.908865 61640.6030  65.6%     -   19s
     0     0 61640.6030    0  833 37227.9089 61640.6030  65.6%     -   19s
     0     0 60760.7214    0  757 37227.9089 60760.7214  63.2%     -   20s
     0     0 60473.5579    0  806 37227.9089 60473.5579  62.4%     -   20s
H    0     0                    37441.729004 60352.7202  61.2%     -   21s
H    0     0                    37471.407607 60352.7202  61.1%     -   21s
H    0     0                    37537.929253 60352.7202  60.8%     -   21s
     0     0 60352.7202    0  837 37537.9293 60352.7202  60.8%     -   21s
H    0     0                    37798.237914 60319.6357  59.6%     -   21s
H    0     0                    37803.509801 60319.6357  59.6%     -   21s
     0     0 60319.6357    0  810 37803.5098 60319.6357  59.6%     -   21s
     0     0 59678.8871    0  765 37803.5098 59678.8871  57.9%     -   22s
     0     0 59497.7404    0  665 37803.5098 59497.7404  57.4%     -   23s
     0     0 59442.4761    0  763 37803.5098 59442.4761  57.2%     -   23s
     0     0 59423.5723    0  808 37803.5098 59423.5723  57.2%     -   23s
     0     0 58952.7477    0  839 37803.5098 58952.7477  55.9%     -   24s
H    0     0                    37905.202038 58787.0552  55.1%     -   25s
H    0     0                    37963.860984 58787.0552  54.9%     -   25s
     0     0 58787.0552    0  831 37963.8610 58787.0552  54.9%     -   25s
H    0     0                    38408.186356 58761.4970  53.0%     -   25s
H    0     0                    38723.153490 58761.4970  51.7%     -   25s
H    0     0                    38901.251746 58761.4970  51.1%     -   25s
H    0     0                    38910.783003 58761.4970  51.0%     -   25s
     0     0 58761.4970    0  833 38910.7830 58761.4970  51.0%     -   25s
H    0     0                    38915.029651 58436.4380  50.2%     -   26s
H    0     0                    39291.474739 58436.4380  48.7%     -   26s
H    0     0                    39567.026757 58436.4380  47.7%     -   26s
H    0     0                    39690.170699 58436.4380  47.2%     -   26s
H    0     0                    39769.780525 58436.4380  46.9%     -   26s
H    0     0                    39908.204559 58436.4380  46.4%     -   26s
H    0     0                    39988.033708 58436.4380  46.1%     -   26s
     0     0 58436.4380    0  872 39988.0337 58436.4380  46.1%     -   26s
     0     0 58288.0406    0  790 39988.0337 58288.0406  45.8%     -   27s
     0     0 58231.7629    0  897 39988.0337 58231.7629  45.6%     -   27s
     0     0 58217.0051    0  826 39988.0337 58217.0051  45.6%     -   27s
     0     0 57985.9204    0  888 39988.0337 57985.9204  45.0%     -   28s
     0     0 57985.7967    0  888 39988.0337 57985.7967  45.0%     -   28s
     0     2 57985.6301    0  888 39988.0337 57985.6301  45.0%     -   29s
     1     4 57929.4930    1  823 39988.0337 57985.6301  45.0%  1092   31s
    15    32 56082.6057    4  717 39988.0337 57264.2516  43.2%  3537   35s
    31    63 55296.0475    5  589 39988.0337 57038.2618  42.6%  4222   42s
H   36    63                    40228.719697 57038.2618  41.8%  4670   42s
H   37    63                    40273.706069 57038.2618  41.6%  4739   42s
H   94   232                    40295.782780 56271.0425  39.6%  4661   45s
H  113   232                    40698.542817 56271.0425  38.3%  4015   45s
H  132   232                    40774.069222 56271.0425  38.0%  3615   45s
H  367   370                    40783.600478 56271.0425  38.0%  1709   47s
H  447   481                    40838.416216 56271.0425  37.8%  1498   48s
   579   592 52021.2238   16  426 40838.4162 56271.0425  37.8%  1233   50s
H  809   745                    41024.346156 55769.0673  35.9%   992   52s
  1219  1157 45786.3536   26  403 41024.3462 55729.9444  35.8%   760   55s
  1670  1429 43629.3752   31  348 41024.3462 55561.3724  35.4%   664   60s
  2732  2389 43606.1120   14  185 41024.3462 54939.4200  33.9%   526   65s
  3473  2664 43160.4645   17  147 41024.3462 54503.1677  32.9%   487   70s
  4192  3103 47637.0492   15  193 41024.3462 54393.6596  32.6%   466   75s
  4424  3104 43148.1397   26  888 41024.3462 54384.6018  32.6%   465   86s
  4450  3121 47525.2194   25  360 41024.3462 54384.6018  32.6%   462   90s
  4775  3241 43810.8505   19  236 41024.3462 52437.2319  27.8%   468   95s
H 5276  3007                    41109.810396 50001.3823  21.6%   449   97s
  5735  2877 42540.9537   22  272 41109.8104 49418.7624  20.2%   437  100s
  7291  2277     cutoff   50      41109.8104 45521.2081  10.7%   384  105s
* 8339  2030              51    41134.597101 43105.9562  4.79%   342  105s
* 9325  1742              60    41215.440570 41692.9218  1.16%   309  106s
*10944   857              44    41245.632340 41645.2950  0.97%   267  106s
*11459   557              49    41297.867421 41584.6186  0.69%   256  106s

Cutting planes:
  Implied bound: 15
  Projected implied bound: 17
  MIR: 266
  Flow cover: 496
  RLT: 32
  Relax-and-lift: 115
  BQP: 3

Explored 12691 nodes (3042821 simplex iterations) in 106.52 seconds (225.82 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 41297.9 41245.6 41215.4 ... 40698.5

Optimal solution found (tolerance 1.00e-06)
Best objective 4.129786742124e+04, best bound 4.129786742124e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 106.52s
  Master Objective (UB) = 41297.87, θ = 193255.01
  Upper Bound (UB) = 41297.87

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 193255.01
  [DEBUG]   ✓ Scenario 0: θ = 193255.01 ≤ Q = 193255.01 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x69493bda
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x69493bda
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.352302e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 7104670.0433
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.523045e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152304.53    0  123 7104670.04 -152304.53   102%     -    0s
H    0     0                    -116904.2763 -152304.53  30.3%     -    0s
H    0     0                    -117200.2049 -152304.53  30.0%     -    0s
*    0     0               0    -119824.7995 -119824.80  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 210

Explored 1 nodes (375 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -119825 -117200 -116904 ... 1.3523e+13
No other solutions better than -119825

Optimal solution found (tolerance 1.00e-06)
Best objective -1.198247994561e+05, best bound -1.198247994561e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 161298.93
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119824.80
  [DEBUG]   S×d_nominal = 281123.73
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 281123.73 + -119824.80 = 161298.93
  [DEBUG]   Current θ from Master = 193255.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31956.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9341.79
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 31956.0799, Absolute Gap = 31956.0799, Relative Gap = 0.773795
  Not converged yet (gap = 31956.08 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92023 nonzeros
Model fingerprint: 0x4865f973
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 9341.79 (0.01s)
MIP start from previous solve produced solution with objective 9341.79 (0.01s)
Loaded MIP start from previous solve with objective 9341.79

Presolve removed 12727 rows and 5166 columns
Presolve time: 0.30s
Presolved: 19236 rows, 9574 columns, 106688 nonzeros
Variable types: 7315 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.371957e+04, 10259 iterations, 1.36 seconds (2.75 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 53719.5697    0  292 9341.78754 53719.5697   475%     -    1s
H    0     0                    9895.6805385 53719.5697   443%     -    1s
H    0     0                    9999.1261731 53719.5697   437%     -    1s
H    0     0                    10060.201761 53719.5697   434%     -    1s
     0     0 43277.3324    0  517 10060.2018 43277.3324   330%     -    3s
H    0     0                    10124.070832 43276.5975   327%     -    3s
H    0     0                    10264.077518 43276.5975   322%     -    3s
H    0     0                    10299.470402 43276.5975   320%     -    3s
     0     0 43213.2219    0  517 10299.4704 43213.2219   320%     -    3s
     0     0 37857.8110    0  538 10299.4704 37857.8110   268%     -    5s
H    0     0                    10308.633095 37123.1680   260%     -    5s
H    0     0                    10550.449041 37123.1680   252%     -    5s
     0     0 37123.1680    0  548 10550.4490 37123.1680   252%     -    5s
     0     0 36975.4630    0  578 10550.4490 36975.4630   250%     -    6s
     0     0 36958.7977    0  577 10550.4490 36958.7977   250%     -    6s
     0     0 36944.1320    0  591 10550.4490 36944.1320   250%     -    6s
     0     0 36943.5584    0  581 10550.4490 36943.5584   250%     -    6s
     0     0 33293.8086    0  499 10550.4490 33293.8086   216%     -    8s
     0     0 32673.5767    0  562 10550.4490 32673.5767   210%     -    9s
     0     0 32565.7912    0  560 10550.4490 32565.7912   209%     -    9s
     0     0 32519.4808    0  558 10550.4490 32519.4808   208%     -    9s
     0     0 32501.2717    0  564 10550.4490 32501.2717   208%     -    9s
     0     0 32497.3740    0  569 10550.4490 32497.3740   208%     -   10s
     0     0 30647.8426    0  593 10550.4490 30647.8426   190%     -   12s
     0     0 30127.5082    0  529 10550.4490 30127.5082   186%     -   13s
     0     0 30048.3809    0  702 10550.4490 30048.3809   185%     -   14s
H    0     0                    15105.186270 30005.0069  98.6%     -   14s
H    0     0                    15116.572461 30005.0069  98.5%     -   14s
H    0     0                    15145.668211 30005.0069  98.1%     -   14s
     0     0 30005.0069    0  690 15145.6682 30005.0069  98.1%     -   14s
H    0     0                    15170.873629 30001.7219  97.8%     -   14s
     0     0 30001.7219    0  699 15170.8736 30001.7219  97.8%     -   14s
     0     0 29250.6701    0  417 15170.8736 29250.6701  92.8%     -   16s
H    0     0                    15319.674790 29250.3785  90.9%     -   16s
H    0     0                    15398.045560 29250.3785  90.0%     -   16s
H    0     0                    15418.213527 29250.3785  89.7%     -   16s
     0     0 29078.4872    0  409 15418.2135 29078.4872  88.6%     -   16s
     0     0 29050.8263    0  422 15418.2135 29050.8263  88.4%     -   16s
     0     0 29038.6470    0  418 15418.2135 29038.6470  88.3%     -   17s
     0     0 29034.2715    0  438 15418.2135 29034.2715  88.3%     -   17s
     0     0 28699.7702    0  397 15418.2135 28699.7702  86.1%     -   18s
H    0     0                    15427.784510 28698.6874  86.0%     -   18s
     0     0 28655.2278    0  398 15427.7845 28655.2278  85.7%     -   18s
     0     0 28642.7424    0  398 15427.7845 28642.7424  85.7%     -   18s
     0     0 28638.9922    0  399 15427.7845 28638.9922  85.6%     -   18s
H    0     0                    15486.673691 28512.5845  84.1%     -   19s
H    0     0                    15641.330221 28512.5845  82.3%     -   19s
     0     0 28512.5845    0  447 15641.3302 28512.5845  82.3%     -   19s
     0     0 28484.9795    0  523 15641.3302 28484.9795  82.1%     -   20s
     0     0 28478.9894    0  529 15641.3302 28478.9894  82.1%     -   20s
     0     0 28428.3655    0  557 15641.3302 28428.3655  81.8%     -   21s
     0     0 28401.5152    0  413 15641.3302 28401.5152  81.6%     -   21s
     0     0 28398.6876    0  417 15641.3302 28398.6876  81.6%     -   21s
     0     0 28375.2501    0  403 15641.3302 28375.2501  81.4%     -   22s
     0     0 28365.8549    0  409 15641.3302 28365.8549  81.4%     -   22s
     0     0 28359.6959    0  424 15641.3302 28359.6959  81.3%     -   22s
     0     0 28348.9500    0  420 15641.3302 28348.9500  81.2%     -   23s
     0     0 28345.3234    0  424 15641.3302 28345.3234  81.2%     -   23s
     0     0 28338.2732    0  470 15641.3302 28338.2732  81.2%     -   24s
     0     0 28338.0372    0  470 15641.3302 28338.0372  81.2%     -   24s
     0     2 28337.3404    0  470 15641.3302 28337.3404  81.2%     -   28s
     7    16 27258.3719    3  491 15641.3302 27966.5381  78.8%  1120   30s
    95   152 26029.8690    7  534 15641.3302 27169.9787  73.7%  1533   38s
H  119   152                    15659.980800 27169.9787  73.5%  1339   38s
   276   346 25060.0719   10  357 15659.9808 27169.9787  73.5%   842   40s
H  286   346                    15665.960922 27169.9787  73.4%   835   40s
   589   561 24589.6289   15  421 15665.9609 26642.6823  70.1%   684   45s
   865   835 22840.6476   19  438 15665.9609 26541.2123  69.4%   610   50s
  1226  1061     cutoff   23      15665.9609 26443.6149  68.8%   540   55s
H 1357  1146                    15669.647218 26443.6149  68.8%   525   57s
  1782  1568 20078.2841   31  335 15669.6472 26337.1061  68.1%   452   61s
H 2372  1832                    15706.687082 26239.2231  67.1%   406   64s
  2425  1934 15938.1056   49  224 15706.6871 26239.2231  67.1%   407   66s
  2933  2249 23930.9448   10  562 15706.6871 26142.0178  66.4%   402   71s
  3637  2565 20092.2306   36  155 15706.6871 26142.0178  66.4%   376   75s
H 3682  2564                    15805.543640 26007.9223  64.5%   375   75s
  4287  2891     cutoff   17      15805.5436 25942.9331  64.1%   365   80s
  4909  3108 18862.9688   22  470 15805.5436 25495.3361  61.3%   353   98s
H 4910  2953                    15810.052410 25495.3361  61.3%   353  100s
  4920  2959 18842.4921   13  459 15810.0524 25495.3361  61.3%   352  105s
  4931  2967 21000.5899   10  426 15810.0524 25495.3361  61.3%   351  110s
  4937  2971 24660.4020   14  485 15810.0524 25495.3361  61.3%   351  115s
  4953  2998 24765.1009   13  322 15810.0524 25495.3361  61.3%   360  121s
H 4996  2865                    15824.482439 25495.3361  61.1%   368  122s
H 4997  2723                    15825.000232 25495.3361  61.1%   368  122s
H 5053  2613                    15825.221172 25495.3361  61.1%   377  124s
  5076  2638 24811.3918   16  277 15825.2212 25495.3361  61.1%   380  125s
  5457  2638 20278.5853   21  223 15825.2212 24821.4500  56.8%   396  130s
H 5734  2447                    15832.592380 23767.1631  50.1%   398  134s
  5747  2444 infeasible   24      15832.5924 23767.1631  50.1%   398  135s
H 5907  2298                    15843.048640 23767.1631  50.0%   398  136s
  6262  2279 16405.4315   36  113 15843.0486 23548.3238  48.6%   395  140s
H 6342  2136                    15855.675924 22762.0309  43.6%   394  140s
H 6474  1990                    15856.244480 22762.0309  43.6%   394  142s
  6696  1871 16438.4639   19  261 15856.2445 21650.7288  36.5%   395  145s
  7125  1639     cutoff   24      15856.2445 20431.3628  28.9%   398  150s
  8752   801     cutoff   54      15856.2445 17060.2151  7.59%   350  155s

Cutting planes:
  Learned: 1
  MIR: 259
  Flow cover: 467
  RLT: 9
  Relax-and-lift: 48

Explored 9086 nodes (3114564 simplex iterations) in 155.30 seconds (371.34 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 15856.2 15843 15832.6 ... 15660

Optimal solution found (tolerance 1.00e-06)
Best objective 1.585624448025e+04, best bound 1.585624448025e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 155.30s
  Master Objective (UB) = 15856.24, θ = 150631.68
  Upper Bound (UB) = 15856.24

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150631.68
  [DEBUG]   ✓ Scenario 0: θ = 150631.68 ≤ Q = 150631.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 150631.68 ≤ Q = 150631.68 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xdc40684
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0dc40684
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.411776e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.00s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 7755468.7301
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.442174e+05, 273 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144217.42    0  139 7755468.73 -144217.42   102%     -    0s
H    0     0                    -103189.0035 -144217.42  39.8%     -    0s
H    0     0                    -104439.9269 -144217.42  38.1%     -    0s
H    0     0                    -122011.8033 -144217.42  18.2%     -    0s
     0     0 -132862.58    0   74 -122011.80 -132862.58  8.89%     -    0s
H    0     0                    -129989.5426 -132762.87  2.13%     -    0s
     0     0 -131700.35    0   81 -129989.54 -131700.35  1.32%     -    0s
     0     0 -131671.64    0   81 -129989.54 -131671.64  1.29%     -    0s
     0     0 -131668.84    0   81 -129989.54 -131668.84  1.29%     -    0s
     0     0 -130969.20    0   22 -129989.54 -130969.20  0.75%     -    0s
H    0     0                    -130307.6756 -130965.45  0.50%     -    0s
     0     0 -130792.11    0   24 -130307.68 -130792.11  0.37%     -    0s
H    0     0                    -130322.3787 -130724.87  0.31%     -    0s
     0     0 -130724.87    0   29 -130322.38 -130724.87  0.31%     -    0s
     0     0 -130716.86    0   29 -130322.38 -130716.86  0.30%     -    0s
     0     0 -130635.48    0   12 -130322.38 -130635.48  0.24%     -    0s
     0     0 -130620.68    0   12 -130322.38 -130620.68  0.23%     -    0s
     0     0 -130620.68    0   12 -130322.38 -130620.68  0.23%     -    0s
     0     0 -130620.68    0   12 -130322.38 -130620.68  0.23%     -    0s
H    0     0                    -130376.4464 -130566.80  0.15%     -    0s
     0     0 -130566.80    0    8 -130376.45 -130566.80  0.15%     -    0s
H    0     0                    -130414.0768 -130557.26  0.11%     -    0s
     0     0 -130557.26    0    7 -130414.08 -130557.26  0.11%     -    0s
     0     0 -130549.63    0    8 -130414.08 -130549.63  0.10%     -    0s
     0     0 -130549.63    0   14 -130414.08 -130549.63  0.10%     -    0s
H    0     0                    -130487.2570 -130549.63  0.05%     -    0s
     0     0 -130528.82    0    6 -130487.26 -130528.82  0.03%     -    0s
H    0     0                    -130488.3977 -130525.44  0.03%     -    0s
     0     0 -130515.27    0    6 -130488.40 -130515.27  0.02%     -    0s
H    0     0                    -130507.5565 -130515.27  0.01%     -    0s

Cutting planes:
  Gomory: 11
  Implied bound: 6
  MIR: 5
  Flow cover: 5
  Relax-and-lift: 3

Explored 1 nodes (901 simplex iterations) in 0.06 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130508 -130488 -130487 ... -104440
No other solutions better than -130508

Optimal solution found (tolerance 1.00e-06)
Best objective -1.305075564711e+05, best bound -1.305075564711e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 126965.41
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130507.56
  [DEBUG]   S×d_nominal = 257472.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 257472.97 + -130507.56 = 126965.41
  [DEBUG]   Current θ from Master = 150631.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23666.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7810.02
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 6514.4569, Absolute Gap = 6514.4569, Relative Gap = 0.410845
  Not converged yet (gap = 6514.46 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135275 nonzeros
Model fingerprint: 0xa84b8e84
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -7810.02 (0.02s)
Loaded MIP start from previous solve with objective -7810.02

Presolve removed 19089 rows and 7749 columns
Presolve time: 0.42s
Presolved: 28164 rows, 13231 columns, 173384 nonzeros
Variable types: 10972 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   47656    3.1561142e+04   0.000000e+00   6.617945e+05      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   17925    3.9164162e+04   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 3.916416e+04, 17925 iterations, 4.55 seconds (8.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 39164.1619    0  206 -7810.0249 39164.1619   601%     -    5s
H    0     0                    3769.6084238 39164.1619   939%     -    5s
H    0     0                    4208.9903676 39164.1619   830%     -    5s
H    0     0                    4352.0473685 39164.1619   800%     -    5s
H    0     0                    4482.8507627 39164.1619   774%     -    5s
H    0     0                    4501.8674874 39164.1619   770%     -    5s
H    0     0                    4514.3541415 39164.1619   768%     -    5s
H    0     0                    6460.0895900 39164.1619   506%     -    5s
H    0     0                    9311.4036490 39164.1619   321%     -    5s
H    0     0                    9452.7668401 39164.1619   314%     -    5s
H    0     0                    9487.2371685 39164.1619   313%     -    5s
     0     0 35214.9099    0  309 9487.23717 35214.9099   271%     -    7s
     0     0 34551.1871    0  212 9487.23717 34551.1871   264%     -    8s
     0     0 34243.8510    0  312 9487.23717 34243.8510   261%     -    8s
     0     0 34218.8092    0  307 9487.23717 34218.8092   261%     -    8s
     0     0 34218.7008    0  307 9487.23717 34218.7008   261%     -    8s
     0     0 32427.7809    0  268 9487.23717 32427.7809   242%     -   10s
H    0     0                    11989.368877 32420.8329   170%     -   10s
H    0     0                    12017.406471 32420.8329   170%     -   10s
H    0     0                    12568.322978 32420.8329   158%     -   10s
H    0     0                    12575.235946 32420.8329   158%     -   10s
H    0     0                    12597.453300 32420.8329   157%     -   10s
H    0     0                    12649.518232 32420.8329   156%     -   10s
     0     0 31867.7802    0  270 12649.5182 31867.7802   152%     -   10s
     0     0 31717.8437    0  285 12649.5182 31717.8437   151%     -   11s
     0     0 31674.2489    0  283 12649.5182 31674.2489   150%     -   11s
     0     0 31672.8304    0  284 12649.5182 31672.8304   150%     -   11s
     0     0 31672.4642    0  286 12649.5182 31672.4642   150%     -   11s
     0     0 30178.0593    0  309 12649.5182 30178.0593   139%     -   13s
H    0     0                    12674.941597 30177.7060   138%     -   13s
H    0     0                    12695.639944 30177.7060   138%     -   13s
     0     0 29865.2195    0  331 12695.6399 29865.2195   135%     -   14s
     0     0 29670.1137    0  368 12695.6399 29670.1137   134%     -   15s
     0     0 29565.3961    0  371 12695.6399 29565.3961   133%     -   15s
     0     0 29546.9842    0  375 12695.6399 29546.9842   133%     -   15s
     0     0 29543.8981    0  379 12695.6399 29543.8981   133%     -   15s
     0     0 29543.8965    0  379 12695.6399 29543.8965   133%     -   15s
     0     0 28855.1427    0  395 12695.6399 28855.1427   127%     -   18s
H    0     0                    12945.721249 28854.8122   123%     -   18s
     0     0 28700.8085    0  428 12945.7212 28700.8085   122%     -   19s
     0     0 28581.0893    0  400 12945.7212 28581.0893   121%     -   20s
     0     0 28557.1570    0  357 12945.7212 28557.1570   121%     -   20s
     0     0 28528.4459    0  411 12945.7212 28528.4459   120%     -   20s
     0     0 28489.1266    0  414 12945.7212 28489.1266   120%     -   20s
     0     0 28479.2919    0  408 12945.7212 28479.2919   120%     -   21s
     0     0 28470.0612    0  360 12945.7212 28470.0612   120%     -   21s
     0     0 28466.0193    0  353 12945.7212 28466.0193   120%     -   21s
     0     0 28463.8852    0  356 12945.7212 28463.8852   120%     -   21s
     0     0 28462.2746    0  362 12945.7212 28462.2746   120%     -   21s
     0     0 28461.4133    0  365 12945.7212 28461.4133   120%     -   21s
     0     0 28178.7711    0  411 12945.7212 28178.7711   118%     -   23s
     0     0 28084.4655    0  435 12945.7212 28084.4655   117%     -   23s
     0     0 28045.1168    0  444 12945.7212 28045.1168   117%     -   24s
     0     0 28037.2848    0  441 12945.7212 28037.2848   117%     -   24s
     0     0 28033.1270    0  449 12945.7212 28033.1270   117%     -   24s
     0     0 28031.8208    0  449 12945.7212 28031.8208   117%     -   24s
     0     0 27865.5722    0  434 12945.7212 27865.5722   115%     -   26s
H    0     0                    12958.787411 27863.1561   115%     -   26s
     0     0 27830.7087    0  382 12958.7874 27830.7087   115%     -   26s
     0     0 27825.2745    0  328 12958.7874 27825.2745   115%     -   26s
     0     0 27823.4718    0  380 12958.7874 27823.4718   115%     -   26s
     0     0 27822.6490    0  380 12958.7874 27822.6490   115%     -   26s
     0     0 27797.5832    0  327 12958.7874 27797.5832   115%     -   27s
     0     0 27791.5120    0  431 12958.7874 27791.5120   114%     -   27s
     0     0 27787.8005    0  440 12958.7874 27787.8005   114%     -   27s
     0     0 27786.4177    0  442 12958.7874 27786.4177   114%     -   28s
     0     0 27781.3768    0  447 12958.7874 27781.3768   114%     -   28s
     0     0 27779.7568    0  441 12958.7874 27779.7568   114%     -   29s
     0     0 27779.5154    0  449 12958.7874 27779.5154   114%     -   29s
     0     0 27771.1421    0  475 12958.7874 27771.1421   114%     -   29s
     0     0 27764.4951    0  467 12958.7874 27764.4951   114%     -   30s
     0     0 27764.4951    0  471 12958.7874 27764.4951   114%     -   30s
     0     0 27764.4951    0  447 12958.7874 27764.4951   114%     -   30s
     0     0 27764.4951    0  440 12958.7874 27764.4951   114%     -   31s
     0     0 27763.9347    0  440 12958.7874 27763.9347   114%     -   32s
H    0     0                    13119.608843 27763.9347   112%     -   36s
H    0     0                    13126.927417 27763.9347   112%     -   36s
     0     2 27763.9347    0  440 13126.9274 27763.9347   112%     -   36s
     7    16 27071.7465    3  474 13126.9274 27417.0618   109%  2136   40s
    31    64 26578.0826    5  439 13126.9274 26663.2120   103%  3549   45s
H   35    64                    13130.518533 26663.2120   103%  3307   45s
H   39    64                    13225.428176 26663.2120   102%  3104   45s
    95   207 26217.1247    7  440 13225.4282 26577.6357   101%  2089   50s
H  144   207                    13238.807949 26577.6357   101%  1758   50s
   357   407 25306.1487   12  401 13238.8079 26577.6357   101%  1381   56s
   491   511 24916.6248   14  449 13238.8079 26572.0779   101%  1293   60s
   676   647 23073.7577   18  369 13238.8079 26572.0779   101%  1264   67s
   712   683 22411.0956   18  407 13238.8079 26572.0779   101%  1282   70s
   871   821 22203.1317   21  464 13238.8079 26572.0779   101%  1341   76s
   970   898 21798.0573   22  416 13238.8079 26240.5047  98.2%  1324   80s
  1123  1040 20437.6271   25  347 13238.8079 26240.5047  98.2%  1287   87s
  1268  1214 19909.1257   26  333 13238.8079 26240.5047  98.2%  1234   91s
  1522  1432 18913.3600   36  228 13238.8079 26190.0410  97.8%  1125   96s
  1716  1609 18104.2187   40  212 13238.8079 26063.6743  96.9%  1085  100s
  2015  1906 15854.7759   51  141 13238.8079 26038.4897  96.7%  1019  106s
  2465  2209     cutoff   71      13238.8079 25939.0752  95.9%   916  111s
  2820  2390 24971.3436    8  378 13238.8079 25887.9690  95.5%   872  116s
  3144  2557 19406.2302   12  180 13238.8079 25887.9690  95.5%   853  121s
H 3146  2557                    13264.897603 25887.9690  95.2%   853  121s
  3392  2762 18810.1678   13  152 13264.8976 25752.1799  94.1%   841  127s
  3597  2896 15427.1398   22  126 13264.8976 25752.1799  94.1%   836  130s
  3776  2897 20809.0829   23  440 13264.8976 25752.1799  94.1%   837  140s
  3778  2898 20072.6210   23  206 13264.8976 25752.1799  94.1%   837  149s
  3779  2899 16719.6397   37  323 13264.8976 25752.1799  94.1%   836  153s
  3780  2900 22910.7626   16  374 13264.8976 25752.1799  94.1%   836  155s
  3785  2903 24365.9051    9  435 13264.8976 25752.1799  94.1%   835  160s
  3794  2909 20938.2505   14  400 13264.8976 25752.1799  94.1%   833  166s
  3801  2914 15184.0235   55  414 13264.8976 25752.1799  94.1%   832  171s
  3806  2917 17009.0233   11  424 13264.8976 25752.1799  94.1%   830  175s
  3811  2920 24226.7646   10  471 13264.8976 25752.1799  94.1%   829  187s
  3812  2921 17332.2065   29  471 13264.8976 25752.1799  94.1%   829  194s
  3813  2925 25752.1799   14  390 13264.8976 25752.1799  94.1%   847  197s
  3815  2928 25752.1799   15  386 13264.8976 25752.1799  94.1%   849  201s
  3827  2948 25556.9333   17  443 13264.8976 25752.1799  94.1%   856  208s
  3843  2975 24477.1350   18  490 13264.8976 25555.1035  92.7%   871  211s
  3875  2988 19603.4041   19  326 13264.8976 24531.3079  84.9%   900  219s
  3899  3060 23167.1074   20  400 13264.8976 24530.9284  84.9%   960  225s
H 3929  2903                    13274.269580 24530.9284  84.8%   980  225s
H 3945  2759                    13287.005618 24530.9284  84.6%   986  225s
  4055  2831 21221.7537   24  294 13287.0056 24530.9284  84.6%  1016  233s
  4134  2871 20669.8789   26  347 13287.0056 24530.9284  84.6%  1024  238s
  4221  2888 20434.9740   30  260 13287.0056 24530.9284  84.6%  1029  241s
  4398  2920 17865.7796   34  134 13287.0056 24064.3352  81.1%  1029  247s
  4471  2923 17908.6614   34  163 13287.0056 24064.3352  81.1%  1026  250s
  4623  2915 13572.6592   37  137 13287.0056 24064.3352  81.1%  1029  256s
  4747  2941     cutoff   39      13287.0056 23252.1975  75.0%  1035  263s
  4827  2938 14121.7111   44   95 13287.0056 22898.0602  72.3%  1037  265s
  4965  2940 17207.7499   20  202 13287.0056 22596.4445  70.1%  1040  272s
  5001  2950 15721.5928   21  168 13287.0056 22596.4445  70.1%  1043  275s
  5158  2951     cutoff   25      13287.0056 22385.5669  68.5%  1041  282s
  5267  2944     cutoff   26      13287.0056 22385.5669  68.5%  1043  285s
  5487  2941 19026.0539   24  345 13287.0056 22148.8219  66.7%  1045  293s
  5599  2913 infeasible   26      13287.0056 21825.4200  64.3%  1048  296s
  5709  2911 16784.4207   29  255 13287.0056 21653.8129  63.0%  1054  302s
  5755  2912     cutoff   29      13287.0056 21653.8129  63.0%  1059  307s
  5840  2897 16191.3694   31  180 13287.0056 21319.9312  60.5%  1057  311s
  5968  2866 15346.9831   33  121 13287.0056 21319.9312  60.5%  1059  318s
  6059  2850     cutoff   33      13287.0056 21319.9312  60.5%  1059  322s
  6189  2849 13982.3422   34  110 13287.0056 20842.6081  56.9%  1057  327s
  6314  2849 14484.0658   32  182 13287.0056 20842.6081  56.9%  1059  332s
  6494  2831 14935.9965   28  239 13287.0056 20449.2585  53.9%  1060  337s
  6697  2811 14250.7189   29   85 13287.0056 20316.1997  52.9%  1057  342s
  6904  2776 17656.7553   22  316 13287.0056 20163.3138  51.8%  1056  348s
  7114  2779 infeasible   24      13287.0056 20163.3138  51.8%  1053  354s
  7307  2764 15975.8218   25  331 13287.0056 19871.4722  49.6%  1055  359s
  7561  2771 15298.4700   30  283 13287.0056 19803.2155  49.0%  1053  364s
  7813  2724 13463.8243   34  258 13287.0056 19602.8443  47.5%  1049  369s
  8076  2728 16264.5659   27  357 13287.0056 19602.8443  47.5%  1047  375s
  8411  2672 16363.4024   25  327 13287.0056 19263.7716  45.0%  1041  380s
  8735  2561     cutoff   28      13287.0056 19260.8443  45.0%  1035  387s
  9105  2533 14969.3223   29  287 13287.0056 18768.6735  41.3%  1029  393s
  9446  2430     cutoff   30      13287.0056 18544.4028  39.6%  1027  399s
  9845  2278 15975.1956   31  234 13287.0056 18427.3647  38.7%  1020  408s
 10265  2100 16005.8026   23  171 13287.0056 18098.9759  36.2%  1014  416s
 10730  1876     cutoff   31      13287.0056 17895.1223  34.7%  1006  422s
 11169  1605 13966.4596   26  255 13287.0056 17580.7619  32.3%  1000  431s
 11647  1286 15504.3429   25  166 13287.0056 17236.6335  29.7%   994  438s
 12245  1138 14802.4084   35  249 13287.0056 16772.0326  26.2%   980  444s
 12833   788 13313.4118   25  286 13287.0056 16557.7105  24.6%   969  452s
 13636   225     cutoff   29      13287.0056 16048.3338  20.8%   945  460s
 19035     0 13310.2936   65   32 13287.0056 13443.3483  1.18%   702  466s

Cutting planes:
  MIR: 331
  Flow cover: 884
  RLT: 6
  Relax-and-lift: 49

Explored 20273 nodes (13452529 simplex iterations) in 466.04 seconds (1328.69 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13287 13274.3 13264.9 ... 12945.7

Optimal solution found (tolerance 1.00e-06)
Best objective 1.328700561775e+04, best bound 1.328700561775e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 466.06s
  Master Objective (UB) = 13287.01, θ = 147797.26
  Upper Bound (UB) = 13287.01

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 147797.26
  [DEBUG]   ✓ Scenario 0: θ = 147797.26 ≤ Q = 147797.26 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 147797.26 ≤ Q = 147797.26 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 147797.26 ≤ Q = 147797.26 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1d9639ba
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1d9639ba
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-15, 2e+02]
Found heuristic solution: objective 1.412061e+13
Presolve removed 2559 rows and 1852 columns
Presolve time: 0.00s
Presolved: 534 rows, 537 columns, 1506 nonzeros
Found heuristic solution: objective 7745806.0116
Variable types: 363 continuous, 174 integer (174 binary)

Root relaxation: objective -1.408205e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140820.45    0  132 7745806.01 -140820.45   102%     -    0s
H    0     0                    -102077.4788 -140820.45  38.0%     -    0s
H    0     0                    -104302.7462 -140820.45  35.0%     -    0s
H    0     0                    -112319.5459 -140820.45  25.4%     -    0s
H    0     0                    -112543.8963 -126854.99  12.7%     -    0s
     0     0 -126854.99    0   73 -112543.90 -126854.99  12.7%     -    0s
H    0     0                    -123869.5233 -126746.88  2.32%     -    0s
     0     0 -126257.72    0   74 -123869.52 -126257.72  1.93%     -    0s
     0     0 -126246.36    0   74 -123869.52 -126246.36  1.92%     -    0s
H    0     0                    -124333.4193 -126246.36  1.54%     -    0s
     0     0 -125658.22    0   52 -124333.42 -125658.22  1.07%     -    0s
H    0     0                    -124484.3298 -125577.71  0.88%     -    0s
     0     0 -125577.71    0   51 -124484.33 -125577.71  0.88%     -    0s
     0     0 -125577.71    0   51 -124484.33 -125577.71  0.88%     -    0s
     0     0 -125577.71    0   52 -124484.33 -125577.71  0.88%     -    0s
     0     0 -125136.45    0   25 -124484.33 -125136.45  0.52%     -    0s
     0     0 -125068.29    0   30 -124484.33 -125068.29  0.47%     -    0s
     0     0 -125065.44    0   31 -124484.33 -125065.44  0.47%     -    0s
     0     0 -124885.70    0   17 -124484.33 -124885.70  0.32%     -    0s
     0     0 -124879.52    0   18 -124484.33 -124879.52  0.32%     -    0s
     0     0 -124794.93    0   18 -124484.33 -124794.93  0.25%     -    0s
     0     0 -124740.31    0   22 -124484.33 -124740.31  0.21%     -    0s
     0     0 -124738.15    0   21 -124484.33 -124738.15  0.20%     -    0s
     0     0 -124708.78    0   15 -124484.33 -124708.78  0.18%     -    0s
     0     0 -124708.78    0   17 -124484.33 -124708.78  0.18%     -    0s
H    0     0                    -124595.1952 -124704.59  0.09%     -    0s
     0     0 -124704.42    0   11 -124595.20 -124704.42  0.09%     -    0s
     0     0 -124680.65    0    9 -124595.20 -124680.65  0.07%     -    0s
     0     0 -124680.65    0   14 -124595.20 -124680.65  0.07%     -    0s
     0     0 -124627.86    0    5 -124595.20 -124627.86  0.03%     -    0s
     0     0 -124626.39    0    5 -124595.20 -124626.39  0.03%     -    0s
H    0     0                    -124596.7077 -124626.39  0.02%     -    0s
H    0     0                    -124625.2166 -124626.39  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 7
  Flow cover: 6

Explored 1 nodes (784 simplex iterations) in 0.06 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -124625 -124597 -124595 ... -102077
No other solutions better than -124625

Optimal solution found (tolerance 1.00e-06)
Best objective -1.246252166310e+05, best bound -1.246252166310e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 129252.41
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -124625.22
  [DEBUG]   S×d_nominal = 253877.63
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253877.63 + -124625.22 = 129252.41
  [DEBUG]   Current θ from Master = 147797.26
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18544.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5257.84
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3945.2181, Absolute Gap = 3945.2181, Relative Gap = 0.296923
  Not converged yet (gap = 3945.22 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178527 nonzeros
Model fingerprint: 0x2464025f
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -5257.84 (0.03s)
Loaded MIP start from previous solve with objective -5257.84

Presolve removed 25452 rows and 10332 columns
Presolve time: 0.56s
Presolved: 37091 rows, 16888 columns, 229339 nonzeros
Variable types: 14629 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 37091 rows, 16888 columns, 229339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52889    3.0700097e+04   0.000000e+00   5.364244e+07      5s
   67212    3.7955815e+04   0.000000e+00   5.055443e+05     10s
Concurrent spin time: 2.26s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.892112e+04, 36262 iterations, 12.20 seconds (24.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38921.1221    0  206 -5257.8375 38921.1221   840%     -   12s
H    0     0                    12387.904671 38921.1221   214%     -   13s
H    0     0                    12455.599577 38921.1221   212%     -   13s
     0     0 34350.3163    0  308 12455.5996 34350.3163   176%     -   17s
     0     0 33734.6553    0  300 12455.5996 33734.6553   171%     -   19s
     0     0 33734.3982    0  304 12455.5996 33734.3982   171%     -   19s
     0     0 33734.3982    0  306 12455.5996 33734.3982   171%     -   20s
     0     0 33734.3982    0  303 12455.5996 33734.3982   171%     -   20s
     0     0 33734.3982    0  301 12455.5996 33734.3982   171%     -   20s
     0     0 31365.1687    0  283 12455.5996 31365.1687   152%     -   25s
H    0     0                    12506.340083 31365.0975   151%     -   25s
H    0     0                    12590.558031 31365.0975   149%     -   25s
H    0     0                    12749.715862 31365.0975   146%     -   25s
H    0     0                    12757.034436 31365.0975   146%     -   25s
H    0     0                    12768.045096 31365.0975   146%     -   25s
H    0     0                    12768.570069 31365.0975   146%     -   25s
     0     0 30664.8414    0  352 12768.5701 30664.8414   140%     -   28s
     0     0 30546.6297    0  360 12768.5701 30546.6297   139%     -   30s
     0     0 30471.0057    0  320 12768.5701 30471.0057   139%     -   30s
     0     0 30449.2059    0  325 12768.5701 30449.2059   138%     -   31s
     0     0 30437.5420    0  323 12768.5701 30437.5420   138%     -   31s
     0     0 30425.3501    0  363 12768.5701 30425.3501   138%     -   32s
     0     0 30424.1268    0  360 12768.5701 30424.1268   138%     -   32s
     0     0 30423.1160    0  364 12768.5701 30423.1160   138%     -   32s
     0     0 30423.1095    0  364 12768.5701 30423.1095   138%     -   32s
     0     0 29228.2581    0  386 12768.5701 29228.2581   129%     -   38s
     0     0 28961.6995    0  410 12768.5701 28961.6995   127%     -   41s
     0     0 28875.7904    0  387 12768.5701 28875.7904   126%     -   42s
     0     0 28820.9474    0  352 12768.5701 28820.9474   126%     -   43s
     0     0 28797.0756    0  396 12768.5701 28797.0756   126%     -   44s
     0     0 28784.9527    0  361 12768.5701 28784.9527   125%     -   45s
     0     0 28781.2172    0  351 12768.5701 28781.2172   125%     -   45s
     0     0 28776.7164    0  398 12768.5701 28776.7164   125%     -   45s
     0     0 28776.5362    0  398 12768.5701 28776.5362   125%     -   45s
     0     0 28407.5562    0  363 12768.5701 28407.5562   122%     -   50s
     0     0 28260.8047    0  374 12768.5701 28260.8047   121%     -   52s
     0     0 28182.4923    0  386 12768.5701 28182.4923   121%     -   54s
     0     0 28152.0814    0  381 12768.5701 28152.0814   120%     -   54s
     0     0 28122.3213    0  391 12768.5701 28122.3213   120%     -   55s
     0     0 28102.2384    0  387 12768.5701 28102.2384   120%     -   55s
     0     0 28097.3875    0  384 12768.5701 28097.3875   120%     -   56s
     0     0 28095.8288    0  385 12768.5701 28095.8288   120%     -   56s
     0     0 28093.8130    0  388 12768.5701 28093.8130   120%     -   56s
     0     0 28093.1236    0  387 12768.5701 28093.1236   120%     -   56s
     0     0 28019.4453    0  437 12768.5701 28019.4453   119%     -   57s
     0     0 27980.7433    0  439 12768.5701 27980.7433   119%     -   59s
     0     0 27975.8465    0  440 12768.5701 27975.8465   119%     -   59s
     0     0 27972.2175    0  444 12768.5701 27972.2175   119%     -   59s
     0     0 27969.2483    0  437 12768.5701 27969.2483   119%     -   60s
     0     0 27968.7069    0  439 12768.5701 27968.7069   119%     -   60s
     0     0 27896.8250    0  386 12768.5701 27896.8250   118%     -   61s
H    0     0                    12782.290427 27869.4504   118%     -   62s
H    0     0                    12788.041701 27869.4504   118%     -   62s
H    0     0                    12795.114578 27869.4504   118%     -   62s
     0     0 27869.4504    0  440 12795.1146 27869.4504   118%     -   62s
     0     0 27840.5039    0  432 12795.1146 27840.5039   118%     -   63s
     0     0 27834.3629    0  441 12795.1146 27834.3629   118%     -   63s
     0     0 27833.4631    0  438 12795.1146 27833.4631   118%     -   63s
     0     0 27810.2944    0  411 12795.1146 27810.2944   117%     -   64s
     0     0 27806.1744    0  418 12795.1146 27806.1744   117%     -   65s
     0     0 27804.4570    0  421 12795.1146 27804.4570   117%     -   65s
     0     0 27803.6389    0  421 12795.1146 27803.6389   117%     -   65s
     0     0 27788.5518    0  418 12795.1146 27788.5518   117%     -   66s
     0     0 27783.6947    0  416 12795.1146 27783.6947   117%     -   66s
     0     0 27783.2580    0  413 12795.1146 27783.2580   117%     -   66s
     0     0 27777.8892    0  425 12795.1146 27777.8892   117%     -   67s
     0     0 27775.4686    0  413 12795.1146 27775.4686   117%     -   67s
     0     0 27774.9063    0  416 12795.1146 27774.9063   117%     -   68s
     0     0 27764.0909    0  460 12795.1146 27764.0909   117%     -   68s
     0     0 27762.0405    0  407 12795.1146 27762.0405   117%     -   69s
     0     0 27761.4579    0  452 12795.1146 27761.4579   117%     -   69s
     0     0 27755.2610    0  447 12795.1146 27755.2610   117%     -   70s
     0     0 27752.0565    0  447 12795.1146 27752.0565   117%     -   70s
     0     2 27750.3854    0  447 12795.1146 27750.3854   117%     -   79s
     1     4 27682.1894    1  474 12795.1146 27750.3275   117%  2124   81s
     7    16 27445.5272    3  478 12795.1146 27473.3149   115%  3773   89s
    15    32 27367.9340    4  485 12795.1146 27444.8308   114%  5029   92s
    31    48 26162.4712    5  381 12795.1146 27367.8125   114%  5338  100s
    47    80 24943.6125    6  386 12795.1146 27367.8125   114%  6375  106s
    79   144 24494.6789    7  366 12795.1146 27367.8125   114%  4724  114s
   143   273 24376.6560    9  350 12795.1146 27367.8125   114%  3699  118s
   272   366 24338.3709   10  398 12795.1146 27367.8125   114%  2530  121s
   369   394 24140.1464   11  396 12795.1146 27367.8125   114%  2181  128s
   403   437 23549.7457   10  288 12795.1146 27367.8125   114%  2117  131s
H  431   437                    12795.135559 27367.8125   114%  2046  131s
   487   502 24085.7038   12  333 12795.1356 27367.8125   114%  1972  136s
   525   537 23978.7890   13  385 12795.1356 27367.8125   114%  1926  142s
   566   570 23468.6184   14  335 12795.1356 27367.8125   114%  1860  145s
   645   647 23379.3998   18  361 12795.1356 27367.8125   114%  1776  150s
   782   774 23039.1251   21  321 12795.1356 27367.8125   114%  1671  158s
   870   868 22887.3084   21  306 12795.1356 27367.8125   114%  1599  162s
   935   928 22605.8852   23  227 12795.1356 27299.1203   113%  1542  165s
  1003   989 18426.0989   22  319 12795.1356 27299.1203   113%  1498  172s
  1112  1046 22367.6876   24  284 12795.1356 27299.1203   113%  1435  177s
  1185  1114 22085.2867   24  288 12795.1356 27299.1203   113%  1440  183s
  1287  1178 15348.7840   24  187 12795.1356 27299.1203   113%  1414  187s
  1377  1256 19641.0995   25  218 12795.1356 27299.1203   113%  1407  192s
  1489  1333 19599.0909   25  215 12795.1356 27299.1203   113%  1385  196s
  1608  1405 19496.5633   25  219 12795.1356 27299.1203   113%  1359  200s
  1726  1485 20690.8539   26  202 12795.1356 27299.1203   113%  1349  206s
  1857  1570 20291.9288   27  314 12795.1356 26707.7232   109%  1341  212s
  1974  1638 19612.9143   28  260 12795.1356 26707.7232   109%  1340  217s
  2076  1712 19281.5122   30  268 12795.1356 26707.7232   109%  1351  222s
  2173  1785 19218.8481   30  220 12795.1356 26707.7232   109%  1371  227s
  2276  1911 18863.4033   33  323 12795.1356 26707.7232   109%  1389  235s
  2436  2001 17611.5854   39  272 12795.1356 26707.7232   109%  1370  243s
H 2566  2001                    12812.701882 26707.7232   108%  1363  243s
  2577  2137 17498.7283   43  249 12812.7019 26707.7232   108%  1361  248s
  2732  2274 16376.3102   44  238 12812.7019 26707.7232   108%  1349  253s
  2919  2437 16788.6060   48  226 12812.7019 26707.7232   108%  1323  260s
  3382  2649 17633.2704   43  447 12812.7019 26707.7232   108%  1261  280s
  3384  2650 15408.3074   24  206 12812.7019 26707.7232   108%  1261  292s
  3385  2651 13786.1592   25  319 12812.7019 26707.7232   108%  1260  300s
  3387  2652 14932.1037   49  457 12812.7019 26707.7232   108%  1260  307s
  3389  2654 21965.7406   12  419 12812.7019 26707.7232   108%  1259  310s
  3393  2656 25021.5945   11  392 12812.7019 26707.7232   108%  1257  315s
  3399  2660 17297.3736   29  402 12812.7019 26707.7232   108%  1255  320s
  3406  2665 15315.7105   64  421 12812.7019 26707.7232   108%  1252  326s
  3410  2668 16078.3199   54  480 12812.7019 26707.7232   108%  1251  330s
  3415  2671 16889.0181   36  493 12812.7019 26707.7232   108%  1249  335s
  3420  2674 13285.2912   35  529 12812.7019 26707.7232   108%  1247  341s
  3423  2676 14137.8937   91  524 12812.7019 26707.7232   108%  1246  356s
  3424  2677 14709.6882   12  524 12812.7019 26707.7232   108%  1246  364s
  3425  2681 26707.7232   15  483 12812.7019 26707.7232   108%  1274  370s
  3427  2684 26707.7232   16  509 12812.7019 26707.7232   108%  1275  377s
  3431  2691 26658.3405   17  485 12812.7019 26707.7232   108%  1279  383s
  3439  2704 26280.7081   18  486 12812.7019 26656.9438   108%  1288  391s
  3455  2720 24526.0694   19  341 12812.7019 26279.7482   105%  1319  441s
  3476  2745 22984.2319   20  446 12812.7019 26279.7482   105%  1349  449s
  3508  2837 22882.8796   21  392 12812.7019 26279.7482   105%  1383  458s
  3613  2876 21560.1992   23  353 12812.7019 26279.7482   105%  1444  466s
  3689  2909 21481.8567   24  369 12812.7019 26279.7482   105%  1466  472s
  3761  2914 20964.1198   22  295 12812.7019 26279.7482   105%  1486  477s
  3794  2936 21116.6030   25  358 12812.7019 26279.7482   105%  1497  482s
  3831  2954 20874.0337   27  335 12812.7019 26279.7482   105%  1506  486s
  3873  2986 20414.7379   29  434 12812.7019 26279.7482   105%  1511  490s
  3926  3024 18573.4949   29  171 12812.7019 26279.7482   105%  1515  495s
  4003  3054 14991.3434   30  136 12812.7019 26279.7482   105%  1515  505s
  4154  3098 14219.0109   35  108 12812.7019 25909.2208   102%  1510  512s
  4226  3126 17486.7517   37  133 12812.7019 25909.2208   102%  1506  519s
  4306  3118 infeasible   39      12812.7019 25909.2208   102%  1506  524s
  4345  3128 17231.4566   37  148 12812.7019 25909.2208   102%  1514  530s
  4393  3140 15952.1829   39  315 12812.7019 25602.6497   100%  1521  536s
  4459  3157     cutoff   39      12812.7019 25602.6497   100%  1528  540s
  4542  3175 15140.1739   40  351 12812.7019 25264.1064  97.2%  1533  549s
  4631  3205 13669.6582   40   84 12812.7019 25264.1064  97.2%  1536  555s
  4731  3218 13661.8057   41   88 12812.7019 25044.8074  95.5%  1539  562s
  4829  3221 20278.5584   22  233 12812.7019 25044.8074  95.5%  1545  569s
  4932  3252 20057.7365   23  209 12812.7019 25044.8074  95.5%  1551  574s
  5032  3289 19630.1089   25  341 12812.7019 25044.8074  95.5%  1556  581s
  5146  3312 18881.9485   28  338 12812.7019 24810.6960  93.6%  1556  590s
  5275  3347 18398.6483   30  336 12812.7019 24810.6960  93.6%  1558  597s
  5414  3338 infeasible   33      12812.7019 24380.0816  90.3%  1558  603s
  5511  3366 17262.3135   36  277 12812.7019 24380.0816  90.3%  1555  610s
  5616  3405     cutoff   43      12812.7019 24004.1510  87.3%  1563  617s
  5731  3396 13623.7965   52  132 12812.7019 24004.1510  87.3%  1575  623s
  5769  3411 13527.0521   53  134 12812.7019 24004.1510  87.3%  1581  628s
  5807  3426 13200.6759   54  163 12812.7019 24004.1510  87.3%  1585  635s
  5845  3441 13125.0439   55  266 12812.7019 23842.9489  86.1%  1587  640s
  5886  3459 13117.6244   56  191 12812.7019 23542.0257  83.7%  1592  647s
  5930  3499 13040.8894   57  138 12812.7019 23542.0257  83.7%  1594  656s
H 5953  3356                    12812.859338 23542.0257  83.7%  1592  656s
H 6023  3205                    12901.061391 23542.0257  82.5%  1589  656s
  6025  3318 21663.1306   21  248 12901.0614 23542.0257  82.5%  1589  665s
  6223  3365     cutoff   25      12901.0614 23329.0338  80.8%  1586  674s
  6440  3410 16168.3405   28   98 12901.0614 23107.8796  79.1%  1577  683s
  6658  3398 21127.0568   25  368 12901.0614 23107.8796  79.1%  1574  693s
  6811  3462 19816.8489   27  254 12901.0614 23107.8796  79.1%  1574  703s
  7033  3466     cutoff   32      12901.0614 23107.8796  79.1%  1568  712s
  7290  3476 15837.9383   42  241 12901.0614 23086.0559  78.9%  1558  724s
  7494  3513 14440.6132   23  230 12901.0614 23086.0559  78.9%  1569  737s
  7726  3588 21425.7724   22  213 12901.0614 22714.3631  76.1%  1574  749s
  7983  3599 16908.2361   28  177 12901.0614 22521.7726  74.6%  1580  760s
  8276  3620 16335.4921   31  135 12901.0614 22521.7726  74.6%  1567  770s
H 8313  3486                    12922.291248 22521.7726  74.3%  1565  770s
  8624  3499 13325.2604   23  236 12922.2912 22442.6871  73.7%  1558  783s
  8903  3520 infeasible   24      12922.2912 22132.7074  71.3%  1567  797s
  9176  3526 17646.8220   26  454 12922.2912 21971.4089  70.0%  1580  809s
  9513  3563 17246.5293   29  412 12922.2912 21971.4089  70.0%  1578  822s
  9857  3575 14642.8609   35  164 12922.2912 21971.4089  70.0%  1566  835s
 10262  3625 15721.2450   24  357 12922.2912 21971.4089  70.0%  1563  849s
 10656  3692     cutoff   30      12922.2912 21614.8661  67.3%  1565  864s
 11036  3781 16253.9172   27  409 12922.2912 21334.3236  65.1%  1571  879s
 11426  3889 14812.8853   36  272 12922.2912 21237.1926  64.3%  1571  894s
 11875  4032 14010.8751   33  211 12922.2912 21069.0528  63.0%  1571  911s
 12329  4131     cutoff   34      12922.2912 20980.0557  62.4%  1573  927s
 12803  4309 13559.3041   29  360 12922.2912 20963.3227  62.2%  1576  943s
 13261  4525 14807.2325   30  341 12922.2912 20695.4740  60.2%  1581  960s
 13792  4723 17014.5634   28  302 12922.2912 20574.1694  59.2%  1578  978s
 14377  4905 17795.4840   23  327 12922.2912 20337.9081  57.4%  1573  995s
 14915  5030 14726.6008   29  333 12922.2912 20267.7272  56.8%  1574 1020s
 15432  5176 17672.6476   26  498 12922.2912 20126.5220  55.8%  1576 1040s
 16081  5386     cutoff   29      12922.2912 20014.9744  54.9%  1573 1060s
 16760  5668 16648.6339   27  327 12922.2912 19715.1217  52.6%  1569 1080s
 17563  5835 15554.6913   30  390 12922.2912 19568.1150  51.4%  1556 1103s
 18297  5942 13964.2926   31  228 12922.2912 19428.0099  50.3%  1552 1126s
 18915  6024 13223.4770   31  345 12922.2912 19261.1933  49.1%  1561 1151s
 19588  6205 14245.2093   24  463 12922.2912 19107.9430  47.9%  1566 1174s
 20385  6378 13013.0250   27  259 12922.2912 18934.5747  46.5%  1564 1200s
 21271  6543     cutoff   27      12922.2912 18833.3426  45.7%  1557 1228s
 22154  6687 13689.4774   36  267 12922.2912 18669.8933  44.5%  1553 1257s
 23120  6693 13178.0458   35  261 12922.2912 18546.7332  43.5%  1545 1278s
 23238  6843 13842.3693   35  284 12922.2912 18494.8106  43.1%  1546 1302s
 23912  6989 15243.8666   34  323 12922.2912 18389.6709  42.3%  1542 1331s
 24901  7106 16291.9707   31  259 12922.2912 18247.4284  41.2%  1536 1360s
 25944  7181 15613.4808   23  408 12922.2912 18115.1441  40.2%  1533 1389s
 27139  7302 13252.2430   32  305 12922.2912 17978.6996  39.1%  1523 1421s
*28341  7297              45    12937.381736 17808.3209  37.7%  1516 1421s
 28369  7427 15874.1785   30  149 12937.3817 17808.3209  37.7%  1516 1451s
H28496  7280                    13209.790576 17808.3209  34.8%  1515 1451s
 29629  7243 14178.6823   33  113 13209.7906 17580.4928  33.1%  1505 1486s
 31071  7207 14632.0740   31  250 13209.7906 17386.8007  31.6%  1497 1514s
 32248  7125 infeasible   29      13209.7906 17165.4133  29.9%  1490 1545s
 33641  6965     cutoff   39      13209.7906 16983.2881  28.6%  1475 1574s
 34867  6763 13371.1521   32  131 13209.7906 16851.5305  27.6%  1467 1605s
 36232  6342 14294.8842   45  148 13209.7906 16647.6401  26.0%  1455 1637s
 37841  5911     cutoff   37      13209.7906 16377.5135  24.0%  1439 1670s
 39577  5291 14261.3591   34  246 13209.7906 16105.5831  21.9%  1420 1700s
 41415  4490     cutoff   40      13209.7906 15827.0661  19.8%  1401 1732s
 43507  3427     cutoff   35      13209.7906 15613.7648  18.2%  1376 1764s
 45842  1730 infeasible   41      13209.7906 15113.6304  14.4%  1346 1794s
 48749   410     cutoff   30      13209.7906 14610.9911  10.6%  1298 1815s
*52723   410              79    13220.357636 14498.2989  9.67%  1211 1815s
*52724   410              78    13221.534084 14498.2989  9.66%  1211 1815s
H53974     0                    13236.473757 13377.9792  1.07%  1187 1818s

Cutting planes:
  Learned: 1
  MIR: 722
  Mixing: 2
  Flow cover: 1772
  RLT: 13
  Relax-and-lift: 75

Explored 55492 nodes (64281458 simplex iterations) in 1818.37 seconds (5934.69 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13236.5 13221.5 13220.4 ... 12795.1

Optimal solution found (tolerance 1.00e-06)
Best objective 1.323647375682e+04, best bound 1.323647375682e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 1818.39s
  Master Objective (UB) = 13236.47, θ = 153330.94
  Upper Bound (UB) = 13236.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 153330.94
  [DEBUG]   ✓ Scenario 0: θ = 153330.94 ≤ Q = 153330.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 153330.94 ≤ Q = 153330.94 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 153330.94 ≤ Q = 153333.06 (slack: 2.12)
  [DEBUG]   ✓ Scenario 3: θ = 153330.94 ≤ Q = 153330.94 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x56f2ae09
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x56f2ae09
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.461673e+13
Presolve removed 2566 rows and 1858 columns
Presolve time: 0.00s
Presolved: 527 rows, 531 columns, 1487 nonzeros
Found heuristic solution: objective 7998287.6430
Variable types: 358 continuous, 173 integer (173 binary)
Found heuristic solution: objective 7997915.7096

Root relaxation: objective -1.496574e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -149657.44    0  128 7997915.71 -149657.44   102%     -    0s
H    0     0                    -121452.2417 -149657.44  23.2%     -    0s
H    0     0                    -125947.0664 -136433.61  8.33%     -    0s
     0     0 -136433.61    0   94 -125947.07 -136433.61  8.33%     -    0s
H    0     0                    -132410.0519 -136317.23  2.95%     -    0s
     0     0 -136063.75    0   93 -132410.05 -136063.75  2.76%     -    0s
H    0     0                    -133414.2316 -136063.75  1.99%     -    0s
     0     0 -135276.30    0   93 -133414.23 -135276.30  1.40%     -    0s
     0     0 -135229.72    0   96 -133414.23 -135229.72  1.36%     -    0s
     0     0 -135218.92    0   96 -133414.23 -135218.92  1.35%     -    0s
     0     0 -135218.92    0   95 -133414.23 -135218.92  1.35%     -    0s
H    0     0                    -133545.1923 -134851.18  0.98%     -    0s
     0     0 -134851.18    0   62 -133545.19 -134851.18  0.98%     -    0s
     0     0 -134772.63    0   56 -133545.19 -134772.63  0.92%     -    0s
     0     0 -134772.52    0   56 -133545.19 -134772.52  0.92%     -    0s
     0     0 -134451.83    0   52 -133545.19 -134451.83  0.68%     -    0s
     0     0 -134376.65    0   53 -133545.19 -134376.65  0.62%     -    0s
     0     0 -134095.40    0   28 -133545.19 -134095.40  0.41%     -    0s
     0     0 -134086.98    0   28 -133545.19 -134086.98  0.41%     -    0s
     0     0 -133931.05    0   16 -133545.19 -133931.05  0.29%     -    0s
H    0     0                    -133584.9945 -133930.74  0.26%     -    0s
     0     0 -133890.83    0   13 -133584.99 -133890.83  0.23%     -    0s
     0     0 -133886.29    0   17 -133584.99 -133886.29  0.23%     -    0s
     0     0 -133784.80    0   16 -133584.99 -133784.80  0.15%     -    0s
     0     0 -133784.80    0   52 -133584.99 -133784.80  0.15%     -    0s
     0     0 -133784.80    0   49 -133584.99 -133784.80  0.15%     -    0s
     0     0 -133784.80    0   49 -133584.99 -133784.80  0.15%     -    0s
H    0     0                    -133621.1030 -133784.80  0.12%     -    0s
     0     0 -133658.53    0   13 -133621.10 -133658.53  0.03%     -    0s
     0     0 -133654.73    0    8 -133621.10 -133654.73  0.03%     -    0s
H    0     0                    -133624.8477 -133650.73  0.02%     -    0s
     0     0 -133650.24    0    8 -133624.85 -133650.24  0.02%     -    0s
     0     0 -133639.28    0    5 -133624.85 -133639.28  0.01%     -    0s
H    0     0                    -133637.5553 -133639.28  0.00%     -    0s
     0     0 -133637.84    0    3 -133637.56 -133637.84  0.00%     -    0s
     0     0     cutoff    0      -133637.56 -133637.56  0.00%     -    0s

Explored 1 nodes (996 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -133638 -133625 -133621 ... 7.99792e+06
No other solutions better than -133638

Optimal solution found (tolerance 1.00e-06)
Best objective -1.336375552715e+05, best bound -1.336375552715e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 131790.31
  Scenario: 44 demand increases, 16 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133637.56
  [DEBUG]   S×d_nominal = 265427.87
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 265427.87 + -133637.56 = 131790.31
  [DEBUG]   Current θ from Master = 153330.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21540.63 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8304.15
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3894.6862, Absolute Gap = 3894.6862, Relative Gap = 0.294239
  Not converged yet (gap = 3894.69 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 44 increases, 16 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221779 nonzeros
Model fingerprint: 0x5377eee3
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 31815 rows and 12915 columns
Presolve time: 0.70s
Presolved: 46018 rows, 20545 columns, 285294 nonzeros
Variable types: 18286 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 46018 rows, 20545 columns, 285294 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34474    1.5578917e+04   0.000000e+00   1.078686e+07      5s
   47096    3.0944326e+04   0.000000e+00   7.317103e+06     10s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.850034e+04, 27424 iterations, 9.24 seconds (18.74 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38500.3441    0  206 -219144.29 38500.3441   118%     -   10s
H    0     0                    -212888.7365 38500.3441   118%     -   10s
H    0     0                    -186780.9921 38500.3441   121%     -   10s
H    0     0                    -185064.8491 38500.3441   121%     -   10s
H    0     0                    -182106.1955 38500.3441   121%     -   10s
H    0     0                    -181996.7629 38500.3441   121%     -   10s
H    0     0                    -181792.8949 38500.3441   121%     -   10s
H    0     0                    -66934.47220 38500.3441   158%     -   10s
H    0     0                    -66832.30996 38500.3441   158%     -   11s
H    0     0                    -41673.58287 38500.3441   192%     -   11s
H    0     0                    -25152.22157 38500.3441   253%     -   11s
H    0     0                    -16932.28854 38500.3441   327%     -   11s
H    0     0                    -15301.98221 38500.3441   352%     -   11s
H    0     0                    -12873.05935 38500.3441   399%     -   11s
H    0     0                    -7349.972853 38500.3441   624%     -   11s
     0     0 34196.2660    0  306 -7349.9729 34196.2660   565%     -   16s
H    0     0                    -4010.805025 34196.1147   953%     -   16s
H    0     0                    -4009.165108 34196.1147   953%     -   16s
H    0     0                    -3434.675007 34196.1147  1096%     -   16s
H    0     0                    -3410.685514 34196.1147  1103%     -   16s
H    0     0                    -3406.511639 34196.1147  1104%     -   16s
H    0     0                    -2818.349355 33914.1242  1303%     -   18s
H    0     0                    -2164.843559 33914.1242  1667%     -   18s
     0     0 33914.1242    0  129 -2164.8436 33914.1242  1667%     -   18s
     0     0 33608.7827    0  297 -2164.8436 33608.7827  1652%     -   20s
     0     0 33435.0151    0  299 -2164.8436 33435.0151  1644%     -   23s
     0     0 33435.0151    0  305 -2164.8436 33435.0151  1644%     -   23s
     0     0 33435.0151    0  309 -2164.8436 33435.0151  1644%     -   23s
     0     0 33434.9405    0  309 -2164.8436 33434.9405  1644%     -   23s
H    0     0                    7401.7599230 31052.8736   320%     -   29s
H    0     0                    7818.4710870 31052.8736   297%     -   29s
H    0     0                    7955.3381478 31052.8736   290%     -   29s
H    0     0                    8215.5362560 31052.8736   278%     -   29s
H    0     0                    9101.9349220 31052.8736   241%     -   29s
H    0     0                    9108.6530695 31052.8736   241%     -   29s
H    0     0                    9201.7561575 31052.8736   237%     -   29s
H    0     0                    9236.6628528 31052.8736   236%     -   29s
     0     0 31052.8736    0  263 9236.66285 31052.8736   236%     -   29s
     0     0 30472.0571    0  282 9236.66285 30472.0571   230%     -   32s
     0     0 30352.7852    0  284 9236.66285 30352.7852   229%     -   35s
     0     0 30325.2068    0  290 9236.66285 30325.2068   228%     -   36s
     0     0 30325.0878    0  288 9236.66285 30325.0878   228%     -   36s
     0     0 29171.8928    0  259 9236.66285 29171.8928   216%     -   45s
H    0     0                    9266.9520066 29171.6931   215%     -   45s
     0     0 28820.4281    0  326 9266.95201 28820.4281   211%     -   49s
     0     0 28716.7290    0  281 9266.95201 28716.7290   210%     -   50s
     0     0 28684.4763    0  346 9266.95201 28684.4763   210%     -   51s
     0     0 28649.9841    0  340 9266.95201 28649.9841   209%     -   52s
     0     0 28619.0327    0  295 9266.95201 28619.0327   209%     -   53s
H    0     0                    9334.4999919 28575.6390   206%     -   54s
H    0     0                    9343.6012094 28575.6390   206%     -   54s
H    0     0                    9372.5522078 28575.6390   205%     -   54s
     0     0 28575.6390    0  336 9372.55221 28575.6390   205%     -   54s
     0     0 28567.0872    0  345 9372.55221 28567.0872   205%     -   54s
     0     0 28553.1674    0  345 9372.55221 28553.1674   205%     -   55s
     0     0 28549.5533    0  344 9372.55221 28549.5533   205%     -   55s
     0     0 28548.8204    0  337 9372.55221 28548.8204   205%     -   55s
     0     0 28016.7361    0  353 9372.55221 28016.7361   199%     -   64s
H    0     0                    9381.8827962 28016.4795   199%     -   65s
     0     0 27723.9281    0  362 9381.88280 27723.9281   196%     -   68s
     0     0 27670.4394    0  367 9381.88280 27670.4394   195%     -   69s
     0     0 27643.7857    0  368 9381.88280 27643.7857   195%     -   69s
     0     0 27612.6899    0  364 9381.88280 27612.6899   194%     -   70s
     0     0 27595.1879    0  365 9381.88280 27595.1879   194%     -   70s
     0     0 27583.4810    0  373 9381.88280 27583.4810   194%     -   71s
     0     0 27579.1801    0  370 9381.88280 27579.1801   194%     -   71s
     0     0 27569.0006    0  374 9381.88280 27569.0006   194%     -   71s
     0     0 27567.4686    0  379 9381.88280 27567.4686   194%     -   72s
     0     0 27567.3649    0  375 9381.88280 27567.3649   194%     -   72s
     0     0 27440.0574    0  376 9381.88280 27440.0574   192%     -   75s
H    0     0                    9416.0994587 27439.3000   191%     -   75s
     0     0 27421.7185    0  327 9416.09946 27421.7185   191%     -   76s
     0     0 27418.2205    0  369 9416.09946 27418.2205   191%     -   77s
     0     0 27413.0698    0  383 9416.09946 27413.0698   191%     -   77s
     0     0 27409.8847    0  378 9416.09946 27409.8847   191%     -   77s
     0     0 27408.7459    0  394 9416.09946 27408.7459   191%     -   77s
     0     0 27356.1261    0  386 9416.09946 27356.1261   191%     -   79s
     0     0 27298.4401    0  369 9416.09946 27298.4401   190%     -   81s
     0     0 27286.3572    0  433 9416.09946 27286.3572   190%     -   82s
     0     0 27279.9895    0  371 9416.09946 27279.9895   190%     -   82s
     0     0 27277.0854    0  434 9416.09946 27277.0854   190%     -   82s
     0     0 27274.1201    0  441 9416.09946 27274.1201   190%     -   83s
     0     0 27273.9432    0  440 9416.09946 27273.9432   190%     -   83s
     0     0 27243.0795    0  434 9416.09946 27243.0795   189%     -   85s
     0     0 27226.0745    0  387 9416.09946 27226.0745   189%     -   85s
     0     0 27219.3141    0  417 9416.09946 27219.3141   189%     -   86s
     0     0 27215.9854    0  436 9416.09946 27215.9854   189%     -   86s
     0     0 27214.3251    0  447 9416.09946 27214.3251   189%     -   87s
     0     0 27213.2626    0  411 9416.09946 27213.2626   189%     -   87s
     0     0 27194.4693    0  357 9416.09946 27194.4693   189%     -   88s
     0     0 27182.3198    0  459 9416.09946 27182.3198   189%     -   89s
     0     0 27177.1949    0  357 9416.09946 27177.1949   189%     -   90s
     0     0 27175.3005    0  450 9416.09946 27175.3005   189%     -   90s
     0     0 27173.3065    0  355 9416.09946 27173.3065   189%     -   90s
     0     0 27172.7269    0  462 9416.09946 27172.7269   189%     -   90s
     0     0 27158.0221    0  395 9416.09946 27158.0221   188%     -   91s
     0     0 27147.6787    0  480 9416.09946 27147.6787   188%     -   92s
     0     0 27145.2591    0  489 9416.09946 27145.2591   188%     -   92s
     0     0 27143.2211    0  490 9416.09946 27143.2211   188%     -   93s
     0     0 27142.0441    0  489 9416.09946 27142.0441   188%     -   93s
     0     0 27130.9282    0  425 9416.09946 27130.9282   188%     -   94s
     0     0 27125.9860    0  463 9416.09946 27125.9860   188%     -   96s
     0     0 27123.8191    0  420 9416.09946 27123.8191   188%     -   96s
     0     0 27123.2888    0  465 9416.09946 27123.2888   188%     -   96s
     0     0 27114.3006    0  463 9416.09946 27114.3006   188%     -   97s
     0     0 27113.5163    0  466 9416.09946 27113.5163   188%     -   98s
     0     0 27111.1385    0  416 9416.09946 27111.1385   188%     -   99s
     0     0 27110.1221    0  407 9416.09946 27110.1221   188%     -   99s
     0     0 27105.3287    0  461 9416.09946 27105.3287   188%     -  100s
     0     0 27104.3201    0  465 9416.09946 27104.3201   188%     -  101s
     0     0 27102.1211    0  482 9416.09946 27102.1211   188%     -  102s
     0     0 27101.6476    0  465 9416.09946 27101.6476   188%     -  102s
     0     0 27100.5808    0  413 9416.09946 27100.5808   188%     -  103s
     0     0 27098.6424    0  413 9416.09946 27098.6424   188%     -  103s
     0     2 27098.6424    0  413 9416.09946 27098.6424   188%     -  116s
     3     8 26693.5586    2  480 9416.09946 27042.9700   187%  2652  122s
     7    16 26524.8385    3  482 9416.09946 26909.2430   186%  3523  126s
    15    32 26209.8703    4  483 9416.09946 26630.6409   183%  4086  133s
    31    48 25825.4370    5  401 9416.09946 26375.2011   180%  6768  143s
    47    80 24688.5483    6  429 9416.09946 26375.2011   180%  6128  150s
H   61    80                    9438.1134441 26375.2011   179%  5914  150s
    79   143 24558.7555    7  362 9438.11344 26375.2011   179%  5018  164s
H  107   143                    9796.1082434 26375.2011   169%  4093  164s
   142   285 24274.5368    9  362 9796.10824 26375.2011   169%  3498  171s
H  146   285                    9865.2216086 26375.2011   167%  3448  171s
H  168   285                    9922.7625884 26375.2011   166%  3287  171s
H  203   285                    9960.6670544 26375.2011   165%  2919  171s
   284   385 24239.6482   10  340 9960.66705 26375.2011   165%  2498  175s
   384   463 23355.3638   12  336 9960.66705 26375.2011   165%  2196  180s
   464   540 23503.2621   11  328 9960.66705 26375.2011   165%  2135  185s
   543   572 18996.8853   12  340 9960.66705 26375.2011   165%  2062  191s
   575   610 19346.3097   13  305 9960.66705 26375.2011   165%  2035  196s
H  597   610                    9976.9428171 26375.2011   164%  1991  196s
H  617   610                    9994.9556005 26375.2011   164%  1972  196s
   621   631 23206.6913   13  324 9994.95560 26375.2011   164%  1966  203s
H  636   631                    10008.664469 26375.2011   164%  1946  203s
   660   691 23692.1958   13  288 10008.6645 26375.2011   164%  1924  210s
   741   720 22806.4775   13  333 10008.6645 26375.2011   164%  1878  215s
H  766   720                    11451.741405 26375.2011   130%  1882  215s
   774   754 18482.8512   13  349 11451.7414 26375.2011   130%  1885  222s
   856   783 23482.8380   14  292 11451.7414 26375.2011   130%  1840  228s
H  864   783                    11801.455361 26375.2011   123%  1840  228s
H  865   783                    12165.307210 26375.2011   117%  1838  228s
   889   828 22621.8704   15  367 12165.3072 26375.2011   117%  1864  235s
   960   854 22447.7368   16  379 12165.3072 26375.2011   117%  1857  242s
H  965   854                    12195.936478 26375.2011   116%  1863  242s
H  974   854                    12469.618796 26375.2011   112%  1854  242s
H  979   854                    12600.273051 26375.2011   109%  1852  242s
  1000   914 22027.7028   17  384 12600.2731 26375.2011   109%  1856  249s
  1099   957 21273.5136   18  371 12600.2731 26375.2011   109%  1832  256s
  1180  1032 19796.5189   17  345 12600.2731 26375.2011   109%  1845  261s
  1289  1112 19649.9628   19  391 12600.2731 26375.2011   109%  1805  267s
  1391  1204 14785.8734   18  274 12600.2731 26270.8680   108%  1800  273s
  1500  1284 19159.5228   19  225 12600.2731 26269.1543   108%  1783  280s
  1627  1358 19583.0308   20  329 12600.2731 26269.1543   108%  1744  287s
  1753  1408 17496.8933   21  322 12600.2731 26269.1543   108%  1730  296s
  1859  1491 18250.1668   22  325 12600.2731 26269.1543   108%  1732  304s
  1973  1567 17595.8600   23  316 12600.2731 25777.3317   105%  1739  309s
  2077  1634 16099.7958   25  247 12600.2731 25777.3317   105%  1757  318s
H 2089  1634                    12609.450739 25777.3317   104%  1761  318s
  2196  1728 17414.8763   24  318 12609.4507 25777.3317   104%  1751  325s
  2334  1792 15127.0517   24  370 12609.4507 25476.7704   102%  1753  333s
H 2338  1792                    12788.157893 25476.7704  99.2%  1755  333s
H 2347  1792                    12913.333960 25476.7704  97.3%  1751  333s
H 2370  1792                    13091.663232 25476.7704  94.6%  1748  333s
H 2412  1792                    13195.174372 25460.5854  93.0%  1747  333s
  2416  1845 14732.0585   25  231 13195.1744 25460.5854  93.0%  1747  342s
  2581  1921 15071.7773   27  130 13195.1744 25460.5854  93.0%  1727  350s
  2744  2010 14815.0183   28  121 13195.1744 25416.7202  92.6%  1719  358s
H 2899  2073                    13200.459988 25406.6919  92.5%  1722  366s
H 2899  2073                    13204.504960 25406.6919  92.4%  1722  366s
H 2912  2073                    13209.790576 25406.6919  92.3%  1728  366s
  2993  2220     cutoff   35      13209.7906 25370.6162  92.1%  1728  377s
  3184  2323     cutoff   51      13209.7906 25370.6162  92.1%  1715  386s
  3353  2352 23934.7107    9  414 13209.7906 25312.3676  91.6%  1720  392s
  3388  2424 23035.7135   10  307 13209.7906 25312.3676  91.6%  1727  400s
  3474  2526 21934.5288   11  285 13209.7906 25312.3676  91.6%  1723  411s
  3619  2527 23633.8963    9  413 13209.7906 25312.3676  91.6%  1705  434s
  3621  2528 19805.9649   27  206 13209.7906 25312.3676  91.6%  1704  449s
  3622  2529 14627.3189   24  402 13209.7906 25312.3676  91.6%  1704  461s
  3623  2530 21154.0829   15  389 13209.7906 25312.3676  91.6%  1703  468s
  3624  2530 24367.1660    8  363 13209.7906 25312.3676  91.6%  1703  472s
  3625  2531 18577.7467   22  396 13209.7906 25312.3676  91.6%  1702  476s
  3627  2532 21852.7717   16  444 13209.7906 25312.3676  91.6%  1702  480s
  3633  2536 17639.5022   16  469 13209.7906 25312.3676  91.6%  1699  485s
  3636  2538 14399.2557   50  425 13209.7906 25312.3676  91.6%  1697  490s
  3637  2539 14319.1098   52  477 13209.7906 25312.3676  91.6%  1697  495s
  3640  2541 20797.7733   14  482 13209.7906 25312.3676  91.6%  1695  500s
  3643  2543 18057.9130   25  419 13209.7906 25312.3676  91.6%  1694  505s
  3646  2545 15504.9661   37  416 13209.7906 25312.3676  91.6%  1693  510s
  3649  2547 24129.6048   12  428 13209.7906 25312.3676  91.6%  1691  515s
  3652  2549 13766.8217   30  474 13209.7906 25312.3676  91.6%  1690  521s
  3653  2550 21250.1095   21  474 13209.7906 25312.3676  91.6%  1689  535s
  3654  2550 16346.7194   23  474 13209.7906 25312.3676  91.6%  1689  549s
  3655  2554 25312.3676   13  501 13209.7906 25312.3676  91.6%  1719  558s
  3657  2557 25312.3676   14  504 13209.7906 25312.3676  91.6%  1720  567s
  3661  2564 25312.3676   15  491 13209.7906 25312.3676  91.6%  1723  573s
  3669  2577 25312.3676   16  504 13209.7906 25312.3676  91.6%  1733  584s
  3685  2588 23875.5737   17  438 13209.7906 25312.3676  91.6%  1759  601s
  3701  2615 23750.9987   18  334 13209.7906 25312.3676  91.6%  1782  613s
  3733  2636 22425.6018   19  446 13209.7906 25312.3676  91.6%  1803  621s
  3765  2665 21704.3726   20  398 13209.7906 25312.3676  91.6%  1848  631s
  3805  2747 21578.6086   20  320 13209.7906 25312.3676  91.6%  1876  642s
  3910  2796 20995.4073   21  264 13209.7906 25312.3676  91.6%  1887  650s
  4026  2810 17108.3096   21  309 13209.7906 25312.3676  91.6%  1886  658s
  4122  2834 19318.0032   22  347 13209.7906 25312.3676  91.6%  1888  667s
  4200  2867 19822.7224   22  264 13209.7906 25312.3676  91.6%  1892  676s
  4296  2872 20297.5264   23  270 13209.7906 25312.3676  91.6%  1884  684s
  4366  2888 19225.8155   23  266 13209.7906 25312.3676  91.6%  1888  692s
  4453  2880 17480.1999   24  267 13209.7906 25312.3676  91.6%  1881  700s
  4527  2896 17218.1852   25  283 13209.7906 25312.3676  91.6%  1874  709s
  4611  2899 17176.3626   26  265 13209.7906 25312.3676  91.6%  1875  717s
  4683  2894 15743.0521   28  216 13209.7906 25312.3676  91.6%  1875  725s
  4759  2903 15411.8085   27  218 13209.7906 25312.3676  91.6%  1879  732s
  4846  2907 19556.5541   22  381 13209.7906 25312.3676  91.6%  1882  741s
  4937  2904 19427.6901   23  380 13209.7906 25312.3676  91.6%  1890  747s
  4972  2924 19266.9760   24  415 13209.7906 24798.1975  87.7%  1904  754s
  5021  2932 19016.9321   25  328 13209.7906 24798.1975  87.7%  1915  760s
  5059  2946 18718.1480   26  252 13209.7906 24798.1975  87.7%  1920  768s
  5112  2945 18034.1408   27  290 13209.7906 24798.1975  87.7%  1922  776s
  5177  2958 16634.7823   28  305 13209.7906 24798.1975  87.7%  1927  784s
  5261  2978 15736.4151   29  199 13209.7906 24798.1975  87.7%  1930  793s
  5341  3018 15444.4532   30  193 13209.7906 23912.0499  81.0%  1934  804s
  5467  3040 15104.3220   33  205 13209.7906 23912.0499  81.0%  1937  816s
  5577  3042 infeasible   38      13209.7906 23912.0499  81.0%  1943  827s
  5710  3049 20845.3406   20  347 13209.7906 23637.0333  78.9%  1945  837s
  5826  3082 20251.8719   22  370 13209.7906 23296.3038  76.4%  1963  848s
  5940  3126 18852.5907   26  314 13209.7906 23296.3038  76.4%  1976  859s
  6085  3157 17768.8487   31  140 13209.7906 23296.3038  76.4%  1979  870s
  6247  3170     cutoff   37      13209.7906 23296.3038  76.4%  1978  883s
  6456  3142 13563.5446   45  109 13209.7906 23240.9026  75.9%  1966  895s
  6600  3160 15591.3390   22  421 13209.7906 23240.9026  75.9%  1980  907s
  6755  3196 15399.5830   23  353 13209.7906 21930.0323  66.0%  1989  920s
  6942  3217     cutoff   24      13209.7906 21930.0323  66.0%  1991  934s
  7131  3205 13680.5069   25  390 13209.7906 21883.9429  65.7%  1996  947s
  7290  3234 13550.0960   27  334 13209.7906 21869.5289  65.6%  2000  961s
  7497  3228 14220.8179   24  287 13209.7906 21869.5289  65.6%  2007  977s
  7732  3233 15581.2381   25  328 13209.7906 21742.7668  64.6%  2009  994s
  7948  3223     cutoff   28      13209.7906 21606.8393  63.6%  2020 1010s
  8188  3278 18815.3835   21  452 13209.7906 21258.4125  60.9%  2026 1026s
  8449  3298 16387.4206   28  228 13209.7906 21160.4332  60.2%  2029 1041s
  8722  3366 13988.8131   35  182 13209.7906 21049.7388  59.3%  2022 1058s
  9008  3422 13687.7851   30  106 13209.7906 21004.1600  59.0%  2024 1076s
  9353  3409 18263.2808   22  299 13209.7906 21004.1600  59.0%  2018 1094s
  9672  3431 16542.4090   26  247 13209.7906 20953.1835  58.6%  2022 1112s
 10008  3439 16918.5750   23  409 13209.7906 20575.6767  55.8%  2025 1133s
 10381  3405     cutoff   25      13209.7906 20450.8503  54.8%  2020 1151s
 10721  3448 18899.4328   22  314 13209.7906 20435.0070  54.7%  2019 1171s
 11146  3440 16345.4971   33  225 13209.7906 20322.0983  53.8%  2013 1191s
 11578  3531 14281.4591   30  256 13209.7906 20158.8727  52.6%  2008 1215s
 11994  3699 15635.8605   25  250 13209.7906 20016.6996  51.5%  2011 1236s
 12429  3758     cutoff   29      13209.7906 19857.4998  50.3%  2012 1262s
 12876  3901 16399.3973   25  232 13209.7906 19613.5293  48.5%  2017 1285s
 13409  4014 14613.1550   22  450 13209.7906 19581.4539  48.2%  2008 1310s
 13928  4172 14533.3013   29  164 13209.7906 19461.3101  47.3%  2002 1335s
 14500  4296 16496.9891   26  267 13209.7906 19450.2065  47.2%  1995 1363s
 15107  4430 15603.2714   32  115 13209.7906 19207.2183  45.4%  1986 1389s
 15741  4574 14819.0683   29  107 13209.7906 19037.9891  44.1%  1978 1416s
 16316  4637 14259.2852   29  323 13209.7906 18893.2745  43.0%  1981 1441s
 16674  4701     cutoff   31      13209.7906 18884.2322  43.0%  1982 1469s
 17374  4766 13536.1649   36  164 13209.7906 18690.0902  41.5%  1973 1498s
 18033  4835     cutoff   28      13209.7906 18622.3095  41.0%  1974 1529s
 18688  4904 14242.8121   27  164 13209.7906 18411.0049  39.4%  1976 1562s
 19424  4960 13858.4253   27  185 13209.7906 18181.4841  37.6%  1975 1597s
 20284  5046     cutoff   28      13209.7906 17993.8745  36.2%  1964 1630s
 21122  5005 14854.8538   26  345 13209.7906 17809.4789  34.8%  1959 1667s
 21899  4958     cutoff   28      13209.7906 17695.2225  34.0%  1962 1704s
 22844  4912 15569.5738   23  291 13209.7906 17508.5042  32.5%  1954 1745s
 23785  4790 14717.8769   25  333 13209.7906 17257.7751  30.6%  1948 1785s
 24844  4625     cutoff   32      13209.7906 17023.0711  28.9%  1936 1826s
 25923  4410 14015.9874   34  276 13209.7906 16874.0270  27.7%  1926 1869s
 27084  4033 13578.8470   32  248 13209.7906 16589.3798  25.6%  1912 1911s
 28232  3491     cutoff   33      13209.7906 16295.2879  23.4%  1902 1955s
 29606  2791 14137.7661   20  265 13209.7906 15986.3942  21.0%  1882 1998s
 31124  1546     cutoff   31      13209.7906 15565.6555  17.8%  1856 2037s
 33142    15     cutoff   28      13209.7906 15094.6051  14.3%  1801 2071s

Cutting planes:
  Learned: 1
  MIR: 749
  Mixing: 2
  Flow cover: 1497
  RLT: 14
  Relax-and-lift: 89

Explored 35101 nodes (60839184 simplex iterations) in 2072.60 seconds (6584.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 13209.8 13209.8 13204.5 ... 12600.3

Optimal solution found (tolerance 1.00e-06)
Best objective 1.320979057606e+04, best bound 1.320979057606e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2072.62s
  Master Objective (UB) = 13209.79, θ = 160772.18
  Upper Bound (UB) = 13209.79

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160772.18
  [DEBUG]   ✓ Scenario 0: θ = 160772.18 ≤ Q = 163121.30 (slack: 2349.12)
  [DEBUG]   ✓ Scenario 1: θ = 160772.18 ≤ Q = 160772.18 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160772.18 ≤ Q = 160804.80 (slack: 32.62)
  [DEBUG]   ✓ Scenario 3: θ = 160772.18 ≤ Q = 160772.18 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160772.18 ≤ Q = 160804.32 (slack: 32.14)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2a598979
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd5a67687
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.298017e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6655200.6605
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.578195e+05, 273 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157819.48    0  138 6655200.66 -157819.48   102%     -    0s
H    0     0                    -119197.7195 -157819.48  32.4%     -    0s
H    0     0                    -119365.6210 -157819.48  32.2%     -    0s
H    0     0                    -124249.0622 -157819.48  27.0%     -    0s
H    0     0                    -137370.9239 -157819.48  14.9%     -    0s
     0     0 -142541.17    0   99 -137370.92 -142541.17  3.76%     -    0s
H    0     0                    -139725.0633 -142419.13  1.93%     -    0s
H    0     0                    -140031.7315 -142419.13  1.70%     -    0s
     0     0 -141815.90    0   96 -140031.73 -141815.90  1.27%     -    0s
     0     0 -141018.45    0   59 -140031.73 -141018.45  0.70%     -    0s
     0     0 -140965.02    0   61 -140031.73 -140965.02  0.67%     -    0s
     0     0 -140959.20    0   57 -140031.73 -140959.20  0.66%     -    0s
     0     0 -140825.46    0   55 -140031.73 -140825.46  0.57%     -    0s
     0     0 -140810.61    0   56 -140031.73 -140810.61  0.56%     -    0s
     0     0 -140715.78    0   57 -140031.73 -140715.78  0.49%     -    0s
     0     0 -140699.61    0   57 -140031.73 -140699.61  0.48%     -    0s
     0     2 -140699.61    0   57 -140031.73 -140699.61  0.48%     -    0s
H   56    44                    -140052.8265 -140336.51  0.20%  12.9    0s
H   59    42                    -140061.4334 -140313.07  0.18%  12.7    0s
H  315   106                    -140065.7777 -140226.46  0.11%   7.1    0s

Cutting planes:
  Gomory: 54
  Implied bound: 9
  MIR: 129
  Flow cover: 16
  RLT: 83
  Relax-and-lift: 6
  BQP: 1

Explored 989 nodes (6090 simplex iterations) in 0.10 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -140066 -140061 -140053 ... 6.6552e+06
No other solutions better than -140066

Optimal solution found (tolerance 1.00e-06)
Best objective -1.400657776632e+05, best bound -1.400657776632e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 142339.84
  Scenario: 42 demand increases, 18 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140065.78
  [DEBUG]   S×d_nominal = 282405.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282405.62 + -140065.78 = 142339.84
  [DEBUG]   Current θ from Master = 160772.18
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18432.34 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5222.55
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3868.0030, Absolute Gap = 3868.0030, Relative Gap = 0.292813
  Not converged yet (gap = 3868.00 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 42 increases, 18 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 265031 nonzeros
Model fingerprint: 0xfb3fa96e
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 38178 rows and 15498 columns
Presolve time: 0.84s
Presolved: 54945 rows, 24202 columns, 341249 nonzeros
Variable types: 21943 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 54945 rows, 24202 columns, 341249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33211   -7.2921842e+03   0.000000e+00   3.777304e+06      5s
   46769    2.0868124e+04   0.000000e+00   8.133138e+06     10s
   57858    2.8055401e+04   0.000000e+00   4.951638e+05     15s
   67816    3.1549690e+04   0.000000e+00   5.036027e+06     20s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 3.849481e+04, 46751 iterations, 21.61 seconds (43.68 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38494.8099    0  204 -219144.29 38494.8099   118%     -   22s
H    0     0                    -212888.7365 38494.8099   118%     -   22s
H    0     0                    -158405.1649 38494.8099   124%     -   23s
H    0     0                    -158080.3762 38494.8099   124%     -   23s
H    0     0                    -146162.9085 38494.8099   126%     -   23s
H    0     0                    -144710.5295 38494.8099   127%     -   23s
H    0     0                    -66934.47220 38494.8099   158%     -   23s
H    0     0                    -2083.504410 38494.8099  1948%     -   23s
H    0     0                    -418.3239563 38494.8099  9302%     -   23s
H    0     0                    -261.2367235 38494.8099      -     -   23s
H    0     0                    1648.8461537 38494.8099  2235%     -   23s
H    0     0                    2863.9721968 34460.3447  1103%     -   33s
H    0     0                    5204.3757414 34460.3447   562%     -   33s
H    0     0                    5656.6732451 34460.3447   509%     -   33s
     0     0 33560.2916    0  310 5656.67325 33560.2916   493%     -   34s
     0     0 33501.9266    0  223 5656.67325 33501.9266   492%     -   39s
     0     0 33501.9266    0  230 5656.67325 33501.9266   492%     -   41s
     0     0 33501.9266    0  234 5656.67325 33501.9266   492%     -   41s
     0     0 33501.9266    0  311 5656.67325 33501.9266   492%     -   42s
     0     0 31571.4977    0  313 5656.67325 31571.4977   458%     -   43s
     0     0 31571.4977    0  311 5656.67325 31571.4977   458%     -   43s
H    0     0                    5777.1492913 31402.2872   444%     -   50s
H    0     0                    7219.5013079 31402.2872   335%     -   50s
H    0     0                    7256.2728764 31402.2872   333%     -   50s
     0     0 31402.2872    0  184 7256.27288 31402.2872   333%     -   50s
H    0     0                    7262.3577600 31401.7897   332%     -   51s
H    0     0                    7355.7629865 31401.7897   327%     -   51s
H    0     0                    7373.6133928 31401.7897   326%     -   51s
H    0     0                    7379.1833211 31401.7897   326%     -   51s
     0     0 31198.8948    0  314 7379.18332 31198.8948   323%     -   53s
     0     0 31006.3251    0  311 7379.18332 31006.3251   320%     -   56s
     0     0 30988.9538    0  321 7379.18332 30988.9538   320%     -   57s
     0     0 30985.4367    0  323 7379.18332 30985.4367   320%     -   57s
     0     0 30977.4905    0  325 7379.18332 30977.4905   320%     -   58s
     0     0 30976.0656    0  321 7379.18332 30976.0656   320%     -   58s
     0     0 30975.8929    0  327 7379.18332 30975.8929   320%     -   58s
H    0     0                    7424.7482179 30975.8929   317%     -   64s
H    0     0                    7460.0387492 30975.8929   315%     -   64s
     0     0 28939.7115    0  276 7460.03875 28939.7115   288%     -   72s
H    0     0                    7469.3693376 28599.4558   283%     -   76s
     0     0 28599.4558    0  345 7469.36934 28599.4558   283%     -   76s
     0     0 28413.2333    0  377 7469.36934 28413.2333   280%     -   80s
     0     0 28359.5596    0  375 7469.36934 28359.5596   280%     -   83s
     0     0 28329.0778    0  419 7469.36934 28329.0778   279%     -   85s
H    0     0                    7485.7941452 28299.3857   278%     -   86s
     0     0 28299.3857    0  351 7485.79415 28299.3857   278%     -   86s
     0     0 28280.5887    0  350 7485.79415 28280.5887   278%     -   87s
H    0     0                    8006.0356558 28274.6397   253%     -   88s
     0     0 28274.6397    0  347 8006.03566 28274.6397   253%     -   88s
     0     0 28273.0171    0  345 8006.03566 28273.0171   253%     -   88s
H    0     0                    8557.0489173 28270.4898   230%     -   89s
     0     0 28270.4898    0  347 8557.04892 28270.4898   230%     -   89s
     0     0 28270.2754    0  347 8557.04892 28270.2754   230%     -   89s
H    0     0                    8578.8425209 27703.6196   223%     -   99s
     0     0 27703.6196    0  421 8578.84252 27703.6196   223%     -   99s
     0     0 27484.2252    0  420 8578.84252 27484.2252   220%     -  101s
     0     0 27420.7902    0  418 8578.84252 27420.7902   220%     -  104s
     0     0 27377.7387    0  420 8578.84252 27377.7387   219%     -  106s
     0     0 27358.4359    0  363 8578.84252 27358.4359   219%     -  107s
     0     0 27354.3941    0  418 8578.84252 27354.3941   219%     -  107s
     0     0 27353.4834    0  358 8578.84252 27353.4834   219%     -  108s
H    0     0                    8680.5098537 27214.7930   214%     -  112s
H    0     0                    8736.0736652 27214.7930   212%     -  112s
     0     0 27214.7930    0  375 8736.07367 27214.7930   212%     -  112s
     0     0 27126.8320    0  466 8736.07367 27126.8320   211%     -  114s
     0     0 27109.0162    0  424 8736.07367 27109.0162   210%     -  115s
     0     0 27101.9364    0  429 8736.07367 27101.9364   210%     -  116s
     0     0 27097.9137    0  469 8736.07367 27097.9137   210%     -  117s
     0     0 27096.6329    0  434 8736.07367 27096.6329   210%     -  117s
     0     0 27050.0572    0  425 8736.07367 27050.0572   210%     -  120s
H    0     0                    8770.2468401 27048.5441   208%     -  121s
     0     0 27044.1966    0  436 8770.24684 27044.1966   208%     -  122s
     0     0 27040.4690    0  440 8770.24684 27040.4690   208%     -  122s
     0     0 27038.3061    0  447 8770.24684 27038.3061   208%     -  123s
     0     0 27037.1588    0  448 8770.24684 27037.1588   208%     -  123s
     0     0 27003.0615    0  396 8770.24684 27003.0615   208%     -  126s
     0     0 26983.6505    0  444 8770.24684 26983.6505   208%     -  127s
     0     0 26980.7158    0  436 8770.24684 26980.7158   208%     -  128s
     0     0 26977.0738    0  481 8770.24684 26977.0738   208%     -  129s
     0     0 26976.8341    0  488 8770.24684 26976.8341   208%     -  129s
     0     0 26949.9199    0  445 8770.24684 26949.9199   207%     -  131s
H    0     0                    8772.7311657 26949.7990   207%     -  132s
     0     0 26945.3257    0  497 8772.73117 26945.3257   207%     -  132s
     0     0 26942.2600    0  457 8772.73117 26942.2600   207%     -  133s
     0     0 26941.4238    0  456 8772.73117 26941.4238   207%     -  133s
     0     0 26936.9060    0  463 8772.73117 26936.9060   207%     -  135s
     0     0 26935.4454    0  460 8772.73117 26935.4454   207%     -  136s
     0     0 26934.3922    0  450 8772.73117 26934.3922   207%     -  136s
     0     0 26922.7548    0  422 8772.73117 26922.7548   207%     -  137s
     0     0 26917.3966    0  422 8772.73117 26917.3966   207%     -  139s
     0     0 26913.8786    0  427 8772.73117 26913.8786   207%     -  139s
     0     0 26912.6721    0  426 8772.73117 26912.6721   207%     -  140s
     0     0 26903.7363    0  422 8772.73117 26903.7363   207%     -  141s
     0     0 26896.2147    0  407 8772.73117 26896.2147   207%     -  142s
     0     0 26895.4249    0  421 8772.73117 26895.4249   207%     -  143s
     0     0 26883.4617    0  410 8772.73117 26883.4617   206%     -  144s
     0     0 26879.2977    0  418 8772.73117 26879.2977   206%     -  146s
     0     0 26878.0829    0  413 8772.73117 26878.0829   206%     -  146s
     0     0 26876.5666    0  418 8772.73117 26876.5666   206%     -  147s
     0     0 26875.1722    0  409 8772.73117 26875.1722   206%     -  147s
     0     0 26869.2431    0  412 8772.73117 26869.2431   206%     -  150s
     0     0 26866.6369    0  464 8772.73117 26866.6369   206%     -  151s
     0     0 26864.7862    0  467 8772.73117 26864.7862   206%     -  151s
     0     0 26863.9192    0  427 8772.73117 26863.9192   206%     -  152s
     0     0 26860.9853    0  422 8772.73117 26860.9853   206%     -  153s
     0     0 26860.9615    0  422 8772.73117 26860.9615   206%     -  153s
H    0     0                    8859.0396543 26860.9615   203%     -  168s
H    0     2                    8964.8104843 26860.9615   200%     -  169s
     0     2 26860.9615    0  422 8964.81048 26860.9615   200%     -  169s
     1     4 26641.4102    1  451 8964.81048 26860.9615   200%  6630  174s
     3     8 26504.1840    2  450 8964.81048 26638.5596   197%  5947  180s
     7    16 26327.1302    3  504 8964.81048 26504.0999   196%  5514  185s
    15    32 26170.2168    4  549 8964.81048 26324.8661   194%  5502  193s
    31    48 25168.4840    5  465 8964.81048 26169.8961   192%  8503  207s
    47    80 24468.0020    6  358 8964.81048 26169.8961   192%  8268  218s
H   48    80                    9175.1168902 26169.8961   185%  8095  218s
H   52    80                    9217.3027125 26169.8961   184%  7917  218s
H   54    80                    9324.3860180 26169.8961   181%  7744  218s
H   55    80                    9393.5093759 26169.8961   179%  7719  218s
H   64    80                    10758.036322 26169.8961   143%  7253  218s
    79   147 24341.9618    7  393 10758.0363 26169.8961   143%  6360  237s
H  146   295                    11068.444604 26169.8961   136%  4415  248s
H  150   295                    11298.660576 26169.8961   132%  4373  248s
H  159   295                    11421.854880 26169.8961   129%  4234  248s
H  164   295                    11587.973286 26169.8961   126%  4149  248s
H  173   295                    11712.650102 26169.8961   123%  4023  248s
H  232   295                    11882.646184 26169.8961   120%  3449  248s
   294   393 23756.7719   10  379 11882.6462 26169.8961   120%  3091  255s
H  406   454                    11889.364332 26169.8961   120%  2636  262s
   495   502 23541.1115   11  309 11889.3643 26169.8961   120%  2481  270s
   573   524 23981.9657   11  335 11889.3643 26169.8961   120%  2396  277s
H  585   524                    12058.640953 26169.8961   117%  2382  277s
   621   554 24039.6358   11  323 12058.6410 26169.8961   117%  2406  284s
   677   582 22997.9111   11  280 12058.6410 26169.8961   117%  2429  292s
   707   640 21954.1933   12  254 12058.6410 26169.8961   117%  2499  298s
   769   685 22360.5424   12  243 12058.6410 26169.8961   117%  2501  305s
   820   744 22849.6508   12  319 12058.6410 26169.8961   117%  2529  312s
   903   782 18877.8399   12  385 12058.6410 26169.8961   117%  2460  320s
   965   819 21854.3798   13  255 12058.6410 26169.8961   117%  2454  328s
  1034   859 21809.5409   13  228 12058.6410 26169.8961   117%  2448  336s
H 1067   859                    12502.784972 26169.8961   109%  2448  336s
  1086   910 21746.1362   14  261 12502.7850 26169.8961   109%  2443  344s
  1173   938 21147.3546   16  260 12502.7850 25945.5793   108%  2405  351s
  1243   990 20217.5588   16  206 12502.7850 25945.5793   108%  2386  360s
  1321  1074 20658.1062   14  238 12502.7850 25945.5793   108%  2382  367s
  1435  1158 20976.2199   17  249 12502.7850 25945.5793   108%  2322  375s
  1553  1243 19764.1172   17  259 12502.7850 25945.5793   108%  2275  384s
  1672  1337 19321.8339   19  253 12502.7850 25945.5793   108%  2239  392s
  1804  1389 18884.4756   21  193 12502.7850 25261.1315   102%  2213  399s
  1894  1480 18620.8695   23  237 12502.7850 25261.1315   102%  2190  409s
  2017  1516 18470.1200   25  189 12502.7850 25230.5486   102%  2161  417s
  2065  1612 18417.1446   26  192 12502.7850 25230.5486   102%  2165  424s
  2183  1729 17959.6940   27  351 12502.7850 25230.5486   102%  2121  433s
  2350  1864 18095.3470   27  183 12502.7850 25230.5486   102%  2052  442s
  2545  2016 17825.9918   28  231 12502.7850 25230.5486   102%  1992  452s
  2728  2186 17640.6188   29  235 12502.7850 25230.5486   102%  1950  461s
  2947  2345 17634.5320   31  226 12502.7850 25230.5486   102%  1908  472s
  3170  2486     cutoff   32      12502.7850 25230.5486   102%  1862  483s
  3392  2642 17158.7314   34  332 12502.7850 25205.7962   102%  1844  493s
  3607  2643 15598.2914   54  422 12502.7850 25205.7962   102%  1824  528s
  3609  2644 20787.0963   17  204 12502.7850 25205.7962   102%  1823  557s
  3610  2645 23127.4645    8  447 12502.7850 25205.7962   102%  1822  582s
  3611  2646 16894.3639   52  375 12502.7850 25205.7962   102%  1822  596s
  3612  2646 15358.8758   54  421 12502.7850 25205.7962   102%  1821  604s
  3613  2647 13042.5740   37  475 12502.7850 25205.7962   102%  1821  608s
  3614  2648 19716.8322   17  445 12502.7850 25205.7962   102%  1820  610s
  3617  2650 15305.6567   37  458 12502.7850 25205.7962   102%  1819  615s
  3621  2652 23125.2538   10  553 12502.7850 25205.7962   102%  1817  623s
  3622  2653 14352.9035   15  409 12502.7850 25205.7962   102%  1816  625s
  3626  2656 15206.8955   47  456 12502.7850 25205.7962   102%  1814  631s
  3629  2658 19251.1130   22  477 12502.7850 25205.7962   102%  1813  637s
  3631  2659 22019.7586   18  475 12502.7850 25205.7962   102%  1812  642s
  3633  2660 22490.9204   10  471 12502.7850 25205.7962   102%  1811  648s
  3635  2662 14214.4565   29  408 12502.7850 25205.7962   102%  1810  653s
  3636  2662 23425.2680   11  457 12502.7850 25205.7962   102%  1809  656s
  3639  2664 14922.4382   61  463 12502.7850 25205.7962   102%  1808  664s
  3640  2665 23444.1566   11  472 12502.7850 25205.7962   102%  1807  665s
  3642  2666 13262.8959   48  417 12502.7850 25205.7962   102%  1806  670s
  3645  2668 13975.5375   44  412 12502.7850 25205.7962   102%  1805  676s
  3648  2670 15807.2661   39  426 12502.7850 25205.7962   102%  1803  681s
  3649  2671 22621.1153   15  421 12502.7850 25205.7962   102%  1803  685s
  3651  2672 13115.9980   43  428 12502.7850 25205.7962   102%  1802  690s
  3653  2674 13135.2220   29  425 12502.7850 25205.7962   102%  1801  695s
  3654  2674 19121.2094   25  425 12502.7850 25205.7962   102%  1800  721s
  3655  2675 12789.9295   40  425 12502.7850 25205.7962   102%  1800  743s
  3656  2679 25205.7962   16  413 12502.7850 25205.7962   102%  1854  755s
  3658  2682 25205.7962   17  410 12502.7850 25205.7962   102%  1857  767s
  3662  2689 25205.7962   18  446 12502.7850 25205.7962   102%  1863  780s
  3670  2702 25205.7962   19  576 12502.7850 25205.7962   102%  1879  795s
  3686  2711 25205.7962   20  541 12502.7850 25205.7962   102%  1926  824s
  3702  2737 23086.2920   21  480 12502.7850 25205.7962   102%  1958  848s
  3734  2824 22836.3200   22  360 12502.7850 25205.7962   102%  2004  868s
  3831  2823 22270.6416   24  461 12502.7850 25205.7962   102%  2120  876s
  3863  2848 21807.6332   24  362 12502.7850 25205.7962   102%  2131  888s
  3899  2893 22051.9872   25  462 12502.7850 25205.7962   102%  2139  899s
  3969  2925 20144.3006   27  298 12502.7850 25205.7962   102%  2151  910s
  4060  2949 21718.6374   25  461 12502.7850 25205.7962   102%  2157  921s
  4161  2963 21355.7926   25  463 12502.7850 25205.7962   102%  2153  933s
  4251  2966 21449.1028   26  407 12502.7850 24866.9627  98.9%  2151  948s
  4329  2976 21155.8410   26  421 12502.7850 24866.9627  98.9%  2161  959s
  4402  2973 19886.7058   27  395 12502.7850 24866.9627  98.9%  2182  972s
  4460  2984 19037.3508   28  424 12502.7850 24843.6383  98.7%  2206  982s
  4531  2997 14987.7308   39  237 12502.7850 24843.6383  98.7%  2214  995s
  4598  3001 18550.4824   29  393 12502.7850 24590.8709  96.7%  2231 1005s
  4665  3017 18107.5151   30  405 12502.7850 24590.8709  96.7%  2247 1015s
  4761  3021 17969.7133   31  217 12502.7850 24330.9818  94.6%  2256 1027s
  4852  3020 16197.7141   33   95 12502.7850 24090.2815  92.7%  2261 1039s
  4951  3033     cutoff   34      12502.7850 23872.3289  90.9%  2262 1050s
  5034  3060 14502.7521   35  258 12502.7850 23872.3289  90.9%  2283 1062s
  5119  3083 12943.4750   36   72 12502.7850 23644.9355  89.1%  2297 1075s
  5220  3100     cutoff   37      12502.7850 23644.9355  89.1%  2307 1087s
  5335  3105 13378.6891   44  146 12502.7850 23176.3518  85.4%  2312 1100s
  5455  3134 19879.7629   23  288 12502.7850 23176.3518  85.4%  2322 1112s
  5572  3151 19452.7715   25  269 12502.7850 23176.3518  85.4%  2333 1126s
  5693  3158 17337.6041   29  236 12502.7850 23176.3518  85.4%  2341 1143s
  5828  3176 15584.5614   31  186 12502.7850 23176.3518  85.4%  2348 1157s
  5979  3184 13553.6615   34  102 12502.7850 23057.7288  84.4%  2346 1172s
  6158  3164 13978.3709   25  245 12502.7850 22505.5060  80.0%  2334 1188s
  6330  3185     cutoff   27      12502.7850 22198.3834  77.5%  2334 1204s
  6486  3199 19820.8144   27  256 12502.7850 22163.3404  77.3%  2342 1226s
  6628  3200 18339.5702   30  209 12502.7850 22055.6023  76.4%  2366 1244s
  6769  3220 17244.6651   33  213 12502.7850 21936.1148  75.4%  2388 1263s
  6931  3261 15925.8921   35  182 12502.7850 21936.1148  75.4%  2399 1282s
  7187  3223 15157.0404   36  112 12502.7850 21873.6338  75.0%  2386 1299s
  7357  3252 20022.6553   29  313 12502.7850 21513.7738  72.1%  2393 1318s
  7515  3268 15684.2809   31  277 12502.7850 21513.7738  72.1%  2419 1336s
  7716  3256 13895.1424   33  326 12502.7850 21351.5276  70.8%  2434 1361s
  7994  3226 15569.0620   26  268 12502.7850 21254.8839  70.0%  2430 1384s
  8179  3185 13119.4944   30  257 12502.7850 21127.9253  69.0%  2459 1402s
  8287  3202 12872.4397   31  246 12502.7850 21105.9688  68.8%  2468 1427s
  8528  3198 13671.3282   30  159 12502.7850 21027.8408  68.2%  2476 1450s
  8739  3187 16514.0148   30  185 12502.7850 20792.1842  66.3%  2482 1477s
  9068  3193 18861.1905   25  331 12502.7850 20533.0078  64.2%  2487 1501s
  9354  3163 15162.8493   34  277 12502.7850 20481.2017  63.8%  2502 1525s
  9485  3242 14378.4171   44  113 12502.7850 20481.2017  63.8%  2500 1553s
  9836  3208 16109.8909   25  359 12502.7850 20347.2280  62.7%  2498 1582s
 10154  3162     cutoff   28      12502.7850 20121.6115  60.9%  2510 1610s
 10504  3143 15568.4643   31  292 12502.7850 20016.3403  60.1%  2522 1646s
 10875  3132 17121.5508   30  216 12502.7850 19914.5009  59.3%  2529 1676s
 11287  3076     cutoff   36      12502.7850 19853.2540  58.8%  2533 1709s
 11689  3024 17867.1069   32  144 12502.7850 19724.8420  57.8%  2539 1741s
 12093  3130 infeasible   30      12502.7850 19485.0952  55.8%  2551 1779s
 12493  3223     cutoff   30      12502.7850 19235.8193  53.9%  2562 1814s
 12937  3335 15818.2530   30  230 12502.7850 19235.4651  53.8%  2570 1851s
 13387  3478 15917.8002   31  242 12502.7850 19220.0447  53.7%  2581 1888s
 13881  3538 12915.7231   26  221 12502.7850 18831.3585  50.6%  2583 1930s
 14435  3592     cutoff   29      12502.7850 18718.8096  49.7%  2583 1972s
 14952  3611 16691.3741   27  348 12502.7850 18662.0770  49.3%  2591 2007s
 15037  3664     cutoff   28      12502.7850 18551.2551  48.4%  2594 2047s
 15450  3749 12933.3514   31  393 12502.7850 18524.2824  48.2%  2594 2091s
 16015  3830 14519.8996   28  312 12502.7850 18255.2426  46.0%  2601 2139s
 16663  3921 15755.8046   28  211 12502.7850 18126.5544  45.0%  2599 2186s
 17318  3966     cutoff   31      12502.7850 18087.7555  44.7%  2600 2237s
 18056  4012 15741.1505   39  154 12502.7850 17915.4140  43.3%  2595 2292s
 18761  4044     cutoff   31      12502.7850 17637.4942  41.1%  2593 2345s
 19551  4021     cutoff   26      12502.7850 17472.1397  39.7%  2588 2405s
 20309  3940 13075.4646   28  323 12502.7850 17264.7033  38.1%  2585 2464s
 21179  3873     cutoff   40      12502.7850 17037.1801  36.3%  2577 2524s
 22042  3756 14285.1907   29  209 12502.7850 16769.7188  34.1%  2572 2582s
*22332  3736              50    12643.205862 16756.8848  32.5%  2568 2582s
 22953  3626 13385.8408   29  229 12643.2059 16527.6067  30.7%  2565 2641s
H22976  3626                    12650.339582 16504.9689  30.5%  2565 2641s
H23028  3598                    12792.259771 16496.1069  29.0%  2564 2641s
 23683  3344     cutoff   26      12792.2598 16316.4296  27.5%  2556 2703s
H24557  3333                    12812.530611 16206.8774  26.5%  2548 2703s
 24694  2906 13074.9009   26  342 12812.5306 16023.9289  25.1%  2548 2772s
 25853  2232     cutoff   36      12812.5306 15518.4137  21.1%  2527 2837s
 27450   638 infeasible   34      12812.5306 15191.1014  18.6%  2472 2902s
 29744     9     cutoff   37      12812.5306 14288.6864  11.5%  2355 2923s
H29998     9                    12844.058088 14131.6707  10.0%  2339 2923s

Cutting planes:
  Learned: 2
  MIR: 675
  Mixing: 2
  Flow cover: 1744
  RLT: 16
  Relax-and-lift: 107

Explored 30644 nodes (70591844 simplex iterations) in 2924.05 seconds (9108.68 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12844.1 12844.1 12812.5 ... 11882.6

Optimal solution found (tolerance 1.00e-06)
Best objective 1.284405808826e+04, best bound 1.284405808826e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2924.07s
  Master Objective (UB) = 12844.06, θ = 160591.61
  Upper Bound (UB) = 12844.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160591.61
  [DEBUG]   ✓ Scenario 0: θ = 160591.61 ≤ Q = 169629.49 (slack: 9037.88)
  [DEBUG]   ✓ Scenario 1: θ = 160591.61 ≤ Q = 160591.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160591.61 ≤ Q = 160591.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160591.61 ≤ Q = 171954.91 (slack: 11363.29)
  [DEBUG]   ✓ Scenario 4: θ = 160591.61 ≤ Q = 171721.62 (slack: 11130.01)
  [DEBUG]   ✓ Scenario 5: θ = 160591.61 ≤ Q = 160591.61 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x579c60ac
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x579c60ac
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.305532e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6687490.7344
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.571288e+05, 274 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157128.79    0  138 6687490.73 -157128.79   102%     -    0s
H    0     0                    -117935.5696 -157128.79  33.2%     -    0s
H    0     0                    -118103.4710 -157128.79  33.0%     -    0s
H    0     0                    -126728.1077 -138685.32  9.44%     -    0s
H    0     0                    -132795.1043 -138685.32  4.44%     -    0s
     0     0 -138685.32    0   57 -132795.10 -138685.32  4.44%     -    0s
H    0     0                    -137434.5711 -138640.76  0.88%     -    0s
H    0     0                    -138316.7505 -138495.42  0.13%     -    0s
     0     0 -138446.68    0   14 -138316.75 -138446.68  0.09%     -    0s
     0     0 -138424.75    0   12 -138316.75 -138424.75  0.08%     -    0s
     0     0 -138416.39    0   10 -138316.75 -138416.39  0.07%     -    0s
     0     0 -138408.37    0    9 -138316.75 -138408.37  0.07%     -    0s
     0     0 -138389.82    0    9 -138316.75 -138389.82  0.05%     -    0s
     0     0 -138380.08    0    8 -138316.75 -138380.08  0.05%     -    0s
     0     0 -138378.04    0    8 -138316.75 -138378.04  0.04%     -    0s
     0     0 -138330.11    0    6 -138316.75 -138330.11  0.01%     -    0s
     0     0 -138324.80    0    4 -138316.75 -138324.80  0.01%     -    0s
H    0     0                    -138322.4390 -138324.80  0.00%     -    0s
     0     0     cutoff    0      -138322.44 -138322.44  0.00%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 4

Explored 1 nodes (536 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -138322 -138317 -138309 ... 6.68749e+06
No other solutions better than -138322

Optimal solution found (tolerance 1.00e-06)
Best objective -1.383224389529e+05, best bound -1.383224389529e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 144021.16
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -138322.44
  [DEBUG]   S×d_nominal = 282343.60
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282343.60 + -138322.44 = 144021.16
  [DEBUG]   Current θ from Master = 160591.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 16570.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -3726.40
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 3502.2705, Absolute Gap = 3502.2705, Relative Gap = 0.272676
  Not converged yet (gap = 3502.27 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308283 nonzeros
Model fingerprint: 0xe4e7ba9b
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44541 rows and 18081 columns
Presolve time: 1.01s
Presolved: 63872 rows, 27859 columns, 397204 nonzeros
Variable types: 25600 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63872 rows, 27859 columns, 397204 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34204   -5.3868789e+04   0.000000e+00   2.672405e+08      5s
   48479    5.0767229e+03   0.000000e+00   3.489922e+06     10s
   57609    1.3268616e+04   0.000000e+00   1.665925e+07     15s
   66526    1.8281438e+04   0.000000e+00   2.228661e+07     20s
   74616    2.2972022e+04   0.000000e+00   3.266482e+06     25s
   82857    2.6415548e+04   0.000000e+00   1.635686e+06     30s
   90860    2.8322263e+04   0.000000e+00   1.105855e+06     35s
   98642    3.0668939e+04   0.000000e+00   4.125761e+06     40s
Concurrent spin time: 1.90s

Solved with dual simplex

Root relaxation: objective 3.843303e+04, 75357 iterations, 43.49 seconds (76.08 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38433.0333    0  208 -219144.29 38433.0333   118%     -   45s
H    0     0                    -211639.7960 38433.0333   118%     -   45s
H    0     0                    -205895.7086 38433.0333   119%     -   45s
H    0     0                    -193715.4226 38433.0333   120%     -   45s
H    0     0                    -177706.6116 38433.0333   122%     -   45s
H    0     0                    -176791.1158 38433.0333   122%     -   45s
H    0     0                    -175911.0337 38433.0333   122%     -   45s
H    0     0                    -175381.7584 38433.0333   122%     -   45s
H    0     0                    -175085.8273 38433.0333   122%     -   46s
H    0     0                    -174733.5402 38433.0333   122%     -   46s
H    0     0                    -174610.7170 38433.0333   122%     -   46s
H    0     0                    -79896.65346 38433.0333   148%     -   46s
H    0     0                    -31376.81914 38433.0333   222%     -   46s
H    0     0                    -138.5474092 38433.0333      -     -   46s
H    0     0                    1648.8461537 38433.0333  2231%     -   46s
H    0     0                    2178.0747180 34041.2722  1463%     -   62s
H    0     0                    4343.9714623 34041.2722   684%     -   62s
H    0     0                    4716.8996067 34041.2722   622%     -   62s
H    0     0                    4956.1938835 34041.2722   587%     -   62s
H    0     0                    5117.4594820 34041.2722   565%     -   62s
H    0     0                    5572.9920197 34041.2722   511%     -   62s
H    0     0                    5675.3689341 34041.2722   500%     -   62s
H    0     0                    5820.5663734 34041.2722   485%     -   62s
     0     0 34041.2722    0  311 5820.56637 34041.2722   485%     -   62s
     0     0 33158.1647    0  307 5820.56637 33158.1647   470%     -   70s
     0     0 33158.1647    0  307 5820.56637 33158.1647   470%     -   71s
     0     0 33158.1647    0  319 5820.56637 33158.1647   470%     -   74s
     0     0 33158.1647    0  323 5820.56637 33158.1647   470%     -   75s
     0     0 33158.1647    0  319 5820.56637 33158.1647   470%     -   76s
     0     0 33158.1647    0  321 5820.56637 33158.1647   470%     -   77s
     0     0 33158.1647    0  322 5820.56637 33158.1647   470%     -   77s
     0     0 31127.1462    0  358 5820.56637 31127.1462   435%     -   89s
H    0     0                    7136.4232045 31127.0275   336%     -   89s
     0     0 30831.8151    0  364 7136.42320 30831.8151   332%     -   95s
H    0     0                    7143.1413520 30663.5678   329%     -  101s
     0     0 30663.5678    0  349 7143.14135 30663.5678   329%     -  101s
H    0     0                    7155.7791362 30558.1595   327%     -  104s
H    0     0                    8222.3952784 30558.1595   272%     -  104s
H    0     0                    8361.6691190 30558.1595   265%     -  104s
     0     0 30558.1595    0  313 8361.66912 30558.1595   265%     -  104s
     0     0 30504.4664    0  370 8361.66912 30504.4664   265%     -  107s
     0     0 30481.2540    0  290 8361.66912 30481.2540   265%     -  108s
     0     0 30469.6978    0  289 8361.66912 30469.6978   264%     -  109s
     0     0 30427.9485    0  374 8361.66912 30427.9485   264%     -  112s
     0     0 30378.2580    0  319 8361.66912 30378.2580   263%     -  113s
     0     0 30364.3378    0  287 8361.66912 30364.3378   263%     -  114s
     0     0 30363.5235    0  287 8361.66912 30363.5235   263%     -  115s
     0     0 30363.4654    0  289 8361.66912 30363.4654   263%     -  115s
     0     0 28970.9174    0  330 8361.66912 28970.9174   246%     -  136s
H    0     0                    8534.0192784 28970.6265   239%     -  136s
     0     0 28665.8334    0  368 8534.01928 28665.8334   236%     -  144s
     0     0 28574.6043    0  400 8534.01928 28574.6043   235%     -  149s
     0     0 28501.0084    0  448 8534.01928 28501.0084   234%     -  153s
     0     0 28472.9469    0  403 8534.01928 28472.9469   234%     -  156s
     0     0 28464.7229    0  406 8534.01928 28464.7229   234%     -  158s
     0     0 28460.1773    0  464 8534.01928 28460.1773   233%     -  159s
     0     0 28451.9282    0  451 8534.01928 28451.9282   233%     -  159s
     0     0 28448.6423    0  458 8534.01928 28448.6423   233%     -  160s
     0     0 28446.6483    0  463 8534.01928 28446.6483   233%     -  161s
     0     0 28445.6397    0  417 8534.01928 28445.6397   233%     -  162s
H    0     0                    8633.8322316 28445.6397   229%     -  171s
H    0     0                    8906.1469125 27703.0611   211%     -  179s
H    0     0                    9096.7259130 27703.0611   205%     -  179s
H    0     0                    9113.4271615 27703.0611   204%     -  179s
H    0     0                    9153.8051047 27703.0611   203%     -  179s
H    0     0                    9162.0722718 27703.0611   202%     -  179s
H    0     0                    9283.0855407 27703.0611   198%     -  179s
     0     0 27703.0611    0  372 9283.08554 27703.0611   198%     -  179s
     0     0 27563.7028    0  409 9283.08554 27563.7028   197%     -  184s
     0     0 27454.9140    0  381 9283.08554 27454.9140   196%     -  187s
     0     0 27414.8245    0  391 9283.08554 27414.8245   195%     -  190s
     0     0 27403.9239    0  383 9283.08554 27403.9239   195%     -  191s
     0     0 27396.8849    0  396 9283.08554 27396.8849   195%     -  192s
     0     0 27392.9378    0  378 9283.08554 27392.9378   195%     -  192s
     0     0 27389.5242    0  383 9283.08554 27389.5242   195%     -  193s
     0     0 27385.4703    0  350 9283.08554 27385.4703   195%     -  194s
     0     0 27384.1178    0  350 9283.08554 27384.1178   195%     -  194s
     0     0 27379.5952    0  346 9283.08554 27379.5952   195%     -  194s
     0     0 27376.8184    0  350 9283.08554 27376.8184   195%     -  195s
     0     0 27375.7712    0  346 9283.08554 27375.7712   195%     -  195s
     0     0 27213.2874    0  393 9283.08554 27213.2874   193%     -  199s
     0     0 27182.8692    0  436 9283.08554 27182.8692   193%     -  202s
     0     0 27169.7876    0  393 9283.08554 27169.7876   193%     -  203s
     0     0 27164.6709    0  393 9283.08554 27164.6709   193%     -  204s
     0     0 27155.1374    0  391 9283.08554 27155.1374   193%     -  205s
     0     0 27153.2361    0  395 9283.08554 27153.2361   193%     -  205s
     0     0 27152.7586    0  394 9283.08554 27152.7586   192%     -  205s
     0     0 27076.1176    0  440 9283.08554 27076.1176   192%     -  208s
H    0     0                    9319.4753402 27075.4244   191%     -  209s
     0     0 27065.0697    0  395 9319.47534 27065.0697   190%     -  210s
     0     0 27063.3913    0  395 9319.47534 27063.3913   190%     -  211s
     0     0 27061.3973    0  404 9319.47534 27061.3973   190%     -  211s
     0     0 27059.5295    0  396 9319.47534 27059.5295   190%     -  212s
     0     0 27058.8140    0  398 9319.47534 27058.8140   190%     -  212s
     0     0 27039.1352    0  443 9319.47534 27039.1352   190%     -  214s
H    0     0                    9381.8827962 27039.1184   188%     -  215s
H    0     0                    9393.5093759 27039.1184   188%     -  215s
     0     0 27031.5098    0  397 9393.50938 27031.5098   188%     -  216s
     0     0 27029.6843    0  451 9393.50938 27029.6843   188%     -  216s
     0     0 27027.4901    0  459 9393.50938 27027.4901   188%     -  217s
     0     0 27026.8753    0  461 9393.50938 27026.8753   188%     -  217s
     0     0 27008.8165    0  461 9393.50938 27008.8165   188%     -  219s
     0     0 27006.4146    0  466 9393.50938 27006.4146   188%     -  220s
     0     0 27005.8258    0  465 9393.50938 27005.8258   187%     -  220s
     0     0 26999.7439    0  468 9393.50938 26999.7439   187%     -  222s
     0     0 26998.8183    0  467 9393.50938 26998.8183   187%     -  222s
     0     0 26997.5271    0  463 9393.50938 26997.5271   187%     -  224s
     0     0 26997.0108    0  414 9393.50938 26997.0108   187%     -  225s
     0     0 26995.5480    0  409 9393.50938 26995.5480   187%     -  226s
     0     0 26990.9471    0  465 9393.50938 26990.9471   187%     -  227s
     0     0 26987.3493    0  460 9393.50938 26987.3493   187%     -  228s
     0     0 26986.7584    0  462 9393.50938 26986.7584   187%     -  228s
     0     0 26985.6770    0  467 9393.50938 26985.6770   187%     -  229s
     0     0 26985.4389    0  467 9393.50938 26985.4389   187%     -  230s
     0     2 26985.4389    0  467 9393.50938 26985.4389   187%     -  257s
     1     4 26811.2896    1  448 9393.50938 26985.4389   187%  5211  261s
     3     8 26695.2645    2  445 9393.50938 26810.4831   185%  4598  266s
     7    16 26571.8409    3  462 9393.50938 26694.6751   184%  5334  274s
    15    32 26343.3557    4  457 9393.50938 26568.4480   183%  7700  282s
    31    48 25260.2182    5  398 9393.50938 26343.1744   180%  9648  309s
    47    80 24294.0072    6  462 9393.50938 26343.1744   180%  9435  322s
H   76    80                    9652.4631107 26343.1744   173%  7668  322s
    79   144 23988.3832    7  442 9652.46311 26343.1744   173%  7611  362s
H  143   263                    9670.3876436 26343.1744   172%  5968  378s
H  152   263                    9678.0297982 26343.1744   172%  5808  378s
H  181   263                    9839.9332207 26343.1744   168%  5347  378s
   262   364 23515.1002   11  426 9839.93322 26343.1744   168%  4662  392s
   365   456 23382.1539   12  421 9839.93322 26343.1744   168%  4171  406s
H  390   456                    9988.9713489 26343.1744   164%  4087  406s
   457   524 23489.6202   13  373 9988.97135 26343.1744   164%  3822  421s
   539   550 22633.3892   21  311 9988.97135 26343.1744   164%  3602  436s
H  562   550                    10304.404499 26343.1744   156%  3596  436s
H  567   550                    10404.001833 26343.1744   153%  3579  436s
H  568   550                    11818.855517 26343.1744   123%  3577  436s
   571   623 19564.2253   13  311 11818.8555 26343.1744   123%  3579  451s
   658   652 22986.7243   13  421 11818.8555 26343.1744   123%  3366  460s
H  661   652                    12261.149436 26343.1744   115%  3357  460s
   695   716 22799.0613   13  427 12261.1494 26343.1744   115%  3310  469s
   781   743 22968.5587   14  391 12261.1494 26343.1744   115%  3169  477s
H  782   743                    12272.528912 26343.1744   115%  3165  477s
H  790   743                    12279.847487 26343.1744   115%  3169  477s
H  794   743                    12294.398256 26343.1744   114%  3163  477s
   815   825 21218.6700   14  316 12294.3983 26343.1744   114%  3148  487s
   911   850 22946.6177   14  416 12294.3983 26343.1744   114%  3016  495s
H  920   850                    12301.716830 26343.1744   114%  3010  495s
   945   958 22825.2397   15  389 12301.7168 26343.1744   114%  2983  503s
  1075   994 22461.9467   17  284 12301.7168 26343.1744   114%  2779  513s
  1116  1053 21313.8607   18  361 12301.7168 26343.1744   114%  2744  521s
  1179  1125 16916.5561   18  170 12301.7168 26343.1744   114%  2659  530s
  1276  1211 18384.9528   16  241 12301.7168 26343.1744   114%  2576  541s
  1378  1308 21928.3041   17  359 12301.7168 26343.1744   114%  2504  550s
  1499  1411 21213.7076   19  357 12301.7168 26343.1744   114%  2445  561s
  1645  1503 21179.0355   18  341 12301.7168 26044.3414   112%  2349  571s
  1783  1573 20735.2237   20  357 12301.7168 26044.3414   112%  2300  583s
  1918  1644 20757.6836   20  359 12301.7168 26044.3414   112%  2248  594s
  2037  1713 18650.6405   21  290 12301.7168 26044.3414   112%  2230  607s
  2144  1795 20348.1129   21  353 12301.7168 26044.3414   112%  2245  620s
  2284  1909 15394.7791   22  306 12301.7168 26044.3414   112%  2238  632s
  2412  2068 20218.1042   22  393 12301.7168 26044.3414   112%  2235  647s
  2605  2177 20105.0662   24  341 12301.7168 26044.3414   112%  2194  661s
  2800  2224 16720.9521   25  244 12301.7168 25909.2644   111%  2160  675s
  2956  2312 17229.3651   26  251 12301.7168 25587.6730   108%  2156  690s
  3094  2433 17025.7326   29  229 12301.7168 25587.6730   108%  2185  708s
  3289  2528 16586.4990   37  267 12301.7168 25537.8204   108%  2168  724s
  3442  2630 15843.9781   44  242 12301.7168 25537.8204   108%  2185  740s
  3607  2692 infeasible   50      12301.7168 25517.1974   107%  2189  758s
  3713  2797 14498.3833   58  190 12301.7168 25517.1974   107%  2204  773s
  3861  2798 19886.5519   24  467 12301.7168 25355.4366   106%  2207  854s
  3863  2799 19166.9922   12  208 12301.7168 25355.4366   106%  2206  896s
  3864  2800 12775.9832   59  399 12301.7168 25355.4366   106%  2205  922s
  3865  2801 13605.5456   52  388 12301.7168 25355.4366   106%  2205  938s
  3866  2801 13526.2510   62  483 12301.7168 25355.4366   106%  2204  950s
  3867  2802 12799.5541   70  502 12301.7168 25355.4366   106%  2204  958s
  3868  2803 16907.5574   31  422 12301.7168 25355.4366   106%  2203  961s
  3870  2804 13889.6052   35  454 12301.7168 25355.4366   106%  2202  967s
  3871  2805 18350.7487   33  408 12301.7168 25355.4366   106%  2202  970s
  3873  2806 22523.0620   26  488 12301.7168 25355.4366   106%  2200  975s
  3875  2807 20737.9314   29  453 12301.7168 25355.4366   106%  2199  983s
  3877  2809 14705.3512   14  484 12301.7168 25355.4366   106%  2198  986s
  3880  2811 24877.6768    9  362 12301.7168 25355.4366   106%  2196  992s
  3882  2812 13850.6614   41  476 12301.7168 25355.4366   106%  2195  995s
  3884  2813 14152.0763   50  469 12301.7168 25355.4366   106%  2194 1001s
  3886  2815 12663.8979   48  479 12301.7168 25355.4366   106%  2193 1008s
  3888  2816 13404.5693   51  517 12301.7168 25355.4366   106%  2192 1011s
  3889  2817 21368.7115   21  475 12301.7168 25355.4366   106%  2191 1020s
  3892  2819 21242.3710   15  482 12301.7168 25355.4366   106%  2190 1028s
  3894  2820 14925.9083   60  513 12301.7168 25355.4366   106%  2189 1032s
  3895  2821 15536.2179   33  522 12301.7168 25355.4366   106%  2188 1039s
  3896  2821 18723.5687   31  478 12301.7168 25355.4366   106%  2187 1041s
  3898  2823 20127.6820   47  475 12301.7168 25355.4366   106%  2186 1047s
  3900  2824 24315.4333   10  443 12301.7168 25355.4366   106%  2185 1051s
  3901  2825 15200.5896   39  484 12301.7168 25355.4366   106%  2185 1055s
  3902  2825 19051.1267   31  484 12301.7168 25355.4366   106%  2184 1090s
  3903  2826 15273.7631   39  484 12301.7168 25355.4366   106%  2183 1117s
  3904  2830 25355.4366   10  475 12301.7168 25355.4366   106%  2238 1130s
  3906  2833 25355.4366   11  463 12301.7168 25355.4366   106%  2240 1142s
  3910  2840 25355.4366   12  457 12301.7168 25355.4366   106%  2247 1160s
  3918  2853 25355.4366   13  453 12301.7168 25355.4366   106%  2257 1179s
  3934  2864 24596.7566   14  321 12301.7168 25355.4366   106%  2311 1208s
  3950  2880 21251.9813   15  308 12301.7168 25355.4366   106%  2336 1227s
  3982  2906 20839.9525   16  307 12301.7168 25355.4366   106%  2398 1246s
  4018  2937 20648.5414   17  293 12301.7168 25355.4366   106%  2428 1260s
  4061  2957 20278.6437   18  279 12301.7168 25355.4366   106%  2436 1274s
  4104  2997 20688.2412   17  295 12301.7168 25355.4366   106%  2453 1291s
  4169  3030 18259.3342   18  243 12301.7168 25355.4366   106%  2485 1308s
  4247  3086 19982.0561   19  256 12301.7168 25355.4366   106%  2506 1323s
  4346  3103 18751.3808   22  213 12301.7168 25355.4366   106%  2513 1336s
  4438  3110 17100.1008   24  169 12301.7168 25355.4366   106%  2514 1354s
  4525  3101 infeasible   25      12301.7168 25355.4366   106%  2517 1367s
  4593  3112 14167.8863   27  115 12301.7168 25355.4366   106%  2521 1382s
  4675  3124 13833.1167   28  178 12301.7168 25355.4366   106%  2523 1392s
  4750  3126     cutoff   29      12301.7168 25355.4366   106%  2526 1406s
  4839  3134 13463.8508   31  216 12301.7168 25286.0370   106%  2520 1421s
  4922  3119 infeasible   31      12301.7168 24992.1353   103%  2524 1442s
  4985  3114     cutoff   36      12301.7168 24992.1353   103%  2529 1463s
  5036  3132 23455.2459   15  464 12301.7168 24992.1353   103%  2538 1479s
  5098  3141 19763.2653   16  450 12301.7168 24992.1353   103%  2553 1495s
  5158  3162 18831.1218   17  493 12301.7168 24992.1353   103%  2572 1510s
  5230  3171 18655.1015   18  530 12301.7168 24426.3462  98.6%  2588 1528s
  5297  3178 17021.5967   19  472 12301.7168 24426.3462  98.6%  2610 1542s
  5379  3187 16107.7333   20  456 12301.7168 24426.3462  98.6%  2622 1560s
  5450  3207 15550.3550   21  447 12301.7168 24426.3462  98.6%  2637 1576s
  5532  3209 13859.4372   23  341 12301.7168 24426.3462  98.6%  2664 1593s
  5628  3228     cutoff   24      12301.7168 24426.3462  98.6%  2680 1615s
  5715  3234 13802.0374   24  341 12301.7168 23869.8792  94.0%  2704 1628s
  5762  3268 13348.1299   25  362 12301.7168 23869.8792  94.0%  2717 1646s
  5853  3266 13093.2642   26  325 12301.7168 23869.8792  94.0%  2731 1665s
  5946  3263 infeasible   28      12301.7168 23756.4143  93.1%  2752 1685s
  6069  3281 infeasible   28      12301.7168 23756.4143  93.1%  2769 1705s
  6199  3300 20908.2152   17  306 12301.7168 23756.4143  93.1%  2788 1726s
  6320  3315 20812.4159   18  298 12301.7168 23756.4143  93.1%  2810 1750s
  6432  3317 17955.9069   19  266 12301.7168 23756.4143  93.1%  2840 1771s
  6549  3300 16837.0543   20  252 12301.7168 23756.4143  93.1%  2858 1796s
  6695  3306 16433.4549   21  268 12301.7168 23756.4143  93.1%  2882 1821s
  6822  3358 15924.0485   23  179 12301.7168 23756.4143  93.1%  2920 1847s
  6966  3379 13126.7023   24  221 12301.7168 23756.4143  93.1%  2946 1872s
  7123  3395 15403.6440   26  225 12301.7168 23756.4143  93.1%  2974 1906s
  7299  3405 14877.1110   30  189 12301.7168 23756.4143  93.1%  3002 1933s
  7484  3461 14333.8929   33  302 12301.7168 21686.3564  76.3%  3024 1960s
  7667  3465     cutoff   36      12301.7168 21608.1010  75.7%  3049 1989s
  7870  3452 infeasible   42      12301.7168 21608.1010  75.7%  3051 2017s
  8013  3444     cutoff   45      12301.7168 21286.0635  73.0%  3070 2046s
  8177  3459 16860.2816   21  403 12301.7168 21189.6467  72.2%  3095 2088s
  8362  3451 14880.0704   23  319 12301.7168 21189.6467  72.2%  3136 2123s
  8562  3436 12519.3455   25  361 12301.7168 20994.2664  70.7%  3177 2154s
  8776  3453     cutoff   26      12301.7168 20981.1709  70.6%  3203 2194s
  9011  3404 17294.1857   18  231 12301.7168 20875.7948  69.7%  3239 2226s
  9198  3437 13654.7450   25  198 12301.7168 20848.3547  69.5%  3261 2264s
  9444  3434 14295.9508   18  399 12301.7168 20763.8429  68.8%  3294 2303s
  9727  3490 infeasible   33      12301.7168 20686.1550  68.2%  3322 2345s
 10085  3513 15965.5594   28  108 12301.7168 20482.7781  66.5%  3328 2396s
 10425  3532     cutoff   30      12301.7168 20358.9881  65.5%  3347 2440s
 10796  3522 infeasible   24      12301.7168 20291.8257  65.0%  3364 2484s
 11157  3552 14085.1625   23  431 12301.7168 20147.8165  63.8%  3386 2531s
 11521  3510     cutoff   27      12301.7168 20011.8546  62.7%  3403 2579s
 11945  3473 infeasible   34      12301.7168 19887.8010  61.7%  3417 2629s
 12414  3517 15742.2150   25  150 12301.7168 19748.6108  60.5%  3425 2682s
 12922  3664 infeasible   43      12301.7168 19522.7085  58.7%  3424 2735s
 13379  3794 infeasible   24      12301.7168 19330.1782  57.1%  3422 2809s
 13934  3847 12494.9560   31  126 12301.7168 19262.6651  56.6%  3419 2857s
 14262  3978 12429.4975   30  244 12301.7168 19262.6651  56.6%  3405 2915s
 14851  4225 14026.4593   28  229 12301.7168 19191.9548  56.0%  3399 2981s
 15493  4404 infeasible   27      12301.7168 18957.4981  54.1%  3389 3049s
 16152  4641 14588.8216   24  320 12301.7168 18781.3292  52.7%  3381 3120s
 16843  4859 13436.2264   30   83 12301.7168 18695.3943  52.0%  3375 3188s
 17504  5103 infeasible   25      12301.7168 18499.0029  50.4%  3380 3257s
 18214  5359 16933.0142   20  284 12301.7168 18428.6972  49.8%  3378 3336s
 18996  5488 12449.9254   25  302 12301.7168 18203.9307  48.0%  3368 3414s
 19722  5660 infeasible   25      12301.7168 18123.8314  47.3%  3371 3492s
 20579  5837 13318.4778   25  385 12301.7168 17982.6470  46.2%  3360 3572s
 21389  5891 infeasible   21      12301.7168 17904.6123  45.5%  3360 3600s

Cutting planes:
  Learned: 3
  Implied bound: 1
  MIR: 951
  Mixing: 2
  Flow cover: 2057
  RLT: 10
  Relax-and-lift: 117

Explored 21682 nodes (73029255 simplex iterations) in 3600.04 seconds (10736.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12301.7 12294.4 12279.8 ... 9839.93

Time limit reached
Best objective 1.230171683025e+04, best bound 1.774485982424e+04, gap 44.2470%
  WARNING: Time limit reached. Using best solution found (gap: 44.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 12301.72, θ = 161507.72
  Upper Bound (UB) = 12301.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161507.72
  [DEBUG]   ✓ Scenario 0: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 161507.72 ≤ Q = 161507.72 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6669ccad
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x99963353
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362410e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6926716.2795
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.541191e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154119.07    0  130 6926716.28 -154119.07   102%     -    0s
H    0     0                    -116339.8967 -154119.07  32.5%     -    0s
H    0     0                    -116489.3461 -154119.07  32.3%     -    0s
     0     0 -129762.87    0   52 -116489.35 -129762.87  11.4%     -    0s
H    0     0                    -127683.1725 -129667.70  1.55%     -    0s
H    0     0                    -128020.9340 -129667.70  1.29%     -    0s
H    0     0                    -128321.0972 -129667.70  1.05%     -    0s
     0     0 -129667.70    0   36 -128321.10 -129667.70  1.05%     -    0s
     0     0 -129667.70    0   34 -128321.10 -129667.70  1.05%     -    0s
     0     0 -128976.01    0   34 -128321.10 -128976.01  0.51%     -    0s
H    0     0                    -128323.2365 -128964.21  0.50%     -    0s
     0     0 -128890.24    0   32 -128323.24 -128890.24  0.44%     -    0s
     0     0 -128890.24    0   32 -128323.24 -128890.24  0.44%     -    0s
H    0     0                    -128354.4886 -128890.24  0.42%     -    0s
     0     0 -128690.40    0   14 -128354.49 -128690.40  0.26%     -    0s
     0     0 -128690.27    0   12 -128354.49 -128690.27  0.26%     -    0s
     0     0 -128577.38    0   15 -128354.49 -128577.38  0.17%     -    0s
     0     0 -128571.91    0   13 -128354.49 -128571.91  0.17%     -    0s
     0     0 -128531.73    0   10 -128354.49 -128531.73  0.14%     -    0s
     0     0 -128531.73    0   27 -128354.49 -128531.73  0.14%     -    0s
     0     0 -128531.73    0   25 -128354.49 -128531.73  0.14%     -    0s
     0     0 -128531.73    0   13 -128354.49 -128531.73  0.14%     -    0s
     0     0 -128493.09    0   10 -128354.49 -128493.09  0.11%     -    0s
     0     0 -128438.25    0    9 -128354.49 -128438.25  0.07%     -    0s
H    0     0                    -128396.6923 -128435.80  0.03%     -    0s
     0     0 -128435.80    0    8 -128396.69 -128435.80  0.03%     -    0s
     0     0 -128418.27    0    5 -128396.69 -128418.27  0.02%     -    0s
     0     0 -128418.27    0    9 -128396.69 -128418.27  0.02%     -    0s
     0     0 -128418.27    0    6 -128396.69 -128418.27  0.02%     -    0s
H    0     0                    -128403.4691 -128418.27  0.01%     -    0s
     0     0 -128412.91    0    2 -128403.47 -128412.91  0.01%     -    0s
H    0     0                    -128407.0105 -128410.65  0.00%     -    0s
     0     0 -128410.20    0    2 -128407.01 -128410.20  0.00%     -    0s
*    0     0               0    -128408.5299 -128408.53  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 2
  Flow cover: 2
  RLT: 1

Explored 1 nodes (770 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128409 -128407 -128403 ... -116489
No other solutions better than -128409

Optimal solution found (tolerance 1.00e-06)
Best objective -1.284085298777e+05, best bound -1.284085298777e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 153948.44
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128408.53
  [DEBUG]   S×d_nominal = 282356.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282356.97 + -128408.53 = 153948.44
  [DEBUG]   Current θ from Master = 161507.72
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7559.27 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4742.44
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2959.9293, Absolute Gap = 2959.9293, Relative Gap = 0.240611
  Not converged yet (gap = 2959.93 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351535 nonzeros
Model fingerprint: 0x00fa1363
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 50904 rows and 20664 columns
Presolve time: 1.16s
Presolved: 72799 rows, 31516 columns, 453159 nonzeros
Variable types: 29257 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 72799 rows, 31516 columns, 453159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37491   -4.4522984e+04   0.000000e+00   1.711451e+07      5s
   50069    1.1032903e+04   0.000000e+00   8.824953e+07     10s
   59177    1.7622996e+04   0.000000e+00   1.679503e+07     15s
   68032    2.2573992e+04   0.000000e+00   7.030362e+06     20s
   75311    2.4119646e+04   0.000000e+00   1.261682e+06     25s
   83172    2.6615438e+04   0.000000e+00   5.866732e+08     30s
   90402    2.7774719e+04   0.000000e+00   3.138741e+08     35s
   98476    2.9473408e+04   0.000000e+00   1.102259e+08     40s
  104963    2.9690235e+04   0.000000e+00   2.354967e+07     45s
  112749    3.1834580e+04   0.000000e+00   2.785808e+06     50s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.843303e+04, 68926 iterations, 49.51 seconds (94.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 38433.0333    0  208 -219144.29 38433.0333   118%     -   51s
H    0     0                    -211639.7960 38433.0333   118%     -   51s
H    0     0                    -147401.6407 38433.0333   126%     -   51s
H    0     0                    -143033.1442 38433.0333   127%     -   51s
H    0     0                    -139615.9673 38433.0333   128%     -   51s
H    0     0                    -79896.65346 38433.0333   148%     -   51s
H    0     0                    -444.2471812 38433.0333  8751%     -   51s
H    0     0                    1648.8461537 38433.0333  2231%     -   52s
     0     0 34362.7969    0  310 1648.84615 34362.7969  1984%     -   67s
H    0     0                    4246.4649847 34361.7822   709%     -   67s
H    0     0                    4472.4505130 34361.7822   668%     -   67s
H    0     0                    4992.3949127 34361.7822   588%     -   67s
H    0     0                    5006.9987029 34361.7822   586%     -   67s
H    0     0                    5013.9749964 34361.7822   585%     -   67s
H    0     0                    5232.6802795 34361.7822   557%     -   67s
H    0     0                    5253.3786269 34361.7822   554%     -   67s
H    0     0                    5475.3296350 34361.7822   528%     -   67s
     0     0 33364.2732    0  304 5475.32963 33364.2732   509%     -   77s
     0     0 33127.5149    0  310 5475.32963 33127.5149   505%     -   79s
     0     0 33071.2186    0  310 5475.32963 33071.2186   504%     -   84s
     0     0 33071.2186    0  311 5475.32963 33071.2186   504%     -   85s
     0     0 33071.2186    0  319 5475.32963 33071.2186   504%     -   87s
     0     0 33071.2186    0  320 5475.32963 33071.2186   504%     -   88s
     0     0 33071.2186    0  320 5475.32963 33071.2186   504%     -   88s
     0     0 33071.2186    0  320 5475.32963 33071.2186   504%     -   88s
H    0     0                    9054.3629998 31182.4624   244%     -  100s
H    0     0                    9231.1122319 31182.4624   238%     -  100s
H    0     0                    9260.2338590 31182.4624   237%     -  100s
H    0     0                    9365.8340603 31182.4624   233%     -  100s
     0     0 31103.6554    0  268 9365.83406 31103.6554   232%     -  100s
H    0     0                    9381.8827962 31103.6554   232%     -  101s
     0     0 30398.3614    0  283 9381.88280 30398.3614   224%     -  110s
     0     0 30102.3485    0  279 9381.88280 30102.3485   221%     -  114s
     0     0 30065.9296    0  284 9381.88280 30065.9296   220%     -  117s
     0     0 30045.3459    0  284 9381.88280 30045.3459   220%     -  118s
     0     0 30013.5986    0  293 9381.88280 30013.5986   220%     -  120s
     0     0 29986.1557    0  280 9381.88280 29986.1557   220%     -  121s
     0     0 29972.9112    0  285 9381.88280 29972.9112   219%     -  122s
     0     0 29970.5241    0  283 9381.88280 29970.5241   219%     -  123s
     0     0 29966.9968    0  290 9381.88280 29966.9968   219%     -  123s
     0     0 29966.0756    0  292 9381.88280 29966.0756   219%     -  124s
     0     0 29965.7944    0  292 9381.88280 29965.7944   219%     -  124s
     0     0 29096.3724    0  320 9381.88280 29096.3724   210%     -  139s
     0     0 28595.1434    0  308 9381.88280 28595.1434   205%     -  147s
     0     0 28457.0371    0  302 9381.88280 28457.0371   203%     -  150s
     0     0 28373.7918    0  298 9381.88280 28373.7918   202%     -  154s
     0     0 28354.7691    0  302 9381.88280 28354.7691   202%     -  156s
     0     0 28335.0449    0  298 9381.88280 28335.0449   202%     -  158s
     0     0 28293.2825    0  300 9381.88280 28293.2825   202%     -  160s
     0     0 28275.0853    0  301 9381.88280 28275.0853   201%     -  162s
     0     0 28268.7789    0  291 9381.88280 28268.7789   201%     -  162s
     0     0 28266.5869    0  295 9381.88280 28266.5869   201%     -  163s
     0     0 28261.7215    0  286 9381.88280 28261.7215   201%     -  164s
     0     0 28256.9632    0  291 9381.88280 28256.9632   201%     -  165s
     0     0 28255.5349    0  294 9381.88280 28255.5349   201%     -  165s
     0     0 28255.1090    0  297 9381.88280 28255.1090   201%     -  166s
     0     0 27724.4678    0  377 9381.88280 27724.4678   196%     -  180s
     0     0 27573.9961    0  374 9381.88280 27573.9961   194%     -  185s
     0     0 27498.1052    0  386 9381.88280 27498.1052   193%     -  189s
     0     0 27413.8543    0  410 9381.88280 27413.8543   192%     -  191s
     0     0 27400.6777    0  381 9381.88280 27400.6777   192%     -  193s
     0     0 27372.2547    0  416 9381.88280 27372.2547   192%     -  195s
     0     0 27359.2151    0  420 9381.88280 27359.2151   192%     -  196s
     0     0 27354.7770    0  377 9381.88280 27354.7770   192%     -  196s
     0     0 27352.0044    0  374 9381.88280 27352.0044   192%     -  197s
     0     0 27350.7580    0  414 9381.88280 27350.7580   192%     -  197s
     0     0 27284.2288    0  409 9381.88280 27284.2288   191%     -  202s
     0     0 27257.2856    0  375 9381.88280 27257.2856   191%     -  204s
     0     0 27253.0042    0  461 9381.88280 27253.0042   190%     -  205s
     0     0 27251.4864    0  378 9381.88280 27251.4864   190%     -  205s
     0     0 27244.9790    0  374 9381.88280 27244.9790   190%     -  205s
     0     0 27243.9067    0  370 9381.88280 27243.9067   190%     -  206s
     0     0 27193.4644    0  424 9381.88280 27193.4644   190%     -  209s
H    0     0                    10515.492466 27193.1103   159%     -  213s
     0     0 27168.8365    0  446 10515.4925 27168.8365   158%     -  215s
     0     0 27144.1004    0  443 10515.4925 27144.1004   158%     -  217s
     0     0 27140.8672    0  397 10515.4925 27140.8672   158%     -  218s
     0     0 27140.0283    0  394 10515.4925 27140.0283   158%     -  218s
     0     0 27114.8728    0  455 10515.4925 27114.8728   158%     -  222s
H    0     0                    10567.928866 27114.2012   157%     -  222s
H    0     0                    10758.507866 27114.2012   152%     -  222s
     0     0 27109.9388    0  452 10758.5079 27109.9388   152%     -  223s
     0     0 27107.7722    0  466 10758.5079 27107.7722   152%     -  224s
     0     0 27106.1357    0  460 10758.5079 27106.1357   152%     -  224s
     0     0 27105.9205    0  468 10758.5079 27105.9205   152%     -  224s
     0     0 27098.8005    0  417 10758.5079 27098.8005   152%     -  227s
H    0     0                    10767.685553 27098.6164   152%     -  227s
     0     0 27097.7510    0  424 10767.6856 27097.7510   152%     -  228s
     0     0 27085.9261    0  428 10767.6856 27085.9261   152%     -  230s
     0     0 27084.2431    0  479 10767.6856 27084.2431   152%     -  231s
     0     0 27083.9931    0  478 10767.6856 27083.9931   152%     -  232s
     0     0 27078.5819    0  468 10767.6856 27078.5819   151%     -  233s
H    0     0                    11120.598231 27070.6173   143%     -  237s
H    0     0                    11141.514855 27070.6173   143%     -  237s
H    0     0                    11193.410607 27070.6173   142%     -  237s
     0     0 27070.6173    0  473 11193.4106 27070.6173   142%     -  237s
     0     0 27070.6173    0  364 11193.4106 27070.6173   142%     -  239s
     0     0 27068.0763    0  423 11193.4106 27068.0763   142%     -  239s
     0     0 27068.0763    0  468 11193.4106 27068.0763   142%     -  240s
     0     0 27068.0763    0  469 11193.4106 27068.0763   142%     -  241s
     0     0 27068.0763    0  469 11193.4106 27068.0763   142%     -  243s
H    0     0                    11330.446226 27068.0763   139%     -  271s
H    0     0                    11339.623913 27068.0763   139%     -  271s
H    0     0                    11754.453939 27068.0763   130%     -  272s
H    0     0                    11882.814852 27068.0763   128%     -  273s
H    0     2                    12157.146973 27068.0763   123%     -  302s
     0     2 27068.0763    0  469 12157.1470 27068.0763   123%     -  302s
     1     4 26626.2383    1  455 12157.1470 27068.0763   123%  7821  308s
     3     8 26549.9832    2  445 12157.1470 26844.0590   121%  5558  315s
     7    16 26408.6826    3  447 12157.1470 26637.8770   119%  6669  328s
    15    32 26229.5524    4  414 12157.1470 26444.6819   118%  8237  345s
    31    49 15226.7531    5  255 12157.1470 26277.2328   116% 14170  372s
    48    81 24163.8929    6  384 12157.1470 26277.2328   116% 13205  412s
    80   237 24078.4707    7  379 12157.1470 26277.2328   116% 10283  433s
   236   314 23621.8137   10  357 12157.1470 26277.2328   116%  5389  444s
   330   344 23443.6319    9  340 12157.1470 26277.2328   116%  4536  452s
   362   373 23175.8704    9  353 12157.1470 26277.2328   116%  4396  461s
   405   395 23196.8760   11  346 12157.1470 26277.2328   116%  4313  471s
   435   429 23282.0662   11  371 12157.1470 26277.2328   116%  4300  481s
H  469   429                    12169.735657 26277.2328   116%  4242  481s
   477   460 23220.5535   11  357 12169.7357 26277.2328   116%  4273  492s
   524   530 23202.6735   11  347 12169.7357 26277.2328   116%  4225  502s
   606   554 23004.2532   11  351 12169.7357 26277.2328   116%  3941  511s
   636   585 22863.4806   12  334 12169.7357 26277.2328   116%  3867  520s
   671   622 23107.9473   12  282 12169.7357 26277.2328   116%  3831  530s
   718   665 21999.9083   13  273 12169.7357 26277.2328   116%  3710  539s
   769   706 21081.1093   13  230 12169.7357 26277.2328   116%  3614  547s
   818   747 21243.2327   14  266 12169.7357 26277.2328   116%  3507  557s
   867   773 20393.0097   14  364 12169.7357 26277.2328   116%  3416  566s
   903   809 20656.1286   15  266 12169.7357 26277.2328   116%  3354  578s
   939   834 19844.4961   17  330 12169.7357 26277.2328   116%  3346  588s
   982   866     cutoff   17      12169.7357 26277.2328   116%  3379  597s
  1030   905 19692.3690   18  251 12169.7357 26229.5262   116%  3317  607s
  1085   952 19571.3409   20  269 12169.7357 26229.5262   116%  3300  617s
  1162  1013 19307.1722   22  187 12169.7357 26229.5262   116%  3232  629s
  1251  1083 18377.4640   25  177 12169.7357 26100.9543   114%  3133  640s
  1337  1163 18610.4111   24  173 12169.7357 25819.2409   112%  3072  652s
  1449  1222 18322.5529   27  182 12169.7357 25819.2409   112%  2970  664s
  1542  1283 18470.3020   28  184 12169.7357 25819.2409   112%  2883  677s
  1672  1353 16949.0318   28  187 12169.7357 25819.2409   112%  2781  690s
  1808  1424     cutoff   29      12169.7357 25698.3443   111%  2705  705s
  1927  1498 17668.7151   30  180 12169.7357 25697.7039   111%  2682  720s
  2035  1594 17115.2425   33  293 12169.7357 25697.7039   111%  2684  734s
  2169  1718 17078.4523   34  259 12169.7357 25697.7039   111%  2658  748s
  2347  1840 16758.2666   36  217 12169.7357 25697.7039   111%  2593  763s
  2519  1933 16005.6630   36  204 12169.7357 25607.2954   110%  2554  779s
  2707  2039 16262.9196   39  210 12169.7357 25607.2954   110%  2506  797s
  2879  2096 15745.3039   43  214 12169.7357 24999.3030   105%  2489  812s
  2976  2192 15271.2072   48  135 12169.7357 24999.3030   105%  2491  831s
  3100  2294     cutoff   50      12169.7357 24835.0965   104%  2498  849s
  3252  2423 13445.6715   56  198 12169.7357 24791.4205   104%  2504  867s
  3421  2568 13138.1758   60  132 12169.7357 24715.2076   103%  2511  887s
  3621  2569 13870.4576   56  469 12169.7357 24715.2076   103%  2501  938s
  3623  2570 18467.1689   17  208 12169.7357 24715.2076   103%  2499  992s
  3624  2571 16602.0785   32  337 12169.7357 24715.2076   103%  2498 1022s
  3625  2572 18372.2560   26  440 12169.7357 24715.2076   103%  2498 1048s
  3626  2572 20186.6640   26  380 12169.7357 24715.2076   103%  2497 1068s
  3627  2573 14644.6393   68  383 12169.7357 24715.2076   103%  2496 1076s
  3628  2574 14825.3949   39  368 12169.7357 24715.2076   103%  2496 1082s
  3629  2574 16817.4426   29  405 12169.7357 24715.2076   103%  2495 1086s
  3631  2576 13407.2466   29  347 12169.7357 24715.2076   103%  2494 1092s
  3632  2576 14319.8157   55  401 12169.7357 24715.2076   103%  2493 1095s
  3634  2578 16539.9706   13  462 12169.7357 24715.2076   103%  2492 1100s
  3635  2578 19820.4993   32  449 12169.7357 24715.2076   103%  2491 1109s
  3636  2579 13205.9286   49  493 12169.7357 24715.2076   103%  2490 1111s
  3638  2580 22694.8345   10  425 12169.7357 24715.2076   103%  2489 1116s
  3639  2581 18945.3117   31  421 12169.7357 24715.2076   103%  2488 1120s
  3641  2582 23211.5852    9  428 12169.7357 24715.2076   103%  2487 1129s
  3642  2583 19076.2196   20  469 12169.7357 24715.2076   103%  2486 1132s
  3643  2584 22742.0593   14  427 12169.7357 24715.2076   103%  2485 1136s
  3645  2585 21289.9686   13  430 12169.7357 24715.2076   103%  2484 1150s
  3647  2586 15778.4865   29  425 12169.7357 24715.2076   103%  2483 1160s
  3649  2588 17022.6626   29  470 12169.7357 24715.2076   103%  2481 1172s
  3651  2589 18381.3273   30  445 12169.7357 24715.2076   103%  2480 1177s
  3652  2590 16031.4090   56  433 12169.7357 24715.2076   103%  2479 1181s
  3653  2590 22441.5969   11  433 12169.7357 24715.2076   103%  2479 1226s
  3654  2591 14730.0697   40  433 12169.7357 24715.2076   103%  2478 1266s
  3655  2595 24715.2076   11  418 12169.7357 24715.2076   103%  2543 1283s
  3657  2598 24715.2076   12  404 12169.7357 24715.2076   103%  2545 1304s
  3661  2605 24715.2076   13  412 12169.7357 24715.2076   103%  2552 1328s
  3669  2618 24715.2076   14  433 12169.7357 24715.2076   103%  2573 1353s
  3685  2629 24334.0317   15  437 12169.7357 24715.2076   103%  2626 1387s
  3701  2655 23516.5979   16  423 12169.7357 24715.2076   103%  2719 1421s
  3733  2677 22776.6670   17  420 12169.7357 24715.2076   103%  2754 1441s
  3765  2699 22475.9225   18  406 12169.7357 24715.2076   103%  2861 1462s
  3798  2748 22152.0157   19  354 12169.7357 24715.2076   103%  2902 1488s
  3862  2792 20482.5849   18  318 12169.7357 24715.2076   103%  2954 1512s
  3941  2833 14929.6489   19  432 12169.7357 24715.2076   103%  2992 1533s
  4041  2840 20966.2086   20  246 12169.7357 24715.2076   103%  3001 1560s
  4127  2856 20591.3735   20  390 12169.7357 24715.2076   103%  3006 1578s
  4210  2866 18903.7451   19  241 12169.7357 24715.2076   103%  3015 1598s
  4289  2885 18725.4424   19  346 12169.7357 24715.2076   103%  3017 1620s
  4354  2913 18050.9682   20  384 12169.7357 24715.2076   103%  3035 1635s
  4419  2938 17708.9459   21  345 12169.7357 24715.2076   103%  3044 1649s
  4502  2949 17537.1627   22  323 12169.7357 24715.2076   103%  3038 1662s
  4581  2944 17145.1187   23  359 12169.7357 24715.2076   103%  3031 1678s
  4661  2932 16860.8824   23  299 12169.7357 24715.2076   103%  3023 1693s
  4741  2926 16782.2222   24  347 12169.7357 24715.2076   103%  3018 1709s
  4816  2929 15573.6004   25  181 12169.7357 24715.2076   103%  3024 1732s
  4898  2937 15132.8296   28  157 12169.7357 24715.2076   103%  3031 1753s
  4970  2936 14411.0511   32  192 12169.7357 24715.2076   103%  3049 1768s
  5018  2955 14054.8144   34  206 12169.7357 24715.2076   103%  3061 1785s
  5094  2958 13688.0781   38  122 12169.7357 24715.2076   103%  3074 1806s
  5178  2986 13430.7095   40  189 12169.7357 24715.2076   103%  3085 1825s
  5273  2999     cutoff   42      12169.7357 24715.2076   103%  3100 1848s
  5363  3005 18148.1375   17  419 12169.7357 24668.0466   103%  3118 1870s
  5476  3020 23197.3498   17  389 12169.7357 24667.8783   103%  3122 1901s
  5593  3034 17548.4500   18  353 12169.7357 24667.8783   103%  3133 1924s
  5707  3014 20707.7685   19  465 12169.7357 24667.8783   103%  3155 1942s
  5750  3024 18126.0719   20  432 12169.7357 24667.8783   103%  3163 1961s
  5791  3033 20120.1426   20  364 12169.7357 24667.8783   103%  3173 1979s
  5838  3041 19610.7344   22  453 12169.7357 24435.7614   101%  3183 2002s
  5900  3059 14841.6081   24  402 12169.7357 24435.7614   101%  3192 2028s
  5979  3102     cutoff   25      12169.7357 23898.2288  96.4%  3206 2051s
  6065  3162 16978.6146   24  445 12169.7357 23898.2288  96.4%  3224 2078s
  6215  3191 14562.7940   27  316 12169.7357 23898.2288  96.4%  3231 2106s
  6394  3224     cutoff   27      12169.7357 23898.2288  96.4%  3236 2138s
  6621  3235     cutoff   31      12169.7357 23898.2288  96.4%  3221 2174s
  6806  3257 16995.8658   24  278 12169.7357 22744.0029  86.9%  3235 2209s
  7016  3306 16623.3947   26  397 12169.7357 22743.8598  86.9%  3239 2241s
  7255  3285 13586.4186   31  112 12169.7357 21911.8424  80.1%  3227 2277s
  7487  3309 12379.2723   36  175 12169.7357 21790.3633  79.1%  3230 2313s
  7656  3345 17508.6681   22  353 12169.7357 21752.1679  78.7%  3268 2353s
  7884  3335     cutoff   27      12169.7357 21745.3418  78.7%  3280 2390s
  8148  3338 14485.3427   31  132 12169.7357 21444.3111  76.2%  3279 2434s
  8426  3363     cutoff   35      12169.7357 21370.6245  75.6%  3284 2477s
  8717  3375 12650.8453   22  314 12169.7357 21264.5080  74.7%  3286 2518s
  9054  3394 13466.9290   20  480 12169.7357 21231.7705  74.5%  3278 2562s
  9375  3411     cutoff   22      12169.7357 20898.2611  71.7%  3276 2610s
  9701  3405 14467.4927   23  143 12169.7357 20738.1466  70.4%  3283 2657s
 10033  3439 17563.2768   21  433 12169.7357 20608.5373  69.3%  3293 2707s
 10371  3472 14629.4980   28  320 12169.7357 20546.1373  68.8%  3302 2766s
 10749  3465 12556.3081   28  270 12169.7357 20368.9488  67.4%  3303 2821s
 11186  3395 15773.2131   32   83 12169.7357 20107.9239  65.2%  3294 2875s
 11541  3486     cutoff   27      12169.7357 19960.8479  64.0%  3311 2932s
 11915  3560 12363.5164   25  315 12169.7357 19861.0307  63.2%  3323 2991s
 12323  3617     cutoff   23      12169.7357 19811.5236  62.8%  3329 3056s
 12767  3764 17197.7118   27  264 12169.7357 19811.5236  62.8%  3338 3117s
 13241  3838     cutoff   26      12169.7357 19363.2591  59.1%  3341 3182s
 13707  3974 13703.9806   24  274 12169.7357 19338.8322  58.9%  3351 3250s
 14176  3987 infeasible   27      12169.7357 19148.2004  57.3%  3361 3300s
 14243  4018     cutoff   29      12169.7357 19140.2832  57.3%  3362 3365s
 14671  4121     cutoff   20      12169.7357 19126.4460  57.2%  3351 3438s
 15298  4271     cutoff   30      12169.7357 19126.4460  57.2%  3347 3514s
 15892  4461 14265.0356   30  303 12169.7357 18742.7693  54.0%  3351 3594s
 16513  4467 12937.9993   24  341 12169.7357 18578.6630  52.7%  3353 3600s

Cutting planes:
  Learned: 2
  MIR: 790
  Flow cover: 1903
  RLT: 16
  Relax-and-lift: 128

Explored 16571 nodes (55741227 simplex iterations) in 3600.04 seconds (10592.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12169.7 12157.1 11882.8 ... 10767.7

Time limit reached
Best objective 1.216973565732e+04, best bound 1.857866296234e+04, gap 52.6628%
  WARNING: Time limit reached. Using best solution found (gap: 52.66%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.04s
  Master Objective (UB) = 12169.74, θ = 160277.34
  Upper Bound (UB) = 12169.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160277.34
  [DEBUG]   ✓ Scenario 0: θ = 160277.34 ≤ Q = 160277.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160277.34 ≤ Q = 160277.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160277.34 ≤ Q = 160277.34 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160277.34 ≤ Q = 160277.34 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160277.34 ≤ Q = 160277.34 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x55714c27
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xaa8eb3d9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.316019e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6757991.5342
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.556714e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155671.38    0  132 6757991.53 -155671.38   102%     -    0s
H    0     0                    -117350.7404 -155671.38  32.7%     -    0s
H    0     0                    -118169.7874 -155671.38  31.7%     -    0s
H    0     0                    -129320.7539 -132311.83  2.31%     -    0s
     0     0 -132311.83    0   63 -129320.75 -132311.83  2.31%     -    0s
H    0     0                    -129649.5559 -132193.33  1.96%     -    0s
H    0     0                    -130269.9298 -132193.33  1.48%     -    0s
H    0     0                    -130598.7317 -132193.33  1.22%     -    0s
     0     0 -132106.28    0   60 -130598.73 -132106.28  1.15%     -    0s
     0     0 -131569.43    0   47 -130598.73 -131569.43  0.74%     -    0s
     0     0 -131525.54    0   47 -130598.73 -131525.54  0.71%     -    0s
     0     0 -131513.62    0   47 -130598.73 -131513.62  0.70%     -    0s
     0     0 -131364.71    0   47 -130598.73 -131364.71  0.59%     -    0s
     0     0 -131336.70    0   47 -130598.73 -131336.70  0.57%     -    0s
     0     0 -131259.09    0   47 -130598.73 -131259.09  0.51%     -    0s
H    0     0                    -130686.3743 -131259.09  0.44%     -    0s
     0     0 -131107.42    0   40 -130686.37 -131107.42  0.32%     -    0s
     0     0 -131089.59    0   30 -130686.37 -131089.59  0.31%     -    0s
     0     0 -131088.83    0   30 -130686.37 -131088.83  0.31%     -    0s
     0     0 -131088.83    0   58 -130686.37 -131088.83  0.31%     -    0s
     0     0 -131088.83    0   58 -130686.37 -131088.83  0.31%     -    0s
     0     0 -131084.74    0   21 -130686.37 -131084.74  0.30%     -    0s
     0     0 -130953.03    0   15 -130686.37 -130953.03  0.20%     -    0s
     0     0 -130890.39    0   14 -130686.37 -130890.39  0.16%     -    0s
     0     0 -130850.64    0   15 -130686.37 -130850.64  0.13%     -    0s
     0     0 -130850.64    0   15 -130686.37 -130850.64  0.13%     -    0s
H    0     0                    -130686.6909 -130850.64  0.13%     -    0s
     0     0 -130850.64    0   15 -130686.69 -130850.64  0.13%     -    0s
H    0     0                    -130716.9872 -130850.64  0.10%     -    0s
     0     0 -130780.44    0    7 -130716.99 -130780.44  0.05%     -    0s
     0     0 -130780.25    0    5 -130716.99 -130780.25  0.05%     -    0s
H    0     0                    -130764.9027 -130770.43  0.00%     -    0s
     0     0     cutoff    0      -130764.90 -130764.90  0.00%     -    0s

Cutting planes:
  Gomory: 21
  Implied bound: 24
  MIR: 17
  Flow cover: 9
  RLT: 7
  Relax-and-lift: 6

Explored 1 nodes (923 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130765 -130717 -130687 ... 1.31602e+13
No other solutions better than -130765

Optimal solution found (tolerance 1.00e-06)
Best objective -1.307649026990e+05, best bound -1.307649026990e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 151640.71
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130764.90
  [DEBUG]   S×d_nominal = 282405.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282405.62 + -130764.90 = 151640.71
  [DEBUG]   Current θ from Master = 160277.34
  [DEBUG]   ⚠️  Z_SP ≤ θ by 8636.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3533.11
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2827.9481, Absolute Gap = 2827.9481, Relative Gap = 0.232375
  Not converged yet (gap = 2827.95 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 21 increases, 39 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394787 nonzeros
Model fingerprint: 0xa0dfb7fe
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 57267 rows and 23247 columns
Presolve time: 1.16s
Presolved: 81726 rows, 35173 columns, 500096 nonzeros
Variable types: 32914 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346845.8465
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.397e+06
 Factor NZ  : 7.331e+06 (roughly 100 MB of memory)
 Factor Ops : 1.231e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.40268063e+07  1.60914994e+08  9.07e+04 2.09e+01  7.15e+04     2s
   1  -1.04345710e+07  1.38592322e+08  6.21e+04 6.63e+01  4.83e+04     2s
   2  -3.47341252e+06  1.06134538e+08  2.04e+04 9.95e-12  1.68e+04     2s
   3  -7.20696558e+05  7.13035030e+07  1.66e+03 1.43e+00  1.74e+03     2s
   4  -4.63067102e+05  2.72977717e+07  3.94e+02 2.45e-01  4.45e+02     2s
   5  -3.59090835e+05  1.77910805e+07  1.72e+02 1.39e-01  2.25e+02     2s
   6  -2.20896064e+05  1.21372136e+07  4.99e+01 8.39e-02  1.09e+02     2s
   7  -1.48153635e+05  9.47005170e+06  2.37e+01 6.30e-02  7.49e+01     2s
   8  -1.08186141e+05  4.47127603e+06  1.27e+01 2.57e-02  3.39e+01     2s
   9  -8.57731548e+04  2.56069909e+06  6.25e+00 1.40e-02  1.87e+01     2s
  10  -5.49214058e+04  5.99372540e+05  1.54e+00 2.77e-03  4.44e+00     2s
  11  -3.02063347e+04  3.04073746e+05  8.63e-01 1.42e-03  2.25e+00     2s
  12  -7.30157869e+03  1.73584464e+05  4.81e-01 1.29e-03  1.22e+00     3s
  13  -1.15968701e+02  1.23163097e+05  3.99e-01 1.71e-03  8.29e-01     3s
  14   4.65536257e+03  1.13598684e+05  3.47e-01 1.72e-03  7.32e-01     3s
  15   8.80070528e+03  9.75845608e+04  3.04e-01 1.65e-03  5.97e-01     3s
  16   1.44046622e+04  7.79981135e+04  2.50e-01 2.76e-03  4.28e-01     3s
  17   2.09624420e+04  7.01362833e+04  1.86e-01 2.89e-03  3.31e-01     3s
  18   2.33342904e+04  6.22945718e+04  1.66e-01 2.60e-03  2.62e-01     3s
  19   2.83839312e+04  6.07167442e+04  1.22e-01 2.69e-03  2.17e-01     3s
  20   3.08079046e+04  5.66872878e+04  1.03e-01 2.00e-03  1.74e-01     3s
  21   3.20240308e+04  5.49173516e+04  9.37e-02 1.44e-03  1.54e-01     3s
  22   3.54771628e+04  5.31460730e+04  6.80e-02 1.92e-03  1.19e-01     3s
  23   3.76384608e+04  5.09294738e+04  5.30e-02 2.18e-03  8.94e-02     3s
  24   3.88109201e+04  4.99932845e+04  4.52e-02 1.59e-03  7.52e-02     3s
  25   4.03162541e+04  4.95608436e+04  3.53e-02 1.48e-03  6.21e-02     3s
  26   4.14375075e+04  4.90380128e+04  2.83e-02 1.36e-03  5.11e-02     3s
  27   4.21052014e+04  4.80997384e+04  2.41e-02 9.34e-04  4.03e-02     3s
  28   4.31964293e+04  4.78008776e+04  1.76e-02 6.70e-04  3.10e-02     3s
  29   4.36218987e+04  4.75899877e+04  1.51e-02 5.75e-04  2.67e-02     3s
  30   4.42906986e+04  4.73641758e+04  1.11e-02 4.76e-04  2.06e-02     3s
  31   4.48228502e+04  4.69995500e+04  7.96e-03 3.07e-04  1.46e-02     3s
  32   4.53373849e+04  4.68089529e+04  5.03e-03 2.45e-04  9.88e-03     3s
  33   4.55119802e+04  4.65975453e+04  4.04e-03 2.00e-04  7.30e-03     3s
  34   4.58037880e+04  4.64901695e+04  2.43e-03 1.28e-04  4.61e-03     3s
  35   4.58660604e+04  4.64727266e+04  2.11e-03 1.16e-04  4.07e-03     3s
  36   4.60247692e+04  4.63672286e+04  1.28e-03 4.80e-05  2.30e-03     3s
  37   4.61567190e+04  4.63525973e+04  6.07e-04 3.87e-05  1.31e-03     3s
  38   4.62211067e+04  4.63158084e+04  3.07e-04 1.63e-05  6.36e-04     3s
  39   4.62395511e+04  4.62944171e+04  2.19e-04 9.05e-06  3.69e-04     3s
  40   4.62697519e+04  4.62917177e+04  7.72e-05 5.09e-06  1.48e-04     4s
  41   4.62831864e+04  4.62900839e+04  1.73e-05 2.88e-06  4.62e-05     4s
  42   4.62861005e+04  4.62885628e+04  6.10e-06 1.01e-06  1.65e-05     4s
  43   4.62872849e+04  4.62881156e+04  1.63e-06 4.63e-07  5.56e-06     4s
  44   4.62876377e+04  4.62877820e+04  2.73e-07 7.06e-08  9.66e-07     4s
  45   4.62877188e+04  4.62877195e+04  1.69e-08 7.20e-08  4.57e-09     4s
  46   4.62877188e+04  4.62877195e+04  1.20e-06 7.09e-08  4.55e-09     4s
  47   4.62877188e+04  4.62877195e+04  1.25e-06 2.67e-08  3.90e-09     4s
  48   4.62877193e+04  4.62877193e+04  1.02e-07 2.51e-08  7.16e-11     4s

Barrier solved model in 48 iterations and 3.81 seconds (6.68 work units)
Optimal objective 4.62877193e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1025 PPushes remaining with PInf 2.5015423e-06                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.8662398e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39454    4.6287719e+04   0.000000e+00   0.000000e+00      6s
   39454    4.6287719e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.628772e+04, 39454 iterations, 4.83 seconds (11.17 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46287.7193    0  233 -219144.29 46287.7193   121%     -    6s
H    0     0                    -214512.9736 46287.7193   122%     -    6s
H    0     0                    -120925.9849 46287.7193   138%     -    6s
H    0     0                    -120653.2763 46287.7193   138%     -    7s
H    0     0                    -30514.45009 46287.7193   252%     -    7s
H    0     0                    -11523.59250 46287.7193   502%     -    7s
H    0     0                    -9748.944047 46287.7193   575%     -    7s
H    0     0                    -9678.897154 46287.7193   578%     -    7s
H    0     0                    -8547.187699 46287.7193   642%     -    7s
H    0     0                    -8139.779245 38417.2971   572%     -   34s
H    0     0                    -7952.496883 38417.2971   583%     -   34s
H    0     0                    -7793.058729 38417.2971   593%     -   34s
H    0     0                    -7638.626709 38417.2971   603%     -   34s
H    0     0                    -7614.637215 38417.2971   605%     -   34s
H    0     0                    -7605.306627 38417.2971   605%     -   34s
     0     0 38290.1401    0  343 -7605.3066 38290.1401   603%     -   34s
     0     0 38186.7154    0  342 -7605.3066 38186.7154   602%     -   44s
     0     0 38186.7154    0  341 -7605.3066 38186.7154   602%     -   47s
     0     0 38186.7154    0  347 -7605.3066 38186.7154   602%     -   49s
     0     0 38186.7154    0  357 -7605.3066 38186.7154   602%     -   53s
     0     0 38149.7241    0  339 -7605.3066 38149.7241   602%     -   56s
     0     0 38149.6892    0  339 -7605.3066 38149.6892   602%     -   56s
H    0     0                    -6887.802943 33711.6076   589%     -   90s
H    0     0                    -6852.373998 33711.6076   592%     -   90s
     0     0 33711.6076    0  293 -6852.3740 33711.6076   592%     -   91s
H    0     0                    -2780.294463 33711.5595  1313%     -   91s
H    0     0                    -2653.165623 33711.5595  1371%     -   91s
H    0     0                    -1178.083789 33711.5595  2962%     -   91s
     0     0 32804.0494    0  385 -1178.0838 32804.0494  2885%     -  107s
     0     0 32666.5450    0  368 -1178.0838 32666.5450  2873%     -  116s
     0     0 32606.8504    0  371 -1178.0838 32606.8504  2868%     -  121s
H    0     0                    -1081.148126 32406.1183  3097%     -  133s
H    0     0                    -910.6363512 32406.1183  3659%     -  133s
H    0     0                    -883.5086458 32406.1183  3768%     -  133s
H    0     0                    -594.8014825 32406.1183  5548%     -  133s
     0     0 32406.1183    0  398 -594.80148 32406.1183  5548%     -  133s
     0     0 32373.7432    0  387 -594.80148 32373.7432  5543%     -  136s
     0     0 32362.1569    0  400 -594.80148 32362.1569  5541%     -  140s
     0     0 32330.8395    0  387 -594.80148 32330.8395  5536%     -  143s
     0     0 32311.5194    0  393 -594.80148 32311.5194  5532%     -  145s
     0     0 32304.3642    0  389 -594.80148 32304.3642  5531%     -  147s
     0     0 32302.5559    0  390 -594.80148 32302.5559  5531%     -  147s
H    0     0                    2837.0592202 32302.5559  1039%     -  157s
H    0     0                    4149.6852974 32302.5559   678%     -  157s
H    0     0                    4942.0137567 32302.5559   554%     -  157s
H    0     0                    5253.9889610 32302.5559   515%     -  157s
H    0     0                    5314.0893193 32302.5559   508%     -  157s
H    0     0                    5524.1353342 32302.5559   485%     -  157s
H    0     0                    5789.6744885 30151.5245   421%     -  177s
H    0     0                    5857.9220620 30151.5245   415%     -  177s
H    0     0                    5942.8933437 30151.5245   407%     -  177s
H    0     0                    5957.5036954 30151.5245   406%     -  177s
H    0     0                    6361.1468477 30151.5245   374%     -  177s
H    0     0                    7058.8892853 30151.5245   327%     -  177s
H    0     0                    7077.0218601 30151.5245   326%     -  177s
H    0     0                    7077.8959708 30151.5245   326%     -  177s
H    0     0                    7092.2568989 30151.5245   325%     -  177s
     0     0 30151.5245    0  427 7092.25690 30151.5245   325%     -  177s
H    0     0                    7248.3647211 30143.6901   316%     -  178s
H    0     0                    7265.0138840 30143.6901   315%     -  178s
H    0     0                    7287.5619248 30143.6901   314%     -  178s
H    0     0                    7325.7481410 30143.6901   311%     -  178s
H    0     0                    7372.2818506 30143.6901   309%     -  178s
     0     0 29773.2566    0  433 7372.28185 29773.2566   304%     -  190s
     0     0 29652.9917    0  442 7372.28185 29652.9917   302%     -  196s
     0     0 29528.5760    0  440 7372.28185 29528.5760   301%     -  203s
     0     0 29508.5360    0  448 7372.28185 29508.5360   300%     -  206s
     0     0 29490.5630    0  445 7372.28185 29490.5630   300%     -  208s
     0     0 29476.2954    0  450 7372.28185 29476.2954   300%     -  211s
     0     0 29467.4940    0  470 7372.28185 29467.4940   300%     -  215s
     0     0 29464.1641    0  476 7372.28185 29464.1641   300%     -  217s
     0     0 29462.3692    0  478 7372.28185 29462.3692   300%     -  218s
     0     0 28186.3520    0  436 7372.28185 28186.3520   282%     -  258s
H    0     0                    7411.0937652 28186.0091   280%     -  258s
H    0     0                    7411.7963431 28186.0091   280%     -  258s
H    0     0                    7426.3575161 28186.0091   280%     -  258s
     0     0 27923.7110    0  435 7426.35752 27923.7110   276%     -  272s
     0     0 27853.6413    0  453 7426.35752 27853.6413   275%     -  276s
     0     0 27831.5090    0  399 7426.35752 27831.5090   275%     -  280s
     0     0 27815.8503    0  394 7426.35752 27815.8503   275%     -  283s
     0     0 27808.0920    0  394 7426.35752 27808.0920   274%     -  285s
     0     0 27801.7326    0  394 7426.35752 27801.7326   274%     -  286s
     0     0 27787.1976    0  341 7426.35752 27787.1976   274%     -  288s
     0     0 27782.8589    0  363 7426.35752 27782.8589   274%     -  291s
     0     0 27781.6301    0  352 7426.35752 27781.6301   274%     -  291s
     0     0 27486.4801    0  406 7426.35752 27486.4801   270%     -  303s
H    0     0                    7430.2396034 27484.9981   270%     -  303s
     0     0 27448.6716    0  415 7430.23960 27448.6716   269%     -  306s
     0     0 27440.5186    0  401 7430.23960 27440.5186   269%     -  307s
     0     0 27437.8631    0  412 7430.23960 27437.8631   269%     -  308s
     0     0 27294.7506    0  461 7430.23960 27294.7506   267%     -  315s
     0     0 27274.4522    0  472 7430.23960 27274.4522   267%     -  319s
     0     0 27267.4128    0  471 7430.23960 27267.4128   267%     -  321s
     0     0 27261.5643    0  475 7430.23960 27261.5643   267%     -  322s
     0     0 27257.6272    0  468 7430.23960 27257.6272   267%     -  324s
     0     0 27254.1466    0  473 7430.23960 27254.1466   267%     -  324s
     0     0 27253.5922    0  468 7430.23960 27253.5922   267%     -  325s
     0     0 27149.4964    0  450 7430.23960 27149.4964   265%     -  331s
     0     0 27112.1637    0  449 7430.23960 27112.1637   265%     -  335s
     0     0 27108.6211    0  499 7430.23960 27108.6211   265%     -  336s
     0     0 27108.0152    0  500 7430.23960 27108.0152   265%     -  337s
     0     0 27060.5639    0  460 7430.23960 27060.5639   264%     -  345s
     0     0 27052.9311    0  404 7430.23960 27052.9311   264%     -  347s
     0     0 27051.4510    0  388 7430.23960 27051.4510   264%     -  347s
     0     0 27032.9879    0  502 7430.23960 27032.9879   264%     -  351s
     0     0 27018.6996    0  470 7430.23960 27018.6996   264%     -  354s
     0     0 27014.8854    0  507 7430.23960 27014.8854   264%     -  355s
     0     0 27013.8613    0  445 7430.23960 27013.8613   264%     -  356s
     0     0 26989.8464    0  468 7430.23960 26989.8464   263%     -  361s
     0     0 26983.3512    0  420 7430.23960 26983.3512   263%     -  363s
     0     0 26981.2314    0  459 7430.23960 26981.2314   263%     -  364s
     0     0 26958.4863    0  419 7430.23960 26958.4863   263%     -  368s
H    0     0                    7511.8804507 26958.4487   259%     -  369s
H    0     0                    7604.8903344 26958.4487   254%     -  369s
     0     0 26931.3479    0  478 7604.89033 26931.3479   254%     -  373s
     0     0 26926.4292    0  471 7604.89033 26926.4292   254%     -  374s
     0     0 26919.5295    0  424 7604.89033 26919.5295   254%     -  376s
     0     0 26917.5733    0  419 7604.89033 26917.5733   254%     -  376s
     0     0 26905.4024    0  467 7604.89033 26905.4024   254%     -  380s
     0     0 26903.1848    0  523 7604.89033 26903.1848   254%     -  383s
     0     0 26897.9310    0  526 7604.89033 26897.9310   254%     -  386s
     0     0 26895.2485    0  454 7604.89033 26895.2485   254%     -  387s
     0     0 26892.0063    0  528 7604.89033 26892.0063   254%     -  390s
     0     0 26891.9761    0  528 7604.89033 26891.9761   254%     -  392s
H    0     0                    7612.2089089 26891.9761   253%     -  419s
H    0     0                    7614.2209227 26891.9728   253%     -  471s
H    0     0                    7688.6846086 26891.9728   250%     -  475s
H    0     0                    7757.5567853 26891.9728   247%     -  479s
H    0     0                    7767.8895967 26891.9728   246%     -  479s
H    0     0                    7779.2828339 26891.9728   246%     -  479s
H    0     0                    7786.0256954 26891.9728   245%     -  479s
H    0     0                    7885.9215242 26891.9728   241%     -  480s
H    0     0                    7903.1183937 26891.9728   240%     -  480s
H    0     2                    8053.5281659 26891.9728   234%     -  483s
     0     2 26891.9728    0  528 8053.52817 26891.9728   234%     -  483s
     1     4 26831.2423    1  400 8053.52817 26891.9525   234%  3470  494s
     3     8 26465.9621    2  443 8053.52817 26830.7793   233%  7591  504s
     7    16 26376.2329    3  443 8053.52817 26465.5177   229%  8022  516s
    15    32 26249.7683    4  492 8053.52817 26376.0223   228%  9243  532s
    31    48 24911.7232    5  508 8053.52817 26249.6964   226% 14054  567s
    47    80 22631.2436    6  393 8053.52817 26249.6964   226% 13555  586s
H   53    80                    8073.9405167 26249.6964   225% 12676  586s
H   58    80                    8086.1535679 26249.6964   225% 12509  586s
H   59    80                    8091.7682744 26249.6964   224% 12471  586s
H   62    80                    8202.6908340 26249.6964   220% 12412  586s
    79   145 22531.6328    7  393 8202.69083 26249.6964   220% 10533  642s
   144   266 22248.8446    9  393 8202.69083 26249.6964   220%  7434  664s
   265   352 22008.1539   12  373 8202.69083 26249.6964   220%  5570  681s
   351   383 21899.2441   12  380 8202.69083 26249.6964   220%  5005  692s
H  367   383                    9617.4669993 26249.6964   173%  4937  692s
   384   440 21988.3524   13  372 9617.46700 26249.6964   173%  4905  708s
   450   468 20906.4499   12  219 9617.46700 26249.6964   173%  4700  722s
H  459   468                    9756.7586951 26249.6964   169%  4706  722s
H  465   468                    11246.711452 26249.6964   133%  4687  722s
H  476   468                    11690.396219 26249.6964   125%  4707  722s
   484   489 21936.5152   14  370 11690.3962 26249.6964   125%  4661  739s
   544   515 19713.9235   19  278 11690.3962 26249.6964   125%  4573  753s
H  570   515                    12019.777964 26249.6964   118%  4637  753s
   572   533 16318.5836   20  208 12019.7780 26249.6964   118%  4647  766s
H  578   533                    12024.182677 26249.6964   118%  4630  766s
H  600   533                    12074.275426 26249.6964   117%  4718  766s
   602   548 20042.6074   14  296 12074.2754 26249.6964   117%  4734  781s
H  618   548                    12078.070496 26249.6964   117%  4736  781s
   637   583 21786.9840   15  360 12078.0705 26249.6964   117%  4775  796s
   696   603 20720.3790   16  345 12078.0705 26249.6964   117%  4743  808s
   732   622 19368.3322   16  302 12078.0705 26249.6964   117%  4701  822s
   770   652 17679.3026   24  267 12078.0705 26249.6964   117%  4714  837s
   814   686 20357.0443   17  320 12078.0705 26249.6964   117%  4609  850s
H  863   686                    12088.412864 26249.6964   117%  4512  850s
   868   716 19220.4435   17  309 12088.4129 26249.6964   117%  4514  864s
H  872   716                    12105.083783 26249.6964   117%  4509  864s
H  874   716                    12114.261470 26249.6964   117%  4504  864s
   908   799 19409.3913   18  377 12114.2615 26249.6964   117%  4500  879s
  1007   884 18543.9064   18  303 12114.2615 26249.6964   117%  4322  894s
  1136   948 18729.3177   18  242 12114.2615 26249.6964   117%  4053  909s
  1234  1056 18601.1084   17  315 12114.2615 26249.6964   117%  3925  924s
  1366  1154 18798.2193   19  323 12114.2615 26249.6964   117%  3751  940s
  1515  1240 15820.8932   18  243 12114.2615 26249.6964   117%  3565  956s
  1685  1273 17077.4121   19  310 12114.2615 26249.6964   117%  3350  979s
  1808  1345 18562.5062   20  264 12114.2615 26249.6964   117%  3261 1001s
  1906  1366 18261.3182   20  379 12114.2615 26249.6964   117%  3224 1017s
H 1927  1366                    12125.167067 26249.6964   116%  3236 1017s
  1943  1459 15894.6248   21  304 12125.1671 26249.6964   116%  3240 1036s
  2062  1490 17830.8063   21  272 12125.1671 26249.6964   116%  3214 1052s
H 2066  1490                    12141.837986 26249.6964   116%  3212 1052s
  2109  1573 16920.2248   21  198 12141.8380 26249.6964   116%  3230 1074s
  2268  1637 17410.7715   22  315 12141.8380 26083.8111   115%  3173 1096s
  2388  1715 15411.7611   24  180 12141.8380 26017.5681   114%  3175 1121s
  2518  1833 14765.3090   26  155 12141.8380 25852.2539   113%  3195 1147s
  2691  1879 14028.7146   32  137 12141.8380 25852.2539   113%  3147 1180s
  2849  1924 13225.0783   32  121 12141.8380 25852.2539   113%  3129 1204s
  2989  1984 infeasible   36      12141.8380 25032.5974   106%  3125 1245s
  3102  2074 22093.4099   10  250 12141.8380 24939.8785   105%  3155 1271s
  3238  2180 20361.1933   11  403 12141.8380 24799.3899   104%  3164 1300s
  3398  2257 18903.6860   13  316 12141.8380 24749.6249   104%  3176 1325s
  3503  2284 18652.6588   14  424 12141.8380 24349.8314   101%  3184 1344s
H 3525  2284                    12146.141121 24338.6934   100%  3203 1344s
  3539  2424 18609.5012   15  389 12146.1411 24338.6934   100%  3210 1396s
  3761  2544 17059.8667   21  275 12146.1411 24338.6934   100%  3188 1427s
  3946  2545 13365.4070   18  528 12146.1411 24338.6934   100%  3193 1712s
  3948  2546 13759.3601   25  276 12146.1411 24338.6934   100%  3192 1725s
  3949  2547 14007.1540   18  376 12146.1411 24338.6934   100%  3191 1775s
  3950  2548 15981.7879   20  372 12146.1411 24338.6934   100%  3190 1800s
  3951  2548 14851.5635   52  371 12146.1411 24338.6934   100%  3189 1821s
  3952  2549 14493.2678   14  425 12146.1411 24338.6934   100%  3188 1840s
  3953  2550 17075.1630   29  390 12146.1411 24338.6934   100%  3188 1859s
  3954  2550 23367.7462   10  405 12146.1411 24338.6934   100%  3187 1868s
  3955  2551 13718.2918   53  471 12146.1411 24338.6934   100%  3186 1879s
  3956  2552 13858.0330   55  441 12146.1411 24338.6934   100%  3185 1888s
  3957  2552 13916.3614   23  453 12146.1411 24338.6934   100%  3184 1897s
  3958  2553 13696.9282   17  406 12146.1411 24338.6934   100%  3184 1901s
  3959  2554 15471.7529   29  487 12146.1411 24338.6934   100%  3183 1908s
  3960  2554 22643.0641   10  397 12146.1411 24338.6934   100%  3182 1916s
  3961  2555 23333.3309    8  500 12146.1411 24338.6934   100%  3181 1923s
  3962  2556 14560.8087   31  532 12146.1411 24338.6934   100%  3180 1928s
  3963  2556 16540.6213   22  520 12146.1411 24338.6934   100%  3180 1933s
  3964  2557 22358.2490    8  410 12146.1411 24338.6934   100%  3179 1939s
  3965  2558 19445.7665   16  414 12146.1411 24338.6934   100%  3178 1943s
  3966  2558 14836.8295   22  422 12146.1411 24338.6934   100%  3177 1946s
  3967  2559 13779.7816   67  434 12146.1411 24338.6934   100%  3176 1952s
  3968  2560 17333.4322   23  424 12146.1411 24338.6934   100%  3175 1955s
  3970  2561 15624.6281   31  473 12146.1411 24338.6934   100%  3174 1965s
  3971  2562 13206.8415   41  420 12146.1411 24338.6934   100%  3173 1970s
  3972  2562 21854.6984   12  482 12146.1411 24338.6934   100%  3172 1976s
  3973  2563 18247.1378   12  489 12146.1411 24338.6934   100%  3171 1980s
  3974  2564 12473.7706   77  441 12146.1411 24338.6934   100%  3171 1988s
  3975  2564 14714.7002   26  541 12146.1411 24338.6934   100%  3170 1992s
  3976  2565 13723.3329   18  436 12146.1411 24338.6934   100%  3169 1999s
  3977  2566 17613.7007   14  433 12146.1411 24338.6934   100%  3168 2002s
  3978  2566 12977.0920   32  439 12146.1411 24338.6934   100%  3168 2009s
  3979  2567 13412.5956   29  478 12146.1411 24338.6934   100%  3167 2013s
  3980  2568 15537.7140   49  433 12146.1411 24338.6934   100%  3166 2017s
  3981  2568 13308.0165   74  433 12146.1411 24338.6934   100%  3165 2031s
  3982  2569 16860.8728   39  433 12146.1411 24338.6934   100%  3164 2095s
  3983  2572 24338.6934   13  307 12146.1411 24338.6934   100%  3233 2114s
  3984  2573 24338.6934   14  396 12146.1411 24338.6934   100%  3234 2125s
  3986  2578 24338.6934   14  339 12146.1411 24338.6934   100%  3236 2151s
  3991  2586 24338.6934   15  382 12146.1411 24338.6934   100%  3240 2182s
  4001  2603 24338.6934   16  386 12146.1411 24338.6934   100%  3261 2230s
  4021  2608 24338.6934   17  383 12146.1411 24338.6934   100%  3332 2631s
  4033  2628 23383.0839   18  384 12146.1411 24338.6934   100%  3415 2676s
  4057  2690 22661.7099   19  405 12146.1411 24338.6934   100%  3455 2718s
  4127  2760 20440.9816   20  325 12146.1411 24338.6934   100%  3552 2746s
  4220  2803 20401.8393   21  323 12146.1411 24338.6934   100%  3573 2771s
  4296  2827 16003.7787   22  315 12146.1411 24338.6934   100%  3598 2790s
  4347  2863 15961.6651   23  312 12146.1411 24338.6934   100%  3606 2810s
  4410  2876 13687.1876   26  170 12146.1411 24338.6934   100%  3631 2831s
  4474  2881 13473.9021   26  296 12146.1411 24338.6934   100%  3651 2857s
  4533  2878     cutoff   28      12146.1411 24338.6934   100%  3674 2875s
  4585  2880 17711.3331   25  297 12146.1411 24338.6934   100%  3688 2900s
  4652  2883 17470.7887   26  283 12146.1411 24338.6934   100%  3698 2925s
  4716  2890 17120.6524   28  263 12146.1411 24338.6934   100%  3707 2945s
  4780  2889 14270.0978   30  100 12146.1411 24338.6934   100%  3719 2968s
  4823  2895 13074.6223   31  194 12146.1411 24338.6934   100%  3734 2988s
  4876  2898 12606.7391   32  192 12146.1411 24338.6934   100%  3742 3008s
  4933  2905     cutoff   34      12146.1411 24338.6934   100%  3747 3032s
  5006  2901 20671.4063   23  278 12146.1411 24338.6934   100%  3755 3053s
  5059  2928 20052.4529   24  332 12146.1411 24338.6934   100%  3761 3077s
  5131  2930 19929.7706   25  321 12146.1411 24338.6934   100%  3766 3108s
  5192  2928 17732.4030   26  321 12146.1411 24338.6934   100%  3772 3135s
  5248  2964 16599.5656   27  290 12146.1411 24338.6934   100%  3787 3159s
  5330  2980 15081.9585   29  272 12146.1411 24338.6934   100%  3802 3186s
  5409  3000 14326.4539   32  178 12146.1411 24338.6934   100%  3818 3214s
  5503  2985     cutoff   34      12146.1411 24338.6934   100%  3833 3250s
  5592  3005 13406.0959   32  218 12146.1411 24338.6934   100%  3856 3288s
  5693  3013 infeasible   33      12146.1411 24338.6934   100%  3883 3321s
  5785  3022 21763.5202   21  319 12146.1411 24338.6934   100%  3912 3356s
  5880  3066 19154.7103   22  403 12146.1411 24338.6934   100%  3930 3387s
  5989  3047 18052.4467   23  378 12146.1411 24338.6934   100%  3951 3415s
  6061  3061 16380.8208   24  414 12146.1411 24338.6934   100%  3974 3446s
  6168  3073 16137.4451   25  402 12146.1411 24338.6934   100%  3978 3491s
  6297  3093 14955.4447   27  396 12146.1411 22612.3141  86.2%  3995 3531s
  6442  3109 12815.1463   34  270 12146.1411 22570.5464  85.8%  4014 3575s
  6581  3113 20818.9265   19  346 12146.1411 22570.5464  85.8%  4039 3600s

Cutting planes:
  Gomory: 10
  Implied bound: 8
  Projected implied bound: 75
  MIR: 1411
  Mixing: 1
  Flow cover: 2338
  RLT: 24
  Relax-and-lift: 262

Explored 6657 nodes (27322534 simplex iterations) in 3600.05 seconds (8998.86 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12146.1 12141.8 12125.2 ... 12019.8

Time limit reached
Best objective 1.214614112145e+04, best bound 2.257054638690e+04, gap 85.8248%
  WARNING: Time limit reached. Using best solution found (gap: 85.82%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 12146.14, θ = 160678.71
  Upper Bound (UB) = 12146.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160678.71
  [DEBUG]   ✓ Scenario 0: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160678.71 ≤ Q = 160678.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160678.71 ≤ Q = 160678.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160678.71 ≤ Q = 160678.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160678.71 ≤ Q = 160678.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160678.71 ≤ Q = 160678.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x48ac8eb7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x48ac8eb7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.305528e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6759496.7935
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.538293e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153829.31    0  124 6759496.79 -153829.31   102%     -    0s
H    0     0                    -118082.6931 -153829.31  30.3%     -    0s
H    0     0                    -118456.5614 -153829.31  29.9%     -    0s
H    0     0                    -127319.3784 -130153.01  2.23%     -    0s
     0     0 -130153.01    0   54 -127319.38 -130153.01  2.23%     -    0s
H    0     0                    -127626.0466 -130065.11  1.91%     -    0s
H    0     0                    -128653.2004 -130065.11  1.10%     -    0s
H    0     0                    -128959.8686 -130065.11  0.86%     -    0s
     0     0 -129349.45    0   24 -128959.87 -129349.45  0.30%     -    0s
H    0     0                    -129007.8818 -129322.94  0.24%     -    0s
     0     0 -129289.99    0   17 -129007.88 -129289.99  0.22%     -    0s
     0     0 -129288.11    0   16 -129007.88 -129288.11  0.22%     -    0s
     0     0 -129212.95    0   17 -129007.88 -129212.95  0.16%     -    0s
     0     0 -129212.95    0   18 -129007.88 -129212.95  0.16%     -    0s
     0     0 -129078.85    0    8 -129007.88 -129078.85  0.06%     -    0s
H    0     0                    -129072.2993 -129072.52  0.00%     -    0s
     0     0     cutoff    0      -129072.30 -129072.30  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 3
  MIR: 7
  Flow cover: 4
  Relax-and-lift: 2

Explored 1 nodes (704 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -129072 -129008 -128960 ... 1.30553e+13
No other solutions better than -129072

Optimal solution found (tolerance 1.00e-06)
Best objective -1.290722992835e+05, best bound -1.290722992835e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 152872.37
  Scenario: 16 demand increases, 44 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129072.30
  [DEBUG]   S×d_nominal = 281944.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 281944.67 + -129072.30 = 152872.37
  [DEBUG]   Current θ from Master = 160678.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7806.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4339.79
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2804.3536, Absolute Gap = 2804.3536, Relative Gap = 0.230884
  Not converged yet (gap = 2804.35 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 16 increases, 44 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 438039 nonzeros
Model fingerprint: 0x6f8f49a3
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 1.26s
Presolved: 90653 rows, 38830 columns, 550679 nonzeros
Variable types: 36571 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -352354.4127
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.925e+06
 Factor NZ  : 8.518e+06 (roughly 120 MB of memory)
 Factor Ops : 1.466e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.49440209e+07  1.76601023e+08  9.63e+04 1.95e+01  7.57e+04     2s
   1  -1.11764925e+07  1.53751879e+08  6.61e+04 6.74e+01  5.13e+04     2s
   2  -3.65721035e+06  1.17063347e+08  2.14e+04 6.55e-11  1.76e+04     2s
   3  -7.34359353e+05  8.07011923e+07  1.68e+03 1.19e+00  1.76e+03     2s
   4  -4.65203579e+05  3.41645822e+07  3.94e+02 3.64e-01  4.76e+02     3s
   5  -3.60977258e+05  2.33229564e+07  1.51e+02 2.27e-01  2.37e+02     3s
   6  -2.51846852e+05  1.58787202e+07  4.13e+01 1.41e-01  1.19e+02     3s
   7  -1.49621289e+05  1.20012580e+07  9.18e+00 1.02e-01  7.72e+01     3s
   8  -1.00348765e+05  7.60388747e+06  4.36e+00 6.38e-02  4.77e+01     3s
   9  -7.27198055e+04  5.04094060e+06  2.41e+00 4.15e-02  3.13e+01     3s
  10  -4.62571931e+04  1.97260284e+06  1.19e+00 1.56e-02  1.22e+01     3s
  11  -8.96537253e+03  5.77602965e+05  3.68e-01 3.88e-03  3.54e+00     3s
  12   1.33798177e+03  3.10566484e+05  2.34e-01 1.98e-03  1.86e+00     3s
  13   6.50056374e+03  2.21045401e+05  1.86e-01 1.20e-03  1.29e+00     3s
  14   1.33722883e+04  1.66566436e+05  1.37e-01 8.91e-04  9.22e-01     3s
  15   1.77060784e+04  1.33031769e+05  1.13e-01 8.49e-04  6.94e-01     3s
  16   2.43513944e+04  1.08305160e+05  8.21e-02 1.35e-03  5.05e-01     3s
  17   2.85701013e+04  8.43670030e+04  6.57e-02 1.13e-03  3.36e-01     3s
  18   3.24127047e+04  8.01340208e+04  5.24e-02 9.51e-04  2.87e-01     3s
  19   3.37792456e+04  7.11214517e+04  4.77e-02 1.13e-03  2.25e-01     3s
  20   3.68449840e+04  6.63825157e+04  3.73e-02 1.33e-03  1.78e-01     3s
  21   3.86344340e+04  6.40865194e+04  3.16e-02 1.31e-03  1.53e-01     3s
  22   3.94702510e+04  6.03121944e+04  2.89e-02 9.97e-04  1.25e-01     3s
  23   4.00746954e+04  5.96342131e+04  2.71e-02 9.36e-04  1.18e-01     3s
  24   4.23450658e+04  5.78197263e+04  2.04e-02 7.62e-04  9.31e-02     3s
  25   4.38978006e+04  5.63511712e+04  1.60e-02 6.17e-04  7.49e-02     3s
  26   4.48325207e+04  5.50093212e+04  1.33e-02 4.74e-04  6.12e-02     3s
  27   4.54862244e+04  5.46192969e+04  1.15e-02 4.41e-04  5.49e-02     3s
  28   4.63519005e+04  5.36499392e+04  9.15e-03 3.47e-04  4.39e-02     3s
  29   4.75620229e+04  5.26341912e+04  6.00e-03 2.47e-04  3.05e-02     3s
  30   4.82991917e+04  5.22320815e+04  4.16e-03 2.08e-04  2.37e-02     3s
  31   4.86645340e+04  5.19099704e+04  3.29e-03 1.83e-04  1.95e-02     4s
  32   4.89068484e+04  5.13732881e+04  2.69e-03 1.31e-04  1.48e-02     4s
  33   4.90990943e+04  5.09467646e+04  2.23e-03 8.62e-05  1.11e-02     4s
  34   4.92129264e+04  5.07760848e+04  1.96e-03 6.85e-05  9.40e-03     4s
  35   4.95188856e+04  5.06145384e+04  1.29e-03 6.05e-05  6.59e-03     4s
  36   4.95661468e+04  5.04824047e+04  1.17e-03 4.35e-05  5.51e-03     4s
  37   4.96962912e+04  5.04316145e+04  8.95e-04 3.71e-05  4.42e-03     4s
  38   4.97395103e+04  5.03851828e+04  7.94e-04 3.17e-05  3.88e-03     4s
  39   4.97984891e+04  5.03466022e+04  6.59e-04 2.72e-05  3.30e-03     4s
  40   4.98633068e+04  5.03162847e+04  5.10e-04 2.39e-05  2.72e-03     4s
  41   4.99188251e+04  5.02907335e+04  3.89e-04 2.09e-05  2.24e-03     4s
  42   4.99602809e+04  5.01900355e+04  3.04e-04 9.10e-06  1.38e-03     4s
  43   4.99690031e+04  5.01804962e+04  2.86e-04 8.02e-06  1.27e-03     4s
  44   5.00131737e+04  5.01627684e+04  1.90e-04 6.14e-06  9.00e-04     4s
  45   5.00586177e+04  5.01370614e+04  9.87e-05 6.78e-06  4.72e-04     4s
  46   5.00949426e+04  5.01239864e+04  2.85e-05 6.07e-06  1.75e-04     4s
  47   5.01038987e+04  5.01197429e+04  1.19e-05 4.13e-06  9.53e-05     4s
  48   5.01101124e+04  5.01131524e+04  1.16e-06 9.44e-07  1.83e-05     4s
  49   5.01109200e+04  5.01113167e+04  8.30e-08 1.32e-07  2.38e-06     4s
  50   5.01110019e+04  5.01110094e+04  4.75e-09 6.54e-10  4.51e-08     4s
  51   5.01110076e+04  5.01110076e+04  2.01e-10 3.89e-12  1.81e-12     4s

Barrier solved model in 51 iterations and 4.41 seconds (8.32 work units)
Optimal objective 5.01110076e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1029 PPushes remaining with PInf 2.1769473e-07                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 9.6563011e-11      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30066    5.0111008e+04   0.000000e+00   0.000000e+00      6s
   30066    5.0111008e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.011101e+04, 30066 iterations, 4.40 seconds (9.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50111.0076    0  320 -219144.29 50111.0076   123%     -    6s
H    0     0                    -214512.9736 50111.0076   123%     -    6s
H    0     0                    -146260.9968 50111.0076   134%     -    7s
H    0     0                    -144836.9777 50111.0076   135%     -    7s
H    0     0                    -144485.7912 50111.0076   135%     -    7s
H    0     0                    -139007.7988 50111.0076   136%     -    7s
H    0     0                    -63723.34801 50111.0076   179%     -    7s
H    0     0                    -51408.12555 50111.0076   197%     -    7s
H    0     0                    -13800.01808 50111.0076   463%     -    7s
H    0     0                    -13792.87476 50111.0076   463%     -    7s
H    0     0                    -13751.72682 50111.0076   464%     -    7s
H    0     0                    -13720.87528 50111.0076   465%     -    7s
H    0     0                    -12161.40416 41274.9536   439%     -   43s
H    0     0                    -10921.16721 41274.9536   478%     -   43s
H    0     0                    -10913.79585 41274.9536   478%     -   43s
H    0     0                    -10907.76751 41274.9536   478%     -   43s
H    0     0                    -9190.351586 41274.9536   549%     -   43s
H    0     0                    -8191.954334 41274.9536   604%     -   43s
H    0     0                    -7977.840959 41274.9536   617%     -   43s
     0     0 41274.9536    0  509 -7977.8410 41274.9536   617%     -   43s
     0     0 40984.9691    0  511 -7977.8410 40984.9691   614%     -   55s
     0     0 40903.3454    0  503 -7977.8410 40903.3454   613%     -   62s
     0     0 40780.3348    0  509 -7977.8410 40780.3348   611%     -   65s
     0     0 40776.5188    0  508 -7977.8410 40776.5188   611%     -   69s
     0     0 40685.1813    0  496 -7977.8410 40685.1813   610%     -   72s
     0     0 40634.3751    0  520 -7977.8410 40634.3751   609%     -   76s
     0     0 40551.8516    0  520 -7977.8410 40551.8516   608%     -   78s
     0     0 40551.8516    0  520 -7977.8410 40551.8516   608%     -   79s
     0     0 36254.3267    0  247 -7977.8410 36254.3267   554%     -  116s
H    0     0                    2858.4708550 36251.7137  1168%     -  116s
H    0     0                    3084.1110191 36251.7137  1075%     -  117s
H    0     0                    3163.2156553 36251.7137  1046%     -  117s
H    0     0                    3181.9137065 36251.7137  1039%     -  117s
     0     0 35562.2634    0  543 3181.91371 35562.2634  1018%     -  156s
     0     0 35438.6248    0  630 3181.91371 35438.6248  1014%     -  177s
     0     0 35335.4963    0  618 3181.91371 35335.4963  1011%     -  189s
     0     0 35118.5596    0  556 3181.91371 35118.5596  1004%     -  202s
H    0     0                    4140.3194912 35069.4445   747%     -  214s
H    0     0                    4988.7483876 35069.4445   603%     -  214s
H    0     0                    6096.3929939 35069.4445   475%     -  214s
H    0     0                    6111.8826546 35069.4445   474%     -  214s
H    0     0                    6263.0512829 35069.4445   460%     -  214s
H    0     0                    6287.7469259 35069.4445   458%     -  214s
     0     0 35069.4445    0  550 6287.74693 35069.4445   458%     -  214s
H    0     0                    6461.5123392 35026.8984   442%     -  223s
H    0     0                    6562.1871003 35026.8984   434%     -  223s
H    0     0                    6998.7547017 35026.8984   400%     -  223s
H    0     0                    7051.4743484 35026.8984   397%     -  223s
     0     0 35026.8984    0  564 7051.47435 35026.8984   397%     -  223s
     0     0 35006.2478    0  563 7051.47435 35006.2478   396%     -  228s
     0     0 34941.5947    0  450 7051.47435 34941.5947   396%     -  236s
     0     0 34931.1669    0  458 7051.47435 34931.1669   395%     -  238s
     0     0 34924.1857    0  456 7051.47435 34924.1857   395%     -  241s
     0     0 34923.7573    0  453 7051.47435 34923.7573   395%     -  242s
     0     0 32634.9173    0  381 7051.47435 32634.9173   363%     -  292s
H    0     0                    7124.8363256 32634.7518   358%     -  292s
     0     0 32084.0226    0  417 7124.83633 32084.0226   350%     -  324s
     0     0 31865.6970    0  378 7124.83633 31865.6970   347%     -  344s
     0     0 31781.4495    0  393 7124.83633 31781.4495   346%     -  356s
     0     0 31723.9475    0  375 7124.83633 31723.9475   345%     -  364s
     0     0 31657.8918    0  398 7124.83633 31657.8918   344%     -  375s
     0     0 31609.6354    0  383 7124.83633 31609.6354   344%     -  390s
     0     0 31595.0688    0  391 7124.83633 31595.0688   343%     -  398s
     0     0 31592.3039    0  338 7124.83633 31592.3039   343%     -  400s
H    0     0                    7270.6969024 31592.3039   335%     -  424s
     0     0 30236.4393    0  414 7270.69690 30236.4393   316%     -  471s
     0     0 29821.2120    0  379 7270.69690 29821.2120   310%     -  493s
     0     0 29649.3652    0  383 7270.69690 29649.3652   308%     -  515s
     0     0 29560.1228    0  384 7270.69690 29560.1228   307%     -  524s
     0     0 29528.0228    0  391 7270.69690 29528.0228   306%     -  533s
     0     0 29504.2116    0  389 7270.69690 29504.2116   306%     -  542s
H    0     0                    7346.7823304 29497.2686   301%     -  545s
H    0     0                    7496.0408166 29497.2686   294%     -  545s
     0     0 29497.2686    0  394 7496.04082 29497.2686   294%     -  545s
     0     0 29440.3671    0  400 7496.04082 29440.3671   293%     -  556s
H    0     0                    7497.0544338 29389.3887   292%     -  568s
     0     0 29389.3887    0  400 7497.05443 29389.3887   292%     -  568s
H    0     0                    8045.5279426 29360.8925   265%     -  577s
     0     0 29360.8925    0  446 8045.52794 29360.8925   265%     -  577s
     0     0 29347.7835    0  406 8045.52794 29347.7835   265%     -  581s
     0     0 29330.7620    0  441 8045.52794 29330.7620   265%     -  587s
H    0     0                    9290.7524044 29317.0471   216%     -  591s
     0     0 29317.0471    0  409 9290.75240 29317.0471   216%     -  591s
     0     0 29308.5445    0  413 9290.75240 29308.5445   215%     -  595s
     0     0 29306.5808    0  449 9290.75240 29306.5808   215%     -  597s
     0     0 28814.2683    0  442 9290.75240 28814.2683   210%     -  623s
H    0     0                    9705.5052895 28814.2241   197%     -  624s
H    0     0                    10443.103143 28814.2241   176%     -  624s
H    0     0                    10551.639818 28814.2241   173%     -  624s
H    0     0                    10647.438091 28814.2241   171%     -  624s
H    0     0                    10657.118833 28814.2241   170%     -  624s
H    0     0                    10669.923659 28814.2241   170%     -  624s
     0     0 28695.5204    0  492 10669.9237 28695.5204   169%     -  638s
     0     0 28656.8036    0  438 10669.9237 28656.8036   169%     -  647s
H    0     0                    10690.782063 28626.0432   168%     -  656s
H    0     0                    10708.060590 28626.0432   167%     -  656s
     0     0 28626.0432    0  430 10708.0606 28626.0432   167%     -  656s
     0     0 28597.0590    0  387 10708.0606 28597.0590   167%     -  660s
     0     0 28576.7975    0  425 10708.0606 28576.7975   167%     -  664s
     0     0 28553.2325    0  435 10708.0606 28553.2325   167%     -  672s
     0     0 28542.7237    0  423 10708.0606 28542.7237   167%     -  676s
     0     0 28471.6310    0  370 10708.0606 28471.6310   166%     -  684s
     0     0 28463.2677    0  379 10708.0606 28463.2677   166%     -  688s
     0     0 28459.1546    0  376 10708.0606 28459.1546   166%     -  689s
     0     0 28455.6192    0  378 10708.0606 28455.6192   166%     -  691s
     0     0 28294.5828    0  492 10708.0606 28294.5828   164%     -  704s
H    0     0                    11012.372176 28294.0393   157%     -  706s
     0     0 28206.8836    0  458 11012.3722 28206.8836   156%     -  713s
     0     0 28180.6466    0  489 11012.3722 28180.6466   156%     -  720s
     0     0 28177.0783    0  486 11012.3722 28177.0783   156%     -  724s
     0     0 28085.7290    0  441 11012.3722 28085.7290   155%     -  738s
     0     0 28060.3542    0  448 11012.3722 28060.3542   155%     -  744s
     0     0 28046.2266    0  444 11012.3722 28046.2266   155%     -  751s
     0     0 28039.5497    0  459 11012.3722 28039.5497   155%     -  754s
     0     0 28032.2678    0  505 11012.3722 28032.2678   155%     -  757s
     0     0 28026.0040    0  457 11012.3722 28026.0040   154%     -  762s
     0     0 28020.5183    0  490 11012.3722 28020.5183   154%     -  765s
     0     0 28018.7914    0  543 11012.3722 28018.7914   154%     -  767s
     0     0 27944.2817    0  483 11012.3722 27944.2817   154%     -  779s
     0     0 27912.7556    0  445 11012.3722 27912.7556   153%     -  787s
     0     0 27900.9481    0  493 11012.3722 27900.9481   153%     -  793s
     0     0 27892.8520    0  397 11012.3722 27892.8520   153%     -  797s
     0     0 27889.8215    0  395 11012.3722 27889.8215   153%     -  800s
     0     0 27842.8653    0  387 11012.3722 27842.8653   153%     -  809s
     0     0 27827.2696    0  388 11012.3722 27827.2696   153%     -  815s
     0     0 27822.5538    0  439 11012.3722 27822.5538   153%     -  818s
     0     0 27821.9251    0  437 11012.3722 27821.9251   153%     -  819s
     0     0 27798.2132    0  496 11012.3722 27798.2132   152%     -  828s
     0     0 27774.0719    0  548 11012.3722 27774.0719   152%     -  837s
     0     0 27770.6100    0  505 11012.3722 27770.6100   152%     -  840s
     0     0 27740.8245    0  393 11012.3722 27740.8245   152%     -  847s
     0     0 27734.7428    0  429 11012.3722 27734.7428   152%     -  851s
     0     0 27732.9463    0  426 11012.3722 27732.9463   152%     -  853s
     0     0 27724.0477    0  403 11012.3722 27724.0477   152%     -  859s
H    0     0                    11075.981836 27723.6984   150%     -  861s
     0     0 27718.8861    0  455 11075.9818 27718.8861   150%     -  864s
     0     0 27717.3334    0  437 11075.9818 27717.3334   150%     -  866s
     0     0 27710.1492    0  461 11075.9818 27710.1492   150%     -  870s
     0     0 27709.2978    0  461 11075.9818 27709.2978   150%     -  872s
H    0     0                    11097.006241 27708.9952   150%     -  922s
H    0     0                    11227.287026 27708.9952   147%     -  940s
     0     2 27708.9952    0  461 11227.2870 27708.9952   147%     -  949s
     1     3 27230.9011    1  367 11227.2870 27708.9952   147% 11417  960s
     2     4 27527.3342    1  421 11227.2870 27527.3342   145% 11005  970s
     3     5 26904.6313    2  399 11227.2870 27527.2536   145% 10452  983s
     4    10 26356.6057    3  391 11227.2870 27527.2536   145% 10845  998s
     9    19 26927.4062    3  428 11227.2870 27297.9768   143%  9189 1037s
    18    38 26509.5894    4  473 11227.2870 27103.4500   141% 12462 1070s
    37    51 26611.9593    5  421 11227.2870 27039.4293   141% 16838 1124s
    50    77 25937.7319    6  412 11227.2870 27039.4293   141% 16152 1163s
H   60    77                    11622.937912 27039.4293   133% 15806 1163s
    76   180 25742.3728    7  401 11622.9379 27039.4293   133% 14021 1217s
H  179   220                    11663.493033 27039.4293   132%  8879 1239s
H  180   220                    11669.528516 27039.4293   132%  8900 1239s
H  182   220                    11898.967868 27039.4293   127%  9037 1239s
   221   275 25024.8547   11  369 11898.9679 27039.4293   127%  8863 1264s
   276   342 24982.4009   12  438 11898.9679 27039.4293   127%  8465 1286s
   343   406 24793.8677   10  335 11898.9679 27039.4293   127%  8032 1310s
   407   432 24468.3111   11  363 11898.9679 27039.4293   127%  7613 1330s
   441   457 24053.2155   12  359 11898.9679 27039.4293   127%  7551 1353s
   470   475 17329.8043   12  221 11898.9679 27039.4293   127%  7515 1410s
   488   490 21054.5112   23  368 11898.9679 27039.4293   127%  7670 1432s
   509   513 23927.8083   12  325 11898.9679 27039.4293   127%  7773 1453s
   538   529 23171.0335   13  349 11898.9679 27039.4293   127%  7914 1475s
H  558   529                    12080.187388 27039.4293   124%  7948 1475s
   568   570 23137.8001   14  337 12080.1874 27039.4293   124%  7938 1500s
   641   583 21934.6167   16  330 12080.1874 27039.4293   124%  7869 1524s
   676   597 21916.5955   17  324 12080.1874 27039.4293   124%  7760 1560s
   716   625 21361.9124   18  369 12080.1874 27039.4293   124%  7755 1584s
   760   641 21212.5174   19  374 12080.1874 27039.4293   124%  7683 1605s
   794   654 20673.4190   20  235 12080.1874 27039.4293   124%  7707 1623s
   831   676 20392.5135   21  230 12080.1874 27039.4293   124%  7643 1646s
   879   701 18165.3190   22  190 12080.1874 27039.4293   124%  7531 1668s
   924   737 18155.1550   23  193 12080.1874 27039.4293   124%  7542 1692s
   980   791 18005.6134   24  225 12080.1874 27039.4293   124%  7505 1715s
  1055   841 18004.3307   25  220 12080.1874 27039.4293   124%  7355 1741s
  1143   885 17880.7105   26  212 12080.1874 27039.4293   124%  7140 1769s
  1225   917 13874.2435   27  168 12080.1874 27039.4293   124%  6972 1796s
  1308   942     cutoff   28      12080.1874 27039.4293   124%  6861 1825s
  1388   958 14803.4405   27  184 12080.1874 27039.4293   124%  6844 1853s
  1452  1002 14489.9954   28  191 12080.1874 27039.4293   124%  6832 1882s
  1526  1062 13164.7063   29  167 12080.1874 27039.4293   124%  6961 1914s
  1618  1152 12942.2948   30  163 12080.1874 27039.4293   124%  7033 1946s
  1734  1222 12799.9300   31  160 12080.1874 27039.4293   124%  6967 1979s
  1864  1247 12743.1068   32  115 12080.1874 27039.4293   124%  6880 2013s
  1965  1283 12689.2204   33  116 12080.1874 27039.4293   124%  6912 2049s
  2065  1331 12620.7287   34  120 12080.1874 27039.4293   124%  7006 2088s
  2189  1377 24670.3199   11  387 12080.1874 27039.4293   124%  7037 2130s
  2307  1451 24536.0584   12  412 12080.1874 27039.4293   124%  7079 2171s
  2429  1474 24354.5794   13  378 12080.1874 27039.4293   124%  7113 2210s
  2464  1507 23154.2786   14  443 12080.1874 27039.4293   124%  7196 2250s
  2537  1555 20875.6186   15  375 12080.1874 27039.4293   124%  7235 2291s
  2623  1623 20515.2189   16  367 12080.1874 27039.4293   124%  7268 2336s
  2765  1671 19682.7308   17  368 12080.1874 27039.4293   124%  7222 2380s
  2881  1750 18983.6973   18  354 12080.1874 27039.4293   124%  7298 2429s
  3000  1842 18125.6491   20  343 12080.1874 27039.4293   124%  7431 2477s
  3136  1962 16646.2386   26  262 12080.1874 27039.4293   124%  7547 2527s
  3296  2088 14755.7443   33  260 12080.1874 26845.0236   122%  7604 2583s
  3488  2234 13637.5978   48  197 12080.1874 26143.1970   116%  7669 2636s
  3743  2357 23691.0634   10  376 12080.1874 26143.1970   116%  7635 2693s
  3932  2358 13566.0289   47  461 12080.1874 26143.1970   116%  7717 3071s
  3934  2359 17360.4494   16  205 12080.1874 26143.1970   116%  7713 3079s
  3935  2360 15418.0652   22  385 12080.1874 26143.1970   116%  7711 3128s
  3936  2361 14584.5901   22  390 12080.1874 26143.1970   116%  7709 3178s
  3937  2361 13627.6644   47  437 12080.1874 26143.1970   116%  7708 3240s
  3938  2362 24991.3638    8  436 12080.1874 26143.1970   116%  7706 3279s
  3939  2363 16691.7735   26  411 12080.1874 26143.1970   116%  7704 3294s
  3940  2363 15560.8351   50  478 12080.1874 26143.1970   116%  7702 3310s
  3941  2364 19986.8972   16  428 12080.1874 26143.1970   116%  7700 3329s
  3942  2365 12856.0377   52  487 12080.1874 26143.1970   116%  7698 3344s
  3943  2365 21496.4582    9  473 12080.1874 26143.1970   116%  7696 3357s
  3944  2366 18735.8316   17  438 12080.1874 26143.1970   116%  7694 3365s
  3945  2367 23738.5873   14  488 12080.1874 26143.1970   116%  7692 3371s
  3946  2367 21049.6207   14  442 12080.1874 26143.1970   116%  7690 3377s
  3947  2368 24459.7221    8  513 12080.1874 26143.1970   116%  7688 3382s
  3948  2369 21433.8808   14  505 12080.1874 26143.1970   116%  7686 3387s
  3949  2369 19084.4439   34  466 12080.1874 26143.1970   116%  7684 3391s
  3950  2370 13120.2757   38  486 12080.1874 26143.1970   116%  7682 3407s
  3951  2371 16176.7428   34  393 12080.1874 26143.1970   116%  7680 3415s
  3952  2371 23113.1379   17  333 12080.1874 26143.1970   116%  7678 3421s
  3953  2372 23737.0958   13  335 12080.1874 26143.1970   116%  7676 3426s
  3954  2373 13249.6977   23  390 12080.1874 26143.1970   116%  7674 3431s
  3956  2374 24901.9020    9  392 12080.1874 26143.1970   116%  7671 3446s
  3957  2375 16404.4027   28  400 12080.1874 26143.1970   116%  7669 3454s
  3958  2375 25221.9512    8  362 12080.1874 26143.1970   116%  7667 3460s
  3960  2377 16344.1859   42  458 12080.1874 26143.1970   116%  7663 3474s
  3961  2377 13901.5776   41  474 12080.1874 26143.1970   116%  7661 3478s
  3962  2378 13781.9170   32  522 12080.1874 26143.1970   116%  7659 3484s
  3963  2379 17448.6108   43  433 12080.1874 26143.1970   116%  7657 3488s
  3964  2379 18711.8227   15  444 12080.1874 26143.1970   116%  7655 3493s
  3965  2380 24337.9366   14  442 12080.1874 26143.1970   116%  7653 3497s
  3966  2381 19323.4374   11  438 12080.1874 26143.1970   116%  7651 3500s
  3967  2381 13418.8770   36  403 12080.1874 26143.1970   116%  7649 3509s
  3968  2382 13185.8026   31  470 12080.1874 26143.1970   116%  7647 3513s
  3969  2383 23799.6613   10  362 12080.1874 26143.1970   116%  7645 3517s
  3970  2383 14861.2250   26  411 12080.1874 26143.1970   116%  7643 3521s
  3971  2384 15351.8618   31  528 12080.1874 26143.1970   116%  7642 3534s
  3972  2385 13327.7698   20  534 12080.1874 26143.1970   116%  7640 3538s
  3973  2385 24985.8496   12  498 12080.1874 26143.1970   116%  7638 3541s
  3974  2386 13672.8888   31  471 12080.1874 26143.1970   116%  7636 3549s
  3975  2387 23140.0067   11  492 12080.1874 26143.1970   116%  7634 3553s
  3976  2387 14054.6505   44  548 12080.1874 26143.1970   116%  7632 3562s
  3977  2388 22570.3551   11  548 12080.1874 26143.1970   116%  7630 3565s
  3979  2389 25154.6240   13  501 12080.1874 26143.1970   116%  7626 3574s
  3980  2390 12774.8252   19  555 12080.1874 26143.1970   116%  7624 3578s
  3981  2391 14015.4432   31  546 12080.1874 26143.1970   116%  7622 3584s
  3982  2391 12710.4066   43  546 12080.1874 26143.1970   116%  7620 3598s

Cutting planes:
  Learned: 1
  Gomory: 14
  Implied bound: 32
  Projected implied bound: 261
  MIR: 1064
  Mixing: 2
  Flow cover: 890
  RLT: 60
  Relax-and-lift: 342

Explored 3982 nodes (31524181 simplex iterations) in 3600.02 seconds (8618.63 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12080.2 11899 11669.5 ... 10708.1

Time limit reached
Best objective 1.208018738784e+04, best bound 2.614319698768e+04, gap 116.4138%
  WARNING: Time limit reached. Using best solution found (gap: 116.41%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 12080.19, θ = 159815.59
  Upper Bound (UB) = 12080.19

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 159815.59
  [DEBUG]   ✓ Scenario 0: θ = 159815.59 ≤ Q = 159815.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 159815.59 ≤ Q = 159815.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 159815.59 ≤ Q = 159815.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 159815.59 ≤ Q = 159815.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 159815.59 ≤ Q = 159815.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 159815.59 ≤ Q = 159815.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 159815.59 ≤ Q = 159815.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 159815.59 ≤ Q = 159815.59 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 159815.59 ≤ Q = 159815.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 159815.59 ≤ Q = 159815.59 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2064559e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2064559e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.313039e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6734222.9774
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.552748e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -155274.85    0  124 6734222.98 -155274.85   102%     -    0s
H    0     0                    -119494.9783 -155274.85  29.9%     -    0s
H    0     0                    -119868.8465 -155274.85  29.5%     -    0s
     0     0 -129208.58    0   27 -119868.85 -129208.58  7.79%     -    0s
H    0     0                    -127876.6322 -129121.97  0.97%     -    0s
H    0     0                    -128205.4341 -129121.97  0.71%     -    0s
H    0     0                    -128479.7902 -129121.97  0.50%     -    0s
     0     0 -128918.07    0   13 -128479.79 -128918.07  0.34%     -    0s
     0     0 -128799.01    0   12 -128479.79 -128799.01  0.25%     -    0s
H    0     0                    -128491.8423 -128799.01  0.24%     -    0s
H    0     0                    -128493.1085 -128739.07  0.19%     -    0s
     0     0 -128739.07    0    9 -128493.11 -128739.07  0.19%     -    0s
     0     0 -128737.34    0    7 -128493.11 -128737.34  0.19%     -    0s
H    0     0                    -128560.5373 -128721.50  0.13%     -    0s
     0     0 -128721.50    0    6 -128560.54 -128721.50  0.13%     -    0s
     0     0 -128688.87    0    6 -128560.54 -128688.87  0.10%     -    0s
     0     0 -128688.87    0   20 -128560.54 -128688.87  0.10%     -    0s
*    0     0               0    -128654.7235 -128654.72  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 17
  Relax-and-lift: 3

Explored 1 nodes (542 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128655 -128561 -128493 ... 1.31304e+13
No other solutions better than -128655

Optimal solution found (tolerance 1.00e-06)
Best objective -1.286547234611e+05, best bound -1.286547234611e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 153750.89
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128654.72
  [DEBUG]   S×d_nominal = 282405.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282405.62 + -128654.72 = 153750.89
  [DEBUG]   Current θ from Master = 159815.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6064.69 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6015.49
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2738.3998, Absolute Gap = 2738.3998, Relative Gap = 0.226685
  Not converged yet (gap = 2738.40 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481291 nonzeros
Model fingerprint: 0xa2ae3e51
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 69993 rows and 28413 columns
Presolve time: 1.40s
Presolved: 99580 rows, 42487 columns, 601994 nonzeros
Variable types: 40228 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -353328.8244
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.526e+06
 Factor NZ  : 9.979e+06 (roughly 140 MB of memory)
 Factor Ops : 1.828e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.57973663e+07  1.91345523e+08  1.02e+05 2.01e+01  7.94e+04     3s
   1  -1.18724295e+07  1.67913573e+08  7.00e+04 6.89e+01  5.39e+04     3s
   2  -2.92872600e+06  1.27960023e+08  1.69e+04 1.30e-11  1.40e+04     3s
   3  -6.59646531e+05  8.81831874e+07  1.32e+03 9.90e-11  1.48e+03     3s
   4  -4.62477295e+05  3.43393734e+07  3.63e+02 1.46e-11  4.28e+02     3s
   5  -3.39900926e+05  2.43821491e+07  9.62e+01 1.72e-11  1.94e+02     3s
   6  -2.53716442e+05  1.66068623e+07  3.86e+01 8.90e-12  1.12e+02     3s
   7  -1.48656121e+05  1.12345008e+07  9.56e+00 1.19e-11  6.62e+01     3s
   8  -9.15965702e+04  4.58543235e+06  4.51e+00 6.92e-12  2.65e+01     3s
   9  -5.53840700e+04  2.50028859e+06  2.21e+00 3.41e-12  1.43e+01     3s
  10  -1.52084326e+04  8.89922637e+05  8.47e-01 2.71e-12  5.00e+00     3s
  11   5.74989400e+02  3.43779437e+05  4.50e-01 1.62e-12  1.89e+00     3s
  12   9.05763387e+03  2.24211930e+05  3.10e-01 7.68e-13  1.18e+00     3s
  13   1.58770807e+04  1.65295652e+05  2.17e-01 1.66e-04  8.21e-01     3s
  14   2.12235020e+04  1.18251591e+05  1.69e-01 7.70e-04  5.33e-01     3s
  15   2.50512760e+04  1.07311429e+05  1.37e-01 5.61e-04  4.52e-01     3s
  16   3.01715181e+04  9.65086309e+04  1.02e-01 5.76e-04  3.64e-01     3s
  17   3.38845349e+04  8.23951352e+04  7.95e-02 8.54e-04  2.66e-01     3s
  18   3.73895425e+04  7.53769403e+04  5.94e-02 1.40e-03  2.08e-01     3s
  19   4.02050899e+04  6.71045167e+04  4.42e-02 1.39e-03  1.48e-01     3s
  20   4.19592886e+04  6.42385011e+04  3.56e-02 9.74e-04  1.22e-01     3s
  21   4.32476678e+04  6.14885337e+04  2.95e-02 9.83e-04  1.00e-01     3s
  22   4.49189185e+04  5.96417522e+04  2.18e-02 9.32e-04  8.08e-02     4s
  23   4.58260044e+04  5.70010677e+04  1.78e-02 8.40e-04  6.13e-02     4s
  24   4.70651277e+04  5.65096696e+04  1.26e-02 7.77e-04  5.18e-02     4s
  25   4.76973952e+04  5.47378028e+04  1.01e-02 5.36e-04  3.86e-02     4s
  26   4.82908143e+04  5.40556415e+04  7.89e-03 4.20e-04  3.16e-02     4s
  27   4.90096656e+04  5.31356403e+04  5.33e-03 3.00e-04  2.26e-02     4s
  28   4.95514168e+04  5.25085474e+04  3.47e-03 2.19e-04  1.62e-02     4s
  29   4.98155865e+04  5.22004887e+04  2.60e-03 1.80e-04  1.31e-02     4s
  30   5.00079310e+04  5.18267692e+04  1.99e-03 1.35e-04  9.97e-03     4s
  31   5.00726605e+04  5.17567637e+04  1.80e-03 1.26e-04  9.24e-03     4s
  32   5.02719085e+04  5.14138547e+04  1.20e-03 8.38e-05  6.26e-03     4s
  33   5.03399628e+04  5.12648889e+04  9.97e-04 6.60e-05  5.07e-03     4s
  34   5.03638094e+04  5.11358645e+04  9.26e-04 5.06e-05  4.23e-03     4s
  35   5.04581396e+04  5.10663280e+04  6.77e-04 4.22e-05  3.34e-03     4s
  36   5.04845903e+04  5.10340740e+04  6.08e-04 3.86e-05  3.01e-03     4s
  37   5.05099341e+04  5.10092955e+04  5.42e-04 3.56e-05  2.74e-03     4s
  38   5.05807497e+04  5.09583881e+04  3.36e-04 2.94e-05  2.07e-03     4s
  39   5.05914018e+04  5.09084968e+04  3.10e-04 2.32e-05  1.74e-03     4s
  40   5.06054656e+04  5.08688302e+04  2.70e-04 1.85e-05  1.44e-03     4s
  41   5.06331398e+04  5.08431599e+04  1.95e-04 1.54e-05  1.15e-03     5s
  42   5.06559868e+04  5.07665867e+04  1.41e-04 5.56e-06  6.07e-04     5s
  43   5.06823458e+04  5.07479929e+04  7.48e-05 4.33e-06  3.60e-04     5s
  44   5.06992537e+04  5.07399744e+04  3.84e-05 3.05e-06  2.23e-04     5s
  45   5.07067387e+04  5.07288184e+04  2.37e-05 1.24e-06  1.21e-04     5s
  46   5.07120796e+04  5.07231569e+04  1.30e-05 5.13e-07  6.08e-05     5s
  47   5.07177749e+04  5.07197757e+04  2.00e-06 9.48e-08  1.10e-05     5s
  48   5.07181125e+04  5.07190272e+04  1.43e-06 3.37e-09  5.02e-06     5s
  49   5.07186503e+04  5.07189933e+04  6.07e-07 4.09e-09  1.88e-06     5s
  50   5.07189342e+04  5.07189861e+04  9.26e-08 2.39e-10  2.85e-07     5s
  51   5.07189813e+04  5.07189858e+04  2.34e-07 1.05e-09  2.49e-08     5s
  52   5.07189855e+04  5.07189856e+04  1.57e-08 2.12e-08  3.71e-10     5s

Barrier solved model in 52 iterations and 5.07 seconds (9.32 work units)
Optimal objective 5.07189855e+04


Root crossover log...

   83937 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    6622 PPushes remaining with PInf 2.1978233e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 4.2710039e+02      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40948    5.0718986e+04   0.000000e+00   4.271004e+02      7s
   41481    5.0718986e+04   0.000000e+00   0.000000e+00      8s
   41481    5.0718986e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.41s

Solved with barrier

Root relaxation: objective 5.071899e+04, 41481 iterations, 6.27 seconds (13.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50718.9856    0  368 -219144.29 50718.9856   123%     -    8s
H    0     0                    -212888.7365 50718.9856   124%     -    8s
H    0     0                    -110014.0191 50718.9856   146%     -    9s
H    0     0                    -107073.8179 50718.9856   147%     -    9s
H    0     0                    -53067.10464 50718.9856   196%     -    9s
H    0     0                    -12857.40115 50718.9856   494%     -   10s
H    0     0                    -11679.08267 50718.9856   534%     -   10s
H    0     0                    -11655.78277 50718.9856   535%     -   10s
H    0     0                    -11649.45020 42141.2278   462%     -   50s
H    0     0                    -7533.502742 42141.2278   659%     -   50s
     0     0 42141.2278    0  502 -7533.5027 42141.2278   659%     -   50s
     0     0 41526.6553    0  559 -7533.5027 41526.6553   651%     -   67s
     0     0 41439.8279    0  558 -7533.5027 41439.8279   650%     -   75s
     0     0 41262.0983    0  555 -7533.5027 41262.0983   648%     -   83s
     0     0 41195.2224    0  557 -7533.5027 41195.2224   647%     -   89s
     0     0 41195.2224    0  563 -7533.5027 41195.2224   647%     -   99s
     0     0 41195.2224    0  571 -7533.5027 41195.2224   647%     -  100s
     0     0 41195.2224    0  562 -7533.5027 41195.2224   647%     -  101s
     0     0 41195.2224    0  562 -7533.5027 41195.2224   647%     -  101s
     0     0 37208.9172    0  367 -7533.5027 37208.9172   594%     -  141s
H    0     0                    -6306.084894 37208.9172   690%     -  141s
H    0     0                    -3237.989103 37208.9172  1249%     -  141s
H    0     0                    -2430.013131 37208.9172  1631%     -  142s
H    0     0                    -1285.627222 37208.9172  2994%     -  143s
H    0     0                    1169.2403880 37208.9172  3082%     -  143s
H    0     0                    1497.9969591 37208.9172  2384%     -  143s
H    0     0                    1498.4645589 37208.9172  2383%     -  143s
H    0     0                    1528.1929271 37208.9172  2335%     -  143s
H    0     0                    1544.8652396 37208.9172  2309%     -  143s
H    0     0                    1586.1364755 37208.9172  2246%     -  143s
H    0     0                    1589.9392469 37208.9172  2240%     -  143s
     0     0 35585.7855    0  622 1589.93925 35585.7855  2138%     -  197s
     0     0 35198.8478    0  548 1589.93925 35198.8478  2114%     -  244s
H    0     0                    4012.9503184 34910.3358   770%     -  268s
H    0     0                    5742.9850592 34910.3358   508%     -  268s
H    0     0                    6138.6511508 34910.3358   469%     -  268s
H    0     0                    6290.3144904 34910.3358   455%     -  268s
H    0     0                    6309.6166354 34910.3358   453%     -  268s
H    0     0                    6318.3648859 34910.3358   453%     -  268s
H    0     0                    6413.7679040 34910.3358   444%     -  268s
H    0     0                    6441.9663820 34910.3358   442%     -  268s
H    0     0                    6646.9309985 34910.3358   425%     -  268s
H    0     0                    6826.2542266 34910.3358   411%     -  268s
H    0     0                    6828.8612551 34910.3358   411%     -  268s
H    0     0                    6831.7538858 34910.3358   411%     -  268s
     0     0 34910.3358    0  559 6831.75389 34910.3358   411%     -  281s
     0     0 34872.7549    0  549 6831.75389 34872.7549   410%     -  306s
     0     0 34838.3490    0  523 6831.75389 34838.3490   410%     -  331s
     0     0 34817.9179    0  508 6831.75389 34817.9179   410%     -  347s
     0     0 34743.3283    0  511 6831.75389 34743.3283   409%     -  363s
     0     0 34668.8589    0  514 6831.75389 34668.8589   407%     -  381s
     0     0 34617.4537    0  514 6831.75389 34617.4537   407%     -  390s
H    0     0                    6847.8903395 34579.0051   405%     -  401s
H    0     0                    7374.5402301 34579.0051   369%     -  401s
H    0     0                    7376.0856554 34579.0051   369%     -  401s
H    0     0                    7386.4858594 34579.0051   368%     -  401s
H    0     0                    7469.1737459 34579.0051   363%     -  401s
H    0     0                    7588.5491359 34579.0051   356%     -  401s
H    0     0                    7592.5873322 34579.0051   355%     -  401s
     0     0 34579.0051    0  506 7592.58733 34579.0051   355%     -  401s
     0     0 34577.9077    0  514 7592.58733 34577.9077   355%     -  403s
     0     0 32039.1868    0  385 7592.58733 32039.1868   322%     -  521s
H    0     0                    7763.6863658 31594.8417   307%     -  562s
H    0     0                    7999.0580756 31594.8417   295%     -  562s
H    0     0                    8031.4818049 31594.8417   293%     -  562s
     0     0 31594.8417    0  393 8031.48180 31594.8417   293%     -  562s
     0     0 31405.5060    0  379 8031.48180 31405.5060   291%     -  589s
     0     0 31337.8860    0  377 8031.48180 31337.8860   290%     -  605s
     0     0 31314.0010    0  377 8031.48180 31314.0010   290%     -  616s
H    0     0                    8159.7069754 31301.0939   284%     -  623s
H    0     0                    8176.7707845 31301.0939   283%     -  623s
H    0     0                    8180.7429179 31301.0939   283%     -  623s
H    0     0                    8279.4575371 31301.0939   278%     -  623s
H    0     0                    8299.1048794 31301.0939   277%     -  623s
H    0     0                    8313.5755577 31301.0939   277%     -  623s
H    0     0                    8313.8126319 31301.0939   276%     -  623s
H    0     0                    8313.9009891 31301.0939   276%     -  623s
H    0     0                    8325.7096877 31301.0939   276%     -  623s
H    0     0                    8336.6037152 31301.0939   275%     -  623s
     0     0 31301.0939    0  387 8336.60372 31301.0939   275%     -  623s
     0     0 31270.1813    0  379 8336.60372 31270.1813   275%     -  631s
     0     0 31244.2938    0  394 8336.60372 31244.2938   275%     -  638s
     0     0 31216.1682    0  388 8336.60372 31216.1682   274%     -  646s
     0     0 31155.7687    0  390 8336.60372 31155.7687   274%     -  660s
     0     0 31117.9872    0  372 8336.60372 31117.9872   273%     -  673s
     0     0 31111.6378    0  447 8336.60372 31111.6378   273%     -  681s
     0     0 31110.7837    0  492 8336.60372 31110.7837   273%     -  684s
H    0     0                    8345.3089942 31110.7837   273%     -  709s
H    0     0                    8366.4777352 31110.7837   272%     -  709s
H    0     0                    8411.0319057 31110.7837   270%     -  709s
H    0     0                    8441.4772232 31110.7837   269%     -  709s
     0     0 29458.2244    0  515 8441.47722 29458.2244   249%     -  773s
H    0     0                    8459.3111142 29457.8531   248%     -  774s
H    0     0                    8482.2346037 29457.8531   247%     -  774s
H    0     0                    8562.4097806 29168.1660   241%     -  800s
H    0     0                    8603.5382175 29168.1660   239%     -  800s
H    0     0                    8612.4304421 29168.1660   239%     -  800s
H    0     0                    8614.5597775 29168.1660   239%     -  800s
H    0     0                    8627.7647130 29168.1660   238%     -  800s
     0     0 29168.1660    0  396 8627.76471 29168.1660   238%     -  800s
     0     0 28983.8570    0  414 8627.76471 28983.8570   236%     -  818s
     0     0 28937.7921    0  462 8627.76471 28937.7921   235%     -  831s
     0     0 28898.4904    0  439 8627.76471 28898.4904   235%     -  839s
     0     0 28880.5102    0  433 8627.76471 28880.5102   235%     -  849s
     0     0 28863.0798    0  446 8627.76471 28863.0798   235%     -  856s
     0     0 28844.7790    0  435 8627.76471 28844.7790   234%     -  864s
     0     0 28837.3344    0  450 8627.76471 28837.3344   234%     -  868s
     0     0 28833.0068    0  444 8627.76471 28833.0068   234%     -  871s
     0     0 28829.7157    0  337 8627.76471 28829.7157   234%     -  873s
H    0     0                    8664.7882794 28569.1316   230%     -  894s
     0     0 28569.1316    0  318 8664.78828 28569.1316   230%     -  894s
     0     0 28475.1303    0  316 8664.78828 28475.1303   229%     -  910s
     0     0 28438.1866    0  389 8664.78828 28438.1866   228%     -  922s
     0     0 28422.2284    0  366 8664.78828 28422.2284   228%     -  929s
     0     0 28416.9782    0  371 8664.78828 28416.9782   228%     -  932s
     0     0 28404.8080    0  374 8664.78828 28404.8080   228%     -  937s
     0     0 28393.5181    0  377 8664.78828 28393.5181   228%     -  942s
     0     0 28389.5176    0  371 8664.78828 28389.5176   228%     -  945s
H    0     0                    8669.4311298 28175.7879   225%     -  963s
H    0     0                    8678.3283047 28175.7879   225%     -  963s
H    0     0                    8689.7077814 28175.7879   224%     -  963s
H    0     0                    8692.9017627 28175.7879   224%     -  963s
H    0     0                    8693.0353604 28175.7879   224%     -  963s
H    0     0                    8694.0054260 28175.7879   224%     -  963s
     0     0 28175.7879    0  455 8694.00543 28175.7879   224%     -  963s
     0     0 28110.4982    0  393 8694.00543 28110.4982   223%     -  976s
     0     0 28098.6372    0  398 8694.00543 28098.6372   223%     -  982s
H    0     0                    8711.7993522 28089.1519   222%     -  988s
     0     0 28089.1519    0  417 8711.79935 28089.1519   222%     -  988s
     0     0 28081.6581    0  425 8711.79935 28081.6581   222%     -  996s
     0     0 28080.3778    0  432 8711.79935 28080.3778   222%     -  999s
     0     0 27928.9204    0  411 8711.79935 27928.9204   221%     - 1020s
     0     0 27901.1275    0  481 8711.79935 27901.1275   220%     - 1033s
     0     0 27890.5287    0  411 8711.79935 27890.5287   220%     - 1038s
     0     0 27859.2704    0  395 8711.79935 27859.2704   220%     - 1047s
     0     0 27847.8479    0  444 8711.79935 27847.8479   220%     - 1056s
     0     0 27845.1950    0  547 8711.79935 27845.1950   220%     - 1059s
     0     0 27734.4334    0  408 8711.79935 27734.4334   218%     - 1076s
H    0     0                    8717.1162970 27734.4276   218%     - 1079s
H    0     0                    8721.5305161 27734.4276   218%     - 1079s
     0     0 27721.4514    0  465 8721.53052 27721.4514   218%     - 1083s
     0     0 27712.9994    0  385 8721.53052 27712.9994   218%     - 1087s
     0     0 27712.6408    0  373 8721.53052 27712.6408   218%     - 1087s
     0     0 27630.6097    0  404 8721.53052 27630.6097   217%     - 1100s
     0     0 27613.4587    0  365 8721.53052 27613.4587   217%     - 1108s
     0     0 27606.1888    0  435 8721.53052 27606.1888   217%     - 1115s
     0     0 27601.5721    0  427 8721.53052 27601.5721   216%     - 1119s
     0     0 27599.4318    0  420 8721.53052 27599.4318   216%     - 1124s
     0     0 27570.1757    0  420 8721.53052 27570.1757   216%     - 1134s
     0     0 27555.9767    0  436 8721.53052 27555.9767   216%     - 1142s
     0     0 27553.4100    0  477 8721.53052 27553.4100   216%     - 1147s
     0     0 27515.2520    0  482 8721.53052 27515.2520   215%     - 1158s
     0     0 27491.1584    0  476 8721.53052 27491.1584   215%     - 1164s
     0     0 27485.1496    0  487 8721.53052 27485.1496   215%     - 1169s
     0     0 27482.2878    0  473 8721.53052 27482.2878   215%     - 1172s
     0     0 27433.7627    0  471 8721.53052 27433.7627   215%     - 1183s
     0     0 27411.4457    0  470 8721.53052 27411.4457   214%     - 1191s
     0     0 27400.3275    0  533 8721.53052 27400.3275   214%     - 1196s
     0     0 27396.4975    0  479 8721.53052 27396.4975   214%     - 1198s
     0     0 27383.8503    0  419 8721.53052 27383.8503   214%     - 1205s
     0     0 27382.1715    0  370 8721.53052 27382.1715   214%     - 1208s
     0     0 27361.5168    0  484 8721.53052 27361.5168   214%     - 1216s
H    0     0                    9779.8369271 27359.3289   180%     - 1244s
     0     0 27358.4646    0  487 9779.83693 27358.4646   180%     - 1247s
     0     0 27355.1701    0  473 9779.83693 27355.1701   180%     - 1251s
     0     0 27354.1372    0  473 9779.83693 27354.1372   180%     - 1254s
H    0     0                    9987.8252807 27354.1372   174%     - 1338s
     0     2 27354.1372    0  473 9987.82528 27354.1372   174%     - 1341s
     1     3 26323.5470    1  449 9987.82528 27352.3223   174% 32315 1383s
     2     5 26017.6471    2  424 9987.82528 27352.3223   174% 20142 1400s
     4     9 25871.3591    3  395 9987.82528 27272.9495   173% 14385 1418s
     8    18 26172.4020    3  406 9987.82528 27272.7219   173% 13010 1443s
    17    35 25758.0265    4  469 9987.82528 26815.0274   168% 12780 1478s
    34    49 25574.4790    5  412 9987.82528 26569.2527   166% 20411 1542s
    48    77 23973.6328    6  329 9987.82528 26569.2527   166% 17764 1673s
H   76   199                    10116.521035 26569.2527   163% 15360 1731s
H   83   199                    10180.508501 26569.2527   161% 14498 1731s
H  137   199                    10192.865834 26569.2527   161% 11041 1731s
H  160   199                    10283.358664 26569.2527   158% 10291 1731s
   198   288 23532.0079   10  288 10283.3587 26569.2527   158%  9407 1764s
   287   344 23367.4886   15  332 10283.3587 26569.2527   158%  8971 1790s
   345   412 23262.3461   17  348 10283.3587 26569.2527   158%  8556 1817s
   423   458 23030.8545   20  283 10283.3587 26569.2527   158%  8398 1836s
H  439   458                    10286.461488 26569.2527   158%  8279 1836s
   473   537 21768.8379   22  268 10286.4615 26569.2527   158%  8227 1859s
   565   614 21703.0257   23  254 10286.4615 26569.2527   158%  7976 1880s
   662   677 21554.4815   27  259 10286.4615 26569.2527   158%  7573 1900s
   745   706 21373.7971   29  243 10286.4615 26569.2527   158%  7381 1916s
H  746   706                    10526.482573 26569.2527   152%  7371 1916s
   776   788 19596.9990   15  142 10526.4826 26569.2527   152%  7347 1935s
   878   813 21057.9910   30  253 10526.4826 26569.2527   152%  6905 1951s
H  879   813                    10769.894055 26569.2527   147%  6897 1951s
H  886   813                    11244.621612 26569.2527   136%  6881 1951s
   909   843 21004.6385   31  243 11244.6216 26569.2527   136%  6858 1971s
  1002   858 20924.7476   33  249 11244.6216 26569.2527   136%  6659 1986s
H 1003   858                    11465.586250 26569.2527   132%  6652 1986s
  1035   877 20884.6792   34  252 11465.5863 26569.2527   132%  6687 2005s
H 1036   877                    11499.408302 26569.2527   131%  6681 2005s
H 1069   877                    11499.498592 26569.2527   131%  6662 2005s
  1072   906 20847.3831   35  249 11499.4986 26569.2527   131%  6683 2023s
H 1073   906                    11533.320644 26569.2527   130%  6676 2023s
  1105  1022 20687.0844   36  247 11533.3206 26569.2527   130%  6742 2042s
  1232  1047 19986.9183   39  215 11533.3206 26569.2527   130%  6532 2061s
  1265  1074 19836.8283   40  212 11533.3206 26569.2527   130%  6480 2079s
  1298  1098 19776.0356   41  205 11533.3206 26569.2527   130%  6510 2097s
  1331  1122 19729.7971   42  236 11533.3206 26569.2527   130%  6472 2112s
H 1367  1150                    11655.176899 26569.2527   128%  6454 2133s
  1403  1254 19660.2483   44  264 11655.1769 26569.2527   128%  6461 2154s
  1575  1334 17961.6366   46  208 11655.1769 26569.2527   128%  6207 2178s
  1735  1390 17682.0459   50  255 11655.1769 26569.2527   128%  6010 2202s
  1855  1470 17532.4130   53  228 11655.1769 26569.2527   128%  5945 2226s
  1999  1543 16664.1912   57  237 11655.1769 26569.2527   128%  5834 2254s
  2154  1695 15808.3671   61  300 11655.1769 26569.2527   128%  5743 2282s
  2340  1826 15461.6160   69  162 11655.1769 26569.2527   128%  5587 2310s
  2551  1907 infeasible   78      11655.1769 26569.2527   128%  5423 2339s
  2730  1964 infeasible   85      11655.1769 26569.2527   128%  5303 2368s
  2937  1972     cutoff   32      11655.1769 26569.2527   128%  5185 2400s
  3068  1993 11746.5960   92  165 11655.1769 26569.2219   128%  5177 2431s
  3135  2040 12654.6836   77  192 11655.1769 26474.1376   127%  5290 2468s
  3202  2110 26281.2872    6  411 11655.1769 26473.9623   127%  5415 2504s
  3286  2158 23835.1514    8  390 11655.1769 26473.9623   127%  5538 2536s
  3354  2203 infeasible   25      11655.1769 26290.0679   126%  5657 2568s
  3425  2259 25593.6182    7  327 11655.1769 26290.0679   126%  5788 2607s
  3523  2329 23821.3363    8  390 11655.1769 26290.0679   126%  5929 2649s
  3625  2421 22621.8862    9  369 11655.1769 26290.0679   126%  6053 2686s
  3758  2536 22474.3011   11  369 11655.1769 26123.9295   124%  6140 2728s
H 3908  2518                    11875.157795 26123.9295   120%  6199 2728s
H 3921  2514                    11973.037331 26123.9295   118%  6203 2748s
H 3921  2478                    12167.030564 26123.9295   115%  6203 2750s
  3922  2476 20825.9731   30  473 12167.0306 26123.9295   115%  6201 2863s
  3924  2477 14473.5752   88  195 12167.0306 26123.9295   115%  6198 2872s
  3925  2478 14632.0118   60  371 12167.0306 26123.9295   115%  6197 2936s
  3926  2479 13076.7154   61  440 12167.0306 26123.9295   115%  6195 3009s
  3927  2479 19524.3772   17  321 12167.0306 26123.9295   115%  6194 3058s
  3928  2480 13925.4716   83  381 12167.0306 26123.9295   115%  6192 3087s
  3929  2481 20827.6158   14  402 12167.0306 26123.9295   115%  6190 3113s
  3930  2481 20283.9334   16  457 12167.0306 26123.9295   115%  6189 3152s
  3931  2482 12489.1199  103  450 12167.0306 26123.9295   115%  6187 3174s
  3932  2483 14019.5297   31  442 12167.0306 26123.9295   115%  6186 3187s
  3933  2483 18612.0356   31  435 12167.0306 26123.9295   115%  6184 3199s
  3934  2484 19944.1077   28  454 12167.0306 26123.9295   115%  6183 3210s
  3935  2485 12775.9117   22  452 12167.0306 26123.9295   115%  6181 3225s
  3936  2485 12659.4547   32  414 12167.0306 26123.9295   115%  6179 3230s
  3937  2486 12415.8627   45  414 12167.0306 26123.9295   115%  6178 3238s
  3938  2487 14103.7596   11  408 12167.0306 26123.9295   115%  6176 3243s
  3939  2487 14021.0661   28  405 12167.0306 26123.9295   115%  6175 3249s
  3940  2488 13091.7479   78  416 12167.0306 26123.9295   115%  6173 3254s
  3941  2489 12896.7100   64  505 12167.0306 26123.9295   115%  6172 3276s
  3942  2489 13400.5277   47  389 12167.0306 26123.9295   115%  6170 3286s
  3943  2490 17278.6707   27  405 12167.0306 26123.9295   115%  6168 3292s
  3944  2491 12757.7744   35  410 12167.0306 26123.9295   115%  6167 3297s
  3945  2491 15132.5472   55  412 12167.0306 26123.9295   115%  6165 3301s
  3947  2493 19955.6001   29  457 12167.0306 26123.9295   115%  6162 3317s
  3948  2493 15061.5488   18  415 12167.0306 26123.9295   115%  6161 3322s
  3949  2494 23584.1581   10  415 12167.0306 26123.9295   115%  6159 3328s
  3950  2495 23469.4200   12  422 12167.0306 26123.9295   115%  6157 3334s
  3951  2495 16931.1307   30  435 12167.0306 26123.9295   115%  6156 3348s
  3952  2496 19365.8060   34  449 12167.0306 26123.9295   115%  6154 3354s
  3953  2497 18851.0094   26  438 12167.0306 26123.9295   115%  6153 3363s
  3954  2497 12649.4661   25  386 12167.0306 26123.9295   115%  6151 3368s
  3955  2498 21057.9386   31  485 12167.0306 26123.9295   115%  6150 3375s
  3956  2499 15536.1524   31  496 12167.0306 26123.9295   115%  6148 3380s
  3957  2499 13875.9380   58  474 12167.0306 26123.9295   115%  6147 3394s
  3958  2500 24736.6838    6  415 12167.0306 26123.9295   115%  6145 3399s
  3959  2501 19666.4481   15  410 12167.0306 26123.9295   115%  6143 3404s
  3960  2501 14988.7911   57  491 12167.0306 26123.9295   115%  6142 3419s
  3961  2502 18738.9294   18  543 12167.0306 26123.9295   115%  6140 3427s
  3962  2503 20077.3896   27  551 12167.0306 26123.9295   115%  6139 3435s
  3963  2503 17979.0571   44  509 12167.0306 26123.9295   115%  6137 3453s
  3964  2504 18026.2489   22  507 12167.0306 26123.9295   115%  6136 3458s
  3965  2505 19024.0301   24  402 12167.0306 26123.9295   115%  6134 3462s
  3966  2505 15607.4745   38  373 12167.0306 26123.9295   115%  6133 3478s
  3967  2506 17219.1589   18  376 12167.0306 26123.9295   115%  6131 3485s
  3968  2507 15776.7610   30  403 12167.0306 26123.9295   115%  6130 3493s
  3969  2507 14792.9891   65  411 12167.0306 26123.9295   115%  6128 3498s
  3970  2508 22580.0506    9  396 12167.0306 26123.9295   115%  6126 3512s
  3971  2509 24288.1316   12  555 12167.0306 26123.9295   115%  6125 3517s
  3972  2509 13114.4478   58  394 12167.0306 26123.9295   115%  6123 3527s
  3973  2510 13286.1470   89  446 12167.0306 26123.9295   115%  6122 3533s
  3974  2511 21887.1285   24  539 12167.0306 26123.9295   115%  6120 3564s
  3975  2511 18579.3093   32  544 12167.0306 26123.9295   115%  6119 3572s
  3976  2512 16031.5212   13  542 12167.0306 26123.9295   115%  6117 3578s
  3977  2513 17545.8584   14  453 12167.0306 26123.9295   115%  6116 3580s
  3978  2513 16631.2606   46  551 12167.0306 26123.9295   115%  6114 3588s
  3979  2514 15235.6335   77  461 12167.0306 26123.9295   115%  6113 3590s
  3980  2515 23811.9199   11  456 12167.0306 26123.9295   115%  6111 3597s

Cutting planes:
  Gomory: 29
  Implied bound: 60
  Projected implied bound: 251
  MIR: 1086
  Mixing: 4
  Flow cover: 972
  Inf proof: 1
  RLT: 64
  Relax-and-lift: 317

Explored 3980 nodes (25794040 simplex iterations) in 3600.09 seconds (8501.71 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12167 11973 11875.2 ... 10769.9

Time limit reached
Best objective 1.216703056429e+04, best bound 2.612392947878e+04, gap 114.7108%
  WARNING: Time limit reached. Using best solution found (gap: 114.71%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 12167.03, θ = 161679.16
  Upper Bound (UB) = 12167.03

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161679.16
  [DEBUG]   ✓ Scenario 0: θ = 161679.16 ≤ Q = 161679.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161679.16 ≤ Q = 161679.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 161679.16 ≤ Q = 161679.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 161679.16 ≤ Q = 161679.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 161679.16 ≤ Q = 161679.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 161679.16 ≤ Q = 161679.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 161679.16 ≤ Q = 161679.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 161679.16 ≤ Q = 161679.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 161679.16 ≤ Q = 161679.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 161679.16 ≤ Q = 161679.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 161679.16 ≤ Q = 161679.16 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x35cb9f0e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x35cb9f0e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362410e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6962885.3374
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.540092e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154009.17    0  132 6962885.34 -154009.17   102%     -    0s
H    0     0                    -116552.8926 -154009.17  32.1%     -    0s
H    0     0                    -116702.3421 -154009.17  32.0%     -    0s
     0     0 -127357.67    0   57 -116702.34 -127357.67  9.13%     -    0s
H    0     0                    -124944.9461 -127336.28  1.91%     -    0s
H    0     0                    -125635.7521 -127336.28  1.35%     -    0s
     0     0 -127302.38    0   54 -125635.75 -127302.38  1.33%     -    0s
H    0     0                    -125839.9819 -127302.38  1.16%     -    0s
     0     0 -127137.68    0   39 -125839.98 -127137.68  1.03%     -    0s
     0     0 -127066.53    0   39 -125839.98 -127066.53  0.97%     -    0s
     0     0 -126809.34    0    2 -125839.98 -126809.34  0.77%     -    0s
H    0     0                    -126198.1556 -126806.83  0.48%     -    0s
     0     0 -126687.20    0   42 -126198.16 -126687.20  0.39%     -    0s
     0     0 -126684.38    0   42 -126198.16 -126684.38  0.39%     -    0s
     0     0 -126587.62    0   38 -126198.16 -126587.62  0.31%     -    0s
     0     0 -126580.17    0   40 -126198.16 -126580.17  0.30%     -    0s
     0     0 -126509.38    0   40 -126198.16 -126509.38  0.25%     -    0s
     0     0 -126504.98    0   40 -126198.16 -126504.98  0.24%     -    0s
H    0     0                    -126280.5602 -126504.98  0.18%     -    0s
     0     0 -126504.98    0   65 -126280.56 -126504.98  0.18%     -    0s
H    0     0                    -126367.1413 -126504.98  0.11%     -    0s
     0     0 -126504.98    0   44 -126367.14 -126504.98  0.11%     -    0s
     0     0 -126504.98    0   37 -126367.14 -126504.98  0.11%     -    0s
     0     0 -126482.10    0   37 -126367.14 -126482.10  0.09%     -    0s
     0     0 -126481.86    0   37 -126367.14 -126481.86  0.09%     -    0s
     0     0 -126420.43    0   38 -126367.14 -126420.43  0.04%     -    0s
     0     0 -126418.33    0   36 -126367.14 -126418.33  0.04%     -    0s
     0     0 -126400.62    0   35 -126367.14 -126400.62  0.03%     -    0s
     0     0 -126400.62    0   35 -126367.14 -126400.62  0.03%     -    0s
     0     0 -126400.62    0   34 -126367.14 -126400.62  0.03%     -    0s
H    0     0                    -126391.4375 -126400.62  0.01%     -    0s
     0     0 -126400.62    0   30 -126391.44 -126400.62  0.01%     -    0s
H    0     0                    -126391.9379 -126398.88  0.01%     -    0s
     0     0 -126398.88    0   30 -126391.94 -126398.88  0.01%     -    0s
     0     0     cutoff    0      -126391.94 -126391.94  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 4
  MIR: 41
  Flow cover: 4

Explored 1 nodes (1077 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -126392 -126391 -126367 ... -116553
No other solutions better than -126392

Optimal solution found (tolerance 1.00e-06)
Best objective -1.263919378589e+05, best bound -1.263919378589e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 155965.04
  Scenario: 4 demand increases, 56 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -126391.94
  [DEBUG]   S×d_nominal = 282356.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282356.97 + -126391.94 = 155965.04
  [DEBUG]   Current θ from Master = 161679.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5714.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6452.90
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2825.2430, Absolute Gap = 2825.2430, Relative Gap = 0.232205
  Not converged yet (gap = 2825.24 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 4 increases, 56 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524543 nonzeros
Model fingerprint: 0xb28e4350
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 76356 rows and 30996 columns
Presolve time: 1.56s
Presolved: 108507 rows, 46144 columns, 653363 nonzeros
Variable types: 43885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -354124.1784
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.21s

Barrier statistics:
 Dense cols : 659
 AA' NZ     : 3.755e+06
 Factor NZ  : 9.082e+06 (roughly 140 MB of memory)
 Factor Ops : 1.738e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66025907e+07  2.05559478e+08  1.07e+05 1.95e+01  8.28e+04     3s
   1  -1.25982880e+07  1.81789193e+08  7.40e+04 7.01e+01  5.66e+04     3s
   2  -3.74752931e+06  1.38630005e+08  2.18e+04 8.56e-01  1.78e+04     3s
   3  -8.05228696e+05  9.78441239e+07  2.05e+03 1.68e+00  2.05e+03     3s
   4  -4.89362441e+05  3.40652443e+07  4.57e+02 1.53e-01  4.74e+02     3s
   5  -3.49201457e+05  2.38801421e+07  1.41e+02 8.97e-02  2.08e+02     3s
   6  -2.59559637e+05  1.63290002e+07  6.59e+01 5.47e-02  1.18e+02     3s
   7  -1.50061194e+05  1.17078794e+07  2.15e+01 3.67e-02  6.90e+01     3s
   8  -1.00090908e+05  8.59137038e+06  1.18e+01 2.68e-02  4.79e+01     3s
   9  -8.31228531e+04  6.17043266e+06  7.85e+00 1.87e-02  3.36e+01     3s
  10  -5.82865799e+04  3.93930768e+06  3.42e+00 1.15e-02  2.07e+01     3s
  11  -1.54513452e+04  4.99642896e+05  4.76e-01 8.68e-04  2.61e+00     3s
  12  -2.03277869e+03  2.67868274e+05  3.15e-01 1.42e-03  1.36e+00     3s
  13   6.03211583e+03  2.08004929e+05  2.30e-01 2.10e-03  1.02e+00     3s
  14   1.11222681e+04  1.56179652e+05  1.87e-01 2.35e-03  7.32e-01     3s
  15   1.73593877e+04  1.37961678e+05  1.44e-01 2.02e-03  6.09e-01     3s
  16   2.48614305e+04  1.13088905e+05  9.49e-02 1.48e-03  4.45e-01     3s
  17   2.77910850e+04  8.70620810e+04  7.82e-02 1.98e-03  2.99e-01     3s
  18   3.20821743e+04  7.94873992e+04  5.99e-02 1.25e-03  2.39e-01     3s
  19   3.38465106e+04  7.07012063e+04  5.31e-02 1.24e-03  1.86e-01     4s
  20   3.60859568e+04  6.62915947e+04  4.51e-02 1.01e-03  1.52e-01     4s
  21   3.92217785e+04  6.21255112e+04  3.43e-02 1.24e-03  1.15e-01     4s
  22   4.10013902e+04  5.92744113e+04  2.83e-02 9.60e-04  9.21e-02     4s
  23   4.20456955e+04  5.71635788e+04  2.48e-02 7.31e-04  7.62e-02     4s
  24   4.47929616e+04  5.58029320e+04  1.59e-02 5.96e-04  5.55e-02     4s
  25   4.55507425e+04  5.48083424e+04  1.36e-02 4.80e-04  4.67e-02     4s
  26   4.60405839e+04  5.43212612e+04  1.21e-02 4.32e-04  4.17e-02     4s
  27   4.73858642e+04  5.35725381e+04  8.21e-03 4.48e-04  3.12e-02     4s
  28   4.80417119e+04  5.29982579e+04  6.35e-03 3.57e-04  2.50e-02     4s
  29   4.85312096e+04  5.25275322e+04  5.01e-03 2.90e-04  2.01e-02     4s
  30   4.86503980e+04  5.20511809e+04  4.68e-03 2.25e-04  1.71e-02     4s
  31   4.90334242e+04  5.17973482e+04  3.68e-03 1.90e-04  1.39e-02     4s
  32   4.94030059e+04  5.14473442e+04  2.73e-03 1.32e-04  1.03e-02     4s
  33   4.96618324e+04  5.12289777e+04  2.08e-03 1.03e-04  7.90e-03     4s
  34   4.98801155e+04  5.11003782e+04  1.54e-03 8.37e-05  6.15e-03     4s
  35   5.00609852e+04  5.09453162e+04  1.12e-03 5.91e-05  4.46e-03     4s
  36   5.01241217e+04  5.08636743e+04  9.71e-04 4.64e-05  3.73e-03     4s
  37   5.02313185e+04  5.07697718e+04  7.18e-04 3.13e-05  2.71e-03     4s
  38   5.03220215e+04  5.07133310e+04  5.18e-04 2.37e-05  1.97e-03     4s
  39   5.03428025e+04  5.07012573e+04  4.74e-04 2.34e-05  1.81e-03     4s
  40   5.03986159e+04  5.06844532e+04  3.51e-04 2.03e-05  1.44e-03     5s
  41   5.04696136e+04  5.06208938e+04  1.92e-04 1.83e-05  7.62e-04     5s
  42   5.04886130e+04  5.06008098e+04  1.52e-04 1.13e-05  5.65e-04     5s
  43   5.05005047e+04  5.05938363e+04  1.27e-04 9.13e-06  4.70e-04     5s
  44   5.05180832e+04  5.05828287e+04  9.13e-05 5.47e-06  3.26e-04     5s
  45   5.05287225e+04  5.05811904e+04  6.98e-05 4.97e-06  2.64e-04     5s
  46   5.05600921e+04  5.05701653e+04  8.80e-06 1.44e-06  5.07e-05     5s
  47   5.05641657e+04  5.05656855e+04  1.58e-06 9.12e-07  7.66e-06     5s
  48   5.05651259e+04  5.05653299e+04  2.23e-07 5.35e-08  1.03e-06     5s
  49   5.05652985e+04  5.05652994e+04  6.02e-09 1.78e-09  4.87e-09     5s
  50   5.05652994e+04  5.05652994e+04  5.16e-08 3.62e-12  9.44e-11     5s

Barrier solved model in 50 iterations and 5.01 seconds (9.55 work units)
Optimal objective 5.05652994e+04


Root crossover log...

   88356 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    3192 PPushes remaining with PInf 1.0135536e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7481422e+00      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37327    5.0565299e+04   0.000000e+00   1.748142e+00      8s
   37337    5.0565299e+04   0.000000e+00   0.000000e+00      8s
   37337    5.0565299e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.94s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.056530e+04, 37337 iterations, 6.54 seconds (13.25 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50565.2994    0  420 -219144.29 50565.2994   123%     -    9s
H    0     0                    -119056.8770 50565.2994   142%     -    9s
H    0     0                    -113749.5376 50565.2994   144%     -    9s
H    0     0                    -112750.1648 50565.2994   145%     -    9s
H    0     0                    -110364.5775 50565.2994   146%     -    9s
H    0     0                    -76961.00796 50565.2994   166%     -    9s
H    0     0                    -76374.54107 50565.2994   166%     -   10s
H    0     0                    -68882.84475 50565.2994   173%     -   10s
H    0     0                    -68265.64380 50565.2994   174%     -   10s
H    0     0                    -58815.01422 50565.2994   186%     -   10s
H    0     0                    -58743.95283 50565.2994   186%     -   10s
H    0     0                    -26948.56134 50565.2994   288%     -   10s
H    0     0                    -26092.13171 50565.2994   294%     -   10s
H    0     0                    -26023.50136 50565.2994   294%     -   10s
H    0     0                    -26014.41710 50565.2994   294%     -   10s
H    0     0                    -24635.05638 50565.2994   305%     -   12s
H    0     0                    -23317.32139 50565.2994   317%     -   12s
H    0     0                    -23192.96926 50565.2994   318%     -   12s
H    0     0                    -22648.83504 50565.2994   323%     -   12s
H    0     0                    -22418.51710 50565.2994   326%     -   12s
H    0     0                    -22415.46582 50565.2994   326%     -   12s
H    0     0                    -22295.41354 50565.2994   327%     -   12s
H    0     0                    -22258.91739 50565.2994   327%     -   12s
H    0     0                    -22197.15281 50565.2994   328%     -   12s
H    0     0                    -22185.52311 42107.5715   290%     -   62s
H    0     0                    -22068.97453 42107.5715   291%     -   62s
H    0     0                    -19058.49495 42107.5715   321%     -   62s
H    0     0                    -18909.69658 42107.5715   323%     -   62s
H    0     0                    -18892.00295 42107.5715   323%     -   62s
H    0     0                    -18888.11702 42107.5715   323%     -   62s
     0     0 42107.5715    0  550 -18888.117 42107.5715   323%     -   62s
H    0     0                    -12190.47236 42097.6909   445%     -   63s
H    0     0                    -12146.58428 42097.6909   447%     -   63s
H    0     0                    -11824.89471 42097.6909   456%     -   63s
H    0     0                    -11819.60326 42097.6909   456%     -   63s
H    0     0                    -11808.22379 42097.6909   457%     -   63s
     0     0 41530.1052    0  562 -11808.224 41530.1052   452%     -   89s
     0     0 41274.2272    0  619 -11808.224 41274.2272   450%     -  104s
     0     0 41213.2006    0  574 -11808.224 41213.2006   449%     -  110s
     0     0 41098.9800    0  633 -11808.224 41098.9800   448%     -  116s
     0     0 41093.4155    0  626 -11808.224 41093.4155   448%     -  118s
     0     0 41064.9451    0  591 -11808.224 41064.9451   448%     -  123s
     0     0 41064.9451    0  630 -11808.224 41064.9451   448%     -  132s
     0     0 41028.9724    0  633 -11808.224 41028.9724   447%     -  139s
     0     0 40999.1175    0  587 -11808.224 40999.1175   447%     -  146s
     0     0 40964.3908    0  580 -11808.224 40964.3908   447%     -  149s
     0     0 40964.0218    0  579 -11808.224 40964.0218   447%     -  150s
     0     0 36398.4087    0  452 -11808.224 36398.4087   408%     -  206s
H    0     0                    -797.9924927 36398.3153  4661%     -  206s
     0     0 35159.9645    0  528 -797.99249 35159.9645  4506%     -  265s
H    0     0                    -672.9543992 34922.8721  5289%     -  297s
H    0     0                      14.9226879 34922.8721      -     -  297s
     0     0 34922.8721    0  578   14.92269 34922.8721      -     -  297s
H    0     0                     131.5677447 34702.5204      -     -  319s
H    0     0                     368.4333178 34702.5204  9319%     -  319s
     0     0 34702.5204    0  553  368.43332 34702.5204  9319%     -  319s
     0     0 34670.2943    0  568  368.43332 34670.2943  9310%     -  335s
     0     0 34642.1476    0  571  368.43332 34642.1476  9303%     -  353s
     0     0 34601.4675    0  591  368.43332 34601.4675  9292%     -  369s
     0     0 34597.5281    0  589  368.43332 34597.5281  9290%     -  373s
     0     0 34591.2919    0  588  368.43332 34591.2919  9289%     -  381s
     0     0 34588.2321    0  587  368.43332 34588.2321  9288%     -  386s
     0     0 34579.7594    0  514  368.43332 34579.7594  9286%     -  394s
     0     0 34570.2925    0  542  368.43332 34570.2925  9283%     -  403s
     0     0 34564.8046    0  559  368.43332 34564.8046  9282%     -  411s
     0     0 34562.2700    0  551  368.43332 34562.2700  9281%     -  415s
     0     0 34562.0406    0  547  368.43332 34562.0406  9281%     -  416s
H    0     0                    2486.0010765 32204.0728  1195%     -  542s
H    0     0                    5505.2296295 32204.0728   485%     -  542s
H    0     0                    6411.3340294 32204.0728   402%     -  542s
H    0     0                    6496.1041285 32204.0728   396%     -  542s
H    0     0                    6902.3660369 32204.0728   367%     -  542s
H    0     0                    6921.8778070 32204.0728   365%     -  542s
H    0     0                    6925.0473641 32204.0728   365%     -  542s
H    0     0                    6943.5891270 32204.0728   364%     -  542s
     0     0 32204.0728    0  370 6943.58913 32204.0728   364%     -  542s
H    0     0                    6982.6354358 32203.7768   361%     -  542s
H    0     0                    7002.2292153 31707.2895   353%     -  585s
H    0     0                    7015.6814359 31707.2895   352%     -  585s
H    0     0                    7235.7693542 31707.2895   338%     -  585s
     0     0 31707.2895    0  341 7235.76935 31707.2895   338%     -  585s
H    0     0                    7256.1762212 31560.2549   335%     -  619s
H    0     0                    7261.3650960 31560.2549   335%     -  619s
H    0     0                    7395.3436080 31560.2549   327%     -  619s
H    0     0                    7399.6027070 31560.2549   327%     -  619s
H    0     0                    7413.5451427 31560.2549   326%     -  619s
H    0     0                    7430.0659990 31560.2549   325%     -  619s
H    0     0                    7441.7004282 31560.2549   324%     -  619s
     0     0 31560.2549    0  391 7441.70043 31560.2549   324%     -  619s
     0     0 31356.8461    0  380 7441.70043 31356.8461   321%     -  643s
     0     0 31280.1118    0  520 7441.70043 31280.1118   320%     -  662s
     0     0 31250.7067    0  392 7441.70043 31250.7067   320%     -  674s
H    0     0                    7529.9412373 31218.2680   315%     -  687s
H    0     0                    7555.5262198 31218.2680   313%     -  687s
H    0     0                    7567.5384658 31218.2680   313%     -  687s
H    0     0                    7621.9181731 31218.2680   310%     -  687s
H    0     0                    7638.4588030 31218.2680   309%     -  687s
     0     0 31218.2680    0  395 7638.45880 31218.2680   309%     -  687s
H    0     0                    7662.6746300 31213.7140   307%     -  695s
H    0     0                    8723.4745299 31213.7140   258%     -  695s
     0     0 31213.7140    0  506 8723.47453 31213.7140   258%     -  695s
H    0     0                    8729.9672660 31177.8644   257%     -  702s
     0     0 31177.8644    0  384 8729.96727 31177.8644   257%     -  702s
     0     0 31155.3352    0  385 8729.96727 31155.3352   257%     -  712s
     0     0 31150.8182    0  387 8729.96727 31150.8182   257%     -  716s
H    0     0                    8808.6499327 31111.0308   253%     -  729s
H    0     0                    8880.0625944 31111.0308   250%     -  729s
     0     0 31111.0308    0  423 8880.06259 31111.0308   250%     -  729s
     0     0 31090.2506    0  429 8880.06259 31090.2506   250%     -  740s
     0     0 31087.6655    0  438 8880.06259 31087.6655   250%     -  746s
     0     0 29971.6605    0  372 8880.06259 29971.6605   238%     -  844s
H    0     0                    8913.5149046 29566.0679   232%     -  883s
H    0     0                    8947.8227245 29566.0679   230%     -  883s
H    0     0                    8983.2792140 29566.0679   229%     -  883s
     0     0 29566.0679    0  385 8983.27921 29566.0679   229%     -  883s
     0     0 29428.1361    0  379 8983.27921 29428.1361   228%     -  903s
     0     0 29350.1764    0  444 8983.27921 29350.1764   227%     -  918s
     0     0 29331.2146    0  494 8983.27921 29331.2146   227%     -  933s
     0     0 29321.4035    0  492 8983.27921 29321.4035   226%     -  943s
     0     0 29312.4065    0  528 8983.27921 29312.4065   226%     -  950s
     0     0 29305.4317    0  591 8983.27921 29305.4317   226%     -  958s
     0     0 29247.3505    0  489 8983.27921 29247.3505   226%     -  976s
     0     0 29223.7716    0  445 8983.27921 29223.7716   225%     -  984s
     0     0 29219.2327    0  413 8983.27921 29219.2327   225%     -  989s
     0     0 29217.3192    0  402 8983.27921 29217.3192   225%     -  992s
     0     0 28983.4981    0  458 8983.27921 28983.4981   223%     - 1017s
H    0     0                    9902.6478565 28868.4221   192%     - 1037s
H    0     0                    10007.001582 28868.4221   188%     - 1037s
     0     0 28868.4221    0  456 10007.0016 28868.4221   188%     - 1037s
     0     0 28824.5398    0  503 10007.0016 28824.5398   188%     - 1052s
     0     0 28812.9208    0  493 10007.0016 28812.9208   188%     - 1058s
     0     0 28780.4158    0  490 10007.0016 28780.4158   188%     - 1070s
     0     0 28775.3574    0  507 10007.0016 28775.3574   188%     - 1075s
     0     0 28770.9057    0  496 10007.0016 28770.9057   188%     - 1079s
H    0     0                    10196.408904 28766.0028   182%     - 1086s
H    0     0                    10216.001432 28766.0028   182%     - 1086s
     0     0 28766.0028    0  537 10216.0014 28766.0028   182%     - 1086s
     0     0 28755.7924    0  541 10216.0014 28755.7924   181%     - 1093s
     0     0 28752.5827    0  546 10216.0014 28752.5827   181%     - 1096s
     0     0 28507.5731    0  513 10216.0014 28507.5731   179%     - 1123s
H    0     0                    10567.525578 28507.2386   170%     - 1137s
H    0     0                    10716.803114 28507.2386   166%     - 1138s
H    0     0                    11040.955140 28507.2386   158%     - 1139s
     0     0 28472.4448    0  485 11040.9551 28472.4448   158%     - 1153s
     0     0 28463.4580    0  429 11040.9551 28463.4580   158%     - 1161s
     0     0 28444.4145    0  523 11040.9551 28444.4145   158%     - 1172s
     0     0 28436.9015    0  508 11040.9551 28436.9015   158%     - 1179s
     0     0 28431.0442    0  492 11040.9551 28431.0442   158%     - 1182s
     0     0 28429.0214    0  390 11040.9551 28429.0214   157%     - 1185s
     0     0 28335.3834    0  435 11040.9551 28335.3834   157%     - 1206s
H    0     0                    11158.893251 28335.3764   154%     - 1207s
     0     0 28291.1539    0  446 11158.8933 28291.1539   154%     - 1221s
     0     0 28268.3496    0  552 11158.8933 28268.3496   153%     - 1232s
     0     0 28254.9541    0  431 11158.8933 28254.9541   153%     - 1240s
     0     0 28239.7062    0  565 11158.8933 28239.7062   153%     - 1250s
     0     0 28226.9814    0  498 11158.8933 28226.9814   153%     - 1255s
     0     0 28224.7303    0  432 11158.8933 28224.7303   153%     - 1259s
     0     0 28116.2269    0  453 11158.8933 28116.2269   152%     - 1277s
     0     0 28078.0297    0  517 11158.8933 28078.0297   152%     - 1293s
     0     0 28063.7481    0  485 11158.8933 28063.7481   151%     - 1301s
     0     0 28057.8988    0  521 11158.8933 28057.8988   151%     - 1306s
     0     0 28051.5210    0  523 11158.8933 28051.5210   151%     - 1311s
     0     0 28040.3191    0  410 11158.8933 28040.3191   151%     - 1316s
     0     0 28038.6995    0  522 11158.8933 28038.6995   151%     - 1320s
     0     0 27996.9578    0  407 11158.8933 27996.9578   151%     - 1335s
H    0     0                    11179.917657 27996.8690   150%     - 1335s
     0     0 27972.4322    0  408 11179.9177 27972.4322   150%     - 1345s
     0     0 27965.2625    0  334 11179.9177 27965.2625   150%     - 1351s
     0     0 27958.0672    0  350 11179.9177 27958.0672   150%     - 1357s
     0     0 27955.5678    0  350 11179.9177 27955.5678   150%     - 1363s
     0     0 27921.9309    0  472 11179.9177 27921.9309   150%     - 1375s
     0     0 27907.6025    0  350 11179.9177 27907.6025   150%     - 1406s
     0     0 27905.5398    0  548 11179.9177 27905.5398   150%     - 1411s
     0     0 27880.2109    0  487 11179.9177 27880.2109   149%     - 1422s
     0     0 27870.5719    0  410 11179.9177 27870.5719   149%     - 1428s
     0     0 27865.8846    0  419 11179.9177 27865.8846   149%     - 1432s
     0     0 27864.4924    0  415 11179.9177 27864.4924   149%     - 1435s
     0     0 27852.0617    0  421 11179.9177 27852.0617   149%     - 1444s
     0     0 27842.8039    0  567 11179.9177 27842.8039   149%     - 1451s
     0     0 27838.4789    0  347 11179.9177 27838.4789   149%     - 1454s
     0     0 27838.0191    0  428 11179.9177 27838.0191   149%     - 1457s
     0     0 27830.0946    0  356 11179.9177 27830.0946   149%     - 1462s
     0     0 27826.5332    0  433 11179.9177 27826.5332   149%     - 1466s
     0     0 27818.8040    0  619 11179.9177 27818.8040   149%     - 1474s
     0     0 27814.8045    0  493 11179.9177 27814.8045   149%     - 1481s
     0     0 27793.4673    0  543 11179.9177 27793.4673   149%     - 1490s
     0     0 27793.4565    0  543 11179.9177 27793.4565   149%     - 1494s
H    0     0                    11451.215499 27793.4565   143%     - 1584s
H    0     2                    11493.156529 27793.4565   142%     - 1586s
     0     2 27793.4565    0  543 11493.1565 27793.4565   142%     - 1586s
     1     3 27351.8764    1  323 11493.1565 27793.4565   142% 13050 1600s
     2     4 27509.1701    1  575 11493.1565 27509.1701   139% 14376 1617s
     3     7 27254.6767    2  365 11493.1565 27509.0308   139% 12616 1631s
     6    11 26832.6666    3  527 11493.1565 27509.0308   139% 11386 1664s
    10    20 26613.5625    4  515 11493.1565 27343.1450   138% 14785 1695s
    19    29 25698.0970    4  318 11493.1565 27343.1450   138% 21742 1780s
    28    55 25247.3711    6  494 11493.1565 26866.9844   134% 20083 1952s
    54    87 26004.2261    5  421 11493.1565 26866.9844   134% 27490 2034s
    86   166 25965.2986    6  467 11493.1565 26866.9844   134% 23732 2100s
   165   230 25909.5245    8  371 11493.1565 26866.9844   134% 16859 2143s
   229   290 25398.9251   10  315 11493.1565 26866.9844   134% 14598 2183s
   289   340 24613.4681   10  314 11493.1565 26866.9844   134% 13200 2222s
   339   372 24003.2134   11  301 11493.1565 26866.9844   134% 12716 2254s
H  350   372                    11556.755787 26866.9844   132% 12590 2254s
   371   437 25632.1417    9  334 11556.7558 26866.9844   132% 12520 2293s
   440   464 25349.4052   11  318 11556.7558 26866.9844   132% 12599 2323s
H  445   464                    11709.744794 26866.9844   129% 12555 2323s
H  448   464                    11735.041287 26866.9844   129% 12554 2323s
H  451   464                    11752.208449 26866.9844   129% 12584 2323s
   467   521 25511.2799   10  312 11752.2084 26866.9844   129% 12615 2356s
   528   576 23813.0660   12  304 11752.2084 26866.9844   129% 12490 2387s
   592   607 23671.3315   12  282 11752.2084 26866.9844   129% 12322 2419s
   647   648 13885.3355   33  282 11752.2084 26866.9844   129% 12222 2450s
   696   686 22364.4496   13  303 11752.2084 26866.9844   129% 12160 2484s
   756   716 24568.3396   11  315 11752.2084 26866.9844   129% 12155 2510s
H  761   716                    11866.714669 26866.9844   126% 12197 2510s
   792   761 24297.3582   12  311 11866.7147 26866.9844   126% 12317 2544s
   859   820 24211.5697   13  296 11866.7147 26866.9844   126% 12208 2576s
   928   878 14600.6568   14  235 11866.7147 26866.9844   126% 12175 2606s
  1008   960 14003.5235   15  229 11866.7147 26866.9844   126% 11889 2635s
  1116  1052 infeasible   16      11866.7147 26866.9844   126% 11351 2667s
  1248  1099 13629.2894   19  178 11866.7147 26866.9844   126% 10936 2702s
  1373  1129 12495.3071   22  167 11866.7147 26613.4973   124% 10503 2737s
H 1463  1129                    11867.725385 26613.4973   124% 10220 2738s
  1495  1186 12351.5097   23  175 11867.7254 26613.4973   124% 10116 2775s
  1614  1292 infeasible   25      11867.7254 26613.4973   124%  9842 2814s
  1770  1323 12675.2914   28  130 11867.7254 26613.4973   124%  9468 2853s
  1931  1361 infeasible   33      11867.7254 26613.2621   124%  9167 2895s
  2027  1413 24856.7353    7  390 11867.7254 26613.2621   124%  9149 2939s
  2109  1473 23374.5425    8  309 11867.7254 26613.2621   124%  9206 2985s
  2203  1525 15006.8270    9  213 11867.7254 26613.2621   124%  9227 3026s
H 2226  1525                    11868.594755 26613.2621   124%  9231 3026s
  2265  1614 14937.7671   10  214 11868.5948 26613.2621   124%  9264 3072s
  2402  1674 13511.6708   14  205 11868.5948 26613.2621   124%  9215 3122s
  2522  1778 infeasible   16      11868.5948 26613.2621   124%  9293 3172s
  2678  1889 23219.7404   10  366 11868.5948 26613.2621   124%  9246 3227s
  2851  2027 22677.9674   11  369 11868.5948 26613.2621   124%  9181 3282s
  3011  2136 21164.2190   13  404 11868.5948 26613.2621   124%  9187 3342s
  3192  2203 20736.8039   15  273 11868.5948 26613.2621   124%  9110 3400s
H 3217  2203                    11978.860652 26613.2621   122%  9075 3400s
  3309  2271 19729.4393   16  270 11978.8607 26613.2621   122%  9103 3461s
  3451  2349 19320.3419   20  261 11978.8607 26421.4130   121%  9150 3524s
  3619  2391 18555.1670   26  253 11978.8607 26421.3422   121%  9130 3595s
  3733  2386     cutoff   52      11978.8607 26421.3422   121%  9231 3600s

Cutting planes:
  Learned: 3
  Gomory: 11
  Implied bound: 454
  MIR: 4610
  Flow cover: 3549
  RLT: 204
  Relax-and-lift: 1688

Explored 3740 nodes (35565253 simplex iterations) in 3600.05 seconds (8820.85 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 11978.9 11868.6 11867.7 ... 11451.2

Time limit reached
Best objective 1.197886065214e+04, best bound 2.642134215939e+04, gap 120.5664%
  WARNING: Time limit reached. Using best solution found (gap: 120.57%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 11978.86, θ = 160677.71
  Upper Bound (UB) = 11978.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160677.71
  [DEBUG]   ✓ Scenario 0: θ = 160677.71 ≤ Q = 160677.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160677.71 ≤ Q = 160677.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160677.71 ≤ Q = 160677.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160677.71 ≤ Q = 160677.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160677.71 ≤ Q = 160677.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160677.71 ≤ Q = 160677.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160677.71 ≤ Q = 160677.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160677.71 ≤ Q = 160677.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160677.71 ≤ Q = 160677.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160677.71 ≤ Q = 160677.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 160677.71 ≤ Q = 160677.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 160677.71 ≤ Q = 160677.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x658b249e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x658b249e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.305532e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6713888.1528
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.566888e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156688.80    0  132 6713888.15 -156688.80   102%     -    0s
H    0     0                    -120601.7543 -156688.80  29.9%     -    0s
H    0     0                    -120769.6557 -156688.80  29.7%     -    0s
     0     0 -133817.05    0   62 -120769.66 -133817.05  10.8%     -    0s
H    0     0                    -131494.8820 -133691.81  1.67%     -    0s
H    0     0                    -131801.5502 -133691.81  1.43%     -    0s
     0     0 -133691.81    0   44 -131801.55 -133691.81  1.43%     -    0s
     0     0 -133691.81    0   52 -131801.55 -133691.81  1.43%     -    0s
H    0     0                    -132196.2466 -133691.81  1.13%     -    0s
H    0     0                    -132502.9148 -133691.81  0.90%     -    0s
     0     0 -133112.13    0   39 -132502.91 -133112.13  0.46%     -    0s
     0     0 -133109.70    0   38 -132502.91 -133109.70  0.46%     -    0s
H    0     0                    -132532.8729 -133109.70  0.44%     -    0s
     0     0 -132856.81    0   20 -132532.87 -132856.81  0.24%     -    0s
     0     0 -132855.60    0   18 -132532.87 -132855.60  0.24%     -    0s
     0     0 -132771.42    0   26 -132532.87 -132771.42  0.18%     -    0s
     0     0 -132768.62    0   19 -132532.87 -132768.62  0.18%     -    0s
     0     0 -132757.12    0   23 -132532.87 -132757.12  0.17%     -    0s
     0     0 -132754.23    0   21 -132532.87 -132754.23  0.17%     -    0s
     0     0 -132689.41    0   12 -132532.87 -132689.41  0.12%     -    0s
     0     0 -132689.41    0   21 -132532.87 -132689.41  0.12%     -    0s
     0     0 -132689.41    0   21 -132532.87 -132689.41  0.12%     -    0s
H    0     0                    -132545.8614 -132689.41  0.11%     -    0s
     0     0 -132684.70    0    8 -132545.86 -132684.70  0.10%     -    0s
H    0     0                    -132635.3611 -132644.32  0.01%     -    0s
     0     0 -132644.32    0    9 -132635.36 -132644.32  0.01%     -    0s
     0     0 -132644.32    0    3 -132635.36 -132644.32  0.01%     -    0s
     0     0 -132644.32    0    2 -132635.36 -132644.32  0.01%     -    0s
     0     0     cutoff    0      -132635.36 -132635.36  0.00%     -    0s

Cutting planes:
  Gomory: 7
  Implied bound: 3
  MIR: 7
  Flow cover: 7
  RLT: 2
  Relax-and-lift: 4

Explored 1 nodes (732 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -132635 -132546 -132533 ... 1.30553e+13
No other solutions better than -132635

Optimal solution found (tolerance 1.00e-06)
Best objective -1.326353610527e+05, best bound -1.326353610527e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 149770.26
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132635.36
  [DEBUG]   S×d_nominal = 282405.62
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282405.62 + -132635.36 = 149770.26
  [DEBUG]   Current θ from Master = 160677.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10907.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1071.41
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2637.0731, Absolute Gap = 2637.0731, Relative Gap = 0.220144
  Not converged yet (gap = 2637.07 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 22 increases, 38 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567795 nonzeros
Model fingerprint: 0x3a86a5d8
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82719 rows and 33579 columns
Presolve time: 1.71s
Presolved: 117434 rows, 49801 columns, 705036 nonzeros
Variable types: 47542 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -356294.3897
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.26s

Barrier statistics:
 Dense cols : 662
 AA' NZ     : 4.196e+06
 Factor NZ  : 1.144e+07 (roughly 160 MB of memory)
 Factor Ops : 4.121e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73416052e+07  2.20535206e+08  1.12e+05 1.84e+01  8.60e+04     3s
   1  -1.31994370e+07  1.96425586e+08  7.72e+04 7.00e+01  5.87e+04     3s
   2  -4.45808993e+06  1.49749426e+08  2.60e+04 1.17e+00  2.09e+04     3s
   3  -9.64920229e+05  1.08924381e+08  3.02e+03 1.50e+00  2.80e+03     3s
   4  -5.01742876e+05  7.94884131e+07  5.75e+02 9.32e-01  7.86e+02     3s
   5  -4.15665008e+05  3.82191368e+07  2.79e+02 3.33e-01  3.55e+02     3s
   6  -3.13705395e+05  2.78504530e+07  7.01e+01 2.24e-01  1.72e+02     3s
   7  -2.30694278e+05  1.93471019e+07  1.88e+01 1.47e-01  1.00e+02     3s
   8  -1.91483443e+05  1.56138649e+07  9.80e+00 1.17e-01  7.76e+01     3s
   9  -1.01453768e+05  7.16325736e+06  3.01e+00 5.00e-02  3.45e+01     4s
  10  -5.65520575e+04  3.04882270e+06  1.28e+00 1.99e-02  1.46e+01     4s
  11  -3.28014238e+04  1.75994662e+06  7.52e-01 1.14e-02  8.39e+00     4s
  12  -1.21368893e+04  9.24614160e+05  4.22e-01 5.78e-03  4.38e+00     4s
  13  -2.50813770e+03  5.04312192e+05  2.69e-01 3.12e-03  2.36e+00     4s
  14   7.79723219e+03  2.93232306e+05  1.60e-01 1.84e-03  1.33e+00     4s
  15   1.65329890e+04  2.09960400e+05  1.03e-01 2.64e-03  9.01e-01     4s
  16   2.27728744e+04  1.48918268e+05  7.48e-02 1.21e-03  5.88e-01     4s
  17   2.82220493e+04  1.22295652e+05  5.39e-02 1.91e-03  4.38e-01     4s
  18   3.16409047e+04  1.04944460e+05  4.23e-02 1.78e-03  3.41e-01     4s
  19   3.48769046e+04  8.39690742e+04  3.32e-02 2.09e-03  2.29e-01     4s
  20   3.81688794e+04  7.60420805e+04  2.52e-02 1.63e-03  1.76e-01     4s
  21   4.03909793e+04  6.96710727e+04  1.99e-02 1.24e-03  1.36e-01     4s
  22   4.29015502e+04  6.59014958e+04  1.43e-02 1.00e-03  1.07e-01     4s
  23   4.41785259e+04  6.29041801e+04  1.16e-02 8.24e-04  8.72e-02     4s
  24   4.54876387e+04  5.92380862e+04  8.95e-03 5.47e-04  6.41e-02     4s
  25   4.58934370e+04  5.81185021e+04  8.17e-03 4.90e-04  5.69e-02     4s
  26   4.63873959e+04  5.63029995e+04  7.26e-03 4.24e-04  4.62e-02     4s
  27   4.72856136e+04  5.47929987e+04  5.61e-03 3.07e-04  3.50e-02     5s
  28   4.78106661e+04  5.44486731e+04  4.69e-03 2.84e-04  3.09e-02     5s
  29   4.84027970e+04  5.33495449e+04  3.67e-03 2.12e-04  2.30e-02     5s
  30   4.89345930e+04  5.28088640e+04  2.72e-03 1.75e-04  1.80e-02     5s
  31   4.94968891e+04  5.20541051e+04  1.82e-03 1.01e-04  1.19e-02     5s
  32   4.97503296e+04  5.17700214e+04  1.44e-03 7.83e-05  9.41e-03     5s
  33   4.99325576e+04  5.16080134e+04  1.17e-03 6.25e-05  7.80e-03     5s
  34   5.00085635e+04  5.15249036e+04  1.06e-03 5.64e-05  7.06e-03     5s
  35   5.01492420e+04  5.14945513e+04  8.57e-04 5.41e-05  6.27e-03     5s
  36   5.01833058e+04  5.13085448e+04  8.02e-04 4.09e-05  5.24e-03     5s
  37   5.03039807e+04  5.12011072e+04  6.21e-04 3.30e-05  4.18e-03     5s
  38   5.03479584e+04  5.11534901e+04  5.56e-04 2.96e-05  3.75e-03     5s
  39   5.04220414e+04  5.10657027e+04  4.46e-04 2.42e-05  3.00e-03     5s
  40   5.05273312e+04  5.09413406e+04  2.91e-04 1.48e-05  1.93e-03     5s
  41   5.06099254e+04  5.08804743e+04  1.77e-04 3.34e-05  1.26e-03     5s
  42   5.06455992e+04  5.08464453e+04  1.29e-04 2.41e-05  9.36e-04     6s
  43   5.06722515e+04  5.08359765e+04  9.33e-05 2.15e-05  7.63e-04     6s
  44   5.06899145e+04  5.07958866e+04  7.16e-05 1.17e-05  4.94e-04     6s
  45   5.06945350e+04  5.07907821e+04  6.57e-05 1.13e-05  4.48e-04     6s
  46   5.07141927e+04  5.07795803e+04  4.18e-05 8.94e-06  3.05e-04     6s
  47   5.07300673e+04  5.07578399e+04  2.11e-05 3.81e-06  1.29e-04     6s
  48   5.07471481e+04  5.07495033e+04  1.54e-06 2.69e-06  1.10e-05     6s
  49   5.07488334e+04  5.07489651e+04  9.51e-08 4.08e-08  6.14e-07     6s
  50   5.07489531e+04  5.07489536e+04  8.29e-09 5.73e-09  2.38e-09     6s
  51   5.07489534e+04  5.07489534e+04  4.98e-10 1.53e-11  5.62e-12     6s

Barrier solved model in 51 iterations and 6.12 seconds (11.17 work units)
Optimal objective 5.07489534e+04


Root crossover log...

   95612 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    2405 PPushes remaining with PInf 1.3157620e-06                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.1340434e-11      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34829    5.0748953e+04   0.000000e+00   0.000000e+00      8s
   34829    5.0748953e+04   0.000000e+00   0.000000e+00      8s
Concurrent spin time: 0.43s

Solved with barrier

Root relaxation: objective 5.074895e+04, 34829 iterations, 6.52 seconds (13.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 50748.9534    0  415 -219144.29 50748.9534   123%     -    9s
H    0     0                    -152102.0543 50748.9534   133%     -    9s
H    0     0                    -118904.7530 50748.9534   143%     -    9s
H    0     0                    -109940.1666 50748.9534   146%     -    9s
H    0     0                    -109728.8961 50748.9534   146%     -   10s
H    0     0                    -107830.3325 50748.9534   147%     -   10s
H    0     0                    -68362.25522 50748.9534   174%     -   10s
H    0     0                    -67775.78833 50748.9534   175%     -   10s
H    0     0                    -24847.95519 50748.9534   304%     -   10s
H    0     0                    -24518.22868 50748.9534   307%     -   10s
H    0     0                    -19818.98814 50748.9534   356%     -   12s
H    0     0                    -18519.17574 50748.9534   374%     -   12s
H    0     0                    -17089.14770 50748.9534   397%     -   12s
H    0     0                    -15523.78019 50748.9534   427%     -   12s
H    0     0                    -15488.88890 50748.9534   428%     -   12s
H    0     0                    -15283.93035 50748.9534   432%     -   12s
H    0     0                    -15083.53669 50748.9534   436%     -   12s
H    0     0                    -15020.73755 50748.9534   438%     -   12s
H    0     0                    -14869.70147 50748.9534   441%     -   12s
H    0     0                    -14563.36903 50748.9534   448%     -   12s
H    0     0                    -14415.96958 42541.6928   395%     -   63s
H    0     0                    -14324.25279 42541.6928   397%     -   63s
H    0     0                    -14319.64642 42541.6928   397%     -   63s
H    0     0                    -14255.34916 42541.6928   398%     -   63s
H    0     0                    -14227.25299 42541.6928   399%     -   63s
     0     0 42052.3115    0  601 -14227.253 42052.3115   396%     -   63s
H    0     0                    -11673.82919 42052.3115   460%     -   64s
H    0     0                    -10776.26965 42052.3115   490%     -   64s
H    0     0                    -10443.73940 42052.3115   503%     -   64s
H    0     0                    -10373.93060 42052.3115   505%     -   64s
     0     0 41751.6694    0  622 -10373.931 41751.6694   502%     -   89s
     0     0 41599.6785    0  614 -10373.931 41599.6785   501%     -   98s
     0     0 41558.3235    0  610 -10373.931 41558.3235   501%     -  107s
     0     0 41553.5088    0  610 -10373.931 41553.5088   501%     -  109s
     0     0 41538.7902    0  610 -10373.931 41538.7902   500%     -  113s
     0     0 41532.9140    0  616 -10373.931 41532.9140   500%     -  118s
     0     0 41521.9227    0  619 -10373.931 41521.9227   500%     -  120s
     0     0 41501.0490    0  608 -10373.931 41501.0490   500%     -  125s
     0     0 41500.8225    0  608 -10373.931 41500.8225   500%     -  126s
H    0     0                    -9193.513587 37497.6018   508%     -  194s
H    0     0                    -8876.454953 37497.6018   522%     -  194s
H    0     0                    -7335.842784 37497.6018   611%     -  194s
H    0     0                    -7066.773526 37497.6018   631%     -  194s
H    0     0                    -6494.971691 37497.6018   677%     -  194s
H    0     0                    -6413.131631 37497.6018   685%     -  194s
H    0     0                    -6411.502369 37497.6018   685%     -  194s
H    0     0                    -6317.314670 37497.6018   694%     -  194s
H    0     0                    -5721.405284 37497.6018   755%     -  194s
H    0     0                    -5542.717979 37497.6018   777%     -  194s
     0     0 37497.6018    0  426 -5542.7180 37497.6018   777%     -  194s
H    0     0                    5599.8273649 37491.5490   570%     -  195s
H    0     0                    5730.7556870 37491.5490   554%     -  195s
H    0     0                    5770.5780872 37491.5490   550%     -  195s
H    0     0                    5787.4928717 37491.5490   548%     -  195s
H    0     0                    5840.4848555 37491.5490   542%     -  195s
     0     0 36280.8442    0  531 5840.48486 36280.8442   521%     -  263s
H    0     0                    6386.0466046 35966.8249   463%     -  300s
H    0     0                    6397.4260813 35966.8249   462%     -  300s
     0     0 35966.8249    0  520 6397.42608 35966.8249   462%     -  300s
H    0     0                    6404.7392425 35902.9161   461%     -  324s
H    0     0                    7095.1472400 35902.9161   406%     -  324s
H    0     0                    7135.5148966 35902.9161   403%     -  324s
H    0     0                    7372.6514342 35902.9161   387%     -  324s
H    0     0                    7383.8198421 35902.9161   386%     -  324s
H    0     0                    7395.0416444 35902.9161   385%     -  324s
     0     0 35902.9161    0  512 7395.04164 35902.9161   385%     -  324s
     0     0 35838.2945    0  528 7395.04164 35838.2945   385%     -  345s
H    0     0                    8264.0316295 35510.1370   330%     -  390s
H    0     0                    9712.6835054 35510.1370   266%     -  390s
     0     0 35510.1370    0  557 9712.68351 35510.1370   266%     -  390s
     0     0 35445.0005    0  577 9712.68351 35445.0005   265%     -  410s
     0     0 35273.1902    0  517 9712.68351 35273.1902   263%     -  432s
H    0     0                    11263.181178 35245.4040   213%     -  449s
H    0     0                    11399.312547 35245.4040   209%     -  449s
H    0     0                    11488.809437 35245.4040   207%     -  449s
H    0     0                    11815.032954 35245.4040   198%     -  449s
     0     0 35245.4040    0  545 11815.0330 35245.4040   198%     -  450s
     0     0 35236.0717    0  503 11815.0330 35236.0717   198%     -  457s
     0     0 35230.4470    0  504 11815.0330 35230.4470   198%     -  463s
     0     0 35225.9008    0  552 11815.0330 35225.9008   198%     -  469s
     0     0 35222.3523    0  563 11815.0330 35222.3523   198%     -  473s
     0     0 35215.5659    0  571 11815.0330 35215.5659   198%     -  476s
     0     0 35215.3609    0  567 11815.0330 35215.3609   198%     -  476s
     0     0 32214.9413    0  445 11815.0330 32214.9413   173%     -  616s
     0     0 31777.0876    0  519 11815.0330 31777.0876   169%     -  683s
     0     0 31654.6461    0  523 11815.0330 31654.6461   168%     -  730s
     0     0 31615.0655    0  537 11815.0330 31615.0655   168%     -  755s
     0     0 31566.9049    0  516 11815.0330 31566.9049   167%     -  776s
     0     0 31465.2194    0  526 11815.0330 31465.2194   166%     -  806s
     0     0 31403.3234    0  541 11815.0330 31403.3234   166%     -  830s
     0     0 31391.5981    0  533 11815.0330 31391.5981   166%     -  844s
     0     0 31378.2973    0  600 11815.0330 31378.2973   166%     -  861s
     0     0 31322.9230    0  540 11815.0330 31322.9230   165%     -  887s
     0     0 31273.5215    0  594 11815.0330 31273.5215   165%     -  911s
     0     0 31266.7740    0  579 11815.0330 31266.7740   165%     -  920s
     0     0 31260.1988    0  586 11815.0330 31260.1988   165%     -  929s
     0     0 31239.7739    0  594 11815.0330 31239.7739   164%     -  943s
     0     0 31229.4928    0  470 11815.0330 31229.4928   164%     -  953s
     0     0 31220.6520    0  582 11815.0330 31220.6520   164%     -  962s
     0     0 31214.7934    0  598 11815.0330 31214.7934   164%     -  967s
     0     0 31211.3544    0  594 11815.0330 31211.3544   164%     -  972s
     0     0 31210.2405    0  577 11815.0330 31210.2405   164%     -  975s
H    0     0                    11834.625482 29535.7300   150%     - 1110s
     0     0 29535.7300    0  493 11834.6255 29535.7300   150%     - 1110s
     0     0 29291.2331    0  540 11834.6255 29291.2331   148%     - 1161s
     0     0 29213.1710    0  540 11834.6255 29213.1710   147%     - 1194s
     0     0 29183.8069    0  544 11834.6255 29183.8069   147%     - 1214s
     0     0 29139.7596    0  550 11834.6255 29139.7596   146%     - 1230s
     0     0 29118.2257    0  515 11834.6255 29118.2257   146%     - 1245s
     0     0 29109.7642    0  574 11834.6255 29109.7642   146%     - 1258s
     0     0 29106.7260    0  518 11834.6255 29106.7260   146%     - 1268s
     0     0 28826.4201    0  421 11834.6255 28826.4201   144%     - 1317s
H    0     0                    11871.365446 28703.7299   142%     - 1354s
     0     0 28703.7299    0  382 11871.3654 28703.7299   142%     - 1354s
     0     0 28644.5492    0  478 11871.3654 28644.5492   141%     - 1393s
     0     0 28611.6744    0  391 11871.3654 28611.6744   141%     - 1415s
     0     0 28586.4962    0  398 11871.3654 28586.4962   141%     - 1433s
     0     0 28574.3484    0  387 11871.3654 28574.3484   141%     - 1448s
     0     0 28567.8187    0  460 11871.3654 28567.8187   141%     - 1463s
     0     0 28562.8761    0  536 11871.3654 28562.8761   141%     - 1476s
     0     0 28548.7372    0  459 11871.3654 28548.7372   140%     - 1493s
     0     0 28547.0151    0  513 11871.3654 28547.0151   140%     - 1501s
H    0     0                    11874.701917 28329.7292   139%     - 1538s
     0     0 28329.7292    0  531 11874.7019 28329.7292   139%     - 1538s
     0     0 28252.1920    0  514 11874.7019 28252.1920   138%     - 1573s
     0     0 28209.2961    0  526 11874.7019 28209.2961   138%     - 1600s
     0     0 28174.8551    0  539 11874.7019 28174.8551   137%     - 1630s
     0     0 28167.8598    0  561 11874.7019 28167.8598   137%     - 1638s
     0     0 28164.3296    0  575 11874.7019 28164.3296   137%     - 1647s
     0     0 28029.9558    0  429 11874.7019 28029.9558   136%     - 1681s
     0     0 27993.5158    0  412 11874.7019 27993.5158   136%     - 1700s
     0     0 27977.4344    0  416 11874.7019 27977.4344   136%     - 1710s
     0     0 27969.6935    0  411 11874.7019 27969.6935   136%     - 1717s
     0     0 27964.8464    0  412 11874.7019 27964.8464   135%     - 1726s
     0     0 27959.7084    0  424 11874.7019 27959.7084   135%     - 1735s
     0     0 27957.1319    0  417 11874.7019 27957.1319   135%     - 1740s
     0     0 27887.8379    0  501 11874.7019 27887.8379   135%     - 1765s
     0     0 27838.3414    0  504 11874.7019 27838.3414   134%     - 1787s
     0     0 27829.8734    0  508 11874.7019 27829.8734   134%     - 1794s
     0     0 27812.6156    0  504 11874.7019 27812.6156   134%     - 1806s
     0     0 27807.9460    0  516 11874.7019 27807.9460   134%     - 1812s
     0     0 27805.6472    0  560 11874.7019 27805.6472   134%     - 1816s
     0     0 27760.5971    0  531 11874.7019 27760.5971   134%     - 1839s
     0     0 27752.4629    0  383 11874.7019 27752.4629   134%     - 1849s
     0     0 27744.4043    0  435 11874.7019 27744.4043   134%     - 1856s
     0     0 27741.3504    0  507 11874.7019 27741.3504   134%     - 1862s
     0     0 27715.7369    0  544 11874.7019 27715.7369   133%     - 1883s
     0     0 27702.8685    0  478 11874.7019 27702.8685   133%     - 1894s
     0     0 27698.5403    0  433 11874.7019 27698.5403   133%     - 1899s
     0     0 27662.6464    0  573 11874.7019 27662.6464   133%     - 1922s
H    0     0                    11904.283463 27662.5300   132%     - 1923s
     0     0 27641.5176    0  573 11904.2835 27641.5176   132%     - 1951s
     0     0 27638.1091    0  490 11904.2835 27638.1091   132%     - 1957s
     0     0 27612.6268    0  497 11904.2835 27612.6268   132%     - 1983s
H    0     0                    11910.115263 27612.3526   132%     - 2052s
H    0     0                    11925.665721 27612.3526   132%     - 2086s
     0     0 27601.0933    0  497 11925.6657 27601.0933   131%     - 2170s
     0     0 27594.7378    0  603 11925.6657 27594.7378   131%     - 2178s
     0     0 27588.8908    0  464 11925.6657 27588.8908   131%     - 2183s
     0     0 27587.2876    0  565 11925.6657 27587.2876   131%     - 2187s
     0     0 27576.9804    0  610 11925.6657 27576.9804   131%     - 2199s
     0     0 27571.2880    0  520 11925.6657 27571.2880   131%     - 2208s
     0     0 27568.0387    0  613 11925.6657 27568.0387   131%     - 2216s
     0     0 27561.8485    0  431 11925.6657 27561.8485   131%     - 2223s
     0     0 27555.5885    0  604 11925.6657 27555.5885   131%     - 2228s
     0     0 27552.8169    0  612 11925.6657 27552.8169   131%     - 2233s
     0     0 27539.6389    0  586 11925.6657 27539.6389   131%     - 2243s
     0     0 27539.5747    0  586 11925.6657 27539.5747   131%     - 2247s
     0     2 27539.5747    0  586 11925.6657 27539.5747   131%     - 2376s
     1     3 27049.8165    1  407 11925.6657 27539.5747   131% 17935 2396s
     2     4 27231.6509    1  535 11925.6657 27231.6509   128% 17232 2416s
     3     5 26610.6337    2  468 11925.6657 27231.0297   128% 19126 2445s
     4     9 26984.8340    2  567 11925.6657 27230.7705   128% 16596 2475s
     8    17 26930.9254    3  554 11925.6657 26984.7842   126% 15389 2520s
    16    33 26661.6061    4  562 11925.6657 26984.7842   126% 20336 2585s
    32    47 25613.6962    5  473 11925.6657 26873.0218   125% 27659 3600s

Cutting planes:
  Learned: 2
  Gomory: 19
  Implied bound: 398
  MIR: 4222
  Flow cover: 2976
  RLT: 213
  Relax-and-lift: 1493
  BQP: 1

Explored 46 nodes (2457127 simplex iterations) in 3600.11 seconds (6846.67 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 11925.7 11910.1 11904.3 ... 11263.2

Time limit reached
Best objective 1.192566572062e+04, best bound 2.687302177515e+04, gap 125.3377%
  WARNING: Time limit reached. Using best solution found (gap: 125.34%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 11925.67, θ = 160359.81
  Upper Bound (UB) = 11925.67

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160359.81
  [DEBUG]   ✓ Scenario 0: θ = 160359.81 ≤ Q = 160359.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160359.81 ≤ Q = 160359.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160359.81 ≤ Q = 160359.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160359.81 ≤ Q = 160359.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160359.81 ≤ Q = 160359.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160359.81 ≤ Q = 160359.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160359.81 ≤ Q = 160359.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160359.81 ≤ Q = 160359.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160359.81 ≤ Q = 160359.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160359.81 ≤ Q = 160359.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 160359.81 ≤ Q = 160359.81 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 160359.81 ≤ Q = 160359.81 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 160359.81 ≤ Q = 160359.81 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4ac63a43
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4ac63a43
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.309285e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6723511.6911
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.542299e+05, 252 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154229.93    0  124 6723511.69 -154229.93   102%     -    0s
H    0     0                    -118447.0962 -154229.93  30.2%     -    0s
H    0     0                    -118828.0977 -154229.93  29.8%     -    0s
     0     0 -128224.28    0   51 -118828.10 -128224.28  7.91%     -    0s
H    0     0                    -125891.4303 -128129.68  1.78%     -    0s
H    0     0                    -126198.0985 -128129.68  1.53%     -    0s
H    0     0                    -126721.0248 -128129.68  1.11%     -    0s
H    0     0                    -127027.6930 -128129.68  0.87%     -    0s
     0     0 -127558.58    0   60 -127027.69 -127558.58  0.42%     -    0s
     0     0 -127538.67    0   56 -127027.69 -127538.67  0.40%     -    0s
H    0     0                    -127073.9603 -127538.67  0.37%     -    0s
     0     0 -127448.04    0   32 -127073.96 -127448.04  0.29%     -    0s
     0     0 -127448.04    0   32 -127073.96 -127448.04  0.29%     -    0s
     0     0 -127423.41    0   30 -127073.96 -127423.41  0.28%     -    0s
     0     0 -127423.11    0   30 -127073.96 -127423.11  0.27%     -    0s
H    0     0                    -127091.1790 -127423.11  0.26%     -    0s
     0     0 -127423.11    0   66 -127091.18 -127423.11  0.26%     -    0s
     0     0 -127423.11    0   29 -127091.18 -127423.11  0.26%     -    0s
     0     0 -127423.11    0   29 -127091.18 -127423.11  0.26%     -    0s
     0     0 -127389.92    0   25 -127091.18 -127389.92  0.24%     -    0s
     0     0 -127379.15    0   27 -127091.18 -127379.15  0.23%     -    0s
     0     0 -127374.12    0   27 -127091.18 -127374.12  0.22%     -    0s
H    0     0                    -127092.0374 -127374.12  0.22%     -    0s
     0     0 -127367.26    0   27 -127092.04 -127367.26  0.22%     -    0s
H    0     0                    -127248.5941 -127367.26  0.09%     -    0s
     0     0 -127362.00    0   27 -127248.59 -127362.00  0.09%     -    0s
     0     0 -127362.00    0   35 -127248.59 -127362.00  0.09%     -    0s
     0     0 -127362.00    0   29 -127248.59 -127362.00  0.09%     -    0s
     0     0 -127345.99    0   26 -127248.59 -127345.99  0.08%     -    0s
     0     0 -127345.94    0   26 -127248.59 -127345.94  0.08%     -    0s
     0     0 -127298.96    0   23 -127248.59 -127298.96  0.04%     -    0s
     0     0 -127248.59    0   23 -127248.59 -127248.59  0.00%     -    0s

Cutting planes:
  Gomory: 29
  Implied bound: 4
  MIR: 36
  Flow cover: 4
  RLT: 7

Explored 1 nodes (1054 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -127249 -127249 -127092 ... 6.72351e+06
No other solutions better than -127249

Optimal solution found (tolerance 1.00e-06)
Best objective -1.272485940834e+05, best bound -1.272485940834e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 154740.21
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -127248.59
  [DEBUG]   S×d_nominal = 281988.80
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 281988.80 + -127248.59 = 154740.21
  [DEBUG]   Current θ from Master = 160359.81
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5619.60 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6306.07
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2583.8782, Absolute Gap = 2583.8782, Relative Gap = 0.216665
  Not converged yet (gap = 2583.88 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 611047 nonzeros
Model fingerprint: 0x3629880b
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89082 rows and 36162 columns
Presolve time: 1.97s
Presolved: 126361 rows, 53458 columns, 776185 nonzeros
Variable types: 51199 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.13s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 5.305e+06
 Factor NZ  : 1.197e+07 (roughly 170 MB of memory)
 Factor Ops : 2.502e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.81661694e+07  2.33725740e+08  1.19e+05 1.76e+01  8.96e+04     4s
   1  -1.39074436e+07  2.08677646e+08  8.43e+04 6.89e+01  6.31e+04     4s
   2  -4.87644752e+06  1.63665136e+08  2.89e+04 7.11e-01  2.30e+04     4s
   3  -1.18111229e+06  1.26359009e+08  2.96e+03 9.69e-01  2.76e+03     4s
   4  -7.23019379e+05  6.82259612e+07  5.57e+02 4.33e-01  6.81e+02     4s
   5  -5.05178129e+05  3.82969558e+07  3.04e+02 1.99e-01  3.58e+02     5s
   6  -3.58470447e+05  2.39998843e+07  5.33e+01 1.06e-01  1.35e+02     5s
   7  -2.51332860e+05  1.78386075e+07  1.91e+01 7.53e-02  8.76e+01     5s
   8  -1.69054470e+05  1.10819195e+07  8.43e+00 4.45e-02  5.16e+01     5s
   9  -1.38523992e+05  7.49533680e+06  5.66e+00 2.94e-02  3.45e+01     5s
  10  -1.11337762e+05  3.98689238e+06  2.45e+00 1.52e-02  1.81e+01     5s
  11  -8.35404770e+04  1.91696452e+06  1.15e+00 7.15e-03  8.75e+00     5s
  12  -7.04360586e+04  1.86557951e+06  8.79e-01 6.96e-03  8.45e+00     5s
  13  -4.61835905e+04  8.16764369e+05  3.33e-01 2.88e-03  3.75e+00     5s
  14  -3.11719195e+04  3.14120712e+05  1.90e-01 1.24e-03  1.50e+00     5s
  15  -8.64443957e+03  1.98623294e+05  1.06e-01 1.28e-03  8.99e-01     5s
  16  -1.20801734e+03  1.40250405e+05  8.80e-02 1.20e-03  6.14e-01     5s
  17   3.30307102e+03  1.30602303e+05  7.83e-02 9.89e-04  5.52e-01     5s
  18   1.18270066e+04  1.06720647e+05  5.93e-02 2.08e-03  4.12e-01     5s
  19   1.76083571e+04  8.32832578e+04  4.74e-02 2.18e-03  2.85e-01     5s
  20   2.01117030e+04  7.85741499e+04  4.24e-02 1.92e-03  2.54e-01     5s
  21   2.28068208e+04  6.97944188e+04  3.71e-02 1.26e-03  2.04e-01     5s
  22   2.56592263e+04  6.54070013e+04  3.17e-02 1.05e-03  1.72e-01     5s
  23   2.93557148e+04  6.18234149e+04  2.47e-02 8.63e-04  1.41e-01     5s
  24   3.18288665e+04  5.86110605e+04  2.03e-02 7.09e-04  1.16e-01     6s
  25   3.41892427e+04  5.47173905e+04  1.62e-02 5.24e-04  8.91e-02     6s
  26   3.47585704e+04  5.27851305e+04  1.53e-02 4.42e-04  7.82e-02     6s
  27   3.66412139e+04  5.09200916e+04  1.22e-02 3.62e-04  6.20e-02     6s
  28   3.86701192e+04  4.99977418e+04  9.03e-03 3.06e-04  4.92e-02     6s
  29   3.99409351e+04  4.88970304e+04  7.04e-03 2.40e-04  3.89e-02     6s
  30   4.12048953e+04  4.78171139e+04  5.15e-03 1.77e-04  2.87e-02     6s
  31   4.26072119e+04  4.71927577e+04  3.10e-03 1.37e-04  1.99e-02     6s
  32   4.29505903e+04  4.62289477e+04  2.64e-03 2.01e-04  1.42e-02     6s
  33   4.34857706e+04  4.59768772e+04  1.92e-03 1.57e-04  1.08e-02     6s
  34   4.35693102e+04  4.56345737e+04  1.82e-03 9.68e-05  8.96e-03     6s
  35   4.39070561e+04  4.55031156e+04  1.37e-03 8.49e-05  6.93e-03     6s
  36   4.41728920e+04  4.53757293e+04  1.03e-03 6.54e-05  5.22e-03     6s
  37   4.42708810e+04  4.53433204e+04  9.06e-04 5.96e-05  4.65e-03     6s
  38   4.43509989e+04  4.52920401e+04  8.04e-04 4.60e-05  4.08e-03     6s
  39   4.45261234e+04  4.52193325e+04  5.89e-04 3.34e-05  3.01e-03     7s
  40   4.45730997e+04  4.51727674e+04  5.31e-04 2.60e-05  2.60e-03     7s
  41   4.46936469e+04  4.51284850e+04  3.79e-04 1.86e-05  1.89e-03     7s
  42   4.47628353e+04  4.51001166e+04  2.92e-04 1.41e-05  1.46e-03     7s
  43   4.47949980e+04  4.50847876e+04  2.52e-04 1.21e-05  1.26e-03     7s
  44   4.48571684e+04  4.50587361e+04  1.76e-04 8.03e-06  8.75e-04     7s
  45   4.49009704e+04  4.50412168e+04  1.21e-04 7.64e-06  6.09e-04     7s
  46   4.49325656e+04  4.50335816e+04  8.56e-05 5.34e-06  4.38e-04     7s
  47   4.49619230e+04  4.50234162e+04  5.11e-05 4.92e-06  2.67e-04     7s
  48   4.49793776e+04  4.50221946e+04  3.18e-05 4.80e-06  1.86e-04     7s
  49   4.49965858e+04  4.50116760e+04  1.27e-05 3.86e-06  6.55e-05     7s
  50   4.50020922e+04  4.50103618e+04  6.91e-06 1.75e-06  3.59e-05     7s
  51   4.50038153e+04  4.50100932e+04  5.12e-06 1.42e-06  2.73e-05     7s
  52   4.50077368e+04  4.50091852e+04  1.23e-06 2.51e-07  6.29e-06     7s
  53   4.50087065e+04  4.50089881e+04  2.60e-07 1.07e-09  1.22e-06     7s
  54   4.50089346e+04  4.50089770e+04  3.60e-06 1.66e-08  1.82e-07     7s
  55   4.50089716e+04  4.50089758e+04  3.63e-07 5.49e-10  1.81e-08     8s
  56   4.50089735e+04  4.50089758e+04  8.44e-07 2.15e-07  1.00e-08     8s
  57   4.50089752e+04  4.50089758e+04  2.99e-07 4.95e-08  2.70e-09     8s
  58   4.50089755e+04  4.50089758e+04  9.32e-07 3.49e-08  1.61e-09     8s

Barrier solved model in 58 iterations and 7.68 seconds (13.71 work units)
Optimal objective 4.50089755e+04


Root crossover log...

  112727 DPushes remaining with DInf 0.0000000e+00                 8s
   20655 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

   18199 PPushes remaining with PInf 1.9130530e-04                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.9539645e+04     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   81557    4.5008976e+04   0.000000e+00   3.953965e+04     14s
   83021    4.5008976e+04   0.000000e+00   2.949389e+00     15s
   83149    4.5008976e+04   0.000000e+00   0.000000e+00     15s
   83149    4.5008976e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.79s

Solved with barrier

Root relaxation: objective 4.500898e+04, 83149 iterations, 13.68 seconds (31.94 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45008.9758    0  213 -219144.29 45008.9758   121%     -   16s
H    0     0                    -211070.7971 45008.9758   121%     -   17s
H    0     0                    -168130.9199 45008.9758   127%     -   17s
H    0     0                    -35376.07830 45008.9758   227%     -   17s
H    0     0                    -18953.93444 45008.9758   337%     -   17s
H    0     0                    -17337.97764 45008.9758   360%     -   20s
H    0     0                    -13329.21443 45008.9758   438%     -   20s
H    0     0                    -13186.80625 45008.9758   441%     -   20s
H    0     0                    -13045.75773 38165.0913   393%     -  101s
H    0     0                    -13022.06844 38165.0913   393%     -  101s
H    0     0                    -4969.891558 38165.0913   868%     -  104s
     0     0 37801.7048    0  341 -4969.8916 37801.7048   861%     -  104s
H    0     0                    -4898.397450 37801.7048   872%     -  105s
H    0     0                    -4667.759942 37801.7048   910%     -  105s
H    0     0                    -4639.523495 37801.7048   915%     -  105s
H    0     0                    -4632.211477 37801.7048   916%     -  105s
     0     0 37666.1175    0  335 -4632.2115 37666.1175   913%     -  125s
     0     0 37595.3101    0  340 -4632.2115 37595.3101   912%     -  132s
     0     0 37494.1707    0  329 -4632.2115 37494.1707   909%     -  138s
     0     0 37487.1043    0  337 -4632.2115 37487.1043   909%     -  157s
     0     0 37487.1043    0  328 -4632.2115 37487.1043   909%     -  172s
     0     0 37487.1043    0  324 -4632.2115 37487.1043   909%     -  174s
     0     0 37487.1043    0  327 -4632.2115 37487.1043   909%     -  175s
     0     0 37487.1043    0  325 -4632.2115 37487.1043   909%     -  176s
H    0     0                    -2122.867522 33398.2825  1673%     -  237s
H    0     0                    -1997.985559 33398.2825  1772%     -  237s
     0     0 33398.2825    0  335 -1997.9856 33398.2825  1772%     -  237s
H    0     0                    1592.5856425 33397.9154  1997%     -  238s
     0     0 32886.8741    0  325 1592.58564 32886.8741  1965%     -  263s
     0     0 32678.7579    0  377 1592.58564 32678.7579  1952%     -  286s
     0     0 32586.8495    0  387 1592.58564 32586.8495  1946%     -  302s
H    0     0                    4067.0693011 32379.1896   696%     -  317s
H    0     0                    4671.5059857 32379.1896   593%     -  317s
     0     0 32379.1896    0  371 4671.50599 32379.1896   593%     -  317s
H    0     0                    5283.5934019 32133.4417   508%     -  346s
H    0     0                    6520.4450105 32133.4417   393%     -  346s
     0     0 32133.4417    0  379 6520.44501 32133.4417   393%     -  346s
     0     0 32104.2588    0  366 6520.44501 32104.2588   392%     -  355s
H    0     0                    6626.2158406 32086.4354   384%     -  361s
     0     0 32086.4354    0  345 6626.21584 32086.4354   384%     -  361s
     0     0 32050.7530    0  359 6626.21584 32050.7530   384%     -  371s
     0     0 32033.8132    0  358 6626.21584 32033.8132   383%     -  378s
     0     0 32021.4317    0  348 6626.21584 32021.4317   383%     -  386s
     0     0 32013.5207    0  350 6626.21584 32013.5207   383%     -  390s
     0     0 32006.5877    0  355 6626.21584 32006.5877   383%     -  392s
     0     0 32005.6188    0  359 6626.21584 32005.6188   383%     -  394s
H    0     0                    7179.1701217 32005.6188   346%     -  419s
H    0     0                    7188.6304203 32005.6188   345%     -  419s
     0     0 30416.9767    0  409 7188.63042 30416.9767   323%     -  466s
H    0     0                    7313.8452466 30416.9746   316%     -  467s
H    0     0                    7827.7930825 30416.9746   289%     -  467s
H    0     0                    8042.7992961 30416.9746   278%     -  467s
     0     0 29905.7580    0  392 8042.79930 29905.7580   272%     -  491s
     0     0 29785.4030    0  415 8042.79930 29785.4030   270%     -  505s
     0     0 29712.9856    0  413 8042.79930 29712.9856   269%     -  518s
     0     0 29629.4393    0  416 8042.79930 29629.4393   268%     -  531s
     0     0 29577.4427    0  413 8042.79930 29577.4427   268%     -  544s
     0     0 29528.6804    0  417 8042.79930 29528.6804   267%     -  559s
     0     0 29492.5461    0  424 8042.79930 29492.5461   267%     -  571s
     0     0 29480.1022    0  423 8042.79930 29480.1022   267%     -  577s
     0     0 29477.8098    0  421 8042.79930 29477.8098   267%     -  580s
     0     0 29469.2033    0  470 8042.79930 29469.2033   266%     -  584s
     0     0 29459.9793    0  420 8042.79930 29459.9793   266%     -  586s
     0     0 29455.1130    0  418 8042.79930 29455.1130   266%     -  588s
     0     0 29448.6871    0  426 8042.79930 29448.6871   266%     -  592s
     0     0 29444.7744    0  422 8042.79930 29444.7744   266%     -  595s
     0     0 29442.6036    0  425 8042.79930 29442.6036   266%     -  597s
     0     0 29440.5817    0  433 8042.79930 29440.5817   266%     -  599s
     0     0 28401.5191    0  417 8042.79930 28401.5191   253%     -  647s
     0     0 28133.4617    0  415 8042.79930 28133.4617   250%     -  679s
     0     0 28060.1603    0  426 8042.79930 28060.1603   249%     -  693s
     0     0 28016.9098    0  420 8042.79930 28016.9098   248%     -  705s
     0     0 27976.5982    0  371 8042.79930 27976.5982   248%     -  717s
     0     0 27966.1846    0  436 8042.79930 27966.1846   248%     -  724s
     0     0 27958.4497    0  385 8042.79930 27958.4497   248%     -  729s
     0     0 27952.8237    0  376 8042.79930 27952.8237   248%     -  734s
     0     0 27950.9445    0  374 8042.79930 27950.9445   248%     -  737s
     0     0 27726.9682    0  392 8042.79930 27726.9682   245%     -  762s
H    0     0                    8150.3020098 27726.8637   240%     -  763s
H    0     0                    8369.4980562 27726.8637   231%     -  763s
H    0     0                    8391.8586488 27726.8637   230%     -  763s
     0     0 27666.0470    0  431 8391.85865 27666.0470   230%     -  776s
     0     0 27639.3389    0  404 8391.85865 27639.3389   229%     -  782s
     0     0 27618.3213    0  398 8391.85865 27618.3213   229%     -  786s
     0     0 27598.9393    0  399 8391.85865 27598.9393   229%     -  792s
     0     0 27592.0493    0  402 8391.85865 27592.0493   229%     -  794s
     0     0 27586.5574    0  410 8391.85865 27586.5574   229%     -  797s
     0     0 27578.6625    0  412 8391.85865 27578.6625   229%     -  800s
     0     0 27569.3423    0  402 8391.85865 27569.3423   229%     -  804s
     0     0 27559.7016    0  349 8391.85865 27559.7016   228%     -  809s
     0     0 27557.9477    0  402 8391.85865 27557.9477   228%     -  813s
     0     0 27487.4182    0  391 8391.85865 27487.4182   228%     -  826s
H    0     0                    8428.2484483 27487.2543   226%     -  836s
     0     0 27440.2228    0  392 8428.24845 27440.2228   226%     -  845s
     0     0 27395.2637    0  489 8428.24845 27395.2637   225%     -  853s
     0     0 27379.3781    0  500 8428.24845 27379.3781   225%     -  859s
     0     0 27372.8190    0  507 8428.24845 27372.8190   225%     -  862s
     0     0 27370.0228    0  508 8428.24845 27370.0228   225%     -  864s
     0     0 27367.4567    0  507 8428.24845 27367.4567   225%     -  867s
     0     0 27294.6585    0  411 8428.24845 27294.6585   224%     -  877s
     0     0 27269.0286    0  399 8428.24845 27269.0286   224%     -  883s
     0     0 27263.7890    0  405 8428.24845 27263.7890   223%     -  886s
     0     0 27261.9995    0  418 8428.24845 27261.9995   223%     -  888s
     0     0 27244.2024    0  399 8428.24845 27244.2024   223%     -  895s
     0     0 27231.7865    0  337 8428.24845 27231.7865   223%     -  900s
     0     0 27227.3654    0  351 8428.24845 27227.3654   223%     -  903s
     0     0 27226.0382    0  343 8428.24845 27226.0382   223%     -  905s
     0     0 27194.5436    0  446 8428.24845 27194.5436   223%     -  915s
     0     0 27183.2536    0  451 8428.24845 27183.2536   223%     -  920s
     0     0 27178.7039    0  454 8428.24845 27178.7039   222%     -  922s
     0     0 27177.6267    0  452 8428.24845 27177.6267   222%     -  925s
     0     0 27164.4619    0  408 8428.24845 27164.4619   222%     -  929s
H    0     0                    9019.1004073 27164.1444   201%     -  948s
H    0     0                    9281.2780709 27164.1444   193%     -  949s
H    0     0                    9346.2136502 27164.1444   191%     -  949s
H    0     0                    9386.7912283 27164.1444   189%     -  951s
     0     0 27159.5463    0  405 9386.79123 27159.5463   189%     -  953s
     0     0 27158.2596    0  408 9386.79123 27158.2596   189%     -  955s
     0     0 27151.8519    0  411 9386.79123 27151.8519   189%     -  959s
     0     0 27149.1556    0  410 9386.79123 27149.1556   189%     -  961s
     0     0 27145.1032    0  422 9386.79123 27145.1032   189%     -  964s
     0     0 27144.9821    0  422 9386.79123 27144.9821   189%     -  968s
H    0     0                    9393.5093759 27144.9821   189%     - 1088s
     0     2 27144.9821    0  422 9393.50938 27144.9821   189%     - 1116s
     1     4 27135.3679    1  395 9393.50938 27144.9318   189%  2990 1123s
     3     6 26833.3407    2  401 9393.50938 27135.3338   189%  8630 1144s
     5     8 26844.2251    2  319 9393.50938 27066.0188   188% 10569 1164s
     7    15 25907.4772    3  424 9393.50938 26843.0637   186% 12235 1181s
    14    30 26286.6429    4  427 9393.50938 26827.6158   186% 11981 1219s
    29    45 25634.6537    5  431 9393.50938 26483.5627   182% 17159 1377s
    44    76 24546.1642    6  339 9393.50938 26483.5627   182% 16150 1503s
    75   110 24363.6525    7  322 9393.50938 26189.7224   179% 15667 1578s
   109   142 24311.4774    8  328 9393.50938 26189.7224   179% 14353 1610s
H  138   142                    9659.1116089 26189.7224   171% 12868 1610s
   141   276 24293.7832    9  329 9659.11161 26189.7224   171% 12858 1656s
   275   330 24054.0352   12  319 9659.11161 26189.7224   171%  9075 1697s
   329   381 23821.5659   13  316 9659.11161 26189.7224   171%  8532 1729s
   380   435 23385.5438   14  318 9659.11161 26189.7224   171%  8603 1768s
   434   493 22363.3465   16  265 9659.11161 26189.7224   171%  8270 1802s
   494   544 16994.4968   15  292 9659.11161 26189.7224   171%  7778 1837s
   551   618 16913.8648   16  283 9659.11161 26189.7224   171%  7477 1872s
   625   690 16253.4879   20  264 9659.11161 26189.7224   171%  7061 1900s
   699   742 16015.4523   21  265 9659.11161 26189.7224   171%  6692 1931s
   766   782 15367.5074   22  226 9659.11161 26189.7224   171%  6393 1963s
   821   815 15704.4672   22  223 9659.11161 26189.7224   171%  6209 1992s
   862   845 12041.1574   24  204 9659.11161 26189.7224   171%  6131 2025s
   904   876 11835.3089   25  222 9659.11161 26189.7224   171%  6091 2060s
   953   921 11792.1663   26  204 9659.11161 26189.7224   171%  6016 2089s
  1007   979 11098.8652   28  199 9659.11161 26189.7224   171%  5918 2127s
  1079  1057 10683.3337   29  178 9659.11161 26189.7224   171%  5799 2153s
  1186  1116 10370.3337   33  186 9659.11161 26189.7224   171%  5560 2182s
H 1201  1116                    9681.0327168 26189.7224   171%  5517 2182s
H 1209  1116                    9698.1839322 26189.7224   170%  5514 2182s
H 1214  1116                    9742.9878226 26189.7224   169%  5503 2182s
  1279  1185     cutoff   39      9742.98782 26189.7224   169%  5416 2211s
  1380  1270 16628.5345   46  245 9742.98782 26189.7224   169%  5315 2242s
  1503  1300 infeasible   47      9742.98782 26189.7224   169%  5123 2277s
  1574  1370 14716.9192   49  208 9742.98782 26189.7224   169%  5098 2311s
  1678  1453 14432.6142   54  225 9742.98782 26189.7224   169%  5018 2346s
H 1804  1499                    10052.014132 26189.7224   161%  4887 2379s
H 1806  1499                    10168.876040 26189.7224   158%  4886 2379s
H 1823  1499                    10493.255890 26189.7224   150%  4860 2379s
H 1826  1499                    10707.213602 26189.7224   145%  4871 2379s
  1886  1566 10822.4120   62  157 10707.2136 26189.7224   145%  4829 2416s
  2008  1629 20674.7478   10  413 10707.2136 26189.7224   145%  4782 2458s
  2111  1691 19357.6301   11  376 10707.2136 26189.7224   145%  4754 2499s
  2220  1758 13963.7393   51  365 10707.2136 26189.7224   145%  4727 2551s
  2311  1792 18673.6359   12  352 10707.2136 26189.7224   145%  4756 2595s
  2414  1827 18074.5197   15  270 10707.2136 26189.7224   145%  4798 2640s
  2528  1934 17668.2264   18  253 10707.2136 26189.7224   145%  4798 2685s
  2682  1968 12964.5999   21  213 10707.2136 26189.7224   145%  4745 2726s
H 2683  1965                    10723.884521 26189.7224   144%  4743 2726s
H 2686  1923                    11036.840830 26189.7224   137%  4743 2726s
H 2703  1904                    11177.775441 26189.7224   134%  4732 2726s
H 2741  1886                    11323.266313 26111.5604   131%  4749 2726s
  2756  1979 12613.5410   22  216 11323.2663 26111.5604   131%  4746 2776s
  2900  2092 12032.0642   26  213 11323.2663 26111.5604   131%  4743 2826s
  3063  2154 infeasible   32      11323.2663 26092.8473   130%  4734 2881s
  3205  2258 12092.1587   56  296 11323.2663 25995.9732   130%  4735 2940s
  3354  2333 11422.9367   59  176 11323.2663 25995.9732   130%  4755 2997s
  3549  2413 21583.1911   10  272 11323.2663 25995.9732   130%  4723 3061s
  3687  2475 16386.1846   14  233 11323.2663 25995.9732   130%  4745 3131s
H 3812  2560                    11386.875973 25995.9732   128%  4802 3200s
H 3876  2554                    11438.277301 25232.6868   121%  4789 3200s
  3956  2555 20674.4011   11  422 11438.2773 25232.6868   121%  4845 3498s
H 3957  2428                    11461.935081 25232.6868   120%  4844 3524s
  3958  2428 21674.2711   25  273 11461.9351 25232.6868   120%  4842 3527s

Cutting planes:
  Gomory: 47
  Implied bound: 34
  Projected implied bound: 80
  MIR: 1196
  Mixing: 11
  Flow cover: 944
  Zero half: 1
  RLT: 17
  Relax-and-lift: 159

Explored 3958 nodes (20001635 simplex iterations) in 3600.03 seconds (8374.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 11461.9 11438.3 11386.9 ... 10168.9

Time limit reached
Best objective 1.146193508060e+04, best bound 2.523268681671e+04, gap 120.1433%
  WARNING: Time limit reached. Using best solution found (gap: 120.14%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 11461.94, θ = 160748.04
  Upper Bound (UB) = 11461.94

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 160748.04
  [DEBUG]   ✓ Scenario 0: θ = 160748.04 ≤ Q = 160748.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 160748.04 ≤ Q = 160748.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 160748.04 ≤ Q = 160748.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 160748.04 ≤ Q = 160748.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 160748.04 ≤ Q = 160748.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 160748.04 ≤ Q = 160748.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 160748.04 ≤ Q = 160748.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 160748.04 ≤ Q = 160748.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 160748.04 ≤ Q = 160748.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 160748.04 ≤ Q = 160748.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 160748.04 ≤ Q = 160748.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 160748.04 ≤ Q = 160748.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 160748.04 ≤ Q = 160748.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 160748.04 ≤ Q = 160748.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2acc09cf
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2acc09cf
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.321899e+13
Presolve removed 2557 rows and 1849 columns
Presolve time: 0.00s
Presolved: 536 rows, 540 columns, 1512 nonzeros
Found heuristic solution: objective 6855795.8024
Variable types: 366 continuous, 174 integer (174 binary)

Root relaxation: objective -1.543090e+05, 251 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -154308.97    0  124 6855795.80 -154308.97   102%     -    0s
H    0     0                    -118627.9373 -154308.97  30.1%     -    0s
H    0     0                    -119001.8056 -154308.97  29.7%     -    0s
     0     0 -131447.77    0   89 -119001.81 -131447.77  10.5%     -    0s
H    0     0                    -128676.6102 -131445.40  2.15%     -    0s
H    0     0                    -129310.4146 -131445.40  1.65%     -    0s
     0     0 -130359.70    0   66 -129310.41 -130359.70  0.81%     -    0s
     0     0 -130339.54    0   63 -129310.41 -130339.54  0.80%     -    0s
     0     0 -129881.87    0   26 -129310.41 -129881.87  0.44%     -    0s
     0     0 -129786.88    0   36 -129310.41 -129786.88  0.37%     -    0s
     0     0 -129786.03    0   36 -129310.41 -129786.03  0.37%     -    0s
     0     0 -129594.41    0   20 -129310.41 -129594.41  0.22%     -    0s
     0     0 -129555.51    0   29 -129310.41 -129555.51  0.19%     -    0s
     0     0 -129552.48    0   28 -129310.41 -129552.48  0.19%     -    0s
     0     0 -129534.82    0   24 -129310.41 -129534.82  0.17%     -    0s
     0     0 -129441.77    0   13 -129310.41 -129441.77  0.10%     -    0s
     0     0 -129428.73    0   14 -129310.41 -129428.73  0.09%     -    0s
     0     0 -129413.11    0   10 -129310.41 -129413.11  0.08%     -    0s
     0     0 -129413.11    0   30 -129310.41 -129413.11  0.08%     -    0s
H    0     0                    -129352.6297 -129413.11  0.05%     -    0s
     0     0 -129359.33    0    3 -129352.63 -129359.33  0.01%     -    0s
*    0     0               0    -129358.6723 -129358.67  0.00%     -    0s

Cutting planes:
  Gomory: 6
  Implied bound: 6
  MIR: 20
  Flow cover: 5
  Relax-and-lift: 1

Explored 1 nodes (928 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -129359 -129353 -129310 ... 1.3219e+13
No other solutions better than -129359

Optimal solution found (tolerance 1.00e-06)
Best objective -1.293586722505e+05, best bound -1.293586722505e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 153121.38
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -129358.67
  [DEBUG]   S×d_nominal = 282480.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282480.05 + -129358.67 = 153121.38
  [DEBUG]   Current θ from Master = 160748.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7626.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3835.28
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2120.1475, Absolute Gap = 2120.1475, Relative Gap = 0.184973
  Not converged yet (gap = 2120.15 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654299 nonzeros
Model fingerprint: 0x4675106c
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 95445 rows and 38745 columns
Presolve time: 2.18s
Presolved: 135288 rows, 57115 columns, 831068 nonzeros
Variable types: 54856 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.12s

Barrier statistics:
 Dense cols : 695
 AA' NZ     : 5.995e+06
 Factor NZ  : 1.344e+07 (roughly 200 MB of memory)
 Factor Ops : 2.895e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.88131352e+07  2.48087826e+08  1.23e+05 1.71e+01  9.23e+04     5s
   1  -1.44376757e+07  2.22618771e+08  8.75e+04 6.81e+01  6.51e+04     5s
   2  -5.26111786e+06  1.74780455e+08  3.12e+04 7.12e-01  2.46e+04     5s
   3  -1.77430180e+06  1.60600976e+08  6.17e+03 1.12e+01  5.33e+03     5s
   4  -8.29506965e+05  1.24588022e+08  9.22e+02 6.22e+00  1.18e+03     5s
   5  -7.05213697e+05  7.37570522e+07  4.56e+02 3.30e+00  6.07e+02     5s
   6  -5.25494475e+05  4.51462199e+07  1.79e+02 1.64e+00  2.95e+02     5s
   7  -4.07123189e+05  3.22591502e+07  5.87e+01 9.02e-01  1.65e+02     5s
   8  -3.28573705e+05  2.58865792e+07  1.95e+01 3.39e-01  1.16e+02     5s
   9  -2.48714552e+05  1.86418400e+07  8.85e+00 2.68e-02  8.01e+01     5s
  10  -1.73138018e+05  8.97241560e+06  4.06e+00 1.24e-02  3.79e+01     5s
  11  -1.19814965e+05  4.38024339e+06  1.87e+00 2.72e-02  1.85e+01     5s
  12  -8.49178042e+04  2.24309735e+06  8.47e-01 3.57e-02  9.49e+00     5s
  13  -5.62930106e+04  1.28088761e+06  3.90e-01 3.09e-02  5.43e+00     5s
  14  -2.52347395e+04  4.67609055e+05  1.49e-01 5.90e-03  2.00e+00     5s
  15  -9.08743285e+03  2.56488021e+05  9.18e-02 3.81e-04  1.08e+00     5s
  16   3.09674700e+03  1.85123013e+05  6.10e-02 3.51e-04  7.38e-01     5s
  17   8.29184535e+03  1.72894752e+05  5.11e-02 3.03e-04  6.67e-01     5s
  18   1.54997999e+04  1.22407901e+05  3.81e-02 2.28e-03  4.34e-01     6s
  19   1.96866945e+04  9.10751436e+04  3.14e-02 2.41e-03  2.90e-01     6s
  20   2.48345092e+04  8.22666750e+04  2.39e-02 2.39e-03  2.33e-01     6s
  21   2.74995709e+04  7.31834542e+04  2.00e-02 2.00e-03  1.85e-01     6s
  22   3.21289165e+04  6.40813311e+04  1.37e-02 1.57e-03  1.30e-01     6s
  23   3.46104224e+04  5.82373270e+04  1.07e-02 1.95e-03  9.58e-02     6s
  24   3.58100715e+04  5.55688825e+04  9.30e-03 1.67e-03  8.01e-02     6s
  25   3.73844597e+04  5.44809734e+04  7.53e-03 1.44e-03  6.93e-02     6s
  26   3.95808667e+04  5.16347159e+04  5.11e-03 8.59e-04  4.89e-02     6s
  27   4.07747022e+04  5.05856233e+04  3.88e-03 7.79e-04  3.98e-02     6s
  28   4.23299918e+04  4.85407711e+04  2.38e-03 4.09e-04  2.52e-02     6s
  29   4.32152409e+04  4.75826202e+04  1.56e-03 2.71e-04  1.77e-02     6s
  30   4.36994508e+04  4.63610275e+04  1.13e-03 1.34e-04  1.08e-02     6s
  31   4.41924890e+04  4.60941321e+04  7.28e-04 1.08e-04  7.71e-03     6s
  32   4.43941085e+04  4.59171264e+04  5.57e-04 8.81e-05  6.18e-03     6s
  33   4.46139414e+04  4.57059177e+04  3.77e-04 6.44e-05  4.43e-03     7s
  34   4.47963186e+04  4.55517891e+04  2.28e-04 4.67e-05  3.06e-03     7s
  35   4.49156092e+04  4.53476748e+04  1.36e-04 2.42e-05  1.75e-03     7s
  36   4.49305871e+04  4.52506819e+04  1.24e-04 1.36e-05  1.30e-03     7s
  37   4.50222299e+04  4.52143304e+04  6.19e-05 9.83e-06  7.79e-04     7s
  38   4.50383862e+04  4.51417596e+04  5.16e-05 1.93e-06  4.19e-04     7s
  39   4.50503873e+04  4.51399216e+04  4.40e-05 1.75e-06  3.63e-04     7s
  40   4.50929663e+04  4.51290945e+04  1.63e-05 6.71e-07  1.46e-04     7s
  41   4.51152161e+04  4.51226531e+04  2.72e-06 1.57e-07  3.01e-05     7s
  42   4.51195597e+04  4.51204660e+04  3.35e-07 6.00e-08  3.67e-06     7s
  43   4.51202588e+04  4.51202702e+04  4.17e-08 1.20e-08  4.62e-08     7s
  44   4.51202657e+04  4.51202679e+04  1.63e-06 4.10e-09  8.95e-09     7s
  45   4.51202678e+04  4.51202679e+04  4.14e-08 5.99e-08  8.31e-11     7s

Barrier solved model in 45 iterations and 7.31 seconds (12.31 work units)
Optimal objective 4.51202678e+04


Root crossover log...

  119970 DPushes remaining with DInf 0.0000000e+00                 7s
    8066 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    2293 PPushes remaining with PInf 1.1234807e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.0449207e+01     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57357    4.5120268e+04   0.000000e+00   1.044921e+01     12s
   57362    4.5120268e+04   0.000000e+00   0.000000e+00     12s
   57362    4.5120268e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.69s

Solved with barrier

Root relaxation: objective 4.512027e+04, 57362 iterations, 9.65 seconds (19.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45120.2679    0  218 -219144.29 45120.2679   121%     -   13s
H    0     0                    -100283.5550 45120.2679   145%     -   13s
H    0     0                    -35053.36361 45120.2679   229%     -   13s
H    0     0                    -2853.350501 45120.2679  1681%     -   13s
H    0     0                    -2641.850611 45120.2679  1808%     -   14s
H    0     0                    -2605.913004 45120.2679  1831%     -   14s
     0     0 37859.7137    0  333 -2605.9130 37859.7137  1553%     -   68s
     0     0 37859.7137    0  333 -2605.9130 37859.7137  1553%     -   68s
H    0     0                    -2230.567413 37859.5800  1797%     -   69s
H    0     0                    -1688.636994 37859.5800  2342%     -   69s
H    0     0                    -1424.572386 37859.5800  2758%     -   69s
H    0     0                    -935.5976657 37859.5800  4147%     -   69s
H    0     0                    -836.3147924 37859.5800  4627%     -   69s
H    0     0                    -769.8101530 37859.5800  5018%     -   70s
H    0     0                    -734.7261553 37859.5800  5253%     -   70s
H    0     0                    -721.6122135 37859.5800  5347%     -   70s
H    0     0                    -680.2234657 37859.5800  5666%     -   70s
H    0     0                    -518.3746884 37859.5800  7404%     -   70s
H    0     0                    -508.7507181 37859.5800  7542%     -   70s
H    0     0                    -456.6220731 37859.5800  8391%     -   70s
     0     0 37743.8669    0  340 -456.62207 37743.8669  8366%     -   86s
     0     0 37721.0848    0  335 -456.62207 37721.0848  8361%     -   95s
     0     0 37694.8280    0  327 -456.62207 37694.8280  8355%     -  105s
     0     0 37669.0878    0  331 -456.62207 37669.0878  8350%     -  109s
     0     0 37649.9859    0  309 -456.62207 37649.9859  8345%     -  115s
     0     0 37599.9211    0  305 -456.62207 37599.9211  8334%     -  124s
     0     0 37596.9300    0  331 -456.62207 37596.9300  8334%     -  127s
     0     0 37559.8699    0  330 -456.62207 37559.8699  8326%     -  137s
     0     0 37455.4042    0  336 -456.62207 37455.4042  8303%     -  147s
     0     0 37452.2944    0  333 -456.62207 37452.2944  8302%     -  153s
     0     0 37449.2770    0  328 -456.62207 37449.2770  8301%     -  154s
     0     0 37390.2435    0  326 -456.62207 37390.2435  8288%     -  159s
     0     0 37388.4379    0  324 -456.62207 37388.4379  8288%     -  159s
     0     0 37388.2722    0  327 -456.62207 37388.2722  8288%     -  162s
     0     0 34129.0925    0  364 -456.62207 34129.0925  7574%     -  213s
H    0     0                     127.4078570 34129.0620      -     -  214s
H    0     0                     991.8329847 34129.0620  3341%     -  214s
H    0     0                    1033.3742429 34129.0620  3203%     -  214s
H    0     0                    1080.2001721 34129.0620  3060%     -  214s
H    0     0                    1085.0754453 34129.0620  3045%     -  214s
H    0     0                    1086.9374362 34129.0620  3040%     -  214s
H    0     0                    1099.6004733 34129.0620  3004%     -  220s
     0     0 33401.2675    0  372 1099.60047 33401.2675  2938%     -  253s
     0     0 33284.4602    0  308 1099.60047 33284.4602  2927%     -  274s
     0     0 33249.0678    0  309 1099.60047 33249.0678  2924%     -  281s
     0     0 32967.8526    0  366 1099.60047 32967.8526  2898%     -  297s
     0     0 32921.2747    0  370 1099.60047 32921.2747  2894%     -  304s
     0     0 32794.2479    0  373 1099.60047 32794.2479  2882%     -  320s
     0     0 32737.0061    0  379 1099.60047 32737.0061  2877%     -  331s
     0     0 32715.3122    0  376 1099.60047 32715.3122  2875%     -  336s
     0     0 32692.7841    0  369 1099.60047 32692.7841  2873%     -  343s
     0     0 32685.4295    0  370 1099.60047 32685.4295  2872%     -  346s
     0     0 32665.5515    0  369 1099.60047 32665.5515  2871%     -  350s
     0     0 32652.9360    0  383 1099.60047 32652.9360  2870%     -  356s
     0     0 32651.8454    0  389 1099.60047 32651.8454  2869%     -  358s
     0     0 30391.9592    0  353 1099.60047 30391.9592  2664%     -  445s
H    0     0                    1203.7563785 30391.9007  2425%     -  446s
H    0     0                    1215.8229697 30391.9007  2400%     -  446s
     0     0 29887.0254    0  407 1215.82297 29887.0254  2358%     -  484s
     0     0 29771.2605    0  385 1215.82297 29771.2605  2349%     -  499s
     0     0 29696.4651    0  438 1215.82297 29696.4651  2342%     -  509s
     0     0 29672.6649    0  433 1215.82297 29672.6649  2341%     -  517s
     0     0 29632.4375    0  420 1215.82297 29632.4375  2337%     -  526s
     0     0 29608.5241    0  425 1215.82297 29608.5241  2335%     -  535s
     0     0 29601.4938    0  435 1215.82297 29601.4938  2335%     -  540s
     0     0 29588.4711    0  429 1215.82297 29588.4711  2334%     -  546s
     0     0 29573.7976    0  432 1215.82297 29573.7976  2332%     -  554s
     0     0 29550.1678    0  436 1215.82297 29550.1678  2330%     -  562s
     0     0 29547.5047    0  445 1215.82297 29547.5047  2330%     -  565s
     0     0 29531.7323    0  400 1215.82297 29531.7323  2329%     -  571s
     0     0 29509.9359    0  430 1215.82297 29509.9359  2327%     -  576s
     0     0 29425.1100    0  432 1215.82297 29425.1100  2320%     -  588s
     0     0 29397.1311    0  433 1215.82297 29397.1311  2318%     -  595s
     0     0 29385.8873    0  434 1215.82297 29385.8873  2317%     -  602s
     0     0 29384.4451    0  435 1215.82297 29384.4451  2317%     -  604s
     0     0 28443.8828    0  383 1215.82297 28443.8828  2239%     -  666s
H    0     0                    1343.4323172 28442.8262  2017%     -  667s
H    0     0                    1915.8577213 28442.8262  1385%     -  667s
H    0     0                    1922.2531762 28442.8262  1380%     -  667s
     0     0 28329.8336    0  387 1922.25318 28329.8336  1374%     -  695s
     0     0 28230.0521    0  443 1922.25318 28230.0521  1369%     -  720s
     0     0 28174.3142    0  476 1922.25318 28174.3142  1366%     -  739s
     0     0 28151.3650    0  489 1922.25318 28151.3650  1364%     -  748s
     0     0 28140.1888    0  453 1922.25318 28140.1888  1364%     -  754s
     0     0 28135.3267    0  459 1922.25318 28135.3267  1364%     -  759s
     0     0 28132.2464    0  466 1922.25318 28132.2464  1364%     -  761s
     0     0 28131.7622    0  469 1922.25318 28131.7622  1363%     -  763s
     0     0 27957.5865    0  327 1922.25318 27957.5865  1354%     -  789s
H    0     0                    2071.6728519 27957.5261  1250%     -  789s
H    0     0                    2088.3437708 27957.5261  1239%     -  790s
     0     0 27905.5444    0  340 2088.34377 27905.5444  1236%     -  803s
     0     0 27884.7383    0  349 2088.34377 27884.7383  1235%     -  812s
     0     0 27880.6692    0  343 2088.34377 27880.6692  1235%     -  818s
     0     0 27876.4043    0  351 2088.34377 27876.4043  1235%     -  822s
     0     0 27873.2059    0  346 2088.34377 27873.2059  1235%     -  825s
     0     0 27870.5256    0  356 2088.34377 27870.5256  1235%     -  828s
     0     0 27758.0852    0  459 2088.34377 27758.0852  1229%     -  845s
H    0     0                    2246.1741588 27757.9420  1136%     -  846s
     0     0 27723.2497    0  498 2246.17416 27723.2497  1134%     -  860s
     0     0 27709.8873    0  453 2246.17416 27709.8873  1134%     -  868s
     0     0 27704.8064    0  467 2246.17416 27704.8064  1133%     -  873s
     0     0 27699.0343    0  465 2246.17416 27699.0343  1133%     -  878s
     0     0 27687.7046    0  401 2246.17416 27687.7046  1133%     -  882s
     0     0 27682.1181    0  399 2246.17416 27682.1181  1132%     -  886s
     0     0 27679.7441    0  405 2246.17416 27679.7441  1132%     -  889s
     0     0 27632.0016    0  491 2246.17416 27632.0016  1130%     -  902s
     0     0 27618.8696    0  457 2246.17416 27618.8696  1130%     -  907s
     0     0 27612.8603    0  449 2246.17416 27612.8603  1129%     -  911s
     0     0 27611.7414    0  451 2246.17416 27611.7414  1129%     -  912s
     0     0 27576.6181    0  516 2246.17416 27576.6181  1128%     -  922s
H    0     0                    3708.9351222 27576.5641   644%     -  923s
H    0     0                    3967.3270466 27576.5641   595%     -  923s
H    0     0                    4184.5053537 27576.5641   559%     -  923s
H    0     0                    4197.8758235 27576.5641   557%     -  923s
H    0     0                    4208.6655496 27576.5641   555%     -  923s
H    0     0                    4237.1926976 27576.5641   551%     -  923s
H    0     0                    4252.2691395 27576.5641   549%     -  923s
H    0     0                    4268.4169776 27576.5641   546%     -  923s
     0     0 27562.6975    0  520 4268.41698 27562.6975   546%     -  930s
     0     0 27556.2398    0  513 4268.41698 27556.2398   546%     -  936s
     0     0 27554.0924    0  522 4268.41698 27554.0924   546%     -  939s
     0     0 27534.8159    0  509 4268.41698 27534.8159   545%     -  950s
     0     0 27523.4146    0  480 4268.41698 27523.4146   545%     -  958s
     0     0 27517.2156    0  484 4268.41698 27517.2156   545%     -  963s
     0     0 27513.9402    0  479 4268.41698 27513.9402   545%     -  967s
     0     0 27512.2441    0  507 4268.41698 27512.2441   545%     -  970s
     0     0 27503.2996    0  476 4268.41698 27503.2996   544%     -  977s
H    0     0                    4636.2680339 27502.4107   493%     -  978s
H    0     0                    4674.4335726 27502.4107   488%     -  978s
H    0     0                    4808.3908409 27502.4107   472%     -  978s
H    0     0                    4899.0616545 27502.4107   461%     -  978s
H    0     0                    5962.3310308 27502.4107   361%     -  978s
H    0     0                    5969.6496053 27502.4107   361%     -  978s
     0     0 27499.0745    0  469 5969.64961 27499.0745   361%     -  982s
     0     0 27488.8956    0  479 5969.64961 27488.8956   360%     -  988s
     0     0 27487.3149    0  480 5969.64961 27487.3149   360%     -  990s
     0     0 27482.0678    0  454 5969.64961 27482.0678   360%     -  995s
     0     0 27477.5601    0  514 5969.64961 27477.5601   360%     -  998s
     0     0 27473.1599    0  511 5969.64961 27473.1599   360%     - 1002s
     0     0 27471.0384    0  522 5969.64961 27471.0384   360%     - 1004s
     0     0 27461.3954    0  502 5969.64961 27461.3954   360%     - 1013s
     0     0 27460.8877    0  502 5969.64961 27460.8877   360%     - 1018s
H    0     0                    5979.7090362 27460.2062   359%     - 1074s
H    0     0                    5985.0585076 27460.2062   359%     - 1074s
H    0     0                    7934.7033218 27460.2062   246%     - 1160s
H    0     0                    8424.9922866 27460.2062   226%     - 1164s
H    0     0                    8712.4300169 27460.2062   215%     - 1164s
H    0     0                    9132.0469543 27460.2062   201%     - 1164s
H    0     0                    9228.6646342 27460.2062   198%     - 1164s
     0     2 27460.2062    0  502 9228.66463 27460.2062   198%     - 1166s
     1     3 27278.8072    1  445 9228.66463 27460.1048   198%  8683 1177s
     2     4 27360.0717    1  458 9228.66463 27360.0717   196% 10244 1189s
     3     5 26979.4287    2  435 9228.66463 27360.0174   196% 11022 1206s
     4     9 26178.9501    2  381 9228.66463 27359.7546   196% 12166 1229s
     8    17 25733.8283    3  390 9228.66463 26985.0685   192% 13207 1270s
    16    33 25470.4924    4  388 9228.66463 26985.0685   192% 15190 1322s
    32    48 25578.5052    6  382 9228.66463 26783.6418   190% 24111 1414s
    47    79 24345.9386    7  322 9228.66463 26783.6418   190% 22390 1468s
H   49    79                    9254.0588569 26783.6418   189% 22164 1468s
H   50    79                    9328.9258329 26783.6418   187% 21953 1468s
H   51    79                    9530.2130550 26783.6418   181% 21946 1468s
H   68    79                    9843.8649249 26594.8127   170% 19670 1468s
    78   157 24296.8963    8  316 9843.86492 26594.8127   170% 18402 1600s
H  156   189                    9892.5787323 26594.8127   169% 12006 1636s
H  160   189                    10553.789607 26594.8127   152% 12113 1636s
H  172   189                    11343.287160 26594.8127   134% 11958 1636s
   188   269 23855.8222   11  395 11343.2872 26594.8127   134% 11955 1683s
H  268   322                    11356.666933 26594.8127   134% 10265 1721s
H  270   322                    11521.180331 26594.8127   131% 10217 1721s
   321   392 23690.9883   11  301 11521.1803 26594.8127   131% 10006 1759s
   391   421 22855.1204   12  272 11521.1803 26594.8127   131%  9087 1788s
H  392   421                    11559.192812 26594.8127   130%  9064 1788s
   420   491 22739.8941   13  280 11559.1928 26594.8127   130%  8923 1838s
   490   563 22594.3337   15  260 11559.1928 26594.8127   130%  8436 1884s
   563   622 22272.4211   16  266 11559.1928 26594.8127   130%  7944 1917s
   630   682 22213.2792   18  267 11559.1928 26594.8127   130%  7643 1944s
   704   746 21670.9568   20  307 11559.1928 26594.8127   130%  7293 1973s
   776   805 21496.2153   22  302 11559.1928 26594.8127   130%  6948 1997s
   845   844 20889.7708   24  297 11559.1928 26594.8127   130%  6683 2025s
   909   893 20762.2682   25  291 11559.1928 26594.8127   130%  6481 2055s
   974   965 19798.9071   26  258 11559.1928 26594.8127   130%  6321 2086s
  1068  1036 12185.4791   28  231 11559.1928 26594.8127   130%  6083 2116s
  1173  1141 infeasible   30      11559.1928 26594.8127   130%  5819 2154s
  1311  1228 infeasible   31      11559.1928 26594.8127   130%  5495 2184s
  1453  1279 infeasible   31      11559.1928 26594.8127   130%  5257 2215s
  1567  1296 15174.0915   35  268 11559.1928 26594.8127   130%  5146 2247s
H 1619  1296                    11630.946376 26594.8127   129%  5088 2247s
  1632  1380 16913.5449   25  386 11630.9464 26594.8127   129%  5084 2281s
  1753  1406 14575.3987   26  361 11630.9464 26594.8127   129%  4953 2318s
  1859  1438 14415.8593   29  366 11630.9464 26594.8127   129%  4920 2356s
  1965  1464     cutoff   30      11630.9464 26594.8127   129%  4851 2396s
  2076  1537 22080.3295   13  318 11630.9464 26594.8127   129%  4793 2437s
  2214  1578 21282.4347   14  303 11630.9464 26594.8127   129%  4711 2489s
  2352  1627 13364.4429   15  210 11630.9464 26594.8127   129%  4613 2535s
  2468  1645 infeasible   17      11630.9464 26594.8127   129%  4584 2585s
H 2475  1645                    11647.617294 26594.8127   128%  4582 2585s
  2526  1715 22645.3072    9  417 11647.6173 26594.8127   128%  4605 2630s
  2641  1778 infeasible   21      11647.6173 26594.8127   128%  4584 2681s
  2780  1816 18274.5798   10  414 11647.6173 26594.8127   128%  4562 2735s
  2886  1890 16550.9665   11  389 11647.6173 26594.8127   128%  4602 2791s
  3032  1935 16410.3892   14  328 11647.6173 26128.7688   124%  4599 2847s
  3101  1995 16305.0894   15  330 11647.6173 26128.7688   124%  4635 2923s
H 3154  1976                    11845.725734 26128.7688   121%  4658 2923s
  3187  2070 16161.5844   16  333 11845.7257 26128.7688   121%  4670 2982s
  3313  2216 15799.7099   20  342 11845.7257 26100.6154   120%  4697 3047s
  3511  2357 infeasible   29      11845.7257 26100.6154   120%  4649 3110s
H 3724  2386                    12061.420184 26100.6154   116%  4601 3170s
  3827  2385 12794.9211   27  502 12061.4202 26100.6154   116%  4599 3474s
  3829  2386 22688.7941   21  273 12061.4202 26100.6154   116%  4597 3512s

Cutting planes:
  Learned: 3
  Gomory: 30
  Implied bound: 27
  Projected implied bound: 111
  MIR: 1276
  Mixing: 20
  Flow cover: 1043
  Zero half: 1
  RLT: 18
  Relax-and-lift: 176

Explored 3829 nodes (18471170 simplex iterations) in 3600.03 seconds (8527.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 12061.4 11845.7 11647.6 ... 9892.58

Time limit reached
Best objective 1.206142018363e+04, best bound 2.610061538422e+04, gap 116.3975%
  WARNING: Time limit reached. Using best solution found (gap: 116.40%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.17s
  Master Objective (UB) = 12061.42, θ = 161765.67
  Upper Bound (UB) = 12061.42

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161765.67
  [DEBUG]   ✓ Scenario 0: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 161765.67 ≤ Q = 161765.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 161765.67 ≤ Q = 161765.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 161765.67 ≤ Q = 161765.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 161765.67 ≤ Q = 161765.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 161765.67 ≤ Q = 161765.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 161765.67 ≤ Q = 161765.67 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 161765.67 ≤ Q = 161765.67 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x68cceb96
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x68cceb96
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.368905e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 7007722.4096
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.530123e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153012.27    0  124 7007722.41 -153012.27   102%     -    0s
H    0     0                    -117555.4478 -153012.27  30.2%     -    0s
H    0     0                    -117839.5110 -153012.27  29.8%     -    0s
     0     0 -127848.94    0   69 -117839.51 -127848.94  8.49%     -    0s
H    0     0                    -124021.6866 -127754.34  3.01%     -    0s
H    0     0                    -124363.6740 -127754.34  2.73%     -    0s
H    0     0                    -124923.2545 -127754.34  2.27%     -    0s
H    0     0                    -125265.2419 -127754.34  1.99%     -    0s
     0     0 -126963.75    0   71 -125265.24 -126963.75  1.36%     -    0s
     0     0 -126837.99    0   72 -125265.24 -126837.99  1.26%     -    0s
     0     0 -126837.99    0   71 -125265.24 -126837.99  1.26%     -    0s
H    0     0                    -125265.5171 -126837.99  1.26%     -    0s
     0     0 -126500.13    0   13 -125265.52 -126500.13  0.99%     -    0s
     0     0 -126270.76    0   55 -125265.52 -126270.76  0.80%     -    0s
     0     0 -126267.93    0   55 -125265.52 -126267.93  0.80%     -    0s
     0     0 -126175.16    0   55 -125265.52 -126175.16  0.73%     -    0s
H    0     0                    -125328.8920 -126146.46  0.65%     -    0s
     0     0 -126146.46    0   49 -125328.89 -126146.46  0.65%     -    0s
     0     0 -126058.94    0   55 -125328.89 -126058.94  0.58%     -    0s
     0     0 -126049.90    0   55 -125328.89 -126049.90  0.58%     -    0s
     0     2 -126040.28    0   55 -125328.89 -126040.28  0.57%     -    0s
H   30    50                    -125872.2593 -125942.85  0.06%  14.6    0s
H   71     5                    -125926.7065 -125929.74  0.00%   8.6    0s

Cutting planes:
  Gomory: 23
  Implied bound: 5
  MIR: 152
  Flow cover: 10
  RLT: 30
  Relax-and-lift: 1
  BQP: 1

Explored 88 nodes (1289 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -125927 -125872 -125329 ... 1.36891e+13
No other solutions better than -125927

Optimal solution found (tolerance 1.00e-06)
Best objective -1.259267065497e+05, best bound -1.259267065497e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 156430.27
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -125926.71
  [DEBUG]   S×d_nominal = 282356.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282356.97 + -125926.71 = 156430.27
  [DEBUG]   Current θ from Master = 161765.67
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5335.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 6726.02
  Lower Bound (LB) = 9341.79
  Gap (UB-LB) = 2719.6326, Absolute Gap = 2719.6326, Relative Gap = 0.225482
  Not converged yet (gap = 2719.63 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697551 nonzeros
Model fingerprint: 0xbc034b01
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 101808 rows and 41328 columns
Presolve time: 2.47s
Presolved: 144215 rows, 60772 columns, 886487 nonzeros
Variable types: 58513 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346889.3299
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.22s

Barrier statistics:
 Dense cols : 697
 AA' NZ     : 6.715e+06
 Factor NZ  : 1.505e+07 (roughly 200 MB of memory)
 Factor Ops : 3.390e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.94206179e+07  2.62064163e+08  1.27e+05 1.65e+01  9.47e+04     5s
   1  -1.49371841e+07  2.36022789e+08  9.05e+04 6.79e+01  6.70e+04     5s
   2  -5.82166219e+06  1.85708446e+08  3.46e+04 1.36e+00  2.71e+04     5s
   3  -2.25519864e+06  1.86365570e+08  1.10e+04 1.73e+01  9.09e+03     5s
   4  -1.30279435e+06  1.37460444e+08  5.28e+03 4.41e+00  4.40e+03     5s
   5  -5.88879474e+05  1.04651362e+08  8.33e+02 1.98e+00  9.89e+02     5s
   6  -4.91847849e+05  4.63216212e+07  4.35e+02 4.82e-01  4.46e+02     5s
   7  -3.84276508e+05  3.43222459e+07  1.25e+02 3.09e-01  2.05e+02     5s
   8  -2.89613775e+05  2.10120775e+07  3.70e+01 6.24e-02  9.88e+01     5s
   9  -1.89250000e+05  1.78800777e+07  9.13e+00 1.95e-02  7.27e+01     5s
  10  -1.24639265e+05  1.17707741e+07  2.94e+00 1.26e-02  4.61e+01     6s
  11  -1.10743003e+05  4.56774026e+06  1.31e+00 2.99e-02  1.80e+01     6s
  12  -8.21142169e+04  2.94374961e+06  5.52e-01 2.94e-03  1.16e+01     6s
  13  -7.53767782e+04  1.75267668e+06  4.98e-01 1.28e-02  6.98e+00     6s
  14  -5.54849980e+04  5.11345972e+05  2.41e-01 4.95e-04  2.16e+00     6s
  15  -2.87889627e+04  2.82155613e+05  1.37e-01 2.90e-04  1.18e+00     6s
  16  -6.92272612e+03  1.85103849e+05  8.49e-02 2.83e-04  7.31e-01     6s
  17  -1.58746026e+03  1.53746232e+05  7.49e-02 6.93e-04  5.91e-01     6s
  18   8.45265132e+03  1.24353948e+05  5.72e-02 1.75e-03  4.41e-01     6s
  19   1.28873253e+04  1.04281348e+05  4.92e-02 3.96e-03  3.48e-01     6s
  20   1.72597026e+04  8.40969475e+04  4.19e-02 1.97e-03  2.54e-01     6s
  21   2.58272445e+04  7.42746110e+04  2.65e-02 1.50e-03  1.84e-01     6s
  22   2.89246199e+04  6.78982273e+04  2.15e-02 1.03e-03  1.48e-01     6s
  23   3.14335955e+04  6.21321102e+04  1.76e-02 7.76e-04  1.17e-01     6s
  24   3.22847943e+04  6.07026015e+04  1.63e-02 7.21e-04  1.08e-01     6s
  25   3.39294495e+04  5.55639636e+04  1.40e-02 5.72e-04  8.24e-02     6s
  26   3.55304990e+04  5.43033234e+04  1.19e-02 5.03e-04  7.15e-02     7s
  27   3.70191688e+04  5.17185283e+04  9.90e-03 3.86e-04  5.60e-02     7s
  28   3.75967072e+04  5.02677658e+04  9.16e-03 3.06e-04  4.82e-02     7s
  29   3.92026121e+04  4.89656173e+04  7.04e-03 2.27e-04  3.72e-02     7s
  30   4.01692989e+04  4.81202537e+04  5.80e-03 1.72e-04  3.03e-02     7s
  31   4.14380651e+04  4.73114559e+04  4.26e-03 1.24e-04  2.24e-02     7s
  32   4.20793497e+04  4.67865969e+04  3.49e-03 9.29e-05  1.79e-02     7s
  33   4.31410076e+04  4.62797650e+04  2.27e-03 6.63e-05  1.20e-02     7s
  34   4.32933467e+04  4.59475356e+04  2.08e-03 4.42e-05  1.01e-02     7s
  35   4.38055605e+04  4.58312112e+04  1.50e-03 4.54e-05  7.71e-03     7s
  36   4.42763622e+04  4.56374897e+04  9.59e-04 3.15e-05  5.18e-03     7s
  37   4.44304349e+04  4.55261133e+04  7.86e-04 2.36e-05  4.17e-03     7s
  38   4.46284527e+04  4.54246128e+04  5.69e-04 1.66e-05  3.03e-03     8s
  39   4.47547848e+04  4.53289642e+04  4.31e-04 9.34e-06  2.19e-03     8s
  40   4.48304432e+04  4.53026109e+04  3.53e-04 7.72e-06  1.80e-03     8s
  41   4.48719116e+04  4.52946851e+04  3.09e-04 7.25e-06  1.61e-03     8s
  42   4.49107414e+04  4.52757454e+04  2.70e-04 6.11e-06  1.39e-03     8s
  43   4.50662882e+04  4.52289250e+04  1.04e-04 1.16e-05  6.19e-04     8s
  44   4.51122891e+04  4.52199388e+04  5.75e-05 9.67e-06  4.10e-04     8s
  45   4.51406502e+04  4.51901565e+04  2.95e-05 3.35e-06  1.88e-04     8s
  46   4.51622505e+04  4.51781002e+04  9.64e-06 8.05e-07  6.03e-05     8s
  47   4.51707346e+04  4.51744730e+04  2.23e-06 1.21e-06  1.42e-05     8s
  48   4.51734443e+04  4.51736749e+04  1.09e-07 1.64e-07  8.78e-07     8s
  49   4.51736233e+04  4.51736382e+04  3.83e-06 4.09e-10  5.63e-08     8s
  50   4.51736297e+04  4.51736381e+04  3.22e-06 5.31e-08  3.15e-08     8s
  51   4.51736381e+04  4.51736381e+04  3.41e-09 5.33e-08  6.05e-12     8s

Barrier solved model in 51 iterations and 8.42 seconds (14.70 work units)
Optimal objective 4.51736381e+04


Root crossover log...

  128484 DPushes remaining with DInf 1.4335710e-08                 8s
   21617 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    1424 PPushes remaining with PInf 1.3011733e-06                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.4468307e-10     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60190    4.5173638e+04   0.000000e+00   0.000000e+00     11s
   60190    4.5173638e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 4.517364e+04, 60190 iterations, 8.38 seconds (17.14 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45173.6381    0  210 -219144.29 45173.6381   121%     -   12s
H    0     0                    -217868.4340 45173.6381   121%     -   12s
H    0     0                    -124895.2444 45173.6381   136%     -   12s
H    0     0                    -124042.6680 45173.6381   136%     -   12s
H    0     0                    -120360.4760 45173.6381   138%     -   12s
H    0     0                    -34731.92634 45173.6381   230%     -   12s
H    0     0                    -8505.217832 45173.6381   631%     -   13s
H    0     0                    -7410.722302 45173.6381   710%     -   13s
H    0     0                    -5162.250508 45173.6381   975%     -   13s
H    0     0                    -4076.932768 45173.6381  1208%     -   14s
H    0     0                    -2885.099273 45173.6381  1666%     -   14s
H    0     0                    -2690.670834 45173.6381  1779%     -   14s
H    0     0                    -2670.985898 45173.6381  1791%     -   14s
     0     0 38506.6617    0  276 -2670.9859 38506.6617  1542%     -   91s
     0     0 38506.6617    0  276 -2670.9859 38506.6617  1542%     -   91s
H    0     0                    -1128.271165 38505.1638  3513%     -   92s
H    0     0                    -1077.188889 38505.1638  3675%     -   92s
H    0     0                    -285.8004527 38505.1638      -     -   92s
H    0     0                     -45.6252438 38505.1638      -     -   92s
     0     0 38065.2707    0  303  -45.62524 38065.2707      -     -  132s
     0     0 38012.1011    0  306  -45.62524 38012.1011      -     -  143s
     0     0 38010.0748    0  310  -45.62524 38010.0748      -     -  147s
     0     0 38003.1677    0  315  -45.62524 38003.1677      -     -  151s
     0     0 37988.5400    0  319  -45.62524 37988.5400      -     -  155s
     0     0 37983.0553    0  322  -45.62524 37983.0553      -     -  158s
     0     0 37979.8786    0  317  -45.62524 37979.8786      -     -  164s
     0     0 37962.0441    0  312  -45.62524 37962.0441      -     -  171s
     0     0 37954.3004    0  300  -45.62524 37954.3004      -     -  177s
     0     0 37859.4630    0  293  -45.62524 37859.4630      -     -  187s
     0     0 37846.9743    0  308  -45.62524 37846.9743      -     -  193s
     0     0 37845.2765    0  310  -45.62524 37845.2765      -     -  195s
     0     0 37843.2325    0  312  -45.62524 37843.2325      -     -  197s
     0     0 37837.1119    0  306  -45.62524 37837.1119      -     -  199s
     0     0 37835.1986    0  304  -45.62524 37835.1986      -     -  202s
     0     0 37835.1986    0  304  -45.62524 37835.1986      -     -  202s
     0     0 34235.5959    0  323  -45.62524 34235.5959      -     -  264s
H    0     0                    1167.4324692 34235.5267  2833%     -  265s
H    0     0                    4013.0475723 34235.5267   753%     -  265s
H    0     0                    4068.0670034 34235.5267   742%     -  265s
H    0     0                    4068.3711674 34235.5267   742%     -  265s
     0     0 33698.9181    0  353 4068.37117 33698.9181   728%     -  297s
     0     0 33615.5625    0  350 4068.37117 33615.5625   726%     -  313s
     0     0 33445.1274    0  377 4068.37117 33445.1274   722%     -  337s
     0     0 33391.8217    0  381 4068.37117 33391.8217   721%     -  346s
     0     0 33331.2103    0  350 4068.37117 33331.2103   719%     -  359s
     0     0 33302.5159    0  399 4068.37117 33302.5159   719%     -  367s
     0     0 33253.8405    0  396 4068.37117 33253.8405   717%     -  377s
     0     0 33007.5233    0  380 4068.37117 33007.5233   711%     -  400s
     0     0 32970.9027    0  376 4068.37117 32970.9027   710%     -  408s
     0     0 32963.4296    0  392 4068.37117 32963.4296   710%     -  414s
     0     0 32958.1692    0  392 4068.37117 32958.1692   710%     -  418s
     0     0 32908.0811    0  393 4068.37117 32908.0811   709%     -  425s
     0     0 32892.7989    0  389 4068.37117 32892.7989   709%     -  431s
     0     0 32776.2324    0  380 4068.37117 32776.2324   706%     -  450s
     0     0 32771.3252    0  385 4068.37117 32771.3252   706%     -  453s
     0     0 32769.7430    0  382 4068.37117 32769.7430   705%     -  456s
     0     0 32768.0608    0  386 4068.37117 32768.0608   705%     -  459s
     0     0 32765.1938    0  389 4068.37117 32765.1938   705%     -  462s
     0     0 32763.9767    0  387 4068.37117 32763.9767   705%     -  464s
     0     0 30717.1773    0  370 4068.37117 30717.1773   655%     -  562s
H    0     0                    4230.2569805 30716.0471   626%     -  563s
H    0     0                    4436.7870201 30716.0471   592%     -  563s
     0     0 30088.5597    0  370 4436.78702 30088.5597   578%     -  598s
     0     0 29981.8542    0  377 4436.78702 29981.8542   576%     -  615s
     0     0 29928.8269    0  406 4436.78702 29928.8269   575%     -  627s
     0     0 29871.3913    0  402 4436.78702 29871.3913   573%     -  638s
     0     0 29856.4292    0  417 4436.78702 29856.4292   573%     -  645s
     0     0 29850.3162    0  424 4436.78702 29850.3162   573%     -  651s
     0     0 29834.1955    0  414 4436.78702 29834.1955   572%     -  656s
     0     0 29819.0815    0  410 4436.78702 29819.0815   572%     -  660s
     0     0 29809.3706    0  419 4436.78702 29809.3706   572%     -  664s
     0     0 29779.7113    0  420 4436.78702 29779.7113   571%     -  672s
     0     0 29759.8816    0  413 4436.78702 29759.8816   571%     -  679s
     0     0 29752.5034    0  417 4436.78702 29752.5034   571%     -  685s
     0     0 29750.9017    0  377 4436.78702 29750.9017   571%     -  689s
     0     0 28701.2468    0  439 4436.78702 28701.2468   547%     -  770s
H    0     0                    4518.8662321 28701.2162   535%     -  770s
H    0     0                    4969.4829688 28701.2162   478%     -  771s
H    0     0                    4969.7077610 28701.2162   478%     -  771s
H    0     0                    4977.0629781 28701.2162   477%     -  771s
     0     0 28540.6531    0  468 4977.06298 28540.6531   473%     -  803s
     0     0 28476.6331    0  389 4977.06298 28476.6331   472%     -  822s
     0     0 28432.9636    0  463 4977.06298 28432.9636   471%     -  839s
     0     0 28380.0790    0  408 4977.06298 28380.0790   470%     -  849s
     0     0 28373.9252    0  450 4977.06298 28373.9252   470%     -  854s
     0     0 28362.7247    0  383 4977.06298 28362.7247   470%     -  860s
     0     0 28352.3494    0  383 4977.06298 28352.3494   470%     -  868s
     0     0 28346.0868    0  421 4977.06298 28346.0868   470%     -  876s
     0     0 28317.1599    0  379 4977.06298 28317.1599   469%     -  884s
     0     0 28311.4393    0  431 4977.06298 28311.4393   469%     -  889s
     0     0 28305.2539    0  393 4977.06298 28305.2539   469%     -  895s
     0     0 28303.4860    0  393 4977.06298 28303.4860   469%     -  898s
     0     0 28129.0891    0  463 4977.06298 28129.0891   465%     -  933s
H    0     0                    5081.4672771 28128.9338   454%     -  934s
H    0     0                    5140.8935957 28128.9338   447%     -  934s
     0     0 28105.8597    0  521 5140.89360 28105.8597   447%     -  953s
     0     0 28098.2317    0  524 5140.89360 28098.2317   447%     -  962s
     0     0 28090.1193    0  556 5140.89360 28090.1193   446%     -  969s
     0     0 28086.3510    0  520 5140.89360 28086.3510   446%     -  975s
     0     0 28085.2888    0  533 5140.89360 28085.2888   446%     -  977s
     0     0 28004.2552    0  561 5140.89360 28004.2552   445%     -  997s
H    0     0                    5429.6923017 28000.9929   416%     -  999s
H    0     0                    5763.3869718 28000.9929   386%     - 1000s
H    0     0                    6036.2615821 28000.9929   364%     - 1000s
     0     0 27968.9188    0  544 6036.26158 27968.9188   363%     - 1013s
     0     0 27950.9478    0  505 6036.26158 27950.9478   363%     - 1027s
     0     0 27941.3326    0  512 6036.26158 27941.3326   363%     - 1034s
     0     0 27938.1423    0  518 6036.26158 27938.1423   363%     - 1039s
     0     0 27935.6979    0  460 6036.26158 27935.6979   363%     - 1044s
     0     0 27849.5426    0  453 6036.26158 27849.5426   361%     - 1072s
H    0     0                    6050.8594056 27849.3661   360%     - 1073s
H    0     0                    6101.8416328 27849.3661   356%     - 1073s
H    0     0                    6101.9955713 27849.3661   356%     - 1073s
H    0     0                    6315.5023205 27849.3661   341%     - 1073s
     0     0 27789.4567    0  451 6315.50232 27789.4567   340%     - 1091s
     0     0 27777.0958    0  453 6315.50232 27777.0958   340%     - 1099s
     0     0 27768.3123    0  457 6315.50232 27768.3123   340%     - 1105s
     0     0 27758.6517    0  417 6315.50232 27758.6517   340%     - 1114s
     0     0 27752.5366    0  462 6315.50232 27752.5366   339%     - 1119s
     0     0 27751.0687    0  460 6315.50232 27751.0687   339%     - 1122s
     0     0 27710.0986    0  481 6315.50232 27710.0986   339%     - 1137s
     0     0 27700.3050    0  486 6315.50232 27700.3050   339%     - 1148s
     0     0 27696.5370    0  464 6315.50232 27696.5370   339%     - 1152s
     0     0 27695.0217    0  470 6315.50232 27695.0217   339%     - 1155s
     0     0 27623.5706    0  502 6315.50232 27623.5706   337%     - 1172s
     0     0 27612.9492    0  509 6315.50232 27612.9492   337%     - 1182s
     0     0 27611.1434    0  507 6315.50232 27611.1434   337%     - 1186s
     0     0 27601.9879    0  503 6315.50232 27601.9879   337%     - 1194s
H    0     0                    6388.8113544 27600.9589   332%     - 1199s
H    0     0                    6400.0859330 27600.9589   331%     - 1199s
H    0     0                    6438.1305990 27600.9589   329%     - 1199s
H    0     0                    6448.1133119 27600.9589   328%     - 1199s
     0     0 27591.6423    0  455 6448.11331 27591.6423   328%     - 1210s
     0     0 27587.8592    0  424 6448.11331 27587.8592   328%     - 1215s
     0     0 27585.1897    0  458 6448.11331 27585.1897   328%     - 1219s
     0     0 27575.5850    0  496 6448.11331 27575.5850   328%     - 1232s
     0     0 27575.4204    0  496 6448.11331 27575.4204   328%     - 1237s
H    0     0                    7638.6435308 27575.3342   261%     - 1377s
H    0     0                    7647.9741192 27575.3342   261%     - 1378s
H    0     0                    7767.0044438 27575.3342   255%     - 1378s
H    0     0                    8290.0076962 27575.3342   233%     - 1378s
H    0     0                    8827.1180430 27575.3342   212%     - 1379s
H    0     0                    9061.6958761 27575.3342   204%     - 1380s
H    0     0                    9241.0331774 27575.3342   198%     - 1380s
H    0     2                    9427.9903536 27575.3342   192%     - 1385s
     0     2 27575.3342    0  496 9427.99035 27575.3342   192%     - 1385s
     1     3 27417.8711    1  425 9427.99035 27575.3342   192% 13293 1404s
     2     4 27481.2631    1  488 9427.99035 27481.2631   191% 10238 1422s
     3     7 25543.3835    2  379 9427.99035 27481.2011   191% 12638 1446s
     6    13 25411.0054    3  457 9427.99035 27481.0164   191% 11803 1475s
    12    24 26661.3463    4  500 9427.99035 27210.6669   189% 12549 1524s
    23    35 25456.1165    5  457 9427.99035 26893.4496   185% 22187 1597s
H   34    66                    9593.5786045 26661.3449   178% 19466 1770s
H   48    66                    10124.338550 26661.3449   163% 19051 1770s
    65   167 25346.7950    6  403 10124.3386 26661.3449   163% 23843 1878s
H  166   249                    10213.232848 26661.3449   161% 15190 1926s
   248   316 23569.0022   12  335 10213.2328 26661.3449   161% 13123 1965s
   315   375 24434.8761   10  378 10213.2328 26661.3449   161% 11758 1999s
H  334   375                    10219.950996 26661.3449   161% 11391 1999s
   374   431 24144.7053   11  381 10219.9510 26661.3449   161% 11028 2032s
   430   487 23768.7606   12  338 10219.9510 26661.3449   161% 10784 2062s
   486   553 22404.9483   18  320 10219.9510 26661.3449   161% 10429 2089s
   553   622 22179.4518   20  357 10219.9510 26661.3449   161% 10015 2118s
   636   665 21812.6825   23  291 10219.9510 26661.3449   161%  9519 2143s
   701   679 21481.5640   25  278 10219.9510 26661.3449   161%  9286 2168s
H  707   679                    10226.460505 26661.3449   161%  9281 2168s
H  709   679                    10465.850253 26661.3449   155%  9280 2168s
   735   713 11375.1318   26  173 10465.8503 26661.3449   155%  9305 2193s
H  811   722                    10485.721205 26661.3449   154%  9049 2217s
H  818   722                    10499.875325 26661.3449   154%  9055 2217s
H  823   722                    10550.517124 26661.3449   153%  9073 2217s
H  831   722                    10556.314063 26661.3449   153%  9087 2217s
H  837   722                    10710.175907 26661.3449   149%  9081 2217s
   846   776     cutoff   28      10710.1759 26661.3449   149%  9100 2242s
H  936   790                    10724.166104 26661.3449   149%  8944 2266s
   974   860 13092.7210   47  112 10724.1661 26661.3449   149%  8913 2293s
  1098   890 12231.7002   54   89 10724.1661 26661.3449   149%  8435 2322s
  1198   912     cutoff   58      10724.1661 26661.3449   149%  8105 2352s
  1288   976 19324.4854   33  313 10724.1661 26661.3449   149%  7933 2382s
  1388  1051 18888.1959   35  248 10724.1661 26661.3449   149%  7800 2417s
  1512  1123 18254.6351   40  248 10724.1661 26661.3449   149%  7537 2450s
  1644  1168     cutoff   43      10724.1661 26661.3449   149%  7340 2477s
H 1676  1168                    10728.570818 26661.3449   149%  7325 2477s
  1724  1234 17582.6930   43  296 10728.5708 26661.3449   149%  7259 2511s
  1853  1328 13372.8339   47  118 10728.5708 26661.3449   149%  7165 2543s
  2009  1413 11877.2084   53   93 10728.5708 26661.3449   149%  7041 2580s
  2154  1487 11056.5578   60  136 10728.5708 26661.3449   149%  6951 2617s
  2317  1621 22772.0623   13  322 10728.5708 26661.3449   149%  6783 2650s
  2511  1744 19946.8652   14  261 10728.5708 26661.3449   149%  6594 2690s
  2734  1864 19417.5715   15  270 10728.5708 26661.3449   149%  6371 2728s
  2948  1905 18912.1034   16  252 10728.5708 26661.3449   149%  6179 2771s
  3107  1926 17073.8022   19  232 10728.5708 26661.3449   149%  6135 2824s
H 3151  1895                    11191.293514 26511.7972   137%  6213 2824s
  3158  1915 11306.5048   20  224 11191.2935 26511.7972   137%  6236 2872s
  3239  1936 12275.1891   21  231 11191.2935 26511.7972   137%  6310 2922s
  3302  1962 infeasible   24      11191.2935 26511.7972   137%  6459 2967s
  3354  2005 20616.0476   14  257 11191.2935 26511.7972   137%  6560 3018s
  3427  2056 19974.7369   16  240 11191.2935 26511.7972   137%  6721 3068s
H 3431  2055                    11204.673287 26511.7931   137%  6724 3068s
H 3433  2041                    11280.797779 26511.7931   135%  6725 3068s
H 3452  2037                    11322.306786 26511.7931   134%  6772 3068s
  3500  2093 15215.4812   19  209 11322.3068 26511.7931   134%  6891 3122s
  3576  2151 14237.7223   22  154 11322.3068 26511.7931   134%  7076 3177s
H 3637  2142                    11398.431278 25591.1852   125%  7095 3177s
H 3682  2133                    11551.464365 25591.1852   122%  7195 3221s
H 3693  2075                    11751.856604 25591.1852   118%  7211 3221s
  3724  2133 12858.8509   28  163 11751.8566 25591.1316   118%  7313 3276s
H 3830  2135                    11904.889690 25591.1316   115%  7424 3330s
  3898  2158 infeasible   32      11904.8897 25591.1316   115%  7510 3405s
H 3917  2158                    11904.992342 25591.1316   115%  7555 3405s
  3935  2223 23813.1517   10  320 11904.9923 25591.1316   115%  7601 3465s
  4053  2305 22150.2719   11  325 11904.9923 25591.1316   115%  7705 3531s

Cutting planes:
  Learned: 1
  Gomory: 30
  Implied bound: 234
  MIR: 4411
  Flow cover: 3959
  Inf proof: 1
  RLT: 74
  Relax-and-lift: 784
  BQP: 2

Explored 4169 nodes (33227398 simplex iterations) in 3600.10 seconds (8977.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 11905 11904.9 11751.9 ... 10728.6

Time limit reached
Best objective 1.190499234226e+04, best bound 2.559113162697e+04, gap 114.9613%
  WARNING: Time limit reached. Using best solution found (gap: 114.96%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 11904.99, θ = 161648.30
  Upper Bound (UB) = 11904.99

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 161648.30
  [DEBUG]   ✓ Scenario 0: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 161648.30 ≤ Q = 161648.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 161648.30 ≤ Q = 161648.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 161648.30 ≤ Q = 161648.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 161648.30 ≤ Q = 161648.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 161648.30 ≤ Q = 161648.30 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 161648.30 ≤ Q = 161648.30 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 161648.30 ≤ Q = 161648.30 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x287142fe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x287142fe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.362410e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 7000309.8785
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.530498e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153049.85    0  124 7000309.88 -153049.85   102%     -    0s
H    0     0                    -117568.6667 -153049.85  30.2%     -    0s
H    0     0                    -117880.4211 -153049.85  29.8%     -    0s
H    0     0                    -122368.5945 -124390.52  1.65%     -    0s
     0     0 -124390.52    0   51 -122368.59 -124390.52  1.65%     -    0s
H    0     0                    -122711.1742 -124325.69  1.32%     -    0s
     0     0 -123830.41    0   54 -122711.17 -123830.41  0.91%     -    0s
H    0     0                    -122894.9218 -123823.53  0.76%     -    0s
     0     0 -123797.28    0   44 -122894.92 -123797.28  0.73%     -    0s
     0     0 -123489.76    0   42 -122894.92 -123489.76  0.48%     -    0s
     0     0 -123408.97    0   29 -122894.92 -123408.97  0.42%     -    0s
     0     0 -123408.97    0   41 -122894.92 -123408.97  0.42%     -    0s
     0     0 -123268.97    0   16 -122894.92 -123268.97  0.30%     -    0s
     0     0 -123266.44    0   15 -122894.92 -123266.44  0.30%     -    0s
     0     0 -123212.19    0   17 -122894.92 -123212.19  0.26%     -    0s
     0     0 -123212.15    0   18 -122894.92 -123212.15  0.26%     -    0s
H    0     0                    -123029.7201 -123212.15  0.15%     -    0s
     0     0 -123130.00    0    5 -123029.72 -123130.00  0.08%     -    0s
     0     0 -123119.90    0    2 -123029.72 -123119.90  0.07%     -    0s
     0     0 -123119.90    0   39 -123029.72 -123119.90  0.07%     -    0s
     0     0 -123109.94    0    2 -123029.72 -123109.94  0.07%     -    0s
H    0     0                    -123109.6136 -123109.75  0.00%     -    0s
     0     0 -123109.75    0    2 -123109.61 -123109.75  0.00%     -    0s

Cutting planes:
  Gomory: 5
  Implied bound: 1
  MIR: 29
  Flow cover: 8

Explored 1 nodes (713 simplex iterations) in 0.05 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -123110 -123030 -122895 ... 1.36241e+13
No other solutions better than -123110

Optimal solution found (tolerance 1.00e-06)
Best objective -1.231096136396e+05, best bound -1.231096136396e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 159247.36
  Scenario: 17 demand increases, 43 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123109.61
  [DEBUG]   S×d_nominal = 282356.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282356.97 + -123109.61 = 159247.36
  [DEBUG]   Current θ from Master = 161648.30
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2400.94 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9504.05
  Lower Bound (LB) = 9504.05
  Gap (UB-LB) = 2400.9450, Absolute Gap = 2400.9450, Relative Gap = 0.201675
  Not converged yet (gap = 2400.94 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 17 increases, 43 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740803 nonzeros
Model fingerprint: 0x5c3de4be
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 108171 rows and 43911 columns
Presolve time: 2.53s
Presolved: 153142 rows, 64429 columns, 940677 nonzeros
Variable types: 62170 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -346845.8465
Found heuristic solution: objective -219144.2901

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.43s

Barrier statistics:
 Dense cols : 691
 AA' NZ     : 7.537e+06
 Factor NZ  : 1.732e+07 (roughly 230 MB of memory)
 Factor Ops : 4.291e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.00059902e+07  2.76061875e+08  1.31e+05 1.61e+01  9.70e+04     4s
   1  -1.55895532e+07  2.49675017e+08  9.36e+04 6.74e+01  6.86e+04     5s
   2  -6.41905240e+06  1.88824231e+08  3.79e+04 6.19e+00  2.95e+04     5s
   3  -1.04813809e+06  1.51265106e+08  3.05e+03 2.26e+00  2.81e+03     5s
   4  -5.34651550e+05  6.40099799e+07  4.88e+02 5.06e-01  5.55e+02     5s
   5  -4.55051427e+05  3.79926981e+07  2.60e+02 2.37e-01  2.94e+02     5s
   6  -3.51617786e+05  2.79144223e+07  8.34e+01 1.56e-01  1.47e+02     5s
   7  -2.56882645e+05  2.04051773e+07  3.10e+01 1.06e-01  8.90e+01     5s
   8  -1.87141311e+05  1.62391136e+07  1.13e+01 8.14e-02  6.35e+01     5s
   9  -1.33776781e+05  1.12139949e+07  5.19e+00 5.47e-02  4.22e+01     5s
  10  -1.04958888e+05  6.10437475e+06  2.14e+00 2.91e-02  2.26e+01     5s
  11  -7.38500913e+04  1.03294312e+06  5.32e-01 4.49e-03  3.98e+00     5s
  12  -4.55058100e+04  3.78425356e+05  2.83e-01 1.58e-03  1.52e+00     5s
  13  -1.59515093e+04  2.26298448e+05  1.40e-01 1.10e-03  8.69e-01     5s
  14  -1.75310661e+03  1.64715319e+05  9.96e-02 1.60e-03  5.97e-01     5s
  15   8.15259451e+02  1.53636812e+05  9.33e-02 1.46e-03  5.48e-01     5s
  16   1.11161427e+04  1.19179366e+05  6.89e-02 2.43e-03  3.88e-01     5s
  17   1.51441766e+04  1.00471584e+05  5.93e-02 1.52e-03  3.06e-01     6s
  18   2.25940814e+04  8.59912460e+04  4.26e-02 1.73e-03  2.27e-01     6s
  19   2.55152157e+04  7.94754405e+04  3.62e-02 1.49e-03  1.94e-01     6s
  20   2.75271463e+04  7.30344441e+04  3.18e-02 1.33e-03  1.63e-01     6s
  21   3.06018462e+04  6.70864097e+04  2.54e-02 1.00e-03  1.31e-01     6s
  22   3.39106514e+04  6.49132268e+04  1.87e-02 9.07e-04  1.11e-01     6s
  23   3.51905261e+04  6.14038664e+04  1.62e-02 7.48e-04  9.40e-02     6s
  24   3.67319273e+04  5.73040770e+04  1.34e-02 5.65e-04  7.38e-02     6s
  25   3.73746129e+04  5.47028995e+04  1.22e-02 4.52e-04  6.22e-02     6s
  26   3.92016510e+04  5.31065204e+04  9.23e-03 3.73e-04  4.99e-02     6s
  27   4.01440837e+04  5.09235612e+04  7.79e-03 2.79e-04  3.87e-02     6s
  28   4.13509142e+04  4.99727279e+04  6.02e-03 2.27e-04  3.09e-02     6s
  29   4.22363812e+04  4.89298105e+04  4.77e-03 1.68e-04  2.40e-02     6s
  30   4.31631700e+04  4.79446806e+04  3.50e-03 1.17e-04  1.72e-02     7s
  31   4.38420050e+04  4.75219021e+04  2.61e-03 8.36e-05  1.32e-02     7s
  32   4.40578232e+04  4.73785667e+04  2.30e-03 7.64e-05  1.19e-02     7s
  33   4.41371135e+04  4.71827253e+04  2.19e-03 6.96e-05  1.09e-02     7s
  34   4.43542644e+04  4.68861780e+04  1.92e-03 5.38e-05  9.08e-03     7s
  35   4.45918990e+04  4.67612224e+04  1.61e-03 4.67e-05  7.78e-03     7s
  36   4.49631655e+04  4.63218248e+04  1.14e-03 2.90e-05  4.88e-03     7s
  37   4.52233947e+04  4.61927129e+04  8.04e-04 3.84e-05  3.48e-03     7s
  38   4.55241154e+04  4.61429608e+04  4.33e-04 3.16e-05  2.22e-03     7s
  39   4.56869986e+04  4.60547962e+04  2.37e-04 1.89e-05  1.32e-03     7s
  40   4.58133599e+04  4.60204511e+04  1.00e-04 1.40e-05  7.42e-04     7s
  41   4.58452493e+04  4.59918290e+04  6.76e-05 1.02e-05  5.25e-04     7s
  42   4.58777046e+04  4.59645469e+04  3.57e-05 6.47e-06  3.11e-04     8s
  43   4.59036740e+04  4.59424990e+04  1.09e-05 3.49e-06  1.39e-04     8s
  44   4.59109463e+04  4.59218831e+04  4.36e-06 6.89e-07  3.92e-05     8s
  45   4.59125172e+04  4.59173012e+04  3.09e-06 5.67e-08  1.72e-05     8s
  46   4.59165765e+04  4.59168122e+04  4.21e-08 8.29e-09  8.45e-07     8s
  47   4.59166862e+04  4.59167286e+04  2.15e-07 6.39e-09  1.52e-07     8s
  48   4.59167097e+04  4.59167190e+04  2.79e-07 2.86e-08  3.34e-08     8s
  49   4.59167170e+04  4.59167189e+04  4.99e-07 4.23e-09  6.96e-09     8s
  50   4.59167170e+04  4.59167189e+04  4.94e-07 4.09e-09  6.90e-09     8s
  51   4.59167185e+04  4.59167189e+04  4.50e-07 5.98e-10  1.56e-09     8s

Barrier solved model in 51 iterations and 8.31 seconds (15.65 work units)
Optimal objective 4.59167185e+04


Root crossover log...

  135732 DPushes remaining with DInf 0.0000000e+00                 8s
   41166 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   25436 PPushes remaining with PInf 1.1331164e-04                13s
     702 PPushes remaining with PInf 1.9257345e-04                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.1338579e+04     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   97404    4.5916719e+04   0.000000e+00   3.133858e+04     15s
   97970    4.5916719e+04   0.000000e+00   0.000000e+00     16s
   97970    4.5916719e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 3.25s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 4.591672e+04, 97970 iterations, 16.04 seconds (30.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45916.7189    0  219 -219144.29 45916.7189   121%     -   20s
H    0     0                    -217868.4340 45916.7189   121%     -   20s
H    0     0                    -164451.1735 45916.7189   128%     -   20s
H    0     0                    -48964.35574 45916.7189   194%     -   20s
H    0     0                    -48961.82055 45916.7189   194%     -   21s
H    0     0                    -17065.67926 45916.7189   369%     -   21s
H    0     0                    -15931.35988 45916.7189   388%     -   21s
     0     0 38812.2690    0  342 -15931.360 38812.2690   344%     -  100s
     0     0 38812.2690    0  342 -15931.360 38812.2690   344%     -  100s
H    0     0                    -14809.84874 38812.0063   362%     -  101s
H    0     0                    -13394.49809 38812.0063   390%     -  102s
H    0     0                    -12733.35749 38812.0063   405%     -  102s
H    0     0                    -12339.43361 38812.0063   415%     -  102s
H    0     0                    -5054.717622 38812.0063   868%     -  102s
     0     0 38506.5730    0  353 -5054.7176 38506.5730   862%     -  126s
     0     0 38464.8654    0  353 -5054.7176 38464.8654   861%     -  138s
     0     0 38459.3043    0  351 -5054.7176 38459.3043   861%     -  141s
     0     0 38418.6016    0  351 -5054.7176 38418.6016   860%     -  148s
     0     0 38377.3044    0  356 -5054.7176 38377.3044   859%     -  157s
     0     0 38342.3380    0  355 -5054.7176 38342.3380   859%     -  160s
     0     0 38339.3048    0  354 -5054.7176 38339.3048   858%     -  166s
     0     0 38334.2890    0  350 -5054.7176 38334.2890   858%     -  167s
     0     0 38265.4727    0  352 -5054.7176 38265.4727   857%     -  177s
     0     0 38186.5490    0  345 -5054.7176 38186.5490   855%     -  192s
     0     0 38186.3406    0  343 -5054.7176 38186.3406   855%     -  193s
     0     0 34477.4945    0  313 -5054.7176 34477.4945   782%     -  265s
H    0     0                     286.4021567 34477.3975      -     -  266s
H    0     0                     569.8295735 34477.3975  5950%     -  266s
     0     0 33722.7907    0  331  569.82957 33722.7907  5818%     -  310s
     0     0 33518.9907    0  360  569.82957 33518.9907  5782%     -  338s
     0     0 33422.5748    0  331  569.82957 33422.5748  5765%     -  358s
     0     0 33054.4923    0  393  569.82957 33054.4923  5701%     -  387s
     0     0 32983.6519    0  375  569.82957 32983.6519  5688%     -  401s
     0     0 32880.8713    0  324  569.82957 32880.8713  5670%     -  415s
     0     0 32863.8323    0  317  569.82957 32863.8323  5667%     -  426s
     0     0 32858.9263    0  321  569.82957 32858.9263  5666%     -  431s
     0     0 32814.6883    0  332  569.82957 32814.6883  5659%     -  444s
     0     0 32811.2787    0  380  569.82957 32811.2787  5658%     -  448s
     0     0 32778.2457    0  387  569.82957 32778.2457  5652%     -  459s
     0     0 32771.1143    0  383  569.82957 32771.1143  5651%     -  464s
     0     0 32754.0018    0  380  569.82957 32754.0018  5648%     -  471s
     0     0 32752.7377    0  379  569.82957 32752.7377  5648%     -  472s
     0     0 30383.5677    0  393  569.82957 30383.5677  5232%     -  572s
H    0     0                    1627.1200852 30383.3465  1767%     -  573s
H    0     0                    1636.4506736 30383.3465  1757%     -  573s
H    0     0                    1657.2415283 30383.3465  1733%     -  573s
     0     0 30008.6415    0  453 1657.24153 30008.6415  1711%     -  610s
     0     0 29803.0651    0  463 1657.24153 29803.0651  1698%     -  639s
     0     0 29754.2138    0  468 1657.24153 29754.2138  1695%     -  654s
     0     0 29717.7070    0  472 1657.24153 29717.7070  1693%     -  669s
     0     0 29680.1062    0  474 1657.24153 29680.1062  1691%     -  682s
     0     0 29667.4612    0  468 1657.24153 29667.4612  1690%     -  691s
     0     0 29657.2787    0  481 1657.24153 29657.2787  1690%     -  695s
     0     0 29643.4541    0  476 1657.24153 29643.4541  1689%     -  702s
     0     0 29611.1518    0  473 1657.24153 29611.1518  1687%     -  714s
     0     0 29605.9683    0  476 1657.24153 29605.9683  1686%     -  718s
     0     0 29599.0588    0  476 1657.24153 29599.0588  1686%     -  722s
     0     0 29583.0780    0  486 1657.24153 29583.0780  1685%     -  730s
     0     0 29575.2303    0  481 1657.24153 29575.2303  1685%     -  734s
     0     0 29570.8670    0  488 1657.24153 29570.8670  1684%     -  739s
     0     0 29537.4817    0  484 1657.24153 29537.4817  1682%     -  753s
     0     0 29507.8417    0  487 1657.24153 29507.8417  1681%     -  763s
     0     0 29497.0895    0  487 1657.24153 29497.0895  1680%     -  768s
     0     0 29494.7724    0  489 1657.24153 29494.7724  1680%     -  770s
     0     0 29493.7977    0  484 1657.24153 29493.7977  1680%     -  772s
     0     0 28776.7907    0  393 1657.24153 28776.7907  1636%     -  835s
H    0     0                    3757.6752007 28776.7427   666%     -  836s
H    0     0                    4399.4939525 28776.7427   554%     -  836s
H    0     0                    4865.8155200 28776.7427   491%     -  836s
     0     0 28619.9991    0  382 4865.81552 28619.9991   488%     -  854s
     0     0 28490.7024    0  396 4865.81552 28490.7024   486%     -  878s
     0     0 28430.5745    0  442 4865.81552 28430.5745   484%     -  892s
     0     0 28410.7806    0  456 4865.81552 28410.7806   484%     -  905s
     0     0 28402.3868    0  470 4865.81552 28402.3868   484%     -  914s
     0     0 28398.8644    0  466 4865.81552 28398.8644   484%     -  917s
     0     0 28394.0736    0  463 4865.81552 28394.0736   484%     -  920s
     0     0 28373.0898    0  449 4865.81552 28373.0898   483%     -  929s
     0     0 28369.9320    0  403 4865.81552 28369.9320   483%     -  933s
     0     0 28368.8930    0  402 4865.81552 28368.8930   483%     -  938s
     0     0 28224.0005    0  436 4865.81552 28224.0005   480%     -  965s
     0     0 28165.9265    0  466 4865.81552 28165.9265   479%     -  982s
     0     0 28130.8688    0  514 4865.81552 28130.8688   478%     -  999s
     0     0 28113.4341    0  458 4865.81552 28113.4341   478%     - 1009s
     0     0 28101.3130    0  461 4865.81552 28101.3130   478%     - 1018s
     0     0 28094.0007    0  494 4865.81552 28094.0007   477%     - 1026s
     0     0 28091.1942    0  454 4865.81552 28091.1942   477%     - 1028s
     0     0 28088.6930    0  462 4865.81552 28088.6930   477%     - 1031s
     0     0 27952.4746    0  404 4865.81552 27952.4746   474%     - 1066s
H    0     0                    6270.7723423 27952.2614   346%     - 1071s
H    0     0                    7598.5050825 27952.2614   268%     - 1071s
H    0     0                    7664.8082081 27952.2614   265%     - 1071s
     0     0 27891.0038    0  466 7664.80821 27891.0038   264%     - 1090s
     0     0 27868.0790    0  405 7664.80821 27868.0790   264%     - 1100s
     0     0 27855.8125    0  452 7664.80821 27855.8125   263%     - 1109s
     0     0 27854.3487    0  403 7664.80821 27854.3487   263%     - 1112s
     0     0 27791.1914    0  427 7664.80821 27791.1914   263%     - 1126s
H    0     0                    7671.7903193 27790.4045   262%     - 1126s
     0     0 27773.0197    0  433 7671.79032 27773.0197   262%     - 1132s
     0     0 27763.8407    0  442 7671.79032 27763.8407   262%     - 1139s
     0     0 27760.2457    0  456 7671.79032 27760.2457   262%     - 1144s
     0     0 27757.2554    0  456 7671.79032 27757.2554   262%     - 1148s
     0     0 27755.6803    0  464 7671.79032 27755.6803   262%     - 1150s
     0     0 27731.1389    0  402 7671.79032 27731.1389   261%     - 1158s
H    0     0                    7672.6750681 27727.8361   261%     - 1160s
H    0     0                    7679.3932156 27727.8361   261%     - 1160s
     0     0 27719.1146    0  342 7679.39322 27719.1146   261%     - 1164s
     0     0 27711.5653    0  435 7679.39322 27711.5653   261%     - 1168s
     0     0 27707.8922    0  473 7679.39322 27707.8922   261%     - 1172s
     0     0 27705.6685    0  440 7679.39322 27705.6685   261%     - 1176s
     0     0 27671.5305    0  475 7679.39322 27671.5305   260%     - 1190s
H    0     0                    8066.2609740 27670.9153   243%     - 1190s
H    0     0                    8085.1542906 27670.9153   242%     - 1191s
     0     0 27657.1211    0  401 8085.15429 27657.1211   242%     - 1196s
     0     0 27652.8419    0  496 8085.15429 27652.8419   242%     - 1201s
     0     0 27646.8708    0  479 8085.15429 27646.8708   242%     - 1207s
     0     0 27645.5448    0  399 8085.15429 27645.5448   242%     - 1210s
     0     0 27631.5040    0  405 8085.15429 27631.5040   242%     - 1218s
     0     0 27628.4733    0  406 8085.15429 27628.4733   242%     - 1222s
     0     0 27625.7976    0  404 8085.15429 27625.7976   242%     - 1225s
     0     0 27613.8239    0  441 8085.15429 27613.8239   242%     - 1231s
H    0     0                    8124.8392295 27613.4381   240%     - 1232s
     0     0 27610.1593    0  450 8124.83923 27610.1593   240%     - 1234s
     0     0 27605.3342    0  403 8124.83923 27605.3342   240%     - 1236s
     0     0 27604.4985    0  415 8124.83923 27604.4985   240%     - 1237s
     0     0 27598.8775    0  385 8124.83923 27598.8775   240%     - 1243s
     0     0 27598.6622    0  385 8124.83923 27598.6622   240%     - 1249s
H    0     0                    8236.1711266 27598.0143   235%     - 1438s
H    0     0                    9345.9829204 27598.0143   195%     - 1438s
H    0     0                    9415.2245356 27598.0143   193%     - 1456s
H    0     0                    9426.3027013 27598.0143   193%     - 1458s
H    0     2                    9433.0208489 27598.0143   193%     - 1472s
     0     2 27598.0143    0  385 9433.02085 27598.0143   193%     - 1472s
     1     3 26493.6705    1  438 9433.02085 27598.0143   193% 16600 1495s
     2     6 26152.4740    2  390 9433.02085 27598.0143   193% 16482 1517s
     5    12 25891.7891    3  423 9433.02085 27453.4464   191% 14250 1550s
    11    24 25487.9692    4  414 9433.02085 27277.1826   189% 17512 1597s
    23    36 26466.0615    4  464 9433.02085 27183.9257   188% 26288 3486s
    35    60 25541.5612    5  323 9433.02085 27183.9257   188% 30558 3600s

Cutting planes:
  Learned: 1
  Gomory: 13
  Implied bound: 272
  MIR: 3603
  Flow cover: 3338
  RLT: 73
  Relax-and-lift: 824

Explored 59 nodes (2374160 simplex iterations) in 3600.14 seconds (6604.42 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9433.02 9426.3 9415.22 ... 7672.68

Time limit reached
Best objective 9.433020848850e+03, best bound 2.718392574587e+04, gap 188.1784%
  WARNING: Time limit reached. Using best solution found (gap: 188.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.16s
  Master Objective (UB) = 9433.02, θ = 156511.79
  Upper Bound (UB) = 9433.02

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 156511.79
  [DEBUG]   ✓ Scenario 0: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 156511.79 ≤ Q = 156511.79 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 156511.79 ≤ Q = 156511.79 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x329133a9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x329133a9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.309585e+13
Presolve removed 2556 rows and 1848 columns
Presolve time: 0.00s
Presolved: 537 rows, 541 columns, 1515 nonzeros
Found heuristic solution: objective 6595377.8057
Variable types: 367 continuous, 174 integer (174 binary)

Root relaxation: objective -1.586202e+05, 257 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -158620.17    0  125 6595377.81 -158620.17   102%     -    0s
H    0     0                    -123027.9512 -158620.17  28.9%     -    0s
H    0     0                    -123195.8526 -158620.17  28.8%     -    0s
     0     0 -138398.93    0   92 -123195.85 -138398.93  12.3%     -    0s
H    0     0                    -134241.8538 -138307.72  3.03%     -    0s
H    0     0                    -134568.9900 -138307.72  2.78%     -    0s
H    0     0                    -134848.8019 -138307.72  2.57%     -    0s
H    0     0                    -135175.9381 -138307.72  2.32%     -    0s
     0     0 -136884.76    0   93 -135175.94 -136884.76  1.26%     -    0s
H    0     0                    -135411.4507 -136820.99  1.04%     -    0s
     0     0 -136820.99    0   92 -135411.45 -136820.99  1.04%     -    0s
H    0     0                    -135606.3235 -136820.99  0.90%     -    0s
     0     0 -136432.93    0   65 -135606.32 -136432.93  0.61%     -    0s
     0     0 -136405.54    0   59 -135606.32 -136405.54  0.59%     -    0s
     0     0 -136401.76    0   59 -135606.32 -136401.76  0.59%     -    0s
     0     0 -136116.85    0   34 -135606.32 -136116.85  0.38%     -    0s
     0     0 -136049.77    0   50 -135606.32 -136049.77  0.33%     -    0s
     0     0 -136049.30    0   50 -135606.32 -136049.30  0.33%     -    0s
     0     0 -135988.63    0   29 -135606.32 -135988.63  0.28%     -    0s
H    0     0                    -135640.3464 -135977.07  0.25%     -    0s
     0     0 -135968.27    0   29 -135640.35 -135968.27  0.24%     -    0s
     0     0 -135950.21    0   31 -135640.35 -135950.21  0.23%     -    0s
     0     0 -135938.63    0   30 -135640.35 -135938.63  0.22%     -    0s
     0     0 -135938.63    0   30 -135640.35 -135938.63  0.22%     -    0s
     0     0 -135938.63    0   58 -135640.35 -135938.63  0.22%     -    0s
     0     0 -135938.63    0   40 -135640.35 -135938.63  0.22%     -    0s
H    0     0                    -135672.5664 -135938.63  0.20%     -    0s
H    0     0                    -135698.9493 -135899.55  0.15%     -    0s
     0     0 -135885.29    0   22 -135698.95 -135885.29  0.14%     -    0s
     0     0 -135884.87    0   19 -135698.95 -135884.87  0.14%     -    0s
     0     0 -135884.35    0   17 -135698.95 -135884.35  0.14%     -    0s
     0     0 -135880.80    0   13 -135698.95 -135880.80  0.13%     -    0s
     0     0 -135873.97    0   10 -135698.95 -135873.97  0.13%     -    0s
     0     0 -135870.91    0   11 -135698.95 -135870.91  0.13%     -    0s
     0     0 -135736.63    0    5 -135698.95 -135736.63  0.03%     -    0s
     0     0 -135736.63    0    9 -135698.95 -135736.63  0.03%     -    0s
H    0     0                    -135699.7410 -135736.63  0.03%     -    0s
H    0     0                    -135731.7375 -135736.63  0.00%     -    0s
     0     0 -135735.66    0    2 -135731.74 -135735.66  0.00%     -    0s
H    0     0                    -135735.3982 -135735.63  0.00%     -    0s
     0     0     cutoff    0      -135735.40 -135735.40  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 3
  Flow cover: 2
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (1150 simplex iterations) in 0.10 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -135735 -135732 -135700 ... -134849
No other solutions better than -135735

Optimal solution found (tolerance 1.00e-06)
Best objective -1.357353981656e+05, best bound -1.357353981656e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 146627.24
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135735.40
  [DEBUG]   S×d_nominal = 282362.64
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 282362.64 + -135735.40 = 146627.24
  [DEBUG]   Current θ from Master = 156511.79
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9884.55 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -451.53
  Lower Bound (LB) = 9504.05
  Gap (UB-LB) = -71.0265, Absolute Gap = 71.0265, Relative Gap = -0.007530
  *** CONVERGED (small negative gap: -71.03 within tolerance ε=200) ***
  Note: Negative gap likely due to numerical precision or solver tolerance

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 17
Total Time: 47152.27s
Converged: True
Final Lower Bound: 9504.0473
Final Upper Bound: 9433.0208
Final Gap: -71.026498
Number of Critical Scenarios: 17
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [2] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 5, 8, 9] (4/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 9 customers  Mode 1: 1 customers  Mode 2: 40 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 17
Start Time: 2026-01-03 12:05:01
End Time: 2026-01-04 01:10:53
Total Time: 47152.27s
Optimal Value: 9504.05
Lower Bound: 9504.05
Upper Bound: 9433.02
Gap: -71.026498
Plants Opened: {0: [1], 1: [2], 2: [2]} (3 plants)
DCs Opened: [2, 5, 8, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed24_Mixed_gamma20_20260104_011054.csv

Total Execution Time: 47152.62 seconds
End Time: 2026-01-04 01:10:54

All tasks completed successfully!

