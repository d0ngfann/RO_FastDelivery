
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 21
DI Scenario: LD
Start Time: 2026-01-03 10:51:25
================================================================================
Loading data from data/DH_data_full_seed21.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.105', '1.221'] (k=0.246)
  Product 1: ['1.000', '1.060', '1.123'] (k=0.143)
  Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1719
  DC capacity (MC): min=431, max=842

Demand Structure (s_rk matrix):
  Total customer-product pairs: 84/150 (44.0% sparse)
  Average products per customer: 1.68

Demand (only non-zero entries):
  Nominal (μ): min=8.24, max=34.94, count=84
  Deviation (μ̂): min=4.05, max=9.88

Costs:
  Plant fixed cost: min=5672, max=9774
  DC fixed cost: min=3426, max=5483
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
    Product 1: ['1.000', '1.474', '2.173'] (k=0.957)
    Product 2: ['1.000', '1.444', '2.085'] (k=0.906)
  MD:
    Product 0: ['1.000', '1.180', '1.392'] (k=0.408)
    Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
    Product 2: ['1.000', '1.175', '1.380'] (k=0.398)
  LD:
    Product 0: ['1.000', '1.105', '1.221'] (k=0.246)
    Product 1: ['1.000', '1.060', '1.123'] (k=0.143)
    Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
  Mixed:
    Product 0: ['1.000', '1.440', '2.075'] (k=0.900)
    Product 1: ['1.000', '1.288', '1.660'] (k=0.625)
    Product 2: ['1.000', '1.022', '1.044'] (k=0.053)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48762 nonzeros
Model fingerprint: 0xdc706e37
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11707 rows and 2707 columns
Presolve time: 0.08s
Presolved: 4966 rows, 5793 columns, 34451 nonzeros
Variable types: 3534 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -296323.7635
Found heuristic solution: objective -193271.6795

Root relaxation: objective 6.736945e+04, 5141 iterations, 0.21 seconds (0.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 67369.4508    0  963 -193271.68 67369.4508   135%     -    0s
H    0     0                    -186820.9039 67369.4508   136%     -    0s
H    0     0                    -185360.0194 63258.2322   134%     -    1s
     0     0 63258.2322    0 1029 -185360.02 63258.2322   134%     -    1s
H    0     0                    -185284.1744 63256.8239   134%     -    1s
     0     0 63164.5741    0 1042 -185284.17 63164.5741   134%     -    1s
     0     0 63154.5484    0 1042 -185284.17 63154.5484   134%     -    1s
     0     0 63154.5242    0 1043 -185284.17 63154.5242   134%     -    1s
H    0     0                    -182409.9200 60516.5520   133%     -    2s
     0     0 59479.8522    0 1175 -182409.92 59479.8522   133%     -    2s
H    0     0                    -155226.5293 59479.8522   138%     -    2s
H    0     0                    -155168.6040 59479.8522   138%     -    2s
H    0     0                    -155130.7820 59479.8522   138%     -    2s
     0     0 59333.1645    0 1181 -155130.78 59333.1645   138%     -    2s
     0     0 59234.5242    0 1184 -155130.78 59234.5242   138%     -    2s
     0     0 59234.5242    0 1184 -155130.78 59234.5242   138%     -    2s
H    0     0                    -105925.1782 56448.5987   153%     -    4s
H    0     0                    -35411.59125 56448.5987   259%     -    4s
H    0     0                    -33717.44647 56448.5987   267%     -    4s
H    0     0                    -33547.40241 56448.5987   268%     -    4s
H    0     0                    -32296.60472 56448.5987   275%     -    4s
H    0     0                    -31237.96704 56448.5987   281%     -    4s
     0     0 56448.5987    0 1304 -31237.967 56448.5987   281%     -    4s
     0     0 56448.5987    0 1304 -31237.967 56448.5987   281%     -    4s
     0     2 56448.5987    0 1304 -31237.967 56448.5987   281%     -    5s
    31    64 55766.1676    5 1172 -31237.967 56150.8823   280%  2431   10s
H  339   364                    -18618.18572 55764.4255   400%   834   12s
H  359   364                    -16620.54402 55764.4255   436%   820   12s
H  487   510                    -12431.65226 55764.4255   549%   717   12s
H  492   510                    -9436.091779 55764.4255   691%   715   12s
H  495   510                    -5158.038208 55764.4255  1181%   714   12s
H  498   510                    -3401.439722 55764.4255  1739%   712   12s
H  518   620                    -3381.760896 55764.4255  1749%   699   13s
H  523   620                    -3208.388238 55764.4255  1838%   695   13s
H  528   620                    -2710.342268 55764.4255  2157%   691   13s
H  544   620                    -2040.024676 55764.4255  2834%   682   13s
H  674   681                    2743.8619903 55714.2393  1931%   606   13s
H  679   681                    7910.7435473 55714.2393   604%   603   13s
H  842   920                    8689.9212757 55581.0755   540%   536   14s
H  848   920                    10126.292922 55581.0755   449%   533   14s
H  909   920                    10748.187639 55581.0755   417%   507   14s
H  992   920                    10915.547900 55581.0755   409%   479   14s
   998  1062 27569.9962   25  326 10915.5479 55581.0755   409%   477   15s
H 1162  1217                    11142.186128 55523.3309   398%   437   16s
H 1170  1217                    11216.471116 55523.3309   395%   434   16s
H 1172  1217                    12238.733407 55523.3309   354%   433   16s
H 1223  1217                    12334.898457 55523.3309   350%   420   16s
H 1265  1217                    12377.613200 55523.3309   349%   411   16s
H 1537  1548                    13008.757105 55113.3432   324%   369   17s
H 1555  1548                    13384.948153 55113.3432   312%   368   17s
H 1650  1548                    13562.210594 55113.3432   306%   355   17s
H 1964  2002                    13566.424750 55025.0578   306%   320   17s
H 1975  2002                    13832.378459 55025.0578   298%   319   17s
H 2020  2002                    13881.308990 55025.0578   296%   313   17s
H 2143  2002                    13929.412484 55025.0578   295%   301   17s
H 2173  2002                    14488.137672 55025.0578   280%   298   17s
H 2244  2090                    15180.016099 55025.0578   262%   291   18s
  2810  2477 50599.6562    8  677 15180.0161 54520.6924   259%   257   20s
H 2930  2471                    15222.171760 54047.2681   255%   252   20s
H 3287  2757                    15230.551102 54047.2681   255%   236   24s
H 3287  2757                    15235.585827 54047.2681   255%   236   24s
H 3287  2752                    15339.567076 54047.2681   252%   236   24s
H 3287  2697                    15997.840402 54047.2681   238%   236   24s
H 3287  2697                    16026.272943 54047.2681   237%   236   24s
H 3287  2621                    16755.671537 54047.2681   223%   236   25s
H 3287  2553                    17368.178752 54047.2681   211%   236   25s
  3291  2543 19780.6036   67  526 17368.1788 34267.2284  97.3%   236   30s
  3314  2558 20004.7207   63  649 17368.1788 28002.3954  61.2%   234   35s
H 3316  2431                    17399.478496 27920.1953  60.5%   234   35s
H 3316  2309                    17412.328730 27920.1953  60.3%   234   35s
H 3316  2193                    17414.466025 27920.1953  60.3%   234   35s
  3350  2247 25868.0268   15  398 17414.4660 27068.2255  55.4%   246   40s
H 3580  2181                    20022.100187 26005.0674  29.9%   253   41s
H 3991  1935                    20046.777247 24712.0072  23.3%   249   42s
H 3992  1835                    20219.939216 24712.0072  22.2%   249   42s
H 3994  1740                    20551.716558 24712.0072  20.2%   248   42s
H 3997  1649                    20654.352851 24712.0072  19.6%   248   42s
H 4026  1554                    20664.429753 24712.0072  19.6%   247   42s
H 4156  1365                    20681.138763 24712.0072  19.5%   246   43s
H 4159  1287                    20688.132491 24712.0072  19.5%   246   43s
H 4195  1202                    20700.925804 24712.0072  19.4%   245   43s
H 4308  1021                    20707.919532 23642.5450  14.2%   242   43s
H 4310   954                    20729.692070 23642.5450  14.1%   242   43s
H 4485   921                    20759.380375 22550.4723  8.63%   235   44s
H 4702   792                    20765.518512 20851.3334  0.41%   226   44s
H 4776   710                    20773.524931 20851.3334  0.37%   223   44s
H 4916   577                    20775.488910 20851.3334  0.37%   217   44s
* 4930   522              48    20781.209754 20834.5114  0.26%   217   44s
* 4941   470              48    20784.333257 20829.9763  0.22%   216   44s
H 5174   346                    20784.948925 20829.8876  0.22%   208   44s
* 5304   225              50    20788.237262 20829.8876  0.20%   203   44s
* 5418   145              49    20792.964515 20815.0920  0.11%   199   44s

Cutting planes:
  Implied bound: 1
  Projected implied bound: 154
  MIR: 225
  Flow cover: 568
  Inf proof: 1
  Zero half: 4
  RLT: 45
  Relax-and-lift: 159

Explored 5539 nodes (1101422 simplex iterations) in 44.39 seconds (92.46 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 20793 20788.2 20784.9 ... 20729.7

Optimal solution found (tolerance 1.00e-06)
Best objective 2.079296451503e+04, best bound 2.079296451503e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 44.39s
  Master Objective (UB) = 20792.96, θ = 150885.42
  Upper Bound (UB) = 20792.96

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150885.42
  [DEBUG]   ✓ Scenario 0: θ = 150885.42 ≤ Q = 150885.42 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4451df54
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4451df54
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.236211e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6702244.6041
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.121258e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -112125.83    0  121 6702244.60 -112125.83   102%     -    0s
H    0     0                    -77690.91868 -112125.83  44.3%     -    0s
H    0     0                    -79205.94317 -112125.83  41.6%     -    0s
H    0     0                    -81359.10700 -81359.107  0.00%     -    0s
     0     0          -    0      -81359.107 -81359.107  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 205

Explored 1 nodes (382 simplex iterations) in 0.01 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -81359.1 -79205.9 -77690.9 ... 1.23621e+13
No other solutions better than -81359.1

Optimal solution found (tolerance 1.00e-06)
Best objective -8.135910700219e+04, best bound -8.135910700219e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 117073.74
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -81359.11
  [DEBUG]   S×d_nominal = 198432.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 198432.85 + -81359.11 = 117073.74
  [DEBUG]   Current θ from Master = 150885.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33811.68 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13018.71
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 33811.6784, Absolute Gap = 33811.6784, Relative Gap = 1.626111
  Not converged yet (gap = 33811.68 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92005 nonzeros
Model fingerprint: 0x4a3bb9f0
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -13018.7 (0.01s)
Loaded MIP start from previous solve with objective -13018.7

Presolve removed 13363 rows and 5422 columns
Presolve time: 0.32s
Presolved: 18600 rows, 9318 columns, 103068 nonzeros
Variable types: 7059 continuous, 2259 integer (2259 binary)

Root relaxation: objective 2.183479e+04, 10459 iterations, 1.65 seconds (3.45 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 21834.7948    0  435 -13018.714 21834.7948   268%     -    2s
H    0     0                    -11608.62426 21834.7948   288%     -    2s
H    0     0                    -11598.96363 21834.7948   288%     -    2s
H    0     0                    -11597.79507 21834.7948   288%     -    2s
     0     0 15722.9663    0  734 -11597.795 15722.9663   236%     -    3s
     0     0 15303.2481    0  647 -11597.795 15303.2481   232%     -    4s
     0     0 15303.0197    0  705 -11597.795 15303.0197   232%     -    4s
     0     0 10217.3755    0  859 -11597.795 10217.3755   188%     -    6s
H    0     0                    -11557.07745 10216.8464   188%     -    6s
H    0     0                    -11330.51608 9661.60643   185%     -    7s
H    0     0                    -11318.52737 9661.60643   185%     -    7s
     0     0 9661.60643    0  878 -11318.527 9661.60643   185%     -    7s
     0     0 9595.16733    0  883 -11318.527 9595.16733   185%     -    7s
     0     0 9592.23045    0  888 -11318.527 9592.23045   185%     -    7s
     0     0 9592.18008    0  889 -11318.527 9592.18008   185%     -    7s
H    0     0                    -11247.19452 9592.18008   185%     -    9s
H    0     0                    -11227.01893 9592.18008   185%     -    9s
H    0     0                    -10883.03810 5809.08985   153%     -   11s
H    0     0                    -10881.87858 5809.08985   153%     -   11s
     0     0 5809.08985    0  770 -10881.879 5809.08985   153%     -   11s
H    0     0                    -10814.74996 5808.87166   154%     -   11s
H    0     0                    -10755.35881 5808.87166   154%     -   11s
H    0     0                    -10754.19928 5808.87166   154%     -   11s
     0     0 5298.02246    0  934 -10754.199 5298.02246   149%     -   13s
     0     0 5175.72584    0  851 -10754.199 5175.72584   148%     -   13s
     0     0 5167.03839    0  861 -10754.199 5167.03839   148%     -   14s
     0     0 5166.42062    0  849 -10754.199 5166.42062   148%     -   14s
     0     0 3411.19016    0  763 -10754.199 3411.19016   132%     -   18s
     0     0 3127.01693    0  834 -10754.199 3127.01693   129%     -   19s
     0     0 3054.20955    0  824 -10754.199 3054.20955   128%     -   19s
     0     0 3030.12837    0  835 -10754.199 3030.12837   128%     -   20s
     0     0 3027.05646    0  842 -10754.199 3027.05646   128%     -   20s
     0     0 2353.41234    0  798 -10754.199 2353.41234   122%     -   22s
     0     0 2225.67969    0  678 -10754.199 2225.67969   121%     -   23s
     0     0 2185.62935    0  824 -10754.199 2185.62935   120%     -   24s
     0     0 2179.83880    0  694 -10754.199 2179.83880   120%     -   24s
     0     0 1945.74527    0  643 -10754.199 1945.74527   118%     -   26s
H    0     0                    -10414.51676 1945.63343   119%     -   26s
H    0     0                    -10381.69610 1945.63343   119%     -   26s
H    0     0                    -10320.09616 1945.63343   119%     -   26s
H    0     0                    -10318.72968 1945.63343   119%     -   26s
     0     0 1901.70918    0  685 -10318.730 1901.70918   118%     -   27s
     0     0 1885.06562    0  691 -10318.730 1885.06562   118%     -   27s
     0     0 1882.42643    0  696 -10318.730 1882.42643   118%     -   28s
     0     0 1679.06301    0  802 -10318.730 1679.06301   116%     -   29s
H    0     0                    -10282.00297 1678.66901   116%     -   29s
H    0     0                    -10274.39352 1678.66901   116%     -   29s
H    0     0                    -10238.19408 1678.66901   116%     -   29s
     0     0 1645.78343    0  819 -10238.194 1645.78343   116%     -   30s
     0     0 1633.57056    0  829 -10238.194 1633.57056   116%     -   30s
     0     0 1629.19294    0  832 -10238.194 1629.19294   116%     -   30s
     0     0 1530.24940    0  680 -10238.194 1530.24940   115%     -   32s
     0     0 1499.79362    0  693 -10238.194 1499.79362   115%     -   33s
     0     0 1495.84287    0  693 -10238.194 1495.84287   115%     -   33s
     0     0 1458.73155    0  664 -10238.194 1458.73155   114%     -   34s
H    0     0                    -9932.086111 1458.69869   115%     -   34s
H    0     0                    -9762.667772 1458.69869   115%     -   34s
H    0     0                    -9754.286450 1458.69869   115%     -   34s
     0     0 1438.99150    0  676 -9754.2864 1438.99150   115%     -   34s
     0     0 1435.63560    0  687 -9754.2864 1435.63560   115%     -   34s
     0     0 1397.78312    0  678 -9754.2864 1397.78312   114%     -   35s
     0     0 1397.69702    0  678 -9754.2864 1397.69702   114%     -   36s
H    0     0                    -9719.502583 1397.50786   114%     -   42s
H    0     0                    -9646.682743 1397.50786   114%     -   42s
H    0     0                    -9639.413101 1397.50786   114%     -   42s
     0     2 1397.50786    0  678 -9639.4131 1397.50786   114%     -   42s
     3     8  758.14694    2  528 -9639.4131 1290.05400   113%  1773   45s
H   31    64                    -9623.733203  578.89966   106%  1124   49s
H   33    64                    -9154.611363  578.89966   106%  1101   49s
    95   138 -701.54491    7  516 -9154.6114  556.51071   106%   867   51s
H  181   189                    -9154.163583  556.51071   106%   738   52s
H  213   219                    -9110.917291  556.51071   106%   737   53s
   226   280 -5250.7882    9  403 -9110.9173  556.51071   106%   735   55s
   616   592 -3247.3511   21  255 -9110.9173  472.15473   105%   574   60s
   968   855 -4664.9488   25  325 -9110.9173  174.64604   102%   480   65s
H 1063   887                    -9110.761563  174.64604   102%   469   65s
  1556  1226 -3988.5445    8  511 -9110.7616   33.26294   100%   407   70s
H 1560  1226                    -9106.255306   33.26294   100%   406   70s
H 1578  1226                    -9102.006108   33.26294   100%   407   70s
H 1585  1226                    -8496.011432   33.26294   100%   407   70s
H 1862  1521                    -8192.686855  -17.26322   100%   391   74s
H 1897  1521                    -8087.429341  -17.26322   100%   390   74s
H 1900  1521                    -7969.660826  -17.26322   100%   390   74s
  2005  1596     cutoff   13      -7969.6608  -17.26322   100%   384   75s
H 2214  1614                    -7437.714537  -82.92479  98.9%   376   76s
  2386  1731 -2726.2569   13  333 -7437.7145 -260.05620  96.5%   374   80s
  2859  1772     cutoff   18      -7437.7145 -306.76701  95.9%   375   85s
H 3227  1742                    -6722.913584 -528.72815  92.1%   371   89s
H 3260  1742                    -6693.450356 -528.72815  92.1%   372   89s
  3268  1791 -5448.1948   19  290 -6693.4504 -528.72815  92.1%   373   90s
H 3478  1728                    -6681.512706 -528.72815  92.1%   369   92s
H 3509  1728                    -6681.453247 -528.72815  92.1%   372   92s
  3699  1912 -4459.7183   13  223 -6681.4532 -528.72815  92.1%   374   96s
  4097  2011 -2903.8430   11  278 -6681.4532 -689.51740  89.7%   374  100s
  4545  2236 -6577.9944   44  678 -6681.4532 -799.93951  88.0%   364  125s
  4548  2238 -5808.9367   28  639 -6681.4532 -799.93951  88.0%   364  130s
  4552  2241 -3523.1059   31  714 -6681.4532 -799.93951  88.0%   364  135s
  4557  2244 -5384.0252   21  665 -6681.4532 -799.93951  88.0%   363  140s
  4563  2248 -5453.4889   51  694 -6681.4532 -799.93951  88.0%   363  145s
  4567  2251 -3242.2066    9  696 -6681.4532 -799.93951  88.0%   362  150s
  4571  2253 -4730.3536   38  706 -6681.4532 -799.93951  88.0%   362  155s
  4574  2255 -5871.6454   23  698 -6681.4532 -799.93951  88.0%   362  160s
  4576  2260 -799.93951   14  701 -6681.4532 -799.93951  88.0%   373  166s
  4582  2264 -1907.1222   16  688 -6681.4532 -799.93951  88.0%   375  171s
  4598  2288 -2840.0839   18  613 -6681.4532 -1054.6231  84.2%   382  176s
  4739  2338 -3539.7140   22  327 -6681.4532 -1927.1294  71.2%   405  180s
  4991  2269     cutoff   24      -6681.4532 -2305.8410  65.5%   418  185s
  5300  2150 -6596.7147   36   66 -6681.4532 -2511.5616  62.4%   423  190s
  5654  1951 -5349.8283   24  237 -6681.4532 -4233.1254  36.6%   420  195s
H 5789  1823                    -6677.218196 -5461.8294  18.2%   412  196s
H 6237  1670                    -6674.151068 -5582.7021  16.4%   383  197s
H 6248  1563                    -6665.577222 -5582.7021  16.2%   383  197s

Cutting planes:
  MIR: 347
  Flow cover: 801
  Zero half: 18
  RLT: 16
  Relax-and-lift: 60

Explored 7367 nodes (2463784 simplex iterations) in 198.32 seconds (426.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -6665.58 -6674.15 -6681.45 ... -8192.69
No other solutions better than -6665.58

Optimal solution found (tolerance 1.00e-06)
Best objective -6.665577222482e+03, best bound -6.665577222482e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 198.33s
  Master Objective (UB) = -6665.58, θ = 109035.09
  Upper Bound (UB) = -6665.58

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 109035.09
  [DEBUG]   ✓ Scenario 0: θ = 109035.09 ≤ Q = 109035.09 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 109035.09 ≤ Q = 109035.09 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x49a9bfbe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x49a9bfbe
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.426517e+13
Presolve removed 2580 rows and 1874 columns
Presolve time: 0.00s
Presolved: 513 rows, 515 columns, 1446 nonzeros
Found heuristic solution: objective 8131001.1509
Variable types: 347 continuous, 168 integer (168 binary)

Root relaxation: objective -1.171451e+05, 256 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117145.09    0  126 8131001.15 -117145.09   101%     -    0s
H    0     0                    -78694.73003 -117145.09  48.9%     -    0s
H    0     0                    -81460.96699 -117145.09  43.8%     -    0s
H    0     0                    -91604.85599 -117145.09  27.9%     -    0s
     0     0 -102956.86    0   57 -91604.856 -102956.86  12.4%     -    0s
H    0     0                    -101253.0561 -102868.29  1.60%     -    0s
     0     0 -102633.06    0   55 -101253.06 -102633.06  1.36%     -    0s
     0     0 -102615.82    0   55 -101253.06 -102615.82  1.35%     -    0s
     0     0 -102322.68    0   19 -101253.06 -102322.68  1.06%     -    0s
H    0     0                    -101834.9681 -102306.76  0.46%     -    0s
     0     0 -102179.47    0   21 -101834.97 -102179.47  0.34%     -    0s
     0     0 -102174.82    0   19 -101834.97 -102174.82  0.33%     -    0s
     0     0 -102120.43    0   23 -101834.97 -102120.43  0.28%     -    0s
     0     0 -102120.09    0   23 -101834.97 -102120.09  0.28%     -    0s
H    0     0                    -101974.9983 -102120.09  0.14%     -    0s
     0     0 -102105.60    0    6 -101975.00 -102105.60  0.13%     -    0s
     0     0 -102105.60    0   23 -101975.00 -102105.60  0.13%     -    0s
     0     0 -102105.60    0   23 -101975.00 -102105.60  0.13%     -    0s
     0     0 -102105.60    0   22 -101975.00 -102105.60  0.13%     -    0s
     0     0 -102056.21    0   11 -101975.00 -102056.21  0.08%     -    0s
H    0     0                    -101975.1471 -102052.14  0.08%     -    0s
     0     0 -102047.30    0    8 -101975.15 -102047.30  0.07%     -    0s
     0     0 -102037.13    0    7 -101975.15 -102037.13  0.06%     -    0s
H    0     0                    -102019.4799 -102032.79  0.01%     -    0s
H    0     0                    -102031.6271 -102032.79  0.00%     -    0s
     0     0 -102032.55    0    3 -102031.63 -102032.55  0.00%     -    0s
     0     0     cutoff    0      -102031.63 -102031.63  0.00%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 2
  MIR: 15
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (736 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -102032 -102019 -101975 ... -78694.7
No other solutions better than -102032

Optimal solution found (tolerance 1.00e-06)
Best objective -1.020316270784e+05, best bound -1.020316270784e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 84719.04
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102031.63
  [DEBUG]   S×d_nominal = 186750.67
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 186750.67 + -102031.63 = 84719.04
  [DEBUG]   Current θ from Master = 109035.09
  [DEBUG]   ⚠️  Z_SP ≤ θ by 24316.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -30981.62
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 6353.1366, Absolute Gap = 6353.1366, Relative Gap = 0.953126
  Not converged yet (gap = 6353.14 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135248 nonzeros
Model fingerprint: 0xa9062777
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -30981.6 (0.02s)
MIP start from previous solve produced solution with objective -30981.6 (0.02s)
Loaded MIP start from previous solve with objective -30981.6

Presolve removed 20018 rows and 8128 columns
Presolve time: 0.42s
Presolved: 27235 rows, 12852 columns, 167609 nonzeros
Variable types: 10593 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37146    6.9858383e+03   0.000000e+00   1.316660e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   24021    1.0729908e+04   0.000000e+00   0.000000e+00      7s

Root relaxation: objective 1.072991e+04, 24021 iterations, 6.83 seconds (13.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 10729.9077    0  378 -30981.619 10729.9077   135%     -    7s
H    0     0                    -27695.66176 10729.9077   139%     -    7s
H    0     0                    -27369.21922 10729.9077   139%     -    7s
H    0     0                    -19443.14859 6306.86682   132%     -   11s
H    0     0                    -19343.37101 6306.86682   133%     -   11s
     0     0 6306.86682    0  379 -19343.371 6306.86682   133%     -   11s
     0     0 5953.67335    0  475 -19343.371 5953.67335   131%     -   12s
     0     0 5782.18583    0  557 -19343.371 5782.18583   130%     -   12s
     0     0 5781.88514    0  591 -19343.371 5781.88514   130%     -   13s
     0     0 5781.88514    0  594 -19343.371 5781.88514   130%     -   13s
     0     0 5781.88514    0  595 -19343.371 5781.88514   130%     -   13s
H    0     0                    -19305.35221 4064.86139   121%     -   16s
     0     0 4043.49035    0  651 -19305.352 4043.49035   121%     -   16s
H    0     0                    -10886.32482 4043.49035   137%     -   16s
H    0     0                    -10606.07856 4043.49035   138%     -   16s
     0     0 3763.51063    0  613 -10606.079 3763.51063   135%     -   17s
     0     0 3669.61113    0  620 -10606.079 3669.61113   135%     -   18s
     0     0 3645.35109    0  606 -10606.079 3645.35109   134%     -   18s
     0     0 3638.62124    0  615 -10606.079 3638.62124   134%     -   19s
     0     0 3638.55831    0  615 -10606.079 3638.55831   134%     -   19s
     0     0 2676.13519    0  679 -10606.079 2676.13519   125%     -   23s
     0     0 2517.49117    0  638 -10606.079 2517.49117   124%     -   24s
     0     0 2494.26280    0  647 -10606.079 2494.26280   124%     -   25s
     0     0 2483.16085    0  649 -10606.079 2483.16085   123%     -   25s
     0     0 2478.25178    0  651 -10606.079 2478.25178   123%     -   25s
     0     0 2477.90614    0  653 -10606.079 2477.90614   123%     -   25s
     0     0 1967.38144    0  648 -10606.079 1967.38144   119%     -   30s
H    0     0                    -8226.061880 1967.30310   124%     -   31s
H    0     0                    -8080.467680 1967.30310   124%     -   31s
H    0     0                    -8080.324362 1967.30310   124%     -   31s
H    0     0                    -8072.250375 1967.30310   124%     -   31s
H    0     0                    -8067.709410 1967.30310   124%     -   31s
H    0     0                    -8066.354285 1967.30310   124%     -   31s
H    0     0                    -8060.163019 1967.30310   124%     -   31s
H    0     0                    -8054.440485 1967.30310   124%     -   31s
H    0     0                    -8048.895447 1967.30310   124%     -   31s
     0     0 1789.58238    0  643 -8048.8954 1789.58238   122%     -   32s
     0     0 1751.49395    0  658 -8048.8954 1751.49395   122%     -   33s
     0     0 1744.07312    0  653 -8048.8954 1744.07312   122%     -   33s
     0     0 1741.46692    0  659 -8048.8954 1741.46692   122%     -   33s
     0     0 1741.18552    0  660 -8048.8954 1741.18552   122%     -   33s
     0     0 1622.40713    0  656 -8048.8954 1622.40713   120%     -   35s
H    0     0                    -8032.944553 1622.37353   120%     -   35s
     0     0 1594.37049    0  658 -8032.9446 1594.37049   120%     -   35s
     0     0 1585.54682    0  662 -8032.9446 1585.54682   120%     -   36s
     0     0 1583.65471    0  665 -8032.9446 1583.65471   120%     -   36s
     0     0 1581.99395    0  670 -8032.9446 1581.99395   120%     -   36s
     0     0 1581.77691    0  666 -8032.9446 1581.77691   120%     -   36s
     0     0 1505.95281    0  675 -8032.9446 1505.95281   119%     -   37s
H    0     0                    -8007.816554 1505.89219   119%     -   37s
H    0     0                    -8004.241905 1505.89219   119%     -   37s
H    0     0                    -7998.669649 1505.89219   119%     -   37s
H    0     0                    -7998.634447 1505.89219   119%     -   38s
H    0     0                    -7981.064737 1505.89219   119%     -   38s
H    0     0                    -7979.963889 1505.89219   119%     -   38s
     0     0 1474.52257    0  724 -7979.9639 1474.52257   118%     -   38s
     0     0 1466.01487    0  674 -7979.9639 1466.01487   118%     -   39s
H    0     0                    -7978.785575 1463.63402   118%     -   39s
H    0     0                    -7907.977340 1463.63402   119%     -   39s
H    0     0                    -7904.376198 1463.63402   119%     -   39s
H    0     0                    -7807.230882 1463.63402   119%     -   39s
     0     0 1463.63402    0  680 -7807.2309 1463.63402   119%     -   39s
     0     0 1463.07592    0  724 -7807.2309 1463.07592   119%     -   39s
     0     0 1424.46762    0  723 -7807.2309 1424.46762   118%     -   40s
     0     0 1400.18994    0  675 -7807.2309 1400.18994   118%     -   41s
     0     0 1394.01452    0  698 -7807.2309 1394.01452   118%     -   42s
     0     0 1390.92219    0  702 -7807.2309 1390.92219   118%     -   42s
     0     0 1389.59521    0  704 -7807.2309 1389.59521   118%     -   42s
H    0     0                    -7800.322330 1361.04100   117%     -   44s
H    0     0                    -7796.677491 1361.04100   117%     -   44s
     0     0 1361.04100    0  684 -7796.6775 1361.04100   117%     -   44s
H    0     0                    -7778.032259 1361.01817   117%     -   44s
     0     0 1350.49705    0  705 -7778.0323 1350.49705   117%     -   44s
     0     0 1347.54977    0  692 -7778.0323 1347.54977   117%     -   44s
     0     0 1346.46866    0  697 -7778.0323 1346.46866   117%     -   45s
     0     0 1325.94155    0  690 -7778.0323 1325.94155   117%     -   46s
     0     0 1321.63259    0  698 -7778.0323 1321.63259   117%     -   46s
     0     0 1319.80175    0  707 -7778.0323 1319.80175   117%     -   46s
     0     0 1319.74153    0  706 -7778.0323 1319.74153   117%     -   46s
     0     0 1313.10711    0  757 -7778.0323 1313.10711   117%     -   47s
     0     0 1311.10583    0  707 -7778.0323 1311.10583   117%     -   48s
     0     0 1311.06735    0  708 -7778.0323 1311.06735   117%     -   48s
     0     0 1295.83882    0  701 -7778.0323 1295.83882   117%     -   49s
     0     0 1288.47196    0  717 -7778.0323 1288.47196   117%     -   49s
     0     0 1286.75048    0  721 -7778.0323 1286.75048   117%     -   50s
     0     0 1286.30100    0  731 -7778.0323 1286.30100   117%     -   50s
     0     0 1280.44587    0  709 -7778.0323 1280.44587   116%     -   51s
     0     0 1277.44467    0  716 -7778.0323 1277.44467   116%     -   51s
     0     0 1277.28566    0  713 -7778.0323 1277.28566   116%     -   52s
     0     0 1274.34299    0  713 -7778.0323 1274.34299   116%     -   52s
     0     0 1273.71884    0  716 -7778.0323 1273.71884   116%     -   53s
     0     0 1271.23978    0  714 -7778.0323 1271.23978   116%     -   53s
     0     0 1271.20746    0  714 -7778.0323 1271.20746   116%     -   54s
H    0     0                    -7716.738229 1271.12985   116%     -   67s
H    0     0                    -7714.313489 1271.12985   116%     -   67s
H    0     0                    -7700.475457 1271.12985   117%     -   67s
H    0     0                    -7687.325881 1271.12985   117%     -   67s
H    0     0                    -7684.577646 1271.12985   117%     -   67s
H    0     0                    -7654.726652 1271.12985   117%     -   67s
     0     2 1271.12985    0  714 -7654.7267 1271.12985   117%     -   67s
     1     4 1055.02025    1  731 -7654.7267 1270.64858   117%  1835   70s
     7    16  851.47590    3  716 -7654.7267  921.97909   112%  2158   75s
    31    58  650.98338    5  789 -7654.7267  715.32872   109%  2718   82s
    61    90  630.07010    6  739 -7654.7267  649.77017   108%  1959   86s
H   70    90                    -7396.048475  649.77017   109%  1826   86s
H   94   121                    -7378.017272  629.12138   109%  1655   87s
H   95   121                    -7332.393394  629.12138   109%  1642   87s
H   98   121                    -7225.936180  629.12138   109%  1641   87s
   166   190  452.82827    9  690 -7225.9362  629.12138   109%  1195   92s
   209   246  342.70857   10  699 -7225.9362  629.12138   109%  1127   96s
   278   296  215.83101   11  682 -7225.9362  629.12138   109%  1015  100s
   404   373  -17.83974   12  686 -7225.9362  512.74392   107%   998  106s
   443   430 -1647.2654   12  626 -7225.9362  512.74392   107%  1027  113s
   514   479 -716.29013   13  722 -7225.9362  512.74392   107%   997  116s
   587   528 -1665.0508   13  554 -7225.9362  512.74392   107%   977  120s
   724   619 -2607.1138   14  574 -7225.9362  512.74392   107%   966  128s
   802   670 -1599.9233   15  755 -7225.9362  397.79129   106%   950  130s
   886   727 -2412.6573   16  749 -7225.9362  397.79129   106%   934  137s
   976   789 -2585.9512   16  633 -7225.9362  397.79129   106%   911  141s
  1075   843 -2421.8893   17  690 -7225.9362  397.79129   106%   887  147s
  1164   888 -3158.2278   18  617 -7225.9362  226.09889   103%   880  150s
  1261   901 -4016.5379   19  613 -7225.9362  226.09889   103%   868  156s
H 1269   901                    -7224.695452  226.09889   103%   865  156s
H 1273   901                    -7221.708808  226.09889   103%   866  156s
H 1286   901                    -7214.998448  137.95426   102%   873  156s
H 1310   901                    -7211.347743 -321.42818  95.5%   876  156s
  1317   961 -3989.6866   19  586 -7211.3477 -321.42818  95.5%   876  161s
  1419  1015 -5490.8273   20  587 -7211.3477 -335.28006  95.4%   868  165s
  1638  1146 -6140.5116   21  507 -7211.3477 -416.86267  94.2%   858  173s
  1752  1190 -6169.6311   22  452 -7211.3477 -416.86267  94.2%   850  177s
H 1805  1190                    -7111.458579 -416.86267  94.1%   847  177s
  1846  1265 -6522.5131   24  527 -7111.4586 -416.86267  94.1%   843  181s
  1971  1332     cutoff   26      -7111.4586 -416.86267  94.1%   840  188s
  2088  1355 -1577.8906   11  349 -7111.4586 -416.86267  94.1%   835  190s
H 2096  1355                    -7101.209447 -416.86267  94.1%   834  190s
  2129  1448 -1934.2665   12  400 -7101.2094 -416.86267  94.1%   838  195s
  2319  1517 -2500.4812   14  219 -7101.2094 -416.86267  94.1%   819  201s
  2473  1596 -3325.7794   18  428 -7101.2094 -737.79436  89.6%   819  207s
H 2615  1596                    -7095.085848 -737.79436  89.6%   811  207s
  2660  1649 -4519.6218   26  177 -7095.0858 -737.79436  89.6%   810  212s
H 2735  1649                    -7094.424110 -737.79436  89.6%   807  212s
  2774  1723 -4666.9093   27  172 -7094.4241 -737.79436  89.6%   802  216s
  2960  1771 -5230.2968   35  186 -7094.4241 -804.26021  88.7%   798  220s
  3095  1830 -5607.3704   41  353 -7094.4241 -804.26021  88.7%   794  227s
  3257  1913 -6619.4172   51  207 -7094.4241 -892.62016  87.4%   792  232s
  3455  1975 -4354.7502   11  556 -7094.4241 -933.22709  86.8%   790  237s
  3604  2015 -5318.3747   15  415 -7094.4241 -1158.7322  83.7%   798  241s
  3692  2077 -6242.7985   17  269 -7094.4241 -1158.7322  83.7%   802  246s
  3903  2188 -2376.5489   11  470 -7094.4241 -1158.7322  83.7%   797  254s
  4120  2309 -4507.6931   14  350 -7094.4241 -1210.2952  82.9%   789  259s
  4351  2423 -5372.7547   21  357 -7094.4241 -1227.3660  82.7%   788  266s
  4591  2424 -3264.5546   20  714 -7094.4241 -1296.3540  81.7%   788  321s
  4593  2425 -6698.6942   21  378 -7094.4241 -1296.3540  81.7%   788  331s
  4594  2426 -6023.0639   26  685 -7094.4241 -1296.3540  81.7%   788  339s
  4595  2427 -6397.0617   55  624 -7094.4241 -1296.3540  81.7%   788  343s
  4596  2427 -5318.6893   16  702 -7094.4241 -1296.3540  81.7%   787  345s
  4601  2431 -5869.2885   22  716 -7094.4241 -1296.3540  81.7%   787  351s
  4602  2431 -7023.9398   70  711 -7094.4241 -1296.3540  81.7%   786  355s
  4606  2434 -4821.6350   16  714 -7094.4241 -1296.3540  81.7%   786  362s
  4610  2437 -5260.0272   19  767 -7094.4241 -1296.3540  81.7%   785  367s
  4613  2439 -5948.9346   15  730 -7094.4241 -1296.3540  81.7%   785  370s
  4615  2440 -6012.8539   11  705 -7094.4241 -1296.3540  81.7%   784  384s
  4616  2441 -2989.7742   18  705 -7094.4241 -1296.3540  81.7%   784  391s
  4617  2444 -1296.3540   12  688 -7094.4241 -1296.3540  81.7%   798  397s
  4619  2448 -1296.3540   13  598 -7094.4241 -1296.3540  81.7%   799  402s
  4623  2452 -1296.3540   14  584 -7094.4241 -1296.3540  81.7%   800  407s
  4631  2464 -2847.4042   15  695 -7094.4241 -1296.3540  81.7%   802  412s
  4645  2473     cutoff   16      -7094.4241 -1296.3540  81.7%   814  419s
  4673  2490 -1296.3540   17  673 -7094.4241 -1296.3540  81.7%   826  426s
  4705  2507 -1296.3540   18  587 -7094.4241 -1296.3540  81.7%   842  433s
  4739  2538 -1301.6246   19  616 -7094.4241 -1296.3540  81.7%   861  439s
  4796  2553 -1720.7601   20  656 -7094.4241 -1296.3540  81.7%   867  444s
  4858  2553 -2477.1251   21  570 -7094.4241 -1296.3540  81.7%   873  448s
  4938  2549 -3944.2805   22  547 -7094.4241 -1296.3540  81.7%   878  456s
  5022  2539 -4014.6104   23  464 -7094.4241 -1296.3540  81.7%   883  460s
  5150  2548 -5492.8701   25  522 -7094.4241 -1296.3540  81.7%   889  469s
  5233  2541 -6415.2125   26  458 -7094.4241 -1296.3540  81.7%   888  474s
  5318  2538 -6313.3016   25  447 -7094.4241 -1296.3540  81.7%   887  479s
  5394  2527 -6950.7801   26  443 -7094.4241 -1721.1637  75.7%   888  483s
  5473  2528 -6485.0560   26  439 -7094.4241 -1721.1637  75.7%   888  488s
  5548  2526 -6593.2540   28  253 -7094.4241 -1721.1637  75.7%   888  493s
  5634  2512 -6670.7870   30  261 -7094.4241 -2332.6003  67.1%   889  498s
  5706  2509     cutoff   31      -7094.4241 -2332.6003  67.1%   891  501s
  5801  2476     cutoff   31      -7094.4241 -3355.1791  52.7%   891  508s
  5912  2438     cutoff   29      -7094.4241 -3466.4261  51.1%   893  512s
  6014  2398 -5543.7116   21  309 -7094.4241 -3583.5552  49.5%   896  519s
  6127  2377 -6436.9746   22  308 -7094.4241 -3823.6501  46.1%   895  527s
  6242  2319     cutoff   25      -7094.4241 -3823.6501  46.1%   896  534s
  6380  2251 infeasible   23      -7094.4241 -4052.6536  42.9%   894  540s
  6558  2171 -5539.6533   23  600 -7094.4241 -4052.6536  42.9%   888  548s
  6722  2104 -5762.5148   24  543 -7094.4241 -4314.3523  39.2%   882  551s
  6885  2023 -6131.1298   26  544 -7094.4241 -4603.3275  35.1%   880  560s
  7036  1916 -6473.2850   27  523 -7094.4241 -4713.9154  33.6%   875  565s
  7230  1778     cutoff   28      -7094.4241 -4773.5762  32.7%   866  570s
  7759  1471 -7085.0642   71   48 -7094.4241 -5459.9747  23.0%   829  577s
  8049  1359     cutoff   43      -7094.4241 -5776.9259  18.6%   803  580s
  9383  1262 -7082.7299   80   16 -7094.4241 -6978.2741  1.64%   693  585s
*13189    92              85    -7094.269883 -7072.3551  0.31%   497  588s
*13291    92              94    -7092.363237 -7073.1631  0.27%   494  588s
*13616     0              91    -7091.355186 -7088.3171  0.04%   482  588s

Cutting planes:
  Learned: 1
  MIR: 481
  Flow cover: 1377
  Zero half: 18
  RLT: 24
  Relax-and-lift: 109

Explored 13625 nodes (6628859 simplex iterations) in 588.58 seconds (1399.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -7091.36 -7092.36 -7094.27 ... -7221.71
No other solutions better than -7091.36

Optimal solution found (tolerance 1.00e-06)
Best objective -7.091355186324e+03, best bound -7.091355186324e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 588.59s
  Master Objective (UB) = -7091.36, θ = 107978.35
  Upper Bound (UB) = -7091.36

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 107978.35
  [DEBUG]   ✓ Scenario 0: θ = 107978.35 ≤ Q = 107978.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 107978.35 ≤ Q = 107978.35 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 107978.35 ≤ Q = 107978.35 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7728cf35
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7728cf35
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-17, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-19, 2e+02]
Found heuristic solution: objective 1.431975e+13
Presolve removed 2580 rows and 1874 columns
Presolve time: 0.00s
Presolved: 513 rows, 515 columns, 1446 nonzeros
Found heuristic solution: objective 8152007.3788
Variable types: 347 continuous, 168 integer (168 binary)

Root relaxation: objective -1.100568e+05, 253 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110056.78    0  124 8152007.38 -110056.78   101%     -    0s
H    0     0                    -75697.85817 -110056.78  45.4%     -    0s
H    0     0                    -77073.90448 -110056.78  42.8%     -    0s
H    0     0                    -87140.41620 -110056.78  26.3%     -    0s
H    0     0                    -93330.07561 -110056.78  17.9%     -    0s
     0     0 -101928.61    0  128 -93330.076 -101928.61  9.21%     -    0s
H    0     0                    -99197.70222 -101915.72  2.74%     -    0s
     0     0 -101488.13    0  123 -99197.702 -101488.13  2.31%     -    0s
H    0     0                    -100111.2026 -101410.53  1.30%     -    0s
     0     0 -101410.53    0  124 -100111.20 -101410.53  1.30%     -    0s
     0     0 -100990.24    0   86 -100111.20 -100990.24  0.88%     -    0s
     0     0 -100897.48    0   53 -100111.20 -100897.48  0.79%     -    0s
     0     0 -100892.72    0   60 -100111.20 -100892.72  0.78%     -    0s
     0     0 -100676.06    0   53 -100111.20 -100676.06  0.56%     -    0s
     0     0 -100671.27    0   53 -100111.20 -100671.27  0.56%     -    0s
     0     0 -100603.70    0   46 -100111.20 -100603.70  0.49%     -    0s
     0     0 -100595.32    0   38 -100111.20 -100595.32  0.48%     -    0s
     0     0 -100474.34    0   32 -100111.20 -100474.34  0.36%     -    0s
H    0     0                    -100158.4882 -100456.12  0.30%     -    0s
     0     0 -100456.12    0   32 -100158.49 -100456.12  0.30%     -    0s
     0     0 -100397.52    0   24 -100158.49 -100397.52  0.24%     -    0s
     0     0 -100363.62    0   20 -100158.49 -100363.62  0.20%     -    0s
     0     0 -100363.62    0   29 -100158.49 -100363.62  0.20%     -    0s
     0     0 -100363.62    0   29 -100158.49 -100363.62  0.20%     -    0s
H    0     0                    -100176.0094 -100353.25  0.18%     -    0s
     0     0 -100353.25    0   12 -100176.01 -100353.25  0.18%     -    0s
     0     0 -100229.03    0   11 -100176.01 -100229.03  0.05%     -    0s
     0     0 -100227.93    0   10 -100176.01 -100227.93  0.05%     -    0s
H    0     0                    -100183.9426 -100227.93  0.04%     -    0s
     0     0 -100187.96    0    5 -100183.94 -100187.96  0.00%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 9
  MIR: 7
  Flow cover: 16
  RLT: 4
  Relax-and-lift: 3

Explored 1 nodes (1334 simplex iterations) in 0.08 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -100184 -100176 -100158 ... -75697.9
No other solutions better than -100184

Optimal solution found (tolerance 1.00e-06)
Best objective -1.001839426420e+05, best bound -1.001839426420e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 86856.28
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100183.94
  [DEBUG]   S×d_nominal = 187040.22
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 187040.22 + -100183.94 = 86856.28
  [DEBUG]   Current θ from Master = 107978.35
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21122.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28213.43
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 5927.3587, Absolute Gap = 5927.3587, Relative Gap = 0.835857
  Not converged yet (gap = 5927.36 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178491 nonzeros
Model fingerprint: 0xc3295258
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve produced solution with objective -28213.4 (0.03s)
MIP start from previous solve produced solution with objective -28213.4 (0.03s)
Loaded MIP start from previous solve with objective -28213.4

Presolve removed 26684 rows and 10834 columns
Presolve time: 0.55s
Presolved: 35859 rows, 16386 columns, 221659 nonzeros
Variable types: 14127 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 35859 rows, 16386 columns, 221659 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33615    2.3977183e+03   0.000000e+00   2.348357e+05      5s
   43571    5.2988973e+03   0.000000e+00   2.882950e+06     10s
Concurrent spin time: 3.45s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 34519 iterations, 12.19 seconds (21.99 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -28213.434 8091.90663   129%     -   12s
H    0     0                    -27105.26076 8091.90663   130%     -   13s
H    0     0                    -20905.96394 8091.90663   139%     -   13s
H    0     0                    -20841.83569 8091.90663   139%     -   13s
H    0     0                    -20834.71069 8091.90663   139%     -   13s
     0     0 3330.30540    0  467 -20834.711 3330.30540   116%     -   20s
H    0     0                    -17586.40049 3330.30540   119%     -   20s
H    0     0                    -17559.28769 3330.30540   119%     -   20s
     0     0 2887.95179    0  434 -17559.288 2887.95179   116%     -   23s
     0     0 2887.95179    0  437 -17559.288 2887.95179   116%     -   24s
     0     0 2887.95179    0  439 -17559.288 2887.95179   116%     -   24s
     0     0 2887.95179    0  442 -17559.288 2887.95179   116%     -   25s
     0     0 1232.01567    0  521 -17559.288 1232.01567   107%     -   31s
H    0     0                    -17534.76068 1230.45572   107%     -   31s
H    0     0                    -17421.66377 1230.45572   107%     -   31s
H    0     0                    -17416.33505 1230.45572   107%     -   31s
H    0     0                    -17410.26760 1230.45572   107%     -   31s
     0     0 1141.62487    0  614 -17410.268 1141.62487   107%     -   33s
     0     0  994.99500    0  624 -17410.268  994.99500   106%     -   34s
     0     0  987.59795    0  634 -17410.268  987.59795   106%     -   34s
     0     0  933.55102    0  619 -17410.268  933.55102   105%     -   35s
     0     0  923.62927    0  626 -17410.268  923.62927   105%     -   36s
     0     0  914.59786    0  635 -17410.268  914.59786   105%     -   36s
     0     0  913.77355    0  630 -17410.268  913.77355   105%     -   36s
     0     0  913.77355    0  630 -17410.268  913.77355   105%     -   36s
H    0     0                    -12884.34179  -22.91592   100%     -   47s
     0     0  -22.91592    0  597 -12884.342  -22.91592   100%     -   47s
H    0     0                    -12312.79393  -23.72138   100%     -   47s
H    0     0                    -11919.23639  -23.72138   100%     -   47s
H    0     0                    -11784.20216  -23.72138   100%     -   47s
H    0     0                    -11568.35074 -436.12605  96.2%     -   51s
H    0     0                    -11549.50595 -436.12605  96.2%     -   51s
H    0     0                    -11473.56855 -436.12605  96.2%     -   51s
     0     0 -436.12605    0  590 -11473.569 -436.12605  96.2%     -   51s
     0     0 -526.91349    0  597 -11473.569 -526.91349  95.4%     -   52s
     0     0 -558.05135    0  600 -11473.569 -558.05135  95.1%     -   53s
     0     0 -563.86058    0  609 -11473.569 -563.86058  95.1%     -   53s
     0     0 -566.41285    0  608 -11473.569 -566.41285  95.1%     -   54s
     0     0 -566.51401    0  611 -11473.569 -566.51401  95.1%     -   54s
     0     0 -933.23461    0  633 -11473.569 -933.23461  91.9%     -   62s
     0     0 -1172.4155    0  610 -11473.569 -1172.4155  89.8%     -   67s
     0     0 -1245.3458    0  629 -11473.569 -1245.3458  89.1%     -   68s
     0     0 -1299.9101    0  693 -11473.569 -1299.9101  88.7%     -   69s
     0     0 -1333.3344    0  653 -11473.569 -1333.3344  88.4%     -   70s
     0     0 -1345.5702    0  643 -11473.569 -1345.5702  88.3%     -   71s
     0     0 -1347.8382    0  657 -11473.569 -1347.8382  88.3%     -   71s
     0     0 -1353.7855    0  650 -11473.569 -1353.7855  88.2%     -   72s
     0     0 -1358.5423    0  652 -11473.569 -1358.5423  88.2%     -   72s
     0     0 -1359.7739    0  647 -11473.569 -1359.7739  88.1%     -   72s
     0     0 -1473.6925    0  668 -11473.569 -1473.6925  87.2%     -   75s
H    0     0                    -11465.10138 -1506.5515  86.9%     -   77s
H    0     0                    -11463.94186 -1506.5515  86.9%     -   77s
H    0     0                    -11456.73262 -1506.5515  86.9%     -   77s
     0     0 -1506.5515    0  675 -11456.733 -1506.5515  86.9%     -   77s
     0     0 -1526.4152    0  755 -11456.733 -1526.4152  86.7%     -   78s
H    0     0                    -11410.83025 -1541.5798  86.5%     -   78s
H    0     0                    -11402.46148 -1541.5798  86.5%     -   78s
     0     0 -1541.5798    0  685 -11402.461 -1541.5798  86.5%     -   78s
     0     0 -1544.1992    0  698 -11402.461 -1544.1992  86.5%     -   78s
     0     0 -1545.3837    0  696 -11402.461 -1545.3837  86.4%     -   79s
     0     0 -1599.4846    0  716 -11402.461 -1599.4846  86.0%     -   81s
     0     0 -1629.4894    0  672 -11402.461 -1629.4894  85.7%     -   83s
     0     0 -1635.5228    0  666 -11402.461 -1635.5228  85.7%     -   83s
     0     0 -1639.5648    0  681 -11402.461 -1639.5648  85.6%     -   84s
     0     0 -1639.8786    0  688 -11402.461 -1639.8786  85.6%     -   84s
     0     0 -1686.9925    0  716 -11402.461 -1686.9925  85.2%     -   86s
     0     0 -1692.6202    0  679 -11402.461 -1692.6202  85.2%     -   87s
     0     0 -1694.1675    0  687 -11402.461 -1694.1675  85.1%     -   87s
     0     0 -1694.4395    0  694 -11402.461 -1694.4395  85.1%     -   87s
H    0     0                    -11324.17079 -1714.8485  84.9%     -   89s
H    0     0                    -11303.45365 -1714.8485  84.8%     -   89s
H    0     0                    -11263.47471 -1714.8485  84.8%     -   89s
H    0     0                    -11247.72419 -1714.8485  84.8%     -   89s
H    0     0                    -11240.88106 -1714.8485  84.7%     -   89s
H    0     0                    -11238.80733 -1714.8485  84.7%     -   89s
     0     0 -1714.8485    0  709 -11238.807 -1714.8485  84.7%     -   89s
H    0     0                    -11204.12080 -1715.1252  84.7%     -   89s
H    0     0                    -11164.98322 -1715.1252  84.6%     -   89s
H    0     0                    -11164.86372 -1715.1252  84.6%     -   89s
     0     0 -1720.5303    0  713 -11164.864 -1720.5303  84.6%     -   90s
     0     0 -1725.1717    0  721 -11164.864 -1725.1717  84.5%     -   90s
     0     0 -1726.4722    0  729 -11164.864 -1726.4722  84.5%     -   90s
     0     0 -1734.1000    0  743 -11164.864 -1734.1000  84.5%     -   92s
H    0     0                    -10826.61342 -1734.1884  84.0%     -   92s
H    0     0                    -10704.20391 -1734.1884  83.8%     -   92s
H    0     0                    -10647.73749 -1734.1884  83.7%     -   92s
H    0     0                    -10605.77057 -1734.1884  83.6%     -   92s
     0     0 -1735.8693    0  704 -10605.771 -1735.8693  83.6%     -   92s
     0     0 -1736.7728    0  707 -10605.771 -1736.7728  83.6%     -   93s
     0     0 -1741.4651    0  693 -10605.771 -1741.4651  83.6%     -   94s
H    0     0                    -10604.29657 -1741.8514  83.6%     -   94s
H    0     0                    -10600.20109 -1741.8514  83.6%     -   94s
     0     0 -1743.4263    0  697 -10600.201 -1743.4263  83.6%     -   95s
     0     0 -1743.9211    0  749 -10600.201 -1743.9211  83.5%     -   95s
     0     0 -1751.7999    0  745 -10600.201 -1751.7999  83.5%     -   96s
     0     0 -1752.0376    0  745 -10600.201 -1752.0376  83.5%     -   97s
H    0     0                    -10553.40650 -1752.0376  83.4%     -  112s
     0     2 -1752.0376    0  745 -10553.407 -1752.0376  83.4%     -  112s
     3     8 -1842.8298    2  675 -10553.407 -1796.4689  83.0%  1626  117s
     7    16 -2100.3544    3  766 -10553.407 -1843.6449  82.5%  2339  120s
    15    32 -2122.8929    4  775 -10553.407 -2101.4472  80.1%  2542  128s
    31    64 -2213.0033    5  725 -10553.407 -2123.1553  79.9%  3986  134s
H   32    64                    -10531.85864 -2123.1553  79.8%  3861  134s
H   33    64                    -10517.32324 -2123.1553  79.8%  3777  134s
H   40    64                    -10507.12459 -2123.1553  79.8%  3359  134s
    63    96 -2281.0808    6  720 -10507.125 -2213.1148  78.9%  3291  136s
   158   216 -2454.8300    9  665 -10507.125 -2213.1148  78.9%  1866  142s
   231   270 -2460.2188    9  633 -10507.125 -2213.1148  78.9%  1635  147s
   296   318 -2492.6496   10  660 -10507.125 -2251.5773  78.6%  1619  151s
   358   366 -2961.4539   10  620 -10507.125 -2251.5773  78.6%  1598  157s
   421   404 -2602.3081   11  699 -10507.125 -2251.5773  78.6%  1620  163s
   484   452 -3899.8309   10  673 -10507.125 -2251.5773  78.6%  1655  169s
   541   507 -2716.4331   12  660 -10507.125 -2274.7878  78.4%  1661  174s
   604   561 -3091.1652   13  598 -10507.125 -2274.7878  78.4%  1659  180s
   677   584 -3500.8035   14  584 -10507.125 -2274.7878  78.4%  1612  185s
   736   618 -3946.2216   15  390 -10507.125 -2274.7878  78.4%  1629  191s
   787   666 -4526.0062   16  457 -10507.125 -2339.8004  77.7%  1637  196s
   843   698 -5649.8443   16  452 -10507.125 -2339.8004  77.7%  1636  201s
   918   716 -6661.3325   17  493 -10507.125 -2339.8004  77.7%  1598  208s
   975   738 -4998.8376   17  525 -10507.125 -2339.8004  77.7%  1606  212s
H 1022   738                    -10426.86574 -2339.8004  77.6%  1611  212s
  1034   762 -6250.2540   18  506 -10426.866 -2339.8004  77.6%  1613  219s
H 1042   762                    -10409.89580 -2339.8004  77.5%  1605  219s
H 1067   762                    -10347.29206 -2339.8004  77.4%  1585  219s
  1077   762 -5066.0025   13  462 -10347.292 -2339.8004  77.4%  1595  220s
  1199   827 -9888.8112   19  416 -10347.292 -2495.1707  75.9%  1578  230s
  1252   862 -9006.8504   20  382 -10347.292 -2495.1707  75.9%  1577  236s
  1420   931 infeasible   28      -10347.292 -2733.3952  73.6%  1537  246s
H 1447   931                    -10344.83596 -2733.3952  73.6%  1532  246s
  1478   979 -6598.7431   13  407 -10344.836 -2733.3952  73.6%  1534  252s
  1574  1004 -9542.8152   15  315 -10344.836 -2733.3952  73.6%  1529  259s
H 1575  1004                    -10296.57574 -2733.3952  73.5%  1528  259s
H 1593  1004                    -10288.91203 -2733.3952  73.4%  1536  259s
  1611  1072 -10231.192   16  301 -10288.912 -2733.3952  73.4%  1540  265s
  1726  1117 -4933.1084    8  532 -10288.912 -2753.1258  73.2%  1518  272s
  1837  1163 -5152.5179    9  467 -10288.912 -2753.1258  73.2%  1492  276s
  1952  1175 -5575.4909   10  473 -10288.912 -2799.6381  72.8%  1465  285s
  2101  1202 -6467.0598   11  530 -10288.912 -2939.7670  71.4%  1442  293s
  2188  1231 -6889.8122   12  523 -10288.912 -3045.6821  70.4%  1443  300s
  2306  1289 -7391.5724   14  504 -10288.912 -3045.6821  70.4%  1435  307s
  2438  1311 -8801.3813   19  322 -10288.912 -3045.6821  70.4%  1434  315s
  2612  1349 -8763.1351   12  111 -10288.912 -3045.6821  70.4%  1420  324s
  2733  1387     cutoff   22      -10288.912 -3127.2800  69.6%  1434  332s
  2884  1432 -7558.5002   15  515 -10288.912 -3127.2800  69.6%  1430  339s
  3066  1486 -8988.2258   18  324 -10288.912 -3385.4740  67.1%  1423  348s
  3238  1521 -6589.3057   12  276 -10288.912 -3511.6944  65.9%  1427  355s
  3405  1569 -8390.5097   15  187 -10288.912 -3511.6944  65.9%  1411  363s
  3621  1596 -9789.6352   18  281 -10288.912 -3511.6944  65.9%  1400  370s
  3683  1628 -10107.074   19  139 -10288.912 -3511.6944  65.9%  1399  380s
  3871  1686 -6474.7480    9  601 -10288.912 -3511.6944  65.9%  1390  389s
  4079  1709 -9761.6412   12  219 -10288.912 -3659.4080  64.4%  1388  394s
  4120  1728 infeasible   13      -10288.912 -3802.7809  63.0%  1391  402s
  4219  1753     cutoff   13      -10288.912 -3802.7809  63.0%  1392  412s
  4469  1761 -7571.0949   13  414 -10288.912 -3922.8845  61.9%  1378  423s
  4705  1789     cutoff   23      -10288.912 -3940.7430  61.7%  1382  434s
  4949  1838 -5918.4588    9  464 -10288.912 -3953.2123  61.6%  1386  446s
  5215  1914 -7526.6274   13  414 -10288.912 -4130.1894  59.9%  1382  457s
  5519  1978 -9471.1967   24  374 -10288.912 -4244.2469  58.7%  1373  468s
  5857  2028     cutoff   12      -10288.912 -4247.5510  58.7%  1363  478s
  6150  2048 infeasible   12      -10288.912 -4398.5780  57.2%  1364  491s
  6479  2090     cutoff   19      -10288.912 -4541.7942  55.9%  1363  505s
  6794  2120     cutoff   13      -10288.912 -4584.5754  55.4%  1367  517s
  7193  2175 -7536.8278   18  363 -10288.912 -4726.2971  54.1%  1360  531s
  7553  2229     cutoff   13      -10288.912 -4733.5703  54.0%  1359  545s
  8014  2247 infeasible   15      -10288.912 -5034.9709  51.1%  1347  559s
  8370  2296 -9573.6579   17  285 -10288.912 -5152.9987  49.9%  1350  573s
  8750  2312 -9079.9378   19  363 -10288.912 -5202.0139  49.4%  1354  588s
  9149  2309 -9903.3259   16  108 -10288.912 -5415.0620  47.4%  1353  599s
  9215  2324     cutoff   17      -10288.912 -5457.3662  47.0%  1354  612s
  9412  2324 -10188.367   18  278 -10288.912 -5536.4340  46.2%  1354  628s
  9811  2320 -7668.6958   13  269 -10288.912 -5539.8508  46.2%  1358  645s
 10262  2309 -7073.2090   11  596 -10288.912 -5758.5589  44.0%  1361  660s
 10783  2282 -10215.436   22  229 -10288.912 -5871.0055  42.9%  1356  678s
 11312  2239 -9909.9090   21  356 -10288.912 -6203.4333  39.7%  1355  695s
 11684  2212 -7712.3866   15  139 -10288.912 -6304.1149  38.7%  1350  713s
 12198  2149     cutoff   12      -10288.912 -6473.0343  37.1%  1348  733s
 12750  1999 -8189.5609   22  338 -10288.912 -6645.3878  35.4%  1353  752s
 13385  1895     cutoff   35      -10288.912 -6887.1754  33.1%  1350  774s
 14093  1741 -10080.895   27   35 -10288.912 -7153.0798  30.5%  1344  796s
 14945  1538     cutoff   31      -10288.912 -7363.1844  28.4%  1326  819s
 15755  1491 -9105.9815   25  192 -10288.912 -7753.2194  24.6%  1315  836s
 15946  1181     cutoff   26      -10288.912 -7813.3859  24.1%  1311  860s
 16894   691 -9626.4395   36  228 -10288.912 -8070.7989  21.6%  1285  882s
*17881   691              40    -10288.76459 -8190.7408  20.4%  1254  882s
 18367   159 -9469.2841   23  441 -10288.765 -8612.9878  16.3%  1236  901s
*18413   159              43    -10287.22979 -8612.9878  16.3%  1234  901s
H18598   159                    -10264.03217 -8676.3227  15.5%  1224  901s
H18601   159                    -10254.92276 -8676.3227  15.4%  1224  901s
*20327    71              47    -10251.82585 -9223.0727  10.0%  1152  903s
*20337    71              45    -10250.62694 -9223.0727  10.0%  1152  903s
*20420    71              44    -10250.56678 -9223.0727  10.0%  1147  903s
*20445    71              46    -10244.49742 -9276.9461  9.44%  1146  903s
*20458    71              44    -10231.90855 -9276.9461  9.33%  1145  903s

Cutting planes:
  Learned: 3
  Implied bound: 12
  MIR: 460
  Flow cover: 1306
  Zero half: 7
  RLT: 69
  Relax-and-lift: 60

Explored 21117 nodes (23597787 simplex iterations) in 903.31 seconds (2761.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10231.9 -10244.5 -10250.6 ... -10288.9
No other solutions better than -10231.9

Optimal solution found (tolerance 1.00e-06)
Warning: max constraint violation (1.8408e-09) exceeds tolerance
Best objective -1.023190855266e+04, best bound -1.023190855266e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 903.35s
  Master Objective (UB) = -10231.91, θ = 119532.42
  Upper Bound (UB) = -10231.91

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119532.42
  [DEBUG]   ✓ Scenario 0: θ = 119532.42 ≤ Q = 119532.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119532.42 ≤ Q = 119532.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119532.42 ≤ Q = 119532.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119532.42 ≤ Q = 119532.42 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5ef43289
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5ef43289
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.233242e+13
Presolve removed 2590 rows and 1881 columns
Presolve time: 0.00s
Presolved: 503 rows, 508 columns, 1420 nonzeros
Found heuristic solution: objective 6668468.6130
Variable types: 342 continuous, 166 integer (166 binary)

Root relaxation: objective -1.166333e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116633.29    0  130 6668468.61 -116633.29   102%     -    0s
H    0     0                    -80867.01184 -116633.29  44.2%     -    0s
H    0     0                    -81213.71160 -116633.29  43.6%     -    0s
H    0     0                    -89100.71490 -116633.29  30.9%     -    0s
H    0     0                    -93238.31624 -116633.29  25.1%     -    0s
H    0     0                    -97220.05071 -99222.125  2.06%     -    0s
     0     0 -99222.125    0   89 -97220.051 -99222.125  2.06%     -    0s
H    0     0                    -98451.48542 -99218.808  0.78%     -    0s
     0     0 -98772.753    0   82 -98451.485 -98772.753  0.33%     -    0s
     0     0 -98681.980    0   68 -98451.485 -98681.980  0.23%     -    0s
     0     0 -98664.855    0   61 -98451.485 -98664.855  0.22%     -    0s
     0     0 -98663.627    0   60 -98451.485 -98663.627  0.22%     -    0s
     0     0 -98635.829    0    9 -98451.485 -98635.829  0.19%     -    0s
H    0     0                    -98596.71309 -98630.512  0.03%     -    0s
     0     0 -98612.997    0    8 -98596.713 -98612.997  0.02%     -    0s
     0     0 -98600.973    0    3 -98596.713 -98600.973  0.00%     -    0s
     0     0     cutoff    0      -98596.713 -98596.713  0.00%     -    0s

Explored 1 nodes (509 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -98596.7 -98596 -98451.5 ... 1.23324e+13
No other solutions better than -98596.7

Optimal solution found (tolerance 1.00e-06)
Best objective -9.859671309223e+04, best bound -9.859671309223e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 101956.56
  Scenario: 15 demand increases, 45 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98596.71
  [DEBUG]   S×d_nominal = 200553.27
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 200553.27 + -98596.71 = 101956.56
  [DEBUG]   Current θ from Master = 119532.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17575.86 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -27807.77
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 2786.8053, Absolute Gap = 2786.8053, Relative Gap = 0.272364
  Not converged yet (gap = 2786.81 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 15 increases, 45 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221734 nonzeros
Model fingerprint: 0x2d048e53
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 33350 rows and 13540 columns
Presolve time: 0.70s
Presolved: 44483 rows, 19920 columns, 275709 nonzeros
Variable types: 17661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 44483 rows, 19920 columns, 275709 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33241   -1.1353435e+04   0.000000e+00   5.627026e+06      5s
   45232   -8.3263167e+02   0.000000e+00   1.211056e+06     10s
   54872    4.8535576e+03   0.000000e+00   2.946332e+06     15s
Concurrent spin time: 2.66s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 46713 iterations, 15.94 seconds (31.91 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -190756.93 8091.90663   104%     -   17s
H    0     0                    -177417.5634 8091.90663   105%     -   17s
H    0     0                    -127788.6347 8091.90663   106%     -   17s
H    0     0                    -124610.3007 8091.90663   106%     -   17s
H    0     0                    -124374.8735 8091.90663   107%     -   17s
H    0     0                    -123432.9534 8091.90663   107%     -   17s
H    0     0                    -123351.6110 8091.90663   107%     -   17s
H    0     0                    -123201.7418 8091.90663   107%     -   17s
H    0     0                    -116063.7880 8091.90663   107%     -   17s
H    0     0                    -115906.0693 8091.90663   107%     -   17s
H    0     0                    -115584.9061 8091.90663   107%     -   17s
H    0     0                    -114437.9403 8091.90663   107%     -   17s
H    0     0                    -114437.5277 8091.90663   107%     -   17s
H    0     0                    -77221.69073 8091.90663   110%     -   17s
H    0     0                    -77178.69377 8091.90663   110%     -   17s
H    0     0                    -70152.35226 8091.90663   112%     -   17s
H    0     0                    -59461.29464 8091.90663   114%     -   17s
H    0     0                    -59117.76043 8091.90663   114%     -   17s
H    0     0                    -48994.21760 8091.90663   117%     -   18s
H    0     0                    -48736.47542 8091.90663   117%     -   18s
H    0     0                    -41457.75782 8091.90663   120%     -   18s
H    0     0                    -38533.98597 8091.90663   121%     -   18s
H    0     0                    -38435.51785 8091.90663   121%     -   18s
     0     0 3562.66379    0  488 -38435.518 3562.66379   109%     -   26s
H    0     0                    -37211.51245 3562.14084   110%     -   26s
H    0     0                    -37207.59076 3562.14084   110%     -   26s
     0     0 2917.23707    0  512 -37207.591 2917.23707   108%     -   30s
     0     0 2829.83838    0  520 -37207.591 2829.83838   108%     -   31s
     0     0 2829.35736    0  451 -37207.591 2829.35736   108%     -   32s
     0     0 2829.35736    0  458 -37207.591 2829.35736   108%     -   33s
     0     0 2829.35736    0  457 -37207.591 2829.35736   108%     -   34s
     0     0 2829.29867    0  458 -37207.591 2829.29867   108%     -   34s
H    0     0                    -32963.62978 1254.73148   104%     -   42s
     0     0 1245.92997    0  646 -32963.630 1245.92997   104%     -   42s
H    0     0                    -32924.12833 1245.92997   104%     -   42s
H    0     0                    -30093.39486 1245.92997   104%     -   42s
H    0     0                    -30077.67365 1245.92997   104%     -   42s
     0     0 1015.37552    0  633 -30077.674 1015.37552   103%     -   45s
     0     0  991.48836    0  635 -30077.674  991.48836   103%     -   46s
     0     0  886.02478    0  636 -30077.674  886.02478   103%     -   48s
     0     0  774.82678    0  645 -30077.674  774.82678   103%     -   50s
     0     0  763.61097    0  646 -30077.674  763.61097   103%     -   50s
     0     0  759.95348    0  642 -30077.674  759.95348   103%     -   51s
     0     0  759.39280    0  647 -30077.674  759.39280   103%     -   51s
H    0     0                    -30063.01126 -264.71855  99.1%     -   62s
H    0     0                    -29945.20605 -264.71855  99.1%     -   62s
H    0     0                    -29860.20097 -264.71855  99.1%     -   62s
H    0     0                    -29852.99173 -264.71855  99.1%     -   62s
H    0     0                    -23577.67486 -264.71855  98.9%     -   62s
H    0     0                    -13008.38427 -264.71855  98.0%     -   62s
H    0     0                    -12991.56708 -264.71855  98.0%     -   62s
H    0     0                    -12990.98251 -264.71855  98.0%     -   62s
H    0     0                    -12989.82299 -264.71855  98.0%     -   62s
     0     0 -264.71855    0  613 -12989.823 -264.71855  98.0%     -   62s
     0     0 -392.00002    0  624 -12989.823 -392.00002  97.0%     -   66s
     0     0 -445.56937    0  627 -12989.823 -445.56937  96.6%     -   67s
H    0     0                    -12989.66726 -508.00029  96.1%     -   70s
H    0     0                    -12988.34687 -508.00029  96.1%     -   70s
     0     0 -508.00029    0  622 -12988.347 -508.00029  96.1%     -   70s
     0     0 -527.77332    0  631 -12988.347 -527.77332  95.9%     -   71s
     0     0 -540.34353    0  634 -12988.347 -540.34353  95.8%     -   72s
     0     0 -542.98505    0  639 -12988.347 -542.98505  95.8%     -   72s
     0     0 -543.18611    0  640 -12988.347 -543.18611  95.8%     -   73s
H    0     0                    -12867.77633 -978.62032  92.4%     -   88s
H    0     0                    -12861.19342 -978.62032  92.4%     -   88s
H    0     0                    -12855.92591 -978.62032  92.4%     -   88s
H    0     0                    -12850.48312 -978.62032  92.4%     -   88s
H    0     0                    -12843.76608 -978.62032  92.4%     -   88s
     0     0 -978.62032    0  647 -12843.766 -978.62032  92.4%     -   88s
H    0     0                    -12833.30173 -978.86775  92.4%     -   88s
H    0     0                    -11977.39381 -1221.9886  89.8%     -   92s
H    0     0                    -11904.08336 -1221.9886  89.7%     -   92s
     0     0 -1221.9886    0  651 -11904.083 -1221.9886  89.7%     -   94s
     0     0 -1352.8685    0  655 -11904.083 -1352.8685  88.6%     -   97s
     0     0 -1378.6123    0  657 -11904.083 -1378.6123  88.4%     -   99s
     0     0 -1386.8550    0  658 -11904.083 -1386.8550  88.3%     -  100s
     0     0 -1390.0721    0  658 -11904.083 -1390.0721  88.3%     -  100s
H    0     0                    -11667.68382 -1412.4517  87.9%     -  102s
H    0     0                    -11655.39337 -1412.4517  87.9%     -  102s
H    0     0                    -11652.71413 -1412.4517  87.9%     -  102s
     0     0 -1412.4517    0  651 -11652.714 -1412.4517  87.9%     -  102s
     0     0 -1417.9695    0  659 -11652.714 -1417.9695  87.8%     -  102s
     0     0 -1419.8139    0  663 -11652.714 -1419.8139  87.8%     -  103s
     0     0 -1421.5895    0  662 -11652.714 -1421.5895  87.8%     -  103s
     0     0 -1421.7334    0  661 -11652.714 -1421.7334  87.8%     -  104s
     0     0 -1526.4086    0  662 -11652.714 -1526.4086  86.9%     -  109s
     0     0 -1578.6511    0  720 -11652.714 -1578.6511  86.5%     -  112s
     0     0 -1584.8418    0  680 -11652.714 -1584.8418  86.4%     -  114s
     0     0 -1588.3081    0  680 -11652.714 -1588.3081  86.4%     -  115s
     0     0 -1589.5707    0  686 -11652.714 -1589.5707  86.4%     -  116s
     0     0 -1677.2898    0  672 -11652.714 -1677.2898  85.6%     -  121s
     0     0 -1694.0243    0  713 -11652.714 -1694.0243  85.5%     -  125s
     0     0 -1699.0914    0  664 -11652.714 -1699.0914  85.4%     -  126s
     0     0 -1700.8051    0  731 -11652.714 -1700.8051  85.4%     -  127s
     0     0 -1701.8619    0  685 -11652.714 -1701.8619  85.4%     -  127s
     0     0 -1765.1483    0  724 -11652.714 -1765.1483  84.9%     -  131s
     0     0 -1795.2842    0  710 -11652.714 -1795.2842  84.6%     -  133s
     0     0 -1801.7472    0  666 -11652.714 -1801.7472  84.5%     -  134s
     0     0 -1805.7714    0  713 -11652.714 -1805.7714  84.5%     -  135s
     0     0 -1808.6884    0  670 -11652.714 -1808.6884  84.5%     -  135s
     0     0 -1810.5932    0  673 -11652.714 -1810.5932  84.5%     -  136s
     0     0 -1811.1150    0  676 -11652.714 -1811.1150  84.5%     -  136s
     0     0 -1849.1738    0  720 -11652.714 -1849.1738  84.1%     -  140s
     0     0 -1857.4598    0  719 -11652.714 -1857.4598  84.1%     -  142s
     0     0 -1862.0449    0  719 -11652.714 -1862.0449  84.0%     -  143s
     0     0 -1864.3729    0  727 -11652.714 -1864.3729  84.0%     -  144s
     0     0 -1864.9572    0  731 -11652.714 -1864.9572  84.0%     -  145s
     0     0 -1874.8797    0  680 -11652.714 -1874.8797  83.9%     -  147s
     0     0 -1877.1619    0  767 -11652.714 -1877.1619  83.9%     -  148s
     0     0 -1878.0534    0  771 -11652.714 -1878.0534  83.9%     -  149s
     0     0 -1894.3525    0  773 -11652.714 -1894.3525  83.7%     -  152s
     0     0 -1898.9216    0  760 -11652.714 -1898.9216  83.7%     -  153s
     0     0 -1900.5929    0  767 -11652.714 -1900.5929  83.7%     -  154s
     0     0 -1901.7162    0  778 -11652.714 -1901.7162  83.7%     -  154s
     0     0 -1908.3693    0  703 -11652.714 -1908.3693  83.6%     -  156s
     0     0 -1909.5318    0  782 -11652.714 -1909.5318  83.6%     -  156s
     0     0 -1911.2246    0  695 -11652.714 -1911.2246  83.6%     -  158s
H    0     0                    -11467.93162 -1911.2897  83.3%     -  162s
     0     0 -1912.3113    0  698 -11467.932 -1912.3113  83.3%     -  162s
     0     0 -1916.5051    0  786 -11467.932 -1916.5051  83.3%     -  164s
H    0     0                    -11465.54367 -1916.6115  83.3%     -  164s
     0     0 -1917.4138    0  702 -11465.544 -1917.4138  83.3%     -  164s
     0     0 -1919.8446    0  774 -11465.544 -1919.8446  83.3%     -  165s
     0     0 -1920.3860    0  774 -11465.544 -1920.3860  83.3%     -  167s
H    0     0                    -11358.78278 -1920.3860  83.1%     -  173s
H    0     0                    -11256.59056 -1920.3860  82.9%     -  173s
H    0     0                    -11218.25016 -1920.3860  82.9%     -  173s
H    0     0                    -11147.17176 -1920.3860  82.8%     -  173s
H    0     0                    -11102.96974 -1920.4695  82.7%     -  194s
H    0     0                    -11054.70953 -1920.4695  82.6%     -  196s
     0     2 -1920.4695    0  774 -11054.710 -1920.4695  82.6%     -  197s
     1     4 -2052.6515    1  671 -11054.710 -1920.4695  82.6%  4341  207s
     3     8 -2162.8960    2  684 -11054.710 -2053.1058  81.4%  6516  212s
     7    16 -2339.3917    3  684 -11054.710 -2163.5154  80.4%  5119  218s
    15    32 -2404.7473    4  671 -11054.710 -2339.4047  78.8%  5630  230s
    31    54 -4224.0352    5  602 -11054.710 -2404.7481  78.2%  6843  249s
H   32    54                    -10995.80508 -2404.7481  78.1%  6629  249s
H   53    86                    -10994.64555 -2404.7481  78.1%  8339  257s
H   56    86                    -10986.98184 -2404.7481  78.1%  8174  257s
    85   214 -3840.9826    7  645 -10986.982 -2404.7481  78.1%  6536  266s
   217   312 -4022.5828   10  606 -10986.982 -2404.7481  78.1%  3198  274s
   323   346 -3892.2352    8  622 -10986.982 -2404.7481  78.1%  2582  277s
   367   403 -4059.9210   11  552 -10986.982 -2404.7481  78.1%  2421  285s
   442   427 -4495.6303   12  519 -10986.982 -2404.7481  78.1%  2194  292s
   528   446 -5497.5841   11  419 -10986.982 -2404.7481  78.1%  2036  300s
   597   478 -5218.4044   13  527 -10986.982 -2404.7481  78.1%  2004  307s
   653   487 -7194.2343   20  442 -10986.982 -2404.7481  78.1%  1980  315s
   719   511 -6257.5554   13  497 -10986.982 -2404.7481  78.1%  1913  322s
   775   542 -6623.2360   14  433 -10986.982 -2404.7481  78.1%  1914  331s
   838   586 -5547.8879   14  511 -10986.982 -2404.7481  78.1%  1886  337s
   900   627     cutoff   29      -10986.982 -2404.7481  78.1%  1896  345s
   973   653 -6801.3521   15  433 -10986.982 -2404.7481  78.1%  1861  353s
  1068   686 -6156.3934   15  302 -10986.982 -2404.7481  78.1%  1818  360s
  1130   737 -7291.1213   16  285 -10986.982 -2404.7481  78.1%  1804  368s
  1223   779 -7607.5460   17  305 -10986.982 -2404.7481  78.1%  1756  375s
  1305   831 -7906.5921   19  206 -10986.982 -2447.4987  77.7%  1757  383s
  1391   876 -8486.5593   21  556 -10986.982 -2447.8868  77.7%  1749  392s
  1476   914 infeasible   20      -10986.982 -2447.8868  77.7%  1739  400s
  1587   981 -8783.5844   24  514 -10986.982 -2447.8868  77.7%  1720  408s
  1703  1008     cutoff   25      -10986.982 -2447.8868  77.7%  1694  417s
  1803  1060 -9187.3819   27  490 -10986.982 -2702.4625  75.4%  1673  427s
  1901  1076 -9831.6673   29  445 -10986.982 -2702.5613  75.4%  1652  436s
  1993  1112 -10031.694   31  323 -10986.982 -2702.5613  75.4%  1649  446s
  2077  1165 -10861.230   35  162 -10986.982 -2702.5613  75.4%  1657  456s
  2208  1213     cutoff   42      -10986.982 -2702.5613  75.4%  1649  465s
  2326  1239 -9599.5080   11  275 -10986.982 -3006.9341  72.6%  1627  474s
  2406  1284 -9633.9477   12  197 -10986.982 -3006.9341  72.6%  1622  484s
  2537  1337     cutoff   14      -10986.982 -3006.9341  72.6%  1618  495s
  2649  1417 -7945.3277    7  405 -10986.982 -3006.9341  72.6%  1617  506s
  2783  1504 -9635.4061   10  336 -10986.982 -3006.9341  72.6%  1615  517s
  2960  1600     cutoff   15      -10986.982 -3006.9341  72.6%  1592  528s
  3178  1647 -6777.0981    9  561 -10986.982 -3006.9341  72.6%  1561  540s
  3351  1668 -7253.5771   12  436 -10986.982 -3006.9341  72.6%  1558  553s
  3488  1718 -7979.6030   17  477 -10986.982 -3266.9908  70.3%  1562  565s
  3649  1796 -9581.1044   21  400 -10986.982 -3266.9908  70.3%  1574  578s
  3833  1858     cutoff   31      -10986.982 -4745.1954  56.8%  1580  593s
  4074  1872 -9267.3335   14  395 -10986.982 -4991.6921  54.6%  1576  601s
  4123  1897 -10115.871   15  594 -10986.982 -4991.6921  54.6%  1579  613s
  4179  1913 -10724.308   16  408 -10986.982 -4991.6921  54.6%  1578  624s
  4227  1968     cutoff   17      -10986.982 -4991.6921  54.6%  1582  637s
  4370  2033     cutoff   17      -10986.982 -4991.6921  54.6%  1570  651s
  4579  2153 -9390.6235   10  261 -10986.982 -4991.6921  54.6%  1574  668s
  4857  2227     cutoff   12      -10986.982 -5455.2386  50.3%  1569  681s
  5116  2301 -8502.2824    9  414 -10986.982 -5455.2386  50.3%  1569  696s
  5409  2364 -10371.117   15  290 -10986.982 -5668.1586  48.4%  1566  712s
  5737  2485     cutoff   12      -10986.982 -5815.7525  47.1%  1567  727s
  6073  2486 -9976.7944   20  774 -10986.982 -5945.4924  45.9%  1551  779s
  6075  2487 -8867.7924   12  450 -10986.982 -5945.4924  45.9%  1551  803s
  6076  2488 -7218.5756   14  590 -10986.982 -5945.4924  45.9%  1550  819s
  6077  2489 -10239.252   27  684 -10986.982 -5945.4924  45.9%  1550  834s
  6078  2489 -8382.5393   17  627 -10986.982 -5945.4924  45.9%  1550  843s
  6079  2490 -7471.1671   14  707 -10986.982 -5945.4924  45.9%  1550  852s
  6080  2491 -10467.744   27  751 -10986.982 -5945.4924  45.9%  1549  855s
  6082  2492 -10113.448   14  652 -10986.982 -5945.4924  45.9%  1549  862s
  6083  2493 -10178.061   22  663 -10986.982 -5945.4924  45.9%  1549  866s
  6084  2493 -9149.4342   25  725 -10986.982 -5945.4924  45.9%  1548  875s
  6087  2495 -9260.0724   15  677 -10986.982 -5945.4924  45.9%  1548  882s
  6088  2496 -7589.6039   10  698 -10986.982 -5945.4924  45.9%  1547  889s
  6089  2497 -8364.5169    9  742 -10986.982 -5945.4924  45.9%  1547  892s
  6090  2497 -10350.798   15  687 -10986.982 -5945.4924  45.9%  1547  895s
  6091  2498 -6622.7980    6  803 -10986.982 -5945.4924  45.9%  1547  902s
  6092  2499 -9300.6180   15  801 -10986.982 -5945.4924  45.9%  1546  907s
  6093  2499 -6296.2690   10  765 -10986.982 -5945.4924  45.9%  1546  912s
  6094  2500 -10097.305   19  765 -10986.982 -5945.4924  45.9%  1546  935s
  6095  2501 -9152.8300   18  765 -10986.982 -5945.4924  45.9%  1546  949s
  6096  2504 -5945.4924   12  812 -10986.982 -5945.4924  45.9%  1571  967s
  6098  2508 -5945.4924   13  806 -10986.982 -5945.4924  45.9%  1572  977s
  6102  2514 -5945.4924   14  739 -10986.982 -5945.4924  45.9%  1574  992s
  6110  2528 -5945.4924   15  740 -10986.982 -5945.4924  45.9%  1580 1008s
  6126  2537 -8941.9282   16  145 -10986.982 -5945.4924  45.9%  1597 1080s
  6143  2562 -5945.4924   17  546 -10986.982 -5945.4924  45.9%  1633 1091s
  6175  2605 -5945.4924   18  528 -10986.982 -5945.4924  45.9%  1639 1104s
  6272  2607 -6810.7727   21  539 -10986.982 -5945.4924  45.9%  1659 1115s
  6354  2585 -10210.765   21  145 -10986.982 -5945.4924  45.9%  1668 1126s
  6401  2584 -6076.5572   20  437 -10986.982 -5945.4924  45.9%  1673 1135s
  6463  2576 -6925.7828   22  536 -10986.982 -5945.4924  45.9%  1690 1144s
  6508  2580 -10742.716   22  171 -10986.982 -5945.4924  45.9%  1699 1156s
  6564  2576 -6116.7796   21  434 -10986.982 -5945.4924  45.9%  1710 1165s
  6625  2566 -6591.3134   23  362 -10986.982 -5945.4924  45.9%  1730 1174s
  6694  2564 -9338.8186   23  203 -10986.982 -5945.4924  45.9%  1744 1183s
H 6732  2425                    -10909.17958 -5945.4924  45.5%  1744 1183s
H 6763  2314                    -10871.32665 -5945.4924  45.3%  1750 1194s
H 6786  2193                    -10832.89814 -5945.4924  45.1%  1755 1194s
H 6813  2076                    -10825.80512 -5945.4924  45.1%  1756 1194s
  6839  2088     cutoff   25      -10825.805 -5945.4924  45.1%  1762 1204s
  6899  2101 -7234.8872   29  407 -10825.805 -5945.4924  45.1%  1788 1214s
H 6900  1998                    -10821.39251 -5945.4924  45.1%  1787 1214s
H 6908  1899                    -10775.44810 -5945.4924  44.8%  1787 1214s
  6965  1910 -7266.1560   30  315 -10775.448 -5945.4924  44.8%  1795 1225s
  7035  1917 -8100.5021   33  209 -10775.448 -5945.4924  44.8%  1814 1234s
  7121  1908     cutoff   34      -10775.448 -5945.4924  44.8%  1818 1242s
  7187  1906     cutoff   33      -10775.448 -5945.4924  44.8%  1818 1251s
  7271  1914 -10208.355   33  136 -10775.448 -5945.4924  44.8%  1821 1260s
  7357  1923 -6314.6421   19  482 -10775.448 -5945.4924  44.8%  1823 1272s
  7444  1934 -7054.1409   21  381 -10775.448 -5945.4924  44.8%  1827 1282s
  7540  1940 -8948.7173   25  440 -10775.448 -5945.4924  44.8%  1831 1293s
  7651  1930 -10609.625   27  184 -10775.448 -5945.4924  44.8%  1831 1308s
  7777  1910 -5945.4924   21  494 -10775.448 -5945.4924  44.8%  1830 1321s
  7900  1911 -7246.8558   22  425 -10775.448 -5945.4924  44.8%  1831 1333s
  8015  1891 -8742.2300   23  434 -10775.448 -5945.4924  44.8%  1833 1345s
  8136  1854 -8071.7565   21  489 -10775.448 -5945.4924  44.8%  1832 1358s
  8231  1845     cutoff   22      -10775.448 -5945.4924  44.8%  1834 1372s
  8321  1859     cutoff   27      -10775.448 -5945.4924  44.8%  1832 1384s
  8445  1846 -7607.3421   22  268 -10775.448 -5945.4924  44.8%  1835 1398s
  8594  1843 infeasible   26      -10775.448 -5945.4924  44.8%  1838 1412s
  8750  1811 -9353.2495   22  620 -10775.448 -5945.4924  44.8%  1843 1431s
  8925  1787     cutoff   24      -10775.448 -5945.4924  44.8%  1845 1446s
  9094  1763 -10371.615   25  456 -10775.448 -5945.4924  44.8%  1851 1463s
  9275  1730     cutoff   32      -10775.448 -6117.0942  43.2%  1850 1478s
  9478  1674 infeasible   25      -10775.448 -6287.2858  41.7%  1849 1495s
  9662  1633 -9226.1683   21  444 -10775.448 -6565.4496  39.1%  1848 1513s
  9888  1590 -8522.8582   23  343 -10775.448 -6565.4496  39.1%  1847 1531s
 10111  1553 -10678.496   28  463 -10775.448 -6624.6560  38.5%  1848 1550s
 10334  1507 -10638.088   31   91 -10775.448 -6797.6737  36.9%  1853 1568s
 10570  1436     cutoff   26      -10775.448 -6933.9581  35.7%  1857 1586s
 10807  1385 -9280.0864   25  553 -10775.448 -7136.9352  33.8%  1862 1606s
 11088  1280     cutoff   30      -10775.448 -7226.7856  32.9%  1857 1625s
 11415  1173 -9898.5640   27  336 -10775.448 -7390.8998  31.4%  1850 1645s
 11653  1085 -9631.4632   27  143 -10775.448 -7528.2056  30.1%  1843 1666s
*11766  1085              57    -10766.98206 -7528.2056  30.1%  1841 1666s
 11986  1051 infeasible   28      -10766.982 -7709.4803  28.4%  1839 1689s
 12316  1004 -10558.194   29  131 -10766.982 -7857.1496  27.0%  1839 1711s
 12742   844 -9657.6891   33  444 -10766.982 -8128.2698  24.5%  1825 1734s
H12798   844                    -10755.62424 -8213.7188  23.6%  1824 1734s
 13192   578 -10110.683   27  341 -10755.624 -8300.0350  22.8%  1809 1755s
 13737   307     cutoff   25      -10755.624 -8744.7647  18.7%  1777 1779s
*14079   307              30    -10738.93107 -8801.3443  18.0%  1755 1779s
 14349    36 -9984.0342   33  518 -10738.931 -9228.5275  14.1%  1742 1795s
*14414    36              55    -10713.69655 -9228.9184  13.9%  1736 1795s
H14876     0                    -10703.37774 -10645.877  0.54%  1699 1797s
H14889     0                    -10701.30401 -10694.756  0.06%  1697 1797s

Cutting planes:
  Learned: 2
  MIR: 833
  Flow cover: 1992
  GUB cover: 1
  Zero half: 14
  RLT: 41
  Relax-and-lift: 101

Explored 14947 nodes (25449256 simplex iterations) in 1797.11 seconds (4704.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10701.3 -10703.4 -10713.7 ... -10832.9
No other solutions better than -10701.3

Optimal solution found (tolerance 1.00e-06)
Best objective -1.070130400762e+04, best bound -1.070130400762e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1797.12s
  Master Objective (UB) = -10701.30, θ = 119259.68
  Upper Bound (UB) = -10701.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119259.68
  [DEBUG]   ✓ Scenario 0: θ = 119259.68 ≤ Q = 119259.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119259.68 ≤ Q = 119259.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119259.68 ≤ Q = 119259.68 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119259.68 ≤ Q = 119270.04 (slack: 10.36)
  [DEBUG]   ✓ Scenario 4: θ = 119259.68 ≤ Q = 119259.68 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x571c6399
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x571c6399
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.225027e+13
Presolve removed 2590 rows and 1881 columns
Presolve time: 0.00s
Presolved: 503 rows, 508 columns, 1420 nonzeros
Found heuristic solution: objective 6504429.3346
Variable types: 342 continuous, 166 integer (166 binary)

Root relaxation: objective -1.175888e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117588.83    0  123 6504429.33 -117588.83   102%     -    0s
H    0     0                    -83616.92423 -117588.83  40.6%     -    0s
H    0     0                    -86466.27877 -117588.83  36.0%     -    0s
H    0     0                    -95418.46835 -117588.83  23.2%     -    0s
     0     0 -102427.32    0   87 -95418.468 -102427.32  7.35%     -    0s
H    0     0                    -100171.7839 -102370.60  2.20%     -    0s
     0     0 -101975.86    0   87 -100171.78 -101975.86  1.80%     -    0s
     0     0 -101962.26    0   87 -100171.78 -101962.26  1.79%     -    0s
H    0     0                    -100682.0583 -101962.26  1.27%     -    0s
     0     0 -101696.62    0   71 -100682.06 -101696.62  1.01%     -    0s
     0     0 -101636.97    0   72 -100682.06 -101636.97  0.95%     -    0s
     0     0 -101619.91    0   77 -100682.06 -101619.91  0.93%     -    0s
     0     0 -101618.83    0   77 -100682.06 -101618.83  0.93%     -    0s
H    0     0                    -100882.9306 -101618.83  0.73%     -    0s
     0     0 -101408.85    0   53 -100882.93 -101408.85  0.52%     -    0s
H    0     0                    -100884.2990 -101408.72  0.52%     -    0s
     0     0 -101388.60    0   51 -100884.30 -101388.60  0.50%     -    0s
     0     0 -101384.68    0   52 -100884.30 -101384.68  0.50%     -    0s
     0     0 -101149.80    0   21 -100884.30 -101149.80  0.26%     -    0s
     0     0 -101149.73    0   21 -100884.30 -101149.73  0.26%     -    0s
     0     0 -101137.89    0   19 -100884.30 -101137.89  0.25%     -    0s
     0     0 -101066.80    0   23 -100884.30 -101066.80  0.18%     -    0s
     0     0 -101066.80    0   19 -100890.83 -101066.80  0.17%     -    0s
     0     0 -100987.69    0    9 -100890.83 -100987.69  0.10%     -    0s
     0     0 -100985.47    0    8 -100890.83 -100985.47  0.09%     -    0s
H    0     0                    -100941.6659 -100985.47  0.04%     -    0s
     0     0 -100966.29    0    3 -100941.67 -100966.29  0.02%     -    0s
     0     0 -100959.78    0    4 -100941.67 -100959.78  0.02%     -    0s
H    0     0                    -100958.2969 -100959.78  0.00%     -    0s
     0     0     cutoff    0      -100958.30 -100958.30  0.00%     -    0s

Cutting planes:
  Gomory: 2

Explored 1 nodes (958 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -100958 -100942 -100939 ... -83616.9
No other solutions better than -100958

Optimal solution found (tolerance 1.00e-06)
Best objective -1.009582969232e+05, best bound -1.009582969232e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 101400.30
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100958.30
  [DEBUG]   S×d_nominal = 202358.59
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202358.59 + -100958.30 = 101400.30
  [DEBUG]   Current θ from Master = 119259.68
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17859.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -28560.69
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 2317.4099, Absolute Gap = 2317.4099, Relative Gap = 0.216554
  Not converged yet (gap = 2317.41 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264977 nonzeros
Model fingerprint: 0xb5dc041a
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 40016 rows and 16246 columns
Presolve time: 0.83s
Presolved: 53107 rows, 23454 columns, 329759 nonzeros
Variable types: 21195 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53107 rows, 23454 columns, 329759 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34826   -2.7379175e+04   0.000000e+00   8.236279e+06      5s
   47053   -4.9697471e+03   0.000000e+00   1.263666e+07     10s
   54730   -2.1519340e+03   0.000000e+00   1.060332e+09     15s
   62617    1.9288278e+03   0.000000e+00   3.429862e+06     20s
Concurrent spin time: 5.88s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 47088 iterations, 23.47 seconds (42.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -190756.93 8091.90663   104%     -   24s
H    0     0                    -178948.8193 8091.90663   105%     -   24s
H    0     0                    -159861.7244 8091.90663   105%     -   24s
H    0     0                    -152650.3912 8091.90663   105%     -   24s
H    0     0                    -128157.9088 8091.90663   106%     -   25s
H    0     0                    -118489.1300 8091.90663   107%     -   25s
H    0     0                    -79983.72784 8091.90663   110%     -   25s
H    0     0                    -79940.73087 8091.90663   110%     -   25s
H    0     0                    -70615.71958 8091.90663   111%     -   25s
H    0     0                    -70568.33639 8091.90663   111%     -   25s
H    0     0                    -63147.31482 8091.90663   113%     -   25s
H    0     0                    -59801.26668 8091.90663   114%     -   25s
H    0     0                    -47330.02988 8091.90663   117%     -   26s
H    0     0                    -46293.27574 8091.90663   117%     -   26s
H    0     0                    -46289.24191 8091.90663   117%     -   26s
H    0     0                    -46281.61016 8091.90663   117%     -   26s
H    0     0                    -46266.26314 8091.90663   117%     -   26s
H    0     0                    -46258.63140 8091.90663   117%     -   26s
H    0     0                    -46250.19703 8091.90663   117%     -   26s
     0     0 3319.89952    0  450 -46250.197 3319.89952   107%     -   37s
H    0     0                    -46159.81128 3319.31878   107%     -   39s
     0     0 2907.92992    0  443 -46159.811 2907.92992   106%     -   42s
     0     0 2876.40908    0  513 -46159.811 2876.40908   106%     -   44s
     0     0 2876.40908    0  514 -46159.811 2876.40908   106%     -   47s
     0     0 2876.40908    0  437 -46159.811 2876.40908   106%     -   48s
     0     0 2876.40908    0  444 -46159.811 2876.40908   106%     -   50s
     0     0 2876.40908    0  441 -46159.811 2876.40908   106%     -   50s
     0     0 2876.40908    0  443 -46159.811 2876.40908   106%     -   50s
     0     0 1262.26101    0  613 -46159.811 1262.26101   103%     -   62s
H    0     0                    -33763.15305 1262.26101   104%     -   63s
H    0     0                    -33588.90167 1262.26101   104%     -   63s
H    0     0                    -33543.78650 1262.26101   104%     -   63s
H    0     0                    -33535.38244 1262.26101   104%     -   63s
H    0     0                    -33318.86670 1262.26101   104%     -   63s
H    0     0                    -33314.94501 1262.26101   104%     -   63s
H    0     0                    -33306.71712 1262.26101   104%     -   63s
H    0     0                    -33298.65631 1262.26101   104%     -   63s
H    0     0                    -33111.69224 1262.26101   104%     -   63s
H    0     0                    -33066.57707 1262.26101   104%     -   63s
H    0     0                    -33041.26205 1262.26101   104%     -   63s
     0     0 1151.01081    0  601 -33041.262 1151.01081   103%     -   67s
     0     0  953.73868    0  614 -33041.262  953.73868   103%     -   72s
     0     0  925.07426    0  622 -33041.262  925.07426   103%     -   75s
     0     0  882.01700    0  632 -33041.262  882.01700   103%     -   77s
H    0     0                    -13913.37523  825.62793   106%     -   79s
H    0     0                    -12095.43218  825.62793   107%     -   79s
H    0     0                    -11812.70650  825.62793   107%     -   79s
     0     0  825.62793    0  627 -11812.706  825.62793   107%     -   79s
     0     0  823.88124    0  629 -11812.706  823.88124   107%     -   79s
     0     0  817.66688    0  635 -11812.706  817.66688   107%     -   80s
     0     0  817.64749    0  635 -11812.706  817.64749   107%     -   80s
     0     0 -130.35236    0  652 -11812.706 -130.35236  98.9%     -   98s
H    0     0                    -11808.20024 -130.36288  98.9%     -   98s
     0     0 -294.34375    0  614 -11808.200 -294.34375  97.5%     -  102s
     0     0 -410.99437    0  614 -11808.200 -410.99437  96.5%     -  106s
     0     0 -424.74977    0  674 -11808.200 -424.74977  96.4%     -  108s
     0     0 -430.79736    0  617 -11808.200 -430.79736  96.4%     -  109s
     0     0 -435.70494    0  623 -11808.200 -435.70494  96.3%     -  110s
     0     0 -436.99407    0  676 -11808.200 -436.99407  96.3%     -  110s
     0     0 -437.98623    0  623 -11808.200 -437.98623  96.3%     -  111s
H    0     0                    -11801.57556 -437.98623  96.3%     -  119s
H    0     0                    -11800.99100 -1064.9510  91.0%     -  133s
     0     0 -1064.9510    0  677 -11800.991 -1064.9510  91.0%     -  133s
     0     0 -1236.6044    0  685 -11800.991 -1236.6044  89.5%     -  140s
     0     0 -1315.4366    0  667 -11800.991 -1315.4366  88.9%     -  144s
     0     0 -1402.8944    0  663 -11800.991 -1402.8944  88.1%     -  148s
     0     0 -1420.2182    0  689 -11800.991 -1420.2182  88.0%     -  151s
     0     0 -1431.4927    0  689 -11800.991 -1431.4927  87.9%     -  154s
     0     0 -1435.3853    0  690 -11800.991 -1435.3853  87.8%     -  155s
     0     0 -1437.0169    0  692 -11800.991 -1437.0169  87.8%     -  155s
     0     0 -1442.1659    0  696 -11800.991 -1442.1659  87.8%     -  157s
     0     0 -1442.5584    0  698 -11800.991 -1442.5584  87.8%     -  157s
     0     0 -1571.9327    0  725 -11800.991 -1571.9327  86.7%     -  165s
     0     0 -1595.7585    0  742 -11800.991 -1595.7585  86.5%     -  168s
     0     0 -1602.4089    0  729 -11800.991 -1602.4089  86.4%     -  170s
     0     0 -1604.4670    0  742 -11800.991 -1604.4670  86.4%     -  171s
     0     0 -1605.6748    0  737 -11800.991 -1605.6748  86.4%     -  171s
     0     0 -1679.6052    0  733 -11800.991 -1679.6052  85.8%     -  180s
H    0     0                    -11707.21384 -1680.0160  85.6%     -  182s
H    0     0                    -11698.78589 -1680.0160  85.6%     -  182s
H    0     0                    -11675.21353 -1680.0160  85.6%     -  182s
     0     0 -1704.4529    0  740 -11675.214 -1704.4529  85.4%     -  185s
     0     0 -1711.1069    0  746 -11675.214 -1711.1069  85.3%     -  187s
     0     0 -1713.9993    0  757 -11675.214 -1713.9993  85.3%     -  188s
     0     0 -1715.2785    0  763 -11675.214 -1715.2785  85.3%     -  188s
     0     0 -1729.5674    0  680 -11675.214 -1729.5674  85.2%     -  191s
     0     0 -1733.9680    0  689 -11675.214 -1733.9680  85.1%     -  192s
     0     0 -1735.5512    0  696 -11675.214 -1735.5512  85.1%     -  193s
     0     0 -1736.1330    0  702 -11675.214 -1736.1330  85.1%     -  194s
     0     0 -1748.5061    0  696 -11675.214 -1748.5061  85.0%     -  197s
H    0     0                    -11668.26839 -1748.5256  85.0%     -  198s
     0     0 -1750.5667    0  691 -11668.268 -1750.5667  85.0%     -  198s
     0     0 -1751.6872    0  692 -11668.268 -1751.6872  85.0%     -  199s
     0     0 -1763.5434    0  699 -11668.268 -1763.5434  84.9%     -  201s
     0     0 -1766.4125    0  706 -11668.268 -1766.4125  84.9%     -  202s
     0     0 -1769.4585    0  701 -11668.268 -1769.4585  84.8%     -  203s
     0     0 -1769.7487    0  704 -11668.268 -1769.7487  84.8%     -  204s
     0     0 -1778.0810    0  687 -11668.268 -1778.0810  84.8%     -  206s
     0     0 -1781.7990    0  704 -11668.268 -1781.7990  84.7%     -  211s
     0     0 -1782.6371    0  704 -11668.268 -1782.6371  84.7%     -  211s
     0     0 -1789.9556    0  701 -11668.268 -1789.9556  84.7%     -  213s
     0     0 -1792.0647    0  700 -11668.268 -1792.0647  84.6%     -  214s
     0     0 -1792.9254    0  715 -11668.268 -1792.9254  84.6%     -  215s
     0     0 -1809.0064    0  710 -11668.268 -1809.0064  84.5%     -  218s
     0     0 -1814.1729    0  703 -11668.268 -1814.1729  84.5%     -  220s
     0     0 -1817.0510    0  705 -11668.268 -1817.0510  84.4%     -  223s
     0     0 -1818.1875    0  710 -11668.268 -1818.1875  84.4%     -  224s
     0     0 -1828.4328    0  768 -11668.268 -1828.4328  84.3%     -  226s
     0     0 -1830.2387    0  710 -11668.268 -1830.2387  84.3%     -  227s
     0     0 -1831.1116    0  712 -11668.268 -1831.1116  84.3%     -  228s
     0     0 -1839.8359    0  713 -11668.268 -1839.8359  84.2%     -  231s
     0     0 -1841.8668    0  714 -11668.268 -1841.8668  84.2%     -  233s
     0     0 -1843.2854    0  728 -11668.268 -1843.2854  84.2%     -  234s
     0     0 -1844.4530    0  724 -11668.268 -1844.4530  84.2%     -  235s
     0     0 -1844.6741    0  725 -11668.268 -1844.6741  84.2%     -  235s
     0     0 -1846.8274    0  727 -11668.268 -1846.8274  84.2%     -  237s
     0     0 -1846.9400    0  727 -11668.268 -1846.9400  84.2%     -  239s
     0     2 -1846.9493    0  727 -11668.268 -1846.9493  84.2%     -  281s
     1     4 -1940.7549    1  692 -11668.268 -1847.0599  84.2%  4255  288s
     3     8 -2143.2185    2  686 -11668.268 -1941.8644  83.4%  4927  300s
     7    16 -2266.1097    3  673 -11668.268 -2144.3796  81.6%  5341  310s
    15    32 -2379.3401    4  693 -11668.268 -2267.6073  80.6%  4961  324s
H   31    53                    -11662.27135 -2379.3409  79.6%  6281  343s
    52    85 -5161.8206    6  505 -11662.271 -2379.3632  79.6%  7116  354s
H   84   200                    -11638.95084 -2379.3632  79.6%  5836  366s
H  111   200                    -11312.35684 -2379.3632  79.0%  4756  366s
H  192   200                    -11312.18762 -2379.3632  79.0%  3277  366s
H  207   230                    -11291.67188 -2379.3632  78.9%  3076  375s
H  210   230                    -11286.62923 -2379.3632  78.9%  3055  375s
H  213   230                    -11266.90931 -2379.3632  78.9%  3027  375s
H  218   230                    -11266.11349 -2379.3632  78.9%  2980  375s
   284   263 -5609.9990   10  450 -11266.113 -2379.3632  78.9%  2570  384s
   343   307 infeasible    8      -11266.113 -2379.3632  78.9%  2399  393s
   411   329 -7126.2203   12  394 -11266.113 -2379.3632  78.9%  2298  401s
   464   355 infeasible   12      -11266.113 -2379.3632  78.9%  2210  409s
   521   387 -7520.1114   13  296 -11266.113 -2379.3632  78.9%  2207  418s
   559   418 -7498.8380   14  308 -11266.113 -2379.3632  78.9%  2206  426s
   608   455 -7592.2686   15  248 -11266.113 -2379.3632  78.9%  2200  433s
   663   487 -7880.4843   16  541 -11266.113 -2379.3632  78.9%  2193  441s
   715   540 infeasible   14      -11266.113 -2379.3632  78.9%  2156  448s
   780   585 -8463.0141   17  341 -11266.113 -2379.3632  78.9%  2133  456s
   858   606 -8590.5717   18  356 -11266.113 -2379.3632  78.9%  2084  463s
   897   638 -8738.7935   19  303 -11266.113 -2379.3632  78.9%  2090  479s
   945   668 -9023.3175   20  272 -11266.113 -2379.3632  78.9%  2091  486s
   999   689 -8981.5014   20  291 -11266.113 -2379.3632  78.9%  2057  494s
  1051   720 -10963.315   21  266 -11266.113 -2379.3632  78.9%  2037  505s
  1112   763 -10104.804   21  320 -11266.113 -2379.3632  78.9%  2017  514s
  1177   810 -10347.436   22  250 -11266.113 -2379.3632  78.9%  2000  521s
  1254   869 -11024.553   26  173 -11266.113 -2379.3632  78.9%  1972  530s
  1353   904 infeasible   29      -11266.113 -2379.3632  78.9%  1936  541s
  1440   939 -5391.6038   10  505 -11266.113 -2379.3632  78.9%  1933  551s
  1529   976 -9149.3792   11  133 -11266.113 -2379.3632  78.9%  1931  562s
  1604  1028 infeasible   12      -11266.113 -2379.3632  78.9%  1933  572s
  1713  1070 -10658.199   22  100 -11266.113 -2379.3632  78.9%  1926  582s
  1862  1087 infeasible   31      -11266.113 -2379.3632  78.9%  1875  593s
  1907  1121 -4807.0959    8  668 -11266.113 -2467.5186  78.1%  1904  604s
  1960  1150 -4900.8266   10  655 -11266.113 -2468.0726  78.1%  1915  615s
  2027  1197 -5574.0519   12  560 -11266.113 -2468.0726  78.1%  1926  627s
  2135  1245 -5949.5761   13  621 -11266.113 -2468.0726  78.1%  1909  642s
  2245  1303 -9978.4128   14  674 -11266.113 -2468.0726  78.1%  1909  657s
  2380  1353 -10104.013   15  613 -11266.113 -2468.0726  78.1%  1885  670s
  2494  1414 -10801.432   17  567 -11266.113 -2468.0726  78.1%  1881  685s
  2644  1457 -11256.518   20  529 -11266.113 -3076.7710  72.7%  1866  697s
  2729  1509 infeasible   21      -11266.113 -3076.7710  72.7%  1871  712s
  2865  1561 -6725.8583   18  393 -11266.113 -3076.7710  72.7%  1866  730s
  2997  1607 -9097.8373   19  346 -11266.113 -3076.7710  72.7%  1873  748s
  3105  1699 -9705.4792   21  244 -11266.113 -3076.7710  72.7%  1880  763s
  3281  1783 -10736.448   27  389 -11266.113 -4018.5701  64.3%  1871  782s
  3488  1893 -7446.5381    9  498 -11266.113 -4108.8812  63.5%  1858  797s
  3741  1970 -5562.4576    9  492 -11266.113 -4108.8812  63.5%  1833  812s
  3968  2075 infeasible   12      -11266.113 -4397.4122  61.0%  1799  829s
  4174  2180 -10551.499   12  213 -11266.113 -4453.9767  60.5%  1802  846s
  4408  2262 -8617.0199   12  186 -11266.113 -4510.6210  60.0%  1795  866s
  4661  2413 -7741.2219   11  481 -11266.113 -4719.4478  58.1%  1791  884s
  4927  2414 -10526.887   40  727 -11266.113 -4766.1929  57.7%  1782  948s
  4929  2415 -8109.1966   16  450 -11266.113 -4766.1929  57.7%  1782  974s
  4930  2416 -8851.9313   16  703 -11266.113 -4766.1929  57.7%  1781  999s
  4931  2417 -10429.226   16  624 -11266.113 -4766.1929  57.7%  1781 1020s
  4932  2417 -7768.2622   17  666 -11266.113 -4766.1929  57.7%  1781 1035s
  4933  2418 -8436.5826   14  799 -11266.113 -4766.1929  57.7%  1780 1048s
  4934  2419 -9380.2892   29  707 -11266.113 -4766.1929  57.7%  1780 1055s
  4935  2419 -7016.3719   13  772 -11266.113 -4766.1929  57.7%  1779 1060s
  4936  2420 -10014.545   34  731 -11266.113 -4766.1929  57.7%  1779 1067s
  4937  2421 -6647.4219    8  704 -11266.113 -4766.1929  57.7%  1779 1070s
  4939  2422 -9256.3025   34  719 -11266.113 -4766.1929  57.7%  1778 1077s
  4940  2423 -5340.1642    8  708 -11266.113 -4766.1929  57.7%  1778 1090s
  4941  2423 -7997.1808   30  816 -11266.113 -4766.1929  57.7%  1777 1096s
  4942  2424 -9399.8393   24  716 -11266.113 -4766.1929  57.7%  1777 1100s
  4944  2425 -8603.4918   17  768 -11266.113 -4766.1929  57.7%  1776 1107s
  4945  2426 -10467.776   37  815 -11266.113 -4766.1929  57.7%  1776 1123s
  4946  2427 -6577.7346   16  753 -11266.113 -4766.1929  57.7%  1775 1127s
  4947  2427 -10725.225   39  765 -11266.113 -4766.1929  57.7%  1775 1130s
  4949  2429 -10696.948   17  830 -11266.113 -4766.1929  57.7%  1774 1142s
  4950  2429 -8906.1030   19  821 -11266.113 -4766.1929  57.7%  1774 1147s
  4951  2430 -8523.2399   25  861 -11266.113 -4766.1929  57.7%  1774 1156s
  4952  2431 -10323.906   48  727 -11266.113 -4766.1929  57.7%  1773 1161s
  4953  2431 -6084.9402   12  705 -11266.113 -4766.1929  57.7%  1773 1165s
  4954  2432 -8872.6701   18  838 -11266.113 -4766.1929  57.7%  1773 1171s
  4955  2433 -9819.8653   29  848 -11266.113 -4766.1929  57.7%  1772 1175s
  4956  2433 -5257.3088   12  835 -11266.113 -4766.1929  57.7%  1772 1182s
  4957  2434 -8120.7896   18  835 -11266.113 -4766.1929  57.7%  1772 1206s
H 4957  2311                    -11146.14634 -4766.1929  57.2%  1772 1228s
H 4957  2195                    -11114.55187 -4766.1929  57.1%  1772 1228s
H 4957  2085                    -11069.92970 -4766.1929  56.9%  1772 1229s
H 4958  1983                    -11052.77659 -4766.1929  56.9%  1816 1230s
  4959  1984 -4766.1929   15  737 -11052.777 -4766.1929  56.9%  1817 1243s
  4961  1988 -4766.1929   16  727 -11052.777 -4766.1929  56.9%  1820 1256s
  4965  1994 -4766.1929   17  748 -11052.777 -4766.1929  56.9%  1822 1275s
  4973  2008 -4766.1929   18  768 -11052.777 -4766.1929  56.9%  1829 1297s
  4989  2021 -7104.0660   19  226 -11052.777 -4766.1929  56.9%  1857 1336s
  5008  2039 -7958.9474   20  740 -11052.777 -4766.1929  56.9%  1912 1354s
H 5040  2029                    -11051.61707 -4766.1929  56.9%  1947 1374s
H 5041  1934                    -11032.60101 -4766.1929  56.8%  1950 1374s
H 5046  1842                    -11004.39526 -4766.1929  56.7%  1953 1374s
H 5102  1739                    -10996.01707 -4766.1929  56.7%  1989 1374s
H 5133  1647                    -10988.14137 -4766.1929  56.6%  1994 1374s
  5155  1677 -8499.3319   22  775 -10988.141 -4766.1929  56.6%  2002 1385s
  5232  1660 -8553.3019   23  746 -10988.141 -4766.1929  56.6%  2035 1396s
H 5244  1579                    -10986.98184 -4766.1929  56.6%  2038 1396s
  5267  1569 -6626.5352   26  533 -10986.982 -4766.1929  56.6%  2047 1407s
  5299  1570 -8674.0778   24  739 -10986.982 -4766.1929  56.6%  2065 1418s
  5333  1567 -8787.9550   26  427 -10986.982 -4766.1929  56.6%  2090 1429s
  5377  1553 -9411.0228   27  328 -10986.982 -4766.1929  56.6%  2105 1442s
  5420  1554 -10091.896   28  436 -10986.982 -4766.1929  56.6%  2126 1456s
  5460  1547 -8154.8638   31  393 -10986.982 -4766.1929  56.6%  2151 1469s
  5512  1544 -8557.4734   34  169 -10986.982 -4766.1929  56.6%  2181 1482s
  5564  1542     cutoff   36      -10986.982 -4766.1929  56.6%  2210 1493s
  5613  1540 -9263.7238   36  310 -10986.982 -4766.1929  56.6%  2237 1503s
  5672  1540 -9361.4049   38  163 -10986.982 -4766.1929  56.6%  2267 1520s
  5726  1540 -9608.6232   41  223 -10986.982 -4766.1929  56.6%  2289 1531s
  5785  1537     cutoff   42      -10986.982 -4766.1929  56.6%  2315 1543s
  5850  1526 -10331.888   42  330 -10986.982 -4766.1929  56.6%  2334 1559s
  5916  1509 infeasible   47      -10986.982 -4766.1929  56.6%  2358 1572s
  5972  1500 -7152.1193   25  328 -10986.982 -4766.1929  56.6%  2394 1588s
  6007  1502 -7883.2124   26  218 -10986.982 -4766.1929  56.6%  2413 1606s
  6059  1514 -9084.6685   28  273 -10986.982 -4766.1929  56.6%  2444 1619s
  6128  1509 -9262.0307   31  261 -10986.982 -4766.1929  56.6%  2473 1638s
  6188  1509 -10231.178   35  499 -10986.982 -4766.1929  56.6%  2505 1658s
  6274  1490 -10629.246   40  213 -10986.982 -4766.1929  56.6%  2539 1673s
  6350  1501 infeasible   28      -10986.982 -4766.1929  56.6%  2572 1688s
  6420  1519 -5632.8700   22  710 -10986.982 -4766.1929  56.6%  2618 1702s
  6515  1520 -6031.1687   23  730 -10986.982 -4766.1929  56.6%  2649 1721s
  6603  1498 -7197.2449   24  624 -10986.982 -4766.1929  56.6%  2685 1741s
  6699  1520 -10410.595   25  524 -10986.982 -4766.1929  56.6%  2737 1759s
  6802  1528 -10415.412   26  458 -10986.982 -4766.1929  56.6%  2771 1776s
  6896  1533     cutoff   27      -10986.982 -4766.1929  56.6%  2819 1796s
  7004  1518 -9536.2482   25  228 -10986.982 -4766.1929  56.6%  2849 1815s
  7126  1480     cutoff   26      -10986.982 -4766.1929  56.6%  2888 1835s
  7248  1485 infeasible   36      -10986.982 -4766.1929  56.6%  2936 1859s
  7364  1486 -6058.2073   24  651 -10986.982 -4766.1929  56.6%  2986 1880s
  7528  1466 -6604.9950   26  671 -10986.982 -4766.1929  56.6%  3019 1903s
  7664  1444 -7837.7621   27  442 -10986.982 -4766.1929  56.6%  3070 1933s
  7825  1424 -10541.657   28  362 -10986.982 -5224.8653  52.4%  3112 1957s
  7987  1394 -9338.6035   28  414 -10986.982 -5224.8653  52.4%  3171 1981s
  8136  1332 -10726.796   30  315 -10986.982 -5661.9595  48.5%  3231 2005s
  8199  1333     cutoff   29      -10986.982 -5661.9595  48.5%  3269 2031s
  8285  1327 -10884.864   32  196 -10986.982 -6717.8655  38.9%  3298 2056s
  8389  1291     cutoff   33      -10986.982 -6717.8655  38.9%  3326 2081s
  8521  1244 infeasible   32      -10986.982 -6966.4905  36.6%  3376 2108s
  8671  1208 -9964.7505   35  355 -10986.982 -6966.4905  36.6%  3423 2135s
  8899  1161 -10603.849   36  347 -10986.982 -6966.4905  36.6%  3479 2162s
  9129  1064 -8858.2404   34  324 -10986.982 -7645.7779  30.4%  3536 2193s
  9378   980 infeasible   43      -10986.982 -7645.7779  30.4%  3591 2220s
  9474   953 -10376.105   43  183 -10986.982 -7645.7779  30.4%  3620 2250s
  9736   931 -10805.603   37  407 -10986.982 -8049.4398  26.7%  3653 2282s
* 9766   931              38    -10986.30886 -8059.3519  26.6%  3648 2282s
 10044   835 -10454.948   28  146 -10986.309 -8272.8758  24.7%  3683 2318s
 10421   718 -9720.6050   34  347 -10986.309 -8497.2824  22.7%  3700 2352s
*10581   718              50    -10959.20163 -8661.7720  21.0%  3711 2352s
*10721   718              82    -10928.24955 -8692.3986  20.5%  3705 2352s
 10835   406 infeasible   27      -10928.250 -8740.8232  20.0%  3705 2392s
H11191   406                    -10927.48053 -8912.5639  18.4%  3673 2392s
*11194   406              46    -10925.31910 -8912.5639  18.4%  3672 2392s
 11399    78 infeasible   37      -10925.319 -9004.7285  17.6%  3662 2428s
*11627    78              48    -10924.41398 -9271.4818  15.1%  3629 2428s
*11740    78              36    -10738.93107 -9271.4818  13.7%  3622 2428s
 11843     2 -10165.753   22  586 -10738.931 -9271.4818  13.7%  3609 2459s

Cutting planes:
  Learned: 2
  MIR: 1049
  Mixing: 1
  Flow cover: 2355
  Zero half: 9
  RLT: 50
  Relax-and-lift: 149

Explored 11939 nodes (43126475 simplex iterations) in 2459.81 seconds (6769.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10738.9 -10924.4 -10925.3 ... -10996
No other solutions better than -10738.9

Optimal solution found (tolerance 1.00e-06)
Best objective -1.073893106756e+04, best bound -1.073893106756e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2459.87s
  Master Objective (UB) = -10738.93, θ = 110891.57
  Upper Bound (UB) = -10738.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110891.57
  [DEBUG]   ✓ Scenario 0: θ = 110891.57 ≤ Q = 110891.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110891.57 ≤ Q = 110891.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110891.57 ≤ Q = 110891.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110891.57 ≤ Q = 110891.57 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110891.57 ≤ Q = 110891.57 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110891.57 ≤ Q = 110891.57 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x62f57847
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x62f57847
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.316569e+13
Presolve removed 2584 rows and 1876 columns
Presolve time: 0.00s
Presolved: 509 rows, 513 columns, 1436 nonzeros
Found heuristic solution: objective 6779943.4603
Variable types: 346 continuous, 167 integer (167 binary)

Root relaxation: objective -1.282362e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128236.23    0  131 6779943.46 -128236.23   102%     -    0s
H    0     0                    -90240.64333 -128236.23  42.1%     -    0s
H    0     0                    -101346.7894 -128236.23  26.5%     -    0s
     0     0 -107840.63    0   37 -101346.79 -107840.63  6.41%     -    0s
H    0     0                    -107209.8969 -107771.60  0.52%     -    0s
H    0     0                    -107310.4588 -107491.39  0.17%     -    0s
     0     0 -107491.39    0   33 -107310.46 -107491.39  0.17%     -    0s
     0     0 -107392.01    0   11 -107310.46 -107392.01  0.08%     -    0s
     0     0 -107390.73    0   11 -107310.46 -107390.73  0.07%     -    0s
     0     0 -107390.54    0   11 -107310.46 -107390.54  0.07%     -    0s
     0     0 -107370.61    0    6 -107310.46 -107370.61  0.06%     -    0s
     0     0 -107370.61    0   16 -107310.46 -107370.61  0.06%     -    0s
     0     0 -107337.77    0    2 -107310.46 -107337.77  0.03%     -    0s
H    0     0                    -107337.3063 -107337.31  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 8
  Flow cover: 4

Explored 1 nodes (562 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -107337 -107310 -101347 ... 1.31657e+13
No other solutions better than -107337

Optimal solution found (tolerance 1.00e-06)
Best objective -1.073373063188e+05, best bound -1.073373063188e+05, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 95930.87
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107337.31
  [DEBUG]   S×d_nominal = 203268.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 203268.18 + -107337.31 = 95930.87
  [DEBUG]   Current θ from Master = 110891.57
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14960.70 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25699.63
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 2279.7828, Absolute Gap = 2279.7828, Relative Gap = 0.212291
  Not converged yet (gap = 2279.78 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308220 nonzeros
Model fingerprint: 0x5d4f4d91
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 46702 rows and 18962 columns
Presolve time: 1.02s
Presolved: 61711 rows, 26978 columns, 383749 nonzeros
Variable types: 24719 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 61711 rows, 26978 columns, 383749 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33247   -4.6084396e+04   0.000000e+00   2.616395e+10      5s
   43879   -9.0920770e+03   0.000000e+00   1.423397e+07     10s
   50435   -2.1290928e+03   0.000000e+00   3.636585e+06     15s
   57967    1.1112588e+03   0.000000e+00   3.753283e+06     20s
   64183    2.0857185e+03   0.000000e+00   3.198061e+06     25s
   70031    2.3461333e+03   0.000000e+00   3.774153e+05     30s
   76385    4.3185098e+03   0.000000e+00   4.748899e+06     35s
Concurrent spin time: 11.14s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 74189 iterations, 48.93 seconds (86.72 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -190756.93 8091.90663   104%     -   50s
H    0     0                    -179650.1956 8091.90663   105%     -   50s
H    0     0                    -136360.1387 8091.90663   106%     -   50s
H    0     0                    -134503.8068 8091.90663   106%     -   50s
H    0     0                    -124851.4231 8091.90663   106%     -   50s
H    0     0                    -124496.7364 8091.90663   106%     -   50s
H    0     0                    -112229.2262 8091.90663   107%     -   50s
H    0     0                    -103854.2447 8091.90663   108%     -   50s
H    0     0                    -103699.5279 8091.90663   108%     -   50s
H    0     0                    -80223.30881 8091.90663   110%     -   50s
H    0     0                    -63530.67715 8091.90663   113%     -   51s
H    0     0                    -59945.70670 8091.90663   113%     -   51s
H    0     0                    -48936.85345 8091.90663   117%     -   52s
H    0     0                    -48889.47025 8091.90663   117%     -   52s
H    0     0                    -48679.11126 8091.90663   117%     -   52s
H    0     0                    -41400.39367 8091.90663   120%     -   52s
H    0     0                    -38378.15369 8091.90663   121%     -   52s
     0     0 3610.23938    0  494 -38378.154 3610.23938   109%     -   67s
     0     0 3104.78052    0  448 -38378.154 3104.78052   108%     -   73s
     0     0 2975.09124    0  509 -38378.154 2975.09124   108%     -   76s
     0     0 2929.76007    0  524 -38378.154 2929.76007   108%     -   78s
     0     0 2923.51356    0  517 -38378.154 2923.51356   108%     -   80s
     0     0 2866.11942    0  520 -38378.154 2866.11942   107%     -   81s
     0     0 2865.50935    0  512 -38378.154 2865.50935   107%     -   86s
     0     0 2865.50935    0  455 -38378.154 2865.50935   107%     -   87s
     0     0 2865.50935    0  454 -38378.154 2865.50935   107%     -   87s
     0     0 1292.22744    0  622 -38378.154 1292.22744   103%     -  107s
H    0     0                    -30686.20067 1292.22744   104%     -  107s
H    0     0                    -30620.09604 1292.22744   104%     -  107s
H    0     0                    -30594.60875 1292.22744   104%     -  107s
H    0     0                    -30586.09678 1292.22744   104%     -  107s
H    0     0                    -30582.18913 1292.22744   104%     -  107s
H    0     0                    -30581.05727 1292.22744   104%     -  107s
H    0     0                    -30562.04120 1292.22744   104%     -  107s
     0     0 1159.89001    0  632 -30562.041 1159.89001   104%     -  113s
     0     0 1098.61878    0  633 -30562.041 1098.61878   104%     -  115s
     0     0  915.12259    0  635 -30562.041  915.12259   103%     -  118s
     0     0  890.04810    0  631 -30562.041  890.04810   103%     -  120s
     0     0  885.13090    0  638 -30562.041  885.13090   103%     -  121s
     0     0  884.49030    0  637 -30562.041  884.49030   103%     -  121s
H    0     0                    -25857.15975  884.49030   103%     -  131s
H    0     0                    -22315.27199  884.49030   104%     -  131s
H    0     0                    -22255.92850  884.49030   104%     -  131s
H    0     0                    -22207.66828  884.49030   104%     -  131s
     0     0  -83.90889    0  595 -22207.668  -83.90889   100%     -  144s
H    0     0                    -19887.28174  -83.97589   100%     -  144s
H    0     0                    -19447.79462  -83.97589   100%     -  144s
     0     0 -229.20239    0  612 -19447.795 -229.20239  98.8%     -  152s
     0     0 -308.33791    0  606 -19447.795 -308.33791  98.4%     -  159s
H    0     0                    -12493.40840 -360.41183  97.1%     -  163s
H    0     0                    -12485.74469 -360.41183  97.1%     -  163s
     0     0 -360.41183    0  618 -12485.745 -360.41183  97.1%     -  164s
     0     0 -411.53167    0  624 -12485.745 -411.53167  96.7%     -  166s
H    0     0                    -12047.07580 -442.24301  96.3%     -  168s
H    0     0                    -11928.29670 -442.24301  96.3%     -  168s
H    0     0                    -11872.23499 -442.24301  96.3%     -  168s
     0     0 -442.24301    0  615 -11872.235 -442.24301  96.3%     -  168s
     0     0 -448.43904    0  625 -11872.235 -448.43904  96.2%     -  169s
     0     0 -452.77044    0  628 -11872.235 -452.77044  96.2%     -  170s
     0     0 -453.88895    0  622 -11872.235 -453.88895  96.2%     -  171s
     0     0 -454.13739    0  624 -11872.235 -454.13739  96.2%     -  171s
     0     0 -873.90527    0  671 -11872.235 -873.90527  92.6%     -  192s
H    0     0                    -11868.88826 -873.92450  92.6%     -  192s
H    0     0                    -11867.72874 -1100.3398  90.7%     -  202s
H    0     0                    -11831.81593 -1100.3398  90.7%     -  202s
     0     0 -1100.3398    0  645 -11831.816 -1100.3398  90.7%     -  202s
     0     0 -1228.6238    0  639 -11831.816 -1228.6238  89.6%     -  209s
H    0     0                    -11816.71325 -1267.9909  89.3%     -  214s
H    0     0                    -11687.90942 -1267.9909  89.2%     -  214s
H    0     0                    -11687.33449 -1267.9909  89.2%     -  214s
H    0     0                    -11681.26325 -1267.9909  89.1%     -  214s
H    0     0                    -11674.77257 -1267.9909  89.1%     -  214s
H    0     0                    -11668.26839 -1267.9909  89.1%     -  214s
     0     0 -1267.9909    0  649 -11668.268 -1267.9909  89.1%     -  214s
     0     0 -1280.3196    0  654 -11668.268 -1280.3196  89.0%     -  217s
     0     0 -1282.5528    0  668 -11668.268 -1282.5528  89.0%     -  218s
     0     0 -1286.9257    0  664 -11668.268 -1286.9257  89.0%     -  219s
     0     0 -1287.4725    0  663 -11668.268 -1287.4725  89.0%     -  219s
     0     0 -1415.0673    0  652 -11668.268 -1415.0673  87.9%     -  228s
     0     0 -1515.4548    0  658 -11668.268 -1515.4548  87.0%     -  236s
     0     0 -1528.7476    0  670 -11668.268 -1528.7476  86.9%     -  239s
     0     0 -1541.6927    0  677 -11668.268 -1541.6927  86.8%     -  241s
     0     0 -1544.3382    0  672 -11668.268 -1544.3382  86.8%     -  242s
     0     0 -1544.9929    0  669 -11668.268 -1544.9929  86.8%     -  243s
     0     0 -1654.7461    0  753 -11668.268 -1654.7461  85.8%     -  253s
     0     0 -1679.0532    0  776 -11668.268 -1679.0532  85.6%     -  259s
     0     0 -1693.2370    0  769 -11668.268 -1693.2370  85.5%     -  262s
     0     0 -1694.9624    0  723 -11668.268 -1694.9624  85.5%     -  263s
     0     0 -1695.9654    0  715 -11668.268 -1695.9654  85.5%     -  264s
     0     0 -1749.7878    0  736 -11668.268 -1749.7878  85.0%     -  269s
     0     0 -1756.9372    0  741 -11668.268 -1756.9372  84.9%     -  270s
     0     0 -1760.7064    0  735 -11668.268 -1760.7064  84.9%     -  272s
     0     0 -1764.7180    0  685 -11668.268 -1764.7180  84.9%     -  273s
     0     0 -1765.9009    0  738 -11668.268 -1765.9009  84.9%     -  273s
     0     0 -1790.9082    0  668 -11668.268 -1790.9082  84.7%     -  277s
H    0     0                    -11664.21660 -1790.9198  84.6%     -  279s
     0     0 -1794.0381    0  691 -11664.217 -1794.0381  84.6%     -  281s
     0     0 -1794.4676    0  684 -11664.217 -1794.4676  84.6%     -  282s
     0     0 -1811.8805    0  736 -11664.217 -1811.8805  84.5%     -  285s
     0     0 -1819.6055    0  692 -11664.217 -1819.6055  84.4%     -  290s
     0     0 -1821.8750    0  701 -11664.217 -1821.8750  84.4%     -  291s
     0     0 -1823.3979    0  708 -11664.217 -1823.3979  84.4%     -  292s
     0     0 -1823.9930    0  713 -11664.217 -1823.9930  84.4%     -  292s
     0     0 -1832.8676    0  686 -11664.217 -1832.8676  84.3%     -  296s
     0     0 -1838.5297    0  675 -11664.217 -1838.5297  84.2%     -  298s
     0     0 -1840.4466    0  690 -11664.217 -1840.4466  84.2%     -  299s
     0     0 -1840.9530    0  688 -11664.217 -1840.9530  84.2%     -  299s
     0     0 -1843.2126    0  689 -11664.217 -1843.2126  84.2%     -  301s
     0     0 -1843.7125    0  691 -11664.217 -1843.7125  84.2%     -  302s
     0     0 -1846.1698    0  690 -11664.217 -1846.1698  84.2%     -  305s
     0     0 -1847.5330    0  692 -11664.217 -1847.5330  84.2%     -  308s
     0     0 -1852.1391    0  705 -11664.217 -1852.1391  84.1%     -  310s
     0     0 -1852.5749    0  705 -11664.217 -1852.5749  84.1%     -  313s
H    0     0                    -11562.86303 -1852.5749  84.0%     -  356s
H    0     0                    -11546.01530 -1852.5749  84.0%     -  359s
H    0     0                    -11469.17141 -1852.5749  83.8%     -  360s
H    0     0                    -11457.33104 -1852.5749  83.8%     -  360s
H    0     2                    -11408.82320 -1852.5749  83.8%     -  361s
     0     2 -1852.5749    0  705 -11408.823 -1852.5749  83.8%     -  361s
     1     3 -2185.1360    1  657 -11408.823 -1852.5749  83.8%  7250  370s
     2     5 -2462.1610    2  659 -11408.823 -1852.5749  83.8%  6568  378s
     4     9 -2514.9259    3  645 -11408.823 -1909.2999  83.3%  4369  388s
     8    18 -3057.4844    3  602 -11408.823 -1909.3141  83.3%  4975  399s
    17    36 -3217.9829    4  599 -11408.823 -2074.0239  81.8%  5452  417s
H   35    53                    -11110.38970 -2109.3101  81.0%  7352  441s
H   36    53                    -11106.46800 -2109.3101  81.0%  7565  441s
    52    85 -4872.8046    6  542 -11106.468 -2109.3442  81.0%  8513  455s
H   84   164                    -10986.98184 -2109.3442  80.8%  5974  465s
   167   268 -5185.6603    8  490 -10986.982 -2109.3442  80.8%  3864  474s
   287   308 -5636.7610   10  535 -10986.982 -2109.3442  80.8%  2734  483s
   369   341 -5325.1534   12  316 -10986.982 -2109.3442  80.8%  2359  491s
   447   374 -6487.1871   12  457 -10986.982 -2109.3442  80.8%  2182  499s
   529   402 -6614.6742   13  526 -10986.982 -2109.3442  80.8%  1997  506s
   614   414 -6625.0611   14  526 -10986.982 -2109.3442  80.8%  1831  513s
   686   418 -6893.8077   16  460 -10986.982 -2109.3442  80.8%  1745  521s
   747   428 -7107.8803   17  382 -10986.982 -2109.3442  80.8%  1702  529s
   797   457 -8936.8728   17  330 -10986.982 -2109.3442  80.8%  1691  538s
   853   487 -9522.4533   18  338 -10986.982 -2109.3442  80.8%  1708  547s
   922   507 -9623.9974   19  331 -10986.982 -2109.3442  80.8%  1696  555s
   960   539 -10381.559   20  371 -10986.982 -2109.3442  80.8%  1712  564s
  1010   552 infeasible   21      -10986.982 -2109.3442  80.8%  1706  572s
  1059   589     cutoff   21      -10986.982 -2109.3442  80.8%  1698  581s
  1116   634 -8122.2082   14  251 -10986.982 -2109.3442  80.8%  1697  590s
  1197   639     cutoff   15      -10986.982 -2109.3442  80.8%  1674  600s
  1278   677     cutoff   15      -10986.982 -2109.3442  80.8%  1680  609s
  1366   706 -8753.8868    9  135 -10986.982 -2109.3442  80.8%  1661  619s
  1454   743 -8987.3226   10  108 -10986.982 -2109.3442  80.8%  1639  629s
  1559   783 -9610.0513   11   67 -10986.982 -2109.3442  80.8%  1624  639s
  1661   831 -10441.993   14   67 -10986.982 -2109.3442  80.8%  1595  650s
  1778   869 -4633.5215    9  482 -10986.982 -2238.9448  79.6%  1587  661s
  1865   907 -4650.6906   10  482 -10986.982 -2238.9562  79.6%  1596  673s
  1959   929 -6407.5221   13  200 -10986.982 -2238.9562  79.6%  1604  683s
  1997   954 -6650.3475   14  276 -10986.982 -2238.9562  79.6%  1623  696s
  2038   970 -6822.9644   15  385 -10986.982 -2295.9562  79.1%  1652  708s
  2076   989 -6890.2618   16  197 -10986.982 -2295.9562  79.1%  1661  720s
  2143  1015 -7291.2460   17  313 -10986.982 -2295.9562  79.1%  1671  730s
  2197  1038 -7370.4591   18  373 -10986.982 -2941.2375  73.2%  1667  741s
  2253  1061 -7424.0462   19  364 -10986.982 -3027.4127  72.4%  1676  755s
  2292  1075 -7498.4712   20  188 -10986.982 -3027.4127  72.4%  1685  765s
  2364  1122 -7529.8236   21  367 -10986.982 -3027.4127  72.4%  1686  776s
  2461  1149 -7532.2556   22  301 -10986.982 -3027.4127  72.4%  1681  790s
  2572  1195     cutoff   27      -10986.982 -3027.4127  72.4%  1697  804s
  2674  1247 -8693.0436   30  168 -10986.982 -3379.1415  69.2%  1715  818s
  2806  1276 infeasible   13      -10986.982 -3735.5831  66.0%  1724  834s
  3013  1306 -10251.935   17   81 -10986.982 -3916.4231  64.4%  1706  852s
  3194  1353 -6300.5855   13  188 -10986.982 -3981.6496  63.8%  1719  868s
  3333  1390 -10408.253   16  328 -10986.982 -4075.2809  62.9%  1730  885s
  3461  1478 -8762.8956   17  539 -10986.982 -4075.2809  62.9%  1759  905s
  3638  1530 infeasible   20      -10986.982 -4075.2809  62.9%  1772  924s
  3882  1581 -10529.640   22  195 -10986.982 -4818.1886  56.1%  1772  944s
  4099  1609     cutoff    9      -10986.982 -4818.1886  56.1%  1781  966s
  4361  1655 -10035.682   14  236 -10986.982 -5007.7205  54.4%  1778  988s
  4589  1674 -9337.1283   18  107 -10986.982 -5188.1488  52.8%  1789 1008s
  4758  1706 -7481.0519   15  396 -10986.982 -5440.6173  50.5%  1807 1033s
  4963  1733     cutoff   20      -10986.982 -5440.6173  50.5%  1825 1055s
  5230  1788 -10108.422   19  407 -10986.982 -5440.6173  50.5%  1830 1077s
  5540  1803 -10017.025   21  266 -10986.982 -5724.6250  47.9%  1830 1099s
  5827  1823 -10365.834   13  284 -10986.982 -5912.7141  46.2%  1843 1122s
  6021  1889 -8332.7626   14  479 -10986.982 -6010.9566  45.3%  1861 1149s
  6266  1954     cutoff   18      -10986.982 -6115.1007  44.3%  1878 1175s
  6646  1970 -10554.961   13   91 -10986.982 -6180.4537  43.7%  1872 1204s
  7005  1989     cutoff   29      -10986.982 -6393.5592  41.8%  1877 1240s
  7353  2015 -10444.075   38  170 -10986.982 -6520.0949  40.7%  1877 1271s
  7769  2050 -9676.5234   18  280 -10986.982 -6617.8918  39.8%  1876 1301s
  8207  2018 -9344.5068   13  381 -10986.982 -6617.8918  39.8%  1874 1334s
  8673  2037     cutoff   22      -10986.982 -6880.5636  37.4%  1873 1368s
  9005  2051 -10870.218   15  348 -10986.982 -7033.2340  36.0%  1882 1402s
  9330  2047 -9023.0956   13  136 -10986.982 -7100.0913  35.4%  1887 1440s
  9883  2072 -10778.886   15  126 -10986.982 -7300.6718  33.6%  1877 1481s
 10519  2076 -10005.812   14  436 -10986.982 -7416.4507  32.5%  1863 1515s
 11110  2045     cutoff   25      -10986.982 -7677.8863  30.1%  1856 1552s
 11656  1911     cutoff   17      -10986.982 -7849.9125  28.6%  1856 1590s
 12264  1806 infeasible   22      -10986.982 -8008.4578  27.1%  1858 1630s
 12966  1683 -10746.660   18  409 -10986.982 -8275.0766  24.7%  1845 1670s
 13793  1620 -10979.113   30  164 -10986.982 -8420.2312  23.4%  1822 1711s
 14296  1391     cutoff   27      -10986.982 -8616.6370  21.6%  1806 1760s
 15414   905 -10684.720   11  408 -10986.982 -8968.2927  18.4%  1760 1807s
 16789    90 -9984.7174   30  265 -10986.982 -9394.6253  14.5%  1696 1836s

Cutting planes:
  Learned: 4
  Implied bound: 5
  MIR: 778
  Flow cover: 2107
  Zero half: 20
  RLT: 82
  Relax-and-lift: 50

Explored 19099 nodes (29723314 simplex iterations) in 1839.20 seconds (5204.27 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -10987 -11106.5 -11110.4 ... -11668.3
No other solutions better than -10987

Optimal solution found (tolerance 1.00e-06)
Best objective -1.098698184469e+04, best bound -1.098698184469e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1839.28s
  Master Objective (UB) = -10986.98, θ = 119337.93
  Upper Bound (UB) = -10986.98

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119337.93
  [DEBUG]   ✓ Scenario 0: θ = 119337.93 ≤ Q = 119337.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119337.93 ≤ Q = 119337.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119337.93 ≤ Q = 119337.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119337.93 ≤ Q = 119337.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119337.93 ≤ Q = 119337.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119337.93 ≤ Q = 119337.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119337.93 ≤ Q = 119337.93 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x5af4c508
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa50b3af8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.246165e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6743634.5840
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.173472e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117347.17    0  136 6743634.58 -117347.17   102%     -    0s
H    0     0                    -83394.89633 -117347.17  40.7%     -    0s
H    0     0                    -85249.93312 -117347.17  37.7%     -    0s
H    0     0                    -91813.08259 -100208.44  9.14%     -    0s
H    0     0                    -95106.14845 -100208.44  5.36%     -    0s
     0     0 -100208.44    0   93 -95106.148 -100208.44  5.36%     -    0s
H    0     0                    -97719.21908 -100107.67  2.44%     -    0s
     0     0 -100107.67    0   91 -97719.219 -100107.67  2.44%     -    0s
H    0     0                    -98861.79663 -100107.67  1.26%     -    0s
     0     0 -99762.595    0   93 -98861.797 -99762.595  0.91%     -    0s
     0     0 -99722.902    0   92 -98861.797 -99722.902  0.87%     -    0s
     0     0 -99722.902    0   92 -98861.797 -99722.902  0.87%     -    0s
     0     0 -99383.695    0   59 -98861.797 -99383.695  0.53%     -    0s
H    0     0                    -98876.20328 -99350.106  0.48%     -    0s
     0     0 -99350.106    0   58 -98876.203 -99350.106  0.48%     -    0s
     0     0 -99340.348    0   62 -98876.203 -99340.348  0.47%     -    0s
     0     0 -99134.828    0   35 -98876.203 -99134.828  0.26%     -    0s
     0     0 -99132.021    0   32 -98876.203 -99132.021  0.26%     -    0s
     0     0 -99131.976    0   31 -98876.203 -99131.976  0.26%     -    0s
     0     0 -99102.931    0   27 -98876.203 -99102.931  0.23%     -    0s
     0     0 -99067.289    0   27 -98876.203 -99067.289  0.19%     -    0s
     0     0 -99067.138    0   27 -98876.203 -99067.138  0.19%     -    0s
     0     0 -98986.287    0   22 -98876.203 -98986.287  0.11%     -    0s
     0     0 -98986.287    0   18 -98876.203 -98986.287  0.11%     -    0s
     0     0 -98900.841    0   13 -98876.203 -98900.841  0.02%     -    0s
     0     0 -98900.301    0   12 -98876.203 -98900.301  0.02%     -    0s
H    0     0                    -98878.13974 -98897.086  0.02%     -    0s
     0     0 -98893.924    0    9 -98878.140 -98893.924  0.02%     -    0s
     0     0 -98893.380    0    8 -98878.140 -98893.380  0.02%     -    0s
     0     0 -98893.370    0    8 -98878.140 -98893.370  0.02%     -    0s
     0     0 -98892.903    0    8 -98878.140 -98892.903  0.01%     -    0s
     0     0 -98892.463    0    8 -98878.140 -98892.463  0.01%     -    0s
     0     0 -98892.402    0    8 -98878.140 -98892.402  0.01%     -    0s
H    0     0                    -98881.22589 -98892.402  0.01%     -    0s
     0     0 -98886.186    0    4 -98881.226 -98886.186  0.01%     -    0s
     0     0 -98886.186    0    3 -98881.226 -98886.186  0.01%     -    0s
     0     0 -98884.587    0    2 -98881.226 -98884.587  0.00%     -    0s
H    0     0                    -98883.02782 -98883.182  0.00%     -    0s
     0     0     cutoff    0      -98883.028 -98883.028  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Flow cover: 1

Explored 1 nodes (928 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -98883 -98881.2 -98878.1 ... -83394.9
No other solutions better than -98883

Optimal solution found (tolerance 1.00e-06)
Best objective -9.888302782198e+04, best bound -9.888302782198e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 104038.82
  Scenario: 39 demand increases, 21 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98883.03
  [DEBUG]   S×d_nominal = 202921.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202921.85 + -98883.03 = 104038.82
  [DEBUG]   Current θ from Master = 119337.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15299.11 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26286.10
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 2031.7320, Absolute Gap = 2031.7320, Relative Gap = 0.184922
  Not converged yet (gap = 2031.73 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 39 increases, 21 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351463 nonzeros
Model fingerprint: 0xf520b3ed
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 53388 rows and 21678 columns
Presolve time: 1.15s
Presolved: 70315 rows, 30502 columns, 437739 nonzeros
Variable types: 28243 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 70315 rows, 30502 columns, 437739 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   35270   -3.9301401e+04   0.000000e+00   6.098866e+06      5s
   45136   -1.1750713e+04   0.000000e+00   1.011965e+06     10s
   52208   -8.6588799e+03   0.000000e+00   2.550726e+06     15s
   59439   -4.2196333e+03   0.000000e+00   4.006979e+06     20s
   66741   -1.6005957e+03   0.000000e+00   4.598387e+06     25s
   73303    2.9680033e+03   0.000000e+00   9.304942e+05     30s
   79145    3.6100993e+03   0.000000e+00   9.071844e+06     35s
   85076    4.6868917e+03   0.000000e+00   1.829654e+06     40s
Concurrent spin time: 3.68s

Solved with dual simplex

Root relaxation: objective 8.091907e+03, 93176 iterations, 44.50 seconds (80.69 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 8091.90663    0  450 -190756.93 8091.90663   104%     -   46s
H    0     0                    -182098.2188 8091.90663   104%     -   46s
H    0     0                    -179321.6729 8091.90663   105%     -   46s
H    0     0                    -179075.8050 8091.90663   105%     -   46s
H    0     0                    -179044.2375 8091.90663   105%     -   46s
H    0     0                    -149213.7875 8091.90663   105%     -   46s
H    0     0                    -145846.7531 8091.90663   106%     -   46s
H    0     0                    -144322.6782 8091.90663   106%     -   46s
H    0     0                    -144280.4099 8091.90663   106%     -   46s
H    0     0                    -80280.16683 8091.90663   110%     -   46s
H    0     0                    -80237.16986 8091.90663   110%     -   47s
H    0     0                    -63530.67715 8091.90663   113%     -   47s
H    0     0                    -60289.24090 8091.90663   113%     -   47s
H    0     0                    -59945.70670 8091.90663   113%     -   47s
H    0     0                    -51701.96217 8091.90663   116%     -   48s
H    0     0                    -39578.68411 8091.90663   120%     -   48s
H    0     0                    -38982.85313 8091.90663   121%     -   48s
H    0     0                    -38977.49890 8091.90663   121%     -   48s
H    0     0                    -38975.22138 8091.90663   121%     -   48s
H    0     0                    -38969.86716 8091.90663   121%     -   48s
H    0     0                    -38959.03797 8091.90663   121%     -   48s
     0     0 3082.67416    0  481 -38959.038 3082.67416   108%     -   69s
H    0     0                    -38872.64957 3082.67416   108%     -   69s
H    0     0                    -37423.98009 3082.67416   108%     -   69s
H    0     0                    -37370.97963 3082.67416   108%     -   69s
H    0     0                    -37173.70283 3082.67416   108%     -   69s
H    0     0                    -36999.38114 3082.67416   108%     -   69s
H    0     0                    -36971.90129 3082.67416   108%     -   69s
H    0     0                    -36645.28358 3082.67416   108%     -   69s
H    0     0                    -36015.52633 3082.67416   109%     -   69s
     0     0 2853.71070    0  479 -36015.526 2853.71070   108%     -   79s
     0     0 2818.71724    0  476 -36015.526 2818.71724   108%     -   81s
     0     0 2808.85381    0  551 -36015.526 2808.85381   108%     -   83s
     0     0 2808.85381    0  540 -36015.526 2808.85381   108%     -   87s
     0     0 2808.85381    0  542 -36015.526 2808.85381   108%     -   88s
     0     0 2808.85381    0  543 -36015.526 2808.85381   108%     -   90s
     0     0 2808.85381    0  540 -36015.526 2808.85381   108%     -   94s
     0     0 2808.85381    0  544 -36015.526 2808.85381   108%     -   94s
     0     0 2808.85381    0  542 -36015.526 2808.85381   108%     -   95s
H    0     0                    -35605.69087 2808.85381   108%     -   96s
H    0     0                    -35591.22401 2808.85381   108%     -   96s
H    0     0                    -35128.39811 2808.85381   108%     -   96s
     0     0 1113.95899    0  611 -35128.398 1113.95899   103%     -  115s
H    0     0                    -31923.26528 1113.87257   103%     -  116s
H    0     0                    -31729.26676 1113.87257   104%     -  116s
H    0     0                    -31530.77540 1113.87257   104%     -  116s
H    0     0                    -31468.55073 1113.87257   104%     -  116s
H    0     0                    -31445.57197 1113.87257   104%     -  116s
H    0     0                    -31316.08305 1113.87257   104%     -  116s
H    0     0                    -31314.81981 1113.87257   104%     -  116s
     0     0  901.35664    0  606 -31314.820  901.35664   103%     -  126s
     0     0  874.20775    0  601 -31314.820  874.20775   103%     -  128s
     0     0  832.91563    0  574 -31314.820  832.91563   103%     -  132s
     0     0  650.44904    0  611 -31314.820  650.44904   102%     -  139s
     0     0  620.32442    0  609 -31314.820  620.32442   102%     -  142s
     0     0  541.01125    0  619 -31314.820  541.01125   102%     -  145s
     0     0  533.14846    0  667 -31314.820  533.14846   102%     -  146s
     0     0  531.97197    0  669 -31314.820  531.97197   102%     -  147s
     0     0  531.54152    0  626 -31314.820  531.54152   102%     -  147s
H    0     0                    -29259.93024  531.54152   102%     -  156s
H    0     0                    -28410.86684  531.54152   102%     -  156s
H    0     0                    -20202.91888 -361.36266  98.2%     -  177s
H    0     0                    -16602.20772 -361.36266  97.8%     -  177s
H    0     0                    -16064.09103 -361.36266  97.8%     -  177s
     0     0 -361.36266    0  653 -16064.091 -361.36266  97.8%     -  177s
H    0     0                    -15296.46278 -361.46833  97.6%     -  178s
     0     0 -546.37470    0  606 -15296.463 -546.37470  96.4%     -  190s
     0     0 -654.43753    0  611 -15296.463 -654.43753  95.7%     -  197s
     0     0 -669.34660    0  625 -15296.463 -669.34660  95.6%     -  200s
     0     0 -676.55434    0  612 -15296.463 -676.55434  95.6%     -  203s
     0     0 -681.88236    0  680 -15296.463 -681.88236  95.5%     -  206s
     0     0 -682.21767    0  622 -15296.463 -682.21767  95.5%     -  206s
H    0     0                    -14725.65584 -1036.5999  93.0%     -  243s
H    0     0                    -14665.70783 -1036.5999  92.9%     -  243s
     0     0 -1036.5999    0  627 -14665.708 -1036.5999  92.9%     -  243s
H    0     0                    -14148.11144 -1036.6318  92.7%     -  244s
H    0     0                    -13080.73214 -1158.5743  91.1%     -  253s
H    0     0                    -12281.94685 -1158.5743  90.6%     -  253s
H    0     0                    -11850.76577 -1158.5743  90.2%     -  253s
H    0     0                    -11816.48763 -1158.5743  90.2%     -  253s
     0     0 -1158.5743    0  624 -11816.488 -1158.5743  90.2%     -  253s
H    0     0                    -11797.64293 -1273.2937  89.2%     -  261s
     0     0 -1273.2937    0  636 -11797.643 -1273.2937  89.2%     -  261s
     0     0 -1314.9061    0  645 -11797.643 -1314.9061  88.9%     -  267s
     0     0 -1326.7452    0  649 -11797.643 -1326.7452  88.8%     -  270s
     0     0 -1333.1126    0  648 -11797.643 -1333.1126  88.7%     -  272s
H    0     0                    -11721.68539 -1339.8230  88.6%     -  273s
H    0     0                    -11717.76369 -1339.8230  88.6%     -  273s
     0     0 -1339.8230    0  662 -11717.764 -1339.8230  88.6%     -  273s
     0     0 -1343.4138    0  714 -11717.764 -1343.4138  88.5%     -  275s
     0     0 -1348.4970    0  711 -11717.764 -1348.4970  88.5%     -  276s
     0     0 -1349.0723    0  711 -11717.764 -1349.0723  88.5%     -  277s
     0     0 -1471.1919    0  698 -11717.764 -1471.1919  87.4%     -  287s
     0     0 -1504.5669    0  703 -11717.764 -1504.5669  87.2%     -  294s
     0     0 -1518.5389    0  661 -11717.764 -1518.5389  87.0%     -  299s
     0     0 -1527.8548    0  663 -11717.764 -1527.8548  87.0%     -  301s
     0     0 -1532.1570    0  676 -11717.764 -1532.1570  86.9%     -  303s
     0     0 -1536.4387    0  674 -11717.764 -1536.4387  86.9%     -  304s
     0     0 -1537.6291    0  677 -11717.764 -1537.6291  86.9%     -  305s
     0     0 -1622.4324    0  655 -11717.764 -1622.4324  86.2%     -  314s
H    0     0                    -11709.39493 -1668.9354  85.7%     -  323s
     0     0 -1668.9354    0  639 -11709.395 -1668.9354  85.7%     -  323s
     0     0 -1676.8657    0  647 -11709.395 -1676.8657  85.7%     -  326s
     0     0 -1680.7289    0  718 -11709.395 -1680.7289  85.6%     -  328s
     0     0 -1682.2361    0  716 -11709.395 -1682.2361  85.6%     -  328s
     0     0 -1683.1638    0  722 -11709.395 -1683.1638  85.6%     -  329s
     0     0 -1735.0773    0  633 -11709.395 -1735.0773  85.2%     -  336s
     0     0 -1744.6254    0  644 -11709.395 -1744.6254  85.1%     -  340s
     0     0 -1756.3169    0  658 -11709.395 -1756.3169  85.0%     -  344s
     0     0 -1760.8257    0  654 -11709.395 -1760.8257  85.0%     -  346s
     0     0 -1762.5546    0  647 -11709.395 -1762.5546  84.9%     -  347s
     0     0 -1763.5434    0  650 -11709.395 -1763.5434  84.9%     -  348s
     0     0 -1779.4554    0  671 -11709.395 -1779.4554  84.8%     -  352s
     0     0 -1784.7003    0  668 -11709.395 -1784.7003  84.8%     -  355s
     0     0 -1786.7222    0  683 -11709.395 -1786.7222  84.7%     -  356s
     0     0 -1787.1857    0  671 -11709.395 -1787.1857  84.7%     -  357s
     0     0 -1796.6949    0  655 -11709.395 -1796.6949  84.7%     -  361s
     0     0 -1798.9677    0  651 -11709.395 -1798.9677  84.6%     -  363s
     0     0 -1800.4636    0  725 -11709.395 -1800.4636  84.6%     -  363s
     0     0 -1801.2200    0  664 -11709.395 -1801.2200  84.6%     -  364s
     0     0 -1814.3975    0  667 -11709.395 -1814.3975  84.5%     -  369s
     0     0 -1817.5569    0  676 -11709.395 -1817.5569  84.5%     -  372s
     0     0 -1819.0041    0  729 -11709.395 -1819.0041  84.5%     -  374s
     0     0 -1819.5035    0  742 -11709.395 -1819.5035  84.5%     -  375s
     0     0 -1827.0030    0  692 -11709.395 -1827.0030  84.4%     -  380s
     0     0 -1832.9851    0  694 -11709.395 -1832.9851  84.3%     -  383s
     0     0 -1835.3064    0  684 -11709.395 -1835.3064  84.3%     -  385s
     0     0 -1836.6835    0  689 -11709.395 -1836.6835  84.3%     -  386s
     0     0 -1836.9172    0  695 -11709.395 -1836.9172  84.3%     -  386s
     0     0 -1843.4825    0  682 -11709.395 -1843.4825  84.3%     -  390s
     0     0 -1844.4061    0  694 -11709.395 -1844.4061  84.2%     -  397s
     0     0 -1845.5346    0  700 -11709.395 -1845.5346  84.2%     -  400s
     0     0 -1847.3715    0  710 -11709.395 -1847.3715  84.2%     -  401s
     0     0 -1847.8454    0  702 -11709.395 -1847.8454  84.2%     -  402s
     0     0 -1853.2238    0  682 -11709.395 -1853.2238  84.2%     -  405s
     0     0 -1853.8630    0  702 -11709.395 -1853.8630  84.2%     -  407s
     0     0 -1858.8130    0  691 -11709.395 -1858.8130  84.1%     -  411s
     0     0 -1858.8539    0  691 -11709.395 -1858.8539  84.1%     -  414s
     0     2 -1858.8539    0  691 -11709.395 -1858.8539  84.1%     -  485s
     1     3 -2677.1328    1  567 -11709.395 -1859.3443  84.1%  8965  495s
     2     6 -2955.8998    2  587 -11709.395 -1859.3443  84.1%  7117  501s
     5    12 -3225.6942    3  612 -11709.395 -1971.1537  83.2%  5411  512s
    11    23 -3302.2040    4  608 -11709.395 -2013.5984  82.8%  6135  537s
    22    34 -5536.4847    4  350 -11709.395 -2064.4895  82.4% 11232  562s
    33    65 -3696.6933    4  635 -11709.395 -2064.4895  82.4% 11261  620s
    64    97 -3782.1584    5  611 -11709.395 -2064.4895  82.4% 12510  636s
    96   129 -3800.1519    6  603 -11709.395 -2064.4895  82.4% 10616  687s
H  114   129                    -11616.68306 -2064.4895  82.2%  9812  687s
   128   230 -3871.1692    7  586 -11616.683 -2064.4895  82.2%  9445  703s
H  241   259                    -11568.42284 -2064.4895  82.2%  6125  715s
H  243   259                    -11475.82701 -2064.4895  82.0%  6128  715s
H  254   259                    -11281.71393 -2064.4895  81.7%  5892  715s
   285   288 -4362.0508    9  582 -11281.714 -2064.4895  81.7%  5614  729s
   368   331 -4544.6063   10  493 -11281.714 -2064.4895  81.7%  4984  742s
H  376   331                    -11234.15120 -2406.2658  78.6%  4905  742s
H  378   331                    -11149.44824 -2406.2658  78.4%  4901  742s
   453   332 -7525.5878   11  305 -11149.448 -2406.2658  78.4%  4578  755s
   512   351 -7148.4057   12  488 -11149.448 -2406.2658  78.4%  4518  769s
H  533   351                    -11144.94198 -2406.2658  78.4%  4634  769s
   557   375     cutoff   14      -11144.942 -2406.2658  78.4%  4685  783s
   607   405 -6506.2525    8  402 -11144.942 -2406.2658  78.4%  4814  795s
   662   442 -7624.1747    9  369 -11144.942 -2406.2658  78.4%  4856  808s
   737   489 -7795.2429   10  361 -11144.942 -2406.2658  78.4%  4788  819s
   808   544 -8137.8700   11  441 -11144.942 -2406.2658  78.4%  4722  830s
   895   593 -8139.4422   12  441 -11144.942 -2406.2658  78.4%  4572  838s
   980   650 -8580.3922   14  338 -11144.942 -2406.2658  78.4%  4412  849s
  1108   668 -8777.8076   16  260 -11144.942 -2406.2658  78.4%  4112  862s
H 1116   668                    -11143.26923 -2406.2658  78.4%  4111  862s
  1204   661 -10106.889   16   76 -11143.269 -2406.2658  78.4%  4023  876s
  1281   674 -10861.325   35  178 -11143.269 -2406.2658  78.4%  4004  888s
H 1311   674                    -11136.51584 -2406.2658  78.4%  3980  888s
  1356   693     cutoff   16      -11136.516 -3086.1417  72.3%  3976  903s
  1423   721 -4390.6044    8  314 -11136.516 -3086.1417  72.3%  4063  915s
  1495   753 -6173.1931    9  275 -11136.516 -3086.1417  72.3%  4110  930s
H 1500   753                    -11135.07406 -3086.1417  72.3%  4120  930s
  1535   792 -6030.6036    9  294 -11135.074 -3086.1417  72.3%  4163  945s
  1624   861 -7397.0970   10  274 -11135.074 -3086.1417  72.3%  4120  959s
  1752   888 -3889.0759    8  580 -11135.074 -3255.3028  70.8%  4093  973s
  1852   915 -4184.8631    9  484 -11135.074 -3268.0287  70.7%  4057  990s
  1950   938 -8342.8343   11  361 -11135.074 -3268.0287  70.7%  4079 1006s
  2035   999 -10136.924   11  110 -11135.074 -3719.3916  66.6%  4149 1022s
  2126  1043     cutoff   13      -11135.074 -3719.3916  66.6%  4174 1036s
  2256  1074 -10150.011   12  335 -11135.074 -3719.3916  66.6%  4195 1055s
  2339  1098 -9179.0051   14  451 -11135.074 -3719.3916  66.6%  4233 1075s
  2379  1133 -10305.272   15  421 -11135.074 -3719.3916  66.6%  4267 1099s
  2443  1207 infeasible   15      -11135.074 -3748.6063  66.3%  4286 1120s
  2573  1226 -10597.572   15   82 -11135.074 -3752.9984  66.3%  4260 1141s
  2726  1253 -9823.4800   13  501 -11135.074 -3767.2403  66.2%  4216 1162s
  2839  1280     cutoff   15      -11135.074 -3767.2403  66.2%  4208 1184s
  2984  1305 -7091.5563   12  529 -11135.074 -3842.1891  65.5%  4237 1206s
  3126  1353 -9406.5008   15  448 -11135.074 -3842.1891  65.5%  4285 1228s
  3256  1367     cutoff   16      -11135.074 -3876.2169  65.2%  4355 1246s
  3306  1390 -6099.7128    9  158 -11135.074 -4075.2198  63.4%  4378 1267s
  3395  1429 -6623.3918   11  365 -11135.074 -4075.2198  63.4%  4374 1288s
  3504  1458 -8134.1272   13  406 -11135.074 -4075.2198  63.4%  4424 1309s
  3666  1489 -8714.6704   15  317 -11135.074 -4196.2404  62.3%  4452 1334s
  3880  1552 -9641.1957   19  192 -11135.074 -4196.2404  62.3%  4439 1363s
  4103  1605 -6330.3063    8  164 -11135.074 -4196.2404  62.3%  4444 1390s
  4351  1640     cutoff   29      -11135.074 -4700.5062  57.8%  4436 1421s
  4550  1697 -6984.0592   13  368 -11135.074 -4785.1515  57.0%  4471 1452s
  4743  1749 -10730.252   15  283 -11135.074 -4785.1515  57.0%  4513 1482s
  4993  1809 infeasible   14      -11135.074 -4834.3733  56.6%  4522 1516s
  5275  1879 -10900.497   20  252 -11135.074 -5072.2469  54.4%  4525 1551s
  5595  1957 -9564.5205   26  157 -11135.074 -5072.2469  54.4%  4511 1585s
  5894  2006 -8911.6785   16  320 -11135.074 -5134.1326  53.9%  4522 1619s
  6199  2051 -10514.792   20  340 -11135.074 -5306.0676  52.3%  4535 1654s
  6552  2077 -9400.5644   16  259 -11135.074 -5577.8888  49.9%  4537 1695s
  6846  2158 -6852.2684   14  381 -11135.074 -5766.6407  48.2%  4536 1733s
  7149  2222 -9391.8298   21  361 -11135.074 -5840.4114  47.5%  4568 1775s
  7506  2250 -9203.6960   10  128 -11135.074 -5967.2320  46.4%  4574 1820s
  7928  2255     cutoff   22      -11135.074 -6130.8283  44.9%  4560 1862s
  8305  2292 -10496.197   13  187 -11135.074 -6321.9300  43.2%  4534 1907s
  8792  2261 -8893.1280   15  281 -11135.074 -6404.4151  42.5%  4497 1953s
  9299  2285     cutoff   18      -11135.074 -6526.9311  41.4%  4470 2003s
  9711  2230 -9805.1607   17  309 -11135.074 -6672.2661  40.1%  4481 2055s
 10191  2183     cutoff   15      -11135.074 -6984.3023  37.3%  4482 2104s
 10552  2125 -8744.4471   12  259 -11135.074 -7134.8133  35.9%  4496 2166s
 11049  2108     cutoff   21      -11135.074 -7308.7074  34.4%  4502 2224s
 11625  1996 -10406.683   19  323 -11135.074 -7481.0230  32.8%  4490 2283s
 12200  1887     cutoff   18      -11135.074 -7698.9213  30.9%  4475 2343s
 12875  1668     cutoff   11      -11135.074 -8026.1267  27.9%  4439 2406s
 13715  1365 -10511.310   21  275 -11135.074 -8337.7769  25.1%  4371 2468s
 14710   785 -9694.6904   25  286 -11135.074 -8601.2596  22.8%  4273 2529s
 15955    67     cutoff   11      -11135.074 -9360.0606  15.9%  4121 2579s
 17207    17     cutoff   14      -11135.074 -9766.1538  12.3%  3925 2620s

Cutting planes:
  Learned: 5
  Implied bound: 6
  MIR: 964
  Flow cover: 2528
  Zero half: 15
  RLT: 73
  Relax-and-lift: 102

Explored 17304 nodes (68028351 simplex iterations) in 2625.00 seconds (7681.37 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11135.1 -11136.5 -11143.3 ... -11616.7
No other solutions better than -11135.1

Optimal solution found (tolerance 1.00e-06)
Best objective -1.113507405722e+04, best bound -1.113507405722e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2625.08s
  Master Objective (UB) = -11135.07, θ = 119054.93
  Upper Bound (UB) = -11135.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 119054.93
  [DEBUG]   ✓ Scenario 0: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 119054.93 ≤ Q = 119054.93 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 119054.93 ≤ Q = 119054.93 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x66fcd0a2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x99032f5e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.248874e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6761446.0956
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.177822e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117782.19    0  136 6761446.10 -117782.19   102%     -    0s
H    0     0                    -83798.20816 -117782.19  40.6%     -    0s
H    0     0                    -85653.24495 -117782.19  37.5%     -    0s
H    0     0                    -92431.83528 -98913.842  7.01%     -    0s
H    0     0                    -96039.92997 -98913.842  2.99%     -    0s
     0     0 -98913.842    0   42 -96039.930 -98913.842  2.99%     -    0s
H    0     0                    -98299.81571 -98904.476  0.62%     -    0s
     0     0 -98815.744    0   40 -98299.816 -98815.744  0.52%     -    0s
     0     0 -98808.344    0   39 -98299.816 -98808.344  0.52%     -    0s
     0     0 -98801.035    0   39 -98299.816 -98801.035  0.51%     -    0s
     0     0 -98639.469    0    7 -98299.816 -98639.469  0.35%     -    0s
H    0     0                    -98566.47600 -98625.754  0.06%     -    0s
     0     0 -98620.642    0    4 -98566.476 -98620.642  0.05%     -    0s
H    0     0                    -98582.56663 -98610.733  0.03%     -    0s
     0     0 -98610.733    0    4 -98582.567 -98610.733  0.03%     -    0s
     0     0 -98597.240    0    3 -98582.567 -98597.240  0.01%     -    0s
H    0     0                    -98583.23228 -98597.240  0.01%     -    0s
     0     0 -98592.670    0    3 -98583.232 -98592.670  0.01%     -    0s
*    0     0               0    -98591.36251 -98591.363  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 3
  Flow cover: 1

Explored 1 nodes (520 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -98591.4 -98582.6 -98566.5 ... 1.24887e+13
No other solutions better than -98591.4

Optimal solution found (tolerance 1.00e-06)
Best objective -9.859136250958e+04, best bound -9.859136250958e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 104397.84
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98591.36
  [DEBUG]   S×d_nominal = 202989.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202989.21 + -98591.36 = 104397.84
  [DEBUG]   Current θ from Master = 119054.93
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14657.08 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -25792.16
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1883.6398, Absolute Gap = 1883.6398, Relative Gap = 0.169163
  Not converged yet (gap = 1883.64 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394706 nonzeros
Model fingerprint: 0x38cac043
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 60074 rows and 24394 columns
Presolve time: 1.16s
Presolved: 78919 rows, 34026 columns, 484007 nonzeros
Variable types: 31767 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383874.0427
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 78919 rows, 34026 columns, 484007 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33617   -6.8448853e+04   0.000000e+00   1.709313e+08      5s
   46394   -3.6518856e+03   0.000000e+00   1.570022e+08     10s
   52683   -1.1363369e+03   0.000000e+00   7.366769e+08     15s
   57726   -2.4353919e+02   0.000000e+00   3.327270e+06     20s
   63523    1.2739587e+03   0.000000e+00   7.843836e+08     25s
   69543    5.1520038e+03   0.000000e+00   1.321129e+07     30s
   74555    5.7317420e+03   0.000000e+00   1.843996e+06     35s
   79195    5.9726750e+03   0.000000e+00   1.342035e+06     40s
   83675    6.0147105e+03   0.000000e+00   5.324829e+05     45s
Concurrent spin time: 14.16s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 1.111190e+04, 79383 iterations, 61.94 seconds (109.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11111.9011    0  469 -190756.93 11111.9011   106%     -   63s
H    0     0                    -177417.5634 11111.9011   106%     -   63s
H    0     0                    -113378.2356 11111.9011   110%     -   64s
H    0     0                    -113327.4629 11111.9011   110%     -   64s
H    0     0                    -99279.50006 11111.9011   111%     -   64s
H    0     0                    -99177.02906 11111.9011   111%     -   64s
H    0     0                    -83898.79278 11111.9011   113%     -   64s
H    0     0                    -54337.72955 11111.9011   120%     -   64s
H    0     0                    -53562.63798 11111.9011   121%     -   64s
H    0     0                    -49859.62547 5445.75530   111%     -   81s
H    0     0                    -43286.48769 5445.75530   113%     -   81s
H    0     0                    -42469.25548 5445.75530   113%     -   81s
H    0     0                    -42468.83298 5445.75530   113%     -   81s
H    0     0                    -42461.62374 5445.75530   113%     -   81s
     0     0 5433.43516    0  552 -42461.624 5433.43516   113%     -   81s
     0     0 4862.16817    0  544 -42461.624 4862.16817   111%     -   86s
     0     0 4777.07793    0  556 -42461.624 4777.07793   111%     -   89s
     0     0 4761.86507    0  554 -42461.624 4761.86507   111%     -   89s
     0     0 4715.98886    0  539 -42461.624 4715.98886   111%     -   90s
     0     0 4715.96273    0  557 -42461.624 4715.96273   111%     -   92s
     0     0 4715.96273    0  558 -42461.624 4715.96273   111%     -   94s
     0     0 4715.96273    0  560 -42461.624 4715.96273   111%     -   96s
     0     0 4715.96273    0  566 -42461.624 4715.96273   111%     -   96s
     0     0 4715.96273    0  564 -42461.624 4715.96273   111%     -   96s
H    0     0                    -39141.54540 2793.03211   107%     -  113s
H    0     0                    -38907.76913 2793.03211   107%     -  113s
H    0     0                    -38871.22473 2793.03211   107%     -  113s
H    0     0                    -38847.97091 2793.03211   107%     -  113s
     0     0 2793.03211    0  624 -38847.971 2793.03211   107%     -  113s
H    0     0                    -35797.42563 2792.10439   108%     -  113s
H    0     0                    -35764.69796 2792.10439   108%     -  114s
H    0     0                    -35589.01091 2792.10439   108%     -  114s
H    0     0                    -35434.28160 2792.10439   108%     -  114s
H    0     0                    -35396.49005 2792.10439   108%     -  114s
H    0     0                    -35348.59612 2792.10439   108%     -  114s
H    0     0                    -34038.82155 2792.10439   108%     -  114s
H    0     0                    -33978.08889 2792.10439   108%     -  114s
H    0     0                    -33912.90633 2792.10439   108%     -  114s
H    0     0                    -33851.28760 2792.10439   108%     -  114s
H    0     0                    -33839.11764 2792.10439   108%     -  114s
H    0     0                    -33838.42531 2792.10439   108%     -  114s
H    0     0                    -33752.29823 2792.10439   108%     -  114s
H    0     0                    -33701.96759 2792.10439   108%     -  114s
     0     0 2546.49704    0  587 -33701.968 2546.49704   108%     -  125s
     0     0 2486.99268    0  587 -33701.968 2486.99268   107%     -  129s
     0     0 2440.52418    0  690 -33701.968 2440.52418   107%     -  134s
H    0     0                    -28663.19035 2405.68754   108%     -  137s
H    0     0                    -28651.04077 2405.68754   108%     -  137s
H    0     0                    -28642.67200 2405.68754   108%     -  137s
     0     0 2405.68754    0  688 -28642.672 2405.68754   108%     -  137s
     0     0 2402.19642    0  694 -28642.672 2402.19642   108%     -  138s
     0     0 2387.07426    0  691 -28642.672 2387.07426   108%     -  140s
     0     0 2370.37951    0  699 -28642.672 2370.37951   108%     -  143s
     0     0 2369.01633    0  691 -28642.672 2369.01633   108%     -  144s
     0     0 2369.01622    0  691 -28642.672 2369.01622   108%     -  144s
H    0     0                    -13005.78298  847.99755   107%     -  193s
H    0     0                    -12847.78367  847.99755   107%     -  193s
H    0     0                    -12818.73391  847.99755   107%     -  193s
H    0     0                    -12750.17439  847.99755   107%     -  193s
H    0     0                    -12746.76714  847.99755   107%     -  193s
     0     0  847.99755    0  625 -12746.767  847.99755   107%     -  193s
H    0     0                    -12706.33149  847.83771   107%     -  193s
H    0     0                    -12657.87784  847.83771   107%     -  193s
H    0     0                    -12590.01605  847.83771   107%     -  193s
     0     0  550.83236    0  666 -12590.016  550.83236   104%     -  211s
     0     0  477.58920    0  628 -12590.016  477.58920   104%     -  220s
     0     0  456.89408    0  628 -12590.016  456.89408   104%     -  226s
     0     0  399.27167    0  631 -12590.016  399.27167   103%     -  231s
     0     0  384.06956    0  636 -12590.016  384.06956   103%     -  236s
     0     0  373.30497    0  640 -12590.016  373.30497   103%     -  238s
     0     0  316.85483    0  646 -12590.016  316.85483   103%     -  242s
     0     0  297.32253    0  648 -12590.016  297.32253   102%     -  246s
     0     0  294.98380    0  645 -12590.016  294.98380   102%     -  247s
     0     0  293.90547    0  645 -12590.016  293.90547   102%     -  248s
H    0     0                    -12473.36118 -416.98290  96.7%     -  296s
H    0     0                    -12266.58748 -416.98290  96.6%     -  296s
H    0     0                    -12208.76844 -416.98290  96.6%     -  296s
H    0     0                    -12032.72586 -416.98290  96.5%     -  296s
     0     0 -416.98290    0  642 -12032.726 -416.98290  96.5%     -  296s
H    0     0                    -11997.75477 -417.12567  96.5%     -  296s
H    0     0                    -11957.77250 -417.12567  96.5%     -  296s
     0     0 -589.69989    0  652 -11957.772 -589.69989  95.1%     -  315s
     0     0 -661.81722    0  653 -11957.772 -661.81722  94.5%     -  325s
     0     0 -699.98744    0  662 -11957.772 -699.98744  94.1%     -  334s
     0     0 -714.05270    0  672 -11957.772 -714.05270  94.0%     -  338s
     0     0 -728.13223    0  661 -11957.772 -728.13223  93.9%     -  343s
     0     0 -739.10616    0  659 -11957.772 -739.10616  93.8%     -  345s
     0     0 -740.94550    0  668 -11957.772 -740.94550  93.8%     -  347s
     0     0 -959.09407    0  695 -11957.772 -959.09407  92.0%     -  369s
H    0     0                    -11955.21190 -959.09531  92.0%     -  370s
     0     0 -1023.4392    0  722 -11955.212 -1023.4392  91.4%     -  383s
     0     0 -1063.6229    0  730 -11955.212 -1063.6229  91.1%     -  393s
     0     0 -1079.2947    0  721 -11955.212 -1079.2947  91.0%     -  400s
     0     0 -1085.3558    0  733 -11955.212 -1085.3558  90.9%     -  403s
     0     0 -1090.8262    0  728 -11955.212 -1090.8262  90.9%     -  407s
     0     0 -1094.0573    0  745 -11955.212 -1094.0573  90.8%     -  410s
     0     0 -1096.4230    0  750 -11955.212 -1096.4230  90.8%     -  412s
     0     0 -1096.8359    0  749 -11955.212 -1096.8359  90.8%     -  413s
H    0     0                    -11917.39016 -1239.0077  89.6%     -  434s
H    0     0                    -11901.43689 -1239.0077  89.6%     -  434s
H    0     0                    -11897.51056 -1239.0077  89.6%     -  434s
H    0     0                    -11886.68137 -1239.0077  89.6%     -  434s
     0     0 -1239.0077    0  764 -11886.681 -1239.0077  89.6%     -  434s
H    0     0                    -11884.00214 -1239.0329  89.6%     -  440s
     0     0 -1261.9601    0  688 -11884.002 -1261.9601  89.4%     -  448s
     0     0 -1284.5387    0  719 -11884.002 -1284.5387  89.2%     -  454s
     0     0 -1294.6732    0  741 -11884.002 -1294.6732  89.1%     -  459s
     0     0 -1296.3789    0  739 -11884.002 -1296.3789  89.1%     -  463s
     0     0 -1365.2664    0  744 -11884.002 -1365.2664  88.5%     -  475s
     0     0 -1394.0518    0  741 -11884.002 -1394.0518  88.3%     -  482s
     0     0 -1400.6647    0  747 -11884.002 -1400.6647  88.2%     -  487s
     0     0 -1402.3315    0  759 -11884.002 -1402.3315  88.2%     -  490s
     0     0 -1441.6566    0  742 -11884.002 -1441.6566  87.9%     -  502s
     0     0 -1452.0097    0  741 -11884.002 -1452.0097  87.8%     -  511s
     0     0 -1457.1495    0  758 -11884.002 -1457.1495  87.7%     -  517s
     0     0 -1459.7167    0  770 -11884.002 -1459.7167  87.7%     -  519s
     0     0 -1461.9059    0  774 -11884.002 -1461.9059  87.7%     -  522s
     0     0 -1483.3346    0  772 -11884.002 -1483.3346  87.5%     -  534s
     0     0 -1487.4456    0  771 -11884.002 -1487.4456  87.5%     -  538s
     0     0 -1489.1990    0  779 -11884.002 -1489.1990  87.5%     -  541s
     0     0 -1508.8057    0  811 -11884.002 -1508.8057  87.3%     -  551s
     0     0 -1516.1999    0  765 -11884.002 -1516.1999  87.2%     -  557s
     0     0 -1518.7495    0  764 -11884.002 -1518.7495  87.2%     -  560s
     0     0 -1519.4604    0  705 -11884.002 -1519.4604  87.2%     -  562s
     0     0 -1530.2655    0  682 -11884.002 -1530.2655  87.1%     -  568s
     0     0 -1539.6434    0  764 -11884.002 -1539.6434  87.0%     -  573s
     0     0 -1544.5131    0  685 -11884.002 -1544.5131  87.0%     -  576s
     0     0 -1545.4822    0  743 -11884.002 -1545.4822  87.0%     -  577s
     0     0 -1555.3273    0  750 -11884.002 -1555.3273  86.9%     -  583s
     0     0 -1558.1643    0  766 -11884.002 -1558.1643  86.9%     -  596s
     0     0 -1559.0297    0  760 -11884.002 -1559.0297  86.9%     -  598s
     0     0 -1574.8507    0  756 -11884.002 -1574.8507  86.7%     -  606s
     0     0 -1577.6480    0  756 -11884.002 -1577.6480  86.7%     -  610s
     0     0 -1578.1073    0  747 -11884.002 -1578.1073  86.7%     -  612s
     0     0 -1585.6018    0  753 -11884.002 -1585.6018  86.7%     -  619s
     0     0 -1585.6110    0  753 -11884.002 -1585.6110  86.7%     -  622s
H    0     0                    -11812.37005 -1585.6165  86.6%     -  738s
H    0     0                    -11758.36849 -1585.6165  86.5%     -  739s
H    0     0                    -11749.34566 -1585.6165  86.5%     -  741s
H    0     0                    -11709.06761 -1585.6165  86.5%     -  742s
H    0     0                    -11704.74985 -1585.6165  86.5%     -  742s
H    0     0                    -11701.22594 -1585.6165  86.4%     -  742s
H    0     0                    -11698.61879 -1585.6165  86.4%     -  742s
     0     2 -1585.6165    0  753 -11698.619 -1585.6165  86.4%     -  745s
     1     3 -2550.8912    1  600 -11698.619 -1585.6165  86.4% 19509  768s
     2     6 -3693.5594    2  544 -11698.619 -1585.6165  86.4% 15172  781s
     5    12 -3762.1251    3  547 -11698.619 -1723.6820  85.3%  9593  801s
    11    22 -3825.7461    4  546 -11698.619 -1813.0112  84.5%  8814  828s
    21    37 -3933.5161    5  496 -11698.619 -1813.0112  84.5% 13202  858s
    36    69 -4090.8500    6  493 -11698.619 -2020.8213  82.7% 11306  942s
    68   127 -4973.3557    7  363 -11698.619 -2041.2838  82.6%  9914  966s
   126   163 -5031.4678    8  354 -11698.619 -2041.2838  82.6%  7530  982s
   162   234 -5125.9890    8  342 -11698.619 -2041.2838  82.6%  6543 1001s
   251   282 -5638.1207    9  343 -11698.619 -2041.2838  82.6%  5694 1019s
   339   320 -5445.0853    9  347 -11698.619 -2041.2838  82.6%  5698 1039s
   420   352 -6518.7813   10  367 -11698.619 -2041.2838  82.6%  5673 1055s
   488   369 -7120.1535   10  375 -11698.619 -2041.2838  82.6%  5670 1071s
   552   412 -7304.8983   11  293 -11698.619 -2041.2838  82.6%  5778 1086s
   622   447 -8224.9797   11  292 -11698.619 -2041.2838  82.6%  5820 1101s
   694   500 -7573.3708   13  260 -11698.619 -2041.2838  82.6%  5738 1115s
   769   536 -8213.9521   12  221 -11698.619 -2041.2838  82.6%  5660 1129s
   827   570 -7865.4079   15  242 -11698.619 -2041.2838  82.6%  5574 1142s
   882   591 -10396.311   16  220 -11698.619 -2041.2838  82.6%  5567 1156s
   921   610 -10444.013   17  212 -11698.619 -2041.2838  82.6%  5586 1169s
   979   622 -10690.070   19  224 -11698.619 -2041.2838  82.6%  5555 1182s
  1027   640 -10968.441   20  222 -11698.619 -2089.2256  82.1%  5509 1199s
  1064   663 -10977.777   21  249 -11698.619 -2089.2256  82.1%  5535 1214s
  1117   687 -11056.499   22  192 -11698.619 -2089.2256  82.1%  5574 1229s
  1195   720 -11366.375   23  224 -11698.619 -2089.2256  82.1%  5466 1248s
  1292   798 -8497.9816   25  389 -11698.619 -2089.2256  82.1%  5397 1266s
  1422   821 -8616.1585   32  354 -11698.619 -2089.2256  82.1%  5202 1285s
  1545   848 -10088.706   39  333 -11698.619 -2089.2256  82.1%  5108 1306s
  1625   882 -10724.915   44  324 -11698.619 -2089.2256  82.1%  5174 1326s
  1717   918 -7878.0801   15  343 -11698.619 -2467.5874  78.9%  5204 1343s
  1825   942 -7992.5876   18  342 -11698.619 -2467.5874  78.9%  5220 1364s
  1947   964 -8460.1002   21  233 -11698.619 -2959.0491  74.7%  5228 1386s
  2054   990 -8924.1189   24  219 -11698.619 -2959.0491  74.7%  5276 1408s
  2138  1043 -10027.513   33  202 -11698.619 -3031.7525  74.1%  5307 1430s
  2244  1093 infeasible   39      -11698.619 -3031.7525  74.1%  5308 1453s
  2356  1146 -5546.6907   10  428 -11698.619 -3031.7525  74.1%  5367 1475s
  2454  1202 -7195.9075   14  180 -11698.619 -3069.3472  73.8%  5450 1497s
  2578  1256 -9874.8875   16  368 -11698.619 -3069.3472  73.8%  5486 1519s
  2722  1313 infeasible   19      -11698.619 -3069.3472  73.8%  5509 1545s
  2913  1367 -5637.9033   11  216 -11698.619 -3069.3472  73.8%  5454 1571s
  3063  1437 infeasible   13      -11698.619 -3069.3472  73.8%  5500 1599s
  3232  1478 -7893.7929   15  374 -11698.619 -3069.3472  73.8%  5528 1623s
  3363  1530 -8067.5820   17  242 -11698.619 -3236.3356  72.3%  5566 1653s
  3563  1599 -8925.2950   21  324 -11698.619 -3260.4301  72.1%  5540 1682s
  3754  1684 -9822.8736   27  217 -11698.619 -3260.4301  72.1%  5569 1711s
  3947  1722 infeasible   38      -11698.619 -3260.4301  72.1%  5594 1744s
  4145  1787 -9693.8321   11   82 -11698.619 -3260.4301  72.1%  5632 1780s
  4351  1822 -11079.493   14   82 -11698.619 -3260.4301  72.1%  5640 1815s
  4545  1907 -10868.155   14  107 -11698.619 -4266.5738  63.5%  5650 1845s
  4767  1992 -11642.019   16  177 -11698.619 -4441.3074  62.0%  5678 1883s
  5063  2016 -10398.115   11   90 -11698.619 -4565.9987  61.0%  5647 1910s
  5102  2044 -7944.9306   12  470 -11698.619 -4576.0877  60.9%  5656 1941s
  5214  2145     cutoff   16      -11698.619 -4576.0877  60.9%  5654 1979s
  5460  2146 -8965.9268   11  753 -11698.619 -4576.0877  60.9%  5631 2221s
  5462  2147 -11067.974   23  487 -11698.619 -4576.0877  60.9%  5629 2276s
  5463  2148 -5446.1303   10  694 -11698.619 -4576.0877  60.9%  5627 2326s
  5464  2149 -10493.370   35  659 -11698.619 -4576.0877  60.9%  5626 2368s
  5465  2149 -9333.0047   20  823 -11698.619 -4576.0877  60.9%  5625 2398s
  5466  2150 -10386.371   30  731 -11698.619 -4576.0877  60.9%  5624 2419s
  5467  2151 -10673.334   17  707 -11698.619 -4576.0877  60.9%  5623 2440s
  5468  2151 -9003.7813   31  742 -11698.619 -4576.0877  60.9%  5622 2454s
  5469  2152 -10258.766   14  697 -11698.619 -4576.0877  60.9%  5621 2463s
  5470  2153 -5265.6974   13  753 -11698.619 -4576.0877  60.9%  5620 2473s
  5471  2153 -6244.2463   10  691 -11698.619 -4576.0877  60.9%  5619 2485s
  5472  2154 -6168.1194   10  692 -11698.619 -4576.0877  60.9%  5618 2493s
  5473  2155 -8305.0103   17  645 -11698.619 -4576.0877  60.9%  5617 2522s
  5474  2155 -6688.0276   11  642 -11698.619 -4576.0877  60.9%  5616 2534s
  5475  2156 -6619.4809   11  651 -11698.619 -4576.0877  60.9%  5615 2541s
  5476  2157 -5483.7043   12  691 -11698.619 -4576.0877  60.9%  5614 2546s
  5477  2157 -10620.053   31  683 -11698.619 -4576.0877  60.9%  5613 2554s
  5478  2158 -10126.487   10  695 -11698.619 -4576.0877  60.9%  5612 2564s
  5479  2159 -11481.755   17  676 -11698.619 -4576.0877  60.9%  5611 2585s
  5480  2159 -11242.197   11  682 -11698.619 -4576.0877  60.9%  5610 2594s
  5481  2160 -8508.2614   26  694 -11698.619 -4576.0877  60.9%  5609 2605s
  5482  2161 -10385.742   23  802 -11698.619 -4576.0877  60.9%  5608 2622s
  5483  2161 -11606.782   20  696 -11698.619 -4576.0877  60.9%  5607 2629s
  5484  2162 -7834.4381   11  685 -11698.619 -4576.0877  60.9%  5606 2637s
  5485  2163 -6795.1022   12  799 -11698.619 -4576.0877  60.9%  5605 2658s
  5486  2163 -7298.1714   16  741 -11698.619 -4576.0877  60.9%  5604 2670s
  5487  2164 -8478.3235   25  684 -11698.619 -4576.0877  60.9%  5603 2683s
  5488  2165 -11152.750   35  700 -11698.619 -4576.0877  60.9%  5602 2690s
  5489  2165 -6728.6857   17  700 -11698.619 -4576.0877  60.9%  5601 2701s
  5490  2166 -8667.8760   12  700 -11698.619 -4576.0877  60.9%  5600 2749s
  5491  2167 -10861.127   29  700 -11698.619 -4576.0877  60.9%  5599 2821s
  5492  2169 -4576.0877   13  600 -11698.619 -4576.0877  60.9%  5662 2861s
  5493  2172 -4576.0877   14  613 -11698.619 -4576.0877  60.9%  5661 2889s
  5496  2177 -4576.0877   15  585 -11698.619 -4576.0877  60.9%  5661 2912s
  5502  2187 -4576.0877   16  575 -11698.619 -4576.0877  60.9%  5667 2941s
  5514  2193 -4576.0877   16  632 -11698.619 -4576.0877  60.9%  5687 2988s
  5526  2215 -5562.7250   17  468 -11698.619 -4576.0877  60.9%  5722 3086s
  5556  2305 -5797.1520   18  555 -11698.619 -4576.0877  60.9%  5777 3125s
  5656  2300 -6091.9857   20  542 -11698.619 -4576.0877  60.9%  5825 3150s
  5690  2319 -7122.1602   21  452 -11698.619 -4576.0877  60.9%  5821 3172s
  5727  2341 -7308.9275   22  530 -11698.619 -4576.0877  60.9%  5819 3192s
  5776  2368 -9939.6514   22  355 -11698.619 -4576.0877  60.9%  5809 3213s
  5831  2387 -6040.1201   20  545 -11698.619 -4576.0877  60.9%  5790 3233s
  5891  2408     cutoff   23      -11698.619 -4576.0877  60.9%  5773 3253s
  5961  2419 -10000.748   23  516 -11698.619 -4576.0877  60.9%  5747 3272s
  6035  2415     cutoff   24      -11698.619 -4576.0877  60.9%  5723 3299s
  6099  2418 infeasible   25      -11698.619 -4576.0877  60.9%  5699 3327s
  6174  2405 -7163.3715   22  554 -11698.619 -4576.0877  60.9%  5670 3355s
  6254  2402 -7398.8163   24  480 -11698.619 -4576.0877  60.9%  5637 3375s
  6321  2396 -9360.1363   26  389 -11698.619 -4576.0877  60.9%  5618 3402s
  6398  2388 -9530.2336   28  377 -11698.619 -4576.0877  60.9%  5586 3423s
  6474  2385 infeasible   31      -11698.619 -4576.0877  60.9%  5556 3449s
  6548  2392 -8803.9369   21  300 -11698.619 -4576.0877  60.9%  5534 3478s
  6633  2395 -8990.3334   22  272 -11698.619 -4576.0877  60.9%  5504 3505s
  6716  2391 infeasible   24      -11698.619 -4576.0877  60.9%  5475 3528s
  6801  2397 -9377.3508   26  272 -11698.619 -4576.0877  60.9%  5450 3551s
  6867  2425 -9584.5415   27  245 -11698.619 -4576.0877  60.9%  5440 3576s
  6952  2433 -10090.089   28  327 -11698.619 -4576.0877  60.9%  5426 3600s

Cutting planes:
  Learned: 3
  Gomory: 1
  Projected implied bound: 61
  MIR: 1851
  Flow cover: 2624
  Zero half: 9
  RLT: 47
  Relax-and-lift: 180

Explored 7034 nodes (38561090 simplex iterations) in 3600.03 seconds (8935.37 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11698.6 -11701.2 -11704.7 ... -11897.5

Time limit reached
Best objective -1.169861878619e+04, best bound -4.576087659947e+03, gap 60.8835%
  WARNING: Time limit reached. Using best solution found (gap: 60.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = -11698.62, θ = 111533.65
  Upper Bound (UB) = -11698.62

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111533.65
  [DEBUG]   ✓ Scenario 0: θ = 111533.65 ≤ Q = 111533.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111533.65 ≤ Q = 111533.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 111533.65 ≤ Q = 111533.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 111533.65 ≤ Q = 111533.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 111533.65 ≤ Q = 111533.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 111533.65 ≤ Q = 111533.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 111533.65 ≤ Q = 111533.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 111533.65 ≤ Q = 111533.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 111533.65 ≤ Q = 111533.65 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3a22dc61
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc5dd239f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.172012e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6106393.9159
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.204468e+05, 261 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120446.84    0  132 6106393.92 -120446.84   102%     -    0s
H    0     0                    -82181.52837 -120446.84  46.6%     -    0s
H    0     0                    -92207.37321 -100560.42  9.06%     -    0s
H    0     0                    -97082.24486 -100560.42  3.58%     -    0s
     0     0 -100560.42    0   39 -97082.245 -100560.42  3.58%     -    0s
H    0     0                    -100282.2736 -100557.91  0.27%     -    0s
H    0     0                    -100435.3111 -100512.51  0.08%     -    0s
     0     0 -100511.72    0   26 -100435.31 -100511.72  0.08%     -    0s
     0     0 -100457.63    0    7 -100435.31 -100457.63  0.02%     -    0s
     0     0 -100449.40    0    6 -100435.31 -100449.40  0.01%     -    0s
     0     0 -100445.86    0    4 -100435.31 -100445.86  0.01%     -    0s
     0     0 -100442.74    0    4 -100435.31 -100442.74  0.01%     -    0s
     0     0 -100440.93    0    2 -100435.31 -100440.93  0.01%     -    0s
*    0     0               0    -100438.1265 -100438.13  0.00%     -    0s

Cutting planes:
  Gomory: 19
  MIR: 95
  RLT: 27

Explored 1 nodes (450 simplex iterations) in 0.02 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -100438 -100435 -97082.2 ... 1.17201e+13
No other solutions better than -100438

Optimal solution found (tolerance 1.00e-06)
Best objective -1.004381264609e+05, best bound -1.004381264609e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 96912.85
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100438.13
  [DEBUG]   S×d_nominal = 197350.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 197350.97 + -100438.13 = 96912.85
  [DEBUG]   Current θ from Master = 111533.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14620.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -26319.42
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1320.0951, Absolute Gap = 1320.0951, Relative Gap = 0.112842
  Not converged yet (gap = 1320.10 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437949 nonzeros
Model fingerprint: 0xa48b8e47
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 66760 rows and 27110 columns
Presolve time: 1.28s
Presolved: 87523 rows, 37550 columns, 533019 nonzeros
Variable types: 35291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -384051.3542
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.755e+06
 Factor NZ  : 8.145e+06 (roughly 120 MB of memory)
 Factor Ops : 1.399e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.65412627e+07  1.46975116e+08  8.63e+04 1.95e+01  6.91e+04     2s
   1  -1.22784481e+07  1.27582334e+08  5.87e+04 6.21e+01  4.65e+04     2s
   2  -4.45340485e+06  1.01294116e+08  2.08e+04 2.99e-11  1.74e+04     2s
   3  -7.55213540e+05  6.74714529e+07  1.48e+03 1.14e+00  1.57e+03     3s
   4  -4.55002036e+05  2.35240321e+07  2.77e+02 1.93e-01  3.37e+02     3s
   5  -3.69449354e+05  1.67423420e+07  1.36e+02 1.21e-01  1.91e+02     3s
   6  -2.56088675e+05  1.30431344e+07  5.98e+01 8.76e-02  1.17e+02     3s
   7  -1.41734840e+05  9.05740243e+06  1.30e+01 5.53e-02  6.33e+01     3s
   8  -1.01993174e+05  3.90456001e+06  6.92e+00 2.16e-02  2.66e+01     3s
   9  -8.07168035e+04  1.96333970e+06  4.39e+00 1.04e-02  1.33e+01     3s
  10  -5.25736960e+04  6.45653282e+05  2.47e+00 3.11e-03  4.48e+00     3s
  11  -2.89977596e+04  2.96574666e+05  1.45e+00 2.02e-03  2.07e+00     3s
  12  -1.62739114e+04  1.32553960e+05  6.73e-01 6.28e-04  9.36e-01     3s
  13  -1.29773869e+04  8.79838859e+04  5.39e-01 5.63e-04  6.34e-01     3s
  14  -7.64674396e+03  6.57234399e+04  3.90e-01 7.27e-04  4.60e-01     3s
  15  -4.78345414e+03  5.29312516e+04  3.25e-01 1.10e-03  3.61e-01     3s
  16  -1.21242154e+03  4.04182374e+04  2.50e-01 1.28e-03  2.61e-01     3s
  17   1.93879579e+03  3.35590245e+04  1.90e-01 1.07e-03  1.98e-01     3s
  18   3.56229260e+03  2.83670085e+04  1.60e-01 1.31e-03  1.55e-01     3s
  19   6.17695669e+03  2.43108919e+04  1.15e-01 1.75e-03  1.13e-01     3s
  20   7.65906577e+03  2.04813192e+04  9.13e-02 1.72e-03  8.02e-02     3s
  21   8.71414323e+03  1.90509722e+04  7.18e-02 1.42e-03  6.46e-02     3s
  22   9.59449200e+03  1.78218129e+04  5.75e-02 1.56e-03  5.14e-02     3s
  23   1.02049386e+04  1.66387902e+04  4.82e-02 1.48e-03  4.02e-02     3s
  24   1.06711300e+04  1.58767227e+04  4.11e-02 1.31e-03  3.25e-02     3s
  25   1.12855076e+04  1.54231335e+04  3.22e-02 1.11e-03  2.59e-02     4s
  26   1.19341059e+04  1.48988169e+04  2.29e-02 7.52e-04  1.85e-02     4s
  27   1.23011262e+04  1.46132717e+04  1.77e-02 6.44e-04  1.45e-02     4s
  28   1.24178732e+04  1.44798065e+04  1.61e-02 6.38e-04  1.29e-02     4s
  29   1.27624878e+04  1.42434574e+04  1.15e-02 8.27e-04  9.26e-03     4s
  30   1.30389672e+04  1.40669616e+04  7.87e-03 4.54e-04  6.42e-03     4s
  31   1.31188379e+04  1.39627838e+04  6.81e-03 4.00e-04  5.28e-03     4s
  32   1.32806782e+04  1.38952073e+04  4.67e-03 3.24e-04  3.84e-03     4s
  33   1.32938317e+04  1.38814126e+04  4.49e-03 3.06e-04  3.67e-03     4s
  34   1.34144478e+04  1.37680291e+04  2.98e-03 1.98e-04  2.21e-03     4s
  35   1.35099029e+04  1.37152804e+04  1.77e-03 1.80e-04  1.28e-03     4s
  36   1.35819309e+04  1.36873499e+04  8.71e-04 9.61e-05  6.59e-04     4s
  37   1.35905358e+04  1.36754655e+04  7.68e-04 5.80e-05  5.31e-04     4s
  38   1.36144510e+04  1.36713753e+04  4.85e-04 4.50e-05  3.56e-04     4s
  39   1.36226378e+04  1.36700276e+04  3.89e-04 4.05e-05  2.96e-04     4s
  40   1.36302294e+04  1.36681792e+04  3.03e-04 3.46e-05  2.37e-04     4s
  41   1.36469081e+04  1.36623082e+04  1.17e-04 2.06e-05  9.62e-05     4s
  42   1.36555417e+04  1.36579555e+04  1.76e-05 5.93e-06  1.51e-05     4s
  43   1.36558730e+04  1.36578867e+04  1.44e-05 5.09e-06  1.26e-05     5s
  44   1.36568749e+04  1.36577540e+04  4.78e-06 3.63e-06  5.49e-06     5s
  45   1.36571440e+04  1.36575956e+04  2.45e-06 1.84e-06  2.82e-06     5s
  46   1.36573098e+04  1.36574428e+04  1.01e-06 9.78e-07  8.31e-07     5s
  47   1.36574272e+04  1.36574278e+04  3.57e-09 4.99e-09  3.99e-09     5s
  48   1.36574273e+04  1.36574275e+04  8.00e-08 1.23e-08  9.88e-10     5s
  49   1.36574274e+04  1.36574275e+04  8.50e-08 9.17e-11  3.25e-10     5s

Barrier solved model in 49 iterations and 4.91 seconds (7.51 work units)
Optimal objective 1.36574274e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 7s

    8236 PPushes remaining with PInf 4.8775530e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5670586e+05      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36741    1.3657427e+04   0.000000e+00   1.567059e+05      7s
   36890    1.3657427e+04   0.000000e+00   0.000000e+00      7s
   36890    1.3657427e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 1.365743e+04, 36890 iterations, 5.30 seconds (10.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 13657.4275    0  550 -190756.93 13657.4275   107%     -    7s
H    0     0                    -179443.4956 13657.4275   108%     -    7s
H    0     0                    -149129.5474 13657.4275   109%     -    7s
H    0     0                    -141811.7755 13657.4275   110%     -    8s
H    0     0                    -141403.8892 13657.4275   110%     -    8s
H    0     0                    -130059.6344 13657.4275   111%     -    8s
H    0     0                    -127608.4909 13657.4275   111%     -    8s
H    0     0                    -125830.7928 13657.4275   111%     -    8s
H    0     0                    -120676.9824 13657.4275   111%     -    8s
H    0     0                    -118305.4206 13657.4275   112%     -    8s
H    0     0                    -115200.9131 13657.4275   112%     -    8s
H    0     0                    -94632.18208 13657.4275   114%     -    9s
H    0     0                    -94554.40781 13657.4275   114%     -    9s
H    0     0                    -81715.00432 13657.4275   117%     -   11s
H    0     0                    -69867.01007 13657.4275   120%     -   11s
H    0     0                    -68925.03966 13657.4275   120%     -   11s
H    0     0                    -68704.81285 7985.73015   112%     -   36s
     0     0 7985.73015    0  723 -68704.813 7985.73015   112%     -   37s
H    0     0                    -68251.22962 7984.71832   112%     -   37s
H    0     0                    -68025.12586 7984.71832   112%     -   38s
H    0     0                    -67921.24147 7984.71832   112%     -   38s
H    0     0                    -67920.30372 7984.71832   112%     -   38s
H    0     0                    -67881.28209 7984.71832   112%     -   38s
     0     0 7530.81589    0  726 -67881.282 7530.81589   111%     -   46s
     0     0 7151.89960    0  697 -67881.282 7151.89960   111%     -   52s
     0     0 7086.62812    0  698 -67881.282 7086.62812   110%     -   55s
     0     0 7079.83707    0  701 -67881.282 7079.83707   110%     -   57s
     0     0 7079.42795    0  702 -67881.282 7079.42795   110%     -   58s
H    0     0                    -50499.64252 4078.78079   108%     -   95s
H    0     0                    -49765.29658 4078.78079   108%     -   95s
H    0     0                    -49726.11715 4078.78079   108%     -   95s
H    0     0                    -46762.80716 4078.78079   109%     -   95s
H    0     0                    -45364.34477 4078.78079   109%     -   95s
H    0     0                    -44920.53601 4078.78079   109%     -   95s
H    0     0                    -44898.40669 4078.78079   109%     -   95s
H    0     0                    -44765.46669 4078.78079   109%     -   95s
H    0     0                    -44748.25831 4078.78079   109%     -   95s
H    0     0                    -44724.40700 4078.78079   109%     -   95s
     0     0 4077.64647    0  691 -44724.407 4077.64647   109%     -   95s
H    0     0                    -44410.52968 4077.64647   109%     -   96s
H    0     0                    -25709.37146 4077.64647   116%     -   96s
H    0     0                    -25460.01614 4077.64647   116%     -   96s
     0     0 3513.19357    0  683 -25460.016 3513.19357   114%     -  121s
     0     0 3392.70538    0  698 -25460.016 3392.70538   113%     -  133s
     0     0 3300.71310    0  688 -25460.016 3300.71310   113%     -  142s
H    0     0                    -25293.74867 3269.12049   113%     -  148s
H    0     0                    -25001.22691 3269.12049   113%     -  148s
     0     0 3269.12049    0  673 -25001.227 3269.12049   113%     -  148s
H    0     0                    -24559.63628 3256.26683   113%     -  151s
H    0     0                    -23916.32225 3256.26683   114%     -  151s
     0     0 3256.26683    0  678 -23916.322 3256.26683   114%     -  151s
     0     0 3248.11504    0  685 -23916.322 3248.11504   114%     -  153s
     0     0 3241.76879    0  690 -23916.322 3241.76879   114%     -  156s
     0     0 3209.31913    0  677 -23916.322 3209.31913   113%     -  160s
     0     0 3207.54018    0  682 -23916.322 3207.54018   113%     -  161s
     0     0 3197.32963    0  676 -23916.322 3197.32963   113%     -  165s
     0     0 3197.05407    0  673 -23916.322 3197.05407   113%     -  166s
     0     0 1278.83690    0  629 -23916.322 1278.83690   105%     -  215s
H    0     0                    -22310.34212 1278.66855   106%     -  216s
H    0     0                    -22090.40643 1278.66855   106%     -  216s
H    0     0                    -22081.82740 1278.66855   106%     -  216s
H    0     0                    -20902.87320  895.20197   104%     -  240s
H    0     0                    -20850.78124  895.20197   104%     -  240s
H    0     0                    -20211.90078  895.20197   104%     -  240s
H    0     0                    -20106.60043  895.20197   104%     -  240s
H    0     0                    -20106.36871  895.20197   104%     -  240s
H    0     0                    -20100.15222  895.20197   104%     -  240s
     0     0  895.20197    0  691 -20100.152  895.20197   104%     -  240s
H    0     0                    -20095.64597  673.55466   103%     -  259s
H    0     0                    -19975.12617  673.55466   103%     -  259s
H    0     0                    -18603.70414  673.55466   104%     -  259s
     0     0  673.55466    0  659 -18603.704  673.55466   104%     -  259s
     0     0  616.63109    0  715 -18603.704  616.63109   103%     -  276s
     0     0  583.52411    0  739 -18603.704  583.52411   103%     -  285s
     0     0  532.95439    0  680 -18603.704  532.95439   103%     -  295s
     0     0  502.14134    0  780 -18603.704  502.14134   103%     -  306s
     0     0  458.50376    0  722 -18603.704  458.50376   102%     -  314s
     0     0  448.79289    0  725 -18603.704  448.79289   102%     -  319s
     0     0  428.43681    0  723 -18603.704  428.43681   102%     -  328s
     0     0  406.56013    0  722 -18603.704  406.56013   102%     -  335s
     0     0  405.55675    0  724 -18603.704  405.55675   102%     -  337s
H    0     0                    -18364.61289  405.55675   102%     -  355s
H    0     0                    -17884.90505  405.55675   102%     -  355s
H    0     0                    -17373.83342  405.55675   102%     -  355s
H    0     0                    -17223.86602  405.55675   102%     -  355s
H    0     0                    -17201.20984  405.55675   102%     -  355s
H    0     0                    -17110.09417  405.55675   102%     -  355s
H    0     0                    -15628.66040 -357.46875  97.7%     -  393s
H    0     0                    -14098.69966 -357.46875  97.5%     -  393s
H    0     0                    -13800.93512 -357.46875  97.4%     -  393s
H    0     0                    -13739.26985 -357.46875  97.4%     -  393s
H    0     0                    -13735.48216 -357.46875  97.4%     -  393s
     0     0 -357.46875    0  640 -13735.482 -357.46875  97.4%     -  393s
     0     0 -548.31346    0  672 -13735.482 -548.31346  96.0%     -  413s
     0     0 -599.12970    0  664 -13735.482 -599.12970  95.6%     -  434s
     0     0 -628.52389    0  729 -13735.482 -628.52389  95.4%     -  446s
H    0     0                    -13439.34888 -649.20321  95.2%     -  455s
H    0     0                    -13435.42718 -649.20321  95.2%     -  455s
     0     0 -649.20321    0  737 -13435.427 -649.20321  95.2%     -  455s
     0     0 -669.13085    0  737 -13435.427 -669.13085  95.0%     -  462s
     0     0 -678.25972    0  742 -13435.427 -678.25972  95.0%     -  466s
     0     0 -685.72295    0  754 -13435.427 -685.72295  94.9%     -  470s
H    0     0                    -13427.76348 -688.36599  94.9%     -  473s
     0     0 -688.36599    0  741 -13427.763 -688.36599  94.9%     -  474s
     0     0 -901.46597    0  671 -13427.763 -901.46597  93.3%     -  505s
H    0     0                    -13304.10208 -901.50182  93.2%     -  505s
H    0     0                    -12861.15169 -901.50182  93.0%     -  505s
H    0     0                    -12809.22767 -901.50182  93.0%     -  506s
H    0     0                    -12798.26732 -901.50182  93.0%     -  506s
H    0     0                    -12797.10780 -901.50182  93.0%     -  506s
H    0     0                    -12704.55375 -901.50182  92.9%     -  506s
H    0     0                    -12703.39422 -901.50182  92.9%     -  506s
     0     0 -963.18201    0  664 -12703.394 -963.18201  92.4%     -  522s
     0     0 -981.11118    0  672 -12703.394 -981.11118  92.3%     -  532s
     0     0 -984.04418    0  673 -12703.394 -984.04418  92.3%     -  535s
     0     0 -1119.1115    0  735 -12703.394 -1119.1115  91.2%     -  560s
H    0     0                    -12147.70942 -1119.2166  90.8%     -  561s
H    0     0                    -12042.51449 -1119.2166  90.7%     -  563s
H    0     0                    -11967.66691 -1119.2166  90.6%     -  563s
H    0     0                    -11960.00320 -1119.2166  90.6%     -  564s
     0     0 -1149.9513    0  724 -11960.003 -1149.9513  90.4%     -  576s
     0     0 -1169.3788    0  667 -11960.003 -1169.3788  90.2%     -  586s
     0     0 -1180.6179    0  671 -11960.003 -1180.6179  90.1%     -  593s
     0     0 -1183.3359    0  672 -11960.003 -1183.3359  90.1%     -  597s
     0     0 -1254.6120    0  685 -11960.003 -1254.6120  89.5%     -  620s
     0     0 -1281.4007    0  750 -11960.003 -1281.4007  89.3%     -  632s
     0     0 -1293.9208    0  759 -11960.003 -1293.9208  89.2%     -  638s
     0     0 -1296.6914    0  707 -11960.003 -1296.6914  89.2%     -  641s
     0     0 -1345.1456    0  697 -11960.003 -1345.1456  88.8%     -  658s
H    0     0                    -11958.83904 -1345.1714  88.8%     -  660s
     0     0 -1351.8654    0  701 -11958.839 -1351.8654  88.7%     -  666s
     0     0 -1358.0133    0  695 -11958.839 -1358.0133  88.6%     -  671s
     0     0 -1361.4509    0  723 -11958.839 -1361.4509  88.6%     -  675s
     0     0 -1362.5527    0  716 -11958.839 -1362.5527  88.6%     -  677s
     0     0 -1375.1780    0  711 -11958.839 -1375.1780  88.5%     -  686s
     0     0 -1390.1268    0  716 -11958.839 -1390.1268  88.4%     -  691s
     0     0 -1437.4383    0  714 -11958.839 -1437.4383  88.0%     -  701s
     0     0 -1441.7768    0  719 -11958.839 -1441.7768  87.9%     -  705s
     0     0 -1443.1622    0  731 -11958.839 -1443.1622  87.9%     -  707s
     0     0 -1461.2355    0  700 -11958.839 -1461.2355  87.8%     -  717s
H    0     0                    -11916.76093 -1461.4055  87.7%     -  724s
H    0     0                    -11904.61135 -1461.4055  87.7%     -  725s
     0     0 -1478.7746    0  710 -11904.611 -1478.7746  87.6%     -  734s
     0     0 -1486.3856    0  779 -11904.611 -1486.3856  87.5%     -  741s
     0     0 -1488.0661    0  718 -11904.611 -1488.0661  87.5%     -  744s
     0     0 -1514.6734    0  754 -11904.611 -1514.6734  87.3%     -  759s
     0     0 -1519.4198    0  713 -11904.611 -1519.4198  87.2%     -  764s
     0     0 -1520.9526    0  775 -11904.611 -1520.9526  87.2%     -  770s
     0     0 -1530.1299    0  782 -11904.611 -1530.1299  87.1%     -  779s
     0     0 -1534.1946    0  719 -11904.611 -1534.1946  87.1%     -  787s
     0     0 -1536.0419    0  721 -11904.611 -1536.0419  87.1%     -  791s
     0     0 -1550.7446    0  708 -11904.611 -1550.7446  87.0%     -  802s
     0     0 -1550.8177    0  708 -11904.611 -1550.8177  87.0%     -  808s
     0     2 -1550.8177    0  708 -11904.611 -1550.8177  87.0%     -  926s
     1     3 -2439.9642    1  623 -11904.611 -1551.0273  87.0% 25961  970s
     2     4 -1665.1921    1  697 -11904.611 -1665.1921  86.0% 16200  981s
     3     7 -2905.8626    2  614 -11904.611 -1665.2070  86.0% 12578  995s
     6    12 -3105.8140    3  611 -11904.611 -1665.2263  86.0%  9772 1016s
    11    22 -3169.4829    4  616 -11904.611 -1744.9751  85.3%  9620 1043s
    21    32 -3451.6895    4  439 -11904.611 -1885.9500  84.2% 13978 1108s
    31    61 -5264.6042    5  423 -11904.611 -1885.9500  84.2% 13996 1223s
    60    93 -5321.1966    6  426 -11904.611 -1885.9500  84.2% 19048 1270s
H   69    93                    -11886.68137 -1885.9500  84.1% 17737 1270s
H   73    93                    -11738.63920 -1885.9500  83.9% 17797 1270s
H   92   127                    -11706.06178 -1885.9500  83.9% 16701 1302s
H   94   127                    -11676.15560 -1885.9500  83.8% 16458 1302s
H   98   127                    -11438.13022 -1885.9500  83.5% 15907 1302s
H  109   127                    -11437.26110 -1885.9500  83.5% 14550 1302s
   126   262 -7622.3668    8  173 -11437.261 -1885.9500  83.5% 13598 1345s
   263   350 -8378.0691   13  148 -11437.261 -1885.9500  83.5%  8619 1367s
   368   403 -8770.3292   17  143 -11437.261 -1885.9500  83.5%  7070 1384s
   460   435     cutoff   22      -11437.261 -1885.9500  83.5%  6185 1404s
   531   483     cutoff   20      -11437.261 -1885.9500  83.5%  5817 1420s
   604   509 -6376.6536   15  417 -11437.261 -1885.9500  83.5%  5703 1437s
   670   531 -7806.1044   17  314 -11437.261 -1885.9500  83.5%  5636 1454s
   728   541 -8418.0748   18  212 -11437.261 -1885.9500  83.5%  5521 1469s
   784   553 -11250.315   20   79 -11437.261 -1885.9500  83.5%  5390 1485s
   843   571     cutoff   14      -11437.261 -1885.9500  83.5%  5431 1501s
   889   615 -7090.5153   16  355 -11437.261 -1885.9500  83.5%  5493 1515s
   961   678 -11230.812   25   53 -11437.261 -1885.9500  83.5%  5331 1531s
  1088   689 -11256.128   30   39 -11437.261 -1885.9500  83.5%  5048 1549s
  1185   716 -5345.4862   16  368 -11437.261 -1885.9500  83.5%  4890 1565s
H 1186   716                    -11434.62555 -1885.9500  83.5%  4886 1565s
H 1211   716                    -11424.29252 -1885.9500  83.5%  4934 1565s
H 1214   716                    -11324.50449 -1885.9500  83.3%  4940 1565s
  1252   747 -8285.1721   17  192 -11324.504 -1885.9500  83.3%  4949 1581s
  1331   801     cutoff   20      -11324.504 -1885.9500  83.3%  4988 1599s
  1443   887     cutoff   22      -11324.504 -1885.9500  83.3%  4899 1615s
  1585   950 -10127.131   24   78 -11324.504 -1885.9500  83.3%  4739 1635s
H 1708   950                    -11275.34932 -1885.9500  83.3%  4528 1635s
  1746   945 -10335.000   34   38 -11275.349 -1885.9500  83.3%  4508 1654s
  1862   975 -6817.9154   15  215 -11275.349 -1885.9500  83.3%  4479 1677s
  1952   996 -9817.2521   17  254 -11275.349 -1885.9500  83.3%  4503 1700s
* 2009   996              26    -11272.71377 -1885.9500  83.3%  4548 1700s
  2021  1017 -8169.1974   19  414 -11272.714 -1885.9500  83.3%  4556 1726s
  2060  1028 -8710.9705   20  317 -11272.714 -1885.9500  83.3%  4656 1759s
  2121  1043 -9319.2263   22  177 -11272.714 -1885.9500  83.3%  4733 1785s
  2174  1084     cutoff   23      -11272.714 -1885.9500  83.3%  4817 1812s
  2249  1124     cutoff   24      -11272.714 -1885.9500  83.3%  4885 1838s
  2327  1155 -10401.334   27  218 -11272.714 -1885.9500  83.3%  4944 1866s
  2438  1177 -10913.101   32  204 -11272.714 -1885.9500  83.3%  4954 1898s
  2521  1210 -5680.9866   12  476 -11272.714 -1885.9500  83.3%  5007 1929s
  2586  1273 -5981.2682   13  465 -11272.714 -1885.9500  83.3%  5148 1961s
  2671  1351 -9602.9554   14  294 -11272.714 -1885.9500  83.3%  5263 1991s
  2819  1407 infeasible   16      -11272.714 -1885.9500  83.3%  5252 2026s
  2960  1449 -7427.2669   18  423 -11272.714 -1885.9500  83.3%  5249 2060s
  3088  1485 infeasible   20      -11272.714 -1885.9500  83.3%  5292 2094s
  3217  1539 infeasible   25      -11272.714 -1885.9500  83.3%  5308 2134s
  3358  1598 -9601.9651   31  217 -11272.714 -1885.9500  83.3%  5370 2173s
  3568  1671 -11077.399   42  340 -11272.714 -1885.9500  83.3%  5319 2204s
  3717  1717 -9841.0652   15  393 -11272.714 -1885.9500  83.3%  5298 2243s
  3851  1769     cutoff   18      -11272.714 -1885.9500  83.3%  5322 2287s
  3967  1829 -7122.6848   12  394 -11272.714 -1885.9500  83.3%  5417 2327s
  4146  1898 -8096.0043   20  324 -11272.714 -1885.9500  83.3%  5428 2371s
  4349  1969 -11140.196   34  344 -11272.714 -1885.9500  83.3%  5473 2419s
  4546  2022 -5570.4117   13  409 -11272.714 -1885.9500  83.3%  5504 2468s
  4735  2086 -8012.3248   15  417 -11272.714 -1885.9500  83.3%  5559 2520s
  4905  2141 -10789.076   17  342 -11272.714 -2026.3067  82.0%  5630 2567s
  5032  2212 -10423.924   31   71 -11272.714 -2026.3067  82.0%  5659 2618s
  5215  2213 -4998.2330   14  708 -11272.714 -2026.3067  82.0%  5724 2830s
  5217  2214 -9895.3481   20  511 -11272.714 -2026.3067  82.0%  5722 2842s
  5218  2215 -9471.8247   32  589 -11272.714 -2026.3067  82.0%  5721 2915s
  5219  2216 -9697.6325   23  716 -11272.714 -2026.3067  82.0%  5720 2986s
  5220  2216 -4892.7459   15  723 -11272.714 -2026.3067  82.0%  5719 3042s
  5221  2217 -9082.4821   25  732 -11272.714 -2026.3067  82.0%  5718 3075s
  5222  2218 -9660.4300    9  681 -11272.714 -2026.3067  82.0%  5716 3097s
  5223  2218 -9453.1527   14  686 -11272.714 -2026.3067  82.0%  5715 3123s
  5224  2219 -9862.6483   19  754 -11272.714 -2026.3067  82.0%  5714 3141s
  5225  2220 -7296.3601   19  743 -11272.714 -2026.3067  82.0%  5713 3169s
  5226  2220 -8784.5525   17  720 -11272.714 -2026.3067  82.0%  5712 3183s
  5227  2221 -9608.2176   31  720 -11272.714 -2026.3067  82.0%  5711 3199s
  5228  2222 -6114.2465   15  718 -11272.714 -2026.3067  82.0%  5710 3211s
  5229  2222 -10678.344   34  713 -11272.714 -2026.3067  82.0%  5709 3216s
  5230  2223 -7443.0741   19  772 -11272.714 -2026.3067  82.0%  5708 3223s
  5231  2224 -11083.144   16  732 -11272.714 -2026.3067  82.0%  5707 3229s
  5232  2224 -8104.4071   19  720 -11272.714 -2026.3067  82.0%  5706 3235s
  5233  2225 -7610.8125   14  817 -11272.714 -2026.3067  82.0%  5704 3293s
  5234  2226 -8639.7504   16  752 -11272.714 -2026.3067  82.0%  5703 3312s
  5235  2226 -9749.5348   28  695 -11272.714 -2026.3067  82.0%  5702 3328s
  5236  2227 -8467.5313   20  697 -11272.714 -2052.0860  81.8%  5701 3338s
  5237  2228 -6287.3302   12  769 -11272.714 -2065.2383  81.7%  5700 3352s
  5238  2228 -10807.793   26  690 -11272.714 -2070.9043  81.6%  5699 3357s
  5239  2229 -8457.9899   13  748 -11272.714 -2096.9790  81.4%  5698 3367s
  5240  2230 -8413.8506   23  697 -11272.714 -2107.2580  81.3%  5697 3373s
  5241  2230 -6964.2379   15  682 -11272.714 -2117.0189  81.2%  5696 3380s
  5243  2232 -11225.203   34  688 -11272.714 -2121.7583  81.2%  5694 3389s
  5244  2232 -8771.3886   18  796 -11272.714 -2238.4899  80.1%  5692 3419s
  5245  2233 -7874.6120   11  752 -11272.714 -2278.8480  79.8%  5691 3433s
  5246  2234 -7609.2752   14  771 -11272.714 -2298.0012  79.6%  5690 3446s
  5247  2234 -9148.5045   27  765 -11272.714 -2307.1747  79.5%  5689 3455s
  5249  2236 -7517.6192   15  780 -11272.714 -2314.8016  79.5%  5687 3462s
  5250  2236 -7491.9485   21  767 -11272.714 -2317.3220  79.4%  5686 3465s
  5251  2237 -5673.8028   10  710 -11272.714 -2318.3441  79.4%  5685 3470s
  5252  2238 -10089.493   36  690 -11272.714 -2398.8963  78.7%  5684 3493s
  5253  2238 -5607.0491    8  761 -11272.714 -2415.2386  78.6%  5683 3501s
  5254  2239 -5911.7736   13  704 -11272.714 -2423.2056  78.5%  5682 3505s
  5255  2240 -6226.0730   13  702 -11272.714 -2431.0145  78.4%  5681 3510s
  5256  2240 -7132.8565   20  713 -11272.714 -2433.2746  78.4%  5679 3516s
  5257  2241 -10221.304   20  773 -11272.714 -2474.4883  78.0%  5678 3534s
  5258  2242 -9478.8676   15  764 -11272.714 -2484.9032  78.0%  5677 3543s
  5259  2242 -9546.0717   22  840 -11272.714 -2489.7360  77.9%  5676 3549s
  5260  2243 -6023.1717   16  772 -11272.714 -2492.4206  77.9%  5675 3552s
  5261  2244 -9591.2043   45  841 -11272.714 -2493.4009  77.9%  5674 3559s
  5262  2244 -7800.8604   20  819 -11272.714 -2577.9662  77.1%  5673 3590s
  5263  2245 -6481.9212   15  902 -11272.714 -2590.3075  77.0%  5672 3598s

Cutting planes:
  Learned: 2
  Implied bound: 14
  Projected implied bound: 230
  MIR: 1593
  Flow cover: 1702
  Zero half: 3
  RLT: 92
  Relax-and-lift: 192

Explored 5263 nodes (30912652 simplex iterations) in 3600.03 seconds (8406.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11272.7 -11275.3 -11324.5 ... -11738.6

Time limit reached
Best objective -1.127271377137e+04, best bound -2.590307498756e+03, gap 77.0214%
  WARNING: Time limit reached. Using best solution found (gap: 77.02%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -11272.71, θ = 116839.98
  Upper Bound (UB) = -11272.71

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116839.98
  [DEBUG]   ✓ Scenario 0: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116839.98 ≤ Q = 116839.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116839.98 ≤ Q = 116839.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 116839.98 ≤ Q = 116839.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x62e9e2e1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x62e9e2e1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.329312e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 7034682.0885
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.199924e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -119992.42    0  122 7034682.09 -119992.42   102%     -    0s
H    0     0                    -85489.75535 -119992.42  40.4%     -    0s
H    0     0                    -86019.10934 -119992.42  39.5%     -    0s
     0     0 -98884.085    0   39 -86019.109 -98884.085  15.0%     -    0s
H    0     0                    -98021.94768 -98857.496  0.85%     -    0s
H    0     0                    -98265.17683 -98857.496  0.60%     -    0s
     0     0 -98627.602    0   21 -98265.177 -98627.602  0.37%     -    0s
     0     0 -98597.690    0   11 -98265.177 -98597.690  0.34%     -    0s
H    0     0                    -98296.26380 -98553.372  0.26%     -    0s
     0     0 -98483.192    0   15 -98296.264 -98483.192  0.19%     -    0s
     0     0 -98463.484    0   15 -98296.264 -98463.484  0.17%     -    0s
     0     0 -98410.553    0    8 -98296.264 -98410.553  0.12%     -    0s
     0     0 -98410.553    0   16 -98296.264 -98410.553  0.12%     -    0s
*    0     0               0    -98367.13235 -98367.132  0.00%     -    0s

Cutting planes:
  Gomory: 9
  MIR: 7
  Flow cover: 9

Explored 1 nodes (586 simplex iterations) in 0.04 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -98367.1 -98296.3 -98265.2 ... 1.32931e+13
No other solutions better than -98367.1

Optimal solution found (tolerance 1.00e-06)
Best objective -9.836713235406e+04, best bound -9.836713235406e+04, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 107054.58
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98367.13
  [DEBUG]   S×d_nominal = 205421.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205421.71 + -98367.13 = 107054.58
  [DEBUG]   Current θ from Master = 116839.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9785.40 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -21058.11
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1746.0001, Absolute Gap = 1746.0001, Relative Gap = 0.154887
  Not converged yet (gap = 1746.00 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481192 nonzeros
Model fingerprint: 0x9e231a71
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 73446 rows and 29826 columns
Presolve time: 1.38s
Presolved: 96127 rows, 41074 columns, 583121 nonzeros
Variable types: 38815 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -384705.7937
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 4.332e+06
 Factor NZ  : 9.496e+06 (roughly 130 MB of memory)
 Factor Ops : 1.733e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66095014e+07  1.60177447e+08  8.67e+04 1.95e+01  6.89e+04     3s
   1  -1.23784000e+07  1.38955224e+08  5.90e+04 5.94e+01  4.64e+04     3s
   2  -4.08666091e+06  1.10237257e+08  1.87e+04 4.01e-11  1.57e+04     3s
   3  -8.25075458e+05  7.37512710e+07  1.65e+03 1.60e+00  1.70e+03     3s
   4  -4.90213501e+05  2.80908236e+07  3.04e+02 3.46e-01  3.71e+02     3s
   5  -3.99126779e+05  1.95551166e+07  1.53e+02 2.16e-01  2.10e+02     3s
   6  -2.73242610e+05  1.49841900e+07  5.06e+01 1.53e-01  1.16e+02     3s
   7  -1.55507245e+05  9.68776511e+06  7.39e+00 9.09e-02  5.92e+01     3s
   8  -1.08233828e+05  4.67210783e+06  3.88e+00 4.14e-02  2.81e+01     3s
   9  -7.59854823e+04  3.13739122e+06  2.30e+00 2.74e-02  1.86e+01     3s
  10  -5.53966633e+04  9.67367257e+05  1.38e+00 8.00e-03  5.89e+00     3s
  11  -2.76263858e+04  3.99840648e+05  6.27e-01 3.01e-03  2.44e+00     3s
  12  -1.39181267e+04  1.46509549e+05  2.28e-01 1.03e-03  9.13e-01     3s
  13  -1.09403524e+04  1.05064863e+05  1.82e-01 6.75e-04  6.60e-01     3s
  14  -5.85191345e+03  7.41554928e+04  1.28e-01 1.00e-03  4.55e-01     3s
  15  -3.55531028e+03  5.86916959e+04  1.09e-01 1.06e-03  3.54e-01     3s
  16   5.77778025e+02  4.41204886e+04  7.83e-02 2.29e-03  2.47e-01     3s
  17   3.47846214e+03  3.42864114e+04  6.02e-02 2.48e-03  1.75e-01     3s
  18   5.52609803e+03  2.90490922e+04  4.83e-02 2.94e-03  1.34e-01     4s
  19   6.83019610e+03  2.45805448e+04  4.01e-02 3.20e-03  1.01e-01     4s
  20   9.00461808e+03  2.13796950e+04  2.74e-02 2.40e-03  7.03e-02     4s
  21   9.48331889e+03  1.96679729e+04  2.47e-02 1.92e-03  5.79e-02     4s
  22   1.06040432e+04  1.84779136e+04  1.85e-02 1.88e-03  4.47e-02     4s
  23   1.13690573e+04  1.77540470e+04  1.44e-02 1.52e-03  3.63e-02     4s
  24   1.19582920e+04  1.67905636e+04  1.14e-02 1.05e-03  2.74e-02     4s
  25   1.21484374e+04  1.66601778e+04  1.04e-02 9.90e-04  2.56e-02     4s
  26   1.26046821e+04  1.61870990e+04  8.02e-03 7.99e-04  2.03e-02     4s
  27   1.27074571e+04  1.59047208e+04  7.51e-03 6.86e-04  1.82e-02     4s
  28   1.30662318e+04  1.55794889e+04  5.76e-03 5.44e-04  1.43e-02     4s
  29   1.33625286e+04  1.54436897e+04  4.36e-03 4.83e-04  1.18e-02     4s
  30   1.35356599e+04  1.51228203e+04  3.54e-03 3.29e-04  9.01e-03     4s
  31   1.36844284e+04  1.49669962e+04  2.85e-03 2.61e-04  7.28e-03     4s
  32   1.38466075e+04  1.47111014e+04  2.15e-03 1.12e-04  4.91e-03     4s
  33   1.39934111e+04  1.46037467e+04  1.48e-03 7.85e-05  3.47e-03     5s
  34   1.40520710e+04  1.45632038e+04  1.24e-03 6.45e-05  2.90e-03     5s
  35   1.41419046e+04  1.45214349e+04  8.67e-04 5.66e-05  2.16e-03     5s
  36   1.42112770e+04  1.44691106e+04  5.80e-04 3.85e-05  1.46e-03     5s
  37   1.42398202e+04  1.44291756e+04  4.64e-04 2.66e-05  1.08e-03     5s
  38   1.42720474e+04  1.44162932e+04  3.38e-04 2.15e-05  8.19e-04     5s
  39   1.43052053e+04  1.44096507e+04  2.05e-04 1.90e-05  5.93e-04     5s
  40   1.43211587e+04  1.43993105e+04  1.42e-04 1.49e-05  4.44e-04     5s
  41   1.43353300e+04  1.43841530e+04  8.68e-05 1.05e-05  2.77e-04     5s
  42   1.43512464e+04  1.43730865e+04  2.36e-05 5.44e-06  1.24e-04     5s
  43   1.43587175e+04  1.43703633e+04  1.87e-06 4.82e-06  6.61e-05     5s
  44   1.43587916e+04  1.43634850e+04  1.68e-06 1.73e-06  2.66e-05     5s
  45   1.43590692e+04  1.43609970e+04  1.01e-06 7.16e-07  1.09e-05     5s
  46   1.43591013e+04  1.43609777e+04  9.38e-07 7.06e-07  1.06e-05     6s
  47   1.43591355e+04  1.43602002e+04  8.56e-07 3.36e-07  6.04e-06     6s
  48   1.43592235e+04  1.43598710e+04  6.36e-07 1.80e-07  3.67e-06     6s
  49   1.43593221e+04  1.43596470e+04  3.76e-07 7.56e-08  1.84e-06     6s
  50   1.43594799e+04  1.43594892e+04  3.48e-09 6.97e-08  5.31e-08     6s
  51   1.43594801e+04  1.43594890e+04  1.77e-07 7.33e-08  5.02e-08     6s
  52   1.43594843e+04  1.43594845e+04  2.27e-08 6.34e-09  1.45e-09     6s
  53   1.43594845e+04  1.43594845e+04  3.33e-07 4.59e-10  2.38e-10     6s

Barrier solved model in 53 iterations and 6.12 seconds (9.86 work units)
Optimal objective 1.43594845e+04


Root crossover log...

   68350 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    8190 PPushes remaining with PInf 3.2650377e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.9433334e+01      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37414    1.4359485e+04   0.000000e+00   8.943333e+01      9s
   37416    1.4359485e+04   0.000000e+00   0.000000e+00      9s
   37416    1.4359485e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.16s

Solved with barrier

Root relaxation: objective 1.435948e+04, 37416 iterations, 7.17 seconds (14.62 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14359.4845    0  612 -190756.93 14359.4845   108%     -    9s
H    0     0                    -184338.3233 14359.4845   108%     -    9s
H    0     0                    -169580.6585 14359.4845   108%     -   10s
H    0     0                    -168862.6172 14359.4845   109%     -   10s
H    0     0                    -161037.0180 14359.4845   109%     -   10s
H    0     0                    -160862.8813 14359.4845   109%     -   10s
H    0     0                    -158891.8634 14359.4845   109%     -   10s
H    0     0                    -158128.3659 14359.4845   109%     -   10s
H    0     0                    -110967.3424 14359.4845   113%     -   10s
H    0     0                    -110836.7987 14359.4845   113%     -   10s
H    0     0                    -99222.94904 14359.4845   114%     -   10s
H    0     0                    -88279.60207 14359.4845   116%     -   10s
H    0     0                    -88185.27459 14359.4845   116%     -   12s
H    0     0                    -73955.57116 14359.4845   119%     -   12s
H    0     0                    -73460.43522 14359.4845   120%     -   12s
H    0     0                    -73201.87884 9124.43360   112%     -   50s
     0     0 8823.26535    0  805 -73201.879 8823.26535   112%     -   51s
     0     0 8710.38371    0  809 -73201.879 8710.38371   112%     -   59s
     0     0 8533.05167    0  813 -73201.879 8533.05167   112%     -   65s
     0     0 8471.08426    0  803 -73201.879 8471.08426   112%     -   67s
     0     0 8415.66998    0  815 -73201.879 8415.66998   111%     -   75s
     0     0 8388.38524    0  821 -73201.879 8388.38524   111%     -   83s
     0     0 8379.69923    0  835 -73201.879 8379.69923   111%     -   84s
     0     0 8378.33339    0  829 -73201.879 8378.33339   111%     -   85s
     0     0 8378.28896    0  822 -73201.879 8378.28896   111%     -   85s
H    0     0                    -40066.78400 5231.57056   113%     -  129s
H    0     0                    -38397.69430 5231.57056   114%     -  129s
H    0     0                    -37867.52608 5231.57056   114%     -  129s
H    0     0                    -37750.31361 5231.57056   114%     -  129s
H    0     0                    -37735.05905 5231.57056   114%     -  129s
H    0     0                    -30007.60484 5231.57056   117%     -  129s
H    0     0                    -27629.33876 5231.57056   119%     -  129s
H    0     0                    -27419.74852 5231.57056   119%     -  129s
H    0     0                    -27284.60086 5231.57056   119%     -  129s
H    0     0                    -27276.81279 5231.57056   119%     -  129s
H    0     0                    -27267.84354 5231.57056   119%     -  129s
H    0     0                    -27243.41540 5231.57056   119%     -  129s
H    0     0                    -27242.54060 5231.57056   119%     -  129s
H    0     0                    -27235.20923 5231.57056   119%     -  129s
H    0     0                    -27234.66310 5231.57056   119%     -  129s
H    0     0                    -27231.71376 5231.57056   119%     -  129s
     0     0 5231.57056    0  681 -27231.714 5231.57056   119%     -  129s
H    0     0                    -18973.21742 5231.48577   128%     -  130s
H    0     0                    -18432.52062 5231.48577   128%     -  130s
H    0     0                    -18403.92329 3708.22931   120%     -  193s
H    0     0                    -17320.17086 3708.22931   121%     -  193s
     0     0 3708.22931    0  809 -17320.171 3708.22931   121%     -  193s
     0     0 3330.33159    0  701 -17320.171 3330.33159   119%     -  219s
H    0     0                    -16932.16212 3200.42347   119%     -  236s
H    0     0                    -16850.46319 3200.42347   119%     -  236s
H    0     0                    -16835.48442 3200.42347   119%     -  236s
H    0     0                    -16606.67008 3200.42347   119%     -  236s
H    0     0                    -16604.74981 3200.42347   119%     -  236s
     0     0 3200.42347    0  695 -16604.750 3200.42347   119%     -  236s
     0     0 2991.82859    0  690 -16604.750 2991.82859   118%     -  250s
     0     0 2959.37437    0  690 -16604.750 2959.37437   118%     -  255s
     0     0 2862.86723    0  693 -16604.750 2862.86723   117%     -  267s
     0     0 2822.02230    0  710 -16604.750 2822.02230   117%     -  277s
     0     0 2815.95557    0  713 -16604.750 2815.95557   117%     -  283s
     0     0 2809.13539    0  709 -16604.750 2809.13539   117%     -  287s
     0     0 2764.13808    0  703 -16604.750 2764.13808   117%     -  296s
H    0     0                    -16169.32037 2752.22628   117%     -  301s
     0     0 2752.22628    0  734 -16169.320 2752.22628   117%     -  301s
     0     0 2742.97590    0  690 -16169.320 2742.97590   117%     -  303s
     0     0 2740.57147    0  693 -16169.320 2740.57147   117%     -  305s
     0     0 2739.99248    0  693 -16169.320 2739.99248   117%     -  306s
H    0     0                    -16153.53035 2739.99248   117%     -  319s
     0     0 1067.78541    0  639 -16153.530 1067.78541   107%     -  367s
H    0     0                    -16133.81007 1067.73408   107%     -  368s
H    0     0                    -15874.89931 1067.73408   107%     -  368s
H    0     0                    -15864.96311 1067.73408   107%     -  368s
     0     0  328.95679    0  657 -15864.963  328.95679   102%     -  409s
     0     0  257.20392    0  661 -15864.963  257.20392   102%     -  425s
     0     0  234.04636    0  694 -15864.963  234.04636   101%     -  432s
     0     0  215.39739    0  679 -15864.963  215.39739   101%     -  439s
     0     0  211.01977    0  697 -15864.963  211.01977   101%     -  442s
H    0     0                    -13242.01655  180.68744   101%     -  449s
     0     0  180.68744    0  690 -13242.017  180.68744   101%     -  449s
H    0     0                    -12998.23359  167.03207   101%     -  455s
H    0     0                    -12871.45147  167.03207   101%     -  455s
H    0     0                    -12870.58236  167.03207   101%     -  455s
H    0     0                    -12737.83710  167.03207   101%     -  455s
H    0     0                    -12251.67009  167.03207   101%     -  455s
H    0     0                    -11540.51896  167.03207   101%     -  455s
     0     0  167.03207    0  695 -11540.519  167.03207   101%     -  455s
H    0     0                    -11493.32107  163.80617   101%     -  459s
     0     0  163.80617    0  741 -11493.321  163.80617   101%     -  459s
     0     0  156.30921    0  731 -11493.321  156.30921   101%     -  463s
     0     0  143.59923    0  679 -11493.321  143.59923   101%     -  466s
     0     0  139.16258    0  690 -11493.321  139.16258   101%     -  468s
     0     0  135.73862    0  694 -11493.321  135.73862   101%     -  469s
     0     0  133.84797    0  693 -11493.321  133.84797   101%     -  471s
     0     0 -638.09296    0  742 -11493.321 -638.09296  94.4%     -  523s
     0     0 -812.96185    0  738 -11493.321 -812.96185  92.9%     -  555s
     0     0 -956.53677    0  733 -11493.321 -956.53677  91.7%     -  581s
     0     0 -1004.9710    0  817 -11493.321 -1004.9710  91.3%     -  599s
     0     0 -1015.0238    0  800 -11493.321 -1015.0238  91.2%     -  608s
     0     0 -1043.3465    0  820 -11493.321 -1043.3465  90.9%     -  620s
     0     0 -1060.2083    0  768 -11493.321 -1060.2083  90.8%     -  630s
     0     0 -1076.3019    0  759 -11493.321 -1076.3019  90.6%     -  643s
     0     0 -1126.8440    0  748 -11493.321 -1126.8440  90.2%     -  658s
     0     0 -1134.0087    0  813 -11493.321 -1134.0087  90.1%     -  666s
     0     0 -1135.2297    0  805 -11493.321 -1135.2297  90.1%     -  668s
     0     0 -1315.7623    0  742 -11493.321 -1315.7623  88.6%     -  703s
     0     0 -1368.6125    0  903 -11493.321 -1368.6125  88.1%     -  727s
     0     0 -1409.8613    0  764 -11493.321 -1409.8613  87.7%     -  742s
     0     0 -1417.5800    0  838 -11493.321 -1417.5800  87.7%     -  749s
     0     0 -1419.6359    0  756 -11493.321 -1419.6359  87.6%     -  753s
     0     0 -1499.2094    0  851 -11493.321 -1499.2094  87.0%     -  776s
     0     0 -1540.3836    0  800 -11493.321 -1540.3836  86.6%     -  791s
     0     0 -1548.7469    0  814 -11493.321 -1548.7469  86.5%     -  801s
     0     0 -1555.2899    0  805 -11493.321 -1555.2899  86.5%     -  808s
     0     0 -1562.7524    0  814 -11493.321 -1562.7524  86.4%     -  814s
     0     0 -1575.0476    0  828 -11493.321 -1575.0476  86.3%     -  822s
     0     0 -1576.9043    0  824 -11493.321 -1576.9043  86.3%     -  825s
     0     0 -1616.3701    0  716 -11493.321 -1616.3701  85.9%     -  840s
     0     0 -1642.2640    0  710 -11493.321 -1642.2640  85.7%     -  851s
     0     0 -1647.3151    0  724 -11493.321 -1647.3151  85.7%     -  857s
     0     0 -1649.0264    0  715 -11493.321 -1649.0264  85.7%     -  860s
     0     0 -1706.9597    0  702 -11493.321 -1706.9597  85.1%     -  879s
     0     0 -1717.9914    0  710 -11493.321 -1717.9914  85.1%     -  891s
     0     0 -1729.2301    0  720 -11493.321 -1729.2301  85.0%     -  903s
     0     0 -1730.2596    0  778 -11493.321 -1730.2596  84.9%     -  906s
     0     0 -1748.2977    0  842 -11493.321 -1748.2977  84.8%     -  920s
     0     0 -1751.5197    0  746 -11493.321 -1751.5197  84.8%     -  925s
     0     0 -1764.3492    0  713 -11493.321 -1764.3492  84.6%     -  938s
     0     0 -1766.6733    0  729 -11493.321 -1766.6733  84.6%     -  944s
     0     0 -1785.0932    0  886 -11493.321 -1785.0932  84.5%     -  959s
     0     0 -1789.8558    0  836 -11493.321 -1789.8558  84.4%     -  965s
     0     0 -1791.3274    0  832 -11493.321 -1791.3274  84.4%     -  968s
     0     0 -1811.1783    0  728 -11493.321 -1811.1783  84.2%     -  980s
     0     0 -1811.1794    0  728 -11493.321 -1811.1794  84.2%     -  987s
     0     2 -1811.1796    0  728 -11493.321 -1811.1796  84.2%     - 1258s
     1     3 -2460.1975    1  634 -11493.321 -1811.1796  84.2% 12313 1281s
     2     4 -1911.3383    1  786 -11493.321 -1911.3383  83.4% 11714 1300s
     3     6 -2754.6937    2  689 -11493.321 -1911.3399  83.4% 10512 1317s
     5    11 -2831.0830    3  666 -11493.321 -1911.3399  83.4% 10424 1351s
    10    19 -2872.6192    4  668 -11493.321 -1935.3805  83.2% 10804 1404s
    18    28 -11110.623    5  132 -11493.321 -1935.3805  83.2% 16861 2193s
    27    54 -3137.1623    4  745 -11493.321 -2027.3503  82.4% 21857 2350s
    53    74 -3177.8361    5  721 -11493.321 -2027.3503  82.4% 22872 2406s
    83   105 -3179.2220    6  726 -11493.321 -2027.3503  82.4% 20404 2463s
   114   153 -4628.4741    7  542 -11493.321 -2027.3503  82.4% 18673 2522s
   166   214 -4895.2502    8  500 -11493.321 -2027.3503  82.4% 15507 2561s
   227   243 -5109.2306   12  396 -11493.321 -2027.3503  82.4% 12809 2615s
   256   289 -5121.4401   13  393 -11493.321 -2027.3503  82.4% 12573 2704s
   302   338 -5161.8225   14  315 -11493.321 -2027.3503  82.4% 11994 2739s
   361   384 -5302.1422   15  489 -11493.321 -2027.3503  82.4% 11393 2774s
   416   437 -7052.7999   16  411 -11493.321 -2027.3503  82.4% 10794 2805s
   482   488 -7122.2838   17  416 -11493.321 -2027.3503  82.4% 10610 2836s
   567   528 -7384.6172   18  395 -11493.321 -2027.3503  82.4% 10085 2871s
   620   575 -7450.8166   19  404 -11493.321 -2057.4840  82.1%  9792 2897s
   696   606 -8534.6528   20  378 -11493.321 -2057.4840  82.1%  9559 2923s
   754   662 -8629.6949   21  430 -11493.321 -2057.4840  82.1%  9260 2950s
   822   738 -8792.4743   22  517 -11493.321 -2057.4840  82.1%  9046 2970s
   929   808     cutoff   23      -11493.321 -2057.4840  82.1%  8489 2995s
  1049   839 -8848.5369   24  412 -11493.321 -2057.4840  82.1%  7838 3020s
  1174   865     cutoff   25      -11493.321 -2057.4840  82.1%  7357 3044s
  1252   901 -10806.136   26  254 -11493.321 -2057.4840  82.1%  7242 3068s
  1351   955 -11059.275   27  325 -11493.321 -2057.4840  82.1%  7061 3098s
  1452   976 infeasible   28      -11493.321 -2057.4840  82.1%  6913 3126s
  1575  1006 infeasible   29      -11493.321 -2057.4840  82.1%  6654 3157s
  1683  1059 infeasible   28      -11493.321 -2079.8195  81.9%  6463 3190s
  1792  1068 -11248.315   29  188 -11493.321 -2079.8195  81.9%  6262 3217s
  1906  1092 -11413.628   30  167 -11493.321 -2079.8195  81.9%  6112 3251s
  1975  1111 infeasible   31      -11493.321 -2079.8195  81.9%  6124 3284s
  2006  1156 -4551.5466   17  611 -11493.321 -2079.8195  81.9%  6224 3321s
  2102  1185 -9516.3341   17  311 -11493.321 -2079.8195  81.9%  6169 3361s
  2199  1221 -5671.1282   18  477 -11493.321 -2079.8195  81.9%  6142 3396s
  2311  1302 -5845.2414   19  569 -11493.321 -2845.1497  75.2%  6094 3434s
  2436  1409 -6011.5506   20  583 -11493.321 -2845.1497  75.2%  6026 3475s
  2606  1467 -6176.6756   21  556 -11493.321 -2845.1497  75.2%  5925 3520s
  2759  1564 -7112.5731   24  397 -11493.321 -2845.1497  75.2%  5919 3565s
  2964  1590 -8881.5398   26  292 -11493.321 -2845.1497  75.2%  5852 3600s

Cutting planes:
  Learned: 2
  Implied bound: 280
  MIR: 4884
  Flow cover: 4009
  Zero half: 12
  RLT: 288
  Relax-and-lift: 1174

Explored 3110 nodes (19078325 simplex iterations) in 3600.07 seconds (7874.17 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11493.3 -11540.5 -12251.7 ... -15874.9

Time limit reached
Best objective -1.149332107382e+04, best bound -2.845149714932e+03, gap 75.2452%
  WARNING: Time limit reached. Using best solution found (gap: 75.25%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -11493.32, θ = 116382.22
  Upper Bound (UB) = -11493.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116382.22
  [DEBUG]   ✓ Scenario 0: θ = 116382.22 ≤ Q = 116382.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116382.22 ≤ Q = 116382.22 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 116382.22 ≤ Q = 116382.22 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2a823d3a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2a823d3a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.324640e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6966214.1032
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.204282e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120428.23    0  122 6966214.10 -120428.23   102%     -    0s
H    0     0                    -85876.04419 -120428.23  40.2%     -    0s
H    0     0                    -86405.39818 -120428.23  39.4%     -    0s
     0     0 -92647.397    0   76 -86405.398 -92647.397  7.22%     -    0s
H    0     0                    -90160.74229 -92618.588  2.73%     -    0s
     0     0 -92219.722    0   80 -90160.742 -92219.722  2.28%     -    0s
     0     0 -92207.213    0   78 -90160.742 -92207.213  2.27%     -    0s
H    0     0                    -91110.71218 -92207.213  1.20%     -    0s
H    0     0                    -91156.74554 -92207.213  1.15%     -    0s
     0     0 -92079.424    0   77 -91156.746 -92079.424  1.01%     -    0s
     0     0 -92078.228    0   77 -91156.746 -92078.228  1.01%     -    0s
H    0     0                    -91472.09175 -92077.914  0.66%     -    0s
H    0     0                    -91628.95062 -92077.914  0.49%     -    0s
     0     0 -92077.914    0   79 -91628.951 -92077.914  0.49%     -    0s
     0     0 -92077.914    0   68 -91628.951 -92077.914  0.49%     -    0s
     0     0 -91974.640    0   52 -91628.951 -91974.640  0.38%     -    0s
     0     0 -91972.774    0   51 -91628.951 -91972.774  0.38%     -    0s
     0     0 -91970.530    0   51 -91628.951 -91970.530  0.37%     -    0s
     0     0 -91825.831    0   44 -91628.951 -91825.831  0.21%     -    0s
H    0     0                    -91773.31131 -91824.508  0.06%     -    0s
H    0     0                    -91803.48019 -91824.508  0.02%     -    0s
     0     0 -91813.947    0   10 -91803.480 -91813.947  0.01%     -    0s
     0     0 -91811.297    0    6 -91803.480 -91811.297  0.01%     -    0s
     0     0     cutoff    0      -91803.480 -91803.480  0.00%     -    0s

Cutting planes:
  Gomory: 30
  Implied bound: 3
  MIR: 75
  Flow cover: 10
  RLT: 5
  Relax-and-lift: 2

Explored 1 nodes (988 simplex iterations) in 0.07 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -91803.5 -91773.3 -91629 ... 1.32464e+13
No other solutions better than -91803.5

Optimal solution found (tolerance 1.00e-06)
Best objective -9.180348019045e+04, best bound -9.180348019045e+04, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 113618.23
  Scenario: 8 demand increases, 52 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -91803.48
  [DEBUG]   S×d_nominal = 205421.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205421.71 + -91803.48 = 113618.23
  [DEBUG]   Current θ from Master = 116382.22
  [DEBUG]   ⚠️  Z_SP ≤ θ by 2763.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -14257.31
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1525.3928, Absolute Gap = 1525.3928, Relative Gap = 0.132720
  Not converged yet (gap = 1525.39 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 8 increases, 52 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524435 nonzeros
Model fingerprint: 0x82d38c48
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 80132 rows and 32542 columns
Presolve time: 1.55s
Presolved: 104731 rows, 44598 columns, 632459 nonzeros
Variable types: 42339 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -384568.2121
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.20s

Barrier statistics:
 Dense cols : 650
 AA' NZ     : 3.614e+06
 Factor NZ  : 8.663e+06 (roughly 130 MB of memory)
 Factor Ops : 1.650e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66521838e+07  1.72637406e+08  8.70e+04 1.97e+01  6.86e+04     3s
   1  -1.25451345e+07  1.49878988e+08  5.98e+04 5.77e+01  4.67e+04     3s
   2  -4.16705915e+06  1.19137288e+08  1.93e+04 2.02e+00  1.60e+04     3s
   3  -9.55401907e+05  9.13612798e+07  2.41e+03 1.92e-01  2.35e+03     3s
   4  -4.81668780e+05  3.63494352e+07  3.19e+02 5.30e-01  4.12e+02     3s
   5  -3.99984808e+05  2.39703314e+07  1.65e+02 1.92e-01  2.31e+02     3s
   6  -2.73150850e+05  1.63910963e+07  4.55e+01 1.17e-02  1.12e+02     3s
   7  -1.77221387e+05  1.20574065e+07  1.45e+01 8.19e-03  7.05e+01     3s
   8  -1.16776470e+05  6.68543674e+06  6.87e+00 4.25e-03  3.75e+01     3s
   9  -8.63074850e+04  4.21583670e+06  4.22e+00 2.61e-03  2.33e+01     3s
  10  -7.01913636e+04  1.23598353e+06  2.98e+00 6.90e-04  7.03e+00     3s
  11  -3.62404695e+04  3.99922863e+05  1.71e+00 2.16e-04  2.32e+00     3s
  12  -2.16205630e+04  1.37566915e+05  9.07e-01 1.37e-04  8.40e-01     3s
  13  -1.36394337e+04  8.88954323e+04  6.03e-01 2.04e-04  5.39e-01     3s
  14  -9.45014304e+03  6.21518258e+04  4.75e-01 1.54e-04  3.76e-01     3s
  15  -4.51527510e+03  4.84235243e+04  3.49e-01 6.09e-04  2.78e-01     4s
  16   3.14288353e+02  3.90257991e+04  2.51e-01 9.33e-04  2.03e-01     4s
  17   3.27813153e+03  3.30279269e+04  1.95e-01 1.49e-03  1.56e-01     4s
  18   4.50916334e+03  2.60528116e+04  1.71e-01 1.23e-03  1.13e-01     4s
  19   6.61699058e+03  2.37229739e+04  1.36e-01 1.02e-03  8.97e-02     4s
  20   7.93398445e+03  2.05690183e+04  1.12e-01 9.93e-04  6.63e-02     4s
  21   9.78316870e+03  1.90673153e+04  8.09e-02 1.18e-03  4.87e-02     4s
  22   1.06421592e+04  1.80048665e+04  6.62e-02 1.75e-03  3.86e-02     4s
  23   1.12857950e+04  1.72891162e+04  5.48e-02 1.26e-03  3.15e-02     4s
  24   1.18276779e+04  1.65795336e+04  4.60e-02 1.39e-03  2.49e-02     4s
  25   1.22889655e+04  1.61409557e+04  3.86e-02 1.62e-03  2.02e-02     4s
  26   1.29665362e+04  1.57234691e+04  2.79e-02 9.23e-04  1.45e-02     4s
  27   1.35080298e+04  1.55439085e+04  1.94e-02 7.85e-04  1.07e-02     4s
  28   1.37807904e+04  1.52819811e+04  1.52e-02 4.22e-04  7.87e-03     4s
  29   1.38847599e+04  1.52099005e+04  1.37e-02 3.35e-04  6.95e-03     4s
  30   1.41381874e+04  1.51210921e+04  9.94e-03 3.32e-04  5.15e-03     4s
  31   1.42723464e+04  1.50386801e+04  7.99e-03 4.19e-04  4.02e-03     4s
  32   1.43961855e+04  1.49867049e+04  6.11e-03 4.64e-04  3.10e-03     4s
  33   1.45696313e+04  1.49200049e+04  3.64e-03 3.20e-04  1.84e-03     5s
  34   1.46557794e+04  1.48989024e+04  2.41e-03 2.42e-04  1.27e-03     5s
  35   1.46602015e+04  1.48937514e+04  2.35e-03 2.25e-04  1.22e-03     5s
  36   1.46682034e+04  1.48905732e+04  2.23e-03 2.15e-04  1.17e-03     5s
  37   1.47128820e+04  1.48627017e+04  1.60e-03 1.27e-04  7.85e-04     5s
  38   1.47917854e+04  1.48531823e+04  4.52e-04 9.92e-05  3.21e-04     5s
  39   1.48116440e+04  1.48287408e+04  1.86e-04 3.91e-05  8.96e-05     5s
  40   1.48247811e+04  1.48283451e+04  2.02e-05 3.22e-05  1.86e-05     5s
  41   1.48262136e+04  1.48267557e+04  3.02e-06 3.53e-06  2.83e-06     5s
  42   1.48265015e+04  1.48265061e+04  1.31e-08 2.99e-07  2.42e-08     5s
  43   1.48265033e+04  1.48265033e+04  1.15e-10 9.84e-11  4.80e-12     5s

Barrier solved model in 43 iterations and 5.07 seconds (7.87 work units)
Optimal objective 1.48265033e+04


Root crossover log...

   75270 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    4885 PPushes remaining with PInf 1.8752519e-06                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.2455072e-11      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33187    1.4826503e+04   0.000000e+00   0.000000e+00      7s
   33187    1.4826503e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.09s

Solved with barrier

Root relaxation: objective 1.482650e+04, 33187 iterations, 5.11 seconds (10.15 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 14826.5033    0  599 -190756.93 14826.5033   108%     -    7s
H    0     0                    -184317.8478 14826.5033   108%     -    7s
H    0     0                    -150534.8324 14826.5033   110%     -    7s
H    0     0                    -137829.5402 14826.5033   111%     -    8s
H    0     0                    -122574.9149 14826.5033   112%     -    8s
H    0     0                    -120331.9958 14826.5033   112%     -    8s
H    0     0                    -120080.4740 14826.5033   112%     -    8s
H    0     0                    -120066.1495 14826.5033   112%     -    8s
H    0     0                    -106459.1465 14826.5033   114%     -    8s
H    0     0                    -71103.07232 14826.5033   121%     -    8s
H    0     0                    -68279.79915 14826.5033   122%     -    8s
H    0     0                    -60733.75959 14826.5033   124%     -    8s
H    0     0                    -60725.00749 14826.5033   124%     -    8s
H    0     0                    -57939.54396 14826.5033   126%     -   11s
H    0     0                    -57164.17594 14826.5033   126%     -   11s
H    0     0                    -57122.77686 14826.5033   126%     -   11s
H    0     0                    -56696.94880 10077.8320   118%     -   60s
H    0     0                    -47393.52446 10077.8320   121%     -   60s
H    0     0                    -45844.68773 10077.8320   122%     -   60s
H    0     0                    -45816.42029 10077.8320   122%     -   60s
H    0     0                    -45776.46091 10077.8320   122%     -   60s
     0     0 10077.8320    0  827 -45776.461 10077.8320   122%     -   60s
H    0     0                    -45702.28723 10076.4075   122%     -   61s
H    0     0                    -45658.76745 10076.4075   122%     -   61s
     0     0 9391.51228    0  836 -45658.767 9391.51228   121%     -   81s
     0     0 9332.20775    0  824 -45658.767 9332.20775   120%     -   87s
     0     0 9331.84265    0  829 -45658.767 9331.84265   120%     -   90s
     0     0 9331.84265    0  827 -45658.767 9331.84265   120%     -   92s
H    0     0                    -44868.21859 6854.47334   115%     -  142s
H    0     0                    -43794.02934 6854.47334   116%     -  142s
     0     0 6769.36400    0  896 -43794.029 6769.36400   115%     -  142s
H    0     0                    -36409.57858 6769.36400   119%     -  143s
H    0     0                    -34441.32324 6769.36400   120%     -  143s
H    0     0                    -34397.80346 6769.36400   120%     -  143s
H    0     0                    -34242.06987 6769.36400   120%     -  143s
H    0     0                    -34231.04171 6769.36400   120%     -  143s
H    0     0                    -34121.39862 5440.26209   116%     -  207s
H    0     0                    -34096.88027 5440.26209   116%     -  207s
H    0     0                    -33879.92549 5440.26209   116%     -  207s
H    0     0                    -33679.17955 5440.26209   116%     -  207s
H    0     0                    -33670.31388 5440.26209   116%     -  207s
H    0     0                    -18261.45892 5440.26209   130%     -  207s
H    0     0                    -18123.18780 5440.26209   130%     -  207s
H    0     0                    -18121.92736 5440.26209   130%     -  207s
     0     0 5440.26209    0  882 -18121.927 5440.26209   130%     -  207s
H    0     0                    -17983.32324 5109.91706   128%     -  230s
H    0     0                    -17982.56497 5109.91706   128%     -  230s
H    0     0                    -17939.80346 5109.91706   128%     -  230s
H    0     0                    -17939.04519 5109.91706   128%     -  230s
H    0     0                    -17937.05053 5109.91706   128%     -  230s
H    0     0                    -17936.29226 5109.91706   128%     -  230s
H    0     0                    -17935.61082 5109.91706   128%     -  230s
H    0     0                    -17934.85256 5109.91706   128%     -  230s
H    0     0                    -17891.24691 5109.91706   129%     -  230s
H    0     0                    -17890.48864 5109.91706   129%     -  230s
H    0     0                    -17878.59792 5109.91706   129%     -  230s
     0     0 5109.91706    0  812 -17878.598 5109.91706   129%     -  230s
     0     0 4898.27524    0  871 -17878.598 4898.27524   127%     -  246s
     0     0 4837.15214    0  869 -17878.598 4837.15214   127%     -  258s
     0     0 4791.82633    0  876 -17878.598 4791.82633   127%     -  270s
     0     0 4737.71593    0  866 -17878.598 4737.71593   126%     -  283s
     0     0 4670.35159    0  874 -17878.598 4670.35159   126%     -  294s
     0     0 4626.10382    0  871 -17878.598 4626.10382   126%     -  302s
     0     0 4610.53176    0  844 -17878.598 4610.53176   126%     -  311s
     0     0 4604.87684    0  793 -17878.598 4604.87684   126%     -  316s
     0     0 4601.21770    0  796 -17878.598 4601.21770   126%     -  320s
     0     0 4599.50924    0  802 -17878.598 4599.50924   126%     -  324s
     0     0 4578.05829    0  854 -17878.598 4578.05829   126%     -  332s
     0     0 4555.59256    0  836 -17878.598 4555.59256   125%     -  340s
     0     0 4555.22359    0  847 -17878.598 4555.22359   125%     -  342s
H    0     0                    -17465.36780 2017.32655   112%     -  431s
H    0     0                    -17434.83557 2017.32655   112%     -  431s
H    0     0                    -17294.66022 2017.32655   112%     -  431s
H    0     0                    -17274.39576 2017.32655   112%     -  431s
H    0     0                    -17218.72798 2017.32655   112%     -  431s
H    0     0                    -17014.35040 2017.32655   112%     -  431s
H    0     0                    -17005.07444 2017.32655   112%     -  431s
H    0     0                    -16800.73328 2017.32655   112%     -  431s
H    0     0                    -15917.13752 2017.32655   113%     -  431s
H    0     0                    -15435.14153 2017.32655   113%     -  431s
     0     0 2017.32655    0  719 -15435.142 2017.32655   113%     -  431s
H    0     0                    -14083.35073 2016.56684   114%     -  431s
     0     0 1308.70867    0  768 -14083.351 1308.70867   109%     -  486s
     0     0 1072.24100    0  856 -14083.351 1072.24100   108%     -  519s
     0     0  954.71110    0  786 -14083.351  954.71110   107%     -  537s
     0     0  896.81827    0  864 -14083.351  896.81827   106%     -  554s
     0     0  867.51293    0  787 -14083.351  867.51293   106%     -  568s
     0     0  799.02793    0  762 -14083.351  799.02793   106%     -  583s
     0     0  772.67449    0  788 -14083.351  772.67449   105%     -  592s
     0     0  765.54758    0  767 -14083.351  765.54758   105%     -  596s
     0     0  763.29340    0  781 -14083.351  763.29340   105%     -  598s
H    0     0                    -13694.30367 -309.13977  97.7%     -  666s
H    0     0                    -12643.47674 -309.13977  97.6%     -  666s
H    0     0                    -12617.97371 -309.13977  97.6%     -  666s
H    0     0                    -12612.29756 -309.13977  97.5%     -  666s
H    0     0                    -12597.82271 -309.13977  97.5%     -  666s
H    0     0                    -12545.67831 -309.13977  97.5%     -  666s
H    0     0                    -12533.98550 -309.13977  97.5%     -  666s
H    0     0                    -12528.94465 -309.13977  97.5%     -  666s
H    0     0                    -12528.93166 -309.13977  97.5%     -  666s
H    0     0                    -12514.76714 -309.13977  97.5%     -  666s
H    0     0                    -12509.72629 -309.13977  97.5%     -  666s
     0     0 -309.13977    0  743 -12509.726 -309.13977  97.5%     -  666s
     0     0 -566.15804    0  753 -12509.726 -566.15804  95.5%     -  703s
H    0     0                    -12483.25843 -705.67093  94.3%     -  728s
     0     0 -705.67093    0  691 -12483.258 -705.67093  94.3%     -  728s
     0     0 -774.44986    0  778 -12483.258 -774.44986  93.8%     -  747s
     0     0 -835.32679    0  781 -12483.258 -835.32679  93.3%     -  765s
     0     0 -855.53632    0  703 -12483.258 -855.53632  93.1%     -  778s
     0     0 -880.02423    0  713 -12483.258 -880.02423  93.0%     -  792s
     0     0 -899.50485    0  699 -12483.258 -899.50485  92.8%     -  804s
     0     0 -961.25295    0  779 -12483.258 -961.25295  92.3%     -  826s
     0     0 -973.88762    0  783 -12483.258 -973.88762  92.2%     -  834s
     0     0 -978.61830    0  790 -12483.258 -978.61830  92.2%     -  836s
     0     0 -979.88425    0  787 -12483.258 -979.88425  92.2%     -  839s
     0     0 -1280.4660    0  810 -12483.258 -1280.4660  89.7%     -  882s
     0     0 -1333.7977    0  747 -12483.258 -1333.7977  89.3%     -  906s
     0     0 -1347.8784    0  777 -12483.258 -1347.8784  89.2%     -  921s
     0     0 -1358.6385    0  781 -12483.258 -1358.6385  89.1%     -  933s
     0     0 -1387.4985    0  719 -12483.258 -1387.4985  88.9%     -  951s
     0     0 -1391.6883    0  768 -12483.258 -1391.6883  88.9%     -  959s
     0     0 -1401.8239    0  788 -12483.258 -1401.8239  88.8%     -  966s
     0     0 -1407.9142    0  723 -12483.258 -1407.9142  88.7%     -  973s
     0     0 -1429.5106    0  785 -12483.258 -1429.5106  88.5%     -  987s
     0     0 -1432.0718    0  799 -12483.258 -1432.0718  88.5%     -  993s
     0     0 -1518.0873    0  730 -12483.258 -1518.0873  87.8%     - 1022s
H    0     0                    -12459.07321 -1518.0880  87.8%     - 1024s
     0     0 -1537.1494    0  693 -12459.073 -1537.1494  87.7%     - 1040s
     0     0 -1547.0997    0  691 -12459.073 -1547.0997  87.6%     - 1053s
     0     0 -1550.3733    0  689 -12459.073 -1550.3733  87.6%     - 1057s
     0     0 -1610.9357    0  705 -12459.073 -1610.9357  87.1%     - 1078s
     0     0 -1643.5550    0  709 -12459.073 -1643.5550  86.8%     - 1100s
     0     0 -1656.9255    0  768 -12459.073 -1656.9255  86.7%     - 1114s
     0     0 -1663.0010    0  706 -12459.073 -1663.0010  86.7%     - 1123s
     0     0 -1665.1692    0  714 -12459.073 -1665.1692  86.6%     - 1127s
     0     0 -1700.6014    0  783 -12459.073 -1700.6014  86.4%     - 1151s
     0     0 -1709.2276    0  721 -12459.073 -1709.2276  86.3%     - 1160s
     0     0 -1710.7085    0  724 -12459.073 -1710.7085  86.3%     - 1164s
     0     0 -1722.4408    0  731 -12459.073 -1722.4408  86.2%     - 1175s
     0     0 -1729.1634    0  739 -12459.073 -1729.1634  86.1%     - 1185s
     0     0 -1731.0899    0  734 -12459.073 -1731.0899  86.1%     - 1192s
     0     0 -1743.1220    0  744 -12459.073 -1743.1220  86.0%     - 1203s
     0     0 -1743.1457    0  744 -12459.073 -1743.1457  86.0%     - 1211s
H    0     0                    -12148.30682 -1743.1457  85.7%     - 1311s
H    0     0                    -12125.15435 -1743.1457  85.6%     - 1311s
H    0     0                    -12102.80884 -1743.1457  85.6%     - 1311s
H    0     0                    -12080.79546 -1743.1457  85.6%     - 1313s
H    0     0                    -12056.69301 -1743.1457  85.5%     - 1313s
H    0     0                    -12052.18675 -1743.1457  85.5%     - 1314s
H    0     0                    -12043.31180 -1743.1457  85.5%     - 1314s
H    0     0                    -12016.93428 -1743.1457  85.5%     - 1314s
H    0     0                    -11998.88605 -1743.1457  85.5%     - 1318s
H    0     0                    -11989.72650 -1743.1457  85.5%     - 1318s
H    0     0                    -11939.29326 -1743.1457  85.4%     - 1318s
H    0     2                    -11885.46177 -1743.1457  85.3%     - 1331s
     0     2 -1743.1457    0  744 -11885.462 -1743.1457  85.3%     - 1331s
     1     3 -1925.1618    1  700 -11885.462 -1743.1509  85.3% 23720 1374s
     2     5 -2457.3755    2  709 -11885.462 -1743.1509  85.3% 20062 1411s
     4    10 -2170.7526    2  724 -11885.462 -1841.4354  84.5% 16427 1444s
     9    20 -2677.0517    3  761 -11885.462 -1906.2802  84.0% 13683 1522s
    19    40 -2773.1010    4  758 -11885.462 -2088.3448  82.4% 17333 1591s
    39    52 -3385.2656    5  700 -11885.462 -2109.7108  82.2% 18977 1717s
    51    76 -3626.1382    6  645 -11885.462 -2109.7108  82.2% 26499 1793s
H   55    76                    -11877.82809 -2109.7108  82.2% 25547 1793s
H   56    76                    -11769.33373 -2109.7108  82.1% 25251 1793s
    75   204 -3688.0815    7  634 -11769.334 -2109.7108  82.1% 22118 1864s
H  203   262                    -11756.81068 -2109.7108  82.1% 13633 1897s
H  207   262                    -11751.78959 -2109.7108  82.0% 13457 1897s
H  210   262                    -11751.72649 -2109.7108  82.0% 13290 1897s
   263   335 -3923.7282   14  621 -11751.726 -2109.7108  82.0% 11503 1932s
   336   394 -4558.0563   15  589 -11751.726 -2109.7108  82.0% 10054 1961s
   399   429 -4724.8276   16  586 -11751.726 -2109.7108  82.0%  9186 1992s
   457   447 -6417.0499   17  176 -11751.726 -2109.7108  82.0%  8534 2016s
   491   471 -10524.922   22   97 -11751.726 -2109.7108  82.0%  8338 2042s
   529   483 -6511.0727   18  176 -11751.726 -2109.7108  82.0%  8124 2070s
   584   506 -11489.042   25   70 -11751.726 -2109.7108  82.0%  7676 2099s
   649   528 -11126.464   26  180 -11751.726 -2109.7108  82.0%  7223 2122s
H  686   528                    -11751.39567 -2109.7108  82.0%  6996 2122s
   708   563 -11254.529   12  319 -11751.396 -2109.7108  82.0%  6845 2155s
   790   568 -11438.193   13  300 -11751.396 -2109.7108  82.0%  6352 2178s
   839   593 infeasible   14      -11751.396 -2109.7108  82.0%  6170 2203s
   922   603 -4406.8551   12  623 -11751.396 -2109.7108  82.0%  5847 2231s
   972   644 -11053.473   30  145 -11751.396 -2109.7108  82.0%  5715 2256s
  1062   708 -9602.3761   17  612 -11751.396 -2109.7108  82.0%  5379 2281s
  1188   725 infeasible   35      -11751.396 -2109.7108  82.0%  4966 2305s
  1320   734     cutoff   17      -11751.396 -2109.7108  82.0%  4614 2336s
  1413   764     cutoff   19      -11751.396 -2109.7108  82.0%  4407 2360s
  1519   778 -7816.8918   13  544 -11751.396 -2109.7108  82.0%  4225 2393s
  1587   805 -7923.4000   14  533 -11751.396 -2109.7108  82.0%  4181 2424s
  1671   836 -8280.6513   16  402 -11751.396 -2109.7108  82.0%  4145 2460s
  1747   865 -8523.8024   19  402 -11751.396 -2109.7108  82.0%  4096 2493s
  1816   885 -8654.2726   20  356 -11751.396 -2109.7108  82.0%  4032 2526s
  1914   892 -9384.4931   23  629 -11751.396 -2109.7108  82.0%  3933 2569s
  2009   925 infeasible   24      -11751.396 -2109.7108  82.0%  3897 2610s
  2080   976 -6656.3740   10  481 -11751.396 -2109.7108  82.0%  3939 2650s
  2169  1011 -9304.9304   11  312 -11751.396 -2109.7108  82.0%  3968 2690s
  2232  1053 infeasible   12      -11751.396 -2109.7108  82.0%  3960 2732s
  2346  1098 -11307.917   15  359 -11751.396 -2109.7108  82.0%  3954 2779s
  2455  1160 infeasible   16      -11751.396 -2412.1273  79.5%  3950 2830s
  2586  1228 infeasible   16      -11751.396 -2412.1273  79.5%  3923 2881s
  2720  1263 -6212.7655    7  724 -11751.396 -2412.1273  79.5%  3925 2932s
  2830  1337 -6414.1176    8  348 -11751.396 -2412.1273  79.5%  3951 2988s
  3002  1369 -8828.6984   11  577 -11751.396 -2412.1273  79.5%  3892 3048s
  3115  1456 -9778.9837   12  591 -11751.396 -2412.1273  79.5%  3914 3110s
  3326  1505 -11480.291   13  725 -11751.396 -2412.1273  79.5%  3838 3169s
  3472  1593 infeasible   14      -11751.396 -2735.7009  76.7%  3852 3228s
  3647  1710 -3249.8832    7  688 -11751.396 -2735.7009  76.7%  3852 3290s
  3842  1849 -5620.9848    9  610 -11751.396 -2735.7009  76.7%  3859 3356s
  4102  1886 -6509.5254   11  630 -11751.396 -2984.6345  74.6%  3790 3412s
  4195  2010 -6942.4228   12  621 -11751.396 -2984.6345  74.6%  3790 3482s

Cutting planes:
  Learned: 3
  Implied bound: 280
  MIR: 5665
  Flow cover: 4428
  Zero half: 9
  RLT: 293
  Relax-and-lift: 2007

Explored 4402 nodes (17516970 simplex iterations) in 3600.03 seconds (8276.30 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11751.4 -11751.7 -11751.8 ... -11998.9

Time limit reached
Best objective -1.175139567460e+04, best bound -2.984634477678e+03, gap 74.6019%
  WARNING: Time limit reached. Using best solution found (gap: 74.60%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = -11751.40, θ = 111424.13
  Upper Bound (UB) = -11751.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 111424.13
  [DEBUG]   ✓ Scenario 0: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 111424.13 ≤ Q = 111427.57 (slack: 3.43)
  [DEBUG]   ✓ Scenario 4: θ = 111424.13 ≤ Q = 111424.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 111424.13 ≤ Q = 111424.13 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 111424.13 ≤ Q = 111424.13 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6f4f9592
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x90b06a6e
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.173143e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6114028.5165
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.171624e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -117162.42    0  122 6114028.52 -117162.42   102%     -    0s
H    0     0                    -82799.68199 -117162.42  41.5%     -    0s
H    0     0                    -83889.73148 -117162.42  39.7%     -    0s
     0     0 -95603.642    0   89 -83889.731 -95603.642  14.0%     -    0s
H    0     0                    -93161.32587 -95602.439  2.62%     -    0s
H    0     0                    -93624.27191 -95602.439  2.11%     -    0s
     0     0 -94980.132    0   91 -93624.272 -94980.132  1.45%     -    0s
H    0     0                    -93891.57339 -94912.572  1.09%     -    0s
     0     0 -94642.588    0   74 -93891.573 -94642.588  0.80%     -    0s
     0     0 -94536.764    0   74 -93891.573 -94536.764  0.69%     -    0s
     0     0 -94510.605    0   70 -93891.573 -94510.605  0.66%     -    0s
     0     0 -94502.923    0   70 -93891.573 -94502.923  0.65%     -    0s
     0     0 -94240.340    0   31 -93891.573 -94240.340  0.37%     -    0s
     0     0 -94237.301    0   30 -93891.573 -94237.301  0.37%     -    0s
     0     0 -94126.907    0   29 -93891.573 -94126.907  0.25%     -    0s
     0     0 -94108.443    0   25 -93891.573 -94108.443  0.23%     -    0s
     0     0 -94049.380    0   16 -93891.573 -94049.380  0.17%     -    0s
     0     0 -94049.380    0   27 -93891.573 -94049.380  0.17%     -    0s
     0     0 -94049.380    0   27 -93891.573 -94049.380  0.17%     -    0s
     0     0 -94049.380    0   26 -93891.573 -94049.380  0.17%     -    0s
     0     0 -94002.741    0    7 -93891.573 -94002.741  0.12%     -    0s
     0     0 -93916.863    0    8 -93891.573 -93916.863  0.03%     -    0s
     0     0 -93913.946    0    7 -93891.573 -93913.946  0.02%     -    0s
H    0     0                    -93910.60522 -93913.946  0.00%     -    0s
     0     0     cutoff    0      -93910.605 -93910.605  0.00%     -    0s

Cutting planes:
  Gomory: 10
  Implied bound: 2
  MIR: 6
  Flow cover: 9
  RLT: 3
  Relax-and-lift: 2

Explored 1 nodes (969 simplex iterations) in 0.06 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -93910.6 -93891.6 -93838.8 ... 1.17314e+13
No other solutions better than -93910.6

Optimal solution found (tolerance 1.00e-06)
Best objective -9.391060521535e+04, best bound -9.391060521535e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 103436.49
  Scenario: 37 demand increases, 23 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -93910.61
  [DEBUG]   S×d_nominal = 197347.10
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 197347.10 + -93910.61 = 103436.49
  [DEBUG]   Current θ from Master = 111424.13
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7987.64 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -19739.04
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1267.3182, Absolute Gap = 1267.3182, Relative Gap = 0.107844
  Not converged yet (gap = 1267.32 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 37 increases, 23 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567678 nonzeros
Model fingerprint: 0x6cd00349
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 86798 rows and 35248 columns
Presolve time: 1.73s
Presolved: 113355 rows, 48132 columns, 683595 nonzeros
Variable types: 45873 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -384568.2121
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 642
 AA' NZ     : 4.172e+06
 Factor NZ  : 1.091e+07 (roughly 150 MB of memory)
 Factor Ops : 3.460e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66945027e+07  1.85826626e+08  8.71e+04 1.86e+01  6.84e+04     3s
   1  -1.26067817e+07  1.61563806e+08  6.00e+04 5.49e+01  4.67e+04     3s
   2  -4.94184081e+06  1.28643892e+08  2.31e+04 3.23e+00  1.90e+04     3s
   3  -8.71686869e+05  9.21866390e+07  1.78e+03 1.29e+00  1.82e+03     3s
   4  -5.05830303e+05  4.97527382e+07  3.58e+02 5.41e-01  4.92e+02     3s
   5  -4.28760354e+05  2.90625702e+07  1.71e+02 2.73e-01  2.49e+02     3s
   6  -3.63781631e+05  2.05604962e+07  8.41e+01 1.78e-01  1.48e+02     3s
   7  -2.06326554e+05  1.79328168e+07  8.42e+00 1.51e-01  9.19e+01     4s
   8  -1.44556350e+05  9.92261307e+06  2.08e+00 8.13e-02  4.92e+01     4s
   9  -1.07566728e+05  5.98415441e+06  1.28e+00 4.82e-02  2.96e+01     4s
  10  -7.04891630e+04  3.14034704e+06  6.58e-01 2.46e-02  1.56e+01     4s
  11  -4.92482845e+04  9.04029805e+05  3.65e-01 6.43e-03  4.61e+00     4s
  12  -2.75029269e+04  3.85080473e+05  1.87e-01 2.46e-03  1.99e+00     4s
  13  -1.57036157e+04  2.08569053e+05  9.83e-02 1.38e-03  1.08e+00     4s
  14  -1.10323103e+04  1.26049443e+05  7.10e-02 1.19e-03  6.61e-01     4s
  15  -8.00007680e+03  9.56492946e+04  5.69e-02 9.62e-04  5.00e-01     4s
  16  -3.11174444e+03  6.37426574e+04  4.10e-02 7.98e-04  3.23e-01     4s
  17  -1.04172262e+03  5.18245435e+04  3.52e-02 8.74e-04  2.55e-01     4s
  18   2.47156873e+03  4.31082709e+04  2.66e-02 1.02e-03  1.96e-01     4s
  19   5.47631566e+03  3.31591584e+04  1.97e-02 6.72e-04  1.34e-01     4s
  20   6.57475402e+03  3.01304460e+04  1.71e-02 5.68e-04  1.14e-01     4s
  21   7.08464949e+03  2.86357882e+04  1.61e-02 5.13e-04  1.04e-01     4s
  22   8.88596898e+03  2.53138414e+04  1.21e-02 3.92e-04  7.92e-02     5s
  23   9.81337241e+03  2.16685382e+04  1.02e-02 2.79e-04  5.72e-02     5s
  24   1.09337588e+04  2.00761902e+04  7.93e-03 2.60e-04  4.41e-02     5s
  25   1.14895443e+04  1.82877772e+04  6.75e-03 1.78e-04  3.28e-02     5s
  26   1.20533738e+04  1.75390683e+04  5.61e-03 1.81e-04  2.65e-02     5s
  27   1.26588068e+04  1.70130302e+04  4.38e-03 1.36e-04  2.10e-02     5s
  28   1.31458156e+04  1.65589382e+04  3.47e-03 1.03e-04  1.65e-02     5s
  29   1.34470370e+04  1.60654673e+04  2.91e-03 7.01e-05  1.26e-02     5s
  30   1.37734774e+04  1.59045207e+04  2.34e-03 5.78e-05  1.03e-02     5s
  31   1.41166205e+04  1.56545235e+04  1.71e-03 3.94e-05  7.42e-03     5s
  32   1.42822061e+04  1.55189556e+04  1.42e-03 2.84e-05  5.97e-03     5s
  33   1.45870309e+04  1.54399872e+04  9.06e-04 2.32e-05  4.11e-03     5s
  34   1.46561838e+04  1.53754559e+04  7.77e-04 1.88e-05  3.47e-03     5s
  35   1.47242202e+04  1.53193927e+04  6.49e-04 1.47e-05  2.87e-03     6s
  36   1.48018088e+04  1.52791863e+04  5.10e-04 1.19e-05  2.30e-03     6s
  37   1.48876351e+04  1.52085022e+04  3.55e-04 6.92e-06  1.55e-03     6s
  38   1.49548585e+04  1.51889497e+04  2.42e-04 5.54e-06  1.13e-03     6s
  39   1.50035452e+04  1.51536102e+04  1.58e-04 3.24e-06  7.24e-04     6s
  40   1.50352550e+04  1.51365477e+04  1.06e-04 2.07e-06  4.89e-04     6s
  41   1.50553191e+04  1.51309700e+04  7.42e-05 1.70e-06  3.65e-04     6s
  42   1.50602901e+04  1.51261203e+04  6.66e-05 1.38e-06  3.18e-04     6s
  43   1.50678683e+04  1.51218673e+04  5.50e-05 1.10e-06  2.60e-04     6s
  44   1.50769839e+04  1.51205220e+04  4.07e-05 1.02e-06  2.10e-04     6s
  45   1.50925202e+04  1.51107106e+04  1.66e-05 4.11e-07  8.77e-05     6s
  46   1.51023493e+04  1.51076476e+04  1.95e-06 2.10e-07  2.55e-05     7s
  47   1.51037472e+04  1.51047807e+04  3.70e-07 3.74e-08  4.98e-06     7s
  48   1.51041028e+04  1.51041492e+04  1.05e-08 1.76e-09  2.23e-07     7s
  49   1.51041156e+04  1.51041161e+04  1.89e-09 6.23e-11  2.39e-09     7s
  50   1.51041158e+04  1.51041159e+04  2.97e-08 1.60e-11  4.40e-10     7s

Barrier solved model in 50 iterations and 6.82 seconds (10.81 work units)
Optimal objective 1.51041158e+04


Root crossover log...

   81445 DPushes remaining with DInf 0.0000000e+00                 7s
    2587 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

   16705 PPushes remaining with PInf 5.0828624e-05                10s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.8055757e+01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53708    1.5104116e+04   0.000000e+00   1.805576e+01     11s
   53713    1.5104116e+04   0.000000e+00   0.000000e+00     11s
   53713    1.5104116e+04   0.000000e+00   0.000000e+00     11s
Concurrent spin time: 0.84s

Solved with barrier

Root relaxation: objective 1.510412e+04, 53713 iterations, 9.69 seconds (19.39 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 15104.1159    0  599 -190756.93 15104.1159   108%     -   12s
H    0     0                    -186186.7401 15104.1159   108%     -   12s
H    0     0                    -176370.9869 15104.1159   109%     -   13s
H    0     0                    -127773.4182 15104.1159   112%     -   13s
H    0     0                    -127630.3367 15104.1159   112%     -   13s
H    0     0                    -91954.00208 15104.1159   116%     -   13s
H    0     0                    -85930.48408 15104.1159   118%     -   13s
H    0     0                    -71374.21128 15104.1159   121%     -   14s
H    0     0                    -71072.68900 15104.1159   121%     -   14s
H    0     0                    -67803.76466 10350.7396   115%     -   52s
H    0     0                    -56919.17932 10350.7396   118%     -   52s
H    0     0                    -53563.00603 10350.7396   119%     -   52s
H    0     0                    -52946.73979 10350.7396   120%     -   52s
     0     0 10350.7396    0  703 -52946.740 10350.7396   120%     -   52s
H    0     0                    -50264.38047 10349.4919   121%     -   53s
H    0     0                    -49478.35380 10349.4919   121%     -   53s
H    0     0                    -49460.64627 10349.4919   121%     -   53s
H    0     0                    -49383.75926 10349.4919   121%     -   53s
     0     0 9545.28962    0  745 -49383.759 9545.28962   119%     -   66s
     0     0 9471.89884    0  733 -49383.759 9471.89884   119%     -   75s
     0     0 9471.89884    0  733 -49383.759 9471.89884   119%     -   81s
     0     0 9471.89884    0  739 -49383.759 9471.89884   119%     -   87s
     0     0 9471.89884    0  739 -49383.759 9471.89884   119%     -   88s
     0     0 9471.89884    0  741 -49383.759 9471.89884   119%     -   89s
     0     0 9471.89884    0  742 -49383.759 9471.89884   119%     -   89s
H    0     0                    -49144.02838 6739.65303   114%     -  143s
H    0     0                    -44325.47005 6739.65303   115%     -  143s
H    0     0                    -42448.48545 6739.65303   116%     -  143s
H    0     0                    -42445.84990 6739.65303   116%     -  143s
H    0     0                    -42435.17061 6739.65303   116%     -  143s
H    0     0                    -42432.53506 6739.65303   116%     -  143s
H    0     0                    -42280.57602 6739.65303   116%     -  143s
H    0     0                    -42277.94047 6739.65303   116%     -  143s
H    0     0                    -42267.26117 6739.65303   116%     -  143s
H    0     0                    -42264.62562 6739.65303   116%     -  143s
H    0     0                    -42256.17170 6739.65303   116%     -  143s
H    0     0                    -42253.53615 6739.65303   116%     -  143s
H    0     0                    -42242.85686 6739.65303   116%     -  143s
H    0     0                    -42240.22131 6739.65303   116%     -  143s
H    0     0                    -42189.26168 6739.65303   116%     -  143s
H    0     0                    -42186.62613 6739.65303   116%     -  143s
H    0     0                    -42175.94684 6739.65303   116%     -  143s
H    0     0                    -42173.31129 6739.65303   116%     -  143s
H    0     0                    -42073.84649 6739.65303   116%     -  143s
H    0     0                    -42071.21094 6739.65303   116%     -  143s
H    0     0                    -42060.53165 6739.65303   116%     -  143s
H    0     0                    -42057.89610 6739.65303   116%     -  143s
H    0     0                    -42057.29368 6739.65303   116%     -  143s
H    0     0                    -42054.65813 6739.65303   116%     -  143s
H    0     0                    -42043.97884 6739.65303   116%     -  143s
H    0     0                    -42041.34329 6739.65303   116%     -  143s
     0     0 6739.65303    0  941 -42041.343 6739.65303   116%     -  143s
H    0     0                    -31428.91108 6739.31810   121%     -  144s
H    0     0                    -30350.50952 6739.31810   122%     -  144s
H    0     0                    -30345.99741 6739.31810   122%     -  144s
H    0     0                    -30233.49610 6739.31810   122%     -  144s
H    0     0                    -30203.59939 6739.31810   122%     -  144s
H    0     0                    -30157.02243 6739.31810   122%     -  144s
     0     0 5200.45512    0  889 -30157.022 5200.45512   117%     -  194s
     0     0 4954.58515    0  886 -30157.022 4954.58515   116%     -  217s
     0     0 4859.91069    0  879 -30157.022 4859.91069   116%     -  230s
     0     0 4817.67365    0  875 -30157.022 4817.67365   116%     -  239s
     0     0 4784.81914    0  885 -30157.022 4784.81914   116%     -  251s
     0     0 4622.26374    0  867 -30157.022 4622.26374   115%     -  263s
     0     0 4551.69416    0  868 -30157.022 4551.69416   115%     -  273s
     0     0 4543.79872    0  871 -30157.022 4543.79872   115%     -  276s
     0     0 4535.53874    0  855 -30157.022 4535.53874   115%     -  281s
     0     0 4497.75618    0  874 -30157.022 4497.75618   115%     -  288s
     0     0 4492.01792    0  869 -30157.022 4492.01792   115%     -  290s
     0     0 4489.92888    0  878 -30157.022 4489.92888   115%     -  293s
H    0     0                    -30136.77912 4450.89057   115%     -  299s
H    0     0                    -29458.86804 4450.89057   115%     -  299s
H    0     0                    -17605.09321 4450.89057   125%     -  299s
H    0     0                    -17046.94954 4450.89057   126%     -  299s
H    0     0                    -16937.20619 4450.89057   126%     -  299s
H    0     0                    -16922.49408 4450.89057   126%     -  299s
     0     0 4450.89057    0  860 -16922.494 4450.89057   126%     -  299s
     0     0 4448.92794    0  868 -16922.494 4448.92794   126%     -  301s
     0     0 4448.49453    0  866 -16922.494 4448.49453   126%     -  302s
H    0     0                    -16779.27944 1959.48209   112%     -  397s
H    0     0                    -16381.45958 1959.48209   112%     -  397s
H    0     0                    -16222.35245 1959.48209   112%     -  397s
H    0     0                    -16202.27878 1959.48209   112%     -  397s
     0     0 1959.48209    0  649 -16202.279 1959.48209   112%     -  397s
     0     0 1049.93465    0  761 -16202.279 1049.93465   106%     -  465s
     0     0  772.73318    0  747 -16202.279  772.73318   105%     -  498s
     0     0  593.96327    0  681 -16202.279  593.96327   104%     -  523s
H    0     0                    -12493.40008  534.35936   104%     -  542s
H    0     0                    -12394.19961  534.35936   104%     -  542s
     0     0  534.35936    0  721 -12394.200  534.35936   104%     -  542s
     0     0  493.45980    0  829 -12394.200  493.45980   104%     -  555s
     0     0  484.37543    0  718 -12394.200  484.37543   104%     -  562s
     0     0  455.15296    0  705 -12394.200  455.15296   104%     -  572s
     0     0  381.66133    0  761 -12394.200  381.66133   103%     -  588s
     0     0  361.92005    0  765 -12394.200  361.92005   103%     -  599s
     0     0  354.39813    0  751 -12394.200  354.39813   103%     -  604s
     0     0  348.35390    0  756 -12394.200  348.35390   103%     -  611s
     0     0  344.39875    0  773 -12394.200  344.39875   103%     -  615s
     0     0  339.65023    0  766 -12394.200  339.65023   103%     -  620s
     0     0  331.00807    0  780 -12394.200  331.00807   103%     -  625s
     0     0  320.95317    0  788 -12394.200  320.95317   103%     -  631s
     0     0  317.61149    0  786 -12394.200  317.61149   103%     -  635s
     0     0  315.86092    0  787 -12394.200  315.86092   103%     -  638s
H    0     0                    -12392.85029  315.86092   103%     -  652s
H    0     0                    -12292.44762 -703.32543  94.3%     -  723s
     0     0 -703.32543    0  677 -12292.448 -703.32543  94.3%     -  723s
     0     0 -1006.9546    0  702 -12292.448 -1006.9546  91.8%     -  759s
     0     0 -1086.5473    0  711 -12292.448 -1086.5473  91.2%     -  780s
     0     0 -1129.0040    0  714 -12292.448 -1129.0040  90.8%     -  794s
     0     0 -1165.1730    0  770 -12292.448 -1165.1730  90.5%     -  806s
     0     0 -1189.0208    0  714 -12292.448 -1189.0208  90.3%     -  817s
     0     0 -1193.8430    0  728 -12292.448 -1193.8430  90.3%     -  823s
     0     0 -1202.0258    0  721 -12292.448 -1202.0258  90.2%     -  829s
     0     0 -1205.1466    0  829 -12292.448 -1205.1466  90.2%     -  832s
     0     0 -1428.8885    0  794 -12292.448 -1428.8885  88.4%     -  862s
     0     0 -1480.6204    0  701 -12292.448 -1480.6204  88.0%     -  883s
     0     0 -1496.0518    0  706 -12292.448 -1496.0518  87.8%     -  896s
     0     0 -1506.0475    0  759 -12292.448 -1506.0475  87.7%     -  907s
     0     0 -1529.9794    0  699 -12292.448 -1529.9794  87.6%     -  924s
     0     0 -1541.6330    0  766 -12292.448 -1541.6330  87.5%     -  936s
     0     0 -1551.2663    0  768 -12292.448 -1551.2663  87.4%     -  946s
     0     0 -1553.3851    0  755 -12292.448 -1553.3851  87.4%     -  951s
     0     0 -1616.7559    0  721 -12292.448 -1616.7559  86.8%     -  977s
     0     0 -1634.2549    0  726 -12292.448 -1634.2549  86.7%     - 1011s
     0     0 -1650.6601    0  705 -12292.448 -1650.6601  86.6%     - 1023s
     0     0 -1657.0611    0  706 -12292.448 -1657.0611  86.5%     - 1032s
     0     0 -1665.7752    0  756 -12292.448 -1665.7752  86.4%     - 1043s
     0     0 -1669.3199    0  777 -12292.448 -1669.3199  86.4%     - 1050s
     0     0 -1670.4541    0  786 -12292.448 -1670.4541  86.4%     - 1054s
     0     0 -1727.6778    0  709 -12292.448 -1727.6778  85.9%     - 1083s
     0     0 -1742.5101    0  766 -12292.448 -1742.5101  85.8%     - 1096s
     0     0 -1749.7235    0  713 -12292.448 -1749.7235  85.8%     - 1103s
     0     0 -1751.7689    0  719 -12292.448 -1751.7689  85.7%     - 1108s
     0     0 -1784.5513    0  736 -12292.448 -1784.5513  85.5%     - 1127s
     0     0 -1795.8861    0  737 -12292.448 -1795.8861  85.4%     - 1140s
     0     0 -1801.7911    0  759 -12292.448 -1801.7911  85.3%     - 1150s
     0     0 -1804.9425    0  754 -12292.448 -1804.9425  85.3%     - 1158s
     0     0 -1837.9133    0  748 -12292.448 -1837.9133  85.0%     - 1179s
     0     0 -1844.2376    0  753 -12292.448 -1844.2376  85.0%     - 1187s
     0     0 -1845.5459    0  747 -12292.448 -1845.5459  85.0%     - 1191s
     0     0 -1854.5657    0  753 -12292.448 -1854.5657  84.9%     - 1205s
     0     0 -1857.9081    0  762 -12292.448 -1857.9081  84.9%     - 1212s
     0     0 -1866.8833    0  756 -12292.448 -1866.8833  84.8%     - 1223s
     0     0 -1866.9113    0  756 -12292.448 -1866.9113  84.8%     - 1232s
H    0     0                    -11915.25798 -1866.9400  84.3%     - 1370s
     0     2 -1866.9400    0  756 -11915.258 -1866.9400  84.3%     - 1373s
     1     3 -2529.0279    1  680 -11915.258 -1866.9400  84.3% 29163 1429s
     2     4 -1903.8940    1  810 -11915.258 -1903.8940  84.0% 19424 1443s
     3     7 -2940.1529    2  586 -11915.258 -1903.9528  84.0% 15583 1467s
     6    11 -3113.3894    3  577 -11915.258 -1903.9528  84.0% 13024 1512s
    10    21 -3265.6655    4  521 -11915.258 -1968.0160  83.5% 15727 1552s
    20    33 -9124.4867    5  171 -11915.258 -2108.0136  82.3% 17878 1638s
    32    65 -3367.3802    4  467 -11915.258 -2108.0136  82.3% 20542 1822s
H   34    65                    -11915.04346 -2108.0136  82.3% 19867 1822s
H   36    65                    -11819.14148 -2108.0136  82.2% 19207 1822s
H   38    65                    -11760.40583 -2108.0136  82.1% 18794 1822s
H   40    65                    -11618.50566 -2108.0136  81.9% 18923 1822s
    64    97 -3393.9899    5  452 -11618.506 -2217.6009  80.9% 24654 1951s
    96   227 -3468.7517    6  451 -11618.506 -2217.6517  80.9% 19977 2020s
H  115   227                    -11588.02169 -2217.6517  80.9% 17582 2020s
   228   269 -3797.0478   10  484 -11588.022 -2217.6517  80.9% 11997 2055s
   306   280 -5268.8699   11  398 -11588.022 -2217.6517  80.9% 10705 2085s
H  323   280                    -11587.11658 -2217.6517  80.9% 10579 2085s
   339   294 -10778.459   13  148 -11587.117 -2217.6517  80.9% 10479 2116s
   396   300 -9464.7644   13  200 -11587.117 -2217.6517  80.9% 10084 2150s
H  432   300                    -11586.90206 -2217.6517  80.9%  9927 2150s
   436   323 infeasible   14      -11586.902 -2217.6517  80.9%  9994 2183s
   493   325 -7088.8726   16  406 -11586.902 -2217.6517  80.9%  9651 2226s
H  515   325                    -11469.06179 -2217.6517  80.7%  9591 2226s
   551   323 -7189.8988   17  401 -11469.062 -2217.6517  80.7%  9108 2257s
   603   338 -8552.4826   18  273 -11469.062 -2217.6517  80.7%  9109 2314s
   636   340 -9010.6462   19  348 -11469.062 -2217.6517  80.7%  9264 2351s
   687   355 -9349.8036   20  192 -11469.062 -2217.6517  80.7%  9173 2382s
   718   395 -10022.548   21  360 -11469.062 -2217.6517  80.7%  9275 2461s
   781   404 -10105.168   22  358 -11469.062 -2217.6517  80.7%  9234 2486s
   816   424 -10196.012   23  358 -11469.062 -2217.6517  80.7%  9322 2513s
   880   461 infeasible   26      -11469.062 -2217.6517  80.7%  9177 2542s
   957   491 -9090.5424   29  458 -11469.062 -2217.6517  80.7%  9041 2572s
  1066   519 -9422.8184   31  451 -11469.062 -2217.6517  80.7%  8601 2603s
  1191   548     cutoff   31      -11469.062 -2217.6517  80.7%  8119 2635s
  1289   577 infeasible   32      -11469.062 -2217.6517  80.7%  7891 2668s
  1396   601 -10261.249   36  424 -11469.062 -2217.6517  80.7%  7686 2708s
  1488   628 -10548.827   39  437 -11469.062 -2217.6517  80.7%  7503 2746s
  1579   627 infeasible   43      -11469.062 -2217.6517  80.7%  7489 2784s
  1622   655 -10765.880   44  375 -11469.062 -2217.6517  80.7%  7466 2824s
  1670   663 -10899.782   46  360 -11469.062 -2217.6517  80.7%  7475 2861s
  1702   686 -11089.852   47  287 -11469.062 -2217.6517  80.7%  7489 2903s
  1741   709 infeasible   45      -11469.062 -2217.6517  80.7%  7573 2947s
  1808   716 -11277.130   49  353 -11469.062 -2217.6517  80.7%  7566 2984s
  1887   778 infeasible   50      -11469.062 -2455.4729  78.6%  7518 3029s
  2017   802 -11397.439   52  392 -11469.062 -2455.4729  78.6%  7345 3081s
  2126   848 -9182.1896   13  391 -11469.062 -2455.4729  78.6%  7356 3126s
  2236   908 -9361.3939   14  382 -11469.062 -2455.4729  78.6%  7399 3170s
  2370   990 infeasible   15      -11469.062 -2455.4729  78.6%  7325 3220s
  2524  1088 -9720.1231   23  386 -11469.062 -2455.4729  78.6%  7310 3270s
  2718  1135 -10939.639   27  283 -11469.062 -2455.4729  78.6%  7157 3325s
  2892  1179 -4132.6965    9  428 -11469.062 -2694.5959  76.5%  7093 3381s
  3062  1265 infeasible   14      -11469.062 -2694.5959  76.5%  7029 3443s
  3243  1321 -6485.3660   10  617 -11469.062 -2694.5959  76.5%  7030 3507s
  3381  1369 infeasible   11      -11469.062 -2694.5959  76.5%  7085 3569s
  3536  1388 infeasible   10      -11469.062 -3350.0356  70.8%  7117 3600s

Cutting planes:
  Learned: 3
  Implied bound: 382
  MIR: 6487
  Flow cover: 4867
  Zero half: 7
  RLT: 367
  Relax-and-lift: 1763

Explored 3603 nodes (26774130 simplex iterations) in 3600.09 seconds (8632.86 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11469.1 -11586.9 -11587.1 ... -12292.4

Time limit reached
Best objective -1.146906179467e+04, best bound -3.350035641102e+03, gap 70.7907%
  WARNING: Time limit reached. Using best solution found (gap: 70.79%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -11469.06, θ = 110810.74
  Upper Bound (UB) = -11469.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 110810.74
  [DEBUG]   ✓ Scenario 0: θ = 110810.74 ≤ Q = 110810.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 110810.74 ≤ Q = 110810.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 110810.74 ≤ Q = 110810.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 110810.74 ≤ Q = 110810.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 110810.74 ≤ Q = 110810.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 110810.74 ≤ Q = 110810.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 110810.74 ≤ Q = 110810.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 110810.74 ≤ Q = 110810.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 110810.74 ≤ Q = 110810.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 110810.74 ≤ Q = 110810.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 110810.74 ≤ Q = 110810.74 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 110810.74 ≤ Q = 110810.74 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 110810.74 ≤ Q = 110810.74 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7202ebf0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8dfd1410
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.338774e+13
Presolve removed 2578 rows and 1871 columns
Presolve time: 0.00s
Presolved: 515 rows, 518 columns, 1452 nonzeros
Found heuristic solution: objective 6966872.0385
Variable types: 350 continuous, 168 integer (168 binary)

Root relaxation: objective -1.235930e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -123593.04    0  124 6966872.04 -123593.04   102%     -    0s
H    0     0                    -89031.54915 -123593.04  38.8%     -    0s
H    0     0                    -89271.58548 -123593.04  38.4%     -    0s
     0     0 -105619.89    0  106 -89271.585 -105619.89  18.3%     -    0s
H    0     0                    -102999.3250 -105541.79  2.47%     -    0s
H    0     0                    -103791.7917 -105150.41  1.31%     -    0s
     0     0 -105150.41    0  106 -103791.79 -105150.41  1.31%     -    0s
H    0     0                    -104049.3440 -105104.42  1.01%     -    0s
     0     0 -105104.42    0  106 -104049.34 -105104.42  1.01%     -    0s
     0     0 -104655.59    0   57 -104049.34 -104655.59  0.58%     -    0s
     0     0 -104526.28    0   51 -104049.34 -104526.28  0.46%     -    0s
     0     0 -104505.99    0   41 -104049.34 -104505.99  0.44%     -    0s
     0     0 -104500.17    0   44 -104049.34 -104500.17  0.43%     -    0s
     0     0 -104334.26    0   21 -104049.34 -104334.26  0.27%     -    0s
     0     0 -104314.41    0   21 -104049.34 -104314.41  0.25%     -    0s
     0     0 -104307.03    0   19 -104049.34 -104307.03  0.25%     -    0s
     0     0 -104261.68    0   18 -104049.34 -104261.68  0.20%     -    0s
     0     0 -104240.40    0   19 -104049.34 -104240.40  0.18%     -    0s
     0     0 -104230.90    0   18 -104049.34 -104230.90  0.17%     -    0s
     0     0 -104230.90    0   27 -104049.34 -104230.90  0.17%     -    0s
     0     0 -104230.90    0   27 -104049.34 -104230.90  0.17%     -    0s
     0     0 -104230.90    0   26 -104049.34 -104230.90  0.17%     -    0s
     0     0 -104165.40    0    9 -104049.34 -104165.40  0.11%     -    0s
     0     0 -104131.91    0    8 -104049.34 -104131.91  0.08%     -    0s
H    0     0                    -104050.3917 -104118.01  0.06%     -    0s
     0     0 -104118.01    0    8 -104050.39 -104118.01  0.06%     -    0s
     0     0 -104117.51    0    4 -104050.39 -104117.51  0.06%     -    0s
     0     0 -104117.08    0    2 -104050.39 -104117.08  0.06%     -    0s
H    0     0                    -104117.0530 -104117.05  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 3
  MIR: 6
  Flow cover: 14
  RLT: 2
  Relax-and-lift: 4

Explored 1 nodes (966 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104117 -104050 -104049 ... 1.33877e+13
No other solutions better than -104117

Optimal solution found (tolerance 1.00e-06)
Best objective -1.041170530275e+05, best bound -1.041170530275e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 98531.42
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104117.05
  [DEBUG]   S×d_nominal = 202648.47
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202648.47 + -104117.05 = 98531.42
  [DEBUG]   Current θ from Master = 110810.74
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12279.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -23748.39
  Lower Bound (LB) = -13018.71
  Gap (UB-LB) = 1549.6521, Absolute Gap = 1549.6521, Relative Gap = 0.135116
  Not converged yet (gap = 1549.65 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610921 nonzeros
Model fingerprint: 0x886e2230
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 93464 rows and 37954 columns
Presolve time: 2.08s
Presolved: 121979 rows, 51666 columns, 751069 nonzeros
Variable types: 49407 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383863.9713
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.28s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 5.148e+06
 Factor NZ  : 1.177e+07 (roughly 170 MB of memory)
 Factor Ops : 2.530e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66347366e+07  1.96141402e+08  8.79e+04 1.83e+01  6.77e+04     4s
   1  -1.26620212e+07  1.70370316e+08  6.15e+04 4.92e+01  4.69e+04     4s
   2  -5.15694975e+06  1.35977667e+08  2.42e+04 6.16e+00  1.95e+04     4s
   3  -8.26538897e+05  9.48734806e+07  1.66e+03 1.30e+00  1.68e+03     4s
   4  -5.07201040e+05  4.34500252e+07  3.74e+02 4.21e-01  4.51e+02     4s
   5  -4.16145872e+05  2.93272627e+07  1.66e+02 2.47e-01  2.37e+02     4s
   6  -3.52632717e+05  2.16542254e+07  7.52e+01 1.71e-01  1.42e+02     4s
   7  -2.24971806e+05  1.67698047e+07  1.17e+01 1.25e-01  8.21e+01     4s
   8  -1.41620018e+05  9.48992408e+06  1.46e+00 7.13e-02  4.37e+01     4s
   9  -1.20628706e+05  4.03514635e+06  9.94e-01 3.02e-02  1.88e+01     4s
  10  -8.80418805e+04  2.20471747e+06  4.85e-01 1.62e-02  1.03e+01     4s
  11  -7.12389945e+04  1.33605435e+06  2.86e-01 9.79e-03  6.33e+00     4s
  12  -4.57104430e+04  3.00154771e+05  9.77e-02 1.98e-03  1.55e+00     4s
  13  -2.25996441e+04  1.49759139e+05  4.25e-02 6.82e-04  7.74e-01     4s
  14  -1.75475859e+04  9.89766013e+04  3.47e-02 7.05e-04  5.23e-01     4s
  15  -1.26847822e+04  7.51716881e+04  2.85e-02 1.02e-03  3.94e-01     5s
  16  -7.97591398e+03  5.66600811e+04  2.26e-02 1.29e-03  2.90e-01     5s
  17  -5.93328380e+03  4.99564844e+04  1.99e-02 1.09e-03  2.51e-01     5s
  18  -2.01036959e+03  3.79439997e+04  1.50e-02 7.88e-04  1.79e-01     5s
  19   8.83627894e+02  2.98939531e+04  1.13e-02 5.46e-04  1.30e-01     5s
  20   2.00645020e+03  2.24171447e+04  9.93e-03 3.35e-04  9.16e-02     5s
  21   4.44786174e+03  1.81621248e+04  7.09e-03 2.13e-04  6.16e-02     5s
  22   5.64839866e+03  1.65975818e+04  5.76e-03 1.65e-04  4.92e-02     5s
  23   6.84037143e+03  1.47833899e+04  4.48e-03 1.09e-04  3.57e-02     5s
  24   7.39642438e+03  1.39216732e+04  3.90e-03 8.22e-05  2.93e-02     5s
  25   7.90115454e+03  1.33650958e+04  3.36e-03 6.56e-05  2.45e-02     5s
  26   8.64721498e+03  1.28080111e+04  2.57e-03 4.86e-05  1.87e-02     6s
  27   9.11141177e+03  1.22428276e+04  2.08e-03 5.44e-05  1.41e-02     6s
  28   9.54448265e+03  1.20530615e+04  1.63e-03 4.54e-05  1.13e-02     6s
  29   9.77304079e+03  1.18052358e+04  1.41e-03 3.15e-05  9.13e-03     6s
  30   1.01304200e+04  1.16333218e+04  1.04e-03 2.25e-05  6.75e-03     6s
  31   1.02284871e+04  1.15388248e+04  9.34e-04 2.03e-05  5.88e-03     6s
  32   1.06745523e+04  1.15056603e+04  4.89e-04 1.84e-05  3.73e-03     6s
  33   1.07947823e+04  1.13765627e+04  3.64e-04 1.13e-05  2.61e-03     6s
  34   1.09398844e+04  1.12947242e+04  2.19e-04 6.67e-06  1.59e-03     6s
  35   1.10492791e+04  1.12418367e+04  1.13e-04 3.52e-06  8.65e-04     6s
  36   1.10896397e+04  1.12122098e+04  7.36e-05 1.87e-06  5.50e-04     7s
  37   1.10987484e+04  1.12023118e+04  6.56e-05 1.76e-06  4.65e-04     7s
  38   1.11375368e+04  1.11855786e+04  3.06e-05 1.54e-06  2.16e-04     7s
  39   1.11691911e+04  1.11756409e+04  3.53e-06 1.79e-06  2.90e-05     7s
  40   1.11710647e+04  1.11739215e+04  1.99e-06 2.56e-07  1.28e-05     7s
  41   1.11730709e+04  1.11738261e+04  3.05e-07 1.79e-07  3.39e-06     7s
  42   1.11734626e+04  1.11735145e+04  3.53e-08 3.24e-08  2.34e-07     7s
  43   1.11735110e+04  1.11735110e+04  1.30e-09 4.93e-09  1.85e-10     7s

Barrier solved model in 43 iterations and 7.11 seconds (10.98 work units)
Optimal objective 1.11735110e+04


Root crossover log...

   91492 DPushes remaining with DInf 0.0000000e+00                 7s
   13410 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

   10011 PPushes remaining with PInf 3.1541316e-05                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.8852653e+00     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   52130    1.1173511e+04   0.000000e+00   2.885265e+00     12s
   52133    1.1173511e+04   0.000000e+00   0.000000e+00     12s
   52133    1.1173511e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.97s

Solved with barrier

Root relaxation: objective 1.117351e+04, 52133 iterations, 10.30 seconds (21.09 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11173.5110    0  520 -190756.93 11173.5110   106%     -   13s
H    0     0                    -186186.7401 11173.5110   106%     -   13s
H    0     0                    -120386.4433 11173.5110   109%     -   14s
H    0     0                    -108328.9218 11173.5110   110%     -   14s
H    0     0                    -106351.3188 11173.5110   111%     -   14s
H    0     0                    -106120.5566 11173.5110   111%     -   14s
H    0     0                    -105749.9363 11173.5110   111%     -   14s
H    0     0                    -105068.3945 11173.5110   111%     -   15s
H    0     0                    -105020.7817 11173.5110   111%     -   15s
H    0     0                    -80818.81113 11173.5110   114%     -   17s
H    0     0                    -69347.78275 11173.5110   116%     -   17s
     0     0 5024.82100    0  553 -69347.783 5024.82100   107%     -   68s
H    0     0                    -69053.95156 5024.25100   107%     -   69s
     0     0 4736.65663    0  581 -69053.952 4736.65663   107%     -   81s
     0     0 4710.74088    0  576 -69053.952 4710.74088   107%     -   86s
     0     0 4619.69102    0  567 -69053.952 4619.69102   107%     -   95s
     0     0 4567.92892    0  628 -69053.952 4567.92892   107%     -  106s
     0     0 4553.51141    0  586 -69053.952 4553.51141   107%     -  110s
     0     0 4550.96755    0  590 -69053.952 4550.96755   107%     -  112s
     0     0 4550.96755    0  588 -69053.952 4550.96755   107%     -  116s
     0     0 4550.96755    0  637 -69053.952 4550.96755   107%     -  127s
     0     0 4550.96755    0  592 -69053.952 4550.96755   107%     -  131s
     0     0 4550.96755    0  595 -69053.952 4550.96755   107%     -  135s
     0     0 4550.96755    0  595 -69053.952 4550.96755   107%     -  137s
     0     0 4550.96755    0  594 -69053.952 4550.96755   107%     -  138s
     0     0 4550.96755    0  598 -69053.952 4550.96755   107%     -  141s
     0     0 4550.96755    0  593 -69053.952 4550.96755   107%     -  142s
     0     0 4550.45892    0  599 -69053.952 4550.45892   107%     -  143s
     0     0 4550.42684    0  597 -69053.952 4550.42684   107%     -  144s
H    0     0                    -68480.72117 2260.26235   103%     -  223s
H    0     0                    -68399.12838 2260.26235   103%     -  223s
     0     0 2260.26235    0  665 -68399.128 2260.26235   103%     -  223s
H    0     0                    -59304.39473 2259.96525   104%     -  223s
H    0     0                    -58961.48225 2259.96525   104%     -  223s
H    0     0                    -58952.05157 2259.96525   104%     -  223s
     0     0 2106.05972    0  674 -58952.052 2106.05972   104%     -  242s
     0     0 2062.26512    0  681 -58952.052 2062.26512   103%     -  254s
     0     0 2055.49830    0  685 -58952.052 2055.49830   103%     -  259s
     0     0 1878.58810    0  677 -58952.052 1878.58810   103%     -  280s
     0     0 1870.09567    0  688 -58952.052 1870.09567   103%     -  288s
     0     0 1869.15710    0  682 -58952.052 1869.15710   103%     -  290s
     0     0  730.05087    0  625 -58952.052  730.05087   101%     -  387s
H    0     0                    -58915.08793  730.02407   101%     -  387s
     0     0  506.08554    0  626 -58915.088  506.08554   101%     -  408s
     0     0  414.28208    0  622 -58915.088  414.28208   101%     -  424s
H    0     0                    -57385.54188  336.09145   101%     -  437s
H    0     0                    -57365.88230  336.09145   101%     -  437s
H    0     0                    -53711.19834  336.09145   101%     -  437s
     0     0  336.09145    0  614 -53711.198  336.09145   101%     -  437s
     0     0  317.63086    0  670 -53711.198  317.63086   101%     -  446s
H    0     0                    -28014.89882  275.55460   101%     -  458s
H    0     0                    -28012.26327  275.55460   101%     -  458s
     0     0  275.55460    0  608 -28012.263  275.55460   101%     -  458s
     0     0  258.44966    0  627 -28012.263  258.44966   101%     -  467s
     0     0  250.83915    0  629 -28012.263  250.83915   101%     -  471s
     0     0  159.87118    0  635 -28012.263  159.87118   101%     -  488s
     0     0  154.91200    0  640 -28012.263  154.91200   101%     -  495s
     0     0  142.70349    0  637 -28012.263  142.70349   101%     -  502s
     0     0  139.61867    0  643 -28012.263  139.61867   100%     -  505s
     0     0  134.51373    0  616 -28012.263  134.51373   100%     -  508s
H    0     0                    -27888.28546  132.93312   100%     -  510s
H    0     0                    -27882.92086  132.93312   100%     -  510s
     0     0  132.93312    0  626 -27882.921  132.93312   100%     -  510s
H    0     0                    -17136.89899  132.93312   101%     -  532s
H    0     0                    -16221.94524 -421.17872  97.4%     -  583s
H    0     0                    -16197.12075 -421.17872  97.4%     -  583s
H    0     0                    -15825.65239 -421.17872  97.3%     -  583s
H    0     0                    -15811.31887 -421.17872  97.3%     -  583s
H    0     0                    -15809.90584 -421.17872  97.3%     -  583s
     0     0 -421.17872    0  649 -15809.906 -421.17872  97.3%     -  584s
H    0     0                    -15772.94220 -421.20363  97.3%     -  584s
     0     0 -771.61137    0  647 -15772.942 -771.61137  95.1%     -  632s
H    0     0                    -15706.02144 -884.60862  94.4%     -  660s
H    0     0                    -14076.07209 -884.60862  93.7%     -  660s
     0     0 -884.60862    0  642 -14076.072 -884.60862  93.7%     -  661s
H    0     0                    -14020.68660 -918.98854  93.4%     -  681s
H    0     0                    -13930.21540 -918.98854  93.4%     -  681s
H    0     0                    -13251.87599 -918.98854  93.1%     -  681s
H    0     0                    -13251.00687 -918.98854  93.1%     -  681s
H    0     0                    -13249.24044 -918.98854  93.1%     -  681s
H    0     0                    -13248.37132 -918.98854  93.1%     -  681s
H    0     0                    -13214.68664 -918.98854  93.0%     -  681s
H    0     0                    -13189.05494 -918.98854  93.0%     -  681s
H    0     0                    -13169.49332 -918.98854  93.0%     -  681s
H    0     0                    -13164.67011 -918.98854  93.0%     -  681s
H    0     0                    -13154.17575 -918.98854  93.0%     -  681s
H    0     0                    -13151.82209 -918.98854  93.0%     -  681s
     0     0 -918.98854    0  651 -13151.822 -918.98854  93.0%     -  681s
H    0     0                    -13135.40181 -936.48096  92.9%     -  701s
H    0     0                    -13134.53269 -936.48096  92.9%     -  701s
H    0     0                    -12676.53579 -936.48096  92.6%     -  701s
H    0     0                    -12464.89829 -936.48096  92.5%     -  701s
     0     0 -936.48096    0  653 -12464.898 -936.48096  92.5%     -  701s
     0     0 -946.34728    0  661 -12464.898 -946.34728  92.4%     -  711s
     0     0 -953.64873    0  663 -12464.898 -953.64873  92.3%     -  717s
     0     0 -957.39560    0  728 -12464.898 -957.39560  92.3%     -  725s
     0     0 -961.49504    0  725 -12464.898 -961.49504  92.3%     -  730s
     0     0 -983.17986    0  712 -12464.898 -983.17986  92.1%     -  740s
     0     0 -985.07772    0  710 -12464.898 -985.07772  92.1%     -  744s
     0     0 -986.95389    0  711 -12464.898 -986.95389  92.1%     -  746s
     0     0 -1132.1683    0  812 -12464.898 -1132.1683  90.9%     -  782s
H    0     0                    -12438.95912 -1162.9273  90.7%     -  798s
H    0     0                    -12438.16330 -1162.9273  90.7%     -  798s
H    0     0                    -12432.12024 -1162.9273  90.6%     -  798s
H    0     0                    -12422.04880 -1162.9273  90.6%     -  798s
H    0     0                    -12399.61349 -1162.9273  90.6%     -  798s
H    0     0                    -12081.99314 -1162.9273  90.4%     -  798s
     0     0 -1162.9273    0  811 -12081.993 -1162.9273  90.4%     -  798s
H    0     0                    -12059.55783 -1173.6809  90.3%     -  807s
H    0     0                    -12040.74367 -1173.6809  90.3%     -  807s
     0     0 -1173.6809    0  810 -12040.744 -1173.6809  90.3%     -  807s
H    0     0                    -12037.32258 -1175.8656  90.2%     -  811s
H    0     0                    -12027.25114 -1175.8656  90.2%     -  811s
     0     0 -1175.8656    0  818 -12027.251 -1175.8656  90.2%     -  811s
     0     0 -1183.7521    0  815 -12027.251 -1183.7521  90.2%     -  816s
     0     0 -1188.9845    0  880 -12027.251 -1188.9845  90.1%     -  821s
     0     0 -1190.5260    0  823 -12027.251 -1190.5260  90.1%     -  823s
     0     0 -1307.5023    0  696 -12027.251 -1307.5023  89.1%     -  848s
H    0     0                    -11947.67719 -1307.5677  89.1%     -  850s
H    0     0                    -11891.92185 -1307.5677  89.0%     -  850s
     0     0 -1331.8398    0  716 -11891.922 -1331.8398  88.8%     -  866s
     0     0 -1345.2300    0  747 -11891.922 -1345.2300  88.7%     -  878s
     0     0 -1348.6895    0  749 -11891.922 -1348.6895  88.7%     -  884s
     0     0 -1349.3842    0  675 -11891.922 -1349.3842  88.7%     -  887s
     0     0 -1389.6576    0  669 -11891.922 -1389.6576  88.3%     -  908s
H    0     0                    -11833.32487 -1389.7109  88.3%     -  909s
     0     0 -1405.5358    0  681 -11833.325 -1405.5358  88.1%     -  924s
     0     0 -1414.5714    0  674 -11833.325 -1414.5714  88.0%     -  934s
     0     0 -1418.7389    0  678 -11833.325 -1418.7389  88.0%     -  941s
     0     0 -1420.6701    0  684 -11833.325 -1420.6701  88.0%     -  945s
     0     0 -1472.8092    0  666 -11833.325 -1472.8092  87.6%     -  969s
H    0     0                    -11799.41810 -1472.8513  87.5%     -  970s
H    0     0                    -11788.10437 -1472.8513  87.5%     -  970s
H    0     0                    -11778.73314 -1472.8513  87.5%     -  970s
H    0     0                    -11775.11199 -1472.8513  87.5%     -  970s
H    0     0                    -11774.24287 -1472.8513  87.5%     -  970s
H    0     0                    -11761.01434 -1472.8513  87.5%     -  970s
H    0     0                    -11760.14522 -1472.8513  87.5%     -  970s
     0     0 -1488.4361    0  672 -11760.145 -1488.4361  87.3%     -  982s
     0     0 -1494.4794    0  762 -11760.145 -1494.4794  87.3%     -  993s
     0     0 -1498.8453    0  777 -11760.145 -1498.8453  87.3%     - 1002s
     0     0 -1503.3139    0  674 -11760.145 -1503.3139  87.2%     - 1006s
     0     0 -1505.0477    0  676 -11760.145 -1505.0477  87.2%     - 1009s
     0     0 -1522.0968    0  697 -11760.145 -1522.0968  87.1%     - 1023s
     0     0 -1526.9897    0  786 -11760.145 -1526.9897  87.0%     - 1033s
     0     0 -1528.2570    0  786 -11760.145 -1528.2570  87.0%     - 1037s
     0     0 -1536.3188    0  688 -11760.145 -1536.3188  86.9%     - 1047s
H    0     0                    -11729.40033 -1536.3877  86.9%     - 1048s
H    0     0                    -11702.88607 -1536.3877  86.9%     - 1048s
H    0     0                    -11701.33447 -1536.3877  86.9%     - 1048s
H    0     0                    -11672.96166 -1536.3877  86.8%     - 1048s
H    0     0                    -11672.09254 -1536.3877  86.8%     - 1048s
     0     0 -1540.4967    0  711 -11672.093 -1540.4967  86.8%     - 1056s
     0     0 -1541.6249    0  701 -11672.093 -1541.6249  86.8%     - 1060s
     0     0 -1567.4218    0  689 -11672.093 -1567.4218  86.6%     - 1078s
     0     0 -1571.1019    0  691 -11672.093 -1571.1019  86.5%     - 1084s
     0     0 -1571.8086    0  691 -11672.093 -1571.8086  86.5%     - 1086s
     0     0 -1585.0771    0  690 -11672.093 -1585.0771  86.4%     - 1099s
     0     0 -1588.0399    0  773 -11672.093 -1588.0399  86.4%     - 1111s
     0     0 -1588.4705    0  687 -11672.093 -1588.4705  86.4%     - 1113s
     0     0 -1630.9366    0  697 -11672.093 -1630.9366  86.0%     - 1140s
     0     0 -1640.7281    0  740 -11672.093 -1640.7281  85.9%     - 1155s
     0     0 -1645.5395    0  785 -11672.093 -1645.5395  85.9%     - 1163s
     0     0 -1650.4117    0  825 -11672.093 -1650.4117  85.9%     - 1170s
     0     0 -1652.1810    0  780 -11672.093 -1652.1810  85.8%     - 1174s
     0     0 -1663.8923    0  702 -11672.093 -1663.8923  85.7%     - 1189s
     0     0 -1667.6394    0  780 -11672.093 -1667.6394  85.7%     - 1197s
     0     0 -1669.5190    0  698 -11672.093 -1669.5190  85.7%     - 1203s
     0     0 -1698.0568    0  741 -11672.093 -1698.0568  85.5%     - 1224s
     0     0 -1704.8631    0  762 -11672.093 -1704.8631  85.4%     - 1233s
     0     0 -1707.4899    0  768 -11672.093 -1707.4899  85.4%     - 1239s
     0     0 -1708.0671    0  766 -11672.093 -1708.0671  85.4%     - 1241s
     0     0 -1712.6377    0  710 -11672.093 -1712.6377  85.3%     - 1247s
     0     0 -1714.0636    0  768 -11672.093 -1714.0636  85.3%     - 1253s
     0     0 -1717.3231    0  719 -11672.093 -1717.3231  85.3%     - 1260s
     0     0 -1717.3607    0  719 -11672.093 -1717.3607  85.3%     - 1269s
H    0     0                    -11639.42028 -1717.3607  85.2%     - 1417s
H    0     0                    -11636.78473 -1717.3607  85.2%     - 1418s
H    0     0                    -11622.71581 -1717.3607  85.2%     - 1418s
H    0     0                    -11613.78858 -1717.3607  85.2%     - 1418s
H    0     0                    -11611.22633 -1717.3607  85.2%     - 1418s
H    0     0                    -11598.74905 -1717.3607  85.2%     - 1418s
H    0     0                    -11595.31768 -1717.3607  85.2%     - 1418s
     0     2 -1717.3607    0  719 -11595.318 -1717.3607  85.2%     - 1421s
     1     3 -2614.4093    1  576 -11595.318 -1717.3607  85.2% 16519 1452s
     2     4 -1812.2459    1  738 -11595.318 -1812.2459  84.4% 10109 1463s
     3     5 -3027.5849    2  610 -11595.318 -1812.8382  84.4%  8954 1480s
     4     8 -2064.0031    2  739 -11595.318 -1814.0278  84.4%  9390 1502s
     7    15 -2178.9257    3  814 -11595.318 -1814.0278  84.4%  9045 1538s
    14    29 -2274.9920    4  716 -11595.318 -2064.0907  82.2% 10694 1592s
    28    45 -5784.5510    5  141 -11595.318 -2180.1250  81.2% 15756 1687s
    44    76 -4740.8996    5  410 -11595.318 -2275.1201  80.4% 16672 1740s
H   45    76                    -11594.44856 -2275.1201  80.4% 16302 1740s
H   53    76                    -11581.47998 -2275.1201  80.4% 15357 1740s
    75   181 -3901.7430    6  608 -11581.480 -2275.1201  80.4% 13412 1816s
   192   237 -4223.8179    7  569 -11581.480 -2275.1201  80.4%  7578 1856s
   278   271 -7068.5392   12  256 -11581.480 -2275.1201  80.4%  6463 1885s
   371   264 infeasible   15      -11581.480 -2275.1201  80.4%  5570 1914s
   428   290 -11312.041   15   36 -11581.480 -2275.1201  80.4%  5201 1937s
   485   305 infeasible   13      -11581.480 -2275.1201  80.4%  4996 1964s
   557   316 -8906.7709   29  276 -11581.480 -2275.1201  80.4%  4656 1987s
   627   348 -9322.5034   31  257 -11581.480 -2275.1201  80.4%  4431 2009s
   687   375 infeasible   35      -11581.480 -2275.1201  80.4%  4314 2032s
   744   418 -10110.543   36  275 -11581.480 -2275.1201  80.4%  4182 2055s
   815   459 -10369.866   41  206 -11581.480 -2275.1201  80.4%  3964 2076s
   916   470     cutoff   44      -11581.480 -2275.1201  80.4%  3687 2097s
  1006   479 -9849.5336   10   88 -11581.480 -2275.1201  80.4%  3520 2117s
  1091   471 -7518.7104    8  276 -11581.480 -2275.1201  80.4%  3392 2140s
  1171   480 -7655.3553    9  347 -11581.480 -2275.1201  80.4%  3296 2165s
  1210   503 -11493.591   10   82 -11581.480 -2275.1201  80.4%  3318 2188s
  1257   537 -9940.2345   11  155 -11581.480 -2275.1201  80.4%  3345 2218s
  1317   572 infeasible   13      -11581.480 -2275.1201  80.4%  3342 2243s
  1394   620 -8889.2379   13  224 -11581.480 -2275.1201  80.4%  3313 2272s
  1484   640 -8933.9099   15  216 -11581.480 -2275.1201  80.4%  3252 2300s
  1521   674 -9230.3040   16  211 -11581.480 -2275.1201  80.4%  3298 2328s
  1585   727 -9445.4053   17  197 -11581.480 -2275.1201  80.4%  3253 2357s
  1677   805 -9458.9555   18  196 -11581.480 -2275.1201  80.4%  3213 2385s
  1801   842 infeasible   20      -11581.480 -2275.1201  80.4%  3120 2417s
  1969   857 -10851.233   25  233 -11581.480 -2275.1201  80.4%  3046 2450s
  2062   852 infeasible   26      -11581.480 -2275.1201  80.4%  3057 2491s
  2125   882 -8182.9868   13  502 -11581.480 -2275.1201  80.4%  3113 2527s
  2212   921 -9892.3818   16  309 -11581.480 -2275.1201  80.4%  3138 2565s
  2307   933 -11328.423   22  143 -11581.480 -2275.1201  80.4%  3158 2606s
  2471   965     cutoff   25      -11581.480 -2275.5823  80.4%  3123 2651s
  2565   984 -10017.550   14  108 -11581.480 -2275.5823  80.4%  3178 2697s
  2684  1003 -9931.8271    8  256 -11581.480 -2275.5823  80.4%  3193 2743s
  2773  1015 -10614.462   10  225 -11581.480 -2275.5823  80.4%  3240 2793s
  2897  1053 infeasible   10      -11581.480 -2275.5823  80.4%  3269 2842s
  2998  1100 infeasible   12      -11581.480 -2275.5823  80.4%  3313 2892s
  3156  1141 -8298.9378   11  137 -11581.480 -2275.5823  80.4%  3317 2950s
  3270  1180     cutoff   12      -11581.480 -2275.5823  80.4%  3371 3008s
  3373  1238 -10442.654   14   75 -11581.480 -2275.5823  80.4%  3435 3061s
  3493  1311 -11504.822   32   21 -11581.480 -2275.5823  80.4%  3429 3115s
  3704  1321     cutoff   44      -11581.480 -2275.5823  80.4%  3380 3177s
  3824  1367 -8069.9290   10  434 -11581.480 -2275.5823  80.4%  3425 3248s
  3930  1443 -9005.6557   14  493 -11581.480 -2275.5823  80.4%  3487 3306s
  4059  1503 -9297.9851   17  492 -11581.480 -2275.5823  80.4%  3539 3374s
  4237  1584 -10164.613   21  396 -11581.480 -3430.3779  70.4%  3555 3442s
  4406  1688 -11055.294   27  338 -11581.480 -3430.4300  70.4%  3580 3513s
  4626  1721 -6861.9857   13  350 -11581.480 -3430.4300  70.4%  3584 3582s
  4805  1743 -7540.3011   16  417 -11581.480 -3430.4300  70.4%  3585 3600s

Cutting planes:
  Learned: 2
  Implied bound: 173
  MIR: 4040
  Flow cover: 4845
  Zero half: 25
  RLT: 156
  Relax-and-lift: 573

Explored 4865 nodes (18194671 simplex iterations) in 3600.08 seconds (7963.20 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11581.5 -11594.4 -11595.3 ... -11672.1

Time limit reached
Best objective -1.158147997846e+04, best bound -3.430430002345e+03, gap 70.3800%
  WARNING: Time limit reached. Using best solution found (gap: 70.38%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.11s
  Master Objective (UB) = -11581.48, θ = 116580.31
  Upper Bound (UB) = -11581.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116580.31
  [DEBUG]   ✓ Scenario 0: θ = 116580.31 ≤ Q = 116580.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116580.31 ≤ Q = 116580.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116580.31 ≤ Q = 116580.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116580.31 ≤ Q = 116580.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 116580.31 ≤ Q = 116580.31 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 116580.31 ≤ Q = 116580.31 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7c10f49a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7c10f49a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.330069e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.00s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 7014840.7473
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.202055e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120205.46    0  122 7014840.75 -120205.46   102%     -    0s
H    0     0                    -85677.95626 -120205.46  40.3%     -    0s
H    0     0                    -86207.31025 -120205.46  39.4%     -    0s
     0     0 -89796.024    0   39 -86207.310 -89796.024  4.16%     -    0s
H    0     0                    -88566.93957 -89754.638  1.34%     -    0s
H    0     0                    -88578.88845 -89754.638  1.33%     -    0s
H    0     0                    -88835.15594 -89754.638  1.04%     -    0s
H    0     0                    -88847.10481 -89754.638  1.02%     -    0s
     0     0 -89570.537    0   40 -88847.105 -89570.537  0.81%     -    0s
H    0     0                    -89103.28686 -89538.972  0.49%     -    0s
H    0     0                    -89130.22755 -89538.972  0.46%     -    0s
     0     0 -89490.601    0   41 -89130.228 -89490.601  0.40%     -    0s
     0     0 -89467.118    0   41 -89130.228 -89467.118  0.38%     -    0s
     0     0 -89467.118    0   61 -89130.228 -89467.118  0.38%     -    0s
     0     0 -89467.118    0   37 -89130.228 -89467.118  0.38%     -    0s
     0     0 -89463.605    0   38 -89130.228 -89463.605  0.37%     -    0s
     0     0 -89461.527    0   38 -89130.228 -89461.527  0.37%     -    0s
     0     0 -89422.473    0   37 -89130.228 -89422.473  0.33%     -    0s
H    0     0                    -89178.99907 -89419.784  0.27%     -    0s
     0     0 -89419.784    0   37 -89178.999 -89419.784  0.27%     -    0s
     0     0 -89409.270    0   37 -89178.999 -89409.270  0.26%     -    0s
     0     0 -89403.347    0   37 -89178.999 -89403.347  0.25%     -    0s
     0     2 -89401.305    0   37 -89178.999 -89401.305  0.25%     -    0s
H    4     4                    -89189.72018 -89356.609  0.19%   9.8    0s
H   33     6                    -89215.01610 -89274.432  0.07%   6.0    0s
H   48     8                    -89231.01831 -89265.289  0.04%   5.0    0s

Cutting planes:
  Gomory: 8
  Implied bound: 6
  MIR: 80
  Flow cover: 3
  RLT: 8

Explored 73 nodes (1100 simplex iterations) in 0.08 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -89231 -89215 -89189.7 ... 1.33007e+13
No other solutions better than -89231

Optimal solution found (tolerance 1.00e-06)
Best objective -8.923101831238e+04, best bound -8.923101831238e+04, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 116190.70
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -89231.02
  [DEBUG]   S×d_nominal = 205421.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205421.71 + -89231.02 = 116190.70
  [DEBUG]   Current θ from Master = 116580.31
  [DEBUG]   ⚠️  Z_SP ≤ θ by 389.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11971.09
  Lower Bound (LB) = -11971.09
  Gap (UB-LB) = 389.6103, Absolute Gap = 389.6103, Relative Gap = 0.033641
  Not converged yet (gap = 389.61 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 654164 nonzeros
Model fingerprint: 0x14638c22
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 100150 rows and 40670 columns
Presolve time: 2.37s
Presolved: 130583 rows, 55190 columns, 804218 nonzeros
Variable types: 52931 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383863.9713
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.32s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 5.823e+06
 Factor NZ  : 1.323e+07 (roughly 200 MB of memory)
 Factor Ops : 2.970e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66647405e+07  2.07480656e+08  8.81e+04 1.75e+01  6.74e+04     4s
   1  -1.27267685e+07  1.80142902e+08  6.17e+04 4.79e+01  4.68e+04     4s
   2  -5.29854126e+06  1.44209785e+08  2.48e+04 7.86e+00  1.98e+04     4s
   3  -8.76344185e+05  1.03091828e+08  1.83e+03 1.01e+00  1.81e+03     4s
   4  -5.25118977e+05  5.39321614e+07  3.79e+02 3.72e-01  4.88e+02     4s
   5  -4.41077046e+05  3.37762172e+07  1.75e+02 2.07e-01  2.53e+02     4s
   6  -3.79518879e+05  2.46301113e+07  7.85e+01 1.39e-01  1.49e+02     4s
   7  -2.65040451e+05  1.82542847e+07  1.53e+01 9.70e-02  8.52e+01     5s
   8  -1.52293400e+05  1.12972397e+07  9.39e-01 5.92e-02  4.83e+01     5s
   9  -1.27101343e+05  4.17173683e+06  6.79e-01 2.16e-02  1.81e+01     5s
  10  -8.72891680e+04  2.49012158e+06  2.67e-01 1.26e-02  1.08e+01     5s
  11  -7.55243520e+04  1.09052685e+06  1.77e-01 5.42e-03  4.90e+00     5s
  12  -4.36975735e+04  3.86940527e+05  4.41e-02 1.67e-03  1.81e+00     5s
  13  -2.55517501e+04  1.67687377e+05  2.17e-02 7.36e-04  8.10e-01     5s
  14  -2.08934343e+04  1.03627457e+05  1.80e-02 3.87e-04  5.22e-01     5s
  15  -1.50866582e+04  8.05793815e+04  1.41e-02 3.64e-04  4.01e-01     5s
  16  -9.71214430e+03  5.68102432e+04  1.12e-02 2.60e-04  2.79e-01     5s
  17  -4.09422443e+03  4.74278937e+04  7.79e-03 4.54e-04  2.16e-01     5s
  18  -1.46687621e+03  3.89051895e+04  6.27e-03 3.48e-04  1.69e-01     5s
  19   8.33495691e+02  2.99047767e+04  5.00e-03 2.32e-04  1.22e-01     6s
  20   2.62290796e+03  2.39050126e+04  4.02e-03 1.57e-04  8.93e-02     6s
  21   4.07028738e+03  2.04728942e+04  3.23e-03 1.16e-04  6.88e-02     6s
  22   5.37260671e+03  1.77927148e+04  2.57e-03 8.28e-05  5.21e-02     6s
  23   6.48060540e+03  1.56210243e+04  2.04e-03 5.53e-05  3.83e-02     6s
  24   7.41914454e+03  1.42988163e+04  1.61e-03 3.84e-05  2.89e-02     6s
  25   7.49086415e+03  1.41535959e+04  1.57e-03 3.68e-05  2.79e-02     6s
  26   8.18762543e+03  1.33853468e+04  1.26e-03 2.74e-05  2.18e-02     6s
  27   8.74478638e+03  1.28844194e+04  1.01e-03 2.10e-05  1.74e-02     6s
  28   8.99167855e+03  1.23479939e+04  9.00e-04 1.49e-05  1.41e-02     6s
  29   9.44736500e+03  1.21039835e+04  7.11e-04 1.17e-05  1.11e-02     7s
  30   9.72695034e+03  1.18165628e+04  5.95e-04 7.87e-06  8.77e-03     7s
  31   9.85543763e+03  1.17483529e+04  5.40e-04 7.05e-06  7.94e-03     7s
  32   1.02908216e+04  1.15688102e+04  3.59e-04 4.71e-06  5.36e-03     7s
  33   1.04640177e+04  1.14711777e+04  2.86e-04 3.50e-06  4.22e-03     7s
  34   1.06978740e+04  1.13303681e+04  1.90e-04 1.69e-06  2.65e-03     7s
  35   1.08490747e+04  1.12871947e+04  1.28e-04 4.40e-06  1.84e-03     7s
  36   1.09101658e+04  1.12471992e+04  1.03e-04 3.16e-06  1.41e-03     7s
  37   1.09875382e+04  1.12351628e+04  7.09e-05 2.86e-06  1.04e-03     7s
  38   1.10331813e+04  1.12094598e+04  5.30e-05 1.38e-06  7.39e-04     7s
  39   1.10923348e+04  1.11896065e+04  3.01e-05 1.33e-06  4.08e-04     8s
  40   1.11232864e+04  1.11837393e+04  1.85e-05 5.37e-07  2.54e-04     8s
  41   1.11329187e+04  1.11833677e+04  1.50e-05 5.25e-07  2.12e-04     8s
  42   1.11396913e+04  1.11803751e+04  1.26e-05 2.29e-07  1.71e-04     8s
  43   1.11452651e+04  1.11773633e+04  1.06e-05 6.25e-08  1.35e-04     8s
  44   1.11643044e+04  1.11765739e+04  3.31e-06 5.04e-08  5.15e-05     8s
  45   1.11698232e+04  1.11752430e+04  1.47e-06 1.70e-07  2.27e-05     8s
  46   1.11733452e+04  1.11748631e+04  3.22e-07 8.33e-08  6.37e-06     8s
  47   1.11740194e+04  1.11745036e+04  1.74e-06 1.24e-06  2.03e-06     8s
  48   1.11740563e+04  1.11745026e+04  3.95e-06 1.19e-06  1.88e-06     8s
  49   1.11744093e+04  1.11744862e+04  2.81e-06 7.88e-07  3.23e-07     8s
  50   1.11744383e+04  1.11744860e+04  2.17e-06 1.33e-08  2.01e-07     9s
  51   1.11744409e+04  1.11744860e+04  5.31e-06 1.22e-07  1.90e-07     9s
  52   1.11744416e+04  1.11744860e+04  5.24e-06 1.40e-07  1.88e-07     9s
  53   1.11744459e+04  1.11744860e+04  9.39e-06 3.25e-07  1.69e-07     9s
  54   1.11744640e+04  1.11744860e+04  1.19e-05 3.94e-07  9.43e-08     9s
  55   1.11744704e+04  1.11744860e+04  8.48e-06 2.13e-07  6.73e-08     9s
  56   1.11744773e+04  1.11744860e+04  4.77e-06 1.76e-07  3.79e-08     9s
  57   1.11744811e+04  1.11744860e+04  2.70e-06 1.66e-07  2.14e-08     9s
  58   1.11744857e+04  1.11744860e+04  1.45e-07 1.17e-07  1.15e-09     9s
  59   1.11744859e+04  1.11744860e+04  4.81e-07 5.24e-08  1.85e-10     9s

Barrier solved model in 59 iterations and 9.20 seconds (14.50 work units)
Optimal objective 1.11744859e+04


Root crossover log...

   97782 DPushes remaining with DInf 0.0000000e+00                 9s
   54151 DPushes remaining with DInf 0.0000000e+00                10s
   18276 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                19s

   11253 PPushes remaining with PInf 8.3596146e-05                19s
       0 PPushes remaining with PInf 0.0000000e+00                19s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2178673e+01     19s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   56897    1.1174486e+04   0.000000e+00   1.217867e+01     19s
   56898    1.1174486e+04   0.000000e+00   0.000000e+00     19s
   56898    1.1174486e+04   0.000000e+00   0.000000e+00     19s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 1.117449e+04, 56898 iterations, 16.32 seconds (26.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11174.4860    0  521 -190756.93 11174.4860   106%     -   20s
H    0     0                    -146663.5644 11174.4860   108%     -   20s
H    0     0                    -146632.4667 11174.4860   108%     -   20s
H    0     0                    -134971.6037 11174.4860   108%     -   20s
H    0     0                    -126871.6784 11174.4860   109%     -   21s
H    0     0                    -124123.4247 11174.4860   109%     -   21s
H    0     0                    -123084.7831 11174.4860   109%     -   21s
H    0     0                    -110693.9322 11174.4860   110%     -   21s
H    0     0                    -110389.8110 11174.4860   110%     -   21s
H    0     0                    -110003.5324 11174.4860   110%     -   21s
H    0     0                    -66047.83830 11174.4860   117%     -   21s
H    0     0                    -60365.28085 11174.4860   119%     -   21s
H    0     0                    -58499.66589 11174.4860   119%     -   21s
H    0     0                    -55762.74069 11174.4860   120%     -   24s
     0     0 5136.00600    0  542 -55762.741 5136.00600   109%     -   65s
H    0     0                    -52967.18106 5135.72589   110%     -   66s
H    0     0                    -44668.70598 5135.72589   111%     -   66s
H    0     0                    -42935.13557 5135.72589   112%     -   66s
H    0     0                    -38651.94712 4929.13782   113%     -   82s
H    0     0                    -31891.40836 4929.13782   115%     -   82s
H    0     0                    -31890.24884 4929.13782   115%     -   82s
H    0     0                    -31698.59674 4929.13782   116%     -   82s
H    0     0                    -31628.96587 4929.13782   116%     -   82s
     0     0 4929.13782    0  578 -31628.966 4929.13782   116%     -   82s
     0     0 4846.08172    0  588 -31628.966 4846.08172   115%     -   95s
     0     0 4833.62144    0  591 -31628.966 4833.62144   115%     -  100s
     0     0 4816.54931    0  582 -31628.966 4816.54931   115%     -  109s
     0     0 4810.94231    0  590 -31628.966 4810.94231   115%     -  112s
     0     0 4696.76674    0  592 -31628.966 4696.76674   115%     -  126s
     0     0 4603.25804    0  603 -31628.966 4603.25804   115%     -  134s
     0     0 4539.84868    0  614 -31628.966 4539.84868   114%     -  154s
     0     0 4530.88134    0  607 -31628.966 4530.88134   114%     -  159s
     0     0 4523.15437    0  601 -31628.966 4523.15437   114%     -  161s
     0     0 4518.37957    0  660 -31628.966 4518.37957   114%     -  167s
     0     0 4518.37957    0  662 -31628.966 4518.37957   114%     -  168s
H    0     0                    -27144.60946 2284.43883   108%     -  252s
H    0     0                    -26869.96341 2284.43883   109%     -  252s
H    0     0                    -26869.83197 2284.43883   109%     -  252s
H    0     0                    -26624.12517 2284.43883   109%     -  252s
H    0     0                    -26588.40323 2284.43883   109%     -  252s
H    0     0                    -26547.80672 2284.43883   109%     -  252s
H    0     0                    -26240.45644 2284.43883   109%     -  252s
H    0     0                    -26236.69737 2284.43883   109%     -  252s
H    0     0                    -26205.45861 2284.43883   109%     -  252s
H    0     0                    -26201.69954 2284.43883   109%     -  252s
     0     0 2284.43883    0  667 -26201.700 2284.43883   109%     -  252s
H    0     0                    -25924.78370 2284.09219   109%     -  254s
H    0     0                    -25850.84009 2284.09219   109%     -  254s
H    0     0                    -25803.71830 2284.09219   109%     -  254s
H    0     0                    -25766.75466 2284.09219   109%     -  254s
H    0     0                    -25677.99627 2284.09219   109%     -  254s
H    0     0                    -25632.94212 2284.09219   109%     -  254s
H    0     0                    -25594.33066 2284.09219   109%     -  254s
H    0     0                    -25590.40897 2284.09219   109%     -  254s
     0     0 2118.51132    0  664 -25590.409 2118.51132   108%     -  283s
     0     0 1949.04633    0  673 -25590.409 1949.04633   108%     -  315s
     0     0 1913.01103    0  676 -25590.409 1913.01103   107%     -  328s
     0     0 1887.84370    0  684 -25590.409 1887.84370   107%     -  339s
     0     0 1880.48182    0  683 -25590.409 1880.48182   107%     -  346s
     0     0 1858.22183    0  679 -25590.409 1858.22183   107%     -  360s
     0     0 1856.45770    0  684 -25590.409 1856.45770   107%     -  363s
     0     0 1854.96633    0  676 -25590.409 1854.96633   107%     -  366s
H    0     0                    -22196.14541 1848.15975   108%     -  374s
H    0     0                    -20112.81662 1848.15975   109%     -  374s
H    0     0                    -18248.77088 1848.15975   110%     -  374s
     0     0 1848.15975    0  674 -18248.771 1848.15975   110%     -  374s
     0     0 1836.35156    0  675 -18248.771 1836.35156   110%     -  387s
     0     0 1835.75311    0  684 -18248.771 1835.75311   110%     -  389s
H    0     0                    -17768.91757 1835.75311   110%     -  415s
H    0     0                    -14208.37544 1835.75311   113%     -  416s
H    0     0                    -14207.21592 1835.75311   113%     -  416s
H    0     0                    -14202.16176 1835.75311   113%     -  416s
H    0     0                    -14129.53542 1835.75311   113%     -  416s
H    0     0                    -14111.75373 1835.75311   113%     -  416s
H    0     0                    -14108.99156 1835.75311   113%     -  416s
H    0     0                    -14082.77453 1835.75311   113%     -  416s
H    0     0                    -13995.18583 1835.75311   113%     -  416s
H    0     0                    -13982.83249 1835.75311   113%     -  416s
H    0     0                    -13980.07032 1835.75311   113%     -  416s
H    0     0                    -13973.72931 1835.75311   113%     -  416s
H    0     0                    -13896.04882 1835.75311   113%     -  416s
H    0     0                    -12610.40721  324.64309   103%     -  493s
H    0     0                    -12599.57803  324.64309   103%     -  493s
H    0     0                    -12537.97301  324.64309   103%     -  493s
H    0     0                    -12527.14382  324.64309   103%     -  493s
     0     0  324.64309    0  662 -12527.144  324.64309   103%     -  493s
H    0     0                    -12387.81454  323.26692   103%     -  494s
H    0     0                    -12375.52409  323.26692   103%     -  494s
H    0     0                    -12327.26387  323.26692   103%     -  494s
     0     0   35.74681    0  612 -12327.264   35.74681   100%     -  541s
     0     0 -145.11925    0  613 -12327.264 -145.11925  98.8%     -  575s
     0     0 -194.29994    0  691 -12327.264 -194.29994  98.4%     -  599s
     0     0 -213.34842    0  623 -12327.264 -213.34842  98.3%     -  617s
     0     0 -222.42817    0  635 -12327.264 -222.42817  98.2%     -  627s
     0     0 -225.66235    0  626 -12327.264 -225.66235  98.2%     -  632s
     0     0 -294.60583    0  635 -12327.264 -294.60583  97.6%     -  651s
     0     0 -298.68446    0  630 -12327.264 -298.68446  97.6%     -  658s
     0     0 -299.89351    0  635 -12327.264 -299.89351  97.6%     -  662s
     0     0 -781.56835    0  637 -12327.264 -781.56835  93.7%     -  758s
H    0     0                    -12225.48393 -981.03512  92.0%     -  813s
     0     0 -981.03512    0  662 -12225.484 -981.03512  92.0%     -  813s
     0     0 -1090.9770    0  663 -12225.484 -1090.9770  91.1%     -  843s
     0     0 -1125.6365    0  727 -12225.484 -1125.6365  90.8%     -  861s
     0     0 -1176.7184    0  791 -12225.484 -1176.7184  90.4%     -  885s
     0     0 -1196.1534    0  751 -12225.484 -1196.1534  90.2%     -  899s
     0     0 -1226.6511    0  757 -12225.484 -1226.6511  90.0%     -  920s
     0     0 -1234.8570    0  753 -12225.484 -1234.8570  89.9%     -  934s
     0     0 -1237.2492    0  767 -12225.484 -1237.2492  89.9%     -  940s
     0     0 -1239.2937    0  750 -12225.484 -1239.2937  89.9%     -  944s
     0     0 -1240.6895    0  756 -12225.484 -1240.6895  89.9%     -  947s
     0     0 -1374.5276    0  741 -12225.484 -1374.5276  88.8%     -  999s
H    0     0                    -12088.71314 -1374.6260  88.6%     - 1000s
H    0     0                    -12029.88592 -1374.6260  88.6%     - 1000s
     0     0 -1418.4800    0  757 -12029.886 -1418.4800  88.2%     - 1026s
     0     0 -1428.5282    0  806 -12029.886 -1428.5282  88.1%     - 1044s
     0     0 -1431.3098    0  809 -12029.886 -1431.3098  88.1%     - 1052s
     0     0 -1433.0068    0  815 -12029.886 -1433.0068  88.1%     - 1056s
H    0     0                    -12022.84554 -1492.9886  87.6%     - 1104s
     0     0 -1492.9886    0  665 -12022.846 -1492.9886  87.6%     - 1105s
H    0     0                    -12018.92385 -1493.0004  87.6%     - 1112s
H    0     0                    -11947.89217 -1493.0004  87.5%     - 1113s
     0     0 -1506.2725    0  686 -11947.892 -1506.2725  87.4%     - 1135s
     0     0 -1509.8461    0  689 -11947.892 -1509.8461  87.4%     - 1144s
     0     0 -1512.2783    0  695 -11947.892 -1512.2783  87.3%     - 1149s
     0     0 -1513.2902    0  693 -11947.892 -1513.2902  87.3%     - 1153s
     0     0 -1566.1145    0  749 -11947.892 -1566.1145  86.9%     - 1191s
     0     0 -1590.3502    0  748 -11947.892 -1590.3502  86.7%     - 1215s
     0     0 -1597.7564    0  744 -11947.892 -1597.7564  86.6%     - 1225s
     0     0 -1602.7847    0  740 -11947.892 -1602.7847  86.6%     - 1237s
     0     0 -1605.4753    0  753 -11947.892 -1605.4753  86.6%     - 1243s
     0     0 -1606.7131    0  743 -11947.892 -1606.7131  86.6%     - 1248s
     0     0 -1633.1863    0  763 -11947.892 -1633.1863  86.3%     - 1274s
     0     0 -1642.4661    0  783 -11947.892 -1642.4661  86.3%     - 1288s
     0     0 -1646.4238    0  778 -11947.892 -1646.4238  86.2%     - 1295s
     0     0 -1647.9073    0  782 -11947.892 -1647.9073  86.2%     - 1299s
     0     0 -1670.6725    0  763 -11947.892 -1670.6725  86.0%     - 1322s
     0     0 -1677.1464    0  770 -11947.892 -1677.1464  86.0%     - 1333s
     0     0 -1678.9303    0  773 -11947.892 -1678.9303  85.9%     - 1337s
     0     0 -1691.0253    0  789 -11947.892 -1691.0253  85.8%     - 1360s
H    0     0                    -11944.31706 -1691.0571  85.8%     - 1379s
H    0     0                    -11934.58169 -1691.0571  85.8%     - 1379s
     0     0 -1694.4047    0  786 -11934.582 -1694.4047  85.8%     - 1398s
     0     0 -1695.8974    0  737 -11934.582 -1695.8974  85.8%     - 1403s
     0     0 -1704.5430    0  727 -11934.582 -1704.5430  85.7%     - 1422s
     0     0 -1704.5478    0  727 -11934.582 -1704.5478  85.7%     - 1433s
     0     2 -1704.5478    0  727 -11934.582 -1704.5478  85.7%     - 1626s
     1     3 -2446.5588    1  545 -11934.582 -1704.5478  85.7% 16981 1663s
     2     4 -1869.9728    1  697 -11934.582 -1869.9728  84.3% 21158 1714s
     3     5 -3245.9499    2  342 -11934.582 -1869.9825  84.3% 18673 1740s
     4     9 -5588.8389    3  161 -11934.582 -1869.9825  84.3% 18291 1776s
     8    16 -5682.9053    4  150 -11934.582 -2070.3842  82.7% 14393 1825s
    15    31 -6000.2342    5  146 -11934.582 -2070.3842  82.7% 13259 1873s
    30    50 -6340.7516    6  128 -11934.582 -2281.0400  80.9% 15345 1954s
    49    82 -6344.2434    7  131 -11934.582 -2281.0400  80.9% 19103 2005s
    81   124 -6654.8321    8  130 -11934.582 -2281.0400  80.9% 14338 2053s
H   93   124                    -11920.98261 -2281.0400  80.9% 14124 2053s
   127   231 -7079.1428   10  116 -11920.983 -2281.0400  80.9% 13303 2103s
   246   279 -7807.5613   13  109 -11920.983 -2281.0400  80.9%  8967 2132s
H  247   279                    -11919.82308 -2281.0400  80.9%  8931 2132s
H  265   279                    -11916.45663 -2281.0400  80.9%  8597 2132s
H  284   279                    -11877.65045 -2281.0400  80.8%  8235 2132s
   321   323 -7761.2074   14  101 -11877.650 -2281.0400  80.8%  7731 2160s
   388   359 -10349.244   15   80 -11877.650 -2281.0400  80.8%  7079 2182s
H  399   359                    -11863.73697 -2281.0400  80.8%  6993 2182s
H  435   359                    -11855.86159 -2281.0400  80.8%  6649 2182s
H  452   359                    -11744.10086 -2281.0400  80.6%  6524 2182s
   470   383     cutoff   16      -11744.101 -2281.0400  80.6%  6388 2233s
H  536   440                    -11723.73002 -2281.0400  80.5%  5912 2257s
H  549   440                    -11717.24056 -2281.0400  80.5%  5822 2257s
H  551   440                    -11670.30073 -2281.0400  80.5%  5823 2257s
H  576   440                    -11655.06686 -2281.0400  80.4%  5672 2257s
   625   466 -7187.0027   19  226 -11655.067 -2281.0400  80.4%  5363 2279s
   712   453 -9021.3697   23  276 -11655.067 -2281.0400  80.4%  4971 2304s
   770   489 -7455.8025   21  291 -11655.067 -2281.0400  80.4%  4733 2327s
   830   520 -8211.4543   22  275 -11655.067 -2281.0400  80.4%  4617 2348s
   881   539 -8325.1377   23  280 -11655.067 -2281.0400  80.4%  4564 2368s
   944   555 infeasible   24      -11655.067 -2281.0400  80.4%  4410 2390s
  1008   547 infeasible   24      -11655.067 -2281.0400  80.4%  4295 2420s
  1061   566 -9108.0472   14  243 -11655.067 -2281.0400  80.4%  4216 2451s
  1117   598 -10360.938   15  224 -11655.067 -2281.0400  80.4%  4125 2478s
  1191   650 infeasible   16      -11655.067 -2281.0400  80.4%  4041 2501s
  1291   668 -11455.681   17  187 -11655.067 -2281.0400  80.4%  3932 2542s
  1419   732 -9471.1567   21  420 -11655.067 -2281.0400  80.4%  3755 2572s
  1541   813 -9768.4974   25  304 -11655.067 -2281.0400  80.4%  3608 2605s
  1688   836 -10011.401   31  254 -11655.067 -2281.0400  80.4%  3427 2639s
  1784   869 -10611.575   35  211 -11655.067 -2281.0400  80.4%  3396 2673s
  1891   891 -11048.587   38  230 -11655.067 -2281.0400  80.4%  3375 2707s
  1989   897 infeasible   44      -11655.067 -2281.0400  80.4%  3351 2742s
  2081   925 -11450.493    8  109 -11655.067 -2281.0400  80.4%  3324 2777s
  2190   936 -10337.846   10  338 -11655.067 -2281.0400  80.4%  3304 2814s
  2261   969 -10363.695   11  345 -11655.067 -2281.0400  80.4%  3306 2850s
  2338  1003 -10764.334   17   71 -11655.067 -2281.0400  80.4%  3318 2886s
  2419  1028 -10507.182   13  193 -11655.067 -2281.0400  80.4%  3322 2928s
  2508  1045 infeasible   14      -11655.067 -2281.0400  80.4%  3323 2972s
  2593  1104 -9256.9886   25  327 -11655.067 -2281.0400  80.4%  3363 3015s
  2703  1172 -9665.4740   28  270 -11655.067 -2281.0400  80.4%  3377 3060s
  2828  1202 infeasible   30      -11655.067 -2281.0400  80.4%  3390 3110s
  2950  1233 -8443.6869   13  428 -11655.067 -2281.0400  80.4%  3425 3161s
  3053  1247 -8661.0075   14  435 -11655.067 -2281.0400  80.4%  3452 3208s
  3125  1308 -8864.5383   16  358 -11655.067 -2281.0400  80.4%  3509 3269s
  3257  1355 infeasible   18      -11655.067 -2281.0400  80.4%  3527 3324s
  3374  1419 -11491.924   18  100 -11655.067 -2281.0400  80.4%  3517 3381s
  3575  1478 -8062.1245   10  242 -11655.067 -2281.0400  80.4%  3457 3441s
  3723  1562 -8928.5712   13  228 -11655.067 -2281.0400  80.4%  3491 3507s
  3925  1600 -9532.2511   16  371 -11655.067 -2281.0400  80.4%  3480 3575s
  4059  1585 -10545.687   20  210 -11655.067 -2281.0400  80.4%  3547 3600s

Cutting planes:
  Learned: 1
  Implied bound: 187
  MIR: 4126
  Flow cover: 4668
  Zero half: 11
  RLT: 179
  Relax-and-lift: 604

Explored 4134 nodes (15400736 simplex iterations) in 3600.08 seconds (7467.57 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11655.1 -11670.3 -11717.2 ... -11919.8

Time limit reached
Best objective -1.165506685593e+04, best bound -2.281040014763e+03, gap 80.4288%
  WARNING: Time limit reached. Using best solution found (gap: 80.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = -11655.07, θ = 118406.61
  Upper Bound (UB) = -11655.07

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 118406.61
  [DEBUG]   ✓ Scenario 0: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 118406.61 ≤ Q = 118406.61 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 118406.61 ≤ Q = 118406.61 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x1d5df8ef
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x1d5df8ef
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [3e-01, 2e+02]
Found heuristic solution: objective 1.239529e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.01s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6656583.6434
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.156667e+05, 248 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115666.72    0  121 6656583.64 -115666.72   102%     -    0s
H    0     0                    -81229.66481 -115666.72  42.4%     -    0s
H    0     0                    -81720.32746 -115666.72  41.5%     -    0s
     0     0 -88934.551    0   42 -81720.327 -88934.551  8.83%     -    0s
H    0     0                    -87993.04062 -88893.315  1.02%     -    0s
     0     0 -88692.335    0   18 -87993.041 -88692.335  0.79%     -    0s
     0     0 -88593.913    0   13 -87993.041 -88593.913  0.68%     -    0s
H    0     0                    -88396.72469 -88593.913  0.22%     -    0s
H    0     0                    -88419.74277 -88535.890  0.13%     -    0s
     0     0 -88535.890    0   16 -88419.743 -88535.890  0.13%     -    0s
     0     0 -88531.711    0   11 -88419.743 -88531.711  0.13%     -    0s
     0     0 -88528.023    0   11 -88419.743 -88528.023  0.12%     -    0s
     0     0 -88462.720    0   10 -88419.743 -88462.720  0.05%     -    0s
     0     0 -88441.177    0    8 -88419.743 -88441.177  0.02%     -    0s
     0     0 -88435.619    0    7 -88419.743 -88435.619  0.02%     -    0s
     0     0 -88431.632    0    7 -88419.743 -88431.632  0.01%     -    0s
     0     0 -88429.947    0    6 -88419.743 -88429.947  0.01%     -    0s
     0     0 -88420.455    0    2 -88419.743 -88420.455  0.00%     -    0s

Cutting planes:
  MIR: 2
  Flow cover: 1
  Relax-and-lift: 1

Explored 1 nodes (546 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -88419.7 -88396.7 -87993 ... 1.23953e+13
No other solutions better than -88419.7

Optimal solution found (tolerance 1.00e-06)
Best objective -8.841974277074e+04, best bound -8.841974277074e+04, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 114578.44
  Scenario: 9 demand increases, 51 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88419.74
  [DEBUG]   S×d_nominal = 202998.19
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 202998.19 + -88419.74 = 114578.44
  [DEBUG]   Current θ from Master = 118406.61
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3828.17 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -15483.23
  Lower Bound (LB) = -11971.09
  Gap (UB-LB) = 316.0234, Absolute Gap = 316.0234, Relative Gap = 0.027115
  Not converged yet (gap = 316.02 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 9 increases, 51 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697407 nonzeros
Model fingerprint: 0x2f6532a9
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [7e-02, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 4e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106818 rows and 43377 columns
Presolve time: 2.79s
Presolved: 139205 rows, 58723 columns, 857311 nonzeros
Variable types: 56464 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -383917.6055
Found heuristic solution: objective -190756.9345

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.08s

Barrier statistics:
 Dense cols : 677
 AA' NZ     : 6.532e+06
 Factor NZ  : 1.453e+07 (roughly 200 MB of memory)
 Factor Ops : 3.238e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.66861025e+07  2.18854897e+08  8.84e+04 1.68e+01  6.71e+04     5s
   1  -1.27981877e+07  1.89979183e+08  6.21e+04 4.64e+01  4.67e+04     5s
   2  -5.25925696e+06  1.53470756e+08  2.46e+04 6.26e+00  1.96e+04     5s
   3  -8.68748440e+05  1.08188816e+08  1.80e+03 9.11e-01  1.78e+03     6s
   4  -5.30318579e+05  5.59548201e+07  4.03e+02 3.24e-01  5.00e+02     6s
   5  -4.45303977e+05  3.66282259e+07  1.85e+02 1.87e-01  2.64e+02     6s
   6  -3.88541064e+05  2.68531460e+07  8.28e+01 1.26e-01  1.55e+02     6s
   7  -2.92642589e+05  1.89363296e+07  1.58e+01 8.35e-02  8.36e+01     6s
   8  -1.50407554e+05  8.55127373e+06  4.42e-01 3.54e-02  3.44e+01     6s
   9  -1.22072919e+05  3.66730684e+06  3.14e-01 1.48e-02  1.50e+01     6s
  10  -8.20672015e+04  1.60271379e+06  1.23e-01 6.34e-03  6.64e+00     6s
  11  -5.95742474e+04  6.26530707e+05  4.81e-02 2.52e-03  2.70e+00     6s
  12  -2.80836212e+04  1.93255441e+05  1.45e-02 7.27e-04  8.71e-01     6s
  13  -2.10703407e+04  1.11025986e+05  1.09e-02 1.05e-03  5.20e-01     6s
  14  -1.60509681e+04  8.68540435e+04  8.91e-03 7.89e-04  4.05e-01     6s
  15  -1.12284010e+04  6.89370445e+04  7.26e-03 5.94e-04  3.16e-01     6s
  16  -6.35714983e+03  6.16567084e+04  5.54e-03 5.16e-04  2.68e-01     7s
  17  -2.91353484e+03  4.68950460e+04  4.31e-03 3.51e-04  1.96e-01     7s
  18   1.32939500e+03  3.48405947e+04  2.79e-03 2.70e-04  1.32e-01     7s
  19   3.35698029e+03  2.55172033e+04  2.11e-03 4.23e-04  8.72e-02     7s
  20   5.06994448e+03  2.14995745e+04  1.56e-03 3.03e-04  6.47e-02     7s
  21   6.33483440e+03  1.77319137e+04  1.19e-03 1.94e-04  4.49e-02     7s
  22   7.43544710e+03  1.51582390e+04  8.99e-04 1.15e-04  3.04e-02     7s
  23   7.95102226e+03  1.44700217e+04  7.67e-04 9.50e-05  2.57e-02     7s
  24   8.61985873e+03  1.34370758e+04  5.96e-04 6.51e-05  1.90e-02     7s
  25   9.31923411e+03  1.28657011e+04  4.25e-04 4.83e-05  1.40e-02     8s
  26   9.71767852e+03  1.24852999e+04  3.26e-04 3.76e-05  1.09e-02     8s
  27   1.02718598e+04  1.21867225e+04  1.95e-04 2.83e-05  7.54e-03     8s
  28   1.03523902e+04  1.18188000e+04  1.77e-04 1.83e-05  5.77e-03     8s
  29   1.06236480e+04  1.17280286e+04  1.18e-04 1.55e-05  4.35e-03     8s
  30   1.07023683e+04  1.15870258e+04  1.01e-04 1.12e-05  3.48e-03     8s
  31   1.08765836e+04  1.14599892e+04  6.28e-05 7.51e-06  2.30e-03     8s
  32   1.09461460e+04  1.13710739e+04  4.84e-05 4.81e-06  1.67e-03     8s
  33   1.10504566e+04  1.13240113e+04  2.75e-05 3.41e-06  1.08e-03     8s
  34   1.10673567e+04  1.12737396e+04  2.41e-05 2.25e-06  8.12e-04     9s
  35   1.11067281e+04  1.12528863e+04  1.65e-05 1.64e-06  5.75e-04     9s
  36   1.11176817e+04  1.12233201e+04  1.44e-05 1.02e-06  4.16e-04     9s
  37   1.11815559e+04  1.12013488e+04  1.66e-06 9.20e-07  7.79e-05     9s
  38   1.11910833e+04  1.11969890e+04  3.20e-07 3.95e-07  2.32e-05     9s
  39   1.11915923e+04  1.11941578e+04  2.51e-07 1.27e-07  1.01e-05     9s
  40   1.11930626e+04  1.11936521e+04  7.14e-08 5.32e-08  2.32e-06     9s
  41   1.11933812e+04  1.11936029e+04  2.27e-07 4.97e-08  8.73e-07     9s
  42   1.11933865e+04  1.11935935e+04  2.12e-07 4.61e-08  8.15e-07     9s
  43   1.11934129e+04  1.11935247e+04  1.39e-07 1.38e-06  4.40e-07    10s
  44   1.11934507e+04  1.11934639e+04  3.96e-08 1.98e-06  5.17e-08    10s
  45   1.11934539e+04  1.11934637e+04  7.38e-08 1.21e-06  3.83e-08    10s
  46   1.11934632e+04  1.11934634e+04  8.47e-09 2.27e-09  4.96e-10    10s
  47   1.11934633e+04  1.11934634e+04  1.02e-06 2.91e-09  2.76e-10    10s

Barrier solved model in 47 iterations and 9.91 seconds (14.99 work units)
Optimal objective 1.11934633e+04


Root crossover log...

  104257 DPushes remaining with DInf 0.0000000e+00                10s
   57047 DPushes remaining with DInf 0.0000000e+00                11s
    7873 DPushes remaining with DInf 0.0000000e+00                15s
       0 DPushes remaining with DInf 0.0000000e+00                16s

   16389 PPushes remaining with PInf 8.0625428e-05                16s
       0 PPushes remaining with PInf 0.0000000e+00                17s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.0223334e+01     17s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   66319    1.1193463e+04   0.000000e+00   8.022333e+01     17s
   66341    1.1193463e+04   0.000000e+00   0.000000e+00     17s
   66341    1.1193463e+04   0.000000e+00   0.000000e+00     17s
Concurrent spin time: 0.88s

Solved with barrier

Root relaxation: objective 1.119346e+04, 66341 iterations, 14.63 seconds (20.23 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 11193.4634    0  521 -190756.93 11193.4634   106%     -   19s
H    0     0                    -166961.5489 11193.4634   107%     -   19s
H    0     0                    -166841.2149 11193.4634   107%     -   19s
H    0     0                    -130455.2424 11193.4634   109%     -   19s
H    0     0                    -122123.3686 11193.4634   109%     -   20s
H    0     0                    -122042.2077 11193.4634   109%     -   20s
H    0     0                    -121185.7172 11193.4634   109%     -   20s
H    0     0                    -120890.0157 11193.4634   109%     -   20s
H    0     0                    -120567.7055 11193.4634   109%     -   20s
H    0     0                    -120260.5514 11193.4634   109%     -   20s
H    0     0                    -88260.94876 11193.4634   113%     -   20s
H    0     0                    -72614.68198 11193.4634   115%     -   20s
H    0     0                    -66558.17004 11193.4634   117%     -   21s
H    0     0                    -66541.11335 11193.4634   117%     -   21s
     0     0 4867.70191    0  549 -66541.113 4867.70191   107%     -   71s
     0     0 4867.70191    0  549 -66541.113 4867.70191   107%     -   71s
H    0     0                    -53908.93032 4867.59589   109%     -   72s
H    0     0                    -39191.25566 4867.59589   112%     -   72s
H    0     0                    -36305.69073 4867.59589   113%     -   72s
     0     0 4591.14334    0  614 -36305.691 4591.14334   113%     -   91s
     0     0 4562.55682    0  568 -36305.691 4562.55682   113%     -  100s
     0     0 4530.56512    0  582 -36305.691 4530.56512   112%     -  109s
     0     0 4461.20966    0  585 -36305.691 4461.20966   112%     -  118s
     0     0 4443.09945    0  595 -36305.691 4443.09945   112%     -  123s
     0     0 4366.65424    0  607 -36305.691 4366.65424   112%     -  138s
     0     0 4347.68340    0  609 -36305.691 4347.68340   112%     -  144s
     0     0 4347.60220    0  609 -36305.691 4347.60220   112%     -  147s
     0     0 2696.11325    0  710 -36305.691 2696.11325   107%     -  217s
H    0     0                    -30912.78928 2696.07201   109%     -  217s
H    0     0                    -30859.85935 2696.07201   109%     -  217s
H    0     0                    -30713.61277 2696.07201   109%     -  218s
H    0     0                    -30710.02829 2696.07201   109%     -  218s
H    0     0                    -30683.34074 2696.07201   109%     -  218s
H    0     0                    -30577.57222 2696.07201   109%     -  218s
H    0     0                    -30564.88389 2696.07201   109%     -  218s
H    0     0                    -30563.25523 2696.07201   109%     -  218s
H    0     0                    -30524.22775 2696.07201   109%     -  218s
H    0     0                    -30511.53942 2696.07201   109%     -  218s
     0     0 2540.10156    0  676 -30511.539 2540.10156   108%     -  242s
     0     0 2440.78873    0  698 -30511.539 2440.78873   108%     -  262s
     0     0 2307.43396    0  681 -30511.539 2307.43396   108%     -  282s
     0     0 2289.60572    0  696 -30511.539 2289.60572   108%     -  288s
     0     0 2281.11885    0  698 -30511.539 2281.11885   107%     -  292s
     0     0 2276.86322    0  696 -30511.539 2276.86322   107%     -  296s
     0     0 2275.91879    0  698 -30511.539 2275.91879   107%     -  298s
     0     0 1078.86883    0  612 -30511.539 1078.86883   104%     -  407s
H    0     0                    -30337.46687 1078.74681   104%     -  408s
H    0     0                    -28085.36304 1078.74681   104%     -  408s
H    0     0                    -27651.62178 1078.74681   104%     -  409s
H    0     0                    -27591.30444 1078.74681   104%     -  409s
     0     0  853.72212    0  610 -27591.304  853.72212   103%     -  458s
     0     0  689.91114    0  621 -27591.304  689.91114   103%     -  495s
     0     0  624.41579    0  611 -27591.304  624.41579   102%     -  528s
     0     0  606.93727    0  614 -27591.304  606.93727   102%     -  544s
     0     0  596.86999    0  620 -27591.304  596.86999   102%     -  555s
     0     0  572.52064    0  624 -27591.304  572.52064   102%     -  566s
     0     0  567.91692    0  625 -27591.304  567.91692   102%     -  572s
     0     0  564.63301    0  612 -27591.304  564.63301   102%     -  577s
     0     0  564.23902    0  615 -27591.304  564.23902   102%     -  579s
     0     0 -174.70510    0  656 -27591.304 -174.70510  99.4%     -  696s
H    0     0                    -27587.38274 -174.93060  99.4%     -  696s
     0     0 -372.68185    0  647 -27587.383 -372.68185  98.6%     -  740s
     0     0 -410.53974    0  657 -27587.383 -410.53974  98.5%     -  764s
     0     0 -462.45396    0  666 -27587.383 -462.45396  98.3%     -  788s
     0     0 -468.40951    0  664 -27587.383 -468.40951  98.3%     -  796s
     0     0 -471.37885    0  669 -27587.383 -471.37885  98.3%     -  801s
     0     0 -474.59384    0  678 -27587.383 -474.59384  98.3%     -  806s
     0     0 -480.34995    0  671 -27587.383 -480.34995  98.3%     -  810s
     0     0 -514.24118    0  656 -27587.383 -514.24118  98.1%     -  826s
     0     0 -524.25636    0  671 -27587.383 -524.25636  98.1%     -  836s
     0     0 -532.65926    0  668 -27587.383 -532.65926  98.1%     -  844s
     0     0 -535.16376    0  665 -27587.383 -535.16376  98.1%     -  849s
     0     0 -535.99452    0  671 -27587.383 -535.99452  98.1%     -  852s
     0     0 -827.82815    0  651 -27587.383 -827.82815  97.0%     -  938s
H    0     0                    -18151.31802 -827.85777  95.4%     -  939s
H    0     0                    -13166.18384 -827.85777  93.7%     -  939s
H    0     0                    -13165.02432 -827.85777  93.7%     -  939s
H    0     0                    -12761.30403 -827.85777  93.5%     -  939s
H    0     0                    -12617.57197 -827.85777  93.4%     -  939s
H    0     0                    -12601.09593 -827.85777  93.4%     -  939s
     0     0 -871.41246    0  650 -12601.096 -871.41246  93.1%     -  971s
     0     0 -897.34247    0  652 -12601.096 -897.34247  92.9%     -  988s
     0     0 -918.53230    0  661 -12601.096 -918.53230  92.7%     - 1004s
     0     0 -924.02258    0  663 -12601.096 -924.02258  92.7%     - 1012s
     0     0 -926.07846    0  660 -12601.096 -926.07846  92.7%     - 1019s
     0     0 -928.89568    0  726 -12601.096 -928.89568  92.6%     - 1026s
     0     0 -945.72727    0  709 -12601.096 -945.72727  92.5%     - 1043s
     0     0 -952.60950    0  666 -12601.096 -952.60950  92.4%     - 1051s
     0     0 -953.53009    0  660 -12601.096 -953.53009  92.4%     - 1057s
     0     0 -1106.7907    0  633 -12601.096 -1106.7907  91.2%     - 1103s
H    0     0                    -12599.11399 -1106.8521  91.2%     - 1105s
H    0     0                    -12541.40405 -1106.8521  91.2%     - 1105s
H    0     0                    -12307.61590 -1106.8521  91.0%     - 1105s
H    0     0                    -12296.91249 -1106.8521  91.0%     - 1105s
H    0     0                    -12262.36220 -1106.8521  91.0%     - 1105s
H    0     0                    -12234.28299 -1106.8521  91.0%     - 1105s
H    0     0                    -12224.79391 -1106.8521  90.9%     - 1106s
H    0     0                    -12216.70639 -1106.8521  90.9%     - 1106s
H    0     0                    -12210.59479 -1106.8521  90.9%     - 1106s
     0     0 -1172.6727    0  669 -12210.595 -1172.6727  90.4%     - 1135s
     0     0 -1188.0798    0  671 -12210.595 -1188.0798  90.3%     - 1150s
     0     0 -1197.8478    0  672 -12210.595 -1197.8478  90.2%     - 1167s
     0     0 -1205.8005    0  674 -12210.595 -1205.8005  90.1%     - 1182s
     0     0 -1209.2374    0  681 -12210.595 -1209.2374  90.1%     - 1195s
     0     0 -1210.3637    0  671 -12210.595 -1210.3637  90.1%     - 1199s
     0     0 -1261.9263    0  678 -12210.595 -1261.9263  89.7%     - 1230s
     0     0 -1278.4855    0  698 -12210.595 -1278.4855  89.5%     - 1255s
     0     0 -1284.3918    0  758 -12210.595 -1284.3918  89.5%     - 1274s
     0     0 -1286.9188    0  754 -12210.595 -1286.9188  89.5%     - 1283s
     0     0 -1287.4485    0  752 -12210.595 -1287.4485  89.5%     - 1286s
     0     0 -1334.7541    0  679 -12210.595 -1334.7541  89.1%     - 1328s
H    0     0                    -12203.02719 -1334.8778  89.1%     - 1329s
     0     0 -1349.0197    0  803 -12203.027 -1349.0197  88.9%     - 1358s
     0     0 -1352.7285    0  815 -12203.027 -1352.7285  88.9%     - 1368s
     0     0 -1354.8130    0  684 -12203.027 -1354.8130  88.9%     - 1377s
     0     0 -1379.7177    0  702 -12203.027 -1379.7177  88.7%     - 1412s
     0     0 -1388.4707    0  688 -12203.027 -1388.4707  88.6%     - 1426s
     0     0 -1392.0789    0  702 -12203.027 -1392.0789  88.6%     - 1440s
     0     0 -1394.1203    0  758 -12203.027 -1394.1203  88.6%     - 1453s
     0     0 -1403.2525    0  699 -12203.027 -1403.2525  88.5%     - 1480s
H    0     0                    -12186.69418 -1403.3324  88.5%     - 1481s
     0     0 -1408.3410    0  712 -12186.694 -1408.3410  88.4%     - 1496s
     0     0 -1410.3418    0  713 -12186.694 -1410.3418  88.4%     - 1508s
     0     0 -1417.6551    0  787 -12186.694 -1417.6551  88.4%     - 1531s
     0     0 -1420.1978    0  726 -12186.694 -1420.1978  88.3%     - 1547s
     0     0 -1421.0440    0  715 -12186.694 -1421.0440  88.3%     - 1557s
     0     0 -1423.9356    0  715 -12186.694 -1423.9356  88.3%     - 1574s
     0     0 -1423.9483    0  715 -12186.694 -1423.9483  88.3%     - 1588s
H    0     0                    -12151.00306 -1423.9483  88.3%     - 1721s
H    0     0                    -12063.55910 -1423.9483  88.2%     - 1832s
H    0     0                    -11988.78907 -1423.9483  88.1%     - 1832s
H    0     0                    -11974.80243 -1423.9483  88.1%     - 1840s
     0     2 -1423.9483    0  715 -11974.802 -1423.9483  88.1%     - 1843s
     1     3 -2305.0663    1  595 -11974.802 -1423.9483  88.1% 22498 1900s
     2     4 -1565.9120    1  680 -11974.802 -1565.9120  86.9% 17038 1926s
     3     6 -2507.1197    2  607 -11974.802 -1565.9316  86.9% 14290 1952s
     5    12 -2669.2145    3  616 -11974.802 -1565.9316  86.9% 14506 1988s
    11    24 -2700.8294    4  627 -11974.802 -1598.8752  86.6% 13129 2072s
    23    36 -2042.6139    4  654 -11974.802 -1607.2518  86.6% 22596 2193s
    35    68 -3252.1679    5  318 -11974.802 -1607.2518  86.6% 22343 2398s
H   41    68                    -11971.54829 -1607.2518  86.6% 21948 2398s
H   41    68                    -11956.39781 -1607.2518  86.6% 21948 2398s
    67   167 -3658.8870    6  312 -11956.398 -1701.6168  85.8% 26386 2483s
   168   227 -4781.6644    9  145 -11956.398 -1701.6471  85.8% 14530 2516s
H  193   227                    -11752.73206 -1701.6471  85.5% 12993 2516s
H  193   227                    -11628.14504 -1701.6471  85.4% 12993 2516s
   246   271 -4797.0272   10  148 -11628.145 -1701.6471  85.4% 11547 2561s
H  337   301                    -11597.38863 -1701.6471  85.3%  9746 2590s
   405   312 -7343.4935   15  122 -11597.389 -1701.6471  85.3%  9271 2619s
   472   312 -8380.8644   20  104 -11597.389 -1701.6471  85.3%  8739 2646s
   506   338 infeasible   19      -11597.389 -1701.6471  85.3%  8518 2670s
   556   355 -9986.4906   17   88 -11597.389 -1701.6471  85.3%  8321 2694s
   591   382 -10010.665   18   91 -11597.389 -1701.6471  85.3%  8185 2721s
   636   390 infeasible   22      -11597.389 -1701.6471  85.3%  7955 2745s
   675   409 -11213.770   20   71 -11597.389 -1701.6471  85.3%  7711 2767s
   720   452 -10025.714   29   78 -11597.389 -1701.6471  85.3%  7478 2788s
   802   524 -10542.604   33   53 -11597.389 -1701.6471  85.3%  7003 2807s
   920   532 -11079.484   39   30 -11597.389 -1701.6471  85.3%  6361 2827s
  1059   527 -9967.5655   26   72 -11597.389 -1701.6471  85.3%  5763 2846s
  1118   499 -11285.477   27   65 -11597.389 -1701.6471  85.3%  5611 2871s
  1198   512 -11266.401   20   36 -11597.389 -1701.6471  85.3%  5464 2900s
  1225   539 -5310.7750   12  321 -11597.389 -1701.6471  85.3%  5609 2925s
  1265   558 -5010.2956   14  423 -11597.389 -1701.6471  85.3%  5770 2953s
  1300   574 -6540.3460   15  293 -11597.389 -1701.6471  85.3%  5883 2977s
  1347   591 -7608.7839   16  280 -11597.389 -1701.6471  85.3%  5945 3003s
  1400   613 -7660.9136   17  358 -11597.389 -1701.6471  85.3%  5993 3030s
  1461   623 -7829.6388   18  275 -11597.389 -1701.6471  85.3%  6047 3052s
  1505   625 -7873.9162   19  193 -11597.389 -1701.6471  85.3%  6085 3077s
  1566   648 -8407.5121   20  159 -11597.389 -1701.6471  85.3%  6100 3114s
  1623   665 -8580.6340   21  235 -11597.389 -1701.6471  85.3%  6189 3147s
  1682   681 -7720.2092   16  241 -11597.389 -1701.6471  85.3%  6220 3174s
  1688   681 infeasible   18      -11597.389 -1701.6471  85.3%  6215 3175s
  1734   694 -10010.063   20  189 -11597.389 -1983.4149  82.9%  6269 3210s
  1797   725 -10429.228   21  270 -11597.389 -1983.4149  82.9%  6337 3244s
  1867   766 -10733.209   22  185 -11597.389 -1983.4149  82.9%  6433 3280s
  1939   802 -10969.552   23  254 -11597.389 -1983.4149  82.9%  6463 3311s
  2032   829 -11135.155   24  250 -11597.389 -1983.4149  82.9%  6471 3349s
  2150   850 infeasible   26      -11597.389 -1983.4149  82.9%  6445 3393s
  2243   875 -7504.9511   12  304 -11597.389 -1983.4149  82.9%  6513 3433s
  2353   939 infeasible   19      -11597.389 -1983.4149  82.9%  6557 3481s
  2477   991 -9973.4010   23  231 -11597.389 -1983.4149  82.9%  6582 3524s
  2607  1031 -10817.569   28  144 -11597.389 -2375.0035  79.5%  6618 3573s
  2723  1039 -5100.5754    8  195 -11597.389 -2375.0035  79.5%  6659 3600s

Cutting planes:
  Implied bound: 228
  MIR: 4391
  Flow cover: 4373
  Zero half: 16
  RLT: 164
  Relax-and-lift: 653
  PSD: 1

Explored 2805 nodes (19451627 simplex iterations) in 3600.11 seconds (7373.68 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -11597.4 -11628.1 -11752.7 ... -12186.7

Time limit reached
Best objective -1.159738862964e+04, best bound -2.375003478298e+03, gap 79.5212%
  WARNING: Time limit reached. Using best solution found (gap: 79.52%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = -11597.39, θ = 116575.32
  Upper Bound (UB) = -11597.39

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 116575.32
  [DEBUG]   ✓ Scenario 0: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 116575.32 ≤ Q = 116575.32 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 116575.32 ≤ Q = 116575.32 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5ce3fd93
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5ce3fd93
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.325396e+13
Presolve removed 2577 rows and 1870 columns
Presolve time: 0.01s
Presolved: 516 rows, 519 columns, 1455 nonzeros
Found heuristic solution: objective 6995164.3696
Variable types: 351 continuous, 168 integer (168 binary)

Root relaxation: objective -1.202154e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -120215.35    0  122 6995164.37 -120215.35   102%     -    0s
H    0     0                    -85682.93997 -120215.35  40.3%     -    0s
H    0     0                    -86212.29396 -120215.35  39.4%     -    0s
     0     0 -88998.914    0   32 -86212.294 -88998.914  3.23%     -    0s
H    0     0                    -88868.26698 -88988.892  0.14%     -    0s
     0     0 -88955.237    0   31 -88868.267 -88955.237  0.10%     -    0s
     0     0 -88955.237    0   42 -88868.267 -88955.237  0.10%     -    0s
     0     0 -88955.237    0   33 -88868.267 -88955.237  0.10%     -    0s
H    0     0                    -88874.92931 -88955.237  0.09%     -    0s
     0     0 -88953.384    0   30 -88874.929 -88953.384  0.09%     -    0s
H    0     0                    -88902.67153 -88953.384  0.06%     -    0s
H    0     0                    -88953.38443 -88953.384  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 4
  MIR: 42

Explored 1 nodes (549 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -88953.4 -88902.7 -88874.9 ... 1.3254e+13
No other solutions better than -88953.4

Optimal solution found (tolerance 1.00e-06)
Best objective -8.895338443168e+04, best bound -8.895338443168e+04, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 116468.33
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -88953.38
  [DEBUG]   S×d_nominal = 205421.71
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 205421.71 + -88953.38 = 116468.33
  [DEBUG]   Current θ from Master = 116575.32
  [DEBUG]   ⚠️  Z_SP ≤ θ by 106.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -11704.38
  Lower Bound (LB) = -11704.38
  Gap (UB-LB) = 106.9927, Absolute Gap = 106.9927, Relative Gap = 0.009226
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 16
Total Time: 39264.59s
Converged: True
Final Lower Bound: -11704.3813
Final Upper Bound: -11597.3886
Final Gap: 106.992694
Number of Critical Scenarios: 16
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [2] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 7, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 3 customers  Mode 1: 12 customers  Mode 2: 35 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 16
Start Time: 2026-01-03 10:51:25
End Time: 2026-01-03 21:45:49
Total Time: 39264.59s
Optimal Value: -11704.38
Lower Bound: -11704.38
Upper Bound: -11597.39
Gap: 106.992694
Plants Opened: {0: [0], 1: [1], 2: [2]} (3 plants)
DCs Opened: [0, 7, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed21_LD_gamma20_20260103_214550.csv

Total Execution Time: 39265.58 seconds
End Time: 2026-01-03 21:45:50

All tasks completed successfully!

