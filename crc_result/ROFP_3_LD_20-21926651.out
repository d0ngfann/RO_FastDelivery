
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 3
DI Scenario: LD
Start Time: 2026-01-04 09:45:28
================================================================================
Loading data from data/DH_data_full_seed3.pkl...

Applying DI scenario: LD
DI values:
  Product 0: ['1.000', '1.001', '1.002'] (k=0.002)
  Product 1: ['1.000', '1.130', '1.276'] (k=0.301)
  Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=943, max=1680
  DC capacity (MC): min=517, max=897

Demand Structure (s_rk matrix):
  Total customer-product pairs: 72/150 (52.0% sparse)
  Average products per customer: 1.44

Demand (only non-zero entries):
  Nominal (μ): min=8.19, max=34.85, count=72
  Deviation (μ̂): min=4.03, max=9.90

Costs:
  Plant fixed cost: min=5861, max=8650
  DC fixed cost: min=3689, max=4911
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
    Product 1: ['1.000', '1.390', '1.932'] (k=0.812)
    Product 2: ['1.000', '1.313', '1.725'] (k=0.672)
  MD:
    Product 0: ['1.000', '1.241', '1.540'] (k=0.532)
    Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
    Product 2: ['1.000', '1.230', '1.514'] (k=0.512)
  LD:
    Product 0: ['1.000', '1.001', '1.002'] (k=0.002)
    Product 1: ['1.000', '1.130', '1.276'] (k=0.301)
    Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
  Mixed:
    Product 0: ['1.000', '1.421', '2.018'] (k=0.866)
    Product 1: ['1.000', '1.292', '1.669'] (k=0.632)
    Product 2: ['1.000', '1.107', '1.226'] (k=0.252)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48726 nonzeros
Model fingerprint: 0xd5d765a0
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 12199 rows and 3199 columns
Presolve time: 0.11s
Presolved: 4474 rows, 5301 columns, 31241 nonzeros
Variable types: 3042 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -340063.9009
Found heuristic solution: objective -171323.3514

Root relaxation: objective 4.673914e+04, 3965 iterations, 0.13 seconds (0.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 46739.1351    0  428 -171323.35 46739.1351   127%     -    0s
     0     0 44638.2305    0  616 -171323.35 44638.2305   126%     -    0s
H    0     0                    -169795.4741 44629.4716   126%     -    0s
H    0     0                    -161568.5570 44495.2296   128%     -    0s
     0     0 44495.2296    0  616 -161568.56 44495.2296   128%     -    0s
     0     0 44485.6399    0  684 -161568.56 44485.6399   128%     -    0s
     0     0 44484.1444    0  683 -161568.56 44484.1444   128%     -    0s
     0     0 41476.2822    0  958 -161568.56 41476.2822   126%     -    1s
H    0     0                    -128886.6595 41472.2989   132%     -    1s
     0     0 41280.4460    0  964 -128886.66 41280.4460   132%     -    1s
     0     0 41259.4457    0  970 -128886.66 41259.4457   132%     -    1s
     0     0 41258.5307    0  966 -128886.66 41258.5307   132%     -    1s
H    0     0                    -52319.52663 39437.8845   175%     -    3s
H    0     0                    -2837.749053 39437.8845  1490%     -    3s
H    0     0                    -2677.394564 39437.8845  1573%     -    3s
     0     0 39437.8845    0 1157 -2677.3946 39437.8845  1573%     -    3s
     0     0 39031.1136    0 1156 -2677.3946 39031.1136  1558%     -    3s
     0     0 39031.1136    0 1151 -2677.3946 39031.1136  1558%     -    3s
H    0     0                    -2613.562188 39031.1136  1593%     -    3s
     0     0 39031.1136    0 1155 -2613.5622 39031.1136  1593%     -    3s
     0     0 39021.2611    0 1160 -2613.5622 39021.2611  1593%     -    3s
H    0     0                    -2612.708690 38283.0166  1565%     -    4s
H    0     0                    -2594.085993 38283.0166  1576%     -    4s
H    0     0                    -2475.455277 37629.7051  1620%     -    5s
H    0     0                    -2403.217682 37629.7051  1666%     -    5s
     0     0 37629.7051    0 1339 -2403.2177 37629.7051  1666%     -    5s
H    0     0                    2493.6399450 37292.7936  1396%     -    6s
H    0     0                    2607.8133481 37292.7936  1330%     -    6s
H    0     0                    2773.8877428 37292.7936  1244%     -    6s
H    0     0                    2888.0611459 37292.7936  1191%     -    6s
H    0     0                    3180.9584312 37292.7936  1072%     -    6s
H    0     0                    3435.5821438 37292.7936   985%     -    6s
H    0     0                    3455.5580210 37292.7936   979%     -    6s
H    0     0                    3500.5341361 37292.7936   965%     -    6s
     0     0 37292.7936    0 1342 3500.53414 37292.7936   965%     -    6s
     0     0 37247.8751    0 1353 3500.53414 37247.8751   964%     -    6s
     0     0 37198.2219    0 1353 3500.53414 37198.2219   963%     -    6s
     0     0 36452.2866    0 1387 3500.53414 36452.2866   941%     -    7s
     0     0 36335.3538    0 1290 3500.53414 36335.3538   938%     -    8s
     0     0 36294.7517    0 1311 3500.53414 36294.7517   937%     -    8s
     0     0 36291.2734    0 1308 3500.53414 36291.2734   937%     -    8s
     0     0 35581.7044    0 1439 3500.53414 35581.7044   916%     -   10s
     0     0 35396.1048    0 1462 3500.53414 35396.1048   911%     -   10s
     0     0 35374.0826    0 1469 3500.53414 35374.0826   911%     -   11s
     0     0 35370.6943    0 1479 3500.53414 35370.6943   910%     -   11s
H    0     0                    4758.7923765 35370.6943   643%     -   11s
H    0     0                    4789.1693925 35370.6943   639%     -   11s
H    0     0                    4804.1066350 35370.6943   636%     -   11s
H    0     0                    5087.2279282 34591.2900   580%     -   13s
H    0     0                    5118.6697533 34591.2900   576%     -   13s
H    0     0                    5129.8945019 34591.2900   574%     -   13s
H    0     0                    5286.0646773 34591.2900   554%     -   13s
H    0     0                    5300.8990427 34591.2900   553%     -   13s
H    0     0                    7415.5544515 34591.2900   366%     -   13s
H    0     0                    7665.1284136 34591.2900   351%     -   13s
H    0     0                    7672.4436046 34591.2900   351%     -   13s
H    0     0                    7693.7729859 34591.2900   350%     -   13s
H    0     0                    7782.9746567 34591.2900   344%     -   13s
H    0     0                    7838.9388864 34591.2900   341%     -   13s
     0     0 34591.2900    0 1402 7838.93889 34591.2900   341%     -   13s
H    0     0                    8205.4941540 34414.8826   319%     -   14s
H    0     0                    8562.4436009 34414.8826   302%     -   14s
H    0     0                    8565.8294328 34414.8826   302%     -   14s
H    0     0                    8611.8634208 34414.8826   300%     -   14s
H    0     0                    8615.2492526 34414.8826   299%     -   14s
H    0     0                    8622.5644436 34414.8826   299%     -   14s
     0     0 34414.8826    0 1441 8622.56444 34414.8826   299%     -   14s
     0     0 34400.0140    0 1454 8622.56444 34400.0140   299%     -   14s
     0     0 34395.6073    0 1466 8622.56444 34395.6073   299%     -   14s
H    0     0                    8625.0832733 33728.4882   291%     -   17s
H    0     0                    8655.7531870 33728.4882   290%     -   17s
H    0     0                    8708.5588387 33728.4882   287%     -   17s
     0     0 33348.4042    0 1478 8708.55884 33348.4042   283%     -   17s
H    0     0                    8714.5155283 33348.4042   283%     -   18s
H    0     0                    8812.3314497 33348.4042   278%     -   18s
H    0     0                    8825.3993874 33348.4042   278%     -   18s
H    0     0                    8827.9182171 33348.4042   278%     -   18s
H    0     0                    8845.4847263 33348.4042   277%     -   18s
H    0     0                    8899.8153577 33348.4042   275%     -   18s
H    0     0                    8900.8974537 33348.4042   275%     -   18s
     0     0 33344.6815    0 1490 8900.89745 33344.6815   275%     -   18s
     0     0 33344.6815    0 1487 8900.89745 33344.6815   275%     -   18s
     0     0 32985.6990    0 1496 8900.89745 32985.6990   271%     -   19s
     0     0 32985.6990    0 1505 8900.89745 32985.6990   271%     -   19s
     0     0 32724.0127    0 1495 8900.89745 32724.0127   268%     -   21s
     0     0 32655.3819    0 1480 8900.89745 32655.3819   267%     -   22s
     0     0 32368.4591    0 1503 8900.89745 32368.4591   264%     -   22s
     0     0 32368.4591    0 1506 8900.89745 32368.4591   264%     -   22s
     0     0 32272.8794    0 1471 8900.89745 32272.8794   263%     -   25s
     0     0 32213.7830    0 1513 8900.89745 32213.7830   262%     -   26s
     0     0 32152.3226    0 1509 8900.89745 32152.3226   261%     -   26s
     0     0 32071.1185    0 1529 8900.89745 32071.1185   260%     -   27s
H    0     0                    8918.5466713 32071.1185   260%     -   29s
     0     0 31988.3798    0 1503 8918.54667 31988.3798   259%     -   29s
     0     0 31804.3287    0 1521 8918.54667 31804.3287   257%     -   30s
H    0     0                    8922.4894637 31804.3287   256%     -   30s
H    0     0                    8924.6283331 31804.3287   256%     -   30s
H    0     0                    8928.0141649 31804.3287   256%     -   30s
     0     0 31725.9391    0 1542 8928.01416 31725.9391   255%     -   30s
     0     0 31725.9391    0 1540 8928.01416 31725.9391   255%     -   31s
H    0     0                    8960.0270018 31718.9257   254%     -   33s
     0     0 31544.1290    0 1501 8960.02700 31544.1290   252%     -   33s
H    0     0                    9151.5284749 31544.1290   245%     -   34s
     0     0 31539.1186    0 1512 9151.52847 31539.1186   245%     -   34s
     0     0 31501.0234    0 1516 9151.52847 31501.0234   244%     -   35s
     0     0 31488.9418    0 1540 9151.52847 31488.9418   244%     -   35s
     0     0 31204.3712    0 1531 9151.52847 31204.3712   241%     -   37s
     0     0 31145.6866    0 1561 9151.52847 31145.6866   240%     -   39s
     0     0 31143.8378    0 1554 9151.52847 31143.8378   240%     -   39s
     0     0 30899.8257    0 1479 9151.52847 30899.8257   238%     -   41s
H    0     0                    9211.0588333 30899.8257   235%     -   42s
     0     0 30791.6642    0 1518 9211.05883 30791.6642   234%     -   42s
     0     0 30791.6642    0 1527 9211.05883 30791.6642   234%     -   43s
     0     0 30723.5240    0 1488 9211.05883 30723.5240   234%     -   45s
     0     0 30680.9455    0 1521 9211.05883 30680.9455   233%     -   46s
     0     0 30634.4953    0 1534 9211.05883 30634.4953   233%     -   47s
     0     0 30546.8832    0 1502 9211.05883 30546.8832   232%     -   49s
     0     0 30509.5495    0 1517 9211.05883 30509.5495   231%     -   50s
     0     0 30452.4417    0 1523 9211.05883 30452.4417   231%     -   50s
     0     0 30410.7204    0 1491 9211.05883 30410.7204   230%     -   52s
     0     0 30325.3785    0 1501 9211.05883 30325.3785   229%     -   53s
     0     0 30325.3785    0 1507 9211.05883 30325.3785   229%     -   53s
H    0     0                    9257.1314012 30294.8421   227%     -   55s
H    0     0                    9311.6462785 30294.8421   225%     -   55s
     0     0 30269.2981    0 1463 9311.64628 30269.2981   225%     -   55s
     0     0 30229.7697    0 1490 9311.64628 30229.7697   225%     -   56s
     0     0 30217.3945    0 1491 9311.64628 30217.3945   225%     -   57s
     0     0 30103.7544    0 1464 9311.64628 30103.7544   223%     -   59s
     0     0 30064.4218    0 1476 9311.64628 30064.4218   223%     -   60s
     0     0 30056.0927    0 1481 9311.64628 30056.0927   223%     -   60s
     0     0 29945.3412    0 1458 9311.64628 29945.3412   222%     -   62s
     0     0 29945.3002    0 1458 9311.64628 29945.3002   222%     -   63s
     0     2 29945.2804    0 1458 9311.64628 29945.2804   222%     -   65s
     1     4 29014.7983    1 1322 9311.64628 29944.0273   222%  6077   72s
     3     8 28608.7159    2 1202 9311.64628 29006.3731   212%  7788   79s
     7    16 28235.1176    3 1090 9311.64628 28604.3554   207%  7276   83s
    15    32 27667.3901    4  961 9311.64628 28232.9676   203%  5570   85s
H   95   179                    9314.9933906 26191.0182   181%  3264   90s
H  102   179                    9362.1797457 26191.0182   180%  3155   90s
   338   381 11722.4114   12  382 9362.17975 25345.4563   171%  1725   95s
H  496   491                    9379.7891771 24399.8585   160%  1401   98s
   592   549     cutoff   18      9379.78918 24006.5989   156%  1287  100s
H  604   549                    9381.9280464 24006.5989   156%  1269  100s
   730   675     cutoff   22      9381.92805 23090.1549   146%  1179  106s
   879   796 13023.3944   10  602 9381.92805 22213.9022   137%  1110  110s
  1067   958 10925.1381   13  593 9381.92805 21876.7478   133%  1055  115s
  1546  1145 12602.7284    7  248 9381.92805 21554.8298   130%  1139  122s
  1643  1186 10223.7016    9  233 9381.92805 21226.7410   126%  1139  125s
  1727  1229 9605.58674    9  235 9381.92805 20636.1123   120%  1138  130s
  1893  1317     cutoff   12      9381.92805 20546.7935   119%  1134  135s
  2329  1559 10227.9237   14  203 9381.92805 20213.1727   115%  1064  140s
  2910  1875 15548.9122   14  609 9381.92805 19110.6971   104%  1063  147s
  3149  1898 12886.6240   20  568 9381.92805 18888.1797   101%  1043  150s
  3289  2049 12773.9099   22  557 9381.92805 18718.1341   100%  1040  157s
  3447  2232 12723.0404   23  556 9381.92805 18495.8243  97.1%  1029  161s
  4016  2399 12211.2838   20 1458 9381.92805 18401.6194  96.1%  1010  186s
  4026  2406 11117.7541   23  505 9381.92805 16506.2085  75.9%  1007  190s
  4037  2413 12134.2732   20  614 9381.92805 14232.4503  51.7%  1004  196s

Cutting planes:
  Implied bound: 2
  Projected implied bound: 52
  MIR: 166
  Flow cover: 349
  Zero half: 12
  RLT: 3
  Relax-and-lift: 79

Explored 4226 nodes (4219874 simplex iterations) in 199.59 seconds (255.39 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: 9381.93 9379.79 9362.18 ... 8928.01

Optimal solution found (tolerance 1.00e-06)
Best objective 9.381928046441e+03, best bound 9.381928046441e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 199.59s
  Master Objective (UB) = 9381.93, θ = 125289.83
  Upper Bound (UB) = 9381.93

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 125289.83
  [DEBUG]   ✓ Scenario 0: θ = 125289.83 ≤ Q = 125289.83 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x199a6b2f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe66594d1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.594741e+13
Presolve removed 2652 rows and 1946 columns
Presolve time: 0.01s
Presolved: 441 rows, 443 columns, 1242 nonzeros
Found heuristic solution: objective 7544945.9018
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.103260e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -110326.02    0  123 7544945.90 -110326.02   101%     -    0s
H    0     0                    -81839.25420 -110326.02  34.8%     -    0s
H    0     0                    -82008.83356 -110326.02  34.5%     -    0s
H    0     0                    -83375.85748 -83375.857  0.00%     -    0s
     0     0          -    0      -83375.857 -83375.857  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 195

Explored 1 nodes (360 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -83375.9 -82008.8 -81839.3 ... 1.59474e+13
No other solutions better than -83375.9

Optimal solution found (tolerance 1.00e-06)
Best objective -8.337585748176e+04, best bound -8.337585748176e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 93087.63
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -83375.86
  [DEBUG]   S×d_nominal = 176463.49
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 176463.49 + -83375.86 = 93087.63
  [DEBUG]   Current θ from Master = 125289.83
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32202.20 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22820.27
  Lower Bound (LB) = -22820.27
  Gap (UB-LB) = 32202.1991, Absolute Gap = 32202.1991, Relative Gap = 3.432365
  Not converged yet (gap = 32202.20 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91933 nonzeros
Model fingerprint: 0x722708d6
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -22820.3 (0.02s)
MIP start from previous solve produced solution with objective -22820.3 (0.02s)
Loaded MIP start from previous solve with objective -22820.3

Presolve removed 15757 rows and 6396 columns
Presolve time: 0.43s
Presolved: 16206 rows, 8344 columns, 89438 nonzeros
Variable types: 6085 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.263840e+03, 10220 iterations, 2.23 seconds (3.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 4263.84006    0  465 -22820.271 4263.84006   119%     -    2s
H    0     0                    -22672.30077 4263.84006   119%     -    2s
H    0     0                    -22636.37986 4263.84006   119%     -    2s
     0     0 -2252.1593    0  815 -22636.380 -2252.1593  90.1%     -    6s
     0     0 -2392.5265    0  820 -22636.380 -2392.5265  89.4%     -    6s
     0     0 -2403.8419    0  816 -22636.380 -2403.8419  89.4%     -    6s
     0     0 -2403.8431    0  816 -22636.380 -2403.8431  89.4%     -    6s
     0     0 -7449.1894    0  813 -22636.380 -7449.1894  67.1%     -   10s
H    0     0                    -22635.02110 -7449.4803  67.1%     -   10s
H    0     0                    -22630.07285 -7449.4803  67.1%     -   10s
H    0     0                    -22627.04837 -7449.4803  67.1%     -   10s
H    0     0                    -22621.06655 -7449.4803  67.1%     -   10s
H    0     0                    -22616.11830 -7449.4803  67.1%     -   10s
H    0     0                    -22610.13648 -7449.4803  67.1%     -   10s
     0     0 -7826.3562    0  803 -22610.136 -7826.3562  65.4%     -   12s
     0     0 -7838.9455    0  799 -22610.136 -7838.9455  65.3%     -   12s
     0     0 -7849.6792    0  820 -22610.136 -7849.6792  65.3%     -   12s
     0     0 -7850.5244    0  817 -22610.136 -7850.5244  65.3%     -   13s
H    0     0                    -22159.91324 -7850.5244  64.6%     -   14s
H    0     0                    -22012.44634 -7850.5244  64.3%     -   14s
H    0     0                    -21718.43304 -7850.5244  63.9%     -   14s
     0     0 -9896.9331    0  542 -21718.433 -9896.9331  54.4%     -   17s
H    0     0                    -20728.10956 -9898.1231  52.2%     -   17s
H    0     0                    -19730.50767 -9898.1231  49.8%     -   17s
H    0     0                    -19671.79619 -9898.1231  49.7%     -   17s
H    0     0                    -18294.09445 -10536.898  42.4%     -   19s
H    0     0                    -17882.52742 -10536.898  41.1%     -   19s
H    0     0                    -17866.88400 -10536.898  41.0%     -   19s
H    0     0                    -17563.41700 -10536.898  40.0%     -   19s
H    0     0                    -17030.52847 -10536.898  38.1%     -   19s
     0     0 -10536.898    0  752 -17030.528 -10536.898  38.1%     -   19s
     0     0 -10648.906    0  674 -17030.528 -10648.906  37.5%     -   19s
     0     0 -10672.566    0  679 -17030.528 -10672.566  37.3%     -   20s
H    0     0                    -17017.47717 -10682.669  37.2%     -   20s
H    0     0                    -17015.35145 -10682.669  37.2%     -   20s
     0     0 -10682.669    0  677 -17015.351 -10682.669  37.2%     -   20s
     0     0 -10683.475    0  676 -17015.351 -10683.475  37.2%     -   20s
     0     0 -11325.942    0  528 -17015.351 -11325.942  33.4%     -   24s
H    0     0                    -16988.55914 -11326.728  33.3%     -   24s
     0     0 -11514.190    0  561 -16988.559 -11514.190  32.2%     -   25s
     0     0 -11545.631    0  637 -16988.559 -11545.631  32.0%     -   26s
     0     0 -11556.459    0  560 -16988.559 -11556.459  32.0%     -   26s
     0     0 -11557.230    0  565 -16988.559 -11557.230  32.0%     -   26s
     0     0 -11890.086    0  608 -16988.559 -11890.086  30.0%     -   28s
H    0     0                    -16987.69942 -11890.376  30.0%     -   28s
H    0     0                    -16983.47712 -11890.376  30.0%     -   28s
     0     0 -11942.907    0  522 -16983.477 -11942.907  29.7%     -   29s
     0     0 -11951.724    0  715 -16983.477 -11951.724  29.6%     -   29s
     0     0 -11952.511    0  717 -16983.477 -11952.511  29.6%     -   29s
H    0     0                    -16973.36712 -12044.184  29.0%     -   31s
     0     0 -12044.184    0  687 -16973.367 -12044.184  29.0%     -   31s
H    0     0                    -16949.68914 -12044.218  28.9%     -   31s
     0     0 -12096.907    0  532 -16949.689 -12096.907  28.6%     -   31s
     0     0 -12104.585    0  796 -16949.689 -12104.585  28.6%     -   32s
     0     0 -12109.112    0  804 -16949.689 -12109.112  28.6%     -   32s
     0     0 -12182.180    0  802 -16949.689 -12182.180  28.1%     -   33s
H    0     0                    -16918.13037 -12182.362  28.0%     -   33s
     0     0 -12191.313    0  516 -16918.130 -12191.313  27.9%     -   34s
     0     0 -12195.708    0  508 -16918.130 -12195.708  27.9%     -   34s
     0     0 -12241.598    0  603 -16918.130 -12241.598  27.6%     -   35s
     0     0 -12257.663    0  531 -16918.130 -12257.663  27.5%     -   35s
     0     0 -12262.345    0  613 -16918.130 -12262.345  27.5%     -   36s
     0     0 -12362.077    0  729 -16918.130 -12362.077  26.9%     -   37s
     0     0 -12387.792    0  617 -16918.130 -12387.792  26.8%     -   38s
     0     0 -12393.575    0  523 -16918.130 -12393.575  26.7%     -   38s
     0     0 -12419.947    0  704 -16918.130 -12419.947  26.6%     -   39s
     0     0 -12434.810    0  518 -16918.130 -12434.810  26.5%     -   40s
     0     0 -12437.789    0  535 -16918.130 -12437.789  26.5%     -   40s
     0     0 -12465.164    0  526 -16918.130 -12465.164  26.3%     -   41s
     0     0 -12474.292    0  532 -16918.130 -12474.292  26.3%     -   41s
     0     0 -12478.128    0  541 -16918.130 -12478.128  26.2%     -   41s
     0     0 -12527.305    0  551 -16918.130 -12527.305  26.0%     -   42s
     0     0 -12528.203    0  551 -16918.130 -12528.203  25.9%     -   43s
     0     2 -12528.203    0  551 -16918.130 -12528.203  25.9%     -   50s
    25    26 -14903.055    5  447 -16918.130 -13929.302  17.7%   901   55s
H   54    20                    -16911.00499 -14679.351  13.2%   615   56s
H  138    35                    -16905.41971 -15526.705  8.16%   444   58s
   273    34 -16730.000   12   90 -16905.420 -15666.306  7.33%   335   60s
H 2634   444                    -16895.26310 -16798.920  0.57%  61.2   62s
H 3612   429                    -16885.14423 -16822.092  0.37%  48.8   63s
  4862   259     cutoff   35      -16885.144 -16831.791  0.32%  40.0   65s

Cutting planes:
  Learned: 2
  Gomory: 3
  Implied bound: 14
  MIR: 1694
  Flow cover: 836
  Zero half: 30
  RLT: 78
  Relax-and-lift: 181

Explored 5979 nodes (257430 simplex iterations) in 65.70 seconds (83.89 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -16885.1 -16895.3 -16905.4 ... -16988.6
No other solutions better than -16885.1

Optimal solution found (tolerance 1.00e-06)
Best objective -1.688514423050e+04, best bound -1.688514423050e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 0) = 1.0000
  Master solved in 65.71s
  Master Objective (UB) = -16885.14, θ = 93986.25
  Upper Bound (UB) = -16885.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93986.25
  [DEBUG]   ✓ Scenario 0: θ = 93986.25 ≤ Q = 93986.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93986.25 ≤ Q = 93986.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0xafd87f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x00afd87f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.364465e+13
Presolve removed 2656 rows and 1952 columns
Presolve time: 0.01s
Presolved: 437 rows, 437 columns, 1230 nonzeros
Found heuristic solution: objective 6321378.3713
Variable types: 293 continuous, 144 integer (144 binary)

Root relaxation: objective -1.133239e+05, 275 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -113323.94    0  125 6321378.37 -113323.94   102%     -    0s
H    0     0                    -77128.75709 -113323.94  46.9%     -    0s
H    0     0                    -78415.48766 -113323.94  44.5%     -    0s
H    0     0                    -92699.07118 -113323.94  22.2%     -    0s
H    0     0                    -92776.75920 -102875.41  10.9%     -    0s
     0     0 -102875.41    0  118 -92776.759 -102875.41  10.9%     -    0s
H    0     0                    -100116.9135 -102871.26  2.75%     -    0s
     0     0 -102624.97    0  112 -100116.91 -102624.97  2.51%     -    0s
     0     0 -102151.28    0   99 -100116.91 -102151.28  2.03%     -    0s
H    0     0                    -101058.1878 -102151.28  1.08%     -    0s
H    0     0                    -101127.2335 -102013.47  0.88%     -    0s
     0     0 -101974.07    0   95 -101127.23 -101974.07  0.84%     -    0s
     0     0 -101974.07    0  107 -101127.23 -101974.07  0.84%     -    0s
     0     0 -101680.70    0   63 -101127.23 -101680.70  0.55%     -    0s
     0     0 -101656.78    0   69 -101127.23 -101656.78  0.52%     -    0s
     0     0 -101456.90    0   33 -101127.23 -101456.90  0.33%     -    0s
     0     0 -101388.63    0   36 -101127.23 -101388.63  0.26%     -    0s
     0     0 -101388.53    0   36 -101127.23 -101388.53  0.26%     -    0s
     0     0 -101137.48    0    3 -101127.23 -101137.48  0.01%     -    0s
     0     0 -101136.70    0    2 -101127.23 -101136.70  0.01%     -    0s
H    0     0                    -101133.8417 -101134.41  0.00%     -    0s
     0     0 -101134.41    0    2 -101133.84 -101134.41  0.00%     -    0s

Cutting planes:
  Gomory: 8
  Implied bound: 22
  MIR: 71
  Flow cover: 10
  RLT: 120
  Relax-and-lift: 9
  BQP: 5

Explored 1 nodes (829 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 32 available processors)

Solution count 9: -101134 -101127 -101058 ... 1.36446e+13
No other solutions better than -101134

Optimal solution found (tolerance 1.00e-06)
Best objective -1.011338417084e+05, best bound -1.011338417084e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 72727.29
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101133.84
  [DEBUG]   S×d_nominal = 173861.13
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 173861.13 + -101133.84 = 72727.29
  [DEBUG]   Current θ from Master = 93986.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 21258.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -38144.11
  Lower Bound (LB) = -22820.27
  Gap (UB-LB) = 5935.1268, Absolute Gap = 5935.1268, Relative Gap = 0.351500
  Not converged yet (gap = 5935.13 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135140 nonzeros
Model fingerprint: 0xb6f03014
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-02, 9e+03]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -38144.1 (0.03s)
MIP start from previous solve produced solution with objective -38144.1 (0.03s)
Loaded MIP start from previous solve with objective -38144.1

Presolve removed 23634 rows and 9594 columns
Presolve time: 0.57s
Presolved: 23619 rows, 11386 columns, 131849 nonzeros
Variable types: 9127 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   26002   -2.8865738e+02   0.000000e+00   6.899157e+08      5s
Concurrent spin time: 0.45s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   15675    2.7032337e+03   0.000000e+00   0.000000e+00      6s

Root relaxation: objective 2.703234e+03, 15675 iterations, 5.55 seconds (7.24 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 2703.23373    0  426 -38144.109 2703.23373   107%     -    6s
H    0     0                    -33693.48549 2703.23373   108%     -    6s
H    0     0                    -30522.06979 2703.23373   109%     -    6s
H    0     0                    -30064.05043 2703.23373   109%     -    6s
H    0     0                    -28832.55480 2703.23373   109%     -    6s
H    0     0                    -28761.19647 2703.23373   109%     -    6s
H    0     0                    -27875.50022 2703.23373   110%     -    7s
H    0     0                    -27862.38344 2703.23373   110%     -    7s
H    0     0                    -27837.11418 2703.23373   110%     -    7s
H    0     0                    -27823.16188 2703.23373   110%     -    7s
     0     0 -4110.1535    0  710 -27823.162 -4110.1535  85.2%     -   12s
     0     0 -4171.3053    0  702 -27823.162 -4171.3053  85.0%     -   12s
     0     0 -4177.8820    0  704 -27823.162 -4177.8820  85.0%     -   13s
     0     0 -4179.9329    0  698 -27823.162 -4179.9329  85.0%     -   13s
     0     0 -4180.0485    0  698 -27823.162 -4180.0485  85.0%     -   13s
     0     0 -8520.6919    0  782 -27823.162 -8520.6919  69.4%     -   18s
     0     0 -8886.5308    0  775 -27823.162 -8886.5308  68.1%     -   20s
     0     0 -8934.9426    0  772 -27823.162 -8934.9426  67.9%     -   20s
     0     0 -8956.5512    0  780 -27823.162 -8956.5512  67.8%     -   21s
     0     0 -8959.9892    0  781 -27823.162 -8959.9892  67.8%     -   21s
     0     0 -8960.5786    0  779 -27823.162 -8960.5786  67.8%     -   21s
H    0     0                    -27820.83056 -8960.5786  67.8%     -   23s
H    0     0                    -27814.00337 -8960.5786  67.8%     -   23s
H    0     0                    -27801.85589 -11566.316  58.4%     -   27s
H    0     0                    -27798.40923 -11566.316  58.4%     -   27s
H    0     0                    -27791.80524 -11566.316  58.4%     -   27s
     0     0 -11566.316    0  559 -27791.805 -11566.316  58.4%     -   27s
     0     0 -12126.516    0  652 -27791.805 -12126.516  56.4%     -   30s
     0     0 -12271.348    0  729 -27791.805 -12271.348  55.8%     -   31s
     0     0 -12299.982    0  812 -27791.805 -12299.982  55.7%     -   32s
     0     0 -12311.600    0  669 -27791.805 -12311.600  55.7%     -   32s
     0     0 -12314.693    0  666 -27791.805 -12314.693  55.7%     -   32s
H    0     0                    -24697.99751 -13358.905  45.9%     -   40s
H    0     0                    -24499.48961 -13358.905  45.5%     -   40s
     0     0 -13358.905    0  558 -24499.490 -13358.905  45.5%     -   40s
H    0     0                    -24050.33197 -13360.688  44.4%     -   40s
H    0     0                    -24025.15135 -13704.243  43.0%     -   43s
H    0     0                    -24021.76552 -13704.243  43.0%     -   43s
H    0     0                    -24015.17014 -13704.243  42.9%     -   43s
H    0     0                    -24011.78431 -13704.243  42.9%     -   43s
H    0     0                    -23919.88250 -13704.243  42.7%     -   43s
H    0     0                    -23849.62596 -13704.243  42.5%     -   43s
H    0     0                    -23842.57599 -13704.243  42.5%     -   43s
H    0     0                    -23839.19015 -13704.243  42.5%     -   43s
H    0     0                    -23817.04435 -13704.243  42.5%     -   43s
H    0     0                    -23809.99438 -13704.243  42.4%     -   43s
H    0     0                    -23806.60855 -13704.243  42.4%     -   43s
H    0     0                    -23758.50993 -13704.243  42.3%     -   43s
H    0     0                    -23709.58347 -13704.243  42.2%     -   43s
H    0     0                    -23668.80463 -13704.243  42.1%     -   43s
H    0     0                    -23665.41880 -13704.243  42.1%     -   43s
     0     0 -13704.243    0  666 -23665.419 -13704.243  42.1%     -   43s
H    0     0                    -23321.49703 -13850.756  40.6%     -   44s
H    0     0                    -23296.30635 -13850.756  40.5%     -   44s
     0     0 -13850.756    0  780 -23296.306 -13850.756  40.5%     -   44s
     0     0 -13882.954    0  876 -23296.306 -13882.954  40.4%     -   45s
     0     0 -13890.274    0  882 -23296.306 -13890.274  40.4%     -   46s
     0     0 -13896.781    0  891 -23296.306 -13896.781  40.3%     -   46s
     0     0 -13898.464    0  892 -23296.306 -13898.464  40.3%     -   47s
H    0     0                    -22829.66432 -14434.684  36.8%     -   51s
     0     0 -14434.684    0  570 -22829.664 -14434.684  36.8%     -   51s
H    0     0                    -22722.29696 -14434.745  36.5%     -   51s
     0     0 -14505.510    0  571 -22722.297 -14505.510  36.2%     -   52s
     0     0 -14520.348    0  577 -22722.297 -14520.348  36.1%     -   53s
     0     0 -14526.058    0  590 -22722.297 -14526.058  36.1%     -   54s
H    0     0                    -22705.51873 -14850.267  34.6%     -   57s
H    0     0                    -22639.64485 -14850.267  34.4%     -   57s
     0     0 -14850.267    0  590 -22639.645 -14850.267  34.4%     -   57s
     0     0 -14896.832    0  681 -22639.645 -14896.832  34.2%     -   58s
     0     0 -14921.686    0  579 -22639.645 -14921.686  34.1%     -   59s
     0     0 -14924.144    0  584 -22639.645 -14924.144  34.1%     -   59s
     0     0 -15025.369    0  562 -22639.645 -15025.369  33.6%     -   61s
H    0     0                    -22610.13648 -15050.588  33.4%     -   62s
H    0     0                    -22599.34230 -15050.588  33.4%     -   62s
     0     0 -15050.588    0  559 -22599.342 -15050.588  33.4%     -   62s
     0     0 -15056.251    0  563 -22599.342 -15056.251  33.4%     -   62s
     0     0 -15088.974    0  561 -22599.342 -15088.974  33.2%     -   64s
     0     0 -15105.904    0  576 -22599.342 -15105.904  33.2%     -   65s
     0     0 -15120.244    0  579 -22599.342 -15120.244  33.1%     -   66s
     0     0 -15126.866    0  586 -22599.342 -15126.866  33.1%     -   67s
     0     0 -15129.391    0  593 -22599.342 -15129.391  33.1%     -   67s
     0     0 -15151.351    0  570 -22599.342 -15151.351  33.0%     -   68s
     0     0 -15151.601    0  570 -22599.342 -15151.601  33.0%     -   69s
     0     2 -15151.601    0  570 -22599.342 -15151.601  33.0%     -   83s
     1     4 -15514.836    1  474 -22599.342 -15151.630  33.0%  5066   86s
     7    16 -16648.628    3  778 -22599.342 -15790.442  30.1%  3126   93s
    15    30 -16913.840    4  672 -22599.342 -15927.030  29.5%  2463   96s
    31    56 -18363.487    5  558 -22599.342 -16091.108  28.8%  2991  101s
    93   122 -18770.738    7  575 -22599.342 -16680.048  26.2%  2392  107s
   127   159 -18818.426    8  573 -22599.342 -16680.223  26.2%  1954  111s
   264   281 -19161.639   11  319 -22599.342 -16686.469  26.2%  1335  116s
   438   385 -20356.183   18  332 -22599.342 -16686.469  26.2%  1025  121s
   561   467 -21213.557   22  246 -22599.342 -16821.037  25.6%   949  125s
   691   505 -21291.457   27  235 -22599.342 -16868.175  25.4%   884  130s
   846   613     cutoff   31      -22599.342 -16917.857  25.1%   831  136s
  1016   719     cutoff   39      -22599.342 -16919.899  25.1%   779  140s
  1184   730     cutoff   21      -22599.342 -17023.374  24.7%   763  148s
  1264   738 -18970.917   13  321 -22599.342 -17038.405  24.6%   774  150s
  1412   810 -19702.228   17  254 -22599.342 -17094.456  24.4%   801  157s
  1505   828     cutoff   19      -22599.342 -17112.481  24.3%   800  165s
  1722   886 -20509.546   15  343 -22599.342 -17147.673  24.1%   796  171s
  1870   890 -21269.677   19  292 -22599.342 -17233.073  23.7%   779  175s
  2093   914 -20692.621   15  375 -22599.342 -17318.952  23.4%   787  182s
  2197   920 -21099.616   16  397 -22599.342 -17318.952  23.4%   795  186s
  2451   942     cutoff   17      -22599.342 -17318.952  23.4%   804  194s
  2561   949     cutoff   18      -22599.342 -17543.759  22.4%   809  198s
  2734   966 -20665.456   17  333 -22599.342 -17556.043  22.3%   801  201s
  2900   974 -21597.489   21  262 -22599.342 -17705.626  21.7%   796  206s
  3086   985 -22074.924   18  242 -22599.342 -17772.033  21.4%   789  210s
  3484   999 -19812.166   19  263 -22599.342 -17954.503  20.6%   776  217s
  3686  1006 -22381.282   21  328 -22599.342 -17954.503  20.6%   771  221s
  3863  1011     cutoff   21      -22599.342 -18180.182  19.6%   766  225s
  4099  1044 -19843.600   33  210 -22599.342 -18244.139  19.3%   758  234s
  4215  1041 -20416.936   34  307 -22599.342 -18497.861  18.1%   751  237s
  4432  1054 -19529.487   30  308 -22599.342 -18597.322  17.7%   742  242s
  4779  1048 -19236.769    8  539 -22599.342 -18771.815  16.9%   723  246s
  5183  1027     cutoff    9      -22599.342 -19140.997  15.3%   702  251s
  5594  1061 -22370.449   15  229 -22599.342 -19352.891  14.4%   686  256s
  6046  1046 -21180.924   18  244 -22599.342 -19352.891  14.4%   666  262s
  6478   902     cutoff   38      -22599.342 -19876.316  12.0%   652  266s
  7009   812 -20880.351   17  290 -22599.342 -20242.322  10.4%   632  271s
  7636   691 -22471.935    8  305 -22599.342 -20399.674  9.73%   607  275s
  8231   467     cutoff   20      -22599.342 -20957.576  7.26%   587  280s
 10971   479     cutoff   17      -22599.342 -21531.764  4.72%   472  285s

Cutting planes:
  Learned: 1
  Gomory: 3
  Implied bound: 15
  MIR: 2096
  Flow cover: 1671
  Zero half: 12
  RLT: 135
  Relax-and-lift: 424

Explored 15475 nodes (5380327 simplex iterations) in 287.20 seconds (500.12 work units)
Thread count was 32 (of 32 available processors)

Solution count 10: -22599.3 -22610.1 -22639.6 ... -23668.8
No other solutions better than -22599.3

Optimal solution found (tolerance 1.00e-06)
Best objective -2.259934230375e+04, best bound -2.259934230375e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 287.21s
  Master Objective (UB) = -22599.34, θ = 93308.56
  Upper Bound (UB) = -22599.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 93308.56
  [DEBUG]   ✓ Scenario 0: θ = 93308.56 ≤ Q = 93308.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 93308.56 ≤ Q = 93308.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 93308.56 ≤ Q = 93308.56 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x4562e27a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 7302 16-Core Processor, instruction set [SSE2|AVX|AVX2]
Thread count: 32 physical cores, 32 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xba9d1d86
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.594741e+13
Presolve removed 2652 rows and 1946 columns
Presolve time: 0.01s
Presolved: 441 rows, 443 columns, 1242 nonzeros
Found heuristic solution: objective 7489668.9302
Variable types: 299 continuous, 144 integer (144 binary)

Root relaxation: objective -1.117985e+05, 225 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -111798.46    0  123 7489668.93 -111798.46   101%     -    0s
H    0     0                    -83187.93537 -111798.46  34.4%     -    0s
H    0     0                    -83357.51473 -111798.46  34.1%     -    0s
H    0     0                    -84673.24191 -84673.242  0.00%     -    0s
     0     0          -    0      -84673.242 -84673.242  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 195

Explored 1 nodes (363 simplex iterations) in 0.02 seconds (0.01 work units)
Thread count was 32 (of 32 available processors)

Solution count 5: -84673.2 -83357.5 -83187.9 ... 1.59474e+13
No other solutions better than -84673.2

Optimal solution found (tolerance 1.00e-06)
Best objective -8.467324190547e+04, best bound -8.467324190547e+04, gap 0.0000%
  Subproblem solved in 0.05s
  Worst-case operational profit (Z_SP) = 93302.41
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -84673.24
  [DEBUG]   S×d_nominal = 177975.65
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 177975.65 + -84673.24 = 93302.41
  [DEBUG]   Current θ from Master = 93308.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6.16 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -22605.50
  Lower Bound (LB) = -22605.50
  Gap (UB-LB) = 6.1569, Absolute Gap = 6.1569, Relative Gap = 0.000272
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 3
Total Time: 553.92s
Converged: True
Final Lower Bound: -22605.4992
Final Upper Bound: -22599.3423
Final Gap: 6.156875
Number of Critical Scenarios: 3
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [0] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [8, 9] (2/10)
Active Routes (Plant→DC): 6
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 12 customers  Mode 1: 8 customers  Mode 2: 30 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 3
Start Time: 2026-01-04 09:45:28
End Time: 2026-01-04 09:54:42
Total Time: 553.92s
Optimal Value: -22605.50
Lower Bound: -22605.50
Upper Bound: -22599.34
Gap: 6.156875
Plants Opened: {0: [1], 1: [0], 2: [1]} (3 plants)
DCs Opened: [8, 9] (2 DCs)
================================================================================

Results saved to: result/DH_single_full_seed3_LD_gamma20_20260104_095442.csv

Total Execution Time: 554.13 seconds
End Time: 2026-01-04 09:54:42

All tasks completed successfully!

