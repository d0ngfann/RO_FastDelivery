
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 25
DI Scenario: HD
Start Time: 2026-01-03 12:05:42
================================================================================
Loading data from data/DH_data_full_seed25.pkl...

Applying DI scenario: HD
DI values:
  Product 0: ['1.000', '1.421', '2.021'] (k=0.867)
  Product 1: ['1.000', '1.424', '2.028'] (k=0.872)
  Product 2: ['1.000', '1.372', '1.882'] (k=0.780)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=941, max=1710
  DC capacity (MC): min=405, max=850

Demand Structure (s_rk matrix):
  Total customer-product pairs: 76/150 (49.3% sparse)
  Average products per customer: 1.52

Demand (only non-zero entries):
  Nominal (μ): min=8.28, max=34.84, count=76
  Deviation (μ̂): min=4.00, max=9.95

Costs:
  Plant fixed cost: min=5742, max=9721
  DC fixed cost: min=3176, max=5734
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.421', '2.021'] (k=0.867)
    Product 1: ['1.000', '1.424', '2.028'] (k=0.872)
    Product 2: ['1.000', '1.372', '1.882'] (k=0.780)
  MD:
    Product 0: ['1.000', '1.220', '1.489'] (k=0.491)
    Product 1: ['1.000', '1.185', '1.405'] (k=0.419)
    Product 2: ['1.000', '1.249', '1.560'] (k=0.549)
  LD:
    Product 0: ['1.000', '1.013', '1.025'] (k=0.031)
    Product 1: ['1.000', '1.042', '1.086'] (k=0.102)
    Product 2: ['1.000', '1.116', '1.245'] (k=0.270)
  Mixed:
    Product 0: ['1.000', '1.421', '2.021'] (k=0.867)
    Product 1: ['1.000', '1.185', '1.405'] (k=0.419)
    Product 2: ['1.000', '1.116', '1.245'] (k=0.270)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48738 nonzeros
Model fingerprint: 0x31641912
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 12035 rows and 3035 columns
Presolve time: 0.16s
Presolved: 4638 rows, 5465 columns, 32308 nonzeros
Variable types: 3206 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -267836.0523
Found heuristic solution: objective -182931.6033

Root relaxation: objective 1.319693e+05, 5374 iterations, 0.28 seconds (0.47 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 131969.348    0  668 -182931.60 131969.348   172%     -    0s
H    0     0                    -180863.0308 131969.348   173%     -    0s
H    0     0                    -173758.0596 124202.992   171%     -    1s
     0     0 124202.992    0  774 -173758.06 124202.992   171%     -    1s
     0     0 123928.625    0  764 -173758.06 123928.625   171%     -    1s
     0     0 123904.716    0  770 -173758.06 123904.716   171%     -    1s
     0     0 123888.734    0  773 -173758.06 123888.734   171%     -    1s
     0     0 123888.290    0  770 -173758.06 123888.290   171%     -    1s
     0     0 118742.208    0  920 -173758.06 118742.208   168%     -    2s
     0     0 118377.698    0  917 -173758.06 118377.698   168%     -    2s
     0     0 118217.336    0  923 -173758.06 118217.336   168%     -    2s
     0     0 118189.913    0  920 -173758.06 118189.913   168%     -    2s
     0     0 118184.313    0  924 -173758.06 118184.313   168%     -    2s
     0     0 118184.140    0  929 -173758.06 118184.140   168%     -    2s
H    0     0                    -167597.1723 114064.039   168%     -    3s
     0     0 114064.039    0  976 -167597.17 114064.039   168%     -    3s
     0     0 113706.783    0  959 -167597.17 113706.783   168%     -    4s
     0     0 113658.551    0  952 -167597.17 113658.551   168%     -    4s
     0     0 113644.461    0  962 -167597.17 113644.461   168%     -    4s
     0     0 113643.927    0  966 -167597.17 113643.927   168%     -    4s
H    0     0                    -93792.77955 108669.116   216%     -    5s
H    0     0                    -87832.11468 108669.116   224%     -    5s
H    0     0                    -73710.38078 108669.116   247%     -    5s
H    0     0                    -67899.17725 108669.116   260%     -    5s
H    0     0                    34666.348970 108669.116   213%     -    5s
     0     0 108669.116    0  838 34666.3490 108669.116   213%     -    5s
     0     0 108376.778    0  861 34666.3490 108376.778   213%     -    6s
     0     0 108308.214    0  886 34666.3490 108308.214   212%     -    6s
     0     0 108297.042    0  880 34666.3490 108297.042   212%     -    6s
     0     0 91112.6570    0  574 34666.3490 91112.6570   163%     -    7s
H    0     0                    34896.097207 89217.7042   156%     -    8s
H    0     0                    34969.529519 89217.7042   155%     -    8s
H    0     0                    35432.505484 89217.7042   152%     -    8s
H    0     0                    35456.455352 89217.7042   152%     -    8s
H    0     0                    35700.172865 89217.7042   150%     -    8s
H    0     0                    35843.642237 89217.7042   149%     -    8s
H    0     0                    36234.846260 89217.7042   146%     -    8s
H    0     0                    36378.624942 89217.7042   145%     -    8s
H    0     0                    36390.649586 89217.7042   145%     -    8s
H    0     0                    36446.301260 89217.7042   145%     -    8s
H    0     0                    36579.629949 89217.7042   144%     -    8s
H    0     0                    36709.022804 89217.7042   143%     -    8s
     0     0 89217.7042    0  576 36709.0228 89217.7042   143%     -    8s
H    0     0                    36765.572637 88880.8701   142%     -    8s
H    0     0                    37082.264005 88880.8701   140%     -    8s
     0     0 88880.8701    0  625 37082.2640 88880.8701   140%     -    8s
     0     0 88796.7404    0  677 37082.2640 88796.7404   139%     -    8s
     0     0 88775.5626    0  689 37082.2640 88775.5626   139%     -    8s
     0     0 88769.4051    0  657 37082.2640 88769.4051   139%     -    8s
     0     0 82307.5866    0  645 37082.2640 82307.5866   122%     -    9s
     0     0 81655.0663    0  600 37082.2640 81655.0663   120%     -    9s
     0     0 81375.8049    0  580 37082.2640 81375.8049   119%     -   10s
     0     0 81285.6961    0  602 37082.2640 81285.6961   119%     -   10s
     0     0 81278.7151    0  607 37082.2640 81278.7151   119%     -   10s
H    0     0                    38134.551614 79967.1112   110%     -   10s
     0     0 79967.1112    0  485 38134.5516 79967.1112   110%     -   10s
H    0     0                    38136.209371 79585.2894   109%     -   11s
     0     0 79585.2894    0  614 38136.2094 79585.2894   109%     -   11s
H    0     0                    39838.190848 79453.3371  99.4%     -   11s
H    0     0                    39925.746850 79453.3371  99.0%     -   11s
     0     0 79453.3371    0  645 39925.7468 79453.3371  99.0%     -   11s
H    0     0                    40021.808210 79410.8682  98.4%     -   11s
     0     0 79410.8682    0  684 40021.8082 79410.8682  98.4%     -   11s
     0     0 79402.9156    0  708 40021.8082 79402.9156  98.4%     -   11s
H    0     0                    40070.940775 78349.3962  95.5%     -   12s
H    0     0                    41543.554325 78349.3962  88.6%     -   12s
     0     0 78349.3962    0  634 41543.5543 78349.3962  88.6%     -   12s
H    0     0                    41911.288000 78089.1432  86.3%     -   12s
     0     0 78089.1432    0  695 41911.2880 78089.1432  86.3%     -   12s
H    0     0                    41913.443930 78010.2668  86.1%     -   12s
     0     0 78010.2668    0  686 41913.4439 78010.2668  86.1%     -   12s
H    0     0                    41993.932272 77979.3541  85.7%     -   12s
H    0     0                    42081.454937 77979.3541  85.3%     -   12s
H    0     0                    42199.974093 77979.3541  84.8%     -   12s
     0     0 77979.3541    0  706 42199.9741 77979.3541  84.8%     -   12s
     0     0 77404.5848    0  637 42199.9741 77404.5848  83.4%     -   13s
     0     0 77161.8512    0  723 42199.9741 77161.8512  82.8%     -   13s
     0     0 77080.5865    0  735 42199.9741 77080.5865  82.7%     -   14s
     0     0 77054.7469    0  728 42199.9741 77054.7469  82.6%     -   14s
H    0     0                    42370.900099 76555.1522  80.7%     -   14s
     0     0 76555.1522    0  681 42370.9001 76555.1522  80.7%     -   14s
     0     0 76414.7419    0  720 42370.9001 76414.7419  80.3%     -   15s
     0     0 76391.9336    0  748 42370.9001 76391.9336  80.3%     -   15s
     0     0 76138.2756    0  572 42370.9001 76138.2756  79.7%     -   16s
     0     0 76032.9494    0  701 42370.9001 76032.9494  79.4%     -   16s
     0     0 75968.9102    0  705 42370.9001 75968.9102  79.3%     -   16s
     0     0 75956.0978    0  717 42370.9001 75956.0978  79.3%     -   16s
     0     0 75787.1578    0  673 42370.9001 75787.1578  78.9%     -   17s
     0     0 75786.5698    0  673 42370.9001 75786.5698  78.9%     -   17s
     0     2 75786.1935    0  673 42370.9001 75786.1935  78.9%     -   18s
     7    16 74298.5231    3  657 42370.9001 75497.3929  78.2%  1716   20s
H   32    64                    42406.946904 75178.4374  77.3%  2493   23s
H   37    64                    42419.744134 75177.6924  77.2%  2318   23s
H   44    64                    43234.479830 75177.6924  73.9%  2076   23s
H   95   222                    44160.855994 75096.8918  70.1%  1961   25s
H  112   222                    44198.769970 75096.8918  69.9%  1758   25s
H  136   222                    49793.290924 75096.8918  50.8%  1558   25s
H  145   222                    50655.350670 75096.8918  48.3%  1484   25s
H  347   381                    50722.680531 75096.8918  48.1%  1000   29s
   380   481 71845.7397   10  581 50722.6805 75096.8918  48.1%   995   30s
H  710   728                    52787.496614 75096.8918  42.3%   819   32s
  1265  1312 67260.7957   18  486 52787.4966 74982.1845  42.0%   596   35s
  2317  2247 57161.5372   32  312 52787.4966 73978.6224  40.1%   481   40s
  3140  2870 65084.8572    9  508 52787.4966 73553.5072  39.3%   450   45s
H 3503  3000                    52796.078436 73553.5072  39.3%   451   53s
  3504  3001 61562.5148   31  673 52796.0784 73553.5072  39.3%   451   58s
  3522  3013 55983.3438   78  406 52796.0784 70221.8735  33.0%   449   60s
  3598  3081 67536.3162   19  364 52796.0784 68800.2240  30.3%   453   65s
H 3798  3024                    53222.028759 66407.0313  24.8%   452   66s
H 4058  2937                    54121.276658 66407.0313  22.7%   440   67s
H 4060  2800                    54575.643598 66407.0313  21.7%   440   67s
H 4061  2668                    54649.646385 66407.0313  21.5%   440   67s
H 4086  2537                    55173.515975 66391.5068  20.3%   439   67s
H 4180  2407                    55308.138872 65430.6565  18.3%   434   67s
H 4193  2290                    55406.914262 65430.6565  18.1%   434   67s
H 4202  2181                    55446.382965 65430.6565  18.0%   433   67s
H 4415  2106                    55471.080378 65430.6565  18.0%   426   68s
H 4416  2010                    55511.304014 65430.6565  17.9%   426   68s
H 4443  1910                    55751.107361 64653.4596  16.0%   424   68s
H 4794  1794                    55767.676197 64653.0357  15.9%   411   69s
  4841  1806 57712.3053   24  237 55767.6762 64404.3303  15.5%   409   70s
H 5528  1601                    55803.628626 63524.5092  13.8%   382   71s
H 5946  1439                    55885.718843 62347.6933  11.6%   368   72s
  7719   762 56305.4890   25  187 55885.7188 60313.8644  7.92%   328   75s
*15727  2445              79    55885.821394 56122.2990  0.42%   187   77s
H17105  2437                    55889.849377 56104.8638  0.38%   173   77s
H19566  2575                    55899.541909 56061.2361  0.29%   154   77s

Cutting planes:
  Gomory: 1
  Implied bound: 6
  Projected implied bound: 8
  MIR: 372
  Mixing: 1
  Flow cover: 411
  RLT: 8
  Relax-and-lift: 45

Explored 28003 nodes (3251265 simplex iterations) in 79.42 seconds (170.86 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 55899.5 55889.8 55885.8 ... 55446.4

Optimal solution found (tolerance 1.00e-06)
Best objective 5.589954190914e+04, best bound 5.589954190914e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 79.43s
  Master Objective (UB) = 55899.54, θ = 205373.05
  Upper Bound (UB) = 55899.54

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 205373.05
  [DEBUG]   ✓ Scenario 0: θ = 205373.05 ≤ Q = 205373.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7bf6b7e6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8409481a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.347523e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.00s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6261970.0704
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6261640.7261

Root relaxation: objective -1.478597e+05, 228 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147859.69    0  123 6261640.73 -147859.69   102%     -    0s
H    0     0                    -96556.59872 -147859.69  53.1%     -    0s
H    0     0                    -96885.94308 -147859.69  52.6%     -    0s
H    0     0                    -97147.19216 -147859.69  52.2%     -    0s
H    0     0                    -97476.53651 -147859.69  51.7%     -    0s
H    0     0                    -97774.50084 -147593.31  51.0%     -    0s
H    0     0                    -98558.38470 -119583.64  21.3%     -    0s
H    0     0                    -110758.9634 -119583.64  7.97%     -    0s
H    0     0                    -119583.6385 -119583.64  0.00%     -    0s
     0     0          -    0      -119583.64 -119583.64  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 198

Explored 1 nodes (359 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119584 -110759 -98558.4 ... 6.26197e+06
No other solutions better than -119584

Optimal solution found (tolerance 1.00e-06)
Best objective -1.195836384589e+05, best bound -1.195836384589e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 173387.33
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119583.64
  [DEBUG]   S×d_nominal = 292970.97
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 292970.97 + -119583.64 = 173387.33
  [DEBUG]   Current θ from Master = 205373.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 31985.72 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 23913.83
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 31985.7160, Absolute Gap = 31985.7160, Relative Gap = 0.572200
  Not converged yet (gap = 31985.72 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91957 nonzeros
Model fingerprint: 0x9b6e45ad
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 23913.8 (0.01s)
MIP start from previous solve produced solution with objective 23913.8 (0.01s)
Loaded MIP start from previous solve with objective 23913.8

Presolve removed 14949 rows and 6068 columns
Presolve time: 0.29s
Presolved: 17014 rows, 8672 columns, 94038 nonzeros
Variable types: 6413 continuous, 2259 integer (2259 binary)

Root relaxation: objective 6.985466e+04, 8511 iterations, 0.91 seconds (1.81 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 69854.6601    0  246 23913.8259 69854.6601   192%     -    1s
H    0     0                    38635.653461 69854.6601  80.8%     -    1s
     0     0 63001.1850    0  274 38635.6535 63001.1850  63.1%     -    2s
     0     0 62697.8976    0  282 38635.6535 62697.8976  62.3%     -    2s
     0     0 62694.9593    0  284 38635.6535 62694.9593  62.3%     -    2s
     0     0 62694.8556    0  385 38635.6535 62694.8556  62.3%     -    2s
     0     0 56504.4445    0  291 38635.6535 56504.4445  46.2%     -    3s
     0     0 56238.4391    0  336 38635.6535 56238.4391  45.6%     -    3s
     0     0 55990.0989    0  324 38635.6535 55990.0989  44.9%     -    4s
     0     0 55953.9104    0  381 38635.6535 55953.9104  44.8%     -    4s
     0     0 55950.4531    0  383 38635.6535 55950.4531  44.8%     -    4s
     0     0 55950.2478    0  395 38635.6535 55950.2478  44.8%     -    4s
H    0     0                    38679.725437 52973.5883  37.0%     -    5s
     0     0 52973.5883    0  375 38679.7254 52973.5883  37.0%     -    5s
     0     0 52230.2502    0  450 38679.7254 52230.2502  35.0%     -    6s
     0     0 52018.4437    0  409 38679.7254 52018.4437  34.5%     -    6s
     0     0 51867.6538    0  515 38679.7254 51867.6538  34.1%     -    6s
     0     0 51819.7400    0  522 38679.7254 51819.7400  34.0%     -    6s
     0     0 51800.3315    0  483 38679.7254 51800.3315  33.9%     -    7s
     0     0 51778.6074    0  480 38679.7254 51778.6074  33.9%     -    7s
     0     0 51774.5388    0  481 38679.7254 51774.5388  33.9%     -    7s
     0     0 51773.8934    0  482 38679.7254 51773.8934  33.9%     -    7s
     0     0 50125.5884    0  404 38679.7254 50125.5884  29.6%     -    8s
     0     0 49814.7653    0  408 38679.7254 49814.7653  28.8%     -    9s
     0     0 49715.5471    0  415 38679.7254 49715.5471  28.5%     -    9s
     0     0 49664.6106    0  424 38679.7254 49664.6106  28.4%     -   10s
     0     0 49650.4548    0  434 38679.7254 49650.4548  28.4%     -   10s
     0     0 49646.3039    0  428 38679.7254 49646.3039  28.4%     -   10s
     0     0 49360.2616    0  471 38679.7254 49360.2616  27.6%     -   10s
     0     0 49255.5670    0  476 38679.7254 49255.5670  27.3%     -   11s
     0     0 49214.8300    0  490 38679.7254 49214.8300  27.2%     -   11s
     0     0 49198.5999    0  486 38679.7254 49198.5999  27.2%     -   11s
     0     0 49194.0069    0  496 38679.7254 49194.0069  27.2%     -   11s
     0     0 49028.7966    0  496 38679.7254 49028.7966  26.8%     -   12s
     0     0 48945.2997    0  472 38679.7254 48945.2997  26.5%     -   12s
     0     0 48908.9001    0  492 38679.7254 48908.9001  26.4%     -   13s
     0     0 48898.4594    0  494 38679.7254 48898.4594  26.4%     -   13s
     0     0 48894.1133    0  486 38679.7254 48894.1133  26.4%     -   13s
     0     0 48842.8205    0  402 38679.7254 48842.8205  26.3%     -   13s
     0     0 48831.1684    0  408 38679.7254 48831.1684  26.2%     -   14s
     0     0 48825.8867    0  412 38679.7254 48825.8867  26.2%     -   14s
     0     0 48793.2994    0  417 38679.7254 48793.2994  26.1%     -   14s
     0     0 48752.7903    0  402 38679.7254 48752.7903  26.0%     -   14s
     0     0 48745.1367    0  406 38679.7254 48745.1367  26.0%     -   14s
     0     0 48737.4036    0  412 38679.7254 48737.4036  26.0%     -   15s
     0     0 48733.6817    0  418 38679.7254 48733.6817  26.0%     -   15s
     0     0 48703.7263    0  402 38679.7254 48703.7263  25.9%     -   15s
     0     0 48697.4159    0  412 38679.7254 48697.4159  25.9%     -   15s
     0     0 48697.2107    0  406 38679.7254 48697.2107  25.9%     -   15s
     0     0 48688.4795    0  394 38679.7254 48688.4795  25.9%     -   16s
     0     0 48684.7512    0  405 38679.7254 48684.7512  25.9%     -   16s
     0     0 48677.5405    0  405 38679.7254 48677.5405  25.8%     -   16s
     0     0 48674.6355    0  405 38679.7254 48674.6355  25.8%     -   16s
     0     2 48674.6355    0  405 38679.7254 48674.6355  25.8%     -   19s
     3     8 48369.1699    2  387 38679.7254 48590.5550  25.6%   809   20s
    95   131 46388.0796    7  393 38679.7254 47578.9912  23.0%  1067   26s
   234   262 45865.9537   10  398 38679.7254 47561.7310  23.0%   772   30s
   447   448 44272.7290   14  377 38679.7254 47483.0816  22.8%   615   35s
H  498   448                    38723.862869 47281.2099  22.1%   609   35s
   920   790 44295.6773   18  526 38723.8629 46919.7549  21.2%   516   40s
  1374  1134 43528.2735   22  501 38723.8629 46897.1345  21.1%   451   46s
  1732  1287 42718.5822   30  393 38723.8629 46893.9970  21.1%   441   50s
  2209  1597 41306.5969   40  314 38723.8629 46893.9970  21.1%   419   55s
  2859  2082 39302.0459   52  291 38723.8629 45844.2964  18.4%   398   61s
  3865  2655     cutoff   22      38723.8629 45627.6776  17.8%   369   67s
  4263  2774 39305.3200   15  405 38723.8629 45528.6980  17.6%   366   74s
  4265  2775 42144.5236   16   67 38723.8629 45528.6980  17.6%   366   75s
  4279  2785 40784.0985   25  395 38723.8629 45528.6980  17.6%   365   80s
  4292  2793 42271.5250   47  462 38723.8629 45528.6980  17.6%   364   85s
  4298  2797 41706.6977   49  467 38723.8629 45528.6980  17.6%   363   90s
  4342  2846 43385.4507   18  351 38723.8629 45528.6980  17.6%   375   95s
  4602  2956 41414.1587   22  297 38723.8629 45528.6980  17.6%   377  100s
  5007  2951 40342.7296   28  364 38723.8629 44756.5615  15.6%   374  105s
  5614  2914 39697.7967   26  235 38723.8629 43443.5326  12.2%   367  110s
  6426  2776 39159.8599   29  288 38723.8629 42920.5711  10.8%   358  115s
  7781  2160 39462.5232   24  205 38723.8629 41574.2307  7.36%   348  121s

Cutting planes:
  Gomory: 2
  MIR: 238
  Mixing: 1
  Flow cover: 420
  RLT: 4
  Relax-and-lift: 36

Explored 9739 nodes (3064988 simplex iterations) in 123.93 seconds (315.99 work units)
Thread count was 32 (of 64 available processors)

Solution count 4: 38723.9 38679.7 38635.7 23913.8 

Optimal solution found (tolerance 1.00e-06)
Best objective 3.872386286888e+04, best bound 3.872386286888e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 123.94s
  Master Objective (UB) = 38723.86, θ = 188328.89
  Upper Bound (UB) = 38723.86

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 188328.89
  [DEBUG]   ✓ Scenario 0: θ = 188328.89 ≤ Q = 188328.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 188328.89 ≤ Q = 188328.89 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x8f2c195
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x08f2c195
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.347523e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.00s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6151306.8513
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6150977.5070

Root relaxation: objective -1.672198e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -167219.83    0  120 6150977.51 -167219.83   103%     -    0s
H    0     0                    -149710.3012 -167219.83  11.7%     -    0s
H    0     0                    -150039.6455 -167219.83  11.5%     -    0s
H    0     0                    -150308.2515 -156046.33  3.82%     -    0s
     0     0 -156046.33    0  118 -150308.25 -156046.33  3.82%     -    0s
H    0     0                    -152679.2027 -155955.38  2.15%     -    0s
     0     0 -155856.54    0  101 -152679.20 -155856.54  2.08%     -    0s
     0     0 -155080.89    0   98 -152679.20 -155080.89  1.57%     -    0s
H    0     0                    -153491.1243 -155014.67  0.99%     -    0s
     0     0 -154952.58    0   96 -153491.12 -154952.58  0.95%     -    0s
     0     0 -154678.65    0   63 -153491.12 -154678.65  0.77%     -    0s
     0     0 -154622.55    0   74 -153491.12 -154622.55  0.74%     -    0s
     0     0 -154617.01    0   52 -153491.12 -154617.01  0.73%     -    0s
     0     0 -154465.70    0   52 -153491.12 -154465.70  0.63%     -    0s
     0     0 -154437.43    0   44 -153491.12 -154437.43  0.62%     -    0s
     0     0 -154432.81    0   73 -153491.12 -154432.81  0.61%     -    0s
     0     0 -154381.08    0   64 -153491.12 -154381.08  0.58%     -    0s
     0     0 -154366.47    0   64 -153491.12 -154366.47  0.57%     -    0s
     0     2 -154366.47    0   64 -153491.12 -154366.47  0.57%     -    0s
H  867    11                    -153502.9239 -153705.86  0.13%   7.5    0s

Cutting planes:
  Gomory: 44
  Implied bound: 6
  MIR: 122
  Flow cover: 38
  RLT: 88
  Relax-and-lift: 8
  BQP: 3

Explored 944 nodes (7548 simplex iterations) in 0.10 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -153503 -153491 -152679 ... 1.34752e+13
No other solutions better than -153503

Optimal solution found (tolerance 1.00e-06)
Best objective -1.535029239389e+05, best bound -1.535029239389e+05, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 167490.10
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -153502.92
  [DEBUG]   S×d_nominal = 320993.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320993.02 + -153502.92 = 167490.10
  [DEBUG]   Current θ from Master = 188328.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20838.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17885.07
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 14810.0369, Absolute Gap = 14810.0369, Relative Gap = 0.382452
  Not converged yet (gap = 14810.04 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135176 nonzeros
Model fingerprint: 0xf3f1bbdb
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 17885.1 (0.02s)
Loaded MIP start from previous solve with objective 17885.1

Presolve removed 22422 rows and 9102 columns
Presolve time: 0.36s
Presolved: 24831 rows, 11878 columns, 138749 nonzeros
Variable types: 9619 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   40899    6.6256929e+04   0.000000e+00   1.548497e+04      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19894    6.6298494e+04   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 6.629849e+04, 19894 iterations, 4.67 seconds (8.77 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 66298.4943    0  234 17885.0705 66298.4943   271%     -    5s
H    0     0                    18083.462317 66298.4943   267%     -    5s
H    0     0                    19123.300062 66298.4943   247%     -    5s
H    0     0                    19321.691882 66298.4943   243%     -    5s
H    0     0                    26330.726142 66298.4943   152%     -    5s
H    0     0                    26904.073836 66298.4943   146%     -    5s
H    0     0                    29031.465313 66298.4943   128%     -    5s
H    0     0                    29143.533265 66298.4943   127%     -    5s
H    0     0                    29646.773812 66298.4943   124%     -    5s
H    0     0                    29748.865647 66298.4943   123%     -    5s
H    0     0                    29932.203814 66298.4943   121%     -    5s
H    0     0                    29991.230516 66298.4943   121%     -    5s
H    0     0                    30060.594085 66298.4943   121%     -    5s
     0     0 58903.3542    0  359 30060.5941 58903.3542  95.9%     -    7s
     0     0 58903.3542    0  362 30060.5941 58903.3542  95.9%     -    7s
     0     0 58903.3542    0  376 30060.5941 58903.3542  95.9%     -    8s
     0     0 58903.3542    0  369 30060.5941 58903.3542  95.9%     -    8s
     0     0 58903.3542    0  369 30060.5941 58903.3542  95.9%     -    8s
     0     0 52892.6464    0  265 30060.5941 52892.6464  76.0%     -   11s
H    0     0                    30062.697610 52891.6983  75.9%     -   11s
     0     0 51954.7822    0  301 30062.6976 51954.7822  72.8%     -   12s
H    0     0                    30071.809327 51451.9259  71.1%     -   13s
     0     0 51451.9259    0  296 30071.8093 51451.9259  71.1%     -   13s
     0     0 51432.9139    0  436 30071.8093 51432.9139  71.0%     -   13s
     0     0 51407.8549    0  289 30071.8093 51407.8549  71.0%     -   13s
     0     0 51400.9394    0  404 30071.8093 51400.9394  70.9%     -   13s
     0     0 51399.3276    0  361 30071.8093 51399.3276  70.9%     -   13s
H    0     0                    30118.822037 49143.5844  63.2%     -   17s
H    0     0                    30127.520615 49143.5844  63.1%     -   17s
H    0     0                    30135.037120 49143.5844  63.1%     -   17s
H    0     0                    30166.552116 49143.5844  62.9%     -   17s
     0     0 49143.5844    0  368 30166.5521 49143.5844  62.9%     -   17s
     0     0 48279.0278    0  398 30166.5521 48279.0278  60.0%     -   18s
     0     0 48103.7342    0  452 30166.5521 48103.7342  59.5%     -   19s
     0     0 48039.6142    0  414 30166.5521 48039.6142  59.2%     -   19s
     0     0 48020.8619    0  460 30166.5521 48020.8619  59.2%     -   19s
     0     0 48017.9128    0  455 30166.5521 48017.9128  59.2%     -   19s
     0     0 46438.0189    0  398 30166.5521 46438.0189  53.9%     -   23s
H    0     0                    30188.329551 46436.1274  53.8%     -   23s
H    0     0                    30220.388531 46436.1274  53.7%     -   23s
H    0     0                    30254.526435 46436.1274  53.5%     -   23s
     0     0 46058.9696    0  391 30254.5264 46058.9696  52.2%     -   24s
     0     0 45955.8420    0  398 30254.5264 45955.8420  51.9%     -   25s
     0     0 45870.8168    0  463 30254.5264 45870.8168  51.6%     -   25s
     0     0 45857.6625    0  471 30254.5264 45857.6625  51.6%     -   25s
     0     0 45848.3009    0  476 30254.5264 45848.3009  51.5%     -   26s
     0     0 45844.8115    0  488 30254.5264 45844.8115  51.5%     -   26s
     0     0 45446.8634    0  380 30254.5264 45446.8634  50.2%     -   28s
     0     0 45375.9228    0  393 30254.5264 45375.9228  50.0%     -   29s
     0     0 45355.8633    0  396 30254.5264 45355.8633  49.9%     -   29s
     0     0 45343.0118    0  402 30254.5264 45343.0118  49.9%     -   29s
     0     0 45326.3469    0  408 30254.5264 45326.3469  49.8%     -   29s
     0     0 45319.5975    0  417 30254.5264 45319.5975  49.8%     -   30s
     0     0 45314.4746    0  417 30254.5264 45314.4746  49.8%     -   30s
     0     0 45185.9629    0  387 30254.5264 45185.9629  49.4%     -   31s
     0     0 45142.9473    0  406 30254.5264 45142.9473  49.2%     -   31s
     0     0 45131.4626    0  419 30254.5264 45131.4626  49.2%     -   32s
     0     0 45116.7057    0  417 30254.5264 45116.7057  49.1%     -   32s
     0     0 45113.2558    0  413 30254.5264 45113.2558  49.1%     -   32s
     0     0 44994.2023    0  420 30254.5264 44994.2023  48.7%     -   33s
     0     0 44952.7013    0  531 30254.5264 44952.7013  48.6%     -   34s
     0     0 44941.8094    0  486 30254.5264 44941.8094  48.5%     -   34s
     0     0 44937.8821    0  489 30254.5264 44937.8821  48.5%     -   34s
     0     0 44879.9220    0  422 30254.5264 44879.9220  48.3%     -   35s
     0     0 44866.5048    0  406 30254.5264 44866.5048  48.3%     -   35s
     0     0 44863.3577    0  411 30254.5264 44863.3577  48.3%     -   36s
     0     0 44836.4294    0  395 30254.5264 44836.4294  48.2%     -   36s
     0     0 44827.8487    0  390 30254.5264 44827.8487  48.2%     -   37s
     0     0 44825.8918    0  403 30254.5264 44825.8918  48.2%     -   37s
     0     0 44819.7087    0  387 30254.5264 44819.7087  48.1%     -   37s
     0     0 44818.9392    0  387 30254.5264 44818.9392  48.1%     -   38s
     0     2 44818.9392    0  387 30254.5264 44818.9392  48.1%     -   46s
     7    16 44583.9094    3  392 30254.5264 44623.8957  47.5%  2699   51s
    31    64 44038.4911    5  405 30254.5264 44155.0193  45.9%  5129   56s
    95   225 43579.5121    7  400 30254.5264 44036.4417  45.6%  3081   60s
H  331   350                    30940.669247 44036.4417  42.3%  1570   64s
H  347   350                    31247.032126 44036.4417  40.9%  1546   64s
   349   392 43181.5400   10  384 31247.0321 44036.4417  40.9%  1545   65s
H  353   392                    31509.099853 44036.4417  39.8%  1548   65s
H  388   392                    32038.155771 44036.4417  37.4%  1498   65s
H  396   455                    32188.485312 44036.4417  36.8%  1506   67s
H  405   455                    32444.858435 44036.4417  35.7%  1509   67s
   529   600 42644.9610   13  379 32444.8584 44036.4417  35.7%  1417   71s
H  533   600                    32469.301148 44036.4417  35.6%  1420   71s
   749   788 41555.9314   16  375 32469.3011 44036.4417  35.6%  1261   76s
   871   868 41920.9073   17  393 32469.3011 43988.5808  35.5%  1234   80s
  1069  1001 41433.6186   19  389 32469.3011 43940.0329  35.3%  1185   86s
  1200  1121 41106.6414   21  379 32469.3011 43915.4884  35.3%  1178   90s
  1370  1291 40863.4567   22  334 32469.3011 43915.4884  35.3%  1166   95s
  1693  1551 40377.2342   27  360 32469.3011 43784.1290  34.8%  1094  101s
  1922  1784 37843.3885   29  300 32469.3011 43784.1290  34.8%  1065  106s
  2130  1857 35954.4619   36  264 32469.3011 43328.9925  33.4%  1027  110s
  2313  1985 35807.8750   39  259 32469.3011 43180.5688  33.0%  1010  115s
  2527  2091 33032.0127   46  179 32469.3011 43137.6047  32.9%  1012  120s
  2769  2258 38655.6648   12  317 32469.3011 43083.2753  32.7%  1016  130s
  3081  2520 34707.4074   27  197 32469.3011 43083.2753  32.7%   997  137s
  3327  2598     cutoff   40      32469.3011 43023.5560  32.5%   975  140s
  3710  2845 42268.9167   13  366 32469.3011 42821.6659  31.9%   943  147s
  3866  2846 36531.2555   24  387 32469.3011 42821.6659  31.9%   954  156s
  3870  2849 38591.8712   14  307 32469.3011 42821.6659  31.9%   953  160s
  3880  2855 39066.9232   24  391 32469.3011 42821.6659  31.9%   950  165s
  3890  2862 40199.8267    8  399 32469.3011 42821.6659  31.9%   948  170s
  3901  2869 34675.3448   50  446 32469.3011 42821.6659  31.9%   945  175s
  3903  2871 34023.3080   27  446 32469.3011 42821.6659  31.9%   945  180s
  3910  2884 42821.6659   12  364 32469.3011 42821.6659  31.9%   960  186s
  3934  2924 42821.6659   14  355 32469.3011 42821.6659  31.9%   973  190s
  3998  2993 42517.9008   16  326 32469.3011 42821.6659  31.9%   998  195s
  4186  3058 39988.0907   19  278 32469.3011 42821.6659  31.9%  1031  201s
  4388  3060 37815.9777   22  220 32469.3011 42140.8647  29.8%  1058  206s
  4502  3071     cutoff   23      32469.3011 41718.5635  28.5%  1081  210s
  4677  3051 33081.5940   26  162 32469.3011 41718.5635  28.5%  1112  216s
  4875  3057     cutoff   27      32469.3011 40465.2187  24.6%  1122  222s
  5016  3062 34102.9490   23  127 32469.3011 40274.7863  24.0%  1126  226s
  5313  3065 34496.7558   25  152 32469.3011 40031.8647  23.3%  1120  231s
  5507  3041 33079.5946   27  156 32469.3011 39262.4670  20.9%  1129  236s
  5725  2998 34593.6647   22  165 32469.3011 39262.2996  20.9%  1137  240s
  5826  2976 infeasible   24      32469.3011 38763.1931  19.4%  1138  245s
  5934  2977 infeasible   26      32469.3011 38565.4687  18.8%  1143  250s
  6150  2968 35901.8230   19  285 32469.3011 38464.1364  18.5%  1145  255s
  6471  2893 34183.9911   24  181 32469.3011 38167.5707  17.5%  1148  260s
  6829  2825 34709.8352   22  256 32469.3011 37754.4059  16.3%  1157  266s
  7290  2716 34307.1576   24  196 32469.3011 37648.4066  16.0%  1155  272s
  7577  2648 35415.1381   19  266 32469.3011 37079.6344  14.2%  1150  275s
  8092  2504 33378.5979   20  307 32469.3011 36723.3733  13.1%  1144  281s
  8722  2286 32767.9006   25  187 32469.3011 36342.6577  11.9%  1140  287s
  9089  2161 33802.3565   22  162 32469.3011 36224.7497  11.6%  1134  290s
  9774  1823     cutoff   27      32469.3011 35901.5750  10.6%  1124  297s
 10169  1599     cutoff   23      32469.3011 35476.5722  9.26%  1122  300s
 11105  1003 32600.8012   23  190 32469.3011 34956.2927  7.66%  1101  307s
 11793   471     cutoff   31      32469.3011 34457.3222  6.12%  1075  310s
 13060     0 32622.3067   33   46 32469.3011 33284.2914  2.51%  1002  315s

Cutting planes:
  Gomory: 1
  MIR: 337
  Mixing: 1
  Flow cover: 613
  RLT: 7
  Relax-and-lift: 53

Explored 13240 nodes (13177430 simplex iterations) in 315.67 seconds (926.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 32469.3 32444.9 32188.5 ... 30188.3

Optimal solution found (tolerance 1.00e-06)
Best objective 3.246930114829e+04, best bound 3.246930114829e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 315.68s
  Master Objective (UB) = 32469.30, θ = 191232.51
  Upper Bound (UB) = 32469.30

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191232.51
  [DEBUG]   ✓ Scenario 0: θ = 191232.51 ≤ Q = 191232.51 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191232.51 ≤ Q = 191232.51 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191232.51 ≤ Q = 191232.51 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x23d22a47
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xdc2dd5b9
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.262509e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.00s
Presolved: 470 rows, 475 columns, 1325 nonzeros
Found heuristic solution: objective 5742631.1104
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.655695e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165569.52    0  125 5742631.11 -165569.52   103%     -    0s
H    0     0                    -130907.8325 -165569.52  26.5%     -    0s
H    0     0                    -133079.4222 -165569.52  24.4%     -    0s
H    0     0                    -141313.6414 -165569.52  17.2%     -    0s
H    0     0                    -142942.6774 -151610.21  6.06%     -    0s
H    0     0                    -146146.4999 -151610.21  3.74%     -    0s
     0     0 -151610.21    0   67 -146146.50 -151610.21  3.74%     -    0s
H    0     0                    -150211.7534 -151515.10  0.87%     -    0s
     0     0 -150779.40    0   60 -150211.75 -150779.40  0.38%     -    0s
     0     0 -150771.32    0   60 -150211.75 -150771.32  0.37%     -    0s
     0     0 -150758.43    0   59 -150211.75 -150758.43  0.36%     -    0s
H    0     0                    -150235.4831 -150269.21  0.02%     -    0s
     0     0 -150269.21    0   18 -150235.48 -150269.21  0.02%     -    0s
     0     0 -150251.53    0    9 -150235.48 -150251.53  0.01%     -    0s
H    0     0                    -150236.1544 -150251.23  0.01%     -    0s
     0     0 -150247.25    0    8 -150236.15 -150247.25  0.01%     -    0s
     0     0 -150247.25    0    5 -150236.15 -150247.25  0.01%     -    0s
     0     0 -150243.55    0    2 -150236.15 -150243.55  0.00%     -    0s
*    0     0               0    -150242.7688 -150242.77  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Flow cover: 2
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (574 simplex iterations) in 0.05 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -150243 -150236 -150235 ... -130908
No other solutions better than -150243

Optimal solution found (tolerance 1.00e-06)
Best objective -1.502427687944e+05, best bound -1.502427687944e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 170750.25
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -150242.77
  [DEBUG]   S×d_nominal = 320993.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320993.02 + -150242.77 = 170750.25
  [DEBUG]   Current θ from Master = 191232.51
  [DEBUG]   ⚠️  Z_SP ≤ θ by 20482.26 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11987.04
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 8555.4752, Absolute Gap = 8555.4752, Relative Gap = 0.263494
  Not converged yet (gap = 8555.48 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178395 nonzeros
Model fingerprint: 0xe9147369
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 11987 (0.03s)
Loaded MIP start from previous solve with objective 11987

Presolve removed 29896 rows and 12136 columns
Presolve time: 0.54s
Presolved: 32647 rows, 15084 columns, 201399 nonzeros
Variable types: 12825 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 32647 rows, 15084 columns, 201399 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   53185    4.5461241e+04   0.000000e+00   1.493360e+06      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 5.743333e+04, 23474 iterations, 6.46 seconds (12.76 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57433.3285    0   68 11987.0418 57433.3285   379%     -    7s
H    0     0                    21397.184092 57433.3285   168%     -    7s
H    0     0                    23782.206224 57433.3285   141%     -    7s
H    0     0                    27188.155976 57433.3285   111%     -    7s
H    0     0                    28381.689240 57433.3285   102%     -    7s
H    0     0                    29132.178391 57433.3285  97.1%     -    7s
H    0     0                    29132.799540 57433.3285  97.1%     -    7s
H    0     0                    29164.966100 57433.3285  96.9%     -    7s
H    0     0                    29646.980039 57433.3285  93.7%     -    7s
H    0     0                    29740.625958 57433.3285  93.1%     -    7s
H    0     0                    29942.386239 57433.3285  91.8%     -    7s
H    0     0                    29949.354629 57433.3285  91.8%     -    7s
H    0     0                    30314.683210 54427.8230  79.5%     -    9s
     0     0 54427.8230    0  171 30314.6832 54427.8230  79.5%     -    9s
     0     0 53642.1077    0  167 30314.6832 53642.1077  77.0%     -   11s
     0     0 53642.1077    0  162 30314.6832 53642.1077  77.0%     -   11s
     0     0 53642.1077    0  168 30314.6832 53642.1077  77.0%     -   11s
     0     0 53642.1077    0  166 30314.6832 53642.1077  77.0%     -   11s
H    0     0                    31178.327611 50797.4096  62.9%     -   13s
     0     0 50797.4096    0  154 31178.3276 50797.4096  62.9%     -   13s
     0     0 50111.0724    0  212 31178.3276 50111.0724  60.7%     -   14s
     0     0 49901.6347    0  231 31178.3276 49901.6347  60.1%     -   15s
     0     0 49822.0529    0  242 31178.3276 49822.0529  59.8%     -   16s
     0     0 49805.1353    0  246 31178.3276 49805.1353  59.7%     -   16s
     0     0 49798.8911    0  246 31178.3276 49798.8911  59.7%     -   16s
     0     0 49794.6104    0  246 31178.3276 49794.6104  59.7%     -   16s
     0     0 49794.5434    0  244 31178.3276 49794.5434  59.7%     -   17s
     0     0 47347.0549    0  304 31178.3276 47347.0549  51.9%     -   21s
     0     0 47003.2463    0  300 31178.3276 47003.2463  50.8%     -   22s
     0     0 46785.2314    0  315 31178.3276 46785.2314  50.1%     -   23s
     0     0 46590.8159    0  324 31178.3276 46590.8159  49.4%     -   24s
     0     0 46503.5537    0  316 31178.3276 46503.5537  49.2%     -   25s
     0     0 46455.1690    0  325 31178.3276 46455.1690  49.0%     -   25s
     0     0 46428.6616    0  329 31178.3276 46428.6616  48.9%     -   25s
     0     0 46418.7464    0  323 31178.3276 46418.7464  48.9%     -   26s
     0     0 46373.6335    0  319 31178.3276 46373.6335  48.7%     -   26s
     0     0 46360.6004    0  321 31178.3276 46360.6004  48.7%     -   26s
     0     0 46354.1356    0  323 31178.3276 46354.1356  48.7%     -   26s
     0     0 46353.1619    0  326 31178.3276 46353.1619  48.7%     -   26s
     0     0 45718.2282    0  360 31178.3276 45718.2282  46.6%     -   30s
     0     0 45499.3850    0  368 31178.3276 45499.3850  45.9%     -   31s
     0     0 45437.0402    0  379 31178.3276 45437.0402  45.7%     -   32s
     0     0 45380.8911    0  371 31178.3276 45380.8911  45.6%     -   32s
     0     0 45365.1431    0  380 31178.3276 45365.1431  45.5%     -   33s
     0     0 45357.0837    0  372 31178.3276 45357.0837  45.5%     -   33s
     0     0 45346.5269    0  376 31178.3276 45346.5269  45.4%     -   33s
     0     0 45340.1714    0  380 31178.3276 45340.1714  45.4%     -   33s
     0     0 45330.3371    0  382 31178.3276 45330.3371  45.4%     -   34s
     0     0 45328.4087    0  377 31178.3276 45328.4087  45.4%     -   34s
     0     0 45326.1367    0  375 31178.3276 45326.1367  45.4%     -   34s
     0     0 45323.9267    0  380 31178.3276 45323.9267  45.4%     -   34s
     0     0 45323.3183    0  375 31178.3276 45323.3183  45.4%     -   34s
     0     0 45178.3892    0  381 31178.3276 45178.3892  44.9%     -   35s
     0     0 45094.2634    0  372 31178.3276 45094.2634  44.6%     -   36s
     0     0 45076.4023    0  389 31178.3276 45076.4023  44.6%     -   36s
     0     0 45053.9727    0  380 31178.3276 45053.9727  44.5%     -   37s
     0     0 45042.0183    0  390 31178.3276 45042.0183  44.5%     -   37s
     0     0 45038.6732    0  383 31178.3276 45038.6732  44.5%     -   37s
     0     0 45036.7332    0  389 31178.3276 45036.7332  44.4%     -   37s
     0     0 45036.1792    0  392 31178.3276 45036.1792  44.4%     -   37s
     0     0 44995.2808    0  378 31178.3276 44995.2808  44.3%     -   38s
     0     0 44973.2416    0  417 31178.3276 44973.2416  44.2%     -   39s
     0     0 44956.8383    0  411 31178.3276 44956.8383  44.2%     -   39s
     0     0 44952.5083    0  410 31178.3276 44952.5083  44.2%     -   40s
     0     0 44942.5600    0  422 31178.3276 44942.5600  44.1%     -   40s
     0     0 44941.3184    0  398 31178.3276 44941.3184  44.1%     -   40s
     0     0 44918.9246    0  433 31178.3276 44918.9246  44.1%     -   40s
     0     0 44913.8256    0  409 31178.3276 44913.8256  44.1%     -   41s
     0     0 44911.5052    0  436 31178.3276 44911.5052  44.0%     -   41s
     0     0 44911.0199    0  465 31178.3276 44911.0199  44.0%     -   41s
     0     0 44907.4247    0  440 31178.3276 44907.4247  44.0%     -   42s
H    0     0                    31183.453650 44905.6032  44.0%     -   43s
     0     0 44903.9860    0  441 31183.4537 44903.9860  44.0%     -   43s
     0     0 44903.7661    0  446 31183.4537 44903.7661  44.0%     -   43s
     0     0 44894.8237    0  472 31183.4537 44894.8237  44.0%     -   44s
     0     0 44887.4643    0  457 31183.4537 44887.4643  43.9%     -   44s
     0     0 44885.7202    0  437 31183.4537 44885.7202  43.9%     -   44s
     0     0 44883.9360    0  408 31183.4537 44883.9360  43.9%     -   44s
     0     0 44883.5783    0  408 31183.4537 44883.5783  43.9%     -   44s
     0     0 44868.0451    0  406 31183.4537 44868.0451  43.9%     -   45s
     0     0 44865.6997    0  419 31183.4537 44865.6997  43.9%     -   45s
     0     0 44863.3504    0  412 31183.4537 44863.3504  43.9%     -   45s
     0     0 44862.3704    0  407 31183.4537 44862.3704  43.9%     -   45s
     0     0 44858.7944    0  444 31183.4537 44858.7944  43.9%     -   46s
     0     0 44857.1919    0  475 31183.4537 44857.1919  43.8%     -   46s
     0     0 44857.0396    0  475 31183.4537 44857.0396  43.8%     -   46s
     0     0 44856.5520    0  475 31183.4537 44856.5520  43.8%     -   47s
     0     0 44855.9031    0  473 31183.4537 44855.9031  43.8%     -   47s
     0     0 44855.4245    0  415 31183.4537 44855.4245  43.8%     -   47s
     0     0 44855.1362    0  415 31183.4537 44855.1362  43.8%     -   48s
     0     2 44855.1362    0  415 31183.4537 44855.1362  43.8%     -   54s
     1     4 44758.1593    1  429 31183.4537 44853.5101  43.8%  2051   55s
     7    16 44432.2906    3  402 31183.4537 44641.7740  43.2%  2615   61s
    31    52 41028.2193    5  369 31183.4537 44276.3724  42.0%  4221   70s
H   52    84                    31303.590005 44276.3724  41.4%  5261   73s
H   74    84                    31597.013033 44276.3724  40.1%  4260   73s
    83   220 40545.8713    7  340 31597.0130 44276.3724  40.1%  3907   77s
   251   284 40159.1032   10  340 31597.0130 44276.3724  40.1%  2218   81s
H  264   284                    31665.018880 44276.3724  39.8%  2187   81s
   315   342 40002.6350   10  339 31665.0189 44276.3724  39.8%  2083   85s
H  348   342                    31762.374286 44276.3724  39.4%  2031   85s
   353   434 39906.9975    9  294 31762.3743 44276.3724  39.4%  2008   91s
   497   508 38782.5066   11  308 31762.3743 44276.3724  39.4%  1925   98s
   548   546 39197.0706   11  332 31762.3743 44276.3724  39.4%  1949  100s
   604   588 35440.5766   11  234 31762.3743 44040.6124  38.7%  1943  106s
   734   713     cutoff   12      31762.3743 44040.6124  38.7%  1915  113s
   819   768 35628.3456   12  349 31762.3743 44018.4534  38.6%  1810  115s
   918   829 39597.2758   12  295 31762.3743 44018.4534  38.6%  1685  122s
  1005   869 38583.9722   13  288 31762.3743 44018.4534  38.6%  1624  126s
  1179   968 37816.0732   14  325 31762.3743 43504.1531  37.0%  1565  132s
  1254  1002 37079.3621   14  249 31762.3743 43504.1531  37.0%  1550  138s
  1306  1041 37752.0232   15  277 31762.3743 43504.1531  37.0%  1529  142s
  1373  1104 36955.5375   16  327 31762.3743 43354.7536  36.5%  1510  145s
  1575  1262 36317.1975   18  289 31762.3743 42821.1306  34.8%  1448  154s
  1719  1335 32418.6442   16  306 31762.3743 42821.1306  34.8%  1399  158s
  1863  1398 35021.6393   19  246 31762.3743 42821.1306  34.8%  1355  161s
  1986  1465 34328.2655   17  271 31762.3743 42605.4066  34.1%  1341  165s
  2251  1696 34994.1305   21  206 31762.3743 42288.5436  33.1%  1315  173s
  2427  1759 34315.1738   35  168 31762.3743 42288.5436  33.1%  1283  175s
  2544  1831 33946.1081   38  151 31762.3743 42172.7138  32.8%  1259  181s
  2712  1887 33539.9874   43  125 31762.3743 42172.7138  32.8%  1237  186s
  2906  2000 32690.0107   45  128 31762.3743 41985.0716  32.2%  1215  192s
  3095  2155     cutoff   55      31762.3743 41882.0880  31.9%  1195  197s
  3306  2263 40433.4126   10  363 31762.3743 41879.9876  31.9%  1173  202s
  3522  2412 35803.3051   12  227 31762.3743 41852.4657  31.8%  1157  210s
  3770  2544 33903.1601   16  147 31762.3743 41731.2170  31.4%  1134  217s
  4084  2580     cutoff    9      31762.3743 41706.1929  31.3%  1105  223s
  4249  2699 38541.2968    8  280 31762.3743 41666.1645  31.2%  1098  228s
  4454  2863 37741.7202    9  268 31762.3743 41639.8838  31.1%  1094  235s
  4756  2864 39880.5435    9  415 31762.3743 41517.6677  30.7%  1076  250s
  4758  2865 35733.7179   17   68 31762.3743 41517.6677  30.7%  1076  256s
  4759  2866 40579.3371    7  272 31762.3743 41517.6677  30.7%  1075  260s
  4762  2868 32368.2057   26  430 31762.3743 41517.6677  30.7%  1075  265s
  4768  2872 36542.1901   28  401 31762.3743 41517.6677  30.7%  1073  270s
  4773  2875 33666.2380   29  426 31762.3743 41517.6677  30.7%  1072  275s
  4780  2880 32504.9480   24  417 31762.3743 41517.6677  30.7%  1071  281s
  4784  2883 38463.2359   18  449 31762.3743 41517.6677  30.7%  1070  285s
  4785  2883 35042.3767   31  449 31762.3743 41517.6677  30.7%  1070  291s
  4786  2884 33503.3417   20  449 31762.3743 41517.6677  30.7%  1069  296s
  4787  2888 41517.6677   15  429 31762.3743 41517.6677  30.7%  1082  302s
  4789  2891 41517.6677   16  439 31762.3743 41517.6677  30.7%  1082  305s
  4793  2898 41517.6677   17  433 31762.3743 41517.6677  30.7%  1084  310s
  4801  2911 41517.6677   18  426 31762.3743 41517.6677  30.7%  1085  315s
  4817  2938 41517.6677   19  417 31762.3743 41517.6677  30.7%  1106  321s
  4849  2959 41517.6677   20  383 31762.3743 41517.6677  30.7%  1120  325s
  4881  2925     cutoff   21      31762.3743 41517.6677  30.7%  1138  336s
  4910  2945 38158.4610   22  340 31762.3743 41517.6677  30.7%  1212  342s
  4946  2986 36160.6168   23  313 31762.3743 41517.6677  30.7%  1253  348s
  5016  3040 36104.2803   24  306 31762.3743 41517.6677  30.7%  1269  353s
  5096  3084     cutoff   23      31762.3743 41517.6677  30.7%  1280  357s
  5174  3089 35910.7785   25  271 31762.3743 41517.6677  30.7%  1290  361s
  5313  3122 34572.4024   25  297 31762.3743 41517.6677  30.7%  1289  372s
  5434  3103 34913.2624   27  256 31762.3743 41517.6677  30.7%  1284  378s
  5522  3104 34913.1782   28  258 31762.3743 41517.6677  30.7%  1291  383s
  5611  3097 34631.4017   30  193 31762.3743 41517.6677  30.7%  1294  388s
  5681  3108 33501.7598   32  168 31762.3743 41517.6677  30.7%  1303  391s
  5749  3131     cutoff   31      31762.3743 41517.6677  30.7%  1308  396s
  5858  3148 31872.6025   37  148 31762.3743 41517.6677  30.7%  1312  403s
  5929  3152 40022.9669   24  324 31762.3743 41003.6826  29.1%  1311  407s
  6026  3149 38051.8920   25  284 31762.3743 40917.1726  28.8%  1310  412s
  6121  3167 35741.7247   27  249 31762.3743 40722.8481  28.2%  1317  416s
  6230  3184 35055.4565   27  215 31762.3743 40637.5547  27.9%  1318  420s
  6468  3162 33329.4670   30  244 31762.3743 40381.7378  27.1%  1318  429s
  6609  3138     cutoff   30      31762.3743 40381.7378  27.1%  1314  436s
  6743  3117 infeasible   31      31762.3743 39978.1158  25.9%  1315  442s
  6883  3095 33380.2756   24  329 31762.3743 39969.8306  25.8%  1320  446s
  6952  3105 31917.1448   25  304 31762.3743 39843.9716  25.4%  1324  451s
  7053  3113     cutoff   26      31762.3743 39843.9716  25.4%  1332  456s
  7195  3115     cutoff   27      31762.3743 39765.3340  25.2%  1332  462s
  7360  3100 36254.8072   28  245 31762.3743 39765.3340  25.2%  1332  467s
  7558  3070 34997.0385   31  275 31762.3743 39653.9984  24.8%  1327  473s
  7762  3037     cutoff   34      31762.3743 39547.9848  24.5%  1322  479s
  7942  2995     cutoff   27      31762.3743 39273.6286  23.6%  1323  486s
  8082  3008 36876.8286   21  328 31762.3743 39273.6286  23.6%  1326  492s
  8256  3009 36778.7145   22  292 31762.3743 39273.6286  23.6%  1326  497s
  8451  3012 33968.5856   27  234 31762.3743 38965.9749  22.7%  1328  504s
  8692  3018 31998.0251   30  206 31762.3743 38760.0511  22.0%  1327  510s
  8948  2976 32194.3874   30  197 31762.3743 38760.0511  22.0%  1326  517s
  9239  2954 32033.6971   28  145 31762.3743 38660.9608  21.7%  1322  524s
  9411  2937 34118.4134   28  304 31762.3743 38439.3227  21.0%  1325  532s
  9707  2886 33502.6749   27  307 31762.3743 38232.2874  20.4%  1323  540s
  9997  2845 34041.5376   28  248 31762.3743 38143.2804  20.1%  1326  548s
 10296  2795     cutoff   32      31762.3743 38107.3840  20.0%  1327  555s
 10650  2698 31817.4745   30  208 31762.3743 37892.3143  19.3%  1326  564s
 10996  2617 33597.9470   30  284 31762.3743 37729.2536  18.8%  1329  572s
 11342  2545 33128.4612   25  276 31762.3743 37417.7550  17.8%  1333  580s
 11713  2435 33035.8363   27  245 31762.3743 37335.8513  17.5%  1335  589s
 12072  2320     cutoff   29      31762.3743 37226.9791  17.2%  1337  597s
 12470  2216 33682.7450   30  260 31762.3743 37020.1672  16.6%  1340  608s
 12956  2097     cutoff   28      31762.3743 36876.8374  16.1%  1333  618s
 13376  1956 32475.0108   32  255 31762.3743 36782.3985  15.8%  1335  628s
 13842  1930 34779.3667   29  199 31762.3743 36665.6410  15.4%  1336  637s
 13927  1927 33266.9795   31  224 31762.3743 36523.3731  15.0%  1335  647s
 14010  1949 32331.7521   32  231 31762.3743 36523.3731  15.0%  1334  657s
 14250  1955 33318.0381   31  142 31762.3743 36523.3731  15.0%  1331  667s
 14762  1900     cutoff   33      31762.3743 36382.9117  14.5%  1324  678s
 15318  1867 33728.3226   28  201 31762.3743 36271.7573  14.2%  1320  690s
 15952  1844 32051.4324   34  188 31762.3743 35970.0607  13.2%  1317  700s
 16594  1749 infeasible   28      31762.3743 35672.8914  12.3%  1311  713s
 17281  1665 32130.5270   32  146 31762.3743 35396.9655  11.4%  1307  725s
 17984  1483 33036.3470   30  279 31762.3743 35066.0883  10.4%  1304  737s
 18839  1255 33533.0077   40  141 31762.3743 34704.2778  9.26%  1293  751s
 19855   792     cutoff   32      31762.3743 34317.6505  8.04%  1273  764s
 21009    16     cutoff   28      31762.3743 33951.4575  6.89%  1248  775s

Cutting planes:
  Learned: 1
  MIR: 570
  Mixing: 2
  Flow cover: 916
  RLT: 18
  Relax-and-lift: 68

Explored 22270 nodes (26844272 simplex iterations) in 775.31 seconds (2351.60 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 31762.4 31665 31597 ... 29740.6

Optimal solution found (tolerance 1.00e-06)
Best objective 3.176237428612e+04, best bound 3.176237428612e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 775.32s
  Master Objective (UB) = 31762.37, θ = 191455.06
  Upper Bound (UB) = 31762.37

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 191455.06
  [DEBUG]   ✓ Scenario 0: θ = 191455.06 ≤ Q = 191455.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 191455.06 ≤ Q = 191455.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 191455.06 ≤ Q = 191455.06 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 191455.06 ≤ Q = 191455.06 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xc7622c1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf389dd3f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [8e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-14, 2e+02]
Found heuristic solution: objective 1.245953e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.00s
Presolved: 470 rows, 475 columns, 1325 nonzeros
Found heuristic solution: objective 5610068.1300
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.652077e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -165207.72    0  125 5610068.13 -165207.72   103%     -    0s
H    0     0                    -128895.4876 -165207.72  28.2%     -    0s
H    0     0                    -129255.7457 -165207.72  27.8%     -    0s
H    0     0                    -142972.7108 -148847.89  4.11%     -    0s
H    0     0                    -146319.3439 -148847.89  1.73%     -    0s
     0     0 -148847.89    0   61 -146319.34 -148847.89  1.73%     -    0s
H    0     0                    -148117.6813 -148817.99  0.47%     -    0s
     0     0 -148710.10    0   54 -148117.68 -148710.10  0.40%     -    0s
     0     0 -148698.03    0   51 -148117.68 -148698.03  0.39%     -    0s
     0     0 -148696.22    0   50 -148117.68 -148696.22  0.39%     -    0s
     0     0 -148685.34    0   71 -148117.68 -148685.34  0.38%     -    0s
     0     0 -148280.39    0   18 -148117.68 -148280.39  0.11%     -    0s
     0     0 -148257.53    0   14 -148117.68 -148257.53  0.09%     -    0s
     0     0 -148252.68    0   13 -148117.68 -148252.68  0.09%     -    0s
     0     0 -148252.67    0   13 -148117.68 -148252.67  0.09%     -    0s
H    0     0                    -148153.6926 -148248.03  0.06%     -    0s
H    0     0                    -148184.0527 -148218.77  0.02%     -    0s
     0     0 -148218.77    0    6 -148184.05 -148218.77  0.02%     -    0s
     0     0 -148200.23    0    2 -148184.05 -148200.23  0.01%     -    0s
     0     0 -148198.18    0    2 -148184.05 -148198.18  0.01%     -    0s
H    0     0                    -148197.7461 -148198.18  0.00%     -    0s

Cutting planes:
  Flow cover: 1

Explored 1 nodes (522 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -148198 -148184 -148154 ... 1.24595e+13
No other solutions better than -148198

Optimal solution found (tolerance 1.00e-06)
Best objective -1.481977461342e+05, best bound -1.481977461342e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 172795.28
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -148197.75
  [DEBUG]   S×d_nominal = 320993.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 320993.02 + -148197.75 = 172795.28
  [DEBUG]   Current θ from Master = 191455.06
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18659.79 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13102.59
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 7848.5483, Absolute Gap = 7848.5483, Relative Gap = 0.247102
  Not converged yet (gap = 7848.55 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221614 nonzeros
Model fingerprint: 0x47a85bbf
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 37370 rows and 15170 columns
Presolve time: 0.65s
Presolved: 40463 rows, 18290 columns, 250369 nonzeros
Variable types: 16031 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 40463 rows, 18290 columns, 250369 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   28858    2.9143081e+04   0.000000e+00   1.067384e+09      5s
   45148    5.1614252e+04   0.000000e+00   1.209995e+06     10s
Concurrent spin time: 0.37s

Solved with dual simplex

Root relaxation: objective 5.717641e+04, 29864 iterations, 10.48 seconds (20.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57176.4125    0   69 -171254.74 57176.4125   133%     -   11s
H    0     0                    -168764.3946 57176.4125   134%     -   11s
H    0     0                    -153254.4995 57176.4125   137%     -   11s
H    0     0                    -124697.1108 57176.4125   146%     -   11s
H    0     0                    -123333.2194 57176.4125   146%     -   11s
H    0     0                    -122721.2260 57176.4125   147%     -   11s
H    0     0                    -122665.2446 57176.4125   147%     -   11s
H    0     0                    -122649.5133 57176.4125   147%     -   11s
H    0     0                    -42034.50931 57176.4125   236%     -   11s
H    0     0                    -10342.24156 57176.4125   653%     -   11s
H    0     0                    1818.6490344 57176.4125  3044%     -   11s
H    0     0                    11784.549153 57176.4125   385%     -   11s
H    0     0                    16899.637840 57176.4125   238%     -   12s
H    0     0                    17271.703758 57176.4125   231%     -   12s
     0     0 52160.3811    0  182 17271.7038 52160.3811   202%     -   15s
H    0     0                    17377.720455 52160.2470   200%     -   15s
H    0     0                    17826.852666 52160.2470   193%     -   16s
H    0     0                    19162.292600 52160.2470   172%     -   16s
     0     0 51980.4823    0  178 19162.2926 51980.4823   171%     -   17s
     0     0 51980.4823    0  180 19162.2926 51980.4823   171%     -   17s
     0     0 51980.4823    0  188 19162.2926 51980.4823   171%     -   17s
     0     0 51980.4823    0  180 19162.2926 51980.4823   171%     -   17s
H    0     0                    19742.684142 49366.9679   150%     -   21s
H    0     0                    19800.749603 49366.9679   149%     -   21s
H    0     0                    19932.694580 49366.9679   148%     -   21s
H    0     0                    19979.721944 49366.9679   147%     -   21s
H    0     0                    20242.815752 49366.9679   144%     -   21s
     0     0 49279.2926    0  245 20242.8158 49279.2926   143%     -   21s
H    0     0                    20274.752933 49279.2926   143%     -   21s
     0     0 48692.9771    0  240 20274.7529 48692.9771   140%     -   24s
     0     0 48590.8335    0  246 20274.7529 48590.8335   140%     -   24s
     0     0 48580.8413    0  240 20274.7529 48580.8413   140%     -   25s
     0     0 48579.8191    0  246 20274.7529 48579.8191   140%     -   25s
     0     0 48579.4717    0  248 20274.7529 48579.4717   140%     -   25s
H    0     0                    20288.071787 48579.4717   139%     -   27s
H    0     0                    20325.543475 48579.4717   139%     -   27s
H    0     0                    20354.144220 48579.4717   139%     -   27s
     0     0 46741.9162    0  273 20354.1442 46741.9162   130%     -   31s
H    0     0                    20588.517040 46741.5194   127%     -   31s
H    0     0                    23282.078606 46741.5194   101%     -   31s
H    0     0                    25203.718859 46741.5194  85.5%     -   31s
     0     0 46338.9075    0  300 25203.7189 46338.9075  83.9%     -   33s
     0     0 46024.6444    0  271 25203.7189 46024.6444  82.6%     -   35s
     0     0 45904.7400    0  281 25203.7189 45904.7400  82.1%     -   36s
     0     0 45780.6006    0  325 25203.7189 45780.6006  81.6%     -   38s
     0     0 45719.7929    0  324 25203.7189 45719.7929  81.4%     -   39s
     0     0 45642.0097    0  329 25203.7189 45642.0097  81.1%     -   39s
     0     0 45535.2478    0  329 25203.7189 45535.2478  80.7%     -   40s
     0     0 45505.8345    0  336 25203.7189 45505.8345  80.6%     -   41s
     0     0 45500.9856    0  343 25203.7189 45500.9856  80.5%     -   41s
     0     0 45499.1334    0  339 25203.7189 45499.1334  80.5%     -   42s
     0     0 45498.6906    0  340 25203.7189 45498.6906  80.5%     -   42s
     0     0 44815.1285    0  378 25203.7189 44815.1285  77.8%     -   46s
H    0     0                    25739.482649 44814.5837  74.1%     -   46s
     0     0 44767.0703    0  373 25739.4826 44767.0703  73.9%     -   47s
     0     0 44739.3007    0  367 25739.4826 44739.3007  73.8%     -   48s
     0     0 44703.1825    0  372 25739.4826 44703.1825  73.7%     -   49s
     0     0 44687.8123    0  367 25739.4826 44687.8123  73.6%     -   49s
     0     0 44669.0130    0  366 25739.4826 44669.0130  73.5%     -   49s
     0     0 44656.8704    0  372 25739.4826 44656.8704  73.5%     -   49s
     0     0 44653.5604    0  378 25739.4826 44653.5604  73.5%     -   50s
     0     0 44653.3321    0  376 25739.4826 44653.3321  73.5%     -   50s
     0     0 44475.9861    0  373 25739.4826 44475.9861  72.8%     -   51s
H    0     0                    26333.954201 44472.3075  68.9%     -   52s
     0     0 44433.8278    0  384 26333.9542 44433.8278  68.7%     -   52s
     0     0 44410.0990    0  387 26333.9542 44410.0990  68.6%     -   53s
     0     0 44405.1763    0  385 26333.9542 44405.1763  68.6%     -   53s
     0     0 44396.7996    0  387 26333.9542 44396.7996  68.6%     -   53s
     0     0 44390.3761    0  388 26333.9542 44390.3761  68.6%     -   53s
     0     0 44385.2241    0  387 26333.9542 44385.2241  68.5%     -   54s
     0     0 44383.7257    0  385 26333.9542 44383.7257  68.5%     -   54s
     0     0 44319.9824    0  374 26333.9542 44319.9824  68.3%     -   55s
     0     0 44304.4377    0  369 26333.9542 44304.4377  68.2%     -   56s
     0     0 44295.3990    0  377 26333.9542 44295.3990  68.2%     -   57s
     0     0 44293.6053    0  377 26333.9542 44293.6053  68.2%     -   57s
     0     0 44293.5173    0  373 26333.9542 44293.5173  68.2%     -   57s
     0     0 44278.7381    0  379 26333.9542 44278.7381  68.1%     -   58s
     0     0 44275.9915    0  383 26333.9542 44275.9915  68.1%     -   58s
     0     0 44275.7284    0  387 26333.9542 44275.7284  68.1%     -   58s
     0     0 44266.9464    0  373 26333.9542 44266.9464  68.1%     -   59s
     0     0 44266.1335    0  385 26333.9542 44266.1335  68.1%     -   59s
     0     0 44256.2006    0  388 26333.9542 44256.2006  68.1%     -   60s
     0     0 44251.9964    0  389 26333.9542 44251.9964  68.0%     -   60s
     0     0 44250.7594    0  391 26333.9542 44250.7594  68.0%     -   60s
     0     0 44249.6976    0  387 26333.9542 44249.6976  68.0%     -   61s
     0     0 44249.3266    0  387 26333.9542 44249.3266  68.0%     -   61s
     0     2 44249.3266    0  387 26333.9542 44249.3266  68.0%     -   71s
     3     8 43956.8011    2  378 26333.9542 44059.1153  67.3%  2814   78s
     7    16 43643.3321    3  377 26333.9542 43953.0924  66.9%  4440   82s
    15    32 43373.9819    4  367 26333.9542 43676.6769  65.9%  4206   87s
    31    57 40387.0049    5  304 26333.9542 43469.1086  65.1%  6338   97s
    56    89 40113.3393    6  333 26333.9542 43469.0919  65.1%  6014  108s
H   88   245                    26380.371654 43469.0919  64.8%  4668  113s
H  103   245                    26417.170984 43469.0919  64.5%  4117  113s
H  113   245                    26482.313298 43469.0919  64.1%  3825  113s
H  130   245                    26559.050426 43469.0919  63.7%  3533  113s
H  169   245                    26672.766833 43469.0919  63.0%  2986  113s
   244   324 38482.5219   12  290 26672.7668 43469.0919  63.0%  2350  116s
   323   382 39700.9000   12  296 26672.7668 43469.0919  63.0%  2102  120s
H  343   382                    26789.964447 43469.0919  62.3%  2078  120s
   447   492 39675.3065   12  309 26789.9644 43469.0919  62.3%  1965  127s
   491   568 39491.8138   13  303 26789.9644 43469.0919  62.3%  1935  131s
H  616   624                    26952.721447 43469.0919  61.3%  1803  133s
   631   711 38375.5978   13  286 26952.7214 43469.0919  61.3%  1773  139s
   720   743 38393.0084   18  262 26952.7214 43373.3038  60.9%  1680  141s
   789   816 38515.8128   16  262 26952.7214 43373.3038  60.9%  1663  149s
   830   851 37322.8314   17  275 26952.7214 43373.3038  60.9%  1657  152s
   868   890 38105.0904   19  193 26952.7214 43373.3038  60.9%  1649  158s
H  869   890                    26957.364263 43373.3038  60.9%  1647  158s
   924   954 38075.6398   19  199 26957.3643 43373.3038  60.9%  1609  161s
  1020  1032 37348.3304   19  261 26957.3643 43167.6809  60.1%  1553  166s
  1122  1109 37250.8287   20  206 26957.3643 43135.1699  60.0%  1516  170s
  1324  1252 37101.4984   21  200 26957.3643 43135.1699  60.0%  1468  178s
  1412  1354 35477.8384   22  216 26957.3643 43135.1699  60.0%  1462  181s
  1655  1608 35359.8197   22  258 26957.3643 43135.1699  60.0%  1387  188s
  1814  1638 35072.9537   22  206 26957.3643 42492.1945  57.6%  1336  190s
H 1818  1638                    27008.432684 42492.1945  57.3%  1336  190s
H 1847  1638                    27091.692594 42492.1636  56.8%  1334  190s
  2030  1811 35253.3273   23  168 27091.6926 42492.1636  56.8%  1280  197s
  2063  1865 35245.7656   23  195 27091.6926 42492.1636  56.8%  1280  200s
H 2092  1865                    27097.513241 42492.1636  56.8%  1271  200s
  2145  2004 33444.2074   24  158 27097.5132 42492.1636  56.8%  1254  206s
  2308  2136 31563.5141   28  106 27097.5132 42223.7721  55.8%  1231  211s
  2490  2264 33548.6733   28  140 27097.5132 42223.7721  55.8%  1201  217s
  2678  2306 30588.3110   30  113 27097.5132 42073.1698  55.3%  1182  222s
H 2707  2303                    27392.479056 41878.5473  52.9%  1182  222s
H 2724  2303                    27396.307047 41878.5473  52.9%  1181  222s
  2742  2375 33192.5273   31  147 27396.3070 41878.5473  52.9%  1180  226s
  2920  2459     cutoff   31      27396.3070 41878.5473  52.9%  1169  232s
  3062  2568     cutoff   33      27396.3070 41878.5473  52.9%  1176  238s
  3234  2690 40686.5752    9  335 27396.3070 41762.0766  52.4%  1174  245s
  3410  2823 39600.5420   12  270 27396.3070 41388.6227  51.1%  1178  252s
H 3599  2937                    27589.401779 41388.6227  50.0%  1172  257s
H 3604  2936                    27598.799489 41388.6227  50.0%  1172  257s
H 3663  2920                    27862.834166 41388.6227  48.5%  1163  257s
H 3679  2799                    28544.647765 41388.6227  45.0%  1159  257s
H 3768  2784                    28569.742557 41388.6227  44.9%  1151  260s
  3769  2773 34785.3662   12  387 28569.7426 41388.6227  44.9%  1151  272s
  3771  2774 29740.0647   50   69 28569.7426 41388.6227  44.9%  1150  280s
  3772  2775 28989.7528   25  282 28569.7426 41388.6227  44.9%  1150  287s
  3773  2776 28998.4458   77  273 28569.7426 41388.6227  44.9%  1149  291s
  3775  2777 34609.7730   22  369 28569.7426 41388.6227  44.9%  1149  297s
  3777  2778 33111.8482   44  395 28569.7426 41388.6227  44.9%  1148  300s
  3782  2782 28760.2199   27  382 28569.7426 41388.6227  44.9%  1147  306s
  3786  2784 34515.5709   22  396 28569.7426 41388.6227  44.9%  1145  310s
  3790  2787 37702.5007   19  440 28569.7426 41388.6227  44.9%  1144  315s
H 3793  2649                    28596.754312 41388.6227  44.7%  1143  323s
H 3795  2517                    28663.388476 41388.6227  44.4%  1143  324s
  3796  2518 35542.3916   25  396 28663.3885 41388.6227  44.4%  1142  325s
  3800  2521 35068.5796   29  395 28663.3885 41388.6227  44.4%  1141  338s
H 3800  2394                    28779.798107 41388.6227  43.8%  1141  344s
  3802  2398 41388.6227   12  379 28779.7981 41388.6227  43.8%  1166  352s
  3804  2401 41388.6227   13  423 28779.7981 41388.6227  43.8%  1167  357s
  3808  2408 41388.6227   14  425 28779.7981 41388.6227  43.8%  1170  367s
  3816  2421 41388.6227   15  436 28779.7981 41388.6227  43.8%  1178  378s
  3832  2440 39304.3098   16  322 28779.7981 41388.6227  43.8%  1215  389s
  3856  2464 38482.2033   17  380 28779.7981 41388.6227  43.8%  1253  396s
  3888  2564 38288.1555   18  372 28779.7981 41388.6227  43.8%  1279  405s
  3999  2595 37896.4390   21  351 28779.7981 41388.6227  43.8%  1302  410s
  4069  2616 34020.5354   19  361 28779.7981 41388.6227  43.8%  1331  416s
H 4070  2496                    28852.928648 41388.6227  43.4%  1331  416s
  4121  2534 33362.4264   20  358 28852.9286 41388.6227  43.4%  1347  422s
  4192  2567 37404.0380   22  285 28852.9286 41388.6227  43.4%  1362  427s
H 4240  2437                    29086.863822 41388.6227  42.3%  1366  427s
  4276  2477 35981.9386   23  279 29086.8638 41388.6227  42.3%  1366  433s
  4369  2471 34592.3108   24  315 29086.8638 41388.6227  42.3%  1367  437s
H 4370  2362                    29135.791814 41388.6227  42.1%  1367  437s
  4407  2406 34060.0285   25  261 29135.7918 41388.6227  42.1%  1372  441s
  4486  2403 33725.7379   27  265 29135.7918 41388.6227  42.1%  1374  446s
  4525  2412 33677.9467   28  261 29135.7918 41388.6227  42.1%  1378  452s
  4568  2418 32883.7925   29  262 29135.7918 41388.6227  42.1%  1384  462s
  4606  2431 33296.2679   29  268 29135.7918 41388.6227  42.1%  1390  466s
  4647  2441 32197.9001   27  249 29135.7918 41388.6227  42.1%  1397  472s
  4690  2454 33447.5606   28  273 29135.7918 41122.2879  41.1%  1406  478s
  4741  2463 32710.2835   30  233 29135.7918 41122.2879  41.1%  1410  484s
  4798  2477 31443.6921   32  221 29135.7918 41120.5025  41.1%  1416  491s
  4858  2498     cutoff   32      29135.7918 40652.5818  39.5%  1424  496s
  4931  2506 36563.2306   18  338 29135.7918 40616.9096  39.4%  1431  502s
  5031  2517 35899.2448   21  349 29135.7918 40616.9096  39.4%  1436  509s
  5135  2518 33546.8345   23  251 29135.7918 40325.7298  38.4%  1437  515s
  5239  2543 32421.8189   26  216 29135.7918 40310.8630  38.4%  1446  521s
  5348  2535 29399.2611   32  115 29135.7918 40310.8630  38.4%  1450  528s
  5467  2555 29857.8178   34  124 29135.7918 40068.9757  37.5%  1452  534s
  5569  2555 35579.1894   19  357 29135.7918 39870.5593  36.8%  1461  542s
  5681  2533 31982.7660   22  300 29135.7918 39870.0112  36.8%  1469  549s
  5811  2516 30501.7280   24  252 29135.7918 39810.5602  36.6%  1477  558s
  5926  2510 infeasible   26      29135.7918 39766.8600  36.5%  1489  565s
  6051  2483 34673.4642   26  339 29135.7918 39484.3814  35.5%  1503  572s
  6110  2483 32144.7407   27  286 29135.7918 39398.7548  35.2%  1513  579s
  6154  2501     cutoff   28      29135.7918 39398.7548  35.2%  1518  586s
  6197  2513 31029.3814   29  224 29135.7918 39398.7548  35.2%  1526  593s
  6261  2514 30388.0333   29  228 29135.7918 39359.4431  35.1%  1535  600s
  6338  2519     cutoff   30      29135.7918 39359.4431  35.1%  1543  607s
  6407  2538 30271.7282   31  218 29135.7918 39359.4431  35.1%  1550  616s
  6496  2544 33983.0072   24  266 29135.7918 39359.4431  35.1%  1560  625s
  6639  2553 32984.1492   27  257 29135.7918 39359.4431  35.1%  1562  635s
  6804  2557 30662.8756   30  229 29135.7918 39216.6228  34.6%  1568  645s
  6997  2564     cutoff   34      29135.7918 38906.1547  33.5%  1571  655s
  7195  2541 29934.4854   23  347 29135.7918 38872.3729  33.4%  1579  667s
  7340  2573     cutoff   24      29135.7918 38860.1159  33.4%  1581  678s
  7545  2544 34533.7721   21  206 29135.7918 38860.1159  33.4%  1588  688s
  7798  2516 31165.5784   26  207 29135.7918 38664.0291  32.7%  1589  698s
  8048  2479 29755.5920   19  336 29135.7918 38547.5394  32.3%  1593  710s
  8337  2420     cutoff   37      29135.7918 38469.6905  32.0%  1595  721s
  8479  2431 36438.0987   19  220 29135.7918 38469.6905  32.0%  1599  734s
  8704  2428 32055.4853   27  174 29135.7918 38176.8272  31.0%  1606  747s
  8973  2396 35130.9675   24  206 29135.7918 37935.7444  30.2%  1615  760s
  9186  2413 31312.7003   26  177 29135.7918 37929.1440  30.2%  1619  772s
  9501  2351     cutoff   38      29135.7918 37870.7354  30.0%  1626  785s
  9824  2315 29876.8772   25  265 29135.7918 37593.2353  29.0%  1633  801s
 10176  2351 30647.0575   25  263 29135.7918 37414.5920  28.4%  1636  817s
 10514  2423 infeasible   22      29135.7918 37126.5146  27.4%  1644  831s
 10859  2486 29974.7111   26  338 29135.7918 37095.7344  27.3%  1655  845s
 11300  2499     cutoff   29      29135.7918 36754.6702  26.1%  1650  860s
 11767  2550 30154.5517   28  290 29135.7918 36530.2395  25.4%  1647  879s
 12138  2631 30401.5802   31  138 29135.7918 36432.6176  25.0%  1659  898s
 12604  2708 30053.9868   24  308 29135.7918 36236.7991  24.4%  1662  914s
 13094  2796 31373.7923   27  230 29135.7918 35998.3034  23.6%  1663  931s
 13635  2844 31890.6644   23  324 29135.7918 35714.1220  22.6%  1660  949s
 14137  2963     cutoff   25      29135.7918 35714.1220  22.6%  1654  968s
 14778  3010 32388.9118   25  259 29135.7918 35471.0848  21.7%  1643  988s
*14911  3008             125    29156.736314 35471.0848  21.7%  1639  988s
 15389  3101 32141.8716   24  215 29156.7363 35116.1477  20.4%  1640 1009s
 16043  3146     cutoff   37      29156.7363 35044.5965  20.2%  1635 1029s
 16705  3150     cutoff   30      29156.7363 34750.7512  19.2%  1633 1049s
 17271  3133 29336.6793   25  316 29156.7363 34574.0576  18.6%  1634 1071s
 17923  3139 31009.8913   23  275 29156.7363 34431.0437  18.1%  1633 1093s
 18673  3179     cutoff   32      29156.7363 34292.4006  17.6%  1628 1116s
 19292  3143     cutoff   29      29156.7363 34151.3270  17.1%  1626 1142s
H19311  3130                    29251.494913 34151.3270  16.8%  1626 1142s
H19357  3014                    29630.958404 34151.3270  15.3%  1626 1142s
H19532  3009                    29652.655752 34120.3284  15.1%  1627 1142s
H19882  3005                    29669.812965 34120.3284  15.0%  1628 1142s
 19914  2921 30260.3357   32  200 29669.8130 34120.3284  15.0%  1627 1168s
 20832  2804 31329.4087   25  206 29669.8130 33716.8807  13.6%  1618 1193s
 21725  2599 30109.9974   28  278 29669.8130 33428.7733  12.7%  1613 1219s
 22693  2349 30091.7779   31  192 29669.8130 33039.0146  11.4%  1607 1246s
 23671  2102 30458.5937   26  297 29669.8130 32748.9959  10.4%  1603 1276s
 24814  1561 30227.4376   36   99 29669.8130 32364.8643  9.08%  1590 1304s
 26232  1473     cutoff   30      29669.8130 31951.0139  7.69%  1562 1330s
*27338  1473              88    29694.619758 31825.1447  7.17%  1517 1330s
 29661  3007 29786.2637   42   93 29694.6198 31102.8264  4.74%  1427 1339s
*30296  3007              77    29718.624419 31094.8319  4.63%  1399 1339s
 34845  3411     cutoff   71      29718.6244 30462.2569  2.50%  1227 1341s
*34939  2848              78    29780.721407 30462.2569  2.29%  1224 1341s
*39597  2881              90    29781.480529 30072.2855  0.98%  1087 1344s
 40609  2983     cutoff   65      29781.4805 30013.4353  0.78%  1061 1346s
*40990  2880             100    29786.817288 30012.9168  0.76%  1052 1346s
 45143  2828     cutoff   70      29786.8173 29905.6027  0.40%   959 1350s
H46333  2497                    29799.366658 29897.0645  0.33%   936 1350s
*46569  2025              81    29813.121800 29897.0645  0.28%   931 1350s
*49052   457              85    29814.448098 29861.8127  0.16%   885 1351s
*50584   450              94    29822.467783 29859.4561  0.12%   859 1351s
*51086     0              89    29825.973872 29841.9279  0.05%   851 1352s

Cutting planes:
  Learned: 2
  MIR: 804
  Mixing: 1
  Flow cover: 1267
  RLT: 16
  Relax-and-lift: 92

Explored 51558 nodes (43596222 simplex iterations) in 1352.26 seconds (4169.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 29826 29826 29822.5 ... 29718.6

Optimal solution found (tolerance 1.00e-06)
Best objective 2.982597387193e+04, best bound 2.982597387193e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1352.27s
  Master Objective (UB) = 29825.97, θ = 178947.71
  Upper Bound (UB) = 29825.97

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 178947.71
  [DEBUG]   ✓ Scenario 0: θ = 178947.71 ≤ Q = 181527.48 (slack: 2579.77)
  [DEBUG]   ✓ Scenario 1: θ = 178947.71 ≤ Q = 178958.79 (slack: 11.08)
  [DEBUG]   ✓ Scenario 2: θ = 178947.71 ≤ Q = 178947.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 178947.71 ≤ Q = 178947.71 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 178947.71 ≤ Q = 178947.71 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x36c7b634
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x36c7b634
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.353583e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.00s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6264554.2475
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6264224.9032

Root relaxation: objective -1.575265e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157526.52    0  124 6264224.90 -157526.52   103%     -    0s
H    0     0                    -119348.9981 -157526.52  32.0%     -    0s
H    0     0                    -130923.1231 -157526.52  20.3%     -    0s
H    0     0                    -133651.0457 -144090.12  7.81%     -    0s
     0     0 -144090.12    0   64 -133651.05 -144090.12  7.81%     -    0s
H    0     0                    -141558.2672 -143976.84  1.71%     -    0s
H    0     0                    -141859.7831 -143976.84  1.49%     -    0s
H    0     0                    -142002.1859 -143976.84  1.39%     -    0s
H    0     0                    -142303.7017 -143976.84  1.18%     -    0s
     0     0 -143543.42    0   78 -142303.70 -143543.42  0.87%     -    0s
     0     0 -143059.80    0   41 -142303.70 -143059.80  0.53%     -    0s
H    0     0                    -142309.7001 -143051.45  0.52%     -    0s
     0     0 -142915.45    0   31 -142309.70 -142915.45  0.43%     -    0s
     0     0 -142915.45    0   31 -142309.70 -142915.45  0.43%     -    0s
     0     0 -142864.36    0   32 -142309.70 -142864.36  0.39%     -    0s
     0     0 -142850.97    0   32 -142309.70 -142850.97  0.38%     -    0s
     0     0 -142729.45    0   42 -142309.70 -142729.45  0.29%     -    0s
     0     0 -142682.84    0   39 -142309.70 -142682.84  0.26%     -    0s
     0     0 -142677.50    0   39 -142309.70 -142677.50  0.26%     -    0s
     0     0 -142528.93    0   23 -142309.70 -142528.93  0.15%     -    0s
     0     0 -142528.89    0   22 -142309.70 -142528.89  0.15%     -    0s
     0     0 -142485.61    0   26 -142309.70 -142485.61  0.12%     -    0s
     0     0 -142482.44    0   27 -142309.70 -142482.44  0.12%     -    0s
     0     0 -142366.50    0   11 -142309.70 -142366.50  0.04%     -    0s
     0     0 -142343.36    0   11 -142309.70 -142343.36  0.02%     -    0s
     0     0 -142335.42    0    7 -142309.70 -142335.42  0.02%     -    0s
     0     0 -142314.08    0    3 -142309.70 -142314.08  0.00%     -    0s
*    0     0               0    -142314.0473 -142314.05  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 2
  MIR: 1
  Flow cover: 3
  RLT: 1

Explored 1 nodes (816 simplex iterations) in 0.05 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -142314 -142310 -142304 ... 6.26455e+06
No other solutions better than -142314

Optimal solution found (tolerance 1.00e-06)
Best objective -1.423140472854e+05, best bound -1.423140472854e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 160717.79
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -142314.05
  [DEBUG]   S×d_nominal = 303031.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 303031.84 + -142314.05 = 160717.79
  [DEBUG]   Current θ from Master = 178947.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 18229.92 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 11596.06
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 5912.1479, Absolute Gap = 5912.1479, Relative Gap = 0.198221
  Not converged yet (gap = 5912.15 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264833 nonzeros
Model fingerprint: 0x547c804e
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 44844 rows and 18204 columns
Presolve time: 0.81s
Presolved: 48279 rows, 21496 columns, 299339 nonzeros
Variable types: 19237 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 48279 rows, 21496 columns, 299339 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   30831    4.4790739e+03   0.000000e+00   5.353796e+07      5s
   48591    3.4806701e+04   0.000000e+00   6.906124e+07     10s
   65293    4.7886111e+04   0.000000e+00   1.546797e+07     15s
Concurrent spin time: 0.27s

Solved with dual simplex

Root relaxation: objective 5.717580e+04, 37054 iterations, 14.40 seconds (28.90 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57175.7994    0   69 -171254.74 57175.7994   133%     -   15s
H    0     0                    -167277.2488 57175.7994   134%     -   15s
H    0     0                    -64795.70451 57175.7994   188%     -   15s
H    0     0                    -64432.99659 57175.7994   189%     -   15s
H    0     0                    -56268.50261 57175.7994   202%     -   15s
H    0     0                    8672.0713863 57175.7994   559%     -   15s
H    0     0                    9518.4648764 57175.7994   501%     -   15s
H    0     0                    9706.6581429 57175.7994   489%     -   15s
H    0     0                    11784.549153 57175.7994   385%     -   15s
H    0     0                    11796.828907 57175.7994   385%     -   16s
     0     0 54094.7455    0  169 11796.8289 54094.7455   359%     -   20s
H    0     0                    14076.512826 54094.6517   284%     -   20s
H    0     0                    14077.071787 53911.0154   283%     -   22s
     0     0 53908.4124    0  180 14077.0718 53908.4124   283%     -   22s
     0     0 53908.4124    0  178 14077.0718 53908.4124   283%     -   22s
H    0     0                    15231.089750 50845.0412   234%     -   27s
H    0     0                    15399.816381 50845.0412   230%     -   27s
H    0     0                    16046.803719 50845.0412   217%     -   27s
     0     0 50845.0412    0  203 16046.8037 50845.0412   217%     -   27s
H    0     0                    17555.308404 50844.9005   190%     -   27s
H    0     0                    20713.812571 50844.9005   145%     -   27s
H    0     0                    20773.662384 50844.9005   145%     -   27s
H    0     0                    20866.078555 50844.9005   144%     -   27s
     0     0 50016.0818    0  219 20866.0786 50016.0818   140%     -   30s
     0     0 49787.5123    0  209 20866.0786 49787.5123   139%     -   33s
     0     0 49674.6362    0  211 20866.0786 49674.6362   138%     -   34s
     0     0 49651.1355    0  242 20866.0786 49651.1355   138%     -   34s
     0     0 49646.2408    0  213 20866.0786 49646.2408   138%     -   34s
     0     0 49646.0029    0  211 20866.0786 49646.0029   138%     -   34s
H    0     0                    21032.177917 49646.0029   136%     -   37s
H    0     0                    21066.381179 49646.0029   136%     -   37s
H    0     0                    21100.205761 49646.0029   135%     -   37s
H    0     0                    21213.411421 49646.0029   134%     -   37s
H    0     0                    21219.621837 49646.0029   134%     -   37s
H    0     0                    24038.469321 49646.0029   107%     -   37s
H    0     0                    24069.867015 49646.0029   106%     -   37s
H    0     0                    24140.756389 49646.0029   106%     -   37s
H    0     0                    24156.966298 49646.0029   106%     -   37s
H    0     0                    24394.612977 47411.2452  94.4%     -   43s
     0     0 47411.2452    0  249 24394.6130 47411.2452  94.4%     -   43s
H    0     0                    24568.120695 47411.0520  93.0%     -   43s
     0     0 46705.8036    0  296 24568.1207 46705.8036  90.1%     -   47s
     0     0 46435.7678    0  297 24568.1207 46435.7678  89.0%     -   50s
     0     0 46332.6853    0  295 24568.1207 46332.6853  88.6%     -   51s
     0     0 46302.9272    0  292 24568.1207 46302.9272  88.5%     -   52s
     0     0 46172.5331    0  285 24568.1207 46172.5331  87.9%     -   53s
     0     0 46144.8340    0  305 24568.1207 46144.8340  87.8%     -   54s
     0     0 46128.4334    0  300 24568.1207 46128.4334  87.8%     -   54s
     0     0 46122.7448    0  307 24568.1207 46122.7448  87.7%     -   54s
     0     0 46120.4101    0  305 24568.1207 46120.4101  87.7%     -   55s
     0     0 46120.1749    0  305 24568.1207 46120.1749  87.7%     -   55s
     0     0 45384.4891    0  355 24568.1207 45384.4891  84.7%     -   59s
     0     0 45200.7274    0  363 24568.1207 45200.7274  84.0%     -   61s
     0     0 45117.9254    0  364 24568.1207 45117.9254  83.6%     -   62s
     0     0 45047.7098    0  373 24568.1207 45047.7098  83.4%     -   62s
     0     0 45012.3750    0  373 24568.1207 45012.3750  83.2%     -   63s
H    0     0                    24614.035119 44984.1412  82.8%     -   64s
     0     0 44984.1412    0  372 24614.0351 44984.1412  82.8%     -   64s
     0     0 44974.2514    0  381 24614.0351 44974.2514  82.7%     -   65s
     0     0 44971.6212    0  383 24614.0351 44971.6212  82.7%     -   65s
     0     0 44969.2983    0  384 24614.0351 44969.2983  82.7%     -   65s
     0     0 44969.0150    0  380 24614.0351 44969.0150  82.7%     -   66s
     0     0 44826.2160    0  400 24614.0351 44826.2160  82.1%     -   68s
     0     0 44763.7829    0  419 24614.0351 44763.7829  81.9%     -   70s
     0     0 44719.3758    0  414 24614.0351 44719.3758  81.7%     -   71s
     0     0 44704.7359    0  419 24614.0351 44704.7359  81.6%     -   72s
     0     0 44700.7171    0  426 24614.0351 44700.7171  81.6%     -   73s
     0     0 44696.7102    0  428 24614.0351 44696.7102  81.6%     -   73s
     0     0 44692.5981    0  389 24614.0351 44692.5981  81.6%     -   73s
     0     0 44691.1650    0  419 24614.0351 44691.1650  81.6%     -   74s
     0     0 44565.0992    0  384 24614.0351 44565.0992  81.1%     -   76s
     0     0 44486.9829    0  397 24614.0351 44486.9829  80.7%     -   78s
     0     0 44465.3565    0  404 24614.0351 44465.3565  80.7%     -   79s
     0     0 44457.8505    0  403 24614.0351 44457.8505  80.6%     -   79s
     0     0 44455.6272    0  397 24614.0351 44455.6272  80.6%     -   80s
     0     0 44454.7629    0  401 24614.0351 44454.7629  80.6%     -   80s
     0     0 44366.6227    0  400 24614.0351 44366.6227  80.2%     -   82s
H    0     0                    24714.524348 44361.5134  79.5%     -   82s
     0     0 44349.6222    0  408 24714.5243 44349.6222  79.4%     -   83s
     0     0 44330.5113    0  393 24714.5243 44330.5113  79.4%     -   84s
     0     0 44320.2764    0  404 24714.5243 44320.2764  79.3%     -   84s
     0     0 44313.9164    0  401 24714.5243 44313.9164  79.3%     -   84s
     0     0 44310.9293    0  397 24714.5243 44310.9293  79.3%     -   84s
     0     0 44309.2430    0  401 24714.5243 44309.2430  79.3%     -   84s
     0     0 44309.0581    0  400 24714.5243 44309.0581  79.3%     -   84s
     0     0 44279.8324    0  447 24714.5243 44279.8324  79.2%     -   86s
     0     0 44261.3532    0  389 24714.5243 44261.3532  79.1%     -   87s
     0     0 44250.8170    0  397 24714.5243 44250.8170  79.0%     -   87s
     0     0 44246.0333    0  401 24714.5243 44246.0333  79.0%     -   88s
     0     0 44245.3248    0  400 24714.5243 44245.3248  79.0%     -   88s
     0     0 44240.5067    0  435 24714.5243 44240.5067  79.0%     -   89s
     0     0 44234.0033    0  463 24714.5243 44234.0033  79.0%     -   90s
     0     0 44234.0033    0  428 24714.5243 44234.0033  79.0%     -   90s
     0     0 44226.4786    0  399 24714.5243 44226.4786  78.9%     -   91s
     0     0 44222.3229    0  404 24714.5243 44222.3229  78.9%     -   91s
     0     0 44221.1574    0  400 24714.5243 44221.1574  78.9%     -   92s
     0     0 44217.8684    0  400 24714.5243 44217.8684  78.9%     -   92s
     0     0 44214.3650    0  402 24714.5243 44214.3650  78.9%     -   93s
     0     0 44213.0098    0  404 24714.5243 44213.0098  78.9%     -   93s
     0     0 44207.4647    0  410 24714.5243 44207.4647  78.9%     -   94s
     0     0 44206.7619    0  410 24714.5243 44206.7619  78.9%     -   94s
H    0     0                    24768.425777 44205.0256  78.5%     -  108s
     0     2 44205.0256    0  410 24768.4258 44205.0256  78.5%     -  108s
     3     8 43912.2478    2  395 24768.4258 44160.4878  78.3%  3368  113s
     7    16 43642.1977    3  393 24768.4258 43930.4726  77.4%  4116  118s
    15    32 43394.6657    4  428 24768.4258 43795.9626  76.8%  4968  123s
    31    48 41815.3657    5  370 24768.4258 43393.4582  75.2%  7069  135s
    47    80 41657.5337    6  370 24768.4258 43393.4582  75.2%  7110  141s
H   48    80                    25836.802258 43393.4582  68.0%  6962  141s
H   55    80                    26708.818227 43393.4582  62.5%  6709  141s
    79   144 41332.4052    7  361 26708.8182 43393.4582  62.5%  5549  156s
   143   276 41211.5180    9  349 26708.8182 43393.4582  62.5%  3865  164s
   275   387 41070.4012   11  348 26708.8182 43393.4582  62.5%  2943  170s
   386   468 40622.2735   10  356 26708.8182 43393.4582  62.5%  2611  175s
H  474   549                    27008.432684 43393.4582  60.7%  2479  179s
H  513   549                    27058.747281 43393.4582  60.4%  2421  179s
   548   632 40867.5941   12  353 27058.7473 43393.4582  60.4%  2379  183s
H  555   632                    27159.074685 43393.4582  59.8%  2361  183s
   631   716 40539.4621   11  347 27159.0747 43393.4582  59.8%  2303  186s
H  718   794                    27179.500498 43393.4582  59.7%  2214  189s
   793   823 40356.6622   11  329 27179.5005 43393.4582  59.7%  2148  193s
   826   858 40758.1820   13  350 27179.5005 43393.4582  59.7%  2168  196s
H  846   858                    27223.346377 43393.4582  59.4%  2184  196s
   865   959 40090.4472   12  282 27223.3464 43393.4582  59.4%  2190  200s
   973  1031 40489.0390   13  349 27223.3464 43393.4582  59.4%  2118  207s
  1070  1070 38994.4897   13  315 27223.3464 43393.4582  59.4%  2051  213s
  1121  1122 36999.2522   12  263 27223.3464 43393.4582  59.4%  2033  220s
  1214  1150 39624.4319   14  306 27223.3464 43393.4582  59.4%  1979  227s
  1302  1210 40565.3381   14  347 27223.3464 43393.4582  59.4%  1992  233s
  1382  1240 39518.9074   14  300 27223.3464 43393.4582  59.4%  2078  237s
  1466  1269 36120.6466   14  349 27223.3464 43393.4582  59.4%  2142  242s
  1501  1303 39529.0438   15  314 27223.3464 43393.4582  59.4%  2213  246s
  1555  1328 38485.5617   14  306 27223.3464 43393.4582  59.4%  2271  250s
  1594  1359 39171.4759   15  301 27223.3464 43393.4582  59.4%  2307  256s
  1652  1406 36084.0561   15  266 27223.3464 43393.4582  59.4%  2340  262s
  1736  1439 38842.6863   16  303 27223.3464 43324.5268  59.1%  2356  270s
  1811  1491 38856.9955   17  305 27223.3464 43324.5268  59.1%  2398  275s
  1879  1563 36605.4974   18  267 27223.3464 43324.5268  59.1%  2464  282s
  1967  1638 36346.4816   19  261 27223.3464 43324.5268  59.1%  2513  288s
  2066  1713 35717.0780   22  207 27223.3464 43324.5268  59.1%  2552  297s
  2173  1803 35171.7508   24  249 27223.3464 43324.5268  59.1%  2566  302s
  2282  1913 35084.1123   26  252 27223.3464 43324.5268  59.1%  2591  310s
  2426  2042 34930.4350   27  254 27223.3464 43101.9117  58.3%  2608  319s
  2580  2182 34747.8987   28  205 27223.3464 43020.3464  58.0%  2602  328s
  2758  2313 34730.2738   29  256 27223.3464 43020.3464  58.0%  2582  336s
  2943  2479 33699.9488   30  240 27223.3464 43020.3464  58.0%  2581  342s
  3150  2637     cutoff   34      27223.3464 43020.3464  58.0%  2548  352s
  3377  2795 31442.0535   36  165 27223.3464 43020.3464  58.0%  2526  362s
  3620  2796 39596.7900    8  410 27223.3464 43020.3464  58.0%  2475  383s
  3622  2797 34143.2089   23   69 27223.3464 43020.3464  58.0%  2474  395s
  3623  2798 40966.8833   11  264 27223.3464 43020.3464  58.0%  2473  405s
  3624  2799 36407.4306    9  339 27223.3464 43020.3464  58.0%  2472  413s
  3625  2799 35239.2071   22  415 27223.3464 43020.3464  58.0%  2471  419s
  3626  2800 34727.2205   20  414 27223.3464 43020.3464  58.0%  2471  422s
  3628  2801 34397.7593   32  421 27223.3464 43020.3464  58.0%  2469  426s
  3632  2804 31144.0539   20  408 27223.3464 43020.3464  58.0%  2467  430s
  3635  2806 36184.0383   18  405 27223.3464 43020.3464  58.0%  2465  435s
  3639  2809 32830.2775   54  438 27223.3464 43020.3464  58.0%  2462  440s
  3643  2811 33344.5749    8  394 27223.3464 43020.3464  58.0%  2459  446s
  3647  2814 30489.6230   60  455 27223.3464 43020.3464  58.0%  2457  450s
  3650  2816 32495.2534   31  451 27223.3464 43020.3464  58.0%  2455  456s
  3653  2818 28672.1586   43  452 27223.3464 43020.3464  58.0%  2453  461s
  3656  2820 34870.7411   18  487 27223.3464 43020.3464  58.0%  2451  465s
  3659  2822 29021.9859   61  489 27223.3464 43020.3464  58.0%  2449  470s
  3661  2823 33141.0321   28  488 27223.3464 43020.3464  58.0%  2447  485s
  3662  2824 33083.8965   29  488 27223.3464 43020.3464  58.0%  2447  495s
  3663  2828 43020.3464   12  408 27223.3464 43020.3464  58.0%  2481  505s
  3665  2831 43020.3464   13  476 27223.3464 43020.3464  58.0%  2482  513s
  3669  2838 43020.3464   14  472 27223.3464 43020.3464  58.0%  2485  522s
  3677  2851 43020.3464   15  399 27223.3464 43020.3464  58.0%  2493  532s
  3693  2862 39180.4447   16  377 27223.3464 43020.3464  58.0%  2517  548s
  3709  2888 41576.8855   17  390 27223.3464 43020.3464  58.0%  2550  556s
  3741  2985 41423.9643   18  355 27223.3464 43020.3464  58.0%  2553  567s
  3852  3016 40654.9987   21  344 27223.3464 43020.3464  58.0%  2562  575s
  3922  3044 40414.8214   20  352 27223.3464 43020.3464  58.0%  2571  583s
  3985  3053 40632.6244   22  349 27223.3464 43020.3464  58.0%  2580  589s
  4018  3085 39603.1132   22  323 27223.3464 43020.3464  58.0%  2586  596s
  4074  3098 38952.0370   21  326 27223.3464 43020.3464  58.0%  2578  601s
  4108  3144 39071.1245   21  348 27223.3464 43020.3464  58.0%  2574  606s
  4180  3145 36081.3248   22  362 27223.3464 43020.3464  58.0%  2550  613s
H 4182  3003                    27597.949686 43020.3464  55.9%  2549  613s
  4216  3046 35035.2533   22  355 27597.9497 43020.3464  55.9%  2550  620s
  4306  3064 39985.2885   23  349 27597.9497 43020.3464  55.9%  2532  626s
  4380  3066 39618.3418   24  325 27597.9497 43020.3464  55.9%  2522  635s
H 4517  2948                    27617.296046 43020.3464  55.8%  2505  647s
H 4521  2819                    27788.935451 43020.3464  54.8%  2505  647s
  4580  2832 38400.8018   26  317 27788.9355 43020.3464  54.8%  2496  654s
  4658  2845 37189.3485   27  294 27788.9355 43020.3464  54.8%  2489  662s
  4753  2843 36515.3890   27  224 27788.9355 42561.6428  53.2%  2469  671s
  4849  2855 35402.1938   28  242 27788.9355 42559.6177  53.2%  2458  679s
  4921  2882 33487.6766   29  215 27788.9355 42559.6177  53.2%  2467  688s
  5003  2899 36646.5811   29  227 27788.9355 42429.4883  52.7%  2468  697s
  5091  2901 35128.2697   31  210 27788.9355 42159.5024  51.7%  2473  703s
H 5102  2775                    27853.176354 42159.5024  51.4%  2472  703s
  5140  2815 34456.5409   31  202 27853.1764 42159.5024  51.4%  2469  711s
  5227  2847 34856.1085   31  249 27853.1764 41833.4080  50.2%  2472  719s
  5317  2875 30111.9468   32  179 27853.1764 41833.4080  50.2%  2476  728s
  5439  2879 30948.9934   31  161 27853.1764 41572.8202  49.3%  2471  737s
  5554  2907 31389.5905   32  170 27853.1764 41572.8202  49.3%  2469  746s
  5663  2911 33015.2370   34  194 27853.1764 41368.7810  48.5%  2467  755s
H 5666  2794                    27935.981120 41368.7810  48.1%  2467  755s
  5751  2793 31104.2522   35  227 27935.9811 41367.8975  48.1%  2468  763s
  5788  2810 28178.2438   35  149 27935.9811 41367.8975  48.1%  2473  769s
H 5814  2693                    27982.877480 41367.8975  47.8%  2477  769s
  5841  2742 32108.8305   34  229 27982.8775 41367.8975  47.8%  2474  779s
  5977  2732 31103.2405   35  243 27982.8775 41367.8975  47.8%  2471  789s
  6123  2741 29916.6450   36  193 27982.8775 41205.5832  47.3%  2465  799s
  6263  2745     cutoff   38      27982.8775 41205.5832  47.3%  2464  810s
  6424  2716 32828.9982   24  277 27982.8775 41205.5832  47.3%  2459  824s
  6499  2764 32712.8492   25  251 27982.8775 41205.5832  47.3%  2472  836s
  6644  2803 32430.0390   26  242 27982.8775 41205.5832  47.3%  2473  848s
  6814  2793     cutoff   27      27982.8775 40246.1059  43.8%  2467  861s
  7005  2795     cutoff   30      27982.8775 40246.1059  43.8%  2456  874s
  7172  2852 30649.7293   19  303 27982.8775 40246.1059  43.8%  2463  887s
  7365  2839     cutoff   24      27982.8775 40246.1059  43.8%  2461  901s
  7512  2845 34971.0831   23  239 27982.8775 40246.1059  43.8%  2451  915s
  7686  2860 28109.4203   26  173 27982.8775 39762.8240  42.1%  2450  932s
  7915  2888 31311.8895   21  316 27982.8775 39313.6607  40.5%  2438  946s
  8107  2908 28845.5293   27  244 27982.8775 39203.0136  40.1%  2442  962s
  8361  2926 36423.8187   21  287 27982.8775 39203.0136  40.1%  2433  976s
  8602  2874 31723.5447   29  287 27982.8775 38943.1956  39.2%  2433  993s
  8763  2977 31389.5337   30  177 27982.8775 38898.0916  39.0%  2427 1008s
  9010  3013 28364.4156   36  159 27982.8775 38773.4773  38.6%  2430 1025s
  9350  3020 34788.0138   22  181 27982.8775 38742.8475  38.5%  2410 1044s
  9679  3100 35651.5304   18  336 27982.8775 38742.8475  38.5%  2402 1064s
 10058  3131 32600.7993   25  253 27982.8775 38596.3200  37.9%  2386 1083s
 10430  3248 29505.4910   20  346 27982.8775 38106.2414  36.2%  2379 1104s
 10803  3387 35909.8825   26  283 27982.8775 38106.2414  36.2%  2375 1125s
 11197  3592 29648.8221   34  187 27982.8775 37594.6414  34.3%  2368 1147s
 11673  3716 31670.8004   26  307 27982.8775 37594.6414  34.3%  2347 1168s
*11781  3572             116    28707.907921 37455.2682  30.5%  2345 1168s
 12104  3700 34554.7362   27  240 28707.9079 37455.2682  30.5%  2340 1192s
 12572  3822 30754.3334   30  230 28707.9079 37307.4871  30.0%  2329 1214s
H12580  3775                    28815.731918 37307.4871  29.5%  2328 1214s
H12610  3706                    29008.827705 37307.4871  28.6%  2329 1214s
H12656  3599                    29231.871438 37307.4871  27.6%  2325 1214s
 12981  3698     cutoff   30      29231.8714 37138.0964  27.0%  2321 1241s
 13458  3796 32515.8838   28  191 29231.8714 36887.8656  26.2%  2317 1265s
 13946  3893 34383.4411   32  225 29231.8714 36884.9578  26.2%  2316 1290s
 14448  3941 32857.3827   20  247 29231.8714 36613.9204  25.3%  2309 1315s
 15031  4064 32642.5069   22  291 29231.8714 36607.9279  25.2%  2297 1342s
 15587  4172 30570.2747   28  263 29231.8714 36592.0543  25.2%  2293 1372s
 16127  4336     cutoff   30      29231.8714 36429.4689  24.6%  2294 1401s
 16779  4468 32394.1642   26  200 29231.8714 36305.2095  24.2%  2283 1431s
H17196  4425                    29311.569207 36188.1369  23.5%  2275 1431s
 17475  4452 33134.2342   24  285 29311.5692 36092.3731  23.1%  2270 1464s
H17966  4358                    29451.341154 36081.2269  22.5%  2264 1464s
 18161  4405 30285.8429   27  236 29451.3412 36070.6220  22.5%  2265 1492s
H18178  4362                    29515.615760 36070.6220  22.2%  2263 1492s
 18566  4439 34283.0208   27  256 29515.6158 35887.0595  21.6%  2263 1524s
 19334  4480 33954.6293   27  253 29515.6158 35846.8138  21.5%  2253 1558s
H19354  4468                    29523.324493 35846.8138  21.4%  2253 1558s
H19436  4467                    29525.270626 35765.2824  21.1%  2251 1558s
H19764  4432                    29592.668977 35688.1942  20.6%  2249 1558s
 19789  4512 34670.0526   22  201 29592.6690 35688.1942  20.6%  2249 1595s
H20601  4407                    29777.686423 35588.1381  19.5%  2241 1627s
 20814  4419 30244.8592   30  240 29777.6864 35454.9723  19.1%  2238 1666s
 21691  4430 30805.8090   26  187 29777.6864 35224.6586  18.3%  2231 1705s
 22254  4460 32729.7534   26  298 29777.6864 35150.6317  18.0%  2228 1747s
 23201  4419 33772.4240   22  256 29777.6864 34936.5189  17.3%  2221 1788s
 24114  4358 32708.7248   35  171 29777.6864 34756.2851  16.7%  2222 1835s
 25089  4282     cutoff   27      29777.6864 34515.2729  15.9%  2218 1882s
 26100  4168     cutoff   37      29777.6864 34396.2636  15.5%  2215 1928s
 27167  3984     cutoff   25      29777.6864 34115.7626  14.6%  2211 1977s
 28287  3743 31547.9439   24  232 29777.6864 33872.4518  13.8%  2205 2029s
 29496  3379 30810.8025   29  202 29777.6864 33561.4585  12.7%  2197 2078s
 30713  2957 30159.6989   30  286 29777.6864 33237.1616  11.6%  2190 2130s
 32043  2368     cutoff   37      29777.6864 32802.2022  10.2%  2178 2185s
 33506  1097     cutoff   25      29777.6864 32406.0788  8.83%  2161 2234s
 35700   790     cutoff   31      29777.6864 31752.3267  6.63%  2095 2286s
H35749   790                    29790.726088 31703.2598  6.42%  2093 2286s
H35750   790                    29814.448098 31703.2598  6.34%  2093 2286s
 36199   919     cutoff   39      29814.4481 31421.6614  5.39%  2074 2303s
 40137    83 29831.7138   58   50 29814.4481 30296.6226  1.62%  1880 2310s

Cutting planes:
  Learned: 1
  MIR: 1165
  Mixing: 5
  Flow cover: 1932
  RLT: 22
  Relax-and-lift: 111

Explored 44379 nodes (75878513 simplex iterations) in 2312.12 seconds (7338.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 29814.4 29814.4 29790.7 ... 29311.6

Optimal solution found (tolerance 1.00e-06)
Best objective 2.981444809826e+04, best bound 2.981444809826e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2312.18s
  Master Objective (UB) = 29814.45, θ = 179089.56
  Upper Bound (UB) = 29814.45

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179089.56
  [DEBUG]   ✓ Scenario 0: θ = 179089.56 ≤ Q = 179277.70 (slack: 188.14)
  [DEBUG]   ✓ Scenario 1: θ = 179089.56 ≤ Q = 179089.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179089.56 ≤ Q = 179089.56 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179089.56 ≤ Q = 179089.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179089.56 ≤ Q = 179089.56 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 179089.56 ≤ Q = 179089.56 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7e51f3ac
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7e51f3ac
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.352020e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.00s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6241805.2388
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6241475.8945

Root relaxation: objective -1.520355e+05, 232 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152035.46    0  123 6241475.89 -152035.46   102%     -    0s
H    0     0                    -115458.8650 -152035.46  31.7%     -    0s
H    0     0                    -115788.2094 -152035.46  31.3%     -    0s
H    0     0                    -127117.7468 -132181.04  3.98%     -    0s
     0     0 -132181.04    0   70 -127117.75 -132181.04  3.98%     -    0s
H    0     0                    -130565.7497 -132085.34  1.16%     -    0s
H    0     0                    -130866.3583 -132085.34  0.93%     -    0s
     0     0 -131442.30    0   64 -130866.36 -131442.30  0.44%     -    0s
     0     0 -131400.53    0   62 -130866.36 -131400.53  0.41%     -    0s
     0     0 -131375.28    0   48 -130866.36 -131375.28  0.39%     -    0s
     0     0 -131362.93    0   54 -130866.36 -131362.93  0.38%     -    0s
     0     0 -131162.48    0   34 -130866.36 -131162.48  0.23%     -    0s
     0     0 -131145.51    0   31 -130866.36 -131145.51  0.21%     -    0s
     0     0 -131007.14    0   31 -130866.36 -131007.14  0.11%     -    0s
     0     0 -130984.92    0   19 -130866.36 -130984.92  0.09%     -    0s
     0     0 -130968.24    0   18 -130866.36 -130968.24  0.08%     -    0s
     0     0 -130956.13    0   14 -130866.36 -130956.13  0.07%     -    0s
     0     0 -130948.72    0   15 -130866.36 -130948.72  0.06%     -    0s
     0     0 -130943.90    0   14 -130866.36 -130943.90  0.06%     -    0s
     0     0 -130939.64    0   13 -130866.36 -130939.64  0.06%     -    0s
     0     0 -130903.51    0    6 -130866.36 -130903.51  0.03%     -    0s
     0     0 -130903.51    0    6 -130866.36 -130903.51  0.03%     -    0s
H    0     0                    -130878.5581 -130903.51  0.02%     -    0s
     0     0 -130884.10    0    2 -130878.56 -130884.10  0.00%     -    0s
H    0     0                    -130879.1347 -130881.09  0.00%     -    0s
H    0     0                    -130881.0858 -130881.09  0.00%     -    0s
     0     0 -130881.09    0    2 -130881.09 -130881.09  0.00%     -    0s

Cutting planes:
  Gomory: 2
  MIR: 4
  Flow cover: 1
  Relax-and-lift: 1

Explored 1 nodes (619 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -130881 -130879 -130879 ... 6.24181e+06
No other solutions better than -130881

Optimal solution found (tolerance 1.00e-06)
Best objective -1.308810857558e+05, best bound -1.308810857558e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 171917.17
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -130881.09
  [DEBUG]   S×d_nominal = 302798.26
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 302798.26 + -130881.09 = 171917.17
  [DEBUG]   Current θ from Master = 179089.56
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7172.39 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 22642.05
  Lower Bound (LB) = 23913.83
  Gap (UB-LB) = 5900.6222, Absolute Gap = 5900.6222, Relative Gap = 0.197912
  Not converged yet (gap = 5900.62 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308052 nonzeros
Model fingerprint: 0x2c79d01b
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 52318 rows and 21238 columns
Presolve time: 0.97s
Presolved: 56095 rows, 24702 columns, 348309 nonzeros
Variable types: 22443 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 56095 rows, 24702 columns, 348309 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32584    6.4948238e+03   0.000000e+00   2.406140e+08      5s
   49239    4.2268380e+04   0.000000e+00   1.670993e+07     10s
   62141    5.3946456e+04   0.000000e+00   4.289713e+06     15s
   73327    5.6875242e+04   0.000000e+00   7.574951e+04     20s
Concurrent spin time: 1.66s

Solved with dual simplex

Root relaxation: objective 5.717580e+04, 60129 iterations, 21.49 seconds (44.03 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57175.7994    0   69 -171254.74 57175.7994   133%     -   22s
H    0     0                    -168764.3946 57175.7994   134%     -   22s
H    0     0                    -99262.98233 57175.7994   158%     -   23s
H    0     0                    -94803.90857 57175.7994   160%     -   23s
H    0     0                    -92035.21697 57175.7994   162%     -   23s
H    0     0                    -86501.97529 57175.7994   166%     -   23s
H    0     0                    -83798.48976 57175.7994   168%     -   23s
H    0     0                    -83759.74285 57175.7994   168%     -   23s
H    0     0                    -56268.50261 57175.7994   202%     -   23s
H    0     0                    -12716.02618 57175.7994   550%     -   23s
H    0     0                    -7829.045984 57175.7994   830%     -   23s
H    0     0                    11784.549153 57175.7994   385%     -   23s
H    0     0                    16681.525549 57175.7994   243%     -   23s
H    0     0                    17306.252971 57175.7994   230%     -   23s
H    0     0                    17706.183640 53159.5624   200%     -   30s
     0     0 53159.5624    0  167 17706.1836 53159.5624   200%     -   30s
H    0     0                    18039.796677 53159.5077   195%     -   31s
H    0     0                    18111.093437 53159.5077   194%     -   31s
H    0     0                    18229.866361 53159.5077   192%     -   31s
     0     0 52631.2270    0  164 18229.8664 52631.2270   189%     -   34s
     0     0 52631.2270    0  173 18229.8664 52631.2270   189%     -   34s
     0     0 52631.2270    0  172 18229.8664 52631.2270   189%     -   35s
     0     0 52631.2270    0  172 18229.8664 52631.2270   189%     -   35s
     0     0 50150.0992    0  179 18229.8664 50150.0992   175%     -   42s
H    0     0                    19036.783972 50149.5509   163%     -   42s
H    0     0                    19452.457365 50149.5509   158%     -   42s
     0     0 48873.6321    0  222 19452.4574 48873.6321   151%     -   47s
H    0     0                    19497.116604 48737.7748   150%     -   49s
H    0     0                    19788.283490 48737.7748   146%     -   49s
H    0     0                    19791.369542 48737.7748   146%     -   49s
H    0     0                    20150.639378 48737.7748   142%     -   49s
H    0     0                    22619.757495 48737.7748   115%     -   49s
     0     0 48737.7748    0  195 22619.7575 48737.7748   115%     -   49s
     0     0 48662.5189    0  202 22619.7575 48662.5189   115%     -   52s
     0     0 48645.6935    0  196 22619.7575 48645.6935   115%     -   52s
     0     0 48638.5443    0  195 22619.7575 48638.5443   115%     -   53s
     0     0 48635.1441    0  204 22619.7575 48635.1441   115%     -   53s
     0     0 48635.1401    0  204 22619.7575 48635.1401   115%     -   53s
     0     0 46859.6810    0  301 22619.7575 46859.6810   107%     -   65s
H    0     0                    23054.466460 46859.4481   103%     -   66s
H    0     0                    23436.301709 46859.4481   100%     -   66s
H    0     0                    24078.647534 46859.4481  94.6%     -   66s
H    0     0                    24153.686914 46859.4481  94.0%     -   66s
H    0     0                    24275.704983 46859.4481  93.0%     -   66s
     0     0 46244.4566    0  308 24275.7050 46244.4566  90.5%     -   70s
     0     0 46043.9010    0  324 24275.7050 46043.9010  89.7%     -   73s
     0     0 45979.8004    0  325 24275.7050 45979.8004  89.4%     -   76s
     0     0 45929.0686    0  335 24275.7050 45929.0686  89.2%     -   77s
     0     0 45850.6666    0  337 24275.7050 45850.6666  88.9%     -   78s
     0     0 45827.0426    0  334 24275.7050 45827.0426  88.8%     -   80s
     0     0 45811.5876    0  334 24275.7050 45811.5876  88.7%     -   80s
     0     0 45806.7584    0  333 24275.7050 45806.7584  88.7%     -   82s
     0     0 45806.2339    0  337 24275.7050 45806.2339  88.7%     -   82s
     0     0 45019.1530    0  378 24275.7050 45019.1530  85.4%     -   91s
H    0     0                    24716.930876 45018.3242  82.1%     -   91s
H    0     0                    24865.374214 45018.3242  81.0%     -   92s
     0     0 44719.1851    0  364 24865.3742 44719.1851  79.8%     -   94s
     0     0 44618.9974    0  379 24865.3742 44618.9974  79.4%     -   96s
     0     0 44601.4155    0  381 24865.3742 44601.4155  79.4%     -   97s
     0     0 44588.1912    0  383 24865.3742 44588.1912  79.3%     -   98s
     0     0 44581.5378    0  380 24865.3742 44581.5378  79.3%     -   98s
     0     0 44576.3060    0  384 24865.3742 44576.3060  79.3%     -   99s
     0     0 44571.8015    0  387 24865.3742 44571.8015  79.3%     -   99s
     0     0 44566.6738    0  383 24865.3742 44566.6738  79.2%     -   99s
     0     0 44562.7080    0  382 24865.3742 44562.7080  79.2%     -  100s
     0     0 44561.7363    0  382 24865.3742 44561.7363  79.2%     -  100s
     0     0 44457.9103    0  373 24865.3742 44457.9103  78.8%     -  102s
     0     0 44407.0368    0  385 24865.3742 44407.0368  78.6%     -  104s
     0     0 44375.7950    0  381 24865.3742 44375.7950  78.5%     -  106s
     0     0 44367.4241    0  385 24865.3742 44367.4241  78.4%     -  107s
     0     0 44361.1188    0  387 24865.3742 44361.1188  78.4%     -  107s
     0     0 44357.5669    0  383 24865.3742 44357.5669  78.4%     -  107s
     0     0 44355.2471    0  380 24865.3742 44355.2471  78.4%     -  108s
     0     0 44354.3104    0  383 24865.3742 44354.3104  78.4%     -  108s
     0     0 44336.8535    0  382 24865.3742 44336.8535  78.3%     -  109s
     0     0 44334.1523    0  385 24865.3742 44334.1523  78.3%     -  110s
     0     0 44332.2419    0  381 24865.3742 44332.2419  78.3%     -  111s
     0     0 44330.9916    0  384 24865.3742 44330.9916  78.3%     -  111s
     0     0 44256.9297    0  381 24865.3742 44256.9297  78.0%     -  114s
H    0     0                    26070.436899 44256.3859  69.8%     -  114s
H    0     0                    26322.361930 44256.3859  68.1%     -  114s
H    0     0                    26339.915252 44256.3859  68.0%     -  114s
     0     0 44241.4657    0  380 26339.9153 44241.4657  68.0%     -  115s
     0     0 44234.5045    0  393 26339.9153 44234.5045  67.9%     -  115s
     0     0 44234.1490    0  385 26339.9153 44234.1490  67.9%     -  115s
     0     0 44215.4721    0  388 26339.9153 44215.4721  67.9%     -  116s
     0     0 44207.8373    0  385 26339.9153 44207.8373  67.8%     -  117s
     0     0 44200.6567    0  392 26339.9153 44200.6567  67.8%     -  118s
     0     0 44199.4071    0  390 26339.9153 44199.4071  67.8%     -  118s
     0     0 44193.1424    0  391 26339.9153 44193.1424  67.8%     -  119s
     0     0 44187.1171    0  394 26339.9153 44187.1171  67.8%     -  120s
     0     0 44183.7035    0  390 26339.9153 44183.7035  67.7%     -  120s
     0     0 44183.2413    0  392 26339.9153 44183.2413  67.7%     -  120s
     0     0 44167.7038    0  383 26339.9153 44167.7038  67.7%     -  122s
H    0     0                    26364.914688 44167.3504  67.5%     -  122s
     0     0 44161.6154    0  428 26364.9147 44161.6154  67.5%     -  122s
     0     0 44159.6819    0  428 26364.9147 44159.6819  67.5%     -  123s
     0     0 44158.3476    0  433 26364.9147 44158.3476  67.5%     -  123s
     0     0 44152.7144    0  437 26364.9147 44152.7144  67.5%     -  124s
     0     0 44150.3171    0  432 26364.9147 44150.3171  67.5%     -  125s
     0     0 44150.0128    0  431 26364.9147 44150.0128  67.5%     -  125s
     0     0 44149.0128    0  426 26364.9147 44149.0128  67.5%     -  125s
H    0     0                    26432.308355 44148.9250  67.0%     -  126s
     0     0 44147.7991    0  427 26432.3084 44147.7991  67.0%     -  126s
     0     0 44147.3066    0  456 26432.3084 44147.3066  67.0%     -  127s
     0     0 44146.1552    0  456 26432.3084 44146.1552  67.0%     -  127s
H    0     0                    26465.594033 44146.1552  66.8%     -  136s
H    0     0                    26511.238755 44146.1552  66.5%     -  136s
H    0     0                    26526.502187 44146.1552  66.4%     -  136s
     0     2 44146.1552    0  456 26526.5022 44146.1552  66.4%     -  147s
     1     4 43964.6881    1  414 26526.5022 44144.2536  66.4%  4204  152s
     3     8 43703.6718    2  398 26526.5022 43964.5225  65.7%  6650  156s
     7    16 43440.4598    3  371 26526.5022 43703.1178  64.8%  5923  163s
    15    32 43330.9898    4  414 26526.5022 43433.6841  63.7%  6669  170s
    31    52 40449.7799    5  327 26526.5022 43330.4258  63.3%  9152  185s
    51    84 42187.0230    6  364 26526.5022 43330.4258  63.3%  8399  199s
    83   224 41956.6342    7  361 26526.5022 43330.4258  63.3%  6793  211s
H  223   307                    26544.668906 43330.4258  63.2%  3990  218s
H  249   307                    26815.078922 43330.4258  61.6%  3835  218s
   306   388 40404.7115   10  307 26815.0789 43330.4258  61.6%  3547  223s
   387   454 41201.2625   12  325 26815.0789 43330.4258  61.6%  3257  228s
H  391   454                    26880.947932 43330.4258  61.2%  3234  228s
H  398   454                    26952.297910 43330.4258  60.8%  3212  228s
   453   532 40835.7466   12  339 26952.2979 43330.4258  60.8%  3129  234s
H  531   601                    27111.163560 43330.4258  59.8%  3018  238s
   600   676 41161.1468   13  319 27111.1636 43330.4258  59.8%  2956  243s
   677   743 40700.5343   13  326 27111.1636 43330.4258  59.8%  2926  248s
   752   822 40366.5547   14  314 27111.1636 43330.4258  59.8%  2863  254s
   831   897 40770.4778   14  317 27111.1636 43330.4258  59.8%  2813  260s
H  834   897                    27179.500498 43330.4258  59.4%  2809  260s
   915   964 40811.2084   13  338 27179.5005 43330.4258  59.4%  2758  267s
  1001  1000 40388.2868   15  317 27179.5005 43330.4258  59.4%  2718  274s
H 1003  1000                    27223.346377 43330.4258  59.2%  2721  274s
  1060  1035 40144.1959   16  270 27223.3464 43330.4258  59.2%  2698  282s
  1146  1063 40255.9451   16  276 27223.3464 43157.7113  58.5%  2726  288s
  1182  1112 35835.3646   16  259 27223.3464 43157.7113  58.5%  2853  293s
  1231  1139 39692.3796   17  270 27223.3464 43157.7113  58.5%  2941  298s
  1277  1183 36383.6929   17  255 27223.3464 43157.7113  58.5%  3015  304s
  1335  1207 39398.8665   18  274 27223.3464 43157.7113  58.5%  3117  312s
  1377  1269 35903.7962   18  253 27223.3464 43157.7113  58.5%  3198  317s
  1477  1312 38494.0838   19  307 27223.3464 43157.7113  58.5%  3181  327s
  1563  1369 33449.5822   19  187 27223.3464 42776.3399  57.1%  3222  335s
  1646  1425 37880.5162   20  323 27223.3464 42776.3399  57.1%  3279  344s
  1726  1488 37384.4503   21  298 27223.3464 42776.3399  57.1%  3351  352s
  1814  1553 36172.4249   22  274 27223.3464 42776.3399  57.1%  3387  362s
  1891  1594 34962.6654   23  253 27223.3464 42387.9076  55.7%  3434  367s
  1936  1652 34275.2102   23  249 27223.3464 42387.9076  55.7%  3449  375s
  2000  1722 33998.5511   22  235 27223.3464 42387.9076  55.7%  3458  384s
  2096  1793 34767.8948   22  275 27223.3464 42369.2792  55.6%  3405  392s
  2187  1891 34631.9202   24  267 27223.3464 42369.2792  55.6%  3382  403s
  2313  1952 34279.1959   25  258 27223.3464 42369.2792  55.6%  3327  411s
  2396  2018 34252.5002   26  232 27223.3464 42369.2792  55.6%  3291  421s
  2528  2088 33165.9662   30  225 27223.3464 42242.7343  55.2%  3256  430s
  2612  2174 31210.0204   29  142 27223.3464 42239.2051  55.2%  3255  440s
  2728  2265 32849.6695   29  221 27223.3464 42234.2060  55.1%  3239  452s
  2883  2366 32034.2038   33  183 27223.3464 42166.8200  54.9%  3207  463s
  3040  2398 28528.7902   34  138 27223.3464 42093.7052  54.6%  3221  470s
  3072  2426 28813.0050   34  218 27223.3464 42093.7052  54.6%  3251  477s
  3112  2495 30931.8585   35  160 27223.3464 42093.7052  54.6%  3274  487s
  3253  2565 30759.2518   37  152 27223.3464 42093.7052  54.6%  3271  499s
  3367  2676 29510.1072   42  146 27223.3464 41879.0306  53.8%  3332  510s
  3523  2777 28929.6607   52  114 27223.3464 41817.3884  53.6%  3358  521s
  3705  2877 30502.4924   30  209 27223.3464 41817.3884  53.6%  3370  534s
  3899  3018 28322.3525   44  173 27223.3464 41817.3884  53.6%  3395  548s
  4113  3019 35985.2217   28  456 27223.3464 41817.3884  53.6%  3418  577s
  4115  3020 38175.7908   25   69 27223.3464 41817.3884  53.6%  3416  601s
  4116  3021 29305.6344   32  243 27223.3464 41817.3884  53.6%  3415  613s
  4117  3022 33762.4530   30  313 27223.3464 41817.3884  53.6%  3414  622s
  4118  3022 39030.5974    7  366 27223.3464 41817.3884  53.6%  3413  628s
  4119  3023 37677.1678   16  352 27223.3464 41817.3884  53.6%  3413  632s
  4120  3024 34154.0347   20  424 27223.3464 41817.3884  53.6%  3412  636s
  4121  3024 37938.2204   15  429 27223.3464 41817.3884  53.6%  3411  640s
  4124  3026 31114.6348   43  419 27223.3464 41817.3884  53.6%  3409  647s
  4127  3028 38224.2688   27  431 27223.3464 41817.3884  53.6%  3406  650s
  4129  3030 28793.8411   39  432 27223.3464 41817.3884  53.6%  3404  655s
  4132  3032 33457.9524   27  433 27223.3464 41817.3884  53.6%  3402  660s
  4134  3033 32260.4991   20  469 27223.3464 41817.3884  53.6%  3400  665s
  4136  3034 31328.0325   32  434 27223.3464 41817.3884  53.6%  3399  670s
  4139  3036 33767.1117   17  430 27223.3464 41817.3884  53.6%  3396  676s
  4142  3038 40424.9425   13  446 27223.3464 41817.3884  53.6%  3394  681s
  4145  3040 29024.5044   37  463 27223.3464 41817.3884  53.6%  3391  687s
  4147  3042 38606.5974   13  462 27223.3464 41817.3884  53.6%  3390  690s
  4149  3043 29165.3410   53  448 27223.3464 41817.3884  53.6%  3388  718s
  4150  3044 34528.4908   21  448 27223.3464 41817.3884  53.6%  3387  746s
  4151  3047 41817.3884   14  434 27223.3464 41817.3884  53.6%  3426  754s
  4153  3051 41817.3884   15  397 27223.3464 41817.3884  53.6%  3426  771s
  4157  3057 41817.3884   16  392 27223.3464 41817.3884  53.6%  3430  782s
  4165  3071 41817.3884   17  475 27223.3464 41817.3884  53.6%  3440  796s
  4181  3082 34871.1690   18  289 27223.3464 41817.3884  53.6%  3478  819s
  4198  3109 39447.5041   19  361 27223.3464 41817.3884  53.6%  3504  833s
  4230  3223 39083.7360   20  357 27223.3464 41817.3884  53.6%  3527  846s
  4359  3240 38685.5932   23  345 27223.3464 41817.3884  53.6%  3533  855s
  4423  3265 38404.1619   21  340 27223.3464 41817.3884  53.6%  3531  863s
  4493  3269 37838.6892   23  316 27223.3464 41817.3884  53.6%  3522  869s
  4528  3280 38489.7809   24  325 27223.3464 41817.3884  53.6%  3520  874s
  4566  3292 35343.3118   23  210 27223.3464 41817.3884  53.6%  3514  883s
  4608  3301 36909.0451   24  295 27223.3464 41817.3884  53.6%  3508  890s
  4645  3311 37481.3744   24  322 27223.3464 41817.3884  53.6%  3501  899s
  4694  3318 37176.0347   24  283 27223.3464 41817.3884  53.6%  3490  905s
  4737  3332 36593.1698   25  274 27223.3464 41817.3884  53.6%  3483  913s
  4788  3341 36204.6940   26  283 27223.3464 41817.3884  53.6%  3476  923s
  4848  3336 36093.3307   24  303 27223.3464 41817.3884  53.6%  3463  937s
  4909  3328 33323.7100   27  265 27223.3464 41817.3884  53.6%  3451  948s
  4980  3322 32553.5544   28  271 27223.3464 41817.3884  53.6%  3439  955s
  5039  3334 31938.4234   27  280 27223.3464 41817.3884  53.6%  3439  964s
  5092  3350 34228.8204   26  283 27223.3464 41817.3884  53.6%  3436  973s
  5159  3352 33747.2182   27  272 27223.3464 41817.3884  53.6%  3429  982s
  5195  3373 32968.3112   28  260 27223.3464 41556.1839  52.6%  3432  994s
  5239  3392 32706.3272   29  225 27223.3464 41556.1839  52.6%  3437 1005s
  5284  3408 30455.8428   30  155 27223.3464 41523.3304  52.5%  3441 1013s
  5340  3424 28379.8315   33  172 27223.3464 41523.3304  52.5%  3439 1025s
  5407  3435     cutoff   34      27223.3464 41523.3304  52.5%  3433 1034s
  5471  3456     cutoff   28      27223.3464 40973.6590  50.5%  3433 1044s
  5539  3468 36397.4004   25  334 27223.3464 40973.6590  50.5%  3426 1058s
  5626  3485 33653.3611   28  277 27223.3464 40973.6590  50.5%  3418 1069s
  5693  3501 33575.1119   29  286 27223.3464 40721.5808  49.6%  3424 1081s
  5780  3513 29926.1960   31  216 27223.3464 40721.5808  49.6%  3417 1091s
  5878  3531 28182.9630   32  169 27223.3464 40721.5808  49.6%  3407 1103s
  6006  3539 28609.2455   33  159 27223.3464 40721.5808  49.6%  3391 1117s
  6155  3520 infeasible   37      27223.3464 40426.1006  48.5%  3366 1131s
  6282  3512 35343.5385   23  390 27223.3464 39819.3438  46.3%  3368 1145s
  6423  3482 32322.0678   26  360 27223.3464 39819.3438  46.3%  3361 1161s
  6505  3489 31453.5295   27  357 27223.3464 39819.3438  46.3%  3362 1175s
  6616  3486 28179.3219   30  246 27223.3464 39819.3438  46.3%  3362 1190s
  6755  3516 29955.4611   30  261 27223.3464 39571.2663  45.4%  3360 1205s
  6919  3529 28024.5399   33  244 27223.3464 39295.7100  44.3%  3346 1221s
  7086  3546 34030.0042   22  384 27223.3464 39295.7100  44.3%  3337 1237s
  7254  3541 28210.6748   25  319 27223.3464 39295.7100  44.3%  3329 1255s
  7433  3564 32177.2834   29  222 27223.3464 39295.7100  44.3%  3316 1273s
  7624  3571 29034.2849   35   99 27223.3464 39295.7100  44.3%  3307 1290s
H 7672  3402                    27738.249366 39295.7100  41.7%  3299 1290s
  7779  3439 29433.0073   26  274 27738.2494 39295.7100  41.7%  3287 1307s
  8003  3419     cutoff   29      27738.2494 38606.0301  39.2%  3270 1328s
  8221  3421 34780.3924   21  382 27738.2494 38606.0301  39.2%  3258 1349s
  8456  3432 32791.7158   24  232 27738.2494 38606.0301  39.2%  3247 1371s
  8707  3447 30030.1084   27  143 27738.2494 38451.2769  38.6%  3232 1392s
  9015  3374 30776.7907   29  368 27738.2494 37908.0324  36.7%  3207 1413s
H 9016  3219                    27922.533106 37908.0324  35.8%  3207 1413s
H 9129  2918                    28894.782239 37896.1652  31.2%  3201 1413s
  9183  2951 29503.3722   30  367 28894.7822 37896.1652  31.2%  3200 1435s
  9457  2920 34624.4561   26  323 28894.7822 37814.0145  30.9%  3188 1457s
  9802  2855 31731.5536   32  228 28894.7822 37543.9139  29.9%  3160 1480s
 10182  2827 34170.1977   26  278 28894.7822 37543.9139  29.9%  3126 1503s
 10564  2790 29241.1121   35  206 28894.7822 37467.6876  29.7%  3097 1526s
 10944  2738 30396.6990   28  274 28894.7822 36877.1299  27.6%  3074 1553s
 11321  2659 30934.8413   22  331 28894.7822 36746.7579  27.2%  3059 1582s
 11745  2579     cutoff   24      28894.7822 36649.3827  26.8%  3038 1608s
 12128  2568 29358.1992   30  328 28894.7822 36424.3118  26.1%  3030 1636s
 12579  2635     cutoff   36      28894.7822 36276.2072  25.5%  3011 1665s
 12976  2740 32645.9285   27  238 28894.7822 36199.0928  25.3%  3011 1693s
 13451  2827     cutoff   25      28894.7822 36043.6677  24.7%  2995 1725s
 13947  2860 30764.8179   28  275 28894.7822 35796.8777  23.9%  2981 1757s
H14371  2867                    28932.699030 35638.0717  23.2%  2974 1788s
 14785  2947 29652.4304   37   90 28932.6990 35535.5133  22.8%  2961 1822s
 15293  3036 29194.7482   30  179 28932.6990 35440.6561  22.5%  2952 1859s
 15939  3063     cutoff   30      28932.6990 35180.6302  21.6%  2925 1897s
 16489  3120 31901.9565   27  309 28932.6990 35082.9847  21.3%  2918 1937s
 17084  3169 30680.7409   22  328 28932.6990 34926.1376  20.7%  2908 1980s
 17757  3180 infeasible   32      28932.6990 34675.0778  19.8%  2892 2012s
H17758  3174                    28983.960770 34675.0778  19.6%  2891 2012s
H17762  3174                    28985.088596 34675.0778  19.6%  2891 2012s
 17810  3163 31957.1841   32  236 28985.0886 34658.6761  19.6%  2891 2055s
 18521  3224 30765.6543   28  264 28985.0886 34632.0388  19.5%  2875 2100s
 19201  3225     cutoff   32      28985.0886 34366.4251  18.6%  2866 2149s
 20071  3293 32581.4858   23  389 28985.0886 34212.9202  18.0%  2837 2194s
H20689  3292                    28999.345551 34096.9840  17.6%  2824 2194s
 20774  3298 31424.8736   29  214 28999.3456 34096.9840  17.6%  2823 2240s
 21587  3308 30836.4814   33  277 28999.3456 33837.1725  16.7%  2810 2289s
 22509  3271     cutoff   29      28999.3456 33611.3280  15.9%  2787 2344s
 23404  3199 29867.5863   24  194 28999.3456 33359.6450  15.0%  2771 2396s
 24362  3107 31649.7818   28  298 28999.3456 33095.9745  14.1%  2754 2455s
 25405  2920     cutoff   32      28999.3456 32866.6982  13.3%  2732 2512s
 26514  2675     cutoff   28      28999.3456 32501.2437  12.1%  2709 2569s
H26708  2675                    29000.959415 32483.9729  12.0%  2707 2569s
 27531  2403     cutoff   32      29000.9594 32246.4129  11.2%  2691 2631s
H28762  2271                    29343.452727 32162.6624  9.61%  2656 2631s
 28918  1387     cutoff   34      29343.4527 31900.1665  8.71%  2650 2695s
 31045  2543     cutoff   32      29343.4527 31170.0919  6.23%  2550 2721s
*31611  2543              88    29351.889692 31133.6122  6.07%  2508 2721s
*31808  2543              94    29363.171872 31133.6122  6.03%  2494 2721s
*32149  2543             119    29486.878614 31105.0065  5.49%  2469 2721s
 36453  3734     cutoff   80      29486.8786 30232.5688  2.53%  2199 2734s
 42917  4001 29521.4874   97   20 29486.8786 29870.8629  1.30%  1879 2736s
*44803  4687             112    29488.929967 29828.3017  1.15%  1803 2739s
*44912  4638             117    29492.147760 29828.3017  1.14%  1798 2739s
 46861  4653 29506.4280   87   18 29492.1478 29797.2097  1.03%  1726 2741s
H46864  2789                    29560.584654 29797.2097  0.80%  1726 2741s
H46879  2553                    29569.326987 29764.3237  0.66%  1726 2741s
H46914  2543                    29569.825746 29764.3237  0.66%  1724 2741s
H46921  2272                    29581.412390 29764.3237  0.62%  1724 2741s
 48841  2245 29587.8359   82   16 29581.4124 29727.0542  0.49%  1659 2746s
H48846  2211                    29582.842326 29727.0542  0.49%  1659 2746s
 48944  2206 29585.0182   86   20 29582.8423 29718.8062  0.46%  1656 2751s
 49045  2202 29596.1037   72   32 29582.8423 29715.7545  0.45%  1653 2756s
 49171  2179     cutoff   66      29582.8423 29715.0501  0.45%  1649 2761s
 50665  1836 29583.5041   77   16 29582.8423 29710.8409  0.43%  1602 2767s
 52245   715     cutoff   74      29582.8423 29698.6636  0.39%  1555 2770s

Cutting planes:
  MIR: 835
  Mixing: 2
  Flow cover: 1884
  RLT: 11
  Relax-and-lift: 142

Explored 56408 nodes (81642894 simplex iterations) in 2773.22 seconds (8529.77 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 29582.8 29582.8 29581.4 ... 29363.2

Optimal solution found (tolerance 1.00e-06)
Best objective 2.958284232574e+04, best bound 2.958284232574e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2773.30s
  Master Objective (UB) = 29582.84, θ = 179198.14
  Upper Bound (UB) = 29582.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 179198.14
  [DEBUG]   ✓ Scenario 0: θ = 179198.14 ≤ Q = 179198.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 179198.14 ≤ Q = 179198.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 179198.14 ≤ Q = 179198.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 179198.14 ≤ Q = 179198.14 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 179198.14 ≤ Q = 179475.89 (slack: 277.75)
  [DEBUG]   ✓ Scenario 5: θ = 179198.14 ≤ Q = 179198.14 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 179198.14 ≤ Q = 179198.14 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x46d2d6d8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb92d2928
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.347523e+13
Presolve removed 2631 rows and 1922 columns
Presolve time: 0.00s
Presolved: 462 rows, 467 columns, 1303 nonzeros
Found heuristic solution: objective 6248604.8363
Variable types: 316 continuous, 151 integer (151 binary)
Found heuristic solution: objective 6248275.4920

Root relaxation: objective -1.520357e+05, 231 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -152035.70    0  123 6248275.49 -152035.70   102%     -    0s
H    0     0                    -113963.7757 -152035.70  33.4%     -    0s
H    0     0                    -114293.1201 -152035.70  33.0%     -    0s
H    0     0                    -114802.2160 -152035.70  32.4%     -    0s
H    0     0                    -115131.5604 -152035.70  32.1%     -    0s
H    0     0                    -121584.4461 -129988.86  6.91%     -    0s
     0     0 -129988.86    0   87 -121584.45 -129988.86  6.91%     -    0s
H    0     0                    -127347.6173 -129879.87  1.99%     -    0s
H    0     0                    -127974.4277 -129879.87  1.49%     -    0s
H    0     0                    -128094.1532 -129879.87  1.39%     -    0s
     0     0 -129109.80    0   91 -128094.15 -129109.80  0.79%     -    0s
H    0     0                    -128094.6306 -129092.86  0.78%     -    0s
     0     0 -129028.19    0   78 -128094.63 -129028.19  0.73%     -    0s
     0     0 -129024.62    0   82 -128094.63 -129024.62  0.73%     -    0s
     0     0 -128923.97    0   66 -128094.63 -128923.97  0.65%     -    0s
     0     0 -128889.30    0   71 -128094.63 -128889.30  0.62%     -    0s
     0     0 -128888.67    0   71 -128094.63 -128888.67  0.62%     -    0s
     0     0 -128838.55    0   84 -128094.63 -128838.55  0.58%     -    0s
     0     0 -128829.33    0   84 -128094.63 -128829.33  0.57%     -    0s
H    0     0                    -128094.6556 -128825.39  0.57%     -    0s
H    0     0                    -128118.8572 -128825.39  0.55%     -    0s
     0     2 -128825.39    0   84 -128118.86 -128825.39  0.55%     -    0s
H   33    10                    -128207.2723 -128655.49  0.35%   9.8    0s
H  620     2                    -128207.7496 -128229.75  0.02%   6.1    0s

Cutting planes:
  Gomory: 31
  Implied bound: 4
  MIR: 149
  Flow cover: 19
  RLT: 17

Explored 627 nodes (4374 simplex iterations) in 0.13 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128208 -128207 -128119 ... -114802
No other solutions better than -128208

Optimal solution found (tolerance 1.00e-06)
Best objective -1.282077496147e+05, best bound -1.282077496147e+05, gap 0.0000%
  Subproblem solved in 0.15s
  Worst-case operational profit (Z_SP) = 174702.16
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128207.75
  [DEBUG]   S×d_nominal = 302909.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 302909.91 + -128207.75 = 174702.16
  [DEBUG]   Current θ from Master = 179198.14
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4495.98 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 25086.86
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 4495.9810, Absolute Gap = 4495.9810, Relative Gap = 0.151979
  Not converged yet (gap = 4495.98 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351271 nonzeros
Model fingerprint: 0x4662b1ee
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 59792 rows and 24272 columns
Presolve time: 1.08s
Presolved: 63911 rows, 27908 columns, 397279 nonzeros
Variable types: 25649 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 63911 rows, 27908 columns, 397279 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33865   -2.9354711e+04   0.000000e+00   2.335689e+06      5s
   49072    2.8195592e+04   0.000000e+00   1.007189e+07     10s
   62108    3.5651355e+04   0.000000e+00   2.049569e+06     15s
   73321    4.0672842e+04   0.000000e+00   4.954206e+07     20s
Concurrent spin time: 2.01s

Solved with dual simplex

Root relaxation: objective 5.717580e+04, 48578 iterations, 22.03 seconds (43.73 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57175.7994    0   69 -171254.74 57175.7994   133%     -   23s
H    0     0                    -168628.1743 57175.7994   134%     -   23s
H    0     0                    -97085.45365 57175.7994   159%     -   23s
H    0     0                    -97009.84605 57175.7994   159%     -   23s
H    0     0                    -56268.50261 57175.7994   202%     -   23s
H    0     0                    8672.0713863 57175.7994   559%     -   23s
H    0     0                    8969.0819010 57175.7994   537%     -   23s
H    0     0                    11784.549153 57175.7994   385%     -   24s
H    0     0                    16055.481221 57175.7994   256%     -   24s
H    0     0                    16681.525549 57175.7994   243%     -   24s
     0     0 53597.1503    0  160 16681.5255 53597.1503   221%     -   30s
H    0     0                    16761.933516 53595.7278   220%     -   31s
     0     0 53339.8891    0  168 16761.9335 53339.8891   218%     -   33s
     0     0 53339.8891    0  186 16761.9335 53339.8891   218%     -   35s
     0     0 53339.8891    0  188 16761.9335 53339.8891   218%     -   35s
     0     0 53339.8891    0  188 16761.9335 53339.8891   218%     -   35s
     0     0 49966.0203    0  205 16761.9335 49966.0203   198%     -   43s
H    0     0                    19530.163113 49965.6696   156%     -   43s
     0     0 49519.0612    0  237 19530.1631 49519.0612   154%     -   46s
     0     0 49374.2242    0  245 19530.1631 49374.2242   153%     -   49s
     0     0 49155.0825    0  275 19530.1631 49155.0825   152%     -   53s
     0     0 49084.6644    0  266 19530.1631 49084.6644   151%     -   55s
     0     0 49066.3099    0  274 19530.1631 49066.3099   151%     -   55s
     0     0 49064.6467    0  272 19530.1631 49064.6467   151%     -   55s
     0     0 49062.1620    0  277 19530.1631 49062.1620   151%     -   56s
     0     0 49059.1190    0  281 19530.1631 49059.1190   151%     -   57s
     0     0 49059.0194    0  281 19530.1631 49059.0194   151%     -   57s
H    0     0                    19660.108974 47081.7110   139%     -   71s
H    0     0                    20043.534336 47081.7110   135%     -   71s
H    0     0                    20740.196537 47081.7110   127%     -   71s
     0     0 47081.7110    0  308 20740.1965 47081.7110   127%     -   71s
H    0     0                    23714.977973 47081.7090  98.5%     -   72s
     0     0 46481.2447    0  261 23714.9780 46481.2447  96.0%     -   78s
     0     0 46139.1949    0  321 23714.9780 46139.1949  94.6%     -   84s
     0     0 46096.8306    0  322 23714.9780 46096.8306  94.4%     -   85s
     0     0 46045.5176    0  315 23714.9780 46045.5176  94.2%     -   87s
     0     0 46014.8734    0  315 23714.9780 46014.8734  94.0%     -   89s
     0     0 45926.5272    0  280 23714.9780 45926.5272  93.7%     -   91s
     0     0 45908.3146    0  287 23714.9780 45908.3146  93.6%     -   93s
     0     0 45898.5303    0  286 23714.9780 45898.5303  93.5%     -   93s
     0     0 45894.4086    0  287 23714.9780 45894.4086  93.5%     -   94s
     0     0 45893.0490    0  324 23714.9780 45893.0490  93.5%     -   95s
     0     0 45892.4374    0  286 23714.9780 45892.4374  93.5%     -   95s
H    0     0                    23995.020223 45892.4374  91.3%     -   97s
     0     0 45133.0147    0  362 23995.0202 45133.0147  88.1%     -  101s
H    0     0                    24036.766430 45132.9973  87.8%     -  101s
H    0     0                    24169.348685 45132.9973  86.7%     -  101s
     0     0 44995.2526    0  375 24169.3487 44995.2526  86.2%     -  104s
     0     0 44966.3023    0  383 24169.3487 44966.3023  86.0%     -  106s
     0     0 44934.0919    0  375 24169.3487 44934.0919  85.9%     -  108s
     0     0 44924.6893    0  384 24169.3487 44924.6893  85.9%     -  109s
     0     0 44907.5443    0  380 24169.3487 44907.5443  85.8%     -  110s
     0     0 44890.3445    0  385 24169.3487 44890.3445  85.7%     -  111s
     0     0 44884.4528    0  385 24169.3487 44884.4528  85.7%     -  112s
     0     0 44877.1273    0  382 24169.3487 44877.1273  85.7%     -  112s
     0     0 44867.5061    0  383 24169.3487 44867.5061  85.6%     -  113s
     0     0 44858.5953    0  387 24169.3487 44858.5953  85.6%     -  114s
     0     0 44850.4608    0  381 24169.3487 44850.4608  85.6%     -  115s
     0     0 44846.7690    0  380 24169.3487 44846.7690  85.6%     -  116s
     0     0 44844.8586    0  379 24169.3487 44844.8586  85.5%     -  117s
     0     0 44843.4492    0  379 24169.3487 44843.4492  85.5%     -  117s
     0     0 44843.1650    0  380 24169.3487 44843.1650  85.5%     -  117s
     0     0 44647.3966    0  385 24169.3487 44647.3966  84.7%     -  121s
H    0     0                    24192.883265 44647.3752  84.5%     -  122s
     0     0 44582.2002    0  386 24192.8833 44582.2002  84.3%     -  124s
     0     0 44573.4885    0  395 24192.8833 44573.4885  84.2%     -  125s
     0     0 44568.1815    0  402 24192.8833 44568.1815  84.2%     -  125s
     0     0 44566.8353    0  397 24192.8833 44566.8353  84.2%     -  125s
     0     0 44476.2719    0  385 24192.8833 44476.2719  83.8%     -  127s
H    0     0                    24547.218628 44473.2356  81.2%     -  129s
     0     0 44438.8812    0  384 24547.2186 44438.8812  81.0%     -  130s
     0     0 44418.8646    0  394 24547.2186 44418.8646  81.0%     -  131s
     0     0 44408.9110    0  381 24547.2186 44408.9110  80.9%     -  132s
     0     0 44407.7527    0  383 24547.2186 44407.7527  80.9%     -  133s
     0     0 44342.6027    0  376 24547.2186 44342.6027  80.6%     -  135s
H    0     0                    25749.036118 44342.3782  72.2%     -  135s
H    0     0                    25888.973650 44342.3782  71.3%     -  135s
     0     0 44327.5965    0  384 25888.9736 44327.5965  71.2%     -  137s
     0     0 44320.7108    0  381 25888.9736 44320.7108  71.2%     -  137s
     0     0 44319.7383    0  384 25888.9736 44319.7383  71.2%     -  138s
     0     0 44291.7663    0  378 25888.9736 44291.7663  71.1%     -  139s
H    0     0                    26141.747022 44289.1163  69.4%     -  140s
     0     0 44283.8711    0  383 26141.7470 44283.8711  69.4%     -  140s
     0     0 44282.9754    0  385 26141.7470 44282.9754  69.4%     -  141s
     0     0 44266.0452    0  389 26141.7470 44266.0452  69.3%     -  141s
H    0     0                    26780.392448 44262.9658  65.3%     -  142s
H    0     0                    27030.081360 44262.9658  63.8%     -  142s
     0     0 44257.8980    0  395 27030.0814 44257.8980  63.7%     -  143s
     0     0 44254.4065    0  392 27030.0814 44254.4065  63.7%     -  143s
     0     0 44254.3116    0  390 27030.0814 44254.3116  63.7%     -  143s
     0     0 44252.4030    0  396 27030.0814 44252.4030  63.7%     -  144s
     0     0 44250.7434    0  396 27030.0814 44250.7434  63.7%     -  145s
     0     0 44249.3951    0  389 27030.0814 44249.3951  63.7%     -  146s
     0     0 44248.8146    0  392 27030.0814 44248.8146  63.7%     -  147s
     0     0 44247.8415    0  392 27030.0814 44247.8415  63.7%     -  147s
     0     0 44246.9098    0  392 27030.0814 44246.9098  63.7%     -  148s
H    0     0                    27073.874945 44246.9098  63.4%     -  178s
     0     2 44246.9098    0  392 27073.8749 44246.9098  63.4%     -  183s
     1     4 44196.9273    1  386 27073.8749 44246.9098  63.4%  3771  185s
     7    16 43823.0252    3  370 27073.8749 44159.2022  63.1%  4818  194s
    15    32 43205.1427    4  383 27073.8749 43822.6577  61.9%  6112  199s
    31    48 42137.3967    5  368 27073.8749 43291.5716  59.9%  8864  217s
    47    80 41528.3873    6  367 27073.8749 43291.5716  59.9%  9345  228s
    79   112 41471.7244    7  369 27073.8749 43291.5716  59.9%  7898  234s
   111   144 41332.0720    8  348 27073.8749 43291.5716  59.9%  6707  240s
H  128   144                    27145.760346 43291.5716  59.5%  6188  240s
   143   194 41224.9128    9  350 27145.7603 43291.5716  59.5%  5912  249s
   193   269 40384.5679    8  316 27145.7603 43291.5716  59.5%  5290  259s
   268   374 41106.9016   10  351 27145.7603 43291.5716  59.5%  4592  267s
   373   475 41095.4865   11  351 27145.7603 43291.5716  59.5%  3936  280s
   474   552 40979.6001   11  340 27145.7603 43291.5716  59.5%  3525  288s
   551   644 40405.1956   11  272 27145.7603 43291.5716  59.5%  3408  295s
   647   742 40849.9905   11  336 27145.7603 43291.5716  59.5%  3170  300s
   748   823 40961.6573   12  340 27145.7603 43291.5716  59.5%  2935  306s
   845   886 40910.6947   12  355 27145.7603 43291.5716  59.5%  2783  314s
   940   923 40448.0731   11  338 27145.7603 43291.5716  59.5%  2662  322s
  1021   957 40186.8868   13  332 27145.7603 43291.5716  59.5%  2618  330s
  1105  1016 36461.7345   15  277 27145.7603 43291.5716  59.5%  2585  338s
  1196  1093 40293.2273   12  272 27145.7603 43291.5716  59.5%  2531  346s
  1299  1168 36171.6864   12  248 27145.7603 43291.5716  59.5%  2472  355s
  1420  1198 37899.6122   14  246 27145.7603 43291.5716  59.5%  2393  364s
  1492  1252 36570.1087   15  225 27145.7603 43291.5716  59.5%  2368  373s
  1568  1330 36192.0567   16  226 27145.7603 43291.5716  59.5%  2370  382s
  1665  1406 35849.4419   18  228 27145.7603 43291.5716  59.5%  2341  390s
  1797  1471 34731.8174   20  177 27145.7603 42925.9089  58.1%  2283  400s
  1928  1526 33613.5293   19  190 27145.7603 42925.9089  58.1%  2248  410s
  2033  1627 34158.1965   19  195 27145.7603 42925.9089  58.1%  2253  421s
  2152  1739 34533.6438   21  172 27145.7603 42925.9089  58.1%  2241  430s
  2292  1868 34335.1855   23  171 27145.7603 42925.9089  58.1%  2231  441s
  2439  2011 34220.1391   24  169 27145.7603 42925.9089  58.1%  2210  452s
  2610  2176 33257.9939   26  147 27145.7603 42925.9089  58.1%  2175  464s
  2805  2312 32615.8527   27  126 27145.7603 42925.9089  58.1%  2130  477s
  3013  2454 31866.4620   37  101 27145.7603 42655.2418  57.1%  2081  487s
  3223  2511 31330.7724   42  159 27145.7603 42655.2418  57.1%  2050  499s
  3368  2592 27671.8089   50  150 27145.7603 42476.0679  56.5%  2019  512s
  3519  2701 38860.3074   12  275 27145.7603 42476.0679  56.5%  2020  524s
  3674  2822 32347.1774   13  259 27145.7603 42476.0679  56.5%  2034  537s
  3848  2823 39550.7511   15  392 27145.7603 42476.0679  56.5%  2041  605s
  3850  2824 28774.5547   24   69 27145.7603 42476.0679  56.5%  2040  633s
  3851  2825 29113.8630   68  238 27145.7603 42476.0679  56.5%  2039  649s
  3852  2826 32025.9093   34  305 27145.7603 42476.0679  56.5%  2039  659s
  3853  2826 33707.9032   42  337 27145.7603 42476.0679  56.5%  2038  667s
  3854  2827 37037.6628   18  348 27145.7603 42476.0679  56.5%  2038  672s
  3855  2828 36451.3388   13  373 27145.7603 42476.0679  56.5%  2037  675s
  3857  2829 31637.3671   49  376 27145.7603 42476.0679  56.5%  2036  681s
  3859  2830 39262.3784   24  415 27145.7603 42476.0679  56.5%  2035  685s
  3862  2832 41084.6375   13  407 27145.7603 42476.0679  56.5%  2033  690s
  3865  2834 41122.3592   10  422 27145.7603 42476.0679  56.5%  2032  696s
  3868  2836 38674.0752   17  381 27145.7603 42476.0679  56.5%  2030  702s
  3871  2838 29352.2772   28  419 27145.7603 42476.0679  56.5%  2029  706s
  3873  2840 34814.0445   26  429 27145.7603 42476.0679  56.5%  2028  710s
  3875  2841 39792.7768   11  439 27145.7603 42476.0679  56.5%  2027  715s
  3877  2842 29535.2401   18  397 27145.7603 42476.0679  56.5%  2025  720s
  3880  2844 32191.5457   29  405 27145.7603 42476.0679  56.5%  2024  725s
  3883  2846 30240.2726   28  403 27145.7603 42476.0679  56.5%  2022  732s
  3885  2848 32096.5068   31  430 27145.7603 42476.0679  56.5%  2021  737s
  3886  2848 36648.4681   26  430 27145.7603 42476.0679  56.5%  2021  766s
  3887  2849 29542.6735   26  430 27145.7603 42476.0679  56.5%  2020  784s
  3888  2853 42476.0679   13  386 27145.7603 42476.0679  56.5%  2066  794s
  3890  2856 42476.0679   14  414 27145.7603 42476.0679  56.5%  2067  804s
  3894  2863 42476.0679   15  390 27145.7603 42476.0679  56.5%  2072  817s
  3902  2876 42476.0679   16  380 27145.7603 42476.0679  56.5%  2081  825s
  3918  2891 41422.5332   17  369 27145.7603 42476.0679  56.5%  2133  849s
  3938  2915 38638.7528   18  400 27145.7603 42476.0679  56.5%  2158  867s
  3969  3006 38461.7526   19  390 27145.7603 42476.0679  56.5%  2238  886s
  4070  3053 37598.9889   22  270 27145.7603 42476.0679  56.5%  2330  900s
  4151  3092 36731.1110   25  297 27145.7603 42476.0679  56.5%  2362  912s
  4220  3122 36981.3329   24  269 27145.7603 42476.0679  56.5%  2386  922s
  4287  3126 35769.1665   26  237 27145.7603 42476.0679  56.5%  2411  928s
  4321  3147 33835.6865   26  299 27145.7603 42476.0679  56.5%  2420  938s
  4376  3174 35435.6664   27  206 27145.7603 42476.0679  56.5%  2417  945s
  4455  3205 35123.9034   28  200 27145.7603 42476.0679  56.5%  2416  953s
  4537  3210 34679.2567   30  199 27145.7603 42476.0679  56.5%  2413  963s
  4630  3195 30587.3812   33  171 27145.7603 42476.0679  56.5%  2407  974s
  4693  3195 29688.8371   33  146 27145.7603 42476.0679  56.5%  2412  983s
  4763  3215 32084.5529   32  162 27145.7603 42476.0679  56.5%  2416  991s
  4825  3233 30490.9806   34  150 27145.7603 42476.0679  56.5%  2428 1002s
  4893  3257 28674.6736   38  110 27145.7603 42476.0679  56.5%  2444 1011s
  4957  3267 27577.6938   40  138 27145.7603 42476.0679  56.5%  2462 1021s
  5035  3294 38352.2440   23  266 27145.7603 42476.0679  56.5%  2471 1032s
  5118  3280 37997.6151   25  269 27145.7603 42476.0679  56.5%  2478 1044s
  5224  3270 35704.8915   27  338 27145.7603 42476.0679  56.5%  2476 1056s
  5311  3285 34947.0976   29  304 27145.7603 42476.0679  56.5%  2483 1068s
  5407  3293 32871.6993   32  266 27145.7603 42476.0679  56.5%  2487 1080s
  5485  3300 29077.3934   34  277 27145.7603 42476.0679  56.5%  2502 1091s
  5549  3313 29059.4862   35  280 27145.7603 42476.0679  56.5%  2500 1104s
  5653  3314 28941.4853   36  272 27145.7603 42080.3333  55.0%  2495 1116s
  5757  3334 27443.5900   37  235 27145.7603 42080.3333  55.0%  2501 1131s
  5863  3367 30007.3562   20  351 27145.7603 42080.3333  55.0%  2506 1145s
  5971  3366 29605.1484   22  352 27145.7603 42080.3333  55.0%  2523 1160s
  6091  3386 27766.4815   24  388 27145.7603 42080.3333  55.0%  2533 1176s
  6197  3399     cutoff   23      27145.7603 42080.3333  55.0%  2560 1193s
  6301  3426 29802.3954   30  295 27145.7603 42080.3333  55.0%  2578 1208s
  6442  3396 29288.1383   36  219 27145.7603 42080.3333  55.0%  2583 1222s
H 6470  3243                    28126.315454 42080.3333  49.6%  2593 1222s
  6487  3259 29276.0647   37  195 28126.3155 42080.3333  49.6%  2598 1242s
  6642  3275 37765.8319   21  273 28126.3155 42080.3333  49.6%  2608 1262s
  6788  3292 35721.9214   25  336 28126.3155 42080.3333  49.6%  2623 1281s
  6931  3344 30199.0343   28  274 28126.3155 42080.3333  49.6%  2645 1303s
  7090  3328     cutoff   32      28126.3155 42080.3333  49.6%  2663 1320s
H 7096  3190                    28194.032403 42080.3333  49.3%  2662 1320s
H 7106  3058                    28673.683940 42080.3333  46.8%  2660 1320s
  7218  3090     cutoff   31      28673.6839 42080.3333  46.8%  2667 1341s
  7373  3117 33715.6889   27  402 28673.6839 42080.3333  46.8%  2688 1361s
H 7408  2983                    28712.833430 42080.3333  46.6%  2689 1361s
H 7417  2863                    28722.611933 42080.3333  46.5%  2691 1361s
  7538  2804 30139.2337   31  282 28722.6119 39532.2699  37.6%  2705 1381s
  7759  2760     cutoff   34      28722.6119 39532.2699  37.6%  2707 1404s
H 7815  2620                    28808.949548 39532.2699  37.2%  2707 1404s
  8023  2594 34966.3227   27  277 28808.9495 39532.2699  37.2%  2701 1427s
  8286  2525     cutoff   34      28808.9495 38826.7239  34.8%  2703 1449s
H 8287  2356                    29119.118100 38826.7239  33.3%  2703 1449s
H 8306  2245                    29135.791814 38826.7239  33.3%  2704 1449s
H 8375  2114                    29240.607527 38826.7239  32.8%  2708 1449s
  8426  2191 31353.6021   26  195 29240.6075 38755.0168  32.5%  2706 1471s
  8656  2177 29539.5291   27  256 29240.6075 38466.2563  31.6%  2725 1497s
  8888  2195 35815.5638   27  339 29240.6075 38379.0606  31.3%  2744 1525s
  9149  2186 30419.7779   35  198 29240.6075 38269.6423  30.9%  2761 1552s
  9390  2199 35687.4714   22  301 29240.6075 37939.7072  29.8%  2781 1576s
  9522  2271     cutoff   27      29240.6075 37897.5285  29.6%  2795 1604s
  9794  2339     cutoff   29      29240.6075 37776.8630  29.2%  2804 1635s
 10060  2433 30848.7523   28  356 29240.6075 37679.1779  28.9%  2799 1670s
 10374  2506     cutoff   29      29240.6075 37523.6528  28.3%  2808 1701s
 10736  2589 30550.1136   28  218 29240.6075 37457.1038  28.1%  2813 1733s
 11108  2666 33865.1526   22  309 29240.6075 37212.5093  27.3%  2821 1768s
 11494  2706     cutoff   28      29240.6075 37212.5093  27.3%  2829 1803s
 11899  2761 31075.4105   28  214 29240.6075 36888.9796  26.2%  2833 1841s
 12298  2842 30747.3350   27  236 29240.6075 36779.7695  25.8%  2843 1875s
 12740  2965 infeasible   29      29240.6075 36546.3344  25.0%  2849 1915s
 13229  3046 32008.3834   29  275 29240.6075 36312.8619  24.2%  2846 1954s
 13731  3152 29533.1204   29  174 29240.6075 36297.9781  24.1%  2844 1997s
 14281  3285 33006.9369   25  325 29240.6075 36168.2437  23.7%  2837 2040s
 14860  3352 34625.1149   28  259 29240.6075 35952.5322  23.0%  2831 2091s
 15419  3401     cutoff   37      29240.6075 35937.2660  22.9%  2832 2129s
 15661  3520 32060.0455   27  258 29240.6075 35803.8102  22.4%  2831 2178s
 16257  3619 31847.3019   25  267 29240.6075 35706.1659  22.1%  2833 2229s
 16870  3742 29404.0795   30  247 29240.6075 35460.5768  21.3%  2836 2279s
 17555  3774 30256.3977   30  329 29240.6075 35268.6197  20.6%  2831 2331s
 18228  3826     cutoff   28      29240.6075 35160.5203  20.2%  2837 2387s
 19008  3903 30798.5542   26  204 29240.6075 35028.8267  19.8%  2829 2459s
 19783  3960     cutoff   34      29240.6075 34870.5250  19.3%  2823 2518s
 20528  4006 30567.9560   27  255 29240.6075 34718.0677  18.7%  2827 2579s
 21328  4089 31012.0490   26  294 29240.6075 34545.3506  18.1%  2826 2644s
 22229  4123 31563.5190   29  237 29240.6075 34379.2633  17.6%  2816 2710s
 23208  4139 32368.0033   26  246 29240.6075 34212.2022  17.0%  2803 2758s
 23323  4128 29429.1998   28  303 29240.6075 34212.2022  17.0%  2803 2822s
 24034  4158 30286.5990   31  270 29240.6075 34056.9706  16.5%  2802 2899s
 24993  4099 31261.2821   29  288 29240.6075 33852.3885  15.8%  2799 2974s
 26008  3979     cutoff   34      29240.6075 33725.4728  15.3%  2798 3053s
 26973  3878 30947.4208   25  349 29240.6075 33473.6171  14.5%  2806 3134s
 28023  3823 30615.6408   29  247 29240.6075 33269.2890  13.8%  2809 3219s
 29194  3668 29672.2137   26  285 29240.6075 33064.5117  13.1%  2801 3303s
 30310  3494 31428.6572   29  332 29240.6075 32860.4206  12.4%  2801 3387s
 31470  3258     cutoff   29      29240.6075 32622.4924  11.6%  2802 3476s
 32724  2963     cutoff   32      29240.6075 32314.6703  10.5%  2800 3568s
 34086  2754     cutoff   32      29240.6075 32086.1820  9.73%  2793 3600s

Cutting planes:
  MIR: 919
  Mixing: 5
  Flow cover: 2113
  RLT: 15
  Relax-and-lift: 161

Explored 34700 nodes (96745563 simplex iterations) in 3600.04 seconds (11142.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 29240.6 29135.8 29119.1 ... 27145.8

Time limit reached
Best objective 2.924060752664e+04, best bound 3.189381757656e+04, gap 9.0737%
  WARNING: Time limit reached. Using best solution found (gap: 9.07%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 29240.61, θ = 190456.63
  Upper Bound (UB) = 29240.61

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190456.63
  [DEBUG]   ✓ Scenario 0: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190456.63 ≤ Q = 190456.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190456.63 ≤ Q = 190456.63 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190456.63 ≤ Q = 190456.63 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x667508d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf998af73
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.196477e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.00s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5320514.8093
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.538723e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153872.27    0  125 5320514.81 -153872.27   103%     -    0s
H    0     0                    -123233.9333 -153872.27  24.9%     -    0s
H    0     0                    -123609.0670 -153872.27  24.5%     -    0s
     0     0 -138193.62    0   86 -123609.07 -138193.62  11.8%     -    0s
H    0     0                    -134296.9207 -138192.88  2.90%     -    0s
     0     0 -138154.34    0   87 -134296.92 -138154.34  2.87%     -    0s
H    0     0                    -136699.0577 -138154.34  1.06%     -    0s
     0     0 -137537.43    0   72 -136699.06 -137537.43  0.61%     -    0s
     0     0 -137450.88    0   72 -136699.06 -137450.88  0.55%     -    0s
     0     0 -137083.55    0   34 -136699.06 -137083.55  0.28%     -    0s
     0     0 -137004.42    0   33 -136699.06 -137004.42  0.22%     -    0s
     0     0 -136979.58    0   34 -136699.06 -136979.58  0.21%     -    0s
     0     0 -136976.78    0   38 -136699.06 -136976.78  0.20%     -    0s
     0     0 -136796.36    0   10 -136699.06 -136796.36  0.07%     -    0s
     0     0 -136766.56    0    8 -136699.06 -136766.56  0.05%     -    0s
     0     0 -136762.10    0    8 -136699.06 -136762.10  0.05%     -    0s
     0     0 -136733.42    0    2 -136699.06 -136733.42  0.03%     -    0s
     0     0 -136729.25    0    5 -136699.06 -136729.25  0.02%     -    0s
H    0     0                    -136718.4677 -136729.25  0.01%     -    0s
     0     0 -136718.82    0    2 -136718.47 -136718.82  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 1
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (733 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -136718 -136699 -123609 ... 1.19648e+13
No other solutions better than -136718

Optimal solution found (tolerance 1.00e-06)
Best objective -1.367184677219e+05, best bound -1.367184677219e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 177705.66
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136718.47
  [DEBUG]   S×d_nominal = 314424.12
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314424.12 + -136718.47 = 177705.66
  [DEBUG]   Current θ from Master = 190456.63
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12750.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16489.64
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 4153.7462, Absolute Gap = 4153.7462, Relative Gap = 0.142054
  Not converged yet (gap = 4153.75 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394490 nonzeros
Model fingerprint: 0x879a1ca1
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 67266 rows and 27306 columns
Presolve time: 1.28s
Presolved: 71727 rows, 31114 columns, 446249 nonzeros
Variable types: 28855 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 71727 rows, 31114 columns, 446249 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36790   -1.0082644e+05   0.000000e+00   3.322697e+07      5s
   55046   -9.7049671e+03   0.000000e+00   4.623314e+10     10s
   66186    1.5416899e+04   0.000000e+00   1.247211e+08     15s
   76585    2.9636584e+04   0.000000e+00   5.403956e+07     20s
Concurrent spin time: 1.49s

Solved with dual simplex

Root relaxation: objective 5.717580e+04, 46167 iterations, 20.73 seconds (41.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57175.7994    0   69 -171254.74 57175.7994   133%     -   22s
H    0     0                    -162390.2686 57175.7994   135%     -   22s
H    0     0                    -56268.50261 57175.7994   202%     -   22s
H    0     0                    2413.5223015 57175.7994  2269%     -   23s
H    0     0                    10670.625397 57175.7994   436%     -   23s
H    0     0                    11784.549153 57175.7994   385%     -   23s
H    0     0                    15301.770164 54492.0947   256%     -   31s
H    0     0                    15321.443876 54492.0947   256%     -   31s
H    0     0                    15338.688123 54492.0947   255%     -   31s
H    0     0                    15780.221125 54492.0947   245%     -   31s
H    0     0                    15810.399158 54492.0947   245%     -   31s
H    0     0                    16364.251115 54492.0947   233%     -   31s
     0     0 54492.0481    0  168 16364.2511 54492.0481   233%     -   31s
     0     0 53970.7866    0  184 16364.2511 53970.7866   230%     -   36s
     0     0 53970.7866    0  195 16364.2511 53970.7866   230%     -   38s
     0     0 53970.7495    0  187 16364.2511 53970.7495   230%     -   38s
     0     0 53970.7464    0  187 16364.2511 53970.7464   230%     -   38s
H    0     0                    16952.977343 51241.0068   202%     -   48s
H    0     0                    19366.304381 51241.0068   165%     -   48s
H    0     0                    19393.353956 51241.0068   164%     -   48s
H    0     0                    19533.498063 51241.0068   162%     -   48s
     0     0 51220.1158    0  178 19533.4981 51220.1158   162%     -   48s
H    0     0                    20540.309655 51220.1158   149%     -   48s
H    0     0                    21464.195683 51220.1158   139%     -   48s
H    0     0                    21899.676124 51220.1158   134%     -   48s
H    0     0                    21980.400018 51220.1158   133%     -   48s
H    0     0                    21997.129898 51220.1158   133%     -   48s
H    0     0                    22156.380454 51220.1158   131%     -   48s
     0     0 50039.7549    0  217 22156.3805 50039.7549   126%     -   57s
     0     0 49888.5520    0  229 22156.3805 49888.5520   125%     -   62s
     0     0 49780.3682    0  232 22156.3805 49780.3682   125%     -   65s
     0     0 49753.2867    0  235 22156.3805 49753.2867   125%     -   67s
     0     0 49742.6969    0  239 22156.3805 49742.6969   125%     -   67s
     0     0 49738.3597    0  232 22156.3805 49738.3597   124%     -   68s
     0     0 49731.8352    0  233 22156.3805 49731.8352   124%     -   69s
     0     0 49730.2300    0  237 22156.3805 49730.2300   124%     -   70s
     0     0 49729.9754    0  237 22156.3805 49729.9754   124%     -   70s
H    0     0                    22216.470124 47450.8710   114%     -   89s
H    0     0                    22400.659309 47450.8710   112%     -   89s
H    0     0                    22582.590475 47450.8710   110%     -   89s
H    0     0                    22812.669034 47450.8710   108%     -   89s
H    0     0                    22922.563893 47450.8710   107%     -   89s
H    0     0                    22972.998960 47450.8710   107%     -   89s
     0     0 47450.8710    0  281 22972.9990 47450.8710   107%     -   89s
H    0     0                    24614.593436 47450.7266  92.8%     -   89s
H    0     0                    24639.688227 47450.7266  92.6%     -   89s
H    0     0                    25762.618808 47450.7266  84.2%     -   89s
H    0     0                    25825.326253 47450.7266  83.7%     -   89s
H    0     0                    25833.608641 47450.7266  83.7%     -   89s
     0     0 46779.2567    0  294 25833.6086 46779.2567  81.1%     -   99s
     0     0 46628.4829    0  301 25833.6086 46628.4829  80.5%     -  104s
     0     0 46560.1086    0  302 25833.6086 46560.1086  80.2%     -  107s
     0     0 46481.3259    0  305 25833.6086 46481.3259  79.9%     -  110s
     0     0 46423.8146    0  304 25833.6086 46423.8146  79.7%     -  112s
     0     0 46392.1958    0  306 25833.6086 46392.1958  79.6%     -  114s
     0     0 46386.0667    0  311 25833.6086 46386.0667  79.6%     -  114s
     0     0 46376.9086    0  311 25833.6086 46376.9086  79.5%     -  115s
     0     0 46337.5736    0  306 25833.6086 46337.5736  79.4%     -  116s
     0     0 46325.0662    0  307 25833.6086 46325.0662  79.3%     -  117s
     0     0 46319.1626    0  303 25833.6086 46319.1626  79.3%     -  118s
     0     0 46302.1570    0  309 25833.6086 46302.1570  79.2%     -  119s
     0     0 46295.3531    0  312 25833.6086 46295.3531  79.2%     -  119s
     0     0 46294.7724    0  316 25833.6086 46294.7724  79.2%     -  120s
     0     0 45390.1822    0  366 25833.6086 45390.1822  75.7%     -  130s
H    0     0                    26142.241743 45388.8880  73.6%     -  131s
     0     0 45128.1651    0  367 26142.2417 45128.1651  72.6%     -  137s
     0     0 45076.0425    0  377 26142.2417 45076.0425  72.4%     -  139s
     0     0 45031.1744    0  374 26142.2417 45031.1744  72.3%     -  141s
     0     0 44987.3757    0  376 26142.2417 44987.3757  72.1%     -  142s
     0     0 44964.7083    0  374 26142.2417 44964.7083  72.0%     -  143s
     0     0 44961.2075    0  374 26142.2417 44961.2075  72.0%     -  143s
     0     0 44957.4499    0  376 26142.2417 44957.4499  72.0%     -  144s
     0     0 44956.9376    0  376 26142.2417 44956.9376  72.0%     -  144s
     0     0 44752.7435    0  380 26142.2417 44752.7435  71.2%     -  149s
H    0     0                    26242.263437 44752.6047  70.5%     -  149s
H    0     0                    26273.661132 44752.6047  70.3%     -  149s
H    0     0                    26362.213260 44752.6047  69.8%     -  149s
H    0     0                    26393.610955 44752.6047  69.6%     -  149s
     0     0 44687.0376    0  371 26393.6110 44687.0376  69.3%     -  152s
     0     0 44669.0714    0  385 26393.6110 44669.0714  69.2%     -  153s
     0     0 44650.2840    0  383 26393.6110 44650.2840  69.2%     -  154s
     0     0 44640.8150    0  388 26393.6110 44640.8150  69.1%     -  155s
     0     0 44620.4293    0  390 26393.6110 44620.4293  69.1%     -  156s
     0     0 44592.5603    0  413 26393.6110 44592.5603  69.0%     -  157s
     0     0 44568.9353    0  408 26393.6110 44568.9353  68.9%     -  158s
     0     0 44551.3138    0  410 26393.6110 44551.3138  68.8%     -  159s
     0     0 44547.2930    0  419 26393.6110 44547.2930  68.8%     -  160s
     0     0 44542.8149    0  418 26393.6110 44542.8149  68.8%     -  161s
     0     0 44541.3580    0  419 26393.6110 44541.3580  68.8%     -  161s
     0     0 44540.2849    0  418 26393.6110 44540.2849  68.8%     -  162s
     0     0 44444.6429    0  389 26393.6110 44444.6429  68.4%     -  165s
H    0     0                    26469.562310 44444.5958  67.9%     -  165s
H    0     0                    26500.960004 44444.5958  67.7%     -  165s
H    0     0                    26501.676232 44444.5958  67.7%     -  165s
H    0     0                    26549.031026 44444.5958  67.4%     -  165s
H    0     0                    26626.695380 44444.5958  66.9%     -  165s
     0     0 44398.6532    0  404 26626.6954 44398.6532  66.7%     -  167s
     0     0 44387.1190    0  399 26626.6954 44387.1190  66.7%     -  168s
     0     0 44386.3905    0  408 26626.6954 44386.3905  66.7%     -  168s
     0     0 44348.8985    0  405 26626.6954 44348.8985  66.6%     -  171s
     0     0 44340.8890    0  406 26626.6954 44340.8890  66.5%     -  172s
     0     0 44339.7899    0  410 26626.6954 44339.7899  66.5%     -  173s
     0     0 44334.1918    0  409 26626.6954 44334.1918  66.5%     -  174s
H    0     0                    26653.300249 44334.0361  66.3%     -  175s
H    0     0                    26655.859922 44334.0361  66.3%     -  175s
     0     0 44332.7455    0  410 26655.8599 44332.7455  66.3%     -  175s
     0     0 44329.5421    0  419 26655.8599 44329.5421  66.3%     -  176s
H    0     0                    26744.564070 44329.3321  65.8%     -  177s
     0     0 44325.9732    0  422 26744.5641 44325.9732  65.7%     -  177s
     0     0 44325.2381    0  407 26744.5641 44325.2381  65.7%     -  177s
     0     0 44322.5351    0  413 26744.5641 44322.5351  65.7%     -  179s
     0     0 44321.7760    0  413 26744.5641 44321.7760  65.7%     -  179s
H    0     0                    26978.348200 44319.5602  64.3%     -  208s
     0     2 44319.5602    0  413 26978.3482 44319.5602  64.3%     -  209s
     1     4 44173.7550    1  396 26978.3482 44319.5602  64.3%  3215  215s
     3     8 44068.6937    2  390 26978.3482 44172.5040  63.7%  5719  220s
     7    16 44007.7714    3  387 26978.3482 44149.4274  63.6%  5287  229s
    15    31 43900.9788    4  396 26978.3482 44051.1177  63.3%  6347  241s
    30    46 42422.4627    5  378 26978.3482 43995.3002  63.1% 11091  263s
    45    78 41877.5081    6  376 26978.3482 43995.3002  63.1% 11153  278s
H   55    78                    26982.747610 43995.3002  63.0%  9994  279s
    77   216 41717.7187    7  366 26982.7476 43900.2957  62.7%  8750  293s
   215   295 41337.8291   12  347 26982.7476 43900.2957  62.7%  5322  305s
H  217   295                    26989.988846 43900.2957  62.7%  5292  305s
H  256   295                    26998.638097 43900.2957  62.6%  4984  305s
   296   362 40997.7034   14  340 26998.6381 43900.2957  62.6%  4818  313s
   363   422 40944.0324   15  341 26998.6381 43900.2957  62.6%  4648  320s
H  378   422                    27077.874746 43900.2957  62.1%  4625  320s
   423   481 40675.8381   17  338 27077.8747 43900.2957  62.1%  4520  328s
   493   538 40328.9824   20  308 27077.8747 43900.2957  62.1%  4454  334s
   564   590 40061.4922   22  321 27077.8747 43900.2957  62.1%  4382  343s
   637   623 37197.5660   24  294 27077.8747 43900.2957  62.1%  4337  352s
   693   675 36979.5033   26  293 27077.8747 43900.2957  62.1%  4372  360s
   757   718 36384.4108   28  289 27077.8747 43900.2957  62.1%  4372  369s
H  765   718                    27103.899976 43900.2957  62.0%  4364  369s
   822   764 36136.8868   30  287 27103.9000 43900.2957  62.0%  4370  376s
   886   790 35524.1349   32  288 27103.9000 43900.2957  62.0%  4468  385s
   920   831 33818.3270   33  265 27103.9000 43900.2957  62.0%  4532  392s
   975   866 33569.8816   34  259 27103.9000 43900.2957  62.0%  4528  402s
  1036   902 33361.3150   36  253 27103.9000 43900.2957  62.0%  4538  410s
  1078   929 32956.7112   37  205 27103.9000 43900.2957  62.0%  4541  418s
  1113   977 32950.9146   38  202 27103.9000 43900.2957  62.0%  4615  427s
  1165  1034 32889.9990   39  203 27103.9000 43900.2957  62.0%  4636  435s
  1236  1108 32839.4837   40  199 27103.9000 43900.2957  62.0%  4522  445s
  1328  1194 32574.8564   42  190 27103.9000 43900.2957  62.0%  4439  455s
  1455  1246 32254.4624   45  171 27103.9000 43900.2957  62.0%  4275  466s
  1566  1273 31273.7125   47  248 27103.9000 43900.2957  62.0%  4173  475s
  1601  1322 31113.6384   48  250 27103.9000 43766.0176  61.5%  4211  488s
  1668  1413 31015.9278   49  248 27103.9000 43766.0176  61.5%  4209  496s
  1797  1469 30401.5816   52  224 27103.9000 43766.0176  61.5%  4130  508s
  1930  1528 29856.3509   58  182 27103.9000 43766.0176  61.5%  4103  518s
  2025  1589     cutoff   61      27103.9000 43766.0176  61.5%  4133  530s
  2144  1648 41786.4784   15  335 27103.9000 43766.0176  61.5%  4163  542s
  2247  1727 40410.0566   17  290 27103.9000 43766.0176  61.5%  4214  553s
  2358  1822 36953.8086   19  248 27103.9000 43766.0176  61.5%  4270  565s
  2516  1909 36865.5125   20  203 27103.9000 43597.4031  60.9%  4256  577s
  2674  1964 36731.5335   21  186 27103.9000 43596.9903  60.9%  4161  592s
  2823  2012 35047.4068   25  179 27103.9000 43596.9903  60.9%  4131  605s
  2921  2088 34563.1992   27  179 27103.9000 43596.9903  60.9%  4220  619s
  3025  2152 33167.5873   30  166 27103.9000 43265.3996  59.6%  4316  632s
  3151  2216 29021.1443   32  178 27103.9000 43265.3996  59.6%  4390  645s
  3259  2301     cutoff   38      27103.9000 43265.3996  59.6%  4476  661s
  3436  2340 40709.1309    6  370 27103.9000 43265.3996  59.6%  4492  676s
  3595  2435 38095.8608    8  314 27103.9000 43160.9122  59.2%  4534  692s
  3736  2548 35273.4454   11  277 27103.9000 43160.9122  59.2%  4622  708s
  3912  2635 33799.3592   13  226 27103.9000 42752.5526  57.7%  4673  725s
  4050  2636 38947.8803   19  413 27103.9000 42731.8683  57.7%  4760  825s
  4052  2637 31555.6911   34   69 27103.9000 42731.8683  57.7%  4758  855s
  4053  2638 39927.7190   13  266 27103.9000 42731.8683  57.7%  4757  872s
  4054  2639 28197.3999   37  353 27103.9000 42731.8683  57.7%  4756  890s
  4055  2639 39385.8704    8  341 27103.9000 42731.8683  57.7%  4755  898s
  4056  2640 36323.8297   13  368 27103.9000 42731.8683  57.7%  4753  904s
  4057  2641 39289.4304   16  384 27103.9000 42731.8683  57.7%  4752  911s
  4058  2641 27370.0163   30  395 27103.9000 42731.8683  57.7%  4751  915s
  4060  2643 27291.4171   33  426 27103.9000 42731.8683  57.7%  4749  923s
  4061  2643 30567.1062   19  426 27103.9000 42731.8683  57.7%  4748  925s
  4064  2645 29452.5851   38  406 27103.9000 42731.8683  57.7%  4744  930s
  4067  2647 42731.8683   11  415 27103.9000 42731.8683  57.7%  4741  935s
  4069  2649 32434.4809   46  414 27103.9000 42731.8683  57.7%  4738  940s
  4072  2651 29174.3134   22  443 27103.9000 42731.8683  57.7%  4735  947s
  4074  2652 32115.6096   37  406 27103.9000 42731.8683  57.7%  4732  950s
  4076  2653 32752.8574   29  449 27103.9000 42731.8683  57.7%  4730  955s
  4078  2655 40182.3142   22  453 27103.9000 42731.8683  57.7%  4728  961s
  4081  2657 29400.8723   21  416 27103.9000 42731.8683  57.7%  4724  966s
  4082  2657 39042.9270   14  455 27103.9000 42731.8683  57.7%  4723  971s
  4084  2659 32277.5087   17  463 27103.9000 42731.8683  57.7%  4721  975s
  4085  2659 29950.8274   25  419 27103.9000 42731.8683  57.7%  4720  981s
  4087  2661 33142.4980   23  418 27103.9000 42731.8683  57.7%  4717  985s
  4091  2663 34439.9248   18  420 27103.9000 42731.8683  57.7%  4713  992s
  4093  2665 40010.8747   15  424 27103.9000 42731.8683  57.7%  4710  995s
  4095  2666 28730.9696   46  423 27103.9000 42731.8683  57.7%  4708 1000s
  4097  2667 35684.0921   15  467 27103.9000 42731.8683  57.7%  4706 1005s
  4100  2669 40573.2987   13  466 27103.9000 42731.8683  57.7%  4702 1010s
  4102  2671 31827.5969   41  424 27103.9000 42731.8683  57.7%  4700 1015s
  4104  2672 34328.3431   20  463 27103.9000 42731.8683  57.7%  4698 1021s
  4105  2673 39904.1183   14  463 27103.9000 42731.8683  57.7%  4697 1050s
  4106  2673 27225.7443   32  463 27103.9000 42731.8683  57.7%  4695 1082s
  4107  2677 42731.8683   11  459 27103.9000 42731.8683  57.7%  4755 1096s
  4109  2680 42731.8683   12  421 27103.9000 42731.8683  57.7%  4756 1115s
  4113  2687 42731.8683   13  441 27103.9000 42731.8683  57.7%  4759 1136s
  4121  2700 42731.8683   14  441 27103.9000 42731.8683  57.7%  4768 1155s
  4137  2711 42412.4958   15  433 27103.9000 42731.8683  57.7%  4823 1185s
  4153  2738 41119.8356   16  370 27103.9000 42731.8683  57.7%  4848 1203s
  4185  2817 40783.5228   17  319 27103.9000 42731.8683  57.7%  4856 1226s
  4275  2866 40103.8064   21  295 27103.9000 42731.8683  57.7%  4873 1239s
  4355  2901 39701.0381   23  283 27103.9000 42731.8683  57.7%  4864 1252s
  4421  2908 39841.2383   23  285 27103.9000 42731.8683  57.7%  4862 1260s
  4456  2942 39575.4300   23  283 27103.9000 42731.8683  57.7%  4868 1271s
  4510  2951 39065.5339   24  287 27103.9000 42731.8683  57.7%  4884 1286s
  4570  2965 36504.5763   24  283 27103.9000 42731.8683  57.7%  4893 1300s
  4631  2967 36696.1620   24  332 27103.9000 42731.8683  57.7%  4918 1311s
  4673  2984 36931.7912   24  281 27103.9000 42731.8683  57.7%  4936 1322s
  4737  2988 37227.1448   25  321 27103.9000 42731.8683  57.7%  4939 1336s
  4818  2987 36191.1312   25  279 27103.9000 42731.8683  57.7%  4931 1349s
  4880  2981 36510.3573   26  363 27103.9000 42731.8683  57.7%  4948 1360s
  4967  2969 34853.0180   28  376 27103.9000 42476.9052  56.7%  4939 1371s
  5043  2958 33892.1374   29  300 27103.9000 42476.9052  56.7%  4948 1383s
  5082  2964 33288.8069   30  279 27103.9000 42476.9052  56.7%  4951 1393s
  5123  2975 29728.2000   31  298 27103.9000 42476.9052  56.7%  4977 1407s
  5158  2986 30934.0428   31  275 27103.9000 42476.9052  56.7%  4980 1419s
  5199  3004 29343.3405   30  321 27103.9000 42476.9052  56.7%  4994 1435s
  5251  3012 33793.6887   29  387 27103.9000 42476.9052  56.7%  5002 1447s
  5313  3023 30830.0975   32  255 27103.9000 42318.7863  56.1%  5003 1460s
  5394  3051 28752.8527   33  232 27103.9000 42141.7751  55.5%  5000 1474s
  5495  3042 29468.1290   35  283 27103.9000 41786.5426  54.2%  4999 1487s
  5531  3051     cutoff   36      27103.9000 41786.5426  54.2%  5014 1500s
  5573  3067     cutoff   35      27103.9000 41786.5426  54.2%  5029 1512s
  5613  3074     cutoff   38      27103.9000 41786.5426  54.2%  5030 1530s
  5674  3082     cutoff   39      27103.9000 41786.5426  54.2%  5027 1546s
  5739  3092 27950.7183   40  156 27103.9000 41786.5426  54.2%  5036 1561s
  5801  3111 27920.3699   41  159 27103.9000 41786.5426  54.2%  5036 1577s
  5888  3106     cutoff   42      27103.9000 41786.5426  54.2%  5029 1592s
H 5952  2950                    27223.266252 41786.5426  53.5%  5040 1592s
  5967  2992     cutoff   42      27223.2663 41786.5426  53.5%  5041 1611s
  6111  3006 29707.6645   17  340 27223.2663 41786.5426  53.5%  5036 1629s
  6248  3012 28099.8399   20  384 27223.2663 41786.5426  53.5%  5037 1651s
  6390  3015 31432.7691   27  199 27223.2663 41786.5426  53.5%  5060 1670s
  6523  3055 29693.4390   30  171 27223.2663 41786.5426  53.5%  5085 1693s
  6710  3021 27494.4113   42   51 27223.2663 39852.0071  46.4%  5052 1718s
  6886  3027 29821.2540   18  345 27223.2663 39582.4635  45.4%  5065 1739s
  7013  2999     cutoff   21      27223.2663 39582.4635  45.4%  5089 1758s
H 7016  2870                    28775.361709 39582.4635  37.6%  5091 1758s
  7060  2906     cutoff   21      28775.3617 39582.4635  37.6%  5110 1780s
  7220  2903 31386.5488   23  293 28775.3617 39193.7657  36.2%  5125 1803s
  7387  2938 29515.8408   26  189 28775.3617 39193.7657  36.2%  5150 1826s
  7567  2961     cutoff   26      28775.3617 38823.5642  34.9%  5159 1850s
  7768  2917     cutoff   18      28775.3617 38758.4250  34.7%  5174 1872s
  7807  2918 35174.9555   19  242 28775.3617 38758.4250  34.7%  5184 1896s
H 7817  2793                    28876.481512 38758.4250  34.2%  5183 1896s
H 7824  2675                    28917.352265 38758.4250  34.0%  5184 1896s
  7854  2692 33197.0680   20  187 28917.3523 38758.4250  34.0%  5192 1922s
  8095  2603 33396.0253   22  294 28917.3523 38758.4250  34.0%  5189 1949s
  8305  2592     cutoff   23      28917.3523 38758.4250  34.0%  5219 1978s
  8521  2600     cutoff   23      28917.3523 38195.8214  32.1%  5259 2006s
  8770  2615 28931.8678   24  287 28917.3523 38001.5807  31.4%  5289 2039s
  9020  2548     cutoff   27      28917.3523 37968.7494  31.3%  5309 2062s
  9081  2584 34569.2032   19  303 28917.3523 37753.3212  30.6%  5315 2093s
  9290  2614 30821.2657   24  221 28917.3523 37753.3212  30.6%  5327 2126s
  9589  2630 33238.3013   24  287 28917.3523 37680.5212  30.3%  5344 2159s
  9955  2580 30281.3665   29  192 28917.3523 37665.7361  30.3%  5343 2193s
 10286  2556 32042.3443   25  290 28917.3523 37522.3325  29.8%  5366 2229s
 10625  2518 29445.5133   23  219 28917.3523 37214.9028  28.7%  5394 2267s
 10960  2618 31258.8739   24  310 28917.3523 36981.1456  27.9%  5426 2304s
 11367  2709 30708.6321   23  255 28917.3523 36892.2417  27.6%  5424 2343s
 11789  2776 30281.9852   26  261 28917.3523 36642.6377  26.7%  5435 2383s
 12210  2842 33692.5352   21  326 28917.3523 36493.6773  26.2%  5450 2426s
 12629  2942 29822.6576   25  274 28917.3523 36371.7551  25.8%  5465 2471s
 13111  3077 29740.2579   26  189 28917.3523 36303.7597  25.5%  5468 2520s
 13612  3181 29359.0523   28  306 28917.3523 36180.2598  25.1%  5465 2565s
 14117  3275 32129.3084   30  228 28917.3523 36100.4802  24.8%  5474 2609s
 14639  3408 29289.7437   24  232 28917.3523 35980.2735  24.4%  5488 2655s
 15217  3465 30303.0329   21  330 28917.3523 35784.4615  23.7%  5486 2704s
 15794  3524     cutoff   27      28917.3523 35749.0957  23.6%  5488 2760s
H16026  3521                    28938.837379 35588.2338  23.0%  5483 2760s
 16297  3557 31674.1069   19  253 28938.8374 35502.1366  22.7%  5486 2812s
 16924  3638 31946.6975   22  289 28938.8374 35321.6918  22.1%  5497 2872s
 17584  3646 34429.3880   22  279 28938.8374 35137.6390  21.4%  5503 2927s
 17929  3718     cutoff   26      28938.8374 35134.7548  21.4%  5511 2988s
 18659  3763     cutoff   31      28938.8374 35072.6097  21.2%  5506 3051s
 19408  3789     cutoff   26      28938.8374 34806.5883  20.3%  5499 3115s
 20153  3888 30493.3032   25  262 28938.8374 34596.6047  19.6%  5489 3185s
 20985  3959 31955.7606   25  212 28938.8374 34443.4294  19.0%  5478 3256s
 21873  3954 infeasible   27      28938.8374 34208.1225  18.2%  5460 3328s
H22461  3948                    28963.037441 34155.6082  17.9%  5457 3328s
 22647  3958 32008.8494   20  325 28963.0374 34155.6082  17.9%  5460 3406s
 23554  3956 30029.6973   28  192 28963.0374 33866.7667  16.9%  5456 3484s
H23639  3925                    29064.095650 33842.8560  16.4%  5454 3484s
 24275  3881     cutoff   27      29064.0956 33698.3597  15.9%  5440 3568s
 25255  3843 infeasible   27      29064.0956 33421.4119  15.0%  5438 3600s
H25256  3838                    29081.321703 33421.4119  14.9%  5438 3600s

Cutting planes:
  MIR: 1160
  Mixing: 5
  Flow cover: 2579
  RLT: 16
  Relax-and-lift: 179

Explored 25446 nodes (138546453 simplex iterations) in 3600.04 seconds (11595.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 29081.3 29064.1 28963 ... 27077.9

Time limit reached
Best objective 2.908132170343e+04, best bound 3.341978046149e+04, gap 14.9184%
  WARNING: Time limit reached. Using best solution found (gap: 14.92%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 29081.32, θ = 189952.70
  Upper Bound (UB) = 29081.32

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 189952.70
  [DEBUG]   ✓ Scenario 0: θ = 189952.70 ≤ Q = 189952.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 189952.70 ≤ Q = 189952.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 189952.70 ≤ Q = 189952.70 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 189952.70 ≤ Q = 189952.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 189952.70 ≤ Q = 189956.04 (slack: 3.34)
  [DEBUG]   ✓ Scenario 5: θ = 189952.70 ≤ Q = 189952.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 189952.70 ≤ Q = 189952.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 189952.70 ≤ Q = 189952.70 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 189952.70 ≤ Q = 189952.70 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3e892a9c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3e892a9c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.189648e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.00s
Presolved: 470 rows, 475 columns, 1325 nonzeros
Found heuristic solution: objective 5289064.8826
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.531989e+05, 243 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -153198.91    0  124 5289064.88 -153198.91   103%     -    0s
H    0     0                    -119469.5536 -153198.91  28.2%     -    0s
H    0     0                    -120006.4427 -153198.91  27.7%     -    0s
H    0     0                    -121281.1675 -138418.26  14.1%     -    0s
H    0     0                    -127655.9942 -138418.26  8.43%     -    0s
     0     0 -138335.93    0   78 -127655.99 -138335.93  8.37%     -    0s
H    0     0                    -135922.9005 -138318.07  1.76%     -    0s
     0     0 -138293.38    0   74 -135922.90 -138293.38  1.74%     -    0s
H    0     0                    -136856.0022 -138293.38  1.05%     -    0s
     0     0 -137685.62    0   57 -136856.00 -137685.62  0.61%     -    0s
     0     0 -137610.23    0   46 -136856.00 -137610.23  0.55%     -    0s
     0     0 -137432.41    0   27 -136856.00 -137432.41  0.42%     -    0s
     0     0 -137406.39    0   26 -136856.00 -137406.39  0.40%     -    0s
     0     0 -137399.64    0   26 -136856.00 -137399.64  0.40%     -    0s
     0     0 -137297.11    0   23 -136856.00 -137297.11  0.32%     -    0s
     0     0 -137212.55    0   19 -136856.00 -137212.55  0.26%     -    0s
H    0     0                    -136898.1938 -137212.41  0.23%     -    0s
     0     0 -137212.41    0   20 -136898.19 -137212.41  0.23%     -    0s
     0     0 -137148.82    0   15 -136898.19 -137148.82  0.18%     -    0s
     0     0 -137122.36    0   12 -136898.19 -137122.36  0.16%     -    0s
     0     0 -137121.77    0   11 -136898.19 -137121.77  0.16%     -    0s
     0     0 -137065.08    0   14 -136898.19 -137065.08  0.12%     -    0s
     0     0 -137065.08    0   23 -136898.19 -137065.08  0.12%     -    0s
     0     0 -136932.00    0   12 -136898.19 -136932.00  0.02%     -    0s
*    0     0               0    -136930.9309 -136930.93  0.00%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 2
  MIR: 3
  Flow cover: 16
  Relax-and-lift: 4

Explored 1 nodes (798 simplex iterations) in 0.07 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -136931 -136898 -136856 ... 1.18965e+13
No other solutions better than -136931

Optimal solution found (tolerance 1.00e-06)
Best objective -1.369309309206e+05, best bound -1.369309309206e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 177453.91
  Scenario: 35 demand increases, 25 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136930.93
  [DEBUG]   S×d_nominal = 314384.84
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314384.84 + -136930.93 = 177453.91
  [DEBUG]   Current θ from Master = 189952.70
  [DEBUG]   ⚠️  Z_SP ≤ θ by 12498.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 16582.53
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 3994.4604, Absolute Gap = 3994.4604, Relative Gap = 0.137355
  Not converged yet (gap = 3994.46 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 35 increases, 25 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437709 nonzeros
Model fingerprint: 0xea1f8ce1
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 74740 rows and 30340 columns
Presolve time: 1.17s
Presolved: 79543 rows, 34320 columns, 489159 nonzeros
Variable types: 32061 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 79543 rows, 34320 columns, 489159 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36591   -6.4113070e+04   0.000000e+00   8.579133e+08      5s
   49866   -1.3988359e+04   0.000000e+00   3.065324e+07     10s
   59321    4.1842433e+03   0.000000e+00   1.024359e+08     15s
   68231    2.1016939e+04   0.000000e+00   3.194768e+07     20s
   76992    2.9374037e+04   0.000000e+00   5.732476e+06     25s
Concurrent spin time: 2.77s

Solved with dual simplex

Root relaxation: objective 5.717411e+04, 59961 iterations, 29.08 seconds (58.79 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57174.1050    0   65 -171254.74 57174.1050   133%     -   30s
H    0     0                    -163529.6840 57174.1050   135%     -   30s
H    0     0                    -126213.0706 57174.1050   145%     -   31s
H    0     0                    -125823.4303 57174.1050   145%     -   31s
H    0     0                    -125641.8718 57174.1050   146%     -   31s
H    0     0                    -52707.76219 57174.1050   208%     -   31s
H    0     0                    -10130.93317 57174.1050   664%     -   31s
H    0     0                    9117.3530981 57174.1050   527%     -   31s
H    0     0                    14567.626976 57174.1050   292%     -   31s
H    0     0                    16681.525549 57174.1050   243%     -   31s
H    0     0                    16899.637840 57174.1050   238%     -   32s
H    0     0                    17271.703758 57174.1050   231%     -   32s
     0     0 54174.7635    0  184 17271.7038 54174.7635   214%     -   41s
H    0     0                    18845.002649 54174.7635   187%     -   41s
H    0     0                    19001.628823 54174.7635   185%     -   41s
H    0     0                    19034.576173 54174.7635   185%     -   41s
     0     0 54171.3648    0  212 19034.5762 54171.3648   185%     -   44s
     0     0 54171.3648    0  190 19034.5762 54171.3648   185%     -   44s
     0     0 54171.3648    0  190 19034.5762 54171.3648   185%     -   45s
     0     0 54171.3648    0  190 19034.5762 54171.3648   185%     -   45s
     0     0 50878.0957    0  181 19034.5762 50878.0957   167%     -   58s
H    0     0                    20119.770885 50877.4366   153%     -   58s
H    0     0                    20179.620697 50877.4366   152%     -   58s
H    0     0                    20187.679216 50877.4366   152%     -   58s
     0     0 50145.3810    0  170 20187.6792 50145.3810   148%     -   65s
     0     0 49999.8245    0  179 20187.6792 49999.8245   148%     -   69s
     0     0 49932.5434    0  187 20187.6792 49932.5434   147%     -   71s
H    0     0                    20259.823871 49793.3580   146%     -   74s
H    0     0                    20355.094392 49793.3580   145%     -   74s
H    0     0                    20889.772935 49793.3580   138%     -   74s
H    0     0                    20988.083368 49793.3580   137%     -   74s
     0     0 49793.3580    0  179 20988.0834 49793.3580   137%     -   74s
     0     0 49778.7832    0  224 20988.0834 49778.7832   137%     -   75s
     0     0 49767.3994    0  188 20988.0834 49767.3994   137%     -   76s
     0     0 49765.1422    0  195 20988.0834 49765.1422   137%     -   77s
     0     0 49765.1228    0  191 20988.0834 49765.1228   137%     -   77s
     0     0 46963.5406    0  299 20988.0834 46963.5406   124%     -   98s
H    0     0                    21158.405580 46963.2092   122%     -   99s
H    0     0                    21554.697385 46963.2092   118%     -   99s
H    0     0                    21618.225592 46963.2092   117%     -   99s
H    0     0                    21801.851300 46519.8126   113%     -  107s
     0     0 46519.8126    0  305 21801.8513 46519.8126   113%     -  107s
     0     0 46381.9850    0  305 21801.8513 46381.9850   113%     -  112s
     0     0 46323.9808    0  314 21801.8513 46323.9808   112%     -  114s
     0     0 46274.2287    0  319 21801.8513 46274.2287   112%     -  117s
     0     0 46233.4015    0  322 21801.8513 46233.4015   112%     -  118s
     0     0 46161.8211    0  316 21801.8513 46161.8211   112%     -  120s
     0     0 46139.4333    0  319 21801.8513 46139.4333   112%     -  122s
     0     0 46131.1071    0  322 21801.8513 46131.1071   112%     -  122s
     0     0 46120.4290    0  320 21801.8513 46120.4290   112%     -  123s
     0     0 46119.3879    0  320 21801.8513 46119.3879   112%     -  123s
     0     0 45475.1785    0  360 21801.8513 45475.1785   109%     -  137s
     0     0 45266.8192    0  377 21801.8513 45266.8192   108%     -  142s
     0     0 45159.3774    0  363 21801.8513 45159.3774   107%     -  145s
     0     0 45120.9580    0  368 21801.8513 45120.9580   107%     -  147s
     0     0 45067.0232    0  353 21801.8513 45067.0232   107%     -  149s
     0     0 44993.4163    0  369 21801.8513 44993.4163   106%     -  152s
     0     0 44936.3638    0  367 21801.8513 44936.3638   106%     -  154s
     0     0 44925.0352    0  370 21801.8513 44925.0352   106%     -  156s
     0     0 44918.0189    0  364 21801.8513 44918.0189   106%     -  157s
     0     0 44905.7736    0  369 21801.8513 44905.7736   106%     -  158s
     0     0 44898.2942    0  368 21801.8513 44898.2942   106%     -  160s
     0     0 44895.5830    0  372 21801.8513 44895.5830   106%     -  160s
     0     0 44895.3174    0  372 21801.8513 44895.3174   106%     -  161s
     0     0 44712.6883    0  391 21801.8513 44712.6883   105%     -  166s
     0     0 44674.8754    0  396 21801.8513 44674.8754   105%     -  169s
     0     0 44652.2231    0  399 21801.8513 44652.2231   105%     -  170s
     0     0 44641.7379    0  392 21801.8513 44641.7379   105%     -  171s
     0     0 44639.0682    0  392 21801.8513 44639.0682   105%     -  172s
     0     0 44635.6127    0  393 21801.8513 44635.6127   105%     -  173s
     0     0 44633.4928    0  389 21801.8513 44633.4928   105%     -  174s
     0     0 44632.0870    0  396 21801.8513 44632.0870   105%     -  174s
     0     0 44607.1896    0  390 21801.8513 44607.1896   105%     -  176s
     0     0 44584.5650    0  392 21801.8513 44584.5650   104%     -  178s
     0     0 44576.6887    0  416 21801.8513 44576.6887   104%     -  179s
     0     0 44573.5821    0  416 21801.8513 44573.5821   104%     -  181s
     0     0 44571.2628    0  418 21801.8513 44571.2628   104%     -  181s
     0     0 44561.8846    0  417 21801.8513 44561.8846   104%     -  182s
     0     0 44552.2854    0  416 21801.8513 44552.2854   104%     -  183s
     0     0 44547.3286    0  421 21801.8513 44547.3286   104%     -  184s
     0     0 44546.6021    0  415 21801.8513 44546.6021   104%     -  184s
     0     0 44518.2415    0  408 21801.8513 44518.2415   104%     -  186s
     0     0 44493.4863    0  421 21801.8513 44493.4863   104%     -  187s
     0     0 44482.9824    0  422 21801.8513 44482.9824   104%     -  188s
     0     0 44479.7838    0  402 21801.8513 44479.7838   104%     -  189s
     0     0 44476.1136    0  395 21801.8513 44476.1136   104%     -  189s
     0     0 44471.4801    0  395 21801.8513 44471.4801   104%     -  190s
     0     0 44466.8659    0  398 21801.8513 44466.8659   104%     -  191s
     0     0 44464.5326    0  400 21801.8513 44464.5326   104%     -  191s
     0     0 44464.0032    0  400 21801.8513 44464.0032   104%     -  191s
     0     0 44417.1051    0  413 21801.8513 44417.1051   104%     -  194s
     0     0 44400.6733    0  419 21801.8513 44400.6733   104%     -  195s
     0     0 44391.0431    0  432 21801.8513 44391.0431   104%     -  196s
     0     0 44385.5475    0  429 21801.8513 44385.5475   104%     -  197s
     0     0 44381.4805    0  426 21801.8513 44381.4805   104%     -  197s
     0     0 44376.2533    0  423 21801.8513 44376.2533   104%     -  198s
     0     0 44375.9804    0  424 21801.8513 44375.9804   104%     -  198s
     0     0 44315.3138    0  428 21801.8513 44315.3138   103%     -  202s
     0     0 44290.3008    0  441 21801.8513 44290.3008   103%     -  204s
     0     0 44286.1361    0  443 21801.8513 44286.1361   103%     -  205s
     0     0 44285.7125    0  442 21801.8513 44285.7125   103%     -  205s
     0     0 44267.6191    0  398 21801.8513 44267.6191   103%     -  207s
     0     0 44262.2472    0  438 21801.8513 44262.2472   103%     -  209s
     0     0 44260.2694    0  441 21801.8513 44260.2694   103%     -  210s
     0     0 44258.6338    0  442 21801.8513 44258.6338   103%     -  210s
     0     0 44258.2724    0  438 21801.8513 44258.2724   103%     -  211s
     0     0 44250.5180    0  444 21801.8513 44250.5180   103%     -  213s
     0     0 44249.7810    0  443 21801.8513 44249.7810   103%     -  214s
     0     0 44244.0871    0  442 21801.8513 44244.0871   103%     -  215s
     0     0 44242.4045    0  523 21801.8513 44242.4045   103%     -  216s
     0     0 44240.3516    0  442 21801.8513 44240.3516   103%     -  217s
     0     0 44239.9551    0  443 21801.8513 44239.9551   103%     -  218s
     0     0 44238.6891    0  450 21801.8513 44238.6891   103%     -  219s
     0     0 44237.3035    0  450 21801.8513 44237.3035   103%     -  220s
H    0     0                    21927.500763 44237.3035   102%     -  242s
H    0     0                    22183.606373 44237.3035  99.4%     -  242s
H    0     0                    23937.551718 44237.3035  84.8%     -  242s
H    0     0                    24043.438320 44237.3035  84.0%     -  242s
H    0     0                    24190.228029 44237.3035  82.9%     -  242s
H    0     0                    24211.476403 44236.5338  82.7%     -  273s
H    0     0                    24361.180675 44236.5338  81.6%     -  274s
H    0     0                    24495.125064 44236.5338  80.6%     -  275s
     0     2 44236.5338    0  450 24495.1251 44236.5338  80.6%     -  277s
     1     4 44046.3221    1  393 24495.1251 44235.5713  80.6%  7327  284s
     3     8 43914.9617    2  422 24495.1251 44043.5443  79.8%  8421  290s
     7    16 43684.0712    3  430 24495.1251 43914.4497  79.3%  7335  302s
    15    32 43534.7205    4  439 24495.1251 43682.7541  78.3%  9349  309s
    31    48 43137.8829    5  385 24495.1251 43534.3514  77.7% 10709  326s
    47    80 42967.5587    6  431 24495.1251 43534.3514  77.7% 12120  336s
    79   177 42902.5166    7  419 24495.1251 43534.3514  77.7%  9085  347s
   176   237 42789.7390    9  365 24495.1251 43534.3514  77.7%  6335  356s
   236   304 42689.6777   10  410 24495.1251 43534.3514  77.7%  5628  365s
   303   336 42678.8689   10  359 24495.1251 43534.3514  77.7%  5037  376s
   335   397 42056.5033    8  380 24495.1251 43534.3514  77.7%  4885  385s
   396   465 42548.3280   11  354 24495.1251 43534.3514  77.7%  4678  393s
   464   497 42608.5503   11  395 24495.1251 43534.3514  77.7%  4424  399s
   496   530 42377.3425   11  349 24495.1251 43534.3514  77.7%  4345  407s
   529   561 42423.7662   11  355 24495.1251 43534.3514  77.7%  4231  414s
H  541   561                    24955.189983 43534.3514  74.5%  4207  414s
   560   628 42447.4738   12  347 24955.1900 43534.3514  74.5%  4157  421s
H  561   628                    26763.790692 43534.3514  62.7%  4149  421s
H  612   628                    26777.059105 43534.3514  62.6%  3981  421s
H  614   628                    26937.254343 43534.3514  61.6%  3971  421s
   627   660 42217.7463   12  359 26937.2543 43534.3514  61.6%  3926  427s
H  634   660                    26953.295020 43534.3514  61.5%  3913  427s
   659   724 42317.7856   12  350 26953.2950 43534.3514  61.5%  3883  435s
H  682   724                    26998.238171 43534.3514  61.2%  3802  435s
H  709   724                    27071.543332 43534.3514  60.8%  3750  435s
   723   802 42488.3617   12  404 27071.5433 43534.3514  60.8%  3718  444s
   803   833 42418.9704   13  348 27071.5433 43534.3514  60.8%  3554  452s
   834   869 42259.8827   13  339 27071.5433 43534.3514  60.8%  3515  458s
H  853   869                    27077.874746 43534.3514  60.8%  3477  458s
   870   963 41945.5162   12  352 27077.8747 43534.3514  60.8%  3486  466s
   964  1025 42080.8832   12  365 27077.8747 43534.3514  60.8%  3342  474s
H 1021  1025                    27103.899976 43534.3514  60.6%  3272  474s
  1041  1112 42185.7151   13  392 27103.9000 43534.3514  60.6%  3274  483s
  1141  1181 42390.5477   14  347 27103.9000 43534.3514  60.6%  3147  493s
  1234  1272 33697.2678   40  296 27103.9000 43534.3514  60.6%  3055  503s
  1353  1297 41617.3172   14  345 27103.9000 43534.3514  60.6%  2929  512s
  1392  1334 41389.5448   14  335 27103.9000 43534.3514  60.6%  2953  523s
  1449  1363 38413.6360   14  266 27103.9000 43534.3514  60.6%  2947  534s
  1482  1398 41648.6516   15  292 27103.9000 43534.3514  60.6%  2961  543s
  1524  1450 38553.6493   15  258 27103.9000 43534.3514  60.6%  2965  553s
  1608  1524 38571.3653   15  274 27103.9000 43534.3514  60.6%  2929  566s
  1698  1601 41145.8149   16  426 27103.9000 43534.3514  60.6%  2919  577s
  1802  1654 34231.4215   16  277 27103.9000 43534.3514  60.6%  2890  589s
  1898  1738 38324.7084   17  308 27103.9000 43534.3514  60.6%  2928  602s
  2015  1837 40422.5659   17  339 27103.9000 43534.3514  60.6%  2906  615s
  2138  1921 39335.6099   19  393 27103.9000 43534.3514  60.6%  2899  630s
  2249  1984 36467.9843   19  264 27103.9000 43534.3514  60.6%  2932  653s
  2362  2055 38165.1176   18  281 27103.9000 43534.3514  60.6%  2941  669s
  2481  2101 38730.3356   21  359 27103.9000 43382.1853  60.1%  2956  683s
  2555  2139 34144.4008   21  332 27103.9000 43378.1456  60.0%  2968  697s
  2656  2183 35235.2313   20  333 27103.9000 43378.1456  60.0%  2978  712s
  2740  2264 37834.4117   22  341 27103.9000 43378.1456  60.0%  3021  727s
  2848  2392 35785.1859   22  396 27103.9000 43378.1456  60.0%  3035  743s
  3002  2509 30174.9219   23  281 27103.9000 43328.8363  59.9%  3014  763s
  3175  2588 35315.7415   23  309 27103.9000 43328.8363  59.9%  2982  781s
  3353  2684 33849.6852   22  344 27103.9000 42652.6788  57.4%  2963  800s
  3493  2831 34582.8072   25  297 27103.9000 42629.0439  57.3%  3007  820s
  3716  2976 34140.2854   29  283 27103.9000 42629.0439  57.3%  2966  841s
  3939  2977 38161.6568   30  450 27103.9000 42525.4847  56.9%  2942  907s
  3941  2978 30927.0494   47   65 27103.9000 42525.4847  56.9%  2940  945s
  3942  2979 37735.9283   11  239 27103.9000 42525.4847  56.9%  2940  969s
  3943  2980 27294.5697   25  404 27103.9000 42525.4847  56.9%  2939  993s
  3944  2980 39870.0897   12  360 27103.9000 42525.4847  56.9%  2938 1004s
  3945  2981 30913.6994   37  389 27103.9000 42525.4847  56.9%  2938 1011s
  3946  2982 30475.4243   32  398 27103.9000 42525.4847  56.9%  2937 1017s
  3947  2982 33900.6241   33  442 27103.9000 42525.4847  56.9%  2936 1021s
  3949  2984 36746.3125   18  382 27103.9000 42525.4847  56.9%  2935 1028s
  3950  2984 33122.4930   51  425 27103.9000 42525.4847  56.9%  2934 1030s
  3952  2986 38726.8401   20  423 27103.9000 42525.4847  56.9%  2932 1035s
  3955  2988 39962.4395   10  432 27103.9000 42525.4847  56.9%  2930 1040s
  3958  2990 35545.1339   14  439 27103.9000 42525.4847  56.9%  2928 1046s
  3960  2991 28990.8323   53  453 27103.9000 42525.4847  56.9%  2926 1054s
  3961  2992 29874.6482   19  461 27103.9000 42525.4847  56.9%  2926 1056s
  3964  2994 32377.0048   27  456 27103.9000 42525.4847  56.9%  2923 1064s
  3965  2994 28917.2586   25  432 27103.9000 42525.4847  56.9%  2923 1066s
  3968  2996 33436.2783   40  470 27103.9000 42525.4847  56.9%  2920 1074s
  3969  2997 37298.6793   35  497 27103.9000 42525.4847  56.9%  2920 1076s
  3971  2998 37831.7702   34  499 27103.9000 42525.4847  56.9%  2918 1085s
  3973  3000 36138.9705   38  430 27103.9000 42525.4847  56.9%  2917 1095s
  3975  3001 39969.6281   15  504 27103.9000 42525.4847  56.9%  2915 1100s
  3976  3002 30447.1630   65  484 27103.9000 42525.4847  56.9%  2915 1105s
  3978  3003 28061.2012   57  450 27103.9000 42525.4847  56.9%  2913 1115s
  3981  3005 38383.5734   31  477 27103.9000 42525.4847  56.9%  2911 1125s
  3984  3007 38832.3292   22  471 27103.9000 42525.4847  56.9%  2909 1133s
  3985  3008 32118.1908   40  478 27103.9000 42525.4847  56.9%  2908 1136s
  3986  3008 41807.8159   21  509 27103.9000 42525.4847  56.9%  2907 1140s
  3989  3010 40491.4138    8  454 27103.9000 42525.4847  56.9%  2905 1147s
  3991  3012 34758.5536   28  423 27103.9000 42525.4847  56.9%  2904 1153s
  3992  3012 36527.0575   11  423 27103.9000 42525.4847  56.9%  2903 1192s
  3993  3013 39629.5633   13  423 27103.9000 42525.4847  56.9%  2902 1227s
  3994  3017 42525.4847   13  439 27103.9000 42525.4847  56.9%  2971 1235s
  3996  3020 42525.4847   14  434 27103.9000 42525.4847  56.9%  2971 1251s
  4000  3027 42525.4847   15  473 27103.9000 42525.4847  56.9%  2974 1275s
  4008  3040 42525.4847   16  477 27103.9000 42525.4847  56.9%  2994 1300s
  4024  3051 42275.3127   17  412 27103.9000 42525.4847  56.9%  3057 1344s
  4040  3077 40304.7998   18  386 27103.9000 42525.4847  56.9%  3106 1364s
  4072  3171 39343.9453   19  393 27103.9000 42525.4847  56.9%  3164 1387s
  4176  3207 38733.4115   20  342 27103.9000 42525.4847  56.9%  3271 1402s
  4247  3238 37279.6380   21  366 27103.9000 42525.4847  56.9%  3292 1416s
  4305  3270 37296.5825   22  353 27103.9000 42525.4847  56.9%  3318 1430s
  4366  3288 38834.9956   23  378 27103.9000 42525.4847  56.9%  3334 1444s
  4417  3302 36995.0065   22  356 27103.9000 42525.4847  56.9%  3356 1456s
H 4429  3146                    27802.804577 42525.4847  53.0%  3359 1456s
  4450  3187 35264.4800   22  330 27802.8046 42525.4847  53.0%  3380 1470s
  4519  3191 38555.8690   24  370 27802.8046 42525.4847  53.0%  3396 1482s
H 4521  3046                    27935.366930 42525.4847  52.2%  3398 1482s
H 4528  2907                    28015.978772 42525.4847  51.8%  3397 1482s
H 4531  2776                    28842.682380 42525.4847  47.4%  3396 1482s
  4559  2782 38122.5358   25  351 28842.6824 42525.4847  47.4%  3403 1498s
  4635  2765 37492.9636   26  338 28842.6824 42525.4847  47.4%  3395 1512s
H 4670  2630                    28876.481512 42525.4847  47.3%  3402 1512s
  4673  2649 36621.6577   27  379 28876.4815 42525.4847  47.3%  3404 1526s
  4743  2646 35346.0640   27  294 28876.4815 42525.4847  47.3%  3405 1545s
  4808  2638 35105.6598   28  285 28876.4815 42525.4847  47.3%  3411 1561s
  4851  2660 34229.9313   29  258 28876.4815 42525.4847  47.3%  3419 1576s
  4918  2650 35677.6150   28  417 28876.4815 42525.4847  47.3%  3431 1590s
  4968  2647 33884.3747   30  243 28876.4815 42525.4847  47.3%  3434 1603s
  5014  2653 33616.7706   31  217 28876.4815 42525.4847  47.3%  3445 1624s
  5103  2660 31038.4751   33  158 28876.4815 42525.4847  47.3%  3446 1640s
  5187  2668     cutoff   34      28876.4815 42525.4847  47.3%  3453 1658s
  5285  2657 29694.6445   35  129 28876.4815 42525.4847  47.3%  3453 1680s
  5365  2645 33644.6450   27  279 28876.4815 42525.4847  47.3%  3470 1694s
  5418  2651 32706.2202   28  372 28876.4815 42525.4847  47.3%  3486 1713s
  5481  2665     cutoff   28      28876.4815 42287.3026  46.4%  3493 1731s
  5554  2662 29882.4987   29  313 28876.4815 42286.6306  46.4%  3518 1751s
  5594  2674 32362.5261   30  291 28876.4815 42286.6306  46.4%  3534 1767s
  5646  2692 31315.7915   32  251 28876.4815 42286.6306  46.4%  3550 1785s
  5707  2720     cutoff   33      28876.4815 42286.6306  46.4%  3565 1804s
  5806  2743 29818.5940   36  266 28876.4815 42286.6306  46.4%  3575 1826s
  5912  2752 29453.7710   39  188 28876.4815 42286.6306  46.4%  3594 1851s
  6019  2779 32879.7349   21  355 28876.4815 42286.6306  46.4%  3618 1874s
  6133  2773 31024.0807   23  352 28876.4815 41461.8646  43.6%  3647 1901s
  6266  2758 30030.3264   25  338 28876.4815 41225.2964  42.8%  3652 1926s
  6397  2734     cutoff   27      28876.4815 41225.2964  42.8%  3670 1946s
  6439  2749     cutoff   26      28876.4815 41215.6363  42.7%  3691 1967s
  6483  2779 40679.5159   18  405 28876.4815 41215.6363  42.7%  3706 1996s
H 6517  2651                    28955.042860 41215.6363  42.3%  3709 1996s
  6549  2706 39973.1745   19  435 28955.0429 41215.6363  42.3%  3717 2031s
  6709  2724 39696.0126   20  391 28955.0429 40745.9868  40.7%  3734 2060s
  6870  2743 37965.8911   24  262 28955.0429 40745.9868  40.7%  3756 2090s
  7038  2763 33853.0107   27  233 28955.0429 40745.9868  40.7%  3775 2123s
  7220  2790     cutoff   30      28955.0429 40745.9868  40.7%  3779 2159s
  7401  2844 32379.5408   23  260 28955.0429 40745.9868  40.7%  3795 2193s
  7588  2877 29564.4091   27  237 28955.0429 40033.8019  38.3%  3812 2229s
  7780  2915 30985.8208   22  308 28955.0429 40012.2126  38.2%  3827 2269s
  7985  2911 infeasible   25      28955.0429 40012.2126  38.2%  3843 2307s
  8195  2916 33757.8949   23  273 28955.0429 39801.0646  37.5%  3871 2351s
  8413  2920 32523.7603   25  259 28955.0429 39801.0646  37.5%  3895 2391s
  8657  2892 30642.4735   30  171 28955.0429 39667.2796  37.0%  3913 2437s
  8983  2864 37509.0102   21  331 28955.0429 39575.6516  36.7%  3895 2480s
  9273  2785 37043.1377   23  327 28955.0429 39260.2186  35.6%  3904 2512s
  9318  2790 34954.6784   23  283 28955.0429 39260.2186  35.6%  3912 2542s
  9361  2806 34604.4088   24  354 28955.0429 39260.2186  35.6%  3915 2575s
  9427  2889 29894.5810   24  250 28955.0429 39260.2186  35.6%  3916 2623s
  9691  2923 30272.6732   26  226 28955.0429 39036.0962  34.8%  3906 2673s
 10057  2923 33167.5191   27  314 28955.0429 39003.2024  34.7%  3900 2720s
 10371  2913 infeasible   34      28955.0429 38937.1119  34.5%  3914 2776s
 10695  2948 35497.7624   26  296 28955.0429 38743.9543  33.8%  3938 2831s
 11003  3051 infeasible   35      28955.0429 38660.5304  33.5%  3970 2890s
 11364  3074 30299.9878   24  301 28955.0429 38575.2865  33.2%  3988 2934s
 11406  3103 29872.2103   25  320 28955.0429 38575.2865  33.2%  3993 2980s
 11565  3149     cutoff   26      28955.0429 38575.2865  33.2%  3994 3036s
 11758  3204 34164.8851   26  329 28955.0429 38575.2865  33.2%  4004 3095s
 12009  3276 33242.3641   27  413 28955.0429 38575.2865  33.2%  4014 3160s
 12280  3391 32118.3202   28  414 28955.0429 38200.7477  31.9%  4039 3230s
 12677  3530 30171.5207   29  346 28955.0429 38129.0216  31.7%  4060 3304s
 13096  3660 35673.2978   27  276 28955.0429 37965.5881  31.1%  4096 3389s
 13619  3807 35535.0074   25  349 28955.0429 37915.3677  30.9%  4102 3479s
 14134  3930 35111.9259   26  305 28955.0429 37704.3813  30.2%  4115 3568s
 14635  3988 33297.1445   24  301 28955.0429 37375.2592  29.1%  4136 3600s

Cutting planes:
  Projected implied bound: 3
  MIR: 1099
  Mixing: 2
  Flow cover: 2369
  RLT: 17
  Relax-and-lift: 203

Explored 14885 nodes (61733414 simplex iterations) in 3600.03 seconds (10401.82 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 28955 28876.5 28842.7 ... 26998.2

Time limit reached
Best objective 2.895504285980e+04, best bound 3.730690042978e+04, gap 28.8442%
  WARNING: Time limit reached. Using best solution found (gap: 28.84%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.03s
  Master Objective (UB) = 28955.04, θ = 190100.94
  Upper Bound (UB) = 28955.04

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 190100.94
  [DEBUG]   ✓ Scenario 0: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 190100.94 ≤ Q = 190100.94 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x2e1addfe
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd1e52202
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.195218e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.00s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5307813.6819
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.563489e+05, 244 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156348.88    0  123 5307813.68 -156348.88   103%     -    0s
H    0     0                    -126490.3493 -156348.88  23.6%     -    0s
H    0     0                    -126865.4829 -156348.88  23.2%     -    0s
     0     0 -136421.08    0   63 -126865.48 -136421.08  7.53%     -    0s
H    0     0                    -129099.4966 -136381.68  5.64%     -    0s
     0     0 -136362.19    0   46 -129099.50 -136362.19  5.63%     -    0s
     0     0 -135826.08    0   68 -129099.50 -135826.08  5.21%     -    0s
H    0     0                    -129490.1902 -135822.50  4.89%     -    0s
H    0     0                    -134869.9650 -135820.32  0.70%     -    0s
H    0     0                    -135108.3246 -135820.32  0.53%     -    0s
     0     0 -135820.32    0   68 -135108.32 -135820.32  0.53%     -    0s
H    0     0                    -135237.4728 -135820.32  0.43%     -    0s
     0     0 -135506.75    0   32 -135237.47 -135506.75  0.20%     -    0s
     0     0 -135468.95    0   23 -135237.47 -135468.95  0.17%     -    0s
     0     0 -135396.98    0   31 -135237.47 -135396.98  0.12%     -    0s
     0     0 -135360.73    0   25 -135237.47 -135360.73  0.09%     -    0s
     0     0 -135336.73    0   20 -135237.47 -135336.73  0.07%     -    0s
     0     0 -135323.80    0    8 -135237.47 -135323.80  0.06%     -    0s
     0     0 -135305.94    0    6 -135237.47 -135305.94  0.05%     -    0s
     0     0 -135296.76    0    6 -135237.47 -135296.76  0.04%     -    0s
     0     0 -135296.76    0   16 -135237.47 -135296.76  0.04%     -    0s
H    0     0                    -135272.1817 -135296.76  0.02%     -    0s
     0     0 -135276.24    0    2 -135272.18 -135276.24  0.00%     -    0s
*    0     0               0    -135275.0153 -135275.02  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 10
  Flow cover: 3
  Relax-and-lift: 4

Explored 1 nodes (706 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -135275 -135272 -135237 ... 5.30781e+06
No other solutions better than -135275

Optimal solution found (tolerance 1.00e-06)
Best objective -1.352750153414e+05, best bound -1.352750153414e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 179210.42
  Scenario: 18 demand increases, 42 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -135275.02
  [DEBUG]   S×d_nominal = 314485.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314485.44 + -135275.02 = 179210.42
  [DEBUG]   Current θ from Master = 190100.94
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10890.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18064.52
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 3868.1816, Absolute Gap = 3868.1816, Relative Gap = 0.133593
  Not converged yet (gap = 3868.18 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 18 increases, 42 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 480928 nonzeros
Model fingerprint: 0x95b0ff24
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 82214 rows and 33374 columns
Presolve time: 1.36s
Presolved: 87359 rows, 37526 columns, 534487 nonzeros
Variable types: 35267 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -316572.6945
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.17s

Barrier statistics:
 Dense cols : 554
 AA' NZ     : 3.347e+06
 Factor NZ  : 7.393e+06 (roughly 100 MB of memory)
 Factor Ops : 1.273e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.63918545e+07  1.62859249e+08  1.13e+05 2.20e+01  7.87e+04     2s
   1  -1.25094571e+07  1.49411292e+08  7.97e+04 9.15e+01  5.50e+04     3s
   2  -3.70387689e+06  1.13695959e+08  2.37e+04 7.81e-01  1.78e+04     3s
   3  -8.11581782e+05  8.28529277e+07  2.32e+03 8.36e-01  2.14e+03     3s
   4  -4.82150727e+05  5.76953681e+07  4.87e+02 4.71e-01  6.80e+02     3s
   5  -3.90066919e+05  2.92389884e+07  1.66e+02 2.05e-01  2.79e+02     3s
   6  -3.17755002e+05  2.30047537e+07  4.46e+01 1.55e-01  1.69e+02     3s
   7  -2.50791646e+05  1.58017591e+07  1.55e+01 1.02e-01  1.07e+02     3s
   8  -1.54762721e+05  1.08617781e+07  1.41e+00 6.89e-02  6.91e+01     3s
   9  -1.18493556e+05  4.63193692e+06  9.28e-01 2.94e-02  2.97e+01     3s
  10  -7.55118114e+04  2.73800247e+06  4.21e-01 1.69e-02  1.76e+01     3s
  11  -4.21636816e+04  1.23922513e+06  1.24e-01 7.12e-03  7.99e+00     3s
  12  -2.04283073e+04  3.90241547e+05  6.27e-02 2.15e-03  2.56e+00     3s
  13  -6.48432056e+03  2.52675029e+05  4.38e-02 1.38e-03  1.62e+00     3s
  14   6.99749638e+03  1.85854774e+05  2.89e-02 1.44e-03  1.11e+00     3s
  15   1.19850682e+04  1.50700434e+05  2.46e-02 1.07e-03  8.64e-01     3s
  16   1.46487059e+04  1.47736104e+05  2.26e-02 1.02e-03  8.29e-01     3s
  17   2.72172245e+04  1.09320450e+05  1.39e-02 5.94e-04  5.12e-01     3s
  18   3.17952684e+04  8.88123763e+04  1.17e-02 3.71e-04  3.55e-01     3s
  19   3.71406493e+04  8.08875155e+04  9.03e-03 2.78e-04  2.73e-01     4s
  20   4.20457220e+04  7.49836727e+04  6.65e-03 2.08e-04  2.05e-01     4s
  21   4.28513645e+04  6.84555450e+04  6.26e-03 1.38e-04  1.60e-01     4s
  22   4.62935315e+04  6.56127589e+04  4.69e-03 9.97e-05  1.20e-01     4s
  23   4.91654078e+04  6.27793180e+04  3.38e-03 1.00e-04  8.48e-02     4s
  24   5.15479544e+04  6.10213712e+04  2.27e-03 6.85e-05  5.90e-02     4s
  25   5.22670168e+04  5.97005604e+04  1.98e-03 4.62e-05  4.63e-02     4s
  26   5.28968858e+04  5.88478966e+04  1.71e-03 3.11e-05  3.71e-02     4s
  27   5.45299870e+04  5.82395269e+04  1.04e-03 1.92e-05  2.31e-02     4s
  28   5.57323836e+04  5.79422310e+04  5.53e-04 1.35e-05  1.38e-02     4s
  29   5.63500226e+04  5.76372194e+04  3.08e-04 8.01e-06  8.02e-03     4s
  30   5.64708335e+04  5.75206500e+04  2.60e-04 5.85e-06  6.54e-03     4s
  31   5.65760426e+04  5.74176088e+04  2.21e-04 3.92e-06  5.24e-03     4s
  32   5.67001313e+04  5.73953667e+04  1.75e-04 3.50e-06  4.33e-03     4s
  33   5.68895701e+04  5.73198357e+04  1.06e-04 2.12e-06  2.68e-03     4s
  34   5.70686071e+04  5.72924411e+04  4.32e-05 1.60e-06  1.39e-03     5s
  35   5.71097563e+04  5.72373603e+04  2.92e-05 6.29e-07  7.95e-04     5s
  36   5.71282327e+04  5.72358746e+04  2.29e-05 6.05e-07  6.71e-04     5s
  37   5.71466208e+04  5.72289374e+04  1.70e-05 4.87e-07  5.13e-04     5s
  38   5.71757520e+04  5.72162659e+04  7.20e-06 2.77e-07  2.52e-04     5s
  39   5.71857046e+04  5.72086590e+04  4.06e-06 1.55e-07  1.43e-04     5s
  40   5.71882706e+04  5.72046482e+04  3.26e-06 8.86e-08  1.02e-04     5s
  41   5.71959716e+04  5.72002434e+04  8.42e-07 9.78e-09  2.66e-05     5s
  42   5.71978742e+04  5.71997708e+04  3.38e-07 5.06e-09  1.18e-05     5s
  43   5.71988764e+04  5.71995143e+04  9.07e-08 2.20e-09  3.97e-06     5s
  44   5.71992804e+04  5.71992843e+04  6.82e-09 7.37e-11  2.42e-08     5s
  45   5.71992828e+04  5.71992839e+04  7.03e-08 1.43e-10  6.47e-09     5s
  46   5.71992831e+04  5.71992839e+04  5.31e-07 1.40e-08  4.88e-09     5s
  47   5.71992832e+04  5.71992839e+04  3.41e-06 1.28e-08  3.98e-09     5s
  48   5.71992837e+04  5.71992839e+04  8.96e-07 1.61e-08  1.05e-09     5s

Barrier solved model in 48 iterations and 5.43 seconds (8.18 work units)
Optimal objective 5.71992837e+04


Root crossover log...

   79238 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    5400 PPushes remaining with PInf 1.3343763e-04                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.5197630e+03      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48161    5.7199284e+04   0.000000e+00   1.519763e+03      9s
   48670    5.7199284e+04   0.000000e+00   0.000000e+00      9s
   48670    5.7199284e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 1.43s (can be avoided by choosing Method=3)

Solved with barrier

Root relaxation: objective 5.719928e+04, 48670 iterations, 9.17 seconds (17.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57199.2839    0  153 -171254.74 57199.2839   133%     -   11s
H    0     0                    -168416.6642 57199.2839   134%     -   11s
H    0     0                    -65305.55335 57199.2839   188%     -   12s
H    0     0                    -65278.87699 57199.2839   188%     -   12s
H    0     0                    -7811.793038 57199.2839   832%     -   12s
H    0     0                    -7789.925156 57199.2839   834%     -   12s
H    0     0                    10598.232902 57199.2839   440%     -   12s
H    0     0                    11784.549153 57199.2839   385%     -   12s
H    0     0                    14242.894279 52578.3663   269%     -   50s
H    0     0                    14276.608089 52578.3663   268%     -   50s
     0     0 52578.1747    0  126 14276.6081 52578.1747   268%     -   50s
H    0     0                    14278.302205 52578.1747   268%     -   51s
     0     0 51686.1346    0  130 14278.3022 51686.1346   262%     -   65s
     0     0 51686.1346    0  127 14278.3022 51686.1346   262%     -   78s
     0     0 51686.1346    0  128 14278.3022 51686.1346   262%     -   80s
     0     0 51686.1346    0  132 14278.3022 51686.1346   262%     -   81s
     0     0 48523.8708    0  339 14278.3022 48523.8708   240%     -  128s
H    0     0                    15524.713985 48523.3772   213%     -  128s
H    0     0                    15595.549521 48523.3772   211%     -  128s
H    0     0                    15694.994682 48523.3772   209%     -  128s
     0     0 48076.3929    0  343 15694.9947 48076.3929   206%     -  143s
     0     0 47963.3684    0  346 15694.9947 47963.3684   206%     -  152s
     0     0 47901.2550    0  348 15694.9947 47901.2550   205%     -  158s
     0     0 47882.2148    0  343 15694.9947 47882.2148   205%     -  161s
     0     0 47878.3791    0  341 15694.9947 47878.3791   205%     -  163s
     0     0 47876.9900    0  344 15694.9947 47876.9900   205%     -  164s
     0     0 47870.6582    0  345 15694.9947 47870.6582   205%     -  165s
     0     0 47870.2983    0  344 15694.9947 47870.2983   205%     -  166s
H    0     0                    18918.866611 46380.0742   145%     -  207s
H    0     0                    19125.163369 46380.0742   143%     -  207s
H    0     0                    19685.379533 46380.0742   136%     -  207s
     0     0 46380.0742    0  344 19685.3795 46380.0742   136%     -  207s
H    0     0                    19748.305619 46380.0450   135%     -  207s
H    0     0                    19915.047999 46380.0450   133%     -  207s
     0     0 46028.4485    0  341 19915.0480 46028.4485   131%     -  221s
     0     0 45901.1927    0  339 19915.0480 45901.1927   130%     -  233s
H    0     0                    20506.558121 45754.8272   123%     -  246s
H    0     0                    20689.886367 45754.8272   121%     -  246s
H    0     0                    21057.188456 45754.8272   117%     -  246s
H    0     0                    21075.593872 45754.8272   117%     -  246s
     0     0 45754.8272    0  344 21075.5939 45754.8272   117%     -  246s
     0     0 45666.4017    0  351 21075.5939 45666.4017   117%     -  255s
     0     0 45638.9828    0  354 21075.5939 45638.9828   117%     -  258s
     0     0 45614.2113    0  350 21075.5939 45614.2113   116%     -  260s
     0     0 45606.4479    0  349 21075.5939 45606.4479   116%     -  262s
     0     0 45586.5126    0  359 21075.5939 45586.5126   116%     -  265s
     0     0 45576.2435    0  353 21075.5939 45576.2435   116%     -  267s
     0     0 45572.9749    0  353 21075.5939 45572.9749   116%     -  268s
     0     0 45556.8942    0  358 21075.5939 45556.8942   116%     -  271s
     0     0 45555.6269    0  355 21075.5939 45555.6269   116%     -  271s
     0     0 45504.5603    0  346 21075.5939 45504.5603   116%     -  275s
     0     0 45475.1271    0  351 21075.5939 45475.1271   116%     -  278s
     0     0 45422.5659    0  351 21075.5939 45422.5659   116%     -  283s
     0     0 45413.4963    0  349 21075.5939 45413.4963   115%     -  285s
     0     0 45404.5912    0  350 21075.5939 45404.5912   115%     -  287s
     0     0 45396.8003    0  350 21075.5939 45396.8003   115%     -  289s
     0     0 45393.9613    0  353 21075.5939 45393.9613   115%     -  290s
     0     0 45391.8222    0  353 21075.5939 45391.8222   115%     -  291s
     0     0 45387.2380    0  356 21075.5939 45387.2380   115%     -  292s
     0     0 45386.8332    0  356 21075.5939 45386.8332   115%     -  292s
     0     0 44890.7482    0  363 21075.5939 44890.7482   113%     -  312s
     0     0 44747.4523    0  376 21075.5939 44747.4523   112%     -  321s
     0     0 44630.5988    0  391 21075.5939 44630.5988   112%     -  330s
     0     0 44606.2597    0  386 21075.5939 44606.2597   112%     -  334s
     0     0 44599.7732    0  400 21075.5939 44599.7732   112%     -  337s
     0     0 44596.5590    0  399 21075.5939 44596.5590   112%     -  338s
     0     0 44592.6673    0  398 21075.5939 44592.6673   112%     -  340s
     0     0 44588.7501    0  392 21075.5939 44588.7501   112%     -  342s
     0     0 44587.6863    0  391 21075.5939 44587.6863   112%     -  342s
     0     0 44455.1121    0  390 21075.5939 44455.1121   111%     -  354s
H    0     0                    21608.059240 44454.8403   106%     -  354s
     0     0 44418.9266    0  497 21608.0592 44418.9266   106%     -  360s
     0     0 44396.3975    0  398 21608.0592 44396.3975   105%     -  365s
     0     0 44379.9343    0  501 21608.0592 44379.9343   105%     -  369s
     0     0 44375.2080    0  496 21608.0592 44375.2080   105%     -  372s
     0     0 44372.2614    0  397 21608.0592 44372.2614   105%     -  373s
     0     0 44371.6143    0  389 21608.0592 44371.6143   105%     -  374s
     0     0 44285.6365    0  553 21608.0592 44285.6365   105%     -  381s
H    0     0                    22583.123604 44285.5071  96.1%     -  385s
     0     0 44263.2226    0  550 22583.1236 44263.2226  96.0%     -  388s
     0     0 44257.5031    0  550 22583.1236 44257.5031  96.0%     -  390s
     0     0 44254.2339    0  543 22583.1236 44254.2339  96.0%     -  391s
     0     0 44252.1267    0  540 22583.1236 44252.1267  96.0%     -  392s
     0     0 44250.2908    0  541 22583.1236 44250.2908  95.9%     -  393s
     0     0 44249.7365    0  543 22583.1236 44249.7365  95.9%     -  394s
     0     0 44225.4337    0  386 22583.1236 44225.4337  95.8%     -  398s
     0     0 44220.7528    0  401 22583.1236 44220.7528  95.8%     -  399s
     0     0 44219.3727    0  400 22583.1236 44219.3727  95.8%     -  400s
     0     0 44212.5190    0  423 22583.1236 44212.5190  95.8%     -  403s
H    0     0                    22727.964736 44212.3391  94.5%     -  404s
     0     0 44211.8165    0  423 22727.9647 44211.8165  94.5%     -  405s
     0     0 44209.4913    0  416 22727.9647 44209.4913  94.5%     -  407s
H    0     0                    22952.825989 44209.3923  92.6%     -  407s
H    0     0                    24493.534040 44209.3923  80.5%     -  407s
H    0     0                    24501.940278 44209.3923  80.4%     -  407s
     0     0 44209.3376    0  419 24501.9403 44209.3376  80.4%     -  408s
     0     0 44208.4586    0  417 24501.9403 44208.4586  80.4%     -  409s
     0     0 44208.2944    0  417 24501.9403 44208.2944  80.4%     -  410s
H    0     0                    24589.810444 44208.2383  79.8%     -  480s
H    0     0                    24643.711873 44208.2383  79.4%     -  486s
     0     2 44208.2383    0  417 24643.7119 44208.2383  79.4%     -  490s
     1     3 43271.8170    1  436 24643.7119 44208.2383  79.4% 14912  502s
     2     6 42813.7007    2  339 24643.7119 44208.2383  79.4% 11905  509s
     5    12 42649.9523    3  342 24643.7119 43979.7626  78.5%  7905  518s
    11    24 42503.2768    4  357 24643.7119 43794.0591  77.7%  8164  534s
    23    36 43465.8590    4  404 24643.7119 43751.6549  77.5% 11041  562s
    35    68 43114.3240    5  380 24643.7119 43751.6549  77.5% 11685  614s
H   45    68                    24667.246454 43751.6549  77.4% 10734  614s
H   52    68                    24684.724277 43751.6549  77.2% 10028  614s
    67   196 43079.0576    6  369 24684.7243 43662.9196  76.9% 13450  639s
   195   247 42559.7880    8  352 24684.7243 43662.9196  76.9%  7735  654s
H  196   247                    26019.210130 43662.9196  67.8%  7695  654s
H  206   247                    26032.673174 43662.9196  67.7%  7562  654s
H  207   247                    27258.030806 43662.9196  60.2%  7546  654s
   246   295 42355.3362    9  342 27258.0308 43662.9196  60.2%  7074  667s
   294   355 42875.9749    8  390 27258.0308 43662.9196  60.2%  7038  681s
H  295   355                    27459.323676 43662.9196  59.0%  7014  681s
   354   410 41894.8888   10  322 27459.3237 43662.9196  59.0%  6787  698s
   409   456 42308.9193   10  348 27459.3237 43662.9196  59.0%  6878  713s
   455   509 41110.2117   11  324 27459.3237 43662.9196  59.0%  6731  734s
   508   564 40831.4285   12  351 27459.3237 43662.9196  59.0%  6719  748s
   563   616 41028.5081   12  353 27459.3237 43662.9196  59.0%  6705  795s
   615   674 40673.5052   13  350 27459.3237 43662.9196  59.0%  6691  807s
H  661   674                    27550.198945 43662.9196  58.5%  6624  807s
   673   728 40529.7620   14  353 27550.1989 43662.9196  58.5%  6691  822s
   727   787 40340.2273   16  345 27550.1989 43662.9196  58.5%  6770  834s
H  758   787                    27648.791388 43662.9196  57.9%  6738  834s
   786   818 40023.7831   18  306 27648.7914 43662.9196  57.9%  6759  846s
   817   851 39985.8929   19  338 27648.7914 43662.9196  57.9%  6771  857s
H  818   851                    27685.471143 43662.9196  57.7%  6763  857s
H  824   851                    27779.752890 43662.9196  57.2%  6758  857s
   850   924 36648.4120   20  245 27779.7529 43662.9196  57.2%  6804  878s
   923   999 36524.1033   21  234 27779.7529 43662.9196  57.2%  6628  892s
  1004  1029 35408.6714   21  222 27779.7529 43662.9196  57.2%  6471  905s
  1047  1084 35247.7264   22  224 27779.7529 43662.9196  57.2%  6416  920s
  1106  1151 36035.1812   24  228 27779.7529 43662.9196  57.2%  6420  936s
  1179  1218 35788.2955   24  233 27779.7529 43662.9196  57.2%  6352  950s
  1256  1277 33802.2966   25  191 27779.7529 43662.9196  57.2%  6261  964s
  1337  1331 32506.0489   26  186 27779.7529 43662.9196  57.2%  6224  982s
  1393  1391 33941.1221   27  206 27779.7529 43662.9196  57.2%  6273  998s
  1469  1451 31651.5735   29  169 27779.7529 43662.9196  57.2%  6286 1016s
  1556  1499 32038.1100   30  183 27779.7529 43662.9196  57.2%  6314 1034s
  1632  1527 38406.2017    8  344 27779.7529 43662.9196  57.2%  6394 1052s
  1666  1556 37766.1409    9  349 27779.7529 43662.9196  57.2%  6526 1070s
H 1696  1556                    27800.997634 43662.9196  57.1%  6604 1070s
  1699  1673 36383.4511   10  331 27800.9976 43662.9196  57.1%  6612 1089s
  1818  1702 36045.6477   12  328 27800.9976 43662.9196  57.1%  6570 1106s
H 1843  1702                    27883.802400 43662.9196  56.6%  6597 1106s
  1851  1807 35500.2493   13  314 27883.8024 43662.9196  56.6%  6612 1124s
  1984  1887 34791.5228   15  319 27883.8024 43662.9196  56.6%  6603 1196s
  2100  1914 28377.2860   16  287 27883.8024 43503.2253  56.0%  6611 1214s
H 2119  1914                    27885.039436 43410.3819  55.7%  6643 1214s
  2137  2033 27887.8987   17  262 27885.0394 43410.3819  55.7%  6679 1241s
  2286  2162 infeasible   42      27885.0394 43410.3819  55.7%  6682 1264s
  2453  2280 29762.8542   40  188 27885.0394 43377.3013  55.6%  6626 1290s
  2625  2364 42260.8458   10  350 27885.0394 43377.3013  55.6%  6580 1316s
  2745  2444 41262.6355   13  302 27885.0394 43377.3013  55.6%  6692 1344s
  2847  2564 39923.8820   15  224 27885.0394 43377.3013  55.6%  6853 1371s
  2979  2728 39583.4135   16  216 27885.0394 43377.3013  55.6%  6907 1400s
  3165  2855 37174.0005   18  188 27885.0394 43342.5649  55.4%  6852 1427s
  3325  2856 31989.7961   25  417 27885.0394 43342.5649  55.4%  6864 1578s
  3327  2857 39407.7945   23   65 27885.0394 43342.5649  55.4%  6860 1586s
  3328  2858 30857.5820   76  254 27885.0394 43342.5649  55.4%  6858 1632s
  3329  2859 37916.9343   26  415 27885.0394 43342.5649  55.4%  6856 1670s
  3330  2859 41227.1798   13  306 27885.0394 43342.5649  55.4%  6853 1700s
  3331  2860 30857.6433   76  383 27885.0394 43342.5649  55.4%  6851 1717s
  3332  2861 39895.1208   20  364 27885.0394 43342.5649  55.4%  6849 1736s
  3333  2861 39755.1819   22  349 27885.0394 43342.5649  55.4%  6847 1746s
  3334  2862 36404.5212   15  373 27885.0394 43342.5649  55.4%  6845 1750s
  3335  2863 27944.7989   63  397 27885.0394 43342.5649  55.4%  6843 1758s
  3336  2863 41153.6058   12  445 27885.0394 43342.5649  55.4%  6841 1768s
  3337  2864 28832.6263   57  388 27885.0394 43342.5649  55.4%  6839 1773s
  3338  2865 37647.4115   37  388 27885.0394 43342.5649  55.4%  6837 1778s
  3339  2865 32614.2968   16  417 27885.0394 43342.5649  55.4%  6835 1780s
  3340  2866 30614.1137   54  378 27885.0394 43342.5649  55.4%  6833 1785s
  3342  2867 39595.9886   24  397 27885.0394 43342.5649  55.4%  6829 1790s
  3345  2869 32505.5443   27  426 27885.0394 43342.5649  55.4%  6823 1795s
  3347  2871 41746.8145   17  387 27885.0394 43342.5649  55.4%  6819 1802s
  3348  2871 30761.5107   52  419 27885.0394 43342.5649  55.4%  6817 1805s
  3350  2873 31967.4694   68  469 27885.0394 43342.5649  55.4%  6813 1810s
  3351  2873 36227.7839   60  472 27885.0394 43342.5649  55.4%  6811 1820s
  3353  2875 37205.3441   41  391 27885.0394 43342.5649  55.4%  6806 1825s
  3356  2877 29127.7166   49  444 27885.0394 43342.5649  55.4%  6800 1835s
  3357  2877 33819.0693    9  423 27885.0394 43342.5649  55.4%  6798 1842s
  3359  2879 40140.0621   27  444 27885.0394 43342.5649  55.4%  6794 1845s
  3361  2880 34716.2922   49  395 27885.0394 43342.5649  55.4%  6790 1853s
  3362  2881 33269.4146   43  485 27885.0394 43342.5649  55.4%  6788 1859s
  3363  2881 30148.3118   63  411 27885.0394 43342.5649  55.4%  6786 1860s
  3365  2883 41825.4595   11  406 27885.0394 43342.5649  55.4%  6782 1869s
  3366  2883 41599.1421   18  409 27885.0394 43342.5649  55.4%  6780 1871s
  3368  2885 30795.5459   49  485 27885.0394 43342.5649  55.4%  6776 1877s
  3369  2885 40975.8523   25  410 27885.0394 43342.5649  55.4%  6774 1884s
  3370  2886 36441.7102   12  411 27885.0394 43342.5649  55.4%  6772 1887s
  3372  2887 39680.7340   22  423 27885.0394 43342.5649  55.4%  6768 1895s
  3374  2889 35416.9909   21  413 27885.0394 43342.5649  55.4%  6764 1901s
  3376  2890 38860.7728   11  411 27885.0394 43342.5649  55.4%  6760 1908s
  3377  2891 41975.6097   14  494 27885.0394 43342.5649  55.4%  6758 1914s
  3378  2891 33586.0222   46  535 27885.0394 43342.5649  55.4%  6756 1918s
  3379  2892 35539.0293   31  502 27885.0394 43342.5649  55.4%  6754 1921s
  3380  2893 41381.1603   16  488 27885.0394 43342.5649  55.4%  6752 1931s
  3381  2893 40210.5671   18  428 27885.0394 43342.5649  55.4%  6750 1935s
  3383  2895 29513.8188   74  412 27885.0394 43342.5649  55.4%  6746 1940s
  3384  2895 31501.7808   33  424 27885.0394 43342.5649  55.4%  6744 1946s
  3386  2897 33898.1640   28  428 27885.0394 43342.5649  55.4%  6740 1950s
  3387  2897 38750.4965    8  423 27885.0394 43342.5649  55.4%  6738 1955s
  3389  2899 42663.4901   12  424 27885.0394 43342.5649  55.4%  6734 1960s
  3391  2900 40794.1214   21  419 27885.0394 43342.5649  55.4%  6730 1968s
  3392  2901 40120.1491   19  426 27885.0394 43342.5649  55.4%  6728 1970s
  3393  2901 34468.9899   39  424 27885.0394 43342.5649  55.4%  6726 1976s
  3396  2903 35391.5015   15  418 27885.0394 43342.5649  55.4%  6720 1982s
H 3396  2756                    27982.877480 43342.5649  54.9%  6720 1988s
  3397  2757 28431.3230   58  421 27982.8775 43342.5649  54.9%  6718 1991s
  3399  2758 42972.7047   10  487 27982.8775 43342.5649  54.9%  6714 1998s
  3400  2759 31127.0916   57  421 27982.8775 43342.5649  54.9%  6712 2003s
  3401  2760 31079.1159   36  421 27982.8775 43342.5649  54.9%  6710 2020s
  3402  2760 36972.6331   34  421 27982.8775 43342.5649  54.9%  6708 2091s
  3403  2763 43249.2003   13  395 27982.8775 43342.5649  54.9%  6834 2120s
  3404  2764 43342.5649   13  410 27982.8775 43342.5649  54.9%  6832 2131s
  3405  2767 43154.2127   14  411 27982.8775 43342.5649  54.9%  6834 2165s
  3409  2774 41661.9050   15  394 27982.8775 43267.3337  54.6%  6839 2208s
  3417  2787 41488.8788   16  391 27982.8775 42968.0072  53.6%  6857 2253s
  3433  2798 41760.9819   17  452 27982.8775 42793.3785  52.9%  6920 2333s
  3449  2825 40088.1449   18  452 27982.8775 42793.3785  52.9%  7024 2391s
  3481  2938 39845.4867   19  394 27982.8775 42793.3785  52.9%  7100 2436s
  3605  2927 39121.6147   24  368 27982.8775 42793.3785  52.9%  7132 2456s
  3635  2951 38756.1179   25  362 27982.8775 42793.3785  52.9%  7127 2478s
  3669  2972 38684.4583   26  347 27982.8775 42793.3785  52.9%  7104 2499s
  3702  2997 38256.6207   27  442 27982.8775 42793.3785  52.9%  7110 2523s
  3738  3026 37483.5609   28  310 27982.8775 42793.3785  52.9%  7135 2546s
  3780  3052 35860.8459   29  268 27982.8775 42793.3785  52.9%  7139 2572s
  3834  3090 34790.0943   30  196 27982.8775 42793.3785  52.9%  7117 2595s
  3904  3124 34335.2549   31  172 27982.8775 42793.3785  52.9%  7068 2617s
  3981  3145 34136.0553   32  175 27982.8775 42793.3785  52.9%  6998 2637s
  4065  3153 32455.3356   35  141 27982.8775 42793.3785  52.9%  6921 2660s
  4128  3172 31418.9899   36  142 27982.8775 42793.3785  52.9%  6875 2682s
  4195  3178 31328.9289   38  129 27982.8775 42793.3785  52.9%  6825 2705s
  4269  3187 30538.9648   42  167 27982.8775 42793.3785  52.9%  6759 2726s
  4345  3190 29708.4102   45  155 27982.8775 42793.3785  52.9%  6716 2749s
  4425  3169     cutoff   50      27982.8775 42793.3785  52.9%  6656 2772s
  4504  3160 28940.0365   49  154 27982.8775 42793.3785  52.9%  6607 2801s
  4590  3147 infeasible   52      27982.8775 42793.3785  52.9%  6558 2825s
  4668  3135 34833.4115   27  319 27982.8775 42793.3785  52.9%  6508 2854s
  4727  3139 32744.7973   29  204 27982.8775 42793.3785  52.9%  6498 2879s
  4789  3147 30954.3310   31  166 27982.8775 42793.3785  52.9%  6491 2915s
  4863  3148 infeasible   34      27982.8775 42336.7064  51.3%  6481 2947s
  4922  3147 39701.2628   18  380 27982.8775 42336.6836  51.3%  6490 2981s
  4981  3177 39607.1044   19  372 27982.8775 42336.6836  51.3%  6499 3012s
  5050  3200 33554.4263   21  339 27982.8775 42336.6836  51.3%  6509 3048s
  5127  3242 32515.4289   22  318 27982.8775 42336.6836  51.3%  6511 3081s
  5227  3251     cutoff   25      27982.8775 42336.6836  51.3%  6493 3117s
  5331  3269 infeasible   26      27982.8775 42336.6836  51.3%  6472 3154s
  5445  3292 29124.6254   28  257 27982.8775 42336.6836  51.3%  6441 3192s
  5548  3318     cutoff   31      27982.8775 42336.6836  51.3%  6431 3227s
  5651  3346 30053.8746   26  282 27982.8775 41847.5673  49.5%  6427 3259s
  5730  3377 29580.5894   27  279 27982.8775 41847.5485  49.5%  6407 3307s
  5842  3405 28710.3822   30  307 27982.8775 41847.5485  49.5%  6388 3371s
  5988  3429     cutoff   31      27982.8775 41847.5485  49.5%  6355 3432s
  6139  3501 31126.8555   32  359 27982.8775 41822.1269  49.5%  6293 3494s
  6334  3531 28565.4578   35  153 27982.8775 41822.1269  49.5%  6218 3556s
  6538  3565 29805.5774   40  117 27982.8775 40182.5375  43.6%  6157 3600s

Cutting planes:
  Implied bound: 18
  Projected implied bound: 135
  MIR: 1016
  Mixing: 4
  Flow cover: 2261
  RLT: 56
  Relax-and-lift: 196

Explored 6744 nodes (41547748 simplex iterations) in 3600.05 seconds (8975.70 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27982.9 27885 27883.8 ... 27258

Time limit reached
Best objective 2.798287748038e+04, best bound 3.998267669826e+04, gap 42.8826%
  WARNING: Time limit reached. Using best solution found (gap: 42.88%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.06s
  Master Objective (UB) = 27982.88, θ = 187678.65
  Upper Bound (UB) = 27982.88

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 187678.65
  [DEBUG]   ✓ Scenario 0: θ = 187678.65 ≤ Q = 187678.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 187678.65 ≤ Q = 187678.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 187678.65 ≤ Q = 187678.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 187678.65 ≤ Q = 187678.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 187678.65 ≤ Q = 187678.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 187678.65 ≤ Q = 187678.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 187678.65 ≤ Q = 187678.65 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 187678.65 ≤ Q = 187678.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 187678.65 ≤ Q = 187678.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 187678.65 ≤ Q = 187678.65 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 187678.65 ≤ Q = 187678.65 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1c8c4336
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe373bcca
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.245953e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.00s
Presolved: 470 rows, 475 columns, 1325 nonzeros
Found heuristic solution: objective 5692704.1749
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.571120e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -157112.00    0  127 5692704.17 -157112.00   103%     -    0s
H    0     0                    -122633.2531 -157112.00  28.1%     -    0s
H    0     0                    -123315.9782 -157112.00  27.4%     -    0s
     0     0 -135551.28    0   43 -123315.98 -135551.28  9.92%     -    0s
H    0     0                    -129851.9137 -135533.01  4.38%     -    0s
H    0     0                    -131544.1698 -135533.01  3.03%     -    0s
H    0     0                    -131976.2306 -134022.13  1.55%     -    0s
     0     0 -134022.13    0   35 -131976.23 -134022.13  1.55%     -    0s
     0     0 -133890.98    0   40 -131976.23 -133890.98  1.45%     -    0s
     0     0 -133795.93    0   34 -131976.23 -133795.93  1.38%     -    0s
H    0     0                    -132344.9374 -133791.85  1.09%     -    0s
H    0     0                    -133488.3052 -133791.85  0.23%     -    0s
H    0     0                    -133499.8149 -133766.60  0.20%     -    0s
     0     0 -133766.60    0   40 -133499.81 -133766.60  0.20%     -    0s
     0     0 -133766.60    0   40 -133499.81 -133766.60  0.20%     -    0s
     0     0 -133757.75    0   33 -133499.81 -133757.75  0.19%     -    0s
     0     0 -133608.86    0   21 -133499.81 -133608.86  0.08%     -    0s
     0     0 -133581.94    0    7 -133499.81 -133581.94  0.06%     -    0s
     0     0 -133570.38    0    6 -133499.81 -133570.38  0.05%     -    0s
     0     0 -133569.04    0    6 -133499.81 -133569.04  0.05%     -    0s
H    0     0                    -133510.9489 -133569.04  0.04%     -    0s
H    0     0                    -133525.9918 -133569.04  0.03%     -    0s
     0     0 -133540.58    0    7 -133525.99 -133540.58  0.01%     -    0s
     0     0     cutoff    0      -133525.99 -133525.99  0.00%     -    0s

Cutting planes:
  Implied bound: 3
  MIR: 4
  Flow cover: 1
  RLT: 5
  Relax-and-lift: 1

Explored 1 nodes (565 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -133526 -133511 -133500 ... -122633
No other solutions better than -133526

Optimal solution found (tolerance 1.00e-06)
Best objective -1.335259917528e+05, best bound -1.335259917528e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 180718.82
  Scenario: 6 demand increases, 54 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133525.99
  [DEBUG]   S×d_nominal = 314244.81
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314244.81 + -133525.99 = 180718.82
  [DEBUG]   Current θ from Master = 187678.65
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6959.83 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21023.05
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 2896.0162, Absolute Gap = 2896.0162, Relative Gap = 0.103492
  Not converged yet (gap = 2896.02 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 6 increases, 54 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524147 nonzeros
Model fingerprint: 0x0138b184
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 89688 rows and 36408 columns
Presolve time: 1.52s
Presolved: 95175 rows, 40732 columns, 579143 nonzeros
Variable types: 38473 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -322809.5468
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 548
 AA' NZ     : 3.821e+06
 Factor NZ  : 8.556e+06 (roughly 120 MB of memory)
 Factor Ops : 1.542e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.68823857e+07  1.75217997e+08  1.16e+05 2.20e+01  8.05e+04     3s
   1  -1.29401333e+07  1.61514276e+08  8.21e+04 9.26e+01  5.63e+04     3s
   2  -4.05331017e+06  1.22325699e+08  2.57e+04 9.62e-01  1.90e+04     3s
   3  -8.09562001e+05  9.04032681e+07  2.12e+03 1.55e+00  1.99e+03     3s
   4  -5.02209912e+05  6.39353602e+07  5.19e+02 8.25e-01  7.05e+02     3s
   5  -4.12916846e+05  3.25453200e+07  2.08e+02 3.54e-01  3.06e+02     3s
   6  -3.60015638e+05  2.40244869e+07  9.03e+01 2.47e-01  1.86e+02     3s
   7  -3.03076633e+05  1.82678499e+07  4.47e+01 1.80e-01  1.27e+02     3s
   8  -1.95306789e+05  1.26615965e+07  1.04e+01 1.20e-01  7.74e+01     3s
   9  -1.49005019e+05  6.60542569e+06  5.99e+00 6.07e-02  4.00e+01     3s
  10  -9.40705282e+04  2.86106277e+06  2.95e+00 2.51e-02  1.72e+01     3s
  11  -5.79520639e+04  1.68629764e+06  1.32e+00 1.45e-02  1.01e+01     3s
  12  -1.97352890e+04  4.24477040e+05  4.27e-01 3.22e-03  2.55e+00     3s
  13  -7.64954696e+03  2.66343136e+05  2.99e-01 2.10e-03  1.57e+00     3s
  14   4.35548905e+03  1.89864614e+05  1.98e-01 1.46e-03  1.06e+00     3s
  15   1.26409167e+04  1.52811023e+05  1.54e-01 1.59e-03  8.04e-01     3s
  16   2.02141798e+04  1.08222371e+05  1.26e-01 1.81e-03  5.05e-01     3s
  17   2.56800266e+04  8.96145806e+04  1.06e-01 2.46e-03  3.67e-01     4s
  18   3.21944428e+04  7.78586235e+04  8.33e-02 3.55e-03  2.62e-01     4s
  19   3.92289182e+04  7.33279514e+04  5.80e-02 3.25e-03  1.96e-01     4s
  20   4.21190267e+04  6.60256088e+04  4.78e-02 1.97e-03  1.37e-01     4s
  21   4.69858837e+04  6.36515283e+04  3.15e-02 1.35e-03  9.57e-02     4s
  22   4.99321506e+04  6.09565595e+04  2.19e-02 9.77e-04  6.33e-02     4s
  23   5.14584864e+04  5.98423121e+04  1.70e-02 6.87e-04  4.81e-02     4s
  24   5.32637045e+04  5.85781851e+04  1.12e-02 4.57e-04  3.05e-02     4s
  25   5.43663658e+04  5.81532075e+04  8.03e-03 2.89e-04  2.17e-02     4s
  26   5.47650495e+04  5.80413785e+04  6.86e-03 2.55e-04  1.88e-02     4s
  27   5.52529188e+04  5.79094704e+04  5.40e-03 2.15e-04  1.53e-02     4s
  28   5.59855309e+04  5.75701059e+04  3.23e-03 1.82e-04  9.10e-03     4s
  29   5.63173507e+04  5.74902960e+04  2.29e-03 1.45e-04  6.73e-03     4s
  30   5.65854708e+04  5.73301479e+04  1.53e-03 1.02e-04  4.28e-03     4s
  31   5.67395862e+04  5.72611935e+04  1.10e-03 6.63e-05  3.00e-03     4s
  32   5.68042585e+04  5.72224192e+04  9.26e-04 4.59e-05  2.40e-03     4s
  33   5.69792177e+04  5.72081144e+04  4.44e-04 3.61e-05  1.31e-03     4s
  34   5.71042591e+04  5.71603642e+04  1.13e-04 8.48e-06  3.22e-04     5s
  35   5.71385942e+04  5.71528478e+04  2.95e-05 1.58e-06  8.19e-05     5s
  36   5.71501001e+04  5.71515036e+04  2.61e-06 4.17e-07  8.06e-06     5s
  37   5.71514095e+04  5.71514101e+04  1.24e-09 8.23e-09  3.04e-09     5s

Barrier solved model in 37 iterations and 4.71 seconds (7.14 work units)
Optimal objective 5.71514095e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 8s

   13663 PPushes remaining with PInf 1.4621131e-04                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2883451e+04      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60061    5.7151410e+04   0.000000e+00   3.288345e+04      9s
   60634    5.7151410e+04   0.000000e+00   0.000000e+00      9s
   60634    5.7151410e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.715141e+04, 60634 iterations, 7.01 seconds (12.10 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57151.4100    0   67 -171254.74 57151.4100   133%     -    9s
H    0     0                    -167244.6223 57151.4100   134%     -    9s
H    0     0                    -164317.8043 57151.4100   135%     -    9s
H    0     0                    -152826.1689 57151.4100   137%     -    9s
H    0     0                    -149517.6894 57151.4100   138%     -    9s
H    0     0                    -148727.3737 57151.4100   138%     -    9s
H    0     0                    -60059.72652 57151.4100   195%     -    9s
H    0     0                    -12788.32285 57151.4100   547%     -   10s
H    0     0                    10608.079715 57151.4100   439%     -   10s
H    0     0                    10796.272981 57151.4100   429%     -   10s
H    0     0                    11306.789684 57151.4100   405%     -   10s
H    0     0                    11746.542170 57151.4100   387%     -   11s
     0     0 54194.0002    0  185 11746.5422 54194.0002   361%     -   32s
H    0     0                    11803.415557 54194.0002   359%     -   33s
H    0     0                    11961.850378 54194.0002   353%     -   33s
H    0     0                    12070.313646 54194.0002   349%     -   33s
H    0     0                    12189.695778 54194.0002   345%     -   33s
     0     0 53683.1931    0  190 12189.6958 53683.1931   340%     -   47s
     0     0 53683.1931    0  186 12189.6958 53683.1931   340%     -   50s
     0     0 53683.1931    0  189 12189.6958 53683.1931   340%     -   50s
     0     0 53683.1931    0  189 12189.6958 53683.1931   340%     -   51s
H    0     0                    12201.975532 50306.5667   312%     -   89s
     0     0 50306.5667    0  304 12201.9755 50306.5667   312%     -   89s
H    0     0                    15263.720606 50306.5636   230%     -   90s
H    0     0                    17191.677258 50306.5636   193%     -   90s
H    0     0                    18535.247652 50306.5636   171%     -   90s
H    0     0                    19257.848177 50306.5636   161%     -   90s
H    0     0                    19670.190657 50306.5636   156%     -   90s
H    0     0                    19876.924546 50306.5636   153%     -   90s
H    0     0                    19908.088182 50306.5636   153%     -   90s
H    0     0                    19935.823010 50306.5636   152%     -   90s
     0     0 49564.5320    0  386 19935.8230 49564.5320   149%     -  120s
     0     0 49339.1022    0  346 19935.8230 49339.1022   147%     -  132s
     0     0 49273.9959    0  346 19935.8230 49273.9959   147%     -  143s
     0     0 49229.1921    0  398 19935.8230 49229.1921   147%     -  150s
     0     0 49198.9653    0  401 19935.8230 49198.9653   147%     -  154s
     0     0 49181.8167    0  362 19935.8230 49181.8167   147%     -  156s
     0     0 49178.5040    0  407 19935.8230 49178.5040   147%     -  158s
     0     0 49166.9733    0  403 19935.8230 49166.9733   147%     -  160s
     0     0 49166.3476    0  409 19935.8230 49166.3476   147%     -  161s
H    0     0                    20905.458719 46969.1768   125%     -  210s
H    0     0                    21043.955319 46969.1768   123%     -  210s
H    0     0                    21170.056898 46969.1768   122%     -  210s
     0     0 46969.1768    0  325 21170.0569 46969.1768   122%     -  210s
H    0     0                    23448.079571 46969.0638   100%     -  210s
H    0     0                    24195.176882 46969.0638  94.1%     -  210s
     0     0 46445.5690    0  295 24195.1769 46445.5690  92.0%     -  229s
     0     0 46234.3692    0  410 24195.1769 46234.3692  91.1%     -  250s
     0     0 46154.7253    0  320 24195.1769 46154.7253  90.8%     -  267s
     0     0 46131.9562    0  422 24195.1769 46131.9562  90.7%     -  278s
     0     0 46086.2752    0  419 24195.1769 46086.2752  90.5%     -  288s
     0     0 46062.9232    0  424 24195.1769 46062.9232  90.4%     -  294s
     0     0 46054.6249    0  427 24195.1769 46054.6249  90.3%     -  297s
     0     0 46049.1022    0  424 24195.1769 46049.1022  90.3%     -  301s
     0     0 46046.8485    0  426 24195.1769 46046.8485  90.3%     -  303s
     0     0 46044.8596    0  419 24195.1769 46044.8596  90.3%     -  305s
     0     0 45990.9038    0  483 24195.1769 45990.9038  90.1%     -  313s
     0     0 45976.8588    0  503 24195.1769 45976.8588  90.0%     -  318s
     0     0 45973.5421    0  519 24195.1769 45973.5421  90.0%     -  322s
     0     0 45969.0850    0  410 24195.1769 45969.0850  90.0%     -  324s
     0     0 45951.3456    0  400 24195.1769 45951.3456  89.9%     -  328s
     0     0 45944.8344    0  413 24195.1769 45944.8344  89.9%     -  331s
     0     0 45943.4906    0  410 24195.1769 45943.4906  89.9%     -  333s
     0     0 45941.3016    0  343 24195.1769 45941.3016  89.9%     -  334s
     0     0 45939.8999    0  434 24195.1769 45939.8999  89.9%     -  336s
     0     0 45929.1286    0  434 24195.1769 45929.1286  89.8%     -  343s
     0     0 45928.0011    0  434 24195.1769 45928.0011  89.8%     -  345s
H    0     0                    24473.408103 45102.6283  84.3%     -  389s
H    0     0                    24702.756098 45102.6283  82.6%     -  389s
     0     0 45102.6283    0  523 24702.7561 45102.6283  82.6%     -  389s
     0     0 44876.4301    0  460 24702.7561 44876.4301  81.7%     -  405s
     0     0 44802.3825    0  462 24702.7561 44802.3825  81.4%     -  414s
     0     0 44775.5433    0  473 24702.7561 44775.5433  81.3%     -  422s
     0     0 44756.9882    0  469 24702.7561 44756.9882  81.2%     -  428s
     0     0 44744.2735    0  476 24702.7561 44744.2735  81.1%     -  434s
     0     0 44735.9073    0  476 24702.7561 44735.9073  81.1%     -  440s
     0     0 44730.7170    0  478 24702.7561 44730.7170  81.1%     -  443s
     0     0 44726.8880    0  396 24702.7561 44726.8880  81.1%     -  445s
     0     0 44719.4493    0  468 24702.7561 44719.4493  81.0%     -  448s
     0     0 44717.0057    0  469 24702.7561 44717.0057  81.0%     -  450s
     0     0 44714.6217    0  467 24702.7561 44714.6217  81.0%     -  452s
     0     0 44714.2354    0  466 24702.7561 44714.2354  81.0%     -  453s
H    0     0                    25622.612588 44625.4535  74.2%     -  465s
     0     0 44625.4535    0  542 25622.6126 44625.4535  74.2%     -  465s
     0     0 44570.4527    0  397 25622.6126 44570.4527  73.9%     -  475s
     0     0 44542.8261    0  545 25622.6126 44542.8261  73.8%     -  481s
     0     0 44518.1998    0  539 25622.6126 44518.1998  73.7%     -  488s
     0     0 44501.6667    0  410 25622.6126 44501.6667  73.7%     -  491s
     0     0 44493.5778    0  549 25622.6126 44493.5778  73.6%     -  495s
     0     0 44489.8025    0  551 25622.6126 44489.8025  73.6%     -  499s
     0     0 44489.1126    0  558 25622.6126 44489.1126  73.6%     -  501s
     0     0 44428.9383    0  542 25622.6126 44428.9383  73.4%     -  513s
     0     0 44397.5847    0  478 25622.6126 44397.5847  73.3%     -  523s
     0     0 44395.2481    0  504 25622.6126 44395.2481  73.3%     -  526s
     0     0 44392.5191    0  553 25622.6126 44392.5191  73.3%     -  528s
     0     0 44390.8702    0  568 25622.6126 44390.8702  73.2%     -  531s
     0     0 44382.6909    0  408 25622.6126 44382.6909  73.2%     -  535s
     0     0 44380.9551    0  399 25622.6126 44380.9551  73.2%     -  537s
     0     0 44377.0880    0  548 25622.6126 44377.0880  73.2%     -  541s
     0     0 44374.6412    0  409 25622.6126 44374.6412  73.2%     -  542s
     0     0 44373.3214    0  404 25622.6126 44373.3214  73.2%     -  543s
     0     0 44322.3183    0  501 25622.6126 44322.3183  73.0%     -  552s
H    0     0                    25722.939992 44319.1517  72.3%     -  552s
H    0     0                    26333.982272 44319.1517  68.3%     -  552s
     0     0 44316.0984    0  511 26333.9823 44316.0984  68.3%     -  557s
     0     0 44313.4689    0  509 26333.9823 44313.4689  68.3%     -  559s
     0     0 44312.8930    0  505 26333.9823 44312.8930  68.3%     -  561s
     0     0 44299.6237    0  514 26333.9823 44299.6237  68.2%     -  568s
H    0     0                    26405.982996 44299.4662  67.8%     -  570s
     0     0 44298.0763    0  521 26405.9830 44298.0763  67.8%     -  572s
     0     0 44292.8880    0  436 26405.9830 44292.8880  67.7%     -  576s
     0     0 44290.4700    0  528 26405.9830 44290.4700  67.7%     -  579s
     0     0 44289.8940    0  418 26405.9830 44289.8940  67.7%     -  581s
     0     0 44282.0669    0  490 26405.9830 44282.0669  67.7%     -  587s
     0     0 44279.4095    0  494 26405.9830 44279.4095  67.7%     -  591s
     0     0 44278.9013    0  492 26405.9830 44278.9013  67.7%     -  592s
     0     0 44270.8120    0  494 26405.9830 44270.8120  67.7%     -  598s
     0     0 44269.5044    0  501 26405.9830 44269.5044  67.6%     -  600s
     0     0 44265.0233    0  416 26405.9830 44265.0233  67.6%     -  603s
     0     0 44264.7307    0  416 26405.9830 44264.7307  67.6%     -  605s
H    0     0                    26441.357672 44264.7307  67.4%     -  682s
H    0     0                    26536.411002 44264.7307  66.8%     -  682s
H    0     0                    26596.748458 44264.7307  66.4%     -  682s
H    0     0                    26699.733037 44264.7307  65.8%     -  682s
H    0     2                    26782.760041 44264.7307  65.3%     -  783s
     0     2 44264.7307    0  416 26782.7600 44264.7307  65.3%     -  783s
     1     4 44022.5713    1  410 26782.7600 44263.2890  65.3%  7727  805s
     3     8 43930.7412    2  576 26782.7600 44022.4008  64.4% 14110  848s
     7    16 43690.9856    3  579 26782.7600 43930.1521  64.0% 18349  876s
    15    32 43505.3514    4  577 26782.7600 43690.9184  63.1% 19467  900s
    31    48 42949.7271    5  393 26782.7600 43528.5993  62.5% 20509  969s
    47    77 40510.9635    6  476 26782.7600 43528.5993  62.5% 23473 1017s
H   54    77                    26901.900541 43528.5993  61.8% 22137 1017s
    76   192 42248.5941    7  379 26901.9005 43528.5993  61.8% 19025 1120s
   191   224 41820.7829    9  378 26901.9005 43528.5993  61.8% 12091 1139s
   223   256 41524.0755   10  367 26901.9005 43528.5993  61.8% 11155 1159s
   255   287 41448.4252   11  361 26901.9005 43528.5993  61.8% 10609 1182s
H  259   287                    26950.650220 43528.5993  61.5% 10486 1182s
   286   401 41431.6389   12  359 26950.6502 43528.5993  61.5% 10050 1210s
   402   469 41098.2378   15  338 26950.6502 43528.5993  61.5%  8416 1236s
   470   536 39893.4927   19  340 26950.6502 43528.5993  61.5%  7903 1258s
   537   598 39781.1880   22  336 26950.6502 43528.5993  61.5%  7526 1279s
   613   653 34246.5440   26  175 26950.6502 43528.5993  61.5%  7015 1301s
   682   705 37855.0589   22  274 26950.6502 43528.5993  61.5%  6636 1324s
   742   763 35860.3352   23  262 26950.6502 43528.5993  61.5%  6410 1346s
   814   841 34474.3603   24  229 26950.6502 43528.5993  61.5%  6151 1366s
   907   938 33666.8846   27  190 26950.6502 43528.5993  61.5%  5803 1383s
  1022  1043 32955.5051   30  158 26950.6502 43528.5993  61.5%  5370 1406s
  1151  1132 31483.7292   33  161 26950.6502 43528.5993  61.5%  4973 1424s
  1288  1168 28828.4737   41  119 26950.6502 43528.5993  61.5%  4649 1440s
  1345  1235 28729.2979   42  106 26950.6502 43528.5993  61.5%  4547 1458s
  1473  1294     cutoff   47      26950.6502 43528.5993  61.5%  4285 1478s
  1613  1326 28162.2226   67   30 26950.6502 43528.5993  61.5%  4064 1501s
  1717  1384 36530.2699   15  315 26950.6502 43528.5993  61.5%  3979 1524s
  1785  1424 36514.0532   16  309 26950.6502 43528.5993  61.5%  4007 1547s
  1859  1453 36043.7780   17  317 26950.6502 43528.5993  61.5%  4007 1569s
  1910  1500 35556.8308   18  279 26950.6502 43528.5993  61.5%  4026 1591s
  2002  1564 35421.0866   19  263 26950.6502 43528.5993  61.5%  3994 1618s
H 2011  1564                    27029.659281 43528.5993  61.0%  3984 1618s
  2108  1642 33759.6371   20  251 27029.6593 43528.5993  61.0%  3931 1644s
  2234  1706 34505.9041   19  259 27029.6593 43528.5993  61.0%  3911 1672s
  2362  1769 33386.0545   21  247 27029.6593 43528.5993  61.0%  3897 1702s
  2456  1858 33907.5070   20  259 27029.6593 43528.5993  61.0%  3967 1734s
  2579  1943 33129.0701   22  267 27029.6593 43528.5993  61.0%  3989 1766s
  2700  1966 32931.9264   24  274 27029.6593 43528.5993  61.0%  4008 1793s
H 2735  1966                    27071.543332 43528.5993  60.8%  4029 1793s
  2747  2059 32687.3191   25  278 27071.5433 43528.5993  60.8%  4032 1828s
  2863  2169 28137.9878   25  169 27071.5433 43528.5993  60.8%  4094 1861s
  2998  2264 32642.7433   26  271 27071.5433 43528.5993  60.8%  4087 1898s
  3134  2396 32274.4643   29  360 27071.5433 43171.4797  59.5%  4089 1941s
  3306  2513 28970.0432   30  353 27071.5433 43170.8094  59.5%  4085 1981s
  3496  2652 31282.4565   31  313 27071.5433 43170.8094  59.5%  4056 2021s
  3688  2653 28864.8750   61  416 27071.5433 43170.8094  59.5%  4029 2351s
  3690  2654 28720.3251   78   67 27071.5433 43170.8094  59.5%  4027 2359s
  3691  2655 39243.5887   13  387 27071.5433 43170.8094  59.5%  4026 2426s
  3692  2656 31274.3082   67  417 27071.5433 43170.8094  59.5%  4025 2475s
  3693  2656 36984.6131   15  350 27071.5433 43170.8094  59.5%  4024 2508s
  3694  2657 33071.5235   39  370 27071.5433 43170.8094  59.5%  4023 2539s
  3695  2658 29603.0612   59  334 27071.5433 43170.8094  59.5%  4022 2561s
  3696  2658 40508.4784   19  482 27071.5433 43170.8094  59.5%  4021 2577s
  3697  2659 35933.2103   12  400 27071.5433 43170.8094  59.5%  4019 2589s
H 3697  2525                    27103.899976 43170.8094  59.3%  4019 2605s
  3699  2526 28240.8661   55  470 27103.9000 43170.8094  59.3%  4017 2621s
  3700  2527 32124.0355   24  408 27103.9000 43170.8094  59.3%  4016 2632s
  3701  2528 40433.3999   13  396 27103.9000 43170.8094  59.3%  4015 2639s
  3702  2528 27252.7703   51  430 27103.9000 43170.8094  59.3%  4014 2649s
  3703  2529 29577.9315   56  431 27103.9000 43170.8094  59.3%  4013 2654s
  3704  2530 29111.8760   20  421 27103.9000 43170.8094  59.3%  4012 2662s
  3705  2530 34783.9610   27  415 27103.9000 43170.8094  59.3%  4011 2667s
  3706  2531 39312.7469   13  412 27103.9000 43170.8094  59.3%  4010 2672s
  3707  2532 28909.3531   32  418 27103.9000 43170.8094  59.3%  4009 2675s
  3708  2532 28521.8763   36  409 27103.9000 43170.8094  59.3%  4008 2691s
  3709  2533 31470.9481   42  404 27103.9000 43170.8094  59.3%  4006 2700s
  3710  2534 31730.3072   36  486 27103.9000 43170.8094  59.3%  4005 2710s
  3711  2534 36054.7815   19  507 27103.9000 43170.8094  59.3%  4004 2717s
  3712  2535 38335.0841   25  416 27103.9000 43170.8094  59.3%  4003 2721s
  3713  2536 30759.4403   52  421 27103.9000 43170.8094  59.3%  4002 2727s
  3714  2536 36241.5491   23  520 27103.9000 43170.8094  59.3%  4001 2744s
  3715  2537 28555.2323   22  448 27103.9000 43170.8094  59.3%  4000 2757s
  3716  2538 33981.2395   21  412 27103.9000 43170.8094  59.3%  3999 2766s
  3717  2538 38643.2742   15  502 27103.9000 43170.8094  59.3%  3998 2776s
  3718  2539 34214.7932   28  501 27103.9000 43170.8094  59.3%  3997 2781s
  3719  2540 33283.9888   28  507 27103.9000 43170.8094  59.3%  3996 2790s
  3720  2540 34716.5767   27  445 27103.9000 43170.8094  59.3%  3995 2796s
  3721  2541 34216.6564   39  455 27103.9000 43170.8094  59.3%  3994 2800s
  3722  2542 29224.7127   55  421 27103.9000 43170.8094  59.3%  3992 2809s
  3723  2542 32724.7916   57  426 27103.9000 43170.8094  59.3%  3991 2816s
  3724  2543 30081.4461   51  555 27103.9000 43170.8094  59.3%  3990 2822s
  3725  2544 28225.7483   55  453 27103.9000 43170.8094  59.3%  3989 2830s
  3727  2545 36936.6397   25  515 27103.9000 43170.8094  59.3%  3987 2841s
  3729  2546 38403.1939   11  424 27103.9000 43170.8094  59.3%  3985 2847s
  3730  2547 31696.0051   23  465 27103.9000 43170.8094  59.3%  3984 2851s
  3731  2548 33385.7864   22  465 27103.9000 43170.8094  59.3%  3983 2855s
  3732  2548 32625.4917   32  496 27103.9000 43170.8094  59.3%  3982 2865s
  3734  2550 28795.7579   61  510 27103.9000 43170.8094  59.3%  3980 2871s
  3735  2550 30565.8908   34  507 27103.9000 43170.8094  59.3%  3979 2876s
  3736  2551 29307.7401   54  467 27103.9000 43170.8094  59.3%  3978 2882s
  3737  2552 38700.7472    8  509 27103.9000 43170.8094  59.3%  3976 2887s
  3738  2552 29036.3183   21  469 27103.9000 43170.8094  59.3%  3975 2890s
  3739  2553 37432.0113    8  466 27103.9000 43170.8094  59.3%  3974 2898s
  3740  2554 31064.0471   35  476 27103.9000 43170.8094  59.3%  3973 2903s
  3741  2554 28271.2289   39  508 27103.9000 43170.8094  59.3%  3972 2907s
  3742  2555 31066.9895   57  466 27103.9000 43170.8094  59.3%  3971 2916s
  3744  2556 31227.1948   53  504 27103.9000 43170.8094  59.3%  3969 2924s
  3745  2557 35217.6572   26  512 27103.9000 43170.8094  59.3%  3968 2933s
  3746  2558 32203.7385   45  507 27103.9000 43170.8094  59.3%  3967 2937s
  3747  2558 39272.3175   14  504 27103.9000 43170.8094  59.3%  3966 2944s
  3748  2559 30119.9468   12  504 27103.9000 43170.8094  59.3%  3965 2961s
  3749  2560 28707.2338   26  504 27103.9000 43170.8094  59.3%  3964 3042s
  3750  2562 42990.6183   16  431 27103.9000 43170.8094  59.3%  4096 3076s
  3751  2563 43170.8094   16  444 27103.9000 43170.8094  59.3%  4097 3091s
  3752  2567 42171.9377   17  438 27103.9000 43170.8094  59.3%  4101 3125s
  3756  2573 42012.7482   18  439 27103.9000 43076.6760  58.9%  4109 3175s
  3764  2587 41001.8026   19  434 27103.9000 42973.0980  58.5%  4134 3203s
  3780  2597 41735.5005   20  415 27103.9000 42852.2176  58.1%  4251 3298s
  3796  2624 40442.0780   21  401 27103.9000 42852.2176  58.1%  4308 3353s
  3828  2744 40127.3935   22  388 27103.9000 42852.2176  58.1%  4448 3412s
  3959  2756 39508.1670   27  357 27103.9000 42852.2176  58.1%  4554 3440s
  4027  2773 38944.3310   29  349 27103.9000 42852.2176  58.1%  4570 3475s
  4076  2780 37923.8744   30  333 27103.9000 42852.2176  58.1%  4609 3501s
  4106  2797 37667.5105   31  278 27103.9000 42852.2176  58.1%  4673 3523s
  4139  2813 34858.8961   32  249 27103.9000 42852.2176  58.1%  4719 3547s
  4169  2835 36068.6487   32  245 27103.9000 42852.2176  58.1%  4767 3569s
  4213  2851 35822.0421   33  243 27103.9000 42852.2176  58.1%  4811 3593s
  4275  2847 33445.5350   36  205 27103.9000 42852.2176  58.1%  4826 3600s

Cutting planes:
  Implied bound: 3
  Projected implied bound: 182
  MIR: 888
  Mixing: 4
  Flow cover: 1999
  RLT: 29
  Relax-and-lift: 256

Explored 4304 nodes (21335523 simplex iterations) in 3600.09 seconds (8966.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 27103.9 27071.5 27029.7 ... 26441.4

Time limit reached
Best objective 2.710389997599e+04, best bound 4.285221761220e+04, gap 58.1035%
  WARNING: Time limit reached. Using best solution found (gap: 58.10%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 27103.90, θ = 186965.25
  Upper Bound (UB) = 27103.90

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 186965.25
  [DEBUG]   ✓ Scenario 0: θ = 186965.25 ≤ Q = 186965.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 186965.25 ≤ Q = 186965.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 186965.25 ≤ Q = 186965.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 186965.25 ≤ Q = 186965.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 186965.25 ≤ Q = 186965.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 186965.25 ≤ Q = 186965.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 186965.25 ≤ Q = 186965.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 186965.25 ≤ Q = 186965.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 186965.25 ≤ Q = 186965.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 186965.25 ≤ Q = 186965.25 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 186965.25 ≤ Q = 186965.25 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 186965.25 ≤ Q = 186965.25 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6094b52c
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6094b52c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [1e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.260150e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.00s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5721945.3284
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.562711e+05, 249 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156271.08    0  127 5721945.33 -156271.08   103%     -    0s
H    0     0                    -123677.4829 -156271.08  26.4%     -    0s
H    0     0                    -124272.8153 -156271.08  25.7%     -    0s
     0     0 -138384.19    0   75 -124272.82 -138384.19  11.4%     -    0s
H    0     0                    -130744.1720 -138282.26  5.77%     -    0s
     0     0 -138282.26    0   78 -130744.17 -138282.26  5.77%     -    0s
     0     0 -138282.26    0   75 -130744.17 -138282.26  5.77%     -    0s
H    0     0                    -134912.2787 -138282.26  2.50%     -    0s
H    0     0                    -136313.7527 -138282.26  1.44%     -    0s
     0     0 -137799.71    0   77 -136313.75 -137799.71  1.09%     -    0s
     0     0 -137753.97    0   77 -136313.75 -137753.97  1.06%     -    0s
     0     0 -137753.69    0   77 -136313.75 -137753.69  1.06%     -    0s
H    0     0                    -136844.1223 -137753.69  0.66%     -    0s
     0     0 -137613.82    0   47 -136844.12 -137613.82  0.56%     -    0s
     0     0 -137587.01    0   45 -136844.12 -137587.01  0.54%     -    0s
     0     0 -137433.30    0   41 -136844.12 -137433.30  0.43%     -    0s
H    0     0                    -136879.2837 -137418.60  0.39%     -    0s
     0     0 -137411.14    0   42 -136879.28 -137411.14  0.39%     -    0s
     0     0 -137409.53    0   42 -136879.28 -137409.53  0.39%     -    0s
     0     0 -137347.65    0   36 -136879.28 -137347.65  0.34%     -    0s
H    0     0                    -136907.1976 -137340.43  0.32%     -    0s
H    0     0                    -136945.0628 -137340.43  0.29%     -    0s
     0     0 -137296.73    0   36 -136945.06 -137296.73  0.26%     -    0s
     0     0 -137287.31    0   45 -136945.06 -137287.31  0.25%     -    0s
     0     0 -137286.09    0   33 -136945.06 -137286.09  0.25%     -    0s
     0     0 -137233.81    0   39 -136945.06 -137233.81  0.21%     -    0s
     0     0 -137221.48    0   38 -136945.06 -137221.48  0.20%     -    0s
     0     0 -137210.69    0   37 -136945.06 -137210.69  0.19%     -    0s
     0     0 -137206.96    0   39 -136945.06 -137206.96  0.19%     -    0s
     0     0 -137196.29    0   39 -136945.06 -137196.29  0.18%     -    0s
     0     0 -137196.29    0   38 -136945.06 -137196.29  0.18%     -    0s
H    0     0                    -136948.1973 -137183.81  0.17%     -    0s
     0     0 -137183.81    0   41 -136948.20 -137183.81  0.17%     -    0s
     0     0 -137074.38    0   11 -136948.20 -137074.38  0.09%     -    0s
H    0     0                    -136962.7805 -137067.93  0.08%     -    0s
     0     0 -137035.54    0   11 -136962.78 -137035.54  0.05%     -    0s
     0     0 -137035.05    0   11 -136962.78 -137035.05  0.05%     -    0s
     0     0 -137013.64    0   10 -136962.78 -137013.64  0.04%     -    0s
     0     0 -137008.53    0    9 -136962.78 -137008.53  0.03%     -    0s
     0     0 -136999.43    0    7 -136962.78 -136999.43  0.03%     -    0s
     0     0 -136973.06    0    2 -136962.78 -136973.06  0.01%     -    0s
     0     0 -136973.06    0    4 -136962.78 -136973.06  0.01%     -    0s
H    0     0                    -136972.9266 -136973.06  0.00%     -    0s

Explored 1 nodes (1018 simplex iterations) in 0.09 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -136973 -136963 -136948 ... -124273

Optimal solution found (tolerance 1.00e-06)
Best objective -1.369729266105e+05, best bound -1.369730582543e+05, gap 0.0001%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 177402.00
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -136972.93
  [DEBUG]   S×d_nominal = 314374.93
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314374.93 + -136972.93 = 177402.00
  [DEBUG]   Current θ from Master = 186965.25
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9563.25 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 17540.65
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 2017.0387, Absolute Gap = 2017.0387, Relative Gap = 0.074419
  Not converged yet (gap = 2017.04 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567366 nonzeros
Model fingerprint: 0xe675ffef
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 97162 rows and 39442 columns
Presolve time: 1.62s
Presolved: 102991 rows, 43938 columns, 625047 nonzeros
Variable types: 41679 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -322809.5468
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.22s

Barrier statistics:
 Dense cols : 548
 AA' NZ     : 4.323e+06
 Factor NZ  : 9.749e+06 (roughly 140 MB of memory)
 Factor Ops : 1.835e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.73615354e+07  1.87621587e+08  1.20e+05 2.15e+01  8.23e+04     3s
   1  -1.33760628e+07  1.73659974e+08  8.47e+04 9.21e+01  5.77e+04     3s
   2  -3.25964671e+06  1.32278480e+08  2.20e+04 6.43e-01  1.62e+04     3s
   3  -8.80161600e+05  9.31040858e+07  3.06e+03 5.78e-01  2.59e+03     3s
   4  -4.26859487e+05  4.52993636e+07  5.01e+02 1.80e-01  5.49e+02     3s
   5  -3.16501145e+05  2.83216358e+07  1.59e+02 9.55e-02  2.40e+02     3s
   6  -2.30780349e+05  1.97647036e+07  3.87e+01 6.21e-02  1.25e+02     3s
   7  -1.40851191e+05  1.49013090e+07  1.07e+01 4.53e-02  8.41e+01     3s
   8  -1.11066655e+05  7.27318077e+06  6.76e+00 2.10e-02  4.07e+01     3s
   9  -8.22640558e+04  3.79760494e+06  4.40e+00 1.06e-02  2.12e+01     3s
  10  -5.46376745e+04  1.13305574e+06  2.49e+00 2.81e-03  6.42e+00     3s
  11  -2.02476649e+04  3.51686877e+05  1.06e+00 9.52e-04  1.99e+00     3s
  12  -4.69364099e+03  2.07236989e+05  6.77e-01 9.83e-04  1.13e+00     3s
  13   4.15993224e+03  1.67961558e+05  5.22e-01 1.31e-03  8.74e-01     4s
  14   1.14155002e+04  1.30289860e+05  4.27e-01 2.08e-03  6.34e-01     4s
  15   2.08108794e+04  1.08537949e+05  3.27e-01 1.41e-03  4.68e-01     4s
  16   2.47142009e+04  8.91787729e+04  2.85e-01 2.37e-03  3.44e-01     4s
  17   3.03952222e+04  7.89548239e+04  2.30e-01 2.27e-03  2.59e-01     4s
  18   3.48578985e+04  7.21341332e+04  1.89e-01 2.15e-03  1.99e-01     4s
  19   3.90523931e+04  6.84064664e+04  1.52e-01 2.28e-03  1.57e-01     4s
  20   4.28365079e+04  6.53316435e+04  1.20e-01 2.25e-03  1.20e-01     4s
  21   4.45814726e+04  6.30895204e+04  1.05e-01 1.96e-03  9.89e-02     4s
  22   4.70217101e+04  6.16684051e+04  8.38e-02 1.43e-03  7.82e-02     4s
  23   4.79309644e+04  6.05914428e+04  7.62e-02 1.35e-03  6.76e-02     4s
  24   5.05065861e+04  5.98496421e+04  5.54e-02 1.60e-03  4.99e-02     4s
  25   5.25607194e+04  5.90862085e+04  3.87e-02 2.13e-03  3.49e-02     4s
  26   5.42346293e+04  5.86187743e+04  2.55e-02 1.66e-03  2.34e-02     4s
  27   5.50542804e+04  5.80932628e+04  1.91e-02 7.92e-04  1.62e-02     4s
  28   5.54899167e+04  5.79230208e+04  1.58e-02 5.09e-04  1.30e-02     4s
  29   5.58634811e+04  5.78838392e+04  1.30e-02 3.71e-04  1.08e-02     4s
  30   5.62422524e+04  5.78005620e+04  1.01e-02 4.02e-04  8.33e-03     4s
  31   5.68468964e+04  5.77544334e+04  5.61e-03 3.54e-04  4.85e-03     5s
  32   5.70756372e+04  5.77109407e+04  3.99e-03 2.00e-04  3.40e-03     5s
  33   5.72376570e+04  5.76766503e+04  2.84e-03 1.01e-04  2.35e-03     5s
  34   5.73515528e+04  5.76662896e+04  2.02e-03 7.04e-05  1.68e-03     5s
  35   5.74491949e+04  5.76546797e+04  1.33e-03 3.35e-05  1.10e-03     5s
  36   5.74999040e+04  5.76523963e+04  9.70e-04 3.03e-05  8.15e-04     5s
  37   5.75608948e+04  5.76489920e+04  5.50e-04 1.62e-05  4.71e-04     5s
  38   5.75793860e+04  5.76474746e+04  4.20e-04 1.16e-05  3.64e-04     5s
  39   5.75835158e+04  5.76465718e+04  3.93e-04 8.96e-06  3.37e-04     5s
  40   5.75914809e+04  5.76455910e+04  3.38e-04 4.81e-06  2.89e-04     5s
  41   5.75921050e+04  5.76453959e+04  3.34e-04 4.33e-06  2.85e-04     5s
  42   5.75977944e+04  5.76451194e+04  2.96e-04 3.63e-06  2.53e-04     5s
  43   5.76238019e+04  5.76443923e+04  1.24e-04 1.42e-06  1.10e-04     5s
  44   5.76354420e+04  5.76440044e+04  4.78e-05 7.46e-07  4.57e-05     5s
  45   5.76433398e+04  5.76436535e+04  1.65e-06 2.39e-06  1.67e-06     6s
  46   5.76436091e+04  5.76436095e+04  5.39e-09 6.28e-08  2.15e-09     6s

Barrier solved model in 46 iterations and 5.56 seconds (8.48 work units)
Optimal objective 5.76436091e+04


Root crossover log...

   94775 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    8252 PPushes remaining with PInf 7.1058349e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.7193776e+04      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   55066    5.7643609e+04   0.000000e+00   1.719378e+04      9s
   55498    5.7643609e+04   0.000000e+00   0.000000e+00     10s
   55498    5.7643609e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.764361e+04, 55498 iterations, 7.47 seconds (14.35 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 57643.6094    0   97 -171254.74 57643.6094   134%     -   10s
H    0     0                    -170115.3201 57643.6094   134%     -   10s
H    0     0                    -141222.1145 57643.6094   141%     -   10s
H    0     0                    -139771.3687 57643.6094   141%     -   10s
H    0     0                    -139108.4047 57643.6094   141%     -   10s
H    0     0                    -52567.85629 57643.6094   210%     -   10s
H    0     0                    9140.5255953 57643.6094   531%     -   10s
H    0     0                    12059.119288 57643.6094   378%     -   11s
H    0     0                    12125.546171 52637.7504   334%     -   48s
H    0     0                    12142.873269 52637.7504   333%     -   48s
H    0     0                    12264.137074 52637.7504   329%     -   48s
     0     0 52637.7504    0  224 12264.1371 52637.7504   329%     -   48s
H    0     0                    12346.820185 52636.6764   326%     -   56s
     0     0 52115.1873    0  228 12346.8202 52115.1873   322%     -   72s
     0     0 52104.3922    0  274 12346.8202 52104.3922   322%     -   81s
     0     0 52104.3922    0  275 12346.8202 52104.3922   322%     -   82s
     0     0 52104.3922    0  278 12346.8202 52104.3922   322%     -   87s
     0     0 52104.3922    0  281 12346.8202 52104.3922   322%     -   88s
     0     0 52104.3922    0  281 12346.8202 52104.3922   322%     -   88s
H    0     0                    14490.640118 48913.9214   238%     -  134s
H    0     0                    14669.263096 48913.9214   233%     -  134s
H    0     0                    15551.095593 48913.9214   215%     -  134s
H    0     0                    15799.218117 48913.9214   210%     -  134s
     0     0 48913.9214    0  390 15799.2181 48913.9214   210%     -  134s
H    0     0                    20581.950325 48913.8745   138%     -  135s
H    0     0                    23179.126928 48913.8745   111%     -  135s
H    0     0                    23514.232742 48913.8745   108%     -  135s
H    0     0                    23688.437722 48913.8745   106%     -  135s
H    0     0                    24172.663064 48913.8745   102%     -  135s
H    0     0                    24202.159635 48913.8745   102%     -  135s
     0     0 48621.7046    0  380 24202.1596 48621.7046   101%     -  159s
     0     0 48509.6432    0  401 24202.1596 48509.6432   100%     -  175s
     0     0 48423.5151    0  397 24202.1596 48423.5151   100%     -  191s
     0     0 48403.0532    0  335 24202.1596 48403.0532   100%     -  200s
     0     0 48356.9276    0  392 24202.1596 48356.9276   100%     -  212s
     0     0 48317.1054    0  400 24202.1596 48317.1054   100%     -  222s
     0     0 48271.7966    0  408 24202.1596 48271.7966  99.5%     -  231s
     0     0 48267.0871    0  400 24202.1596 48267.0871  99.4%     -  233s
     0     0 48265.2056    0  409 24202.1596 48265.2056  99.4%     -  235s
     0     0 48264.1194    0  411 24202.1596 48264.1194  99.4%     -  237s
     0     0 48255.0139    0  401 24202.1596 48255.0139  99.4%     -  239s
     0     0 48250.8806    0  427 24202.1596 48250.8806  99.4%     -  242s
     0     0 48250.1331    0  434 24202.1596 48250.1331  99.4%     -  243s
H    0     0                    24386.567758 48250.1331  97.9%     -  257s
     0     0 46487.5394    0  308 24386.5678 46487.5394  90.6%     -  297s
H    0     0                    24480.213677 46487.4808  89.9%     -  297s
     0     0 45999.5095    0  327 24480.2137 45999.5095  87.9%     -  324s
     0     0 45792.7121    0  341 24480.2137 45792.7121  87.1%     -  339s
     0     0 45733.6137    0  342 24480.2137 45733.6137  86.8%     -  350s
     0     0 45720.6815    0  347 24480.2137 45720.6815  86.8%     -  355s
     0     0 45702.3958    0  341 24480.2137 45702.3958  86.7%     -  361s
     0     0 45693.4431    0  349 24480.2137 45693.4431  86.7%     -  363s
     0     0 45645.2572    0  347 24480.2137 45645.2572  86.5%     -  371s
     0     0 45631.6750    0  347 24480.2137 45631.6750  86.4%     -  375s
     0     0 45622.1890    0  347 24480.2137 45622.1890  86.4%     -  379s
     0     0 45619.7603    0  350 24480.2137 45619.7603  86.4%     -  380s
     0     0 45619.2822    0  349 24480.2137 45619.2822  86.4%     -  381s
     0     0 45120.5787    0  489 24480.2137 45120.5787  84.3%     -  414s
     0     0 44978.0588    0  383 24480.2137 44978.0588  83.7%     -  426s
     0     0 44939.5006    0  397 24480.2137 44939.5006  83.6%     -  434s
     0     0 44909.1549    0  393 24480.2137 44909.1549  83.5%     -  441s
     0     0 44881.7926    0  394 24480.2137 44881.7926  83.3%     -  447s
     0     0 44863.3692    0  404 24480.2137 44863.3692  83.3%     -  452s
     0     0 44858.1907    0  406 24480.2137 44858.1907  83.2%     -  454s
     0     0 44845.8771    0  400 24480.2137 44845.8771  83.2%     -  459s
     0     0 44832.3765    0  394 24480.2137 44832.3765  83.1%     -  464s
     0     0 44812.9745    0  404 24480.2137 44812.9745  83.1%     -  467s
     0     0 44800.2865    0  403 24480.2137 44800.2865  83.0%     -  470s
     0     0 44795.3864    0  405 24480.2137 44795.3864  83.0%     -  472s
     0     0 44783.3871    0  397 24480.2137 44783.3871  82.9%     -  477s
     0     0 44777.6951    0  556 24480.2137 44777.6951  82.9%     -  482s
     0     0 44777.3028    0  550 24480.2137 44777.3028  82.9%     -  483s
     0     0 44603.3704    0  368 24480.2137 44603.3704  82.2%     -  497s
     0     0 44537.3749    0  407 24480.2137 44537.3749  81.9%     -  509s
     0     0 44516.6894    0  574 24480.2137 44516.6894  81.8%     -  519s
     0     0 44508.2134    0  411 24480.2137 44508.2134  81.8%     -  523s
     0     0 44488.0634    0  377 24480.2137 44488.0634  81.7%     -  527s
     0     0 44476.5828    0  381 24480.2137 44476.5828  81.7%     -  531s
     0     0 44474.0636    0  375 24480.2137 44474.0636  81.7%     -  534s
     0     0 44470.9670    0  378 24480.2137 44470.9670  81.7%     -  537s
     0     0 44469.3745    0  380 24480.2137 44469.3745  81.7%     -  539s
     0     0 44354.6354    0  498 24480.2137 44354.6354  81.2%     -  551s
     0     0 44323.6835    0  393 24480.2137 44323.6835  81.1%     -  556s
     0     0 44316.4133    0  395 24480.2137 44316.4133  81.0%     -  559s
     0     0 44312.2866    0  400 24480.2137 44312.2866  81.0%     -  561s
     0     0 44304.3142    0  400 24480.2137 44304.3142  81.0%     -  564s
     0     0 44294.8224    0  401 24480.2137 44294.8224  80.9%     -  566s
     0     0 44286.4858    0  396 24480.2137 44286.4858  80.9%     -  567s
     0     0 44283.4340    0  399 24480.2137 44283.4340  80.9%     -  569s
     0     0 44280.5424    0  396 24480.2137 44280.5424  80.9%     -  570s
     0     0 44278.0510    0  400 24480.2137 44278.0510  80.9%     -  572s
     0     0 44277.8657    0  401 24480.2137 44277.8657  80.9%     -  573s
     0     0 44265.9018    0  398 24480.2137 44265.9018  80.8%     -  578s
     0     0 44258.0689    0  556 24480.2137 44258.0689  80.8%     -  582s
     0     0 44255.3763    0  557 24480.2137 44255.3763  80.8%     -  584s
     0     0 44254.9603    0  403 24480.2137 44254.9603  80.8%     -  584s
     0     0 44249.2770    0  402 24480.2137 44249.2770  80.8%     -  587s
     0     0 44247.1877    0  400 24480.2137 44247.1877  80.7%     -  589s
H    0     0                    24506.260889 44246.5993  80.6%     -  591s
     0     0 44246.5993    0  400 24506.2609 44246.5993  80.6%     -  591s
     0     0 44231.3650    0  395 24506.2609 44231.3650  80.5%     -  596s
H    0     0                    24588.320237 44231.2468  79.9%     -  596s
     0     0 44223.6872    0  407 24588.3202 44223.6872  79.9%     -  599s
     0     0 44221.5791    0  412 24588.3202 44221.5791  79.8%     -  600s
     0     0 44221.2260    0  409 24588.3202 44221.2260  79.8%     -  600s
     0     0 44214.3475    0  406 24588.3202 44214.3475  79.8%     -  603s
     0     0 44211.6163    0  400 24588.3202 44211.6163  79.8%     -  605s
     0     0 44211.2829    0  407 24588.3202 44211.2829  79.8%     -  605s
     0     0 44207.5806    0  491 24588.3202 44207.5806  79.8%     -  609s
     0     0 44205.7131    0  503 24588.3202 44205.7131  79.8%     -  611s
     0     0 44205.4710    0  502 24588.3202 44205.4710  79.8%     -  612s
     0     0 44201.0345    0  394 24588.3202 44201.0345  79.8%     -  615s
H    0     0                    24629.636079 44200.6934  79.5%     -  619s
     0     0 44197.6774    0  550 24629.6361 44197.6774  79.4%     -  622s
     0     0 44195.8686    0  475 24629.6361 44195.8686  79.4%     -  624s
     0     0 44195.3947    0  477 24629.6361 44195.3947  79.4%     -  625s
     0     0 44188.3592    0  409 24629.6361 44188.3592  79.4%     -  628s
     0     0 44188.2938    0  409 24629.6361 44188.2938  79.4%     -  630s
H    0     0                    24681.966156 44188.2773  79.0%     -  687s
H    0     0                    24725.065980 44188.2773  78.7%     -  731s
H    0     2                    24748.600560 44188.2773  78.5%     -  733s
     0     2 44188.2773    0  409 24748.6006 44188.2773  78.5%     -  733s
     1     3 43905.2333    1  365 24748.6006 44188.2773  78.5% 15830  748s
     2     4 44029.6165    1  390 24748.6006 44029.6165  77.9% 11361  756s
     3     7 42480.9518    2  359 24748.6006 44029.6060  77.9% 11152  771s
     6    12 42319.2034    3  354 24748.6006 44029.6060  77.9% 11222  806s
    11    24 42410.6851    4  373 24748.6006 43898.1059  77.4% 16660  827s
    23    36 43135.1307    5  474 24748.6006 43615.2154  76.2% 19102  882s
    35    68 42740.4309    6  385 24748.6006 43615.2154  76.2% 21073  983s
H   36    68                    24785.093674 43615.2154  76.0% 20488  983s
H   37    68                    24808.450373 43615.2154  75.8% 20255  983s
H   40    68                    24819.378271 43615.2154  75.7% 19864  983s
    67   111 42618.9849    7  377 24819.3783 43338.6513  74.6% 21593 1039s
   110   143 42096.4569    8  366 24819.3783 43338.4610  74.6% 17331 1067s
   142   195 41865.0636    9  350 24819.3783 43338.4610  74.6% 15285 1096s
H  145   195                    25998.273338 43338.4610  66.7% 15031 1096s
H  194   314                    26473.864889 43338.4610  63.7% 12804 1133s
H  202   314                    26531.467534 43338.4610  63.3% 12499 1133s
H  209   314                    26531.697445 43338.4610  63.3% 12323 1133s
H  221   314                    26587.551359 43338.4610  63.0% 11935 1133s
H  224   314                    26597.003690 43338.4610  62.9% 11922 1133s
H  265   314                    26600.513034 43338.4610  62.9% 10881 1133s
   313   363 41602.2724   13  344 26600.5130 43338.4610  62.9% 10088 1159s
   362   403 40546.9186   14  339 26600.5130 43338.4610  62.9%  9710 1184s
   402   468 40495.8978   15  332 26600.5130 43338.4610  62.9%  9816 1209s
   467   530 40473.5509   16  418 26600.5130 43338.4610  62.9%  9472 1233s
H  521   530                    26714.877817 43338.4610  62.2%  9263 1233s
   529   598 39381.7254   19  383 26714.8778 43338.4610  62.2%  9330 1261s
   597   657 39346.1083   20  396 26714.8778 43338.4610  62.2%  9266 1280s
H  618   657                    26725.122274 43338.4610  62.2%  9224 1280s
   656   727 39105.4225   22  363 26725.1223 43338.4610  62.2%  9223 1300s
   726   778 38821.7995   24  299 26725.1223 43338.4610  62.2%  9056 1323s
   777   842 37465.0398   25  267 26725.1223 43338.4610  62.2%  9224 1344s
   847   870 31768.2204   26  257 26725.1223 43338.4610  62.2%  9036 1361s
   875   902 35923.8368   41  152 26725.1223 43338.4610  62.2%  9058 1380s
   909   926 33931.9682   42  146 26725.1223 43338.4610  62.2%  9246 1399s
H  927   926                    26800.368829 43338.4610  61.7%  9303 1399s
   937  1024 37348.7325   26  269 26800.3688 43338.4610  61.7%  9287 1418s
  1041  1110 33053.8494   47  108 26800.3688 43338.4610  61.7%  8936 1440s
H 1063  1110                    26810.747626 43338.4610  61.6%  8835 1440s
  1139  1233 34373.9979   24  375 26810.7476 43338.4610  61.6%  8543 1460s
  1296  1250 33952.4035   25  374 26810.7476 43338.4610  61.6%  7986 1486s
H 1315  1250                    26836.721732 43338.4610  61.5%  7942 1486s
  1333  1347 33542.1167   26  368 26836.7217 43338.4610  61.5%  7921 1508s
  1475  1362 33326.4472   27  325 26836.7217 43338.4610  61.5%  7568 1531s
  1516  1388 33021.6305   28  335 26836.7217 43257.6794  61.2%  7613 1556s
H 1523  1388                    26837.628403 43257.6794  61.2%  7645 1556s
  1556  1469 32973.7570   29  303 26837.6284 43257.6794  61.2%  7687 1582s
  1683  1550 31888.3668   33  304 26837.6284 43257.6794  61.2%  7598 1608s
  1804  1644 31643.3834   38  289 26837.6284 43257.6794  61.2%  7532 1641s
  1932  1754 31063.3492   45  269 26837.6284 43257.6794  61.2%  7469 1670s
  2072  1854 30223.2544   49  220 26837.6284 43257.6794  61.2%  7375 1700s
  2198  1974 29260.9172   53  246 26837.6284 43257.6794  61.2%  7359 1731s
  2339  2094 28371.4498   59  191 26837.6284 43045.1577  60.4%  7350 1761s
  2503  2169     cutoff   69      26837.6284 43045.1577  60.4%  7331 1795s
  2646  2248 infeasible   52      26837.6284 42871.5835  59.7%  7346 1832s
  2775  2327     cutoff   47      26837.6284 42798.4771  59.5%  7361 1868s
  2904  2426 37472.4519   10  480 26837.6284 42701.0757  59.1%  7378 1907s
  3059  2503 36410.1165   11  327 26837.6284 42701.0757  59.1%  7394 1946s
  3205  2599 36391.3337   12  460 26837.6284 42701.0757  59.1%  7445 1986s
  3337  2704 34508.1185   15  307 26837.6284 42701.0757  59.1%  7547 2032s
  3483  2771 30604.5349   17  382 26837.6284 42701.0757  59.1%  7614 2078s
  3613  2866 29890.2561   19  366 26837.6284 42701.0757  59.1%  7721 2122s
H 3730  2866                    26851.515809 42701.0757  59.0%  7803 2151s
  3731  2867 28565.9886   57  409 26851.5158 42701.0757  59.0%  7801 2323s
  3733  2868 36701.2438   24   67 26851.5158 42701.0757  59.0%  7797 2334s
  3734  2869 35850.8539   26  360 26851.5158 42701.0757  59.0%  7794 2398s
  3735  2870 33630.0153   43  372 26851.5158 42701.0757  59.0%  7792 2473s
  3736  2870 38865.3141   14  348 26851.5158 42701.0757  59.0%  7790 2519s
  3737  2871 41565.2087   13  357 26851.5158 42701.0757  59.0%  7788 2548s
  3738  2872 36776.3596   18  433 26851.5158 42701.0757  59.0%  7786 2565s
  3739  2872 39935.9042   11  381 26851.5158 42701.0757  59.0%  7784 2576s
  3740  2873 28463.2640   70  424 26851.5158 42701.0757  59.0%  7782 2592s
  3741  2874 30215.7471   45  431 26851.5158 42701.0757  59.0%  7780 2600s
  3742  2874 40954.1623   12  491 26851.5158 42701.0757  59.0%  7778 2610s
  3743  2875 41156.8601   17  456 26851.5158 42701.0757  59.0%  7776 2634s
  3744  2876 28047.6407   44  398 26851.5158 42701.0757  59.0%  7774 2655s
  3745  2876 37091.3234   37  476 26851.5158 42701.0757  59.0%  7772 2668s
  3746  2877 29419.7460   49  398 26851.5158 42701.0757  59.0%  7770 2678s
  3747  2878 36776.3596   18  400 26851.5158 42701.0757  59.0%  7767 2686s
  3748  2878 31092.4900   25  399 26851.5158 42701.0757  59.0%  7765 2692s
  3749  2879 27998.3810   59  404 26851.5158 42701.0757  59.0%  7763 2697s
  3750  2880 37025.3794   10  397 26851.5158 42701.0757  59.0%  7761 2702s
  3751  2880 28380.0155   36  476 26851.5158 42701.0757  59.0%  7759 2718s
  3752  2881 38516.7409   14  482 26851.5158 42701.0757  59.0%  7757 2728s
  3753  2882 35510.5193   26  495 26851.5158 42701.0757  59.0%  7755 2741s
  3754  2882 29708.2162   38  416 26851.5158 42701.0757  59.0%  7753 2747s
  3755  2883 37896.0563   25  475 26851.5158 42701.0757  59.0%  7751 2751s
  3756  2884 30102.9245   16  413 26851.5158 42701.0757  59.0%  7749 2757s
  3757  2884 37103.4033   35  484 26851.5158 42701.0757  59.0%  7747 2778s
  3758  2885 40661.8796   14  425 26851.5158 42701.0757  59.0%  7745 2788s
  3759  2886 41257.7191   11  419 26851.5158 42701.0757  59.0%  7743 2796s
  3761  2887 30472.7761   51  415 26851.5158 42701.0757  59.0%  7739 2804s
  3762  2888 40107.8773   11  489 26851.5158 42701.0757  59.0%  7736 2818s
  3763  2888 29068.6484   47  432 26851.5158 42701.0757  59.0%  7734 2825s
  3764  2889 30097.3715   47  473 26851.5158 42701.0757  59.0%  7732 2833s
  3765  2890 29098.1551   38  424 26851.5158 42701.0757  59.0%  7730 2839s
  3766  2890 37485.9546   35  492 26851.5158 42701.0757  59.0%  7728 2853s
  3767  2891 32498.7858   75  424 26851.5158 42701.0757  59.0%  7726 2859s
  3768  2892 37979.4036   15  424 26851.5158 42701.0757  59.0%  7724 2866s
  3769  2892 28402.2750   33  541 26851.5158 42701.0757  59.0%  7722 2884s
  3770  2893 30797.8365   40  457 26851.5158 42701.0757  59.0%  7720 2894s
  3771  2894 40529.1309   15  498 26851.5158 42701.0757  59.0%  7718 2900s
  3772  2894 30042.7794   40  457 26851.5158 42701.0757  59.0%  7716 2915s
  3773  2895 31730.3136   32  472 26851.5158 42701.0757  59.0%  7714 2920s
  3774  2896 39935.9042   11  476 26851.5158 42701.0757  59.0%  7712 2929s
  3775  2896 33040.7135   50  469 26851.5158 42701.0757  59.0%  7710 2935s
  3776  2897 38715.0867   23  479 26851.5158 42701.0757  59.0%  7708 2944s
  3777  2898 27611.3558   25  475 26851.5158 42701.0757  59.0%  7706 2949s
  3778  2898 28801.3505   29  473 26851.5158 42701.0757  59.0%  7704 2957s
  3779  2899 37268.9798   10  440 26851.5158 42701.0757  59.0%  7702 2961s
  3780  2900 32010.1440   44  428 26851.5158 42701.0757  59.0%  7700 2972s
  3781  2900 37900.6146   35  431 26851.5158 42701.0757  59.0%  7698 2976s
  3782  2901 29377.0609   70  423 26851.5158 42701.0757  59.0%  7696 2983s
  3783  2902 35542.6445   47  423 26851.5158 42701.0757  59.0%  7694 3002s
  3784  2902 32089.0793   11  423 26851.5158 42701.0757  59.0%  7691 3094s
  3785  2906 42701.0757   14  464 26851.5158 42701.0757  59.0%  7804 3145s
  3787  2909 42701.0757   15  407 26851.5158 42701.0757  59.0%  7808 3199s
  3791  2916 42701.0757   16  410 26851.5158 42701.0757  59.0%  7813 3272s
  3799  2929 42701.0757   17  445 26851.5158 42701.0757  59.0%  7827 3318s
  3815  2943 40033.8949   18  393 26851.5158 42701.0757  59.0%  7940 3436s
  3834  2969 40945.0317   19  480 26851.5158 42701.0757  59.0%  7971 3506s
H 3843  2820                    26953.326212 42701.0757  58.4%  8003 3506s
  3866  2918 40880.0754   20  457 26953.3262 42701.0757  58.4%  8079 3581s
  3972  2928 39960.1879   23  334 26953.3262 42701.0757  58.4%  8173 3600s

Cutting planes:
  Implied bound: 4
  Projected implied bound: 269
  MIR: 974
  Mixing: 2
  Flow cover: 2088
  RLT: 13
  Relax-and-lift: 240

Explored 4017 nodes (33243142 simplex iterations) in 3600.05 seconds (8475.65 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26953.3 26851.5 26837.6 ... 26597

Time limit reached
Best objective 2.695332621242e+04, best bound 4.270107568783e+04, gap 58.4260%
  WARNING: Time limit reached. Using best solution found (gap: 58.43%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 26953.33, θ = 187194.46
  Upper Bound (UB) = 26953.33

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 187194.46
  [DEBUG]   ✓ Scenario 0: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 187194.46 ≤ Q = 187194.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 187194.46 ≤ Q = 187194.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 187194.46 ≤ Q = 187194.46 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x73b0d7e9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8c4f2817
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.268342e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.00s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5746035.2874
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.561272e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -156127.18    0  123 5746035.29 -156127.18   103%     -    0s
H    0     0                    -124802.0549 -156127.18  25.1%     -    0s
H    0     0                    -125397.3873 -156127.18  24.5%     -    0s
     0     0 -135244.58    0   90 -125397.39 -135244.58  7.85%     -    0s
H    0     0                    -128755.5831 -135215.64  5.02%     -    0s
H    0     0                    -131985.2873 -135215.64  2.45%     -    0s
H    0     0                    -132820.4305 -135215.64  1.80%     -    0s
     0     0 -134398.37    0   82 -132820.43 -134398.37  1.19%     -    0s
     0     0 -134362.36    0   82 -132820.43 -134362.36  1.16%     -    0s
     0     0 -134356.30    0   82 -132820.43 -134356.30  1.16%     -    0s
     0     0 -134192.46    0   65 -132820.43 -134192.46  1.03%     -    0s
     0     0 -134191.54    0   64 -132820.43 -134191.54  1.03%     -    0s
     0     0 -134140.52    0   64 -132820.43 -134140.52  0.99%     -    0s
     0     0 -134140.27    0   64 -132820.43 -134140.27  0.99%     -    0s
H    0     0                    -133071.3710 -134140.27  0.80%     -    0s
H    0     0                    -133523.9178 -134140.27  0.46%     -    0s
     0     2 -134140.27    0   64 -133523.92 -134140.27  0.46%     -    0s
H   83    35                    -133576.3000 -133932.36  0.27%  14.7    0s
H  251    51                    -133604.5442 -133799.99  0.15%   8.5    0s
*  540     0              38    -133606.0175 -133606.02  0.00%   6.1    0s

Cutting planes:
  Gomory: 56
  Implied bound: 1
  MIR: 188
  Flow cover: 4

Explored 541 nodes (3850 simplex iterations) in 0.11 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -133606 -133605 -133576 ... -124802
No other solutions better than -133606

Optimal solution found (tolerance 1.00e-06)
Best objective -1.336060174719e+05, best bound -1.336060174719e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 181071.33
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133606.02
  [DEBUG]   S×d_nominal = 314677.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 314677.35 + -133606.02 = 181071.33
  [DEBUG]   Current θ from Master = 187194.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6123.13 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20830.20
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 1866.4649, Absolute Gap = 1866.4649, Relative Gap = 0.069248
  Not converged yet (gap = 1866.46 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610585 nonzeros
Model fingerprint: 0x95cdf8db
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 104636 rows and 42476 columns
Presolve time: 2.18s
Presolved: 110807 rows, 47144 columns, 669259 nonzeros
Variable types: 44885 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -322816.3201
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.25s

Barrier statistics:
 Dense cols : 548
 AA' NZ     : 4.793e+06
 Factor NZ  : 1.104e+07 (roughly 150 MB of memory)
 Factor Ops : 2.176e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.77812231e+07  2.00113835e+08  1.22e+05 2.07e+01  8.39e+04     4s
   1  -1.36775117e+07  1.86059252e+08  8.64e+04 9.23e+01  5.85e+04     4s
   2  -4.72490102e+06  1.39859435e+08  2.99e+04 8.80e-01  2.17e+04     4s
   3  -1.00514293e+06  1.05316774e+08  2.75e+03 1.74e+00  2.41e+03     4s
   4  -5.72264089e+05  7.57111746e+07  7.28e+02 9.21e-01  8.46e+02     4s
   5  -4.49660228e+05  3.94402331e+07  3.45e+02 3.81e-01  3.93e+02     4s
   6  -3.48563052e+05  2.98745396e+07  8.89e+01 2.63e-01  1.96e+02     4s
   7  -2.91017361e+05  2.05550372e+07  3.41e+01 1.73e-01  1.18e+02     4s
   8  -1.69779540e+05  1.45540768e+07  2.53e+00 1.20e-01  7.35e+01     4s
   9  -1.33206843e+05  6.98613738e+06  1.42e+00 5.71e-02  3.54e+01     4s
  10  -8.79214088e+04  3.01050142e+06  8.66e-01 2.43e-02  1.53e+01     4s
  11  -4.38113818e+04  1.24837305e+06  3.69e-01 9.76e-03  6.38e+00     4s
  12  -1.48842590e+04  4.24506703e+05  1.76e-01 3.11e-03  2.17e+00     4s
  13   3.76501877e+01  2.43453883e+05  1.04e-01 1.79e-03  1.20e+00     4s
  14   1.21097231e+04  2.04889641e+05  7.09e-02 1.36e-03  9.51e-01     4s
  15   1.89415769e+04  1.49049163e+05  5.53e-02 2.24e-03  6.42e-01     4s
  16   2.80789591e+04  1.20317923e+05  3.95e-02 1.58e-03  4.55e-01     4s
  17   3.41730929e+04  1.06475582e+05  3.03e-02 1.23e-03  3.57e-01     5s
  18   3.90202764e+04  8.91273794e+04  2.35e-02 7.91e-04  2.47e-01     5s
  19   4.37531521e+04  7.79094925e+04  1.74e-02 6.53e-04  1.68e-01     5s
  20   4.79376048e+04  7.36842397e+04  1.21e-02 5.11e-04  1.27e-01     5s
  21   4.93222968e+04  6.73341051e+04  1.04e-02 6.15e-04  8.88e-02     5s
  22   5.18195234e+04  6.47641025e+04  7.47e-03 4.35e-04  6.38e-02     5s
  23   5.23116947e+04  6.38314310e+04  6.90e-03 4.23e-04  5.68e-02     5s
  24   5.28252272e+04  6.32489177e+04  6.29e-03 3.80e-04  5.14e-02     5s
  25   5.39228081e+04  6.21626165e+04  5.07e-03 2.97e-04  4.06e-02     5s
  26   5.44012731e+04  6.18742525e+04  4.54e-03 2.72e-04  3.69e-02     5s
  27   5.50957823e+04  6.16794603e+04  3.78e-03 2.55e-04  3.25e-02     5s
  28   5.68477038e+04  6.01481877e+04  1.91e-03 2.52e-04  1.63e-02     5s
  29   5.76603435e+04  5.97090586e+04  1.06e-03 1.69e-04  1.01e-02     6s
  30   5.78080539e+04  5.94699673e+04  9.09e-04 1.28e-04  8.20e-03     6s
  31   5.81314642e+04  5.92321425e+04  5.87e-04 8.54e-05  5.43e-03     6s
  32   5.81496300e+04  5.91278868e+04  5.68e-04 6.69e-05  4.82e-03     6s
  33   5.83400534e+04  5.90022731e+04  3.80e-04 4.29e-05  3.27e-03     6s
  34   5.85441149e+04  5.89189023e+04  1.88e-04 2.83e-05  1.85e-03     6s
  35   5.86358188e+04  5.88078902e+04  9.87e-05 8.21e-06  8.49e-04     6s
  36   5.86401318e+04  5.88032263e+04  9.49e-05 7.50e-06  8.04e-04     6s
  37   5.86494957e+04  5.88004480e+04  8.66e-05 7.08e-06  7.44e-04     6s
  38   5.86576645e+04  5.87966173e+04  7.95e-05 6.50e-06  6.85e-04     6s
  39   5.86809432e+04  5.87852189e+04  5.93e-05 4.77e-06  5.14e-04     6s
  40   5.86973454e+04  5.87726057e+04  4.54e-05 2.83e-06  3.71e-04     6s
  41   5.87254280e+04  5.87640736e+04  2.26e-05 1.49e-06  1.91e-04     6s
  42   5.87508578e+04  5.87563349e+04  2.13e-06 3.01e-07  2.70e-05     7s
  43   5.87533114e+04  5.87544886e+04  5.29e-07 1.68e-07  5.80e-06     7s
  44   5.87540034e+04  5.87542882e+04  8.70e-08 6.71e-08  1.40e-06     7s
  45   5.87541404e+04  5.87541468e+04  5.60e-09 1.54e-08  3.18e-08     7s
  46   5.87541434e+04  5.87541465e+04  3.76e-06 1.12e-08  1.49e-08     7s
  47   5.87541455e+04  5.87541455e+04  1.28e-08 2.29e-07  1.49e-11     7s

Barrier solved model in 47 iterations and 7.03 seconds (10.47 work units)
Optimal objective 5.87541455e+04


Root crossover log...

  100025 DPushes remaining with DInf 3.6228895e-09                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    1212 PPushes remaining with PInf 1.8265138e-06                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.2835465e-10      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39657    5.8754146e+04   0.000000e+00   0.000000e+00      9s
   39657    5.8754146e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.875415e+04, 39657 iterations, 6.17 seconds (10.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 58754.1455    0  121 -171254.74 58754.1455   134%     -   10s
H    0     0                    -120716.0568 58754.1455   149%     -   10s
H    0     0                    -112859.0626 58754.1455   152%     -   10s
H    0     0                    -112040.2971 58754.1455   152%     -   10s
H    0     0                    -111508.9647 58754.1455   153%     -   10s
H    0     0                    -106648.8083 58754.1455   155%     -   10s
H    0     0                    -106642.2378 58754.1455   155%     -   10s
H    0     0                    -69550.30504 58754.1455   184%     -   10s
H    0     0                    -69424.85734 58754.1455   185%     -   10s
H    0     0                    -10008.84071 58754.1455   687%     -   10s
H    0     0                    -9754.671901 58754.1455   702%     -   10s
H    0     0                    -5272.173895 58754.1455  1214%     -   11s
H    0     0                    -2120.050228 58754.1455  2871%     -   11s
H    0     0                    8439.7839794 58754.1455   596%     -   11s
H    0     0                    10207.014032 58754.1455   476%     -   11s
H    0     0                    11475.975540 58754.1455   412%     -   11s
H    0     0                    11513.993743 58754.1455   410%     -   13s
H    0     0                    11532.848927 58754.1455   409%     -   13s
H    0     0                    11554.530684 58754.1455   408%     -   13s
H    0     0                    11597.446325 58754.1455   407%     -   13s
H    0     0                    11637.976144 54863.1624   371%     -   53s
H    0     0                    11806.778921 54863.1624   365%     -   53s
     0     0 54850.4657    0  215 11806.7789 54850.4657   365%     -   53s
H    0     0                    12172.607172 54850.4657   351%     -   54s
H    0     0                    12754.804607 54850.4657   330%     -   54s
H    0     0                    14954.704555 54850.4657   267%     -   54s
H    0     0                    15123.507331 54850.4657   263%     -   54s
     0     0 54541.2264    0  218 15123.5073 54541.2264   261%     -   69s
     0     0 54510.7969    0  215 15123.5073 54510.7969   260%     -   80s
     0     0 54345.1241    0  209 15123.5073 54345.1241   259%     -   98s
     0     0 54345.1241    0  219 15123.5073 54345.1241   259%     -  104s
     0     0 54345.1241    0  212 15123.5073 54345.1241   259%     -  105s
     0     0 54345.1241    0  212 15123.5073 54345.1241   259%     -  106s
H    0     0                    15478.095173 51211.9036   231%     -  160s
H    0     0                    15557.414920 51211.9036   229%     -  160s
     0     0 51211.9036    0  275 15557.4149 51211.9036   229%     -  160s
H    0     0                    20490.676946 51211.6395   150%     -  160s
H    0     0                    20657.248693 51211.6395   148%     -  160s
H    0     0                    20905.832018 51211.6395   145%     -  160s
H    0     0                    20910.092317 51211.6395   145%     -  160s
     0     0 50197.6036    0  316 20910.0923 50197.6036   140%     -  203s
     0     0 49751.4838    0  316 20910.0923 49751.4838   138%     -  227s
     0     0 49623.8450    0  286 20910.0923 49623.8450   137%     -  236s
     0     0 49554.9190    0  288 20910.0923 49554.9190   137%     -  244s
     0     0 49549.8408    0  284 20910.0923 49549.8408   137%     -  247s
H    0     0                    21168.173320 49513.9738   134%     -  253s
     0     0 49513.9738    0  289 21168.1733 49513.9738   134%     -  253s
     0     0 49505.9791    0  287 21168.1733 49505.9791   134%     -  255s
     0     0 49498.7282    0  289 21168.1733 49498.7282   134%     -  258s
     0     0 49498.3373    0  298 21168.1733 49498.3373   134%     -  259s
H    0     0                    21209.710362 47080.8889   122%     -  324s
     0     0 47080.8889    0  377 21209.7104 47080.8889   122%     -  324s
H    0     0                    21249.454852 47080.8393   122%     -  325s
     0     0 46379.4027    0  325 21249.4549 46379.4027   118%     -  364s
     0     0 46174.8145    0  444 21249.4549 46174.8145   117%     -  387s
     0     0 46072.7668    0  440 21249.4549 46072.7668   117%     -  405s
     0     0 46025.5159    0  457 21249.4549 46025.5159   117%     -  416s
     0     0 45993.4224    0  449 21249.4549 45993.4224   116%     -  426s
     0     0 45971.9482    0  443 21249.4549 45971.9482   116%     -  433s
     0     0 45942.3972    0  450 21249.4549 45942.3972   116%     -  440s
     0     0 45929.9981    0  461 21249.4549 45929.9981   116%     -  444s
     0     0 45919.9280    0  468 21249.4549 45919.9280   116%     -  449s
     0     0 45886.3649    0  463 21249.4549 45886.3649   116%     -  457s
     0     0 45868.4245    0  403 21249.4549 45868.4245   116%     -  463s
     0     0 45862.1086    0  469 21249.4549 45862.1086   116%     -  467s
     0     0 45859.6696    0  472 21249.4549 45859.6696   116%     -  469s
     0     0 45855.0132    0  478 21249.4549 45855.0132   116%     -  472s
     0     0 45846.7181    0  479 21249.4549 45846.7181   116%     -  476s
     0     0 45821.8874    0  472 21249.4549 45821.8874   116%     -  480s
     0     0 45812.7023    0  455 21249.4549 45812.7023   116%     -  484s
     0     0 45810.2435    0  465 21249.4549 45810.2435   116%     -  485s
     0     0 45810.1745    0  465 21249.4549 45810.1745   116%     -  486s
H    0     0                    21252.695166 45810.1745   116%     -  495s
H    0     0                    21289.075563 44894.1968   111%     -  532s
H    0     0                    21413.934877 44894.1968   110%     -  532s
H    0     0                    21772.826546 44894.1968   106%     -  533s
H    0     0                    22278.630190 44894.1968   102%     -  533s
H    0     0                    22452.029408 44894.1968   100%     -  533s
     0     0 44894.1968    0  490 22452.0294 44894.1968   100%     -  533s
H    0     0                    22508.658403 44743.3784  98.8%     -  551s
     0     0 44743.3784    0  507 22508.6584 44743.3784  98.8%     -  551s
     0     0 44695.1959    0  337 22508.6584 44695.1959  98.6%     -  564s
     0     0 44659.4814    0  392 22508.6584 44659.4814  98.4%     -  579s
     0     0 44642.6554    0  506 22508.6584 44642.6554  98.3%     -  590s
     0     0 44607.3149    0  548 22508.6584 44607.3149  98.2%     -  602s
     0     0 44576.6273    0  385 22508.6584 44576.6273  98.0%     -  613s
     0     0 44561.2201    0  388 22508.6584 44561.2201  98.0%     -  617s
     0     0 44557.5647    0  392 22508.6584 44557.5647  98.0%     -  619s
     0     0 44555.0147    0  388 22508.6584 44555.0147  97.9%     -  620s
     0     0 44545.8593    0  387 22508.6584 44545.8593  97.9%     -  624s
     0     0 44529.8580    0  545 22508.6584 44529.8580  97.8%     -  630s
     0     0 44527.4904    0  551 22508.6584 44527.4904  97.8%     -  633s
     0     0 44526.0475    0  386 22508.6584 44526.0475  97.8%     -  636s
     0     0 44324.1829    0  549 22508.6584 44324.1829  96.9%     -  652s
     0     0 44264.7888    0  557 22508.6584 44264.7888  96.7%     -  665s
     0     0 44235.2309    0  564 22508.6584 44235.2309  96.5%     -  672s
     0     0 44213.8743    0  551 22508.6584 44213.8743  96.4%     -  680s
     0     0 44204.5669    0  551 22508.6584 44204.5669  96.4%     -  684s
H    0     0                    22663.509179 44196.2772  95.0%     -  688s
     0     0 44196.2772    0  551 22663.5092 44196.2772  95.0%     -  688s
     0     0 44193.6101    0  560 22663.5092 44193.6101  95.0%     -  692s
     0     0 44189.9825    0  565 22663.5092 44189.9825  95.0%     -  696s
     0     0 44184.3353    0  562 22663.5092 44184.3353  95.0%     -  700s
     0     0 44180.3141    0  558 22663.5092 44180.3141  94.9%     -  703s
     0     0 44176.0247    0  554 22663.5092 44176.0247  94.9%     -  706s
     0     0 44174.2843    0  562 22663.5092 44174.2843  94.9%     -  707s
     0     0 44027.6260    0  420 22663.5092 44027.6260  94.3%     -  726s
     0     0 43999.2027    0  419 22663.5092 43999.2027  94.1%     -  734s
     0     0 43988.2221    0  425 22663.5092 43988.2221  94.1%     -  738s
H    0     0                    22768.577633 43976.4704  93.1%     -  744s
     0     0 43976.4704    0  393 22768.5776 43976.4704  93.1%     -  744s
     0     0 43967.0991    0  398 22768.5776 43967.0991  93.1%     -  750s
     0     0 43960.9912    0  395 22768.5776 43960.9912  93.1%     -  755s
     0     0 43954.5545    0  396 22768.5776 43954.5545  93.0%     -  758s
     0     0 43952.7160    0  456 22768.5776 43952.7160  93.0%     -  761s
     0     0 43892.5128    0  402 22768.5776 43892.5128  92.8%     -  777s
     0     0 43873.6690    0  400 22768.5776 43873.6690  92.7%     -  783s
     0     0 43866.8912    0  398 22768.5776 43866.8912  92.7%     -  786s
     0     0 43859.5668    0  401 22768.5776 43859.5668  92.6%     -  791s
     0     0 43858.4682    0  395 22768.5776 43858.4682  92.6%     -  792s
     0     0 43841.3953    0  410 22768.5776 43841.3953  92.6%     -  804s
     0     0 43835.5285    0  405 22768.5776 43835.5285  92.5%     -  810s
     0     0 43834.3163    0  408 22768.5776 43834.3163  92.5%     -  813s
     0     0 43823.3876    0  401 22768.5776 43823.3876  92.5%     -  823s
     0     0 43815.5788    0  400 22768.5776 43815.5788  92.4%     -  829s
     0     0 43813.0821    0  401 22768.5776 43813.0821  92.4%     -  832s
     0     0 43807.1966    0  402 22768.5776 43807.1966  92.4%     -  836s
     0     0 43806.2447    0  402 22768.5776 43806.2447  92.4%     -  838s
     0     0 43802.0449    0  401 22768.5776 43802.0449  92.4%     -  843s
     0     0 43800.9367    0  402 22768.5776 43800.9367  92.4%     -  846s
     0     0 43783.2745    0  401 22768.5776 43783.2745  92.3%     -  855s
     0     0 43783.2459    0  401 22768.5776 43783.2459  92.3%     -  857s
H    0     0                    22865.319485 43783.2459  91.5%     -  978s
H    0     0                    23317.603701 43783.2459  87.8%     -  980s
H    0     2                    24132.192359 43783.2459  81.4%     -  982s
     0     2 43783.2459    0  401 24132.1924 43783.2459  81.4%     -  982s
     1     3 42572.5867    1  511 24132.1924 43783.2098  81.4% 31455 1021s
     2     4 43490.9152    1  399 24132.1924 43490.9152  80.2% 21148 1037s
     3     7 43343.7220    2  391 24132.1924 43490.3103  80.2% 17305 1055s
     6    12 43204.0745    3  394 24132.1924 43353.5571  79.7% 13836 1080s
    11    24 43143.5939    4  384 24132.1924 43353.4376  79.6% 13109 1114s
    23    36 42817.9626    5  390 24132.1924 43143.6217  78.8% 18272 2141s
H   35    67                    24857.925226 43143.6217  73.6% 21398 2286s
H   37    67                    24963.944793 43143.6217  72.8% 21547 2286s
H   39    67                    24978.714800 43143.6217  72.7% 21415 2286s
    66   148 42924.6534    6  396 24978.7148 43043.2160  72.3% 25372 2362s
   147   239 42891.3418    8  380 24978.7148 43019.9744  72.2% 16580 2407s
H  163   239                    25032.279274 43019.9744  71.9% 15717 2407s
H  172   239                    25086.533441 43019.9744  71.5% 15344 2407s
   238   314 42422.9236   11  360 25086.5334 43019.9744  71.5% 13926 2443s
   313   395 42271.1792   14  356 25086.5334 43019.9744  71.5% 12288 2469s
H  340   395                    25178.713942 43019.9744  70.9% 11809 2469s
   394   464 42041.9420   17  343 25178.7139 43019.9744  70.9% 11101 2497s
   463   494 40871.6545   20  316 25178.7139 43019.9744  70.9% 10430 2517s
H  466   494                    25273.043671 43019.9744  70.2% 10406 2517s
H  472   494                    25292.762554 43019.9744  70.1% 10405 2517s
   493   556 41685.1129   19  330 25292.7626 43019.9744  70.1% 10403 2543s
   555   584 41643.5645   20  473 25292.7626 43019.9744  70.1% 10224 2564s
   583   632 41606.0369   21  331 25292.7626 43019.9744  70.1% 10264 2583s
   631   662 41537.3592   22  329 25292.7626 43019.9744  70.1% 10136 2600s
   663   721 41415.9784   23  321 25292.7626 43019.9744  70.1% 10021 2620s
   722   753 41270.6881   24  318 25292.7626 43019.9744  70.1%  9689 2640s
   754   799 41164.3769   25  463 25292.7626 43019.9744  70.1%  9702 2662s
   800   836 40814.1349   26  447 25292.7626 43019.9744  70.1%  9654 2682s
   839   899 40529.5385   27  453 25292.7626 43019.9744  70.1%  9511 2701s
   904   966 39792.4063   29  449 25292.7626 43019.9744  70.1%  9305 2720s
   983  1002 39599.1948   30  459 25292.7626 43019.9744  70.1%  9086 2743s
  1055  1023 39404.9833   31  454 25292.7626 43019.9744  70.1%  9006 2770s
  1083  1047 39357.7281   32  448 25292.7626 43019.9744  70.1%  9171 2792s
  1113  1085 39283.9687   33  372 25292.7626 43019.9744  70.1%  9210 2822s
  1159  1147 32652.6756   34  406 25292.7626 43019.9744  70.1%  9233 2848s
  1229  1217 32528.8161   35  449 25292.7626 43019.9744  70.1%  9052 2876s
  1321  1275 32122.4746   36  279 25292.7626 43019.9744  70.1%  8854 2907s
  1419  1337 31723.7028   37  397 25292.7626 43019.9744  70.1%  8766 2941s
  1528  1373 31194.1718   38  334 25292.7626 43019.9744  70.1%  8562 2973s
  1600  1424 29974.5161   39  220 25292.7626 42947.8000  69.8%  8675 3008s
  1667  1485 29503.8695   41  218 25292.7626 42947.8000  69.8%  8850 3040s
  1746  1561 28948.9988   46  201 25292.7626 42947.8000  69.8%  9025 3069s
  1846  1656 27614.1080   49  172 25292.7626 42947.8000  69.8%  9029 3106s
  1957  1683 26824.9958   54  150 25292.7626 42947.8000  69.8%  9067 3140s
H 1963  1683                    25414.479246 42947.8000  69.0%  9083 3140s
  1994  1731     cutoff   55      25414.4792 42928.6598  68.9%  9167 3230s
  2086  1826     cutoff   56      25414.4792 42928.6598  68.9%  9153 3270s
  2224  1938 38191.2547   10  455 25414.4792 42928.6598  68.9%  9135 3314s
  2366  2059 37638.6501   12  324 25414.4792 42891.1964  68.8%  9126 3359s
  2525  2150 35766.9112   13  308 25414.4792 42820.6601  68.5%  9131 3409s
  2678  2247 36744.9592   15  457 25414.4792 42820.6601  68.5%  9144 3462s
  2831  2366 35645.0897   18  240 25414.4792 42820.6601  68.5%  9166 3513s
  3002  2462 34871.9852   20  239 25414.4792 42625.4737  67.7%  9151 3572s
  3152  2535 34147.5293   24  415 25414.4792 42625.4737  67.7%  9199 3600s

Cutting planes:
  Learned: 2
  Gomory: 4
  Implied bound: 100
  MIR: 2326
  Flow cover: 2632
  RLT: 60
  Relax-and-lift: 527

Explored 3251 nodes (30483233 simplex iterations) in 3600.06 seconds (7519.53 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25414.5 25292.8 25273 ... 24132.2

Time limit reached
Best objective 2.541447924601e+04, best bound 4.262547371789e+04, gap 67.7212%
  WARNING: Time limit reached. Using best solution found (gap: 67.72%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.10s
  Master Objective (UB) = 25414.48, θ = 184290.49
  Upper Bound (UB) = 25414.48

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 184290.49
  [DEBUG]   ✓ Scenario 0: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 184290.49 ≤ Q = 184290.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 184290.49 ≤ Q = 184290.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 184290.49 ≤ Q = 184290.49 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 184290.49 ≤ Q = 184290.49 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x527a777f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x527a777f
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.264505e+13
Presolve removed 2623 rows and 1914 columns
Presolve time: 0.00s
Presolved: 470 rows, 475 columns, 1328 nonzeros
Found heuristic solution: objective 5570659.3279
Variable types: 323 continuous, 152 integer (152 binary)

Root relaxation: objective -1.638325e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163832.53    0  123 5570659.33 -163832.53   103%     -    0s
H    0     0                    -132181.8107 -163832.53  23.9%     -    0s
H    0     0                    -132556.9443 -163832.53  23.6%     -    0s
H    0     0                    -144471.3262 -145926.05  1.01%     -    0s
     0     0 -145926.05    0   47 -144471.33 -145926.05  1.01%     -    0s
H    0     0                    -144768.9500 -145828.95  0.73%     -    0s
H    0     0                    -144924.9198 -145828.95  0.62%     -    0s
     0     0 -145156.06    0   62 -144924.92 -145156.06  0.16%     -    0s
     0     0 -145032.14    0   32 -144924.92 -145032.14  0.07%     -    0s
     0     0 -144965.42    0   14 -144924.92 -144965.42  0.03%     -    0s
     0     0 -144952.32    0    7 -144924.92 -144952.32  0.02%     -    0s
H    0     0                    -144937.3239 -144951.91  0.01%     -    0s
     0     0 -144939.47    0    5 -144937.32 -144939.47  0.00%     -    0s
     0     0 -144937.50    0    2 -144937.32 -144937.50  0.00%     -    0s
     0     0     cutoff    0      -144937.32 -144937.32  0.00%     -    0s

Cutting planes:
  Gomory: 8
  MIR: 142
  Flow cover: 10
  RLT: 2
  Relax-and-lift: 9
  BQP: 4

Explored 1 nodes (489 simplex iterations) in 0.03 seconds (0.02 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -144937 -144925 -144471 ... 1.26451e+13
No other solutions better than -144937

Optimal solution found (tolerance 1.00e-06)
Best objective -1.449373238506e+05, best bound -1.449373238506e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 174329.63
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -144937.32
  [DEBUG]   S×d_nominal = 319266.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 319266.95 + -144937.32 = 174329.63
  [DEBUG]   Current θ from Master = 184290.49
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9960.87 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 15453.61
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 327.6179, Absolute Gap = 327.6179, Relative Gap = 0.012891
  Not converged yet (gap = 327.62 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653804 nonzeros
Model fingerprint: 0x3059128d
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 112110 rows and 45510 columns
Presolve time: 1.94s
Presolved: 118623 rows, 50350 columns, 732174 nonzeros
Variable types: 48091 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.30s

Barrier statistics:
 Dense cols : 557
 AA' NZ     : 6.044e+06
 Factor NZ  : 1.360e+07 (roughly 180 MB of memory)
 Factor Ops : 3.721e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.84000269e+07  2.12332879e+08  1.28e+05 2.04e+01  8.63e+04     3s
   1  -1.43211927e+07  1.97255433e+08  9.15e+04 8.98e+01  6.13e+04     4s
   2  -4.86819201e+06  1.49743825e+08  3.09e+04 8.00e-01  2.23e+04     4s
   3  -1.04200902e+06  1.13000419e+08  3.14e+03 1.68e+00  2.68e+03     4s
   4  -5.82111691e+05  7.91555425e+07  7.68e+02 7.81e-01  8.58e+02     4s
   5  -5.07231834e+05  4.80838271e+07  4.97e+02 4.00e-01  5.13e+02     4s
   6  -3.94870167e+05  3.18204584e+07  1.47e+02 2.30e-01  2.27e+02     4s
   7  -3.24903940e+05  2.26338789e+07  4.21e+01 1.54e-01  1.26e+02     4s
   8  -2.16454388e+05  1.60502466e+07  7.06e+00 1.05e-01  7.77e+01     4s
   9  -1.72021825e+05  7.99038723e+06  3.18e+00 5.09e-02  3.83e+01     4s
  10  -1.11155621e+05  6.37015315e+06  1.41e+00 3.99e-02  3.01e+01     4s
  11  -9.88811868e+04  2.58593416e+06  1.02e+00 1.62e-02  1.25e+01     4s
  12  -6.10559757e+04  1.44886832e+06  3.12e-01 8.59e-03  6.97e+00     4s
  13  -4.02004887e+04  4.28178480e+05  1.58e-01 2.49e-03  2.16e+00     4s
  14  -1.32656215e+04  2.71211714e+05  9.75e-02 1.76e-03  1.31e+00     4s
  15  -6.51191076e+03  1.95929404e+05  8.51e-02 1.11e-03  9.34e-01     4s
  16   1.31093593e+04  1.63299493e+05  5.51e-02 1.54e-03  6.93e-01     5s
  17   2.08130990e+04  1.24985030e+05  4.31e-02 1.19e-03  4.81e-01     5s
  18   2.83459646e+04  1.08324670e+05  3.25e-02 9.45e-04  3.69e-01     5s
  19   3.24198153e+04  8.69463389e+04  2.69e-02 7.23e-04  2.52e-01     5s
  20   3.93756668e+04  7.89247666e+04  1.85e-02 5.34e-04  1.82e-01     5s
  21   4.15657275e+04  7.19583039e+04  1.59e-02 5.53e-04  1.40e-01     5s
  22   4.51716608e+04  6.80958638e+04  1.18e-02 4.19e-04  1.06e-01     5s
  23   4.76404627e+04  6.42874631e+04  9.12e-03 2.78e-04  7.68e-02     5s
  24   5.01101263e+04  6.28240366e+04  6.51e-03 2.27e-04  5.87e-02     5s
  25   5.14588923e+04  5.98558971e+04  5.11e-03 1.45e-04  3.88e-02     5s
  26   5.26551572e+04  5.90429516e+04  3.94e-03 1.04e-04  2.95e-02     5s
  27   5.42753486e+04  5.81733944e+04  2.36e-03 6.14e-05  1.80e-02     6s
  28   5.48102443e+04  5.76259837e+04  1.87e-03 5.16e-05  1.30e-02     6s
  29   5.55180051e+04  5.73813018e+04  1.23e-03 3.38e-05  8.60e-03     6s
  30   5.57908830e+04  5.72374500e+04  9.83e-04 2.27e-05  6.68e-03     6s
  31   5.61267221e+04  5.71348578e+04  6.79e-04 1.52e-05  4.65e-03     6s
  32   5.65568967e+04  5.69867697e+04  2.94e-04 7.03e-06  1.98e-03     6s
  33   5.68176320e+04  5.69365009e+04  7.35e-05 3.78e-06  5.49e-04     6s
  34   5.68445618e+04  5.69246351e+04  5.12e-05 3.27e-06  3.70e-04     6s
  35   5.68640702e+04  5.69188673e+04  3.60e-05 3.13e-06  2.53e-04     6s
  36   5.69028792e+04  5.69167962e+04  6.61e-06 2.39e-06  6.42e-05     6s
  37   5.69107292e+04  5.69147506e+04  1.59e-06 1.37e-06  1.86e-05     7s
  38   5.69126806e+04  5.69135735e+04  2.85e-07 2.87e-07  4.12e-06     7s
  39   5.69131572e+04  5.69132693e+04  3.77e-08 3.34e-08  5.17e-07     7s
  40   5.69132452e+04  5.69132454e+04  6.16e-10 2.25e-09  9.35e-10     7s

Barrier solved model in 40 iterations and 6.87 seconds (10.93 work units)
Optimal objective 5.69132452e+04


Root crossover log...

  109519 DPushes remaining with DInf 0.0000000e+00                 7s
    3507 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                11s

    4914 PPushes remaining with PInf 5.3840581e-05                11s
       0 PPushes remaining with PInf 0.0000000e+00                11s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.0882507e+01     11s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   59665    5.6913245e+04   0.000000e+00   8.088251e+01     12s
   59710    5.6913245e+04   0.000000e+00   0.000000e+00     12s
   59710    5.6913245e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 5.691325e+04, 59710 iterations, 9.17 seconds (16.67 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56913.2454    0   73 -171254.74 56913.2454   133%     -   12s
H    0     0                    -170115.3201 56913.2454   133%     -   12s
H    0     0                    -166511.0203 56913.2454   134%     -   12s
H    0     0                    -163836.5324 56913.2454   135%     -   12s
H    0     0                    -163624.8442 56913.2454   135%     -   13s
H    0     0                    -163423.5512 56913.2454   135%     -   13s
H    0     0                    -163321.2270 56913.2454   135%     -   13s
H    0     0                    -162560.6416 56913.2454   135%     -   13s
H    0     0                    -162451.9680 56913.2454   135%     -   13s
H    0     0                    -73587.60516 56913.2454   177%     -   13s
H    0     0                    -283.6020166 56913.2454      -     -   13s
H    0     0                    11966.112031 56913.2454   376%     -   13s
H    0     0                    12131.934524 56913.2454   369%     -   15s
H    0     0                    12168.781666 52878.6421   335%     -   45s
H    0     0                    12362.463304 52878.6421   328%     -   45s
     0     0 52878.6421    0  185 12362.4633 52878.6421   328%     -   45s
     0     0 52378.6887    0  193 12362.4633 52378.6887   324%     -   59s
     0     0 52329.6772    0  195 12362.4633 52329.6772   323%     -   69s
     0     0 52329.6772    0  198 12362.4633 52329.6772   323%     -   70s
     0     0 52329.6772    0  194 12362.4633 52329.6772   323%     -   70s
H    0     0                    13674.130676 49592.3160   263%     -  111s
H    0     0                    14214.323724 49592.3160   249%     -  111s
H    0     0                    14468.907559 49592.3160   243%     -  111s
     0     0 49592.3160    0  236 14468.9076 49592.3160   243%     -  111s
H    0     0                    15749.028875 49592.2009   215%     -  112s
H    0     0                    16952.098722 49592.2009   193%     -  112s
H    0     0                    17162.625494 49592.2009   189%     -  112s
H    0     0                    17164.065547 49592.2009   189%     -  112s
     0     0 48903.9095    0  249 17164.0655 48903.9095   185%     -  135s
     0     0 48818.0025    0  251 17164.0655 48818.0025   184%     -  143s
     0     0 48608.2527    0  259 17164.0655 48608.2527   183%     -  160s
     0     0 48519.6210    0  250 17164.0655 48519.6210   183%     -  169s
     0     0 48503.4927    0  255 17164.0655 48503.4927   183%     -  171s
     0     0 48500.1745    0  256 17164.0655 48500.1745   183%     -  173s
     0     0 48500.0852    0  254 17164.0655 48500.0852   183%     -  173s
H    0     0                    17752.502714 46740.9629   163%     -  214s
H    0     0                    17949.360598 46740.9629   160%     -  214s
H    0     0                    18091.759905 46740.9629   158%     -  214s
H    0     0                    18421.560398 46740.9629   154%     -  214s
H    0     0                    18465.529527 46740.9629   153%     -  214s
H    0     0                    18715.000368 46740.9629   150%     -  214s
H    0     0                    18726.347690 46740.9629   150%     -  214s
     0     0 46740.9629    0  402 18726.3477 46740.9629   150%     -  214s
H    0     0                    19181.377240 46740.9163   144%     -  215s
H    0     0                    19273.654550 46740.9163   143%     -  215s
H    0     0                    19499.533697 46740.9163   140%     -  215s
H    0     0                    19611.296482 46740.9163   138%     -  215s
H    0     0                    19683.396782 46740.9163   137%     -  215s
H    0     0                    19795.256571 46740.9163   136%     -  215s
     0     0 46347.7769    0  329 19795.2566 46347.7769   134%     -  234s
     0     0 46228.1886    0  321 19795.2566 46228.1886   134%     -  244s
     0     0 46113.7450    0  394 19795.2566 46113.7450   133%     -  256s
     0     0 46082.1930    0  402 19795.2566 46082.1930   133%     -  262s
     0     0 46057.5412    0  330 19795.2566 46057.5412   133%     -  266s
     0     0 46017.2241    0  327 19795.2566 46017.2241   132%     -  271s
     0     0 46006.3284    0  321 19795.2566 46006.3284   132%     -  273s
     0     0 46003.3098    0  329 19795.2566 46003.3098   132%     -  275s
     0     0 45995.5897    0  323 19795.2566 45995.5897   132%     -  277s
     0     0 45995.1398    0  395 19795.2566 45995.1398   132%     -  278s
     0     0 44983.8000    0  355 19795.2566 44983.8000   127%     -  310s
     0     0 44735.4156    0  358 19795.2566 44735.4156   126%     -  323s
     0     0 44675.0509    0  363 19795.2566 44675.0509   126%     -  331s
     0     0 44564.8237    0  371 19795.2566 44564.8237   125%     -  342s
     0     0 44506.7332    0  376 19795.2566 44506.7332   125%     -  352s
     0     0 44492.8907    0  363 19795.2566 44492.8907   125%     -  356s
     0     0 44468.1907    0  374 19795.2566 44468.1907   125%     -  362s
     0     0 44462.0798    0  374 19795.2566 44462.0798   125%     -  363s
     0     0 44459.4899    0  371 19795.2566 44459.4899   125%     -  365s
     0     0 44455.8881    0  371 19795.2566 44455.8881   125%     -  368s
     0     0 44444.9353    0  368 19795.2566 44444.9353   125%     -  370s
     0     0 44442.9815    0  371 19795.2566 44442.9815   125%     -  372s
     0     0 44438.6849    0  378 19795.2566 44438.6849   124%     -  373s
     0     0 44435.3633    0  382 19795.2566 44435.3633   124%     -  375s
     0     0 44434.4662    0  381 19795.2566 44434.4662   124%     -  376s
     0     0 44301.6630    0  401 19795.2566 44301.6630   124%     -  387s
H    0     0                    20262.634669 44301.4130   119%     -  387s
H    0     0                    20302.053918 44301.4130   118%     -  387s
H    0     0                    21028.184137 44247.9858   110%     -  394s
H    0     0                    21211.597422 44247.9858   109%     -  394s
H    0     0                    22086.795363 44247.9858   100%     -  394s
H    0     0                    22136.387145 44247.9858   100%     -  394s
     0     0 44247.9858    0  402 22136.3871 44247.9858   100%     -  394s
     0     0 44222.9849    0  401 22136.3871 44222.9849   100%     -  400s
     0     0 44208.8866    0  405 22136.3871 44208.8866   100%     -  402s
     0     0 44203.7731    0  403 22136.3871 44203.7731   100%     -  404s
     0     0 44202.2020    0  410 22136.3871 44202.2020   100%     -  404s
     0     0 44199.6240    0  382 22136.3871 44199.6240   100%     -  406s
     0     0 44192.7134    0  409 22136.3871 44192.7134   100%     -  408s
     0     0 44190.9274    0  408 22136.3871 44190.9274   100%     -  410s
     0     0 44189.7270    0  413 22136.3871 44189.7270   100%     -  411s
H    0     0                    23200.867621 44115.5494  90.1%     -  420s
     0     0 44115.5494    0  387 23200.8676 44115.5494  90.1%     -  420s
     0     0 44072.7985    0  395 23200.8676 44072.7985  90.0%     -  428s
H    0     0                    23473.775590 44060.2056  87.7%     -  431s
     0     0 44060.2056    0  394 23473.7756 44060.2056  87.7%     -  431s
     0     0 44048.5935    0  392 23473.7756 44048.5935  87.7%     -  436s
     0     0 44044.7491    0  398 23473.7756 44044.7491  87.6%     -  438s
     0     0 44036.8200    0  457 23473.7756 44036.8200  87.6%     -  441s
     0     0 44034.4630    0  397 23473.7756 44034.4630  87.6%     -  442s
     0     0 44032.8577    0  395 23473.7756 44032.8577  87.6%     -  443s
     0     0 44032.3267    0  397 23473.7756 44032.3267  87.6%     -  444s
     0     0 43994.5733    0  388 23473.7756 43994.5733  87.4%     -  449s
H    0     0                    24042.809674 43992.0146  83.0%     -  450s
H    0     0                    24558.337201 43992.0146  79.1%     -  450s
H    0     0                    24679.199856 43992.0146  78.3%     -  450s
H    0     0                    24685.640494 43992.0146  78.2%     -  450s
H    0     0                    24791.586786 43992.0146  77.4%     -  450s
     0     0 43976.5039    0  401 24791.5868 43976.5039  77.4%     -  454s
     0     0 43970.3117    0  460 24791.5868 43970.3117  77.4%     -  457s
     0     0 43967.4051    0  467 24791.5868 43967.4051  77.3%     -  458s
     0     0 43966.0580    0  401 24791.5868 43966.0580  77.3%     -  460s
     0     0 43937.3993    0  458 24791.5868 43937.3993  77.2%     -  465s
     0     0 43916.3921    0  490 24791.5868 43916.3921  77.1%     -  470s
     0     0 43911.6835    0  396 24791.5868 43911.6835  77.1%     -  473s
     0     0 43910.5924    0  396 24791.5868 43910.5924  77.1%     -  474s
     0     0 43888.3554    0  463 24791.5868 43888.3554  77.0%     -  480s
     0     0 43879.9622    0  495 24791.5868 43879.9622  77.0%     -  484s
     0     0 43876.7118    0  496 24791.5868 43876.7118  77.0%     -  486s
     0     0 43876.4805    0  496 24791.5868 43876.4805  77.0%     -  487s
     0     0 43867.5220    0  413 24791.5868 43867.5220  76.9%     -  490s
     0     0 43865.5854    0  397 24791.5868 43865.5854  76.9%     -  492s
     0     0 43861.8834    0  399 24791.5868 43861.8834  76.9%     -  493s
     0     0 43860.9517    0  401 24791.5868 43860.9517  76.9%     -  493s
     0     0 43856.0367    0  400 24791.5868 43856.0367  76.9%     -  496s
     0     0 43855.5458    0  400 24791.5868 43855.5458  76.9%     -  497s
     0     0 43853.7275    0  399 24791.5868 43853.7275  76.9%     -  499s
     0     0 43852.1310    0  397 24791.5868 43852.1310  76.9%     -  505s
     0     0 43851.9209    0  396 24791.5868 43851.9209  76.9%     -  507s
     0     0 43850.6053    0  396 24791.5868 43850.6053  76.9%     -  509s
H    0     0                    24906.669695 43850.6053  76.1%     -  612s
     0     2 43850.6053    0  396 24906.6697 43850.6053  76.1%     -  616s
     1     3 43501.9887    1  390 24906.6697 43850.6053  76.1%  8655  625s
     2     4 43630.2296    1  388 24906.6697 43630.2296  75.2%  7505  632s
     3     7 42652.7905    2  362 24906.6697 43630.2030  75.2%  8897  647s
     6    13 43173.1127    3  376 24906.6697 43630.2030  75.2% 10940  669s
    12    26 42621.2443    4  359 24906.6697 43494.4783  74.6% 11876  690s
    25    39 43049.7139    5  372 24906.6697 43400.2203  74.3% 17525  741s
    38    70 41106.6655    6  363 24906.6697 43400.2203  74.3% 16719  849s
H   44    70                    25013.508196 43400.2203  73.5% 16370  849s
H   48    70                    25082.969851 43400.2203  73.0% 16311  849s
    69   182 41104.3718    7  351 25082.9699 43187.4944  72.2% 18876  902s
   181   261 41019.2365   11  339 25082.9699 43173.8452  72.1% 11256  928s
   260   295 40679.4943   13  327 25082.9699 43173.8452  72.1%  9897  949s
   294   323 39348.0312   14  302 25082.9699 43173.8452  72.1%  9548  968s
   322   358 40364.1996   14  320 25082.9699 43173.8452  72.1%  9505  988s
   357   388 40202.4904   15  330 25082.9699 43173.8452  72.1%  9422 1007s
   387   429 40107.2473   16  330 25082.9699 43173.8452  72.1%  9172 1029s
   428   460 40070.4715   17  318 25082.9699 43173.8452  72.1%  8908 1046s
   459   504 40018.2410   18  316 25082.9699 43173.8452  72.1%  8790 1063s
   503   548 39312.6300   20  309 25082.9699 43173.8452  72.1%  8641 1087s
   547   588 39187.2829   21  306 25082.9699 43173.8452  72.1%  8584 1109s
   587   623 37740.3620   20  294 25082.9699 43173.8452  72.1%  8595 1131s
   626   662 37568.0938   21  295 25082.9699 43173.8452  72.1%  8621 1152s
   671   707 35904.2191   22  295 25082.9699 43173.8452  72.1%  8700 1174s
   716   759 34995.2231   23  278 25082.9699 43173.8452  72.1%  8692 1191s
   768   816 32215.4096   25  276 25082.9699 43173.8452  72.1%  8564 1209s
H  780   816                    25358.869581 43173.8452  70.3%  8539 1209s
   825   895 31812.1682   29  255 25358.8696 43173.8452  70.3%  8476 1229s
   917   969 26965.4973   29  250 25358.8696 43173.8452  70.3%  8248 1251s
  1003  1020 36886.8526   22  234 25358.8696 43173.8452  70.3%  8154 1281s
  1058  1110 36788.0421   23  225 25358.8696 43173.8452  70.3%  8069 1299s
  1158  1201 35307.5175   25  223 25358.8696 43173.8452  70.3%  7888 1324s
  1275  1281 34678.4870   27  215 25358.8696 43173.8452  70.3%  7705 1347s
  1383  1382 33483.1286   29  198 25358.8696 43173.8452  70.3%  7536 1372s
  1508  1502 28616.6090   29  173 25358.8696 43173.8452  70.3%  7399 1393s
  1657  1528 33037.0477   31  163 25358.8696 43173.8452  70.3%  7168 1420s
  1691  1562 32933.9551   31  159 25358.8696 43173.8452  70.3%  7232 1440s
  1741  1592 32889.6636   32  151 25358.8696 43173.8452  70.3%  7218 1465s
  1785  1627 32458.6048   33  148 25358.8696 42835.5811  68.9%  7237 1493s
  1824  1656 33012.6871   32  157 25358.8696 42835.5811  68.9%  7258 1517s
  1865  1718 32644.2939   33  155 25358.8696 42835.5811  68.9%  7270 1540s
  1956  1786 32482.4124   35  147 25358.8696 42835.5811  68.9%  7115 1569s
  2074  1851 31616.0252   41  132 25358.8696 42835.5811  68.9%  6987 1599s
  2165  1928 29923.8008   45  123 25358.8696 42835.5811  68.9%  6970 1630s
  2278  2043 29727.9927   51  107 25358.8696 42835.5811  68.9%  6962 1662s
  2421  2227 29287.9069   60   75 25358.8696 42818.6635  68.9%  6902 1695s
  2630  2395 28244.7859   66   77 25358.8696 42582.2314  67.9%  6723 1727s
  2847  2520 28238.8147   77   40 25358.8696 42582.2314  67.9%  6583 1762s
  3053  2632 38451.5402   11  337 25358.8696 42582.2314  67.9%  6509 1803s
  3257  2692 37735.4574   12  364 25358.8696 42453.4871  67.4%  6498 1842s
  3425  2780 36679.1765   13  329 25358.8696 42370.5939  67.1%  6553 1886s
  3607  2863 34783.9653   15  324 25358.8696 42301.5274  66.8%  6591 1931s
  3774  2930 33749.4978   16  306 25358.8696 42301.5274  66.8%  6647 1977s
  3891  3007 31364.4824   19  138 25358.8696 42301.5274  66.8%  6783 2026s
  4016  3089 29883.6455   25  115 25358.8696 42301.5274  66.8%  6925 2078s
  4174  3090 28565.7256   53  396 25358.8696 41970.5823  65.5%  7036 2289s
  4176  3091 38902.9613   17   73 25358.8696 41970.5823  65.5%  7032 2300s
  4177  3092 29132.4444   36  265 25358.8696 41970.5823  65.5%  7031 2354s
  4178  3093 29845.8700   57  264 25358.8696 41970.5823  65.5%  7029 2408s
  4179  3093 26737.7450   58  357 25358.8696 41970.5823  65.5%  7027 2441s
  4180  3094 34522.0304   17  347 25358.8696 41970.5823  65.5%  7026 2462s
  4181  3095 28555.4991   69  425 25358.8696 41970.5823  65.5%  7024 2479s
  4182  3095 28270.2654   39  368 25358.8696 41970.5823  65.5%  7022 2496s
  4183  3096 35965.0598   30  381 25358.8696 41970.5823  65.5%  7020 2508s
  4184  3097 38590.1026   12  379 25358.8696 41970.5823  65.5%  7019 2524s
  4185  3097 41114.4875   16  408 25358.8696 41970.5823  65.5%  7017 2533s
  4186  3098 38832.0212   16  389 25358.8696 41970.5823  65.5%  7015 2538s
  4187  3099 38350.0528   13  413 25358.8696 41970.5823  65.5%  7014 2556s
  4188  3099 27742.3000   61  412 25358.8696 41970.5823  65.5%  7012 2567s
  4189  3100 40416.3818   12  396 25358.8696 41970.5823  65.5%  7010 2573s
  4190  3101 28886.3382   27  432 25358.8696 41970.5823  65.5%  7009 2579s
  4191  3101 34382.1543   47  396 25358.8696 41970.5823  65.5%  7007 2584s
  4192  3102 26778.1858   63  438 25358.8696 41970.5823  65.5%  7005 2589s
  4193  3103 38332.3184   26  457 25358.8696 41970.5823  65.5%  7004 2594s
  4194  3103 28199.0375   53  408 25358.8696 41970.5823  65.5%  7002 2605s
  4195  3104 39106.2142   11  401 25358.8696 41970.5823  65.5%  7000 2610s
  4197  3105 28790.1138   66  391 25358.8696 41970.5823  65.5%  6997 2619s
  4198  3106 26913.8477   53  402 25358.8696 41970.5823  65.5%  6995 2631s
  4199  3107 31345.3113   21  407 25358.8696 41970.5823  65.5%  6994 2636s
  4200  3107 30469.1868   55  405 25358.8696 41970.5823  65.5%  6992 2640s
  4201  3108 26250.0833   65  405 25358.8696 41970.5823  65.5%  6990 2650s
  4202  3109 26220.6821   43  397 25358.8696 41970.5823  65.5%  6989 2657s
  4203  3109 32439.7506   38  399 25358.8696 41970.5823  65.5%  6987 2661s
  4204  3110 38890.3249   16  408 25358.8696 41970.5823  65.5%  6985 2666s
  4205  3111 33804.5982   37  414 25358.8696 41970.5823  65.5%  6984 2678s
  4206  3111 31633.1365   45  442 25358.8696 41970.5823  65.5%  6982 2684s
  4207  3112 40439.1896   21  446 25358.8696 41970.5823  65.5%  6980 2689s
  4208  3113 29795.4598   18  472 25358.8696 41970.5823  65.5%  6979 2700s
  4209  3113 29162.3419   39  443 25358.8696 41970.5823  65.5%  6977 2706s
  4210  3114 28984.5889   50  460 25358.8696 41970.5823  65.5%  6975 2719s
  4211  3115 34818.2146   25  503 25358.8696 41970.5823  65.5%  6974 2726s
  4212  3115 27695.0481   77  474 25358.8696 41970.5823  65.5%  6972 2738s
  4213  3116 28430.0364   26  506 25358.8696 41970.5823  65.5%  6970 2747s
  4214  3117 37567.9650   22  507 25358.8696 41970.5823  65.5%  6969 2760s
  4215  3117 30201.7631   21  507 25358.8696 41970.5823  65.5%  6967 2773s
  4216  3118 28625.4433   36  507 25358.8696 41970.5823  65.5%  6966 2851s
  4217  3122 41970.5823   11  482 25358.8696 41970.5823  65.5%  7052 2905s
  4219  3125 41970.5823   12  423 25358.8696 41970.5823  65.5%  7052 2991s
  4223  3132 41970.5823   13  462 25358.8696 41970.5823  65.5%  7059 3066s
  4231  3145 41970.5823   14  439 25358.8696 41970.5823  65.5%  7090 3141s
  4247  3156 41970.5823   15  444 25358.8696 41970.5823  65.5%  7162 3261s
  4263  3182 39495.8114   16  431 25358.8696 41970.5823  65.5%  7264 3333s
  4295  3316 39315.5466   17  424 25358.8696 41970.5823  65.5%  7368 3405s
  4439  3333 38138.7969   19  361 25358.8696 41970.5823  65.5%  7434 3439s
  4506  3370 38874.0759   21  444 25358.8696 41970.5823  65.5%  7422 3471s
  4566  3397 38119.7880   20  359 25358.8696 41970.5823  65.5%  7430 3498s
  4624  3419 37309.0345   20  326 25358.8696 41970.5823  65.5%  7435 3527s
  4667  3436 38801.8926   22  377 25358.8696 41970.5823  65.5%  7452 3552s
  4699  3456 37993.8826   21  348 25358.8696 41970.5823  65.5%  7513 3573s
  4732  3471 26841.0633   33   74 25358.8696 41970.5823  65.5%  7512 3598s
  4768  3464 32766.6762   35  141 25358.8696 41970.5823  65.5%  7514 3600s

Cutting planes:
  MIR: 1107
  Mixing: 1
  Flow cover: 2060
  RLT: 11
  Relax-and-lift: 182

Explored 4773 nodes (36321585 simplex iterations) in 3600.06 seconds (8882.63 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25358.9 25083 25013.5 ... 23473.8

Time limit reached
Best objective 2.535886958129e+04, best bound 4.197058229490e+04, gap 65.5065%
  WARNING: Time limit reached. Using best solution found (gap: 65.51%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 25358.87, θ = 184397.01
  Upper Bound (UB) = 25358.87

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 184397.01
  [DEBUG]   ✓ Scenario 0: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 184397.01 ≤ Q = 184397.01 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7afa6acb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x85059535
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.268342e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.00s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5606748.7111
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.639245e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163924.52    0  123 5606748.71 -163924.52   103%     -    0s
H    0     0                    -132241.8328 -163924.52  24.0%     -    0s
H    0     0                    -132616.9665 -163924.52  23.6%     -    0s
     0     0 -143600.64    0   81 -132616.97 -143600.64  8.28%     -    0s
H    0     0                    -140936.8735 -143493.17  1.81%     -    0s
     0     0 -142436.39    0   83 -140936.87 -142436.39  1.06%     -    0s
H    0     0                    -141571.8880 -142431.91  0.61%     -    0s
     0     0 -142418.80    0   65 -141571.89 -142418.80  0.60%     -    0s
     0     0 -142414.13    0   81 -141571.89 -142414.13  0.59%     -    0s
     0     0 -142236.87    0   18 -141571.89 -142236.87  0.47%     -    0s
H    0     0                    -141710.8006 -142185.84  0.34%     -    0s
     0     0 -142056.98    0   36 -141710.80 -142056.98  0.24%     -    0s
     0     0 -142056.96    0   34 -141710.80 -142056.96  0.24%     -    0s
     0     0 -142044.59    0   34 -141710.80 -142044.59  0.24%     -    0s
     0     0 -141861.04    0   33 -141710.80 -141861.04  0.11%     -    0s
     0     0 -141831.65    0   33 -141710.80 -141831.65  0.09%     -    0s
     0     0 -141797.60    0    8 -141710.80 -141797.60  0.06%     -    0s
     0     0 -141797.60    0   33 -141710.80 -141797.60  0.06%     -    0s
     0     0 -141797.60    0   32 -141710.80 -141797.60  0.06%     -    0s
     0     0 -141797.60    0   25 -141710.80 -141797.60  0.06%     -    0s
*    0     0               0    -141743.2235 -141743.22  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 37
  Flow cover: 13

Explored 1 nodes (805 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -141743 -141711 -141572 ... 1.26834e+13
No other solutions better than -141743

Optimal solution found (tolerance 1.00e-06)
Best objective -1.417432235243e+05, best bound -1.417432235243e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 177540.21
  Scenario: 25 demand increases, 35 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -141743.22
  [DEBUG]   S×d_nominal = 319283.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 319283.44 + -141743.22 = 177540.21
  [DEBUG]   Current θ from Master = 184397.01
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6856.80 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18502.07
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 272.0083, Absolute Gap = 272.0083, Relative Gap = 0.010726
  Not converged yet (gap = 272.01 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 25 increases, 35 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697023 nonzeros
Model fingerprint: 0xd782f383
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 119584 rows and 48544 columns
Presolve time: 2.24s
Presolved: 126439 rows, 53556 columns, 780453 nonzeros
Variable types: 51297 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.26s

Barrier statistics:
 Dense cols : 557
 AA' NZ     : 6.786e+06
 Factor NZ  : 1.453e+07 (roughly 200 MB of memory)
 Factor Ops : 3.073e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.87998207e+07  2.24741033e+08  1.31e+05 2.01e+01  8.77e+04     5s
   1  -1.46948746e+07  2.09368343e+08  9.38e+04 8.95e+01  6.25e+04     5s
   2  -5.06383812e+06  1.58537633e+08  3.21e+04 1.30e+00  2.30e+04     5s
   3  -1.09911015e+06  1.20357901e+08  3.26e+03 1.57e+00  2.75e+03     5s
   4  -6.20315387e+05  8.50351335e+07  8.52e+02 7.32e-01  9.15e+02     5s
   5  -5.30873512e+05  4.97362937e+07  5.49e+02 3.52e-01  5.36e+02     5s
   6  -4.02994605e+05  3.29152377e+07  1.56e+02 2.08e-01  2.27e+02     5s
   7  -3.32604535e+05  2.42681092e+07  4.36e+01 1.44e-01  1.27e+02     5s
   8  -2.26759075e+05  1.73014131e+07  6.97e+00 9.93e-02  7.86e+01     5s
   9  -1.88566667e+05  9.42112456e+06  3.68e+00 5.29e-02  4.25e+01     5s
  10  -1.51120218e+05  6.19565545e+06  2.46e+00 3.55e-02  2.79e+01     5s
  11  -9.90443713e+04  2.28963114e+06  8.73e-01 1.28e-02  1.04e+01     6s
  12  -6.11453327e+04  1.20551833e+06  2.87e-01 6.58e-03  5.49e+00     6s
  13  -3.51328062e+04  3.69130798e+05  1.29e-01 1.88e-03  1.75e+00     6s
  14  -1.72794047e+04  2.36950095e+05  9.08e-02 1.48e-03  1.10e+00     6s
  15  -3.34161272e+03  1.82776344e+05  7.14e-02 2.61e-03  8.06e-01     6s
  16   1.40146822e+04  1.40163325e+05  4.42e-02 2.00e-03  5.46e-01     6s
  17   2.18360790e+04  1.12984725e+05  3.49e-02 2.06e-03  3.95e-01     6s
  18   2.89572695e+04  9.89885168e+04  2.69e-02 1.50e-03  3.03e-01     6s
  19   3.44492271e+04  8.31029195e+04  2.09e-02 9.50e-04  2.11e-01     6s
  20   3.96250790e+04  7.56371987e+04  1.56e-02 6.85e-04  1.56e-01     6s
  21   4.17125200e+04  7.08133335e+04  1.35e-02 5.12e-04  1.26e-01     6s
  22   4.67175962e+04  6.68756770e+04  8.62e-03 3.72e-04  8.73e-02     6s
  23   4.84117182e+04  6.35600964e+04  7.01e-03 3.83e-04  6.56e-02     6s
  24   5.01773678e+04  6.16889266e+04  5.47e-03 2.56e-04  4.99e-02     7s
  25   5.16761324e+04  5.97407609e+04  4.17e-03 2.13e-04  3.49e-02     7s
  26   5.30117726e+04  5.89060600e+04  3.05e-03 1.49e-04  2.55e-02     7s
  27   5.41593306e+04  5.81714398e+04  2.10e-03 9.27e-05  1.74e-02     7s
  28   5.51665005e+04  5.76638264e+04  1.29e-03 5.28e-05  1.08e-02     7s
  29   5.57322384e+04  5.73674226e+04  8.65e-04 3.32e-05  7.08e-03     7s
  30   5.61581835e+04  5.72535413e+04  5.36e-04 2.47e-05  4.75e-03     7s
  31   5.63377519e+04  5.71212407e+04  4.03e-04 1.47e-05  3.39e-03     7s
  32   5.66454185e+04  5.69971660e+04  1.78e-04 5.41e-06  1.52e-03     7s
  33   5.67181087e+04  5.69334525e+04  1.28e-04 3.63e-05  9.33e-04     7s
  34   5.68183516e+04  5.69190322e+04  6.20e-05 4.22e-06  4.36e-04     8s
  35   5.68779008e+04  5.69173880e+04  2.18e-05 4.47e-06  1.71e-04     8s
  36   5.69076262e+04  5.69169257e+04  3.28e-06 3.98e-06  4.03e-05     8s
  37   5.69107492e+04  5.69134881e+04  1.37e-06 3.72e-07  1.19e-05     8s
  38   5.69131324e+04  5.69132787e+04  7.02e-08 3.34e-08  6.35e-07     8s
  39   5.69132450e+04  5.69132456e+04  7.75e-09 5.14e-10  2.50e-09     8s
  40   5.69132454e+04  5.69132454e+04  3.12e-07 2.20e-09  2.26e-10     8s

Barrier solved model in 40 iterations and 8.36 seconds (12.19 work units)
Optimal objective 5.69132454e+04


Root crossover log...

  116368 DPushes remaining with DInf 0.0000000e+00                 8s
   13377 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    2342 PPushes remaining with PInf 8.8641973e-06                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.3937228e+01     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   57453    5.6913245e+04   0.000000e+00   1.393723e+01     12s
   57473    5.6913245e+04   0.000000e+00   0.000000e+00     12s
   57473    5.6913245e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.691325e+04, 57473 iterations, 9.47 seconds (16.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56913.2454    0   73 -171254.74 56913.2454   133%     -   12s
H    0     0                    -169903.8100 56913.2454   133%     -   12s
H    0     0                    -73587.60516 56913.2454   177%     -   13s
H    0     0                    -31491.63276 56913.2454   281%     -   13s
H    0     0                    -2283.846452 56913.2454  2592%     -   13s
H    0     0                    3454.8209562 56913.2454  1547%     -   13s
H    0     0                    16148.633635 56913.2454   252%     -   14s
H    0     0                    16950.781884 56913.2454   236%     -   14s
     0     0 53831.9415    0  188 16950.7819 53831.9415   218%     -   48s
H    0     0                    16970.897942 53830.5158   217%     -   49s
H    0     0                    17018.352542 53830.5158   216%     -   49s
H    0     0                    17292.361965 53830.5158   211%     -   49s
     0     0 53368.4425    0  179 17292.3620 53368.4425   209%     -   64s
     0     0 53368.4425    0  179 17292.3620 53368.4425   209%     -   71s
     0     0 53293.1874    0  174 17292.3620 53293.1874   208%     -   74s
     0     0 53293.1874    0  175 17292.3620 53293.1874   208%     -   75s
     0     0 53293.1874    0  180 17292.3620 53293.1874   208%     -   76s
     0     0 53293.1874    0  180 17292.3620 53293.1874   208%     -   76s
     0     0 50005.2262    0  207 17292.3620 50005.2262   189%     -  146s
     0     0 49043.3081    0  256 17292.3620 49043.3081   184%     -  184s
     0     0 48840.7932    0  274 17292.3620 48840.7932   182%     -  198s
     0     0 48750.0996    0  273 17292.3620 48750.0996   182%     -  207s
     0     0 48743.1235    0  266 17292.3620 48743.1235   182%     -  210s
     0     0 48737.6368    0  276 17292.3620 48737.6368   182%     -  212s
     0     0 48734.3353    0  272 17292.3620 48734.3353   182%     -  213s
     0     0 48731.0397    0  278 17292.3620 48731.0397   182%     -  216s
     0     0 48719.4185    0  271 17292.3620 48719.4185   182%     -  220s
     0     0 48705.1947    0  269 17292.3620 48705.1947   182%     -  224s
     0     0 48693.9807    0  273 17292.3620 48693.9807   182%     -  228s
     0     0 48672.1134    0  272 17292.3620 48672.1134   181%     -  236s
     0     0 48664.5529    0  274 17292.3620 48664.5529   181%     -  239s
     0     0 48663.6063    0  276 17292.3620 48663.6063   181%     -  240s
     0     0 48651.5402    0  271 17292.3620 48651.5402   181%     -  246s
     0     0 48650.0094    0  263 17292.3620 48650.0094   181%     -  248s
     0     0 48648.7747    0  268 17292.3620 48648.7747   181%     -  249s
     0     0 48648.6419    0  270 17292.3620 48648.6419   181%     -  249s
H    0     0                    17613.368310 48648.6419   176%     -  264s
H    0     0                    17647.300776 48648.6419   176%     -  264s
H    0     0                    17653.672176 48648.6419   176%     -  264s
H    0     0                    17721.394989 48648.6419   175%     -  264s
H    0     0                    17740.688756 48648.6419   174%     -  264s
H    0     0                    17742.590699 48648.6419   174%     -  264s
H    0     0                    17967.648250 48648.6419   171%     -  264s
H    0     0                    17980.186253 48648.6419   171%     -  264s
H    0     0                    19116.886200 46852.2586   145%     -  302s
H    0     0                    19221.954654 46852.2586   144%     -  302s
H    0     0                    19463.805193 46852.2586   141%     -  302s
     0     0 46852.2586    0  303 19463.8052 46852.2586   141%     -  302s
H    0     0                    19497.794110 46852.1041   140%     -  303s
H    0     0                    19741.194548 46852.1041   137%     -  303s
H    0     0                    21920.612772 46250.6355   111%     -  327s
H    0     0                    22243.093070 46250.6355   108%     -  327s
H    0     0                    22386.520297 46250.6355   107%     -  327s
     0     0 46250.6355    0  315 22386.5203 46250.6355   107%     -  327s
     0     0 46075.3711    0  323 22386.5203 46075.3711   106%     -  339s
     0     0 45956.2220    0  388 22386.5203 45956.2220   105%     -  352s
     0     0 45934.9848    0  396 22386.5203 45934.9848   105%     -  357s
     0     0 45904.2896    0  399 22386.5203 45904.2896   105%     -  361s
     0     0 45878.7775    0  395 22386.5203 45878.7775   105%     -  367s
     0     0 45850.9866    0  388 22386.5203 45850.9866   105%     -  372s
     0     0 45809.8985    0  391 22386.5203 45809.8985   105%     -  379s
     0     0 45784.7529    0  388 22386.5203 45784.7529   105%     -  384s
     0     0 45772.5365    0  393 22386.5203 45772.5365   104%     -  388s
     0     0 45760.8656    0  399 22386.5203 45760.8656   104%     -  391s
     0     0 45756.4020    0  397 22386.5203 45756.4020   104%     -  393s
     0     0 45752.4305    0  394 22386.5203 45752.4305   104%     -  395s
     0     0 45744.3146    0  397 22386.5203 45744.3146   104%     -  398s
     0     0 45716.6516    0  399 22386.5203 45716.6516   104%     -  401s
     0     0 45705.4240    0  394 22386.5203 45705.4240   104%     -  404s
     0     0 45701.2226    0  396 22386.5203 45701.2226   104%     -  406s
     0     0 45699.8393    0  396 22386.5203 45699.8393   104%     -  407s
     0     0 45689.2029    0  396 22386.5203 45689.2029   104%     -  409s
     0     0 45681.3395    0  399 22386.5203 45681.3395   104%     -  410s
     0     0 45679.2218    0  401 22386.5203 45679.2218   104%     -  412s
     0     0 45675.8435    0  399 22386.5203 45675.8435   104%     -  413s
     0     0 45674.8579    0  399 22386.5203 45674.8579   104%     -  414s
     0     0 44872.8740    0  333 22386.5203 44872.8740   100%     -  449s
     0     0 44672.8311    0  359 22386.5203 44672.8311   100%     -  463s
     0     0 44561.1149    0  356 22386.5203 44561.1149  99.1%     -  477s
     0     0 44500.5760    0  361 22386.5203 44500.5760  98.8%     -  484s
     0     0 44432.6229    0  368 22386.5203 44432.6229  98.5%     -  491s
H    0     0                    22459.972726 44387.1004  97.6%     -  497s
     0     0 44387.1004    0  371 22459.9727 44387.1004  97.6%     -  497s
     0     0 44374.6162    0  371 22459.9727 44374.6162  97.6%     -  500s
H    0     0                    22653.839713 44362.6530  95.8%     -  503s
     0     0 44362.6530    0  368 22653.8397 44362.6530  95.8%     -  503s
     0     0 44357.2399    0  372 22653.8397 44357.2399  95.8%     -  505s
     0     0 44354.6576    0  371 22653.8397 44354.6576  95.8%     -  506s
     0     0 44352.4216    0  370 22653.8397 44352.4216  95.8%     -  508s
     0     0 44348.1349    0  365 22653.8397 44348.1349  95.8%     -  509s
     0     0 44347.0519    0  364 22653.8397 44347.0519  95.8%     -  511s
     0     0 44195.2527    0  376 22653.8397 44195.2527  95.1%     -  530s
     0     0 44158.1292    0  381 22653.8397 44158.1292  94.9%     -  537s
     0     0 44102.5259    0  372 22653.8397 44102.5259  94.7%     -  544s
     0     0 44075.8760    0  385 22653.8397 44075.8760  94.6%     -  547s
     0     0 44066.2718    0  386 22653.8397 44066.2718  94.5%     -  549s
     0     0 44062.1765    0  411 22653.8397 44062.1765  94.5%     -  551s
     0     0 44059.7238    0  383 22653.8397 44059.7238  94.5%     -  552s
     0     0 44059.6222    0  383 22653.8397 44059.6222  94.5%     -  553s
     0     0 43967.4881    0  411 22653.8397 43967.4881  94.1%     -  562s
H    0     0                    22685.087261 43965.8635  93.8%     -  564s
     0     0 43960.0612    0  414 22685.0873 43960.0612  93.8%     -  567s
     0     0 43956.6637    0  422 22685.0873 43956.6637  93.8%     -  572s
H    0     0                    22865.319485 43948.4164  92.2%     -  574s
     0     0 43948.4164    0  414 22865.3195 43948.4164  92.2%     -  574s
     0     0 43947.6775    0  415 22865.3195 43947.6775  92.2%     -  576s
     0     0 43858.2601    0  484 22865.3195 43858.2601  91.8%     -  587s
H    0     0                    22896.567032 43855.9968  91.5%     -  588s
     0     0 43837.0864    0  420 22896.5670 43837.0864  91.5%     -  594s
     0     0 43829.4857    0  417 22896.5670 43829.4857  91.4%     -  596s
     0     0 43823.7702    0  421 22896.5670 43823.7702  91.4%     -  599s
     0     0 43821.8517    0  422 22896.5670 43821.8517  91.4%     -  601s
     0     0 43819.4603    0  430 22896.5670 43819.4603  91.4%     -  602s
     0     0 43818.0440    0  434 22896.5670 43818.0440  91.4%     -  603s
     0     0 43794.7604    0  412 22896.5670 43794.7604  91.3%     -  611s
     0     0 43787.1895    0  520 22896.5670 43787.1895  91.2%     -  621s
     0     0 43783.8376    0  525 22896.5670 43783.8376  91.2%     -  623s
     0     0 43782.2042    0  424 22896.5670 43782.2042  91.2%     -  624s
     0     0 43780.8826    0  523 22896.5670 43780.8826  91.2%     -  625s
     0     0 43776.2049    0  420 22896.5670 43776.2049  91.2%     -  631s
     0     0 43773.4362    0  415 22896.5670 43773.4362  91.2%     -  633s
     0     0 43772.4280    0  416 22896.5670 43772.4280  91.2%     -  633s
     0     0 43761.9861    0  402 22896.5670 43761.9861  91.1%     -  636s
     0     0 43761.3953    0  419 22896.5670 43761.3953  91.1%     -  639s
     0     0 43755.5313    0  413 22896.5670 43755.5313  91.1%     -  641s
     0     0 43754.4892    0  421 22896.5670 43754.4892  91.1%     -  643s
     0     0 43753.3418    0  414 22896.5670 43753.3418  91.1%     -  645s
     0     0 43752.8875    0  414 22896.5670 43752.8875  91.1%     -  647s
     0     2 43751.8828    0  414 22896.5670 43751.8828  91.1%     -  866s
     1     4 43566.0655    1  397 22896.5670 43749.4007  91.1%  7734  890s
     3     8 43445.8776    2  386 22896.5670 43565.7440  90.3% 13068  904s
     7    15 43198.0898    3  391 22896.5670 43445.7985  89.7% 13225  936s
    14    30 43018.0536    4  397 22896.5670 43428.6985  89.7% 15173  965s
    29    45 41132.5280    5  372 22896.5670 43017.8365  87.9% 19512 1032s
    44    77 40862.3628    6  378 22896.5670 43017.8365  87.9% 25039 1112s
    76   179 40830.9373    7  365 22896.5670 42701.2836  86.5% 19807 1157s
   178   246 40609.5825   10  334 22896.5670 42701.2836  86.5% 13271 1184s
   245   304 40515.1352   12  329 22896.5670 42701.2836  86.5% 10839 1210s
   303   333 40399.5721   14  332 22896.5670 42701.2836  86.5%  9703 1240s
   332   363 40038.4551   15  332 22896.5670 42701.2836  86.5%  9343 1301s
   362   407 39959.1610   16  335 22896.5670 42701.2836  86.5%  9242 1379s
   406   454 39916.8555   17  329 22896.5670 42701.2836  86.5%  8965 1403s
   453   486 39792.4711   18  330 22896.5670 42701.2836  86.5%  8528 1425s
   485   514 38813.2264   20  267 22896.5670 42701.2836  86.5%  8293 1448s
   513   544 39224.4018   19  323 22896.5670 42701.2836  86.5%  8143 1470s
   543   574 38990.8170   20  318 22896.5670 42701.2836  86.5%  7953 1494s
   573   605 38882.6215   21  316 22896.5670 42701.2836  86.5%  7770 1517s
   604   637 38737.1426   22  308 22896.5670 42701.2836  86.5%  7605 1538s
H  630   637                    24558.031998 42701.2836  73.9%  7449 1538s
   636   736 38675.1113   23  304 24558.0320 42701.2836  73.9%  7404 1565s
   735   822 38260.0083   25  291 24558.0320 42701.2836  73.9%  6881 1587s
   821   914 37802.6493   27  293 24558.0320 42701.2836  73.9%  6484 1610s
   913   964 37276.0833   29  294 24558.0320 42701.2836  73.9%  6173 1637s
   990   995 36600.3866   30  294 24558.0320 42701.2836  73.9%  6025 1664s
  1037  1069 35202.4285   31  328 24558.0320 42701.2836  73.9%  6055 1694s
  1117  1152 34893.5400   32  325 24558.0320 42701.2836  73.9%  5931 1728s
  1208  1222 33964.1183   34  306 24558.0320 42701.2836  73.9%  5726 1760s
  1305  1314 28662.2832   35  275 24558.0320 42701.2836  73.9%  5516 1794s
  1425  1394 28567.7311   36  212 24558.0320 42701.2836  73.9%  5280 1826s
  1567  1473 27592.8381   43  201 24558.0320 42562.8705  73.3%  5015 1863s
  1668  1504     cutoff   48      24558.0320 42302.7970  72.3%  4944 1893s
  1701  1534 26601.0907   49  199 24558.0320 42302.7970  72.3%  4993 1917s
  1737  1560 26475.2592   50  193 24558.0320 42302.7970  72.3%  4995 1946s
  1771  1592 26211.7240   51  191 24558.0320 42302.7970  72.3%  4979 1980s
  1819  1637 26178.3332   52  190 24558.0320 42302.7970  72.3%  4926 2009s
  1872  1717 26017.7856   53  193 24558.0320 42302.7970  72.3%  4899 2040s
  1964  1812 25168.0239   54  182 24558.0320 42302.7970  72.3%  4781 2074s
  2106  1906 34336.9770   26  312 24558.0320 42258.5804  72.1%  4620 2111s
  2246  1963 34047.0708   28  307 24558.0320 42258.5804  72.1%  4483 2156s
  2359  2044 33122.0350   29  269 24558.0320 42258.5804  72.1%  4481 2205s
  2482  2166 31256.2612   30  224 24558.0320 42258.5804  72.1%  4462 2252s
  2632  2316 32970.2529   30  266 24558.0320 42105.0036  71.5%  4401 2302s
  2808  2395 33003.6855   30  264 24558.0320 42051.4343  71.2%  4320 2354s
  2991  2437 32703.5063   32  260 24558.0320 42051.4343  71.2%  4275 2486s
  3071  2613     cutoff   31      24558.0320 42051.4343  71.2%  4298 2540s
  3303  2816 32164.9886   34  256 24558.0320 42051.4343  71.2%  4223 2595s
  3608  3000 30623.3115   40  224 24558.0320 42025.7828  71.1%  4097 2649s
H 3862  2998                    24846.132912 42025.7828  69.1%  4049 2690s
H 3862  2998                    24885.855980 42025.7828  68.9%  4049 2865s
  3863  2999 35657.6555   14  414 24885.8560 42025.7828  68.9%  4048 3097s
  3865  3000 25645.5197   19   73 24885.8560 42025.7828  68.9%  4045 3110s
H 3865  2849                    24911.889166 42025.7828  68.7%  4045 3173s
H 3866  2708                    25159.796558 42025.7828  67.0%  4044 3224s
  3867  2709 36805.9663   29  415 25159.7966 42025.7828  67.0%  4043 3228s
  3868  2709 25960.5957  100  356 25159.7966 42025.7828  67.0%  4042 3251s
  3869  2710 30416.9397   46  377 25159.7966 42025.7828  67.0%  4041 3274s
  3870  2711 29042.2149   53  376 25159.7966 42025.7828  67.0%  4040 3291s
  3871  2711 30024.8161   71  394 25159.7966 42025.7828  67.0%  4039 3305s
  3872  2712 35906.7274   14  443 25159.7966 42025.7828  67.0%  4038 3324s
  3873  2713 27703.3793   72  391 25159.7966 42025.7828  67.0%  4037 3348s
  3874  2713 31053.4927   26  404 25159.7966 42025.7828  67.0%  4036 3359s
  3875  2714 33094.9348   20  411 25159.7966 42025.7828  67.0%  4035 3364s
  3876  2715 28268.9868   72  409 25159.7966 42025.7828  67.0%  4034 3370s
  3877  2715 37990.0351   15  411 25159.7966 42025.7828  67.0%  4033 3376s
  3878  2716 37005.5175   18  413 25159.7966 42025.7828  67.0%  4032 3380s
  3880  2717 28867.1294   71  415 25159.7966 42025.7828  67.0%  4030 3402s
  3881  2718 35235.6173   18  402 25159.7966 42025.7828  67.0%  4029 3410s
  3883  2719 27805.3245   59  409 25159.7966 42025.7828  67.0%  4027 3418s
  3884  2720 36786.9672    7  409 25159.7966 42025.7828  67.0%  4026 3423s
  3885  2721 36048.6497   13  433 25159.7966 42025.7828  67.0%  4025 3440s
  3886  2721 26844.5987   36  505 25159.7966 42025.7828  67.0%  4024 3448s
  3887  2722 32753.2864   27  440 25159.7966 42025.7828  67.0%  4023 3454s
  3888  2723 30546.7070   23  441 25159.7966 42025.7828  67.0%  4022 3459s
H 3888  2586                    25163.795251 42025.7828  67.0%  4022 3462s
H 3888  2457                    25193.832385 42025.7828  66.8%  4022 3462s
H 3888  2333                    25221.116307 42025.7828  66.6%  4022 3462s
  3890  2334 31839.6640   71  412 25221.1163 42025.7828  66.6%  4019 3480s
  3891  2335 30275.8578   69  421 25221.1163 42025.7828  66.6%  4018 3487s
  3892  2335 35718.7293   30  421 25221.1163 42025.7828  66.6%  4017 3491s
  3893  2336 39021.8909   18  447 25221.1163 42025.7828  66.6%  4016 3499s
  3894  2337 28325.5299   28  410 25221.1163 42025.7828  66.6%  4015 3509s
  3895  2337 26582.1929   47  414 25221.1163 42025.7828  66.6%  4014 3514s
  3896  2338 41566.6805   16  443 25221.1163 42025.7828  66.6%  4013 3520s
  3897  2339 30637.2110   36  414 25221.1163 42025.7828  66.6%  4012 3530s
  3899  2340 27177.9395   56  415 25221.1163 42025.7828  66.6%  4010 3542s
  3900  2341 28987.2953   49  441 25221.1163 42025.7828  66.6%  4009 3548s
H 3900  2224                    25227.445685 42025.7828  66.6%  4009 3558s
H 3900  2112                    25238.305695 42025.7828  66.5%  4009 3558s
H 3900  2006                    25254.794318 42025.7828  66.4%  4009 3558s
H 3900  1905                    25289.736245 42025.7828  66.2%  4009 3558s
  3902  1906 32136.1980   47  420 25289.7362 42025.7828  66.2%  4007 3565s
  3903  1907 39149.4161   10  412 25289.7362 42025.7828  66.2%  4006 3576s
  3904  1907 27312.7905   64  445 25289.7362 42025.7828  66.2%  4005 3580s
  3905  1908 30264.0140   32  413 25289.7362 42025.7828  66.2%  4004 3586s
  3906  1909 30873.9420   27  413 25289.7362 42025.7828  66.2%  4003 3600s

Cutting planes:
  MIR: 449
  Mixing: 2
  Flow cover: 702
  RLT: 6
  Relax-and-lift: 57

Explored 3906 nodes (16566992 simplex iterations) in 3600.03 seconds (8312.90 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25289.7 25254.8 25238.3 ... 24885.9

Time limit reached
Best objective 2.528973624466e+04, best bound 4.202578280152e+04, gap 66.1772%
  WARNING: Time limit reached. Using best solution found (gap: 66.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.13s
  Master Objective (UB) = 25289.74, θ = 176787.04
  Upper Bound (UB) = 25289.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176787.04
  [DEBUG]   ✓ Scenario 0: θ = 176787.04 ≤ Q = 176787.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176787.04 ≤ Q = 176787.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176787.04 ≤ Q = 176787.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 176787.04 ≤ Q = 176787.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 176787.04 ≤ Q = 176787.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 176787.04 ≤ Q = 176787.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 176787.04 ≤ Q = 176787.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 176787.04 ≤ Q = 176787.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 176787.04 ≤ Q = 176787.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 176787.04 ≤ Q = 176787.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 176787.04 ≤ Q = 176787.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 176787.04 ≤ Q = 176787.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 176787.04 ≤ Q = 176787.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 176787.04 ≤ Q = 176787.04 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 176787.04 ≤ Q = 176787.04 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 176787.04 ≤ Q = 176787.04 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x31e38fd9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xce1c7027
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.345827e+13
Presolve removed 2623 rows and 1915 columns
Presolve time: 0.00s
Presolved: 470 rows, 474 columns, 1325 nonzeros
Found heuristic solution: objective 6217430.2410
Variable types: 322 continuous, 152 integer (152 binary)

Root relaxation: objective -1.487012e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -148701.17    0  127 6217430.24 -148701.17   102%     -    0s
H    0     0                    -115713.1628 -148701.17  28.5%     -    0s
H    0     0                    -116630.2574 -148701.17  27.5%     -    0s
H    0     0                    -116652.3301 -148701.17  27.5%     -    0s
H    0     0                    -124137.8893 -148701.17  19.8%     -    0s
     0     0 -130995.90    0   86 -124137.89 -130995.90  5.52%     -    0s
H    0     0                    -128585.5272 -130883.27  1.79%     -    0s
H    0     0                    -128670.5568 -130638.13  1.53%     -    0s
     0     0 -130638.13    0   90 -128670.56 -130638.13  1.53%     -    0s
     0     0 -130619.10    0   90 -128670.56 -130619.10  1.51%     -    0s
H    0     0                    -128826.3902 -130619.10  1.39%     -    0s
     0     0 -129883.12    0   63 -128826.39 -129883.12  0.82%     -    0s
     0     0 -129828.13    0   62 -128826.39 -129828.13  0.78%     -    0s
     0     0 -129815.93    0   62 -128826.39 -129815.93  0.77%     -    0s
     0     0 -129483.45    0   37 -128826.39 -129483.45  0.51%     -    0s
     0     0 -129438.39    0   36 -128826.39 -129438.39  0.48%     -    0s
     0     0 -129413.96    0   49 -128826.39 -129413.96  0.46%     -    0s
     0     0 -129385.45    0   49 -128826.39 -129385.45  0.43%     -    0s
     0     0 -129152.97    0   26 -128826.39 -129152.97  0.25%     -    0s
     0     0 -129133.52    0   27 -128826.39 -129133.52  0.24%     -    0s
     0     0 -129008.92    0   13 -128826.39 -129008.92  0.14%     -    0s
     0     0 -128996.45    0   11 -128826.39 -128996.45  0.13%     -    0s
     0     0 -128945.91    0   13 -128826.39 -128945.91  0.09%     -    0s
     0     0 -128938.45    0   12 -128826.39 -128938.45  0.09%     -    0s
     0     0 -128938.27    0   11 -128826.39 -128938.27  0.09%     -    0s
     0     0 -128922.03    0   10 -128826.39 -128922.03  0.07%     -    0s
     0     0 -128911.23    0   10 -128826.39 -128911.23  0.07%     -    0s
     0     0 -128879.14    0    7 -128826.39 -128879.14  0.04%     -    0s
     0     0 -128879.14    0    8 -128826.39 -128879.14  0.04%     -    0s
H    0     0                    -128840.0295 -128879.14  0.03%     -    0s
     0     0 -128851.11    0    5 -128840.03 -128851.11  0.01%     -    0s
     0     0 -128849.48    0    4 -128840.03 -128849.48  0.01%     -    0s
     0     0 -128847.81    0    2 -128840.03 -128847.81  0.01%     -    0s
H    0     0                    -128846.4372 -128847.15  0.00%     -    0s
     0     0     cutoff    0      -128846.44 -128846.44  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 1
  MIR: 3
  Flow cover: 3
  RLT: 2
  Relax-and-lift: 3

Explored 1 nodes (818 simplex iterations) in 0.08 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -128846 -128840 -128826 ... -116630
No other solutions better than -128846

Optimal solution found (tolerance 1.00e-06)
Best objective -1.288464371942e+05, best bound -1.288464371942e+05, gap 0.0000%
  Subproblem solved in 0.09s
  Worst-case operational profit (Z_SP) = 166453.59
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -128846.44
  [DEBUG]   S×d_nominal = 295300.02
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 295300.02 + -128846.44 = 166453.59
  [DEBUG]   Current θ from Master = 176787.04
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10333.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 14956.28
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 202.8749, Absolute Gap = 202.8749, Relative Gap = 0.008022
  Not converged yet (gap = 202.87 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740242 nonzeros
Model fingerprint: 0xfc40edf9
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127058 rows and 51578 columns
Presolve time: 2.46s
Presolved: 134255 rows, 56762 columns, 828719 nonzeros
Variable types: 54503 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.40s

Barrier statistics:
 Dense cols : 557
 AA' NZ     : 7.575e+06
 Factor NZ  : 1.709e+07 (roughly 200 MB of memory)
 Factor Ops : 5.128e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.91390896e+07  2.37014043e+08  1.33e+05 1.94e+01  8.88e+04     4s
   1  -1.50009245e+07  2.21266562e+08  9.56e+04 8.90e+01  6.34e+04     4s
   2  -5.21387633e+06  1.67444587e+08  3.29e+04 2.11e+00  2.35e+04     4s
   3  -1.16673580e+06  1.27590401e+08  3.48e+03 1.55e+00  2.89e+03     4s
   4  -6.37132549e+05  9.19007475e+07  7.47e+02 8.17e-01  8.56e+02     5s
   5  -5.59934258e+05  5.64755117e+07  5.39e+02 4.30e-01  5.48e+02     5s
   6  -4.31791498e+05  3.78312055e+07  2.08e+02 2.61e-01  2.68e+02     5s
   7  -3.53283272e+05  2.77075632e+07  4.87e+01 1.78e-01  1.38e+02     5s
   8  -2.69456786e+05  1.97315368e+07  1.16e+01 1.22e-01  8.63e+01     5s
   9  -1.92114221e+05  1.36726658e+07  3.47e+00 8.32e-02  5.76e+01     5s
  10  -1.59843572e+05  5.93622569e+06  2.50e+00 3.55e-02  2.52e+01     5s
  11  -1.03857516e+05  2.68139300e+06  9.76e-01 1.56e-02  1.14e+01     5s
  12  -8.83268794e+04  1.74321878e+06  6.93e-01 1.05e-02  7.50e+00     5s
  13  -5.48294809e+04  7.78564454e+05  2.60e-01 4.27e-03  3.41e+00     5s
  14  -2.98033979e+04  3.33244194e+05  1.38e-01 1.66e-03  1.48e+00     5s
  15  -1.22476702e+04  2.18056339e+05  9.80e-02 1.16e-03  9.40e-01     5s
  16   2.25362952e+03  1.55638585e+05  7.60e-02 2.34e-03  6.26e-01     5s
  17   1.19460904e+04  1.39074881e+05  6.19e-02 3.73e-03  5.19e-01     5s
  18   2.53321826e+04  1.21895252e+05  4.14e-02 2.67e-03  3.94e-01     6s
  19   3.31286848e+04  9.58850490e+04  2.99e-02 1.44e-03  2.56e-01     6s
  20   3.72688805e+04  8.60274915e+04  2.38e-02 1.12e-03  1.99e-01     6s
  21   4.07060768e+04  7.74384879e+04  1.90e-02 8.50e-04  1.50e-01     6s
  22   4.22676108e+04  7.06794615e+04  1.70e-02 5.94e-04  1.16e-01     6s
  23   4.60012523e+04  6.55619109e+04  1.23e-02 3.70e-04  7.99e-02     6s
  24   4.81979164e+04  6.31674845e+04  9.55e-03 2.68e-04  6.11e-02     6s
  25   5.02883538e+04  6.09820305e+04  7.13e-03 2.69e-04  4.37e-02     6s
  26   5.22417043e+04  5.92708237e+04  4.88e-03 2.33e-04  2.87e-02     6s
  27   5.36430416e+04  5.82997027e+04  3.36e-03 1.13e-04  1.90e-02     6s
  28   5.48904606e+04  5.78014090e+04  2.02e-03 6.78e-05  1.19e-02     7s
  29   5.54583748e+04  5.75134341e+04  1.43e-03 4.50e-05  8.40e-03     7s
  30   5.59650467e+04  5.73201593e+04  9.07e-04 3.02e-05  5.54e-03     7s
  31   5.63703528e+04  5.71816016e+04  5.04e-04 1.91e-05  3.31e-03     7s
  32   5.65813299e+04  5.70809009e+04  2.99e-04 1.17e-05  2.04e-03     7s
  33   5.67880473e+04  5.69590301e+04  1.01e-04 2.95e-06  6.98e-04     7s
  34   5.68434883e+04  5.69232827e+04  5.59e-05 3.13e-06  3.26e-04     7s
  35   5.68945581e+04  5.69200026e+04  1.34e-05 1.91e-06  1.04e-04     7s
  36   5.69109624e+04  5.69176217e+04  1.17e-06 1.34e-06  2.72e-05     7s
  37   5.69114999e+04  5.69138659e+04  8.68e-07 3.81e-07  9.66e-06     8s
  38   5.69130548e+04  5.69132908e+04  7.43e-08 9.75e-08  9.64e-07     8s
  39   5.69132450e+04  5.69132456e+04  5.70e-09 7.45e-09  2.20e-09     8s

Barrier solved model in 39 iterations and 7.77 seconds (12.43 work units)
Optimal objective 5.69132450e+04


Root crossover log...

  123660 DPushes remaining with DInf 0.0000000e+00                 8s
   24190 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   14603 PPushes remaining with PInf 4.9210040e-05                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.1623737e+04     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   80017    5.6913245e+04   0.000000e+00   1.162374e+04     14s
   80282    5.6913245e+04   0.000000e+00   0.000000e+00     14s
   80282    5.6913245e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 5.691325e+04, 80282 iterations, 11.45 seconds (19.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56913.2454    0   73 -171254.74 56913.2454   133%     -   15s
H    0     0                    -161447.8183 56913.2454   135%     -   15s
H    0     0                    -149822.1345 56913.2454   138%     -   15s
H    0     0                    -149709.3005 56913.2454   138%     -   16s
H    0     0                    -149470.2729 56913.2454   138%     -   16s
H    0     0                    -149416.7994 56913.2454   138%     -   16s
H    0     0                    -148990.0614 56913.2454   138%     -   16s
H    0     0                    -148927.7421 56913.2454   138%     -   16s
H    0     0                    -148925.9537 56913.2454   138%     -   16s
H    0     0                    -148868.5640 56913.2454   138%     -   16s
H    0     0                    -73587.60516 56913.2454   177%     -   16s
H    0     0                    6545.5697213 56913.2454   769%     -   16s
H    0     0                    11154.360748 56913.2454   410%     -   16s
H    0     0                    11896.958891 56913.2454   378%     -   17s
H    0     0                    11966.112031 56913.2454   376%     -   17s
     0     0 52947.7782    0  180 11966.1120 52947.7782   342%     -   52s
H    0     0                    12338.938447 52938.0918   329%     -   53s
     0     0 52316.6203    0  198 12338.9384 52316.6203   324%     -   71s
     0     0 52278.5511    0  194 12338.9384 52278.5511   324%     -   77s
     0     0 52273.3542    0  202 12338.9384 52273.3542   324%     -   79s
     0     0 52273.2640    0  198 12338.9384 52273.2640   324%     -   79s
     0     0 49324.5013    0  194 12338.9384 49324.5013   300%     -  125s
H    0     0                    12525.932121 49324.0490   294%     -  125s
H    0     0                    13450.974482 49324.0490   267%     -  125s
H    0     0                    13553.246583 49324.0490   264%     -  125s
     0     0 48787.6766    0  265 13553.2466 48787.6766   260%     -  150s
     0     0 48565.7098    0  246 13553.2466 48565.7098   258%     -  170s
     0     0 48430.7037    0  259 13553.2466 48430.7037   257%     -  180s
     0     0 48400.3793    0  260 13553.2466 48400.3793   257%     -  188s
     0     0 48391.9852    0  267 13553.2466 48391.9852   257%     -  189s
     0     0 48347.3858    0  263 13553.2466 48347.3858   257%     -  197s
     0     0 48346.1372    0  262 13553.2466 48346.1372   257%     -  199s
     0     0 48345.2249    0  260 13553.2466 48345.2249   257%     -  200s
     0     0 48345.1237    0  259 13553.2466 48345.1237   257%     -  200s
     0     0 46653.5453    0  305 13553.2466 46653.5453   244%     -  257s
H    0     0                    14058.069939 46653.3556   232%     -  258s
     0     0 46028.0175    0  320 14058.0699 46028.0175   227%     -  295s
     0     0 45849.9812    0  344 14058.0699 45849.9812   226%     -  313s
     0     0 45803.4480    0  349 14058.0699 45803.4480   226%     -  322s
     0     0 45792.7874    0  352 14058.0699 45792.7874   226%     -  326s
     0     0 45783.8359    0  351 14058.0699 45783.8359   226%     -  329s
     0     0 45731.6435    0  336 14058.0699 45731.6435   225%     -  337s
     0     0 45688.4698    0  328 14058.0699 45688.4698   225%     -  344s
     0     0 45664.6919    0  335 14058.0699 45664.6919   225%     -  350s
     0     0 45651.8202    0  334 14058.0699 45651.8202   225%     -  355s
     0     0 45645.9368    0  339 14058.0699 45645.9368   225%     -  358s
     0     0 45633.5329    0  337 14058.0699 45633.5329   225%     -  363s
     0     0 45628.0445    0  336 14058.0699 45628.0445   225%     -  366s
     0     0 45622.9653    0  334 14058.0699 45622.9653   225%     -  368s
     0     0 45616.0184    0  340 14058.0699 45616.0184   224%     -  371s
     0     0 45613.3428    0  337 14058.0699 45613.3428   224%     -  373s
     0     0 45611.7270    0  344 14058.0699 45611.7270   224%     -  374s
     0     0 45609.8253    0  342 14058.0699 45609.8253   224%     -  375s
     0     0 45606.7016    0  341 14058.0699 45606.7016   224%     -  376s
     0     0 45602.8201    0  339 14058.0699 45602.8201   224%     -  379s
     0     0 45600.0341    0  341 14058.0699 45600.0341   224%     -  380s
     0     0 45598.5031    0  342 14058.0699 45598.5031   224%     -  381s
     0     0 45579.5447    0  334 14058.0699 45579.5447   224%     -  384s
     0     0 45575.4447    0  333 14058.0699 45575.4447   224%     -  385s
     0     0 45572.2026    0  336 14058.0699 45572.2026   224%     -  388s
     0     0 45571.5190    0  351 14058.0699 45571.5190   224%     -  389s
     0     0 44522.2939    0  345 14058.0699 44522.2939   217%     -  436s
     0     0 44416.1456    0  387 14058.0699 44416.1456   216%     -  448s
     0     0 44362.3123    0  391 14058.0699 44362.3123   216%     -  456s
     0     0 44336.1442    0  400 14058.0699 44336.1442   215%     -  461s
     0     0 44305.8625    0  395 14058.0699 44305.8625   215%     -  466s
     0     0 44260.6852    0  392 14058.0699 44260.6852   215%     -  471s
     0     0 44222.5737    0  393 14058.0699 44222.5737   215%     -  475s
     0     0 44213.1667    0  390 14058.0699 44213.1667   215%     -  478s
     0     0 44185.0248    0  396 14058.0699 44185.0248   214%     -  482s
     0     0 44181.6312    0  392 14058.0699 44181.6312   214%     -  484s
     0     0 44177.3380    0  392 14058.0699 44177.3380   214%     -  485s
     0     0 44177.0049    0  395 14058.0699 44177.0049   214%     -  486s
     0     0 44082.3577    0  377 14058.0699 44082.3577   214%     -  496s
H    0     0                    14660.141068 44082.1511   201%     -  497s
H    0     0                    17158.339295 44082.1511   157%     -  497s
H    0     0                    17209.232596 44082.1511   156%     -  497s
H    0     0                    17313.365221 44082.1511   155%     -  497s
H    0     0                    17509.350325 44082.1511   152%     -  497s
     0     0 44025.6067    0  375 17509.3503 44025.6067   151%     -  506s
     0     0 44014.6363    0  385 17509.3503 44014.6363   151%     -  511s
     0     0 44008.0009    0  377 17509.3503 44008.0009   151%     -  514s
     0     0 44006.2700    0  380 17509.3503 44006.2700   151%     -  516s
     0     0 43998.9859    0  373 17509.3503 43998.9859   151%     -  519s
     0     0 43994.7245    0  375 17509.3503 43994.7245   151%     -  522s
     0     0 43993.5939    0  374 17509.3503 43993.5939   151%     -  523s
     0     0 43920.8524    0  379 17509.3503 43920.8524   151%     -  530s
     0     0 43898.3002    0  378 17509.3503 43898.3002   151%     -  534s
     0     0 43889.8359    0  383 17509.3503 43889.8359   151%     -  536s
     0     0 43888.5681    0  387 17509.3503 43888.5681   151%     -  538s
     0     0 43855.8092    0  456 17509.3503 43855.8092   150%     -  543s
     0     0 43842.6302    0  386 17509.3503 43842.6302   150%     -  547s
     0     0 43837.4756    0  384 17509.3503 43837.4756   150%     -  549s
     0     0 43834.8765    0  390 17509.3503 43834.8765   150%     -  550s
     0     0 43832.8948    0  391 17509.3503 43832.8948   150%     -  551s
     0     0 43832.3609    0  393 17509.3503 43832.3609   150%     -  552s
     0     0 43812.4910    0  398 17509.3503 43812.4910   150%     -  556s
     0     0 43809.1719    0  399 17509.3503 43809.1719   150%     -  557s
     0     0 43798.5062    0  444 17509.3503 43798.5062   150%     -  560s
     0     0 43788.8353    0  458 17509.3503 43788.8353   150%     -  562s
     0     0 43787.1348    0  459 17509.3503 43787.1348   150%     -  563s
     0     0 43786.9976    0  459 17509.3503 43786.9976   150%     -  563s
     0     0 43780.8259    0  390 17509.3503 43780.8259   150%     -  566s
     0     0 43779.4050    0  396 17509.3503 43779.4050   150%     -  567s
     0     0 43774.1264    0  396 17509.3503 43774.1264   150%     -  569s
     0     0 43770.7807    0  396 17509.3503 43770.7807   150%     -  570s
     0     0 43770.6333    0  394 17509.3503 43770.6333   150%     -  571s
     0     0 43770.6052    0  394 17509.3503 43770.6052   150%     -  572s
     0     0 43770.1571    0  396 17509.3503 43770.1571   150%     -  574s
     0     0 43769.6696    0  396 17509.3503 43769.6696   150%     -  576s
H    0     0                    17902.904701 43769.3087   144%     -  703s
H    0     0                    17948.089217 43769.3087   144%     -  703s
H    0     0                    19716.703839 43769.3087   122%     -  706s
H    0     2                    20199.776873 43769.3087   117%     -  708s
     0     2 43769.3087    0  396 20199.7769 43769.3087   117%     -  708s
     1     3 42312.3148    1  340 20199.7769 43768.7860   117% 16004  724s
     2     4 43545.4177    1  392 20199.7769 43545.4177   116% 13666  735s
     3     6 43447.6835    2  375 20199.7769 43545.2314   116% 11492  747s
     5    10 41462.9413    3  368 20199.7769 43545.2314   116% 10502  760s
     9    17 41391.0385    4  359 20199.7769 43441.8842   115%  8923  783s
    16    34 42459.5789    4  383 20199.7769 42986.5993   113% 12172  810s
    33    49 40203.1515    5  379 20199.7769 42768.5072   112% 16796  921s
H   48    78                    20386.986525 42768.5072   110% 18816  966s
H   49    78                    20827.443009 42768.5072   105% 18723  966s
    77   157 39727.1519    7  343 20827.4430 42768.5072   105% 15739 1035s
   156   240 39537.2541   11  316 20827.4430 42768.5072   105% 11455 1066s
H  215   240                    22332.960667 42768.5072  91.5%  9577 1066s
   239   307 38441.6260   16  274 22332.9607 42768.5072  91.5%  9193 1098s
H  306   343                    22865.319485 42768.5072  87.0%  8341 1129s
   342   398 38321.9499   19  280 22865.3195 42768.5072  87.0%  8142 1158s
   397   458 37685.5820   21  290 22865.3195 42768.5072  87.0%  7748 1184s
H  417   458                    22896.567032 42768.5072  86.8%  7579 1184s
   457   505 37399.5187   23  279 22896.5670 42768.5072  86.8%  7570 1215s
   504   535 36666.1008   25  178 22896.5670 42768.5072  86.8%  7365 1234s
   534   573 36606.9349   26  190 22896.5670 42768.5072  86.8%  7504 1254s
   572   603 36369.0683   27  183 22896.5670 42768.5072  86.8%  7269 1276s
   602   633 36223.1916   28  176 22896.5670 42768.5072  86.8%  7211 1317s
   632   662 36219.2688   29  180 22896.5670 42768.5072  86.8%  7091 1343s
H  644   662                    23029.975731 42768.5072  85.7%  7015 1343s
   661   694 36074.9385   30  174 23029.9757 42768.5072  85.7%  7015 1397s
   693   778 36007.2464   31  183 23029.9757 42768.5072  85.7%  6896 1429s
   777   809 32951.4879   36  148 23029.9757 42768.5072  85.7%  6560 1453s
   808   838 32678.4398   37  156 23029.9757 42768.5072  85.7%  6506 1490s
   837   872 32525.4730   38  148 23029.9757 42768.5072  85.7%  6414 1517s
H  843   872                    23489.103156 42768.5072  82.1%  6385 1517s
   871   962 32522.0901   39  146 23489.1032 42768.5072  82.1%  6325 1548s
   961  1066 32094.4100   45  133 23489.1032 42768.5072  82.1%  6032 1582s
  1077  1095 30929.9517   52  117 23489.1032 42768.5072  82.1%  5695 1607s
H 1083  1095                    23834.453001 42768.5072  79.4%  5682 1607s
H 1085  1095                    23849.280338 42768.5072  79.3%  5674 1607s
  1110  1203 30927.5488   53  115 23849.2803 42768.5072  79.3%  5640 1643s
  1232  1322 26852.4211   60   77 23849.2803 42768.5072  79.3%  5349 1675s
  1355  1419 26105.1437   68   59 23849.2803 42768.5072  79.3%  5099 1713s
  1490  1495     cutoff   76      23849.2803 42768.5072  79.3%  4879 1750s
  1609  1556     cutoff   77      23849.2803 42768.5072  79.3%  4747 1781s
  1724  1646 36734.3065   24  307 23849.2803 42768.5072  79.3%  4666 1811s
  1836  1750 36214.0180   25  295 23849.2803 42768.5072  79.3%  4591 1844s
  1992  1921 29086.4293   91  160 23849.2803 42768.5072  79.3%  4446 1875s
  2207  2097 28395.8498   97  163 23849.2803 42768.5072  79.3%  4200 1906s
H 2221  2095                    24040.020583 42768.5072  77.9%  4177 1906s
  2435  2243 25783.0268  111  167 24040.0206 42768.5072  77.9%  3977 1953s
  2672  2348 24885.0810  127  117 24040.0206 42768.5072  77.9%  3771 1986s
  2878  2407 24572.5674  144   57 24040.0206 42768.5072  77.9%  3658 2023s
  3009  2459 38177.3841   11  315 24040.0206 42768.5072  77.9%  3650 2064s
  3111  2553 38107.5199   12  306 24040.0206 42641.2274  77.4%  3687 2104s
  3260  2594 34976.9967   14  392 24040.0206 42641.2274  77.4%  3709 2145s
  3346  2679 34245.3471   15  408 24040.0206 42641.2274  77.4%  3767 2187s
  3485  2787 32140.3139   18  261 24040.0206 42345.7066  76.1%  3764 2237s
  3611  2887 30319.2112   22  251 24040.0206 42345.7066  76.1%  3803 2290s
H 3744  2876                    24165.231897 42345.7066  75.2%  3828 2340s
  3745  2877 31795.3199   27  396 24165.2319 42345.7066  75.2%  3827 2541s
  3747  2878 38032.9738   14   73 24165.2319 42345.7066  75.2%  3825 2553s
H 3747  2734                    24195.910598 42345.7066  75.0%  3825 2624s
  3748  2735 27578.7897   49  282 24195.9106 42345.7066  75.0%  3824 2630s
H 3748  2598                    24291.660215 42345.7066  74.3%  3824 2682s
H 3748  2468                    24313.287955 42345.7066  74.2%  3824 2682s
H 3748  2344                    24399.376502 42345.7066  73.6%  3824 2682s
  3750  2345 25360.1469   37  402 24399.3765 42345.7066  73.6%  3822 2734s
  3751  2346 35951.0759   24  363 24399.3765 42345.7066  73.6%  3821 2762s
  3752  2347 36437.4983   20  383 24399.3765 42345.7066  73.6%  3820 2787s
  3753  2347 26035.7145   55  393 24399.3765 42345.7066  73.6%  3819 2807s
  3754  2348 36602.5456   13  391 24399.3765 42345.7066  73.6%  3818 2818s
  3755  2349 29907.2483   97  394 24399.3765 42345.7066  73.6%  3817 2829s
  3756  2349 24443.3066   73  435 24399.3765 42345.7066  73.6%  3816 2837s
  3757  2350 24484.6007   69  427 24399.3765 42345.7066  73.6%  3815 2842s
  3758  2351 27578.7897   49  430 24399.3765 42345.7066  73.6%  3814 2849s
  3759  2351 37400.9849   22  402 24399.3765 42345.7066  73.6%  3813 2860s
  3760  2352 24399.3765   29  402 24399.3765 42345.7066  73.6%  3812 2866s
  3761  2353 27292.0426  111  399 24399.3765 42345.7066  73.6%  3811 2870s
  3763  2354 35918.5637   27  403 24399.3765 42345.7066  73.6%  3809 2878s
  3764  2355 25263.3410   57  400 24399.3765 42345.7066  73.6%  3808 2881s
  3766  2356 27240.9828   62  400 24399.3765 42345.7066  73.6%  3806 2888s
  3767  2357 32619.3602   39  417 24399.3765 42345.7066  73.6%  3805 2908s
  3768  2357 27113.3280   93  400 24399.3765 42345.7066  73.6%  3804 2920s
  3769  2358 31853.6303   77  438 24399.3765 42345.7066  73.6%  3803 2925s
H 3769  2240                    24450.808449 42345.7066  73.2%  3803 2929s
  3770  2241 29308.3345   39  447 24450.8084 42345.7066  73.2%  3802 2930s
  3772  2242 27569.3972   75  441 24450.8084 42345.7066  73.2%  3800 2937s
  3773  2243 29443.0952   37  442 24450.8084 42345.7066  73.2%  3799 2946s
  3774  2243 36243.4100   27  455 24450.8084 42345.7066  73.2%  3798 2953s
  3775  2244 24450.8084   45  404 24450.8084 42345.7066  73.2%  3797 2966s
  3776  2245 37091.1935   21  456 24450.8084 42345.7066  73.2%  3796 2972s
  3777  2245 31324.5220   49  454 24450.8084 42345.7066  73.2%  3795 2977s
  3778  2246 26426.4261   52  456 24450.8084 42345.7066  73.2%  3794 2989s
  3779  2247 37070.6044   14  447 24450.8084 42345.7066  73.2%  3793 2995s
  3780  2247 35891.9435   35  517 24450.8084 42345.7066  73.2%  3792 3008s
  3781  2248 38520.9986   18  416 24450.8084 42345.7066  73.2%  3791 3012s
  3782  2249 39660.1992    8  474 24450.8084 42345.7066  73.2%  3790 3016s
H 3782  2136                    24483.705662 42345.7066  73.0%  3790 3025s
H 3782  2028                    24542.267574 42345.7066  72.5%  3790 3025s
H 3782  1926                    24558.756197 42345.7066  72.4%  3790 3025s
H 3782  1829                    24576.697542 42345.7066  72.3%  3790 3026s
H 3782  1737                    24592.048961 42345.7066  72.2%  3790 3026s
  3784  1738 38310.9731   10  413 24592.0490 42345.7066  72.2%  3788 3031s
  3785  1739 32944.5258   24  454 24592.0490 42345.7066  72.2%  3787 3045s
  3786  1739 39441.4271   12  470 24592.0490 42345.7066  72.2%  3786 3051s
  3787  1740 26837.0748   47  461 24592.0490 42345.7066  72.2%  3785 3056s
  3788  1741 34046.5093   45  464 24592.0490 42345.7066  72.2%  3784 3063s
  3789  1741 26742.0024   70  464 24592.0490 42345.7066  72.2%  3783 3081s
H 3789  1654                    24685.842417 42345.7066  71.5%  3783 3166s
  3791  1658 42345.7066   10  396 24685.8424 42345.7066  71.5%  3881 3226s
  3792  1659 42345.7066   11  378 24685.8424 42345.7066  71.5%  3882 3245s
  3794  1663 42345.7066   12  381 24685.8424 42345.7066  71.5%  3883 3306s
  3798  1670 42345.7066   12  431 24685.8424 42345.7066  71.5%  3896 3411s
  3807  1685 41808.4408   13  402 24685.8424 42345.7066  71.5%  3950 3478s
  3825  1687 40703.6289   14  383 24685.8424 42345.7066  71.5%  4111 3600s

Cutting planes:
  Projected implied bound: 95
  MIR: 938
  Mixing: 2
  Flow cover: 1776
  RLT: 13
  Relax-and-lift: 199

Explored 3833 nodes (16447451 simplex iterations) in 3600.15 seconds (8162.18 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 24685.8 24592 24576.7 ... 24291.7

Time limit reached
Best objective 2.468584241650e+04, best bound 4.234570661867e+04, gap 71.5384%
  WARNING: Time limit reached. Using best solution found (gap: 71.54%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 1) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 24685.84, θ = 176545.89
  Upper Bound (UB) = 24685.84

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 176545.89
  [DEBUG]   ✓ Scenario 0: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 176545.89 ≤ Q = 176545.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 176545.89 ≤ Q = 176545.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 176545.89 ≤ Q = 176545.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 176545.89 ≤ Q = 176545.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 176545.89 ≤ Q = 176545.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 176545.89 ≤ Q = 176545.89 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 176545.89 ≤ Q = 176545.89 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0xb81130f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xf47eecf1
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.341960e+13
Presolve removed 2623 rows and 1915 columns
Presolve time: 0.00s
Presolved: 470 rows, 474 columns, 1325 nonzeros
Found heuristic solution: objective 6178442.3882
Variable types: 322 continuous, 152 integer (152 binary)

Root relaxation: objective -1.474266e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -147426.58    0  123 6178442.39 -147426.58   102%     -    0s
H    0     0                    -116141.3395 -147426.58  26.9%     -    0s
H    0     0                    -117348.8763 -147426.58  25.6%     -    0s
     0     0 -126362.07    0  103 -117348.88 -126362.07  7.68%     -    0s
H    0     0                    -122571.4695 -126219.08  2.98%     -    0s
     0     0 -125090.64    0  114 -122571.47 -125090.64  2.06%     -    0s
H    0     0                    -123435.3060 -125088.82  1.34%     -    0s
     0     0 -124659.03    0   91 -123435.31 -124659.03  0.99%     -    0s
     0     0 -124518.36    0  111 -123435.31 -124518.36  0.88%     -    0s
     0     0 -124396.99    0  111 -123435.31 -124396.99  0.78%     -    0s
     0     0 -124379.88    0  111 -123435.31 -124379.88  0.77%     -    0s
     0     0 -124272.60    0  107 -123435.31 -124272.60  0.68%     -    0s
     0     0 -124245.32    0  107 -123435.31 -124245.32  0.66%     -    0s
H    0     0                    -123439.4502 -124245.32  0.65%     -    0s
     0     2 -124245.32    0  107 -123439.45 -124245.32  0.65%     -    0s
H  291    46                    -123439.8227 -123726.34  0.23%   7.9    0s
H  316    46                    -123452.9137 -123726.34  0.22%   7.7    0s
H  603    27                    -123455.4140 -123530.86  0.06%   6.6    0s
*  605    27              38    -123468.8775 -123530.86  0.05%   6.6    0s

Cutting planes:
  Gomory: 40
  Implied bound: 3
  MIR: 214
  Flow cover: 9
  RLT: 3
  BQP: 1

Explored 655 nodes (4758 simplex iterations) in 0.11 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -123469 -123455 -123453 ... 6.17844e+06
No other solutions better than -123469

Optimal solution found (tolerance 1.00e-06)
Best objective -1.234688775220e+05, best bound -1.234688775220e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 171946.30
  Scenario: 48 demand increases, 12 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -123468.88
  [DEBUG]   S×d_nominal = 295415.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 295415.18 + -123468.88 = 171946.30
  [DEBUG]   Current θ from Master = 176545.89
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4599.58 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20086.26
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = -401.0189, Absolute Gap = 401.0189, Relative Gap = -0.016245
  ⚠️  WARNING: NEGATIVE GAP detected!
  UB = 24685.84, LB = 25086.86, Gap = -401.02
  Possible causes:
    1. Subproblem returned suboptimal Z_SP (too large → LB over-estimated)
    2. Master Problem returned suboptimal θ (too small → UB under-estimated)
    3. Numerical precision issues in bound calculations
  Algorithm will continue to search for better solutions...

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 48 increases, 12 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783461 nonzeros
Model fingerprint: 0x27045872
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [4e-01, 2e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 134532 rows and 54612 columns
Presolve time: 2.60s
Presolved: 142071 rows, 59968 columns, 876672 nonzeros
Variable types: 57709 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -310053.6270
Found heuristic solution: objective -171254.7355

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.41s

Barrier statistics:
 Dense cols : 555
 AA' NZ     : 8.437e+06
 Factor NZ  : 1.803e+07 (roughly 230 MB of memory)
 Factor Ops : 4.171e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.94788827e+07  2.49721074e+08  1.35e+05 1.88e+01  9.00e+04     5s
   1  -1.52968606e+07  2.33789264e+08  9.73e+04 8.80e+01  6.43e+04     5s
   2  -5.35823070e+06  1.76635213e+08  3.38e+04 4.58e+00  2.40e+04     6s
   3  -1.18875267e+06  1.34814739e+08  3.67e+03 1.35e+00  3.00e+03     6s
   4  -6.43349088e+05  1.04518146e+08  7.62e+02 7.95e-01  8.97e+02     6s
   5  -5.74935397e+05  6.79281405e+07  5.67e+02 4.58e-01  6.00e+02     6s
   6  -4.58550075e+05  4.40548481e+07  2.41e+02 2.64e-01  3.03e+02     6s
   7  -3.77720153e+05  3.40066700e+07  5.39e+01 1.94e-01  1.60e+02     6s
   8  -3.05319752e+05  2.32233933e+07  9.28e+00 1.28e-01  9.45e+01     6s
   9  -2.08950237e+05  1.49086800e+07  2.11e+00 8.13e-02  5.89e+01     6s
  10  -1.89389003e+05  1.00565461e+07  1.62e+00 5.45e-02  3.98e+01     6s
  11  -1.49593016e+05  4.68238196e+06  9.90e-01 2.53e-02  1.87e+01     6s
  12  -9.51945408e+04  2.31685463e+06  4.49e-01 1.22e-02  9.32e+00     6s
  13  -7.17508142e+04  1.50417498e+06  2.65e-01 7.68e-03  6.09e+00     6s
  14  -3.98544978e+04  5.90016443e+05  9.98e-02 2.67e-03  2.43e+00     7s
  15  -1.19830278e+04  2.76579202e+05  4.96e-02 1.28e-03  1.11e+00     7s
  16   8.87417189e+03  1.96494501e+05  2.85e-02 1.04e-03  7.24e-01     7s
  17   1.84600203e+04  1.50247841e+05  2.14e-02 9.13e-04  5.08e-01     7s
  18   2.34469377e+04  1.21607710e+05  1.78e-02 6.45e-04  3.79e-01     7s
  19   2.91586568e+04  1.07948896e+05  1.41e-02 5.13e-04  3.04e-01     7s
  20   3.42012663e+04  8.81038926e+04  1.13e-02 2.98e-04  2.08e-01     7s
  21   3.91998266e+04  7.91567044e+04  8.49e-03 2.15e-04  1.54e-01     7s
  22   4.01512506e+04  7.55554875e+04  8.00e-03 1.87e-04  1.37e-01     7s
  23   4.40116006e+04  6.89568616e+04  5.99e-03 1.22e-04  9.62e-02     7s
  24   4.67832883e+04  6.41216851e+04  4.61e-03 2.21e-04  6.69e-02     7s
  25   4.91504027e+04  6.14492071e+04  3.48e-03 1.35e-04  4.74e-02     8s
  26   5.17271235e+04  5.95670971e+04  2.27e-03 1.57e-04  3.02e-02     8s
  27   5.32556693e+04  5.87246593e+04  1.56e-03 1.09e-04  2.11e-02     8s
  28   5.38009324e+04  5.82675218e+04  1.31e-03 8.12e-05  1.72e-02     8s
  29   5.49269828e+04  5.80065587e+04  8.14e-04 6.50e-05  1.19e-02     8s
  30   5.57386037e+04  5.74465840e+04  4.66e-04 3.11e-05  6.59e-03     8s
  31   5.62734531e+04  5.73012505e+04  2.44e-04 2.24e-05  3.96e-03     8s
  32   5.65116699e+04  5.70887876e+04  1.49e-04 9.85e-06  2.23e-03     8s
  33   5.67016639e+04  5.70204947e+04  7.65e-05 5.79e-06  1.23e-03     8s
  34   5.68289300e+04  5.69571866e+04  2.89e-05 7.61e-06  4.95e-04     9s
  35   5.68483573e+04  5.69320325e+04  2.18e-05 3.12e-06  3.23e-04     9s
  36   5.68938634e+04  5.69215260e+04  5.39e-06 1.56e-06  1.07e-04     9s
  37   5.69104159e+04  5.69207459e+04  7.67e-07 1.42e-06  3.98e-05     9s
  38   5.69112897e+04  5.69145246e+04  5.29e-07 2.26e-07  1.25e-05     9s
  39   5.69129801e+04  5.69135316e+04  9.80e-08 4.78e-08  2.13e-06     9s
  40   5.69132408e+04  5.69132464e+04  6.57e-09 1.14e-08  2.14e-08     9s
  41   5.69132451e+04  5.69132454e+04  1.50e-07 7.34e-10  1.25e-09    10s

Barrier solved model in 41 iterations and 9.50 seconds (14.78 work units)
Optimal objective 5.69132451e+04


Root crossover log...

  130462 DPushes remaining with DInf 0.0000000e+00                10s
   59740 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

   12797 PPushes remaining with PInf 3.9402812e-05                14s
    1978 PPushes remaining with PInf 3.1637037e-05                15s
       0 PPushes remaining with PInf 0.0000000e+00                15s

  Push phase complete: Pinf 0.0000000e+00, Dinf 2.0607599e+04     15s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   79516    5.6913245e+04   0.000000e+00   2.060760e+04     16s
   79966    5.6913245e+04   0.000000e+00   0.000000e+00     16s
   79966    5.6913245e+04   0.000000e+00   0.000000e+00     16s
Concurrent spin time: 0.02s

Solved with barrier

Root relaxation: objective 5.691325e+04, 79966 iterations, 12.84 seconds (22.41 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56913.2454    0   73 -171254.74 56913.2454   133%     -   16s
H    0     0                    -73587.60516 56913.2454   177%     -   17s
H    0     0                    -73462.15747 56913.2454   177%     -   17s
H    0     0                    4760.1452904 56913.2454  1096%     -   17s
H    0     0                    11547.747295 56913.2454   393%     -   18s
H    0     0                    11966.112031 56913.2454   376%     -   18s
     0     0 52908.8051    0  182 11966.1120 52908.8051   342%     -   59s
H    0     0                    12131.359984 52907.5292   336%     -   60s
H    0     0                    12259.618699 52907.5292   332%     -   60s
H    0     0                    12338.938447 52907.5292   329%     -   60s
     0     0 52266.9317    0  193 12338.9384 52266.9317   324%     -   79s
     0     0 52212.5977    0  182 12338.9384 52212.5977   323%     -   85s
     0     0 52209.5487    0  185 12338.9384 52209.5487   323%     -   86s
     0     0 52209.4495    0  185 12338.9384 52209.4495   323%     -   87s
     0     0 49815.4186    0  206 12338.9384 49815.4186   304%     -  120s
H    0     0                    13284.566426 49815.4073   275%     -  120s
H    0     0                    13945.418186 49815.4073   257%     -  120s
H    0     0                    16434.427658 49815.4073   203%     -  120s
H    0     0                    16588.942725 49815.4073   200%     -  120s
H    0     0                    17179.111931 49815.4073   190%     -  120s
     0     0 49337.2948    0  230 17179.1119 49337.2948   187%     -  147s
     0     0 49088.8696    0  241 17179.1119 49088.8696   186%     -  162s
     0     0 48891.0644    0  256 17179.1119 48891.0644   185%     -  177s
     0     0 48836.1867    0  254 17179.1119 48836.1867   184%     -  185s
     0     0 48828.0871    0  261 17179.1119 48828.0871   184%     -  189s
     0     0 48731.1961    0  251 17179.1119 48731.1961   184%     -  199s
     0     0 48714.9596    0  261 17179.1119 48714.9596   184%     -  204s
     0     0 48706.3808    0  256 17179.1119 48706.3808   184%     -  206s
     0     0 48705.2946    0  260 17179.1119 48705.2946   184%     -  207s
     0     0 48702.0886    0  257 17179.1119 48702.0886   183%     -  209s
     0     0 48688.4717    0  260 17179.1119 48688.4717   183%     -  213s
     0     0 48687.4501    0  259 17179.1119 48687.4501   183%     -  214s
     0     0 48687.2530    0  259 17179.1119 48687.2530   183%     -  215s
     0     0 46949.3800    0  323 17179.1119 46949.3800   173%     -  275s
     0     0 46614.9726    0  330 17179.1119 46614.9726   171%     -  296s
     0     0 46377.4667    0  332 17179.1119 46377.4667   170%     -  316s
     0     0 46303.6900    0  330 17179.1119 46303.6900   170%     -  327s
     0     0 46232.7931    0  338 17179.1119 46232.7931   169%     -  340s
     0     0 46114.0891    0  341 17179.1119 46114.0891   168%     -  349s
     0     0 46084.1075    0  350 17179.1119 46084.1075   168%     -  356s
     0     0 46070.2800    0  348 17179.1119 46070.2800   168%     -  360s
     0     0 46059.3674    0  348 17179.1119 46059.3674   168%     -  365s
     0     0 46043.6435    0  344 17179.1119 46043.6435   168%     -  369s
     0     0 46042.3321    0  349 17179.1119 46042.3321   168%     -  371s
     0     0 46040.3217    0  349 17179.1119 46040.3217   168%     -  373s
     0     0 46039.7251    0  349 17179.1119 46039.7251   168%     -  375s
     0     0 45236.9346    0  355 17179.1119 45236.9346   163%     -  408s
     0     0 45108.2010    0  359 17179.1119 45108.2010   163%     -  421s
     0     0 44981.9379    0  365 17179.1119 44981.9379   162%     -  431s
     0     0 44881.5162    0  370 17179.1119 44881.5162   161%     -  439s
     0     0 44820.0834    0  370 17179.1119 44820.0834   161%     -  448s
     0     0 44798.3385    0  379 17179.1119 44798.3385   161%     -  454s
     0     0 44714.2654    0  371 17179.1119 44714.2654   160%     -  470s
     0     0 44700.0665    0  375 17179.1119 44700.0665   160%     -  476s
     0     0 44691.6719    0  365 17179.1119 44691.6719   160%     -  480s
     0     0 44688.9686    0  374 17179.1119 44688.9686   160%     -  484s
     0     0 44687.2437    0  372 17179.1119 44687.2437   160%     -  486s
     0     0 44687.1380    0  375 17179.1119 44687.1380   160%     -  486s
     0     0 44508.3136    0  444 17179.1119 44508.3136   159%     -  510s
H    0     0                    20827.443009 44507.5261   114%     -  511s
     0     0 44469.8842    0  458 20827.4430 44469.8842   114%     -  521s
     0     0 44435.9645    0  449 20827.4430 44435.9645   113%     -  529s
     0     0 44428.4702    0  446 20827.4430 44428.4702   113%     -  535s
     0     0 44425.3694    0  451 20827.4430 44425.3694   113%     -  539s
     0     0 44419.2968    0  449 20827.4430 44419.2968   113%     -  543s
     0     0 44415.2606    0  463 20827.4430 44415.2606   113%     -  549s
     0     0 44414.5308    0  458 20827.4430 44414.5308   113%     -  550s
     0     0 44185.0255    0  407 20827.4430 44185.0255   112%     -  574s
     0     0 44108.0377    0  411 20827.4430 44108.0377   112%     -  587s
     0     0 44071.4777    0  401 20827.4430 44071.4777   112%     -  594s
     0     0 44056.6454    0  410 20827.4430 44056.6454   112%     -  601s
     0     0 44045.6593    0  403 20827.4430 44045.6593   111%     -  604s
     0     0 44036.5331    0  408 20827.4430 44036.5331   111%     -  608s
     0     0 44033.2549    0  411 20827.4430 44033.2549   111%     -  610s
     0     0 44031.2262    0  408 20827.4430 44031.2262   111%     -  612s
     0     0 44030.7639    0  408 20827.4430 44030.7639   111%     -  613s
     0     0 43970.9377    0  380 20827.4430 43970.9377   111%     -  624s
     0     0 43938.3511    0  394 20827.4430 43938.3511   111%     -  630s
     0     0 43929.7966    0  402 20827.4430 43929.7966   111%     -  633s
     0     0 43923.3880    0  386 20827.4430 43923.3880   111%     -  635s
     0     0 43918.9799    0  392 20827.4430 43918.9799   111%     -  637s
     0     0 43917.2497    0  382 20827.4430 43917.2497   111%     -  638s
     0     0 43916.9429    0  388 20827.4430 43916.9429   111%     -  639s
     0     0 43887.5881    0  380 20827.4430 43887.5881   111%     -  646s
     0     0 43872.3749    0  378 20827.4430 43872.3749   111%     -  650s
     0     0 43860.1667    0  395 20827.4430 43860.1667   111%     -  654s
     0     0 43854.9838    0  391 20827.4430 43854.9838   111%     -  657s
     0     0 43853.2950    0  393 20827.4430 43853.2950   111%     -  658s
     0     0 43852.0015    0  396 20827.4430 43852.0015   111%     -  659s
     0     0 43827.5270    0  393 20827.4430 43827.5270   110%     -  665s
     0     0 43821.4777    0  390 20827.4430 43821.4777   110%     -  668s
     0     0 43819.0615    0  392 20827.4430 43819.0615   110%     -  669s
     0     0 43818.5938    0  388 20827.4430 43818.5938   110%     -  670s
     0     0 43806.8231    0  392 20827.4430 43806.8231   110%     -  673s
     0     0 43805.7761    0  400 20827.4430 43805.7761   110%     -  675s
     0     0 43798.6942    0  389 20827.4430 43798.6942   110%     -  678s
     0     0 43794.2788    0  465 20827.4430 43794.2788   110%     -  681s
     0     0 43793.8265    0  398 20827.4430 43793.8265   110%     -  682s
     0     0 43787.1444    0  397 20827.4430 43787.1444   110%     -  687s
     0     0 43785.9656    0  410 20827.4430 43785.9656   110%     -  689s
     0     0 43781.5188    0  398 20827.4430 43781.5188   110%     -  694s
     0     0 43781.5015    0  398 20827.4430 43781.5015   110%     -  696s
     0     2 43781.5015    0  398 20827.4430 43781.5015   110%     -  856s
     1     3 42641.9992    1  368 20827.4430 43781.5015   110% 28551  886s
     2     4 43587.9039    1  386 20827.4430 43587.9039   109% 18117  896s
     3     7 41550.6743    2  353 20827.4430 43587.8973   109% 17001  912s
     6    14 43197.3814    3  476 20827.4430 43586.2071   109% 14578  936s
    13    28 43092.9016    4  389 20827.4430 43356.1409   108% 14205  965s
    27    42 42884.7207    5  400 20827.4430 43238.7128   108% 19426 1059s
    41    72 42315.6207    6  380 20827.4430 43238.7128   108% 22950 1197s
    71   188 42191.7184    7  368 20827.4430 43069.5116   107% 22547 1256s
   187   220 42064.0351    9  356 20827.4430 42889.1723   106% 13605 1281s
H  196   220                    22670.316544 42889.1723  89.2% 13490 1281s
   219   254 41932.0272    9  352 22670.3165 42889.1723  89.2% 13966 1310s
H  220   254                    22929.694564 42889.1723  87.0% 13902 1310s
H  222   254                    22985.250458 42889.1723  86.6% 13867 1310s
H  224   254                    23170.786097 42889.1723  85.1% 13792 1310s
H  235   254                    23246.332849 42889.1723  84.5% 13691 1310s
H  239   254                    23393.828084 42889.1723  83.3% 13627 1310s
   253   283 42018.0228   10  357 23393.8281 42889.1723  83.3% 13305 1333s
   282   313 40877.2827   10  343 23393.8281 42889.1723  83.3% 13008 1427s
   312   366 41476.1691    9  287 23393.8281 42889.1723  83.3% 12476 1457s
   365   415 41448.7438    9  339 23393.8281 42889.1723  83.3% 11471 1485s
   414   468 41734.3902   10  303 23393.8281 42889.1723  83.3% 10983 1514s
   467   534 41839.8598   11  343 23393.8281 42889.1723  83.3% 10653 1542s
   533   606 41162.5299   10  295 23393.8281 42889.1723  83.3% 10350 1568s
   605   668 41712.9384   11  351 23393.8281 42889.1723  83.3% 10063 1591s
   667   722 41686.7294   12  344 23393.8281 42889.1723  83.3%  9908 1614s
H  687   722                    23936.410882 42889.1723  79.2%  9891 1614s
H  692   722                    24144.304651 42889.1723  77.6%  9837 1614s
   721   776 41695.5925   12  337 24144.3047 42889.1723  77.6%  9778 1636s
   775   835 41583.0167   12  344 24144.3047 42889.1723  77.6%  9831 1658s
H  776   835                    24351.617648 42889.1723  76.1%  9819 1658s
H  830   835                    24357.624050 42889.1723  76.1%  9701 1658s
   834   913 41542.9260   13  341 24357.6241 42889.1723  76.1%  9740 1680s
   912   996 41388.8152   13  338 24357.6241 42889.1723  76.1%  9464 1703s
   995  1037 37391.4324   43  239 24357.6241 42889.1723  76.1%  9210 1728s
H  998  1037                    24393.275489 42889.1723  75.8%  9191 1728s
H 1001  1037                    24679.943544 42889.1723  73.8%  9178 1728s
  1036  1108 41469.8136   14  343 24679.9435 42889.1723  73.8%  9132 1753s
H 1052  1108                    24772.061011 42889.1723  73.1%  9091 1753s
H 1062  1108                    24789.920443 42889.1723  73.0%  9076 1753s
H 1077  1108                    24845.417273 42889.1723  72.6%  9017 1753s
H 1087  1108                    24936.213301 42889.1723  72.0%  9017 1753s
  1111  1190 40557.6441   15  325 24936.2133 42889.1723  72.0%  9000 1781s
  1200  1246 41373.8707   15  337 24936.2133 42889.1723  72.0%  8879 1805s
  1289  1282 39864.9262   16  313 24936.2133 42889.1723  72.0%  8779 1837s
  1366  1307 40423.3928   15  330 24936.2133 42889.1723  72.0%  8827 1872s
H 1377  1307                    24999.307965 42823.7642  71.3%  8847 1872s
  1409  1373 40225.3445   16  330 24999.3080 42823.7642  71.3%  8939 1910s
  1501  1436 40901.9731   16  326 24999.3080 42823.7642  71.3%  8923 1944s
  1592  1494 37929.5772   17  300 24999.3080 42823.7642  71.3%  8974 1983s
  1692  1562 40059.3584   16  323 24999.3080 42823.7642  71.3%  8957 2024s
  1800  1592 39552.2817   18  294 24999.3080 42823.7642  71.3%  8981 2066s
H 1840  1592                    25093.331607 42740.7184  70.3%  9107 2066s
  1852  1665 37404.9481   19  234 25093.3316 42740.7184  70.3%  9164 2106s
  1945  1755 35544.2420   17  332 25093.3316 42740.7184  70.3%  9302 2147s
  2100  1817 37359.9862   20  231 25093.3316 42740.7184  70.3%  9154 2194s
  2240  1883 35167.2222   22  182 25093.3316 42740.7184  70.3%  9056 2240s
  2351  1957 32922.8866   23  305 25093.3316 42536.8581  69.5%  9148 2286s
  2461  2046 32430.3020   23  348 25093.3316 42535.4539  69.5%  9216 2341s
  2590  2123 31375.1785   23  235 25093.3316 42535.4539  69.5%  9280 2392s
  2717  2224 31483.7342   26  165 25093.3316 42513.6444  69.4%  9335 2445s
  2846  2323 30707.4085   30  138 25093.3316 42513.6444  69.4%  9367 2498s
H 2854  2322                    25156.009337 42513.6444  69.0%  9368 2498s
  2971  2463 30167.5099   34  125 25156.0093 42513.6444  69.0%  9387 2554s
  3142  2614 28352.7142   38  101 25156.0093 42513.6444  69.0%  9388 2606s
  3362  2685 28079.0899   47  178 25156.0093 42513.6444  69.0%  9288 2666s
  3527  2810 26592.9496   48  259 25156.0093 42513.6444  69.0%  9350 2730s
  3717  2924 infeasible   50      25156.0093 42513.6444  69.0%  9362 2794s
  3984  2952 infeasible   43      25156.0093 42315.0721  68.2%  9220 2854s
  4034  2990 41619.2359    5  316 25156.0093 42315.0721  68.2%  9312 2912s
  4112  3046 41551.4806    6  305 25156.0093 42315.0721  68.2%  9352 2974s
  4265  3118 38103.4604    7  281 25156.0093 42315.0721  68.2%  9361 3045s
H 4330  3114                    25223.403071 42315.0721  67.8%  9381 3045s
  4429  3183 36672.6124    9  207 25223.4031 42315.0721  67.8%  9388 3109s
  4569  3184 25756.0985   53  398 25223.4031 42315.0721  67.8%  9476 3445s
  4571  3185 39335.5371   16   73 25223.4031 42315.0721  67.8%  9472 3462s
  4572  3186 26644.1147   37  245 25223.4031 42315.0721  67.8%  9470 3586s

Cutting planes:
  MIR: 444
  Mixing: 1
  Flow cover: 444
  RLT: 5
  Relax-and-lift: 77

Explored 4572 nodes (44145004 simplex iterations) in 3600.06 seconds (8960.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25223.4 25156 25093.3 ... 24393.3

Time limit reached
Best objective 2.522340307125e+04, best bound 4.231507214796e+04, gap 67.7612%
  WARNING: Time limit reached. Using best solution found (gap: 67.76%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.19s
  Master Objective (UB) = 25223.40, θ = 184286.77
  Upper Bound (UB) = 25223.40

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 184286.77
  [DEBUG]   ✓ Scenario 0: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 184286.77 ≤ Q = 184286.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 184286.77 ≤ Q = 184286.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 184286.77 ≤ Q = 184286.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 184286.77 ≤ Q = 184286.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 184286.77 ≤ Q = 184286.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 184286.77 ≤ Q = 184286.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 184286.77 ≤ Q = 184286.77 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG]   ✓ Scenario 17: θ = 184286.77 ≤ Q = 184286.77 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x31171e5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfcee8e1b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.255653e+13
Presolve removed 2622 rows and 1913 columns
Presolve time: 0.00s
Presolved: 471 rows, 476 columns, 1328 nonzeros
Found heuristic solution: objective 5549489.8284
Variable types: 324 continuous, 152 integer (152 binary)

Root relaxation: objective -1.639963e+05, 237 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -163996.32    0  123 5549489.83 -163996.32   103%     -    0s
H    0     0                    -132331.8377 -163996.32  23.9%     -    0s
H    0     0                    -132706.9713 -163996.32  23.6%     -    0s
     0     0 -141877.26    0   79 -132706.97 -141877.26  6.91%     -    0s
H    0     0                    -139768.6196 -141777.33  1.44%     -    0s
H    0     0                    -140066.2433 -141777.33  1.22%     -    0s
H    0     0                    -140358.2347 -141777.33  1.01%     -    0s
H    0     0                    -140655.8585 -141777.33  0.80%     -    0s
     0     0 -141175.71    0   27 -140655.86 -141175.71  0.37%     -    0s
     0     0 -140994.01    0   17 -140655.86 -140994.01  0.24%     -    0s
     0     0 -140925.71    0   10 -140655.86 -140925.71  0.19%     -    0s
     0     0 -140880.37    0    8 -140655.86 -140880.37  0.16%     -    0s
H    0     0                    -140742.1197 -140815.19  0.05%     -    0s
     0     0 -140815.19    0    7 -140742.12 -140815.19  0.05%     -    0s
     0     0 -140814.12    0    6 -140742.12 -140814.12  0.05%     -    0s
     0     0 -140783.27    0    2 -140742.12 -140783.27  0.03%     -    0s
     0     0 -140759.15    0    5 -140742.12 -140759.15  0.01%     -    0s
     0     0 -140757.44    0    4 -140742.12 -140757.44  0.01%     -    0s
H    0     0                    -140744.7050 -140757.44  0.01%     -    0s
     0     0 -140745.60    0    2 -140744.70 -140745.60  0.00%     -    0s
     0     0     cutoff    0      -140744.70 -140744.70  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 4
  Flow cover: 2
  RLT: 1
  Relax-and-lift: 2

Explored 1 nodes (524 simplex iterations) in 0.06 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -140745 -140745 -140742 ... 5.54949e+06
No other solutions better than -140745

Optimal solution found (tolerance 1.00e-06)
Best objective -1.407447049839e+05, best bound -1.407447049839e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 178522.24
  Scenario: 21 demand increases, 39 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -140744.70
  [DEBUG]   S×d_nominal = 319266.95
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 319266.95 + -140744.70 = 178522.24
  [DEBUG]   Current θ from Master = 184286.77
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5764.52 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 19458.88
  Lower Bound (LB) = 25086.86
  Gap (UB-LB) = 136.5418, Absolute Gap = 136.5418, Relative Gap = 0.005413
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 18
Total Time: 47343.55s
Converged: True
Final Lower Bound: 25086.8613
Final Upper Bound: 25223.4031
Final Gap: 136.541765
Number of Critical Scenarios: 18
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [1] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [0, 2, 4, 6, 7] (5/10)
Active Routes (Plant→DC): 12
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 0 customers  Mode 1: 1 customers  Mode 2: 49 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 18
Start Time: 2026-01-03 12:05:42
End Time: 2026-01-04 01:14:46
Total Time: 47343.55s
Optimal Value: 25086.86
Lower Bound: 25086.86
Upper Bound: 25223.40
Gap: 136.541765
Plants Opened: {0: [1], 1: [1], 2: [1]} (3 plants)
DCs Opened: [0, 2, 4, 6, 7] (5 DCs)
================================================================================

Results saved to: result/DH_single_full_seed25_HD_gamma20_20260104_011446.csv

Total Execution Time: 47344.41 seconds
End Time: 2026-01-04 01:14:47

All tasks completed successfully!

