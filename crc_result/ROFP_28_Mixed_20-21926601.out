
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 28
DI Scenario: Mixed
Start Time: 2026-01-03 19:35:10
================================================================================
Loading data from data/DH_data_full_seed28.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.444', '2.086'] (k=0.907)
  Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
  Product 2: ['1.000', '1.062', '1.127'] (k=0.148)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=901, max=1771
  DC capacity (MC): min=401, max=771

Demand Structure (s_rk matrix):
  Total customer-product pairs: 80/150 (46.7% sparse)
  Average products per customer: 1.60

Demand (only non-zero entries):
  Nominal (μ): min=8.50, max=34.59, count=80
  Deviation (μ̂): min=4.08, max=9.98

Costs:
  Plant fixed cost: min=5810, max=9892
  DC fixed cost: min=3901, max=5911
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.444', '2.086'] (k=0.907)
    Product 1: ['1.000', '1.332', '1.773'] (k=0.707)
    Product 2: ['1.000', '1.380', '1.904'] (k=0.794)
  MD:
    Product 0: ['1.000', '1.242', '1.543'] (k=0.535)
    Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
    Product 2: ['1.000', '1.212', '1.470'] (k=0.475)
  LD:
    Product 0: ['1.000', '1.049', '1.100'] (k=0.117)
    Product 1: ['1.000', '1.032', '1.064'] (k=0.077)
    Product 2: ['1.000', '1.062', '1.127'] (k=0.148)
  Mixed:
    Product 0: ['1.000', '1.444', '2.086'] (k=0.907)
    Product 1: ['1.000', '1.145', '1.311'] (k=0.334)
    Product 2: ['1.000', '1.062', '1.127'] (k=0.148)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48750 nonzeros
Model fingerprint: 0xc88a4669
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11871 rows and 2871 columns
Presolve time: 0.08s
Presolved: 4802 rows, 5629 columns, 33384 nonzeros
Variable types: 3370 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -291858.8607
Found heuristic solution: objective -186122.4392

Root relaxation: objective 9.621041e+04, 5324 iterations, 0.24 seconds (0.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 96210.4140    0  626 -186122.44 96210.4140   152%     -    0s
H    0     0                    -185528.2241 96210.4140   152%     -    0s
H    0     0                    -183736.6880 96210.4140   152%     -    0s
H    0     0                    -178442.3770 96210.4140   154%     -    0s
     0     0 85108.7836    0  814 -178442.38 85108.7836   148%     -    1s
H    0     0                    -176221.3847 85106.5376   148%     -    1s
     0     0 84925.4413    0  804 -176221.38 84925.4413   148%     -    1s
     0     0 84910.6232    0  808 -176221.38 84910.6232   148%     -    1s
     0     0 84910.5037    0  811 -176221.38 84910.5037   148%     -    1s
H    0     0                    -105953.4686 78204.1027   174%     -    2s
     0     0 78204.1027    0  754 -105953.47 78204.1027   174%     -    2s
     0     0 77793.6517    0  751 -105953.47 77793.6517   173%     -    2s
     0     0 77738.4218    0  768 -105953.47 77738.4218   173%     -    2s
     0     0 77728.9937    0  771 -105953.47 77728.9937   173%     -    2s
     0     0 77728.6464    0  773 -105953.47 77728.6464   173%     -    2s
H    0     0                    -100955.7615 77728.6464   177%     -    3s
H    0     0                    -100591.2721 72137.5062   172%     -    4s
H    0     0                    -100554.6494 72137.5062   172%     -    4s
H    0     0                    -100290.3430 72137.5062   172%     -    4s
H    0     0                    -99286.82942 72137.5062   173%     -    4s
H    0     0                    -60530.63188 72137.5062   219%     -    4s
H    0     0                    -60294.58087 72137.5062   220%     -    4s
H    0     0                    -59126.07122 72137.5062   222%     -    4s
H    0     0                    18398.362375 72137.5062   292%     -    4s
H    0     0                    24345.785353 72137.5062   196%     -    4s
     0     0 72137.5062    0  847 24345.7854 72137.5062   196%     -    4s
     0     0 71791.0892    0  851 24345.7854 71791.0892   195%     -    4s
     0     0 71711.7664    0  850 24345.7854 71711.7664   195%     -    4s
     0     0 71704.4585    0  866 24345.7854 71704.4585   195%     -    4s
H    0     0                    24453.631508 66726.4905   173%     -    6s
H    0     0                    24554.523815 66726.4905   172%     -    6s
H    0     0                    26347.520369 66726.4905   153%     -    6s
H    0     0                    26514.479409 66726.4905   152%     -    6s
H    0     0                    26591.530583 66726.4905   151%     -    6s
H    0     0                    26843.212723 66726.4905   149%     -    6s
H    0     0                    27066.016518 66726.4905   147%     -    6s
     0     0 66726.4905    0  882 27066.0165 66726.4905   147%     -    6s
H    0     0                    27136.414517 66337.5225   144%     -    6s
H    0     0                    27505.479528 66337.5225   141%     -    6s
H    0     0                    27622.495711 66337.5225   140%     -    6s
H    0     0                    27723.838636 66337.5225   139%     -    6s
H    0     0                    27772.197767 66337.5225   139%     -    6s
H    0     0                    27775.540448 66337.5225   139%     -    6s
H    0     0                    27827.960265 66337.5225   138%     -    6s
H    0     0                    27879.942812 66337.5225   138%     -    6s
H    0     0                    28039.635319 66337.5225   137%     -    6s
     0     0 66337.5225    0  878 28039.6353 66337.5225   137%     -    6s
     0     0 66253.4894    0  835 28039.6353 66253.4894   136%     -    6s
     0     0 66235.2636    0  900 28039.6353 66235.2636   136%     -    6s
     0     0 66232.2878    0  902 28039.6353 66232.2878   136%     -    6s
H    0     0                    28237.005618 63356.3481   124%     -    7s
H    0     0                    28242.107672 63356.3481   124%     -    7s
H    0     0                    29128.073209 63356.3481   118%     -    7s
H    0     0                    30115.140264 63356.3481   110%     -    7s
H    0     0                    30250.019934 63356.3481   109%     -    7s
H    0     0                    30253.063969 63356.3481   109%     -    7s
H    0     0                    30330.516215 63356.3481   109%     -    7s
H    0     0                    30427.367121 63356.3481   108%     -    7s
     0     0 63356.3481    0  822 30427.3671 63356.3481   108%     -    7s
H    0     0                    30526.377046 62962.8408   106%     -    8s
     0     0 62962.8408    0  846 30526.3770 62962.8408   106%     -    8s
     0     0 62902.0826    0  860 30526.3770 62902.0826   106%     -    8s
     0     0 62898.2415    0  852 30526.3770 62898.2415   106%     -    8s
     0     0 60367.6258    0  739 30526.3770 60367.6258  97.8%     -    9s
H    0     0                    30687.101755 59946.9087  95.3%     -    9s
     0     0 59946.9087    0  825 30687.1018 59946.9087  95.3%     -    9s
     0     0 59862.8323    0  799 30687.1018 59862.8323  95.1%     -   10s
     0     0 59839.3083    0  809 30687.1018 59839.3083  95.0%     -   10s
     0     0 59837.3722    0  817 30687.1018 59837.3722  95.0%     -   10s
H    0     0                    31032.061522 57004.9269  83.7%     -   11s
H    0     0                    31759.822622 57004.9269  79.5%     -   11s
H    0     0                    31761.143745 57004.9269  79.5%     -   11s
H    0     0                    32136.516998 57004.9269  77.4%     -   11s
H    0     0                    32144.134790 57004.9269  77.3%     -   11s
     0     0 57004.9269    0  633 32144.1348 57004.9269  77.3%     -   11s
H    0     0                    32400.088703 56377.1260  74.0%     -   12s
H    0     0                    32440.258331 56377.1260  73.8%     -   12s
     0     0 56377.1260    0  790 32440.2583 56377.1260  73.8%     -   12s
     0     0 56246.4752    0  787 32440.2583 56246.4752  73.4%     -   12s
     0     0 56222.2718    0  864 32440.2583 56222.2718  73.3%     -   12s
     0     0 54731.4182    0  824 32440.2583 54731.4182  68.7%     -   13s
H    0     0                    33123.437295 54300.5813  63.9%     -   14s
     0     0 54300.5813    0  897 33123.4373 54300.5813  63.9%     -   14s
     0     0 54212.4085    0  882 33123.4373 54212.4085  63.7%     -   14s
     0     0 54187.6493    0  905 33123.4373 54187.6493  63.6%     -   14s
H    0     0                    33248.181323 53048.1292  59.6%     -   16s
     0     0 53048.1292    0  836 33248.1813 53048.1292  59.6%     -   16s
H    0     0                    33359.938324 52750.5091  58.1%     -   16s
H    0     0                    33391.356546 52750.5091  58.0%     -   16s
H    0     0                    33407.793429 52750.5091  57.9%     -   16s
H    0     0                    33414.264527 52750.5091  57.9%     -   16s
     0     0 52750.5091    0  867 33414.2645 52750.5091  57.9%     -   16s
     0     0 52692.3171    0  886 33414.2645 52692.3171  57.7%     -   16s
     0     0 52679.2123    0  879 33414.2645 52679.2123  57.7%     -   17s
     0     0 51950.7993    0  901 33414.2645 51950.7993  55.5%     -   18s
     0     0 51798.9796    0  941 33414.2645 51798.9796  55.0%     -   18s
     0     0 51758.2934    0  924 33414.2645 51758.2934  54.9%     -   18s
H    0     0                    33497.034644 51742.2057  54.5%     -   18s
H    0     0                    33508.552809 51742.2057  54.4%     -   18s
     0     0 51742.2057    0  946 33508.5528 51742.2057  54.4%     -   18s
H    0     0                    33558.948729 51742.2057  54.2%     -   18s
H    0     0                    33845.784514 51150.6684  51.1%     -   20s
H    0     0                    33861.101643 51150.6684  51.1%     -   20s
H    0     0                    33862.857495 51150.6684  51.1%     -   20s
H    0     0                    33888.194008 51150.6684  50.9%     -   20s
     0     0 51150.6684    0  892 33888.1940 51150.6684  50.9%     -   20s
     0     0 51031.9273    0  918 33888.1940 51031.9273  50.6%     -   20s
     0     0 51006.5445    0  892 33888.1940 51006.5445  50.5%     -   20s
     0     0 50613.2506    0  776 33888.1940 50613.2506  49.4%     -   21s
     0     0 50453.8219    0  855 33888.1940 50453.8219  48.9%     -   22s
     0     0 50411.4043    0  910 33888.1940 50411.4043  48.8%     -   22s
     0     0 50083.9906    0  896 33888.1940 50083.9906  47.8%     -   23s
     0     0 49902.8742    0  878 33888.1940 49902.8742  47.3%     -   24s
     0     0 49830.3993    0  928 33888.1940 49830.3993  47.0%     -   24s
     0     0 49801.2455    0  955 33888.1940 49801.2455  47.0%     -   25s
     0     0 49544.7825    0  838 33888.1940 49544.7825  46.2%     -   25s
     0     0 49466.0222    0  896 33888.1940 49466.0222  46.0%     -   26s
     0     0 49455.0233    0  907 33888.1940 49455.0233  45.9%     -   26s
     0     0 49234.1994    0  778 33888.1940 49234.1994  45.3%     -   27s
     0     0 49233.9808    0  778 33888.1940 49233.9808  45.3%     -   27s
     0     2 49233.8188    0  778 33888.1940 49233.8188  45.3%     -   29s
     1     4 49068.4227    1  712 33888.1940 49233.8188  45.3%  1781   30s
    31    64 47147.5785    5  677 33888.1940 47955.7365  41.5%  3024   36s
   237   313 46725.6145   11  407 33888.1940 47796.5299  41.0%  1343   40s
   350   374 45243.5516   12  477 33888.1940 47796.5299  41.0%  1228   45s
   592   619 43879.7679   19  393 33888.1940 47696.1684  40.7%  1059   50s
  1170  1190 39734.0011   52  205 33888.1940 47636.9674  40.6%   760   55s
  1841  1714 45676.7603   10  555 33888.1940 47546.4016  40.3%   580   60s
H 2187  1935                    33979.083621 47468.0336  39.7%   557   63s
  2490  2282     cutoff   22      33979.0836 47381.1977  39.4%   530   65s
H 3056  2657                    34002.580244 47335.2685  39.2%   500   67s
H 3446  3012                    34033.994217 47294.6829  39.0%   486   69s
H 3663  3011                    34047.477749 47280.0482  38.9%   478   69s
H 3696  3011                    34055.682607 47280.0482  38.8%   477   69s
  3730  3012 38804.8558   15  778 34055.6826 47280.0482  38.8%   475   89s
  3732  3013 45848.4521   13  127 34055.6826 47280.0482  38.8%   475   90s
  3762  3033 43234.1356   13  415 34055.6826 44309.8523  30.1%   471   95s
H 3993  2953                    34176.474242 40500.2179  18.5%   471   98s
H 4142  2749                    34247.909323 40500.2179  18.3%   460   99s
H 4146  2609                    34281.313605 40500.2179  18.1%   460   99s
H 4182  2467                    34285.468407 40500.2179  18.1%   458   99s
  4351  2375     cutoff   25      34285.4684 40149.5266  17.1%   446  100s

Cutting planes:
  Gomory: 1
  Implied bound: 17
  Projected implied bound: 16
  MIR: 134
  Flow cover: 358
  RLT: 20
  Relax-and-lift: 93

Explored 4799 nodes (2103809 simplex iterations) in 101.98 seconds (204.73 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 34285.5 34281.3 34247.9 ... 33888.2

Optimal solution found (tolerance 1.00e-06)
Best objective 3.428546840664e+04, best bound 3.428546840664e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 102.00s
  Master Objective (UB) = 34285.47, θ = 177023.82
  Upper Bound (UB) = 34285.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 177023.82
  [DEBUG]   ✓ Scenario 0: θ = 177023.82 ≤ Q = 177023.82 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1b6846e
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xfe497b92
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.153573e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5750847.2834
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.247625e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -124762.54    0  122 5750847.28 -124762.54   102%     -    0s
H    0     0                    -92537.13032 -124762.54  34.8%     -    0s
H    0     0                    -93401.75994 -124762.54  33.6%     -    0s
*    0     0               0    -95587.02522 -95587.025  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 202

Explored 1 nodes (363 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -95587 -93401.8 -92537.1 ... 1.15357e+13
No other solutions better than -95587

Optimal solution found (tolerance 1.00e-06)
Best objective -9.558702522003e+04, best bound -9.558702522003e+04, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 143722.98
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -95587.03
  [DEBUG]   S×d_nominal = 239310.00
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 239310.00 + -95587.03 = 143722.98
  [DEBUG]   Current θ from Master = 177023.82
  [DEBUG]   ⚠️  Z_SP ≤ θ by 33300.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 984.62
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 33300.8436, Absolute Gap = 33300.8436, Relative Gap = 0.971282
  Not converged yet (gap = 33300.84 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 91981 nonzeros
Model fingerprint: 0x233d5e2b
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 984.625 (0.01s)
MIP start from previous solve produced solution with objective 984.625 (0.01s)
Loaded MIP start from previous solve with objective 984.625

Presolve removed 14141 rows and 5740 columns
Presolve time: 0.29s
Presolved: 17822 rows, 9000 columns, 98638 nonzeros
Variable types: 6741 continuous, 2259 integer (2259 binary)

Root relaxation: objective 4.427028e+04, 8013 iterations, 0.65 seconds (1.40 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 44270.2791    0  257  984.62482 44270.2791  4396%     -    1s
H    0     0                    3839.8179370 44270.2791  1053%     -    1s
H    0     0                    4911.6108806 44270.2791   801%     -    1s
H    0     0                    5573.5566179 44270.2791   694%     -    1s
H    0     0                    7237.4237844 44270.2791   512%     -    1s
H    0     0                    9121.8177433 44270.2791   385%     -    1s
     0     0 34575.9885    0  292 9121.81774 34575.9885   279%     -    2s
H    0     0                    9209.6034555 34568.4231   275%     -    2s
H    0     0                    9261.6944621 34568.4231   273%     -    2s
H    0     0                    9610.3264305 34568.4231   260%     -    2s
H    0     0                    9632.2246460 34568.4231   259%     -    2s
     0     0 34316.3764    0  304 9632.22465 34316.3764   256%     -    2s
     0     0 34316.3520    0  304 9632.22465 34316.3520   256%     -    2s
     0     0 29713.3784    0  248 9632.22465 29713.3784   208%     -    3s
     0     0 28921.8768    0  273 9632.22465 28921.8768   200%     -    4s
     0     0 28720.8345    0  292 9632.22465 28720.8345   198%     -    4s
     0     0 28717.3155    0  289 9632.22465 28717.3155   198%     -    4s
     0     0 28717.2602    0  289 9632.22465 28717.2602   198%     -    4s
     0     0 25687.7426    0  443 9632.22465 25687.7426   167%     -    5s
H    0     0                    9685.4197411 25687.3403   165%     -    5s
H    0     0                    10249.122262 25687.3403   151%     -    5s
H    0     0                    10367.318102 25687.3403   148%     -    5s
     0     0 24945.4895    0  385 10367.3181 24945.4895   141%     -    6s
     0     0 24716.5434    0  525 10367.3181 24716.5434   138%     -    7s
     0     0 24680.9614    0  538 10367.3181 24680.9614   138%     -    7s
     0     0 24654.8948    0  486 10367.3181 24654.8948   138%     -    7s
     0     0 24645.6937    0  494 10367.3181 24645.6937   138%     -    7s
     0     0 24644.4464    0  496 10367.3181 24644.4464   138%     -    7s
     0     0 23514.0270    0  530 10367.3181 23514.0270   127%     -    9s
H    0     0                    10399.846144 23513.6371   126%     -    9s
     0     0 23228.6830    0  472 10399.8461 23228.6830   123%     -    9s
     0     0 23164.2907    0  569 10399.8461 23164.2907   123%     -   10s
     0     0 23151.0610    0  492 10399.8461 23151.0610   123%     -   10s
     0     0 23142.7544    0  568 10399.8461 23142.7544   123%     -   10s
     0     0 23141.4782    0  560 10399.8461 23141.4782   123%     -   10s
     0     0 22755.9596    0  583 10399.8461 22755.9596   119%     -   11s
     0     0 22659.6622    0  672 10399.8461 22659.6622   118%     -   12s
     0     0 22645.3877    0  604 10399.8461 22645.3877   118%     -   12s
     0     0 22634.5960    0  599 10399.8461 22634.5960   118%     -   12s
     0     0 22631.4931    0  669 10399.8461 22631.4931   118%     -   12s
     0     0 22351.4688    0  476 10399.8461 22351.4688   115%     -   14s
     0     0 22288.6734    0  400 10399.8461 22288.6734   114%     -   14s
     0     0 22252.9671    0  489 10399.8461 22252.9671   114%     -   15s
     0     0 22248.1608    0  478 10399.8461 22248.1608   114%     -   15s
     0     0 22164.9525    0  491 10399.8461 22164.9525   113%     -   16s
     0     0 22145.9255    0  486 10399.8461 22145.9255   113%     -   16s
     0     0 22136.1702    0  487 10399.8461 22136.1702   113%     -   16s
     0     0 22132.3508    0  492 10399.8461 22132.3508   113%     -   17s
     0     0 21994.4003    0  466 10399.8461 21994.4003   111%     -   18s
     0     0 21967.7861    0  566 10399.8461 21967.7861   111%     -   19s
     0     0 21959.9923    0  424 10399.8461 21959.9923   111%     -   19s
     0     0 21957.0592    0  422 10399.8461 21957.0592   111%     -   19s
     0     0 21905.1789    0  656 10399.8461 21905.1789   111%     -   20s
     0     0 21896.2659    0  625 10399.8461 21896.2659   111%     -   20s
     0     0 21894.3707    0  741 10399.8461 21894.3707   111%     -   21s
     0     0 21877.4330    0  621 10399.8461 21877.4330   110%     -   21s
     0     0 21875.7583    0  513 10399.8461 21875.7583   110%     -   21s
     0     0 21863.1898    0  506 10399.8461 21863.1898   110%     -   22s
     0     0 21858.7722    0  504 10399.8461 21858.7722   110%     -   22s
     0     0 21833.9012    0  425 10399.8461 21833.9012   110%     -   23s
     0     0 21825.2531    0  495 10399.8461 21825.2531   110%     -   23s
     0     0 21819.3549    0  552 10399.8461 21819.3549   110%     -   23s
     0     0 21808.7254    0  538 10399.8461 21808.7254   110%     -   24s
     0     0 21808.3658    0  538 10399.8461 21808.3658   110%     -   24s
     0     2 21808.3658    0  538 10399.8461 21808.3658   110%     -   28s
     7    16 21304.8852    3  345 10399.8461 21537.9024   107%  1157   31s
    63    96 19866.3153    6  354 10399.8461 20497.9027  97.1%  1363   35s
   234   314 17665.5219   10  343 10399.8461 20496.8812  97.1%   991   40s
   555   592 16346.9030   17  317 10399.8461 20496.8812  97.1%   759   45s
   828   815 15956.9952   21  318 10399.8461 20433.0857  96.5%   649   50s
  1648  1698 14317.3051   47  186 10399.8461 20403.4796  96.2%   400   55s
  2724  2686 12360.8569   84  111 10399.8461 20225.5018  94.5%   287   61s
  3549  3030 13024.6619   12  203 10399.8461 20142.6315  93.7%   267   65s
  3810  3127 12943.3821   80  538 10399.8461 20113.9543  93.4%   273   74s
  3812  3128 18608.7586   12  102 10399.8461 20113.9543  93.4%   273   75s
  3821  3134 12402.0779   33  412 10399.8461 20113.9543  93.4%   272   80s
  3833  3142 18816.2374    9  430 10399.8461 20113.9543  93.4%   271   85s
  3841  3148 19008.9814    9  354 10399.8461 20113.9543  93.4%   271   91s
  3856  3175 20113.9543   15  379 10399.8461 20113.9543  93.4%   281   95s
  3974  3254 19205.0627   19  358 10399.8461 20113.9543  93.4%   304  100s
  4326  3185 15069.9878   22  285 10399.8461 19179.6578  84.4%   327  105s
  4690  3103 12449.2611   26  199 10399.8461 18091.6479  74.0%   334  110s
  5083  2920     cutoff   20      10399.8461 14982.9879  44.1%   342  115s
  6288  2761 10944.9483   35   66 10399.8461 12186.4477  17.2%   307  120s
* 9433  2510              66    10417.025613 11009.9636  5.69%   212  122s
H12157  1996                    10458.208414 10645.3522  1.79%   168  122s
H13494  1805                    10486.198480 10551.8752  0.63%   153  123s
*13495  1805              68    10486.201992 10551.8752  0.63%   153  123s
*14045   545              86    10509.716543 10528.4415  0.18%   147  123s

Cutting planes:
  Gomory: 1
  Lift-and-project: 1
  MIR: 329
  Mixing: 2
  Flow cover: 641
  RLT: 8
  Relax-and-lift: 44

Explored 15752 nodes (2125492 simplex iterations) in 123.65 seconds (277.64 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 10509.7 10486.2 10458.2 ... 9610.33

Optimal solution found (tolerance 1.00e-06)
Best objective 1.050971654273e+04, best bound 1.050971654273e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 123.66s
  Master Objective (UB) = 10509.72, θ = 133525.98
  Upper Bound (UB) = 10509.72

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 133525.98
  [DEBUG]   ✓ Scenario 0: θ = 133525.98 ≤ Q = 133525.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 133525.98 ≤ Q = 133525.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x3c576deb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x3c576deb
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-15, 2e+02]
Found heuristic solution: objective 1.211895e+13
Presolve removed 2608 rows and 1900 columns
Presolve time: 0.00s
Presolved: 485 rows, 489 columns, 1368 nonzeros
Found heuristic solution: objective 6282231.6651
Variable types: 330 continuous, 159 integer (159 binary)
Found heuristic solution: objective 6281822.0598

Root relaxation: objective -1.280052e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -128005.18    0  124 6281822.06 -128005.18   102%     -    0s
H    0     0                    -101567.6959 -128005.18  26.0%     -    0s
H    0     0                    -107024.7215 -128005.18  19.6%     -    0s
H    0     0                    -108487.9362 -116352.32  7.25%     -    0s
H    0     0                    -109900.6284 -116352.32  5.87%     -    0s
     0     0 -116352.32    0   93 -109900.63 -116352.32  5.87%     -    0s
H    0     0                    -114047.4436 -116333.60  2.00%     -    0s
     0     0 -116147.64    0   96 -114047.44 -116147.64  1.84%     -    0s
H    0     0                    -114718.2738 -116147.64  1.25%     -    0s
     0     0 -115378.44    0   93 -114718.27 -115378.44  0.58%     -    0s
H    0     0                    -114784.6310 -115364.03  0.50%     -    0s
H    0     0                    -114968.7082 -115364.03  0.34%     -    0s
     0     0 -115300.83    0   79 -114968.71 -115300.83  0.29%     -    0s
     0     0 -115230.61    0   67 -114968.71 -115230.61  0.23%     -    0s
     0     0 -115200.81    0   30 -114968.71 -115200.81  0.20%     -    0s
     0     0 -115197.30    0   28 -114968.71 -115197.30  0.20%     -    0s
     0     0 -115168.00    0   45 -114968.71 -115168.00  0.17%     -    0s
     0     0 -115161.24    0   42 -114968.71 -115161.24  0.17%     -    0s
     0     0 -115159.81    0   32 -114968.71 -115159.81  0.17%     -    0s
     0     0 -115157.15    0   37 -114968.71 -115157.15  0.16%     -    0s
     0     0 -115032.78    0   10 -114968.71 -115032.78  0.06%     -    0s
     0     0 -115000.60    0   10 -114968.71 -115000.60  0.03%     -    0s
     0     0 -114971.73    0    4 -114968.71 -114971.73  0.00%     -    0s
     0     0 -114971.22    0    2 -114968.71 -114971.22  0.00%     -    0s
*    0     0               0    -114970.9876 -114970.99  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 3
  MIR: 1
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (785 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -114971 -114969 -114929 ... 6.28182e+06
No other solutions better than -114971

Optimal solution found (tolerance 1.00e-06)
Best objective -1.149709876031e+05, best bound -1.149709876031e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 109878.00
  Scenario: 46 demand increases, 14 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -114970.99
  [DEBUG]   S×d_nominal = 224848.99
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 224848.99 + -114970.99 = 109878.00
  [DEBUG]   Current θ from Master = 133525.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 23647.97 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -13138.26
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 9525.0917, Absolute Gap = 9525.0917, Relative Gap = 0.906313
  Not converged yet (gap = 9525.09 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 46 increases, 14 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135212 nonzeros
Model fingerprint: 0xef83312d
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -13138.3 (0.02s)
MIP start from previous solve produced solution with objective -13138.3 (0.02s)
Loaded MIP start from previous solve with objective -13138.3

Presolve removed 21210 rows and 8610 columns
Presolve time: 0.41s
Presolved: 26043 rows, 12370 columns, 160049 nonzeros
Variable types: 10111 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...

Concurrent spin time: 0.12s

Solved with dual simplex

Root relaxation: objective 3.352843e+04, 18619 iterations, 3.19 seconds (6.26 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33528.4264    0   99 -13138.255 33528.4264   355%     -    3s
H    0     0                    -5112.704544 33528.4264   756%     -    3s
H    0     0                    -4134.124062 33528.4264   911%     -    3s
H    0     0                    -3424.632572 33528.4264  1079%     -    3s
H    0     0                    1594.2384450 33528.4264  2003%     -    4s
H    0     0                    1830.0836550 33528.4264  1732%     -    4s
H    0     0                    2069.1924324 33528.4264  1520%     -    4s
H    0     0                    2096.6807099 33528.4264  1499%     -    4s
H    0     0                    2181.6339108 33528.4264  1437%     -    4s
H    0     0                    2196.7022440 33528.4264  1426%     -    4s
H    0     0                    2202.0884035 33528.4264  1423%     -    4s
H    0     0                    2207.1860061 33528.4264  1419%     -    4s
H    0     0                    5439.5480527 33528.4264   516%     -    4s
H    0     0                    6543.5698316 33528.4264   412%     -    4s
H    0     0                    7602.3792731 33528.4264   341%     -    4s
H    0     0                    7655.8861094 33528.4264   338%     -    4s
H    0     0                    7729.0951304 33528.4264   334%     -    4s
H    0     0                    7770.5757299 33528.4264   331%     -    4s
     0     0 26408.6030    0  242 7770.57573 26408.6030   240%     -    6s
H    0     0                    9001.3498875 26408.6030   193%     -    6s
H    0     0                    9119.5457275 26408.6030   190%     -    6s
     0     0 26404.6342    0  198 9119.54573 26404.6342   190%     -    7s
     0     0 26404.6203    0  207 9119.54573 26404.6203   190%     -    7s
     0     0 26404.6034    0  207 9119.54573 26404.6034   190%     -    7s
     0     0 24480.0241    0  253 9119.54573 24480.0241   168%     -    9s
H    0     0                    9201.5061164 24480.0241   166%     -    9s
H    0     0                    9229.4950701 24480.0241   165%     -    9s
H    0     0                    9237.6512136 24480.0241   165%     -    9s
H    0     0                    9256.7093470 24480.0241   164%     -    9s
H    0     0                    9259.7058114 24480.0241   164%     -    9s
H    0     0                    9261.7426092 24480.0241   164%     -    9s
     0     0 23633.8635    0  307 9261.74261 23633.8635   155%     -   10s
     0     0 23535.7189    0  294 9261.74261 23535.7189   154%     -   10s
H    0     0                    9277.2466080 23506.2583   153%     -   10s
H    0     0                    9282.3718055 23506.2583   153%     -   10s
H    0     0                    9300.9472358 23506.2583   153%     -   10s
H    0     0                    9322.8454513 23506.2583   152%     -   10s
     0     0 23506.2583    0  292 9322.84545 23506.2583   152%     -   10s
     0     0 23501.3705    0  296 9322.84545 23501.3705   152%     -   10s
     0     0 23501.3181    0  296 9322.84545 23501.3181   152%     -   10s
     0     0 21759.1372    0  359 9322.84545 21759.1372   133%     -   13s
H    0     0                    9325.7079996 21367.1368   129%     -   14s
     0     0 21367.1368    0  317 9325.70800 21367.1368   129%     -   14s
     0     0 21282.3982    0  320 9325.70800 21282.3982   128%     -   14s
     0     0 21240.7967    0  383 9325.70800 21240.7967   128%     -   15s
     0     0 21226.8974    0  338 9325.70800 21226.8974   128%     -   15s
     0     0 21221.7291    0  335 9325.70800 21221.7291   128%     -   15s
     0     0 21220.2163    0  383 9325.70800 21220.2163   128%     -   15s
     0     0 21220.0148    0  386 9325.70800 21220.0148   128%     -   15s
     0     0 20426.4164    0  422 9325.70800 20426.4164   119%     -   19s
     0     0 20241.9005    0  373 9325.70800 20241.9005   117%     -   20s
     0     0 20187.0314    0  424 9325.70800 20187.0314   116%     -   20s
H    0     0                    9377.1834812 20158.9384   115%     -   20s
H    0     0                    9377.8797171 20158.9384   115%     -   20s
H    0     0                    9379.6726250 20158.9384   115%     -   20s
H    0     0                    9380.3028001 20158.9384   115%     -   20s
H    0     0                    9396.5437175 20158.9384   115%     -   20s
H    0     0                    9398.2919874 20158.9384   114%     -   20s
H    0     0                    9409.0676327 20158.9384   114%     -   20s
     0     0 20158.9384    0  388 9409.06763 20158.9384   114%     -   20s
     0     0 20152.3927    0  437 9409.06763 20152.3927   114%     -   21s
     0     0 20144.5846    0  386 9409.06763 20144.5846   114%     -   21s
     0     0 20139.2134    0  445 9409.06763 20139.2134   114%     -   21s
     0     0 20136.5036    0  447 9409.06763 20136.5036   114%     -   21s
     0     0 20134.9438    0  447 9409.06763 20134.9438   114%     -   21s
     0     0 19914.7466    0  450 9409.06763 19914.7466   112%     -   22s
     0     0 19823.9559    0  450 9409.06763 19823.9559   111%     -   23s
     0     0 19805.9691    0  447 9409.06763 19805.9691   110%     -   23s
     0     0 19800.4870    0  454 9409.06763 19800.4870   110%     -   23s
     0     0 19799.8199    0  465 9409.06763 19799.8199   110%     -   24s
     0     0 19692.7819    0  470 9409.06763 19692.7819   109%     -   25s
     0     0 19676.4102    0  471 9409.06763 19676.4102   109%     -   25s
     0     0 19666.4590    0  470 9409.06763 19666.4590   109%     -   26s
     0     0 19663.0725    0  478 9409.06763 19663.0725   109%     -   26s
     0     0 19662.4582    0  481 9409.06763 19662.4582   109%     -   26s
     0     0 19627.3915    0  405 9409.06763 19627.3915   109%     -   27s
     0     0 19613.4027    0  412 9409.06763 19613.4027   108%     -   27s
     0     0 19608.1929    0  412 9409.06763 19608.1929   108%     -   28s
     0     0 19606.9252    0  407 9409.06763 19606.9252   108%     -   28s
     0     0 19577.7446    0  409 9409.06763 19577.7446   108%     -   29s
     0     0 19572.6025    0  414 9409.06763 19572.6025   108%     -   29s
     0     0 19571.8649    0  422 9409.06763 19571.8649   108%     -   29s
H    0     0                    9409.8200390 19551.4868   108%     -   30s
     0     0 19551.4868    0  477 9409.82004 19551.4868   108%     -   30s
H    0     0                    9437.7980699 19550.0580   107%     -   30s
H    0     0                    9529.3465070 19550.0580   105%     -   30s
     0     0 19543.7863    0  482 9529.34651 19543.7863   105%     -   30s
     0     0 19541.7864    0  411 9529.34651 19541.7864   105%     -   30s
     0     0 19541.4132    0  482 9529.34651 19541.4132   105%     -   30s
     0     0 19531.4955    0  416 9529.34651 19531.4955   105%     -   31s
     0     0 19530.6572    0  413 9529.34651 19530.6572   105%     -   31s
     0     0 19529.1471    0  413 9529.34651 19529.1471   105%     -   32s
     0     0 19528.5833    0  421 9529.34651 19528.5833   105%     -   32s
     0     0 19527.9440    0  420 9529.34651 19527.9440   105%     -   32s
     0     0 19527.6595    0  421 9529.34651 19527.6595   105%     -   32s
     0     0 19527.6595    0  421 9529.34651 19527.6595   105%     -   33s
     0     0 19527.2704    0  421 9529.34651 19527.2704   105%     -   33s
     0     2 19526.7702    0  421 9529.34651 19526.7702   105%     -   38s
     3     8 19496.9964    2  407 9529.34651 19521.3844   105%   776   41s
    15    32 18889.8077    4  483 9529.34651 19079.8325   100%  2348   45s
    63    96 18274.3560    6  339 9529.34651 18447.1460  93.6%  2744   50s
   207   281 17095.7567    8  326 9529.34651 18443.6390  93.5%  1754   56s
   280   342 16599.4908    9  294 9529.34651 18443.6390  93.5%  1510   60s
   448   477 16125.7262   11  285 9529.34651 18443.6390  93.5%  1282   65s
   613   630 15723.4849   13  283 9529.34651 18442.2610  93.5%  1208   70s
   828   772 14394.5115   14  239 9529.34651 18370.4899  92.8%  1105   76s
  1062   957 11349.3543   16  223 9529.34651 18277.4759  91.8%  1024   81s
  1204  1039 13203.4073   17  301 9529.34651 18267.8125  91.7%   981   85s
  1428  1214 12627.8562   19  264 9529.34651 18205.0353  91.0%   944   91s
  1591  1326 12197.3172   20  271 9529.34651 18205.0353  91.0%   932   95s
  1800  1465 11768.3348   21  208 9529.34651 18205.0353  91.0%   908  100s
  2080  1649 9933.90435   22  136 9529.34651 18147.9424  90.4%   894  107s
  2260  1770 10815.9113   24  185 9529.34651 18147.9424  90.4%   883  111s
  2548  1943 10552.9152   26  178 9529.34651 18147.9424  90.4%   844  117s
  2846  2133 10051.9755   27  182 9529.34651 18147.9424  90.4%   828  122s
  2996  2220     cutoff   28      9529.34651 17964.1612  88.5%   819  125s
  3220  2351 13876.0448   10  330 9529.34651 17787.6875  86.7%   805  130s
  3617  2656 12230.6931   13  355 9529.34651 17454.2170  83.2%   789  136s
  4231  2847 14910.5266   12  421 9529.34651 17353.0801  82.1%   754  148s
  4233  2848 12160.8955   11   99 9529.34651 17353.0801  82.1%   754  153s
  4234  2849 13444.4647   15  348 9529.34651 17353.0801  82.1%   753  158s
  4235  2850 14026.7638   20  427 9529.34651 17353.0801  82.1%   753  160s
  4239  2852 16342.4620   16  468 9529.34651 17353.0801  82.1%   753  165s
  4245  2856 10678.2267   17  488 9529.34651 17353.0801  82.1%   752  170s
  4250  2860 13281.6983   14  479 9529.34651 17353.0801  82.1%   751  175s
  4254  2862 11558.5155   17  481 9529.34651 17353.0801  82.1%   750  180s
  4257  2864 14038.4979   21  504 9529.34651 17353.0801  82.1%   749  187s
  4258  2865 12155.3745   16  504 9529.34651 17353.0801  82.1%   749  191s
  4261  2872 17353.0801   16  437 9529.34651 17353.0801  82.1%   765  195s
  4273  2892 17353.0801   18  328 9529.34651 17353.0801  82.1%   768  200s
  4321  2915 14268.8014   20  339 9529.34651 17353.0801  82.1%   808  206s
  4353  2921 13864.6152   21  337 9529.34651 16775.7854  76.0%   832  210s
  4479  2957 10235.4457   23  224 9529.34651 16610.4226  74.3%   852  215s
  4732  2909 9752.77748   26  266 9529.34651 16610.4226  74.3%   853  220s
  4996  2839 12105.7181   21  211 9529.34651 14969.5306  57.1%   846  225s
  5365  2760 13454.5710   27  312 9529.34651 14300.5965  50.1%   825  231s
  5691  2586 9751.48178   34  244 9529.34651 14152.3010  48.5%   809  236s
  5929  2420     cutoff   23      9529.34651 12311.3324  29.2%   801  240s
* 6316  2072              41    9546.7602072 10939.4809  14.6%   771  242s
* 6621  1830              44    9594.1315638 10180.5697  6.11%   740  243s
* 6862  1610              45    9648.2651775 9903.49503  2.65%   715  244s
* 6919  1467              48    9768.2309208 9878.09745  1.12%   709  244s

Cutting planes:
  Learned: 1
  Gomory: 5
  MIR: 390
  Mixing: 1
  Flow cover: 637
  RLT: 3
  Relax-and-lift: 71

Explored 7036 nodes (4979871 simplex iterations) in 244.31 seconds (635.49 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9768.23 9648.27 9594.13 ... 9396.54

Optimal solution found (tolerance 1.00e-06)
Warning: max constraint violation (7.1828e-09) exceeds tolerance
Best objective 9.768230920803e+03, best bound 9.768230920803e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 244.33s
  Master Objective (UB) = 9768.23, θ = 150771.71
  Upper Bound (UB) = 9768.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 150771.71
  [DEBUG]   ✓ Scenario 0: θ = 150771.71 ≤ Q = 150771.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 150771.71 ≤ Q = 150771.71 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 150771.71 ≤ Q = 150771.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6ed3d885
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6ed3d885
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.144375e+13
Presolve removed 2617 rows and 1906 columns
Presolve time: 0.00s
Presolved: 476 rows, 483 columns, 1345 nonzeros
Found heuristic solution: objective 5414867.4724
Variable types: 326 continuous, 157 integer (157 binary)
Found heuristic solution: objective 5413980.7890

Root relaxation: objective -1.384905e+05, 240 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138490.51    0  118 5413980.79 -138490.51   103%     -    0s
H    0     0                    -100676.0175 -138490.51  37.6%     -    0s
H    0     0                    -101007.6522 -138490.51  37.1%     -    0s
H    0     0                    -109194.7723 -138490.51  26.8%     -    0s
H    0     0                    -109692.7346 -138490.51  26.3%     -    0s
H    0     0                    -110384.2343 -138490.51  25.5%     -    0s
H    0     0                    -113673.1962 -138490.51  21.8%     -    0s
     0     0 -122678.44    0   85 -113673.20 -122678.44  7.92%     -    0s
H    0     0                    -119275.2290 -122612.23  2.80%     -    0s
H    0     0                    -120454.6084 -122612.23  1.79%     -    0s
     0     0 -122498.20    0   78 -120454.61 -122498.20  1.70%     -    0s
     0     0 -122497.66    0   78 -120454.61 -122497.66  1.70%     -    0s
     0     0 -121735.37    0   95 -120454.61 -121735.37  1.06%     -    0s
H    0     0                    -120651.7584 -121657.24  0.83%     -    0s
H    0     0                    -120765.7669 -121657.24  0.74%     -    0s
     0     0 -121657.24    0   91 -120765.77 -121657.24  0.74%     -    0s
     0     0 -121657.24    0   91 -120765.77 -121657.24  0.74%     -    0s
     0     0 -121447.27    0   72 -120765.77 -121447.27  0.56%     -    0s
     0     0 -121384.01    0   51 -120765.77 -121384.01  0.51%     -    0s
     0     0 -121381.15    0   51 -120765.77 -121381.15  0.51%     -    0s
     0     0 -121058.90    0   33 -120765.77 -121058.90  0.24%     -    0s
     0     0 -120991.04    0   36 -120765.77 -120991.04  0.19%     -    0s
     0     0 -120988.70    0   34 -120765.77 -120988.70  0.18%     -    0s
     0     0 -120819.14    0   19 -120765.77 -120819.14  0.04%     -    0s
     0     0 -120786.23    0    9 -120765.77 -120786.23  0.02%     -    0s
     0     0 -120776.08    0    3 -120765.77 -120776.08  0.01%     -    0s
     0     0 -120770.59    0    2 -120765.77 -120770.59  0.00%     -    0s
     0     0     cutoff    0      -120765.77 -120765.77  0.00%     -    0s

Cutting planes:
  Gomory: 23
  Implied bound: 12
  MIR: 82
  Flow cover: 6
  RLT: 103
  Relax-and-lift: 3
  BQP: 3

Explored 1 nodes (812 simplex iterations) in 0.05 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -120766 -120766 -120652 ... -100676
No other solutions better than -120766

Optimal solution found (tolerance 1.00e-06)
Best objective -1.207657668461e+05, best bound -1.207657668461e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 133352.31
  Scenario: 23 demand increases, 37 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120765.77
  [DEBUG]   S×d_nominal = 254118.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254118.07 + -120765.77 = 133352.31
  [DEBUG]   Current θ from Master = 150771.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 17419.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -7651.18
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8783.6061, Absolute Gap = 8783.6061, Relative Gap = 0.899201
  Not converged yet (gap = 8783.61 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 23 increases, 37 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178443 nonzeros
Model fingerprint: 0x640c1c42
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective -7651.18 (0.08s)
MIP start from previous solve produced solution with objective -7651.18 (0.08s)
Loaded MIP start from previous solve with objective -7651.18

Presolve removed 28280 rows and 11480 columns
Presolve time: 0.54s
Presolved: 34263 rows, 15740 columns, 211559 nonzeros
Variable types: 13481 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 34263 rows, 15740 columns, 211559 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32908    2.4152633e+04   0.000000e+00   1.594190e+08      5s
Concurrent spin time: 2.05s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.352842e+04, 32673 iterations, 7.02 seconds (12.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33528.4202    0  103 -7651.1773 33528.4202   538%     -    7s
H    0     0                    -5999.208264 33528.4202   659%     -    7s
H    0     0                    4153.8796621 33528.4202   707%     -    7s
H    0     0                    8275.9900631 33528.4202   305%     -    8s
H    0     0                    8894.1052677 33528.4202   277%     -    8s
H    0     0                    9286.7199696 33528.4202   261%     -    8s
H    0     0                    9289.1000740 33528.4202   261%     -    8s
H    0     0                    9410.9300800 33528.4202   256%     -    8s
     0     0 27407.1422    0  190 9410.93008 27407.1422   191%     -   10s
H    0     0                    9502.7539647 27405.4419   188%     -   11s
     0     0 27129.7265    0  204 9502.75396 27129.7265   185%     -   11s
     0     0 26872.5760    0  161 9502.75396 26872.5760   183%     -   12s
     0     0 26872.5760    0  200 9502.75396 26872.5760   183%     -   13s
     0     0 26872.5760    0  200 9502.75396 26872.5760   183%     -   13s
     0     0 26872.5164    0  200 9502.75396 26872.5164   183%     -   13s
     0     0 24587.7164    0  267 9502.75396 24587.7164   159%     -   17s
     0     0 24135.2524    0  299 9502.75396 24135.2524   154%     -   18s
     0     0 23988.3592    0  300 9502.75396 23988.3592   152%     -   19s
     0     0 23977.8314    0  297 9502.75396 23977.8314   152%     -   19s
     0     0 23963.7318    0  295 9502.75396 23963.7318   152%     -   19s
     0     0 23953.8178    0  306 9502.75396 23953.8178   152%     -   19s
     0     0 23947.3577    0  296 9502.75396 23947.3577   152%     -   19s
     0     0 23947.0915    0  299 9502.75396 23947.0915   152%     -   19s
H    0     0                    9520.1370264 22444.5797   136%     -   24s
     0     0 22444.5797    0  345 9520.13703 22444.5797   136%     -   24s
     0     0 21635.9569    0  351 9520.13703 21635.9569   127%     -   27s
     0     0 21501.3378    0  367 9520.13703 21501.3378   126%     -   28s
     0     0 21455.4916    0  355 9520.13703 21455.4916   125%     -   29s
     0     0 21395.3082    0  368 9520.13703 21395.3082   125%     -   30s
     0     0 21368.2126    0  372 9520.13703 21368.2126   124%     -   30s
     0     0 21350.7806    0  373 9520.13703 21350.7806   124%     -   30s
     0     0 21350.0859    0  372 9520.13703 21350.0859   124%     -   31s
     0     0 20325.4907    0  456 9520.13703 20325.4907   113%     -   37s
     0     0 20087.1671    0  457 9520.13703 20087.1671   111%     -   39s
     0     0 20000.3184    0  479 9520.13703 20000.3184   110%     -   40s
     0     0 19934.0077    0  477 9520.13703 19934.0077   109%     -   41s
     0     0 19918.7518    0  475 9520.13703 19918.7518   109%     -   41s
     0     0 19902.0041    0  479 9520.13703 19902.0041   109%     -   42s
     0     0 19897.7044    0  472 9520.13703 19897.7044   109%     -   42s
     0     0 19892.2950    0  472 9520.13703 19892.2950   109%     -   42s
     0     0 19877.5966    0  472 9520.13703 19877.5966   109%     -   42s
     0     0 19872.6300    0  483 9520.13703 19872.6300   109%     -   43s
     0     0 19849.1332    0  472 9520.13703 19849.1332   108%     -   43s
     0     0 19847.8632    0  470 9520.13703 19847.8632   108%     -   43s
     0     0 19746.2448    0  469 9520.13703 19746.2448   107%     -   45s
     0     0 19693.6920    0  400 9520.13703 19693.6920   107%     -   46s
     0     0 19684.4821    0  400 9520.13703 19684.4821   107%     -   46s
     0     0 19680.1904    0  403 9520.13703 19680.1904   107%     -   46s
     0     0 19679.2666    0  401 9520.13703 19679.2666   107%     -   46s
     0     0 19618.3686    0  413 9520.13703 19618.3686   106%     -   47s
     0     0 19609.1965    0  493 9520.13703 19609.1965   106%     -   48s
     0     0 19592.9754    0  487 9520.13703 19592.9754   106%     -   49s
     0     0 19589.0962    0  499 9520.13703 19589.0962   106%     -   49s
     0     0 19587.9810    0  506 9520.13703 19587.9810   106%     -   49s
     0     0 19560.6834    0  414 9520.13703 19560.6834   105%     -   50s
     0     0 19554.8484    0  418 9520.13703 19554.8484   105%     -   50s
     0     0 19549.9450    0  412 9520.13703 19549.9450   105%     -   51s
     0     0 19547.1231    0  413 9520.13703 19547.1231   105%     -   51s
     0     0 19546.7171    0  416 9520.13703 19546.7171   105%     -   51s
     0     0 19536.8295    0  486 9520.13703 19536.8295   105%     -   52s
     0     0 19535.0829    0  491 9520.13703 19535.0829   105%     -   52s
     0     0 19527.1160    0  428 9520.13703 19527.1160   105%     -   53s
     0     0 19524.4879    0  428 9520.13703 19524.4879   105%     -   53s
     0     0 19524.0969    0  432 9520.13703 19524.0969   105%     -   54s
     0     0 19521.3609    0  434 9520.13703 19521.3609   105%     -   54s
     0     0 19521.0619    0  430 9520.13703 19521.0619   105%     -   54s
     0     0 19515.7544    0  423 9520.13703 19515.7544   105%     -   55s
     0     0 19512.6182    0  428 9520.13703 19512.6182   105%     -   55s
     0     0 19508.9243    0  422 9520.13703 19508.9243   105%     -   56s
     0     0 19508.7287    0  422 9520.13703 19508.7287   105%     -   56s
     0     2 19506.2681    0  422 9520.13703 19506.2681   105%     -   65s
     7    16 19088.7848    3  473 9520.13703 19148.6578   101%  2218   71s
    31    64 18454.8782    5  475 9520.13703 18691.7936  96.3%  4120   77s
    95   140 17823.8033    7  486 9520.13703 18454.8131  93.9%  2413   81s
   139   216 17481.9278    8  472 9520.13703 18454.8131  93.9%  2362   85s
   270   322 17482.0956    9  492 9520.13703 18454.8131  93.9%  2086   93s
   341   374 17362.3106   11  476 9520.13703 18454.8131  93.9%  2010   98s
   407   429 15372.9546   11  302 9520.13703 18454.8131  93.9%  1999  103s
   481   471 16953.3182   12  439 9520.13703 18201.2424  91.2%  1945  108s
   549   517 16370.2112   12  322 9520.13703 18133.9463  90.5%  1897  113s
   618   549 16929.3018   13  470 9520.13703 18029.4374  89.4%  1838  116s
   687   588 16310.5051   15  475 9520.13703 17798.1490  87.0%  1826  120s
   821   674 16245.8986   16  485 9520.13703 17798.1490  87.0%  1752  126s
   933   773 15650.4831   18  458 9520.13703 17761.4399  86.6%  1687  130s
  1074   852 13742.8691   19  451 9520.13703 17761.4399  86.6%  1599  136s
  1161   912 15117.6035   20  431 9520.13703 17761.4399  86.6%  1573  142s
  1259   947 14412.2710   22  413 9520.13703 17761.4399  86.6%  1534  146s
  1342   975 14019.2384   24  305 9520.13703 17640.4962  85.3%  1514  152s
  1406   996 13874.2205   25  397 9520.13703 17620.8937  85.1%  1496  156s
  1507  1093 13570.3364   26  399 9520.13703 17620.8937  85.1%  1479  162s
  1620  1185 13420.4276   27  372 9520.13703 17620.8937  85.1%  1434  169s
  1751  1283 13317.1610   28  279 9520.13703 17503.7024  83.9%  1389  171s
  1917  1365 12936.6447   29  286 9520.13703 17503.7024  83.9%  1320  175s
  2073  1436 12469.8178   29  259 9520.13703 17382.1739  82.6%  1286  180s
  2226  1477 12801.3893   30  281 9520.13703 17382.1739  82.6%  1270  185s
  2449  1613 12613.8339   31  345 9520.13703 17382.1739  82.6%  1257  192s
  2607  1683 11758.6809   35  273 9520.13703 17382.1739  82.6%  1245  196s
  2797  1753     cutoff   41      9520.13703 17382.1739  82.6%  1227  201s
  2940  1827 16556.0781   10  400 9520.13703 17382.1739  82.6%  1228  206s
  3087  1939 16143.7218   12  345 9520.13703 17222.5906  80.9%  1234  211s
  3270  2027 15197.9222   18  311 9520.13703 17103.8442  79.7%  1224  215s
  3578  2219 10565.8325   31   85 9520.13703 17093.9393  79.6%  1215  223s
  3822  2305 15055.7183   11  413 9520.13703 17093.9393  79.6%  1192  229s
  4102  2436 14166.3373   18  356 9520.13703 17093.9393  79.6%  1171  235s
  4371  2521 infeasible   28      9520.13703 16902.4322  77.5%  1157  241s
  4716  2593 15048.2961   13  240 9520.13703 16902.4322  77.5%  1132  250s
  4993  2744     cutoff   24      9520.13703 16785.7536  76.3%  1126  258s
  5283  2745 13332.9715   16  422 9520.13703 16723.8961  75.7%  1115  292s
  5285  2746 12131.1573   35  103 9520.13703 16723.8961  75.7%  1115  298s
  5286  2747 15851.2288    7  414 9520.13703 16723.8961  75.7%  1115  307s
  5287  2748 11378.7109   32  413 9520.13703 16723.8961  75.7%  1115  311s
  5288  2748 16519.3221   10  369 9520.13703 16723.8961  75.7%  1114  315s
  5291  2750 11844.2787   23  402 9520.13703 16723.8961  75.7%  1114  320s
  5296  2754 15217.6780   10  491 9520.13703 16723.8961  75.7%  1113  325s
  5299  2756 16253.5101   15  522 9520.13703 16723.8961  75.7%  1112  330s
  5302  2758 11672.6295   21  512 9520.13703 16723.8961  75.7%  1111  336s
  5305  2760 14290.5028   12  510 9520.13703 16723.8961  75.7%  1111  340s
  5309  2762 11943.9470   15  471 9520.13703 16723.8961  75.7%  1110  346s
  5312  2764 11698.9793   10  481 9520.13703 16723.8961  75.7%  1109  356s
  5313  2765 10746.6579   24  481 9520.13703 16723.8961  75.7%  1109  362s
  5314  2769 16723.8961   11  454 9520.13703 16723.8961  75.7%  1126  365s
  5320  2779 16723.8961   13  481 9520.13703 16723.8961  75.7%  1128  378s
  5328  2792 16723.8961   14  560 9520.13703 16723.8961  75.7%  1132  383s
  5344  2819 16723.8961   15  446 9520.13703 16723.8961  75.7%  1148  388s
  5376  2840 16723.8961   16  436 9520.13703 16723.8961  75.7%  1154  392s
  5408  2847 16723.8961   17  444 9520.13703 16723.8961  75.7%  1169  398s
  5446  2891 16723.8961   18  430 9520.13703 16723.8961  75.7%  1197  403s
  5526  2891 15686.1076   19  458 9520.13703 16723.8961  75.7%  1201  408s
  5599  2886 16268.0236   19  455 9520.13703 16723.8961  75.7%  1211  412s
  5670  2890 15425.3775   20  405 9520.13703 16723.8961  75.7%  1219  417s
  5738  2891 15130.5405   20  310 9520.13703 16723.8961  75.7%  1225  422s
  5806  2899 15071.7368   21  485 9520.13703 16723.8961  75.7%  1230  426s
  5866  2914 12664.8979   21  257 9520.13703 16723.8961  75.7%  1239  430s
  6001  2905 12158.5303   22  265 9520.13703 16723.8961  75.7%  1240  439s
  6076  2895 14413.1801   23  490 9520.13703 16690.8413  75.3%  1240  443s
  6129  2908 13402.0646   23  256 9520.13703 16690.8413  75.3%  1246  449s
  6205  2893 13383.2171   24  262 9520.13703 16690.8413  75.3%  1246  453s
  6251  2895     cutoff   24      9520.13703 16690.8413  75.3%  1250  458s
  6297  2906 13037.5761   25  218 9520.13703 16051.4194  68.6%  1257  462s
  6342  2916     cutoff   25      9520.13703 16051.4194  68.6%  1261  467s
  6391  2922     cutoff   26      9520.13703 16051.4194  68.6%  1264  471s
  6537  2914 12721.1733   22  228 9520.13703 16017.2658  68.2%  1266  480s
  6638  2913 11407.0876   23  205 9520.13703 15884.7364  66.9%  1266  487s
  6732  2904 11278.8626   24  200 9520.13703 15847.3110  66.5%  1270  492s
  6855  2896 10683.4940   25  190 9520.13703 15847.3110  66.5%  1266  499s
  6989  2891 10682.5878   26  189 9520.13703 15500.1234  62.8%  1264  505s
  7261  2869 10034.1518   24  222 9520.13703 15338.7683  61.1%  1262  517s
  7389  2868     cutoff   19      9520.13703 15097.3779  58.6%  1264  523s
  7536  2847 10634.8562   20  165 9520.13703 14956.3293  57.1%  1266  530s
  7699  2811 10969.8504   18  225 9520.13703 14956.3293  57.1%  1265  536s
  7839  2779 10963.9571   20  225 9520.13703 14847.9634  56.0%  1268  544s
  8007  2722 11481.9475   23  388 9520.13703 14680.7442  54.2%  1270  549s
  8068  2718 11228.4815   24  312 9520.13703 14566.7621  53.0%  1273  553s
  8120  2725 10742.8080   25  213 9520.13703 14467.3160  52.0%  1274  559s
  8203  2711 10530.0923   26  251 9520.13703 14467.3160  52.0%  1274  565s
  8347  2690 12226.5835   18  172 9520.13703 14467.3160  52.0%  1276  572s
  8541  2653 10201.5131   24   79 9520.13703 14338.5195  50.6%  1275  579s
  8753  2580 10675.0111   23  158 9520.13703 14237.4945  49.6%  1276  586s
  8963  2517     cutoff   20      9520.13703 14022.3973  47.3%  1279  594s
  9197  2442 11429.1152   21  234 9520.13703 14003.7865  47.1%  1280  601s
  9255  2430 9985.66959   22  167 9520.13703 14003.7865  47.1%  1283  609s
  9322  2395 9750.54301   23  160 9520.13703 14003.7865  47.1%  1287  615s
  9431  2349 10647.0662   23  379 9520.13703 13654.0379  43.4%  1290  625s
  9595  2286 10267.1813   25  325 9520.13703 13654.0379  43.4%  1291  632s
  9815  2191 10479.2323   23  221 9520.13703 13563.7807  42.5%  1288  641s
 10086  2090 9713.11756   21  208 9520.13703 13224.8393  38.9%  1291  649s
 10456  1921 10829.3183   28  371 9520.13703 13037.0024  36.9%  1285  657s
 10874  1628 10296.9661   25  196 9520.13703 12720.4190  33.6%  1278  668s
 11323  1257     cutoff   31      9520.13703 12380.6853  30.0%  1270  675s
 11939   713 10873.4720   26  271 9520.13703 11918.9314  25.2%  1247  682s
 12692   361     cutoff   26      9520.13703 11025.1506  15.8%  1206  685s
*13187    57              33    9529.3465070 11012.4031  15.6%  1165  685s

Cutting planes:
  Learned: 1
  Gomory: 2
  MIR: 502
  Flow cover: 931
  RLT: 14
  Relax-and-lift: 96

Explored 13677 nodes (15499271 simplex iterations) in 686.40 seconds (1919.51 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9529.35 9520.14 9502.75 ... -5999.21

Optimal solution found (tolerance 1.00e-06)
Best objective 9.529346506965e+03, best bound 9.529346506965e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 686.42s
  Master Objective (UB) = 9529.35, θ = 151615.46
  Upper Bound (UB) = 9529.35

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151615.46
  [DEBUG]   ✓ Scenario 0: θ = 151615.46 ≤ Q = 151615.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151615.46 ≤ Q = 151615.46 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151615.46 ≤ Q = 151615.46 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151615.46 ≤ Q = 151615.46 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x680f58a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0680f58a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.146367e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5618881.7269
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.360296e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136029.57    0  124 5618881.73 -136029.57   102%     -    0s
H    0     0                    -101220.2674 -136029.57  34.4%     -    0s
H    0     0                    -101385.7683 -136029.57  34.2%     -    0s
H    0     0                    -104840.4970 -120516.66  15.0%     -    0s
H    0     0                    -109982.0151 -120516.66  9.58%     -    0s
     0     0 -120516.66    0   85 -109982.02 -120516.66  9.58%     -    0s
H    0     0                    -113807.0295 -120448.59  5.84%     -    0s
H    0     0                    -116382.1737 -120448.59  3.49%     -    0s
     0     0 -118665.24    0   93 -116382.17 -118665.24  1.96%     -    0s
     0     0 -118252.77    0   84 -116382.17 -118252.77  1.61%     -    0s
H    0     0                    -116955.4689 -118250.07  1.11%     -    0s
H    0     0                    -117160.2096 -118250.07  0.93%     -    0s
     0     0 -118235.01    0   85 -117160.21 -118235.01  0.92%     -    0s
     0     0 -118234.98    0   85 -117160.21 -118234.98  0.92%     -    0s
     0     0 -118074.32    0   64 -117160.21 -118074.32  0.78%     -    0s
H    0     0                    -117177.8146 -118041.30  0.74%     -    0s
     0     0 -118041.30    0   59 -117177.81 -118041.30  0.74%     -    0s
     0     0 -118041.30    0   60 -117177.81 -118041.30  0.74%     -    0s
     0     0 -118039.75    0   61 -117177.81 -118039.75  0.74%     -    0s
     0     0 -117748.64    0   57 -117177.81 -117748.64  0.49%     -    0s
     0     0 -117748.32    0   56 -117177.81 -117748.32  0.49%     -    0s
     0     0 -117705.15    0   55 -117177.81 -117705.15  0.45%     -    0s
     0     0 -117481.76    0   30 -117177.81 -117481.76  0.26%     -    0s
H    0     0                    -117183.4300 -117457.01  0.23%     -    0s
     0     0 -117402.13    0   38 -117183.43 -117402.13  0.19%     -    0s
     0     0 -117392.44    0   38 -117183.43 -117392.44  0.18%     -    0s
     0     0 -117298.46    0   22 -117183.43 -117298.46  0.10%     -    0s
     0     0 -117282.94    0   21 -117183.43 -117282.94  0.08%     -    0s
     0     0 -117281.32    0   20 -117183.43 -117281.32  0.08%     -    0s
     0     0 -117267.86    0   16 -117183.43 -117267.86  0.07%     -    0s
     0     0 -117267.86    0   30 -117183.43 -117267.86  0.07%     -    0s
     0     0 -117227.89    0   19 -117183.43 -117227.89  0.04%     -    0s
     0     0 -117216.08    0    5 -117183.43 -117216.08  0.03%     -    0s
     0     0 -117206.54    0    7 -117183.43 -117206.54  0.02%     -    0s
     0     0 -117205.17    0    7 -117183.43 -117205.17  0.02%     -    0s
     0     0 -117185.82    0    2 -117183.43 -117185.82  0.00%     -    0s
     0     0     cutoff    0      -117183.43 -117183.43  0.00%     -    0s

Cutting planes:
  Gomory: 1
  MIR: 5
  Flow cover: 4

Explored 1 nodes (933 simplex iterations) in 0.18 seconds (0.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -117183 -117178 -117160 ... -101220
No other solutions better than -117183

Optimal solution found (tolerance 1.00e-06)
Best objective -1.171834300272e+05, best bound -1.171834300272e+05, gap 0.0000%
  Subproblem solved in 0.19s
  Worst-case operational profit (Z_SP) = 136360.37
  Scenario: 24 demand increases, 36 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -117183.43
  [DEBUG]   S×d_nominal = 253543.80
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253543.80 + -117183.43 = 136360.37
  [DEBUG]   Current θ from Master = 151615.46
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15255.09 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5725.75
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8544.7217, Absolute Gap = 8544.7217, Relative Gap = 0.896674
  Not converged yet (gap = 8544.72 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 24 increases, 36 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221674 nonzeros
Model fingerprint: 0x8a20a36e
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 35350 rows and 14350 columns
Presolve time: 0.89s
Presolved: 42483 rows, 19110 columns, 263069 nonzeros
Variable types: 16851 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209564.0980

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 42483 rows, 19110 columns, 263069 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31806    1.5012514e+04   0.000000e+00   1.065260e+07      5s
Concurrent spin time: 0.58s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 3.345820e+04, 21104 iterations, 4.39 seconds (8.95 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33458.1950    0  112 -209564.10 33458.1950   116%     -    5s
H    0     0                    -203945.2527 33458.1950   116%     -    5s
H    0     0                    -88756.68798 33458.1950   138%     -    5s
H    0     0                    -88718.49587 33458.1950   138%     -    5s
H    0     0                    -29727.80467 33458.1950   213%     -    5s
H    0     0                    -3256.384271 33458.1950  1127%     -    5s
H    0     0                    8747.9644615 33458.1950   282%     -    6s
H    0     0                    8893.5841470 33458.1950   276%     -    6s
H    0     0                    9102.6165923 33458.1950   268%     -    6s
H    0     0                    9115.9270172 33458.1950   267%     -    6s
     0     0 27045.8163    0  211 9115.92702 27045.8163   197%     -    9s
     0     0 26453.6578    0  249 9115.92702 26453.6578   190%     -   11s
     0     0 26442.7222    0  260 9115.92702 26442.7222   190%     -   11s
     0     0 26442.2393    0  264 9115.92702 26442.2393   190%     -   11s
     0     0 26442.1651    0  264 9115.92702 26442.1651   190%     -   11s
     0     0 24034.0410    0  299 9115.92702 24034.0410   164%     -   17s
     0     0 23311.6745    0  359 9115.92702 23311.6745   156%     -   20s
     0     0 23009.7828    0  341 9115.92702 23009.7828   152%     -   22s
     0     0 22980.8756    0  369 9115.92702 22980.8756   152%     -   23s
     0     0 22937.5844    0  353 9115.92702 22937.5844   152%     -   23s
     0     0 22925.7122    0  360 9115.92702 22925.7122   151%     -   24s
     0     0 22924.6692    0  358 9115.92702 22924.6692   151%     -   24s
     0     0 22924.5242    0  363 9115.92702 22924.5242   151%     -   24s
H    0     0                    9158.8312458 21174.8039   131%     -   30s
     0     0 21174.8039    0  342 9158.83125 21174.8039   131%     -   30s
     0     0 20737.6154    0  430 9158.83125 20737.6154   126%     -   33s
     0     0 20569.7988    0  433 9158.83125 20569.7988   125%     -   36s
H    0     0                    9289.1000740 20507.3839   121%     -   37s
     0     0 20507.3839    0  439 9289.10007 20507.3839   121%     -   37s
     0     0 20500.9959    0  451 9289.10007 20500.9959   121%     -   37s
     0     0 20489.1674    0  442 9289.10007 20489.1674   121%     -   38s
     0     0 20479.3547    0  440 9289.10007 20479.3547   120%     -   38s
     0     0 20469.7032    0  445 9289.10007 20469.7032   120%     -   39s
     0     0 20469.1860    0  443 9289.10007 20469.1860   120%     -   39s
     0     0 19916.0554    0  405 9289.10007 19916.0554   114%     -   47s
     0     0 19730.0170    0  454 9289.10007 19730.0170   112%     -   49s
     0     0 19710.3046    0  396 9289.10007 19710.3046   112%     -   50s
     0     0 19697.9558    0  391 9289.10007 19697.9558   112%     -   51s
     0     0 19685.7852    0  401 9289.10007 19685.7852   112%     -   51s
     0     0 19678.4254    0  396 9289.10007 19678.4254   112%     -   52s
     0     0 19677.6348    0  395 9289.10007 19677.6348   112%     -   52s
     0     0 19583.2245    0  382 9289.10007 19583.2245   111%     -   55s
     0     0 19553.9760    0  478 9289.10007 19553.9760   111%     -   56s
     0     0 19540.9518    0  402 9289.10007 19540.9518   110%     -   57s
     0     0 19538.0768    0  464 9289.10007 19538.0768   110%     -   57s
     0     0 19535.6868    0  471 9289.10007 19535.6868   110%     -   57s
     0     0 19535.3839    0  478 9289.10007 19535.3839   110%     -   58s
     0     0 19486.1185    0  461 9289.10007 19486.1185   110%     -   60s
     0     0 19479.6025    0  471 9289.10007 19479.6025   110%     -   62s
     0     0 19470.8491    0  475 9289.10007 19470.8491   110%     -   62s
     0     0 19466.5214    0  480 9289.10007 19466.5214   110%     -   62s
     0     0 19465.7978    0  482 9289.10007 19465.7978   110%     -   63s
     0     0 19457.3125    0  472 9289.10007 19457.3125   109%     -   64s
     0     0 19454.6498    0  471 9289.10007 19454.6498   109%     -   64s
     0     0 19453.8606    0  471 9289.10007 19453.8606   109%     -   65s
     0     0 19451.6960    0  475 9289.10007 19451.6960   109%     -   66s
     0     0 19450.1960    0  478 9289.10007 19450.1960   109%     -   68s
     0     0 19448.8510    0  481 9289.10007 19448.8510   109%     -   69s
     0     0 19448.0294    0  474 9289.10007 19448.0294   109%     -   69s
     0     0 19445.0713    0  482 9289.10007 19445.0713   109%     -   70s
     0     0 19444.4852    0  482 9289.10007 19444.4852   109%     -   70s
     0     2 19444.4852    0  482 9289.10007 19444.4852   109%     -   80s
     3     8 19244.6583    2  459 9289.10007 19260.1271   107%  2655   85s
    15    32 18638.3291    4  521 9289.10007 19127.1035   106%  3070   92s
    31    64 18594.5594    5  530 9289.10007 18637.9564   101%  4140   96s
    95   162 18433.3346    7  528 9289.10007 18593.7429   100%  2651  102s
   193   230 17497.6432    9  327 9289.10007 18593.7429   100%  2018  110s
   229   263 18102.4671   10  513 9289.10007 18593.7429   100%  2127  117s
   262   299 18024.3246   10  479 9289.10007 18593.7429   100%  2320  123s
   302   337 16271.8216   11  429 9289.10007 18593.7429   100%  2361  129s
H  305   337                    9308.7148284 18593.7429   100%  2360  129s
   353   400 15717.7266   11  482 9308.71483 18593.7429   100%  2348  135s
   439   465 15614.0989   12  394 9308.71483 18593.7429   100%  2428  140s
H  477   465                    9329.0991877 18593.7429  99.3%  2489  140s
   604   566 15384.8720   14  379 9329.09919 18593.7429  99.3%  2417  149s
H  607   566                    9410.9300800 18593.7429  97.6%  2419  149s
H  619   566                    9502.7539647 18593.7429  95.7%  2425  149s
H  622   566                    9520.1370264 18593.7429  95.3%  2420  149s
   677   617     cutoff   14      9520.13703 18593.7429  95.3%  2383  154s
   754   650 14872.6016   16  326 9520.13703 18429.8096  93.6%  2438  158s
   805   714 13538.3532   16  211 9520.13703 18429.8096  93.6%  2447  162s
   877   744 14457.2172   17  360 9520.13703 18429.8096  93.6%  2465  169s
   923   788 14332.4486   18  395 9520.13703 18429.8096  93.6%  2493  176s
   990   854 14006.9730   19  387 9520.13703 18429.8096  93.6%  2515  180s
  1077   910 13140.1951   19  311 9520.13703 18429.8096  93.6%  2515  187s
  1178   944 13712.8387   20  393 9520.13703 18429.8096  93.6%  2451  193s
  1256  1003 12844.9317   20  348 9520.13703 18429.8096  93.6%  2442  199s
  1363  1085 13508.4006   21  382 9520.13703 18022.8994  89.3%  2415  203s
  1478  1148 13291.4825   23  333 9520.13703 18022.8994  89.3%  2397  207s
  1610  1183 9981.57978   23  198 9520.13703 18022.8994  89.3%  2357  214s
  1728  1221 13225.8491   24  339 9520.13703 17699.4541  85.9%  2363  221s
  1804  1251 12871.8488   25  349 9520.13703 17699.4541  85.9%  2385  225s
  1848  1281 12852.2109   25  280 9520.13703 17699.4541  85.9%  2411  233s
  1912  1311 12830.1687   26  289 9520.13703 17699.4541  85.9%  2430  237s
  2015  1332 11549.9793   28  206 9520.13703 17699.4541  85.9%  2415  243s
  2056  1366 12458.4627   29  284 9520.13703 17699.4541  85.9%  2428  247s
  2098  1394 12265.2668   32  278 9520.13703 17699.4541  85.9%  2438  255s
  2170  1431 12062.9672   35  298 9520.13703 17699.4541  85.9%  2437  261s
  2237  1478 10308.4754   37  288 9520.13703 17456.8290  83.4%  2433  266s
  2308  1562 11731.1653   38  213 9520.13703 17456.8290  83.4%  2441  273s
  2412  1613 11074.3998   41  226 9520.13703 17456.8290  83.4%  2440  278s
  2540  1706 10982.6073   42  190 9520.13703 17456.8290  83.4%  2432  284s
  2672  1790 10204.0509   45  234 9520.13703 17439.1321  83.2%  2433  290s
  2831  1891     cutoff   14      9520.13703 17358.8761  82.3%  2439  296s
  3013  1947 16877.9105   15  253 9520.13703 17259.9042  81.3%  2421  304s
  3185  2028 14706.9068   17  370 9520.13703 17259.9042  81.3%  2430  312s
  3333  2095 13708.8606   20  360 9520.13703 17259.9042  81.3%  2459  321s
  3547  2197 12615.4606   24  314 9520.13703 17259.9042  81.3%  2464  330s
  3738  2283 10939.8211   27  255 9520.13703 17114.8442  79.8%  2469  338s
  3984  2404 9836.86499   40  161 9520.13703 17081.1100  79.4%  2464  347s
  4171  2497 13118.6907   14  203 9520.13703 17081.1100  79.4%  2479  357s
  4445  2617     cutoff   17      9520.13703 17081.1100  79.4%  2458  364s
  4750  2634     cutoff   17      9520.13703 16631.6010  74.7%  2433  376s
  4989  2722 10706.8269   18  187 9520.13703 16599.5784  74.4%  2424  387s
  5219  2761 10409.8687   18  243 9520.13703 16540.3827  73.7%  2433  399s
  5471  2835 11908.5291   20  158 9520.13703 16472.4707  73.0%  2446  410s
  5768  2875 9873.08253   21  337 9520.13703 16449.9604  72.8%  2447  422s
  6047  2894 10689.1941   20  184 9520.13703 16449.9604  72.8%  2454  433s
  6300  2963 11289.2857   10  290 9520.13703 16422.1311  72.5%  2455  445s
  6518  3066 11967.7602   10  274 9520.13703 16379.3915  72.0%  2485  455s
  6848  3067 12928.9307   13  482 9520.13703 16299.9083  71.2%  2479  479s
  6850  3068 16191.7996    8  112 9520.13703 16299.9083  71.2%  2478  490s
  6851  3069 12415.0948   12  287 9520.13703 16299.9083  71.2%  2478  500s
  6852  3070 15417.6027   10  315 9520.13703 16299.9083  71.2%  2477  507s
  6853  3070 14759.0889   10  418 9520.13703 16299.9083  71.2%  2477  513s
  6854  3071 13282.7104   12  384 9520.13703 16299.9083  71.2%  2477  516s
  6856  3072 12217.9100   33  512 9520.13703 16299.9083  71.2%  2476  521s
  6860  3075 11695.2487   21  509 9520.13703 16299.9083  71.2%  2474  527s
  6862  3076 12436.1530   14  456 9520.13703 16299.9083  71.2%  2474  530s
  6865  3078 12804.0889   14  460 9520.13703 16299.9083  71.2%  2473  536s
  6867  3080 11545.1183   18  409 9520.13703 16299.9083  71.2%  2472  540s
  6870  3082 14283.8188   12  354 9520.13703 16299.9083  71.2%  2471  548s
  6871  3082 11773.3964   27  507 9520.13703 16299.9083  71.2%  2470  550s
  6874  3084 12659.7984   16  490 9520.13703 16299.9083  71.2%  2469  557s
  6875  3085 12276.5013    8  538 9520.13703 16299.9083  71.2%  2469  560s
  6877  3086 13353.2273   11  496 9520.13703 16299.9083  71.2%  2468  575s
  6878  3087 10504.5105   41  496 9520.13703 16299.9083  71.2%  2468  590s
  6879  3091 16299.9083   10  387 9520.13703 16299.9083  71.2%  2484  596s
  6881  3094 16299.9083   11  461 9520.13703 16299.9083  71.2%  2484  601s
  6885  3101 16299.9083   12  426 9520.13703 16299.9083  71.2%  2485  610s
  6893  3114 16299.9083   13  458 9520.13703 16299.9083  71.2%  2488  617s
  6909  3128 15977.1447   14  244 9520.13703 16299.9083  71.2%  2502  631s
  6928  3150 14429.9077   15  322 9520.13703 16299.9083  71.2%  2510  642s
  6960  3155 11883.8840   16  401 9520.13703 16299.9083  71.2%  2526  653s
  7008  3171 11688.2684   17  443 9520.13703 16299.9083  71.2%  2554  664s
  7102  3179     cutoff   17      9520.13703 16299.9083  71.2%  2562  676s
  7196  3144     cutoff   19      9520.13703 16299.9083  71.2%  2573  684s
  7276  3146 11699.9347   18  218 9520.13703 16299.9083  71.2%  2593  692s
  7342  3138 10986.5420   20  213 9520.13703 16299.9083  71.2%  2607  700s
  7422  3134 12244.8115   18  204 9520.13703 16299.9083  71.2%  2613  705s
  7491  3135 12224.6592   19  203 9520.13703 16299.9083  71.2%  2626  713s
  7558  3131 10812.2348   22  176 9520.13703 16299.9083  71.2%  2636  719s
  7630  3136 10999.9946   22  145 9520.13703 16299.9083  71.2%  2642  726s
  7705  3122 10615.5326   25  109 9520.13703 16299.9083  71.2%  2643  736s
  7779  3127 15609.8845   15  444 9520.13703 16299.9083  71.2%  2648  743s
  7862  3120 15743.3100   15  384 9520.13703 16299.9083  71.2%  2651  752s
  7965  3106 14882.6122   16  336 9520.13703 15823.9275  66.2%  2650  760s
  8030  3102 15700.2875   16  307 9520.13703 15701.0198  64.9%  2649  767s
  8117  3092 10935.7126   18  286 9520.13703 15700.2000  64.9%  2654  773s
  8210  3085 15142.9774   17  420 9520.13703 15699.9298  64.9%  2652  780s
  8334  3041 13616.9449   17  274 9520.13703 15609.4331  64.0%  2643  798s
  8469  3004     cutoff   19      9520.13703 15609.4331  64.0%  2642  808s
  8541  2997 9807.27559   18  371 9520.13703 15609.4331  64.0%  2648  816s
  8661  2968     cutoff   19      9520.13703 15383.6759  61.6%  2646  823s
  8710  2974     cutoff   19      9520.13703 15383.6759  61.6%  2652  828s
  8755  2967     cutoff   20      9520.13703 15383.6759  61.6%  2653  837s
  8802  2956     cutoff   21      9520.13703 15383.6759  61.6%  2652  846s
  8899  2920 11024.4638   20  202 9520.13703 15153.0391  59.2%  2647  856s
  8989  2900     cutoff   21      9520.13703 15153.0391  59.2%  2652  867s
  9104  2851     cutoff   22      9520.13703 15153.0391  59.2%  2655  877s
  9232  2805 10282.3986   21  229 9520.13703 14055.6216  47.6%  2654  885s
  9377  2754 12411.0650   21  340 9520.13703 14033.0497  47.4%  2652  894s
  9547  2673     cutoff   24      9520.13703 13866.3118  45.7%  2657  903s
  9758  2592 10706.3548   23  385 9520.13703 13866.3118  45.7%  2653  914s
  9857  2529 10529.5289   24  284 9520.13703 13481.9452  41.6%  2663  924s
 10028  2414 10530.6292   28  281 9520.13703 13412.9085  40.9%  2663  933s
 10293  2202 11480.9416   25  311 9520.13703 13412.9085  40.9%  2644  940s
 10668  1885 9576.38407   20  157 9520.13703 12983.6047  36.4%  2606  951s
 11043  1722 infeasible   26      9520.13703 11631.3700  22.2%  2554  959s
 11188  1650     cutoff   25      9520.13703 10605.7396  11.4%  2530  962s

Cutting planes:
  Gomory: 5
  MIR: 562
  Flow cover: 1073
  RLT: 16
  Relax-and-lift: 106

Explored 11281 nodes (28439794 simplex iterations) in 962.29 seconds (2840.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9520.14 9502.75 9410.93 ... 8893.58

Optimal solution found (tolerance 1.00e-06)
Best objective 9.520137026402e+03, best bound 9.520137026402e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 962.30s
  Master Objective (UB) = 9520.14, θ = 151302.20
  Upper Bound (UB) = 9520.14

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151302.20
  [DEBUG]   ✓ Scenario 0: θ = 151302.20 ≤ Q = 151302.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151302.20 ≤ Q = 151302.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151302.20 ≤ Q = 151302.20 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151302.20 ≤ Q = 151302.20 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151302.20 ≤ Q = 151302.20 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7621481b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7621481b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.165594e+13
Presolve removed 2617 rows and 1906 columns
Presolve time: 0.00s
Presolved: 476 rows, 483 columns, 1345 nonzeros
Found heuristic solution: objective 5571226.6238
Variable types: 326 continuous, 157 integer (157 binary)
Found heuristic solution: objective 5570339.9403

Root relaxation: objective -1.378172e+05, 236 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -137817.17    0  120 5570339.94 -137817.17   102%     -    0s
H    0     0                    -96564.05355 -137817.17  42.7%     -    0s
H    0     0                    -97710.23843 -137817.17  41.0%     -    0s
H    0     0                    -113183.0655 -137817.17  21.8%     -    0s
     0     0 -120549.17    0   87 -113183.07 -120549.17  6.51%     -    0s
H    0     0                    -117143.5741 -120355.00  2.74%     -    0s
H    0     0                    -118273.0847 -120355.00  1.76%     -    0s
     0     0 -120355.00    0  102 -118273.08 -120355.00  1.76%     -    0s
     0     0 -119530.51    0  100 -118273.08 -119530.51  1.06%     -    0s
     0     0 -119513.48    0  100 -118273.08 -119513.48  1.05%     -    0s
     0     0 -119506.45    0  100 -118273.08 -119506.45  1.04%     -    0s
     0     0 -119408.31    0   99 -118273.08 -119408.31  0.96%     -    0s
H    0     0                    -118569.0998 -119408.31  0.71%     -    0s
     0     0 -119408.31    0   99 -118569.10 -119408.31  0.71%     -    0s
     0     2 -119408.31    0   99 -118569.10 -119408.31  0.71%     -    0s
H   37    16                    -118585.1078 -119075.59  0.41%  11.1    0s
*  395     6              42    -118587.7667 -118601.80  0.01%   7.1    0s
*  403     6              41    -118597.4049 -118601.32  0.00%   7.0    0s

Cutting planes:
  Gomory: 32
  Implied bound: 1
  MIR: 151
  Flow cover: 2
  RLT: 33

Explored 420 nodes (3334 simplex iterations) in 0.14 seconds (0.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -118597 -118597 -118588 ... 5.57034e+06
No other solutions better than -118597

Optimal solution found (tolerance 1.00e-06)
Best objective -1.185974048836e+05, best bound -1.185974048836e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 135520.67
  Scenario: 29 demand increases, 31 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -118597.40
  [DEBUG]   S×d_nominal = 254118.07
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254118.07 + -118597.40 = 135520.67
  [DEBUG]   Current θ from Master = 151302.20
  [DEBUG]   ⚠️  Z_SP ≤ θ by 15781.53 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6261.39
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8535.5122, Absolute Gap = 8535.5122, Relative Gap = 0.896575
  Not converged yet (gap = 8535.51 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 29 increases, 31 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264905 nonzeros
Model fingerprint: 0x89e7466d
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 42420 rows and 17220 columns
Presolve time: 0.81s
Presolved: 50703 rows, 22480 columns, 314579 nonzeros
Variable types: 20221 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209564.0980

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 50703 rows, 22480 columns, 314579 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31896    4.3821480e+03   0.000000e+00   1.347625e+07      5s
Concurrent spin time: 0.40s

Solved with dual simplex

Root relaxation: objective 3.345820e+04, 27407 iterations, 8.40 seconds (17.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33458.1950    0  112 -209564.10 33458.1950   116%     -    9s
H    0     0                    -204324.7524 33458.1950   116%     -    9s
H    0     0                    -88049.83524 33458.1950   138%     -    9s
H    0     0                    -87786.16693 33458.1950   138%     -    9s
H    0     0                    -87556.94238 33458.1950   138%     -    9s
H    0     0                    -87353.13081 33458.1950   138%     -    9s
H    0     0                    -29721.12340 33458.1950   213%     -    9s
H    0     0                     577.7063572 33458.1950  5692%     -    9s
H    0     0                    8397.2681268 33458.1950   298%     -    9s
H    0     0                    8867.1095612 33458.1950   277%     -   10s
H    0     0                    9062.0468196 33458.1950   269%     -   10s
H    0     0                    9102.6165923 33458.1950   268%     -   10s
H    0     0                    9115.9270172 33458.1950   267%     -   10s
     0     0 27024.2974    0  193 9115.92702 27024.2974   196%     -   16s
     0     0 26378.9106    0  211 9115.92702 26378.9106   189%     -   19s
     0     0 26378.9106    0  258 9115.92702 26378.9106   189%     -   20s
     0     0 26378.9106    0  258 9115.92702 26378.9106   189%     -   20s
     0     0 23677.6574    0  309 9115.92702 23677.6574   160%     -   27s
     0     0 22896.9408    0  319 9115.92702 22896.9408   151%     -   32s
     0     0 22632.3568    0  353 9115.92702 22632.3568   148%     -   33s
     0     0 22492.6271    0  361 9115.92702 22492.6271   147%     -   35s
     0     0 22470.9932    0  360 9115.92702 22470.9932   147%     -   36s
     0     0 22464.9992    0  364 9115.92702 22464.9992   146%     -   36s
     0     0 22448.2910    0  363 9115.92702 22448.2910   146%     -   37s
     0     0 22442.6823    0  366 9115.92702 22442.6823   146%     -   37s
     0     0 22441.1162    0  363 9115.92702 22441.1162   146%     -   37s
     0     0 22441.0401    0  366 9115.92702 22441.0401   146%     -   37s
     0     0 20948.0578    0  411 9115.92702 20948.0578   130%     -   44s
H    0     0                    9289.1000740 20668.3898   123%     -   47s
     0     0 20668.3898    0  407 9289.10007 20668.3898   123%     -   47s
     0     0 20530.2394    0  419 9289.10007 20530.2394   121%     -   50s
     0     0 20460.6336    0  427 9289.10007 20460.6336   120%     -   52s
     0     0 20418.1430    0  368 9289.10007 20418.1430   120%     -   53s
     0     0 20408.2923    0  429 9289.10007 20408.2923   120%     -   54s
     0     0 20402.4676    0  435 9289.10007 20402.4676   120%     -   55s
     0     0 20399.8153    0  378 9289.10007 20399.8153   120%     -   55s
     0     0 20398.9782    0  379 9289.10007 20398.9782   120%     -   55s
     0     0 19950.5681    0  388 9289.10007 19950.5681   115%     -   67s
     0     0 19795.0998    0  457 9289.10007 19795.0998   113%     -   70s
     0     0 19708.4675    0  469 9289.10007 19708.4675   112%     -   72s
     0     0 19642.0815    0  464 9289.10007 19642.0815   111%     -   74s
     0     0 19606.4665    0  464 9289.10007 19606.4665   111%     -   76s
     0     0 19587.9878    0  473 9289.10007 19587.9878   111%     -   77s
     0     0 19584.6716    0  482 9289.10007 19584.6716   111%     -   77s
     0     0 19583.2941    0  484 9289.10007 19583.2941   111%     -   77s
     0     0 19527.6439    0  480 9289.10007 19527.6439   110%     -   80s
     0     0 19512.3250    0  470 9289.10007 19512.3250   110%     -   81s
     0     0 19499.8941    0  473 9289.10007 19499.8941   110%     -   83s
     0     0 19494.4122    0  474 9289.10007 19494.4122   110%     -   83s
     0     0 19491.6319    0  484 9289.10007 19491.6319   110%     -   84s
     0     0 19490.4061    0  487 9289.10007 19490.4061   110%     -   84s
     0     0 19456.9560    0  419 9289.10007 19456.9560   109%     -   87s
     0     0 19436.2163    0  492 9289.10007 19436.2163   109%     -   92s
     0     0 19429.6577    0  501 9289.10007 19429.6577   109%     -   93s
     0     0 19428.2503    0  505 9289.10007 19428.2503   109%     -   93s
     0     0 19420.2811    0  490 9289.10007 19420.2811   109%     -   95s
     0     0 19416.4916    0  497 9289.10007 19416.4916   109%     -   96s
     0     0 19414.6808    0  489 9289.10007 19414.6808   109%     -   96s
     0     0 19412.2506    0  500 9289.10007 19412.2506   109%     -   97s
     0     0 19411.7320    0  501 9289.10007 19411.7320   109%     -   98s
     0     0 19410.6119    0  497 9289.10007 19410.6119   109%     -   99s
     0     0 19409.8937    0  510 9289.10007 19409.8937   109%     -  102s
     0     0 19407.7621    0  500 9289.10007 19407.7621   109%     -  103s
     0     0 19407.4056    0  506 9289.10007 19407.4056   109%     -  104s
     0     0 19405.5522    0  501 9289.10007 19405.5522   109%     -  105s
     0     0 19405.4915    0  501 9289.10007 19405.4915   109%     -  105s
     0     2 19405.4915    0  501 9289.10007 19405.4915   109%     -  122s
     1     4 19185.8028    1  467 9289.10007 19405.4915   109%  4312  126s
     7    16 18964.3363    3  506 9289.10007 19176.3580   106%  2520  133s
    15    32 18958.7640    4  515 9289.10007 18963.8301   104%  3402  138s
    31    64 18749.4267    5  505 9289.10007 18957.7213   104%  5106  146s
    63    74 15995.7990    6  321 9289.10007 18749.4239   102%  4274  154s
    73   105 16727.8410    7  305 9289.10007 18749.4239   102%  4425  164s
   104   183 16658.6512    8  305 9289.10007 18749.4239   102%  4920  171s
   182   266 16531.7895    9  302 9289.10007 18749.4239   102%  3751  178s
   271   296 16396.8711   10  304 9289.10007 18749.4239   102%  3117  182s
   306   333 15440.2065   11  269 9289.10007 18749.4239   102%  2970  190s
   365   390 15168.5767   11  262 9289.10007 18749.4239   102%  2744  197s
   440   458 15485.9442   10  279 9289.10007 18749.4239   102%  2575  202s
   529   531 13166.4487   10  344 9289.10007 18732.5433   102%  2323  208s
   614   600 15248.8637   12  275 9289.10007 18731.5463   102%  2178  213s
   715   654 13551.5034   12  254 9289.10007 18731.5463   102%  2025  219s
   811   698 15058.4185   12  254 9289.10007 18731.5463   102%  1935  226s
   887   751 15183.3551   13  270 9289.10007 18731.5463   102%  1891  232s
   968   801 13315.2375   13  249 9289.10007 18731.5463   102%  1826  238s
  1063   848 14804.3126   14  272 9289.10007 18731.5463   102%  1765  244s
  1140   882 13962.2127   15  240 9289.10007 18731.5463   102%  1761  250s
  1244   930 12496.4839   16  166 9289.10007 18228.8157  96.2%  1727  256s
  1338   995 12300.5424   15  247 9289.10007 18228.8157  96.2%  1725  263s
  1417  1099 13635.6846   16  240 9289.10007 18228.8157  96.2%  1740  267s
  1539  1163 15082.8943   14  280 9289.10007 18228.8157  96.2%  1692  272s
  1652  1241 13859.1812   16  259 9289.10007 18228.8157  96.2%  1682  276s
  1778  1323 13162.1204   19  282 9289.10007 18228.8157  96.2%  1660  284s
  1914  1385 12768.8729   17  249 9289.10007 17747.0015  91.1%  1642  290s
  2018  1419 11671.7221   19  171 9289.10007 17747.0015  91.1%  1651  296s
  2115  1481 13101.4277   20  239 9289.10007 17712.4007  90.7%  1634  303s
  2237  1541 12943.0107   21  271 9289.10007 17629.2794  89.8%  1629  312s
  2376  1603 12377.3181   22  204 9289.10007 17368.2578  87.0%  1626  319s
  2497  1684 12538.3151   23  229 9289.10007 17368.2578  87.0%  1630  327s
  2627  1743 10727.8669   25  113 9289.10007 17368.2578  87.0%  1633  333s
  2756  1831 10522.2244   27  120 9289.10007 17166.2527  84.8%  1639  341s
  2899  1910 9864.50414   37   67 9289.10007 17125.1730  84.4%  1643  350s
  3081  2000     cutoff   47      9289.10007 17125.1730  84.4%  1628  358s
  3219  2041 13308.9250   17  212 9289.10007 17125.1730  84.4%  1640  365s
  3296  2129 12661.8408   18  240 9289.10007 17125.1730  84.4%  1639  373s
  3455  2238 11290.7324   20  215 9289.10007 17014.7235  83.2%  1634  383s
  3678  2342 10982.1964   22  212 9289.10007 17014.7235  83.2%  1604  391s
  3880  2449 10134.9143   26  190 9289.10007 16884.3805  81.8%  1589  401s
  4091  2477 16367.2963    7  293 9289.10007 16820.3747  81.1%  1584  407s
  4127  2500 16072.1971    8  287 9289.10007 16820.3747  81.1%  1591  416s
  4180  2524 15615.2414    9  250 9289.10007 16761.7642  80.4%  1599  426s
  4252  2549 15307.0639   10  249 9289.10007 16761.7642  80.4%  1603  436s
  4315  2634 14491.4347   11  305 9289.10007 16761.7642  80.4%  1605  446s
  4479  2635 14364.1897   25  501 9289.10007 16761.7642  80.4%  1589  472s
  4481  2636 10094.8083   32  112 9289.10007 16761.7642  80.4%  1588  493s
  4482  2637 15456.6578   20  298 9289.10007 16761.7642  80.4%  1588  508s
  4483  2638 12438.5692   27  436 9289.10007 16761.7642  80.4%  1588  523s
  4484  2638 12979.7411   12  440 9289.10007 16761.7642  80.4%  1587  533s
  4485  2639 14027.2501   22  480 9289.10007 16761.7642  80.4%  1587  539s
  4486  2640 9461.52638   30  383 9289.10007 16761.7642  80.4%  1587  543s
  4487  2640 14249.0679    9  463 9289.10007 16761.7642  80.4%  1586  546s
  4489  2642 14808.2069   16  500 9289.10007 16761.7642  80.4%  1585  550s
  4492  2644 12413.6143   20  494 9289.10007 16761.7642  80.4%  1584  556s
  4493  2644 16319.1677   12  487 9289.10007 16761.7642  80.4%  1584  561s
  4495  2646 14813.1231   12  529 9289.10007 16761.7642  80.4%  1583  565s
  4497  2647 10392.9186   17  501 9289.10007 16761.7642  80.4%  1583  570s
  4499  2648 15136.9637   19  583 9289.10007 16761.7642  80.4%  1582  576s
  4501  2650 14364.1897   25  500 9289.10007 16761.7642  80.4%  1581  581s
  4503  2651 9743.34605   45  571 9289.10007 16761.7642  80.4%  1581  587s
  4504  2652 15113.3572    8  547 9289.10007 16761.7642  80.4%  1580  590s
  4507  2654 13458.7571   12  484 9289.10007 16761.7642  80.4%  1579  597s
  4509  2655 15384.6555   13  478 9289.10007 16761.7642  80.4%  1578  601s
  4510  2656 14744.8708   17  478 9289.10007 16761.7642  80.4%  1578  620s
  4511  2656 12268.7473   23  478 9289.10007 16761.7642  80.4%  1578  637s
  4512  2660 16761.7642   15  485 9289.10007 16761.7642  80.4%  1616  643s
  4514  2663 16761.7642   16  489 9289.10007 16761.7642  80.4%  1617  653s
  4518  2670 16761.7642   17  300 9289.10007 16761.7642  80.4%  1619  664s
  4526  2683 16761.7642   18  432 9289.10007 16761.7642  80.4%  1627  676s
  4542  2701 15839.0617   19  440 9289.10007 16761.7642  80.4%  1668  694s
  4565  2723 16033.4040   20  375 9289.10007 16761.7642  80.4%  1702  703s
  4597  2785 15703.7182   21  356 9289.10007 16761.7642  80.4%  1730  716s
  4692  2800 15171.5457   24  344 9289.10007 16761.7642  80.4%  1765  728s
  4775  2813 14960.8099   24  332 9289.10007 16761.7642  80.4%  1784  738s
  4853  2821 14346.7582   28  428 9289.10007 16761.7642  80.4%  1799  746s
  4929  2825 13724.3403   26  265 9289.10007 16761.7642  80.4%  1814  754s
  4991  2839 12761.2163   27  239 9289.10007 16761.7642  80.4%  1825  760s
  5044  2860 14342.2891   29  432 9289.10007 16761.7642  80.4%  1833  768s
  5112  2865 11868.0130   30  188 9289.10007 16761.7642  80.4%  1842  776s
  5197  2870 12009.1629   31  136 9289.10007 16761.7642  80.4%  1849  784s
  5275  2880 11990.3112   32  141 9289.10007 16761.7642  80.4%  1854  792s
  5352  2890 13616.2585   32  284 9289.10007 16761.7642  80.4%  1856  804s
  5428  2898 13312.7273   33  418 9289.10007 16761.7642  80.4%  1866  812s
  5503  2891     cutoff   33      9289.10007 16761.7642  80.4%  1876  821s
  5578  2888 10149.2988   36  106 9289.10007 16761.7642  80.4%  1886  829s
  5671  2890 9416.16348   38   62 9289.10007 16651.6080  79.3%  1890  838s
  5761  2900 14655.8149   20  386 9289.10007 16480.2377  77.4%  1899  847s
  5864  2895 15091.0795   21  412 9289.10007 15931.0329  71.5%  1907  853s
  5897  2907 14229.4060   21  247 9289.10007 15909.6229  71.3%  1911  862s
  5938  2914 14808.6352   22  413 9289.10007 15909.6229  71.3%  1924  868s
  5977  2916 14578.4299   22  334 9289.10007 15909.6229  71.3%  1928  877s
  6029  2914 14760.3229   23  424 9289.10007 15909.6229  71.3%  1931  885s
  6083  2909 13009.8589   23  211 9289.10007 15909.6229  71.3%  1940  891s
  6143  2915 14735.5326   24  330 9289.10007 15401.8686  65.8%  1943  901s
  6178  2935 13652.3270   24  279 9289.10007 15401.8686  65.8%  1950  908s
  6232  2927 14234.8400   25  282 9289.10007 15401.8686  65.8%  1954  918s
  6320  2919 13131.8527   25  225 9289.10007 15401.8686  65.8%  1950  927s
  6410  2909 14116.1473   26  361 9289.10007 15401.8686  65.8%  1953  938s
  6525  2881 12493.3030   26  219 9289.10007 15401.8686  65.8%  1955  948s
  6645  2884 13584.4466   28  344 9289.10007 15401.8686  65.8%  1960  960s
  6795  2835 12698.5195   29  416 9289.10007 15401.8686  65.8%  1964  972s
  7008  2773 9912.61242   30  157 9289.10007 15401.8686  65.8%  1960  985s
  7184  2761 10197.0941   31  391 9289.10007 14894.5724  60.3%  1971  998s
  7362  2739     cutoff   33      9289.10007 14885.1800  60.2%  1978 1011s
  7563  2704 10297.2392   33  296 9289.10007 14471.8416  55.8%  1982 1024s
  7755  2707 9667.26369   36  189 9289.10007 14409.2930  55.1%  1990 1037s
  7997  2658 12427.4183   28  231 9289.10007 14352.0846  54.5%  1987 1049s
  8207  2627 10456.7689   34  236 9289.10007 14083.4396  51.6%  1998 1064s
  8432  2561 11773.5735   31  157 9289.10007 14071.8042  51.5%  2004 1080s
  8696  2487     cutoff   31      9289.10007 14068.9089  51.5%  2006 1094s
  8925  2431 12323.3444   32  282 9289.10007 13707.5322  47.6%  2019 1109s
  9190  2355 infeasible   39      9289.10007 13704.3147  47.5%  2026 1124s
  9480  2245 9475.03381   24  185 9289.10007 13567.2322  46.1%  2032 1141s
  9777  2125     cutoff   34      9289.10007 13327.2667  43.5%  2036 1158s
 10067  2020 9489.50671   30  199 9289.10007 13327.2667  43.5%  2051 1176s
 10335  1898     cutoff   36      9289.10007 13114.3732  41.2%  2066 1195s
 10665  1738 11322.8515   34  316 9289.10007 12807.5272  37.9%  2072 1213s
 11030  1480 9879.98750   32  307 9289.10007 12627.0927  35.9%  2075 1234s
 11434  1180 infeasible   24      9289.10007 12323.2970  32.7%  2079 1250s
 11897   768     cutoff   25      9289.10007 12000.3297  29.2%  2075 1271s
 12466   135     cutoff   36      9289.10007 11500.6863  23.8%  2054 1287s
*12690   130              49    9308.7699574 11500.6863  23.5%  2035 1287s
 13354    53     cutoff   41      9308.76996 10842.2799  16.5%  1970 1290s
 13797    27 9423.84086   44   12 9308.76996 9461.69184  1.64%  1914 1305s

Cutting planes:
  Gomory: 3
  MIR: 669
  Flow cover: 1422
  RLT: 17
  Relax-and-lift: 156

Explored 14115 nodes (26586356 simplex iterations) in 1307.04 seconds (3799.51 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9308.77 9289.1 9115.93 ... -87353.1

Optimal solution found (tolerance 1.00e-06)
Best objective 9.308769957383e+03, best bound 9.308769957383e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1307.06s
  Master Objective (UB) = 9308.77, θ = 149747.59
  Upper Bound (UB) = 9308.77

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 149747.59
  [DEBUG]   ✓ Scenario 0: θ = 149747.59 ≤ Q = 149747.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 149747.59 ≤ Q = 149747.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 149747.59 ≤ Q = 149747.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 149747.59 ≤ Q = 149747.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 149747.59 ≤ Q = 149747.59 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 149747.59 ≤ Q = 149747.59 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x1b0a1565
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xe4f5ea9b
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.143240e+13
Presolve removed 2600 rows and 1892 columns
Presolve time: 0.00s
Presolved: 493 rows, 497 columns, 1390 nonzeros
Found heuristic solution: objective 5686677.3443
Variable types: 337 continuous, 160 integer (160 binary)

Root relaxation: objective -1.382916e+05, 250 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -138291.62    0  124 5686677.34 -138291.62   102%     -    0s
H    0     0                    -103216.1685 -138291.62  34.0%     -    0s
H    0     0                    -103504.9171 -138291.62  33.6%     -    0s
H    0     0                    -106962.5023 -138291.62  29.3%     -    0s
H    0     0                    -111703.8258 -138291.62  23.8%     -    0s
H    0     0                    -115671.8549 -120411.83  4.10%     -    0s
     0     0 -120411.83    0   74 -115671.85 -120411.83  4.10%     -    0s
H    0     0                    -116670.9622 -120295.86  3.11%     -    0s
H    0     0                    -118446.4409 -120010.73  1.32%     -    0s
     0     0 -120010.73    0   67 -118446.44 -120010.73  1.32%     -    0s
H    0     0                    -119086.1104 -120010.73  0.78%     -    0s
     0     0 -119697.26    0   57 -119086.11 -119697.26  0.51%     -    0s
     0     0 -119676.00    0   57 -119086.11 -119676.00  0.50%     -    0s
H    0     0                    -119108.0616 -119402.57  0.25%     -    0s
     0     0 -119402.57    0   41 -119108.06 -119402.57  0.25%     -    0s
     0     0 -119394.65    0   33 -119108.06 -119394.65  0.24%     -    0s
     0     0 -119372.09    0   33 -119108.06 -119372.09  0.22%     -    0s
     0     0 -119356.78    0   37 -119108.06 -119356.78  0.21%     -    0s
     0     0 -119354.63    0   37 -119108.06 -119354.63  0.21%     -    0s
     0     0 -119232.97    0   11 -119108.06 -119232.97  0.10%     -    0s
     0     0 -119232.97    0   19 -119108.06 -119232.97  0.10%     -    0s
H    0     0                    -119128.3315 -119232.97  0.09%     -    0s
     0     0 -119164.94    0    7 -119128.33 -119164.94  0.03%     -    0s
H    0     0                    -119134.2896 -119153.55  0.02%     -    0s
     0     0 -119152.40    0    5 -119134.29 -119152.40  0.02%     -    0s
     0     0 -119151.53    0    2 -119134.29 -119151.53  0.01%     -    0s
     0     0 -119151.28    0    2 -119134.29 -119151.28  0.01%     -    0s
H    0     0                    -119147.2518 -119151.28  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 12
  Flow cover: 7
  Relax-and-lift: 1

Explored 1 nodes (760 simplex iterations) in 0.12 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -119147 -119134 -119128 ... -103505
No other solutions better than -119147

Optimal solution found (tolerance 1.00e-06)
Best objective -1.191472518388e+05, best bound -1.191472518388e+05, gap 0.0000%
  Subproblem solved in 0.14s
  Worst-case operational profit (Z_SP) = 134965.60
  Scenario: 26 demand increases, 34 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -119147.25
  [DEBUG]   S×d_nominal = 254112.85
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254112.85 + -119147.25 = 134965.60
  [DEBUG]   Current θ from Master = 149747.59
  [DEBUG]   ⚠️  Z_SP ≤ θ by 14781.99 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5473.22
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8324.1451, Absolute Gap = 8324.1451, Relative Gap = 0.894226
  Not converged yet (gap = 8324.15 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 26 increases, 34 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308136 nonzeros
Model fingerprint: 0x752cb90a
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 49490 rows and 20090 columns
Presolve time: 0.95s
Presolved: 58923 rows, 25850 columns, 366089 nonzeros
Variable types: 23591 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209564.0980

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 58923 rows, 25850 columns, 366089 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32286   -2.0017909e+04   0.000000e+00   2.020887e+07      5s
   47771   -3.4530182e+03   0.000000e+00   3.783041e+06     10s
   61258    1.1699756e+04   0.000000e+00   9.315839e+06     15s
Concurrent spin time: 0.22s

Solved with dual simplex

Root relaxation: objective 3.316141e+04, 37837 iterations, 14.25 seconds (29.89 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 33161.4121    0  113 -209564.10 33161.4121   116%     -   15s
H    0     0                    -204324.7524 33161.4121   116%     -   15s
H    0     0                    -100102.7987 33161.4121   133%     -   15s
H    0     0                    -84668.65104 33161.4121   139%     -   15s
H    0     0                    -79405.83396 33161.4121   142%     -   15s
H    0     0                    -35316.85031 33161.4121   194%     -   15s
H    0     0                     688.2227881 33161.4121  4718%     -   15s
H    0     0                    7781.2736714 33161.4121   326%     -   16s
H    0     0                    8575.2830346 33161.4121   287%     -   16s
H    0     0                    8825.1028284 33161.4121   276%     -   16s
H    0     0                    8838.5289550 33161.4121   275%     -   16s
H    0     0                    8976.5717395 33161.4121   269%     -   16s
H    0     0                    8989.8821643 33161.4121   269%     -   16s
H    0     0                    9115.9270172 33161.4121   264%     -   16s
H    0     0                    9158.8312458 33161.4121   262%     -   16s
     0     0 27682.0299    0  192 9158.83125 27682.0299   202%     -   25s
     0     0 27261.9145    0  178 9158.83125 27261.9145   198%     -   28s
     0     0 27021.4560    0  162 9158.83125 27021.4560   195%     -   29s
     0     0 27020.0050    0  175 9158.83125 27020.0050   195%     -   30s
     0     0 27013.6512    0  202 9158.83125 27013.6512   195%     -   32s
     0     0 27013.6512    0  203 9158.83125 27013.6512   195%     -   32s
     0     0 27013.6512    0  203 9158.83125 27013.6512   195%     -   32s
     0     0 27013.6512    0  205 9158.83125 27013.6512   195%     -   32s
     0     0 25014.0953    0  256 9158.83125 25014.0953   173%     -   41s
     0     0 24602.3185    0  279 9158.83125 24602.3185   169%     -   46s
     0     0 24530.4323    0  275 9158.83125 24530.4323   168%     -   48s
     0     0 24499.2512    0  283 9158.83125 24499.2512   167%     -   49s
     0     0 24397.0086    0  313 9158.83125 24397.0086   166%     -   51s
     0     0 24329.8858    0  298 9158.83125 24329.8858   166%     -   53s
     0     0 24314.5759    0  293 9158.83125 24314.5759   165%     -   54s
     0     0 24314.0422    0  295 9158.83125 24314.0422   165%     -   54s
     0     0 22240.8381    0  373 9158.83125 22240.8381   143%     -   64s
     0     0 21483.1272    0  397 9158.83125 21483.1272   135%     -   71s
     0     0 21211.5538    0  363 9158.83125 21211.5538   132%     -   74s
     0     0 21131.9446    0  413 9158.83125 21131.9446   131%     -   77s
     0     0 21054.8577    0  428 9158.83125 21054.8577   130%     -   78s
     0     0 21024.1972    0  365 9158.83125 21024.1972   130%     -   80s
     0     0 21020.4060    0  364 9158.83125 21020.4060   130%     -   80s
     0     0 20996.3079    0  415 9158.83125 20996.3079   129%     -   82s
     0     0 20992.3983    0  429 9158.83125 20992.3983   129%     -   82s
     0     0 20991.1643    0  421 9158.83125 20991.1643   129%     -   83s
     0     0 20224.0804    0  439 9158.83125 20224.0804   121%     -   92s
     0     0 20030.6354    0  435 9158.83125 20030.6354   119%     -   96s
     0     0 19959.6393    0  443 9158.83125 19959.6393   118%     -   98s
     0     0 19889.8544    0  446 9158.83125 19889.8544   117%     -  100s
     0     0 19869.0535    0  458 9158.83125 19869.0535   117%     -  101s
     0     0 19864.1670    0  459 9158.83125 19864.1670   117%     -  102s
     0     0 19863.3258    0  458 9158.83125 19863.3258   117%     -  103s
     0     0 19772.3440    0  447 9158.83125 19772.3440   116%     -  106s
     0     0 19744.1453    0  467 9158.83125 19744.1453   116%     -  107s
     0     0 19730.8163    0  464 9158.83125 19730.8163   115%     -  109s
     0     0 19719.9179    0  476 9158.83125 19719.9179   115%     -  109s
     0     0 19718.0629    0  473 9158.83125 19718.0629   115%     -  110s
     0     0 19717.4694    0  482 9158.83125 19717.4694   115%     -  110s
     0     0 19636.2010    0  463 9158.83125 19636.2010   114%     -  114s
     0     0 19625.7025    0  470 9158.83125 19625.7025   114%     -  117s
     0     0 19612.4526    0  470 9158.83125 19612.4526   114%     -  118s
     0     0 19599.6806    0  467 9158.83125 19599.6806   114%     -  119s
     0     0 19595.9311    0  471 9158.83125 19595.9311   114%     -  119s
     0     0 19593.6595    0  472 9158.83125 19593.6595   114%     -  120s
     0     0 19592.6461    0  473 9158.83125 19592.6461   114%     -  120s
     0     0 19569.3443    0  498 9158.83125 19569.3443   114%     -  123s
     0     0 19549.8487    0  492 9158.83125 19549.8487   113%     -  125s
     0     0 19541.1969    0  485 9158.83125 19541.1969   113%     -  126s
     0     0 19529.6225    0  487 9158.83125 19529.6225   113%     -  127s
     0     0 19528.2411    0  485 9158.83125 19528.2411   113%     -  128s
     0     0 19523.3150    0  482 9158.83125 19523.3150   113%     -  130s
     0     0 19520.5991    0  478 9158.83125 19520.5991   113%     -  133s
     0     0 19520.2555    0  478 9158.83125 19520.2555   113%     -  134s
     0     0 19513.7877    0  481 9158.83125 19513.7877   113%     -  136s
     0     0 19511.2830    0  520 9158.83125 19511.2830   113%     -  137s
     0     0 19510.0840    0  516 9158.83125 19510.0840   113%     -  137s
     0     0 19501.3204    0  358 9158.83125 19501.3204   113%     -  139s
     0     0 19500.4539    0  356 9158.83125 19500.4539   113%     -  141s
     0     0 19499.4423    0  477 9158.83125 19499.4423   113%     -  141s
     0     0 19499.2403    0  480 9158.83125 19499.2403   113%     -  142s
     0     0 19496.7111    0  471 9158.83125 19496.7111   113%     -  143s
     0     0 19496.4805    0  471 9158.83125 19496.4805   113%     -  144s
     0     2 19496.3087    0  471 9158.83125 19496.3087   113%     -  168s
     1     4 19337.4900    1  460 9158.83125 19496.3086   113%  3633  171s
     3     8 19265.0247    2  510 9158.83125 19337.3055   111%  4038  176s
     7    16 19032.8261    3  513 9158.83125 19264.7215   110%  5756  183s
    15    32 18921.0798    4  456 9158.83125 19032.6828   108%  5981  190s
    31    49 14681.8001    5  214 9158.83125 18921.0535   107%  8285  209s
    48    81 15110.6857    6  217 9158.83125 18921.0535   107% 10109  222s
    80   167 11662.6329    7  320 9158.83125 18921.0535   107%  7583  235s
   166   240 11615.6561    8  316 9158.83125 18921.0535   107%  5789  243s
   255   290 11573.0783    8  307 9158.83125 18921.0535   107%  4380  251s
H  331   290                    9248.5303013 18921.0535   105%  3850  251s
   333   317 11270.4763    9  301 9248.53030 18921.0535   105%  3839  259s
H  335   317                    9289.1000740 18921.0535   104%  3841  259s
   424   330 10567.8201    9  246 9289.10007 18921.0535   104%  3498  267s
   509   373 9871.03210    9  217 9289.10007 18921.0535   104%  3396  275s
   584   414 10214.5009   10  264 9289.10007 18921.0535   104%  3319  283s
   665   466 infeasible   10      9289.10007 18921.0535   104%  3212  290s
   747   540     cutoff   10      9289.10007 18921.0535   104%  3111  296s
   854   573 12996.1994    7  403 9289.10007 18921.0535   104%  2980  303s
   933   616 12864.2693    8  383 9289.10007 18921.0535   104%  2875  310s
  1030   636 11424.3907    9  327 9289.10007 18921.0535   104%  2796  317s
  1104   677 11044.8580   10  343 9289.10007 18921.0535   104%  2759  324s
  1185   699 9947.94127   11  284 9289.10007 18921.0535   104%  2790  331s
  1222   725     cutoff   12      9289.10007 18921.0535   104%  2845  337s
  1264   755 15966.0167   11  315 9289.10007 18921.0535   104%  2885  344s
  1334   789 12853.1585   13  223 9289.10007 18921.0535   104%  2905  352s
  1415   833 10837.2359   14  199 9289.10007 18921.0535   104%  2865  360s
  1501   878     cutoff   17      9289.10007 18729.5420   102%  2842  368s
  1598   951     cutoff   21      9289.10007 18374.0209  97.8%  2852  375s
  1709  1014 17498.9140    6  383 9289.10007 17903.6758  92.7%  2808  384s
  1804  1104 16577.0163    7  326 9289.10007 17903.6758  92.7%  2811  393s
  1941  1154 14406.3310    8  322 9289.10007 17903.6758  92.7%  2770  402s
  2072  1193 16850.9647    6  351 9289.10007 17903.6758  92.7%  2732  411s
  2179  1245 12351.8972    9  365 9289.10007 17903.6758  92.7%  2741  422s
  2321  1277 11950.0107   10  279 9289.10007 17903.6758  92.7%  2716  432s
  2445  1338 11217.3804   11  231 9289.10007 17903.6758  92.7%  2738  443s
  2554  1362 10924.6553   10  235 9289.10007 17903.6758  92.7%  2802  450s
  2594  1388 12507.2757   10  264 9289.10007 17903.6758  92.7%  2847  457s
  2676  1435     cutoff   12      9289.10007 17903.6758  92.7%  2864  468s
  2828  1471 14667.4826   12  363 9289.10007 17498.5038  88.4%  2850  479s
  2965  1518 13932.3210   15  328 9289.10007 17498.5038  88.4%  2866  491s
  3090  1549 13477.3647   17  253 9289.10007 16104.0856  73.4%  2915  502s
  3241  1640 11869.3808   22  138 9289.10007 16051.8639  72.8%  2941  515s
  3444  1689 10581.9576   43   87 9289.10007 16051.8639  72.8%  2930  530s
  3622  1748 11933.2192   15  260 9289.10007 16051.8639  72.8%  2958  541s
  3790  1764 9439.08292   20  227 9289.10007 16051.8639  72.8%  2996  554s
  3938  1817 13042.0527   18  248 9289.10007 15449.5888  66.3%  3001  565s
  4122  1879 12004.4264   20  329 9289.10007 15231.0675  64.0%  3000  579s
  4287  1955 11626.1475   23  289 9289.10007 15116.3871  62.7%  3066  595s
  4497  2026 10330.4699   28  243 9289.10007 15034.6070  61.9%  3086  610s
  4740  2110     cutoff   34      9289.10007 14980.6072  61.3%  3068  623s
  4984  2149     cutoff   15      9289.10007 14866.2061  60.0%  3086  639s
  5232  2288 infeasible    9      9289.10007 14726.0876  58.5%  3091  653s
  5539  2289 9841.13469   22  471 9289.10007 14648.0825  57.7%  3056  696s
  5541  2290 11874.3298   14  113 9289.10007 14648.0825  57.7%  3055  722s
  5542  2291 13529.6709   26  332 9289.10007 14648.0825  57.7%  3055  739s
  5543  2292 11449.0764   14  418 9289.10007 14648.0825  57.7%  3054  751s
  5544  2292 11988.4817   13  472 9289.10007 14648.0825  57.7%  3053  758s
  5545  2293 14015.0839   13  458 9289.10007 14648.0825  57.7%  3053  763s
  5546  2294 12369.4966    7  470 9289.10007 14648.0825  57.7%  3052  766s
  5547  2294 13549.5280   25  453 9289.10007 14648.0825  57.7%  3052  771s
  5549  2296 12153.0715   22  471 9289.10007 14648.0825  57.7%  3051  776s
  5550  2296 12937.3368   11  476 9289.10007 14648.0825  57.7%  3050  783s
  5551  2297 9984.64777   14  489 9289.10007 14648.0825  57.7%  3050  786s
  5553  2298 14017.8764    8  568 9289.10007 14648.0825  57.7%  3048  797s
  5554  2299 11416.7848   26  541 9289.10007 14648.0825  57.7%  3048  800s
  5555  2300 11021.2777   20  496 9289.10007 14648.0825  57.7%  3047  805s
  5557  2301 12536.3038   15  545 9289.10007 14648.0825  57.7%  3046  813s
  5558  2302 12081.3742   16  481 9289.10007 14648.0825  57.7%  3046  816s
  5559  2302 10329.6601   29  486 9289.10007 14648.0825  57.7%  3045  821s
  5561  2304 11491.7810   10  476 9289.10007 14648.0825  57.7%  3044  826s
  5562  2304 10942.7720   27  476 9289.10007 14648.0825  57.7%  3044  850s
  5563  2305 14107.5436    9  476 9289.10007 14648.0825  57.7%  3043  865s
  5564  2309 14648.0825   11  510 9289.10007 14648.0825  57.7%  3080  874s
  5566  2312 14648.0825   12  501 9289.10007 14648.0825  57.7%  3081  887s
  5570  2319 14648.0825   13  516 9289.10007 14648.0825  57.7%  3082  903s
  5578  2332 14648.0825   14  516 9289.10007 14648.0825  57.7%  3091  914s
  5594  2346 14648.0825   15  247 9289.10007 14648.0825  57.7%  3115  940s
  5613  2365 14648.0825   16  498 9289.10007 14648.0825  57.7%  3141  956s
  5644  2376 14547.9063   17  427 9289.10007 14648.0825  57.7%  3179  974s
  5674  2402 14424.1238   18  428 9289.10007 14648.0825  57.7%  3216  990s
  5736  2393 13604.1927   21  408 9289.10007 14648.0825  57.7%  3236 1007s
  5799  2386 11100.1363   22  380 9289.10007 14648.0825  57.7%  3243 1020s
  5865  2384 11817.4550   20  201 9289.10007 14648.0825  57.7%  3251 1032s
  5938  2400 11058.8453   21  228 9289.10007 14648.0825  57.7%  3258 1043s
  6023  2396 10268.8614   23  359 9289.10007 14648.0825  57.7%  3257 1053s
  6082  2399 9445.91056   24  336 9289.10007 14648.0825  57.7%  3255 1063s
  6156  2390 9328.93752   25  335 9289.10007 14648.0825  57.7%  3252 1073s
  6235  2378     cutoff   26      9289.10007 14648.0825  57.7%  3242 1084s
  6327  2361 11337.7636   24  356 9289.10007 14648.0825  57.7%  3227 1093s
  6396  2353 10351.5077   25  227 9289.10007 14648.0825  57.7%  3229 1104s
  6475  2346 11223.2309   25  357 9289.10007 14648.0825  57.7%  3225 1114s
  6564  2322     cutoff   27      9289.10007 14648.0825  57.7%  3216 1123s
  6614  2319 11101.0410   27  344 9289.10007 14648.0825  57.7%  3216 1132s
  6654  2324     cutoff   28      9289.10007 14648.0825  57.7%  3218 1146s
  6703  2324 10349.1818   29  312 9289.10007 14648.0825  57.7%  3214 1154s
  6748  2328 9568.33443   30  145 9289.10007 14648.0825  57.7%  3211 1164s
  6814  2320 9542.51508   31  151 9289.10007 14648.0825  57.7%  3204 1176s
  6899  2315 10007.5565   30  291 9289.10007 14648.0825  57.7%  3195 1189s
  7005  2313     cutoff   31      9289.10007 14648.0825  57.7%  3189 1200s
  7132  2280 11273.4502   23  105 9289.10007 14648.0825  57.7%  3173 1213s
  7267  2242 infeasible   20      9289.10007 14648.0825  57.7%  3158 1226s
  7378  2208     cutoff   23      9289.10007 14648.0825  57.7%  3161 1239s
  7513  2155 13135.0017   18  362 9289.10007 14648.0825  57.7%  3152 1257s
  7650  2096 11383.1734   20  311 9289.10007 14648.0825  57.7%  3148 1270s
  7776  2033 10349.0310   23  297 9289.10007 14648.0825  57.7%  3150 1283s
  7925  1947     cutoff   25      9289.10007 13306.8520  43.3%  3148 1297s
  8094  1823     cutoff   27      9289.10007 13306.8520  43.3%  3139 1313s
  8287  1683 10552.3090   24  301 9289.10007 13306.8520  43.3%  3125 1327s
  8521  1481 10444.1963   25  305 9289.10007 13306.8520  43.3%  3098 1340s
  8755  1285 9448.49939   26  131 9289.10007 13306.8520  43.3%  3061 1352s
  9042  1171 infeasible   23      9289.10007 10904.1460  17.4%  2995 1355s

Cutting planes:
  Learned: 2
  Gomory: 3
  MIR: 584
  Mixing: 1
  Flow cover: 1191
  RLT: 11
  Relax-and-lift: 125

Explored 9708 nodes (27366119 simplex iterations) in 1358.11 seconds (3897.35 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 9289.1 9248.53 9158.83 ... 7781.27

Optimal solution found (tolerance 1.00e-06)
Best objective 9.289100074009e+03, best bound 9.289100074009e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1358.13s
  Master Objective (UB) = 9289.10, θ = 152540.60
  Upper Bound (UB) = 9289.10

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152540.60
  [DEBUG]   ✓ Scenario 0: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152540.60 ≤ Q = 152540.60 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 152540.60 ≤ Q = 152540.60 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x6663f9e3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x6663f9e3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.142822e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5640729.6839
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.355779e+05, 262 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -135577.86    0  124 5640729.68 -135577.86   102%     -    0s
H    0     0                    -101137.7058 -135577.86  34.1%     -    0s
H    0     0                    -101545.3941 -135577.86  33.5%     -    0s
H    0     0                    -104884.3817 -115691.23  10.3%     -    0s
H    0     0                    -109715.2739 -115691.23  5.45%     -    0s
     0     0 -115691.23    0   61 -109715.27 -115691.23  5.45%     -    0s
     0     0 -114377.27    0   44 -109715.27 -114377.27  4.25%     -    0s
     0     0 -114207.67    0   56 -109715.27 -114207.67  4.09%     -    0s
     0     0 -114205.37    0   57 -109715.27 -114205.37  4.09%     -    0s
     0     0 -114000.68    0   55 -109715.27 -114000.68  3.91%     -    0s
H    0     0                    -113715.5444 -113998.56  0.25%     -    0s
H    0     0                    -113800.4545 -113998.56  0.17%     -    0s
     0     0 -113978.30    0   68 -113800.45 -113978.30  0.16%     -    0s
     0     0 -113957.32    0   34 -113800.45 -113957.32  0.14%     -    0s
     0     0 -113936.92    0   31 -113800.45 -113936.92  0.12%     -    0s
     0     0 -113905.40    0   18 -113800.45 -113905.40  0.09%     -    0s
     0     0 -113886.12    0    8 -113800.45 -113886.12  0.08%     -    0s
H    0     0                    -113817.7853 -113853.24  0.03%     -    0s
     0     0 -113853.24    0    5 -113817.79 -113853.24  0.03%     -    0s
     0     0 -113844.29    0    4 -113817.79 -113844.29  0.02%     -    0s
     0     0 -113844.29    0    8 -113817.79 -113844.29  0.02%     -    0s
H    0     0                    -113828.8348 -113844.29  0.01%     -    0s
H    0     0                    -113829.1163 -113835.25  0.01%     -    0s
     0     0 -113835.25    0    2 -113829.12 -113835.25  0.01%     -    0s
*    0     0               0    -113831.3627 -113831.36  0.00%     -    0s

Cutting planes:
  Gomory: 4
  Implied bound: 2
  MIR: 3
  Flow cover: 3
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (631 simplex iterations) in 0.09 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -113831 -113829 -113829 ... -104884
No other solutions better than -113831

Optimal solution found (tolerance 1.00e-06)
Best objective -1.138313626810e+05, best bound -1.138313626810e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 140608.99
  Scenario: 20 demand increases, 40 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -113831.36
  [DEBUG]   S×d_nominal = 254440.35
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 254440.35 + -113831.36 = 140608.99
  [DEBUG]   Current θ from Master = 152540.60
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11931.61 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2642.51
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 8304.4753, Absolute Gap = 8304.4753, Relative Gap = 0.894002
  Not converged yet (gap = 8304.48 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 20 increases, 40 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351367 nonzeros
Model fingerprint: 0x4b21ef2d
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 56560 rows and 22960 columns
Presolve time: 1.09s
Presolved: 67143 rows, 29220 columns, 417599 nonzeros
Variable types: 26961 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209564.0980

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 67143 rows, 29220 columns, 417599 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33216   -6.6006285e+04   0.000000e+00   5.304348e+09      5s
   48054    8.2315538e+03   0.000000e+00   8.865072e+06     10s
   57554    2.1275147e+04   0.000000e+00   1.912768e+06     15s
   65007    2.3797292e+04   0.000000e+00   3.534084e+06     20s
   72642    2.5850588e+04   0.000000e+00   8.558962e+05     25s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 3.197866e+04, 49944 iterations, 24.52 seconds (49.20 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 31978.6587    0  118 -209564.10 31978.6587   115%     -   26s
H    0     0                    -197046.3970 31978.6587   116%     -   26s
H    0     0                    -120148.0587 31978.6587   127%     -   26s
H    0     0                    -115324.6508 31978.6587   128%     -   26s
H    0     0                    -113042.1070 31978.6587   128%     -   26s
H    0     0                    -112397.3853 31978.6587   128%     -   26s
H    0     0                    -112228.8131 31978.6587   128%     -   26s
H    0     0                    -47579.77165 31978.6587   167%     -   26s
H    0     0                    -29476.51150 31978.6587   208%     -   26s
H    0     0                    -28713.43003 31978.6587   211%     -   26s
H    0     0                    -7324.509745 31978.6587   537%     -   27s
H    0     0                    -2991.641917 31978.6587  1169%     -   27s
H    0     0                    -1258.016200 31978.6587  2642%     -   27s
H    0     0                    -893.6868684 31978.6587  3678%     -   27s
H    0     0                    -797.0164914 31978.6587  4112%     -   27s
H    0     0                    -583.7509842 31978.6587  5578%     -   27s
H    0     0                    -482.6616627 26519.8632  5595%     -   40s
     0     0 26519.8632    0  201 -482.66166 26519.8632  5595%     -   41s
H    0     0                    -393.4105771 26519.2759  6841%     -   41s
H    0     0                    -283.4621532 26519.2759  9455%     -   41s
H    0     0                    -269.5166246 26519.2759  9940%     -   41s
     0     0 26056.4189    0  215 -269.51662 26056.4189  9768%     -   45s
     0     0 26056.4189    0  209 -269.51662 26056.4189  9768%     -   47s
     0     0 26016.1321    0  214 -269.51662 26016.1321  9753%     -   48s
     0     0 25965.9815    0  211 -269.51662 25965.9815  9734%     -   49s
     0     0 25965.7023    0  215 -269.51662 25965.7023  9734%     -   49s
     0     0 23220.6614    0  264 -269.51662 23220.6614  8716%     -   61s
H    0     0                     688.4406735 22811.3340  3213%     -   67s
H    0     0                     840.6579527 22811.3340  2614%     -   67s
H    0     0                     993.7808580 22811.3340  2195%     -   67s
H    0     0                    1004.5675568 22811.3340  2171%     -   67s
     0     0 22811.3340    0  297 1004.56756 22811.3340  2171%     -   67s
     0     0 22659.2566    0  306 1004.56756 22659.2566  2156%     -   71s
     0     0 22559.3137    0  312 1004.56756 22559.3137  2146%     -   73s
     0     0 22525.4422    0  306 1004.56756 22525.4422  2142%     -   75s
     0     0 22520.7845    0  313 1004.56756 22520.7845  2142%     -   75s
     0     0 22513.9293    0  306 1004.56756 22513.9293  2141%     -   75s
     0     0 22506.4163    0  307 1004.56756 22506.4163  2140%     -   76s
     0     0 22504.6105    0  304 1004.56756 22504.6105  2140%     -   76s
     0     0 22504.3140    0  307 1004.56756 22504.3140  2140%     -   76s
     0     0 21057.5078    0  344 1004.56756 21057.5078  1996%     -   90s
H    0     0                    2891.5107285 20582.0212   612%     -   96s
H    0     0                    2927.3923919 20582.0212   603%     -   96s
H    0     0                    3183.8466347 20582.0212   546%     -   96s
H    0     0                    3343.0591385 20582.0212   516%     -   96s
     0     0 20582.0212    0  422 3343.05914 20582.0212   516%     -   96s
     0     0 20399.3237    0  440 3343.05914 20399.3237   510%     -  100s
     0     0 20267.5297    0  366 3343.05914 20267.5297   506%     -  104s
     0     0 20203.2790    0  436 3343.05914 20203.2790   504%     -  108s
     0     0 20174.2171    0  439 3343.05914 20174.2171   503%     -  110s
     0     0 20159.5554    0  441 3343.05914 20159.5554   503%     -  111s
     0     0 20147.3512    0  451 3343.05914 20147.3512   503%     -  111s
     0     0 20144.0667    0  449 3343.05914 20144.0667   503%     -  112s
     0     0 20143.2170    0  445 3343.05914 20143.2170   503%     -  112s
H    0     0                    3396.7694607 19196.1923   465%     -  129s
H    0     0                    3425.2536846 19196.1923   460%     -  129s
     0     0 19196.1923    0  457 3425.25368 19196.1923   460%     -  129s
H    0     0                    3426.0812918 19196.1747   460%     -  130s
H    0     0                    3464.6519596 19196.1747   454%     -  130s
H    0     0                    3563.3342619 19196.1747   439%     -  130s
     0     0 18944.3343    0  406 3563.33426 18944.3343   432%     -  136s
     0     0 18854.7101    0  468 3563.33426 18854.7101   429%     -  141s
     0     0 18803.8690    0  464 3563.33426 18803.8690   428%     -  143s
     0     0 18758.7895    0  399 3563.33426 18758.7895   426%     -  146s
     0     0 18746.1630    0  470 3563.33426 18746.1630   426%     -  148s
     0     0 18739.2893    0  472 3563.33426 18739.2893   426%     -  149s
     0     0 18725.7640    0  480 3563.33426 18725.7640   426%     -  151s
     0     0 18717.7442    0  486 3563.33426 18717.7442   425%     -  152s
     0     0 18716.9675    0  488 3563.33426 18716.9675   425%     -  152s
     0     0 18574.5001    0  416 3563.33426 18574.5001   421%     -  159s
     0     0 18544.8799    0  472 3563.33426 18544.8799   420%     -  163s
     0     0 18523.2855    0  485 3563.33426 18523.2855   420%     -  165s
     0     0 18514.0329    0  481 3563.33426 18514.0329   420%     -  166s
     0     0 18509.6290    0  486 3563.33426 18509.6290   419%     -  167s
     0     0 18504.2850    0  492 3563.33426 18504.2850   419%     -  168s
     0     0 18502.8425    0  496 3563.33426 18502.8425   419%     -  169s
     0     0 18458.7681    0  473 3563.33426 18458.7681   418%     -  174s
     0     0 18434.1325    0  524 3563.33426 18434.1325   417%     -  180s
     0     0 18416.7241    0  538 3563.33426 18416.7241   417%     -  183s
     0     0 18409.7080    0  527 3563.33426 18409.7080   417%     -  185s
     0     0 18405.7439    0  536 3563.33426 18405.7439   417%     -  187s
     0     0 18401.9849    0  487 3563.33426 18401.9849   416%     -  188s
     0     0 18400.6216    0  541 3563.33426 18400.6216   416%     -  188s
     0     0 18335.9111    0  423 3563.33426 18335.9111   415%     -  194s
     0     0 18325.3624    0  486 3563.33426 18325.3624   414%     -  197s
     0     0 18319.8447    0  484 3563.33426 18319.8447   414%     -  198s
     0     0 18318.2617    0  486 3563.33426 18318.2617   414%     -  200s
     0     0 18303.3619    0  478 3563.33426 18303.3619   414%     -  203s
H    0     0                    3566.0069780 18303.3431   413%     -  204s
     0     0 18296.1159    0  485 3566.00698 18296.1159   413%     -  205s
     0     0 18293.5468    0  489 3566.00698 18293.5468   413%     -  206s
     0     0 18293.2297    0  493 3566.00698 18293.2297   413%     -  206s
     0     0 18276.5142    0  500 3566.00698 18276.5142   413%     -  209s
     0     0 18271.5030    0  509 3566.00698 18271.5030   412%     -  211s
     0     0 18269.0579    0  508 3566.00698 18269.0579   412%     -  212s
     0     0 18268.0198    0  450 3566.00698 18268.0198   412%     -  213s
     0     0 18261.8633    0  503 3566.00698 18261.8633   412%     -  215s
H    0     0                    3576.9802831 18261.8364   411%     -  216s
H    0     0                    3605.8802853 18261.8364   406%     -  216s
     0     0 18260.8374    0  504 3605.88029 18260.8374   406%     -  217s
     0     0 18259.5355    0  422 3605.88029 18259.5355   406%     -  219s
     0     0 18257.4223    0  425 3605.88029 18257.4223   406%     -  220s
     0     0 18257.1628    0  427 3605.88029 18257.1628   406%     -  221s
     0     0 18252.5120    0  505 3605.88029 18252.5120   406%     -  223s
     0     0 18251.7419    0  508 3605.88029 18251.7419   406%     -  225s
     0     0 18246.5518    0  510 3605.88029 18246.5518   406%     -  227s
     0     0 18246.3035    0  510 3605.88029 18246.3035   406%     -  228s
     0     2 18246.0945    0  510 3605.88029 18246.0945   406%     -  259s
     1     4 18164.0727    1  487 3605.88029 18244.9956   406%  4264  264s
     3     8 18030.5600    2  485 3605.88029 18163.9090   404%  4951  276s
     7    16 17662.9526    3  514 3605.88029 18029.0396   400%  6928  286s
    15    32 17653.4663    4  518 3605.88029 17662.7852   390%  7020  298s
    31    50 14148.5233    5  289 3605.88029 17652.7194   390% 10006  326s
    49    82 15004.2290    6  399 3605.88029 17652.7194   390% 12181  341s
H   51    82                    3620.4327249 17652.7194   388% 11976  341s
H   53    82                    3683.4871536 17652.7194   379% 11832  341s
    81   131 14823.6123    7  393 3683.48715 17652.7194   379%  9672  359s
   130   255 14756.3207    8  460 3683.48715 17652.7194   379%  9648  375s
   254   340 14602.9605   12  392 3683.48715 17652.7194   379%  6412  386s
   345   417 12979.0458   12  251 3683.48715 17652.7194   379%  5437  395s
   435   455 12000.4490   11  232 3683.48715 17652.7194   379%  4767  404s
   527   473 14241.5071   13  421 3683.48715 17652.7194   379%  4263  413s
H  543   473                    3701.0837741 17652.7194   377%  4184  413s
   567   504 14139.5891   14  424 3701.08377 17652.7194   377%  4123  423s
   646   531 13891.5170   16  411 3701.08377 17652.7194   377%  3844  431s
   699   559 13306.9080   17  431 3701.08377 17652.7194   377%  3717  439s
   761   576 4201.59801   23  251 3701.08377 17652.7194   377%  3556  447s
   808   608 13262.3895   18  432 3701.08377 17652.7194   377%  3488  455s
   872   615 13074.5012   19  431 3701.08377 17652.7194   377%  3364  463s
   913   659 12909.6168   20  415 3701.08377 17652.7194   377%  3306  472s
   978   685 12584.1795   20  413 3701.08377 17296.5701   367%  3234  481s
  1031   747 12924.1034   21  416 3701.08377 17296.5701   367%  3186  489s
  1115   794 7675.31303   22  157 3701.08377 17296.5701   367%  3071  500s
  1211   848 12590.2752   23  411 3701.08377 17296.5701   367%  2924  510s
  1324   941 12326.0232   24  408 3701.08377 17296.5701   367%  2785  519s
  1449  1026 11872.9147   27  372 3701.08377 17296.5701   367%  2659  530s
  1591  1141 11859.5372   31  313 3701.08377 17296.5701   367%  2535  539s
  1760  1266 11804.9922   32  312 3701.08377 17018.8547   360%  2394  550s
  1951  1415 6468.61142   37  142 3701.08377 17018.8547   360%  2269  562s
  2152  1552 11209.0054   38  242 3701.08377 17018.8547   360%  2151  573s
  2359  1582 10820.4837   40  295 3701.08377 17018.8547   360%  2056  587s
  2532  1653 10771.3248   41  235 3701.08377 17018.8547   360%  2009  599s
  2687  1758 10445.2156   42  279 3701.08377 17018.8547   360%  1980  614s
  2846  1864 10604.8946   42  286 3701.08377 17018.8547   360%  1955  627s
  3024  1976 10251.3420   44  283 3701.08377 17018.8547   360%  1933  640s
  3213  2150 9308.86880   46  275 3701.08377 17018.8547   360%  1914  651s
  3425  2233 8049.17154   59  268 3701.08377 15151.0825   309%  1881  664s
  3562  2351 7882.77005   60  210 3701.08377 15151.0825   309%  1849  678s
  3739  2352 12721.6757   21  510 3701.08377 15151.0825   309%  1822  733s
  3741  2353 7419.14894   77  118 3701.08377 15151.0825   309%  1821  764s
  3742  2354 10243.7525   49  357 3701.08377 15151.0825   309%  1821  784s
  3743  2355 5747.69246   15  431 3701.08377 15151.0825   309%  1820  798s
  3744  2355 9032.59384   43  454 3701.08377 15151.0825   309%  1820  810s
  3745  2356 11999.0412   12  451 3701.08377 15151.0825   309%  1819  824s
  3746  2357 6086.60112  102  477 3701.08377 15151.0825   309%  1819  833s
  3747  2357 5245.58959   29  453 3701.08377 15151.0825   309%  1818  838s
  3748  2358 4365.29338   25  494 3701.08377 15151.0825   309%  1818  844s
  3749  2359 4652.78138   49  435 3701.08377 15151.0825   309%  1818  848s
  3750  2359 5133.44901   50  410 3701.08377 15151.0825   309%  1817  853s
  3751  2360 12950.4800    7  420 3701.08377 15151.0825   309%  1817  857s
  3752  2361 6173.37920   13  487 3701.08377 15151.0825   309%  1816  866s
  3754  2362 5490.65627   40  512 3701.08377 15151.0825   309%  1815  873s
  3755  2363 4586.36092   27  499 3701.08377 15151.0825   309%  1815  881s
  3756  2363 8090.86422    9  445 3701.08377 15151.0825   309%  1814  886s
  3757  2364 10353.4851   15  496 3701.08377 15151.0825   309%  1814  893s
  3758  2365 7432.50817   12  495 3701.08377 15151.0825   309%  1813  896s
  3759  2365 10458.0039   44  486 3701.08377 15151.0825   309%  1813  902s
  3760  2366 11141.3458   39  502 3701.08377 15151.0825   309%  1812  906s
  3761  2367 5208.71976   18  501 3701.08377 15151.0825   309%  1812  914s
  3762  2367 4352.91926   26  503 3701.08377 15151.0825   309%  1811  918s
  3763  2368 12337.6495   24  504 3701.08377 15151.0825   309%  1811  924s
  3764  2369 13097.7098   15  512 3701.08377 15151.0825   309%  1810  927s
  3765  2369 9022.82822   44  514 3701.08377 15151.0825   309%  1810  931s
  3766  2370 7016.05076   20  514 3701.08377 15151.0825   309%  1809  960s
  3767  2371 5799.50619   95  514 3701.08377 15151.0825   309%  1809  988s
  3768  2374 15151.0825   11  501 3701.08377 15151.0825   309%  1876 1011s
  3770  2378 15151.0825   12  488 3701.08377 15151.0825   309%  1880 1028s
  3774  2384 15151.0825   13  501 3701.08377 15151.0825   309%  1885 1052s
  3782  2398 15151.0825   14  511 3701.08377 15151.0825   309%  1902 1075s
  3798  2411 13706.3934   15  273 3701.08377 15151.0825   309%  1971 1116s
  3817  2437 15151.0825   16  522 3701.08377 15151.0825   309%  2010 1140s
  3849  2497 15151.0825   17  479 3701.08377 15151.0825   309%  2059 1165s
  3920  2577 15151.0825   18  477 3701.08377 15151.0825   309%  2127 1184s
  4027  2615 15151.0825   19  409 3701.08377 15151.0825   309%  2163 1198s
  4108  2631 14098.3284   21  419 3701.08377 15151.0825   309%  2185 1211s
  4179  2620 11365.0109   29  268 3701.08377 15151.0825   309%  2209 1234s
  4229  2612 13277.9454   22  387 3701.08377 15151.0825   309%  2223 1252s
  4286  2593 13186.9426   23  370 3701.08377 15151.0825   309%  2258 1266s
  4333  2593 13086.8743   24  315 3701.08377 15151.0825   309%  2303 1288s
  4391  2592 6204.36228   25  188 3701.08377 15151.0825   309%  2335 1303s
  4435  2610 11641.8643   23  403 3701.08377 15151.0825   309%  2372 1316s
  4500  2608 11579.6193   24  410 3701.08377 15151.0825   309%  2403 1334s
  4540  2631 8238.40890   25  222 3701.08377 15151.0825   309%  2431 1347s
  4598  2660 7677.25023   26  270 3701.08377 15151.0825   309%  2462 1358s
  4687  2680 7673.27797   27  274 3701.08377 15151.0825   309%  2466 1371s
  4792  2677 7578.07351   28  306 3701.08377 15151.0825   309%  2459 1390s
H 4827  2546                    3708.7099722 15151.0825   309%  2473 1390s
  4852  2590 7444.42830   29  315 3708.70997 15151.0825   309%  2481 1405s
  4959  2586     cutoff   29      3708.70997 15151.0825   309%  2486 1418s
  5072  2586     cutoff   33      3708.70997 15151.0825   309%  2492 1432s
  5167  2592     cutoff   35      3708.70997 15151.0825   309%  2517 1446s
H 5209  2464                    3752.6388614 15151.0825   304%  2527 1446s
  5245  2504 5741.25039   19  334 3752.63886 15151.0825   304%  2546 1463s
  5334  2516 5231.19240   21  278 3752.63886 15151.0825   304%  2599 1478s
  5465  2524 4534.57341   23  400 3752.63886 15151.0825   304%  2609 1499s
  5580  2530 4143.53751   27  384 3752.63886 15151.0825   304%  2649 1516s
H 5666  2395                    4155.9114214 15151.0825   265%  2671 1516s
  5678  2413     cutoff   28      4155.91142 15151.0825   265%  2665 1536s
  5784  2428 11031.5435   29  368 4155.91142 15151.0825   265%  2701 1552s
H 5893  2313                    4201.9429507 15151.0825   261%  2749 1574s
H 5900  2214                    4244.5377518 15151.0825   257%  2752 1574s
H 5908  2119                    4267.5259575 15151.0825   255%  2758 1574s
  5966  2121 9555.32529   33  285 4267.52596 15151.0825   255%  2784 1592s
H 5982  2028                    4311.4982441 15151.0825   251%  2790 1592s
  6008  2039     cutoff   34      4311.49824 15151.0825   251%  2809 1613s
  6146  2030     cutoff   35      4311.49824 15151.0825   251%  2842 1637s
  6280  2018     cutoff   40      4311.49824 15151.0825   251%  2889 1660s
H 6420  1915                    4321.0763763 15151.0825   251%  2925 1682s
  6541  1924     cutoff   27      4321.07638 14509.1374   236%  2948 1707s
  6675  1948 9019.76363   21  480 4321.07638 14509.1374   236%  2981 1730s
  6815  1986 8785.78708   23  366 4321.07638 14509.1374   236%  3016 1753s
  7031  1960 7604.15450   28  242 4321.07638 14508.3899   236%  3032 1777s
H 7064  1870                    4328.3780706 13881.2567   221%  3036 1777s
H 7081  1789                    4388.5055959 13881.2567   216%  3045 1777s
  7147  1843 6648.16752   31  248 4388.50560 13881.2567   216%  3057 1809s
  7350  1881 11102.3326   23  440 4388.50560 13881.2567   216%  3094 1841s
  7577  1902 6240.87206   27  457 4388.50560 13881.2567   216%  3114 1869s
  7794  1856 5284.78268   31  188 4388.50560 13881.2567   216%  3135 1901s
  8021  1801     cutoff   30      4388.50560 12966.5438   195%  3159 1934s
H 8023  1797                    4435.4184726 12966.5438   192%  3161 1934s
  8213  1827 12114.7830   19  402 4435.41847 12927.8695   191%  3197 1963s
H 8216  1824                    4463.0923321 12927.8695   190%  3196 1963s
  8362  1828 11636.3481   20  311 4463.09233 12682.4769   184%  3219 1987s
  8417  1875 10892.7483   21  273 4463.09233 12646.2492   183%  3241 2014s
  8507  1971 10090.2912   23  303 4463.09233 12602.7845   182%  3272 2045s
  8768  2063 8758.33695   27  386 4463.09233 12597.1282   182%  3281 2082s
  9039  2165 7318.03960   33  240 4463.09233 12439.3461   179%  3303 2118s
  9368  2185     cutoff   22      4463.09233 12343.4506   177%  3326 2156s
  9565  2245 9380.58816   20  412 4463.09233 12222.3683   174%  3357 2191s
  9812  2312 9111.42316   21  388 4463.09233 12175.3995   173%  3392 2234s
 10097  2400 8455.91939   22  316 4463.09233 12077.9169   171%  3431 2274s
 10428  2540 5539.31978   24  347 4463.09233 11914.3105   167%  3469 2318s
 10808  2614 5327.23443   23  227 4463.09233 11802.5188   164%  3496 2359s
 11121  2665     cutoff   25      4463.09233 11651.6360   161%  3544 2404s
 11449  2699 6808.19667   22  321 4463.09233 11460.2879   157%  3587 2454s
 11810  2734     cutoff   27      4463.09233 11234.0566   152%  3629 2502s
 12208  2729     cutoff   34      4463.09233 11021.1368   147%  3661 2550s
 12658  2719 5886.62469   24  367 4463.09233 10809.0090   142%  3702 2603s
 13209  2698     cutoff   20      4463.09233 10598.2775   137%  3721 2656s
 13758  2633 5556.94699   24  187 4463.09233 10279.9384   130%  3741 2715s
 14401  2600 infeasible   24      4463.09233 10047.3315   125%  3744 2773s
 15054  2491 6401.25528   44  294 4463.09233 9620.24333   116%  3742 2830s
 15735  2369 5019.77754   25  451 4463.09233 9392.33138   110%  3726 2887s
 16558  2010 8025.38840   21  344 4463.09233 8906.12936   100%  3704 2948s
 17560  1557 5380.12900   26  232 4463.09233 8672.95666  94.3%  3654 3008s
 18732   929 5009.88092   39  263 4463.09233 7860.26410  76.1%  3578 3069s
 20364   891     cutoff   43      4463.09233 7220.56766  61.8%  3432 3118s
 23405  2178 4510.04885   64   54 4463.09233 5456.02708  22.2%  3049 3123s
*23745  2178              86    4465.7151110 5384.86287  20.6%  3006 3123s
 27341  3636 4494.02004   73   41 4465.71511 4772.58222  6.87%  2623 3132s
*28878  3594              89    4471.5291666 4766.32382  6.59%  2488 3132s
*29181  3337              94    4501.9469916 4766.32382  5.87%  2463 3132s
 32077  2817     cutoff   69      4501.94699 4661.55743  3.55%  2249 3186s
H32080  2630                    4508.8475721 4661.55743  3.39%  2249 3186s
H32128  2592                    4510.1354889 4661.55743  3.36%  2245 3186s
H32175  2276                    4521.6273748 4661.55743  3.09%  2242 3186s
 32203  1388 4523.81664   67   54 4521.62737 4661.55743  3.09%  2240 3193s
 37768  1338 4523.61843   65   22 4521.62737 4581.49720  1.32%  1922 3197s
 37859  1236     cutoff   63      4521.62737 4575.95484  1.20%  1917 3200s
 38868   446     cutoff   62      4521.62737 4574.02520  1.16%  1869 3205s

Cutting planes:
  Learned: 1
  Gomory: 4
  MIR: 1300
  Mixing: 5
  Flow cover: 3513
  RLT: 24
  Relax-and-lift: 265

Explored 40494 nodes (72984463 simplex iterations) in 3209.95 seconds (9219.74 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 4521.63 4521.63 4510.14 ... 4388.51

Optimal solution found (tolerance 1.00e-06)
Best objective 4.521627374753e+03, best bound 4.521627374753e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3209.97s
  Master Objective (UB) = 4521.63, θ = 127535.96
  Upper Bound (UB) = 4521.63

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 127535.96
  [DEBUG]   ✓ Scenario 0: θ = 127535.96 ≤ Q = 138210.86 (slack: 10674.90)
  [DEBUG]   ✓ Scenario 1: θ = 127535.96 ≤ Q = 127536.41 (slack: 0.46)
  [DEBUG]   ✓ Scenario 2: θ = 127535.96 ≤ Q = 127535.96 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 127535.96 ≤ Q = 130302.22 (slack: 2766.26)
  [DEBUG]   ✓ Scenario 4: θ = 127535.96 ≤ Q = 127535.96 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 127535.96 ≤ Q = 137873.98 (slack: 10338.02)
  [DEBUG]   ✓ Scenario 6: θ = 127535.96 ≤ Q = 127755.19 (slack: 219.23)
  [DEBUG]   ✓ Scenario 7: θ = 127535.96 ≤ Q = 139407.14 (slack: 11871.18)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x2af9d4d7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x2af9d4d7
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [8e-01, 2e+02]
Found heuristic solution: objective 1.198169e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6263023.3506
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.165738e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -116573.79    0  122 6263023.35 -116573.79   102%     -    0s
H    0     0                    -84686.01733 -116573.79  37.7%     -    0s
H    0     0                    -85320.93541 -116573.79  36.6%     -    0s
     0     0 -101861.42    0   79 -85320.935 -101861.42  19.4%     -    0s
H    0     0                    -100513.3916 -101843.55  1.32%     -    0s
H    0     0                    -100748.0010 -101843.55  1.09%     -    0s
     0     0 -101374.42    0   64 -100748.00 -101374.42  0.62%     -    0s
H    0     0                    -100761.6204 -101359.76  0.59%     -    0s
     0     0 -101064.64    0   50 -100761.62 -101064.64  0.30%     -    0s
     0     0 -101062.62    0   49 -100761.62 -101062.62  0.30%     -    0s
     0     0 -101056.83    0   46 -100761.62 -101056.83  0.29%     -    0s
     0     0 -101014.91    0   34 -100761.62 -101014.91  0.25%     -    0s
     0     0 -101011.65    0   32 -100761.62 -101011.65  0.25%     -    0s
     0     0 -100988.14    0   35 -100761.62 -100988.14  0.22%     -    0s
     0     0 -100973.90    0   33 -100761.62 -100973.90  0.21%     -    0s
     0     0 -100971.71    0   33 -100761.62 -100971.71  0.21%     -    0s
     0     0 -100802.61    0   12 -100761.62 -100802.61  0.04%     -    0s
     0     0 -100781.40    0    5 -100761.62 -100781.40  0.02%     -    0s
H    0     0                    -100771.2977 -100781.40  0.01%     -    0s
     0     0     cutoff    0      -100771.30 -100771.30  0.00%     -    0s

Cutting planes:
  Gomory: 2
  Implied bound: 1
  MIR: 1
  RLT: 1

Explored 1 nodes (632 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -100771 -100762 -100748 ... 1.19817e+13
No other solutions better than -100771

Optimal solution found (tolerance 1.00e-06)
Best objective -1.007712976776e+05, best bound -1.007712976776e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 114289.75
  Scenario: 33 demand increases, 27 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100771.30
  [DEBUG]   S×d_nominal = 215061.05
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 215061.05 + -100771.30 = 114289.75
  [DEBUG]   Current θ from Master = 127535.96
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13246.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -8724.58
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 3537.0026, Absolute Gap = 3537.0026, Relative Gap = 0.782241
  Not converged yet (gap = 3537.00 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 33 increases, 27 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394598 nonzeros
Model fingerprint: 0x8662e011
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 63630 rows and 25830 columns
Presolve time: 1.42s
Presolved: 75363 rows, 32590 columns, 469109 nonzeros
Variable types: 30331 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -362494.4633
Found heuristic solution: objective -209564.0980

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 75363 rows, 32590 columns, 469109 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32220   -1.4269400e+05   0.000000e+00   6.422897e+07      5s
   47908   -3.5023399e+04   0.000000e+00   3.517733e+08     10s
   60125    2.6949855e+03   0.000000e+00   1.284613e+10     15s
   68233    6.3011401e+03   0.000000e+00   1.311115e+07     20s
   75530    1.5083518e+04   0.000000e+00   2.359771e+06     25s
   84548    1.9099316e+04   0.000000e+00   9.272108e+06     30s
Concurrent spin time: 1.97s

Solved with dual simplex

Root relaxation: objective 3.194234e+04, 72952 iterations, 33.40 seconds (65.83 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 31942.3394    0  121 -209564.10 31942.3394   115%     -   35s
H    0     0                    -203032.3933 31942.3394   116%     -   35s
H    0     0                    -151979.1390 31942.3394   121%     -   35s
H    0     0                    -123373.6715 31942.3394   126%     -   35s
H    0     0                    -88195.99517 31942.3394   136%     -   35s
H    0     0                    -87698.04832 31942.3394   136%     -   35s
H    0     0                    -85539.80459 31942.3394   137%     -   35s
H    0     0                    -85202.53892 31942.3394   137%     -   35s
H    0     0                    -42602.60307 31942.3394   175%     -   35s
H    0     0                    -10325.71859 31942.3394   409%     -   36s
H    0     0                    -3029.180680 31942.3394  1154%     -   36s
H    0     0                    -933.1198117 31942.3394  3523%     -   36s
H    0     0                    -637.2578206 31942.3394  5112%     -   36s
H    0     0                    -583.7509842 31942.3394  5572%     -   36s
H    0     0                    -456.1578877 25823.6221  5761%     -   49s
H    0     0                    -453.1062471 25823.6221  5799%     -   49s
     0     0 25763.2259    0  212 -453.10625 25763.2259  5786%     -   49s
H    0     0                    -409.8927718 25763.2259  6385%     -   50s
     0     0 25384.9850    0  212 -409.89277 25384.9850  6293%     -   55s
     0     0 25384.9850    0  171 -409.89277 25384.9850  6293%     -   57s
     0     0 25384.9850    0  215 -409.89277 25384.9850  6293%     -   58s
     0     0 25384.9850    0  215 -409.89277 25384.9850  6293%     -   58s
     0     0 23831.5102    0  289 -409.89277 23831.5102  5914%     -   69s
H    0     0                    1765.2325228 23830.4911  1250%     -   69s
H    0     0                    1782.4620421 23830.4911  1237%     -   69s
H    0     0                    1839.7349305 23830.4911  1195%     -   69s
H    0     0                    2034.6446931 23830.4911  1071%     -   69s
H    0     0                    2111.1916768 23830.4911  1029%     -   69s
H    0     0                    2151.2912801 23830.4911  1008%     -   69s
H    0     0                    2212.5143231 23830.4911   977%     -   69s
H    0     0                    2290.0400854 23830.4911   941%     -   69s
     0     0 23307.8062    0  304 2290.04009 23307.8062   918%     -   75s
     0     0 23307.7508    0  304 2290.04009 23307.7508   918%     -   77s
     0     0 23307.7508    0  292 2290.04009 23307.7508   918%     -   79s
     0     0 23307.7508    0  302 2290.04009 23307.7508   918%     -   80s
     0     0 23137.1140    0  305 2290.04009 23137.1140   910%     -   82s
     0     0 23065.2221    0  323 2290.04009 23065.2221   907%     -   84s
     0     0 23051.7272    0  325 2290.04009 23051.7272   907%     -   86s
     0     0 22992.6618    0  322 2290.04009 22992.6618   904%     -   88s
     0     0 22934.1226    0  316 2290.04009 22934.1226   901%     -   89s
     0     0 22903.4072    0  321 2290.04009 22903.4072   900%     -   90s
     0     0 22902.2371    0  319 2290.04009 22902.2371   900%     -   91s
     0     0 22902.2156    0  325 2290.04009 22902.2156   900%     -   91s
     0     0 20258.9260    0  366 2290.04009 20258.9260   785%     -  120s
H    0     0                    2334.5246614 20258.8822   768%     -  120s
H    0     0                    2705.8741611 20258.8822   649%     -  120s
     0     0 20070.6321    0  422 2705.87416 20070.6321   642%     -  126s
     0     0 19996.4315    0  419 2705.87416 19996.4315   639%     -  130s
     0     0 19875.1103    0  441 2705.87416 19875.1103   635%     -  134s
H    0     0                    3167.2022599 19861.2547   527%     -  136s
H    0     0                    3181.2215939 19861.2547   524%     -  136s
H    0     0                    3246.6656994 19861.2547   512%     -  136s
H    0     0                    3318.6588979 19861.2547   498%     -  136s
H    0     0                    3368.6814721 19861.2547   490%     -  136s
     0     0 19861.2547    0  431 3368.68147 19861.2547   490%     -  136s
H    0     0                    3393.9814621 19813.3626   484%     -  139s
H    0     0                    3440.8900189 19813.3626   476%     -  139s
     0     0 19813.3626    0  435 3440.89002 19813.3626   476%     -  139s
     0     0 19791.2175    0  436 3440.89002 19791.2175   475%     -  142s
     0     0 19783.9295    0  440 3440.89002 19783.9295   475%     -  144s
     0     0 19783.2291    0  443 3440.89002 19783.2291   475%     -  144s
H    0     0                    3490.8177595 18981.7978   444%     -  163s
     0     0 18981.7978    0  477 3490.81776 18981.7978   444%     -  163s
H    0     0                    3504.1927655 18981.2738   442%     -  163s
     0     0 18834.3564    0  388 3504.19277 18834.3564   437%     -  168s
     0     0 18783.2152    0  471 3504.19277 18783.2152   436%     -  172s
     0     0 18761.7411    0  462 3504.19277 18761.7411   435%     -  174s
     0     0 18737.7045    0  462 3504.19277 18737.7045   435%     -  176s
H    0     0                    3549.5811227 18731.2327   428%     -  178s
     0     0 18731.2327    0  477 3549.58112 18731.2327   428%     -  178s
     0     0 18729.0875    0  476 3549.58112 18729.0875   428%     -  179s
     0     0 18728.0439    0  480 3549.58112 18728.0439   428%     -  179s
     0     0 18611.4432    0  480 3549.58112 18611.4432   424%     -  186s
     0     0 18557.1379    0  498 3549.58112 18557.1379   423%     -  192s
     0     0 18539.2670    0  492 3549.58112 18539.2670   422%     -  194s
     0     0 18523.3193    0  504 3549.58112 18523.3193   422%     -  196s
     0     0 18518.4260    0  500 3549.58112 18518.4260   422%     -  197s
     0     0 18515.6975    0  505 3549.58112 18515.6975   422%     -  198s
     0     0 18504.7422    0  500 3549.58112 18504.7422   421%     -  199s
     0     0 18502.7200    0  502 3549.58112 18502.7200   421%     -  200s
     0     0 18501.5848    0  504 3549.58112 18501.5848   421%     -  200s
     0     0 18436.6533    0  491 3549.58112 18436.6533   419%     -  205s
H    0     0                    3733.3524303 18436.4777   394%     -  206s
     0     0 18426.5927    0  493 3733.35243 18426.5927   394%     -  208s
     0     0 18422.4069    0  498 3733.35243 18422.4069   393%     -  210s
     0     0 18419.9011    0  489 3733.35243 18419.9011   393%     -  211s
     0     0 18419.2716    0  491 3733.35243 18419.2716   393%     -  211s
     0     0 18396.6703    0  491 3733.35243 18396.6703   393%     -  215s
     0     0 18387.7099    0  497 3733.35243 18387.7099   393%     -  218s
     0     0 18386.1626    0  499 3733.35243 18386.1626   392%     -  219s
     0     0 18374.3992    0  505 3733.35243 18374.3992   392%     -  222s
     0     0 18363.1802    0  509 3733.35243 18363.1802   392%     -  226s
     0     0 18360.1256    0  506 3733.35243 18360.1256   392%     -  227s
     0     0 18359.0926    0  507 3733.35243 18359.0926   392%     -  228s
     0     0 18348.0596    0  510 3733.35243 18348.0596   391%     -  230s
     0     0 18346.9752    0  514 3733.35243 18346.9752   391%     -  231s
     0     0 18344.7813    0  516 3733.35243 18344.7813   391%     -  234s
     0     0 18343.2401    0  554 3733.35243 18343.2401   391%     -  236s
     0     0 18341.1533    0  523 3733.35243 18341.1533   391%     -  238s
     0     0 18340.1218    0  516 3733.35243 18340.1218   391%     -  239s
     0     0 18336.0209    0  550 3733.35243 18336.0209   391%     -  243s
     0     0 18335.9574    0  550 3733.35243 18335.9574   391%     -  245s
     0     2 18335.1759    0  550 3733.35243 18335.1759   391%     -  290s
     1     4 18237.5408    1  525 3733.35243 18335.1759   391%  4151  296s
     3     8 18024.3945    2  461 3733.35243 18235.2340   388%  6378  305s
     7    16 17820.4876    3  512 3733.35243 18024.3889   383%  7424  314s
    15    32 17577.2998    4  513 3733.35243 17819.6723   377%  7650  324s
    31    52 15968.2451    5  310 3733.35243 17577.2981   371% 10375  354s
    51    84 16935.3513    6  415 3733.35243 17577.2891   371%  9793  376s
H   59    84                    3737.7567848 17577.2891   370%  9287  376s
    83   213 16923.4677    7  416 3737.75678 17577.2891   370%  7965  394s
   212   287 16626.9217   12  458 3737.75678 17577.2891   370%  5062  404s
H  221   287                    3747.2456361 17577.2891   369%  5040  404s
   286   376 15692.2535   10  290 3747.24564 17577.2891   369%  4727  413s
   375   407 15648.2129   11  292 3747.24564 17577.2891   369%  4328  421s
   406   443 15388.8738   12  292 3747.24564 17577.2891   369%  4287  429s
   442   482 16565.8786   13  456 3747.24564 17577.2891   369%  4210  436s
   481   519 15471.2316   13  295 3747.24564 17577.2891   369%  4203  443s
H  517   519                    3747.6758410 17577.2891   369%  4203  443s
   522   609 16319.0204   14  506 3747.67584 17577.2891   369%  4205  450s
   618   673 16285.9215   15  460 3747.67584 17577.2891   369%  4065  458s
   692   720 16149.6043   16  388 3747.67584 17577.2891   369%  4136  465s
   772   796 9111.08935   32   74 3747.67584 17577.2891   369%  4041  474s
   862   853 15065.4412   16  272 3747.67584 17577.2891   369%  3923  481s
   957   869     cutoff   39      3747.67584 17577.2891   369%  3832  491s
  1044   862 6485.03226   37   42 3747.67584 17577.2891   369%  3819  501s
  1110   875 10526.0550   17  269 3747.67584 17577.2891   369%  3868  511s
  1183   919 14964.2063   17  287 3747.67584 17577.2891   369%  3928  521s
  1264   971 12226.6361   19  247 3747.67584 17577.2891   369%  3971  531s
  1358  1010 7916.55527   18  265 3747.67584 17577.2891   369%  3985  542s
  1439  1062 8502.31517   20  207 3747.67584 17577.2891   369%  3988  554s
  1526  1084 7812.10942   21  177 3747.67584 17577.2891   369%  4018  565s
  1564  1119 5362.13436   22  232 3747.67584 17577.2891   369%  4091  576s
H 1621  1145                    3750.0820839 17577.2891   369%  4149  587s
  1693  1177 infeasible   22      3750.08208 17577.2891   369%  4154  600s
  1788  1197 6790.36337   17  233 3750.08208 17577.2891   369%  4151  611s
H 1789  1197                    3846.4252769 17577.2891   357%  4149  611s
H 1804  1197                    3850.3652704 17577.2891   357%  4178  611s
  1820  1252 6047.60512   18  202 3850.36527 17577.2891   357%  4190  624s
  1950  1294 5311.66857   27  158 3850.36527 17577.2891   357%  4138  637s
  2063  1323     cutoff   32      3850.36527 17577.2891   357%  4134  651s
H 2101  1323                    3901.7312747 17577.2891   350%  4122  651s
  2140  1408 7951.14076   17  266 3901.73127 17577.2891   350%  4120  665s
  2280  1496 6975.31099   19  234 3901.73127 17577.2891   350%  4099  679s
  2422  1571 3990.32345   24  149 3901.73127 17577.2891   350%  4092  695s
  2571  1665 10732.2467   27  332 3901.73127 17577.2891   350%  4083  710s
  2756  1802 9688.84268   40  201 3901.73127 17577.2891   350%  4029  725s
  2950  1902 4581.94207   57   77 3901.73127 17577.2891   350%  3996  743s
  3106  1920     cutoff   37      3901.73127 17389.5944   346%  3982  757s
  3154  1943 17304.1085    6  396 3901.73127 17389.5898   346%  4004  767s
  3195  2001 17257.1703    7  403 3901.73127 17389.5898   346%  4014  781s
  3271  2119 15772.0540    9  313 3901.73127 17389.5898   346%  4016  798s
  3435  2154 14065.3141   10  295 3901.73127 17389.5898   346%  3944  814s
  3511  2251 9408.91526   12  306 3901.73127 17303.4214   343%  3961  831s
  3678  2422 6024.84553   13  211 3901.73127 17242.9479   342%  3965  849s
  3946  2423 6701.83521   22  550 3901.73127 16621.3317   326%  3878  941s
  3948  2424 8923.32574   35  121 3901.73127 16621.3317   326%  3876  979s
  3949  2425 5754.61700   21  355 3901.73127 16621.3317   326%  3875 1015s
  3950  2426 4446.54599   38  314 3901.73127 16621.3317   326%  3874 1034s
  3951  2426 10912.7780   39  456 3901.73127 16621.3317   326%  3873 1052s
  3952  2427 7900.75217   18  459 3901.73127 16621.3317   326%  3872 1065s
  3953  2428 4176.38320   17  517 3901.73127 16621.3317   326%  3871 1072s
  3954  2428 9730.52151    9  410 3901.73127 16621.3317   326%  3870 1080s
  3955  2429 16403.8522    7  525 3901.73127 16621.3317   326%  3869 1092s
  3956  2430 10462.4093   31  493 3901.73127 16621.3317   326%  3868 1095s
  3957  2430 5984.13710   23  527 3901.73127 16621.3317   326%  3867 1102s
  3958  2431 8699.03326    9  527 3901.73127 16621.3317   326%  3866 1106s
  3960  2432 7577.77249   38  553 3901.73127 16621.3317   326%  3864 1111s
  3962  2434 5030.26408   53  427 3901.73127 16621.3317   326%  3862 1125s
  3963  2434 15300.9211    6  476 3901.73127 16621.3317   326%  3861 1130s
  3964  2435 5213.01441   24  492 3901.73127 16621.3317   326%  3860 1135s
  3965  2436 11694.8418   20  471 3901.73127 16621.3317   326%  3859 1142s
  3967  2437 13711.8221   12  422 3901.73127 16621.3317   326%  3857 1150s
  3969  2438 7382.75870   29  415 3901.73127 16621.3317   326%  3855 1156s
  3970  2439 7909.87690   13  478 3901.73127 16621.3317   326%  3854 1160s
  3972  2440 4682.46238   29  360 3901.73127 16621.3317   326%  3853 1167s
  3973  2441 10317.4959   26  410 3901.73127 16621.3317   326%  3852 1170s
  3975  2442 4757.46567   26  373 3901.73127 16621.3317   326%  3850 1176s
  3977  2444 6736.94537   21  380 3901.73127 16621.3317   326%  3848 1181s
  3978  2444 6701.83521   22  475 3901.73127 16621.3317   326%  3847 1186s
  3980  2446 13662.5461   10  470 3901.73127 16621.3317   326%  3845 1192s
  3981  2446 11034.7701   10  470 3901.73127 16621.3317   326%  3844 1226s
  3982  2447 12561.9289   13  470 3901.73127 16621.3317   326%  3843 1256s
  3983  2450 16621.3317   15  306 3901.73127 16621.3317   326%  3912 1279s
  3984  2452 16586.8705   16  302 3901.73127 16621.3317   326%  3912 1294s
  3987  2457 15141.2284   17  303 3901.73127 16621.3317   326%  3915 1312s
  3993  2467 15123.9700   18  293 3901.73127 16621.3317   326%  3924 1340s
  4005  2475 16578.6724   18  451 3901.73127 16621.3317   326%  3937 1377s
  4017  2503 15089.6806   19  387 3901.73127 16621.3317   326%  3988 1441s
  4049  2595 14866.7704   20  449 3901.73127 16621.3317   326%  4126 1475s
  4156  2617 13235.4838   22  279 3901.73127 16621.3317   326%  4150 1493s
  4228  2647 14649.0994   22  428 3901.73127 16621.3317   326%  4142 1509s
  4320  2630 12950.7872   26  264 3901.73127 16621.3317   326%  4111 1528s
  4356  2626 14559.2703   23  415 3901.73127 16621.3317   326%  4113 1543s
  4423  2623 13386.5138   25  409 3901.73127 16621.3317   326%  4105 1559s
  4456  2613 6476.93939   26  239 3901.73127 16621.3317   326%  4106 1574s
  4507  2620 11102.6782   25  325 3901.73127 16621.3317   326%  4102 1596s
  4561  2627 4992.95402   27  244 3901.73127 16621.3317   326%  4101 1609s
  4608  2624     cutoff   28      3901.73127 16621.3317   326%  4113 1622s
  4657  2632 4110.54035   28  222 3901.73127 16621.3317   326%  4111 1636s
  4709  2630 4678.41618   28  231 3901.73127 16621.3317   326%  4107 1649s
  4760  2655 infeasible   30      3901.73127 16621.3317   326%  4101 1667s
  4834  2666 7159.75136   23  303 3901.73127 16380.5537   320%  4084 1682s
  4921  2656 7195.22495   25  377 3901.73127 16380.5537   320%  4056 1701s
  4985  2648 6844.61535   24  352 3901.73127 15791.5741   305%  4047 1724s
  5022  2651 6692.65041   25  345 3901.73127 15791.5741   305%  4050 1737s
  5058  2656 6586.58234   26  297 3901.73127 15791.5741   305%  4051 1750s
H 5069  2530                    3971.9635399 15791.5741   298%  4052 1750s
  5093  2540 5314.79885   27  276 3971.96354 15791.5741   298%  4051 1764s
  5188  2520 4307.35573   29  229 3971.96354 15791.5741   298%  4034 1784s
  5277  2491     cutoff   29      3971.96354 15533.6280   291%  4025 1802s
H 5285  2372                    4104.3544224 15523.4269   278%  4025 1802s
  5346  2369 7148.06610   21  311 4104.35442 15523.4269   278%  4024 1819s
  5426  2344 6348.00369   23  353 4104.35442 15523.4269   278%  4028 1838s
  5492  2323 infeasible   24      4104.35442 15523.4269   278%  4032 1859s
H 5494  2211                    4105.6138465 15523.4269   278%  4031 1859s
H 5495  2105                    4112.4884521 15523.4269   277%  4032 1859s
H 5498  2004                    4141.9915896 15523.4269   275%  4033 1859s
  5538  2032 5647.41932   21  417 4141.99159 15523.4269   275%  4043 1880s
  5621  2027 5436.31676   22  353 4141.99159 15523.4269   275%  4054 1901s
H 5674  1914                    4181.1990156 15523.4269   271%  4047 1901s
  5696  1939 5064.59847   23  345 4181.19902 15523.4269   271%  4051 1923s
  5819  1927     cutoff   26      4181.19902 14990.1309   259%  4035 1947s
  5941  1898     cutoff   22      4181.19902 14791.1614   254%  4026 1972s
H 5969  1799                    4228.4979563 14791.1614   250%  4035 1972s
H 5981  1709                    4287.1775168 14791.1614   245%  4035 1972s
H 5989  1624                    4289.5255408 14791.1614   245%  4033 1972s
H 6016  1538                    4301.1453159 14791.1614   244%  4025 1972s
  6039  1560 5237.94542   23  281 4301.14532 14791.1614   244%  4019 1996s
  6147  1537 9145.45789   27  430 4301.14532 14791.1614   244%  4024 2019s
  6220  1532 8082.11834   28  390 4301.14532 14791.1614   244%  4035 2047s
  6328  1501 infeasible   33      4301.14532 14791.1614   244%  4050 2073s
H 6354  1418                    4305.2669780 14267.9751   231%  4050 2073s
  6381  1457 5002.20207   33  232 4305.26698 14267.9751   231%  4055 2100s
  6492  1446 infeasible   28      4305.26698 13391.9846   211%  4066 2132s
  6641  1453     cutoff   23      4305.26698 13065.7916   203%  4062 2159s
  6797  1461     cutoff   24      4305.26698 12904.3985   200%  4056 2189s
  7007  1428 9869.07253   24  410 4305.26698 12564.6600   192%  4014 2222s
  7170  1370 8957.54182   26  308 4305.26698 12564.6600   192%  4011 2257s
  7297  1354 8210.67579   28  360 4305.26698 12449.7428   189%  4033 2291s
  7402  1328 5588.02417   32  242 4305.26698 12220.1384   184%  4047 2322s
  7450  1338     cutoff   34      4305.26698 11926.0424   177%  4066 2351s
  7565  1291     cutoff   25      4305.26698 11685.4881   171%  4076 2388s
  7709  1247     cutoff   23      4305.26698 11298.9084   162%  4104 2428s
  7831  1214 4586.43037   28  207 4305.26698 11097.8025   158%  4142 2461s
  7883  1198     cutoff   28      4305.26698 11097.8025   158%  4168 2495s
  7978  1158 5296.02951   36  205 4305.26698 11097.8025   158%  4187 2534s
H 7992  1104                    4313.3054617 11097.8025   157%  4190 2534s
H 8003  1104                    4319.0856265 11097.8025   157%  4196 2534s
H 8004  1104                    4323.7600248 11097.8025   157%  4195 2534s
  8033  1079 5088.31638   37  169 4323.76002 11097.8025   157%  4205 2576s
  8236  1060 4365.55411   22  469 4323.76002 11097.8025   157%  4232 2621s
  8426  1027     cutoff   26      4323.76002 10694.7811   147%  4258 2669s
  8646   986 infeasible   27      4323.76002 10625.7208   146%  4273 2722s
  8842   966 5336.12234   28  405 4323.76002 10512.8397   143%  4308 2772s
  9087   921 infeasible   28      4323.76002 9669.69576   124%  4329 2818s
  9337   892 4520.58482   30  294 4323.76002 9436.14086   118%  4333 2874s
  9572   858 infeasible   32      4323.76002 9067.27952   110%  4365 2921s
H 9575   858                    4325.4748279 9067.27952   110%  4363 2921s
H 9622   858                    4338.7860996 8505.06141  96.0%  4370 2921s
  9662   787 4717.25430   33  265 4338.78610 8423.41595  94.1%  4378 2978s
  9926   659 4671.60680   27  225 4338.78610 8021.26950  84.9%  4417 3030s
 10325   456 infeasible   25      4338.78610 7183.82680  65.6%  4410 3086s
 10940   594 4636.67270   47   86 4338.78610 6704.33038  54.5%  4331 3131s
 12152   931 4444.79614   54   67 4338.78610 5974.76149  37.7%  3982 3140s
 15800  1324     cutoff   52      4338.78610 4526.11240  4.32%  3096 3148s
 18168  1229 4360.79287   59   49 4338.78610 4446.75838  2.49%  2706 3154s
 21016  1316 4384.40901   57   51 4338.78610 4410.80910  1.66%  2354 3161s
*22050  1316              94    4347.2862091 4405.52656  1.34%  2248 3161s
 24437   508     cutoff   71      4347.28621 4381.34559  0.78%  2039 3168s
 25997     0 4366.04652   62   33 4347.28621 4377.50726  0.70%  1924 3172s

Cutting planes:
  Gomory: 4
  MIR: 1184
  Flow cover: 2688
  RLT: 16
  Relax-and-lift: 233

Explored 26696 nodes (50391379 simplex iterations) in 3172.95 seconds (8805.08 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 4347.29 4338.79 4325.47 ... 4287.18

Optimal solution found (tolerance 1.00e-06)
Best objective 4.347286209143e+03, best bound 4.347286209143e+03, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 0) = 1.0000
  [DEBUG-MASTER]   beta(1, 0) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3173.00s
  Master Objective (UB) = 4347.29, θ = 128212.38
  Upper Bound (UB) = 4347.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 128212.38
  [DEBUG]   ✓ Scenario 0: θ = 128212.38 ≤ Q = 128212.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 128212.38 ≤ Q = 128212.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 128212.38 ≤ Q = 128212.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 128212.38 ≤ Q = 128212.38 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 128212.38 ≤ Q = 128212.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 128212.38 ≤ Q = 128212.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 128212.38 ≤ Q = 128212.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 128212.38 ≤ Q = 128212.38 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 128212.38 ≤ Q = 128212.38 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3a421066
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc5bdef9a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [4e-15, 2e+02]
Found heuristic solution: objective 1.199663e+13
Presolve removed 2601 rows and 1894 columns
Presolve time: 0.00s
Presolved: 492 rows, 495 columns, 1387 nonzeros
Found heuristic solution: objective 6312564.3020
Variable types: 335 continuous, 160 integer (160 binary)

Root relaxation: objective -1.157960e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -115796.04    0  122 6312564.30 -115796.04   102%     -    0s
H    0     0                    -83841.42268 -115796.04  38.1%     -    0s
H    0     0                    -84670.84910 -115796.04  36.8%     -    0s
     0     0 -99124.788    0   92 -84670.849 -99124.788  17.1%     -    0s
H    0     0                    -96964.46268 -99036.959  2.14%     -    0s
     0     0 -98252.073    0   87 -96964.463 -98252.073  1.33%     -    0s
H    0     0                    -97618.10354 -98227.993  0.62%     -    0s
     0     0 -98213.566    0   83 -97618.104 -98213.566  0.61%     -    0s
     0     0 -98213.534    0   83 -97618.104 -98213.534  0.61%     -    0s
     0     0 -97933.682    0   35 -97618.104 -97933.682  0.32%     -    0s
     0     0 -97933.429    0   34 -97618.104 -97933.429  0.32%     -    0s
     0     0 -97810.279    0   30 -97618.104 -97810.279  0.20%     -    0s
     0     0 -97808.978    0   18 -97618.104 -97808.978  0.20%     -    0s
     0     0 -97807.945    0   18 -97618.104 -97807.945  0.19%     -    0s
     0     0 -97713.687    0   12 -97618.104 -97713.687  0.10%     -    0s
     0     0 -97705.293    0   18 -97618.104 -97705.293  0.09%     -    0s
     0     0     cutoff    0      -97618.104 -97618.104  0.00%     -    0s

Cutting planes:
  Gomory: 11
  Implied bound: 5
  MIR: 3
  Flow cover: 12
  RLT: 1
  Relax-and-lift: 9

Explored 1 nodes (783 simplex iterations) in 0.11 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 7: -97618.1 -97139 -96964.5 ... 1.19966e+13
No other solutions better than -97618.1

Optimal solution found (tolerance 1.00e-06)
Best objective -9.761810354362e+04, best bound -9.761810354362e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 117314.11
  Scenario: 40 demand increases, 20 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -97618.10
  [DEBUG]   S×d_nominal = 214932.21
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 214932.21 + -97618.10 = 117314.11
  [DEBUG]   Current θ from Master = 128212.38
  [DEBUG]   ⚠️  Z_SP ≤ θ by 10898.28 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -6550.99
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 3362.6614, Absolute Gap = 3362.6614, Relative Gap = 0.773508
  Not converged yet (gap = 3362.66 > ε = 200)

  [DEBUG] Adding NEW scenario 9 to Master Problem...
  [DEBUG] New scenario pattern: 40 increases, 20 decreases
    [DEBUG] Scenario 9 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 9 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 9]
    [DEBUG]   - Total constraints in model: 154283
    [DEBUG]   - Total variables in model: 64660
  [DEBUG] Total scenarios in Master: 10
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 10
================================================================================
[Iteration 10] Solving Master Problem...
  Current scenarios in Master: 10
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 154283 rows, 64660 columns and 437829 nonzeros
Model fingerprint: 0xebc34eae
Variable types: 62401 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 70700 rows and 28700 columns
Presolve time: 1.20s
Presolved: 83583 rows, 35960 columns, 511929 nonzeros
Variable types: 33701 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -364152.5596
Found heuristic solution: objective -209564.0980

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.16s

Barrier statistics:
 Dense cols : 500
 AA' NZ     : 3.509e+06
 Factor NZ  : 7.538e+06 (roughly 100 MB of memory)
 Factor Ops : 1.260e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.61260689e+07  1.44597419e+08  8.99e+04 1.92e+01  7.25e+04     2s
   1  -1.22125791e+07  1.28140995e+08  6.30e+04 6.17e+01  5.02e+04     2s
   2  -5.76496359e+06  9.87024316e+07  2.85e+04 7.90e-12  2.37e+04     2s
   3  -9.53332343e+05  7.36971901e+07  2.51e+03 7.67e-01  2.46e+03     2s
   4  -4.93654488e+05  2.52373446e+07  4.15e+02 1.57e-01  4.51e+02     3s
   5  -3.94916070e+05  1.71341485e+07  2.13e+02 8.46e-02  2.49e+02     3s
   6  -2.86863073e+05  1.22661230e+07  7.68e+01 5.57e-02  1.26e+02     3s
   7  -1.78880393e+05  9.78340346e+06  3.02e+01 4.21e-02  8.04e+01     3s
   8  -1.34261501e+05  7.41351692e+06  1.80e+01 3.03e-02  5.68e+01     3s
   9  -1.03583968e+05  4.79535873e+06  9.31e+00 1.90e-02  3.47e+01     3s
  10  -8.25002878e+04  2.02830615e+06  4.18e+00 7.41e-03  1.44e+01     3s
  11  -4.81170352e+04  5.08064967e+05  1.17e+00 1.77e-03  3.68e+00     3s
  12  -3.34565167e+04  2.93993879e+05  8.81e-01 1.07e-03  2.16e+00     3s
  13  -2.39801206e+04  1.99937892e+05  6.96e-01 9.02e-04  1.48e+00     3s
  14  -1.61566550e+04  1.65698339e+05  5.59e-01 1.08e-03  1.20e+00     3s
  15  -9.84546699e+03  1.44495740e+05  4.57e-01 1.31e-03  1.01e+00     3s
  16  -1.78468104e+03  1.11426817e+05  3.40e-01 9.47e-04  7.43e-01     3s
  17   3.35804642e+03  8.01515975e+04  2.85e-01 2.51e-03  5.04e-01     3s
  18   1.03700548e+04  7.04792305e+04  2.13e-01 2.83e-03  3.94e-01     3s
  19   1.38783200e+04  6.35940496e+04  1.76e-01 2.84e-03  3.26e-01     3s
  20   1.78645295e+04  5.62968289e+04  1.39e-01 3.08e-03  2.52e-01     3s
  21   1.98649118e+04  5.04292065e+04  1.21e-01 2.44e-03  2.01e-01     3s
  22   2.33300119e+04  4.71085112e+04  9.03e-02 1.84e-03  1.56e-01     3s
  23   2.49862350e+04  4.30317669e+04  7.64e-02 1.59e-03  1.18e-01     3s
  24   2.66415548e+04  4.19143981e+04  6.40e-02 1.34e-03  1.00e-01     3s
  25   2.75903446e+04  4.02000661e+04  5.71e-02 1.26e-03  8.28e-02     3s
  26   2.80124091e+04  3.93775318e+04  5.37e-02 8.90e-04  7.47e-02     3s
  27   2.87503773e+04  3.89157087e+04  4.84e-02 9.61e-04  6.68e-02     3s
  28   3.04565678e+04  3.80270023e+04  3.63e-02 1.02e-03  4.97e-02     4s
  29   3.13578637e+04  3.78704444e+04  2.98e-02 9.34e-04  4.28e-02     4s
  30   3.21312567e+04  3.73877247e+04  2.44e-02 9.73e-04  3.45e-02     4s
  31   3.31093825e+04  3.69297447e+04  1.74e-02 1.38e-03  2.51e-02     4s
  32   3.35242318e+04  3.67380630e+04  1.45e-02 1.09e-03  2.11e-02     4s
  33   3.38653585e+04  3.66291924e+04  1.22e-02 9.65e-04  1.81e-02     4s
  34   3.44994703e+04  3.64211342e+04  7.91e-03 7.41e-04  1.26e-02     4s
  35   3.50305978e+04  3.62307378e+04  4.46e-03 5.45e-04  7.87e-03     4s
  36   3.52314054e+04  3.59019532e+04  3.19e-03 1.01e-04  4.41e-03     4s
  37   3.54868382e+04  3.58569666e+04  1.62e-03 7.81e-05  2.43e-03     4s
  38   3.54918505e+04  3.58403004e+04  1.58e-03 6.38e-05  2.29e-03     4s
  39   3.55585930e+04  3.58314758e+04  1.20e-03 5.63e-05  1.79e-03     4s
  40   3.56064226e+04  3.58209291e+04  9.09e-04 4.64e-05  1.41e-03     4s
  41   3.56950084e+04  3.58027229e+04  3.95e-04 2.96e-05  7.06e-04     4s
  42   3.57238729e+04  3.57770023e+04  2.31e-04 1.35e-05  3.49e-04     4s
  43   3.57395377e+04  3.57719766e+04  1.43e-04 1.16e-05  2.13e-04     4s
  44   3.57590126e+04  3.57708832e+04  3.88e-05 1.13e-05  7.78e-05     4s
  45   3.57648533e+04  3.57679042e+04  9.60e-06 2.27e-06  2.00e-05     4s
  46   3.57668368e+04  3.57670740e+04  7.92e-07 7.09e-07  1.55e-06     4s
  47   3.57670346e+04  3.57670360e+04  1.70e-09 1.59e-08  9.64e-09     4s
  48   3.57670352e+04  3.57670352e+04  3.69e-10 1.30e-09  2.84e-11     4s

Barrier solved model in 48 iterations and 4.49 seconds (6.93 work units)
Optimal objective 3.57670352e+04


Root crossover log...

       0 DPushes remaining with DInf 0.0000000e+00                 6s

    1004 PPushes remaining with PInf 8.2652163e-07                 6s
       0 PPushes remaining with PInf 0.0000000e+00                 6s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.8088495e-10      6s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31717    3.5767035e+04   0.000000e+00   0.000000e+00      6s
   31717    3.5767035e+04   0.000000e+00   0.000000e+00      6s
Concurrent spin time: 0.01s

Solved with barrier

Root relaxation: objective 3.576704e+04, 31717 iterations, 4.23 seconds (7.56 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 35767.0352    0  196 -209564.10 35767.0352   117%     -    6s
H    0     0                    -206174.0205 35767.0352   117%     -    6s
H    0     0                    -70762.16488 35767.0352   151%     -    6s
H    0     0                    -70493.60530 35767.0352   151%     -    6s
H    0     0                    -48811.79334 35767.0352   173%     -    6s
H    0     0                    -21175.24479 35767.0352   269%     -    6s
H    0     0                    -20889.59185 35767.0352   271%     -    6s
H    0     0                    -15047.36615 35767.0352   338%     -    6s
H    0     0                    -3606.764324 35767.0352  1092%     -    6s
H    0     0                    -3490.318230 35767.0352  1125%     -    9s
H    0     0                    -1365.249497 35767.0352  2720%     -   11s
H    0     0                    -448.4849000 35767.0352  8075%     -   11s
H    0     0                    -430.8428521 35767.0352  8402%     -   11s
H    0     0                    -190.8511906 35767.0352      -     -   11s
H    0     0                     -37.0407975 35767.0352      -     -   11s
H    0     0                       3.5711725 35767.0352      -     -   11s
H    0     0                      64.0570943 35767.0352      -     -   11s
H    0     0                     105.9865820 35767.0352      -     -   11s
H    0     0                     111.9368423 30426.5810      -     -   30s
H    0     0                     180.7717724 30426.5810      -     -   30s
H    0     0                     581.8082521 30426.5810  5130%     -   30s
H    0     0                     590.9047398 30426.5810  5049%     -   30s
H    0     0                     650.6431822 30426.5810  4576%     -   30s
     0     0 30426.5810    0  275  650.64318 30426.5810  4576%     -   30s
H    0     0                     684.3598623 30426.5415  4346%     -   31s
H    0     0                     895.1807468 30426.5415  3299%     -   31s
     0     0 29844.7355    0  259  895.18075 29844.7355  3234%     -   42s
     0     0 29725.0489    0  268  895.18075 29725.0489  3221%     -   48s
     0     0 29620.4179    0  271  895.18075 29620.4179  3209%     -   51s
     0     0 29620.4179    0  271  895.18075 29620.4179  3209%     -   52s
     0     0 29576.3662    0  272  895.18075 29576.3662  3204%     -   52s
     0     0 29547.9109    0  262  895.18075 29547.9109  3201%     -   57s
     0     0 29538.6299    0  260  895.18075 29538.6299  3200%     -   57s
     0     0 29538.3815    0  260  895.18075 29538.3815  3200%     -   57s
     0     0 26493.8004    0  257  895.18075 26493.8004  2860%     -   83s
     0     0 26010.2919    0  282  895.18075 26010.2919  2806%     -   97s
H    0     0                     995.4944291 25936.4555  2505%     -  100s
     0     0 25936.4555    0  282  995.49443 25936.4555  2505%     -  100s
     0     0 25685.6125    0  282  995.49443 25685.6125  2480%     -  106s
     0     0 25591.6639    0  281  995.49443 25591.6639  2471%     -  111s
     0     0 25585.3521    0  277  995.49443 25585.3521  2470%     -  113s
     0     0 25580.8699    0  287  995.49443 25580.8699  2470%     -  114s
     0     0 25566.3337    0  276  995.49443 25566.3337  2468%     -  115s
     0     0 25555.2639    0  292  995.49443 25555.2639  2467%     -  116s
     0     0 25533.0571    0  291  995.49443 25533.0571  2465%     -  118s
     0     0 25532.8985    0  301  995.49443 25532.8985  2465%     -  118s
     0     0 22326.9999    0  312  995.49443 22326.9999  2143%     -  145s
H    0     0                    1023.9620821 22326.7790  2080%     -  145s
H    0     0                    1103.6444700 22326.7790  1923%     -  145s
H    0     0                    1601.0964468 21736.5010  1258%     -  160s
H    0     0                    1674.4179141 21736.5010  1198%     -  160s
H    0     0                    1733.8103804 21736.5010  1154%     -  160s
H    0     0                    1749.2870487 21736.5010  1143%     -  160s
H    0     0                    1825.2443367 21736.5010  1091%     -  160s
     0     0 21736.5010    0  338 1825.24434 21736.5010  1091%     -  160s
H    0     0                    2486.8770905 21429.4432   762%     -  174s
H    0     0                    2501.1455997 21429.4432   757%     -  174s
     0     0 21429.4432    0  331 2501.14560 21429.4432   757%     -  174s
     0     0 21088.1746    0  429 2501.14560 21088.1746   743%     -  186s
     0     0 20991.5350    0  430 2501.14560 20991.5350   739%     -  192s
     0     0 20953.7309    0  441 2501.14560 20953.7309   738%     -  195s
     0     0 20900.3622    0  429 2501.14560 20900.3622   736%     -  199s
     0     0 20877.0831    0  422 2501.14560 20877.0831   735%     -  203s
     0     0 20819.9681    0  433 2501.14560 20819.9681   732%     -  206s
     0     0 20788.4931    0  428 2501.14560 20788.4931   731%     -  209s
     0     0 20750.6103    0  426 2501.14560 20750.6103   730%     -  212s
     0     0 20741.3172    0  437 2501.14560 20741.3172   729%     -  214s
     0     0 20731.0437    0  424 2501.14560 20731.0437   729%     -  217s
     0     0 20727.8266    0  441 2501.14560 20727.8266   729%     -  220s
     0     0 20722.0332    0  441 2501.14560 20722.0332   729%     -  221s
     0     0 20713.0168    0  437 2501.14560 20713.0168   728%     -  222s
     0     0 20704.7281    0  437 2501.14560 20704.7281   728%     -  224s
     0     0 20697.8807    0  444 2501.14560 20697.8807   728%     -  226s
     0     0 20691.1596    0  440 2501.14560 20691.1596   727%     -  227s
     0     0 20688.9370    0  443 2501.14560 20688.9370   727%     -  228s
     0     0 20688.1154    0  447 2501.14560 20688.1154   727%     -  229s
H    0     0                    2580.9611202 20688.1154   702%     -  242s
H    0     0                    2582.3626548 20688.1154   701%     -  242s
H    0     0                    2601.3807563 20688.1154   695%     -  242s
H    0     0                    2641.4476448 20688.1154   683%     -  242s
H    0     0                    2651.2903417 20688.1154   680%     -  242s
H    0     0                    2674.6991880 20688.1154   673%     -  242s
H    0     0                    2690.1502482 20688.1154   669%     -  242s
H    0     0                    2725.4447794 20688.1154   659%     -  242s
H    0     0                    2738.0976782 19340.1851   606%     -  267s
H    0     0                    2768.7714731 19340.1851   599%     -  267s
H    0     0                    2809.2566036 19340.1851   588%     -  267s
H    0     0                    2853.9158628 19340.1851   578%     -  267s
     0     0 19340.1851    0  461 2853.91586 19340.1851   578%     -  267s
H    0     0                    2922.7696090 19340.1462   562%     -  267s
H    0     0                    3037.0340580 19340.1462   537%     -  267s
H    0     0                    3061.2199931 19340.1462   532%     -  268s
     0     0 19144.1533    0  468 3061.21999 19144.1533   525%     -  279s
     0     0 19050.1668    0  487 3061.21999 19050.1668   522%     -  286s
     0     0 18962.3008    0  495 3061.21999 18962.3008   519%     -  292s
     0     0 18923.1627    0  478 3061.21999 18923.1627   518%     -  297s
     0     0 18903.7768    0  486 3061.21999 18903.7768   518%     -  301s
     0     0 18894.6025    0  481 3061.21999 18894.6025   517%     -  302s
     0     0 18873.8797    0  482 3061.21999 18873.8797   517%     -  304s
     0     0 18865.0339    0  487 3061.21999 18865.0339   516%     -  305s
     0     0 18861.8882    0  488 3061.21999 18861.8882   516%     -  306s
     0     0 18857.8528    0  496 3061.21999 18857.8528   516%     -  307s
     0     0 18847.9219    0  497 3061.21999 18847.9219   516%     -  311s
     0     0 18844.6540    0  500 3061.21999 18844.6540   516%     -  312s
     0     0 18844.3293    0  500 3061.21999 18844.3293   516%     -  313s
     0     0 18684.5762    0  503 3061.21999 18684.5762   510%     -  326s
H    0     0                    3075.3237080 18684.3310   508%     -  326s
     0     0 18634.2917    0  506 3075.32371 18634.2917   506%     -  335s
     0     0 18617.5920    0  498 3075.32371 18617.5920   505%     -  340s
     0     0 18604.6297    0  497 3075.32371 18604.6297   505%     -  343s
     0     0 18599.8786    0  505 3075.32371 18599.8786   505%     -  345s
     0     0 18597.3753    0  566 3075.32371 18597.3753   505%     -  347s
     0     0 18472.3345    0  411 3075.32371 18472.3345   501%     -  356s
H    0     0                    3318.4938206 18472.3158   457%     -  356s
     0     0 18434.9596    0  546 3318.49382 18434.9596   456%     -  361s
H    0     0                    3470.2891562 18418.6701   431%     -  366s
     0     0 18418.6701    0  548 3470.28916 18418.6701   431%     -  366s
     0     0 18409.1792    0  556 3470.28916 18409.1792   430%     -  368s
     0     0 18403.2430    0  552 3470.28916 18403.2430   430%     -  370s
     0     0 18401.0123    0  561 3470.28916 18401.0123   430%     -  371s
     0     0 18361.3603    0  553 3470.28916 18361.3603   429%     -  376s
     0     0 18338.1808    0  522 3470.28916 18338.1808   428%     -  381s
     0     0 18329.8572    0  524 3470.28916 18329.8572   428%     -  384s
     0     0 18326.5138    0  516 3470.28916 18326.5138   428%     -  385s
     0     0 18324.8794    0  528 3470.28916 18324.8794   428%     -  387s
     0     0 18311.4443    0  513 3470.28916 18311.4443   428%     -  394s
     0     0 18308.6325    0  436 3470.28916 18308.6325   428%     -  398s
     0     0 18306.2776    0  567 3470.28916 18306.2776   428%     -  400s
     0     0 18301.5904    0  566 3470.28916 18301.5904   427%     -  403s
     0     0 18299.2940    0  522 3470.28916 18299.2940   427%     -  405s
     0     0 18295.6148    0  563 3470.28916 18295.6148   427%     -  408s
     0     0 18295.4300    0  563 3470.28916 18295.4300   427%     -  410s
H    0     0                    3479.0331851 18295.3786   426%     -  435s
H    0     0                    3516.9209132 18295.3786   420%     -  462s
     0     2 18295.3786    0  563 3516.92091 18295.3786   420%     -  463s
     1     4 18272.7083    1  421 3516.92091 18294.5054   420%  1362  474s
     3     8 18251.3116    2  438 3516.92091 18271.3170   420%  3950  489s
     7    14 17691.8930    3  498 3516.92091 18251.2315   419%  6725  508s
    13    27 17035.5312    4  549 3516.92091 18251.2315   419%  9480  526s
    26    40 17494.8482    5  506 3516.92091 17873.5720   408% 12933  564s
    39    71 16566.8541    6  391 3516.92091 17781.4096   406% 11843  626s
    70   136 16448.5031    7  431 3516.92091 17781.4096   406% 12427  657s
   135   168 15937.8478    8  436 3516.92091 17781.4096   406%  9715  673s
   167   217 15916.3068    9  452 3516.92091 17781.4096   406%  8549  692s
H  181   217                    3550.2784596 17781.4096   401%  8055  692s
   216   287 15904.1706   10  456 3550.27846 17781.4096   401%  7179  716s
   286   371 15796.7459   11  434 3550.27846 17781.4096   401%  6549  735s
H  314   371                    3578.7626835 17781.4096   397%  6349  735s
H  328   371                    3605.4183769 17781.4096   393%  6404  735s
   370   458 15468.5850   16  359 3605.41838 17781.4096   393%  6290  750s
   459   534 14797.6989   21  322 3605.41838 17781.4096   393%  5882  766s
   537   595 14489.3307   24  349 3605.41838 17781.4096   393%  5648  783s
   604   660 14297.7686   26  340 3605.41838 17781.4096   393%  5528  799s
   679   705 14095.6590   29  314 3605.41838 17781.4096   393%  5370  815s
   734   727 6237.19684   30  245 3605.41838 17781.4096   393%  5390  829s
H  742   727                    3692.9039979 17781.4096   382%  5399  829s
   772   753 6036.56968   31  317 3692.90400 17781.4096   382%  5467  844s
H  822   792                    3701.0837741 17781.4096   380%  5491  859s
   871   824 5734.94855   36  421 3701.08377 17781.4096   380%  5475  874s
   935   860 5504.56172   40  362 3701.08377 17781.4096   380%  5458  900s
  1005   936 5255.55346   46  246 3701.08377 17781.4096   380%  5524  916s
  1100  1023 4504.94159   48  274 3701.08377 17781.4096   380%  5444  934s
  1217  1048 4174.22275   51  269 3701.08377 17781.4096   380%  5322  949s
  1256  1097 infeasible   52      3701.08377 17781.4096   380%  5376  964s
  1325  1156 infeasible   52      3701.08377 17606.1734   376%  5368  981s
  1439  1195 17074.9484    7  433 3701.08377 17605.6236   376%  5356  999s
  1546  1294 16500.7074    8  470 3701.08377 17605.6236   376%  5305 1019s
  1677  1399 16467.6611    9  453 3701.08377 17605.6236   376%  5191 1040s
  1841  1458 15910.1129   11  449 3701.08377 17605.6236   376%  5042 1061s
  2003  1503 13704.2467   12  444 3701.08377 17605.6236   376%  4910 1084s
  2105  1562 13138.7389   13  335 3701.08377 17557.1493   374%  4900 1105s
  2236  1593 8443.11192   14  320 3701.08377 17557.1493   374%  4906 1122s
  2269  1617 8193.43939   15  397 3701.08377 17557.1493   374%  4965 1142s
  2325  1651 7651.42130   17  378 3701.08377 17557.1493   374%  4994 1164s
  2407  1712 infeasible   19      3701.08377 17557.1493   374%  4992 1185s
  2522  1809 10234.5108   29  328 3701.08377 17438.1019   371%  5044 1207s
  2661  1939 9660.87443   31  314 3701.08377 17438.1019   371%  5068 1234s
  2823  2058 9237.67126   34  318 3701.08377 17438.1019   371%  5048 1258s
  2992  2155 9194.61734   35  204 3701.08377 17438.1019   371%  5059 1286s
  3175  2256 infeasible   37      3701.08377 16985.4396   359%  5035 1315s
  3367  2361 infeasible   42      3701.08377 16985.4396   359%  5036 1344s
  3572  2559 4915.21405   52  206 3701.08377 16985.4396   359%  5043 1376s
  3817  2560 10243.7695   61  563 3701.08377 16854.5853   355%  4970 1460s
  3819  2561 6594.46997   57  167 3701.08377 16854.5853   355%  4967 1470s
  3820  2562 8564.54757   45  292 3701.08377 16854.5853   355%  4966 1524s
  3821  2563 6233.84162   31  402 3701.08377 16854.5853   355%  4965 1558s
  3822  2563 5045.87170   19  354 3701.08377 16854.5853   355%  4963 1582s
  3823  2564 15371.1558   13  459 3701.08377 16854.5853   355%  4962 1604s
  3824  2565 11792.2499   51  467 3701.08377 16854.5853   355%  4961 1619s
  3825  2565 6570.38887   47  482 3701.08377 16854.5853   355%  4959 1628s
  3826  2566 6727.81628   30  427 3701.08377 16854.5853   355%  4958 1637s
  3827  2567 14718.2886   12  532 3701.08377 16854.5853   355%  4957 1649s
  3828  2567 6519.64094   19  481 3701.08377 16854.5853   355%  4956 1658s
  3829  2568 15836.3797    8  524 3701.08377 16854.5853   355%  4954 1666s
  3830  2569 13016.8560   37  502 3701.08377 16854.5853   355%  4953 1673s
  3831  2569 14854.3636   18  554 3701.08377 16854.5853   355%  4952 1679s
  3832  2570 15402.1513   17  443 3701.08377 16854.5853   355%  4950 1683s
  3833  2571 12886.4551   48  433 3701.08377 16854.5853   355%  4949 1700s
  3834  2571 4856.18219   35  426 3701.08377 16854.5853   355%  4948 1710s
  3835  2572 13156.9550   18  541 3701.08377 16854.5853   355%  4947 1719s
  3836  2573 5200.60315   29  478 3701.08377 16854.5853   355%  4945 1724s
  3837  2573 15417.9453   14  485 3701.08377 16854.5853   355%  4944 1728s
  3838  2574 16529.5992   10  490 3701.08377 16854.5853   355%  4943 1732s
  3839  2575 7701.68162   52  504 3701.08377 16854.5853   355%  4941 1738s
  3840  2575 7476.47268   51  431 3701.08377 16854.5853   355%  4940 1751s
  3841  2576 7947.06696   52  445 3701.08377 16854.5853   355%  4939 1757s
  3842  2577 16470.9595   10  511 3701.08377 16854.5853   355%  4938 1764s
  3843  2577 13005.6999   24  452 3701.08377 16854.5853   355%  4936 1769s
  3844  2578 6001.41914   27  515 3701.08377 16854.5853   355%  4935 1774s
  3845  2579 11675.3373   19  574 3701.08377 16854.5853   355%  4934 1784s
  3846  2579 5504.45877   15  568 3701.08377 16854.5853   355%  4932 1787s
  3847  2580 4929.91776   31  550 3701.08377 16854.5853   355%  4931 1794s
  3848  2581 9328.36843   42  551 3701.08377 16854.5853   355%  4930 1797s
  3849  2581 9732.30011   25  497 3701.08377 16854.5853   355%  4929 1802s
  3850  2582 10256.5041   33  491 3701.08377 16854.5853   355%  4927 1805s
  3852  2583 6940.70526   20  500 3701.08377 16854.5853   355%  4925 1811s
  3853  2584 11343.1465   21  495 3701.08377 16854.5853   355%  4923 1815s
  3855  2585 14402.3148   17  495 3701.08377 16854.5853   355%  4921 1822s
  3856  2586 4908.91381   28  495 3701.08377 16854.5853   355%  4920 1832s
  3857  2587 9666.91399   12  495 3701.08377 16854.5853   355%  4918 1879s
  3858  2590 16854.5853   10  511 3701.08377 16854.5853   355%  5003 1935s
  3860  2594 16854.5853   11  457 3701.08377 16854.5853   355%  5004 1963s
  3864  2600 16854.5853   12  401 3701.08377 16854.5853   355%  5010 1994s
  3872  2614 16854.5853   13  548 3701.08377 16854.5853   355%  5027 2033s
  3888  2624 15161.5865   14  334 3701.08377 16854.5853   355%  5078 2213s
  3904  2651 13967.7469   15  332 3701.08377 16854.5853   355%  5141 2239s
  3936  2768 13553.6511   16  331 3701.08377 16854.5853   355%  5157 2268s
  4064  2757 13040.5788   19  313 3701.08377 16854.5853   355%  5167 2279s
  4096  2778 13041.3383   18  327 3701.08377 16854.5853   355%  5154 2294s
H 4125  2638                    3741.0071263 16854.5853   351%  5138 2294s
  4138  2678 11984.1009   20  304 3741.00713 16854.5853   351%  5137 2318s
  4202  2685 12968.1659   20  316 3741.00713 16854.5853   351%  5120 2334s
  4270  2667 11625.5687   22  206 3741.00713 16854.5853   351%  5102 2348s
H 4271  2543                    3773.5351684 16854.5853   347%  5100 2348s
H 4273  2425                    3781.5768991 16854.5853   346%  5101 2348s
H 4278  2311                    3814.1049412 16854.5853   342%  5097 2348s
  4305  2311 11545.8126   22  239 3814.10494 16854.5853   342%  5091 2377s
  4378  2287     cutoff   28      3814.10494 16854.5853   342%  5065 2404s
  4433  2272 10811.0122   23  213 3814.10494 16854.5853   342%  5049 2425s
  4486  2249 infeasible   24      3814.10494 16854.5853   342%  5038 2444s
H 4506  2136                    3828.3734504 16854.5853   340%  5035 2444s
  4527  2141 5875.25815   26  212 3828.37345 16854.5853   340%  5027 2461s
  4589  2132 13753.0259   21  496 3828.37345 16854.5853   340%  5001 2482s
  4657  2120 13056.4880   22  423 3828.37345 16854.5853   340%  4982 2508s
  4693  2126 12857.8159   23  487 3828.37345 16854.5853   340%  4987 2528s
  4726  2138 12568.5129   24  413 3828.37345 16854.5853   340%  5000 2554s
  4756  2143 12166.4211   25  459 3828.37345 16854.5853   340%  5007 2573s
  4814  2156 11395.9206   27  440 3828.37345 16854.5853   340%  5003 2590s
  4879  2158 10678.1135   31  326 3828.37345 16854.5853   340%  4991 2618s
  4922  2168 9455.93394   32  349 3828.37345 16854.5853   340%  4983 2642s
H 4937  2063                    3856.5804407 16854.5853   337%  4979 2642s
  4977  2119 9304.87098   33  281 3856.58044 16854.5853   337%  4979 2663s
  5082  2125 7910.58776   39  264 3856.58044 16854.5853   337%  4937 2686s
  5178  2169     cutoff   43      3856.58044 16854.5853   337%  4917 2712s
  5297  2141 infeasible   41      3856.58044 16854.5853   337%  4861 2734s
  5409  2140 12420.9781   18  429 3856.58044 16854.5853   337%  4835 2763s
  5494  2156 6724.76885   21  222 3856.58044 16854.5853   337%  4833 2790s
  5576  2163 5455.87015   24  212 3856.58044 16854.5853   337%  4825 2816s
  5664  2173 infeasible   29      3856.58044 16854.5853   337%  4824 2844s
  5765  2177 11704.3601   20  429 3856.58044 16854.5853   337%  4824 2871s
  5872  2158 11297.4352   22  312 3856.58044 16854.5853   337%  4818 2902s
  6002  2120 9864.00328   23  302 3856.58044 16379.3725   325%  4798 2927s
  6048  2122 7057.99568   24  461 3856.58044 16379.0820   325%  4805 2951s
  6079  2129 5015.62509   25  217 3856.58044 16379.0820   325%  4809 2981s
  6130  2153     cutoff   26      3856.58044 16379.0820   325%  4810 3009s
H 6135  2055                    3861.3381595 16379.0820   324%  4810 3009s
  6204  2096 6185.59709   26  409 3861.33816 16231.2468   320%  4817 3041s
  6350  2066 5585.95113   28  394 3861.33816 16231.2468   320%  4805 3074s
  6467  2085     cutoff   30      3861.33816 16231.2468   320%  4811 3111s
  6596  2107 4819.84764   23  341 3861.33816 15267.5162   295%  4826 3149s
  6762  2092 5282.15810   24  300 3861.33816 15267.5162   295%  4819 3192s
  6926  2062 infeasible   26      3861.33816 15267.5162   295%  4805 3246s
  7078  2020 9174.14186   24  287 3861.33816 15267.5162   295%  4807 3279s
  7132  2095 8609.19198   25  304 3861.33816 15267.5162   295%  4818 3319s
  7278  2113 4107.32475   28  247 3861.33816 13864.8677   259%  4803 3367s
  7479  2105 infeasible   28      3861.33816 12846.5456   233%  4786 3414s
  7683  2119 infeasible   31      3861.33816 12846.5456   233%  4779 3466s
  7901  2119 6650.57988   26  398 3861.33816 12748.5477   230%  4768 3516s
  8144  2099 5151.86260   30  280 3861.33816 12748.5477   230%  4756 3566s
  8415  2028     cutoff   31      3861.33816 12353.7793   220%  4726 3600s

Cutting planes:
  Gomory: 22
  Implied bound: 51
  Projected implied bound: 163
  MIR: 1884
  Mixing: 5
  Flow cover: 3379
  RLT: 69
  Relax-and-lift: 376

Explored 8466 nodes (40523126 simplex iterations) in 3600.06 seconds (9207.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3861.34 3856.58 3828.37 ... 3605.42

Time limit reached
Best objective 3.861338159471e+03, best bound 1.220859049331e+04, gap 216.1751%
  WARNING: Time limit reached. Using best solution found (gap: 216.18%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.08s
  Master Objective (UB) = 3861.34, θ = 145269.45
  Upper Bound (UB) = 3861.34

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145269.45
  [DEBUG]   ✓ Scenario 0: θ = 145269.45 ≤ Q = 145269.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145269.45 ≤ Q = 145269.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145269.45 ≤ Q = 145269.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145269.45 ≤ Q = 145269.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145269.45 ≤ Q = 145269.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145269.45 ≤ Q = 145269.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145269.45 ≤ Q = 145269.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145269.45 ≤ Q = 145269.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145269.45 ≤ Q = 145269.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145269.45 ≤ Q = 145269.45 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 10] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x35ae684a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xca5197b6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.144585e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5709942.7098
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.275192e+05, 242 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127519.23    0  123 5709942.71 -127519.23   102%     -    0s
H    0     0                    -95447.00196 -127519.23  33.6%     -    0s
H    0     0                    -96011.14021 -127519.23  32.8%     -    0s
     0     0 -103269.50    0   81 -96011.140 -103269.50  7.56%     -    0s
H    0     0                    -102581.7566 -103269.31  0.67%     -    0s
     0     0 -103107.83    0   45 -102581.76 -103107.83  0.51%     -    0s
H    0     0                    -102773.9070 -103066.70  0.28%     -    0s
     0     0 -102927.59    0   32 -102773.91 -102927.59  0.15%     -    0s
     0     0 -102883.93    0    8 -102773.91 -102883.93  0.11%     -    0s
     0     0 -102858.28    0    9 -102773.91 -102858.28  0.08%     -    0s
     0     0 -102848.10    0    9 -102773.91 -102848.10  0.07%     -    0s
     0     0 -102842.07    0    9 -102773.91 -102842.07  0.07%     -    0s
     0     0 -102835.69    0    9 -102773.91 -102835.69  0.06%     -    0s
     0     0 -102829.92    0    8 -102773.91 -102829.92  0.05%     -    0s
     0     0 -102820.72    0    8 -102773.91 -102820.72  0.05%     -    0s
     0     0 -102789.72    0    3 -102773.91 -102789.72  0.02%     -    0s
     0     0 -102782.48    0    2 -102773.91 -102782.48  0.01%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 132
  RLT: 8

Explored 1 nodes (455 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -102774 -102582 -96011.1 ... 1.14459e+13
No other solutions better than -102774

Optimal solution found (tolerance 1.00e-06)
Best objective -1.027739070485e+05, best bound -1.027739070485e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 140568.79
  Scenario: 7 demand increases, 53 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -102773.91
  [DEBUG]   S×d_nominal = 243342.70
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243342.70 + -102773.91 = 140568.79
  [DEBUG]   Current θ from Master = 145269.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 4700.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -839.33
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2876.7133, Absolute Gap = 2876.7133, Relative Gap = 0.745004
  Not converged yet (gap = 2876.71 > ε = 200)

  [DEBUG] Adding NEW scenario 10 to Master Problem...
  [DEBUG] New scenario pattern: 7 increases, 53 decreases
    [DEBUG] Scenario 10 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 10 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 10]
    [DEBUG]   - Total constraints in model: 169573
    [DEBUG]   - Total variables in model: 70900
  [DEBUG] Total scenarios in Master: 11
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 11
================================================================================
[Iteration 11] Solving Master Problem...
  Current scenarios in Master: 11
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 169573 rows, 70900 columns and 481060 nonzeros
Model fingerprint: 0x7e8b2c50
Variable types: 68641 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 77770 rows and 31570 columns
Presolve time: 1.34s
Presolved: 91803 rows, 39330 columns, 558929 nonzeros
Variable types: 37071 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -370132.3089
Found heuristic solution: objective -209564.0980

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 595
 AA' NZ     : 3.319e+06
 Factor NZ  : 7.510e+06 (roughly 110 MB of memory)
 Factor Ops : 1.324e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.67717851e+07  1.56533077e+08  9.34e+04 2.15e+01  7.48e+04     2s
   1  -1.27731199e+07  1.39656281e+08  6.55e+04 6.19e+01  5.17e+04     3s
   2  -6.21400039e+06  1.07746202e+08  3.07e+04 7.22e-01  2.54e+04     3s
   3  -1.01358668e+06  8.17132426e+07  2.79e+03 1.13e+00  2.69e+03     3s
   4  -4.95174012e+05  3.82451868e+07  4.18e+02 3.49e-01  5.25e+02     3s
   5  -4.21638250e+05  2.27018355e+07  2.36e+02 1.65e-01  2.88e+02     3s
   6  -3.14195939e+05  1.64272339e+07  8.02e+01 1.09e-01  1.46e+02     3s
   7  -2.15657014e+05  1.18631845e+07  3.11e+01 7.39e-02  8.72e+01     3s
   8  -1.40926079e+05  8.91991366e+06  8.93e+00 5.46e-02  5.75e+01     3s
   9  -1.07561736e+05  5.82403288e+06  5.52e+00 3.43e-02  3.68e+01     3s
  10  -8.12162449e+04  1.95773461e+06  3.02e+00 1.07e-02  1.25e+01     3s
  11  -3.47313667e+04  5.40720678e+05  1.23e+00 2.90e-03  3.47e+00     3s
  12  -1.95530407e+04  2.73642687e+05  8.16e-01 1.84e-03  1.76e+00     3s
  13  -1.32580566e+04  1.73164170e+05  6.16e-01 1.46e-03  1.12e+00     3s
  14  -7.07391661e+03  1.27980959e+05  5.02e-01 1.37e-03  8.08e-01     3s
  15  -1.98315998e+03  1.01264307e+05  4.26e-01 2.91e-03  6.18e-01     3s
  16   5.44613463e+03  8.28845467e+04  3.28e-01 3.32e-03  4.63e-01     3s
  17   1.19890111e+04  6.98488983e+04  2.48e-01 2.70e-03  3.46e-01     3s
  18   1.59323436e+04  5.94329123e+04  2.03e-01 1.53e-03  2.60e-01     3s
  19   2.05266982e+04  5.24325439e+04  1.51e-01 1.73e-03  1.91e-01     3s
  20   2.30554404e+04  4.79233617e+04  1.24e-01 1.27e-03  1.48e-01     3s
  21   2.51193983e+04  4.40297060e+04  1.03e-01 1.16e-03  1.13e-01     3s
  22   2.74380630e+04  4.34283670e+04  8.04e-02 1.21e-03  9.55e-02     4s
  23   2.84178449e+04  4.21683508e+04  7.03e-02 1.30e-03  8.21e-02     4s
  24   2.99081901e+04  4.08067554e+04  5.59e-02 1.74e-03  6.51e-02     4s
  25   3.10136870e+04  3.97800879e+04  4.55e-02 1.12e-03  5.23e-02     4s
  26   3.18553006e+04  3.94821741e+04  3.76e-02 1.05e-03  4.55e-02     4s
  27   3.23517937e+04  3.84185614e+04  3.31e-02 8.30e-04  3.62e-02     4s
  28   3.34091695e+04  3.79398963e+04  2.36e-02 9.47e-04  2.70e-02     4s
  29   3.40393131e+04  3.73361285e+04  1.80e-02 7.65e-04  1.97e-02     4s
  30   3.43039445e+04  3.71202863e+04  1.58e-02 8.00e-04  1.68e-02     4s
  31   3.47606340e+04  3.68422517e+04  1.19e-02 5.41e-04  1.24e-02     4s
  32   3.48697442e+04  3.68051820e+04  1.10e-02 5.07e-04  1.16e-02     4s
  33   3.51707317e+04  3.67170112e+04  8.42e-03 4.33e-04  9.23e-03     4s
  34   3.53069379e+04  3.66343056e+04  7.28e-03 3.61e-04  7.92e-03     4s
  35   3.53454143e+04  3.66080630e+04  6.96e-03 3.38e-04  7.54e-03     4s
  36   3.54317601e+04  3.65738405e+04  6.27e-03 3.06e-04  6.82e-03     4s
  37   3.55288175e+04  3.65335886e+04  5.50e-03 2.69e-04  6.00e-03     4s
  38   3.56503194e+04  3.64515983e+04  4.48e-03 2.01e-04  4.78e-03     4s
  39   3.58002140e+04  3.64036308e+04  3.26e-03 1.57e-04  3.60e-03     4s
  40   3.58840626e+04  3.63616412e+04  2.56e-03 1.21e-04  2.85e-03     4s
  41   3.59966671e+04  3.63065700e+04  1.69e-03 7.07e-05  1.85e-03     5s
  42   3.60254916e+04  3.62983567e+04  1.48e-03 6.33e-05  1.63e-03     5s
  43   3.60683006e+04  3.62786066e+04  1.16e-03 4.68e-05  1.26e-03     5s
  44   3.61204439e+04  3.62677633e+04  7.49e-04 3.77e-05  8.79e-04     5s
  45   3.61411742e+04  3.62549120e+04  5.90e-04 2.69e-05  6.79e-04     5s
  46   3.61468156e+04  3.62462809e+04  5.47e-04 1.95e-05  5.94e-04     5s
  47   3.61761646e+04  3.62433712e+04  3.32e-04 1.69e-05  4.01e-04     5s
  48   3.61824641e+04  3.62395904e+04  2.83e-04 1.37e-05  3.41e-04     5s
  49   3.62111556e+04  3.62357391e+04  7.40e-05 1.05e-05  1.46e-04     5s
  50   3.62136738e+04  3.62326285e+04  5.86e-05 7.82e-06  1.13e-04     5s
  51   3.62148452e+04  3.62302960e+04  5.10e-05 5.81e-06  9.20e-05     5s
  52   3.62195548e+04  3.62266543e+04  2.11e-05 2.74e-06  4.23e-05     5s
  53   3.62210286e+04  3.62238183e+04  1.22e-05 1.91e-06  1.66e-05     5s
  54   3.62214095e+04  3.62233419e+04  9.98e-06 2.39e-07  1.15e-05     5s
  55   3.62231801e+04  3.62232376e+04  7.26e-07 5.31e-07  3.43e-07     5s
  56   3.62232168e+04  3.62232168e+04  2.89e-09 8.65e-09  2.57e-10     5s

Barrier solved model in 56 iterations and 5.30 seconds (8.32 work units)
Optimal objective 3.62232168e+04


Root crossover log...

   79137 DPushes remaining with DInf 0.0000000e+00                 5s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

    2567 PPushes remaining with PInf 1.5465406e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 7s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.0061304e+00      7s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32969    3.6223217e+04   0.000000e+00   3.006130e+00      7s
   32984    3.6223217e+04   0.000000e+00   0.000000e+00      7s
   32984    3.6223217e+04   0.000000e+00   0.000000e+00      7s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.622322e+04, 32984 iterations, 5.15 seconds (9.34 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36223.2168    0  247 -209564.10 36223.2168   117%     -    7s
H    0     0                    -130121.7727 36223.2168   128%     -    7s
H    0     0                    -128843.3582 36223.2168   128%     -    7s
H    0     0                    -127993.5483 36223.2168   128%     -    7s
H    0     0                    -127687.3897 36223.2168   128%     -    7s
H    0     0                    -43007.46332 36223.2168   184%     -    7s
H    0     0                    -42990.89092 36223.2168   184%     -    7s
H    0     0                    -24192.61785 36223.2168   250%     -    7s
H    0     0                    -23906.96491 36223.2168   252%     -    7s
H    0     0                    -8401.875931 36223.2168   531%     -    7s
H    0     0                    -6836.984875 36223.2168   630%     -    8s
H    0     0                    -6827.888387 36223.2168   631%     -    8s
H    0     0                    -6729.693219 36223.2168   638%     -    8s
H    0     0                    -4048.061530 36223.2168   995%     -    9s
H    0     0                     400.8849886 36223.2168  8936%     -    9s
H    0     0                     510.2704868 36223.2168  6999%     -    9s
H    0     0                     615.8368408 36223.2168  5782%     -    9s
     0     0 30649.0856    0  383  615.83684 30649.0856  4877%     -   29s
H    0     0                     758.1140984 30649.0856  3943%     -   29s
H    0     0                    1445.5781652 30649.0856  2020%     -   29s
H    0     0                    1722.6831741 30649.0856  1679%     -   30s
H    0     0                    1952.7183309 30649.0856  1470%     -   30s
     0     0 29605.1714    0  364 1952.71833 29605.1714  1416%     -   42s
     0     0 29590.2551    0  392 1952.71833 29590.2551  1415%     -   45s
     0     0 29577.6589    0  372 1952.71833 29577.6589  1415%     -   47s
     0     0 29490.1417    0  370 1952.71833 29490.1417  1410%     -   49s
     0     0 29475.9407    0  377 1952.71833 29475.9407  1409%     -   52s
     0     0 29475.9407    0  374 1952.71833 29475.9407  1409%     -   54s
     0     0 29475.9407    0  374 1952.71833 29475.9407  1409%     -   54s
     0     0 25552.5746    0  399 1952.71833 25552.5746  1209%     -   95s
H    0     0                    2197.1864337 25552.5155  1063%     -   96s
     0     0 24545.1028    0  484 2197.18643 24545.1028  1017%     -  142s
     0     0 24373.5559    0  475 2197.18643 24373.5559  1009%     -  157s
     0     0 24005.1087    0  509 2197.18643 24005.1087   993%     -  173s
     0     0 23972.7781    0  517 2197.18643 23972.7781   991%     -  181s
     0     0 23941.8882    0  516 2197.18643 23941.8882   990%     -  185s
     0     0 23932.2170    0  512 2197.18643 23932.2170   989%     -  188s
     0     0 23921.7489    0  514 2197.18643 23921.7489   989%     -  191s
     0     0 23920.4320    0  508 2197.18643 23920.4320   989%     -  192s
H    0     0                    2514.2787343 21211.5666   744%     -  253s
H    0     0                    2820.3674300 21211.5666   652%     -  253s
H    0     0                    2848.8269696 21211.5666   645%     -  253s
H    0     0                    2913.9677370 21211.5666   628%     -  253s
     0     0 21211.5666    0  338 2913.96774 21211.5666   628%     -  253s
     0     0 20725.6935    0  374 2913.96774 20725.6935   611%     -  283s
     0     0 20580.9359    0  507 2913.96774 20580.9359   606%     -  300s
     0     0 20492.7187    0  375 2913.96774 20492.7187   603%     -  311s
     0     0 20441.8268    0  387 2913.96774 20441.8268   602%     -  322s
H    0     0                    2967.1892506 20421.9178   588%     -  325s
     0     0 20421.9178    0  388 2967.18925 20421.9178   588%     -  325s
     0     0 20415.4433    0  386 2967.18925 20415.4433   588%     -  328s
H    0     0                    3010.2249193 20410.4278   578%     -  331s
     0     0 20410.4278    0  391 3010.22492 20410.4278   578%     -  331s
     0     0 20408.0257    0  382 3010.22492 20408.0257   578%     -  333s
     0     0 20405.5649    0  387 3010.22492 20405.5649   578%     -  335s
     0     0 20404.4549    0  387 3010.22492 20404.4549   578%     -  336s
     0     0 19418.6840    0  472 3010.22492 19418.6840   545%     -  385s
     0     0 19215.9979    0  542 3010.22492 19215.9979   538%     -  404s
     0     0 19158.5799    0  479 3010.22492 19158.5799   536%     -  412s
     0     0 19130.0319    0  484 3010.22492 19130.0319   536%     -  420s
     0     0 19102.2961    0  485 3010.22492 19102.2961   535%     -  427s
     0     0 19054.9172    0  491 3010.22492 19054.9172   533%     -  436s
     0     0 19043.7927    0  545 3010.22492 19043.7927   533%     -  440s
     0     0 19018.4231    0  541 3010.22492 19018.4231   532%     -  444s
     0     0 19009.9248    0  539 3010.22492 19009.9248   532%     -  446s
     0     0 19004.0871    0  544 3010.22492 19004.0871   531%     -  448s
     0     0 19003.6734    0  544 3010.22492 19003.6734   531%     -  449s
     0     0 18860.7458    0  563 3010.22492 18860.7458   527%     -  462s
     0     0 18787.2463    0  475 3010.22492 18787.2463   524%     -  474s
     0     0 18750.2205    0  527 3010.22492 18750.2205   523%     -  484s
     0     0 18734.8028    0  539 3010.22492 18734.8028   522%     -  489s
     0     0 18725.2802    0  551 3010.22492 18725.2802   522%     -  494s
     0     0 18722.0315    0  554 3010.22492 18722.0315   522%     -  497s
     0     0 18704.5904    0  489 3010.22492 18704.5904   521%     -  500s
     0     0 18694.6363    0  542 3010.22492 18694.6363   521%     -  505s
     0     0 18689.4325    0  542 3010.22492 18689.4325   521%     -  507s
     0     0 18687.9044    0  545 3010.22492 18687.9044   521%     -  508s
     0     0 18605.6334    0  486 3010.22492 18605.6334   518%     -  519s
     0     0 18585.8192    0  630 3010.22492 18585.8192   517%     -  529s
H    0     0                    3089.3710424 18573.2626   501%     -  535s
     0     0 18573.2626    0  501 3089.37104 18573.2626   501%     -  535s
H    0     0                    3163.4235587 18561.4525   487%     -  541s
     0     0 18561.4525    0  509 3163.42356 18561.4525   487%     -  542s
     0     0 18557.4278    0  511 3163.42356 18557.4278   487%     -  546s
     0     0 18552.3229    0  623 3163.42356 18552.3229   486%     -  550s
     0     0 18550.0331    0  503 3163.42356 18550.0331   486%     -  552s
     0     0 18474.4447    0  611 3163.42356 18474.4447   484%     -  567s
     0     0 18456.4637    0  399 3163.42356 18456.4637   483%     -  576s
     0     0 18445.7021    0  619 3163.42356 18445.7021   483%     -  583s
     0     0 18440.3604    0  555 3163.42356 18440.3604   483%     -  586s
     0     0 18438.2038    0  497 3163.42356 18438.2038   483%     -  588s
     0     0 18415.2544    0  553 3163.42356 18415.2544   482%     -  597s
H    0     0                    3220.1510515 18415.2227   472%     -  599s
H    0     0                    3223.8086457 18415.2227   471%     -  599s
H    0     0                    3275.6580821 18415.2227   462%     -  599s
     0     0 18409.4158    0  503 3275.65808 18409.4158   462%     -  604s
     0     0 18408.6573    0  508 3275.65808 18408.6573   462%     -  606s
     0     0 18382.6368    0  633 3275.65808 18382.6368   461%     -  617s
H    0     0                    3282.0948036 18382.3231   460%     -  618s
     0     0 18378.3894    0  419 3282.09480 18378.3894   460%     -  620s
     0     0 18377.5102    0  429 3282.09480 18377.5102   460%     -  622s
     0     0 18364.9209    0  629 3282.09480 18364.9209   460%     -  629s
     0     0 18357.4247    0  503 3282.09480 18357.4247   459%     -  637s
     0     0 18355.8874    0  494 3282.09480 18355.8874   459%     -  639s
     0     0 18351.3496    0  570 3282.09480 18351.3496   459%     -  644s
     0     0 18351.2897    0  570 3282.09480 18351.2897   459%     -  646s
H    0     0                    3369.8893744 18351.2897   445%     -  713s
H    0     0                    3385.6761578 18351.2897   442%     -  720s
H    0     0                    3538.6831491 18351.2897   419%     -  721s
     0     2 18351.2897    0  570 3538.68315 18351.2897   419%     -  723s
     1     3 18183.8377    1  402 3538.68315 18351.2897   419%  8022  732s
     2     4 18231.5676    1  415 3538.68315 18231.5676   415%  7220  740s
     3     7 17411.9146    2  621 3538.68315 18231.5450   415%  7263  753s
     6    11 16685.6147    3  325 3538.68315 18231.4779   415%  8760  776s
    10    22 16497.3012    3  390 3538.68315 18095.9778   411% 12387  798s
    21    33 16182.3576    4  382 3538.68315 17600.2339   397% 16719  854s
    32    65 16362.0288    5  413 3538.68315 17600.2339   397% 15454  926s
H   33    65                    3657.4008741 17600.2339   381% 14986  926s
    64    97 15998.0228    6  379 3657.40087 17335.3596   374% 19045 1049s
    96   245 15844.6122    7  380 3657.40087 17335.0709   374% 16677 1098s
   244   323 15624.2846   12  371 3657.40087 17335.0709   374%  9520 1121s
   322   381 15464.5791   14  373 3657.40087 17335.0709   374%  8483 1140s
   380   450 15356.2601   16  545 3657.40087 17335.0709   374%  7948 1157s
   449   509 15315.0241   18  487 3657.40087 17335.0709   374%  7443 1176s
   512   560 15273.4283   20  475 3657.40087 17335.0709   374%  7168 1194s
   569   592 14540.5829   21  466 3657.40087 17335.0709   374%  7185 1211s
   601   625 14261.2812   22  467 3657.40087 17335.0709   374%  7440 1227s
H  608   625                    3675.4301519 17335.0709   372%  7416 1227s
   642   651 6072.47540   27  197 3675.43015 17335.0709   372%  7503 1241s
   672   689 12594.5813   24  259 3675.43015 17335.0709   372%  7472 1255s
H  673   689                    3691.2798834 17335.0709   370%  7460 1255s
   716   761 11357.3711   25  194 3691.27988 17335.0709   370%  7419 1269s
   808   823 8983.48881   27  200 3691.27988 17335.0709   370%  7224 1283s
   886   879 infeasible   28      3691.27988 17138.9598   364%  7073 1302s
   982   915 infeasible   29      3691.27988 17138.9598   364%  6925 1318s
  1065   962 10519.6512   23  262 3691.27988 17138.9598   364%  6787 1335s
  1150  1029 infeasible   10      3691.27988 17138.9598   364%  6657 1354s
  1255  1096 6385.82503   31  146 3691.27988 17138.9598   364%  6534 1374s
  1362  1212 5049.04026   33  191 3691.27988 17138.9598   364%  6423 1392s
  1498  1316 4204.36827   37  130 3691.27988 17138.9598   364%  6225 1411s
  1653  1413 infeasible   28      3691.27988 16965.4336   360%  5960 1433s
H 1812  1438                    3720.5036195 16965.4336   356%  5760 1453s
  1845  1523 15835.3659    7  380 3720.50362 16965.4336   356%  5791 1477s
H 1852  1523                    3767.2459051 16965.4336   350%  5776 1477s
  1973  1662 14150.6344    8  233 3767.24591 16965.4336   350%  5665 1499s
  2181  1682 12112.3551   11  212 3767.24591 16718.1526   344%  5415 1520s
  2221  1693 9057.99055   12  160 3767.24591 16718.1526   344%  5426 1543s
  2270  1706 8337.32571   13  132 3767.24591 16718.1526   344%  5453 1568s
  2312  1734 infeasible   14      3767.24591 16718.1526   344%  5459 1592s
  2398  1764 infeasible   15      3767.24591 16718.1526   344%  5415 1615s
  2438  1806 7906.60574   13  155 3767.24591 16718.1526   344%  5469 1642s
  2506  1904 6796.02910   17  204 3767.24591 16718.1526   344%  5466 1668s
  2634  2000 6696.27605   18  186 3767.24591 16524.9070   339%  5372 1694s
  2782  2116 5257.72956   20  189 3767.24591 16524.9070   339%  5320 1722s
  2941  2255 5093.31106   22  165 3767.24591 16426.8447   336%  5274 1750s
  3130  2381 infeasible   24      3767.24591 16426.8447   336%  5213 1778s
  3322  2510 infeasible   42      3767.24591 16426.8447   336%  5124 1810s
  3531  2624 5185.45094   17  253 3767.24591 16426.8447   336%  5056 1842s
  3726  2775 4340.27846   19  211 3767.24591 16426.8447   336%  5055 1877s
  3931  2776 6319.31913   88  570 3767.24591 16276.8183   332%  5047 2101s
  3933  2777 13665.2027   26  187 3767.24591 16276.8183   332%  5045 2112s
  3934  2778 6353.51537   39  285 3767.24591 16276.8183   332%  5043 2176s
  3935  2779 14355.5486   22  393 3767.24591 16276.8183   332%  5042 2216s
  3936  2779 15158.2783   15  375 3767.24591 16276.8183   332%  5041 2252s
  3937  2780 15618.4331   12  495 3767.24591 16276.8183   332%  5040 2290s
  3938  2781 6398.39701   88  471 3767.24591 16276.8183   332%  5038 2312s
  3939  2781 13907.0687   21  533 3767.24591 16276.8183   332%  5037 2332s
  3940  2782 12761.8977   27  490 3767.24591 16276.8183   332%  5036 2344s
  3941  2783 3834.30589   39  490 3767.24591 16276.8183   332%  5034 2355s
  3942  2783 14313.0979   16  394 3767.24591 16276.8183   332%  5033 2365s
  3943  2784 6446.20427   88  407 3767.24591 16276.8183   332%  5032 2370s
  3944  2785 15360.7310    8  422 3767.24591 16276.8183   332%  5031 2375s
  3945  2785 13833.5296   31  534 3767.24591 16276.8183   332%  5029 2382s
  3946  2786 11711.3783   25  357 3767.24591 16276.8183   332%  5028 2388s
  3947  2787 6522.48511   44  485 3767.24591 16276.8183   332%  5027 2410s
  3948  2787 6199.37160  105  360 3767.24591 16276.8183   332%  5026 2420s
  3949  2788 15173.9851   21  422 3767.24591 16276.8183   332%  5024 2427s
  3950  2789 6106.46516   29  432 3767.24591 16276.8183   332%  5023 2433s
  3951  2789 15566.9643    7  423 3767.24591 16276.8183   332%  5022 2440s
  3952  2790 11620.0445   27  405 3767.24591 16276.8183   332%  5020 2454s
  3953  2791 4912.74605   53  408 3767.24591 16276.8183   332%  5019 2459s
  3954  2791 13684.5468   34  392 3767.24591 16276.8183   332%  5018 2464s
  3955  2792 4761.56553   23  486 3767.24591 16276.8183   332%  5017 2476s
  3956  2793 8891.51313   33  483 3767.24591 16276.8183   332%  5015 2482s
  3957  2793 9087.60537   27  482 3767.24591 16276.8183   332%  5014 2489s
  3958  2794 15199.7624   12  321 3767.24591 16276.8183   332%  5013 2493s
  3959  2795 4426.05197   89  487 3767.24591 16276.8183   332%  5012 2501s
  3960  2795 6453.44723   67  476 3767.24591 16276.8183   332%  5010 2506s
  3961  2796 15725.6089   11  410 3767.24591 16276.8183   332%  5009 2512s
  3962  2797 7535.00540   38  485 3767.24591 16276.8183   332%  5008 2516s
  3963  2797 6939.22087   84  484 3767.24591 16276.8183   332%  5007 2521s
  3965  2799 15746.9338    8  489 3767.24591 16276.8183   332%  5004 2528s
  3966  2799 5674.50982   58  484 3767.24591 16276.8183   332%  5003 2531s
  3967  2800 9645.59194   35  479 3767.24591 16276.8183   332%  5001 2536s
  3968  2801 14137.3109   23  479 3767.24591 16276.8183   332%  5000 2551s
  3969  2801 15298.8576   17  479 3767.24591 16276.8183   332%  4999 2595s
  3970  2804 16276.8183   14  277 3767.24591 16276.8183   332%  5095 2608s
  3971  2807 16030.2310   15  287 3767.24591 16276.8183   332%  5095 2635s
  3974  2812 15248.0128   16  282 3767.24591 16276.8183   332%  5095 2680s
  3980  2822 14942.4183   17  298 3767.24591 16276.8183   332%  5106 2732s
  3992  2830 15607.3077   17  311 3767.24591 16276.8183   332%  5155 2797s
  4004  2858 14574.8249   18  303 3767.24591 16276.8183   332%  5182 2869s
  4036  2978 12037.7537   19  330 3767.24591 16276.8183   332%  5282 2913s
  4171  2990 11865.5232   20  325 3767.24591 16276.8183   332%  5333 2937s
  4231  2991 11609.5669   22  317 3767.24591 16276.8183   332%  5337 2955s
  4288  2985 10913.6190   23  336 3767.24591 16276.8183   332%  5380 2983s
  4323  2992 10673.7561   24  322 3767.24591 16276.8183   332%  5422 3014s
  4377  2973 6918.06779   25  271 3767.24591 16276.8183   332%  5466 3061s
  4424  2965 6045.85766   26  256 3767.24591 16276.8183   332%  5531 3090s
  4453  2972 8890.15636   26  250 3767.24591 16276.8183   332%  5557 3111s
  4497  2969 5527.88307   27  219 3767.24591 16276.8183   332%  5579 3142s
  4524  2982 infeasible   26      3767.24591 16276.8183   332%  5608 3164s
  4564  2988 5274.20760   29  239 3767.24591 16276.8183   332%  5641 3186s
  4620  2992 4264.61757   27  244 3767.24591 16276.8183   332%  5662 3206s
  4682  2986 4543.77098   30  239 3767.24591 16276.8183   332%  5675 3226s
  4748  2984 4396.22910   31  202 3767.24591 16276.8183   332%  5692 3250s
  4808  2974 4365.20536   32  221 3767.24591 16276.8183   332%  5703 3272s
  4873  2970     cutoff   34      3767.24591 16276.8183   332%  5719 3300s
  4924  2976 4926.46065   34  185 3767.24591 16276.8183   332%  5752 3321s
  4958  2990     cutoff   35      3767.24591 16276.8183   332%  5795 3341s
  4999  2993 4162.99538   36  128 3767.24591 16276.8183   332%  5807 3363s
  5045  3005     cutoff   36      3767.24591 16059.7623   326%  5823 3384s
  5110  2999 infeasible   33      3767.24591 15920.7448   323%  5828 3407s
  5172  2991 4986.37627   20  311 3767.24591 15686.1127   316%  5859 3431s
  5230  3002 4960.65585   21  253 3767.24591 15686.1127   316%  5906 3458s
  5291  2993     cutoff   23      3767.24591 15686.1127   316%  5941 3483s
  5351  2991     cutoff   21      3767.24591 15686.1127   316%  5986 3516s
  5411  3021 8509.59427   39  250 3767.24591 15686.1127   316%  6024 3566s
  5496  3038 7983.69447   42  295 3767.24591 15686.1127   316%  6052 3597s
  5597  3009 7128.34898   47  210 3767.24591 15686.1127   316%  6074 3600s

Cutting planes:
  Gomory: 15
  Implied bound: 68
  Projected implied bound: 220
  MIR: 1886
  Mixing: 9
  Flow cover: 2769
  RLT: 71
  Relax-and-lift: 520

Explored 5608 nodes (34649408 simplex iterations) in 3600.04 seconds (8984.73 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3767.25 3720.5 3691.28 ... 3275.66

Time limit reached
Best objective 3.767245905100e+03, best bound 1.568611268330e+04, gap 316.3814%
  WARNING: Time limit reached. Using best solution found (gap: 316.38%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 3767.25, θ = 144715.43
  Upper Bound (UB) = 3767.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 144715.43
  [DEBUG]   ✓ Scenario 0: θ = 144715.43 ≤ Q = 144715.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 144715.43 ≤ Q = 144715.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 144715.43 ≤ Q = 144715.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 144715.43 ≤ Q = 144715.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 144715.43 ≤ Q = 144715.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 144715.43 ≤ Q = 144715.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 144715.43 ≤ Q = 144715.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 144715.43 ≤ Q = 144715.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 144715.43 ≤ Q = 144715.43 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 144715.43 ≤ Q = 144715.43 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 144715.43 ≤ Q = 144715.43 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 11] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x5c5bd73a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x5c5bd73a
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.139605e+13
Presolve removed 2617 rows and 1906 columns
Presolve time: 0.00s
Presolved: 476 rows, 483 columns, 1345 nonzeros
Found heuristic solution: objective 5494265.7811
Variable types: 326 continuous, 157 integer (157 binary)
Found heuristic solution: objective 5493379.0976

Root relaxation: objective -1.290943e+05, 230 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129094.31    0  117 5493379.10 -129094.31   102%     -    0s
H    0     0                    -87358.88803 -129094.31  47.8%     -    0s
H    0     0                    -97953.58907 -129094.31  31.8%     -    0s
H    0     0                    -99344.58499 -129094.31  29.9%     -    0s
H    0     0                    -99528.67901 -128892.55  29.5%     -    0s
     0     0 -109268.19    0  115 -99528.679 -109268.19  9.79%     -    0s
H    0     0                    -104578.0420 -109240.27  4.46%     -    0s
H    0     0                    -107387.8622 -109240.27  1.72%     -    0s
H    0     0                    -107758.7118 -109240.27  1.37%     -    0s
     0     0 -108492.30    0  110 -107758.71 -108492.30  0.68%     -    0s
     0     0 -108475.58    0  108 -107758.71 -108475.58  0.67%     -    0s
     0     0 -108474.96    0  108 -107758.71 -108474.96  0.66%     -    0s
H    0     0                    -107759.2514 -108474.96  0.66%     -    0s
     0     0 -108135.03    0   73 -107759.25 -108135.03  0.35%     -    0s
     0     0 -108132.41    0   63 -107759.25 -108132.41  0.35%     -    0s
     0     0 -108132.27    0   62 -107759.25 -108132.27  0.35%     -    0s
     0     0 -108065.58    0   61 -107759.25 -108065.58  0.28%     -    0s
     0     0 -108065.00    0   60 -107759.25 -108065.00  0.28%     -    0s
     0     0 -108060.01    0   59 -107759.25 -108060.01  0.28%     -    0s
     0     0 -107895.96    0   42 -107759.25 -107895.96  0.13%     -    0s
     0     0 -107893.58    0   40 -107759.25 -107893.58  0.12%     -    0s
H    0     0                    -107783.2336 -107890.63  0.10%     -    0s
     0     0 -107890.63    0   36 -107783.23 -107890.63  0.10%     -    0s
     0     0 -107847.76    0   32 -107783.23 -107847.76  0.06%     -    0s
     0     0 -107847.76    0   28 -107783.23 -107847.76  0.06%     -    0s
     0     0 -107847.76    0   28 -107783.23 -107847.76  0.06%     -    0s
     0     0 -107847.76    0   28 -107783.23 -107847.76  0.06%     -    0s
     0     0 -107847.76    0   23 -107783.23 -107847.76  0.06%     -    0s
     0     0 -107789.57    0    7 -107783.23 -107789.57  0.01%     -    0s
     0     0     cutoff    0      -107783.23 -107783.23  0.00%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 36
  Flow cover: 5
  RLT: 2

Explored 1 nodes (990 simplex iterations) in 0.09 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -107783 -107783 -107759 ... 5.49338e+06
No other solutions better than -107783

Optimal solution found (tolerance 1.00e-06)
Best objective -1.077832335543e+05, best bound -1.077832335543e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 135421.78
  Scenario: 47 demand increases, 13 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -107783.23
  [DEBUG]   S×d_nominal = 243205.01
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243205.01 + -107783.23 = 135421.78
  [DEBUG]   Current θ from Master = 144715.43
  [DEBUG]   ⚠️  Z_SP ≤ θ by 9293.65 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -5526.40
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2782.6211, Absolute Gap = 2782.6211, Relative Gap = 0.738635
  Not converged yet (gap = 2782.62 > ε = 200)

  [DEBUG] Adding NEW scenario 11 to Master Problem...
  [DEBUG] New scenario pattern: 47 increases, 13 decreases
    [DEBUG] Scenario 11 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 11 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 11]
    [DEBUG]   - Total constraints in model: 184863
    [DEBUG]   - Total variables in model: 77140
  [DEBUG] Total scenarios in Master: 12
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 12
================================================================================
[Iteration 12] Solving Master Problem...
  Current scenarios in Master: 12
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 184863 rows, 77140 columns and 524291 nonzeros
Model fingerprint: 0x827662f5
Variable types: 74881 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 84840 rows and 34440 columns
Presolve time: 1.50s
Presolved: 100023 rows, 42700 columns, 606239 nonzeros
Variable types: 40441 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -373460.5071
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.19s

Barrier statistics:
 Dense cols : 593
 AA' NZ     : 3.769e+06
 Factor NZ  : 8.671e+06 (roughly 130 MB of memory)
 Factor Ops : 1.595e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.72755718e+07  1.69398758e+08  9.71e+04 2.11e+01  7.66e+04     3s
   1  -1.31323730e+07  1.51940910e+08  6.78e+04 6.37e+01  5.28e+04     3s
   2  -6.41830048e+06  1.17418402e+08  3.20e+04 7.12e-01  2.61e+04     3s
   3  -1.10778820e+06  9.05316387e+07  3.21e+03 9.87e-01  2.99e+03     3s
   4  -5.10291492e+05  3.82329363e+07  3.97e+02 2.16e-01  4.86e+02     3s
   5  -4.38996455e+05  2.38796424e+07  2.34e+02 1.15e-01  2.80e+02     3s
   6  -3.59398060e+05  1.74727340e+07  1.10e+02 8.04e-02  1.60e+02     3s
   7  -2.53899455e+05  1.36485827e+07  4.75e+01 5.98e-02  1.00e+02     3s
   8  -1.41872340e+05  1.06509343e+07  1.20e+01 4.44e-02  6.42e+01     3s
   9  -1.17020082e+05  8.38493525e+06  8.09e+00 3.43e-02  4.94e+01     3s
  10  -9.06411304e+04  3.31961857e+06  4.46e+00 1.24e-02  1.94e+01     3s
  11  -5.80559361e+04  6.71825554e+05  2.26e+00 2.01e-03  4.09e+00     3s
  12  -3.10894520e+04  3.49682884e+05  1.48e+00 1.07e-03  2.12e+00     3s
  13  -2.20834980e+04  2.20644729e+05  1.12e+00 9.25e-04  1.35e+00     3s
  14  -1.26223935e+04  1.52823108e+05  7.94e-01 8.77e-04  9.14e-01     3s
  15  -3.55421532e+03  1.10605929e+05  5.80e-01 1.02e-03  6.29e-01     3s
  16   3.32071924e+03  9.19391316e+04  4.54e-01 2.09e-03  4.88e-01     3s
  17   8.40274431e+03  7.91315768e+04  3.66e-01 2.11e-03  3.89e-01     3s
  18   1.41484428e+04  6.71205845e+04  2.82e-01 2.31e-03  2.91e-01     4s
  19   1.79863153e+04  5.57711099e+04  2.25e-01 2.74e-03  2.08e-01     4s
  20   2.15676495e+04  5.05009212e+04  1.74e-01 1.99e-03  1.59e-01     4s
  21   2.46336115e+04  4.71858860e+04  1.32e-01 1.60e-03  1.24e-01     4s
  22   2.63555741e+04  4.46113524e+04  1.10e-01 1.47e-03  1.00e-01     4s
  23   2.68640531e+04  4.34318396e+04  1.04e-01 1.24e-03  9.10e-02     4s
  24   2.74051523e+04  4.29299136e+04  9.69e-02 1.22e-03  8.53e-02     4s
  25   2.82633704e+04  4.10072174e+04  8.64e-02 1.21e-03  7.00e-02     4s
  26   3.02456789e+04  4.05700495e+04  6.28e-02 1.06e-03  5.67e-02     4s
  27   3.13245638e+04  3.94804871e+04  5.00e-02 1.27e-03  4.48e-02     4s
  28   3.24896089e+04  3.85615597e+04  3.69e-02 1.02e-03  3.33e-02     4s
  29   3.34327371e+04  3.80058553e+04  2.67e-02 8.23e-04  2.51e-02     4s
  30   3.38296072e+04  3.73786708e+04  2.25e-02 7.19e-04  1.95e-02     4s
  31   3.42969232e+04  3.70463970e+04  1.76e-02 6.26e-04  1.51e-02     4s
  32   3.47147821e+04  3.68767899e+04  1.34e-02 5.14e-04  1.19e-02     4s
  33   3.49860253e+04  3.67785880e+04  1.06e-02 4.46e-04  9.84e-03     4s
  34   3.50649440e+04  3.65898532e+04  9.75e-03 4.04e-04  8.37e-03     4s
  35   3.52505574e+04  3.64501736e+04  7.89e-03 3.27e-04  6.59e-03     4s
  36   3.54381816e+04  3.63701201e+04  5.98e-03 2.51e-04  5.12e-03     5s
  37   3.56604469e+04  3.63039970e+04  3.76e-03 1.95e-04  3.53e-03     5s
  38   3.57430383e+04  3.62270449e+04  2.94e-03 1.29e-04  2.66e-03     5s
  39   3.58374626e+04  3.61800704e+04  2.05e-03 8.90e-05  1.88e-03     5s
  40   3.58921682e+04  3.61447601e+04  1.54e-03 6.65e-05  1.39e-03     5s
  41   3.59494797e+04  3.61166811e+04  1.02e-03 4.75e-05  9.18e-04     5s
  42   3.59700524e+04  3.61144315e+04  8.45e-04 4.50e-05  7.92e-04     5s
  43   3.59998436e+04  3.60912904e+04  5.81e-04 2.58e-05  5.02e-04     5s
  44   3.60104111e+04  3.60860010e+04  4.93e-04 1.89e-05  4.15e-04     5s
  45   3.60123517e+04  3.60858519e+04  4.76e-04 1.87e-05  4.04e-04     5s
  46   3.60148030e+04  3.60853923e+04  4.56e-04 1.81e-05  3.88e-04     5s
  47   3.60310489e+04  3.60792488e+04  3.14e-04 1.09e-05  2.65e-04     5s
  48   3.60452438e+04  3.60734960e+04  1.91e-04 5.11e-06  1.55e-04     5s
  49   3.60580100e+04  3.60715214e+04  7.99e-05 3.13e-06  7.41e-05     5s
  50   3.60662450e+04  3.60693847e+04  1.79e-05 4.07e-07  1.72e-05     5s
  51   3.60674034e+04  3.60692978e+04  9.85e-06 2.98e-07  1.04e-05     5s
  52   3.60677912e+04  3.60691574e+04  7.34e-06 1.72e-07  7.49e-06     6s
  53   3.60682399e+04  3.60690051e+04  4.43e-06 2.16e-08  4.20e-06     6s
  54   3.60688918e+04  3.60689710e+04  4.93e-07 4.83e-09  4.35e-07     6s
  55   3.60689694e+04  3.60689696e+04  5.95e-08 2.87e-09  1.04e-09     6s

Barrier solved model in 55 iterations and 5.67 seconds (9.01 work units)
Optimal objective 3.60689694e+04


Root crossover log...

   85960 DPushes remaining with DInf 0.0000000e+00                 6s
       0 DPushes remaining with DInf 0.0000000e+00                 7s

   10868 PPushes remaining with PInf 8.8460543e-05                 7s
       0 PPushes remaining with PInf 0.0000000e+00                 8s

  Push phase complete: Pinf 0.0000000e+00, Dinf 8.1191514e+04      8s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   48856    3.6068970e+04   0.000000e+00   8.119151e+04      8s
   49993    3.6068970e+04   0.000000e+00   0.000000e+00      9s
   49993    3.6068970e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.24s

Solved with barrier

Root relaxation: objective 3.606897e+04, 49993 iterations, 7.34 seconds (14.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36068.9696    0  268 -210461.39 36068.9696   117%     -    9s
H    0     0                    -207930.4184 36068.9696   117%     -    9s
H    0     0                    -169432.8672 36068.9696   121%     -   10s
H    0     0                    -155562.4717 36068.9696   123%     -   10s
H    0     0                    -152846.9618 36068.9696   124%     -   10s
H    0     0                    -151626.1787 36068.9696   124%     -   11s
H    0     0                    -151611.0036 36068.9696   124%     -   11s
H    0     0                    -148872.8009 36068.9696   124%     -   11s
H    0     0                    -146455.0801 36068.9696   125%     -   11s
H    0     0                    -146454.4143 36068.9696   125%     -   11s
H    0     0                    -146453.1136 36068.9696   125%     -   11s
H    0     0                    -145690.0321 36068.9696   125%     -   11s
H    0     0                    -56599.07916 36068.9696   164%     -   11s
H    0     0                    -56412.42265 36068.9696   164%     -   11s
H    0     0                    -16538.91156 36068.9696   318%     -   11s
H    0     0                    -16355.79518 36068.9696   321%     -   12s
H    0     0                    -15653.37410 36068.9696   330%     -   12s
H    0     0                    -14404.59096 36068.9696   350%     -   12s
H    0     0                    -12655.09249 36068.9696   385%     -   12s
H    0     0                    -11775.83771 36068.9696   406%     -   12s
H    0     0                    -11441.01196 36068.9696   415%     -   12s
H    0     0                    -11000.38710 36068.9696   428%     -   13s
H    0     0                    -7940.887099 36068.9696   554%     -   13s
H    0     0                    -7791.379564 36068.9696   563%     -   13s
     0     0 30413.2481    0  329 -7791.3796 30413.2481   490%     -   49s
H    0     0                    -7119.381007 30413.2481   527%     -   50s
H    0     0                    -5165.104114 30413.2481   689%     -   50s
H    0     0                    -5060.930257 30413.2481   701%     -   50s
H    0     0                    -5037.769240 30413.2481   704%     -   50s
     0     0 29550.9514    0  328 -5037.7692 29550.9514   687%     -   76s
     0     0 29476.7083    0  389 -5037.7692 29476.7083   685%     -   90s
     0     0 29476.7083    0  387 -5037.7692 29476.7083   685%     -   97s
     0     0 29476.7083    0  235 -5037.7692 29476.7083   685%     -  100s
     0     0 29476.7083    0  248 -5037.7692 29476.7083   685%     -  101s
     0     0 29476.7083    0  250 -5037.7692 29476.7083   685%     -  102s
     0     0 29476.7083    0  233 -5037.7692 29476.7083   685%     -  102s
H    0     0                    -1349.564011 26869.2391  2091%     -  141s
H    0     0                    -1053.935055 26869.2391  2649%     -  141s
H    0     0                    -679.9721346 26869.2391  4052%     -  141s
H    0     0                    -661.9742785 26869.2391  4159%     -  141s
H    0     0                    -442.1266737 26869.2391  6177%     -  141s
     0     0 26869.2391    0  322 -442.12667 26869.2391  6177%     -  141s
H    0     0                     -60.2978355 26869.2077      -     -  141s
H    0     0                     -13.3136197 26869.2077      -     -  142s
H    0     0                      63.6443737 26869.2077      -     -  142s
H    0     0                      93.7440480 26869.2077      -     -  142s
     0     0 25819.9943    0  461   93.74405 25819.9943      -     -  179s
     0     0 25576.2969    0  472   93.74405 25576.2969      -     -  214s
     0     0 25300.1672    0  482   93.74405 25300.1672      -     -  249s
     0     0 25277.0254    0  487   93.74405 25277.0254      -     -  261s
H    0     0                     234.8297875 25199.5328      -     -  277s
     0     0 25199.5328    0  471  234.82979 25199.5328      -     -  277s
H    0     0                     500.9911740 25133.6920  4917%     -  290s
H    0     0                     516.1897987 25133.6920  4769%     -  290s
     0     0 25133.6920    0  477  516.18980 25133.6920  4769%     -  293s
     0     0 25115.1155    0  482  516.18980 25115.1155  4765%     -  299s
     0     0 25105.7822    0  491  516.18980 25105.7822  4764%     -  301s
     0     0 25100.0652    0  483  516.18980 25100.0652  4763%     -  305s
     0     0 25099.6177    0  483  516.18980 25099.6177  4762%     -  306s
H    0     0                     583.6202340 22294.7225  3720%     -  390s
H    0     0                    1804.3217873 22294.7225  1136%     -  390s
H    0     0                    2002.0987359 22294.7225  1014%     -  390s
H    0     0                    2290.2436820 22294.7225   873%     -  390s
H    0     0                    2320.5980137 22294.7225   861%     -  390s
H    0     0                    2646.5668105 22294.7225   742%     -  390s
H    0     0                    2696.6799509 22294.7225   727%     -  390s
     0     0 22294.7225    0  385 2696.67995 22294.7225   727%     -  390s
     0     0 21676.4367    0  502 2696.67995 21676.4367   704%     -  428s
H    0     0                    2763.3382790 21364.0881   673%     -  455s
H    0     0                    2765.1757662 21364.0881   673%     -  455s
     0     0 21364.0881    0  513 2765.17577 21364.0881   673%     -  455s
H    0     0                    2957.3610059 21268.0281   619%     -  472s
H    0     0                    3021.3396650 21268.0281   604%     -  472s
     0     0 21268.0281    0  526 3021.33966 21268.0281   604%     -  472s
     0     0 21170.8398    0  389 3021.33966 21170.8398   601%     -  489s
     0     0 21131.2617    0  521 3021.33966 21131.2617   599%     -  502s
H    0     0                    3149.2923489 21116.0588   571%     -  512s
H    0     0                    3153.4109348 21116.0588   570%     -  512s
     0     0 21116.0588    0  403 3153.41093 21116.0588   570%     -  512s
     0     0 21094.8074    0  456 3153.41093 21094.8074   569%     -  521s
H    0     0                    3216.1506994 21080.6494   555%     -  526s
     0     0 21080.6494    0  454 3216.15070 21080.6494   555%     -  526s
     0     0 21067.3598    0  457 3216.15070 21067.3598   555%     -  532s
     0     0 21056.5038    0  458 3216.15070 21056.5038   555%     -  538s
     0     0 21049.0395    0  454 3216.15070 21049.0395   554%     -  542s
     0     0 21044.5589    0  455 3216.15070 21044.5589   554%     -  544s
     0     0 21043.2644    0  463 3216.15070 21043.2644   554%     -  545s
H    0     0                    3229.3148602 19910.5219   517%     -  632s
     0     0 19910.5219    0  539 3229.31486 19910.5219   517%     -  632s
     0     0 19587.9599    0  562 3229.31486 19587.9599   507%     -  664s
     0     0 19490.6374    0  568 3229.31486 19490.6374   504%     -  688s
     0     0 19385.6586    0  562 3229.31486 19385.6586   500%     -  703s
     0     0 19342.5236    0  571 3229.31486 19342.5236   499%     -  716s
     0     0 19318.4971    0  567 3229.31486 19318.4971   498%     -  727s
     0     0 19307.1268    0  564 3229.31486 19307.1268   498%     -  733s
     0     0 19261.7528    0  554 3229.31486 19261.7528   496%     -  743s
     0     0 19252.5391    0  542 3229.31486 19252.5391   496%     -  750s
     0     0 19244.2677    0  548 3229.31486 19244.2677   496%     -  758s
     0     0 19224.5777    0  561 3229.31486 19224.5777   495%     -  765s
     0     0 19218.5463    0  560 3229.31486 19218.5463   495%     -  768s
     0     0 19209.9087    0  563 3229.31486 19209.9087   495%     -  771s
     0     0 19200.6246    0  557 3229.31486 19200.6246   495%     -  776s
     0     0 19193.7940    0  564 3229.31486 19193.7940   494%     -  780s
     0     0 19192.9607    0  574 3229.31486 19192.9607   494%     -  782s
     0     0 18900.1295    0  431 3229.31486 18900.1295   485%     -  809s
H    0     0                    3232.5507378 18786.6384   481%     -  825s
     0     0 18786.6384    0  482 3232.55074 18786.6384   481%     -  825s
     0     0 18746.9495    0  581 3232.55074 18746.9495   480%     -  836s
     0     0 18736.1477    0  426 3232.55074 18736.1477   480%     -  843s
     0     0 18716.0524    0  420 3232.55074 18716.0524   479%     -  848s
     0     0 18706.1348    0  575 3232.55074 18706.1348   479%     -  854s
     0     0 18702.8251    0  434 3232.55074 18702.8251   479%     -  856s
     0     0 18697.9005    0  432 3232.55074 18697.9005   478%     -  859s
     0     0 18696.5826    0  514 3232.55074 18696.5826   478%     -  862s
     0     0 18532.1725    0  433 3232.55074 18532.1725   473%     -  885s
H    0     0                    3239.0640256 18532.1515   472%     -  889s
     0     0 18489.9159    0  574 3239.06403 18489.9159   471%     -  903s
     0     0 18463.2961    0  595 3239.06403 18463.2961   470%     -  914s
     0     0 18456.0462    0  644 3239.06403 18456.0462   470%     -  920s
     0     0 18452.8876    0  607 3239.06403 18452.8876   470%     -  924s
     0     0 18451.3879    0  652 3239.06403 18451.3879   470%     -  926s
     0     0 18376.4147    0  497 3239.06403 18376.4147   467%     -  944s
     0     0 18361.8958    0  686 3239.06403 18361.8958   467%     -  953s
     0     0 18353.3136    0  644 3239.06403 18353.3136   467%     -  958s
H    0     0                    3354.1116128 18346.8971   447%     -  965s
     0     0 18346.8971    0  648 3354.11161 18346.8971   447%     -  965s
     0     0 18341.8905    0  515 3354.11161 18341.8905   447%     -  969s
     0     0 18336.6135    0  527 3354.11161 18336.6135   447%     -  973s
     0     0 18318.7200    0  523 3354.11161 18318.7200   446%     -  980s
     0     0 18313.7694    0  526 3354.11161 18313.7694   446%     -  985s
     0     0 18313.2617    0  648 3354.11161 18313.2617   446%     -  987s
     0     0 18263.7621    0  609 3354.11161 18263.7621   445%     - 1002s
     0     0 18256.5860    0  574 3354.11161 18256.5860   444%     - 1008s
     0     0 18251.6067    0  519 3354.11161 18251.6067   444%     - 1011s
     0     0 18250.8509    0  575 3354.11161 18250.8509   444%     - 1013s
     0     0 18228.6967    0  581 3354.11161 18228.6967   443%     - 1021s
H    0     0                    3355.9491000 18228.6914   443%     - 1022s
     0     0 18222.6296    0  522 3355.94910 18222.6296   443%     - 1025s
     0     0 18219.6374    0  518 3355.94910 18219.6374   443%     - 1028s
     0     0 18218.7922    0  515 3355.94910 18218.7922   443%     - 1030s
     0     0 18210.6811    0  592 3355.94910 18210.6811   443%     - 1036s
H    0     0                    3357.2722319 18210.6700   442%     - 1046s
     0     0 18209.2527    0  523 3357.27223 18209.2527   442%     - 1048s
     0     0 18202.5434    0  520 3357.27223 18202.5434   442%     - 1053s
     0     0 18199.8354    0  589 3357.27223 18199.8354   442%     - 1057s
     0     0 18193.0647    0  572 3357.27223 18193.0647   442%     - 1062s
     0     0 18192.7203    0  572 3357.27223 18192.7203   442%     - 1065s
H    0     0                    3372.0583054 18192.7203   440%     - 1218s
     0     2 18192.7203    0  572 3372.05831 18192.7203   440%     - 1259s
     1     4 18174.5451    1  508 3372.05831 18192.7203   440%  3378 1275s
     3     8 17982.0938    2  562 3372.05831 18174.5295   439% 10346 1298s
     7    16 17903.2747    3  515 3372.05831 17981.9834   433% 12424 1321s
    15    31 17605.3289    4  572 3372.05831 17901.6247   431% 13695 1357s
    30    46 16983.9292    5  577 3372.05831 17893.4022   431% 20277 1486s
    45    76 17066.4208    5  496 3372.05831 17605.3239   422% 18042 1563s
H   46    76                    3380.0627077 17605.3239   421% 17650 1563s
H   48    76                    3490.2261701 17605.3239   404% 17703 1563s
H   50    76                    3525.4372053 17605.3239   399% 17610 1563s
    75   147 16838.5777    6  486 3525.43721 17605.3239   399% 16352 1628s
   146   240 16741.8375    7  538 3525.43721 17605.3239   399% 12046 1676s
   239   313 16686.6649   10  586 3525.43721 17605.3239   399%  9336 1709s
   312   375 16622.5727   12  579 3525.43721 17605.3239   399%  8633 1735s
   374   446 15826.2870   13  513 3525.43721 17605.3239   399%  8252 1762s
   449   494 15940.4836   13  501 3525.43721 17605.3239   399%  8227 1783s
   501   556 9703.11446   17  228 3525.43721 17605.3239   399%  8060 1804s
   579   617 8262.55272   18  205 3525.43721 17605.3239   399%  7912 1827s
   662   677 infeasible   19      3525.43721 17605.3239   399%  7705 1847s
   754   702 6508.71737   20  214 3525.43721 17605.3239   399%  7384 1866s
   785   728     cutoff   21      3525.43721 17605.3239   399%  7366 1887s
   823   751 5139.17380   21  134 3525.43721 17605.3239   399%  7317 1905s
H  832   751                    3530.0898580 17605.3239   399%  7328 1905s
   858   847 4681.87181   22  132 3530.08986 17605.3239   399%  7252 1924s
   976   910 4396.09709   25  134 3530.08986 17605.3239   399%  6849 1941s
  1077   933 infeasible   27      3530.08986 17605.3239   399%  6580 1958s
  1185   943     cutoff   26      3530.08986 17605.3239   399%  6352 1979s
  1291   942     cutoff   17      3530.08986 17605.3239   399%  6120 2002s
  1379   969 7329.24793   19  232 3530.08986 17605.3239   399%  6044 2023s
  1473  1060 5610.52821   20  204 3530.08986 17605.3239   399%  5966 2047s
  1606  1112 infeasible   21      3530.08986 17605.3239   399%  5705 2070s
H 1619  1112                    3549.7963721 17605.3239   396%  5709 2070s
  1688  1205 11484.8862    8  222 3549.79637 17605.3239   396%  5592 2095s
  1871  1223 4604.13624   10  202 3549.79637 17605.3239   396%  5246 2121s
  1993  1237 4240.44406   11  208 3549.79637 17605.3239   396%  5139 2149s
  2069  1250 15069.3932   12  333 3549.79637 17605.3239   396%  5193 2180s
H 2133  1261                    3560.0575620 17605.3239   395%  5248 2212s
H 2137  1261                    3564.0648814 17605.3239   394%  5254 2212s
H 2142  1261                    3802.0193923 17605.3239   363%  5286 2212s
  2166  1291 4268.12893   11  250 3802.01939 17605.3239   363%  5358 2244s
  2230  1319 6646.65115   11  265 3802.01939 17605.3239   363%  5458 2279s
  2296  1319 infeasible   13      3802.01939 17605.3239   363%  5561 2313s
  2354  1345 16680.7236    7  512 3802.01939 17605.3239   363%  5678 2347s
  2416  1359 14711.5579    8  302 3802.01939 17605.3239   363%  5858 2380s
H 2422  1359                    3846.8929927 17605.3239   358%  5886 2380s
  2452  1378 9103.47859    9  362 3846.89299 17605.3239   358%  5979 2415s
H 2464  1378                    3861.1615019 17605.3239   356%  6006 2415s
  2489  1405 12228.5521    9  323 3861.16150 17605.3239   356%  6107 2450s
  2560  1413 4480.81246   10  298 3861.16150 17605.3239   356%  6296 2487s
H 2571  1413                    3888.0951945 17605.3239   353%  6328 2487s
  2598  1469 7715.06228   10  354 3888.09519 17605.3239   353%  6452 2525s
  2706  1494 6120.71521   12  457 3888.09519 17605.3239   353%  6517 2560s
H 2707  1494                    3894.2228135 17605.3239   352%  6515 2560s
  2761  1568 7066.69789   12  470 3894.22281 17605.3239   352%  6561 2599s
  2927  1584 6991.11909   13  412 3894.22281 17605.3239   352%  6541 2639s
  2975  1610 6592.45526   14  441 3894.22281 17605.3239   352%  6630 2680s
  3061  1645 6093.15112   15  414 3894.22281 17605.3239   352%  6705 2728s
  3140  1727 5236.64194   17  396 3894.22281 17605.3239   352%  6885 2771s
  3254  1712 4623.09876   21  393 3894.22281 17605.3239   352%  7016 2813s
  3308  1735 4490.54354   22  393 3894.22281 17605.3239   352%  7091 2856s
  3413  1767 infeasible   24      3894.22281 17605.3239   352%  7136 2912s
  3501  1845 15694.8613   13  530 3894.22281 17605.3239   352%  7281 2966s
  3614  1903 13636.7182   14  449 3894.22281 16842.1600   332%  7381 3021s
  3724  1948 9159.38085   15  450 3894.22281 16842.1600   332%  7485 3080s
  3832  1987 8624.08387   17  341 3894.22281 16842.1600   332%  7657 3138s
  3961  2066     cutoff   18      3894.22281 16624.3235   327%  7778 3198s
  4092  2138 14146.4417   13  505 3894.22281 16583.6021   326%  7936 3266s
  4230  2210 14078.0709   14  488 3894.22281 16583.6021   326%  8062 3331s
  4370  2270 13002.1438   16  588 3894.22281 16583.6021   326%  8208 3401s
  4535  2341 6658.14769   17  354 3894.22281 16498.3589   324%  8294 3472s
  4730  2387 infeasible   20      3894.22281 16482.0656   323%  8365 3549s
  4914  2409 infeasible   17      3894.22281 16482.0656   323%  8497 3600s

Cutting planes:
  Learned: 2
  Gomory: 8
  Implied bound: 273
  MIR: 3263
  Flow cover: 3665
  RLT: 121
  Relax-and-lift: 1580

Explored 5022 nodes (44051621 simplex iterations) in 3600.06 seconds (9028.72 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3894.22 3888.1 3861.16 ... 3525.44

Time limit reached
Best objective 3.894222813482e+03, best bound 1.643678372040e+04, gap 322.0812%
  WARNING: Time limit reached. Using best solution found (gap: 322.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.07s
  Master Objective (UB) = 3894.22, θ = 145349.42
  Upper Bound (UB) = 3894.22

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145349.42
  [DEBUG]   ✓ Scenario 0: θ = 145349.42 ≤ Q = 145349.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145349.42 ≤ Q = 145349.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145349.42 ≤ Q = 145349.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145349.42 ≤ Q = 145349.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145349.42 ≤ Q = 145349.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145349.42 ≤ Q = 145349.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145349.42 ≤ Q = 145349.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145349.42 ≤ Q = 145349.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145349.42 ≤ Q = 145349.42 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145349.42 ≤ Q = 145349.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145349.42 ≤ Q = 145349.42 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145349.42 ≤ Q = 145349.42 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 12] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3296df88
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xcd692078
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [9e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-13, 2e+02]
Found heuristic solution: objective 1.153842e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5782204.5476
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.274062e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127406.24    0  122 5782204.55 -127406.24   102%     -    0s
H    0     0                    -95449.78051 -127406.24  33.5%     -    0s
H    0     0                    -95825.17207 -127406.24  33.0%     -    0s
     0     0 -101917.01    0   78 -95825.172 -101917.01  6.36%     -    0s
H    0     0                    -100057.1491 -101915.92  1.86%     -    0s
H    0     0                    -100278.4962 -101915.92  1.63%     -    0s
H    0     0                    -100479.4232 -101915.92  1.43%     -    0s
     0     0 -101419.43    0   53 -100479.42 -101419.43  0.94%     -    0s
H    0     0                    -100962.6977 -101351.44  0.39%     -    0s
     0     0 -101351.44    0   48 -100962.70 -101351.44  0.39%     -    0s
     0     0 -101342.43    0   47 -100962.70 -101342.43  0.38%     -    0s
     0     0 -101341.73    0   46 -100962.70 -101341.73  0.38%     -    0s
     0     0 -101337.06    0   52 -100962.70 -101337.06  0.37%     -    0s
     0     0 -101318.75    0   51 -100962.70 -101318.75  0.35%     -    0s
     0     0 -101314.12    0   50 -100962.70 -101314.12  0.35%     -    0s
     0     0 -101313.90    0   49 -100962.70 -101313.90  0.35%     -    0s
     0     0 -101108.19    0   18 -100962.70 -101108.19  0.14%     -    0s
     0     0 -101102.86    0   16 -100962.70 -101102.86  0.14%     -    0s
H    0     0                    -100975.7266 -101094.62  0.12%     -    0s
     0     0 -101092.24    0   14 -100975.73 -101092.24  0.12%     -    0s
     0     0 -101087.23    0    9 -100975.73 -101087.23  0.11%     -    0s
     0     0 -101043.21    0   10 -100975.73 -101043.21  0.07%     -    0s
     0     0 -101043.21    0   37 -100975.73 -101043.21  0.07%     -    0s
     0     0 -101006.34    0    7 -100975.73 -101006.34  0.03%     -    0s
     0     0 -101002.87    0    6 -100975.73 -101002.87  0.03%     -    0s
H    0     0                    -100995.6896 -101002.87  0.01%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 5
  MIR: 32
  Flow cover: 5
  RLT: 1

Explored 1 nodes (664 simplex iterations) in 0.08 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -100996 -100976 -100963 ... 5.7822e+06
No other solutions better than -100996

Optimal solution found (tolerance 1.00e-06)
Best objective -1.009956896158e+05, best bound -1.009956896158e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 142309.08
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -100995.69
  [DEBUG]   S×d_nominal = 243304.77
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243304.77 + -100995.69 = 142309.08
  [DEBUG]   Current θ from Master = 145349.42
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3040.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 853.88
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2909.5980, Absolute Gap = 2909.5980, Relative Gap = 0.747158
  Not converged yet (gap = 2909.60 > ε = 200)

  [DEBUG] Adding NEW scenario 12 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 12 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 12 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 12]
    [DEBUG]   - Total constraints in model: 200153
    [DEBUG]   - Total variables in model: 83380
  [DEBUG] Total scenarios in Master: 13
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 13
================================================================================
[Iteration 13] Solving Master Problem...
  Current scenarios in Master: 13
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 200153 rows, 83380 columns and 567522 nonzeros
Model fingerprint: 0x682e35f6
Variable types: 81121 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 91910 rows and 37310 columns
Presolve time: 1.65s
Presolved: 108243 rows, 46070 columns, 654063 nonzeros
Variable types: 43811 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372912.9578
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.23s

Barrier statistics:
 Dense cols : 586
 AA' NZ     : 4.305e+06
 Factor NZ  : 1.075e+07 (roughly 150 MB of memory)
 Factor Ops : 3.110e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.78245956e+07  1.81085672e+08  1.00e+05 2.00e+01  7.84e+04     3s
   1  -1.36052688e+07  1.63236382e+08  7.00e+04 6.35e+01  5.41e+04     3s
   2  -6.84033626e+06  1.26444595e+08  3.39e+04 8.36e-01  2.75e+04     3s
   3  -1.16804978e+06  9.82587829e+07  3.46e+03 1.85e+00  3.17e+03     3s
   4  -5.21808987e+05  4.61721334e+07  4.07e+02 2.30e-01  5.20e+02     3s
   5  -4.54548403e+05  2.79207799e+07  2.47e+02 1.13e-01  2.98e+02     3s
   6  -3.71978501e+05  2.10312297e+07  1.04e+02 7.65e-02  1.69e+02     3s
   7  -2.95185447e+05  1.56471550e+07  5.47e+01 5.39e-02  1.09e+02     3s
   8  -1.61300463e+05  1.10882334e+07  1.38e+01 3.52e-02  6.26e+01     3s
   9  -1.19857655e+05  6.20384177e+06  8.27e+00 1.85e-02  3.41e+01     3s
  10  -8.63679024e+04  3.42411144e+06  3.70e+00 9.71e-03  1.83e+01     4s
  11  -6.60260380e+04  2.80764205e+06  2.23e+00 7.92e-03  1.48e+01     4s
  12  -3.40580846e+04  6.33802748e+05  6.90e-01 1.63e-03  3.40e+00     4s
  13  -2.32394068e+04  4.07183185e+05  5.14e-01 1.40e-03  2.18e+00     4s
  14  -1.24816695e+04  2.18818309e+05  3.44e-01 2.01e-03  1.17e+00     4s
  15  -7.88446170e+03  1.68539103e+05  2.71e-01 1.30e-03  8.93e-01     4s
  16  -7.27978353e+01  1.25703738e+05  2.01e-01 1.21e-03  6.36e-01     4s
  17   4.51320775e+03  1.06770220e+05  1.68e-01 1.46e-03  5.17e-01     4s
  18   9.02042889e+03  9.04705946e+04  1.40e-01 1.45e-03  4.12e-01     4s
  19   1.45271657e+04  6.65977253e+04  1.05e-01 2.24e-03  2.63e-01     4s
  20   1.80304525e+04  6.06910862e+04  8.58e-02 2.77e-03  2.16e-01     4s
  21   2.02048133e+04  5.29186099e+04  7.46e-02 2.49e-03  1.65e-01     4s
  22   2.36595763e+04  4.97354448e+04  5.69e-02 2.77e-03  1.32e-01     4s
  23   2.57790493e+04  4.62048878e+04  4.66e-02 2.88e-03  1.03e-01     4s
  24   2.74520575e+04  4.53873574e+04  3.86e-02 2.64e-03  9.07e-02     4s
  25   2.84175325e+04  4.28985016e+04  3.42e-02 2.39e-03  7.32e-02     4s
  26   2.96010035e+04  4.14840748e+04  2.88e-02 1.90e-03  6.01e-02     4s
  27   3.04251036e+04  4.04966376e+04  2.51e-02 1.54e-03  5.09e-02     5s
  28   3.12804030e+04  3.96592484e+04  2.15e-02 1.23e-03  4.24e-02     5s
  29   3.17430997e+04  3.92669457e+04  1.96e-02 1.06e-03  3.81e-02     5s
  30   3.27785935e+04  3.87968557e+04  1.53e-02 8.74e-04  3.04e-02     5s
  31   3.34740789e+04  3.84139060e+04  1.25e-02 6.72e-04  2.50e-02     5s
  32   3.42637197e+04  3.79210935e+04  9.25e-03 4.79e-04  1.85e-02     5s
  33   3.48290227e+04  3.76338934e+04  6.99e-03 3.52e-04  1.42e-02     5s
  34   3.53039924e+04  3.74572481e+04  5.09e-03 3.09e-04  1.09e-02     5s
  35   3.54478420e+04  3.72190566e+04  4.54e-03 2.16e-04  8.96e-03     5s
  36   3.56187933e+04  3.71955822e+04  3.91e-03 2.05e-04  7.97e-03     5s
  37   3.58004061e+04  3.70969938e+04  3.21e-03 1.66e-04  6.56e-03     5s
  38   3.59351546e+04  3.70235213e+04  2.70e-03 1.37e-04  5.50e-03     5s
  39   3.60379597e+04  3.69413578e+04  2.32e-03 1.04e-04  4.57e-03     5s
  40   3.60796264e+04  3.69201756e+04  2.16e-03 9.38e-05  4.25e-03     5s
  41   3.62164841e+04  3.68615788e+04  1.65e-03 7.03e-05  3.26e-03     5s
  42   3.62965357e+04  3.68292588e+04  1.35e-03 5.65e-05  2.69e-03     6s
  43   3.63841465e+04  3.67796141e+04  1.05e-03 4.08e-05  2.00e-03     6s
  44   3.64476339e+04  3.67552462e+04  8.18e-04 2.95e-05  1.56e-03     6s
  45   3.64896246e+04  3.67396603e+04  6.63e-04 2.25e-05  1.26e-03     6s
  46   3.65514649e+04  3.67332564e+04  4.49e-04 1.98e-05  9.19e-04     6s
  47   3.66106640e+04  3.67228842e+04  2.46e-04 1.52e-05  5.67e-04     6s
  48   3.66369788e+04  3.67108218e+04  1.57e-04 9.89e-06  3.73e-04     6s
  49   3.66717631e+04  3.66949902e+04  4.12e-05 3.33e-06  1.17e-04     6s
  50   3.66821105e+04  3.66893918e+04  1.29e-05 9.77e-07  3.68e-05     6s
  51   3.66846497e+04  3.66877172e+04  5.83e-06 3.06e-07  1.55e-05     6s
  52   3.66859366e+04  3.66869969e+04  2.38e-06 2.97e-08  5.36e-06     6s
  53   3.66868673e+04  3.66868907e+04  8.98e-08 1.77e-07  1.18e-07     6s
  54   3.66868888e+04  3.66868888e+04  8.52e-10 1.83e-10  2.65e-10     6s

Barrier solved model in 54 iterations and 6.49 seconds (10.36 work units)
Optimal objective 3.66868888e+04


Root crossover log...

   93444 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 8s

    3987 PPushes remaining with PInf 2.2848906e-05                 8s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 1.9354956e+03      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   39925    3.6686889e+04   0.000000e+00   1.935496e+03      9s
   40056    3.6686889e+04   0.000000e+00   0.000000e+00      9s
   40056    3.6686889e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.668689e+04, 40056 iterations, 6.49 seconds (12.13 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 36686.8888    0  255 -210461.39 36686.8888   117%     -    9s
H    0     0                    -207071.3091 36686.8888   118%     -    9s
H    0     0                    -100161.2324 36686.8888   137%     -    9s
H    0     0                    -82827.72043 36686.8888   144%     -    9s
H    0     0                    -77235.23247 36686.8888   148%     -    9s
H    0     0                    -77119.01075 36686.8888   148%     -    9s
H    0     0                    -76619.72581 36686.8888   148%     -    9s
H    0     0                    -43612.98037 36686.8888   184%     -    9s
H    0     0                    -43596.40797 36686.8888   184%     -    9s
H    0     0                    -25516.00794 36686.8888   244%     -    9s
H    0     0                    -25230.35500 36686.8888   245%     -    9s
H    0     0                    -6211.877917 36686.8888   691%     -    9s
H    0     0                    -4973.173428 36686.8888   838%     -   10s
H    0     0                    -4878.738102 36686.8888   852%     -   10s
H    0     0                    -4873.982468 36686.8888   853%     -   10s
H    0     0                     821.1972411 36686.8888  4367%     -   11s
H    0     0                     930.2571075 36686.8888  3844%     -   11s
H    0     0                     969.8438153 36686.8888  3683%     -   11s
     0     0 31701.1610    0  354  969.84382 31701.1610  3169%     -   34s
H    0     0                    1818.7191516 31700.8659  1643%     -   34s
H    0     0                    1876.5288456 31700.8659  1589%     -   35s
     0     0 31357.9418    0  347 1876.52885 31357.9418  1571%     -   48s
     0     0 31163.2692    0  351 1876.52885 31163.2692  1561%     -   61s
     0     0 31084.4335    0  346 1876.52885 31084.4335  1556%     -   63s
     0     0 30952.1403    0  342 1876.52885 30952.1403  1549%     -   69s
     0     0 30940.2025    0  344 1876.52885 30940.2025  1549%     -   70s
     0     0 30914.8038    0  334 1876.52885 30914.8038  1547%     -   71s
     0     0 30902.4691    0  340 1876.52885 30902.4691  1547%     -   76s
     0     0 30896.0232    0  332 1876.52885 30896.0232  1546%     -   76s
     0     0 30896.0232    0  332 1876.52885 30896.0232  1546%     -   77s
     0     0 27061.8006    0  430 1876.52885 27061.8006  1342%     -  151s
H    0     0                    2025.7643987 27061.7974  1236%     -  152s
H    0     0                    2169.1154726 27061.7974  1148%     -  152s
H    0     0                    2186.5447683 27061.7974  1138%     -  152s
H    0     0                    2197.0983620 27061.7974  1132%     -  152s
H    0     0                    2216.2340908 27061.7974  1121%     -  152s
H    0     0                    2241.9137270 27061.7974  1107%     -  152s
     0     0 26476.9637    0  454 2241.91373 26476.9637  1081%     -  196s
     0     0 26304.9886    0  416 2241.91373 26304.9886  1073%     -  215s
     0     0 26168.8631    0  467 2241.91373 26168.8631  1067%     -  233s
     0     0 26132.3531    0  453 2241.91373 26132.3531  1066%     -  243s
     0     0 26099.4393    0  457 2241.91373 26099.4393  1064%     -  251s
     0     0 26035.2708    0  458 2241.91373 26035.2708  1061%     -  264s
H    0     0                    2377.6559321 25992.3041   993%     -  273s
H    0     0                    2505.4732466 25992.3041   937%     -  273s
H    0     0                    2556.9899836 25992.3041   917%     -  273s
H    0     0                    2566.8736500 25992.3041   913%     -  273s
     0     0 25992.3041    0  457 2566.87365 25992.3041   913%     -  273s
     0     0 25908.5770    0  447 2566.87365 25908.5770   909%     -  289s
     0     0 25878.9485    0  456 2566.87365 25878.9485   908%     -  293s
     0     0 25851.8070    0  461 2566.87365 25851.8070   907%     -  300s
     0     0 25837.5872    0  458 2566.87365 25837.5872   907%     -  304s
     0     0 25807.3517    0  465 2566.87365 25807.3517   905%     -  310s
     0     0 25639.6610    0  476 2566.87365 25639.6610   899%     -  329s
H    0     0                    2646.9785557 25631.3529   868%     -  334s
     0     0 25631.3529    0  461 2646.97856 25631.3529   868%     -  334s
H    0     0                    2903.5752320 25629.2697   783%     -  336s
H    0     0                    3055.6978203 25629.2697   739%     -  336s
     0     0 25629.2697    0  466 3055.69782 25629.2697   739%     -  336s
     0     0 25624.9703    0  464 3055.69782 25624.9703   739%     -  337s
     0     0 25623.4864    0  464 3055.69782 25623.4864   739%     -  339s
     0     0 25623.4810    0  465 3055.69782 25623.4810   739%     -  339s
H    0     0                    3089.1221483 22701.0306   635%     -  443s
H    0     0                    3252.4261854 22701.0306   598%     -  443s
H    0     0                    3271.9884775 22701.0306   594%     -  443s
H    0     0                    3292.1842184 22701.0306   590%     -  443s
     0     0 22701.0306    0  576 3292.18422 22701.0306   590%     -  443s
H    0     0                    3309.7878722 22701.0226   586%     -  444s
     0     0 22067.5570    0  536 3309.78787 22067.5570   567%     -  485s
H    0     0                    3477.4836643 21879.8082   529%     -  513s
     0     0 21879.8082    0  473 3477.48366 21879.8082   529%     -  513s
     0     0 21796.6897    0  465 3477.48366 21796.6897   527%     -  531s
     0     0 21746.9553    0  487 3477.48366 21746.9553   525%     -  545s
     0     0 21691.2745    0  476 3477.48366 21691.2745   524%     -  557s
     0     0 21655.0968    0  474 3477.48366 21655.0968   523%     -  568s
     0     0 21647.9154    0  475 3477.48366 21647.9154   523%     -  573s
     0     0 21630.8797    0  468 3477.48366 21630.8797   522%     -  581s
     0     0 21611.0299    0  485 3477.48366 21611.0299   521%     -  590s
     0     0 21551.9904    0  465 3477.48366 21551.9904   520%     -  602s
     0     0 21537.9005    0  461 3477.48366 21537.9005   519%     -  608s
     0     0 21525.8902    0  459 3477.48366 21525.8902   519%     -  617s
     0     0 21482.6643    0  455 3477.48366 21482.6643   518%     -  628s
     0     0 21475.2869    0  457 3477.48366 21475.2869   518%     -  633s
     0     0 21422.4888    0  545 3477.48366 21422.4888   516%     -  648s
     0     0 21410.9665    0  473 3477.48366 21410.9665   516%     -  654s
     0     0 21405.8180    0  458 3477.48366 21405.8180   516%     -  659s
     0     0 21402.5669    0  454 3477.48366 21402.5669   515%     -  664s
     0     0 21394.3738    0  460 3477.48366 21394.3738   515%     -  669s
     0     0 21393.0482    0  523 3477.48366 21393.0482   515%     -  673s
     0     0 19912.3308    0  534 3477.48366 19912.3308   473%     -  755s
H    0     0                    3512.2086230 19661.9691   460%     -  781s
H    0     0                    3536.3910219 19661.9691   456%     -  781s
     0     0 19661.9691    0  530 3536.39102 19661.9691   456%     -  781s
     0     0 19561.5351    0  525 3536.39102 19561.5351   453%     -  798s
     0     0 19507.9409    0  534 3536.39102 19507.9409   452%     -  810s
     0     0 19473.6123    0  524 3536.39102 19473.6123   451%     -  821s
     0     0 19459.2782    0  467 3536.39102 19459.2782   450%     -  826s
     0     0 19453.8770    0  469 3536.39102 19453.8770   450%     -  830s
     0     0 19446.7361    0  540 3536.39102 19446.7361   450%     -  835s
     0     0 19442.8074    0  539 3536.39102 19442.8074   450%     -  838s
     0     0 19436.9178    0  538 3536.39102 19436.9178   450%     -  841s
     0     0 19435.0394    0  546 3536.39102 19435.0394   450%     -  844s
     0     0 19060.8391    0  579 3536.39102 19060.8391   439%     -  875s
     0     0 18968.3720    0  568 3536.39102 18968.3720   436%     -  893s
     0     0 18951.5727    0  553 3536.39102 18951.5727   436%     -  897s
     0     0 18938.7057    0  556 3536.39102 18938.7057   436%     -  902s
     0     0 18922.3986    0  557 3536.39102 18922.3986   435%     -  910s
     0     0 18916.6733    0  563 3536.39102 18916.6733   435%     -  915s
     0     0 18914.2453    0  564 3536.39102 18914.2453   435%     -  917s
     0     0 18766.3841    0  501 3536.39102 18766.3841   431%     -  945s
     0     0 18709.2088    0  603 3536.39102 18709.2088   429%     -  967s
     0     0 18698.2459    0  620 3536.39102 18698.2459   429%     -  977s
     0     0 18677.5810    0  640 3536.39102 18677.5810   428%     -  989s
     0     0 18672.8518    0  622 3536.39102 18672.8518   428%     -  994s
     0     0 18672.4596    0  508 3536.39102 18672.4596   428%     -  996s
     0     0 18533.3043    0  565 3536.39102 18533.3043   424%     - 1020s
     0     0 18518.3330    0  642 3536.39102 18518.3330   424%     - 1029s
     0     0 18513.9294    0  645 3536.39102 18513.9294   424%     - 1035s
     0     0 18509.2570    0  655 3536.39102 18509.2570   423%     - 1039s
     0     0 18502.3258    0  647 3536.39102 18502.3258   423%     - 1045s
     0     0 18494.1461    0  641 3536.39102 18494.1461   423%     - 1053s
     0     0 18489.4279    0  649 3536.39102 18489.4279   423%     - 1058s
     0     0 18488.2961    0  638 3536.39102 18488.2961   423%     - 1061s
     0     0 18324.3495    0  544 3536.39102 18324.3495   418%     - 1087s
H    0     0                    3564.0648814 18324.0109   414%     - 1090s
     0     0 18305.7791    0  563 3564.06488 18305.7791   414%     - 1104s
     0     0 18294.5989    0  577 3564.06488 18294.5989   413%     - 1113s
     0     0 18289.1048    0  566 3564.06488 18289.1048   413%     - 1119s
     0     0 18287.9323    0  632 3564.06488 18287.9323   413%     - 1122s
     0     0 18225.2776    0  417 3564.06488 18225.2776   411%     - 1138s
     0     0 18200.6614    0  421 3564.06488 18200.6614   411%     - 1149s
     0     0 18197.6654    0  418 3564.06488 18197.6654   411%     - 1152s
     0     0 18186.1062    0  479 3564.06488 18186.1062   410%     - 1161s
     0     0 18184.2151    0  437 3564.06488 18184.2151   410%     - 1167s
     0     0 18174.4284    0  427 3564.06488 18174.4284   410%     - 1177s
     0     0 18169.7407    0  420 3564.06488 18169.7407   410%     - 1182s
     0     0 18165.6846    0  502 3564.06488 18165.6846   410%     - 1187s
     0     0 18162.0417    0  433 3564.06488 18162.0417   410%     - 1192s
     0     0 18160.6406    0  427 3564.06488 18160.6406   410%     - 1196s
     0     0 18148.5253    0  620 3564.06488 18148.5253   409%     - 1208s
     0     0 18146.7495    0  623 3564.06488 18146.7495   409%     - 1215s
     0     0 18142.2884    0  422 3564.06488 18142.2884   409%     - 1220s
     0     0 18142.1424    0  422 3564.06488 18142.1424   409%     - 1222s
     0     2 18142.0438    0  422 3564.06488 18142.0438   409%     - 1351s
     1     4 18114.6818    1  408 3564.06488 18142.0438   409%  3479 1378s
     3     7 18070.2926    2  409 3564.06488 18114.6643   408%  9916 1402s
     6    12 17833.6904    3  522 3564.06488 18070.0587   407% 11944 1428s
    11    24 17377.6930    4  508 3564.06488 18070.0587   407% 13855 1457s
    23    36 15844.7015    5  305 3564.06488 17471.0136   390% 18152 1525s
    35    68 15386.2441    6  328 3564.06488 17471.0136   390% 21646 1657s
    67   106 15277.2467    7  334 3564.06488 17406.8415   388% 23258 1731s
   105   194 15047.6956    8  329 3564.06488 17406.5317   388% 19657 1785s
   193   271 14309.8702   11  287 3564.06488 17406.5317   388% 13104 1824s
   270   338 12768.5733   15  230 3564.06488 17406.5317   388% 11254 1858s
   337   411 14440.1055   10  307 3564.06488 17406.5317   388% 10480 1888s
   410   492 9826.12213   25  152 3564.06488 17406.5317   388%  9685 1915s
   493   594 9676.41100   10  238 3564.06488 17406.5317   388%  9061 1937s
   595   709 8891.10601   12  219 3564.06488 17406.5317   388%  8572 1955s
   710   793 8699.28898   13  211 3564.06488 17406.5317   388%  7986 1968s
   818   814 8261.96587   14  226 3564.06488 17406.5317   388%  7462 1984s
   851   835 8804.35566   13  233 3564.06488 17406.5317   388%  7382 1997s
   884   860 8671.84982   14  200 3564.06488 17406.5317   388%  7319 2013s
   913   900 8607.30784   13  211 3564.06488 17406.5317   388%  7286 2027s
   953   926 7954.82627   15  209 3564.06488 17406.5317   388%  7216 2043s
  1009   982 8235.52547   14  190 3564.06488 17406.5317   388%  7200 2058s
  1072   990 8173.26975   15  190 3564.06488 17406.5317   388%  7030 2076s
  1134  1007 7917.67755   16  198 3564.06488 17406.5317   388%  6883 2092s
  1193  1011 7806.38962   17  222 3564.06488 17406.5317   388%  6809 2112s
  1267  1018 7969.83518   15  213 3564.06488 17406.5317   388%  6758 2133s
  1340  1033 7867.55656   16  218 3564.06488 17406.5317   388%  6712 2156s
H 1355  1033                    3571.7806556 17340.0725   385%  6688 2156s
  1405  1076 infeasible   16      3571.78066 17340.0725   385%  6703 2182s
  1508  1109 5195.54605   17  266 3571.78066 17340.0725   385%  6581 2209s
  1619  1134 4643.49505   19  255 3571.78066 17340.0725   385%  6415 2238s
  1715  1178     cutoff   23      3571.78066 17340.0725   385%  6391 2264s
  1815  1194 3772.27607   23  242 3571.78066 17340.0725   385%  6337 2293s
  1914  1213     cutoff   42      3571.78066 17200.6912   382%  6327 2327s
  1981  1240 16581.5562    6  506 3571.78066 17036.8318   377%  6415 2360s
  2044  1258 8715.57174   10  352 3571.78066 17036.8318   377%  6495 2393s
  2080  1287     cutoff   11      3571.78066 17036.8318   377%  6589 2429s
  2121  1339 8023.14473   19  345 3571.78066 17036.8318   377%  6758 2461s
  2199  1436 7941.44029   20  428 3571.78066 17036.8318   377%  6918 2492s
  2324  1568 7727.01781   24  371 3571.78066 17036.8318   377%  7013 2521s
  2510  1606 7243.64495   28  351 3571.78066 17036.8318   377%  6939 2554s
  2578  1722 7137.39818   29  293 3571.78066 17036.8318   377%  6958 2588s
  2748  1841 5648.97940   32  308 3571.78066 17036.8318   377%  6894 2622s
  2973  1919 4774.80185   38  259 3571.78066 17036.8318   377%  6755 2665s
  3127  1967 3799.76911   44  232 3571.78066 17036.8318   377%  6729 2707s
  3249  2028 13847.8081   10  350 3571.78066 16818.4158   371%  6785 2757s
  3351  2098 10409.2303   11  477 3571.78066 16754.3743   369%  6881 2809s
  3492  2179 9940.50213   12  359 3571.78066 16754.3743   369%  6928 2859s
  3650  2255 10169.2060   12  416 3571.78066 16754.3743   369%  6984 2918s
  3810  2286 9243.56479   13  362 3571.78066 16641.7481   366%  7048 2965s
H 3815  2286                    3607.8959813 16641.7481   361%  7059 2965s
H 3914  2284                    3656.4659902 16641.7481   355%  7036 2965s
  3926  2342 8000.91731   14  334 3656.46599 16641.7481   355%  7036 3023s
  4082  2467 7546.98212   15  337 3656.46599 16641.7481   355%  7105 3083s
  4247  2468 8016.73988   25  422 3656.46599 16396.2904   348%  7153 3542s
  4249  2469 7495.41338   18  174 3656.46599 16396.2904   348%  7150 3557s

Cutting planes:
  Gomory: 26
  Implied bound: 49
  Projected implied bound: 292
  MIR: 1180
  Mixing: 27
  Flow cover: 756
  RLT: 45
  Relax-and-lift: 226

Explored 4249 nodes (31427708 simplex iterations) in 3600.03 seconds (8439.28 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3656.47 3607.9 3571.78 ... 3271.99

Time limit reached
Best objective 3.656465990182e+03, best bound 1.639629043245e+04, gap 348.4191%
  WARNING: Time limit reached. Using best solution found (gap: 348.42%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.09s
  Master Objective (UB) = 3656.47, θ = 145517.76
  Upper Bound (UB) = 3656.47

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145517.76
  [DEBUG]   ✓ Scenario 0: θ = 145517.76 ≤ Q = 145517.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145517.76 ≤ Q = 145517.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145517.76 ≤ Q = 145517.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145517.76 ≤ Q = 145517.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145517.76 ≤ Q = 145517.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145517.76 ≤ Q = 145517.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145517.76 ≤ Q = 145517.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145517.76 ≤ Q = 145517.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145517.76 ≤ Q = 145517.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145517.76 ≤ Q = 145517.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145517.76 ≤ Q = 145517.76 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145517.76 ≤ Q = 145517.76 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145517.76 ≤ Q = 145517.76 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 13] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x72ef309d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8d10cf63
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.155336e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5757911.5066
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.265949e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126594.89    0  122 5757911.51 -126594.89   102%     -    0s
H    0     0                    -94545.63713 -126594.89  33.9%     -    0s
H    0     0                    -95351.96279 -126594.89  32.8%     -    0s
     0     0 -104821.46    0   67 -95351.963 -104821.46  9.93%     -    0s
H    0     0                    -102728.1825 -104746.25  1.96%     -    0s
H    0     0                    -102752.2935 -104746.25  1.94%     -    0s
H    0     0                    -103384.8663 -104746.25  1.32%     -    0s
H    0     0                    -103408.9774 -104746.25  1.29%     -    0s
     0     0 -104339.29    0   75 -103408.98 -104339.29  0.90%     -    0s
     0     0 -104271.17    0   73 -103408.98 -104271.17  0.83%     -    0s
     0     0 -104267.20    0   72 -103408.98 -104267.20  0.83%     -    0s
H    0     0                    -103672.9767 -104267.20  0.57%     -    0s
H    0     0                    -103714.9197 -104267.20  0.53%     -    0s
     0     0 -103985.13    0   46 -103714.92 -103985.13  0.26%     -    0s
     0     0 -103929.44    0   41 -103714.92 -103929.44  0.21%     -    0s
     0     0 -103929.24    0   38 -103714.92 -103929.24  0.21%     -    0s
     0     0 -103903.43    0   21 -103714.92 -103903.43  0.18%     -    0s
     0     0 -103844.78    0   33 -103714.92 -103844.78  0.13%     -    0s
     0     0 -103802.28    0   25 -103714.92 -103802.28  0.08%     -    0s
     0     0 -103772.92    0    9 -103714.92 -103772.92  0.06%     -    0s
     0     0 -103748.45    0    7 -103714.92 -103748.45  0.03%     -    0s
     0     0 -103735.14    0    5 -103714.92 -103735.14  0.02%     -    0s
     0     0 -103724.13    0    2 -103714.92 -103724.13  0.01%     -    0s

Cutting planes:
  Gomory: 9
  Implied bound: 8
  MIR: 99
  Flow cover: 3
  RLT: 42
  Relax-and-lift: 16
  BQP: 5

Explored 1 nodes (677 simplex iterations) in 0.04 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 6: -103715 -103385 -95352 ... 1.15534e+13
No other solutions better than -103715

Optimal solution found (tolerance 1.00e-06)
Best objective -1.037149196578e+05, best bound -1.037149196578e+05, gap 0.0000%
  Subproblem solved in 0.06s
  Worst-case operational profit (Z_SP) = 139188.54
  Scenario: 27 demand increases, 33 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -103714.92
  [DEBUG]   S×d_nominal = 242903.46
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 242903.46 + -103714.92 = 139188.54
  [DEBUG]   Current θ from Master = 145517.76
  [DEBUG]   ⚠️  Z_SP ≤ θ by 6329.21 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2672.75
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2671.8412, Absolute Gap = 2671.8412, Relative Gap = 0.730717
  Not converged yet (gap = 2671.84 > ε = 200)

  [DEBUG] Adding NEW scenario 13 to Master Problem...
  [DEBUG] New scenario pattern: 27 increases, 33 decreases
    [DEBUG] Scenario 13 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 13 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 13]
    [DEBUG]   - Total constraints in model: 215443
    [DEBUG]   - Total variables in model: 89620
  [DEBUG] Total scenarios in Master: 14
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 14
================================================================================
[Iteration 14] Solving Master Problem...
  Current scenarios in Master: 14
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 215443 rows, 89620 columns and 610753 nonzeros
Model fingerprint: 0x3e7f6233
Variable types: 87361 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 98980 rows and 40180 columns
Presolve time: 2.08s
Presolved: 116463 rows, 49440 columns, 702355 nonzeros
Variable types: 47181 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -372912.9578
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.29s

Barrier statistics:
 Dense cols : 578
 AA' NZ     : 4.915e+06
 Factor NZ  : 1.154e+07 (roughly 160 MB of memory)
 Factor Ops : 2.323e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.83252961e+07  1.93143612e+08  1.03e+05 1.92e+01  8.01e+04     4s
   1  -1.40483301e+07  1.74904402e+08  7.21e+04 6.19e+01  5.53e+04     4s
   2  -6.86503534e+06  1.36368166e+08  3.49e+04 5.56e-01  2.81e+04     4s
   3  -1.24312607e+06  1.09883937e+08  3.12e+03 1.61e+00  2.91e+03     4s
   4  -5.77322478e+05  4.53896942e+07  4.42e+02 3.39e-01  5.22e+02     4s
   5  -4.79347919e+05  2.71491190e+07  2.47e+02 1.69e-01  2.85e+02     4s
   6  -3.54858692e+05  1.96280643e+07  9.71e+01 1.09e-01  1.49e+02     4s
   7  -2.50745514e+05  1.59047223e+07  4.61e+01 8.32e-02  9.97e+01     4s
   8  -1.49717210e+05  1.02086307e+07  1.34e+01 4.85e-02  5.39e+01     4s
   9  -1.20873109e+05  6.88639222e+06  8.79e+00 3.12e-02  3.54e+01     4s
  10  -8.15010869e+04  2.33180009e+06  3.65e+00 9.08e-03  1.18e+01     4s
  11  -3.31466515e+04  5.01075249e+05  1.16e+00 1.62e-03  2.55e+00     4s
  12  -2.01772496e+04  3.37364911e+05  7.95e-01 1.19e-03  1.70e+00     4s
  13  -1.38697231e+04  2.16248684e+05  6.24e-01 1.14e-03  1.09e+00     4s
  14  -7.23330918e+03  1.54763964e+05  4.76e-01 1.10e-03  7.66e-01     5s
  15  -8.55449963e+02  1.26989383e+05  3.70e-01 9.70e-04  6.04e-01     5s
  16   6.95300255e+03  9.34063082e+04  2.64e-01 1.50e-03  4.08e-01     5s
  17   1.15368396e+04  7.61176719e+04  2.14e-01 1.74e-03  3.05e-01     5s
  18   1.40481287e+04  6.38891129e+04  1.90e-01 1.26e-03  2.35e-01     5s
  19   1.60623968e+04  5.72539172e+04  1.72e-01 1.50e-03  1.94e-01     5s
  20   1.92959497e+04  5.38772973e+04  1.44e-01 1.46e-03  1.63e-01     5s
  21   2.18159655e+04  4.99311549e+04  1.22e-01 2.34e-03  1.33e-01     5s
  22   2.47136950e+04  4.71324842e+04  9.71e-02 2.62e-03  1.06e-01     5s
  23   2.67309490e+04  4.48041349e+04  8.01e-02 2.11e-03  8.53e-02     5s
  24   2.88798748e+04  4.31187474e+04  6.25e-02 2.45e-03  6.72e-02     5s
  25   2.99508724e+04  4.15420440e+04  5.39e-02 1.51e-03  5.47e-02     5s
  26   3.09822820e+04  4.03879078e+04  4.59e-02 2.23e-03  4.44e-02     5s
  27   3.18387180e+04  3.96419928e+04  3.92e-02 1.85e-03  3.68e-02     5s
  28   3.29460576e+04  3.90881051e+04  3.10e-02 1.81e-03  2.90e-02     5s
  29   3.33421327e+04  3.88087620e+04  2.80e-02 1.77e-03  2.58e-02     5s
  30   3.45212978e+04  3.86115463e+04  1.97e-02 1.73e-03  1.93e-02     6s
  31   3.49656944e+04  3.83291994e+04  1.64e-02 1.40e-03  1.59e-02     6s
  32   3.52241735e+04  3.80993444e+04  1.44e-02 1.01e-03  1.36e-02     6s
  33   3.53869454e+04  3.79560351e+04  1.33e-02 7.71e-04  1.21e-02     6s
  34   3.59428772e+04  3.79095969e+04  9.39e-03 6.90e-04  9.28e-03     6s
  35   3.62377485e+04  3.77704315e+04  7.26e-03 5.41e-04  7.23e-03     6s
  36   3.65034374e+04  3.76279240e+04  5.42e-03 3.92e-04  5.30e-03     6s
  37   3.66130406e+04  3.75456231e+04  4.66e-03 2.80e-04  4.40e-03     6s
  38   3.67419885e+04  3.75028486e+04  3.76e-03 2.30e-04  3.59e-03     6s
  39   3.68339399e+04  3.74761179e+04  3.12e-03 1.95e-04  3.03e-03     6s
  40   3.68511615e+04  3.74688656e+04  3.01e-03 1.86e-04  2.91e-03     6s
  41   3.68941212e+04  3.74540569e+04  2.73e-03 1.67e-04  2.64e-03     6s
  42   3.70472296e+04  3.74105060e+04  1.71e-03 1.15e-04  1.71e-03     6s
  43   3.71370669e+04  3.73670483e+04  1.11e-03 1.38e-04  1.08e-03     6s
  44   3.71486721e+04  3.73455543e+04  1.04e-03 1.52e-04  9.29e-04     7s
  45   3.71998654e+04  3.73336570e+04  7.10e-04 8.98e-05  6.31e-04     7s
  46   3.72340500e+04  3.73309088e+04  4.99e-04 7.56e-05  4.57e-04     7s
  47   3.72561417e+04  3.73286310e+04  3.58e-04 6.27e-05  3.42e-04     7s
  48   3.72675300e+04  3.73249181e+04  2.87e-04 4.83e-05  2.71e-04     7s
  49   3.72953832e+04  3.73194900e+04  1.16e-04 2.09e-05  1.14e-04     7s
  50   3.73058183e+04  3.73154037e+04  5.30e-05 9.99e-06  4.52e-05     7s
  51   3.73122376e+04  3.73152853e+04  1.56e-05 6.60e-06  1.44e-05     7s
  52   3.73142348e+04  3.73151449e+04  4.47e-06 2.57e-06  4.29e-06     7s
  53   3.73147303e+04  3.73150481e+04  1.73e-06 8.24e-07  1.50e-06     7s
  54   3.73149152e+04  3.73150464e+04  6.81e-07 3.35e-07  6.19e-07     7s
  55   3.73150325e+04  3.73150427e+04  1.46e-07 1.46e-08  4.79e-08     7s
  56   3.73150420e+04  3.73150420e+04  5.20e-09 1.47e-10  7.10e-12     7s

Barrier solved model in 56 iterations and 7.37 seconds (10.84 work units)
Optimal objective 3.73150420e+04


Root crossover log...

  100184 DPushes remaining with DInf 0.0000000e+00                 7s
       0 DPushes remaining with DInf 0.0000000e+00                 9s

    1945 PPushes remaining with PInf 2.1493853e-06                 9s
       0 PPushes remaining with PInf 0.0000000e+00                 9s

  Push phase complete: Pinf 0.0000000e+00, Dinf 7.7185980e-11      9s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   37266    3.7315042e+04   0.000000e+00   0.000000e+00      9s
   37266    3.7315042e+04   0.000000e+00   0.000000e+00      9s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.731504e+04, 37266 iterations, 6.37 seconds (10.60 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 37315.0420    0  257 -210461.39 37315.0420   118%     -    9s
H    0     0                    -139180.8428 37315.0420   127%     -    9s
H    0     0                    -91997.89986 37315.0420   141%     -    9s
H    0     0                    -76707.45407 37315.0420   149%     -    9s
H    0     0                    -76581.45783 37315.0420   149%     -    9s
H    0     0                    -45448.84352 37315.0420   182%     -    9s
H    0     0                    -14464.74779 37315.0420   358%     -   10s
H    0     0                    -5181.448664 37315.0420   820%     -   10s
H    0     0                    -3856.211991 37315.0420  1068%     -   10s
H    0     0                    -3790.456486 37315.0420  1084%     -   10s
H    0     0                    -3781.094980 37315.0420  1087%     -   10s
H    0     0                    -3726.914770 37315.0420  1101%     -   10s
H    0     0                    -3659.135542 37315.0420  1120%     -   10s
H    0     0                     604.4653561 37315.0420  6073%     -   11s
H    0     0                     749.6117083 37315.0420  4878%     -   11s
H    0     0                     889.9801899 37315.0420  4093%     -   11s
     0     0 32166.3797    0  365  889.98019 32166.3797  3514%     -   44s
H    0     0                     990.8540236 32164.4768  3146%     -   44s
H    0     0                    1102.3162728 32164.4768  2818%     -   45s
H    0     0                    1882.6598992 32164.4768  1608%     -   45s
H    0     0                    1910.5131524 32164.4768  1584%     -   45s
     0     0 31649.7655    0  347 1910.51315 31649.7655  1557%     -   62s
     0     0 31378.4028    0  350 1910.51315 31378.4028  1542%     -   70s
     0     0 31320.1472    0  353 1910.51315 31320.1472  1539%     -   76s
     0     0 31240.1201    0  361 1910.51315 31240.1201  1535%     -   79s
     0     0 31088.4913    0  351 1910.51315 31088.4913  1527%     -   86s
     0     0 31088.4913    0  368 1910.51315 31088.4913  1527%     -   88s
     0     0 31088.4913    0  358 1910.51315 31088.4913  1527%     -   90s
     0     0 31088.4913    0  373 1910.51315 31088.4913  1527%     -   91s
     0     0 31088.4913    0  372 1910.51315 31088.4913  1527%     -   92s
H    0     0                    1999.4664830 27552.7061  1278%     -  175s
H    0     0                    2029.4063887 27552.7061  1258%     -  175s
H    0     0                    2467.4473387 27552.7061  1017%     -  175s
     0     0 27455.2321    0  469 2467.44734 27455.2321  1013%     -  175s
H    0     0                    2494.0215534 27455.2321  1001%     -  176s
     0     0 26352.3031    0  468 2494.02155 26352.3031   957%     -  233s
     0     0 26096.0618    0  464 2494.02155 26096.0618   946%     -  265s
     0     0 26015.7250    0  483 2494.02155 26015.7250   943%     -  284s
H    0     0                    2517.5430427 25811.4504   925%     -  312s
     0     0 25811.4504    0  482 2517.54304 25811.4504   925%     -  312s
     0     0 25760.9120    0  479 2517.54304 25760.9120   923%     -  322s
     0     0 25721.7526    0  465 2517.54304 25721.7526   922%     -  329s
     0     0 25704.9994    0  457 2517.54304 25704.9994   921%     -  336s
     0     0 25702.1906    0  463 2517.54304 25702.1906   921%     -  339s
     0     0 25701.1606    0  466 2517.54304 25701.1606   921%     -  342s
H    0     0                    2569.2780968 23128.1152   800%     -  451s
H    0     0                    2598.9692883 23128.1152   790%     -  451s
H    0     0                    2705.8660750 23128.1152   755%     -  451s
H    0     0                    3028.7373069 23128.1152   664%     -  451s
     0     0 23128.1152    0  449 3028.73731 23128.1152   664%     -  451s
H    0     0                    3030.5747941 23128.0029   663%     -  451s
     0     0 22772.0539    0  565 3030.57479 22772.0539   651%     -  509s
     0     0 22606.2303    0  563 3030.57479 22606.2303   646%     -  548s
     0     0 22535.5134    0  553 3030.57479 22535.5134   644%     -  567s
     0     0 22512.6819    0  546 3030.57479 22512.6819   643%     -  581s
H    0     0                    3054.2762273 22436.2214   635%     -  606s
H    0     0                    3065.1393316 22436.2214   632%     -  606s
     0     0 22436.2214    0  534 3065.13933 22436.2214   632%     -  606s
     0     0 22389.1652    0  572 3065.13933 22389.1652   630%     -  626s
H    0     0                    3188.7324184 22282.9598   599%     -  657s
     0     0 22282.9598    0  575 3188.73242 22282.9598   599%     -  657s
     0     0 22272.3996    0  591 3188.73242 22272.3996   598%     -  668s
     0     0 22270.0234    0  575 3188.73242 22270.0234   598%     -  675s
H    0     0                    3203.0520844 22266.6247   595%     -  679s
H    0     0                    3204.5257092 22266.6247   595%     -  679s
     0     0 22266.6247    0  585 3204.52571 22266.6247   595%     -  679s
     0     0 22265.6280    0  575 3204.52571 22265.6280   595%     -  682s
     0     0 20672.9687    0  568 3204.52571 20672.9687   545%     -  815s
H    0     0                    3281.3445030 20228.0577   516%     -  868s
     0     0 20228.0577    0  555 3281.34450 20228.0577   516%     -  868s
     0     0 20073.7208    0  568 3281.34450 20073.7208   512%     -  903s
     0     0 19970.7326    0  557 3281.34450 19970.7326   509%     -  927s
     0     0 19875.8117    0  549 3281.34450 19875.8117   506%     -  958s
     0     0 19823.2076    0  560 3281.34450 19823.2076   504%     -  978s
     0     0 19779.6978    0  562 3281.34450 19779.6978   503%     -  999s
     0     0 19731.9507    0  559 3281.34450 19731.9507   501%     - 1021s
     0     0 19705.6732    0  576 3281.34450 19705.6732   501%     - 1036s
     0     0 19694.0625    0  563 3281.34450 19694.0625   500%     - 1045s
     0     0 19689.4084    0  580 3281.34450 19689.4084   500%     - 1051s
     0     0 19687.6409    0  572 3281.34450 19687.6409   500%     - 1055s
H    0     0                    3283.1963821 19372.2414   490%     - 1111s
H    0     0                    3316.8234184 19372.2414   484%     - 1111s
H    0     0                    3330.9868943 19372.2414   482%     - 1111s
H    0     0                    3346.0785485 19372.2414   479%     - 1111s
     0     0 19372.2414    0  584 3346.07855 19372.2414   479%     - 1111s
H    0     0                    3358.0902440 19298.9228   475%     - 1134s
     0     0 19298.9228    0  595 3358.09024 19298.9228   475%     - 1134s
     0     0 19238.9687    0  605 3358.09024 19238.9687   473%     - 1163s
     0     0 19201.6421    0  612 3358.09024 19201.6421   472%     - 1183s
     0     0 19185.3808    0  600 3358.09024 19185.3808   471%     - 1197s
     0     0 19175.7581    0  598 3358.09024 19175.7581   471%     - 1207s
     0     0 19173.9319    0  603 3358.09024 19173.9319   471%     - 1211s
     0     0 19018.4849    0  659 3358.09024 19018.4849   466%     - 1254s
H    0     0                    3411.5970803 19018.4623   457%     - 1261s
     0     0 18980.3994    0  451 3411.59708 18980.3994   456%     - 1283s
     0     0 18960.6174    0  554 3411.59708 18960.6174   456%     - 1305s
     0     0 18953.0058    0  514 3411.59708 18953.0058   456%     - 1315s
     0     0 18948.8589    0  554 3411.59708 18948.8589   455%     - 1324s
     0     0 18947.1524    0  500 3411.59708 18947.1524   455%     - 1332s
     0     0 18794.4077    0  556 3411.59708 18794.4077   451%     - 1366s
     0     0 18736.9645    0  643 3411.59708 18736.9645   449%     - 1389s
     0     0 18729.1356    0  449 3411.59708 18729.1356   449%     - 1398s
     0     0 18711.8587    0  570 3411.59708 18711.8587   448%     - 1410s
     0     0 18701.7948    0  632 3411.59708 18701.7948   448%     - 1421s
     0     0 18697.5778    0  507 3411.59708 18697.5778   448%     - 1426s
     0     0 18688.6062    0  650 3411.59708 18688.6062   448%     - 1435s
     0     0 18685.4308    0  637 3411.59708 18685.4308   448%     - 1440s
     0     0 18585.0155    0  574 3411.59708 18585.0155   445%     - 1473s
     0     0 18567.3442    0  594 3411.59708 18567.3442   444%     - 1491s
     0     0 18552.2064    0  524 3411.59708 18552.2064   444%     - 1502s
     0     0 18546.3999    0  503 3411.59708 18546.3999   444%     - 1509s
     0     0 18544.7667    0  509 3411.59708 18544.7667   444%     - 1517s
     0     0 18527.6782    0  590 3411.59708 18527.6782   443%     - 1534s
     0     0 18513.9566    0  599 3411.59708 18513.9566   443%     - 1546s
     0     0 18510.0211    0  654 3411.59708 18510.0211   443%     - 1554s
     0     0 18507.3425    0  523 3411.59708 18507.3425   442%     - 1559s
     0     0 18459.7208    0  650 3411.59708 18459.7208   441%     - 1583s
H    0     0                    3412.6271524 18448.8360   441%     - 1607s
     0     0 18448.8360    0  563 3412.62715 18448.8360   441%     - 1607s
     0     0 18442.5829    0  635 3412.62715 18442.5829   440%     - 1616s
     0     0 18441.2461    0  636 3412.62715 18441.2461   440%     - 1623s
     0     0 18422.1560    0  625 3412.62715 18422.1560   440%     - 1638s
     0     0 18411.3198    0  649 3412.62715 18411.3198   440%     - 1652s
     0     0 18409.1754    0  713 3412.62715 18409.1754   439%     - 1656s
     0     0 18400.9132    0  568 3412.62715 18400.9132   439%     - 1667s
H    0     0                    3414.9025676 18392.8348   439%     - 1674s
     0     0 18392.8348    0  578 3414.90257 18392.8348   439%     - 1674s
     0     0 18390.3523    0  573 3414.90257 18390.3523   439%     - 1677s
     0     0 18384.4355    0  579 3414.90257 18384.4355   438%     - 1683s
     0     0 18384.3744    0  579 3414.90257 18384.3744   438%     - 1686s
     0     2 18384.3744    0  579 3414.90257 18384.3744   438%     - 1846s
     1     3 16881.9221    1  290 3414.90257 18384.3744   438% 37134 1893s
     2     5 16867.0740    2  291 3414.90257 18384.3744   438% 20128 1907s
     4     9 16757.0475    3  299 3414.90257 18237.7119   434% 15455 1921s
     8    16 16502.8736    4  330 3414.90257 18237.6428   434% 12299 1971s
    15    30 16119.1692    5  346 3414.90257 18159.6461   432% 16150 2009s
    29    44 17660.6404    4  698 3414.90257 18134.2925   431% 23062 2142s
    43    74 16986.9787    5  625 3414.90257 18061.6829   429% 21351 2376s
    73   133 16945.3304    6  622 3414.90257 18061.6829   429% 20113 2460s
H   84   133                    3435.5523803 18061.6829   426% 18420 2460s
   132   229 16742.2689    9  499 3435.55238 18061.6829   426% 15112 2521s
   228   256 16595.4132   10  452 3435.55238 18061.6829   426% 12983 2563s
   255   289 16416.1736   11  455 3435.55238 18061.6829   426% 12718 2599s
   288   339 15949.6479   12  460 3435.55238 18061.6829   426% 12437 2637s
   338   387 15803.7128   13  461 3435.55238 18061.6829   426% 12095 2669s
H  372   387                    3443.2269369 18061.6829   425% 11477 2669s
   386   489 15602.1560   14  492 3443.22694 18061.6829   425% 11284 2705s
H  492   595                    3445.2889244 18061.6829   424%  9821 2737s
   600   677 9526.30965   27  187 3445.28892 18061.6829   424%  8690 2762s
   689   775 8782.01044   32  182 3445.28892 18061.6829   424%  7985 2782s
   800   863 15765.1296   14  452 3445.28892 18061.6829   424%  7257 2803s
   907   964 15570.5461   16  460 3445.28892 18061.6829   424%  6689 2824s
  1025   998 6563.44925   47  139 3445.28892 18061.6829   424%  6131 2845s
  1103  1014 5084.80215   50  112 3445.28892 18061.6829   424%  5863 2863s
  1143  1030 4881.13894   51  108 3445.28892 18061.6829   424%  5826 2884s
  1191  1037 9680.01067   19  254 3445.28892 18061.6829   424%  5752 2905s
  1238  1056 9492.37019   20  242 3445.28892 18061.6829   424%  5660 2931s
  1287  1074 8640.01848   22  197 3445.28892 18061.6829   424%  5559 2955s
  1325  1088 8465.37320   23  207 3445.28892 18061.6829   424%  5531 2982s
  1383  1108 8165.41974   24  200 3445.28892 18061.6829   424%  5423 3009s
  1449  1137 6409.42688   26  206 3445.28892 18061.6829   424%  5299 3039s
  1520  1190     cutoff   27      3445.28892 18061.6829   424%  5191 3072s
  1623  1271 5953.65330   26  256 3445.28892 18061.6829   424%  5034 3108s
  1750  1292 5095.43406   27  230 3445.28892 18061.6829   424%  4793 3144s
  1873  1310 3901.34791   28  180 3445.28892 18061.6829   424%  4606 3183s
  1941  1337 3553.81927   29  178 3445.28892 18061.6829   424%  4549 3224s
  2000  1367     cutoff   31      3445.28892 18061.6829   424%  4526 3268s
  2058  1385 infeasible   33      3445.28892 18061.6829   424%  4530 3310s
  2128  1410 3839.60890   35  169 3445.28892 18061.6829   424%  4520 3355s
  2215  1492     cutoff   39      3445.28892 18061.6829   424%  4511 3406s
  2331  1594 6307.63819   24  255 3445.28892 18061.6829   424%  4455 3449s
  2472  1682 5975.75605   25  244 3445.28892 18061.6829   424%  4330 3513s
  2623  1726 3851.05044   29  176 3445.28892 17978.2296   422%  4222 3565s
  2741  1743 8657.54618   13  522 3445.28892 17978.2296   422%  4178 3600s

Cutting planes:
  Learned: 1
  Gomory: 41
  Implied bound: 396
  MIR: 4570
  Flow cover: 4082
  RLT: 143
  Relax-and-lift: 1556

Explored 2806 nodes (12866166 simplex iterations) in 3600.11 seconds (7916.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3445.29 3435.55 3414.9 ... 3204.53

Time limit reached
Best objective 3.445288924414e+03, best bound 1.778268893082e+04, gap 416.1451%
  WARNING: Time limit reached. Using best solution found (gap: 416.15%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 1) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 3445.29, θ = 144398.39
  Upper Bound (UB) = 3445.29

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 144398.39
  [DEBUG]   ✓ Scenario 0: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 144398.39 ≤ Q = 144398.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 144398.39 ≤ Q = 144398.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG]   ✓ Scenario 12: θ = 144398.39 ≤ Q = 144398.39 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 144398.39 ≤ Q = 144398.39 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 14] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x3803449f
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xc7fcbb61
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.141099e+13
Presolve removed 2617 rows and 1906 columns
Presolve time: 0.00s
Presolved: 476 rows, 483 columns, 1345 nonzeros
Found heuristic solution: objective 5468832.5322
Variable types: 326 continuous, 157 integer (157 binary)
Found heuristic solution: objective 5467945.8488

Root relaxation: objective -1.295319e+05, 227 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -129531.94    0  117 5467945.85 -129531.94   102%     -    0s
H    0     0                    -78725.85537 -129531.94  64.5%     -    0s
H    0     0                    -79354.01651 -129531.94  63.2%     -    0s
H    0     0                    -93815.42805 -129531.94  38.1%     -    0s
     0     0 -105121.28    0   51 -93815.428 -105121.28  12.1%     -    0s
H    0     0                    -94601.63150 -105041.56  11.0%     -    0s
H    0     0                    -94835.02971 -105041.56  10.8%     -    0s
H    0     0                    -95281.84381 -105041.56  10.2%     -    0s
H    0     0                    -104522.9592 -105041.56  0.50%     -    0s
     0     0 -104790.87    0   31 -104522.96 -104790.87  0.26%     -    0s
     0     0 -104783.24    0   29 -104522.96 -104783.24  0.25%     -    0s
     0     0 -104716.26    0   27 -104522.96 -104716.26  0.18%     -    0s
     0     0 -104714.20    0   28 -104522.96 -104714.20  0.18%     -    0s
     0     0 -104604.09    0   12 -104522.96 -104604.09  0.08%     -    0s
     0     0 -104565.06    0   11 -104522.96 -104565.06  0.04%     -    0s
     0     0 -104563.52    0    4 -104522.96 -104563.52  0.04%     -    0s
H    0     0                    -104524.3176 -104558.23  0.03%     -    0s
     0     0 -104558.23    0    4 -104524.32 -104558.23  0.03%     -    0s
     0     0 -104558.23    0   15 -104524.32 -104558.23  0.03%     -    0s
H    0     0                    -104534.4800 -104558.23  0.02%     -    0s
     0     0 -104550.88    0    2 -104534.48 -104550.88  0.02%     -    0s
H    0     0                    -104549.8797 -104549.88  0.00%     -    0s
     0     0          -    0      -104549.88 -104549.88  0.00%     -    0s

Cutting planes:
  Gomory: 5
  MIR: 9
  Flow cover: 6
  RLT: 1

Explored 1 nodes (500 simplex iterations) in 0.09 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -104550 -104534 -104524 ... -78725.9
No other solutions better than -104550

Optimal solution found (tolerance 1.00e-06)
Best objective -1.045498796773e+05, best bound -1.045498796773e+05, gap 0.0000%
  Subproblem solved in 0.10s
  Worst-case operational profit (Z_SP) = 138702.35
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -104549.88
  [DEBUG]   S×d_nominal = 243252.23
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243252.23 + -104549.88 = 138702.35
  [DEBUG]   Current θ from Master = 144398.39
  [DEBUG]   ⚠️  Z_SP ≤ θ by 5696.04 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = -2250.75
  Lower Bound (LB) = 984.62
  Gap (UB-LB) = 2460.6641, Absolute Gap = 2460.6641, Relative Gap = 0.714211
  Not converged yet (gap = 2460.66 > ε = 200)

  [DEBUG] Adding NEW scenario 14 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 14 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 14 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 14]
    [DEBUG]   - Total constraints in model: 230733
    [DEBUG]   - Total variables in model: 95860
  [DEBUG] Total scenarios in Master: 15
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 15
================================================================================
[Iteration 15] Solving Master Problem...
  Current scenarios in Master: 15
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 230733 rows, 95860 columns and 653984 nonzeros
Model fingerprint: 0xdc4f7854
Variable types: 93601 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 106050 rows and 43050 columns
Presolve time: 2.14s
Presolved: 124683 rows, 52810 columns, 767515 nonzeros
Variable types: 50551 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -363238.5703
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.31s

Barrier statistics:
 Dense cols : 600
 AA' NZ     : 6.083e+06
 Factor NZ  : 1.353e+07 (roughly 180 MB of memory)
 Factor Ops : 2.936e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.89863115e+07  2.03819175e+08  1.09e+05 1.92e+01  8.26e+04     4s
   1  -1.46393609e+07  1.84789282e+08  7.75e+04 5.97e+01  5.85e+04     4s
   2  -4.77549801e+06  1.46665932e+08  2.47e+04 8.49e-01  1.98e+04     4s
   3  -1.41139760e+06  1.22735969e+08  3.61e+03 5.05e+00  3.29e+03     4s
   4  -7.94598303e+05  8.12233711e+07  5.69e+02 1.91e+00  7.66e+02     4s
   5  -7.13427822e+05  4.35113179e+07  4.03e+02 5.52e-01  4.50e+02     4s
   6  -6.09211371e+05  3.22245036e+07  1.34e+02 3.82e-01  2.25e+02     4s
   7  -5.20258433e+05  2.23405616e+07  6.23e+01 2.40e-01  1.33e+02     4s
   8  -2.99448137e+05  1.64415178e+07  1.22e+01 1.57e-01  7.90e+01     4s
   9  -2.43743580e+05  1.05543749e+07  7.62e+00 6.88e-02  4.99e+01     4s
  10  -1.63896220e+05  5.94788264e+06  4.24e+00 4.32e-03  2.77e+01     4s
  11  -1.42968529e+05  2.49191202e+06  3.11e+00 1.86e-03  1.19e+01     5s
  12  -1.12231675e+05  1.35599368e+06  1.84e+00 1.00e-03  6.56e+00     5s
  13  -7.92157229e+04  5.47122983e+05  1.00e+00 3.77e-04  2.78e+00     5s
  14  -4.11468591e+04  3.61410421e+05  4.62e-01 2.58e-04  1.78e+00     5s
  15  -2.16935212e+04  2.73563752e+05  2.94e-01 1.97e-04  1.30e+00     5s
  16  -1.41613351e+04  1.53430100e+05  2.43e-01 1.04e-03  7.39e-01     5s
  17  -6.71925153e+03  1.26345877e+05  2.01e-01 1.82e-03  5.87e-01     5s
  18   6.68010808e+02  9.42042400e+04  1.56e-01 1.15e-03  4.12e-01     5s
  19   6.70249178e+03  7.43860726e+04  1.24e-01 2.09e-03  2.99e-01     5s
  20   1.11652550e+04  6.52138111e+04  1.01e-01 1.61e-03  2.38e-01     5s
  21   1.45987306e+04  5.54331627e+04  8.43e-02 3.69e-03  1.80e-01     5s
  22   1.80121991e+04  5.02888546e+04  6.82e-02 2.64e-03  1.42e-01     5s
  23   2.16571201e+04  4.57108343e+04  5.17e-02 2.86e-03  1.06e-01     5s
  24   2.32370142e+04  4.38181372e+04  4.51e-02 2.12e-03  9.08e-02     5s
  25   2.58860136e+04  4.20218711e+04  3.43e-02 1.73e-03  7.12e-02     5s
  26   2.77407462e+04  4.12149827e+04  2.69e-02 1.41e-03  5.94e-02     5s
  27   2.78959191e+04  4.08792873e+04  2.63e-02 1.33e-03  5.73e-02     6s
  28   2.83631263e+04  3.99263548e+04  2.44e-02 1.13e-03  5.10e-02     6s
  29   2.99467830e+04  3.90740175e+04  1.80e-02 9.40e-04  4.03e-02     6s
  30   3.07203220e+04  3.82930928e+04  1.51e-02 7.72e-04  3.34e-02     6s
  31   3.15763174e+04  3.74827151e+04  1.18e-02 5.95e-04  2.61e-02     6s
  32   3.25801256e+04  3.68191641e+04  8.15e-03 4.29e-04  1.87e-02     6s
  33   3.32520231e+04  3.63406710e+04  5.84e-03 3.20e-04  1.36e-02     6s
  34   3.34525690e+04  3.59785014e+04  5.15e-03 2.39e-04  1.11e-02     6s
  35   3.40452691e+04  3.58215081e+04  2.99e-03 2.01e-04  7.83e-03     6s
  36   3.41473271e+04  3.57623256e+04  2.66e-03 1.87e-04  7.12e-03     6s
  37   3.43147745e+04  3.55569314e+04  2.10e-03 1.37e-04  5.48e-03     6s
  38   3.44461615e+04  3.52275286e+04  1.67e-03 5.93e-05  3.45e-03     6s
  39   3.44795650e+04  3.52035336e+04  1.56e-03 5.35e-05  3.19e-03     7s
  40   3.45604994e+04  3.51937142e+04  1.31e-03 5.10e-05  2.79e-03     7s
  41   3.46058397e+04  3.51420789e+04  1.16e-03 3.78e-05  2.37e-03     7s
  42   3.46818654e+04  3.50445339e+04  9.17e-04 2.08e-05  1.60e-03     7s
  43   3.47672970e+04  3.50228986e+04  6.46e-04 1.57e-05  1.13e-03     7s
  44   3.48056954e+04  3.50164364e+04  5.24e-04 1.35e-05  9.31e-04     7s
  45   3.48512702e+04  3.49987504e+04  3.84e-04 7.07e-06  6.52e-04     7s
  46   3.48941252e+04  3.49927805e+04  2.49e-04 4.94e-06  4.36e-04     7s
  47   3.49468166e+04  3.49881002e+04  8.16e-05 3.47e-06  1.82e-04     7s
  48   3.49602024e+04  3.49837669e+04  4.40e-05 2.05e-06  1.04e-04     7s
  49   3.49685153e+04  3.49811290e+04  2.24e-05 1.21e-06  5.56e-05     7s
  50   3.49754856e+04  3.49788771e+04  3.96e-06 9.78e-07  1.49e-05     7s
  51   3.49769607e+04  3.49773983e+04  4.24e-07 1.10e-07  1.93e-06     7s
  52   3.49771888e+04  3.49771892e+04  3.04e-10 9.32e-09  1.96e-09     8s
  53   3.49771888e+04  3.49771892e+04  5.48e-08 8.35e-09  1.77e-09     8s
  54   3.49771890e+04  3.49771890e+04  1.97e-08 6.25e-10  3.45e-11     8s

Barrier solved model in 54 iterations and 7.71 seconds (12.48 work units)
Optimal objective 3.49771890e+04


Root crossover log...

  112793 DPushes remaining with DInf 0.0000000e+00                 8s
     124 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                10s

    1293 PPushes remaining with PInf 2.3607918e-06                10s
       0 PPushes remaining with PInf 0.0000000e+00                10s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.4075307e-10     10s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   54848    3.4977189e+04   0.000000e+00   0.000000e+00     10s
   54848    3.4977189e+04   0.000000e+00   0.000000e+00     10s
Concurrent spin time: 0.00s

Solved with barrier

Root relaxation: objective 3.497719e+04, 54848 iterations, 7.63 seconds (14.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34977.1890    0  162 -210461.39 34977.1890   117%     -   10s
H    0     0                    -56798.72470 34977.1890   162%     -   11s
H    0     0                    -56285.92588 34977.1890   162%     -   11s
H    0     0                    -47667.90684 34977.1890   173%     -   11s
H    0     0                    -38638.98561 34977.1890   191%     -   11s
H    0     0                    -37875.90414 34977.1890   192%     -   11s
H    0     0                    -29856.03456 34977.1890   217%     -   11s
H    0     0                     542.0298139 34977.1890  6353%     -   12s
H    0     0                     619.6307511 34977.1890  5545%     -   12s
H    0     0                    1018.8164658 34977.1890  3333%     -   12s
H    0     0                    1271.4439376 34977.1890  2651%     -   14s
H    0     0                    2055.1773972 29798.5104  1350%     -   51s
H    0     0                    2056.5573060 29798.5104  1349%     -   51s
H    0     0                    2089.6063842 29798.5104  1326%     -   51s
H    0     0                    2109.7097795 29798.5104  1312%     -   51s
H    0     0                    2150.5591657 29798.5104  1286%     -   51s
H    0     0                    2208.3688597 29798.5104  1249%     -   51s
H    0     0                    2346.0691707 29798.5104  1170%     -   51s
     0     0 29798.5104    0  297 2346.06917 29798.5104  1170%     -   51s
H    0     0                    2353.1967846 29796.7183  1166%     -   52s
     0     0 29517.3633    0  272 2353.19678 29517.3633  1154%     -   65s
     0     0 29436.7658    0  316 2353.19678 29436.7658  1151%     -   71s
     0     0 29435.7420    0  304 2353.19678 29435.7420  1151%     -   77s
     0     0 29431.2214    0  319 2353.19678 29431.2214  1151%     -   78s
     0     0 29429.3792    0  319 2353.19678 29429.3792  1151%     -   78s
     0     0 29429.1129    0  328 2353.19678 29429.1129  1151%     -   79s
H    0     0                    2481.3796334 25772.6004   939%     -  124s
H    0     0                    2546.4006953 25772.6004   912%     -  124s
H    0     0                    2562.7122129 25772.6004   906%     -  124s
H    0     0                    2604.2103894 25772.6004   890%     -  124s
H    0     0                    2615.9222749 25772.6004   885%     -  124s
     0     0 25772.6004    0  221 2615.92227 25772.6004   885%     -  124s
H    0     0                    2644.5349871 25772.5874   875%     -  124s
     0     0 24851.7964    0  283 2644.53499 24851.7964   840%     -  153s
     0     0 24760.3602    0  240 2644.53499 24760.3602   836%     -  168s
     0     0 24705.1466    0  282 2644.53499 24705.1466   834%     -  173s
     0     0 24632.7437    0  293 2644.53499 24632.7437   831%     -  189s
     0     0 24569.7397    0  296 2644.53499 24569.7397   829%     -  197s
     0     0 24550.1558    0  292 2644.53499 24550.1558   828%     -  201s
     0     0 24546.2971    0  301 2644.53499 24546.2971   828%     -  206s
     0     0 24440.0997    0  362 2644.53499 24440.0997   824%     -  219s
     0     0 24423.5615    0  362 2644.53499 24423.5615   824%     -  226s
     0     0 24118.9586    0  320 2644.53499 24118.9586   812%     -  240s
     0     0 24096.3011    0  364 2644.53499 24096.3011   811%     -  246s
     0     0 24092.8166    0  371 2644.53499 24092.8166   811%     -  248s
     0     0 24092.0861    0  371 2644.53499 24092.0861   811%     -  249s
H    0     0                    2662.4118043 24092.0861   805%     -  262s
H    0     0                    2678.0733718 24092.0861   800%     -  262s
     0     0 21276.8080    0  421 2678.07337 21276.8080   694%     -  302s
H    0     0                    2713.7251749 21273.7032   684%     -  303s
H    0     0                    2721.9342190 21273.7032   682%     -  303s
     0     0 21010.3750    0  400 2721.93422 21010.3750   672%     -  319s
     0     0 20816.6382    0  404 2721.93422 20816.6382   665%     -  339s
     0     0 20749.4630    0  422 2721.93422 20749.4630   662%     -  351s
     0     0 20699.9096    0  430 2721.93422 20699.9096   660%     -  361s
     0     0 20680.9146    0  416 2721.93422 20680.9146   660%     -  369s
     0     0 20650.6798    0  440 2721.93422 20650.6798   659%     -  379s
     0     0 20624.6711    0  438 2721.93422 20624.6711   658%     -  388s
     0     0 20619.1991    0  448 2721.93422 20619.1991   658%     -  394s
     0     0 20608.1498    0  434 2721.93422 20608.1498   657%     -  397s
     0     0 20587.2779    0  437 2721.93422 20587.2779   656%     -  402s
     0     0 20573.3400    0  440 2721.93422 20573.3400   656%     -  407s
     0     0 20564.8806    0  444 2721.93422 20564.8806   656%     -  411s
     0     0 20547.2837    0  437 2721.93422 20547.2837   655%     -  415s
     0     0 20541.0718    0  438 2721.93422 20541.0718   655%     -  417s
     0     0 20535.5856    0  446 2721.93422 20535.5856   654%     -  419s
     0     0 20534.1620    0  454 2721.93422 20534.1620   654%     -  421s
H    0     0                    2761.0788581 19239.6842   597%     -  480s
H    0     0                    2777.4123574 19239.6842   593%     -  480s
H    0     0                    2866.0748326 19239.6842   571%     -  480s
H    0     0                    2884.7120587 19239.6842   567%     -  480s
H    0     0                    3013.8976409 19239.6842   538%     -  480s
H    0     0                    3023.7928455 19239.6842   536%     -  480s
H    0     0                    3043.1801156 19239.6842   532%     -  480s
     0     0 19239.6842    0  487 3043.18012 19239.6842   532%     -  480s
H    0     0                    3513.8015576 19239.6408   448%     -  481s
H    0     0                    3524.5882564 19239.6408   446%     -  481s
     0     0 18919.1708    0  488 3524.58826 18919.1708   437%     -  505s
     0     0 18857.7731    0  485 3524.58826 18857.7731   435%     -  514s
     0     0 18796.7272    0  508 3524.58826 18796.7272   433%     -  522s
     0     0 18775.6764    0  505 3524.58826 18775.6764   433%     -  528s
     0     0 18753.0726    0  504 3524.58826 18753.0726   432%     -  533s
     0     0 18747.5499    0  488 3524.58826 18747.5499   432%     -  537s
     0     0 18745.5108    0  504 3524.58826 18745.5108   432%     -  539s
     0     0 18504.5637    0  497 3524.58826 18504.5637   425%     -  563s
     0     0 18454.0187    0  490 3524.58826 18454.0187   424%     -  573s
     0     0 18424.9679    0  496 3524.58826 18424.9679   423%     -  580s
     0     0 18401.7958    0  495 3524.58826 18401.7958   422%     -  586s
     0     0 18393.8610    0  515 3524.58826 18393.8610   422%     -  591s
     0     0 18387.5469    0  510 3524.58826 18387.5469   422%     -  594s
     0     0 18387.0706    0  518 3524.58826 18387.0706   422%     -  596s
     0     0 18310.6622    0  535 3524.58826 18310.6622   420%     -  611s
     0     0 18288.0454    0  497 3524.58826 18288.0454   419%     -  623s
     0     0 18260.0335    0  512 3524.58826 18260.0335   418%     -  633s
     0     0 18253.0762    0  551 3524.58826 18253.0762   418%     -  640s
     0     0 18250.6015    0  543 3524.58826 18250.6015   418%     -  643s
     0     0 18248.9273    0  552 3524.58826 18248.9273   418%     -  646s
     0     0 18185.6291    0  549 3524.58826 18185.6291   416%     -  658s
     0     0 18174.5321    0  499 3524.58826 18174.5321   416%     -  664s
     0     0 18170.2346    0  553 3524.58826 18170.2346   416%     -  668s
     0     0 18167.4992    0  497 3524.58826 18167.4992   415%     -  673s
     0     0 18164.5086    0  550 3524.58826 18164.5086   415%     -  677s
     0     0 18154.6845    0  550 3524.58826 18154.6845   415%     -  682s
     0     0 18149.3461    0  553 3524.58826 18149.3461   415%     -  685s
     0     0 18148.6714    0  546 3524.58826 18148.6714   415%     -  687s
     0     0 18131.1328    0  565 3524.58826 18131.1328   414%     -  695s
     0     0 18127.7491    0  574 3524.58826 18127.7491   414%     -  699s
     0     0 18127.1963    0  577 3524.58826 18127.1963   414%     -  701s
     0     0 18098.8237    0  512 3524.58826 18098.8237   414%     -  715s
     0     0 18093.1093    0  618 3524.58826 18093.1093   413%     -  724s
     0     0 18092.0339    0  559 3524.58826 18092.0339   413%     -  727s
     0     0 18087.9012    0  566 3524.58826 18087.9012   413%     -  735s
     0     0 18084.4220    0  521 3524.58826 18084.4220   413%     -  739s
     0     0 18084.0683    0  514 3524.58826 18084.0683   413%     -  742s
     0     0 18071.3629    0  504 3524.58826 18071.3629   413%     -  753s
     0     0 18069.3079    0  517 3524.58826 18069.3079   413%     -  760s
     0     0 18059.2429    0  513 3524.58826 18059.2429   412%     -  768s
     0     0 18058.8077    0  513 3524.58826 18058.8077   412%     -  772s
H    0     0                    3525.8476955 18058.8077   412%     -  828s
H    0     0                    3568.3604047 18058.8077   406%     -  828s
H    0     2                    3572.5560815 18058.8077   405%     -  905s
     0     2 18058.8077    0  513 3572.55608 18058.8077   405%     -  905s
     1     3 17876.3600    1  492 3572.55608 18058.5199   405% 15281  924s
     2     4 17946.6837    1  500 3572.55608 17946.6837   402% 11701  934s
     3     6 17463.7479    2  562 3572.55608 17946.3477   402% 11517  947s
     5     9 16337.8489    3  432 3572.55608 17946.3477   402% 11165  968s
     8    18 16527.6884    3  412 3572.55608 17463.5928   389% 11281  991s
    17    36 15763.8809    4  401 3572.55608 16946.4626   374% 12156 1025s
    35    50 15737.5956    5  509 3572.55608 16363.0966   358% 19295 1126s
H   49    76                    3683.0946225 16363.0966   344% 19070 1175s
H   69    76                    3694.2025736 16363.0966   343% 17115 1175s
    75   184 13646.8584    7  289 3694.20257 16363.0966   343% 16353 1225s
   183   250 12891.1175   12  257 3694.20257 16363.0966   343%  9427 1253s
H  187   250                    3695.1453401 16363.0966   343%  9272 1253s
   249   291 11755.9544   16  181 3695.14534 16363.0966   343%  8927 1282s
   290   314 11703.4783   17  187 3695.14534 16363.0966   343%  8349 1304s
   313   343 11486.2300   18  185 3695.14534 16363.0966   343%  8327 1330s
   342   364 11454.4987   19  179 3695.14534 16363.0966   343%  8095 1386s
   363   397 11176.3268   20  181 3695.14534 16363.0966   343%  7885 1452s
   396   439 11010.8160   21  175 3695.14534 16363.0966   343%  7585 1473s
   438   484 11009.2461   22  169 3695.14534 16363.0966   343%  7214 1494s
   483   534 10866.6547   24  163 3695.14534 16363.0966   343%  6813 1516s
   533   592 9943.94849   27  165 3695.14534 16363.0966   343%  6439 1538s
   595   653 9409.47178   32  140 3695.14534 16363.0966   343%  6071 1560s
   661   694 9044.04691   37  128 3695.14534 16363.0966   343%  5777 1587s
   712   750 9012.61526   38  128 3695.14534 16363.0966   343%  5533 1608s
   780   795 8564.55578   43  121 3695.14534 16363.0966   343%  5248 1627s
   842   844 7343.74531   47  124 3695.14534 16363.0966   343%  5032 1647s
H  849   844                    3734.7384203 16363.0966   338%  5013 1647s
   916   870 infeasible   50      3734.73842 16363.0966   338%  4838 1668s
  1010   894 9466.78943   15  183 3734.73842 16363.0966   338%  4687 1697s
  1098   910 9330.16714   17  154 3734.73842 16363.0966   338%  4545 1724s
  1170   946 infeasible   19      3734.73842 16363.0966   338%  4485 1757s
  1254  1034 11816.0998    9  215 3734.73842 16349.7447   338%  4382 1783s
  1385  1169 4135.80291   10  202 3734.73842 16349.7447   338%  4181 1807s
  1560  1304 4080.47717   11  197 3734.73842 16349.7447   338%  3878 1833s
  1748  1472 8784.84758   11  240 3734.73842 16349.7447   338%  3658 1859s
  1951  1512 8748.48992   12  239 3734.73842 16349.7447   338%  3432 1881s
  2036  1613 6735.49348   13  227 3734.73842 16349.7447   338%  3369 1906s
  2239  1757 6290.89859   14  226 3734.73842 16349.7447   338%  3193 1935s
  2455  1882 6181.62617   15  218 3734.73842 16349.7447   338%  3022 1962s
  2652  2025 5593.15893   17  205 3734.73842 16349.7447   338%  2913 1993s
  2893  2186 5185.43683   21  202 3734.73842 16349.7447   338%  2791 2024s
  3116  2280 4685.79319   23  157 3734.73842 16349.7447   338%  2696 2058s
  3313  2298 3801.21836   28  134 3734.73842 16349.7447   338%  2634 2091s
  3365  2350 infeasible   29      3734.73842 16349.7447   338%  2653 2122s
  3541  2372 infeasible   87      3734.73842 16229.2388   335%  2637 2161s
  3641  2417 8856.90758    6  350 3734.73842 16229.1385   335%  2696 2204s
  3720  2458 7633.06246    7  366 3734.73842 16113.1400   331%  2745 2247s
  3817  2551 6194.89624    8  238 3734.73842 16105.4062   331%  2809 2291s
  3976  2626 5050.10820    9  206 3734.73842 16105.4062   331%  2834 2342s
  4110  2683 4711.26617   10  180 3734.73842 16105.4062   331%  2863 2391s
  4289  2720     cutoff   11      3734.73842 15763.7495   322%  2895 2443s
  4398  2767 15642.1728    6  413 3734.73842 15763.7495   322%  2940 2495s
  4519  2804 15212.2294    7  365 3734.73842 15763.7495   322%  3000 2552s
  4634  2856 6885.48557   15  425 3734.73842 15763.7495   322%  3063 2608s
  4782  2873 5772.36199   74  331 3734.73842 15763.7495   322%  3104 2659s
  4823  2913 5692.18346   75  207 3734.73842 15763.7495   322%  3140 2703s
  4903  2966 5619.71116   76  299 3734.73842 15763.7495   322%  3152 2751s
  5011  2967 13811.8021   22  513 3734.73842 15763.7495   322%  3156 3154s
  5013  2968 6820.55751   77  156 3734.73842 15763.7495   322%  3155 3168s
  5014  2969 5073.80386  104  356 3734.73842 15763.7495   322%  3155 3253s
  5015  2970 6902.50646   94  398 3734.73842 15763.7495   322%  3154 3305s
  5016  2970 8275.99582   74  441 3734.73842 15763.7495   322%  3153 3361s
  5017  2971 10161.8249   53  448 3734.73842 15763.7495   322%  3153 3423s
  5018  2972 8848.53483   16  570 3734.73842 15763.7495   322%  3152 3466s
  5019  2972 7073.38971   95  485 3734.73842 15763.7495   322%  3151 3492s
  5020  2973 7354.09436   70  579 3734.73842 15763.7495   322%  3151 3512s
  5021  2974 12168.0604   41  492 3734.73842 15763.7495   322%  3150 3527s
  5022  2974 5253.41258   31  556 3734.73842 15763.7495   322%  3149 3543s
  5023  2975 3870.17373   22  558 3734.73842 15763.7495   322%  3149 3559s
  5024  2976 7528.80809   73  554 3734.73842 15763.7495   322%  3148 3573s
  5025  2976 7996.55518   90  586 3734.73842 15763.7495   322%  3148 3597s

Cutting planes:
  Learned: 1
  Gomory: 13
  Implied bound: 29
  Projected implied bound: 94
  MIR: 1014
  Flow cover: 1310
  RLT: 21
  Relax-and-lift: 171

Explored 5025 nodes (16789798 simplex iterations) in 3600.03 seconds (8176.94 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3734.74 3695.15 3694.2 ... 3043.18

Time limit reached
Best objective 3.734738420299e+03, best bound 1.576374946220e+04, gap 322.0844%
  WARNING: Time limit reached. Using best solution found (gap: 322.08%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.20s
  Master Objective (UB) = 3734.74, θ = 145596.95
  Upper Bound (UB) = 3734.74

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145596.95
  [DEBUG]   ✓ Scenario 0: θ = 145596.95 ≤ Q = 145596.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145596.95 ≤ Q = 145596.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145596.95 ≤ Q = 145596.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145596.95 ≤ Q = 145596.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145596.95 ≤ Q = 145596.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145596.95 ≤ Q = 145596.95 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 145596.95 ≤ Q = 145596.95 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 15] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x6a6fcd0d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x959032f3
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.153842e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5758794.0547
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.273397e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127339.73    0  122 5758794.05 -127339.73   102%     -    0s
H    0     0                    -95326.39174 -127339.73  33.6%     -    0s
H    0     0                    -95890.52998 -127339.73  32.8%     -    0s
     0     0 -100838.89    0  112 -95890.530 -100838.89  5.16%     -    0s
H    0     0                    -99043.46103 -100790.36  1.76%     -    0s
     0     0 -100214.97    0   84 -99043.461 -100214.97  1.18%     -    0s
H    0     0                    -99264.68630 -100190.30  0.93%     -    0s
     0     0 -100187.95    0   84 -99264.686 -100187.95  0.93%     -    0s
     0     0 -100180.00    0   84 -99264.686 -100180.00  0.92%     -    0s
     0     0 -99845.404    0   89 -99264.686 -99845.404  0.59%     -    0s
     0     0 -99826.897    0   90 -99264.686 -99826.897  0.57%     -    0s
     0     0 -99725.290    0   70 -99264.686 -99725.290  0.46%     -    0s
     0     0 -99713.411    0   91 -99264.686 -99713.411  0.45%     -    0s
     0     0 -99636.491    0   80 -99264.686 -99636.491  0.37%     -    0s
     0     0 -99635.055    0   80 -99264.686 -99635.055  0.37%     -    0s
     0     2 -99635.055    0   80 -99264.686 -99635.055  0.37%     -    0s
H   82    32                    -99277.35550 -99412.353  0.14%  15.8    0s
H  318    80                    -99305.40344 -99383.390  0.08%   7.4    0s
H  474    26                    -99309.98677 -99383.390  0.07%   5.9    0s
H  506    26                    -99317.28210 -99359.811  0.04%   5.7    0s
H  511    26                    -99331.94381 -99352.871  0.02%   5.7    0s
*  551    26              27    -99342.14421 -99352.349  0.01%   5.5    0s

Cutting planes:
  Gomory: 25
  Implied bound: 3
  MIR: 172
  Flow cover: 23
  RLT: 3

Explored 603 nodes (3693 simplex iterations) in 0.16 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -99342.1 -99331.9 -99317.3 ... -95326.4
No other solutions better than -99342.1

Optimal solution found (tolerance 1.00e-06)
Best objective -9.934214420518e+04, best bound -9.934214420518e+04, gap 0.0000%
  Subproblem solved in 0.18s
  Worst-case operational profit (Z_SP) = 144195.60
  Scenario: 30 demand increases, 30 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99342.14
  [DEBUG]   S×d_nominal = 243537.75
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243537.75 + -99342.14 = 144195.60
  [DEBUG]   Current θ from Master = 145596.95
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1401.35 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 2333.39
  Lower Bound (LB) = 2333.39
  Gap (UB-LB) = 1401.3458, Absolute Gap = 1401.3458, Relative Gap = 0.375219
  Not converged yet (gap = 1401.35 > ε = 200)

  [DEBUG] Adding NEW scenario 15 to Master Problem...
  [DEBUG] New scenario pattern: 30 increases, 30 decreases
    [DEBUG] Scenario 15 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 15 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 15]
    [DEBUG]   - Total constraints in model: 246023
    [DEBUG]   - Total variables in model: 102100
  [DEBUG] Total scenarios in Master: 16
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 16
================================================================================
[Iteration 16] Solving Master Problem...
  Current scenarios in Master: 16
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 246023 rows, 102100 columns and 697215 nonzeros
Model fingerprint: 0x64d3044d
Variable types: 99841 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 113120 rows and 45920 columns
Presolve time: 2.20s
Presolved: 132903 rows, 56180 columns, 818666 nonzeros
Variable types: 53921 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -364542.2970
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 1.07s

Barrier statistics:
 Dense cols : 602
 AA' NZ     : 6.839e+06
 Factor NZ  : 1.484e+07 (roughly 200 MB of memory)
 Factor Ops : 3.205e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.94253491e+07  2.15942444e+08  1.11e+05 1.58e+01  8.40e+04     5s
   1  -1.49927491e+07  1.96355311e+08  7.96e+04 5.82e+01  5.97e+04     5s
   2  -5.00255921e+06  1.56289559e+08  2.60e+04 9.15e-01  2.06e+04     5s
   3  -1.61544352e+06  1.50890467e+08  5.45e+03 1.36e+01  4.81e+03     5s
   4  -7.39490240e+05  1.17096703e+08  1.34e+03 7.02e+00  1.48e+03     5s
   5  -6.56615956e+05  5.11622039e+07  1.00e+03 4.36e-01  8.86e+02     5s
   6  -4.89103450e+05  3.52720801e+07  4.16e+02 7.67e-02  4.12e+02     5s
   7  -3.69047340e+05  2.63580898e+07  9.84e+01 5.08e-02  1.69e+02     5s
   8  -2.56123952e+05  1.70839797e+07  3.34e+01 3.02e-02  8.83e+01     5s
   9  -1.78421732e+05  1.47793977e+07  1.43e+01 2.56e-02  6.82e+01     5s
  10  -1.37006737e+05  9.92724377e+06  7.69e+00 1.27e-01  4.41e+01     5s
  11  -1.08468320e+05  4.26245984e+06  2.79e+00 6.59e-03  1.85e+01     5s
  12  -9.05444294e+04  1.03591044e+06  1.54e+00 2.20e-02  4.72e+00     6s
  13  -6.29923648e+04  4.89191747e+05  7.86e-01 7.45e-04  2.30e+00     6s
  14  -3.66872841e+04  2.55494465e+05  4.10e-01 3.51e-04  1.21e+00     6s
  15  -2.22250960e+04  1.74023119e+05  3.06e-01 2.29e-04  8.14e-01     6s
  16  -1.12645530e+04  1.12253934e+05  2.48e-01 1.80e-04  5.12e-01     6s
  17  -5.34357915e+03  9.09057399e+04  2.13e-01 1.14e-03  3.99e-01     6s
  18   5.95771608e+02  7.81073733e+04  1.78e-01 7.89e-04  3.22e-01     6s
  19   5.95190590e+03  6.34094635e+04  1.48e-01 9.24e-04  2.38e-01     6s
  20   8.95168758e+03  5.56190496e+04  1.32e-01 1.93e-03  1.94e-01     6s
  21   1.47583454e+04  4.98865164e+04  9.97e-02 1.15e-03  1.46e-01     6s
  22   1.95444614e+04  4.63250402e+04  7.33e-02 5.50e-03  1.11e-01     6s
  23   2.17540232e+04  4.41548490e+04  6.16e-02 5.15e-03  9.30e-02     6s
  24   2.29484686e+04  4.23353499e+04  5.54e-02 3.94e-03  8.05e-02     6s
  25   2.47892148e+04  4.14874981e+04  4.61e-02 4.02e-03  6.93e-02     6s
  26   2.58295050e+04  4.07415766e+04  4.10e-02 3.64e-03  6.19e-02     6s
  27   2.72707359e+04  3.95909359e+04  3.42e-02 2.91e-03  5.11e-02     7s
  28   2.75521554e+04  3.91580447e+04  3.28e-02 2.67e-03  4.82e-02     7s
  29   2.83726900e+04  3.85988185e+04  2.89e-02 2.33e-03  4.25e-02     7s
  30   2.96760504e+04  3.79322870e+04  2.28e-02 1.97e-03  3.43e-02     7s
  31   3.07980649e+04  3.76324708e+04  1.77e-02 1.78e-03  2.84e-02     7s
  32   3.16442202e+04  3.72570151e+04  1.39e-02 1.57e-03  2.33e-02     7s
  33   3.21922765e+04  3.64317239e+04  1.15e-02 1.02e-03  1.76e-02     7s
  34   3.27950368e+04  3.60563890e+04  8.92e-03 7.29e-04  1.35e-02     7s
  35   3.34056883e+04  3.58415513e+04  6.41e-03 5.89e-04  1.01e-02     7s
  36   3.36535355e+04  3.55222236e+04  5.40e-03 4.13e-04  7.76e-03     7s
  37   3.39022590e+04  3.54766324e+04  4.31e-03 3.80e-04  6.53e-03     7s
  38   3.43023270e+04  3.53036676e+04  2.70e-03 2.44e-04  4.16e-03     8s
  39   3.44193923e+04  3.51948880e+04  2.22e-03 1.78e-04  3.22e-03     8s
  40   3.45119543e+04  3.51332339e+04  1.82e-03 1.43e-04  2.58e-03     8s
  41   3.46565297e+04  3.51170003e+04  1.24e-03 1.28e-04  1.91e-03     8s
  42   3.47029986e+04  3.50195460e+04  1.05e-03 1.25e-04  1.32e-03     8s
  43   3.47997228e+04  3.50043078e+04  6.68e-04 7.64e-05  8.50e-04     8s
  44   3.48700710e+04  3.49880842e+04  4.03e-04 8.37e-05  4.91e-04     8s
  45   3.49496856e+04  3.49829213e+04  8.68e-05 3.99e-05  1.38e-04     8s
  46   3.49650709e+04  3.49784970e+04  3.72e-05 1.36e-05  5.57e-05     8s
  47   3.49756986e+04  3.49775993e+04  4.34e-06 3.58e-06  7.88e-06     8s
  48   3.49771674e+04  3.49771960e+04  4.51e-08 4.74e-08  1.19e-07     8s
  49   3.49771888e+04  3.49771890e+04  1.45e-09 3.68e-11  1.03e-09     8s

Barrier solved model in 49 iterations and 8.45 seconds (12.93 work units)
Optimal objective 3.49771888e+04


Root crossover log...

  120009 DPushes remaining with DInf 0.0000000e+00                 8s
   31140 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                13s

   12172 PPushes remaining with PInf 1.7848832e-04                13s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 6.1710000e+03     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   74761    3.4977189e+04   0.000000e+00   6.171000e+03     14s
   75431    3.4977189e+04   0.000000e+00   0.000000e+00     15s
   75431    3.4977189e+04   0.000000e+00   0.000000e+00     15s
Concurrent spin time: 0.48s

Solved with barrier

Root relaxation: objective 3.497719e+04, 75431 iterations, 12.36 seconds (24.33 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34977.1890    0  162 -210461.39 34977.1890   117%     -   15s
H    0     0                    -208309.9181 34977.1890   117%     -   16s
H    0     0                    -172313.5584 34977.1890   120%     -   16s
H    0     0                    -151724.7652 34977.1890   123%     -   16s
H    0     0                    -103468.0891 34977.1890   134%     -   16s
H    0     0                    -47667.90684 34977.1890   173%     -   16s
H    0     0                    -23929.59811 34977.1890   246%     -   17s
H    0     0                    -23166.51664 34977.1890   251%     -   17s
H    0     0                     542.0298139 34977.1890  6353%     -   17s
H    0     0                     633.2221554 34977.1890  5424%     -   18s
H    0     0                    1013.0333800 34977.1890  3353%     -   18s
     0     0 28907.2648    0  329 1013.03338 28907.2648  2754%     -   71s
H    0     0                    1018.8164658 28907.1196  2737%     -   72s
H    0     0                    1090.4646286 28907.1196  2551%     -   72s
     0     0 28471.0369    0  334 1090.46463 28471.0369  2511%     -   89s
     0     0 28447.4229    0  332 1090.46463 28447.4229  2509%     -   93s
     0     0 28430.8636    0  326 1090.46463 28430.8636  2507%     -   98s
     0     0 28424.2468    0  333 1090.46463 28424.2468  2507%     -   99s
     0     0 28422.9507    0  336 1090.46463 28422.9507  2506%     -  100s
     0     0 28422.9399    0  331 1090.46463 28422.9399  2506%     -  101s
     0     0 25254.9151    0  337 1090.46463 25254.9151  2216%     -  149s
H    0     0                    1120.1393391 25254.8999  2155%     -  150s
H    0     0                    1380.3215586 25254.8999  1730%     -  150s
H    0     0                    1451.7246563 25254.8999  1640%     -  150s
     0     0 24722.3479    0  251 1451.72466 24722.3479  1603%     -  177s
     0     0 24618.6460    0  376 1451.72466 24618.6460  1596%     -  196s
     0     0 24489.6867    0  261 1451.72466 24489.6867  1587%     -  208s
     0     0 24038.3968    0  383 1451.72466 24038.3968  1556%     -  227s
     0     0 23997.2214    0  355 1451.72466 23997.2214  1553%     -  235s
     0     0 23830.7885    0  380 1451.72466 23830.7885  1542%     -  249s
     0     0 23812.2930    0  381 1451.72466 23812.2930  1540%     -  258s
     0     0 23735.7353    0  380 1451.72466 23735.7353  1535%     -  269s
     0     0 23705.2127    0  395 1451.72466 23705.2127  1533%     -  275s
     0     0 23686.8297    0  377 1451.72466 23686.8297  1532%     -  278s
     0     0 23674.6868    0  388 1451.72466 23674.6868  1531%     -  281s
     0     0 23605.1300    0  378 1451.72466 23605.1300  1526%     -  292s
     0     0 23594.5064    0  387 1451.72466 23594.5064  1525%     -  295s
     0     0 23568.1616    0  395 1451.72466 23568.1616  1523%     -  299s
     0     0 23566.8526    0  400 1451.72466 23566.8526  1523%     -  300s
     0     0 23562.5655    0  357 1451.72466 23562.5655  1523%     -  301s
     0     0 23562.3954    0  359 1451.72466 23562.3954  1523%     -  302s
     0     0 21447.2730    0  466 1451.72466 21447.2730  1377%     -  350s
H    0     0                    1725.7784258 21446.4702  1143%     -  351s
     0     0 21049.3348    0  393 1725.77843 21049.3348  1120%     -  375s
     0     0 20891.4634    0  419 1725.77843 20891.4634  1111%     -  390s
     0     0 20810.7415    0  416 1725.77843 20810.7415  1106%     -  400s
     0     0 20787.3637    0  421 1725.77843 20787.3637  1105%     -  406s
     0     0 20741.0990    0  412 1725.77843 20741.0990  1102%     -  413s
     0     0 20738.2603    0  416 1725.77843 20738.2603  1102%     -  416s
     0     0 20729.6551    0  420 1725.77843 20729.6551  1101%     -  420s
     0     0 20722.6395    0  423 1725.77843 20722.6395  1101%     -  422s
     0     0 20720.4376    0  427 1725.77843 20720.4376  1101%     -  423s
     0     0 20713.8264    0  421 1725.77843 20713.8264  1100%     -  427s
     0     0 20713.5248    0  508 1725.77843 20713.5248  1100%     -  428s
     0     0 19941.2090    0  368 1725.77843 19941.2090  1055%     -  471s
H    0     0                    1871.9642310 19940.2469   965%     -  471s
H    0     0                    1885.2891524 19940.2469   958%     -  471s
     0     0 19599.8469    0  487 1885.28915 19599.8469   940%     -  499s
     0     0 19367.0155    0  540 1885.28915 19367.0155   927%     -  524s
     0     0 19278.1463    0  601 1885.28915 19278.1463   923%     -  544s
     0     0 19234.2335    0  561 1885.28915 19234.2335   920%     -  558s
     0     0 19193.6046    0  643 1885.28915 19193.6046   918%     -  570s
     0     0 19185.7522    0  645 1885.28915 19185.7522   918%     -  574s
     0     0 19173.0067    0  577 1885.28915 19173.0067   917%     -  580s
     0     0 19110.3549    0  563 1885.28915 19110.3549   914%     -  590s
     0     0 19096.0563    0  567 1885.28915 19096.0563   913%     -  597s
     0     0 19087.9303    0  561 1885.28915 19087.9303   912%     -  602s
     0     0 19080.5449    0  568 1885.28915 19080.5449   912%     -  606s
     0     0 19078.3733    0  570 1885.28915 19078.3733   912%     -  608s
     0     0 18852.4033    0  502 1885.28915 18852.4033   900%     -  636s
H    0     0                    2039.5972726 18852.2006   824%     -  636s
     0     0 18804.1137    0  426 2039.59727 18804.1137   822%     -  648s
     0     0 18789.9261    0  438 2039.59727 18789.9261   821%     -  656s
     0     0 18777.1064    0  445 2039.59727 18777.1064   821%     -  664s
     0     0 18774.7110    0  439 2039.59727 18774.7110   821%     -  667s
     0     0 18768.9826    0  525 2039.59727 18768.9826   820%     -  673s
     0     0 18766.4054    0  619 2039.59727 18766.4054   820%     -  679s
     0     0 18762.4764    0  555 2039.59727 18762.4764   820%     -  686s
     0     0 18758.3058    0  548 2039.59727 18758.3058   820%     -  690s
     0     0 18754.1690    0  554 2039.59727 18754.1690   820%     -  694s
     0     0 18753.9731    0  556 2039.59727 18753.9731   819%     -  695s
     0     0 18632.4829    0  428 2039.59727 18632.4829   814%     -  715s
     0     0 18577.8509    0  565 2039.59727 18577.8509   811%     -  730s
     0     0 18562.3616    0  514 2039.59727 18562.3616   810%     -  741s
     0     0 18556.4708    0  497 2039.59727 18556.4708   810%     -  749s
     0     0 18552.8136    0  427 2039.59727 18552.8136   810%     -  752s
     0     0 18551.5503    0  508 2039.59727 18551.5503   810%     -  755s
     0     0 18501.9162    0  426 2039.59727 18501.9162   807%     -  772s
H    0     0                    2135.0066572 18501.5262   767%     -  772s
     0     0 18485.2429    0  434 2135.00666 18485.2429   766%     -  781s
     0     0 18477.7063    0  559 2135.00666 18477.7063   765%     -  784s
     0     0 18470.1802    0  442 2135.00666 18470.1802   765%     -  788s
     0     0 18467.2454    0  434 2135.00666 18467.2454   765%     -  792s
     0     0 18465.0184    0  439 2135.00666 18465.0184   765%     -  794s
     0     0 18411.8172    0  564 2135.00666 18411.8172   762%     -  807s
H    0     0                    2137.6700743 18411.8097   761%     -  807s
H    0     0                    2174.1985685 18411.8097   747%     -  807s
     0     0 18402.8760    0  564 2174.19857 18402.8760   746%     -  812s
     0     0 18396.5849    0  579 2174.19857 18396.5849   746%     -  815s
     0     0 18394.8747    0  577 2174.19857 18394.8747   746%     -  817s
     0     0 18369.5446    0  448 2174.19857 18369.5446   745%     -  825s
H    0     0                    2466.0462135 18369.4701   645%     -  826s
     0     0 18365.1366    0  519 2466.04621 18365.1366   645%     -  830s
     0     0 18362.2653    0  522 2466.04621 18362.2653   645%     -  832s
     0     0 18361.5580    0  518 2466.04621 18361.5580   645%     -  834s
     0     0 18320.9175    0  581 2466.04621 18320.9175   643%     -  847s
H    0     0                    2567.7711012 18320.8006   613%     -  848s
     0     0 18304.1001    0  519 2567.77110 18304.1001   613%     -  857s
     0     0 18300.9777    0  519 2567.77110 18300.9777   613%     -  862s
     0     0 18298.8530    0  522 2567.77110 18298.8530   613%     -  866s
     0     0 18292.0564    0  590 2567.77110 18292.0564   612%     -  875s
     0     0 18285.6945    0  583 2567.77110 18285.6945   612%     -  884s
     0     0 18283.7223    0  575 2567.77110 18283.7223   612%     -  887s
     0     0 18269.6249    0  450 2567.77110 18269.6249   611%     -  898s
H    0     0                    2648.3171337 18269.5846   590%     -  898s
     0     0 18266.8304    0  538 2648.31713 18266.8304   590%     -  903s
     0     0 18264.3339    0  540 2648.31713 18264.3339   590%     -  906s
     0     0 18263.4240    0  540 2648.31713 18263.4240   590%     -  909s
     0     0 18259.5266    0  590 2648.31713 18259.5266   589%     -  915s
     0     0 18257.5736    0  456 2648.31713 18257.5736   589%     -  919s
     0     0 18255.1683    0  451 2648.31713 18255.1683   589%     -  923s
     0     0 18254.6922    0  455 2648.31713 18254.6922   589%     -  926s
     0     0 18251.5235    0  529 2648.31713 18251.5235   589%     -  930s
     0     0 18251.4751    0  529 2648.31713 18251.4751   589%     -  935s
H    0     0                    3090.4061899 18251.4751   491%     - 1050s
     0     2 18251.4751    0  529 3090.40619 18251.4751   491%     - 1055s
     1     3 17985.9672    1  553 3090.40619 18250.5833   491% 18832 1080s
     2     4 18206.4902    1  443 3090.40619 18206.4902   489% 11506 1090s
     3     6 18119.4180    2  591 3090.40619 18206.4290   489% 11243 1111s
     5    10 17870.0702    3  591 3090.40619 18206.4290   489% 12677 1138s
     9    18 17538.3324    4  670 3090.40619 18086.0714   485% 12879 1194s
    17    36 17479.5041    5  633 3090.40619 17869.4865   478% 14592 1230s
    35    50 16899.6467    6  409 3090.40619 17635.3099   471% 19290 1324s
H   49    78                    3448.6180045 17635.3099   411% 23260 1380s
    77   160 15470.3094    8  297 3448.61800 17635.3099   411% 18996 1453s
H  159   229                    3497.9401138 17635.3099   404% 13782 1490s
H  159   229                    3512.2086230 17635.3099   402% 13782 1490s
   228   291 14930.7531   12  287 3512.20862 17635.3099   402% 11222 1529s
   290   320 13361.2910   14  232 3512.20862 17635.3099   402% 10064 1556s
   319   370 12734.6462   15  223 3512.20862 17635.3099   402%  9641 1590s
H  330   370                    3535.5806575 17635.3099   399%  9497 1590s
H  343   370                    3536.3910219 17635.3099   399%  9249 1590s
H  364   370                    3564.0648814 17635.3099   395%  8995 1590s
   371   411 12720.6667   16  224 3564.06488 17635.3099   395%  8925 1630s
   416   445 4884.32854   18  212 3564.06488 17635.3099   395%  8549 1676s
   457   465 4300.31733   21  157 3564.06488 17635.3099   395%  8302 1707s
   484   496 4300.30755   22  156 3564.06488 17635.3099   395%  8329 1739s
   521   515 4106.38562   23  146 3564.06488 17635.3099   395%  8165 1770s
   549   542 4016.33470   24  142 3564.06488 17635.3099   395%  8035 1803s
   594   562 4008.87994   25  143 3564.06488 17635.3099   395%  7801 1835s
   648   588 3786.75000   29  150 3564.06488 17635.3099   395%  7450 1863s
   698   608     cutoff   33      3564.06488 17635.3099   395%  7202 1895s
   757   628 11086.5338   15  228 3564.06488 17635.3099   395%  6890 1927s
   809   676 12754.1467   35  314 3564.06488 17635.3099   395%  6686 1955s
   883   731 12579.0501   36  285 3564.06488 17635.3099   395%  6377 1984s
   970   807 12379.3350   37  287 3564.06488 17635.3099   395%  6044 2014s
  1094   866 11887.8205   43  274 3564.06488 17635.3099   395%  5613 2047s
  1200   953 11378.3663   46  243 3564.06488 17635.3099   395%  5339 2080s
  1316   974     cutoff   49      3564.06488 17635.3099   395%  5098 2109s
  1385  1025 10683.0406   47  233 3564.06488 17635.3099   395%  4981 2140s
  1492  1057 infeasible   49      3564.06488 17635.3099   395%  4816 2178s
  1566  1090 6660.33884   22  213 3564.06488 17635.3099   395%  4741 2215s
  1653  1099     cutoff   49      3564.06488 17635.3099   395%  4694 2248s
  1698  1166 14307.6582   14  556 3564.06488 17635.3099   395%  4734 2283s
  1779  1266 14138.6362   15  530 3564.06488 17635.3099   395%  4709 2322s
  1912  1338 11380.2017   16  304 3564.06488 17635.3099   395%  4590 2367s
  2050  1406 8078.88748   12  398 3564.06488 17133.8839   381%  4493 2418s
  2160  1529 7459.53639   17  295 3564.06488 17133.8839   381%  4437 2461s
  2315  1697 6788.10122   19  270 3564.06488 17133.8839   381%  4337 2506s
  2512  1806 5304.69980   27  206 3564.06488 17133.8839   381%  4158 2553s
  2725  1980 7475.89854  102  225 3564.06488 17133.8839   381%  3942 2596s
  2955  1992 5968.97511  119  123 3564.06488 17133.8839   381%  3802 2649s
  3054  2013     cutoff  120      3564.06488 17051.8585   378%  3803 2705s
  3177  2112 7990.72755   11  438 3564.06488 17051.8585   378%  3795 2761s
  3322  2205 7103.54827   12  399 3564.06488 16458.2298   362%  3789 2820s
  3476  2271 6987.25890   14  330 3564.06488 16376.6117   359%  3794 2886s
  3602  2340     cutoff   16      3564.06488 16001.6042   349%  3865 2950s
  3733  2442 5568.22007  118  116 3564.06488 16001.6042   349%  3909 3015s
  3883  2522 5130.16286  116  129 3564.06488 15791.8583   343%  3935 3076s
  3999  2523 5288.85082   27  529 3564.06488 15791.8583   343%  3925 3400s
  4001  2524 6889.28954   29  156 3564.06488 15791.8583   343%  3923 3417s
  4002  2525 15281.6820   15  370 3564.06488 15791.8583   343%  3922 3503s

Cutting planes:
  Gomory: 24
  Implied bound: 30
  Projected implied bound: 103
  MIR: 1170
  Mixing: 1
  Flow cover: 1194
  RLT: 16
  Relax-and-lift: 213

Explored 4002 nodes (16693190 simplex iterations) in 3600.04 seconds (8380.91 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3564.06 3536.39 3535.58 ... 2466.05

Time limit reached
Best objective 3.564064881379e+03, best bound 1.579185831756e+04, gap 343.0856%
  WARNING: Time limit reached. Using best solution found (gap: 343.09%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.15s
  Master Objective (UB) = 3564.06, θ = 146208.52
  Upper Bound (UB) = 3564.06

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 146208.52
  [DEBUG]   ✓ Scenario 0: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 10: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 13: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 146208.52 ≤ Q = 146208.52 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 16] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x655650e0
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x9aa9af20
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.153573e+13
Presolve removed 2598 rows and 1890 columns
Presolve time: 0.00s
Presolved: 495 rows, 499 columns, 1396 nonzeros
Found heuristic solution: objective 5763817.3377
Variable types: 339 continuous, 160 integer (160 binary)

Root relaxation: objective -1.269093e+05, 238 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -126909.28    0  122 5763817.34 -126909.28   102%     -    0s
H    0     0                    -94639.09461 -126909.28  34.1%     -    0s
H    0     0                    -95445.42026 -126909.28  33.0%     -    0s
     0     0 -100364.39    0   88 -95445.420 -100364.39  5.15%     -    0s
H    0     0                    -96418.07264 -100353.09  4.08%     -    0s
H    0     0                    -98737.35541 -100353.09  1.64%     -    0s
     0     0 -99803.738    0   75 -98737.355 -99803.738  1.08%     -    0s
     0     0 -99798.517    0   69 -98737.355 -99798.517  1.07%     -    0s
     0     0 -99724.438    0   86 -98737.355 -99724.438  1.00%     -    0s
H    0     0                    -98761.74845 -99724.438  0.97%     -    0s
H    0     0                    -98887.21231 -99724.438  0.85%     -    0s
     0     0 -99718.582    0   86 -98887.212 -99718.582  0.84%     -    0s
H    0     0                    -99536.79511 -99718.582  0.18%     -    0s
H    0     0                    -99581.27749 -99718.582  0.14%     -    0s
     0     2 -99718.582    0   84 -99581.277 -99718.582  0.14%     -    0s

Cutting planes:
  Gomory: 6
  MIR: 148

Explored 25 nodes (645 simplex iterations) in 0.11 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -99581.3 -98887.2 -98761.7 ... 1.15357e+13
No other solutions better than -99581.3

Optimal solution found (tolerance 1.00e-06)
Best objective -9.958127749000e+04, best bound -9.958127749000e+04, gap 0.0000%
  Subproblem solved in 0.12s
  Worst-case operational profit (Z_SP) = 144209.90
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -99581.28
  [DEBUG]   S×d_nominal = 243791.18
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243791.18 + -99581.28 = 144209.90
  [DEBUG]   Current θ from Master = 146208.52
  [DEBUG]   ⚠️  Z_SP ≤ θ by 1998.62 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 1565.44
  Lower Bound (LB) = 2333.39
  Gap (UB-LB) = 1230.6722, Absolute Gap = 1230.6722, Relative Gap = 0.345300
  Not converged yet (gap = 1230.67 > ε = 200)

  [DEBUG] Adding NEW scenario 16 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 16 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 16 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 16]
    [DEBUG]   - Total constraints in model: 261313
    [DEBUG]   - Total variables in model: 108340
  [DEBUG] Total scenarios in Master: 17
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 17
================================================================================
[Iteration 17] Solving Master Problem...
  Current scenarios in Master: 17
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 261313 rows, 108340 columns and 740446 nonzeros
Model fingerprint: 0x51b6e61a
Variable types: 106081 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 120190 rows and 48790 columns
Presolve time: 2.45s
Presolved: 141123 rows, 59550 columns, 868684 nonzeros
Variable types: 57291 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -363238.5703
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.38s

Barrier statistics:
 Dense cols : 597
 AA' NZ     : 7.657e+06
 Factor NZ  : 1.766e+07 (roughly 220 MB of memory)
 Factor Ops : 5.549e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -1.97942109e+07  2.26839121e+08  1.13e+05 1.80e+01  8.50e+04     4s
   1  -1.54239979e+07  2.06675660e+08  8.14e+04 5.75e+01  6.04e+04     4s
   2  -4.95811399e+06  1.60120518e+08  2.54e+04 2.48e+00  2.01e+04     5s
   3  -1.06746378e+06  1.19908812e+08  2.93e+03 1.49e+00  2.66e+03     5s
   4  -5.53634012e+05  5.44234445e+07  5.13e+02 3.40e-01  5.57e+02     5s
   5  -4.71071595e+05  3.34344992e+07  2.86e+02 1.74e-01  3.07e+02     5s
   6  -3.81552876e+05  2.56140307e+07  1.12e+02 1.20e-01  1.65e+02     5s
   7  -3.04304333e+05  1.89598341e+07  6.02e+01 8.23e-02  1.05e+02     5s
   8  -2.16509282e+05  1.52921909e+07  3.14e+01 6.35e-02  7.44e+01     5s
   9  -1.67934486e+05  1.04013362e+07  1.57e+01 4.10e-02  4.64e+01     5s
  10  -1.41195117e+05  6.86981046e+06  1.06e+01 2.58e-02  2.98e+01     5s
  11  -9.82223138e+04  1.79807466e+06  2.91e+00 5.40e-03  7.62e+00     5s
  12  -7.16203802e+04  5.45660678e+05  1.21e+00 1.65e-03  2.44e+00     5s
  13  -4.60544531e+04  2.92420160e+05  6.22e-01 1.43e-03  1.33e+00     5s
  14  -2.84777804e+04  2.22628126e+05  4.20e-01 1.39e-03  9.82e-01     5s
  15  -1.81198804e+04  1.55989677e+05  3.44e-01 2.10e-03  6.81e-01     5s
  16  -6.44337737e+03  1.14686676e+05  2.54e-01 3.17e-03  4.74e-01     6s
  17   3.29725680e+02  9.43116109e+04  2.01e-01 3.54e-03  3.67e-01     6s
  18   6.28061311e+03  7.26327299e+04  1.59e-01 2.64e-03  2.59e-01     6s
  19   1.27241888e+04  5.81218088e+04  1.18e-01 2.58e-03  1.78e-01     6s
  20   1.51220225e+04  5.16551312e+04  1.03e-01 2.32e-03  1.43e-01     6s
  21   1.81742420e+04  4.93974585e+04  8.34e-02 1.97e-03  1.22e-01     6s
  22   2.00922583e+04  4.44353387e+04  7.31e-02 1.84e-03  9.53e-02     6s
  23   2.12493287e+04  4.35449391e+04  6.68e-02 2.00e-03  8.73e-02     6s
  24   2.46411768e+04  4.22460101e+04  4.88e-02 1.64e-03  6.89e-02     6s
  25   2.66360223e+04  4.11321752e+04  3.86e-02 1.82e-03  5.67e-02     6s
  26   2.81111884e+04  3.95347396e+04  3.13e-02 1.55e-03  4.47e-02     6s
  27   2.86282385e+04  3.89399091e+04  2.87e-02 1.38e-03  4.03e-02     6s
  28   2.98720415e+04  3.84181357e+04  2.26e-02 1.34e-03  3.34e-02     7s
  29   3.04881470e+04  3.79741790e+04  1.97e-02 1.18e-03  2.93e-02     7s
  30   3.18750732e+04  3.74523339e+04  1.30e-02 9.29e-04  2.18e-02     7s
  31   3.27383984e+04  3.67436252e+04  9.19e-03 6.60e-04  1.56e-02     7s
  32   3.28989918e+04  3.65790061e+04  8.51e-03 6.01e-04  1.44e-02     7s
  33   3.32451525e+04  3.60986441e+04  6.94e-03 4.24e-04  1.11e-02     7s
  34   3.36315299e+04  3.56192182e+04  5.27e-03 2.51e-04  7.77e-03     7s
  35   3.41439187e+04  3.55575530e+04  3.16e-03 2.26e-04  5.52e-03     7s
  36   3.42493082e+04  3.51996703e+04  2.74e-03 3.88e-04  3.72e-03     7s
  37   3.42738405e+04  3.51421603e+04  2.64e-03 2.86e-04  3.40e-03     7s
  38   3.43831128e+04  3.50904087e+04  2.22e-03 3.19e-04  2.77e-03     8s
  39   3.45547355e+04  3.50580976e+04  1.58e-03 2.04e-04  1.97e-03     8s
  40   3.46271985e+04  3.50222222e+04  1.30e-03 1.12e-04  1.55e-03     8s
  41   3.46694226e+04  3.50130882e+04  1.14e-03 9.00e-05  1.35e-03     8s
  42   3.47481358e+04  3.50003604e+04  8.50e-04 5.73e-05  9.88e-04     8s
  43   3.48178237e+04  3.49964699e+04  5.86e-04 4.64e-05  7.00e-04     8s
  44   3.48940247e+04  3.49871922e+04  2.95e-04 3.23e-05  3.65e-04     8s
  45   3.49268899e+04  3.49841894e+04  1.79e-04 2.60e-05  2.24e-04     8s
  46   3.49649787e+04  3.49811984e+04  3.89e-05 1.18e-05  6.34e-05     8s
  47   3.49729947e+04  3.49789766e+04  1.25e-05 5.06e-06  2.34e-05     8s
  48   3.49767531e+04  3.49773805e+04  1.17e-06 3.36e-06  2.45e-06     9s
  49   3.49771883e+04  3.49771896e+04  8.83e-09 1.92e-08  4.69e-09     9s
  50   3.49771890e+04  3.49771890e+04  1.36e-08 3.16e-11  1.81e-11     9s

Barrier solved model in 50 iterations and 8.73 seconds (14.31 work units)
Optimal objective 3.49771890e+04


Root crossover log...

  127368 DPushes remaining with DInf 0.0000000e+00                 9s
   23318 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                12s

    1421 PPushes remaining with PInf 2.2144572e-06                12s
       0 PPushes remaining with PInf 0.0000000e+00                12s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.6858420e-10     12s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   60611    3.4977189e+04   0.000000e+00   0.000000e+00     12s
   60611    3.4977189e+04   0.000000e+00   0.000000e+00     12s
Concurrent spin time: 0.34s

Solved with barrier

Root relaxation: objective 3.497719e+04, 60611 iterations, 9.44 seconds (18.06 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34977.1890    0  162 -210461.39 34977.1890   117%     -   13s
H    0     0                    -118308.2897 34977.1890   130%     -   13s
H    0     0                    -117543.0397 34977.1890   130%     -   13s
H    0     0                    -117395.5102 34977.1890   130%     -   14s
H    0     0                    -47667.90684 34977.1890   173%     -   14s
H    0     0                      71.7088928 34977.1890      -     -   14s
H    0     0                     619.6307511 34977.1890  5545%     -   15s
H    0     0                    1013.0333800 34977.1890  3353%     -   15s
     0     0 29392.5485    0  263 1013.03338 29392.5485  2801%     -   65s
H    0     0                    1170.8146111 29392.4582  2410%     -   66s
H    0     0                    1429.2928491 29392.4582  1956%     -   66s
H    0     0                    1599.7877132 29392.4582  1737%     -   66s
H    0     0                    1661.3683285 29392.4582  1669%     -   66s
H    0     0                    1808.9332922 29392.4582  1525%     -   66s
H    0     0                    2017.1777324 29392.4582  1357%     -   66s
H    0     0                    2024.4368356 29392.4582  1352%     -   66s
H    0     0                    2116.5325695 29392.4582  1289%     -   66s
     0     0 29198.0791    0  273 2116.53257 29198.0791  1280%     -   79s
     0     0 29182.1196    0  273 2116.53257 29182.1196  1279%     -   84s
     0     0 29180.5993    0  278 2116.53257 29180.5993  1279%     -   85s
     0     0 29180.0565    0  278 2116.53257 29180.0565  1279%     -   87s
     0     0 26896.9746    0  275 2116.53257 26896.9746  1171%     -  126s
H    0     0                    2172.9912669 26893.7124  1138%     -  127s
H    0     0                    2214.0658896 26893.7124  1115%     -  127s
H    0     0                    2256.7711781 26893.7124  1092%     -  127s
H    0     0                    2265.1067482 26893.7124  1087%     -  127s
H    0     0                    2279.3752575 26893.7124  1080%     -  127s
H    0     0                    2292.5708644 26893.7124  1073%     -  127s
     0     0 26465.9866    0  266 2292.57086 26465.9866  1054%     -  155s
     0     0 26321.8432    0  271 2292.57086 26321.8432  1048%     -  166s
     0     0 26260.1230    0  276 2292.57086 26260.1230  1045%     -  174s
     0     0 26201.4106    0  281 2292.57086 26201.4106  1043%     -  182s
     0     0 26137.9425    0  288 2292.57086 26137.9425  1040%     -  193s
     0     0 26124.9767    0  290 2292.57086 26124.9767  1040%     -  196s
     0     0 26055.7433    0  289 2292.57086 26055.7433  1037%     -  210s
     0     0 26053.7822    0  293 2292.57086 26053.7822  1036%     -  212s
     0     0 25992.5946    0  301 2292.57086 25992.5946  1034%     -  219s
     0     0 25980.3705    0  363 2292.57086 25980.3705  1033%     -  226s
     0     0 25974.0092    0  360 2292.57086 25974.0092  1033%     -  229s
     0     0 25972.1790    0  366 2292.57086 25972.1790  1033%     -  231s
     0     0 25971.2492    0  302 2292.57086 25971.2492  1033%     -  233s
     0     0 22969.4755    0  417 2292.57086 22969.4755   902%     -  303s
H    0     0                    2293.7305061 22969.2762   901%     -  304s
H    0     0                    2294.5384113 22969.2762   901%     -  304s
     0     0 22261.5062    0  439 2294.53841 22261.5062   870%     -  335s
     0     0 21749.0695    0  468 2294.53841 21749.0695   848%     -  365s
     0     0 21676.0414    0  454 2294.53841 21676.0414   845%     -  380s
     0     0 21629.2257    0  464 2294.53841 21629.2257   843%     -  391s
     0     0 21618.8954    0  465 2294.53841 21618.8954   842%     -  398s
     0     0 21608.6228    0  470 2294.53841 21608.6228   842%     -  402s
     0     0 21591.8396    0  458 2294.53841 21591.8396   841%     -  408s
     0     0 21580.4247    0  470 2294.53841 21580.4247   841%     -  412s
     0     0 21572.0536    0  477 2294.53841 21572.0536   840%     -  416s
     0     0 21560.5183    0  472 2294.53841 21560.5183   840%     -  422s
     0     0 21555.8834    0  481 2294.53841 21555.8834   839%     -  427s
     0     0 21553.4142    0  479 2294.53841 21553.4142   839%     -  430s
     0     0 21552.2637    0  476 2294.53841 21552.2637   839%     -  431s
     0     0 19867.3435    0  443 2294.53841 19867.3435   766%     -  518s
H    0     0                    2365.6785422 19867.3331   740%     -  519s
     0     0 19574.2481    0  470 2365.67854 19574.2481   727%     -  541s
     0     0 19471.6702    0  408 2365.67854 19471.6702   723%     -  555s
     0     0 19419.6666    0  401 2365.67854 19419.6666   721%     -  572s
     0     0 19370.0058    0  411 2365.67854 19370.0058   719%     -  584s
     0     0 19342.6816    0  405 2365.67854 19342.6816   718%     -  593s
     0     0 19335.7104    0  406 2365.67854 19335.7104   717%     -  598s
     0     0 19322.1569    0  417 2365.67854 19322.1569   717%     -  604s
     0     0 19315.4301    0  473 2365.67854 19315.4301   716%     -  610s
     0     0 19306.9882    0  476 2365.67854 19306.9882   716%     -  613s
     0     0 19291.4036    0  472 2365.67854 19291.4036   715%     -  618s
     0     0 19284.0539    0  471 2365.67854 19284.0539   715%     -  622s
     0     0 19282.6938    0  475 2365.67854 19282.6938   715%     -  624s
     0     0 19047.9260    0  546 2365.67854 19047.9260   705%     -  654s
     0     0 18938.7769    0  547 2365.67854 18938.7769   701%     -  671s
     0     0 18911.2102    0  601 2365.67854 18911.2102   699%     -  682s
     0     0 18900.3045    0  479 2365.67854 18900.3045   699%     -  692s
     0     0 18888.4831    0  612 2365.67854 18888.4831   698%     -  700s
     0     0 18884.9756    0  571 2365.67854 18884.9756   698%     -  706s
     0     0 18882.7704    0  489 2365.67854 18882.7704   698%     -  709s
     0     0 18804.8098    0  614 2365.67854 18804.8098   695%     -  730s
H    0     0                    2443.6280058 18804.5695   670%     -  731s
H    0     0                    2501.4376999 18804.5695   652%     -  731s
     0     0 18756.6456    0  506 2501.43770 18756.6456   650%     -  742s
     0     0 18734.8615    0  652 2501.43770 18734.8615   649%     -  751s
     0     0 18730.5686    0  613 2501.43770 18730.5686   649%     -  755s
     0     0 18724.9859    0  571 2501.43770 18724.9859   649%     -  759s
     0     0 18722.4500    0  510 2501.43770 18722.4500   648%     -  761s
     0     0 18721.1951    0  511 2501.43770 18721.1951   648%     -  764s
     0     0 18612.2309    0  637 2501.43770 18612.2309   644%     -  787s
     0     0 18576.4873    0  653 2501.43770 18576.4873   643%     -  798s
     0     0 18565.3010    0  660 2501.43770 18565.3010   642%     -  805s
     0     0 18560.9372    0  660 2501.43770 18560.9372   642%     -  809s
     0     0 18557.2924    0  664 2501.43770 18557.2924   642%     -  815s
     0     0 18555.4547    0  663 2501.43770 18555.4547   642%     -  818s
     0     0 18510.1020    0  523 2501.43770 18510.1020   640%     -  832s
H    0     0                    2523.7392121 18509.7306   633%     -  832s
     0     0 18504.2727    0  482 2523.73921 18504.2727   633%     -  837s
     0     0 18496.3239    0  517 2523.73921 18496.3239   633%     -  847s
     0     0 18493.4509    0  520 2523.73921 18493.4509   633%     -  851s
     0     0 18491.4050    0  534 2523.73921 18491.4050   633%     -  856s
     0     0 18443.8370    0  518 2523.73921 18443.8370   631%     -  871s
     0     0 18420.3140    0  514 2523.73921 18420.3140   630%     -  883s
     0     0 18413.1315    0  571 2523.73921 18413.1315   630%     -  891s
     0     0 18411.1063    0  571 2523.73921 18411.1063   630%     -  895s
     0     0 18392.5011    0  431 2523.73921 18392.5011   629%     -  906s
     0     0 18374.8298    0  448 2523.73921 18374.8298   628%     -  919s
     0     0 18369.3685    0  479 2523.73921 18369.3685   628%     -  927s
     0     0 18364.8960    0  627 2523.73921 18364.8960   628%     -  934s
     0     0 18363.7576    0  616 2523.73921 18363.7576   628%     -  938s
     0     0 18354.8187    0  615 2523.73921 18354.8187   627%     -  948s
     0     0 18351.5752    0  463 2523.73921 18351.5752   627%     -  952s
     0     0 18351.4524    0  459 2523.73921 18351.4524   627%     -  953s
     0     0 18343.2496    0  627 2523.73921 18343.2496   627%     -  963s
     0     0 18339.0679    0  631 2523.73921 18339.0679   627%     -  973s
     0     0 18337.9431    0  633 2523.73921 18337.9431   627%     -  977s
     0     0 18325.2176    0  636 2523.73921 18325.2176   626%     -  987s
     0     0 18320.7403    0  632 2523.73921 18320.7403   626%     -  994s
     0     0 18315.9069    0  628 2523.73921 18315.9069   626%     -  999s
     0     0 18313.6665    0  625 2523.73921 18313.6665   626%     - 1005s
     0     0 18308.6393    0  634 2523.73921 18308.6393   625%     - 1012s
     0     0 18308.5747    0  634 2523.73921 18308.5747   625%     - 1018s
H    0     0                    2541.0139646 18308.4695   621%     - 1244s
H    0     0                    2608.4806631 18308.4695   602%     - 1251s
H    0     0                    2989.6657470 18308.4695   512%     - 1273s
H    0     0                    3022.1549592 18308.4695   506%     - 1275s
H    0     0                    3024.2162507 18308.4695   505%     - 1275s
H    0     0                    3083.3281435 18308.4695   494%     - 1280s
H    0     2                    3601.1380865 18308.4695   408%     - 1307s
     0     2 18308.4695    0  634 3601.13809 18308.4695   408%     - 1307s
     1     4 18285.1725    1  481 3601.13809 18308.3008   408%  7097 1323s
     3     7 18253.5399    2  611 3601.13809 18285.1504   408%  9506 1359s
     6    13 18078.5730    3  423 3601.13809 18242.4778   407% 15829 1392s
    12    25 17837.9814    4  609 3601.13809 18078.1790   402% 17044 1430s
    24    37 15208.7010    5  308 3601.13809 18078.1790   402% 23002 1529s
H   36    67                    3684.9736775 17837.9774   384% 21258 1684s
    66   150 15382.2326    7  306 3684.97368 17837.9774   384% 24482 1836s
   149   253 13742.4758    9  231 3684.97368 17837.9774   384% 17739 1888s
   252   344 12493.1558   14  195 3684.97368 17837.9774   384% 13678 1921s
   343   416 11296.9754   19  173 3684.97368 17837.9774   384% 11219 1949s
   417   506 10810.8577   24  139 3684.97368 17837.9774   384% 10275 1975s
   513   533 10076.2312   29  106 3684.97368 17837.9774   384%  9802 1993s
   546   563 9735.87285   30  130 3684.97368 17837.9774   384%  9646 2012s
   585   593 9257.02333   31   78 3684.97368 17837.9774   384%  9552 2066s
   618   613 8539.72032   32   60 3684.97368 17837.9774   384%  9505 2142s
   658   640 8341.82103   33  118 3684.97368 17837.9774   384%  9365 2177s
   691   673 8338.59329   34  120 3684.97368 17837.9774   384%  9269 2190s
   726   710 8319.99162   35  112 3684.97368 17837.9774   384%  9206 2206s
   765   739 8311.66705   36  116 3684.97368 17837.9774   384%  9032 2224s
   812   775 8307.62814   37   83 3684.97368 17837.9774   384%  8880 2250s
   866   805 7712.36770   41   65 3684.97368 17837.9774   384%  8592 2266s
   898   826 7659.57703   42   89 3684.97368 17837.9774   384%  8556 2286s
   943   872 7658.85707   43   76 3684.97368 17837.9774   384%  8536 2301s
  1007   939 7646.23999   44   73 3684.97368 17837.9774   384%  8301 2322s
  1108   969 7375.19526   51   48 3684.97368 17837.9774   384%  7824 2344s
  1190  1023 7155.15700   53   78 3684.97368 17837.9774   384%  7509 2370s
  1282  1053 6956.30956   61   61 3684.97368 17837.9774   384%  7302 2400s
  1383  1084 5745.80263   21  197 3684.97368 17837.9774   384%  7246 2420s
  1477  1098 5573.70289   22  184 3684.97368 17837.9774   384%  7289 2448s
  1571  1116 infeasible   23      3684.97368 17837.9774   384%  7149 2481s
  1658  1120 infeasible   21      3684.97368 17837.9774   384%  7072 2519s
  1722  1129 5793.58277   11  244 3684.97368 17837.9774   384%  7104 2556s
  1751  1150 6321.63289   12  315 3684.97368 17837.9774   384%  7231 2595s
  1798  1166 infeasible   13      3684.97368 17837.9774   384%  7301 2635s
  1856  1193 4493.18002   13  207 3684.97368 17837.9774   384%  7435 2670s
  1924  1232 4292.83517   14  215 3684.97368 17837.9774   384%  7511 2706s
  1997  1248 9773.77122   20  277 3684.97368 17837.9774   384%  7543 2750s
  2048  1338 5632.07030   23  194 3684.97368 17837.9774   384%  7658 2789s
  2158  1423     cutoff   36      3684.97368 17837.9774   384%  7672 2830s
  2295  1501     cutoff   39      3684.97368 17837.9774   384%  7591 2868s
  2429  1612 7181.00676   10  291 3684.97368 17837.9774   384%  7548 2908s
  2584  1748 4943.69145   11  458 3684.97368 17837.9774   384%  7456 2953s
  2796  1829 4864.58914   12  424 3684.97368 17837.9774   384%  7255 3000s
  2971  1885 infeasible   12      3684.97368 17198.2387   367%  7195 3045s
H 3102  1884                    3729.4097634 17197.8871   361%  7182 3045s
  3107  1971 infeasible   20      3729.40976 17197.8871   361%  7196 3099s
  3234  2060     cutoff   22      3729.40976 17197.8871   361%  7240 3153s
  3395  2165     cutoff   13      3729.40976 17161.9444   360%  7310 3206s
  3592  2255 9253.22816    7  449 3729.40976 16525.8201   343%  7317 3267s
  3780  2310 7127.11029    8  278 3729.40976 16525.8201   343%  7280 3328s
  3921  2373 infeasible   10      3729.40976 16431.6130   341%  7359 3387s
  4114  2503 5255.30110   22  302 3729.40976 16328.2617   338%  7411 3444s
  4358  2589 3853.13245   27  295 3729.40976 16328.2617   338%  7411 3509s
  4594  2745 infeasible   23      3729.40976 15934.9359   327%  7412 3584s

Cutting planes:
  Learned: 1
  Gomory: 16
  Implied bound: 325
  MIR: 4201
  Flow cover: 4400
  RLT: 76
  Relax-and-lift: 848
  BQP: 1

Explored 4809 nodes (36615025 simplex iterations) in 3600.08 seconds (8830.66 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3729.41 3684.97 3601.14 ... 2523.74

Time limit reached
Best objective 3.729409763378e+03, best bound 1.571234438061e+04, gap 321.3091%
  WARNING: Time limit reached. Using best solution found (gap: 321.31%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.12s
  Master Objective (UB) = 3729.41, θ = 145073.29
  Upper Bound (UB) = 3729.41

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145073.29
  [DEBUG]   ✓ Scenario 0: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145073.29 ≤ Q = 145073.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145073.29 ≤ Q = 145073.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145073.29 ≤ Q = 145073.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145073.29 ≤ Q = 145073.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145073.29 ≤ Q = 145073.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145073.29 ≤ Q = 145073.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 14: θ = 145073.29 ≤ Q = 145073.29 (slack: 0.00)
  [DEBUG]   ✓ Scenario 15: θ = 145073.29 ≤ Q = 145073.29 (slack: -0.00)
  [DEBUG]   ✓ Scenario 16: θ = 145073.29 ≤ Q = 145073.29 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 17] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x7866034a
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x8799fcb6
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.153842e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5747599.0304
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.278233e+05, 241 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127823.28    0  122 5747599.03 -127823.28   102%     -    0s
H    0     0                    -95799.86969 -127823.28  33.4%     -    0s
H    0     0                    -96175.26125 -127823.28  32.9%     -    0s
     0     0 -99829.348    0   83 -96175.261 -99829.348  3.80%     -    0s
H    0     0                    -98167.75256 -99828.298  1.69%     -    0s
     0     0 -99444.644    0   74 -98167.753 -99444.644  1.30%     -    0s
H    0     0                    -98623.51837 -99431.416  0.82%     -    0s
     0     0 -99398.831    0   74 -98623.518 -99398.831  0.79%     -    0s
H    0     0                    -98660.33876 -99398.831  0.75%     -    0s
     0     0 -99354.074    0   72 -98660.339 -99354.074  0.70%     -    0s
     0     0 -99352.466    0   72 -98660.339 -99352.466  0.70%     -    0s
     0     2 -99352.466    0   72 -98660.339 -99352.466  0.70%     -    0s
H   33    14                    -98666.76846 -99237.452  0.58%   9.5    0s
H   36    14                    -98672.16145 -99215.809  0.55%   9.3    0s
H  317    65                    -98676.51751 -99054.148  0.38%   6.3    0s
H  366    65                    -98696.54198 -99054.148  0.36%   6.1    0s
H  399    37                    -98703.27656 -98980.560  0.28%   6.2    0s
H  429    37                    -98712.72073 -98980.560  0.27%   6.2    0s
H  584     4                    -98719.15044 -98844.548  0.13%   6.2    0s

Cutting planes:
  Gomory: 27
  Implied bound: 3
  MIR: 157
  Flow cover: 17

Explored 608 nodes (4137 simplex iterations) in 0.16 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -98719.2 -98712.7 -98703.3 ... -98167.8
No other solutions better than -98719.2

Optimal solution found (tolerance 1.00e-06)
Best objective -9.871915044314e+04, best bound -9.871915044314e+04, gap 0.0000%
  Subproblem solved in 0.17s
  Worst-case operational profit (Z_SP) = 144730.15
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -98719.15
  [DEBUG]   S×d_nominal = 243449.30
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243449.30 + -98719.15 = 144730.15
  [DEBUG]   Current θ from Master = 145073.29
  [DEBUG]   ⚠️  Z_SP ≤ θ by 343.14 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 3386.27
  Lower Bound (LB) = 3386.27
  Gap (UB-LB) = 343.1395, Absolute Gap = 343.1395, Relative Gap = 0.092009
  Not converged yet (gap = 343.14 > ε = 200)

  [DEBUG] Adding NEW scenario 17 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 17 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 17 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 17]
    [DEBUG]   - Total constraints in model: 276603
    [DEBUG]   - Total variables in model: 114580
  [DEBUG] Total scenarios in Master: 18
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 18
================================================================================
[Iteration 18] Solving Master Problem...
  Current scenarios in Master: 18
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 276603 rows, 114580 columns and 783677 nonzeros
Model fingerprint: 0x48818a54
Variable types: 112321 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 127260 rows and 51660 columns
Presolve time: 2.62s
Presolved: 149343 rows, 62920 columns, 919428 nonzeros
Variable types: 60661 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -363844.9763
Found heuristic solution: objective -210461.3866

Deterministic concurrent LP optimizer: primal simplex, dual simplex, and barrier
Showing barrier log only...

Root barrier log...

Ordering time: 0.41s

Barrier statistics:
 Dense cols : 597
 AA' NZ     : 8.506e+06
 Factor NZ  : 1.891e+07 (roughly 240 MB of memory)
 Factor Ops : 4.691e+09 (less than 1 second per iteration)
 Threads    : 30

                  Objective                Residual
Iter       Primal          Dual         Primal    Dual     Compl     Time
   0  -2.01847462e+07  2.37874614e+08  1.16e+05 1.74e+01  8.62e+04     5s
   1  -1.57702716e+07  2.17170126e+08  8.32e+04 5.66e+01  6.13e+04     5s
   2  -5.20870075e+06  1.68573793e+08  2.67e+04 1.86e+00  2.10e+04     5s
   3  -1.14785720e+06  1.27173618e+08  3.32e+03 1.65e+00  2.95e+03     5s
   4  -5.99202014e+05  6.97863137e+07  6.94e+02 6.06e-01  7.32e+02     5s
   5  -4.93180319e+05  3.85020052e+07  3.57e+02 2.50e-01  3.63e+02     5s
   6  -3.88092591e+05  2.83663340e+07  1.07e+02 1.64e-01  1.67e+02     5s
   7  -3.19750366e+05  2.04340471e+07  5.68e+01 1.10e-01  1.05e+02     5s
   8  -1.82603058e+05  1.44816910e+07  1.19e+01 7.24e-02  5.88e+01     5s
   9  -1.54788814e+05  1.07564870e+07  8.03e+00 5.25e-02  4.27e+01     5s
  10  -1.26738145e+05  5.70864605e+06  5.09e+00 2.66e-02  2.24e+01     6s
  11  -9.18404297e+04  1.55141417e+06  1.39e+00 6.19e-03  6.13e+00     6s
  12  -6.25055593e+04  4.81412587e+05  5.45e-01 1.77e-03  2.01e+00     6s
  13  -4.24421923e+04  2.58554317e+05  3.33e-01 1.18e-03  1.11e+00     6s
  14  -2.91056328e+04  1.75289102e+05  2.39e-01 2.38e-03  7.54e-01     6s
  15  -1.59333527e+04  1.37475131e+05  1.75e-01 2.93e-03  5.65e-01     6s
  16  -7.08813121e+03  1.08577231e+05  1.41e-01 2.52e-03  4.26e-01     6s
  17  -3.15491866e+03  9.58497526e+04  1.25e-01 2.20e-03  3.65e-01     6s
  18   3.31339674e+03  7.58501675e+04  1.00e-01 2.17e-03  2.67e-01     6s
  19   8.88695652e+03  6.18642924e+04  8.03e-02 1.93e-03  1.95e-01     6s
  20   1.16584592e+04  5.28278494e+04  7.09e-02 1.82e-03  1.52e-01     6s
  21   1.40447884e+04  4.82956363e+04  6.30e-02 1.78e-03  1.26e-01     6s
  22   1.93639843e+04  4.53550591e+04  4.51e-02 2.02e-03  9.58e-02     7s
  23   2.08313013e+04  4.36583430e+04  4.05e-02 1.74e-03  8.42e-02     7s
  24   2.17430394e+04  4.26146313e+04  3.76e-02 1.53e-03  7.70e-02     7s
  25   2.46385398e+04  4.15071997e+04  2.88e-02 1.31e-03  6.22e-02     7s
  26   2.73549070e+04  4.01510552e+04  2.08e-02 1.04e-03  4.72e-02     7s
  27   2.76886241e+04  3.95921929e+04  1.98e-02 9.33e-04  4.39e-02     7s
  28   2.82641569e+04  3.83659171e+04  1.82e-02 7.07e-04  3.73e-02     7s
  29   2.90668191e+04  3.80184350e+04  1.59e-02 6.37e-04  3.30e-02     7s
  30   2.99514670e+04  3.72661084e+04  1.34e-02 4.89e-04  2.70e-02     7s
  31   3.06270997e+04  3.68853330e+04  1.15e-02 4.11e-04  2.31e-02     7s
  32   3.16401004e+04  3.63651062e+04  8.70e-03 2.96e-04  1.74e-02     8s
  33   3.21840417e+04  3.58465585e+04  7.22e-03 2.31e-04  1.35e-02     8s
  34   3.26646869e+04  3.56783098e+04  5.99e-03 1.88e-04  1.11e-02     8s
  35   3.33042080e+04  3.54119645e+04  4.25e-03 3.45e-04  7.78e-03     8s
  36   3.37818972e+04  3.53669983e+04  3.05e-03 3.10e-04  5.85e-03     8s
  37   3.41852642e+04  3.52911970e+04  2.05e-03 2.61e-04  4.08e-03     8s
  38   3.42919774e+04  3.51637131e+04  1.76e-03 1.38e-04  3.22e-03     8s
  39   3.43537691e+04  3.51194399e+04  1.60e-03 1.05e-04  2.83e-03     8s
  40   3.44700933e+04  3.51171540e+04  1.30e-03 1.02e-04  2.39e-03     8s
  41   3.45485423e+04  3.50907154e+04  1.09e-03 8.32e-05  2.00e-03     9s
  42   3.45644522e+04  3.50697310e+04  1.05e-03 6.87e-05  1.86e-03     9s
  43   3.46233960e+04  3.50601608e+04  9.04e-04 7.22e-05  1.61e-03     9s
  44   3.48011803e+04  3.50336996e+04  4.36e-04 4.33e-05  8.58e-04     9s
  45   3.48754142e+04  3.50078820e+04  2.45e-04 2.24e-05  4.89e-04     9s
  46   3.49213403e+04  3.49943638e+04  1.25e-04 1.32e-05  2.69e-04     9s
  47   3.49552288e+04  3.49835874e+04  4.74e-05 4.36e-06  1.05e-04     9s
  48   3.49670372e+04  3.49803473e+04  2.12e-05 1.98e-06  4.91e-05     9s
  49   3.49760429e+04  3.49778774e+04  2.28e-06 4.15e-07  6.75e-06     9s
  50   3.49771769e+04  3.49772018e+04  3.09e-08 1.70e-07  9.16e-08     9s
  51   3.49771890e+04  3.49771890e+04  5.00e-10 1.84e-10  6.58e-11     9s

Barrier solved model in 51 iterations and 9.47 seconds (15.61 work units)
Optimal objective 3.49771890e+04


Root crossover log...

  134706 DPushes remaining with DInf 0.0000000e+00                10s
   58240 DPushes remaining with DInf 0.0000000e+00                10s
       0 DPushes remaining with DInf 0.0000000e+00                14s

    1998 PPushes remaining with PInf 6.7313044e-06                14s
       0 PPushes remaining with PInf 0.0000000e+00                14s

  Push phase complete: Pinf 0.0000000e+00, Dinf 3.2712419e-02     14s


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   62685    3.4977189e+04   0.000000e+00   3.271242e-02     14s
   62688    3.4977189e+04   0.000000e+00   0.000000e+00     14s
   62688    3.4977189e+04   0.000000e+00   0.000000e+00     14s
Concurrent spin time: 0.49s

Solved with barrier

Root relaxation: objective 3.497719e+04, 62688 iterations, 11.15 seconds (22.31 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 34977.1890    0  162 -210461.39 34977.1890   117%     -   15s
H    0     0                    -207930.1532 34977.1890   117%     -   15s
H    0     0                    -107507.5008 34977.1890   133%     -   15s
H    0     0                    -80457.68712 34977.1890   143%     -   15s
H    0     0                    -47667.90684 34977.1890   173%     -   15s
H    0     0                    -23929.59811 34977.1890   246%     -   16s
H    0     0                    -23166.51664 34977.1890   251%     -   16s
H    0     0                     619.6307511 34977.1890  5545%     -   16s
H    0     0                     980.3071050 34977.1890  3468%     -   17s
H    0     0                    1013.0333800 34977.1890  3353%     -   17s
     0     0 29810.9113    0  302 1013.03338 29810.9113  2843%     -   66s
H    0     0                    1196.1293992 29810.4625  2392%     -   67s
H    0     0                    1842.6718841 29810.4625  1518%     -   67s
H    0     0                    1892.3803417 29810.4625  1475%     -   67s
H    0     0                    1920.9690910 29810.4625  1452%     -   67s
H    0     0                    1970.6775487 29810.4625  1413%     -   67s
     0     0 29581.3745    0  311 1970.67755 29581.3745  1401%     -   86s
     0     0 29481.4818    0  307 1970.67755 29481.4818  1396%     -   96s
     0     0 29456.1125    0  329 1970.67755 29456.1125  1395%     -  101s
     0     0 29452.8562    0  321 1970.67755 29452.8562  1395%     -  103s
     0     0 29452.5584    0  323 1970.67755 29452.5584  1395%     -  104s
     0     0 26169.1319    0  203 1970.67755 26169.1319  1228%     -  148s
H    0     0                    2681.1313288 26168.8584   876%     -  150s
H    0     0                    2698.4671521 26168.8584   870%     -  150s
H    0     0                    2735.2546138 26168.8584   857%     -  150s
     0     0 25705.3097    0  271 2735.25461 25705.3097   840%     -  172s
     0     0 25656.5027    0  280 2735.25461 25656.5027   838%     -  182s
     0     0 25603.2704    0  233 2735.25461 25603.2704   836%     -  194s
     0     0 25538.5923    0  242 2735.25461 25538.5923   834%     -  206s
     0     0 25423.2603    0  231 2735.25461 25423.2603   829%     -  216s
     0     0 25412.3568    0  244 2735.25461 25412.3568   829%     -  224s
     0     0 25410.7903    0  243 2735.25461 25410.7903   829%     -  226s
     0     0 25394.7026    0  244 2735.25461 25394.7026   828%     -  230s
     0     0 25230.4168    0  248 2735.25461 25230.4168   822%     -  244s
     0     0 25225.1596    0  248 2735.25461 25225.1596   822%     -  247s
     0     0 25036.0040    0  324 2735.25461 25036.0040   815%     -  263s
     0     0 25034.8093    0  323 2735.25461 25034.8093   815%     -  266s
     0     0 25032.6001    0  329 2735.25461 25032.6001   815%     -  274s
     0     0 25031.8084    0  326 2735.25461 25031.8084   815%     -  276s
     0     0 22562.5664    0  414 2735.25461 22562.5664   725%     -  343s
     0     0 22036.7980    0  421 2735.25461 22036.7980   706%     -  383s
     0     0 21879.4782    0  448 2735.25461 21879.4782   700%     -  405s
     0     0 21744.7872    0  457 2735.25461 21744.7872   695%     -  428s
     0     0 21693.1709    0  441 2735.25461 21693.1709   693%     -  443s
     0     0 21652.3268    0  457 2735.25461 21652.3268   692%     -  452s
     0     0 21619.1102    0  466 2735.25461 21619.1102   690%     -  465s
     0     0 21604.3891    0  475 2735.25461 21604.3891   690%     -  474s
     0     0 21596.9064    0  480 2735.25461 21596.9064   690%     -  480s
     0     0 21557.4473    0  464 2735.25461 21557.4473   688%     -  494s
     0     0 21533.7198    0  464 2735.25461 21533.7198   687%     -  502s
     0     0 21526.6333    0  475 2735.25461 21526.6333   687%     -  507s
     0     0 21524.3224    0  462 2735.25461 21524.3224   687%     -  509s
     0     0 21512.1090    0  471 2735.25461 21512.1090   686%     -  513s
     0     0 21493.0746    0  446 2735.25461 21493.0746   686%     -  519s
     0     0 21486.8979    0  447 2735.25461 21486.8979   686%     -  523s
     0     0 21486.2824    0  450 2735.25461 21486.2824   686%     -  525s
     0     0 19731.0525    0  380 2735.25461 19731.0525   621%     -  616s
     0     0 19529.4587    0  509 2735.25461 19529.4587   614%     -  644s
     0     0 19456.9467    0  531 2735.25461 19456.9467   611%     -  664s
     0     0 19410.9536    0  542 2735.25461 19410.9536   610%     -  677s
     0     0 19386.8813    0  537 2735.25461 19386.8813   609%     -  688s
     0     0 19366.5823    0  556 2735.25461 19366.5823   608%     -  697s
     0     0 19350.3749    0  553 2735.25461 19350.3749   607%     -  704s
     0     0 19339.2448    0  562 2735.25461 19339.2448   607%     -  710s
     0     0 19335.0867    0  560 2735.25461 19335.0867   607%     -  714s
     0     0 19331.3480    0  548 2735.25461 19331.3480   607%     -  717s
     0     0 19325.0448    0  562 2735.25461 19325.0448   607%     -  726s
     0     0 19323.1485    0  560 2735.25461 19323.1485   606%     -  728s
     0     0 18986.9123    0  518 2735.25461 18986.9123   594%     -  767s
     0     0 18924.5343    0  568 2735.25461 18924.5343   592%     -  784s
     0     0 18892.0662    0  523 2735.25461 18892.0662   591%     -  798s
     0     0 18881.0587    0  530 2735.25461 18881.0587   590%     -  806s
     0     0 18870.2986    0  553 2735.25461 18870.2986   590%     -  813s
     0     0 18867.1280    0  572 2735.25461 18867.1280   590%     -  819s
     0     0 18864.4545    0  576 2735.25461 18864.4545   590%     -  822s
     0     0 18855.2983    0  615 2735.25461 18855.2983   589%     -  828s
     0     0 18845.3921    0  622 2735.25461 18845.3921   589%     -  835s
     0     0 18840.6340    0  615 2735.25461 18840.6340   589%     -  838s
     0     0 18839.0212    0  622 2735.25461 18839.0212   589%     -  840s
     0     0 18693.6338    0  512 2735.25461 18693.6338   583%     -  870s
H    0     0                    2871.0137715 18693.5936   551%     -  885s
     0     0 18665.5578    0  492 2871.01377 18665.5578   550%     -  897s
     0     0 18642.7539    0  507 2871.01377 18642.7539   549%     -  908s
     0     0 18631.9590    0  499 2871.01377 18631.9590   549%     -  916s
     0     0 18625.8924    0  514 2871.01377 18625.8924   549%     -  921s
     0     0 18620.4480    0  516 2871.01377 18620.4480   549%     -  926s
     0     0 18620.0040    0  510 2871.01377 18620.0040   549%     -  928s
     0     0 18506.0241    0  438 2871.01377 18506.0241   545%     -  954s
     0     0 18492.3911    0  559 2871.01377 18492.3911   544%     -  964s
     0     0 18485.2599    0  442 2871.01377 18485.2599   544%     -  970s
     0     0 18476.6744    0  519 2871.01377 18476.6744   544%     -  975s
     0     0 18469.5851    0  500 2871.01377 18469.5851   543%     -  978s
     0     0 18468.5868    0  507 2871.01377 18468.5868   543%     -  981s
     0     0 18412.6849    0  424 2871.01377 18412.6849   541%     -  998s
     0     0 18392.6746    0  498 2871.01377 18392.6746   541%     - 1011s
     0     0 18385.7109    0  498 2871.01377 18385.7109   540%     - 1019s
     0     0 18382.3879    0  438 2871.01377 18382.3879   540%     - 1026s
     0     0 18379.8744    0  447 2871.01377 18379.8744   540%     - 1030s
     0     0 18378.2785    0  504 2871.01377 18378.2785   540%     - 1035s
     0     0 18340.1799    0  457 2871.01377 18340.1799   539%     - 1054s
     0     0 18334.3246    0  516 2871.01377 18334.3246   539%     - 1067s
     0     0 18332.7829    0  519 2871.01377 18332.7829   539%     - 1073s
     0     0 18318.1495    0  563 2871.01377 18318.1495   538%     - 1091s
     0     0 18311.4440    0  567 2871.01377 18311.4440   538%     - 1100s
     0     0 18309.4100    0  448 2871.01377 18309.4100   538%     - 1104s
     0     0 18299.2111    0  570 2871.01377 18299.2111   537%     - 1115s
     0     0 18296.9474    0  564 2871.01377 18296.9474   537%     - 1123s
     0     0 18258.5724    0  574 2871.01377 18258.5724   536%     - 1142s
     0     0 18237.9548    0  574 2871.01377 18237.9548   535%     - 1156s
     0     0 18234.0387    0  574 2871.01377 18234.0387   535%     - 1167s
     0     0 18233.0981    0  585 2871.01377 18233.0981   535%     - 1170s
     0     0 18182.0821    0  512 2871.01377 18182.0821   533%     - 1189s
     0     0 18180.5432    0  581 2871.01377 18180.5432   533%     - 1195s
     0     0 18162.3590    0  515 2871.01377 18162.3590   533%     - 1204s
H    0     0                    2877.2835306 18162.3394   531%     - 1205s
     0     0 18152.2118    0  570 2877.28353 18152.2118   531%     - 1212s
     0     0 18150.4020    0  570 2877.28353 18150.4020   531%     - 1216s
     0     0 18142.7878    0  571 2877.28353 18142.7878   531%     - 1223s
     0     0 18140.2388    0  452 2877.28353 18140.2388   530%     - 1229s
     0     0 18138.9509    0  462 2877.28353 18138.9509   530%     - 1230s
     0     0 18134.9370    0  466 2877.28353 18134.9370   530%     - 1235s
     0     0 18134.8478    0  466 2877.28353 18134.8478   530%     - 1240s
H    0     0                    3270.9012863 18134.8151   454%     - 1370s
     0     2 18134.8151    0  466 3270.90129 18134.8151   454%     - 1379s
     1     3 17850.2142    1  420 3270.90129 18134.8151   454% 15579 1398s
     2     4 17947.1842    1  484 3270.90129 17947.1842   449% 12984 1412s
     3     5 17358.0359    2  475 3270.90129 17947.1648   449% 13010 1429s
     4     9 17500.8152    2  437 3270.90129 17947.1359   449% 12516 1449s
     8    18 16818.5805    3  355 3270.90129 17689.3573   441% 12304 1478s
    17    33 16674.6966    4  417 3270.90129 17306.8867   429% 13216 1533s
    32    47 15660.5887    5  493 3270.90129 17207.7211   426% 24184 1620s
    46    74 15178.0197    5  452 3270.90129 17090.7029   423% 21138 1692s
H   57    74                    3285.1697956 17090.7029   420% 20964 1692s
    73   199 15126.5146    6  408 3285.16980 17090.7029   420% 19683 1754s
   198   277 14934.2583    9  384 3285.16980 17090.7029   420% 11676 1802s
   276   308     cutoff   18      3285.16980 17090.7029   420%  9773 1838s
   321   319 3527.22013   18  154 3285.16980 17090.7029   420%  9088 1873s
   348   334 14885.3170    9  407 3285.16980 17090.7029   420%  8903 1904s
   377   348 14837.1023   10  449 3285.16980 17090.7029   420%  8730 1934s
   399   362 14799.3746   11  491 3285.16980 17090.7029   420%  8687 1964s
H  443   362                    3332.5119920 17090.7029   413%  8487 1964s
   449   406 8010.78865   19  204 3332.51199 17090.7029   413%  8398 1991s
H  465   406                    3492.9056649 17090.7029   389%  8211 1991s
   519   443 6326.74160   22  240 3492.90566 17090.7029   389%  7749 2020s
   609   484 6102.59798   27  212 3492.90566 17090.7029   389%  6996 2044s
   706   509 5192.13417   28  244 3492.90566 17090.7029   389%  6430 2069s
   773   530 5174.46289   29  237 3492.90566 17090.7029   389%  6186 2090s
   808   561 5068.79102   30  240 3492.90566 17090.7029   389%  6040 2115s
H  813   561                    3497.0949869 17090.7029   389%  6010 2115s
H  853   561                    3531.3668853 17090.7029   384%  5833 2115s
   867   654 5048.58058   31  242 3531.36689 17090.7029   384%  5769 2133s
  1028   726 4343.89893   36  191 3531.36689 17090.7029   384%  5121 2153s
  1208   735 3692.25169   40  164 3531.36689 17090.7029   384%  4564 2174s
  1309   760 4128.78272   38  167 3531.36689 17090.7029   384%  4370 2197s
  1423   807 infeasible   40      3531.36689 17090.7029   384%  4174 2224s
  1532   902     cutoff   51      3531.36689 17090.7029   384%  4026 2248s
  1655  1038 infeasible   53      3531.36689 17090.7029   384%  3896 2274s
  1811  1237 infeasible   53      3531.36689 17090.7029   384%  3727 2298s
  2020  1375 8544.33112   58  348 3531.36689 17090.7029   384%  3503 2319s
  2166  1562 infeasible   63      3531.36689 17090.7029   384%  3360 2341s
  2393  1741 7643.23192   69  255 3531.36689 17090.7029   384%  3171 2362s
  2674  1839 5213.99448   82  192 3531.36689 17090.7029   384%  2984 2387s
  2970  1946 4786.89892   97  134 3531.36689 17090.7029   384%  2797 2410s
  3316  1961     cutoff  110      3531.36689 17090.7029   384%  2587 2441s
  3516  2002 3925.79441   91  183 3531.36689 16759.2353   375%  2507 2471s
  3679  2040 16728.1623    6  527 3531.36689 16758.7175   375%  2469 2515s
  3795  2067 infeasible   37      3531.36689 16758.7175   375%  2443 2551s
  3926  2064 3851.47355   93  199 3531.36689 16758.7175   375%  2408 2587s
  4004  2051 infeasible   38      3531.36689 16758.7175   375%  2410 2629s
  4094  2057 infeasible   75      3531.36689 16758.7175   375%  2414 2670s
  4169  2076 infeasible   36      3531.36689 16723.4403   374%  2429 2710s
  4248  2087 3689.71798  104  103 3531.36689 16723.4403   374%  2463 2751s
  4281  2096 infeasible   80      3531.36689 16674.4906   372%  2485 2796s
  4365  2110 infeasible   35      3531.36689 16440.3463   366%  2492 2842s
  4395  2136 9111.07802    8  467 3531.36689 16440.3463   366%  2515 2876s
  4485  2148 9008.10182   10  469 3531.36689 16440.3463   366%  2528 2915s
  4519  2177 8998.40745   11  425 3531.36689 16440.3463   366%  2559 2954s
H 4538  2177                    3536.2478145 16330.4809   362%  2582 2954s
  4560  2206 8947.98413   12  483 3536.24781 16330.4809   362%  2598 2999s
  4623  2245 7215.18883   13  295 3536.24781 16330.4809   362%  2637 3046s
  4710  2307 6856.43907   14  282 3536.24781 16266.0440   360%  2687 3094s
  4829  2342 infeasible   15      3536.24781 16266.0440   360%  2722 3149s
  4925  2437 4970.55877   21  190 3536.24781 15916.7225   350%  2767 3208s

Cutting planes:
  Learned: 1
  Gomory: 12
  Implied bound: 315
  MIR: 4412
  Flow cover: 4826
  RLT: 81
  Relax-and-lift: 879
  BQP: 2
  PSD: 1

Explored 5107 nodes (15069052 simplex iterations) in 3600.03 seconds (7905.75 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 3536.25 3531.37 3497.09 ... 2735.25

Time limit reached
Best objective 3.536247814488e+03, best bound 1.591672251197e+04, gap 350.1020%
  WARNING: Time limit reached. Using best solution found (gap: 350.10%)
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 1) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 3600.05s
  Master Objective (UB) = 3536.25, θ = 145425.50
  Upper Bound (UB) = 3536.25

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 145425.50
  [DEBUG]   ✓ Scenario 0: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 145425.50 ≤ Q = 145425.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 8: θ = 145425.50 ≤ Q = 145425.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 9: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 10: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 11: θ = 145425.50 ≤ Q = 145425.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 12: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 13: θ = 145425.50 ≤ Q = 145425.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 14: θ = 145425.50 ≤ Q = 145425.50 (slack: -0.00)
  [DEBUG]   ✓ Scenario 15: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 16: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG]   ✓ Scenario 17: θ = 145425.50 ≤ Q = 145425.50 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 18] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x297ab05b
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xd6854fa5
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [5e-01, 2e+02]
Found heuristic solution: objective 1.153842e+13
Presolve removed 2599 rows and 1891 columns
Presolve time: 0.00s
Presolved: 494 rows, 498 columns, 1393 nonzeros
Found heuristic solution: objective 5715763.2090
Variable types: 338 continuous, 160 integer (160 binary)

Root relaxation: objective -1.273946e+05, 239 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -127394.62    0  123 5715763.21 -127394.62   102%     -    0s
H    0     0                    -95369.18010 -127394.62  33.6%     -    0s
H    0     0                    -95933.31834 -127394.62  32.8%     -    0s
     0     0 -102245.52    0   83 -95933.318 -102245.52  6.58%     -    0s
H    0     0                    -100798.6817 -102239.32  1.43%     -    0s
     0     0 -101818.55    0   84 -100798.68 -101818.55  1.01%     -    0s
H    0     0                    -101054.3508 -101799.32  0.74%     -    0s
     0     0 -101731.54    0   83 -101054.35 -101731.54  0.67%     -    0s
     0     0 -101729.64    0   82 -101054.35 -101729.64  0.67%     -    0s
H    0     0                    -101362.4683 -101729.64  0.36%     -    0s
     0     0 -101598.07    0   43 -101362.47 -101598.07  0.23%     -    0s
     0     0 -101561.21    0   45 -101362.47 -101561.21  0.20%     -    0s
     0     0 -101561.13    0   44 -101362.47 -101561.13  0.20%     -    0s
     0     0 -101561.03    0   38 -101362.47 -101561.03  0.20%     -    0s
     0     0 -101524.60    0   38 -101362.47 -101524.60  0.16%     -    0s
     0     0 -101495.68    0   35 -101362.47 -101495.68  0.13%     -    0s
     0     0 -101495.68    0   50 -101362.47 -101495.68  0.13%     -    0s
     0     0 -101495.68    0   33 -101362.47 -101495.68  0.13%     -    0s
H    0     0                    -101371.1087 -101495.68  0.12%     -    0s
     0     0 -101495.68    0   33 -101371.11 -101495.68  0.12%     -    0s
     0     0 -101495.68    0   30 -101371.11 -101495.68  0.12%     -    0s
     0     0 -101495.68    0   28 -101371.11 -101495.68  0.12%     -    0s
     0     0 -101433.17    0    9 -101371.11 -101433.17  0.06%     -    0s
     0     0 -101416.86    0    5 -101371.11 -101416.86  0.05%     -    0s
     0     0 -101391.27    0    4 -101371.11 -101391.27  0.02%     -    0s
*    0     0               0    -101381.5898 -101381.59  0.00%     -    0s

Cutting planes:
  Gomory: 3
  Implied bound: 21
  MIR: 47
  Flow cover: 2
  RLT: 1
  Relax-and-lift: 1

Explored 1 nodes (856 simplex iterations) in 0.11 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -101382 -101371 -101362 ... 5.71576e+06
No other solutions better than -101382

Optimal solution found (tolerance 1.00e-06)
Best objective -1.013815897776e+05, best bound -1.013815897776e+05, gap 0.0000%
  Subproblem solved in 0.13s
  Worst-case operational profit (Z_SP) = 141978.66
  Scenario: 22 demand increases, 38 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -101381.59
  [DEBUG]   S×d_nominal = 243360.25
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 243360.25 + -101381.59 = 141978.66
  [DEBUG]   Current θ from Master = 145425.50
  [DEBUG]   ⚠️  Z_SP ≤ θ by 3446.84 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 89.41
  Lower Bound (LB) = 3386.27
  Gap (UB-LB) = 149.9776, Absolute Gap = 149.9776, Relative Gap = 0.042412
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 18
Total Time: 43577.74s
Converged: True
Final Lower Bound: 3386.2702
Final Upper Bound: 3536.2478
Final Gap: 149.977600
Number of Critical Scenarios: 18
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [2] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [1, 3, 7, 9] (4/10)
Active Routes (Plant→DC): 11
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 9 customers  Mode 2: 40 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 18
Start Time: 2026-01-03 19:35:10
End Time: 2026-01-04 07:41:27
Total Time: 43577.74s
Optimal Value: 3386.27
Lower Bound: 3386.27
Upper Bound: 3536.25
Gap: 149.977600
Plants Opened: {0: [2], 1: [1], 2: [1]} (3 plants)
DCs Opened: [1, 3, 7, 9] (4 DCs)
================================================================================

Results saved to: result/DH_single_full_seed28_Mixed_gamma20_20260104_074128.csv

Total Execution Time: 43578.18 seconds
End Time: 2026-01-04 07:41:28

All tasks completed successfully!

