
================================================================================
ROBUST SUPPLY CHAIN OPTIMIZATION - C&CG ALGORITHM
================================================================================
Instance Type: FULL
Dataset Seed: 2
DI Scenario: Mixed
Start Time: 2026-01-04 00:30:44
================================================================================
Loading data from data/DH_data_full_seed2.pkl...

Applying DI scenario: Mixed
DI values:
  Product 0: ['1.000', '1.333', '1.778'] (k=0.710)
  Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
  Product 2: ['1.000', '1.115', '1.244'] (k=0.269)
============================================================
SUPPLY CHAIN DATA SUMMARY
============================================================
Dimensions: K=3, I=3, J=10, R=50, M=3

Economic Parameters:
  Selling price (S): 100.0
  Shortage cost (SC): 50.0

Capacities:
  Plant capacity (MP): min=1012, max=1692
  DC capacity (MC): min=538, max=877

Demand Structure (s_rk matrix):
  Total customer-product pairs: 85/150 (43.3% sparse)
  Average products per customer: 1.70

Demand (only non-zero entries):
  Nominal (μ): min=8.09, max=34.97, count=85
  Deviation (μ̂): min=4.00, max=9.83

Costs:
  Plant fixed cost: min=5209, max=8462
  DC fixed cost: min=3490, max=5712
  Transport modes (TC): [0.05, 0.1, 0.2]

Demand Increase (DI) Scenarios:
  HD:
    Product 0: ['1.000', '1.333', '1.778'] (k=0.710)
    Product 1: ['1.000', '1.395', '1.945'] (k=0.820)
    Product 2: ['1.000', '1.386', '1.922'] (k=0.805)
  MD:
    Product 0: ['1.000', '1.242', '1.542'] (k=0.534)
    Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
    Product 2: ['1.000', '1.211', '1.467'] (k=0.473)
  LD:
    Product 0: ['1.000', '1.018', '1.037'] (k=0.045)
    Product 1: ['1.000', '1.093', '1.194'] (k=0.219)
    Product 2: ['1.000', '1.115', '1.244'] (k=0.269)
  Mixed:
    Product 0: ['1.000', '1.333', '1.778'] (k=0.710)
    Product 1: ['1.000', '1.173', '1.377'] (k=0.394)
    Product 2: ['1.000', '1.115', '1.244'] (k=0.269)
============================================================

Testing Gamma value: 20

================================================================================
RUNNING C&CG FOR Γ = 20
================================================================================
================================================================================
INITIALIZING C&CG ALGORITHM
================================================================================
Problem: K=3, I=3, J=10, R=50, M=3
Uncertainty Budget: Γ = 20
Convergence Tolerance: ε = 200
================================================================================
Creating Master Problem...
Set parameter LicenseID to value 276015
Set parameter GURO_PAR_SPECIAL
Set parameter TokenServer to value "license.crc.pitt.edu"
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Adding nominal scenario (η = 0)...
    [DEBUG] Scenario 0 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 0 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 0]
    [DEBUG]   - Total constraints in model: 16673
    [DEBUG]   - Total variables in model: 8500
Creating Subproblem...
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09
Initialization complete!


================================================================================
STARTING C&CG ITERATIONS
================================================================================


================================================================================
ITERATION 1
================================================================================
[Iteration 1] Solving Master Problem...
  Current scenarios in Master: 1
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 16673 rows, 8500 columns and 48765 nonzeros
Model fingerprint: 0x5e17c2b9
Variable types: 6241 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 2e+03]
Presolve removed 11666 rows and 2666 columns
Presolve time: 0.08s
Presolved: 5007 rows, 5834 columns, 34720 nonzeros
Variable types: 3575 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -277691.3686
Found heuristic solution: objective -180534.4700

Root relaxation: objective 1.057932e+05, 4456 iterations, 0.13 seconds (0.21 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 105793.201    0  397 -180534.47 105793.201   159%     -    0s
H    0     0                    -156278.1431 105793.201   168%     -    0s
     0     0 99694.6751    0  718 -156278.14 99694.6751   164%     -    0s
     0     0 99407.6804    0  738 -156278.14 99407.6804   164%     -    0s
     0     0 99394.9165    0  740 -156278.14 99394.9165   164%     -    0s
     0     0 99390.7641    0  740 -156278.14 99390.7641   164%     -    0s
     0     0 99389.0638    0  740 -156278.14 99389.0638   164%     -    0s
     0     0 99380.1346    0  740 -156278.14 99380.1346   164%     -    0s
     0     0 99367.6562    0  737 -156278.14 99367.6562   164%     -    0s
H    0     0                    -148891.6605 94591.5893   164%     -    1s
     0     0 94591.5893    0  999 -148891.66 94591.5893   164%     -    1s
H    0     0                    -131484.6967 94590.7865   172%     -    1s
H    0     0                    -57712.13900 94290.9045   263%     -    1s
H    0     0                    -57548.62603 94290.9045   264%     -    1s
H    0     0                    -57391.79632 94290.9045   264%     -    1s
H    0     0                    -56845.25833 94290.9045   266%     -    1s
H    0     0                    -56655.95089 94290.9045   266%     -    1s
     0     0 94290.9045    0  987 -56655.951 94290.9045   266%     -    1s
     0     0 94224.6582    0 1080 -56655.951 94224.6582   266%     -    1s
     0     0 94217.2503    0 1080 -56655.951 94217.2503   266%     -    1s
     0     0 94216.8752    0 1082 -56655.951 94216.8752   266%     -    2s
     0     0 91254.5961    0 1046 -56655.951 91254.5961   261%     -    3s
H    0     0                    -53624.20300 91251.5914   270%     -    3s
H    0     0                    -42148.81312 90908.9245   316%     -    3s
H    0     0                    3736.2557588 90908.9245  2333%     -    3s
H    0     0                    38990.751307 90908.9245   133%     -    3s
     0     0 90908.9245    0 1042 38990.7513 90908.9245   133%     -    3s
     0     0 90855.7359    0 1066 38990.7513 90855.7359   133%     -    3s
     0     0 90840.9178    0 1061 38990.7513 90840.9178   133%     -    3s
     0     0 90839.5729    0 1064 38990.7513 90839.5729   133%     -    3s
     0     0 88727.3818    0 1108 38990.7513 88727.3818   128%     -    5s
H    0     0                    39031.058707 88269.9923   126%     -    5s
H    0     0                    39061.809138 88269.9923   126%     -    5s
H    0     0                    39246.681575 88269.9923   125%     -    5s
H    0     0                    39261.526719 88269.9923   125%     -    5s
H    0     0                    39299.619937 88269.9923   125%     -    5s
H    0     0                    39314.465081 88269.9923   125%     -    5s
H    0     0                    39325.661960 88269.9923   124%     -    5s
     0     0 88269.9923    0 1121 39325.6620 88269.9923   124%     -    5s
     0     0 88158.5343    0 1144 39325.6620 88158.5343   124%     -    5s
     0     0 88116.2742    0 1167 39325.6620 88116.2742   124%     -    6s
     0     0 88108.3518    0 1188 39325.6620 88108.3518   124%     -    6s
     0     0 88107.2823    0 1189 39325.6620 88107.2823   124%     -    6s
H    0     0                    39474.816167 86448.6714   119%     -    7s
H    0     0                    40182.906894 86448.6714   115%     -    7s
H    0     0                    40210.516639 86448.6714   115%     -    7s
H    0     0                    40228.339781 86448.6714   115%     -    7s
H    0     0                    40235.544614 86448.6714   115%     -    7s
H    0     0                    40567.429590 86448.6714   113%     -    7s
H    0     0                    40611.567343 86448.6714   113%     -    7s
H    0     0                    40655.642046 86448.6714   113%     -    7s
H    0     0                    40680.005401 86448.6714   113%     -    7s
H    0     0                    40686.270917 86448.6714   112%     -    7s
H    0     0                    41297.184029 86448.6714   109%     -    7s
H    0     0                    42025.514158 86448.6714   106%     -    7s
H    0     0                    42483.718333 86448.6714   103%     -    7s
H    0     0                    43324.636465 86448.6714   100%     -    7s
H    0     0                    43763.242510 86448.6714  97.5%     -    7s
H    0     0                    43883.677302 86448.6714  97.0%     -    7s
H    0     0                    43950.936759 86448.6714  96.7%     -    7s
H    0     0                    44447.489502 86448.6714  94.5%     -    7s
H    0     0                    44830.045425 86448.6714  92.8%     -    7s
     0     0 86448.6714    0 1154 44830.0454 86448.6714  92.8%     -    7s
     0     0 86183.8359    0 1185 44830.0454 86183.8359  92.2%     -    7s
     0     0 86122.2632    0 1190 44830.0454 86122.2632  92.1%     -    8s
     0     0 86109.8347    0 1193 44830.0454 86109.8347  92.1%     -    8s
     0     0 86107.2926    0 1205 44830.0454 86107.2926  92.1%     -    8s
     0     0 84868.0186    0 1170 44830.0454 84868.0186  89.3%     -    9s
     0     0 84654.1201    0 1212 44830.0454 84654.1201  88.8%     -    9s
H    0     0                    45125.067200 84555.1302  87.4%     -   10s
H    0     0                    45423.470304 84555.1302  86.1%     -   10s
H    0     0                    45442.042810 84555.1302  86.1%     -   10s
     0     0 84555.1302    0 1199 45442.0428 84555.1302  86.1%     -   10s
     0     0 84527.6577    0 1226 45442.0428 84527.6577  86.0%     -   10s
     0     0 84524.5699    0 1224 45442.0428 84524.5699  86.0%     -   10s
     0     0 83004.4317    0 1171 45442.0428 83004.4317  82.7%     -   11s
     0     0 82666.4708    0 1171 45442.0428 82666.4708  81.9%     -   12s
     0     0 82588.8614    0 1207 45442.0428 82588.8614  81.7%     -   12s
     0     0 82572.8633    0 1209 45442.0428 82572.8633  81.7%     -   13s
     0     0 82570.1474    0 1215 45442.0428 82570.1474  81.7%     -   13s
     0     0 81414.4972    0 1202 45442.0428 81414.4972  79.2%     -   14s
     0     0 81052.8875    0 1261 45442.0428 81052.8875  78.4%     -   15s
     0     0 80980.8450    0 1266 45442.0428 80980.8450  78.2%     -   15s
     0     0 80965.1784    0 1247 45442.0428 80965.1784  78.2%     -   15s
H    0     0                    45452.362966 80267.7272  76.6%     -   17s
H    0     0                    45487.824960 80267.7272  76.5%     -   17s
H    0     0                    45601.314827 80267.7272  76.0%     -   17s
H    0     0                    46045.837546 80267.7272  74.3%     -   17s
H    0     0                    46402.625059 80267.7272  73.0%     -   17s
H    0     0                    46562.345094 80267.7272  72.4%     -   17s
H    0     0                    46717.841366 80267.7272  71.8%     -   17s
     0     0 80267.7272    0 1148 46717.8414 80267.7272  71.8%     -   17s
     0     0 80141.2279    0 1153 46717.8414 80141.2279  71.5%     -   18s
     0     0 80093.7503    0 1194 46717.8414 80093.7503  71.4%     -   18s
     0     0 80087.3598    0 1186 46717.8414 80087.3598  71.4%     -   18s
H    0     0                    46761.062299 79480.9402  70.0%     -   19s
     0     0 79480.9402    0 1161 46761.0623 79480.9402  70.0%     -   19s
H    0     0                    46950.603666 79480.6601  69.3%     -   19s
     0     0 79321.2273    0 1176 46950.6037 79321.2273  68.9%     -   20s
     0     0 79283.8505    0 1235 46950.6037 79283.8505  68.9%     -   20s
     0     0 79275.7417    0 1236 46950.6037 79275.7417  68.8%     -   20s
     0     0 78847.2921    0 1149 46950.6037 78847.2921  67.9%     -   22s
H    0     0                    46985.586555 78740.1996  67.6%     -   23s
H    0     0                    47181.416129 78740.1996  66.9%     -   23s
H    0     0                    47183.634582 78740.1996  66.9%     -   23s
H    0     0                    47229.086979 78740.1996  66.7%     -   23s
H    0     0                    47257.785847 78740.1996  66.6%     -   23s
     0     0 78740.1996    0 1176 47257.7858 78740.1996  66.6%     -   23s
     0     0 78701.6004    0 1176 47257.7858 78701.6004  66.5%     -   23s
     0     0 78689.1539    0 1172 47257.7858 78689.1539  66.5%     -   23s
H    0     0                    47257.938447 78322.0391  65.7%     -   25s
H    0     0                    47282.244329 78322.0391  65.6%     -   25s
H    0     0                    47303.205609 78322.0391  65.6%     -   25s
H    0     0                    47322.164577 78322.0391  65.5%     -   25s
H    0     0                    47450.724831 78322.0391  65.1%     -   25s
H    0     0                    47500.463654 78322.0391  64.9%     -   25s
     0     0 78322.0391    0 1156 47500.4637 78322.0391  64.9%     -   25s
     0     0 78233.8729    0 1189 47500.4637 78233.8729  64.7%     -   25s
     0     0 78206.4725    0 1177 47500.4637 78206.4725  64.6%     -   25s
     0     0 77879.7583    0 1147 47500.4637 77879.7583  64.0%     -   27s
     0     0 77823.0537    0 1174 47500.4637 77823.0537  63.8%     -   27s
     0     0 77801.8241    0 1195 47500.4637 77801.8241  63.8%     -   27s
     0     0 77524.2823    0 1164 47500.4637 77524.2823  63.2%     -   29s
     0     0 77447.3922    0 1089 47500.4637 77447.3922  63.0%     -   30s
     0     0 77401.8735    0 1111 47500.4637 77401.8735  62.9%     -   30s
     0     0 77385.6877    0 1141 47500.4637 77385.6877  62.9%     -   30s
     0     0 77169.8582    0 1096 47500.4637 77169.8582  62.5%     -   31s
     0     0 77112.2377    0 1103 47500.4637 77112.2377  62.3%     -   32s
     0     0 77093.9521    0 1074 47500.4637 77093.9521  62.3%     -   32s
     0     0 76851.6680    0 1095 47500.4637 76851.6680  61.8%     -   33s
     0     0 76851.3457    0 1095 47500.4637 76851.3457  61.8%     -   34s
     0     2 76851.3319    0 1095 47500.4637 76851.3319  61.8%     -   38s
     1     4 76122.2245    1  957 47500.4637 76851.3319  61.8%  3398   40s
    15    32 74621.7286    4  724 47500.4637 75096.2591  58.1%  3592   46s
    63    96 73235.1349    6  692 47500.4637 74422.5564  56.7%  5322   50s
H  416   438                    47519.913901 74421.9160  56.6%  1369   54s
   437   561 70979.3501   15  454 47519.9139 74421.9160  56.6%  1323   55s
H  924   914                    47613.176949 74104.5913  55.6%   803   58s
  1076  1132 65952.7751   33  330 47613.1769 73984.6459  55.4%   736   60s
  2119  2013 53063.2667   47  252 47613.1769 73948.1336  55.3%   503   65s
H 2124  2013                    47645.525896 73948.1336  55.2%   502   65s
  2819  2553 67596.5505   11  478 47645.5259 73595.4383  54.5%   426   70s
H 2857  2566                    48517.505193 73595.4383  51.7%   423   70s
H 3234  2825                    49188.658598 73231.0693  48.9%   396   72s
H 3246  2814                    49349.941198 73231.0693  48.4%   395   72s
H 3951  3198                    49430.733083 73088.5902  47.9%   360   76s
  3952  3199 58837.4852   32 1095 49430.7331 73088.5902  47.9%   359   86s
  3982  3219 59861.2853   28  466 49430.7331 61685.2406  24.8%   357   90s
H 3986  3060                    49556.460174 61643.6078  24.4%   356   90s
  4147  3137     cutoff   18      49556.4602 58332.8362  17.7%   370   95s
H 4311  2989                    50519.355895 58332.8362  15.5%   370   96s
H 4320  2840                    50916.014196 57823.9853  13.6%   370   96s
H 4637  2701                    50928.714286 57452.7174  12.8%   361   97s
H 4639  2568                    50936.482021 57452.7174  12.8%   361   97s
H 4643  2442                    50939.814972 57452.7174  12.8%   360   97s
H 4644  2322                    50942.733189 57452.7174  12.8%   360   97s
H 4645  2209                    50959.279041 57452.7174  12.7%   360   97s
H 4753  2076                    51001.029896 57181.3210  12.1%   358   97s
H 4761  1971                    51006.103317 57013.0551  11.8%   358   97s
H 4797  1862                    51039.805434 57013.0551  11.7%   358   97s
  5227  1801 54534.7170   29  391 51039.8054 56403.0771  10.5%   351  100s
H 5999  1363                    51047.854172 55367.9262  8.46%   337  103s
  7507   564 51095.7035   64   12 51047.8542 51113.9732  0.13%   284  105s

Cutting planes:
  Gomory: 3
  Implied bound: 5
  Projected implied bound: 30
  MIR: 251
  Flow cover: 652
  RLT: 16
  Relax-and-lift: 118

Explored 7563 nodes (2230857 simplex iterations) in 105.16 seconds (230.84 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 51047.9 51039.8 51006.1 ... 50916

Optimal solution found (tolerance 1.00e-06)
Best objective 5.104785417231e+04, best bound 5.104785417231e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 105.17s
  Master Objective (UB) = 51047.85, θ = 181188.71
  Upper Bound (UB) = 51047.85

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 181188.71
  [DEBUG]   ✓ Scenario 0: θ = 181188.71 ≤ Q = 181188.71 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 1] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x562463fb
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xa9db9c05
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.548810e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8330836.5350
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.364614e+05, 245 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -136461.37    0  124 8330836.54 -136461.37   102%     -    0s
H    0     0                    -101758.6929 -136461.37  34.1%     -    0s
H    0     0                    -102235.8965 -136461.37  33.5%     -    0s
H    0     0                    -105061.5028 -105061.50  0.00%     -    0s
     0     0          -    0      -105061.50 -105061.50  0.00%     -    0s

Cutting planes:
  Gomory: 3
  MIR: 209

Explored 1 nodes (375 simplex iterations) in 0.01 seconds (0.01 work units)
Thread count was 32 (of 64 available processors)

Solution count 5: -105062 -102236 -101759 ... 1.54881e+13
No other solutions better than -105062

Optimal solution found (tolerance 1.00e-06)
Best objective -1.050615027965e+05, best bound -1.050615027965e+05, gap 0.0000%
  Subproblem solved in 0.03s
  Worst-case operational profit (Z_SP) = 148666.89
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -105061.50
  [DEBUG]   S×d_nominal = 253728.40
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 253728.40 + -105061.50 = 148666.89
  [DEBUG]   Current θ from Master = 181188.71
  [DEBUG]   ⚠️  Z_SP ≤ θ by 32521.82 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 18526.04
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 32521.8167, Absolute Gap = 32521.8167, Relative Gap = 0.637085
  Not converged yet (gap = 32521.82 > ε = 200)

  [DEBUG] Adding NEW scenario 1 to Master Problem...
  [DEBUG] New scenario pattern: 0 increases, 60 decreases
    [DEBUG] Scenario 1 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 1 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 1]
    [DEBUG]   - Total constraints in model: 31963
    [DEBUG]   - Total variables in model: 14740
  [DEBUG] Total scenarios in Master: 2
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 2
================================================================================
[Iteration 2] Solving Master Problem...
  Current scenarios in Master: 2
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 31963 rows, 14740 columns and 92011 nonzeros
Model fingerprint: 0x57600b45
Variable types: 12481 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 18526 (0.01s)
MIP start from previous solve produced solution with objective 18526 (0.01s)
Loaded MIP start from previous solve with objective 18526

Presolve removed 13161 rows and 5340 columns
Presolve time: 0.31s
Presolved: 18802 rows, 9400 columns, 104218 nonzeros
Variable types: 7141 continuous, 2259 integer (2259 binary)

Root relaxation: objective 5.643425e+04, 9601 iterations, 1.23 seconds (2.46 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 56434.2522    0  289 18526.0375 56434.2522   205%     -    1s
H    0     0                    20466.361930 56434.2522   176%     -    1s
H    0     0                    21403.265534 56434.2522   164%     -    1s
     0     0 49787.4315    0  365 21403.2655 49787.4315   133%     -    2s
H    0     0                    21525.103569 49782.9497   131%     -    3s
     0     0 49553.0336    0  467 21525.1036 49553.0336   130%     -    3s
     0     0 49532.5366    0  468 21525.1036 49532.5366   130%     -    3s
     0     0 45583.1973    0  574 21525.1036 45583.1973   112%     -    5s
     0     0 44973.2959    0  635 21525.1036 44973.2959   109%     -    5s
     0     0 44924.0322    0  594 21525.1036 44924.0322   109%     -    5s
     0     0 44920.4397    0  619 21525.1036 44920.4397   109%     -    5s
     0     0 44920.2148    0  613 21525.1036 44920.2148   109%     -    5s
H    0     0                    26200.651471 44920.2148  71.4%     -    6s
H    0     0                    26541.419643 44920.2148  69.2%     -    6s
H    0     0                    26803.458294 44920.2148  67.6%     -    6s
H    0     0                    26843.365186 42522.1961  58.4%     -    7s
     0     0 42522.1961    0  263 26843.3652 42522.1961  58.4%     -    7s
     0     0 41681.7628    0  364 26843.3652 41681.7628  55.3%     -    8s
     0     0 41481.2240    0  348 26843.3652 41481.2240  54.5%     -    9s
     0     0 41432.7653    0  284 26843.3652 41432.7653  54.4%     -    9s
     0     0 41430.3298    0  277 26843.3652 41430.3298  54.3%     -    9s
H    0     0                    26869.161114 41430.3298  54.2%     -   10s
H    0     0                    26877.385278 41430.3298  54.1%     -   10s
H    0     0                    26941.953827 41430.3298  53.8%     -   10s
H    0     0                    26951.846376 39257.1770  45.7%     -   12s
     0     0 39257.1770    0  556 26951.8464 39257.1770  45.7%     -   12s
     0     0 38652.9879    0  496 26951.8464 38652.9879  43.4%     -   13s
     0     0 38512.3896    0  606 26951.8464 38512.3896  42.9%     -   13s
     0     0 38423.4966    0  527 26951.8464 38423.4966  42.6%     -   14s
     0     0 38403.7307    0  530 26951.8464 38403.7307  42.5%     -   14s
     0     0 38400.8071    0  536 26951.8464 38400.8071  42.5%     -   14s
     0     0 37486.4726    0  695 26951.8464 37486.4726  39.1%     -   16s
     0     0 37261.1705    0  781 26951.8464 37261.1705  38.3%     -   16s
     0     0 37183.6655    0  809 26951.8464 37183.6655  38.0%     -   17s
     0     0 37142.0585    0  793 26951.8464 37142.0585  37.8%     -   17s
     0     0 37129.0863    0  816 26951.8464 37129.0863  37.8%     -   17s
     0     0 37126.3139    0  828 26951.8464 37126.3139  37.8%     -   17s
     0     0 36665.9717    0  443 26951.8464 36665.9717  36.0%     -   19s
H    0     0                    26968.147014 36665.3880  36.0%     -   19s
     0     0 36516.9664    0  461 26968.1470 36516.9664  35.4%     -   20s
     0     0 36458.3752    0  487 26968.1470 36458.3752  35.2%     -   20s
     0     0 36443.0105    0  472 26968.1470 36443.0105  35.1%     -   20s
     0     0 36439.0796    0  476 26968.1470 36439.0796  35.1%     -   20s
     0     0 36194.3560    0  435 26968.1470 36194.3560  34.2%     -   21s
     0     0 36087.5026    0  451 26968.1470 36087.5026  33.8%     -   22s
     0     0 36051.1178    0  466 26968.1470 36051.1178  33.7%     -   22s
     0     0 36022.5044    0  472 26968.1470 36022.5044  33.6%     -   22s
     0     0 36010.4172    0  481 26968.1470 36010.4172  33.5%     -   22s
     0     0 36003.3595    0  486 26968.1470 36003.3595  33.5%     -   22s
     0     0 36002.7467    0  485 26968.1470 36002.7467  33.5%     -   22s
     0     0 35901.8043    0  455 26968.1470 35901.8043  33.1%     -   23s
     0     0 35875.1679    0  463 26968.1470 35875.1679  33.0%     -   23s
     0     0 35868.7738    0  466 26968.1470 35868.7738  33.0%     -   24s
     0     0 35807.7411    0  449 26968.1470 35807.7411  32.8%     -   24s
     0     0 35791.0458    0  454 26968.1470 35791.0458  32.7%     -   25s
     0     0 35787.2068    0  456 26968.1470 35787.2068  32.7%     -   25s
     0     0 35751.6726    0  477 26968.1470 35751.6726  32.6%     -   25s
     0     0 35730.1895    0  476 26968.1470 35730.1895  32.5%     -   26s
     0     0 35717.3630    0  499 26968.1470 35717.3630  32.4%     -   26s
     0     0 35715.5195    0  489 26968.1470 35715.5195  32.4%     -   26s
     0     0 35695.9652    0  545 26968.1470 35695.9652  32.4%     -   27s
     0     0 35694.0852    0  545 26968.1470 35694.0852  32.4%     -   27s
     0     2 35694.0852    0  545 26968.1470 35694.0852  32.4%     -   31s
    31    64 34235.3409    5  444 26968.1470 35172.3080  30.4%  1182   35s
   333   363 32025.7019    9  277 26968.1470 34799.9060  29.0%   582   40s
   697   605 30150.3001   14  363 26968.1470 34218.3954  26.9%   576   45s
   983   715 32485.4806    9  258 26968.1470 33876.6024  25.6%   571   50s
  1385   852     cutoff   13      26968.1470 33737.9476  25.1%   559   55s
  1696   929 29428.3432   17  382 26968.1470 33737.9476  25.1%   551   60s
  2025  1006     cutoff   20      26968.1470 33150.4271  22.9%   537   65s
  2439  1058 31563.4587   13  334 26968.1470 33076.0904  22.6%   518   70s
  2973  1145     cutoff   15      26968.1470 32617.6511  20.9%   528   75s
  3382  1190 31670.3755   11  237 26968.1470 32300.4455  19.8%   519   80s
  3983  1282     cutoff   16      26968.1470 32166.6186  19.3%   526   86s
  4779  1343 28574.1310   16  104 26968.1470 31597.4701  17.2%   518   91s
  5294  1337 29923.3071   13  189 26968.1470 31396.5838  16.4%   519   95s
  5859  1332 28089.8723   13  481 26968.1470 31229.8427  15.8%   525  102s
  6379  1299     cutoff   16      26968.1470 30990.7340  14.9%   534  106s
  6962  1237 28171.6775   13  380 26968.1470 30850.4374  14.4%   539  111s
  7628  1076 28371.0911    8  280 26968.1470 30449.3178  12.9%   543  116s
  8523   831     cutoff   14      26968.1470 29963.1677  11.1%   534  121s
  9606   581 infeasible   18      26968.1470 29424.1848  9.11%   523  126s
  9959   102     cutoff   16      26968.1470 29116.8905  7.97%   520  131s

Cutting planes:
  Learned: 1
  Implied bound: 1
  MIR: 1525
  Flow cover: 1043
  RLT: 41
  Relax-and-lift: 350

Explored 10635 nodes (5404022 simplex iterations) in 134.02 seconds (381.56 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26968.1 26951.8 26942 ... 21525.1

Optimal solution found (tolerance 1.00e-06)
Best objective 2.696814701402e+04, best bound 2.696814701402e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 134.04s
  Master Objective (UB) = 26968.15, θ = 149627.98
  Upper Bound (UB) = 26968.15

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 149627.98
  [DEBUG]   ✓ Scenario 0: θ = 149627.98 ≤ Q = 149627.98 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 149627.98 ≤ Q = 149627.98 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 2] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x479c77b4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xb863884c
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.454065e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7593399.4230
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.468126e+05, 265 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -146812.63    0  136 7593399.42 -146812.63   102%     -    0s
H    0     0                    -110125.2063 -146812.63  33.3%     -    0s
H    0     0                    -127394.2604 -146812.63  15.2%     -    0s
     0     0 -135404.14    0   77 -127394.26 -135404.14  6.29%     -    0s
H    0     0                    -133124.7914 -135281.29  1.62%     -    0s
     0     0 -134675.48    0   81 -133124.79 -134675.48  1.16%     -    0s
     0     0 -134667.12    0   81 -133124.79 -134667.12  1.16%     -    0s
     0     0 -134057.62    0   32 -133124.79 -134057.62  0.70%     -    0s
H    0     0                    -133870.3030 -134033.40  0.12%     -    0s
     0     0 -133998.07    0   29 -133870.30 -133998.07  0.10%     -    0s
     0     0 -133970.72    0   18 -133870.30 -133970.72  0.08%     -    0s
     0     0 -133950.11    0   16 -133870.30 -133950.11  0.06%     -    0s
     0     0 -133932.89    0   12 -133870.30 -133932.89  0.05%     -    0s
     0     0 -133926.26    0   10 -133870.30 -133926.26  0.04%     -    0s
     0     0 -133923.91    0   10 -133870.30 -133923.91  0.04%     -    0s
     0     0 -133894.03    0    8 -133870.30 -133894.03  0.02%     -    0s
     0     0 -133891.21    0    6 -133870.30 -133891.21  0.02%     -    0s
H    0     0                    -133877.7805 -133891.21  0.01%     -    0s
*    0     0               0    -133879.8724 -133879.87  0.00%     -    0s

Cutting planes:
  Implied bound: 4
  MIR: 4
  Flow cover: 3
  RLT: 2
  Relax-and-lift: 1

Explored 1 nodes (680 simplex iterations) in 0.07 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -133880 -133878 -133870 ... 1.45406e+13
No other solutions better than -133880

Optimal solution found (tolerance 1.00e-06)
Best objective -1.338798724012e+05, best bound -1.338798724012e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 126852.04
  Scenario: 34 demand increases, 26 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -133879.87
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -133879.87 = 126852.04
  [DEBUG]   Current θ from Master = 149627.98
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22775.94 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4192.20
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 8442.1095, Absolute Gap = 8442.1095, Relative Gap = 0.313040
  Not converged yet (gap = 8442.11 > ε = 200)

  [DEBUG] Adding NEW scenario 2 to Master Problem...
  [DEBUG] New scenario pattern: 34 increases, 26 decreases
    [DEBUG] Scenario 2 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 2 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 2]
    [DEBUG]   - Total constraints in model: 47253
    [DEBUG]   - Total variables in model: 20980
  [DEBUG] Total scenarios in Master: 3
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 3
================================================================================
[Iteration 3] Solving Master Problem...
  Current scenarios in Master: 3
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 47253 rows, 20980 columns and 135257 nonzeros
Model fingerprint: 0x3ef51ddb
Variable types: 18721 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 4192.2 (0.01s)
Loaded MIP start from previous solve with objective 4192.2

Presolve removed 19715 rows and 8005 columns
Presolve time: 0.42s
Presolved: 27538 rows, 12975 columns, 169514 nonzeros
Variable types: 10716 continuous, 2259 integer (2259 binary)
Deterministic concurrent LP optimizer: primal and dual simplex
Showing primal log only...


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36445    4.6089728e+04   0.000000e+00   8.181829e+04      5s
Concurrent spin time: 0.00s

Solved with dual simplex

Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   19735    4.8426683e+04   0.000000e+00   0.000000e+00      5s

Root relaxation: objective 4.842668e+04, 19735 iterations, 4.74 seconds (9.43 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 48426.6826    0  213 4192.20334 48426.6826  1055%     -    5s
H    0     0                    23406.082510 48426.6826   107%     -    5s
H    0     0                    23565.313679 48426.6826   105%     -    5s
     0     0 42996.9888    0  215 23565.3137 42996.9888  82.5%     -    7s
H    0     0                    23891.639399 42988.9095  79.9%     -    7s
H    0     0                    25732.376137 42988.9095  67.1%     -    7s
H    0     0                    25807.330924 42988.9095  66.6%     -    7s
H    0     0                    25848.535643 42988.9095  66.3%     -    7s
     0     0 42201.2955    0  212 25848.5356 42201.2955  63.3%     -    8s
     0     0 42201.2955    0  214 25848.5356 42201.2955  63.3%     -    8s
     0     0 42201.2955    0  214 25848.5356 42201.2955  63.3%     -    8s
     0     0 42201.2955    0  216 25848.5356 42201.2955  63.3%     -    8s
     0     0 40477.3597    0  242 25848.5356 40477.3597  56.6%     -   10s
H    0     0                    25868.818058 40475.2141  56.5%     -   10s
     0     0 39784.9387    0  245 25868.8181 39784.9387  53.8%     -   11s
     0     0 39673.2739    0  323 25868.8181 39673.2739  53.4%     -   12s
     0     0 39412.6038    0  336 25868.8181 39412.6038  52.4%     -   12s
     0     0 39382.9871    0  320 25868.8181 39382.9871  52.2%     -   12s
     0     0 39379.7261    0  329 25868.8181 39379.7261  52.2%     -   12s
     0     0 39378.9470    0  329 25868.8181 39378.9470  52.2%     -   12s
H    0     0                    25878.948864 38182.1434  47.5%     -   15s
H    0     0                    25912.608990 38182.1434  47.3%     -   15s
     0     0 38182.1434    0  377 25912.6090 38182.1434  47.3%     -   15s
H    0     0                    25955.667195 38182.0422  47.1%     -   15s
     0     0 37654.5274    0  435 25955.6672 37654.5274  45.1%     -   16s
     0     0 37283.6964    0  395 25955.6672 37283.6964  43.6%     -   17s
     0     0 37073.0158    0  396 25955.6672 37073.0158  42.8%     -   17s
     0     0 37024.6942    0  402 25955.6672 37024.6942  42.6%     -   18s
     0     0 37012.0910    0  402 25955.6672 37012.0910  42.6%     -   18s
     0     0 37006.5607    0  398 25955.6672 37006.5607  42.6%     -   18s
     0     0 37000.8092    0  405 25955.6672 37000.8092  42.6%     -   18s
     0     0 36997.5570    0  405 25955.6672 36997.5570  42.5%     -   18s
     0     0 36997.1757    0  405 25955.6672 36997.1757  42.5%     -   18s
     0     0 36383.8327    0  444 25955.6672 36383.8327  40.2%     -   21s
     0     0 36057.8709    0  435 25955.6672 36057.8709  38.9%     -   23s
     0     0 35812.3638    0  437 25955.6672 35812.3638  38.0%     -   24s
     0     0 35594.2459    0  439 25955.6672 35594.2459  37.1%     -   25s
     0     0 35549.3251    0  452 25955.6672 35549.3251  37.0%     -   25s
     0     0 35532.2293    0  458 25955.6672 35532.2293  36.9%     -   26s
     0     0 35509.8265    0  451 25955.6672 35509.8265  36.8%     -   26s
     0     0 35496.0226    0  451 25955.6672 35496.0226  36.8%     -   26s
     0     0 35491.7755    0  452 25955.6672 35491.7755  36.7%     -   26s
     0     0 35491.0620    0  449 25955.6672 35491.0620  36.7%     -   27s
     0     0 35393.7001    0  505 25955.6672 35393.7001  36.4%     -   28s
H    0     0                    26268.340993 35392.9486  34.7%     -   28s
H    0     0                    26340.227740 35392.9486  34.4%     -   28s
H    0     0                    26352.297877 35392.9486  34.3%     -   28s
H    0     0                    26365.893452 35392.9486  34.2%     -   28s
     0     0 35367.1892    0  494 26365.8935 35367.1892  34.1%     -   29s
     0     0 35355.6979    0  487 26365.8935 35355.6979  34.1%     -   29s
     0     0 35349.6581    0  503 26365.8935 35349.6581  34.1%     -   29s
     0     0 35348.1984    0  497 26365.8935 35348.1984  34.1%     -   29s
     0     0 35293.0075    0  442 26365.8935 35293.0075  33.9%     -   30s
H    0     0                    26375.786001 35293.0064  33.8%     -   30s
     0     0 35272.8123    0  503 26375.7860 35272.8123  33.7%     -   31s
     0     0 35268.2815    0  503 26375.7860 35268.2815  33.7%     -   31s
     0     0 35258.2474    0  496 26375.7860 35258.2474  33.7%     -   31s
     0     0 35256.2733    0  461 26375.7860 35256.2733  33.7%     -   31s
     0     0 35255.5404    0  454 26375.7860 35255.5404  33.7%     -   31s
     0     0 35204.8152    0  558 26375.7860 35204.8152  33.5%     -   32s
     0     0 35196.4349    0  556 26375.7860 35196.4349  33.4%     -   33s
     0     0 35170.4496    0  549 26375.7860 35170.4496  33.3%     -   33s
     0     0 35164.4139    0  556 26375.7860 35164.4139  33.3%     -   33s
     0     0 35162.6069    0  559 26375.7860 35162.6069  33.3%     -   33s
     0     0 35162.4034    0  563 26375.7860 35162.4034  33.3%     -   33s
     0     0 35115.1263    0  503 26375.7860 35115.1263  33.1%     -   34s
     0     0 35104.1736    0  508 26375.7860 35104.1736  33.1%     -   35s
     0     0 35101.4824    0  512 26375.7860 35101.4824  33.1%     -   35s
     0     0 35100.9641    0  465 26375.7860 35100.9641  33.1%     -   35s
     0     0 35089.6356    0  502 26375.7860 35089.6356  33.0%     -   35s
     0     0 35082.8389    0  514 26375.7860 35082.8389  33.0%     -   36s
     0     0 35082.1593    0  520 26375.7860 35082.1593  33.0%     -   36s
     0     0 35076.0855    0  516 26375.7860 35076.0855  33.0%     -   37s
     0     0 35074.1396    0  511 26375.7860 35074.1396  33.0%     -   37s
     0     0 35073.6293    0  511 26375.7860 35073.6293  33.0%     -   37s
     0     0 35064.5357    0  470 26375.7860 35064.5357  32.9%     -   38s
H    0     0                    26433.084000 35059.7088  32.6%     -   38s
     0     0 35059.7088    0  511 26433.0840 35059.7088  32.6%     -   38s
     0     0 35058.3800    0  471 26433.0840 35058.3800  32.6%     -   38s
     0     0 35055.4382    0  524 26433.0840 35055.4382  32.6%     -   39s
     0     0 35055.2123    0  524 26433.0840 35055.2123  32.6%     -   39s
H    0     0                    26453.725067 35055.2123  32.5%     -   44s
     0     2 35055.2123    0  524 26453.7251 35055.2123  32.5%     -   46s
     3     8 34427.1644    2  503 26453.7251 34892.6394  31.9%  2665   50s
    31    64 33521.5141    5  559 26453.7251 34192.0292  29.3%  3740   56s
    95   152 33292.5862    7  524 26453.7251 33663.3779  27.3%  2969   60s
H  115   152                    26479.048156 33663.3779  27.1%  2684   60s
   358   364 31436.0999   12  543 26479.0482 33517.9510  26.6%  1398   66s
   505   420 31400.5630   13  485 26479.0482 33517.9510  26.6%  1276   71s
   588   483 30912.6957   14  467 26479.0482 33517.9510  26.6%  1355   76s
   687   519 30151.3777   15  420 26479.0482 33289.5713  25.7%  1416   81s
   801   568 29947.7645   16  543 26479.0482 33277.7297  25.7%  1405   86s
   923   634 29148.4088   18  407 26479.0482 33184.2985  25.3%  1378   90s
  1031   678 28936.8722   19  457 26479.0482 33184.2985  25.3%  1363   95s
  1136   710 infeasible   20      26479.0482 33184.2985  25.3%  1349  100s
  1261   738 30356.2784   14  381 26479.0482 32870.8241  24.1%  1341  107s
  1426   782 29933.8287   16  396 26479.0482 32593.2552  23.1%  1311  113s
  1531   834 29209.4125   18  379 26479.0482 32593.2552  23.1%  1294  117s
  1637   871 27951.5704   19  160 26479.0482 32593.2552  23.1%  1283  121s
  1766   916 28478.9202   21  421 26479.0482 31984.4409  20.8%  1262  125s
  2015   960 27482.7958   27  358 26479.0482 31753.4052  19.9%  1236  132s
  2154   995 26548.0688   30  340 26479.0482 31753.4052  19.9%  1215  135s
  2440  1004 28603.4999   19  392 26479.0482 31622.1981  19.4%  1199  143s
  2579  1023     cutoff   21      26479.0482 31622.1981  19.4%  1194  147s
  2740  1053 infeasible   20      26479.0482 31622.1981  19.4%  1186  150s
  3033  1152     cutoff   11      26479.0482 31169.0971  17.7%  1180  159s
  3239  1171 27961.0530   12  258 26479.0482 31078.5186  17.4%  1164  162s
  3290  1204 26692.9480   14  249 26479.0482 30932.1840  16.8%  1168  166s
  3433  1234 29064.6474   12  231 26479.0482 30927.7518  16.8%  1162  170s
  3613  1245 28006.6715   11  374 26479.0482 30861.1262  16.5%  1160  175s
  4012  1314 28605.5654   21  301 26479.0482 30608.6912  15.6%  1149  182s
  4242  1328 27520.6449   24  428 26479.0482 30549.1646  15.4%  1139  186s
  4479  1345     cutoff   29      26479.0482 30498.3304  15.2%  1129  191s
  4749  1366 27575.7097   17  375 26479.0482 30325.6949  14.5%  1127  199s
  4905  1402 27418.5464   18  367 26479.0482 30325.6949  14.5%  1124  204s
  5193  1438     cutoff   22      26479.0482 30325.6949  14.5%  1111  209s
  5505  1454 26841.8412   12  250 26479.0482 30020.3963  13.4%  1100  215s
  5847  1438     cutoff   14      26479.0482 29947.2661  13.1%  1088  220s
  6179  1423 infeasible   19      26479.0482 29702.9264  12.2%  1081  225s
  6468  1424 infeasible   13      26479.0482 29669.2579  12.0%  1083  232s
  6879  1417     cutoff   19      26479.0482 29509.9630  11.4%  1068  237s
  6957  1417     cutoff   18      26479.0482 29430.9142  11.1%  1069  243s
  7113  1389     cutoff   15      26479.0482 29356.7623  10.9%  1067  249s
  7523  1369 26612.8662   25  123 26479.0482 29289.6307  10.6%  1054  255s
  7949  1319 27182.3252   18  107 26479.0482 29128.8626  10.0%  1046  262s
  8411  1256     cutoff   22      26479.0482 28929.9051  9.26%  1036  268s
  8858  1163 27407.4720   26  389 26479.0482 28662.4036  8.25%  1025  274s
  9379   988     cutoff   19      26479.0482 28450.6530  7.45%  1013  282s
  9963   826 26557.1045   23  240 26479.0482 28267.2432  6.75%   999  289s
 10494   433 26751.1425   32  429 26479.0482 27974.5892  5.65%   985  296s
 11265    22     cutoff   24      26479.0482 27564.1641  4.10%   959  303s

Cutting planes:
  Learned: 2
  Cover: 1
  Implied bound: 21
  MIR: 339
  Flow cover: 775
  Zero half: 1
  RLT: 42
  Relax-and-lift: 73

Explored 11967 nodes (11140309 simplex iterations) in 303.82 seconds (1035.59 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 26479 26453.7 26433.1 ... 25912.6

Optimal solution found (tolerance 1.00e-06)
Best objective 2.647904815577e+04, best bound 2.647904815577e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 303.86s
  Master Objective (UB) = 26479.05, θ = 149345.82
  Upper Bound (UB) = 26479.05

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 149345.82
  [DEBUG]   ✓ Scenario 0: θ = 149345.82 ≤ Q = 149345.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 149345.82 ≤ Q = 149345.82 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 149345.82 ≤ Q = 149345.82 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 3] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x9961988
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x09961988
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.458963e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7558222.0193
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.445195e+05, 267 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -144519.47    0  135 7558222.02 -144519.47   102%     -    0s
H    0     0                    -105396.1451 -144519.47  37.1%     -    0s
H    0     0                    -106256.9062 -144519.47  36.0%     -    0s
H    0     0                    -123689.5133 -144519.47  16.8%     -    0s
H    0     0                    -124048.2680 -144519.47  16.5%     -    0s
     0     0 -133809.78    0   81 -124048.27 -133809.78  7.87%     -    0s
H    0     0                    -130755.4146 -133755.37  2.29%     -    0s
H    0     0                    -131058.4532 -133755.37  2.06%     -    0s
H    0     0                    -131722.0827 -133755.37  1.54%     -    0s
H    0     0                    -132025.1213 -133755.37  1.31%     -    0s
     0     0 -132931.57    0   81 -132025.12 -132931.57  0.69%     -    0s
     0     0 -132931.24    0   81 -132025.12 -132931.24  0.69%     -    0s
     0     0 -132497.40    0   41 -132025.12 -132497.40  0.36%     -    0s
H    0     0                    -132171.2990 -132489.22  0.24%     -    0s
     0     0 -132423.44    0   36 -132171.30 -132423.44  0.19%     -    0s
     0     0 -132412.88    0   29 -132171.30 -132412.88  0.18%     -    0s
     0     0 -132392.28    0   30 -132171.30 -132392.28  0.17%     -    0s
     0     0 -132386.54    0   30 -132171.30 -132386.54  0.16%     -    0s
     0     0 -132329.24    0   11 -132171.30 -132329.24  0.12%     -    0s
     0     0 -132329.24    0   14 -132188.47 -132329.24  0.11%     -    0s
H    0     0                    -132204.0190 -132329.24  0.09%     -    0s
     0     0 -132283.74    0    7 -132204.02 -132283.74  0.06%     -    0s
     0     0 -132282.83    0    5 -132204.02 -132282.83  0.06%     -    0s
H    0     0                    -132256.9961 -132282.40  0.02%     -    0s
H    0     0                    -132277.2560 -132282.40  0.00%     -    0s
     0     0     cutoff    0      -132277.26 -132277.26  0.00%     -    0s

Cutting planes:
  Gomory: 1
  Implied bound: 1
  MIR: 8
  Flow cover: 7
  RLT: 1
  Relax-and-lift: 3

Explored 1 nodes (830 simplex iterations) in 0.05 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -132277 -132257 -132204 ... -123690
No other solutions better than -132277

Optimal solution found (tolerance 1.00e-06)
Best objective -1.322772560098e+05, best bound -1.322772560098e+05, gap 0.0000%
  Subproblem solved in 0.07s
  Worst-case operational profit (Z_SP) = 127120.17
  Scenario: 36 demand increases, 24 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -132277.26
  [DEBUG]   S×d_nominal = 259397.42
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 259397.42 + -132277.26 = 127120.17
  [DEBUG]   Current θ from Master = 149345.82
  [DEBUG]   ⚠️  Z_SP ≤ θ by 22225.66 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 4253.39
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 7953.0107, Absolute Gap = 7953.0107, Relative Gap = 0.300351
  Not converged yet (gap = 7953.01 > ε = 200)

  [DEBUG] Adding NEW scenario 3 to Master Problem...
  [DEBUG] New scenario pattern: 36 increases, 24 decreases
    [DEBUG] Scenario 3 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 3 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 3]
    [DEBUG]   - Total constraints in model: 62543
    [DEBUG]   - Total variables in model: 27220
  [DEBUG] Total scenarios in Master: 4
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 4
================================================================================
[Iteration 4] Solving Master Problem...
  Current scenarios in Master: 4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 62543 rows, 27220 columns and 178503 nonzeros
Model fingerprint: 0x1926b599
Variable types: 24961 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve produced solution with objective 4253.39 (0.07s)
Loaded MIP start from previous solve with objective 4253.39

Presolve removed 26280 rows and 10670 columns
Presolve time: 0.56s
Presolved: 36263 rows, 16550 columns, 224199 nonzeros
Variable types: 14291 continuous, 2259 integer (2259 binary)

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 36263 rows, 16550 columns, 224199 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   42561    3.1752188e+04   0.000000e+00   5.493772e+05      5s
Concurrent spin time: 0.73s

Solved with dual simplex

Root relaxation: objective 4.772144e+04, 27434 iterations, 8.70 seconds (17.71 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 47721.4365    0  174 4253.39237 47721.4365  1022%     -    9s
H    0     0                    24821.468713 47721.4365  92.3%     -    9s
H    0     0                    25057.535211 47721.4365  90.4%     -    9s
H    0     0                    25158.048069 47721.4365  89.7%     -   10s
H    0     0                    25167.648749 47721.4365  89.6%     -   10s
H    0     0                    25168.534032 47721.4365  89.6%     -   10s
     0     0 43204.3174    0  217 25168.5340 43204.3174  71.7%     -   12s
     0     0 42686.7911    0  219 25168.5340 42686.7911  69.6%     -   14s
     0     0 42686.7911    0  217 25168.5340 42686.7911  69.6%     -   14s
     0     0 42686.7911    0  218 25168.5340 42686.7911  69.6%     -   14s
H    0     0                    25424.921702 40585.5743  59.6%     -   17s
     0     0 40542.0770    0  289 25424.9217 40542.0770  59.5%     -   17s
H    0     0                    25435.890166 40542.0770  59.4%     -   17s
H    0     0                    25448.347788 40542.0770  59.3%     -   17s
H    0     0                    25457.219396 40542.0770  59.3%     -   17s
H    0     0                    25470.376993 40542.0770  59.2%     -   17s
     0     0 40225.9789    0  306 25470.3770 40225.9789  57.9%     -   18s
     0     0 39905.9772    0  282 25470.3770 39905.9772  56.7%     -   19s
     0     0 39779.1216    0  329 25470.3770 39779.1216  56.2%     -   20s
     0     0 39751.2417    0  296 25470.3770 39751.2417  56.1%     -   20s
     0     0 39745.7253    0  273 25470.3770 39745.7253  56.0%     -   20s
     0     0 39729.2126    0  274 25470.3770 39729.2126  56.0%     -   20s
     0     0 39728.8448    0  271 25470.3770 39728.8448  56.0%     -   20s
     0     0 37765.5977    0  418 25470.3770 37765.5977  48.3%     -   25s
H    0     0                    25486.743997 37763.4505  48.2%     -   25s
H    0     0                    25547.911290 37763.4505  47.8%     -   25s
H    0     0                    25556.353905 37763.4505  47.8%     -   25s
H    0     0                    25567.734180 37763.4505  47.7%     -   25s
     0     0 37206.1091    0  383 25567.7342 37206.1091  45.5%     -   28s
     0     0 37008.0502    0  437 25567.7342 37008.0502  44.7%     -   29s
     0     0 36952.9812    0  441 25567.7342 36952.9812  44.5%     -   30s
     0     0 36860.9923    0  422 25567.7342 36860.9923  44.2%     -   31s
     0     0 36810.0326    0  426 25567.7342 36810.0326  44.0%     -   31s
     0     0 36799.1754    0  413 25567.7342 36799.1754  43.9%     -   31s
     0     0 36794.7661    0  427 25567.7342 36794.7661  43.9%     -   32s
     0     0 36787.9535    0  427 25567.7342 36787.9535  43.9%     -   32s
     0     0 36786.6258    0  426 25567.7342 36786.6258  43.9%     -   32s
     0     0 36786.5328    0  428 25567.7342 36786.5328  43.9%     -   32s
H    0     0                    25681.253661 36786.5328  43.2%     -   33s
H    0     0                    25700.967064 36786.5328  43.1%     -   33s
H    0     0                    25746.021182 36786.5328  42.9%     -   33s
H    0     0                    25754.351322 36786.5328  42.8%     -   33s
H    0     0                    25757.127815 36786.5328  42.8%     -   33s
H    0     0                    25761.006215 36786.5328  42.8%     -   33s
     0     0 35912.9779    0  466 25761.0062 35912.9779  39.4%     -   36s
     0     0 35755.9936    0  420 25761.0062 35755.9936  38.8%     -   38s
     0     0 35609.7960    0  479 25761.0062 35609.7960  38.2%     -   40s
     0     0 35463.4407    0  479 25761.0062 35463.4407  37.7%     -   41s
     0     0 35420.0129    0  481 25761.0062 35420.0129  37.5%     -   42s
     0     0 35411.3311    0  486 25761.0062 35411.3311  37.5%     -   42s
     0     0 35408.8169    0  491 25761.0062 35408.8169  37.5%     -   42s
     0     0 35407.7344    0  493 25761.0062 35407.7344  37.4%     -   42s
     0     0 35293.3399    0  448 25761.0062 35293.3399  37.0%     -   44s
     0     0 35226.4072    0  447 25761.0062 35226.4072  36.7%     -   45s
     0     0 35210.3282    0  502 25761.0062 35210.3282  36.7%     -   45s
     0     0 35206.1221    0  504 25761.0062 35206.1221  36.7%     -   46s
     0     0 35203.5363    0  501 25761.0062 35203.5363  36.7%     -   46s
     0     0 35203.2687    0  504 25761.0062 35203.2687  36.7%     -   46s
     0     0 35124.6644    0  500 25761.0062 35124.6644  36.3%     -   48s
     0     0 35106.6181    0  461 25761.0062 35106.6181  36.3%     -   48s
     0     0 35085.3700    0  500 25761.0062 35085.3700  36.2%     -   49s
     0     0 35079.4993    0  505 25761.0062 35079.4993  36.2%     -   50s
     0     0 35068.5085    0  459 25761.0062 35068.5085  36.1%     -   50s
     0     0 35065.8720    0  471 25761.0062 35065.8720  36.1%     -   50s
     0     0 35064.9562    0  474 25761.0062 35064.9562  36.1%     -   50s
     0     0 34999.1924    0  462 25761.0062 34999.1924  35.9%     -   51s
     0     0 34976.5695    0  514 25761.0062 34976.5695  35.8%     -   52s
     0     0 34964.3576    0  514 25761.0062 34964.3576  35.7%     -   53s
     0     0 34959.9596    0  470 25761.0062 34959.9596  35.7%     -   53s
     0     0 34957.5225    0  465 25761.0062 34957.5225  35.7%     -   53s
     0     0 34956.9356    0  467 25761.0062 34956.9356  35.7%     -   53s
     0     0 34927.6702    0  507 25761.0062 34927.6702  35.6%     -   54s
     0     0 34907.6546    0  515 25761.0062 34907.6546  35.5%     -   55s
     0     0 34902.6759    0  516 25761.0062 34902.6759  35.5%     -   55s
     0     0 34898.7735    0  517 25761.0062 34898.7735  35.5%     -   55s
     0     0 34897.1793    0  516 25761.0062 34897.1793  35.5%     -   56s
     0     0 34875.4269    0  523 25761.0062 34875.4269  35.4%     -   57s
     0     0 34866.5972    0  562 25761.0062 34866.5972  35.3%     -   58s
     0     0 34863.9863    0  567 25761.0062 34863.9863  35.3%     -   58s
     0     0 34862.6873    0  513 25761.0062 34862.6873  35.3%     -   58s
     0     0 34854.9869    0  513 25761.0062 34854.9869  35.3%     -   59s
H    0     0                    25789.088782 34854.9645  35.2%     -   59s
     0     0 34847.6099    0  571 25789.0888 34847.6099  35.1%     -   59s
     0     0 34842.6702    0  525 25789.0888 34842.6702  35.1%     -   60s
     0     0 34842.4148    0  526 25789.0888 34842.4148  35.1%     -   60s
     0     0 34834.7482    0  518 25789.0888 34834.7482  35.1%     -   60s
H    0     0                    25791.860210 34834.5796  35.1%     -   61s
     0     0 34831.5830    0  516 25791.8602 34831.5830  35.0%     -   61s
     0     0 34830.7266    0  575 25791.8602 34830.7266  35.0%     -   61s
     0     0 34823.1400    0  587 25791.8602 34823.1400  35.0%     -   62s
     0     0 34821.5288    0  584 25791.8602 34821.5288  35.0%     -   62s
     0     0 34819.2524    0  585 25791.8602 34819.2524  35.0%     -   63s
     0     0 34816.9554    0  528 25791.8602 34816.9554  35.0%     -   63s
     0     0 34815.5210    0  585 25791.8602 34815.5210  35.0%     -   63s
     0     0 34812.5777    0  529 25791.8602 34812.5777  35.0%     -   64s
     0     0 34812.5450    0  529 25791.8602 34812.5450  35.0%     -   65s
H    0     0                    25812.068346 34812.5425  34.9%     -   82s
     0     2 34812.5425    0  529 25812.0683 34812.5425  34.9%     -   83s
     1     4 34288.1328    1  560 25812.0683 34812.5425  34.9%  2388   85s
     7    16 34102.7379    3  494 25812.0683 34249.3313  32.7%  1948   91s
    15    32 33723.5597    4  445 25812.0683 34102.6232  32.1%  3414   95s
    31    64 33203.0102    5  549 25812.0683 33907.6146  31.4%  4691  100s
    63    84 31181.8803    6  385 25812.0683 33477.5164  29.7%  4443  107s
H   66    84                    25824.291184 33477.5164  29.6%  4414  107s
    83   199 30326.5350    7  299 25824.2912 33477.5164  29.6%  5172  111s
H  210   265                    25870.421416 33477.5164  29.4%  3073  114s
H  230   265                    25911.250969 33477.5164  29.2%  2981  114s
H  250   265                    25918.692529 33477.5164  29.2%  2958  114s
   270   335 29878.2850   10  281 25918.6925 33477.5164  29.2%  2881  119s
   344   365 29695.3586   10  277 25918.6925 33477.5164  29.2%  2602  124s
H  374   365                    25930.759240 33477.5164  29.1%  2531  124s
   382   401 29723.7295   11  282 25930.7592 33477.5164  29.1%  2527  127s
   424   432 28934.1500   11  268 25930.7592 33477.5164  29.1%  2444  133s
   461   475 29380.5226   11  276 25930.7592 33476.7038  29.1%  2430  137s
   506   523 29508.7084   12  382 25930.7592 33476.7038  29.1%  2358  140s
   572   571 29401.0638   11  288 25930.7592 33476.7038  29.1%  2254  146s
   650   617 29140.7611   13  385 25930.7592 33242.4303  28.2%  2197  152s
   710   671 28800.5651   13  392 25930.7592 33242.4303  28.2%  2230  157s
   786   724 28809.7818   12  265 25930.7592 33242.4303  28.2%  2183  161s
   917   806 28711.3292   15  367 25930.7592 33242.4303  28.2%  2158  168s
   986   834 28157.4647   14  374 25930.7592 33175.0097  27.9%  2178  174s
  1048   871 28229.9217   15  359 25930.7592 33175.0097  27.9%  2218  180s
  1111   902 27974.5228   16  361 25930.7592 33028.4618  27.4%  2227  185s
  1270   980     cutoff   17      25930.7592 33028.4618  27.4%  2227  194s
  1362  1042 27852.7716   17  319 25930.7592 32830.1579  26.6%  2216  200s
  1469  1098 26800.9533   19  249 25930.7592 32829.6451  26.6%  2202  205s
  1666  1223 26822.3483   21  239 25930.7592 32482.4617  25.3%  2157  213s
  1754  1299 26965.0448   25  286 25930.7592 32330.9901  24.7%  2150  220s
  1922  1404     cutoff   30      25930.7592 32330.8702  24.7%  2125  228s
  2015  1491 28253.6627   10  357 25930.7592 32330.8702  24.7%  2104  232s
  2150  1541 27648.7536   11  456 25930.7592 32267.8949  24.4%  2042  240s
  2262  1608     cutoff   13      25930.7592 32114.0117  23.8%  2017  245s
  2393  1694 26750.9517   15  367 25930.7592 32114.0117  23.8%  2011  250s
  2523  1760     cutoff   18      25930.7592 32114.0117  23.8%  2012  258s
  2671  1829 27618.0594   13  508 25930.7592 31970.2271  23.3%  2022  265s
  2816  1856 27517.6328   14  493 25930.7592 31970.2271  23.3%  2029  271s
  2851  1898     cutoff   14      25930.7592 31896.0654  23.0%  2041  276s
  2909  1943 26977.0467   16  499 25930.7592 31896.0654  23.0%  2047  281s
  2984  2009 26851.3396   17  536 25930.7592 31896.0654  23.0%  2049  286s
  3102  2091 26480.3119   18  538 25930.7592 31896.0654  23.0%  2042  292s
  3256  2179 26460.6013   19  534 25930.7592 31896.0654  23.0%  2039  299s
  3448  2268     cutoff   19      25930.7592 31896.0654  23.0%  2035  306s
  3611  2380     cutoff   20      25930.7592 31708.9211  22.3%  2051  312s
  3791  2497 30194.2588   12  511 25930.7592 31708.9211  22.3%  2047  321s
  4011  2570 29484.8581   16  451 25930.7592 31708.9211  22.3%  2045  328s
  4190  2678 27439.6701   22  390 25930.7592 31566.7830  21.7%  2057  334s
  4409  2679 29733.1118   24  529 25930.7592 31352.4698  20.9%  2054  353s
  4411  2680 30650.8185   13  174 25930.7592 31352.4698  20.9%  2053  362s
  4412  2681 28557.3999   19  358 25930.7592 31352.4698  20.9%  2052  369s
  4413  2682 28303.9414   17  436 25930.7592 31352.4698  20.9%  2052  374s
  4414  2682 27695.0174   16  421 25930.7592 31352.4698  20.9%  2051  377s
  4416  2684 28476.8360   10  513 25930.7592 31352.4698  20.9%  2050  381s
  4418  2685 28172.2039   16  453 25930.7592 31352.4698  20.9%  2049  386s
  4421  2687 27295.5545   25  552 25930.7592 31352.4698  20.9%  2048  390s
  4425  2690 30959.9062    6  460 25930.7592 31352.4698  20.9%  2046  396s
  4429  2692 28339.6860   34  463 25930.7592 31352.4698  20.9%  2044  401s
  4433  2695 26427.4266   25  542 25930.7592 31352.4698  20.9%  2043  407s
  4435  2696 30080.7635   19  534 25930.7592 31352.4698  20.9%  2042  412s
  4437  2698 28883.1840   14  540 25930.7592 31352.4698  20.9%  2041  416s
  4440  2700 29647.5449   16  531 25930.7592 31352.4698  20.9%  2039  420s
  4441  2700 27453.1090   28  531 25930.7592 31352.4698  20.9%  2039  430s
  4442  2701 27242.3370   32  531 25930.7592 31352.4698  20.9%  2038  437s
  4443  2705 31352.4698   14  535 25930.7592 31352.4698  20.9%  2060  445s
  4445  2708 31352.4698   15  474 25930.7592 31352.4698  20.9%  2060  450s
  4449  2715 31352.4698   16  469 25930.7592 31352.4698  20.9%  2063  457s
  4457  2728 31352.4698   17  529 25930.7592 31352.4698  20.9%  2064  463s
  4473  2755 31352.4698   18  461 25930.7592 31352.4698  20.9%  2082  472s
  4505  2771 31352.4698   19  550 25930.7592 31352.4698  20.9%  2079  478s
  4537  2777 31000.8704   20  504 25930.7592 31352.4698  20.9%  2094  484s
  4580  2803 29901.4302   21  493 25930.7592 31352.4698  20.9%  2107  491s
  4653  2816 30571.0620   21  510 25930.7592 31352.4698  20.9%  2116  495s
  4730  2813 29662.3644   22  472 25930.7592 31352.4698  20.9%  2118  500s
  4777  2817 29337.2819   22  500 25930.7592 31352.4698  20.9%  2122  506s
  4835  2814 29564.7530   23  462 25930.7592 31260.1248  20.6%  2128  511s
  4903  2807 28175.0835   23  467 25930.7592 31260.1248  20.6%  2127  516s
  4965  2817 29547.3895   24  468 25930.7592 31188.8213  20.3%  2131  521s
  5031  2801 28808.6441   25  461 25930.7592 31188.8213  20.3%  2126  529s
  5100  2786 26386.7807   25  391 25930.7592 31188.8213  20.3%  2129  535s
  5167  2773 26940.7429   26  470 25930.7592 31146.5154  20.1%  2139  542s
  5217  2778     cutoff   26      25930.7592 30560.4636  17.9%  2159  548s
  5286  2770 26646.8970   29  469 25930.7592 30446.5490  17.4%  2161  554s
  5350  2768 26508.5755   29  490 25930.7592 30446.5490  17.4%  2158  560s
  5425  2746     cutoff   30      25930.7592 30437.2031  17.4%  2159  568s
  5506  2715     cutoff   32      25930.7592 30437.2031  17.4%  2162  575s
  5569  2700     cutoff   23      25930.7592 30437.2031  17.4%  2162  582s
  5634  2687     cutoff   27      25930.7592 29900.5554  15.3%  2172  587s
  5717  2670 27874.3303   22  484 25930.7592 29900.5554  15.3%  2168  594s
  5807  2634 26631.6207   24  452 25930.7592 29900.5554  15.3%  2167  601s
  5918  2592 26006.0094   26  418 25930.7592 29337.6778  13.1%  2169  609s
  6038  2555     cutoff   24      25930.7592 29332.5088  13.1%  2169  614s
  6116  2523 26977.5452   21  243 25930.7592 29332.5088  13.1%  2169  622s
  6238  2485 26711.6463   22  109 25930.7592 29332.5088  13.1%  2170  629s
  6381  2422 26952.1813   21  414 25930.7592 28637.9277  10.4%  2165  634s
  6536  2351     cutoff   24      25930.7592 28351.3434  9.33%  2153  643s
  6618  2329     cutoff   32      25930.7592 28247.1016  8.93%  2150  649s
  6718  2264 infeasible   28      25930.7592 28089.3738  8.32%  2149  656s
  6885  2177     cutoff   24      25930.7592 28089.3738  8.32%  2134  663s
  7087  1997     cutoff   29      25930.7592 28021.4661  8.06%  2114  669s
  7336  1814     cutoff   25      25930.7592 27424.6044  5.76%  2079  675s
  7531  1675 26174.9153   24  510 25930.7592 27424.6044  5.76%  2052  680s

Cutting planes:
  Learned: 1
  MIR: 310
  Flow cover: 841
  RLT: 13
  Relax-and-lift: 113

Explored 7644 nodes (15639219 simplex iterations) in 681.40 seconds (1931.07 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 25930.8 25930.8 25918.7 ... 25761

Optimal solution found (tolerance 1.00e-06)
Best objective 2.593075923984e+04, best bound 2.593075923984e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 681.42s
  Master Objective (UB) = 25930.76, θ = 152699.16
  Upper Bound (UB) = 25930.76

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 152699.16
  [DEBUG]   ✓ Scenario 0: θ = 152699.16 ≤ Q = 152699.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 152699.16 ≤ Q = 152699.16 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 152699.16 ≤ Q = 152699.16 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 152699.16 ≤ Q = 152699.16 (slack: 0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 4] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x52e421c8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x52e421c8
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.462017e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 7716652.1213
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.412248e+05, 259 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -141224.80    0  130 7716652.12 -141224.80   102%     -    0s
H    0     0                    -106012.0483 -141224.80  33.2%     -    0s
H    0     0                    -106261.2469 -141224.80  32.9%     -    0s
H    0     0                    -112084.4718 -141224.80  26.0%     -    0s
H    0     0                    -112166.4480 -124999.75  11.4%     -    0s
     0     0 -124999.75    0  127 -112166.45 -124999.75  11.4%     -    0s
H    0     0                    -119634.1555 -124912.45  4.41%     -    0s
     0     0 -124455.85    0  128 -119634.16 -124455.85  4.03%     -    0s
     0     0 -123787.86    0  130 -119634.16 -123787.86  3.47%     -    0s
     0     0 -123638.98    0  130 -119634.16 -123638.98  3.35%     -    0s
     0     0 -123638.98    0  130 -119634.16 -123638.98  3.35%     -    0s
H    0     0                    -120594.9410 -123638.98  2.52%     -    0s
H    0     0                    -120888.8790 -123638.98  2.27%     -    0s
     0     0 -123428.09    0  133 -120888.88 -123428.09  2.10%     -    0s
     0     0 -123391.11    0  132 -120888.88 -123391.11  2.07%     -    0s
     0     0 -123390.24    0  132 -120888.88 -123390.24  2.07%     -    0s
     0     0 -122746.26    0  127 -120888.88 -122746.26  1.54%     -    0s
     0     0 -122730.88    0  127 -120888.88 -122730.88  1.52%     -    0s
     0     0 -122729.78    0  127 -120888.88 -122729.78  1.52%     -    0s
     0     0 -122177.81    0  115 -120888.88 -122177.81  1.07%     -    0s
     0     0 -122138.00    0  123 -120888.88 -122138.00  1.03%     -    0s
     0     0 -122138.00    0  123 -120888.88 -122138.00  1.03%     -    0s
     0     0 -121898.08    0  105 -120888.88 -121898.08  0.83%     -    0s
     0     0 -121797.55    0  109 -120888.88 -121797.55  0.75%     -    0s
     0     0 -121796.22    0  110 -120888.88 -121796.22  0.75%     -    0s
     0     0 -121692.65    0   96 -120888.88 -121692.65  0.66%     -    0s
     0     0 -121675.11    0   97 -120888.88 -121675.11  0.65%     -    0s
     0     0 -121629.18    0   97 -120888.88 -121629.18  0.61%     -    0s
     0     0 -121628.88    0   97 -120888.88 -121628.88  0.61%     -    0s
     0     2 -121604.19    0   97 -120888.88 -121604.19  0.59%     -    0s
H  483   307                    -120894.7389 -121325.14  0.36%   6.5    0s

Cutting planes:
  Gomory: 32
  Implied bound: 10
  MIR: 238
  Flow cover: 10
  RLT: 49
  BQP: 3

Explored 6264 nodes (30912 simplex iterations) in 0.24 seconds (0.27 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -120895 -120889 -119634 ... 1.46202e+13
No other solutions better than -120895

Optimal solution found (tolerance 1.00e-06)
Best objective -1.208947389497e+05, best bound -1.208947389497e+05, gap 0.0000%
  Subproblem solved in 0.25s
  Worst-case operational profit (Z_SP) = 139533.70
  Scenario: 60 demand increases, 0 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -120894.74
  [DEBUG]   S×d_nominal = 260428.44
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260428.44 + -120894.74 = 139533.70
  [DEBUG]   Current θ from Master = 152699.16
  [DEBUG]   ⚠️  Z_SP ≤ θ by 13165.46 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 12765.30
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 7404.7218, Absolute Gap = 7404.7218, Relative Gap = 0.285557
  Not converged yet (gap = 7404.72 > ε = 200)

  [DEBUG] Adding NEW scenario 4 to Master Problem...
  [DEBUG] New scenario pattern: 60 increases, 0 decreases
    [DEBUG] Scenario 4 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 4 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 4]
    [DEBUG]   - Total constraints in model: 77833
    [DEBUG]   - Total variables in model: 33460
  [DEBUG] Total scenarios in Master: 5
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 5
================================================================================
[Iteration 5] Solving Master Problem...
  Current scenarios in Master: 5
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 77833 rows, 33460 columns and 221749 nonzeros
Model fingerprint: 0xb93f1f36
Variable types: 31201 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 32845 rows and 13335 columns
Presolve time: 0.71s
Presolved: 44988 rows, 20125 columns, 278884 nonzeros
Variable types: 17866 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 44988 rows, 20125 columns, 278884 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   31711    2.4017664e+04   0.000000e+00   1.104804e+07      5s
   45507    4.0450298e+04   0.000000e+00   1.330532e+08     10s
Concurrent spin time: 0.01s

Solved with dual simplex

Root relaxation: objective 4.598770e+04, 35003 iterations, 13.49 seconds (28.07 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45987.7034    0  165 -194556.81 45987.7034   124%     -   14s
H    0     0                    -176098.9492 45987.7034   126%     -   14s
H    0     0                    -128575.4059 45987.7034   136%     -   14s
H    0     0                    -123177.3314 45987.7034   137%     -   14s
H    0     0                    -117375.1991 45987.7034   139%     -   14s
H    0     0                    -116983.7802 45987.7034   139%     -   14s
H    0     0                    -41472.66129 45987.7034   211%     -   14s
H    0     0                    -41263.51107 45987.7034   211%     -   14s
H    0     0                    -8445.962353 45987.7034   644%     -   14s
H    0     0                    -1864.608299 45987.7034  2566%     -   14s
H    0     0                    4013.1215513 45987.7034  1046%     -   15s
H    0     0                    4261.6333738 45987.7034   979%     -   15s
H    0     0                    4404.2932030 45987.7034   944%     -   15s
H    0     0                    5780.6269133 45987.7034   696%     -   15s
H    0     0                    7149.9312184 45987.7034   543%     -   15s
     0     0 41560.4511    0  209 7149.93122 41560.4511   481%     -   19s
H    0     0                    11247.847114 41560.4511   269%     -   19s
H    0     0                    11783.070494 41560.4511   253%     -   19s
H    0     0                    11949.186066 41560.4511   248%     -   19s
     0     0 41399.6095    0  222 11949.1861 41399.6095   246%     -   21s
     0     0 41399.6095    0  231 11949.1861 41399.6095   246%     -   22s
     0     0 41399.6095    0  228 11949.1861 41399.6095   246%     -   22s
     0     0 41399.6095    0  228 11949.1861 41399.6095   246%     -   22s
     0     0 38079.3218    0  343 11949.1861 38079.3218   219%     -   29s
     0     0 37815.7241    0  349 11949.1861 37815.7241   216%     -   31s
     0     0 37537.6668    0  370 11949.1861 37537.6668   214%     -   32s
     0     0 37490.3802    0  371 11949.1861 37490.3802   214%     -   33s
     0     0 37487.0009    0  371 11949.1861 37487.0009   214%     -   33s
     0     0 37486.9905    0  371 11949.1861 37486.9905   214%     -   33s
     0     0 35993.7898    0  424 11949.1861 35993.7898   201%     -   42s
H    0     0                    12014.150931 35993.7746   200%     -   42s
     0     0 35376.6729    0  393 12014.1509 35376.6729   194%     -   45s
     0     0 35040.0784    0  393 12014.1509 35040.0784   192%     -   47s
     0     0 34924.4835    0  399 12014.1509 34924.4835   191%     -   49s
     0     0 34880.8967    0  404 12014.1509 34880.8967   190%     -   49s
     0     0 34857.2426    0  354 12014.1509 34857.2426   190%     -   50s
     0     0 34830.6106    0  405 12014.1509 34830.6106   190%     -   51s
     0     0 34819.3859    0  405 12014.1509 34819.3859   190%     -   51s
     0     0 34810.8211    0  414 12014.1509 34810.8211   190%     -   51s
     0     0 34808.2137    0  414 12014.1509 34808.2137   190%     -   51s
     0     0 34805.9959    0  415 12014.1509 34805.9959   190%     -   52s
     0     0 34805.8883    0  414 12014.1509 34805.8883   190%     -   52s
     0     0 33820.3842    0  492 12014.1509 33820.3842   182%     -   56s
     0     0 33602.8969    0  438 12014.1509 33602.8969   180%     -   58s
     0     0 33512.3891    0  437 12014.1509 33512.3891   179%     -   59s
     0     0 33443.5091    0  443 12014.1509 33443.5091   178%     -   59s
     0     0 33407.5444    0  391 12014.1509 33407.5444   178%     -   60s
H    0     0                    12318.342369 33388.9636   171%     -   60s
     0     0 33388.9636    0  450 12318.3424 33388.9636   171%     -   60s
     0     0 33381.7219    0  467 12318.3424 33381.7219   171%     -   61s
     0     0 33340.8155    0  456 12318.3424 33340.8155   171%     -   62s
     0     0 33330.3331    0  454 12318.3424 33330.3331   171%     -   62s
     0     0 33326.6328    0  457 12318.3424 33326.6328   171%     -   62s
     0     0 33324.4872    0  456 12318.3424 33324.4872   171%     -   63s
     0     0 33319.6671    0  452 12318.3424 33319.6671   170%     -   63s
     0     0 33305.7637    0  449 12318.3424 33305.7637   170%     -   63s
     0     0 33299.5162    0  448 12318.3424 33299.5162   170%     -   64s
     0     0 33290.5162    0  452 12318.3424 33290.5162   170%     -   64s
     0     0 33290.2798    0  453 12318.3424 33290.2798   170%     -   64s
     0     0 33132.0040    0  447 12318.3424 33132.0040   169%     -   66s
H    0     0                    12621.045561 33131.2914   163%     -   66s
     0     0 33072.5065    0  460 12621.0456 33072.5065   162%     -   67s
     0     0 33067.0510    0  454 12621.0456 33067.0510   162%     -   67s
     0     0 33061.8316    0  463 12621.0456 33061.8316   162%     -   68s
     0     0 33061.5429    0  458 12621.0456 33061.5429   162%     -   68s
     0     0 32971.6619    0  388 12621.0456 32971.6619   161%     -   70s
H    0     0                    12647.772759 32970.4919   161%     -   71s
H    0     0                    13204.851760 32896.8572   149%     -   72s
H    0     0                    13441.950411 32896.8572   145%     -   72s
     0     0 32896.8572    0  457 13441.9504 32896.8572   145%     -   72s
     0     0 32890.4892    0  512 13441.9504 32890.4892   145%     -   72s
     0     0 32888.9162    0  506 13441.9504 32888.9162   145%     -   73s
     0     0 32856.0060    0  460 13441.9504 32856.0060   144%     -   74s
H    0     0                    14839.918669 32855.0910   121%     -   74s
     0     0 32836.4448    0  455 14839.9187 32836.4448   121%     -   75s
     0     0 32827.4470    0  450 14839.9187 32827.4470   121%     -   75s
     0     0 32823.0007    0  453 14839.9187 32823.0007   121%     -   75s
     0     0 32820.0901    0  456 14839.9187 32820.0901   121%     -   76s
     0     0 32819.0438    0  450 14839.9187 32819.0438   121%     -   76s
     0     0 32788.2414    0  503 14839.9187 32788.2414   121%     -   77s
H    0     0                    14904.477619 32787.6047   120%     -   79s
H    0     0                    14944.384511 32787.6047   119%     -   79s
     0     0 32762.5895    0  515 14944.3845 32762.5895   119%     -   80s
     0     0 32755.0381    0  506 14944.3845 32755.0381   119%     -   80s
     0     0 32751.7831    0  510 14944.3845 32751.7831   119%     -   80s
     0     0 32750.8323    0  510 14944.3845 32750.8323   119%     -   80s
     0     0 32707.7517    0  554 14944.3845 32707.7517   119%     -   82s
     0     0 32687.9688    0  563 14944.3845 32687.9688   119%     -   83s
     0     0 32686.8398    0  512 14944.3845 32686.8398   119%     -   83s
     0     0 32670.4329    0  511 14944.3845 32670.4329   119%     -   84s
     0     0 32664.4173    0  521 14944.3845 32664.4173   119%     -   84s
     0     0 32663.0366    0  624 14944.3845 32663.0366   119%     -   85s
     0     0 32653.8866    0  527 14944.3845 32653.8866   119%     -   86s
     0     0 32646.8107    0  530 14944.3845 32646.8107   118%     -   86s
     0     0 32643.3635    0  522 14944.3845 32643.3635   118%     -   86s
     0     0 32641.4260    0  531 14944.3845 32641.4260   118%     -   87s
     0     0 32640.9491    0  528 14944.3845 32640.9491   118%     -   87s
     0     0 32632.6835    0  523 14944.3845 32632.6835   118%     -   87s
     0     0 32630.5114    0  531 14944.3845 32630.5114   118%     -   88s
     0     0 32629.9095    0  530 14944.3845 32629.9095   118%     -   88s
H    0     0                    18928.055345 32629.9095  72.4%     -   88s
H    0     0                    19080.520796 32629.9095  71.0%     -   88s
     0     0 32625.6548    0  521 19080.5208 32625.6548  71.0%     -   88s
H    0     0                    19194.754758 32625.4455  70.0%     -   89s
     0     0 32624.6298    0  530 19194.7548 32624.6298  70.0%     -   89s
     0     0 32617.6131    0  458 19194.7548 32617.6131  69.9%     -   90s
     0     0 32615.9652    0  518 19194.7548 32615.9652  69.9%     -   90s
     0     0 32615.1561    0  517 19194.7548 32615.1561  69.9%     -   91s
H    0     0                    19263.372605 32615.1354  69.3%     -   91s
H    0     0                    19292.797876 32615.1354  69.1%     -   91s
H    0     0                    19309.617081 32615.1354  68.9%     -   91s
H    0     0                    19385.148600 32615.1354  68.2%     -   91s
     0     0 32613.7634    0  469 19385.1486 32613.7634  68.2%     -   91s
     0     0 32612.1230    0  469 19385.1486 32612.1230  68.2%     -   92s
     0     0 32611.8789    0  469 19385.1486 32611.8789  68.2%     -   93s
H    0     0                    19703.422052 32611.6462  65.5%     -  106s
H    0     0                    20106.557000 32611.6462  62.2%     -  106s
H    0     0                    20135.956740 32611.6462  62.0%     -  106s
H    0     0                    20142.142407 32611.6462  61.9%     -  106s
     0     2 32611.6462    0  469 20142.1424 32611.6462  61.9%     -  106s
     1     4 32238.1799    1  452 20142.1424 32610.9860  61.9%  4668  110s
     7    16 32071.8905    3  456 20142.1424 32113.4954  59.4%  4130  117s
    15    32 31546.1395    4  471 20142.1424 32070.8641  59.2%  3482  122s
    31    52 29271.8387    5  383 20142.1424 31545.8801  56.6%  8469  130s
    53    84 26994.0895    6  312 20142.1424 31545.2773  56.6%  7051  136s
H   68    84                    20245.170866 31545.2773  55.8%  6561  136s
    85   183 26920.1032    7  293 20245.1709 31545.2773  55.8%  5918  146s
H  119   183                    20374.768244 31545.2773  54.8%  4650  146s
   204   280 26248.6784    8  285 20374.7682 31545.2773  54.8%  3223  153s
   313   353 26422.4388    9  295 20374.7682 31545.2773  54.8%  2632  158s
H  321   353                    20375.150252 31545.2773  54.8%  2611  158s
H  339   353                    20421.385971 31545.2773  54.5%  2600  158s
   394   421 25407.6195   12  266 20421.3860 31545.2773  54.5%  2481  162s
   474   450 25263.2551   13  292 20421.3860 31545.2773  54.5%  2363  165s
H  541   478                    20494.806391 31545.2773  53.9%  2325  169s
   546   550 25276.1923   14  348 20494.8064 31545.2773  53.9%  2324  175s
   636   621 25214.5593   15  294 20494.8064 31545.2773  53.9%  2181  180s
   717   648 25162.7350   16  295 20494.8064 31359.1778  53.0%  2130  185s
H  745   648                    20544.191489 31357.5936  52.6%  2144  185s
   750   696 25188.2072   16  286 20544.1915 31357.5936  52.6%  2145  190s
H  870   720                    20557.349086 31357.5936  52.5%  2069  194s
   876   764     cutoff   16      20557.3491 31357.5936  52.5%  2085  200s
   968   830 23902.3637   18  327 20557.3491 31357.5936  52.5%  2042  206s
  1064   858     cutoff   18      20557.3491 31357.5936  52.5%  1989  211s
H 1075   858                    20592.023634 31357.5936  52.3%  1990  211s
H 1090   858                    20592.601730 30506.5038  48.1%  1989  211s
H 1093   858                    20622.207937 30506.5038  47.9%  1988  211s
  1098   944 23737.4373   18  284 20622.2079 30506.5038  47.9%  1987  216s
  1208  1030 23634.5592   19  323 20622.2079 30506.5038  47.9%  1918  221s
  1340  1100 23092.7284   23  293 20622.2079 30009.1807  45.5%  1844  227s
  1453  1172 22230.5686   23  313 20622.2079 30009.1807  45.5%  1818  234s
  1566  1258 22643.7293   24  248 20622.2079 29928.2096  45.1%  1786  241s
  1695  1281 22584.3310   25  251 20622.2079 29915.2394  45.1%  1742  245s
H 1697  1281                    20665.377384 29915.2394  44.8%  1740  245s
  1740  1333     cutoff   26      20665.3774 29915.2394  44.8%  1755  251s
  1878  1363 21693.4240   25  288 20665.3774 29890.5168  44.6%  1726  259s
  1972  1434 27929.7188    6  420 20665.3774 29859.1116  44.5%  1747  266s
  2075  1511 26687.8203    8  364 20665.3774 29859.1116  44.5%  1759  273s
  2220  1560 22907.4864   10  271 20665.3774 29746.2775  43.9%  1746  278s
H 2238  1560                    20687.935241 29746.2775  43.8%  1747  278s
  2321  1647 22370.7143   11  226 20687.9352 29462.7317  42.4%  1724  285s
  2466  1759 infeasible   13      20687.9352 29176.1814  41.0%  1716  290s
H 2616  1771                    20721.987467 29118.2243  40.5%  1707  299s
H 2617  1771                    20741.318182 29118.2243  40.4%  1707  299s
H 2618  1768                    20782.239890 29118.2243  40.1%  1707  299s
H 2631  1767                    20784.905369 29118.2243  40.1%  1711  299s
H 2634  1765                    20803.178052 29118.2243  40.0%  1712  299s
  2666  1876 25431.0042   13  313 20803.1781 29118.2243  40.0%  1711  306s
  2866  1981 22281.1680   20  276 20803.1781 29011.6801  39.5%  1679  313s
  3087  2034 22009.9322   24  339 20803.1781 28958.3458  39.2%  1643  319s
H 3121  2033                    20811.895128 28958.3458  39.1%  1642  319s
  3182  2143 21214.8826   27  267 20811.8951 28958.3458  39.1%  1631  327s
  3345  2247 21302.5550   28  273 20811.8951 28813.8601  38.4%  1631  334s
  3528  2373 26039.3747   10  361 20811.8951 28813.8601  38.4%  1630  342s
  3753  2445 25578.9248   13  410 20811.8951 28813.8601  38.4%  1613  351s
  3916  2494 23983.7182   18  191 20811.8951 28712.6435  38.0%  1627  357s
H 3936  2491                    20851.853435 28712.6435  37.7%  1622  357s
  4015  2614 23043.5445   34  223 20851.8534 28446.5258  36.4%  1633  365s
  4227  2615 22571.9524   29  469 20851.8534 28446.5258  36.4%  1627  391s
  4229  2616 25065.8441   31  165 20851.8534 28446.5258  36.4%  1626  399s
  4230  2617 25495.9860   24  335 20851.8534 28446.5258  36.4%  1625  409s
  4231  2618 25324.2779   14  422 20851.8534 28446.5258  36.4%  1625  418s
  4232  2618 22429.7630   36  409 20851.8534 28446.5258  36.4%  1625  424s
  4233  2619 23054.1549   16  425 20851.8534 28446.5258  36.4%  1624  427s
  4235  2620 21305.2250   13  541 20851.8534 28446.5258  36.4%  1624  432s
  4237  2622 25927.5538   15  520 20851.8534 28446.5258  36.4%  1623  436s
  4240  2624 26420.2864   10  543 20851.8534 28446.5258  36.4%  1622  442s
  4243  2626 21665.2435   26  464 20851.8534 28446.5258  36.4%  1620  447s
  4245  2627 27969.0965    9  460 20851.8534 28446.5258  36.4%  1620  451s
  4248  2629 27649.6805    9  573 20851.8534 28446.5258  36.4%  1619  456s
  4250  2630 23866.0140   19  475 20851.8534 28446.5258  36.4%  1618  461s
  4253  2632 23831.4530   16  569 20851.8534 28446.5258  36.4%  1617  466s
  4255  2634 24085.7849   19  587 20851.8534 28446.5258  36.4%  1616  471s
  4256  2634 26810.1184   19  587 20851.8534 28446.5258  36.4%  1616  480s
  4257  2635 21500.0096   26  587 20851.8534 28446.5258  36.4%  1615  489s
  4258  2639 28446.5258   11  567 20851.8534 28446.5258  36.4%  1646  497s
  4260  2642 28446.5258   12  562 20851.8534 28446.5258  36.4%  1648  504s
  4264  2649 28446.5258   13  459 20851.8534 28446.5258  36.4%  1650  508s
  4272  2662 28446.5258   14  447 20851.8534 28446.5258  36.4%  1658  515s
  4288  2674 22256.4028   15  286 20851.8534 28446.5258  36.4%  1672  526s
  4305  2698 28446.5258   16  367 20851.8534 28446.5258  36.4%  1713  533s
  4337  2758 27172.2395   17  349 20851.8534 28446.5258  36.4%  1742  542s
  4420  2796 26891.5869   19  322 20851.8534 28446.5258  36.4%  1777  548s
  4499  2814 24802.3491   18  336 20851.8534 28446.5258  36.4%  1804  553s
  4572  2838 25019.1936   20  315 20851.8534 28446.5258  36.4%  1828  562s
H 4623  2688                    20852.769373 28446.5258  36.4%  1829  562s
  4651  2716 25556.0176   20  324 20852.7694 28446.5258  36.4%  1833  569s
  4746  2698 25358.8240   20  275 20852.7694 28446.5258  36.4%  1837  576s
  4833  2689 24475.5828   21  233 20852.7694 28446.5258  36.4%  1842  584s
H 4834  2564                    20896.666895 28446.5258  36.1%  1841  584s
H 4878  2429                    20904.305670 28446.5258  36.1%  1842  584s
  4907  2425 24821.0456   21  329 20904.3057 28446.5258  36.1%  1843  590s
  4950  2427 23901.8025   22  416 20904.3057 28446.5258  36.1%  1851  597s
  4993  2431 23872.7791   23  417 20904.3057 28446.5258  36.1%  1864  602s
  5031  2433 23844.0962   24  389 20904.3057 28446.5258  36.1%  1872  608s
  5073  2442 23800.7525   25  372 20904.3057 28446.5258  36.1%  1879  615s
H 5090  2323                    20924.812769 28446.5258  35.9%  1877  615s
  5121  2327 22986.7931   26  417 20924.8128 28446.5258  35.9%  1880  622s
  5161  2327 21125.7762   25  206 20924.8128 28446.5258  35.9%  1887  628s
  5208  2325     cutoff   26      20924.8128 28446.5258  35.9%  1897  634s
  5272  2330 22897.5462   28  398 20924.8128 28446.5258  35.9%  1914  641s
  5330  2325 infeasible   30      20924.8128 28446.5258  35.9%  1926  649s
  5413  2322 21193.3667   32  354 20924.8128 28446.5258  35.9%  1944  657s
  5487  2325 27611.8746   17  418 20924.8128 28446.5258  35.9%  1960  662s
  5536  2329 27132.3978   18  357 20924.8128 28446.5258  35.9%  1980  670s
  5603  2332 27056.4746   19  399 20924.8128 28446.5258  35.9%  1986  678s
H 5614  2221                    21117.195494 28446.5258  34.7%  1990  678s
  5688  2244 25669.8264   21  375 21117.1955 28446.5258  34.7%  2008  685s
  5783  2240 24697.5350   23  415 21117.1955 28446.5258  34.7%  2030  693s
  5883  2247     cutoff   25      21117.1955 28446.5258  34.7%  2052  701s
  5997  2234     cutoff   28      21117.1955 28446.5258  34.7%  2073  710s
  6145  2239 25579.1816   20  310 21117.1955 28446.5258  34.7%  2086  717s
  6297  2220 22951.2493   23  278 21117.1955 28446.5258  34.7%  2086  727s
  6433  2216     cutoff   24      21117.1955 28446.5258  34.7%  2097  735s
H 6435  2113                    21243.355929 28446.5258  33.9%  2096  735s
H 6451  2011                    21372.882571 28446.5258  33.1%  2102  735s
  6559  2015     cutoff   24      21372.8826 28446.5258  33.1%  2116  743s
H 6564  1920                    21378.082438 28446.5258  33.1%  2116  743s
H 6571  1831                    21425.366665 28446.5258  32.8%  2121  743s
  6689  1839     cutoff   25      21425.3667 28446.5258  32.8%  2125  752s
  6856  1817     cutoff   27      21425.3667 28446.5258  32.8%  2137  762s
H 6940  1705                    21446.230539 28310.2999  32.0%  2142  762s
  6984  1731 27779.6165   19  463 21446.2305 28310.0646  32.0%  2146  769s
  7101  1758 26650.5798   20  460 21446.2305 28310.0646  32.0%  2162  779s
  7268  1763 25737.3374   22  427 21446.2305 28310.0646  32.0%  2171  787s
  7480  1750 24333.8554   24  406 21446.2305 28310.0646  32.0%  2177  797s
H 7506  1662                    21451.430406 28310.0646  32.0%  2178  797s
  7625  1677 infeasible   30      21451.4304 27779.0026  29.5%  2193  808s
  7844  1627 24618.4614   21  311 21451.4304 27779.0026  29.5%  2211  818s
  8047  1609 22070.4157   24  120 21451.4304 27779.0026  29.5%  2220  829s
  8238  1563 22965.7187   26  365 21451.4304 27728.7724  29.3%  2239  840s
  8432  1530     cutoff   28      21451.4304 26911.6456  25.5%  2265  848s
  8541  1535 23667.7416   20  309 21451.4304 26911.6456  25.5%  2277  858s
  8665  1506 23181.1772   22  484 21451.4304 26306.3398  22.6%  2279  870s
  8848  1493 25622.2967   21  438 21451.4304 26306.3398  22.6%  2276  882s
  9008  1513 24127.4563   22  416 21451.4304 26306.3398  22.6%  2292  893s
  9190  1541 23849.8922   23  349 21451.4304 26306.3398  22.6%  2307  905s
  9468  1564 21680.3978   24  389 21451.4304 25567.1330  19.2%  2311  919s
  9744  1547     cutoff   25      21451.4304 25304.3974  18.0%  2325  934s
 10023  1554     cutoff   32      21451.4304 25109.6654  17.1%  2357  948s
 10343  1579 22984.6416   19  352 21451.4304 24914.8149  16.1%  2383  962s
 10702  1594     cutoff   25      21451.4304 24607.1060  14.7%  2397  977s
 11124  1572 22382.6619   22  236 21451.4304 24451.4124  14.0%  2399  994s
 11533  1558     cutoff   23      21451.4304 24344.8806  13.5%  2416 1009s
 12017  1464     cutoff   29      21451.4304 23951.2297  11.7%  2421 1026s
 12528  1325 23058.5483   22  264 21451.4304 23786.8975  10.9%  2417 1042s
 13182   959 22856.6371   36  287 21451.4304 23498.9793  9.55%  2390 1058s
 14357   153 22239.3412   27  333 21451.4304 23100.8693  7.69%  2274 1072s
 15971     0     cutoff   26      21451.4304 22579.3957  5.26%  2092 1076s

Cutting planes:
  Learned: 1
  MIR: 728
  Mixing: 2
  Flow cover: 1736
  Zero half: 1
  RLT: 18
  Relax-and-lift: 153

Explored 16188 nodes (33646660 simplex iterations) in 1076.31 seconds (3416.77 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21451.4 21446.2 21425.4 ... 20896.7

Optimal solution found (tolerance 1.00e-06)
Best objective 2.145143040603e+04, best bound 2.145143040603e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1076.34s
  Master Objective (UB) = 21451.43, θ = 151547.75
  Upper Bound (UB) = 21451.43

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151547.75
  [DEBUG]   ✓ Scenario 0: θ = 151547.75 ≤ Q = 151547.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151547.75 ≤ Q = 151547.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151547.75 ≤ Q = 151547.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151547.75 ≤ Q = 151547.75 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151547.75 ≤ Q = 151547.75 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 5] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x195b580
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x0195b580
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [2e-11, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e-13, 2e+02]
Found heuristic solution: objective 1.549478e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8242550.8241
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.424715e+05, 260 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -142471.48    0  136 8242550.82 -142471.48   102%     -    0s
H    0     0                    -104245.0579 -142471.48  36.7%     -    0s
H    0     0                    -104977.4313 -142471.48  35.7%     -    0s
H    0     0                    -106585.3221 -121612.01  14.1%     -    0s
H    0     0                    -115246.1422 -121612.01  5.52%     -    0s
H    0     0                    -120718.6524 -121612.01  0.74%     -    0s
     0     0 -121606.04    0   44 -120718.65 -121606.04  0.74%     -    0s
H    0     0                    -120997.7658 -121458.08  0.38%     -    0s
     0     0 -121458.08    0   42 -120997.77 -121458.08  0.38%     -    0s
     0     0 -121457.11    0   41 -120997.77 -121457.11  0.38%     -    0s
     0     0 -121083.85    0   16 -120997.77 -121083.85  0.07%     -    0s
     0     0 -121083.76    0   13 -120997.77 -121083.76  0.07%     -    0s
H    0     0                    -121026.3000 -121082.75  0.05%     -    0s
     0     0 -121054.93    0    7 -121026.30 -121054.93  0.02%     -    0s
H    0     0                    -121029.4816 -121054.93  0.02%     -    0s
     0     0     cutoff    0      -121029.48 -121029.48  0.00%     -    0s

Cutting planes:
  Gomory: 11
  Implied bound: 2
  MIR: 108
  Flow cover: 4
  RLT: 37
  Relax-and-lift: 3

Explored 1 nodes (515 simplex iterations) in 0.03 seconds (0.03 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -121029 -121026 -120998 ... 1.54948e+13
No other solutions better than -121029

Optimal solution found (tolerance 1.00e-06)
Best objective -1.210294815982e+05, best bound -1.210294815982e+05, gap 0.0000%
  Subproblem solved in 0.04s
  Worst-case operational profit (Z_SP) = 139702.43
  Scenario: 12 demand increases, 48 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -121029.48
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -121029.48 = 139702.43
  [DEBUG]   Current θ from Master = 151547.75
  [DEBUG]   ⚠️  Z_SP ≤ θ by 11845.32 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 9606.11
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 2925.3929, Absolute Gap = 2925.3929, Relative Gap = 0.136373
  Not converged yet (gap = 2925.39 > ε = 200)

  [DEBUG] Adding NEW scenario 5 to Master Problem...
  [DEBUG] New scenario pattern: 12 increases, 48 decreases
    [DEBUG] Scenario 5 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 5 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 5]
    [DEBUG]   - Total constraints in model: 93123
    [DEBUG]   - Total variables in model: 39700
  [DEBUG] Total scenarios in Master: 6
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 6
================================================================================
[Iteration 6] Solving Master Problem...
  Current scenarios in Master: 6
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 93123 rows, 39700 columns and 264995 nonzeros
Model fingerprint: 0xd0da5355
Variable types: 37441 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 39430 rows and 16010 columns
Presolve time: 0.94s
Presolved: 53693 rows, 23690 columns, 333509 nonzeros
Variable types: 21431 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 53693 rows, 23690 columns, 333509 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   34067   -1.5339569e+03   0.000000e+00   1.118982e+07      5s
   47085    3.1924898e+04   0.000000e+00   8.387617e+07     10s
   57824    3.6746271e+04   0.000000e+00   1.219099e+07     15s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.598770e+04, 41402 iterations, 17.94 seconds (37.54 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45987.7034    0  165 -194556.81 45987.7034   124%     -   19s
H    0     0                    -182159.7807 45987.7034   125%     -   19s
H    0     0                    -96190.58346 45987.7034   148%     -   19s
H    0     0                    -95999.57002 45987.7034   148%     -   19s
H    0     0                    -95220.34900 45987.7034   148%     -   19s
H    0     0                    -44477.01379 45987.7034   203%     -   19s
H    0     0                    -44267.86357 45987.7034   204%     -   19s
H    0     0                     242.1631973 45987.7034      -     -   19s
H    0     0                    1923.2628230 45987.7034  2291%     -   20s
H    0     0                    4325.3078429 45987.7034   963%     -   20s
H    0     0                    4404.2932030 45987.7034   944%     -   20s
H    0     0                    6188.6070502 45987.7034   643%     -   20s
H    0     0                    6707.3836506 45987.7034   586%     -   20s
H    0     0                    7050.8048380 45987.7034   552%     -   20s
H    0     0                    7058.9571260 45987.7034   551%     -   20s
H    0     0                    7149.9312184 45987.7034   543%     -   20s
     0     0 41129.5796    0  248 7149.93122 41129.5796   475%     -   26s
H    0     0                    10298.294081 41129.5796   299%     -   26s
H    0     0                    10651.770606 41129.5796   286%     -   26s
H    0     0                    10683.699983 41129.5796   285%     -   26s
H    0     0                    11237.162998 41129.5796   266%     -   26s
H    0     0                    11625.039712 41129.5796   254%     -   26s
H    0     0                    11645.234655 41129.5796   253%     -   26s
H    0     0                    11727.069554 41129.5796   251%     -   26s
H    0     0                    11949.186066 41129.5796   244%     -   26s
     0     0 41105.4966    0  290 11949.1861 41105.4966   244%     -   28s
     0     0 41105.4966    0  263 11949.1861 41105.4966   244%     -   29s
     0     0 41105.4966    0  262 11949.1861 41105.4966   244%     -   29s
     0     0 41105.4966    0  263 11949.1861 41105.4966   244%     -   29s
     0     0 41105.4966    0  257 11949.1861 41105.4966   244%     -   29s
     0     0 41105.4966    0  257 11949.1861 41105.4966   244%     -   29s
     0     0 38247.4222    0  344 11949.1861 38247.4222   220%     -   36s
     0     0 37639.7998    0  366 11949.1861 37639.7998   215%     -   39s
     0     0 37588.4489    0  352 11949.1861 37588.4489   215%     -   40s
     0     0 37456.7810    0  304 11949.1861 37456.7810   213%     -   41s
     0     0 37416.5592    0  305 11949.1861 37416.5592   213%     -   42s
     0     0 37414.1541    0  305 11949.1861 37414.1541   213%     -   42s
     0     0 37413.1127    0  305 11949.1861 37413.1127   213%     -   42s
     0     0 37413.0999    0  305 11949.1861 37413.0999   213%     -   42s
     0     0 36286.5131    0  358 11949.1861 36286.5131   204%     -   50s
     0     0 35690.9603    0  401 11949.1861 35690.9603   199%     -   55s
     0     0 35470.8740    0  375 11949.1861 35470.8740   197%     -   58s
H    0     0                    12495.295769 35258.8187   182%     -   60s
H    0     0                    12678.324511 35258.8187   178%     -   60s
H    0     0                    12706.645882 35258.8187   177%     -   60s
     0     0 35258.8187    0  382 12706.6459 35258.8187   177%     -   60s
     0     0 35198.6666    0  432 12706.6459 35198.6666   177%     -   61s
     0     0 35108.6230    0  442 12706.6459 35108.6230   176%     -   62s
     0     0 35100.8636    0  439 12706.6459 35100.8636   176%     -   63s
     0     0 35090.6057    0  441 12706.6459 35090.6057   176%     -   64s
     0     0 35081.4735    0  443 12706.6459 35081.4735   176%     -   64s
     0     0 35079.7957    0  447 12706.6459 35079.7957   176%     -   64s
     0     0 35078.8269    0  448 12706.6459 35078.8269   176%     -   64s
     0     0 34337.6907    0  415 12706.6459 34337.6907   170%     -   76s
H    0     0                    12912.067134 34100.2812   164%     -   80s
     0     0 34100.2812    0  409 12912.0671 34100.2812   164%     -   80s
     0     0 33833.7663    0  429 12912.0671 33833.7663   162%     -   82s
     0     0 33734.4795    0  426 12912.0671 33734.4795   161%     -   84s
     0     0 33681.1338    0  467 12912.0671 33681.1338   161%     -   85s
     0     0 33666.5710    0  429 12912.0671 33666.5710   161%     -   86s
     0     0 33615.8021    0  427 12912.0671 33615.8021   160%     -   87s
     0     0 33601.2239    0  495 12912.0671 33601.2239   160%     -   88s
     0     0 33588.1061    0  438 12912.0671 33588.1061   160%     -   88s
     0     0 33581.7066    0  432 12912.0671 33581.7066   160%     -   88s
     0     0 33579.3472    0  442 12912.0671 33579.3472   160%     -   89s
     0     0 33578.9126    0  441 12912.0671 33578.9126   160%     -   89s
     0     0 33390.9550    0  533 12912.0671 33390.9550   159%     -   92s
     0     0 33337.3413    0  499 12912.0671 33337.3413   158%     -   93s
     0     0 33318.0991    0  545 12912.0671 33318.0991   158%     -   94s
     0     0 33292.9603    0  552 12912.0671 33292.9603   158%     -   95s
     0     0 33285.5685    0  555 12912.0671 33285.5685   158%     -   95s
     0     0 33278.5963    0  557 12912.0671 33278.5963   158%     -   96s
     0     0 33273.5978    0  548 12912.0671 33273.5978   158%     -   96s
     0     0 33266.9553    0  555 12912.0671 33266.9553   158%     -   97s
     0     0 33266.1875    0  558 12912.0671 33266.1875   158%     -   97s
     0     0 33195.3842    0  463 12912.0671 33195.3842   157%     -   98s
     0     0 33162.7824    0  463 12912.0671 33162.7824   157%     -  101s
     0     0 33153.7595    0  471 12912.0671 33153.7595   157%     -  102s
     0     0 33151.1407    0  478 12912.0671 33151.1407   157%     -  102s
     0     0 33148.9375    0  483 12912.0671 33148.9375   157%     -  102s
     0     0 33147.4815    0  483 12912.0671 33147.4815   157%     -  102s
     0     0 33053.3274    0  463 12912.0671 33053.3274   156%     -  104s
     0     0 33028.6544    0  461 12912.0671 33028.6544   156%     -  106s
     0     0 33011.2106    0  459 12912.0671 33011.2106   156%     -  106s
     0     0 33004.4806    0  462 12912.0671 33004.4806   156%     -  107s
     0     0 32998.1256    0  466 12912.0671 32998.1256   156%     -  107s
     0     0 32997.5846    0  471 12912.0671 32997.5846   156%     -  107s
     0     0 32940.9944    0  473 12912.0671 32940.9944   155%     -  110s
     0     0 32912.6002    0  475 12912.0671 32912.6002   155%     -  113s
     0     0 32895.2036    0  466 12912.0671 32895.2036   155%     -  114s
     0     0 32890.9293    0  462 12912.0671 32890.9293   155%     -  115s
     0     0 32883.7086    0  476 12912.0671 32883.7086   155%     -  115s
     0     0 32874.4342    0  468 12912.0671 32874.4342   155%     -  115s
     0     0 32870.8133    0  471 12912.0671 32870.8133   155%     -  116s
     0     0 32870.5393    0  470 12912.0671 32870.5393   155%     -  116s
     0     0 32830.9590    0  406 12912.0671 32830.9590   154%     -  118s
     0     0 32825.1237    0  473 12912.0671 32825.1237   154%     -  119s
     0     0 32821.9098    0  482 12912.0671 32821.9098   154%     -  119s
     0     0 32819.4020    0  485 12912.0671 32819.4020   154%     -  119s
     0     0 32818.4247    0  489 12912.0671 32818.4247   154%     -  119s
     0     0 32783.6436    0  461 12912.0671 32783.6436   154%     -  121s
     0     0 32765.7637    0  474 12912.0671 32765.7637   154%     -  122s
     0     0 32761.9185    0  471 12912.0671 32761.9185   154%     -  122s
     0     0 32760.7205    0  478 12912.0671 32760.7205   154%     -  122s
     0     0 32746.6427    0  470 12912.0671 32746.6427   154%     -  124s
     0     0 32741.4057    0  471 12912.0671 32741.4057   154%     -  125s
     0     0 32737.7895    0  472 12912.0671 32737.7895   154%     -  125s
     0     0 32737.1788    0  477 12912.0671 32737.1788   154%     -  125s
     0     0 32730.9162    0  474 12912.0671 32730.9162   153%     -  126s
     0     0 32728.8380    0  481 12912.0671 32728.8380   153%     -  127s
     0     0 32728.6230    0  483 12912.0671 32728.6230   153%     -  127s
     0     0 32722.4767    0  516 12912.0671 32722.4767   153%     -  128s
     0     0 32717.8169    0  517 12912.0671 32717.8169   153%     -  129s
     0     0 32716.8363    0  521 12912.0671 32716.8363   153%     -  129s
     0     0 32713.7606    0  533 12912.0671 32713.7606   153%     -  130s
     0     0 32713.7204    0  533 12912.0671 32713.7204   153%     -  131s
H    0     0                    13031.006784 32713.6722   151%     -  162s
H    0     0                    13286.289655 32713.6722   146%     -  162s
H    0     0                    13836.744060 32713.6722   136%     -  162s
H    0     0                    14044.073238 32713.6722   133%     -  162s
     0     2 32713.6722    0  533 14044.0732 32713.6722   133%     -  164s
     1     3 31759.9415    1  399 14044.0732 32713.6722   133%  9556  169s
     2     5 30260.7994    2  466 14044.0732 32713.6722   133%  9582  177s
     4    10 30647.8876    2  419 14044.0732 32282.2593   130%  7583  184s
     9    20 29959.2639    3  306 14044.0732 32123.7945   129%  6380  190s
    19    40 29863.9166    4  316 14044.0732 31742.2278   126%  6108  197s
    39    52 29088.5731    5  372 14044.0732 31563.9338   125%  7342  211s
    51    79 25683.5626    6  200 14044.0732 31563.9338   125%  8829  223s
H   54    79                    14292.597994 31563.9338   121%  8572  223s
H   57    79                    16566.892363 31563.9338  90.5%  8272  223s
    78   229 25574.9065    7  195 16566.8924 31563.9338  90.5%  7227  238s
   228   304 24769.9522   12  175 16566.8924 31563.9338  90.5%  3854  245s
H  231   304                    16783.377453 31563.9338  88.1%  3824  245s
H  247   304                    18762.032434 31563.9338  68.2%  3720  245s
   305   365 22685.0505   15  112 18762.0324 31563.9338  68.2%  3486  251s
   372   397 22003.8078   20   89 18762.0324 31373.0726  67.2%  3348  256s
H  394   397                    18829.589839 31371.2480  66.6%  3448  256s
   404   443 21937.2618   21   76 18829.5898 31371.2480  66.6%  3480  260s
H  484   469                    18882.654185 31371.2480  66.1%  3448  264s
H  489   469                    19624.823496 31371.2480  59.9%  3436  264s
   494   492     cutoff   24      19624.8235 31371.2480  59.9%  3419  269s
H  496   492                    19727.879752 31371.2480  59.0%  3405  269s
H  528   492                    19732.266896 31371.2480  59.0%  3344  269s
   531   519 infeasible   23      19732.2669 31371.2480  59.0%  3344  274s
   564   552 19767.2019   24   25 19732.2669 31371.2480  59.0%  3306  279s
H  588   552                    20249.916183 31371.2480  54.9%  3294  279s
   608   589     cutoff   25      20249.9162 31371.2480  54.9%  3252  286s
   695   637 27653.9370    9  288 20249.9162 31371.2480  54.9%  3068  291s
   773   707 26179.2649   11  260 20249.9162 31371.2480  54.9%  2948  297s
   866   724 25281.2248   12  249 20249.9162 31371.2480  54.9%  2792  303s
   904   734 24969.8274   13  254 20249.9162 31371.2480  54.9%  2761  309s
H  907   734                    20289.846965 31371.2480  54.6%  2760  309s
   956   794 24063.8581   15  169 20289.8470 31371.2480  54.6%  2719  315s
H 1054   821                    20363.158054 31371.2480  54.1%  2596  320s
H 1067   821                    20493.431194 31371.2480  53.1%  2596  320s
H 1088   821                    20534.223757 31371.2480  52.8%  2581  320s
  1089   864 23123.8669   20  125 20534.2238 31371.2480  52.8%  2579  327s
  1201   927 22540.6516   26  329 20534.2238 30455.4293  48.3%  2465  335s
  1304   976 22392.7060   32  262 20534.2238 30455.4293  48.3%  2404  341s
  1382  1014 22316.0598   41  117 20534.2238 30455.4293  48.3%  2360  347s
  1458  1057 20716.5656   50   83 20534.2238 30455.4293  48.3%  2352  355s
  1543  1094 26922.2262    9  337 20534.2238 30455.4293  48.3%  2336  362s
  1629  1152 26192.4995   10  278 20534.2238 30159.3320  46.9%  2334  369s
  1722  1229 25478.7079   12  213 20534.2238 30159.3320  46.9%  2333  377s
  1829  1291 25134.1189   13  214 20534.2238 30159.3320  46.9%  2310  385s
  1951  1362 24802.9866   12  228 20534.2238 30159.3320  46.9%  2277  393s
  2073  1383 21221.5384   12  169 20534.2238 30159.3320  46.9%  2247  401s
H 2075  1383                    20691.459070 30159.3320  45.8%  2246  401s
H 2079  1383                    20709.682087 30159.3320  45.6%  2247  401s
H 2089  1383                    20751.128073 30159.3320  45.3%  2251  401s
H 2099  1383                    20769.878174 30159.3320  45.2%  2249  401s
  2110  1462     cutoff   14      20769.8782 30159.3320  45.2%  2249  408s
  2259  1589 22192.2815   14  204 20769.8782 29398.7118  41.5%  2214  417s
  2412  1706 21255.5847   17  285 20769.8782 29398.7118  41.5%  2184  425s
  2590  1775 28158.0242   14  410 20769.8782 29398.7118  41.5%  2115  435s
  2781  1809 24237.4453   17  305 20769.8782 29116.8708  40.2%  2078  444s
  2929  1875 infeasible   18      20769.8782 28881.1544  39.1%  2073  454s
  3058  1945 24963.0765   23  241 20769.8782 28856.8008  38.9%  2089  463s
  3194  2014 24655.6233   27  335 20769.8782 28763.8914  38.5%  2106  476s
  3313  2096 infeasible   30      20769.8782 28634.2221  37.9%  2120  486s
  3474  2196     cutoff   38      20769.8782 28624.7333  37.8%  2128  496s
  3640  2302 21433.6060   48  181 20769.8782 28624.7333  37.8%  2125  506s
  3800  2407 21154.4756   62  102 20769.8782 28558.9429  37.5%  2107  518s
  4011  2491 25825.0197    9  365 20769.8782 28533.6428  37.4%  2082  529s
H 4189  2503                    20831.113747 28533.6428  37.0%  2084  540s
H 4192  2500                    20849.190034 28533.6428  36.9%  2084  540s
H 4195  2488                    20884.238072 28533.6428  36.6%  2084  540s
  4233  2573 25942.0090   10  506 20884.2381 28533.6428  36.6%  2095  553s
  4412  2574 23367.4929   21  533 20884.2381 28533.6428  36.6%  2112  593s
  4414  2575 24064.2194   15  165 20884.2381 28533.6428  36.6%  2111  613s
  4415  2576 21852.5869   35  348 20884.2381 28533.6428  36.6%  2111  627s
  4416  2577 22145.2082   35  382 20884.2381 28533.6428  36.6%  2110  634s
  4417  2577 24156.4197   14  362 20884.2381 28533.6428  36.6%  2110  640s
  4418  2578 20899.1373   49  502 20884.2381 28533.6428  36.6%  2109  646s
  4419  2579 22113.6328   46  492 20884.2381 28533.6428  36.6%  2109  651s
  4420  2579 23023.2206   17  506 20884.2381 28533.6428  36.6%  2109  656s
  4422  2581 24253.5761   15  454 20884.2381 28533.6428  36.6%  2108  660s
  4424  2582 22032.9249   15  501 20884.2381 28533.6428  36.6%  2107  665s
  4426  2583 26472.3009    9  460 20884.2381 28533.6428  36.6%  2106  671s
  4429  2585 25827.4622   20  468 20884.2381 28533.6428  36.6%  2104  676s
  4430  2586 21673.7598   18  464 20884.2381 28533.6428  36.6%  2104  680s
  4433  2588 27032.7191    6  565 20884.2381 28533.6428  36.6%  2102  686s
  4436  2590 22917.9649   13  561 20884.2381 28533.6428  36.6%  2101  691s
  4438  2591 27926.0787   10  466 20884.2381 28533.6428  36.6%  2100  696s
  4440  2593 25007.4456   22  529 20884.2381 28533.6428  36.6%  2099  701s
  4442  2594 21798.9098   28  545 20884.2381 28533.6428  36.6%  2098  706s
  4443  2595 24520.8600   14  545 20884.2381 28533.6428  36.6%  2098  710s
  4445  2596 21147.9840   29  601 20884.2381 28533.6428  36.6%  2097  715s
  4446  2597 21633.1094   39  601 20884.2381 28533.6428  36.6%  2096  733s
  4447  2597 22330.5101   39  601 20884.2381 28533.6428  36.6%  2096  753s
  4448  2601 28533.6428   13  544 20884.2381 28533.6428  36.6%  2138  765s
  4450  2604 28533.6428   14  488 20884.2381 28533.6428  36.6%  2140  772s
  4454  2611 28533.6428   15  583 20884.2381 28533.6428  36.6%  2144  781s
  4462  2624 28533.6428   16  593 20884.2381 28533.6428  36.6%  2153  792s
  4478  2635 28533.6428   17  598 20884.2381 28533.6428  36.6%  2178  805s
  4494  2660 27448.2862   18  578 20884.2381 28533.6428  36.6%  2211  814s
  4526  2688 26850.2783   19  509 20884.2381 28533.6428  36.6%  2231  825s
  4609  2686 25941.1183   22  392 20884.2381 28533.6428  36.6%  2305  839s
  4672  2687 25449.6756   24  422 20884.2381 28533.6428  36.6%  2337  851s
  4741  2693 24450.6391   25  408 20884.2381 28533.6428  36.6%  2350  861s
  4802  2695     cutoff   27      20884.2381 28533.6428  36.6%  2361  871s
  4882  2702 23645.4101   26  495 20884.2381 28533.6428  36.6%  2364  884s
  4968  2680 23113.4735   26  502 20884.2381 28533.6428  36.6%  2362  895s
  5016  2685 infeasible   27      20884.2381 28533.6428  36.6%  2379  902s
  5060  2683     cutoff   27      20884.2381 28533.6428  36.6%  2389  910s
  5117  2687     cutoff   27      20884.2381 28533.6428  36.6%  2393  917s
  5177  2688     cutoff   27      20884.2381 28533.6428  36.6%  2396  926s
  5243  2681 23078.2129   27  463 20884.2381 28533.6428  36.6%  2393  937s
  5277  2680 22601.1962   28  522 20884.2381 28533.6428  36.6%  2404  945s
  5327  2678 22494.4142   29  528 20884.2381 28533.6428  36.6%  2409  953s
  5382  2671 22411.2572   30  485 20884.2381 28533.6428  36.6%  2414  962s
  5444  2667 21471.8019   31  416 20884.2381 28533.6428  36.6%  2419  971s
  5496  2682 21358.8752   32  321 20884.2381 28533.6428  36.6%  2425  979s
  5555  2691 21933.9597   32  489 20884.2381 28533.6428  36.6%  2430  988s
  5620  2669 21040.9358   34  381 20884.2381 28533.6428  36.6%  2437  997s
  5686  2665     cutoff   35      20884.2381 28533.6428  36.6%  2445 1006s
  5723  2679 24050.0766   21  496 20884.2381 28533.6428  36.6%  2452 1017s
  5815  2673     cutoff   22      20884.2381 28533.6428  36.6%  2455 1028s
  5915  2680 infeasible   22      20884.2381 28533.6428  36.6%  2454 1039s
  6022  2675 22489.2424   24  430 20884.2381 28533.6428  36.6%  2454 1051s
  6127  2654 21471.9918   25  292 20884.2381 28533.6428  36.6%  2463 1061s
  6193  2647     cutoff   26      20884.2381 28533.6428  36.6%  2467 1072s
  6309  2628 20967.7692   71  105 20884.2381 28533.6428  36.6%  2466 1085s
  6421  2645 24900.0747   24  420 20884.2381 28533.6428  36.6%  2473 1097s
  6557  2636 24201.2667   25  319 20884.2381 28533.6428  36.6%  2466 1108s
  6685  2639 23765.3697   26  253 20884.2381 28533.6428  36.6%  2474 1122s
  6822  2639     cutoff   28      20884.2381 28533.6428  36.6%  2480 1134s
  6946  2652 21234.6961   28  187 20884.2381 28533.6428  36.6%  2479 1148s
  7106  2604 21318.6180   24  216 20884.2381 26720.9773  27.9%  2479 1161s
  7155  2617 21028.6429   25  172 20884.2381 26720.9773  27.9%  2485 1175s
  7229  2617 20951.8137   26  172 20884.2381 26720.9773  27.9%  2491 1186s
  7331  2616     cutoff   27      20884.2381 26720.9773  27.9%  2481 1198s
  7488  2605     cutoff   22      20884.2381 26720.9773  27.9%  2465 1213s
  7679  2572 21157.8100   23  376 20884.2381 25978.3698  24.4%  2441 1227s
  7793  2579     cutoff   24      20884.2381 25855.2789  23.8%  2435 1243s
  7964  2578     cutoff   27      20884.2381 25674.9900  22.9%  2444 1259s
* 8085  2407              32    21134.084469 25674.9900  21.5%  2449 1259s
  8199  2418 22302.1342   25  223 21134.0845 25602.9900  21.1%  2438 1276s
  8417  2403     cutoff   26      21134.0845 25503.2024  20.7%  2445 1294s
H 8442  2271                    21446.230539 25503.2024  18.9%  2447 1294s
  8647  2245 22397.9558   24  414 21446.2305 25483.2716  18.8%  2441 1312s
  8906  2207     cutoff   25      21446.2305 25179.9554  17.4%  2442 1329s
  9168  2135 22838.3596   27  204 21446.2305 25061.6067  16.9%  2450 1348s
  9465  2090 21798.7080   28  363 21446.2305 24943.4380  16.3%  2456 1373s
  9750  2035     cutoff   27      21446.2305 24800.8860  15.6%  2461 1394s
 10039  1921 infeasible   28      21446.2305 24800.8860  15.6%  2459 1416s
 10335  1865 22074.6519   26  288 21446.2305 24652.3022  14.9%  2471 1436s
 10701  1750 infeasible   26      21446.2305 24652.3022  14.9%  2468 1458s
 11110  1556 22588.6768   24  150 21446.2305 24173.2339  12.7%  2459 1482s
 11555  1301 21496.1163   27  230 21446.2305 23938.9297  11.6%  2449 1506s
 11896  1146 infeasible   21      21446.2305 23535.1410  9.74%  2467 1530s
 12408   671     cutoff   31      21446.2305 23229.2884  8.31%  2449 1552s
 13168     0 21909.2843   41  142 21446.2305 22695.5325  5.83%  2388 1569s

Cutting planes:
  Learned: 2
  MIR: 597
  Mixing: 5
  Flow cover: 1651
  Inf proof: 1
  RLT: 21
  Relax-and-lift: 173

Explored 13983 nodes (32241101 simplex iterations) in 1569.63 seconds (4861.92 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21446.2 21134.1 20884.2 ... 20534.2

Optimal solution found (tolerance 1.00e-06)
Best objective 2.144623053945e+04, best bound 2.144623053945e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 1569.66s
  Master Objective (UB) = 21446.23, θ = 151463.48
  Upper Bound (UB) = 21446.23

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151463.48
  [DEBUG]   ✓ Scenario 0: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 151463.48 ≤ Q = 151463.48 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 6] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x7869c673
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x7869c673
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e-12, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [2e-14, 2e+02]
Found heuristic solution: objective 1.552218e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8262943.9943
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.408032e+05, 246 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140803.21    0  124 8262943.99 -140803.21   102%     -    0s
H    0     0                    -105815.7326 -140803.21  33.1%     -    0s
H    0     0                    -106377.7530 -140803.21  32.4%     -    0s
H    0     0                    -115385.4980 -118029.71  2.29%     -    0s
     0     0 -118029.71    0   86 -115385.50 -118029.71  2.29%     -    0s
     0     0 -117588.12    0   87 -115385.50 -117588.12  1.91%     -    0s
H    0     0                    -115540.8203 -117568.40  1.75%     -    0s
H    0     0                    -116346.0387 -117568.40  1.05%     -    0s
H    0     0                    -116369.1046 -117568.40  1.03%     -    0s
     0     0 -117522.40    0   87 -116369.10 -117522.40  0.99%     -    0s
     0     0 -117311.27    0   75 -116369.10 -117311.27  0.81%     -    0s
     0     0 -117195.54    0   65 -116369.10 -117195.54  0.71%     -    0s
     0     0 -117166.62    0   61 -116369.10 -117166.62  0.69%     -    0s
     0     0 -117166.45    0   61 -116369.10 -117166.45  0.69%     -    0s
     0     0 -117060.38    0   48 -116369.10 -117060.38  0.59%     -    0s
     0     0 -117046.15    0   51 -116369.10 -117046.15  0.58%     -    0s
     0     0 -116985.78    0   51 -116369.10 -116985.78  0.53%     -    0s
     0     0 -116965.20    0   51 -116369.10 -116965.20  0.51%     -    0s
     0     2 -116965.20    0   51 -116369.10 -116965.20  0.51%     -    0s
H   43    20                    -116806.8457 -116816.41  0.01%   9.4    0s

Cutting planes:
  Gomory: 8
  Implied bound: 1
  MIR: 128
  Flow cover: 8
  RLT: 41
  BQP: 3

Explored 61 nodes (1154 simplex iterations) in 0.09 seconds (0.06 work units)
Thread count was 32 (of 64 available processors)

Solution count 8: -116807 -116369 -115541 ... 1.55222e+13
No other solutions better than -116807

Optimal solution found (tolerance 1.00e-06)
Best objective -1.168068456675e+05, best bound -1.168068456675e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 143925.07
  Scenario: 14 demand increases, 46 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -116806.85
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -116806.85 = 143925.07
  [DEBUG]   Current θ from Master = 151463.48
  [DEBUG]   ⚠️  Z_SP ≤ θ by 7538.41 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 13907.82
  Lower Bound (LB) = 18526.04
  Gap (UB-LB) = 2920.1931, Absolute Gap = 2920.1931, Relative Gap = 0.136163
  Not converged yet (gap = 2920.19 > ε = 200)

  [DEBUG] Adding NEW scenario 6 to Master Problem...
  [DEBUG] New scenario pattern: 14 increases, 46 decreases
    [DEBUG] Scenario 6 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 6 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 6]
    [DEBUG]   - Total constraints in model: 108413
    [DEBUG]   - Total variables in model: 45940
  [DEBUG] Total scenarios in Master: 7
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 7
================================================================================
[Iteration 7] Solving Master Problem...
  Current scenarios in Master: 7
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 108413 rows, 45940 columns and 308241 nonzeros
Model fingerprint: 0xddbada60
Variable types: 43681 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 46015 rows and 18685 columns
Presolve time: 0.98s
Presolved: 62398 rows, 27255 columns, 388134 nonzeros
Variable types: 24996 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 62398 rows, 27255 columns, 388134 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   33373    3.9729567e+03   0.000000e+00   1.371317e+07      5s
   45645    2.9159034e+04   0.000000e+00   2.761491e+06     10s
   57085    3.7498085e+04   0.000000e+00   2.443643e+06     15s
   66220    4.0878958e+04   0.000000e+00   9.920205e+06     20s
Concurrent spin time: 0.00s

Solved with dual simplex

Root relaxation: objective 4.598347e+04, 47732 iterations, 23.28 seconds (49.50 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45983.4722    0  165 -194556.81 45983.4722   124%     -   24s
H    0     0                    -180924.6486 45983.4722   125%     -   24s
H    0     0                    -84397.56721 45983.4722   154%     -   25s
H    0     0                    -80004.07514 45983.4722   157%     -   25s
H    0     0                    -79491.98022 45983.4722   158%     -   25s
H    0     0                    -79477.78671 45983.4722   158%     -   25s
H    0     0                    -79018.38430 45983.4722   158%     -   25s
H    0     0                    -78125.81199 45983.4722   159%     -   25s
H    0     0                    -78016.94272 45983.4722   159%     -   25s
H    0     0                    -44477.01379 45983.4722   203%     -   25s
H    0     0                    -44267.86357 45983.4722   204%     -   25s
H    0     0                    -21180.42180 45983.4722   317%     -   25s
H    0     0                    3293.0720716 45983.4722  1296%     -   25s
H    0     0                    3435.7319008 45983.4722  1238%     -   25s
H    0     0                    3475.6290843 45983.4722  1223%     -   25s
H    0     0                    5765.8563605 45983.4722   698%     -   26s
H    0     0                    7050.8048380 45983.4722   552%     -   26s
H    0     0                    7149.9312184 45983.4722   543%     -   26s
     0     0 41554.8757    0  210 7149.93122 41554.8757   481%     -   32s
     0     0 41413.2862    0  229 7149.93122 41413.2862   479%     -   33s
     0     0 41394.9998    0  230 7149.93122 41394.9998   479%     -   34s
     0     0 41394.9998    0  230 7149.93122 41394.9998   479%     -   34s
     0     0 38546.1689    0  325 7149.93122 38546.1689   439%     -   44s
H    0     0                    11756.908435 38546.1689   228%     -   44s
H    0     0                    11935.590490 38546.1689   223%     -   44s
     0     0 38410.8031    0  351 11935.5905 38410.8031   222%     -   48s
     0     0 38049.6345    0  372 11935.5905 38049.6345   219%     -   53s
     0     0 38014.7621    0  378 11935.5905 38014.7621   218%     -   54s
     0     0 37983.8989    0  374 11935.5905 37983.8989   218%     -   55s
     0     0 37942.1418    0  370 11935.5905 37942.1418   218%     -   57s
     0     0 37936.7557    0  376 11935.5905 37936.7557   218%     -   57s
     0     0 37936.2548    0  373 11935.5905 37936.2548   218%     -   57s
H    0     0                    11939.768222 36174.1632   203%     -   70s
H    0     0                    11948.882435 36174.1632   203%     -   70s
     0     0 36174.1632    0  388 11948.8824 36174.1632   203%     -   70s
H    0     0                    11962.068081 36173.7086   202%     -   70s
H    0     0                    12004.733086 36173.7086   201%     -   70s
H    0     0                    12014.731780 36173.7086   201%     -   70s
     0     0 35699.3180    0  382 12014.7318 35699.3180   197%     -   77s
     0     0 35433.7847    0  390 12014.7318 35433.7847   195%     -   80s
     0     0 35294.6244    0  401 12014.7318 35294.6244   194%     -   83s
     0     0 35200.6015    0  399 12014.7318 35200.6015   193%     -   85s
     0     0 35013.8089    0  405 12014.7318 35013.8089   191%     -   88s
     0     0 34967.1170    0  420 12014.7318 34967.1170   191%     -   89s
     0     0 34940.6028    0  424 12014.7318 34940.6028   191%     -   91s
     0     0 34909.8758    0  424 12014.7318 34909.8758   191%     -   92s
     0     0 34889.1557    0  421 12014.7318 34889.1557   190%     -   93s
     0     0 34887.5377    0  422 12014.7318 34887.5377   190%     -   94s
     0     0 34885.5274    0  423 12014.7318 34885.5274   190%     -   94s
     0     0 34883.8807    0  420 12014.7318 34883.8807   190%     -   95s
     0     0 34883.2547    0  422 12014.7318 34883.2547   190%     -   95s
     0     0 34010.5648    0  487 12014.7318 34010.5648   183%     -  105s
     0     0 33731.6079    0  494 12014.7318 33731.6079   181%     -  108s
     0     0 33634.5505    0  451 12014.7318 33634.5505   180%     -  111s
     0     0 33530.8298    0  446 12014.7318 33530.8298   179%     -  113s
     0     0 33505.6460    0  408 12014.7318 33505.6460   179%     -  114s
     0     0 33472.2214    0  438 12014.7318 33472.2214   179%     -  115s
     0     0 33463.9799    0  445 12014.7318 33463.9799   179%     -  116s
     0     0 33453.0017    0  545 12014.7318 33453.0017   178%     -  117s
     0     0 33440.1468    0  496 12014.7318 33440.1468   178%     -  117s
     0     0 33403.7248    0  436 12014.7318 33403.7248   178%     -  119s
     0     0 33381.0076    0  495 12014.7318 33381.0076   178%     -  120s
     0     0 33377.9484    0  498 12014.7318 33377.9484   178%     -  120s
     0     0 33376.7053    0  501 12014.7318 33376.7053   178%     -  120s
     0     0 33242.0998    0  553 12014.7318 33242.0998   177%     -  123s
H    0     0                    12048.391906 33240.0382   176%     -  123s
     0     0 33135.3642    0  562 12048.3919 33135.3642   175%     -  125s
     0     0 33117.1501    0  513 12048.3919 33117.1501   175%     -  126s
     0     0 33103.9481    0  517 12048.3919 33103.9481   175%     -  127s
     0     0 33093.2428    0  465 12048.3919 33093.2428   175%     -  128s
     0     0 33091.6765    0  461 12048.3919 33091.6765   175%     -  129s
     0     0 33088.5442    0  477 12048.3919 33088.5442   175%     -  129s
     0     0 33084.4741    0  528 12048.3919 33084.4741   175%     -  130s
     0     0 33072.2837    0  464 12048.3919 33072.2837   174%     -  131s
     0     0 33070.3334    0  466 12048.3919 33070.3334   174%     -  131s
     0     0 33069.7181    0  464 12048.3919 33069.7181   174%     -  131s
     0     0 33001.5457    0  524 12048.3919 33001.5457   174%     -  134s
H    0     0                    13211.868510 33001.3289   150%     -  135s
H    0     0                    13334.827114 33001.3289   147%     -  135s
H    0     0                    13493.547592 33001.3289   145%     -  135s
H    0     0                    13952.192674 33001.3289   137%     -  135s
H    0     0                    13985.238333 33001.3289   136%     -  135s
H    0     0                    14309.110732 33001.3289   131%     -  135s
H    0     0                    14315.490973 33001.3289   131%     -  135s
     0     0 32965.3745    0  527 14315.4910 32965.3745   130%     -  136s
     0     0 32959.2932    0  539 14315.4910 32959.2932   130%     -  137s
     0     0 32951.8457    0  536 14315.4910 32951.8457   130%     -  138s
     0     0 32945.4926    0  490 14315.4910 32945.4926   130%     -  138s
     0     0 32941.8538    0  490 14315.4910 32941.8538   130%     -  138s
     0     0 32941.0572    0  494 14315.4910 32941.0572   130%     -  139s
     0     0 32858.4782    0  541 14315.4910 32858.4782   130%     -  141s
H    0     0                    14416.004506 32855.2224   128%     -  141s
     0     0 32829.7656    0  544 14416.0045 32829.7656   128%     -  142s
     0     0 32819.0862    0  548 14416.0045 32819.0862   128%     -  143s
     0     0 32810.0621    0  559 14416.0045 32810.0621   128%     -  144s
     0     0 32807.7773    0  556 14416.0045 32807.7773   128%     -  144s
     0     0 32806.7031    0  558 14416.0045 32806.7031   128%     -  144s
     0     0 32773.7825    0  502 14416.0045 32773.7825   127%     -  146s
H    0     0                    17554.793888 32773.2179  86.7%     -  146s
H    0     0                    18250.223779 32773.2179  79.6%     -  146s
H    0     0                    18314.396986 32773.2179  78.9%     -  146s
H    0     0                    18556.312182 32773.2179  76.6%     -  146s
H    0     0                    18557.127667 32773.2179  76.6%     -  146s
H    0     0                    18597.892788 32773.2179  76.2%     -  146s
H    0     0                    18650.257409 32773.2179  75.7%     -  147s
     0     0 32732.5770    0  545 18650.2574 32732.5770  75.5%     -  148s
     0     0 32725.0388    0  554 18650.2574 32725.0388  75.5%     -  149s
     0     0 32721.9237    0  555 18650.2574 32721.9237  75.5%     -  149s
     0     0 32720.8177    0  556 18650.2574 32720.8177  75.4%     -  149s
     0     0 32708.9496    0  505 18650.2574 32708.9496  75.4%     -  151s
H    0     0                    18878.729063 32708.8758  73.3%     -  151s
H    0     0                    19165.362023 32708.8758  70.7%     -  151s
H    0     0                    19210.217573 32708.8758  70.3%     -  151s
H    0     0                    19224.275956 32708.8758  70.1%     -  151s
H    0     0                    19238.520136 32708.8758  70.0%     -  151s
H    0     0                    19272.179719 32708.8758  69.7%     -  151s
     0     0 32697.5965    0  557 19272.1797 32697.5965  69.7%     -  152s
     0     0 32694.5288    0  558 19272.1797 32694.5288  69.6%     -  153s
     0     0 32693.0900    0  559 19272.1797 32693.0900  69.6%     -  153s
     0     0 32689.6419    0  554 19272.1797 32689.6419  69.6%     -  154s
H    0     0                    19680.215618 32689.3251  66.1%     -  155s
H    0     0                    19698.772514 32689.3251  65.9%     -  155s
H    0     0                    19726.395700 32689.3251  65.7%     -  155s
H    0     0                    19736.727264 32689.3251  65.6%     -  155s
     0     0 32687.6004    0  548 19736.7273 32687.6004  65.6%     -  156s
     0     0 32686.5298    0  546 19736.7273 32686.5298  65.6%     -  156s
     0     0 32683.6648    0  555 19736.7273 32683.6648  65.6%     -  157s
     0     0 32681.9732    0  506 19736.7273 32681.9732  65.6%     -  158s
     0     0 32681.3886    0  509 19736.7273 32681.3886  65.6%     -  158s
     0     0 32676.5574    0  501 19736.7273 32676.5574  65.6%     -  159s
H    0     0                    19838.610880 32676.2214  64.7%     -  160s
H    0     0                    19924.061787 32676.2214  64.0%     -  160s
H    0     0                    19967.600621 32676.2214  63.6%     -  160s
H    0     0                    19990.194691 32676.2214  63.5%     -  160s
H    0     0                    20009.814887 32676.2214  63.3%     -  160s
     0     0 32675.1697    0  550 20009.8149 32675.1697  63.3%     -  161s
     0     0 32673.3207    0  495 20009.8149 32673.3207  63.3%     -  162s
     0     0 32672.2943    0  495 20009.8149 32672.2943  63.3%     -  163s
     0     0 32671.4572    0  495 20009.8149 32671.4572  63.3%     -  163s
     0     0 32670.3777    0  495 20009.8149 32670.3777  63.3%     -  165s
H    0     0                    20043.441808 32670.3777  63.0%     -  179s
H    0     0                    20061.241478 32670.3777  62.9%     -  179s
H    0     0                    20081.451003 32670.3777  62.7%     -  179s
H    0     0                    20094.393560 32670.3777  62.6%     -  179s
H    0     0                    20123.966527 32670.2382  62.3%     -  206s
H    0     0                    20190.207459 32670.2382  61.8%     -  207s
H    0     0                    20218.703241 32670.2382  61.6%     -  207s
H    0     0                    20274.879865 32670.2382  61.1%     -  209s
H    0     0                    20443.967014 32670.2382  59.8%     -  219s
H    0     0                    20457.474045 32670.2382  59.7%     -  219s
H    0     2                    20767.590411 32670.2382  57.3%     -  221s
     0     2 32670.2382    0  495 20767.5904 32670.2382  57.3%     -  221s
     1     3 31466.3043    1  443 20767.5904 32669.6984  57.3% 10785  228s
     2     6 30666.7423    2  422 20767.5904 32669.6984  57.3%  9121  233s
     5    12 29743.4604    3  509 20767.5904 32338.5996  55.7%  6188  238s
    11    24 29462.4274    4  488 20767.5904 32006.9375  54.1%  7269  243s
    23    36 31272.4349    4  496 20767.5904 31695.2019  52.6%  7489  258s
    35    68 30025.5664    5  511 20767.5904 31695.2019  52.6%  9842  289s
    67   107 29979.2914    6  514 20767.5904 31516.6797  51.8% 11951  300s
H   70   107                    20779.686014 31516.6797  51.7% 11531  300s
H   73   107                    20787.416576 31516.6797  51.6% 11159  300s
H   76   107                    20792.283085 31516.6797  51.6% 10986  300s
H   77   107                    20797.582618 31516.6797  51.5% 10924  300s
H   82   107                    20800.860074 31516.6797  51.5% 10422  300s
H   96   107                    20800.957754 31516.6797  51.5%  9672  300s
   106   244 29957.1579    7  506 20800.9578 31514.5848  51.5%  9355  311s
   243   335 29593.1052    9  366 20800.9578 31514.5848  51.5%  5550  319s
   334   394 29453.1938    9  447 20800.9578 31514.5848  51.5%  4699  325s
   399   421 27377.4006   11  239 20800.9578 31514.5848  51.5%  4534  332s
   433   455 25831.9945   12  257 20800.9578 31514.5848  51.5%  4591  338s
   473   485 26843.2961   11  250 20800.9578 31514.5848  51.5%  4620  344s
   513   509 22225.0609   13  250 20800.9578 31514.5848  51.5%  4727  351s
   550   547 21905.7638   14  237 20800.9578 31514.5848  51.5%  4791  358s
   599   582 infeasible   14      20800.9578 31259.7042  50.3%  4813  366s
H  635   582                    20810.854912 31112.9182  49.5%  4736  366s
   659   659 29226.3818    7  421 20810.8549 31112.9182  49.5%  4732  374s
   740   736 29101.4747    8  369 20810.8549 31112.9182  49.5%  4659  378s
   821   812 29018.2511    9  365 20810.8549 31112.9182  49.5%  4519  385s
H  938   837                    20921.542095 31112.9182  48.7%  4353  389s
   953   891 28086.1363   12  338 20921.5421 31112.9182  48.7%  4354  394s
  1037   942 27764.2180   14  430 20921.5421 30859.5295  47.5%  4281  402s
  1137   963 24270.6026   17  288 20921.5421 30859.5295  47.5%  4197  411s
  1205  1012 24209.8257   18  320 20921.5421 30859.5295  47.5%  4160  420s
  1274  1060 24162.9228   19  256 20921.5421 30859.5295  47.5%  4177  428s
  1344  1126 23012.2311   22  196 20921.5421 30859.5295  47.5%  4201  436s
  1437  1208 21010.3320   24  276 20921.5421 30859.5295  47.5%  4180  445s
  1550  1281 28704.2880   10  395 20921.5421 30859.5295  47.5%  4103  452s
  1669  1330 28579.7078   11  385 20921.5421 30859.5295  47.5%  4033  462s
H 1780  1371                    20924.812769 30824.5768  47.3%  3996  471s
H 1782  1371                    20928.214576 30824.5768  47.3%  4003  471s
  1865  1424 23320.5369   16  222 20928.2146 30599.2140  46.2%  4008  481s
  1974  1497 23015.3928   18  309 20928.2146 30529.2152  45.9%  4027  491s
  2091  1569 22306.0330   22  361 20928.2146 30529.2152  45.9%  4019  500s
  2226  1591 21653.6907   27  303 20928.2146 30417.4063  45.3%  3979  510s
  2271  1623 21328.9914   28  185 20928.2146 30417.4063  45.3%  4003  519s
  2372  1640 28825.6376   10  375 20928.2146 30197.0777  44.3%  3989  529s
  2485  1668 27979.1231   13  338 20928.2146 30126.8597  44.0%  4014  540s
  2566  1691 24352.1274   13  328 20928.2146 29974.8501  43.2%  4101  551s
  2607  1724 24871.4437   15  319 20928.2146 29974.8501  43.2%  4157  561s
  2654  1766 25201.3148   15  243 20928.2146 29956.9916  43.1%  4225  571s
  2708  1797 infeasible   16      20928.2146 29956.9916  43.1%  4263  583s
  2795  1883 25572.2262   16  255 20928.2146 29956.9916  43.1%  4289  593s
  2899  1934 25515.7966   17  249 20928.2146 29887.5541  42.8%  4322  606s
  3076  1999 24319.4210   20  207 20928.2146 29887.5541  42.8%  4292  620s
  3233  2066 23830.3670   22  193 20928.2146 29787.4615  42.3%  4318  632s
  3354  2157 23011.9204   26  290 20928.2146 29570.7961  41.3%  4378  644s
  3521  2264 infeasible   32      20928.2146 29570.7961  41.3%  4402  659s
  3723  2339 23889.5943   16  459 20928.2146 29570.7961  41.3%  4389  674s
  3834  2420 23599.6634   17  439 20928.2146 29570.7961  41.3%  4397  690s
  3999  2500 22879.5211   18  384 20928.2146 29479.8113  40.9%  4389  705s
  4193  2609 22607.7966   20  367 20928.2146 29461.8874  40.8%  4394  723s
  4413  2610 22854.0589   20  495 20928.2146 29461.8874  40.8%  4395  765s
  4415  2611 21597.2936   42  165 20928.2146 29461.8874  40.8%  4393  797s
  4416  2612 28225.4639   14  354 20928.2146 29461.8874  40.8%  4392  816s
  4417  2613 26232.9654   18  388 20928.2146 29461.8874  40.8%  4391  829s
  4418  2613 25520.4675   12  415 20928.2146 29461.8874  40.8%  4390  837s
  4419  2614 22290.3994   34  489 20928.2146 29461.8874  40.8%  4389  843s
  4420  2615 23349.8657   22  449 20928.2146 29461.8874  40.8%  4388  848s
  4421  2615 26225.0925   13  501 20928.2146 29461.8874  40.8%  4387  853s
  4422  2616 23590.2659   25  480 20928.2146 29461.8874  40.8%  4386  856s
  4424  2617 26672.1377    8  579 20928.2146 29461.8874  40.8%  4384  861s
  4427  2619 22305.0800   23  487 20928.2146 29461.8874  40.8%  4381  866s
  4428  2620 27290.1599   22  587 20928.2146 29461.8874  40.8%  4380  871s
  4430  2621 25157.8565   16  532 20928.2146 29461.8874  40.8%  4378  878s
  4431  2622 24149.4371   22  626 20928.2146 29461.8874  40.8%  4377  880s
  4434  2624 22326.4144   15  529 20928.2146 29461.8874  40.8%  4374  887s
  4435  2625 27215.7455   11  525 20928.2146 29461.8874  40.8%  4373  890s
  4437  2626 22634.7604   18  548 20928.2146 29461.8874  40.8%  4371  897s
  4438  2627 28382.4032   17  587 20928.2146 29461.8874  40.8%  4370  903s
  4439  2627 28618.1662   10  591 20928.2146 29461.8874  40.8%  4369  906s
  4440  2628 25995.1217   12  545 20928.2146 29461.8874  40.8%  4368  911s
  4441  2629 21405.4370   39  430 20928.2146 29461.8874  40.8%  4367  915s
  4443  2630 28408.9087   16  561 20928.2146 29461.8874  40.8%  4365  947s
  4444  2631 25257.8693   13  561 20928.2146 29461.8874  40.8%  4364  968s
  4445  2634 29461.8874   12  537 20928.2146 29461.8874  40.8%  4413  982s
  4447  2638 29461.8874   13  470 20928.2146 29461.8874  40.8%  4414  994s
  4451  2644 29461.8874   14  536 20928.2146 29461.8874  40.8%  4417 1005s
  4459  2658 29461.8874   15  549 20928.2146 29461.8874  40.8%  4426 1018s
  4475  2668 29461.8874   16  473 20928.2146 29461.8874  40.8%  4438 1040s
  4491  2695 27060.5997   17  500 20928.2146 29461.8874  40.8%  4485 1055s
  4523  2750 24724.8919   18  404 20928.2146 29461.8874  40.8%  4492 1069s
  4599  2755 24525.7125   19  409 20928.2146 29461.8874  40.8%  4554 1080s
H 4612  2618                    21075.510925 29461.8874  39.8%  4551 1080s
  4653  2624 24108.9743   20  495 21075.5109 29461.8874  39.8%  4548 1092s
  4722  2638 23265.1636   20  438 21075.5109 29461.8874  39.8%  4538 1103s
H 4724  2512                    21320.073283 29461.8874  38.2%  4538 1103s
H 4791  2371                    21372.557376 29461.8874  37.8%  4516 1103s
  4802  2392 21590.5299   21  472 21372.5574 29461.8874  37.8%  4516 1114s
  4889  2391 22271.0144   22  431 21372.5574 29461.8874  37.8%  4471 1125s
  4982  2364 infeasible   21      21372.5574 29461.8874  37.8%  4422 1134s
  5064  2345 21774.0093   25  361 21372.5574 29461.8874  37.8%  4388 1148s
  5107  2348 infeasible   24      21372.5574 29461.8874  37.8%  4382 1158s
  5161  2349 24930.9451   18  318 21372.5574 29461.8874  37.8%  4378 1165s
  5197  2357 24214.1642   19  221 21372.5574 29461.8874  37.8%  4377 1174s
  5238  2364 23889.8229   20  217 21372.5574 29461.8874  37.8%  4372 1181s
  5282  2365 23512.3610   21  212 21372.5574 29461.8874  37.8%  4359 1190s
  5330  2369 22207.9280   22  351 21372.5574 29461.8874  37.8%  4350 1197s
  5386  2365 22187.5227   23  355 21372.5574 29461.8874  37.8%  4337 1206s
  5455  2350 22013.6723   24  411 21372.5574 29461.8874  37.8%  4317 1215s
  5492  2357 21984.1949   25  366 21372.5574 29461.8874  37.8%  4310 1224s
  5544  2355 21715.0108   27  272 21372.5574 29461.8874  37.8%  4292 1234s
  5606  2346 21583.7830   29  307 21372.5574 29461.8874  37.8%  4271 1244s
  5699  2343 infeasible   33      21372.5574 29461.8874  37.8%  4235 1259s
  5787  2328 infeasible   27      21372.5574 29461.8874  37.8%  4205 1271s
  5868  2315 22044.1817   29   79 21372.5574 29461.8874  37.8%  4183 1282s
  5969  2304 21928.3998   31  196 21372.5574 29461.8874  37.8%  4152 1293s
  6070  2306 21753.1937   36  100 21372.5574 29461.8874  37.8%  4132 1305s
  6168  2311 23053.0131   23  411 21372.5574 29461.8874  37.8%  4112 1317s
  6257  2292 23044.0755   24  409 21372.5574 29461.8874  37.8%  4094 1330s
  6367  2281     cutoff   25      21372.5574 29461.8874  37.8%  4076 1342s
  6458  2280 29461.8874   17  467 21372.5574 29461.8874  37.8%  4069 1355s
  6591  2265 28276.2504   18  466 21372.5574 29461.8874  37.8%  4045 1369s
  6702  2249 28223.6089   19  463 21372.5574 29461.8874  37.8%  4019 1384s
  6850  2228 28038.9175   20  456 21372.5574 29461.8874  37.8%  3989 1398s
  6975  2226 24664.3588   22  381 21372.5574 29461.8874  37.8%  3973 1414s
  7094  2203 24563.1031   23  373 21372.5574 29461.8874  37.8%  3962 1429s
  7195  2232 22885.3696   25  305 21372.5574 28218.3186  32.0%  3948 1446s
  7332  2238     cutoff   26      21372.5574 28218.3186  32.0%  3942 1462s
  7494  2217 infeasible   26      21372.5574 27615.6775  29.2%  3926 1482s
  7637  2223 24070.7451   25  273 21372.5574 27445.3949  28.4%  3918 1502s
  7784  2180 23124.7890   30  380 21372.5574 27445.3949  28.4%  3910 1520s
  7911  2189 23075.8267   31  335 21372.5574 27041.5517  26.5%  3896 1539s
  8038  2195     cutoff   33      21372.5574 27041.5517  26.5%  3893 1559s
  8237  2140 22255.6472   22  291 21372.5574 26312.9172  23.1%  3867 1579s
  8384  2115 21546.5001   24  209 21372.5574 26312.9172  23.1%  3872 1601s
  8561  2095 23572.3459   22  533 21372.5574 25800.4219  20.7%  3872 1621s
  8785  2065 21544.8152   25  457 21372.5574 25800.4219  20.7%  3857 1647s
  9042  2006 22299.6650   24  469 21372.5574 25285.5980  18.3%  3831 1668s
  9211  1995 22038.4646   25  402 21372.5574 25285.5980  18.3%  3821 1692s
  9455  1943 infeasible   28      21372.5574 24926.7557  16.6%  3804 1718s
  9715  1889     cutoff   27      21372.5574 24786.6679  16.0%  3795 1744s
  9963  1821     cutoff   29      21372.5574 24508.4400  14.7%  3796 1769s
 10232  1768 22342.0483   29  405 21372.5574 24391.2184  14.1%  3790 1797s
 10599  1654     cutoff   27      21372.5574 24243.6602  13.4%  3758 1827s
 10948  1584     cutoff   29      21372.5574 24128.6829  12.9%  3736 1857s
 11315  1472 21883.2973   36  126 21372.5574 24035.7853  12.5%  3711 1888s
 11741  1433 infeasible   26      21372.5574 23776.4760  11.2%  3675 1921s
 12202  1329 infeasible   25      21372.5574 23479.3301  9.86%  3639 1952s
 12404  1156 21596.4031   25  182 21372.5574 23439.5344  9.67%  3624 1983s
 12816   999 infeasible   26      21372.5574 23360.1576  9.30%  3583 2015s
 13434   359 infeasible   27      21372.5574 23127.7790  8.21%  3507 2044s
 14351    13 21524.4808   32  309 21372.5574 22710.9719  6.26%  3365 2068s
 14779     0 infeasible   28      21372.5574 21969.0291  2.79%  3298 2074s

Cutting planes:
  Learned: 3
  MIR: 820
  Mixing: 2
  Flow cover: 2182
  Inf proof: 1
  RLT: 21
  Relax-and-lift: 237

Explored 14792 nodes (49023082 simplex iterations) in 2074.65 seconds (6623.58 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21372.6 21320.1 21075.5 ... 20792.3

Optimal solution found (tolerance 1.00e-06)
Best objective 2.137255737628e+04, best bound 2.137255737628e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2074.69s
  Master Objective (UB) = 21372.56, θ = 151566.05
  Upper Bound (UB) = 21372.56

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151566.05
  [DEBUG]   ✓ Scenario 0: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151566.05 ≤ Q = 151566.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151566.05 ≤ Q = 151566.05 (slack: 0.00)
  [DEBUG]   ✓ Scenario 5: θ = 151566.05 ≤ Q = 151566.05 (slack: -0.00)
  [DEBUG]   ✓ Scenario 6: θ = 151566.05 ≤ Q = 151566.05 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 7] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: -0x42e6999d
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0xbd196663
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.550514e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8249206.3250
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.406834e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140683.40    0  124 8249206.33 -140683.40   102%     -    0s
H    0     0                    -105713.1672 -140683.40  33.1%     -    0s
H    0     0                    -106275.1876 -140683.40  32.4%     -    0s
     0     0 -111176.61    0   87 -106275.19 -111176.61  4.61%     -    0s
H    0     0                    -107837.3288 -111047.00  2.98%     -    0s
H    0     0                    -108112.9635 -111047.00  2.71%     -    0s
H    0     0                    -108847.6583 -111047.00  2.02%     -    0s
H    0     0                    -109123.2931 -111047.00  1.76%     -    0s
     0     0 -110642.69    0   89 -109123.29 -110642.69  1.39%     -    0s
     0     0 -110577.00    0   88 -109123.29 -110577.00  1.33%     -    0s
H    0     0                    -109370.4234 -110577.00  1.10%     -    0s
     0     0 -110484.24    0   84 -109370.42 -110484.24  1.02%     -    0s
     0     0 -110476.08    0   84 -109370.42 -110476.08  1.01%     -    0s
     0     2 -110473.57    0   84 -109370.42 -110473.57  1.01%     -    0s
*  502   329              19    -109471.2902 -109974.06  0.46%   6.8    0s
*  512   329              19    -109509.1566 -109974.06  0.42%   6.7    0s
*  529   329              21    -109521.1883 -109974.06  0.41%   6.5    0s
*  737   337              29    -109667.6338 -109833.03  0.15%   5.9    0s
*  916   222              28    -109764.5055 -109785.57  0.02%   5.8    0s
* 1109     2              27    -109769.3158 -109771.78  0.00%   5.2    0s

Cutting planes:
  Gomory: 29
  Implied bound: 2
  MIR: 196

Explored 1299 nodes (6263 simplex iterations) in 0.09 seconds (0.09 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -109769 -109765 -109668 ... -106275
No other solutions better than -109769

Optimal solution found (tolerance 1.00e-06)
Best objective -1.097693157674e+05, best bound -1.097693157674e+05, gap 0.0000%
  Subproblem solved in 0.11s
  Worst-case operational profit (Z_SP) = 150962.60
  Scenario: 13 demand increases, 47 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109769.32
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -109769.32 = 150962.60
  [DEBUG]   Current θ from Master = 151566.05
  [DEBUG]   ⚠️  Z_SP ≤ θ by 603.45 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20769.11
  Lower Bound (LB) = 20769.11
  Gap (UB-LB) = 603.4490, Absolute Gap = 603.4490, Relative Gap = 0.028235
  Not converged yet (gap = 603.45 > ε = 200)

  [DEBUG] Adding NEW scenario 7 to Master Problem...
  [DEBUG] New scenario pattern: 13 increases, 47 decreases
    [DEBUG] Scenario 7 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 7 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 7]
    [DEBUG]   - Total constraints in model: 123703
    [DEBUG]   - Total variables in model: 52180
  [DEBUG] Total scenarios in Master: 8
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 8
================================================================================
[Iteration 8] Solving Master Problem...
  Current scenarios in Master: 8
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 123703 rows, 52180 columns and 351487 nonzeros
Model fingerprint: 0x1a784702
Variable types: 49921 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 52600 rows and 21360 columns
Presolve time: 1.15s
Presolved: 71103 rows, 30820 columns, 442759 nonzeros
Variable types: 28561 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 71103 rows, 30820 columns, 442759 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   36358   -1.5529259e+04   0.000000e+00   3.573753e+08      5s
   49154    1.2799453e+04   0.000000e+00   2.728689e+07     10s
   56567    1.5969135e+04   0.000000e+00   3.317765e+08     15s
   64013    2.1401231e+04   0.000000e+00   1.504645e+06     20s
Concurrent spin time: 0.69s

Solved with dual simplex

Root relaxation: objective 4.598347e+04, 50551 iterations, 21.76 seconds (48.49 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 45983.4722    0  165 -194556.81 45983.4722   124%     -   23s
H    0     0                    -178234.8369 45983.4722   126%     -   23s
H    0     0                    -108091.9163 45983.4722   143%     -   23s
H    0     0                    -89509.62042 45983.4722   151%     -   23s
H    0     0                    -89372.00632 45983.4722   151%     -   23s
H    0     0                    -63353.35022 45983.4722   173%     -   23s
H    0     0                    -63144.20000 45983.4722   173%     -   23s
H    0     0                    -32093.27132 45983.4722   243%     -   23s
H    0     0                    -32052.35038 45983.4722   243%     -   23s
H    0     0                    -15471.58326 45983.4722   397%     -   23s
H    0     0                    -10335.03792 45983.4722   545%     -   24s
H    0     0                    -5068.786474 45983.4722  1007%     -   24s
H    0     0                    -4929.336195 45983.4722  1033%     -   24s
H    0     0                    -4921.929921 45983.4722  1034%     -   24s
H    0     0                    5780.6269133 45983.4722   695%     -   24s
H    0     0                    6303.6146359 45983.4722   629%     -   24s
H    0     0                    7050.8048380 45983.4722   552%     -   24s
H    0     0                    7058.9571260 45983.4722   551%     -   24s
H    0     0                    7149.9312184 45983.4722   543%     -   24s
     0     0 41542.4869    0  218 7149.93122 41542.4869   481%     -   31s
H    0     0                    8068.4664419 41542.4869   415%     -   31s
H    0     0                    8139.3713062 41542.4869   410%     -   31s
H    0     0                    10385.564994 41542.4869   300%     -   31s
H    0     0                    11291.076233 41542.4869   268%     -   31s
H    0     0                    11722.366974 41542.4869   254%     -   31s
H    0     0                    11753.778041 41542.4869   253%     -   31s
H    0     0                    11843.713771 41542.4869   251%     -   31s
H    0     0                    11949.186066 41542.4869   248%     -   31s
     0     0 41098.1357    0  231 11949.1861 41098.1357   244%     -   35s
     0     0 41098.1357    0  216 11949.1861 41098.1357   244%     -   37s
     0     0 41098.1357    0  216 11949.1861 41098.1357   244%     -   38s
     0     0 41098.1357    0  216 11949.1861 41098.1357   244%     -   38s
     0     0 38990.7395    0  285 11949.1861 38990.7395   226%     -   46s
     0     0 38236.0599    0  310 11949.1861 38236.0599   220%     -   51s
     0     0 38010.6290    0  270 11949.1861 38010.6290   218%     -   53s
     0     0 37970.6838    0  317 11949.1861 37970.6838   218%     -   56s
     0     0 37948.2432    0  350 11949.1861 37948.2432   218%     -   57s
     0     0 37906.4453    0  323 11949.1861 37906.4453   217%     -   60s
     0     0 37868.0811    0  362 11949.1861 37868.0811   217%     -   62s
     0     0 37864.1665    0  366 11949.1861 37864.1665   217%     -   62s
     0     0 37847.8082    0  370 11949.1861 37847.8082   217%     -   63s
     0     0 37846.2201    0  368 11949.1861 37846.2201   217%     -   63s
     0     0 37845.8219    0  368 11949.1861 37845.8219   217%     -   63s
     0     0 35924.2600    0  380 11949.1861 35924.2600   201%     -   84s
H    0     0                    11976.400779 35922.9195   200%     -   84s
     0     0 35466.7744    0  380 11976.4008 35466.7744   196%     -   88s
     0     0 35346.6109    0  385 11976.4008 35346.6109   195%     -   91s
     0     0 35026.2336    0  397 11976.4008 35026.2336   192%     -   95s
     0     0 34974.8227    0  398 11976.4008 34974.8227   192%     -   96s
     0     0 34901.0778    0  389 11976.4008 34901.0778   191%     -   98s
     0     0 34865.3540    0  401 11976.4008 34865.3540   191%     -  100s
     0     0 34842.4278    0  394 11976.4008 34842.4278   191%     -  101s
     0     0 34832.9748    0  394 11976.4008 34832.9748   191%     -  101s
     0     0 34829.4877    0  400 11976.4008 34829.4877   191%     -  102s
     0     0 34829.1119    0  397 11976.4008 34829.1119   191%     -  103s
     0     0 33932.5092    0  422 11976.4008 33932.5092   183%     -  113s
     0     0 33722.5761    0  436 11976.4008 33722.5761   182%     -  115s
     0     0 33585.3880    0  423 11976.4008 33585.3880   180%     -  117s
     0     0 33528.0916    0  436 11976.4008 33528.0916   180%     -  119s
     0     0 33509.0899    0  433 11976.4008 33509.0899   180%     -  120s
     0     0 33487.3193    0  434 11976.4008 33487.3193   180%     -  121s
     0     0 33465.7189    0  426 11976.4008 33465.7189   179%     -  122s
     0     0 33446.2837    0  432 11976.4008 33446.2837   179%     -  123s
     0     0 33440.8296    0  427 11976.4008 33440.8296   179%     -  123s
     0     0 33432.5869    0  442 11976.4008 33432.5869   179%     -  124s
     0     0 33430.4802    0  483 11976.4008 33430.4802   179%     -  124s
     0     0 33428.6976    0  441 11976.4008 33428.6976   179%     -  125s
     0     0 33427.8758    0  434 11976.4008 33427.8758   179%     -  125s
     0     0 33273.7403    0  513 11976.4008 33273.7403   178%     -  128s
H    0     0                    11982.942420 33272.2797   178%     -  129s
     0     0 33243.7406    0  514 11982.9424 33243.7406   177%     -  130s
     0     0 33206.8765    0  500 11982.9424 33206.8765   177%     -  131s
     0     0 33190.6937    0  506 11982.9424 33190.6937   177%     -  132s
     0     0 33185.3564    0  505 11982.9424 33185.3564   177%     -  132s
     0     0 33180.9009    0  515 11982.9424 33180.9009   177%     -  133s
     0     0 33176.6054    0  513 11982.9424 33176.6054   177%     -  133s
     0     0 33174.8731    0  516 11982.9424 33174.8731   177%     -  133s
     0     0 33174.7461    0  515 11982.9424 33174.7461   177%     -  133s
     0     0 33084.7321    0  512 11982.9424 33084.7321   176%     -  137s
H    0     0                    12665.058831 33083.3441   161%     -  137s
H    0     0                    12892.900417 33083.3441   157%     -  137s
H    0     0                    12968.413558 33083.3441   155%     -  138s
H    0     0                    12989.420540 33083.3441   155%     -  138s
H    0     0                    13031.582086 33083.3441   154%     -  138s
     0     0 33036.8798    0  513 13031.5821 33036.8798   154%     -  139s
     0     0 33027.3116    0  478 13031.5821 33027.3116   153%     -  140s
     0     0 33012.4416    0  528 13031.5821 33012.4416   153%     -  140s
     0     0 33005.7426    0  529 13031.5821 33005.7426   153%     -  141s
     0     0 33003.6547    0  475 13031.5821 33003.6547   153%     -  142s
     0     0 32992.8046    0  480 13031.5821 32992.8046   153%     -  142s
     0     0 32989.8128    0  471 13031.5821 32989.8128   153%     -  143s
     0     0 32989.1653    0  474 13031.5821 32989.1653   153%     -  143s
     0     0 32958.8791    0  504 13031.5821 32958.8791   153%     -  145s
H    0     0                    13476.688053 32958.3876   145%     -  145s
H    0     0                    14020.131895 32958.3876   135%     -  145s
     0     0 32946.8359    0  515 14020.1319 32946.8359   135%     -  146s
     0     0 32943.9739    0  562 14020.1319 32943.9739   135%     -  146s
     0     0 32939.0292    0  561 14020.1319 32939.0292   135%     -  147s
     0     0 32936.2217    0  517 14020.1319 32936.2217   135%     -  147s
     0     0 32931.4574    0  526 14020.1319 32931.4574   135%     -  147s
     0     0 32930.8587    0  528 14020.1319 32930.8587   135%     -  148s
     0     0 32917.6306    0  473 14020.1319 32917.6306   135%     -  149s
H    0     0                    14320.142648 32916.9581   130%     -  150s
H    0     0                    14335.057227 32916.9581   130%     -  150s
H    0     0                    15085.920864 32916.9581   118%     -  150s
H    0     0                    15391.977521 32916.9581   114%     -  150s
     0     0 32888.2194    0  465 15391.9775 32888.2194   114%     -  151s
     0     0 32879.3993    0  470 15391.9775 32879.3993   114%     -  152s
     0     0 32875.1340    0  474 15391.9775 32875.1340   114%     -  152s
     0     0 32856.0437    0  461 15391.9775 32856.0437   113%     -  153s
     0     0 32851.5713    0  473 15391.9775 32851.5713   113%     -  154s
     0     0 32849.2918    0  472 15391.9775 32849.2918   113%     -  154s
     0     0 32847.3720    0  475 15391.9775 32847.3720   113%     -  154s
     0     0 32845.3318    0  479 15391.9775 32845.3318   113%     -  154s
     0     0 32844.7041    0  477 15391.9775 32844.7041   113%     -  155s
     0     0 32832.1901    0  476 15391.9775 32832.1901   113%     -  156s
     0     0 32827.8491    0  474 15391.9775 32827.8491   113%     -  157s
     0     0 32827.2938    0  482 15391.9775 32827.2938   113%     -  157s
     0     0 32814.3387    0  512 15391.9775 32814.3387   113%     -  159s
H    0     0                    15545.327102 32814.2650   111%     -  160s
H    0     0                    15609.717312 32814.2650   110%     -  160s
     0     0 32805.3720    0  473 15609.7173 32805.3720   110%     -  161s
     0     0 32803.7433    0  484 15609.7173 32803.7433   110%     -  162s
     0     0 32802.7322    0  489 15609.7173 32802.7322   110%     -  162s
     0     0 32792.5461    0  468 15609.7173 32792.5461   110%     -  164s
     0     0 32789.2693    0  474 15609.7173 32789.2693   110%     -  165s
     0     0 32788.2343    0  483 15609.7173 32788.2343   110%     -  165s
     0     0 32779.5779    0  474 15609.7173 32779.5779   110%     -  167s
H    0     0                    15852.501860 32778.8694   107%     -  168s
     0     0 32775.8491    0  477 15852.5019 32775.8491   107%     -  169s
     0     0 32774.2232    0  475 15852.5019 32774.2232   107%     -  169s
     0     0 32773.2383    0  476 15852.5019 32773.2383   107%     -  169s
     0     0 32763.4901    0  475 15852.5019 32763.4901   107%     -  171s
H    0     0                    15960.553824 32761.8472   105%     -  171s
     0     0 32761.8472    0  475 15960.5538 32761.8472   105%     -  172s
     0     0 32754.2368    0  484 15960.5538 32754.2368   105%     -  173s
H    0     0                    16451.569443 32753.7846  99.1%     -  174s
H    0     0                    16646.570642 32753.7846  96.8%     -  175s
H    0     0                    16870.039708 32753.7846  94.2%     -  176s
H    0     0                    17848.422839 32753.7846  83.5%     -  176s
H    0     0                    17868.686187 32753.7846  83.3%     -  176s
H    0     0                    17946.247304 32753.7846  82.5%     -  176s
H    0     0                    18050.684755 32753.7846  81.5%     -  176s
H    0     0                    18067.247179 32753.7846  81.3%     -  176s
H    0     0                    18211.781895 32753.7846  79.8%     -  176s
H    0     0                    18239.196820 32753.7846  79.6%     -  176s
     0     0 32753.1488    0  479 18239.1968 32753.1488  79.6%     -  177s
     0     0 32739.4916    0  476 18239.1968 32739.4916  79.5%     -  178s
H    0     0                    18399.014739 32738.0289  77.9%     -  179s
     0     0 32734.0516    0  494 18399.0147 32734.0516  77.9%     -  179s
     0     0 32732.9958    0  489 18399.0147 32732.9958  77.9%     -  180s
     0     0 32718.9582    0  474 18399.0147 32718.9582  77.8%     -  181s
H    0     0                    19154.331370 32718.9215  70.8%     -  182s
H    0     0                    19461.810031 32718.9215  68.1%     -  182s
H    0     0                    19835.747992 32718.9215  64.9%     -  182s
H    0     0                    19959.418696 32718.9215  63.9%     -  182s
H    0     0                    20009.021700 32718.9215  63.5%     -  182s
H    0     0                    20153.483425 32718.9215  62.3%     -  182s
     0     0 32712.4161    0  481 20153.4834 32712.4161  62.3%     -  183s
     0     0 32711.3568    0  483 20153.4834 32711.3568  62.3%     -  184s
     0     0 32707.2473    0  419 20153.4834 32707.2473  62.3%     -  185s
H    0     0                    20234.763763 32706.9772  61.6%     -  185s
H    0     0                    20277.718278 32706.9772  61.3%     -  185s
H    0     0                    20309.019189 32706.9772  61.0%     -  185s
H    0     0                    20321.362839 32706.9772  60.9%     -  185s
H    0     0                    20344.634831 32706.9772  60.8%     -  185s
     0     0 32705.8539    0  491 20344.6348 32705.8539  60.8%     -  186s
     0     0 32704.4749    0  427 20344.6348 32704.4749  60.8%     -  187s
H    0     0                    20350.431909 32704.1106  60.7%     -  188s
H    0     0                    20355.460428 32704.1106  60.7%     -  189s
H    0     0                    20368.678975 32704.1106  60.6%     -  189s
     0     0 32701.8093    0  494 20368.6790 32701.8093  60.5%     -  190s
     0     0 32701.4647    0  493 20368.6790 32701.4647  60.5%     -  190s
     0     0 32700.5780    0  491 20368.6790 32700.5780  60.5%     -  191s
H    0     0                    20378.165381 32700.4469  60.5%     -  191s
     0     0 32700.2714    0  492 20378.1654 32700.2714  60.5%     -  192s
     0     0 32698.9122    0  490 20378.1654 32698.9122  60.5%     -  193s
     0     0 32698.6740    0  490 20378.1654 32698.6740  60.5%     -  194s
H    0     0                    20584.302263 32698.6092  58.9%     -  222s
H    0     0                    20628.820815 32698.6092  58.5%     -  222s
H    0     0                    20658.557689 32698.6092  58.3%     -  222s
H    0     2                    20717.694405 32698.6092  57.8%     -  228s
     0     2 32698.6092    0  490 20717.6944 32698.6092  57.8%     -  228s
     1     4 32610.5564    1  474 20717.6944 32698.6092  57.8%  3019  230s
     3     8 32459.2764    2  468 20717.6944 32609.5530  57.4%  3671  239s
     7    16 31975.4165    3  496 20717.6944 32459.1035  56.7%  7283  249s
    15    32 31696.3789    4  483 20717.6944 31974.3955  54.3%  7993  261s
    31    49 29971.2387    5  445 20717.6944 31693.9668  53.0% 12003  280s
    48    81 29666.5313    6  417 20717.6944 31693.6764  53.0%  9849  306s
    80   113 29616.6498    7  414 20717.6944 31693.6764  53.0%  8825  318s
H   81   113                    20719.958380 31693.6764  53.0%  8716  318s
H   84   113                    20737.133879 31693.6764  52.8%  8489  318s
   112   269 29505.4108    8  407 20737.1339 31693.6764  52.8%  7294  331s
   268   356 29284.8955   10  380 20737.1339 31693.6764  52.8%  4566  338s
   355   422 29175.2102   10  383 20737.1339 31693.6764  52.8%  4150  346s
   421   478 29057.6738   11  361 20737.1339 31693.6764  52.8%  4017  353s
   485   527 28902.7017   11  372 20737.1339 31693.6764  52.8%  4009  361s
   556   577 28161.0088   11  285 20737.1339 31693.6764  52.8%  3831  368s
   619   622 27970.5680   11  272 20737.1339 31693.6764  52.8%  3743  376s
   696   665 29041.1971   11  421 20737.1339 31693.6764  52.8%  3591  384s
   757   729 28614.1287   12  406 20737.1339 31693.6764  52.8%  3484  391s
   835   773 28468.6421   12  350 20737.1339 31693.6764  52.8%  3377  400s
   901   826 28954.3734   12  355 20737.1339 31693.6764  52.8%  3350  408s
   985   869 21879.3651   45  221 20737.1339 31693.6764  52.8%  3241  416s
H 1016   869                    20737.904279 31693.6764  52.8%  3238  416s
  1057   885 27202.5490   12  396 20737.9043 31693.6764  52.8%  3212  423s
  1117   908 26474.5912   12  277 20737.9043 31693.6764  52.8%  3169  433s
  1173   936 28380.2368   13  401 20737.9043 31693.6764  52.8%  3169  442s
  1237   976 27232.2733   14  464 20737.9043 31693.6764  52.8%  3179  451s
H 1247   976                    20741.319830 31693.6764  52.8%  3167  451s
  1311  1042 23520.1497   19  187 20741.3198 31693.6764  52.8%  3157  461s
  1401  1105 26785.6328   15  448 20741.3198 31693.6764  52.8%  3119  471s
H 1440  1105                    20783.317704 31693.6764  52.5%  3088  471s
  1498  1151 26010.3440   16  456 20783.3177 31693.6764  52.5%  3063  480s
  1603  1201 26237.4068   16  483 20783.3177 31693.6764  52.5%  3021  492s
H 1606  1201                    20815.995136 31693.6764  52.3%  3015  492s
H 1652  1201                    20833.616807 31693.6764  52.1%  3009  492s
  1689  1290 26194.8038   17  481 20833.6168 31693.6764  52.1%  3011  502s
  1804  1367 26003.6342   19  512 20833.6168 31095.1939  49.3%  2973  511s
H 1806  1367                    20834.237865 31095.1939  49.3%  2972  511s
  1936  1477 25034.1952   19  224 20834.2379 31095.1939  49.3%  2930  522s
  2126  1504 24709.1160   21  213 20834.2379 31095.1939  49.3%  2810  533s
  2189  1537     cutoff   22      20834.2379 31095.1939  49.3%  2797  546s
H 2300  1537                    20857.275712 30811.5807  47.7%  2772  546s
  2301  1608 24543.9002   21  213 20857.2757 30811.5807  47.7%  2773  558s
  2451  1655 24074.3305   22  269 20857.2757 30763.3505  47.5%  2740  571s
  2576  1675 22007.4637   24  243 20857.2757 30636.2220  46.9%  2743  583s
H 2578  1675                    20857.922265 30636.2220  46.9%  2742  583s
H 2584  1675                    20864.231607 30636.2220  46.8%  2745  583s
  2638  1734 21788.6224   25  232 20864.2316 30636.2220  46.8%  2763  595s
  2751  1815 21279.6905   29  135 20864.2316 29838.4518  43.0%  2781  609s
  2932  1869 26189.1688   14  369 20864.2316 29797.0980  42.8%  2740  623s
  3098  1933 20918.2593   16  410 20864.2316 29797.0980  42.8%  2733  638s
  3255  1997 23677.2321   14  453 20864.2316 29757.2870  42.6%  2738  650s
  3371  2021 23282.3746   15  458 20864.2316 29757.2870  42.6%  2711  665s
  3520  2094 23212.2447   16  456 20864.2316 29757.2870  42.6%  2706  681s
  3699  2192 22686.4466   17  375 20864.2316 29661.6534  42.2%  2689  696s
  3913  2274     cutoff   16      20864.2316 29661.6534  42.2%  2669  713s
  4097  2353     cutoff   16      20864.2316 29425.9862  41.0%  2670  732s
  4302  2487 24774.0269    9  290 20864.2316 29425.9862  41.0%  2666  752s
  4528  2488 26084.5621   35  490 20864.2316 29212.7803  40.0%  2653  816s
  4530  2489 27994.0328   11  165 20864.2316 29212.7803  40.0%  2652  854s
  4531  2490 22759.1745   27  335 20864.2316 29212.7803  40.0%  2651  872s
  4532  2491 21829.3372   17  447 20864.2316 29212.7803  40.0%  2650  890s
  4533  2491 24194.4037   22  410 20864.2316 29212.7803  40.0%  2650  901s
  4534  2492 23970.0248   29  423 20864.2316 29212.7803  40.0%  2649  907s
  4535  2493 24519.9974   42  455 20864.2316 29212.7803  40.0%  2649  913s
  4536  2493 21620.7948   32  458 20864.2316 29212.7803  40.0%  2648  918s
  4537  2494 22416.4768   30  446 20864.2316 29212.7803  40.0%  2648  923s
  4538  2495 27722.0485   12  510 20864.2316 29212.7803  40.0%  2647  927s
  4540  2496 26663.4644   18  476 20864.2316 29212.7803  40.0%  2646  934s
  4541  2497 21975.6736   34  525 20864.2316 29212.7803  40.0%  2645  937s
  4543  2498 22467.3976   24  466 20864.2316 29212.7803  40.0%  2644  941s
  4545  2499 27235.4928   13  537 20864.2316 29212.7803  40.0%  2643  949s
  4546  2500 28910.3805    9  478 20864.2316 29212.7803  40.0%  2642  950s
  4548  2501 24362.9640   19  592 20864.2316 29212.7803  40.0%  2641  961s
  4550  2503 25797.7502   16  482 20864.2316 29212.7803  40.0%  2640  966s
  4551  2503 24466.9740   26  479 20864.2316 29212.7803  40.0%  2639  970s
  4553  2505 22509.5966   25  491 20864.2316 29212.7803  40.0%  2638  978s
  4554  2505 28238.6124   13  535 20864.2316 29212.7803  40.0%  2638  981s
  4555  2506 25457.8412   17  493 20864.2316 29212.7803  40.0%  2637  986s
  4557  2507 26201.8115   12  555 20864.2316 29212.7803  40.0%  2636  993s
  4558  2508 28012.0427   13  557 20864.2316 29212.7803  40.0%  2635  996s
  4559  2509 24384.3310   22  547 20864.2316 29212.7803  40.0%  2635 1001s
  4561  2510 25321.6887   17  550 20864.2316 29212.7803  40.0%  2634 1008s
  4562  2511 23185.9817   28  550 20864.2316 29212.7803  40.0%  2633 1048s
  4563  2511 26518.5230   10  550 20864.2316 29212.7803  40.0%  2632 1093s
  4564  2514 29212.7803   10  420 20864.2316 29212.7803  40.0%  2687 1102s
  4565  2517 29212.7803   11  345 20864.2316 29212.7803  40.0%  2687 1115s
  4568  2522 29212.7803   12  458 20864.2316 29212.7803  40.0%  2690 1124s
  4574  2532 29212.7803   13  451 20864.2316 29212.7803  40.0%  2700 1142s
  4586  2540 29212.7803   13  423 20864.2316 29212.7803  40.0%  2721 1171s
  4598  2568 27472.8682   15  451 20864.2316 29212.7803  40.0%  2745 1202s
  4630  2685 27368.3976   16  494 20864.2316 29212.7803  40.0%  2843 1220s
  4758  2699 26837.2865   19  298 20864.2316 29212.7803  40.0%  2903 1231s
  4815  2732 26762.3122   20  314 20864.2316 29212.7803  40.0%  2913 1240s
  4872  2757 25518.9515   21  257 20864.2316 29212.7803  40.0%  2941 1249s
  4894  2750 28180.5869   18  500 20864.2316 29212.7803  40.0%  2944 1250s
  4919  2786 25072.4067   22  281 20864.2316 29212.7803  40.0%  2977 1260s
  4982  2801 25143.7140   22  259 20864.2316 29212.7803  40.0%  3008 1269s
  5050  2805 23466.5035   23  312 20864.2316 29212.7803  40.0%  3038 1279s
  5113  2803 21932.0241   23  273 20864.2316 29212.7803  40.0%  3069 1288s
  5147  2817 23183.5706   23  210 20864.2316 29212.7803  40.0%  3093 1299s
  5182  2826     cutoff   24      20864.2316 29212.7803  40.0%  3111 1313s
  5225  2826 22997.0176   24  213 20864.2316 29212.7803  40.0%  3131 1323s
  5265  2829 22953.1252   23  237 20864.2316 29212.7803  40.0%  3157 1333s
  5304  2835 21667.4183   25  183 20864.2316 29212.7803  40.0%  3176 1340s
  5342  2849 infeasible   26      20864.2316 29212.7803  40.0%  3189 1348s
  5382  2853 21605.7986   26  194 20864.2316 29212.7803  40.0%  3212 1357s
  5433  2860     cutoff   26      20864.2316 29212.7803  40.0%  3223 1367s
  5509  2855     cutoff   27      20864.2316 29212.7803  40.0%  3226 1383s
  5593  2843 infeasible   35      20864.2316 29212.7803  40.0%  3225 1395s
  5663  2851 26965.5310   15  538 20864.2316 29212.7803  40.0%  3252 1413s
  5736  2854 26258.1807   16  541 20864.2316 28354.8145  35.9%  3267 1433s
  5808  2853 26077.6070   17  545 20864.2316 28354.7149  35.9%  3295 1446s
  5869  2866 25564.1411   18  446 20864.2316 28203.3669  35.2%  3339 1457s
  5932  2867 25403.9945   19  441 20864.2316 28176.5222  35.0%  3366 1471s
  6009  2874 25268.7862   20  394 20864.2316 28176.5222  35.0%  3389 1491s
  6092  2867 24937.3513   21  369 20864.2316 28176.5222  35.0%  3422 1504s
  6181  2867 24756.5744   22  379 20864.2316 28176.5222  35.0%  3450 1521s
  6276  2868 23097.3158   23  327 20864.2316 28176.5222  35.0%  3460 1536s
  6375  2855 22550.8301   25  233 20864.2316 27946.6165  33.9%  3502 1549s
  6414  2865 21964.2189   26  236 20864.2316 27946.6165  33.9%  3518 1560s
  6464  2864 21054.5532   27  236 20864.2316 27946.6165  33.9%  3527 1574s
  6524  2862     cutoff   28      20864.2316 27946.6165  33.9%  3549 1587s
  6596  2858 22731.5996   18  246 20864.2316 27946.6165  33.9%  3561 1604s
  6665  2849 22212.4021   19  261 20864.2316 27946.6165  33.9%  3574 1621s
  6749  2863     cutoff   20      20864.2316 27285.0437  30.8%  3598 1638s
  6879  2875 21435.4906   23  151 20864.2316 27275.1724  30.7%  3613 1655s
  7030  2861 21241.9957   32  158 20864.2316 27275.1724  30.7%  3621 1674s
  7191  2862 21209.8920   33  113 20864.2316 27047.2840  29.6%  3645 1694s
  7380  2863 24622.2132   16  187 20864.2316 26977.3780  29.3%  3648 1712s
  7574  2836 23550.6213   21  238 20864.2316 26847.7040  28.7%  3661 1732s
  7750  2849 21912.5195   26  131 20864.2316 26841.6552  28.6%  3683 1751s
  7928  2853 23523.8621   24  166 20864.2316 26841.6552  28.6%  3722 1775s
  8143  2807 22022.7147   36  102 20864.2316 26566.7454  27.3%  3752 1798s
  8401  2756 22957.3837   20  253 20864.2316 26307.0513  26.1%  3773 1819s
  8564  2790 22570.4427   25  237 20864.2316 26280.3506  26.0%  3779 1841s
  8841  2751 23369.3436   24  368 20864.2316 26126.3047  25.2%  3783 1866s
  9136  2729 21300.7025   30  125 20864.2316 26126.3047  25.2%  3778 1888s
  9465  2709     cutoff   24      20864.2316 25928.4205  24.3%  3781 1913s
  9797  2636 22394.7164   24  358 20864.2316 25928.4205  24.3%  3791 1939s
 10101  2612 22335.6579   25  360 20864.2316 25764.9186  23.5%  3818 1964s
 10431  2545     cutoff   23      20864.2316 25558.7431  22.5%  3838 1991s
 10751  2479     cutoff   28      20864.2316 25403.7887  21.8%  3867 2018s
 11097  2483 23356.1040   18  280 20864.2316 25403.7887  21.8%  3900 2044s
 11473  2459 infeasible   24      20864.2316 25126.7741  20.4%  3916 2075s
 11918  2451     cutoff   23      20864.2316 25084.6816  20.2%  3913 2107s
 12420  2423 21576.5607   21  282 20864.2316 24906.4157  19.4%  3908 2139s
 12975  2547 22074.2699   20  423 20864.2316 24739.5876  18.6%  3898 2172s
 13514  2624     cutoff   36      20864.2316 24503.8132  17.4%  3891 2208s
 14087  2620     cutoff   20      20864.2316 24324.1070  16.6%  3869 2246s
 14461  2683     cutoff   24      20864.2316 24198.4249  16.0%  3883 2282s
 15000  2659 21724.2589   24  228 20864.2316 24112.3914  15.6%  3885 2329s
*15290  2638              33    20933.475192 24023.3270  14.8%  3891 2329s
 15563  2602     cutoff   26      20933.4752 23891.2412  14.1%  3892 2367s
H15603  2594                    20969.897412 23891.2412  13.9%  3890 2367s
H15654  2434                    21329.592371 23891.2412  12.0%  3894 2367s
 16001  2227 22320.8502   29   96 21329.5924 23738.4141  11.3%  3901 2407s
 16694  1981     cutoff   27      21329.5924 23558.8045  10.5%  3897 2446s
 17295  1491 21836.5895   40   82 21329.5924 23214.0360  8.83%  3870 2485s
 18581   332 22171.0021   33  206 21329.5924 22943.5069  7.57%  3741 2522s
 20568     0     cutoff   30      21329.5924 22239.9029  4.27%  3478 2534s

Cutting planes:
  MIR: 618
  Mixing: 2
  Flow cover: 1966
  RLT: 23
  Relax-and-lift: 225

Explored 21003 nodes (72000432 simplex iterations) in 2534.51 seconds (8241.33 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21329.6 20969.9 20933.5 ... 20783.3

Optimal solution found (tolerance 1.00e-06)
Best objective 2.132959237091e+04, best bound 2.132959237091e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2534.54s
  Master Objective (UB) = 21329.59, θ = 151470.45
  Upper Bound (UB) = 21329.59

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151470.45
  [DEBUG]   ✓ Scenario 0: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151470.45 ≤ Q = 151470.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151470.45 ≤ Q = 151470.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 151470.45 ≤ Q = 151470.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 151470.45 ≤ Q = 151470.45 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 151470.45 ≤ Q = 151470.45 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 8] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x4596f703
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x4596f703
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [3e-13, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [6e-15, 2e+02]
Found heuristic solution: objective 1.548810e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8235899.8806
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.408046e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140804.59    0  124 8235899.88 -140804.59   102%     -    0s
H    0     0                    -105872.7561 -140804.59  33.0%     -    0s
H    0     0                    -106370.7835 -140804.59  32.4%     -    0s
     0     0 -110487.16    0   72 -106370.78 -110487.16  3.87%     -    0s
H    0     0                    -109583.7456 -110430.53  0.77%     -    0s
     0     0 -110167.80    0   38 -109583.75 -110167.80  0.53%     -    0s
     0     0 -110059.26    0   37 -109583.75 -110059.26  0.43%     -    0s
H    0     0                    -109604.7526 -110059.26  0.41%     -    0s
     0     0 -110059.26    0   35 -109604.75 -110059.26  0.41%     -    0s
     0     0 -110059.26    0   34 -109604.75 -110059.26  0.41%     -    0s
     0     0 -109865.68    0   18 -109604.75 -109865.68  0.24%     -    0s
     0     0 -109852.09    0   15 -109604.75 -109852.09  0.23%     -    0s
H    0     0                    -109606.8212 -109852.09  0.22%     -    0s
     0     0 -109841.07    0   15 -109606.82 -109841.07  0.21%     -    0s
     0     0 -109695.06    0   13 -109606.82 -109695.06  0.08%     -    0s
     0     0 -109689.40    0   11 -109606.82 -109689.40  0.08%     -    0s
     0     0 -109685.44    0   11 -109606.82 -109685.44  0.07%     -    0s
     0     0 -109685.41    0   10 -109606.82 -109685.41  0.07%     -    0s
H    0     0                    -109621.2457 -109685.40  0.06%     -    0s
     0     0 -109654.43    0    8 -109621.25 -109654.43  0.03%     -    0s
     0     0 -109643.64    0    4 -109621.25 -109643.64  0.02%     -    0s
     0     0 -109643.64    0   10 -109621.25 -109643.64  0.02%     -    0s
*    0     0               0    -109634.9467 -109634.95  0.00%     -    0s

Cutting planes:
  Implied bound: 1
  MIR: 7
  Flow cover: 3
  RLT: 1
  PSD: 2

Explored 1 nodes (604 simplex iterations) in 0.06 seconds (0.04 work units)
Thread count was 32 (of 64 available processors)

Solution count 9: -109635 -109621 -109607 ... 1.54881e+13
No other solutions better than -109635

Optimal solution found (tolerance 1.00e-06)
Best objective -1.096349467109e+05, best bound -1.096349467109e+05, gap 0.0000%
  Subproblem solved in 0.08s
  Worst-case operational profit (Z_SP) = 151096.97
  Scenario: 10 demand increases, 50 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -109634.95
  [DEBUG]   S×d_nominal = 260731.91
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260731.91 + -109634.95 = 151096.97
  [DEBUG]   Current θ from Master = 151470.45
  [DEBUG]   ⚠️  Z_SP ≤ θ by 373.48 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 20956.11
  Lower Bound (LB) = 20956.11
  Gap (UB-LB) = 373.4840, Absolute Gap = 373.4840, Relative Gap = 0.017510
  Not converged yet (gap = 373.48 > ε = 200)

  [DEBUG] Adding NEW scenario 8 to Master Problem...
  [DEBUG] New scenario pattern: 10 increases, 50 decreases
    [DEBUG] Scenario 8 added (demand uses shared beta VARIABLES)
    [DEBUG] Added scenario 8 to Master Problem:
    [DEBUG]   - Added 90 A_ij variables
    [DEBUG]   - Added 1500 A_jr variables
    [DEBUG]   - Added 150 u variables
    [DEBUG]   - Added 4500 X variables
    [DEBUG]   - Added optimality cut: θ ≤ [operational profit for scenario 8]
    [DEBUG]   - Total constraints in model: 138993
    [DEBUG]   - Total variables in model: 58420
  [DEBUG] Total scenarios in Master: 9
Set parameter TimeLimit to value 3600
Set parameter MIPGap to value 1e-06
Set parameter Threads to value 0
Set parameter OutputFlag to value 1
Set parameter FeasibilityTol to value 1e-09
Set parameter IntFeasTol to value 1e-09
Set parameter OptimalityTol to value 1e-09

================================================================================
ITERATION 9
================================================================================
[Iteration 9] Solving Master Problem...
  Current scenarios in Master: 9
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 138993 rows, 58420 columns and 394733 nonzeros
Model fingerprint: 0x46931102
Variable types: 56161 continuous, 2259 integer (2259 binary)
Coefficient statistics:
  Matrix range     [1e-01, 1e+04]
  Objective range  [1e+00, 2e+04]
  Bounds range     [1e+00, 1e+00]
  RHS range        [1e+00, 5e+04]

MIP start from previous solve did not produce a new incumbent solution

Presolve removed 59185 rows and 24035 columns
Presolve time: 1.14s
Presolved: 79808 rows, 34385 columns, 488420 nonzeros
Variable types: 32126 continuous, 2259 integer (2259 binary)
Found heuristic solution: objective -366474.7947
Found heuristic solution: objective -194556.8060

Deterministic concurrent LP optimizer: primal and dual simplex (primal and dual model)
Showing primal log only...

Root relaxation presolved: 79808 rows, 34385 columns, 488420 nonzeros


Root simplex log...

Iteration    Objective       Primal Inf.    Dual Inf.      Time
   32085   -5.7883303e+04   0.000000e+00   1.218240e+10      5s
   46195    2.8010036e+04   0.000000e+00   7.881277e+07     10s
   55264    3.3720486e+04   0.000000e+00   1.973477e+07     15s
   63309    3.7149675e+04   0.000000e+00   4.682622e+06     20s
Concurrent spin time: 7.30s (can be avoided by choosing Method=3)

Solved with dual simplex

Root relaxation: objective 4.961550e+04, 62355 iterations, 29.97 seconds (53.36 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 49615.4981    0  178 -194556.81 49615.4981   126%     -   31s
H    0     0                    -178389.3811 49615.4981   128%     -   31s
H    0     0                    -177903.9481 49615.4981   128%     -   32s
H    0     0                    -177735.5560 49615.4981   128%     -   32s
H    0     0                    -177192.5906 49615.4981   128%     -   32s
H    0     0                    -138151.5199 49615.4981   136%     -   32s
H    0     0                    -126341.4903 49615.4981   139%     -   32s
H    0     0                    -110242.9516 49615.4981   145%     -   32s
H    0     0                    -42394.97718 49615.4981   217%     -   32s
H    0     0                    11837.207660 49615.4981   319%     -   32s
H    0     0                    12393.750928 49615.4981   300%     -   32s
H    0     0                    13808.848014 49615.4981   259%     -   32s
H    0     0                    19270.339373 49615.4981   157%     -   32s
H    0     0                    19411.218338 43885.8775   126%     -   44s
     0     0 43691.4526    0  288 19411.2183 43691.4526   125%     -   44s
     0     0 43691.4526    0  286 19411.2183 43691.4526   125%     -   48s
     0     0 43691.4526    0  311 19411.2183 43691.4526   125%     -   49s
     0     0 43691.4526    0  311 19411.2183 43691.4526   125%     -   49s
H    0     0                    19456.444033 39790.4141   105%     -   62s
     0     0 39790.4141    0  335 19456.4440 39790.4141   105%     -   62s
H    0     0                    19462.059335 39790.3761   104%     -   62s
     0     0 38673.4459    0  464 19462.0593 38673.4459  98.7%     -   70s
     0     0 38489.2167    0  413 19462.0593 38489.2167  97.8%     -   74s
     0     0 38286.6646    0  455 19462.0593 38286.6646  96.7%     -   77s
     0     0 38228.7932    0  420 19462.0593 38228.7932  96.4%     -   79s
     0     0 38208.5434    0  469 19462.0593 38208.5434  96.3%     -   80s
     0     0 38194.6623    0  468 19462.0593 38194.6623  96.3%     -   81s
     0     0 38175.4996    0  468 19462.0593 38175.4996  96.2%     -   83s
     0     0 38142.2789    0  473 19462.0593 38142.2789  96.0%     -   84s
     0     0 38136.4340    0  466 19462.0593 38136.4340  96.0%     -   84s
     0     0 38133.9385    0  425 19462.0593 38133.9385  95.9%     -   85s
H    0     0                    19653.926322 38132.3326  94.0%     -   85s
     0     0 38132.3326    0  469 19653.9263 38132.3326  94.0%     -   85s
     0     0 38131.9995    0  469 19653.9263 38131.9995  94.0%     -   85s
H    0     0                    19926.394995 38131.9995  91.4%     -   91s
     0     0 35677.2197    0  418 19926.3950 35677.2197  79.0%     -  103s
H    0     0                    19976.266273 35676.4706  78.6%     -  104s
H    0     0                    19991.895580 35676.4706  78.5%     -  104s
     0     0 35301.3728    0  417 19991.8956 35301.3728  76.6%     -  110s
     0     0 35134.2961    0  423 19991.8956 35134.2961  75.7%     -  114s
     0     0 35056.5590    0  418 19991.8956 35056.5590  75.4%     -  116s
     0     0 34969.4223    0  422 19991.8956 34969.4223  74.9%     -  118s
     0     0 34929.3187    0  435 19991.8956 34929.3187  74.7%     -  121s
     0     0 34855.1698    0  439 19991.8956 34855.1698  74.3%     -  124s
     0     0 34839.5971    0  439 19991.8956 34839.5971  74.3%     -  125s
     0     0 34797.0570    0  438 19991.8956 34797.0570  74.1%     -  126s
     0     0 34793.6280    0  437 19991.8956 34793.6280  74.0%     -  127s
     0     0 34791.2546    0  436 19991.8956 34791.2546  74.0%     -  127s
     0     0 34789.1827    0  438 19991.8956 34789.1827  74.0%     -  128s
     0     0 34789.0090    0  438 19991.8956 34789.0090  74.0%     -  128s
     0     0 33994.1075    0  453 19991.8956 33994.1075  70.0%     -  136s
     0     0 33760.3788    0  471 19991.8956 33760.3788  68.9%     -  140s
     0     0 33608.4415    0  471 19991.8956 33608.4415  68.1%     -  143s
     0     0 33530.8059    0  484 19991.8956 33530.8059  67.7%     -  146s
     0     0 33489.0991    0  588 19991.8956 33489.0991  67.5%     -  148s
     0     0 33432.8344    0  578 19991.8956 33432.8344  67.2%     -  150s
     0     0 33390.5173    0  532 19991.8956 33390.5173  67.0%     -  151s
     0     0 33363.9313    0  479 19991.8956 33363.9313  66.9%     -  152s
     0     0 33351.2547    0  515 19991.8956 33351.2547  66.8%     -  154s
     0     0 33330.6511    0  466 19991.8956 33330.6511  66.7%     -  155s
     0     0 33315.2014    0  550 19991.8956 33315.2014  66.6%     -  156s
     0     0 33302.6597    0  555 19991.8956 33302.6597  66.6%     -  158s
     0     0 33294.5664    0  560 19991.8956 33294.5664  66.5%     -  158s
     0     0 33255.8323    0  547 19991.8956 33255.8323  66.3%     -  160s
     0     0 33245.8345    0  529 19991.8956 33245.8345  66.3%     -  161s
     0     0 33238.3024    0  542 19991.8956 33238.3024  66.3%     -  162s
     0     0 33235.8816    0  557 19991.8956 33235.8816  66.2%     -  162s
     0     0 33235.1757    0  553 19991.8956 33235.1757  66.2%     -  163s
     0     0 33110.3864    0  469 19991.8956 33110.3864  65.6%     -  167s
H    0     0                    20027.556814 33110.1279  65.3%     -  168s
     0     0 33063.1709    0  584 20027.5568 33063.1709  65.1%     -  170s
     0     0 33000.5336    0  532 20027.5568 33000.5336  64.8%     -  173s
     0     0 32995.6166    0  482 20027.5568 32995.6166  64.8%     -  174s
     0     0 32992.6293    0  486 20027.5568 32992.6293  64.7%     -  174s
     0     0 32991.3478    0  478 20027.5568 32991.3478  64.7%     -  175s
H    0     0                    20036.243897 32964.8816  64.5%     -  177s
H    0     0                    20144.864925 32964.8816  63.6%     -  177s
     0     0 32964.8816    0  454 20144.8649 32964.8816  63.6%     -  177s
     0     0 32948.8118    0  467 20144.8649 32948.8118  63.6%     -  178s
     0     0 32933.0527    0  503 20144.8649 32933.0527  63.5%     -  180s
     0     0 32927.0887    0  468 20144.8649 32927.0887  63.5%     -  180s
     0     0 32919.0579    0  460 20144.8649 32919.0579  63.4%     -  181s
     0     0 32916.0532    0  469 20144.8649 32916.0532  63.4%     -  182s
     0     0 32905.3237    0  466 20144.8649 32905.3237  63.3%     -  183s
     0     0 32904.0091    0  511 20144.8649 32904.0091  63.3%     -  183s
     0     0 32857.6322    0  598 20144.8649 32857.6322  63.1%     -  186s
     0     0 32848.5751    0  472 20144.8649 32848.5751  63.1%     -  188s
     0     0 32841.0609    0  473 20144.8649 32841.0609  63.0%     -  189s
     0     0 32838.6196    0  563 20144.8649 32838.6196  63.0%     -  190s
     0     0 32837.4781    0  549 20144.8649 32837.4781  63.0%     -  190s
     0     0 32815.9097    0  556 20144.8649 32815.9097  62.9%     -  193s
     0     0 32805.2847    0  472 20144.8649 32805.2847  62.8%     -  194s
     0     0 32802.9680    0  484 20144.8649 32802.9680  62.8%     -  195s
     0     0 32789.8960    0  487 20144.8649 32789.8960  62.8%     -  196s
     0     0 32783.5033    0  489 20144.8649 32783.5033  62.7%     -  197s
     0     0 32781.4320    0  490 20144.8649 32781.4320  62.7%     -  198s
     0     0 32776.2481    0  489 20144.8649 32776.2481  62.7%     -  199s
     0     0 32771.6998    0  490 20144.8649 32771.6998  62.7%     -  201s
     0     0 32769.0843    0  486 20144.8649 32769.0843  62.7%     -  201s
     0     0 32768.5283    0  486 20144.8649 32768.5283  62.7%     -  201s
     0     0 32755.7465    0  486 20144.8649 32755.7465  62.6%     -  203s
     0     0 32754.5937    0  488 20144.8649 32754.5937  62.6%     -  203s
     0     0 32751.0038    0  495 20144.8649 32751.0038  62.6%     -  205s
     0     0 32749.6501    0  495 20144.8649 32749.6501  62.6%     -  207s
H    0     0                    20420.456351 32749.6501  60.4%     -  242s
H    0     0                    20468.598517 32749.6501  60.0%     -  242s
H    0     0                    20476.874492 32749.6501  59.9%     -  242s
H    0     0                    20505.511375 32749.6501  59.7%     -  242s
H    0     2                    20619.995040 32749.6501  58.8%     -  249s
     0     2 32749.6501    0  495 20619.9950 32749.6501  58.8%     -  249s
     1     4 32220.7801    1  480 20619.9950 32749.1599  58.8%  7935  257s
     3     8 32106.2845    2  473 20619.9950 32220.3089  56.3%  8978  270s
     7    16 31987.6299    3  485 20619.9950 32102.4261  55.7% 10237  280s
    15    32 31895.1486    4  483 20619.9950 31987.4351  55.1%  9917  287s
    31    48 29884.4116    5  408 20619.9950 31893.8316  54.7% 11130  303s
    47    80 28627.5735    6  346 20619.9950 31893.8316  54.7% 11915  316s
H   49    80                    20768.234111 31893.8316  53.6% 11689  316s
H   53    80                    20787.449250 31893.8316  53.4% 11534  316s
    79   121 28546.8917    7  377 20787.4493 31893.8316  53.4% 10351  342s
   151   150 28360.9522    9  374 20787.4493 31893.8316  53.4%  7896  357s
   184   175 28206.8114   10  373 20787.4493 31893.8316  53.4%  7911  373s
   223   213 27754.0921   10  372 20787.4493 31893.8316  53.4%  7823  387s
H  249   213                    20830.853944 31893.8316  53.1%  7770  387s
   278   270 27636.2896    8  306 20830.8539 31893.8316  53.1%  7633  398s
   363   295 26687.8555   11  380 20830.8539 31893.8316  53.1%  7219  408s
H  368   295                    20852.722395 31893.8316  52.9%  7196  408s
H  377   295                    20864.231607 31893.8316  52.9%  7127  408s
   405   335 26436.6570   11  417 20864.2316 31893.8316  52.9%  7047  421s
   493   376 25756.7781   12  357 20864.2316 31893.8316  52.9%  6595  432s
   584   434 25239.5553   12  383 20864.2316 31893.8316  52.9%  6314  443s
   668   509 23254.5979   11  357 20864.2316 31893.8316  52.9%  6162  451s
   755   580 22851.9015   12  363 20864.2316 31893.8316  52.9%  5971  460s
   860   658 25667.6940   13  362 20864.2316 31893.8316  52.9%  5755  469s
   964   728 24364.1173   14  350 20864.2316 31893.8316  52.9%  5500  476s
  1076   784 23781.3865   15  349 20864.2316 31893.8316  52.9%  5238  487s
  1192   842 23539.0573   16  346 20864.2316 31893.8316  52.9%  5005  497s
  1296   916     cutoff   15      20864.2316 31893.8316  52.9%  4913  508s
  1428   964 23926.2285   24  383 20864.2316 31893.8316  52.9%  4777  519s
  1550  1010 23254.9628   25  365 20864.2316 31893.8316  52.9%  4623  531s
  1657  1085 23105.4820   26  431 20864.2316 31893.8316  52.9%  4590  540s
  1771  1144 22919.0011   27  342 20864.2316 31893.8316  52.9%  4588  550s
  1900  1226 22958.6662   28  289 20864.2316 31893.8316  52.9%  4558  560s
  2052  1292     cutoff   29      20864.2316 31893.8316  52.9%  4460  571s
  2202  1309 21724.5780   31  240 20864.2316 31329.7878  50.2%  4409  583s
  2249  1343     cutoff   31      20864.2316 30380.4107  45.6%  4445  597s
  2297  1394 21258.3754   32  190 20864.2316 30380.4107  45.6%  4497  609s
  2404  1460 22725.8744   31  297 20864.2316 29707.8954  42.4%  4458  619s
  2525  1511     cutoff   32      20864.2316 29707.8954  42.4%  4403  634s
  2661  1562 27309.2261    7  370 20864.2316 29707.8954  42.4%  4352  648s
  2770  1602 24988.5179   10  254 20864.2316 29707.8954  42.4%  4383  661s
  2846  1673 24565.8248   11  242 20864.2316 29607.7783  41.9%  4373  674s
  2955  1765 23232.5499   16  217 20864.2316 29607.7783  41.9%  4375  687s
  3081  1878 21926.2154   25  154 20864.2316 29607.7783  41.9%  4394  700s
  3256  1977 21305.2572   42  139 20864.2316 29607.7783  41.9%  4336  714s
  3435  2100 24049.9839   12  227 20864.2316 28740.9534  37.8%  4321  729s
  3624  2228 21988.5594   18  292 20864.2316 28540.2536  36.8%  4320  744s
  3826  2393 21687.3718   22  279 20864.2316 28540.2536  36.8%  4296  760s
  4082  2394 22206.5968   48  495 20864.2316 28540.2536  36.8%  4237  825s
  4084  2395 24325.7536   18  150 20864.2316 28540.2536  36.8%  4235  863s
  4085  2396 23958.8619   26  341 20864.2316 28540.2536  36.8%  4234  885s
  4086  2397 21869.4670   40  421 20864.2316 28540.2536  36.8%  4233  903s
  4087  2397 22619.3412   51  461 20864.2316 28540.2536  36.8%  4232  916s
  4088  2398 23747.2309   25  485 20864.2316 28540.2536  36.8%  4231  923s
  4089  2399 22395.9237   49  491 20864.2316 28540.2536  36.8%  4230  928s
  4090  2399 21613.2631   58  460 20864.2316 28540.2536  36.8%  4229  932s
  4091  2400 21894.7306   45  449 20864.2316 28540.2536  36.8%  4228  938s
  4092  2401 27703.5327    8  513 20864.2316 28540.2536  36.8%  4227  943s
  4093  2401 24196.6231   16  465 20864.2316 28540.2536  36.8%  4226  947s
  4094  2402 21173.7298   75  462 20864.2316 28540.2536  36.8%  4225  950s
  4097  2404 22820.7932   13  521 20864.2316 28540.2536  36.8%  4222  957s
  4099  2405 22432.1946   20  512 20864.2316 28540.2536  36.8%  4219  966s
  4101  2407 24171.5490   11  528 20864.2316 28540.2536  36.8%  4217  970s
  4103  2408 26548.0883   17  481 20864.2316 28540.2536  36.8%  4215  977s
  4105  2409 21703.7494   75  410 20864.2316 28540.2536  36.8%  4213  981s
  4106  2410 22379.9279   30  456 20864.2316 28540.2536  36.8%  4212  985s
  4108  2411 24459.4512   27  527 20864.2316 28540.2536  36.8%  4210  992s
  4109  2412 22396.1484   14  536 20864.2316 28540.2536  36.8%  4209  995s
  4110  2413 24325.7536   18  574 20864.2316 28540.2536  36.8%  4208 1000s
  4112  2414 24353.8905   20  558 20864.2316 28540.2536  36.8%  4206 1010s
  4114  2415 24555.7542   19  530 20864.2316 28540.2536  36.8%  4204 1016s
  4116  2417 24046.3550   22  521 20864.2316 28540.2536  36.8%  4202 1022s
  4117  2417 21373.9279   23  521 20864.2316 28540.2536  36.8%  4201 1061s
  4118  2418 22156.3205   22  521 20864.2316 28540.2536  36.8%  4200 1104s
  4119  2421 28540.2536   15  432 20864.2316 28540.2536  36.8%  4261 1113s
  4120  2423 28540.2536   16  424 20864.2316 28540.2536  36.8%  4262 1131s
  4123  2428 28326.8031   17  330 20864.2316 28540.2536  36.8%  4262 1145s
  4129  2438 28019.0210   18  331 20864.2316 28540.2536  36.8%  4270 1166s
  4141  2446 28540.2536   18  425 20864.2316 28540.2536  36.8%  4286 1186s
  4153  2467 28540.2536   19  374 20864.2316 28540.2536  36.8%  4313 1225s
  4185  2557 28386.2558   20  324 20864.2316 28540.2536  36.8%  4403 1248s
  4304  2545 27684.6430   22  309 20864.2316 28540.2536  36.8%  4436 1257s
  4339  2571 27930.5088   22  302 20864.2316 28540.2536  36.8%  4440 1267s
  4381  2596 26131.0161   23  359 20864.2316 28540.2536  36.8%  4463 1277s
  4439  2621 24626.3122   24  276 20864.2316 28540.2536  36.8%  4478 1287s
  4492  2641 22511.4326   26  262 20864.2316 28540.2536  36.8%  4524 1298s
  4548  2658 21817.5483   26  243 20864.2316 28540.2536  36.8%  4556 1312s
  4610  2666 21692.9460   25  337 20864.2316 28540.2536  36.8%  4587 1325s
  4676  2675 infeasible   27      20864.2316 28540.2536  36.8%  4594 1336s
  4734  2675 26166.0356   21  262 20864.2316 28540.2536  36.8%  4617 1348s
  4790  2672 24910.4552   22  238 20864.2316 28540.2536  36.8%  4628 1357s
  4845  2675 24814.3627   23  224 20864.2316 28540.2536  36.8%  4651 1369s
  4898  2679 23774.3920   26  192 20864.2316 28540.2536  36.8%  4667 1390s
  4955  2692     cutoff   27      20864.2316 28540.2536  36.8%  4688 1400s
  5012  2688     cutoff   27      20864.2316 28540.2536  36.8%  4728 1413s
  5071  2674     cutoff   27      20864.2316 28540.2536  36.8%  4742 1424s
  5121  2678 26537.2741   23  341 20864.2316 28540.2536  36.8%  4762 1435s
  5168  2698 26108.7209   24  332 20864.2316 28540.2536  36.8%  4787 1446s
  5223  2708 25064.5040   25  291 20864.2316 28540.2536  36.8%  4796 1458s
  5302  2721 23580.9076   26  201 20864.2316 28540.2536  36.8%  4792 1470s
  5377  2726 23204.2173   27  182 20864.2316 28540.2536  36.8%  4796 1487s
  5495  2716 22741.5110   28  195 20864.2316 28540.2536  36.8%  4762 1501s
  5593  2721 22336.1491   29  199 20864.2316 28540.2536  36.8%  4770 1515s
  5682  2724 21659.1326   30  169 20864.2316 28540.2536  36.8%  4798 1528s
H 5763  2575                    20864.968757 28540.2536  36.8%  4804 1528s
  5774  2593 21398.3071   30  179 20864.9688 28540.2536  36.8%  4806 1546s
H 5777  2477                    21170.997173 28540.2536  34.8%  4806 1546s
  5817  2482     cutoff   31      21170.9972 28498.8604  34.6%  4817 1560s
  5919  2475 25277.1414   23  342 21170.9972 28498.8604  34.6%  4863 1575s
  6025  2461 24393.3870   25  346 21170.9972 28312.0664  33.7%  4886 1591s
H 6055  2341                    21201.705331 28312.0664  33.5%  4887 1591s
  6144  2330 21282.7439   27  394 21201.7053 28312.0664  33.5%  4889 1607s
  6271  2300 21614.6498   27  327 21201.7053 28312.0664  33.5%  4906 1622s
H 6301  2186                    21207.701247 28312.0664  33.5%  4917 1622s
  6318  2211 infeasible   28      21207.7012 28312.0664  33.5%  4926 1639s
  6448  2203 24406.0739   28  392 21207.7012 27561.8098  30.0%  4940 1658s
  6565  2194     cutoff   31      21207.7012 27561.8098  30.0%  4982 1676s
  6708  2161 21998.3223   33  295 21207.7012 27506.0507  29.7%  5015 1694s
  6818  2154     cutoff   28      21207.7012 27320.4733  28.8%  5040 1713s
  6966  2135 22144.4418   26  291 21207.7012 27168.9036  28.1%  5054 1734s
  7125  2160     cutoff   28      21207.7012 27132.8383  27.9%  5059 1754s
  7313  2142 24938.4254   24  274 21207.7012 26935.3722  27.0%  5064 1775s
H 7473  1990                    21223.166010 26862.4314  26.6%  5070 1775s
  7498  2029     cutoff   28      21223.1660 26862.4314  26.6%  5069 1798s
  7744  1955     cutoff   27      21223.1660 26862.4314  26.6%  5049 1819s
  7808  1964     cutoff   23      21223.1660 26578.1414  25.2%  5069 1838s
  7921  1976     cutoff   24      21223.1660 26576.5988  25.2%  5074 1860s
  8153  1958 22096.5708   39  388 21223.1660 26576.5988  25.2%  5069 1883s
  8431  1883     cutoff   41      21223.1660 26494.6170  24.8%  5054 1900s
  8475  1889 23860.1640   38  208 21223.1660 26494.6170  24.8%  5055 1920s
  8533  1917 22755.3132   38  311 21223.1660 26494.6170  24.8%  5052 1944s
  8756  1886 22859.2904   39  263 21223.1660 26218.3024  23.5%  5004 1969s
  9072  1798 21436.9453   41  248 21223.1660 26055.4894  22.8%  4958 1997s
  9382  1741 22123.4513   28  316 21223.1660 25992.5696  22.5%  4967 2026s
  9748  1615     cutoff   49      21223.1660 25951.7172  22.3%  4945 2057s
 10051  1650     cutoff   28      21223.1660 25583.0698  20.5%  4977 2087s
 10351  1641     cutoff   34      21223.1660 25583.0698  20.5%  5015 2118s
 10708  1650     cutoff   29      21223.1660 25125.8429  18.4%  5026 2151s
 11047  1682 21863.2353   32  360 21223.1660 25084.0779  18.2%  5061 2184s
 11417  1659     cutoff   24      21223.1660 24860.8613  17.1%  5083 2218s
 11874  1632     cutoff   32      21223.1660 24541.5367  15.6%  5072 2259s
 12332  1607 21255.7106   34  178 21223.1660 24371.2985  14.8%  5075 2299s
 12817  1572 21947.2133   28  312 21223.1660 24055.5426  13.3%  5066 2339s
 13293  1559 21931.3050   33  140 21223.1660 23799.0131  12.1%  5063 2375s
 13899  1529     cutoff   45      21223.1660 23481.2551  10.6%  5028 2415s
 14619  1416     cutoff   36      21223.1660 23292.0348  9.75%  4961 2458s
 15537  1035     cutoff   34      21223.1660 22852.2815  7.68%  4846 2500s
 17016   129     cutoff   40      21223.1660 22594.2067  6.46%  4579 2533s
 18949     0 21225.9834   70   74 21223.1660 22033.8556  3.82%  4203 2538s

Cutting planes:
  Learned: 3
  Gomory: 5
  Projected implied bound: 43
  MIR: 1021
  Mixing: 4
  Flow cover: 2250
  RLT: 28
  Relax-and-lift: 257

Explored 19156 nodes (80037837 simplex iterations) in 2538.29 seconds (8286.90 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: 21223.2 21207.7 21201.7 ... 20768.2

Optimal solution found (tolerance 1.00e-06)
Best objective 2.122316601015e+04, best bound 2.122316601015e+04, gap 0.0000%
  [DEBUG-MASTER] Beta values from solution (showing first 3):
  [DEBUG-MASTER]   beta(0, 2) = 1.0000
  [DEBUG-MASTER]   beta(1, 2) = 1.0000
  [DEBUG-MASTER]   beta(2, 2) = 1.0000
  Master solved in 2538.34s
  Master Objective (UB) = 21223.17, θ = 151364.02
  Upper Bound (UB) = 21223.17

  [DEBUG] Verifying Optimality Cuts:
  [DEBUG] Current θ = 151364.02
  [DEBUG]   ✓ Scenario 0: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 1: θ = 151364.02 ≤ Q = 151364.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 2: θ = 151364.02 ≤ Q = 151364.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 3: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 4: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 5: θ = 151364.02 ≤ Q = 151364.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 6: θ = 151364.02 ≤ Q = 151364.02 (slack: 0.00)
  [DEBUG]   ✓ Scenario 7: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG]   ✓ Scenario 8: θ = 151364.02 ≤ Q = 151364.02 (slack: -0.00)
  [DEBUG] All optimality cuts satisfied.
[Iteration 9] Solving Subproblem...

  [DEBUG-SUBPROBLEM] fix_first_stage() called
  [DEBUG-SUBPROBLEM] First call (no previous beta)
  [DEBUG-SUBPROBLEM] Adding new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Added 1740 new dual feasibility constraints
  [DEBUG-SUBPROBLEM] Updating objective function
  [DEBUG-SUBPROBLEM] Model fingerprint after update: 0x82872f4
Gurobi Optimizer version 12.0.3 build v12.0.3rc0 (linux64 - "Red Hat Enterprise Linux 9.6 (Plow)")

CPU model: AMD EPYC 9374F 32-Core Processor, instruction set [SSE2|AVX|AVX2|AVX512]
Thread count: 64 physical cores, 64 logical processors, using up to 32 threads

Non-default parameters:
TimeLimit  3600
FeasibilityTol  1e-09
IntFeasTol  1e-09
MIPGap  1e-06
OptimalityTol  1e-09

Optimize a model with 3093 rows, 2389 columns and 8610 nonzeros
Model fingerprint: 0x082872f4
Variable types: 2089 continuous, 300 integer (300 binary)
Coefficient statistics:
  Matrix range     [1e+00, 2e+02]
  Objective range  [4e+00, 2e+03]
  Bounds range     [1e+00, 2e+02]
  RHS range        [1e+00, 2e+02]
Found heuristic solution: objective 1.548810e+13
Presolve removed 2571 rows and 1864 columns
Presolve time: 0.00s
Presolved: 522 rows, 525 columns, 1472 nonzeros
Found heuristic solution: objective 8244274.3345
Variable types: 355 continuous, 170 integer (170 binary)

Root relaxation: objective -1.405009e+05, 247 iterations, 0.00 seconds (0.00 work units)

    Nodes    |    Current Node    |     Objective Bounds      |     Work
 Expl Unexpl |  Obj  Depth IntInf | Incumbent    BestBd   Gap | It/Node Time

     0     0 -140500.90    0  124 8244274.33 -140500.90   102%     -    0s
H    0     0                    -105591.4327 -140500.90  33.1%     -    0s
H    0     0                    -106089.4602 -140500.90  32.4%     -    0s
     0     0 -109685.98    0   72 -106089.46 -109685.98  3.39%     -    0s
H    0     0                    -108844.6212 -109627.10  0.72%     -    0s
     0     0 -109521.97    0   38 -108844.62 -109521.97  0.62%     -    0s
     0     0 -109491.72    0   38 -108844.62 -109491.72  0.59%     -    0s
H    0     0                    -108876.2417 -109404.67  0.49%     -    0s
     0     0 -109404.67    0   39 -108876.24 -109404.67  0.49%     -    0s
     0     0 -109376.09    0   39 -108876.24 -109376.09  0.46%     -    0s
     0     2 -109374.93    0   39 -108876.24 -109374.93  0.46%     -    0s
*   49    18               6    -108980.5247 -109036.13  0.05%  14.1    0s
*   51    18               6    -108985.7005 -109036.13  0.05%  13.7    0s
H   55    17                    -108987.0724 -109036.13  0.05%  13.5    0s
*   77     0               7    -108987.9769 -108987.98  0.00%  11.7    0s

Cutting planes:
  Gomory: 19
  Implied bound: 5
  MIR: 166
  Flow cover: 5
  RLT: 1

Explored 90 nodes (1327 simplex iterations) in 0.14 seconds (0.05 work units)
Thread count was 32 (of 64 available processors)

Solution count 10: -108988 -108987 -108986 ... 1.54881e+13
No other solutions better than -108988

Optimal solution found (tolerance 1.00e-06)
Best objective -1.089879768620e+05, best bound -1.089879768620e+05, gap 0.0000%
  Subproblem solved in 0.16s
  Worst-case operational profit (Z_SP) = 151310.96
  Scenario: 0 demand increases, 60 demand decreases

  [DEBUG] Z_SP Calculation:
  [DEBUG]   Dual objective (Gurobi, includes S×μ̂×(η⁺-η⁻)) = -108987.98
  [DEBUG]   S×d_nominal = 260298.94
  [DEBUG]   Z_SP = S×d_nominal + dual_obj = 260298.94 + -108987.98 = 151310.96
  [DEBUG]   Current θ from Master = 151364.02
  [DEBUG]   ⚠️  Z_SP ≤ θ by 53.06 (should not happen if not duplicate!)
  True Robust Profit (Z_current) = 21170.11
  Lower Bound (LB) = 21170.11
  Gap (UB-LB) = 53.0580, Absolute Gap = 53.0580, Relative Gap = 0.002500
  *** CONVERGED (gap within tolerance) ***

================================================================================
C&CG ALGORITHM COMPLETED
================================================================================
Total Iterations: 9
Total Time: 11021.89s
Converged: True
Final Lower Bound: 21170.1081
Final Upper Bound: 21223.1660
Final Gap: 53.057956
Number of Critical Scenarios: 9
================================================================================

================================================================================
OPTIMAL SOLUTION SUMMARY
================================================================================
Product 0 Plants: [0] (1/3)
Product 1 Plants: [1] (1/3)
Product 2 Plants: [1] (1/3)
Total Plant Openings: 3
DCs Opened: [2, 4, 9] (3/10)
Active Routes (Plant→DC): 9
Active Routes (DC→Customer): 50
Transportation Modes: Mode 0: 1 customers  Mode 1: 0 customers  Mode 2: 49 customers  
================================================================================

================================================================================
SINGLE RUN RESULTS
================================================================================
Gamma: 20
Converged: True
Iterations: 9
Start Time: 2026-01-04 00:30:44
End Time: 2026-01-04 03:34:26
Total Time: 11021.89s
Optimal Value: 21170.11
Lower Bound: 21170.11
Upper Bound: 21223.17
Gap: 53.057956
Plants Opened: {0: [0], 1: [1], 2: [1]} (3 plants)
DCs Opened: [2, 4, 9] (3 DCs)
================================================================================

Results saved to: result/DH_single_full_seed2_Mixed_gamma20_20260104_033426.csv

Total Execution Time: 11022.25 seconds
End Time: 2026-01-04 03:34:26

All tasks completed successfully!

